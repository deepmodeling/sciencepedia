{"hands_on_practices": [{"introduction": "Before delving into complex calculations, it is crucial to solidify our understanding of the fundamental principles. This first practice serves as a conceptual check on the BCS gap equation, exploring its most essential requirement: an attractive interaction between electrons. By analyzing the mathematical structure of the equation under the hypothetical scenario of a repulsive potential ($V  0$), you will prove why conventional superconductivity cannot arise from such an interaction, reinforcing the core physical mechanism of Cooper pairing. [@problem_id:1766635]", "problem": "The Bardeen-Cooper-Schrieffer (BCS) theory of superconductivity describes how an attractive interaction between electrons can lead to the formation of Cooper pairs and the opening of a superconducting energy gap, $\\Delta$. This gap is determined by a self-consistency equation. At absolute zero temperature ($T=0$), for a simplified model with a constant attractive potential, this equation is given by:\n\n$$1 = \\frac{V N(0)}{2} \\int_{-\\hbar \\omega_D}^{\\hbar \\omega_D} \\frac{d\\epsilon}{\\sqrt{\\epsilon^2 + \\Delta^2}}$$\n\nHere, $V$ is a positive constant representing the strength of the attractive electron-electron interaction, $N(0)$ is the density of electronic states for a single spin at the Fermi level, $\\hbar$ is the reduced Planck constant, and $\\omega_D$ is the Debye frequency, which defines an energy cutoff $\\hbar \\omega_D$ around the Fermi level within which the interaction is non-zero. A non-trivial solution ($\\Delta  0$) to this equation signifies the presence of a superconducting state.\n\nNow, consider a hypothetical material where an exotic pairing mechanism results in an effective electron-electron interaction that is purely *repulsive*. In the context of the BCS model, this corresponds to an interaction strength parameter $V  0$. By analyzing the mathematical structure of the self-consistency equation for this repulsive case, determine whether a non-trivial superconducting gap ($\\Delta  0$) can form at $T=0$.\n\nWhich of the following statements correctly explains the possibility of a non-trivial superconducting gap for a repulsive interaction ($V0$)?\n\nA. A non-zero gap is possible, provided the density of states $N(0)$ is sufficiently large to compensate for the negative sign of $V$.\n\nB. A non-zero gap is impossible. The right-hand side of the equation involves a product of the negative parameter $V$ and an integral that must be positive for any real $\\Delta  0$. The resulting negative value can never equal the positive value (1) on the left-hand side.\n\nC. A non-zero gap is possible, but it must be a purely imaginary number, which corresponds to a physically unstable state rather than a stable superconducting ground state.\n\nD. A non-zero gap is impossible because for a repulsive potential ($V0$), the integral on the right-hand side of the equation diverges.\n\nE. A non-zero gap is impossible at $T=0$, but a repulsive interaction can lead to a stable superconducting gap at sufficiently high temperatures.", "solution": "We start from the zero-temperature BCS self-consistency equation with a constant interaction within the Debye window:\n$$\n1=\\frac{V N(0)}{2}\\int_{-\\hbar \\omega_{D}}^{\\hbar \\omega_{D}}\\frac{d\\epsilon}{\\sqrt{\\epsilon^{2}+\\Delta^{2}}}\\,,\n$$\nwhere $V$ is a constant interaction parameter, $N(0)0$ is the density of states per spin at the Fermi level, and $\\Delta0$ is a putative real superconducting gap.\n\nFirst, analyze the integrand. For any real $\\Delta0$, the function $f(\\epsilon)=1/\\sqrt{\\epsilon^{2}+\\Delta^{2}}$ is:\n- even in $\\epsilon$, since $f(-\\epsilon)=f(\\epsilon)$,\n- strictly positive for all $\\epsilon\\in\\mathbb{R}$,\n- integrable over any finite interval.\n\nTherefore, the integral is positive and finite. Using evenness,\n$$\n\\int_{-\\hbar \\omega_{D}}^{\\hbar \\omega_{D}}\\frac{d\\epsilon}{\\sqrt{\\epsilon^{2}+\\Delta^{2}}}\n=2\\int_{0}^{\\hbar \\omega_{D}}\\frac{d\\epsilon}{\\sqrt{\\epsilon^{2}+\\Delta^{2}}}\\,.\n$$\nEvaluate the primitive:\n$$\n\\int \\frac{d\\epsilon}{\\sqrt{\\epsilon^{2}+\\Delta^{2}}}\n=\\operatorname{arsinh}\\!\\left(\\frac{\\epsilon}{\\Delta}\\right)\n=\\ln\\!\\left(\\frac{\\epsilon+\\sqrt{\\epsilon^{2}+\\Delta^{2}}}{\\Delta}\\right).\n$$\nHence,\n$$\n\\int_{-\\hbar \\omega_{D}}^{\\hbar \\omega_{D}}\\frac{d\\epsilon}{\\sqrt{\\epsilon^{2}+\\Delta^{2}}}\n=2\\,\\operatorname{arsinh}\\!\\left(\\frac{\\hbar \\omega_{D}}{\\Delta}\\right)\n=2\\,\\ln\\!\\left(\\frac{\\hbar \\omega_{D}+\\sqrt{(\\hbar \\omega_{D})^{2}+\\Delta^{2}}}{\\Delta}\\right),\n$$\nwhich is strictly positive and finite for any real $\\Delta0$.\n\nSubstitute this into the gap equation:\n$$\n1=\\frac{V N(0)}{2}\\times 2\\,\\operatorname{arsinh}\\!\\left(\\frac{\\hbar \\omega_{D}}{\\Delta}\\right)\n=V N(0)\\,\\operatorname{arsinh}\\!\\left(\\frac{\\hbar \\omega_{D}}{\\Delta}\\right).\n$$\nSince $N(0)0$ and $\\operatorname{arsinh}(\\hbar \\omega_{D}/\\Delta)0$ for $\\Delta0$, the sign of the right-hand side is the sign of $V$. Therefore:\n- If $V0$ (effective attraction), the right-hand side is positive, and a non-trivial solution $\\Delta0$ can exist.\n- If $V0$ (purely repulsive interaction), the right-hand side is strictly negative, whereas the left-hand side is $10$. Thus the equality cannot be satisfied for any real $\\Delta0$.\n\nThis shows that with a purely repulsive, momentum-independent interaction $V0$, there is no non-trivial real gap solution at $T=0$ in this BCS model.\n\nTo address possible misconceptions in the options:\n- Option A is false because increasing $N(0)$ only scales the magnitude of a negative right-hand side when $V0$; it cannot change its sign to match $1$.\n- Option C is not applicable in this real-gap BCS equation; taking $\\Delta$ imaginary would change the integrand to $1/\\sqrt{\\epsilon^{2}-|\\Delta|^{2}}$, leading to nonphysical divergences or complex values within the finite cutoff and does not yield a stable superconducting solution of the original real-gap equation.\n- Option D is false because the integral is finite, as explicitly evaluated above.\n- Option E is false because at finite temperature the gap equation acquires a factor $\\tanh\\!\\left(\\frac{\\sqrt{\\epsilon^{2}+\\Delta^{2}}}{2 k_{B} T}\\right)$ multiplying the integrand; this factor is positive and less than or equal to $1$, so with $V0$ the right-hand side remains negative and cannot equal $1$ for any $T$.\n\nTherefore, the correct statement is that a non-trivial superconducting gap cannot form for $V0$ in this model because the right-hand side is necessarily negative while the left-hand side is positive.", "answer": "$$\\boxed{B}$$", "id": "1766635"}, {"introduction": "Textbook derivations of the BCS gap often rely on a simplified 'square-box' interaction potential, which is constant within a specific energy window. This exercise moves toward a more physically realistic model where the pairing interaction, mediated by bosons like phonons, has a softer energy dependence described by a Lorentzian function. By solving the gap equation with this more nuanced interaction kernel, you will develop valuable analytical skills and gain insight into how the energy scale of the pairing glue, $\\hbar\\omega_0$, directly determines the magnitude of the superconducting gap $\\Delta$. [@problem_id:632124]", "problem": "In the Bardeen-Cooper-Schrieffer (BCS) theory of superconductivity, the energy gap $\\Delta$ at zero temperature ($T=0$) for a simple s-wave superconductor is determined by the following integral equation:\n$$ 1 = \\frac{1}{2} \\int_{-\\infty}^{\\infty} d\\xi' \\frac{g(\\xi')}{\\sqrt{\\xi'^2 + \\Delta^2}} $$\nHere, $\\xi'$ is the single-particle energy measured relative to the Fermi energy, and $g(\\xi') = -N(0)V(\\xi')$ is the dimensionless effective pairing interaction, where $N(0)$ is the (constant) density of electronic states at the Fermi level and $V(\\xi')$ is the energy-dependent pairing potential.\n\nIn the standard textbook model, $g(\\xi')$ is assumed to be a constant $g$ within a finite energy shell $(-\\hbar\\omega_D, \\hbar\\omega_D)$ around the Fermi level and zero otherwise. Consider a more realistic model where the interaction, mediated by bosons (e.g., phonons), has a softer energy dependence. Specifically, assume the interaction is described by a Lorentzian function centered at zero energy transfer:\n$$ g(\\xi') = g_0 \\frac{(\\hbar\\omega_0)^2}{\\xi'^2 + (\\hbar\\omega_0)^2} $$\nwhere $g_0$ is the dimensionless coupling constant at zero energy transfer, and $\\hbar\\omega_0$ represents the characteristic energy scale of the mediating bosons.\n\nYour task is to solve the gap equation for this Lorentzian interaction model. Determine the leading-order expression for the superconducting energy gap $\\Delta$ as a function of $g_0$, $\\hbar$, and $\\omega_0$ in the weak-coupling limit, defined by $g_0 \\ll 1$.", "solution": "1.  Gap equation with Lorentzian $g$:\n$$1=\\frac12\\int_{-\\infty}^{\\infty}d\\xi'\\;\\frac{g_0\\,(\\hbar\\omega_0)^2}{(\\xi'^2+(\\hbar\\omega_0)^2)\\sqrt{\\xi'^2+\\Delta^2}}\\,. $$\n\n2.  Use evenness of integrand:\n$$1=g_0\\,(\\hbar\\omega_0)^2\\int_0^{\\infty}\\frac{d\\xi'}{(\\xi'^2+(\\hbar\\omega_0)^2)\\,\\sqrt{\\xi'^2+\\Delta^2}}\\,. $$\n\n3.  Substitute $\\xi'=\\Delta\\sinh t$, so $d\\xi'=\\Delta\\cosh t\\,dt$ and $\\sqrt{\\xi'^2+\\Delta^2}=\\Delta\\cosh t$:\n$$I=\\,(\\hbar\\omega_0)^2\\int_0^{\\infty}\\frac{\\Delta\\cosh t\\,dt}{\\bigl(\\Delta^2\\sinh^2t+(\\hbar\\omega_0)^2\\bigr)\\,\\Delta\\cosh t}\n=\\int_0^{\\infty}\\frac{dt}{1+\\alpha^2\\sinh^2t}\\,,\\quad\\alpha=\\frac{\\Delta}{\\hbar\\omega_0}\\,. $$\n\n4.  For $\\alpha\\ll1$, the integrand≈1 until $\\sinh t\\sim1/\\alpha$, i.e.\\ $t\\sim\\ln(2/\\alpha)$, then decays exponentially.  Hence\n$$I\\simeq \\ln\\!\\bigl(\\tfrac{2}{\\alpha}\\bigr)=\\ln\\!\\bigl(\\tfrac{2\\hbar\\omega_0}{\\Delta}\\bigr)\\,. $$\n\n5.  The gap equation $1=g_0\\,I$ yields\n$$\\frac1{g_0}\\simeq\\ln\\!\\bigl(\\tfrac{2\\hbar\\omega_0}{\\Delta}\\bigr)\n\\quad\\Longrightarrow\\quad \\Delta\\simeq2\\hbar\\omega_0\\exp\\!\\Bigl(-\\frac1{g_0}\\Bigr)\\,. $$", "answer": "$$\\boxed{2\\hbar\\omega_0\\exp\\!\\Bigl(-\\frac{1}{g_0}\\Bigr)}$$", "id": "632124"}, {"introduction": "Analytical solutions to the BCS equations are often limited to idealized cases, such as zero temperature or constant density of states. This final practice challenges you to tackle the theory in its more general form by implementing a full numerical solution for the coupled gap and number equations at finite temperature. You will develop a multidimensional root-finding algorithm to self-consistently determine the superconducting gap $\\Delta$ and the chemical potential $\\mu$, a powerful technique that mirrors the methods used in modern computational condensed matter research. [@problem_id:2415410]", "problem": "Consider the finite-temperature mean-field theory of weak-coupling superconductivity known as Bardeen–Cooper–Schrieffer (BCS) theory (Bardeen–Cooper–Schrieffer (BCS)). In a simplified model with a single, featureless electronic band of finite width and a constant density of states, the self-consistency condition for the superconducting energy gap and the conservation of particle number can be reduced to two coupled, nonlinear integral equations for the unknowns: the superconducting energy gap $\\Delta$ and the chemical potential $\\mu$. Your task is to solve these two equations simultaneously for $\\Delta$ and $\\mu$ using a multidimensional root-finding algorithm, and to report the value of $\\Delta$ for specified parameter sets.\n\nAssume the following physically standard and well-tested ingredients as the fundamental base:\n- The quasiparticle excitation energy is $E(\\varepsilon) = \\sqrt{(\\varepsilon - \\mu)^2 + \\Delta^2}$, where $\\varepsilon$ is the single-particle energy within the band.\n- The Fermi–Dirac distribution is $f(E) = \\left(1 + e^{E/(k_{\\mathrm{B}} T)}\\right)^{-1}$, and the combination $\\tanh\\!\\left(E/(2 k_{\\mathrm{B}} T)\\right)$ appears in thermal expectation values. Use the Boltzmann constant in energy units $k_{\\mathrm{B}} = 0.08617333262145\\,\\mathrm{meV/K}$.\n- The electronic band is flat with a constant total (including spin) density of states $N_0$ over a finite bandwidth $W$ centered at zero energy, i.e., $\\varepsilon \\in [-W/2, W/2]$, and $N_0 = 1/W$ so that the total number of single-particle states per site within the band is unity.\n- The attractive pairing interaction is nonzero only within a symmetric energy window of half-width $\\omega_{\\mathrm{D}}$ (Debye cutoff) around $\\mu$, and is characterized by a dimensionless coupling $\\lambda = g N_0$, where $g$ is the pairing interaction strength. In the constant density-of-states model, the coupling enters only through $\\lambda$.\n\nStarting from these definitions and using the standard mean-field decoupling for a singlet superconductor, the coupled equations to be solved for $\\Delta$ and $\\mu$ at temperature $T$ are:\n- The gap self-consistency equation in a form that admits the normal-state solution $\\Delta = 0$:\n$$\nF_{\\Delta}(\\Delta,\\mu;T,\\lambda,\\omega_{\\mathrm{D}},W) \\equiv \\Delta - \\lambda \\int_{\\mathcal{I}_{\\mathrm{D}}} \\frac{\\Delta}{2 E(\\varepsilon)} \\tanh\\!\\left(\\frac{E(\\varepsilon)}{2 k_{\\mathrm{B}} T}\\right) \\, \\mathrm{d}\\varepsilon = 0,\n$$\nwhere the Debye integration window is $\\mathcal{I}_{\\mathrm{D}} = \\{\\varepsilon \\in [-W/2, W/2] : |\\varepsilon - \\mu| \\le \\omega_{\\mathrm{D}}\\}$.\n- The number conservation equation that fixes the filling fraction $\\nu \\in [0,1]$:\n$$\nF_{n}(\\Delta,\\mu;T,\\nu,W) \\equiv \\nu - \\int_{-W/2}^{W/2} N_0 \\left[ 1 - \\frac{\\varepsilon - \\mu}{E(\\varepsilon)} \\tanh\\!\\left(\\frac{E(\\varepsilon)}{2 k_{\\mathrm{B}} T}\\right) \\right] \\mathrm{d}\\varepsilon = 0,\n$$\nwith $N_0 = 1/W$.\n\nNotes:\n- In the normal state above the critical temperature, the solution $\\Delta = 0$ with a suitable $\\mu$ must satisfy $F_{\\Delta} = 0$ and $F_{n} = 0$ simultaneously, due to the explicit factor of $\\Delta$ in $F_{\\Delta}$.\n- All energies in this problem, including $\\Delta$, $\\mu$, $W$, and $\\omega_{\\mathrm{D}}$, must be expressed in $\\mathrm{meV}$, and temperature in $\\mathrm{K}$. Angles do not appear, so no angle unit is needed.\n\nYour program must implement a robust multidimensional root-finding method to solve the system\n$$\n\\mathbf{F}(\\Delta,\\mu) = \\begin{bmatrix} F_{\\Delta}(\\Delta,\\mu;T,\\lambda,\\omega_{\\mathrm{D}},W) \\\\ F_{n}(\\Delta,\\mu;T,\\nu,W) \\end{bmatrix} = \\mathbf{0}\n$$\nfor each test case. Numerical evaluation of the integrals is required; use a method that achieves stable convergence for small $\\Delta$ and for temperatures near the superconducting transition.\n\nTest Suite:\nUse the following parameter sets, specified as tuples $(W\\,\\mathrm{[meV]}, \\omega_{\\mathrm{D}}\\,\\mathrm{[meV]}, \\lambda, \\nu, T\\,\\mathrm{[K]})$.\n\n- Case $\\mathrm{A}$ (happy path, below critical temperature): $(200, 20, 0.3, 0.5, 5)$.\n- Case $\\mathrm{B}$ (normal state, above critical temperature): $(200, 20, 0.3, 0.5, 12)$.\n- Case $\\mathrm{C}$ (near critical temperature): $(200, 20, 0.3, 0.5, 9.5)$.\n- Case $\\mathrm{D}$ (off half-filling, below critical temperature): $(200, 20, 0.3, 0.3, 5)$.\n\nRequired Output:\n- For each test case, return the superconducting energy gap $\\Delta$ in $\\mathrm{meV}$ as a floating-point number rounded to $6$ decimal places.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the same order as the test suite: for example, $[\\Delta_{\\mathrm{A}},\\Delta_{\\mathrm{B}},\\Delta_{\\mathrm{C}},\\Delta_{\\mathrm{D}}]$.\n\nConstraints and guidance:\n- Implement a genuine multidimensional root-finding strategy to solve for $\\Delta$ and $\\mu$ simultaneously for each case; do not reduce the system to a single equation.\n- Ensure numerical stability when $\\Delta \\rightarrow 0$ by designing the integrals and function evaluations to avoid spurious divergences.\n- All calculations must be self-contained and require no user input. Use only the standard libraries plus the specified numerical libraries.", "solution": "The problem presented is a standard, well-posed problem in computational condensed matter physics. It requires the simultaneous numerical solution of two coupled, nonlinear integral equations that determine the state of a simple model superconductor within the Bardeen–Cooper–Schrieffer (BCS) mean-field theory. All provided equations, definitions, and parameters are scientifically sound and self-consistent. The problem is valid.\n\nThe task is to find the values of the superconducting energy gap, $\\Delta$, and the chemical potential, $\\mu$, that satisfy the system of equations $\\mathbf{F}(\\Delta, \\mu) = \\mathbf{0}$, where the vector function $\\mathbf{F}$ is given by:\n$$\n\\mathbf{F}(\\Delta,\\mu) = \\begin{bmatrix} F_{\\Delta}(\\Delta,\\mu) \\\\ F_{n}(\\Delta,\\mu) \\end{bmatrix} = \\mathbf{0}\n$$\nThe components of this vector function are defined as:\n$$\nF_{\\Delta}(\\Delta,\\mu) = \\Delta - \\lambda \\int_{\\mathcal{I}_{\\mathrm{D}}} \\frac{\\Delta}{2 E(\\varepsilon)} \\tanh\\!\\left(\\frac{E(\\varepsilon)}{2 k_{\\mathrm{B}} T}\\right) \\, \\mathrm{d}\\varepsilon\n$$\n$$\nF_{n}(\\Delta,\\mu) = \\nu - \\int_{-W/2}^{W/2} N_0 \\left[ 1 - \\frac{\\varepsilon - \\mu}{E(\\varepsilon)} \\tanh\\!\\left(\\frac{E(\\varepsilon)}{2 k_{\\mathrm{B}} T}\\right) \\right] \\mathrm{d}\\varepsilon\n$$\nwhere $E(\\varepsilon) = \\sqrt{(\\varepsilon - \\mu)^2 + \\Delta^2}$, $N_0 = 1/W$, and the integration domain for the gap equation is $\\mathcal{I}_{\\mathrm{D}} = \\{\\varepsilon \\in [-W/2, W/2] : |\\varepsilon - \\mu| \\le \\omega_{\\mathrm{D}}\\}$. The parameters $\\{W, \\omega_{\\mathrm{D}}, \\lambda, \\nu, T\\}$ are provided for each case, and the Boltzmann constant is $k_{\\mathrm{B}} = 0.08617333262145\\,\\mathrm{meV/K}$.\n\nThis system represents a multidimensional root-finding problem. We shall employ a numerical algorithm to solve it. A suitable choice is a quasi-Newton method, such as the Powell hybrid method, which approximates the Jacobian matrix to iteratively find the root. The `scipy.optimize.root` function from the SciPy library, with the `hybr` method, provides a robust implementation of this algorithm.\n\nThe core of the solution involves the implementation of the vector function $\\mathbf{F}(\\Delta, \\mu)$, which requires numerical evaluation of the definite integrals. We use the `scipy.integrate.quad` function for this purpose. Several numerical considerations are critical for a stable and accurate solution:\n\n$1$. **Evaluation of $F_{\\Delta}$**: The integration limits for the gap equation depend on the variable $\\mu$. They must be dynamically calculated as $[\\max(-W/2, \\mu - \\omega_{\\mathrm{D}}), \\min(W/2, \\mu + \\omega_{\\mathrm{D}})]$. The integrand contains the term $\\Delta/E(\\varepsilon)$. This term is well-behaved for $\\Delta  0$. If $\\Delta = 0$, the integrand is identically zero, and thus $F_{\\Delta}(0, \\mu) = 0$ for any $\\mu$. This correctly captures the normal state as a trivial solution to the gap equation. The equation is odd with respect to $\\Delta$; if $(\\Delta_s, \\mu_s)$ is a solution, so is $(-\\Delta_s, \\mu_s)$. The physical energy gap is, by convention, non-negative, corresponding to the positive root.\n\n$2$. **Evaluation of $F_{n}$**: The integrand of the number conservation equation features the term $(\\varepsilon-\\mu)/E(\\varepsilon)$. In the limit $\\Delta \\to 0$, $E(\\varepsilon) \\to |\\varepsilon - \\mu|$, and this term approaches $\\mathrm{sgn}(\\varepsilon - \\mu)$, which is discontinuous at $\\varepsilon=\\mu$. To ensure numerical accuracy, the `quad` integrator must be made aware of this potential singularity. This is achieved by passing the location $\\mu$ to the `points` argument of the `quad` function. The number equation depends only on $\\Delta^2$, making it an even function of $\\Delta$.\n\n$3$. **Initial Guesses**: The convergence of iterative root-finding algorithms is highly dependent on the initial guess for the solution vector $(\\Delta_0, \\mu_0)$. A physically motivated choice is essential:\n-   For the chemical potential $\\mu_0$, at half-filling ($\\nu=0.5$), particle-hole symmetry dictates that $\\mu \\approx 0$. Away from half-filling, a reasonable initial guess is the chemical potential of the non-interacting system at zero temperature, given by $\\mu_0 = W(\\nu - 0.5)$.\n-   For the energy gap $\\Delta_0$, we estimate the BCS critical temperature using the weak-coupling approximation: $k_B T_c \\approx 1.13 \\omega_D e^{-1/\\lambda}$. For the given parameters $\\lambda=0.3$ and $\\omega_D=20\\,\\mathrm{meV}$, we find $T_c \\approx 9.35\\,\\mathrm{K}$. If the system temperature $T$ is below $T_c$, a superconducting state with $\\Delta  0$ is expected, and a non-zero initial guess (e.g., $\\Delta_0 = 1.0\\,\\mathrm{meV}$) is appropriate. If $T  T_c$, the system is in the normal state, so we expect $\\Delta = 0$. An initial guess of $\\Delta_0 \\approx 0$ will guide the solver to this solution.\n\nThe overall procedure is as follows: For each test case, we construct the vector function $\\mathbf{F}$ using the specified parameters. We then provide this function, along with a carefully chosen initial guess $(\\Delta_0, \\mu_0)$, to the `scipy.optimize.root` solver. The solver returns the solution vector $(\\Delta^*, \\mu^*)$. We report the physical gap, which is the non-negative value $|\\Delta^*|$, for each case. For results where $|\\Delta^*|$ is numerically indistinguishable from zero (e.g., $ 10^{-9}$), we set it to exactly $0.0$.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import root\nfrom scipy.integrate import quad\n\n# Define constants\nK_B = 0.08617333262145  # Boltzmann constant in meV/K\n\ndef system_equations(x, W, omega_D, lambda_, nu, T):\n    \"\"\"\n    Defines the system of nonlinear equations F(x) = 0 for the BCS problem.\n    x: array-like, x[0] = Delta (gap), x[1] = mu (chemical potential)\n    W, omega_D, lambda_, nu, T: parameters of the model.\n    \"\"\"\n    delta, mu = x\n    N0 = 1.0 / W\n\n    # --- F_delta equation ---\n    # F_delta = delta - lambda * integral_delta\n    # Integrand for the gap equation.\n    def integrand_delta(eps, d, m):\n        # The equation from the problem is F_delta = delta - lambda * integral(delta/E * ...).\n        # It is odd in delta. We must use the 'd' from the solver, not abs(d).\n        # We handle d=0 as a special case to avoid division by zero in the term delta/E.\n        if d == 0.0:\n            return 0.0\n        \n        # The argument of sqrt is delta^2, so it's always non-negative.\n        E_eps = np.sqrt((eps - m)**2 + d**2)\n        if E_eps == 0.0: # Should not happen if d != 0\n            return 0.0\n        \n        tanh_term = np.tanh(E_eps / (2.0 * K_B * T))\n        return (d / (2.0 * E_eps)) * tanh_term\n\n    # Integration bounds for the gap equation.\n    lower_d = max(-W / 2.0, mu - omega_D)\n    upper_d = min(W / 2.0, mu + omega_D)\n    \n    integral_delta = 0.0\n    # Perform integration only if the interval is valid.\n    if lower_d  upper_d:\n        integral_delta, _ = quad(integrand_delta, lower_d, upper_d, args=(delta, mu), epsabs=1e-11, epsrel=1e-11)\n    \n    f_delta = delta - lambda_ * integral_delta\n\n    # --- F_n equation ---\n    # F_n = nu - integral_n\n    # The number equation depends on delta^2, so using abs(delta) is robust.\n    delta_abs = abs(delta)\n    \n    # Integrand for the number equation.\n    def integrand_n(eps, d_abs, m):\n        E_eps = np.sqrt((eps - m)**2 + d_abs**2)\n        \n        if E_eps == 0.0:  # Occurs only if d_abs=0 and eps=m\n            # The limit of the term ((eps-m)/E_eps) * tanh(E_eps/...) is 0 as eps-m.\n            frac_term = 0.0\n        else:\n            tanh_term = np.tanh(E_eps / (2.0 * K_B * T))\n            frac_term = ((eps - m) / E_eps) * tanh_term\n            \n        return N0 * (1.0 - frac_term)\n    \n    # Integration for number equation over the full band.\n    # We specify mu as a point of potential discontinuity for the integrator.\n    points_of_interest = [mu] if -W / 2.0  mu  W / 2.0 else None\n    integral_n, _ = quad(integrand_n, -W / 2.0, W / 2.0, args=(delta_abs, mu), points=points_of_interest, epsabs=1e-11, epsrel=1e-11)\n    \n    f_n = nu - integral_n\n    \n    return [f_delta, f_n]\n\ndef solve():\n    \"\"\"\n    Solves the BCS equations for each test case and prints the results.\n    \"\"\"\n    test_cases = [\n        # (W [meV], omega_D [meV], lambda, nu, T [K])\n        (200.0, 20.0, 0.3, 0.5, 5.0),    # Case A\n        (200.0, 20.0, 0.3, 0.5, 12.0),   # Case B\n        (200.0, 20.0, 0.3, 0.5, 9.5),    # Case C\n        (200.0, 20.0, 0.3, 0.3, 5.0),    # Case D\n    ]\n\n    # Initial guesses (Delta_0, mu_0) based on physical considerations.\n    initial_guesses = [\n        # T_c is approx 9.35 K. W(nu-0.5) gives mu_0 for non-half-filled cases.\n        (1.0, 0.0),      # A: T  T_c, nu=0.5 - expect Delta  0, mu=0\n        (0.01, 0.0),     # B: T  T_c, nu=0.5 - expect Delta = 0, mu=0\n        (0.1, 0.0),      # C: T ~ T_c, nu=0.5 - expect Delta small or 0, mu=0\n        (1.0, -40.0),    # D: T  T_c, nu=0.3 - expect Delta  0, mu=200(0.3-0.5)=-40\n    ]\n\n    results = []\n    for i, params in enumerate(test_cases):\n        x0 = initial_guesses[i]\n        \n        # Use a robust root-finding algorithm.\n        solution = root(system_equations, x0, args=params, method='hybr', tol=1e-9)\n        \n        if solution.success:\n            delta_sol = solution.x[0]\n            \n            # The physical gap parameter is non-negative.\n            # If the solver returns a small negative value, it is numerically zero.\n            if abs(delta_sol)  1e-9:\n                delta_sol = 0.0\n            \n            # Report the magnitude of the gap.\n            results.append(abs(delta_sol))\n        else:\n            # Append NaN or handle error if solver fails, for robustness.\n            results.append(np.nan)\n\n    # Format the final output as a comma-separated list of strings,\n    # with each value rounded to 6 decimal places.\n    formatted_results = [f\"{res:.6f}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2415410"}]}