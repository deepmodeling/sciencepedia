{"hands_on_practices": [{"introduction": "The fundamental question of recurrence is whether a random walker will eventually return to its starting point. For the simple symmetric random walk on the integer line $\\mathbb{Z}$, the answer depends on whether the sum of return probabilities, $\\sum_{n} p_{2n}(0)$, diverges. This exercise guides you through a foundational calculation to determine the asymptotic behavior of $p_{2n}(0)$ using combinatorial arguments and Stirling's approximation, providing a direct proof of the walk's recurrence. [@problem_id:2993154]", "problem": "Let $\\{S_{n}\\}_{n \\geq 0}$ be the simple symmetric random walk on $\\mathbb{Z}$ started at $0$, defined by $S_{0}=0$ and $S_{n}=\\sum_{j=1}^{n}X_{j}$ where $\\{X_{j}\\}_{j \\geq 1}$ are independent and identically distributed with $\\mathbb{P}(X_{1}=1)=\\mathbb{P}(X_{1}=-1)=\\tfrac{1}{2}$. For $n \\in \\mathbb{N}$ and $k \\in \\mathbb{Z}$, denote $p_{n}(k)=\\mathbb{P}(S_{n}=k)$.\n\nStarting only from fundamental definitions (convolution of independent increments and either combinatorial counting or characteristic functions) and well-tested formulas (such as Stirling’s approximation for factorials or the Fourier inversion formula on $\\mathbb{Z}$), prove that the limit\n$$\nL \\,=\\, \\lim_{n \\to \\infty} \\sqrt{n}\\,p_{2n}(0)\n$$\nexists and determine its exact value.\n\nYour derivation must begin from a valid foundational base as stated above and include all key steps that justify the limiting procedure. The final answer must be given as a single exact value with no units. Do not round.", "solution": "The problem is to evaluate the limit $L = \\lim_{n \\to \\infty} \\sqrt{n}\\,p_{2n}(0)$ for a simple symmetric random walk $\\{S_{n}\\}$ on $\\mathbb{Z}$ starting at $S_{0}=0$. The probability $\\mathbb{P}(S_{n}=k)$ is denoted by $p_{n}(k)$.\n\nThe problem is well-defined and requires a proof starting from fundamental definitions. We will use a combinatorial argument to determine the exact expression for $p_{2n}(0)$ and then apply Stirling's approximation for factorials to evaluate the limit. This approach is explicitly permitted by the problem statement.\n\nFirst, we determine an exact combinatorial expression for $p_{2n}(0) = \\mathbb{P}(S_{2n}=0)$. The random walk $S_{n}$ is the sum of $n$ independent and identically distributed increments $\\{X_j\\}$, where $\\mathbb{P}(X_j=1) = \\mathbb{P}(X_j=-1) = \\frac{1}{2}$. At time $2n$, the position is $S_{2n} = \\sum_{j=1}^{2n} X_j$. For the walk to return to the origin, $S_{2n}=0$, the number of steps to the right (value $+1$) must be equal to the number of steps to the left (value $-1$). Let $N_+$ be the number of $+1$ steps and $N_-$ be the number of $-1$ steps. We have two conditions:\n1. The total number of steps is $2n$: $N_+ + N_- = 2n$.\n2. The final position is $0$: $N_+ - N_- = 0$.\n\nSolving this system of linear equations gives $N_+ = N_- = n$.\nThe total number of distinct paths of length $2n$ is $2^{2n}$, since each of the $2n$ steps has two possible outcomes. Each specific path has a probability of $(\\frac{1}{2})^{2n}$.\nThe number of paths that result in a return to the origin is the number of ways to choose the positions of the $n$ positive steps among the $2n$ total steps. This is given by the central binomial coefficient $\\binom{2n}{n}$.\n\nTherefore, the probability of being at the origin at time $2n$ is the product of the number of favorable paths and the probability of any single path:\n$$\np_{2n}(0) = \\binom{2n}{n} \\left(\\frac{1}{2}\\right)^{2n} = \\frac{(2n)!}{(n!)^2} \\frac{1}{2^{2n}}\n$$\nTo evaluate the limit as $n \\to \\infty$, we employ Stirling's approximation for the factorial function, which is a well-tested formula appropriate for this context. For large $m$, the asymptotic formula is:\n$$\nm! \\sim \\sqrt{2\\pi m} \\left(\\frac{m}{e}\\right)^m\n$$\nwhere the notation $a_n \\sim b_n$ means $\\lim_{n \\to \\infty} \\frac{a_n}{b_n} = 1$.\n\nWe apply this approximation to the factorials in the expression for $\\binom{2n}{n}$:\n$$\n(2n)! \\sim \\sqrt{2\\pi(2n)} \\left(\\frac{2n}{e}\\right)^{2n} = \\sqrt{4\\pi n} \\left(\\frac{2n}{e}\\right)^{2n}\n$$\nand\n$$\n(n!)^2 \\sim \\left(\\sqrt{2\\pi n} \\left(\\frac{n}{e}\\right)^n\\right)^2 = 2\\pi n \\left(\\frac{n}{e}\\right)^{2n}\n$$\nNow, we find the asymptotic behavior of the binomial coefficient:\n$$\n\\binom{2n}{n} = \\frac{(2n)!}{(n!)^2} \\sim \\frac{\\sqrt{4\\pi n} \\left(\\frac{2n}{e}\\right)^{2n}}{2\\pi n \\left(\\frac{n}{e}\\right)^{2n}}\n$$\nSimplifying this expression:\n$$\n\\binom{2n}{n} \\sim \\frac{2\\sqrt{\\pi n}}{2\\pi n} \\frac{(2n)^{2n} e^{-2n}}{n^{2n} e^{-2n}} = \\frac{1}{\\sqrt{\\pi n}} \\frac{2^{2n}n^{2n}}{n^{2n}} = \\frac{2^{2n}}{\\sqrt{\\pi n}}\n$$\nThis gives the asymptotic behavior of the central binomial coefficient.\n\nNext, we substitute this asymptotic expression back into our formula for $p_{2n}(0)$:\n$$\np_{2n}(0) = \\binom{2n}{n} \\frac{1}{2^{2n}} \\sim \\left(\\frac{2^{2n}}{\\sqrt{\\pi n}}\\right) \\frac{1}{2^{2n}} = \\frac{1}{\\sqrt{\\pi n}}\n$$\nWe have thus proven that $p_{2n}(0) \\sim \\frac{1}{\\sqrt{\\pi n}}$.\n\nFinally, we can evaluate the required limit $L$:\n$$\nL = \\lim_{n \\to \\infty} \\sqrt{n}\\,p_{2n}(0)\n$$\nBased on the asymptotic equivalence we found, we can substitute the asymptotic form of $p_{2n}(0)$:\n$$\nL = \\lim_{n \\to \\infty} \\sqrt{n} \\left(\\frac{1}{\\sqrt{\\pi n}}\\right) = \\lim_{n \\to \\infty} \\frac{\\sqrt{n}}{\\sqrt{\\pi}\\sqrt{n}} = \\lim_{n \\to \\infty} \\frac{1}{\\sqrt{\\pi}}\n$$\nThe limit is a constant, so we have:\n$$\nL = \\frac{1}{\\sqrt{\\pi}}\n$$\nThe existence of the limit is established by the successful derivation of its value using valid asymptotic approximations.", "answer": "$$\\boxed{\\frac{1}{\\sqrt{\\pi}}}$$", "id": "2993154"}, {"introduction": "When we move from the line to the two-dimensional plane, the question of recurrence becomes more subtle, as the walker has more \"room\" to get lost. This practice introduces a more powerful method than direct counting: using Fourier analysis to study the potential kernel $a(x)$. By deriving the logarithmic growth of the potential kernel for large distances, you will not only prove that the 2D walk is recurrent but also gain a quantitative understanding of why it represents a critical dimension for random walks. [@problem_id:2993109]", "problem": "Consider the two-dimensional simple random walk on the integer lattice $\\mathbb{Z}^{2}$ with steps uniformly distributed on $\\{(\\pm 1,0),(0,\\pm 1)\\}$. Let $(S_{n})_{n\\geq 0}$ denote the walk started from $S_{0}=0$, and let $p_{n}(x)=\\mathbb{P}(S_{n}=x)$. Define the potential kernel\n$$\na(x)=\\sum_{n=0}^{\\infty}\\big(p_{n}(0)-p_{n}(x)\\big),\\quad x\\in\\mathbb{Z}^{2}.\n$$\nIt is known that $a(x)$ is finite for each fixed $x$ and grows logarithmically in $\\|x\\|$ as $\\|x\\|\\to\\infty$. Using Fourier analysis near $\\theta=0$, derive the logarithmic asymptotics\n$$\na(x)\\sim c\\,\\log \\|x\\|\n$$\nas $\\|x\\|\\to\\infty$, where $\\|\\cdot\\|$ denotes the Euclidean norm on $\\mathbb{R}^{2}$, and determine the exact constant $c$. Your derivation must start from fundamental definitions: the characteristic function $\\phi(\\theta)=\\mathbb{E}[\\exp(i\\,\\theta\\cdot X_{1})]$ of the step distribution, the convolution structure of $(p_{n})_{n\\geq 0}$, and Fourier inversion on the torus $[-\\pi,\\pi]^{2}$ for lattice random walks. You must justify the localization of the integral to a neighborhood of $\\theta=0$ and all asymptotic approximations used. Express your final answer as the exact value of the constant $c$. No rounding is required. The final answer must be a single constant.", "solution": "The problem asks for the derivation of the asymptotic behavior of the potential kernel $a(x)$ for a simple symmetric random walk on the two-dimensional integer lattice $\\mathbb{Z}^2$, and the determination of the constant $c$ in the relation $a(x) \\sim c \\ln \\|x\\|$ as $\\|x\\| \\to \\infty$.\n\n**Step 1: Fourier Representation of the Potential Kernel**\nLet the random walk be denoted by $(S_n)_{n \\ge 0}$, where $S_n = \\sum_{k=1}^n X_k$ and $S_0=0$. The steps $X_k$ are independent and identically distributed random variables, each taking values in $\\{(1,0), (-1,0), (0,1), (0,-1)\\}$ with probability $1/4$. The characteristic function of a single step $X_1$ is given by\n$$\n\\phi(\\theta) = \\mathbb{E}[\\exp(i\\,\\theta\\cdot X_1)] = \\frac{1}{2}(\\cos(\\theta_1) + \\cos(\\theta_2))\n$$\nfor $\\theta = (\\theta_1, \\theta_2) \\in [-\\pi, \\pi]^2$. The probability $p_n(x) = \\mathbb{P}(S_n = x)$ is recovered via Fourier inversion:\n$$\np_n(x) = \\frac{1}{(2\\pi)^2} \\int_{[-\\pi, \\pi]^2} e^{-ix\\cdot\\theta} (\\phi(\\theta))^n \\,d^2\\theta.\n$$\nSubstituting this into the definition of the potential kernel $a(x) = \\sum_{n=0}^{\\infty} (p_n(0) - p_n(x))$ and exchanging summation and integration (justified by Fubini-Tonelli's theorem since the real part of the integrand is non-negative):\n$$\na(x) = \\frac{1}{(2\\pi)^2} \\int_{[-\\pi, \\pi]^2} (1 - e^{-ix\\cdot\\theta}) \\sum_{n=0}^{\\infty} (\\phi(\\theta))^n \\,d^2\\theta.\n$$\nFor $\\theta \\neq 0$, $|\\phi(\\theta)|  1$, so the geometric series converges. Taking the real part of the integrand gives:\n$$\na(x) = \\frac{1}{(2\\pi)^2} \\int_{[-\\pi, \\pi]^2} \\frac{1 - \\cos(x\\cdot\\theta)}{1 - \\phi(\\theta)} \\,d^2\\theta.\n$$\n\n**Step 2: Asymptotic Analysis for large $\\|x\\|$}\nThe asymptotic behavior of $a(x)$ for large $\\|x\\|$ is determined by the singularity of the integrand at $\\theta=0$. For $\\theta$ near $0$, we use the Taylor expansion $\\cos(u) = 1 - u^2/2 + O(u^4)$ to approximate the denominator:\n$$\n1 - \\phi(\\theta) = 1 - \\frac{1}{2}\\left(\\left(1-\\frac{\\theta_1^2}{2} + O(\\theta_1^4)\\right) + \\left(1-\\frac{\\theta_2^2}{2} + O(\\theta_2^4)\\right)\\right) = \\frac{1}{4}(\\theta_1^2+\\theta_2^2) + O(\\|\\theta\\|^4).\n$$\nLet $Q(\\theta) = \\frac{1}{4}\\|\\theta\\|^2$. The integrand is well-approximated by $\\frac{1 - \\cos(x\\cdot\\theta)}{Q(\\theta)}$ for small $\\theta$. The integral of the difference, $\\int \\left(\\frac{1}{1-\\phi(\\theta)} - \\frac{1}{Q(\\theta)}\\right)(1-\\cos(x\\cdot\\theta))d^2\\theta$, is bounded in $x$ by the Riemann-Lebesgue lemma, as the term in parentheses is bounded. Thus, it does not contribute to the logarithmic growth. The asymptotic behavior is given by the principal integral:\n$$\na(x) \\sim \\frac{1}{(2\\pi)^2} \\int_{[-\\pi, \\pi]^2} \\frac{1 - \\cos(x\\cdot\\theta)}{\\frac{1}{4}\\|\\theta\\|^2} \\,d^2\\theta = \\frac{1}{\\pi^2} \\int_{[-\\pi, \\pi]^2} \\frac{1 - \\cos(x\\cdot\\theta)}{\\|\\theta\\|^2} \\,d^2\\theta.\n$$\nFor large $\\|x\\|$, the main contribution comes from small $\\|\\theta\\|$, so we can extend the integration domain to $\\mathbb{R}^2$ with bounded error. By rotational symmetry, let $x=(R,0)$ where $R=\\|x\\|$.\n$$\na(x) \\sim \\frac{1}{\\pi^2} \\int_{\\mathbb{R}^2} \\frac{1 - \\cos(R\\theta_1)}{\\theta_1^2+\\theta_2^2} \\,d\\theta_1 d\\theta_2.\n$$\nWe switch to polar coordinates for $\\theta$: $\\theta_1=r\\cos\\alpha$, $\\theta_2=r\\sin\\alpha$, $d^2\\theta = r dr d\\alpha$.\n$$\na(R,0) \\sim \\frac{1}{\\pi^2} \\int_0^\\infty \\int_0^{2\\pi} \\frac{1-\\cos(Rr\\cos\\alpha)}{r^2} r\\,dr\\,d\\alpha = \\frac{1}{\\pi^2} \\int_0^\\infty \\frac{1}{r} \\left( \\int_0^{2\\pi} (1 - \\cos(Rr\\cos\\alpha)) \\,d\\alpha \\right) dr.\n$$\nThe inner integral is related to the Bessel function of the first kind, $J_0(z) = \\frac{1}{2\\pi}\\int_0^{2\\pi}\\cos(z\\cos\\alpha)\\,d\\alpha$.\n$$\n\\int_0^{2\\pi} (1 - \\cos(Rr\\cos\\alpha)) \\,d\\alpha = 2\\pi - 2\\pi J_0(Rr).\n$$\nSubstituting this back:\n$$\na(R,0) \\sim \\frac{2\\pi}{\\pi^2} \\int_0^\\infty \\frac{1-J_0(Rr)}{r} \\,dr = \\frac{2}{\\pi} \\int_0^\\infty \\frac{1-J_0(Rr)}{r} \\,dr.\n$$\nLet $u = Rr$. Then $r=u/R$ and $dr = du/R$.\n$$\na(R,0) \\sim \\frac{2}{\\pi} \\int_0^\\infty \\frac{1-J_0(u)}{u/R} \\frac{du}{R} = \\frac{2}{\\pi} \\int_0^\\infty \\frac{1-J_0(u)}{u} \\,du.\n$$\nThis is a definite integral whose value is $\\ln(\\gamma) - \\text{Ci}(0) \\approx 0.577...$ but this is not what we want. The asymptotic behavior comes from a more careful analysis of the integration limits. The approximation by $\\mathbb{R}^2$ must be handled carefully. The correct procedure involves a change of variables $u = \\|x\\|\\theta$, which leads to\n$$\na(x) \\sim \\frac{1}{\\pi^2} \\int_{\\mathbb{R}^2} \\frac{1-\\cos(u_1)}{\\|u\\|^2} d^2 u\n$$\nThis integral is not what we want. Let's return to the step with the Bessel function. The error in extending the integral from a ball $B_\\delta(0)$ to $\\mathbb{R}^2$ is bounded. So we analyze:\n$$\nI(R) = \\frac{2}{\\pi} \\int_0^{\\delta} \\frac{1-J_0(Rr)}{r} \\,dr.\n$$\nLet $u=Rr$, so $du = R dr$. The integral becomes:\n$$\nI(R) = \\frac{2}{\\pi} \\int_0^{R\\delta} \\frac{1-J_0(u)}{u} \\,du.\n$$\nFor large $T$, the asymptotic behavior of $\\int_0^T \\frac{1-J_0(u)}{u}du$ is $\\ln T$. This is because for small $u$, $1-J_0(u) \\sim u^2/4$, so the integrand is regular at 0. For large $u$, $\\int \\frac{J_0(u)}{u}du$ converges, so $\\int_1^T \\frac{1-J_0(u)}{u}du \\sim \\int_1^T \\frac{1}{u}du = \\ln T$.\nSo, $I(R) \\sim \\frac{2}{\\pi} \\ln(R\\delta) = \\frac{2}{\\pi}(\\ln R + \\ln \\delta)$. The dominant term for large $R=\\|x\\|$ is:\n$$\na(x) \\sim \\frac{2}{\\pi} \\ln\\|x\\|.\n$$\n\n**Step 3: Conclusion**\nBy comparing this result to the required form $a(x) \\sim c \\ln\\|x\\|$, we identify the constant $c$. The derivation, based on Fourier analysis and asymptotic evaluation of the resulting integral, shows that the constant is precisely $2/\\pi$.", "answer": "$$\n\\boxed{\\frac{2}{\\pi}}\n$$", "id": "2993109"}, {"introduction": "The principles of recurrence and transience extend naturally from discrete random walks to their continuous-time counterparts, diffusion processes. This exercise bridges that gap by focusing on standard one-dimensional Brownian motion, the process described by the SDE $dX_t = dW_t$. You will apply the core tools of diffusion theory—the scale function and speed measure—to classify its long-term behavior, thereby re-deriving a classic result from a more general and powerful perspective. [@problem_id:2993119]", "problem": "Consider the one-dimensional diffusion on the entire real line defined as the unique weak solution to the stochastic differential equation (SDE) $dX_{t}=dW_{t}$, where $W_{t}$ is a standard one-dimensional Brownian motion. Starting only from Itô’s formula, the definition of the generator of a diffusion, and the definitions of the scale function and speed measure for one-dimensional diffusions, do the following:\n\n1. Determine a strictly increasing scale function $s$ for $X$ and fix its affine normalization by imposing $s(0)=0$ and $s'(0)=1$.\n2. Determine the speed density $m(x)$ with respect to Lebesgue measure for $X$.\n3. Using the general boundary classification criteria for one-dimensional diffusions expressed in terms of the scale function and the speed measure, deduce whether the diffusion is recurrent or transient on $\\mathbb{R}$.\n\nReport your final answer as the row matrix $\\bigl(s(x),\\,m(x)\\bigr)$ in that order. No numerical approximation is required; provide exact expressions. The recurrence/transience conclusion should be justified in your work but is not part of the final reported matrix.", "solution": "The given stochastic differential equation is $dX_{t}=dW_{t}$. This is a one-dimensional Itô diffusion of the general form $dX_{t} = b(X_t)dt + \\sigma(X_t)dW_{t}$, where the drift coefficient is $b(x) = 0$ and the diffusion coefficient is $\\sigma(x) = 1$.\n\nThe infinitesimal generator $\\mathcal{L}$ of this diffusion process is defined via Itô's formula. For a twice continuously differentiable function $f(x)$, the generator is given by:\n$$\n\\mathcal{L}f(x) = b(x)\\frac{df}{dx} + \\frac{1}{2}\\sigma(x)^2\\frac{d^2f}{dx^2}\n$$\nSubstituting $b(x)=0$ and $\\sigma(x)=1$, the generator for this specific process is:\n$$\n\\mathcal{L}f(x) = \\frac{1}{2}\\frac{d^2f}{dx^2}\n$$\n\n**1. Determination of the Scale Function $s(x)$**\n\nThe scale function $s(x)$ for a one-dimensional diffusion is a non-constant function that satisfies the equation $\\mathcal{L}s(x) = 0$. For this diffusion, the condition is:\n$$\n\\frac{1}{2}\\frac{d^2s}{dx^2} = 0\n$$\nwhich simplifies to $s''(x) = 0$.\nIntegrating this ordinary differential equation twice yields the general form of the scale function:\n$$\ns(x) = C_1 x + C_2\n$$\nwhere $C_1$ and $C_2$ are constants of integration.\n\nThe problem provides two normalization conditions to uniquely determine $s(x)$.\nFirst, $s(0) = 0$:\n$$\ns(0) = C_1(0) + C_2 = 0 \\implies C_2 = 0\n$$\nSecond, $s'(0) = 1$. The derivative is $s'(x) = C_1$. Applying the condition:\n$$\ns'(0) = C_1 = 1\n$$\nThus, the unique, strictly increasing scale function satisfying the given normalization is:\n$$\ns(x) = x\n$$\n\n**2. Determination of the Speed Density $m(x)$**\n\nThe speed density $m(x)$ relates the generator $\\mathcal{L}$ to the scale function $s(x)$. The generator can be written in its Feller-McKean form as $Gf(x) = \\frac{1}{m(x)}\\frac{d}{dx}\\left(\\frac{1}{s'(x)}\\frac{df}{dx}\\right)$. For consistency, this must be identical to the Itô form $\\mathcal{L}f(x) = b(x)f'(x) + \\frac{1}{2}\\sigma(x)^2f''(x)$.\nExpanding the Feller-McKean form:\n$$\nG f(x) = \\frac{1}{m(x)} \\left[ \\frac{f''(x)}{s'(x)} - \\frac{f'(x)s''(x)}{(s'(x))^2} \\right] = \\left(\\frac{1}{m(x)s'(x)}\\right)f''(x) - \\left(\\frac{s''(x)}{m(x)(s'(x))^2}\\right)f'(x)\n$$\nBy comparing the coefficients of the $f''(x)$ term in $Gf(x)$ and $\\mathcal{L}f(x)$, we find:\n$$\n\\frac{1}{2}\\sigma(x)^2 = \\frac{1}{m(x)s'(x)} \\implies m(x) = \\frac{2}{\\sigma(x)^2 s'(x)}\n$$\nUsing this formula with our known values $\\sigma(x)=1$ and $s'(x)=1$:\n$$\nm(x) = \\frac{2}{1^2 \\cdot 1} = 2\n$$\nSo, the speed density is constant, $m(x) = 2$.\n\n**3. Recurrence vs. Transience**\n\nA one-dimensional diffusion on an interval $(l, r)$ is classified as recurrent or transient based on the behavior of its scale function at the boundaries. The process is **recurrent** if and only if the scale function tends to $-\\infty$ at the left boundary and $+\\infty$ at the right boundary.\nMathematically, the diffusion is recurrent if and only if:\n$$\ns(l) = \\lim_{x \\to l^+} s(x) = -\\infty \\quad \\text{and} \\quad s(r) = \\lim_{x \\to r^-} s(x) = +\\infty\n$$\nIf either limit is finite, the process is transient, as it can escape through that boundary.\n\nFor this problem, the diffusion is on the entire real line, so the interval is $(l, r) = (-\\infty, \\infty)$. We have found the scale function to be $s(x) = x$. We evaluate the limits at the boundaries:\n-   At the right boundary, $r = +\\infty$:\n$$\n\\lim_{x \\to \\infty} s(x) = \\lim_{x \\to \\infty} x = +\\infty\n$$\n-   At the left boundary, $l = -\\infty$:\n$$\n\\lim_{x \\to -\\infty} s(x) = \\lim_{x \\to -\\infty} x = -\\infty\n$$\nSince both conditions ($s(-\\infty) = -\\infty$ and $s(+\\infty) = +\\infty$) are satisfied, the diffusion is **recurrent**. This is the well-known property of standard one-dimensional Brownian motion.\n\nThe problem asks for the row matrix $(s(x), m(x))$. Based on our derivations, this is $(x, 2)$.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\nx  2\n\\end{pmatrix}\n}\n$$", "id": "2993119"}]}