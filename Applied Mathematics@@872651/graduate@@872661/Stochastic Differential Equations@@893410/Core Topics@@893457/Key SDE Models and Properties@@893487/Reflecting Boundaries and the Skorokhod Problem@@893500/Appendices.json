{"hands_on_practices": [{"introduction": "The concept of local time is central to understanding reflected processes, as it quantifies the time a process \"spends\" at a boundary, which in turn drives the reflection mechanism. This exercise provides a fundamental calculation using the occupation time formula to find the expected local time of a standard Brownian motion at the origin [@problem_id:2993643]. Mastering this derivation solidifies the connection between the path properties of Brownian motion and the analytical tools used to describe its interaction with boundaries.", "problem": "Consider a one-dimensional standard Brownian motion $B = \\{B_{t}\\}_{t \\geq 0}$ starting at $B_{0} = 0$. The local time at level $x \\in \\mathbb{R}$ up to time $t$, denoted $L_{t}^{x}(B)$, is defined as the occupation density of $B$ at $x$ in the sense that $L^{x}_{t}(B)$ is the Radon–Nikodym derivative of the occupation measure $\\mu_{t}(A) = \\int_{0}^{t} \\mathbf{1}_{\\{B_{s} \\in A\\}} \\,\\mathrm{d}s$ with respect to the Lebesgue measure, that is, it satisfies the occupation time formula $\\int_{0}^{t} g(B_{s}) \\,\\mathrm{d}s = \\int_{\\mathbb{R}} g(x) \\, L_{t}^{x}(B) \\,\\mathrm{d}x$ for all bounded measurable functions $g$. Using only the foundational properties of standard Brownian motion (independent stationary increments, continuity of paths, and its Gaussian transition density) and the occupation time formula, derive a closed-form expression for the expectation $E[L_{t}^{0}(B)]$ as a function of $t$. Your final answer must be an analytical expression. No rounding is required and no units are involved.", "solution": "The problem asks for the expectation of the local time of a one-dimensional standard Brownian motion $B_t$ at level $0$, denoted $E[L_{t}^{0}(B)]$. We are given the occupation time formula, which holds for any bounded measurable function $g: \\mathbb{R} \\to \\mathbb{R}$:\n$$\n\\int_{0}^{t} g(B_{s}) \\,\\mathrm{d}s = \\int_{\\mathbb{R}} g(x) \\, L_{t}^{x}(B) \\,\\mathrm{d}x\n$$\nWe begin by taking the expectation of both sides of this equation.\n$$\nE\\left[\\int_{0}^{t} g(B_{s}) \\,\\mathrm{d}s\\right] = E\\left[\\int_{\\mathbb{R}} g(x) \\, L_{t}^{x}(B) \\,\\mathrm{d}x\\right]\n$$\nBy applying Fubini's theorem (or Tonelli's theorem, since we can assume $g \\ge 0$ without loss of generality and then extend by linearity), we can interchange the expectation and integration operators on both sides.\n\nOn the left-hand side (LHS), we interchange the expectation with the time integral:\n$$\n\\text{LHS} = \\int_{0}^{t} E[g(B_{s})] \\,\\mathrm{d}s\n$$\nOn the right-hand side (RHS), we interchange the expectation with the spatial integral:\n$$\n\\text{RHS} = \\int_{\\mathbb{R}} g(x) E[L_{t}^{x}(B)] \\,\\mathrm{d}x\n$$\nEquating the two sides gives the identity:\n$$\n\\int_{0}^{t} E[g(B_{s})] \\,\\mathrm{d}s = \\int_{\\mathbb{R}} g(x) E[L_{t}^{x}(B)] \\,\\mathrm{d}x\n$$\nNext, we evaluate the term $E[g(B_{s})]$. The process $B$ is a standard Brownian motion starting at $B_{0}=0$. For any time $s > 0$, the random variable $B_{s}$ is normally distributed with mean $0$ and variance $s$. Its probability density function (PDF), $p_{s}(y)$, is given by the Gaussian kernel:\n$$\np_{s}(y) = \\frac{1}{\\sqrt{2\\pi s}} \\exp\\left(-\\frac{y^{2}}{2s}\\right)\n$$\nThe expectation of $g(B_{s})$ is thus given by the integral of $g(y)$ against this density function:\n$$\nE[g(B_{s})] = \\int_{\\mathbb{R}} g(y) p_{s}(y) \\,\\mathrm{d}y = \\int_{\\mathbb{R}} g(y) \\frac{1}{\\sqrt{2\\pi s}} \\exp\\left(-\\frac{y^{2}}{2s}\\right) \\,\\mathrm{d}y\n$$\nSubstituting this expression into the LHS of our identity yields:\n$$\n\\text{LHS} = \\int_{0}^{t} \\left( \\int_{\\mathbb{R}} g(y) \\frac{1}{\\sqrt{2\\pi s}} \\exp\\left(-\\frac{y^{2}}{2s}\\right) \\,\\mathrm{d}y \\right) \\,\\mathrm{d}s\n$$\nWe apply Fubini's theorem again to swap the order of integration over time $s$ and space $y$:\n$$\n\\text{LHS} = \\int_{\\mathbb{R}} g(y) \\left( \\int_{0}^{t} \\frac{1}{\\sqrt{2\\pi s}} \\exp\\left(-\\frac{y^{2}}{2s}\\right) \\,\\mathrm{d}s \\right) \\,\\mathrm{d}y\n$$\nNow, we equate this expression for the LHS with the expression we found for the RHS. To maintain consistent notation for the integration variable, we use $x$ instead of $y$:\n$$\n\\int_{\\mathbb{R}} g(x) \\left( \\int_{0}^{t} \\frac{1}{\\sqrt{2\\pi s}} \\exp\\left(-\\frac{x^{2}}{2s}\\right) \\,\\mathrm{d}s \\right) \\,\\mathrm{d}x = \\int_{\\mathbb{R}} g(x) E[L_{t}^{x}(B)] \\,\\mathrm{d}x\n$$\nThis equality must hold for any bounded measurable function $g$. This implies that the integrands with respect to the measure $g(x)\\mathrm{d}x$ must be equal almost everywhere. Therefore, we can identify $E[L_{t}^{x}(B)]$ as:\n$$\nE[L_{t}^{x}(B)] = \\int_{0}^{t} \\frac{1}{\\sqrt{2\\pi s}} \\exp\\left(-\\frac{x^{2}}{2s}\\right) \\,\\mathrm{d}s\n$$\nThe problem asks for the expected local time at the origin, which corresponds to setting $x=0$:\n$$\nE[L_{t}^{0}(B)] = \\int_{0}^{t} \\frac{1}{\\sqrt{2\\pi s}} \\exp\\left(-\\frac{0^{2}}{2s}\\right) \\,\\mathrm{d}s = \\int_{0}^{t} \\frac{1}{\\sqrt{2\\pi s}} \\,\\mathrm{d}s\n$$\nWe now evaluate this definite integral:\n$$\nE[L_{t}^{0}(B)] = \\frac{1}{\\sqrt{2\\pi}} \\int_{0}^{t} s^{-1/2} \\,\\mathrm{d}s\n$$\nThe antiderivative of $s^{-1/2}$ is $2s^{1/2}$. The integral is improper at the lower bound $s=0$, but it converges.\n$$\n\\int_{0}^{t} s^{-1/2} \\,\\mathrm{d}s = \\left[ 2s^{1/2} \\right]_{0}^{t} = 2t^{1/2} - 2(0)^{1/2} = 2\\sqrt{t}\n$$\nSubstituting this result back into our expression for the expectation, we get:\n$$\nE[L_{t}^{0}(B)] = \\frac{1}{\\sqrt{2\\pi}} (2\\sqrt{t}) = \\frac{2\\sqrt{t}}{\\sqrt{2\\pi}} = \\sqrt{\\frac{4t}{2\\pi}} = \\sqrt{\\frac{2t}{\\pi}}\n$$\nThis is the closed-form expression for the expected local time at the origin for a standard Brownian motion.", "answer": "$$\\boxed{\\sqrt{\\frac{2t}{\\pi}}}$$", "id": "2993643"}, {"introduction": "The Skorokhod problem's power extends beyond single dimensions to the modeling of complex, constrained systems, with queueing networks serving as a canonical example. This practice problem demonstrates how to construct a semimartingale reflected Brownian motion (SRBM) model for a tandem queueing network from first principles [@problem_id:2993602]. By deriving the model's parameters—drift, covariance, and reflection matrix—and assessing system stability, you will gain hands-on experience applying the Skorokhod framework to a tangible, multi-dimensional problem.", "problem": "Consider a two-station tandem open network operating under heavy-traffic diffusion scaling. External customers arrive to station $1$ according to a renewal process with rate $\\lambda = \\frac{9}{10}$ and squared coefficient of variation $c_{a}^{2} = 2$. Service times at stations $1$ and $2$ are independent across jobs and stations, with mean service rates $\\mu_{1} = 1$ and $\\mu_{2} = \\frac{11}{10}$, and squared coefficients of variation $c_{s,1}^{2} = \\frac{3}{2}$ and $c_{s,2}^{2} = \\frac{1}{2}$, respectively. All primitive processes are mutually independent. Jobs departing station $1$ proceed immediately to station $2$ with probability $1$, and jobs departing station $2$ leave the network. Assume First-In–First-Out (FIFO) service at both stations.\n\nUnder diffusion scaling, the centered netput process $W(t)$ for the buffer content vector $Q(t) \\in \\mathbb{R}_{+}^{2}$ is modeled as a two-dimensional Brownian motion with drift vector $\\theta \\in \\mathbb{R}^{2}$ and covariance matrix $\\Gamma \\in \\mathbb{R}^{2 \\times 2}$. The queue-length process is constrained to the nonnegative orthant via an obliquely reflected Skorokhod map, so that\n$$\nQ(t) \\;=\\; Q(0) \\;+\\; W(t) \\;+\\; R\\,Y(t),\n$$\nwhere $R \\in \\mathbb{R}^{2 \\times 2}$ collects the reflection directions as its columns, and $Y(t) \\in \\mathbb{R}_{+}^{2}$ is a vector of nondecreasing regulator processes that increase only when the corresponding component of $Q(t)$ is on the boundary. The reflection directions are assumed to be induced by instantaneous flow conservation consistent with the routing: when reflection occurs at station $1$, a unit of regulator increases buffer $1$ while simultaneously reducing the routed push to buffer $2$; when reflection occurs at station $2$, a unit of regulator increases only buffer $2$ (departures exit the network).\n\nDerive from first principles the data $(\\theta,\\Gamma,R)$ of the semimartingale reflected Brownian motion (SRBM) describing $Q(t)$.\n\nDefine the stability margin\n$$\nm \\;:=\\; \\max\\bigl\\{ \\bigl(R^{-1}\\theta\\bigr)_{1},\\; \\bigl(R^{-1}\\theta\\bigr)_{2} \\bigr\\}.\n$$\nCompute $m$ exactly. Your final answer must be a single exact value (no approximation or rounding). No units are required.", "solution": "The problem requires the derivation of the parameters $(\\theta, \\Gamma, R)$ for a semimartingale reflected Brownian motion (SRBM) that approximates a two-station tandem queueing network in heavy traffic. Subsequently, we must compute the stability margin $m$.\n\nThe system consists of two stations in series. We denote the primitive stochastic processes as follows:\n1.  $A(t)$: The external arrival process to station $1$. This is a renewal process with rate $\\lambda = \\frac{9}{10}$ and squared coefficient of variation (SCV) $c_{a}^{2} = 2$.\n2.  $S_1(t)$: The potential service completion process at station $1$. This is a renewal process with rate $\\mu_1 = 1$ and SCV $c_{s,1}^{2} = \\frac{3}{2}$.\n3.  $S_2(t)$: The potential service completion process at station $2$. This is a renewal process with rate $\\mu_2 = \\frac{11}{10}$ and SCV $c_{s,2}^{2} = \\frac{1}{2}$.\nThese three processes are assumed to be mutually independent.\n\nUnder diffusion scaling, each renewal process $N(t)$ with rate $\\nu$ and SCV $c^2$ is approximated by a Brownian motion with drift: $N(t) \\approx \\nu t + \\sqrt{\\nu c^2} B(t)$, where $B(t)$ is a standard one-dimensional Brownian motion.\n\nThe unconstrained netput process, $W(t) = (W_1(t), W_2(t))^T$, represents the change in queue lengths without the boundary constraints. For a tandem queue, the flow is sequential: arrivals to station $1$ are external, and arrivals to station $2$ are the departures from station $1$.\nThe netput at station $1$ is the difference between external arrivals and potential service completions at station $1$.\n$$W_1(t) = A(t) - S_1(t)$$\nThe netput at station $2$ is the difference between arrivals from station $1$ (which are its potential departures) and potential service completions at station $2$.\n$$W_2(t) = S_1(t) - S_2(t)$$\nThus, the vector netput process is $W(t) = (A(t) - S_1(t), S_1(t) - S_2(t))^T$.\n\n**1. Derivation of the Drift Vector $\\theta$**\n\nThe drift vector $\\theta$ of the Brownian motion $W(t)$ is given by the vector of mean rates of the netput processes.\n$$\n\\theta = \\lim_{t\\to\\infty} \\frac{1}{t} E[W(t)] = \\begin{pmatrix} E[A(t)]/t - E[S_1(t)]/t \\\\ E[S_1(t)]/t - E[S_2(t)]/t \\end{pmatrix}\n$$\nThe mean rates are given by the rates of the underlying renewal processes.\n$$\n\\theta = \\begin{pmatrix} \\lambda - \\mu_1 \\\\ \\mu_1 - \\mu_2 \\end{pmatrix}\n$$\nSubstituting the given values:\n$\\theta_1 = \\frac{9}{10} - 1 = -\\frac{1}{10}$\n$\\theta_2 = 1 - \\frac{11}{10} = -\\frac{1}{10}$\nSo, the drift vector is $\\theta = \\begin{pmatrix} -1/10 \\\\ -1/10 \\end{pmatrix}$.\n\n**2. Derivation of the Covariance Matrix $\\Gamma$**\n\nThe covariance matrix $\\Gamma$ is given by $\\Gamma_{ij} = \\lim_{t\\to\\infty} \\frac{1}{t} \\text{Cov}(W_i(t), W_j(t))$.\nThe diffusion approximations for the independent primitive processes are:\n$A(t) \\approx \\lambda t + \\sqrt{\\lambda c_a^2} B_a(t)$\n$S_1(t) \\approx \\mu_1 t + \\sqrt{\\mu_1 c_{s,1}^2} B_1(t)$\n$S_2(t) \\approx \\mu_2 t + \\sqrt{\\mu_2 c_{s,2}^2} B_2(t)$\nwhere $B_a, B_1, B_2$ are independent standard Brownian motions.\n\nThe diagonal elements of $\\Gamma$ are the variances:\n$\\Gamma_{11} = \\lim_{t\\to\\infty} \\frac{1}{t} \\text{Var}(A(t) - S_1(t)) = \\lambda c_a^2 + \\mu_1 c_{s,1}^2$\n$\\Gamma_{22} = \\lim_{t\\to\\infty} \\frac{1}{t} \\text{Var}(S_1(t) - S_2(t)) = \\mu_1 c_{s,1}^2 + \\mu_2 c_{s,2}^2$\n\nThe off-diagonal elements are the covariances:\n$\\Gamma_{12} = \\lim_{t\\to\\infty} \\frac{1}{t} \\text{Cov}(A(t) - S_1(t), S_1(t) - S_2(t))$\nSince $A(t)$, $S_1(t)$, and $S_2(t)$ are independent processes, the covariance is only due to the common term $S_1(t)$:\n$\\Gamma_{12} = \\lim_{t\\to\\infty} \\frac{1}{t} \\text{Cov}(-S_1(t), S_1(t)) = -\\lim_{t\\to\\infty} \\frac{1}{t} \\text{Var}(S_1(t)) = -\\mu_1 c_{s,1}^2$\nSince $\\Gamma$ is symmetric, $\\Gamma_{21} = \\Gamma_{12}$.\n\nSubstituting the given values:\n$\\lambda c_a^2 = \\frac{9}{10} \\times 2 = \\frac{9}{5}$\n$\\mu_1 c_{s,1}^2 = 1 \\times \\frac{3}{2} = \\frac{3}{2}$\n$\\mu_2 c_{s,2}^2 = \\frac{11}{10} \\times \\frac{1}{2} = \\frac{11}{20}$\n\n$\\Gamma_{11} = \\frac{9}{5} + \\frac{3}{2} = \\frac{18}{10} + \\frac{15}{10} = \\frac{33}{10}$\n$\\Gamma_{22} = \\frac{3}{2} + \\frac{11}{20} = \\frac{30}{20} + \\frac{11}{20} = \\frac{41}{20}$\n$\\Gamma_{12} = \\Gamma_{21} = -\\frac{3}{2}$\n\nSo, the covariance matrix is $\\Gamma = \\begin{pmatrix} 33/10 & -3/2 \\\\ -3/2 & 41/20 \\end{pmatrix}$.\n\n**3. Derivation of the Reflection Matrix $R$**\n\nThe reflection matrix $R$ describes the direction of control applied at the boundaries of the state space $\\mathbb{R}_{+}^{2}$.\n- When the queue at station $1$ is empty ($Q_1(t) = 0$), a regulator process $Y_1(t)$ acts. The problem states this \"increases buffer $1$ while simultaneously reducing the routed push to buffer $2$\". An increase in buffer $1$ means the first component of the reflection vector $R_1$ is positive (normalized to $1$). A reduction in the routed push to buffer $2$ means that an arrival that would have gone to station $2$ does not occur, which is a negative contribution to the queue length $Q_2$. This is modeled by a negative second component in $R_1$ (normalized to $-1$). Thus, the first column of $R$ is $R_1 = \\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix}$.\n- When the queue at station $2$ is empty ($Q_2(t) = 0$), a regulator process $Y_2(t)$ acts. The problem states this \"increases only buffer $2$\". This means the corresponding reflection vector $R_2$ has a zero component for station $1$ and a positive component for station $2$ (normalized to $1$). Thus, the second column of $R$ is $R_2 = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}$.\n\nCombining these, the reflection matrix is $R = \\begin{pmatrix} 1 & 0 \\\\ -1 & 1 \\end{pmatrix}$.\nThe parameters of the SRBM are $(\\theta, \\Gamma, R) = \\left( \\begin{pmatrix} -1/10 \\\\ -1/10 \\end{pmatrix}, \\begin{pmatrix} 33/10 & -3/2 \\\\ -3/2 & 41/20 \\end{pmatrix}, \\begin{pmatrix} 1 & 0 \\\\ -1 & 1 \\end{pmatrix} \\right)$.\n\n**4. Computation of the Stability Margin $m$**\n\nThe stability margin is defined as $m = \\max\\bigl\\{ \\bigl(R^{-1}\\theta\\bigr)_{1},\\; \\bigl(R^{-1}\\theta\\bigr)_{2} \\bigr\\}$.\nFirst, we find the inverse of $R$:\n$\\det(R) = (1)(1) - (0)(-1) = 1$.\n$R^{-1} = \\frac{1}{\\det(R)} \\begin{pmatrix} 1 & -0 \\\\ -(-1) & 1 \\end{pmatrix} = \\begin{pmatrix} 1 & 0 \\\\ 1 & 1 \\end{pmatrix}$.\n\nNext, we compute the vector $\\delta = R^{-1}\\theta$, which represents the drift of the workload process.\n$$\n\\delta = R^{-1}\\theta = \\begin{pmatrix} 1 & 0 \\\\ 1 & 1 \\end{pmatrix} \\begin{pmatrix} -1/10 \\\\ -1/10 \\end{pmatrix}\n$$\nThe components of $\\delta$ are:\n$\\delta_1 = (1)(-\\frac{1}{10}) + (0)(-\\frac{1}{10}) = -\\frac{1}{10}$\n$\\delta_2 = (1)(-\\frac{1}{10}) + (1)(-\\frac{1}{10}) = -\\frac{2}{10} = -\\frac{1}{5}$\n\nFinally, we compute the stability margin $m$ by taking the maximum of these components:\n$$\nm = \\max\\{-\\frac{1}{10}, -\\frac{1}{5}\\}\n$$\nSince $-\\frac{1}{10} = -0.1$ and $-\\frac{1}{5} = -0.2$, the maximum value is $-\\frac{1}{10}$.\n$$\nm = -\\frac{1}{10}\n$$", "answer": "$$\\boxed{-\\frac{1}{10}}$$", "id": "2993602"}, {"introduction": "Analyzing a reflected process, such as finding its stationary distribution, requires solving partial differential equations where boundary conditions are paramount. A subtle but critical distinction exists between the boundary conditions for the backward Kolmogorov equation (which applies to test functions) and the forward Fokker-Planck equation (which governs the probability density). This exercise tackles this common point of confusion by having you derive the correct zero-flux condition for the density and showing how incorrectly applying the generator's boundary condition leads to a physically different model [@problem_id:2993641].", "problem": "Consider a one-dimensional reflected Itô diffusion on the closed interval $[0,1]$ with normal reflection at both endpoints, defined via the Skorokhod problem as follows. Let $W_t$ be a standard Brownian motion, and let $b:[0,1]\\to\\mathbb{R}$ and $\\sigma:[0,1]\\to(0,\\infty)$ be continuous functions. The reflected process $X_t$ satisfies $X_t\\in[0,1]$ for all $t\\ge 0$ and\n$$\nX_t \\;=\\; X_0 \\;+\\; \\int_0^t b(X_s)\\,ds \\;+\\; \\int_0^t \\sigma(X_s)\\,dW_s \\;+\\; K_t^0 \\;-\\; K_t^1,\n$$\nwhere $K_t^0$ and $K_t^1$ are continuous nondecreasing processes of bounded variation such that $K_0^0=K_0^1=0$, $K_t^0$ increases only when $X_t=0$, and $K_t^1$ increases only when $X_t=1$ (they push the process inward along the inward unit normals at the boundary). This is the canonical Skorokhod decomposition for normal reflection in $[0,1]$.\n\nA common confusion in the literature is to conflate two distinct boundary prescriptions:\n- The backward Kolmogorov boundary condition that characterizes the domain of the infinitesimal generator acting on test functions $f$ for expectations of the form $\\mathbb{E}[f(X_t)]$, which in the presence of normal reflection imposes $f'(0)=f'(1)=0$.\n- The forward Kolmogorov (Fokker–Planck) boundary condition that governs the time evolution of the probability density $p(t,x)$ of $X_t$, which must enforce conservation of probability mass under reflection.\n\nTo expose this confusion, consider the explicit case $b(x)\\equiv 1$ and $\\sigma(x)\\equiv 2$ on $[0,1]$. A purported stationary solution for the density $p(x)$ is presented with the boundary condition $p'(0)=p'(1)=0$ “because the process is reflected,” by appealing to the backward perspective. Your task is to decide, by deriving the correct forward boundary condition from first principles, whether such a Neumann condition on $p$ is appropriate and what boundary condition must replace it.\n\nWhich option correctly states the boundary condition that a stationary density $p(x)$ must satisfy at $x=0$ and $x=1$ for the reflected diffusion above, and thereby identifies the error caused by confusing backward and forward boundary prescriptions?\n\nA. $p'(0)=p'(1)=0$.\n\nB. $p(0)=p(1)=0$.\n\nC. $J(0)=J(1)=0$, where $J(x)=b(x)\\,p(x)-\\dfrac{1}{2}\\,\\partial_x\\big(\\sigma^2(x)\\,p(x)\\big)$ is the probability flux.\n\nD. $J'(0)=J'(1)=0$.\n\nE. $\\sigma^2(0)\\,p'(0)=\\sigma^2(1)\\,p'(1)=0$ (independent of $b$).\n\nAnswer the question by starting from the definitions of the Skorokhod problem, the infinitesimal generator, and probability conservation in the forward equation; derive the forward boundary condition for the density and use the explicit case $b\\equiv 1$, $\\sigma\\equiv 2$ to demonstrate how the incorrect identification of backward and forward boundary prescriptions leads to an erroneous condition on $p$.", "solution": "### Derivation of the Forward Boundary Condition\n\nThe evolution of the probability density function $p(t,x)$ of the process $X_t$ is described by the forward Kolmogorov equation, also known as the Fokker-Planck equation. For a general Itô diffusion, this equation takes the form of a continuity equation:\n$$ \\frac{\\partial p(t,x)}{\\partial t} = - \\frac{\\partial J(t,x)}{\\partial x} $$\nwhere $J(t,x)$ is the probability flux (or probability current). The flux is given by:\n$$ J(t,x) = b(x)p(t,x) - \\frac{1}{2}\\frac{\\partial}{\\partial x}\\left(\\sigma^2(x)p(t,x)\\right) $$\nThe process $X_t$ is confined to the interval $[0,1]$. The reflection at the boundaries $x=0$ and $x=1$ is a physical constraint that prevents probability mass from leaving the domain. This is mathematically expressed by imposing that the probability flux across the boundaries must be zero. Therefore, a reflecting boundary is characterized by the condition:\n$$ J(t,x) = 0 \\quad \\text{at } x=0 \\text{ and } x=1 $$\nThis ensures the conservation of total probability within the interval, as\n$$ \\frac{d}{dt} \\int_0^1 p(t,x)\\,dx = \\int_0^1 \\frac{\\partial p(t,x)}{\\partial t}\\,dx = - \\int_0^1 \\frac{\\partial J(t,x)}{\\partial x}\\,dx = -[J(t,1) - J(t,0)] = -[0 - 0] = 0. $$\nA stationary density, denoted $p(x)$, is a time-independent solution to the Fokker-Planck equation, meaning $\\frac{\\partial p}{\\partial t} = 0$. This implies:\n$$ -\\frac{d J(x)}{dx} = 0 $$\nwhere $J(x)$ is the stationary flux. Integrating with respect to $x$ shows that $J(x)$ must be a constant for all $x \\in [0,1]$. Since the boundary conditions $J(0)=0$ and $J(1)=0$ must hold for any time-independent solution, the constant flux must be zero. Thus, for a reflected process with a stationary distribution, the probability flux is identically zero throughout the domain:\n$$ J(x) = b(x)p(x) - \\frac{1}{2}\\frac{d}{dx}\\left(\\sigma^2(x)p(x)\\right) = 0 \\quad \\text{for all } x \\in [0,1]. $$\nThe boundary conditions are, in particular, $J(0)=0$ and $J(1)=0$. This is the fundamental condition that the stationary density $p(x)$ must satisfy at the boundaries.\n\n### Analysis of the Purported Confusion\n\nThe confusion described in the problem arises from conflating the above forward boundary condition on the density $p(x)$ with the backward boundary condition on test functions $f(x)$ used to define the domain of the infinitesimal generator, $\\mathcal{A}$. The generator is given by:\n$$ \\mathcal{A}f(x) = b(x)f'(x) + \\frac{1}{2}\\sigma^2(x)f''(x) $$\nFor a process with normal reflection at boundaries $x=0$ and $x=1$, the domain of $\\mathcal{A}$ is restricted to functions $f \\in C^2([0,1])$ that satisfy the Neumann boundary conditions:\n$$ f'(0) = 0 \\quad \\text{and} \\quad f'(1) = 0. $$\nThese conditions ensure that the generator properly accounts for the reflection (local time) at the boundaries. The error is to incorrectly impose these conditions, intended for test functions $f$ in the backward formulation, onto the probability density $p$ in the forward formulation.\n\nTo demonstrate the consequence of this error, we use the specific case $b(x)=1$ and $\\sigma(x)=2$.\nThe correct stationary boundary condition is $J(0)=J(1)=0$. The stationary flux is:\n$$ J(x) = 1 \\cdot p(x) - \\frac{1}{2}\\frac{d}{dx}(2^2 p(x)) = p(x) - 2p'(x) $$\nSo, the correct boundary conditions are:\n$$ p(0) - 2p'(0) = 0 \\implies p'(0) = \\frac{1}{2}p(0) $$\n$$ p(1) - 2p'(1) = 0 \\implies p'(1) = \\frac{1}{2}p(1) $$\nThese are Robin-type boundary conditions.\n\nThe incorrect condition, arising from the confusion, would be to set $p'(0)=0$ and $p'(1)=0$. If we substitute these erroneous conditions into the correct physical requirement above, we get:\n- If $p'(0)=0$, then $p(0) - 2(0) = 0 \\implies p(0)=0$.\n- If $p'(1)=0$, then $p(1) - 2(0) = 0 \\implies p(1)=0$.\nThis would lead to Dirichlet boundary conditions ($p(0)=p(1)=0$), which describe a process that is *absorbed* at the boundaries, not reflected. This fundamentally changes the nature of the stochastic process and demonstrates that confusing the backward and forward boundary conditions is a critical error.\n\n### Evaluation of Options\n\n**A. $p'(0)=p'(1)=0$.**\nThis is the Neumann boundary condition that applies to test functions $f$ in the domain of the backward generator. Applying it to the density $p$ is the error the problem aims to expose.\n**Verdict: Incorrect.**\n\n**B. $p(0)=p(1)=0$.**\nThis is a Dirichlet boundary condition, which models absorption at the boundaries. It is not the correct condition for a reflected process. While the erroneous application of the Neumann condition in the specific case implies this result, it is not the fundamental boundary condition for reflection.\n**Verdict: Incorrect.**\n\n**C. $J(0)=J(1)=0$, where $J(x)=b(x)\\,p(x)-\\dfrac{1}{2}\\,\\partial_x\\big(\\sigma^2(x)\\,p(x)\\big)$ is the probability flux.**\nThis is the zero-flux boundary condition. As derived from the first principle of probability conservation for a process confined to an interval, this is the correct condition for reflecting boundaries in the Fokker-Planck formalism. The formula for the flux $J(x)$ is also correctly stated.\n**Verdict: Correct.**\n\n**D. $J'(0)=J'(1)=0$.**\nIn the stationary state, the Fokker-Planck equation reduces to $\\frac{dJ}{dx}=0$ for all $x \\in [0,1]$. This implies $J'(x)=0$ everywhere in the interior, not just at the boundaries. This is a property of the stationary solution, but it is not the boundary condition itself. The physical boundary condition is a constraint on the value of the flux $J$ at the boundary, not its derivative.\n**Verdict: Incorrect.**\n\n**E. $\\sigma^2(0)\\,p'(0)=\\sigma^2(1)\\,p'(1)=0$ (independent of $b$).**\nSince $\\sigma(x)>0$ is given, this is equivalent to $p'(0)=p'(1)=0$, which is option A. This is the erroneous Neumann condition. Furthermore, the claim of independence from the drift $b$ is false, as shown by our derived Robin condition $p'(x) = \\frac{1}{2}p(x)$ for the case $b(x)=1$, which clearly involves the density $p(x)$ and hence is related to the integrated effect of the drift.\n**Verdict: Incorrect.**", "answer": "$$\\boxed{C}$$", "id": "2993641"}]}