{"hands_on_practices": [{"introduction": "A natural first question when studying a particle confined to a domain is determining how long, on average, it will take to escape. This practice establishes a powerful and direct link between the infinitesimal generator of a diffusion process and the expected value of its first exit time [@problem_id:2968231]. By solving a simple boundary value problem, we can calculate this fundamental quantity without the need to analyze the complexities of individual random paths.", "problem": "Let $\\{X_t\\}_{t \\geq 0}$ be a one-dimensional standard Brownian motion with infinitesimal generator $L = \\frac{1}{2}\\frac{d^{2}}{dx^{2}}$, started at $X_0 = x \\in (0,a)$ for a fixed $a > 0$. Consider the open interval $D = (0,a)$ with absorbing boundary (killing) at $\\partial D = \\{0,a\\}$, and define the first exit time $\\tau_{\\partial D} = \\inf\\{t \\geq 0 : X_t \\notin D\\}$. \n\nUsing only foundational principles of stochastic differential equations—namely, the generator of the process, the strong Markov property, and the relationship between killing at the boundary and Dirichlet boundary conditions—derive the boundary value problem satisfied by the function $u(x) = \\mathbb{E}_x[\\tau_{\\partial D}]$ and solve it to obtain a closed-form expression for $u(x)$. Additionally, explain the mathematical meaning of boundary absorption in this setting and how it is encoded in the boundary conditions for $u(x)$.\n\nYour final answer must be an analytic expression for $u(x)$ depending on $x$ and $a$. No numerical rounding is required and no physical units apply.", "solution": "The process $\\{X_t\\}_{t \\geq 0}$ is a one-dimensional standard Brownian motion, so its infinitesimal generator is $L = \\frac{1}{2}\\frac{d^{2}}{dx^{2}}$. The interval $D = (0,a)$ is equipped with absorbing boundaries at $\\partial D = \\{0,a\\}$; killing means that the process is stopped upon first hitting the boundary and sent to a cemetery state, with no further evolution past the exit time $\\tau_{\\partial D}$. \n\nWe aim to compute $u(x) = \\mathbb{E}_x[\\tau_{\\partial D}]$. The foundational derivation uses the connection between expected functionals of stopping times and the generator via Dynkin's formula (which follows from Itô's formula and the strong Markov property). For a sufficiently smooth function $u$ and a stopping time $\\tau$ such that the stopped process is integrable, Dynkin's formula states\n$$\n\\mathbb{E}_x\\left[u\\left(X_{t \\wedge \\tau}\\right)\\right] = u(x) + \\mathbb{E}_x\\left[\\int_{0}^{t \\wedge \\tau} L u\\left(X_s\\right)\\, ds\\right].\n$$\nIf the process is killed at $\\tau = \\tau_{\\partial D}$, then the boundary absorption implies the Dirichlet boundary condition\n$$\nu(y) = 0 \\quad \\text{for} \\quad y \\in \\partial D,\n$$\nbecause if the process starts at the boundary, it is immediately killed and the exit time is $0$, and after hitting the boundary, the remaining expected time until killing is $0$. \n\nTo identify the partial differential equation for $u$, we choose $u$ so that the time integral of $L u$ reproduces the elapsed time until killing. Specifically, if $u$ satisfies\n$$\nL u(x) = -1 \\quad \\text{for} \\quad x \\in D,\n$$\nthen substituting into Dynkin's formula and letting $t \\to \\infty$ (so that $t \\wedge \\tau_{\\partial D} \\to \\tau_{\\partial D}$ almost surely) yields\n$$\n\\mathbb{E}_x\\left[u\\left(X_{\\tau_{\\partial D}}\\right)\\right] = u(x) + \\mathbb{E}_x\\left[\\int_{0}^{\\tau_{\\partial D}} (-1)\\, ds\\right] = u(x) - \\mathbb{E}_x\\left[\\tau_{\\partial D}\\right].\n$$\nBy boundary absorption, $u\\left(X_{\\tau_{\\partial D}}\\right) = 0$, so $\\mathbb{E}_x\\left[u\\left(X_{\\tau_{\\partial D}}\\right)\\right] = 0$. Therefore,\n$$\n0 = u(x) - \\mathbb{E}_x\\left[\\tau_{\\partial D}\\right] \\quad \\Rightarrow \\quad u(x) = \\mathbb{E}_x\\left[\\tau_{\\partial D}\\right].\n$$\nHence $u$ is determined as the solution to the Dirichlet problem\n$$\n\\frac{1}{2} u''(x) = -1 \\quad \\text{for} \\quad x \\in (0,a), \\qquad u(0) = 0, \\quad u(a) = 0.\n$$\n\nWe now solve this ordinary differential equation. The equation $\\frac{1}{2} u''(x) = -1$ is equivalent to\n$$\nu''(x) = -2.\n$$\nIntegrating twice in $x$ gives\n$$\nu'(x) = -2x + C_1, \\qquad u(x) = -x^{2} + C_1 x + C_2,\n$$\nfor constants $C_1$ and $C_2$ determined by the boundary conditions. Imposing $u(0) = 0$ yields $C_2 = 0$. Imposing $u(a) = 0$ yields\n$$\n0 = -a^{2} + C_1 a \\quad \\Rightarrow \\quad C_1 = a.\n$$\nTherefore,\n$$\nu(x) = -x^{2} + a x = x(a - x).\n$$\nThis is the closed-form expression for the expected time to absorption (killing) at the boundary $\\partial D$ starting from $x \\in (0,a)$.\n\nInterpretation of boundary absorption: The killing at the boundary means that once the process $\\{X_t\\}_{t \\geq 0}$ hits either $0$ or $a$, it is terminated and no further time is accumulated. This is encoded mathematically by the Dirichlet boundary condition $u=0$ on $\\partial D$, reflecting that if the process starts on the boundary, the exit time is $0$, and if it reaches the boundary during evolution, future contributions to the expectation cease. The strong Markov property guarantees that the evaluation of expectations up to the stopping time is consistent, and the generator equation $L u = -1$ captures the rate at which expected time accrues in the interior of the domain under the diffusion dynamics.", "answer": "$$\\boxed{x(a - x)}$$", "id": "2968231"}, {"introduction": "After determining the average time to absorption, the next logical question is about the location of the exit. This exercise explores the probability that a particle will hit one boundary point before another, a classic problem often called the \"Gambler's Ruin\" [@problem_id:2968268]. The solution introduces the deep connection between harmonic functions—solutions to the equation $Lu=0$—and hitting probabilities, providing a key theoretical tool for analyzing absorbed processes.", "problem": "Consider a one-dimensional standard Brownian motion $B_t$ on $\\mathbb{R}$, started at $B_0 = x$ with $x \\in (0,a)$ for a fixed $a0$. Let $\\tau_0 = \\inf\\{t \\geq 0 : B_t = 0\\}$ and $\\tau_a = \\inf\\{t \\geq 0 : B_t = a\\}$ be the first hitting times of the boundary points $0$ and $a$, respectively. The process is killed upon hitting the boundary of the interval $(0,a)$, meaning the evolution stops at time $\\tau = \\tau_0 \\wedge \\tau_a$. Using only foundational properties of Brownian motion—its martingale structure and generator—as well as the connection between killing at the boundary and Dirichlet boundary value problems, compute the probability $\\mathbb{P}_x(\\tau_0  \\tau_a)$ as a closed-form analytic expression in terms of $x$ and $a$. Then interpret this quantity as the harmonic measure at the boundary point $0$ for absorption of the killed process, explaining why it equals the value at $x$ of the unique harmonic function on $(0,a)$ with boundary data $1$ at $0$ and $0$ at $a$. The final answer must be a single analytic expression. No rounding is required and no units are involved.", "solution": "The problem asks for the probability that a standard one-dimensional Brownian motion $B_t$ starting at $x \\in (0, a)$ hits the boundary at $0$ before it hits the boundary at $a$. Let this probability be denoted by $p(x) = \\mathbb{P}_x(\\tau_0  \\tau_a)$, where the subscript in $\\mathbb{P}_x$ indicates the starting position $B_0=x$. Two common methods can be used to solve this.\n\n**Method 1: Using the Martingale Property of Brownian Motion**\n\nA standard one-dimensional Brownian motion $B_t$ is a martingale with respect to its natural filtration. This means that for any $s \\leq t$, $\\mathbb{E}[B_t | \\mathcal{F}_s] = B_s$. A direct consequence is that $\\mathbb{E}_x[B_t] = x$ for all $t \\geq 0$.\n\nLet $\\tau = \\tau_0 \\wedge \\tau_a$ be the first exit time from the interval $(0, a)$. For a Brownian motion starting in a bounded interval, the exit time $\\tau$ is almost surely finite, i.e., $\\mathbb{P}_x(\\tau  \\infty) = 1$. The stopped process $B_{t \\wedge \\tau}$ is a martingale. Furthermore, since $B_{t \\wedge \\tau}$ is always within the closed interval $[0, a]$, it is a bounded martingale.\n\nBy the Optional Stopping Theorem, for a bounded martingale and an almost surely finite stopping time $\\tau$, we have $\\mathbb{E}_x[B_\\tau] = \\mathbb{E}_x[B_0]$. Since $B_0=x$, this gives:\n$$\n\\mathbb{E}_x[B_\\tau] = x\n$$\nThe value of the process at the stopping time, $B_\\tau$, is a discrete random variable. By definition of $\\tau$, the process must be at one of the boundaries:\n- If $\\tau_0  \\tau_a$, then $\\tau = \\tau_0$ and $B_\\tau = 0$. This occurs with probability $p(x) = \\mathbb{P}_x(\\tau_0  \\tau_a)$.\n- If $\\tau_a  \\tau_0$, then $\\tau = \\tau_a$ and $B_\\tau = a$. This occurs with probability $\\mathbb{P}_x(\\tau_a  \\tau_0) = 1 - p(x)$.\nThe event $\\tau_0 = \\tau_a$ has probability $0$.\n\nThe expectation $\\mathbb{E}_x[B_\\tau]$ can be calculated using the law of total probability:\n$$\n\\mathbb{E}_x[B_\\tau] = 0 \\cdot \\mathbb{P}_x(B_\\tau = 0) + a \\cdot \\mathbb{P}_x(B_\\tau = a) = 0 \\cdot p(x) + a \\cdot (1 - p(x)) = a(1 - p(x))\n$$\nEquating the two expressions for the expectation gives:\n$$\nx = a(1 - p(x))\n$$\nSolving for $p(x)$, we find:\n$$\n\\frac{x}{a} = 1 - p(x) \\implies p(x) = 1 - \\frac{x}{a} = \\frac{a-x}{a}\n$$\nThus, the probability of hitting $0$ before $a$ is $\\frac{a-x}{a}$.\n\n**Method 2: Using the Generator and Connection to Dirichlet Problems**\n\nA fundamental result connects exit probabilities of diffusion processes to boundary value problems involving the generator of the process. The generator of a standard one-dimensional Brownian motion is the operator $\\mathcal{L} = \\frac{1}{2} \\frac{d^2}{dx^2}$.\n\nLet $u(x) = \\mathbb{P}_x(\\tau_0  \\tau_a)$. The function $u(x)$ is the solution to the Dirichlet problem for the generator $\\mathcal{L}$ on the domain $D=(0,a)$, with boundary conditions determined by the event of interest. The problem is:\n$$\n\\mathcal{L} u(x) = 0 \\quad \\text{for } x \\in (0, a)\n$$\nwith boundary conditions:\n$$\nu(0) = \\lim_{y \\to 0^+} \\mathbb{P}_y(\\tau_0  \\tau_a) = 1\n$$\n$$\nu(a) = \\lim_{y \\to a^-} \\mathbb{P}_y(\\tau_0  \\tau_a) = 0\n$$\nThe boundary conditions are intuitive: if the process starts infinitesimally close to $0$, it is almost certain to hit $0$ before traversing the entire interval to $a$. Conversely, if it starts infinitesimally close to $a$, it is almost certain to hit $a$ first.\n\nSubstituting the expression for the generator $\\mathcal{L}$, we must solve the ordinary differential equation:\n$$\n\\frac{1}{2} u''(x) = 0 \\implies u''(x) = 0\n$$\nIntegrating twice with respect to $x$ yields the general solution:\n$$\nu'(x) = c_1\n$$\n$$\nu(x) = c_1 x + c_2\n$$\nwhere $c_1$ and $c_2$ are constants of integration. We determine these constants using the boundary conditions:\n- Applying $u(0)=1$: $u(0) = c_1(0) + c_2 = 1 \\implies c_2 = 1$.\n- Applying $u(a)=0$: $u(a) = c_1 a + c_2 = 0 \\implies c_1 a + 1 = 0 \\implies c_1 = -\\frac{1}{a}$.\n\nSubstituting the constants back into the general solution gives the unique solution for $u(x)$:\n$$\nu(x) = -\\frac{1}{a} x + 1 = \\frac{a-x}{a}\n$$\nThis result is identical to that obtained via the martingale approach.\n\n**Interpretation as Harmonic Measure**\n\nThe quantity $u(x) = \\mathbb{P}_x(\\tau_0  \\tau_a)$ is an instance of a harmonic measure. For a domain $D$ and a point $x \\in D$, the harmonic measure $\\omega_x(\\cdot)$ is a probability measure on the boundary $\\partial D$. For any measurable subset $A \\subseteq \\partial D$, $\\omega_x(A)$ is defined as the probability that a Brownian motion starting at $x$ will first exit the domain $D$ at a point in $A$.\n$$\n\\omega_x(A) = \\mathbb{P}_x(B_\\tau \\in A)\n$$\nIn our one-dimensional case, the domain is $D=(0,a)$ and its boundary is the two-point set $\\partial D = \\{0, a\\}$. We are interested in the probability of exiting at the boundary point $\\{0\\}$. Therefore, the probability we calculated is precisely the harmonic measure of the set $\\{0\\}$ as seen from point $x$:\n$$\np(x) = \\mathbb{P}_x(\\tau_0  \\tau_a) = \\mathbb{P}_x(B_\\tau \\in \\{0\\}) = \\omega_x(\\{0\\})\n$$\nThe connection to harmonic functions is definitional. The harmonic measure $\\omega_x(A)$ is given by the value $u(x)$ of the function $u$ which is harmonic for the process's generator $\\mathcal{L}$ in the domain $D$ (i.e., $\\mathcal{L}u = 0$ in $D$) and takes the boundary values $u(y) = 1$ for $y \\in A$ and $u(y) = 0$ for $y \\in \\partial D \\setminus A$.\nAs shown in the second method, the probability $p(x)$ is indeed the value of the unique function that is harmonic for $\\mathcal{L} = \\frac{1}{2}\\frac{d^2}{dx^2}$ on $(0, a)$ and satisfies the boundary conditions $u(0)=1$ and $u(a)=0$. This confirms the interpretation of the exit probability as a harmonic measure.", "answer": "$$\\boxed{\\frac{a-x}{a}}$$", "id": "2968268"}, {"introduction": "Moving beyond time-independent quantities like the eventual exit location, we can explore the full dynamics of the absorption process over time. This practice focuses on calculating the survival probability: the likelihood that the process has not been absorbed by a specific time $t$ [@problem_id:2968272]. You will solve the heat equation with absorbing (Dirichlet) boundary conditions using the powerful method of eigenfunction expansion, revealing how the probability of survival decays as time progresses.", "problem": "Let $\\{B_{t}\\}_{t\\geq 0}$ be a one-dimensional standard Brownian motion started at $x\\in (0,a)$ with $a0$, and define the stopped process $X_{t}=B_{t}$ killed upon hitting the boundary of the interval $(0,a)$. Denote the first hitting times by $\\tau_{0}=\\inf\\{t\\geq 0: X_{t}=0\\}$ and $\\tau_{a}=\\inf\\{t\\geq 0: X_{t}=a\\}$, and let $\\tau=\\tau_{0}\\wedge \\tau_{a}$. Consider the survival probability\n$$\nu(t,x)=\\mathbb{P}_{x}(t\\tau),\n$$\nthat is, the probability that the Brownian particle has not been absorbed at either boundary by time $t$.\n\nStarting from first principles appropriate to stochastic differential equations—namely, the infinitesimal generator of Brownian motion and the Dirichlet boundary killing—derive the partial differential equation and boundary/initial conditions satisfied by $u(t,x)$, and then solve it by an eigenfunction expansion of the Dirichlet Laplacian on $(0,a)$. Your derivation should begin from the definition of the killed semigroup and the generator characterization. Express your final result as a closed-form analytic series in terms of $a$, $x$, and $t$.\n\nProvide your final answer as a single analytic expression. No numerical approximation is required or allowed. Do not include any units. The answer must be a single expression and not an inequality or an equation.", "solution": "We seek to find the survival probability $u(t,x) = \\mathbb{P}_{x}(t  \\tau)$, which is the probability that a one-dimensional standard Brownian motion starting at position $x \\in (0,a)$ has not left the interval by time $t$. The stopping time $\\tau$ is the first time the process hits either $0$ or $a$.\n\nThe evolution of such probabilities is governed by the backward Kolmogorov equation. Let $P_t^D$ be the semigroup of the Brownian motion killed at the boundary of the domain $D=(0,a)$. The survival probability corresponds to the semigroup acting on the function $f(y)=1$, so $u(t,x) = P_t^D 1(x)$. The semigroup evolves according to $\\frac{\\partial u}{\\partial t} = \\mathcal{L} u$, where $\\mathcal{L} = \\frac{1}{2} \\frac{\\partial^2}{\\partial x^2}$ is the infinitesimal generator for standard Brownian motion. This gives the partial differential equation:\n$$\n\\frac{\\partial u}{\\partial t} = \\frac{1}{2} \\frac{\\partial^2 u}{\\partial x^2}, \\quad \\text{for } x \\in (0,a) \\text{ and } t > 0.\n$$\nWe must also specify boundary and initial conditions. The killing at the boundary means the survival probability must be zero if the process starts at the boundary. This gives the Dirichlet boundary conditions:\n$$\nu(t,0) = 0 \\quad \\text{and} \\quad u(t,a) = 0, \\quad \\text{for } t > 0.\n$$\nAt time $t=0$, the process starts inside the interval, so it has not yet been killed. The survival probability is therefore 1, giving the initial condition:\n$$\nu(0,x) = 1, \\quad \\text{for } x \\in (0,a).\n$$\n\nWe solve this initial-boundary value problem using the method of separation of variables. Assuming a solution of the form $u(t,x) = T(t)X(x)$ leads to the eigenvalue problem $X''(x) + \\lambda X(x) = 0$ with $X(0)=0$ and $X(a)=0$. The eigenvalues and eigenfunctions for this Dirichlet problem are:\n$$\n\\lambda_n = \\left(\\frac{n\\pi}{a}\\right)^2, \\quad X_n(x) = \\sin\\left(\\frac{n\\pi x}{a}\\right) \\quad \\text{for } n=1, 2, 3, \\ldots\n$$\nThe corresponding temporal part is $T_n(t) = C_n \\exp\\left(-\\frac{\\lambda_n t}{2}\\right) = C_n \\exp\\left(-\\frac{n^2\\pi^2 t}{2a^2}\\right)$. The general solution is a superposition:\n$$\nu(t,x) = \\sum_{n=1}^{\\infty} C_n \\exp\\left(-\\frac{n^2\\pi^2 t}{2a^2}\\right) \\sin\\left(\\frac{n\\pi x}{a}\\right).\n$$\nThe coefficients $C_n$ are determined by the initial condition $u(0,x) = 1$, which requires finding the Fourier sine series of the constant function $f(x)=1$ on $(0,a)$:\n$$\n1 = \\sum_{n=1}^{\\infty} C_n \\sin\\left(\\frac{n\\pi x}{a}\\right).\n$$\nThe coefficients are calculated as:\n$$\nC_n = \\frac{2}{a} \\int_0^a 1 \\cdot \\sin\\left(\\frac{n\\pi x}{a}\\right) dx = \\frac{2}{a} \\left[-\\frac{a}{n\\pi}\\cos\\left(\\frac{n\\pi x}{a}\\right)\\right]_0^a = -\\frac{2}{n\\pi}((-1)^n-1).\n$$\nThis yields $C_n=0$ for even $n$ and $C_n = \\frac{4}{n\\pi}$ for odd $n$. We can re-index the sum using odd integers $n = 2k+1$ for $k=0, 1, 2, \\ldots$. Substituting these coefficients into the general solution gives the final expression for the survival probability:\n$$\nu(t,x) = \\frac{4}{\\pi} \\sum_{k=0}^{\\infty} \\frac{1}{2k+1} \\exp\\left(-\\frac{(2k+1)^2 \\pi^2 t}{2a^2}\\right) \\sin\\left(\\frac{(2k+1)\\pi x}{a}\\right).\n$$\nThis is the required closed-form analytic series.", "answer": "$$\\boxed{\\frac{4}{\\pi} \\sum_{k=0}^{\\infty} \\frac{1}{2k+1} \\exp\\left(-\\frac{(2k+1)^2 \\pi^2 t}{2a^2}\\right) \\sin\\left(\\frac{(2k+1)\\pi x}{a}\\right)}$$", "id": "2968272"}]}