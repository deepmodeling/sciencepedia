{"hands_on_practices": [{"introduction": "The Kolmogorov backward and forward equations are two sides of the same coin, a relationship formalized through the concept of adjoint operators. This first practice is a foundational exercise in mathematical machinery, guiding you to derive the forward (Fokker-Planck) operator as the formal adjoint of the infinitesimal generator $L$ associated with the backward equation. Mastering this derivation through integration by parts is crucial for understanding why the evolution of probability densities takes its specific form and how it connects to the underlying stochastic process [@problem_id:2983099].", "problem": "Consider a time-homogeneous Itô diffusion on $\\mathbb{R}^{d}$ with drift vector field $b=(b_{1},\\dots,b_{d})$ and diffusion matrix field $a=(a_{ij})_{1 \\leq i,j \\leq d}$, where each $b_{i}$ and $a_{ij}$ is a smooth function on $\\mathbb{R}^{d}$, and $a(x)$ is symmetric and positive semidefinite for each $x \\in \\mathbb{R}^{d}$. The infinitesimal generator $L$ of the diffusion acts on twice continuously differentiable functions $f \\in C^{2}(\\mathbb{R}^{d})$ according to\n$$\nL f(x) \\;=\\; \\sum_{i=1}^{d} b_{i}(x) \\,\\partial_{x_{i}} f(x) \\;+\\; \\frac{1}{2} \\sum_{i=1}^{d} \\sum_{j=1}^{d} a_{ij}(x) \\,\\partial_{x_{i} x_{j}}^{2} f(x).\n$$\nUsing the definition of the formal adjoint $L^{*}$ with respect to the Lebesgue inner product on $L^{2}(\\mathbb{R}^{d})$, namely that for all test functions $f,g \\in C_{c}^{\\infty}(\\mathbb{R}^{d})$,\n$$\n\\int_{\\mathbb{R}^{d}} g(x)\\, L f(x) \\, \\mathrm{d}x \\;=\\; \\int_{\\mathbb{R}^{d}} f(x)\\, L^{*} g(x) \\, \\mathrm{d}x,\n$$\nderive from first principles the explicit expression for $L^{*}$ acting on $g \\in C_{c}^{\\infty}(\\mathbb{R}^{d})$, starting from the fundamental fact that integration by parts transfers derivatives between factors while producing boundary terms that vanish for compactly supported test functions. As part of your derivation, specify clearly the integration by parts identities you use for the first-order drift term and the second-order diffusion term, and justify the absence of boundary contributions under the stated regularity and support assumptions.\n\nYour final answer must be a single closed-form analytic expression for $L^{*} g(x)$ in terms of $b_{i}(x)$, $a_{ij}(x)$, and the derivatives of $g$. No numerical approximation is required, and no units are involved. Express the final operator in a fully expanded divergence form with all derivatives acting on products of coefficients and $g$.", "solution": "The problem is well-posed, scientifically grounded, and contains sufficient information for a unique solution. The definitions of the infinitesimal generator and its formal adjoint are standard in the theory of stochastic processes and partial differential equations. The assumptions of smoothness for the coefficients $b_i$ and $a_{ij}$, and compact support for the test functions $f, g \\in C_{c}^{\\infty}(\\mathbb{R}^{d})$, are appropriate and necessary for the derivation. We proceed to the solution.\n\nThe formal adjoint $L^{*}$ of the operator $L$ is defined with respect to the standard $L^{2}$ inner product on $\\mathbb{R}^{d}$, which for real-valued functions is given by the integral of their product over $\\mathbb{R}^{d}$. For any two test functions $f, g \\in C_{c}^{\\infty}(\\mathbb{R}^{d})$, the defining relation is:\n$$\n\\int_{\\mathbb{R}^{d}} g(x)\\, L f(x) \\, \\mathrm{d}x \\;=\\; \\int_{\\mathbb{R}^{d}} f(x)\\, L^{*} g(x) \\, \\mathrm{d}x\n$$\nOur goal is to derive the explicit expression for $L^{*}g(x)$ by manipulating the left-hand side of this equation until $f(x)$ is factored out of the integral. We begin by substituting the definition of the operator $L$:\n$$\n\\int_{\\mathbb{R}^{d}} g(x) \\left( \\sum_{i=1}^{d} b_{i}(x) \\,\\partial_{x_{i}} f(x) \\;+\\; \\frac{1}{2} \\sum_{i=1}^{d} \\sum_{j=1}^{d} a_{ij}(x) \\,\\partial_{x_{i} x_{j}}^{2} f(x) \\right) \\mathrm{d}x\n$$\nWe can split this into two parts corresponding to the drift and diffusion terms:\n$$\n\\text{Left-hand side} = \\sum_{i=1}^{d} \\int_{\\mathbb{R}^{d}} g(x) b_{i}(x) \\partial_{x_{i}} f(x) \\, \\mathrm{d}x \\;+\\; \\frac{1}{2} \\sum_{i=1}^{d} \\sum_{j=1}^{d} \\int_{\\mathbb{R}^{d}} g(x) a_{ij}(x) \\partial_{x_{i} x_{j}}^{2} f(x) \\, \\mathrm{d}x\n$$\nLet us analyze each part separately using integration by parts.\n\nFirst, consider the drift term. For each $i \\in \\{1, \\dots, d\\}$, we have the integral:\n$$\n\\int_{\\mathbb{R}^{d}} \\left( g(x) b_{i}(x) \\right) \\left( \\partial_{x_{i}} f(x) \\right) \\, \\mathrm{d}x\n$$\nThe integration by parts formula in one dimension, which follows from the divergence theorem, states that for functions $u$ and $v$ on $\\mathbb{R}^d$:\n$$\n\\int_{\\mathbb{R}^{d}} u \\, \\partial_{x_{i}} v \\, \\mathrm{d}x = -\\int_{\\mathbb{R}^{d}} v \\, \\partial_{x_{i}} u \\, \\mathrm{d}x\n$$\nThis simplified form holds when boundary terms vanish. In our case, we set $u = g(x) b_{i}(x)$ and $v = f(x)$. Since $f \\in C_{c}^{\\infty}(\\mathbb{R}^{d})$, it has compact support. Let the support of $f$ be contained in a compact set $K$. We can perform the integration over a domain $\\Omega$ that contains $K$. On the boundary $\\partial\\Omega$, $f(x)=0$. The full integration by parts formula gives a boundary term $\\int_{\\partial\\Omega} u v n_i \\, \\mathrm{d}S$, which vanishes because $f(x)=0$ on $\\partial\\Omega$. Thus, we can transfer the derivative $\\partial_{x_i}$ from $f$ to the product $g b_i$:\n$$\n\\int_{\\mathbb{R}^{d}} g(x) b_{i}(x) \\partial_{x_{i}} f(x) \\, \\mathrm{d}x = - \\int_{\\mathbb{R}^{d}} f(x) \\partial_{x_{i}} \\left( g(x) b_{i}(x) \\right) \\, \\mathrm{d}x\n$$\nSumming over $i$, the entire drift term becomes:\n$$\n\\sum_{i=1}^{d} \\int_{\\mathbb{R}^{d}} g(x) b_{i}(x) \\partial_{x_{i}} f(x) \\, \\mathrm{d}x = \\int_{\\mathbb{R}^{d}} f(x) \\left( - \\sum_{i=1}^{d} \\partial_{x_{i}} \\left( g(x) b_{i}(x) \\right) \\right) \\, \\mathrm{d}x\n$$\n\nNext, we consider the diffusion term. For each pair $(i, j) \\in \\{1, \\dots, d\\}^2$, we have the integral:\n$$\n\\int_{\\mathbb{R}^{d}} g(x) a_{ij}(x) \\partial_{x_{i} x_{j}}^{2} f(x) \\, \\mathrm{d}x\n$$\nWe apply integration by parts twice to move the second-order partial derivative $\\partial_{x_{i} x_{j}}^{2}$ from $f$ to the product $g a_{ij}$. First, we integrate by parts with respect to $x_j$:\n$$\n\\int_{\\mathbb{R}^{d}} \\left( g(x) a_{ij}(x) \\right) \\partial_{x_j} (\\partial_{x_i} f(x)) \\, \\mathrm{d}x = - \\int_{\\mathbb{R}^{d}} (\\partial_{x_i} f(x)) \\partial_{x_j} \\left( g(x) a_{ij}(x) \\right) \\, \\mathrm{d}x\n$$\nThe boundary term vanishes because $f \\in C_{c}^{\\infty}(\\mathbb{R}^{d})$ implies that all its partial derivatives, including $\\partial_{x_i}f$, also have compact support and thus vanish on the boundary of any sufficiently large integration domain.\n\nNow, we apply integration by parts a second time, with respect to $x_i$, to the resulting expression:\n$$\n- \\int_{\\mathbb{R}^{d}} (\\partial_{x_i} f(x)) \\left( \\partial_{x_j} (g(x) a_{ij}(x)) \\right) \\, \\mathrm{d}x = \\int_{\\mathbb{R}^{d}} f(x) \\partial_{x_i} \\left( \\partial_{x_j} (g(x) a_{ij}(x)) \\right) \\, \\mathrm{d}x\n$$\nAgain, the boundary term vanishes due to the compact support of $f$. Since $g$ and $a_{ij}$ are smooth, the product $g(x)a_{ij}(x)$ is at least $C^2$ (as $g \\in C^\\infty$), so by Schwarz's theorem (or Clairaut's theorem), the order of differentiation can be interchanged: $\\partial_{x_i}\\partial_{x_j} = \\partial_{x_j}\\partial_{x_i}$. Therefore, we have:\n$$\n\\int_{\\mathbb{R}^{d}} g(x) a_{ij}(x) \\partial_{x_{i} x_{j}}^{2} f(x) \\, \\mathrm{d}x = \\int_{\\mathbb{R}^{d}} f(x) \\partial_{x_{i} x_{j}}^{2} \\left( g(x) a_{ij}(x) \\right) \\, \\mathrm{d}x\n$$\nSumming over $i$ and $j$ and including the factor of $\\frac{1}{2}$, the total diffusion term becomes:\n$$\n\\frac{1}{2} \\sum_{i,j=1}^{d} \\int_{\\mathbb{R}^{d}} g(x) a_{ij}(x) \\partial_{x_i x_j}^2 f(x) \\, \\mathrm{d}x = \\int_{\\mathbb{R}^{d}} f(x) \\left( \\frac{1}{2} \\sum_{i,j=1}^{d} \\partial_{x_{i} x_{j}}^{2} \\left( g(x) a_{ij}(x) \\right) \\right) \\, \\mathrm{d}x\n$$\n\nCombining the results for the drift and diffusion parts, we get:\n$$\n\\int_{\\mathbb{R}^{d}} g(x) L f(x) \\, \\mathrm{d}x = \\int_{\\mathbb{R}^{d}} f(x) \\left( - \\sum_{i=1}^{d} \\partial_{x_i} (g(x) b_i(x)) + \\frac{1}{2} \\sum_{i,j=1}^{d} \\partial_{x_i x_j}^2 (g(x) a_{ij}(x)) \\right) \\, \\mathrm{d}x\n$$\nBy comparing this with the definition $\\int_{\\mathbb{R}^{d}} g(x) L f(x) \\, \\mathrm{d}x = \\int_{\\mathbb{R}^{d}} f(x) L^{*} g(x) \\, \\mathrm{d}x$, and invoking the fundamental lemma of calculus of variations (since the equality must hold for all test functions $f \\in C_{c}^{\\infty}(\\mathbb{R}^{d})$), we can identify the integrand multiplying $f(x)$ as $L^{*}g(x)$.\n\nTherefore, the explicit expression for the action of the formal adjoint operator $L^{*}$ on a function $g \\in C_{c}^{\\infty}(\\mathbb{R}^{d})$ is:\n$$\nL^{*} g(x) = - \\sum_{i=1}^{d} \\partial_{x_{i}} \\left( b_{i}(x) g(x) \\right) + \\frac{1}{2} \\sum_{i,j=1}^{d} \\partial_{x_{i} x_{j}}^{2} \\left( a_{ij}(x) g(x) \\right)\n$$\nThis is the Fokker-Planck operator. The expression is in the \"fully expanded divergence form\" requested, as the derivatives $\\partial_{x_i}$ and $\\partial_{x_i x_j}^2$ are acting on the products of the coefficients with the function $g$.", "answer": "$$\\boxed{- \\sum_{i=1}^{d} \\partial_{x_{i}} (b_i(x) g(x)) + \\frac{1}{2} \\sum_{i,j=1}^{d} \\partial_{x_{i} x_{j}}^{2} (a_{ij}(x) g(x))}$$", "id": "2983099"}, {"introduction": "With the theoretical groundwork in place, we now apply the backward Kolmogorov equation to a classic and important problem: calculating the Mean First Passage Time (MFPT). This practice demonstrates the power of the backward equation to transform a question about the average outcome of a random process into a deterministic boundary value problem. You will solve an ordinary differential equation for the MFPT of a particle in a potential, considering physically relevant scenarios like absorbing and partially absorbing boundaries [@problem_id:753008].", "problem": "A point-like particle undergoes one-dimensional diffusion with a constant drift. The stochastic process $X_t$ representing the particle's position is described by the Itô stochastic differential equation:\n$$\ndX_t = \\mu dt + \\sqrt{2D} dW_t\n$$\nwhere $\\mu$ is the constant drift velocity, $D$ is the constant diffusion coefficient, and $W_t$ is a standard Wiener process.\n\nThe particle moves within the spatial interval $[0, L]$. The Mean First Passage Time (MFPT), $T(x)$, which is the average time for a particle starting at position $x \\in [0, L]$ to first exit the interval, is governed by the steady-state backward Kolmogorov equation:\n$$\nD \\frac{d^2 T}{dx^2} + \\mu \\frac{dT}{dx} = -1\n$$\n\nThe boundaries of the interval have different properties:\n1.  The boundary at $x=0$ is perfectly absorbing. This implies that the time to reach this boundary, if starting from it, is zero.\n2.  The boundary at $x=L$ is partially absorbing and is described by a Robin-type boundary condition:\n    $$\n    T(L) - \\lambda \\frac{dT}{dx}\\bigg|_{x=L} = 0\n    $$\n    where $\\lambda$ is a positive constant with units of length, known as the extrapolation length. This parameter characterizes the permeability of the boundary.\n\nDerive the expression for the Mean First Passage Time, $T(x_0)$, for a particle starting at an arbitrary position $x_0 \\in (0, L)$. The final expression should be in terms of $x_0, L, \\mu, D,$ and $\\lambda$. Assume $\\mu \\neq 0$.", "solution": "The Mean First Passage Time $T(x)$ is the solution to the second-order ordinary differential equation:\n$$ D\\frac{d^2T}{dx^2}+\\mu\\frac{dT}{dx}=-1 $$\nWe solve this by finding the general solution and then applying the boundary conditions.\n\n1.  **Homogeneous Solution**: The homogeneous equation is $D T''+\\mu T'=0$. The characteristic equation $D r^2 + \\mu r = 0$ has roots $r=0$ and $r=-\\mu/D$. The homogeneous solution is $T_h(x) = C_1 + C_2 e^{-\\mu x/D}$.\n2.  **Particular Solution**: We look for a particular solution of the form $T_p(x)=Cx$. Substituting into the ODE gives $\\mu C = -1$, so $C = -1/\\mu$. The particular solution is $T_p(x) = -x/\\mu$.\n3.  **General Solution**: The general solution is the sum of the homogeneous and particular solutions. Renaming the constants, we have:\n    $$ T(x) = A + B e^{-\\mu x/D} - \\frac{x}{\\mu} $$\n4.  **Apply Boundary Conditions**:\n    *   The absorbing boundary at $x=0$ means $T(0)=0$. Applying this to the general solution gives $A+B-0=0$, which implies $A=-B$. The solution becomes $T(x) = B(e^{-\\mu x/D} - 1) - x/\\mu$.\n    *   The Robin condition at $x=L$ is $T(L) - \\lambda T'(L) = 0$. We first find the derivative:\n        $$ T'(x) = -\\frac{\\mu}{D} B e^{-\\mu x/D} - \\frac{1}{\\mu} $$\n        Substituting $T(L)$ and $T'(L)$ into the Robin condition:\n        $$ \\left( B(e^{-\\mu L/D} - 1) - \\frac{L}{\\mu} \\right) - \\lambda \\left( -\\frac{\\mu}{D} B e^{-\\mu L/D} - \\frac{1}{\\mu} \\right) = 0 $$\n        Now, we solve this equation for the constant $B$:\n        $$ B \\left[ (e^{-\\mu L/D} - 1) + \\frac{\\lambda \\mu}{D} e^{-\\mu L/D} \\right] = \\frac{L-\\lambda}{\\mu} $$\n        $$ B = \\frac{L-\\lambda}{\\mu \\left[ (1+\\frac{\\mu\\lambda}{D})e^{-\\mu L/D} - 1 \\right]} $$\n5.  **Final Solution**: Substituting the expression for $B$ back into the equation for $T(x)$ and setting $x=x_0$ gives the final expression for the MFPT, which simplifies to the boxed answer.", "answer": "$$\\boxed{\\frac{(L-\\lambda)\\bigl(1-e^{-\\frac{\\mu x_0}{D}}\\bigr)-x_0\\bigl[1-(1+\\tfrac{\\mu\\lambda}{D})e^{-\\frac{\\mu L}{D}}\\bigr]}{\\mu\\bigl[1-(1+\\tfrac{\\mu\\lambda}{D})e^{-\\frac{\\mu L}{D}}\\bigr]}}$$", "id": "753008"}, {"introduction": "Finally, we turn our attention to the forward Kolmogorov equation, which governs the dynamics of the probability density function itself. This exercise tackles the problem of finding a stationary state in a system with continuous particle injection and absorption, a common scenario in physics and chemistry. By solving for the steady-state density and its associated flux, you will see how the forward equation provides a complete description of a non-equilibrium steady state, balancing sources and sinks to maintain a time-independent profile [@problem_id:753102].", "problem": "A one-dimensional system of non-interacting particles is defined on the interval $[0, L]$. The particles undergo a diffusion process with diffusion coefficient $D$ and are subjected to a constant drift velocity $\\mu$. The evolution of the particle number density, $p(x,t)$, is described by the Fokker-Planck (or forward Kolmogorov) equation.\n\nThe boundaries at $x=0$ and $x=L$ are absorbing, meaning any particle reaching these points is instantly removed from the system. This implies that the particle density at the boundaries is always zero.\n\nTo counteract the particle loss at the boundaries, a spatially-dependent source continuously injects new particles into the system at a rate $S(x)$. The source term is linear in position, given by $S(x) = \\rho_0 \\frac{x}{L}$, where $\\rho_0$ is a constant with units of inverse length per inverse time.\n\nAfter a long time, the system reaches a stationary state with a time-independent particle density profile, $p_s(x)$. In this steady state, the rate of particle injection is balanced by the rate of absorption at the boundaries.\n\nDerive the expression for the stationary particle flux at the boundary $x=0$, denoted as $J_s(0)$.\n\nThe particle flux $J(x,t)$ is given by $J(x,t) = \\mu p(x,t) - D \\frac{\\partial p(x,t)}{\\partial x}$.", "solution": "We seek the steady-state solution of the Fokker-Planck equation, where $\\frac{\\partial p}{\\partial t} = 0$:\n$$ 0 = -\\frac{dJ_s}{dx} + S(x) $$\nThe flux $J_s(x)$ is given by $J_s(x)=\\mu p_s(x)-D\\frac{dp_s}{dx}$, the source is $S(x)=\\rho_0 x/L$, and the boundary conditions are $p_s(0)=p_s(L)=0$.\n\n1.  First, we integrate the steady-state equation $\\frac{dJ_s}{dx}=S(x)$:\n    $$ \\frac{dJ_s}{dx} = \\frac{\\rho_0 x}{L} \\implies J_s(x) = J_s(0) + \\int_0^x \\frac{\\rho_0 u}{L} du = J_s(0) + \\frac{\\rho_0 x^2}{2L} $$\n    Let's denote the unknown constant flux at the origin as $J_0 = J_s(0)$.\n\n2.  Next, substitute this expression for the flux into its definition to get an ODE for $p_s(x)$:\n    $$ \\mu p_s(x) - D \\frac{dp_s}{dx} = J_0 + \\frac{\\rho_0 x^2}{2L} \\implies \\frac{dp_s}{dx} - \\frac{\\mu}{D}p_s(x) = -\\frac{1}{D}\\left(J_0+\\frac{\\rho_0 x^2}{2L}\\right) $$\n\n3.  We solve this first-order linear ODE using the integrating factor $I(x)=e^{-(\\mu/D)x}$. This gives the general solution satisfying $p_s(0)=0$:\n    $$ \\frac{d}{dx}\\left(e^{-(\\mu/D)x} p_s(x)\\right) = -\\frac{e^{-(\\mu/D)x}}{D}\\left(J_0+\\frac{\\rho_0 x^2}{2L}\\right) $$\n    Integrating from $0$ to $x$:\n    $$ p_s(x) = -\\frac{e^{(\\mu/D)x}}{D} \\int_0^x e^{-(\\mu/D)u} \\left(J_0+\\frac{\\rho_0 u^2}{2L}\\right) du $$\n\n4.  To find $J_0$, we enforce the second boundary condition, $p_s(L)=0$. This sets the integral from $0$ to $L$ to zero:\n    $$ \\int_0^L e^{-(\\mu/D)u} \\left(J_0+\\frac{\\rho_0 u^2}{2L}\\right) du = 0 $$\n    Solving this integral equation for $J_0$ requires evaluating standard integrals for $\\int e^{-au} du$ and $\\int u^2 e^{-au} du$. After performing the integrations and solving for $J_0$, we arrive at the final result for the flux at the origin.", "answer": "$$\\boxed{\\rho_0\\left(\\frac{\\frac{L}{2}+\\frac{D}{\\mu}}{e^{\\mu L/D}-1}-\\frac{D^2}{\\mu^2L}\\right)}$$", "id": "753102"}]}