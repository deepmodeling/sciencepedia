{"hands_on_practices": [{"introduction": "Before we can understand the limit of ordinary differential equations (ODEs) driven by approximate noise, we must first understand the unusual nature of the limiting noise process itself. This foundational exercise explores the quadratic variation of a piecewise linear approximation to Brownian motion, revealing the property that sets it apart from the smooth functions of classical calculus [@problem_id:3004534]. By proving that this variation does not vanish in the limit, you will grasp the fundamental reason why a new, non-classical calculus is required to make sense of stochastic differential equations.", "problem": "Let $\\{W_{t}\\}_{t \\in [0,T]}$ be a standard one-dimensional Brownian motion on a filtered probability space $(\\Omega,\\mathcal{F},\\{\\mathcal{F}_{t}\\}_{t \\ge 0},\\mathbb{P})$ with $W_{0}=0$. For $\\delta>0$, consider the uniform partition $\\mathcal{P}_{\\delta}=\\{t_{k}=k\\delta: k=0,1,\\dots,N_{\\delta}\\}$ with $N_{\\delta}=\\lfloor T/\\delta \\rfloor$, and define the polygonal (piecewise linear) interpolation $W^{\\delta}$ by\n$$\nW^{\\delta}_{t} \\;=\\; W_{t_{k}} \\;+\\; \\frac{t-t_{k}}{t_{k+1}-t_{k}}\\Big(W_{t_{k+1}}-W_{t_{k}}\\Big), \\quad t \\in [t_{k},t_{k+1}), \\quad k=0,1,\\dots,N_{\\delta}-1.\n$$\nFor $t \\in [0,T]$, define the mesh-based quadratic variation of $W^{\\delta}$ along its construction partition by\n$$\n[W^{\\delta}]_{t} \\;=\\; \\sum_{k=0}^{N_{t}^{\\delta}-1} \\Big(W^{\\delta}_{t_{k+1}}-W^{\\delta}_{t_{k}}\\Big)^{2}, \\quad \\text{where} \\quad N_{t}^{\\delta}=\\left\\lfloor \\frac{t}{\\delta} \\right\\rfloor.\n$$\nStarting only from the defining properties of Brownian motion (stationary independent Gaussian increments with $\\mathbb{E}[W_{t}]=0$ and $\\operatorname{Var}(W_{t})=t$), and from the above definitions, perform the following:\n\n1) Express $[W^{\\delta}]_{t}$ in terms of the Brownian increments $\\Delta W_{k}=W_{t_{k+1}}-W_{t_{k}}$.\n\n2) Prove that $[W^{\\delta}]_{t} \\to t$ in probability as $\\delta \\to 0$, and that along the dyadic sequence $\\delta_{n}=2^{-n}$ one has almost sure convergence $[W^{\\delta_{n}}]_{t} \\to t$.\n\n3) Briefly explain, using only fundamental definitions, how this limit identifies the effective limiting calculus in the Wong–Zakai setting for solutions of ordinary differential equations driven by $W^{\\delta}$ as $\\delta \\to 0$.\n\nProvide as your final answer the exact closed-form expression for the limit of $[W^{\\delta}]_{t}$ as $\\delta \\to 0$ (no units). The final answer must be a single analytic expression.", "solution": "This problem is a valid and well-posed exercise in stochastic calculus. It requires demonstrating a fundamental property of Brownian motion—its non-zero quadratic variation—by analyzing its polygonal approximations. All definitions are standard and the tasks are mathematically sound.\n\nThe solution proceeds in three parts as requested.\n\nPart 1: Expression for $[W^{\\delta}]_{t}$\n\nThe problem defines the mesh-based quadratic variation of the polygonal approximation $W^{\\delta}$ as\n$$\n[W^{\\delta}]_{t} \\;=\\; \\sum_{k=0}^{N_{t}^{\\delta}-1} \\Big(W^{\\delta}_{t_{k+1}}-W^{\\delta}_{t_{k}}\\Big)^{2}\n$$\nwhere $t_k = k\\delta$ are the points of the partition $\\mathcal{P}_{\\delta}$ and $N_{t}^{\\delta}=\\lfloor t/\\delta \\rfloor$. The core of this part is to evaluate the increment $W^{\\delta}_{t_{k+1}}-W^{\\delta}_{t_{k}}$.\n\nThe polygonal interpolation $W^{\\delta}_{t}$ is defined on the interval $t \\in [t_{k}, t_{k+1})$ by\n$$\nW^{\\delta}_{t} \\;=\\; W_{t_{k}} \\;+\\; \\frac{t-t_{k}}{t_{k+1}-t_{k}}\\Big(W_{t_{k+1}}-W_{t_{k}}\\Big)\n$$\nBy construction, this interpolation matches the original Brownian motion $W_{t}$ at the partition points $t_k$. To verify this, we evaluate $W^{\\delta}_{t}$ at $t=t_k$:\n$$\nW^{\\delta}_{t_{k}} \\;=\\; W_{t_{k}} \\;+\\; \\frac{t_{k}-t_{k}}{t_{k+1}-t_{k}}\\Big(W_{t_{k+1}}-W_{t_{k}}\\Big) \\;=\\; W_{t_{k}} \\;+\\; 0 \\cdot \\Big(W_{t_{k+1}}-W_{t_{k}}\\Big) \\;=\\; W_{t_{k}}\n$$\nTo find the value at $t_{k+1}$, we consider the next interval in the partition, which starts at $t_{k+1}$. The same formula applies, with the indices shifted up by one. Setting $t=t_{k+1}$ in the definition for the interval $[t_{k+1}, t_{k+2})$ yields:\n$$\nW^{\\delta}_{t_{k+1}} \\;=\\; W_{t_{k+1}} \\;+\\; \\frac{t_{k+1}-t_{k+1}}{t_{k+2}-t_{k+1}}\\Big(W_{t_{k+2}}-W_{t_{k+1}}\\Big) \\;=\\; W_{t_{k+1}}\n$$\nTherefore, the increment of the polygonal approximation between two consecutive partition points is identical to the increment of the Brownian motion itself:\n$$\nW^{\\delta}_{t_{k+1}}-W^{\\delta}_{t_{k}} \\;=\\; W_{t_{k+1}}-W_{t_{k}}\n$$\nThe problem denotes this increment as $\\Delta W_{k}$. Substituting this into the definition of $[W^{\\delta}]_{t}$, we obtain:\n$$\n[W^{\\delta}]_{t} \\;=\\; \\sum_{k=0}^{N_{t}^{\\delta}-1} (W_{t_{k+1}}-W_{t_{k}})^{2} \\;=\\; \\sum_{k=0}^{N_{t}^{\\delta}-1} (\\Delta W_{k})^{2}\n$$\n\nPart 2: Convergence Proof\n\nLet $S_{t}^{\\delta} = [W^{\\delta}]_{t} = \\sum_{k=0}^{N_{t}^{\\delta}-1} (\\Delta W_{k})^{2}$. We are given that Brownian motion has stationary, independent, Gaussian increments. The increment $\\Delta W_{k} = W_{t_{k+1}}-W_{t_{k}}$ over a time interval of duration $t_{k+1}-t_k = \\delta$ is a normal random variable with mean $0$ and variance $\\delta$, i.e., $\\Delta W_k \\sim \\mathcal{N}(0, \\delta)$.\nWe can express $\\Delta W_k$ in terms of a standard normal variable $Z_k \\sim \\mathcal{N}(0, 1)$ as $\\Delta W_k = \\sqrt{\\delta}Z_k$, where $\\{Z_k\\}$ is a sequence of independent and identically distributed (i.i.d.) random variables.\nThus, $S_{t}^{\\delta}$ can be rewritten as:\n$$\nS_{t}^{\\delta} \\;=\\; \\sum_{k=0}^{N_{t}^{\\delta}-1} (\\sqrt{\\delta} Z_k)^2 \\;=\\; \\delta \\sum_{k=0}^{N_{t}^{\\delta}-1} Z_k^2\n$$\nTo prove convergence, we first compute the expectation of $S_{t}^{\\delta}$. The expectation of $Z_k^2$ is $\\mathbb{E}[Z_k^2] = \\operatorname{Var}(Z_k) + (\\mathbb{E}[Z_k])^2 = 1 + 0^2 = 1$.\n$$\n\\mathbb{E}[S_{t}^{\\delta}] \\;=\\; \\mathbb{E}\\left[\\delta \\sum_{k=0}^{N_{t}^{\\delta}-1} Z_k^2\\right] \\;=\\; \\delta \\sum_{k=0}^{N_{t}^{\\delta}-1} \\mathbb{E}[Z_k^2] \\;=\\; \\delta \\cdot N_{t}^{\\delta} \\cdot 1 \\;=\\; \\delta N_{t}^{\\delta}\n$$\nSince $N_{t}^{\\delta} = \\lfloor t/\\delta \\rfloor$, we have the inequality $t/\\delta - 1 < N_{t}^{\\delta} \\le t/\\delta$, which implies $t-\\delta < \\delta N_{t}^{\\delta} \\le t$. As $\\delta \\to 0$, we conclude that $\\lim_{\\delta \\to 0} \\mathbb{E}[S_{t}^{\\delta}] = t$.\n\nTo prove convergence in probability, we show convergence in $L^2$, which is a stronger mode of convergence. This requires showing $\\mathbb{E}[(S_{t}^{\\delta} - t)^2] \\to 0$. We decompose the mean squared error:\n$$\n\\mathbb{E}[(S_{t}^{\\delta} - t)^2] = \\operatorname{Var}(S_{t}^{\\delta}) + (\\mathbb{E}[S_{t}^{\\delta}]-t)^2\n$$\nWe have already established that $(\\mathbb{E}[S_{t}^{\\delta}]-t)^2 \\to 0$. We now compute the variance. As the $Z_k$ are independent, so are the $Z_k^2$.\n$$\n\\operatorname{Var}(S_{t}^{\\delta}) \\;=\\; \\operatorname{Var}\\left(\\delta \\sum_{k=0}^{N_{t}^{\\delta}-1} Z_k^2\\right) \\;=\\; \\delta^2 \\sum_{k=0}^{N_{t}^{\\delta}-1} \\operatorname{Var}(Z_k^2)\n$$\nThe variance of $Z_k^2$ is $\\operatorname{Var}(Z_k^2) = \\mathbb{E}[Z_k^4] - (\\mathbb{E}[Z_k^2])^2$. For a standard normal variable, the fourth moment is $\\mathbb{E}[Z_k^4] = 3$. Thus, $\\operatorname{Var}(Z_k^2) = 3 - 1^2 = 2$.\n$$\n\\operatorname{Var}(S_{t}^{\\delta}) \\;=\\; \\delta^2 \\sum_{k=0}^{N_{t}^{\\delta}-1} 2 \\;=\\; 2\\delta^2 N_{t}^{\\delta}\n$$\nUsing the bound $N_{t}^{\\delta} \\le t/\\delta$, we get $\\operatorname{Var}(S_{t}^{\\delta}) \\le 2\\delta^2 (t/\\delta) = 2t\\delta$. As $\\delta \\to 0$, $\\operatorname{Var}(S_{t}^{\\delta}) \\to 0$.\nSince both terms in the mean squared error go to zero, $\\mathbb{E}[(S_{t}^{\\delta} - t)^2] \\to 0$. This implies $S_{t}^{\\delta} \\to t$ in $L^2$, and therefore in probability.\n\nFor almost sure convergence along the dyadic sequence $\\delta_n = 2^{-n}$, we let $S_n = S_t^{\\delta_n}$. We apply Chebyshev's inequality and the Borel-Cantelli lemma. For any $\\epsilon > 0$:\n$$\n\\mathbb{P}(|S_n - \\mathbb{E}[S_n]| > \\epsilon) \\le \\frac{\\operatorname{Var}(S_n)}{\\epsilon^2}\n$$\nThe variance is $\\operatorname{Var}(S_n) = 2\\delta_n^2 N_{t}^{\\delta_n} \\le 2t\\delta_n = 2t \\cdot 2^{-n}$. So,\n$$\n\\sum_{n=1}^{\\infty} \\mathbb{P}(|S_n - \\mathbb{E}[S_n]| > \\epsilon) \\le \\sum_{n=1}^{\\infty} \\frac{2t \\cdot 2^{-n}}{\\epsilon^2} = \\frac{2t}{\\epsilon^2} \\sum_{n=1}^{\\infty} \\left(\\frac{1}{2}\\right)^n\n$$\nThis is a convergent geometric series. By the first Borel-Cantelli lemma, $S_n - \\mathbb{E}[S_n] \\to 0$ almost surely. Since we also know $\\mathbb{E}[S_n] \\to t$, we can conclude that $S_n \\to t$ almost surely.\n\nPart 3: Connection to the Wong-Zakai theorem\n\nThe Wong-Zakai theorem addresses the limit of solutions to ordinary differential equations (ODEs) driven by smooth approximations of a stochastic process, such as white noise. In our problem, the equation is $dy^{\\delta}_{t} = f(y^{\\delta}_{t}) dW^{\\delta}_{t}$, where $W^{\\delta}_{t}$ is a piecewise differentiable function. For any finite $\\delta > 0$, this is a standard ODE whose solution obeys the rules of ordinary calculus, including the classical chain rule: $d(g(y^{\\delta}_{t})) = g'(y^{\\delta}_{t}) dy^{\\delta}_{t}$.\n\nAs $\\delta \\to 0$, the approximation $W^{\\delta}_{t}$ converges to the Brownian motion $W_t$, and the solution $y^{\\delta}_{t}$ converges to the solution $Y_t$ of a stochastic differential equation (SDE). The central issue is determining the correct \"calculus\" (Itō or Stratonovich) for the limiting SDE.\n\nThe choice of calculus is dictated by the behavior of the quadratic variation. In ordinary calculus, the quadratic variation of any smooth function is zero. For example, for a $C^1$ function $\\phi(t)$, the sum of squared increments is $\\sum (\\phi(t_{k+1})-\\phi(t_k))^2 \\approx \\sum (\\phi'(t_k)\\delta)^2 = \\delta \\sum (\\phi'(t_k))^2\\delta \\to 0$ as $\\delta \\to 0$. The rules of ordinary calculus rely on this property.\n\nHowever, as we proved in Part 2, the quadratic variation of the Brownian approximation does not vanish in the limit: $[W^{\\delta}]_t \\to t$. The limiting process $W_t$ has a non-zero quadratic variation, $[W]_t = t$. This is the defining feature that necessitates a special stochastic calculus.\n\nThe Stratonovich integral is defined in a way that preserves the classical chain rule, just like the ODEs for $y^{\\delta}_{t}$. The convergence of the ODE solutions $y^{\\delta}_{t}$ to the solution of a Stratonovich SDE, $dY_t = f(Y_t) \\circ dW_t$, is therefore natural. The structure of the calculus governing the approximations is maintained in the limit.\n\nIn contrast, the Itō integral is defined using non-anticipating integrands, which leads to a different chain rule (Itō's lemma) that includes a second-order term: $d(g(Y_t)) = g'(Y_t)f(Y_t)dW_t + \\frac{1}{2}g''(Y_t)f(Y_t)^2 dt$ for an Itō SDE $dY_t=f(Y_t)dW_t$. This correction term is a direct consequence of the rule $(dW_t)^2 = dt$, i.e., the non-zero quadratic variation of Brownian motion.\n\nIn summary, the result $[W^{\\delta}]_t \\to t$ shows that the smooth approximations $W^{\\delta}_t$ \"carry\" the non-zero quadratic variation of Brownian motion into the limit. Because the pre-limit ODEs obey ordinary calculus rules, the limiting SDE must be of the type that also preserves these rules, which is precisely the Stratonovich SDE.", "answer": "$$\\boxed{t}$$", "id": "3004534"}, {"introduction": "The Wong-Zakai theorem tells us that ODEs driven by smooth noise converge to Stratonovich stochastic differential equations (SDEs), which must be converted to the Itō form via a correction term. This practice demystifies that correction term by deriving it from a concrete numerical approximation [@problem_id:3004514]. By analyzing the limit of a trapezoidal rule scheme—a method known to converge to Stratonovich integrals—you will see precisely how the noise's quadratic variation interacts with the diffusion function's derivative to produce the famous drift correction.", "problem": "Consider a one-dimensional Ordinary Differential Equation (ODE) driven by a smooth approximation of a standard Brownian motion, defined as follows. Let $W$ be a standard Brownian motion, and for each $\\delta>0$ let $W^{\\delta}$ be a smooth approximation obtained by convolving $W$ with a symmetric mollifier $\\rho_{\\delta}$, so that $W^{\\delta}$ has a classical time derivative $\\dot{W}^{\\delta}$. Let $f:\\mathbb{R}\\to\\mathbb{R}$ and $g:\\mathbb{R}\\to\\mathbb{R}$ be twice continuously differentiable functions with bounded first and second derivatives. For a fixed $\\delta>0$, consider the pathwise ODE\n$$\n\\frac{dX_{t}^{\\delta}}{dt} \\;=\\; f\\!\\big(X_{t}^{\\delta}\\big) \\;+\\; g\\!\\big(X_{t}^{\\delta}\\big)\\,\\dot{W}_{t}^{\\delta}, \n\\qquad X_{0}^{\\delta}=x_{0}.\n$$\nLet $0=t_{0}<t_{1}<\\dots<t_{n}=T$ be a partition of $[0,T]$ with mesh size $h=\\max_{k}(t_{k+1}-t_{k})$, and set $\\Delta W_{k}^{\\delta}=W_{t_{k+1}}^{\\delta}-W_{t_{k}}^{\\delta}$. Apply the trapezoidal rule both to the drift and the noise terms to define the implicit time-stepping scheme\n$$\nX_{k+1}^{\\delta} \\;=\\; X_{k}^{\\delta} \\;+\\; \\frac{1}{2}\\Big(f\\!\\big(X_{k}^{\\delta}\\big)+f\\!\\big(X_{k+1}^{\\delta}\\big)\\Big) h \n\\;+\\; \\frac{1}{2}\\Big(g\\!\\big(X_{k}^{\\delta}\\big)+g\\!\\big(X_{k+1}^{\\delta}\\big)\\Big)\\,\\Delta W_{k}^{\\delta}.\n$$\nAssume that as $h\\to 0$ the scheme converges to the ODE solution for the fixed smooth driver $W^{\\delta}$, and then as $\\delta\\to 0$, $W^{\\delta}\\to W$ uniformly on compacts in probability, so that $X^{\\delta}$ converges (in a suitable sense) to a limit process $X$. Starting from fundamental definitions and using only well-tested facts such as Taylor expansions for smooth functions and the quadratic variation property of Brownian motion, derive the limiting contribution of the trapezoidal rule applied to the noise term and identify the resulting drift correction when the limit is interpreted in the Itō sense. \n\nYour goal is to compute the explicit closed-form analytic expression for the drift correction function $C(x)$ that must be added to the drift $f(x)$ when passing from the Stratonovich interpretation to the Itō interpretation of the limiting Stochastic Differential Equation (SDE). Express your final answer as a single symbolic expression in terms of $g$ and its derivatives. No numerical approximation or rounding is required. The answer must be a single analytic expression without units.", "solution": "The problem statement is first validated against the required criteria.\n\n### Step 1: Extract Givens\n- The process $X_t^\\delta$ is governed by the ordinary differential equation (ODE) for a fixed $\\delta > 0$:\n$$ \\frac{dX_{t}^{\\delta}}{dt} = f\\big(X_{t}^{\\delta}\\big) + g\\big(X_{t}^{\\delta}\\big)\\dot{W}_{t}^{\\delta}, \\quad X_{0}^{\\delta}=x_{0} $$\n- $W$ is a standard Brownian motion. $W^\\delta$ is its smooth approximation, possessing a classical derivative $\\dot{W}^\\delta$.\n- The functions $f, g: \\mathbb{R} \\to \\mathbb{R}$ are twice continuously differentiable ($C^2$) with bounded first and second derivatives.\n- An implicit time-stepping scheme based on the trapezoidal rule is provided for a partition $0=t_0 < t_1 < \\dots < t_n = T$ with mesh size $h$:\n$$ X_{k+1}^{\\delta} = X_{k}^{\\delta} + \\frac{1}{2}\\Big(f\\big(X_{k}^{\\delta}\\big)+f\\big(X_{k+1}^{\\delta}\\big)\\Big) h + \\frac{1}{2}\\Big(g\\big(X_{k}^{\\delta}\\big)+g\\big(X_{k+1}^{\\delta}\\big)\\Big)\\,\\Delta W_{k}^{\\delta} $$\nwhere $X_k^\\delta = X_{t_k}^\\delta$ and $\\Delta W_k^\\delta = W_{t_{k+1}}^\\delta - W_{t_k}^\\delta$.\n- It is assumed that as $h \\to 0$, the scheme converges to the ODE solution, and as $\\delta \\to 0$, $W^\\delta \\to W$ and the solution $X^\\delta$ converges to a limit process $X$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is subjected to a critical review for validity.\n- **Scientifically Grounded:** The problem is a cornerstone topic in stochastic calculus, exploring the relationship between ODEs driven by smooth noise and stochastic differential equations (SDEs), a concept formalized by the Wong-Zakai theorem. The methodology proposed (analyzing a numerical scheme) is a standard technique to derive the connection between Stratonovich and Itō integrals. The mathematical objects (Brownian motion, mollifiers, Taylor expansions) and assumptions (smoothness and boundedness of derivatives for $f$ and $g$) are standard and appropriate for this context. The problem is fundamentally sound.\n- **Well-Posed:** The problem is clearly stated and asks for a specific, uniquely defined quantity: the drift correction term required to express a limiting Stratonovich SDE in Itō form. The givens and assumptions are sufficient to determine this term. The problem is well-posed.\n- **Objective:** The problem is formulated in precise, formal mathematical language, free from any subjectivity or ambiguity.\n\nThe problem does not exhibit any of the flaws listed in the validation criteria. It is a formal, self-contained, and scientifically valid mathematical problem.\n\n### Step 3: Verdict and Action\nThe problem is deemed **valid**. A full, reasoned solution will be provided.\n\n### Solution Derivation\nThe objective is to determine the drift correction term when the limiting process is described by an Itō SDE. The provided numerical scheme is a discretization of the underlying process. As per the Wong-Zakai theorem, the limit of the ODE driven by smoothed noise corresponds to a Stratonovich SDE. The trapezoidal rule is a numerical method known to converge to the Stratonovich integral. Our approach is to analyze the limiting behavior of the scheme as $h \\to 0$ and $\\delta \\to 0$. In the limit, the superscript $\\delta$ can be dropped. We will analyze the terms of the scheme to identify the Itō SDE that the solution $X$ satisfies.\n\nLet $\\Delta X_k = X_{k+1} - X_k$ and $\\Delta W_k = W_{t_{k+1}} - W_{t_k}$. The scheme is:\n$$ \\Delta X_k = \\frac{h}{2}\\left(f(X_k)+f(X_{k+1})\\right) + \\frac{1}{2}\\left(g(X_k)+g(X_{k+1})\\right)\\,\\Delta W_k $$\nWe analyze the contribution of each part of the sum $\\sum_k \\Delta X_k$ in the limit as $h \\to 0$.\n\nFirst, consider the drift term from the scheme:\n$$ \\sum_{k=0}^{n-1} \\frac{h}{2}\\left(f(X_k)+f(X_{k+1})\\right) $$\nAs $h \\to 0$, $X_{k+1} \\to X_k$ due to the continuity of the sample paths. Thus, $f(X_{k+1}) \\to f(X_k)$. The sum becomes a Riemann sum that converges to the standard integral of the drift:\n$$ \\lim_{h\\to 0} \\sum_{k=0}^{n-1} \\frac{h}{2}\\left(f(X_k)+f(X_{k+1})\\right) = \\lim_{h\\to 0} \\sum_{k=0}^{n-1} f(X_k)h = \\int_0^T f(X_t) dt $$\n\nNext, we analyze the noise term, which is a discrete approximation of a stochastic integral:\n$$ S_n = \\sum_{k=0}^{n-1} \\frac{1}{2}\\left(g(X_k)+g(X_{k+1})\\right)\\,\\Delta W_k $$\nTo understand its limit, we expand $g(X_{k+1})$ around $X_k$ using a Taylor series. Since $g \\in C^2$, we have:\n$$ g(X_{k+1}) = g(X_k + \\Delta X_k) = g(X_k) + g'(X_k)\\Delta X_k + O((\\Delta X_k)^2) $$\nwhere $g'(x) = \\frac{dg}{dx}(x)$.\nSubstituting this into the expression for $S_n$:\n$$ S_n = \\sum_{k=0}^{n-1} \\frac{1}{2}\\left(g(X_k) + g(X_k) + g'(X_k)\\Delta X_k + O((\\Delta X_k)^2)\\right)\\,\\Delta W_k $$\n$$ S_n = \\sum_{k=0}^{n-1} g(X_k)\\Delta W_k + \\sum_{k=0}^{n-1} \\frac{1}{2}g'(X_k)\\Delta X_k \\Delta W_k + \\sum_{k=0}^{n-1} O((\\Delta X_k)^2)\\Delta W_k $$\nThe first term, $\\sum g(X_k)\\Delta W_k$, is the standard discrete sum that defines the Itō integral in the limit $h \\to 0$:\n$$ \\lim_{h\\to 0} \\sum_{k=0}^{n-1} g(X_k)\\Delta W_k = \\int_0^T g(X_t) dW_t $$\nFor the second term, we need an expression for $\\Delta X_k$. The dominant part of $\\Delta X_k$ for small $h$ is given by the Euler-Maruyama approximation, derived from the leading terms of the SDE itself:\n$$ \\Delta X_k = f(X_k)h + g(X_k)\\Delta W_k + O(h) $$\nWe substitute this into the second term of $S_n$:\n$$ \\sum_{k=0}^{n-1} \\frac{1}{2}g'(X_k)\\Delta X_k \\Delta W_k \\approx \\sum_{k=0}^{n-1} \\frac{1}{2}g'(X_k) \\left( f(X_k)h + g(X_k)\\Delta W_k \\right) \\Delta W_k $$\n$$ = \\sum_{k=0}^{n-1} \\frac{1}{2} g(X_k)g'(X_k)(\\Delta W_k)^2 + \\sum_{k=0}^{n-1} \\frac{1}{2}f(X_k)g'(X_k)h \\Delta W_k $$\nWe now analyze the limit of these two sums.\nThe first sum involves $(\\Delta W_k)^2$. A fundamental property of Brownian motion is its quadratic variation, which states that $\\lim_{h \\to 0} \\sum_k (\\Delta W_k)^2 = T$. This sum is a Riemann-type sum that converges to a standard integral with respect to time:\n$$ \\lim_{h\\to 0} \\sum_{k=0}^{n-1} \\frac{1}{2} g(X_k)g'(X_k)(\\Delta W_k)^2 = \\int_0^T \\frac{1}{2} g(X_t)g'(X_t) dt $$\nThis integral is the source of the drift correction.\nThe second sum, $\\sum \\frac{1}{2}f(X_k)g'(X_k)h \\Delta W_k$, converges to zero in probability. The variance of this sum is proportional to $\\sum h^2 (\\Delta W_k)^2 \\approx \\sum h^2 h = h (T)$, which tends to $0$ as $h \\to 0$.\nThe final term in $S_n$, $\\sum O((\\Delta X_k)^2)\\Delta W_k$, also vanishes in the limit as it contains higher powers of $h$ and $\\Delta W_k$.\n\nCombining all the limiting contributions, the full process $X_T - X_0 = \\sum \\Delta X_k$ satisfies:\n$$ X_T - X_0 = \\int_0^T f(X_t)dt + \\int_0^T g(X_t)dW_t + \\int_0^T \\frac{1}{2}g(X_t)g'(X_t)dt $$\nWriting this in differential form gives the Itō SDE for the limit process $X_t$:\n$$ dX_t = f(X_t)dt + g(X_t)dW_t + \\frac{1}{2}g(X_t)g'(X_t)dt $$\nWe can group the $dt$ terms to identify the total drift of the Itō equation:\n$$ dX_t = \\left(f(X_t) + \\frac{1}{2}g(X_t)g'(X_t)\\right)dt + g(X_t)dW_t $$\nThe original drift in the problem formulation was $f(x)$. The resulting Itō SDE has a modified drift. The problem asks for the drift correction function $C(x)$ that is added to $f(x)$. By comparing the drift terms, we identify this correction.\nThe correction term is the part added to the original drift $f(x)$. Therefore, the drift correction function $C(x)$ is:\n$$ C(x) = \\frac{1}{2}g(x)g'(x) $$\nThis result is the well-known Itō-Stratonovich correction term (or Wong-Zakai correction term).", "answer": "$$\\boxed{\\frac{1}{2} g(x) g'(x)}$$", "id": "3004514"}, {"introduction": "The distinction between the Itô and Stratonovich integrals is not merely a theoretical subtlety; it arises directly from how one chooses to approximate the driving noise. This exercise solidifies this crucial concept by contrasting two different discrete approximations: a forward-step (left-point) scheme and a symmetric interpolation scheme [@problem_id:3004504]. By analyzing their limits, you will reinforce your understanding of how the non-anticipating nature of the Itô integral and the symmetric nature of the Stratonovich integral are direct consequences of the structure of their underlying approximations.", "problem": "Let $W = (W_t)_{t \\in [0,T]}$ be a one-dimensional standard Brownian motion on a filtered probability space $(\\Omega, \\mathcal{F}, (\\mathcal{F}_t)_{t \\in [0,T]}, \\mathbb{P})$ satisfying the usual conditions. Let $(\\pi^\\delta)_{\\delta > 0}$ be the sequence of uniform partitions of $[0,T]$ with mesh size $\\delta$, where $t_k^\\delta = k \\delta$ for $k = 0, 1, \\dots, \\lfloor T/\\delta \\rfloor$, and $t_{\\lfloor T/\\delta \\rfloor + 1}^\\delta = T$. Consider a function $f \\in C^2(\\mathbb{R})$ with at most polynomial growth, and define two pathwise approximations to $W$:\n\n- The forward Euler step approximation $W^\\delta$ defined by $W^\\delta(t) = W(t_k^\\delta)$ for $t \\in [t_k^\\delta, t_{k+1}^\\delta)$, with $W^\\delta(T) = W(T)$.\n\n- The symmetric piecewise linear interpolation $\\widetilde{W}^\\delta$ defined by $\\widetilde{W}^\\delta(t) = W(t_k^\\delta) + \\frac{t - t_k^\\delta}{t_{k+1}^\\delta - t_k^\\delta}\\bigl(W(t_{k+1}^\\delta) - W(t_k^\\delta)\\bigr)$ for $t \\in [t_k^\\delta, t_{k+1}^\\delta]$.\n\nFor the forward step approximation $W^\\delta$, the Lebesgue–Stieltjes integral $\\int_0^T f(W^\\delta(t)) \\, dW^\\delta(t)$ reduces to the jump sum $\\sum_{k} f(W(t_k^\\delta)) \\bigl(W(t_{k+1}^\\delta) - W(t_k^\\delta)\\bigr)$ because $W^\\delta$ is of bounded variation with jumps only at the grid points. For the symmetric interpolation $\\widetilde{W}^\\delta$, consider the symmetric Riemann sum $\\sum_k \\frac{f(W(t_k^\\delta)) + f(W(t_{k+1}^\\delta))}{2} \\bigl(W(t_{k+1}^\\delta) - W(t_k^\\delta)\\bigr)$ as an approximation to a stochastic integral.\n\nAdditionally, for a state process $X^\\delta$ driven by a smooth signal, consider the deterministic ordinary differential equation (ODE) $dX^\\delta_t = b(X^\\delta_t) \\, dt + \\sigma(X^\\delta_t) \\, \\dot{\\widetilde{W}}^\\delta_t \\, dt$ with $X^\\delta_0 = x_0$, where $b, \\sigma \\in C^2(\\mathbb{R})$ have at most polynomial growth and $\\dot{\\widetilde{W}}^\\delta_t$ denotes the classical time derivative of $\\widetilde{W}^\\delta$ on each subinterval.\n\nUsing only the foundational definitions of the Itô integral (as the $L^2$ limit of stochastic integrals of simple, predictable processes), the Stratonovich integral (as the limit of symmetric Riemann sums satisfying the classical chain rule), and the quadratic variation of Brownian motion (the limit of discrete quadratic variations equals $t$), select all correct statements about the limiting behavior as $\\delta \\to 0$:\n\nA. For $W^\\delta$, the integral $\\int_0^T f(W^\\delta(t)) \\, dW^\\delta(t) = \\sum_k f(W(t_k^\\delta)) \\bigl(W(t_{k+1}^\\delta) - W(t_k^\\delta)\\bigr)$ converges in $L^2$ to the Itô integral $\\int_0^T f(W_t) \\, dW_t$.\n\nB. For $\\widetilde{W}^\\delta$, the symmetric sum $\\sum_k \\frac{f(W(t_k^\\delta)) + f(W(t_{k+1}^\\delta))}{2} \\bigl(W(t_{k+1}^\\delta) - W(t_k^\\delta)\\bigr)$ converges in probability to the Stratonovich integral $\\int_0^T f(W_t) \\circ dW_t$, and one has $\\int_0^T f(W_t) \\circ dW_t = \\int_0^T f(W_t) \\, dW_t + \\frac{1}{2} \\int_0^T f'(W_t) \\, dt$.\n\nC. For the ODE driven by $\\dot{\\widetilde{W}}^\\delta$, the Wong–Zakai limit is the Itô stochastic differential equation (SDE) $dX_t = b(X_t) \\, dt + \\sigma(X_t) \\, dW_t$ without any correction; a drift correction must be added subsequently to rewrite it in Stratonovich form.\n\nD. For $W^\\delta$, the limiting integral is the Stratonovich integral because the quadratic variation vanishes for piecewise constant approximations and hence the classical Riemann–Stieltjes theory applies.\n\nE. In both approximations, the classical chain rule holds without any correction term in the limit because the approximating paths are either of bounded variation or smooth on each mesh interval.\n\nChoose all that apply.", "solution": "The problem statement poses a series of questions regarding the convergence of discrete approximations to stochastic integrals and the solutions of ordinary differential equations driven by approximations of Brownian motion. We must validate the problem statement before proceeding.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n- $W = (W_t)_{t \\in [0,T]}$: a one-dimensional standard Brownian motion.\n- Filtered probability space $(\\Omega, \\mathcal{F}, (\\mathcal{F}_t)_{t \\in [0,T]}, \\mathbb{P})$ satisfying the usual conditions.\n- $(\\pi^\\delta)_{\\delta > 0}$: sequence of uniform partitions of $[0,T]$ with mesh size $\\delta$.\n- $t_k^\\delta = k \\delta$ for $k = 0, 1, \\dots, \\lfloor T/\\delta \\rfloor$, and $t_{\\lfloor T/\\delta \\rfloor + 1}^\\delta = T$.\n- $f \\in C^2(\\mathbb{R})$ with at most polynomial growth.\n- Forward Euler step approximation $W^\\delta$: $W^\\delta(t) = W(t_k^\\delta)$ for $t \\in [t_k^\\delta, t_{k+1}^\\delta)$, with $W^\\delta(T) = W(T)$.\n- Symmetric piecewise linear interpolation $\\widetilde{W}^\\delta$: $\\widetilde{W}^\\delta(t) = W(t_k^\\delta) + \\frac{t - t_k^\\delta}{t_{k+1}^\\delta - t_k^\\delta}\\bigl(W(t_{k+1}^\\delta) - W(t_k^\\delta)\\bigr)$ for $t \\in [t_k^\\delta, t_{k+1}^\\delta]$.\n- Integral for $W^\\delta$: $\\int_0^T f(W^\\delta(t)) \\, dW^\\delta(t) = \\sum_{k} f(W(t_k^\\delta)) \\bigl(W(t_{k+1}^\\delta) - W(t_k^\\delta)\\bigr)$.\n- Symmetric sum for $\\widetilde{W}^\\delta$: $\\sum_k \\frac{f(W(t_k^\\delta)) + f(W(t_{k+1}^\\delta))}{2} \\bigl(W(t_{k+1}^\\delta) - W(t_k^\\delta)\\bigr)$.\n- ODE: $dX^\\delta_t = b(X^\\delta_t) \\, dt + \\sigma(X^\\delta_t) \\, \\dot{\\widetilde{W}}^\\delta_t \\, dt$ with $X^\\delta_0 = x_0$, where $b, \\sigma \\in C^2(\\mathbb{R})$ have at most polynomial growth.\n- $\\dot{\\widetilde{W}}^\\delta_t$ is the classical time derivative of $\\widetilde{W}^\\delta$.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is well-defined within the mathematical discipline of stochastic calculus.\n- **Scientifically Grounded:** The concepts of Brownian motion, Itô and Stratonovich integrals, pathwise approximations, and the Wong-Zakai theorem are all cornerstones of stochastic analysis. The problem is firmly grounded in established mathematical theory.\n- **Well-Posed:** The question asks to evaluate the truth of several statements about well-known limiting behaviors. The assumptions on the functions $f, b, \\sigma$ ($C^2$ with polynomial growth) are standard and sufficient to ensure the existence and uniqueness of the stochastic processes and integrals involved.\n- **Objective:** The language is formal and mathematical, devoid of subjectivity or ambiguity.\n- **Incomplete or Contradictory Setup:** The problem provides all necessary definitions and conditions. The descriptions of the approximations and sums are explicit and standard. There are no contradictions.\n\n**Step 3: Verdict and Action**\nThe problem statement is valid. It presents a standard examination of fundamental concepts in stochastic integration theory. We may proceed with the analysis of the options.\n\n### Solution and Option Analysis\n\nLet $\\Delta W_k^\\delta = W(t_{k+1}^\\delta) - W(t_k^\\delta)$. The problem asks us to analyze the limiting behavior of several sums and a differential equation as $\\delta \\to 0$.\n\n**Analysis of Option A**\n\nThis option concerns the sum $S_A^\\delta = \\sum_k f(W(t_k^\\delta)) \\Delta W_k^\\delta$. This is a Riemann-type sum for the stochastic integral $\\int_0^T f(W_t) \\, dW_t$. The crucial feature of this sum is that the integrand $f(W(t_k^\\delta))$ is evaluated at the left endpoint of the time interval $[t_k^\\delta, t_{k+1}^\\delta]$.\n\nThe Itô integral $\\int_0^T H_t \\, dW_t$ of an adapted process $H_t$ is defined as the limit in $L^2(\\Omega)$ of the sums $\\sum_k H_{t_k} (W_{t_{k+1}} - W_{t_k})$ as the mesh of the partition tends to zero. The process $H_t = f(W_t)$ is adapted to the filtration $(\\mathcal{F}_t)$ generated by $W_t$. The choice of the left endpoint $t_k^\\delta$ ensures that the integrand $f(W(t_k^\\delta))$ is $\\mathcal{F}_{t_k^\\delta}$-measurable, which is the discrete analogue of the non-anticipating (predictable) property required for the Itô integrand.\n\nGiven that $f \\in C^2$ with polynomial growth, the process $f(W_t)$ is Itô-integrable. The sum presented in option A is precisely the standard approximating sum used in the construction of the Itô integral. Therefore, by the very definition of the Itô integral, this sum converges in $L^2$ to $\\int_0^T f(W_t) \\, dW_t$.\n\nTherefore, option A is **Correct**.\n\n**Analysis of Option B**\n\nThis option concerns the symmetric sum $S_B^\\delta = \\sum_k \\frac{f(W(t_k^\\delta)) + f(W(t_{k+1}^\\delta))}{2} \\Delta W_k^\\delta$. This sum is an approximation where the integrand is evaluated at the midpoint of the interval in a functional sense, and it is the defining approximation for the Stratonovich integral. The Stratonovich integral $\\int_0^T f(W_t) \\circ dW_t$ is defined as the limit in probability of these symmetric sums. The first part of the statement is therefore correct by definition.\n\nThe second part of the statement provides the conversion formula between the Stratonovich and Itô integrals:\n$$ \\int_0^T f(W_t) \\circ dW_t = \\int_0^T f(W_t) \\, dW_t + \\frac{1}{2} \\int_0^T f'(W_t) \\, dt $$\nThis is a standard and fundamental result in stochastic calculus. It arises from the non-zero quadratic variation of Brownian motion. We can verify it using Itô's formula. Let $F$ be an antiderivative of $f$, i.e., $F' = f$.\nBy Itô's formula:\n$$ dF(W_t) = F'(W_t) \\, dW_t + \\frac{1}{2} F''(W_t) \\, dt = f(W_t) \\, dW_t + \\frac{1}{2} f'(W_t) \\, dt $$\nIntegrating from $0$ to $T$ gives:\n$$ F(W_T) - F(W_0) = \\int_0^T f(W_t) \\, dW_t + \\frac{1}{2} \\int_0^T f'(W_t) \\, dt $$\nThe Stratonovich integral, by contrast, obeys the classical chain rule:\n$$ \\int_0^T f(W_t) \\circ dW_t = \\int_0^T F'(W_t) \\circ dW_t = F(W_T) - F(W_0) $$\nEquating the two expressions for $F(W_T) - F(W_0)$ gives:\n$$ \\int_0^T f(W_t) \\circ dW_t = \\int_0^T f(W_t) \\, dW_t + \\frac{1}{2} \\int_0^T f'(W_t) \\, dt $$\nThe formula is correct. The conditions $f \\in C^2$ are sufficient for this to hold.\n\nTherefore, option B is **Correct**.\n\n**Analysis of Option C**\n\nThis option invokes the Wong-Zakai theorem, which describes the limit of solutions to ordinary differential equations driven by \"smooth\" approximations of a rough noise process. The given ODE is $dX^\\delta_t = b(X^\\delta_t) \\, dt + \\sigma(X^\\delta_t) \\, \\dot{\\widetilde{W}}^\\delta_t \\, dt$. The driving noise approximation is $\\widetilde{W}^\\delta$, the piecewise linear interpolation of Brownian motion. This is a standard example of an approximation for which the Wong-Zakai theorem applies.\n\nThe theorem states that as $\\delta \\to 0$, the solution $X^\\delta_t$ converges to the solution $X_t$ of a *Stratonovich* stochastic differential equation:\n$$ dX_t = b(X_t) \\, dt + \\sigma(X_t) \\circ dW_t $$\nOption C claims that the limit is the Itô SDE $dX_t = b(X_t) \\, dt + \\sigma(X_t) \\, dW_t$ \"without any correction\". This is incorrect. The natural limit is the Stratonovich SDE.\n\nTo express this limit in the Itô form, we must apply the Itô-Stratonovich conversion formula for SDEs. The term $\\sigma(X_t) \\circ dW_t$ becomes $\\sigma(X_t) \\, dW_t + \\frac{1}{2} \\sigma'(X_t) \\sigma(X_t) \\, dt$. The corresponding Itô SDE is:\n$$ dX_t = \\left( b(X_t) + \\frac{1}{2} \\sigma(X_t) \\sigma'(X_t) \\right) dt + \\sigma(X_t) \\, dW_t $$\nThe term $\\frac{1}{2} \\sigma(X_t) \\sigma'(X_t)$ is the crucial \"Wong-Zakai correction term\" or \"Itô-Stratonovich drift correction\". The statement in C explicitly denies the presence of this correction in the limiting Itô SDE. Furthermore, it incorrectly suggests a correction is needed to go *to* Stratonovich form, when the correction is needed to go *from* the natural Stratonovich limit *to* the Itô form.\n\nTherefore, option C is **Incorrect**.\n\n**Analysis of Option D**\n\nThis option claims that the limit of the sum from option A, $\\sum_k f(W(t_k^\\delta)) \\Delta W_k^\\delta$, is the Stratonovich integral. As established in the analysis of option A, this limit is the Itô integral. The conclusion is false.\n\nLet's examine the provided reasoning: \"because the quadratic variation vanishes for piecewise constant approximations\". The quadratic variation of the approximating process $W^\\delta$ over $[0,T]$ is given by the sum of its squared jumps:\n$$ [W^\\delta, W^\\delta]_T = \\sum_k (W^\\delta(t_k^\\delta) - W^\\delta(t_{k-1}^\\delta))^2 = \\sum_k (W(t_k^\\delta) - W(t_{k-1}^\\delta))^2 $$\nThis is the discrete quadratic variation sum for the Brownian motion $W$ itself. It is a fundamental property of Brownian motion that as $\\delta \\to 0$, this sum converges in probability to $T$.\n$$ \\lim_{\\delta \\to 0} \\sum_k (W(t_k^\\delta) - W(t_{k-1}^\\delta))^2 = [W,W]_T = T $$\nThe quadratic variation of the approximating sequence does not vanish; it converges to the quadratic variation of the limit process, which is non-zero. Since the limit process $W_t$ does not have zero quadratic variation (in fact, it is nowhere differentiable and of unbounded variation), classical Riemann-Stieltjes theory does not apply. The reasoning is fundamentally flawed and based on a false premise.\n\nTherefore, option D is **Incorrect**.\n\n**Analysis of Option E**\n\nThis option states that for *both* approximations, the classical chain rule holds in the limit without a correction term. The classical chain rule for a function $F(x)$ would state $dF(W_t) = F'(W_t) \\, dW_t$.\n\nFor the first approximation (left-endpoint sum), the limit is the Itô integral. The change-of-variable formula is Itô's formula: $dF(W_t) = F'(W_t) \\, dW_t + \\frac{1}{2} F''(W_t) \\, dt$. This contains the correction term $\\frac{1}{2} F''(W_t) \\, dt$. Thus, the classical chain rule does *not* hold for the Itô calculus.\n\nFor the second approximation (symmetric sum), the limit is the Stratonovich integral. A key property of the Stratonovich integral is that it *does* obey the classical chain rule: $dF(W_t) = F'(W_t) \\circ dW_t$.\n\nSince the statement asserts that the classical chain rule holds for the limiting behavior of *both* approximations, and it fails for the first (Itô) case, the statement as a whole is false. The reasoning provided, that the approximating paths have nice properties (bounded variation), is true for any fixed $\\delta > 0$. However, these properties are lost in the limit as $\\delta \\to 0$, as the limit process $W_t$ is of unbounded variation. The non-trivial limiting behavior is precisely the subject of stochastic calculus. The statement improperly extrapolates properties from the pre-limit to the limit.\n\nTherefore, option E is **Incorrect**.", "answer": "$$\\boxed{AB}$$", "id": "3004504"}]}