{"hands_on_practices": [{"introduction": "The Zakai equation describes the evolution of the unnormalized conditional density as a stochastic partial differential equation (SPDE). At its core, the deterministic dynamics are driven by the formal adjoint of the signal's infinitesimal generator, an operator often called the Fokker-Planck operator. This first practice focuses on deriving this crucial operator, $\\mathcal{L}^*$, from first principles, providing a solid foundation for understanding the structure of the Zakai equation. [@problem_id:3004789]", "problem": "Consider a $d$-dimensional Itô Stochastic Differential Equation (SDE) on $\\mathbb{R}^{d}$ of the form\n$$\n\\mathrm{d}X_{t} \\;=\\; b(X_{t})\\,\\mathrm{d}t \\;+\\; \\sigma(X_{t})\\,\\mathrm{d}W_{t},\n$$\nwhere $W_{t}$ is an $r$-dimensional standard Brownian motion, $b:\\mathbb{R}^{d}\\to\\mathbb{R}^{d}$ is a smooth drift field, and $\\sigma:\\mathbb{R}^{d}\\to\\mathbb{R}^{d\\times r}$ is a smooth, state-dependent diffusion matrix. Set $a(x) \\coloneqq \\sigma(x)\\sigma(x)^{\\top}\\in\\mathbb{R}^{d\\times d}$, and assume $a(x)$ is uniformly elliptic and twice continuously differentiable. Let $\\mathcal{L}$ denote the infinitesimal generator associated with this SDE acting on smooth, compactly supported test functions $f\\in C_{c}^{\\infty}(\\mathbb{R}^{d})$, and let $\\mathcal{L}^{*}$ denote the formal adjoint of $\\mathcal{L}$ with respect to the Lebesgue inner product on $L^{2}(\\mathbb{R}^{d})$. In the context of the Zakai equation for unnormalized filtering, $\\mathcal{L}^{*}$ is the drift operator driving the evolution of the unnormalized conditional density.\n\nStarting from the definition of the infinitesimal generator and the Lebesgue inner product, derive the explicit expression for the formal adjoint $\\mathcal{L}^{*}$ acting on a smooth test function $g\\in C_{c}^{\\infty}(\\mathbb{R}^{d})$. State clearly any integration by parts and boundary decay assumptions used.\n\nThen, restrict to the special case in which the drift is of gradient type adapted to a state-dependent diffusion, namely\n$$\nb(x) \\;=\\; \\tfrac{1}{2}\\,\\nabla\\!\\cdot a(x) \\;-\\; a(x)\\,\\nabla U(x),\n$$\nfor a smooth potential $U:\\mathbb{R}^{d}\\to\\mathbb{R}$, where $\\nabla\\!\\cdot a$ is the vector field whose $j$-th component is $\\sum_{i=1}^{d}\\partial_{i}a_{ij}$. Define the weight\n$$\n\\pi(x) \\;\\propto\\; \\exp\\!\\big(-2\\,U(x)\\big),\n$$\nand the weighted inner product $\\langle f,g\\rangle_{\\pi} \\coloneqq \\int_{\\mathbb{R}^{d}} f(x)\\,g(x)\\,\\pi(x)\\,\\mathrm{d}x$ on $L^{2}(\\pi)$. Confirm, by a direct calculation from first principles, that in this special case the generator $\\mathcal{L}$ is self-adjoint with respect to $\\langle\\cdot,\\cdot\\rangle_{\\pi}$.\n\nExpress your final answer as a single closed-form analytical expression for $\\mathcal{L}^{*}g(x)$ in terms of $b(x)$, $a(x)$, and their derivatives. No numerical approximation is required. If you introduce any additional symbols, define them explicitly. Assume all functions and their derivatives decay sufficiently rapidly at infinity to justify all integrations by parts and the exchange of differentiation and integration.", "solution": "The solution consists of two parts. First, we derive the formal adjoint $\\mathcal{L}^*$. Second, we confirm the self-adjointness of the generator $\\mathcal{L}$ in a special case.\n\n**Part 1: Derivation of the Formal Adjoint $\\mathcal{L}^{*}$**\n\nThe infinitesimal generator $\\mathcal{L}$ associated with the SDE, acting on a test function $f\\in C_{c}^{\\infty}(\\mathbb{R}^{d})$, is given by Itô's formula:\n$$\n\\mathcal{L}f(x) = \\sum_{i=1}^{d} b_i(x) \\frac{\\partial f}{\\partial x_i}(x) + \\frac{1}{2} \\sum_{i,j=1}^{d} a_{ij}(x) \\frac{\\partial^2 f}{\\partial x_i \\partial x_j}(x)\n$$\nThe formal adjoint $\\mathcal{L}^*$ with respect to the Lebesgue inner product $\\langle f, g \\rangle = \\int_{\\mathbb{R}^d} f(x)g(x)\\,\\mathrm{d}x$ is defined by the relation $\\langle \\mathcal{L}f, g \\rangle = \\langle f, \\mathcal{L}^*g \\rangle$ for all $f, g \\in C_c^{\\infty}(\\mathbb{R}^d)$.\n\nWe start with the left-hand side and integrate by parts. For the drift term, we integrate by parts with respect to each component $i$:\n$$\n\\int_{\\mathbb{R}^d} \\left( \\sum_{i=1}^{d} b_i(x) \\frac{\\partial f}{\\partial x_i}(x) \\right) g(x) \\,\\mathrm{d}x = -\\int_{\\mathbb{R}^d} f(x) \\left( \\sum_{i=1}^{d} \\frac{\\partial}{\\partial x_i}(b_i(x)g(x)) \\right) \\,\\mathrm{d}x\n$$\nFor the diffusion term, we integrate by parts twice (first with respect to $x_j$, then $x_i$):\n$$\n\\frac{1}{2} \\sum_{i,j=1}^{d} \\int_{\\mathbb{R}^d} a_{ij}(x) g(x) \\frac{\\partial^2 f}{\\partial x_i \\partial x_j}(x) \\,\\mathrm{d}x = \\int_{\\mathbb{R}^d} f(x) \\left( \\frac{1}{2} \\sum_{i,j=1}^{d} \\frac{\\partial^2}{\\partial x_i \\partial x_j} (a_{ij}(x)g(x)) \\right) \\,\\mathrm{d}x\n$$\nIn both steps, boundary terms at infinity vanish because the test functions $f$ and $g$ have compact support. Combining the results, we have:\n$$\n\\langle \\mathcal{L}f, g \\rangle = \\int_{\\mathbb{R}^d} f(x) \\left[ \\frac{1}{2} \\sum_{i,j=1}^{d} \\frac{\\partial^2}{\\partial x_i \\partial x_j} (a_{ij}(x)g(x)) - \\sum_{i=1}^{d} \\frac{\\partial}{\\partial x_i} (b_i(x)g(x)) \\right] \\,\\mathrm{d}x\n$$\nBy the definition of the adjoint, the expression in the square brackets is $\\mathcal{L}^*g(x)$. This is the Fokker-Planck operator. The final expression is asked for in the boxed answer.\n\n**Part 2: Confirmation of Self-Adjointness**\n\nWe are asked to confirm that for the special case $b(x) = \\frac{1}{2}\\,\\nabla\\!\\cdot a(x) - a(x)\\,\\nabla U(x)$ and weight $\\pi(x) \\propto \\exp(-2U(x))$, the operator $\\mathcal{L}$ is self-adjoint with respect to the weighted inner product $\\langle f,g\\rangle_{\\pi}$. This means we must show $\\langle \\mathcal{L}f, g \\rangle_{\\pi} = \\langle f, \\mathcal{L}g \\rangle_{\\pi}$.\n\nA well-known result states that an operator of the form $\\mathcal{A}f = \\frac{1}{\\pi} \\nabla \\cdot (\\pi D \\nabla f)$ is self-adjoint with respect to $\\langle \\cdot, \\cdot \\rangle_{\\pi}$ if $D$ is a symmetric matrix-valued function. We will show that our given $\\mathcal{L}$ is precisely of this form with $D(x)=\\frac{1}{2}a(x)$. Let's expand this symmetric operator form $\\mathcal{L}_{sym}f = \\frac{1}{2\\pi} \\nabla \\cdot (\\pi a \\nabla f)$:\n$$\n\\mathcal{L}_{sym}f = \\frac{1}{2} \\sum_{i,j=1}^{d} a_{ij} \\left(\\frac{1}{\\pi}\\frac{\\partial \\pi}{\\partial x_i}\\right) \\frac{\\partial f}{\\partial x_j} + \\frac{1}{2} \\sum_{i,j=1}^{d} \\frac{\\partial a_{ij}}{\\partial x_i} \\frac{\\partial f}{\\partial x_j} + \\frac{1}{2} \\sum_{i,j=1}^{d} a_{ij} \\frac{\\partial^2 f}{\\partial x_i \\partial x_j}\n$$\nThe last term is the diffusion part of $\\mathcal{L}f$. The first two terms form the drift part. The drift coefficient for $\\frac{\\partial f}{\\partial x_j}$ is:\n$$\n\\sum_{j=1}^{d} \\left[ \\frac{1}{2} \\sum_{i=1}^{d} a_{ij} \\left(\\frac{\\partial_i \\pi}{\\pi}\\right) + \\frac{1}{2} \\sum_{i=1}^{d} \\partial_i a_{ij} \\right]\n$$\nFrom the definition $\\pi(x) \\propto \\exp(-2U(x))$, we have $\\frac{1}{\\pi}\\frac{\\partial \\pi}{\\partial x_i} = -2\\frac{\\partial U}{\\partial x_i}$. Substituting this in, and using the problem's definition $(\\nabla \\cdot a)_j = \\sum_{i=1}^{d} \\partial_i a_{ij}$, the drift coefficient for $\\partial_j f$ is:\n$$\n\\frac{1}{2} \\sum_{i=1}^{d} a_{ij} (-2 \\partial_i U) + \\frac{1}{2} (\\nabla \\cdot a)_j = -\\sum_{i=1}^{d} a_{ji} (\\partial_i U) + \\frac{1}{2} (\\nabla \\cdot a)_j = -(a \\nabla U)_j + \\frac{1}{2}(\\nabla \\cdot a)_j\n$$\nThis is precisely the $j$-th component of $b(x) = \\frac{1}{2}\\nabla \\cdot a(x) - a(x)\\nabla U(x)$. Thus, we have shown that for the special case, the generator $\\mathcal{L}$ is identical to the symmetric form operator $\\mathcal{L}_{sym}$.\n\nTo complete the direct calculation, we confirm this form is self-adjoint:\n$$\n\\langle \\mathcal{L}f, g \\rangle_{\\pi} = \\int_{\\mathbb{R}^d} (\\mathcal{L}f)(x) g(x) \\pi(x) \\,\\mathrm{d}x = \\int_{\\mathbb{R}^d} \\left(\\frac{1}{2\\pi} \\nabla \\cdot (\\pi a \\nabla f)\\right) g \\pi \\,\\mathrm{d}x = \\frac{1}{2} \\int_{\\mathbb{R}^d} g \\nabla \\cdot (\\pi a \\nabla f) \\,\\mathrm{d}x\n$$\nUsing integration by parts:\n$$\n\\langle \\mathcal{L}f, g \\rangle_{\\pi} = -\\frac{1}{2} \\int_{\\mathbb{R}^d} \\nabla g \\cdot (\\pi a \\nabla f) \\,\\mathrm{d}x = -\\frac{1}{2} \\int_{\\mathbb{R}^d} \\pi(x) (\\nabla g)^{\\top} a(x) (\\nabla f) \\,\\mathrm{d}x\n$$\nSince $a(x)$ is a symmetric matrix, $(\\nabla g)^{\\top} a (\\nabla f) = (\\nabla f)^{\\top} a (\\nabla g)$. Thus, we can swap $f$ and $g$ and reverse the integration by parts to obtain $\\langle f, \\mathcal{L}g \\rangle_{\\pi}$, confirming self-adjointness.", "answer": "$$\n\\boxed{\\frac{1}{2} \\sum_{i,j=1}^{d} \\frac{\\partial^2}{\\partial x_i \\partial x_j} (a_{ij}(x) g(x)) - \\sum_{i=1}^{d} \\frac{\\partial}{\\partial x_i} (b_i(x) g(x))}\n$$", "id": "3004789"}, {"introduction": "A central challenge in nonlinear filtering is that the conditional density, even if it starts in a simple parametric family like Gaussians, generally does not remain in that family over time. This exercise provides a concrete demonstration of this principle, explaining why the filtering problem is fundamentally infinite-dimensional. By examining the short-time behavior of the density under a nonlinear drift, you will see firsthand how complexity grows, motivating the SPDE framework of the Zakai equation. [@problem_id:3004801]", "problem": "Consider a one-dimensional signal-observation model on a fixed filtered probability space supporting two independent standard Brownian motions. The signal process $X_t \\in \\mathbb{R}$ satisfies the Stochastic Differential Equation (SDE) $dX_t = a(X_t)\\,dt + \\sigma\\,dW_t$, and the observation process $Y_t \\in \\mathbb{R}$ satisfies $dY_t = h(X_t)\\,dt + dV_t$, where $W_t$ and $V_t$ are independent standard Brownian motions, $a:\\mathbb{R}\\to\\mathbb{R}$ is the drift, $h:\\mathbb{R}\\to\\mathbb{R}$ is the observation function, and $\\sigma0$ is a constant diffusion coefficient. The unnormalized conditional density $\\pi_t(x)$ of $X_t$ given observations evolves according to the Zakai measure-valued stochastic differential equation, whose deterministic drift involves the adjoint of the signal generator. Assume $a(x)=x^3$ and $h(x)=x^2$. Let the initial unnormalized density be $\\pi_0(x)=\\exp(-\\alpha x^2)$ with $\\alpha0$.\n\nStarting from the definition of the adjoint signal generator acting on densities, and using first principles from Itô calculus and the theory of linear operators on function spaces, analyze the short-time expansion of $\\pi_t(x)$ around $t=0$. Focus on the deterministic component generated by the adjoint operator, and ignore the stochastic observation term driven by $dY_t$ for this calculation. In particular, consider the second-order term in the Dyson-type expansion of the deterministic semigroup, which involves $(\\mathcal{L}^*)^2\\pi_0$, where $\\mathcal{L}^*$ denotes the adjoint generator acting on densities.\n\nCompute the coefficient multiplying $x^6\\exp(-\\alpha x^2)$ in $(\\mathcal{L}^*)^2\\pi_0(x)$ as an explicit analytic expression in $\\alpha$ and $\\sigma$. Your final answer must be a single closed-form expression. Express the answer without units.", "solution": "The signal SDE is $dX_t = a(X_t)\\,dt + \\sigma\\,dW_t$ with $a(x)=x^3$. The adjoint of the signal generator acting on densities $u:\\mathbb{R}\\to\\mathbb{R}$ is given by\n$$\n\\mathcal{L}^* u(x) \\;=\\; -\\partial_x\\!\\big(a(x)\\,u(x)\\big) \\;+\\; \\frac{1}{2}\\sigma^2\\,\\partial_{xx}u(x).\n$$\nWe consider the deterministic part of the Zakai evolution (the drift generated by $\\mathcal{L}^*$) and ignore the stochastic term involving $dY_t$ to isolate the mechanism by which nonlinear drift destroys finite-dimensional closure. The short-time expansion of the deterministic flow applied to $\\pi_0$ reads\n$$\n\\pi_t \\;=\\; \\pi_0 \\;+\\; t\\,\\mathcal{L}^*\\pi_0 \\;+\\; \\frac{t^2}{2}\\,(\\mathcal{L}^*)^2\\pi_0 \\;+\\; \\cdots,\n$$\nso the appearance of higher-degree polynomial factors in $(\\mathcal{L}^*)^2\\pi_0$ signals the growth of functional complexity.\n\nLet $g(x)=\\exp(-\\alpha x^2)$ with $\\alpha0$. We will compute $(\\mathcal{L}^*)^2 g$ and extract the coefficient in front of $x^6 g(x)$.\n\nFirst, compute $\\mathcal{L}^* g$. We have\n$$\ng'(x) = -2\\alpha x\\,g(x),\\qquad g''(x) = \\big(-2\\alpha + 4\\alpha^2 x^2\\big)\\,g(x).\n$$\nWith $a(x)=x^3$, we find\n\\begin{align*}\n\\partial_x\\!\\big(a(x)g(x)\\big) = \\partial_x\\!\\big(x^3 g(x)\\big) \\;=\\; 3x^2 g(x) + x^3 g'(x) \\\\\n= 3x^2 g(x) + x^3\\big(-2\\alpha x g(x)\\big) \\;=\\; 3x^2 g(x) - 2\\alpha x^4 g(x).\n\\end{align*}\nTherefore,\n\\begin{align*}\n\\mathcal{L}^* g(x)\n= -\\partial_x\\!\\big(x^3 g(x)\\big) + \\frac{1}{2}\\sigma^2 g''(x) \\\\\n= \\big(-3x^2 + 2\\alpha x^4\\big)g(x) + \\frac{1}{2}\\sigma^2\\big(-2\\alpha + 4\\alpha^2 x^2\\big)g(x) \\\\\n= \\Big(-\\alpha\\sigma^2 + \\big(-3 + 2\\alpha^2\\sigma^2\\big)x^2 + 2\\alpha x^4\\Big)\\,g(x).\n\\end{align*}\nDefine the polynomial\n$$\np(x) \\;=\\; c_0 + c_2 x^2 + c_4 x^4\n\\quad\\text{with}\\quad\nc_0 = -\\alpha\\sigma^2,\\;\\; c_2 = -3 + 2\\alpha^2\\sigma^2,\\;\\; c_4 = 2\\alpha,\n$$\nso that $\\mathcal{L}^* g = p(x)\\,g(x)$.\n\nNext, compute $\\mathcal{L}^*\\big(p(x)g(x)\\big)$. We use the identities\n\\begin{align*}\n\\partial_x\\big(p g\\big) = p'(x) g(x) + p(x) g'(x) \\;=\\; \\big(p'(x) - 2\\alpha x p(x)\\big) g(x), \\\\\n\\partial_{xx}\\big(p g\\big) = \\big(p''(x) - 4\\alpha x p'(x) - 2\\alpha p(x) + 4\\alpha^2 x^2 p(x)\\big)\\,g(x),\n\\end{align*}\nand\n$$\n\\partial_x\\!\\big(x^3 p g\\big) \\;=\\; \\big(3x^2 p(x) + x^3 p'(x) - 2\\alpha x^4 p(x)\\big)\\,g(x).\n$$\nConsequently,\n\\begin{align*}\n\\mathcal{L}^*\\!\\big(p g\\big)\n= -\\partial_x\\!\\big(x^3 p g\\big) + \\frac{1}{2}\\sigma^2\\,\\partial_{xx}\\!\\big(p g\\big) \\\\\n= \\Big[-3x^2 p(x) - x^3 p'(x) + 2\\alpha x^4 p(x) \\\\\n\\qquad\\quad + \\frac{1}{2}\\sigma^2\\big(p''(x) - 4\\alpha x p'(x) - 2\\alpha p(x) + 4\\alpha^2 x^2 p(x)\\big)\\Big]\\,g(x).\n\\end{align*}\nWe need only the coefficient multiplying $x^6 g(x)$. Compute derivatives of $p$:\n$$\np'(x) = 2c_2 x + 4c_4 x^3,\\qquad p''(x) = 2c_2 + 12c_4 x^2.\n$$\nNow collect the $x^6$ contributions term by term:\n\n- From $-3x^2 p(x)$: the $x^6$ term is $-3 c_4 x^6$.\n\n- From $-x^3 p'(x)$: the $x^6$ term is $-4 c_4 x^6$.\n\n- From $2\\alpha x^4 p(x)$: the $x^6$ term is $2\\alpha c_2 x^6$.\n\n- From $\\frac{1}{2}\\sigma^2 p''(x)$: no $x^6$ term.\n\n- From $\\frac{1}{2}\\sigma^2\\big(-4\\alpha x p'(x)\\big)$: no $x^6$ term.\n\n- From $\\frac{1}{2}\\sigma^2\\big(-2\\alpha p(x)\\big)$: no $x^6$ term.\n\n- From $\\frac{1}{2}\\sigma^2\\big(4\\alpha^2 x^2 p(x)\\big)$: the $x^6$ term is $2\\alpha^2\\sigma^2 c_4 x^6$.\n\nTherefore, the coefficient in front of $x^6 g(x)$ in $(\\mathcal{L}^*)^2 g(x) = \\mathcal{L}^*\\big(p g\\big)$ is\n\\begin{align*}\nC_6\n= -3 c_4 \\;-\\; 4 c_4 \\;+\\; 2\\alpha c_2 \\;+\\; 2\\alpha^2\\sigma^2 c_4 \\\\\n= -7 c_4 \\;+\\; 2\\alpha c_2 \\;+\\; 2\\alpha^2\\sigma^2 c_4.\n\\end{align*}\nSubstitute $c_4=2\\alpha$ and $c_2=-3+2\\alpha^2\\sigma^2$:\n\\begin{align*}\nC_6\n= -7\\cdot(2\\alpha) \\;+\\; 2\\alpha\\big(-3+2\\alpha^2\\sigma^2\\big) \\;+\\; 2\\alpha^2\\sigma^2\\cdot(2\\alpha) \\\\\n= -14\\alpha \\;+\\; \\big(-6\\alpha + 4\\alpha^3\\sigma^2\\big) \\;+\\; 4\\alpha^3\\sigma^2 \\\\\n= -20\\alpha \\;+\\; 8\\alpha^3\\sigma^2.\n\\end{align*}\nThus, the $x^6$ contribution to $(\\mathcal{L}^*)^2\\pi_0$ is $\\big(-20\\alpha + 8\\alpha^3\\sigma^2\\big)\\,x^6\\,\\exp(-\\alpha x^2)$.", "answer": "$$\\boxed{-20\\alpha + 8\\alpha^{3}\\sigma^{2}}$$", "id": "3004801"}, {"introduction": "While the Zakai SPDE is infinite-dimensional, we can often transform it into a more manageable (though still infinite) system of stochastic differential equations for spectral coefficients. This powerful technique involves projecting the density onto a suitable basis, such as a Fourier series for processes on a circle. This final practice provides hands-on experience with this spectral method, guiding you to derive the SDEs for the Fourier modes of the unnormalized density in a classic phase-tracking problem. [@problem_id:3004820]", "problem": "Consider a diffusion on the unit circle $S^{1}$ described by the angular state process $\\theta_{t} \\in [0,2\\pi)$ modulo $2\\pi$, governed by the Itô Stochastic Differential Equation (SDE)\n$$\n\\mathrm{d}\\theta_{t} \\;=\\; \\omega\\,\\mathrm{d}t \\;+\\; \\sigma\\,\\mathrm{d}W_{t},\n$$\nwhere $\\omega \\in \\mathbb{R}$ and $\\sigma0$ are constants, and $W_{t}$ is a standard Brownian motion. The observation process $Y_{t}$ is given by\n$$\n\\mathrm{d}Y_{t} \\;=\\; h(\\theta_{t})\\,\\mathrm{d}t \\;+\\; \\mathrm{d}V_{t}, \\qquad h(\\theta) \\;=\\; \\sin\\theta,\n$$\nwhere $V_{t}$ is a standard Brownian motion independent of $W_{t}$. Let $\\mu(\\mathrm{d}\\theta)$ denote the uniform probability measure on $S^{1}$ identified with the Lebesgue measure on $[0,2\\pi)$ normalized by $2\\pi$. Define the unnormalized filtering density $\\rho_{t}(\\theta)$ with respect to $\\mu$ by the property that, for any smooth $2\\pi$-periodic test function $\\varphi$,\n$$\n\\int_{0}^{2\\pi} \\varphi(\\theta)\\,\\rho_{t}(\\theta)\\,\\mu(\\mathrm{d}\\theta)\n\\;=\\;\n\\mathbb{E}\\!\\left[\\,\\varphi(\\theta_{t})\\,\\Lambda_{t}\\,\\middle|\\, \\mathcal{Y}_{t}\\,\\right],\n$$\nwhere $\\mathcal{Y}_{t}$ is the $\\sigma$-algebra generated by $\\{Y_{s}: 0\\le s \\le t\\}$ and $\\Lambda_{t}$ is the likelihood process associated with the observation model.\n\nStarting from Itô’s formula for $\\varphi(\\theta_{t})$, the generator of the state dynamics on $S^{1}$, and the change-of-measure construction for the likelihood process, derive the linear Stochastic Partial Differential Equation (SPDE) satisfied by the unnormalized density $\\rho_{t}(\\theta)$ on $S^{1}$ with periodic boundary conditions. Then expand $\\rho_{t}(\\theta)$ in the complex Fourier basis,\n$$\n\\rho_{t}(\\theta) \\;=\\; \\frac{1}{2\\pi}\\sum_{n\\in\\mathbb{Z}} c_{n}(t)\\,\\exp(i n \\theta),\n$$\nand, by projecting the SPDE onto this basis, obtain the Stochastic Differential Equation (SDE) for the Fourier coefficients $c_{n}(t)$.\n\nFinally, extract from your derivation the deterministic drift coefficient $\\lambda_{1}$ multiplying $c_{1}(t)$ in the drift part of $\\mathrm{d}c_{1}(t)$, expressed purely in terms of $\\omega$ and $\\sigma$. Provide your final answer as a single closed-form analytical expression. Do not include any intermediate steps in the final answer.", "solution": "The solution proceeds in three steps: derivation of the Zakai SPDE, projection onto the Fourier basis, and extraction of the requested coefficient.\n\n**1. Derivation of the Zakai Equation (SPDE)**\n\nThe evolution of the unnormalized conditional expectation of a test function $\\varphi$, denoted $\\pi_t(\\varphi) = \\int_0^{2\\pi} \\varphi(\\theta) \\rho_t(\\theta) \\mu(\\mathrm{d}\\theta)$, is governed by the weak form of the Zakai equation:\n$$\n\\mathrm{d}\\pi_t(\\varphi) = \\pi_t(\\mathcal{L}\\varphi)\\,\\mathrm{d}t + \\pi_t(h\\varphi)\\,\\mathrm{d}Y_t\n$$\nHere, $\\mathcal{L}$ is the generator of the state process $\\theta_t$. For a twice-differentiable $2\\pi$-periodic function $\\varphi(\\theta)$, Itô's formula gives:\n$$\n\\mathcal{L}\\varphi(\\theta) = \\omega \\frac{\\mathrm{d}\\varphi}{\\mathrm{d}\\theta} + \\frac{1}{2}\\sigma^2 \\frac{\\mathrm{d}^2\\varphi}{\\mathrm{d}\\theta^2}\n$$\nTo obtain the strong form of the equation for the density $\\rho_t(\\theta)$, we find the adjoint operator $\\mathcal{L}^*$ with respect to the standard Lebesgue inner product. Integrating by parts twice and using the periodicity of the functions (which makes boundary terms vanish):\n$$\n\\int_0^{2\\pi} (\\mathcal{L}\\varphi)\\rho_t\\,\\mathrm{d}\\theta = \\int_0^{2\\pi} \\left(\\omega \\varphi' + \\frac{1}{2}\\sigma^2 \\varphi''\\right)\\rho_t\\,\\mathrm{d}\\theta = \\int_0^{2\\pi} \\varphi\\left(-\\omega \\rho_t' + \\frac{1}{2}\\sigma^2 \\rho_t''\\right)\\mathrm{d}\\theta\n$$\nThus, the adjoint operator is $\\mathcal{L}^*\\rho_t = -\\omega \\frac{\\partial\\rho_t}{\\partial\\theta} + \\frac{1}{2}\\sigma^2 \\frac{\\partial^2\\rho_t}{\\partial\\theta^2}$. Since the weak form must hold for all test functions $\\varphi$, we can equate the integrands to obtain the strong form of the Zakai equation, an SPDE for $\\rho_t(\\theta)$:\n$$\n\\mathrm{d}\\rho_t(\\theta) = \\left( -\\omega \\frac{\\partial \\rho_t}{\\partial \\theta} + \\frac{\\sigma^2}{2} \\frac{\\partial^2 \\rho_t}{\\partial \\theta^2} \\right)\\mathrm{d}t + \\sin(\\theta) \\rho_t(\\theta)\\,\\mathrm{d}Y_t\n$$\n\n**2. Derivation of the SDE for Fourier Coefficients**\n\nWe project the SPDE onto the Fourier basis. The Fourier coefficients are given by $c_k(t) = \\int_0^{2\\pi} \\rho_t(\\theta) \\exp(-ik\\theta) \\mathrm{d}\\theta$. The dynamic equation for $c_k(t)$ is found by taking the stochastic differential:\n$$\n\\mathrm{d}c_k(t) = \\int_0^{2\\pi} \\mathrm{d}\\rho_t(\\theta) \\exp(-ik\\theta) \\mathrm{d}\\theta = \\left( \\int_0^{2\\pi} (\\mathcal{L}^*\\rho_t)(\\theta) \\exp(-ik\\theta) \\mathrm{d}\\theta \\right) \\mathrm{d}t + \\left( \\int_0^{2\\pi} \\sin(\\theta)\\rho_t(\\theta) \\exp(-ik\\theta) \\mathrm{d}\\theta \\right) \\mathrm{d}Y_t\n$$\nWe evaluate the two integrals separately. For the drift term, we use the adjoint property $\\int (\\mathcal{L}^*f)g = \\int f(\\mathcal{L}g)$:\n$$\n\\int_0^{2\\pi} (\\mathcal{L}^*\\rho_t)(\\theta) \\exp(-ik\\theta) \\mathrm{d}\\theta = \\int_0^{2\\pi} \\rho_t(\\theta) \\mathcal{L}(\\exp(-ik\\theta)) \\mathrm{d}\\theta\n$$\nThe basis functions $\\exp(-ik\\theta)$ are eigenfunctions of the generator $\\mathcal{L}$:\n$$\n\\mathcal{L}(\\exp(-ik\\theta)) = \\omega(-ik)\\exp(-ik\\theta) + \\frac{\\sigma^2}{2}(-ik)^2\\exp(-ik\\theta) = \\left(-ik\\omega - \\frac{k^2\\sigma^2}{2}\\right)\\exp(-ik\\theta)\n$$\nThe drift integral becomes $\\left(-ik\\omega - \\frac{k^2\\sigma^2}{2}\\right) c_k(t)$. For the diffusion term, we use the identity $\\sin(\\theta) = \\frac{\\exp(i\\theta) - \\exp(-i\\theta)}{2i}$:\n$$\n\\int_0^{2\\pi} \\sin(\\theta)\\rho_t(\\theta) \\exp(-ik\\theta) \\mathrm{d}\\theta = \\frac{1}{2i} \\left( \\int_0^{2\\pi} \\rho_t(\\theta)\\exp(-i(k-1)\\theta)\\mathrm{d}\\theta - \\int_0^{2\\pi} \\rho_t(\\theta)\\exp(-i(k+1)\\theta)\\mathrm{d}\\theta \\right)\n$$\nThis simplifies to $\\frac{1}{2i} \\left(c_{k-1}(t) - c_{k+1}(t)\\right)$. Combining these results, the SDE for the $k$-th Fourier coefficient is:\n$$\n\\mathrm{d}c_k(t) = \\left(-ik\\omega - \\frac{k^2\\sigma^2}{2}\\right) c_k(t)\\,\\mathrm{d}t + \\frac{1}{2i}\\left(c_{k-1}(t) - c_{k+1}(t)\\right)\\,\\mathrm{d}Y_t\n$$\n\n**3. Extraction of the Coefficient $\\lambda_1$**\n\nThe problem asks for the deterministic drift coefficient $\\lambda_1$ multiplying $c_1(t)$ in the SDE for $c_1(t)$. We obtain this SDE by setting $k=1$ in the general equation:\n$$\n\\mathrm{d}c_1(t) = \\left(-i\\omega - \\frac{\\sigma^2}{2}\\right) c_1(t)\\,\\mathrm{d}t + \\frac{1}{2i}\\left(c_0(t) - c_2(t)\\right)\\,\\mathrm{d}Y_t\n$$\nThe drift part of this SDE is the term proportional to $\\mathrm{d}t$. This term is $\\left(-i\\omega - \\frac{\\sigma^2}{2}\\right) c_1(t)$. The coefficient multiplying $c_1(t)$ in this drift part is $\\lambda_1 = -i\\omega - \\frac{\\sigma^2}{2}$.", "answer": "$$\n\\boxed{-i\\omega - \\frac{\\sigma^{2}}{2}}\n$$", "id": "3004820"}]}