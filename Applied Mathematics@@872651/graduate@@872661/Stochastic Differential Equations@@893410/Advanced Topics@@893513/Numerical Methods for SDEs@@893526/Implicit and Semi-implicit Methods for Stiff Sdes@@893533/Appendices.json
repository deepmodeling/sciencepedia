{"hands_on_practices": [{"introduction": "Before delving into solutions, it is crucial to first understand the problem they are designed to solve. This first exercise diagnoses the issue of \"noise-induced stiffness,\" a phenomenon where the diffusion term, rather than the drift, becomes the limiting factor for the stability of explicit numerical methods. By analyzing a canonical linear SDE, you will derive the precise step-size restriction imposed by multiplicative noise, revealing why standard explicit solvers like the Euler-Maruyama method can be impractical for this class of problems. [@problem_id:2979927]", "problem": "Consider the scalar stochastic differential equation driven by a standard Wiener process $W_t$,\n$$\n\\mathrm{d}X_t \\;=\\; -\\,X_t\\,\\mathrm{d}t \\;+\\; b\\,X_t\\,\\mathrm{d}W_t,\\qquad X_0\\in L^2(\\Omega),\\quad b0,\n$$\nwhich is a linear multiplicative-noise model with a mild stabilizing drift of magnitude $1$ and diffusion coefficient $g(x)=b\\,x$. This is a canonical instance where the diffusion can induce numerical stiffness. Work from first principles to analyze the exact mean-square dynamics and the mean-square stability of the explicit Euler–Maruyama discretization with uniform time step $\\Delta t0$:\n$$\nX_{n+1} \\;=\\; X_n \\;-\\; X_n\\,\\Delta t \\;+\\; b\\,X_n\\,\\Delta W_n,\n$$\nwhere $\\Delta W_n:=W_{t_{n+1}}-W_{t_n}$ and $t_n:=n\\,\\Delta t$. In your derivations, use only the fundamental properties of Itô calculus and the Wiener increment, namely $\\mathbb{E}[\\Delta W_n]=0$ and $\\mathbb{E}[(\\Delta W_n)^2]=\\Delta t$, and the definition of mean-square stability as the requirement that $\\mathbb{E}[|X_t|^2]$ (for the exact solution) or $\\mathbb{E}[|X_n|^2]$ (for the discrete solution) decays to $0$ as $t\\to\\infty$ or $n\\to\\infty$.\n\nTasks:\n- Derive the exact evolution equation for $\\mathbb{E}[|X_t|^2]$ and state the condition on $b$ under which the exact solution is mean-square stable.\n- Derive the one-step mean-square amplification factor of the Euler–Maruyama method and the associated mean-square stability condition.\n- Interpreting the situation as noise-induced stiffness when the drift $-X_t$ is mild but $b$ is not negligible, determine the largest step size $\\Delta t_{\\max}$ (as a function of $b$) for which the explicit Euler–Maruyama method is mean-square stable whenever the exact solution is mean-square stable.\n\nProvide your final answer as the closed-form expression for $\\Delta t_{\\max}$ in terms of $b$. No numerical rounding is required.", "solution": "The problem requires an analysis of the mean-square stability for a scalar linear stochastic differential equation (SDE) and its discretization by the explicit Euler–Maruyama method. We will first derive the condition for the stability of the exact solution, then for the numerical method, and finally determine the maximum allowable time step for the numerical method under the condition that the exact solution is stable.\n\nThe given SDE is:\n$$\n\\mathrm{d}X_t = -X_t\\,\\mathrm{d}t + b\\,X_t\\,\\mathrm{d}W_t\n$$\nwith initial condition $X_0 \\in L^2(\\Omega)$ and parameter $b0$.\n\n**Part 1: Mean-Square Stability of the Exact Solution**\n\nTo analyze the mean-square stability, we need to find the evolution of the second moment, $\\mathbb{E}[|X_t|^2]$. Since $X_t$ is a real-valued process, $|X_t|^2 = X_t^2$. We apply Itô's formula to the function $f(x) = x^2$. The derivatives are $f_x(x) = 2x$ and $f_{xx}(x) = 2$.\nThe general Itô's formula for a process $\\mathrm{d}X_t = a(X_t, t)\\mathrm{d}t + g(X_t, t)\\mathrm{d}W_t$ applied to $f(X_t)$ is:\n$$\n\\mathrm{d}f(X_t) = \\left( a(X_t, t) f_x(X_t) + \\frac{1}{2} g(X_t, t)^2 f_{xx}(X_t) \\right) \\mathrm{d}t + g(X_t, t) f_x(X_t) \\mathrm{d}W_t\n$$\nIn our case, the drift coefficient is $a(x,t) = -x$ and the diffusion coefficient is $g(x,t) = b\\,x$. Substituting these into Itô's formula with $f(x)=x^2$:\n$$\n\\mathrm{d}(X_t^2) = \\left( (-X_t)(2X_t) + \\frac{1}{2} (b X_t)^2 (2) \\right) \\mathrm{d}t + (b X_t)(2X_t) \\mathrm{d}W_t\n$$\n$$\n\\mathrm{d}(X_t^2) = \\left( -2X_t^2 + b^2 X_t^2 \\right) \\mathrm{d}t + 2b X_t^2 \\mathrm{d}W_t\n$$\n$$\n\\mathrm{d}(X_t^2) = (-2 + b^2) X_t^2 \\mathrm{d}t + 2b X_t^2 \\mathrm{d}W_t\n$$\nTo find the differential equation for the mean-square value, $\\mathbb{E}[X_t^2]$, we take the expectation of the integral form of the above SDE:\n$$\n\\mathbb{E}[X_t^2] - \\mathbb{E}[X_0^2] = \\mathbb{E}\\left[\\int_0^t (-2 + b^2) X_s^2 \\mathrm{d}s\\right] + \\mathbb{E}\\left[\\int_0^t 2b X_s^2 \\mathrm{d}W_s\\right]\n$$\nBy Fubini's theorem, we can swap expectation and the time integral. The expectation of the Itô integral term is zero, provided the integrand is a suitable process, which is true here.\n$$\n\\mathbb{E}[X_t^2] - \\mathbb{E}[X_0^2] = \\int_0^t (-2 + b^2) \\mathbb{E}[X_s^2] \\mathrm{d}s\n$$\nDifferentiating with respect to $t$, we obtain an ordinary differential equation (ODE) for $m(t) := \\mathbb{E}[X_t^2]$:\n$$\n\\frac{\\mathrm{d}m(t)}{\\mathrm{d}t} = (-2 + b^2) m(t)\n$$\nThe solution to this linear ODE is $m(t) = m(0) \\exp((-2 + b^2)t)$, where $m(0)=\\mathbb{E}[X_0^2]$.\nMean-square stability requires that $m(t) \\to 0$ as $t \\to \\infty$. This occurs if and only if the coefficient in the exponent is negative:\n$$\n-2 + b^2  0 \\implies b^2  2\n$$\nSince the problem states $b  0$, the condition for mean-square stability of the exact solution is $0  b  \\sqrt{2}$.\n\n**Part 2: Mean-Square Stability of the Euler–Maruyama Method**\n\nThe Euler–Maruyama discretization with time step $\\Delta t$ is given by:\n$$\nX_{n+1} = X_n - X_n\\,\\Delta t + b\\,X_n\\,\\Delta W_n = X_n(1 - \\Delta t + b\\,\\Delta W_n)\n$$\nWe analyze the evolution of the mean-square value, $\\mathbb{E}[X_n^2]$. We square the expression for $X_{n+1}$ and take the expectation:\n$$\n\\mathbb{E}[X_{n+1}^2] = \\mathbb{E}\\left[ \\left( X_n(1 - \\Delta t + b\\,\\Delta W_n) \\right)^2 \\right] = \\mathbb{E}\\left[ X_n^2 (1 - \\Delta t + b\\,\\Delta W_n)^2 \\right]\n$$\nUsing the law of total expectation, $\\mathbb{E}[Z] = \\mathbb{E}[\\mathbb{E}[Z|\\mathcal{F}]]$, we condition on the sigma-algebra $\\mathcal{F}_{t_n}$ generated by the Wiener process up to time $t_n = n \\Delta t$. $X_n$ is $\\mathcal{F}_{t_n}$-measurable.\n$$\n\\mathbb{E}[X_{n+1}^2] = \\mathbb{E}\\left[ \\mathbb{E}\\left[ X_n^2 (1 - \\Delta t + b\\,\\Delta W_n)^2 \\big| \\mathcal{F}_{t_n} \\right] \\right] = \\mathbb{E}\\left[ X_n^2 \\mathbb{E}\\left[ (1 - \\Delta t + b\\,\\Delta W_n)^2 \\big| \\mathcal{F}_{t_n} \\right] \\right]\n$$\nThe Wiener increment $\\Delta W_n = W_{t_{n+1}} - W_{t_n}$ is independent of $\\mathcal{F}_{t_n}$. Thus, the inner conditional expectation is a simple expectation:\n$$\n\\mathbb{E}[(1 - \\Delta t + b\\,\\Delta W_n)^2] = \\mathbb{E}[ (1 - \\Delta t)^2 + 2b(1 - \\Delta t)\\Delta W_n + b^2(\\Delta W_n)^2 ]\n$$\nUsing the properties $\\mathbb{E}[\\Delta W_n]=0$ and $\\mathbb{E}[(\\Delta W_n)^2]=\\Delta t$:\n$$\n= (1 - \\Delta t)^2 + 2b(1 - \\Delta t)\\mathbb{E}[\\Delta W_n] + b^2 \\mathbb{E}[(\\Delta W_n)^2] = (1 - \\Delta t)^2 + b^2 \\Delta t\n$$\n$$\n= 1 - 2\\Delta t + (\\Delta t)^2 + b^2\\Delta t = 1 + (b^2 - 2)\\Delta t + (\\Delta t)^2\n$$\nThis expression is the one-step mean-square amplification factor, $R(\\Delta t)$. The recurrence relation for the mean-square value is:\n$$\n\\mathbb{E}[X_{n+1}^2] = R(\\Delta t) \\mathbb{E}[X_n^2] = \\left( 1 + (b^2 - 2)\\Delta t + (\\Delta t)^2 \\right) \\mathbb{E}[X_n^2]\n$$\nFor the numerical method to be mean-square stable, we require $\\mathbb{E}[X_n^2] \\to 0$ as $n \\to \\infty$, which holds if and only if the amplification factor $R(\\Delta t)$ has a magnitude less than $1$:\n$$\n|R(\\Delta t)|  1 \\implies -1  1 + (b^2 - 2)\\Delta t + (\\Delta t)^2  1\n$$\nThis gives two conditions:\n1. $1 + (b^2 - 2)\\Delta t + (\\Delta t)^2  1 \\implies (b^2 - 2)\\Delta t + (\\Delta t)^2  0 \\implies \\Delta t (b^2 - 2 + \\Delta t)  0$.\nSince $\\Delta t  0$, we must have $b^2 - 2 + \\Delta t  0$, which means $\\Delta t  2 - b^2$. For a positive step size $\\Delta t$ to exist, we must have $2 - b^2  0$, i.e., $b^2  2$.\n\n2. $1 + (b^2 - 2)\\Delta t + (\\Delta t)^2  -1 \\implies (\\Delta t)^2 + (b^2 - 2)\\Delta t + 2  0$.\nLet $q(\\Delta t) = (\\Delta t)^2 + (b^2 - 2)\\Delta t + 2$. This is a quadratic in $\\Delta t$ that opens upwards. Its vertex is at $\\Delta t_v = -(b^2 - 2)/2 = (2 - b^2)/2$.\nIf $b^2 \\ge 2$, then $\\Delta t_v \\le 0$. For $\\Delta t  0$, $q(\\Delta t)$ is an increasing function and $q(0)=2$, so $q(\\Delta t)  2$ for all $\\Delta t  0$.\nIf $0  b^2  2$, then $\\Delta t_v  0$. The minimum value of $q(\\Delta t)$ for $\\Delta t  0$ is at the vertex: $q(\\Delta t_v) = (\\frac{2-b^2}{2})^2 - (2-b^2)(\\frac{2-b^2}{2}) + 2 = 2 - \\frac{(2-b^2)^2}{4}$. Since $0  b^2  2$, we have $0  2-b^2  2$, so $0  (2-b^2)^2  4$. This gives $0  \\frac{(2-b^2)^2}{4}  1$, and thus $1  q(\\Delta t_v)  2$.\nIn both cases, $q(\\Delta t)  0$ for all $\\Delta t  0$ and $b  0$.\nTherefore, the second condition is always satisfied.\n\nThe sole condition for mean-square stability of the Euler-Maruyama method is $\\Delta t  2 - b^2$, which requires $b^2  2$.\n\n**Part 3: Determination of the Maximum Step Size $\\Delta t_{\\max}$**\n\nThe problem asks for the largest step size $\\Delta t_{\\max}$ for which the numerical method is stable, under the assumption that the exact solution is stable.\nFrom Part 1, the exact solution is stable if and only if $0  b^2  2$.\nFrom Part 2, for a given $b$ satisfying $b^2  2$, the Euler-Maruyama method is stable if and only if the step size $\\Delta t$ satisfies $0  \\Delta t  2 - b^2$.\nThe largest step size for which this stability condition holds is the upper bound of the interval.\nTherefore, the maximum allowed step size is:\n$$\n\\Delta t_{\\max} = 2 - b^2\n$$\nThis result highlights the phenomenon of noise-induced stiffness. The drift term alone suggests a stability limit of $\\Delta t  2$. However, the multiplicative noise term, controlled by $b$, imposes a stricter constraint $\\Delta t  2 - b^2$. As $b$ approaches the continuous-time stability boundary, i.e., $b \\to \\sqrt{2}^{-}$, the maximum stable step size $\\Delta t_{\\max}$ for the explicit method tends to zero, requiring an increasingly small time step for a stable simulation.", "answer": "$$\\boxed{2 - b^2}$$", "id": "2979927"}, {"introduction": "Having seen how explicit methods can fail, we now turn to a common and effective remedy: semi-implicit schemes. This practice focuses on the drift-implicit Euler-Maruyama method, where the stiff drift component is treated implicitly while the diffusion term remains explicit. Your task is to perform a mean-square stability analysis by deriving the method's amplification factor, a key quantity that governs the long-term behavior of the numerical solution's second moments. [@problem_id:2980005]", "problem": "Consider the scalar linear stochastic differential equation (SDE) $$\\mathrm{d}X_{t}=\\lambda X_{t}\\,\\mathrm{d}t+\\mu X_{t}\\,\\mathrm{d}W_{t},$$ where $W_{t}$ is a standard Wiener process, $\\lambda\\in\\mathbb{R}$ models a stiff linear drift (with $\\lambda0$), and $\\mu\\in\\mathbb{R}$ is the multiplicative noise strength. Let $h0$ be a fixed time-step and denote by $X_{n}\\approx X_{t_{n}}$ the numerical approximation at $t_{n}=nh$ produced by a drift-implicit Euler–Maruyama method, which treats the drift term implicitly and the diffusion term explicitly.\n\nStarting from fundamental definitions of Itô calculus and the update rule of the drift-implicit Euler–Maruyama method applied to this SDE, derive the discrete per-step mean-square (MS) amplification factor $R_{\\text{MS}}(h,\\lambda,\\mu)$ defined by $$R_{\\text{MS}}(h,\\lambda,\\mu)=\\frac{\\mathbb{E}\\!\\left[|X_{n+1}|^{2}\\right]}{\\mathbb{E}\\!\\left[|X_{n}|^{2}\\right]}.$$ Then, compare the discrete MS amplification factor to the exact continuous-time MS decay/growth rate obtained from the evolution equation for the second moment of the SDE, and explain the leading-order relationship in $h$.\n\nYour final answer should be the closed-form analytical expression for $R_{\\text{MS}}(h,\\lambda,\\mu)$ in terms of $h$, $\\lambda$, and $\\mu$. No numerical evaluation or rounding is required.", "solution": "The problem requires the derivation of the mean-square (MS) amplification factor for the drift-implicit Euler–Maruyama method applied to a specific linear stochastic differential equation (SDE), and a comparison of this factor with the exact continuous-time result.\n\nFirst, the problem statement is validated.\n**Step 1: Extract Givens**\n- SDE: $\\mathrm{d}X_{t}=\\lambda X_{t}\\,\\mathrm{d}t+\\mu X_{t}\\,\\mathrm{d}W_{t}$\n- $W_t$ is a standard Wiener process.\n- $\\lambda \\in \\mathbb{R}$ with $\\lambda  0$.\n- $\\mu \\in \\mathbb{R}$.\n- Time step: $h  0$.\n- Numerical approximation: $X_{n} \\approx X_{t_{n}}$ at $t_{n} = nh$.\n- Numerical method: drift-implicit Euler–Maruyama.\n- Definition of MS amplification factor: $R_{\\text{MS}}(h,\\lambda,\\mu)=\\frac{\\mathbb{E}\\!\\left[|X_{n+1}|^{2}\\right]}{\\mathbb{E}\\!\\left[|X_{n}|^{2}\\right]}$.\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientifically Grounded:** The problem deals with a standard linear SDE (geometric Brownian motion), a well-established numerical method (drift-implicit Euler–Maruyama), and a fundamental concept in numerical SDE analysis (mean-square stability). All concepts are rooted in the established theories of stochastic calculus and numerical analysis.\n- **Well-Posed:** The problem provides all necessary definitions and equations to derive a unique analytical expression for the amplification factor. The question is clearly stated and leads to a determinable solution.\n- **Objective:** The language is formal and precise, with no subjective or ambiguous statements.\n\n**Step 3: Verdict and Action**\nThe problem is valid. A full solution is warranted.\n\nThe general form of a drift-implicit Euler–Maruyama scheme for an SDE $\\mathrm{d}X_t = a(X_t, t)\\mathrm{d}t + b(X_t, t)\\mathrm{d}W_t$ is given by:\n$$X_{n+1} = X_n + a(X_{n+1}, t_{n+1})h + b(X_n, t_n)\\Delta W_n$$\nwhere $\\Delta W_n = W_{t_{n+1}} - W_{t_n}$ is the increment of the Wiener process over the interval $[t_n, t_{n+1}]$.\n\nFor the given SDE, $\\mathrm{d}X_{t}=\\lambda X_{t}\\,\\mathrm{d}t+\\mu X_{t}\\,\\mathrm{d}W_{t}$, the drift term is $a(X_t) = \\lambda X_t$ and the diffusion term is $b(X_t) = \\mu X_t$. Applying the drift-implicit scheme gives:\n$$X_{n+1} = X_n + \\lambda X_{n+1} h + \\mu X_n \\Delta W_n$$\nThis is an implicit equation for $X_{n+1}$. We can solve for $X_{n+1}$ algebraically:\n$$X_{n+1} - \\lambda X_{n+1} h = X_n + \\mu X_n \\Delta W_n$$\n$$X_{n+1}(1 - \\lambda h) = X_n(1 + \\mu \\Delta W_n)$$\nAssuming $1 - \\lambda h \\neq 0$, which is true since $\\lambda  0$ and $h  0$, we have:\n$$X_{n+1} = \\frac{1 + \\mu \\Delta W_n}{1 - \\lambda h} X_n$$\nThis is the explicit one-step update rule for the numerical approximation.\n\nNow, we can compute the mean-square amplification factor $R_{\\text{MS}}(h,\\lambda,\\mu)$. We start by taking the squared magnitude of $X_{n+1}$:\n$$|X_{n+1}|^2 = \\left| \\frac{1 + \\mu \\Delta W_n}{1 - \\lambda h} X_n \\right|^2 = \\frac{(1 + \\mu \\Delta W_n)^2}{(1 - \\lambda h)^2} |X_n|^2$$\nNext, we take the expectation of this expression. We use the law of total expectation, conditioning on the information available at time $t_n$, which is represented by the filtration $\\mathcal{F}_{t_n}$. The approximation $X_n$ is $\\mathcal{F}_{t_n}$-measurable, while the increment $\\Delta W_n$ is independent of $\\mathcal{F}_{t_n}$.\n$$\\mathbb{E}[|X_{n+1}|^2] = \\mathbb{E}\\left[ \\mathbb{E}\\left[ \\frac{(1 + \\mu \\Delta W_n)^2}{(1 - \\lambda h)^2} |X_n|^2 \\bigg| \\mathcal{F}_{t_n} \\right] \\right]$$\nSince $|X_n|^2$ and the denominator $(1 - \\lambda h)^2$ are $\\mathcal{F}_{t_n}$-measurable, they can be treated as constants within the inner expectation:\n$$\\mathbb{E}[|X_{n+1}|^2] = \\mathbb{E}\\left[ \\frac{|X_n|^2}{(1 - \\lambda h)^2} \\mathbb{E}\\left[ (1 + \\mu \\Delta W_n)^2 \\bigg| \\mathcal{F}_{t_n} \\right] \\right]$$\nDue to the independence of $\\Delta W_n$ from $\\mathcal{F}_{t_n}$, the conditional expectation becomes an unconditional expectation:\n$$\\mathbb{E}[|X_{n+1}|^2] = \\frac{1}{(1 - \\lambda h)^2} \\mathbb{E}[|X_n|^2] \\mathbb{E}[(1 + \\mu \\Delta W_n)^2]$$\nThe increment $\\Delta W_n$ is a normally distributed random variable with mean $0$ and variance $h$, i.e., $\\Delta W_n \\sim \\mathcal{N}(0, h)$. Therefore, $\\mathbb{E}[\\Delta W_n] = 0$ and $\\mathbb{E}[(\\Delta W_n)^2] = h$. We use this to evaluate the remaining expectation:\n$$\\mathbb{E}[(1 + \\mu \\Delta W_n)^2] = \\mathbb{E}[1 + 2\\mu\\Delta W_n + \\mu^2(\\Delta W_n)^2]$$\nBy linearity of expectation:\n$$\\mathbb{E}[(1 + \\mu \\Delta W_n)^2] = 1 + 2\\mu\\mathbb{E}[\\Delta W_n] + \\mu^2\\mathbb{E}[(\\Delta W_n)^2] = 1 + 2\\mu(0) + \\mu^2(h) = 1 + \\mu^2 h$$\nSubstituting this result back, we get the relationship between the second moments at successive time steps:\n$$\\mathbb{E}[|X_{n+1}|^2] = \\frac{1 + \\mu^2 h}{(1 - \\lambda h)^2} \\mathbb{E}[|X_n|^2]$$\nThe discrete per-step mean-square amplification factor is therefore:\n$$R_{\\text{MS}}(h,\\lambda,\\mu) = \\frac{\\mathbb{E}[|X_{n+1}|^2]}{\\mathbb{E}[|X_n|^2]} = \\frac{1 + \\mu^2 h}{(1 - \\lambda h)^2}$$\nThis is the first part of the required answer.\n\nFor the comparison, we must find the exact continuous-time MS decay/growth rate. Let $m_2(t) = \\mathbb{E}[X_t^2]$. We derive the ordinary differential equation (ODE) governing $m_2(t)$ using Itô's formula. For $f(x) = x^2$, we have $f'(x) = 2x$ and $f''(x) = 2$. Applying Itô's formula to $X_t^2$:\n$$\\mathrm{d}(X_t^2) = \\left( (2X_t)(\\lambda X_t) + \\frac{1}{2}(2)(\\mu X_t)^2 \\right)\\mathrm{d}t + (2X_t)(\\mu X_t)\\mathrm{d}W_t$$\n$$\\mathrm{d}(X_t^2) = (2\\lambda + \\mu^2)X_t^2\\,\\mathrm{d}t + 2\\mu X_t^2\\,\\mathrm{d}W_t$$\nTaking the expectation of both sides, and noting that the expectation of the Itô integral term is zero ($\\mathbb{E}[\\int_{0}^{t} 2\\mu X_s^2\\,\\mathrm{d}W_s] = 0$):\n$$\\mathrm{d}(\\mathbb{E}[X_t^2]) = (2\\lambda + \\mu^2)\\mathbb{E}[X_t^2]\\,\\mathrm{d}t$$\nThis gives the ODE for the second moment $m_2(t)$:\n$$\\frac{\\mathrm{d}m_2(t)}{\\mathrm{d}t} = (2\\lambda + \\mu^2)m_2(t)$$\nThe solution is $m_2(t) = m_2(0)\\exp((2\\lambda + \\mu^2)t)$. The exact amplification of the second moment over a time step of length $h$ is:\n$$R_{\\text{exact}}(h) = \\frac{m_2(t_n+h)}{m_2(t_n)} = \\exp((2\\lambda + \\mu^2)h)$$\nTo compare $R_{\\text{MS}}$ with $R_{\\text{exact}}$, we perform a Taylor expansion of both expressions in powers of $h$ around $h=0$.\nFor the exact factor:\n$$R_{\\text{exact}}(h) = 1 + (2\\lambda + \\mu^2)h + \\frac{1}{2}(2\\lambda + \\mu^2)^2 h^2 + O(h^3)$$\nFor the numerical factor, we use the geometric series expansion $(1-x)^{-2} = 1 + 2x + 3x^2 + \\dots$:\n$$R_{\\text{MS}}(h) = \\frac{1 + \\mu^2 h}{(1 - \\lambda h)^2} = (1 + \\mu^2 h)(1 - \\lambda h)^{-2}$$\n$$R_{\\text{MS}}(h) = (1 + \\mu^2 h)(1 + 2\\lambda h + 3\\lambda^2 h^2 + O(h^3))$$\n$$R_{\\text{MS}}(h) = 1 + 2\\lambda h + 3\\lambda^2 h^2 + \\mu^2 h + 2\\lambda\\mu^2 h^2 + O(h^3)$$\n$$R_{\\text{MS}}(h) = 1 + (2\\lambda + \\mu^2)h + (3\\lambda^2 + 2\\lambda\\mu^2)h^2 + O(h^3)$$\nComparing the two series expansions, we see that the coefficients of $h^0$ and $h^1$ are identical.\n$$R_{\\text{MS}}(h) - R_{\\text{exact}}(h) = O(h^2)$$\nThis means the drift-implicit Euler-Maruyama method reproduces the exact mean-square dynamics to first order in the step-size $h$. The leading-order relationship is that the numerical MS amplification factor is a first-order approximation to the exact one: $R_{\\text{MS}}(h) = R_{\\text{exact}}(h) + O(h^2)$.", "answer": "$$\\boxed{\\frac{1 + \\mu^{2} h}{(1 - \\lambda h)^{2}}}$$", "id": "2980005"}, {"introduction": "Theoretical analysis provides the foundation for numerical methods, but computational verification builds intuition and confirms our understanding. This final practice bridges theory and code by exploring the family of $\\theta$-methods, which generalize the explicit and implicit Euler schemes. You will derive the mean-square stability condition for the $\\theta$-Maruyama method and then implement a Monte Carlo simulation to empirically test your theoretical predictions, providing a tangible link between abstract stability inequalities and concrete numerical behavior. [@problem_id:2979926]", "problem": "Consider the linear scalar Itô stochastic differential equation (SDE) given by $dX_t = a X_t \\, dt + b X_t \\, dW_t$, where $a \\in \\mathbb{R}$, $b \\in \\mathbb{R}$, and $\\{W_t\\}_{t \\ge 0}$ is a standard Wiener process. You will analyze the $\\theta$-Maruyama method, which applies an implicit treatment to the drift with parameter $\\theta \\in [0,1]$, to study mean-square stability for stiff problems. The $\\theta$-Maruyama method updates $X_n$ at time $t_n$ to $X_{n+1}$ at time $t_{n+1} = t_n + h$ as the unique solution of\n$$\nX_{n+1} = X_n + h \\left[(1-\\theta) a X_n + \\theta a X_{n+1}\\right] + b X_n \\, \\Delta W_n,\n$$\nwhere $\\Delta W_n \\sim \\mathcal{N}(0,h)$ are independent Gaussian increments. You must work from first principles: use the Itô isometry $\\mathbb{E}\\!\\left[(\\Delta W_n)^2\\right] = h$, linearity of expectation, and algebra on the one-step recursion to derive a necessary and sufficient inequality characterizing when a single step of the method is mean-square contractive, in the sense that the mean-square amplification factor $M := \\mathbb{E}\\!\\left[X_{n+1}^2\\right]\\big/\\mathbb{E}\\!\\left[X_n^2\\right]$ satisfies $M  1$.\n\nYour task is to confirm empirically, by parameter sweeps over $\\theta$, that the derived theoretical stability bound accurately predicts the observed mean-square stability. To do this, implement the following procedure.\n\n1. Base model and estimator:\n   - Fix $X_n \\equiv 1$ deterministically across independent Monte Carlo paths so that $\\mathbb{E}\\!\\left[X_n^2\\right] = 1$, which removes dependence on the distribution of $X_n$.\n   - For a given $(a,b,h,\\theta)$ and a large number $N$ of independent Gaussian increments $\\Delta W \\sim \\mathcal{N}(0,h)$, generate $N$ samples of one $\\theta$-Maruyama step to form $X_{n+1}^{(i)}$, and estimate\n     $$\n     \\widehat{M} := \\frac{1}{N} \\sum_{i=1}^N \\left(X_{n+1}^{(i)}\\right)^2.\n     $$\n   - Classify the observed one-step mean-square stability as “stable” if $\\widehat{M}  1 - \\varepsilon$ and “unstable” if $\\widehat{M}  1 + \\varepsilon$, where $\\varepsilon = 0.01$ is a fixed tolerance. If $\\widehat{M}$ falls in the interval $[1-\\varepsilon, 1+\\varepsilon]$, treat it as borderline; your code should still return a boolean by the classification rule above, which is sufficient for the supplied test suite.\n\n2. Theoretical prediction:\n   - Starting from the method definition and fundamental Itô properties, derive an explicit inequality in $(a,b,h,\\theta)$ that is equivalent to $M  1$. Use this inequality to predict stability (“stable” if the inequality holds, “unstable” otherwise) for each $(a,b,h,\\theta)$. This derivation must not rely on any external formulas aside from the stated fundamentals.\n\n3. Parameter sweeps:\n   - For each test case listed below, sweep over $\\theta \\in \\{0, 0.25, 0.5, 0.75, 1.0\\}$ and compute both the theoretical prediction and the empirical classification. Record whether the two five-entry stability lists match exactly for that test case.\n\n4. Test suite:\n   - Use the following four test cases, chosen to probe stiff drift, small and large time steps, unconditional stability for larger $\\theta$, and situations where the exact SDE is mean-square unstable:\n     - Case A: $(a,b,h) = (-10.0, 3.0, 0.5)$.\n     - Case B: $(a,b,h) = (-10.0, 3.0, 0.05)$.\n     - Case C: $(a,b,h) = (-1.0, 1.5, 0.1)$.\n     - Case D: $(a,b,h) = (-1.0, 1.5, 2.0)$.\n\n5. Output format:\n   - Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. Each entry corresponds to one of the four cases (A, B, C, D, in that order) and is a boolean indicating whether the predicted theoretical stability classifications exactly match the empirical classifications across the five $\\theta$ values. For example, a valid output might look like\n     $$\n     [\\text{True},\\text{True},\\text{True},\\text{True}].\n     $$\n\nNo physical units are involved in this problem. All angles, if any, should be interpreted in radians, though no angles are directly used here. The final outputs are booleans as specified. Your code must be a complete, runnable program that performs all computations without user input and prints the single required line. Use a fixed random seed so that results are reproducible.", "solution": "The objective is to derive the condition for one-step mean-square stability of the $\\theta$-Maruyama method applied to the linear scalar SDE $dX_t = a X_t \\, dt + b X_t \\, dW_t$, and then to verify this condition numerically. The stability condition requires that the mean-square amplification factor $M := \\mathbb{E}[X_{n+1}^2] / \\mathbb{E}[X_n^2]$ is less than $1$.\n\nThe $\\theta$-Maruyama method is defined by the one-step recursion:\n$$\nX_{n+1} = X_n + h \\left[(1-\\theta) a X_n + \\theta a X_{n+1}\\right] + b X_n \\, \\Delta W_n\n$$\nwhere $a, b \\in \\mathbb{R}$, $\\theta \\in [0, 1]$, $h$ is the time step, and $\\Delta W_n$ are independent Gaussian increments with $\\mathbb{E}[\\Delta W_n] = 0$ and $\\mathbb{E}[(\\Delta W_n)^2] = h$.\n\nFirst, we must express $X_{n+1}$ explicitly by rearranging the terms of the recursion.\n$$\nX_{n+1} - h \\theta a X_{n+1} = X_n + h (1-\\theta) a X_n + b X_n \\, \\Delta W_n\n$$\n$$\nX_{n+1}(1 - h \\theta a) = X_n (1 + h(1-\\theta) a + b \\, \\Delta W_n)\n$$\nAssuming $1 - h \\theta a \\neq 0$, we can solve for $X_{n+1}$:\n$$\nX_{n+1} = \\left( \\frac{1 + h(1-\\theta) a + b \\, \\Delta W_n}{1 - h \\theta a} \\right) X_n\n$$\nTo analyze mean-square stability, we compute the expectation of $X_{n+1}^2$:\n$$\n\\mathbb{E}[X_{n+1}^2] = \\mathbb{E}\\left[ \\left( \\frac{1 + h(1-\\theta) a + b \\, \\Delta W_n}{1 - h \\theta a} \\right)^2 X_n^2 \\right]\n$$\nThe Wiener increment $\\Delta W_n = W_{t_{n+1}} - W_{t_n}$ is independent of the state $X_n$, which is $\\mathcal{F}_{t_n}$-measurable. This independence allows us to separate the expectations:\n$$\n\\mathbb{E}[X_{n+1}^2] = \\frac{1}{(1 - h \\theta a)^2} \\mathbb{E}\\left[ (1 + h(1-\\theta) a + b \\, \\Delta W_n)^2 \\right] \\mathbb{E}[X_n^2]\n$$\nNow, we expand the term inside the expectation:\n$$\n(1 + h(1-\\theta) a + b \\, \\Delta W_n)^2 = (1 + h(1-\\theta) a)^2 + 2b(1 + h(1-\\theta) a)\\Delta W_n + b^2 (\\Delta W_n)^2\n$$\nTaking the expectation and using linearity, we get:\n$$\n\\mathbb{E}[(1 + h(1-\\theta) a + b \\, \\Delta W_n)^2] = \\mathbb{E}[(1 + h(1-\\theta) a)^2] + \\mathbb{E}[2b(1 + h(1-\\theta) a)\\Delta W_n] + \\mathbb{E}[b^2 (\\Delta W_n)^2]\n$$\nUsing the fundamental properties of the Wiener increment, $\\mathbb{E}[\\Delta W_n] = 0$ and $\\mathbb{E}[(\\Delta W_n)^2] = h$ (the Itô isometry), we evaluate each term:\n\\begin{itemize}\n    \\item The first term is a constant: $\\mathbb{E}[(1 + h(1-\\theta) a)^2] = (1 + h(1-\\theta) a)^2$.\n    \\item The second term becomes zero: $\\mathbb{E}[2b(1 + h(1-\\theta) a)\\Delta W_n] = 2b(1 + h(1-\\theta) a)\\mathbb{E}[\\Delta W_n] = 0$.\n    \\item The third term simplifies to: $\\mathbb{E}[b^2 (\\Delta W_n)^2] = b^2 \\mathbb{E}[(\\Delta W_n)^2] = b^2 h$.\n\\end{itemize}\nSubstituting these back, we find:\n$$\n\\mathbb{E}[(1 + h(1-\\theta) a + b \\, \\Delta W_n)^2] = (1 + h(1-\\theta) a)^2 + b^2 h\n$$\nThus, the expression for $\\mathbb{E}[X_{n+1}^2]$ is:\n$$\n\\mathbb{E}[X_{n+1}^2] = \\frac{(1 + h(1-\\theta) a)^2 + b^2 h}{(1 - h \\theta a)^2} \\mathbb{E}[X_n^2]\n$$\nThe mean-square amplification factor $M$ is the ratio of the mean squares:\n$$\nM = \\frac{\\mathbb{E}[X_{n+1}^2]}{\\mathbb{E}[X_n^2]} = \\frac{(1 + h(1-\\theta) a)^2 + b^2 h}{(1 - h \\theta a)^2}\n$$\nThe condition for mean-square stability is $M  1$:\n$$\n\\frac{(1 + h(1-\\theta) a)^2 + b^2 h}{(1 - h \\theta a)^2}  1\n$$\nSince $(1 - h \\theta a)^2  0$ (for a non-degenerate method), we can multiply both sides by this term without changing the inequality's direction:\n$$\n(1 + h(1-\\theta) a)^2 + b^2 h  (1 - h \\theta a)^2\n$$\nExpanding both squared binomials:\n$$\n1 + 2h(1-\\theta)a + h^2(1-\\theta)^2 a^2 + b^2 h  1 - 2h\\theta a + h^2\\theta^2 a^2\n$$\n$$\n1 + 2ha - 2h\\theta a + h^2(1 - 2\\theta + \\theta^2)a^2 + b^2 h  1 - 2h\\theta a + h^2\\theta^2 a^2\n$$\nWe can subtract $1$ and add $2h\\theta a$ to both sides, and expand the $h^2a^2$ term:\n$$\n2ha + (h^2 a^2 - 2h^2\\theta a^2 + h^2\\theta^2 a^2) + b^2 h  h^2\\theta^2 a^2\n$$\nCanceling the identical terms $h^2\\theta^2 a^2$ from both sides:\n$$\n2ha + h^2 a^2 - 2h^2\\theta a^2 + b^2 h  0\n$$\nSince the time step $h  0$, we can divide the entire inequality by $h$:\n$$\n2a + ha^2 - 2ha^2\\theta + b^2  0\n$$\nFactoring out common terms yields the final necessary and sufficient condition for one-step mean-square stability:\n$$\n2a + b^2 + ha^2(1 - 2\\theta)  0\n$$\nThis inequality provides the theoretical prediction for stability given a set of parameters $(a, b, h, \\theta)$.\n\nThe numerical verification procedure involves two parts. First, for each set of parameters, we evaluate the derived inequality to predict stability. Second, we perform a Monte Carlo simulation to estimate the amplification factor empirically. To estimate $M$, we set $X_n \\equiv 1$ so that $\\mathbb{E}[X_n^2] = 1$. Consequently, $M = \\mathbb{E}[X_{n+1}^2]$. We generate $N$ samples of $X_{n+1}^{(i)}$ using $X_{n+1}^{(i)} = (1 + h(1-\\theta)a + b\\Delta W_n^{(i)}) / (1 - h\\theta a)$, where $\\Delta W_n^{(i)} \\sim \\mathcal{N}(0,h)$. The empirical estimate is then $\\widehat{M} = \\frac{1}{N} \\sum_{i=1}^N (X_{n+1}^{(i)})^2$. Stability is observed if $\\widehat{M}  1$. For each test case, the list of theoretical predictions over the sweep of $\\theta$ values is compared against the corresponding list of empirical observations to confirm that they match.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Derives, implements, and verifies the mean-square stability condition for the\n    theta-Maruyama method on a linear scalar SDE.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case A: (a, b, h) = (-10.0, 3.0, 0.5)\n        (-10.0, 3.0, 0.5),\n        # Case B: (a, b, h) = (-10.0, 3.0, 0.05)\n        (-10.0, 3.0, 0.05),\n        # Case C: (a, b, h) = (-1.0, 1.5, 0.1)\n        (-1.0, 1.5, 0.1),\n        # Case D: (a, b, h) = (-1.0, 1.5, 2.0)\n        (-1.0, 1.5, 2.0),\n    ]\n\n    # Parameters for the parameter sweep and simulation\n    theta_values = [0.0, 0.25, 0.5, 0.75, 1.0]\n    N_SAMPLES = 1_000_000\n    RANDOM_SEED = 42\n\n    np.random.seed(RANDOM_SEED)\n\n    results = []\n    for case in test_cases:\n        a, b, h = case\n        \n        theoretical_stabilities = []\n        empirical_stabilities = []\n\n        for theta in theta_values:\n            # 1. Theoretical Prediction\n            # The derived stability condition is: 2*a + b**2 + h * a**2 * (1 - 2*theta)  0\n            is_stable_theory = (2 * a + b**2 + h * a**2 * (1 - 2 * theta))  0\n            theoretical_stabilities.append(is_stable_theory)\n\n            # 2. Empirical Estimation\n            # Generate N_SAMPLES of the Wiener increment Delta W_n ~ N(0, h)\n            # Delta W_n can be written as sqrt(h) * Z, where Z ~ N(0, 1)\n            delta_Wn_samples = np.random.normal(0, np.sqrt(h), N_SAMPLES)\n            \n            # The explicit form for X_{n+1} is:\n            # X_{n+1} = (1 + h(1-theta)a + b*dW_n) / (1 - h*theta*a) * X_n\n            # With X_n = 1, this simplifies the expression.\n            denominator = 1 - h * theta * a\n            if np.isclose(denominator, 0):\n                # This case is not expected with the given test parameters\n                # but is a good practice to handle.\n                # If the denominator is 0, the method is ill-defined.\n                # We can consider it unstable.\n                is_stable_empirical = False\n            else:\n                numerator = 1 + h * (1 - theta) * a + b * delta_Wn_samples\n                X_np1_samples = numerator / denominator\n            \n                # Estimate the mean-square amplification factor M\n                # M_hat = E[X_{n+1}^2] with X_n = 1\n                m_hat = np.mean(X_np1_samples**2)\n            \n                # Classify stability based on the estimate\n                is_stable_empirical = m_hat  1\n            \n            empirical_stabilities.append(is_stable_empirical)\n\n        # 3. Compare theoretical predictions and empirical classifications\n        match = (theoretical_stabilities == empirical_stabilities)\n        results.append(match)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2979926"}]}