{"hands_on_practices": [{"introduction": "Standard numerical methods like the Euler-Maruyama scheme, which are robust for SDEs with globally Lipschitz coefficients, can exhibit catastrophic failure when coefficients grow superlinearly. This first practice provides a hands-on diagnosis of this instability by dissecting a single step of the Euler-Maruyama method applied to a prototype SDE with cubic drift [@problem_id:2999251]. By comparing the magnitudes of the drift and diffusion increments, you will pinpoint the conditions under which the deterministic part of the update can overwhelm the stochastic part and lead to explosive, non-physical solutions.", "problem": "Consider the Itô stochastic differential equation $dX_{t}=b(X_{t})\\,dt+\\sigma(X_{t})\\,dW_{t}$, where $W_{t}$ is a standard Brownian motion (BM) and $b(x)=-x^{3}$, $\\sigma(x)=x$. Let $t_{n}$ be a fixed time, $X_{t_{n}}=x_{n}$ be the current state, and $h>0$ be a chosen time step. Define the Brownian increment $\\Delta W_{n}=W_{t_{n}+h}-W_{t_{n}}$.\n\nUsing only fundamental definitions for Itô stochastic differential equations and the construction of the explicit Euler-Maruyama (EM) method from the integral form $X_{t+h}-X_{t}=\\int_{t}^{t+h}b(X_{s})\\,ds+\\int_{t}^{t+h}\\sigma(X_{s})\\,dW_{s}$ by freezing the coefficients at $X_{t}$, compute the one-step Euler-Maruyama increment $\\Delta X_{n}=X_{t_{n}+h}-X_{t_{n}}$ in terms of $x_{n}$, $h$, and $\\Delta W_{n}$ for the given $b$ and $\\sigma$. Then, by first-principles comparisons of magnitudes, identify conditions (in terms of $x_{n}$, $h$, and $|\\Delta W_{n}|$) under which the drift contribution dominates the diffusion contribution, and explain how this dominance can cause numerical instability in the explicit Euler update through growth of $|X_{t_{n}+h}|$ relative to $|X_{t_{n}}|$ in the drift-only case.\n\nYour final answer must be the single closed-form expression for the computed one-step Euler-Maruyama increment. No rounding is required and no units are involved.", "solution": "The starting point is the fundamental integral representation of an Itô stochastic differential equation. For the Itô stochastic differential equation $dX_{t}=b(X_{t})\\,dt+\\sigma(X_{t})\\,dW_{t}$, the increment over a single time step of length $h>0$ is given by\n$$\nX_{t_{n}+h}-X_{t_{n}}=\\int_{t_{n}}^{t_{n}+h}b(X_{s})\\,ds+\\int_{t_{n}}^{t_{n}+h}\\sigma(X_{s})\\,dW_{s}.\n$$\nThe explicit Euler-Maruyama (EM) scheme arises by approximating the integrands in the drift and diffusion integrals by freezing the coefficients at the left endpoint $X_{t_{n}}=x_{n}$, and approximating the integrals by $b(x_{n})\\,h$ and $\\sigma(x_{n})\\,(W_{t_{n}+h}-W_{t_{n}})$, respectively. Therefore,\n$$\n\\Delta X_{n}:=X_{t_{n}+h}-X_{t_{n}}\\approx b(x_{n})\\,h+\\sigma(x_{n})\\,\\Delta W_{n}.\n$$\nFor the given coefficients $b(x)=-x^{3}$ and $\\sigma(x)=x$, this becomes\n$$\n\\Delta X_{n}=-x_{n}^{3}\\,h+x_{n}\\,\\Delta W_{n}.\n$$\nThis is the one-step Euler-Maruyama increment in closed form.\n\nNext, we compare the magnitudes of the drift and diffusion contributions to identify when the drift dominates. The drift magnitude is\n$$\n|\\text{drift}|=|b(x_{n})|\\,h=|x_{n}|^{3}\\,h,\n$$\nand the diffusion magnitude is\n$$\n|\\text{diffusion}|=|\\sigma(x_{n})|\\,|\\Delta W_{n}|=|x_{n}|\\,|\\Delta W_{n}|.\n$$\nDrift dominance is characterized by $|\\text{drift}|>|\\text{diffusion}|$, which yields\n$$\n|x_{n}|^{3}\\,h > |x_{n}|\\,|\\Delta W_{n}|.\n$$\nAssuming $x_{n}\\neq 0$, divide both sides by $|x_{n}|$ to obtain the condition\n$$\nh\\,|x_{n}|^{2} > |\\Delta W_{n}|.\n$$\nSince the Brownian increment $\\Delta W_{n}$ is normally distributed with mean $0$ and variance $h$, its typical size is of order $\\sqrt{h}$. In terms of order-of-magnitude, a high-probability drift-dominance regime therefore corresponds to\n$$\nh\\,|x_{n}|^{2} \\gg \\sqrt{h},\n$$\nequivalently,\n$$\n|x_{n}| \\gg h^{-1/4}.\n$$\nThis shows that for large $|x_{n}|$ relative to $h^{-1/4}$, the drift contribution dominates the diffusion contribution with high probability.\n\nTo connect drift dominance to numerical instability in the explicit Euler method, consider first the deterministic drift-only update (setting the diffusion increment to zero) for the ordinary differential equation $dX_{t}=-X_{t}^{3}\\,dt$. The explicit Euler update reads\n$$\nx_{n+1}=x_{n}-h\\,x_{n}^{3}=x_{n}\\left(1-h\\,x_{n}^{2}\\right).\n$$\nThe magnitude evolves according to\n$$\n|x_{n+1}|=|x_{n}|\\,\\left|1-h\\,x_{n}^{2}\\right|.\n$$\nInstability in the numerical sense (growth of $|x_{n+1}|$ relative to $|x_{n}|$) occurs whenever $\\left|1-h\\,x_{n}^{2}\\right|>1$, that is,\n$$\n\\left|1-h\\,x_{n}^{2}\\right|>1 \\quad\\Longleftrightarrow\\quad h\\,x_{n}^{2}>2.\n$$\nThus, if $h\\,x_{n}^{2}>2$, the explicit Euler map amplifies the magnitude of the state and becomes numerically unstable in the drift-only case despite the continuous-time system being dissipative. When the stochastic term is present, drift dominance $h\\,|x_{n}|^{2}>|\\Delta W_{n}|$ places the update in a regime where the dynamics are effectively governed by the unstable drift-only map, and the step can exhibit large excursions, motivating the use of tamed or stabilized schemes for non-Lipschitz coefficients.\n\nIn summary, the computed one-step Euler-Maruyama increment for the given coefficients is\n$$\n\\Delta X_{n}=-x_{n}^{3}\\,h+x_{n}\\,\\Delta W_{n},\n$$\nand drift dominance is indicated by $h\\,|x_{n}|^{2}>|\\Delta W_{n}|$, a condition that can place the explicit Euler update into a numerically unstable regime $h\\,x_{n}^{2}>2$ in the drift-only case.", "answer": "$$\\boxed{-x_{n}^{3}\\,h+x_{n}\\,\\Delta W_{n}}$$", "id": "2999251"}, {"introduction": "The failure of standard methods for non-Lipschitz problems motivates a search for weaker structural conditions that can still guarantee good long-term behavior. This practice introduces the one-sided Lipschitz condition, a pivotal concept in the modern analysis of SDEs that ensures dissipativity without strictly controlling the function's growth [@problem_id:2999286]. Calculating the one-sided Lipschitz constant for a polynomial drift will build your intuition for why many important physical and financial models, despite being non-Lipschitz, are amenable to stable numerical simulation.", "problem": "Consider the scalar stochastic differential equation (SDE) $$\\mathrm{d}X_{t}=b(X_{t})\\,\\mathrm{d}t+\\sigma(X_{t})\\,\\mathrm{d}W_{t},$$ where $W_{t}$ is a standard one-dimensional Brownian motion, $b(x)=x-x^{3}$, and $\\sigma(x)=x^{2}$. In the analysis of tamed and stabilized numerical schemes for SDEs with non-Lipschitz coefficients, a key structural property for the drift is the one-sided Lipschitz condition: there exists a constant $L\\in\\mathbb{R}$ such that for all $x,y\\in\\mathbb{R}$, $$\\langle x-y,\\,b(x)-b(y)\\rangle\\leq L\\|x-y\\|^{2},$$ where $\\langle\\cdot,\\cdot\\rangle$ is the Euclidean inner product and $\\|\\cdot\\|$ is the Euclidean norm. Starting from first principles in real analysis and the foundational definition of the one-sided Lipschitz condition, determine whether this condition holds for the given $b(x)$ and, if so, compute the sharp smallest constant $L$ for which it is valid over $\\mathbb{R}$. Your final answer must be a single real number. No rounding is required. Express your answer with no units.", "solution": "The problem asks to determine if the one-sided Lipschitz condition holds for the drift function $b(x) = x - x^3$ and, if so, to find the smallest constant $L$ for which the condition is valid for all $x, y \\in \\mathbb{R}$.\n\nThe problem is set in a one-dimensional, scalar context. The state $X_t$ is a real number, so the variables $x$ and $y$ belong to $\\mathbb{R}$. In this scalar setting, the Euclidean inner product $\\langle u, v \\rangle$ simplifies to the standard product $uv$, and the Euclidean norm $\\|u\\|$ becomes the absolute value $|u|$.\n\nThe one-sided Lipschitz condition is given as:\n$$\n\\langle x-y, b(x)-b(y) \\rangle \\leq L \\|x-y\\|^2\n$$\nFor scalar variables $x, y \\in \\mathbb{R}$, this inequality becomes:\n$$\n(x-y)(b(x)-b(y)) \\leq L(x-y)^2\n$$\nThe given drift function is $b(x) = x - x^3$. We substitute this into the inequality. The term $b(x) - b(y)$ is:\n$$\nb(x) - b(y) = (x - x^3) - (y - y^3) = (x-y) - (x^3 - y^3)\n$$\nSubstituting this expression back into the condition yields:\n$$\n(x-y) \\left[ (x-y) - (x^3 - y^3) \\right] \\leq L(x-y)^2\n$$\nWe use the standard algebraic identity for the difference of cubes: $x^3 - y^3 = (x-y)(x^2 + xy + y^2)$.\n$$\n(x-y) \\left[ (x-y) - (x-y)(x^2 + xy + y^2) \\right] \\leq L(x-y)^2\n$$\nFactoring out the term $(x-y)$ from the brackets on the left-hand side gives:\n$$\n(x-y)^2 \\left[ 1 - (x^2 + xy + y^2) \\right] \\leq L(x-y)^2\n$$\nWe need to find the smallest constant $L \\in \\mathbb{R}$ for which this inequality holds for all $x, y \\in \\mathbb{R}$.\n\nLet's analyze the inequality.\nIf $x = y$, the inequality becomes $0 \\leq 0$, which is always true and provides no constraint on $L$.\nIf $x \\neq y$, then $(x-y)^2 > 0$. We can divide both sides of the inequality by $(x-y)^2$ without changing the direction of the inequality:\n$$\n1 - (x^2 + xy + y^2) \\leq L\n$$\nThis inequality must hold for all $x, y \\in \\mathbb{R}$ with $x \\neq y$. The problem of finding the smallest such constant $L$ is equivalent to finding the supremum of the function $f(x, y) = 1 - (x^2 + xy + y^2)$ over the domain $\\{(x,y) \\in \\mathbb{R}^2 \\mid x \\neq y\\}$.\nSince the function $f(x, y)$ is continuous over all of $\\mathbb{R}^2$, its supremum over the set where $x \\neq y$ is the same as its supremum over all of $\\mathbb{R}^2$.\nTherefore, the sharp smallest constant $L$ is given by:\n$$\nL = \\sup_{(x,y) \\in \\mathbb{R}^2} \\left[ 1 - (x^2 + xy + y^2) \\right]\n$$\nThis can be rewritten as:\n$$\nL = 1 - \\inf_{(x,y) \\in \\mathbb{R}^2} (x^2 + xy + y^2)\n$$\nLet's analyze the quadratic form $Q(x,y) = x^2 + xy + y^2$. To find its infimum, we can complete the square. We can treat it as a quadratic in $x$:\n$$\nQ(x,y) = \\left( x^2 + xy + \\frac{y^2}{4} \\right) - \\frac{y^2}{4} + y^2\n$$\n$$\nQ(x,y) = \\left( x + \\frac{1}{2}y \\right)^2 + \\frac{3}{4}y^2\n$$\nThe expression $\\left( x + \\frac{1}{2}y \\right)^2$ is a square of a real number, so its value is always non-negative, i.e., $\\left( x + \\frac{1}{2}y \\right)^2 \\geq 0$.\nSimilarly, the expression $\\frac{3}{4}y^2$ is also always non-negative.\nTherefore, $Q(x,y)$ is a sum of two non-negative terms, which implies $Q(x,y) \\geq 0$ for all $x, y \\in \\mathbb{R}$.\nThe minimum value of $Q(x,y)$ is achieved when both terms are simultaneously equal to $0$:\n1. $\\frac{3}{4}y^2 = 0 \\implies y = 0$.\n2. $\\left( x + \\frac{1}{2}y \\right)^2 = 0$. Substituting $y=0$ gives $x^2 = 0 \\implies x = 0$.\nThe minimum value of $Q(x,y)$ is $0$, and it occurs at the point $(x,y) = (0,0)$.\nThus,\n$$\n\\inf_{(x,y) \\in \\mathbb{R}^2} (x^2 + xy + y^2) = 0\n$$\nSubstituting this result back into the expression for $L$:\n$$\nL = 1 - 0 = 1\n$$\nThe one-sided Lipschitz condition holds for the drift function $b(x) = x - x^3$, and the sharp (smallest) constant is $L=1$. This shows that although $b(x)$ is not globally Lipschitz (its derivative $b'(x) = 1 - 3x^2$ is unbounded below), it satisfies the weaker but still very useful one-sided Lipschitz condition, which is a common feature in models like the stochastic Ginzburg-Landau equation.", "answer": "$$\\boxed{1}$$", "id": "2999286"}, {"introduction": "Armed with an understanding of why standard schemes fail and the theoretical properties that can ensure stability, we now turn to practical solutions. This exercise compares two popular explicit stabilization techniques: the tamed Euler and the truncated Euler schemes [@problem_id:2999335]. By calculating the leading-order weak bias between these methods in a regime where stabilization is active, you will gain a concrete understanding of how they differ in modifying the drift and the consequences for the accuracy of the simulation.", "problem": "Consider the scalar Itô stochastic differential equation (SDE)\n$$\ndX_t \\;=\\; b(X_t)\\,dt \\;+\\; \\sigma(X_t)\\,dW_t,\\qquad b(x) \\;=\\; -x^3,\\quad \\sigma(x)\\;=\\; x,\n$$\ndriven by a standard one-dimensional Brownian motion $W_t$. Two explicit numerical schemes designed for non-globally Lipschitz coefficients are the truncated Euler–Maruyama scheme and the tamed Euler scheme. Define the truncated Euler–Maruyama scheme using the truncation map\n$$\n\\theta_h(x)\\;=\\;\\mathrm{sign}(x)\\,\\min\\{|x|,R(h)\\},\\qquad R(h)\\;=\\;h^{-1/3},\n$$\nso that in one time step of size $h>0$, the update from a current state $x\\in\\mathbb{R}$ is given by\n$$\nX^{\\mathrm{TrE}}_{n+1}\\;=\\;x \\;+\\; b\\!\\left(\\theta_h(x)\\right)\\,h \\;+\\; \\sigma\\!\\left(\\theta_h(x)\\right)\\,\\Delta W_n,\n$$\nwhere $\\Delta W_n\\sim\\mathcal{N}(0,h)$ and is independent of the past. Define the tamed Euler scheme by\n$$\nX^{\\mathrm{TE}}_{n+1}\\;=\\;x \\;+\\; \\frac{b(x)}{1+h\\,|b(x)|}\\,h \\;+\\; \\sigma(x)\\,\\Delta W_n.\n$$\n\nFix a constant $\\kappa>1$ and consider the boundary-layer scaling of the state variable\n$$\nx_h \\;=\\; \\kappa\\,R(h) \\;=\\; \\kappa\\,h^{-1/3}.\n$$\nFor this scaling, both truncation and taming are active at leading order. Define the one-step conditional weak bias of the truncated scheme relative to the tamed scheme by\n$$\n\\delta(h)\\;:=\\;\\mathbb{E}\\!\\left[\\,X^{\\mathrm{TrE}}_{n+1}-X^{\\mathrm{TE}}_{n+1}\\,\\big|\\,X_n=x_h\\,\\right].\n$$\nStarting only from the definitions above and the basic properties of conditional expectation for Itô increments, derive the leading-order bias induced by truncation, in the precise sense of the small–time-step limit\n$$\n\\lim_{h\\to 0}\\,\\delta(h).\n$$\nYour final answer must be a single closed-form expression in terms of $\\kappa$ only. No numerical approximation is required. Express the final result as a single analytic expression without units.", "solution": "The objective is to compute the small-time-step limit of the one-step conditional weak bias, $\\delta(h)$, of the truncated Euler–Maruyama scheme relative to the tamed Euler scheme, for the given stochastic differential equation (SDE) and a specific state-space scaling. The bias is defined as\n$$\n\\delta(h)\\;:=\\;\\mathbb{E}\\!\\left[\\,X^{\\mathrm{TrE}}_{n+1}-X^{\\mathrm{TE}}_{n+1}\\,\\big|\\,X_n=x_h\\,\\right].\n$$\nFirst, we write out the expression for the difference of the two schemes at a general state $x$, before applying the specific scaling $x_h$. The update rules are:\n$$\nX^{\\mathrm{TrE}}_{n+1}\\;=\\;x \\;+\\; b\\!\\left(\\theta_h(x)\\right)\\,h \\;+\\; \\sigma\\!\\left(\\theta_h(x)\\right)\\,\\Delta W_n\n$$\n$$\nX^{\\mathrm{TE}}_{n+1}\\;=\\;x \\;+\\; \\frac{b(x)}{1+h\\,|b(x)|}\\,h \\;+\\; \\sigma(x)\\,\\Delta W_n\n$$\nThe difference is\n$$\nX^{\\mathrm{TrE}}_{n+1}-X^{\\mathrm{TE}}_{n+1} \\;=\\; \\left( b(\\theta_h(x))h - \\frac{b(x)}{1+h|b(x)|}h \\right) + \\left( \\sigma(\\theta_h(x)) - \\sigma(x) \\right)\\Delta W_n.\n$$\nNow we take the conditional expectation given the state at time step $n$ is $X_n = x$. Since the Brownian increment $\\Delta W_n$ is independent of the information up to time $t_n$ (and thus independent of $X_n=x$) and has zero mean, $\\mathbb{E}[\\Delta W_n | X_n=x] = \\mathbb{E}[\\Delta W_n] = 0$. Using the linearity of expectation, we get:\n$$\n\\mathbb{E}[X^{\\mathrm{TrE}}_{n+1}-X^{\\mathrm{TE}}_{n+1} | X_n=x] \\;=\\; \\mathbb{E}\\left[\\left( b(\\theta_h(x)) - \\frac{b(x)}{1+h|b(x)|} \\right)h \\Bigg| X_n=x\\right] + \\mathbb{E}\\left[\\left( \\sigma(\\theta_h(x)) - \\sigma(x) \\right)\\Delta W_n \\Bigg| X_n=x\\right]\n$$\n$$\n\\;=\\; \\left( b(\\theta_h(x)) - \\frac{b(x)}{1+h|b(x)|} \\right)h + \\left( \\sigma(\\theta_h(x)) - \\sigma(x) \\right)\\mathbb{E}[\\Delta W_n]\n$$\n$$\n\\;=\\; \\left( b(\\theta_h(x)) - \\frac{b(x)}{1+h|b(x)|} \\right)h.\n$$\nNow, we evaluate this expression at the specific state $x = x_h = \\kappa h^{-1/3}$, where $\\kappa>1$ is a constant. We must evaluate each term in the expression for $\\delta(h)$:\n$$\n\\delta(h) \\;=\\; \\left( b(\\theta_h(x_h)) - \\frac{b(x_h)}{1+h|b(x_h)|} \\right)h.\n$$\nThe components are evaluated as follows:\n1.  The scaled state is $x_h = \\kappa h^{-1/3}$. Since $\\kappa > 1$ and $h > 0$, we have $x_h > 0$.\n2.  The truncation radius is $R(h) = h^{-1/3}$.\n3.  The absolute value of the state is $|x_h| = |\\kappa h^{-1/3}| = \\kappa h^{-1/3} = \\kappa R(h)$.\n4.  Since $\\kappa > 1$, we have $|x_h| > R(h)$.\n5.  The truncation map $\\theta_h(x_h)$ is defined as $\\theta_h(x_h) = \\mathrm{sign}(x_h) \\min\\{|x_h|, R(h)\\}$. With $x_h > 0$ and $|x_h| > R(h)$, this simplifies to $\\theta_h(x_h) = (1) \\min\\{\\kappa R(h), R(h)\\} = R(h) = h^{-1/3}$.\n6.  The drift function is $b(x) = -x^3$. We evaluate it for the truncated state and the original scaled state:\n    -   $b(\\theta_h(x_h)) = b(h^{-1/3}) = -(h^{-1/3})^3 = -h^{-1}$.\n    -   $b(x_h) = b(\\kappa h^{-1/3}) = -(\\kappa h^{-1/3})^3 = -\\kappa^3 h^{-1}$.\n7.  The absolute value of the drift at the scaled state is $|b(x_h)| = |-\\kappa^3 h^{-1}| = \\kappa^3 h^{-1}$.\n8.  The taming factor in the denominator of the tamed scheme's drift term is $1 + h|b(x_h)| = 1 + h(\\kappa^3 h^{-1}) = 1 + \\kappa^3$.\n9.  The drift component of the tamed scheme is therefore $\\frac{b(x_h)}{1+h|b(x_h)|} = \\frac{-\\kappa^3 h^{-1}}{1+\\kappa^3}$.\n\nNow, we substitute these evaluated components back into the expression for $\\delta(h)$:\n$$\n\\delta(h) \\;=\\; \\left( \\left(-h^{-1}\\right) - \\left(\\frac{-\\kappa^3 h^{-1}}{1+\\kappa^3}\\right) \\right)h.\n$$\nSimplifying the expression within the parentheses first:\n$$\n-h^{-1} + \\frac{\\kappa^3 h^{-1}}{1+\\kappa^3} \\;=\\; h^{-1} \\left(-1 + \\frac{\\kappa^3}{1+\\kappa^3}\\right) \\;=\\; h^{-1} \\left(\\frac{-(1+\\kappa^3) + \\kappa^3}{1+\\kappa^3}\\right) \\;=\\; h^{-1} \\left(\\frac{-1 - \\kappa^3 + \\kappa^3}{1+\\kappa^3}\\right) \\;=\\; h^{-1} \\left(\\frac{-1}{1+\\kappa^3}\\right).\n$$\nSubstituting this simplified term back into the expression for $\\delta(h)$:\n$$\n\\delta(h) \\;=\\; \\left( h^{-1} \\left(\\frac{-1}{1+\\kappa^3}\\right) \\right) h \\;=\\; \\frac{-1}{1+\\kappa^3}.\n$$\nThe expression for $\\delta(h)$ is a constant with respect to the time step size $h$, due to the specific choice of the scaling $x_h = \\kappa h^{-1/3}$ which creates a perfect balance.\n\nThe final step is to compute the limit as $h\\to 0$:\n$$\n\\lim_{h\\to 0}\\,\\delta(h) \\;=\\; \\lim_{h\\to 0}\\,\\left(-\\frac{1}{1+\\kappa^3}\\right) \\;=\\; -\\frac{1}{1+\\kappa^3}.\n$$\nThis is the leading-order bias induced by truncation relative to taming in the specified asymptotic regime.", "answer": "$$\n\\boxed{-\\frac{1}{1+\\kappa^3}}\n$$", "id": "2999335"}]}