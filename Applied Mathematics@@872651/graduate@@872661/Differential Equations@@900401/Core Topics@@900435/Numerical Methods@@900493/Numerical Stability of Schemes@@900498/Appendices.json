{"hands_on_practices": [{"introduction": "Von Neumann stability analysis is a cornerstone technique for investigating the behavior of finite difference schemes applied to linear partial differential equations. This first exercise applies this powerful method to the two-dimensional linear advection equation, a fundamental model in fluid dynamics and transport phenomena. By working through this problem [@problem_id:1128038], you will derive the famous Courant-Friedrichs-Lewy (CFL) condition in a multidimensional setting, building essential intuition about how the time step, grid spacing, and physical velocities interact to govern a simulation's stability.", "problem": "Consider the two-dimensional linear advection equation for a scalar field $u(x, y, t)$:\n$$\n\\frac{\\partial u}{\\partial t} + c_x \\frac{\\partial u}{\\partial x} + c_y \\frac{\\partial u}{\\partial y} = 0\n$$\nwhere $c_x$ and $c_y$ are constant, positive advection velocities in the $x$ and $y$ directions, respectively.\n\nThis equation is discretized on a uniform square grid with spatial step size $h$ in both directions ($\\Delta x = \\Delta y = h$) and a time step $\\Delta t$. The numerical approximation at grid point $(x_i, y_j)$ and time $t^n$ is denoted by $u_{i,j}^n$. The scheme uses a forward Euler method for the time derivative and a first-order upwind scheme for the spatial derivatives. Given that $c_x  0$ and $c_y  0$, this upwind scheme is given by:\n$$\n\\frac{\\partial u}{\\partial x}\\bigg|_{i,j,n} \\approx \\frac{u_{i,j}^n - u_{i-1,j}^n}{h} \\quad \\text{and} \\quad \\frac{\\partial u}{\\partial y}\\bigg|_{i,j,n} \\approx \\frac{u_{i,j}^n - u_{i,j-1}^n}{h}\n$$\nThe stability of this numerical scheme is governed by the Courant-Friedrichs-Lewy (CFL) condition, which places an upper bound on the Courant numbers $\\lambda_x = \\frac{c_x \\Delta t}{h}$ and $\\lambda_y = \\frac{c_y \\Delta t}{h}$. Specifically, for the scheme to be stable for all possible initial conditions, the sum of the Courant numbers, $S = \\lambda_x + \\lambda_y$, must satisfy the inequality $S \\le S_{max}$ for some constant $S_{max}$.\n\nUsing Von Neumann stability analysis, derive the value of the maximum allowable sum of Courant numbers, $S_{max}$.", "solution": "1. Relevant equations: the update for the upwind scheme is\n$$\nu_{i,j}^{n+1}\n= u_{i,j}^n - \\lambda_x\\bigl(u_{i,j}^n - u_{i-1,j}^n\\bigr)\n            - \\lambda_y\\bigl(u_{i,j}^n - u_{i,j-1}^n\\bigr),\n$$\nwith $\\lambda_x = \\frac{c_x\\Delta t}{h}$, $\\lambda_y = \\frac{c_y\\Delta t}{h}$ and $S=\\lambda_x+\\lambda_y$.\nVon Neumann assumes a Fourier mode $u_{i,j}^n = G^n e^{i(k_x x_i + k_y y_j)}$.\n\n2. Substitution gives the amplification factor\n$$\nG = 1 - \\lambda_x\\bigl(1 - e^{-i\\theta_x}\\bigr)\n      - \\lambda_y\\bigl(1 - e^{-i\\theta_y}\\bigr),\n\\quad \\theta_x = k_x h,\\ \\theta_y = k_y h.\n$$\n\n3. For stability we require $|G|\\le1$ for all $\\theta_x,\\theta_y$. The extremal case occurs at $\\theta_x=\\theta_y=\\pi$, where $e^{-i\\pi}=-1$, so\n$$\nG = 1 - \\lambda_x(1-(-1)) - \\lambda_y(1-(-1))\n= 1 - 2\\lambda_x - 2\\lambda_y = 1 - 2S.\n$$\nThe condition $|G|\\le1$ requires $|1 - 2S|\\le1$, which implies\n$$-1 \\le 1-2S \\le 1$$\nThis yields $0 \\le S \\le 1$.\nThus the maximum allowable sum of Courant numbers is\n$$\nS_{\\max} = 1.\n$$", "answer": "$$\\boxed{1}$$", "id": "1128038"}, {"introduction": "Numerical schemes are not always purely explicit or implicit; many powerful methods exist on a spectrum between these extremes. The $\\theta$-method provides a perfect framework for exploring this spectrum and its profound impact on stability properties. This practice challenges you to derive a stability condition that depends on the implicitness parameter $\\theta$, revealing the crucial transition from conditional to unconditional stability. Completing this exercise [@problem_id:1128167] will illuminate the fundamental trade-off between the computational simplicity of explicit methods and the superior stability of implicit ones.", "problem": "Consider the one-dimensional linear advection equation, which describes the transport of a scalar quantity $u(x,t)$ with a constant positive velocity $c  0$:\n$$\n\\frac{\\partial u}{\\partial t} + c \\frac{\\partial u}{\\partial x} = 0\n$$\n\nThis partial differential equation can be discretized and solved numerically. A common family of finite difference methods is the $\\theta$-method. We will use a first-order upwind scheme (specifically, a backward difference) for the spatial derivative, as $c  0$. The resulting finite difference equation for $u_j^n \\approx u(j\\Delta x, n\\Delta t)$ is:\n$$\n\\frac{u_j^{n+1} - u_j^n}{\\Delta t} + c \\left[ (1-\\theta) \\left( \\frac{u_j^n - u_{j-1}^n}{\\Delta x} \\right) + \\theta \\left( \\frac{u_j^{n+1} - u_{j-1}^{n+1}}{\\Delta x} \\right) \\right] = 0\n$$\nwhere $\\Delta t$ is the time step, $\\Delta x$ is the grid spacing, and $\\theta \\in [0, 1]$ is a parameter that blends an explicit time-stepping scheme ($\\theta=0$, Forward Euler) with an implicit one ($\\theta=1$, Backward Euler).\n\nThe stability of this numerical scheme can be investigated using von Neumann stability analysis. We seek solutions of the form $u_j^n = g^n e^{i k j \\Delta x}$, where $k$ is the wavenumber and $g = g(k)$ is the amplification factor. The scheme is stable if and only if $|g| \\le 1$ for all possible wavenumbers $k$.\n\nIt is a known result that for $\\theta \\in [1/2, 1]$, this scheme is unconditionally stable for any positive Courant number $\\sigma = \\frac{c \\Delta t}{\\Delta x}$. However, for $\\theta \\in [0, 1/2)$, the scheme is only conditionally stable.\n\nYour task is to derive the expression for the maximum allowable Courant number, $\\sigma_{\\text{max}}$, as a function of the parameter $\\theta$, that ensures the stability of the scheme for the range $\\theta \\in [0, 1/2)$.", "solution": "We apply von Neumann analysis to the $\\theta$-method upwind scheme. With $\\sigma=c\\Delta t/\\Delta x$ and trial $u_j^n=g^n e^{i\\xi j}$, the scheme yields:\n$$g\\bigl[(1+\\theta\\sigma)-\\theta\\sigma e^{-i\\xi}\\bigr]=(1-\\sigma+\\theta\\sigma)+(\\sigma-\\theta\\sigma)e^{-i\\xi}$$\nDefine the coefficients $A=1-\\sigma+\\theta\\sigma$, $B=\\sigma(1-\\theta)$, $C=1+\\theta\\sigma$, and $D=\\theta\\sigma$, so that the amplification factor is $g=\\frac{A+Be^{-i\\xi}}{C-De^{-i\\xi}}$.\nThe stability condition $|g|^2 \\le 1$ requires:\n$$A^2+B^2+2AB\\cos\\xi \\le C^2+D^2-2CD\\cos\\xi \\quad \\forall \\xi$$\nSet $E=A^2+B^2-C^2-D^2=-2\\sigma+2\\sigma^2(1-2\\theta)$.\nThe worst-case for stability occurs at $\\cos\\xi=-1$, which gives the condition $E-2(AB+CD)\\le0$. The left-hand side simplifies to:\n$$4\\sigma[\\sigma(1-2\\theta)-1]\\le0$$\nSince $\\sigma>0$, this implies $\\sigma(1-2\\theta)-1 \\le 0$, which yields:\n$$\\sigma\\le\\frac{1}{1-2\\theta}$$\nHence for $\\theta\\in[0,1/2)$ the stability limit is:\n$$\\sigma_{\\max}=\\frac{1}{1-2\\theta}$$", "answer": "$$\\boxed{\\frac{1}{1-2\\theta}}$$", "id": "1128167"}, {"introduction": "While Von Neumann analysis is invaluable, the matrix method offers an alternative and equally potent approach, particularly for problems defined on finite domains with specified boundary conditions. This exercise applies the matrix method to a classic case: the Forward-Time, Centered-Space (FTCS) scheme for the wave equation. This practice serves as an essential cautionary tale, as you will rigorously prove that this seemingly intuitive and straightforward scheme is, in fact, unconditionally unstable. By deriving the spectral radius of the system's amplification matrix [@problem_id:1128196], you will gain a deeper understanding of how stability is connected to the eigenvalues of the discrete operator.", "problem": "The one-dimensional wave equation is given by\n$$\n\\frac{\\partial^2 u}{\\partial t^2} = c^2 \\frac{\\partial^2 u}{\\partial x^2}\n$$\nfor a function $u(x,t)$ on the spatial domain $x \\in [0, L]$ and time $t \\ge 0$. The parameter $c$ is the constant wave speed. The equation is subject to Dirichlet boundary conditions, $u(0,t) = u(L,t) = 0$.\n\nTo solve this equation numerically, it is first converted into a system of two first-order partial differential equations by introducing an auxiliary function $v(x,t) = \\frac{\\partial u}{\\partial t}$:\n$$\n\\frac{\\partial u}{\\partial t} = v \\\\\n\\frac{\\partial v}{\\partial t} = c^2 \\frac{\\partial^2 u}{\\partial x^2}\n$$\nA numerical scheme is constructed by discretizing the spatial domain into $N$ intervals of equal width $\\Delta x = L/N$, with grid points $x_j = j\\Delta x$ for $j=0, 1, \\dots, N$. Let $u_j^n \\approx u(x_j, n\\Delta t)$ and $v_j^n \\approx v(x_j, n\\Delta t)$, where $\\Delta t$ is the time step.\n\nThe \"Forward-Time, Centered-Space\" (FTCS) scheme is applied to this system: a forward difference in time for both equations, and a second-order centered difference for the spatial derivative.\n$$\n\\frac{u_j^{n+1}-u_j^n}{\\Delta t} = v_j^n \\\\\n\\frac{v_j^{n+1}-v_j^n}{\\Delta t} = c^2 \\frac{u_{j+1}^n - 2u_j^n + u_{j-1}^n}{(\\Delta x)^2}\n$$\nThis scheme is known to be unconditionally unstable. Your task is to quantify this instability. By considering the evolution of the vector of interior grid points, $\\mathbf{W}^n = [\\mathbf{U}^n, \\mathbf{V}^n]^T$, where $\\mathbf{U}^n = [u_1^n, \\dots, u_{N-1}^n]^T$ and $\\mathbf{V}^n = [v_1^n, \\dots, v_{N-1}^n]^T$, the scheme can be written in the matrix form $\\mathbf{W}^{n+1} = M \\mathbf{W}^n$.\n\nUsing the matrix method of stability analysis, derive an expression for the spectral radius, $\\rho(M)$, of the amplification matrix $M$. Express your final answer in terms of the Courant number $\\lambda = \\frac{c\\Delta t}{\\Delta x}$ and the number of spatial intervals $N$.", "solution": "The given numerical scheme is:\n$$\nu_j^{n+1} = u_j^n + \\Delta t \\, v_j^n\n$$\n$$\nv_j^{n+1} = v_j^n + c^2 \\frac{\\Delta t}{(\\Delta x)^2} (u_{j+1}^n - 2u_j^n + u_{j-1}^n)\n$$\nWe analyze the scheme on the interior grid points $j=1, 2, \\dots, N-1$, using the Dirichlet boundary conditions $u_0^n = u_N^n = 0$.\n\nLet $\\mathbf{U}^n = [u_1^n, u_2^n, \\dots, u_{N-1}^n]^T$ and $\\mathbf{V}^n = [v_1^n, v_2^n, \\dots, v_{N-1}^n]^T$. The system of equations can be written in matrix form. The spatial second derivative is represented by the $(N-1) \\times (N-1)$ tridiagonal matrix $A$:\n$$\nA = \\begin{pmatrix}\n-2  1  0  \\cdots  0 \\\\\n1  -2  1  \\cdots  0 \\\\\n0  \\ddots  \\ddots  \\ddots  0 \\\\\n\\vdots   1  -2  1 \\\\\n0  \\cdots  0  1  -2\n\\end{pmatrix}\n$$\nThe system of difference equations becomes:\n$$\n\\mathbf{U}^{n+1} = \\mathbf{U}^n + \\Delta t \\, \\mathbf{V}^n\n$$\n$$\n\\mathbf{V}^{n+1} = \\mathbf{V}^n + \\frac{c^2 \\Delta t}{(\\Delta x)^2} A \\mathbf{U}^n\n$$\nLet the Courant number be $\\lambda = \\frac{c\\Delta t}{\\Delta x}$. The second equation can be written as:\n$$\n\\mathbf{V}^{n+1} = \\frac{\\lambda^2}{\\Delta t} A \\mathbf{U}^n + \\mathbf{V}^n\n$$\nwhere $I$ is the $(N-1) \\times (N-1)$ identity matrix.\n\nWe form a state vector $\\mathbf{W}^n = \\begin{pmatrix} \\mathbf{U}^n \\\\ \\mathbf{V}^n \\end{pmatrix}$. The scheme is then $\\mathbf{W}^{n+1} = M \\mathbf{W}^n$, where the amplification matrix $M$ is a $2(N-1) \\times 2(N-1)$ block matrix:\n$$\nM = \\begin{pmatrix}\nI  (\\Delta t) I \\\\\n\\frac{\\lambda^2}{\\Delta t} A  I\n\\end{pmatrix}\n$$\nTo find the spectral radius $\\rho(M)$, we need the eigenvalues of $M$. Let $\\mu$ be an eigenvalue of $M$. The characteristic equation for the block matrix gives:\n$$\n\\det\\begin{pmatrix} (1-\\mu)I  (\\Delta t) I \\\\ \\frac{\\lambda^2}{\\Delta t} A  (1-\\mu)I \\end{pmatrix} = 0\n$$\nAssuming the blocks commute (which they do since they are multiples of $I$ and $A$), this simplifies. Alternatively, we solve the system for an eigenvector. Let $\\mathbf{v}_k$ be an eigenvector of $A$ with eigenvalue $\\alpha_k$. The eigenvector of $M$ will be of the form $\\begin{pmatrix} c_1\\mathbf{v}_k \\\\ c_2\\mathbf{v}_k \\end{pmatrix}$. This leads to a $2 \\times 2$ eigenvalue problem for each mode $k$:\n$$\n\\begin{pmatrix} 1  \\Delta t \\\\ \\frac{\\lambda^2}{\\Delta t}\\alpha_k  1 \\end{pmatrix} \\begin{pmatrix} c_1 \\\\ c_2 \\end{pmatrix} = \\mu \\begin{pmatrix} c_1 \\\\ c_2 \\end{pmatrix}\n$$\nThe characteristic equation for $\\mu$ is $(1-\\mu)^2 - \\lambda^2 \\alpha_k = 0$.\nThe eigenvalues of the matrix $A$ are well-known:\n$$\n\\alpha_k = -4 \\sin^2\\left(\\frac{k\\pi}{2N}\\right), \\quad k=1, 2, \\dots, N-1\n$$\nSubstituting $\\alpha_k$ into the equation for $\\mu$:\n$$\n(1-\\mu)^2 = -4\\lambda^2 \\sin^2\\left(\\frac{k\\pi}{2N}\\right)\n$$\nTaking the square root of both sides:\n$$\n1-\\mu = \\pm \\sqrt{-4\\lambda^2 \\sin^2\\left(\\frac{k\\pi}{2N}\\right)} = \\pm 2i\\lambda \\sin\\left(\\frac{k\\pi}{2N}\\right)\n$$\nThe eigenvalues $\\mu_k$ of the amplification matrix $M$ are therefore:\n$$\n\\mu_k = 1 \\mp 2i\\lambda \\sin\\left(\\frac{k\\pi}{2N}\\right)\n$$\nThe magnitude of these complex eigenvalues is:\n$$\n|\\mu_k| = \\sqrt{1^2 + \\left( \\pm 2\\lambda \\sin\\left(\\frac{k\\pi}{2N}\\right) \\right)^2} = \\sqrt{1 + 4\\lambda^2 \\sin^2\\left(\\frac{k\\pi}{2N}\\right)}\n$$\nThe spectral radius $\\rho(M)$ is the maximum of these magnitudes over all possible values of $k$:\n$$\n\\rho(M) = \\max_{k=1, \\dots, N-1} |\\mu_k| = \\max_{k=1, \\dots, N-1} \\sqrt{1 + 4\\lambda^2 \\sin^2\\left(\\frac{k\\pi}{2N}\\right)}\n$$\nTo find the maximum, we need to maximize $\\sin^2\\left(\\frac{k\\pi}{2N}\\right)$. The argument $\\frac{k\\pi}{2N}$ lies in the interval $(0, \\pi/2)$ as $k$ ranges from $1$ to $N-1$. Since $\\sin(x)$ is a strictly increasing function on $[0, \\pi/2]$, its maximum value is achieved for the largest value of $k$, which is $k=N-1$.\nThe maximum value of the sine term is $\\sin\\left(\\frac{(N-1)\\pi}{2N}\\right) = \\sin\\left(\\frac{\\pi}{2} - \\frac{\\pi}{2N}\\right) = \\cos\\left(\\frac{\\pi}{2N}\\right)$.\nSubstituting this into the expression for the spectral radius:\n$$\n\\rho(M) = \\sqrt{1 + 4\\lambda^2 \\cos^2\\left(\\frac{\\pi}{2N}\\right)}\n$$\nFor any $\\lambda  0$ and any finite $N \\ge 2$, $\\cos(\\frac{\\pi}{2N})  0$, hence $\\rho(M)  1$. This confirms that the scheme is unconditionally unstable, as the magnitude of at least one eigenvalue is always greater than 1, regardless of the choice of $\\Delta t$ and $\\Delta x$.", "answer": "$$\n\\boxed{\\sqrt{1 + 4\\lambda^2 \\cos^2\\left(\\frac{\\pi}{2N}\\right)}}\n$$", "id": "1128196"}]}