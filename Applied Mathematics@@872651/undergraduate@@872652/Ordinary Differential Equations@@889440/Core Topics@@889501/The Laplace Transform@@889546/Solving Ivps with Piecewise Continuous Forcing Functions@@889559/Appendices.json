{"hands_on_practices": [{"introduction": "Many real-world processes, from drug delivery to charging a circuit, involve inputs that change at discrete moments in time. This exercise models a common scenario in pharmacokinetics where a drug infusion rate is adjusted mid-treatment. By solving this problem [@problem_id:2200526], you will practice the fundamental technique for handling piecewise forcing functions: solving the differential equation on each time interval and connecting the solutions by enforcing continuity at the points of change.", "problem": "A patient is being treated with a new medication administered via an intravenous (IV) drip. The concentration of the drug in the patient's bloodstream, $C(t)$, measured in milligrams per liter (mg/L), can be modeled by the first-order linear differential equation:\n$$ \\frac{dC}{dt} + kC = f(t). $$\nHere, $t$ is the time in hours since the start of the infusion, $k$ is the constant elimination rate of the drug from the body (in units of hr$^{-1}$), and $f(t)$ represents the effective rate at which the drug concentration increases due to the infusion. Initially, the patient has none of the medication in their system.\n\nThe infusion is administered at a constant effective rate of $r_0$ (in mg/L/hr) for the first hour. After the first hour, to increase the therapeutic effect, the infusion rate is immediately doubled. Thus, the effective rate function $f(t)$ is a piecewise function defined as:\n$$ f(t) = \\begin{cases} r_0  0 \\le t \\le 1 \\\\ 2r_0  t > 1 \\end{cases} $$\nAssuming the drug concentration $C(t)$ is a continuous function of time, determine the analytical expression for $C(t)$ for all $t \\ge 0$ in terms of $r_0$ and $k$.", "solution": "We are given the first-order linear ODE\n$$\n\\frac{dC}{dt} + k C = f(t),\n$$\nwith initial condition $C(0)=0$, where\n$$\nf(t) = \\begin{cases}\nr_0,  0 \\le t \\le 1, \\\\\n2 r_0,  t > 1.\n\\end{cases}\n$$\nWe solve on each interval using the integrating factor method. The integrating factor is $\\mu(t)=\\exp\\left(\\int k\\,dt\\right)=\\exp(kt)$, which yields\n$$\n\\frac{d}{dt}\\big(C(t)\\exp(kt)\\big)=f(t)\\exp(kt).\n$$\n\nFor $0 \\le t \\le 1$, we have $f(t)=r_0$. Integrating from $0$ to $t$ and using $C(0)=0$ gives\n$$\nC(t)\\exp(kt)-C(0)=r_0\\int_{0}^{t}\\exp(ks)\\,ds=\\frac{r_0}{k}\\big(\\exp(kt)-1\\big),\n$$\nso\n$$\nC(t)=\\frac{r_0}{k}\\big(1-\\exp(-kt)\\big), \\quad 0 \\le t \\le 1.\n$$\n\nFor $t>1$, we have $f(t)=2 r_0$. Integrate from $1$ to $t$ to enforce continuity at $t=1$:\n$$\nC(t)\\exp(kt)-C(1)\\exp(k)=2 r_0\\int_{1}^{t}\\exp(ks)\\,ds=\\frac{2 r_0}{k}\\big(\\exp(kt)-\\exp(k)\\big).\n$$\nSolving for $C(t)$ gives\n$$\nC(t)=C(1)\\exp(-k(t-1))+\\frac{2 r_0}{k}\\big(1-\\exp(-k(t-1))\\big), \\quad t>1.\n$$\nUsing the value from the first interval,\n$$\nC(1)=\\frac{r_0}{k}\\big(1-\\exp(-k)\\big),\n$$\nwe obtain\n$$\nC(t)=\\frac{r_0}{k}\\big(1-\\exp(-k)\\big)\\exp(-k(t-1))+\\frac{2 r_0}{k}\\big(1-\\exp(-k(t-1))\\big), \\quad t>1.\n$$\nThis expression is continuous at $t=1$ because substituting $t=1$ yields $C(1)=\\frac{r_0}{k}\\big(1-\\exp(-k)\\big)$ from both sides.\n\nTherefore, the piecewise solution for all $t \\ge 0$ is as derived above.", "answer": "$$\\boxed{C(t)=\\begin{cases}\\frac{r_0}{k}\\left(1-\\exp(-k t)\\right),  0\\le t\\le 1, \\\\ \\frac{r_0}{k}\\left(1-\\exp(-k)\\right)\\exp(-k(t-1))+\\frac{2 r_0}{k}\\left(1-\\exp(-k(t-1))\\right),  t1.\\end{cases}}$$", "id": "2200526"}, {"introduction": "Writing forcing functions using a case-by-case definition can become unwieldy, especially for complex inputs. The Heaviside step function, $u(t-c)$, provides a powerful mathematical shorthand to represent functions that switch on or off at specific times. This problem [@problem_id:2200508] provides practice in working directly with this notation to find the response of a system to a forcing function that involves both a sudden jump and a linearly increasing ramp.", "problem": "Consider a system whose state $y(t)$ at time $t \\ge 0$ is governed by the first-order linear ordinary differential equation:\n$$ \\frac{dy}{dt} + 2y = g(t) $$\nThe system has an initial state of $y(0) = 5$. The external forcing function, $g(t)$, represents a sequence of two distinct events. The first event is a sudden, constant force applied starting at time $t=1$. The second event is a linearly increasing, opposing force that begins at time $t=3$. This forcing function is described by:\n$$ g(t) = 4 u(t-1) - (t-3) u(t-3) $$\nwhere $u(t-c)$ denotes the Heaviside step function, defined as $u(t-c) = 0$ for $t  c$ and $u(t-c) = 1$ for $t \\ge c$.\n\nDetermine the value of the state variable $y(t)$ at time $t=4$. Provide your answer as a single numerical value, rounded to four significant figures.", "solution": "We solve the first-order linear ODE $y'(t)+2y=g(t)$ with $y(0)=5$ using the integrating factor method. The integrating factor is $\\mu(t)=\\exp(2 t)$, so\n$$\n\\frac{d}{dt}\\bigl(\\exp(2 t)\\,y(t)\\bigr)=\\exp(2 t)\\,g(t).\n$$\nIntegrating from $0$ to $t$ and using $y(0)=5$ gives\n$$\ny(t)=\\exp(-2 t)\\left[5+\\int_{0}^{t}\\exp(2 s)\\,g(s)\\,ds\\right].\n$$\nFor $g(s)=4\\,u(s-1)-(s-3)\\,u(s-3)$ and $t=4$, the integral splits as\n$$\n\\int_{0}^{4}\\exp(2 s)\\,g(s)\\,ds=\\int_{1}^{4}4\\,\\exp(2 s)\\,ds-\\int_{3}^{4}(s-3)\\exp(2 s)\\,ds.\n$$\nCompute each term:\n$$\n\\int_{1}^{4}4\\,\\exp(2 s)\\,ds=2\\bigl[\\exp(2 s)\\bigr]_{1}^{4}=2\\bigl(\\exp(8)-\\exp(2)\\bigr),\n$$\nand, using integration by parts for the second integral,\n$$\n\\int_{3}^{4}(s-3)\\exp(2 s)\\,ds=\\frac{1}{4}\\bigl(\\exp(8)+\\exp(6)\\bigr).\n$$\nTherefore,\n$$\n\\int_{0}^{4}\\exp(2 s)\\,g(s)\\,ds=2\\bigl(\\exp(8)-\\exp(2)\\bigr)-\\frac{1}{4}\\bigl(\\exp(8)+\\exp(6)\\bigr)\n=\\frac{7}{4}\\exp(8)-\\frac{1}{4}\\exp(6)-2\\exp(2).\n$$\nSubstitute into $y(4)$:\n$$\ny(4)=\\exp(-8)\\left[5+\\frac{7}{4}\\exp(8)-\\frac{1}{4}\\exp(6)-2\\exp(2)\\right]\n=\\frac{7}{4}+5\\exp(-8)-\\frac{1}{4}\\exp(-2)-2\\exp(-6).\n$$\nNumerically,\n$$\ny(4)\\approx 1.75+5\\exp(-8)-\\frac{1}{4}\\exp(-2)-2\\exp(-6)\\approx 1.7128859879770268,\n$$\nwhich rounds to four significant figures as $1.713$.", "answer": "$$\\boxed{1.713}$$", "id": "2200508"}, {"introduction": "The principles for handling piecewise inputs extend directly to the second-order systems that model mechanical vibrations and electrical circuits. This exercise examines the motion of a damped mechanical actuator subjected to a force pulse of finite duration, a common signal in control engineering [@problem_id:2200483]. The problem showcases an elegant solution that relies on the principle of superposition, demonstrating how the response to a complex pulse can be constructed from the response to a simpler, unterminated input.", "problem": "The motion of a mechanical actuator is being analyzed. The position of the actuator's end-effector, denoted by $y(t)$ in meters, relative to its equilibrium position, is governed by a second-order linear ordinary differential equation. The actuator has an effective mass of $1$ kg, a damping coefficient of $3$ Ns/m, and a spring constant of $2$ N/m. The system is initially at rest at its equilibrium position.\n\nAt time $t=0$, the actuator is subjected to a time-varying external force $F(t)$ in Newtons, given by\n$$ F(t) = t^2 - (t-1)^2 u(t-1) $$\nwhere $t$ is the time in seconds, and $u(t-c)$ is the Heaviside step function, defined as $u(t-c) = 0$ for $t  c$ and $u(t-c) = 1$ for $t \\ge c$.\n\nDetermine the position of the actuator $y(t)$ for all $t \\ge 0$. Your answer should be a single analytical expression for $y(t)$.", "solution": "The motion is governed by the linear time-invariant second-order ODE with zero initial conditions:\n$$\ny''(t)+3y'(t)+2y(t)=F(t),\\quad y(0)=0,\\quad y'(0)=0,\n$$\nwith input\n$$\nF(t)=t^{2}-(t-1)^{2}u(t-1).\n$$\nThe transfer function from input force to output position is\n$$\nG(s)=\\frac{1}{s^{2}+3s+2}=\\frac{1}{(s+1)(s+2)},\n$$\nwhose impulse response is\n$$\nh(t)=\\mathcal{L}^{-1}\\{G(s)\\}= \\exp(-t)-\\exp(-2t),\\quad t\\ge 0.\n$$\nWith zero initial conditions, the response is the convolution\n$$\ny(t)=(h*F)(t)=\\int_{0}^{t}h(t-\\tau)F(\\tau)\\,d\\tau.\n$$\nUsing linearity and the time-shift property of the Heaviside function,\n$$\nF(t)=t^{2}-(t-1)^{2}u(t-1)\\quad\\Rightarrow\\quad y(t)=y_{\\text{base}}(t)-u(t-1)\\,y_{\\text{base}}(t-1),\n$$\nwhere\n$$\ny_{\\text{base}}(t)=(h*t^{2})(t)=\\int_{0}^{t}\\big(\\exp(-(t-\\tau))-\\exp(-2(t-\\tau))\\big)\\,\\tau^{2}\\,d\\tau.\n$$\nEvaluate the two integrals separately. Define, for a constant $a\\neq 0$,\n$$\nA(a,t)=\\int_{0}^{t}\\exp(a\\tau)\\tau^{2}\\,d\\tau.\n$$\nUsing the standard antiderivative\n$$\n\\int \\exp(a\\tau)\\tau^{2}\\,d\\tau=\\exp(a\\tau)\\left(\\frac{\\tau^{2}}{a}-\\frac{2\\tau}{a^{2}}+\\frac{2}{a^{3}}\\right)+C,\n$$\nwe obtain\n$$\nA(a,t)=\\exp(at)\\left(\\frac{t^{2}}{a}-\\frac{2t}{a^{2}}+\\frac{2}{a^{3}}\\right)-\\frac{2}{a^{3}}.\n$$\nHence,\n$$\n\\int_{0}^{t}\\exp(-(t-\\tau))\\,\\tau^{2}\\,d\\tau=\\exp(-t)\\,A(1,t)=\\big(t^{2}-2t+2\\big)-2\\exp(-t),\n$$\nand\n$$\n\\int_{0}^{t}\\exp(-2(t-\\tau))\\,\\tau^{2}\\,d\\tau=\\exp(-2t)\\,A(2,t)=\\left(\\frac{t^{2}}{2}-\\frac{t}{2}+\\frac{1}{4}\\right)-\\frac{1}{4}\\exp(-2t).\n$$\nTherefore,\n$$\ny_{\\text{base}}(t)=\\left(t^{2}-2t+2-2\\exp(-t)\\right)-\\left(\\frac{t^{2}}{2}-\\frac{t}{2}+\\frac{1}{4}-\\frac{1}{4}\\exp(-2t)\\right)\n=\\frac{1}{2}t^{2}-\\frac{3}{2}t+\\frac{7}{4}-2\\exp(-t)+\\frac{1}{4}\\exp(-2t).\n$$\nUsing the shift property established above, the complete response for all $t\\ge 0$ is\n$$\ny(t)=y_{\\text{base}}(t)-u(t-1)\\,y_{\\text{base}}(t-1),\n$$\nthat is,\n$$\ny(t)=\\left(\\frac{1}{2}t^{2}-\\frac{3}{2}t+\\frac{7}{4}-2\\exp(-t)+\\frac{1}{4}\\exp(-2t)\\right)\n-u(t-1)\\left(\\frac{1}{2}(t-1)^{2}-\\frac{3}{2}(t-1)+\\frac{7}{4}-2\\exp(-(t-1))+\\frac{1}{4}\\exp(-2(t-1))\\right).\n$$\nThis single analytical expression satisfies the ODE and the initial conditions and accounts for the change in input at $t=1$ via the Heaviside function.", "answer": "$$\\boxed{\\left(\\frac{1}{2}t^{2}-\\frac{3}{2}t+\\frac{7}{4}-2\\exp(-t)+\\frac{1}{4}\\exp(-2t)\\right)-u(t-1)\\left(\\frac{1}{2}(t-1)^{2}-\\frac{3}{2}(t-1)+\\frac{7}{4}-2\\exp(-(t-1))+\\frac{1}{4}\\exp(-2(t-1))\\right)}$$", "id": "2200483"}]}