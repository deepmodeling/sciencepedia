{"hands_on_practices": [{"introduction": "A key distinction of the Neumann problem is that a solution does not always exist. The prescribed flux at the boundary must be compatible with the source term inside the domain. This practice explores this fundamental compatibility condition [@problem_id:2120602], which arises directly from the divergence theorem and has a deep physical meaning related to conservation laws.", "problem": "Let $\\Omega$ be a rectangular region in the $xy$-plane defined by the inequalities $0 \\le x \\le L$ and $0 \\le y \\le W$, where $L$ and $W$ are positive constants representing the dimensions of the rectangle. Consider the two-dimensional Poisson equation in this region:\n$$ \\nabla^2 u = 1 $$\nThis equation describes a physical system, such as the steady-state temperature distribution $u(x, y)$ in a plate with a uniform internal heat source.\n\nThe behavior of the function $u(x, y)$ at the boundary $\\partial\\Omega$ of the rectangle is governed by a Neumann boundary condition:\n$$ \\frac{\\partial u}{\\partial n} = g(x, y) $$\nHere, $\\frac{\\partial u}{\\partial n}$ represents the derivative of $u$ in the direction of the outward unit normal vector $\\mathbf{n}$ to the boundary, and $g(x,y)$ is a given function defined on $\\partial\\Omega$.\n\nFor a well-posed problem, a solution $u(x, y)$ to this boundary value problem is not guaranteed to exist for an arbitrary choice of the function $g$. Physical or mathematical consistency requires that the boundary data $g$ must satisfy an integral compatibility condition. This condition takes the form of the equation:\n$$ \\oint_{\\partial\\Omega} g(x, y) \\, ds = K $$\nwhere the integral represents the line integral of $g$ taken over the entire perimeter of the rectangle.\n\nDetermine the value of the constant $K$ in terms of the given parameters $L$ and $W$.", "solution": "We are given the Poisson equation in a rectangle $\\Omega=\\{(x,y):0\\leq x\\leq L,\\;0\\leq y\\leq W\\}$:\n$$\n\\nabla^{2}u=1\\quad \\text{in }\\Omega,\n$$\nwith Neumann boundary condition on $\\partial\\Omega$:\n$$\n\\frac{\\partial u}{\\partial n}=g(x,y).\n$$\nTo obtain the compatibility condition, integrate the PDE over the domain $\\Omega$:\n$$\n\\int_{\\Omega}\\nabla^{2}u\\,dA=\\int_{\\Omega}1\\,dA.\n$$\nBy the divergence theorem (equivalently, Greenâ€™s theorem in the plane) applied to the vector field $\\nabla u$, we have\n$$\n\\int_{\\Omega}\\nabla^{2}u\\,dA=\\int_{\\partial\\Omega}\\nabla u\\cdot \\mathbf{n}\\,ds=\\int_{\\partial\\Omega}\\frac{\\partial u}{\\partial n}\\,ds.\n$$\nTherefore,\n$$\n\\int_{\\partial\\Omega}\\frac{\\partial u}{\\partial n}\\,ds=\\int_{\\Omega}1\\,dA.\n$$\nSince the Neumann data specify $\\frac{\\partial u}{\\partial n}=g(x,y)$ on $\\partial\\Omega$, the compatibility condition becomes\n$$\n\\oint_{\\partial\\Omega} g(x,y)\\,ds=\\int_{\\Omega}1\\,dA.\n$$\nThe right-hand side is the area of the rectangle:\n$$\n\\int_{\\Omega}1\\,dA=LW.\n$$\nHence the required constant is\n$$\nK=LW.\n$$", "answer": "$$\\boxed{L W}$$", "id": "2120602"}, {"introduction": "Once we know a solution can exist, the next step is to find it. The method of separation of variables is a powerful tool for solving such problems, where the solution is built from a series of eigenfunctions that naturally satisfy some of the boundary conditions. This exercise [@problem_id:2120598] will guide you through this process, showing how a cosine series is the perfect choice for handling homogeneous Neumann conditions.", "problem": "A thin, rectangular plate occupies the region in the Cartesian plane defined by $R = \\{(x,y) | 0 \\le x \\le a, 0 \\le y \\le b\\}$. The steady-state temperature distribution, $u(x,y)$, within this plate is governed by Laplace's equation:\n$$ \\frac{\\partial^2 u}{\\partial x^2} + \\frac{\\partial^2 u}{\\partial y^2} = 0 $$\nThe plate is subject to the following boundary conditions:\n1.  The sides at $x=0$ and $x=a$ are perfectly insulated, meaning the heat flux across them is zero: $\\frac{\\partial u}{\\partial x}(0,y) = 0$ for $0 < y < b$, and $\\frac{\\partial u}{\\partial x}(a,y) = 0$ for $0 < y < b$.\n2.  The bottom edge at $y=0$ is also perfectly insulated: $\\frac{\\partial u}{\\partial y}(x,0) = 0$ for $0 < x < a$.\n3.  On the top edge at $y=b$, a non-uniform heat flux is applied, resulting in a temperature gradient given by the piecewise function:\n$$ \\frac{\\partial u}{\\partial y}(x,b) = f(x) = \\begin{cases} 1 & \\text{for } 0 < x < a/2 \\\\ -1 & \\text{for } a/2 < x < a \\end{cases} $$\nThe solution $u(x,y)$ to this boundary value problem is unique up to an additive constant. Let the solution be $u(x,y)$. We define a quantity $A_1$ based on a weighted average of the temperature along the top edge of the plate:\n$$ A_1 = \\frac{1}{\\cosh\\left(\\frac{\\pi b}{a}\\right)} \\int_{0}^{a} u(x,b) \\cos\\left(\\frac{\\pi x}{a}\\right) dx $$\nDetermine the value of $A_1$. Express your answer as a closed-form analytic expression in terms of the parameters $a$ and $b$.", "solution": "We solve Laplace's equation with the given Neumann boundary conditions by separation of variables. Because the side boundaries at $x=0$ and $x=a$ are insulated, we impose $u_{x}(0,y)=u_{x}(a,y)=0$. The corresponding $x$-eigenfunctions satisfying $X''+\\lambda X=0$ with $X'(0)=X'(a)=0$ are $X_{n}(x)=\\cos\\left(\\frac{n\\pi x}{a}\\right)$ for $n=0,1,2,\\dots$, with eigenvalues $\\lambda_{n}=\\left(\\frac{n\\pi}{a}\\right)^{2}$.\n\nFor each $n\\geq 1$, the $y$-dependent factor must satisfy $Y_{n}''-\\lambda_{n}Y_{n}=0$, whose general solution is $Y_{n}(y)=A_{n}\\cosh\\left(\\frac{n\\pi y}{a}\\right)+B_{n}\\sinh\\left(\\frac{n\\pi y}{a}\\right)$. The bottom boundary is insulated, $u_{y}(x,0)=0$, which enforces $Y_{n}'(0)=0$ for each $n\\geq 1$. Since $Y_{n}'(y)=A_{n}\\frac{n\\pi}{a}\\sinh\\left(\\frac{n\\pi y}{a}\\right)+B_{n}\\frac{n\\pi}{a}\\cosh\\left(\\frac{n\\pi y}{a}\\right)$, the condition $Y_{n}'(0)=B_{n}\\frac{n\\pi}{a}=0$ implies $B_{n}=0$. The $n=0$ mode corresponds to a constant, which does not affect the prescribed normal derivatives and reflects the additive constant ambiguity of a Neumann problem.\n\nTherefore, the general solution consistent with the side and bottom Neumann conditions is\n$$\nu(x,y)=C_{0}+\\sum_{n=1}^{\\infty}a_{n}\\cos\\left(\\frac{n\\pi x}{a}\\right)\\cosh\\left(\\frac{n\\pi y}{a}\\right).\n$$\nImposing the top boundary condition $u_{y}(x,b)=f(x)$ gives\n$$\nu_{y}(x,b)=\\sum_{n=1}^{\\infty}a_{n}\\frac{n\\pi}{a}\\sinh\\left(\\frac{n\\pi b}{a}\\right)\\cos\\left(\\frac{n\\pi x}{a}\\right)=f(x).\n$$\nHence the cosine series coefficients of $f(x)$ on $[0,a]$ are\n$$\nc_{n}=\\frac{2}{a}\\int_{0}^{a}f(x)\\cos\\left(\\frac{n\\pi x}{a}\\right)\\,dx=\\;a_{n}\\frac{n\\pi}{a}\\sinh\\left(\\frac{n\\pi b}{a}\\right),\\quad n\\geq 1,\n$$\nso\n$$\na_{n}=c_{n}\\,\\frac{a}{n\\pi}\\,\\frac{1}{\\sinh\\left(\\frac{n\\pi b}{a}\\right)}.\n$$\nWe only need $n=1$ because $A_{1}$ projects $u(x,b)$ onto $\\cos\\left(\\frac{\\pi x}{a}\\right)$. Compute $c_{1}$ using $f(x)=1$ on $(0,a/2)$ and $f(x)=-1$ on $(a/2,a)$:\n$$\nc_{1}=\\frac{2}{a}\\left[\\int_{0}^{a/2}\\cos\\left(\\frac{\\pi x}{a}\\right)\\,dx+\\int_{a/2}^{a}\\left(-\\cos\\left(\\frac{\\pi x}{a}\\right)\\right)\\,dx\\right].\n$$\nEvaluate the integrals:\n$$\n\\int_{0}^{a/2}\\cos\\left(\\frac{\\pi x}{a}\\right)\\,dx=\\frac{a}{\\pi}\\sin\\left(\\frac{\\pi x}{a}\\right)\\Big|_{0}^{a/2}=\\frac{a}{\\pi},\n$$\n$$\n\\int_{a/2}^{a}\\cos\\left(\\frac{\\pi x}{a}\\right)\\,dx=\\frac{a}{\\pi}\\left[\\sin\\left(\\frac{\\pi x}{a}\\right)\\right]_{a/2}^{a}=\\frac{a}{\\pi}\\left(0-1\\right)=-\\frac{a}{\\pi},\n$$\nso\n$$\nc_{1}=\\frac{2}{a}\\left(\\frac{a}{\\pi}-\\left(-\\frac{a}{\\pi}\\right)\\right)=\\frac{4}{\\pi}.\n$$\nThus\n$$\na_{1}=c_{1}\\,\\frac{a}{\\pi}\\,\\frac{1}{\\sinh\\left(\\frac{\\pi b}{a}\\right)}=\\frac{4a}{\\pi^{2}\\sinh\\left(\\frac{\\pi b}{a}\\right)}.\n$$\nNow compute $A_{1}$. Using orthogonality,\n$$\n\\int_{0}^{a}u(x,b)\\cos\\left(\\frac{\\pi x}{a}\\right)\\,dx=\\int_{0}^{a}\\left(C_{0}+\\sum_{n=1}^{\\infty}a_{n}\\cos\\left(\\frac{n\\pi x}{a}\\right)\\cosh\\left(\\frac{n\\pi b}{a}\\right)\\right)\\cos\\left(\\frac{\\pi x}{a}\\right)\\,dx\n$$\n$$\n=a_{1}\\cosh\\left(\\frac{\\pi b}{a}\\right)\\int_{0}^{a}\\cos^{2}\\left(\\frac{\\pi x}{a}\\right)\\,dx=a_{1}\\cosh\\left(\\frac{\\pi b}{a}\\right)\\cdot\\frac{a}{2}.\n$$\nTherefore,\n$$\nA_{1}=\\frac{1}{\\cosh\\left(\\frac{\\pi b}{a}\\right)}\\int_{0}^{a}u(x,b)\\cos\\left(\\frac{\\pi x}{a}\\right)\\,dx=\\frac{a}{2}\\,a_{1}=\\frac{a}{2}\\cdot\\frac{4a}{\\pi^{2}\\sinh\\left(\\frac{\\pi b}{a}\\right)}=\\frac{2a^{2}}{\\pi^{2}\\sinh\\left(\\frac{\\pi b}{a}\\right)}.\n$$\nThis expression is in closed form and depends only on $a$ and $b$.", "answer": "$$\\boxed{\\frac{2 a^{2}}{\\pi^{2}\\sinh\\left(\\frac{\\pi b}{a}\\right)}}$$", "id": "2120598"}, {"introduction": "Analytical solutions are not always feasible, leading us to numerical methods like the finite difference method. This shift in perspective reveals how theoretical properties of the PDE translate into computational challenges. In this problem [@problem_id:2120573], you will discover how the fact that Neumann solutions are unique only up to an additive constant directly leads to a singular matrix in the numerical approximation, a crucial concept for anyone implementing a PDE solver.", "problem": "Consider the steady-state temperature distribution, $u(x,y)$, in a thin, square metallic plate defined by the domain $\\Omega = [0, 2] \\times [0, 2]$. The plate is perfectly insulated along all its edges, meaning there is no heat flux across the boundary. The temperature distribution is governed by the Poisson equation $-\\nabla^2 u = f(x,y)$, where $f(x,y)$ represents an internal heat source. The insulation implies a pure Neumann boundary condition, $\\frac{\\partial u}{\\partial n} = 0$, on the entire boundary $\\partial\\Omega$, where $\\frac{\\partial u}{\\partial n}$ is the normal derivative.\n\nWe wish to solve this problem numerically using a finite difference method. The domain is discretized into a uniform 3x3 grid of nodes, with coordinates $(i,j)$ where $i, j \\in \\{0, 1, 2\\}$. The grid spacing is $h=1$. This results in a set of 9 unknown temperature values, $u_{ij} = u(i,j)$. These unknowns are arranged into a single column vector $\\mathbf{u} \\in \\mathbb{R}^9$ using row-major ordering:\n$$\n\\mathbf{u} = (u_{00}, u_{01}, u_{02}, u_{10}, u_{11}, u_{12}, u_{20}, u_{21}, u_{22})^T\n$$\nThe differential equation is approximated by a system of linear equations of the form $A\\mathbf{u} = \\mathbf{b}$, where $A$ is a 9x9 matrix. The discrete operator corresponding to $-\\nabla^2 u$ is constructed as follows:\n\n1.  **Interior Node $(i,j)$ where $i,j \\in \\{1\\}$:** The standard 5-point stencil is used:\n    $$\n    -\\nabla^2 u \\approx \\frac{1}{h^2}(4u_{ij} - u_{i+1,j} - u_{i-1,j} - u_{i,j+1} - u_{i,j-1})\n    $$\n2.  **Boundary Nodes:** The Neumann condition $\\frac{\\partial u}{\\partial n} = 0$ is approximated using a centered difference on a 'ghost point' that lies one grid spacing outside the domain. For a point on the left boundary $(0, j)$, the condition is $\\frac{\\partial u}{\\partial x} = 0$, which is approximated as $\\frac{u_{1,j} - u_{-1,j}}{2h} = 0$, implying the ghost value $u_{-1,j} = u_{1,j}$. Substituting this into the 5-point stencil gives the modified operator for a left-edge node. Similar rules apply to the other three edges and the four corners (where two ghost points are needed). For example, at the corner $(0,0)$, we have $u_{-1,0}=u_{1,0}$ and $u_{0,-1}=u_{0,1}$.\n\nThe matrix $A$ represents this discrete Laplacian operator. It is a fundamental property of this numerical setup that the matrix $A$ is singular, meaning there exists a non-zero vector $\\mathbf{v}$ for which $A\\mathbf{v} = \\mathbf{0}$. This vector $\\mathbf{v}$ belongs to the null space of $A$.\n\nGiven the grid and node ordering specified above, which of the following vectors lies in the null space of the matrix $A$?\n\nA. $\\mathbf{v} = (1, 1, 1, 1, 1, 1, 1, 1, 1)^T$\n\nB. $\\mathbf{v} = (1, -1, 1, -1, 1, -1, 1, -1, 1)^T$\n\nC. $\\mathbf{v} = (0, 0, 0, 0, 1, 0, 0, 0, 0)^T$\n\nD. $\\mathbf{v} = (0, 0, 0, 1, 1, 1, 2, 2, 2)^T$\n\nE. $\\mathbf{v} = (0, 1, 2, 0, 1, 2, 0, 1, 2)^T$", "solution": "We consider the discrete operator for $-\\nabla^{2}$ on the $3 \\times 3$ grid with spacing $h$ and homogeneous Neumann boundary conditions implemented by ghost-point reflection. Define $L[u]_{ij}$ to be the discrete Laplacian applied at node $(i,j)$:\n- For the interior node $(1,1)$,\n$$\nL[u]_{11}=\\frac{1}{h^{2}}\\left(4u_{11}-u_{21}-u_{01}-u_{12}-u_{10}\\right).\n$$\n- For a left-edge node $(0,j)$, using $u_{-1,j}=u_{1,j}$,\n$$\nL[u]_{0j}=\\frac{1}{h^{2}}\\left(4u_{0j}-u_{1j}-u_{-1,j}-u_{0,j+1}-u_{0,j-1}\\right)=\\frac{1}{h^{2}}\\left(4u_{0j}-2u_{1j}-u_{0,j+1}-u_{0,j-1}\\right).\n$$\n- For a bottom-edge node $(i,0)$, using $u_{i,-1}=u_{i,1}$,\n$$\nL[u]_{i0}=\\frac{1}{h^{2}}\\left(4u_{i0}-u_{i+1,0}-u_{i-1,0}-u_{i,1}-u_{i,-1}\\right)=\\frac{1}{h^{2}}\\left(4u_{i0}-u_{i+1,0}-u_{i-1,0}-2u_{i,1}\\right).\n$$\n- For the corner $(0,0)$, using $u_{-1,0}=u_{1,0}$ and $u_{0,-1}=u_{0,1}$,\n$$\nL[u]_{00}=\\frac{1}{h^{2}}\\left(4u_{00}-u_{10}-u_{-1,0}-u_{01}-u_{0,-1}\\right)=\\frac{1}{h^{2}}\\left(4u_{00}-2u_{10}-2u_{01}\\right).\n$$\nAnalogous formulas hold for the other edges and corners by symmetry.\n\nTo find a vector in the null space, we test the constant grid function $u_{ij}=c$ for all $(i,j)$. Substituting $u_{ij}=c$ into each case:\n- Interior: $L[u]_{11}=\\frac{1}{h^{2}}\\left(4c-c-c-c-c\\right)=0$.\n- Left edge (and similarly right edge): $L[u]_{0j}=\\frac{1}{h^{2}}\\left(4c-2c-c-c\\right)=0$.\n- Bottom edge (and similarly top edge): $L[u]_{i0}=\\frac{1}{h^{2}}\\left(4c-c-c-2c\\right)=0$.\n- Corner $(0,0)$ (and the other three corners): $L[u]_{00}=\\frac{1}{h^{2}}\\left(4c-2c-2c\\right)=0$.\n\nHence the constant vector is mapped to the zero vector by the matrix $A$ representing $L$, so it lies in the null space. Among the given options, this is option A, $\\mathbf{v}=(1,1,1,1,1,1,1,1,1)^{T}$.\n\nFor completeness, note that nonconstant patterns such as alternating signs (option B), a single central spike (option C), and linear ramps in $i$ or $j$ (options D and E) do not satisfy $L[u]=0$ at the Neumann boundaries with the ghost-point reflection; for instance, at a left-edge node $(0,j)$, a linear ramp $u_{ij}=i$ gives $L[u]_{0j}=\\frac{1}{h^{2}}(-2)\\neq 0$, and alternating signs at the interior $(1,1)$ give $L[u]_{11}=\\frac{1}{h^{2}}(8)\\neq 0$. Therefore, the only listed null vector is the constant one.", "answer": "$$\\boxed{A}$$", "id": "2120573"}]}