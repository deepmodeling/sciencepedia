{"hands_on_practices": [{"introduction": "The Galerkin method provides a powerful framework for finding approximate solutions to differential equations. This first practice problem serves as a perfect introduction, where we approximate the temperature in a rod with an internal heat source [@problem_id:2150034]. By choosing a single trigonometric basis function that respects the boundary conditions, we will transform a complex boundary value problem into a single algebraic equation for an unknown coefficient, illustrating the fundamental principle of minimizing the error in a weighted sense.", "problem": "Consider a one-dimensional rod of length $\\pi$ with its ends at $x=0$ and $x=\\pi$ maintained at a constant temperature of zero. The rod is subjected to an internal heat source that varies linearly along its length, described by a source density function $f(x) = x$. The steady-state temperature distribution $u(x)$ in the rod is governed by the boundary value problem:\n$$ -u''(x) = x, \\quad \\text{for } x \\in (0, \\pi) $$\nwith boundary conditions:\n$$ u(0) = 0, \\quad u(\\pi) = 0 $$\nUsing the Galerkin method, find an approximate solution $\\tilde{u}(x)$ to this problem. For the approximation, use a single basis function that is the simplest non-trivial trigonometric function satisfying the given boundary conditions. Provide the expression for the approximate solution $\\tilde{u}(x)$.", "solution": "We seek a Galerkin approximation for the boundary value problem\n$$\n-u''(x)=x \\quad \\text{on } (0,\\pi), \\quad u(0)=0,\\; u(\\pi)=0.\n$$\nFor homogeneous Dirichlet boundary conditions, the weak form is: find $u \\in H_{0}^{1}(0,\\pi)$ such that for all $v \\in H_{0}^{1}(0,\\pi)$,\n$$\n\\int_{0}^{\\pi} u'(x)\\,v'(x)\\,dx=\\int_{0}^{\\pi} x\\,v(x)\\,dx.\n$$\nWe choose a one-dimensional trial and test space spanned by the simplest non-trivial trigonometric function satisfying the boundary conditions, namely $\\sin(x)$. Thus let\n$$\n\\tilde{u}(x)=a\\,\\sin(x),\n$$\nand take $v(x)=\\sin(x)$ as the test function. Then $\\tilde{u}'(x)=a\\cos(x)$ and $v'(x)=\\cos(x)$, so the Galerkin equation becomes\n$$\n\\int_{0}^{\\pi} \\tilde{u}'(x)\\,v'(x)\\,dx=\\int_{0}^{\\pi} x\\,v(x)\\,dx\n\\quad\\Longrightarrow\\quad\na\\int_{0}^{\\pi}\\cos^{2}(x)\\,dx=\\int_{0}^{\\pi} x\\,\\sin(x)\\,dx.\n$$\nEvaluate the integrals explicitly. Using $\\cos^{2}(x)=\\frac{1}{2}\\left(1+\\cos(2x)\\right)$,\n$$\n\\int_{0}^{\\pi}\\cos^{2}(x)\\,dx=\\left[\\frac{x}{2}+\\frac{\\sin(2x)}{4}\\right]_{0}^{\\pi}=\\frac{\\pi}{2}.\n$$\nFor the right-hand side, integrate by parts with $u=x$, $dv=\\sin(x)\\,dx$, so $du=dx$, $v=-\\cos(x)$:\n$$\n\\int_{0}^{\\pi} x\\,\\sin(x)\\,dx=\\left[-x\\cos(x)\\right]_{0}^{\\pi}+\\int_{0}^{\\pi}\\cos(x)\\,dx=\\pi+0=\\pi.\n$$\nThus\n$$\na\\cdot\\frac{\\pi}{2}=\\pi \\quad\\Longrightarrow\\quad a=2.\n$$\nTherefore, the one-term Galerkin approximation is\n$$\n\\tilde{u}(x)=2\\sin(x).\n$$", "answer": "$$\\boxed{2\\sin(x)}$$", "id": "2150034"}, {"introduction": "While trigonometric functions are elegant, many real-world applications, especially in the Finite Element Method, rely on piecewise polynomial basis functions. This exercise introduces the \"hat\" function, a simple yet fundamental example of a piecewise linear basis function [@problem_id:2149993]. Working through this problem will give you hands-on experience with integrating piecewise functions and their derivatives, a crucial skill for understanding modern numerical solvers.", "problem": "Consider the two-point boundary value problem defined by the differential equation\n$$ -\\frac{d^2u}{dx^2} = 1 $$\non the interval $x \\in [0, 1]$, with the boundary conditions $u(0) = 0$ and $u(1) = 0$.\n\nWe seek an approximate solution to this problem using the Galerkin method. The approximate solution, denoted $u_h(x)$, is assumed to be in the space spanned by a single basis function $\\phi(x)$. This basis function, often called a \"hat function,\" is a piecewise linear function defined as:\n$$\n\\phi(x) = \\begin{cases}\n2x & \\text{for } 0 \\le x \\le 1/2 \\\\\n2(1-x) & \\text{for } 1/2 < x \\le 1\n\\end{cases}\n$$\nThe approximate solution is of the form $u_h(x) = c \\cdot \\phi(x)$, where $c$ is a constant coefficient to be determined.\n\nDetermine the approximate solution $u_h(x)$. The answer should be a fully specified, piecewise function of $x$.", "solution": "We solve the boundary value problem by the Galerkin method. The weak form for $-u''=1$ with homogeneous Dirichlet boundary conditions is: find $u \\in V$ with $V=\\{v \\in H_{0}^{1}(0,1)\\}$ such that\n$$\n\\int_{0}^{1} u'(x)\\,v'(x)\\,dx=\\int_{0}^{1} 1\\cdot v(x)\\,dx\n$$\nfor all $v \\in V$. Using the one-dimensional trial space spanned by $\\phi$, we take $u_{h}(x)=c\\,\\phi(x)$ and test with $v=\\phi$. This gives the Galerkin equation\n$$\n\\int_{0}^{1} (c\\,\\phi'(x))\\,\\phi'(x)\\,dx=\\int_{0}^{1} \\phi(x)\\,dx,\n$$\nwhich simplifies to\n$$\nc\\int_{0}^{1} \\left(\\phi'(x)\\right)^{2}\\,dx=\\int_{0}^{1} \\phi(x)\\,dx.\n$$\nThe basis function is\n$$\n\\phi(x)=\\begin{cases}\n2x & 0\\le x\\le \\frac{1}{2} \\\\\n2(1-x) & \\frac{1}{2}<x\\le 1\n\\end{cases}\n$$\nso its derivative is\n$$\n\\phi'(x)=\\begin{cases}\n2 & 0<x<\\frac{1}{2} \\\\\n-2 & \\frac{1}{2}<x<1\n\\end{cases}\n$$\nand hence $\\left(\\phi'(x)\\right)^{2}=4$ almost everywhere on $(0,1)$. Therefore,\n$$\n\\int_{0}^{1} \\left(\\phi'(x)\\right)^{2}\\,dx=\\int_{0}^{1} 4\\,dx=4.\n$$\nNext,\n$$\n\\int_{0}^{1} \\phi(x)\\,dx=\\int_{0}^{\\frac{1}{2}} 2x\\,dx+\\int_{\\frac{1}{2}}^{1} 2(1-x)\\,dx=\\left[x^{2}\\right]_{0}^{\\frac{1}{2}}+\\left[2x-x^{2}\\right]_{\\frac{1}{2}}^{1}=\\frac{1}{4}+\\frac{1}{4}=\\frac{1}{2}.\n$$\nThus $c$ satisfies\n$$\nc\\cdot 4=\\frac{1}{2}\\quad\\Rightarrow\\quad c=\\frac{1}{8}.\n$$\nThe approximate solution is\n$$\nu_{h}(x)=c\\,\\phi(x)=\\frac{1}{8}\\,\\phi(x)=\\begin{cases}\n\\frac{1}{8}\\cdot 2x=\\frac{x}{4} & 0\\le x\\le \\frac{1}{2} \\\\\n\\frac{1}{8}\\cdot 2(1-x)=\\frac{1-x}{4} & \\frac{1}{2}<x\\le 1.\n\\end{cases}\n$$", "answer": "$$\\boxed{\\begin{cases}\n\\frac{x}{4} & 0\\le x\\le \\frac{1}{2} \\\\\n\\frac{1-x}{4} & \\frac{1}{2}<x\\le 1\n\\end{cases}}$$", "id": "2149993"}, {"introduction": "A single basis function provides a starting point, but the true power of approximation methods is revealed when we combine multiple functions to capture more complex solution behaviors. In this problem, we will improve our approximation by using a two-term trigonometric expansion [@problem_id:2149992]. This naturally leads from solving a single equation to a system of linear equations, demonstrating how the Galerkin method systematically converts a differential equation into a matrix problem that is readily solvable.", "problem": "Consider the second-order ordinary differential equation\n$$\n-u''(x) + u(x) = x\n$$\non the interval $x \\in (0, 1)$, subject to the homogeneous boundary conditions $u(0) = 0$ and $u(1) = 0$.\n\nWe seek an approximate solution to this boundary value problem of the form\n$$\nu_2(x) = c_1 \\sin(\\pi x) + c_2 \\sin(2\\pi x).\n$$\nThe unknown coefficients $c_1$ and $c_2$ are determined using a weighted residual method. Specifically, we define a residual function $R(x) = -u_2''(x) + u_2(x) - x$, which measures the error of the approximation. The coefficients are found by enforcing the condition that the residual is orthogonal to the basis functions used in the approximation. This leads to the following system of two equations:\n$$\n\\int_0^1 R(x) \\sin(\\pi x) dx = 0\n$$\n$$\n\\int_0^1 R(x) \\sin(2\\pi x) dx = 0\n$$\nDetermine the approximate solution $u_2(x)$ by finding the coefficients $c_1$ and $c_2$. Present your final answer as an analytical expression for $u_2(x)$.", "solution": "We approximate the solution by $u_{2}(x)=c_{1}\\sin(\\pi x)+c_{2}\\sin(2\\pi x)$, which satisfies the homogeneous boundary conditions at $x=0$ and $x=1$. The residual is defined by\n$$\nR(x)=-u_{2}''(x)+u_{2}(x)-x.\n$$\nCompute $u_{2}''(x)$ using $d^{2}/dx^{2}\\sin(k\\pi x)=-(k\\pi)^{2}\\sin(k\\pi x)$, so\n$$\n-u_{2}''(x)+u_{2}(x)=\\left((\\pi^{2}+1)c_{1}\\sin(\\pi x)+(4\\pi^{2}+1)c_{2}\\sin(2\\pi x)\\right).\n$$\nThus\n$$\nR(x)=(\\pi^{2}+1)c_{1}\\sin(\\pi x)+\\left(4\\pi^{2}+1\\right)c_{2}\\sin(2\\pi x)-x.\n$$\nThe weighted residual conditions with weights $\\sin(\\pi x)$ and $\\sin(2\\pi x)$ give\n$$\n\\int_{0}^{1}R(x)\\sin(\\pi x)\\,dx=0,\\qquad \\int_{0}^{1}R(x)\\sin(2\\pi x)\\,dx=0.\n$$\nUsing orthogonality $\\int_{0}^{1}\\sin(m\\pi x)\\sin(n\\pi x)\\,dx=0$ for $m\\neq n$ and $\\int_{0}^{1}\\sin^{2}(n\\pi x)\\,dx=\\frac{1}{2}$, these reduce to\n$$\n(\\pi^{2}+1)c_{1}\\int_{0}^{1}\\sin^{2}(\\pi x)\\,dx-\\int_{0}^{1}x\\sin(\\pi x)\\,dx=0,\n$$\n$$\n(4\\pi^{2}+1)c_{2}\\int_{0}^{1}\\sin^{2}(2\\pi x)\\,dx-\\int_{0}^{1}x\\sin(2\\pi x)\\,dx=0.\n$$\nHence\n$$\n\\frac{\\pi^{2}+1}{2}\\,c_{1}=I_{1},\\qquad \\frac{4\\pi^{2}+1}{2}\\,c_{2}=I_{2},\n$$\nwhere $I_{n}=\\int_{0}^{1}x\\sin(n\\pi x)\\,dx$. Compute $I_{n}$ by integration by parts: with $u=x$, $dv=\\sin(n\\pi x)\\,dx$ so $du=dx$, $v=-\\cos(n\\pi x)/(n\\pi)$,\n$$\nI_{n}=\\left[-\\frac{x\\cos(n\\pi x)}{n\\pi}\\right]_{0}^{1}+\\int_{0}^{1}\\frac{\\cos(n\\pi x)}{n\\pi}\\,dx\n=-\\frac{\\cos(n\\pi)}{n\\pi}+\\left[\\frac{\\sin(n\\pi x)}{(n\\pi)^{2}}\\right]_{0}^{1}.\n$$\nSince $\\sin(n\\pi)=0$ and $\\cos(n\\pi)=(-1)^{n}$, it follows that\n$$\nI_{n}=-\\frac{(-1)^{n}}{n\\pi}.\n$$\nTherefore,\n$$\nI_{1}=\\frac{1}{\\pi},\\qquad I_{2}=-\\frac{1}{2\\pi}.\n$$\nSolving for $c_{1}$ and $c_{2}$ gives\n$$\nc_{1}=\\frac{2I_{1}}{\\pi^{2}+1}=\\frac{2}{\\pi(\\pi^{2}+1)},\\qquad\nc_{2}=\\frac{2I_{2}}{4\\pi^{2}+1}=-\\frac{1}{\\pi(4\\pi^{2}+1)}.\n$$\nThus the approximate solution is\n$$\nu_{2}(x)=\\frac{2}{\\pi(\\pi^{2}+1)}\\sin(\\pi x)-\\frac{1}{\\pi(4\\pi^{2}+1)}\\sin(2\\pi x).\n$$", "answer": "$$\\boxed{\\frac{2}{\\pi(\\pi^{2}+1)}\\sin(\\pi x)-\\frac{1}{\\pi(4\\pi^{2}+1)}\\sin(2\\pi x)}$$", "id": "2149992"}]}