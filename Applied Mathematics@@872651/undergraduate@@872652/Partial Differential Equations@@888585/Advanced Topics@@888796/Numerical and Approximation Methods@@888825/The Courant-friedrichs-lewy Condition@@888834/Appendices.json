{"hands_on_practices": [{"introduction": "To begin, we'll tackle the most fundamental application of the CFL condition. This exercise [@problem_id:2139558] involves the one-dimensional linear advection equation, a cornerstone model for transport phenomena. You will calculate the appropriate time step for a simulation, learning to balance the grid resolution, the physical speed of the wave, and the Courant number to ensure a stable numerical solution.", "problem": "A team of computational scientists is simulating the propagation of a signal along a one-dimensional transmission line. The behavior of the signal's voltage, $u(x, t)$, is modeled by the linear advection equation:\n$$ \\frac{\\partial u}{\\partial t} + v \\frac{\\partial u}{\\partial x} = 0 $$\nwhere $v$ is the constant propagation speed of the signal.\n\nThe simulation uses a finite difference scheme on a grid with a uniform spatial step size of $\\Delta x$. The chosen numerical method is known to be stable only if the Courant-Friedrichs-Lewy (CFL) condition is satisfied. The Courant number, $\\sigma$, is defined as $\\sigma = |v| \\frac{\\Delta t}{\\Delta x}$, where $\\Delta t$ is the time step.\n\nFor this specific simulation, the propagation speed is $v = 2.5 \\times 10^8$ m/s, and the spatial step is $\\Delta x = 1.25$ cm. To ensure high accuracy and avoid numerical oscillations, the team decides to operate at a Courant number of exactly $\\sigma = 0.75$.\n\nWhat is the required time step, $\\Delta t$, for this simulation? Express your answer in nanoseconds (ns), rounded to two significant figures.", "solution": "We use the Courant number definition for the linear advection equation discretization:\n$$\n\\sigma=\\frac{|v|\\,\\Delta t}{\\Delta x}.\n$$\nSolving for the time step gives\n$$\n\\Delta t=\\frac{\\sigma\\,\\Delta x}{|v|}.\n$$\nSubstitute the given values, converting the spatial step to meters: $\\Delta x=1.25\\times 10^{-2}\\ \\text{m}$, $|v|=2.5\\times 10^{8}\\ \\text{m/s}$, and $\\sigma=0.75$:\n$$\n\\Delta t=\\frac{0.75\\,(1.25\\times 10^{-2})}{2.5\\times 10^{8}}\\ \\text{s}.\n$$\nCompute the numerical factor:\n$$\n\\Delta t=\\frac{0.9375\\times 10^{-2}}{2.5\\times 10^{8}}\\ \\text{s}\n=\\left(\\frac{0.9375}{2.5}\\right)\\times 10^{-10}\\ \\text{s}\n=0.375\\times 10^{-10}\\ \\text{s}\n=3.75\\times 10^{-11}\\ \\text{s}.\n$$\nConvert to nanoseconds using $1\\ \\text{ns}=10^{-9}\\ \\text{s}$:\n$$\n\\Delta t=3.75\\times 10^{-11}\\ \\text{s}=3.75\\times 10^{-2}\\ \\text{ns}=0.0375\\ \\text{ns}.\n$$\nRounding to two significant figures yields $0.038\\ \\text{ns}$.", "answer": "$$\\boxed{0.038}$$", "id": "2139558"}, {"introduction": "Now let's expand our view to a different but equally important equation: the one-dimensional wave equation, which models everything from vibrating strings to voltage pulses in cables. While the governing PDE is different, the CFL condition remains the guiding principle for stability [@problem_id:2139541]. This practice challenges you to determine the absolute maximum time step, a common task for maximizing computational efficiency without tipping the simulation into instability.", "problem": "An engineer is developing a numerical simulation for voltage pulse propagation along a specialized coaxial cable. In a simplified one-dimensional model, the voltage $u(x, t)$ at position $x$ and time $t$ is governed by the wave equation:\n$$ \\frac{\\partial^2 u}{\\partial t^2} = 16 \\frac{\\partial^2 u}{\\partial x^2} $$\nwhere $x$ is in meters and $t$ is in seconds.\n\nThe engineer decides to use a standard explicit finite difference scheme to solve this equation numerically. The spatial grid for the simulation is set up with a uniform spacing of $\\Delta x = 0.05$ meters. To ensure the stability of the numerical solution, the time step $\\Delta t$ must be chosen carefully.\n\nWhat is the maximum possible time step $\\Delta t$ that can be used while satisfying the Courant-Friedrichs-Lewy (CFL) stability condition for this scheme? Express your answer in seconds, rounded to three significant figures.", "solution": "We start from the one-dimensional wave equation written in the standard form\n$$\n\\frac{\\partial^{2} u}{\\partial t^{2}}=c^{2}\\frac{\\partial^{2} u}{\\partial x^{2}},\n$$\nwhere, by comparison with the given equation $\\frac{\\partial^{2} u}{\\partial t^{2}}=16\\,\\frac{\\partial^{2} u}{\\partial x^{2}}$, the wave speed is $c=4$.\n\nA standard explicit second-order finite difference discretization (centered in time and space) on a uniform grid with spacing $\\Delta x$ and time step $\\Delta t$ is\n$$\n\\frac{u_{j}^{n+1}-2u_{j}^{n}+u_{j}^{n-1}}{(\\Delta t)^{2}}=c^{2}\\frac{u_{j+1}^{n}-2u_{j}^{n}+u_{j-1}^{n}}{(\\Delta x)^{2}}.\n$$\nRearranging gives the update formula\n$$\nu_{j}^{n+1}=2u_{j}^{n}-u_{j}^{n-1}+\\sigma^{2}\\left(u_{j+1}^{n}-2u_{j}^{n}+u_{j-1}^{n}\\right),\n$$\nwhere the Courant number is defined by\n$$\n\\sigma=\\frac{c\\,\\Delta t}{\\Delta x}.\n$$\n\nTo determine the stability constraint, perform a von Neumann analysis by seeking Fourier mode solutions of the form $u_{j}^{n}=G^{n}e^{i k j\\Delta x}$, where $G$ is the amplification factor and $k$ is the wavenumber. Substituting into the update yields\n$$\nG-2+G^{-1}=\\sigma^{2}\\left(e^{i k \\Delta x}-2+e^{-i k \\Delta x}\\right)=-4\\sigma^{2}\\sin^{2}\\left(\\frac{k\\Delta x}{2}\\right).\n$$\nEquivalently,\n$$\nG+G^{-1}=2\\left[1-2\\sigma^{2}\\sin^{2}\\left(\\frac{k\\Delta x}{2}\\right)\\right].\n$$\nThis implies the dispersion relation\n$$\n\\cos(\\omega\\Delta t)=1-2\\sigma^{2}\\sin^{2}\\left(\\frac{k\\Delta x}{2}\\right),\n$$\nso that stability, which requires $|G|=1$ for all modes, holds provided the right-hand side lies in the interval $[-1,1]$ for all $k$. Since $\\sin^{2}(\\cdot)\\in[0,1]$, the minimum of the right-hand side over all $k$ is $1-2\\sigma^{2}$. Requiring $1-2\\sigma^{2}\\geq -1$ gives\n$$\n\\sigma^{2}\\leq 1 \\quad\\Longleftrightarrow\\quad \\sigma\\leq 1.\n$$\nTherefore, the Courant-Friedrichs-Lewy stability condition for this explicit scheme is\n$$\n\\frac{c\\,\\Delta t}{\\Delta x}\\leq 1 \\quad\\Longrightarrow\\quad \\Delta t\\leq \\frac{\\Delta x}{c}.\n$$\n\nFor the given data, $\\Delta x=0.05$ and $c=4$, hence the maximum stable time step is\n$$\n\\Delta t_{\\max}=\\frac{0.05}{4}=0.0125.\n$$\nRounded to three significant figures, this value is $0.0125$ seconds.", "answer": "$$\\boxed{0.0125}$$", "id": "2139541"}, {"introduction": "Our final practice moves beyond calculation to test your conceptual understanding of the physics behind numerical stability. For hyperbolic equations like the advection equation, information travels in a specific direction. This exercise [@problem_id:2139542] explores how the numerical scheme itself must be designed to respect this direction of information flow, a crucial concept known as \"upwinding\" that is central to the CFL condition.", "problem": "Consider the one-dimensional linear advection equation, $u_t + c u_x = 0$, which describes a wave propagating with constant speed $c$. We wish to solve this equation numerically on a grid with uniform spatial step $\\Delta x$ and time step $\\Delta t$. Let $u_j^n$ denote the numerical approximation of the solution $u(x, t)$ at the grid point $x_j = j \\Delta x$ and time $t_n = n \\Delta t$.\n\nFor a positive wave speed, $c > 0$, a common and stable numerical method is the first-order upwind scheme, which uses a forward difference for the time derivative and a backward difference for the spatial derivative. This scheme is given by:\n$$\n\\frac{u_j^{n+1} - u_j^n}{\\Delta t} + c \\frac{u_j^n - u_{j-1}^n}{\\Delta x} = 0\n$$\nThis scheme is stable provided the Courant-Friedrichs-Lewy (CFL) condition, $0 \\le \\frac{c \\Delta t}{\\Delta x} \\le 1$, is satisfied.\n\nNow, consider the case where the wave speed is a negative constant, $c < 0$. The physical wave now propagates from right to left (in the direction of decreasing $x$). To maintain stability, the finite difference scheme must be modified to respect this change in the direction of information flow.\n\nWhich of the following discrete schemes provides a stable approximation for the advection equation with $c < 0$, subject to an appropriate CFL condition?\n\nA. $\\frac{u_j^{n+1} - u_j^n}{\\Delta t} + c \\frac{u_j^n - u_{j-1}^n}{\\Delta x} = 0$\n\nB. $\\frac{u_j^{n+1} - u_j^n}{\\Delta t} + c \\frac{u_{j+1}^n - u_j^n}{\\Delta x} = 0$\n\nC. $\\frac{u_j^{n+1} - u_j^n}{\\Delta t} + c \\frac{u_{j+1}^n - u_{j-1}^n}{2\\Delta x} = 0$\n\nD. $\\frac{u_j^{n+1} - u_j^n}{\\Delta t} + c \\frac{u_{j+1}^{n+1} - u_j^{n+1}}{\\Delta x} = 0$\n\nE. $\\frac{u_j^{n+1} - u_j^{n-1}}{2\\Delta t} + c \\frac{u_j^n - u_{j-1}^n}{\\Delta x} = 0$", "solution": "We consider the linear advection equation $u_{t} + c u_{x} = 0$ with constant speed $c$. For $c < 0$, characteristics propagate from right to left, so the numerical scheme must use information from the upwind (right) side to remain stable. This leads to choosing a forward spatial difference (increasing $x$) at the current time level $n$.\n\nIntroduce the Courant number $\\sigma = \\dfrac{c \\Delta t}{\\Delta x}$. For a candidate scheme\n$$\n\\frac{u_{j}^{n+1} - u_{j}^{n}}{\\Delta t} + c \\frac{u_{j+1}^{n} - u_{j}^{n}}{\\Delta x} = 0,\n$$\nwhich is option B, we perform a von Neumann analysis. Assume a Fourier mode $u_{j}^{n} = \\hat{u}^{n} e^{i \\phi j}$, where $\\phi \\in \\mathbb{R}$. Substituting into the scheme gives\n$$\n\\hat{u}^{n+1} e^{i \\phi j} = \\hat{u}^{n} e^{i \\phi j} - \\sigma \\left(\\hat{u}^{n} e^{i \\phi (j+1)} - \\hat{u}^{n} e^{i \\phi j}\\right),\n$$\nso the amplification factor $G$ defined by $\\hat{u}^{n+1} = G \\hat{u}^{n}$ is\n$$\nG = 1 - \\sigma \\left(e^{i \\phi} - 1\\right) = (1 + \\sigma) - \\sigma e^{i \\phi}.\n$$\nThen\n$$\n|G|^{2} = \\left((1+\\sigma) - \\sigma \\cos \\phi\\right)^{2} + \\left(\\sigma \\sin \\phi\\right)^{2}\n= (1+\\sigma)^{2} - 2 \\sigma (1+\\sigma) \\cos \\phi + \\sigma^{2}.\n$$\nFor $c < 0$ we have $\\sigma \\leq 0$. If $-1 \\leq \\sigma \\leq 0$, the coefficient $-2 \\sigma (1+\\sigma) \\geq 0$, hence the maximum of $|G|^{2}$ over $\\phi$ occurs at $\\cos \\phi = -1$, giving\n$$\n\\max_{\\phi} |G|^{2} = (1+\\sigma)^{2} + 2 \\sigma (1+\\sigma) + \\sigma^{2} = (1 + 2 \\sigma)^{2} \\leq 1,\n$$\nwhich holds precisely for $-1 \\leq \\sigma \\leq 0$. Therefore option B is stable under the CFL condition $-1 \\leq \\dfrac{c \\Delta t}{\\Delta x} \\leq 0$.\n\nTo exclude the other options:\n\n- Option A (backward difference in space): the scheme is\n$$\n\\frac{u_{j}^{n+1} - u_{j}^{n}}{\\Delta t} + c \\frac{u_{j}^{n} - u_{j-1}^{n}}{\\Delta x} = 0.\n$$\nFourier analysis yields $G = (1 - \\sigma) + \\sigma e^{-i \\phi}$ and\n$$\n|G|^{2} = (1 - \\sigma)^{2} - 2 \\sigma (1 - \\sigma) \\cos \\phi + \\sigma^{2}.\n$$\nFor $\\sigma < 0$, the coefficient $-2 \\sigma (1 - \\sigma) > 0$, so the maximum is at $\\cos \\phi = -1$, giving\n$$\n\\max_{\\phi} |G|^{2} = (1 - \\sigma)^{2} + 2 \\sigma (1 - \\sigma) + \\sigma^{2} = (1 - 2 \\sigma)^{2} > 1,\n$$\nhence unstable for $c < 0$.\n\n- Option C (FTCS with centered space): the scheme is\n$$\n\\frac{u_{j}^{n+1} - u_{j}^{n}}{\\Delta t} + c \\frac{u_{j+1}^{n} - u_{j-1}^{n}}{2 \\Delta x} = 0,\n$$\ngiving $G = 1 - i \\sigma \\sin \\phi$ and\n$$\n|G|^{2} = 1 + \\sigma^{2} \\sin^{2} \\phi > 1\n$$\nfor any nonzero $\\sigma$ and $\\phi \\not\\in \\pi \\mathbb{Z}$; thus unconditionally unstable.\n\n- Option D (implicit forward difference at time level $n+1$): the scheme is\n$$\n\\frac{u_{j}^{n+1} - u_{j}^{n}}{\\Delta t} + c \\frac{u_{j+1}^{n+1} - u_{j}^{n+1}}{\\Delta x} = 0,\n$$\nwhich leads to\n$$\nG = \\frac{1}{1 + \\sigma \\left(e^{i \\phi} - 1\\right)}.\n$$\nFor $\\sigma < 0$, one finds\n$$\n\\min_{\\phi} \\left|1 + \\sigma \\left(e^{i \\phi} - 1\\right)\\right|^{2} = 1,\n$$\nso $|G| \\leq 1$ without a CFL restriction. While this is stable, it is implicit and does not correspond to the standard explicit upwind choice requested when emphasizing a CFL condition.\n\n- Option E (leapfrog in time with one-sided space): the recurrence becomes\n$$\nu_{j}^{n+1} = u_{j}^{n-1} - 2 \\sigma \\left(u_{j}^{n} - u_{j-1}^{n}\\right),\n$$\nwhich yields the amplification polynomial\n$$\nG^{2} + 2 \\sigma \\left(1 - e^{-i \\phi}\\right) G - 1 = 0.\n$$\nThe product of roots is $-1$, so the two roots cannot both have magnitude at most $1$ unless in degenerate cases; thus this is unstable.\n\nTherefore, the explicit upwind scheme that is stable for $c < 0$ under the appropriate CFL condition is option B.", "answer": "$$\\boxed{B}$$", "id": "2139542"}]}