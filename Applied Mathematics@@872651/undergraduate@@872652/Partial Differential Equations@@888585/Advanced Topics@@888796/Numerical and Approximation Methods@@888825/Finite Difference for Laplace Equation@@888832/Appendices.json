{"hands_on_practices": [{"introduction": "The first step in applying the finite difference method is to transform the continuous partial differential equation into a system of algebraic equations. This practice will guide you through setting up the complete linear system $AU=b$ for a square domain with specified boundary temperatures [@problem_id:2102015]. By focusing on the right-hand side vector $b$, you'll see how Dirichlet boundary conditions directly influence the solution.", "problem": "Consider the steady-state heat distribution on a square plate, described by the two-dimensional Laplace's equation, $\\frac{\\partial^2 u}{\\partial x^2} + \\frac{\\partial^2 u}{\\partial y^2} = 0$. The plate is represented by the unit square domain $\\Omega = [0, 1] \\times [0, 1]$. The temperature $u(x,y)$ on the boundary of the domain is prescribed by the following Dirichlet conditions:\n- $u(x, 0) = x$ for $0 \\le x \\le 1$ (bottom edge)\n- $u(x, 1) = 1$ for $0 \\le x \\le 1$ (top edge)\n- $u(0, y) = y$ for $0 \\le y \\le 1$ (left edge)\n- $u(1, y) = 0$ for $0 \\le y \\le 1$ (right edge)\n\nTo find an approximate solution for $u(x,y)$ inside the domain, we employ the finite difference method. The domain is discretized using a uniform grid with a step size of $h = 1/3$ in both the $x$ and $y$ directions. This discretization results in a $2 \\times 2$ grid of four interior points.\n\nLet the approximation of the temperature $u(x_i, y_j)$ at a grid point $(x_i, y_j) = (ih, jh)$ be denoted by $u_{i,j}$. Applying the standard five-point stencil for the Laplacian at each of the four interior grid points results in a system of linear equations of the form $AU = b$. The vector of unknowns, $U$, contains the temperature approximations at the four interior points. The unknowns are ordered lexicographically (row by row, starting from the bottom row). If the grid points are indexed by $(i,j)$ where $i \\in \\{0, 1, 2, 3\\}$ is the column index and $j \\in \\{0, 1, 2, 3\\}$ is the row index, the interior points are for $i,j \\in \\{1, 2\\}$. The vector of unknowns is ordered as $U = [u_{11}, u_{21}, u_{12}, u_{22}]^T$.\n\nDetermine the right-hand side vector $b$ of this linear system. Express your answer as a column vector.", "solution": "We solve the discrete Laplace equation at interior nodes using the standard five-point stencil. For each interior point $(i,j)$ with $i,j \\in \\{1,2\\}$, the discretization reads\n$$\n\\frac{u_{i-1,j} + u_{i+1,j} + u_{i,j-1} + u_{i,j+1} - 4u_{i,j}}{h^{2}} = 0.\n$$\nMultiplying by $h^{2}$ (which does not change the right-hand side, since it is zero) and rearranging to isolate contributions from known boundary values on the right-hand side,\n$$\n4u_{i,j} - \\sum_{\\text{interior neighbors}} u - \\sum_{\\text{boundary neighbors}} u = 0\n\\quad \\Longrightarrow \\quad\n4u_{i,j} - \\sum_{\\text{interior neighbors}} u = \\sum_{\\text{boundary neighbors}} u.\n$$\nThus, for the linear system $AU=b$, the right-hand side entry $b$ for each interior node equals the sum of its adjacent boundary values.\n\nWith $h=1/3$, the grid points are $x,y \\in \\{0, \\frac{1}{3}, \\frac{2}{3}, 1\\}$. The interior nodes and their neighbors are:\n\n1) For $u_{11}$ at $(x,y)=\\left(\\frac{1}{3},\\frac{1}{3}\\right)$, neighbors are:\n- Left boundary at $(0,\\frac{1}{3})$: $u(0,\\frac{1}{3}) = \\frac{1}{3}$,\n- Right interior $u_{21}$,\n- Bottom boundary at $(\\frac{1}{3},0)$: $u(\\frac{1}{3},0) = \\frac{1}{3}$,\n- Top interior $u_{12}$.\nTherefore,\n$$\nb_{1} = u\\!\\left(0,\\tfrac{1}{3}\\right) + u\\!\\left(\\tfrac{1}{3},0\\right) = \\frac{1}{3} + \\frac{1}{3} = \\frac{2}{3}.\n$$\n\n2) For $u_{21}$ at $(x,y)=\\left(\\frac{2}{3},\\frac{1}{3}\\right)$, neighbors are:\n- Left interior $u_{11}$,\n- Right boundary at $(1,\\frac{1}{3})$: $u(1,\\frac{1}{3}) = 0$,\n- Bottom boundary at $(\\frac{2}{3},0)$: $u(\\frac{2}{3},0) = \\frac{2}{3}$,\n- Top interior $u_{22}$.\nTherefore,\n$$\nb_{2} = u\\!\\left(1,\\tfrac{1}{3}\\right) + u\\!\\left(\\tfrac{2}{3},0\\right) = 0 + \\frac{2}{3} = \\frac{2}{3}.\n$$\n\n3) For $u_{12}$ at $(x,y)=\\left(\\frac{1}{3},\\frac{2}{3}\\right)$, neighbors are:\n- Left boundary at $(0,\\frac{2}{3})$: $u(0,\\frac{2}{3}) = \\frac{2}{3}$,\n- Right interior $u_{22}$,\n- Bottom interior $u_{11}$,\n- Top boundary at $(\\frac{1}{3},1)$: $u(\\frac{1}{3},1) = 1$.\nTherefore,\n$$\nb_{3} = u\\!\\left(0,\\tfrac{2}{3}\\right) + u\\!\\left(\\tfrac{1}{3},1\\right) = \\frac{2}{3} + 1 = \\frac{5}{3}.\n$$\n\n4) For $u_{22}$ at $(x,y)=\\left(\\frac{2}{3},\\frac{2}{3}\\right)$, neighbors are:\n- Left interior $u_{12}$,\n- Right boundary at $(1,\\frac{2}{3})$: $u(1,\\frac{2}{3}) = 0$,\n- Bottom interior $u_{21}$,\n- Top boundary at $(\\frac{2}{3},1)$: $u(\\frac{2}{3},1) = 1$.\nTherefore,\n$$\nb_{4} = u\\!\\left(1,\\tfrac{2}{3}\\right) + u\\!\\left(\\tfrac{2}{3},1\\right) = 0 + 1 = 1.\n$$\n\nOrdering the unknowns as $U = [u_{11}, u_{21}, u_{12}, u_{22}]^{T}$, the right-hand side vector is\n$$\nb = \\begin{pmatrix}\n\\frac{2}{3} \\\\\n\\frac{2}{3} \\\\\n\\frac{5}{3} \\\\\n1\n\\end{pmatrix}.\n$$", "answer": "$$\\boxed{\\begin{pmatrix}\\frac{2}{3}\\\\\\frac{2}{3}\\\\\\frac{5}{3}\\\\1\\end{pmatrix}}$$", "id": "2102015"}, {"introduction": "Once we have the linear system $AU=b$, we need an efficient way to solve for the unknown temperatures $U$. This exercise introduces the Jacobi method, a classic iterative technique that is particularly well-suited for the sparse matrices generated by finite difference schemes [@problem_id:2102023]. By performing a single iteration by hand, you will gain a concrete understanding of how such methods progressively refine an initial guess toward the final solution.", "problem": "Consider the problem of finding the steady-state temperature distribution on a thin, square metal plate. The temperature $u$ is governed by Laplace's equation. The plate is represented by a square domain, which is discretized into a uniform grid with integer indices $(i, j)$ for $i, j \\in \\{0, 1, 2, 3\\}$. The points where $i, j \\in \\{1, 2\\}$ are the interior points of the grid, while the points on the boundary are those with $i \\in \\{0, 3\\}$ or $j \\in \\{0, 3\\}$.\n\nThe temperature at each interior point $(i, j)$ is approximated using the five-point finite difference formula, which states that the temperature at the point is the average of the temperatures at its four nearest neighboring points. This discretizes the partial differential equation into a system of linear equations.\n\nThe temperatures at the boundary points (in degrees Celsius, although the units are not relevant for the calculation) are fixed as follows (Dirichlet boundary conditions):\n- Bottom edge: $u_{i,0} = 20$ for $i = 1, 2$.\n- Top edge: $u_{i,3} = 60$ for $i = 1, 2$.\n- Left edge: $u_{0,j} = 40$ for $j = 1, 2$.\n- Right edge: $u_{3,j} = 0$ for $j = 1, 2$.\n\nYour task is to approximate the temperatures $u_{1,1}, u_{1,2}, u_{2,1}, u_{2,2}$ at the four interior points. You will use the Jacobi method to solve the system of linear equations. Starting with an initial guess of zero for all interior points, i.e., $u_{i,j}^{(0)} = 0$ for $i,j \\in \\{1, 2\\}$, perform a single iteration to find the first approximation for the temperatures.\n\nCalculate the values of $u_{1,1}^{(1)}, u_{1,2}^{(1)}, u_{2,1}^{(1)}$, and $u_{2,2}^{(1)}$. Present your final answer as a set of four numbers in this specific order.", "solution": "The discrete Laplace equation on a uniform grid with the five-point stencil at interior node $(i,j)$ is\n$$\nu_{i,j}=\\frac{1}{4}\\left(u_{i+1,j}+u_{i-1,j}+u_{i,j+1}+u_{i,j-1}\\right).\n$$\nUsing the Jacobi method with initial guess $u_{i,j}^{(0)}=0$ for all interior points and fixed Dirichlet boundary values, the Jacobi update is\n$$\nu_{i,j}^{(k+1)}=\\frac{1}{4}\\left(u_{i+1,j}^{(k)}+u_{i-1,j}^{(k)}+u_{i,j+1}^{(k)}+u_{i,j-1}^{(k)}\\right),\n$$\nwhere boundary values are inserted as given.\n\nCompute each interior point after one iteration:\n\nFor $(1,1)$:\n$$\nu_{1,1}^{(1)}=\\frac{1}{4}\\left(u_{2,1}^{(0)}+u_{0,1}+u_{1,2}^{(0)}+u_{1,0}\\right)=\\frac{1}{4}\\left(0+40+0+20\\right)=15.\n$$\n\nFor $(1,2)$:\n$$\nu_{1,2}^{(1)}=\\frac{1}{4}\\left(u_{2,2}^{(0)}+u_{0,2}+u_{1,3}+u_{1,1}^{(0)}\\right)=\\frac{1}{4}\\left(0+40+60+0\\right)=25.\n$$\n\nFor $(2,1)$:\n$$\nu_{2,1}^{(1)}=\\frac{1}{4}\\left(u_{3,1}+u_{1,1}^{(0)}+u_{2,2}^{(0)}+u_{2,0}\\right)=\\frac{1}{4}\\left(0+0+0+20\\right)=5.\n$$\n\nFor $(2,2)$:\n$$\nu_{2,2}^{(1)}=\\frac{1}{4}\\left(u_{3,2}+u_{1,2}^{(0)}+u_{2,3}+u_{2,1}^{(0)}\\right)=\\frac{1}{4}\\left(0+0+60+0\\right)=15.\n$$\n\nThus, in the order $(u_{1,1}^{(1)},u_{1,2}^{(1)},u_{2,1}^{(1)},u_{2,2}^{(1)})$, the values are $(15,25,5,15)$.", "answer": "$$\\boxed{\\begin{pmatrix} 15 & 25 & 5 & 15 \\end{pmatrix}}$$", "id": "2102023"}, {"introduction": "A numerical solution is only useful if we can trust its accuracy. This final practice delves into the crucial concept of convergence, allowing you to verify that the numerical error decreases as expected when the grid is refined [@problem_id:2102014]. By comparing the numerical solution against a known exact solution, you will perform a simple yet powerful numerical experiment to confirm the method's theoretical second-order accuracy.", "problem": "Consider the steady-state temperature distribution $u(x, y)$ on a thin, square metallic plate. The temperature is governed by Laplace's equation, $\\frac{\\partial^2 u}{\\partial x^2} + \\frac{\\partial^2 u}{\\partial y^2} = 0$, on the unit square domain defined by $0 \\le x \\le 1$ and $0 \\le y \\le 1$.\n\nFor a specific set of heat sources applied at the boundaries, the exact analytical solution for the temperature is known to be $u_{exact}(x, y) = \\sin(\\pi x) \\sinh(\\pi y)$. The boundary conditions for the problem are therefore determined by this function evaluated along the edges of the square.\n\nYou are tasked with numerically investigating the convergence of the standard finite difference method for this problem. The domain is discretized into a grid of points $(x_i, y_j)$, where $x_i = i h$ and $y_j = j h$, with $h$ being the uniform grid spacing. The Laplace equation is approximated at each interior grid point using the standard second-order central difference approximation, which relates the value at a point to its four nearest neighbors.\n\nYour analysis will involve two different grid spacings:\n\n1.  First, consider a coarse grid with spacing $h_1 = 1/2$. This grid has only one interior point. Calculate the numerical approximation, which we will call $u_{num,1}$, for the temperature at this interior point. Then, determine the corresponding absolute error $E_1 = |u_{exact} - u_{num,1}|$ at this same point. Note that for a grid with a single interior point, this point error is also the maximum error on the grid.\n\n2.  Next, for a finer grid with a spacing of $h_2 = 1/4$, the numerical solution has been pre-computed. The maximum absolute error over all interior points of this finer grid, defined as $E_2 = \\max |u_{exact}(x_i, y_j) - u_{num,2}(x_i, y_j)|$, has been found to be approximately $E_2 \\approx 0.1878$.\n\nThe theoretical order of accuracy for this numerical method is 2, which suggests that the maximum error $E$ should scale with the grid spacing $h$ according to the relationship $E \\approx K h^2$ for some constant $K$, particularly as $h$ becomes very small.\n\nCalculate the numerical value of the ratio of the maximum errors, $R = E_1 / E_2$, using your calculated value for $E_1$ and the provided value for $E_2$. Round your final answer to three significant figures.", "solution": "We solve Laplaceâ€™s equation on the unit square with Dirichlet boundary data taken from the exact solution $u_{exact}(x,y)=\\sin(\\pi x)\\sinh(\\pi y)$. The standard second-order 5-point finite difference stencil at an interior grid point $(i,j)$ with grid spacing $h$ is\n$$\n\\frac{u_{i+1,j}-2u_{i,j}+u_{i-1,j}}{h^{2}}+\\frac{u_{i,j+1}-2u_{i,j}+u_{i,j-1}}{h^{2}}=0,\n$$\nwhich is equivalent to\n$$\n4u_{i,j}=u_{i+1,j}+u_{i-1,j}+u_{i,j+1}+u_{i,j-1}.\n$$\n\nFor $h_{1}=1/2$, the grid points are $x_{i}=ih_{1}$, $y_{j}=jh_{1}$ for $i,j\\in\\{0,1,2\\}$. There is a single interior point at $(i,j)=(1,1)$, i.e., $(x,y)=(1/2,1/2)$. Its four neighbors are boundary points at $(0,1/2)$, $(1,1/2)$, $(1/2,0)$, and $(1/2,1)$, whose Dirichlet values are given by $u_{exact}$:\n$$\nu(0,1/2)=\\sin(0)\\sinh\\!\\left(\\frac{\\pi}{2}\\right)=0,\\quad\nu(1,1/2)=\\sin(\\pi)\\sinh\\!\\left(\\frac{\\pi}{2}\\right)=0,\n$$\n$$\nu(1/2,0)=\\sin\\!\\left(\\frac{\\pi}{2}\\right)\\sinh(0)=0,\\quad\nu(1/2,1)=\\sin\\!\\left(\\frac{\\pi}{2}\\right)\\sinh(\\pi)=\\sinh(\\pi).\n$$\nThus the finite difference equation gives the numerical solution at the interior point as the average of these neighbors:\n$$\nu_{num,1}(1/2,1/2)=\\frac{1}{4}\\left[0+0+0+\\sinh(\\pi)\\right]=\\frac{1}{4}\\sinh(\\pi).\n$$\nThe exact value at this point is\n$$\nu_{exact}(1/2,1/2)=\\sin\\!\\left(\\frac{\\pi}{2}\\right)\\sinh\\!\\left(\\frac{\\pi}{2}\\right)=\\sinh\\!\\left(\\frac{\\pi}{2}\\right).\n$$\nTherefore, the absolute error at the single interior point (and hence the maximum error on this coarse grid) is\n$$\nE_{1}=\\left|\\sinh\\!\\left(\\frac{\\pi}{2}\\right)-\\frac{1}{4}\\sinh(\\pi)\\right|.\n$$\nNumerically,\n$$\n\\sinh(\\pi)\\approx 11.548739357257748,\\qquad \\sinh\\!\\left(\\frac{\\pi}{2}\\right)\\approx 2.301298902307295,\n$$\nso\n$$\nE_{1}\\approx \\left|2.301298902307295-\\frac{1}{4}\\cdot 11.548739357257748\\right|\\approx \\left|2.301298902307295-2.887184839314437\\right|\\approx 0.585885937007142.\n$$\n\nFor the finer grid with $h_{2}=1/4$, we are given $E_{2}\\approx 0.1878$. Hence the ratio of maximum errors is\n$$\nR=\\frac{E_{1}}{E_{2}}\\approx \\frac{0.585885937007142}{0.1878}\\approx 3.1197334238\\ldots\n$$\nRounding to three significant figures gives\n$$\nR\\approx 3.12.\n$$", "answer": "$$\\boxed{3.12}$$", "id": "2102014"}]}