{"hands_on_practices": [{"introduction": "Classical calculus requires functions to be smooth to have a derivative. However, many physical models involve phenomena with sharp corners or jumps, which are not differentiable everywhere. This is where the concept of a weak derivative becomes essential, allowing us to generalize the notion of differentiation. This first exercise [@problem_id:2225014] provides direct practice in computing the weak derivative of the absolute value function, a quintessential example of a function that is not classically differentiable at the origin.", "problem": "In the study of partial differential equations and functional analysis, the concept of a derivative is extended to functions that are not classically differentiable. This leads to the notion of a weak derivative.\n\nLet $\\Omega$ be an open interval on the real line. A function $f$ is in the space $L^1_{\\text{loc}}(\\Omega)$ if it is integrable on every compact subinterval of $\\Omega$. The weak derivative of a function $f \\in L^1_{\\text{loc}}(\\Omega)$ is a function $g \\in L^1_{\\text{loc}}(\\Omega)$ that satisfies the following equation for all test functions $\\phi \\in C_c^{\\infty}(\\Omega)$:\n$$ \\int_{\\Omega} f(x) \\phi'(x) \\,dx = - \\int_{\\Omega} g(x) \\phi(x) \\,dx $$\nHere, $C_c^{\\infty}(\\Omega)$ is the space of all infinitely differentiable functions $\\phi: \\Omega \\to \\mathbb{R}$ that have compact support in $\\Omega$, meaning they are zero outside some closed and bounded interval contained within $\\Omega$.\n\nConsider the function $f(x) = |x|$ on the open interval $\\Omega = (-1, 1)$. Which of the following functions $g(x)$ represents the weak derivative of $f(x)$ on $\\Omega$?\n\nA. $g(x) = 1$ for all $x \\in (-1, 1)$\n\nB. $g(x) = \\begin{cases} -1  \\text{if } -1  x  0 \\\\ 1  \\text{if } 0  x  1 \\end{cases}$\n\nC. $g(x) = \\begin{cases} 1  \\text{if } -1  x  0 \\\\ -1  \\text{if } 0  x  1 \\end{cases}$\n\nD. $g(x) = 0$ for all $x \\in (-1, 1)$\n\nE. The weak derivative of $f(x) = |x|$ does not exist on $\\Omega = (-1, 1)$.", "solution": "We must find a function $g \\in L^{1}_{\\text{loc}}((-1,1))$ such that for all $\\phi \\in C_{c}^{\\infty}((-1,1))$,\n$$\n\\int_{-1}^{1} |x|\\,\\phi'(x)\\,dx = -\\int_{-1}^{1} g(x)\\,\\phi(x)\\,dx.\n$$\nA natural candidate is the sign function\n$$\ng(x)=\\begin{cases}\n-1  \\text{if } -1x0,\\\\\n1  \\text{if } 0x1,\n\\end{cases}\n$$\nwith any value at $x=0$ (irrelevant since changing $g$ on a set of measure zero does not affect the weak derivative).\n\nTo verify this, let $\\phi \\in C_{c}^{\\infty}((-1,1))$. Since $\\phi$ has compact support in $(-1,1)$, there is no boundary contribution at $x=\\pm 1$. Split the integral at $0$ and use integration by parts on each interval:\n$$\n\\int_{-1}^{1} |x|\\,\\phi'(x)\\,dx\n=\\int_{-1}^{0} (-x)\\,\\phi'(x)\\,dx+\\int_{0}^{1} x\\,\\phi'(x)\\,dx.\n$$\nOn $(-1,0)$,\n$$\n\\int_{-1}^{0} (-x)\\,\\phi'(x)\\,dx = \\left[(-x)\\phi(x)\\right]_{-1}^{0} - \\int_{-1}^{0}(-1)\\,\\phi(x)\\,dx\n= 0 + \\int_{-1}^{0}\\phi(x)\\,dx,\n$$\nbecause $\\phi$ vanishes near $x=-1$ and $(-0)\\phi(0)=0$. On $(0,1)$,\n$$\n\\int_{0}^{1} x\\,\\phi'(x)\\,dx = \\left[x\\phi(x)\\right]_{0}^{1} - \\int_{0}^{1} 1\\cdot \\phi(x)\\,dx\n= 0 - \\int_{0}^{1}\\phi(x)\\,dx,\n$$\nsince $\\phi$ vanishes near $x=1$ and $0\\cdot \\phi(0)=0$. Therefore,\n$$\n\\int_{-1}^{1} |x|\\,\\phi'(x)\\,dx\n= \\int_{-1}^{0}\\phi(x)\\,dx - \\int_{0}^{1}\\phi(x)\\,dx\n= -\\int_{-1}^{0}(-1)\\phi(x)\\,dx - \\int_{0}^{1} (1)\\phi(x)\\,dx\n= -\\int_{-1}^{1} g(x)\\,\\phi(x)\\,dx,\n$$\nwith $g$ as defined above. This shows that $g$ is a weak derivative of $|x|$ on $(-1,1)$. Hence the correct choice is the piecewise function with $-1$ on $(-1,0)$ and $1$ on $(0,1)$, which is option B. The value at $x=0$ is immaterial for the weak derivative.", "answer": "$$\\boxed{B}$$", "id": "2225014"}, {"introduction": "Building on the definition of a weak derivative, we can now classify functions into different spaces based on their smoothness properties. The Sobolev space $H^1$ is of particular importance in the theory of partial differential equations, as it represents the natural setting for solutions to many physical problems. In this problem [@problem_id:2224998], you will investigate a simple step function to understand the crucial distinction between being square-integrable ($L^2$) and having a square-integrable weak derivative ($H^1$), a concept that underpins the entire framework of weak solutions.", "problem": "In the study of numerical methods for partial differential equations, the properties of functions are often classified using different function spaces. Consider a simple one-dimensional digital signal, $u(x)$, defined over a domain $x \\in (0, 1)$. The signal represents a switch that is 'off' for the first half of the domain and 'on' for the second half. Mathematically, the signal is described by the step function:\n$$\nu(x) = \\begin{cases} 0  \\text{for } 0  x  1/2 \\\\ 1  \\text{for } 1/2 \\le x  1 \\end{cases}\n$$\n\nTo analyze this signal, we use two important function spaces:\n\n1.  The space $L^2(0,1)$ consists of all functions $f$ for which the integral of their squared magnitude over the domain $(0,1)$ is finite. That is, $f \\in L^2(0,1)$ if $\\int_0^1 |f(x)|^2 dx  \\infty$.\n\n2.  The Sobolev space $H^1(0,1)$ is a subspace of $L^2(0,1)$. A function $f \\in L^2(0,1)$ also belongs to $H^1(0,1)$ if its *weak derivative*, denoted $f'$, also exists and belongs to $L^2(0,1)$. A function $v$ is the weak derivative of $f$ if it satisfies the relation $\\int_0^1 f(x) \\phi'(x) dx = - \\int_0^1 v(x) \\phi(x) dx$ for every infinitely differentiable \"test function\" $\\phi(x)$ that is zero at the boundaries (i.e., $\\phi(0) = \\phi(1) = 0$).\n\nBased on these definitions, which of the following statements correctly describes the properties of the signal function $u(x)$?\n\nA. $u(x)$ belongs to $H^1(0,1)$ but not to $L^2(0,1)$.\n\nB. $u(x)$ belongs to both $L^2(0,1)$ and $H^1(0,1)$.\n\nC. $u(x)$ belongs to $L^2(0,1)$ but not to $H^1(0,1)$.\n\nD. $u(x)$ belongs to neither $L^2(0,1)$ nor $H^1(0,1)$.", "solution": "We analyze the membership of the function\n$$\nu(x)=\\begin{cases}\n0,  0x\\frac{1}{2},\\\\\n1,  \\frac{1}{2}\\leq x1\n\\end{cases}\n$$\nin the spaces $L^{2}(0,1)$ and $H^{1}(0,1)$.\n\nFirst, to check if $u \\in L^{2}(0,1)$, we compute its squared $L^{2}$ norm:\n$$\n\\int_{0}^{1} |u(x)|^{2}\\,dx=\\int_{0}^{1/2} 0^{2}\\,dx+\\int_{1/2}^{1} 1^{2}\\,dx=\\frac{1}{2}\\infty.\n$$\nTherefore, $u \\in L^{2}(0,1)$.\n\nNext, to check whether $u \\in H^{1}(0,1)$, we use the weak derivative definition. Suppose there exists $v \\in L^{2}(0,1)$ such that for every smooth test function $\\phi$ with $\\phi(0)=\\phi(1)=0$,\n$$\n\\int_{0}^{1} u(x)\\,\\phi'(x)\\,dx=-\\int_{0}^{1} v(x)\\,\\phi(x)\\,dx.\n$$\nWe compute the left-hand side explicitly using the definition of $u$:\n$$\n\\int_{0}^{1} u(x)\\,\\phi'(x)\\,dx=\\int_{1/2}^{1} \\phi'(x)\\,dx=\\phi(1)-\\phi\\!\\left(\\tfrac{1}{2}\\right)=-\\phi\\!\\left(\\tfrac{1}{2}\\right),\n$$\nsince $\\phi(1)=0$. Hence the weak derivative condition would require\n$$\n-\\int_{0}^{1} v(x)\\,\\phi(x)\\,dx=-\\phi\\!\\left(\\tfrac{1}{2}\\right)\\quad\\text{for all such }\\phi,\n$$\nor equivalently,\n$$\n\\int_{0}^{1} v(x)\\,\\phi(x)\\,dx=\\phi\\!\\left(\\tfrac{1}{2}\\right)\\quad\\text{for all such }\\phi.\n$$\nThis identifies the distribution represented by $v$ with the Dirac delta at $x=\\tfrac{1}{2}$:\n$$\nv=\\delta_{1/2}.\n$$\nHowever, $\\delta_{1/2}$ is not an element of $L^{2}(0,1)$, so no function $v \\in L^{2}(0,1)$ can satisfy the weak derivative relation. Therefore $u \\notin H^{1}(0,1)$.\n\nCombining both conclusions, $u \\in L^{2}(0,1)$ but $u \\notin H^{1}(0,1)$, which corresponds to option C.", "answer": "$$\\boxed{C}$$", "id": "2224998"}, {"introduction": "The theoretical power of weak solutions finds its ultimate expression in numerical methods for solving differential equations. The weak, or variational, formulation is the starting point for the widely used Finite Element Method (FEM). This final practice exercise [@problem_id:2157325] guides you through a simple application of the Galerkin method, a core component of FEM, to find an approximate solution to a boundary value problem. By working through this example, you will see how the abstract concept of a weak solution translates into a concrete computational algorithm.", "problem": "Consider the one-dimensional Poisson equation $-u''(x) = f(x)$ on the interval $x \\in (0, 1)$, subject to homogeneous Dirichlet boundary conditions $u(0) = 0$ and $u(1) = 0$. The source term is given by the function $f(x) = x$.\n\nWe wish to find an approximate solution to this boundary value problem using the Galerkin method. The approximate solution, denoted $u_h(x)$, is sought within a finite-dimensional space spanned by a set of basis functions that satisfy the boundary conditions. Specifically, we define the approximate solution as a linear combination of two basis functions:\n$$u_h(x) = c_1 \\phi_1(x) + c_2 \\phi_2(x)$$\nwhere the coefficients $c_1$ and $c_2$ are unknown constants to be determined. The chosen basis functions are given by:\n$$ \\phi_1(x) = x(1-x) $$\n$$ \\phi_2(x) = x^2(1-x) $$\nThe Galerkin method transforms the original differential equation into a system of linear equations for the coefficients $c_1$ and $c_2$.\n\nDetermine the value of the sum of these coefficients, $c_1 + c_2$. Express your answer as a fraction in simplest form.", "solution": "We solve the boundary value problem by the Galerkin method in the space spanned by the given basis functions that satisfy the homogeneous Dirichlet boundary conditions. The weak form of the problem for $-u''=f$ with $u(0)=u(1)=0$ is: find $u \\in V$ such that\n$$\n\\int_{0}^{1} u'(x)\\,v'(x)\\,dx=\\int_{0}^{1} f(x)\\,v(x)\\,dx \\quad \\text{for all } v \\in V,\n$$\nwhere $V$ is the subspace of $H^{1}(0,1)$ with $v(0)=v(1)=0$. In the Galerkin approximation, we set $u_{h}(x)=c_{1}\\phi_{1}(x)+c_{2}\\phi_{2}(x)$ with $\\phi_{1}(x)=x(1-x)$ and $\\phi_{2}(x)=x^{2}(1-x)$, and enforce the weak form for $v=\\phi_{i}$, $i=1,2$. This yields the linear system\n$$\n\\sum_{j=1}^{2} K_{ij} c_{j}=F_{i}, \\quad i=1,2,\n$$\nwith stiffness entries $K_{ij}=\\int_{0}^{1} \\phi_{i}'(x)\\,\\phi_{j}'(x)\\,dx$ and load entries $F_{i}=\\int_{0}^{1} f(x)\\,\\phi_{i}(x)\\,dx$.\n\nCompute the derivatives:\n$$\n\\phi_{1}(x)=x-x^{2}, \\quad \\phi_{1}'(x)=1-2x, \\qquad \\phi_{2}(x)=x^{2}-x^{3}, \\quad \\phi_{2}'(x)=2x-3x^{2}.\n$$\nCompute the stiffness matrix entries:\n$$\nK_{11}=\\int_{0}^{1} (1-2x)^{2}\\,dx=\\int_{0}^{1} (1-4x+4x^{2})\\,dx=\\left[x-2x^{2}+\\frac{4}{3}x^{3}\\right]_{0}^{1}=\\frac{1}{3},\n$$\n$$\nK_{12}=\\int_{0}^{1} (1-2x)(2x-3x^{2})\\,dx=\\int_{0}^{1} (2x-7x^{2}+6x^{3})\\,dx=\\left[x^{2}-\\frac{7}{3}x^{3}+\\frac{3}{2}x^{4}\\right]_{0}^{1}=\\frac{1}{6},\n$$\nby symmetry $K_{21}=K_{12}=\\frac{1}{6}$, and\n$$\nK_{22}=\\int_{0}^{1} (2x-3x^{2})^{2}\\,dx=\\int_{0}^{1} (4x^{2}-12x^{3}+9x^{4})\\,dx=\\left[\\frac{4}{3}x^{3}-3x^{4}+\\frac{9}{5}x^{5}\\right]_{0}^{1}=\\frac{2}{15}.\n$$\nCompute the load vector entries for $f(x)=x$:\n$$\nF_{1}=\\int_{0}^{1} x\\,\\phi_{1}(x)\\,dx=\\int_{0}^{1} (x^{2}-x^{3})\\,dx=\\left[\\frac{x^{3}}{3}-\\frac{x^{4}}{4}\\right]_{0}^{1}=\\frac{1}{12},\n$$\n$$\nF_{2}=\\int_{0}^{1} x\\,\\phi_{2}(x)\\,dx=\\int_{0}^{1} (x^{3}-x^{4})\\,dx=\\left[\\frac{x^{4}}{4}-\\frac{x^{5}}{5}\\right]_{0}^{1}=\\frac{1}{20}.\n$$\nThus the linear system is\n$$\n\\begin{pmatrix}\n\\frac{1}{3}  \\frac{1}{6} \\\\\n\\frac{1}{6}  \\frac{2}{15}\n\\end{pmatrix}\n\\begin{pmatrix}\nc_{1} \\\\ c_{2}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n\\frac{1}{12} \\\\ \\frac{1}{20}\n\\end{pmatrix}.\n$$\nThe determinant of the stiffness matrix is\n$$\n\\det K=\\frac{1}{3}\\cdot \\frac{2}{15}-\\left(\\frac{1}{6}\\right)^{2}=\\frac{2}{45}-\\frac{1}{36}=\\frac{8-5}{180}=\\frac{3}{180}=\\frac{1}{60}.\n$$\nBy Cramer's rule,\n$$\nc_{1}=\\frac{K_{22}F_{1}-K_{12}F_{2}}{\\det K}\n=\\frac{\\frac{2}{15}\\cdot \\frac{1}{12}-\\frac{1}{6}\\cdot \\frac{1}{20}}{\\frac{1}{60}}\n=\\frac{\\frac{1}{90}-\\frac{1}{120}}{\\frac{1}{60}}\n=\\frac{\\frac{4-3}{360}}{\\frac{1}{60}}\n=\\frac{\\frac{1}{360}}{\\frac{1}{60}}\n=\\frac{1}{6},\n$$\n$$\nc_{2}=\\frac{K_{11}F_{2}-K_{21}F_{1}}{\\det K}\n=\\frac{\\frac{1}{3}\\cdot \\frac{1}{20}-\\frac{1}{6}\\cdot \\frac{1}{12}}{\\frac{1}{60}}\n=\\frac{\\frac{1}{60}-\\frac{1}{72}}{\\frac{1}{60}}\n=\\frac{\\frac{6-5}{360}}{\\frac{1}{60}}\n=\\frac{\\frac{1}{360}}{\\frac{1}{60}}\n=\\frac{1}{6}.\n$$\nTherefore,\n$$\nc_{1}+c_{2}=\\frac{1}{6}+\\frac{1}{6}=\\frac{2}{6}=\\frac{1}{3}.\n$$", "answer": "$$\\boxed{\\frac{1}{3}}$$", "id": "2157325"}]}