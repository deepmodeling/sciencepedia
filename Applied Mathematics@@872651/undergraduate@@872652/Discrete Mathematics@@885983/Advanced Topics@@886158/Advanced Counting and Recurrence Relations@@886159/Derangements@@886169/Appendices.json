{"hands_on_practices": [{"introduction": "Understanding derangements begins with mastering the fundamental counting technique used to derive their formula: the principle of inclusion-exclusion. This first exercise provides a direct application of this principle to a classic \"scrambled letters\" problem, allowing you to solidify your grasp on the formula for the number of derangements of $n$ items, $D_n$. Solving this will build a strong foundation for tackling more complex derangement scenarios. [@problem_id:1362380]", "problem": "An anagram is a word or phrase formed by rearranging the letters of a different word or phrase. Consider the word `COMPUTER`. We are interested in creating special anagrams from this word where every single letter is moved to a new position. That is, for any resulting arrangement, the first letter is not 'C', the second letter is not 'O', the third is not 'M', and so on, up to the last letter not being 'R'. How many such unique anagrams exist?", "solution": "All letters in the word COMPUTER are distinct, so the required arrangements are exactly the derangements of 8 distinct objects. Let $A_{i}$ be the set of permutations in which the $i$th position is fixed (i.e., the original $i$th letter remains in position $i$). By the inclusion-exclusion principle, the number of permutations with no fixed points (derangements) is\n$$\nD_{8}=\\left|\\overline{A_{1}\\cup \\cdots \\cup A_{8}}\\right|=\\sum_{k=0}^{8}(-1)^{k}\\binom{8}{k}(8-k)!.\n$$\nEquivalently,\n$$\nD_{8}=8!\\sum_{k=0}^{8}\\frac{(-1)^{k}}{k!}.\n$$\nEvaluating the inclusion-exclusion sum term by term,\n$$\nD_{8}=8!-\\binom{8}{1}7!+\\binom{8}{2}6!-\\binom{8}{3}5!+\\binom{8}{4}4!-\\binom{8}{5}3!+\\binom{8}{6}2!-\\binom{8}{7}1!+\\binom{8}{8}0!.\n$$\nCompute each term:\n$$\n8!=40320,\\quad \\binom{8}{1}7!=8\\cdot 5040=40320,\\quad \\binom{8}{2}6!=28\\cdot 720=20160,\n$$\n$$\n\\binom{8}{3}5!=56\\cdot 120=6720,\\quad \\binom{8}{4}4!=70\\cdot 24=1680,\\quad \\binom{8}{5}3!=56\\cdot 6=336,\n$$\n$$\n\\binom{8}{6}2!=28\\cdot 2=56,\\quad \\binom{8}{7}1!=8\\cdot 1=8,\\quad \\binom{8}{8}0!=1\\cdot 1=1.\n$$\nSumming with alternating signs:\n$$\n40320-40320+20160-6720+1680-336+56-8+1=14833.\n$$\nTherefore, the number of anagrams of COMPUTER in which no letter remains in its original position is $D_{8}=14833$.", "answer": "$$\\boxed{14833}$$", "id": "1362380"}, {"introduction": "While the inclusion-exclusion formula is powerful, an alternative and often elegant approach to derangements is through recurrence relations. This practice demonstrates how the number of derangements of $n$ items, $D_n$, can be computed based on the values for $n-1$ and $n-2$ items. This recursive thinking is a cornerstone of discrete mathematics and offers a different perspective on the structure of these special permutations. [@problem_id:1362405]", "problem": "A barista has prepared 6 distinct and personalized coffee orders for 6 specific customers. In a moment of confusion, he randomly assigns the 6 orders to the 6 customers. A complete mix-up occurs if and only if every single customer receives an order that is not their own. It is known from previous, smaller-scale mishaps that for 4 customers, there are 9 possible ways for a complete mix-up to occur, and for 5 customers, there are 44 possible ways. Based on this information, calculate the total number of ways a complete mix-up can occur for the 6 customers.", "solution": "Let $D_{n}$ denote the number of derangements (complete mix-ups) of $n$ distinct items. The standard recurrence for derangements, derived by conditioning on the position of item $1$, is\n$$\nD_{n}=(n-1)\\big(D_{n-1}+D_{n-2}\\big).\n$$\nJustification: item $1$ must go to some position $j\\neq 1$, giving $(n-1)$ choices. If the item originally intended for position $j$ goes to position $1$, then the remaining $n-2$ items must be deranged, contributing $D_{n-2}$. If it does not go to position $1$, then positions $1$ and $j$ enter a structure equinumerous with a derangement of the remaining $n-1$ items, contributing $D_{n-1}$. Summing these cases yields the recurrence.\n\nWe are given $D_{4}=9$ and $D_{5}=44$. Applying the recurrence with $n=6$,\n$$\nD_{6}=(6-1)\\big(D_{5}+D_{4}\\big)=5\\big(44+9\\big)=5\\times 53=265.\n$$\nTherefore, the total number of ways a complete mix-up can occur for $6$ customers is $265$.", "answer": "$$\\boxed{265}$$", "id": "1362405"}, {"introduction": "Our final practice challenges you to move beyond simply counting all possible derangements and consider their internal structure. By imposing a condition on the cycle decomposition of the permutation, this problem requires a hybrid approach. You will need to combine combinatorial selection techniques with the core concept of derangements, a skill crucial for solving advanced combinatorial problems. [@problem_id:1362414]", "problem": "In a clandestine organization, a team of $N=8$ agents, identified by integers from 1 to 8, needs to be assigned new secret call signs for a mission. The new call signs are also the integers from 1 to 8. The assignment is given by a permutation $\\pi$ of the set $\\{1, 2, \\dots, 8\\}$, where $\\pi(i)$ is the new call sign for agent $i$. To maintain security, the assignment must be a derangement, meaning no agent can be assigned their own number as their call sign (i.e., $\\pi(i) \\neq i$ for all $i$ from 1 to 8). Furthermore, for operational reasons, agent 1 must be part of a 3-agent communication loop. This means there exist two other distinct agents, $j$ and $k$, such that agent 1 is assigned agent $j$'s number, agent $j$ is assigned agent $k$'s number, and agent $k$ is assigned agent 1's number.\n\nHow many such valid assignment schemes are possible?", "solution": "A permutation of a finite set decomposes uniquely into disjoint cycles. The requirement that agent 1 is in a 3-cycle means that there exist distinct $j,k \\in \\{2,3,\\dots,8\\}$ such that the cycle on $\\{1,j,k\\}$ is a 3-cycle. In a derangement, no element is fixed, so after specifying the 3-cycle containing $1$, the remaining $5$ agents must form a derangement on those $5$ elements.\n\nFirst, count the number of 3-cycles containing $1$. Choose an ordered pair $(j,k)$ of distinct elements from $\\{2,3,\\dots,8\\}$, which yields the 3-cycle $(1\\,j\\,k)$. Different ordered pairs give different cycles, and there are $7 \\cdot 6 = 42$ such ordered pairs. Hence, the number of 3-cycles containing $1$ is $42$.\n\nNext, count the number of derangements on the remaining $5$ elements. By inclusionâ€“exclusion, the number of derangements of $n$ elements, $D_n$, is given by:\n$$ D_n = n!\\sum_{m=0}^{n}\\frac{(-1)^{m}}{m!} $$\nFor $n=5$:\n$$ D_5 = 5!\\left(1 - 1 + \\frac{1}{2!} - \\frac{1}{3!} + \\frac{1}{4!} - \\frac{1}{5!}\\right) = 120\\left(\\frac{1}{2} - \\frac{1}{6} + \\frac{1}{24} - \\frac{1}{120}\\right) $$\n$$ D_5 = 120\\left(\\frac{60 - 20 + 5 - 1}{120}\\right) = 120 \\left(\\frac{44}{120}\\right) = 44 $$\n\nSince the cycle on $\\{1,j,k\\}$ is disjoint from the permutation on the remaining $5$ elements, the choices multiply. Therefore, the total number of valid assignments is:\n$$ 42 \\times 44 = 1848 $$", "answer": "$$\\boxed{1848}$$", "id": "1362414"}]}