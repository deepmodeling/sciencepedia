{"hands_on_practices": [{"introduction": "To truly grasp the Diffie-Hellman key exchange, there's no substitute for performing the calculations yourself. This first exercise places you in the role of a participant in the exchange. Starting with the public parameters and your partner's public key, you will determine your own secret integer and then compute the final shared secret, reinforcing the core mechanics of the protocol.", "problem": "Two autonomous data centers, named Alice and Bob, need to establish a shared secret key for secure communication. They decide to use the Diffie-Hellman key exchange protocol. They publicly agree on a prime modulus $p=23$ and a primitive root (generator) $g=5$.\n\nAlice chooses a secret integer $a$ and computes her public key $A = g^a \\pmod{p}$.\nBob chooses a secret integer $b$ and computes his public key $B = g^b \\pmod{p}$.\n\nThey exchange their public keys over an insecure channel. An eavesdropper, Eve, intercepts these public keys and learns that Alice's public key is $A=17$ and Bob's public key is $B=11$. However, Eve cannot determine their secret integers $a$ and $b$ easily.\n\nAlice computes the shared secret key as $s = B^a \\pmod{p}$. Bob computes it as $s = A^b \\pmod{p}$. By protocol design, their results will be identical.\n\nYour task is to act as Alice. First, determine your secret integer $a$ by testing integer values. Then, using your secret integer $a$, calculate the final shared secret key $s$. The secret integers $a$ and $b$ are known to be positive integers. What is the value of the shared secret key $s$?", "solution": "Given the Diffie-Hellman setup with modulus $p=23$, generator $g=5$, Alice’s public key $A=17$, and Bob’s public key $B=11$, we must find Alice’s secret integer $a$ such that $A \\equiv g^{a} \\pmod{p}$, and then compute the shared secret $s \\equiv B^{a} \\pmod{p}$.\n\nTo determine $a$, solve $5^{a} \\equiv 17 \\pmod{23}$ by testing successive exponents:\n$$\n\\begin{aligned}\n5^{1} &\\equiv 5 \\pmod{23},\\\\\n5^{2} &\\equiv 25 \\equiv 2 \\pmod{23},\\\\\n5^{3} &\\equiv 2\\cdot 5=10 \\pmod{23},\\\\\n5^{4} &\\equiv 10\\cdot 5=50 \\equiv 4 \\pmod{23},\\\\\n5^{5} &\\equiv 4\\cdot 5=20 \\pmod{23},\\\\\n5^{6} &\\equiv 20\\cdot 5=100 \\equiv 8 \\pmod{23},\\\\\n5^{7} &\\equiv 8\\cdot 5=40 \\equiv 17 \\pmod{23}.\n\\end{aligned}\n$$\nThus $a=7$.\n\nCompute the shared secret $s \\equiv B^{a} \\equiv 11^{7} \\pmod{23}$ using exponentiation by squaring:\n$$\n11^{2} \\equiv 121 \\equiv 6 \\pmod{23},\\quad\n11^{4} \\equiv 6^{2}=36 \\equiv 13 \\pmod{23},\n$$\nand\n$$\n11^{7}=11^{4}\\cdot 11^{2}\\cdot 11 \\equiv 13\\cdot 6\\cdot 11 \\pmod{23}.\n$$\nEvaluate the product modulo $23$:\n$$\n13\\cdot 6=78 \\equiv 9 \\pmod{23},\\quad 9\\cdot 11=99 \\equiv 7 \\pmod{23}.\n$$\nTherefore, $s \\equiv 7 \\pmod{23}$, so the shared secret key is $s=7$.\n\n(Optional verification via the group structure: since $5$ is a primitive root modulo $23$, there exists $b$ with $5^{b}\\equiv 11$. Continuing the table shows $b=9$, so $s\\equiv 5^{ab}=5^{63}\\equiv 5^{19}\\equiv 7 \\pmod{23}$, matching the result.)", "answer": "$$\\boxed{7}$$", "id": "1363105"}, {"introduction": "The security of the Diffie-Hellman protocol is not arbitrary; it is rooted in the mathematical properties of modular exponentiation. This next problem presents a scenario where a student makes a common but critical conceptual error, confusing exponentiation with simple multiplication. By analyzing the steps and identifying the mistake, you will deepen your understanding of the mathematical foundation that makes the key exchange secure. [@problem_id:1363053]", "problem": "Two students, Alice and Bob, are using the Diffie-Hellman key exchange protocol to establish a shared secret key. They publicly agree on a prime modulus $p = 23$ and a generator $g = 5$.\n\nAlice chooses a secret private key $a = 4$.\nBob chooses a secret private key $b = 7$.\n\nA third student, Charlie, observes the public information and tries to follow the protocol steps to determine the final shared secret from Alice's perspective. Charlie documents the process as follows:\n\n**Step 1:** Alice computes her public key $A$ using the formula $A \\equiv g^a \\pmod p$.\nCalculation: $A \\equiv 5^4 \\pmod{23}$. Since $5^4 = 625$ and $625 = 27 \\times 23 + 4$, Alice's public key is $A=4$.\n\n**Step 2:** Bob computes his public key $B$ using the formula $B \\equiv g^b \\pmod p$.\nCalculation: $B \\equiv 5^7 \\pmod{23}$. Since $5^7 = 78125$ and $78125 = 3396 \\times 23 + 17$, Bob's public key is $B=17$.\n\n**Step 3:** Alice and Bob exchange their public keys. Alice now knows $B=17$, and Bob knows $A=4$.\n\n**Step 4:** To compute the shared secret $s$, Alice uses her private key $a$ and Bob's public key $B$. Charlie assumes the formula for this combination is $s \\equiv a \\cdot B \\pmod p$.\n\n**Step 5:** Charlie performs the calculation based on the formula from Step 4.\nCalculation: $s \\equiv 4 \\cdot 17 \\pmod{23}$. Since $4 \\cdot 17 = 68$ and $68 = 2 \\times 23 + 22$, the shared secret is $s=22$.\n\nIn which step does the first conceptual error in the application of the Diffie-Hellman protocol occur?\n\nA. Step 1: The calculation of Alice's public key $A$.\n\nB. Step 2: The calculation of Bob's public key $B$.\n\nC. Step 3: The exchange of public keys.\n\nD. Step 4: The formula used to compute the shared secret $s$.\n\nE. Step 5: The numerical evaluation of the shared secret $s$.", "solution": "In the Diffie-Hellman key exchange, the public parameters are a prime modulus $p$ and a generator $g$ of a multiplicative subgroup modulo $p$. Each party selects a private key (Alice: $a$, Bob: $b$), computes a public key using exponentiation modulo $p$, exchanges public keys, and then computes the shared secret by exponentiating the received public key with their own private exponent modulo $p$:\n$$\nA \\equiv g^{a} \\pmod{p}, \\quad B \\equiv g^{b} \\pmod{p}, \\quad s \\equiv B^{a} \\pmod{p} \\equiv A^{b} \\pmod{p}.\n$$\n\nVerify Step 1:\nAlice computes $A \\equiv g^{a} \\pmod{p}$ with $g=5$, $a=4$, $p=23$.\nCompute $5^{4} \\pmod{23}$. Note $5^{2}=25 \\equiv 2 \\pmod{23}$, hence $5^{4} \\equiv (5^{2})^{2} \\equiv 2^{2} \\equiv 4 \\pmod{23}$. Thus $A=4$, so Step 1 is correct.\n\nVerify Step 2:\nBob computes $B \\equiv g^{b} \\pmod{p}$ with $g=5$, $b=7$, $p=23$.\nCompute $5^{7} \\pmod{23}$. Write $5^{7}=5^{4}\\cdot 5^{3}$. From above, $5^{4} \\equiv 4 \\pmod{23}$ and $5^{3}=125 \\equiv 125-5\\cdot 23 \\equiv 10 \\pmod{23}$. Therefore $5^{7} \\equiv 4 \\cdot 10 \\equiv 40 \\equiv 17 \\pmod{23}$. Thus $B=17$, so Step 2 is correct.\n\nVerify Step 3:\nExchanging public keys is a correct procedural step; there is no conceptual error in exchanging $A$ and $B$.\n\nExamine Step 4:\nThe correct Diffie-Hellman shared secret computation is $s \\equiv B^{a} \\pmod{p}$ from Alice’s perspective (or equivalently $s \\equiv A^{b} \\pmod{p}$ from Bob’s perspective). The formula $s \\equiv a \\cdot B \\pmod{p}$ replaces modular exponentiation with modular multiplication and is not the Diffie-Hellman operation. Therefore, the first conceptual error is the formula used in Step 4.\n\nFor completeness, the correct shared secret would be $s \\equiv 17^{4} \\pmod{23}$. Since $17 \\equiv -6 \\pmod{23}$, $17^{2} \\equiv 36 \\equiv 13 \\pmod{23}$ and $17^{4} \\equiv 13^{2} \\equiv 169 \\equiv 8 \\pmod{23}$. This confirms that the multiplication in Step 5 is based on the incorrect Step 4, but the first error occurs at Step 4.", "answer": "$$\\boxed{D}$$", "id": "1363053"}, {"introduction": "A cryptographic protocol is only as strong as its implementation. This final practice explores a critical security failure: the accidental leakage of a private key. You will step into the shoes of an eavesdropper who has intercepted one of the secret keys, demonstrating how this single point of failure completely compromises the entire exchange. This exercise highlights the paramount importance of protecting the secret integers $a$ and $b$. [@problem_id:1363064]", "problem": "Two parties, Alice and Bob, wish to establish a shared secret key for secure communication using the Diffie-Hellman key exchange protocol. They publicly agree on a prime modulus $p=107$ and a base $g=2$, which is a primitive root modulo $p$.\n\nAlice chooses a secret integer $a$, computes her public key $A = g^a \\pmod p$, and sends $A$ across a public channel.\n\nBob chooses a secret integer $b$. He intends to compute his public key $B = g^b \\pmod p$ and send it to Alice. However, due to a software glitch, Bob's system malfunctions and broadcasts his secret integer $b$ itself over the public channel instead of his public key $B$.\n\nAn eavesdropper, Eve, is monitoring the channel and intercepts all transmitted information. Eve intercepts Alice's public key, which is $A=34$. She also intercepts the value erroneously sent by Bob, which is $b=25$.\n\nGiven this information, determine the value of the shared secret key that Eve can now compute.", "solution": "In the Diffie-Hellman protocol, the shared secret is $K = g^{ab} \\bmod p$. If Eve knows $b$ and Alice's public key $A = g^{a} \\bmod p$, she can compute the shared secret as\n$$\nK \\equiv A^{b} \\pmod p.\n$$\nWith $p=107$, $A=34$, and $b=25$, the shared secret is\n$$\nK \\equiv 34^{25} \\pmod{107}.\n$$\nUse repeated squaring and the binary decomposition $25=16+8+1$:\n$$\n34^{2} \\equiv 1156 \\equiv 86 \\pmod{107},\n$$\n$$\n34^{4} \\equiv 86^{2} = 7396 \\equiv 13 \\pmod{107},\n$$\n$$\n34^{8} \\equiv 13^{2} = 169 \\equiv 62 \\pmod{107},\n$$\n$$\n34^{16} \\equiv 62^{2} = 3844 \\equiv 99 \\pmod{107}.\n$$\nThus,\n$$\n34^{25} \\equiv 34^{16}\\cdot 34^{8}\\cdot 34 \\equiv 99 \\cdot 62 \\cdot 34 \\pmod{107}.\n$$\nCompute the products modulo $107$:\n$$\n99 \\cdot 62 = 6138 \\equiv 39 \\pmod{107},\n$$\n$$\n39 \\cdot 34 = 1326 \\equiv 42 \\pmod{107}.\n$$\nTherefore,\n$$\nK \\equiv 42 \\pmod{107}.\n$$\nThe shared secret that Eve can compute is $42$.", "answer": "$$\\boxed{42}$$", "id": "1363064"}]}