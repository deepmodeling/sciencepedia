{"hands_on_practices": [{"introduction": "To build a solid understanding of the Skorokhod reflection, we begin with the most fundamental case: constraining a continuous path to the non-negative half-line $[0, \\infty)$. This exercise ([@problem_id:3081591]) guides you through the explicit construction of the reflected path $y(t)$ and its regulator $k(t)$ for a given piecewise linear input $x(t)$. By tracking the running infimum of the input path, you will see precisely how the regulator activates and accumulates 'effort' only when the path attempts to cross the zero boundary, providing a clear, step-by-step illustration of the minimality condition.", "problem": "Consider the Skorokhod reflection problem on the nonnegative half-line for a deterministic input path. Let $x:[0,6.2]\\to\\mathbb{R}$ be the piecewise linear function\n$$\nx(t)=\n\\begin{cases}\nt,  0 \\leq t \\leq 1, \\\\\n2 - t,  1 \\leq t \\leq 3, \\\\\n-1 + 1.5\\,(t-3),  3 \\leq t \\leq 4, \\\\\n0.5 - 0.8\\,(t-4),  4 \\leq t \\leq 5, \\\\\n-0.3 + 0.25\\,(t-5),  5 \\leq t \\leq 6.2,\n\\end{cases}\n$$\nwhich is continuous and piecewise linear on $[0,6.2]$. Define the Skorokhod reflection on $[0,\\infty)$ as follows: find functions $y:[0,6.2]\\to\\mathbb{R}$ and $k:[0,6.2]\\to\\mathbb{R}$ such that $y(t)=x(t)+k(t)$ for all $t$, $y(t)\\geq 0$ for all $t$, $k$ is nondecreasing with $k(0)=0$, and the Lebesgueâ€“Stieltjes measure induced by $k$ is supported on the set $\\{t\\in[0,6.2]:y(t)=0\\}$, i.e., $\\int_{0}^{6.2} \\mathbf{1}_{\\{y(s)0\\}}\\,\\mathrm{d}k(s)=0$.\n\nStarting from the defining properties of the Skorokhod reflection map on $[0,\\infty)$, derive an explicit closed-form expression for $k(t)$ and $y(t)$ on the entire interval $[0,6.2]$. In your derivation, justify the nondecreasingness of $k$ and the support property of $\\mathrm{d}k$. Provide your final expressions for $k(t)$ and $y(t)$ as piecewise-defined formulas.\n\nYour final answer must be given as a single row matrix containing the two expressions $k(t)$ and $y(t)$.", "solution": "The problem statement asks for the solution to a Skorokhod reflection problem on the nonnegative half-line, which is a domain $D = [0, \\infty) \\subset \\mathbb{R}$. The input path $x(t)$ is a given continuous, piecewise linear function defined on the time interval $[0, 6.2]$. We are tasked with finding a pair of functions $(y(t), k(t))$ that satisfy the following four conditions for all $t \\in [0, 6.2]$:\n1.  $y(t) = x(t) + k(t)$\n2.  $y(t) \\geq 0$ (the reflected path must stay in the domain $D$)\n3.  $k(0) = 0$ and $k(t)$ is a nondecreasing function (the control process is cumulative and cannot decrease)\n4.  The control process $k(t)$ acts only when the path $y(t)$ is at the boundary of the domain, which is the point $0$. This is formally expressed by the condition that the Lebesgue-Stieltjes measure $\\mathrm{d}k$ is supported on the set $\\{t : y(t) = 0\\}$, i.e., $\\int_{0}^{6.2} \\mathbf{1}_{\\{y(s)0\\}}\\,\\mathrm{d}k(s)=0$.\n\nFor a continuous input path $x(t)$, this problem is well-posed and has a unique solution. The solution is given by the following explicit formulas:\n$$ k(t) = \\max\\left(0, -\\inf_{s \\in [0, t]} x(s)\\right) $$\n$$ y(t) = x(t) + k(t) $$\nFirst, we verify that these formulas satisfy the required conditions. Let $m(t) = \\inf_{s \\in [0, t]} x(s)$.\nThe relation $y(t) = x(t) + k(t)$ holds by definition.\nThe input path is given by $x(t) = t$ for $0 \\leq t \\leq 1$, so $x(0) = 0$. Using the formula for $k(t)$ at $t=0$:\n$k(0) = \\max(0, -m(0)) = \\max(0, -x(0)) = \\max(0, 0) = 0$. The initial condition is satisfied.\n\nTo justify the nondecreasingness of $k(t)$, consider $0 \\leq t_1  t_2 \\leq 6.2$. The interval over which the infimum is taken expands, i.e., $[0, t_1] \\subset [0, t_2]$. Therefore, $m(t_2) = \\inf_{s \\in [0, t_2]} x(s) \\leq \\inf_{s \\in [0, t_1]} x(s) = m(t_1)$. This implies $-m(t_2) \\geq -m(t_1)$. Since the function $\\max(0, \\cdot)$ is nondecreasing, we have $k(t_2) = \\max(0, -m(t_2)) \\geq \\max(0, -m(t_1)) = k(t_1)$. Thus, $k(t)$ is nondecreasing.\n\nFor the nonnegativity of $y(t)$, we have $y(t) = x(t) + \\max(0, -m(t))$.\nIf $-m(t) \\leq 0$, then $k(t) = 0$ and $y(t) = x(t)$. In this case, $m(t) = \\inf_{s \\in [0, t]} x(s) \\geq 0$. Since $t \\in [0,t]$, we have $x(t) \\geq m(t) \\geq 0$. Hence $y(t) \\geq 0$.\nIf $-m(t)  0$, then $k(t) = -m(t)$ and $y(t) = x(t) - m(t) = x(t) - \\inf_{s \\in [0, t]} x(s)$. By the definition of the infimum, $x(t) \\geq \\inf_{s \\in [0, t]} x(s)$, so $y(t) \\geq 0$. In all cases, $y(t) \\geq 0$.\n\nLastly, we justify the support property of $\\mathrm{d}k$. The function $k(t)$ is continuous since $x(t)$ is continuous, which implies $m(t)$ is continuous. $k(t)$ is the composition of continuous functions. For a continuous nondecreasing function $k(t)$, the condition $\\int_{0}^{6.2} \\mathbf{1}_{\\{y(s)0\\}}\\,\\mathrm{d}k(s)=0$ means that if $y(t)  0$ on an open interval $(a,b)$, then $k(t)$ must be constant on $(a,b)$.\nLet's assume $y(t)0$ for $t \\in (a,b)$. Then $x(t) + k(t)  0$. From the analysis above, this implies $x(t) + \\max(0, -m(t))  0$.\nThe function $k(t)$ increases only if $-m(t)$ increases, which happens only if $m(t)$ decreases. A decrease in $m(t)$ at time $t$ can only occur if $x(t)$ attains a new minimum, i.e., $x(t) = m(t)$.\nAt such a time $t$, if $k(t)$ is to increase, we must have $m(t)  0$. In this case, $y(t) = x(t) + k(t) = m(t) + (-m(t)) = 0$.\nTherefore, $k(t)$ can only increase at times $t$ where $y(t)=0$. If $y(t)0$, $k(t)$ must be constant. This confirms the support condition.\n\nNow we proceed with the calculation for the specific $x(t)$ provided.\n$$\nx(t)=\n\\begin{cases}\nt,  0 \\leq t \\leq 1 \\\\\n2 - t,  1 \\leq t \\leq 3 \\\\\n-1 + 1.5(t-3),  3 \\leq t \\leq 4 \\\\\n0.5 - 0.8(t-4),  4 \\leq t \\leq 5 \\\\\n-0.3 + 0.25(t-5),  5 \\leq t \\leq 6.2\n\\end{cases}\n$$\nWe first compute the running infimum $m(t) = \\inf_{s \\in [0, t]} x(s)$:\n- For $t \\in [0, 1]$, $x(s)=s$ is increasing from $0$ to $1$. So, $m(t) = \\inf_{s \\in [0,t]} s = 0$.\n- For $t \\in [1, 3]$, $x(s)=2-s$ is decreasing from $1$ to $-1$. The infimum up to time $t$ is $m(t) = \\inf(m(1), \\inf_{s \\in [1,t]} x(s))$. We have $m(t) = 0$ for $t \\in [1,2]$ and $m(t) = 2-t$ for $t \\in [2,3]$.\n- For $t \\in [3, 4]$, $x(s)=-1 + 1.5(s-3)$ is increasing from $-1$ to $0.5$. The infimum $m(t) = \\inf(m(3), \\inf_{s \\in [3,t]} x(s)) = \\inf(-1, x(3)) = \\inf(-1, -1) = -1$.\n- For $t \\in [4, 5]$, $x(s)=0.5 - 0.8(s-4)$ is decreasing from $0.5$ to $-0.3$. The infimum $m(t) = \\inf(m(4), \\inf_{s \\in [4,t]} x(s)) = \\inf(-1, x(t))$. The expression $0.5 - 0.8(t-4)$ is always greater than $-1$ for $t \\in [4,5]$. So, $m(t) = -1$.\n- For $t \\in [5, 6.2]$, $x(s)=-0.3 + 0.25(s-5)$ is increasing from $-0.3$ to $0$. The infimum $m(t) = \\inf(m(5), \\inf_{s \\in [5,t]} x(s)) = \\inf(-1, x(5)) = \\inf(-1, -0.3) = -1$.\n\nIn summary, the running infimum is:\n$$\nm(t) =\n\\begin{cases}\n0,  0 \\leq t \\leq 2 \\\\\n2-t,  2 \\leq t \\leq 3 \\\\\n-1,  3 \\leq t \\leq 6.2\n\\end{cases}\n$$\nNext, we compute $k(t) = \\max(0, -m(t))$:\n- For $t \\in [0, 2]$, $m(t) = 0$, so $k(t) = \\max(0, 0) = 0$.\n- For $t \\in [2, 3]$, $m(t) = 2-t \\leq 0$, so $k(t) = \\max(0, -(2-t)) = \\max(0, t-2)$. Since $t \\geq 2$, $t-2 \\geq 0$, hence $k(t) = t-2$.\n- For $t \\in [3, 6.2]$, $m(t) = -1$, so $k(t) = \\max(0, -(-1)) = \\max(0, 1) = 1$.\n\nSo, the control process $k(t)$ is:\n$$\nk(t) =\n\\begin{cases}\n0,  0 \\leq t \\leq 2 \\\\\nt-2,  2 \\leq t \\leq 3 \\\\\n1,  3 \\leq t \\leq 6.2\n\\end{cases}\n$$\nFinally, we compute the reflected path $y(t) = x(t) + k(t)$ by combining the piecewise definitions:\n- For $t \\in [0, 1]: y(t) = x(t)+k(t) = t + 0 = t$.\n- For $t \\in [1, 2]: y(t) = x(t)+k(t) = (2-t) + 0 = 2-t$.\n- For $t \\in [2, 3]: y(t) = x(t)+k(t) = (2-t) + (t-2) = 0$.\n- For $t \\in [3, 4]: y(t) = x(t)+k(t) = (-1 + 1.5(t-3)) + 1 = 1.5(t-3)$.\n- For $t \\in [4, 5]: y(t) = x(t)+k(t) = (0.5 - 0.8(t-4)) + 1 = 1.5 - 0.8(t-4)$.\n- For $t \\in [5, 6.2]: y(t) = x(t)+k(t) = (-0.3 + 0.25(t-5)) + 1 = 0.7 + 0.25(t-5)$.\n\nThis gives the full piecewise definition of the reflected path $y(t)$.\n$$\ny(t) =\n\\begin{cases}\nt,  0 \\leq t \\leq 1 \\\\\n2 - t,  1 \\leq t \\leq 2 \\\\\n0,  2 \\leq t \\leq 3 \\\\\n1.5(t-3),  3 \\leq t \\leq 4 \\\\\n1.5 - 0.8(t-4),  4 \\leq t \\leq 5 \\\\\n0.7 + 0.25(t-5),  5 \\leq t \\leq 6.2\n\\end{cases}\n$$\nThese expressions for $k(t)$ and $y(t)$ constitute the solution to the Skorokhod problem.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\nk(t) = \n\\begin{cases}\n0,  0 \\leq t \\leq 2 \\\\\nt-2,  2 \\leq t \\leq 3 \\\\\n1,  3 \\leq t \\leq 6.2\n\\end{cases}\n\ny(t) = \n\\begin{cases}\nt,  0 \\leq t \\leq 1 \\\\\n2 - t,  1 \\leq t \\leq 2 \\\\\n0,  2 \\leq t \\leq 3 \\\\\n1.5(t-3),  3 \\leq t \\leq 4 \\\\\n1.5 - 0.8(t-4),  4 \\leq t \\leq 5 \\\\\n0.7 + 0.25(t-5),  5 \\leq t \\leq 6.2\n\\end{cases}\n\\end{pmatrix}\n}\n$$", "id": "3081591"}, {"introduction": "Having mastered reflection at a single boundary, we now extend the concept to processes confined within a finite interval. The two-sided Skorokhod problem is a natural model for systems with both a floor and a ceiling, such as buffer levels or financial asset prices within a certain band. In this practice ([@problem_id:3081567]), you will construct the reflected path $X(t)$ and two regulators, $L(t)$ and $U(t)$, which prevent the path from exiting the interval $[0,1]$ from below and above, respectively. This exercise emphasizes the interplay between the two regulators and reinforces the core principle of minimal intervention.", "problem": "Consider the two-sided Skorokhod reflection problem on the interval $[0,1]$. Given a continuous input path $\\xi:[0,1]\\to\\mathbb{R}$, the task is to find a triplet $(X,L,U)$ of continuous functions such that:\n- $X(t)=\\xi(t)+L(t)-U(t)$ for all $t\\in[0,1]$,\n- $X(t)\\in[0,1]$ for all $t\\in[0,1]$,\n- $L$ and $U$ are nondecreasing with $L(0)=U(0)=0$,\n- $L$ increases only when $X(t)=0$ and $U$ increases only when $X(t)=1$ (minimality).\n\nTreat the following deterministic, continuous, piecewise linear path as a particular realization of a Brownian bridge from $0$ to $0$ over $[0,1]$:\n\n$$\n\\xi(t)=\n\\begin{cases}\n7t,  t\\in[0,\\frac{1}{5}],\\\\\n\\frac{7}{5}-6(t-\\frac{1}{5}),  t\\in(\\frac{1}{5},\\frac{1}{2}],\\\\\n-\\frac{2}{5}+8(t-\\frac{1}{2}),  t\\in(\\frac{1}{2},\\frac{4}{5}],\\\\\n2-10(t-\\frac{4}{5}),  t\\in(\\frac{4}{5},1].\n\\end{cases}\n$$\n\nUsing only the defining properties stated above (no prepackaged formulas), construct the reflected path $X$ and the regulators $L$ and $U$. Identify precisely on which subintervals of $[0,1]$ each regulator increases. Finally, compute the terminal cumulative regulations $L(1)$ and $U(1)$. Report your final answer as the row vector $(L(1),U(1))$ in exact form. No rounding is required.", "solution": "The problem presented is a well-posed, deterministic instance of the two-sided Skorokhod reflection problem. The input path $\\xi(t)$ is continuous and all defining properties are standard and mathematically sound. The problem is therefore valid.\n\nWe are tasked with constructing the reflected path $X(t)$ on the interval $[0,1]$ and its associated nondecreasing regulators $L(t)$ and $U(t)$ for a given input path $\\xi(t)$. The relationship is defined by $X(t) = \\xi(t) + L(t) - U(t)$, with the constraints that $X(t) \\in [0,1]$ for all $t$, $L(0)=U(0)=0$, and $L(t)$ and $U(t)$ increase only when $X(t)=0$ and $X(t)=1$, respectively.\n\nWe shall construct the solution $(X, L, U)$ by analyzing the behavior of the path $\\xi(t)$ over its piecewise-defined intervals. This path-following approach is a direct implementation of the defining properties.\n\nFirst, we verify the initial condition at $t=0$. The input path starts at $\\xi(0)=7(0)=0$. With $L(0)=0$ and $U(0)=0$, we have $X(0) = \\xi(0)+L(0)-U(0)=0$, which lies within the interval $[0,1]$.\n\n**Interval 1: $t \\in [0, \\frac{1}{5}]$**\nHere, $\\xi(t) = 7t$.\nInitially, for small $t0$, $\\xi(t)$ is in $(0,1)$, so no regulation is needed. We set $L(t)=0$ and $U(t)=0$. This yields $X(t) = \\xi(t) = 7t$.\nThis is valid until $X(t)$ hits a boundary. $X(t)=1$ when $7t=1$, i.e., at $t=1/7$.\nSo, for $t \\in [0, 1/7]$:\n$L(t)=0$, $U(t)=0$, $X(t)=7t$.\n\nFor $t \\in (1/7, 1/5]$, $\\xi(t)$ continues to increase, now exceeding $1$. To keep $X(t) \\le 1$, the regulator $U(t)$ must increase. The other regulator $L(t)$ remains constant at $L(1/7)=0$ since $X(t)$ is not at the lower boundary $0$. To maintain $X(t)$ at the upper boundary, we set $X(t)=1$.\nFrom $X(t) = \\xi(t) + L(t) - U(t)$, we have $1 = 7t + 0 - U(t)$, which gives $U(t) = 7t-1$.\nThis expression is continuous at $t=1/7$, as $7(1/7)-1=0$, which was the value of $U(1/7)$. The regulator $U(t)$ strictly increases on $(1/7, 1/5]$.\nAt the end of this interval, $t=1/5$:\n$L(1/5) = 0$.\n$U(1/5) = 7(1/5) - 1 = 2/5$.\n$X(1/5) = 1$.\n\n**Interval 2: $t \\in (\\frac{1}{5}, \\frac{1}{2}]$**\nHere, $\\xi(t) = \\frac{7}{5} - 6(t-\\frac{1}{5}) = \\frac{13}{5} - 6t$. This is a decreasing path.\nAt $t=1/5$, we have $L(1/5)=0$ and $U(1/5)=2/5$. For $t  1/5$, we provisionally keep the regulators constant. The unconstrained path becomes $X(t) = \\xi(t) + L(1/5) - U(1/5) = (\\frac{13}{5} - 6t) + 0 - \\frac{2}{5} = \\frac{11}{5} - 6t$.\nThis path starts at $X(1/5)=1$ and decreases. It stays within $[0,1]$ until it hits $0$.\n$X(t)=0 \\implies \\frac{11}{5}-6t = 0 \\implies t=11/30$. Since $1/5  11/30  1/2$, this occurs within the current interval.\nFor $t \\in (1/5, 11/30]$:\n$L(t)=0$, $U(t)=2/5$, $X(t)=\\frac{11}{5}-6t$.\n\nFor $t \\in (11/30, 1/2]$, the unconstrained path would become negative. To keep $X(t) \\ge 0$, $L(t)$ must increase. $U(t)$ must remain constant at $U(11/30)=2/5$ since $X(t)$ is not at the upper boundary $1$. We set $X(t)=0$.\nFrom $X(t) = \\xi(t) + L(t) - U(t)$, we have $0 = (\\frac{13}{5}-6t) + L(t) - \\frac{2}{5}$, which implies $L(t) = 6t - \\frac{11}{5}$.\nThis is continuous at $t=11/30$, since $6(11/30)-11/5 = 0=L(11/30)$. The regulator $L(t)$ strictly increases on $(11/30, 1/2]$.\nAt the end of this interval, $t=1/2$:\n$L(1/2) = 6(1/2)-11/5 = 3-11/5=4/5$.\n$U(1/2) = 2/5$.\n$X(1/2) = 0$.\n\n**Interval 3: $t \\in (\\frac{1}{2}, \\frac{4}{5}]$**\nHere, $\\xi(t) = -\\frac{2}{5} + 8(t-\\frac{1}{2}) = 8t - \\frac{22}{5}$. This is an increasing path.\nAt $t=1/2$, we have $L(1/2)=4/5$ and $U(1/2)=2/5$. The unconstrained path is $X(t) = \\xi(t) + L(1/2) - U(1/2) = (8t - \\frac{22}{5}) + \\frac{4}{5} - \\frac{2}{5} = 8t - 4$.\nThis path starts at $X(1/2)=0$ and increases. It stays within $[0,1]$ until it hits $1$.\n$X(t)=1 \\implies 8t - 4 = 1 \\implies t=5/8$. Since $1/2  5/8  4/5$, this occurs within the interval.\nFor $t \\in (1/2, 5/8]$:\n$L(t)=4/5$, $U(t)=2/5$, $X(t) = 8t-4$.\n\nFor $t \\in (5/8, 4/5]$, the unconstrained path would exceed $1$. To keep $X(t) \\le 1$, $U(t)$ must increase, while $L(t)$ remains constant at $L(5/8)=4/5$. We set $X(t)=1$.\nFrom $X(t) = \\xi(t) + L(t) - U(t)$, we have $1 = (8t - \\frac{22}{5}) + \\frac{4}{5} - U(t)$, which yields $U(t) = 8t - \\frac{18}{5} - 1 = 8t - \\frac{23}{5}$.\nThis is continuous at $t=5/8$, since $8(5/8)-23/5=5-23/5=2/5=U(5/8)$. The regulator $U(t)$ strictly increases on $(5/8, 4/5]$.\nAt the end of this interval, $t=4/5$:\n$L(4/5) = 4/5$.\n$U(4/5) = 8(4/5) - 23/5 = 32/5 - 23/5 = 9/5$.\n$X(4/5) = 1$.\n\n**Interval 4: $t \\in (\\frac{4}{5}, 1]$**\nHere, $\\xi(t) = 2 - 10(t-\\frac{4}{5}) = 10-10t$. This is a decreasing path.\nAt $t=4/5$, we have $L(4/5)=4/5$ and $U(4/5)=9/5$. The unconstrained path is $X(t) = \\xi(t) + L(4/5) - U(4/5) = (10-10t) + \\frac{4}{5} - \\frac{9}{5} = 9-10t$.\nThis path starts at $X(4/5)=1$ and decreases, hitting $0$ at $9-10t=0 \\implies t=9/10$.\nFor $t \\in (4/5, 9/10]$:\n$L(t)=4/5$, $U(t)=9/5$, $X(t) = 9-10t$.\n\nFor $t \\in (9/10, 1]$, the unconstrained path would be negative. $L(t)$ must increase, while $U(t)$ remains constant at $U(9/10)=9/5$. We set $X(t)=0$.\nFrom $X(t) = \\xi(t) + L(t) - U(t)$, we have $0 = (10-10t) + L(t) - \\frac{9}{5}$, which implies $L(t) = 10t - 10 + \\frac{9}{5} = 10t - \\frac{41}{5}$.\nThis is continuous at $t=9/10$, since $10(9/10)-41/5=9-41/5=4/5=L(9/10)$. The regulator $L(t)$ strictly increases on $(9/10, 1]$.\nAt the terminal time $t=1$:\n$U(1) = 9/5$.\n$L(1) = 10(1)-\\frac{41}{5} = \\frac{50-41}{5} = \\frac{9}{5}$.\n\nThe construction is complete. The regulators increase on the following subintervals:\n- $L(t)$ increases on $(11/30, 1/2]$ and $(9/10, 1]$.\n- $U(t)$ increases on $(1/7, 1/5]$ and $(5/8, 4/5]$.\n\nThe terminal cumulative regulations are $L(1) = 9/5$ and $U(1) = 9/5$.\nThe final answer is the row vector $(L(1), U(1))$.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{9}{5}  \\frac{9}{5}\n\\end{pmatrix}\n}\n$$", "id": "3081567"}, {"introduction": "While one-dimensional problems offer crucial insights, many real-world systems, like networks of queues or interacting particle systems, require a higher-dimensional framework. This practice ([@problem_id:3081586]) moves from analytical calculation to computational simulation by tackling the Skorokhod problem for a two-dimensional Brownian motion in the non-negative orthant. You will implement a discrete-time algorithm to approximate the reflected path, learning how the reflection matrix $R$ governs the direction of the 'push' at the boundaries, even allowing for non-perpendicular (oblique) reflections. This computational approach is essential for analyzing complex models where closed-form solutions are not available.", "problem": "Consider a two-dimensional Semimartingale Reflected Brownian Motion (SRBM) in the nonnegative orthant $\\mathbb{R}_+^2$. Let the unconstrained driving process be a Brownian motion with drift vector $\\mu \\in \\mathbb{R}^2$ and covariance matrix $\\Sigma \\in \\mathbb{R}^{2 \\times 2}$. Reflection at the axes is governed by a fixed matrix $R \\in \\mathbb{R}^{2 \\times 2}$ whose columns give the inward reflection directions associated with the coordinate axes. The Skorokhod reflection problem seeks a pair of processes $(Y,L)$ such that $Y$ remains in $\\mathbb{R}_+^2$, $L$ is nondecreasing with $L(0)=0$, and, for all times,\n$$\nY(t) = X(t) + R L(t),\n$$\nwhere $X(t)$ is the unconstrained Brownian motion with drift and covariance, and the regulator $L(t)$ increases only when $Y(t)$ lies on the boundary so that $Y(t) \\in \\mathbb{R}_+^2$ for all $t \\ge 0$.\n\nYou will implement a discrete-time approximation to this Skorokhod reflection map. For a time step $\\Delta t  0$ and an integer $N \\ge 1$, construct the sequence $(Y_k, L_k)_{k=0}^N$ via\n$$\nY_0 = x_0 \\in \\mathbb{R}_+^2, \\quad L_0 = (0,0),\n$$\nand for $k=1,\\dots,N$:\n1. Sample Gaussian increments for the unconstrained process\n$$\n\\Delta X_k \\sim \\mathcal{N}(\\mu \\Delta t,\\, \\Sigma \\Delta t),\n$$\nand form the provisional point\n$$\nY_k^\\star = Y_{k-1} + \\Delta X_k.\n$$\n2. Compute a nonnegative regulator increment $\\Delta L_k \\in \\mathbb{R}_+^2$ such that the reflected update\n$$\nY_k = Y_k^\\star + R \\Delta L_k\n$$\nsatisfies $Y_k \\in \\mathbb{R}_+^2$, and update $L_k = L_{k-1} + \\Delta L_k$.\n\nYour algorithm must ensure that the regulator increment is minimal in the sense that it does not introduce any unnecessary push beyond what is needed to enforce $Y_k \\in \\mathbb{R}_+^2$. In two dimensions this can be addressed by checking which coordinates of $Y_k^\\star$ violate nonnegativity and solving the corresponding small active-set system to obtain $\\Delta L_k \\ge 0$ that yields $Y_k \\in \\mathbb{R}_+^2$.\n\nImplement this simulation for the following test suite of parameter values (each test case defines $R$, $\\mu$, $\\Sigma$, $x_0$, $N$, $\\Delta t$, and a random seed). Use the specified random seed to make your Gaussian samples reproducible.\n\nTest case A (normal reflection, mixed drift, diagonal covariance):\n- $R = \\begin{pmatrix}1  0 \\\\ 0  1\\end{pmatrix}$,\n- $\\mu = \\begin{pmatrix}0.1 \\\\ -0.05\\end{pmatrix}$,\n- $\\Sigma = \\begin{pmatrix}1.0  0.0 \\\\ 0.0  0.5\\end{pmatrix}$,\n- $x_0 = \\begin{pmatrix}0.5 \\\\ 0.5\\end{pmatrix}$,\n- $N = 100$,\n- $\\Delta t = 0.01$,\n- seed $= 202311$.\n\nTest case B (oblique reflection, negative drift, identity covariance, boundary start):\n- $R = \\begin{pmatrix}1  0.3 \\\\ 0.2  1\\end{pmatrix}$,\n- $\\mu = \\begin{pmatrix}-0.3 \\\\ -0.3\\end{pmatrix}$,\n- $\\Sigma = \\begin{pmatrix}1.0  0.0 \\\\ 0.0  1.0\\end{pmatrix}$,\n- $x_0 = \\begin{pmatrix}0.0 \\\\ 0.0\\end{pmatrix}$,\n- $N = 80$,\n- $\\Delta t = 0.02$,\n- seed $= 2024$.\n\nTest case C (strong oblique reflection from axis $2$ into axis $1$, positive drift on axis $2$, diagonal covariance):\n- $R = \\begin{pmatrix}1.0  0.8 \\\\ 0.0  1.0\\end{pmatrix}$,\n- $\\mu = \\begin{pmatrix}0.0 \\\\ 0.2\\end{pmatrix}$,\n- $\\Sigma = \\begin{pmatrix}0.5  0.0 \\\\ 0.0  0.5\\end{pmatrix}$,\n- $x_0 = \\begin{pmatrix}0.1 \\\\ 0.0\\end{pmatrix}$,\n- $N = 120$,\n- $\\Delta t = 0.005$,\n- seed $= 321$.\n\nTest case D (normal reflection, zero drift, correlated covariance):\n- $R = \\begin{pmatrix}1.0  0.0 \\\\ 0.0  1.0\\end{pmatrix}$,\n- $\\mu = \\begin{pmatrix}0.0 \\\\ 0.0\\end{pmatrix}$,\n- $\\Sigma = \\begin{pmatrix}1.0  0.6 \\\\ 0.6  1.0\\end{pmatrix}$,\n- $x_0 = \\begin{pmatrix}0.2 \\\\ 0.3\\end{pmatrix}$,\n- $N = 150$,\n- $\\Delta t = 0.01$,\n- seed $= 77$.\n\nProgram requirements:\n- Construct the discrete reflected path using the above specification. Use a Gaussian generator with the given mean and covariance for each independent increment.\n- For each test case, return the list $[Y_N^{(1)}, Y_N^{(2)}, L_N^{(1)}, L_N^{(2)}]$, where $Y_N^{(i)}$ is the $i$-th coordinate of the final reflected position at time $N \\Delta t$, and $L_N^{(i)}$ is the accumulated regulator in coordinate $i$.\n- Numerical format: express all floating-point outputs rounded to six decimal places. No physical units are involved.\n- Final output format: Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each test case contributes a bracketed, comma-separated list of four numbers. For example, the shape must be $\\big[ [\\cdot,\\cdot,\\cdot,\\cdot], [\\cdot,\\cdot,\\cdot,\\cdot], [\\cdot,\\cdot,\\cdot,\\cdot], [\\cdot,\\cdot,\\cdot,\\cdot] \\big]$, with no spaces anywhere in the line.\n\nYour implementation must be a complete, runnable program. It may use any modern programming language; however, the final answer you provide must be executable Python $3.12$ code that adheres to the library restrictions stated later.", "solution": "The solution involves implementing a discrete-time approximation of the Semimartingale Reflected Brownian Motion (SRBM). The simulation proceeds iteratively over $N$ time steps of size $\\Delta t$.\n\nAt each step $k$ (from $1$ to $N$), we start with the previous state of the reflected process, $Y_{k-1}$.\n1.  **Unconstrained Movement:** An increment for the underlying unconstrained Brownian motion is sampled from a multivariate normal distribution, $\\Delta X_k \\sim \\mathcal{N}(\\mu \\Delta t, \\Sigma \\Delta t)$. This increment is added to the previous state to get a provisional point: $Y_k^\\star = Y_{k-1} + \\Delta X_k$.\n2.  **Reflection Mechanism:** The core of the algorithm is to determine the minimal regulator increment $\\Delta L_k \\in \\mathbb{R}_+^2$ needed to push $Y_k^\\star$ back into the non-negative orthant $\\mathbb{R}_+^2$. The final reflected point is then $Y_k = Y_k^\\star + R \\Delta L_k$. This is a two-dimensional Linear Complementarity Problem (LCP), which can be stated as finding $\\Delta L_k$ such that:\n    $$ \\Delta L_k \\ge 0, \\quad Y_k \\ge 0, \\quad \\text{and} \\quad (\\Delta L_k)_i Y_{k,i} = 0 \\text{ for } i=1,2. $$\n    For a $2 \\times 2$ problem where the reflection matrix $R$ is a P-matrix (as is the case here), this LCP can be solved by checking a few scenarios:\n    -   **Case 0 (No Reflection):** If $Y_k^\\star \\ge 0$ (component-wise), no reflection is needed. We set $\\Delta L_k = (0, 0)$ and $Y_k = Y_k^\\star$.\n    -   **Case 1 (Single-Boundary Reflection):** If one component of $Y_k^\\star$ is negative (e.g., $Y_{k,1}^\\star  0$), we first try to reflect only on that boundary. We calculate the required push $\\Delta L_{k,1} = -Y_{k,1}^\\star / R_{11}$ to make $Y_{k,1}=0$. We must then verify that this push does not make the other component negative (i.e., we check if $Y_{k,2} = Y_{k,2}^\\star + R_{21}\\Delta L_{k,1} \\ge 0$). If it's non-negative, this is the minimal push. A symmetric check is performed if only $Y_{k,2}^\\star  0$.\n    -   **Case 2 (Two-Boundary Reflection):** If both components of $Y_k^\\star$ are negative, or if a single-boundary push from Case 1 would make the other component negative, then both regulators must act. This forces the process to the origin, $Y_k = (0,0)$. The required regulator increment is found by solving the linear system $Y_k^\\star + R \\Delta L_k = 0$, which gives $\\Delta L_k = -R^{-1} Y_k^\\star$.\n3.  **State Update:** The total regulator is updated, $L_k = L_{k-1} + \\Delta L_k$.\n\nThis logic is implemented for each of the four test cases. A specific random seed is used for each case to ensure the sequence of generated Gaussian increments is reproducible, leading to a deterministic final result.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the Semimartingale Reflected Brownian Motion simulation problem\n    for the given test cases.\n    \"\"\"\n\n    test_cases = [\n        {\n            'R': np.array([[1.0, 0.0], [0.0, 1.0]]),\n            'mu': np.array([0.1, -0.05]),\n            'Sigma': np.array([[1.0, 0.0], [0.0, 0.5]]),\n            'x0': np.array([0.5, 0.5]),\n            'N': 100,\n            'dt': 0.01,\n            'seed': 202311\n        },\n        {\n            'R': np.array([[1.0, 0.3], [0.2, 1.0]]),\n            'mu': np.array([-0.3, -0.3]),\n            'Sigma': np.array([[1.0, 0.0], [0.0, 1.0]]),\n            'x0': np.array([0.0, 0.0]),\n            'N': 80,\n            'dt': 0.02,\n            'seed': 2024\n        },\n        {\n            'R': np.array([[1.0, 0.8], [0.0, 1.0]]),\n            'mu': np.array([0.0, 0.2]),\n            'Sigma': np.array([[0.5, 0.0], [0.0, 0.5]]),\n            'x0': np.array([0.1, 0.0]),\n            'N': 120,\n            'dt': 0.005,\n            'seed': 321\n        },\n        {\n            'R': np.array([[1.0, 0.0], [0.0, 1.0]]),\n            'mu': np.array([0.0, 0.0]),\n            'Sigma': np.array([[1.0, 0.6], [0.6, 1.0]]),\n            'x0': np.array([0.2, 0.3]),\n            'N': 150,\n            'dt': 0.01,\n            'seed': 77\n        }\n    ]\n\n    all_results = []\n    for params in test_cases:\n        R = params['R']\n        mu = params['mu']\n        Sigma = params['Sigma']\n        Y = params['x0'].copy()\n        N = params['N']\n        dt = params['dt']\n        seed = params['seed']\n        \n        # Initialize state variables\n        L = np.zeros(2)\n        rng = np.random.default_rng(seed)\n\n        # Pre-calculate constants for the loop\n        mean_increment = mu * dt\n        cov_increment = Sigma * dt\n        R_inv = np.linalg.inv(R)\n\n        for _ in range(N):\n            # 1. Sample Gaussian increment\n            delta_X = rng.multivariate_normal(mean_increment, cov_increment)\n            \n            # 2. Form provisional point\n            Y_star = Y + delta_X\n            \n            delta_L = np.zeros(2)\n            \n            # 3. Compute regulator increment by solving the LCP\n            # Case 0: No reflection needed\n            if Y_star[0] = 0 and Y_star[1] = 0:\n                Y = Y_star\n            # Case 1a: Try single push from boundary 1\n            elif Y_star[0]  0 and Y_star[1] + R[1, 0] * (-Y_star[0] / R[0, 0]) = 0:\n                dl1 = -Y_star[0] / R[0, 0]\n                delta_L[0] = dl1\n                Y[0] = 0.0\n                Y[1] = Y_star[1] + R[1, 0] * dl1\n            # Case 1b: Try single push from boundary 2\n            elif Y_star[1]  0 and Y_star[0] + R[0, 1] * (-Y_star[1] / R[1, 1]) = 0:\n                dl2 = -Y_star[1] / R[1, 1]\n                delta_L[1] = dl2\n                Y[0] = Y_star[0] + R[0, 1] * dl2\n                Y[1] = 0.0\n            # Case 2: Double push required\n            else:\n                delta_L = -R_inv @ Y_star\n                Y = np.zeros(2)\n\n            # Clamp small negative values due to floating-point error\n            Y[Y  0] = 0.0\n            delta_L[delta_L  0] = 0.0\n            \n            # 5. Accumulate regulator\n            L += delta_L\n\n        final_Y = Y\n        final_L = L\n        \n        # Format results for output\n        formatted_result = [f\"{x:.6f}\" for x in [final_Y[0], final_Y[1], final_L[0], final_L[1]]]\n        all_results.append(f\"[{','.join(formatted_result)}]\")\n\n    # Print the final output in the required format\n    print(f\"[{','.join(all_results)}]\")\n\nsolve()\n\n```", "id": "3081586"}]}