{"hands_on_practices": [{"introduction": "The heart of stochastic resonance lies in the noise-induced transitions between the stable states of a system. This process is governed by a characteristic rate, famously described by Kramers' theory. This first exercise [@problem_id:3078238] provides essential hands-on practice in calculating this fundamental switching rate for a canonical double-well potential, a crucial first step in understanding how noise can synchronize with a weak signal.", "problem": "Consider the overdamped one-dimensional stochastic differential equation (SDE)\n$$\n\\mathrm{d}x_{t} = -U'(x_{t})\\,\\mathrm{d}t + \\sqrt{2D}\\,\\mathrm{d}W_{t},\n$$\nwhere $W_{t}$ is a standard Wiener process, $D0$ is the noise intensity, and the double-well potential is\n$$\nU(x) = \\frac{1}{4}x^{4} - \\frac{1}{2}x^{2}.\n$$\nIn the small-noise regime, the interwell transition rate $k(D)$ governs the timescale over which trajectories escape from a well at the local minimum $x_{m}$ to cross the saddle at $x_{s}$. This transition rate is the quantity that sets the matching condition in stochastic resonance when a weak periodic drive is present. For the potential $U(x)$, the minima are at $x_{m}=\\pm 1$, the saddle point is at $x_{s}=0$, and the barrier height from a minimum to the saddle is $\\Delta U = \\frac{1}{4}$.\n\nStarting from the fundamental framework of the Fokker–Planck description for escape in the overdamped limit and the well-tested small-noise asymptotics for one-dimensional barriers, determine the explicit closed-form expression for $k(D)$ by evaluating the needed local curvatures $U''(x_{m})$ and $U''(x_{s})$ and the barrier height $\\Delta U=\\frac{1}{4}$ for the given $U(x)$. Express your final answer as a function of $D$ only. No rounding is required. Provide no units in your final expression.", "solution": "The problem asks for the interwell transition rate $k(D)$ for a particle in a double-well potential $U(x)$ subject to white noise, as described by an overdamped one-dimensional stochastic differential equation (SDE). The SDE is given by:\n$$\n\\mathrm{d}x_{t} = -U'(x_{t})\\,\\mathrm{d}t + \\sqrt{2D}\\,\\mathrm{d}W_{t}\n$$\nThe potential is specified as:\n$$\nU(x) = \\frac{1}{4}x^{4} - \\frac{1}{2}x^{2}\n$$\nThe problem is set in the small-noise regime ($D \\to 0$), where the escape from a potential well is a rare event. The rate of such an escape can be calculated using Kramers rate theory, which provides an asymptotic formula for the escape rate derived from the corresponding Fokker-Planck equation. For a one-dimensional system governed by the given SDE, the Kramers escape rate $k$ from a local minimum at $x_{m}$ over a potential barrier with its saddle point at $x_{s}$ is given by the formula:\n$$\nk(D) = \\frac{\\sqrt{U''(x_{m}) |U''(x_{s})|}}{2\\pi} \\exp\\left(-\\frac{\\Delta U}{D}\\right)\n$$\nwhere $U''(x)$ is the second derivative of the potential, representing the local curvature, and $\\Delta U = U(x_{s}) - U(x_{m})$ is the height of the potential barrier.\n\nThe problem provides the locations of the minima, $x_{m}=\\pm 1$, the saddle point, $x_{s}=0$, and the barrier height, $\\Delta U = \\frac{1}{4}$. We must first verify these and compute the necessary curvatures.\n\nFirst, we compute the first and second derivatives of the potential $U(x)$:\n$$\nU'(x) = \\frac{\\mathrm{d}}{\\mathrm{d}x}\\left(\\frac{1}{4}x^{4} - \\frac{1}{2}x^{2}\\right) = x^{3} - x\n$$\n$$\nU''(x) = \\frac{\\mathrm{d}}{\\mathrm{d}x}\\left(x^{3} - x\\right) = 3x^{2} - 1\n$$\nThe critical points are found by setting $U'(x) = 0$:\n$$\nx^{3} - x = x(x^{2}-1) = x(x-1)(x+1) = 0\n$$\nThis gives critical points at $x = -1$, $x = 0$, and $x = 1$.\n\nTo classify these points, we use the second derivative test:\nAt $x = \\pm 1$:\n$$\nU''(\\pm 1) = 3(\\pm 1)^{2} - 1 = 3 - 1 = 2\n$$\nSince $U''(\\pm 1) = 2  0$, the points $x_{m} = \\pm 1$ are local minima, as stated in the problem. The curvature at either minimum is $U''(x_{m}) = 2$. Due to the symmetry of the potential, we can choose the escape from the well at $x_{m}=1$ to the well at $x_{m}=-1$.\n\nAt $x = 0$:\n$$\nU''(0) = 3(0)^{2} - 1 = -1\n$$\nSince $U''(0) = -1  0$, the point $x_{s} = 0$ is a local maximum, which acts as the saddle point between the two wells. This also confirms the information given in the problem. The curvature at the saddle point is $U''(x_{s}) = -1$.\n\nFinally, we can verify the barrier height $\\Delta U$:\nThe potential at the minimum $x_{m} = 1$ is:\n$$\nU(x_{m}) = U(1) = \\frac{1}{4}(1)^{4} - \\frac{1}{2}(1)^{2} = \\frac{1}{4} - \\frac{1}{2} = -\\frac{1}{4}\n$$\nThe potential at the saddle point $x_{s} = 0$ is:\n$$\nU(x_{s}) = U(0) = \\frac{1}{4}(0)^{4} - \\frac{1}{2}(0)^{2} = 0\n$$\nThe barrier height is therefore:\n$$\n\\Delta U = U(x_{s}) - U(x_{m}) = 0 - \\left(-\\frac{1}{4}\\right) = \\frac{1}{4}\n$$\nThis confirms the value $\\Delta U = \\frac{1}{4}$ provided in the problem statement.\n\nNow we have all the components needed for the Kramers rate formula:\n- Curvature at the minimum: $U''(x_{m}) = 2$\n- Curvature at the saddle: $U''(x_{s}) = -1$, so its absolute value is $|U''(x_{s})| = 1$.\n- Barrier height: $\\Delta U = \\frac{1}{4}$.\n\nSubstituting these values into the rate formula:\n$$\nk(D) = \\frac{\\sqrt{U''(x_{m}) |U''(x_{s})|}}{2\\pi} \\exp\\left(-\\frac{\\Delta U}{D}\\right)\n$$\n$$\nk(D) = \\frac{\\sqrt{(2) \\cdot (1)}}{2\\pi} \\exp\\left(-\\frac{1/4}{D}\\right)\n$$\n$$\nk(D) = \\frac{\\sqrt{2}}{2\\pi} \\exp\\left(-\\frac{1}{4D}\\right)\n$$\nThis is the explicit closed-form expression for the interwell transition rate $k(D)$ as a function of the noise intensity $D$.", "answer": "$$\n\\boxed{\\frac{\\sqrt{2}}{2\\pi}\\exp\\left(-\\frac{1}{4D}\\right)}\n$$", "id": "3078238"}, {"introduction": "Building on the ability to calculate the Kramers rate, we now explore how to apply this knowledge from a design perspective. This practice [@problem_id:847556] flips the script: for a desired resonance frequency $\\Omega$, how should we engineer the system's potential barrier $\\Delta V$? Solving this inverse problem deepens your understanding of the delicate balance between a system's physical properties, the noise level, and the conditions required for optimal signal amplification.", "problem": "Consider a particle moving in a one-dimensional symmetric bistable potential given by $V(x) = -\\frac{a}{2}x^2 + \\frac{b}{4}x^4$, where $a, b  0$. The particle's dynamics are overdamped and governed by the Langevin equation $\\dot{x} = -V'(x) + \\xi(t)$, where $\\xi(t)$ is Gaussian white noise with zero mean and correlation $\\langle \\xi(t)\\xi(t') \\rangle = 2D\\delta(t-t')$. Here, $D$ is the noise intensity.\n\nWhen a weak periodic driving force $A\\cos(\\Omega t)$ is added to the system, the phenomenon of stochastic resonance can occur. The system's response to the driving force is maximized when the driving frequency $\\Omega$ is matched to the intrinsic noise-induced switching rate between the two potential wells. This resonance condition is given by $2r_K = \\Omega$, where $r_K$ is the Kramers escape rate.\n\nFor the given overdamped system, the Kramers rate is accurately described by the formula:\n$$r_K = \\frac{\\sqrt{|V''(x_m)V''(x_b)|}}{2\\pi} \\exp\\left(-\\frac{\\Delta V}{D}\\right)$$\nHere, $x_m$ and $x_b$ are the positions of the potential minima and the barrier top, respectively, and $\\Delta V = V(x_b) - V(x_m)$ is the potential barrier height.\n\nFor a fixed noise intensity $D$, driving frequency $\\Omega$, and potential shape parameter $b$, the potential barrier height $\\Delta V$ must be tuned to satisfy the resonance condition. It turns out that two possible values of $\\Delta V$ can achieve resonance.\n\nDerive the expression for the *larger* of these two potential barrier heights, $\\Delta V$. Express your answer in terms of $D$, $\\Omega$, $b$, and the Lambert W function, denoted as $W(z)$. The Lambert W function is defined as the solution to the equation $z = W(z) e^{W(z)}$. If necessary, specify which branch of the function ($W_0$ for the principal branch, $W_{-1}$ for the lower branch) is used.", "solution": "The problem asks for the potential barrier height $\\Delta V$ that satisfies the stochastic resonance condition for a given set of parameters.\n\nFirst, we must characterize the potential $V(x) = -\\frac{a}{2}x^2 + \\frac{b}{4}x^4$.\nThe extrema of the potential are found by setting the first derivative to zero:\n$$V'(x) = -ax + bx^3 = x(bx^2 - a) = 0$$\nThe solutions are $x=0$ and $x = \\pm\\sqrt{a/b}$.\n\nTo determine which are minima and which is a maximum, we examine the second derivative:\n$$V''(x) = -a + 3bx^2$$\nAt $x=0$, $V''(0) = -a  0$, so this is a local maximum (the barrier top). Thus, $x_b = 0$.\nAt $x = \\pm\\sqrt{a/b}$, $V''(\\pm\\sqrt{a/b}) = -a + 3b(a/b) = 2a  0$, so these are the potential minima. Thus, $x_m = \\pm\\sqrt{a/b}$.\n\nNext, we calculate the potential barrier height $\\Delta V$:\n$$\\Delta V = V(x_b) - V(x_m) = V(0) - V(\\sqrt{a/b})$$\n$$V(0) = 0$$\n$$V(\\sqrt{a/b}) = -\\frac{a}{2}\\left(\\frac{a}{b}\\right) + \\frac{b}{4}\\left(\\frac{a}{b}\\right)^2 = -\\frac{a^2}{2b} + \\frac{a^2}{4b} = -\\frac{a^2}{4b}$$\nSo, the barrier height is:\n$$\\Delta V = 0 - \\left(-\\frac{a^2}{4b}\\right) = \\frac{a^2}{4b}$$\n\nNow we assemble the terms for the Kramers rate formula, $r_K = \\frac{\\sqrt{|V''(x_m)V''(x_b)|}}{2\\pi} \\exp\\left(-\\frac{\\Delta V}{D}\\right)$.\nWe have $V''(x_m) = 2a$ and $V''(x_b) = -a$.\n$$r_K = \\frac{\\sqrt{|(2a)(-a)|}}{2\\pi} \\exp\\left(-\\frac{\\Delta V}{D}\\right) = \\frac{\\sqrt{2a^2}}{2\\pi} \\exp\\left(-\\frac{\\Delta V}{D}\\right) = \\frac{a\\sqrt{2}}{2\\pi} \\exp\\left(-\\frac{\\Delta V}{D}\\right)$$\n\nThe stochastic resonance condition is $2r_K = \\Omega$. Substituting our expression for $r_K$:\n$$\\Omega = 2 \\left( \\frac{a\\sqrt{2}}{2\\pi} \\exp\\left(-\\frac{\\Delta V}{D}\\right) \\right) = \\frac{a\\sqrt{2}}{\\pi} \\exp\\left(-\\frac{\\Delta V}{D}\\right)$$\n\nThis equation relates the parameters $a$, $\\Delta V$, $\\Omega$, and $D$. We need to find $\\Delta V$ in terms of $\\Omega$, $D$, and $b$. To do this, we must eliminate the parameter $a$. From the expression for the barrier height, $\\Delta V = \\frac{a^2}{4b}$, we can write $a$ in terms of $\\Delta V$ and $b$:\n$$a^2 = 4b\\Delta V \\implies a = \\sqrt{4b\\Delta V} = 2\\sqrt{b\\Delta V}$$\n\nSubstitute this expression for $a$ back into the resonance condition:\n$$\\Omega = \\frac{(2\\sqrt{b\\Delta V})\\sqrt{2}}{\\pi} \\exp\\left(-\\frac{\\Delta V}{D}\\right) = \\frac{2\\sqrt{2b}}{\\pi} \\sqrt{\\Delta V} \\exp\\left(-\\frac{\\Delta V}{D}\\right)$$\n\nWe now have an equation for $\\Delta V$. Let's solve it.\nFirst, isolate the terms containing $\\Delta V$:\n$$\\frac{\\pi\\Omega}{2\\sqrt{2b}} = \\sqrt{\\Delta V} \\exp\\left(-\\frac{\\Delta V}{D}\\right)$$\nTo handle the $\\sqrt{\\Delta V}$ term, we square both sides:\n$$\\left(\\frac{\\pi\\Omega}{2\\sqrt{2b}}\\right)^2 = \\left(\\sqrt{\\Delta V}\\right)^2 \\exp\\left(-2\\frac{\\Delta V}{D}\\right)$$\n$$\\frac{\\pi^2\\Omega^2}{8b} = \\Delta V \\exp\\left(-\\frac{2\\Delta V}{D}\\right)$$\n\nThis equation is in a form that can be solved using the Lambert W function. Let $z = W(z) e^{W(z)}$. We need to transform our equation to the form $Y = X e^X$.\nLet $X = -\\frac{2\\Delta V}{D}$. This implies $\\Delta V = -\\frac{DX}{2}$.\nSubstituting this into the equation:\n$$\\frac{\\pi^2\\Omega^2}{8b} = \\left(-\\frac{DX}{2}\\right) \\exp(X)$$\nNow, rearrange to get the form $X e^X = Y$:\n$$X e^X = -\\frac{2}{D} \\frac{\\pi^2\\Omega^2}{8b} = -\\frac{\\pi^2\\Omega^2}{4bD}$$\nThe solution for $X$ is given by the Lambert W function:\n$$X = W\\left(-\\frac{\\pi^2\\Omega^2}{4bD}\\right)$$\n\nThe argument of the W function, $z = -\\frac{\\pi^2\\Omega^2}{4bD}$, is negative. For a real solution for $X$ to exist, the argument must be $z \\ge -1/e$. This implies a physical constraint on the parameters for resonance to be possible. When $-1/e  z  0$, there are two real solutions for $X$, given by the two branches of the Lambert W function: $W_0(z)$ and $W_{-1}(z)$, where $W_0(z) \\ge -1$ and $W_{-1}(z) \\le -1$.\n\nWe now find the corresponding values for $\\Delta V$:\n$$\\Delta V = -\\frac{DX}{2} = -\\frac{D}{2} W\\left(-\\frac{\\pi^2\\Omega^2}{4bD}\\right)$$\nThe two possible solutions for $\\Delta V$ are:\n$$\\Delta V_0 = -\\frac{D}{2} W_0\\left(-\\frac{\\pi^2\\Omega^2}{4bD}\\right)$$\n$$\\Delta V_{-1} = -\\frac{D}{2} W_{-1}\\left(-\\frac{\\pi^2\\Omega^2}{4bD}\\right)$$\n\nThe problem asks for the *larger* of the two values. We compare $\\Delta V_0$ and $\\Delta V_{-1}$.\nSince $W_{-1}(z) \\le -1$ and $W_0(z) \\ge -1$ (for $z$ in its domain), and $D0$, we have:\n$$-\\frac{D}{2}W_{-1}(z) \\ge -\\frac{D}{2}(-1) = \\frac{D}{2}$$\n$$-\\frac{D}{2}W_{0}(z) \\le -\\frac{D}{2}(-1) = \\frac{D}{2}$$\nTherefore, $\\Delta V_{-1} \\ge \\Delta V_0$. The larger barrier height corresponds to the solution using the $W_{-1}$ branch of the Lambert W function. Physically, this represents the higher, more stable barrier where switching events are rarer, a regime where Kramers rate theory is typically applied.\n\nThe final expression for the larger potential barrier height is:\n$$\\Delta V = -\\frac{D}{2} W_{-1}\\left(-\\frac{\\pi^2\\Omega^2}{4bD}\\right)$$", "answer": "$$\n\\boxed{-\\frac{D}{2} W_{-1}\\left(-\\frac{\\pi^2 \\Omega^2}{4bD}\\right)}\n$$", "id": "847556"}, {"introduction": "While analytical formulas offer powerful insights, directly observing a phenomenon through simulation provides a concrete and intuitive grasp of its behavior. This practice [@problem_id:3078235] guides you through a complete numerical experiment to witness stochastic resonance in action. By simulating the particle's noisy trajectory and performing a spectral analysis, you will compute the signal-to-noise ratio (SNR) and see firsthand how an intermediate level of noise can maximally amplify a weak periodic signal.", "problem": "Consider the overdamped Langevin equation (an Itô stochastic differential equation) for a particle in a symmetric double-well potential subject to a weak sinusoidal drive, given by\n$$\ndx_t = \\left(x_t - x_t^3 + A \\cos(\\omega t)\\right)\\,dt + \\sqrt{2D}\\,dW_t,\n$$\nwhere $x_t$ is the state variable, $A$ is the drive amplitude, $\\omega$ is the angular frequency (in radians per second), $D$ is the noise intensity (dimensionless), and $W_t$ is a standard Wiener process. The deterministic drift originates from the potential $U(x) = \\frac{x^4}{4} - \\frac{x^2}{2}$, since $-U'(x) = x - x^3$. Work in dimensionless units for $x$ and $A$, and seconds for time.\n\nYour tasks are:\n1. Starting from the definition of the Itô stochastic differential equation, discretize the dynamics using the Euler–Maruyama method with a uniform time step $\\Delta t$. Simulate $M$ independent realizations of the trajectory $\\{x_n\\}_{n=0}^{N-1}$ over a total time $T$, where $N = T / \\Delta t$.\n2. For each realization, compute the Discrete Fourier Transform (DFT) of the mean-removed signal $\\{x_n - \\bar{x}\\}$, where $\\bar{x}$ is the temporal average of the realization. Use the one-sided periodogram to estimate the power spectral density around the drive frequency. Explicitly, let $X_k$ be the discrete Fourier transform at frequency bin $k$. Define the one-sided periodogram by\n$$\nP_k = \\frac{\\Delta t}{N} \\left|X_k\\right|^2,\n$$\nwith the standard one-sided adjustment that multiplies by $2$ for bins strictly between zero frequency and the Nyquist frequency.\n3. Average the periodograms over $M$ realizations to reduce variance, obtaining $\\overline{P}_k$.\n4. Estimate the signal-to-noise ratio (SNR) at the drive angular frequency $\\omega$ by taking the ratio of the averaged periodogram at the bin $k_0$ corresponding to the drive frequency $f_0 = \\omega/(2\\pi)$ to the average of the neighboring bins in a band around $k_0$, excluding the central bin and its immediate neighbors. Let the frequency resolution be $\\Delta f = 1/T$ and $k_0 = \\text{round}(f_0 / \\Delta f)$. Use a symmetric band of width $B$ bins on each side, and compute the noise floor as the arithmetic mean of $\\overline{P}_k$ for $k \\in [k_0 - B, k_0 + B]$ excluding $k_0$, $k_0 - 1$, $k_0 + 1$, and any non-positive or out-of-range indices. Then define\n$$\n\\text{SNR} = \\frac{\\overline{P}_{k_0}}{\\text{mean noise floor}}.\n$$\nThe SNR is a dimensionless quantity.\n\nUse the following parameter values for all simulations unless varied in the test suite: $\\Delta t = 0.01$, $T = 200$, $A = 0.25$, $\\omega = 2\\pi \\cdot 0.05$, and $B = 8$. Initialize each realization at $x_0 = -1$. Use a fixed random seed for reproducibility, and express angles in radians.\n\nTest Suite:\n- Case 1 (happy path, low noise, small ensemble): $D = 0.02$, $M = 5$.\n- Case 2 (near-resonant noise, larger ensemble): $D = 0.12$, $M = 20$.\n- Case 3 (high noise, larger ensemble): $D = 0.60$, $M = 20$.\n\nYour program must:\n- Implement the Euler–Maruyama scheme for simulating the trajectories.\n- Compute and average the periodograms as specified.\n- Compute the SNR for each test case.\n- Produce a single line of output containing the three SNR values as a comma-separated list enclosed in square brackets, with no spaces, in the order of the test suite, for example, $[s_1,s_2,s_3]$.\n\nNo external input is required. The only allowed libraries are the Python standard library, NumPy, and SciPy. Angles must be handled in radians; time is in seconds; $x$ and $A$ are dimensionless. The final outputs must be floats. The numerical values should be computed by your program.", "solution": "The problem requires the numerical analysis of stochastic resonance in a system described by an overdamped Langevin equation. The analysis involves simulating the system's dynamics, computing its power spectrum, and estimating the signal-to-noise ratio (SNR) for different noise intensities.\n\nThe state variable $x_t$ of the particle evolves according to the Itô stochastic differential equation (SDE):\n$$\ndx_t = \\left(x_t - x_t^3 + A \\cos(\\omega t)\\right)\\,dt + \\sqrt{2D}\\,dW_t\n$$\nThis equation models the motion of a particle in a bistable potential $U(x) = \\frac{x^4}{4} - \\frac{x^2}{2}$, subject to a weak periodic driving force with amplitude $A$ and angular frequency $\\omega$, and a stochastic force characterized by a standard Wiener process $W_t$ with noise intensity $D$. The term $(x-x^3)$ is the deterministic force $-U'(x)$.\n\nThe solution is developed in three stages: numerical integration of the SDE, estimation of the power spectral density (PSD), and calculation of the SNR.\n\n**1. Numerical Simulation: The Euler–Maruyama Method**\nThe continuous SDE is discretized to enable numerical simulation. We use the Euler–Maruyama method, a first-order scheme for SDEs. The general form of the SDE is $dX_t = f(X_t, t)\\,dt + g(X_t, t)\\,dW_t$. For a uniform time step $\\Delta t$, the discrete update rule is:\n$$\nx_{n+1} = x_n + f(x_n, t_n)\\Delta t + g(x_n, t_n)\\Delta W_n\n$$\nwhere $x_n \\approx x(t_n)$ at time $t_n = n \\Delta t$. The term $\\Delta W_n = W_{t_{n+1}} - W_{t_n}$ represents the increment of the Wiener process over $\\Delta t$. These increments are independent, normally distributed random variables with mean $0$ and variance $\\Delta t$, i.e., $\\Delta W_n \\sim \\mathcal{N}(0, \\Delta t)$. Computationally, this is implemented as $\\Delta W_n = \\sqrt{\\Delta t} Z_n$, where $Z_n$ is a random variable drawn from the standard normal distribution, $Z_n \\sim \\mathcal{N}(0, 1)$.\n\nFor the given problem, the drift term is $f(x, t) = x - x^3 + A \\cos(\\omega t)$ and the diffusion term is a constant $g(x, t) = \\sqrt{2D}$. Substituting these into the Euler-Maruyama formula, we obtain the iterative scheme for the particle's state:\n$$\nx_{n+1} = x_n + \\left(x_n - x_n^3 + A \\cos(\\omega t_n)\\right)\\Delta t + \\sqrt{2D\\Delta t} Z_n\n$$\nStarting from the initial condition $x_0 = -1$, we generate a trajectory $\\{x_n\\}_{n=0}^{N-1}$ of total length $N = T/\\Delta t$ steps. This process is repeated for $M$ independent realizations to ensure statistically robust results.\n\n**2. Power Spectral Density (PSD) Estimation**\nThe PSD reveals how the power of a signal is distributed over different frequencies. Here, it allows us to see the system's response to the periodic drive.\n\nFor each of the $M$ simulated trajectories, we first compute the mean-removed signal $y_n = x_n - \\bar{x}$, where $\\bar{x} = \\frac{1}{N}\\sum_{i=0}^{N-1} x_i$. The Discrete Fourier Transform (DFT) of $\\{y_n\\}$ is defined as:\n$$\nY_k = \\sum_{n=0}^{N-1} y_n e^{-i 2\\pi kn/N}\n$$\nfor frequency bins $k = 0, 1, \\dots, N-1$. The frequency corresponding to bin $k$ is $f_k = k/T = k/(N\\Delta t)$.\n\nThe problem specifies using the one-sided periodogram, which accounts for the fact that for a real signal, the power spectrum is symmetric around the DC component. The two-sided periodogram is first calculated as $P_k^{\\text{2-sided}} = \\frac{\\Delta t}{N}|Y_k|^2$. The one-sided periodogram $P_k$ is then obtained by folding the negative frequency components onto the positive ones:\n$$\nP_k = \\begin{cases}\n\\frac{\\Delta t}{N} |Y_0|^2  \\text{for } k=0 \\text{ (DC component)} \\\\\n2 \\cdot \\frac{\\Delta t}{N} |Y_k|^2  \\text{for } 0  k  N/2 \\\\\n\\frac{\\Delta t}{N} |Y_{N/2}|^2  \\text{for } k=N/2 \\text{ (Nyquist frequency, if } N \\text{ is even)} \\\\\n\\end{cases}\n$$\nTo reduce estimator variance, the periodograms from all $M$ realizations are averaged:\n$$\n\\overline{P}_k = \\frac{1}{M} \\sum_{m=1}^{M} P_k^{(m)}\n$$\nwhere $P_k^{(m)}$ is the periodogram from the $m$-th realization.\n\n**3. Signal-to-Noise Ratio (SNR) Calculation**\nThe SNR is a measure of the strength of the signal peak (due to the external drive) relative to the background noise level in the spectrum.\n\nFirst, we identify the frequency bin $k_0$ corresponding to the drive frequency $f_0 = \\omega/(2\\pi)$. The frequency resolution is $\\Delta f = 1/T$. The bin index is given by $k_0 = \\text{round}(f_0 / \\Delta f) = \\text{round}(\\omega T / (2\\pi))$. With the provided parameters $\\omega = 2\\pi \\cdot 0.05$ and $T=200$, the signal bin is $k_0 = \\text{round}(0.05 \\cdot 200) = 10$. The signal power, $S$, is the value of the averaged periodogram at this bin: $S = \\overline{P}_{k_0}$.\n\nNext, the noise floor, $N_{floor}$, is estimated by averaging the periodogram over a band of frequencies near the signal peak, excluding the peak itself to avoid bias. The problem specifies a symmetric band of width $B=8$ bins on each side of $k_0$, excluding the bins $\\{k_0-1, k_0, k_0+1\\}$. The set of indices for noise calculation is thus $\\mathcal{K}_{noise} = \\{k \\mid k \\in [k_0-B, k_0+B]\\} \\setminus \\{k_0-1, k_0, k_0+1\\}$, with appropriate handling of boundary conditions (e.g., $k0$). For $k_0=10$ and $B=8$, the indices are $k \\in \\{2, 3, ..., 8\\} \\cup \\{12, 13, ..., 18\\}$. The noise floor is the arithmetic mean over these bins:\n$$\nN_{floor} = \\frac{1}{|\\mathcal{K}_{noise}|} \\sum_{k \\in \\mathcal{K}_{noise}} \\overline{P}_k\n$$\nFinally, the SNR is computed as the ratio of the signal power to the noise floor:\n$$\n\\text{SNR} = \\frac{S}{N_{floor}} = \\frac{\\overline{P}_{k_0}}{N_{floor}}\n$$\nThis procedure is executed for each case in the test suite to determine the SNR as a function of the noise intensity $D$. The phenomenon of stochastic resonance predicts that the SNR will be maximized at a non-zero, optimal value of $D$.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Simulates a driven bistable system described by a Langevin equation\n    to calculate the Signal-to-Noise Ratio (SNR) for different noise intensities.\n    \"\"\"\n    \n    # --- Fixed Parameters ---\n    dt = 0.01          # Time step (s)\n    T = 200.0          # Total time (s)\n    A = 0.25           # Drive amplitude (dimensionless)\n    omega = 2.0 * np.pi * 0.05  # Drive angular frequency (rad/s)\n    B = 8              # Bandwidth for noise floor calculation (bins)\n    x0 = -1.0          # Initial condition\n    \n    # --- Derived Parameters ---\n    N = int(T / dt)    # Number of time steps\n    t_array = np.linspace(0, T, N, endpoint=False) # Time array\n    \n    # Frequency bin of the drive signal\n    f0 = omega / (2.0 * np.pi)\n    df = 1.0 / T\n    k0 = int(round(f0 / df))\n    \n    # Set a fixed random seed for reproducibility\n    np.random.seed(0)\n\n    # --- Test Suite ---\n    test_cases = [\n        # (D: noise intensity, M: number of realizations)\n        (0.02, 5),\n        (0.12, 20),\n        (0.60, 20),\n    ]\n\n    results = []\n    \n    for D, M in test_cases:\n        # Array to store the sum of periodograms over all realizations\n        # The length for a real FFT of size N is N//2 + 1\n        avg_periodogram = np.zeros(N // 2 + 1)\n        \n        for _ in range(M):\n            # --- 1. Euler–Maruyama Simulation ---\n            x = np.zeros(N)\n            x[0] = x0\n            \n            # Generate all random numbers for the Wiener process at once for efficiency\n            Z = np.random.normal(0.0, 1.0, N - 1)\n            \n            for n in range(N - 1):\n                drift = (x[n] - x[n]**3 + A * np.cos(omega * t_array[n])) * dt\n                diffusion = np.sqrt(2 * D * dt) * Z[n]\n                x[n + 1] = x[n] + drift + diffusion\n        \n            # --- 2. Power Spectral Density (PSD) Estimation ---\n            # Remove the temporal mean of the signal\n            y = x - np.mean(x)\n            \n            # Compute the DFT using rfft for real-valued signals\n            Yk = np.fft.rfft(y)\n            \n            # Compute the one-sided periodogram as per the problem definition\n            # The two-sided is (dt/N) * |Yk|^2. One-sided is twice that,\n            # except at DC and Nyquist frequencies.\n            periodogram = (dt / N) * np.abs(Yk)**2\n            periodogram[1:-1] *= 2.0  # Apply the factor of 2\n\n            avg_periodogram += periodogram\n\n        # Average the periodogram over M realizations\n        avg_periodogram /= M\n        \n        # --- 3. Signal-to-Noise Ratio (SNR) Calculation ---\n        # Signal power is the peak at the drive frequency bin\n        signal_power = avg_periodogram[k0]\n        \n        # Define the indices for the noise floor calculation\n        # Bins from [k0-B, k0+B] excluding [k0-1, k0, k0+1]\n        noise_indices = []\n        # Lower band\n        noise_indices.extend(range(max(0, k0 - B), max(0, k0 - 1)))\n        # Upper band\n        noise_indices.extend(range(min(len(avg_periodogram), k0 + 2), \n                                   min(len(avg_periodogram), k0 + B + 1)))\n\n        # Ensure indices are unique and valid (though handled by ranges above)\n        noise_indices = sorted(list(set(noise_indices)))\n        \n        if not noise_indices:\n             # This case should not happen with the given parameters but is a safeguard.\n            mean_noise_floor = np.nan\n        else:\n            mean_noise_floor = np.mean(avg_periodogram[noise_indices])\n        \n        if mean_noise_floor > 0:\n            snr = signal_power / mean_noise_floor\n        else:\n            snr = np.inf # Or handle as an error, np.inf is a reasonable choice.\n\n        results.append(snr)\n\n    # Format the output as a comma-separated list in brackets\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3078235"}]}