{"hands_on_practices": [{"introduction": "We begin our hands-on exploration with a foundational problem that connects the random path of a particle to a deterministic equation. This exercise tasks you with calculating the hitting probability: the chance that a particle undergoing a stochastic process reaches one specific boundary of an interval before the other. By solving this, you will practice translating a probabilistic question into a concrete boundary value problem with Dirichlet conditions, which represent absorbing boundaries, and see how the infinitesimal generator of the process becomes the core of a solvable differential equation [@problem_id:3041824].", "problem": "Let $\\{X_{t}\\}_{t \\ge 0}$ solve the one-dimensional Stochastic Differential Equation (SDE) $\\,\\mathrm{d}X_{t}=\\mu\\,\\mathrm{d}t+\\sigma\\,\\mathrm{d}W_{t}\\,$ with constant drift $\\mu \\in \\mathbb{R}\\setminus\\{0\\}$ and constant volatility $\\sigma0$, where $\\{W_{t}\\}_{t \\ge 0}$ is a standard Brownian motion (BM). Consider the open interval (domain) $D=(0,1)$ and the boundary subset $\\Gamma=\\{1\\}\\subset\\partial D=\\{0,1\\}$. For an initial point $x\\in(0,1)$, define the first exit time $\\tau=\\inf\\{t\\ge 0: X_{t}\\notin(0,1)\\}$ and the hitting event $A=\\{X_{\\tau}=1\\}$.\n \nStarting from the infinitesimal generator of $\\{X_{t}\\}_{t \\ge 0}$ and fundamental results such as Dynkin’s formula (or the martingale characterization of harmonic functions for the generator), derive the appropriate backward boundary value problem for the function $u(x)=\\mathbb{P}_{x}(A)$ on $(0,1)$ with boundary conditions on $\\partial D$, and then solve it to obtain $u(x)$ explicitly. Finally, evaluate the probability at the specific initial condition $x=\\tfrac{1}{3}$.\n \nProvide your final answer as a single closed-form analytic expression in terms of $\\mu$ and $\\sigma$ only. Do not approximate or round your answer; no numerical evaluation is required.", "solution": "The problem statement is deemed valid as it is scientifically grounded, well-posed, and objective. It is a standard problem in the theory of stochastic differential equations (SDEs) concerning hitting probabilities for a one-dimensional Itô process. All required data and conditions are provided, and there are no internal contradictions or ambiguities.\n\nThe stochastic process $\\{X_{t}\\}_{t \\ge 0}$ is governed by the one-dimensional SDE representing an Arithmetic Brownian Motion:\n$$\n\\mathrm{d}X_{t} = \\mu\\,\\mathrm{d}t + \\sigma\\,\\mathrm{d}W_{t}\n$$\nwhere $\\mu \\in \\mathbb{R}\\setminus\\{0\\}$ and $\\sigma  0$ are constants, and $\\{W_{t}\\}_{t \\ge 0}$ is a standard Brownian motion. We are tasked with finding the probability $u(x) = \\mathbb{P}_{x}(A)$ of the event $A = \\{X_{\\tau}=1\\}$, where $\\tau$ is the first exit time from the domain $D=(0,1)$, starting from $X_0=x \\in (0,1)$.\n\nTo solve for $u(x)$, we will formulate and solve the appropriate backward Kolmogorov boundary value problem. According to the theory of SDEs, the hitting probability $u(x)$ is a harmonic function for the infinitesimal generator $\\mathcal{L}$ of the process $\\{X_{t}\\}_{t \\ge 0}$, meaning $\\mathcal{L}u(x)=0$ on the domain $D$. This can be formally established using Dynkin's formula.\n\nFor a general Itô process $\\mathrm{d}X_t = b(X_t)\\,\\mathrm{d}t + s(X_t)\\,\\mathrm{d}W_t$, the infinitesimal generator $\\mathcal{L}$ acting on a twice continuously differentiable function $f(x)$ is defined as:\n$$\n\\mathcal{L}f(x) = b(x) \\frac{\\mathrm{d}f}{\\mathrm{d}x} + \\frac{1}{2} s(x)^2 \\frac{\\mathrm{d}^2f}{\\mathrm{d}x^2}\n$$\nFor the given SDE, the drift coefficient is $b(x)=\\mu$ and the diffusion coefficient is $s(x)=\\sigma$. The generator is therefore:\n$$\n\\mathcal{L} = \\mu \\frac{\\mathrm{d}}{\\mathrm{d}x} + \\frac{1}{2}\\sigma^2 \\frac{\\mathrm{d}^2}{\\mathrm{d}x^2}\n$$\nThe condition $\\mathcal{L}u(x) = 0$ provides the governing ordinary differential equation (ODE) for $u(x)$:\n$$\n\\frac{1}{2}\\sigma^2 u''(x) + \\mu u'(x) = 0, \\quad \\text{for } x \\in (0,1)\n$$\nThe boundary conditions are determined by the definition of $u(x)$ on the boundary $\\partial D = \\{0,1\\}$.\n1. If the process starts at $x=1$, it has already exited at the right boundary. The exit time is $\\tau=0$ and the position is $X_{\\tau}=X_0=1$. Thus, the event $A$ occurs with probability $1$. This gives the boundary condition $u(1)=1$.\n2. If the process starts at $x=0$, it has exited at the left boundary. The exit time is $\\tau=0$ and the position is $X_{\\tau}=X_0=0$. The event $A$ cannot occur. This gives the boundary condition $u(0)=0$.\n\nThe complete boundary value problem is:\n$$\n\\begin{cases}\n\\frac{1}{2}\\sigma^2 u''(x) + \\mu u'(x) = 0,  x \\in (0,1) \\\\\nu(0) = 0 \\\\\nu(1) = 1\n\\end{cases}\n$$\nThis is a second-order, linear, homogeneous ODE with constant coefficients. We assume a solution of the form $u(x) = \\exp(rx)$, which leads to the characteristic equation:\n$$\n\\frac{1}{2}\\sigma^2 r^{2} + \\mu r = 0 \\implies r\\left(\\frac{1}{2}\\sigma^2 r + \\mu\\right) = 0\n$$\nSince the problem states $\\mu \\neq 0$ and $\\sigma  0$, the characteristic roots are distinct:\n$$\nr_1 = 0 \\quad \\text{and} \\quad r_2 = -\\frac{2\\mu}{\\sigma^2}\n$$\nThe general solution of the ODE is a linear combination of the fundamental solutions $\\exp(r_1 x)$ and $\\exp(r_2 x)$:\n$$\nu(x) = C_1 \\exp(r_1 x) + C_2 \\exp(r_2 x) = C_1 + C_2 \\exp\\left(-\\frac{2\\mu}{\\sigma^2}x\\right)\n$$\nWe determine the constants $C_1$ and $C_2$ by applying the boundary conditions.\nFrom $u(0)=0$:\n$$\n0 = C_1 + C_2 \\exp(0) \\implies C_1 + C_2 = 0 \\implies C_1 = -C_2\n$$\nFrom $u(1)=1$:\n$$\n1 = C_1 + C_2 \\exp\\left(-\\frac{2\\mu}{\\sigma^2}\\right)\n$$\nSubstituting $C_1 = -C_2$ into the second equation:\n$$\n1 = -C_2 + C_2 \\exp\\left(-\\frac{2\\mu}{\\sigma^2}\\right) = C_2 \\left(\\exp\\left(-\\frac{2\\mu}{\\sigma^2}\\right) - 1\\right)\n$$\nSolving for $C_2$:\n$$\nC_2 = \\frac{1}{\\exp\\left(-\\frac{2\\mu}{\\sigma^2}\\right) - 1}\n$$\nThen $C_1 = -C_2$:\n$$\nC_1 = \\frac{1}{1 - \\exp\\left(-\\frac{2\\mu}{\\sigma^2}\\right)}\n$$\nSubstituting these constants back into the general solution gives the explicit form of $u(x)$:\n$$\nu(x) = \\frac{1}{1 - \\exp\\left(-\\frac{2\\mu}{\\sigma^2}\\right)} + \\frac{1}{\\exp\\left(-\\frac{2\\mu}{\\sigma^2}\\right) - 1}\\exp\\left(-\\frac{2\\mu}{\\sigma^2}x\\right)\n$$\n$$\nu(x) = \\frac{1}{1 - \\exp\\left(-\\frac{2\\mu}{\\sigma^2}\\right)} - \\frac{1}{1 - \\exp\\left(-\\frac{2\\mu}{\\sigma^2}\\right)}\\exp\\left(-\\frac{2\\mu}{\\sigma^2}x\\right)\n$$\n$$\nu(x) = \\frac{1 - \\exp\\left(-\\frac{2\\mu}{\\sigma^2}x\\right)}{1 - \\exp\\left(-\\frac{2\\mu}{\\sigma^2}\\right)}\n$$\nFinally, we evaluate this probability at the specified initial condition $x=\\frac{1}{3}$:\n$$\nu\\left(\\frac{1}{3}\\right) = \\frac{1 - \\exp\\left(-\\frac{2\\mu}{\\sigma^2} \\cdot \\frac{1}{3}\\right)}{1 - \\exp\\left(-\\frac{2\\mu}{\\sigma^2}\\right)} = \\frac{1 - \\exp\\left(-\\frac{2\\mu}{3\\sigma^2}\\right)}{1 - \\exp\\left(-\\frac{2\\mu}{\\sigma^2}\\right)}\n$$\nThis is the final expression for the probability in terms of the parameters $\\mu$ and $\\sigma$.", "answer": "$$\n\\boxed{\\frac{1 - \\exp\\left(-\\frac{2\\mu}{3\\sigma^{2}}\\right)}{1 - \\exp\\left(-\\frac{2\\mu}{\\sigma^{2}}\\right)}}\n$$", "id": "3041824"}, {"introduction": "Building on the concept of absorbing boundaries, we now explore how different boundary interactions change the outcome. This computational practice challenges you to compare the hitting probabilities under three distinct scenarios at the boundary: fully absorbing (Dirichlet), perfectly reflecting (Neumann), and partially reflecting (Robin). Implementing the solutions will provide a strong, intuitive understanding of how these mathematical conditions model different physical behaviors and directly impact the fate of the stochastic process [@problem_id:3041839].", "problem": "Consider a one-dimensional Itō diffusion process governed by the stochastic differential equation $dX_t = \\mu\\,dt + \\sigma\\,dW_t$ on the closed interval $[0,L]$, where $\\mu \\in \\mathbb{R}$ is the constant drift, $\\sigma  0$ is the constant diffusion coefficient, $L  0$ is the domain length, and $W_t$ is a standard Wiener process. Let $u(x)$ denote the probability that the process starting at $X_0 = x$ reaches the right endpoint $L$ before the left endpoint $0$, where the interaction at the left endpoint depends on the boundary type.\n\nFrom the backward Kolmogorov equation, this hitting probability $u(x)$ solves the linear second-order ordinary differential equation (a special case of a Partial Differential Equation (PDE) in one dimension)\n$$\n\\frac{\\sigma^2}{2}\\,u''(x) + \\mu\\,u'(x) = 0, \\quad x \\in (0,L),\n$$\nsubject to a boundary condition at $x=0$ that depends on the boundary type and the target boundary condition $u(L) = 1$ at $x=L$. Specifically, consider and compare the following three boundary types at $x=0$:\n\n- Dirichlet boundary at $x=0$: $u(0) = 0$ (fully absorbing at the left boundary).\n- Neumann boundary at $x=0$: $u'(0) = 0$ (perfectly reflecting at the left boundary).\n- Robin boundary at $x=0$: $u'(0) - \\kappa\\,u(0) = 0$ with $\\kappa  0$ (interpolating between Neumann as $\\kappa \\to 0$ and Dirichlet as $\\kappa \\to \\infty$).\n\nYour task is to implement a program that, for given parameter sets $(\\mu,\\sigma,L,\\kappa,x)$ and the boundary type at $x=0$, computes the corresponding value of $u(x)$ by solving the backward boundary value problem. The program must use correct formulas derived from the above differential equation and boundary conditions. No physical units are required for the output.\n\nUse the following test suite of parameter values to exercise and compare the effect of boundary type on $u(x)$, including representative cases, boundary values, and edge cases:\n\n- Test case $1$: Dirichlet at $x=0$, with $(\\mu,\\sigma,L,x) = (0.5,\\,1.0,\\,1.0,\\,0.3)$.\n- Test case $2$: Dirichlet at $x=0$, with $(\\mu,\\sigma,L,x) = (-0.5,\\,1.0,\\,1.0,\\,0.7)$.\n- Test case $3$: Dirichlet at $x=0$, boundary start, with $(\\mu,\\sigma,L,x) = (0.2,\\,1.0,\\,1.0,\\,0.0)$.\n- Test case $4$: Dirichlet at $x=0$, target boundary, with $(\\mu,\\sigma,L,x) = (0.2,\\,1.0,\\,1.0,\\,1.0)$.\n- Test case $5$: Neumann at $x=0$, with $(\\mu,\\sigma,L,x) = (0.0,\\,1.0,\\,1.0,\\,0.6)$.\n- Test case $6$: Neumann at $x=0$, with $(\\mu,\\sigma,L,x) = (-0.5,\\,1.0,\\,1.0,\\,0.2)$.\n- Test case $7$: Robin at $x=0$ with $\\kappa = 5.0$, and $(\\mu,\\sigma,L,x) = (0.5,\\,1.0,\\,1.0,\\,0.3)$.\n- Test case $8$: Robin at $x=0$ with $\\kappa = 0.1$, and $(\\mu,\\sigma,L,x) = (0.5,\\,1.0,\\,1.0,\\,0.7)$.\n- Test case $9$: Robin at $x=0$ with $\\kappa = 2.0$ and zero drift, $(\\mu,\\sigma,L,x) = (0.0,\\,1.0,\\,1.0,\\,0.4)$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (for example, $[r_1,r_2,\\dots,r_9]$), where each $r_i$ is the computed value of $u(x)$ for the corresponding test case. Each output must be a floating-point number. No user input is required, and the program must be self-contained and runnable as-is.", "solution": "The problem is valid as it is scientifically grounded in the theory of stochastic differential equations, mathematically well-posed, and presented with objective, unambiguous specifications. We proceed to derive the analytical solutions for the hitting probability $u(x)$.\n\nThe hitting probability $u(x)$ is the solution to the backward Kolmogorov equation, which for a one-dimensional Itō process with constant drift $\\mu$ and diffusion $\\sigma$ on the domain $x \\in (0,L)$ is the following second-order linear ordinary differential equation (ODE):\n$$\n\\frac{\\sigma^2}{2}\\,u''(x) + \\mu\\,u'(x) = 0\n$$\nTo find the general solution, we can let $v(x) = u'(x)$, which transforms the equation into a first-order ODE for $v(x)$:\n$$\n\\frac{\\sigma^2}{2}\\,v'(x) + \\mu\\,v(x) = 0 \\implies v'(x) = -\\frac{2\\mu}{\\sigma^2}v(x)\n$$\nThis is a separable equation with the solution $v(x) = C_1 e^{-\\frac{2\\mu}{\\sigma^2}x}$. Integrating $v(x)$ with respect to $x$ gives $u(x)$. The form of the solution depends on whether $\\mu$ is zero or non-zero.\n\n**Case 1: Non-zero drift ($\\mu \\neq 0$)**\n\nWe define the constant $\\gamma = \\frac{2\\mu}{\\sigma^2}$. The solution for $u'(x)$ is $u'(x) = C_1 e^{-\\gamma x}$. Integrating this with respect to $x$ yields the general solution for $u(x)$:\n$$\nu(x) = \\int C_1 e^{-\\gamma x} dx = -\\frac{C_1}{\\gamma} e^{-\\gamma x} + C_2\n$$\nFor notational simplicity, we express this as:\n$$\nu(x) = A e^{-\\gamma x} + B\n$$\nwhere $A$ and $B$ are constants to be determined by the boundary conditions.\n\n**Case 2: Zero drift ($\\mu = 0$)**\n\nWhen $\\mu=0$, the ODE simplifies to $\\frac{\\sigma^2}{2}u''(x) = 0$. Since $\\sigma  0$, this requires $u''(x) = 0$. Integrating twice with respect to $x$ gives the general solution:\n$$\nu(x) = C_1 x + C_2\n$$\nwhere $C_1$ and $C_2$ are constants determined by the boundary conditions.\n\nWe now derive the specific solution for each boundary type specified in the problem.\n\n**Analysis of Boundary Types**\n\n**I. Dirichlet Boundary at $x=0$**\nThe boundary conditions are $u(0)=0$ (absorbing) and $u(L)=1$ (target).\n\nIf $\\mu \\neq 0$, we use $u(x) = A e^{-\\gamma x} + B$:\n1. $u(0)=0 \\implies A e^0 + B = 0 \\implies A + B = 0 \\implies B = -A$.\n2. $u(L)=1 \\implies A e^{-\\gamma L} + B = 1$.\nSubstituting $B=-A$ into the second equation gives $A(e^{-\\gamma L} - 1) = 1$, so $A = \\frac{1}{e^{-\\gamma L} - 1}$.\nThis implies $B = -\\frac{1}{e^{-\\gamma L} - 1}$. The solution is:\n$$\nu(x) = \\frac{e^{-\\gamma x} - 1}{e^{-\\gamma L} - 1}\n$$\nIf $\\mu=0$, we use $u(x) = C_1 x + C_2$:\n1. $u(0)=0 \\implies C_1(0) + C_2 = 0 \\implies C_2=0$.\n2. $u(L)=1 \\implies C_1 L + C_2 = 1 \\implies C_1 L = 1 \\implies C_1 = \\frac{1}{L}$.\nThe solution is:\n$$\nu(x) = \\frac{x}{L}\n$$\n\n**II. Neumann Boundary at $x=0$**\nThe boundary conditions are $u'(0)=0$ (reflecting) and $u(L)=1$ (target). A reflecting boundary at $x=0$ means the process cannot terminate there. Since the domain is finite, the process must eventually reach the other boundary at $x=L$. Therefore, the probability of reaching $L$ is $1$, i.e., $u(x)=1$ for all $x \\in [0,L]$.\nWe can verify this formally.\n\nIf $\\mu \\neq 0$, we have $u(x) = A e^{-\\gamma x} + B$ and $u'(x) = -A\\gamma e^{-\\gamma x}$.\n1. $u'(0)=0 \\implies -A\\gamma e^0 = 0$. Since $\\mu \\neq 0$ implies $\\gamma \\neq 0$, we must have $A=0$.\n2. $u(L)=1 \\implies u(x) = B$ (since $A=0$), so $B=1$.\nThe solution is $u(x)=1$.\n\nIf $\\mu = 0$, we have $u(x) = C_1 x + C_2$ and $u'(x) = C_1$.\n1. $u'(0)=0 \\implies C_1=0$.\n2. $u(L)=1 \\implies u(x) = C_2$ (since $C_1=0$), so $C_2=1$.\nThe solution is again $u(x)=1$.\n\n**III. Robin Boundary at $x=0$**\nThe boundary conditions are $u'(0) - \\kappa u(0) = 0$ (partially absorbing/reflecting, with $\\kappa  0$) and $u(L)=1$.\n\nIf $\\mu \\neq 0$, we use $u(x) = A e^{-\\gamma x} + B$.\n1. $u(L)=1 \\implies A e^{-\\gamma L} + B = 1 \\implies B = 1 - A e^{-\\gamma L}$.\n2. $u'(0) - \\kappa u(0) = 0 \\implies (-A\\gamma) - \\kappa(A+B) = 0$.\nSubstituting $B$ into the second condition:\n$-A\\gamma - \\kappa(A + 1 - A e^{-\\gamma L}) = 0$\n$A(-\\gamma - \\kappa + \\kappa e^{-\\gamma L}) = \\kappa \\implies A = \\frac{\\kappa}{\\kappa e^{-\\gamma L} - \\gamma - \\kappa}$.\nAfter solving for $B$, the final solution is:\n$$\nu(x) = \\frac{\\kappa e^{-\\gamma x} - \\gamma - \\kappa}{\\kappa e^{-\\gamma L} - \\gamma - \\kappa}\n$$\nThis formula correctly recovers the Neumann solution $u(x)=1$ as $\\kappa \\to 0$ and the Dirichlet solution as $\\kappa \\to \\infty$.\n\nIf $\\mu=0$, we use $u(x) = C_1 x + C_2$.\n1. $u(L)=1 \\implies C_1 L + C_2 = 1 \\implies C_2 = 1 - C_1 L$.\n2. $u'(0) - \\kappa u(0) = 0 \\implies C_1 - \\kappa C_2 = 0 \\implies C_1 = \\kappa C_2$.\nSubstituting $C_2 = C_1/\\kappa$ into the first condition:\n$C_1 L + C_1/\\kappa = 1 \\implies C_1(L+1/\\kappa) = 1 \\implies C_1 = \\frac{\\kappa}{1+\\kappa L}$.\nThis gives $C_2 = C_1/\\kappa = \\frac{1}{1+\\kappa L}$.\nThe solution is:\n$$\nu(x) = \\frac{\\kappa x + 1}{1+\\kappa L}\n$$\nThis is also consistent with the $\\mu \\to 0$ limit of the Robin solution for $\\mu \\neq 0$.\n\nThese derived analytical formulas are implemented to compute the results for the given test cases.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the hitting probability u(x) for a 1D Itō diffusion process\n    on [0, L] for various boundary conditions at x=0.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {'type': 'Dirichlet', 'mu': 0.5, 'sigma': 1.0, 'L': 1.0, 'kappa': None, 'x': 0.3},\n        {'type': 'Dirichlet', 'mu': -0.5, 'sigma': 1.0, 'L': 1.0, 'kappa': None, 'x': 0.7},\n        {'type': 'Dirichlet', 'mu': 0.2, 'sigma': 1.0, 'L': 1.0, 'kappa': None, 'x': 0.0},\n        {'type': 'Dirichlet', 'mu': 0.2, 'sigma': 1.0, 'L': 1.0, 'kappa': None, 'x': 1.0},\n        {'type': 'Neumann', 'mu': 0.0, 'sigma': 1.0, 'L': 1.0, 'kappa': None, 'x': 0.6},\n        {'type': 'Neumann', 'mu': -0.5, 'sigma': 1.0, 'L': 1.0, 'kappa': None, 'x': 0.2},\n        {'type': 'Robin', 'mu': 0.5, 'sigma': 1.0, 'L': 1.0, 'kappa': 5.0, 'x': 0.3},\n        {'type': 'Robin', 'mu': 0.5, 'sigma': 1.0, 'L': 1.0, 'kappa': 0.1, 'x': 0.7},\n        {'type': 'Robin', 'mu': 0.0, 'sigma': 1.0, 'L': 1.0, 'kappa': 2.0, 'x': 0.4},\n    ]\n\n    results = []\n    \n    # Epsilon for floating point comparison with zero\n    TOLERANCE = 1e-12\n\n    for case in test_cases:\n        mu = case['mu']\n        sigma = case['sigma']\n        L = case['L']\n        x = case['x']\n        \n        result = 0.0\n\n        if case['type'] == 'Dirichlet':\n            if abs(mu)  TOLERANCE:\n                # Solution for mu = 0\n                if L  TOLERANCE:\n                    result = x / L\n                else: # To handle potential division by zero, though L0 is given\n                    result = 1.0 if x = L else 0.0\n            else:\n                # Solution for mu != 0\n                gamma = 2.0 * mu / (sigma**2)\n                numerator = np.exp(-gamma * x) - 1.0\n                denominator = np.exp(-gamma * L) - 1.0\n                if abs(denominator)  TOLERANCE: # Fallback, should not happen for L0, mu!=0\n                    result = x / L\n                else: \n                    result = numerator / denominator\n\n        elif case['type'] == 'Neumann':\n            # For a reflecting boundary at x=0 and absorbing at x=L on a finite domain,\n            # the particle must eventually hit L.\n            result = 1.0\n\n        elif case['type'] == 'Robin':\n            kappa = case['kappa']\n            if abs(mu)  TOLERANCE:\n                # Solution for mu = 0\n                numerator = kappa * x + 1.0\n                denominator = 1.0 + kappa * L\n                result = numerator / denominator\n            else:\n                # Solution for mu != 0\n                gamma = 2.0 * mu / (sigma**2)\n                numerator = kappa * np.exp(-gamma * x) - gamma - kappa\n                denominator = kappa * np.exp(-gamma * L) - gamma - kappa\n                if abs(denominator)  TOLERANCE: # Unlikely edge case\n                    # This implies kappa(exp(-gamma*L) - 1) = gamma\n                    # We will assume test cases avoid this singularity.\n                    result = np.nan\n                else:\n                    result = numerator / denominator\n        \n        results.append(result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.8f}' for r in results)}]\")\n\nsolve()\n```", "id": "3041839"}, {"introduction": "Our final practice bridges the gap between continuous theory and practical computation, a crucial step in solving real-world problems. Here, you will tackle a scenario with mixed boundary conditions—a reflecting boundary at one end and an absorbing one at the other. Instead of seeking a continuous solution, you will construct and solve a finite-difference scheme, learning how to discretize both the differential equation and the corresponding Neumann and Dirichlet boundary conditions, a fundamental skill in the numerical analysis of stochastic processes [@problem_id:3041788].", "problem": "Consider a one-dimensional Itô Stochastic Differential Equation (SDE), $dX_{t}=\\sigma\\,dW_{t}$, on the interval $[0,L]$, where $W_{t}$ is standard Brownian motion and $\\sigma0$ is a constant diffusion coefficient. The boundary at $x=0$ is reflecting, and the boundary at $x=L$ is absorbing. Let $\\tau=\\inf\\{t\\geq 0:X_{t}=L\\}$ be the first hitting time of the absorbing boundary, and define $u(x)=\\mathbb{E}_{x}[\\tau]$.\n\nUsing the characterization of expected hitting times via the Kolmogorov backward equation together with the appropriate boundary conditions induced by reflection and absorption, construct a second-order central finite-difference scheme on a uniform grid $x_{i}=ih$ for $i=0,1,\\dots,N$ with $h=L/N$. Let $u_{i}\\approx u(x_{i})$ denote the discrete approximation. Impose mixed boundary conditions consisting of a discrete Neumann condition at the reflecting boundary, $u_{1}-u_{0}=0$, and a Dirichlet condition at the absorbing boundary, $u_{N}=0$.\n\nSolve the resulting linear system analytically in the index $i$ and then compute the specific value $u_{2}$ for the case $L=6$, $N=6$ (so $h=1$), and $\\sigma=1$. Explicitly verify within your derivation that the discrete solution satisfies both the interior finite-difference equation and the two boundary conditions. Express your final answer as a pure number of time steps with no units. No rounding is required.", "solution": "The user-provided problem is first subjected to a rigorous validation procedure.\n\n### Step 1: Extract Givens\n-   **SDE:** $dX_{t}=\\sigma\\,dW_{t}$ on the interval $[0,L]$.\n-   **Constants:** $\\sigma0$ is a constant diffusion coefficient.\n-   **Process:** $W_{t}$ is standard Brownian motion.\n-   **Boundaries:** The boundary at $x=0$ is reflecting. The boundary at $x=L$ is absorbing.\n-   **Definitions:** $\\tau=\\inf\\{t\\geq 0:X_{t}=L\\}$ is the first hitting time of the absorbing boundary. $u(x)=\\mathbb{E}_{x}[\\tau]$ is the expected hitting time starting from $x$.\n-   **Task:** Construct a second-order central finite-difference scheme.\n-   **Grid:** Uniform grid $x_{i}=ih$ for $i=0,1,\\dots,N$ with $h=L/N$. The discrete approximation is $u_{i}\\approx u(x_{i})$.\n-   **Discrete Boundary Conditions:**\n    -   Reflecting boundary ($x=0$): a discrete Neumann condition $u_{1}-u_{0}=0$.\n    -   Absorbing boundary ($x=L$): a Dirichlet condition $u_{N}=0$.\n-   **Request:** Solve the resulting linear system analytically for $u_i$ in terms of the index $i$.\n-   **Specific Case:** Compute $u_{2}$ for $L=6$, $N=6$ (implying $h=1$), and $\\sigma=1$.\n-   **Verification Requirement:** Explicitly verify that the derived discrete solution satisfies both the interior finite-difference equation and the two boundary conditions.\n\n### Step 2: Validate Using Extracted Givens\n-   **Scientifically Grounded:** The problem is based on the well-established theory of stochastic differential equations (SDEs) and their connection to partial differential equations (PDEs) via the Kolmogorov backward equation. The concepts of hitting times, reflecting boundaries, absorbing boundaries, and their mathematical representations (Neumann and Dirichlet conditions, respectively) are standard and correct. The use of finite-difference methods to approximate the solution of the resulting ordinary differential equation (ODE) is also a standard and scientifically valid numerical technique. The problem is free of any pseudoscience or factual errors.\n-   **Well-Posed:** The problem is self-contained and provides all necessary information to construct and solve the specified discrete system. The SDE, domain, boundary behavior, and the precise form of the discrete boundary conditions are all given. The task is to solve a specific system of linear equations, which is a well-posed mathematical problem.\n-   **Objective:** The problem is stated using precise and unambiguous mathematical language. There are no subjective or opinion-based statements. The instructions are clear and formalizable.\n\n### Step 3: Verdict and Action\nThe problem is valid as it is scientifically grounded, well-posed, objective, and complete. I will now proceed with the solution.\n\nThe expected hitting time $u(x) = \\mathbb{E}_x[\\tau]$ for a diffusion process $dX_t = \\mu(X_t)dt + \\sigma(X_t)dW_t$ satisfies the Kolmogorov backward equation $\\mathcal{A}u(x) = -1$, where $\\mathcal{A} = \\mu(x)\\frac{d}{dx} + \\frac{1}{2}\\sigma(x)^2\\frac{d^2}{dx^2}$ is the generator of the process. For the given SDE, $dX_{t}=\\sigma\\,dW_{t}$, we have drift $\\mu(x)=0$ and diffusion $\\sigma(x)=\\sigma$. The Kolmogorov backward equation thus simplifies to a second-order ordinary differential equation:\n$$ \\frac{1}{2}\\sigma^2 u''(x) = -1 $$\n$$ u''(x) = -\\frac{2}{\\sigma^2} $$\nThe boundary conditions for this ODE are derived from the behavior of the process at the boundaries. At the absorbing boundary $x=L$, the process stops, so the time to hit the boundary from that point is zero, yielding a Dirichlet condition: $u(L)=0$. At the reflecting boundary $x=0$, there is a zero-flux condition, which translates to a Neumann condition on the expected hitting time: $u'(0)=0$.\n\nThe problem requires us to solve a finite-difference approximation of this problem. We use a uniform grid $x_i = ih$ for $i=0, 1, \\dots, N$, where $h=L/N$. The second derivative $u''(x_i)$ is approximated by a second-order central difference:\n$$ u''(x_i) \\approx \\frac{u(x_{i+1}) - 2u(x_i) + u(x_{i-1})}{h^2} = \\frac{u_{i+1} - 2u_i + u_{i-1}}{h^2} $$\nSubstituting this into the ODE yields the finite-difference equations for the interior grid points, $i=1, 2, \\dots, N-1$:\n$$ \\frac{u_{i+1} - 2u_i + u_{i-1}}{h^2} = -\\frac{2}{\\sigma^2} $$\n$$ u_{i+1} - 2u_i + u_{i-1} = -\\frac{2h^2}{\\sigma^2} $$\nLet's define the constant $C = \\frac{2h^2}{\\sigma^2}$. The interior equations are $u_{i+1} - 2u_i + u_{i-1} = -C$.\n\nThe boundary conditions are given in discrete form:\n1.  Condition at $x_N=L$: $u_N=0$.\n2.  Condition at $x_0=0$: $u_1 - u_0 = 0$, which implies $u_0 = u_1$.\n\nWe now solve this system of linear equations for $u_i$. The equation is a second-order linear non-homogeneous difference equation. The general solution is the sum of a homogeneous solution $u_i^{(h)}$ and a particular solution $u_i^{(p)}$.\n\nThe homogeneous equation is $u_{i+1} - 2u_i + u_{i-1} = 0$. The characteristic equation is $r^2 - 2r + 1 = 0$, or $(r-1)^2=0$. This has a repeated root $r=1$. The general homogeneous solution is therefore $u_i^{(h)} = A(1)^i + B i(1)^i = A + Bi$ for constants $A$ and $B$.\n\nFor the particular solution, since the right-hand side is a constant, we guess a polynomial in $i$ of the form $u_i^{(p)} = ki^2$. Substituting this into the full equation:\n$$ k(i+1)^2 - 2ki^2 + k(i-1)^2 = -C $$\n$$ k(i^2+2i+1) - 2ki^2 + k(i^2-2i+1) = -C $$\n$$ k(i^2+2i+1 - 2i^2 + i^2-2i+1) = -C $$\n$$ 2k = -C \\implies k = -\\frac{C}{2} $$\nSo, a particular solution is $u_i^{(p)} = -\\frac{C}{2}i^2$.\n\nThe general solution is the sum:\n$$ u_i = u_i^{(h)} + u_i^{(p)} = A + Bi - \\frac{C}{2}i^2 $$\nWe determine the constants $A$ and $B$ using the discrete boundary conditions.\n1.  From $u_N=0$:\n    $$ A + BN - \\frac{C}{2}N^2 = 0 \\quad (\\text{Equation 1}) $$\n2.  From $u_0 = u_1$:\n    $$ u_0 = A + B(0) - \\frac{C}{2}(0)^2 = A $$\n    $$ u_1 = A + B(1) - \\frac{C}{2}(1)^2 = A + B - \\frac{C}{2} $$\n    The condition $u_0 = u_1$ implies $A = A + B - \\frac{C}{2}$, which simplifies to $B = \\frac{C}{2}$.\n\nSubstituting $B=\\frac{C}{2}$ into Equation 1:\n$$ A + \\left(\\frac{C}{2}\\right)N - \\frac{C}{2}N^2 = 0 $$\n$$ A = \\frac{C}{2}N^2 - \\frac{C}{2}N = \\frac{C}{2}N(N-1) $$\nThus, the analytical solution for the discrete system is:\n$$ u_i = \\frac{C}{2}N(N-1) + \\frac{C}{2}i - \\frac{C}{2}i^2 $$\n$$ u_i = \\frac{C}{2} \\left[N(N-1) + i - i^2\\right] = \\frac{C}{2} \\left[N(N-1) - i(i-1)\\right] $$\n\nAs required, we verify this solution.\n-   **Interior Equation Verification:** For $i \\in \\{1, \\dots, N-1\\}$:\n    $$ u_{i+1} - 2u_i + u_{i-1} = \\frac{C}{2}\\left[N(N-1) - (i+1)i\\right] - 2\\frac{C}{2}\\left[N(N-1) - i(i-1)\\right] + \\frac{C}{2}\\left[N(N-1) - (i-1)(i-2)\\right] $$\n    $$ = \\frac{C}{2} \\left\\{ (N(N-1) - 2N(N-1) + N(N-1)) - [i(i+1) - 2i(i-1) + (i-1)(i-2)] \\right\\} $$\n    $$ = \\frac{C}{2} \\left\\{ 0 - [(i^2+i) - (2i^2-2i) + (i^2-3i+2)] \\right\\} $$\n    $$ = \\frac{C}{2} \\left\\{ -[i^2-2i^2+i^2 + i+2i-3i + 2] \\right\\} = \\frac{C}{2}[-(0+0+2)] = -C $$\n    The interior equation is satisfied.\n\n-   **Boundary Condition Verification:**\n    -   At $i=N$: $u_N = \\frac{C}{2}[N(N-1) - N(N-1)] = 0$. The condition is satisfied.\n    -   At $i=0$ and $i=1$:\n        $u_0 = \\frac{C}{2}[N(N-1) - 0(0-1)] = \\frac{C}{2}N(N-1)$.\n        $u_1 = \\frac{C}{2}[N(N-1) - 1(1-1)] = \\frac{C}{2}N(N-1)$.\n        Therefore, $u_0 = u_1$, and the condition $u_1-u_0=0$ is satisfied.\n\nThe verification is successful. Now we compute the specific value $u_2$ for the case $L=6$, $N=6$, $h=L/N=1$, and $\\sigma=1$.\nFirst, calculate the constant $C$:\n$$ C = \\frac{2h^2}{\\sigma^2} = \\frac{2(1)^2}{1^2} = 2 $$\nNow, we use the derived formula for $u_i$ with $i=2$, $N=6$, and $C=2$:\n$$ u_2 = \\frac{C}{2} \\left[N(N-1) - 2(2-1)\\right] $$\n$$ u_2 = \\frac{2}{2} \\left[6(6-1) - 2(1)\\right] $$\n$$ u_2 = 1 \\times [6(5) - 2] $$\n$$ u_2 = 30 - 2 $$\n$$ u_2 = 28 $$\nThe value of $u_2$ is $28$.", "answer": "$$\n\\boxed{28}\n$$", "id": "3041788"}]}