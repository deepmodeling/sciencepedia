{"hands_on_practices": [{"introduction": "A cornerstone of studying stochastic processes is understanding when a process first reaches a certain value. This exercise explores the first passage time for a standard Brownian motion, a process with deep symmetries. You will use the celebrated reflection principle, an elegant argument based on the strong Markov property, to derive the exact distribution of this hitting time [@problem_id:3058442]. This practice is fundamental for building intuition about the path behavior of Brownian motion and is a key ingredient in pricing barrier options in finance.", "problem": "Let $\\{B_t : t \\ge 0\\}$ be a one-dimensional standard Brownian motion with $B_0 = 0$. For a fixed level $a \\gt 0$, define the first passage time $\\tau_a := \\inf\\{t \\ge 0 : B_t = a\\}$. Starting only from the defining properties of Brownian motion (independent and stationary Gaussian increments, continuity of sample paths, and the strong Markov property), derive the distribution function of $\\tau_a$. In particular, show that for every $t \\gt 0$, one has $\\mathbb{P}(\\tau_a \\le t) = \\mathbb{P}(|B_t| \\ge a)$, and then identify the probability density function (PDF) of $\\tau_a$ on $(0,\\infty)$. Your final answer must be a single closed-form analytic expression for the PDF of $\\tau_a$ in terms of $a$ and $t$. No rounding is required.", "solution": "The problem as stated is scientifically grounded, well-posed, and objective. It is a standard problem in the theory of stochastic processes, relying on fundamental definitions and properties of Brownian motion. All necessary information is provided, and the problem is free from any logical contradictions or factual unsoundness. We may therefore proceed with a formal derivation.\n\nLet $\\{B_t : t \\ge 0\\}$ be a one-dimensional standard Brownian motion starting from $B_0 = 0$. The defining properties we shall use are:\n1. For any $0 \\le s \\lt t$, the increment $B_t - B_s$ is a Gaussian random variable with mean $0$ and variance $t-s$, i.e., $B_t - B_s \\sim \\mathcal{N}(0, t-s)$. Increments over disjoint time intervals are independent. This implies stationarity and independence of increments.\n2. The sample paths $t \\mapsto B_t(\\omega)$ are continuous almost surely.\n3. The process possesses the strong Markov property, which states that for any stopping time $\\tau$ with respect to the natural filtration of $B_t$, the process $\\{B_{\\tau+t} - B_\\tau : t \\ge 0\\}$ is a standard Brownian motion independent of the pre-$\\tau$ sigma-algebra $\\mathcal{F}_\\tau$.\n\nWe are asked to find the probability density function (PDF) of the first passage time $\\tau_a = \\inf\\{t \\ge 0 : B_t = a\\}$ for a fixed level $a \\gt 0$.\n\nThe derivation proceeds in two main steps. First, we determine the cumulative distribution function (CDF) of $\\tau_a$, denoted $F_{\\tau_a}(t) = \\mathbb{P}(\\tau_a \\le t)$. Second, we differentiate the CDF to obtain the PDF, $f_{\\tau_a}(t)$.\n\n**Step 1: Derivation of the Cumulative Distribution Function (CDF) of $\\tau_a$**\n\nWe aim to show that for any $t \\gt 0$, $\\mathbb{P}(\\tau_a \\le t) = \\mathbb{P}(|B_t| \\ge a)$.\nConsider the event $\\{\\tau_a \\le t\\}$, which means the process reaches level $a$ at or before time $t$. We can partition this event based on the value of $B_t$. Using the law of total probability, we write:\n$$\n\\mathbb{P}(\\tau_a \\le t) = \\mathbb{P}(\\tau_a \\le t, B_t \\ge a) + \\mathbb{P}(\\tau_a \\le t, B_t \\lt a)\n$$\nLet's analyze the first term. Since $B_0 = 0$ and the sample paths are continuous, for the process to reach a value $B_t \\ge a$, it must have passed through the level $a$ at some time less than or equal to $t$. This means that the event $\\{B_t \\ge a\\}$ implies the event $\\{\\tau_a \\le t\\}$. Therefore, the intersection is simply the event $\\{B_t \\ge a\\}$:\n$$\n\\{\\tau_a \\le t, B_t \\ge a\\} = \\{B_t \\ge a\\}\n$$\nThus, the first term becomes $\\mathbb{P}(\\tau_a \\le t, B_t \\ge a) = \\mathbb{P}(B_t \\ge a)$.\n\nNow, we analyze the second term, $\\mathbb{P}(\\tau_a \\le t, B_t \\lt a)$, using the strong Markov property at the stopping time $\\tau_a$.\nOn the event $\\{\\tau_a \\le t\\}$, the strong Markov property implies that the process $X_s := B_{\\tau_a + s} - B_{\\tau_a}$ for $s \\ge 0$ is a standard Brownian motion that is independent of the filtration $\\mathcal{F}_{\\tau_a}$. By continuity, $B_{\\tau_a} = a$.\nThe condition $B_t \\lt a$ can be rewritten in terms of the post-$\\tau_a$ process. On the set $\\{\\omega : \\tau_a(\\omega) \\le t\\}$, we have:\n$$\nB_t = B_{\\tau_a + (t - \\tau_a)} = B_{\\tau_a} + (B_{\\tau_a + (t - \\tau_a)} - B_{\\tau_a}) = a + X_{t-\\tau_a}\n$$\nSo the condition $B_t \\lt a$ is equivalent to $a + X_{t-\\tau_a} \\lt a$, which simplifies to $X_{t-\\tau_a} \\lt 0$.\nTherefore,\n$$\n\\mathbb{P}(\\tau_a \\le t, B_t \\lt a) = \\mathbb{P}(\\tau_a \\le t, X_{t-\\tau_a} \\lt 0)\n$$\nWe can evaluate this probability using conditioning. Let $\\mathbb{I}_A$ be the indicator function for an event $A$.\n\\begin{align*}\n\\mathbb{P}(\\tau_a \\le t, B_t \\lt a) &= \\mathbb{E}[\\mathbb{I}_{\\{\\tau_a \\le t\\}} \\mathbb{I}_{\\{B_t \\lt a\\}}] \\\\\n&= \\mathbb{E}[\\mathbb{E}[\\mathbb{I}_{\\{\\tau_a \\le t\\}} \\mathbb{I}_{\\{B_t \\lt a\\}} | \\mathcal{F}_{\\tau_a}]] \\\\\n&= \\mathbb{E}[\\mathbb{I}_{\\{\\tau_a \\le t\\}} \\mathbb{P}(B_t \\lt a | \\mathcal{F}_{\\tau_a})] \\quad \\text{(since } \\{\\tau_a \\le t\\} \\in \\mathcal{F}_{\\tau_a})\n\\end{align*}\nOn the event $\\{\\tau_a \\le t\\}$, we have $B_t \\lt a \\iff X_{t-\\tau_a} \\lt 0$. Since the process $X$ is independent of $\\mathcal{F}_{\\tau_a}$, and $\\tau_a$ is $\\mathcal{F}_{\\tau_a}$-measurable, we have:\n$$\n\\mathbb{P}(B_t \\lt a | \\mathcal{F}_{\\tau_a}) = \\mathbb{P}(X_{t-\\tau_a} \\lt 0 | \\mathcal{F}_{\\tau_a}) = \\mathbb{P}(X_{t-\\tau_a} \\lt 0)\n$$\nThe random variable $X_{t-\\tau_a}$ follows a normal distribution centered at $0$. By the symmetry of the Gaussian distribution, $\\mathbb{P}(X_{t-\\tau_a} \\lt 0) = \\frac{1}{2}$.\nThis gives:\n$$\n\\mathbb{P}(\\tau_a \\le t, B_t \\lt a) = \\mathbb{E}\\left[\\mathbb{I}_{\\{\\tau_a \\le t\\}} \\cdot \\frac{1}{2}\\right] = \\frac{1}{2} \\mathbb{P}(\\tau_a \\le t)\n$$\nSubstituting our findings for both terms back into the original equation:\n$$\n\\mathbb{P}(\\tau_a \\le t) = \\mathbb{P}(B_t \\ge a) + \\frac{1}{2} \\mathbb{P}(\\tau_a \\le t)\n$$\nSolving for $\\mathbb{P}(\\tau_a \\le t)$, we find:\n$$\n\\frac{1}{2} \\mathbb{P}(\\tau_a \\le t) = \\mathbb{P}(B_t \\ge a) \\implies \\mathbb{P}(\\tau_a \\le t) = 2 \\mathbb{P}(B_t \\ge a)\n$$\nThis result is known as the reflection principle. To complete the first part of the problem, we must relate this to $\\mathbb{P}(|B_t| \\ge a)$.\nFor a standard Brownian motion, $B_t \\sim \\mathcal{N}(0,t)$. The distribution of $B_t$ is symmetric about $0$. Thus, for any $a \\gt 0$, $\\mathbb{P}(B_t \\ge a) = \\mathbb{P}(B_t \\le -a)$.\nThe event $\\{|B_t| \\ge a\\}$ is the disjoint union of $\\{B_t \\ge a\\}$ and $\\{B_t \\le -a\\}$ (since $\\mathbb{P}(B_t=a)=0$).\n$$\n\\mathbb{P}(|B_t| \\ge a) = \\mathbb{P}(B_t \\ge a) + \\mathbb{P}(B_t \\le -a) = \\mathbb{P}(B_t \\ge a) + \\mathbb{P}(B_t \\ge a) = 2 \\mathbb{P}(B_t \\ge a)\n$$\nComparing this with our derived expression for $\\mathbb{P}(\\tau_a \\le t)$, we have established the required identity:\n$$\n\\mathbb{P}(\\tau_a \\le t) = \\mathbb{P}(|B_t| \\ge a)\n$$\n\n**Step 2: Derivation of the Probability Density Function (PDF) of $\\tau_a$**\n\nThe CDF of $\\tau_a$ for $t \\gt 0$ is $F_{\\tau_a}(t) = \\mathbb{P}(\\tau_a \\le t) = 2 \\mathbb{P}(B_t \\ge a)$.\nLet $Z$ be a standard normal random variable, $Z \\sim \\mathcal{N}(0,1)$. We can write $B_t = \\sqrt{t} Z$.\n$$\nF_{\\tau_a}(t) = 2 \\mathbb{P}(\\sqrt{t} Z \\ge a) = 2 \\mathbb{P}\\left(Z \\ge \\frac{a}{\\sqrt{t}}\\right)\n$$\nLet $\\Phi(z) = \\mathbb{P}(Z \\le z)$ be the CDF of the standard normal distribution. Then $\\mathbb{P}(Z \\ge z) = 1 - \\Phi(z)$.\n$$\nF_{\\tau_a}(t) = 2 \\left(1 - \\Phi\\left(\\frac{a}{\\sqrt{t}}\\right)\\right)\n$$\nThe PDF, $f_{\\tau_a}(t)$, is the derivative of the CDF with respect to $t$, for $t \\gt 0$.\n$$\nf_{\\tau_a}(t) = \\frac{d}{dt} F_{\\tau_a}(t) = \\frac{d}{dt} \\left[2 \\left(1 - \\Phi\\left(a t^{-1/2}\\right)\\right)\\right] = -2 \\frac{d}{dt} \\Phi\\left(a t^{-1/2}\\right)\n$$\nUsing the chain rule, and noting that $\\frac{d}{dz}\\Phi(z) = \\phi(z) = \\frac{1}{\\sqrt{2\\pi}} \\exp\\left(-\\frac{z^2}{2}\\right)$, the PDF of the standard normal distribution:\n\\begin{align*}\nf_{\\tau_a}(t) &= -2 \\cdot \\phi\\left(a t^{-1/2}\\right) \\cdot \\frac{d}{dt}\\left(a t^{-1/2}\\right) \\\\\n&= -2 \\cdot \\phi\\left(\\frac{a}{\\sqrt{t}}\\right) \\cdot \\left(a \\cdot \\left(-\\frac{1}{2}\\right) t^{-3/2}\\right) \\\\\n&= -2 \\cdot \\phi\\left(\\frac{a}{\\sqrt{t}}\\right) \\cdot \\left(-\\frac{a}{2 t^{3/2}}\\right) \\\\\n&= \\frac{a}{t^{3/2}} \\phi\\left(\\frac{a}{\\sqrt{t}}\\right)\n\\end{align*}\nNow we substitute the expression for $\\phi(z)$:\n$$\nf_{\\tau_a}(t) = \\frac{a}{t^{3/2}} \\cdot \\frac{1}{\\sqrt{2\\pi}} \\exp\\left(-\\frac{1}{2} \\left(\\frac{a}{\\sqrt{t}}\\right)^2\\right) = \\frac{a}{t^{3/2} \\sqrt{2\\pi}} \\exp\\left(-\\frac{a^2}{2t}\\right)\n$$\nThis is the PDF of the first passage time $\\tau_a$ for $t \\gt 0$. This distribution is an instance of the Lévy distribution. The expression is valid for $t \\in (0, \\infty)$.\n\nFinal check: The derived function is strictly positive for $a \\gt 0$ and $t \\gt 0$. The integral $\\int_0^\\infty f_{\\tau_a}(t) dt$ can be shown to be equal to $1$, confirming that it is a valid probability density function.\n\nThe final result is the closed-form analytic expression for the PDF.\n$$\nf_{\\tau_a}(t) = \\frac{a}{\\sqrt{2\\pi} t^{3/2}} \\exp\\left(-\\frac{a^2}{2t}\\right)\n$$", "answer": "$$\\boxed{\\frac{a}{\\sqrt{2\\pi} t^{3/2}} \\exp\\left(-\\frac{a^2}{2t}\\right)}$$", "id": "3058442"}, {"introduction": "While the reflection principle is powerful, it does not apply to more general diffusion processes where the drift $\\mu(x)$ and diffusion $\\sigma(x)$ coefficients are not constant. This practice introduces a more robust and widely applicable technique: connecting the hitting probability to a harmonic function associated with the process's infinitesimal generator, $L$. By setting up and solving the boundary value problem $Lu=0$, you will directly compute the probability of a process exiting an interval at a specific boundary, a foundational skill that links stochastic calculus with the theory of differential equations [@problem_id:3073474].", "problem": "Consider the one-dimensional stochastic differential equation (SDE) \n$$\ndX_{t} \\;=\\; X_{t}\\,dt \\;+\\; \\sqrt{1+X_{t}^{2}}\\,dW_{t},\n$$\nwhere $W_{t}$ is a standard Brownian motion (BM). Let $a \\lt b$ be fixed real numbers, and suppose the process is absorbed upon first hitting either boundary. Define the first exit time \n$$\n\\tau \\;=\\; \\inf\\{\\, t\\ge 0 \\,:\\, X_{t}\\notin (a,b)\\,\\}.\n$$\nFor an initial point $x_{0}\\in(a,b)$, let \n$$\nu(x) \\;=\\; \\mathbb{P}_{x}\\big(\\, X_{\\tau}=b \\,\\big)\n$$\ndenote the probability of exiting the interval at $b$ before $a$ when starting at $X_{0}=x$.\n\nUsing only foundational tools for one-dimensional diffusions (the infinitesimal generator and Dynkin’s formula for stopped processes), derive the boundary value problem that $u$ must satisfy on $(a,b)$ with absorbing boundary conditions at $a$ and $b$, and solve it exactly. Then, express the hitting probability $u(x_{0})$ in closed form as a function of $a$, $b$, and $x_{0}$. Provide your final answer as a single analytic expression. No numerical rounding is required.", "solution": "The problem asks for the probability that a one-dimensional diffusion process exits a given interval $(a,b)$ at the upper boundary $b$. The process $X_t$ is governed by the stochastic differential equation (SDE):\n$$\ndX_{t} = X_{t}\\,dt + \\sqrt{1+X_{t}^{2}}\\,dW_{t}\n$$\nwith an initial state $X_0 = x_0 \\in (a, b)$.\n\nThis SDE is of the general form $dX_t = \\mu(X_t)dt + \\sigma(X_t)dW_t$, with drift coefficient $\\mu(x) = x$ and diffusion coefficient $\\sigma(x) = \\sqrt{1+x^2}$.\n\nThe hitting probability is defined as $u(x) = \\mathbb{P}_{x}(X_{\\tau}=b)$, where $\\tau = \\inf\\{t \\ge 0 : X_t \\notin (a,b)\\}$ is the first exit time from the interval $(a,b)$.\n\nA fundamental result in the theory of one-dimensional diffusions, derivable from Dynkin's formula, states that the hitting probability $u(x)$ is a solution to the boundary value problem (BVP) defined by the infinitesimal generator of the process. The infinitesimal generator $\\mathcal{L}$ for a diffusion with drift $\\mu(x)$ and diffusion $\\sigma(x)$ is given by the operator:\n$$\n\\mathcal{L} = \\mu(x)\\frac{d}{dx} + \\frac{1}{2}\\sigma(x)^2\\frac{d^2}{dx^2}\n$$\nFor the specific process $X_t$ given, the generator is:\n$$\n\\mathcal{L} = x\\frac{d}{dx} + \\frac{1}{2}\\left(\\sqrt{1+x^2}\\right)^2\\frac{d^2}{dx^2} = x\\frac{d}{dx} + \\frac{1}{2}(1+x^2)\\frac{d^2}{dx^2}\n$$\nThe hitting probability $u(x)$ satisfies the second-order ordinary differential equation (ODE) $\\mathcal{L}u(x) = 0$ for all $x \\in (a,b)$. This is because the process $u(X_t)$ is a martingale when $\\mathcal{L}u = 0$, and the optional stopping theorem can be applied at the stopping time $\\tau$.\n\nThe BVP for $u(x)$ is therefore:\n$$\n\\frac{1}{2}(1+x^2)\\frac{d^2u}{dx^2} + x\\frac{du}{dx} = 0, \\quad x\\in(a,b)\n$$\nThe boundary conditions are determined by the definition of absorption. If the process starts at a boundary, it is immediately absorbed.\nIf $x=a$, the process has hit $a$ without hitting $b$, so the probability of exiting at $b$ is $0$. Thus, $u(a) = 0$.\nIf $x=b$, the process has hit $b$, so the probability of exiting at $b$ is $1$. Thus, $u(b) = 1$.\n\nThe BVP to solve is:\n$$\n\\begin{cases}\n\\frac{1}{2}(1+x^2)u''(x) + xu'(x) = 0 \\\\\nu(a) = 0 \\\\\nu(b) = 1\n\\end{cases}\n$$\nTo solve the ODE, we can use a reduction of order. Let $v(x) = u'(x)$. The equation becomes a first-order linear ODE for $v(x)$:\n$$\n\\frac{1}{2}(1+x^2)v'(x) + xv(x) = 0\n$$\nThis equation is separable:\n$$\n\\frac{v'(x)}{v(x)} = -\\frac{2x}{1+x^2}\n$$\nIntegrating both sides with respect to $x$:\n$$\n\\int \\frac{1}{v} dv = \\int -\\frac{2x}{1+x^2} dx\n$$\nThe integral of the right-hand side is $-\\ln(1+x^2)$ (since $1+x^2 \\gt 0$).\n$$\n\\ln|v(x)| = -\\ln(1+x^2) + K_0\n$$\nwhere $K_0$ is a constant of integration. Exponentiating both sides gives:\n$$\n|v(x)| = \\exp(K_0) \\exp(-\\ln(1+x^2)) = \\frac{\\exp(K_0)}{1+x^2}\n$$\nabsorbing the sign and constant into a new constant $C_1$:\n$$\nv(x) = \\frac{C_1}{1+x^2}\n$$\nSince $v(x) = u'(x)$, we integrate again to find $u(x)$:\n$$\nu(x) = \\int u'(x) dx = \\int \\frac{C_1}{1+x^2} dx = C_1 \\arctan(x) + C_2\n$$\nwhere $C_2$ is the second constant of integration.\n\nNow we apply the boundary conditions to determine $C_1$ and $C_2$:\n$1$. $u(a) = 0 \\implies C_1 \\arctan(a) + C_2 = 0$\n$2$. $u(b) = 1 \\implies C_1 \\arctan(b) + C_2 = 1$\n\nFrom equation $1$, we have $C_2 = -C_1 \\arctan(a)$. Substituting this into equation $2$:\n$$\nC_1 \\arctan(b) - C_1 \\arctan(a) = 1\n$$\n$$\nC_1 (\\arctan(b) - \\arctan(a)) = 1\n$$\nSolving for $C_1$:\n$$\nC_1 = \\frac{1}{\\arctan(b) - \\arctan(a)}\n$$\nNote that since $a \\lt b$ and $\\arctan$ is a strictly increasing function, the denominator is non-zero.\nNow we find $C_2$:\n$$\nC_2 = -C_1 \\arctan(a) = -\\frac{\\arctan(a)}{\\arctan(b) - \\arctan(a)}\n$$\nSubstituting $C_1$ and $C_2$ back into the expression for $u(x)$:\n$$\nu(x) = \\left(\\frac{1}{\\arctan(b) - \\arctan(a)}\\right)\\arctan(x) - \\frac{\\arctan(a)}{\\arctan(b) - \\arctan(a)}\n$$\nCombining the terms gives the solution for $u(x)$:\n$$\nu(x) = \\frac{\\arctan(x) - \\arctan(a)}{\\arctan(b) - \\arctan(a)}\n$$\nThe problem asks for the probability $u(x_0)$ for an initial point $x_0 \\in (a,b)$. We simply evaluate the expression at $x=x_0$.\n$$\nu(x_0) = \\frac{\\arctan(x_0) - \\arctan(a)}{\\arctan(b) - \\arctan(a)}\n$$\nThis expression provides the probability of the process hitting the boundary $b$ before hitting the boundary $a$, starting from $x_0$.", "answer": "$$\n\\boxed{\\frac{\\arctan(x_{0}) - \\arctan(a)}{\\arctan(b) - \\arctan(a)}}\n$$", "id": "3073474"}, {"introduction": "This final practice solidifies your understanding by contrasting the special case of Brownian motion with the general theory for one-dimensional diffusions. It challenges you to identify why methods like the reflection principle fail when spatial homogeneity is lost and to recognize the universal tool that replaces it. By working through this problem, you will appreciate the central role of the infinitesimal generator and the scale function, which provides a unified framework for solving for hitting probabilities in any one-dimensional SDE [@problem_id:3058453].", "problem": "Consider the one-dimensional Itô Stochastic Differential Equation (SDE) $dX_t = \\mu(X_t)\\,dt + \\sigma(X_t)\\,dW_t$, where $W_t$ is a standard Brownian motion (BM), $\\mu$ and $\\sigma$ are measurable functions with $\\sigma$ continuous and satisfying $0 \\lt \\sigma_0 \\le \\sigma(x) \\le \\sigma_1 \\lt \\infty$ for all $x \\in \\mathbb{R}$, and the SDE admits a unique weak solution that is non-explosive. Fix an interval $(a,b)$ with $a \\lt b$ and define the first hitting times $\\tau_a = \\inf\\{t \\ge 0 : X_t = a\\}$ and $\\tau_b = \\inf\\{t \\ge 0 : X_t = b\\}$. Let $u(x) = \\mathbb{P}_x\\{\\tau_b \\lt \\tau_a\\}$ denote the probability of hitting $b$ before $a$ when starting from $X_0 = x \\in (a,b)$. The classical reflection principle for BM is often used to compute hitting probabilities and supremum distributions when coefficients are constant. Your task is to analyze when a reflection-principle-like argument fails for nonconstant diffusion coefficient $\\sigma(x)$ and to identify an effective alternative approach.\n\nWhich of the following statements are correct?\n\nA. For the driftless diffusion $dX_t = \\sigma(X_t)\\,dW_t$ with $\\mu \\equiv 0$ and nonconstant $\\sigma$, the pathwise reflection at level $b$ preserves the law and yields $u(x) = \\dfrac{x-a}{b-a}$, exactly as in the constant-coefficient Brownian case.\n\nB. The function $u(x) = \\mathbb{P}_x\\{\\tau_b \\lt \\tau_a\\}$ is characterized as the unique bounded solution on $(a,b)$ of the boundary value problem $L u = 0$ with $u(a) = 0$ and $u(b) = 1$, where the infinitesimal generator $L$ acts on twice continuously differentiable functions by $L f(x) = \\dfrac{1}{2}\\sigma^2(x)\\,f''(x) + \\mu(x)\\,f'(x)$.\n\nC. Even when $\\sigma$ is nonconstant and $\\mu \\equiv 0$, the supremum distribution satisfies the reflection identity $\\mathbb{P}_x\\{\\sup_{t \\le T} X_t \\ge b\\} = 2\\,\\mathbb{P}_x\\{X_T \\ge b\\}$ for all $T \\gt 0$.\n\nD. A robust alternative to the reflection principle is to transform to the scale coordinate $s(x)$ defined (up to an affine change) by $s'(x) = \\exp\\!\\Big(-\\displaystyle\\int^x \\dfrac{2\\mu(y)}{\\sigma^2(y)}\\,dy\\Big)$; in this coordinate the diffusion has zero drift, and the hitting probability is linear in $s$, namely $u(x) = \\dfrac{s(x) - s(a)}{s(b) - s(a)}$.\n\nE. One can always recover the reflection principle by applying the time change $\\theta(t) = \\displaystyle\\int_0^t \\sigma^{-2}(X_s)\\,ds$, which turns $X$ into a standard Brownian motion, hence $u(x)$ is linear in $x$ for all choices of $\\mu$ and $\\sigma$.", "solution": "This problem tests the understanding of hitting probabilities for a general one-dimensional Itô diffusion, contrasting it with the special case of standard Brownian motion. Let's analyze each statement.\n\n**A. Incorrect.** The reflection principle for standard Brownian motion relies on the spatial homogeneity of the process, a symmetry that is broken when the diffusion coefficient $\\sigma(x)$ is not constant. A path reflected at level $b$, say $\\tilde{X}_t = 2b - X_t$, would follow the SDE $d\\tilde{X}_t = -\\sigma(2b - \\tilde{X}_t)dW_t$. This process does not have the same law as $X_t$ unless $\\sigma(x)$ happens to be symmetric around $b$. Thus, the reflection principle does not hold. Although the hitting probability formula for a driftless ($\\mu \\equiv 0$) diffusion is indeed $u(x) = \\frac{x-a}{b-a}$ (because the ODE $Lu=0$ becomes $\\frac{1}{2}\\sigma^2(x)u''(x)=0$, which implies $u''(x)=0$), this result is a consequence of solving the generator equation, not the reflection principle.\n\n**B. Correct.** This is a fundamental theorem in the theory of stochastic processes. The function $u(x)$, representing the hitting probability, is harmonic with respect to the process's infinitesimal generator $L$. Itô's formula shows that if $Lu=0$, then $u(X_t)$ is a local martingale. Applying the Optional Stopping Theorem to the bounded martingale $u(X_{t \\wedge \\tau})$ (where $\\tau$ is the first exit time) with the boundary conditions $u(a)=0$ and $u(b)=1$ directly yields $u(x) = \\mathbb{E}_x[u(X_\\tau)] = \\mathbb{P}_x\\{X_\\tau = b\\}$. The given form of the generator $L$ is correct. Under the problem's conditions, this boundary value problem has a unique bounded solution.\n\n**C. Incorrect.** The identity $\\mathbb{P}_x\\{\\sup_{t \\le T} X_t \\ge b\\} = 2\\,\\mathbb{P}_x\\{X_T \\ge b\\}$ is a direct consequence of the reflection principle. Since the reflection principle fails for a general non-constant $\\sigma(x)$, as explained for statement A, this identity does not hold either.\n\n**D. Correct.** This statement accurately describes the scale function method, which is the general and robust technique for solving for hitting probabilities in one dimension. The scale function $s(x)$ is defined such that it solves $Ls(x)=0$. This construction ensures that the transformed process $Y_t = s(X_t)$ is a driftless diffusion (a local martingale). The problem of hitting $b$ before $a$ for process $X_t$ is transformed into hitting $s(b)$ before $s(a)$ for the driftless process $Y_t$. For any 1D driftless diffusion, the hitting probability is a linear interpolation between the boundaries, which gives the formula $u(x) = \\frac{s(x) - s(a)}{s(b) - s(a)}$. The definition of the scale density $s'(x)$ is also correctly stated.\n\n**E. Incorrect.** This statement confuses several concepts. To transform a general Itô diffusion into a standard Brownian motion, one typically needs *both* a spatial transformation (using the scale function $s(x)$ to remove the drift) and a random time change. The proposed time change alone is insufficient if the drift $\\mu(x)$ is non-zero. Furthermore, the final claim that $u(x)$ is linear in $x$ is false. As established in D, $u(x)$ is linear in the *scale function coordinate* $s(x)$, not in the original coordinate $x$ (unless $s(x)$ itself is a linear function of $x$, which generally only happens when $\\mu \\equiv 0$).", "answer": "$$\\boxed{BD}$$", "id": "3058453"}]}