{"hands_on_practices": [{"introduction": "The Kolmogorov forward equation, also known as the Fokker-Planck equation, governs the evolution of a system's probability density. This practice will guide you through its fundamental derivation by finding the formal adjoint, $L^{\\ast}$, of the infinitesimal generator, $L$, of an Itô diffusion [@problem_id:3063166]. This mathematical exercise is crucial as it reveals the precise relationship between the microscopic dynamics defined by a stochastic differential equation and the resulting macroscopic evolution of the probability distribution.", "problem": "Consider an Itô diffusion in $\\mathbb{R}^{d}$ defined by the stochastic differential equation $dX_{t} = b(X_{t})\\,dt + \\sigma(X_{t})\\,dW_{t}$, where $b : \\mathbb{R}^{d} \\to \\mathbb{R}^{d}$ is a continuously differentiable drift field, $\\sigma : \\mathbb{R}^{d} \\to \\mathbb{R}^{d \\times m}$ is a continuously differentiable diffusion matrix, and $W_{t}$ is a standard $m$-dimensional Wiener process. Let $a(x) = \\sigma(x)\\sigma(x)^{\\top}$ denote the diffusion (covariance) matrix with entries $a_{ij}(x)$. The infinitesimal generator $L$ of this diffusion acts on a twice continuously differentiable, compactly supported test function $f : \\mathbb{R}^{d} \\to \\mathbb{R}$ as $Lf(x) = b(x)\\cdot \\nabla f(x) + \\frac{1}{2}\\sum_{i,j=1}^{d} a_{ij}(x)\\,\\partial_{x_{i}}\\partial_{x_{j}} f(x)$.\n\nDefine the formal adjoint $L^{\\ast}$ with respect to the Lebesgue inner product so that for all sufficiently smooth and rapidly decaying functions $f, p : \\mathbb{R}^{d} \\to \\mathbb{R}$,\n$$\\int_{\\mathbb{R}^{d}} p(x)\\,Lf(x)\\,dx = \\int_{\\mathbb{R}^{d}} f(x)\\,L^{\\ast}p(x)\\,dx,$$\nunder the assumptions that boundary terms vanish due to decay at infinity. Starting from the core definitions above and using only integration by parts and standard vector calculus, derive the explicit expression for $L^{\\ast}p(x)$ in terms of $b(x)$, $a_{ij}(x)$, and their spatial derivatives. Present your final result as a single closed-form analytic expression in $x$. No numerical approximation is required.", "solution": "The user wants to find the explicit expression for the formal adjoint $L^{\\ast}$ of the infinitesimal generator $L$.\n\n### Step 1: Extract Givens\n- Itô diffusion: $dX_{t} = b(X_{t})\\,dt + \\sigma(X_{t})\\,dW_{t}$\n- Domain: $\\mathbb{R}^{d}$\n- Drift field: $b : \\mathbb{R}^{d} \\to \\mathbb{R}^{d}$, continuously differentiable.\n- Diffusion matrix: $\\sigma : \\mathbb{R}^{d} \\to \\mathbb{R}^{d \\times m}$, continuously differentiable.\n- Wiener process: $W_{t}$ is a standard $m$-dimensional Wiener process.\n- Diffusion (covariance) matrix: $a(x) = \\sigma(x)\\sigma(x)^{\\top}$ with components $a_{ij}(x)$.\n- Infinitesimal generator: $Lf(x) = b(x)\\cdot \\nabla f(x) + \\frac{1}{2}\\sum_{i,j=1}^{d} a_{ij}(x)\\,\\partial_{x_{i}}\\partial_{x_{j}} f(x)$.\n- Test function space for $f$: Twice continuously differentiable, compactly supported functions from $\\mathbb{R}^{d}$ to $\\mathbb{R}$.\n- Definition of formal adjoint $L^{\\ast}$: For sufficiently smooth and rapidly decaying functions $f, p : \\mathbb{R}^{d} \\to \\mathbb{R}$, the adjoint $L^{\\ast}$ satisfies the relation $\\int_{\\mathbb{R}^{d}} p(x)\\,Lf(x)\\,dx = \\int_{\\mathbb{R}^{d}} f(x)\\,L^{\\ast}p(x)\\,dx$.\n- Assumption: Boundary terms resulting from integration by parts over $\\mathbb{R}^{d}$ vanish due to the rapid decay of the functions at infinity.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientifically Grounded:** The problem is a standard, fundamental derivation in the theory of stochastic differential equations and mathematical physics. The infinitesimal generator and its adjoint (the Fokker-Planck operator) are canonical concepts.\n- **Well-Posed:** The problem is clearly stated, with all necessary definitions and conditions provided. The task is to perform a definite mathematical derivation which leads to a unique expression.\n- **Objective:** The problem is phrased in precise, objective mathematical language.\n- **Invalidity Checklist:**\n    - The problem does not violate any scientific principles; it is a core theoretical exercise.\n    - It is directly relevant to the topic of the Kolmogorov forward equation.\n    - The provided information is complete and consistent.\n    - The problem is purely mathematical and poses no issue of physical infeasibility.\n    - It is well-posed and leads to a unique, meaningful result.\n    - The derivation is not trivial and demonstrates a key relationship in the field.\n    - The result is mathematically verifiable.\n\n### Step 3: Verdict and Action\nThe problem is valid. The derivation of the operator $L^{\\ast}$ will now be performed as requested.\n\nWe begin with the defining relation for the formal adjoint $L^{\\ast}$:\n$$\n\\int_{\\mathbb{R}^{d}} p(x)\\,Lf(x)\\,dx = \\int_{\\mathbb{R}^{d}} f(x)\\,L^{\\ast}p(x)\\,dx\n$$\nWe substitute the expression for the infinitesimal generator $L$ into the left-hand side of the equation. For clarity, we will write the dot product explicitly as a sum over components, where $b(x) = (b_1(x), \\dots, b_d(x))$ and $\\nabla f(x) = (\\partial_{x_1}f(x), \\dots, \\partial_{x_d}f(x))$, and use the notation $\\partial_{x_i}$ for the partial derivative $\\frac{\\partial}{\\partial x_i}$.\n$$\n\\int_{\\mathbb{R}^{d}} p(x)\\,Lf(x)\\,dx = \\int_{\\mathbb{R}^{d}} p(x) \\left( \\sum_{i=1}^{d} b_i(x) \\partial_{x_i} f(x) + \\frac{1}{2}\\sum_{i,j=1}^{d} a_{ij}(x)\\,\\partial_{x_i}\\partial_{x_j} f(x) \\right) dx\n$$\nWe can split this integral into two parts corresponding to the drift and diffusion terms:\n$$\n\\int_{\\mathbb{R}^{d}} p(x)\\,Lf(x)\\,dx = \\underbrace{\\int_{\\mathbb{R}^{d}} \\sum_{i=1}^{d} p(x) b_i(x) \\partial_{x_i} f(x) \\,dx}_{\\text{Drift Term}} + \\underbrace{\\int_{\\mathbb{R}^{d}} \\frac{1}{2}\\sum_{i,j=1}^{d} p(x) a_{ij}(x) \\partial_{x_i}\\partial_{x_j} f(x) \\,dx}_{\\text{Diffusion Term}}\n$$\nOur goal is to use integration by parts to move all derivatives from $f(x)$ onto the other terms, thereby isolating $f(x)$ as a common factor in the integrand. The vanishing of boundary terms at infinity is crucial and is guaranteed by the assumption that $f$ and $p$ are smooth and rapidly decaying (e.g., $f$ being compactly supported).\n\nLet's first analyze the drift term. For each component $i$ in the sum, we apply integration by parts with respect to the variable $x_i$:\n$$\n\\int_{\\mathbb{R}^{d}} p(x) b_i(x) \\partial_{x_i} f(x) \\,dx = - \\int_{\\mathbb{R}^{d}} f(x) \\partial_{x_i} [p(x) b_i(x)] \\,dx\n$$\nSumming over all $i$ from $1$ to $d$, the drift term becomes:\n$$\n\\int_{\\mathbb{R}^{d}} \\sum_{i=1}^{d} p(x) b_i(x) \\partial_{x_i} f(x) \\,dx = \\int_{\\mathbb{R}^{d}} f(x) \\left( - \\sum_{i=1}^{d} \\partial_{x_i} [p(x) b_i(x)] \\right) dx\n$$\nNow, let's analyze the diffusion term. This requires two applications of integration by parts for each $(i, j)$ pair in the sum.\n$$\n\\frac{1}{2}\\sum_{i,j=1}^{d} \\int_{\\mathbb{R}^{d}} p(x) a_{ij}(x) \\partial_{x_i}\\partial_{x_j} f(x) \\,dx = \\frac{1}{2}\\sum_{i,j=1}^{d} \\int_{\\mathbb{R}^{d}} [p(x) a_{ij}(x)] [\\partial_{x_i}\\partial_{x_j} f(x)] \\,dx\n$$\nFirst, we integrate by parts with respect to $x_j$, moving the derivative $\\partial_{x_j}$ from $f(x)$ onto the term $p(x) a_{ij}(x)$:\n$$\n\\int_{\\mathbb{R}^{d}} [p(x) a_{ij}(x)] \\partial_{x_j}(\\partial_{x_i} f(x)) \\,dx = - \\int_{\\mathbb{R}^{d}} [\\partial_{x_j}(p(x) a_{ij}(x))] [\\partial_{x_i} f(x)] \\,dx\n$$\nNext, we integrate by parts with respect to $x_i$, moving the remaining derivative $\\partial_{x_i}$ from $f(x)$:\n$$\n- \\int_{\\mathbb{R}^{d}} [\\partial_{x_i} f(x)] [\\partial_{x_j}(p(x) a_{ij}(x))] \\,dx = \\int_{\\mathbb{R}^{d}} f(x) \\partial_{x_i}[\\partial_{x_j}(p(x) a_{ij}(x))] \\,dx = \\int_{\\mathbb{R}^{d}} f(x) \\partial_{x_i}\\partial_{x_j} [p(x) a_{ij}(x)] \\,dx\n$$\nSubstituting this back into the sum, the diffusion term becomes:\n$$\n\\int_{\\mathbb{R}^{d}} \\frac{1}{2}\\sum_{i,j=1}^{d} p(x) a_{ij}(x) \\partial_{x_i}\\partial_{x_j} f(x) \\,dx = \\int_{\\mathbb{R}^{d}} f(x) \\left( \\frac{1}{2}\\sum_{i,j=1}^{d} \\partial_{x_i}\\partial_{x_j}[p(x) a_{ij}(x)] \\right) dx\n$$\nCombining the processed drift and diffusion terms, we get:\n$$\n\\int_{\\mathbb{R}^{d}} p(x) Lf(x) \\,dx = \\int_{\\mathbb{R}^{d}} f(x) \\left( - \\sum_{i=1}^{d} \\partial_{x_i}[p(x) b_i(x)] + \\frac{1}{2}\\sum_{i,j=1}^{d} \\partial_{x_i}\\partial_{x_j}[p(x) a_{ij}(x)] \\right) dx\n$$\nBy comparing this result with the defining relation $\\int_{\\mathbb{R}^{d}} p(x) Lf(x) \\,dx = \\int_{\\mathbb{R}^{d}} f(x) L^{\\ast}p(x) \\,dx$, we can directly identify the expression for the action of $L^{\\ast}$ on $p(x)$:\n$$\nL^{\\ast}p(x) = - \\sum_{i=1}^{d} \\frac{\\partial}{\\partial x_i} [b_i(x)p(x)] + \\frac{1}{2} \\sum_{i,j=1}^{d} \\frac{\\partial^2}{\\partial x_i \\partial x_j} [a_{ij}(x)p(x)]\n$$\nThis expression is the operator for the Kolmogorov forward equation, also known as the Fokker-Planck operator. It describes the time evolution of the probability density function $p(x,t)$ of the stochastic process $X_t$ via the partial differential equation $\\partial_t p = L^{\\ast}p$.", "answer": "$$\\boxed{L^{\\ast}p(x) = - \\sum_{i=1}^{d} \\frac{\\partial}{\\partial x_i} [b_i(x)p(x)] + \\frac{1}{2} \\sum_{i,j=1}^{d} \\frac{\\partial^2}{\\partial x_i \\partial x_j} [a_{ij}(x)p(x)]}$$", "id": "3063166"}, {"introduction": "With the general form of the equation established, we now apply it to a cornerstone model in stochastic processes: the Ornstein-Uhlenbeck process [@problem_id:3063158]. This exercise demonstrates a powerful analytical technique, the Fourier transform, to solve the Fokker-Planck equation and find the exact time-dependent probability density. Completing this practice will provide you with a concrete understanding of how a system's drift and diffusion coefficients dictate its relaxation towards a steady state.", "problem": "Consider the Ornstein–Uhlenbeck (OU) process defined by the Itô stochastic differential equation $dX_{t} = -\\gamma X_{t}\\,dt + \\sqrt{2D}\\,dW_{t}$ with constants $\\gamma > 0$ and $D > 0$, where $W_{t}$ is a standard Wiener process and the initial condition is $X_{0} = x_{0}$. Let $p(x,t)$ denote the transition probability density of $X_{t}$, so that $p(x,t)\\,dx = \\mathbb{P}\\{X_{t} \\in dx\\}$, and define the characteristic function (equivalently, the spatial Fourier transform of $p$) by $\\hat{p}(k,t) = \\int_{-\\infty}^{\\infty} \\exp(i k x)\\,p(x,t)\\,dx$.\n\nStarting from the Itô stochastic differential equation and using the definition of the infinitesimal generator and conservation of probability, derive the Kolmogorov forward (Fokker–Planck) equation satisfied by $p(x,t)$. Then, apply the spatial Fourier transform to this partial differential equation to obtain an evolution equation for $\\hat{p}(k,t)$ and solve it using the method of characteristics under the initial condition $p(x,0) = \\delta(x - x_{0})$, where $\\delta$ is the Dirac delta distribution. Interpret how the drift and diffusion terms govern the evolution of the characteristic function in wave number space.\n\nYour final task is to provide a single, closed-form analytical expression for the characteristic function $\\hat{p}(k,t)$ at arbitrary $t \\geq 0$. No numerical approximation is required, and no units are involved in the final expression.", "solution": "The problem is assessed to be valid. It is scientifically grounded in the theory of stochastic differential equations, specifically concerning the Ornstein–Uhlenbeck process and its associated Kolmogorov forward (Fokker–Planck) equation. The problem is well-posed, with a clear objective and sufficient initial conditions to determine a unique solution. The terminology is precise and the requested steps form a standard, logical procedure in this field.\n\nThe problem asks for several steps: first, to derive the Fokker–Planck equation; second, to Fourier transform it; third, to solve the resulting equation for the characteristic function $\\hat{p}(k,t)$; and finally, to interpret the roles of the drift and diffusion terms.\n\n**1. Derivation of the Fokker–Planck Equation**\n\nThe Ornstein–Uhlenbeck process is described by the Itô stochastic differential equation (SDE):\n$$dX_{t} = -\\gamma X_{t}\\,dt + \\sqrt{2D}\\,dW_{t}$$\nThis SDE is of the general form $dX_{t} = a(X_{t},t)\\,dt + b(X_{t},t)\\,dW_{t}$, with a drift coefficient $a(x) = -\\gamma x$ and a diffusion coefficient $b(x) = \\sqrt{2D}$. The evolution of the probability density function $p(x,t)$ of the process $X_t$ is governed by the Kolmogorov forward equation, also known as the Fokker–Planck equation.\n\nA general derivation starts from the conservation of probability, expressed as a continuity equation:\n$$\\frac{\\partial p(x,t)}{\\partial t} + \\frac{\\partial J(x,t)}{\\partial x} = 0$$\nwhere $J(x,t)$ is the probability current. For a stochastic process described by the SDE above, the current is given by:\n$$J(x,t) = A_{1}(x) p(x,t) - \\frac{1}{2} \\frac{\\partial}{\\partial x} [A_{2}(x) p(x,t)]$$\nThe coefficients $A_{1}(x)$ and $A_{2}(x)$ are the first and second Kramers–Moyal coefficients, defined as the infinitesimal mean and variance of the process increments:\n$$A_{1}(x) = \\lim_{\\Delta t \\to 0} \\frac{1}{\\Delta t} \\mathbb{E}[\\Delta X_{t} | X_{t}=x]$$\n$$A_{2}(x) = \\lim_{\\Delta t \\to 0} \\frac{1}{\\Delta t} \\mathbb{E}[(\\Delta X_{t})^{2} | X_{t}=x]$$\nwhere $\\Delta X_{t} = X_{t+\\Delta t} - X_{t}$. From the SDE, for a small time step $\\Delta t$, the increment is $\\Delta X_t \\approx -\\gamma x \\Delta t + \\sqrt{2D} \\Delta W_t$, where $\\Delta W_t = W_{t+\\Delta t} - W_t$. The increments of the Wiener process have properties $\\mathbb{E}[\\Delta W_{t}] = 0$ and $\\mathbb{E}[(\\Delta W_{t})^{2}] = \\Delta t$.\n\nCalculating $A_{1}(x)$:\n$$A_{1}(x) = \\lim_{\\Delta t \\to 0} \\frac{1}{\\Delta t} \\mathbb{E}[-\\gamma x \\Delta t + \\sqrt{2D} \\Delta W_{t}] = \\lim_{\\Delta t \\to 0} \\frac{1}{\\Delta t} (-\\gamma x \\Delta t) = -\\gamma x$$\nCalculating $A_{2}(x)$:\n$$A_{2}(x) = \\lim_{\\Delta t \\to 0} \\frac{1}{\\Delta t} \\mathbb{E}[(-\\gamma x \\Delta t + \\sqrt{2D} \\Delta W_{t})^{2}]$$\n$$A_{2}(x) = \\lim_{\\Delta t \\to 0} \\frac{1}{\\Delta t} \\mathbb{E}[(\\gamma x)^{2}(\\Delta t)^{2} - 2\\gamma x \\sqrt{2D} \\Delta t \\Delta W_{t} + 2D (\\Delta W_{t})^{2}]$$\nUsing linearity of expectation and neglecting terms of order higher than $\\Delta t$:\n$$A_{2}(x) = \\lim_{\\Delta t \\to 0} \\frac{1}{\\Delta t} [(\\gamma x)^{2}(\\Delta t)^{2} - 0 + 2D \\Delta t] = \\lim_{\\Delta t \\to 0} [(\\gamma x)^{2}\\Delta t + 2D] = 2D$$\nSo, the drift coefficient is $a(x) = A_{1}(x) = -\\gamma x$ and the diffusion term is $b(x)^2 = A_2(x) = 2D$.\n\nSubstituting these coefficients back into the expression for the current $J(x,t)$:\n$$J(x,t) = (-\\gamma x) p(x,t) - \\frac{1}{2} \\frac{\\partial}{\\partial x} [2D p(x,t)] = -\\gamma x p(x,t) - D \\frac{\\partial p(x,t)}{\\partial x}$$\nThe Fokker–Planck equation is then $\\frac{\\partial p}{\\partial t} = -\\frac{\\partial J}{\\partial x}$:\n$$\\frac{\\partial p(x,t)}{\\partial t} = -\\frac{\\partial}{\\partial x} \\left(-\\gamma x p(x,t) - D \\frac{\\partial p(x,t)}{\\partial x}\\right)$$\n$$\\frac{\\partial p(x,t)}{\\partial t} = \\gamma \\frac{\\partial}{\\partial x}[x p(x,t)] + D \\frac{\\partial^{2}p(x,t)}{\\partial x^{2}}$$\nThis is the required Fokker–Planck equation for the Ornstein–Uhlenbeck process.\n\n**2. Fourier Transform of the Fokker–Planck Equation**\n\nThe characteristic function $\\hat{p}(k,t)$ is the spatial Fourier transform of $p(x,t)$, defined as:\n$$\\hat{p}(k,t) = \\mathcal{F}[p(x,t)] = \\int_{-\\infty}^{\\infty} \\exp(ikx) p(x,t) dx$$\nWe apply this transform to the Fokker–Planck equation. The necessary transform properties for the given definition are:\n$$\\mathcal{F}\\left[\\frac{\\partial^{n} f}{\\partial x^{n}}\\right] = (-ik)^{n} \\hat{f}(k)$$\n$$\\mathcal{F}[x f(x)] = i \\frac{d\\hat{f}(k)}{dk}$$\nUsing these, we can find the transform of the term $\\frac{\\partial}{\\partial x}[x p(x,t)]$:\n$$\\mathcal{F}\\left[\\frac{\\partial}{\\partial x}(x p)\\right] = (-ik)\\mathcal{F}[x p] = (-ik)\\left(i \\frac{\\partial \\hat{p}}{\\partial k}\\right) = k \\frac{\\partial \\hat{p}}{\\partial k}$$\nThere is a subtle point about the transform convention. The problem states $\\exp(ikx)$. Let's verify the rule for $\\mathcal{F}[xf(x)]$.\n$\\frac{d\\hat{p}}{dk} = \\frac{d}{dk}\\int \\exp(ikx)p(x,t)dx = \\int ix \\exp(ikx)p(x,t) dx = i\\mathcal{F}[xp]$. So $\\mathcal{F}[xp] = \\frac{1}{i}\\frac{d\\hat{p}}{dk} = -i\\frac{d\\hat{p}}{dk}$.\nThen, $\\mathcal{F}\\left[\\frac{\\partial}{\\partial x}(x p)\\right] = (-ik)\\mathcal{F}[x p] = (-ik)\\left(-i \\frac{\\partial \\hat{p}}{\\partial k}\\right) = -k \\frac{\\partial \\hat{p}}{\\partial k}$.\n\nTransforming the Fokker–Planck equation term by term:\n$$\\mathcal{F}\\left[\\frac{\\partial p}{\\partial t}\\right] = \\frac{\\partial \\hat{p}}{\\partial t}$$\n$$\\mathcal{F}\\left[\\gamma \\frac{\\partial}{\\partial x}(x p)\\right] = \\gamma \\left(-k \\frac{\\partial \\hat{p}}{\\partial k}\\right)$$\n$$\\mathcal{F}\\left[D \\frac{\\partial^{2}p}{\\partial x^{2}}\\right] = D(-ik)^{2}\\hat{p} = -Dk^{2}\\hat{p}$$\nCombining these results yields the evolution equation for the characteristic function:\n$$\\frac{\\partial \\hat{p}(k,t)}{\\partial t} = -\\gamma k \\frac{\\partial \\hat{p}(k,t)}{\\partial k} - Dk^{2}\\hat{p}(k,t)$$\n\n**3. Solution for the Characteristic Function**\n\nWe solve this first-order linear partial differential equation using the method of characteristics. The equation is:\n$$\\frac{\\partial \\hat{p}}{\\partial t} + \\gamma k \\frac{\\partial \\hat{p}}{\\partial k} = -Dk^{2}\\hat{p}$$\nThe characteristic equations are:\n$$\\frac{dt}{1} = \\frac{dk}{\\gamma k} = \\frac{d\\hat{p}}{-Dk^{2}\\hat{p}}$$\nFrom the first equality, $\\frac{dk}{dt} = \\gamma k$. Integrating gives the characteristic curves $k(t) = k_{0} \\exp(\\gamma t)$, where $k_{0}$ is the value of $k$ at $t=0$.\nAlong these curves, the evolution of $\\hat{p}$ is given by $\\frac{d\\hat{p}}{dt} = -Dk^{2}\\hat{p}$. Substituting $k(t)$:\n$$\\frac{d\\hat{p}}{dt} = -D(k_{0}\\exp(\\gamma t))^{2}\\hat{p} = -Dk_{0}^{2}\\exp(2\\gamma t)\\hat{p}$$\nThis is a separable ordinary differential equation for $\\hat{p}(t) = \\hat{p}(k(t),t)$:\n$$\\int_{\\hat{p}(k_0,0)}^{\\hat{p}(k(t),t)} \\frac{d\\hat{p}'}{\\hat{p}'} = \\int_{0}^{t} -Dk_{0}^{2}\\exp(2\\gamma \\tau) d\\tau$$\n$$\\ln\\left(\\frac{\\hat{p}(k(t),t)}{\\hat{p}(k_{0},0)}\\right) = -Dk_{0}^{2} \\left[\\frac{\\exp(2\\gamma \\tau)}{2\\gamma}\\right]_{0}^{t} = -\\frac{Dk_{0}^{2}}{2\\gamma}(\\exp(2\\gamma t)-1)$$\n$$\\hat{p}(k(t),t) = \\hat{p}(k_{0},0) \\exp\\left(-\\frac{Dk_{0}^{2}}{2\\gamma}(\\exp(2\\gamma t)-1)\\right)$$\nTo get the solution in terms of $(k,t)$, we express $k_0$ in terms of $k$ and $t$ using the characteristic curve equation: $k_{0} = k \\exp(-\\gamma t)$.\nSubstituting this into the solution gives:\n$$\\hat{p}(k,t) = \\hat{p}(k\\exp(-\\gamma t),0) \\exp\\left(-\\frac{D(k\\exp(-\\gamma t))^{2}}{2\\gamma}(\\exp(2\\gamma t)-1)\\right)$$\nSimplifying the argument of the exponential:\n$$-\\frac{Dk^{2}\\exp(-2\\gamma t)}{2\\gamma}(\\exp(2\\gamma t)-1) = -\\frac{Dk^{2}}{2\\gamma}(\\exp(0) - \\exp(-2\\gamma t)) = -\\frac{Dk^{2}}{2\\gamma}(1 - \\exp(-2\\gamma t))$$\nSo, the general solution is:\n$$\\hat{p}(k,t) = \\hat{p}(k\\exp(-\\gamma t), 0) \\exp\\left(-\\frac{Dk^{2}}{2\\gamma}(1 - \\exp(-2\\gamma t))\\right)$$\nThe initial condition is $p(x,0) = \\delta(x - x_{0})$. Its Fourier transform is:\n$$\\hat{p}(k,0) = \\int_{-\\infty}^{\\infty} \\exp(ikx) \\delta(x - x_{0}) dx = \\exp(ikx_{0})$$\nWe need $\\hat{p}(k',0)$ where $k' = k\\exp(-\\gamma t)$:\n$$\\hat{p}(k\\exp(-\\gamma t), 0) = \\exp(i(k\\exp(-\\gamma t))x_{0}) = \\exp(ikx_{0}\\exp(-\\gamma t))$$\nSubstituting this into the general solution gives the final expression for the characteristic function:\n$$\\hat{p}(k,t) = \\exp(ikx_{0}\\exp(-\\gamma t)) \\exp\\left(-\\frac{Dk^{2}}{2\\gamma}(1 - \\exp(-2\\gamma t))\\right)$$\nThis can be written as a single exponential:\n$$\\hat{p}(k,t) = \\exp\\left(ikx_{0}\\exp(-\\gamma t) - \\frac{Dk^{2}}{2\\gamma}(1 - \\exp(-2\\gamma t))\\right)$$\n\n**4. Interpretation**\n\nThe characteristic function of a Gaussian distribution with mean $\\mu$ and variance $\\sigma^{2}$ is $\\exp(ik\\mu - \\frac{1}{2}k^{2}\\sigma^{2})$. By comparing our result for $\\hat{p}(k,t)$ with this canonical form, we can identify the time-dependent mean and variance of the Ornstein-Uhlenbeck process:\n$$\\mu(t) = x_{0}\\exp(-\\gamma t)$$\n$$\\sigma^{2}(t) = \\frac{D}{\\gamma}(1 - \\exp(-2\\gamma t))$$\nThe evolution equation $\\frac{\\partial \\hat{p}}{\\partial t} = -\\gamma k \\frac{\\partial \\hat{p}}{\\partial k} - Dk^{2}\\hat{p}$ reveals the roles of drift and diffusion in Fourier (wave number) space.\n- The **drift term** in the SDE, $-\\gamma X_t dt$, gives rise to the term $-\\gamma k \\frac{\\partial \\hat{p}}{\\partial k}$ in the evolution equation. This is an advection term in $k$-space, causing a \"flow\" of wave numbers. It primarily affects the phase of $\\hat{p}(k,t)$, which corresponds to the mean of $p(x,t)$. The solution shows the mean $\\mu(t)$ decays exponentially to $0$ with a rate $\\gamma$, representing the particle being pulled towards the origin.\n- The **diffusion term** in the SDE, $\\sqrt{2D} dW_t$, gives rise to the term $-Dk^{2}\\hat{p}$. This is a damping term in $k$-space that is stronger for larger $|k|$ (higher frequencies). This damping corresponds to the smoothing of the probability distribution $p(x,t)$ in real space, i.e., its diffusive spreading. This term governs the magnitude $|\\hat{p}(k,t)|$, which is determined by the variance $\\sigma^2(t)$. The variance grows from $0$ and asymptotically approaches the steady-state value $D/\\gamma$, representing a balance between diffusive spreading and the confining drift.", "answer": "$$\\boxed{\\exp\\left(ikx_{0}\\exp(-\\gamma t) - \\frac{Dk^{2}}{2\\gamma}\\left(1 - \\exp(-2\\gamma t)\\right)\\right)}$$", "id": "3063158"}, {"introduction": "Many real-world systems do not settle into a simple, static equilibrium but instead reach a dynamic non-equilibrium steady state [@problem_id:3063143]. This exercise explores such a scenario by adding a rotational component to the drift, which breaks the condition of detailed balance. By calculating the stationary probability density and the resulting non-zero probability current, you will gain insight into the nature of systems that exhibit persistent flows and cycles, a fundamental concept in modern statistical physics.", "problem": "Consider the two-dimensional stochastic differential equation (SDE)\n$$\nd\\mathbf{X}_t=\\left(-k\\,\\mathbf{X}_t+\\Omega\\,R\\,\\mathbf{X}_t\\right)dt+\\sqrt{2D}\\,d\\mathbf{W}_t,\n$$\nwhere $\\mathbf{X}_t\\in\\mathbb{R}^2$, $k>0$ and $D>0$ are constants, $\\Omega\\in\\mathbb{R}$, $\\mathbf{W}_t$ is a standard two-dimensional Wiener process, and $R$ is the constant antisymmetric matrix\n$$\nR=\\begin{pmatrix}\n0 & -1\\\\\n1 & \\phantom{-}0\n\\end{pmatrix}.\n$$\nThe drift field is $\\mathbf{a}(\\mathbf{x})=-k\\,\\mathbf{x}+\\Omega\\,R\\,\\mathbf{x}$ and the diffusion is isotropic with coefficient $D$.\n\nStarting from the Kolmogorov forward equation (also known as the Fokker–Planck equation) for the probability density $p(\\mathbf{x},t)$ associated with the SDE above, do the following:\n\n1. Derive the stationary (time-independent) density $p_{\\infty}(\\mathbf{x})$ and determine its covariance matrix. You may assume the stationary density, if it exists, is centered at the origin and is normalizable.\n\n2. State the condition for detailed balance in terms of the stationary probability current $\\mathbf{J}_{\\infty}(\\mathbf{x})$ and explain, based on the form of $\\mathbf{a}(\\mathbf{x})$, why detailed balance holds when $\\Omega=0$ and is violated when $\\Omega\\neq 0$.\n\n3. Compute the stationary probability current $\\mathbf{J}_{\\infty}(\\mathbf{x})$ and show that its streamlines are circles centered at the origin when $\\Omega\\neq 0$.\n\n4. Define the scalar measure of circulating probability current\n$$\nJ_{\\infty}:=\\int_{\\mathbb{R}^2}\\left(x_1\\,J_{\\infty,y}(\\mathbf{x})-x_2\\,J_{\\infty,x}(\\mathbf{x})\\right)\\,d^2\\mathbf{x},\n$$\nwhere $J_{\\infty,x}$ and $J_{\\infty,y}$ are the Cartesian components of $\\mathbf{J}_{\\infty}(\\mathbf{x})$ and $d^2\\mathbf{x}$ denotes the Lebesgue measure on $\\mathbb{R}^2$. Compute $J_{\\infty}$ in closed form as a function of $k$, $\\Omega$, and $D$.\n\nExpress your final answer as a single analytic expression. No rounding is required.", "solution": "The user wants me to analyze a two-dimensional stochastic differential equation (SDE), derive properties of its stationary state from the corresponding Kolmogorov forward (Fokker-Planck) equation, and compute a measure of the stationary probability current.\n\nThe SDE is given by:\n$$\nd\\mathbf{X}_t=\\left(-k\\,\\mathbf{X}_t+\\Omega\\,R\\,\\mathbf{X}_t\\right)dt+\\sqrt{2D}\\,d\\mathbf{W}_t\n$$\nThis is a linear SDE of the form $d\\mathbf{X}_t = A\\mathbf{X}_t dt + B d\\mathbf{W}_t$, where the state is $\\mathbf{X}_t = (x_1, x_2)^T \\in \\mathbb{R}^2$, the drift matrix is $A = -kI + \\Omega R$, and the diffusion matrix is specified by $B = \\sqrt{2D}I$. The matrix $R = \\begin{pmatrix} 0 & -1 \\\\ 1 & 0 \\end{pmatrix}$ effects a counter-clockwise rotation by $\\pi/2$. Explicitly, the drift matrix is:\n$$\nA = \\begin{pmatrix} -k & -\\Omega \\\\ \\Omega & -k \\end{pmatrix}\n$$\nThe diffusion tensor for the Fokker-Planck equation is given by $D_{ij} = \\frac{1}{2}(BB^T)_{ij}$, which in this case is $D \\delta_{ij}$. The diffusion is isotropic with coefficient $D$.\n\nThe Kolmogorov forward equation (Fokker-Planck equation) for the probability density $p(\\mathbf{x}, t)$ is:\n$$\n\\frac{\\partial p(\\mathbf{x}, t)}{\\partial t} = -\\nabla \\cdot \\mathbf{J}(\\mathbf{x}, t)\n$$\nwhere $\\mathbf{J}(\\mathbf{x}, t)$ is the probability current, defined as:\n$$\n\\mathbf{J}(\\mathbf{x}, t) = \\mathbf{a}(\\mathbf{x})p(\\mathbf{x}, t) - D\\nabla p(\\mathbf{x}, t)\n$$\nand $\\mathbf{a}(\\mathbf{x}) = A\\mathbf{x}$ is the drift field.\n\n**1. Stationary Density and Covariance Matrix**\n\nThe stationary density $p_{\\infty}(\\mathbf{x})$ is the time-independent solution to the Fokker-Planck equation, which satisfies $\\frac{\\partial p}{\\partial t} = 0$. This implies that the stationary probability current $\\mathbf{J}_{\\infty}(\\mathbf{x})$ must have zero divergence:\n$$\n\\nabla \\cdot \\mathbf{J}_{\\infty}(\\mathbf{x}) = \\nabla \\cdot (\\mathbf{a}(\\mathbf{x}) p_{\\infty}(\\mathbf{x}) - D \\nabla p_{\\infty}(\\mathbf{x})) = 0\n$$\nFor a linear SDE with constant diffusion, the stationary distribution (if it exists) is a multivariate Gaussian. The problem statement assumes it is centered at the origin, which is consistent with the drift being zero only at $\\mathbf{x}=\\mathbf{0}$. We can find its covariance matrix $C = \\langle \\mathbf{X}_t \\mathbf{X}_t^T \\rangle_{\\infty}$ by solving the continuous-time Lyapunov equation:\n$$\nAC + CA^T + 2D I = 0\n$$\nHere, $A = \\begin{pmatrix} -k & -\\Omega \\\\ \\Omega & -k \\end{pmatrix}$, $A^T = \\begin{pmatrix} -k & \\Omega \\\\ -\\Omega & -k \\end{pmatrix}$, and $I$ is the $2 \\times 2$ identity matrix. Let $C = \\begin{pmatrix} c_{11} & c_{12} \\\\ c_{21} & c_{22} \\end{pmatrix}$ be the symmetric covariance matrix ($c_{12}=c_{21}$).\n\nThe Lyapunov equation expands to:\n$$\n\\begin{pmatrix} -k & -\\Omega \\\\ \\Omega & -k \\end{pmatrix}\\begin{pmatrix} c_{11} & c_{12} \\\\ c_{12} & c_{22} \\end{pmatrix} + \\begin{pmatrix} c_{11} & c_{12} \\\\ c_{12} & c_{22} \\end{pmatrix}\\begin{pmatrix} -k & \\Omega \\\\ -\\Omega & -k \\end{pmatrix} + \\begin{pmatrix} 2D & 0 \\\\ 0 & 2D \\end{pmatrix} = \\begin{pmatrix} 0 & 0 \\\\ 0 & 0 \\end{pmatrix}\n$$\nPerforming the matrix multiplications yields a system of linear equations for the components of $C$:\n$$\n\\begin{pmatrix} -2kc_{11}-2\\Omega c_{12} & -kc_{12}-\\Omega c_{22} -kc_{12}+\\Omega c_{11} \\\\ \\Omega c_{11}-k c_{12} -kc_{12}-\\Omega c_{22} & 2\\Omega c_{12}-2k c_{22} \\end{pmatrix} + \\begin{pmatrix} 2D & 0 \\\\ 0 & 2D \\end{pmatrix} = \\begin{pmatrix} 0 & 0 \\\\ 0 & 0 \\end{pmatrix}\n$$\nThis gives the equations:\n1.  $-2kc_{11} - 2\\Omega c_{12} + 2D = 0 \\implies -kc_{11} - \\Omega c_{12} + D = 0$\n2.  $-2kc_{22} + 2\\Omega c_{12} + 2D = 0 \\implies -kc_{22} + \\Omega c_{12} + D = 0$\n3.  $\\Omega(c_{11}-c_{22}) - 2k c_{12} = 0$\n\nFrom (1) and (2), we express $c_{11}$ and $c_{22}$:\n$c_{11} = \\frac{D-\\Omega c_{12}}{k}$ and $c_{22} = \\frac{D+\\Omega c_{12}}{k}$.\nSubstituting these into (3):\n$$\n\\Omega\\left(\\frac{D-\\Omega c_{12}}{k} - \\frac{D+\\Omega c_{12}}{k}\\right) - 2k c_{12} = 0\n$$\n$$\n\\Omega\\left(-\\frac{2\\Omega c_{12}}{k}\\right) - 2k c_{12} = 0\n$$\n$$\n-2\\left(\\frac{\\Omega^2}{k} + k\\right)c_{12} = -2\\left(\\frac{\\Omega^2+k^2}{k}\\right)c_{12} = 0\n$$\nSince $k>0$, the term $\\frac{\\Omega^2+k^2}{k}$ is strictly positive. Therefore, we must have $c_{12} = 0$.\nWith $c_{12}=0$, we find $c_{11}=D/k$ and $c_{22}=D/k$.\nThe covariance matrix is diagonal and isotropic:\n$$\nC = \\begin{pmatrix} D/k & 0 \\\\ 0 & D/k \\end{pmatrix} = \\frac{D}{k}I\n$$\nThe stationary probability density $p_{\\infty}(\\mathbf{x})$ is a zero-mean Gaussian with this covariance. The inverse covariance is $C^{-1} = \\frac{k}{D}I$.\n$$\np_{\\infty}(\\mathbf{x}) = \\frac{1}{\\sqrt{(2\\pi)^2 \\det(C)}} \\exp\\left(-\\frac{1}{2}\\mathbf{x}^T C^{-1} \\mathbf{x}\\right) = \\frac{1}{2\\pi (D/k)} \\exp\\left(-\\frac{k}{2D}\\mathbf{x}^T\\mathbf{x}\\right)\n$$\n$$\np_{\\infty}(\\mathbf{x}) = \\frac{k}{2\\pi D} \\exp\\left(-\\frac{k(x_1^2+x_2^2)}{2D}\\right)\n$$\n\n**2. Detailed Balance**\n\nDetailed balance is a condition on a stationary system where, for every pair of states, the rate of transitioning from state A to B is equal to the rate of transitioning from B to A. In the context of continuous stochastic processes described by a Fokker-Planck equation, detailed balance holds if the stationary probability current $\\mathbf{J}_{\\infty}(\\mathbf{x})$ is identically zero for all $\\mathbf{x}$.\n$$\n\\mathbf{J}_{\\infty}(\\mathbf{x}) = \\mathbf{0}\n$$\nLet us compute $\\mathbf{J}_{\\infty}(\\mathbf{x})$. First, we compute the gradient of $p_{\\infty}(\\mathbf{x})$:\n$$\n\\nabla p_{\\infty}(\\mathbf{x}) = \\nabla \\left( \\frac{k}{2\\pi D} \\exp\\left(-\\frac{k|\\mathbf{x}|^2}{2D}\\right) \\right) = p_{\\infty}(\\mathbf{x}) \\left(-\\frac{k}{2D} \\nabla(|\\mathbf{x}|^2)\\right) = p_{\\infty}(\\mathbf{x}) \\left(-\\frac{k}{D} \\mathbf{x}\\right)\n$$\nThe stationary current is:\n$$\n\\mathbf{J}_{\\infty}(\\mathbf{x}) = \\mathbf{a}(\\mathbf{x})p_{\\infty}(\\mathbf{x}) - D\\nabla p_{\\infty}(\\mathbf{x}) = \\mathbf{a}(\\mathbf{x})p_{\\infty}(\\mathbf{x}) - D\\left(-\\frac{k}{D}\\mathbf{x}\\, p_{\\infty}(\\mathbf{x})\\right)\n$$\n$$\n\\mathbf{J}_{\\infty}(\\mathbf{x}) = (\\mathbf{a}(\\mathbf{x}) + k\\mathbf{x}) p_{\\infty}(\\mathbf{x})\n$$\nSubstituting $\\mathbf{a}(\\mathbf{x}) = -k\\mathbf{x} + \\Omega R \\mathbf{x}$:\n$$\n\\mathbf{J}_{\\infty}(\\mathbf{x}) = (-k\\mathbf{x} + \\Omega R \\mathbf{x} + k\\mathbf{x}) p_{\\infty}(\\mathbf{x}) = \\Omega R \\mathbf{x}\\,p_{\\infty}(\\mathbf{x})\n$$\n-   When $\\Omega=0$, $\\mathbf{J}_{\\infty}(\\mathbf{x}) = 0$ for all $\\mathbf{x}$. Thus, the system satisfies detailed balance. This is because the drift field $\\mathbf{a}(\\mathbf{x})=-k\\mathbf{x}$ is a gradient field, $\\mathbf{a}(\\mathbf{x}) = -\\nabla U(\\mathbf{x})$ with potential $U(\\mathbf{x})=\\frac{1}{2}k|\\mathbf{x}|^2$. Systems with gradient drift and constant isotropic diffusion satisfy detailed balance.\n-   When $\\Omega \\neq 0$, $\\mathbf{J}_{\\infty}(\\mathbf{x}) = \\Omega R \\mathbf{x}\\,p_{\\infty}(\\mathbf{x})$. Since $R\\mathbf{x} = (-x_2, x_1)^T \\neq \\mathbf{0}$ for $\\mathbf{x}\\neq\\mathbf{0}$ and $p_{\\infty}(\\mathbf{x})>0$ everywhere, the current $\\mathbf{J}_{\\infty}(\\mathbf{x})$ is non-zero (except at the origin). Thus, detailed balance is violated. The part of the drift $\\Omega R \\mathbf{x}$ is non-conservative (has non-zero curl), which drives persistent probability currents in the stationary state.\n\n**3. Stationary Current Streamlines**\n\nThe stationary probability current for $\\Omega \\neq 0$ is:\n$$\n\\mathbf{J}_{\\infty}(\\mathbf{x}) = \\Omega R \\mathbf{x}\\,p_{\\infty}(\\mathbf{x}) = \\Omega \\begin{pmatrix} -x_2 \\\\ x_1 \\end{pmatrix} \\frac{k}{2\\pi D} \\exp\\left(-\\frac{k(x_1^2+x_2^2)}{2D}\\right)\n$$\nA streamline is a curve $\\mathbf{r}(s)=(x_1(s), x_2(s))^T$ that is everywhere tangent to the vector field $\\mathbf{J}_{\\infty}(\\mathbf{x})$. The direction of the current at $\\mathbf{x}$ is given by the vector $R\\mathbf{x} = (-x_2, x_1)^T$. Let's examine the relationship between the position vector $\\mathbf{x}=(x_1, x_2)^T$ and the current direction. Their dot product is:\n$$\n\\mathbf{x} \\cdot (R\\mathbf{x}) = (x_1, x_2) \\cdot (-x_2, x_1) = -x_1 x_2 + x_2 x_1 = 0\n$$\nSince the current vector is always orthogonal to the position vector, the streamlines must be curves along which the distance from the origin is constant. These are circles centered at the origin.\nMore formally, a streamline $\\mathbf{r}(s)$ satisfies $\\frac{d\\mathbf{r}}{ds} \\propto \\mathbf{J}_\\infty(\\mathbf{r}(s))$, which means $\\frac{d\\mathbf{r}}{ds}$ is parallel to $R\\mathbf{r}(s)$.\nConsider the squared radius $|\\mathbf{r}(s)|^2 = x_1^2(s)+x_2^2(s)$:\n$$\n\\frac{d}{ds}|\\mathbf{r}(s)|^2 = 2\\mathbf{r}(s) \\cdot \\frac{d\\mathbf{r}}{ds}\n$$\nSince $\\frac{d\\mathbf{r}}{ds}$ is parallel to $R\\mathbf{r}(s)$, and we showed $\\mathbf{r}(s) \\cdot (R\\mathbf{r}(s)) = 0$, it follows that $\\frac{d}{ds}|\\mathbf{r}(s)|^2 = 0$. This implies $|\\mathbf{r}(s)|^2$ is constant along any streamline. The streamlines are therefore circles $x_1^2+x_2^2=\\text{constant}$ centered at the origin.\n\n**4. Computation of the Scalar Current Measure $J_{\\infty}$**\n\nThe scalar measure is defined as:\n$$\nJ_{\\infty} := \\int_{\\mathbb{R}^2}\\left(x_1\\,J_{\\infty,y}(\\mathbf{x})-x_2\\,J_{\\infty,x}(\\mathbf{x})\\right)\\,d^2\\mathbf{x}\n$$\nThe components of the current are $J_{\\infty,x}(\\mathbf{x}) = -\\Omega x_2 p_{\\infty}(\\mathbf{x})$ and $J_{\\infty,y}(\\mathbf{x}) = \\Omega x_1 p_{\\infty}(\\mathbf{x})$. Substituting these into the integrand:\n$$\nx_1(\\Omega x_1 p_{\\infty}(\\mathbf{x})) - x_2(-\\Omega x_2 p_{\\infty}(\\mathbf{x})) = \\Omega x_1^2 p_{\\infty}(\\mathbf{x}) + \\Omega x_2^2 p_{\\infty}(\\mathbf{x}) = \\Omega(x_1^2+x_2^2)p_{\\infty}(\\mathbf{x})\n$$\nSo the integral becomes:\n$$\nJ_{\\infty} = \\int_{\\mathbb{R}^2} \\Omega(x_1^2+x_2^2) p_{\\infty}(\\mathbf{x})\\, d^2\\mathbf{x} = \\Omega \\int_{\\mathbb{R}^2} |\\mathbf{x}|^2 p_{\\infty}(\\mathbf{x})\\, d^2\\mathbf{x}\n$$\nThe integral $\\int_{\\mathbb{R}^2} |\\mathbf{x}|^2 p_{\\infty}(\\mathbf{x})\\, d^2\\mathbf{x}$ is the expectation of the squared norm $|\\mathbf{X}|^2$ in the stationary state, $\\mathbb{E}[|\\mathbf{X}|^2]$. This is equal to the trace of the covariance matrix $C$.\n$$\n\\mathbb{E}[|\\mathbf{X}|^2] = \\mathbb{E}[X_1^2 + X_2^2] = \\mathbb{E}[X_1^2] + \\mathbb{E}[X_2^2] = c_{11} + c_{22} = \\mathrm{Tr}(C)\n$$\nFrom Part 1, we found $C = \\frac{D}{k}I$, so $\\mathrm{Tr}(C) = \\frac{D}{k} + \\frac{D}{k} = \\frac{2D}{k}$.\nTherefore, the scalar measure of the current is:\n$$\nJ_{\\infty} = \\Omega \\cdot \\mathrm{Tr}(C) = \\Omega \\left(\\frac{2D}{k}\\right) = \\frac{2\\Omega D}{k}\n$$\nThis expression provides the final answer.", "answer": "$$\\boxed{\\frac{2\\Omega D}{k}}$$", "id": "3063143"}]}