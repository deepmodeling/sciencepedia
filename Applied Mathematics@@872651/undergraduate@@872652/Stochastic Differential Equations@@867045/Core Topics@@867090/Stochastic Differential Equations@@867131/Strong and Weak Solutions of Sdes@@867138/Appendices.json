{"hands_on_practices": [{"introduction": "A powerful technique in the study of stochastic differential equations is to transform questions about the path of a process into questions about martingales. This exercise demonstrates how to compute the probability that a diffusion process hits one boundary of an interval before another by finding a special function, the scale function, which turns the process into a martingale [@problem_id:3078967]. This practice provides a direct link between the analytical properties of the SDE's generator and the probabilistic behavior of its solution, making it a cornerstone for solving exit-time problems.", "problem": "Consider the one-dimensional stochastic differential equation (SDE) $\\,\\mathrm{d}X_{t} = b(X_{t})\\,\\mathrm{d}t + \\sigma(X_{t})\\,\\mathrm{d}W_{t}\\,$ on an open interval $\\,I = (l,r)\\,$, where $\\,W\\,$ is a standard Brownian motion (also known as a Wiener process), $\\,b:I\\to\\mathbb{R}\\,$ and $\\,\\sigma:I\\to(0,\\infty)\\,$ are continuous with $\\,\\sigma\\,$ locally Lipschitz and strictly positive. Assume there exists a weak solution that is unique in law, so that $\\,X\\,$ is a regular diffusion on $\\,I\\,$ with infinitesimal generator $\\,\\mathcal{L}f(x) = b(x) f'(x) + \\frac{1}{2}\\sigma^{2}(x) f''(x)\\,$ on $\\,C^{2}$ test functions.\n\nFix $\\,a,b\\in I\\,$ with $\\,ab\\,$ and an initial point $\\,x\\in(a,b)\\,$. Define the hitting times $\\,\\tau_{a} := \\inf\\{t\\geq 0 : X_{t} = a\\}\\,$ and $\\,\\tau_{b} := \\inf\\{t\\geq 0 : X_{t} = b\\}\\,$, and set $\\,\\tau_{a,b} := \\tau_{a}\\wedge \\tau_{b}\\,$.\n\n1) Starting from Itô’s formula and the martingale characterization of harmonic functions for $\\,\\mathcal{L}\\,$, let $\\,s\\,$ be any strictly increasing $\\,C^{2}\\,$ solution of $\\,\\mathcal{L}s=0\\,$ on $\\, (a,b)\\,$ (a scale function, unique up to an affine change). Show that $\\,s(X_{t\\wedge \\tau_{a,b}})\\,$ is a martingale and use bounded optional stopping to express $\\,\\mathbb{P}_{x}(\\tau_{b}\\tau_{a})\\,$ in terms of $\\,s(a), s(x), s(b)\\,$. Write this hitting probability as a closed-form expression in terms of $\\,s\\,$ only.\n\n2) Specialize to the constant-coefficient case $\\,\\mathrm{d}X_{t} = \\mu\\,\\mathrm{d}t + \\sigma\\,\\mathrm{d}W_{t}\\,$ on $\\,I=\\mathbb{R}\\,$ with $\\,\\mu\\in\\mathbb{R}\\,$ and $\\,\\sigma0\\,$. Compute an explicit strictly increasing scale function $\\,s\\,$ and then the corresponding closed-form expression for $\\,\\mathbb{P}_{x}(\\tau_{b}\\tau_{a})\\,$ when $\\,axb\\,$. Verify your formula by solving the boundary value problem $\\,\\mathcal{L}u=0\\,$ on $\\, (a,b)\\,$ with boundary conditions $\\,u(a)=0\\,$ and $\\,u(b)=1\\,$, and by checking the zero-drift limit $\\,\\mu\\to 0\\,$.\n\n3) State the final closed-form expression for $\\,\\mathbb{P}_{x}(\\tau_{b}\\tau_{a})\\,$ in the constant-coefficient case with $\\,\\mu\\neq 0\\,$, $\\,\\sigma0\\,$, and $\\,axb\\,$, as a single analytic expression involving $\\,\\mu\\,$, $\\,\\sigma\\,$, $\\,a\\,$, $\\,b\\,$, and $\\,x\\,$. Your final answer must be a single symbolic expression. Do not round. Do not include units.", "solution": "The user wants me to solve a multi-part problem on stochastic differential equations.\n\n### Problem Validation\n\nFirst, I must validate the problem statement.\n\n**Step 1: Extract Givens**\n\n-   **SDE**: $\\mathrm{d}X_{t} = b(X_{t})\\,\\mathrm{d}t + \\sigma(X_{t})\\,\\mathrm{d}W_{t}$ on an open interval $I = (l,r)$.\n-   **Wiener Process**: $W$ is a standard Brownian motion.\n-   **Coefficients**: $b:I\\to\\mathbb{R}$ is continuous, $\\sigma:I\\to(0,\\infty)$ is continuous, locally Lipschitz, and strictly positive.\n-   **Solution Property**: A weak solution exists and is unique in law, making $X$ a regular diffusion on $I$.\n-   **Infinitesimal Generator**: $\\mathcal{L}f(x) = b(x) f'(x) + \\frac{1}{2}\\sigma^{2}(x) f''(x)$ for $f \\in C^{2}$.\n-   **Interval and Initial Point**: $a,b\\in I$ with $ab$, and initial point $x\\in(a,b)$.\n-   **Hitting Times**: $\\tau_{a} := \\inf\\{t\\geq 0 : X_{t} = a\\}$, $\\tau_{b} := \\inf\\{t\\geq 0 : X_{t} = b\\}$, and $\\tau_{a,b} := \\tau_{a}\\wedge \\tau_{b}$.\n-   **Part 1 Definitions**: $s$ is a strictly increasing $C^{2}$ solution to $\\mathcal{L}s=0$ on $(a,b)$.\n-   **Part 1 Task**: Show $s(X_{t\\wedge \\tau_{a,b}})$ is a martingale and use bounded optional stopping to find $\\mathbb{P}_{x}(\\tau_{b}\\tau_{a})$ in terms of $s(a), s(x), s(b)$.\n-   **Part 2 Definitions**: Specialization to constant coefficients: $\\mathrm{d}X_{t} = \\mu\\,\\mathrm{d}t + \\sigma\\,\\mathrm{d}W_{t}$ on $I=\\mathbb{R}$, with $\\mu\\in\\mathbb{R}$ and $\\sigma0$.\n-   **Part 2 Task**: Compute an explicit strictly increasing scale function $s$, find the corresponding $\\mathbb{P}_{x}(\\tau_{b}\\tau_{a})$, and verify the formula by solving the BVP $\\mathcal{L}u=0$ with $u(a)=0, u(b)=1$ and by checking the limit $\\mu\\to 0$.\n-   **Part 3 Task**: State the final closed-form expression for $\\mathbb{P}_{x}(\\tau_{b}\\tau_{a})$ in the constant-coefficient case with $\\mu\\neq 0$, $\\sigma0$, and $axb$.\n\n**Step 2: Validate Using Extracted Givens**\n\n-   **Scientific Groundedness**: The problem is a standard exercise in the theory of diffusion processes and stochastic calculus. All definitions and concepts (SDE, Itô's formula, generator, hitting times, scale function, martingale property) are fundamental to this field. The setup is mathematically rigorous and factually sound.\n-   **Well-Posedness**: The problem is well-posed. The assumptions on the coefficients $b$ and $\\sigma$ are standard for ensuring the existence and uniqueness of solutions to the SDE. The questions are precise and lead to a unique, meaningful solution through a series of logical steps.\n-   **Objectivity**: The problem is stated in precise, objective mathematical language, free from any subjectivity or ambiguity.\n-   **Conclusion**: There are no apparent flaws like scientific unsoundness, incompleteness, contradiction, or ambiguity. The problem is a valid, well-structured question in mathematical finance and stochastic processes.\n\n**Step 3: Verdict and Action**\n\nThe problem is **valid**. I will proceed with a full solution.\n\n### Solution\n\n**Part 1: General Hitting Probability**\n\nWe are given a strictly increasing $C^{2}$ function $s$ on $(a,b)$ such that $\\mathcal{L}s(y) = 0$ for all $y \\in (a,b)$. Let $X_t$ be the solution to the SDE starting from $X_0=x$. Let $T = \\tau_{a,b}$. We consider the process $Y_t = s(X_{t \\wedge T})$.\nBy Itô’s formula, for any $t \\geq 0$:\n$$ \\mathrm{d}s(X_t) = s'(X_t) \\mathrm{d}X_t + \\frac{1}{2} s''(X_t) \\mathrm{d}\\langle X \\rangle_t $$\nSubstituting $\\mathrm{d}X_t = b(X_t)\\,\\mathrm{d}t + \\sigma(X_t)\\,\\mathrm{d}W_t$ and the quadratic variation $\\mathrm{d}\\langle X \\rangle_t = \\sigma^2(X_t)\\,\\mathrm{d}t$, we get:\n$$ \\mathrm{d}s(X_t) = s'(X_t) (b(X_t)\\,\\mathrm{d}t + \\sigma(X_t)\\,\\mathrm{d}W_t) + \\frac{1}{2} s''(X_t) \\sigma^2(X_t)\\,\\mathrm{d}t $$\nGrouping the $\\mathrm{d}t$ and $\\mathrm{d}W_t$ terms:\n$$ \\mathrm{d}s(X_t) = \\left( b(X_t)s'(X_t) + \\frac{1}{2}\\sigma^2(X_t)s''(X_t) \\right) \\,\\mathrm{d}t + s'(X_t)\\sigma(X_t)\\,\\mathrm{d}W_t $$\nThe term in the parenthesis is the generator $\\mathcal{L}s(X_t)$. By assumption, $\\mathcal{L}s(y) = 0$ for $y \\in (a,b)$.\nFor the stopped process $X_{t \\wedge T}$, the state $X_u$ remains in the interval $(a,b)$ for all $u  T$. Thus, the drift term of $s(X_{t \\wedge T})$ is zero. The process $M_t := s(X_{t \\wedge T})$ satisfies:\n$$ \\mathrm{d}M_t = \\mathbf{1}_{\\{t \\le T\\}} s'(X_t)\\sigma(X_t)\\,\\mathrm{d}W_t $$\nThis shows that $M_t$ is a local martingale. Since $s$ is $C^2$ on $(a,b)$ and continuous on $[a,b]$, and $X_{t \\wedge T}$ is confined to the compact interval $[a,b]$, the integrand $s'(X_{t \\wedge T})\\sigma(X_{t \\wedge T})$ is bounded. A bounded stochastic integral is a true martingale. Thus, $M_t = s(X_{t\\wedge \\tau_{a,b}})$ is a martingale.\n\nThe stopping time $T = \\tau_{a,b}$ is almost surely finite. The process $M_t = s(X_{t \\wedge T})$ is bounded because $X_{t \\wedge T} \\in [a,b]$ and $s$ is continuous on $[a,b]$. We can apply the Optional Stopping Theorem to the bounded martingale $M_t$ and the stopping time $T$. This gives:\n$$ \\mathbb{E}_{x}[M_T] = M_0 $$\nHere, $M_0 = s(X_0) = s(x)$ and $M_T = s(X_T) = s(X_{\\tau_{a,b}})$. So, we have the equality:\n$$ \\mathbb{E}_{x}[s(X_{\\tau_{a,b}})] = s(x) $$\nThe process $X$ stops at time $\\tau_{a,b}$ at either $a$ or $b$. Let $p_x = \\mathbb{P}_{x}(\\tau_{b}\\tau_{a})$. Then $\\mathbb{P}_{x}(\\tau_{a} \\le \\tau_{b}) = 1-p_x$. The random variable $X_{\\tau_{a,b}}$ takes value $b$ with probability $p_x$ and value $a$ with probability $1-p_x$. The expectation can be written as:\n$$ \\mathbb{E}_{x}[s(X_{\\tau_{a,b}})] = s(b) \\cdot \\mathbb{P}_{x}(\\tau_{b}\\tau_{a}) + s(a) \\cdot \\mathbb{P}_{x}(\\tau_{a} \\le \\tau_{b}) = s(b) p_x + s(a)(1-p_x) $$\nEquating this with $s(x)$:\n$$ s(x) = s(b) p_x + s(a) - s(a) p_x $$\n$$ s(x) - s(a) = p_x (s(b) - s(a)) $$\nSince $s$ is strictly increasing and $ab$, $s(b)-s(a) \\neq 0$. We can solve for $p_x$:\n$$ p_x = \\mathbb{P}_{x}(\\tau_{b}\\tau_{a}) = \\frac{s(x) - s(a)}{s(b) - s(a)} $$\n\n**Part 2: Constant-Coefficient Case**\n\nWe now specialize to the SDE $\\mathrm{d}X_{t} = \\mu\\,\\mathrm{d}t + \\sigma\\,\\mathrm{d}W_{t}$ with $\\mu \\in \\mathbb{R}$ and $\\sigma0$. The generator is $\\mathcal{L}f(x) = \\mu f'(x) + \\frac{1}{2}\\sigma^2 f''(x)$. We seek a strictly increasing scale function $s$ by solving the ODE $\\mathcal{L}s(x) = 0$:\n$$ \\mu s'(x) + \\frac{1}{2}\\sigma^2 s''(x) = 0 $$\nThis is a second-order linear homogeneous ODE with constant coefficients. Let $y = s'(x)$. The equation becomes a first-order ODE for $y$: $\\mu y + \\frac{1}{2}\\sigma^2 y' = 0$.\nIf $\\mu \\neq 0$, we separate variables: $\\frac{y'}{y} = -\\frac{2\\mu}{\\sigma^2}$. Integrating with respect to $x$ gives $\\ln|y| = -\\frac{2\\mu}{\\sigma^2}x + C_1$, so $y = C_2 \\exp\\left(-\\frac{2\\mu}{\\sigma^2}x\\right)$.\nIntegrating $s'(x) = y$ with respect to $x$ gives the general solution for $s(x)$:\n$$ s(x) = \\int C_2 \\exp\\left(-\\frac{2\\mu}{\\sigma^2}x\\right) \\,\\mathrm{d}x = C_2 \\left(\\frac{-\\sigma^2}{2\\mu}\\right) \\exp\\left(-\\frac{2\\mu}{\\sigma^2}x\\right) + C_3 $$\n$$ s(x) = A \\exp\\left(-\\frac{2\\mu}{\\sigma^2}x\\right) + B $$\nwhere $A$ and $B$ are constants. We need $s(x)$ to be strictly increasing, so $s'(x)  0$.\n$s'(x) = A \\left(-\\frac{2\\mu}{\\sigma^2}\\right) \\exp\\left(-\\frac{2\\mu}{\\sigma^2}x\\right)$. Since the exponential term is always positive, we need $A(-\\frac{2\\mu}{\\sigma^2})0$. We can choose any constants that satisfy this. The final probability formula is invariant under affine transformations $s \\mapsto \\alpha s + \\beta$ for $\\alpha0$. A simple choice for a scale function (not necessarily increasing, but sufficient for the ratio) is $s(x) = \\exp\\left(-\\frac{2\\mu}{\\sigma^2}x\\right)$.\nUsing this choice in the formula from Part 1:\n$$ \\mathbb{P}_{x}(\\tau_{b}\\tau_{a}) = \\frac{\\exp\\left(-\\frac{2\\mu}{\\sigma^2}x\\right) - \\exp\\left(-\\frac{2\\mu}{\\sigma^2}a\\right)}{\\exp\\left(-\\frac{2\\mu}{\\sigma^2}b\\right) - \\exp\\left(-\\frac{2\\mu}{\\sigma^2}a\\right)} $$\n\nVerification 1: Boundary Value Problem. The probability $u(x) = \\mathbb{P}_{x}(\\tau_{b}\\tau_{a})$ must solve the BVP $\\mathcal{L}u=0$ on $(a,b)$ with boundary conditions $u(a)=0$ and $u(b)=1$. The general solution for $u(x)$ is $u(x) = A\\exp\\left(-\\frac{2\\mu}{\\sigma^2}x\\right) + B$.\nApplying the conditions:\n1. $u(a)=0 \\implies A\\exp\\left(-\\frac{2\\mu}{\\sigma^2}a\\right) + B = 0$\n2. $u(b)=1 \\implies A\\exp\\left(-\\frac{2\\mu}{\\sigma^2}b\\right) + B = 1$\nSubtracting the first from the second gives $A\\left(\\exp\\left(-\\frac{2\\mu}{\\sigma^2}b\\right) - \\exp\\left(-\\frac{2\\mu}{\\sigma^2}a\\right)\\right) = 1$. So, $A = \\left(\\exp\\left(-\\frac{2\\mu}{\\sigma^2}b\\right) - \\exp\\left(-\\frac{2\\mu}{\\sigma^2}a\\right)\\right)^{-1}$.\nFrom the first condition, $B = -A\\exp\\left(-\\frac{2\\mu}{\\sigma^2}a\\right)$.\nSubstituting $A$ and $B$ back into the solution:\n$u(x) = A\\exp\\left(-\\frac{2\\mu}{\\sigma^2}x\\right) - A\\exp\\left(-\\frac{2\\mu}{\\sigma^2}a\\right) = A\\left(\\exp\\left(-\\frac{2\\mu}{\\sigma^2}x\\right) - \\exp\\left(-\\frac{2\\mu}{\\sigma^2}a\\right)\\right)$.\nThis yields the same expression as above, confirming the result.\n\nVerification 2: Limit for $\\mu\\to 0$. In this case, the ODE for the scale function is $\\frac{1}{2}\\sigma^2 s''(x) = 0$, so $s(x) = C_1 x + C_2$. For $s$ to be strictly increasing, $C_10$. A simple choice is $s(x)=x$.\nThe probability becomes $\\mathbb{P}_{x}(\\tau_{b}\\tau_{a}) = \\frac{x-a}{b-a}$, the classic gambler's ruin formula.\nWe check this by taking the limit of our expression for $\\mu \\neq 0$ as $\\mu \\to 0$. As $\\mu\\to 0$, the expression is an indeterminate form $\\frac{0}{0}$. We apply L'Hôpital's rule by differentiating the numerator and denominator with respect to $\\mu$:\n$$ \\lim_{\\mu\\to 0} \\frac{\\frac{d}{d\\mu}\\left(e^{-\\frac{2\\mu x}{\\sigma^2}} - e^{-\\frac{2\\mu a}{\\sigma^2}}\\right)}{\\frac{d}{d\\mu}\\left(e^{-\\frac{2\\mu b}{\\sigma^2}} - e^{-\\frac{2\\mu a}{\\sigma^2}}\\right)} = \\lim_{\\mu\\to 0} \\frac{-\\frac{2x}{\\sigma^2}e^{-\\frac{2\\mu x}{\\sigma^2}} + \\frac{2a}{\\sigma^2}e^{-\\frac{2\\mu a}{\\sigma^2}}}{-\\frac{2b}{\\sigma^2}e^{-\\frac{2\\mu b}{\\sigma^2}} + \\frac{2a}{\\sigma^2}e^{-\\frac{2\\mu a}{\\sigma^2}}} $$\nEvaluating at $\\mu=0$:\n$$ \\frac{-\\frac{2x}{\\sigma^2} + \\frac{2a}{\\sigma^2}}{-\\frac{2b}{\\sigma^2} + \\frac{2a}{\\sigma^2}} = \\frac{-\\frac{2}{\\sigma^2}(x-a)}{-\\frac{2}{\\sigma^2}(b-a)} = \\frac{x-a}{b-a} $$\nThe limit matches, which completes the verification.\n\n**Part 3: Final Expression**\n\nFor the constant-coefficient case $dX_t = \\mu\\,\\mathrm{d}t + \\sigma\\,\\mathrm{d}W_t$ with $\\mu\\neq 0$, $\\sigma0$, and $axb$, the probability of hitting $b$ before $a$ is:\n$$ \\mathbb{P}_{x}(\\tau_{b}\\tau_{a}) = \\frac{\\exp\\left(-\\frac{2\\mu}{\\sigma^2}x\\right) - \\exp\\left(-\\frac{2\\mu}{\\sigma^2}a\\right)}{\\exp\\left(-\\frac{2\\mu}{\\sigma^2}b\\right) - \\exp\\left(-\\frac{2\\mu}{\\sigma^2}a\\right)} $$\nTo obtain a more compact form, we can multiply the numerator and denominator by $\\exp\\left(\\frac{2\\mu a}{\\sigma^2}\\right)$:\n$$ \\mathbb{P}_{x}(\\tau_{b}\\tau_{a}) = \\frac{\\exp\\left(-\\frac{2\\mu}{\\sigma^2}(x-a)\\right) - 1}{\\exp\\left(-\\frac{2\\mu}{\\sigma^2}(b-a)\\right) - 1} $$\nMultiplying by $\\frac{-1}{-1}$ gives the final expression requested.\n$$ \\mathbb{P}_{x}(\\tau_{b}\\tau_{a}) = \\frac{1 - \\exp\\left(-\\frac{2\\mu(x-a)}{\\sigma^2}\\right)}{1 - \\exp\\left(-\\frac{2\\mu(b-a)}{\\sigma^2}\\right)} $$\nThis form is elegant as it clearly shows the dependence on the distances $x-a$ and $b-a$ from the starting point to the boundaries.", "answer": "$$\\boxed{\\frac{1 - \\exp\\left(-\\frac{2\\mu(x-a)}{\\sigma^2}\\right)}{1 - \\exp\\left(-\\frac{2\\mu(b-a)}{\\sigma^2}\\right)}}$$", "id": "3078967"}, {"introduction": "The concept of a weak solution emphasizes that a stochastic process is a solution to an SDE relative to a specific probability measure. This exercise explores the profound consequences of changing this measure using Girsanov's theorem, which reveals how a change of measure adds a specific drift term to the SDE [@problem_id:3078953]. By working through this transformation, you will gain a concrete understanding of how a single process can represent solutions to different SDEs, a concept fundamental to the definition of weak solutions and essential in applications like financial modeling.", "problem": "Consider a one-dimensional stochastic differential equation (SDE) in the sense of Itô on a filtered probability space $\\left(\\Omega,\\mathcal{F},(\\mathcal{F}_{t})_{t\\geq 0},\\mathbb{P}\\right)$ supporting a standard Brownian motion (BM) $W=(W_{t})_{t\\geq 0}$:\n$$\ndX_{t}=b(X_{t})\\,dt+\\sigma(X_{t})\\,dW_{t},\\qquad X_{0}=x\\in\\mathbb{R},\n$$\nwhere $b:\\mathbb{R}\\to\\mathbb{R}$ and $\\sigma:\\mathbb{R}\\to\\mathbb{R}$ are globally Lipschitz and of at most linear growth, and $\\sigma$ is continuous with $\\inf_{y\\in\\mathbb{R}}|\\sigma(y)|0$. For $f\\in C_{c}^{2}(\\mathbb{R})$, the infinitesimal generator $L$ of $X$ under $\\mathbb{P}$ is defined by\n$$\nLf(y)=b(y)f'(y)+\\frac{1}{2}\\sigma(y)^{2}f''(y).\n$$\nLet $\\vartheta:\\mathbb{R}\\to\\mathbb{R}$ be a bounded Borel function. Define the Radon–Nikodym derivative on $\\mathcal{F}_{T}$ by\n$$\nZ_{T}=\\exp\\!\\left(\\int_{0}^{T}\\vartheta(X_{s})\\,dW_{s}-\\frac{1}{2}\\int_{0}^{T}\\vartheta(X_{s})^{2}\\,ds\\right),\n$$\nand assume Novikov’s condition $\\mathbb{E}_{\\mathbb{P}}\\!\\left[\\exp\\!\\left(\\frac{1}{2}\\int_{0}^{T}\\vartheta(X_{s})^{2}\\,ds\\right)\\right]\\infty$ holds for every fixed $T0$, so that $(Z_{t})_{t\\in[0,T]}$ is a martingale. For each fixed $T0$, define a new probability measure $\\mathbb{Q}$ on $\\mathcal{F}_{T}$ by $d\\mathbb{Q}=Z_{T}\\,d\\mathbb{P}$. By Girsanov’s theorem, the process\n$$\nW^{\\mathbb{Q}}_{t}=W_{t}-\\int_{0}^{t}\\vartheta(X_{s})\\,ds,\\qquad t\\in[0,T],\n$$\nis a BM under $\\mathbb{Q}$. Working on the time interval $[0,T]$, perform the following:\n\n- Starting from Itô’s formula and the definition of the generator under $\\mathbb{P}$, compute how the drift of $X$ is modified under $\\mathbb{Q}$ and derive the corresponding generator $L^{\\mathbb{Q}}$ acting on $f\\in C_{c}^{2}(\\mathbb{R})$.\n\n- Verify directly, using Itô’s formula and the characterization of BM under $\\mathbb{Q}$, that for each $f\\in C_{c}^{2}(\\mathbb{R})$ the process\n$$\nM^{f}_{t}=f(X_{t})-f(X_{0})-\\int_{0}^{t}L^{\\mathbb{Q}}f(X_{s})\\,ds,\\qquad t\\in[0,T],\n$$\nis a $\\mathbb{Q}$-martingale. Explain why this verifies consistency with the martingale problem for $L^{\\mathbb{Q}}$ and thus that $X$ is a weak solution under $\\mathbb{Q}$ with generator $L^{\\mathbb{Q}}$.\n\nProvide, as your final answer, a single closed-form analytic expression for $L^{\\mathbb{Q}}f(x)$ in terms of $b$, $\\sigma$, $\\vartheta$, and derivatives of $f$. No numerical approximation is required.", "solution": "The problem asks for two main tasks: first, to derive the infinitesimal generator $L^{\\mathbb{Q}}$ of the process $X$ under the new probability measure $\\mathbb{Q}$, and second, to verify that for any $f \\in C_c^2(\\mathbb{R})$, the process $M_t^f$ defined in the problem is a $\\mathbb{Q}$-martingale.\n\nLet's begin with the first task. We are given the stochastic differential equation (SDE) for $X_t$ under the measure $\\mathbb{P}$:\n$$\ndX_{t}=b(X_{t})\\,dt+\\sigma(X_{t})\\,dW_{t}\n$$\nwhere $W_t$ is a standard Brownian motion under $\\mathbb{P}$. By Girsanov's theorem, the process $W^{\\mathbb{Q}}_t$ defined by\n$$\nW^{\\mathbb{Q}}_{t}=W_{t}-\\int_{0}^{t}\\vartheta(X_{s})\\,ds\n$$\nis a standard Brownian motion under the measure $\\mathbb{Q}$. We can express $W_t$ in terms of $W^{\\mathbb{Q}}_t$ as:\n$$\nW_{t}=W^{\\mathbb{Q}}_{t}+\\int_{0}^{t}\\vartheta(X_{s})\\,ds\n$$\nIn differential form, this relationship is written as $dW_{t} = dW^{\\mathbb{Q}}_{t} + \\vartheta(X_t)\\,dt$. We can substitute this expression for $dW_t$ into the original SDE for $X_t$:\n$$\ndX_{t} = b(X_{t})\\,dt+\\sigma(X_{t})\\left(dW^{\\mathbb{Q}}_{t} + \\vartheta(X_{t})\\,dt\\right)\n$$\nBy rearranging the terms, we group the $dt$ (drift) and $dW^{\\mathbb{Q}}_t$ (diffusion) components:\n$$\ndX_{t} = \\left(b(X_{t}) + \\sigma(X_{t})\\vartheta(X_{t})\\right)\\,dt + \\sigma(X_{t})\\,dW^{\\mathbb{Q}}_{t}\n$$\nThis is the SDE for the process $X_t$ under the measure $\\mathbb{Q}$. We can identify the new drift coefficient, $b^{\\mathbb{Q}}$, as:\n$$\nb^{\\mathbb{Q}}(y) = b(y) + \\sigma(y)\\vartheta(y)\n$$\nThe diffusion coefficient, $\\sigma(y)$, remains unchanged. The infinitesimal generator of a one-dimensional diffusion process is given by the general form $Lg(y) = \\text{drift}(y)g'(y) + \\frac{1}{2}(\\text{diffusion}(y))^2 g''(y)$. Applying this to our process under $\\mathbb{Q}$, the generator $L^{\\mathbb{Q}}$ acting on a function $f\\in C_{c}^{2}(\\mathbb{R})$ is:\n$$\nL^{\\mathbb{Q}}f(y) = b^{\\mathbb{Q}}(y)f'(y) + \\frac{1}{2}\\sigma(y)^{2}f''(y)\n$$\nSubstituting the expression for $b^{\\mathbb{Q}}(y)$, we obtain the final form of the generator:\n$$\nL^{\\mathbb{Q}}f(y) = \\left(b(y) + \\sigma(y)\\vartheta(y)\\right)f'(y) + \\frac{1}{2}\\sigma(y)^{2}f''(y)\n$$\n\nFor the second task, we must verify that the process\n$$\nM^{f}_{t}=f(X_{t})-f(X_{0})-\\int_{0}^{t}L^{\\mathbb{Q}}f(X_{s})\\,ds\n$$\nis a $\\mathbb{Q}$-martingale for $f\\in C_c^2(\\mathbb{R})$. To do this, we apply Itô's formula for $f(X_t)$. The dynamics of $X_t$ are governed by the SDE under $\\mathbb{Q}$. According to Itô's formula, the differential of $f(X_t)$ is:\n$$\ndf(X_t) = f'(X_t)dX_t + \\frac{1}{2}f''(X_t)d\\langle X, X \\rangle_t\n$$\nThe quadratic variation of $X_t$ is determined by its diffusion term. From the SDE under $\\mathbb{Q}$, we have $d\\langle X, X \\rangle_t = (\\sigma(X_t)\\,dW^{\\mathbb{Q}}_t)^2 = \\sigma(X_t)^2 \\,dt$. Substituting this and the expression for $dX_t$ into Itô's formula:\n$$\ndf(X_t) = f'(X_t)\\left(b^{\\mathbb{Q}}(X_t)\\,dt + \\sigma(X_t)\\,dW^{\\mathbb{Q}}_t\\right) + \\frac{1}{2}f''(X_t)\\sigma(X_t)^2 \\,dt\n$$\nGrouping the $dt$ and $dW^{\\mathbb{Q}}_t$ terms gives:\n$$\ndf(X_t) = \\left(b^{\\mathbb{Q}}(X_t)f'(X_t) + \\frac{1}{2}\\sigma(X_t)^2 f''(X_t)\\right)\\,dt + \\sigma(X_t)f'(X_t)\\,dW^{\\mathbb{Q}}_t\n$$\nThe term in the parentheses is precisely the definition of $L^{\\mathbb{Q}}f(X_t)$. Therefore:\n$$\ndf(X_t) = L^{\\mathbb{Q}}f(X_t)\\,dt + \\sigma(X_t)f'(X_t)\\,dW^{\\mathbb{Q}}_t\n$$\nNow, let's find the differential of $M^f_t$:\n$$\ndM^f_t = df(X_t) - d\\left(\\int_{0}^{t}L^{\\mathbb{Q}}f(X_{s})\\,ds\\right) = df(X_t) - L^{\\mathbb{Q}}f(X_t)\\,dt\n$$\nSubstituting the derived expression for $df(X_t)$:\n$$\ndM^f_t = \\left(L^{\\mathbb{Q}}f(X_t)\\,dt + \\sigma(X_t)f'(X_t)\\,dW^{\\mathbb{Q}}_t\\right) - L^{\\mathbb{Q}}f(X_t)\\,dt\n$$\nThis simplifies to:\n$$\ndM^f_t = \\sigma(X_t)f'(X_t)\\,dW^{\\mathbb{Q}}_t\n$$\nIntegrating from $0$ to $t$, and noting that $M^f_0 = f(X_0) - f(X_0) - 0 = 0$, we find:\n$$\nM^f_t = \\int_0^t \\sigma(X_s)f'(X_s)\\,dW^{\\mathbb{Q}}_s\n$$\nThe process $M^f_t$ is an Itô integral with respect to the $\\mathbb{Q}$-Brownian motion $W^{\\mathbb{Q}}$. For such a process to be a $\\mathbb{Q}$-martingale, the integrand must satisfy a square-integrability condition. Let the integrand be $\\psi_s = \\sigma(X_s)f'(X_s)$. Since $f \\in C_c^2(\\mathbb{R})$, its derivative $f'$ is continuous and has compact support. Let the support of $f'$ be the compact set $K$. Thus, $f'$ is bounded on $\\mathbb{R}$. Also, the coefficient $\\sigma$ is continuous, so it is bounded on the compact set $K$. The integrand $\\psi_s$ is zero if $X_s \\notin K$. If $X_s \\in K$, then $|\\psi_s| \\le \\sup_{y\\in K}|\\sigma(y)| \\cdot \\sup_{y\\in K}|f'(y)|$. This shows that the integrand $\\psi_s$ is a bounded process. A bounded integrand ensures that $\\mathbb{E}_{\\mathbb{Q}}\\left[\\int_0^T \\psi_s^2 \\,ds\\right]  \\infty$ for any finite $T  0$. Therefore, the Itô integral $M^f_t$ is a true $\\mathbb{Q}$-martingale, not just a local one.\n\nThis verification confirms the consistency of our derived generator $L^{\\mathbb{Q}}$. By definition, a process $X$ starting at $x$ is a solution to the martingale problem for an operator $L$ if, for every suitable test function $f$, the process $f(X_t) - f(x) - \\int_0^t L f(X_s) ds$ is a martingale. We have shown that the process $X$, under the measure $\\mathbb{Q}$, solves the martingale problem for the operator $L^{\\mathbb{Q}}$. The existence of a solution to the martingale problem is equivalent to the existence of a weak solution to the SDE associated with the generator $L^{\\mathbb{Q}}$. Thus, we have confirmed that $X$ is a weak solution to the SDE $dX_t = b^{\\mathbb{Q}}(X_t)\\,dt + \\sigma(X_t)\\,dW^{\\mathbb{Q}}_t$ under the measure $\\mathbb{Q}$.\nThe final answer requested is the expression for $L^{\\mathbb{Q}}f(x)$. Replacing the generic variable $y$ with $x$, we have:\n$$\nL^{\\mathbb{Q}}f(x) = (b(x) + \\sigma(x)\\vartheta(x))f'(x) + \\frac{1}{2}\\sigma(x)^{2}f''(x)\n$$", "answer": "$$\n\\boxed{(b(x) + \\sigma(x)\\vartheta(x))f'(x) + \\frac{1}{2}\\sigma(x)^{2}f''(x)}\n$$", "id": "3078953"}, {"introduction": "A crucial aspect of SDE theory is understanding the conditions under which a solution is unique. This problem explores the subtle but critical distinction between uniqueness in law (all weak solutions have the same probability distribution) and pathwise uniqueness (all solutions driven by the same Brownian motion are identical) [@problem_id:3078966]. By analyzing the famous Tanaka SDE, you will encounter the canonical example where uniqueness in law holds but pathwise uniqueness fails, clarifying why the existence of a strong solution is a more demanding property than the existence of a weak one.", "problem": "Consider the definitions for stochastic differential equations (SDEs). A weak solution to an SDE is a triple consisting of a filtered probability space, a Brownian motion, and an adapted process that satisfies the SDE in the Itô sense; a strong solution is a solution adapted to the filtration generated by the given Brownian motion. Pathwise uniqueness means that if two solutions are defined on the same filtered probability space and are driven by the same Brownian motion, then they are indistinguishable. Uniqueness in law means the distribution of the solution (for a fixed initial distribution) is unique across all weak solutions. The Yamada–Watanabe theorem (YW theorem) states that weak existence plus pathwise uniqueness implies strong existence and uniqueness in law; moreover, weak uniqueness together with strong existence implies pathwise uniqueness.\n\nYour task is to select the option that correctly provides an example of an SDE where uniqueness in law holds but pathwise uniqueness fails, and to correctly interpret how this fits within the Yamada–Watanabe framework. Choose the option whose SDE and explanation together are correct and scientifically consistent.\n\nA. The SDE is $dX_t = \\operatorname{sgn}(X_t)\\, dW_t$ with $X_0 = 0$, where $\\operatorname{sgn}(x)$ is the sign function with $\\operatorname{sgn}(0) = 0$. For any weak solution $X$, the quadratic variation satisfies $\\langle X \\rangle_t = \\int_0^t \\operatorname{sgn}^2(X_s)\\, ds = t$ almost surely, so $X$ is a Brownian motion in law, giving uniqueness in law. However, pathwise uniqueness fails because different solutions driven by the same Brownian motion can be constructed by randomizing the sign choices at hitting times of $0$. This aligns with the YW theorem in that weak uniqueness holds but pathwise uniqueness fails, which implies there is no strong solution.\n\nB. The SDE is $dX_t = -X_t\\, dt + dW_t$ with $X_0 = 0$. The coefficients are globally Lipschitz. The claim is that uniqueness in law holds while pathwise uniqueness fails, and this shows that the YW theorem does not require pathwise uniqueness for strong solutions.\n\nC. The SDE is $dX_t = |X_t|^\\alpha\\, dW_t$ with $X_0 = 0$ and $\\alpha \\in (0, 1/2)$. The claim is that uniqueness in law holds but pathwise uniqueness fails, illustrating that weak uniqueness does not imply strong existence in the YW theorem.\n\nD. The SDE is $dX_t = dW_t$ with $X_0 = 0$. The claim is that uniqueness in law holds but pathwise uniqueness fails, and this shows that the YW theorem can fail even for constant coefficients.\n\nSelect all options that are correct.", "solution": "The user wants me to identify the correct option describing an SDE that exhibits uniqueness in law but lacks pathwise uniqueness, and to provide a correct interpretation within the framework of the Yamada–Watanabe theorem.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n-   **Weak Solution:** A triple $((\\Omega, \\mathcal{F}, \\{\\mathcal{F}_t\\}, \\mathbb{P}), (W_t), (X_t))$ where $(\\Omega, \\mathcal{F}, \\{\\mathcal{F}_t\\}, \\mathbb{P})$ is a filtered probability space, $(W_t)$ is an $(\\mathcal{F}_t)$-Brownian motion, and $(X_t)$ is an $(\\mathcal{F}_t)$-adapted process satisfying the SDE.\n-   **Strong Solution:** A solution $(X_t)$ that is adapted to the filtration generated by a *given* Brownian motion $(W_t)$.\n-   **Pathwise Uniqueness:** For any two solutions $(X_t)$ and $(Y_t)$ on the same filtered probability space driven by the same Brownian motion $(W_t)$, $\\mathbb{P}(X_t = Y_t \\text{ for all } t \\ge 0) = 1$.\n-   **Uniqueness in Law (Weak Uniqueness):** The law (probability distribution) of any weak solution $(X_t)$ is the same for a fixed initial distribution.\n-   **Yamada–Watanabe (YW) Theorem:**\n    1.  Weak Existence + Pathwise Uniqueness $\\implies$ Strong Existence + Uniqueness in Law.\n    2.  Uniqueness in Law + Strong Existence $\\implies$ Pathwise Uniqueness.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem statement provides standard, mathematically correct definitions and a correct statement of the Yamada–Watanabe theorem from the field of stochastic differential equations. The task is to apply these concepts to identify a correct example among a set of choices. The problem is scientifically grounded, well-posed, and objective. It contains no internal contradictions, ambiguities, or unsound premises.\n\n**Step 3: Verdict and Action**\nThe problem statement is valid. I will proceed with the solution derivation and option analysis.\n\n### Solution Derivation\n\nThe problem requires finding an example of a stochastic differential equation (SDE) that satisfies two conditions:\n1.  Uniqueness in law holds.\n2.  Pathwise uniqueness fails.\n\nLet's analyze the consequences of these conditions using the provided Yamada–Watanabe (YW) theorem. The second part of the theorem states:\n$$ (\\text{Uniqueness in Law}) \\land (\\text{Strong Existence}) \\implies (\\text{Pathwise Uniqueness}) $$\nThe contrapositive of this statement is:\n$$ \\neg(\\text{Pathwise Uniqueness}) \\implies \\neg(\\text{Uniqueness in Law}) \\lor \\neg(\\text{Strong Existence}) $$\nIf we are looking for an SDE where uniqueness in law holds but pathwise uniqueness fails, we have the premises:\n-   $\\neg(\\text{Pathwise Uniqueness})$ is true.\n-   $\\text{Uniqueness in Law}$ is true, which means $\\neg(\\text{Uniqueness in Law})$ is false.\n\nSubstituting these into the contrapositive statement, we get:\n$$ \\text{True} \\implies (\\text{False}) \\lor \\neg(\\text{Strong Existence}) $$\nFor this implication to hold, the right side must be true. Since the first part of the disjunction is false, the second part must be true. Therefore, a necessary consequence is:\n$$ \\neg(\\text{Strong Existence}) $$\nIn summary, any SDE that has uniqueness in law but fails to have pathwise uniqueness cannot have a strong solution. A complete example must therefore exhibit:\n1.  Weak existence.\n2.  Uniqueness in law.\n3.  Failure of pathwise uniqueness.\n4.  Failure of strong existence.\n\nNow, I will analyze each option based on these criteria.\n\n### Option-by-Option Analysis\n\n**A. The SDE is $dX_t = \\operatorname{sgn}(X_t)\\, dW_t$ with $X_0 = 0$, where $\\operatorname{sgn}(x)$ is the sign function with $\\operatorname{sgn}(0) = 0$. For any weak solution $X$, the quadratic variation satisfies $\\langle X \\rangle_t = \\int_0^t \\operatorname{sgn}^2(X_s)\\, ds = t$ almost surely, so $X$ is a Brownian motion in law, giving uniqueness in law. However, pathwise uniqueness fails because different solutions driven by the same Brownian motion can be constructed by randomizing the sign choices at hitting times of $0$. This aligns with the YW theorem in that weak uniqueness holds but pathwise uniqueness fails, which implies there is no strong solution.**\n\nThis is the Tanaka SDE, a canonical example for this phenomenon.\n-   **Uniqueness in Law:** Let $(X_t, W_t)$ be a weak solution. By definition, $X_t = \\int_0^t \\operatorname{sgn}(X_s) dW_s$. $X_t$ is a continuous local martingale starting at $X_0=0$. Its quadratic variation is given by $\\langle X \\rangle_t = \\int_0^t (\\operatorname{sgn}(X_s))^2 d\\langle W \\rangle_s$. For a non-trivial solution, the set of times $\\{s: X_s = 0\\}$ has Lebesgue measure zero. Thus, $(\\operatorname{sgn}(X_s))^2 = 1$ for almost every $s$. Since $\\langle W \\rangle_s = s$, we have $\\langle X \\rangle_t = \\int_0^t 1 \\, ds = t$. By Lévy's characterization of Brownian motion, any continuous local martingale $X_t$ with $X_0=0$ and $\\langle X \\rangle_t = t$ must be a standard Brownian motion. Therefore, any weak solution has the law of a standard Brownian motion. This means uniqueness in law holds. The argument in the option is correct.\n-   **Pathwise Uniqueness:** This SDE is known to lack pathwise uniqueness. The diffusion coefficient $\\sigma(x) = \\operatorname{sgn}(x)$ is not locally Lipschitz nor does it satisfy other common sufficient conditions for pathwise uniqueness (like the non-degeneracy condition $\\int_{-\\epsilon}^{\\epsilon} \\sigma(x)^{-2}dx = \\infty$). The failure of pathwise uniqueness can be proven rigorously by showing that its existence would imply the existence of a strong solution, which leads to a contradiction. The explanation about \"randomizing sign choices\" is an intuitive, albeit informal, pointer to the reason for this failure.\n-   **Interpretation:** The option states that \"weak uniqueness holds but pathwise uniqueness fails, which implies there is no strong solution.\" As derived above from the YW theorem, this logical implication is correct.\n\nAll parts of this option—the SDE, the analysis of its properties, and the aplication of the YW theorem—are correct.\n\n**Verdict: Correct**\n\n**B. The SDE is $dX_t = -X_t\\, dt + dW_t$ with $X_0 = 0$. The coefficients are globally Lipschitz. The claim is that uniqueness in law holds while pathwise uniqueness fails, and this shows that the YW theorem does not require pathwise uniqueness for strong solutions.**\n\nThis is the SDE for the Ornstein-Uhlenbeck process.\n-   **Analysis:** The drift coefficient $b(x) = -x$ and the diffusion coefficient $\\sigma(x)=1$ are both globally Lipschitz continuous. A fundamental theorem of SDEs states that if the coefficients are globally Lipschitz, there exists a unique strong solution. A strong solution is, by its nature, pathwise unique. Since strong existence and pathwise uniqueness hold, the YW theorem further implies that uniqueness in law holds. The claim that pathwise uniqueness fails is false.\n-   **Interpretation:** The interpretation is also flawed. A strong solution is inherently pathwise unique. The statement that the YW theorem \"does not require pathwise uniqueness for strong solutions\" is nonsensical.\n\n**Verdict: Incorrect**\n\n**C. The SDE is $dX_t = |X_t|^\\alpha\\, dW_t$ with $X_0 = 0$ and $\\alpha \\in (0, 1/2)$. The claim is that uniqueness in law holds but pathwise uniqueness fails, illustrating that weak uniqueness does not imply strong existence in the YW theorem.**\n\n-   **Analysis:** For this SDE, the diffusion coefficient is $\\sigma(x) = |x|^\\alpha$. The Engelbert-Schmidt zero-one law provides criteria for uniqueness for SDEs of the form $dX_t = \\sigma(X_t) dW_t$. Pathwise uniqueness (and uniqueness in law) fails if $\\int_0^\\epsilon \\sigma(x)^{-2} dx  \\infty$. Here, $\\sigma(x)^{-2} = |x|^{-2\\alpha}$. The integral is $\\int_0^\\epsilon x^{-2\\alpha} dx = [\\frac{x^{1-2\\alpha}}{1-2\\alpha}]_0^\\epsilon$. Since $\\alpha \\in (0, 1/2)$, we have $1-2\\alpha  0$, so the integral is finite. Thus, both pathwise uniqueness and uniqueness in law fail. A simple way to see the failure of uniqueness in law is to note that $X_t=0$ is a valid (trivial) solution, but non-trivial weak solutions also exist, which clearly have a different law. The option's claim that uniqueness in law holds is false.\n-   **Interpretation:** The statement that this example illustrates \"that weak uniqueness does not imply strong existence\" is based on a false premise, since weak uniqueness does not hold for this SDE.\n\n**Verdict: Incorrect**\n\n**D. The SDE is $dX_t = dW_t$ with $X_0 = 0$. The claim is that uniqueness in law holds but pathwise uniqueness fails, and this shows that the YW theorem can fail even for constant coefficients.**\n\n-   **Analysis:** The solution to this SDE is simply $X_t = W_t$. Given a Brownian motion $W_t$, the solution is uniquely determined as $W_t$ itself. Therefore, pathwise uniqueness holds trivially. As in option B, the coefficients ($b(x)=0, \\sigma(x)=1$) are globally Lipschitz, guaranteeing a unique strong solution. The claim that pathwise uniqueness fails is false.\n-   **Interpretation:** The YW theorem does not fail for this SDE; on the contrary, this is a textbook case where all conditions for existence and uniqueness are met and the theorem's implications hold perfectly.\n\n**Verdict: Incorrect**", "answer": "$$\\boxed{A}$$", "id": "3078966"}]}