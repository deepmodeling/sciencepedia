{"hands_on_practices": [{"introduction": "Before diving into complex algorithms, let's start with a conceptual warm-up. This problem explores the special case where a matrix's columns are already orthogonal. By examining this scenario [@problem_id:1385311], you can build a strong intuition for what the $Q$ and $R$ matrices truly represent: $Q$ captures the directional information of the column space via an orthonormal basis, while $R$ encodes the scaling and relationships between the original columns.", "problem": "Consider the matrix $A$ given by\n$$\nA = \\begin{pmatrix} 3  4  0 \\\\ 4  -3  0 \\\\ 0  0  2 \\end{pmatrix}\n$$\nThe columns of this matrix, let's call them $\\mathbf{a}_1, \\mathbf{a}_2, \\mathbf{a}_3$, are mutually orthogonal. Any matrix $A$ with linearly independent columns can be written as a product $A=QR$, where $Q$ is a matrix whose columns form an orthonormal set, and $R$ is an invertible upper triangular matrix with positive diagonal entries. This is known as the QR factorization of $A$.\n\nFind the matrix $R$ for the given matrix $A$.", "solution": "Let the columns of $A$ be $\\mathbf{a}_{1}, \\mathbf{a}_{2}, \\mathbf{a}_{3}$. Since the columns are mutually orthogonal and nonzero, we can form an orthonormal set by normalizing each column:\n$$\n\\mathbf{q}_{i}=\\frac{\\mathbf{a}_{i}}{\\|\\mathbf{a}_{i}\\|} \\quad \\text{for } i=1,2,3.\n$$\nIn the QR factorization $A=QR$ with $Q=[\\mathbf{q}_{1}\\ \\mathbf{q}_{2}\\ \\mathbf{q}_{3}]$ having orthonormal columns and $R$ upper triangular with positive diagonal entries, the entries of $R$ are given by\n$$\nr_{ij}=\\mathbf{q}_{i}^{T}\\mathbf{a}_{j} \\quad \\text{for } i\\leq j.\n$$\nBecause the columns of $A$ are mutually orthogonal, we have $\\mathbf{a}_{i}^{T}\\mathbf{a}_{j}=0$ for $i\\neq j$, hence for $ij$,\n$$\nr_{ij}=\\mathbf{q}_{i}^{T}\\mathbf{a}_{j}=\\frac{\\mathbf{a}_{i}^{T}\\mathbf{a}_{j}}{\\|\\mathbf{a}_{i}\\|}=0.\n$$\nTherefore $R$ is diagonal with\n$$\nr_{ii}=\\|\\mathbf{a}_{i}\\| \\quad \\text{and} \\quad r_{ij}=0 \\text{ for } ij.\n$$\nCompute the norms:\n$$\n\\|\\mathbf{a}_{1}\\|=\\sqrt{3^{2}+4^{2}+0^{2}}=5,\\quad\n\\|\\mathbf{a}_{2}\\|=\\sqrt{4^{2}+(-3)^{2}+0^{2}}=5,\\quad\n\\|\\mathbf{a}_{3}\\|=\\sqrt{0^{2}+0^{2}+2^{2}}=2.\n$$\nThus\n$$\nR=\\begin{pmatrix}\n5  0  0 \\\\\n0  5  0 \\\\\n0  0  2\n\\end{pmatrix}.\n$$", "answer": "$$\\boxed{\\begin{pmatrix}5  0  0 \\\\ 0  5  0 \\\\ 0  0  2\\end{pmatrix}}$$", "id": "1385311"}, {"introduction": "In most practical situations, a matrix's columns are not orthogonal. This is where the Gram-Schmidt process becomes an essential tool. This exercise [@problem_id:1385295] provides hands-on practice with this fundamental algorithm, guiding you through the step-by-step procedure of orthogonalizing a set of vectors to construct the $Q$ and $R$ matrices. Mastering this process is key to computing QR factorizations from scratch.", "problem": "Consider the matrix $A$ given by:\n$$A = \\begin{pmatrix} 1  1 \\\\ 2  0 \\\\ 2  -1 \\end{pmatrix}$$\nA QR factorization of $A$ is a decomposition $A = QR$, where $Q$ is a matrix with orthonormal columns and $R$ is an upper triangular matrix. Find the matrix $R$ in the QR factorization of $A$ obtained by applying the Gram-Schmidt process to the columns of $A$, taken in their given order from left to right. The process must be normalized such that the diagonal entries of the matrix $R$ are positive.", "solution": "Let the columns of $A$ be $a_{1}$ and $a_{2}$ with\n$$a_{1}=\\begin{pmatrix}1\\\\2\\\\2\\end{pmatrix}, \\quad a_{2}=\\begin{pmatrix}1\\\\0\\\\-1\\end{pmatrix}.$$\nClassical Gram-Schmidt proceeds as follows.\n\nFirst, compute $r_{11}=\\|a_{1}\\|$ and $q_{1}=a_{1}/r_{11}$:\n$$\\|a_{1}\\|=\\sqrt{1^{2}+2^{2}+2^{2}}=\\sqrt{9}=3,$$\n$$q_{1}=\\frac{1}{3}\\begin{pmatrix}1\\\\2\\\\2\\end{pmatrix}=\\begin{pmatrix}\\frac{1}{3}\\\\\\frac{2}{3}\\\\\\frac{2}{3}\\end{pmatrix}.$$\n\nNext, compute $r_{12}=q_{1}^{T}a_{2}$:\n$$r_{12}=\\begin{pmatrix}\\frac{1}{3}\\frac{2}{3}\\frac{2}{3}\\end{pmatrix}\\begin{pmatrix}1\\\\0\\\\-1\\end{pmatrix}=\\frac{1}{3}-\\frac{2}{3}=-\\frac{1}{3}.$$\n\nForm $u_{2}=a_{2}-r_{12}q_{1}$ and then $r_{22}=\\|u_{2}\\|$:\n$$u_{2}=a_{2}-\\left(-\\frac{1}{3}\\right)q_{1}=a_{2}+\\frac{1}{3}q_{1}=\\begin{pmatrix}1\\\\0\\\\-1\\end{pmatrix}+\\frac{1}{3}\\begin{pmatrix}\\frac{1}{3}\\\\\\frac{2}{3}\\\\\\frac{2}{3}\\end{pmatrix}=\\begin{pmatrix}1\\\\0\\\\-1\\end{pmatrix}+\\begin{pmatrix}\\frac{1}{9}\\\\\\frac{2}{9}\\\\\\frac{2}{9}\\end{pmatrix}=\\begin{pmatrix}\\frac{10}{9}\\\\\\frac{2}{9}\\\\-\\frac{7}{9}\\end{pmatrix},$$\n$$\\|u_{2}\\|=\\sqrt{\\left(\\frac{10}{9}\\right)^{2}+\\left(\\frac{2}{9}\\right)^{2}+\\left(-\\frac{7}{9}\\right)^{2}}=\\sqrt{\\frac{100+4+49}{81}}=\\sqrt{\\frac{153}{81}}=\\frac{\\sqrt{9 \\cdot 17}}{9}=\\frac{3\\sqrt{17}}{9}=\\frac{\\sqrt{17}}{3}.$$\n\nWith the convention that diagonal entries are positive, we take\n$$r_{11}=3,\\quad r_{12}=-\\frac{1}{3},\\quad r_{22}=\\frac{\\sqrt{17}}{3}.$$\nTherefore, the upper triangular matrix $R$ is\n$$R=\\begin{pmatrix}3  -\\frac{1}{3}\\\\ 0  \\frac{\\sqrt{17}}{3}\\end{pmatrix}.$$", "answer": "$$\\boxed{\\begin{pmatrix}3  -\\frac{1}{3}\\\\ 0  \\frac{\\sqrt{17}}{3}\\end{pmatrix}}$$", "id": "1385295"}, {"introduction": "Now that you have practiced constructing a QR factorization, let's explore one of its most powerful applications: solving least-squares problems. Many real-world problems, from data fitting to machine learning, result in overdetermined systems of linear equations that have no exact solution. This practice problem [@problem_id:1057223] demonstrates how QR factorization provides an elegant and numerically stable method to find the best possible approximate solution by simplifying the problem into solving a straightforward upper triangular system.", "problem": "Consider the overdetermined linear system $A\\mathbf{x} = \\mathbf{b}$, where  \n$$  \nA = \\begin{bmatrix}  \n\\cos \\theta  -\\sin \\theta \\\\  \n\\sin \\theta  \\cos \\theta \\\\  \n1  0  \n\\end{bmatrix}, \\quad \\mathbf{b} = \\begin{bmatrix} 0 \\\\ 0 \\\\ 1 \\end{bmatrix}.  \n$$  \nUsing QR factorization, solve this system in the least squares sense for the specific angle $\\theta = \\frac{\\pi}{2}$. Report the value of the first component, $x_1$, of the solution vector $\\mathbf{x}$.", "solution": "For $\\theta=\\pi/2$ we have  \n$$A=\\begin{bmatrix}0-1\\\\10\\\\10\\end{bmatrix},\\quad \\mathbf{b}=\\begin{bmatrix}0\\\\0\\\\1\\end{bmatrix}.$$  \nDenote the columns of $A$ by $\\mathbf{a}_1, \\mathbf{a}_2$.  \n1. Gramâ€“Schmidt:  \n   $\\mathbf{u}_1=\\mathbf{a}_1=(0,1,1)^T,\\quad\\|\\mathbf{u}_1\\|=\\sqrt{2},\\quad \\mathbf{q}_1=\\frac{\\mathbf{u}_1}{\\sqrt{2}}.$  \n   $\\mathbf{u}_2=\\mathbf{a}_2-(\\mathbf{q}_1^T\\mathbf{a}_2)\\mathbf{q}_1=\\mathbf{a}_2,\\quad\\|\\mathbf{u}_2\\|=1,\\quad \\mathbf{q}_2=\\mathbf{a}_2.$  \n2. Thus  \n$$Q=\\begin{bmatrix}0-1\\\\\\frac{1}{\\sqrt{2}}0\\\\\\frac{1}{\\sqrt{2}}0\\end{bmatrix},\\quad\nR=\\begin{bmatrix}\\sqrt{2}0\\\\01\\end{bmatrix}.$$  \n3. Compute $Q^T\\mathbf{b}$:  \n$$Q^T\\mathbf{b}=\\begin{pmatrix}\\mathbf{q}_1^T\\mathbf{b}\\\\\\mathbf{q}_2^T\\mathbf{b}\\end{pmatrix}\n=\\begin{pmatrix}\\frac{1}{\\sqrt{2}}\\\\0\\end{pmatrix}.$$  \n4. Solve $R\\mathbf{x}=Q^T\\mathbf{b}$:  \n$$\\sqrt{2}\\,x_1=\\frac{1}{\\sqrt{2}}\\implies x_1=\\frac{1}{2},\\qquad x_2=0.$$", "answer": "$$\\boxed{\\frac{1}{2}}$$", "id": "1057223"}]}