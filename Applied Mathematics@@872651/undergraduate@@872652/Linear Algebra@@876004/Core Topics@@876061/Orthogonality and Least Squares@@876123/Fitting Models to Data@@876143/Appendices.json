{"hands_on_practices": [{"introduction": "Finding the best-fit line is a cornerstone of data analysis. This exercise explores a practical and elegant technique known as data centering, where the independent variable is shifted by its mean before fitting. As you will see, this preprocessing step can greatly simplify the normal equations, providing a more direct path to the solution and offering insights into the structure of the least-squares problem.[@problem_id:1362186]", "problem": "An engineering student is calibrating a custom-built temperature sensor. The sensor produces a voltage that is expected to be linearly related to the temperature. To simplify the statistical analysis of the fit, the student decides to use a centered independent variable. They collect the following four data points, where $T$ is the temperature in degrees Celsius and $V$ is the corresponding voltage output in volts:\n\n- $(T_1, V_1) = (10, 2)$\n- $(T_2, V_2) = (20, 3)$\n- $(T_3, V_3) = (30, 4)$\n- $(T_4, V_4) = (40, 5)$\n\nFirst, the student calculates the mean temperature, $\\bar{T}$, from the given data. They then define a new centered temperature variable, $x = T - \\bar{T}$. The student proposes a linear model of the form:\n\n$$V = c_0 + c_1 x$$\n\nYour task is to find the coefficients $c_0$ and $c_1$ that define the best-fit line in the least-squares sense for the relationship between the voltage $V$ and the centered temperature $x$.\n\nDetermine the values of the pair $(c_0, c_1)$. The coefficients $c_0$ and $c_1$ are considered dimensionless for this analysis. Express your answers as exact fractions. Present your final answer as a row matrix for $(c_0, c_1)$.", "solution": "Compute the mean temperature using $\\bar{T} = \\frac{1}{n}\\sum_{i=1}^{n}T_{i}$ with $n=4$:\n$$\n\\bar{T} = \\frac{10+20+30+40}{4} = 25.\n$$\nDefine the centered variable $x_{i} = T_{i} - \\bar{T}$, giving\n$$\nx_{1} = -15,\\quad x_{2} = -5,\\quad x_{3} = 5,\\quad x_{4} = 15.\n$$\nWe fit the linear model $V = c_{0} + c_{1}x$ by least squares, minimizing\n$$\nS(c_{0},c_{1}) = \\sum_{i=1}^{4}\\left(V_{i} - c_{0} - c_{1}x_{i}\\right)^{2}.\n$$\nSetting partial derivatives to zero yields the normal equations:\n$$\n\\sum_{i=1}^{4}\\left(V_{i} - c_{0} - c_{1}x_{i}\\right) = 0,\\qquad \\sum_{i=1}^{4}x_{i}\\left(V_{i} - c_{0} - c_{1}x_{i}\\right) = 0.\n$$\nSince $x$ is centered, $\\sum_{i=1}^{4}x_{i} = 0$. The first normal equation reduces to\n$$\n\\sum_{i=1}^{4}V_{i} - 4c_{0} = 0 \\;\\;\\Rightarrow\\;\\; c_{0} = \\bar{V},\n$$\nwhere $\\bar{V} = \\frac{1}{4}\\sum_{i=1}^{4}V_{i}$. Compute $\\bar{V}$:\n$$\n\\bar{V} = \\frac{2+3+4+5}{4} = \\frac{14}{4} = \\frac{7}{2}.\n$$\nThe second normal equation becomes\n$$\n\\sum_{i=1}^{4}x_{i}\\left(V_{i} - \\bar{V}\\right) - c_{1}\\sum_{i=1}^{4}x_{i}^{2} = 0 \\;\\;\\Rightarrow\\;\\; c_{1} = \\frac{\\sum_{i=1}^{4}x_{i}\\left(V_{i} - \\bar{V}\\right)}{\\sum_{i=1}^{4}x_{i}^{2}}.\n$$\nCompute the numerator and denominator exactly:\n$$\nV_{i} - \\bar{V} \\in \\left\\{-\\frac{3}{2}, -\\frac{1}{2}, \\frac{1}{2}, \\frac{3}{2}\\right\\},\\quad \\sum_{i=1}^{4}x_{i}\\left(V_{i} - \\bar{V}\\right) = (-15)\\left(-\\frac{3}{2}\\right) + (-5)\\left(-\\frac{1}{2}\\right) + 5\\left(\\frac{1}{2}\\right) + 15\\left(\\frac{3}{2}\\right) = 50,\n$$\n$$\n\\sum_{i=1}^{4}x_{i}^{2} = (-15)^{2} + (-5)^{2} + 5^{2} + 15^{2} = 225 + 25 + 25 + 225 = 500.\n$$\nTherefore,\n$$\nc_{1} = \\frac{50}{500} = \\frac{1}{10},\\qquad c_{0} = \\frac{7}{2}.\n$$\nThus the least-squares coefficients are $(c_{0}, c_{1}) = \\left(\\frac{7}{2}, \\frac{1}{10}\\right)$.", "answer": "$$\\boxed{\\begin{pmatrix}\\frac{7}{2} & \\frac{1}{10}\\end{pmatrix}}$$", "id": "1362186"}, {"introduction": "In many scientific and engineering contexts, theoretical knowledge imposes constraints on model parameters. This practice moves beyond simple fitting to show how to handle such scenarios. By incorporating a linear constraint directly into the model, you will use substitution to transform a constrained problem into an unconstrained one, a powerful and widely applicable technique.[@problem_id:1362201]", "problem": "An engineer is modeling an observed physical phenomenon. Based on theoretical considerations, the model is expected to follow the form $y(x) = c_1 e^{x} + c_2 e^{-x}$. However, due to the specifics of the experimental setup, the coefficients $c_1$ and $c_2$ are known to be linearly constrained such that their sum is exactly two, i.e., $c_1 + c_2 = 2$.\n\nThe engineer collects the following three data points $(x_i, y_i)$:\n$(-1, 3.5)$, $(0, 2.1)$, and $(1, 4.0)$.\n\nYour task is to find the value of the coefficient $c_1$ that provides the best fit for this model to the data, in the least-squares sense, while satisfying the given constraint.\n\nReport your final answer for the value of $c_1$, rounded to four significant figures.", "solution": "We model the data by $y(x)=c_{1}\\exp(x)+c_{2}\\exp(-x)$ with the linear constraint $c_{1}+c_{2}=2$. Enforcing the constraint by substituting $c_{2}=2-c_{1}$ reduces the model to a single parameter:\n$$\n\\hat{y}(x;c_{1})=c_{1}\\big(\\exp(x)-\\exp(-x)\\big)+2\\exp(-x).\n$$\nFor data $\\{(x_{i},y_{i})\\}_{i=1}^{3}$, define\n$$\nd_{i}=\\exp(x_{i})-\\exp(-x_{i}),\\qquad h_{i}=2\\exp(-x_{i}),\n$$\nso that $\\hat{y}_{i}(c_{1})=c_{1}d_{i}+h_{i}$. The least-squares objective is\n$$\nS(c_{1})=\\sum_{i=1}^{3}\\big(c_{1}d_{i}+h_{i}-y_{i}\\big)^{2}.\n$$\nThe minimizer satisfies the normal equation obtained by setting the derivative to zero:\n$$\n\\frac{dS}{dc_{1}}=2\\sum_{i=1}^{3}d_{i}\\big(c_{1}d_{i}+h_{i}-y_{i}\\big)=0,\n$$\nwhich gives\n$$\nc_{1}\\sum_{i=1}^{3}d_{i}^{2}+\\sum_{i=1}^{3}d_{i}(h_{i}-y_{i})=0\n\\quad\\Longrightarrow\\quad\nc_{1}=\\frac{\\sum_{i=1}^{3}d_{i}(y_{i}-h_{i})}{\\sum_{i=1}^{3}d_{i}^{2}}.\n$$\nWith the data $(-1,\\tfrac{7}{2})$, $(0,\\tfrac{21}{10})$, and $(1,4)$, compute $d_{i}$ and $h_{i}$:\n- For $x=-1$: $d_{-1}=\\exp(-1)-\\exp(1)$, $h_{-1}=2\\exp(1)$.\n- For $x=0$: $d_{0}=0$, $h_{0}=2$.\n- For $x=1$: $d_{1}=\\exp(1)-\\exp(-1)$, $h_{1}=2\\exp(-1)$.\n\nLet $D=\\exp(1)-\\exp(-1)$. Then $d_{-1}=-D$, $d_{0}=0$, $d_{1}=D$, and\n$$\n\\sum_{i=1}^{3}d_{i}^{2}=D^{2}+0+D^{2}=2D^{2}.\n$$\nAlso,\n$$\n\\sum_{i=1}^{3}d_{i}(y_{i}-h_{i})\n=d_{-1}\\Big(\\tfrac{7}{2}-2\\exp(1)\\Big)+d_{1}\\Big(4-2\\exp(-1)\\Big)\n=D\\Big(-\\tfrac{7}{2}+2\\exp(1)+4-2\\exp(-1)\\Big)\n=D\\Big(\\tfrac{1}{2}+2D\\Big).\n$$\nTherefore,\n$$\nc_{1}=\\frac{D\\big(\\tfrac{1}{2}+2D\\big)}{2D^{2}}\n=\\frac{\\tfrac{1}{2}+2D}{2D}\n=1+\\frac{1}{4D}\n=1+\\frac{1}{4\\big(\\exp(1)-\\exp(-1)\\big)}.\n$$\nNow evaluate numerically (only at the final step, as required) and round to four significant figures:\n$$\nc_{1}\\approx 1+\\frac{1}{4\\big(\\exp(1)-\\exp(-1)\\big)}\\approx 1.1063647708\\;\\;\\Rightarrow\\;\\;1.106\\;\\text{(to four significant figures)}.\n$$", "answer": "$$\\boxed{1.106}$$", "id": "1362201"}, {"introduction": "A successful model fit is not just about finding coefficients; it's also about understanding the remaining error. This exercise focuses on the error vector, which represents the difference between the observed data and the model's predictions. Calculating this vector is the first step toward evaluating model performance and is fundamental to appreciating the geometric interpretation of least squares, where the error vector is orthogonal to the space spanned by the model's basis functions.[@problem_id:1362224]", "problem": "An engineer is modeling the relationship between the stress applied to a component, $x$, and its resulting deformation, $y$. Based on theoretical considerations, the expected relationship is of the form $y = c_0 + c_1 x^2$, where $c_0$ and $c_1$ are model parameters. To determine these parameters, four experimental measurements are taken, yielding the data points $(x_i, y_i)$:\n$$(0, 1), (1, 2), (2, 6), (3, 10)$$\nThe engineer decides to find the best-fit parameters $c_0$ and $c_1$ using the method of least squares. The error vector, $\\mathbf{e}$, is defined as the difference between the vector of observed values, $\\mathbf{y}$, and the vector of values predicted by the least-squares model, $\\mathbf{y}_{\\text{pred}}$.\n\nCalculate the four components of the error vector $\\mathbf{e}$, corresponding to the data points in the order they are given. Express each component as an exact fraction in its simplest form.", "solution": "The model is $y=c_{0}+c_{1}x^{2}$. With data points $(x_{i},y_{i})$ equal to $(0,1)$, $(1,2)$, $(2,6)$, $(3,10)$, define $z_{i}=x_{i}^{2}$ and the design matrix\n$$\nA=\\begin{pmatrix}\n1 & 0\\\\\n1 & 1\\\\\n1 & 4\\\\\n1 & 9\n\\end{pmatrix},\\qquad\n\\mathbf{y}=\\begin{pmatrix}\n1\\\\\n2\\\\\n6\\\\\n10\n\\end{pmatrix}.\n$$\nThe least-squares estimate $\\hat{\\mathbf{c}}=(c_{0},c_{1})^{T}$ satisfies the normal equations $(A^{T}A)\\hat{\\mathbf{c}}=A^{T}\\mathbf{y}$. Compute the components:\n$$\nA^{T}A=\\begin{pmatrix}\n\\sum 1 & \\sum z_{i}\\\\\n\\sum z_{i} & \\sum z_{i}^{2}\n\\end{pmatrix}\n=\\begin{pmatrix}\n4 & 14\\\\\n14 & 98\n\\end{pmatrix},\\qquad\nA^{T}\\mathbf{y}=\\begin{pmatrix}\n\\sum y_{i}\\\\\n\\sum z_{i}y_{i}\n\\end{pmatrix}\n=\\begin{pmatrix}\n19\\\\\n116\n\\end{pmatrix}.\n$$\nFor a symmetric $2\\times 2$ matrix $\\begin{pmatrix}a & b\\\\ b & d\\end{pmatrix}$, the inverse is $\\frac{1}{ad-b^{2}}\\begin{pmatrix}d & -b\\\\ -b & a\\end{pmatrix}$. Here, the determinant is\n$$\n\\det(A^{T}A)=4\\cdot 98-14^{2}=196.\n$$\nThus\n$$\n\\hat{\\mathbf{c}}=(A^{T}A)^{-1}A^{T}\\mathbf{y}\n=\\frac{1}{196}\\begin{pmatrix}\n98 & -14\\\\\n-14 & 4\n\\end{pmatrix}\\begin{pmatrix}\n19\\\\\n116\n\\end{pmatrix}\n=\\frac{1}{196}\\begin{pmatrix}\n98\\cdot 19-14\\cdot 116\\\\\n-14\\cdot 19+4\\cdot 116\n\\end{pmatrix}\n=\\begin{pmatrix}\n\\frac{17}{14} \\\\\n\\frac{99}{98}\n\\end{pmatrix}.\n$$\nTherefore the fitted model is $y_{\\text{pred}}= \\frac{17}{14}+\\frac{99}{98}x^{2}$. The error vector is $\\mathbf{e}=\\mathbf{y}-\\mathbf{y}_{\\text{pred}}$, whose components for $x=0,1,2,3$ are\n$$\ne_{1}=1-\\frac{17}{14}=-\\frac{3}{14},\\qquad\ne_{2}=2-\\left(\\frac{17}{14}+\\frac{99}{98}\\right)=-\\frac{11}{49},\n$$\n$$\ne_{3}=6-\\left(\\frac{17}{14}+4\\cdot\\frac{99}{98}\\right)=\\frac{73}{98},\\qquad\ne_{4}=10-\\left(\\frac{17}{14}+9\\cdot\\frac{99}{98}\\right)=-\\frac{15}{49}.\n$$\nThese satisfy the normal-equation orthogonality checks $\\sum e_{i}=0$ and $\\sum z_{i}e_{i}=0$, confirming consistency.", "answer": "$$\\boxed{\\begin{pmatrix}-\\frac{3}{14} & -\\frac{11}{49} & \\frac{73}{98} & -\\frac{15}{49}\\end{pmatrix}}$$", "id": "1362224"}]}