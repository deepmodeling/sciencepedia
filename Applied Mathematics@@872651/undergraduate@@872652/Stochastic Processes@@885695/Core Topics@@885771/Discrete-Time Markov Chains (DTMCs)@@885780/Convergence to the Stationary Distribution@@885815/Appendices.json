{"hands_on_practices": [{"introduction": "The first step in analyzing any Markov chain is to translate a descriptive scenario into a precise mathematical structure. This exercise provides a classic and intuitive setup—a rat in a maze—to practice this fundamental skill. By defining the states, constructing the transition probability matrix, and solving the system of balance equations, you will calculate your first stationary distribution and find the long-run proportion of time the system spends in a particular state [@problem_id:1293405].", "problem": "A behavioral study involves a rat in a T-shaped maze. The maze consists of a central 'stem', a 'left arm', and a 'right arm'. The rat's position is observed at discrete time steps. The rat's movement follows a set of probabilistic rules:\n\n- If the rat is in the stem, at the next time step it will move to the left arm with a probability of 0.5 or to the right arm with a probability of 0.5. It never stays in the stem for consecutive time steps.\n- If the rat is in the left arm, there is a probability of $p_L = 1/3$ that it will move to the stem at the next time step. Otherwise, it remains in the left arm.\n- If the rat is in the right arm, there is a probability of $p_R = 1/4$ that it will move to the stem at the next time step. Otherwise, it remains in the right arm.\n- The rat cannot move directly between the left and right arms.\n\nAssuming the experiment runs for a very long time, what is the long-run proportion of time the rat spends in the stem of the maze? Express your answer as a fraction.", "solution": "Model the rat’s location as a Markov chain with states $S$ (stem), $L$ (left arm), and $R$ (right arm). The one-step transition probabilities are:\n- From $S$: $P(S \\to L)=\\frac{1}{2}$, $P(S \\to R)=\\frac{1}{2}$, $P(S \\to S)=0$.\n- From $L$: $P(L \\to S)=\\frac{1}{3}$, $P(L \\to L)=\\frac{2}{3}$, $P(L \\to R)=0$.\n- From $R$: $P(R \\to S)=\\frac{1}{4}$, $P(R \\to R)=\\frac{3}{4}$, $P(R \\to L)=0$.\n\nThis chain is irreducible (all states communicate) and aperiodic (self-loops in $L$ and $R$), so it has a unique stationary distribution $\\pi=(\\pi_{S},\\pi_{L},\\pi_{R})$ giving the long-run proportions, satisfying $\\pi=\\pi P$ and $\\pi_{S}+\\pi_{L}+\\pi_{R}=1$.\n\nWrite the stationary equations:\n$$\n\\pi_{S}=(\\tfrac{1}{3})\\pi_{L}+(\\tfrac{1}{4})\\pi_{R},\\quad\n\\pi_{L}=(\\tfrac{1}{2})\\pi_{S}+(\\tfrac{2}{3})\\pi_{L},\\quad\n\\pi_{R}=(\\tfrac{1}{2})\\pi_{S}+(\\tfrac{3}{4})\\pi_{R}.\n$$\nFrom the second and third equations:\n$$\n\\pi_{L}-(\\tfrac{2}{3})\\pi_{L}=(\\tfrac{1}{2})\\pi_{S}\\;\\Rightarrow\\;(\\tfrac{1}{3})\\pi_{L}=(\\tfrac{1}{2})\\pi_{S}\\;\\Rightarrow\\;\\pi_{L}=\\tfrac{3}{2}\\pi_{S},\n$$\n$$\n\\pi_{R}-(\\tfrac{3}{4})\\pi_{R}=(\\tfrac{1}{2})\\pi_{S}\\;\\Rightarrow\\;(\\tfrac{1}{4})\\pi_{R}=(\\tfrac{1}{2})\\pi_{S}\\;\\Rightarrow\\;\\pi_{R}=2\\pi_{S}.\n$$\nUse normalization:\n$$\n\\pi_{S}+\\pi_{L}+\\pi_{R}=\\pi_{S}+(\\tfrac{3}{2})\\pi_{S}+2\\pi_{S}=\\tfrac{9}{2}\\pi_{S}=1\n\\;\\Rightarrow\\;\n\\pi_{S}=\\tfrac{2}{9}.\n$$\nTherefore, the long-run proportion of time in the stem is $\\frac{2}{9}$.", "answer": "$$\\boxed{\\frac{2}{9}}$$", "id": "1293405"}, {"introduction": "Real-world systems are often described by parameters that can change. Instead of calculating a single numerical outcome, it is more powerful to derive a general solution that shows how the system's long-term behavior depends on these parameters. This problem models a common scenario in reliability engineering—a system that can crash and be rebooted—and challenges you to find the stationary probability of being in the 'crashed' state as a symbolic expression [@problem_id:1293445]. This approach allows for a deeper analysis, enabling you to see how factors like crash rates ($p_A$, $p_B$) and reboot success ($r$) influence overall system stability.", "problem": "A legacy computer system runs a critical process in a continuous loop. The process consists of executing two functions, `FUNC_A` and `FUNC_B`, in strict alternation. The system's behavior can be modeled in discrete time steps, where each step corresponds to the completion of one function call.\n\nThe sequence of operations is as follows:\n- After successfully completing `FUNC_A`, the system immediately attempts to execute `FUNC_B`.\n- After successfully completing `FUNC_B`, the system immediately attempts to execute `FUNC_A`.\n\nHowever, due to unstable hardware, the system is prone to crashing.\n- After each execution of `FUNC_A`, there is a fixed probability $p_A$ that the system crashes instead of proceeding to `FUNC_B`.\n- Similarly, after each execution of `FUNC_B`, there is a fixed probability $p_B$ that the system crashes instead of proceeding to `FUNC_A`.\n\nAn automated monitoring service is in place to handle crashes. At each time step, if the system is in a crashed state, the service attempts a reboot. The reboot is successful with a probability $r$, in which case the system immediately starts its process loop again by executing `FUNC_A`. If the reboot attempt fails (with probability $1-r$), the system remains in the crashed state for that time step.\n\nAssume the system has been running for a very long time and has reached a steady state. Find an expression for the long-run probability that the system is in the crashed state. Your answer should be a symbolic expression in terms of $p_A$, $p_B$, and $r$.", "solution": "Model the system as a discrete-time Markov chain with three states representing what happens at the next time step:\n- $A$: the system executes $\\mathrm{FUNC\\_A}$,\n- $B$: the system executes $\\mathrm{FUNC\\_B}$,\n- $C$: the system is crashed (a reboot attempt occurs).\n\nFrom the description, the one-step transition probabilities are:\n- From $A$: to $C$ with probability $p_{A}$ (crash after $A$), to $B$ with probability $1 - p_{A}$.\n- From $B$: to $C$ with probability $p_{B}$ (crash after $B$), to $A$ with probability $1 - p_{B}$.\n- From $C$: to $A$ with probability $r$ (successful reboot), to $C$ with probability $1 - r$ (failed reboot).\n\nLet the stationary probabilities be $\\pi_{A}$, $\\pi_{B}$, and $\\pi_{C}$ for states $A$, $B$, and $C$, respectively. In steady state, they satisfy the balance equations and normalization:\n$$\n\\pi_{A} = \\pi_{B} (1 - p_{B}) + \\pi_{C} r,\n$$\n$$\n\\pi_{B} = \\pi_{A} (1 - p_{A}),\n$$\n$$\n\\pi_{C} = \\pi_{A} p_{A} + \\pi_{B} p_{B} + \\pi_{C} (1 - r),\n$$\n$$\n\\pi_{A} + \\pi_{B} + \\pi_{C} = 1.\n$$\nFrom $\\pi_{B} = \\pi_{A} (1 - p_{A})$, substitute into the $\\pi_{C}$ balance:\n$$\n\\pi_{C} r = \\pi_{A} p_{A} + \\pi_{B} p_{B} = \\pi_{A} p_{A} + \\pi_{A} (1 - p_{A}) p_{B} = \\pi_{A} \\left(p_{A} + p_{B} - p_{A} p_{B}\\right).\n$$\nHence\n$$\n\\pi_{A} = \\frac{\\pi_{C} r}{p_{A} + p_{B} - p_{A} p_{B}},\n\\quad\n\\pi_{B} = (1 - p_{A}) \\pi_{A} = (1 - p_{A}) \\frac{\\pi_{C} r}{p_{A} + p_{B} - p_{A} p_{B}}.\n$$\nUse normalization to solve for $\\pi_{C}$:\n$$\n1 = \\pi_{A} + \\pi_{B} + \\pi_{C}\n= \\frac{\\pi_{C} r}{p_{A} + p_{B} - p_{A} p_{B}} \\left[1 + (1 - p_{A})\\right] + \\pi_{C}\n= \\frac{\\pi_{C} r (2 - p_{A})}{p_{A} + p_{B} - p_{A} p_{B}} + \\pi_{C}.\n$$\nTherefore,\n$$\n\\pi_{C} \\left[1 + \\frac{r (2 - p_{A})}{p_{A} + p_{B} - p_{A} p_{B}}\\right] = 1,\n$$\nwhich yields\n$$\n\\pi_{C} = \\frac{p_{A} + p_{B} - p_{A} p_{B}}{p_{A} + p_{B} - p_{A} p_{B} + r (2 - p_{A})}.\n$$\nThis $\\pi_{C}$ is the long-run probability that the system is in the crashed state.", "answer": "$$\\boxed{\\frac{p_{A} + p_{B} - p_{A} p_{B}}{p_{A} + p_{B} - p_{A} p_{B} + r (2 - p_{A})}}$$", "id": "1293445"}, {"introduction": "Many important stochastic processes, especially in finance and physics, can be modeled as random walks on a set of integers. When the number of states is large, solving the full system of linear equations for the stationary distribution becomes computationally intensive. This advanced problem introduces a more elegant and scalable method for such cases, using the theory of difference equations to handle a random walk with complex boundary behaviors, including a cap and a reset mechanism [@problem_id:1293455]. Mastering this technique will equip you to analyze a much broader and more complex class of Markov chain models where the number of states is very large, satisfying $0  L  S  M$.", "problem": "A quantitative trading firm models its daily capital using a stochastic process. The firm's capital, denoted by $X_t$ on day $t$, can be represented by an integer. Each day, the capital changes by a fixed amount: it increases by 1 unit with probability $p$ or decreases by 1 unit with probability $q=1-p$, where $p \\neq q$.\n\nThe firm has two strict risk management protocols:\n1.  An upper capital limit is set at $M$. If the capital is $M$ and a profit occurs that would increase it, the excess is skimmed off, so the capital remains at $M$.\n2.  A lower capital threshold is set at $L$. If, at the end of any day, the capital is found to be at or below $L$, the firm's backers immediately inject funds to reset the capital to a predetermined level $S$ for the beginning of the next day. The parameters satisfy $0  L  S  M$.\n\nThe state of the system is observed at the beginning of each day, after any potential reset. Therefore, the possible capital levels form the set of integers $\\{L+1, L+2, \\dots, M\\}$. After a very long time, the system reaches a stationary distribution, where $\\pi_k$ is the probability of having capital $k$.\n\nFind the stationary probability, $\\pi_S$, that the firm's capital is at the reset level $S$. Express your answer as a closed-form analytic expression in terms of $L, S, M$, and the ratio $\\rho = p/q$.", "solution": "Let the states be the integers $k \\in \\{L+1,L+2,\\dots,M\\}$. The one-step transitions are:\n- For $L+1kM$: $P_{k,k+1}=p$ and $P_{k,k-1}=q$.\n- For $k=M$: $P_{M,M}=p$ and $P_{M,M-1}=q$ (reflection at $M$).\n- For $k=L+1$: $P_{L+1,L+2}=p$ and $P_{L+1,S}=q$ (reset to $S$ upon a downward move).\nLet $\\rho=p/q$ with $p \\neq q$.\n\nIn stationarity, for any $k$ with $k \\notin \\{L+1,S,M\\}$ the balance equation is\n$$\n\\pi_{k}=p\\pi_{k-1}+q\\pi_{k+1}.\n$$\nThe general solution of the homogeneous recurrence $q\\pi_{k+1}-\\pi_{k}+p\\pi_{k-1}=0$ is $\\pi_{k}=A+B\\rho^{k}$ on any contiguous segment where no inhomogeneous term appears.\n\nSplit the line at $S$:\n- Upper segment $k \\in \\{S+1,\\dots,M\\}$: write $\\pi_{k}=A_{u}+B_{u}\\rho^{k}$. Stationarity at $M$ gives $\\pi_{M}=p(\\pi_{M-1}+\\pi_{M})$, i.e., $\\pi_{M-1}p=\\pi_{M}q$, which forces zero current and hence $A_{u}=0$. Thus\n$$\n\\pi_{k}=C\\,\\rho^{k},\\quad k=S+1,\\dots,M,\n$$\nfor some constant $C$.\n- Lower segment $k \\in \\{L+1,\\dots,S-1\\}$: write $\\pi_{k}=A_{\\ell}+B_{\\ell}\\rho^{k}$. The boundary balance at $L+1$ is $\\pi_{L+1}=q\\pi_{L+2}$. Substituting gives\n$$\nA_{\\ell}+B_{\\ell}\\rho^{L+1}=q\\bigl(A_{\\ell}+B_{\\ell}\\rho^{L+2}\\bigr)\\;\\Rightarrow\\;pA_{\\ell}+qB_{\\ell}\\rho^{L+1}=0,\n$$\nso $A_{\\ell}=-(q/p)B_{\\ell}\\rho^{L+1}=-B_{\\ell}\\rho^{L}$. Therefore, for $L+1 \\le k \\le S-1$,\n$$\n\\pi_{k}=B_{\\ell}\\bigl(\\rho^{k}-\\rho^{L}\\bigr).\n$$\n\nAt the special state $S$, stationarity includes the reset inflow:\n$$\n\\pi_{S}=p\\pi_{S-1}+q\\pi_{S+1}+q\\pi_{L+1}.\n$$\nWith $\\pi_{S-1}=B_{\\ell}(\\rho^{S-1}-\\rho^{L})$, $\\pi_{S+1}=C\\rho^{S+1}$, $\\pi_{L+1}=B_{\\ell}(\\rho^{L+1}-\\rho^{L})$, and using $q\\rho=p$, this simplifies to\n$$\n\\pi_{S}=q\\Bigl[B_{\\ell}\\bigl(\\rho^{S}-\\rho^{L}\\bigr)+C\\rho^{S+1}\\Bigr].\n$$\n\nNext, use stationarity at $S+1$:\n$$\n\\pi_{S+1}=p\\pi_{S}+q\\pi_{S+2}.\n$$\nWith $\\pi_{S+1}=C\\rho^{S+1}$ and $\\pi_{S+2}=C\\rho^{S+2}$, one gets\n$$\nC\\rho^{S+1}=p\\pi_{S}+qC\\rho^{S+2}=p\\pi_{S}+pC\\rho^{S+1},\n$$\nhence $C\\rho^{S+1}=\\rho\\,\\pi_{S}$ and thus $C=\\pi_{S}\\rho^{-S}$. Therefore, for $k \\ge S+1$,\n$$\n\\pi_{k}=\\pi_{S}\\rho^{k-S}.\n$$\n\nSubstitute $C\\rho^{S+1}=\\rho\\pi_{S}$ back into the $S$-equation to get\n$$\n\\pi_{S}=q\\Bigl[B_{\\ell}\\bigl(\\rho^{S}-\\rho^{L}\\bigr)+\\rho\\,\\pi_{S}\\Bigr]\\;\\Rightarrow\\;q\\pi_{S}=qB_{\\ell}\\bigl(\\rho^{S}-\\rho^{L}\\bigr),\n$$\nso\n$$\nB_{\\ell}=\\frac{\\pi_{S}}{\\rho^{S}-\\rho^{L}}.\n$$\nThus, for $L+1 \\le k \\le S-1$,\n$$\n\\pi_{k}=\\pi_{S}\\,\\frac{\\rho^{k}-\\rho^{L}}{\\rho^{S}-\\rho^{L}}.\n$$\n\nNow impose normalization:\n$$\n\\sum_{k=L+1}^{M}\\pi_{k}=1=\\sum_{k=L+1}^{S-1}\\pi_{k}+\\pi_{S}+\\sum_{k=S+1}^{M}\\pi_{k}.\n$$\nCompute the sums:\n$$\n\\sum_{k=S+1}^{M}\\pi_{k}=\\pi_{S}\\sum_{j=1}^{M-S}\\rho^{j}=\\pi_{S}\\,\\rho\\,\\frac{1-\\rho^{M-S}}{1-\\rho},\n$$\nand\n$$\n\\sum_{k=L+1}^{S-1}\\pi_{k}=\\pi_{S}\\,\\frac{1}{\\rho^{S}-\\rho^{L}}\\sum_{k=L+1}^{S-1}\\bigl(\\rho^{k}-\\rho^{L}\\bigr)\n=\\pi_{S}\\,\\frac{\\rho\\bigl(1-\\rho^{S-L-1}\\bigr)/(1-\\rho)-(S-L-1)}{\\rho^{S-L}-1}.\n$$\nLet $a=S-L$ and $b=M-S$. Then\n$$\n1=\\pi_{S}\\left[1+\\frac{\\rho\\bigl(1-\\rho^{b}\\bigr)}{1-\\rho}+\\frac{\\rho\\bigl(1-\\rho^{a-1}\\bigr)/(1-\\rho)-(a-1)}{\\rho^{a}-1}\\right].\n$$\nSolving for $\\pi_{S}$ and simplifying the bracket algebraically yields\n$$\n\\pi_{S}=\\frac{(1-\\rho)\\bigl(\\rho^{a}-1\\bigr)}{a(\\rho-1)+\\rho^{b+1}-\\rho^{a+b+1}}.\n$$\nEquivalently,\n$$\n\\pi_{S}=\\frac{(\\rho-1)\\bigl(\\rho^{a}-1\\bigr)}{\\rho^{b+1}\\bigl(\\rho^{a}-1\\bigr)-(\\rho-1)a}.\n$$\nSubstituting back $a=S-L$ and $b=M-S$ gives the required closed form:\n$$\n\\pi_{S}=\\frac{(\\rho-1)\\bigl(\\rho^{\\,S-L}-1\\bigr)}{\\rho^{\\,M-S+1}\\bigl(\\rho^{\\,S-L}-1\\bigr)-(\\rho-1)(S-L)}.\n$$\nThis holds for $\\rho \\neq 1$ (i.e., $p \\neq q$), as specified.", "answer": "$$\\boxed{\\frac{(\\rho-1)\\bigl(\\rho^{\\,S-L}-1\\bigr)}{\\rho^{\\,M-S+1}\\bigl(\\rho^{\\,S-L}-1\\bigr)-(\\rho-1)(S-L)}}$$", "id": "1293455"}]}