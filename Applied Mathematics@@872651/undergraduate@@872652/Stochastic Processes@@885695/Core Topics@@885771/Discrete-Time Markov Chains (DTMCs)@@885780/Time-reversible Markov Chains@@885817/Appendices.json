{"hands_on_practices": [{"introduction": "The cornerstone of time-reversibility is the set of detailed balance equations. This first practice provides a direct opportunity to apply this definition by checking if the condition $\\pi_i P_{ij} = \\pi_j P_{ji}$ holds for a given Markov chain model of a web server [@problem_id:1346316]. Successfully completing this exercise will solidify your understanding of the fundamental mathematical requirement for a process to be considered reversible.", "problem": "A simplified model for the operational state of a single web server is described by a discrete-time Markov chain with three states: State 1 (Idle), State 2 (Processing), and State 3 (Overloaded). The transitions between states are observed at fixed time intervals, and the one-step transition probability matrix, $P = (P_{ij})$, is given by:\n$$ P = \\begin{pmatrix} 0.5 & 0.5 & 0 \\\\ 0.2 & 0.6 & 0.2 \\\\ 0 & 0.7 & 0.3 \\end{pmatrix} $$\nwhere $P_{ij}$ is the probability of transitioning from state $i$ to state $j$.\n\nA systems engineering student proposes that the long-run behavior of the server can be described by a distribution $\\pi = (\\pi_1, \\pi_2, \\pi_3) = \\left(\\frac{1}{4}, \\frac{1}{2}, \\frac{1}{4}\\right)$.\n\nYour task is to determine if the Markov chain is time-reversible with respect to this proposed distribution $\\pi$. A Markov chain is time-reversible with respect to a distribution $\\pi$ if the detailed balance equations, $\\pi_i P_{ij} = \\pi_j P_{ji}$, hold for all pairs of states $i$ and $j$.\n\nWhich of the following statements is correct?\n\nA. The chain is time-reversible with respect to $\\pi$.\n\nB. The chain is not time-reversible, and the detailed balance equation is violated only for the pair of states (1, 2).\n\nC. The chain is not time-reversible, and the detailed balance equation is violated only for the pair of states (2, 3).\n\nD. The chain is not time-reversible, and the detailed balance equations are violated for both pairs of states (1, 2) and (2, 3).\n\nE. The proposed distribution $\\pi$ is not a stationary distribution, so the concept of time-reversibility with respect to it is not meaningful.", "solution": "A discrete-time Markov chain is time-reversible with respect to a distribution $\\pi$ if and only if the detailed balance equations hold for all pairs of states $i,j$:\n$$\n\\pi_{i}P_{ij}=\\pi_{j}P_{ji}.\n$$\nHere, $\\pi=\\left(\\frac{1}{4},\\frac{1}{2},\\frac{1}{4}\\right)$ and\n$$\nP=\\begin{pmatrix}\n0.5 & 0.5 & 0 \\\\\n0.2 & 0.6 & 0.2 \\\\\n0 & 0.7 & 0.3\n\\end{pmatrix}.\n$$\nWe check the detailed balance equations for the unordered pairs $(1,2)$, $(2,3)$, and $(1,3)$.\n\nFor the pair $(1,2)$:\n$$\n\\pi_{1}P_{12}=\\frac{1}{4}\\cdot 0.5 = \\frac{1}{8},\\qquad \\pi_{2}P_{21}=\\frac{1}{2}\\cdot 0.2 = \\frac{1}{10}.\n$$\nSince $\\frac{1}{8}\\neq\\frac{1}{10}$, the detailed balance equation is violated for $(1,2)$.\n\nFor the pair $(2,3)$:\n$$\n\\pi_{2}P_{23}=\\frac{1}{2}\\cdot 0.2 = \\frac{1}{10},\\qquad \\pi_{3}P_{32}=\\frac{1}{4}\\cdot 0.7 = \\frac{7}{40}.\n$$\nSince $\\frac{1}{10}\\neq\\frac{7}{40}$, the detailed balance equation is violated for $(2,3)$.\n\nFor the pair $(1,3)$:\n$$\n\\pi_{1}P_{13}=\\frac{1}{4}\\cdot 0=0,\\qquad \\pi_{3}P_{31}=\\frac{1}{4}\\cdot 0=0,\n$$\nso the detailed balance equation holds trivially for $(1,3)$.\n\nTherefore, the chain is not time-reversible with respect to $\\pi$, and the violations occur for both pairs $(1,2)$ and $(2,3)$. (Note: A quick check reveals that $\\pi$ is not the stationary distribution for this $P$, but the question of whether detailed balance holds with respect to a given $\\pi$ is still a valid mathematical question.)", "answer": "$$\\boxed{D}$$", "id": "1346316"}, {"introduction": "Beyond simple verification, the property of time-reversibility has powerful structural implications for the transition matrix. In this exercise, knowing that a molecular process is reversible allows us to reconstruct a partially known transition matrix [@problem_id:1346359]. This highlights how theoretical properties can be used in practical modeling scenarios to deduce unknown system parameters.", "problem": "A theoretical model for a single molecule describes its state by its location on one of three available binding sites on a surface. Let the sites be labeled by the set $S = \\{1, 2, 3\\}$. The molecule randomly jumps between these sites at discrete time steps, and this process is modeled as a time-homogeneous Markov chain. The one-step transition probability matrix is denoted by $P$, where the entry $P_{ij}$ is the probability of the molecule transitioning from site $i$ to site $j$.\n\nThe process is known to be time-reversible with respect to the uniform distribution over the three sites. The transition matrix $P$ has been partially determined from experimental data and is given as:\n$$\nP = \\begin{pmatrix}\na & 0.5 & c \\\\\nb & 0.2 & 0.3 \\\\\n0.1 & d & e\n\\end{pmatrix}\n$$\nwhere $a, b, c, d,$ and $e$ are unknown constants.\n\nDetermine the values of the five unknown entries. Express your answer as a row matrix containing the values of $a, b, c, d,$ and $e$ in that specific alphabetical order.", "solution": "The problem requires us to find the unknown entries in the transition matrix $P$ of a Markov chain. We are given two key pieces of information: the chain is time-reversible with respect to the uniform distribution, and $P$ is a valid transition matrix.\n\nFirst, let's use the property of time-reversibility. A Markov chain with a stationary distribution $\\pi = (\\pi_1, \\pi_2, \\ldots)$ and transition matrix $P$ is time-reversible if it satisfies the detailed balance equations:\n$$\n\\pi_i P_{ij} = \\pi_j P_{ji} \\quad \\text{for all states } i, j.\n$$\nIn this problem, the state space is $S = \\{1, 2, 3\\}$, and the chain is reversible with respect to the uniform distribution. The uniform distribution on three states is given by $\\pi_i = \\frac{1}{3}$ for $i=1, 2, 3$.\n\nSubstituting $\\pi_i = \\pi_j = \\frac{1}{3}$ into the detailed balance equation, we get:\n$$\n\\frac{1}{3} P_{ij} = \\frac{1}{3} P_{ji}\n$$\nThis simplifies to:\n$$\nP_{ij} = P_{ji}\n$$\nThis result means that the transition matrix $P$ must be symmetric.\n\nThe given matrix is:\n$$\nP = \\begin{pmatrix}\na & 0.5 & c \\\\\nb & 0.2 & 0.3 \\\\\n0.1 & d & e\n\\end{pmatrix}\n$$\nApplying the symmetry condition ($P=P^T$), we can equate the off-diagonal elements:\n1.  $P_{21} = P_{12} \\implies b = 0.5$\n2.  $P_{31} = P_{13} \\implies 0.1 = c$\n3.  $P_{32} = P_{23} \\implies d = 0.3$\n\nSo, we have found the values for $b, c,$ and $d$. Now we can update the matrix $P$ with these values:\n$$\nP = \\begin{pmatrix}\na & 0.5 & 0.1 \\\\\n0.5 & 0.2 & 0.3 \\\\\n0.1 & 0.3 & e\n\\end{pmatrix}\n$$\nNext, we use the fundamental property of any stochastic (or transition) matrix: the sum of the probabilities in each row must be equal to 1.\n$$\n\\sum_{j} P_{ij} = 1 \\quad \\text{for all } i.\n$$\nLet's apply this condition to the rows containing the remaining unknowns, $a$ and $e$.\n\nFor the first row ($i=1$):\n$$\nP_{11} + P_{12} + P_{13} = 1\n$$\n$$\na + 0.5 + 0.1 = 1\n$$\n$$\na + 0.6 = 1\n$$\n$$\na = 0.4\n$$\n\nFor the third row ($i=3$):\n$$\nP_{31} + P_{32} + P_{33} = 1\n$$\n$$\n0.1 + 0.3 + e = 1\n$$\n$$\n0.4 + e = 1\n$$\n$$\ne = 0.6\n$$\n\nAs a check, we can verify that the second row also sums to 1:\n$P_{21} + P_{22} + P_{23} = 0.5 + 0.2 + 0.3 = 1.0$. The matrix is consistent.\n\nThe values of the unknowns are:\n$a = 0.4$\n$b = 0.5$\n$c = 0.1$\n$d = 0.3$\n$e = 0.6$\n\nThe problem asks for the answer as a row matrix with the values in the order $a, b, c, d, e$.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.4 & 0.5 & 0.1 & 0.3 & 0.6\n\\end{pmatrix}\n}\n$$", "id": "1346359"}, {"introduction": "This final practice demonstrates one of the most elegant applications of time-reversibility: finding the stationary distribution of a system without solving the full set of global balance equations. For a random walk on a weighted graph, we can propose a solution based on local information and use the detailed balance equations to quickly verify it [@problem_id:1346362]. This powerful technique is a cornerstone of analysis for many systems in physics and computer science.", "problem": "A new autonomous maintenance robot is being tested in a factory. The robot operates between three specific workstations, labeled 1, 2, and 3, which are connected in a triangular network. At any given time, the robot is located at one of these workstations. At each discrete time step, the robot moves from its current workstation to one of the two adjacent workstations.\n\nThe paths between the workstations have different levels of priority, quantified by positive, constant weights. The path between workstation 1 and 2 has weight $w_{12}$, the path between workstation 2 and 3 has weight $w_{23}$, and the path between workstation 3 and 1 has weight $w_{31}$. When the robot is at a station, its choice of the next station is probabilistic and proportional to the weight of the connecting path. For example, from station 1, the robot can move to station 2 or 3. The probability of moving to station 2 is given by $\\frac{w_{12}}{w_{12} + w_{31}}$, and the probability of moving to station 3 is $\\frac{w_{31}}{w_{12} + w_{31}}$. The same logic applies to movements from stations 2 and 3.\n\nAfter running for a long period, the system reaches a steady state where the probability of finding the robot at any given workstation becomes constant. Determine the stationary distribution $\\pi = (\\pi_1, \\pi_2, \\pi_3)$, where $\\pi_i$ is the long-term probability of finding the robot at workstation $i$. Express your answer in terms of the weights $w_{12}$, $w_{23}$, and $w_{31}$. The final answer should be presented as a row matrix $(\\pi_1 \\ \\ \\pi_2 \\ \\ \\pi_3)$.", "solution": "Let the Markov chain have state space $\\{1,2,3\\}$ and transition probabilities defined by the given weighted edges:\n$$\nP_{12}=\\frac{w_{12}}{w_{12}+w_{31}},\\quad P_{13}=\\frac{w_{31}}{w_{12}+w_{31}},\\quad P_{21}=\\frac{w_{12}}{w_{12}+w_{23}},\\quad P_{23}=\\frac{w_{23}}{w_{12}+w_{23}},\\quad P_{31}=\\frac{w_{31}}{w_{31}+w_{23}},\\quad P_{32}=\\frac{w_{23}}{w_{31}+w_{23}}.\n$$\nAll other $P_{ii}=0$ and non-adjacent transitions are zero.\n\nFor a random walk on a weighted undirected graph, the process is time-reversible and its stationary distribution $\\pi_i$ is proportional to the sum of the weights of the edges connected to node $i$. Let's define this weighted degree for each node:\n$$\nd_{1}=w_{12}+w_{31},\\quad d_{2}=w_{12}+w_{23},\\quad d_{3}=w_{23}+w_{31}.\n$$\nLet the stationary distribution be $\\pi_i = \\frac{d_i}{C}$, where $C$ is a normalization constant. We can verify that this satisfies the detailed balance equations, $\\pi_i P_{ij} = \\pi_j P_{ji}$:\n$$\n\\pi_{i}P_{ij} = \\frac{d_i}{C} \\cdot \\frac{w_{ij}}{d_i} = \\frac{w_{ij}}{C}\n$$\n$$\n\\pi_{j}P_{ji} = \\frac{d_j}{C} \\cdot \\frac{w_{ji}}{d_j} = \\frac{w_{ji}}{C}\n$$\nSince $w_{ij} = w_{ji}$, detailed balance holds. Thus, $\\pi_i \\propto d_i$ is the correct form for the stationary distribution.\n\nTo find the normalization constant $C$, we enforce the condition $\\sum_i \\pi_i = 1$:\n$$\nC = \\sum_{i=1}^3 d_i = d_1 + d_2 + d_3 = (w_{12}+w_{31}) + (w_{12}+w_{23}) + (w_{23}+w_{31}) = 2(w_{12}+w_{23}+w_{31}).\n$$\nTherefore, the stationary probabilities are:\n$$\n\\pi_{1}=\\frac{d_1}{C} = \\frac{w_{12}+w_{31}}{2(w_{12}+w_{23}+w_{31})}\n$$\n$$\n\\pi_{2}=\\frac{d_2}{C} = \\frac{w_{12}+w_{23}}{2(w_{12}+w_{23}+w_{31})}\n$$\n$$\n\\pi_{3}=\\frac{d_3}{C} = \\frac{w_{23}+w_{31}}{2(w_{12}+w_{23}+w_{31})}\n$$\nThis yields the stationary distribution as the requested row matrix.", "answer": "$$\\boxed{\\begin{pmatrix}\\frac{w_{12}+w_{31}}{2\\left(w_{12}+w_{23}+w_{31}\\right)} & \\frac{w_{12}+w_{23}}{2\\left(w_{12}+w_{23}+w_{31}\\right)} & \\frac{w_{23}+w_{31}}{2\\left(w_{12}+w_{23}+w_{31}\\right)}\\end{pmatrix}}$$", "id": "1346362"}]}