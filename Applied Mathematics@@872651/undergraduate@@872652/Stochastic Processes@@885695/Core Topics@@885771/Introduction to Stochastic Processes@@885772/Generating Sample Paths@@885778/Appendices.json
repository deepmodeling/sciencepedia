{"hands_on_practices": [{"introduction": "The simple random walk is the cornerstone of stochastic processes, providing a foundational model for everything from stock market fluctuations to the diffusion of molecules. Before we can analyze the long-term behavior of such processes, we must first understand how to construct a single realization, or \"sample path.\" This first exercise provides a concrete, step-by-step guide to generating a path for a random walk on a two-dimensional grid, translating a sequence of random outcomes into a physical trajectory. [@problem_id:1304666]", "problem": "A particle performs a simple symmetric random walk on the two-dimensional integer lattice, denoted by $\\mathbb{Z}^2$. The walk starts at the origin, $(0,0)$. At each discrete time step, the particle moves from its current position $(x,y)$ to one of its four nearest neighbors: $(x, y+1)$, $(x, y-1)$, $(x+1, y)$, or $(x-1, y)$.\n\nThe direction of each step is determined by a generated random integer from the set $\\{1, 2, 3, 4\\}$. The mapping from the integer to the displacement vector is as follows:\n- 1: a move in the positive y-direction (up), corresponding to a displacement of $(0, 1)$.\n- 2: a move in the positive x-direction (right), corresponding to a displacement of $(1, 0)$.\n- 3: a move in the negative y-direction (down), corresponding to a displacement of $(0, -1)$.\n- 4: a move in the negative x-direction (left), corresponding to a displacement of $(-1, 0)$.\n\nConsider a specific sample path consisting of 10 steps, which corresponds to the following sequence of generated integers:\n$\\{2, 1, 2, 4, 1, 3, 2, 1, 4, 2\\}$\n\nDetermine the final coordinates $(x_f, y_f)$ of the particle after these 10 steps.", "solution": "Let the walk start at $(x_{0}, y_{0}) = (0, 0)$. At each step $k$, the displacement $d_{k}$ is determined by $s_{k} \\in \\{1,2,3,4\\}$ by the mapping\n$$\n1 \\mapsto (0,1),\\quad 2 \\mapsto (1,0),\\quad 3 \\mapsto (0,-1),\\quad 4 \\mapsto (-1,0).\n$$\nThe final coordinates after $N=10$ steps are given by vector addition of displacements:\n$$\n(x_{f}, y_{f}) = (x_{0}, y_{0}) + \\sum_{k=1}^{10} d_{k}.\n$$\nEquivalently, count moves in each cardinal direction. Let $n_{R}$, $n_{L}$, $n_{U}$, $n_{D}$ denote the numbers of right, left, up, and down moves, respectively. Then\n$$\nx_{f} = x_{0} + n_{R} - n_{L}, \\qquad y_{f} = y_{0} + n_{U} - n_{D}.\n$$\nFrom the sequence $\\{2, 1, 2, 4, 1, 3, 2, 1, 4, 2\\}$, the counts are\n$$\nn_{R} = 4 \\text{ (entries }2), \\quad n_{L} = 2 \\text{ (entries }4), \\quad n_{U} = 3 \\text{ (entries }1), \\quad n_{D} = 1 \\text{ (entries }3).\n$$\nSubstituting and using $(x_{0}, y_{0})=(0,0)$,\n$$\nx_{f} = 0 + 4 - 2 = 2, \\qquad y_{f} = 0 + 3 - 1 = 2.\n$$\nTherefore, the final coordinates are $(2, 2)$.", "answer": "$$\\boxed{\\begin{pmatrix}2 & 2\\end{pmatrix}}$$", "id": "1304666"}, {"introduction": "While many processes unfold in unbounded spaces, real-world systems are often constrained by boundaries. This practice introduces a random walk on a finite set of states, incorporating rules that mimic physical limits: a \"partially reflecting\" boundary that pushes the process back and an \"absorbing\" boundary that traps it. By tracing the frog's journey on the lily pads, you will gain hands-on experience in simulating a discrete-time Markov chain, where the rules of movement change depending on the current state. [@problem_id:1304675]", "problem": "A frog performs a random walk on a set of five lily pads, arranged in a straight line and labeled $1, 2, 3, 4, 5$. The position of the frog at time step $n$ (where $n=0, 1, 2, \\dots$) is a discrete-time stochastic process denoted by $X_n$, which takes values in the state space $S = \\{1, 2, 3, 4, 5\\}$.\n\nThe frog's movement is governed by the following rules:\n- The frog starts at lily pad 2, so its initial position is $X_0 = 2$.\n- At each time step $n \\geq 1$, a random number $u_n$ is drawn from a uniform distribution on the interval $[0,1]$. The frog's next position $X_n$ depends on its current position $X_{n-1}$ and the value of $u_n$.\n- If the frog is on an interior lily pad, i.e., $X_{n-1} = i \\in \\{2, 3, 4\\}$, it jumps to pad $i-1$ if $u_n < 0.5$, and to pad $i+1$ if $u_n \\geq 0.5$.\n- Lily pad 1 acts as a partially reflecting boundary. If the frog is on pad 1 ($X_{n-1}=1$), an attempted jump to the left (which would be triggered by $u_n < 0.5$) results in it staying on pad 1. A jump to the right (triggered by $u_n \\geq 0.5$) moves it to pad 2.\n- Lily pad 5 is an absorbing state. If the frog reaches pad 5 ($X_{n-1}=5$), it remains there for all subsequent time steps, i.e., $X_n = 5$ for all future $n$.\n\nA specific experiment is conducted, and the following sequence of eight random numbers is generated for the first eight time steps:\n$u_1=0.63, u_2=0.24, u_3=0.78, u_4=0.91, u_5=0.04, u_6=0.55, u_7=0.31, u_8=0.82$.\n\nUsing this sequence of random numbers, determine the position of the frog at time step $n=8$. Your answer should be the integer index of the lily pad.", "solution": "We model the frog’s motion as a discrete-time Markov process on the state space $S=\\{1,2,3,4,5\\}$ with the given transition rules. For interior states $i\\in\\{2,3,4\\}$ at time $n-1$, the next state is\n$$\nX_{n}=\\begin{cases}\ni-1, & \\text{if } u_{n}<0.5,\\\\\ni+1, & \\text{if } u_{n}\\geq 0.5.\n\\end{cases}\n$$\nFor the boundary state $1$,\n$$\nX_{n}=\\begin{cases}\n1, & \\text{if } u_{n}<0.5,\\\\\n2, & \\text{if } u_{n}\\geq 0.5,\n\\end{cases}\n$$\nand state $5$ is absorbing, so if $X_{n-1}=5$ then $X_{n}=5$.\n\nStarting at $X_{0}=2$ and using the provided sequence $u_{1}=0.63, u_{2}=0.24, u_{3}=0.78, u_{4}=0.91, u_{5}=0.04, u_{6}=0.55, u_{7}=0.31, u_{8}=0.82$, we apply the rule at each step:\n\n1. At $n=1$, $X_{0}=2$ is interior and $u_{1}=0.63\\geq 0.5$, so $X_{1}=3$.\n2. At $n=2$, $X_{1}=3$ is interior and $u_{2}=0.24<0.5$, so $X_{2}=2$.\n3. At $n=3$, $X_{2}=2$ is interior and $u_{3}=0.78\\geq 0.5$, so $X_{3}=3$.\n4. At $n=4$, $X_{3}=3$ is interior and $u_{4}=0.91\\geq 0.5$, so $X_{4}=4$.\n5. At $n=5$, $X_{4}=4$ is interior and $u_{5}=0.04<0.5$, so $X_{5}=3$.\n6. At $n=6$, $X_{5}=3$ is interior and $u_{6}=0.55\\geq 0.5$, so $X_{6}=4$.\n7. At $n=7$, $X_{6}=4$ is interior and $u_{7}=0.31<0.5$, so $X_{7}=3$.\n8. At $n=8$, $X_{7}=3$ is interior and $u_{8}=0.82\\geq 0.5$, so $X_{8}=4$.\n\nState $5$ is never reached in these steps, so the absorbing boundary is not invoked. Therefore, the frog’s position at time step $n=8$ is $4$.", "answer": "$$\\boxed{4}$$", "id": "1304675"}, {"introduction": "We now move to a more complex and applied model from population biology: the Galton-Watson branching process with immigration. Here, the size of the next generation depends on the reproductive outcomes of all individuals in the current generation, plus the arrival of new individuals from an external source. This exercise challenges you to track a population's size over several generations by combining multiple sources of randomness, illustrating how sophisticated stochastic models are built and simulated in practice. [@problem_id:1304687]", "problem": "Consider a stochastic model for a specialized cell population that evolves in discrete generations. The population's size, $X_n$, at generation $n$ is described by a Galton-Watson branching process with an added immigration component. The evolution of the population from one generation to the next is given by the recursive formula:\n$$X_{n+1} = \\left( \\sum_{i=1}^{X_n} Z_{n,i} \\right) + Y_{n+1} \\quad \\text{for } n \\ge 0$$\nwhere $X_n$ is the population size at generation $n$, $Z_{n,i}$ is the number of offspring produced by the $i$-th individual of generation $n$, and $Y_{n+1}$ is the number of new immigrant cells that join the population at the beginning of generation $n+1$.\n\nThe number of offspring, $Z$, produced by any single cell is an independent and identically distributed random variable with the probability mass function: $P(Z=0) = 0.5$, $P(Z=1) = 0.3$, and $P(Z=2) = 0.2$. All other outcomes for $Z$ have zero probability. The number of new immigrants, $Y$, arriving at the beginning of each generation is an independent random variable following a Poisson distribution with a mean rate parameter of $\\lambda = 2.1$.\n\nThe process starts with an initial population of $X_0 = 3$ cells.\n\nTo analyze a specific realization of this process, you are provided with pre-determined outcomes for the random variables. The number of offspring produced by each cell, ordered first by generation and then by an arbitrary indexing of cells within that generation, is given by the sequence:\n$O = \\{1, 2, 0, 1, 1, 0, 2, 0, 1, 0, 2, 1, 1, 0, 1, ...\\}$.\nThe number of immigrants arriving at the beginning of generations 1, 2, and 3, respectively, is given by the sequence:\n$I = \\{2, 3, 1\\}$.\n\nYou must use the values from these sequences in the order they are provided to determine the population trajectory. Calculate the population sizes for the first three generations, $X_1$, $X_2$, and $X_3$. Provide your answer as a sequence of these three integer values.", "solution": "We use the Galton-Watson process with immigration:\n$$X_{n+1}=\\left(\\sum_{i=1}^{X_{n}} Z_{n,i}\\right)+Y_{n+1},\\quad n\\geq 0,$$\nwith $X_{0}=3$. The specific sample path is determined by consuming the offspring sequence $O$ and immigration sequence $I$ in order, generation by generation.\n\nFrom generation $0$ to $1$: we need $X_{0}=3$ offspring values, which are the first three entries of $O$: $1,2,0$. The immigration into generation $1$ is $Y_{1}=2$ (first entry of $I$). Thus\n$$X_{1}=(1+2+0)+2=5.$$\n\nFrom generation $1$ to $2$: we need $X_{1}=5$ offspring values, which are the next five entries of $O$: $1,1,0,2,0$. The immigration into generation $2$ is $Y_{2}=3$ (second entry of $I$). Thus\n$$X_{2}=(1+1+0+2+0)+3=4+3=7.$$\n\nFrom generation $2$ to $3$: we need $X_{2}=7$ offspring values, which are the next seven entries of $O$: $1,0,2,1,1,0,1$. The immigration into generation $3$ is $Y_{3}=1$ (third entry of $I$). Thus\n$$X_{3}=(1+0+2+1+1+0+1)+1=6+1=7.$$\n\nTherefore, the first three generations are $X_{1}=5$, $X_{2}=7$, and $X_{3}=7$.", "answer": "$$\\boxed{\\begin{pmatrix}5 & 7 & 7\\end{pmatrix}}$$", "id": "1304687"}]}