{"hands_on_practices": [{"introduction": "A fundamental aspect of any dynamic system is the time it spends in a particular state before changing. This exercise explores the concept of holding time in a continuous-time Markov chain. By analyzing a relatable scenario of a ride-sharing driver, you will practice calculating the expected duration in a given state, a key metric determined by the sum of all outgoing transition rates. [@problem_id:1347554]", "problem": "A driver for a ride-sharing service can be in one of three states: 'Available' ($S_1$), 'Driving to a passenger' ($S_2$), or 'On a trip' ($S_3$). The transitions between these states are modeled as a continuous-time Markov process with constant transition rates.\n\nWhen the driver is in the 'Available' state ($S_1$), they can receive two types of requests. A standard request transitions them to the 'Driving to a passenger' state ($S_2$) with a rate of $\\lambda_{12} = 2.4$ requests per hour. An immediate pickup request, for a passenger at their current location, transitions them directly to the 'On a trip' state ($S_3$) with a rate of $\\lambda_{13} = 0.8$ requests per hour.\n\nOther transitions in the system are as follows: From state $S_2$, a passenger cancellation can occur, returning the driver to state $S_1$ with a rate of $\\lambda_{21} = 0.7$ per hour. Alternatively, the driver can successfully pick up the passenger, transitioning to state $S_3$ with a rate of $\\lambda_{23} = 11.5$ per hour. Upon completing a trip in state $S_3$, the driver returns to the 'Available' state $S_1$ with a rate of $\\lambda_{31} = 2.9$ per hour.\n\nAssuming the driver has just become 'Available', what is the expected amount of time they will remain in this 'Available' state before transitioning to another state? Express your answer in minutes, rounded to three significant figures.", "solution": "Let $T_1$ be the random variable representing the time the driver spends in the 'Available' state ($S_1$) during a single visit. In a continuous-time Markov process, the holding time in any state $i$ follows an exponential distribution. The rate parameter of this distribution, let's call it $q_i$, is the sum of the rates of all possible transitions out of state $i$.\n\nIn this problem, we are interested in the expected holding time in state $S_1$. The total rate of leaving state $S_1$, denoted as $q_1$, is the sum of the rates of all transitions originating from $S_1$. Based on the problem description, there are two ways for the driver to leave the 'Available' state:\n1. Transition to state $S_2$ ('Driving to a passenger') with rate $\\lambda_{12}$.\n2. Transition to state $S_3$ ('On a trip') with rate $\\lambda_{13}$.\n\nThe rates for transitions out of other states (e.g., $\\lambda_{21}$, $\\lambda_{23}$, $\\lambda_{31}$) are not relevant for calculating the holding time in state $S_1$.\n\nThe total exit rate from state $S_1$ is the sum of the rates of these two transitions:\n$$q_1 = \\lambda_{12} + \\lambda_{13}$$\nSubstituting the given values:\n$$q_1 = 2.4 \\text{ hr}^{-1} + 0.8 \\text{ hr}^{-1} = 3.2 \\text{ hr}^{-1}$$\nThe holding time $T_1$ is thus exponentially distributed with rate parameter $q_1 = 3.2 \\text{ hr}^{-1}$.\n\nThe expected value (mean) of an exponential random variable with rate parameter $\\lambda$ is given by $E[T] = \\frac{1}{\\lambda}$.\nTherefore, the expected time the driver remains in the 'Available' state is:\n$$E[T_1] = \\frac{1}{q_1} = \\frac{1}{3.2 \\text{ hr}^{-1}} = \\frac{1}{3.2} \\text{ hours}$$\nThe problem asks for the answer in minutes. We must convert the units from hours to minutes:\n$$E[T_1] \\text{ in minutes} = \\left(\\frac{1}{3.2} \\text{ hours}\\right) \\times \\left(\\frac{60 \\text{ minutes}}{1 \\text{ hour}}\\right)$$\nNow we calculate the numerical value:\n$$E[T_1] = \\frac{60}{3.2} = \\frac{600}{32} = \\frac{300}{16} = \\frac{150}{8} = \\frac{75}{4} = 18.75 \\text{ minutes}$$\nFinally, we need to round the result to three significant figures as requested. The first three significant figures are 1, 8, and 7. The next digit is 5, which means we round up the last significant digit.\n$$18.75 \\approx 18.8$$\nSo, the expected time the driver remains in the 'Available' state is 18.8 minutes.", "answer": "$$\\boxed{18.8}$$", "id": "1347554"}, {"introduction": "While understanding individual state dynamics is important, a complete picture requires a map of the entire system's behavior. This practice focuses on constructing the generator matrix, or $Q$-matrix, which serves as the blueprint for a continuous-time Markov chain. You will learn to translate a descriptive model of a logistics network into this essential mathematical object, a crucial step for any further analysis of the system's evolution. [@problem_id:1347534]", "problem": "A modern logistics company models the journey of a package using a continuous-time Markov chain. The state of a package can be one of four possibilities:\n- State 1: `Processing` (at the initial warehouse)\n- State 2: `In Transit` (on its way to the recipient)\n- State 3: `Delivered` (successfully received by the customer)\n- State 4: `Awaiting Return` (delivery failed, pending return to the warehouse)\n\nThe package transitions between these states according to the following rules and constant rates:\n- A package that is `Processing` is sent out and becomes `In Transit` at a rate of $\\alpha$.\n- A package that is `In Transit` is successfully `Delivered` at a rate of $\\beta$.\n- A package that is `In Transit` can also fail delivery and become `Awaiting Return` at a rate of $\\gamma$.\n- A package that is `Awaiting Return` is sent back to the warehouse for reprocessing, re-entering the `Processing` state at a rate of $\\delta$.\n- Once a package is `Delivered`, it is considered an absorbing state, meaning it remains `Delivered` forever.\n- No other transitions are possible.\n\nGiven this model, identify the correct generator matrix $Q$ for this process, where the states are ordered as (1: `Processing`, 2: `In Transit`, 3: `Delivered`, 4: `Awaiting Return`).\n\nWhich of the following matrices represents $Q$?\n\nA.\n$$\n\\begin{pmatrix}\n-\\alpha & \\alpha & 0 & 0 \\\\\n0 & -(\\beta+\\gamma) & \\beta & \\gamma \\\\\n0 & 0 & 0 & 0 \\\\\n\\delta & 0 & 0 & -\\delta\n\\end{pmatrix}\n$$\n\nB.\n$$\n\\begin{pmatrix}\n-\\alpha & \\alpha & 0 & 0 \\\\\n0 & -\\beta & \\beta & \\gamma \\\\\n0 & 0 & 0 & 0 \\\\\n\\delta & 0 & 0 & -\\delta\n\\end{pmatrix}\n$$\n\nC.\n$$\n\\begin{pmatrix}\n1-\\alpha & \\alpha & 0 & 0 \\\\\n0 & 1-\\beta-\\gamma & \\beta & \\gamma \\\\\n0 & 0 & 1 & 0 \\\\\n\\delta & 0 & 0 & 1-\\delta\n\\end{pmatrix}\n$$\n\nD.\n$$\n\\begin{pmatrix}\n-\\alpha & \\alpha & 0 & \\delta \\\\\n0 & -(\\beta+\\gamma) & \\beta & 0 \\\\\n0 & \\gamma & 0 & 0 \\\\\n0 & 0 & 0 & -\\delta\n\\end{pmatrix}\n$$\n\nE.\n$$\n\\begin{pmatrix}\n-\\alpha & \\alpha & 0 & 0 \\\\\n\\delta & -(\\beta+\\gamma) & \\beta & \\gamma \\\\\n0 & 0 & 0 & 0 \\\\\n0 & 0 & 0 & -\\delta\n\\end{pmatrix}\n$$", "solution": "For a continuous-time Markov chain, the generator matrix $Q$ satisfies the following properties:\n- For $i \\neq j$, $q_{ij} \\geq 0$ represents the transition rate from state $i$ to state $j$.\n- For each state $i$, the diagonal entry is $q_{ii} = -\\sum_{j \\neq i} q_{ij}$ so that each row sums to zero.\n- If a state is absorbing, then its entire row is zero.\n\nFrom the problem description with states ordered as $(1,2,3,4)$ corresponding to (Processing, In Transit, Delivered, Awaiting Return), the allowed transitions and rates are:\n- From state $1$ to state $2$ at rate $\\alpha$, and no other transitions out of state $1$. Hence,\n$$\nq_{12}=\\alpha,\\quad q_{11}=-\\alpha,\\quad q_{13}=0,\\quad q_{14}=0.\n$$\n- From state $2$ to state $3$ at rate $\\beta$ and to state $4$ at rate $\\gamma$, and no other transitions out of state $2$. Hence,\n$$\nq_{23}=\\beta,\\quad q_{24}=\\gamma,\\quad q_{21}=0,\\quad q_{22}=-(\\beta+\\gamma).\n$$\n- State $3$ (Delivered) is absorbing. Hence,\n$$\nq_{3j}=0\\ \\text{for all } j,\\quad \\text{so } q_{33}=0.\n$$\n- From state $4$ to state $1$ at rate $\\delta$, and no other transitions out of state $4$. Hence,\n$$\nq_{41}=\\delta,\\quad q_{44}=-\\delta,\\quad q_{42}=0,\\quad q_{43}=0.\n$$\n\nCollecting these entries, the generator matrix is\n$$\nQ=\\begin{pmatrix}\n-\\alpha & \\alpha & 0 & 0 \\\\\n0 & -(\\beta+\\gamma) & \\beta & \\gamma \\\\\n0 & 0 & 0 & 0 \\\\\n\\delta & 0 & 0 & -\\delta\n\\end{pmatrix}.\n$$\nThis matches option A. Options B, C, D, and E violate generator matrix properties or include forbidden transitions: B has an incorrect diagonal in row $2$; C is a discrete-time transition matrix form; D and E include non-permitted transitions or omit required ones.", "answer": "$$\\boxed{A}$$", "id": "1347534"}, {"introduction": "In many scientific and engineering contexts, the transition rates that govern a process are not known with certainty and must be estimated from observations. This exercise shifts our perspective from prediction to inference, demonstrating how to update our knowledge of a rate based on experimental data. Using a Bayesian framework, you will see how observing a hypothetical quantum system can refine an initial estimate of its transition rate, a powerful technique for connecting theoretical models to empirical evidence. [@problem_id:1347520]", "problem": "A research team is studying the stability of a novel quantum dot, which can spontaneously transition from an excited state to its ground state by emitting a photon. The team models the transition rate, $\\lambda$, as a random variable because its precise value is unknown. Based on theoretical models of similar materials, their prior belief about $\\lambda$ is described by a Gamma distribution with a shape parameter $\\alpha > 0$ and a rate parameter $\\beta > 0$. The probability density function for this prior is given by:\n$$ p(\\lambda | \\alpha, \\beta) = \\frac{\\beta^{\\alpha}}{\\Gamma(\\alpha)} \\lambda^{\\alpha-1} \\exp(-\\beta \\lambda) \\quad \\text{for } \\lambda > 0 $$\nwhere $\\Gamma(\\cdot)$ is the Gamma function.\n\nThe team conducts an experiment where they prepare the quantum dot in the excited state and observe it for a total duration of $T$. During this time, they detect exactly $k$ spontaneous transitions. The number of such transitions in a given time interval is assumed to follow a Poisson process, where the probability of observing $k$ events in time $T$ for a given rate $\\lambda$ is:\n$$ P(\\text{data} | \\lambda) = \\frac{(\\lambda T)^{k}}{k!} \\exp(-\\lambda T) $$\n\nAfter incorporating the experimental observation, the team's updated belief about $\\lambda$ is described by a new Gamma distribution, the posterior distribution. This posterior is characterized by an updated shape parameter $\\alpha'$ and an updated rate parameter $\\beta'$.\n\nDetermine the expressions for the posterior parameters $\\alpha'$ and $\\beta'$ in terms of the prior parameters $\\alpha, \\beta$ and the experimental data $k, T$.", "solution": "We begin with the prior density for the rate parameter $\\lambda$ under a Gamma distribution with shape $\\alpha$ and rate $\\beta$:\n$$\np(\\lambda \\mid \\alpha,\\beta)=\\frac{\\beta^{\\alpha}}{\\Gamma(\\alpha)}\\lambda^{\\alpha-1}\\exp(-\\beta \\lambda), \\quad \\lambda>0.\n$$\nThe likelihood of observing $k$ events in time $T$ given $\\lambda$ under a Poisson process is\n$$\nP(k \\mid \\lambda,T)=\\frac{(\\lambda T)^{k}}{k!}\\exp(-\\lambda T).\n$$\nBy Bayes' rule, the posterior density is proportional to the product of the likelihood and the prior:\n$$\np(\\lambda \\mid k,T,\\alpha,\\beta)\\propto P(k \\mid \\lambda,T)\\,p(\\lambda \\mid \\alpha,\\beta).\n$$\nSubstituting the expressions and grouping factors that depend on $\\lambda$, we obtain\n$$\np(\\lambda \\mid k,T,\\alpha,\\beta)\\propto \\left[\\frac{(\\lambda T)^{k}}{k!}\\exp(-\\lambda T)\\right]\\left[\\frac{\\beta^{\\alpha}}{\\Gamma(\\alpha)}\\lambda^{\\alpha-1}\\exp(-\\beta \\lambda)\\right].\n$$\nConstants with respect to $\\lambda$ can be absorbed into the normalizing constant, leaving\n$$\np(\\lambda \\mid k,T,\\alpha,\\beta)\\propto \\lambda^{k}\\exp(-\\lambda T)\\,\\lambda^{\\alpha-1}\\exp(-\\beta \\lambda)=\\lambda^{\\alpha+k-1}\\exp\\big(-( \\beta+T)\\lambda\\big).\n$$\nRecognizing the kernel of a Gamma density with shape parameter $\\alpha+k$ and rate parameter $\\beta+T$, the normalized posterior is\n$$\np(\\lambda \\mid k,T,\\alpha,\\beta)=\\frac{(\\beta+T)^{\\alpha+k}}{\\Gamma(\\alpha+k)}\\lambda^{\\alpha+k-1}\\exp\\big(-(\\beta+T)\\lambda\\big),\n$$\nwhich is $\\text{Gamma}(\\alpha+k,\\beta+T)$. Therefore, the updated parameters are\n$$\n\\alpha'=\\alpha+k, \\quad \\beta'=\\beta+T.\n$$", "answer": "$$\\boxed{\\begin{pmatrix}\\alpha + k & \\beta + T\\end{pmatrix}}$$", "id": "1347520"}]}