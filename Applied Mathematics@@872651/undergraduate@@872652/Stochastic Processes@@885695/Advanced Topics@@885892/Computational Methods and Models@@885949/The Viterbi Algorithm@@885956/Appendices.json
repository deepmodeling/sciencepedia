{"hands_on_practices": [{"introduction": "To truly understand the Viterbi algorithm, we must walk through its calculations. This first practice provides a classic scenario involving weather prediction, allowing you to apply the core steps of the algorithm—initialization, recursion, and backtracking—to uncover the most probable sequence of hidden atmospheric states from a series of observations. This exercise will solidify your grasp of the fundamental mechanics of a Hidden Markov Model (HMM) and the Viterbi path-finding process [@problem_id:1664280].", "problem": "A simplified meteorological model describes the daily weather using a Hidden Markov Model (HMM). The weather on any given day is determined by an unobservable, or \"hidden,\" atmospheric pressure state, which can be either 'High-Pressure' (H) or 'Low-Pressure' (L). The observable weather condition can be 'Sunny' (S), 'Cloudy' (C), or 'Rainy' (R).\n\nThe model is defined by the following probabilities:\n\n**1. Initial State Probabilities (for Day 1):**\n*   The probability that Day 1 begins in a High-Pressure state is $0.6$.\n*   The probability that Day 1 begins in a Low-Pressure state is $0.4$.\n\n**2. State Transition Probabilities (from one day to the next):**\n*   Probability of transitioning from High-Pressure to High-Pressure: $0.7$\n*   Probability of transitioning from High-Pressure to Low-Pressure: $0.3$\n*   Probability of transitioning from Low-Pressure to Low-Pressure: $0.6$\n*   Probability of transitioning from Low-Pressure to High-Pressure: $0.4$\n\n**3. Emission Probabilities (probability of an observed weather condition given the hidden pressure state):**\n*   Given a High-Pressure state:\n    *   Probability of 'Sunny': $0.8$\n    *   Probability of 'Cloudy': $0.15$\n    *   Probability of 'Rainy': $0.05$\n*   Given a Low-Pressure state:\n    *   Probability of 'Sunny': $0.1$\n    *   Probability of 'Cloudy': $0.4$\n    *   Probability of 'Rainy': $0.5$\n\nAn observer records the following sequence of weather conditions over three consecutive days: Day 1: 'Sunny', Day 2: 'Cloudy', Day 3: 'Rainy'.\n\nBased on this observed sequence and the model parameters, determine the most likely sequence of hidden atmospheric pressure states for these three days.\n\nA. H-H-H\n\nB. H-H-L\n\nC. H-L-L\n\nD. L-H-L\n\nE. L-L-H\n\nF. L-L-L", "solution": "We model the hidden atmospheric pressure states as $H$ and $L$, and the observed sequence over three days is $S, C, R$. Using the Viterbi algorithm, define\n$$\n\\delta_{t}(i)=\\max_{q_{1},\\dots,q_{t-1}} P(q_{1},\\dots,q_{t}=i, O_{1},\\dots,O_{t}),\n$$\nwith initial probabilities $\\pi_{H}=0.6$, $\\pi_{L}=0.4$, transition probabilities $a_{HH}=0.7$, $a_{HL}=0.3$, $a_{LL}=0.6$, $a_{LH}=0.4$, and emission probabilities $b_{H}(S)=0.8$, $b_{H}(C)=0.15$, $b_{H}(R)=0.05$, $b_{L}(S)=0.1$, $b_{L}(C)=0.4$, $b_{L}(R)=0.5$.\n\nInitialization for $t=1$ with $O_{1}=S$:\n$$\n\\delta_{1}(H)=\\pi_{H} b_{H}(S)=0.6\\cdot 0.8=0.48,\\qquad \\delta_{1}(L)=\\pi_{L} b_{L}(S)=0.4\\cdot 0.1=0.04.\n$$\n\nRecursion for $t=2$ with $O_{2}=C$:\n$$\n\\delta_{2}(H)=\\max\\{\\delta_{1}(H)a_{HH},\\,\\delta_{1}(L)a_{LH}\\}\\,b_{H}(C)=\\max\\{0.48\\cdot 0.7,\\,0.04\\cdot 0.4\\}\\cdot 0.15=0.336\\cdot 0.15=0.0504,\n$$\nso the backpointer is from $H$. Similarly,\n$$\n\\delta_{2}(L)=\\max\\{\\delta_{1}(H)a_{HL},\\,\\delta_{1}(L)a_{LL}\\}\\,b_{L}(C)=\\max\\{0.48\\cdot 0.3,\\,0.04\\cdot 0.6\\}\\cdot 0.4=0.144\\cdot 0.4=0.0576,\n$$\nso the backpointer is from $H$.\n\nRecursion for $t=3$ with $O_{3}=R$:\n$$\n\\delta_{3}(H)=\\max\\{\\delta_{2}(H)a_{HH},\\,\\delta_{2}(L)a_{LH}\\}\\,b_{H}(R)=\\max\\{0.0504\\cdot 0.7,\\,0.0576\\cdot 0.4\\}\\cdot 0.05=0.03528\\cdot 0.05=0.001764,\n$$\nso the backpointer is from $H$. Also,\n$$\n\\delta_{3}(L)=\\max\\{\\delta_{2}(H)a_{HL},\\,\\delta_{2}(L)a_{LL}\\}\\,b_{L}(R)=\\max\\{0.0504\\cdot 0.3,\\,0.0576\\cdot 0.6\\}\\cdot 0.5=0.03456\\cdot 0.5=0.01728,\n$$\nso the backpointer is from $L$.\n\nTermination selects the final state by maximizing $\\delta_{3}$:\n$$\n\\delta_{3}(L)=0.01728>\\delta_{3}(H)=0.001764,\n$$\nthus the most likely final state is $L$. Backtracking using the stored backpointers yields the sequence $q_{3}=L$, $q_{2}=L$, $q_{1}=H$, i.e., $H$-$L$-$L$, which corresponds to option C.", "answer": "$$\\boxed{C}$$", "id": "1664280"}, {"introduction": "While the Viterbi algorithm is designed to find the single \"best\" path, what happens when two or more paths are equally likely? This exercise explores the important case of a tie in path probabilities, demonstrating that the most likely sequence is not always unique. Completing this problem will highlight the need for precision in your calculations and deepen your understanding of how the algorithm evaluates and compares different state sequences [@problem_id:1664321].", "problem": "Consider a system modeled by a Hidden Markov Model (HMM). The system can be in one of two hidden states, denoted as $S_1$ and $S_2$. At each discrete time step, the system emits an observable output, which can be either $A$ or $B$.\n\nThe parameters of this HMM are defined as follows:\n\n1.  **Initial State Probabilities**: The system is known to start in state $S_1$ at time $t=1$. Therefore, the initial probability of being in state $S_1$ is 1.0, and the initial probability of being in state $S_2$ is 0.0.\n\n2.  **State Transition Probabilities**:\n    - The probability of transitioning from state $S_1$ to itself is $P(S_1 | S_1) = 0.6$.\n    - The probability of transitioning from state $S_1$ to state $S_2$ is $P(S_2 | S_1) = 0.4$.\n    - The probability of transitioning from state $S_2$ to state $S_1$ is $P(S_1 | S_2) = 0.5$.\n    - The probability of transitioning from state $S_2$ to itself is $P(S_2 | S_2) = 0.5$.\n\n3.  **Emission Probabilities**:\n    - The probability of emitting output $A$ from state $S_1$ is $P(A | S_1) = 0.8$.\n    - The probability of emitting output $B$ from state $S_1$ is $P(B | S_1) = 0.2$.\n    - The probability of emitting output $A$ from state $S_2$ is $P(A | S_2) = 0.7$.\n    - The probability of emitting output $B$ from state $S_2$ is $P(B | S_2) = 0.3$.\n\nSuppose the following sequence of outputs is observed over two time steps: $(A, B)$.\n\nUsing the Viterbi algorithm, determine the sequence or sequences of hidden states that are most likely to have produced this observation sequence. Select the correct option from the choices below.\n\nA. The two most likely sequences are $(S_1, S_1)$ and $(S_2, S_1)$.\n\nB. The two most likely sequences are $(S_2, S_2)$ and $(S_1, S_2)$.\n\nC. The two most likely sequences are $(S_1, S_1)$ and $(S_1, S_2)$.\n\nD. Only one most probable path exists: $(S_1, S_2)$.\n\nE. Only one most probable path exists: $(S_1, S_1)$.", "solution": "We have a two-state HMM with states $S_{1}$ and $S_{2}$ and observation sequence $(A,B)$. The initial distribution is deterministic: $P(q_{1}=S_{1})=1$ and $P(q_{1}=S_{2})=0$. Transition probabilities are $a_{11}=P(S_{1}\\mid S_{1})=0.6$, $a_{12}=P(S_{2}\\mid S_{1})=0.4$, $a_{21}=P(S_{1}\\mid S_{2})=0.5$, $a_{22}=P(S_{2}\\mid S_{2})=0.5$. Emission probabilities are $b_{1}(A)=P(A\\mid S_{1})=0.8$, $b_{1}(B)=P(B\\mid S_{1})=0.2$, $b_{2}(A)=P(A\\mid S_{2})=0.7$, $b_{2}(B)=P(B\\mid S_{2})=0.3$.\n\nUsing the Viterbi algorithm, define the recursion\n$$\n\\delta_{t}(j)=\\max_{i}\\bigl[\\delta_{t-1}(i)\\,a_{ij}\\bigr]\\;b_{j}(o_{t}),\\quad \\psi_{t}(j)=\\arg\\max_{i}\\bigl[\\delta_{t-1}(i)\\,a_{ij}\\bigr],\n$$\nwith initialization $\\delta_{1}(j)=\\pi_{j}\\,b_{j}(o_{1})$.\n\nInitialization at $t=1$ for $o_{1}=A$ gives\n$$\n\\delta_{1}(S_{1})=1\\cdot b_{1}(A)=0.8,\\qquad \\delta_{1}(S_{2})=0\\cdot b_{2}(A)=0.\n$$\n\nRecursion at $t=2$ for $o_{2}=B$:\n- For $S_{1}$,\n$$\n\\delta_{2}(S_{1})=\\max\\{\\,\\delta_{1}(S_{1})a_{11},\\,\\delta_{1}(S_{2})a_{21}\\,\\}\\,b_{1}(B)=\\max\\{0.8\\cdot 0.6,\\,0\\cdot 0.5\\}\\cdot 0.2=0.48\\cdot 0.2=0.096,\n$$\nso $\\psi_{2}(S_{1})=S_{1}$.\n- For $S_{2}$,\n$$\n\\delta_{2}(S_{2})=\\max\\{\\,\\delta_{1}(S_{1})a_{12},\\,\\delta_{1}(S_{2})a_{22}\\,\\}\\,b_{2}(B)=\\max\\{0.8\\cdot 0.4,\\,0\\cdot 0.5\\}\\cdot 0.3=0.32\\cdot 0.3=0.096,\n$$\nso $\\psi_{2}(S_{2})=S_{1}$.\n\nTermination chooses the ending state $q_{2}^{*}$ by maximizing $\\delta_{2}(j)$. Since $\\delta_{2}(S_{1})=\\delta_{2}(S_{2})=0.096$, there is a tie, hence two optimal end states and thus two optimal state sequences upon backtracking:\n- Ending at $S_{1}$: $(q_{1},q_{2})=(\\psi_{2}(S_{1}),S_{1})=(S_{1},S_{1})$.\n- Ending at $S_{2}$: $(q_{1},q_{2})=(\\psi_{2}(S_{2}),S_{2})=(S_{1},S_{2})$.\n\nEquivalently, the joint path-observation probabilities confirm the tie:\n$$\nP(S_{1},S_{1},A,B)=1\\cdot 0.8\\cdot 0.6\\cdot 0.2=0.096,\\qquad\nP(S_{1},S_{2},A,B)=1\\cdot 0.8\\cdot 0.4\\cdot 0.3=0.096,\n$$\nwhile any path starting in $S_{2}$ has probability $0$ due to the initial condition. Therefore, the two most likely sequences are $(S_{1},S_{1})$ and $(S_{1},S_{2})$, which corresponds to option C.", "answer": "$$\\boxed{C}$$", "id": "1664321"}, {"introduction": "The true power of an algorithm lies not just in its standard application, but in our ability to adapt it to new challenges. This advanced problem requires you to modify the Viterbi algorithm to handle a global constraint—a common requirement in specialized fields like safety analysis or bioinformatics. By augmenting the dynamic programming state representation to track an additional parameter, you will move beyond simple execution to algorithmic design, showcasing the flexibility of the Viterbi framework [@problem_id:1345434].", "problem": "A chemical reactor's condition is monitored using a simplified model based on a Hidden Markov Model (HMM). The reactor can be in one of three hidden states: $S_1$ (Low), $S_2$ (Medium), or $S_3$ (High). At each discrete time step, a sensor records the reactor's external temperature, which can be one of three observable states: $O_1$ (Cool), $O_2$ (Warm), or $O_3$ (Hot).\n\nThe HMM is defined by the following parameters:\n\n1.  **Initial State Probabilities ($\\pi$)**: The probabilities of the system starting in each state at time $t=1$.\n    $\\pi_1 = P(q_1=S_1) = 0.6$\n    $\\pi_2 = P(q_1=S_2) = 0.2$\n    $\\pi_3 = P(q_1=S_3) = 0.2$\n\n2.  **State Transition Probability Matrix ($A$)**: The matrix $A = [a_{ij}]$ where $a_{ij} = P(q_{t+1}=S_j | q_t=S_i)$ is the probability of transitioning from state $S_i$ to state $S_j$.\n    $$\n    A = \\begin{pmatrix}\n    0.7 & 0.2 & 0.1 \\\\\n    0.3 & 0.4 & 0.3 \\\\\n    0.1 & 0.3 & 0.6\n    \\end{pmatrix}\n    $$\n\n3.  **Emission Probability Matrix ($B$)**: The matrix $B = [b_j(k)]$ where $b_j(k) = P(v_t=O_k | q_t=S_j)$ is the probability of observing $O_k$ when the system is in state $S_j$.\n    $$\n    B = \\begin{pmatrix}\n    0.80 & 0.15 & 0.05 \\\\\n    0.20 & 0.60 & 0.20 \\\\\n    0.05 & 0.15 & 0.80\n    \\end{pmatrix}\n    $$\n    Here, rows correspond to hidden states ($S_1, S_2, S_3$) and columns correspond to observations ($O_1, O_2, O_3$). For example, $b_1(2) = P(v_t=O_2|q_t=S_1) = 0.15$.\n\nA sequence of $T=4$ observations has been recorded: $V = (O_1, O_2, O_2, O_3)$, which corresponds to (Cool, Warm, Warm, Hot). For a safety analysis, it is necessary to determine the most probable sequence of hidden states that could have generated this observation sequence, subject to the global constraint that the reactor must have been in the `Medium` state ($S_2$) for exactly $k=2$ time steps.\n\nCalculate the probability of this single most probable state sequence. Round your final answer to four significant figures.", "solution": "The problem asks for the probability of the most likely hidden state sequence given an observation sequence, under a global constraint on the number of times a specific state appears. The standard Viterbi algorithm finds the most probable path but cannot handle such global constraints. We must modify the dynamic programming approach by augmenting the state definition.\n\nLet the hidden states be $\\{S_1, S_2, S_3\\}$ and the observation sequence be $V = (v_1, v_2, v_3, v_4)$, where $v_1=O_1, v_2=O_2, v_3=O_2, v_4=O_3$. The special state is $S_2$, and the constraint is that it must appear exactly $k=2$ times in the path of length $T=4$.\n\nWe define a new dynamic programming variable, $\\delta_t(j, m)$, as the maximum probability of any path of length $t$ that ends in state $S_j$, generates the first $t$ observations $v_1, ..., v_t$, and contains exactly $m$ occurrences of the special state $S_2$.\n\nThe recursion is structured as follows:\n\n**1. Initialization (t=1):**\nThe observation is $v_1=O_1$.\nThe count $m$ is 1 if the state is $S_2$, and 0 otherwise.\n$\\delta_1(j, m) = \\pi_j \\cdot b_j(v_1)$\n- For $j=1$ (state $S_1$, not special), $m=0$:\n$\\delta_1(1, 0) = \\pi_1 \\cdot b_1(O_1) = 0.6 \\cdot 0.8 = 0.48$\n- For $j=2$ (state $S_2$, special), $m=1$:\n$\\delta_1(2, 1) = \\pi_2 \\cdot b_2(O_1) = 0.2 \\cdot 0.2 = 0.04$\n- For $j=3$ (state $S_3$, not special), $m=0$:\n$\\delta_1(3, 0) = \\pi_3 \\cdot b_3(O_1) = 0.2 \\cdot 0.05 = 0.01$\nAll other $\\delta_1(j, m)$ values are zero.\n\n**2. Recursion (t=2, 3, 4):**\nFor $t > 1$, we compute $\\delta_t(j, m)$ based on the values at $t-1$.\nThe count of special states $m$ either increments or stays the same.\n- If the current state $S_j$ is **not** the special state $S_2$ (i.e., $j=1$ or $j=3$): The count $m$ does not change from the previous step.\n$$ \\delta_t(j, m) = b_j(v_t) \\cdot \\max_{i=1,2,3} \\left[ \\delta_{t-1}(i, m) \\cdot a_{ij} \\right] $$\n- If the current state $S_j$ **is** the special state $S_2$ (i.e., $j=2$): The count $m$ must have been $m-1$ at the previous step.\n$$ \\delta_t(2, m) = b_2(v_t) \\cdot \\max_{i=1,2,3} \\left[ \\delta_{t-1}(i, m-1) \\cdot a_{i2} \\right] $$\n\nLet's compute the table step by step.\n\n**Time t=2 (Observation $v_2=O_2$):**\n- $\\delta_2(1, m=0)$: (Not special) $b_1(O_2)=0.15$. Comes from $m=0$ at $t=1$.\n$\\delta_2(1, 0) = 0.15 \\cdot \\max[\\delta_1(1,0)a_{11}, \\delta_1(3,0)a_{31}] = 0.15 \\cdot \\max[0.48 \\cdot 0.7, 0.01 \\cdot 0.1] = 0.15 \\cdot 0.336 = 0.0504$\n- $\\delta_2(1, m=1)$: (Not special) $b_1(O_2)=0.15$. Comes from $m=1$ at $t=1$.\n$\\delta_2(1, 1) = 0.15 \\cdot \\max[\\delta_1(2,1)a_{21}] = 0.15 \\cdot [0.04 \\cdot 0.3] = 0.0018$\n- $\\delta_2(2, m=1)$: (Special) $b_2(O_2)=0.6$. Comes from $m=0$ at $t=1$.\n$\\delta_2(2, 1) = 0.6 \\cdot \\max[\\delta_1(1,0)a_{12}, \\delta_1(3,0)a_{32}] = 0.6 \\cdot \\max[0.48 \\cdot 0.2, 0.01 \\cdot 0.3] = 0.6 \\cdot 0.096 = 0.0576$\n- $\\delta_2(2, m=2)$: (Special) $b_2(O_2)=0.6$. Comes from $m=1$ at $t=1$.\n$\\delta_2(2, 2) = 0.6 \\cdot \\max[\\delta_1(2,1)a_{22}] = 0.6 \\cdot [0.04 \\cdot 0.4] = 0.0096$\n- $\\delta_2(3, m=0)$: (Not special) $b_3(O_2)=0.15$. Comes from $m=0$ at $t=1$.\n$\\delta_2(3, 0) = 0.15 \\cdot \\max[\\delta_1(1,0)a_{13}, \\delta_1(3,0)a_{33}] = 0.15 \\cdot \\max[0.48 \\cdot 0.1, 0.01 \\cdot 0.6] = 0.15 \\cdot 0.048 = 0.0072$\n- $\\delta_2(3, m=1)$: (Not special) $b_3(O_2)=0.15$. Comes from $m=1$ at $t=1$.\n$\\delta_2(3, 1) = 0.15 \\cdot \\max[\\delta_1(2,1)a_{23}] = 0.15 \\cdot [0.04 \\cdot 0.3] = 0.0018$\n\n**Time t=3 (Observation $v_3=O_2$):**\n- $\\delta_3(1, m=1)$: (Not special, from $m=1$ at t=2) $b_1(O_2)=0.15$.\n$\\delta_3(1, 1) = 0.15 \\cdot \\max[\\delta_2(1,1)a_{11}, \\delta_2(2,1)a_{21}, \\delta_2(3,1)a_{31}] = 0.15 \\cdot \\max[0.0018 \\cdot 0.7, 0.0576 \\cdot 0.3, 0.0018 \\cdot 0.1] = 0.15 \\cdot \\max[0.00126, 0.01728, 0.00018] = 0.15 \\cdot 0.01728 = 0.002592$\n- $\\delta_3(1, m=2)$: (Not special, from $m=2$ at t=2) $b_1(O_2)=0.15$.\n$\\delta_3(1, 2) = 0.15 \\cdot \\max[\\delta_2(2,2)a_{21}] = 0.15 \\cdot [0.0096 \\cdot 0.3] = 0.000432$\n- $\\delta_3(2, m=1)$: (Special, from $m=0$ at t=2) $b_2(O_2)=0.6$.\n$\\delta_3(2, 1) = 0.6 \\cdot \\max[\\delta_2(1,0)a_{12}, \\delta_2(3,0)a_{32}] = 0.6 \\cdot \\max[0.0504 \\cdot 0.2, 0.0072 \\cdot 0.3] = 0.6 \\cdot 0.01008 = 0.006048$\n- $\\delta_3(2, m=2)$: (Special, from $m=1$ at t=2) $b_2(O_2)=0.6$.\n$\\delta_3(2, 2) = 0.6 \\cdot \\max[\\delta_2(1,1)a_{12}, \\delta_2(2,1)a_{22}, \\delta_2(3,1)a_{32}] = 0.6 \\cdot \\max[0.0018 \\cdot 0.2, 0.0576 \\cdot 0.4, 0.0018 \\cdot 0.3] = 0.6 \\cdot \\max[0.00036, 0.02304, 0.00054] = 0.6 \\cdot 0.02304 = 0.013824$\n- $\\delta_3(3, m=1)$: (Not special, from $m=1$ at t=2) $b_3(O_2)=0.15$.\n$\\delta_3(3, 1) = 0.15 \\cdot \\max[\\delta_2(1,1)a_{13}, \\delta_2(2,1)a_{23}, \\delta_2(3,1)a_{33}] = 0.15 \\cdot \\max[0.0018 \\cdot 0.1, 0.0576 \\cdot 0.3, 0.0018 \\cdot 0.6] = 0.15 \\cdot 0.01728 = 0.002592$\n- $\\delta_3(3, m=2)$: (Not special, from $m=2$ at t=2) $b_3(O_2)=0.15$.\n$\\delta_3(3, 2) = 0.15 \\cdot \\max[\\delta_2(2,2)a_{23}] = 0.15 \\cdot [0.0096 \\cdot 0.3] = 0.000432$\n(We also compute other values like $\\delta_3(j,0)$, $\\delta_3(j,3)$, but they are not needed for the final $k=2$ calculation.)\n\n**Time t=4 (Observation $v_4=O_3$):**\nWe are interested in paths with exactly $k=2$ occurrences of $S_2$. We only need to compute $\\delta_4(j, 2)$.\n\n- $\\delta_4(1, 2)$: (Not special, from $m=2$ at t=3) $b_1(O_3)=0.05$.\n$\\delta_4(1, 2) = 0.05 \\cdot \\max[\\delta_3(1,2)a_{11}, \\delta_3(2,2)a_{21}, \\delta_3(3,2)a_{31}] = 0.05 \\cdot \\max[0.000432 \\cdot 0.7, 0.013824 \\cdot 0.3, 0.000432 \\cdot 0.1] = 0.05 \\cdot \\max[0.0003024, 0.0041472, 0.0000432] = 0.05 \\cdot 0.0041472 = 0.00020736$\n\n- $\\delta_4(2, 2)$: (Special, from $m=1$ at t=3) $b_2(O_3)=0.2$.\n$\\delta_4(2, 2) = 0.2 \\cdot \\max[\\delta_3(1,1)a_{12}, \\delta_3(2,1)a_{22}, \\delta_3(3,1)a_{32}] = 0.2 \\cdot \\max[0.002592 \\cdot 0.2, 0.006048 \\cdot 0.4, 0.002592 \\cdot 0.3] = 0.2 \\cdot \\max[0.0005184, 0.0024192, 0.0007776] = 0.2 \\cdot 0.0024192 = 0.00048384$\n\n- $\\delta_4(3, 2)$: (Not special, from $m=2$ at t=3) $b_3(O_3)=0.8$.\n$\\delta_4(3, 2) = 0.8 \\cdot \\max[\\delta_3(1,2)a_{13}, \\delta_3(2,2)a_{23}, \\delta_3(3,2)a_{33}] = 0.8 \\cdot \\max[0.000432 \\cdot 0.1, 0.013824 \\cdot 0.3, 0.000432 \\cdot 0.6] = 0.8 \\cdot \\max[0.0000432, 0.0041472, 0.0002592] = 0.8 \\cdot 0.0041472 = 0.00331776$\n\n**3. Termination:**\nThe probability of the most likely path satisfying the constraint is the maximum of the probabilities of all paths of length $T=4$ that contain exactly $k=2$ special states.\n$P^* = \\max_{j=1,2,3} \\delta_4(j, k=2)$\n$P^* = \\max[\\delta_4(1, 2), \\delta_4(2, 2), \\delta_4(3, 2)]$\n$P^* = \\max[0.00020736, 0.00048384, 0.00331776] = 0.00331776$\n\nRounding to four significant figures, we get $0.003318$.\nIn scientific notation, this is $3.318 \\times 10^{-3}$.", "answer": "$$\\boxed{3.318 \\times 10^{-3}}$$", "id": "1345434"}]}