{"hands_on_practices": [{"introduction": "本次练习将Metropolis算法分解为其最基本的组成部分：接受或拒绝一个尝试性移动的决策过程。通过对像伊辛模型这样的简单系统进行这一核心计算，你将迈出使用蒙特卡洛方法模拟任何复杂系统的第一步。这个实践旨在阐明能量变化 $\\Delta E$ 和温度 $T$ 如何共同决定系统构型的演化 [@problem_id:1994839]。", "problem": "一个用于一维纳米线上磁信息存储的简化模型，考虑了一条由相互作用的磁矩（或称“自旋”）组成的链。我们将把这条纳米线的一个小片段建模为一个由 $N=5$ 个自旋排列成环的系统。每个自旋 $s_i$（其中 $i=1, 2, ..., 5$）可以是“上” ($s_i = +1$) 或“下” ($s_i = -1$)。一个特定自旋构型的总能量由一维周期性 Ising 模型哈密顿量给出：\n$$H = -J \\sum_{i=1}^{N} s_i s_{i+1}$$\n在此方程中，$J$ 是一个代表铁磁相互作用能的正常数，求和是针对最近邻对进行的。环状排列意味着周期性边界条件，即自旋 $s_5$ 是 $s_1$ 的近邻（形式上，$s_{N+1} = s_1$）。\n\n系统构型会随时间因热涨落而改变，这一过程可以使用 Metropolis Monte Carlo 算法进行模拟。在该算法中，通过随机选择一个自旋并提议将其翻转来生成一个试探移动。这个提议的新构型随后根据能量变化 $\\Delta E$ 和系统温度 $T$ 被接受或拒绝。接受该移动的概率由 Metropolis 判据给出：\n$$P_{\\text{accept}} = \\min\\left(1, \\exp\\left(-\\frac{\\Delta E}{k_B T}\\right)\\right)$$\n其中 $k_B$ 是 Boltzmann 常数。\n\n假设系统初始处于其能量最低的“基态”构型，即 $(s_1, s_2, s_3, s_4, s_5) = (+1, +1, +1, +1, +1)$。现提议一个 Monte Carlo 试探移动：翻转第三个自旋 $s_3$。系统维持在一个恒定温度下，使得热能与相互作用能的无量纲比率为 $k_B T / J = 2.0$。\n\n计算此特定试探移动的接受概率 $P_{\\text{accept}}$ 的数值。答案以无量纲量表示，并四舍五入到三位有效数字。", "solution": "一维周期性 Ising 模型的哈密顿量为\n$$\nH=-J\\sum_{i=1}^{N}s_{i}s_{i+1},\\quad s_{N+1}=s_{1}.\n$$\n在格点 $i$ 处的一次单自旋翻转只改变涉及 $s_i$ 的两个最近邻键合项，即 $(i-1,i)$ 和 $(i,i+1)$。将 $s_i$ 翻转为 $-s_i$ 的能量变化为\n$$\n\\Delta E=E_{\\text{after}}-E_{\\text{before}}=2J\\,s_{i}\\left(s_{i-1}+s_{i+1}\\right).\n$$\n初始构型为铁磁基态 $(+1,+1,+1,+1,+1)$。对于翻转 $s_3$ 的情况，我们有 $s_2=+1$，$s_3=+1$，$s_4=+1$，因此\n$$\n\\Delta E=2J\\,(+1)\\left((+1)+(+1)\\right)=4J.\n$$\n由于 $\\Delta E>0$，Metropolis 接受概率为\n$$\nP_{\\text{accept}}=\\min\\left(1,\\exp\\left(-\\frac{\\Delta E}{k_{B}T}\\right)\\right)=\\exp\\left(-\\frac{4J}{k_{B}T}\\right).\n$$\n使用给定的比率 $k_{B}T/J=2.0$，\n$$\n\\frac{4J}{k_{B}T}=\\frac{4}{2}=2,\n$$\n所以\n$$\nP_{\\text{accept}}=\\exp(-2).\n$$\n数值上，四舍五入到三位有效数字，结果是 $0.135$。", "answer": "$$\\boxed{0.135}$$", "id": "1994839"}, {"introduction": "在理解了单步Metropolis移动的机制后，一个自然而然的问题是：我们如何确保模拟能够高效地探索所有重要的构型？这个练习将探讨蒙特卡洛模拟中的一个关键实践问题——“步长”的选择，它直接影响着模拟的效率。通过这个练习，你将量化地理解为何通常建议将接受率调整到50%左右，而不是一个极高或极低的值 [@problem_id:1964962]。", "problem": "在计算统计力学中，Metropolis Monte Carlo (MC) 算法是在给定温度下探索系统构型空间的强大工具。这种探索的效率关键取决于尝试移动 (trial move) 的步长大小。\n\n考虑一个简化的一维 MC 模型，其中系统的状态由单一坐标描述。一次尝试移动包含一个随机位移，该位移的最大值由参数 $\\Delta$ 控制。该算法的行为可以通过一个无量纲的步长参数 $z$ 来表征，$z$ 与 $\\Delta$ 成正比。\n\n在该模型中，给出了两个关于 $z$ 的关键函数：\n1.  尝试移动的平均接受概率 $P(z)$ 由以下函数描述：\n    $$P(z) = \\frac{1 - \\exp(-z)}{z}$$\n2.  探索构型空间的效率 $\\mathcal{E}(z)$ 被发现与另一个函数 $f(z)$ 成正比：\n    $$\\mathcal{E}(z) \\propto f(z) = \\frac{2 - (z^2+2z+2)\\exp(-z)}{z}$$\n\n两位研究人员 A 和 B 正在使用此模型进行模拟。\n-   研究人员 A 将其步长调整到一个值 $z_A$，从而得到一个非常高的平均接受率 $P_A = 0.99$。\n-   研究人员 B 将其步长调整到一个值 $z_B$，从而得到一个平均接受率 $P_B = 0.50$。\n\n为简化计算，提供以下信息：\n-   对于 $P=0.50$ 的接受率，对应的无量纲步长为 $z_B \\approx 1.5936$。\n-   对于较小的 $z$ 值，这些函数可以由其主导项泰勒级数展开来精确近似：$P(z) \\approx 1 - \\frac{z}{2}$ 和 $f(z) \\approx \\frac{z^2}{3}$。\n\n通过比较两次模拟的探索效率，计算比率 $\\frac{\\mathcal{E}_B}{\\mathcal{E}_A}$。将你的最终答案四舍五入到三位有效数字。", "solution": "Metropolis MC 模型通过以下方式定义了平均接受概率和探索效率：\n$$P(z) = \\frac{1 - \\exp(-z)}{z}, \\qquad \\mathcal{E}(z) \\propto f(z) = \\frac{2 - (z^{2} + 2z + 2)\\exp(-z)}{z}.$$\n因此，研究人员 B 和 A 的效率之比为\n$$\\frac{\\mathcal{E}_{B}}{\\mathcal{E}_{A}} = \\frac{f(z_{B})}{f(z_{A})}.$$\n\n研究人员 A：对于较小的 $z$，给定的主导项展开式为 $P(z) \\approx 1 - \\frac{z}{2}$ 和 $f(z) \\approx \\frac{z^{2}}{3}$。对于 $P_{A} = 0.99$，设 $1 - \\frac{z_{A}}{2} \\approx 0.99$，可得\n$$z_{A} \\approx 2(1 - 0.99) = 0.02.$$\n则\n$$f(z_{A}) \\approx \\frac{z_{A}^{2}}{3} = \\frac{(0.02)^{2}}{3} = \\frac{0.0004}{3} = 1.333333\\ldots \\times 10^{-4}.$$\n\n研究人员 B：对于 $P_{B} = 0.50$，给定值为 $z_{B} \\approx 1.5936$。使用精确的 $f$ 函数，\n$$f(z_{B}) = \\frac{2 - (z_{B}^{2} + 2z_{B} + 2)\\exp(-z_{B})}{z_{B}}.$$\n计算 $z_{B} = 1.5936$ 时的各项：\n$$z_{B}^{2} = 2.53956096,\\quad z_{B}^{2} + 2z_{B} + 2 = 2.53956096 + 3.1872 + 2 = 7.72676096,$$\n$$\\exp(-z_{B}) = \\exp(-1.5936) \\approx 0.20319279056.$$\n因此\n$$(z_{B}^{2} + 2z_{B} + 2)\\exp(-z_{B}) \\approx 7.72676096 \\times 0.20319279056 \\approx 1.57002212145,$$\n所以分子为\n$$2 - 1.57002212145 \\approx 0.42997787855,$$\n因此\n$$f(z_{B}) \\approx \\frac{0.42997787855}{1.5936} \\approx 0.269815436.$$\n\n最后，效率之比为\n$$\\frac{\\mathcal{E}_{B}}{\\mathcal{E}_{A}} = \\frac{f(z_{B})}{f(z_{A})} \\approx \\frac{0.269815436}{1.333333\\ldots \\times 10^{-4}} \\approx 2.0236 \\times 10^{3}.$$\n四舍五入到三位有效数字，得到\n$$\\frac{\\mathcal{E}_{B}}{\\mathcal{E}_{A}} \\approx 2.02 \\times 10^{3}.$$", "answer": "$$\\boxed{2.02 \\times 10^{3}}$$", "id": "1964962"}, {"introduction": "掌握像蒙特卡洛这样强大的工具，也意味着要深刻理解其适用范围和局限性。本练习旨在挑战你对模拟中“时间”概念的理解，帮助你区分用于抽样的随机序列和描述真实物理过程的时间演化。理解这一根本区别对于为特定的科学问题选择正确的计算方法（例如蒙特卡洛或分子动力学）至关重要 [@problem_id:2451848]。", "problem": "一名学生在恒定$N$、恒定$V$、恒定$T$（NVT）系综中，对具有对势$U(\\mathbf{r}^N)$的简单流体，在固定温度$T$和数密度$\\rho$下，进行了一次标准的Metropolis蒙特卡罗（MC）模拟。他们建议通过将每个粒子的单次尝试MC移动视为一个固定的时间增量$\\Delta t$，计算均方位移$\\langle \\lvert \\mathbf{r}(t)-\\mathbf{r}(0)\\rvert^2\\rangle$作为MC步数的函数，然后应用爱因斯坦关系式来估算自扩散系数$D$\n$$\nD \\;=\\; \\lim_{t\\to\\infty} \\frac{\\langle \\lvert \\mathbf{r}(t)-\\mathbf{r}(0)\\rvert^2\\rangle}{2\\,d\\,t},\n$$\n其中$d$是空间维度。哪个陈述最能解释这种方法是否能得出一个有物理意义的$D$？\n\nA. 它不能，因为标准的Metropolis MC生成一个马尔可夫链，该链对平衡玻尔兹曼分布$p(\\mathbf{r}^N)\\propto \\exp(-\\beta U)$进行抽样，而不积分运动方程，所以MC步不对应于明确定义的物理时间，也没有计算速度；因此，通过时间关联定义的输运系数（例如，爱因斯坦或格林-久保关系式）需要真实的动力学，例如恒定$N$、恒定$V$、恒定$E$（NVE）的牛顿分子动力学。\n\nB. 它可以，前提是每次MC移动的单粒子位移幅度选择得足够小，这样一步MC就可以通过扩散方程映射到一个小的物理时间增量。\n\nC. 它无效仅仅是因为模拟使用了正则系综（NVT）；如果同样的Metropolis过程在微正则系综（恒定$N$、恒定$V$、恒定$E$）中执行，扩散系数将能被正确获得。\n\nD. 它无效，因为Metropolis MC中的细致平衡消除了所有净通量，使得从MC轨迹计算出的扩散系数恒为零。\n\nE. 它可以通过使用格林-久保关系式$D=\\frac{1}{d}\\int_0^\\infty \\langle \\mathbf{v}(0)\\cdot \\mathbf{v}(t)\\rangle \\, \\mathrm{d}t$并利用MC轨迹上位置的有限差分来估算速度，从而变得有效。", "solution": "必须首先验证问题陈述的科学合理性和清晰度。\n\n**步骤1：提取已知条件**\n- **模拟方法：** 标准Metropolis蒙特卡罗（MC）模拟。\n- **系综：** 恒定$N$、恒定$V$、恒定$T$（NVT），即正则系综。\n- **系统：** 具有对势$U(\\mathbf{r}^N)$的简单流体。\n- **固定状态变量：** 温度$T$和数密度$\\rho$。\n- **建议的计算方法：**\n    1. 将每个粒子的单次尝试MC移动与一个固定的时间增量$\\Delta t$关联起来。\n    2. 将均方位移（MSD）$\\langle \\lvert \\mathbf{r}(t)-\\mathbf{r}(0)\\rvert^2\\rangle$计算为MC步数的函数，其中MC步数代表时间$t$。\n    3. 使用爱因斯坦关系式计算自扩散系数$D$：\n       $$D = \\lim_{t\\to\\infty} \\frac{\\langle \\lvert \\mathbf{r}(t)-\\mathbf{r}(0)\\rvert^2\\rangle}{2\\,d\\,t}$$\n       其中$d$是空间维度。\n- **问题：** 评估这种方法对于获得有物理意义的自扩散系数$D$的有效性。\n\n**步骤2：使用提取的已知条件进行验证**\n- **科学基础：** 问题陈述具有科学基础。它涉及计算统计力学中的一个基本概念：随机抽样（蒙特卡罗）和时间演化（分子动力学）之间的区别。NVT系综、势能、均方位移以及扩散的爱因斯坦关系式等概念在物理学和化学中都是标准且定义明确的。\n- **问题的适定性：** 问题是适定（well-posed）的。它要求对一个具体、描述清晰的方法论进行批判性评估。问题是明确的，旨在寻求对所提方法有效或无效的解释。\n- **客观性：** 问题的陈述使用了精确、客观和技术性的语言。它不包含主观性论断。\n\n**步骤3：结论与行动**\n问题是有效的。它就计算科学中的一个标准课题提出了一个清晰、可回答的问题。开始进行解答。\n\n**原理推导**\n\n这个问题的核心在于蒙特卡罗算法生成的随机序列与通过积分运动方程生成的确定性时间演化轨迹之间的区别。\n\n在NVT系综中，标准的Metropolis蒙特卡罗模拟旨在实现一个特定目标：生成一个系统构型序列 $\\{\\mathbf{r}^N_1, \\mathbf{r}^N_2, \\ldots, \\mathbf{r}^N_M\\}$，使得在此序列中观察到任何给定构型$\\mathbf{r}^N$的概率与玻尔兹曼因子成正比，$P(\\mathbf{r}^N) \\propto \\exp(-\\beta U(\\mathbf{r}^N))$，其中 $\\beta = 1/(k_B T)$。这是通过构建一个满足细致平衡条件的马尔可夫链来实现的。这个链中的“步数”（从$1$到$M$索引）不代表物理时间的流逝。从构型$\\mathbf{r}^N_i$到$\\mathbf{r}^N_{i+1}$的转变是基于一个随机的试探性移动和一个接受概率，$p_{\\text{acc}} = \\min(1, \\exp(-\\beta \\Delta U))$。这个过程不涉及粒子的速度或动量，也不遵循物理运动定律（即牛顿第二定律，$\\mathbf{F} = m\\mathbf{a}$）。因此，这个构型序列是势能面上的一个“非物理”路径，其选择纯粹是为了有效地对平衡分布进行抽样。\n\n相比之下，像自扩散系数$D$这样的输运系数，本质上是系统*动力学*的属性。它们量化了实时发生的输运过程的速率。爱因斯坦关系式，\n$$D = \\lim_{t\\to\\infty} \\frac{\\langle \\lvert \\mathbf{r}(t)-\\mathbf{r}(0)\\rvert^2\\rangle}{2dt}$$\n是从在连续时间$t$中演化的扩散过程的物理学推导出来的。为了从模拟中计算这个量，需要一条能够准确表示系统在时间上物理演化的轨迹$\\mathbf{r}^N(t)$。这样的轨迹是由分子动力学（MD）模拟生成的，它对经典运动方程进行数值积分。在MD模拟中，时间步长$\\Delta t$是无穷小微分$dt$的有限近似，并且具有明确的物理意义。\n\n因此，将蒙特卡罗步的索引等同于物理时间增量$\\Delta t$是一个根本上错误的做法。从MC轨迹计算出的“均方位移”确实会随着步数的增加而增加，但其增加速率取决于算法的非物理、用户选择的参数，例如试探性移动的最大位移大小。它并不反映物理系统的真实扩散行为。\n\n**选项评估**\n\n**A. 它不能，因为标准的Metropolis MC生成一个马尔可夫链，该链对平衡玻尔兹曼分布$p(\\mathbf{r}^N)\\propto \\exp(-\\beta U)$进行抽样，而不积分运动方程，所以MC步不对应于明确定义的物理时间，也没有计算速度；因此，通过时间关联定义的输运系数（例如，爱因斯坦或格林-久保关系式）需要真实的动力学，例如恒定$N$、恒定$V$、恒定$E$（NVE）的牛顿分子动力学。**\n这个陈述是正确且完整的解释。它正确地指出MC生成的是静态平衡样本，而不是动力学轨迹。它正确地说明了MC步不是物理时间，计算动力学性质的方法需要真实的动力学，而这种动力学是通过积分运动方程产生的，其中NVE MD是其典型例子。\n**结论：正确。**\n\n**B. 它可以，前提是每次MC移动的单粒子位移幅度选择得足够小，这样一步MC就可以通过扩散方程映射到一个小的物理时间增量。**\n这是不正确的。虽然减小MC步长可以使构型变化变得增量化，但没有任何基本原理允许将这个任意的算法参数映射到一个物理时间尺度上。由此产生的“扩散”仅仅是衡量随机行走探索构型空间速度的一个指标，这是算法的属性，而不是物理系统的属性。虽然存在专门的“动力学蒙特卡罗”方案，试图通过使用基于物理推导的跃迁速率将MC移动与真实时间联系起来，但这并非此处描述的标准Metropolis算法的情况。\n**结论：不正确。**\n\n**C. 它无效仅仅是因为模拟使用了正则系综（NVT）；如果同样的Metropolis过程在微正则系综（恒定$N$、恒定$V$、恒定$E$）中执行，扩散系数将能被正确获得。**\n这是不正确的。根本问题在于蒙特卡罗方法本身的使用，而不是系综的选择。微正则MC模拟，虽然在算法上与正则MC不同，但它仍然会生成一个随机的构型序列来对恒能面进行抽样，而不是一条真实的动力学轨迹。为了在微正则系综中获得动力学，必须使用NVE分子动力学，它积分牛顿运动方程。为MC模拟切换系综并不能引入物理动力学。\n**结论：不正确。**\n\n**D. 它无效，因为Metropolis MC中的细致平衡消除了所有净通量，使得从MC轨迹计算出的扩散系数恒为零。**\n这是不正确的。细致平衡确保在平衡状态下，任何两个状态之间的系综平均概率通量为零。这并不意味着单个粒子不移动。在任何MC模拟中，粒子都会改变位置，均方位移$\\langle \\lvert \\mathbf{r}(t)-\\mathbf{r}(0)\\rvert^2\\rangle$是MC步数的一个正的、增长的函数。问题在于这个MSD相对于MC“时间”的增长率没有物理意义，而不是说MSD为零。\n**结论：不正确。**\n\n**E. 它可以通过使用格林-久保关系式$D=\\frac{1}{d}\\int_0^\\infty \\langle \\mathbf{v}(0)\\cdot \\mathbf{v}(t)\\rangle \\, \\mathrm{d}t$并利用MC轨迹上位置的有限差分来估算速度，从而变得有效。**\n这是不正确的，原因与最初的提议不正确的原因相同。格林-久保关系式，像爱因斯坦关系式一样，是用于计算动力学性质的公式，需要来自物理轨迹的时间关联函数。使用MC序列中构型之间的有限差分来计算“速度”，例如 $\\mathbf{v}_i \\approx (\\mathbf{r}_{i+1} - \\mathbf{r}_i)/\\Delta t_{MC}$，并不能得到物理速度。这些伪速度及其关联函数将是非物理的MC过程的人为产物。这仅仅是将一个不同的动力学公式应用于同样无效的、非动力学的数据。\n**结论：不正确。**", "answer": "$$\\boxed{A}$$", "id": "2451848"}]}