{"hands_on_practices": [{"introduction": "昂萨格关系中的现象学系数 $L_{ij}$ 并非可以任意取值，它们必须遵循热力学第二定律，即任何自发过程的熵产生率 $\\sigma$ 都必须为非负值。这个基本原理为输运系数施加了严格的数学约束。[@problem_id:1996401] 本练习将通过一个具体的二维输运系统，引导你将熵增原理转化为对昂萨格系数矩阵必须满足的条件，即矩阵的正定性，从而确保模型的物理实在性。", "problem": "一个材料工程团队正在研究一种为先进热电应用设计的新型二元合金的输运性质。在该体系中，温度梯度不仅会引起热通量（$J_q$），还会引起一种可移动原子组分的耦合通量（$J_m$），这种现象被称为热扩散。在线性响应区，通量通过唯象方程与广义热力学力 $X_m$ 和 $X_q$ 相关：\n\n$$\n\\begin{pmatrix} J_m \\\\ J_q \\end{pmatrix} = \\begin{pmatrix} L_{mm} & L_{mq} \\\\ L_{qm} & L_{qq} \\end{pmatrix} \\begin{pmatrix} X_m \\\\ X_q \\end{pmatrix}\n$$\n\n已知该体系遵循 Onsager 倒易关系，$L_{mq} = L_{qm}$。实验测量已确定对角系数为 $L_{mm} = 4.0 \\times 10^{-9}$（在某个一致的单位制下）和 $L_{qq} = 2.5 \\times 10^{3}$（在同一单位体系下）。一个关于该材料的理论模型预测，非对角耦合系数 $L_{mq}$ 通过一个无量纲结构参数 $\\alpha$ 与对角系数相关：\n\n$$\nL_{mq} = \\alpha \\sqrt{L_{mm}L_{qq}}\n$$\n\n为了使该材料物理上可行，其输运系数必须符合热力学第二定律。确定参数 $\\alpha$ 可以取的所有可能实数值所构成的连续区间的总长度。将您的答案以单个实数的形式给出。", "solution": "热力学第二定律要求对于任何热力学力，熵产生都必须是非负的，即对所有 $\\begin{pmatrix} X_{m} \\\\ X_{q} \\end{pmatrix}$，都有 $\\sigma = J_{m}X_{m} + J_{q}X_{q} = \\begin{pmatrix} X_{m} & X_{q} \\end{pmatrix} \\begin{pmatrix} L_{mm} & L_{mq} \\\\ L_{qm} & L_{qq} \\end{pmatrix} \\begin{pmatrix} X_{m} \\\\ X_{q} \\end{pmatrix} \\geq 0$。根据 Onsager 倒易关系，$L$ 是对称的，且 $L_{mq} = L_{qm}$，因此条件是 $L$ 必须是半正定的。\n\n对于一个 $2 \\times 2$ 的对称矩阵，半正定性等价于其所有主子式非负：$L_{mm} \\geq 0$，$L_{qq} \\geq 0$ 以及 $\\det L \\geq 0$。测得的值满足 $L_{mm} > 0$ 和 $L_{qq} > 0$，因此剩下的约束条件是\n$$\n\\det L = L_{mm}L_{qq} - L_{mq}^{2} \\geq 0.\n$$\n代入 $L_{mq} = \\alpha \\sqrt{L_{mm}L_{qq}}$ 和 $L_{qm} = L_{mq}$，该式变为\n$$\nL_{mm}L_{qq} - \\alpha^{2} L_{mm}L_{qq} = L_{mm}L_{qq}\\left(1 - \\alpha^{2}\\right) \\geq 0.\n$$\n由于 $L_{mm}L_{qq} > 0$，该不等式可简化为\n$$\n1 - \\alpha^{2} \\geq 0 \\quad \\Longleftrightarrow \\quad |\\alpha| \\leq 1.\n$$\n因此，$\\alpha$ 的允许集合是区间 $[-1, 1]$，其总长度为 $1 - (-1) = 2$。", "answer": "$$\\boxed{2}$$", "id": "1996401"}, {"introduction": "除了热力学基本定律的限制外，系统的空间对称性也对不同物理过程之间的耦合施加了强大的选择定则，这由居里原理所阐述。在各向同性的介质中，不同张量阶次的通量和力之间不能直接耦合，例如标量（如化学反应速率）和矢量（如热流或扩散流）之间。[@problem_id:1996392] 这个练习将让你应用居里原理来分析一个包含化学反应、热传导和扩散的多物理场耦合问题，通过辨识哪些耦合被对称性所“禁戒”，从而简化问题并求解。", "problem": "考虑一个系统，该系统涉及一层化学活性薄膜内的耦合输运过程，此薄膜可被精确地建模为连续的各向同性介质。有三个不同的不可逆过程同时发生：\n\n1.  一个化学反应，其特征是标量反应速率 $J_r$，由标量热力学力 $X_r$ 驱动。\n2.  热输运，其特征是矢量热通量 $\\vec{J}_q$，由矢量热力学力 $\\vec{X}_q$ 驱动。\n3.  一种惰性物质的扩散，其特征是矢量摩尔通量 $\\vec{J}_c$，由矢量热力学力 $\\vec{X}_c$ 驱动。\n\n在线性非平衡热力学框架内，通量通过一组唯象方程与力相关联，$J_i = \\sum_k L_{ik} X_k$，其中 $L_{ik}$ 是昂萨格系数。\n\n施加于系统的力由以下公式给出：\n-   $X_r = \\alpha$\n-   $\\vec{X}_q = \\beta \\hat{u}_x$\n-   $\\vec{X}_c = \\gamma \\hat{u}_y$\n\n其中，$\\alpha$、$\\beta$ 和 $\\gamma$ 是具有适当单位的正实数常数。矢量 $\\hat{u}_x$ 和 $\\hat{u}_y$ 是笛卡尔坐标系中的正交单位矢量。该系统相关的非零昂萨格系数经唯象学确定为正实数常数 $L_{rr}$、$L_{qq}$ 和 $L_{qc}$。\n\n假设系统在昂萨格形式理论有效的线性区运行，请确定化学反应速率与热通量大小之比的表达式 $J_r / |\\vec{J}_q|$。请用 $\\alpha$、$\\beta$、$\\gamma$ 和给定的昂萨格系数表示您的答案。", "solution": "本问题要求在一个由线性非平衡热力学描述的各向同性系统中，求化学反应速率 $J_r$ 与热通量大小 $|\\vec{J}_q|$ 之比。\n\n首先，我们写下耦合给定通量（$J_r, \\vec{J}_q, \\vec{J}_c$）和力（$X_r, \\vec{X}_q, \\vec{X}_c$）的一般线性唯象方程。通量是所有力的函数：\n$J_r = L_{rr}X_r + \\vec{L}_{rq} \\cdot \\vec{X}_q + \\vec{L}_{rc} \\cdot \\vec{X}_c$\n$\\vec{J}_q = \\vec{L}_{qr}X_r + L_{qq}\\vec{X}_q + L_{qc}\\vec{X}_c$\n$\\vec{J}_c = \\vec{L}_{cr}X_r + L_{cq}\\vec{X}_q + L_{cc}\\vec{X}_c$\n\n在这里，我们必须注意系数的张量性质。连接一个标量和一个矢量的系数必须是一个矢量，而在各向同性介质中连接两个矢量的系数是一个标量。\n\n一个关键信息是介质是**各向同性的**。这一物理性质对耦合系数施加了强约束，这个结果被称为居里原理。该原理指出，在各向同性系统中，不同张量阶的热力学通量和力不能在线性唯象方程中耦合。\n\n让我们分析一下通量和力的张量阶：\n-   $J_r$（反应速率）和 $X_r$（亲和势）是标量（0 阶张量）。\n-   $\\vec{J}_q$（热通量）、$\\vec{J}_c$（摩尔通量）、$\\vec{X}_q$（热力）和 $\\vec{X}_c$（扩散力）是矢量（1 阶张量）。\n\n根据居里原理，连接不同张量阶的通量 $J_i$ 和力 $X_k$ 的唯象系数 $L_{ik}$ 必须为零。\n-   标量通量 $J_r$ 与矢量力 $\\vec{X}_q$ 和 $\\vec{X}_c$ 之间的耦合是被禁止的。这意味着矢量系数 $\\vec{L}_{rq}$ 和 $\\vec{L}_{rc}$ 必须是零矢量：$\\vec{L}_{rq} = \\vec{0}$ 且 $\\vec{L}_{rc} = \\vec{0}$。\n-   类似地，矢量通量 $\\vec{J}_q, \\vec{J}_c$ 与标量力 $X_r$ 之间的耦合也是被禁止的。这意味着矢量系数 $\\vec{L}_{qr}$ 和 $\\vec{L}_{cr}$ 必须是零矢量：$\\vec{L}_{qr} = \\vec{0}$ 且 $\\vec{L}_{cr} = \\vec{0}$。\n\n应用这些条件可以显著简化唯象方程：\n1.  $J_r = L_{rr}X_r$\n2.  $\\vec{J}_q = L_{qq}\\vec{X}_q + L_{qc}\\vec{X}_c$\n3.  $\\vec{J}_c = L_{cq}\\vec{X}_q + L_{cc}\\vec{X}_c$\n\n现在我们可以使用给定的力的表达式来计算问题所需的具体通量。\n\n对于化学反应速率 $J_r$，我们使用简化后的方程 (1) 和给定的力 $X_r = \\alpha$：\n$J_r = L_{rr} \\alpha$\n\n对于热通量 $\\vec{J}_q$，我们使用简化后的方程 (2) 和给定的力 $\\vec{X}_q = \\beta \\hat{u}_x$ 和 $\\vec{X}_c = \\gamma \\hat{u}_y$：\n$\\vec{J}_q = L_{qq}(\\beta \\hat{u}_x) + L_{qc}(\\gamma \\hat{u}_y)$\n$\\vec{J}_q = (L_{qq}\\beta) \\hat{u}_x + (L_{qc}\\gamma) \\hat{u}_y$\n\n问题要求热通量的大小 $|\\vec{J}_q|$。由于 $\\hat{u}_x$ 和 $\\hat{u}_y$ 是正交单位矢量，我们可以使用勾股定理求其大小：\n$|\\vec{J}_q| = \\sqrt{(L_{qq}\\beta)^2 + (L_{qc}\\gamma)^2}$\n\n最后，我们计算所求的比值 $J_r / |\\vec{J}_q|$：\n$\\frac{J_r}{|\\vec{J}_q|} = \\frac{L_{rr}\\alpha}{\\sqrt{(L_{qq}\\beta)^2 + (L_{qc}\\gamma)^2}}$\n\n这是以给定参数表示的最终表达式。关键步骤是认识到介质的各向同性禁止了标量反应过程与矢量输运过程之间的直接耦合。", "answer": "$$\\boxed{\\frac{L_{rr}\\alpha}{\\sqrt{(L_{qq}\\beta)^{2} + (L_{qc}\\gamma)^{2}}}}$$", "id": "1996392"}, {"introduction": "昂萨格关系不仅是宏观的唯象规律，其深刻的根源在于微观粒子动力学的时间反演不变性。Green-Kubo 关系建立了宏观输运系数与平衡态下微观通量涨落的时间自相关函数之间的桥梁。[@problem_id:2447060] 这项高阶计算练习将指导你模拟一个随机过程来代表平衡态下的电流涨落，然后通过计算相关函数积分来数值求解输运系数，并直接验证在不同对称性条件下昂萨格倒易关系是否成立。这项实践让你能亲手揭示宏观对称性与微观动力学之间的深刻联系。", "problem": "您需要利用涨落-耗散框架，对一个类热电系统中的耦合输运现象进行数值演示，以验证昂萨格倒易关系。在近平衡区，根据格林-久保关系，输运系数可以表示为平衡态流-流关联函数的时间积分。您的任务是模拟两个耦合的平衡流（分别代表约化的粒子流和约化的热流），然后数值估计非对角输运系数，以检验倒易性。\n\n请使用以下建模假设和定义作为基础：\n\n- 令 $\\mathbf{J}(t) = \\big(J_{N}(t), J_{Q}(t)\\big)^{\\mathsf{T}}$ 表示两个稳态、零均值的耦合平衡流。在近平衡条件下，格林-久保框架指出线性输运系数与这些流的时间关联函数的积分成正比。请在约化的无量纲单位下进行计算，其中比例常数为 $1$，体积为 $1$，玻尔兹曼常数与绝对温度的乘积为 $1$。因此，所有要求的输出都是无量纲的。\n- 将 $\\mathbf{J}(t)$ 建模为一个由白噪声驱动的稳定、线性、时间均匀的高斯-马尔可夫过程（一个二维奥恩斯坦-乌伦贝克过程）：\n  $$\\mathrm{d}\\mathbf{J}(t) = -\\mathbf{A}\\,\\mathbf{J}(t)\\,\\mathrm{d}t + \\mathbf{B}\\,\\mathrm{d}\\mathbf{W}(t),$$\n  其中 $\\mathbf{A}\\in\\mathbb{R}^{2\\times 2}$ 的特征值具有正实部，$\\mathbf{B}\\in\\mathbb{R}^{2\\times 2}$，$\\mathbf{W}(t)$ 是一个二维标准维纳过程。选择 $\\mathbf{B}$ 以满足具有单位稳态协方差的平衡涨落-耗散要求，即\n  $$\\mathbf{B}\\,\\mathbf{B}^{\\mathsf{T}} = \\mathbf{A} + \\mathbf{A}^{\\mathsf{T}}。$$\n  这确保了系统处于一个协方差为单位矩阵的稳态高斯态，并且当 $\\mathbf{A}$ 对称时，该模型与微观可逆性一致。\n- 在这些约化单位下，将输运矩阵项的估计量定义为相应流-流关联函数的时间积分：\n  $$L_{ij} \\equiv \\int_{0}^{\\infty} \\langle J_{i}(0)\\, J_{j}(t) \\rangle \\,\\mathrm{d}t,$$\n  对于 $i,j\\in\\{N,Q\\}$，其中 $\\langle\\cdot\\rangle$ 表示平衡系综平均。对于时间反演对称系统，昂萨格倒易关系要求 $L_{NQ}=L_{QN}$。\n\n数值任务与约束：\n\n1. 使用欧拉-丸山方法，以固定时间步长 $\\Delta t$ 和指定的步数 $N_{\\text{steps}}$ 模拟该随机微分方程。使用 $N_{\\text{warm}}$ 步的预热期，并丢弃此期间的数据，以使系统达到稳态。\n2. 对于 $k\\ge 0$，使用稳态序列的无偏离散时间估计量，数值估计单边时间关联函数 $\\hat{C}_{ij}(k\\Delta t)$：\n   $$\\hat{C}_{ij}(k\\Delta t) = \\frac{1}{N-k}\\sum_{n=0}^{N-k-1} \\big(J_i[n] - \\overline{J_i}\\big)\\,\\big(J_j[n+k] - \\overline{J_j}\\big),$$\n   其中 $N$ 是预热后保留的样本长度，$\\overline{J_i}$ 是 $J_i$ 的样本均值。使用黎曼和计算积分\n   $$\\hat{L}_{ij} = \\Delta t \\sum_{k=0}^{k_{\\max}} \\hat{C}_{ij}(k\\Delta t),$$\n   其中 $k_{\\max}$ 是一个数据驱动的截断值，用于排除噪声主导的长时尾部。您必须陈述并实现一个基于相关性衰减来选择 $k_{\\max}$ 的原则性规则。\n3. 对于下述每个测试用例，计算数值估计值 $\\hat{L}_{NQ}$ 和 $\\hat{L}_{QN}$，并返回一个布尔值，以指示昂萨格倒易条件 $\\lvert \\hat{L}_{NQ} - \\hat{L}_{QN} \\rvert \\le \\varepsilon$ 是否在指定的容差 $\\varepsilon$ 内成立。\n4. 全程使用无量纲单位。仅返回布尔值，不带单位。\n\n测试套件：\n\n对所有用例，使用 $\\Delta t = 10^{-3}$、$N_{\\text{steps}}=200000$、$N_{\\text{warm}}=20000$ 以及容差 $\\varepsilon=2\\times 10^{-2}$。对于每个用例，定义\n$$\n\\mathbf{A} = \\begin{bmatrix} a & c \\\\ d & b \\end{bmatrix}, \\quad \\mathbf{B} \\text{ via } \\mathbf{B}\\mathbf{B}^{\\mathsf{T}}=\\mathbf{A}+\\mathbf{A}^{\\mathsf{T}}.\n$$\n初始化 $\\mathbf{J}(0)=\\mathbf{0}$，并对高斯噪声使用给定的随机种子。\n\n- 用例1（时间反演对称，耦合）：$a=1.0$, $b=0.8$, $c=d=0.4$, seed $=12345$。\n- 用例2（时间反演对称，非耦合）：$a=1.0$, $b=1.2$, $c=d=0.0$, seed $=67890$。\n- 用例3（时间反演对称性破缺）：$a=1.0$, $b=0.9$, $c=1.0$, $d=0.1$, seed $=24680$。\n\n最终输出格式：\n\n您的程序应生成单行输出，其中包含一个由方括号括起来的逗号分隔列表（例如，“[True,True,False]”）。该列表必须包含三个条目，按顺序对应于用例1-3。所有计算和输出都必须使用指定的无量纲单位完成。", "solution": "该问题要求对一个双耦合流模型系统进行数值演示，以验证昂萨格倒易关系。对问题陈述的验证证实了其科学上的合理性、问题的适定性以及客观性。它基于非平衡统计力学的既定原理，特别是格林-久保关系和涨落-耗散定理。问题提供了获得唯一数值解所需的所有必要参数和定义，并且其底层的物理和数学模型是一致的。因此，我们可以着手进行求解。\n\n该问题的理论基础在于线性响应理论。在热平衡附近，系统对微小热力学力的响应是线性的。通过 $\\mathbf{J} = \\mathbf{L}\\mathbf{F}$ 将热力学流 $\\mathbf{J}$ 与力 $\\mathbf{F}$ 联系起来的相关输运系数，可以从平衡涨落中计算出来。格林-久保关系指出，这些系数 $L_{ij}$ 由相应流的平衡时间关联函数的时间积分给出：\n$$\nL_{ij} = V \\beta \\int_{0}^{\\infty} \\langle J_{i}(t=0)\\, J_{j}(t) \\rangle_{\\text{eq}} \\,\\mathrm{d}t\n$$\n其中 $V$ 是体积，$\\beta = (k_B T)^{-1}$，$\\langle \\cdot \\rangle_{\\text{eq}}$ 是平衡系综平均。问题指定我们在 $V\\beta = 1$ 的约化单位下工作。因此，该关系简化为：\n$$\nL_{ij} = \\int_{0}^{\\infty} \\langle J_{i}(0)\\, J_{j}(t) \\rangle \\,\\mathrm{d}t\n$$\n\n流的动力学被建模为一个二维奥恩斯坦-乌伦贝克过程，这是高斯-马尔可夫过程的一个典型模型：\n$$\n\\mathrm{d}\\mathbf{J}(t) = -\\mathbf{A}\\,\\mathbf{J}(t)\\,\\mathrm{d}t + \\mathbf{B}\\,\\mathrm{d}\\mathbf{W}(t)\n$$\n这里，$\\mathbf{J}(t) = (J_N(t), J_Q(t))^{\\mathsf{T}}$ 是流矢量，$\\mathbf{A}$ 是漂移或回归矩阵，$\\mathbf{B}\\,\\mathrm{d}\\mathbf{W}(t)$ 是基于标准维纳过程 $\\mathbf{W}(t)$ 的随机驱动项。通过要求 $\\mathbf{A}$ 的特征值具有正实部，可以保证平衡态的稳定性。\n\n涨落-耗散定理将耗散动力学（矩阵 $\\mathbf{A}$）与随机涨落（矩阵 $\\mathbf{B}$）联系起来。为使该系统达到一个具有单位协方差矩阵的稳态，即 $\\langle \\mathbf{J} \\mathbf{J}^{\\mathsf{T}} \\rangle_{\\text{stat}} = \\mathbf{I}$，矩阵必须满足以下关系：\n$$\n\\mathbf{A}\\,\\mathbf{I} + \\mathbf{I}\\,\\mathbf{A}^{\\mathsf{T}} = \\mathbf{B}\\,\\mathbf{B}^{\\mathsf{T}} \\implies \\mathbf{A} + \\mathbf{A}^{\\mathsf{T}} = \\mathbf{B}\\,\\mathbf{B}^{\\mathsf{T}}\n$$\n这确保了与统计力学的一致性。该过程的时间关联函数矩阵由 $\\mathbf{C}(t) = \\langle \\mathbf{J}(0) \\mathbf{J}(t)^{\\mathsf{T}} \\rangle = e^{-\\mathbf{A}t} \\langle \\mathbf{J}(0) \\mathbf{J}(0)^{\\mathsf{T}} \\rangle = e^{-\\mathbf{A}t}$ 给出。输运系数矩阵 $\\mathbf{L}$ 则是其积分：\n$$\n\\mathbf{L} = \\int_{0}^{\\infty} e^{-\\mathbf{A}t} \\,\\mathrm{d}t = \\mathbf{A}^{-1}\n$$\n昂萨格倒易定理 $L_{ij} = L_{ji}$ 适用于底层微观动力学具有时间反演对称性的系统。在此模型中，时间反演对称性要求漂移矩阵 $\\mathbf{A}$ 是对称的，即 $\\mathbf{A} = \\mathbf{A}^{\\mathsf{T}}$。从解析结果 $\\mathbf{L} = \\mathbf{A}^{-1}$ 可以清楚地看出，如果 $\\mathbf{A}$ 是对称的，那么 $\\mathbf{A}^{-1}$ 也是对称的，这意味着 $\\mathbf{L} = \\mathbf{L}^{\\mathsf{T}}$，因此 $L_{NQ} = L_{QN}$。反之，如果 $\\mathbf{A}$ 不对称，通常不满足倒易性。这为每个测试用例提供了明确的理论预测。\n\n数值计算步骤如下：\n\n1.  **动力学模拟**：使用欧拉-丸山格式，以时间步长 $\\Delta t$ 对随机微分方程进行离散化：\n    $$\n    \\mathbf{J}[n+1] = \\mathbf{J}[n] - \\mathbf{A}\\,\\mathbf{J}[n]\\,\\Delta t + \\mathbf{B}\\,\\sqrt{\\Delta t}\\,\\mathbf{Z}[n]\n    $$\n    其中 $\\mathbf{Z}[n]$ 是一个由两个独立的标准正态随机变量组成的向量。矩阵 $\\mathbf{B}$ 由 $\\mathbf{S} = \\mathbf{A} + \\mathbf{A}^{\\mathsf{T}}$ 通过Cholesky分解计算得出，这保证了 $\\mathbf{B}\\mathbf{B}^{\\mathsf{T}} = \\mathbf{S}$。在采集数据之前，使用一个 $N_{\\text{warm}}$ 步长的预热期，以确保系统达到其稳态。\n\n2.  **关联函数估计**：在预热后生成长度为 $N$ 的时间序列后，使用针对延迟 $k$ 的无偏估计量来估计非对角关联函数 $\\hat{C}_{NQ}(k\\Delta t)$ 和 $\\hat{C}_{QN}(k\\Delta t)$：\n    $$\n    \\hat{C}_{ij}(k\\Delta t) = \\frac{1}{N-k} \\sum_{n=0}^{N-k-1} (J_i[n] - \\overline{J_i})(J_j[n+k] - \\overline{J_j})\n    $$\n    其中 $\\overline{J_i}$ 是样本均值。为提高计算效率，此相关性是使用快速傅里叶变换 (FFT) 方法计算的，如 `scipy.signal.correlate` 所提供的那样。\n\n3.  **积分截断**：$L_{ij}$ 的积分通过离散求和来近似。此求和的上限 $k_{\\max}$ 必须仔细选择。我们的积分上限是关联函数衰减到统计噪声水平的时间点。一个原则性规则是使用自相关函数 $\\hat{C}_{NN}(t)$ 和 $\\hat{C}_{QQ}(t)$ 的衰减作为指导。截断值 $k_{\\max}$ 定义为 $\\hat{C}_{NN}(t)$ 和 $\\hat{C}_{QQ}(t)$ 首次穿越零点的时间中的最大值。这确保了积分窗口足以捕捉系统最慢的弛豫模式。如果在极少数情况下未找到零交叉点，则设置一个备用值 $k_{\\max} = N/5$。\n\n4.  **倒易性检验**：输运系数 $\\hat{L}_{NQ}$ 和 $\\hat{L}_{QN}$ 通过黎曼和计算：\n    $$\n    \\hat{L}_{ij} = \\Delta t \\sum_{k=0}^{k_{\\max}} \\hat{C}_{ij}(k\\Delta t)\n    $$\n    最后，通过检查数值估计值之间的绝对差是否在给定的容差 $\\varepsilon$ 内来检验昂萨格关系：$|\\hat{L}_{NQ} - \\hat{L}_{QN}| \\le \\varepsilon$。\n\n该程序应用于每个测试用例，这些用例旨在探究满足或不满足倒易关系所需的时间反演对称性的系统。", "answer": "```python\nimport numpy as np\nfrom scipy import linalg, signal\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite for Onsager reciprocity.\n    \"\"\"\n    \n    # Global parameters as specified in the problem statement.\n    dt = 1e-3\n    n_steps = 200000\n    n_warm = 20000\n    epsilon = 2e-2\n    N = n_steps - n_warm\n\n    test_cases = [\n        # Case 1 (time-reversal symmetric, coupled)\n        {'a': 1.0, 'b': 0.8, 'c': 0.4, 'd': 0.4, 'seed': 12345},\n        # Case 2 (time-reversal symmetric, uncoupled)\n        {'a': 1.0, 'b': 1.2, 'c': 0.0, 'd': 0.0, 'seed': 67890},\n        # Case 3 (time-reversal symmetry broken)\n        {'a': 1.0, 'b': 0.9, 'c': 1.0, 'd': 0.1, 'seed': 24680},\n    ]\n\n    results = []\n    \n    for case_params in test_cases:\n        A_matrix = np.array([\n            [case_params['a'], case_params['c']],\n            [case_params['d'], case_params['b']]\n        ])\n        seed = case_params['seed']\n\n        # 1. Simulate the Ornstein-Uhlenbeck process.\n        rng = np.random.default_rng(seed)\n        S = A_matrix + A_matrix.T\n        B_matrix = linalg.cholesky(S, lower=True)\n        \n        identity = np.identity(2)\n        drift_term_matrix = identity - A_matrix * dt\n        noise_factor = np.sqrt(dt)\n\n        J = np.zeros(2)\n        trajectory = np.zeros((N, 2))\n\n        # Warm-up phase (data is discarded).\n        for _ in range(n_warm):\n            Z = rng.standard_normal(size=2)\n            J = drift_term_matrix @ J + B_matrix @ (noise_factor * Z)\n\n        # Production run.\n        for i in range(N):\n            Z = rng.standard_normal(size=2)\n            J = drift_term_matrix @ J + B_matrix @ (noise_factor * Z)\n            trajectory[i, :] = J\n\n        # 2. Estimate the transport coefficients.\n        # Center the time series data. J_N is index 0, J_Q is index 1.\n        j_n = trajectory[:, 0] - np.mean(trajectory[:, 0])\n        j_q = trajectory[:, 1] - np.mean(trajectory[:, 1])\n\n        # Pre-compute normalization for the unbiased estimator.\n        # This is 1 / (N - k) for k = 0, 1, ..., N-1.\n        norm_factor = N - np.arange(N)\n        # Prevent division by zero for the last element (which is unused anyway).\n        norm_factor[norm_factor == 0] = 1\n\n        def compute_correlation(series1, series2):\n            \"\"\"Computes unbiased time correlation C_12(k) for k>=0.\"\"\"\n            # `signal.correlate` computes sum_m s2[m+n]*s1[m].\n            # For C_12(k) = <J1(0)J2(k)>, we correlate J2 with J1.\n            unnorm_corr = signal.correlate(series2, series1, mode='full', method='fft')[N - 1:]\n            return unnorm_corr / norm_factor\n\n        C_NN = compute_correlation(j_n, j_n)\n        C_QQ = compute_correlation(j_q, j_q)\n        C_NQ = compute_correlation(j_n, j_q)\n        C_QN = compute_correlation(j_q, j_n)\n\n        # 3. Determine data-driven integration cutoff k_max.\n        # Find the first time the autocorrelation functions cross zero.\n        k_n_zeros = np.where(C_NN  0)[0]\n        k_q_zeros = np.where(C_QQ  0)[0]\n        \n        # Use a fallback if zero-crossing is not found.\n        # For these long simulations, it should always be found.\n        k_n0 = k_n_zeros[0] if k_n_zeros.size > 0 else N // 5\n        k_q0 = k_q_zeros[0] if k_q_zeros.size > 0 else N // 5\n        \n        k_max = max(k_n0, k_q0)\n\n        # 4. Integrate correlation functions to get transport coefficients.\n        L_NQ = dt * np.sum(C_NQ[:k_max])\n        L_QN = dt * np.sum(C_QN[:k_max])\n\n        # 5. Check if Onsager reciprocity holds within the given tolerance.\n        reciprocity_holds = np.abs(L_NQ - L_QN) = epsilon\n        results.append(reciprocity_holds)\n\n    # Final output must match the specified format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2447060"}]}