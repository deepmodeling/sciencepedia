{"hands_on_practices": [{"introduction": "在分析化学中，一个常见的任务是定量比较数据集，例如将新产品批次的光谱与参考标准进行比较。皮尔逊相关系数 $r$ 提供了一个稳健的统计量度，用以评估两个变量之间的线性关系，使其成为评价光谱轮廓相似性的理想工具。本练习将引导您手动计算 $r$ 值，锻炼您将这一基本化学计量学技术应用于实际质量控制场景的能力。[@problem_id:1450484]", "problem": "在一家质量控制实验室中，一名分析化学家的任务是验证一个新批次原料药的同一性。所使用的主要分析方法是紫外-可见（UV-Vis）分光光度法。该化学家测量了新批次的吸收光谱，并将其与同种药物的认证参考标准品的光谱进行比较。为了简化比较，在四个特定的、相同的波长下，记录了参考标准品（光谱 A）和新批次（光谱 B）的吸光度值。数据如下：\n\n对于参考标准品（光谱 A），吸光度值分别为 0.20、0.50、0.80 和 0.40。\n\n对于新批次（光谱 B），在相同波长下的相应吸光度值分别为 0.25、0.58、0.85 和 0.47。\n\n为了定量评估两个光谱之间的相似性，请计算皮尔逊相关系数 $r$。将您的最终答案四舍五入到三位有效数字。", "solution": "设参考吸光度为 $x_{i}$，新批次吸光度为 $y_{i}$，其中 $i=1,2,3,4$。皮尔逊相关系数计算如下：\n$$\nr=\\frac{\\sum_{i=1}^{4}\\left(x_{i}-\\bar{x}\\right)\\left(y_{i}-\\bar{y}\\right)}{\\sqrt{\\left(\\sum_{i=1}^{4}\\left(x_{i}-\\bar{x}\\right)^{2}\\right)\\left(\\sum_{i=1}^{4}\\left(y_{i}-\\bar{y}\\right)^{2}\\right)}}.\n$$\n\n计算均值：\n$$\n\\bar{x}=\\frac{0.20+0.50+0.80+0.40}{4}=0.475,\\quad \\bar{y}=\\frac{0.25+0.58+0.85+0.47}{4}=0.5375.\n$$\n\n计算中心化和：\n$$\n\\sum_{i=1}^{4}\\left(x_{i}-\\bar{x}\\right)\\left(y_{i}-\\bar{y}\\right)=(-0.275)(-0.2875)+(0.025)(0.0425)+(0.325)(0.3125)+(-0.075)(-0.0675)=0.18675,\n$$\n$$\n\\sum_{i=1}^{4}\\left(x_{i}-\\bar{x}\\right)^{2}=(-0.275)^{2}+(0.025)^{2}+(0.325)^{2}+(-0.075)^{2}=0.1875,\n$$\n$$\n\\sum_{i=1}^{4}\\left(y_{i}-\\bar{y}\\right)^{2}=(-0.2875)^{2}+(0.0425)^{2}+(0.3125)^{2}+(-0.0675)^{2}=0.186675.\n$$\n\n因此，\n$$\nr=\\frac{0.18675}{\\sqrt{0.1875\\cdot 0.186675}}.\n$$\n注意到 $0.18675=\\frac{747}{4000}$，$0.1875=\\frac{3}{16}$，以及 $0.186675=\\frac{7467}{40000}$，我们得到精确形式\n$$\nr=\\frac{\\frac{747}{4000}}{\\sqrt{\\frac{22401}{640000}}}=\\frac{747}{5\\sqrt{22401}}\\approx 0.998198\\ldots\n$$\n四舍五入到三位有效数字，得到 $r\\approx 0.998$。", "answer": "$$\\boxed{0.998}$$", "id": "1450484"}, {"introduction": "建立一个校准模型只是完成了一半的工作；我们还必须严格评估其性能。均方根误差 ($RMSE$) 是用于量化模型预测与实际观测值匹配程度的最常用指标之一。本练习将向您演示如何计算一个简单线性回归模型的 $RMSE$，为您评估所开发的任何预测模型的准确性提供一项基本技能。[@problem_id:1450492]", "problem": "在分析化学实验室中，一名学生正在开发一个简单的线性回归模型，以使用紫外-可见 (UV-Vis) 光谱法预测各种饮料样品中咖啡因的浓度。为了评估模型的性能，该学生配制并分析了三种已知咖啡因浓度的标准溶液。然后，该模型预测了每种标准品的浓度。\n\n记录的真实浓度（配制值）和模型预测的浓度如下：\n- 样品 1：真实值 = 2.50 mM，预测值 = 2.65 mM\n- 样品 2：真实值 = 5.00 mM，预测值 = 4.85 mM\n- 样品 3：真实值 = 7.50 mM，预测值 = 7.70 mM\n\n模型的预测质量通常使用均方根误差 (RMSE) 进行评估，这是一种衡量模型预测值与实际观测值之间差异的标准方法。RMSE 使用以下公式计算：\n$$\n\\text{RMSE} = \\sqrt{\\frac{1}{n} \\sum_{i=1}^{n} (y_i - \\hat{y}_i)^2}\n$$\n其中 $n$ 是样品数量，$y_i$ 是第 $i$ 个样品的真实浓度，$\\hat{y}_i$ 是第 $i$ 个样品的预测浓度。\n\n基于这三个标准样品，计算该学生模型的 RMSE。最终答案以 mM 为单位，并四舍五入到三位有效数字。", "solution": "我们已知三对真实-预测值以及 RMSE 的定义：\n$$\n\\text{RMSE}=\\sqrt{\\frac{1}{n}\\sum_{i=1}^{n}(y_{i}-\\hat{y}_{i})^{2}}, \\quad n=3.\n$$\n计算残差：\n- 对于样品 1：$r_{1}=y_{1}-\\hat{y}_{1}=2.50-2.65=-0.15$。\n- 对于样品 2：$r_{2}=y_{2}-\\hat{y}_{2}=5.00-4.85=0.15$。\n- 对于样品 3：$r_{3}=y_{3}-\\hat{y}_{3}=7.50-7.70=-0.20$。\n\n将残差平方并求和：\n$$\n\\sum_{i=1}^{3}r_{i}^{2}=(-0.15)^{2}+(0.15)^{2}+(-0.20)^{2}=0.0225+0.0225+0.0400=0.0850.\n$$\n计算均方误差并取平方根：\n$$\n\\text{MSE}=\\frac{0.0850}{3}=0.028333\\ldots,\\qquad \\text{RMSE}=\\sqrt{0.028333\\ldots}\\approx 0.168325\\ldots\n$$\n四舍五入到三位有效数字，得到 $0.168$ mM。", "answer": "$$\\boxed{0.168}$$", "id": "1450492"}, {"introduction": "在训练数据上计算的简单 $RMSE$ 可能会对模型性能产生过于乐观的评估。为了更真实地估计模型在新的、未见过的数据上的表现，我们采用交叉验证技术。本练习将介绍功能强大的“留一法交叉验证”($LOOCV$) 方法，该方法对于小数据集尤其有价值，它将引导您通过分步过程，对校准模型的预测能力进行更稳健、更可靠的评估。[@problem_id:1450489]", "problem": "一位分析化学家正在使用高效液相色谱（HPLC）为一种名为“Quantapril”的新候选药物开发一种定量方法。通过测量五种已知浓度的标准溶液的仪器响应（峰面积），构建了一条校准曲线。为了稳健地评估该校准模型的预测准确性，使用了一种特定的验证程序。\n\n该程序如下：对于五个标准品中的每一个，仅使用其余四个标准品创建一个临时的线性回归模型。然后使用这个临时模型来预测那个被排除在外的标准品的浓度。对所有五个标准品重复此过程，为每个标准品得到一个预测浓度，共计五个。\n\n已知浓度（$x$）及其对应测量峰面积（$y$）的数据集如下所示：\n- 标准品 1：浓度 = 1.0 mg/L，峰面积 = 105\n- 标准品 2：浓度 = 2.0 mg/L，峰面积 = 215\n- 标准品 3：浓度 = 4.0 mg/L，峰面积 = 400\n- 标准品 4：浓度 = 6.0 mg/L，峰面积 = 630\n- 标准品 5：浓度 = 8.0 mg/L，峰面积 = 790\n\n线性回归模型通过方程 $y = mx + b$ 将峰面积（$y$）与浓度（$x$）关联起来。验证的目标是根据给定的峰面积（$y$）预测浓度（$x$）。\n\n计算整体预测质量指标，该指标定义为：从此迭代验证过程中，对五个标准品中的每一个，其已知浓度与预测浓度之间差值的平方取均值，然后取其平方根。\n\n答案以 mg/L 为单位表示，并四舍五入到三位有效数字。", "solution": "我们使用普通最小二乘法（OLS）对每次四个标准品（留一法）将校准建模为 $y = m x + b$，然后通过 $\\hat{x} = \\frac{y - b}{m}$ 反转拟合模型，从峰面积预测浓度。 对于每次排除，我们计算 $m = \\frac{S_{xy}}{S_{xx}}$，其中 $S_{xx} = \\sum (x_{j} - \\bar{x})^{2}$，$S_{xy} = \\sum (x_{j} - \\bar{x})(y_{j} - \\bar{y})$，以及 $b = \\bar{y} - m \\bar{x}$。对于被排除在外的点，其预测误差为 $e = x_{\\text{true}} - \\hat{x}$。整体预测质量指标是 $x$ 的均方根误差（RMSE）：\n$$\n\\mathrm{RMSE}_{x} = \\sqrt{\\frac{1}{5}\\sum_{i=1}^{5} e_{i}^{2}}.\n$$\n\n数据：$(x,y)$，单位为 mg/L 和峰面积：\n$(1,105)$, $(2,215)$, $(4,400)$, $(6,630)$, $(8,790)$。\n\n排除 $(1,105)$：剩余 $(2,215),(4,400),(6,630),(8,790)$。\n$$\n\\bar{x}=\\frac{2+4+6+8}{4}=5,\\quad \\bar{y}=\\frac{215+400+630+790}{4}= \\frac{2035}{4}.\n$$\n$$\nS_{xx}=(2-5)^{2}+(4-5)^{2}+(6-5)^{2}+(8-5)^{2}=20,\\quad S_{xy}=1955.\n$$\n$$\nm_{(1)}=\\frac{1955}{20}=97.75=\\frac{391}{4},\\quad b_{(1)}=\\bar{y}-m\\bar{x}=\\frac{2035}{4}-\\frac{391}{4}\\cdot 5=20.\n$$\n对 $y=105$ 的预测：\n$$\n\\hat{x}_{1}=\\frac{105-20}{97.75}=\\frac{85}{97.75}=\\frac{340}{391},\\quad e_{1}=1-\\frac{340}{391}=\\frac{51}{391}.\n$$\n\n排除 $(2,215)$：剩余 $(1,105),(4,400),(6,630),(8,790)$。\n$$\n\\bar{x}=\\frac{1+4+6+8}{4}=\\frac{19}{4},\\quad \\bar{y}=\\frac{105+400+630+790}{4}=\\frac{1925}{4}.\n$$\n$$\nS_{xx}=26.75=\\frac{107}{4},\\quad S_{xy}=2661.25=\\frac{10645}{4}.\n$$\n$$\nm_{(2)}=\\frac{10645}{107},\\quad b_{(2)}=\\bar{y}-m\\bar{x}=\\frac{1925}{4}-\\frac{10645}{107}\\cdot\\frac{19}{4}=\\frac{930}{107}.\n$$\n对 $y=215$ 的预测：\n$$\n\\hat{x}_{2}=\\frac{215-\\frac{930}{107}}{\\frac{10645}{107}}=\\frac{22075}{10645}=\\frac{4415}{2129},\\quad e_{2}=2-\\frac{4415}{2129}=-\\frac{157}{2129}.\n$$\n\n排除 $(4,400)$：剩余 $(1,105),(2,215),(6,630),(8,790)$。\n$$\n\\bar{x}=\\frac{17}{4},\\quad \\bar{y}=435,\\quad S_{xx}=32.75=\\frac{131}{4},\\quad S_{xy}=3240.\n$$\n$$\nm_{(3)}=\\frac{3240}{32.75}=\\frac{12960}{131},\\quad b_{(3)}=435-\\frac{12960}{131}\\cdot\\frac{17}{4}=\\frac{1905}{131}.\n$$\n对 $y=400$ 的预测：\n$$\n\\hat{x}_{3}=\\frac{400-\\frac{1905}{131}}{\\frac{12960}{131}}=\\frac{50495}{12960},\\quad e_{3}=4-\\frac{50495}{12960}=\\frac{1345}{12960}.\n$$\n\n排除 $(6,630)$：剩余 $(1,105),(2,215),(4,400),(8,790)$。\n$$\n\\bar{x}=\\frac{15}{4},\\quad \\bar{y}=377.5,\\quad S_{xx}=28.75=\\frac{115}{4},\\quad S_{xy}=2792.5=\\frac{11170}{4}.\n$$\n$$\nm_{(4)}=\\frac{11170}{115}=\\frac{2234}{23},\\quad b_{(4)}=377.5-\\frac{2234}{23}\\cdot\\frac{15}{4}=\\frac{305}{23}.\n$$\n对 $y=630$ 的预测：\n$$\n\\hat{x}_{4}=\\frac{630-\\frac{305}{23}}{\\frac{2234}{23}}=\\frac{14185}{2234},\\quad e_{4}=6-\\frac{14185}{2234}=-\\frac{781}{2234}.\n$$\n\n排除 $(8,790)$：剩余 $(1,105),(2,215),(4,400),(6,630)$。\n$$\n\\bar{x}=\\frac{13}{4},\\quad \\bar{y}=337.5,\\quad S_{xx}=14.75=\\frac{59}{4},\\quad S_{xy}=1527.5=\\frac{6110}{4}.\n$$\n$$\nm_{(5)}=\\frac{6110}{59},\\quad b_{(5)}=337.5-\\frac{6110}{59}\\cdot\\frac{13}{4}=\\frac{55}{59}.\n$$\n对 $y=790$ 的预测：\n$$\n\\hat{x}_{5}=\\frac{790-\\frac{55}{59}}{\\frac{6110}{59}}=\\frac{46555}{6110},\\quad e_{5}=8-\\frac{46555}{6110}=\\frac{2325}{6110}=\\frac{465}{1222}.\n$$\n\n误差平方：\n$$\ne_{1}^{2}=\\frac{2601}{152881}\\approx 0.017013233,\\quad e_{2}^{2}=\\frac{24649}{4532641}\\approx 0.005438110,\n$$\n$$\ne_{3}^{2}=\\frac{1809025}{167961600}\\approx 0.010770470,\\quad e_{4}^{2}=\\frac{609961}{4990756}\\approx 0.122218160,\n$$\n$$\ne_{5}^{2}=\\frac{5405625}{37332100}\\approx 0.144798310.\n$$\n总和与均值：\n$$\n\\sum e_{i}^{2}\\approx 0.300238283,\\quad \\overline{e^{2}}=\\frac{1}{5}\\sum e_{i}^{2}\\approx 0.060047657.\n$$\n浓度的均方根误差：\n$$\n\\mathrm{RMSE}_{x}=\\sqrt{0.060047657}\\approx 0.245046\\ \\text{mg/L}.\n$$\n四舍五入到三位有效数字，整体预测质量指标为 $0.245$ mg/L。", "answer": "$$\\boxed{0.245}$$", "id": "1450489"}]}