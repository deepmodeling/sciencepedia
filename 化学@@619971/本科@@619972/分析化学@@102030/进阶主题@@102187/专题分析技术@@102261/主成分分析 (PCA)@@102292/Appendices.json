{"hands_on_practices": [{"introduction": "主成分分析的核心思想是通过线性变换找到数据变异最大的方向，这个过程在数学上对应于求解数据协方差矩阵的特征值和特征向量。通过这个基础练习 [@problem_id:1946278]，你将亲手计算一个简化的二维数据集的主成分，并探索原始变量之间的相关性（由相关系数 $\\rho$ 表示）如何直接决定第一个主成分所能解释的方差比例，从而深刻理解PCA的数学本质。", "problem": "一架自动环境监测无人机使用一对相同的传感器来测量大气压力。设这两个传感器的读数在减去其长期平均值进行中心化后，由随机变量 $X_1$ 和 $X_2$ 表示。\n\n这些读数的联合行为由一个二元随机向量 $(X_1, X_2)$ 描述，其协方差矩阵为 $\\Sigma$。由于传感器是同一类型，并受到相似的环境波动影响，因此它们具有相同的方差，$\\text{Var}(X_1) = \\text{Var}(X_2) = \\sigma^2$，其中 $\\sigma > 0$ 为某个常数。它们的读数也是相关的，相关系数为 $\\rho$，满足 $0 < \\rho < 1$。因此，协方差矩阵由下式给出：\n$$\n\\Sigma = \\begin{pmatrix} \\sigma^2 & \\rho\\sigma^2 \\\\ \\rho\\sigma^2 & \\sigma^2 \\end{pmatrix}\n$$\n为了减少数据冗余并识别主要变异轴，工程团队应用了主成分分析（PCA）。PCA 将原始的相关变量 $(X_1, X_2)$ 转换为一组新的不相关变量，称为主成分。第一主成分被定义为能够捕获最大可能方差的 $X_1$ 和 $X_2$ 的线性组合。\n\n确定数据中由第一主成分解释的总方差的比例。将你的答案表示为关于 $\\rho$ 的符号表达式。", "solution": "给定一个中心化的二元随机向量，其协方差矩阵为\n$$\n\\Sigma=\\begin{pmatrix}\\sigma^{2} & \\rho\\sigma^{2} \\\\ \\rho\\sigma^{2} & \\sigma^{2}\\end{pmatrix},\n$$\n其中 $0<\\rho<1$ 且 $\\sigma>0$。在 PCA 中，主成分的方差是协方差矩阵的特征值。第一主成分解释的总方差比例等于其特征值除以总方差，而总方差是 $\\Sigma$ 的迹。\n\n首先，通过求解特征方程来计算 $\\Sigma$ 的特征值\n$$\n\\det(\\Sigma-\\lambda I)=0.\n$$\n我们有\n$$\n\\det\\begin{pmatrix}\\sigma^{2}-\\lambda & \\rho\\sigma^{2} \\\\ \\rho\\sigma^{2} & \\sigma^{2}-\\lambda\\end{pmatrix}\n=(\\sigma^{2}-\\lambda)^{2}-(\\rho\\sigma^{2})^{2}=0.\n$$\n因此，\n$$\n(\\sigma^{2}-\\lambda)^{2}=\\rho^{2}\\sigma^{4}\n\\quad\\Longrightarrow\\quad\n\\sigma^{2}-\\lambda=\\pm\\rho\\sigma^{2}\n\\quad\\Longrightarrow\\quad\n\\lambda=\\sigma^{2}(1\\pm\\rho).\n$$\n因为 $0<\\rho<1$，所以最大特征值是\n$$\n\\lambda_{1}=\\sigma^{2}(1+\\rho).\n$$\n总方差等于 $\\Sigma$ 的迹，\n$$\n\\operatorname{tr}(\\Sigma)=\\sigma^{2}+\\sigma^{2}=2\\sigma^{2},\n$$\n这也等于特征值之和 $\\sigma^{2}(1+\\rho)+\\sigma^{2}(1-\\rho)=2\\sigma^{2}$。因此，第一主成分解释的总方差比例是\n$$\n\\frac{\\lambda_{1}}{\\operatorname{tr}(\\Sigma)}=\\frac{\\sigma^{2}(1+\\rho)}{2\\sigma^{2}}=\\frac{1+\\rho}{2}.\n$$", "answer": "$$\\boxed{\\frac{1+\\rho}{2}}$$", "id": "1946278"}, {"introduction": "在实际应用中，尤其是在处理像光谱分析这样的高维数据时，PCA的主要优势之一是降低数据维度。在计算出所有主成分后，我们面临一个关键决策：保留多少个主成分才能在简化数据的同时，最大限度地保留原始信息？这个练习 [@problem_id:1461616] 模拟了化学计量学中的一个典型场景，要求你根据每个主成分解释的方差百分比来决定保留的主成分数量，训练你使用“累积解释方差”这一关键指标来平衡模型的简约性和保真度。", "problem": "在某分析化学实验室中，一位研究人员正在开发一种新型生物可降解聚合物的混合物。为了表征各种配方的组成和分子间相互作用，她使用傅里叶变换红外光谱（FT-IR）技术收集光谱数据。所得到的数据集庞大而复杂，包含数百个高度相关的变量（不同波数下的吸光度）。为了简化数据并识别最主要的变化来源，她采用了一种称为主成分分析（PCA）的化学计量学技术。\n\nPCA 算法将原始数据转换为一组新的不相关变量，称为主成分（PCs）。每个后续的主成分在原始数据集的总方差中解释的比例依次递减。前六个主成分解释的总方差百分比如下：\n\n- PC1：61.45%\n- PC2：22.81%\n- PC3：8.03%\n- PC4：4.12%\n- PC5：2.57%\n- PC6：0.88%\n\n在化学计量学中，通常的做法是只保留足以解释数据方差重要部分的主成分数量，从而在保留基本信息的同时降低维度。请确定需要保留的最小主成分数量，以解释 FT-IR 数据集中至少 98% 的总方差。", "solution": "目标是找出解释至少 98% 总方差所需的最小主成分（PCs）数量。为此，我们必须计算逐个添加主成分时解释的累积方差百分比，当累积总量首次达到或超过 98% 时停止。\n\n每个主成分解释的方差百分比如下：\n- PC1：61.45%\n- PC2：22.81%\n- PC3：8.03%\n- PC4：4.12%\n- PC5：2.57%\n- PC6：0.88%\n\n让我们逐步计算累积方差。\n\n第一步：只考虑第一个主成分（PC1）。\n累积方差为 61.45%。\n这小于 98%，所以我们需要更多的主成分。\n\n第二步：加上第二个主成分（PC2）。\n累积方差是 PC1 和 PC2 方差之和。\n累积方差 = 61.45% + 22.81% = 84.26%。\n这小于 98%，所以我们需要更多的主成分。\n\n第三步：加上第三个主成分（PC3）。\n累积方差是 PC1、PC2 和 PC3 方差之和。\n累积方差 = 84.26% + 8.03% = 92.29%。\n这小于 98%，所以我们需要更多的主成分。\n\n第四步：加上第四个主成分（PC4）。\n累积方差是 PC1、PC2、PC3 和 PC4 方差之和。\n累积方差 = 92.29% + 4.12% = 96.41%。\n这仍然小于 98%，所以我们需要更多的主成分。\n\n第五步：加上第五个主成分（PC5）。\n累积方差是 PC1、PC2、PC3、PC4 和 PC5 方差之和。\n累积方差 = 96.41% + 2.57% = 98.98%。\n这个值 98.98% 大于所要求的 98% 的阈值。\n\n因此，必须保留的最小主成分数量是 5。我们不需要考虑 PC6，因为条件已经满足。", "answer": "$$\\boxed{5}$$", "id": "1461616"}, {"introduction": "任何强大的分析工具都有其正确的使用前提，PCA也不例外，它旨在分析数据集内部的方差结构，而非其在坐标系中的绝对位置。本练习 [@problem_id:1383917] 是一个至关重要的思想实验，它揭示了如果在执行PCA前忘记对数据进行“均值中心化”处理，将会产生怎样的误导性结果。通过这个例子，你将看到第一主成分的方向会错误地指向数据的质心，而不是真实的最大方差方向，这强调了数据预处理在获得有意义分析结果中的决定性作用。", "problem": "一位分析师正在研究一个包含三个二维数据点的数据集：$P_1 = (99, 98)$、$P_2 = (100, 100)$ 和 $P_3 = (101, 102)$。他们打算使用主成分分析 (Principal Component Analysis, PCA) 这一降维技术，来寻找数据中方差最大的方向。\n\n寻找主成分的标准教科书步骤如下：\n1.  计算数据点的均值向量（质心）$\\boldsymbol{\\mu}$。\n2.  通过从每个数据点 $\\mathbf{p}_i$ 中减去 $\\boldsymbol{\\mu}$ 来对数据进行均值中心化，得到中心化后的点 $\\mathbf{p}'_i = \\mathbf{p}_i - \\boldsymbol{\\mu}$。\n3.  计算中心化数据的协方差矩阵 $C$。对于 $N$ 个数据点，协方差矩阵由 $C = \\frac{1}{N-1} \\sum_{i=1}^{N} \\mathbf{p}'_i (\\mathbf{p}'_i)^T$ 给出。\n4.  主成分是协方差矩阵 $C$ 的归一化特征向量。第一主成分是对应于最大特征值的特征向量。\n\n我们用 $\\mathbf{v}_{\\text{correct}}$ 表示使用此正确步骤找到的第一主成分向量。\n\n现在，考虑一个有缺陷的步骤，分析师忘记了对数据进行均值中心化（即，他们跳过了第 2 步）。在这种不正确的方法中，他们直接从原始（未中心化的）数据点 $\\mathbf{p}_i$ 计算一个矩阵 $S$：\n$$S = \\sum_{i=1}^{3} \\mathbf{p}_i (\\mathbf{p}_i)^T$$\n然后他们找到 $S$ 对应于最大特征值的特征向量，并称之为“第一主成分”。我们用 $\\mathbf{v}_{\\text{incorrect}}$ 表示这个错误得到的向量。\n\n以下哪个陈述最能描述向量 $\\mathbf{v}_{\\text{incorrect}}$ 的方向？\n\nA. $\\mathbf{v}_{\\text{incorrect}}$ 大致平行于向量 $\\begin{pmatrix} 1 \\\\ 2 \\end{pmatrix}$。\n\nB. $\\mathbf{v}_{\\text{incorrect}}$ 大致平行于向量 $\\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$。\n\nC. $\\mathbf{v}_{\\text{incorrect}}$ 大致平行于向量 $\\begin{pmatrix} -2 \\\\ 1 \\end{pmatrix}$。\n\nD. $\\mathbf{v}_{\\text{incorrect}}$ 大致是零向量。\n\nE. $\\mathbf{v}_{\\text{incorrect}}$ 与 $\\mathbf{v}_{\\text{correct}}$ 相同。", "solution": "问题要求我们在省略了关键的均值中心化步骤时，确定数据集的第一主成分的方向，并将其与提供的选项进行比较。我们将分析正确和不正确的两种步骤。数据点以列向量形式给出：$\\mathbf{p}_1 = \\begin{pmatrix} 99 \\\\ 98 \\end{pmatrix}$、$\\mathbf{p}_2 = \\begin{pmatrix} 100 \\\\ 100 \\end{pmatrix}$ 和 $\\mathbf{p}_3 = \\begin{pmatrix} 101 \\\\ 102 \\end{pmatrix}$。\n\n首先，让我们分析正确的步骤，以理解方差的真实方向。\n第 1 步：计算均值向量 $\\boldsymbol{\\mu}$。\n$$ \\boldsymbol{\\mu} = \\frac{1}{3}(\\mathbf{p}_1 + \\mathbf{p}_2 + \\mathbf{p}_3) = \\frac{1}{3} \\begin{pmatrix} 99+100+101 \\\\ 98+100+102 \\end{pmatrix} = \\frac{1}{3} \\begin{pmatrix} 300 \\\\ 300 \\end{pmatrix} = \\begin{pmatrix} 100 \\\\ 100 \\end{pmatrix} $$\n第 2 步：对数据点进行均值中心化 $\\mathbf{p}'_i = \\mathbf{p}_i - \\boldsymbol{\\mu}$。\n$$ \\mathbf{p}'_1 = \\begin{pmatrix} 99 \\\\ 98 \\end{pmatrix} - \\begin{pmatrix} 100 \\\\ 100 \\end{pmatrix} = \\begin{pmatrix} -1 \\\\ -2 \\end{pmatrix} $$\n$$ \\mathbf{p}'_2 = \\begin{pmatrix} 100 \\\\ 100 \\end{pmatrix} - \\begin{pmatrix} 100 \\\\ 100 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix} $$\n$$ \\mathbf{p}'_3 = \\begin{pmatrix} 101 \\\\ 102 \\end{pmatrix} - \\begin{pmatrix} 100 \\\\ 100 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 2 \\end{pmatrix} $$\n第 3 步：计算协方差矩阵 $C = \\frac{1}{N-1} \\sum_{i=1}^{N} \\mathbf{p}'_i (\\mathbf{p}'_i)^T$。这里 $N=3$。\n$$ C = \\frac{1}{2} \\left[ \\begin{pmatrix} -1 \\\\ -2 \\end{pmatrix} \\begin{pmatrix} -1 & -2 \\end{pmatrix} + \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix} \\begin{pmatrix} 0 & 0 \\end{pmatrix} + \\begin{pmatrix} 1 \\\\ 2 \\end{pmatrix} \\begin{pmatrix} 1 & 2 \\end{pmatrix} \\right] $$\n$$ C = \\frac{1}{2} \\left[ \\begin{pmatrix} 1 & 2 \\\\ 2 & 4 \\end{pmatrix} + \\begin{pmatrix} 0 & 0 \\\\ 0 & 0 \\end{pmatrix} + \\begin{pmatrix} 1 & 2 \\\\ 2 & 4 \\end{pmatrix} \\right] = \\frac{1}{2} \\begin{pmatrix} 2 & 4 \\\\ 4 & 8 \\end{pmatrix} = \\begin{pmatrix} 1 & 2 \\\\ 2 & 4 \\end{pmatrix} $$\n第 4 步：找到 $C$ 的特征向量。特征方程为 $\\det(C - \\lambda I) = 0$。\n$$ (1-\\lambda)(4-\\lambda) - (2)(2) = 0 \\implies 4 - 5\\lambda + \\lambda^2 - 4 = 0 \\implies \\lambda(\\lambda-5) = 0 $$\n特征值为 $\\lambda_1 = 5$ 和 $\\lambda_2 = 0$。第一主成分 $\\mathbf{v}_{\\text{correct}}$ 是对应于较大特征值 $\\lambda_1=5$ 的特征向量。\n$$ (C-5I)\\mathbf{v} = \\mathbf{0} \\implies \\begin{pmatrix} 1-5 & 2 \\\\ 2 & 4-5 \\end{pmatrix} \\begin{pmatrix} v_x \\\\ v_y \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix} \\implies \\begin{pmatrix} -4 & 2 \\\\ 2 & -1 \\end{pmatrix} \\begin{pmatrix} v_x \\\\ v_y \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix} $$\n这给出了方程 $-4v_x + 2v_y = 0$，简化为 $v_y = 2v_x$。所以，特征向量是 $\\begin{pmatrix} 1 \\\\ 2 \\end{pmatrix}$ 的任何标量倍数。因此，$\\mathbf{v}_{\\text{correct}}$ 平行于 $\\begin{pmatrix} 1 \\\\ 2 \\end{pmatrix}$。这与选项 A 匹配。然而，问题问的是 $\\mathbf{v}_{\\text{incorrect}}$。\n\n现在，我们分析不正确的步骤。矩阵 $S$ 是根据原始数据点计算的：$S = \\sum_{i=1}^{3} \\mathbf{p}_i (\\mathbf{p}_i)^T$。\n让我们将 $\\mathbf{p}_i = \\boldsymbol{\\mu} + \\mathbf{p}'_i$ 代入 $S$ 的表达式中：\n$$ S = \\sum_{i=1}^{3} (\\boldsymbol{\\mu} + \\mathbf{p}'_i) (\\boldsymbol{\\mu} + \\mathbf{p}'_i)^T = \\sum_{i=1}^{3} (\\boldsymbol{\\mu}\\boldsymbol{\\mu}^T + \\boldsymbol{\\mu}(\\mathbf{p}'_i)^T + \\mathbf{p}'_i\\boldsymbol{\\mu}^T + \\mathbf{p}'_i(\\mathbf{p}'_i)^T) $$\n分配求和：\n$$ S = \\sum_{i=1}^{3} \\boldsymbol{\\mu}\\boldsymbol{\\mu}^T + \\boldsymbol{\\mu}\\left(\\sum_{i=1}^{3} \\mathbf{p}'_i\\right)^T + \\left(\\sum_{i=1}^{3} \\mathbf{p}'_i\\right)\\boldsymbol{\\mu}^T + \\sum_{i=1}^{3} \\mathbf{p}'_i(\\mathbf{p}'_i)^T $$\n根据中心化数据的定义，$\\sum_{i=1}^{3} \\mathbf{p}'_i = \\mathbf{0}$。所以中间两项消失了。\n$$ S = N\\boldsymbol{\\mu}\\boldsymbol{\\mu}^T + \\sum_{i=1}^{3} \\mathbf{p}'_i(\\mathbf{p}'_i)^T $$\n根据 $C$ 的定义，我们有 $\\sum \\mathbf{p}'_i(\\mathbf{p}'_i)^T = (N-1)C$。\n$$ S = N\\boldsymbol{\\mu}\\boldsymbol{\\mu}^T + (N-1)C $$\n现在我们可以计算这个和的两个部分。\n$$ N\\boldsymbol{\\mu}\\boldsymbol{\\mu}^T = 3 \\begin{pmatrix} 100 \\\\ 100 \\end{pmatrix} \\begin{pmatrix} 100 & 100 \\end{pmatrix} = 3 \\begin{pmatrix} 10000 & 10000 \\\\ 10000 & 10000 \\end{pmatrix} = \\begin{pmatrix} 30000 & 30000 \\\\ 30000 & 30000 \\end{pmatrix} $$\n$$ (N-1)C = 2C = 2 \\begin{pmatrix} 1 & 2 \\\\ 2 & 4 \\end{pmatrix} = \\begin{pmatrix} 2 & 4 \\\\ 4 & 8 \\end{pmatrix} $$\n将这两个矩阵相加得到 $S$：\n$$ S = \\begin{pmatrix} 30000 & 30000 \\\\ 30000 & 30000 \\end{pmatrix} + \\begin{pmatrix} 2 & 4 \\\\ 4 & 8 \\end{pmatrix} = \\begin{pmatrix} 30002 & 30004 \\\\ 30004 & 30008 \\end{pmatrix} $$\n第一项 $N\\boldsymbol{\\mu}\\boldsymbol{\\mu}^T$ 的矩阵元素远大于第二项 $(N-1)C$ 的元素。矩阵 $S$ 由 $N\\boldsymbol{\\mu}\\boldsymbol{\\mu}^T$ 主导。像 $\\boldsymbol{\\mu}\\boldsymbol{\\mu}^T$ 这样的秩为 1 的矩阵的主导特征向量是向量 $\\boldsymbol{\\mu}$ 本身。因为扰动 $(N-1)C$ 相对较小，所以 $S$ 的主导特征向量将非常接近 $N\\boldsymbol{\\mu}\\boldsymbol{\\mu}^T$ 的主导特征向量。\n$N\\boldsymbol{\\mu}\\boldsymbol{\\mu}^T$ 的主导特征向量是 $\\boldsymbol{\\mu} = \\begin{pmatrix} 100 \\\\ 100 \\end{pmatrix}$，它平行于 $\\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$。\n因此，$\\mathbf{v}_{\\text{incorrect}}$ 必定大致平行于 $\\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$。\n\n这从概念上解释了为什么忘记对数据进行均值中心化是有问题的：由此产生的“主成分”主要指向从原点到数据云质心的方向，而不是数据内部方差的方向。\n\n将我们的结果与给定的选项进行比较：\nA. $\\begin{pmatrix} 1 \\\\ 2 \\end{pmatrix}$：这是 $\\mathbf{v}_{\\text{correct}}$ 的方向。\nB. $\\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$：这是均值向量 $\\boldsymbol{\\mu}$ 的方向，我们确定它主导了 $\\mathbf{v}_{\\text{incorrect}}$。\nC. $\\begin{pmatrix} -2 \\\\ 1 \\end{pmatrix}$：这个向量与 $\\mathbf{v}_{\\text{correct}}$ 正交，代表了中心化数据的第二主成分。\nD. 零向量：主成分是一个方向，必须是非零向量。\nE. 与 $\\mathbf{v}_{\\text{correct}}$ 相同：这显然是错误的，因为 $\\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$ 不平行于 $\\begin{pmatrix} 1 \\\\ 2 \\end{pmatrix}$。\n\n因此，向量 $\\mathbf{v}_{\\text{incorrect}}$ 大致平行于 $\\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$。", "answer": "$$\\boxed{B}$$", "id": "1383917"}]}