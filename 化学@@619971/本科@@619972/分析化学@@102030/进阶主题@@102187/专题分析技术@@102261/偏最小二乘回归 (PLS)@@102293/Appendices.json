{"hands_on_practices": [{"introduction": "构建任何校正模型后，首要任务是评估其性能。这个练习将指导你计算校正均方根误差（$RMSEC$），这是一个核心指标，用于量化模型对用于训练它的数据的拟合程度。通过亲手计算这个值，你将深入理解预测误差的概念，并掌握评估模型性能的基础技能`[@problem_id:1459311]`。", "problem": "一位分析化学家正在开发一种使用光谱法的快速质量控制方法，用于测量药物制剂中一种关键活性成分的浓度。该校准模型使用偏最小二乘 (PLS) 回归建立，这是一种将光谱数据与分析物浓度相关联的多变量统计方法。为了评估该校准模型的性能，测量了五个浓度精确已知的标准样品。然后，PLS 模型预测了这五个相同样品的浓度。实际（参考）浓度和 PLS 预测的浓度如下所示。\n\n实际浓度 (mg/mL):\n1.25, 1.40, 1.52, 1.68, 1.81\n\n预测浓度 (mg/mL):\n1.22, 1.43, 1.55, 1.65, 1.83\n\n计算该模型的校准均方根误差 (RMSEC)。您的答案请以 mg/mL 为单位，并四舍五入到三位有效数字。", "solution": "校准均方根误差 (RMSEC) 是一个用于评估校准模型性能的指标，它通过量化校准集中已知（实际）值与模型预测值之间的平均差异来计算。\n\nRMSEC 的计算公式为：\n$$\n\\text{RMSEC} = \\sqrt{\\frac{\\sum_{i=1}^{n} (y_{i, \\text{actual}} - y_{i, \\text{predicted}})^{2}}{n}}\n$$\n其中，$y_{i, \\text{actual}}$ 是第 $i$ 个样品的实际浓度，$y_{i, \\text{predicted}}$ 是模型为第 $i$ 个样品预测的浓度，$n$ 是校准集中的样品总数。\n\n在本题中，我们有 $n=5$ 个样品。让我们计算每个样品的差值平方。\n\n步骤 1：计算每个样品的差值 ($y_{i, \\text{actual}} - y_{i, \\text{predicted}}$)。\n- 样品 1: $1.25 - 1.22 = 0.03$ mg/mL\n- 样品 2: $1.40 - 1.43 = -0.03$ mg/mL\n- 样品 3: $1.52 - 1.55 = -0.03$ mg/mL\n- 样品 4: $1.68 - 1.65 = 0.03$ mg/mL\n- 样品 5: $1.81 - 1.83 = -0.02$ mg/mL\n\n步骤 2：将这些差值分别平方。\n- 样品 1: $(0.03)^{2} = 0.0009$ $(\\text{mg/mL})^2$\n- 样品 2: $(-0.03)^{2} = 0.0009$ $(\\text{mg/mL})^2$\n- 样品 3: $(-0.03)^{2} = 0.0009$ $(\\text{mg/mL})^2$\n- 样品 4: $(0.03)^{2} = 0.0009$ $(\\text{mg/mL})^2$\n- 样品 5: $(-0.02)^{2} = 0.0004$ $(\\text{mg/mL})^2$\n\n步骤 3：将差值的平方相加（误差平方和，SSE）。\n$$\n\\sum_{i=1}^{5} (y_{i, \\text{actual}} - y_{i, \\text{predicted}})^{2} = 0.0009 + 0.0009 + 0.0009 + 0.0009 + 0.0004 = 0.0040 \\ (\\text{mg/mL})^2\n$$\n\n步骤 4：将总和除以样品数量 $n=5$，得到均方误差 (MSE)。\n$$\n\\text{MSE} = \\frac{0.0040}{5} = 0.0008 \\ (\\text{mg/mL})^2\n$$\n\n步骤 5：对 MSE 取平方根，得到 RMSEC。\n$$\n\\text{RMSEC} = \\sqrt{0.0008} \\approx 0.02828427... \\ \\text{mg/mL}\n$$\n\n步骤 6：按要求将最终答案四舍五入到三位有效数字。\n第一位有效数字是 2，第二位是 8，第三位是 2。后一位数字是 8，大于或等于 5，因此我们对最后一位有效数字进行向上取整。\n$$\n\\text{RMSEC} \\approx 0.0283 \\ \\text{mg/mL}\n$$", "answer": "$$\\boxed{0.0283}$$", "id": "1459311"}, {"introduction": "一个模型的预测能力差，其根本原因可能不止一种。这个思想实验旨在训练你一项至关重要的数据分析诊断技能：仅通过观察训练误差（$RMSEC$）和预测误差（$RMSEP$）的特征，来区分模型是“欠拟合”（过于简单）还是“过拟合”（过于复杂）。掌握这项技能对于确定如何优化模型（例如，选择合适的潜变量数量）至关重要`[@problem_id:1459317]`。", "problem": "一位分析化学家正在使用偏最小二乘 (PLS) 回归法开发一个定量模型，用于测定液体剂型中活性药物成分 (API) 的浓度。该模型使用近红外 (NIR) 光谱作为预测变量 ($X$)，并使用已知的 API 浓度作为响应变量 ($Y$)。\n\n该化学家构建了一个仅使用一个潜变量的初始 PLS 模型。为了评估其性能，他们计算了训练数据集上的校正均方根误差 (RMSEC) 和独立验证数据集上的预测均方根误差 (RMSEP)。该化学家观察到 RMSEC 和 RMSEP 都高得令人无法接受，并且它们的值非常接近。\n\n根据这一观察，以下哪个陈述为该模型性能不佳提供了最可能的诊断？\n\nA. 模型对训练数据过拟合，因为它捕获的是随机噪声，而不是光谱与浓度之间的系统性关系。\n\nB. 模型对数据欠拟合，因为单个潜变量不足以捕获光谱数据中与浓度相关的复杂方差。\n\nC. 验证集中的浓度超出了校正集中使用的浓度范围，使得准确预测成为不可能。\n\nD. NIR 光谱主要由随机仪器噪声主导，该噪声远大于与 API 相关的信号，因此无法建立有意义的模型。", "solution": "本题的目标是根据校正和验证数据集的误差指标，来诊断偏最小二乘 (PLS) 回归模型的性能。\n\n首先，我们来理解一些关键概念。PLS 是一种多元回归技术，它对一组预测变量（$X$，即光谱）和一个或多个响应变量（$Y$，即浓度）之间的关系进行建模。它通过构建一组正交的潜变量 (LV) 来实现这一目的，这些潜变量是原始预测变量的线性组合。选择这些潜变量是为了最大化 $X$ 和 $Y$ 之间的协方差。\n\nPLS 模型中使用的潜变量数量决定了其复杂度。\n- 潜变量过少的模型是一个简单的模型。它可能不够复杂，无法捕获数据中所有与预测相关的系统性变异。这种情况被称为**欠拟合 (underfitting)**。一个欠拟合的模型在它所训练的数据上表现不佳，在新的、未见过的数据上也同样表现不佳。欠拟合的一个关键特征是，训练集上的误差（例如，校正均方根误差，RMSEC）很高，并且独立测试集上的误差（例如，预测均方根误差，RMSEP）也很高，且其量级与训练误差相近 (RMSEC ≈ RMSEP)。\n\n- 潜变量过多的模型是一个过于复杂的模型。它不仅开始拟合训练数据中系统性的、有意义的变异，还开始拟合随机噪声。这种情况被称为**过拟合 (overfitting)**。一个过拟合的模型在训练数据上表现得非常好（RMSEC 非常低），但在新的、未见过的数据上表现不佳，因为它在训练集中学到的噪声在新数据中并不存在。过拟合的一个关键特征是 RMSEC 非常低，而 RMSEP 显著更高。\n\n在所描述的情景中，该化学家构建了一个仅含一个潜变量的 PLS 模型。他们发现 RMSEC 和 RMSEP 都很高，且数值上彼此接近。这种模式——在训练集和验证集上都有高误差——是欠拟合模型的经典标志。该模型过于简单，无法充分描述 NIR 光谱与 API 浓度之间的关系。单个潜变量不足以捕获必要的信息。\n\n我们来评估给出的选项：\n\nA. 模型过拟合。这是不正确的。过拟合的特征是 RMSEC 非常低而 RMSEP 很高，这与观察到的 RMSEC 和 RMSEP 都很高且相近的结果相矛盾。过拟合通常发生在使用了*太多*潜变量时，而不是太少。\n\nB. 模型欠拟合。这是正确的。观察到高且相近的 RMSEC 和 RMSEP 是欠拟合模型的明确标志。对于一个复杂的剂型，单个潜变量很可能不足以捕获与 API 浓度相关的光谱特征。\n\nC. 验证集的浓度超出了校正范围。虽然这肯定会导致高 RMSEP（一个外推问题），但它无法解释为何校正集上的 RMSEC 也高得令人无法接受。高 RMSEC 表明模型未能描述训练数据本身，这指向一个根本性的模型缺陷（欠拟合），而不仅仅是验证集的问题。\n\nD. 数据被噪声主导，因此无法建立模型。虽然高噪声会降低模型性能，但给出的诊断信息（RMSEC ≈ RMSEP 且两者都高）明确指出了欠拟合是*这个特定模型构建*（仅使用一个 LV）的主要问题。很可能一个更复杂的模型（具有更多 LV）可以从噪声中提取信号并表现得更好。这个选项暗示数据是无用的，这是一个比证据所支持的更极端的结论。最直接的诊断是模型的复杂度太低。\n\n因此，最准确的诊断是模型对数据欠拟合。", "answer": "$$\\boxed{B}$$", "id": "1459317"}, {"introduction": "在现实世界的化学计量学应用中，原始数据往往含有噪声和无关变异，必须通过预处理来消除。本练习模拟了一个常见的分析挑战：如何为存在样品浊度等基质效应的光谱数据选择最佳的预处理方法。你将使用交叉验证均方根误差（$RMSECV$）这一稳健的指标，来客观地比较不同策略的有效性，并做出数据驱动的决策`[@problem_id:1459349]`。", "problem": "一位分析化学家的任务是开发一种快速、无损的方法，使用近红外（NIR）光谱法来定量浑浊发酵液中一种新型非蛋白质氨基酸“isovaline”的浓度。样品的高浊度会引入显著的基线漂移和光散射效应，这会破坏光谱数据并降低定量模型的性能。\n\n为了减轻这些问题，正在开发一个偏最小二乘（PLS）回归模型。该化学家决定比较两种常见的光谱预处理技术，以确定哪种技术在处理样品基质效应方面更有效：\n1.  标准正态变量（Standard Normal Variate, SNV）：一种对每个单独光谱进行中心化和缩放的方法。\n2.  Savitzky-Golay二阶导数（SG-2）：应用一个15点窗口和2阶多项式的数字滤波器。\n\n为了评估每种预处理步骤产生的PLS模型的预测性能，使用了一组5个校准样品，这些样品的isovaline浓度已知（通过较慢的高效液相色谱参考方法测定）。执行了留一法交叉验证（LOOCV）程序。在LOOCV中，使用5个样品中的4个来建立一个模型，并预测被留出的那个样品的浓度。这个过程重复5次，每个样品都被留出一次。\n\n下面提供了经SNV预处理和SG-2预处理的模型的真实参考浓度以及相应的LOOCV预测浓度。所有浓度单位均为毫克/升（mg/L）。\n\n| 样品ID | 真实浓度 (mg/L) | 预测浓度 (SNV模型) | 预测浓度 (SG-2模型) |\n|-----------|-----------------------------|-------------------------------|--------------------------------|\n| 1         | 12.5                        | 13.1                          | 14.5                           |\n| 2         | 25.0                        | 24.2                          | 22.1                           |\n| 3         | 37.5                        | 38.5                          | 40.2                           |\n| 4         | 50.0                        | 48.9                          | 53.6                           |\n| 5         | 62.5                        | 63.8                          | 59.9                           |\n\n你的任务是确定哪种预处理方法能产生更准确的预测模型。为此，你必须计算两种模型的交叉验证均方根误差（RMSECV）。RMSECV的定义为 $\\sqrt{\\frac{\\sum_{i=1}^{n} (y_{\\text{pred},i} - y_{\\text{true},i})^2}{n}}$，其中 $y_{\\text{pred},i}$ 是第 $i$ 个样品的预测浓度，$y_{\\text{true},i}$ 是第 $i$ 个样品的真实浓度，$n$ 是样品总数。产生较低RMSECV的预处理方法被认为是更优的。\n\n报告更优预处理方法的RMSECV。你的最终答案以 mg/L 为单位，并四舍五入到三位有效数字。", "solution": "题目要求我们计算用不同光谱预处理方法建立的两个PLS模型的交叉验证均方根误差（RMSECV），然后报告更优方法（即RMSECV较低者）的RMSECV。对于一个包含 $n$ 个样品、预测值为 $y_{\\text{pred},i}$、真实值为 $y_{\\text{true},i}$ 的模型，其RMSECV定义如下：\n$$\n\\mathrm{RMSECV}=\\sqrt{\\frac{\\sum_{i=1}^{n}\\left(y_{\\text{pred},i}-y_{\\text{true},i}\\right)^{2}}{n}}.\n$$\n此处，$n=5$。\n\n计算经SNV预处理的模型的RMSECV。样品 $i=1$ 到 $5$ 的预测误差为：\n$$\n\\begin{aligned}\n\\epsilon_{1} &= 13.1-12.5=0.6,\\\\\n\\epsilon_{2} &= 24.2-25.0=-0.8,\\\\\n\\epsilon_{3} &= 38.5-37.5=1.0,\\\\\n\\epsilon_{4} &= 48.9-50.0=-1.1,\\\\\n\\epsilon_{5} &= 63.8-62.5=1.3.\n\\end{aligned}\n$$\n将误差平方并求和：\n$$\n\\sum_{i=1}^{5}\\epsilon_{i}^{2}=0.6^{2}+(-0.8)^{2}+1.0^{2}+(-1.1)^{2}+1.3^{2}=0.36+0.64+1.00+1.21+1.69=4.90.\n$$\n计算均方误差及其平方根：\n$$\n\\mathrm{MSE}=\\frac{4.90}{5}=0.98,\\quad \\mathrm{RMSECV}_{\\mathrm{SNV}}=\\sqrt{0.98}\\approx 0.989949\\ldots\n$$\n因此，保留三位有效数字，$\\mathrm{RMSECV}_{\\mathrm{SNV}}=0.990$。\n\n计算经SG-2预处理的模型的RMSECV。预测误差为：\n$$\n\\begin{aligned}\n\\epsilon_{1} &= 14.5-12.5=2.0,\\\\\n\\epsilon_{2} &= 22.1-25.0=-2.9,\\\\\n\\epsilon_{3} &= 40.2-37.5=2.7,\\\\\n\\epsilon_{4} &= 53.6-50.0=3.6,\\\\\n\\epsilon_{5} &= 59.9-62.5=-2.6.\n\\end{aligned}\n$$\n平方并求和：\n$$\n\\sum_{i=1}^{5}\\epsilon_{i}^{2}=2.0^{2}+(-2.9)^{2}+2.7^{2}+3.6^{2}+(-2.6)^{2}=4.00+8.41+7.29+12.96+6.76=39.42.\n$$\n计算均方误差及平方根：\n$$\n\\mathrm{MSE}=\\frac{39.42}{5}=7.884,\\quad \\mathrm{RMSECV}_{\\mathrm{SG\\text{-}2}}=\\sqrt{7.884}\\approx 2.81.\n$$\n比较显示 $\\mathrm{RMSECV}_{\\mathrm{SNV}}\\approx 0.990$，而 $\\mathrm{RMSECV}_{\\mathrm{SG\\text{-}2}}\\approx 2.81$。因此，SNV产生了较低的RMSECV，是更优的预处理方法。题目要求输出更优方法的RMSECV，单位为mg/L，并保留三位有效数字，所以我们报告$0.990$。", "answer": "$$\\boxed{0.990}$$", "id": "1459349"}]}