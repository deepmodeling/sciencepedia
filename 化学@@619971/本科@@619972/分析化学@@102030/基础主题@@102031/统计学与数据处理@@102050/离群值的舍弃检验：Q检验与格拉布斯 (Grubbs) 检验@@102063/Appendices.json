{"hands_on_practices": [{"introduction": "在分析化学实验中，我们经常会遇到个别数据点与其余数据显著偏离的情况。Q检验是一种简单快捷的统计方法，尤其适用于处理小样本（$n=3-10$）中的可疑数据。这个练习将带你完成一次基础的Q检验计算，模拟在质量控制中对一个可疑的密度测量值进行判断，帮助你掌握Q检验的核心步骤：计算$Q$值并将其与临界值进行比较。[@problem_id:1479855]", "problem": "一名分析化学专业的学生正在对一批新溶剂进行质量控制检查。该溶剂的密度是一个关键参数。学生对该溶剂的密度进行了五次重复测量，得到以下结果（单位：g/mL）：0.8512、0.8509、0.8515、0.8421 和 0.8510。学生怀疑最低的测量值 0.8421 g/mL 可能由于操作失误而成为一个离群值。\n\n为了客观地评估这一怀疑，学生决定应用 Dixon's Q 检验。对于这个大小（n=5）的数据集，在 95% 置信水平下的临界 Q 值（$Q_{\\text{crit}}$）为 0.710。\n\n根据这些信息，以下哪个选项正确报告了计算出的 Q 统计量（$Q_{\\text{calc}}$）（四舍五入到三位有效数字）以及关于可疑数据点的相应决策？\n\nA. $Q_{\\text{calc}} = 0.011$；保留该值。\n\nB. $Q_{\\text{calc}} = 0.936$；舍弃该值。\n\nC. $Q_{\\text{calc}} = 0.936$；保留该值。\n\nD. $Q_{\\text{calc}} = 0.710$；舍弃该值。\n\nE. $Q_{\\text{calc}} = 1.000$；舍弃该值。", "solution": "我们首先将测量值按升序排列：\n$$x_{(1)}=0.8421,\\; x_{(2)}=0.8509,\\; x_{(3)}=0.8510,\\; x_{(4)}=0.8512,\\; x_{(5)}=0.8515.$$\n可疑离群值是最小值 $x_{(1)}$。对于 Dixon's Q 检验，当怀疑存在一个低值离群值时，其检验统计量定义为\n$$Q_{\\text{calc}}=\\frac{x_{(2)}-x_{(1)}}{x_{(5)}-x_{(1)}}.$$\n计算分子（间隙）和分母（极差）：\n$$\\text{gap}=x_{(2)}-x_{(1)}=0.8509-0.8421=0.0088,$$\n$$\\text{range}=x_{(5)}-x_{(1)}=0.8515-0.8421=0.0094.$$\n因此，\n$$Q_{\\text{calc}}=\\frac{0.0088}{0.0094}=\\frac{88}{94}\\approx 0.936.$$\n在 0.95 置信水平下，对于 $n=5$，给出的临界值为 $Q_{\\text{crit}}=0.710$。由于\n$$Q_{\\text{calc}} \\approx 0.936 > Q_{\\text{crit}}=0.710,$$\n我们将该可疑值作为离群值舍弃。这与选项 B 相符，该选项报告 $Q_{\\text{calc}}=0.936$（保留三位有效数字）并且决策为舍弃该值。", "answer": "$$\\boxed{B}$$", "id": "1479855"}, {"introduction": "当数据集中出现多个可疑值时，我们不能简单地将它们全部剔除。正确的做法是使用格拉布斯（Grubbs）检验，并采用序贯法，即一次只检验一个离群最远的点。本练习模拟了药品质量控制中的真实场景，你将学习如何通过序贯应用格拉布斯检验来处理两个潜在的低值异常点，这对于培养严谨的数据处理习惯至关重要。[@problem_id:1479860]", "problem": "一家制药公司的质量控制化学家正在分析一批新的片剂，以验证其中活性药物成分 (API) 的含量。从该批次中随机抽取十片片剂，并测量每片中 API 的质量。得到以下结果，单位为毫克 (mg)：\n\n100.3, 99.8, 100.1, 99.5, 100.5, 100.2, 99.9, 100.7, 98.2, 96.5\n\n该化学家注意到，其中两个测量值 96.5 mg 和 98.2 mg 与其他值相比异常偏低，并怀疑它们可能是离群值。为做出统计上可靠的决策，该化学家决定应用 Grubbs 检验来识别并可能剔除离群值。此检验应按顺序进行，从最极端的值开始。如果某个值被剔除，应将其从数据集中移除，然后再检验下一个潜在的离群值。\n\nGrubbs 检验的检验统计量 $G$ 按以下公式计算：\n$$G = \\frac{|\\text{suspect value} - \\bar{x}|}{s}$$\n其中 $\\bar{x}$ 是样本均值，而 $s$ 是样本标准差。如果计算出的 $G$ 值 ($G_{\\text{calc}}$) 在所需的置信水平下大于临界 $G$ 值 ($G_{\\text{critical}}$)，则该值被剔除。\n\n在 95% 置信水平下，Grubbs 检验的临界值为：\n- 对于 $n=10$ 个观测值：$G_{\\text{critical}} = 2.290$\n- 对于 $n=9$ 个观测值：$G_{\\text{critical}} = 2.176$\n\n根据在 95% 置信水平下顺序应用 Grubbs 检验，关于这两个可疑数据点的正确结论是什么？\n\nA. 96.5 mg 和 98.2 mg 两者在统计上都可以作为离群值剔除。\n\nB. 只有 96.5 mg 可以被剔除；98.2 mg 必须保留。\n\nC. 96.5 mg 和 98.2 mg 两者都不能被剔除。\n\nD. 只有 98.2 mg 可以被剔除；96.5 mg 必须保留。\n\nE. 测量值 96.5 mg 可以被剔除，但必须使用不同的置信水平重新应用检验来评估 98.2 mg。", "solution": "我们按顺序应用 Grubbs 检验，从最极端的值开始，使用检验统计量\n$$G=\\frac{|x_{\\text{suspect}}-\\bar{x}|}{s},$$\n其中 $\\bar{x}$ 是样本均值， $s$ 是以 $n-1$ 为分母计算的样本标准差：\n$$\\bar{x}=\\frac{1}{n}\\sum_{i=1}^{n}x_{i},\\quad s=\\sqrt{\\frac{1}{n-1}\\sum_{i=1}^{n}(x_{i}-\\bar{x})^{2}}.$$\n\n第一次检验（$n=10$，包含所有值）。数据为 $100.3, 99.8, 100.1, 99.5, 100.5, 100.2, 99.9, 100.7, 98.2, 96.5$。计算：\n$$\\bar{x}=\\frac{995.7}{10}=99.57,$$\n$$\\sum_{i=1}^{10}(x_{i}-\\bar{x})^{2}=14.8210,\\quad s=\\sqrt{\\frac{14.8210}{9}}\\approx 1.2833.$$\n对于最极端的低值 $96.5$：\n$$G_{\\text{calc}}=\\frac{|96.5-99.57|}{1.2833}=\\frac{3.07}{1.2833}\\approx 2.392.$$\n由于 $G_{\\text{calc}}\\approx 2.392 > G_{\\text{critical}}=2.290$（对于 $n=10$ 和给定的置信水平），因此剔除 $96.5$。\n\n第二次检验（移除 $96.5$ 后，现在 $n=9$）。剩余数据为 $100.3, 99.8, 100.1, 99.5, 100.5, 100.2, 99.9, 100.7, 98.2$。计算：\n$$\\bar{x}'=\\frac{899.2}{9}\\approx 99.9111,$$\n$$\\sum_{i=1}^{9}(x_{i}-\\bar{x}')^{2}\\approx 4.348518518,\\quad s'=\\sqrt{\\frac{4.348518518}{8}}\\approx 0.7373.$$\n检验下一个最极端的低值 $98.2$：\n$$G'_{\\text{calc}}=\\frac{|98.2-99.9111|}{0.7373}\\approx \\frac{1.7111}{0.7373}\\approx 2.322.$$\n由于 $G'_{\\text{calc}}\\approx 2.322 > G_{\\text{critical}}=2.176$（对于 $n=9$ 和给定的置信水平），因此剔除 $98.2$。\n\n结论：在给定的置信水平下，通过顺序 Grubbs 检验，96.5 mg 和 98.2 mg 均被作为离群值剔除，这对应于选项 A。", "answer": "$$\\boxed{A}$$", "id": "1479860"}, {"introduction": "离群值检验的一个关键前提是，数据应服从正态分布。然而，在环境分析等领域，数据（如痕量元素浓度）常呈现对数正态分布。本练习旨在探讨数据分布对离群值检验结果的影响，通过对原始数据和对数转换后的数据分别进行格拉布斯检验，你将深刻体会到数据预处理的重要性，并学会在应用统计工具前，首先审视数据自身的特性。[@problem_id:1479839]", "problem": "一位环境化学家正在分析土壤样品中的痕量镉 (Cd) 浓度。对一份均质化的土壤样品进行五次重复分析后，获得了以下浓度值，单位为纳克/克 (ng/g)：\n\n{10.0, 12.6, 15.8, 20.0, 63.1}\n\n该化学家怀疑最高值 63.1 ng/g 可能是一个异常值。众所周知，环境基质中痕量元素的浓度通常遵循对数正态分布，这意味着浓度的对数值近似呈正态分布。为了研究这个可疑数据点，该化学家决定应用格拉布斯检验 (Grubbs' test) 来检测异常值。\n\n格拉布斯检验统计量 $G_{calc}$ 的计算公式如下：\n$$G_{calc} = \\frac{|x_{suspect} - \\bar{x}|}{s}$$\n其中 $x_{suspect}$ 是可疑异常值，$\\bar{x}$ 是样本均值，而 $s$ 是样本标准差。如果在给定的置信水平下，$G_{calc}$ 大于临界值 $G_{critical}$，则该数据点被判定为异常值并剔除。对于样本量 $N=5$ 和 95% 的置信水平，临界值为 $G_{critical} = 1.672$。\n\n你的任务是分别对原始数据和数据的以10为底的对数值 ($\\log_{10}(x)$) 进行格拉布斯检验。根据你的计算，以下哪个陈述正确描述了从这两种方法中得出的结论？\n\nA. 对原始数据进行检验时，值 63.1 ng/g 被判定为异常值并剔除；对对数转换后的数据进行检验时，该值也被剔除。\n\nB. 对原始数据进行检验时，值 63.1 ng/g 被保留为有效数据点；对对数转换后的数据进行检验时，该值也被保留。\n\nC. 对原始数据进行检验时，值 63.1 ng/g 被判定为异常值并剔除；但对对数转换后的数据进行检验时，该值被保留。\n\nD. 对原始数据进行检验时，值 63.1 ng/g 被保留为有效数据点；但对对数转换后的数据进行检验时，该值被剔除。\n\nE. 在此场景下无法应用格拉布斯检验，因为样本量太小。", "solution": "该问题要求我们对一个数据集进行格拉布斯异常值检验，首先使用原始数据，然后使用对数转换后的数据，最后比较两个结论。数据集为 {10.0, 12.6, 15.8, 20.0, 63.1}，可疑值为 $x_{suspect} = 63.1$，对于样本量 $N=5$ 和 95% 置信水平，给定的格拉布斯临界值为 $G_{critical} = 1.672$。\n\n**第1部分：对原始数据进行格拉布斯检验**\n\n首先，我们分析原始数据：{10.0, 12.6, 15.8, 20.0, 63.1}。\n\n步骤1：计算样本均值 ($\\bar{x}$)。\n$$ \\bar{x} = \\frac{10.0 + 12.6 + 15.8 + 20.0 + 63.1}{5} = \\frac{121.5}{5} = 24.3 $$\n\n步骤2：计算样本标准差 ($s$)。\n样本标准差的公式是 $s = \\sqrt{\\frac{\\sum_{i=1}^{N}(x_i - \\bar{x})^2}{N-1}}$。\n与均值的离差平方和为：\n$$ \\sum(x_i - \\bar{x})^2 = (10.0 - 24.3)^2 + (12.6 - 24.3)^2 + (15.8 - 24.3)^2 + (20.0 - 24.3)^2 + (63.1 - 24.3)^2 $$\n$$ \\sum(x_i - \\bar{x})^2 = (-14.3)^2 + (-11.7)^2 + (-8.5)^2 + (-4.3)^2 + (38.8)^2 $$\n$$ \\sum(x_i - \\bar{x})^2 = 204.49 + 136.89 + 72.25 + 18.49 + 1505.44 = 1937.56 $$\n现在，我们计算方差 ($s^2$) 和标准差 ($s$)：\n$$ s^2 = \\frac{1937.56}{5-1} = \\frac{1937.56}{4} = 484.39 $$\n$$ s = \\sqrt{484.39} \\approx 22.0089 $$\n\n步骤3：计算格拉布斯统计量 ($G_{\\text{calc, raw}}$)。\n$$ G_{\\text{calc, raw}} = \\frac{|x_{suspect} - \\bar{x}|}{s} = \\frac{|63.1 - 24.3|}{22.0089} = \\frac{38.8}{22.0089} \\approx 1.7629 $$\n\n步骤4：将 $G_{\\text{calc, raw}}$ 与 $G_{\\text{critical}}$ 进行比较。\n$$ G_{\\text{calc, raw}} \\approx 1.7629 > G_{\\text{critical}} = 1.672 $$\n由于计算出的 G 统计量大于临界值，原假设（即 63.1 不是异常值）被拒绝。根据原始数据，值 63.1 ng/g 被归类为异常值。\n\n**第2部分：对对数转换后的数据进行格拉布斯检验**\n\n问题指出，痕量元素的浓度通常遵循对数正态分布，因此对数据的对数值应用该检验是一种有效的方法。我们使用以10为底的对数。\n\n步骤1：通过取每个值的以10为底的对数来转换数据。设 $y_i = \\log_{10}(x_i)$。\n$$ y_1 = \\log_{10}(10.0) = 1.0000 $$\n$$ y_2 = \\log_{10}(12.6) \\approx 1.1004 $$\n$$ y_3 = \\log_{10}(15.8) \\approx 1.1987 $$\n$$ y_4 = \\log_{10}(20.0) \\approx 1.3010 $$\n$$ y_5 = \\log_{10}(63.1) \\approx 1.8000 $$\n对数转换后的数据集是 {1.0000, 1.1004, 1.1987, 1.3010, 1.8000}。可疑值为 $y_{suspect} = 1.8000$。\n\n步骤2：计算对数转换后数据的均值 ($\\bar{y}$)。\n$$ \\bar{y} = \\frac{1.0000 + 1.1004 + 1.1987 + 1.3010 + 1.8000}{5} = \\frac{6.4001}{5} = 1.28002 $$\n\n步骤3：计算对数转换后数据的标准差 ($s_y$)。\n与均值的离差平方和为：\n$$ \\sum(y_i - \\bar{y})^2 = (1.0000 - 1.28002)^2 + (1.1004 - 1.28002)^2 + (1.1987 - 1.28002)^2 + (1.3010 - 1.28002)^2 + (1.8000 - 1.28002)^2 $$\n$$ \\sum(y_i - \\bar{y})^2 = (-0.28002)^2 + (-0.17962)^2 + (-0.08132)^2 + (0.02098)^2 + (0.51998)^2 $$\n$$ \\sum(y_i - \\bar{y})^2 \\approx 0.07841 + 0.03226 + 0.00661 + 0.00044 + 0.27038 = 0.3881 $$\n现在，我们计算方差 ($s_y^2$) 和标准差 ($s_y$)：\n$$ s_y^2 = \\frac{0.3881}{5-1} = \\frac{0.3881}{4} = 0.097025 $$\n$$ s_y = \\sqrt{0.097025} \\approx 0.3115 $$\n\n步骤4：计算对数转换后数据的格拉布斯统计量 ($G_{\\text{calc, log}}$)。\n$$ G_{\\text{calc, log}} = \\frac{|y_{suspect} - \\bar{y}|}{s_y} = \\frac{|1.8000 - 1.28002|}{0.3115} = \\frac{0.51998}{0.3115} \\approx 1.6693 $$\n\n步骤5：将 $G_{\\text{calc, log}}$ 与 $G_{\\text{critical}}$ 进行比较。\n$$ G_{\\text{calc, log}} \\approx 1.6693  G_{\\text{critical}} = 1.672 $$\n由于计算出的 G 统计量小于临界值，我们未能拒绝原假设。当对对数转换后的数据应用该检验时，该值被保留为有效数据点。\n\n**结论**\n\n比较两个结果：\n- 原始数据检验：值 63.1 ng/g 被判定为异常值并剔除。\n- 对数转换数据检验：该值被保留。\n\n这与选项 C 相符。通过转换为近似正态分布，“驯服”了那个高值，表明它可能是对数正态分布尾部的一个合理数据点，而在倾斜的原始数据中，它与均值的距离使其看起来像一个错误。", "answer": "$$\\boxed{C}$$", "id": "1479839"}]}