{"hands_on_practices": [{"introduction": "从理论到实践，第一步是理解有效核势（ECP）在计算中究竟做了什么。这个练习旨在让你掌握一个基本但至关重要的技能：对于一个给定的分子，确定在使用ECP时，有多少电子被显式地包含在量子力学计算中。通过计算五氟化磷（$\\text{PF}_5$）分子中的价电子总数，你将把ECP的抽象定义转化为一个具体的数字，这是进行任何ECP计算的前提。[@problem_id:1364323]", "problem": "在现代计算化学中，一种简化多电子分子计算的常用技术是使用有效核势 (ECP)。ECP 近似了化学惰性的核心电子的静电效应，使得量子力学计算可以仅关注化学活性的价电子。\n\n考虑分子五氟化磷 ($\\text{PF}_5$)。对其进行量子化学计算，其中中心的磷原子以及五个氟原子均使用标准的 ECP。对于像磷和氟这样的主族元素，构建“标准”ECP 是为了替代由周期表中紧邻该元素之前的稀有气体的电子构型所定义的核心电子。\n\n已知磷 (P) 的原子序数为 15，氟 (F) 的原子序数为 9，请确定在这次量子力学处理中，整个 $\\text{PF}_5$ 分子里被显式包含的电子总数。", "solution": "有效核势 (ECP) 替代了与该元素之前紧邻的稀有气体相对应的核心电子，只留下价电子进行显式处理。\n\n令 $Z_{\\mathrm{P}}=15$ 和 $Z_{\\mathrm{F}}=9$ 为原子序数。对于磷，其之前的稀有气体是氖，其原子序数 $Z_{\\mathrm{Ne}}=10$；对于氟，其之前的稀有气体是氦，其原子序数 $Z_{\\mathrm{He}}=2$。\n\n每个原子被显式处理的电子（价电子）数可通过减去稀有气体核心的电子数得到：\n$$\nN_{\\mathrm{val}}(\\mathrm{P})=Z_{\\mathrm{P}}-Z_{\\mathrm{Ne}}=15-10=5,\n$$\n$$\nN_{\\mathrm{val}}(\\mathrm{F})=Z_{\\mathrm{F}}-Z_{\\mathrm{He}}=9-2=7.\n$$\n对于 $\\text{PF}_5$，有一个磷原子和五个氟原子，所以被显式包含的电子总数是\n$$\nN_{\\mathrm{QM}}=N_{\\mathrm{val}}(\\mathrm{P})+5\\,N_{\\mathrm{val}}(\\mathrm{F})=5+5\\times 7=40.\n$$\n等效地，从总电子数开始，减去所有核心电子，\n$$\n(Z_{\\mathrm{P}}+5Z_{\\mathrm{F}})-(Z_{\\mathrm{Ne}}+5Z_{\\mathrm{He}})=(15+5\\times 9)-(10+5\\times 2)=60-20=40,\n$$\n这也证实了该结果。", "answer": "$$\\boxed{40}$$", "id": "1364323"}, {"introduction": "有效核势方法极大地降低了计算成本，但它计算出的总能量与全电子（AE）计算的结果有何关系？这个练习是一个思想实验，旨在深化你对ECP能量物理意义的理解。通过比较锡烷（$SnH_4$）分子的ECP能量（$E_{\\text{ECP}}$）和AE能量（$E_{\\text{AE}}$），你将揭示ECP近似的核心：它忽略了能量贡献巨大但化学性质不活泼的芯层电子。[@problem_id:1364281]", "problem": "在计算量子化学中，计算含有重元素的分子电子结构有两种常用方法：全电子 (AE) 计算和使用有效核势 (ECP) 的方法。AE 计算会显式地处理体系中的每一个电子。相比之下，ECP 计算会用一个有效势取代化学惰性的核心电子和强的核势，只显式地处理价电子。这显著降低了计算成本。\n\n考虑四氢化锡分子 SnH$_4$。锡原子 (Sn) 的原子序数为 50。设 $E_{\\text{AE}}$ 表示通过 AE 计算得到的 SnH$_4$ 的总电子基态能量，设 $E_{\\text{ECP}}$ 表示通过用标准 ECP 替换锡原子的核心电子的计算所得到的总电子基态能量。\n\n基于这两种方法的基本原理，以下哪个陈述正确地比较了两种计算得到的总能量，并提供了正确的解释？\n\nA. $E_{\\text{ECP}} < E_{\\text{AE}}$，因为 ECP 近似计算效率更高，这使得对价电子能量的计算更为精确，从而导致更低的总能量。\n\nB. $E_{\\text{ECP}} > E_{\\text{AE}}$，因为 ECP 计算显式地忽略了核心电子的巨大的负结合能，而全电子计算则包含了这部分能量。\n\nC. $E_{\\text{ECP}} > E_{\\text{AE}}$，因为取代核心电子的有效势对价电子平均而言是排斥的，从而增加了体系的总能量。\n\nD. $E_{\\text{ECP}} < E_{\\text{AE}}$，因为全电子计算通过包含核心-价电子排斥而高估了电子-电子排斥，导致了更高（负得更少）的能量。\n\nE. $E_{\\text{ECP}} = E_{\\text{AE}}$，因为一个精心构建的 ECP 旨在完美再现价电子的性质，所以总能量应该匹配。", "solution": "我们比较通过两种方法得到的总电子基态能量：一种是显式处理所有电子的全电子 (AE) 计算，另一种是使用有效势替换 Sn 原子的核心电子、只显式处理价电子的有效核势 (ECP) 计算。\n\n我们将电子自由度划分为核心电子 $C$（在 Sn 上）和价电子 $V$。非相对论电子哈密顿量可以写为\n$$\n\\hat{H}=\\hat{T}+\\hat{V}_{en}+\\hat{V}_{ee},\n$$\nAE 总能量为\n$$\nE_{\\text{AE}}=\\langle \\Psi_{\\text{AE}}|\\hat{H}|\\Psi_{\\text{AE}}\\rangle.\n$$\n按电子子集分解可得\n$$\nE_{\\text{AE}}=E_{C}+E_{V}+E_{CV},\n$$\n其中 $E_{C}$ 包含所有仅涉及核心电子的项（它们的动能、与 Sn 和其他原子核的电子-原子核吸引，以及核心-核心电子排斥），$E_{V}$ 只包含价电子项，而 $E_{CV}$ 包含核心-价电子相互作用项。对于像 Sn 这样的重原子，核心电子被紧密地束缚在原子核上，所以 $E_{C}$ 中的电子-原子核吸引占主导地位，并且\n$$\nE_{C}=\\langle \\Psi_{\\text{AE}}|\\hat{T}_{C}+\\hat{V}_{en}^{C}+\\hat{V}_{ee}^{CC}|\\Psi_{\\text{AE}}\\rangle \\ll 0,\n$$\n即 $E_{C}$ 是一个绝对值很大的负值。\n\n在 ECP 方法中，为显式处理的电子所构建的哈密顿量是\n$$\n\\hat{H}_{\\text{ECP}}=\\hat{T}_{V}+\\hat{V}_{\\text{ECP}}^{\\text{Sn}}+\\hat{V}_{en}^{V,\\text{H}}+\\hat{V}_{ee}^{VV},\n$$\n其中 $\\hat{V}_{\\text{ECP}}^{\\text{Sn}}$ 是一个有效单电子算符，取代了价电子所感受到的 Sn 的显式核心电子和强核势，$\\hat{V}_{en}^{V,\\text{H}}$ 是价电子与氢原子核的吸引作用（以及来自Sn的任何价电子贡献），而 $\\hat{V}_{ee}^{VV}$ 是价-价电子排斥。对应的总能量为\n$$\nE_{\\text{ECP}}=\\langle \\Psi_{\\text{ECP}}|\\hat{H}_{\\text{ECP}}|\\Psi_{\\text{ECP}}\\rangle.\n$$\n根据其构造，一个精心构建的 ECP 能再现核心电子对价电子能量学的影响，因此我们可以写出\n$$\nE_{\\text{ECP}}=(E_{V}+E_{CV})+\\delta,\n$$\n其中 $\\delta$ 表示由 ECP 近似引起的（通常很小的）建模误差，并且重要的是，纯粹的核心电子能量 $E_{C}$ 并未包含在内。\n\n因此，\n$$\nE_{\\text{ECP}}-E_{\\text{AE}}=\\delta-E_{C}.\n$$\n由于 $E_{C}\\ll 0$ 且对于一个好的 ECP 而言 $|\\delta|$ 很小，因此可得出\n$$\nE_{\\text{ECP}}-E_{\\text{AE}}>0 \\quad \\Rightarrow \\quad E_{\\text{ECP}}>E_{\\text{AE}}.\n$$\n\n这直接支持了选项 B。其他选项不正确，原因如下：\n- A 是不正确的，因为计算效率本身不会降低变分能量；此外，ECP 能量忽略了核心电子的贡献，使其能量值更高（即负得更少）。\n- C 是不正确的，因为有效势平均而言并非排斥性的；它被构建用以再现核心电子对价电子的吸引性影响。\n- D 是不正确的，因为 AE 计算不会错误地高估电子-电子排斥；它包含了物理上真实的核心-价电子相互作用，以及占主导地位的核心-原子核吸引作用。\n- E 是不正确的，因为尽管 ECP 旨在再现价电子的性质，但它们不包括巨大的负的核心结合能；因此总能量不匹配。", "answer": "$$\\boxed{B}$$", "id": "1364281"}, {"introduction": "了解一个方法的适用范围和局限性，是科学研究中批判性思维的关键。这个高级练习将引导你通过一个简化的数学模型，来验证为什么ECP不适用于计算依赖于芯层电子密度的性质。通过这个实践，你将从根本上理解，由于ECP的设计初衷是替代原子核附近的波函数，任何对该区域敏感的物理量（如费米接触项）都无法通过ECP方法准确获得。[@problem_id:2454650]", "problem": "要求您在一个数学上严谨的框架下，论证为何使用有效芯势 (ECP) 计算依赖于芯层电子密度的性质会导致无意义的结果。计算完全在原子单位下进行，其中玻尔半径为 $a_0 = 1$。考虑一个核电荷为 $Z$ 的单电子、类氢 $1s$ 态，其归一化的全电子径向波函数为 $\\psi_{1s}(r) = \\left(\\dfrac{Z^3}{\\pi}\\right)^{1/2} e^{-Z r}$，其电子密度为 $\\rho_{\\mathrm{AE}}(r;Z) = \\left|\\psi_{1s}(r)\\right|^2 = \\dfrac{Z^3}{\\pi} e^{-2 Z r}$。定义一个“弥散接触”可观测量（作为 Fermi 接触超精细相互作用的替代）为半径为 $r_s$ 的小球内的平均电子密度：\n$$\n\\overline{\\rho}_{\\mathrm{AE}}(Z,r_s) = \\frac{3}{r_s^3} \\int_{0}^{r_s} \\rho_{\\mathrm{AE}}(r;Z)\\, r^2 \\, dr.\n$$\n现在采用一个简化的 ECP 模型，该模型通过在芯层半径 $r_c$ 内将赝密度设为零来移除芯层电子密度：\n$$\n\\rho_{\\mathrm{ECP}}(r;Z,r_c) = \n\\begin{cases}\n0, & 0 \\le r \\le r_c,\\\\\n\\rho_{\\mathrm{AE}}(r;Z), & r > r_c.\n\\end{cases}\n$$\n定义相应的弥散 ECP 可观测量\n$$\n\\overline{\\rho}_{\\mathrm{ECP}}(Z,r_c,r_s) = \\frac{3}{r_s^3} \\int_{\\max(0,r_c)}^{r_s} \\rho_{\\mathrm{AE}}(r;Z)\\, r^2 \\, dr,\n$$\n需要明确的是，如果 $r_c \\ge r_s$，则积分为零。您的任务是：\n- 从给定的定义和标准积分出发，推导比率\n$$\nR(Z,r_c,r_s) = \\frac{\\overline{\\rho}_{\\mathrm{ECP}}(Z,r_c,r_s)}{\\overline{\\rho}_{\\mathrm{AE}}(Z,r_s)}.\n$$\n的闭式表达式。\n- 实现一个程序，该程序以原子单位计算下述每个测试用例的 $R(Z,r_c,r_s)$。程序不应需要外部输入。\n\n测试组（每个元组为 $(Z,r_c,r_s)$）：\n- $(1, 0.05, 0.2)$\n- $(1, 0.2, 0.2)$\n- $(6, 0.02, 0.2)$\n- $(10, 0.05, 0.2)$\n- $(2, 0.0, 0.2)$\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔的结果列表（例如，$[\\text{result}_1,\\text{result}_2,\\dots]$）。每个结果必须是四舍五入到 $6$ 位小数的浮点数。该可观测量的期望单位是 $a_0^{-3}$，但由于要求您返回比率 $R(Z,r_c,r_s)$，最终报告的数字是无量纲的。在您的解释中，请阐述为什么当这个基于简化的 ECP 的可观测量被用于近似依赖于芯层电子密度的性质（如核位置的电场梯度或 Fermi 接触项）时，其结果是无意义的。", "solution": "该问题已经过验证，被认为是科学上合理的、良定的和客观的。它构成了一个有效的练习，用于展示有效芯势 (ECP) 方法在计算化学中的一个基本局限性。因此，我们着手进行完整的解析推导和计算实现。\n\n任务是为一个简化的类氢体系推导并计算比率 $R(Z,r_c,r_s) = \\overline{\\rho}_{\\mathrm{ECP}} / \\overline{\\rho}_{\\mathrm{AE}}$。我们首先推导这两个可观测量​​的表达式。\n\n首先，我们计算全电子 (AE) 弥散接触可观测量 $\\overline{\\rho}_{\\mathrm{AE}}(Z,r_s)$。这需要计算在半径为 $r_s$ 的球体内径向概率密度 $4\\pi r^2 \\rho_{\\mathrm{AE}}(r;Z)$ 的积分。所提供的定义为 $\\overline{\\rho}_{\\mathrm{AE}}(Z,r_s) = \\frac{3}{r_s^3} \\int_{0}^{r_s} \\rho_{\\mathrm{AE}}(r;Z)\\, r^2 \\, dr$。给定 $\\rho_{\\mathrm{AE}}(r;Z) = \\frac{Z^3}{\\pi} e^{-2 Z r}$，积分部分为：\n$$\nI_{\\mathrm{AE}} = \\int_{0}^{r_s} \\rho_{\\mathrm{AE}}(r;Z)\\, r^2 \\, dr = \\frac{Z^3}{\\pi} \\int_{0}^{r_s} r^2 e^{-2 Z r} dr\n$$\n为求解此积分，我们利用不定积分的标准形式：\n$$\n\\int r^2 e^{ar} dr = e^{ar} \\left( \\frac{r^2}{a} - \\frac{2r}{a^2} + \\frac{2}{a^3} \\right)\n$$\n通过代换 $a = -2Z$，我们得到：\n$$\n\\int r^2 e^{-2Zr} dr = -e^{-2Zr} \\left( \\frac{r^2}{2Z} + \\frac{2r}{4Z^2} + \\frac{2}{8Z^3} \\right) = -\\frac{e^{-2Zr}}{4Z^3} (2Z^2r^2 + 2Zr + 1)\n$$\n计算从 $0$ 到 $r_s$ 的定积分：\n$$\n\\int_{0}^{r_s} r^2 e^{-2Zr} dr = \\left[ -\\frac{e^{-2Zr}}{4Z^3} \\left( 2Z^2r^2 + 2Zr + 1 \\right) \\right]_{0}^{r_s}\n$$\n$$\n= \\left( -\\frac{e^{-2Zr_s}}{4Z^3} \\left( 2Z^2r_s^2 + 2Zr_s + 1 \\right) \\right) - \\left( -\\frac{e^{0}}{4Z^3} (0 + 0 + 1) \\right)\n$$\n$$\n= \\frac{1}{4Z^3} \\left( 1 - e^{-2Zr_s} \\left( 2Z^2r_s^2 + 2Zr_s + 1 \\right) \\right)\n$$\n将此结果代回到 $I_{\\mathrm{AE}}$ 的表达式中，然后再代入 $\\overline{\\rho}_{\\mathrm{AE}}(Z,r_s)$ 的表达式：\n$$\nI_{\\mathrm{AE}} = \\frac{Z^3}{\\pi} \\frac{1}{4Z^3} \\left( 1 - e^{-2Zr_s} (2Z^2r_s^2 + 2Zr_s + 1) \\right) = \\frac{1}{4\\pi} \\left( 1 - e^{-2Zr_s} (2Z^2r_s^2 + 2Zr_s + 1) \\right)\n$$\n$$\n\\overline{\\rho}_{\\mathrm{AE}}(Z,r_s) = \\frac{3}{r_s^3} I_{\\mathrm{AE}} = \\frac{3}{4\\pi r_s^3} \\left( 1 - e^{-2Zr_s} (2Z^2r_s^2 + 2Zr_s + 1) \\right)\n$$\n接下来，我们计算 ECP 可观测量 $\\overline{\\rho}_{\\mathrm{ECP}}(Z,r_c,r_s)$。ECP 模型将 $r \\le r_c$ 区域的密度设为零。因此，积分的下限为 $r_c$。\n$$\n\\overline{\\rho}_{\\mathrm{ECP}}(Z,r_c,r_s) = \\frac{3}{r_s^3} \\int_{r_c}^{r_s} \\rho_{\\mathrm{AE}}(r;Z)\\, r^2 \\, dr\n$$\n这适用于 $0 \\le r_c < r_s$ 的情况。如果 $r_c \\ge r_s$，积分区间为空或长度为零，积分严格为零。对于 $r_c < r_s$，我们使用与之前相同的不定积分，但采用新的积分限：\n$$\nI_{\\mathrm{ECP}} = \\int_{r_c}^{r_s} \\rho_{\\mathrm{AE}}(r;Z)\\, r^2 \\, dr = \\frac{Z^3}{\\pi} \\left[ -\\frac{e^{-2Zr}}{4Z^3} \\left( 2Z^2r^2 + 2Zr + 1 \\right) \\right]_{r_c}^{r_s}\n$$\n$$\nI_{\\mathrm{ECP}} = \\frac{1}{4\\pi} \\left[ -e^{-2Zr} \\left( 2Z^2r^2 + 2Zr + 1 \\right) \\right]_{r_c}^{r_s}\n$$\n$$\nI_{\\mathrm{ECP}} = \\frac{1}{4\\pi} \\left( e^{-2Zr_c}(2Z^2r_c^2 + 2Zr_c + 1) - e^{-2Zr_s}(2Z^2r_s^2 + 2Zr_s + 1) \\right)\n$$\n比率 $R(Z,r_c,r_s)$ 为 $\\overline{\\rho}_{\\mathrm{ECP}} / \\overline{\\rho}_{\\mathrm{AE}} = I_{\\mathrm{ECP}} / I_{\\mathrm{AE}}$，因为前置因子 $\\frac{3}{r_s^3}$ 完全抵消。\n$$\nR(Z,r_c,r_s) = \\frac{e^{-2Zr_c}(2Z^2r_c^2 + 2Zr_c + 1) - e^{-2Zr_s}(2Z^2r_s^2 + 2Zr_s + 1)}{1 - e^{-2Zr_s}(2Z^2r_s^2 + 2Zr_s + 1)} \\quad \\text{for } r_c < r_s\n$$\n对于 $r_c \\ge r_s$ 的情况，我们有 $\\overline{\\rho}_{\\mathrm{ECP}} = 0$，这意味着 $R(Z,r_c,r_s) = 0$。\n一个特殊的平凡情况是 $r_c = 0$。此时，分子变为 $e^0(0+0+1) - e^{-2Zr_s}(...)$，与分母完全相同，因此得到 $R(Z,0,r_s)=1$。这是正确的，因为芯层半径为零的 ECP 等同于全电子计算。\n\n我们实现了这个 $R(Z,r_c,r_s)$ 的闭式表达式，以评估指定的测试用例。\n\n物理诠释展示了这种简化的 ECP 方法的失败之处。构建有效芯势是为了再现价层性质，例如轨道能量和远离原子核区域的电子密度空间分布。它们通过用一个较弱的赝势来取代强库仑势以及芯层电子的复杂效应来实现这一点。此过程产生的无节点的价层赝波函数在计算上很方便，但在芯层区域（$r < r_c$）是物理上不正确的。\n\n诸如 Fermi 接触相互作用、核位置的电场梯度以及 Mössbauer 异构体位移等性质，都关键地依赖于原子核处或非常靠近原子核区域（$r \\to 0$）的电子密度及其梯度。ECP 模型就其设计而言，移除了芯层电子并将这一关键区域的电子密度设为零。正如我们在对情况 $(Z, r_c, r_s) = (1, 0.2, 0.2)$ 的计算中所示，如果采样半径 $r_s$ 小于或等于芯层半径 $r_c$，基于 ECP 的可观测量将精确为零。这是一个灾难性的失败，与非零的全电子结果相比，产生了无穷大的相对误差。\n\n即使当 $r_c < r_s$ 时，ECP 的结果也对人为参数 $r_c$ 高度敏感。对于具有更大 $Z$ 的较重原子（例如 $Z=10$），芯层密度更集中在原子核附近。即使对于一个很小的 $r_c$（例如 $0.05$ a.u.），移除这部分密度也会导致严重不正确的结果，正如在测试用例 $(10, 0.05, 0.2)$ 中所见，其误差超过了 $10\\%$。$r_c$ 的值是一个为计算方便而设的参数，而非物理可观测量。任何强烈依赖于 $r_c$ 的计算性质，根据定义，都是一个非物理的人为产物。结论是不可避免的：ECP 根本上不适合用于计算依赖于芯层区域内电子密度的性质。试图这样做是对该方法的误用，并会导致无意义的、任意的结果。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem of computing the ratio R(Z, r_c, r_s) for a set of test cases.\n    \"\"\"\n\n    test_cases = [\n        (1, 0.05, 0.2),  # Z, r_c, r_s in atomic units\n        (1, 0.2, 0.2),\n        (6, 0.02, 0.2),\n        (10, 0.05, 0.2),\n        (2, 0.0, 0.2),\n    ]\n\n    def calculate_R(Z, r_c, r_s):\n        \"\"\"\n        Calculates the ratio R for a given set of parameters Z, r_c, and r_s.\n\n        The ratio is defined as:\n        R = [exp(-2*Z*r_c)*P(r_c) - exp(-2*Z*r_s)*P(r_s)] / [1 - exp(-2*Z*r_s)*P(r_s)]\n        where P(r) = (2*Z^2*r^2 + 2*Z*r + 1).\n\n        Args:\n            Z (float): Nuclear charge.\n            r_c (float): Core radius.\n            r_s (float): Smearing radius.\n\n        Returns:\n            float: The calculated ratio R.\n        \"\"\"\n        # If the core radius is greater than or equal to the smearing radius,\n        # the ECP observable integral becomes zero.\n        if r_c >= r_s:\n            return 0.0\n\n        # Define a helper function for the polynomial term P(r) = 2*Z^2*r^2 + 2*Z*r + 1\n        def poly(r, Z_val):\n            term1 = 2 * (Z_val * r)**2\n            term2 = 2 * Z_val * r\n            return term1 + term2 + 1\n\n        # Calculate exponential terms\n        exp_rc = np.exp(-2 * Z * r_c)\n        exp_rs = np.exp(-2 * Z * r_s)\n        \n        # Calculate polynomial terms\n        poly_rc = poly(r_c, Z)\n        poly_rs = poly(r_s, Z)\n\n        # Numerator of the ratio R\n        numerator = exp_rc * poly_rc - exp_rs * poly_rs\n        \n        # Denominator of the ratio R\n        denominator = 1.0 - exp_rs * poly_rs\n\n        # It is a mathematical certainty that for r_s > 0 the denominator is non-zero.\n        # The integrated probability inside the sphere must be less than 1, so\n        # 4*pi*I_AE  1, which implies 1 - exp(...)*P(...) > 0.\n        if denominator == 0:\n            # This case physically corresponds to r_s -> infinity, where R->1.\n            # For finite r_s, this should not happen. It might indicate a precision issue\n            # if r_s is extremely large, but is safe to handle.\n            # A special case is r_c = 0 where num=den, so R=1.\n            if numerator == denominator:\n                return 1.0\n            else: # Should not be reached with valid inputs.\n                return np.nan\n\n        return numerator / denominator\n\n    results = []\n    for case in test_cases:\n        Z, r_c, r_s = case\n        result = calculate_R(Z, r_c, r_s)\n        results.append(f\"{result:.6f}\")\n\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n\n```", "id": "2454650"}]}