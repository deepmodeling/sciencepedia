{"hands_on_practices": [{"introduction": "含时密度泛函理论 (TD-DFT) 不仅是理论研究的工具，更在预测分子光物理性质方面有广泛应用。本练习将带你体验一个典型的计算化学工作流程：通过计算分子的基态和第一激发态的能量，来预测一个重要的光谱参数——斯托克斯位移 (Stokes shift) [@problem_id:1417512]。这个实践将理论计算与可测量的实验现象直接联系起来，让你直观地理解 TD-DFT 在材料设计（如有机发光二极管 OLEDs）中的实际价值。", "problem": "一名计算化学家正在研究一种为有机发光二极管（OLED）应用而新合成的有机分子的光物理性质。其目标是预测斯托克斯位移（Stokes shift），即吸收光谱和发射光谱峰值之间的能量差。这一目标通过使用量子化学方法模拟分子在光致激发后的行为来实现。\n\n该计算方案基于用于基态的密度泛函理论（DFT）和用于激发态的含时密度泛函理论（TD-DFT），包含以下步骤：\n1.  在分子的电子基态（$S_0$）下对其进行几何优化，得到平衡几何构型 $R_0$。\n2.  接着在其第一单重激发态（$S_1$）下对几何构型进行优化，得到弛豫的激发态平衡几何构型 $R_1$。\n\n随后进行一系列单点能计算。这些计算得到的总电子能量如下所列。请注意，$E(S_i, R_j)$ 表示在固定的原子核几何构型 $R_j$ 下计算的电子态 $S_i$ 的能量。\n\n-   在优化的基态几何构型下的基态能量，$E(S_0, R_0) = -450.1234$ 哈特里（Hartrees）。\n-   在优化的基态几何构型下的第一激发态能量，$E(S_1, R_0) = -449.9948$ 哈特里（Hartrees）。\n-   在优化的激发态几何构型下的第一激发态能量，$E(S_1, R_1) = -449.9985$ 哈特里（Hartrees）。\n-   在优化的激发态几何构型下的基态能量，$E(S_0, R_1) = -450.1197$ 哈特里（Hartrees）。\n\n使用所提供的数据和换算因子 1 哈特里 = 27.2114 eV，计算该分子的斯托克斯位移。答案以电子伏特（eV）为单位，并四舍五入至三位有效数字。", "solution": "根据弗兰克-康登原理（Franck–Condon principle），斯托克斯位移定义为垂直吸收能（在 $R_{0}$ 构型下从 $S_{0}$ 到 $S_{1}$）与垂直发射能（在 $R_{1}$ 构型下从 $S_{1}$ 到 $S_{0}$）之间的差值。\n\n定义吸收能：\n$$\nE_{\\text{abs}}=\\left[E(S_{1},R_{0})-E(S_{0},R_{0})\\right].\n$$\n代入给定值（单位为哈特里）：\n$$\nE_{\\text{abs}} = \\left[-449.9948 - (-450.1234)\\right] = 0.1286.\n$$\n\n定义发射能：\n$$\nE_{\\text{em}}=\\left[E(S_{1},R_{1})-E(S_{0},R_{1})\\right].\n$$\n代入给定值（单位为哈特里）：\n$$\nE_{\\text{em}} = \\left[-449.9985 - (-450.1197)\\right] = 0.1212.\n$$\n\n那么，以能量单位表示的斯托克斯位移为：\n$$\n\\Delta E_{\\text{Stokes}} = E_{\\text{abs}} - E_{\\text{em}} = 0.1286 - 0.1212 = 0.0074 \\text{ Hartree}.\n$$\n\n使用 $1 \\text{ Hartree} = 27.2114 \\text{ eV}$ 将哈特里单位转换为电子伏特：\n$$\n\\Delta E_{\\text{Stokes}} (\\text{eV}) = 0.0074 \\times 27.2114 = 0.20136436 \\text{ eV}.\n$$\n\n四舍五入至三位有效数字：\n$$\n\\Delta E_{\\text{Stokes}} = 0.201 \\text{ eV}.\n$$", "answer": "$$\\boxed{0.201}$$", "id": "1417512"}, {"introduction": "在掌握了 TD-DFT 的一个基本应用后，深入理解影响计算准确性的因素至关重要。本练习将引导你探究计算化学中的一个核心实践问题：基组的选择对激发能计算的影响 [@problem_id:2466169]。通过一个简化的数学模型，你将量化基组的大小（以 cardinal number $X$ 为代表）和弥散函数 (diffuse functions) 的有无如何改变分子的激发能，从而培养在实际研究中为特定问题选择合适计算方案的判断力。", "problem": "您的任务是模拟在含时密度泛函理论 (TD-DFT) 框架下计算的偶氮苯生色团的最低单重激发能对轨道基组选择的敏感性。考虑一个单一主导的轨道跃迁，并采用线性响应 TD-DFT 的 Tamm-Dancoff 近似 (TDA)。在这个单跃迁 TDA 模型中，激发能定义为 Kohn-Sham 轨道能差与有效核耦合之和，两者均以电子伏特表示。对于一个由有效基数和弥散标记表征的基组，使用以下模型来描述基组不完备性：\n1. Kohn-Sham 能隙由以下公式给出\n$$\\Delta \\varepsilon(X,d) = \\Delta \\varepsilon_{\\infty} + \\frac{\\alpha}{X^{p}} - \\beta\\, d,$$\n2. 有效核耦合由以下公式给出\n$$K(X,d) = K_{\\infty} + \\frac{\\gamma}{X^{q}} - \\delta\\, d,$$\n3. 于是，Tamm-Dancoff 激发能为\n$$\\omega(X,d) = \\Delta \\varepsilon(X,d) + K(X,d)。$$\n\n此处，$X$ 是一个表示基组有效 zeta 基数的正实数，$d \\in \\{0,1\\}$ 表示是否存在 ($d=1$) 弥散增广函数。所有能量单位均为电子伏特 (eV)。参数 $\\Delta \\varepsilon_{\\infty}$、$K_{\\infty}$、$\\alpha$、$\\beta$、$\\gamma$、$\\delta$、$p$ 和 $q$ 将针对每个测试用例给出。对基组使用以下映射关系：\n- $6\\text{-}31\\text{G}^*$: $(X,d) = (2,0)$,\n- $\\text{cc-pVTZ}$: $(X,d) = (3,0)$,\n- $\\text{aug-cc-pVTZ}$: $(X,d) = (3,1)$.\n\n定义两个基组 $A$ 和 $B$ 之间的激发能敏感性为\n$$S(A,B) = \\left|\\omega(X_A,d_A) - \\omega(X_B,d_B)\\right|.$$\n\n对于下方的每个测试用例，计算两种敏感性（以电子伏特为单位）：\n- $S(6\\text{-}31\\text{G}^*, \\text{aug-cc-pVTZ})$,\n- $S(\\text{cc-pVTZ}, \\text{aug-cc-pVTZ})$.\n\n所有最终敏感性值均以 eV 表示，并四舍五入到小数点后四位。\n\n测试套件（每行为一个独立的测试用例，除已声明为无量纲的参数外，其余参数单位均为 eV）：\n- 测试用例 1（偶氮苯类 $n \\rightarrow \\pi^*$）：$\\Delta \\varepsilon_{\\infty} = 2.30$, $K_{\\infty} = 0.20$, $\\alpha = 0.90$, $\\beta = 0.05$, $\\gamma = 0.30$, $\\delta = 0.02$, $p = 2$, $q = 3$。\n- 测试用例 2（偶氮苯类 $\\pi \\rightarrow \\pi^*$）：$\\Delta \\varepsilon_{\\infty} = 4.10$, $K_{\\infty} = 0.35$, $\\alpha = 0.70$, $\\beta = 0.03$, $\\gamma = 0.20$, $\\delta = 0.01$, $p = 2$, $q = 3$。\n- 测试用例 3（弥散，类里德堡边缘情况）：$\\Delta \\varepsilon_{\\infty} = 3.60$, $K_{\\infty} = 0.10$, $\\alpha = 1.50$, $\\beta = 0.10$, $\\gamma = 0.50$, $\\delta = 0.05$, $p = 2$, $q = 3$。\n\n您的程序必须按给定顺序为每个测试用例计算一对敏感性\n$[S(6\\text{-}31\\text{G}^*, \\text{aug-cc-pVTZ}), S(\\text{cc-pVTZ}, \\text{aug-cc-pVTZ})]$,\n然后将所有测试用例的结果按以下顺序汇总到一个列表中：\n$$[S_1^{(6\\text{-}31\\text{G}^*,\\text{aug})}, S_1^{(\\text{cc},\\text{aug})}, S_2^{(6\\text{-}31\\text{G}^*,\\text{aug})}, S_2^{(\\text{cc},\\text{aug})}, S_3^{(6\\text{-}31\\text{G}^*,\\text{aug})}, S_3^{(\\text{cc},\\text{aug})}].$$\n\n最终输出格式：您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，列表中的每个数字都四舍五入到小数点后四位（例如，“[0.1234,0.0567,0.8910,0.0001,0.2222,0.3333]”）。所有值都必须以 eV 为单位。不应打印任何其他文本。", "solution": "提交分析的问题陈述被认为是有效的。它在计算化学建模领域具有科学依据，问题阐述清晰，提供了所有必要的数据和定义，并以客观、正式的语言表达。它没有违反任何无效标准。因此，我们将着手提供一个完整的解决方案。\n\n目标是计算一个模型化的含时密度泛函理论 (TD-DFT) 激发能对轨道基组变化的敏感性。该模型是在 Tamm-Dancoff 近似 (TDA) 框架下为单一主导轨道跃迁而构建的。\n\n总激发能 $\\omega$ 是基组有效 zeta 基数 $X$ 和弥散函数存在与否（由 $d \\in \\{0, 1\\}$ 指示）的函数。它由 Kohn-Sham 轨道能隙 $\\Delta\\varepsilon(X,d)$ 和有效核耦合 $K(X,d)$ 的和给出。\n$$\n\\omega(X,d) = \\Delta\\varepsilon(X,d) + K(X,d)\n$$\n各组分由以下经验模型定义：\n$$\n\\Delta\\varepsilon(X,d) = \\Delta\\varepsilon_{\\infty} + \\frac{\\alpha}{X^{p}} - \\beta\\,d\n$$\n$$\nK(X,d) = K_{\\infty} + \\frac{\\gamma}{X^{q}} - \\delta\\,d\n$$\n结合这些项，得到激发能的完整表达式：\n$$\n\\omega(X,d) = (\\Delta\\varepsilon_{\\infty} + K_{\\infty}) + \\frac{\\alpha}{X^{p}} + \\frac{\\gamma}{X^{q}} - (\\beta + \\delta)d\n$$\n此处，$\\Delta\\varepsilon_{\\infty}$ 和 $K_{\\infty}$ 分别代表轨道能隙和核耦合的完备基组极限。参数 $\\alpha, \\beta, \\gamma, \\delta, p, q$ 对于给定的电子跃迁是常数。所有能量相关的量（$\\omega, \\Delta\\varepsilon, K, \\alpha, \\beta, \\gamma, \\delta$）均以电子伏特 ($eV$) 表示。\n\n问题提供了从特定的命名基组到参数 $(X,d)$ 的映射关系：\n- 基组 A ($6\\text{-}31\\text{G}^*$): $(X_A, d_A) = (2, 0)$\n- 基组 B ($\\text{cc-pVTZ}$): $(X_B, d_B) = (3, 0)$\n- 基组 C ($\\text{aug-cc-pVTZ}$): $(X_C, d_C) = (3, 1)$\n\n例如，两个基组 $M$ 和 $N$ 之间的敏感性 $S$ 定义为其各自激发能的绝对差：\n$$\nS(M,N) = |\\omega(X_M, d_M) - \\omega(X_N, d_N)|\n$$\n我们需要为每个测试用例计算两个特定的敏感性：\n1. $S_1 = S(6\\text{-}31\\text{G}^*, \\text{aug-cc-pVTZ}) = |\\omega(X_A, d_A) - \\omega(X_C, d_C)| = |\\omega(2, 0) - \\omega(3, 1)|$\n2. $S_2 = S(\\text{cc-pVTZ}, \\text{aug-cc-pVTZ}) = |\\omega(X_B, d_B) - \\omega(X_C, d_C)| = |\\omega(3, 0) - \\omega(3, 1)|$\n\n我们来分析敏感性 $S_2$ 的分量。注意到 $X_B = X_C = 3$。该表达式可显著简化：\n\\begin{align*}\nS_2 &= |\\omega(3, 0) - \\omega(3, 1)| \\\\\n&= \\left| \\left( (\\Delta\\varepsilon_{\\infty} + K_{\\infty}) + \\frac{\\alpha}{3^{p}} + \\frac{\\gamma}{3^{q}} - (\\beta + \\delta) \\cdot 0 \\right) - \\left( (\\Delta\\varepsilon_{\\infty} + K_{\\infty}) + \\frac{\\alpha}{3^{p}} + \\frac{\\gamma}{3^{q}} - (\\beta + \\delta) \\cdot 1 \\right) \\right| \\\\\n&= | (\\beta + \\delta) |\n\\end{align*}\n由于所有参数都为正数，因此 $S_2 = \\beta + \\delta$。这简化了每个测试用例中两个所需值之一的计算。\n\n每个测试用例的计算流程如下：\n1. 获取八个模型参数：$\\Delta\\varepsilon_{\\infty}, K_{\\infty}, \\alpha, \\beta, \\gamma, \\delta, p, q$。\n2. 使用完整公式计算三个基组中每一个的激发能 $\\omega(X,d)$：\n   - $\\omega_A = \\omega(2, 0) = (\\Delta\\varepsilon_{\\infty} + K_{\\infty}) + \\frac{\\alpha}{2^{p}} + \\frac{\\gamma}{2^{q}}$\n   - $\\omega_B = \\omega(3, 0) = (\\Delta\\varepsilon_{\\infty} + K_{\\infty}) + \\frac{\\alpha}{3^{p}} + \\frac{\\gamma}{3^{q}}$\n   - $\\omega_C = \\omega(3, 1) = (\\Delta\\varepsilon_{\\infty} + K_{\\infty}) + \\frac{\\alpha}{3^{p}} + \\frac{\\gamma}{3^{q}} - (\\beta + \\delta)$\n3. 计算第一个敏感性：$S_1 = |\\omega_A - \\omega_C|$。\n4. 计算第二个敏感性：$S_2 = |\\omega_B - \\omega_C| = \\beta + \\delta$。\n5. 将 $S_1$ 和 $S_2$ 都四舍五入到小数点后四位。\n6. 按指定顺序将所有测试用例的结果收集到一个列表中。\n\n此算法将被实现以处理所提供的测试套件。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the sensitivity of TD-DFT excitation energies to basis set choice\n    based on a provided model.\n    \"\"\"\n\n    # Define the basis set mappings from name to (X, d) parameters.\n    basis_sets = {\n        \"6-31G*\": (2.0, 0),\n        \"cc-pVTZ\": (3.0, 0),\n        \"aug-cc-pVTZ\": (3.0, 1)\n    }\n\n    # Define the test cases with their specific parameters.\n    # Parameters: de_inf, k_inf, alpha, beta, gamma, delta, p, q\n    test_cases = [\n        # Test case 1\n        (2.30, 0.20, 0.90, 0.05, 0.30, 0.02, 2.0, 3.0),\n        # Test case 2\n        (4.10, 0.35, 0.70, 0.03, 0.20, 0.01, 2.0, 3.0),\n        # Test case 3\n        (3.60, 0.10, 1.50, 0.10, 0.50, 0.05, 2.0, 3.0),\n    ]\n\n    all_results = []\n\n    def calculate_omega(X, d, params):\n        \"\"\"\n        Calculates the excitation energy omega(X, d) for a given set of parameters.\n        \n        Args:\n            X (float): Effective zeta cardinality.\n            d (int): Diffuse function flag (0 or 1).\n            params (tuple): A tuple containing the model parameters in the order\n                            (de_inf, k_inf, alpha, beta, gamma, delta, p, q).\n        \n        Returns:\n            float: The calculated excitation energy omega in eV.\n        \"\"\"\n        de_inf, k_inf, alpha, beta, gamma, delta, p, q = params\n        \n        delta_eps = de_inf + (alpha / (X**p)) - (beta * d)\n        K = k_inf + (gamma / (X**q)) - (delta * d)\n        \n        return delta_eps + K\n\n    for case_params in test_cases:\n        # Get the (X, d) tuples for the basis sets of interest\n        x_a, d_a = basis_sets[\"6-31G*\"]\n        x_b, d_b = basis_sets[\"cc-pVTZ\"]\n        x_c, d_c = basis_sets[\"aug-cc-pVTZ\"]\n\n        # Calculate the excitation energy for each basis set\n        omega_a = calculate_omega(x_a, d_a, case_params)\n        omega_b = calculate_omega(x_b, d_b, case_params)\n        omega_c = calculate_omega(x_c, d_c, case_params)\n\n        # Calculate the two required sensitivities\n        # S1 = S(6-31G*, aug-cc-pVTZ)\n        sensitivity_1 = np.abs(omega_a - omega_c)\n\n        # S2 = S(cc-pVTZ, aug-cc-pVTZ)\n        sensitivity_2 = np.abs(omega_b - omega_c)\n\n        # Append the formatted results to the final list\n        all_results.append(f\"{sensitivity_1:.4f}\")\n        all_results.append(f\"{sensitivity_2:.4f}\")\n\n    # Print the final result in the exact specified format\n    print(f\"[{','.join(all_results)}]\")\n\nsolve()\n```", "id": "2466169"}, {"introduction": "任何理论模型都有其适用范围和局限性，TD-DFT 也不例外。这个高级练习将让你从第一性原理出发，构建一个模型，以揭示标准近似泛函（如 GGA）在处理长程电荷转移 (charge-transfer, CT) 激发时的一个著名缺陷 [@problem_id:2466214]。通过亲手推导和编程实现，你将深刻理解为何局域和半局域泛函会系统性地低估 CT 激发能，并认识到发展更高级泛函（如范围分离杂化泛函）的必要性。", "problem": "要求您编写一个完整、可运行的程序，在一个最小但有科学依据的模型中，演示时间相关的密度泛函理论（TD-DFT）如何在使用标准广义梯度近似（GGA）泛函时，错误地预测空间分离的给体-受体对中存在虚假的低能荷移激发。您的程序必须从第一性原理出发，实现以下逻辑。\n\n从密度泛函理论（DFT）中电离势和电子亲和能的基本定义，以及分离电荷的静电相互作用出发。利用这些原理，推导大分离距离下最低的给体到受体荷移激发能的表达式。然后，利用线性响应TD-DFT理论，并基于以下事实：对于空间上不重叠的轨道，绝热半局域Hartree-交换-相关核产生的耦合可以忽略不计，推导出半局域GGA泛函所做的相应预测。最后，通过引入导数不连续性，将Kohn–Sham轨道能量差与基本能隙联系起来。在推导过程中，不要使用或引用任何已有的简化公式；相反，仅根据以下基本依据进行推理：\n- 基本定义：通过总能量差定义的电离势 $I$ 和电子亲和能 $A$，以及相距为 $R$ 的两个单位电荷之间的静电相互作用能。\n- 线性响应理论核心思想：激发能源于一个由无相互作用的跃迁能和一个耦合项决定的响应极点，并且对于轨道重叠可忽略的空间分离片段间的荷移过程，局域和绝热的核几乎不提供长程耦合。\n- 一个经过充分检验的概念性事实：多体基本能隙通过导数不连续性与Kohn–Sham能隙相关联。\n\n实现一个最小化的双片段模型，每个测试用例使用以下参数：\n- 给体电离势 $I_D$，单位为Hartree。\n- 受体电子亲和能 $A_A$，单位为Hartree。\n- 中心间距 $R$，单位为bohr。\n- 一个有效的正值导数不连续性参数 $\\Delta_{\\mathrm{xc}}$，单位为Hartree，它描述了半局域GGA泛函所特有的能隙低估特征。\n\n对每个测试用例，计算：\n1. 基于上述原理推导的、具有物理意义的大分离距离荷移激发能，以Hartree为单位，此处记为 $E_{\\mathrm{true}}$。\n2. 绝热半局域GGA TD-DFT对相同荷移激发的预测值，以Hartree为单位，此处记为 $E_{\\mathrm{GGA}}$。\n3. 符号误差 $\\Delta E = E_{\\mathrm{GGA}} - E_{\\mathrm{true}}$，单位为Hartree。\n4. 一个布尔标志，当且仅当GGA预测值是虚假地低时（由严格不等式 $E_{\\mathrm{GGA}} < E_{\\mathrm{true}}$ 定义），该标志为真。\n\n您的程序必须使用以下固定的参数元组 $(I_D,A_A,R,\\Delta_{\\mathrm{xc}})$ 测试套件，单位为原子单位（能量为Hartree，距离为bohr）：\n- 测试 1（一般分离对）：$(0.30, 0.08, 30.0, 0.12)$。\n- 测试 2（极大分离距离）：$(0.30, 0.08, 200.0, 0.12)$。\n- 测试 3（导致接近零的GGA激发能的小基本能隙）：$(0.20, 0.08, 25.0, 0.12)$。\n- 测试 4（在此 $R$ 值下，低估量与缺失的静电作用相等的数值平衡点）：$(0.25, 0.05, $8.\\overline{3}$, 0.12)$，其中 $8.\\overline{3}$ 表示 $25/3$ bohr。\n\n所有能量必须以Hartree为单位表示，并四舍五入到六位小数。对于每个测试用例，您的程序必须按顺序输出 $E_{\\mathrm{true}}$、$E_{\\mathrm{GGA}}$、$\\Delta E$ 和布尔标志这四个值。将所有测试用例的结果汇总到一个扁平列表中。您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔的结果列表（例如，“[result1,result2,result3,...]”）。\n\n不涉及角度单位。不允许外部输入；程序必须完全自包含，并在执行时产生所需的单行输出。", "solution": "问题陈述具有科学依据、提法明确，并包含了推导唯一解所需的所有信息。它描述了常见密度泛函近似的一种众所周知的失效模式。因此，该问题被认为是有效的，并将基于所提供的第一性原理构建解决方案。\n\n我们首先推导在大分离距离下物理上正确的荷移（$CT$）激发能的表达式，记为 $E_{\\mathrm{true}}$。一个 $CT$ 激发过程涉及将一个电子从给体分子 $D$ 移动到相距为 $R$ 的受体分子 $A$。该过程可表示为 $D^0A^0 \\rightarrow D^+A^-$。此激发的能量 $\\omega_{CT}$ 是最终态和初始态总能量之差：\n$$ \\omega_{CT} = E(D^+A^-) - E(D^0A^0) $$\n在 $R$ 趋于大分离的极限下，组合体系的能量可以近似为其无相互作用的组成片段的能量之和，再加上它们的经典静电相互作用能。对于初始中性态，其能量为：\n$$ E(D^0A^0) \\approx E(D^0) + E(A^0) $$\n对于最终的离子态，其能量包括新形成的离子之间的静电引力：\n$$ E(D^+A^-) \\approx E(D^+) + E(A^-) + E_{\\mathrm{int}} $$\n这里，$E(X)$ 代表物种 $X$ 的总能量。根据库仑定律，在 $D^+$ 上的 $+1e$ 点电荷与在 $A^-$ 上的 $-1e$ 点电荷之间的相互作用能 $E_{\\mathrm{int}}$ 为。在原子单位制中，能量单位为Hartree，距离单位为bohr，该能量为：\n$$ E_{\\mathrm{int}} = -\\frac{1}{R} $$\n将这些表达式代入 $\\omega_{CT}$ 的方程，我们得到：\n$$ \\omega_{CT} \\approx \\left( E(D^+) + E(A^-) - \\frac{1}{R} \\right) - \\left( E(D^0) + E(A^0) \\right) $$\n按物种重新组合各项可得：\n$$ \\omega_{CT} \\approx \\left( E(D^+) - E(D^0) \\right) + \\left( E(A^-) - E(A^0) \\right) - \\frac{1}{R} $$\n括号中的项对应于基本定义。给体的电离势 $I_D$ 是移去一个电子所需的能量：\n$$ I_D = E(D^+) - E(D^0) $$\n受体的电子亲和能 $A_A$ 是捕获一个电子时释放的能量，定义为：\n$$ A_A = E(A^0) - E(A^-) $$\n根据此定义，可得 $E(A^-) - E(A^0) = -A_A$。通过代入 $I_D$ 和 $A_A$ 的定义，我们得到了真实的大分离距离荷移激发能的表达式：\n$$ E_{\\mathrm{true}} = I_D - A_A - \\frac{1}{R} $$\n\n接下来，我们推导绝热半局域时间相关密度泛函理论（$TD-DFT$）给出的相应预测值，记为 $E_{\\mathrm{GGA}}$。在线性响应 $TD-DFT$ 框架内，激发能 $\\omega$ 通过求解一个矩阵方程的本征值得到。对于从一个已占据的Kohn-Sham（$KS$）轨道 $\\phi_i$ 到一个虚拟 $KS$ 轨道 $\\phi_a$ 的单次激发，其在绝热近似下的激发能由下式给出：\n$$ \\omega_{ia} = \\varepsilon_a - \\varepsilon_i + K_{ia,ia} $$\n其中 $\\varepsilon_i$ 和 $\\varepsilon_a$ 是 $KS$ 轨道的能量，$K_{ia,ia}$ 是耦合矩阵元。该矩阵元依赖于Hartree-交换-相关（$HXC$）核 $f_{HXC}$：\n$$ K_{ia,ia} = \\iint \\phi_i^*(\\mathbf{r})\\phi_a(\\mathbf{r}) f_{HXC}(\\mathbf{r}, \\mathbf{r}') \\phi_a^*(\\mathbf{r}')\\phi_i(\\mathbf{r}') d\\mathbf{r} d\\mathbf{r}' $$\n对于我们考虑的 $CT$ 激发，已占据轨道 $\\phi_i$ 是给体的最高已占分子轨道（$HOMO_D$），虚拟轨道 $\\phi_a$ 是受体的最低未占分子轨道（$LUMO_A$）。在大分离距离 $R$ 下，这些轨道在空间上是孤立的，它们的重叠乘积 $\\phi_i(\\mathbf{r})\\phi_a(\\mathbf{r})$ 对于所有 $\\mathbf{r}$ 都可以忽略不计。\n对于一个半局域泛函，例如广义梯度近似（$GGA$），其核 $f_{HXC}^{GGA}(\\mathbf{r}, \\mathbf{r}')$ 是有效局域的，意味着它随着距离 $|\\mathbf{r} - \\mathbf{r}'|$ 的增加而迅速衰减为零。局域核和可忽略的轨道重叠共同导致耦合积分 $K_{ia,ia}$ 变为零：\n$$ K_{ia,ia}^{GGA} \\approx 0 $$\n因此，$TD-GGA$ 激发能被虚假地简化为所涉及的 $KS$ 轨道的能量差：\n$$ E_{\\mathrm{GGA}} = \\omega_{CT}^{GGA} \\approx \\varepsilon_{LUMO,A} - \\varepsilon_{HOMO,D} $$\n为了使这个表达式有用，我们必须将这个 $KS$ 轨道能隙与物理量 $I_D$ 和 $A_A$ 联系起来。组合的 $D-A$ 体系的基本多体能隙是 $E_{gap} = I_D - A_A$。相应的 $KS$ 能隙是 $\\varepsilon_{gap}^{KS} = \\varepsilon_{LUMO,A} - \\varepsilon_{HOMO,D}$。对于一个精确的泛函，这些量通过交换相关势的导数不连续性 $\\Delta_{xc}$ 相互关联：\n$$ E_{gap} = \\varepsilon_{gap}^{KS} + \\Delta_{xc} \\implies I_D - A_A = (\\varepsilon_{LUMO,A} - \\varepsilon_{HOMO,D}) + \\Delta_{xc} $$\n像 $GGA$ 这样的近似泛函存在一个已知的系统误差，该误差实际上对应于缺失的导数不连续性。本问题提供了一个有效的参数 $\\Delta_{\\mathrm{xc}} > 0$ 来模拟此缺陷。在 $GGA$ 框架下，重排 $KS$ 能隙的预测方程可得：\n$$ \\varepsilon_{LUMO,A}^{GGA} - \\varepsilon_{HOMO,D}^{GGA} = (I_D - A_A) - \\Delta_{xc} $$\n这就给出了 $TD-GGA$ 荷移激发能的最终表达式：\n$$ E_{\\mathrm{GGA}} = I_D - A_A - \\Delta_{\\mathrm{xc}} $$\n这个结果错误地显示，当 $R$ 很大时，激发能趋于一个常数，完全丢失了正确的 $-1/R$ 渐近行为。\n\n最后，我们计算符号误差 $\\Delta E$ 并确定虚假低预测的条件。误差是 $GGA$ 值与真实值之差：\n$$ \\Delta E = E_{\\mathrm{GGA}} - E_{\\mathrm{true}} = (I_D - A_A - \\Delta_{\\mathrm{xc}}) - \\left(I_D - A_A - \\frac{1}{R}\\right) $$\n$$ \\Delta E = \\frac{1}{R} - \\Delta_{\\mathrm{xc}} $$\n当且仅当 $E_{\\mathrm{GGA}} < E_{\\mathrm{true}}$ 时，$GGA$ 的预测是虚假地低，这意味着 $\\Delta E < 0$。这给出了条件：\n$$ \\frac{1}{R} - \\Delta_{\\mathrm{xc}} < 0 \\implies \\frac{1}{R} < \\Delta_{\\mathrm{xc}} $$\n随着分离距离 $R$ 的增加，$1/R$ 减小。对于任何具有非零能隙低估误差（$\\Delta_{\\mathrm{xc}} > 0$）的体系，都存在一个分离距离，超过该距离此不等式即成立，这证明了绝热半局域泛函在描述长程荷移方面的根本性失败。以下程序实现了这些推导出的公式。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the true and TD-GGA charge-transfer excitation energies for a\n    series of donor-acceptor pairs to demonstrate the failure of semilocal DFT.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    # Each tuple is (I_D, A_A, R, delta_xc) in atomic units.\n    test_cases = [\n        # Test 1: General separated pair\n        (0.30, 0.08, 30.0, 0.12),\n        # Test 2: Very large separation\n        (0.30, 0.08, 200.0, 0.12),\n        # Test 3: Small fundamental gap\n        (0.20, 0.08, 25.0, 0.12),\n        # Test 4: Numerical balance point\n        (0.25, 0.05, 25.0/3.0, 0.12),\n    ]\n\n    results = []\n    for case in test_cases:\n        I_D, A_A, R, delta_xc = case\n        \n        # 1. Calculate the physically motivated charge-transfer energy, E_true.\n        # This is derived from E_true = I_D - A_A - 1/R.\n        E_true = I_D - A_A - 1.0/R\n        \n        # 2. Calculate the adiabatic semilocal GGA TD-DFT prediction, E_GGA.\n        # This is derived from E_GGA = I_D - A_A - delta_xc.\n        E_gga = I_D - A_A - delta_xc\n        \n        # 3. Calculate the signed error, delta_E.\n        # This is delta_E = E_GGA - E_true, which simplifies to 1/R - delta_xc.\n        delta_E = 1.0/R - delta_xc\n\n        # 4. Determine if the GGA prediction is spuriously low.\n        # This is true if E_GGA < E_true.\n        is_spurious = E_gga < E_true\n\n        # Append the four required results for this test case.\n        # Energies are rounded to six decimal places.\n        results.append(np.round(E_true, 6))\n        results.append(np.round(E_gga, 6))\n        results.append(np.round(delta_E, 6))\n        results.append(is_spurious)\n        \n    # Final print statement in the exact required format.\n    # The boolean `True`/`False` is converted to string \"True\"/\"False\".\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2466214"}]}