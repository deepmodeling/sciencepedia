{"hands_on_practices": [{"introduction": "混合泛函的出现并非偶然，而是为了解决密度泛函理论中一个长期存在的难题。这个练习将带我们回到问题的根源：化学键的断裂。通过分析氢分子解离这一经典案例，我们将亲身体会到为何像GGA这样的纯泛函会在这个过程中“犯错”，以及引入精确交换的混合泛函是如何从根本上改善预测结果的。[@problem_id:1373562]", "problem": "在密度泛函理论（DFT）的背景下，交换相关泛函的选择对于精确模拟化学体系至关重要。考虑一个氢分子（H$_2$）对称解离为两个分离的中性氢原子（H + H）的过程。我们可以通过计算体系的基态电子能量 $E$ 作为核间距 $R$ 的函数来模拟此过程。\n\n让我们比较两种类型的泛函：\n1.  纯广义梯度近似（GGA）泛函，其交换相关能取决于电子密度及其梯度。\n2.  杂化泛函，它是通过将 Hartree-Fock（HF）理论中的一小部分（$\\alpha$）“精确”交换与 GGA 泛函混合而构建的。一个典型杂化泛函的交换相关能可以表示为：\n    $E_{\\text{xc}}^{\\text{hybrid}} = \\alpha E_{\\text{x}}^{\\text{HF}} + (1-\\alpha)E_{\\text{x}}^{\\text{GGA}} + E_{\\text{c}}^{\\text{GGA}}$\n    其中 $E_{\\text{x}}^{\\text{HF}}$ 是 HF 交换能，$E_{\\text{x}}^{\\text{GGA}}$ 是 GGA 交换能，$E_{\\text{c}}^{\\text{GGA}}$ 是 GGA 相关能。假设 $\\alpha$ 是一个介于 0 和 1 之间的常数（例如 $\\alpha=0.25$）。\n\n一个已知的问题是，纯 GGA 泛函存在“静态相关误差”（也与离域误差或自相互作用误差有关），这种误差在这种键断裂情景中变得尤为严重。这种误差导致 GGA 计算的两个分离原子（$R \\to \\infty$）的能量显著高于真实能量，而真实能量本应是两个孤立氢原子能量的总和。相比之下，HF 方法能正确描述解离后的 H$_2$ 分子的能量。\n\n基于这些信息，下列哪个陈述最好地描述了在大核间距极限下（$R \\to \\infty$），由杂化泛函预测的势能 $E_{\\text{hybrid}}(R)$ 与由纯 GGA 泛函预测的势能 $E_{\\text{GGA}}(R)$ 之间的关系？\n\nA. $E_{\\text{hybrid}}(R \\to \\infty)$ 低于 $E_{\\text{GGA}}(R \\to \\infty)$。\n\nB. $E_{\\text{hybrid}}(R \\to \\infty)$ 高于 $E_{\\text{GGA}}(R \\to \\infty)$。\n\nC. $E_{\\text{hybrid}}(R \\to \\infty)$ 与 $E_{\\text{GGA}}(R \\to \\infty)$ 相同。\n\nD. 使用杂化泛函的计算在大的 $R$ 处不收敛，因此其能量无法确定。\n\nE. 两种泛函都预测了正确的解离能，但杂化泛函对平衡点附近的键长描述得更好。", "solution": "我们考虑用 Kohn–Sham 形式表示的方法 $M$ （GGA, HF, 杂化）的总基态能量为\n$$\nE_{M}(R)=\\min_{n}\\Big[T_{s}[n]+V_{ne}(n;R)+J[n]+E_{xc}^{M}[n]\\Big].\n$$\n在解离极限 $R\\to\\infty$ 下，体系分离为两个无相互作用的氢原子，因此使能量最小化的密度可以分解为两个单电子密度的和，总能量也分解为两个相同单原子贡献的和：\n$$\nE_{M}(R\\to\\infty)=2\\,E_{M}^{\\text{atom}}.\n$$\n对于一个单电子密度 $n_{H}$，以下两个精确恒等式成立：\n$$\nE_{c}^{\\text{exact}}[n_{H}]=0,\\qquad E_{x}^{\\text{HF}}[n_{H}]=-J[n_{H}],\n$$\n即，不存在真实的相关，且 Hartree 自相互作用被 HF 交换精确抵消。\n\n纯 GGA 泛函对于单电子密度存在自相互作用/离域误差，这可以总结为\n$$\nE_{x}^{\\text{GGA}}[n_{H}]+J[n_{H}]>0,\n$$\n并且通常情况下，对于单电子体系，$E_{c}^{\\text{GGA}}[n_{H}]$ 并不会将此误差校正为零。因此，用 GGA 评估的原子能量高于精确值，所以我们可以写成\n$$\nE_{\\text{GGA}}(R\\to\\infty)=2E_{H}+ \\Delta_{\\text{GGA}},\\qquad \\Delta_{\\text{GGA}}>0,\n$$\n其中 $E_{H}$ 是氢原子的精确能量，$\\Delta_{\\text{GGA}}$ 是解离时的静态相关/自相互作用误差。\n\n杂化泛函将一小部分（$\\alpha\\in(0,1)$）的 HF 交换与 GGA 交换混合，并保留了 GGA 相关：\n$$\nE_{xc}^{\\text{hybrid}}=\\alpha E_{x}^{\\text{HF}}+(1-\\alpha)E_{x}^{\\text{GGA}}+E_{c}^{\\text{GGA}}.\n$$\n对于单电子密度 $n_{H}$，杂化泛函与 GGA 泛函之间的交换相关能差异为\n$$\n\\Delta E_{xc}[n_{H}]\\equiv E_{xc}^{\\text{hybrid}}[n_{H}]-E_{xc}^{\\text{GGA}}[n_{H}]\n=\\alpha\\big(E_{x}^{\\text{HF}}[n_{H}]-E_{x}^{\\text{GGA}}[n_{H}]\\big).\n$$\n使用 $E_{x}^{\\text{HF}}[n_{H}]=-J[n_{H}]$ 以及 $E_{x}^{\\text{GGA}}[n_{H}]>-J[n_{H}]$ （GGA 不能完全抵消 Hartree 自相互作用）这一事实，我们得到\n$$\nE_{x}^{\\text{HF}}[n_{H}]-E_{x}^{\\text{GGA}}[n_{H}]<0\n\\quad\\Rightarrow\\quad\n\\Delta E_{xc}[n_{H}]<0\\quad\\text{for any}\\ \\alpha>0.\n$$\n因此，在固定的单电子密度下，相对于 GGA，杂化泛函降低了交换相关能。由于在解离极限下，总能量是两个单电子碎片的总和，并且对于固定的密度，其他能量项 $T_{s}[n]$、$V_{ne}(n;R)$ 和 $J[n]$ 是相同的，因此在 $R\\to\\infty$ 时的杂化泛函总能量满足\n$$\nE_{\\text{hybrid}}(R\\to\\infty)\\le E_{\\text{GGA}}(R\\to\\infty),\n$$\n对于任何 $\\alpha>0$，该不等式为严格不等式，因为自相互作用/离域误差被 HF 交换组分减小了。此外，当极限 $\\alpha\\to 1$ 时，泛函恢复为 HF 方法，此时有 $E_{\\text{HF}}(R\\to\\infty)=2E_{H}$ (伴随自旋对称性破缺)，因此随着 $\\alpha$ 的增加，杂化能量从上方趋近于正确的解离极限。\n\n综合这些事实，\n$$\nE_{\\text{hybrid}}(R\\to\\infty) < E_{\\text{GGA}}(R\\to\\infty).\n$$\n这对应于选项 A。", "answer": "$$\\boxed{A}$$", "id": "1373562"}, {"introduction": "虽然混合泛函在准确性上有所提升，但这种提升并非没有代价。在计算化学中，时间和计算资源是必须考虑的现实因素。这个练习旨在量化选择混合泛函所需付出的“成本”，通过对比GGA和混合泛函在不同体系大小下的计算时间，你将掌握它们在计算量上的基本标度行为（分别近似为 $N^3$ 和 $N^4$），这是在实际研究中选择计算方法时至关重要的考量。[@problem_id:1373556]", "problem": "一个计算化学研究小组正在研究一系列新合成的聚合物链的电子性质。在进行大规模研究之前，他们对一个小单体单元进行了基准计算，以比较不同理论方法的成本。该单体系统使用一个包含 $N_{small} = 400$ 个基函数的基组进行描述。\n\n该小组对这个单体进行了两次单点能计算：\n1.  使用广义梯度近似 (GGA) 泛函，计算耗时 $T_{GGA, small} = 5.00$ 分钟完成。\n2.  使用杂化泛函，其包含了一部分精确的 Hartree-Fock (HF) 交换，计算耗时 $T_{Hybrid, small} = 24.0$ 分钟完成。\n\n对于所使用的这类分子和软件，已知 GGA 计算的计算时间近似随基函数数量的立方 ($N^3$) 缩放，而杂化泛函计算的时间主要由精确交换部分决定，并随基函数数量的四次方 ($N^4$) 缩放。\n\n该小组现在希望研究该系列中一个更大的低聚物，这需要一个包含 $N_{large} = 2000$ 个基函数的基组。根据基准测试结果和已知的标度行为，计算这个更大体系下，杂化泛函计算时间与 GGA 泛函计算时间的预期比率，即 $T_{Hybrid, large} / T_{GGA, large}$。\n\n将最终答案四舍五入到三位有效数字。", "solution": "设 GGA 时间的标度关系为 $T_{\\mathrm{GGA}}(N)=A N^{3}$，杂化泛函时间的标度关系为 $T_{\\mathrm{Hybrid}}(N)=B N^{4}$，其中 $A$ 和 $B$ 是依赖于方法和代码的前置因子。\n\n根据小体系（基函数数量为 $N_{\\mathrm{small}}$）的基准计算结果，\n$$\nA=\\frac{T_{\\mathrm{GGA,small}}}{N_{\\mathrm{small}}^{3}},\\qquad B=\\frac{T_{\\mathrm{Hybrid,small}}}{N_{\\mathrm{small}}^{4}}.\n$$\n对于大体系（基函数数量为 $N_{\\mathrm{large}}$），该比率为\n$$\n\\frac{T_{\\mathrm{Hybrid,large}}}{T_{\\mathrm{GGA,large}}}\n=\\frac{B N_{\\mathrm{large}}^{4}}{A N_{\\mathrm{large}}^{3}}\n=\\frac{B}{A}N_{\\mathrm{large}}\n=\\left(\\frac{T_{\\mathrm{Hybrid,small}}/N_{\\mathrm{small}}^{4}}{T_{\\mathrm{GGA,small}}/N_{\\mathrm{small}}^{3}}\\right) N_{\\mathrm{large}}\n=\\left(\\frac{T_{\\mathrm{Hybrid,small}}}{T_{\\mathrm{GGA,small}}}\\right)\\left(\\frac{N_{\\mathrm{large}}}{N_{\\mathrm{small}}}\\right).\n$$\n代入给定值 $T_{\\mathrm{Hybrid,small}}=24.0$，$T_{\\mathrm{GGA,small}}=5.00$，$N_{\\mathrm{large}}=2000$ 和 $N_{\\mathrm{small}}=400$，\n$$\n\\frac{T_{\\mathrm{Hybrid,large}}}{T_{\\mathrm{GGA,large}}}\n=\\left(\\frac{24.0}{5.00}\\right)\\left(\\frac{2000}{400}\\right)=4.8\\times 5=24.0.\n$$\n四舍五入到三位有效数字，结果是 $24.0$。", "answer": "$$\\boxed{24.0}$$", "id": "1373556"}, {"introduction": "混合泛函的优势不仅限于更准确地描述总能量，它们还能改善波函数的其他重要性质。对于开壳层体系（如自由基），一个常见的问题是自旋污染，它会导致计算得到的自旋态不纯，从而影响对体系电子结构和磁性的正确描述。本练习将通过一个具体案例，向你展示混合泛函中的精确交换成分如何帮助“净化”自旋态，减少自旋污染，从而得到更符合物理真实的计算结果。[@problem_id:1373583]", "problem": "在对噻吩自由基阳离子（$\\text{C}_4\\text{H}_4\\text{S}^+$）这一开壳层双重态体系的计算研究中，其电子结构采用非限制性Kohn-Sham（UKS）方法进行建模。在该方法中，α-自旋轨道和β-自旋轨道被独立处理。对于该自由基阳离子的基态，有 $N_\\alpha = 22$ 个α电子和 $N_\\beta = 21$ 个β电子。\n\n非限制性方法的一个已知问题是自旋污染，即计算得到的自旋平方算符 $\\hat{S}^2$ 的本征态不是一个纯自旋态。计算得到的期望值 $\\langle S^2 \\rangle$ 会偏离其精确理论值 $S(S+1)$，其中 $S$ 是总自旋量子数。自旋污染的程度 $\\Delta S^2$ 定义为该偏差：$\\Delta S^2 = \\langle S^2 \\rangle - S(S+1)$。对于UKS计算，该污染由表达式 $\\Delta S^2 = N_\\beta - \\mathcal{O}$ 给出，其中 $\\mathcal{O}$ 代表α和β空间轨道集之间的总平方重叠。\n\n首先，使用纯的广义梯度近似 (GGA) 泛函进行了一次计算。这次计算得到的总轨道平方重叠为 $\\mathcal{O}_{GGA} = 20.315$。\n\n接着，使用一种杂化泛函进行第二次计算。该泛函通过混入一定比例 ($a_{HF}$) 的精确Hartree-Fock交换，对纯GGA泛函进行了改进。对于所使用的杂化泛函，其 $a_{HF} = 0.25$。引入精确交换已知可以减少自旋污染。对于噻吩自由基阳离子，一个计算模型表明，自旋污染会根据关系式 $\\Delta S^2_{hybrid} = \\Delta S^2_{GGA} \\times (1 - a_{HF}^{1/3})$ 减少。\n\n利用这些信息，计算从杂化泛函计算中获得的期望值 $\\langle S^2 \\rangle$。将最终答案四舍五入到三位有效数字。", "solution": "对于一个具有 $N_{\\alpha}=22$ 和 $N_{\\beta}=21$ 的非限制性Kohn-Sham双重态，总自旋为 $S=\\frac{N_{\\alpha}-N_{\\beta}}{2}=\\frac{1}{2}$，因此精确的自旋期望值为\n$$\nS(S+1)=\\frac{3}{4}=0.75.\n$$\n在UKS计算中，自旋污染定义为 $\\Delta S^{2}=\\langle S^{2}\\rangle - S(S+1)$，并且对于一个给定的计算，它由以下公式给出\n$$\n\\Delta S^{2}=N_{\\beta}-\\mathcal{O}.\n$$\n对于GGA计算结果，其中 $\\mathcal{O}_{GGA}=20.315$，\n$$\n\\Delta S^{2}_{GGA}=N_{\\beta}-\\mathcal{O}_{GGA}=21-20.315=0.685.\n$$\n对于 $a_{HF}=0.25$ 的杂化泛函，模型给出\n$$\n\\Delta S^{2}_{hybrid}=\\Delta S^{2}_{GGA}\\left(1-a_{HF}^{1/3}\\right)=0.685\\left(1-0.25^{1/3}\\right).\n$$\n计算 $0.25^{1/3}=4^{-1/3}\\approx 0.6299605249$，我们得到\n$$\n\\Delta S^{2}_{hybrid}\\approx 0.685\\times 0.3700394751\\approx 0.2534770404.\n$$\n因此，杂化泛函的期望值为\n$$\n\\langle S^{2}\\rangle_{hybrid}=S(S+1)+\\Delta S^{2}_{hybrid}\\approx 0.75+0.2534770404\\approx 1.0034770404.\n$$\n四舍五入到三位有效数字得到 $1.00$。", "answer": "$$\\boxed{1.00}$$", "id": "1373583"}]}