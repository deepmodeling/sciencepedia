{"hands_on_practices": [{"introduction": "理解尺寸一致性 (size consistency) 和尺寸广延性 (size extensivity) 的形式化定义，是掌握这些概念的第一步。本练习提供了一个包含 $N$ 个非相互作用原子的系统的假设能量表达式。你的任务是严格应用这些定义，以确定该方法是否是尺寸一致的和/或尺寸广延的 [@problem_id:1394925]。这个实践突出了如何仅通过检查能量的数学形式来发现对这些关键性质的违背。", "problem": "在计算量子化学中，一个理论方法的两个重要性质是尺寸一致性（size consistency）和尺寸广延性（size extensivity）。\n- 如果一个由两个（或多个）任意的、无相互作用的子体系 A 和 B 组成的复合系统的计算总能量，等于各个子体系计算能量之和，即 $E(A+B) = E(A) + E(B)$，那么该方法被定义为**尺寸一致的 (size consistency)**。\n- 如果一个由$N$个相同的、无相互作用的子体系组成的系统的计算总能量，精确地等于单个子体系计算能量的$N$倍，即 $E(N) = N \\times E(1)$，那么该方法被定义为**尺寸广延的 (size extensivity)**。\n\n考虑一个假设的量子化学方法，该方法在一个由$N$个无相互作用的氦原子组成的体系上进行测试。该方法得出的体系总能量由以下表达式给出：\n$$E_{total}(N) = N E_{a} + c N^{2}$$\n其中$N$是氦原子的数量，$E_{a}$是一个常数，代表主要的单原子能量贡献，而$c$是一个小的非零常数，代表该方法中的一个系统误差。\n\n根据所提供的定义，判断这个假设的方法是否是尺寸一致的和/或尺寸广延的。\n\n下列哪个陈述是正确的？\n\nA. 该方法是尺寸一致的，但不是尺寸广延的。\n\nB. 该方法是尺寸广延的，但不是尺寸一致的。\n\nC. 该方法既是尺寸一致的，又是尺寸广延的。\n\nD. 该方法既不是尺寸一致的，也不是尺寸广延的。\n\nE. 该方法是否是尺寸一致的或尺寸广延的，取决于$E_{a}$的值。", "solution": "对于$N$个无相互作用的相同子体系（氦原子），给定方法的总能量为\n$$\nE_{total}(N) = N E_{a} + c N^{2},\n$$\n其中 $c \\neq 0$。\n\n首先，我们检验尺寸广延性。根据定义，对于$N$个相同的、无相互作用的子体系，能量必须满足\n$$\nE(N) = N \\times E(1).\n$$\n首先，根据给定的方法计算$E(1)$：\n$$\nE(1) = 1 \\cdot E_{a} + c \\cdot 1^{2} = E_{a} + c.\n$$\n那么，尺寸广延性的要求意味着\n$$\nN \\times E(1) = N(E_{a} + c) = N E_{a} + c N.\n$$\n将此与该方法的预测结果相比较：\n$$\nE_{total}(N) = N E_{a} + c N^{2}.\n$$\n这两者仅在以下情况下相等\n$$\nc N^{2} = c N \\quad \\Longleftrightarrow \\quad c N (N - 1) = 0.\n$$\n因为 $c \\neq 0$，且当 $N > 1$ 时，我们有 $N(N-1) \\neq 0$，所以该等式不成立。因此，该方法不是尺寸广延的。\n\n接下来，我们检验尺寸一致性。尺寸一致性要求对于任意不相互作用的体系 A 和 B，能量满足 $E(A+B) = E(A)+E(B)$。假设体系 A 有 $N_A$ 个原子，体系 B 有 $N_B$ 个原子。\n根据该方法：\n$E(A) = N_A E_a + c N_A^2$\n$E(B) = N_B E_a + c N_B^2$\n$E(A) + E(B) = (N_A+N_B)E_a + c(N_A^2 + N_B^2)$\n对于复合体系 A+B，总原子数为 $N_A+N_B$。其能量为：\n$E(A+B) = (N_A+N_B)E_a + c(N_A+N_B)^2 = (N_A+N_B)E_a + c(N_A^2 + 2N_A N_B + N_B^2)$\n比较 $E(A+B)$ 和 $E(A)+E(B)$，我们发现它们相差一个交叉项 $2c N_A N_B$。因为 $c \\neq 0$，只要 $N_A > 0$ 且 $N_B > 0$，这个差值就不为零。因此，该方法不是尺寸一致的。\n\n因为该方法既不是尺寸广延的，也不是尺寸一致的，所以正确的选项是D。", "answer": "$$\\boxed{D}$$", "id": "1394925"}, {"introduction": "从数学层面来看，尺寸不一致性源于何处？本练习将指导你通过一个解析推导，揭示截断的组态相互作用 (Configuration Interaction, CI) 方法中误差的来源 [@problem_id:2805781]。通过使用一个关于两个非相互作用的 $\\text{H}_2$ 分子的最小模型，你将精确地看到在二聚体计算中省略某些电子组态，如何导致其能量不等于单个分子能量之和。这个“纸笔”练习为了解量子化学理论的基石之一提供了深刻的、机理性的洞见。", "problem": "考虑两个相同的、无限分离的氢二聚体 $\\mathrm{H}_{2}^{(A)}$ 和 $\\mathrm{H}_{2}^{(B)}$，它们处于拉伸构型，并在 Born–Oppenheimer 近似（固定原子核）和每个单体使用最小基组的框架下进行处理。对于每个单体，使用一个双组态自旋匹配模型空间，该空间由限制性 Hartree–Fock (RHF) 参考行列式 $\\lvert \\Phi_{0} \\rangle$ 和相应的双激发行列式 $\\lvert \\Phi_{2} \\rangle$ 构成，在双激发行列式中，电子对从成键空间轨道被提升至反键空间轨道。对每个孤立的单体作如下假设：(i) 选择能量零点使得 $\\langle \\Phi_{0} \\rvert \\hat{H} \\lvert \\Phi_{0} \\rangle = 0$；(ii) $\\lvert \\Phi_{2} \\rangle$ 的对角能量为 $\\Delta > 0$；(iii) 两个行列式之间的非对角耦合是一个实常数 $v \\neq 0$，因此，限制在 $\\{ \\lvert \\Phi_{0} \\rangle, \\lvert \\Phi_{2} \\rangle \\}$ 空间内的电子哈密顿量为\n$$\n\\mathbf{H}_{\\text{mono}} \\;=\\; \\begin{pmatrix}\n0 & v \\\\\nv & \\Delta\n\\end{pmatrix}.\n$$\n此处的 Configuration Interaction with Singles and Doubles (CISD) 定义为：使用变分原理，在由所考虑系统的 RHF 参考态经过所有单激发和双激发得到的行列式所张成的空间内，求解薛定谔方程得到的变分解。对于处于上述双行列式空间中的双电子单体，CISD 与完全组态相互作用 (full configuration interaction) 是一致的。\n\n现在构建复合的、无相互作用的二聚体 $\\text{H}_{2}^{(A)} + \\text{H}_{2}^{(B)}$，其哈密顿量为 $\\hat{H} = \\hat{H}_{A} + \\hat{H}_{B}$，并取二聚体的 CISD 模型空间为由以下三个乘积行列式张成的空间：\n$$\n\\big\\{ \\lvert \\Phi_{0}^{A} \\Phi_{0}^{B} \\rangle,\\; \\lvert \\Phi_{2}^{A} \\Phi_{0}^{B} \\rangle,\\; \\lvert \\Phi_{0}^{A} \\Phi_{2}^{B} \\rangle \\big\\},\n$$\n该空间忽略了非关联乘积 $\\lvert \\Phi_{2}^{A} \\Phi_{2}^{B} \\rangle$，因为相对于二聚体的 RHF 参考态，它是一个四重激发。假设单体之间严格无相互作用，因此不同单体上的激发之间没有耦合，且能量移动完全是单体贡献之和。\n\n仅使用变分原理、无相互作用子系统的可分离性以及线性代数，完成以下任务：\n- 推导单个单体的 CISD 基态能量 $E_{\\text{mono}}(\\Delta, v)$。\n- 在上述三行列式空间内，推导无相互作用二聚体的 CISD 基态能量 $E_{\\text{dimer}}^{\\text{CISD}}(\\Delta, v)$。\n- 将大小一致性误差定义为 $\\delta E_{\\text{CISD}}(\\Delta, v) \\equiv E_{\\text{dimer}}^{\\text{CISD}}(\\Delta, v) - \\big[ E_{\\text{mono}}(\\Delta, v) + E_{\\text{mono}}(\\Delta, v) \\big]$，并求出 $\\delta E_{\\text{CISD}}(\\Delta, v)$ 的封闭形式解析表达式。\n\n将您的最终答案表示为关于 $\\Delta$ 和 $v$ 的单个简化解析表达式。无需取整。答案以符号形式给出；不要包含单位。", "solution": "该问题陈述是有效的，因为它具有科学依据、问题明确且客观。它提出了一个用于分析大小一致性的理论化学标准模型。我们现在开始求解。\n\n该问题要求通过三部分推导，求出简化的 Configuration Interaction with Singles and Doubles (CISD) 模型的大小一致性误差。\n\n首先，我们确定单个单体的基态能量 $E_{\\text{mono}}(\\Delta, v)$。在指定的双行列式基 $\\{ \\lvert \\Phi_{0} \\rangle, \\lvert \\Phi_{2} \\rangle \\}$ 内，单体的电子哈密顿量由下式给出：\n$$\n\\mathbf{H}_{\\text{mono}} = \\begin{pmatrix} 0 & v \\\\ v & \\Delta \\end{pmatrix}\n$$\n能量本征值通过求解久期方程 $\\det(\\mathbf{H}_{\\text{mono}} - E\\mathbf{I}) = 0$ 得到，其中 $\\mathbf{I}$ 是2维单位矩阵。\n$$\n\\det \\begin{pmatrix} -E & v \\\\ v & \\Delta - E \\end{pmatrix} = 0\n$$\n这导出了特征多项式：\n$$\n(-E)(\\Delta - E) - v^2 = 0\n$$\n$$\nE^2 - \\Delta E - v^2 = 0\n$$\n这是一个关于能量 $E$ 的二次方程。应用二次方程求根公式 $E = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}$，其中系数为 $a = 1$、$b = -\\Delta$ 和 $c = -v^2$，我们得到两个能量本征值：\n$$\nE = \\frac{\\Delta \\pm \\sqrt{(-\\Delta)^2 - 4(1)(-v^2)}}{2} = \\frac{\\Delta \\pm \\sqrt{\\Delta^2 + 4v^2}}{2}\n$$\n基态能量是这两个本征值中较小的一个。鉴于 $\\Delta > 0$ 且 $v \\neq 0$，项 $\\sqrt{\\Delta^2 + 4v^2}$ 严格大于 $\\Delta$。因此，最低的能量本征值对应于负号。这个能量就是单体的 CISD 能量，在这个双态模型中，它与完全组态相互作用 (Full Configuration Interaction, FCI) 能量是相同的。\n$$\nE_{\\text{mono}}(\\Delta, v) = \\frac{\\Delta - \\sqrt{\\Delta^2 + 4v^2}}{2}\n$$\n\n第二步，我们确定无相互作用二聚体的 CISD 基态能量 $E_{\\text{dimer}}^{\\text{CISD}}(\\Delta, v)$。二聚体哈密顿量为 $\\hat{H} = \\hat{H}_{A} + \\hat{H}_{B}$。二聚体的 CISD 模型空间由以下3个基函数张成：$\\{ \\lvert \\Psi_1 \\rangle, \\lvert \\Psi_2 \\rangle, \\lvert \\Psi_3 \\rangle \\} = \\{ \\lvert \\Phi_{0}^{A} \\Phi_{0}^{B} \\rangle, \\lvert \\Phi_{2}^{A} \\Phi_{0}^{B} \\rangle, \\lvert \\Phi_{0}^{A} \\Phi_{2}^{B} \\rangle \\}$。我们必须在此基中构建哈密顿矩阵 $\\mathbf{H}_{\\text{dimer}}^{\\text{CISD}}$。矩阵元为 $H_{ij} = \\langle \\Psi_i \\rvert \\hat{H}_A + \\hat{H}_B \\rvert \\Psi_j \\rangle$。利用单体基态的性质和无相互作用的假设：\n$H_{11} = \\langle \\Phi_{0}^{A} \\Phi_{0}^{B} \\rvert \\hat{H}_A + \\hat{H}_B \\rvert \\Phi_{0}^{A} \\Phi_{0}^{B} \\rangle = \\langle \\Phi_{0}^{A} \\rvert \\hat{H}_A \\rvert \\Phi_{0}^{A} \\rangle + \\langle \\Phi_{0}^{B} \\rvert \\hat{H}_B \\rvert \\Phi_{0}^{B} \\rangle = 0 + 0 = 0$.\n$H_{22} = \\langle \\Phi_{2}^{A} \\Phi_{0}^{B} \\rvert \\hat{H}_A + \\hat{H}_B \\rvert \\Phi_{2}^{A} \\Phi_{0}^{B} \\rangle = \\langle \\Phi_{2}^{A} \\rvert \\hat{H}_A \\rvert \\Phi_{2}^{A} \\rangle + \\langle \\Phi_{0}^{B} \\rvert \\hat{H}_B \\rvert \\Phi_{0}^{B} \\rangle = \\Delta + 0 = \\Delta$.\n$H_{33} = \\langle \\Phi_{0}^{A} \\Phi_{2}^{B} \\rvert \\hat{H}_A + \\hat{H}_B \\rvert \\Phi_{0}^{A} \\Phi_{2}^{B} \\rangle = \\langle \\Phi_{0}^{A} \\rvert \\hat{H}_A \\rvert \\Phi_{0}^{A} \\rangle + \\langle \\Phi_{2}^{B} \\rvert \\hat{H}_B \\rvert \\Phi_{2}^{B} \\rangle = 0 + \\Delta = \\Delta$.\n$H_{12} = \\langle \\Phi_{0}^{A} \\Phi_{0}^{B} \\rvert \\hat{H}_A + \\hat{H}_B \\rvert \\Phi_{2}^{A} \\Phi_{0}^{B} \\rangle = \\langle \\Phi_{0}^{A} \\rvert \\hat{H}_A \\rvert \\Phi_{2}^{A} \\rangle \\langle \\Phi_{0}^{B} \\rvert \\Phi_{0}^{B} \\rangle = v \\cdot 1 = v$.\n$H_{13} = \\langle \\Phi_{0}^{A} \\Phi_{0}^{B} \\rvert \\hat{H}_A + \\hat{H}_B \\rvert \\Phi_{0}^{A} \\Phi_{2}^{B} \\rangle = \\langle \\Phi_{0}^{A} \\rvert \\Phi_{0}^{A} \\rangle \\langle \\Phi_{0}^{B} \\rvert \\hat{H}_B \\rvert \\Phi_{2}^{B} \\rangle = 1 \\cdot v = v$.\n$H_{23} = \\langle \\Phi_{2}^{A} \\Phi_{0}^{B} \\rvert \\hat{H}_A + \\hat{H}_B \\rvert \\Phi_{0}^{A} \\Phi_{2}^{B} \\rangle = 0$，因为哈密顿量只耦合同一单体内的态。\n得到的厄米矩阵为：\n$$\n\\mathbf{H}_{\\text{dimer}}^{\\text{CISD}} = \\begin{pmatrix} 0 & v & v \\\\ v & \\Delta & 0 \\\\ v & 0 & \\Delta \\end{pmatrix}\n$$\n为了找到本征值 $E$，我们求解特征方程 $\\det(\\mathbf{H}_{\\text{dimer}}^{\\text{CISD}} - E\\mathbf{I}) = 0$：\n$$\n\\det \\begin{pmatrix} -E & v & v \\\\ v & \\Delta - E & 0 \\\\ v & 0 & \\Delta - E \\end{pmatrix} = -E(\\Delta - E)^2 - v(v(\\Delta-E)) - v(-v(\\Delta-E)) = 0\n$$\n$$\n-E(\\Delta - E)^2 - 2v^2(\\Delta - E) = 0\n$$\n$$\n-(\\Delta - E)[E(\\Delta - E) + 2v^2] = 0\n$$\n此方程产生两种可能性：\n1. $\\Delta - E = 0 \\implies E = \\Delta$.\n2. $E(\\Delta - E) + 2v^2 = 0 \\implies E^2 - \\Delta E - 2v^2 = 0$.\n第二种情况是一个二次方程，其解为：\n$$\nE = \\frac{\\Delta \\pm \\sqrt{\\Delta^2 - 4(1)(-2v^2)}}{2} = \\frac{\\Delta \\pm \\sqrt{\\Delta^2 + 8v^2}}{2}\n$$\n因此，三个本征值为 $\\Delta$、$\\frac{1}{2}(\\Delta + \\sqrt{\\Delta^2 + 8v^2})$ 和 $\\frac{1}{2}(\\Delta - \\sqrt{\\Delta^2 + 8v^2})$。基态能量是这些值中最低的一个。由于 $\\sqrt{\\Delta^2 + 8v^2} > \\Delta$，最低的本征值为：\n$$\nE_{\\text{dimer}}^{\\text{CISD}}(\\Delta, v) = \\frac{\\Delta - \\sqrt{\\Delta^2 + 8v^2}}{2}\n$$\n\n第三步，我们计算大小一致性误差 $\\delta E_{\\text{CISD}}(\\Delta, v)$，其定义为二聚体能量与两倍单体能量之差。\n$$\n\\delta E_{\\text{CISD}}(\\Delta, v) = E_{\\text{dimer}}^{\\text{CISD}}(\\Delta, v) - 2 E_{\\text{mono}}(\\Delta, v)\n$$\n代入上面推导出的表达式：\n$$\n\\delta E_{\\text{CISD}}(\\Delta, v) = \\left( \\frac{\\Delta - \\sqrt{\\Delta^2 + 8v^2}}{2} \\right) - 2\\left( \\frac{\\Delta - \\sqrt{\\Delta^2 + 4v^2}}{2} \\right)\n$$\n$$\n\\delta E_{\\text{CISD}}(\\Delta, v) = \\frac{\\Delta - \\sqrt{\\Delta^2 + 8v^2}}{2} - (\\Delta - \\sqrt{\\Delta^2 + 4v^2})\n$$\n$$\n\\delta E_{\\text{CISD}}(\\Delta, v) = \\frac{\\Delta - \\sqrt{\\Delta^2 + 8v^2} - 2\\Delta + 2\\sqrt{\\Delta^2 + 4v^2}}{2}\n$$\n$$\n\\delta E_{\\text{CISD}}(\\Delta, v) = \\frac{-\\Delta - \\sqrt{\\Delta^2 + 8v^2} + 2\\sqrt{\\Delta^2 + 4v^2}}{2}\n$$\n此表达式可以重排为一个结构更清晰的形式：\n$$\n\\delta E_{\\text{CISD}}(\\Delta, v) = \\sqrt{\\Delta^2 + 4v^2} - \\frac{\\Delta + \\sqrt{\\Delta^2 + 8v^2}}{2}\n$$\n这是大小一致性误差的最终封闭形式表达式。由于 $v \\neq 0$，该误差通常不为零，这表明截断的 CISD 方法不满足大小一致性。这种失败源于从二聚体的模型空间中省略了非关联的四重激发组态 $\\lvert \\Phi_{2}^{A} \\Phi_{2}^{B} \\rangle$。", "answer": "$$\n\\boxed{\\sqrt{\\Delta^2 + 4v^2} - \\frac{\\Delta + \\sqrt{\\Delta^2 + 8v^2}}{2}}\n$$", "id": "2805781"}, {"introduction": "在这最后一个练习中，理论与实践相结合，你将扮演一名计算化学家，分析方法的性能。给定用多种常见量子化学方法计算的非相互作用水分子簇的模拟能量数据 [@problem_id:2805718]，你将编写一个简短的程序来对这些数据进行定量分析。这种动手数据分析将生动地验证哪些方法是尺寸广延的（如 HF, MP2, CCSD），而哪些不是（如 CISD），从而强化了在实际化学建模中选择正确方法的重要性。", "problem": "你的任务是为无相互作用的水分子设计一个碎片加成标度研究，以在高等研究生理论化学的层面上探究大小一致性（size consistency）和大小广延性（size extensivity）的概念。其基本出发点是无相互作用碎片的非相对论电子能量的加和性：对于一个由 $N$ 个无相互作用的相同子系统组成的体系，其哈密顿量是可分离的，即 $\\hat{H} = \\sum_{k=1}^{N} \\hat{H}_k$，且精确的基态能量是加和的，即 $E(N) = \\sum_{k=1}^{N} E_k = N E(1)$。如果一个方法对于无相互作用的相同子系统能够保持 $E(N) = N E(1)$，那么该方法就是大小广延的；等价地，当外推至 $N=0$ 时，总能量随 $N$ 线性标度变化且截距为零。与此线性关系的偏差量化了大小广延性的失效程度。\n\n编写一个完整、可运行的程序，该程序使用最小二乘线性分析和曲率诊断，对无相互作用的 $(\\mathrm{H_2O})_N$ 团簇的 $E(N)$ 数据进行大小广延性的定量诊断。该程序必须：\n\n- 使用以下带有方法标签的数据集测试套件。每个数据集包含在相互作用消失的极大间距下，$N=1,2,3,4,5,6$ 时的能量 $E(N)$（单位为 Hartree）。四种方法分别是 Hartree–Fock (HF)、二阶 Møller–Plesset 微扰理论 (MP2)、包含单激发和双激发的耦合簇理论 (CCSD) 和包含单激发和双激发的组态相互作用 (CISD)。数据数组如下：\n  - HF: $[-76.0260,-152.0520,-228.0780,-304.1040,-380.1300,-456.1560]$\n  - MP2: $[-76.3000,-152.6000,-228.9000,-305.2000,-381.5000,-457.8000]$\n  - CCSD: $[-76.3500,-152.7000,-229.0500,-305.4000,-381.7500,-458.1000]$\n  - CISD: $[-76.3200,-152.6399,-228.9597,-305.2794,-381.5990,-457.9185]$\n- 对每种方法，计算以下诊断指标：\n  1. 约束通过原点的最佳拟合斜率 $s_0$，其定义为最小化 $\\sum_{i=1}^{M} \\left(E(N_i)-s N_i\\right)^2$，其中 $N_i \\in \\{1,2,3,4,5,6\\}$。其闭式表达式为 $s_0 = \\dfrac{\\sum_i N_i E(N_i)}{\\sum_i N_i^2}$。以 Hartree 为单位报告 $s_0$。\n  2. 求解 $E(N) \\approx s N + b$ 的无约束最小二乘线性拟合参数 $(s,b)$。以 Hartree 为单位报告截距 $b$。\n  3. 约束拟合的均方根偏差 (root-mean-square deviation)，$\\mathrm{RMSD}_0 = \\sqrt{\\dfrac{1}{M}\\sum_i \\left(E(N_i)-s_0 N_i\\right)^2}$，单位为 Hartree。\n  4. 最大绝对二阶有限差分（一个离散的曲率诊断指标），$\\max_{i=2,3,4,5} \\left|E(N_{i+1}) - 2 E(N_i) + E(N_{i-1})\\right|$，单位为 Hartree。\n  5. 相对于 $E(1)$ 定义的最大绝对大小广延性误差，$\\max_{i} \\left|E(N_i) - N_i E(1)\\right|$，单位为 Hartree。\n- 当且仅当以下三项在严格的数值容差内同时成立时，将每种方法分类为通过大小广延性检验：$\\left|b\\right| \\le \\tau_b$，$\\max\\left|\\Delta^2 E\\right| \\le \\tau_c$，以及 $\\max\\left|E(N)-N E(1)\\right| \\le \\tau_\\varepsilon$，容差分别为 $\\tau_b = 10^{-8}$ Hartree，$\\tau_c = 10^{-8}$ Hartree，以及 $\\tau_\\varepsilon = 10^{-8}$ Hartree。\n\n你的程序应生成单行输出，其内容为 JSON 格式的数组的数组，每个内部数组的格式为 $[m, s_0, b, \\mathrm{RMSD}_0, \\max\\left|\\Delta^2 E\\right|, \\max\\left|E(N)-N E(1)\\right|, \\mathrm{pass}]$。此处 $m$ 是整数方法索引，映射关系为 $m=0$ 代表 HF，$m=1$ 代表 MP2，$m=2$ 代表 CCSD，$m=3$ 代表 CISD；$s_0$、$b$、$\\mathrm{RMSD}_0$、$\\max\\left|\\Delta^2 E\\right|$ 和 $\\max\\left|E(N)-N E(1)\\right|$ 是以 Hartree 为单位的浮点数；$\\mathrm{pass}$ 是一个布尔值。输出必须打印为单行，不含任何额外文本。所有浮点数都应解释为以 Hartree 为单位，数字旁不应打印单位。\n\n测试套件覆盖要求：\n- HF、MP2 和 CCSD 数据集代表理想情况，其中严格的大小广延性应被精确满足，从而得到线性标度 $E(N)=N E(1)$、零截距、零曲率和零偏差。\n- CISD 数据集编码了一个受控的二次偏差，以模拟非关联激发项的缺失，导致次线性的相关能标度以及 $E(N)$ 的正曲率；它必须不能通过上述容差检验。\n\n角度单位不适用。不使用百分比；如果需要，任何比率都必须以小数形式返回，但本问题不要求比率。", "solution": "该问题陈述已经过严格验证，被认为是有效的。其科学基础植根于量子化学原理，特别是大小广延性（size extensivity）和大小一致性（size consistency）的概念。该问题是适定的（well-posed），提供了所有必要的数据、计算所需诊断指标的明确数学公式以及无歧义的分类标准。所提供的 Hartree-Fock ($HF$)、Møller-Plesset 微扰理论 ($MP2$)、包含单激发和双激发的耦合簇理论 ($CCSD$) 和包含单激发和双激发的组态相互作用 ($CISD$) 方法的能量数据集与已建立的理论知识一致：$HF$、$MP2$ 和 $CCSD$ 是大小广延的方法，而 $CISD$ 不是。任务是实现一个数值分析来对给定数据验证这一性质。\n\n所考察的核心原理是大小广延性。如果一个理论方法对于由 $N$ 个无相互作用的相同子系统组成的体系，其计算的能量 $E(N)$ 随 $N$ 线性标度变化，那么该方法就是大小广延的。在数学上，这表示为 $E(N) = N \\times E(1)$，其中 $E(1)$ 是单个子系统的能量。任何与此严格线性关系的偏差都表明大小广延性的失效，这是量子化学模型中的一个严重缺陷，因为它会导致较大体系出现非物理的能量标度。\n\n程序将分析所提供的针对四种指定方法的能量数据 $E(N)$（其中 $N \\in \\{1, 2, 3, 4, 5, 6\\}$）。对每种方法，将计算以下五个定量诊断指标，以探查与线性标度的偏差。\n\n1.  约束线性拟合：将一个约束通过原点的线性模型 $E(N) = s_0 N$ 拟合到数据上。最优斜率 $s_0$ 由最小二乘公式 $s_0 = \\frac{\\sum_{i=1}^{M} N_i E(N_i)}{\\sum_{i=1}^{M} N_i^2}$ 给出，其中 $M=6$ 是数据点的数量。对于一个大小广延的方法，该斜率 $s_0$ 应等于单体能量 $E(1)$。\n\n2.  无约束线性拟合：将一个通用线性模型 $E(N) = sN + b$ 拟合到数据上。截距 $b$ 在 $N=0$ 个碎片的理论极限下提供了误差的直接度量。对于一个完美大小广延的方法，数据必须位于一条通过原点的直线上，因此截距 $b$ 必须为零。\n\n3.  约束均方根偏差 ($\\mathrm{RMSD}_0$)：约束拟合的质量由均方根偏差来量化，定义为 $\\mathrm{RMSD}_0 = \\sqrt{\\frac{1}{M}\\sum_{i=1}^{M} (E(N_i) - s_0 N_i)^2}$。该指标捕捉了偏离“通过原点的完美线性关系”的总体幅度。\n\n4.  曲率诊断：能量的二阶有限差分 $\\Delta^2 E_i = E(N_{i+1}) - 2E(N_i) + E(N_{i-1})$，可作为二阶导数 $\\frac{d^2E}{dN^2}$ 的离散模拟。线性函数的二阶导数为零。我们计算该量在适用索引范围内的最大绝对值 $\\max |\\Delta^2 E|$。非零值表示能量标度是非线性的，即具有曲率。\n\n5.  直接大小广延性误差：检验大小广延性的最直接方法是为每个数据点计算误差 $\\delta_i = E(N_i) - N_i E(1)$，并找出最大绝对误差 $\\max_i |\\delta_i|$。对于一个大小广延的方法，对所有 $N_i$，此误差必须为零。\n\n当且仅当一个方法通过了针对严格数值容差的三项同步检查，它才被分类为大小广延的：无约束截距的绝对值 $|b|$ 必须小于或等于 $\\tau_b = 10^{-8}$ Hartree，最大曲率 $\\max|\\Delta^2 E|$ 必须小于或等于 $\\tau_c = 10^{-8}$ Hartree，以及最大直接广延性误差 $\\max|E(N)-N E(1)|$ 必须小于或等于 $\\tau_\\varepsilon = 10^{-8}$ Hartree。\n\n实现将使用 Python 语言完成，利用 `numpy` 库进行高效的基于数组的数值计算。将设计一个单一函数来处理每种方法的能量数据，计算五个诊断指标并应用分类逻辑。该函数将迭代地应用于所有四个数据集。最终结果，包括方法索引 $m$（$0$ 代表 $HF$，$1$ 代表 $MP2$，$2$ 代表 $CCSD$，$3$ 代表 $CISD$）、五个计算出的诊断值以及一个布尔值 `pass` 标志，将按照问题中的规定格式化为符合 JSON 规范的数组的数组，并打印到标准输出。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Performs a size-extensivity analysis on quantum chemistry energy data.\n    \"\"\"\n    # Define the datasets for each method as specified in the problem.\n    # The structure is a list of tuples, where each tuple contains:\n    # (method_index, numpy_array_of_energies_in_Hartree)\n    test_cases = [\n        (0, np.array([-76.0260, -152.0520, -228.0780, -304.1040, -380.1300, -456.1560])), # HF\n        (1, np.array([-76.3000, -152.6000, -228.9000, -305.2000, -381.5000, -457.8000])), # MP2\n        (2, np.array([-76.3500, -152.7000, -229.0500, -305.4000, -381.7500, -458.1000])), # CCSD\n        (3, np.array([-76.3200, -152.6399, -228.9597, -305.2794, -381.5990, -457.9185]))  # CISD\n    ]\n\n    # Define the vector of system sizes N and its length M.\n    N_values = np.arange(1, 7, dtype=float)\n    M = len(N_values)\n    \n    # Define the tolerances for the classification.\n    tau_b = 1.0e-8  # Tolerance for the intercept\n    tau_c = 1.0e-8  # Tolerance for the curvature\n    tau_e = 1.0e-8  # Tolerance for the extensivity error\n\n    all_results = []\n\n    for m, E_values in test_cases:\n        # Diagnostic 1: Best-fit slope constrained through the origin, s_0\n        s0 = np.sum(N_values * E_values) / np.sum(N_values**2)\n\n        # Diagnostic 2: Unconstrained least-squares fit E = s*N + b\n        A = np.vstack([N_values, np.ones(M)]).T\n        s, b = np.linalg.lstsq(A, E_values, rcond=None)[0]\n\n        # Diagnostic 3: Root-mean-square deviation for the constrained fit, RMSD_0\n        residuals_0 = E_values - s0 * N_values\n        rmsd0 = np.sqrt(np.mean(residuals_0**2))\n\n        # Diagnostic 4: Maximum absolute second finite difference (curvature)\n        # np.diff with n=2 computes E[i+2] - 2*E[i+1] + E[i]\n        second_diffs = np.diff(E_values, n=2)\n        max_curvature = np.max(np.abs(second_diffs)) if len(second_diffs) > 0 else 0.0\n\n        # Diagnostic 5: Maximum absolute size-extensivity error relative to E(1)\n        E1 = E_values[0]\n        extensivity_errors = np.abs(E_values - N_values * E1)\n        max_extensivity_error = np.max(extensivity_errors)\n\n        # Classification: Check if the method passes the size-extensivity test\n        is_pass = (np.abs(b) = tau_b) and \\\n                  (max_curvature = tau_c) and \\\n                  (max_extensivity_error = tau_e)\n        \n        # Store results for this method\n        result = [m, s0, b, rmsd0, max_curvature, max_extensivity_error, is_pass]\n        all_results.append(result)\n\n    # Format the final output string as a JSON-like array of arrays.\n    # Booleans are explicitly converted to lowercase 'true'/'false' for JSON compatibility.\n    formatted_results = []\n    for res in all_results:\n        # The last element is the boolean 'pass' flag.\n        bool_str = \"true\" if res[-1] else \"false\"\n        # Format the numbers and the boolean into a string representing the inner array.\n        inner_str = f\"[{res[0]},{res[1]},{res[2]},{res[3]},{res[4]},{res[5]},{bool_str}]\"\n        formatted_results.append(inner_str)\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2805718"}]}