{"hands_on_practices": [{"introduction": "理论学习之后，最好的巩固方式莫过于亲手实践。我们将从最直观的数值求解方法——前向欧拉法（又称显式欧拉法）开始。这个练习将该方法应用于一个简单的一阶衰变反应，让你具体体验如何用离散的时间步来近似一个连续的化学过程，为理解更复杂的求解器打下坚实的基础。[@problem_id:1479211]", "problem": "在药理学中，血液中的药物浓度随时间的变化是决定其药效和给药方案的关键因素。一个简化的药物消除模型假设药物通过一级过程从体内清除。对于此类过程，药物浓度 $C$ 的变化率与其当前浓度成正比。这可以用微分方程 $\\frac{dC}{dt} = -kC$ 来描述，其中 $k$ 是消除速率常数。\n\n为了在计算上模拟这一过程而无需解析地求解该微分方程，可以使用数值方法。前向欧拉法是用于此目的的一种基本技术。它根据系统的当前状态来近似其在未来时间步的状态。设 $C_n$ 为药物在时间 $t_n$ 的浓度。我们希望求出在下一个时间步 $t_{n+1} = t_n + \\Delta t$ 时的浓度 $C_{n+1}$，其中 $\\Delta t$ 是一个小的恒定时间步长。\n\n推导用 $C_n$、速率常数 $k$ 和时间步长 $\\Delta t$ 表示 $C_{n+1}$ 的迭代公式。", "solution": "我们从由常微分方程 $ \\frac{dC}{dt} = -k C $ 给出的一级消除模型开始。为了使用前向欧拉法在数值上推进解，我们使用针对初值问题 $y' = f(t,y)$ 的通用更新公式：\n$$\ny_{n+1} = y_{n} + \\Delta t\\, f(t_{n}, y_{n}).\n$$\n将 $y$ 等同于 $C$ 并且 $f(t,C) = -k C$，我们代入欧拉更新公式：\n$$\nC_{n+1} = C_{n} + \\Delta t \\left(-k C_{n}\\right).\n$$\n合并同类项，我们得到\n$$\nC_{n+1} = \\left(1 - k \\Delta t\\right) C_{n}.\n$$\n这就是用 $C_{n}$、$k$ 和 $\\Delta t$ 表示 $C_{n+1}$ 的所求迭代公式。", "answer": "$$\\boxed{\\left(1 - k \\Delta t\\right) C_{n}}$$", "id": "1479211"}, {"introduction": "虽然显式欧拉法很直观，但它在处理刚性系统时会遇到稳定性问题。这个练习将介绍一种更稳健的替代方案：后向欧拉法（或隐式欧拉法）。通过比较其在线性和非线性反应动力学中的应用，你将发现一个根本性的权衡：隐式方法在每个时间步都将微分问题转化为一个代数问题，而这个新问题的复杂性直接取决于原反应的性质。[@problem_id:1479203]", "problem": "在计算化学中，当模拟具有巨大差异时间尺度的反应动力学时，常常会出现刚性常微分方程（ODEs）。在这种情况下，由于其稳定性，通常首选隐式数值方法，例如后向欧拉法。后向欧拉法通过根据以下迭代公式以步长 $h$ 向前步进，来近似形如 $\\frac{dy}{dt} = f(t, y)$ 的常微分方程的解：\n\n$$y_{n+1} = y_n + h \\cdot f(t_{n+1}, y_{n+1})$$\n\n其中，$y_n$ 是在时间 $t_n$ 的已知值，$y_{n+1}$ 是在时间 $t_{n+1} = t_n + h$ 的未知值。请注意，求解未知数 $y_{n+1}$ 需要在每个时间步求解一个代数方程。\n\n考虑在独立的间歇式反应器中发生的两个独立的基元化学反应：\n\n**系统1：** 物种 A 的一级不可逆衰变，由以下速率定律描述：\n$$\\frac{d[A]}{dt} = -k[A]$$\n其中 $[A]$ 是物种 A 的浓度，$k$ 是一级速率常数。\n\n**系统2：** 物种 B 的三级不可逆衰变，由以下速率定律描述：\n$$\\frac{d[B]}{dt} = -k'[B]^3$$\n其中 $[B]$ 是物种 B 的浓度，$k'$ 是三级速率常数。\n\n当应用后向欧拉法的一个步骤来确定下一个时间步的浓度（系统1为 $[A]_{n+1}$，系统2为 $[B]_{n+1}$）时，在每个系统中，必须为未知浓度求解的代数方程属于哪一类？\n\nA. 系统1：线性；系统2：线性\n\nB. 系统1：线性；系统2：二次\n\nC. 系统1：线性；系统2：三次\n\nD. 系统1：二次；系统2：四次\n\nE. 系统1：线性；系统2：超越\n\nF. 系统1：指数；系统2：指数", "solution": "我们应用后向欧拉法，对于一个常微分方程 $\\frac{dy}{dt}=f(t,y)$，该方法给出以下隐式更新\n$$\ny_{n+1}=y_{n}+h\\,f(t_{n+1},y_{n+1}),\n$$\n其中 $h$ 是时间步长，$y_{n}$ 是已知的，而 $y_{n+1}$ 是每一步需要通过解代数方程求得的未知数。\n\n对于系统1，$\\frac{d[A]}{dt}=-k[A]$ 是自治的，其 $f(y)=-k y$。后向欧拉法步骤给出\n$$\n[A]_{n+1}=[A]_{n}+h\\big(-k\\,[A]_{n+1}\\big).\n$$\n合并未知项，\n$$\n[A]_{n+1}+h k\\,[A]_{n+1}=[A]_{n},\n$$\n可以写成\n$$\n(1+h k)\\,[A]_{n+1}=[A]_{n}.\n$$\n这是一个关于未知数 $[A]_{n+1}$ 的线性代数方程。\n\n对于系统2，$\\frac{d[B]}{dt}=-k'[B]^{3}$ 是自治的，其 $f(y)=-k' y^{3}$。后向欧拉法步骤给出\n$$\n[B]_{n+1}=[B]_{n}+h\\big(-k'\\,[B]_{n+1}^{3}\\big).\n$$\n整理成标准多项式形式，\n$$\nh k'\\,[B]_{n+1}^{3}+[B]_{n+1}-[B]_{n}=0.\n$$\n这是一个关于未知数 $[B]_{n+1}$ 的三次代数方程。\n\n因此，方程的类型是：系统1产生一个线性方程，系统2产生一个三次方程。", "answer": "$$\\boxed{C}$$", "id": "1479203"}, {"introduction": "真实的化学系统通常是包含多个相互作用反应的网络，需要用常微分方程组（ODEs）来描述。这个练习将带领我们从单个方程过渡到一个简单的反应网络。你将为这个系统计算雅可比矩阵（Jacobian matrix），这是高级隐式求解器在处理刚性系统时，用以高效处理物种间相互依赖关系的关键数学工具。[@problem_id:1479240]", "problem": "在计算化学领域，速率定律的数值积分是一项基本任务。对于反应速率范围很宽的反应网络，其产生的常微分方程(ODEs)组通常是“刚性”的，因此必须使用隐式数值求解器。这些求解器的一个关键组成部分是速率定律系统的雅可比矩阵。\n\n考虑一个在等容间歇式反应器中发生的简单的不可逆连串反应网络：\n$$ A \\xrightarrow{k_1} B \\xrightarrow{k_2} C $$\n两个反应步骤均为一级过程。物种 $A$ 转化为物种 $B$ 的速率常数为 $k_1$，物种 $B$ 转化为物种 $C$ 的速率常数为 $k_2$。\n\n系统的状态可以通过浓度向量 $\\mathbf{x} = ([A], [B], [C])^T$ 来描述，其中 $[A]$、$[B]$ 和 $[C]$ 分别代表相应物种的浓度。这些浓度随时间的演变由以下常微分方程组决定，该方程组可以写作 $\\frac{d\\mathbf{x}}{dt} = \\mathbf{f}(\\mathbf{x})$：\n$$ \\frac{d[A]}{dt} = -k_1 [A] $$\n$$ \\frac{d[B]}{dt} = k_1 [A] - k_2 [B] $$\n$$ \\frac{d[C]}{dt} = k_2 [B] $$\n\n你的任务是确定该系统的雅可比矩阵 $J$。雅可比矩阵的元素定义为 $J_{ij} = \\frac{\\partial f_i}{\\partial x_j}$，其中 $f_i$ 是第 $i$ 个速率方程，$x_j$ 是状态向量中第 $j$ 个物种的浓度。用速率常数 $k_1$ 和 $k_2$ 将你的答案表示成一个矩阵。", "solution": "我们已知状态向量 $\\mathbf{x}=([A],[B],[C])^{T}$ 的向量场 $\\mathbf{f}(\\mathbf{x})$ 为：\n$$\nf_{1}([A],[B],[C])=-k_{1}[A], \\quad\nf_{2}([A],[B],[C])=k_{1}[A]-k_{2}[B], \\quad\nf_{3}([A],[B],[C])=k_{2}[B].\n$$\n雅可比矩阵 $J$ 定义为 $J_{ij}=\\frac{\\partial f_{i}}{\\partial x_{j}}$，其中 $(x_{1},x_{2},x_{3})=([A],[B],[C])$。我们利用偏微分法则和速率定律的线性特性来计算每个偏导数。\n\n对于 $f_{1}=-k_{1}[A]$：\n$$\n\\frac{\\partial f_{1}}{\\partial [A]}=-k_{1}, \\quad \\frac{\\partial f_{1}}{\\partial [B]}=0, \\quad \\frac{\\partial f_{1}}{\\partial [C]}=0.\n$$\n\n对于 $f_{2}=k_{1}[A]-k_{2}[B]$：\n$$\n\\frac{\\partial f_{2}}{\\partial [A]}=k_{1}, \\quad \\frac{\\partial f_{2}}{\\partial [B]}=-k_{2}, \\quad \\frac{\\partial f_{2}}{\\partial [C]}=0.\n$$\n\n对于 $f_{3}=k_{2}[B]$：\n$$\n\\frac{\\partial f_{3}}{\\partial [A]}=0, \\quad \\frac{\\partial f_{3}}{\\partial [B]}=k_{2}, \\quad \\frac{\\partial f_{3}}{\\partial [C]}=0.\n$$\n\n将这些项组合起来，得到雅可比矩阵\n$$\nJ=\\begin{pmatrix}\n-k_{1} & 0 & 0 \\\\\nk_{1} & -k_{2} & 0 \\\\\n0 & k_{2} & 0\n\\end{pmatrix}.\n$$", "answer": "$$\\boxed{\\begin{pmatrix}-k_{1} & 0 & 0 \\\\ k_{1} & -k_{2} & 0 \\\\ 0 & k_{2} & 0\\end{pmatrix}}$$", "id": "1479240"}]}