{"hands_on_practices": [{"introduction": "化学朗之万方程（Chemical Langevin Equation, CLE）是连接离散随机事件和连续确定性模型的桥梁。一个基本的出发点是理解CLE的漂移项如何与我们熟悉的宏观速率方程相关联。本练习将指导您使用漂移项来计算一个包含物种 $X$ 的简单生灭过程在稳态下的平均分子数，这是系统生物学中的一个基石模型。[@problem_id:1517651]", "problem": "考虑一个细胞室内的简单生化反应网络，其中只涉及单一分子种类 $X$。$X$ 分子以恒定速率产生，并遵循一级动力学降解。这两个反应是：\n1.  生成：$\\emptyset \\xrightarrow{k_1} X$\n2.  降解：$X \\xrightarrow{k_2} \\emptyset$\n\n生成反应以零级速率常数 $k_1$（单位为分子/单位时间）发生，反映了来自丰富来源的恒定流入。降解反应是一个一级过程，其速率常数为 $k_2$（单位为时间倒数）。\n\n物种 $X$ 的分子数随时间的变化（记为 $n(t)$）可以用化学朗之万方程（CLE）来近似。CLE 的漂移项对应于描述分子平均数确定性变化的宏观速率方程。\n\n通过分析漂移项，确定系统达到稳态时物种 $X$ 的平均分子数。请用包含 $k_1$ 和 $k_2$ 的解析表达式表示你的答案。", "solution": "我们考虑这两个反应及其化学计量和倾向函数：\n- 生成反应：$\\emptyset \\to X$ 对 $n(t)$ 的化学计量变化为 $+1$，其零级倾向函数为 $a_{1}(n) = k_{1}$。\n- 降解反应：$X \\to \\emptyset$ 对 $n(t)$ 的化学计量变化为 $-1$，其一级倾向函数为 $a_{2}(n) = k_{2} n(t)$。\n\n化学朗之万方程的漂移项等于通过将化学计量变化乘以倾向函数并求和得到的确定性速率方程。因此，描述平均动力学的漂移（宏观）方程为\n$$\n\\frac{dn(t)}{dt} = (+1)\\,a_{1}(n) + (-1)\\,a_{2}(n) = k_{1} - k_{2}\\,n(t).\n$$\n在稳态时，平均分子数是恒定的，所以我们将时间导数设为零：\n$$\n0 = k_{1} - k_{2}\\,n_{\\text{ss}}.\n$$\n求解 $n_{\\text{ss}}$ 得\n$$\nn_{\\text{ss}} = \\frac{k_{1}}{k_{2}}.\n$$\n这就是在稳态下 $X$ 的平均分子数。", "answer": "$$\\boxed{\\frac{k_{1}}{k_{2}}}$$", "id": "1517651"}, {"introduction": "漂移项描述了系统的平均行为，而扩散项则真正捕捉了化学系统的随机本质——即内在噪声。本练习将超越简单的线性反应，探讨一个涉及蛋白质 $P$ 二聚化的系统，这是一种在细胞信号传导中常见的二级过程。您将为这个非线性系统构建扩散项，从而锻炼将CLE核心原理应用于更复杂反应方案的能力。[@problem_id:1517636]", "problem": "在一个简化的细胞内蛋白质调控模型中，一种特定的蛋白质 $P$ 由其组成氨基酸合成，并随后通过二聚化被移除。设 $n(t)$ 为在时间 $t$ 时系统中 $P$ 物种的单个蛋白质分子（单体）的数量。控制 $P$ 种群数量的两个生物化学反应是：\n\n1.  **生成：** 一个单体 $P$ 以恒定速率合成。这是一个零级过程，$\\emptyset \\to P$，其倾向函数为 $a_1(n) = k_1$，其中 $k_1$ 是一个恒定的生成速率系数。\n2.  **降解：** 两个 $P$ 单体结合形成一个二聚体，该二聚体随后立即被降解。这个二级过程，$2P \\to \\emptyset$，其倾向函数为 $a_2(n) = k_2 \\frac{n(n-1)}{2}$，其中 $k_2$ 是二聚化速率常数。\n\n单体种群 $n(t)$ 的随机动力学可以用化学朗之万方程 (CLE) 来近似，其一般形式为：\n$$ \\frac{dn}{dt} = F(n) + G(n) \\Gamma(t) $$\n此处，$F(n)$ 是漂移项，描述了平均变化率；$G(n)$ 是噪声幅度项；而 $\\Gamma(t)$ 表示具有标准性质的高斯白噪声。\n\n确定扩散项的表达式，该项定义为噪声幅度的平方 $G(n)^2$。请用参数 $k_1$、$k_2$ 和分子数 $n$ 将您的答案表达为闭合形式的解析表达式。", "solution": "我们用两个反应及其在单体数量 $n(t)$ 上的化学计量变化来对该系统建模：\n- 生成反应 $\\emptyset \\to P$ 的化学计量变化为 $\\nu_{1} = +1$，倾向函数为 $a_{1}(n) = k_{1}$。\n- 二聚化-降解反应 $2P \\to \\emptyset$ 的化学计量变化为 $\\nu_{2} = -2$，倾向函数为 $a_{2}(n) = k_{2} \\frac{n(n-1)}{2}$。\n\n对每个反应带有独立高斯白噪声项的化学朗之万方程 (CLE) 为\n$$\n\\frac{dn}{dt} = \\sum_{r} \\nu_{r} a_{r}(n) + \\sum_{r} \\nu_{r} \\sqrt{a_{r}(n)}\\, \\Gamma_{r}(t),\n$$\n其中，每个 $\\Gamma_{r}(t)$ 都是一个独立的高斯白噪声，其均值为零，自相关振幅为单位一。在此表示法中，漂移项为\n$$\nF(n) = \\nu_{1} a_{1}(n) + \\nu_{2} a_{2}(n) = k_{1} - 2 \\cdot k_{2} \\frac{n(n-1)}{2} = k_{1} - k_{2} n(n-1).\n$$\n\n为将 CLE 重写为 $$ \\frac{dn}{dt} = F(n) + G(n)\\,\\Gamma(t), $$ 的形式（其中 $\\Gamma(t)$ 为单个标准白噪声），我们合并各独立噪声的贡献。组合噪声项的方差等于各个独立项的方差之和，这给出\n$$\nG(n)^{2} = \\sum_{r} \\nu_{r}^{2} a_{r}(n).\n$$\n代入倾向函数和化学计量得到\n$$\nG(n)^{2} = (\\nu_{1})^{2} a_{1}(n) + (\\nu_{2})^{2} a_{2}(n) = (1)^{2} k_{1} + (-2)^{2} \\left(k_{2} \\frac{n(n-1)}{2}\\right).\n$$\n化简得，\n$$\nG(n)^{2} = k_{1} + 4 \\cdot k_{2} \\frac{n(n-1)}{2} = k_{1} + 2 k_{2} n(n-1).\n$$\n这就是扩散项的闭合形式解析表达式。", "answer": "$$\\boxed{k_{1} + 2 k_{2} n(n-1)}$$", "id": "1517636"}, {"introduction": "从解析理论转向计算模拟会带来独特的挑战，其中一个主要挑战是标准数值方法可能产生非物理性的结果，例如物种 $A$ 的分子数为负。这个高级练习介绍了一种实用的解决方案——反射边界欧拉-丸山（Reflecting Boundary Euler-Maruyama）格式——来解决这个问题。通过分析这个改进算法在第一个时间步长 $\\Delta t$ 内的行为，您将深入理解随机理论与稳健数值实现之间重要的相互作用。[@problem_id:1517687]", "problem": "在计算系统生物学领域，化学朗之万方程 (Chemical Langevin Equation, CLE) 是一种广泛使用的随机微分方程，用于近似充分混合化学反应网络的动力学。CLE 的一种常用数值积分方法是欧拉-丸山 (Euler-Maruyama, EM) 格式。然而，标准 EM 格式的一个已知缺陷是它可能产生非物理的负分子布居数，特别是当某个物种的计数较低时。\n\n考虑一个简单的基因表达模型，其中蛋白质（表示为 $A$）以恒定速率产生，并通过一级过程降解。反应如下：\n1.  生成：$\\emptyset \\xrightarrow{k_1} A$\n2.  降解：$A \\xrightarrow{k_2} \\emptyset$\n\n此处，$k_1$ 是生成速率，单位为分子数/单位时间；$k_2$ 是单位分子降解速率常数，单位为时间倒数。令 $X(t)$ 表示物种 $A$ 在时间 $t$ 时的分子数。\n\n$X(t)$ 在 CLE 下的演化可以通过以下欧拉-丸山更新规则在一个小时间步长 $\\Delta t$ 上进行近似：\n$$ X_{\\text{tentative}}(t+\\Delta t) = X(t) + F(X(t)) \\Delta t + \\sqrt{G(X(t)) \\Delta t} \\cdot N(0,1) $$\n其中 $N(0,1)$ 是从标准正态分布中抽取的随机数。漂移项 $F(X)$ 和扩散项 $G(X)$ 由反应倾向 $a_j(X)$ 和化学计量数 $\\nu_j$ 确定：\n$$ F(X) = \\sum_{j} \\nu_j a_j(X) \\quad \\text{and} \\quad G(X) = \\sum_{j} \\nu_j^2 a_j(X) $$\n\n为了防止出现非物理的负布居数，我们引入一种称为反射边界欧拉-丸山 (Reflecting Boundary Euler-Maruyama, RB-EM) 的修正数值格式。在该格式中，首先使用标准 EM 更新规则计算一个尝试状态 $X_{\\text{tentative}}(t+\\Delta t)$。然后通过取尝试状态的绝对值来确定最终状态：\n$$ X(t+\\Delta t) = |X_{\\text{tentative}}(t+\\Delta t)| $$\n\n假设系统开始时没有物种 A 的分子，即 $X(0) = 0$。使用 RB-EM 格式计算单个时间步长后 A 的分子数的期望值 $E[X(\\Delta t)]$。\n\n请提供一个关于参数 $k_1$, $k_2$ 和时间步长 $\\Delta t$ 的闭式解析表达式。您的表达式可以包含标准数学函数，包括指数函数 $\\exp(z)$ 和误差函数，其定义为 $\\text{erf}(z) = \\frac{2}{\\sqrt{\\pi}} \\int_0^z \\exp(-u^2) du$。", "solution": "这两个反应的化学计量数和倾向为：\n- 生成：$\\nu_{1}=+1$, $a_{1}(X)=k_{1}$。\n- 降解：$\\nu_{2}=-1$, $a_{2}(X)=k_{2} X$。\n\n根据 CLE 漂移和扩散的定义，\n$$\nF(X)=\\sum_{j}\\nu_{j} a_{j}(X)=k_{1}-k_{2} X,\\qquad\nG(X)=\\sum_{j}\\nu_{j}^{2} a_{j}(X)=k_{1}+k_{2} X.\n$$\n从 $X(0)=0$ 开始使用欧拉-丸山更新，我们得到\n$$\nX_{\\text{tentative}}(\\Delta t)=X(0)+F(X(0))\\,\\Delta t+\\sqrt{G(X(0))\\,\\Delta t}\\,N(0,1)=k_{1}\\Delta t+\\sqrt{k_{1}\\Delta t}\\,N(0,1).\n$$\n因此 $X_{\\text{tentative}}(\\Delta t)$ 服从正态分布，其均值为 $\\mu=k_{1}\\Delta t$，方差为 $\\sigma^{2}=k_{1}\\Delta t$。RB-EM 格式设定\n$$\nX(\\Delta t)=\\left|X_{\\text{tentative}}(\\Delta t)\\right|=|Y|,\\quad Y\\sim \\mathcal{N}(\\mu,\\sigma^{2}).\n$$\n对于一个正态随机变量 $Y\\sim \\mathcal{N}(\\mu,\\sigma^{2})$，折叠变量的期望值为\n$$\n\\mathbb{E}[|Y|]=\\sigma \\sqrt{\\frac{2}{\\pi}}\\,\\exp\\!\\left(-\\frac{\\mu^{2}}{2\\sigma^{2}}\\right)+\\mu\\left(2\\Phi\\!\\left(\\frac{\\mu}{\\sigma}\\right)-1\\right)\n=\\sigma \\sqrt{\\frac{2}{\\pi}}\\,\\exp\\!\\left(-\\frac{\\mu^{2}}{2\\sigma^{2}}\\right)+\\mu\\,\\text{erf}\\!\\left(\\frac{\\mu}{\\sqrt{2}\\,\\sigma}\\right),\n$$\n其中 $\\Phi$ 是标准正态累积分布函数，$\\text{erf}$ 是误差函数，其定义为 $\\text{erf}(z)=\\frac{2}{\\sqrt{\\pi}}\\int_{0}^{z}\\exp(-u^{2})\\,du$。代入 $\\mu=k_{1}\\Delta t$ 和 $\\sigma=\\sqrt{k_{1}\\Delta t}$ 可得\n$$\n\\mathbb{E}[X(\\Delta t)]=\\sqrt{k_{1}\\Delta t}\\,\\sqrt{\\frac{2}{\\pi}}\\,\\exp\\!\\left(-\\frac{k_{1}\\Delta t}{2}\\right)+k_{1}\\Delta t\\;\\text{erf}\\!\\left(\\sqrt{\\frac{k_{1}\\Delta t}{2}}\\right).\n$$\n注意 $k_{2}$ 并未出现在这第一步的期望中，因为 $X(0)=0$ 意味着降解倾向 $a_{2}(X(0))=k_{2} X(0)=0$，所以它在这一步对漂移和扩散都没有贡献。", "answer": "$$\\boxed{\\sqrt{\\frac{2 k_{1} \\Delta t}{\\pi}}\\,\\exp\\!\\left(-\\frac{k_{1} \\Delta t}{2}\\right)+k_{1} \\Delta t\\,\\text{erf}\\!\\left(\\sqrt{\\frac{k_{1} \\Delta t}{2}}\\right)}$$", "id": "1517687"}]}