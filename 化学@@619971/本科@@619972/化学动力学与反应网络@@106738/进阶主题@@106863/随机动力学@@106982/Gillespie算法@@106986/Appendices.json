{"hands_on_practices": [{"introduction": "Gillespie算法的核心在于回答两个问题：“下一个反应何时发生？”以及“发生的是哪个反应？”。本练习将带你掌握第一个问题的关键：计算总反应倾向性（propensity）和期望等待时间。通过一个简单的蛋白质降解模型，你将学会如何量化系统发生下一个化学变化的“可能性”与“平均耗时”，这是构建任何随机模拟的基础。[@problem_id:1518727]", "problem": "在单个生物细胞内的基因表达研究中，随机效应变得十分重要。考虑一个简化模型，其中一种特定类型的蛋白质（我们将其标记为 $P$）会发生自发降解。该过程可建模为一级化学反应：\n$$\nP \\xrightarrow{k} \\emptyset\n$$\n其中 $\\emptyset$ 代表降解状态。在时间 $t=0$ 时，细胞内恰好含有 $N_P(0) = 25$ 个蛋白质 $P$ 分子。单个 $P$ 分子降解的随机速率常数给定为 $k = 0.05 \\text{ s}^{-1}$。\n\n随机模拟（例如 Gillespie 算法）依赖于反应倾向的概念，即特定反应在单位时间内发生的概率。对于具有多个反应通道的系统，总倾向是所有单个通道倾向的总和。\n\n计算该系统在初始时间 $t=0$ 时的两个基本量：\n1. 初始总倾向 $a_0$。\n2. 直到第一个降解事件发生为止的期望时间 $\\langle \\tau \\rangle$。\n\n将最终答案表示为一对数值 $(a_0, \\langle \\tau \\rangle)$。$a_0$ 的值以 $\\text{s}^{-1}$ 为单位，$\\langle \\tau \\rangle$ 的值以 $\\text{s}$ 为单位。将两个数值都四舍五入到三位有效数字。", "solution": "对于单分子降解反应 $P \\xrightarrow{k} \\emptyset$，根据随机质量作用公式，反应通道的倾向为 $a_{1}(t) = k N_{P}(t)$，其中 $N_{P}(t)$ 是时间 $t$ 时 $P$ 分子的数量，$k$ 是随机速率常数，单位为 $\\text{s}^{-1}$。由于只有一个反应通道，总倾向等于所有通道倾向之和，因此 $a_{0}(t) = a_{1}(t)$。\n\n在 $t=0$ 时，我们有 $N_{P}(0) = 25$，因此符号上表示为 $a_{0}(0) = k N_{P}(0)$。代入给定的数值可得\n$$\na_{0} = k N_{P}(0) = 0.05 \\times 25 = 1.25 \\ \\text{s}^{-1}.\n$$\n\n在 Gillespie 框架中，到下一次反应的等待时间 $\\tau$ 服从参数为 $a_{0}$ 的指数分布，即其概率密度函数为 $f(\\tau) = a_{0} \\exp(-a_{0} \\tau)$（对于 $\\tau \\geq 0$）。期望等待时间为\n$$\n\\langle \\tau \\rangle = \\int_{0}^{\\infty} \\tau a_{0} \\exp(-a_{0} \\tau) \\, d\\tau = \\frac{1}{a_{0}}.\n$$\n使用计算出的 $a_{0}$，\n$$\n\\langle \\tau \\rangle = \\frac{1}{1.25} = 0.800 \\ \\text{s},\n$$\n四舍五入到三位有效数字。\n\n因此，在指定单位下，所求的数值对为 $(a_{0}, \\langle \\tau \\rangle) = (1.25, 0.800)$。", "answer": "$$\\boxed{\\begin{pmatrix} 1.25 & 0.800 \\end{pmatrix}}$$", "id": "1518727"}, {"introduction": "理解了反应倾向性与时间的理论关系后，是时候亲手实践一次完整的Gillespie算法循环了。本练习将理论付诸实践，你将使用给定的随机数来计算出下一个反应发生的真实时间点 $\\tau$，并确定反应带来的系统状态变化。这个过程会让你清晰地看到算法是如何将概率法则转化为一个具体的、可模拟的事件的。[@problem_id:1518694]", "problem": "在一个简化的单细胞内基因表达模型中，我们考虑一种特定蛋白质 A 的降解。该降解过程被建模为一个单分子反应 $A \\rightarrow \\emptyset$，其中一个蛋白质 A 分子从系统中被消除。该反应的随机速率常数为 $k = 0.500 \\text{ s}^{-1}$。\n\n在时间 $t=0$ 时，细胞内恰好含有 $N_A(0) = 2$ 个蛋白质 A 分子。为模拟该系统的时间演化，我们将执行一步 Gillespie 算法（也称为随机模拟算法）。对于这第一步，我们从区间 $(0, 1)$ 上的均匀分布中抽取了两个随机数 $r_1$ 和 $r_2$。它们的值分别为 $r_1 = 0.350$ 和 $r_2 = 0.810$。\n\n请确定第一次降解事件发生的时间 $\\tau$ 以及在此次单一事件后系统中剩余的蛋白质 A 分子数 $N_A(\\tau)$。你的最终答案应为一对数，分别对应时间 $\\tau$ 和最终分子数 $N_A(\\tau)$。时间 $\\tau$ 以秒为单位，并四舍五入至三位有效数字。", "solution": "我们将随机速率常数为 $k$ 的单一反应 $A \\rightarrow \\emptyset$ 建模为一个单分子反应，其在状态 $N_{A}(t)$ 下的反应倾向根据 Gillespie 对单分子反应的标准定义给出：\n$$\na_{1}(t) = k\\,N_{A}(t).\n$$\n由于只有一个反应通道，总反应倾向为\n$$\na_{0}(t) = a_{1}(t) = k\\,N_{A}(t).\n$$\n在 $t=0$ 时，我们有 $N_{A}(0) = 2$，所以\n$$\na_{0}(0) = k \\times 2.\n$$\n下一个反应的 Gillespie 等待时间抽取如下：\n$$\n\\tau = \\frac{1}{a_{0}(0)}\\,\\ln\\!\\left(\\frac{1}{r_{1}}\\right) = \\frac{1}{2k}\\,\\ln\\!\\left(\\frac{1}{r_{1}}\\right).\n$$\n代入 $k = 0.500 \\text{ s}^{-1}$ 和 $r_{1} = 0.350$ 得\n$$\na_{0}(0) = 2k = 1.000 \\text{ s}^{-1}, \\quad \\tau = \\frac{1}{1.000}\\,\\ln\\!\\left(\\frac{1}{0.350}\\right) = \\ln\\!\\left(\\frac{20}{7}\\right) \\text{ s}.\n$$\n数值上，$\\ln(20) - \\ln(7) \\approx 1.04982212449$，所以取三位有效数字，\n$$\n\\tau \\approx 1.05 \\text{ s}.\n$$\n为了选择反应通道，我们使用第二个随机数 $r_{2}$ 和带有累积反应倾向的标准选择规则。这里只有一个通道，所以它总是被选中，因为对于任何 $r_{2} \\in (0,1)$，累积和 $a_{1}(0) = a_{0}(0)$ 都超过 $r_{2}a_{0}(0)$。因此，反应 $A \\rightarrow \\emptyset$ 发生，使分子数减少一：\n$$\nN_{A}(\\tau) = N_{A}(0) - 1 = 1.\n$$\n因此，经过这单步 Gillespie 模拟后，时间为 $\\tau = 1.05$（单位为秒，保留三位有效数字），更新后的分子数为 $N_{A}(\\tau) = 1$。", "answer": "$$\\boxed{\\begin{pmatrix} 1.05 & 1 \\end{pmatrix}}$$", "id": "1518694"}, {"introduction": "在前面的练习中，我们使用了现成的倾向性函数。然而，在研究新的化学网络时，一个关键的技能是能够为任意反应正确地构建其倾向性函数，特别是当反应涉及多个相同类型的分子时。本练习将引导你从基本原理出发，通过考虑反应物分子的不同组合方式，来推导一个更复杂反应的倾向性函数，从而揭示倾向性公式背后的组合学基础。[@problem_id:1518692]", "problem": "考虑一个体积为 $V$ 的固定、充分混合的化学系统，其中包含 A 和 B 两种分子。系统中可能发生化学反应，其中两个 A 分子与一个 B 分子结合，生成一个产物 C 分子。该反应的化学计量式为 $2A + B \\rightarrow C$。\n\n系统当前包含 $n_A$ 个 A 分子和 $n_B$ 个 B 分子。\n\n设 $c$ 为基本随机速率常数。该常数表示一个特定的、预先选定的反应物三联体（即一对特定的 A 分子和一个特定的 B 分子）在单位时间内发生反应的概率。\n\n你的任务是确定此反应的总倾向函数 $a(n_A, n_B)$。倾向函数的定义为：在下一个无穷小时间间隔 $[t, t+dt)$ 内，反应 $2A + B \\rightarrow C$ 在体积 $V$ 内某处发生的概率为 $a(n_A, n_B) \\, dt$。\n\n请用 $n_A$、$n_B$ 和常数 $c$ 将你的答案表示为一个闭式解析表达式。", "solution": "倾向函数的定义使得 $a(n_{A},n_{B})\\,dt$ 等于在 $[t,t+dt)$ 内发生一个反应事件的概率。根据基本随机速率常数 $c$ 的定义，在时间间隔 $[t,t+dt)$ 内，一个特定的、预先选定的反应物三联体（一对特定的 A 分子和一个特定的 B 分子）发生反应的概率为 $c\\,dt$。\n\n在一个含有 $n_{A}$ 个 A 分子和 $n_{B}$ 个 B 分子的充分混合系统中，不同反应物三联体的总数等于选择一对无序 A 分子的方式数乘以选择一个 B 分子的方式数。A 的无序对数量为 $\\binom{n_{A}}{2}$，而 B 的选择数量为 $n_{B}$。因此，不同三联体的总数是\n$$\n\\binom{n_{A}}{2}\\,n_{B}.\n$$\n对于无穷小量 $dt$，两个或更多此类三联体发生反应的概率是 $dt^{2}$ 阶的，可以忽略。因此，在 $[t,t+dt)$ 内任意一个这些三联体发生反应的总概率是它们各自概率的总和：\n$$\na(n_{A},n_{B})\\,dt \\;=\\; \\left[c \\times \\binom{n_{A}}{2}\\,n_{B}\\right] dt.\n$$\n因此，倾向函数是\n$$\na(n_{A},n_{B}) \\;=\\; c\\,\\binom{n_{A}}{2}\\,n_{B} \\;=\\; c\\,\\frac{n_{A}(n_{A}-1)}{2}\\,n_{B}.\n$$\n如果 $n_{A}<2$ 或 $n_{B}<1$，该表达式通过二项式系数会正确地得到零。", "answer": "$$\\boxed{c\\,\\binom{n_{A}}{2}\\,n_{B}}$$", "id": "1518692"}]}