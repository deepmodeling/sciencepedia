{"hands_on_practices": [{"introduction": "蒙特卡洛方法的核心思想之一是利用随机数来模拟物理过程随时间的演变。本练习将通过一个简化模型，带你亲手模拟材料科学中一个最基本的过程：原子扩散。通过追踪一个间隙原子在晶格中的随机游走，直至其被一个固定的空位捕获，你将直观地理解随机的微观跳跃如何驱动宏观的物质输运，并掌握动力学蒙特卡洛模拟的基本步骤 [@problem_id:1318228]。", "problem": "在材料科学中，原子的扩散可以使用蒙特卡洛方法进行建模。考虑一个简化的模型：一个间隙原子在二维晶格中扩散，直到被一个空位湮灭。\n\n该系统是一个大小为 $5 \\times 5$ 的二维方格晶格，其中格点坐标 $(x, y)$ 为整数，满足 $x, y \\in \\{0, 1, 2, 3, 4\\}$。一个固定的空位位于格点 $V = (3, 1)$。一个可移动的间隙原子初始位于格点 $I_0 = (1, 3)$。\n\n原子的运动以离散的时间步进行模拟。在每一步中，从区间 $[0, 1)$ 上的均匀分布中抽取一个伪随机数 $r$。这个数字根据以下规则决定原子尝试跳跃到相邻格点的方向：\n- 如果 $0 \\le r  0.25$，原子尝试向右移动（至 $(x+1, y)$）。\n- 如果 $0.25 \\le r  0.50$，原子尝试向上移动（至 $(x, y+1)$）。\n- 如果 $0.50 \\le r  0.75$，原子尝试向左移动（至 $(x-1, y)$）。\n- 如果 $0.75 \\le r  1.00$，原子尝试向下移动（至 $(x, y-1)$）。\n\n晶格具有刚性边界。如果尝试的移动会将原子置于 $5 \\times 5$ 网格之外的坐标处（即 $x$ 或 $y$ 坐标小于0或大于4），则该步中原子不移动，停留在其当前位置。\n\n当间隙原子的坐标与空位的坐标相同时，模拟结束，此时认为两者发生了湮灭。\n\n给定前12个步骤的伪随机数序列如下：\n$0.31, 0.82, 0.15, 0.55, 0.09, 0.41, 0.99, 0.68, 0.20, 0.77, 0.11, 0.80$\n\n确定间隙原子在空位处湮灭所需的总步数。以一个表示总步数的整数形式提供您的答案。", "solution": "我们有一个 $5 \\times 5$ 的晶格，其格点坐标 $(x,y)$ 满足 $x,y \\in \\{0,1,2,3,4\\}$。空位固定在 $V=(3,1)$，间隙原子从 $I_{0}=(1,3)$ 开始。在每个离散步中，一个伪随机数 $r \\in [0,1)$ 根据以下规则决定尝试的移动：$r \\in [0,0.25)$ 为向右 $(x,y)\\to(x+1,y)$，$r \\in [0.25,0.50)$ 为向上 $(x,y)\\to(x,y+1)$，$r \\in [0.50,0.75)$ 为向左 $(x,y)\\to(x-1,y)$，$r \\in [0.75,1.00)$ 为向下 $(x,y)\\to(x,y-1)$。边界是刚性的：如果提议的移动会产生一个在 $\\{0,1,2,3,4\\}$ 之外的坐标，原子将停留在当前位置。当间隙原子到达 $V$ 时，模拟结束。\n\n使用给定的 $r$ 值序列，并在每一步应用移动规则和边界检查：\n\n第 1 步：$r=0.31 \\in [0.25,0.50)$，向上，尝试 $(1,3)\\to(1,4)$ 在网格内，因此 $I_{1}=(1,4)$。\n\n第 2 步：$r=0.82 \\in [0.75,1.00)$，向下，$(1,4)\\to(1,3)$ 有效，因此 $I_{2}=(1,3)$。\n\n第 3 步：$r=0.15 \\in [0,0.25)$，向右，$(1,3)\\to(2,3)$ 有效，因此 $I_{3}=(2,3)$。\n\n第 4 步：$r=0.55 \\in [0.50,0.75)$，向左，$(2,3)\\to(1,3)$ 有效，因此 $I_{4}=(1,3)$。\n\n第 5 步：$r=0.09 \\in [0,0.25)$，向右，$(1,3)\\to(2,3)$ 有效，因此 $I_{5}=(2,3)$。\n\n第 6 步：$r=0.41 \\in [0.25,0.50)$，向上，$(2,3)\\to(2,4)$ 有效，因此 $I_{6}=(2,4)$。\n\n第 7 步：$r=0.99 \\in [0.75,1.00)$，向下，$(2,4)\\to(2,3)$ 有效，因此 $I_{7}=(2,3)$。\n\n第 8 步：$r=0.68 \\in [0.50,0.75)$，向左，$(2,3)\\to(1,3)$ 有效，因此 $I_{8}=(1,3)$。\n\n第 9 步：$r=0.20 \\in [0,0.25)$，向右，$(1,3)\\to(2,3)$ 有效，因此 $I_{9}=(2,3)$。\n\n第 10 步：$r=0.77 \\in [0.75,1.00)$，向下，$(2,3)\\to(2,2)$ 有效，因此 $I_{10}=(2,2)$。\n\n第 11 步：$r=0.11 \\in [0,0.25)$，向右，$(2,2)\\to(3,2)$ 有效，因此 $I_{11}=(3,2)$。\n\n第 12 步：$r=0.80 \\in [0.75,1.00)$，向下，$(3,2)\\to(3,1)$ 有效，因此 $I_{12}=(3,1)=V$；湮灭发生在第12步结束时。\n\n因此，所需的总步数为 $12$。", "answer": "$$\\boxed{12}$$", "id": "1318228"}, {"introduction": "在模拟了单个原子的运动后，我们将来处理一个更复杂的系统：高分子链。高分子链可以折叠成无数种构象（形状），蒙特卡洛模拟是探索其构象空间的强大工具。本练习旨在模拟一个高分子链在受限与非受限环境中的行为，并通过计算其关键的结构参数——回转半径 $R_g^2$，来量化环境约束对高分子尺寸的影响。这个实践将帮助你理解如何使用特定的蒙特卡洛“移动集”（如末端旋转）来有效地对分子构象进行抽样 [@problem_id:1318246]。", "problem": "一个简化的聚合物链模型在晶格间距为1个单位的二维方格晶格上进行模拟。该聚合物表示为一条由$N=5$个相连单体组成的自回避链。该聚合物的构象可以用其回旋半径的平方$R_g^2$来表征，其定义为：\n$$R_g^2 = \\frac{1}{N} \\sum_{i=1}^{N} ||\\vec{r}_i - \\vec{R}_{cm}||^2$$\n其中$\\vec{r}_i$是第$i$个单体的位置矢量，$\\vec{R}_{cm} = \\frac{1}{N} \\sum_{i=1}^{N} \\vec{r}_i$是链的质心。\n\n初始时，五个标记为$M_1$到$M_5$的单体排列成一条直线，其坐标为：$M_1=(0,0)$，$M_2=(1,0)$，$M_3=(2,0)$，$M_4=(3,0)$和$M_5=(4,0)$。\n\n链的构型使用蒙特卡洛（MC）算法进行更新，该算法涉及一系列“末端枢轴”移动。一次“末端枢轴”移动包括选择链两端的两个单体之一，并尝试将其移动到一个新的晶格位置。只有当目标位置与该单体的唯一邻居相邻（非对角），且未被链中任何其他单体占据时，该移动才算成功。\n\n我们将通过尝试相同的三个移动序列，来比较聚合物在两种不同环境中的行为：\n1. 尝试将末端单体$M_1$移动到新位置$(1,1)$。\n2. 尝试将末端单体$M_5$移动到新位置$(3,1)$。\n3. 尝试将末端单体$M_1$移动到新位置$(0,0)$。\n\n**情景A（无限制）：** 聚合物处于一个开放的、无限的二维空间中。\n**情景B（受限）：** 聚合物处于一个由位于$y=0.5$和$y=-0.5$的两堵不可穿透的水平壁所界定的纳米通道中。这种限制规定了，在任何时候所有单体的y坐标都必须恰好为0。任何试图将单体移动到$y \\neq 0$位置的移动都将被拒绝。\n\n设$R_{g, \\text{unconfined}}^2$为情景A中的最终回旋半径平方，$R_{g, \\text{confined}}^2$为情景B中的最终回旋半径平方。计算比值$\\frac{R_{g, \\text{unconfined}}^2}{R_{g, \\text{confined}}^2}$。将您的最终答案保留两位有效数字。", "solution": "我们使用回旋半径平方的定义，\n$$R_{g}^{2}=\\frac{1}{N}\\sum_{i=1}^{N}\\|\\vec{r}_{i}-\\vec{R}_{cm}\\|^{2},\\quad \\vec{R}_{cm}=\\frac{1}{N}\\sum_{i=1}^{N}\\vec{r}_{i},$$\n其中$N=5$。\n\n初始链坐标为$M_{1}=(0,0)$，$M_{2}=(1,0)$，$M_{3}=(2,0)$，$M_{4}=(3,0)$，$M_{5}=(4,0)$。\n\n末端枢轴移动规则：一个末端单体可以移动到一个目标位置，当且仅当(i)该目标位置与其唯一邻居相邻（曼哈顿距离为1），且(ii)该目标位置未被任何其他单体占据。在受限情景中，一个附加约束要求所有单体的$y=0$；任何目标位置$y\\neq 0$的移动都将被拒绝。\n\n**情景A（无限制）：**\n1) 将$M_{1}$移动到$(1,1)$：目标位置与$M_{2}=(1,0)$相邻且未被占据，因此接受。$M_{1}$到$M_{5}$的新坐标为：$(1,1),(1,0),(2,0),(3,0),(4,0)$。\n2) 将$M_{5}$移动到$(3,1)$：目标位置与$M_{4}=(3,0)$相邻且未被占据，因此接受。新坐标为：$M_{1}=(1,1)$，$M_{2}=(1,0)$，$M_{3}=(2,0)$，$M_{4}=(3,0)$，$M_{5}=(3,1)$。\n3) 将末端单体$M_1$移动到$(0,0)$：目标位置与$M_{2}=(1,0)$相邻且未被占据，因此接受。最终坐标：\n$$M_{1}=(0,0),\\; M_{2}=(1,0),\\; M_{3}=(2,0),\\; M_{4}=(3,0),\\; M_{5}=(3,1)。$$\n计算$\\vec{R}_{cm}$：\n$$\\vec{R}_{cm}=\\frac{1}{5}\\big((0+1+2+3+3),(0+0+0+0+1)\\big)=\\left(\\frac{9}{5},\\frac{1}{5}\\right)。$$\n计算距离平方和：\n- 对于 $(0,0)$: $\\|\\vec{r}_1 - \\vec{R}_{cm}\\|^2 = \\left(-\\frac{9}{5}\\right)^{2}+\\left(-\\frac{1}{5}\\right)^{2}=\\frac{82}{25}$。\n- 对于 $(1,0)$: $\\|\\vec{r}_2 - \\vec{R}_{cm}\\|^2 = \\left(-\\frac{4}{5}\\right)^{2}+\\left(-\\frac{1}{5}\\right)^{2}=\\frac{17}{25}$。\n- 对于 $(2,0)$: $\\|\\vec{r}_3 - \\vec{R}_{cm}\\|^2 = \\left(\\frac{1}{5}\\right)^{2}+\\left(-\\frac{1}{5}\\right)^{2}=\\frac{2}{25}$。\n- 对于 $(3,0)$: $\\|\\vec{r}_4 - \\vec{R}_{cm}\\|^2 = \\left(\\frac{6}{5}\\right)^{2}+\\left(-\\frac{1}{5}\\right)^{2}=\\frac{37}{25}$。\n- 对于 $(3,1)$: $\\|\\vec{r}_5 - \\vec{R}_{cm}\\|^2 = \\left(\\frac{6}{5}\\right)^{2}+\\left(\\frac{4}{5}\\right)^{2}=\\frac{52}{25}$。\n和$=\\frac{82+17+2+37+52}{25}=\\frac{190}{25}=\\frac{38}{5}$。因此\n$$R_{g,\\text{unconfined}}^{2}=\\frac{1}{5}\\cdot\\frac{190}{25}=\\frac{38}{25}。$$\n\n**情景B（受限：要求$y=0$）：**\n1) 将$M_{1}$移动到$(1,1)$：被拒绝，因为目标位置的$y\\neq 0$。链构象不变。\n2) 将$M_{5}$移动到$(3,1)$：被拒绝，因为目标位置的$y\\neq 0$。链构象不变。\n3) 将末端单体$M_1$移动到$(0,0)$：$M_1$已在$(0,0)$，这是一个无效移动（或零移动），不会导致任何变化。最终坐标保持不变：\n$$M_{1}=(0,0),\\; M_{2}=(1,0),\\; M_{3}=(2,0),\\; M_{4}=(3,0),\\; M_{5}=(4,0)。$$\n计算$\\vec{R}_{cm}=(2,0)$以及距离平方和：\n$||\\vec{r}_i - \\vec{R}_{cm}||^2$ 的和为 $(0-2)^2 + (1-2)^2 + (2-2)^2 + (3-2)^2 + (4-2)^2 = 4+1+0+1+4=10$。因此\n$$R_{g,\\text{confined}}^{2}=\\frac{1}{5}\\cdot 10=2。$$\n\n因此，所求比值为\n$$\\frac{R_{g,\\text{unconfined}}^{2}}{R_{g,\\text{confined}}^{2}}=\\frac{38/25}{2}=\\frac{19}{25}=0.76。$$\n保留两位有效数字，结果为$0.76$。", "answer": "$$\\boxed{0.76}$$", "id": "1318246"}, {"introduction": "本练习将带你进入蒙特卡洛方法在材料科学中最高级、最强大的应用之一：使用Metropolis算法进行材料设计。与简单的随机游走不同，Metropolis算法根据移动对系统总能量的影响，并结合系统温度，以一定的概率接受或拒绝一个移动。通过这种方式，系统可以向低能量的稳定状态演化。这个问题将展示如何利用“模拟退火”（一种基于Metropolis的优化策略）来设计一种具有特定性能（接近零的热膨胀系数）的复合超材料，让你深刻体会蒙特卡洛方法在计算材料设计中的核心作用 [@problem_id:1318218]。", "problem": "为了设计一种具有近零热膨胀系数的复合超材料，一位计算材料科学家采用了模拟退火策略。该材料被建模为一个具有周期性边界条件的二维 $4 \\times 4$ 方形晶格。晶格上的每个格点被A、B两相中的一相占据：A相具有正热膨胀系数，B相具有负热膨胀系数。系统中恰好有8个A相格点和8个B相格点。\n\n使用一个简化模型来近似计算给定相微观排布下的总内应变能 $H$。该能量函数旨在惩罚作为热失配应变来源的局域相不平衡。总能量是晶格上所有16个独立的 $2 \\times 2$ 小方格（即由四个相邻格点组成的块）贡献的总和。单个小方格 $p$ 的能量 $H_p$ 由下式给出：\n$$H_p = C \\left( n_A(p) - n_B(p) \\right)^2$$\n其中 $n_A(p)$ 和 $n_B(p)$ 分别是该小方格内A格点和B格点的数量。总能量为 $H = \\sum_{p} H_p$。常数 $C$ 已知为 $1.0~\\text{J}$。\n\n系统当前处于由以下构型定义的状态（行和列使用从0开始的索引，其中 $(0,0)$ 是左上角的格点）：\n$$\n\\begin{pmatrix}\n\\text{A}  \\text{A}  \\text{B}  \\text{B} \\\\\n\\text{A}  \\text{B}  \\text{B}  \\text{B} \\\\\n\\text{B}  \\text{A}  \\text{A}  \\text{A} \\\\\n\\text{B}  \\text{B}  \\text{A}  \\text{A}\n\\end{pmatrix}\n$$\n在温度 $T$ 下尝试进行一次 Metropolis 蒙特卡洛移动，此时热能为 $k_B T = 8.0~\\text{J}$，其中 $k_B$ 是 Boltzmann 常数。提议的移动是交换格点 $(1, 1)$ 和格点 $(2, 1)$ 上的相。为了确定是否接受此移动，从 $[0, 1)$ 上的均匀分布中抽取一个随机数 $r = 0.10$。\n\n计算在尝试了这一次蒙特卡洛步骤*之后*，材料构型的总能量。您的答案以焦耳为单位，并四舍五入到三位有效数字。", "solution": "晶格是一个具有周期性边界的 $4 \\times 4$ 系统。总能量是所有 $16$ 个小方格 $p$ 的能量之和 $H=\\sum_{p} H_{p}$，其中对于每个小方格\n$$\nH_{p}=C\\left(n_{A}(p)-n_{B}(p)\\right)^{2}.\n$$\n由于每个小方格有 $n_{A}(p)+n_{B}(p)=4$，我们得到 $n_{B}(p)=4-n_{A}(p)$ 且\n$$\nn_{A}(p)-n_{B}(p)=2n_{A}(p)-4=2\\left(n_{A}(p)-2\\right),\n$$\n所以当 $C=1$ 时，\n$$\nH_{p}=4\\left(n_{A}(p)-2\\right)^{2}.\n$$\n一次 Metropolis 移动交换了格点 $(1,1)$ 和 $(2,1)$ 的相，在交换前它们分别为 $B$ 和 $A$。只有包含这两个格点之一的小方格的能量会改变。一个格点 $(r,c)$ 属于左上角坐标为 $(r,c)$, $(r,c-1)$, $(r-1,c)$, $(r-1,c-1)$ 的小方格（索引模 $4$）。因此，受影响的小方格的左上角坐标为 $(0,0),\\ (0,1),\\ (1,0),\\ (1,1),\\ (2,0),\\ (2,1)$。\n\n我们计算这些小方格在交换前后的 $n_{A}$ 和 $H_{p}$：\n- 对于 $(0,0)$：交换前 $n_{A}=3 \\Rightarrow H_{p}=4$，交换后 $n_{A}=4 \\Rightarrow H_{p}=16$，变化量 $\\Delta H_p = +12$。\n- 对于 $(0,1)$：交换前 $n_{A}=1 \\Rightarrow H_{p}=4$，交换后 $n_{A}=2 \\Rightarrow H_{p}=0$，变化量 $\\Delta H_p = -4$。\n- 对于 $(1,0)$：交换前 $n_{A}=2 \\Rightarrow H_{p}=0$，交换后 $n_{A}=2 \\Rightarrow H_{p}=0$，变化量 $\\Delta H_p = 0$。\n- 对于 $(1,1)$：交换前 $n_{A}=2 \\Rightarrow H_{p}=0$，交换后 $n_{A}=2 \\Rightarrow H_{p}=0$，变化量 $\\Delta H_p = 0$。\n- 对于 $(2,0)$：交换前 $n_{A}=1 \\Rightarrow H_{p}=4$，交换后 $n_{A}=0 \\Rightarrow H_{p}=16$，变化量 $\\Delta H_p = +12$。\n- 对于 $(2,1)$：交换前 $n_{A}=3 \\Rightarrow H_{p}=4$，交换后 $n_{A}=2 \\Rightarrow H_{p}=0$，变化量 $\\Delta H_p = -4$。\n\n因此总能量变化为\n$$\n\\Delta H = 12 - 4 + 0 + 0 + 12 - 4 = 16~\\text{J}.\n$$\n在热能 $k_{B}T=8~\\text{J}$ 时的 Metropolis 接受概率为\n$$\nP=\\min\\left(1,\\exp\\left(-\\frac{\\Delta H}{k_{B}T}\\right)\\right)=\\exp\\left(-\\frac{16}{8}\\right)=\\exp(-2) \\approx 0.135.\n$$\n由于随机数 $r=0.10$ 满足 $r  P$，该移动被接受。\n\n为了得到最终的总能量，我们通过对所有 16 个小方格求和来计算初始总能量 $H_{\\text{old}}$。根据初始构型，所有16个小方格的 $n_A$ 值计算得出非零的初始能量贡献项为\n$H_{(0,0)}=4$, $H_{(0,1)}=4$, $H_{(0,2)}=16$, $H_{(2,0)}=4$, $H_{(2,1)}=4$, $H_{(2,2)}=16$。\n所有其他 $H_{p}=0$，因此初始总能量为\n$$\nH_{\\text{old}} = 4+4+16+4+4+16 = 48~\\text{J}.\n$$\n由于交换被接受，新的总能量为\n$$\nH_{\\text{new}}=H_{\\text{old}}+\\Delta H=48 + 16=64~\\text{J}.\n$$\n四舍五入到三位有效数字，尝试该步骤后的总能量为 $64.0~\\text{J}$。", "answer": "$$\\boxed{64.0}$$", "id": "1318218"}]}