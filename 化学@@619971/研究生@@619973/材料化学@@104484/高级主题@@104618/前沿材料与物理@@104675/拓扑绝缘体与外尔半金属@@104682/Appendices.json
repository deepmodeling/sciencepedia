{"hands_on_practices": [{"introduction": "辨别拓扑绝缘体与平庸绝缘体是一项关键技能。对于具有反演对称性的材料，Fu和Kane提出的一个强大方法使我们能够仅通过检查布里渊区中特定高对称性动量点（TRIMs）的波函数宇称，来确定其拓扑性质。本练习将通过一组为教学目的而设计的假设能带宇称数据，让您直接实践应用这一简洁而实用的 $Z_2$ 拓扑不变量诊断工具。[@problem_id:2532806]", "problem": "一个位于简单立方晶格（晶格常数$a$）上的三维中心对称且时间反演不变的晶体绝缘体，有$N_{\\text{occ}}=4$对占据的克莱默斯对。时间反演不变动量点（TRIM）是以下八个点：\n$$\n\\mathbf{k}_{n_1 n_2 n_3}=\\left(\\frac{n_1 \\pi}{a},\\frac{n_2 \\pi}{a},\\frac{n_3 \\pi}{a}\\right), \\quad n_j \\in \\{0,1\\}.\n$$\n对于每个TRIM $\\mathbf{k}_{n_1 n_2 n_3}$和每对占据的克莱默斯对 $m \\in \\{1,2,3,4\\}$，其反演宇称本征值 $\\xi_m(\\mathbf{k}_{n_1 n_2 n_3})$ 在下方的假设能带表中给出。此处，$\\xi_m(\\mathbf{k}) \\in \\{+1,-1\\}$ 表示在 $\\mathbf{k}$ 点第 $m$ 对克莱默斯对的宇称本征值，由于反演对称性，在TRIM点，一对克莱默斯对中的两个态具有相同的宇称。数据如下：\n- 在 $\\mathbf{k}_{000}$ 处：$\\{\\xi_1,\\xi_2,\\xi_3,\\xi_4\\}=\\{+1,+1,+1,+1\\}$。\n- 在 $\\mathbf{k}_{100}$ 处：$\\{-1,+1,+1,+1\\}$。\n- 在 $\\mathbf{k}_{010}$ 处：$\\{-1,+1,+1,+1\\}$。\n- 在 $\\mathbf{k}_{001}$ 处：$\\{+1,+1,+1,+1\\}$。\n- 在 $\\mathbf{k}_{110}$ 处：$\\{+1,+1,+1,+1\\}$。\n- 在 $\\mathbf{k}_{101}$ 处：$\\{-1,+1,+1,+1\\}$。\n- 在 $\\mathbf{k}_{011}$ 处：$\\{+1,+1,+1,+1\\}$。\n- 在 $\\mathbf{k}_{111}$ 处：$\\{+1,+1,+1,+1\\}$。\n\n仅从绝缘体中时间反演对称性和反演对称性的基本原理，以及在TRIM点宇称本征值的定义出发，推导如何从给定表格中计算强和弱$Z_2$指标 $(\\nu_0;\\nu_1 \\nu_2 \\nu_3)$。然后，为上述定义的晶体明确计算这些指标。\n\n将最终答案以行矩阵 $[\\nu_0 \\ \\nu_1 \\ \\nu_2 \\ \\nu_3]$ 的形式给出。无需四舍五入。无需单位。", "solution": "问题陈述经审阅后被认定为有效。在拓扑能带理论已建立的物理和数学框架内，这是一个适定问题。所有必要数据均已提供，且不存在科学或逻辑上的矛盾。我们可以开始求解。\n\n该问题要求计算一个同时具有时间反演对称性（TRS）和反演对称性的三维绝缘体的强和弱$Z_2$拓扑不变量，记为 $(\\nu_0; \\nu_1, \\nu_2, \\nu_3)$。反演对称性的存在极大地简化了计算，使得$Z_2$不变量可以仅通过布里渊区中8个时间反演不变动量点（TRIM）上占据能带的宇称本征值来确定。该方法由 Fu 和 Kane 建立。\n\n基本原理如下。对于一个具有TRS的系统，态以克莱默斯对的形式出现。在TRIM点 $\\mathbf{k}$ 处，其中 $\\mathbf{k} = -\\mathbf{k} + \\mathbf{G}$（$\\mathbf{G}$ 是某个倒格矢），一对克莱默斯对中的两个态是简并的。如果系统还具有反演对称性，则哈密顿量 $H$ 与宇称算符 $\\mathcal{P}$ 对易。因此，$H$ 的本征态可以选择为 $\\mathcal{P}$ 的本征态，其本征值为 $\\xi = \\pm 1$。由于时间反演算符 $\\Theta$ 和 $\\mathcal{P}$ 对易，在TRIM点，一对克莱默斯对中的两个态共享相同的宇称本征值。\n\n问题给出了在每个TRIM点上，$N_{\\text{occ}}=4$对占据的克莱默斯对中每一对的宇称本征值 $\\xi_m(\\mathbf{k})$。TRIM点由 $\\mathbf{k}_{n_1 n_2 n_3} = (\\frac{n_1 \\pi}{a}, \\frac{n_2 \\pi}{a}, \\frac{n_3 \\pi}{a})$ 给出，其中 $n_j \\in \\{0, 1\\}$。\n\n从这些本征值出发，我们首先计算每个TRIM点的总宇称表征 $\\delta(\\mathbf{k})$，它是所有占据的克莱默斯对的宇称本征值的乘积：\n$$\n\\delta(\\mathbf{k}) = \\prod_{m=1}^{N_{\\text{occ}}} \\xi_m(\\mathbf{k})\n$$\n在本问题中，$N_{\\text{occ}}=4$。\n\n于是，四个$Z_2$不变量 $(\\nu_0, \\nu_1, \\nu_2, \\nu_3)$ 由以下公式确定：\n\n1. 强拓扑指标 $\\nu_0$ 由所有8个TRIM点上 $\\delta(\\mathbf{k})$ 的乘积给出：\n$$\n(-1)^{\\nu_0} = \\prod_{n_1,n_2,n_3 \\in \\{0,1\\}} \\delta(\\mathbf{k}_{n_1 n_2 n_3})\n$$\n$\\nu_0=1$ 的值表示强拓扑绝缘体，而 $\\nu_0=0$ 表示平庸绝缘体或弱拓扑绝缘体。\n\n2. 三个弱拓扑指标 $(\\nu_1, \\nu_2, \\nu_3)$ 由布里渊区边界 $k_j = \\pi/a$ 平面上的TRIM点处 $\\delta(\\mathbf{k})$ 的乘积确定：\n$$\n(-1)^{\\nu_1} = \\prod_{n_2,n_3 \\in \\{0,1\\}} \\delta(\\mathbf{k}_{1 n_2 n_3}) = \\delta(\\mathbf{k}_{100}) \\delta(\\mathbf{k}_{110}) \\delta(\\mathbf{k}_{101}) \\delta(\\mathbf{k}_{111})\n$$\n$$\n(-1)^{\\nu_2} = \\prod_{n_1,n_3 \\in \\{0,1\\}} \\delta(\\mathbf{k}_{n_1 1 n_3}) = \\delta(\\mathbf{k}_{010}) \\delta(\\mathbf{k}_{110}) \\delta(\\mathbf{k}_{011}) \\delta(\\mathbf{k}_{111})\n$$\n$$\n(-1)^{\\nu_3} = \\prod_{n_1,n_2 \\in \\{0,1\\}} \\delta(\\mathbf{k}_{n_1 n_2 1}) = \\delta(\\mathbf{k}_{001}) \\delta(\\mathbf{k}_{101}) \\delta(\\mathbf{k}_{011}) \\delta(\\mathbf{k}_{111})\n$$\n\n现在我们将此形式理论应用于给定的数据。\n\n首先，我们计算8个TRIM点中每一个的 $\\delta(\\mathbf{k})$：\n- $\\mathbf{k}_{000}$: $\\{\\xi_m\\} = \\{+1,+1,+1,+1\\} \\implies \\delta(\\mathbf{k}_{000}) = (+1)(+1)(+1)(+1) = +1$\n- $\\mathbf{k}_{100}$: $\\{\\xi_m\\} = \\{-1,+1,+1,+1\\} \\implies \\delta(\\mathbf{k}_{100}) = (-1)(+1)(+1)(+1) = -1$\n- $\\mathbf{k}_{010}$: $\\{\\xi_m\\} = \\{-1,+1,+1,+1\\} \\implies \\delta(\\mathbf{k}_{010}) = (-1)(+1)(+1)(+1) = -1$\n- $\\mathbf{k}_{001}$: $\\{\\xi_m\\} = \\{+1,+1,+1,+1\\} \\implies \\delta(\\mathbf{k}_{001}) = (+1)(+1)(+1)(+1) = +1$\n- $\\mathbf{k}_{110}$: $\\{\\xi_m\\} = \\{+1,+1,+1,+1\\} \\implies \\delta(\\mathbf{k}_{110}) = (+1)(+1)(+1)(+1) = +1$\n- $\\mathbf{k}_{101}$: $\\{\\xi_m\\} = \\{-1,+1,+1,+1\\} \\implies \\delta(\\mathbf{k}_{101}) = (-1)(+1)(+1)(+1) = -1$\n- $\\mathbf{k}_{011}$: $\\{\\xi_m\\} = \\{+1,+1,+1,+1\\} \\implies \\delta(\\mathbf{k}_{011}) = (+1)(+1)(+1)(+1) = +1$\n- $\\mathbf{k}_{111}$: $\\{\\xi_m\\} = \\{+1,+1,+1,+1\\} \\implies \\delta(\\mathbf{k}_{111}) = (+1)(+1)(+1)(+1) = +1$\n\n$\\delta(\\mathbf{k})$ 值的总结：\n$$\n\\begin{array}{l}\n\\delta(\\mathbf{k}_{000})=+1 \\\\\n\\delta(\\mathbf{k}_{100})=-1 \\\\\n\\delta(\\mathbf{k}_{010})=-1 \\\\\n\\delta(\\mathbf{k}_{001})=+1 \\\\\n\\delta(\\mathbf{k}_{110})=+1 \\\\\n\\delta(\\mathbf{k}_{101})=-1 \\\\\n\\delta(\\mathbf{k}_{011})=+1 \\\\\n\\delta(\\mathbf{k}_{111})=+1\n\\end{array}\n$$\n\n接下来，我们计算拓扑指标。\n\n对于强指标 $\\nu_0$：\n$$\n(-1)^{\\nu_0} = \\delta(\\mathbf{k}_{000})\\delta(\\mathbf{k}_{100})\\delta(\\mathbf{k}_{010})\\delta(\\mathbf{k}_{001})\\delta(\\mathbf{k}_{110})\\delta(\\mathbf{k}_{101})\\delta(\\mathbf{k}_{011})\\delta(\\mathbf{k}_{111})\n$$\n$$\n(-1)^{\\nu_0} = (+1)(-1)(-1)(+1)(+1)(-1)(+1)(+1) = (-1)^3 = -1\n$$\n因此，$\\nu_0 = 1$。\n\n对于弱指标 $\\nu_1$：\n$$\n(-1)^{\\nu_1} = \\delta(\\mathbf{k}_{100})\\delta(\\mathbf{k}_{110})\\delta(\\mathbf{k}_{101})\\delta(\\mathbf{k}_{111}) = (-1)(+1)(-1)(+1) = (-1)^2 = +1\n$$\n因此，$\\nu_1 = 0$。\n\n对于弱指标 $\\nu_2$：\n$$\n(-1)^{\\nu_2} = \\delta(\\mathbf{k}_{010})\\delta(\\mathbf{k}_{110})\\delta(\\mathbf{k}_{011})\\delta(\\mathbf{k}_{111}) = (-1)(+1)(+1)(+1) = -1\n$$\n因此，$\\nu_2 = 1$。\n\n对于弱指标 $\\nu_3$：\n$$\n(-1)^{\\nu_3} = \\delta(\\mathbf{k}_{001})\\delta(\\mathbf{k}_{101})\\delta(\\mathbf{k}_{011})\\delta(\\mathbf{k}_{111}) = (+1)(-1)(+1)(+1) = -1\n$$\n因此，$\\nu_3 = 1$。\n\n给定晶体的拓扑指标集为 $(\\nu_0; \\nu_1 \\nu_2 \\nu_3) = (1; 011)$。这对应一个强拓扑绝缘体。问题要求最终答案以行矩阵 $[\\nu_0 \\ \\nu_1 \\ \\nu_2 \\ \\nu_3]$ 的形式给出。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1 & 0 & 1 & 1\n\\end{pmatrix}\n}\n$$", "id": "2532806"}, {"introduction": "理论预测的拓扑性质必须通过实验来验证。角分辨光电子能谱（ARPES）是直接观测能带反转（许多拓扑绝缘体的标志）的主要技术。本练习使用一个简化的双能带模型，阐释了电子态的轨道属性与ARPES实验中测得的光偏振依赖强度之间的深刻联系，帮助您理解我们如何通过实验手段“看见”拓扑。[@problem_id:2532776]", "problem": "一个调控到拓扑绝缘体相的中心对称窄带隙半导体，其在布里渊区中心（$\\Gamma$）附近的行为可以通过一个最小轨道子空间来建模，该子空间由一个具有相同自旋的偶宇称类 $s$ 轨道 $\\lvert s \\rangle$ 和一个奇宇称类 $p$ 轨道 $\\lvert p_y \\rangle$ 张成（固定单个 Kramers 伴侣）。考虑在这个 $\\{ \\lvert s \\rangle, \\lvert p_y \\rangle \\}$ 基下的 $\\Gamma$ 点哈密顿量，\n$$\nH(\\Gamma) \\;=\\; m\\,\\sigma_z \\;+\\; V\\,\\sigma_x,\n$$\n其中 $m \\in \\mathbb{R}$ 参数化了相对在位能量分裂（$m<0$ 表示能带反转相），而 $V>0$ 描述了在 $\\Gamma$ 点的轨道间杂化。在此，$\\sigma_x$ 和 $\\sigma_z$ 是作用于该轨道子空间中的泡利矩阵。定义轨道投影算符 $P_s = \\tfrac{1}{2}\\left(\\mathbb{I} + \\sigma_z\\right)$ 和 $P_p = \\tfrac{1}{2}\\left(\\mathbb{I} - \\sigma_z\\right)$。\n\n第 (i) 部分：从此哈密顿量和投影算符的定义出发，计算 $\\Gamma$ 点的轨道权重，即上（$+$）和下（$-$）本征态中的类 $s$ 和类 $p_y$ 权重，$w_s^{\\pm} = \\langle u_{\\pm}\\rvert P_s \\lvert u_{\\pm} \\rangle$ 和 $w_p^{\\pm} = \\langle u_{\\pm}\\rvert P_p \\lvert u_{\\pm} \\rangle$，并用 $m$ 和 $V$ 表示。\n\n第 (ii) 部分：现在考虑从一个以 $xz$ 平面为镜面的 $(001)$ 表面正出射的角分辨光电子能谱（ARPES）。在电偶极近似中，假定 $s$ 偏振光的电场沿 $y$ 方向（在 $xz$ 镜面反射下为奇），而 $p$ 偏振光的电场在 $xz$ 平面内（在 $xz$ 镜面反射下为偶）。假设对称性在正出射时强制执行以下选择定则：$s$ 偏振光仅与奇宇称的 $p_y$ 分量耦合，而 $p$ 偏振光仅与偶宇称的 $s$ 分量耦合。设相应的径向偶极矩阵元大小分别为 $R_p$ 和 $R_s$，其中 $R_s, R_p \\in \\mathbb{R}_{>0}$。使用第 (i) 部分计算的轨道权重，推导 $\\Gamma$ 点下本征态的 ARPES 强度比，\n$$\n\\frac{I_p}{I_s},\n$$\n并用 $m$、$V$、$R_s$ 和 $R_p$ 表示。\n\n将 $\\dfrac{I_p}{I_s}$ 关于 $m$、$V$、$R_s$ 和 $R_p$ 的单个闭式解析表达式作为你的最终答案。该比值为无量纲；无需进行数值计算。", "solution": "该问题要求推导一个拓扑绝缘体双带模型的角分辨光电子能谱（ARPES）强度比 $\\dfrac{I_p}{I_s}$。步骤如下：首先，必须对哈密顿量进行对角化以求其本征态和本征值。其次，必须计算下本征态（对应于光电发射过程中的初态）的轨道权重。第三，利用给定的 ARPES 选择定则，将 $p$ 偏振光和 $s$ 偏振光的强度用这些轨道权重和给定的偶极矩阵元表示出来。最后，计算这些强度的比值。\n\n该问题是在偶宇称轨道 $\\lvert s \\rangle$ 和奇宇称轨道 $\\lvert p_y \\rangle$ 的基中陈述的。我们用向量 $\\lvert s \\rangle \\rightarrow \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$ 和 $\\lvert p_y \\rangle \\rightarrow \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}$ 来表示这个基。在此基中，泡利矩阵为 $\\sigma_z = \\begin{pmatrix} 1 & 0 \\\\ 0 & -1 \\end{pmatrix}$ 和 $\\sigma_x = \\begin{pmatrix} 0 & 1 \\\\ 1 & 0 \\end{pmatrix}$。\n\n$\\Gamma$ 点的哈密顿量为 $H(\\Gamma) = m\\,\\sigma_z + V\\,\\sigma_x$。其矩阵表示为：\n$$\nH \\;=\\; m \\begin{pmatrix} 1 & 0 \\\\ 0 & -1 \\end{pmatrix} + V \\begin{pmatrix} 0 & 1 \\\\ 1 & 0 \\end{pmatrix} \\;=\\; \\begin{pmatrix} m & V \\\\ V & -m \\end{pmatrix}\n$$\n通过求解特征方程 $\\det(H - E\\mathbb{I}) = 0$ 来找到本征值 $E$：\n$$\n\\det \\begin{pmatrix} m-E & V \\\\ V & -m-E \\end{pmatrix} \\;=\\; (m-E)(-m-E) - V^2 \\;=\\; -(m^2 - E^2) - V^2 \\;=\\; E^2 - m^2 - V^2 \\;=\\; 0\n$$\n这给出了本征值 $E_{\\pm} = \\pm\\sqrt{m^2 + V^2}$。上能带的能量为 $E_+ = +\\sqrt{m^2+V^2}$，下能带的能量为 $E_- = -\\sqrt{m^2+V^2}$。ARPES 探测的是占据态，因此我们关心的是对应于本征值 $E_{-}$ 的下本征态 $\\lvert u_{-} \\rangle$。\n\n设本征态为 $\\lvert u_{-} \\rangle = \\begin{pmatrix} c_s \\\\ c_p \\end{pmatrix}$。它满足方程 $(H - E_{-}\\mathbb{I}) \\lvert u_{-} \\rangle = 0$：\n$$\n\\begin{pmatrix} m-E_{-} & V \\\\ V & -m-E_{-} \\end{pmatrix} \\begin{pmatrix} c_s \\\\ c_p \\end{pmatrix} \\;=\\; \\begin{pmatrix} m+\\sqrt{m^2+V^2} & V \\\\ V & -m+\\sqrt{m^2+V^2} \\end{pmatrix} \\begin{pmatrix} c_s \\\\ c_p \\end{pmatrix} \\;=\\; \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}\n$$\n从第一行，我们得到分量之间的关系：$(m+\\sqrt{m^2+V^2})c_s + V c_p = 0$。\n轨道权重定义为 $w_s^{-} = \\langle u_{-}| P_s | u_{-} \\rangle$ 和 $w_p^{-} = \\langle u_{-}| P_p | u_{-} \\rangle$。投影算符为 $P_s = \\frac{1}{2}(\\mathbb{I} + \\sigma_z) = \\begin{pmatrix} 1 & 0 \\\\ 0 & 0 \\end{pmatrix}$ 和 $P_p = \\frac{1}{2}(\\mathbb{I} - \\sigma_z) = \\begin{pmatrix} 0 & 0 \\\\ 0 & 1 \\end{pmatrix}$。对于一个归一化的态 $\\lvert u_{-} \\rangle = \\begin{pmatrix} c_s \\\\ c_p \\end{pmatrix}$，权重即为 $w_s^{-} = |c_s|^2$ 和 $w_p^{-} = |c_p|^2$。权重的比值为：\n$$\n\\frac{w_p^{-}}{w_s^{-}} \\;=\\; \\frac{|c_p|^2}{|c_s|^2} \\;=\\; \\left| -\\frac{m+\\sqrt{m^2+V^2}}{V} \\right|^2 \\;=\\; \\frac{(m+\\sqrt{m^2+V^2})^2}{V^2}\n$$\n我们需要其反比，$\\dfrac{w_s^{-}}{w_p^{-}}$：\n$$\n\\frac{w_s^{-}}{w_p^{-}} \\;=\\; \\frac{V^2}{(m+\\sqrt{m^2+V^2})^2}\n$$\n为简化此表达式，我们将分子和分母同乘以 $(\\sqrt{m^2+V^2}-m)^2$：\n$$\n\\frac{w_s^{-}}{w_p^{-}} \\;=\\; \\frac{V^2 (\\sqrt{m^2+V^2}-m)^2}{((m+\\sqrt{m^2+V^2})(\\sqrt{m^2+V^2}-m))^2} \\;=\\; \\frac{V^2 (\\sqrt{m^2+V^2}-m)^2}{( (m^2+V^2) - m^2 )^2} \\;=\\; \\frac{V^2 (\\sqrt{m^2+V^2}-m)^2}{(V^2)^2} \\;=\\; \\frac{(\\sqrt{m^2+V^2}-m)^2}{V^2}\n$$\n这就给出了下本征态的轨道权重之比。\n\n接下来，我们分析 ARPES 强度。光电发射信号的强度与跃迁矩阵元的平方成正比，$I \\propto |\\langle f | \\hat{O} | i \\rangle|^2$。初态是下本征态 $|i\\rangle = \\lvert u_{-} \\rangle = c_s \\lvert s \\rangle + c_p \\lvert p_y \\rangle$。算符 $\\hat{O}$ 取决于光的偏振。\n问题给出了以下选择定则：\n1.  对于 $p$ 偏振光，耦合仅发生在波函数的偶宇称 $s$ 分量上。径向矩阵元的大小为 $R_s$。\n2.  对于 $s$ 偏振光，耦合仅发生在奇宇称 $p_y$ 分量上。径向矩阵元的大小为 $R_p$。\n\n因此，$p$ 偏振光的强度 $I_p$ 与初态中 $s$ 成分的量以及相应矩阵元的平方成正比：\n$$\nI_p \\propto |c_s|^2 R_s^2 = w_s^{-} R_s^2\n$$\n$s$ 偏振光的强度 $I_s$ 与 $p_y$ 成分的量及其矩阵元的平方成正比：\n$$\nI_s \\propto |c_p|^2 R_p^2 = w_p^{-} R_p^2\n$$\n比例常数是相同的，因为它们取决于光子通量和末态的态密度，而这些被假定为固定的实验条件。强度之比为：\n$$\n\\frac{I_p}{I_s} \\;=\\; \\frac{w_s^{-} R_s^2}{w_p^{-} R_p^2} \\;=\\; \\frac{w_s^{-}}{w_p^{-}} \\left(\\frac{R_s}{R_p}\\right)^2\n$$\n代入先前导出的轨道权重比的表达式：\n$$\n\\frac{I_p}{I_s} \\;=\\; \\frac{(\\sqrt{m^2+V^2}-m)^2}{V^2} \\left(\\frac{R_s}{R_p}\\right)^2\n$$\n这可以合并成一个单一的表达式，即最终要求的结果。\n$$\n\\frac{I_p}{I_s} \\;=\\; \\left( \\frac{R_s (\\sqrt{m^2+V^2} - m)}{R_p V} \\right)^2\n$$", "answer": "$$\n\\boxed{\\left( \\frac{R_s \\left(\\sqrt{m^2 + V^2} - m\\right)}{R_p V} \\right)^{2}}\n$$", "id": "2532776"}, {"introduction": "除了分类之外，拓扑材料独特的电子结构还会引发新奇的物理现象，例如外尔半金属中的反常霍尔效应。该效应源于布洛赫波函数的几何性质——贝里曲率（Berry curvature）。本计算练习将指导您完成从一个紧束缚模型出发计算反常霍尔电导率的全过程，让您亲身体验如何将一个理论概念转化为数值结果，并理解其物理体现。[@problem_id:2532815]", "problem": "给定一个双带格点模型，它代表了一种作为 Bloch 基矢中的有效 Wannier 紧束缚模型而出现的、时间反演对称性破缺的最小外尔半金属。其哈密顿量为\n$$\nH(\\mathbf{k}) = d_x(\\mathbf{k})\\,\\sigma_x + d_y(\\mathbf{k})\\,\\sigma_y + d_z(\\mathbf{k})\\,\\sigma_z,\n$$\n其中\n$$\nd_x(\\mathbf{k}) = t \\sin k_x,\\quad\nd_y(\\mathbf{k}) = t \\sin k_y,\\quad\nd_z(\\mathbf{k}) = m + t_z \\left[\\cos k_z - \\cos k_0\\right] + 2 - \\cos k_x - \\cos k_y,\n$$\n此处 $\\sigma_x$、$\\sigma_y$ 和 $\\sigma_z$ 是 Pauli 矩阵，$\\mathbf{k}=(k_x,k_y,k_z)$ 位于第一布里渊区 $[-\\pi,\\pi)^3$ 内，参数固定为 $t = 1$、$t_z = 1$、$m=0$ 和 $k_0 = \\pi/3$。角度以弧度为单位。采用自然单位制，其中 $e^2/\\hbar = 1$ 且晶格常数 $a=1$，因此在这些单位中，内禀反常霍尔电导率 $\\sigma_{xy}$ 是无量纲的。\n\n仅从以下核心定义出发：\n- 零温下的内禀反常霍尔电导率为\n$$\n\\sigma_{xy}(E_F) = -\\sum_n \\int_{\\text{BZ}} \\frac{d^3k}{(2\\pi)^3}\\, f\\!\\left(E_n(\\mathbf{k}) - E_F\\right)\\,\\Omega_{n,z}(\\mathbf{k}),\n$$\n其中 $f$ 是零温 Fermi-Dirac 分布，$E_n(\\mathbf{k})$ 是第 $n$ 个能带的能量，而 $\\Omega_{n,z}(\\mathbf{k})$ 是第 $n$ 个能带的 Berry 曲率的 z 分量。\n- 能带能量是 $H(\\mathbf{k})$ 的本征值。\n- 对于形式为 $H(\\mathbf{k})=\\mathbf{d}(\\mathbf{k})\\cdot\\boldsymbol{\\sigma}$ 的双带哈密顿量，每个能带的 Berry 曲率可以表示为 $\\mathbf{d}(\\mathbf{k})$ 及其动量导数的函数。\n\n你的任务是：\n- 从第一性原理推导出一个算法，该算法在均匀的 $\\mathbf{k}$ 网格上计算 Berry 曲率 $\\Omega_{n,z}(\\mathbf{k})$，并通过在布里渊区上进行数值积分来近似计算 $\\sigma_{xy}(E_F)$。\n- 将此算法实现为一个完整、可运行的程序，该程序：\n  1. 在 $[-\\pi,\\pi)^3$ 范围内构建一个大小为 $N_k \\times N_k \\times N_k$ 的均匀 $\\mathbf{k}$ 网格。\n  2. 对每个 $\\mathbf{k}$ 值计算能带能量 $E_\\pm(\\mathbf{k})$ 和 Berry 曲率 $\\Omega_{\\pm,z}(\\mathbf{k})$。\n  3. 使用 Riemann 和来近似布里渊区积分，其中体积元为 $\\Delta k^3 = (2\\pi/N_k)^3$，并考虑定义中的因子 $(2\\pi)^{-3}$，确保每个点的总权重为 $(N_k)^{-3}$。\n  4. 通过对零温下所有已占据态的贡献求和，在指定的费米能级 $E_F$ 下计算 $\\sigma_{xy}(E_F)$。\n  5. 将每个报告值四舍五入到 $6$ 位小数。\n\n使用以下参数对 $(N_k,E_F)$ 的测试套件：\n- $(12,0.0)$\n- $(20,0.0)$\n- $(28,0.0)$\n- $(20,0.5)$\n- $(20,10.0)$\n- $(20,-10.0)$\n\n科学和数值要求：\n- 使用上述哈密顿量参数 $t = 1$、$t_z = 1$、$m=0$ 和 $k_0 = \\pi/3$。\n- 角度使用弧度制。\n- 使用零温，即当 $E \\le E_F$ 时 $f(E - E_F) = 1$，否则为 $0$。\n- 以自然单位制报告 $\\sigma_{xy}$，其中 $e^2/\\hbar=1$ 且 $a=1$。\n- 确保 Berry 曲率计算的数值稳定性；实现对简并点的安全处理以避免除以 $0$。\n- 程序必须将所有测试用例的结果汇总到单行输出中，格式严格为方括号括起来的逗号分隔列表，例如 $[\\text{result}_1,\\text{result}_2,\\dots]$，其中每个结果四舍五入到 $6$ 位小数。\n\n你的程序应产生单行输出，其中包含一个用方括号括起来的逗号分隔的结果列表（例如，$[r_1,r_2,r_3,r_4,r_5,r_6]$）。", "solution": "所述问题在科学上是合理的，提法恰当，并包含了获得唯一解所需的所有信息。这是计算凝聚态物理中的一个标准练习，基于已确立的理论原理。不存在使之无效的缺陷。我们将继续进行推导和求解。\n\n目标是计算给定外尔半金属双带模型的内禀反常霍尔电导率 (AHC) $\\sigma_{xy}$。这将通过推导 Berry 曲率的解析表达式，然后实现对布里渊区的数值积分来完成。\n\n系统的哈密顿量以标准的双带形式给出：\n$$\nH(\\mathbf{k}) = \\mathbf{d}(\\mathbf{k}) \\cdot \\boldsymbol{\\sigma} = d_x(\\mathbf{k})\\,\\sigma_x + d_y(\\mathbf{k})\\,\\sigma_y + d_z(\\mathbf{k})\\,\\sigma_z\n$$\n其中 $\\boldsymbol{\\sigma} = (\\sigma_x, \\sigma_y, \\sigma_z)$ 是 Pauli 矩阵的向量。能量本征值，代表两个能带，可以立即求得：\n$$\nE_{\\pm}(\\mathbf{k}) = \\pm |\\mathbf{d}(\\mathbf{k})| = \\pm d(\\mathbf{k})\n$$\n其中 $d(\\mathbf{k}) = \\sqrt{d_x^2(\\mathbf{k}) + d_y^2(\\mathbf{k}) + d_z^2(\\mathbf{k})}$。我们用 $n=-$ 表示下能带（价带），用 $n=+$ 表示上能带（导带）。\n\n零温下的 AHC 由 Kubo 公式给出，该公式对所有已占据态的 Berry 曲率贡献求和：\n$$\n\\sigma_{xy}(E_F) = -\\sum_{n=\\pm} \\int_{\\text{BZ}} \\frac{d^3k}{(2\\pi)^3}\\, f(E_n(\\mathbf{k}) - E_F)\\,\\Omega_{n,z}(\\mathbf{k})\n$$\n此处，$f(E - E_F)$ 是零温 Fermi-Dirac 分布，它是一个阶跃函数：当 $x \\le 0$ 时 $f(x)=1$，当 $x > 0$ 时 $f(x)=0$。积分范围是第一布里渊区 (BZ)，$\\mathbf{k} \\in [-\\pi, \\pi)^3$。$\\Omega_{n,z}(\\mathbf{k})$ 是第 $n$ 个能带的 Berry 曲率的 z 分量。\n\n对于形式为 $\\mathbf{d}(\\mathbf{k}) \\cdot \\boldsymbol{\\sigma}$ 的双带哈密顿量，Berry 曲率可以直接用向量 $\\mathbf{d}(\\mathbf{k})$ 及其关于动量的偏导数来表示。上（$+$）能带和下（$-$）能带的 z 分量（等价于 Berry 曲率张量的 xy 分量）由下式给出：\n$$\n\\Omega_{\\pm,z}(\\mathbf{k}) = \\mp \\frac{1}{2 d(\\mathbf{k})^3} \\mathbf{d}(\\mathbf{k}) \\cdot \\left( \\frac{\\partial \\mathbf{d}(\\mathbf{k})}{\\partial k_x} \\times \\frac{\\partial \\mathbf{d}(\\mathbf{k})}{\\partial k_y} \\right)\n$$\n注意到两个能带的曲率符号相反，$\\Omega_{+,z}(\\mathbf{k}) = -\\Omega_{-,z}(\\mathbf{k})$。因此，只需计算一个能带的曲率（例如下能带的 $\\Omega_{-,z}(\\mathbf{k})$）并利用此关系即可。标量三重积可以写成一个行列式：\n$$\n\\Omega_{-,z}(\\mathbf{k}) = \\frac{1}{2 d(\\mathbf{k})^3} \\det \\begin{pmatrix} d_x & d_y & d_z \\\\ \\partial_{k_x} d_x & \\partial_{k_x} d_y & \\partial_{k_x} d_z \\\\ \\partial_{k_y} d_x & \\partial_{k_y} d_y & \\partial_{k_y} d_z \\end{pmatrix}\n$$\n我们现在必须计算该行列式的分量。给定的参数为 $t=1$, $t_z=1$, $m=0$, and $k_0=\\pi/3$。向量分量为：\n$$\nd_x(\\mathbf{k}) = \\sin k_x\n$$\n$$\nd_y(\\mathbf{k}) = \\sin k_y\n$$\n$$\nd_z(\\mathbf{k}) = \\cos k_z - \\cos(\\pi/3) + 2 - \\cos k_x - \\cos k_y\n$$\n它们关于 $k_x$ 和 $k_y$ 的偏导数为：\n$$\n\\frac{\\partial \\mathbf{d}}{\\partial k_x} = (\\cos k_x, 0, \\sin k_x)\n$$\n$$\n\\frac{\\partial \\mathbf{d}}{\\partial k_y} = (0, \\cos k_y, \\sin k_y)\n$$\n将这些代入行列式可得：\n$$\n\\mathbf{d} \\cdot \\left( \\frac{\\partial \\mathbf{d}}{\\partial k_x} \\times \\frac{\\partial \\mathbf{d}}{\\partial k_y} \\right) = \\det \\begin{pmatrix} \\sin k_x & \\sin k_y & d_z \\\\ \\cos k_x & 0 & \\sin k_x \\\\ 0 & \\cos k_y & \\sin k_y \\end{pmatrix}\n$$\n$$\n= \\sin k_x(0 \\cdot \\sin k_y - \\cos k_y \\cdot \\sin k_x) - \\sin k_y(\\cos k_x \\cdot \\sin k_y - 0 \\cdot \\sin k_x) + d_z(\\cos k_x \\cdot \\cos k_y - 0 \\cdot 0)\n$$\n$$\n= -\\sin^2 k_x \\cos k_y - \\sin^2 k_y \\cos k_x + d_z \\cos k_x \\cos k_y\n$$\n这个表达式是 Berry 曲率 $\\Omega_{-,z}(\\mathbf{k})$ 的分子。\n\n为了进行数值计算，我们将布里渊区上的积分离散化为在均匀 $N_k \\times N_k \\times N_k$ 网格上的 Riemann 和。动量空间体积元为 $\\Delta k_x \\Delta k_y \\Delta k_z = (2\\pi/N_k)^3$。积分定义中的因子 $(2\\pi)^{-3}$ 与体积元中的 $(2\\pi)^3$ 相抵消，使得每个网格点的总权重为 $1/N_k^3$。AHC 的表达式变为：\n$$\n\\sigma_{xy}(E_F) \\approx -\\frac{1}{N_k^3} \\sum_{\\mathbf{k}_i \\in \\text{mesh}} \\sum_{n=\\pm} f(E_n(\\mathbf{k}_i) - E_F) \\Omega_{n,z}(\\mathbf{k}_i)\n$$\n代入 $E_\\pm = \\pm d$ 和 $\\Omega_{+,z} = -\\Omega_{-,z}$：\n$$\n\\sigma_{xy}(E_F) \\approx -\\frac{1}{N_k^3} \\sum_{\\mathbf{k}_i} \\left[ f(d(\\mathbf{k}_i) - E_F)(-\\Omega_{-,z}(\\mathbf{k}_i)) + f(-d(\\mathbf{k}_i) - E_F)\\Omega_{-,z}(\\mathbf{k}_i) \\right]\n$$\n$$\n\\sigma_{xy}(E_F) \\approx \\frac{1}{N_k^3} \\sum_{\\mathbf{k}_i} \\Omega_{-,z}(\\mathbf{k}_i) \\left[ f(d(\\mathbf{k}_i) - E_F) - f(-d(\\mathbf{k}_i) - E_F) \\right]\n$$\n这是用于数值实现的最终公式。方括号中的项根据费米能级 $E_F$ 有效地选择了对 AHC 有贡献的态。\n\n数值计算的一个关键方面是处理外尔点，即 $d(\\mathbf{k})=0$ 的简并点。在这些点上，由于分母中存在 $d(\\mathbf{k})^3$ 项，$\\Omega_{n,z}(\\mathbf{k})$ 的表达式会发散。在离散网格上，我们可能不会精确地碰到这些点，但会遇到 $d(\\mathbf{k})$ 非常小的点，导致数值不稳定性。正确的处理方法是认识到测度为零的单点对积分的贡献为零。因此，如果 $d(\\mathbf{k})$ 小于一个很小的数值容差 $\\epsilon$，其对求和的贡献就设为零。这确保了计算的稳定性，而不会影响大 $N_k$ 时求和的收敛性。\n\n算法如下：\n1.  对每个测试用例 $(N_k, E_F)$，在 $[-\\pi, \\pi)^3$ 范围内为 $\\mathbf{k}=(k_x, k_y, k_z)$ 构建一个包含 $N_k^3$ 个点的均匀三维网格。\n2.  在此网格上进行向量化计算。对每个点 $\\mathbf{k}_i$：\n    a.  计算分量 $d_x, d_y, d_z$。\n    b.  计算模长 $d = \\sqrt{d_x^2 + d_y^2 + d_z^2}$。\n    c.  计算行列式项：`det_term` $= -\\sin^2 k_x \\cos k_y - \\sin^2 k_y \\cos k_x + d_z \\cos k_x \\cos k_y$。\n    d.  计算下能带的 Berry 曲率 $\\Omega_{-,z}$。如果 $d$ 小于某个阈值（例如 $10^{-9}$），则设 $\\Omega_{-,z}=0$。否则，计算 $\\Omega_{-,z} = (1/2) \\cdot \\text{det\\_term} / d^3$。\n    e.  计算 Fermi-Dirac 滤波因子：`factor` $= [f(d - E_F) - f(-d - E_F)]$。\n3.  对网格中所有点，将 `factor` $\\times$ $\\Omega_{-,z}$ 的乘积求和。\n4.  将总和乘以归一化因子 $1/N_k^3$ 得到 $\\sigma_{xy}$。\n5.  按要求将最终结果四舍五入到 $6$ 位小数。\n此过程将在提供的 Python 代码中实现。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the anomalous Hall conductivity for a Weyl semimetal model.\n    \"\"\"\n\n    test_cases = [\n        (12, 0.0),\n        (20, 0.0),\n        (28, 0.0),\n        (20, 0.5),\n        (20, 10.0),\n        (20, -10.0),\n    ]\n\n    results = []\n    for Nk, Ef in test_cases:\n        result = calculate_sigma_xy(Nk, Ef)\n        results.append(np.round(result, 6))\n\n    print(f\"[{','.join(map(str, results))}]\")\n\n\ndef calculate_sigma_xy(Nk, Ef):\n    \"\"\"\n    Calculates the anomalous Hall conductivity sigma_xy for a given k-mesh size\n    and Fermi level.\n\n    Args:\n        Nk (int): The number of points in the k-mesh along one dimension.\n        Ef (float): The Fermi level.\n\n    Returns:\n        float: The calculated anomalous Hall conductivity sigma_xy.\n    \"\"\"\n    # Define model parameters\n    t = 1.0\n    tz = 1.0\n    m = 0.0\n    k0 = np.pi / 3.0\n    \n    # Numerical tolerance for handling degeneracies\n    epsilon = 1e-9\n\n    # Create a uniform k-mesh over the first Brillouin zone [-pi, pi)^3\n    k_range = np.linspace(-np.pi, np.pi, Nk, endpoint=False)\n    kx, ky, kz = np.meshgrid(k_range, k_range, k_range, indexing='ij')\n\n    # Calculate the components of the d-vector\n    # d_x(k) = t * sin(k_x)\n    # d_y(k) = t * sin(k_y)\n    # d_z(k) = m + t_z * [cos(k_z) - cos(k_0)] + 2 - cos(k_x) - cos(k_y)\n    dx = t * np.sin(kx)\n    dy = t * np.sin(ky)\n    dz = m + tz * (np.cos(kz) - np.cos(k0)) + 2.0 - np.cos(kx) - np.cos(ky)\n\n    # Calculate the magnitude of the d-vector, d(k)\n    d = np.sqrt(dx**2 + dy**2 + dz**2)\n\n    # The numerator of the Berry curvature formula for the lower band, derived from\n    # 0.5 * d . (d(d)/dkx x d(d)/dky)\n    # det_term = -sin^2(kx)cos(ky) - sin^2(ky)cos(kx) + dz*cos(kx)cos(ky)\n    # Note: t=1 is already incorporated in dx, dy, dz derivatives.\n    sin_kx = np.sin(kx)\n    cos_kx = np.cos(kx)\n    sin_ky = np.sin(ky)\n    cos_ky = np.cos(ky)\n    \n    det_term = -sin_kx**2 * cos_ky - sin_ky**2 * cos_kx + dz * cos_kx * cos_ky\n\n    # Initialize Berry curvature array\n    omega_minus_z = np.zeros_like(d)\n    \n    # Identify non-degenerate points to avoid division by zero\n    safe_indices = d > epsilon\n\n    # Calculate Berry curvature for non-degenerate points\n    # Omega_{-,z} = (1/2) * det_term / d^3\n    omega_minus_z[safe_indices] = 0.5 * det_term[safe_indices] / (d[safe_indices]**3)\n\n    # Zero-temperature Fermi-Dirac distribution factor\n    # f(E) = 1 if E <= 0, 0 otherwise\n    # factor = f(d - Ef) - f(-d - Ef)\n    # Vectorized boolean arithmetic achieves this: (d <= Ef) is 1 or 0\n    factor = (d - Ef <= 0).astype(float) - (-d - Ef <= 0).astype(float)\n\n    # Sum contributions over the entire Brillouin zone\n    # The total weight per point is 1/Nk^3\n    sigma_xy = np.sum(omega_minus_z * factor) / (Nk**3)\n\n    return sigma_xy\n\nsolve()\n```", "id": "2532815"}]}