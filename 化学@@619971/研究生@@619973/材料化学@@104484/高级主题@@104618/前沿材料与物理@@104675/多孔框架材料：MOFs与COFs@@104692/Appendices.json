{"hands_on_practices": [{"introduction": "测量比表面积是表征多孔骨架材料（如MOFs和COFs）最基本和关键的一步。Brunauer-Emmett-Teller (BET) 理论提供了一种利用气体吸附数据来量化材料内部表面积的成熟方法。本练习将指导您完成一个典型的BET分析流程，从原始的氮气吸附数据点出发，通过线性拟合提取关键参数，并最终计算出材料的比表面积$S_{\\mathrm{BET}}$，这是评估任何多孔材料性能的基石。[@problem_id:2514683]", "problem": "某种金属有机框架（MOF）通过在 $77\\ \\mathrm{K}$ 下的氮吸附进行表征。在 Brunauer–Emmett–Teller (BET) 范围内获得以下平衡吸附数据，以单位质量的吸附量 $n$ ($\\mathrm{mmol\\ g^{-1}}$) 表示，对应于相对压力 $P/P_0$：\n- $P/P_0 = 0.10$，$n = 12.23241590\\ \\mathrm{mmol\\ g^{-1}}$\n- $P/P_0 = 0.20$，$n = 14.42307692\\ \\mathrm{mmol\\ g^{-1}}$\n- $P/P_0 = 0.25$，$n = 15.53398058\\ \\mathrm{mmol\\ g^{-1}}$\n\n从线性化的 Brunauer–Emmett–Teller (BET) 方程出发，\n$$\n\\frac{P}{n\\,(P_0 - P)} \\;=\\; \\frac{1}{n_m\\,C} \\;+\\; \\frac{C - 1}{n_m\\,C}\\,\\frac{P}{P_0},\n$$\n其中 $n_m$ 是单层吸附量（单位为 $\\mathrm{mol\\ g^{-1}}$），$C$ 是 BET 常数，完成以下任务：\n- 通过定义 $x \\equiv P/P_0$ 和 $y \\equiv P/\\!\\left[n\\,(P_0 - P)\\right]$ 来构建 BET 图，并在所述的 $P/P_0$ 范围内进行线性拟合 $y = s\\,x + i$，以获得斜率 $s$ 和截距 $i$。\n- 从 $s$ 和 $i$ 中，提取 $n_m$ 和 $C$。\n- 使用 $n_m$ 计算比表面积 $S_{\\mathrm{BET}}$，此计算根据基于氮分子密堆积横截面积的单层法，其中\n$N_A = 6.02214076 \\times 10^{23}\\ \\mathrm{mol^{-1}}$ 且每个分子的 $a_{\\mathrm{N_2}} = 0.162\\ \\mathrm{nm^2}$。使用 $1\\ \\mathrm{nm^2} = 1 \\times 10^{-18}\\ \\mathrm{m^2}$。将 $S_{\\mathrm{BET}}$ 以 $\\mathrm{m^2\\ g^{-1}}$ 为单位表示。\n\n将 $S_{\\mathrm{BET}}$ 的最终数值答案四舍五入至四位有效数字。", "solution": "首先对问题陈述进行严格验证。\n\n**问题验证**\n\n已知条件如下：\n1.  某种金属有机框架（MOF）在 $77\\ \\mathrm{K}$ 下的氮吸附数据：\n    - 当 $P/P_0 = 0.10$ 时，吸附量为 $n = 12.23241590\\ \\mathrm{mmol\\ g^{-1}}$。\n    - 当 $P/P_0 = 0.20$ 时，吸附量为 $n = 14.42307692\\ \\mathrm{mmol\\ g^{-1}}$。\n    - 当 $P/P_0 = 0.25$ 时，吸附量为 $n = 15.53398058\\ \\mathrm{mmol\\ g^{-1}}$。\n2.  线性化的 Brunauer–Emmett–Teller (BET) 方程：$\\frac{P}{n\\,(P_0 - P)} \\;=\\; \\frac{1}{n_m\\,C} \\;+\\; \\frac{C - 1}{n_m\\,C}\\,\\frac{P}{P_0}$。\n3.  线性图的定义：$x \\equiv P/P_0$ 和 $y \\equiv P/\\!\\left[n\\,(P_0 - P)\\right]$。线性拟合为 $y = s\\,x + i$。\n4.  物理常数：阿伏伽德罗常数 $N_A = 6.02214076 \\times 10^{23}\\ \\mathrm{mol^{-1}}$ 和氮分子横截面积 $a_{\\mathrm{N_2}} = 0.162\\ \\mathrm{nm^2}$。\n5.  单位换算：$1\\ \\mathrm{nm^2} = 1 \\times 10^{-18}\\ \\mathrm{m^2}$。\n6.  要求输出：斜率 $s$、截距 $i$、单层吸附量 $n_m$、BET常数 $C$ 和比表面积 $S_{\\mathrm{BET}}$（以 $\\mathrm{m^2\\ g^{-1}}$ 为单位，四舍五入到四位有效数字）。问题指定 $n_m$ 的单位应为 $\\mathrm{mol\\ g^{-1}}$。\n\n**结论**\n该问题被判定为**有效**。它在科学上基于物理吸附和通过BET模型进行表面积分析的既定原理。它的提法很严谨，提供了足够的数据和清晰的定义来确定唯一的解。语言客观而精确。数据虽然是为了产生完美的线性关系而设计的，但对于高比表面积材料来说在物理上是合理的。该任务是表面科学原理的标准应用。\n\n**解题过程**\n\n解题过程遵循一系列逻辑步骤。\n\n**步骤1：BET图的数据转换**\n给定的是BET方程的线性形式。为了构建BET图，我们必须将给定的吸附数据 $(P/P_0, n)$ 转换为坐标 $(x, y)$。自变量是 $x = P/P_0$。因变量是 $y = \\frac{P}{n\\,(P_0 - P)}$，它可以根据 $x$ 重写为：\n$$\ny = \\frac{P/P_0}{n(1 - P/P_0)} = \\frac{x}{n(1-x)}\n$$\n$n$ 的单位是 $\\mathrm{mmol\\ g^{-1}}$，所以 $y$ 的单位将是 $\\mathrm{g\\ mmol^{-1}}$。\n\n我们计算三个给定数据点的 $(x, y)$ 坐标：\n- 点 1：$x_1 = 0.10$，$n_1 = 12.23241590\\ \\mathrm{mmol\\ g^{-1}}$\n$$\ny_1 = \\frac{0.10}{12.23241590 \\cdot (1 - 0.10)} = \\frac{0.10}{11.00917431} \\approx 0.00908333\\ \\mathrm{g\\ mmol^{-1}}\n$$\n- 点 2：$x_2 = 0.20$，$n_2 = 14.42307692\\ \\mathrm{mmol\\ g^{-1}}$\n$$\ny_2 = \\frac{0.20}{14.42307692 \\cdot (1 - 0.20)} = \\frac{0.20}{11.538461536} \\approx 0.01733333\\ \\mathrm{g\\ mmol^{-1}}\n$$\n- 点 3：$x_3 = 0.25$，$n_3 = 15.53398058\\ \\mathrm{mmol\\ g^{-1}}$\n$$\ny_3 = \\frac{0.25}{15.53398058 \\cdot (1 - 0.25)} = \\frac{0.25}{11.650485435} \\approx 0.02145833\\ \\mathrm{g\\ mmol^{-1}}\n$$\n\n**步骤2：线性拟合以获得斜率和截距**\n问题要求对这些点进行线性拟合 $y = s\\,x + i$。我们首先计算相邻点之间的斜率 $s$ 以验证其共线性。\n点1和点2之间的斜率：\n$$\ns_{12} = \\frac{y_2 - y_1}{x_2 - x_1} = \\frac{0.01733333... - 0.00908333...}{0.20 - 0.10} = \\frac{0.00825}{0.10} = 0.0825\\ \\mathrm{g\\ mmol^{-1}}\n$$\n点2和点3之间的斜率：\n$$\ns_{23} = \\frac{y_3 - y_2}{x_3 - x_2} = \\frac{0.02145833... - 0.01733333...}{0.25 - 0.20} = \\frac{0.004125}{0.05} = 0.0825\\ \\mathrm{g\\ mmol^{-1}}\n$$\n斜率相同，证实了这三个点是完全共线的。直线的斜率是 $s = 0.0825 = \\frac{33}{400}\\ \\mathrm{g\\ mmol^{-1}}$。\n截距 $i$ 可以使用点斜式 $i = y - s\\,x$ 求得。使用点1：\n$$\ni = y_1 - s\\,x_1 = 0.00908333... - (0.0825)(0.10) = 0.00908333... - 0.00825 = 0.00083333...\n$$\n这个循环小数是有理数 $\\frac{1}{1200}$。因此，截距是 $i = \\frac{1}{1200}\\ \\mathrm{g\\ mmol^{-1}}$。\n\n**步骤3：提取单层吸附量（$n_m$）和BET常数（$C$）**\n我们将经验斜率 $s$ 和截距 $i$ 与理论BET方程中的参数关联起来：\n$$\ns = \\frac{C - 1}{n_m\\,C} \\quad \\text{和} \\quad i = \\frac{1}{n_m\\,C}\n$$\n这是一个关于两个未知数 $n_m$ 和 $C$ 的二元方程组。\n首先，通过计算 $s$ 与 $i$ 的比值来求解 $C$：\n$$\n\\frac{s}{i} = \\frac{(C-1)/(n_m\\,C)}{1/(n_m\\,C)} = C - 1\n$$\n$$\nC = \\frac{s}{i} + 1 = \\frac{0.0825}{0.00083333...} + 1 = \\frac{33/400}{1/1200} + 1 = \\frac{33}{400} \\cdot 1200 + 1 = 33 \\cdot 3 + 1 = 99 + 1 = 100\n$$\nBET常数 $C$ 是一个等于 $100$ 的无量纲量。\n\n接下来，我们确定单层吸附量 $n_m$。一个直接的方法是将斜率和截距的表达式相加：\n$$\ns + i = \\frac{C - 1}{n_m\\,C} + \\frac{1}{n_m\\,C} = \\frac{C - 1 + 1}{n_m\\,C} = \\frac{C}{n_m\\,C} = \\frac{1}{n_m}\n$$\n因此，$n_m = \\frac{1}{s+i}$。\n$$\ns+i = 0.0825 + 0.00083333... = \\frac{33}{400} + \\frac{1}{1200} = \\frac{99+1}{1200} = \\frac{100}{1200} = \\frac{1}{12}\\ \\mathrm{g\\ mmol^{-1}}\n$$\n$$\nn_m = \\frac{1}{1/12} = 12\\ \\mathrm{mmol\\ g^{-1}}\n$$\n根据问题陈述，我们将其转换为 $\\mathrm{mol\\ g^{-1}}$：\n$$\nn_m = 12\\ \\mathrm{mmol\\ g^{-1}} = 12 \\times 10^{-3}\\ \\mathrm{mol\\ g^{-1}} = 0.012\\ \\mathrm{mol\\ g^{-1}}\n$$\n\n**步骤4：计算比表面积（$S_{\\mathrm{BET}}$）**\n比表面积是指吸附在1克吸附剂表面、形成完整单分子层的分子所占据的总面积。它的计算方法是：将每克物质的单层摩尔数（$n_m$）乘以阿伏伽德罗常数（$N_A$）得到分子数，然后再乘以单个吸附质分子（$a_{\\mathrm{N_2}}$）的横截面积。\n$$\nS_{\\mathrm{BET}} = n_m \\cdot N_A \\cdot a_{\\mathrm{N_2}}\n$$\n我们使用给定的值：\n$n_m = 0.012\\ \\mathrm{mol\\ g^{-1}}$\n$N_A = 6.02214076 \\times 10^{23}\\ \\mathrm{mol^{-1}}$\n$a_{\\mathrm{N_2}} = 0.162\\ \\mathrm{nm^2} = 0.162 \\times 10^{-18}\\ \\mathrm{m^2}$\n\n将这些值代入方程：\n$$\nS_{\\mathrm{BET}} = (0.012\\ \\mathrm{mol\\ g^{-1}}) \\times (6.02214076 \\times 10^{23}\\ \\mathrm{mol^{-1}}) \\times (0.162 \\times 10^{-18}\\ \\mathrm{m^2})\n$$\n$$\nS_{\\mathrm{BET}} = (0.012 \\times 6.02214076 \\times 0.162) \\times 10^{23-18}\\ \\mathrm{m^2\\ g^{-1}}\n$$\n$$\nS_{\\mathrm{BET}} = 0.0117072436... \\times 10^{5}\\ \\mathrm{m^2\\ g^{-1}}\n$$\n$$\nS_{\\mathrm{BET}} = 1170.72436...\\ \\mathrm{m^2\\ g^{-1}}\n$$\n问题要求最终答案四舍五入到四位有效数字。第五位有效数字是 7，因此需要将第四位数字向上取整。\n$$\nS_{\\mathrm{BET}} \\approx 1171\\ \\mathrm{m^2\\ g^{-1}}\n$$", "answer": "$$\\boxed{1171}$$", "id": "2514683"}, {"introduction": "在理解了材料的孔隙结构后，下一步是量化其与气体分子之间的相互作用强度。在极低压力下，吸附行为遵循亨利定律，其常数$K_H$直接反映了吸附质与骨架之间的初始亲和力。本练习不仅要求您从低压吸附数据中计算亨利常数，还将引导您从统计力学的第一性原理出发，推导出$K_H$的理论表达式，从而将宏观测量与微观相互作用势联系起来。[@problem_id:2514644]", "problem": "一项单组分吸附实验测量了在温度 $T = 298 \\,\\mathrm{K}$ 下，氩在一种晶体金属有机框架（MOF）中的低压等温线。测得的吸附量以每个晶体学晶胞中系综平均的氩吸附分子数（记为 $\\langle N \\rangle$）的形式报告，作为气体压力 $P$（单位：bar）的函数。在亨利区，吸附等温线与 $P$ 呈线性关系，其亨利定律常数 $K_H$ 定义为 $K_H = \\lim_{P \\to 0} \\langle N \\rangle / P$。考虑以下低压数据：\n- $P = 0.020$ bar, $\\langle N \\rangle = 0.0041$ 分子/晶胞\n- $P = 0.050$ bar, $\\langle N \\rangle = 0.0102$ 分子/晶胞\n- $P = 0.100$ bar, $\\langle N \\rangle = 0.0201$ 分子/晶胞\n\n假设如下：\n- 在所列的压力范围内适用亨利区，并且 $K_H$ 的最佳估计值通过约束以通过原点（即模型 $\\langle N \\rangle = K_H P$）的最小二乘线性回归获得。\n- 氩被视为单原子吸附质，其内自由度不受框架势的影响。\n- 在这些条件下，气相可被视为理想气体。\n- 框架作为一个静态外场，仅与吸附质的平动坐标耦合。\n\n任务：\n1. 仅使用上述数据，通过执行约束通过原点的最小二乘拟合，计算 $K_H$ 的最佳拟合值。\n2. 从统计力学的巨正则系综（GCE）和理想气体状态方程出发，推导 $K_H$ 在低逸度极限下的表达式，该表达式应使用单吸附质在晶胞体积上的构型积分和吸附质-框架相互作用势来表示。\n\n报告 $K_H$的数值，四舍五入到三位有效数字。为便于解释，可使用“分子/晶胞/bar”作为单位，但在最终数值答案中仅提供数值。", "solution": "该问题提出了两个不同的任务，将按顺序解决。第一个任务是根据实验数据对亨利定律常数进行数值计算。第二个任务是根据统计力学的第一性原理对该常数进行理论推导。\n\n任务1：亨利定律常数（$K_H$）的计算\n\n问题指出，在亨利区，吸附量 $\\langle N \\rangle$ 与气体压力 $P$ 之间的关系是线性的，并通过原点，由模型 $\\langle N \\rangle = K_H P$ 描述。我们的任务是使用约束通过原点的最小二乘线性回归，找到亨利定律常数 $K_H$ 的最佳拟合值。\n\n给定一组 $n$ 个数据点 $(P_i, \\langle N \\rangle_i)$，此模型的残差平方和 $S$ 由下式给出：\n$$S = \\sum_{i=1}^{n} \\left( \\langle N \\rangle_i - K_H P_i \\right)^2$$\n为了使 $S$ 相对于 $K_H$ 最小化，我们必须找到使 $S$ 对 $K_H$ 的导数为零的 $K_H$ 值：\n$$\\frac{dS}{dK_H} = \\frac{d}{dK_H} \\sum_{i=1}^{n} \\left( \\langle N \\rangle_i - K_H P_i \\right)^2 = \\sum_{i=1}^{n} 2 \\left( \\langle N \\rangle_i - K_H P_i \\right) (-P_i) = 0$$\n化简后得到：\n$$-\\sum_{i=1}^{n} \\langle N \\rangle_i P_i + K_H \\sum_{i=1}^{n} P_i^2 = 0$$\n解出 $K_H$，得到约束通过原点的直线的最佳拟合斜率表达式：\n$$K_H = \\frac{\\sum_{i=1}^{n} \\langle N \\rangle_i P_i}{\\sum_{i=1}^{n} P_i^2}$$\n所提供的数据包含 $n=3$ 个点：\n\\begin{itemize}\n    \\item $P_1 = 0.020$ bar, $\\langle N \\rangle_1 = 0.0041$\n    \\item $P_2 = 0.050$ bar, $\\langle N \\rangle_2 = 0.0102$\n    \\item $P_3 = 0.100$ bar, $\\langle N \\rangle_3 = 0.0201$\n\\end{itemize}\n现在我们计算分子和分母。\n\n分子是 $\\sum_{i=1}^{3} \\langle N \\rangle_i P_i$:\n$$ \\sum_{i=1}^{3} \\langle N \\rangle_i P_i = (0.0041)(0.020) + (0.0102)(0.050) + (0.0201)(0.100) $$\n$$ \\sum_{i=1}^{3} \\langle N \\rangle_i P_i = 0.000082 + 0.000510 + 0.002010 = 0.002602 $$\n此项的单位是 bar。\n\n分母是 $\\sum_{i=1}^{3} P_i^2$:\n$$ \\sum_{i=1}^{3} P_i^2 = (0.020)^2 + (0.050)^2 + (0.100)^2 $$\n$$ \\sum_{i=1}^{3} P_i^2 = 0.0004 + 0.0025 + 0.0100 = 0.0129 $$\n此项的单位是 bar$^2$。\n\n现在，我们计算 $K_H$:\n$$ K_H = \\frac{0.002602}{0.0129} \\approx 0.201705... $$\n$K_H$ 的单位是（无量纲吸附量）每 bar，即 bar$^{-1}$。根据问题要求，四舍五入到三位有效数字得：\n$$ K_H \\approx 0.202 $$\n\n任务2：$K_H$ 表达式的推导\n\n我们从巨正则系综（GCE）开始。晶胞中吸附质的巨正则配分函数 $\\Xi$ 由下式给出：\n$$ \\Xi = \\sum_{N=0}^{\\infty} \\frac{z^N}{N!} Q_N $$\n其中 $z = \\exp(\\mu/(k_B T))$ 是吸附质的绝对活度，$\\mu$ 是化学势，$k_B$ 是玻尔兹曼常数，$T$ 是绝对温度，$Q_N$ 是晶胞内 $N$ 个吸附质的正则配分函数。平均吸附分子数 $\\langle N \\rangle$ 从 $\\Xi$ 获得：\n$$ \\langle N \\rangle = z \\left( \\frac{\\partial \\ln \\Xi}{\\partial z} \\right)_{V,T} $$\n在低压（亨利）区，逸度以及因此的活度 $z$ 趋近于零。我们可以对小 $z$ 展开 $\\ln \\Xi$。配分函数 $\\Xi$ 为：\n$$ \\Xi = Q_0 + zQ_1 + \\frac{z^2}{2!} Q_2 + \\dots $$\n根据定义，$Q_0 = 1$（对于没有粒子的系统）。对于小 $z$，我们可以截断该级数：\n$$ \\Xi \\approx 1 + zQ_1 $$\n使用泰勒展开式 $\\ln(1+x) \\approx x$（对于小 $x$），我们有：\n$$ \\ln \\Xi \\approx zQ_1 $$\n将此式代入 $\\langle N \\rangle$ 的表达式中：\n$$ \\langle N \\rangle \\approx z \\frac{\\partial (zQ_1)}{\\partial z} = zQ_1 $$\n这是亨利定律的极限情况。对于单个吸附质（$N=1$），只考虑静态框架势 $U(\\mathbf{r})$ 内的平动自由度，其正则配分函数 $Q_1$ 为：\n$$ Q_1 = \\frac{1}{\\Lambda^3} \\int_{V_{uc}} \\exp\\left(-\\frac{U(\\mathbf{r})}{k_B T}\\right) d\\mathbf{r} $$\n此处，$\\Lambda = h/\\sqrt{2\\pi m k_B T}$ 是吸附质的热德布罗意波长（$m$ 为质量，$h$ 为普朗克常数），积分是单吸附质构型积分，我们称之为 $Z_1$，在晶胞体积 $V_{uc}$ 上进行。\n$$ Z_1 = \\int_{V_{uc}} \\exp\\left(-\\frac{U(\\mathbf{r})}{k_B T}\\right) d\\mathbf{r} $$\n因此，$Q_1 = Z_1 / \\Lambda^3$。\n\n接下来，我们必须将活度 $z$ 与体相气相的压力 $P$ 联系起来，体相气相被假定为理想气体。在平衡状态下，吸附相和气相的化学势相等。对于三维理想气体，其化学势由下式给出：\n$$ \\mu_{gas} = k_B T \\ln(\\rho_{gas} \\Lambda^3) = k_B T \\ln\\left(\\frac{P}{k_B T} \\Lambda^3\\right) $$\n其中 $\\rho_{gas} = N_{gas}/V_{gas} = P/(k_B T)$ 是气体的数密度。在此表达式中，为了与 $k_B$ (J/K) 和 $T$ (K) 的单位保持一致，压力 $P$ 必须使用绝对单位，即帕斯卡 (Pa)。我们记此压力为 $P_{Pa}$。\n绝对活度则为：\n$$ z = \\exp\\left(\\frac{\\mu_{gas}}{k_B T}\\right) = \\frac{P_{Pa} \\Lambda^3}{k_B T} $$\n将 $z$ 和 $Q_1$ 的表达式代入 $\\langle N \\rangle$ 的方程中：\n$$ \\langle N \\rangle = \\left( \\frac{P_{Pa} \\Lambda^3}{k_B T} \\right) \\left( \\frac{Z_1}{\\Lambda^3} \\right) = \\frac{P_{Pa} Z_1}{k_B T} $$\n问题通过关系式 $\\langle N \\rangle = K_H P$ 定义了亨利定律常数 $K_H$，其中 $P$ 是以 bar 为单位的压力。我们记此压力为 $P_{bar}$。帕斯卡和巴之间的压力转换关系是 $P_{Pa} = 10^5 P_{bar}$。\n将此转换代入我们推导的 $\\langle N \\rangle$ 方程中：\n$$ \\langle N \\rangle = \\frac{(10^5 P_{bar}) Z_1}{k_B T} $$\n根据定义，$K_H = \\langle N \\rangle / P_{bar}$。因此，我们可以写出：\n$$ K_H = \\frac{10^5 Z_1}{k_B T} $$\n这是亨利定律常数 $K_H$（单位为 bar$^{-1}$）用单吸附质构型积分 $Z_1$、温度 $T$ 和基本常数表示的表达式。写出完整的 $Z_1$：\n$$ K_H = \\frac{10^5}{k_B T} \\int_{V_{uc}} \\exp\\left(-\\frac{U(\\mathbf{r})}{k_B T}\\right) d\\mathbf{r} $$\n该表达式将实验测量的亨利常数与吸附质-框架系统的微观性质联系起来。", "answer": "$$ \\boxed{0.202} $$", "id": "2514644"}, {"introduction": "多孔骨架材料最具潜力的应用之一是气体分离，这涉及到多种气体组分的竞争吸附。理想吸附溶液理论 (IAST) 是一个强大的工具，它允许我们仅利用纯组分吸附数据来预测混合物在吸附剂上的行为。本练习模拟了一个核心的工程问题：通过编写代码实现IAST，计算在典型烟道气条件下，材料对二氧化碳相对于氮气的吸附选择性$S_{\\mathrm{IAST}}$，这是评估其分离性能的关键指标。[@problem_id:2514698]", "problem": "您正在模拟二氧化碳和氮气在多孔框架材料（如金属有机框架（MOF）或共价有机框架（COF））中的竞争性吸附。假设为理想气体混合物，并应用理想吸附溶液理论（IAST）从纯组分等温线计算二元混合物的平衡吸附相组成。每个纯组分的吸附等温线均遵循朗缪尔形式。您的任务是计算几组参数下二氧化碳相对于氮气的 IAST 选择性，并展示其对饱和吸附量和亲和参数的敏感性。\n\n使用的基本原理和假设：\n- 总压为 $P$、气相摩尔分数为 $y_{i}$ 的理想气体混合物。\n- 理想吸附溶液理论（IAST）：混合物中各组分的扩展压力 $\\pi$ 等于该组分在纯组分等温线上某个对应压力 $P_{i}^{0}$ 下所具有的扩展压力，并且类似拉乌尔定律的关系成立。\n- 组分 $i$ 的朗缪尔等温线：$q_{i}^{0}(p) = \\dfrac{q_{i,\\max} \\, b_{i} \\, p}{1 + b_{i} \\, p}$，其中 $q_{i,\\max}$ 是饱和吸附量，$b_{i}$ 是亲和常数。\n- IAST 中的扩展压力相等性要求对于每个组分 $i$ 都满足 $\\int_{0}^{P_{i}^{0}} \\dfrac{q_{i}^{0}(p)}{p} \\, dp = \\pi$。对于朗缪尔等温线，该积分是良定义的且可逆的。\n- 约束条件 $\\sum_{i} \\dfrac{y_{i} \\, P}{P_{i}^{0}(\\pi)} = 1$ 确定了 $\\pi$ 的值。\n- 一旦 $\\pi$ 被确定，吸附相摩尔分数为 $x_{i} = \\dfrac{y_{i} \\, P}{P_{i}^{0}(\\pi)}$，二氧化碳相对于氮气的理想吸附溶液理论（IAST）选择性为 $S_{\\mathrm{IAST}} = \\dfrac{\\left(x_{\\mathrm{CO_{2}}} / x_{\\mathrm{N_{2}}}\\right)}{\\left(y_{\\mathrm{CO_{2}}} / y_{\\mathrm{N_{2}}}\\right)}$。\n\n所有计算必须在总压 $P = 1$ bar 下进行。$b_{i}$ 的单位使用 $\\mathrm{bar}^{-1}$，$q_{i,\\max}$ 的单位使用 $\\mathrm{mmol}\\,\\mathrm{g}^{-1}$（只要两种物质使用一致的单位，单位将在选择性计算中抵消）。不涉及角度计算。程序必须为每个测试用例计算 $S_{\\mathrm{IAST}}$，并将结果报告为四舍五入到六位小数的十进制浮点数。\n\n测试套件（每个案例是一个元组 $(q_{\\mathrm{CO_{2}},\\max}, b_{\\mathrm{CO_{2}}}, q_{\\mathrm{N_{2}},\\max}, b_{\\mathrm{N_{2}}}, y_{\\mathrm{CO_{2}}}, P)$，其中 $P$ 的单位为 bar）：\n1. $P = 1$ bar 下的基准烟道气：$(q_{\\mathrm{CO_{2}},\\max}, b_{\\mathrm{CO_{2}}}, q_{\\mathrm{N_{2}},\\max}, b_{\\mathrm{N_{2}}}, y_{\\mathrm{CO_{2}}}, P) = (4.5, 2.0, 2.0, 0.05, 0.15, 1.0)$.\n2. 对称参数（预期 $S_{\\mathrm{IAST}} \\approx 1$）：$(q_{\\mathrm{CO_{2}},\\max}, b_{\\mathrm{CO_{2}}}, q_{\\mathrm{N_{2}},\\max}, b_{\\mathrm{N_{2}}}, y_{\\mathrm{CO_{2}}}, P) = (3.0, 0.5, 3.0, 0.5, 0.15, 1.0)$.\n3. 增加二氧化碳的亲和力（对 $b$ 的敏感性）：$(q_{\\mathrm{CO_{2}},\\max}, b_{\\mathrm{CO_{2}}}, q_{\\mathrm{N_{2}},\\max}, b_{\\mathrm{N_{2}}}, y_{\\mathrm{CO_{2}}}, P) = (4.5, 5.0, 2.0, 0.05, 0.15, 1.0)$.\n4. 增加二氧化碳的吸附容量（对 $q_{\\max}$ 的敏感性）：$(q_{\\mathrm{CO_{2}},\\max}, b_{\\mathrm{CO_{2}}}, q_{\\mathrm{N_{2}},\\max}, b_{\\mathrm{N_{2}}}, y_{\\mathrm{CO_{2}}}, P) = (9.0, 2.0, 2.0, 0.05, 0.15, 1.0)$.\n5. 低气相二氧化碳浓度和接近亨利区的工况：$(q_{\\mathrm{CO_{2}},\\max}, b_{\\mathrm{CO_{2}}}, q_{\\mathrm{N_{2}},\\max}, b_{\\mathrm{N_{2}}}, y_{\\mathrm{CO_{2}}}, P) = (4.5, 0.1, 2.0, 0.01, 0.05, 1.0)$.\n\n实现要求：\n- 仅使用上面列出的基本原理和假设。除了直接从朗缪尔等温线和 IAST 定义中推导出的公式外，不要调用任何吸附计算的简化公式。\n- 对每个测试用例，通过求解标量方程 $\\sum_{i \\in \\{\\mathrm{CO_{2}}, \\mathrm{N_{2}}\\}} \\dfrac{y_{i} \\, P}{P_{i}^{0}(\\pi)} = 1$ 来确定 $\\pi$。其中，$P_{i}^{0}(\\pi)$ 由组分 $i$ 的朗缪尔等温线的积分方程 $\\int_{0}^{P_{i}^{0}} \\dfrac{q_{i}^{0}(p)}{p} \\, dp = \\pi$ 隐式定义。\n- 计算 $x_{\\mathrm{CO_{2}}}$ 和 $x_{\\mathrm{N_{2}}}$，然后报告 $S_{\\mathrm{IAST}} = \\dfrac{\\left(x_{\\mathrm{CO_{2}}} / x_{\\mathrm{N_{2}}}\\right)}{\\left(y_{\\mathrm{CO_{2}}} / y_{\\mathrm{N_{2}}}\\right)}$。\n- 输出格式：您的程序应生成一行输出，其中包含一个用方括号括起来的逗号分隔列表，结果顺序与测试套件相同（例如，“[result1,result2,result3,result4,result5]”）。每个结果必须是四舍五入到六位小数的浮点数。", "solution": "问题陈述经过严格验证。\n\n### 步骤 1：提取已知条件\n\n该问题为模拟二元气体混合物（$i \\in \\{ \\mathrm{CO}_{2}, \\mathrm{N}_{2} \\}$）在多孔材料中的竞争性吸附提供了以下数据、定义和约束：\n\n*   **体系**：总压为 $P$、气相摩尔分数为 $y_{i}$ 的二元理想气体混合物。\n*   **理论**：理想吸附溶液理论（IAST）。\n*   **纯组分等温线模型**：组分 $i$ 的朗缪尔等温线：\n    $$q_{i}^{0}(p) = \\dfrac{q_{i,\\max} \\, b_{i} \\, p}{1 + b_{i} \\, p}$$\n    其中 $q_{i,\\max}$ 是饱和吸附量，$b_{i}$ 是亲和常数。\n*   **扩展压力定义**：扩展压力 $\\pi$ 通过积分方程与纯组分压力 $P_{i}^{0}$ 相关联：\n    $$\\int_{0}^{P_{i}^{0}} \\dfrac{q_{i}^{0}(p)}{p} \\, dp = \\pi$$\n*   **IAST 核心方程**：混合物的总扩展压力 $\\pi$ 由以下约束条件确定：\n    $$\\sum_{i} \\dfrac{y_{i} \\, P}{P_{i}^{0}(\\pi)} = 1$$\n*   **吸附相组成**：组分 $i$ 的吸附相摩尔分数由下式给出：\n    $$x_{i} = \\dfrac{y_{i} \\, P}{P_{i}^{0}(\\pi)}$$\n*   **选择性定义**：$\\mathrm{CO}_2$ 相对于 $\\mathrm{N}_2$ 的 IAST 选择性为：\n    $$S_{\\mathrm{IAST}} = \\dfrac{\\left(x_{\\mathrm{CO_{2}}} / x_{\\mathrm{N_{2}}}\\right)}{\\left(y_{\\mathrm{CO_{2}}} / y_{\\mathrm{N_{2}}}\\right)}$$\n*   **全局条件**：总压 $P = 1 \\, \\mathrm{bar}$。$b_{i}$ 的单位为 $\\mathrm{bar}^{-1}$，$q_{i,\\max}$ 的单位为 $\\mathrm{mmol}\\,\\mathrm{g}^{-1}$。\n*   **测试用例**：\n    1.  $(q_{\\mathrm{CO_{2}},\\max}, b_{\\mathrm{CO_{2}}}, q_{\\mathrm{N_{2}},\\max}, b_{\\mathrm{N_{2}}}, y_{\\mathrm{CO_{2}}}, P) = (4.5, 2.0, 2.0, 0.05, 0.15, 1.0)$\n    2.  $(q_{\\mathrm{CO_{2}},\\max}, b_{\\mathrm{CO_{2}}}, q_{\\mathrm{N_{2}},\\max}, b_{\\mathrm{N_{2}}}, y_{\\mathrm{CO_{2}}}, P) = (3.0, 0.5, 3.0, 0.5, 0.15, 1.0)$\n    3.  $(q_{\\mathrm{CO_{2}},\\max}, b_{\\mathrm{CO_{2}}}, q_{\\mathrm{N_{2}},\\max}, b_{\\mathrm{N_{2}}}, y_{\\mathrm{CO_{2}}}, P) = (4.5, 5.0, 2.0, 0.05, 0.15, 1.0)$\n    4.  $(q_{\\mathrm{CO_{2}},\\max}, b_{\\mathrm{CO_{2}}}, q_{\\mathrm{N_{2}},\\max}, b_{\\mathrm{N_{2}}}, y_{\\mathrm{CO_{2}}}, P) = (9.0, 2.0, 2.0, 0.05, 0.15, 1.0)$\n    5.  $(q_{\\mathrm{CO_{2}},\\max}, b_{\\mathrm{CO_{2}}}, q_{\\mathrm{N_{2}},\\max}, b_{\\mathrm{N_{2}}}, y_{\\mathrm{CO_{2}}}, P) = (4.5, 0.1, 2.0, 0.01, 0.05, 1.0)$\n\n### 步骤 2：使用提取的已知条件进行验证\n\n根据验证标准对问题进行评估。\n\n*   **科学依据**：该问题基于朗缪尔等温线和理想吸附溶液理论，这些是材料化学和化学工程中用于描述吸附现象的标准、成熟模型。该框架具有科学合理性，不含伪科学。\n*   **适定性**：该问题提供了一整套方程和参数，为获得唯一解定义了清晰的路径。核心任务是求解一个单变量的非线性方程，这是一个适定的数值问题。\n*   **客观性**：该问题使用精确的数学语言和定量数据进行表述，没有主观或含糊不清的陈述。\n*   **完整性和一致性**：提供了所有必要信息。对于二元混合物，第二组分 $\\mathrm{N}_{2}$ 的摩尔分数 $y_{\\mathrm{N_{2}}}$ 由 $y_{\\mathrm{N_{2}}} = 1 - y_{\\mathrm{CO_{2}}}$ 明确确定。问题是自洽且内部一致的。\n*   **现实性**：等温线参数和气相组成在物理上是合理的，代表了使用 MOF 和 COF 等多孔材料研究气体分离（例如烟道气）的典型条件。\n\n### 步骤 3：结论与行动\n\n问题是**有效的**。它有科学依据，具有适定性，并且是完整的。将推导一个严谨的解。\n\n### 解答推导\n\n求解过程需要逐步应用所提供的理论框架。组分指定为 $1$ 代表 $\\mathrm{CO_{2}}$，$2$ 代表 $\\mathrm{N_{2}}$。\n\n**1. 对扩展压力方程进行解析积分**\n\n首先，必须对朗缪尔等温线的扩展压力 $\\pi$ 的积分进行解析求解。\n给定的积分为：\n$$\\pi = \\int_{0}^{P_{i}^{0}} \\dfrac{q_{i}^{0}(p)}{p} \\, dp$$\n代入朗缪尔表达式 $q_{i}^{0}(p) = \\dfrac{q_{i,\\max} \\, b_{i} \\, p}{1 + b_{i} \\, p}$：\n$$\\pi = \\int_{0}^{P_{i}^{0}} \\dfrac{1}{p} \\left( \\dfrac{q_{i,\\max} \\, b_{i} \\, p}{1 + b_{i} \\, p} \\right) dp = q_{i,\\max} b_{i} \\int_{0}^{P_{i}^{0}} \\dfrac{1}{1 + b_{i} \\, p} \\, dp$$\n这个标准积分的计算很简单：\n$$\\pi = q_{i,\\max} b_{i} \\left[ \\dfrac{1}{b_{i}} \\ln(1 + b_{i} p) \\right]_{0}^{P_{i}^{0}} = q_{i,\\max} \\left( \\ln(1 + b_{i} P_{i}^{0}) - \\ln(1 + 0) \\right)$$\n这得到了 $\\pi$ 和 $P_{i}^{0}$ 之间的直接关系：\n$$\\pi = q_{i,\\max} \\ln(1 + b_{i} P_{i}^{0})$$\n\n**2. 对扩展压力关系式进行求逆**\n\n为使用 IAST 核心方程，我们必须将虚拟纯组分压力 $P_{i}^{0}$ 表示为扩展压力 $\\pi$ 的函数。这需要对上面推导出的方程进行求逆。\n$$\\dfrac{\\pi}{q_{i,\\max}} = \\ln(1 + b_{i} P_{i}^{0})$$\n对两边取指数：\n$$\\exp\\left(\\dfrac{\\pi}{q_{i,\\max}}\\right) = 1 + b_{i} P_{i}^{0}$$\n求解 $P_{i}^{0}$：\n$$P_{i}^{0}(\\pi) = \\dfrac{1}{b_{i}} \\left[ \\exp\\left(\\dfrac{\\pi}{q_{i,\\max}}\\right) - 1 \\right]$$\n这就是所需的函数 $P_{i}^{0}(\\pi)$。\n\n**3. 构建用于数值求解的方程**\n\n必须求解 IAST 约束条件 $\\sum_{i} \\frac{y_{i} P}{P_{i}^{0}(\\pi)} = 1$ 以得到 $\\pi$。对于 $\\mathrm{CO_{2}}$（组分 1）和 $\\mathrm{N_{2}}$（组分 2）的二元混合物：\n$$\\dfrac{y_{1} P}{P_{1}^{0}(\\pi)} + \\dfrac{y_{2} P}{P_{2}^{0}(\\pi)} = 1$$\n代入 $P_{i}^{0}(\\pi)$ 的表达式：\n$$\\dfrac{y_{1} P}{\\dfrac{1}{b_{1}} \\left[ \\exp\\left(\\dfrac{\\pi}{q_{1,\\max}}\\right) - 1 \\right]} + \\dfrac{y_{2} P}{\\dfrac{1}{b_{2}} \\left[ \\exp\\left(\\dfrac{\\pi}{q_{2,\\max}}\\right) - 1 \\right]} = 1$$\n这是一个关于变量 $\\pi$ 的非线性标量方程。可以通过求函数 $f(\\pi)$ 的根来进行数值求解：\n$$f(\\pi) = \\dfrac{y_{1} P b_{1}}{\\exp\\left(\\dfrac{\\pi}{q_{1,\\max}}\\right) - 1} + \\dfrac{y_{2} P b_{2}}{\\exp\\left(\\dfrac{\\pi}{q_{2,\\max}}\\right) - 1} - 1 = 0$$\n对于 $\\pi > 0$，此函数是单调且良态的。当 $\\pi \\to 0^{+}$ 时，$f(\\pi) \\to +\\infty$；当 $\\pi \\to \\infty$ 时，$f(\\pi) \\to -1$。这保证了存在唯一的正根，可以使用标准的数值求根算法（如 Brent-Dekker 方法）找到该根。\n\n**4. 计算 IAST 选择性**\n\n一旦确定了唯一的根 $\\pi$，就可以计算 IAST 选择性 $S_{\\mathrm{IAST}}$。其定义为：\n$$S_{\\mathrm{IAST}} = \\dfrac{x_{1} / x_{2}}{y_{1} / y_{2}}$$\n使用 IAST 关系式 $x_{i} = \\frac{y_{i} P}{P_{i}^{0}(\\pi)}$：\n$$S_{\\mathrm{IAST}} = \\dfrac{\\left(\\dfrac{y_{1} P}{P_{1}^{0}(\\pi)}\\right) / \\left(\\dfrac{y_{2} P}{P_{2}^{0}(\\pi)}\\right)}{y_{1} / y_{2}} = \\dfrac{y_{1} P_{2}^{0}(\\pi)}{y_{2} P_{1}^{0}(\\pi)} \\cdot \\dfrac{y_{2}}{y_{1}}$$\n这可以简化为虚拟纯组分压力的比值：\n$$S_{\\mathrm{IAST}} = \\dfrac{P_{2}^{0}(\\pi)}{P_{1}^{0}(\\pi)}$$\n代入 $P_{i}^{0}(\\pi)$ 的逆表达式：\n$$S_{\\mathrm{IAST}} = \\dfrac{\\dfrac{1}{b_{2}} \\left[ \\exp\\left(\\dfrac{\\pi}{q_{2,\\max}}\\right) - 1 \\right]}{\\dfrac{1}{b_{1}} \\left[ \\exp\\left(\\dfrac{\\pi}{q_{1,\\max}}\\right) - 1 \\right]} = \\dfrac{b_{1}}{b_{2}} \\dfrac{\\exp\\left(\\dfrac{\\pi}{q_{2,\\max}}\\right) - 1}{\\exp\\left(\\dfrac{\\pi}{q_{1,\\max}}\\right) - 1}$$\n在确定 $\\pi$ 后，将使用这个最终表达式进行计算。\n\n计算步骤如下：\n对每个测试用例：\n1.  定义参数：$\\mathrm{CO_{2}}$ 的 $q_{1,\\max}$、$b_{1}$、$y_{1}$ 和 $\\mathrm{N_{2}}$ 的 $q_{2,\\max}$、$b_{2}$。压力 $P=1$ 且 $y_{2} = 1 - y_{1}$。\n2.  使用求根算法，在合适的区间（如 $[10^{-9}, 1000]$）内数值求解方程 $f(\\pi) = 0$ 以得到 $\\pi$。\n3.  使用最终推导的公式计算 $S_{\\mathrm{IAST}}$。\n4.  按要求将结果四舍五入到六位小数。\n此过程将针对所有提供的测试用例实施。", "answer": "```python\nimport numpy as np\nfrom scipy.optimize import brentq\n\ndef solve():\n    \"\"\"\n    Computes the IAST selectivity for a binary mixture of CO2 and N2\n    following Langmuir isotherms.\n    \"\"\"\n\n    # Test suite: (q_co2_max, b_co2, q_n2_max, b_n2, y_co2, P)\n    # q_max in mmol/g, b in 1/bar, y is mole fraction, P in bar.\n    test_cases = [\n        # 1. Baseline flue gas\n        (4.5, 2.0, 2.0, 0.05, 0.15, 1.0),\n        # 2. Symmetric parameters\n        (3.0, 0.5, 3.0, 0.5, 0.15, 1.0),\n        # 3. Increased affinity for CO2\n        (4.5, 5.0, 2.0, 0.05, 0.15, 1.0),\n        # 4. Increased capacity for CO2\n        (9.0, 2.0, 2.0, 0.05, 0.15, 1.0),\n        # 5. Low gas-phase CO2 and near-Henry regime\n        (4.5, 0.1, 2.0, 0.01, 0.05, 1.0),\n    ]\n\n    results = []\n\n    for case in test_cases:\n        q_co2_max, b_co2, q_n2_max, b_n2, y_co2, P = case\n        y_n2 = 1.0 - y_co2\n\n        # Define the function f(pi) whose root needs to be found.\n        # f(pi) = (y_co2 * P / P0_co2(pi)) + (y_n2 * P / P0_n2(pi)) - 1 = 0\n        # where P0_i(pi) = (1/b_i) * [exp(pi / q_i_max) - 1]\n        def iast_root_function(pi):\n            # To avoid potential overflow or math domain errors for pi <= 0\n            if pi <= 0:\n                return np.inf\n            \n            # exp(pi / q_max) can be very large. Check term by term.\n            term1_denom = np.exp(pi / q_co2_max) - 1.0\n            term2_denom = np.exp(pi / q_n2_max) - 1.0\n\n            # Guard against division by zero if a denominator is zero,\n            # which happens only if pi is zero, handled above.\n            term1 = (y_co2 * P * b_co2) / term1_denom\n            term2 = (y_n2 * P * b_n2) / term2_denom\n            \n            return term1 + term2 - 1.0\n\n        # Find the spreading pressure (pi) by solving iast_root_function(pi) = 0.\n        # The function f(pi) -> +inf as pi -> 0+ and f(pi) -> -1 as pi -> +inf.\n        # A root is guaranteed to exist in a bracket like [1e-9, 1000].\n        try:\n            pi_solution = brentq(iast_root_function, 1e-9, 1000.0)\n        except ValueError:\n            # Handle cases where the bracket might not be valid, though unlikely.\n            results.append(np.nan)\n            continue\n\n        # Calculate IAST selectivity: S = (x_co2/y_co2) / (x_n2/y_n2) = P0_n2/P0_co2\n        # S = (b_co2/b_n2) * (exp(pi/q_n2_max) - 1) / (exp(pi/q_co2_max) - 1)\n        \n        # Numerator part of selectivity calculation\n        num = (np.exp(pi_solution / q_n2_max) - 1.0)\n        \n        # Denominator part of selectivity calculation\n        den = (np.exp(pi_solution / q_co2_max) - 1.0)\n        \n        # Avoid division by zero if den is zero\n        if den == 0:\n            selectivity = np.inf\n        else:\n            selectivity = (b_co2 / b_n2) * (num / den)\n\n        results.append(round(selectivity, 6))\n\n    # Format the final output as a comma-separated list in brackets.\n    output_str = f\"[{','.join(map(str, results))}]\"\n    print(output_str)\n\nsolve()\n```", "id": "2514698"}]}