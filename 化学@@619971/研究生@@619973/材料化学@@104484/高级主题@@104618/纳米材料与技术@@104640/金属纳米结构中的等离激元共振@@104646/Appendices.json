{"hands_on_practices": [{"introduction": "实践是检验理论的最好方式。本节的第一个练习将引导你运用 Drude 模型和静电近似，建立对局域表面等离激元共振（LSPR）核心特性的直观、解析的理解。通过推导，你将亲身体会材料的微观属性，特别是电子阻尼，如何直接影响 LSPR 的两个关键可观测量：光谱峰位和线宽。这个练习旨在连接微观材料参数与宏观光学响应，为你分析和设计等离激元纳米结构打下坚实基础。[@problem_id:2511414]", "problem": "一个半径为 $a$ 的球形金纳米粒子嵌入在相对介电常数为 $\\varepsilon_{m}$ 的均匀、无色散的电介质中。假设该粒子的尺寸远小于其局域表面等离激元共振 (LSPR) 处的自由空间波长，因此静电近似适用。该金属的随频率变化的复介电函数由 Drude 模型描述\n$$\n\\varepsilon(\\omega)=\\varepsilon_{\\infty}-\\frac{\\omega_{p}^{2}}{\\omega^{2}+i\\gamma\\,\\omega},\n$$\n其中 $\\varepsilon_{\\infty}$ 是高频介电常数，$\\omega_{p}$ 是体等离激元频率，$\\gamma$ 是唯象电子散射（阻尼）率。一个小球的静电极化率为\n$$\n\\alpha(\\omega)=4\\pi a^{3}\\,\\frac{\\varepsilon(\\omega)-\\varepsilon_{m}}{\\varepsilon(\\omega)+2\\varepsilon_{m}}.\n$$\n忽略带间跃迁和辐射阻尼。\n\n1) 从以上公式出发，证明有限阻尼 $\\,\\gamma\\,$ 如何同时使 LSPR 发生红移并加宽其线宽。特别地，通过使用使吸收最大化的共振条件，推导 LSPR 角频率 $\\,\\omega_{\\mathrm{res}}\\,$ 关于 $\\,\\varepsilon_{\\infty}$、$\\,\\omega_{p}$、$\\,\\varepsilon_{m}$ 和 $\\,\\gamma\\,$ 的显式表达式，并求出在小 $\\gamma$ 情况下，吸收线型 $\\,\\operatorname{Im}\\alpha(\\omega)\\,$ 的半高半宽 $\\,\\Gamma_{\\mathrm{eff}}\\,$ 的表达式。\n\n2) 对于一个阻尼振子，品质因子在此定义为 $\\,Q=\\omega_{0}/(2\\Gamma)\\,$。将此定义应用于你在第 (1) 部分中分析的 LSPR，并在小 $\\gamma$ 极限下，用 $\\,\\omega_{\\mathrm{res}}\\,$ 和 $\\,\\gamma\\,$ 表示 $Q$。\n\n3) 使用参数 $\\,\\omega_{p}=1.37\\times 10^{16}\\,\\mathrm{s}^{-1}$，$\\,\\varepsilon_{\\infty}=9.5$ 和 $\\,\\varepsilon_{m}=2.25\\,$（对应于折射率 $n=\\sqrt{\\varepsilon_{m}}=1.5$），计算当阻尼率从 $\\,\\gamma_{1}=0.90\\times 10^{14}\\,\\mathrm{s}^{-1}\\,$ 增加到 $\\,\\gamma_{2}=1.50\\times 10^{14}\\,\\mathrm{s}^{-1}\\,$ 时，品质因子之比 $\\,Q_{2}/Q_{1}\\,$。使用你在第 (1)–(2) 部分得到的表达式，并保留由 $\\,\\omega_{\\mathrm{res}}\\,$ 中依赖于 $\\,\\gamma\\,$ 的领头修正项。将你的最终答案四舍五入到四位有效数字。以无量纲的小数形式表示你的最终答案（无单位）。", "solution": "首先将验证问题陈述的科学合理性、自洽性和清晰度。\n\n逐字提取给定条件：\n- 一个半径为 $a$ 的球形金纳米粒子。\n- 周围介质的相对介电常数为 $\\varepsilon_{m}$。\n- 条件 $a \\ll \\lambda_{\\mathrm{LSPR}}$，为静电近似提供了依据。\n- 金属的复介电函数的 Drude 模型：$\\varepsilon(\\omega)=\\varepsilon_{\\infty}-\\frac{\\omega_{p}^{2}}{\\omega^{2}+i\\gamma\\,\\omega}$。\n- 球体的静电极化率：$\\alpha(\\omega)=4\\pi a^{3}\\,\\frac{\\varepsilon(\\omega)-\\varepsilon_{m}}{\\varepsilon(\\omega)+2\\varepsilon_{m}}$。\n- 忽略带间跃迁和辐射阻尼。\n- 共振条件定义为吸收的最大化。\n- 品质因子定义为 $Q=\\omega_{0}/(2\\Gamma)$，其中 $\\omega_0$ 是共振频率，$\\Gamma$ 是半高半宽。\n- 用于计算的数值：$\\omega_{p}=1.37\\times 10^{16}\\,\\mathrm{s}^{-1}$，$\\varepsilon_{\\infty}=9.5$，$\\varepsilon_{m}=2.25$，$\\gamma_{1}=0.90\\times 10^{14}\\,\\mathrm{s}^{-1}$ 和 $\\gamma_{2}=1.50\\times 10^{14}\\,\\mathrm{s}^{-1}$。\n\n验证：\n该问题具有科学依据，利用了标准的 Drude 模型和准静态近似（适用于小球的 Mie 理论），这些都是等离激元光学研究的基石。问题提法严谨，提供了所有必要的信息和定义，可以逻辑地推导出所要求的量并进行最终计算。语言客观而精确。所提供的数值对于置于典型电介质基质（如二氧化硅或聚合物）中的金纳米粒子是符合物理实际的。这个问题并非无足轻重，因为它要求对共振现象、近似方法有正确的理解，并进行仔细的代数处理，特别是在最终计算中保留依赖于 $\\gamma$ 的修正项。因此，该问题被认为是有效的。\n\n我们现在开始求解。\n\n极化率由 $\\alpha(\\omega)=4\\pi a^{3}\\,\\frac{\\varepsilon(\\omega)-\\varepsilon_{m}}{\\varepsilon(\\omega)+2\\varepsilon_{m}}$ 给出。吸收截面与 $\\omega \\operatorname{Im}[\\alpha(\\omega)]$ 成正比。问题要求通过最大化 $\\operatorname{Im}[\\alpha(\\omega)]$ 的吸收线型来找到共振。我们首先求出 $\\operatorname{Im}[\\alpha(\\omega)]$ 的表达式。\n令复介电函数为 $\\varepsilon(\\omega) = \\varepsilon'(\\omega) + i\\varepsilon''(\\omega)$。将其代入极化率表达式：\n$$ \\alpha(\\omega) = 4\\pi a^{3} \\frac{(\\varepsilon'(\\omega)-\\varepsilon_{m}) + i\\varepsilon''(\\omega)}{(\\varepsilon'(\\omega)+2\\varepsilon_{m}) + i\\varepsilon''(\\omega)} $$\n通过将分子和分母乘以分母的复共轭来求虚部：\n$$ \\operatorname{Im}[\\alpha(\\omega)] = 4\\pi a^{3} \\operatorname{Im}\\left[ \\frac{\\left( (\\varepsilon'-\\varepsilon_{m}) + i\\varepsilon'' \\right) \\left( (\\varepsilon'+2\\varepsilon_{m}) - i\\varepsilon'' \\right)}{\\left( \\varepsilon'+2\\varepsilon_{m} \\right)^2 + (\\varepsilon'')^2} \\right] $$\n$$ \\operatorname{Im}[\\alpha(\\omega)] = 4\\pi a^{3} \\frac{\\varepsilon''(\\varepsilon'+2\\varepsilon_{m}) - (-\\varepsilon'')(\\varepsilon'-\\varepsilon_{m})}{(\\varepsilon'(\\omega)+2\\varepsilon_{m})^2 + (\\varepsilon''(\\omega))^2} = 4\\pi a^{3} \\frac{3\\varepsilon_{m}\\varepsilon''(\\omega)}{(\\varepsilon'(\\omega)+2\\varepsilon_{m})^2 + (\\varepsilon''(\\omega))^2} $$\n局域表面等离激元共振 (LSPR) 的特点是局域场的强烈增强，这发生在极化率的分母趋近于零时。具体来说，共振频率 $\\omega_{\\mathrm{res}}$ 由使 $(\\varepsilon'(\\omega)+2\\varepsilon_{m})^2$ 项最小化的条件决定。这对应于 Fröhlich 条件，即 $\\varepsilon'(\\omega_{\\mathrm{res}})+2\\varepsilon_{m} = 0$。对于小阻尼 $\\gamma$，该条件能准确地近似吸收峰值。\n\n1) $\\omega_{\\mathrm{res}}$ 和 $\\Gamma_{\\mathrm{eff}}$ 的推导：\n根据 Drude 模型，介电函数的实部为 $\\varepsilon'(\\omega) = \\varepsilon_{\\infty} - \\frac{\\omega_{p}^{2}}{\\omega^{2}+\\gamma^{2}}$。\n应用共振条件 $\\varepsilon'(\\omega_{\\mathrm{res}})+2\\varepsilon_{m} = 0$：\n$$ \\varepsilon_{\\infty} - \\frac{\\omega_{p}^{2}}{\\omega_{\\mathrm{res}}^{2}+\\gamma^{2}} + 2\\varepsilon_{m} = 0 $$\n$$ \\frac{\\omega_{p}^{2}}{\\omega_{\\mathrm{res}}^{2}+\\gamma^{2}} = \\varepsilon_{\\infty} + 2\\varepsilon_{m} $$\n$$ \\omega_{\\mathrm{res}}^{2}+\\gamma^{2} = \\frac{\\omega_{p}^{2}}{\\varepsilon_{\\infty} + 2\\varepsilon_{m}} $$\n解出 $\\omega_{\\mathrm{res}}$，我们得到：\n$$ \\omega_{\\mathrm{res}} = \\sqrt{\\frac{\\omega_{p}^{2}}{\\varepsilon_{\\infty} + 2\\varepsilon_{m}} - \\gamma^{2}} $$\n该表达式表明，随着阻尼 $\\gamma$ 从 0 增加，共振频率 $\\omega_{\\mathrm{res}}$ 减小。这就是红移现象。\n\n为了求出线宽，我们在小 $\\gamma$ 的假设下分析共振点附近的线型 $\\operatorname{Im}[\\alpha(\\omega)]$。令 $\\omega_0^2 = \\frac{\\omega_p^2}{\\varepsilon_{\\infty}+2\\varepsilon_m}$ 为 $\\gamma=0$ 时的共振频率。对于 $\\omega \\approx \\omega_{\\mathrm{res}} \\approx \\omega_0$，我们可以对 $\\operatorname{Im}[\\alpha(\\omega)]$ 表达式中的各项进行近似。\n我们在 $\\omega_{\\mathrm{res}}$ 附近对 $\\varepsilon'(\\omega)+2\\varepsilon_m$ 进行泰勒展开：\n$$ \\varepsilon'(\\omega)+2\\varepsilon_m \\approx (\\omega-\\omega_{\\mathrm{res}}) \\left. \\frac{d\\varepsilon'}{d\\omega} \\right|_{\\omega_{\\mathrm{res}}} $$\n$$ \\frac{d\\varepsilon'}{d\\omega} = \\frac{2\\omega\\omega_p^2}{(\\omega^2+\\gamma^2)^2} \\approx \\frac{2\\omega_{\\mathrm{res}}(\\varepsilon_{\\infty}+2\\varepsilon_m)^2}{\\omega_p^2} \\approx \\frac{2\\omega_0(\\varepsilon_{\\infty}+2\\varepsilon_m)}{\\omega_0^2} = \\frac{2(\\varepsilon_{\\infty}+2\\varepsilon_m)}{\\omega_0} $$\n在共振点附近，虚部 $\\varepsilon''(\\omega) = \\frac{\\omega_p^2\\gamma}{\\omega(\\omega^2+\\gamma^2)}$ 近似为常数：\n$$ \\varepsilon''(\\omega_{\\mathrm{res}}) = \\frac{\\omega_p^2\\gamma}{\\omega_{\\mathrm{res}}(\\omega_{\\mathrm{res}}^2+\\gamma^2)} = \\frac{\\omega_p^2\\gamma}{\\omega_{\\mathrm{res}}\\left(\\frac{\\omega_p^2}{\\varepsilon_{\\infty}+2\\varepsilon_m}\\right)} = \\frac{\\gamma(\\varepsilon_{\\infty}+2\\varepsilon_m)}{\\omega_{\\mathrm{res}}} \\approx \\frac{\\gamma(\\varepsilon_{\\infty}+2\\varepsilon_m)}{\\omega_0} $$\n将这些近似代入 $\\operatorname{Im}[\\alpha(\\omega)]$ 的表达式中：\n$$ \\operatorname{Im}[\\alpha(\\omega)] \\propto \\frac{\\varepsilon''(\\omega_{\\mathrm{res}})}{\\left( (\\omega-\\omega_{\\mathrm{res}})\\frac{2(\\varepsilon_{\\infty}+2\\varepsilon_m)}{\\omega_0} \\right)^2 + (\\varepsilon''(\\omega_{\\mathrm{res}}))^2} \\propto \\frac{1}{(\\omega-\\omega_{\\mathrm{res}})^2 + (\\frac{\\gamma}{2})^2} $$\n这是一个以 $\\omega_{\\mathrm{res}}$ 为中心的洛伦兹线型。半高半宽 (HWHM) 记为 $\\Gamma_{\\mathrm{eff}}$，是函数值下降到其最大值一半时 $|\\omega-\\omega_{\\mathrm{res}}|$ 的值。从分母可以看出，这发生在 $(\\omega-\\omega_{\\mathrm{res}})^2 = (\\gamma/2)^2$ 时。因此，HWHM 为：\n$$ \\Gamma_{\\mathrm{eff}} = \\frac{\\gamma}{2} $$\n共振峰的半峰全宽 (FWHM) 为 $2\\Gamma_{\\mathrm{eff}} = \\gamma$。这直接表明线宽随着 $\\gamma$ 的增加而变宽。\n\n2) 品质因子 $Q$：\n问题将品质因子定义为 $Q = \\omega_0 / (2\\Gamma)$，其中 $\\omega_0$ 是共振频率，$\\Gamma$ 是 HWHM。我们将此定义应用于我们的 LSPR 系统。共振频率是 $\\omega_{\\mathrm{res}}$，HWHM 是 $\\Gamma_{\\mathrm{eff}} = \\gamma/2$。\n$$ Q = \\frac{\\omega_{\\mathrm{res}}}{2\\Gamma_{\\mathrm{eff}}} = \\frac{\\omega_{\\mathrm{res}}}{2(\\gamma/2)} = \\frac{\\omega_{\\mathrm{res}}}{\\gamma} $$\n这是小 $\\gamma$ 极限下品质因子的表达式，在此极限下洛伦兹近似是有效的。\n\n3) $Q_2/Q_1$ 的数值计算：\n我们需要使用 $\\omega_{\\mathrm{res}}$ 的完整表达式，以保留由 $\\gamma$ 引起的领头修正项。\n对于给定的阻尼 $\\gamma_i$，品质因子为 $Q_i = \\frac{\\omega_{\\mathrm{res},i}}{\\gamma_i}$。\n$$ Q_i = \\frac{1}{\\gamma_i} \\sqrt{\\frac{\\omega_p^2}{\\varepsilon_{\\infty} + 2\\varepsilon_m} - \\gamma_i^2} $$\n我们需要计算比率 $Q_2/Q_1$：\n$$ \\frac{Q_2}{Q_1} = \\frac{\\frac{1}{\\gamma_2} \\sqrt{\\frac{\\omega_p^2}{\\varepsilon_{\\infty} + 2\\varepsilon_m} - \\gamma_2^2}}{\\frac{1}{\\gamma_1} \\sqrt{\\frac{\\omega_p^2}{\\varepsilon_{\\infty} + 2\\varepsilon_m} - \\gamma_1^2}} = \\frac{\\gamma_1}{\\gamma_2} \\sqrt{\\frac{\\frac{\\omega_p^2}{\\varepsilon_{\\infty} + 2\\varepsilon_m} - \\gamma_2^2}{\\frac{\\omega_p^2}{\\varepsilon_{\\infty} + 2\\varepsilon_m} - \\gamma_1^2}} $$\n我们将无阻尼共振频率的平方定义为 $\\omega_0^2 = \\frac{\\omega_p^2}{\\varepsilon_{\\infty} + 2\\varepsilon_m}$。该比率变为：\n$$ \\frac{Q_2}{Q_1} = \\frac{\\gamma_1}{\\gamma_2} \\sqrt{\\frac{\\omega_0^2 - \\gamma_2^2}{\\omega_0^2 - \\gamma_1^2}} $$\n现在，我们代入给定的数值：\n$\\omega_{p}=1.37\\times 10^{16}\\,\\mathrm{s}^{-1}$\n$\\varepsilon_{\\infty}=9.5$\n$\\varepsilon_{m}=2.25$\n$\\gamma_{1}=0.90\\times 10^{14}\\,\\mathrm{s}^{-1}$\n$\\gamma_{2}=1.50\\times 10^{14}\\,\\mathrm{s}^{-1}$\n\n首先，计算 $\\omega_0^2$：\n$$ \\varepsilon_{\\infty} + 2\\varepsilon_{m} = 9.5 + 2(2.25) = 9.5 + 4.5 = 14.0 $$\n$$ \\omega_0^2 = \\frac{(1.37 \\times 10^{16}\\,\\mathrm{s}^{-1})^2}{14.0} = \\frac{1.8769 \\times 10^{32}\\,\\mathrm{s}^{-2}}{14.0} \\approx 1.34064 \\times 10^{31}\\,\\mathrm{s}^{-2} $$\n接下来，计算 $\\gamma_1^2$ 和 $\\gamma_2^2$：\n$$ \\gamma_1^2 = (0.90 \\times 10^{14}\\,\\mathrm{s}^{-1})^2 = 0.81 \\times 10^{28}\\,\\mathrm{s}^{-2} = 0.00081 \\times 10^{31}\\,\\mathrm{s}^{-2} $$\n$$ \\gamma_2^2 = (1.50 \\times 10^{14}\\,\\mathrm{s}^{-1})^2 = 2.25 \\times 10^{28}\\,\\mathrm{s}^{-2} = 0.00225 \\times 10^{31}\\,\\mathrm{s}^{-2} $$\n现在，计算平方根内的项：\n$$ \\omega_0^2 - \\gamma_1^2 \\approx (1.34064 - 0.00081) \\times 10^{31}\\,\\mathrm{s}^{-2} = 1.33983 \\times 10^{31}\\,\\mathrm{s}^{-2} $$\n$$ \\omega_0^2 - \\gamma_2^2 \\approx (1.34064 - 0.00225) \\times 10^{31}\\,\\mathrm{s}^{-2} = 1.33839 \\times 10^{31}\\,\\mathrm{s}^{-2} $$\n平方根内的比率是：\n$$ \\frac{\\omega_0^2 - \\gamma_2^2}{\\omega_0^2 - \\gamma_1^2} \\approx \\frac{1.33839 \\times 10^{31}}{1.33983 \\times 10^{31}} \\approx 0.998925 $$\n这个值的平方根是：\n$$ \\sqrt{0.998925} \\approx 0.999462 $$\n前置因子是：\n$$ \\frac{\\gamma_1}{\\gamma_2} = \\frac{0.90 \\times 10^{14}}{1.50 \\times 10^{14}} = 0.6 $$\n最后，品质因子的比率是：\n$$ \\frac{Q_2}{Q_1} \\approx 0.6 \\times 0.999462 \\approx 0.599677 $$\n四舍五入到四位有效数字，我们得到 $0.5997$。", "answer": "$$\n\\boxed{0.5997}\n$$", "id": "2511414"}, {"introduction": "在上一个练习的基础上，我们对阻尼的概念有了初步认识。现在，这个练习将挑战你像一位实验科学家一样思考。你的任务是设计一个巧妙的实验方案，以便从多种复杂的阻尼机制（如尺寸效应和电介质环境变化）中，精确地分离出由化学吸附引起的特定贡献——“化学界面阻尼”。这个思想实验对于设计和解读真实的等离激元学实验至关重要，它能磨练你在面对复杂系统时进行控制变量和数据分析的能力。[@problem_id:2511422]", "problem": "胶体合成法制备了半径 $R \\in [10\\,\\mathrm{nm},40\\,\\mathrm{nm}]$ 的近球形金纳米粒子，并将其稀疏地沉积在玻璃上。通过暗场弹性散射对每个纳米粒子进行单独探测，以测量其局域表面等离激元共振（LSPR）的峰值能量 $\\hbar\\omega_{\\mathrm{LSPR}}$ 和线宽 $\\Gamma$（半峰全宽）。你的研究兴趣在于量化与金属发生化学耦合的吸附物（例如芳香族硫醇）如何通过化学界面阻尼对等离激元退相干产生贡献，并将其与仅由有限尺寸效应引起的退相干区分开来。假设存在以下被广泛接受的基础：(i) 对于亚波长金属纳米粒子，其偶极 LSPR 条件遵循经典电动力学和传导电子的 Drude 响应；(ii) 各阻尼通道以速率近似相加，因此观测到的线宽 $\\Gamma$ 反映了体电子散射、电子-声子耦合、辐射阻尼和表面介导通道的贡献总和；(iii) 在没有吸附物的情况下，有限尺寸效应源于金属边界处的电子散射，该散射与 $R$ 有关；(iv) 化学界面阻尼源于金属和吸附物之间的界面电子耦合，此耦合会开启额外的非辐射通道。\n\n哪种实验策略能够最清晰地分离出化学界面阻尼对 $\\Gamma$ 的贡献，并将其与纯粹由尺寸引起的阻尼以及吸附物的纯电磁（介电）效应分离开来？\n\nA. 对于一系列尺寸不同的单个金纳米球（$R \\in [10\\,\\mathrm{nm},40\\,\\mathrm{nm}]$），在折射率 $n\\approx 1.33$ 的水中形成苯硫酚化学吸附单层前后，分别测量 $\\Gamma$。在两种情况下都对 $\\Gamma$ 与 $1/R$ 的关系进行拟合，并将 $1/R\\to 0$ 处截距的任何变化归因于化学界面阻尼，同时保持斜率作为纯尺寸诱导的表面散射贡献。\n\nB. 在固定半径 $R\\approx 20\\,\\mathrm{nm}$ 的情况下，在吸附前后分别测量单个粒子的 $\\Gamma$，同时将周围溶剂的折射率从 $n\\approx 1.33$ 变到 $n\\approx 1.50$，并将任何不遵循折射率趋势的、与覆盖度相关的变化归因于化学界面阻尼。\n\nC. 对于固定半径 $R$ 的单个粒子，首先在空气中测量 $\\Gamma$，然后通过原子层沉积（ALD）在金属上涂覆一层厚度 $t\\approx 2\\,\\mathrm{nm}$ 的超薄绝缘氧化铝间隔层，重新测量 $\\Gamma$；接着在间隔层上吸附相同的硫醇单层并再次测量 $\\Gamma$。在另一个分支实验中，对名义上相同的粒子，直接在裸金属上进行吸附而不使用间隔层，并测量 $\\Gamma$。使用双重差分 $[\\Gamma(\\text{裸金属}+\\text{吸附物})-\\Gamma(\\text{裸金属})]-[\\Gamma(\\text{间隔层}+\\text{吸附物})-\\Gamma(\\text{间隔层})]$ 来量化化学界面阻尼，同时抑制有限尺寸和纯电磁贡献。\n\nD. 对具有宽尺寸分布的胶体进行系综消光光谱测量，同时从 $T\\approx 300\\,\\mathrm{K}$ 冷却到 $T\\approx 80\\,\\mathrm{K}$ 以减少电子-声子散射，然后在低温下吸附硫醇单层，并将任何剩余的线宽增加归因于化学界面阻尼，因为尺寸引起的阻尼与温度无关。\n\nE. 使用超快泵浦-探测瞬态吸收技术，在吸附前后提取单分散 $R\\approx 20\\,\\mathrm{nm}$ 系综的等离激元退相干时间 $T_{2}$。将差异 $\\Delta(1/T_{2})$ 归因于化学界面阻尼，因为粒子尺寸是固定的。", "solution": "问题要求找出最有效的实验策略，以分离出化学界面阻尼 $\\Gamma_{\\text{chem}}$ 对金纳米粒子总等离激元线宽 $\\Gamma$ 的贡献。这需要将 $\\Gamma_{\\text{chem}}$ 与其他阻尼贡献分开，特别是那些源于有限尺寸效应（表面散射）和吸附物层的纯电磁（介电）效应的贡献。\n\n金属纳米粒子中等离激元共振的总均匀线宽 $\\Gamma$ 可以表示为来自不同阻尼通道的速率之和：\n$$\n\\Gamma = \\Gamma_{\\text{intrinsic}} + \\Gamma_{\\text{rad}} + \\Gamma_{\\text{size}} + \\Gamma_{\\text{chem}}\n$$\n在此，$\\Gamma_{\\text{intrinsic}}$ 代表体材料中的阻尼（例如，电子-电子和电子-声子散射）。$\\Gamma_{\\text{rad}}$ 是辐射阻尼率，它取决于粒子体积（对于小粒子与 $R^3$ 成正比）和周围介质的折射率 $n$。$\\Gamma_{\\text{size}}$ 是由粒子物理边界处的电子散射引起的贡献，这是一种有限尺寸效应，可以很好地近似为 $\\Gamma_{\\text{size}} = A/R$，其中 $A$ 是一个与材料相关的常数，$R$ 是粒子半径。$\\Gamma_{\\text{chem}}$ 是化学界面阻尼，是在金属和吸附物之间形成化学键时开启的一个额外的非辐射通道。\n\n关键的挑战在于，添加吸附物层不仅引入了 $\\Gamma_{\\text{chem}}$，还改变了局域介电环境。这会将局域折射率从 $n$ 改变为有效折射率 $n'$，进而改变辐射阻尼项 $\\Gamma_{\\text{rad}}$ 并移动共振频率。这种变化就是“纯电磁（介电）效应”。一个成功的策略必须能够区分由 $\\Gamma_{\\text{chem}}$ 引起的 $\\Gamma$ 变化和由介电环境改变引起的变化。\n\n现在让我们评估每种提议的策略。\n\n**A. 对于一系列尺寸不同的单个金纳米球（$R \\in [10\\,\\mathrm{nm},40\\,\\mathrm{nm}]$），在折射率 $n\\approx 1.33$ 的水中形成苯硫酚化学吸附单层前后，分别测量 $\\Gamma$。在两种情况下都对 $\\Gamma$ 与 $1/R$ 的关系进行拟合，并将 $1/R \\to 0$ 处截距的任何变化归因于化学界面阻尼，同时保持斜率作为纯尺寸诱导的表面散射贡献。**\n\n该方法基于小粒子的近似线性关系 $\\Gamma \\approx \\Gamma_0 + A/R$。截距 $\\Gamma_0$ 被视作体阻尼值。该提议认为，对于裸粒子，$\\Gamma_{\\text{bare}} \\approx \\Gamma_{\\text{bulk}} + A/R$，而对于有吸附物的粒子，$\\Gamma_{\\text{ads}} \\approx (\\Gamma_{\\text{bulk}} + \\Gamma_{\\text{chem}}) + A/R$。那么，$1/R \\to 0$（大粒子极限）处截距的变化就将是 $\\Gamma_{\\text{chem}}$。\n\n此策略存在两个根本性缺陷。首先，线性模型忽略了辐射阻尼 $\\Gamma_{\\text{rad}}$，它大致与 $R^3$ 成正比。对于半径在 $10-40\\,\\mathrm{nm}$ 范围内的金纳米粒子，$\\Gamma_{\\text{rad}}$ 不可忽略，其对 $R$ 的强依赖性使得 $\\Gamma$ 对 $1/R$ 的简单线性拟合在物理上是不准确的。数据会呈曲线状，使得对斜率和截距的解释变得模糊不清。其次，更关键的是，该方法完全未能将化学阻尼与介电效应分离开来。吸附物层改变了有效折射率，从而改变了 $\\Gamma_{\\text{rad}}$。在 $1/R \\to 0$（即大 $R$）的极限下，辐射阻尼成为主导项。因此，截距的变化 $\\Delta\\Gamma_0$ 将是 $\\Gamma_{\\text{chem}}$ 和由介电效应引起的辐射阻尼变化 $\\Delta\\Gamma_{\\text{rad}}$ 的混合体。该方法恰恰在混杂因素（$\\Gamma_{\\text{rad}}$）最显著的地方混淆了这两种效应。\n\n结论：**错误**。\n\n**B. 在固定半径 $R\\approx 20\\,\\mathrm{nm}$ 的情况下，在吸附前后分别测量单个粒子的 $\\Gamma$，同时将周围溶剂的折射率从 $n\\approx 1.33$ 变到 $n\\approx 1.50$，并将任何不遵循折射率趋势的、与覆盖度相关的变化归因于化学界面阻尼。**\n\n该策略提议校准系统对体折射率变化的响应，然后利用此校准来解释吸附物的介电效应。通过测量裸粒子在不同溶剂中的 $\\Gamma$，可以建立一个趋势 $\\Gamma_{\\text{bare}}(n)$。添加吸附物层等效于产生一个新的有效折射率 $n'$。人们有可能通过 LSPR 峰值位移来估算 $n'$，因为峰值位移也对折射率敏感。知道了 $n'$，就可以预测仅由介电效应引起的线宽变化 $\\Delta\\Gamma_{\\text{diel}} = \\Gamma_{\\text{bare}}(n') - \\Gamma_{\\text{bare}}(n)$，并将其从总测量变化 $\\Delta\\Gamma_{\\text{total}}$ 中减去，以求得 $\\Gamma_{\\text{chem}}$。\n\n虽然其基本思想是合理的，但实施起来是间接的，并依赖于多种假设。例如，它假设 LSPR 峰值位移纯粹是介电效应，而化学相互作用也可能引起位移。它还假设一个薄的、结构化的吸附物层的影响可以被体溶剂折射率的变化完美模仿，而这只是一种近似。所述策略含糊不清，不如一个设计良好的对照实验直接。\n\n结论：**错误**。虽然比 A 好，但不是最清晰的方法。\n\n**C. 对于固定半径 $R$ 的单个粒子，首先在空气中测量 $\\Gamma$，然后通过原子层沉积（ALD）在金属上涂覆一层厚度 $t\\approx 2\\,\\mathrm{nm}$ 的超薄绝缘氧化铝间隔层，重新测量 $\\Gamma$；接着在间隔层上吸附相同的硫醇单层并再次测量 $\\Gamma$。在另一个分支实验中，对名义上相同的粒子，直接在裸金属上进行吸附而不使用间隔层，并测量 $\\Gamma$。使用双重差分 $[\\Gamma(\\text{裸金属}+\\text{吸附物})-\\Gamma(\\text{裸金属})]-[\\Gamma(\\text{间隔层}+\\text{吸附物})-\\Gamma(\\text{间隔层})]$ 来量化化学界面阻尼，同时抑制有限尺寸和纯电磁贡献。**\n\n该策略是双重差分（DiD）方法的一个巧妙应用。让我们来分析其组成部分。由于 $R$ 是固定的，与尺寸相关的项 $\\Gamma_{\\text{size}}=A/R$ 在对给定粒子的所有测量中都是一个恒定的背景值，因此在任何差分计算中都会被抵消。\n\n实验有两个分支：\n1. 裸粒子：测量 $\\Gamma_{\\text{bare}}$。然后，添加吸附物，测量 $\\Gamma_{\\text{bare+ads}}$。变化量为 $\\Delta\\Gamma_1 = \\Gamma_{\\text{bare+ads}} - \\Gamma_{\\text{bare}} = \\Delta\\Gamma_{\\text{diel}} + \\Gamma_{\\text{chem}}$。这是总效应，结合了介电和化学贡献。\n2. 涂有间隔层的粒子：测量 $\\Gamma_{\\text{spacer}}$。然后，在间隔层上添加吸附物，测量 $\\Gamma_{\\text{spacer+ads}}$。变化量为 $\\Delta\\Gamma_2 = \\Gamma_{\\text{spacer+ads}} - \\Gamma_{\\text{spacer}}$。\n\n关键的洞见在于，厚度 $t\\approx 2\\,\\mathrm{nm}$ 的绝缘氧化铝（$Al_2O_3$）间隔层足够厚，可以防止金属和吸附物之间的电子波函数重叠。这在电子层面上将两者解耦，因此不会发生化学界面阻尼（$\\Gamma_{\\text{chem}}=0$）。然而，与等离激元的衰减长度相比，间隔层很薄，所以吸附物层仍然能感受到纳米粒子的电磁场并发挥其介电效应。因此，变化量 $\\Delta\\Gamma_2$ 分离出了纯电磁（介电）贡献：$\\Delta\\Gamma_2 = \\Delta\\Gamma_{\\text{diel}}$。\n\n然后双重差分计算如下：\n$$ \\text{DiD} = \\Delta\\Gamma_1 - \\Delta\\Gamma_2 = (\\Delta\\Gamma_{\\text{diel}} + \\Gamma_{\\text{chem}}) - (\\Delta\\Gamma_{\\text{diel}}) = \\Gamma_{\\text{chem}} $$\n该方法通过创建一个近乎完美的对照实验，分离并减去了混杂的介电效应，从而直接测量了 $\\Gamma_{\\text{chem}}$。这是所有选项中最严谨、最清晰的方法。\n\n结论：**正确**。\n\n**D. 对具有宽尺寸分布的胶体进行系综消光光谱测量，同时从 $T\\approx 300\\,\\mathrm{K}$ 冷却到 $T\\approx 80\\,\\mathrm{K}$ 以减少电子-声子散射，然后在低温下吸附硫醇单层，并将任何剩余的线宽增加归因于化学界面阻尼，因为尺寸引起的阻尼与温度无关。**\n\n这个提议从一开始就是有缺陷的。对具有“宽尺寸分布”的胶体进行系综光谱测量将产生一个主要由非均匀展宽主导的光谱。测得的线宽将更多地反映尺寸分布，而不是内在的单粒子均匀线宽 $\\Gamma$。从此类测量中提取 $\\Gamma$ 的微小变化实际上是不可能的。此外，即使粒子尺寸是单分散的，该策略也没有试图将化学阻尼与吸附物的介电效应分离开来。降温仅仅减少了一个背景项（$\\Gamma_{\\text{e-ph}}$）；它无助于解开由吸附物引起的两个变化分量。\n\n结论：**错误**。\n\n**E. 使用超快泵浦-探测瞬态吸收技术，在吸附前后提取单分散 $R\\approx 20\\,\\mathrm{nm}$ 系综的等离激元退相干时间 $T_{2}$。将差异 $\\Delta(1/T_{2})$ 归因于化学界面阻尼，因为粒子尺寸是固定的。**\n\n均匀线宽 $\\Gamma$ 和退相干时间 $T_2$ 通过 $\\Gamma = 2\\hbar/T_2$ 相关联。因此，测量退相干速率的变化 $\\Delta(1/T_2)$ 等效于测量线宽的变化 $\\Delta\\Gamma$。此方法仅仅是用时域测量替代了频域测量。虽然超快光谱可以提供有价值的信息，但该策略与 B 和 D 犯了同样的基本错误：它测量的是吸附后阻尼率的*总*变化 $\\Delta(1/T_2) \\propto \\Delta\\Gamma_{\\text{diel}} + \\Gamma_{\\text{chem}}$，并没有提供任何方法来分离这两种贡献。“粒子尺寸是固定的”这一论点只能消除 $A/R$ 项的变化；它没有解决介电混杂因素的问题。\n\n结论：**错误**。\n\n总之，选项 C 是所提出的唯一一种采用特定的、有物理动机的对照实验（绝缘间隔层）来清晰分离化学界面阻尼与吸附物层所带来的混杂的纯电磁效应的策略，而这正是所提出问题的核心难点。", "answer": "$$\\boxed{C}$$", "id": "2511422"}, {"introduction": "在掌握了分析模型和实验设计思想后，我们最后的实践将带领你进入计算等离激元学的核心。你将通过编写程序，利用精确的 Mie 理论计算金属球体的光学散射响应，从而超越之前练习中的简化模型。这项练习不仅能让你掌握现代等离激元研究中不可或缺的计算工具，还将帮助你深刻理解数值精度和收敛性的概念——这是验证任何数值模拟结果有效性的基石。[@problem_id:2511441]", "problem": "您的任务是编写一个完整、可运行的程序，通过复现精确的 Mie 散射结果来验证一个用于金属球光散射的数值求解器，并量化其相对于角谐波截断（该截断起到网格细化的作用）的收敛性。物理系统是一个半径为 $a$ 的均匀、各向同性、非磁性的金属球，置于真空中，被一束在真空中传播的、自由空间波长为 $\\lambda$ 的单色平面电磁波所照射。球体由一个无带间跃迁项的 Drude 介电函数描述。任务是采用两种方法计算散射效率谱：一种是高精度参考解，另一种是模拟受网格限制的数值求解器的截断角动量解，然后量化后者在截断水平增加时向前者收敛的情况。\n\n使用的基本原理和定义：\n- 从频域中的麦克斯韦方程组及本构关系 $\\mathbf{D} = \\varepsilon_{0} \\varepsilon(\\omega) \\mathbf{E}$ 和 $\\mathbf{B} = \\mu_{0} \\mathbf{H}$ 出发，其中金属的相对介电常数为 $\\varepsilon(\\omega)$，磁导率为1。\n- 对于金属，使用 Drude 模型 $\\varepsilon(\\omega) = \\varepsilon_{\\infty} - \\dfrac{\\omega_{p}^{2}}{\\omega^{2} + i \\gamma \\omega}$，其中 $\\varepsilon_{\\infty}$、$\\omega_{p}$ 和 $\\gamma$ 是材料参数。在实践中，通过将 $\\hbar \\omega \\mapsto E$（单位为电子伏特）替换，以电子伏特处理能量，因此\n$$\n\\varepsilon(E) = \\varepsilon_{\\infty} - \\frac{\\Omega_{p}^{2}}{E^{2} + i \\Gamma E},\n$$\n其中 $\\Omega_{p}$ 和 $\\Gamma$ 分别是以电子伏特表示的 $\\hbar \\omega_{p}$ 和 $\\hbar \\gamma$，而 $E = \\dfrac{hc}{\\lambda}$ 单位为电子伏特，其中 $\\lambda$ 单位为纳米，且 $hc \\approx 1239.841984\\,\\mathrm{eV\\,nm}$。周围介质是真空，其相对介电常数等于 $1$。定义复折射率 $m(E) = \\sqrt{\\varepsilon(E)}$。\n- 精确解（Mie 理论）将场展开为矢量球谐函数，其角动量指数为 $n \\in \\mathbb{N}$。散射效率 $Q_{\\mathrm{sca}}(\\lambda)$ 从多极子系数中获得。您必须从麦克斯韦方程组和球形界面上的电磁边界条件所蕴含的边值问题中，推导出您将要编码的工作表达式。\n\n数值验证与收敛性任务：\n- 实现 $Q_{\\mathrm{sca}}(\\lambda)$ 的高精度“参考”计算，使用足够大的角向截断 $n_{\\max}(\\lambda)$ 以在整个光谱上实现收敛。\n- 实现一个“受网格限制”的计算，该计算在指定的最大角阶数 $L$（其中 $L \\in \\mathbb{N}$）处截断多极展开，以模拟有限的角分辨率。\n- 对于每个测试，通过计算以下指标，将受网格限制的光谱与参考光谱进行比较：\n  1. 均方根光谱误差\n  $$\n  \\mathrm{RMS} = \\sqrt{\\frac{1}{N_{\\lambda}} \\sum_{j=1}^{N_{\\lambda}} \\left( Q^{(L)}_{\\mathrm{sca}}(\\lambda_{j}) - Q^{\\mathrm{ref}}_{\\mathrm{sca}}(\\lambda_{j}) \\right)^{2}},\n  $$\n  其中 $\\{ \\lambda_{j} \\}_{j=1}^{N_{\\lambda}}$ 是波长网格。\n  2. 共振波长的有符号误差（单位为纳米），定义为在指定范围内 $Q_{\\mathrm{sca}}(\\lambda)$ 全局最大值的位置，\n  $$\n  \\Delta \\lambda_{\\mathrm{peak}} = \\lambda_{\\mathrm{peak}}^{(L)} - \\lambda_{\\mathrm{peak}}^{\\mathrm{ref}}.\n  $$\n- 使用尺寸参数 $x(\\lambda) = \\dfrac{2\\pi a}{\\lambda}$，其中 $a$ 和 $\\lambda$ 的单位均为纳米。散射效率是无量纲的。共振波长误差必须以纳米为单位报告。\n\n测试套件和参数覆盖范围：\n- 物理常数和单位：使用波长 $\\lambda$（单位：纳米），能量 $E$（单位：电子伏特），以及无量纲的散射效率 $Q_{\\mathrm{sca}}$。凡是内部出现角度的地方，角度单位均为弧度；最终输出不包含任何角度。\n- 材料模型参数按每个测试指定。在所有测试中均使用 $\\varepsilon_{\\infty} = 1.0$。\n\n提供一个单一程序，评估以下三个测试。每个测试指定球体半径 $a$、Drude 参数 $\\Omega_{p}$ 和 $\\Gamma$（单位为电子伏特）、波长范围以及要评估的截断水平 $L$ 的列表。对于列表中的每个 $L$，计算并返回上面定义的序对 $\\left[ \\mathrm{RMS}, \\Delta \\lambda_{\\mathrm{peak}} \\right]$。\n\n测试 $1$（正常路径，偶极主导但非准静态）：\n- $a = 30\\,\\mathrm{nm}$，\n- $\\Omega_{p} = 9.0\\,\\mathrm{eV}$，\n- $\\Gamma = 0.02\\,\\mathrm{eV}$，\n- $\\lambda \\in [300, 800]\\,\\mathrm{nm}$，步长为 $2\\,\\mathrm{nm}$ 的均匀采样，\n- $L \\in \\{ 1, 2, 3, 5, 10 \\}$。\n\n测试 $2$（需要更高角向分量的较大颗粒）：\n- $a = 150\\,\\mathrm{nm}$，\n- $\\Omega_{p} = 9.0\\,\\mathrm{eV}$，\n- $\\Gamma = 0.05\\,\\mathrm{eV}$，\n- $\\lambda \\in [400, 1200]\\,\\mathrm{nm}$，步长为 $4\\,\\mathrm{nm}$ 的均匀采样，\n- $L \\in \\{ 1, 3, 5, 10, 20 \\}$。\n\n测试 $3$（准静态极限，强等离激元和快速收敛）：\n- $a = 5\\,\\mathrm{nm}$，\n- $\\Omega_{p} = 9.0\\,\\mathrm{eV}$，\n- $\\Gamma = 0.02\\,\\mathrm{eV}$，\n- $\\lambda \\in [300, 800]\\,\\mathrm{nm}$，步长为 $5\\,\\mathrm{nm}$ 的均匀采样，\n- $L \\in \\{ 1, 2, 3 \\}$。\n\n参考解要求：\n- 对于参考光谱 $Q^{\\mathrm{ref}}_{\\mathrm{sca}}(\\lambda)$，您必须通过为每个 $\\lambda$ 选择足够大的 $n_{\\max}(\\lambda)$ 来确保收敛。可以使用一个依赖于 $x(\\lambda)$ 的经验界限，只要它能在指定的参数范围内明确地产生稳定的结果。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。该列表必须恰好包含三个项目，每个测试一个，并且每个项目本身都必须是一个列表的列表。换句话说，输出必须具有以下形式：\n$[R_{1}, R_{2}, R_{3}]$\n其中每个 $R_{k}$ 是测试 $k$ 中指定的截断水平的一对 $\\left[\\mathrm{RMS}, \\Delta \\lambda_{\\mathrm{peak}}\\right]$ 的列表，其顺序与该测试中列出的顺序相同。例如：\n$[[[r_{11},d_{11}], [r_{12},d_{12}], \\dots], [[r_{21},d_{21}], \\dots], [[r_{31},d_{31}], \\dots]]$。\n所有 $\\Delta \\lambda_{\\mathrm{peak}}$ 必须以纳米为单位报告，作为有符号实数。所有 $\\mathrm{RMS}$ 值都是无量纲实数。不得打印任何其他文本。", "solution": "我们首先将问题与其物理基础联系起来。在频域中，设时间依赖关系为 $\\exp(-i \\omega t)$，则在真空和均匀、各向同性、非磁性球体内部的麦克斯韦方程组为\n$\n\\nabla \\times \\mathbf{E} = i \\omega \\mu_{0} \\mathbf{H}, \\quad\n\\nabla \\times \\mathbf{H} = -i \\omega \\varepsilon_{0} \\varepsilon(\\omega) \\mathbf{E},\n$\n以及\n$\n\\nabla \\cdot \\varepsilon(\\omega) \\mathbf{E} = 0, \\quad \\nabla \\cdot \\mathbf{H} = 0.\n$\n对于平面波入射和单个球形界面，在球表面 $r=a$ 处的边界条件要求 $\\mathbf{E}$ 和 $\\mathbf{H}$ 的切向分量连续。在球坐标系中使用变量分离法，可将场展开为矢量球谐函数，其角动量指数为 $n \\in \\mathbb{N}$。散射场振幅由两组多极子系数 $a_{n}$ 和 $b_{n}$ 参数化，分别对应电多极子和磁多极子。\n\n材料响应是金属性的，其 Drude 相对介电常数为\n$\n\\varepsilon(\\omega) = \\varepsilon_{\\infty} - \\frac{\\omega_{p}^{2}}{\\omega^{2} + i \\gamma \\omega}.\n$\n为了使用电子伏特为单位的能量进行数值计算，我们引入以电子伏特度量的 $E = \\hbar \\omega$，并设 $\\Omega_{p} = \\hbar \\omega_{p}$ 和 $\\Gamma = \\hbar \\gamma$（单位为电子伏特），得到\n$\n\\varepsilon(E) = \\varepsilon_{\\infty} - \\frac{\\Omega_{p}^{2}}{E^{2} + i \\Gamma E}.\n$\n给定自由空间波长 $\\lambda$（单位为纳米），我们计算 $E(\\lambda) = \\dfrac{hc}{\\lambda}$，其中 $hc \\approx 1239.841984\\,\\mathrm{eV\\,nm}$。复折射率为 $m(\\lambda) = \\sqrt{\\varepsilon(E(\\lambda))}$。尺寸参数为 $x(\\lambda) = \\dfrac{2 \\pi a}{\\lambda}$，其中 $a$ 和 $\\lambda$ 的单位均为纳米。\n\nMie 散射系数是通过在球面波展开上施加边界条件得到的。引入 Riccati–Bessel 函数 $\\psi_{n}(z) = z j_{n}(z)$ 和 $\\xi_{n}(z) = z h_{n}^{(1)}(z)$，其中 $j_{n}$ 是球贝塞尔函数，$h_{n}^{(1)} = j_{n} + i y_{n}$ 是第一类球汉克尔函数，并用撇号表示对自变量的导数，则系数为\n$\na_{n} = \\frac{ m \\, \\psi_{n}(m x)\\, \\psi_{n}'(x) - \\psi_{n}(x)\\, \\psi_{n}'(m x) }{ m \\, \\psi_{n}(m x)\\, \\xi_{n}'(x) - \\xi_{n}(x)\\, \\psi_{n}'(m x) },\n\\quad\nb_{n} = \\frac{ \\psi_{n}(m x)\\, \\psi_{n}'(x) - m \\, \\psi_{n}(x)\\, \\psi_{n}'(m x) }{ \\psi_{n}(m x)\\, \\xi_{n}'(x) - m \\, \\xi_{n}(x)\\, \\psi_{n}'(m x) }.\n$\n此处，$x = x(\\lambda)$ 且 $m = m(\\lambda)$。对于 $\\xi_{n}$，球函数在实自变量 $x$ 处求值；对于 $\\psi_{n}(m x)$，则在复自变量 $m x$ 处求值。\n\n散射效率 $Q_{\\mathrm{sca}}$ 是散射截面 $C_{\\mathrm{sca}}$ 被几何截面 $\\pi a^{2}$ 归一化后的结果。它由以下绝对收敛级数给出\n$\nQ_{\\mathrm{sca}}(\\lambda) = \\frac{2}{x(\\lambda)^{2}} \\sum_{n=1}^{\\infty} (2 n + 1) \\left( |a_{n}|^{2} + |b_{n}|^{2} \\right).\n$\n在数值实践中，此级数在最大角阶数 $n_{\\max}$ 处被截断。对于一个收敛的参考解，一个经验选择是取\n$\nn_{\\max}^{\\mathrm{ref}}(\\lambda) = \\left\\lceil x(\\lambda) + 4\\, x(\\lambda)^{1/3} + 2 \\right\\rceil + \\Delta,\n$\n并加上一个小的整数填充 $\\Delta$ 以确保安全。众所周知，该准则在一系列尺寸参数上能产生一致收敛。\n\n“受网格限制”的求解器被建模为在指定的角水平 $L$ 处的截断，即\n$\nQ_{\\mathrm{sca}}^{(L)}(\\lambda) = \\frac{2}{x(\\lambda)^{2}} \\sum_{n=1}^{L} (2 n + 1) \\left( |a_{n}|^{2} + |b_{n}|^{2} \\right).\n$\n随着 $L$ 的增加，$Q_{\\mathrm{sca}}^{(L)}(\\lambda)$ 从下方单调收敛到精确的 $Q_{\\mathrm{sca}}(\\lambda)$，因为求和中缺失的多极子贡献是非负项。这种角向截断起到了控制数值解角分辨率的网格细化参数的作用。\n\n我们如下定义误差度量。设 $\\{ \\lambda_{j} \\}_{j=1}^{N_{\\lambda}}$ 为给定测试的均匀波长网格。在每个波长上使用 $n_{\\max}^{\\mathrm{ref}}(\\lambda_{j})$ 计算参考光谱 $Q_{\\mathrm{sca}}^{\\mathrm{ref}}(\\lambda_{j})$。对于测试中每个指定的 $L$，对所有 $\\lambda_{j}$ 使用该精确截断来计算受网格限制的光谱 $Q_{\\mathrm{sca}}^{(L)}(\\lambda_{j})$。然后计算均方根光谱误差\n$\n\\mathrm{RMS}(L) = \\sqrt{\\frac{1}{N_{\\lambda}} \\sum_{j=1}^{N_{\\lambda}} \\left( Q_{\\mathrm{sca}}^{(L)}(\\lambda_{j}) - Q_{\\mathrm{sca}}^{\\mathrm{ref}}(\\lambda_{j}) \\right)^{2}},\n$\n并计算共振波长误差\n$\n\\Delta \\lambda_{\\mathrm{peak}}(L) = \\lambda_{\\mathrm{peak}}^{(L)} - \\lambda_{\\mathrm{peak}}^{\\mathrm{ref}},\n$\n其中 $\\lambda_{\\mathrm{peak}}^{(L)}$ 和 $\\lambda_{\\mathrm{peak}}^{\\mathrm{ref}}$ 分别是 $Q_{\\mathrm{sca}}^{(L)}$ 和 $Q_{\\mathrm{sca}}^{\\mathrm{ref}}$ 在指定网格上达到其全局最大值时的波长。值 $\\Delta \\lambda_{\\mathrm{peak}}$ 以纳米为单位报告，作为有符号实数。$\\mathrm{RMS}$ 是无量纲的。\n\n算法设计和实现细节：\n- 对 $\\lambda$（单位为纳米），计算 $E(\\lambda) = \\dfrac{1239.841984}{\\lambda}\\,\\mathrm{eV}$。\n- 使用给定的 $\\Omega_{p}$、$\\Gamma$ 和 $\\varepsilon_{\\infty}=1.0$ 计算 $\\varepsilon(E) = \\varepsilon_{\\infty} - \\dfrac{\\Omega_{p}^{2}}{E^{2} + i \\Gamma E}$。取 $m = \\sqrt{\\varepsilon}$，采用主平方根。\n- 对于每个波长，计算 $x = \\dfrac{2 \\pi a}{\\lambda}$。\n- 为构成 Mie 系数 $a_{n}$ 和 $b_{n}$，计算：\n  - $\\psi_{n}(z) = z j_{n}(z)$，$\\psi_{n}'(z) = j_{n}(z) + z j_{n}'(z)$，其中 $j_{n}$ 和 $j_{n}'$ 是球贝塞尔函数及其导数。对于复自变量 $z = m x$，直接在复数 $z$ 上计算 $j_{n}(z)$ 和 $j_{n}'(z)$。\n  - $\\xi_{n}(x) = x h_{n}^{(1)}(x) = x \\left( j_{n}(x) + i y_{n}(x) \\right)$，其中 $y_{n}$ 是对应实数 $x$ 的球诺伊曼函数。其导数为 $\\xi_{n}'(x) = h_{n}^{(1)}(x) + x \\left( j_{n}'(x) + i y_{n}'(x) \\right)$。\n  - 将这些代入上面 $a_{n}$ 和 $b_{n}$ 的闭式表达式中。\n- 参考截断指数 $n_{\\max}^{\\mathrm{ref}}(\\lambda)$ 可选择为 $n_{\\max}^{\\mathrm{ref}}(\\lambda) = \\left\\lceil x(\\lambda) + 4 x(\\lambda)^{1/3} + 2 \\right\\rceil + 10$，它能安全地捕捉到所提供测试中尺寸参数的所有相关多极子。\n- 对于每个测试及其列表中的每个 $L$，根据上述定义计算 $\\mathrm{RMS}(L)$ 和 $\\Delta \\lambda_{\\mathrm{peak}}(L)$。\n- 将输出聚合到一个单一的嵌套列表中，该列表包含三个顶级条目，每个测试一个，每个条目包含按指定 $L$ 值顺序排列的 $\\left[ \\mathrm{RMS}, \\Delta \\lambda_{\\mathrm{peak}} \\right]$ 对的列表。\n\n科学真实性和预期：\n- 在测试 $1$ 中，$a = 30\\,\\mathrm{nm}$，偶极表面等离激元占主导地位，因此随 $L$ 的收敛相对较快，并且峰值位于 $\\operatorname{Re}\\{\\varepsilon(E)\\} \\approx -2$（准静态偶极条件）的频率附近，伴有适度的辐射修正。\n- 在测试 $2$ 中，$a = 150\\,\\mathrm{nm}$，高阶多极子有贡献，因此需要更大的 $L$ 来分辨光谱，且共振结构依赖于推迟效应。\n- 在测试 $3$ 中，$a = 5\\,\\mathrm{nm}$，接近准静态区域，$L=1$ 已能捕捉到大部分散射，因此 $\\mathrm{RMS}$ 误差很小，$\\Delta \\lambda_{\\mathrm{peak}}$ 接近于零。\n\n最终的程序遵循这些原则，使用稳定的特殊函数（$j_{n}$ 和 $y_{n}$ 及其导数）求值方法，并在单行上打印所要求的嵌套列表，不含任何额外文本。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.special import spherical_jn, spherical_yn\n\n# Physical constant hc in eV*nm\nHC_EV_NM = 1239.841984\n\ndef drude_epsilon(E_eV, omega_p_eV, gamma_eV, eps_inf=1.0):\n    \"\"\"\n    Drude dielectric function in eV-units: epsilon(E) = eps_inf - omega_p^2 / (E^2 + i*gamma*E)\n    E_eV can be array-like; returns complex array.\n    \"\"\"\n    E = np.asarray(E_eV, dtype=np.complex128)\n    return eps_inf - (omega_p_eV**2) / (E**2 + 1j * gamma_eV * E)\n\ndef mie_ab_coefficients(n, x, m):\n    \"\"\"\n    Compute Mie coefficients a_n and b_n for order n, size parameter x (real),\n    and complex refractive index m (complex).\n    Uses Riccati-Bessel functions psi_n(z) = z * j_n(z), xi_n(z) = z * h_n^(1)(z).\n    \"\"\"\n    # Arguments\n    z = x  # real\n    mz = m * x  # complex\n\n    # Spherical Bessel j_n and derivatives\n    jn_z = spherical_jn(n, z)\n    jn_z_p = spherical_jn(n, z, derivative=True)\n    jn_mz = spherical_jn(n, mz)  # complex\n    jn_mz_p = spherical_jn(n, mz, derivative=True)\n\n    # Spherical Neumann y_n and derivatives at real z\n    yn_z = spherical_yn(n, z)\n    yn_z_p = spherical_yn(n, z, derivative=True)\n\n    # Hankel h_n^(1) and derivative at real z\n    hn_z = jn_z + 1j * yn_z\n    hn_z_p = jn_z_p + 1j * yn_z_p\n\n    # Riccati-Bessel functions\n    psi_z = z * jn_z\n    psi_z_p = jn_z + z * jn_z_p\n\n    psi_mz = mz * jn_mz\n    psi_mz_p = jn_mz + mz * jn_mz_p\n\n    xi_z = z * hn_z\n    xi_z_p = hn_z + z * hn_z_p\n\n    # Mie coefficients\n    # a_n\n    num_a = m * psi_mz * psi_z_p - psi_z * psi_mz_p\n    den_a = m * psi_mz * xi_z_p - xi_z * psi_mz_p\n    a_n = num_a / den_a\n\n    # b_n\n    num_b = psi_mz * psi_z_p - m * psi_z * psi_mz_p\n    den_b = psi_mz * xi_z_p - m * xi_z * psi_mz_p\n    b_n = num_b / den_b\n\n    return a_n, b_n\n\ndef Q_sca_mie_spectrum(wavelengths_nm, radius_nm, omega_p_eV, gamma_eV, eps_inf=1.0, L=None, use_reference=False):\n    \"\"\"\n    Compute the scattering efficiency spectrum Q_sca(lambda) for a sphere.\n    If use_reference=True, uses a wavelength-dependent n_max based on Wiscombe-like criterion with padding.\n    Else, uses fixed truncation L (positive integer).\n    Returns array of Q_sca with same length as wavelengths_nm.\n    \"\"\"\n    wl = np.asarray(wavelengths_nm, dtype=np.float64)\n    a = float(radius_nm)\n\n    # Energies in eV\n    E = HC_EV_NM / wl  # eV\n    eps = drude_epsilon(E, omega_p_eV, gamma_eV, eps_inf=eps_inf)\n    m = np.sqrt(eps)  # complex refractive index\n\n    # Size parameter x = 2*pi*a / lambda, both in nm\n    x = 2.0 * np.pi * a / wl  # real array\n\n    Q = np.zeros_like(wl, dtype=np.float64)\n    # Loop over wavelengths\n    for i in range(wl.size):\n        xi = x[i]\n        mi = m[i]\n        if use_reference:\n            # Wiscombe-like criterion with padding to ensure convergence\n            # n_max = ceil(x + 4 x^(1/3) + 2) + 10\n            n_max = int(np.ceil(xi + 4.0 * (xi ** (1.0 / 3.0)) + 2.0)) + 10\n            if n_max  1:\n                n_max = 1\n        else:\n            if L is None or L  1:\n                raise ValueError(\"Fixed truncation L must be a positive integer when use_reference is False.\")\n            n_max = int(L)\n\n        # Sum over n\n        sum_terms = 0.0 + 0.0j\n        for n in range(1, n_max + 1):\n            a_n, b_n = mie_ab_coefficients(n, xi, mi)\n            sum_terms += (2 * n + 1) * (abs(a_n) ** 2 + abs(b_n) ** 2)\n\n        # Q_sca\n        Q[i] = (2.0 / (xi ** 2)) * sum_terms.real\n\n    return Q\n\ndef rms_error(ref, approx):\n    diff = approx - ref\n    return float(np.sqrt(np.mean(diff * diff)))\n\ndef resonance_wavelength_error(wavelengths_nm, ref_Q, approx_Q):\n    # Use grid maximum\n    i_ref = int(np.argmax(ref_Q))\n    i_approx = int(np.argmax(approx_Q))\n    return float(wavelengths_nm[i_approx] - wavelengths_nm[i_ref])\n\ndef run_test(radius_nm, omega_p_eV, gamma_eV, wl_start, wl_stop, wl_step, L_list, eps_inf=1.0):\n    # Build wavelength grid\n    N = int(round((wl_stop - wl_start) / wl_step)) + 1\n    wavelengths = np.linspace(wl_start, wl_stop, N, dtype=np.float64)\n\n    # Reference spectrum\n    Q_ref = Q_sca_mie_spectrum(\n        wavelengths, radius_nm, omega_p_eV, gamma_eV, eps_inf=eps_inf, L=None, use_reference=True\n    )\n\n    results = []\n    for L in L_list:\n        Q_L = Q_sca_mie_spectrum(\n            wavelengths, radius_nm, omega_p_eV, gamma_eV, eps_inf=eps_inf, L=int(L), use_reference=False\n        )\n        rms = rms_error(Q_ref, Q_L)\n        dlam = resonance_wavelength_error(wavelengths, Q_ref, Q_L)\n        results.append([rms, dlam])\n    return results\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Test 1\n    test1 = {\n        \"radius_nm\": 30.0,\n        \"omega_p_eV\": 9.0,\n        \"gamma_eV\": 0.02,\n        \"wl_start\": 300.0,\n        \"wl_stop\": 800.0,\n        \"wl_step\": 2.0,\n        \"L_list\": [1, 2, 3, 5, 10],\n        \"eps_inf\": 1.0,\n    }\n    # Test 2\n    test2 = {\n        \"radius_nm\": 150.0,\n        \"omega_p_eV\": 9.0,\n        \"gamma_eV\": 0.05,\n        \"wl_start\": 400.0,\n        \"wl_stop\": 1200.0,\n        \"wl_step\": 4.0,\n        \"L_list\": [1, 3, 5, 10, 20],\n        \"eps_inf\": 1.0,\n    }\n    # Test 3\n    test3 = {\n        \"radius_nm\": 5.0,\n        \"omega_p_eV\": 9.0,\n        \"gamma_eV\": 0.02,\n        \"wl_start\": 300.0,\n        \"wl_stop\": 800.0,\n        \"wl_step\": 5.0,\n        \"L_list\": [1, 2, 3],\n        \"eps_inf\": 1.0,\n    }\n\n    tests = [test1, test2, test3]\n    results_all = []\n    for t in tests:\n        res = run_test(\n            t[\"radius_nm\"], t[\"omega_p_eV\"], t[\"gamma_eV\"],\n            t[\"wl_start\"], t[\"wl_stop\"], t[\"wl_step\"],\n            t[\"L_list\"], eps_inf=t[\"eps_inf\"]\n        )\n        # Convert to plain Python floats for clean printing\n        res_clean = [[float(r[0]), float(r[1])] for r in res]\n        results_all.append(res_clean)\n\n    # Final print statement in the exact required format.\n    # Single line, nested lists\n    # We avoid any additional text.\n    def fmt_list(obj):\n        # Format nested list with default str for floats to ensure single-line output\n        if isinstance(obj, list):\n            return \"[\" + \",\".join(fmt_list(x) for x in obj) + \"]\"\n        else:\n            return str(obj)\n\n    print(fmt_list(results_all))\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "2511441"}]}