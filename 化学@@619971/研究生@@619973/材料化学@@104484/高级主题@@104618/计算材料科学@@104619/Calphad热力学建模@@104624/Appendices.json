{"hands_on_practices": [{"introduction": "CALPHAD 方法的一大优势是其能够利用化合物能量模型（Compound Energy Formalism, CEF）来描述有序相。本练习将统计力学和热力学联系起来，通过从吉布斯自由能模型中推导有序-无序相变的临界温度 $T_c$，来实践这一核心能力。掌握这项基本技能有助于理解相稳定性是如何被编码在模型参数中的。[@problem_id:2471433]", "problem": "一种体心立方晶格上的二元置换合金 $\\mathrm{A}$–$\\mathrm{B}$ 表现出B2长程序，该长程序由两个相互贯穿的亚晶格 $\\alpha$ 和 $\\beta$ 描述。在用于相图计算（CALPHAD）的化合物能量模型（Compound Energy Formalism）框架内，对于整体等原子比成分，通过亚晶格格点分数 $y_{\\mathrm{A}}^{\\alpha} = (1+\\eta)/2$、$y_{\\mathrm{B}}^{\\alpha} = (1-\\eta)/2$、$y_{\\mathrm{A}}^{\\beta} = (1-\\eta)/2$ 和 $y_{\\mathrm{B}}^{\\beta} = (1+\\eta)/2$ 来定义长程有序参数 $\\eta$，其中 $0 \\le \\eta \\le 1$。假设：\n- 摩尔吉布斯能量为 $g = h - T s$，每个亚晶格上具有理想构型熵。\n- 只有最近邻 $\\alpha$–$\\beta$ 相互作用对焓有贡献，这通过一个与温度无关的正则溶体参数 $\\Omega$（每摩尔）来捕捉。在等原子比成分下，$\\Omega$ 由原子对能量定义为 $\\Omega = z\\!\\left(w_{\\mathrm{AB}} - \\frac{w_{\\mathrm{AA}} + w_{\\mathrm{BB}}}{2}\\right)$，其中 $z$ 是体心立方晶格上不同亚晶格的最近邻原子数。\n\n从这些定义以及吉布斯自由能和理想混合熵的第一性原理出发，推导在固定成分下，有序化驱动力\n$$\\Delta g(\\eta, T) \\equiv g_{\\mathrm{dis}} - g_{\\mathrm{ord}}(\\eta),$$\n精确到 $\\eta$ 的领先非平凡阶。然后确定在 $\\eta \\to 0^{+}$ 极限下 $\\Delta g(\\eta, T)$ 消失为零时的温度 $T$，从而找出临界有序-无序转变温度 $T_{c}$。\n\n然后，对于 $\\Omega = -3.20 \\times 10^{4}$ J/mol 和摩尔气体常数 $R = 8.314462618$ J/mol·K，数值计算 $T_{c}$。最终温度以K为单位表示，并将您的答案四舍五入到四位有效数字。", "solution": "本题要求在化合物能量模型框架内，推导B2有序二元合金的有序化驱动力，然后确定临界有序-无序转变温度 $T_c$。解答根据题目陈述的第一性原理进行推导。\n\n首先，我们建立有序相的摩尔吉布斯能量 $g_{\\mathrm{ord}}(\\eta)$，将其表示为长程有序参数 $\\eta$ 和温度 $T$ 的函数。吉布斯能量由 $g_{\\mathrm{ord}}(\\eta) = h_{\\mathrm{ord}}(\\eta) - T s_{\\mathrm{ord}}(\\eta)$ 给出，其中 $h_{\\mathrm{ord}}(\\eta)$ 是摩尔混合焓，$s_{\\mathrm{ord}}(\\eta)$ 是摩尔构型熵。\n\n摩尔混合焓 $h_{\\mathrm{ord}}(\\eta)$ 由体心立方（BCC）晶格上的最近邻原子对相互作用决定。在B2结构中，每个格点有 $z=8$ 个最近邻，且它们都位于另一个亚晶格上。设A-A、B-B和A-B原子对的摩尔能量分别为 $W_{\\mathrm{AA}}$、$W_{\\mathrm{BB}}$ 和 $W_{\\mathrm{AB}}$。总摩尔焓是所有原子对能量的总和。A-A、B-B和A-B对的数量由格点分数决定。\n\n每摩尔原子中A-A原子对的摩尔数为 $\\frac{z}{2} y_{\\mathrm{A}}^{\\alpha} y_{\\mathrm{A}}^{\\beta}$。B-B和A-B原子对也类似。\n格点分数由下式给出：$y_{\\mathrm{A}}^{\\alpha} = (1+\\eta)/2$、$y_{\\mathrm{B}}^{\\alpha} = (1-\\eta)/2$、$y_{\\mathrm{A}}^{\\beta} = (1-\\eta)/2$ 和 $y_{\\mathrm{B}}^{\\beta} = (1+\\eta)/2$。\n我们可以计算格点分数的乘积：\n$y_{\\mathrm{A}}^{\\alpha} y_{\\mathrm{A}}^{\\beta} = \\frac{1+\\eta}{2} \\frac{1-\\eta}{2} = \\frac{1-\\eta^2}{4}$\n$y_{\\mathrm{B}}^{\\alpha} y_{\\mathrm{B}}^{\\beta} = \\frac{1-\\eta}{2} \\frac{1+\\eta}{2} = \\frac{1-\\eta^2}{4}$\n$y_{\\mathrm{A}}^{\\alpha} y_{\\mathrm{B}}^{\\beta} + y_{\\mathrm{B}}^{\\alpha} y_{\\mathrm{A}}^{\\beta} = \\left(\\frac{1+\\eta}{2}\\right)^2 + \\left(\\frac{1-\\eta}{2}\\right)^2 = \\frac{1+2\\eta+\\eta^2}{4} + \\frac{1-2\\eta+\\eta^2}{4} = \\frac{2+2\\eta^2}{4} = \\frac{1+\\eta^2}{2}$。\n\n绝对摩尔焓为：\n$$h_{\\mathrm{abs}}(\\eta) = \\frac{z}{2} \\left[ (y_{\\mathrm{A}}^{\\alpha} y_{\\mathrm{A}}^{\\beta}) W_{\\mathrm{AA}} + (y_{\\mathrm{B}}^{\\alpha} y_{\\mathrm{B}}^{\\beta}) W_{\\mathrm{BB}} + (y_{\\mathrm{A}}^{\\alpha} y_{\\mathrm{B}}^{\\beta} + y_{\\mathrm{B}}^{\\alpha} y_{\\mathrm{A}}^{\\beta}) W_{\\mathrm{AB}} \\right]$$\n$$h_{\\mathrm{abs}}(\\eta) = \\frac{z}{2} \\left[ \\frac{1-\\eta^2}{4} W_{\\mathrm{AA}} + \\frac{1-\\eta^2}{4} W_{\\mathrm{BB}} + \\frac{1+\\eta^2}{2} W_{\\mathrm{AB}} \\right]$$\n混合焓 $h_{\\mathrm{ord}}(\\eta)$ 通过从纯组元机械混合物的参考焓 $h_{\\mathrm{ref}} = x_{\\mathrm{A}} h_{\\mathrm{A}}^{\\circ} + x_{\\mathrm{B}} h_{\\mathrm{B}}^{\\circ}$ 中减去得到。对于等原子比成分（$x_{\\mathrm{A}}=x_{\\mathrm{B}}=0.5$），且 $h_{\\mathrm{A}}^{\\circ} = \\frac{z}{2}W_{\\mathrm{AA}}$ 和 $h_{\\mathrm{B}}^{\\circ} = \\frac{z}{2}W_{\\mathrm{BB}}$，我们有 $h_{\\mathrm{ref}} = \\frac{1}{2}(\\frac{z}{2}W_{\\mathrm{AA}}) + \\frac{1}{2}(\\frac{z}{2}W_{\\mathrm{BB}}) = \\frac{z}{4}(W_{\\mathrm{AA}} + W_{\\mathrm{BB}})$。\n$$h_{\\mathrm{ord}}(\\eta) = h_{\\mathrm{abs}}(\\eta) - h_{\\mathrm{ref}} = \\frac{z}{8} \\left[ (1-\\eta^2)(W_{\\mathrm{AA}}+W_{\\mathrm{BB}}) + 2(1+\\eta^2)W_{\\mathrm{AB}} - 2(W_{\\mathrm{AA}}+W_{\\mathrm{BB}}) \\right]$$\n$$h_{\\mathrm{ord}}(\\eta) = \\frac{z}{8} \\left[ (2W_{\\mathrm{AB}} - W_{\\mathrm{AA}} - W_{\\mathrm{BB}}) + \\eta^2(2W_{\\mathrm{AB}} - W_{\\mathrm{AA}} - W_{\\mathrm{BB}}) \\right]$$\n使用正则溶体参数的定义 $\\Omega = z(W_{\\mathrm{AB}} - \\frac{W_{\\mathrm{AA}}+W_{\\mathrm{BB}}}{2})$，上式可简化为：\n$$h_{\\mathrm{ord}}(\\eta) = \\frac{1+\\eta^2}{4} z \\left( W_{\\mathrm{AB}} - \\frac{W_{\\mathrm{AA}}+W_{\\mathrm{BB}}}{2} \\right) = \\frac{\\Omega}{4}(1+\\eta^2)$$\n\n接下来，我们基于每个亚晶格上的理想混合来构建摩尔构型熵 $s_{\\mathrm{ord}}(\\eta)$。总熵是来自 $\\alpha$ 和 $\\beta$ 亚晶格贡献的总和，每个亚晶格每摩尔合金含有0.5摩尔的格点。\n$$s_{\\mathrm{ord}}(\\eta) = -0.5R \\left( y_{\\mathrm{A}}^{\\alpha} \\ln y_{\\mathrm{A}}^{\\alpha} + y_{\\mathrm{B}}^{\\alpha} \\ln y_{\\mathrm{B}}^{\\alpha} \\right) - 0.5R \\left( y_{\\mathrm{A}}^{\\beta} \\ln y_{\\mathrm{A}}^{\\beta} + y_{\\mathrm{B}}^{\\beta} \\ln y_{\\mathrm{B}}^{\\beta} \\right)$$\n代入格点分数：\n$$s_{\\mathrm{ord}}(\\eta) = -0.5R \\left( \\frac{1+\\eta}{2}\\ln\\frac{1+\\eta}{2} + \\frac{1-\\eta}{2}\\ln\\frac{1-\\eta}{2} \\right) - 0.5R \\left( \\frac{1-\\eta}{2}\\ln\\frac{1-\\eta}{2} + \\frac{1+\\eta}{2}\\ln\\frac{1+\\eta}{2} \\right)$$\n$$s_{\\mathrm{ord}}(\\eta) = -R \\left[ \\frac{1+\\eta}{2}\\ln\\left(\\frac{1+\\eta}{2}\\right) + \\frac{1-\\eta}{2}\\ln\\left(\\frac{1-\\eta}{2}\\right) \\right]$$\n这可以改写为：\n$$s_{\\mathrm{ord}}(\\eta) = -R \\left[ \\frac{1+\\eta}{2}\\ln(1+\\eta) + \\frac{1-\\eta}{2}\\ln(1-\\eta) - \\ln(2) \\right]$$\n\n有序相的吉布斯能量为 $g_{\\mathrm{ord}}(\\eta) = h_{\\mathrm{ord}}(\\eta) - T s_{\\mathrm{ord}}(\\eta)$:\n$$g_{\\mathrm{ord}}(\\eta) = \\frac{\\Omega}{4}(1+\\eta^2) + RT \\left[ \\frac{1+\\eta}{2}\\ln(1+\\eta) + \\frac{1-\\eta}{2}\\ln(1-\\eta) - \\ln(2) \\right]$$\n\n无序相的吉布斯能量 $g_{\\mathrm{dis}}$ 对应于 $\\eta=0$ 的状态：\n$$g_{\\mathrm{dis}} = g_{\\mathrm{ord}}(0) = \\frac{\\Omega}{4} - RT\\ln(2)$$\n\n有序化驱动力定义为 $\\Delta g(\\eta, T) \\equiv g_{\\mathrm{dis}} - g_{\\mathrm{ord}}(\\eta):$\n$$\\Delta g(\\eta, T) = \\left( \\frac{\\Omega}{4} - RT\\ln(2) \\right) - \\left( \\frac{\\Omega}{4}(1+\\eta^2) + RT \\left[ \\frac{1+\\eta}{2}\\ln(1+\\eta) + \\frac{1-\\eta}{2}\\ln(1-\\eta) - \\ln(2) \\right] \\right)$$\n$$\\Delta g(\\eta, T) = -\\frac{\\Omega}{4}\\eta^2 - RT \\left[ \\frac{1+\\eta}{2}\\ln(1+\\eta) + \\frac{1-\\eta}{2}\\ln(1-\\eta) \\right]$$\n\n为了找到小 $\\eta$ 时的行为，我们使用泰勒展开 $\\ln(1+x) = x - x^2/2 + x^3/3 - x^4/4 + O(x^5):$\n$$\\frac{1+\\eta}{2}\\ln(1+\\eta) = \\frac{1}{2}(1+\\eta)\\left(\\eta - \\frac{\\eta^2}{2} + \\frac{\\eta^3}{3} - \\frac{\\eta^4}{4} + \\dots \\right) = \\frac{1}{2}\\left(\\eta + \\frac{\\eta^2}{2} - \\frac{\\eta^3}{6} + \\frac{\\eta^4}{12} + \\dots \\right)$$\n$$\\frac{1-\\eta}{2}\\ln(1-\\eta) = \\frac{1}{2}(1-\\eta)\\left(-\\eta - \\frac{\\eta^2}{2} - \\frac{\\eta^3}{3} - \\frac{\\eta^4}{4} + \\dots \\right) = \\frac{1}{2}\\left(-\\eta + \\frac{\\eta^2}{2} + \\frac{\\eta^3}{6} + \\frac{\\eta^4}{12} + \\dots \\right)$$\n将这两项相加得到：\n$$\\frac{1+\\eta}{2}\\ln(1+\\eta) + \\frac{1-\\eta}{2}\\ln(1-\\eta) = \\frac{\\eta^2}{2} + \\frac{\\eta^4}{12} + O(\\eta^6)$$\n将此展开式代入 $\\Delta g(\\eta, T)$ 的表达式中：\n$$\\Delta g(\\eta, T) = -\\frac{\\Omega}{4}\\eta^2 - RT \\left( \\frac{\\eta^2}{2} + \\frac{\\eta^4}{12} + O(\\eta^6) \\right) = -\\left(\\frac{\\Omega}{4} + \\frac{RT}{2}\\right)\\eta^2 - \\frac{RT}{12}\\eta^4 - O(\\eta^6)$$\n精确到 $\\eta$ 的领先非平凡阶的有序化驱动力为：\n$$\\Delta g(\\eta, T) \\approx -\\left(\\frac{\\Omega}{4} + \\frac{RT}{2}\\right)\\eta^2$$\n\n临界有序-无序转变温度 $T_c$ 是无序相（$\\eta=0$）的稳定性发生变化的温度。这发生在吉布斯能量展开式 $g_{\\mathrm{ord}}(\\eta) - g_{\\mathrm{dis}}$ 中 $\\eta^2$ 项的系数随着温度降低从正变负时。该系数为 $(\\frac{\\Omega}{4} + \\frac{RT}{2})$。通过将此系数设为零可以求得临界温度。请注意，这等同于找到使 $\\Delta g(\\eta, T)$ 的首项消失的温度。\n$$\\frac{\\Omega}{4} + \\frac{RT_c}{2} = 0$$\n求解 $T_c$：\n$$T_c = -\\frac{\\Omega}{2R}$$\n\n最后，我们使用给定的数值 $\\Omega = -3.20 \\times 10^{4} \\text{ J/mol}$ 和 $R = 8.314462618 \\text{ J/(mol}\\cdot\\text{K)}$ 对 $T_c$ 进行数值计算。\n$$T_c = -\\frac{-3.20 \\times 10^{4} \\text{ J/mol}}{2 \\times 8.314462618 \\text{ J/(mol}\\cdot\\text{K)}} = \\frac{3.20 \\times 10^{4}}{16.628925236} \\text{ K}$$\n$$T_c \\approx 1924.340 \\text{ K}$$\n将结果四舍五入到四位有效数字，得到 $1924 \\text{ K}$。", "answer": "$$\\boxed{1924}$$", "id": "2471433"}, {"introduction": "在单个相的吉布斯自由能曲线概念基础上，本练习将探讨稳定相和亚稳相之间的竞争，这是材料加工中常见的场景。通过计算两种相稳定性发生交叉的成分点，您将深入理解为何亚稳相会优先形成，这一原理即奥斯特瓦尔德分步规则（Ostwald's rule of stages）。这项练习将热力学模型与预测析出路径直接联系起来。[@problem_id:2471379]", "problem": "一种由组分 $A$ 和 $B$ 构成的二元置换型合金在相图计算 (CALPHAD) 框架下进行建模。可能存在两种相互竞争的析出相：亚稳相 $M$ 和热力学稳定相 $S$。每个相都被视为置换固溶体，其摩尔吉布斯能由一阶 Redlich–Kister 展开式描述。在固定温度 $T = 900\\ \\mathrm{K}$ 和标准压力下，这两个相的摩尔吉布斯能（每摩尔原子位置）作为 $B$ 的摩尔分数 $x \\in (0,1)$ 的函数，表示为\n$$\ng_{M}(x,T) \\,=\\, (1-x)\\,g_{A}^{0}(T) \\,+\\, x\\,g_{B}^{0}(T) \\,+\\, R T\\big[x\\ln x + (1-x)\\ln(1-x)\\big] \\,+\\, x(1-x)\\Big(L_{0}^{M} + L_{1}^{M}\\,(1-2x)\\Big),\n$$\n$$\ng_{S}(x,T) \\,=\\, (1-x)\\,g_{A}^{0}(T) \\,+\\, x\\,g_{B}^{0}(T) \\,+\\, \\Delta g^{0} \\,+\\, R T\\big[x\\ln x + (1-x)\\ln(1-x)\\big] \\,+\\, x(1-x)\\Big(L_{0}^{S} + L_{1}^{S}\\,(1-2x)\\Big),\n$$\n其中 $R$ 是通用气体常数，$g_{A}^{0}(T)$ 和 $g_{B}^{0}(T)$ 是端元吉布斯能（在 $M$ 和 $S$ 之间相同），$\\Delta g^{0}$ 是由于晶格稳定性不同而引起的 $M$ 和 $S$ 之间的温变偏移量。在 $T=900\\ \\mathrm{K}$ 时，评估得到的相互作用参数和偏移量为\n$$\nL_{0}^{M} = -2.0\\times 10^{4}\\ \\mathrm{J\\,mol^{-1}},\\quad L_{1}^{M} = 5.0\\times 10^{3}\\ \\mathrm{J\\,mol^{-1}},\n$$\n$$\nL_{0}^{S} = -3.0\\times 10^{4}\\ \\mathrm{J\\,mol^{-1}},\\quad L_{1}^{S} = -1.0\\times 10^{4}\\ \\mathrm{J\\,mol^{-1}},\n$$\n$$\n\\Delta g^{0} = 3.0\\times 10^{3}\\ \\mathrm{J\\,mol^{-1}}.\n$$\n假设在所关注的成分范围内，$M$ 的亚稳延伸和稳定相 $S$ 都能得到有意义的评估。重点关注控制早期析出的富 $A$ 区域，确定使 $g_{M}(x,900\\ \\mathrm{K}) = g_{S}(x,900\\ \\mathrm{K})$ 成立的成分 $x \\in (0,0.4)$。将您的答案表示为 $B$ 的十进制摩尔分数，并四舍五入到四位有效数字。\n\n然后，基于固定 $T$ 和压力下吉布斯能最小化的第一性原理，简要解释该交点对于淬火至此温度的富 $A$ 合金中析出序列的意义。您的解释应该是定性的，并根据所建模的吉布斯能中固有的热力学驱动力进行论证；不要引入任何动力学参数。该解释不影响数值答案，数值答案必须按上述规定报告。", "solution": "为了找到两相吉布斯能相等的成分 $x$，我们令 $g_{M}(x,T) = g_{S}(x,T)$。\n$$\n(1-x)\\,g_{A}^{0}(T) \\,+\\, x\\,g_{B}^{0}(T) \\,+\\, RT\\big[x\\ln x + (1-x)\\ln(1-x)\\big] \\,+\\, x(1-x)\\Big(L_{0}^{M} + L_{1}^{M}\\,(1-2x)\\Big) \\\\\n= (1-x)\\,g_{A}^{0}(T) \\,+\\, x\\,g_{B}^{0}(T) \\,+\\, \\Delta g^{0} \\,+\\, RT\\big[x\\ln x + (1-x)\\ln(1-x)\\big] \\,+\\, x(1-x)\\Big(L_{0}^{S} + L_{1}^{S}\\,(1-2x)\\Big)\n$$\n纯组分的吉布斯能项 $(1-x)\\,g_{A}^{0}(T) + x\\,g_{B}^{0}(T)$ 和理想混合熵项 $RT\\big[x\\ln x + (1-x)\\ln(1-x)\\big]$ 对于两相是相同的，因此可以消去。方程简化为过剩吉布斯能项与偏移量 $\\Delta g^{0}$ 之间的等式：\n$$\nx(1-x)\\Big(L_{0}^{M} + L_{1}^{M}\\,(1-2x)\\Big) = \\Delta g^{0} + x(1-x)\\Big(L_{0}^{S} + L_{1}^{S}\\,(1-2x)\\Big)\n$$\n重新整理各项以求解 $x$：\n$$\nx(1-x)\\Big[\\big(L_{0}^{M} - L_{0}^{S}\\big) + \\big(L_{1}^{M} - L_{1}^{S}\\big)(1-2x)\\Big] - \\Delta g^{0} = 0\n$$\n我们定义 $\\Delta L_{0} = L_{0}^{M} - L_{0}^{S}$ 和 $\\Delta L_{1} = L_{1}^{M} - L_{1}^{S}$。我们代入给定的数值：\n$$\n\\Delta L_{0} = (-2.0\\times 10^{4}) - (-3.0\\times 10^{4}) = 1.0\\times 10^{4}\\ \\mathrm{J\\,mol^{-1}}\n$$\n$$\n\\Delta L_{1} = (5.0\\times 10^{3}) - (-1.0\\times 10^{4}) = 1.5\\times 10^{4}\\ \\mathrm{J\\,mol^{-1}}\n$$\n$$\n\\Delta g^{0} = 3.0\\times 10^{3}\\ \\mathrm{J\\,mol^{-1}}\n$$\n方程变为：\n$$\nx(1-x)\\Big[1.0\\times 10^{4} + (1.5\\times 10^{4})(1-2x)\\Big] - 3.0\\times 10^{3} = 0\n$$\n展开表达式：\n$$\nx(1-x)\\Big[10000 + 15000 - 30000x\\Big] - 3000 = 0\n$$\n$$\n(x-x^2)(25000 - 30000x) - 3000 = 0\n$$\n$$\n25000x - 30000x^2 - 25000x^2 + 30000x^3 - 3000 = 0\n$$\n这得到了一个关于 $x$ 的三次多项式方程：\n$$\n30000x^3 - 55000x^2 + 25000x - 3000 = 0\n$$\n为简化起见，两边同除以 $1000$：\n$$\n30x^3 - 55x^2 + 25x - 3 = 0\n$$\n我们必须在区间 $x \\in (0, 0.4)$ 内找到这个三次多项式的根。对此方程在该区间内进行数值求解，得到的根为 $x_c \\approx 0.194133...$。按要求四舍五入到四位有效数字，得到 $x_c = 0.1941$。\n\n对于定性解释部分，我们分析 $g_M = g_S$ 的条件。差值 $g_M(x) - g_S(x)$ 的符号决定了在给定成分 $x$ 下哪个相是热力学上更稳定的。该差值由我们求解的多项式给出：\n$g_M(x) - g_S(x) = -3000 + 25000x - 55000x^2 + 30000x^3$.\n对于 $x \\to 0$，差值趋近于 $-3000\\ \\mathrm{J\\,mol^{-1}}$，这意味着对于非常小的 $x$，$g_M  g_S$。由于该函数是连续的，并在 $x_c \\approx 0.1941$ 处穿过零点，因此对于区间 $[0, x_c)$ 内的所有 $x$，都有 $g_M(x)  g_S(x)$。反之，对于 $x  x_c$（在该根的局部域内），$g_M(x)  g_S(x)$。\n\n富A合金中析出行为的意义取决于热力学驱动力。根据吉布斯能最小化原理，系统将沿着能够最大程度降低吉布斯能的路径演化。当一种富A合金（其成分 $x_0$ 远小于 $x_c$）被淬火时，它会变得过饱和，并开始析出一个新相。初生析出物核心的成分，我们称之为 $x_p$，也将在富A区域内。鉴于交点为 $x_c \\approx 0.1941$，可以合理地假设早期析出物的成分 $x_p  x_c$。在这个成分范围内，亚稳相 $M$ 的吉布斯能低于稳定相 $S$ 的吉布斯能，即 $g_M(x_p)  g_S(x_p)$。因此，相比于析出相 $S$，析出相 $M$ 提供了更大的热力学驱动力（系统总吉布斯能的更大降低）。因此，亚稳相 $M$ 预计将优先析出。这种系统通过一个或多个中间亚稳态来接近其最终平衡态的现象，是奥斯特瓦尔德分步规则 (Ostwald's rule of stages) 的一个例证。如果相 $S$ 在某个成为平衡态的不同成分下具有更低的吉布斯能，那么在更长的时效时间后，相 $M$ 的初始形成可能会伴随着向相 $S$ 的后续转变。", "answer": "$$\\boxed{0.1941}$$", "id": "2471379"}, {"introduction": "本练习旨在揭示 CALPHAD 软件“引擎盖之下”的奥秘，探索平衡态是如何被实际计算出来的。在这个高级实践中，您将为具有亚点阵有序的相建立并求解非线性方程组，以确定其内部平衡。您将亲手实现牛顿-拉弗森法这一强大的数值技术，从而理解热力学计算的计算核心。[@problem_id:2471384]", "problem": "您正在相图计算（CALPHAD）框架下，使用代表氯化铯（B2）结构的双亚点阵模型来模拟一个有序二元相。该相有两个相互贯穿的亚点阵，分别表示为 $\\alpha$ 和 $\\beta$，每个亚点阵都可被组分 $\\mathrm{A}$ 和 $\\mathrm{B}$ 占据。设每个亚点阵上的位分数为 $\\{y_{\\mathrm{A}}^{(\\alpha)}, y_{\\mathrm{B}}^{(\\alpha)}\\}$ 和 $\\{y_{\\mathrm{A}}^{(\\beta)}, y_{\\mathrm{B}}^{(\\beta)}\\}$，其中归一化约束 $y_{\\mathrm{A}}^{(\\alpha)} + y_{\\mathrm{B}}^{(\\alpha)} = 1$ 和 $y_{\\mathrm{A}}^{(\\beta)} + y_{\\mathrm{B}}^{(\\beta)} = 1$ 成立。定义 $y_{\\mathrm{A}}^{(\\alpha)}$ 和 $y_{\\mathrm{A}}^{(\\beta)}$ 为自变量，并使用 $y_{\\mathrm{B}}^{(\\alpha)} = 1 - y_{\\mathrm{A}}^{(\\alpha)}$ 和 $y_{\\mathrm{B}}^{(\\beta)} = 1 - y_{\\mathrm{A}}^{(\\beta)}$。\n\n在恒定的温度 $T$ 和压力 $P$ 下，平衡态是在组分 A 的总成分固定的约束下，使该相的摩尔吉布斯能量最小化的状态。对于一个 B2 相，其端元能量为 $G_{\\mathrm{A}:\\mathrm{A}}$、$G_{\\mathrm{A}:\\mathrm{B}}$、$G_{\\mathrm{B}:\\mathrm{A}}$ 和 $G_{\\mathrm{B}:\\mathrm{B}}$（均以每摩尔化学式单位计），在给定温度 $T$ 下，其摩尔吉布斯能量被建模为每个亚点阵上的理想构型项与端元能量的线性组合之和：\n$$\nG\\!\\left(y_{\\mathrm{A}}^{(\\alpha)}, y_{\\mathrm{A}}^{(\\beta)}; T\\right) =\ny_{\\mathrm{A}}^{(\\alpha)} y_{\\mathrm{A}}^{(\\beta)} G_{\\mathrm{A}:\\mathrm{A}}\n+ y_{\\mathrm{A}}^{(\\alpha)} \\left(1 - y_{\\mathrm{A}}^{(\\beta)}\\right) G_{\\mathrm{A}:\\mathrm{B}}\n+ \\left(1 - y_{\\mathrm{A}}^{(\\alpha)}\\right) y_{\\mathrm{A}}^{(\\beta)} G_{\\mathrm{B}:\\mathrm{A}}\n+ \\left(1 - y_{\\mathrm{A}}^{(\\alpha)}\\right) \\left(1 - y_{\\mathrm{A}}^{(\\beta)}\\right) G_{\\mathrm{B}:\\mathrm{B}} \\\\\n+ R T \\left[\ny_{\\mathrm{A}}^{(\\alpha)} \\ln y_{\\mathrm{A}}^{(\\alpha)} + \\left(1 - y_{\\mathrm{A}}^{(\\alpha)}\\right) \\ln \\left(1 - y_{\\mathrm{A}}^{(\\alpha)}\\right)\n+ y_{\\mathrm{A}}^{(\\beta)} \\ln y_{\\mathrm{A}}^{(\\beta)} + \\left(1 - y_{\\mathrm{A}}^{(\\beta)}\\right) \\ln \\left(1 - y_{\\mathrm{A}}^{(\\beta)}\\right)\n\\right],\n$$\n其中 $R$ 是普适气体常数。\n\n相中组分 A 的总成分 $x_{\\mathrm{A}}$，受具有相等亚点阵位点数的双亚点阵模型的化学计量关系约束：\n$$\n\\frac{1}{2}\\left(y_{\\mathrm{A}}^{(\\alpha)} + y_{\\mathrm{A}}^{(\\beta)}\\right) = x_{\\mathrm{A}}.\n$$\n\n在恒定 $T$ 和 $P$ 的条件下，从基本热力学出发，平衡对应于在成分约束下摩尔吉布斯能量的驻点。引入一个拉格朗日乘子 $\\lambda$ 来施加成分约束。设未知数向量为 $\\mathbf{u} = \\left[y_{\\mathrm{A}}^{(\\alpha)}, y_{\\mathrm{A}}^{(\\beta)}, \\lambda\\right]^{\\top}$。将平衡条件方程组 $\\mathbf{f}(\\mathbf{u}) = \\mathbf{0}$ 定义为拉格朗日函数相对于 $y_{\\mathrm{A}}^{(\\alpha)}$ 和 $y_{\\mathrm{A}}^{(\\beta)}$ 的驻点条件，以及成分约束。\n\n您的任务是：\n- 基于给定的 $G$，推导 $\\mathbf{f}(\\mathbf{u})$ 的分量和雅可比矩阵 $\\mathbf{J}(\\mathbf{u}) = \\partial \\mathbf{f} / \\partial \\mathbf{u}$ 的显式表达式。\n- 在固定的 $T$、$P$ 和 $x_{\\mathrm{A}}$ 条件下，实现牛顿法求解 $\\mathbf{f}(\\mathbf{u}) = \\mathbf{0}$ 得到 $\\mathbf{u}$，使用回溯线搜索以确保迭代值满足 $y_{\\mathrm{A}}^{(\\alpha)}, y_{\\mathrm{A}}^{(\\beta)} \\in (0,1)$ 并促进收敛。\n- 使用以下收敛判据：当残差的欧几里得范数满足 $\\|\\mathbf{f}(\\mathbf{u})\\|_{2} \\leq 10^{-10}$ 且牛顿步长的无穷范数满足 $\\|\\Delta \\mathbf{u}\\|_{\\infty} \\leq 10^{-12}$ 时，或达到最大迭代次数 $100$ 次时停止。\n- 使用普适气体常数 $R = 8.314462618\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$。\n- 使用由 $y_{\\mathrm{A}}^{(\\alpha,0)} = \\min\\{\\max\\{x_{\\mathrm{A}} + 0.1, \\epsilon\\}, 1 - \\epsilon\\}$、$y_{\\mathrm{A}}^{(\\beta,0)} = \\min\\{\\max\\{2 x_{\\mathrm{A}} - y_{\\mathrm{A}}^{(\\alpha,0)}, \\epsilon\\}, 1 - \\epsilon\\}$ 和 $\\lambda^{(0)} = 0$ 给出的初始猜测值，其中 $\\epsilon = 10^{-12}$。\n- 在计算 $G$ 及其导数时，通过在内部将位分数限制在 $[\\epsilon, 1 - \\epsilon]$ 区间内，实现对数的安全求值。\n\n物理单位：\n- 温度 $T$ 以 $\\mathrm{K}$ 为单位。\n- 能量 $G_{\\mathrm{i}:\\mathrm{j}}$ 以 $\\mathrm{J}\\,\\mathrm{mol}^{-1}$ 为单位。\n- 位分数 $y_{\\mathrm{A}}^{(\\alpha)}$ 和 $y_{\\mathrm{A}}^{(\\beta)}$ 是无量纲的。\n\n角度单位不适用于此问题。不要报告百分比。\n\n测试套件：\n- 情况 1：$T = 1000\\,\\mathrm{K}$，$x_{\\mathrm{A}} = 0.5$，$\\left(G_{\\mathrm{A}:\\mathrm{A}}, G_{\\mathrm{A}:\\mathrm{B}}, G_{\\mathrm{B}:\\mathrm{A}}, G_{\\mathrm{B}:\\mathrm{B}}\\right) = \\left(2000, 0, 0, 2000\\right)\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}$。\n- 情况 2：$T = 5000\\,\\mathrm{K}$，$x_{\\mathrm{A}} = 0.5$，$\\left(G_{\\mathrm{A}:\\mathrm{A}}, G_{\\mathrm{A}:\\mathrm{B}}, G_{\\mathrm{B}:\\mathrm{A}}, G_{\\mathrm{B}:\\mathrm{B}}\\right) = \\left(2000, 0, 0, 2000\\right)\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}$。\n- 情况 3：$T = 1200\\,\\mathrm{K}$，$x_{\\mathrm{A}} = 0.6$，$\\left(G_{\\mathrm{A}:\\mathrm{A}}, G_{\\mathrm{A}:\\mathrm{B}}, G_{\\mathrm{B}:\\mathrm{A}}, G_{\\mathrm{B}:\\mathrm{B}}\\right) = \\left(2000, 0, 0, 2000\\right)\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}$。\n- 情况 4：$T = 1200\\,\\mathrm{K}$，$x_{\\mathrm{A}} = 0.01$，$\\left(G_{\\mathrm{A}:\\mathrm{A}}, G_{\\mathrm{A}:\\mathrm{B}}, G_{\\mathrm{B}:\\mathrm{A}}, G_{\\mathrm{B}:\\mathrm{B}}\\right) = \\left(2000, 0, 0, 2000\\right)\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}$。\n- 情况 5：$T = 800\\,\\mathrm{K}$，$x_{\\mathrm{A}} = 0.3$，$\\left(G_{\\mathrm{A}:\\mathrm{A}}, G_{\\mathrm{A}:\\mathrm{B}}, G_{\\mathrm{B}:\\mathrm{A}}, G_{\\mathrm{B}:\\mathrm{B}}\\right) = \\left(0, 0, 0, 0\\right)\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}$。\n\n您的程序必须计算每个测试用例的平衡值 $\\left(y_{\\mathrm{A}}^{(\\alpha)}, y_{\\mathrm{A}}^{(\\beta)}\\right)$，使用如上所述的从第一性原理推导出的雅可比矩阵的牛顿法，然后生成单行输出，其中包含一个扁平的、逗号分隔的列表形式的所有结果，并用方括号括起来。对于上面列出的每个案例，顺序必须是先 $y_{\\mathrm{A}}^{(\\alpha)}$ 后 $y_{\\mathrm{A}}^{(\\beta)}$。将每个位分数表示为小数，四舍五入到小数点后八位（无量纲）。例如，输出格式必须为\n$[\\text{yA\\_alpha\\_case1}, \\text{yA\\_beta\\_case1}, \\text{yA\\_alpha\\_case2}, \\text{yA\\_beta\\_case2}, \\dots]$。", "solution": "目标是找到在总成分 $x_{\\mathrm{A}}$ 固定的情况下，使摩尔吉布斯能量 $G$ 最小化的平衡位分数 $y_{\\mathrm{A}}^{(\\alpha)}$ 和 $y_{\\mathrm{A}}^{(\\beta)}$。为简洁起见，令 $y_1 \\equiv y_{\\mathrm{A}}^{(\\alpha)}$ 和 $y_2 \\equiv y_{\\mathrm{A}}^{(\\beta)}$。\n\n摩尔吉布斯能量由下式给出：\n$$\nG(y_1, y_2; T) =\ny_1 y_2 G_{\\mathrm{A}:\\mathrm{A}}\n+ y_1 (1 - y_2) G_{\\mathrm{A}:\\mathrm{B}}\n+ (1 - y_1) y_2 G_{\\mathrm{B}:\\mathrm{A}}\n+ (1 - y_1) (1 - y_2) G_{\\mathrm{B}:\\mathrm{B}} \\\\\n+ R T \\left[\ny_1 \\ln y_1 + (1 - y_1) \\ln(1 - y_1)\n+ y_2 \\ln y_2 + (1 - y_2) \\ln(1 - y_2)\n\\right]\n$$\n此最小化问题受总成分约束：\n$$\nc(y_1, y_2) = \\frac{1}{2}(y_1 + y_2) - x_{\\mathrm{A}} = 0\n$$\n\n为了解决这个约束优化问题，我们引入一个拉格朗日乘子 $\\lambda$ 并构造拉格朗日函数 $\\mathcal{L}$：\n$$\n\\mathcal{L}(y_1, y_2, \\lambda) = G(y_1, y_2; T) + \\lambda \\left(\\frac{1}{2}(y_1 + y_2) - x_{\\mathrm{A}}\\right)\n$$\n平衡态对应于拉格朗日函数的一个驻点，通过将其关于变量 $y_1$、$y_2$ 和 $\\lambda$ 的偏导数设为零来找到。这产生了一个由三个非线性方程组成的方程组 $\\mathbf{f}(\\mathbf{u}) = \\mathbf{0}$，其中 $\\mathbf{u} = [y_1, y_2, \\lambda]^{\\top}$。\n\n残差向量 $\\mathbf{f}(\\mathbf{u}) = [f_1, f_2, f_3]^{\\top}$ 的分量是：\n\n1. $f_1 = \\frac{\\partial \\mathcal{L}}{\\partial y_1} = \\frac{\\partial G}{\\partial y_1} + \\frac{\\lambda}{2} = 0$。\n$G$ 关于 $y_1$ 的偏导数为：\n$$\n\\frac{\\partial G}{\\partial y_1} = y_2 G_{\\mathrm{A}:\\mathrm{A}} + (1 - y_2) G_{\\mathrm{A}:\\mathrm{B}} - y_2 G_{\\mathrm{B}:\\mathrm{A}} - (1 - y_2) G_{\\mathrm{B}:\\mathrm{B}} + RT \\left(\\ln y_1 - \\ln(1 - y_1)\\right)\n$$\n因此，第一个方程是：\n$$\nf_1(y_1, y_2, \\lambda) = y_2(G_{\\mathrm{A}:\\mathrm{A}} - G_{\\mathrm{B}:\\mathrm{A}}) + (1-y_2)(G_{\\mathrm{A}:\\mathrm{B}} - G_{\\mathrm{B}:\\mathrm{B}}) + RT\\ln\\left(\\frac{y_1}{1-y_1}\\right) + \\frac{\\lambda}{2} = 0\n$$\n\n2. $f_2 = \\frac{\\partial \\mathcal{L}}{\\partial y_2} = \\frac{\\partial G}{\\partial y_2} + \\frac{\\lambda}{2} = 0$。\n$G$ 关于 $y_2$ 的偏导数为：\n$$\n\\frac{\\partial G}{\\partial y_2} = y_1 G_{\\mathrm{A}:\\mathrm{A}} - y_1 G_{\\mathrm{A}:\\mathrm{B}} + (1 - y_1) G_{\\mathrm{B}:\\mathrm{A}} - (1 - y_1) G_{\\mathrm{B}:\\mathrm{B}} + RT \\left(\\ln y_2 - \\ln(1 - y_2)\\right)\n$$\n因此，第二个方程是：\n$$\nf_2(y_1, y_2, \\lambda) = y_1(G_{\\mathrm{A}:\\mathrm{A}} - G_{\\mathrm{A}:\\mathrm{B}}) + (1-y_1)(G_{\\mathrm{B}:\\mathrm{A}} - G_{\\mathrm{B}:\\mathrm{B}}) + RT\\ln\\left(\\frac{y_2}{1-y_2}\\right) + \\frac{\\lambda}{2} = 0\n$$\n\n3. $f_3 = \\frac{\\partial \\mathcal{L}}{\\partial \\lambda} = \\frac{1}{2}(y_1 + y_2) - x_{\\mathrm{A}} = 0$。\n这只是恢复了成分约束。\n\n为了实现牛顿法，我们还必须推导雅可比矩阵 $\\mathbf{J}(\\mathbf{u}) = \\frac{\\partial \\mathbf{f}}{\\partial \\mathbf{u}}$。分量 $J_{ij} = \\frac{\\partial f_i}{\\partial u_j}$ 的计算如下。为清晰起见，我们定义相互作用参数 $L_{\\mathrm{AB}} = G_{\\mathrm{A}:\\mathrm{A}} - G_{\\mathrm{A}:\\mathrm{B}} - G_{\\mathrm{B}:\\mathrm{A}} + G_{\\mathrm{B}:\\mathrm{B}}$。\n\n$J_{11} = \\frac{\\partial f_1}{\\partial y_1} = RT \\frac{\\partial}{\\partial y_1}\\ln\\left(\\frac{y_1}{1-y_1}\\right) = RT\\left(\\frac{1}{y_1} + \\frac{1}{1-y_1}\\right) = \\frac{RT}{y_1(1-y_1)}$\n$J_{12} = \\frac{\\partial f_1}{\\partial y_2} = (G_{\\mathrm{A}:\\mathrm{A}} - G_{\\mathrm{B}:\\mathrm{A}}) - (G_{\\mathrm{A}:\\mathrm{B}} - G_{\\mathrm{B}:\\mathrm{B}}) = G_{\\mathrm{A}:\\mathrm{A}} - G_{\\mathrm{A}:\\mathrm{B}} - G_{\\mathrm{B}:\\mathrm{A}} + G_{\\mathrm{B}:\\mathrm{B}}$\n$J_{13} = \\frac{\\partial f_1}{\\partial \\lambda} = \\frac{1}{2}$\n\n$J_{21} = \\frac{\\partial f_2}{\\partial y_1} = (G_{\\mathrm{A}:\\mathrm{A}} - G_{\\mathrm{A}:\\mathrm{B}}) - (G_{\\mathrm{B}:\\mathrm{A}} - G_{\\mathrm{B}:\\mathrm{B}}) = G_{\\mathrm{A}:\\mathrm{A}} - G_{\\mathrm{A}:\\mathrm{B}} - G_{\\mathrm{B}:\\mathrm{A}} + G_{\\mathrm{B}:\\mathrm{B}}$\n$J_{22} = \\frac{\\partial f_2}{\\partial y_2} = RT \\frac{\\partial}{\\partial y_2}\\ln\\left(\\frac{y_2}{1-y_2}\\right) = RT\\left(\\frac{1}{y_2} + \\frac{1}{1-y_2}\\right) = \\frac{RT}{y_2(1-y_2)}$\n$J_{23} = \\frac{\\partial f_2}{\\partial \\lambda} = \\frac{1}{2}$\n\n$J_{31} = \\frac{\\partial f_3}{\\partial y_1} = \\frac{1}{2}$\n$J_{32} = \\frac{\\partial f_3}{\\partial y_2} = \\frac{1}{2}$\n$J_{33} = \\frac{\\partial f_3}{\\partial \\lambda} = 0$\n\n完整的雅可比矩阵是：\n$$\n\\mathbf{J}(\\mathbf{u}) = \\begin{pmatrix}\n\\frac{RT}{y_1(1-y_1)}  G_{\\mathrm{A}:\\mathrm{A}} - G_{\\mathrm{A}:\\mathrm{B}} - G_{\\mathrm{B}:\\mathrm{A}} + G_{\\mathrm{B}:\\mathrm{B}}  \\frac{1}{2} \\\\\nG_{\\mathrm{A}:\\mathrm{A}} - G_{\\mathrm{A}:\\mathrm{B}} - G_{\\mathrm{B}:\\mathrm{A}} + G_{\\mathrm{B}:\\mathrm{B}}  \\frac{RT}{y_2(1-y_2)}  \\frac{1}{2} \\\\\n\\frac{1}{2}  \\frac{1}{2}  0\n\\end{pmatrix}\n$$\n左上角 $2 \\times 2$ 块的对称性（$J_{12} = J_{21}$）是麦克斯韦关系的推论，因为它构成了吉布斯能量函数的海森矩阵。\n\n数值求解通过牛顿法进行。从初始猜测值 $\\mathbf{u}^{(0)}$ 开始，每次迭代 $k$ 通过求解线性系统 $\\mathbf{J}(\\mathbf{u}^{(k)}) \\Delta \\mathbf{u}^{(k)} = -\\mathbf{f}(\\mathbf{u}^{(k)})$ 计算修正量 $\\Delta \\mathbf{u}^{(k)}$。通过 $\\mathbf{u}^{(k+1)} = \\mathbf{u}^{(k)} + \\alpha \\Delta \\mathbf{u}^{(k)}$ 找到新的估计值，其中 $\\alpha \\in (0, 1]$ 是由回溯线搜索确定的步长。线搜索减小 $\\alpha$（例如，通过减半），直到建议的步长能得到物理上有意义的位分数（即 $y_1, y_2 \\in (0, 1)$）并促进收敛，这在实践中是通过要求残差向量的范数 $\\|\\mathbf{f}\\|_2$ 减小来实现的。为了数值稳定性，在计算对数项和分母项时，位分数被限制在一个小区间 $[\\epsilon, 1-\\epsilon]$ 内。该过程持续进行，直到满足指定的关于残差范数和步长的收敛判据，或达到最大迭代次数。", "answer": "[0.50000000,0.50000000,0.50000000,0.50000000,0.60000000,0.60000000,0.01000000,0.01000000,0.30000000,0.30000000]", "id": "2471384"}]}