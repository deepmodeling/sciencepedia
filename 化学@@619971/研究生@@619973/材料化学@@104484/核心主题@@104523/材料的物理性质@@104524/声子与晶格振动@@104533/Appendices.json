{"hands_on_practices": [{"introduction": "理论学习的最佳伙伴是动手实践。本章节将通过一系列精心设计的练习，引导你从基本原理出发，逐步深入理解晶格振动的核心概念。第一个练习将带你回到起点：一个无限长的一维单原子链。通过应用牛顿第二定律，你将亲手推导出声子的色散关系——描述其频率 $\\omega$ 与波矢 $q$ 之间依赖关系的基本方程。这个基础练习是理解晶格动力学理论的基石，它清晰地展示了如何从一个简单的经典力学模型中涌现出集体性的波动行为。[@problem_id:2508311]", "problem": "考虑一个由质量为 $m$ 的相同原子组成的无限一维单原子链，它们以晶格常数 $a$ 排列，并通过力常数为 $C$ 的谐振子弹簧仅与其最近邻原子耦合。假设位移很小，使得谐波近似有效，并利用牛顿第二定律以及线性的最近邻恢复力来模拟其动力学。仅使用这些基本原理，推导声子色散关系 $\\omega(q)$，作为第一布里渊区中晶体波矢 $q$ 的函数。将最终结果表示为关于 $q$、$m$、$C$ 和 $a$ 的单个简化的解析函数。三角函数的参数使用弧度制。最终答案必须是 $\\omega(q)$ 的单个封闭形式表达式。", "solution": "所述问题是有效的。这是一个固态物理学中基本且适定的问题，具有科学依据和客观性。它包含了获得唯一解所需的所有必要信息。我们开始推导。\n\n该系统是一个无限长的一维原子链，每个原子的质量为 $m$，其平衡位置为 $x_n = na$，其中 $n$ 是整数，$a$ 是晶格常数。设 $u_n(t)$ 表示第 $n$ 个原子在时间 $t$ 偏离其平衡位置的微小纵向位移。\n\n在谐波近似下，原子所受的力与连接其与邻近原子的化学键的伸长量成线性关系。我们只考虑与弹簧常数为 $C$ 的最近邻相互作用。第 $n$ 个原子受到第 $(n+1)$ 个原子的力是 $C(u_{n+1} - u_n)$。第 $n$ 个原子受到第 $(n-1)$ 个原子的力是 $C(u_{n-1} - u_n)$。\n\n第 $n$ 个原子所受的总力 $F_n$ 是这两个恢复力之和：\n$$F_n = C(u_{n+1} - u_n) + C(u_{n-1} - u_n) = C(u_{n+1} + u_{n-1} - 2u_n)$$\n\n根据牛顿第二定律，$F_n = m \\frac{d^2 u_n}{dt^2}$。由此得出第 $n$ 个原子的运动方程：\n$$m \\frac{d^2 u_n}{dt^2} = C(u_{n+1} + u_{n-1} - 2u_n)$$\n\n我们寻求位移的集体波状解（声子）。我们假设一个平面波解，其形式为：\n$$u_n(t) = U \\exp[i(q x_n - \\omega t)]$$\n其中 $U$ 是振幅，$q$ 是波矢，$\\omega$ 是角频率。代入平衡位置 $x_n = na$，得到：\n$$u_n(t) = U \\exp[i(qna - \\omega t)]$$\n\n为了将此解代入运动方程，我们找到其邻近原子位移 $u_{n+1}$ 和 $u_{n-1}$ 以及第 $n$ 个原子加速度的表达式。\n$$u_{n+1}(t) = U \\exp[i(q(n+1)a - \\omega t)] = U \\exp[i(qna - \\omega t)] \\exp(iqa) = u_n(t) \\exp(iqa)$$\n$$u_{n-1}(t) = U \\exp[i(q(n-1)a - \\omega t)] = U \\exp[i(qna - \\omega t)] \\exp(-iqa) = u_n(t) \\exp(-iqa)$$\n$u_n(t)$ 对时间的二阶导数是：\n$$\\frac{d^2 u_n}{dt^2} = (-i\\omega)^2 U \\exp[i(qna - \\omega t)] = -\\omega^2 u_n(t)$$\n\n将这些表达式代入运动方程，得到：\n$$m(-\\omega^2 u_n) = C(u_n \\exp(iqa) + u_n \\exp(-iqa) - 2u_n)$$\n\n对于存在位移的非平凡解（$u_n \\neq 0$），我们可以将整个方程两边都除以 $u_n$：\n$$-m\\omega^2 = C[\\exp(iqa) + \\exp(-iqa) - 2]$$\n\n使用欧拉公式 $\\exp(i\\theta) + \\exp(-i\\theta) = 2\\cos(\\theta)$，我们简化方括号中的项：\n$$-m\\omega^2 = C[2\\cos(qa) - 2] = -2C(1 - \\cos(qa))$$\n\n为了进一步简化，我们使用三角半角公式 $1 - \\cos(\\theta) = 2\\sin^2(\\frac{\\theta}{2})$：\n$$-m\\omega^2 = -2C \\left[ 2\\sin^2\\left(\\frac{qa}{2}\\right) \\right] = -4C\\sin^2\\left(\\frac{qa}{2}\\right)$$\n\n求解 $\\omega^2$，我们得到：\n$$\\omega^2 = \\frac{4C}{m} \\sin^2\\left(\\frac{qa}{2}\\right)$$\n\n通过取平方根得到色散关系 $\\omega(q)$。由于物理频率必须为非负值，我们取正根，这需要对正弦函数取绝对值：\n$$\\omega(q) = \\sqrt{\\frac{4C}{m} \\sin^2\\left(\\frac{qa}{2}\\right)} = 2\\sqrt{\\frac{C}{m}} \\left|\\sin\\left(\\frac{qa}{2}\\right)\\right|$$\n\n此表达式给出了角频率 $\\omega$ 作为波矢 $q$ 的函数，即一维单原子链的声子色散关系。该关系对任何 $q$ 都有效，但在第一布里渊区 $q \\in (-\\frac{\\pi}{a}, \\frac{\\pi}{a}]$ 内是唯一确定的。", "answer": "$$\\boxed{2\\sqrt{\\frac{C}{m}}\\left|\\sin\\left(\\frac{qa}{2}\\right)\\right|}$$", "id": "2508311"}, {"introduction": "在掌握了单原子链模型后，我们自然会问：当晶体的原胞中包含多个原子时，情况会如何变化？这个练习通过一个一维双原子链模型来回答这个问题，这是理解离子晶体（如 $NaCl$）或共价晶体（如 $Si$）振动谱的入门级模型。你将构建动力学矩阵，求解其本征值和本征矢量，并由此揭示两种截然不同的振动模式：声学模和光学模。通过分析原子在这些模式中的运动方式，你将深刻理解它们的物理差异以及为何光学模在与光的相互作用中扮演着重要角色。[@problem_id:2508278]", "problem": "考虑一个一维双原子基元，它可作为描述布里渊区中心处二元离子晶体的最简晶格动力学模型。设两个子晶格原子的质量分别为 $m_{1}$ 和 $m_{2}$，在谐振近似下，它们通过一个单一的谐振力常数 $K$ 连接。从小位移的牛顿第二定律出发，并使用质量加权坐标，将问题构建为关于质量加权动力学矩阵（其本征值等于角频率的平方）的本征值问题，请完成以下任务：\n\n- 对于这个双自由度系统，导出以 $K$、$m_{1}$ 和 $m_{2}$ 表示的 $2\\times 2$ 质量加权动力学矩阵 $\\mathbf{D}$。\n- 求解两个本征频率（以角频率 $\\omega$ 表示）以及在质量加权坐标空间中对应的归一化极化矢量。将每个极化矢量在质量加权坐标中归一化至单位欧几里得范数。\n- 解释哪个模式是声学模式，哪个是光学模式，并根据极化矢量映射回物理位移后的结构来证明您的判断。\n\n使用以下参数进行数值计算：$m_{1} = 3.817\\times 10^{-26}\\,\\mathrm{kg}$，$m_{2} = 5.887\\times 10^{-26}\\,\\mathrm{kg}$，以及 $K = 100\\,\\mathrm{N\\,m^{-1}}$。最后，计算光学模式的频率 $f_{\\mathrm{opt}} = \\omega_{\\mathrm{opt}}/(2\\pi)$，并以太赫兹 (THz) 为单位报告结果。将报告的数值答案四舍五入到四位有效数字。最终频率以 THz 表示。", "solution": "所给问题是晶格动力学中的一个标准的、适定的练习。它在科学上是合理的，并包含了获得唯一解所需的所有信息。我们将着手进行推导和计算。\n\n该问题描述了一个一维双原子晶体的简化模型，该模型被简化为一个双自由度系统，代表布里渊区中心（波矢 $q=0$）处单个单胞内的动力学行为。设两个原子的质量分别为 $m_{1}$ 和 $m_{2}$，它们偏离平衡位置的小位移分别为 $u_{1}$ 和 $u_{2}$。这些原子通过一个力常数为 $K$ 的谐振相互作用连接。\n\n根据牛顿第二定律，两个原子的运动方程为：\n$$\nm_{1} \\frac{d^{2}u_{1}}{dt^{2}} = F_{1} = K(u_{2} - u_{1})\n$$\n$$\nm_{2} \\frac{d^{2}u_{2}}{dt^{2}} = F_{2} = K(u_{1} - u_{2})\n$$\n我们寻找形式为 $u_{j}(t) = U_{j} \\exp(-i\\omega t)$（其中 $j \\in \\{1, 2\\}$）的谐振解，这里 $U_{j}$ 是位移振幅，$\\omega$ 是角频率。将这些解代入运动方程，得到：\n$$\n-m_{1}\\omega^{2}U_{1} = K(U_{2} - U_{1})\n$$\n$$\n-m_{2}\\omega^{2}U_{2} = K(U_{1} - U_{2})\n$$\n这些方程可以重写为一个矩阵本征值问题：\n$$\n\\omega^{2}\n\\begin{pmatrix}\nm_{1} & 0 \\\\\n0 & m_{2}\n\\end{pmatrix}\n\\begin{pmatrix}\nU_{1} \\\\\nU_{2}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\nK & -K \\\\\n-K & K\n\\end{pmatrix}\n\\begin{pmatrix}\nU_{1} \\\\\nU_{2}\n\\end{pmatrix}\n$$\n这是 $\\omega^{2}\\mathbf{M}\\mathbf{U} = \\mathbf{C}\\mathbf{U}$ 的形式，其中 $\\mathbf{M}$ 是质量矩阵，$\\mathbf{C}$ 是力常数矩阵。\n\n为了求出质量加权动力学矩阵 $\\mathbf{D}$，我们引入质量加权坐标 $w_{j} = \\sqrt{m_{j}}U_{j}$。因此，$U_{j} = w_{j}/\\sqrt{m_{j}}$。质量加权坐标矢量为 $\\mathbf{w} = \\mathbf{M}^{1/2}\\mathbf{U}$。将此代入本征值方程，并从左侧乘以 $\\mathbf{M}^{-1/2}$，得到关于动力学矩阵的标准本征值问题：\n$$\n\\omega^{2}(\\mathbf{M}^{-1/2}\\mathbf{M}\\mathbf{M}^{-1/2})\\mathbf{w} = (\\mathbf{M}^{-1/2}\\mathbf{C}\\mathbf{M}^{-1/2})\\mathbf{w}\n$$\n$$\n\\omega^{2}\\mathbf{w} = \\mathbf{D}\\mathbf{w}\n$$\n其中，质量加权动力学矩阵 $\\mathbf{D}$ 定义为 $\\mathbf{D} = \\mathbf{M}^{-1/2}\\mathbf{C}\\mathbf{M}^{-1/2}$。\n已知 $\\mathbf{M} = \\begin{pmatrix} m_{1} & 0 \\\\ 0 & m_{2} \\end{pmatrix}$ 和 $\\mathbf{C} = \\begin{pmatrix} K & -K \\\\ -K & K \\end{pmatrix}$，我们有 $\\mathbf{M}^{-1/2} = \\begin{pmatrix} 1/\\sqrt{m_{1}} & 0 \\\\ 0 & 1/\\sqrt{m_{2}} \\end{pmatrix}$。\n计算过程如下：\n$$\n\\mathbf{D} = \n\\begin{pmatrix}\n1/\\sqrt{m_{1}} & 0 \\\\\n0 & 1/\\sqrt{m_{2}}\n\\end{pmatrix}\n\\begin{pmatrix}\nK & -K \\\\\n-K & K\n\\end{pmatrix}\n\\begin{pmatrix}\n1/\\sqrt{m_{1}} & 0 \\\\\n0 & 1/\\sqrt{m_{2}}\n\\end{pmatrix}\n$$\n$$\n\\mathbf{D} = \n\\begin{pmatrix}\nK/\\sqrt{m_{1}} & -K/\\sqrt{m_{1}} \\\\\n-K/\\sqrt{m_{2}} & K/\\sqrt{m_{2}}\n\\end{pmatrix}\n\\begin{pmatrix}\n1/\\sqrt{m_{1}} & 0 \\\\\n0 & 1/\\sqrt{m_{2}}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\nK/m_{1} & -K/\\sqrt{m_{1}m_{2}} \\\\\n-K/\\sqrt{m_{1}m_{2}} & K/m_{2}\n\\end{pmatrix}\n$$\n这就是所求的 $2\\times 2$ 质量加权动力学矩阵。\n\n接下来，我们求解 $\\mathbf{D}$ 的本征值 $\\lambda = \\omega^{2}$ 和本征矢量（极化矢量）$\\mathbf{w}$。特征方程为 $\\det(\\mathbf{D} - \\lambda\\mathbf{I}) = 0$：\n$$\n\\det\n\\begin{pmatrix}\nK/m_{1} - \\lambda & -K/\\sqrt{m_{1}m_{2}} \\\\\n-K/\\sqrt{m_{1}m_{2}} & K/m_{2} - \\lambda\n\\end{pmatrix}\n= 0\n$$\n$$\n\\left(\\frac{K}{m_{1}} - \\lambda\\right)\\left(\\frac{K}{m_{2}} - \\lambda\\right) - \\frac{K^{2}}{m_{1}m_{2}} = 0\n$$\n$$\n\\frac{K^{2}}{m_{1}m_{2}} - \\lambda K\\left(\\frac{1}{m_{1}} + \\frac{1}{m_{2}}\\right) + \\lambda^{2} - \\frac{K^{2}}{m_{1}m_{2}} = 0\n$$\n$$\n\\lambda^{2} - \\lambda K\\left(\\frac{1}{m_{1}} + \\frac{1}{m_{2}}\\right) = 0\n$$\n$$\n\\lambda\\left[\\lambda - K\\left(\\frac{1}{m_{1}} + \\frac{1}{m_{2}}\\right)\\right] = 0\n$$\n两个本征值为：\n$$\n\\lambda_{1} = 0 \\quad \\text{和} \\quad \\lambda_{2} = K\\left(\\frac{1}{m_{1}} + \\frac{1}{m_2}\\right) = \\frac{K}{\\mu}\n$$\n其中 $\\mu = (m_{1}m_{2})/(m_{1}+m_{2})$ 是折合质量。对应的角频率为 $\\omega = \\sqrt{\\lambda}$：\n$$\n\\omega_{1} = 0 \\quad \\text{和} \\quad \\omega_{2} = \\sqrt{K\\left(\\frac{1}{m_{1}} + \\frac{1}{m_{2}}\\right)}\n$$\n对于本征矢量 $\\mathbf{w} = \\begin{pmatrix} w_{1} \\\\ w_{2} \\end{pmatrix}$：\n对于 $\\lambda_{1}=0$：$\\mathbf{D}\\mathbf{w}_{1} = 0$。第一行给出 $\\frac{K}{m_{1}}w_{11} - \\frac{K}{\\sqrt{m_{1}m_{2}}}w_{21} = 0$，这意味着 $w_{11} = \\frac{\\sqrt{m_{1}}}{\\sqrt{m_{2}}}w_{21}$。一个未归一化的本征矢量是 $\\begin{pmatrix} \\sqrt{m_{1}} \\\\ \\sqrt{m_{2}} \\end{pmatrix}$。归一化到单位欧几里得范数（$w_{11}^{2} + w_{21}^{2} = 1$）：\n$$\n\\mathbf{w}_{1} = \\frac{1}{\\sqrt{m_{1}+m_{2}}}\n\\begin{pmatrix}\n\\sqrt{m_{1}} \\\\\n\\sqrt{m_{2}}\n\\end{pmatrix}\n$$\n对于 $\\lambda_{2}=K(\\frac{1}{m_{1}}+\\frac{1}{m_{2}})$：$(\\mathbf{D}-\\lambda_{2}\\mathbf{I})\\mathbf{w}_{2}=0$。第一行给出 $(\\frac{K}{m_{1}} - \\lambda_{2})w_{12} - \\frac{K}{\\sqrt{m_{1}m_{2}}}w_{22} = 0$，可简化为 $-\\frac{K}{m_{2}}w_{12} - \\frac{K}{\\sqrt{m_{1}m_{2}}}w_{22} = 0$。这意味着 $w_{12} = -\\frac{\\sqrt{m_{2}}}{\\sqrt{m_{1}}}w_{22}$。一个未归一化的本征矢量是 $\\begin{pmatrix} \\sqrt{m_{2}} \\\\ -\\sqrt{m_{1}} \\end{pmatrix}$。归一化后：\n$$\n\\mathbf{w}_{2} = \\frac{1}{\\sqrt{m_{1}+m_{2}}}\n\\begin{pmatrix}\n\\sqrt{m_{2}} \\\\\n-\\sqrt{m_{1}}\n\\end{pmatrix}\n$$\n为了解释这些模式，我们将其转换回物理位移 $U_{j} = w_{j}/\\sqrt{m_{j}}$。\n对于频率为 $\\omega_{1} = 0$ 的模式：物理位移矢量 $\\mathbf{U}_{1}$ 正比于 $\\begin{pmatrix} w_{11}/\\sqrt{m_{1}} \\\\ w_{21}/\\sqrt{m_{2}} \\end{pmatrix} \\propto \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$。此时，$U_{1} = U_{2}$。两个原子以相同的振幅和相同的相一起运动。这对应于单胞的刚性平移，并且由于 $q=0$，也对应于整个晶体的刚性平移。这种运动不消耗势能，因此其频率为零。这就是**声学模式**。\n\n对于频率为 $\\omega_{2} = \\sqrt{K/\\mu}$ 的模式：物理位移矢量 $\\mathbf{U}_{2}$ 正比于 $\\begin{pmatrix} w_{12}/\\sqrt{m_{1}} \\\\ w_{22}/\\sqrt{m_{2}} \\end{pmatrix} \\propto \\begin{pmatrix} \\sqrt{m_{2}}/\\sqrt{m_{1}} \\\\ -\\sqrt{m_{1}}/\\sqrt{m_{2}} \\end{pmatrix} = \\frac{1}{\\sqrt{m_{1}m_{2}}}\\begin{pmatrix} m_{2} \\\\ -m_{1} \\end{pmatrix}$。位移是反相的，其振幅满足 $U_{1}/U_{2} = -m_{2}/m_{1}$，即 $m_{1}U_{1} + m_{2}U_{2} = 0$。这意味着单胞的质心保持静止。原子相互反向振动，拉伸它们之间的化学键。这是一种高频运动。在离子晶体中，这种运动会产生一个振荡的电偶极子，可以与电磁辐射（光）耦合，因此被称为**光学模式**。所以，$\\omega_{\\mathrm{opt}} = \\omega_{2}$。\n\n最后，我们计算光学模式频率 $f_{\\mathrm{opt}} = \\omega_{\\mathrm{opt}}/(2\\pi)$ 的数值。\n给定参数为 $m_{1} = 3.817\\times 10^{-26}\\,\\mathrm{kg}$，$m_{2} = 5.887\\times 10^{-26}\\,\\mathrm{kg}$，以及 $K = 100\\,\\mathrm{N\\,m^{-1}}$。\n$$\n\\omega_{\\mathrm{opt}}^{2} = K\\left(\\frac{1}{m_{1}} + \\frac{1}{m_{2}}\\right) = 100\\,\\mathrm{N\\,m^{-1}} \\left(\\frac{1}{3.817\\times 10^{-26}\\,\\mathrm{kg}} + \\frac{1}{5.887\\times 10^{-26}\\,\\mathrm{kg}}\\right)\n$$\n$$\n\\omega_{\\mathrm{opt}}^{2} \\approx 100 \\left(2.61986\\times 10^{25} + 1.69866\\times 10^{25}\\right) \\,\\mathrm{s^{-2}} = 100 \\left(4.31852\\times 10^{25}\\right) \\,\\mathrm{s^{-2}}\n$$\n$$\n\\omega_{\\mathrm{opt}}^{2} \\approx 4.31852\\times 10^{27} \\,\\mathrm{s^{-2}}\n$$\n$$\n\\omega_{\\mathrm{opt}} = \\sqrt{4.31852\\times 10^{27}} \\,\\mathrm{rad\\,s^{-1}} \\approx 6.57155\\times 10^{13} \\,\\mathrm{rad\\,s^{-1}}\n$$\n频率 $f_{\\mathrm{opt}}$ 为：\n$$\nf_{\\mathrm{opt}} = \\frac{\\omega_{\\mathrm{opt}}}{2\\pi} \\approx \\frac{6.57155\\times 10^{13}}{2\\pi} \\,\\mathrm{Hz} \\approx 1.04589\\times 10^{13} \\,\\mathrm{Hz}\n$$\n以太赫兹 ($1\\,\\mathrm{THz} = 10^{12}\\,\\mathrm{Hz}$) 为单位：\n$$\nf_{\\mathrm{opt}} \\approx 10.4589 \\,\\mathrm{THz}\n$$\n四舍五入到四位有效数字，结果是 $10.46\\,\\mathrm{THz}$。", "answer": "$$\\boxed{10.46}$$", "id": "2508278"}, {"introduction": "前面的练习为我们构筑了晶格振动的理论框架，但理论的最终价值在于其解释和预测现实世界的能力。本练习将理论与实验联系起来，模拟一个在材料科学研究中至关重要的任务。假设你通过非弹性散射实验测量了一组声子色散数据，你的任务是反向工程：利用这些“实验”数据来拟合出一个原子间力常数模型。一旦确定了这些微观的力学参数，你就能进一步计算出材料的宏观弹性常数，如 $C_{11}$ 和 $C_{44}$。这个综合性练习不仅能巩固你对色散关系的理解，更让你体验到如何从微观模型出发，预测并理解材料的宏观力学性质。[@problem_id:2508301]", "problem": "给定一个单原子简立方晶体，通过非弹性散射技术测量得到的声学声子色散在一个高对称方向（具体为晶体学 $[100]$ 方向）上的一维截面。假设采用谐波 Born–von Kármán 模型，其中心对力常数截断至第一和第二近邻。该晶体的原胞含有一个质量为 $M$ 的原子，晶格参数为 $a$。最近邻距离为 $a$，力常数为 $k_1$；次近邻距离为 $\\sqrt{2}\\,a$，力常数为 $k_2$。测量数据集提供了沿 $\\mathbf{q} \\parallel [100]$ 方向的纵向声学（LA）支和简并横向声学（TA）支的角频率 $\\omega_s(\\mathbf{q})$。所有三角函数均使用弧度制，波矢单位为 $\\mathrm{m}^{-1}$，角频率单位为 $\\mathrm{rad}\\,\\mathrm{s}^{-1}$。\n\n从谐波运动方程和中心力动力学矩阵的定义出发，推导沿 $[100]$ 方向的色散关系，用 $k_1$、$k_2$、$M$、$a$ 和 $\\mathbf{q}$ 表示。使用这些关系，将一个双参数力常数模型（$k_1$，$k_2$）拟合到测量的 $\\omega_s(\\mathbf{q})$，然后提取相应的长波连续介质的弹性常数：$C_{11}$、$C_{12}$ 和 $C_{44}$。假设该单原子简立方晶体的密度为 $\\rho = M/a^3$。仅使用以下基本事实作为出发点：(i) 牛顿第二定律，(ii) 使用中心对力的谐波近似，(iii) 动力学矩阵的定义及其与本征值 $\\omega^2$ 的关系，以及 (iv) 在小 $|\\mathbf{q}|$ 时声速与弹性常数之间的连续介质弹性关系。您的推导应清楚说明拟合的对象是什么，为何该拟合受模型物理的支持，以及如何从拟合参数中得出弹性常数。您不能依赖任何未经推导的公式。\n\n您的程序应实现上述拟合和提取过程，并将其应用于以下三个测试用例。对于每个案例，使用提供的参数和波矢网格构建测量数据集。“测量”数据集是从相同物理模型获得的无噪声合成数据；因此，您的拟合过程应能在数值精度范围内精确地重构模型参数。对于每个案例，计算并报告弹性常数 $C_{11}$、$C_{12}$ 和 $C_{44}$（单位为 Pa），每个值都四舍五入到三位有效数字。\n\n测试套件（每个用例提供 $M$（单位 kg）、$a$（单位 m）以及真实的 $k_1$、$k_2$（单位 $\\mathrm{N}\\,\\mathrm{m}^{-1}$）；在列出的 $q_i$ 处构建 $\\omega_{\\mathrm{LA}}(q_i)$ 和 $\\omega_{\\mathrm{TA}}(q_i)$）：\n\n- 案例 1：\n  - $M = 1.0\\times 10^{-25}\\ \\mathrm{kg}$，\n  - $a = 3.0\\times 10^{-10}\\ \\mathrm{m}$，\n  - $k_1 = 15.0\\ \\mathrm{N}\\,\\mathrm{m}^{-1}$，\n  - $k_2 = 15.0\\ \\mathrm{N}\\,\\mathrm{m}^{-1}$，\n  - $q_i = \\{\\xi_i\\,\\pi/a\\}$，其中 $\\xi_i \\in \\{0.10, 0.20, 0.35, 0.50, 0.70, 0.90\\}$。\n\n- 案例 2：\n  - $M = 6.6\\times 10^{-26}\\ \\mathrm{kg}$，\n  - $a = 2.5\\times 10^{-10}\\ \\mathrm{m}$，\n  - $k_1 = 20.0\\ \\mathrm{N}\\,\\mathrm{m}^{-1}$，\n  - $k_2 = 5.0\\ \\mathrm{N}\\,\\mathrm{m}^{-1}$，\n  - $q_i = \\{\\xi_i\\,\\pi/a\\}$，其中 $\\xi_i \\in \\{0.08, 0.16, 0.30, 0.45, 0.60, 0.85\\}$。\n\n- 案例 3：\n  - $M = 1.8\\times 10^{-25}\\ \\mathrm{kg}$，\n  - $a = 4.0\\times 10^{-10}\\ \\mathrm{m}$，\n  - $k_1 = 16.0\\ \\mathrm{N}\\,\\mathrm{m}^{-1}$，\n  - $k_2 = 12.0\\ \\mathrm{N}\\,\\mathrm{m}^{-1}$，\n  - $q_i = \\{\\xi_i\\,\\pi/a\\}$，其中 $\\xi_i \\in \\{0.12, 0.24, 0.40, 0.55, 0.72, 0.92\\}$。\n\n对于每个案例，“测量”的色散关系将由您的程序根据您推导的模型，在指定的 $q_i$ 处生成。然后，基于这些合成的测量数据，您的程序必须：\n- 拟合力常数 $k_1$ 和 $k_2$。\n- 计算 $C_{11}$、$C_{12}$ 和 $C_{44}$（单位 Pa）。\n- 将每个弹性常数四舍五入到三位有效数字。\n\n最终输出格式：您的程序应生成单行输出，其中包含三个案例的结果，格式为一个由方括号括起来的逗号分隔列表，每个案例本身又是按 $[C_{11}, C_{12}, C_{44}]$ 顺序排列的列表。例如，打印的行应如下所示：\n\"[ [C11_case1,C12_case1,C44_case1], [C11_case2,C12_case2,C44_case2], [C11_case3,C12_case3,C44_case3] ]\"\n每个数值条目的单位为 Pa，并四舍五入到三位有效数字。不要打印任何附加文本。", "solution": "该问题陈述是固态物理学中的一个有效练习。它具有科学依据，是良定的、客观且完整的。它要求推导简立方晶体的声子色散关系，基于这些关系将力常数与合成数据进行拟合，并随后计算弹性常数。这是一个标准流程，所有提供的参数在物理上都是合理的。\n\n求解过程分三个阶段：\n1.  推导具有第一和第二近邻中心力的单原子简立方晶格的色散关系 $\\omega(\\mathbf{q})$。\n2.  建立线性最小二乘拟合，从色散数据中确定力常数 $k_1$ 和 $k_2$。\n3.  在长波极限下，从力常数推导弹性常数 $C_{11}$、$C_{12}$ 和 $C_{44}$ 的表达式。\n\n**1. 声子色散关系的推导**\n\n我们从位于晶格格点 $\\mathbf{R}_l$ 处的原子的谐波运动方程开始。令 $\\mathbf{u}_l$ 为其偏离平衡位置的位移。\n$$M \\ddot{\\mathbf{u}}_l = -\\sum_{l'} \\mathbf{\\Phi}(l, l') \\mathbf{u}_{l'}$$\n其中 $M$ 是原子质量，$\\mathbf{\\Phi}(l, l')$ 是力常数矩阵。\n假设平面波解的形式为 $\\mathbf{u}_l(t) = \\mathbf{\\epsilon} e^{i(\\mathbf{q} \\cdot \\mathbf{R}_l - \\omega t)}$，其中 $\\mathbf{\\epsilon}$ 是极化矢量，$\\mathbf{q}$ 是波矢，$\\omega$ 是角频率，我们得到动力学矩阵 $\\mathbf{D}(\\mathbf{q})$ 的本征值方程：\n$$M \\omega^2 \\mathbf{\\epsilon} = \\mathbf{D}(\\mathbf{q}) \\mathbf{\\epsilon}$$\n动力学矩阵的分量由下式给出：\n$$D_{\\alpha\\beta}(\\mathbf{q}) = \\sum_{h} \\Phi_{\\alpha\\beta}(\\mathbf{R}_h) e^{i\\mathbf{q} \\cdot \\mathbf{R}_h}$$\n其中求和遍及所有晶格矢量 $\\mathbf{R}_h$，而 $\\Phi_{\\alpha\\beta}(\\mathbf{R}_h)$ 是位于原点的原子与位于 $\\mathbf{R}_h$ 处的原子之间的力常数张量。自相互作用项由均匀平移下合力为零的条件确定：$\\Phi_{\\alpha\\beta}(\\mathbf{0}) = -\\sum_{h\\neq 0} \\Phi_{\\alpha\\beta}(\\mathbf{R}_h)$。这使我们可以写出：\n$$D_{\\alpha\\beta}(\\mathbf{q}) = \\sum_{h \\neq 0} \\Phi_{\\alpha\\beta}(\\mathbf{R}_h) (e^{i\\mathbf{q} \\cdot \\mathbf{R}_h} - 1)$$\n对于中心力势，原点与位于 $\\mathbf{R}_h$ 处的原子之间的力常数张量为 $\\Phi_{\\alpha\\beta}(\\mathbf{R}_h) = -K \\frac{R_{h,\\alpha} R_{h,\\beta}}{|\\mathbf{R}_h|^2}$，其中 $K$ 是伸缩力常数。\n\n对于晶格常数为 $a$ 的简立方晶格，我们考虑距离为 $a$ 的第一近邻（力常数为 $k_1$）和距离为 $\\sqrt{2}a$ 的第二近邻（力常数为 $k_2$）。我们计算矩阵分量 $D_{\\alpha\\beta}(\\mathbf{q})$ 的求和。\n\n第一近邻位于 $(\\pm a, 0, 0)$ 等位置。第二近邻位于 $(\\pm a, \\pm a, 0)$ 等位置。\n例如，对角元为：\n$$D_{xx}(\\mathbf{q}) = 2k_1(1 - \\cos(q_x a)) + 4k_2(1 - \\cos(q_x a)\\cos(q_y a)) + 4k_2(1 - \\cos(q_x a)\\cos(q_z a))$$\n例如，非对角元为：\n$$D_{xy}(\\mathbf{q}) = 4k_2 \\sin(q_x a) \\sin(q_y a)$$\n其他分量可通过对指标 $(x, y, z)$ 进行轮换得到。\n\n我们关心的是高对称方向 $\\mathbf{q} \\parallel [100]$，因此我们设 $\\mathbf{q} = (q, 0, 0)$。动力学矩阵的分量显著简化为：\n$D_{xx}(q,0,0) = 2k_1(1-\\cos(qa)) + 4k_2(1-\\cos(qa)) = (2k_1+4k_2)(1-\\cos(qa))$\n$D_{yy}(q,0,0) = 4k_2(1-\\cos(qa))$\n$D_{zz}(q,0,0) = D_{yy}(q,0,0) = 4k_2(1-\\cos(qa))$\n所有 $\\alpha \\neq \\beta$ 的非对角项 $D_{\\alpha\\beta}$ 都变为零，因为 $q_y$ 或 $q_z$ 中至少有一个为零。因此，动力学矩阵是对角的。\n本征值 $M\\omega^2$ 就是对角元。\n使用恒等式 $1 - \\cos(\\theta) = 2\\sin^2(\\theta/2)$：\n\n对于纵向声学（LA）支（极化方向沿 $\\mathbf{q}$）：\n$$M\\omega_{\\text{LA}}^2(q) = (2k_1+4k_2)(1-\\cos(qa)) = (4k_1+8k_2)\\sin^2\\left(\\frac{qa}{2}\\right)$$\n$$\\omega_{\\text{LA}}(q) = \\sqrt{\\frac{4k_1+8k_2}{M}} \\left|\\sin\\left(\\frac{qa}{2}\\right)\\right|$$\n\n对于简并横向声学（TA）支（极化方向垂直于 $\\mathbf{q}$）：\n$$M\\omega_{\\text{TA}}^2(q) = 4k_2(1-\\cos(qa)) = 8k_2\\sin^2\\left(\\frac{qa}{2}\\right)$$\n$$\\omega_{\\text{TA}}(q) = \\sqrt{\\frac{8k_2}{M}} \\left|\\sin\\left(\\frac{qa}{2}\\right)\\right|$$\n为确保一致性，本文所用的动力学矩阵推导基于标准教材，如Kittel的《固态物理导论》。经复核，简立方晶格在[100]方向的横向支应为$M\\omega_{\\text{TA}}^2(q) = 2k_1(1-\\cos(0)) + 2k_2(2 - \\cos(q a) - \\cos(0)) = 2k_2(1-\\cos(qa))$。因此，$M\\omega_{\\text{TA}}^2(q) = 4k_2\\sin^2(\\frac{qa}{2})$。程序将遵循此正确形式。\n\n**2. 力常数的拟合过程**\n\n推导出的关系在实验可观测量与模型参数 $k_1$ 和 $k_2$ 之间建立了线性联系。设所提供的数据为一组波矢 $q_i$ 对应的 $(\\omega_{\\text{LA}}(q_i), \\omega_{\\text{TA}}(q_i))$ 对。我们可以重排色散方程：\n$$M\\omega_{\\text{LA}}^2(q_i) = k_1 \\left(4\\sin^2\\left(\\frac{q_ia}{2}\\right)\\right) + k_2 \\left(8\\sin^2\\left(\\frac{q_ia}{2}\\right)\\right)$$\n$$M\\omega_{\\text{TA}}^2(q_i) = k_1 \\cdot 0 + k_2 \\left(4\\sin^2\\left(\\frac{q_ia}{2}\\right)\\right)$$\n对于一组 $N$ 个测量点 $\\{q_i\\}$，我们得到了关于两个未知数 $k_1$ 和 $k_2$ 的 $2N$ 个线性方程。这个超定系统可以写成矩阵形式 $\\mathbf{A} \\mathbf{x} = \\mathbf{y}$，其中 $\\mathbf{x} = [k_1, k_2]^T$。观测向量 $\\mathbf{y}$ 和设计矩阵 $\\mathbf{A}$ 由测量数据构造。线性最小二乘算法为 $\\mathbf{x}$ 提供了一个稳健的解，从而得到 $k_1$ 和 $k_2$ 的最佳拟合值。由于该问题使用的是合成的无噪声数据，该拟合将精确地恢复真实参数。\n\n**3. 弹性常数的提取**\n\n在长波极限（$q \\to 0$）下，微观力常数与宏观弹性常数之间的联系得以建立。在此极限下，色散关系变为线性关系 $\\omega = v_s q$，其中 $v_s$ 是声速。我们使用 $\\sin(x) \\approx x$ 对小 $q$ 的色散关系进行展开：\n$M\\omega_{\\text{LA}}^2(q) \\approx (4k_1+8k_2)\\left(\\frac{qa}{2}\\right)^2 = (k_1+2k_2)q^2 a^2 \\implies v_{\\text{LA}}^2 = \\frac{(k_1+2k_2)a^2}{M}$\n$M\\omega_{\\text{TA}}^2(q) \\approx 4k_2\\left(\\frac{qa}{2}\\right)^2 = k_2 q^2 a^2 \\implies v_{\\text{TA}}^2 = \\frac{k_2 a^2}{M}$\n根据连续介质弹性理论，对于立方晶体，沿 $[100]$ 方向传播的波的声速由下式给出：\n$$v_{\\text{LA}} = \\sqrt{\\frac{C_{11}}{\\rho}} \\quad \\text{和} \\quad v_{\\text{TA}} = \\sqrt{\\frac{C_{44}}{\\rho}}$$\n其中 $\\rho = M/a^3$ 是密度。\n通过令微观和宏观的声速平方表达式相等，我们得到：\n$\\frac{C_{11}}{\\rho} = \\frac{(k_1+2k_2)a^2}{M} \\implies C_{11} = \\frac{M}{a^3} \\frac{(k_1+2k_2)a^2}{M} = \\frac{k_1+2k_2}{a}$\n$\\frac{C_{44}}{\\rho} = \\frac{k_2 a^2}{M} \\implies C_{44} = \\frac{M}{a^3} \\frac{k_2 a^2}{M} = \\frac{k_2}{a}$\n为了求出 $C_{12}$，我们必须考虑长波极限下的一个普遍的 $\\mathbf{q}$。将完整的动力学矩阵对小 $\\mathbf{q}$ 展开，并将其与来自连续介质弹性的 Christoffel 方程进行比较，可以得到剩余的弹性常数。\n我们发现 $D_{xy}(\\mathbf{q}) \\approx 2k_2 a^2 q_x q_y$。在 Christoffel 矩阵中，对应的项乘以 $a$ 是 $a(C_{12}+C_{44})q_x q_y$。将它们等同起来可得：\n$a(C_{12}+C_{44}) = 2k_2 a^2 \\implies C_{12}+C_{44} = \\frac{2k_2}{a}$。\n代入 $C_{44}$ 的表达式：\n$C_{12} + \\frac{k_2}{a} = \\frac{2k_2}{a} \\implies C_{12} = \\frac{k_2}{a}$。\n这证实了 Cauchy 关系 $C_{12}=C_{44}$，对于原子位于反演中心且通过中心力相互作用的晶体，这是预期的结果。\n弹性常数的最终表达式为：\n$$C_{11} = \\frac{k_1+2k_2}{a}, \\quad C_{12} = \\frac{k_2}{a}, \\quad C_{44} = \\frac{k_2}{a}$$\n程序将实现这整个序列：生成合成数据，使用最小二乘法拟合 $k_1$ 和 $k_2$，并使用推导出的公式计算 $C_{11}$、$C_{12}$ 和 $C_{44}$。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem of fitting force constants and extracting elastic constants\n    for a simple cubic crystal based on phonon dispersion relations.\n    \"\"\"\n    test_cases = [\n        {\n            \"M\": 1.0e-25,  # kg\n            \"a\": 3.0e-10,  # m\n            \"k1_true\": 15.0, # N/m\n            \"k2_true\": 15.0, # N/m\n            \"xi\": [0.10, 0.20, 0.35, 0.50, 0.70, 0.90]\n        },\n        {\n            \"M\": 6.6e-26,\n            \"a\": 2.5e-10,\n            \"k1_true\": 20.0,\n            \"k2_true\": 5.0,\n            \"xi\": [0.08, 0.16, 0.30, 0.45, 0.60, 0.85]\n        },\n        {\n            \"M\": 1.8e-25,\n            \"a\": 4.0e-10,\n            \"k1_true\": 16.0,\n            \"k2_true\": 12.0,\n            \"xi\": [0.12, 0.24, 0.40, 0.55, 0.72, 0.92]\n        }\n    ]\n\n    all_results = []\n    \n    for case in test_cases:\n        M = case[\"M\"]\n        a = case[\"a\"]\n        k1_true = case[\"k1_true\"]\n        k2_true = case[\"k2_true\"]\n        q_grid = [(xi * np.pi / a) for xi in case[\"xi\"]]\n        \n        # 1. Generate synthetic \"measured\" data using the derived dispersion relations\n        omega_la_sq = []\n        omega_ta_sq = []\n        \n        for q in q_grid:\n            sin_sq_term = np.sin(q * a / 2)**2\n            # M * omega_LA^2 = (4*k1 + 8*k2) * sin^2(qa/2)\n            # M * omega_TA^2 = 4*k2 * sin^2(qa/2)\n            m_omega_la_sq = (4 * k1_true + 8 * k2_true) * sin_sq_term\n            m_omega_ta_sq = (4 * k2_true) * sin_sq_term\n            \n            omega_la_sq.append(m_omega_la_sq / M)\n            omega_ta_sq.append(m_omega_ta_sq / M)\n\n        # 2. Set up and solve the linear least-squares problem to fit k1 and k2\n        num_points = len(q_grid)\n        # We have 2N equations for 2 unknowns (k1, k2)\n        A = np.zeros((2 * num_points, 2))\n        y = np.zeros(2 * num_points)\n        \n        for i, q in enumerate(q_grid):\n            # Term common to all equations for a given q\n            common_factor = 4 * np.sin(q * a / 2)**2\n            \n            # Equation for LA branch: M*omega_LA^2 = k1*(4*sin^2) + k2*(8*sin^2)\n            A[2 * i, 0] = common_factor\n            A[2 * i, 1] = 2 * common_factor\n            y[2 * i] = M * omega_la_sq[i]\n\n            # Equation for TA branch: M*omega_TA^2 = k2*(4*sin^2)\n            A[2 * i + 1, 0] = 0\n            A[2 * i + 1, 1] = common_factor\n            y[2 * i + 1] = M * omega_ta_sq[i]\n            \n        # Solve Ax = y for x = [k1, k2]\n        k_fitted, residuals, rank, s = np.linalg.lstsq(A, y, rcond=None)\n        k1_fit, k2_fit = k_fitted\n        \n        # 3. Calculate elastic constants from the fitted force constants\n        # C11 = (k1 + 2*k2) / a\n        # C12 = k2 / a\n        # C44 = k2 / a\n        C11 = (k1_fit + 2 * k2_fit) / a\n        C12 = k2_fit / a\n        C44 = k2_fit / a\n        \n        all_results.append([C11, C12, C44])\n\n    # 4. Format the final output string as specified\n    # The format required is a list of lists, with numbers in scientific notation\n    # rounded to 3 significant figures.\n    # e.g., \"[[C11,C12,C44],[C11,C12,C44]]\"\n    case_strs = []\n    for res in all_results:\n        # Format Cij to 3 significant figures using \"e\" notation with 2 decimal places.\n        res_str = '[' + ','.join([f\"{val:.2e}\" for val in res]) + ']'\n        case_strs.append(res_str)\n    \n    final_output_str = '[' + ','.join(case_strs) + ']'\n    print(final_output_str)\n\nsolve()\n```", "id": "2508301"}]}