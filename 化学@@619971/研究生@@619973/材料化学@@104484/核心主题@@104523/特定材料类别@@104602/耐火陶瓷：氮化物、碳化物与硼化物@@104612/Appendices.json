{"hands_on_practices": [{"introduction": "要理解材料的特性，第一步是探究其原子排列方式。原子堆积因子（$APF$）是描述晶体结构中原子占据空间效率的一个关键几何参数。通过本练习 [@problem_id:2517195]，您将推导两种重要的耐火陶瓷——碳化钛（$\\text{TiC}$）和二硼化钛（$\\text{TiB}_2$）的原子堆积因子，并将这些结构细节与潜在的扩散行为联系起来，从而深入理解结构与性能之间的关系。", "problem": "陶瓷晶体结构中几何密度的核心衡量标准是原子堆积因子，定义为以原子位置为中心的非重叠硬球所占据的晶胞体积分数。考虑两种广泛用于极端环境的耐火陶瓷：岩盐（氯化钠）结构的碳化钛 ($\\text{TiC}$) 和二硼化铝 ($\\text{AlB}_2$) 结构的二硼化钛 ($\\text{TiB}_2$)。假设采用硬球模型描述，其中钛、碳和硼的原子半径分别表示为 $r_{\\mathrm{Ti}}$、$r_{\\mathrm{C}}$ 和 $r_{\\mathrm{B}}$。\n\n任务1 (NaCl型 TiC)：$\\text{TiC}$ 采用岩盐结构，其常规立方晶胞的边长为 $a_{\\mathrm{RS}}$，包含 $4$ 个化学式单位，最近邻原子位于从立方体角点到棱心的连线上。在硬球模型中，设定钛和碳沿着钛-碳最近邻连线相接触，且同类原子邻居不重叠。仅利用异类邻居间的硬球接触条件和晶体几何学，推导 $\\text{TiC}$ 的原子堆积因子，并以半径比 $y \\equiv r_{\\mathrm{Ti}}/r_{\\mathrm{C}}$ 的闭合形式表达式表示。说明仅凭几何学即可满足无重叠约束的 $y$ 的取值范围。\n\n任务2 ($\\text{AlB}_2$型 $\\text{TiB}_2$)：$\\text{TiB}_2$ 采用 $\\text{AlB}_2$ 结构，其六方晶胞的参数为 $a_{\\mathrm{H}}$ 和 $c_{\\mathrm{H}}$，体积为 $V_{\\mathrm{H}} = (\\sqrt{3}/2)\\,a_{\\mathrm{H}}^{2} c_{\\mathrm{H}}$。该晶胞包含 $1$ 个钛原子和 $2$ 个硼原子。在每个硼层内，硼原子形成一个平面的蜂窝状网络（类石墨烯），而钛原子则位于相邻层中硼六边形的正上方中心位置。在硬球模型中，设定 (i) 硼-硼在蜂窝状网络边上沿面内方向相接触，(ii) 钛-硼沿着从钛原子位置到其任一最近邻硼原子的直线上相接触，以及 (iii) 钛-钛无论在面内还是沿 $c$ 轴方向均不重叠。仅利用这些几何约束和六方晶胞体积公式，推导 $\\text{TiB}_2$ 的原子堆积因子，并以半径比 $x \\equiv r_{\\mathrm{Ti}}/r_{\\mathrm{B}}$ 的闭合形式表达式表示。说明仅凭几何学即可满足所有给定的接触和无重叠约束的 $x$ 的取值范围。\n\n任务3 (与扩散的定性联系)：仅根据您推导出的堆积因子以及两种晶格所暗示的间隙空间拓扑结构，对 $\\text{TiC}$ 与 $\\text{TiB}_2$ 中小间隙物种可能的扩散路径进行简洁且物理上合理的比较。您必须指明哪种结构预计会表现出更各向异性的扩散路径，并根据堆积拓扑结构解释原因。\n\n答案规格：分别以 $y$ 和 $x$ 的闭合形式解析表达式提供两种原子堆积因子。请勿代入数值。最终答案必须是符号形式。无需四舍五入。最终答案不得包含单位，且必须按 [TiC, TiB$_2$] 的顺序列出两个表达式，形式为单行矩阵。", "solution": "所提出的问题是固态化学和晶体学中的一个标准练习，要求将几何学原理应用于晶体结构的理想化硬球模型。该问题具有科学依据，提法明确，且客观。我们将着手进行推导。\n\n首先，我们解决任务1：具有岩盐结构的碳化钛 (TiC) 的原子堆积因子 (APF)。\n\n岩盐 (NaCl) 结构由面心立方 (FCC) 晶格描述。对于 TiC，它由两个相互贯穿的 FCC 子晶格组成，一个用于钛 (Ti)，一个用于碳 (C)，两者沿立方体轴线相互错开半个晶格参数的距离。晶格参数为 $a_{\\mathrm{RS}}$ 的常规立方晶胞包含 $Z=4$ 个 TiC 化学式单位，即包含 $4$ 个 Ti 原子和 $4$ 个 C 原子。\n\n一个晶胞内原子所占据的总空间是这些原子体积的总和，这些原子被建模为硬球：\n$$ V_{\\mathrm{atoms}} = 4 \\times V_{\\mathrm{Ti}} + 4 \\times V_{\\mathrm{C}} = 4 \\left( \\frac{4}{3}\\pi r_{\\mathrm{Ti}}^3 \\right) + 4 \\left( \\frac{4}{3}\\pi r_{\\mathrm{C}}^3 \\right) = \\frac{16\\pi}{3} (r_{\\mathrm{Ti}}^3 + r_{\\mathrm{C}}^3) $$\n其中 $r_{\\mathrm{Ti}}$ 和 $r_{\\mathrm{C}}$ 是原子半径。\n\n立方晶胞的体积为 $V_{\\mathrm{cell}} = a_{\\mathrm{RS}}^3$。为了确定 $a_{\\mathrm{RS}}$，我们使用硬球接触条件。在岩盐结构中，最近邻是不同类的原子（Ti 和 C）。一个角原子与一个相邻的面心原子之间的距离是晶格参数的一半，即 $a_{\\mathrm{RS}}/2$。问题陈述了 Ti 和 C 球体沿此线接触。因此：\n$$ r_{\\mathrm{Ti}} + r_{\\mathrm{C}} = \\frac{a_{\\mathrm{RS}}}{2} $$\n由此，我们用半径表示晶格参数：\n$$ a_{\\mathrm{RS}} = 2(r_{\\mathrm{Ti}} + r_{\\mathrm{C}}) $$\n晶胞体积变为：\n$$ V_{\\mathrm{cell}} = [2(r_{\\mathrm{Ti}} + r_{\\mathrm{C}})]^3 = 8(r_{\\mathrm{Ti}} + r_{\\mathrm{C}})^3 $$\n原子堆积因子 $APF_{\\mathrm{TiC}}$ 是原子体积与晶胞体积之比：\n$$ APF_{\\mathrm{TiC}} = \\frac{V_{\\mathrm{atoms}}}{V_{\\mathrm{cell}}} = \\frac{\\frac{16\\pi}{3} (r_{\\mathrm{Ti}}^3 + r_{\\mathrm{C}}^3)}{8(r_{\\mathrm{Ti}} + r_{\\mathrm{C}})^3} = \\frac{2\\pi}{3} \\frac{r_{\\mathrm{Ti}}^3 + r_{\\mathrm{C}}^3}{(r_{\\mathrm{Ti}} + r_{\\mathrm{C}})^3} $$\n为了用半径比 $y \\equiv r_{\\mathrm{Ti}}/r_{\\mathrm{C}}$ 来表示，我们将分子和分母同除以 $r_{\\mathrm{C}}^3$：\n$$ APF_{\\mathrm{TiC}} = \\frac{2\\pi}{3} \\frac{(r_{\\mathrm{Ti}}/r_{\\mathrm{C}})^3 + 1}{((r_{\\mathrm{Ti}}/r_{\\mathrm{C}}) + 1)^3} = \\frac{2\\pi}{3} \\frac{y^3 + 1}{(y + 1)^3} $$\n使用代数恒等式 $y^3 + 1 = (y+1)(y^2 - y + 1)$，我们简化表达式：\n$$ APF_{\\mathrm{TiC}} = \\frac{2\\pi}{3} \\frac{(y+1)(y^2 - y + 1)}{(y+1)^3} = \\frac{2\\pi(y^2 - y + 1)}{3(y+1)^2} $$\n$y$ 的取值范围由同类原子间的无重叠约束确定。在各自的 FCC 子晶格中，同类原子（例如 C-C 或 Ti-Ti）的最近邻距离是沿着面-对角线，等于 $a_{\\mathrm{RS}}/\\sqrt{2}$。\n对于 C-C 无重叠：$2r_{\\mathrm{C}} \\le a_{\\mathrm{RS}}/\\sqrt{2}$。代入 $a_{\\mathrm{RS}} = 2(r_{\\mathrm{Ti}} + r_{\\mathrm{C}})$ 得 $2r_{\\mathrm{C}} \\le \\frac{2(r_{\\mathrm{Ti}} + r_{\\mathrm{C}})}{\\sqrt{2}}$，简化为 $\\sqrt{2}r_{\\mathrm{C}} \\le r_{\\mathrm{Ti}} + r_{\\mathrm{C}}$，或 $r_{\\mathrm{Ti}}/r_{\\mathrm{C}} \\ge \\sqrt{2}-1$。因此，$y \\ge \\sqrt{2}-1$。\n对于 Ti-Ti 无重叠：$2r_{\\mathrm{Ti}} \\le a_{\\mathrm{RS}}/\\sqrt{2}$。这得到 $2r_{\\mathrm{Ti}} \\le \\frac{2(r_{\\mathrm{Ti}} + r_{\\mathrm{C}})}{\\sqrt{2}}$，简化为 $\\sqrt{2}r_{\\mathrm{Ti}} \\le r_{\\mathrm{Ti}} + r_{\\mathrm{C}}$，或 $(\\sqrt{2}-1)r_{\\mathrm{Ti}} \\le r_{\\mathrm{C}}$。这意味着 $r_{\\mathrm{Ti}}/r_{\\mathrm{C}} \\le \\frac{1}{\\sqrt{2}-1} = \\sqrt{2}+1$。因此，$y \\le \\sqrt{2}+1$。\n硬球模型的几何稳定性范围是 $\\sqrt{2}-1 \\le y \\le \\sqrt{2}+1$。\n\n接下来，我们解决任务2：具有 AlB$_2$ 结构的二硼化钛 (TiB$_2$)的原子堆积因子。\n\n该结构具有六方晶胞，晶格参数为 $a_{\\mathrm{H}}$ 和 $c_{\\mathrm{H}}$。晶胞包含 $Z=1$ 个化学式单位，即 $1$ 个 Ti 原子和 $2$ 个 B 原子。晶胞中原子的体积为：\n$$ V_{\\mathrm{atoms}} = 1 \\times V_{\\mathrm{Ti}} + 2 \\times V_{\\mathrm{B}} = \\frac{4}{3}\\pi r_{\\mathrm{Ti}}^3 + 2\\left(\\frac{4}{3}\\pi r_{\\mathrm{B}}^3\\right) = \\frac{4\\pi}{3}(r_{\\mathrm{Ti}}^3 + 2r_{\\mathrm{B}}^3) $$\n晶胞体积由 $V_{\\mathrm{cell}} = V_{\\mathrm{H}} = (\\sqrt{3}/2)a_{\\mathrm{H}}^2 c_{\\mathrm{H}}$ 给出。我们必须利用给定的约束条件，将 $a_{\\mathrm{H}}$ 和 $c_{\\mathrm{H}}$ 与原子半径联系起来。\n约束 (i): B-B 面内接触。 B 原子形成蜂窝状网络。在此结构中，B 原子之间的最近邻距离为 $a_{\\mathrm{H}}/\\sqrt{3}$。接触条件是 $2r_{\\mathrm{B}} = a_{\\mathrm{H}}/\\sqrt{3}$，这得出 $a_{\\mathrm{H}} = 2\\sqrt{3}r_{\\mathrm{B}}$。\n约束 (ii): Ti-B 最近邻接触。一个位于原点 $(0,0,0)$ 的 Ti 原子，其最近的 B 邻居位于诸如 $(1/3, 2/3, 1/2)$ 的分数坐标处。原点与该 B 原子之间的距离平方 $d_{\\mathrm{Ti-B}}^2$ 为：\n$$ d_{\\mathrm{Ti-B}}^2 = \\frac{a_{\\mathrm{H}}^2}{3} + \\left(\\frac{c_{\\mathrm{H}}}{2}\\right)^2 $$\n接触条件是 $r_{\\mathrm{Ti}} + r_{\\mathrm{B}} = d_{\\mathrm{Ti-B}}$。两边平方得 $(r_{\\mathrm{Ti}} + r_{\\mathrm{B}})^2 = \\frac{a_{\\mathrm{H}}^2}{3} + \\frac{c_{\\mathrm{H}}^2}{4}$。代入 $a_{\\mathrm{H}} = 2\\sqrt{3}r_{\\mathrm{B}}$：\n$$ (r_{\\mathrm{Ti}} + r_{\\mathrm{B}})^2 = \\frac{(2\\sqrt{3}r_{\\mathrm{B}})^2}{3} + \\frac{c_{\\mathrm{H}}^2}{4} = \\frac{12r_{\\mathrm{B}}^2}{3} + \\frac{c_{\\mathrm{H}}^2}{4} = 4r_{\\mathrm{B}}^2 + \\frac{c_{\\mathrm{H}}^2}{4} $$\n我们求解 $c_{\\mathrm{H}}$：\n$$ \\frac{c_{\\mathrm{H}}^2}{4} = (r_{\\mathrm{Ti}} + r_{\\mathrm{B}})^2 - 4r_{\\mathrm{B}}^2 = r_{\\mathrm{Ti}}^2 + 2r_{\\mathrm{Ti}}r_{\\mathrm{B}} - 3r_{\\mathrm{B}}^2 $$\n$$ c_{\\mathrm{H}} = 2\\sqrt{r_{\\mathrm{Ti}}^2 + 2r_{\\mathrm{Ti}}r_{\\mathrm{B}} - 3r_{\\mathrm{B}}^2} $$\n为了使 $c_{\\mathrm{H}}$ 为实数，根号下的项必须为非负：$r_{\\mathrm{Ti}}^2 + 2r_{\\mathrm{Ti}}r_{\\mathrm{B}} - 3r_{\\mathrm{B}}^2 \\ge 0$。除以 $r_{\\mathrm{B}}^2$ 并使用 $x \\equiv r_{\\mathrm{Ti}}/r_{\\mathrm{B}}$ 得 $x^2 + 2x - 3 \\ge 0$，即 $(x+3)(x-1) \\ge 0$。由于 $x$ 必须为正，这要求 $x \\ge 1$。\n现在我们计算晶胞体积：\n$$ V_{\\mathrm{cell}} = \\frac{\\sqrt{3}}{2} a_{\\mathrm{H}}^2 c_{\\mathrm{H}} = \\frac{\\sqrt{3}}{2} (12r_{\\mathrm{B}}^2) (2\\sqrt{r_{\\mathrm{Ti}}^2 + 2r_{\\mathrm{Ti}}r_{\\mathrm{B}} - 3r_{\\mathrm{B}}^2}) = 12\\sqrt{3}r_{\\mathrm{B}}^2 \\sqrt{r_{\\mathrm{B}}^2(x^2+2x-3)} = 12\\sqrt{3}r_{\\mathrm{B}}^3\\sqrt{x^2+2x-3} $$\nTiB$_2$ 的原子堆积因子为：\n$$ APF_{\\mathrm{TiB_2}} = \\frac{V_{\\mathrm{atoms}}}{V_{\\mathrm{cell}}} = \\frac{\\frac{4\\pi}{3}(r_{\\mathrm{Ti}}^3 + 2r_{\\mathrm{B}}^3)}{12\\sqrt{3}r_{\\mathrm{B}}^3\\sqrt{x^2+2x-3}} = \\frac{4\\pi r_{\\mathrm{B}}^3(x^3+2)}{36\\sqrt{3}r_{\\mathrm{B}}^3\\sqrt{x^2+2x-3}} $$\n$$ APF_{\\mathrm{TiB_2}} = \\frac{\\pi(x^3 + 2)}{9\\sqrt{3}\\sqrt{x^2+2x-3}} = \\frac{\\pi(x^3 + 2)}{9\\sqrt{3}\\sqrt{(x+3)(x-1)}} $$\n约束 (iii) 对 $x$ 提供了进一步的限制。Ti-Ti 面内无重叠要求 $2r_{\\mathrm{Ti}} \\le a_{\\mathrm{H}}$，所以 $2r_{\\mathrm{Ti}} \\le 2\\sqrt{3}r_{\\mathrm{B}}$，这意味着 $x \\le \\sqrt{3}$。沿 $c$ 轴的 Ti-Ti 无重叠要求 $2r_{\\mathrm{Ti}} \\le c_{\\mathrm{H}}$。将其平方得 $4r_{\\mathrm{Ti}}^2 \\le c_{\\mathrm{H}}^2 = 4(r_{\\mathrm{Ti}}^2 + 2r_{\\mathrm{Ti}}r_{\\mathrm{B}} - 3r_{\\mathrm{B}}^2)$，简化为 $0 \\le 2r_{\\mathrm{Ti}}r_{\\mathrm{B}} - 3r_{\\mathrm{B}}^2$，或 $3r_{\\mathrm{B}} \\le 2r_{\\mathrm{Ti}}$。这意味着 $x \\ge 3/2$。\n结合所有对 $x$ 的约束，我们有 $x \\ge 1$、$x \\le \\sqrt{3}$ 和 $x \\ge 3/2$。由于 $3/2 > 1$，因此 $x$ 的有效范围是 $3/2 \\le x \\le \\sqrt{3}$。\n\n最后，我们解决任务3：扩散路径的比较。\n\n分析必须基于每种晶体结构中间隙空间的拓扑结构。\nTiC 具有立方岩盐结构。这种高对称性结构导致了原子的各向同性分布，因此也导致了间隙空位的各向同性拓扑结构。小间隙物种的主要扩散路径将涉及在相邻的四面体空位之间跳跃，这些空位形成一个相互连接的网络。由于其立方对称性，沿所有等效晶体学方向的此类跳跃的能垒预计是相同的。因此，TiC 中的扩散预计是各向同性的。\n\n与此形成鲜明对比的是，TiB$_2$ 具有层状六方结构，这本身就是各向异性的。它由交替的 Ti 原子平面层和排列成刚性蜂窝状（石墨状）网络的 B 原子层组成。这种结构各向异性造成了高度各向异性的间隙空间。具体来说，硼六边形的中心沿 $c$ 轴排列，形成了贯穿结构的开放、连续的通道。这些通道为小间隙物种沿 $c$ 轴的扩散提供了一条低势能路径。相反，在基面内（垂直于 $c$ 轴）的扩散则需要扩散物种穿过密堆积的 B 层或挤过 B 和 Ti 原子，这一过程伴随着显著更高的能垒。\n\n因此，预计 TiB$_2$ 会表现出更各向异性的扩散路径。其层状原子排列沿 $c$ 轴方向创建了优先的、低阻力的扩散通道，导致该方向的扩散速度远快于基面内的方向。而 TiC 由于结构上是各向同性的，将表现出各向同性的扩散特性。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{2\\pi(y^2 - y + 1)}{3(y+1)^2} & \\frac{\\pi(x^3 + 2)}{9\\sqrt{3}\\sqrt{(x+3)(x-1)}}\n\\end{pmatrix}\n}\n$$", "id": "2517195"}, {"introduction": "在了解了耐火材料的微观结构之后，一个自然而然的问题是：它们是如何被制造出来的？自蔓延高温合成（SHS）是一种常见且高效的合成方法，它利用反应本身释放的巨大热量来维持合成过程。本练习 [@problem_id:2517170] 将指导您完成一个完整的热化学计算，以确定一个绝热反应所能达到的最高温度（绝热温度），这是评估SHS工艺可行性的一个关键参数。", "problem": "由元素锆和硼组成的化学计量压坯经过自蔓延高温合成（SHS）反应生成二硼化锆，反应式如下：\n$$ \\mathrm{Zr(s)} + 2\\,\\mathrm{B(s)} \\rightarrow \\mathrm{ZrB_{2}(condensed)} $$\n假设如下：\n- 压坯的初始温度为 $298\\ \\mathrm{K}$。\n- 该过程为恒压绝热过程，转化完全且无热量损失。\n- 仅存在凝聚相；没有气态产物。\n- 在 $298\\ \\mathrm{K}$ 时，$\\mathrm{ZrB_{2}(s)}$ 的标准摩尔生成焓为 $\\Delta H_{f}^{\\circ}(298\\ \\mathrm{K}) = -323.0\\ \\mathrm{kJ\\,mol^{-1}}$。\n- $\\mathrm{ZrB_{2}}$ 的摩尔热容随温度的变化如下：\n  - 对于固态 $\\mathrm{ZrB_{2}}$，在 $298\\ \\mathrm{K} \\le T \\le T_{m}$ 的温度范围内，\n  $$ C_{p,\\mathrm{s}}(T) = 45.0 + 0.0100\\,T\\quad \\mathrm{J\\,mol^{-1}\\,K^{-1}} $$\n  - 对于液态 $\\mathrm{ZrB_{2}}$，在 $T \\ge T_{m}$ 时，\n  $$ C_{p,\\mathrm{l}}(T) = 75.0 + 0.0150\\,T\\quad \\mathrm{J\\,mol^{-1}\\,K^{-1}} $$\n- $\\mathrm{ZrB_{2}}$ 的熔点为 $T_{m} = 3245\\ \\mathrm{K}$，其在熔点 $T_{m}$ 时的摩尔熔化焓为 $\\Delta H_{\\mathrm{fus}} = 95.0\\ \\mathrm{kJ\\,mol^{-1}}$。\n\n基于焓的能量守恒，计算在这些条件下产物 $\\mathrm{ZrB_{2}}$ 达到的绝热温度 $T_{\\mathrm{ad}}$。如果绝热温度超过熔点，则计入一次熔化焓，并继续在液态下进行显热加热。\n\n以 $\\mathrm{K}$ 为单位表示最终答案，并将结果四舍五入至四位有效数字。", "solution": "所述问题具有科学依据，提法恰当，客观，并包含足够的信息以得到唯一解。这是一个材料热化学中的标准问题。因此，我们可以进行计算。\n\n问题要求计算二硼化锆 ($\\mathrm{ZrB_{2}}$) 自蔓延高温合成 (SHS) 的绝热温度 $T_{\\mathrm{ad}}$。恒压绝热过程的控制原理是系统的总焓变为零，即 $\\Delta H_{\\mathrm{sys}} = 0$。\n\n我们可以构建一个从初始状态（反应物在 $T_{i} = 298\\ \\mathrm{K}$）到最终状态（产物在 $T_{\\mathrm{ad}}$）的假设热力学路径。一个方便的路径是：\n1.  反应 $\\mathrm{Zr(s)} + 2\\,\\mathrm{B(s)} \\rightarrow \\mathrm{ZrB_{2}(s)}$ 在初始温度 $T_{i} = 298\\ \\mathrm{K}$ 下等温发生。此步骤的焓变为标准反应焓 $\\Delta H_{\\mathrm{rxn}}^{\\circ}(298\\ \\mathrm{K})$。\n2.  产物 $\\mathrm{ZrB_{2}}$ 吸收反应释放的热量，并从 $T_{i} = 298\\ \\mathrm{K}$ 加热到最终绝热温度 $T_{\\mathrm{ad}}$。此步骤的焓变为 $\\Delta H_{\\mathrm{heating}}$。\n\n因此，能量平衡为：\n$$ \\Delta H_{\\mathrm{sys}} = \\Delta H_{\\mathrm{rxn}}^{\\circ}(298\\ \\mathrm{K}) + \\Delta H_{\\mathrm{heating}} = 0 $$\n$$ \\implies \\Delta H_{\\mathrm{heating}} = - \\Delta H_{\\mathrm{rxn}}^{\\circ}(298\\ \\mathrm{K}) $$\n\n首先，我们确定标准条件下的反应焓。给定的反应是 $\\mathrm{ZrB_{2}}$ 从其处于标准状态的组分元素生成。因此，标准反应焓等于 $\\mathrm{ZrB_{2}}$ 的标准摩尔生成焓。\n$$ \\Delta H_{\\mathrm{rxn}}^{\\circ}(298\\ \\mathrm{K}) = \\Delta H_{f}^{\\circ}(\\mathrm{ZrB_{2}}, 298\\ \\mathrm{K}) = -323.0\\ \\mathrm{kJ\\,mol^{-1}} = -323000\\ \\mathrm{J\\,mol^{-1}} $$\n可用于提高产物温度的热量为：\n$$ Q = - \\Delta H_{\\mathrm{rxn}}^{\\circ}(298\\ \\mathrm{K}) = 323000\\ \\mathrm{J\\,mol^{-1}} $$\n\n接下来，我们必须通过计算加热产物 $\\mathrm{ZrB_{2}}$ 所需的焓来确定最终温度 $T_{\\mathrm{ad}}$。我们必须考虑相变（熔化）的可能性。给定的熔点为 $T_{m} = 3245\\ \\mathrm{K}$。\n\n步骤1：计算将固态 $\\mathrm{ZrB_{2}}$ 从 $T_{i} = 298\\ \\mathrm{K}$ 加热到熔点 $T_{m} = 3245\\ \\mathrm{K}$ 所需的焓。\n固态 $\\mathrm{ZrB_{2}}$ 的热容为 $C_{p,\\mathrm{s}}(T) = 45.0 + 0.0100\\,T\\ \\ \\mathrm{J\\,mol^{-1}\\,K^{-1}}$。\n$$ \\Delta H_{\\mathrm{s}} = \\int_{T_{i}}^{T_{m}} C_{p,\\mathrm{s}}(T) \\,dT = \\int_{298}^{3245} (45.0 + 0.0100\\,T) \\,dT $$\n$$ \\Delta H_{\\mathrm{s}} = \\left[ 45.0\\,T + \\frac{0.0100}{2}T^{2} \\right]_{298}^{3245} = \\left[ 45.0\\,T + 0.0050\\,T^{2} \\right]_{298}^{3245} $$\n$$ \\Delta H_{\\mathrm{s}} = (45.0 \\times 3245 + 0.0050 \\times 3245^{2}) - (45.0 \\times 298 + 0.0050 \\times 298^{2}) $$\n$$ \\Delta H_{\\mathrm{s}} = (146025 + 0.0050 \\times 10530025) - (13410 + 0.0050 \\times 88804) $$\n$$ \\Delta H_{\\mathrm{s}} = (146025 + 52650.125) - (13410 + 444.02) = 198675.125 - 13854.02 = 184821.105\\ \\mathrm{J\\,mol^{-1}} $$\n可用热量 $Q = 323000\\ \\mathrm{J\\,mol^{-1}}$ 大于 $\\Delta H_{\\mathrm{s}}$。这表明产物达到了其熔点，并且有多余的能量来引发相变。\n\n步骤2：计算加热到 $T_{m}$ 后剩余的能量并考虑熔化焓。\n给定的熔化焓为 $\\Delta H_{\\mathrm{fus}} = 95.0\\ \\mathrm{kJ\\,mol^{-1}} = 95000\\ \\mathrm{J\\,mol^{-1}}$。\n将固体加热到其熔点然后完全熔化所需的总焓为：\n$$ \\Delta H_{\\mathrm{s}} + \\Delta H_{\\mathrm{fus}} = 184821.105 + 95000 = 279821.105\\ \\mathrm{J\\,mol^{-1}} $$\n由于 $Q = 323000\\ \\mathrm{J\\,mol^{-1}}$ 大于此总和，$\\mathrm{ZrB_{2}}$ 将完全熔化，并且所得液体将被进一步加热。加热液相的剩余能量为：\n$$ Q_{\\mathrm{rem}} = Q - (\\Delta H_{\\mathrm{s}} + \\Delta H_{\\mathrm{fus}}) = 323000 - 279821.105 = 43178.895\\ \\mathrm{J\\,mol^{-1}} $$\n\n步骤3：通过将液态 $\\mathrm{ZrB_{2}}$ 从 $T_{m} = 3245\\ \\mathrm{K}$ 加热到 $T_{\\mathrm{ad}}$ 来计算最终温度 $T_{\\mathrm{ad}}$。\n液态 $\\mathrm{ZrB_{2}}$ 的热容为 $C_{p,\\mathrm{l}}(T) = 75.0 + 0.0150\\,T\\ \\ \\mathrm{J\\,mol^{-1}\\,K^{-1}}$。\n剩余的热量被液体吸收：\n$$ Q_{\\mathrm{rem}} = \\int_{T_{m}}^{T_{\\mathrm{ad}}} C_{p,\\mathrm{l}}(T) \\,dT = \\int_{3245}^{T_{\\mathrm{ad}}} (75.0 + 0.0150\\,T) \\,dT $$\n$$ 43178.895 = \\left[ 75.0\\,T + \\frac{0.0150}{2}T^{2} \\right]_{3245}^{T_{\\mathrm{ad}}} = \\left[ 75.0\\,T + 0.0075\\,T^{2} \\right]_{3245}^{T_{\\mathrm{ad}}} $$\n$$ 43178.895 = (75.0\\,T_{\\mathrm{ad}} + 0.0075\\,T_{\\mathrm{ad}}^{2}) - (75.0 \\times 3245 + 0.0075 \\times 3245^{2}) $$\n$$ 43178.895 = (75.0\\,T_{\\mathrm{ad}} + 0.0075\\,T_{\\mathrm{ad}}^{2}) - (243375 + 0.0075 \\times 10530025) $$\n$$ 43178.895 = (75.0\\,T_{\\mathrm{ad}} + 0.0075\\,T_{\\mathrm{ad}}^{2}) - (243375 + 78975.1875) $$\n$$ 43178.895 = 75.0\\,T_{\\mathrm{ad}} + 0.0075\\,T_{\\mathrm{ad}}^{2} - 322350.1875 $$\n将其重排为标准二次方程形式 $a T_{\\mathrm{ad}}^2 + b T_{\\mathrm{ad}} + c = 0$：\n$$ 0.0075\\,T_{\\mathrm{ad}}^{2} + 75.0\\,T_{\\mathrm{ad}} - (322350.1875 + 43178.895) = 0 $$\n$$ 0.0075\\,T_{\\mathrm{ad}}^{2} + 75.0\\,T_{\\mathrm{ad}} - 365529.0825 = 0 $$\n我们使用二次公式 $T_{\\mathrm{ad}} = \\frac{-b \\pm \\sqrt{b^{2}-4ac}}{2a}$ 求解 $T_{\\mathrm{ad}}$：\n$$ T_{\\mathrm{ad}} = \\frac{-75.0 \\pm \\sqrt{75.0^{2} - 4(0.0075)(-365529.0825)}}{2(0.0075)} $$\n$$ T_{\\mathrm{ad}} = \\frac{-75.0 \\pm \\sqrt{5625 + 10965.872475}}{0.0150} $$\n$$ T_{\\mathrm{ad}} = \\frac{-75.0 \\pm \\sqrt{16590.872475}}{0.0150} $$\n$$ T_{\\mathrm{ad}} = \\frac{-75.0 \\pm 128.80556}{0.0150} $$\n出现了两个解。正根是唯一具有物理意义的解，因为温度必须为正且大于 $T_{m}$。\n$$ T_{\\mathrm{ad}} = \\frac{-75.0 + 128.80556}{0.0150} = \\frac{53.80556}{0.0150} \\approx 3587.037\\ \\mathrm{K} $$\n负根因不符合物理实际而被舍弃。绝热温度约为 $3587.037\\ \\mathrm{K}$。根据问题要求四舍五入到四位有效数字，得到 $T_{\\mathrm{ad}} = 3587\\ \\mathrm{K}$。\n该值大于熔点 $T_{m} = 3245\\ \\mathrm{K}$，这证实了我们选择的计算路径是正确的。", "answer": "$$\n\\boxed{3587}\n$$", "id": "2517170"}, {"introduction": "现代材料科学不仅局限于研究已知材料，更致力于预测和发现具有优异性能的新型稳定材料。密度泛函理论（DFT）与凸包（convex hull）分析相结合，是实现这一目标的核心计算工具。本练习 [@problem_id:2517139] 提供了一个概念完整且贴近科研实践的任务：利用DFT计算得出的能量数据，构建Ti-C-N三元体系的相图，并据此区分热力学稳定相与亚稳相，让您亲身体验计算材料设计的强大能力。", "problem": "给定一项任务，要求您实现一个程序，用于形式化密度泛函理论（DFT）中的形成能概念，并利用该概念构建钛-碳-氮三元体系的组分下凸包，以便将物相分类为稳定相（位于凸包上）或亚稳相（位于凸包之上）。该程序必须计算指定相的凸包之上能量。\n\n请从以下基本原理和核心定义开始：\n- 一个相的每个原子的DFT总能量是DFT计算中经过充分验证的输出，用 $E_{\\mathrm{DFT}}$ 表示（单位为 $\\mathrm{eV/atom}$）。\n- 元素 $i$ 的化学势 $\\mu_i$（单位为 $\\mathrm{eV/atom}$）代表元素相在其参考态下每个原子的能量。\n- 对于一个组分分数为 $(x_{\\mathrm{Ti}}, x_{\\mathrm{C}}, x_{\\mathrm{N}})$ 的相，其中 $x_{\\mathrm{Ti}} \\ge 0$，$x_{\\mathrm{C}} \\ge 0$，$x_{\\mathrm{N}} \\ge 0$ 且 $x_{\\mathrm{Ti}} + x_{\\mathrm{C}} + x_{\\mathrm{N}} = 1$，每个原子的DFT形成能定义为\n$$\nE_{\\mathrm{form}} = E_{\\mathrm{DFT}} - \\left( x_{\\mathrm{Ti}} \\mu_{\\mathrm{Ti}} + x_{\\mathrm{C}} \\mu_{\\mathrm{C}} + x_{\\mathrm{N}} \\mu_{\\mathrm{N}} \\right).\n$$\n- 在 $(x_{\\mathrm{C}}, x_{\\mathrm{N}}, E_{\\mathrm{form}})$ 空间中，下凸包是由一系列平面组成的面集，这些平面定义了一个从下方包围所有数据点的最小分段线性曲面。如果一个相的 $(x_{\\mathrm{C}}, x_{\\mathrm{N}}, E_{\\mathrm{form}})$ 点位于此曲面上，则该相位于凸包上；否则，其凸包之上能量定义为\n$$\nE_{\\mathrm{above}} = E_{\\mathrm{form}} - E_{\\mathrm{hull}}(x_{\\mathrm{C}}, x_{\\mathrm{N}}),\n$$\n其中 $E_{\\mathrm{hull}}(x_{\\mathrm{C}}, x_{\\mathrm{N}})$ 是在 $(x_{\\mathrm{C}}, x_{\\mathrm{N}})$ 处评估的凸包能量。根据定义，$E_{\\mathrm{above}} \\ge 0$。\n\n请仅使用下面提供的数据，实现以下内容：\n- 使用给定的元素化学势（单位为 $\\mathrm{eV/atom}$）：$\\mu_{\\mathrm{Ti}} = -6.80\\,\\mathrm{eV/atom}$，$\\mu_{\\mathrm{C}} = -7.40\\,\\mathrm{eV/atom}$，$\\mu_{\\mathrm{N}} = -8.00\\,\\mathrm{eV/atom}$。\n- 对于每个相，根据 $E_{\\mathrm{DFT}}$ 和 $(x_{\\mathrm{Ti}}, x_{\\mathrm{C}}, x_{\\mathrm{N}})$ 计算 $E_{\\mathrm{form}}$。\n- 在 $(x_{\\mathrm{C}}, x_{\\mathrm{N}}, E_{\\mathrm{form}})$ 空间中构建包含所有相（元素和化合物）的下凸包。从下凸包的三角面分段线性地确定 $E_{\\mathrm{hull}}$。\n- 对于下面指定的测试套件，计算每个相的 $E_{\\mathrm{above}}$。\n\n使用以下相数据集；每个条目给出一个唯一标签、组分分数 $(x_{\\mathrm{Ti}}, x_{\\mathrm{C}}, x_{\\mathrm{N}})$ 和每个原子的DFT总能量 $E_{\\mathrm{DFT}}$：\n- $\\text{Ti}$: $(x_{\\mathrm{Ti}}, x_{\\mathrm{C}}, x_{\\mathrm{N}}) = (1, 0, 0)$, $E_{\\mathrm{DFT}} = -6.80\\,\\mathrm{eV/atom}$。\n- $\\text{C}$: $(x_{\\mathrm{Ti}}, x_{\\mathrm{C}}, x_{\\mathrm{N}}) = (0, 1, 0)$, $E_{\\mathrm{DFT}} = -7.40\\,\\mathrm{eV/atom}$。\n- $\\text{N}$: $(x_{\\mathrm{Ti}}, x_{\\mathrm{C}}, x_{\\mathrm{N}}) = (0, 0, 1)$, $E_{\\mathrm{DFT}} = -8.00\\,\\mathrm{eV/atom}$。\n- $\\text{TiC}$: $(x_{\\mathrm{Ti}}, x_{\\mathrm{C}}, x_{\\mathrm{N}}) = (0.5, 0.5, 0)$, $E_{\\mathrm{DFT}} = -8.30\\,\\mathrm{eV/atom}$。\n- $\\text{TiN}$: $(x_{\\mathrm{Ti}}, x_{\\mathrm{C}}, x_{\\mathrm{N}}) = (0.5, 0, 0.5)$, $E_{\\mathrm{DFT}} = -8.50\\,\\mathrm{eV/atom}$。\n- $\\text{Ti(C0.5N0.5)-ordered1}$: $(x_{\\mathrm{Ti}}, x_{\\mathrm{C}}, x_{\\mathrm{N}}) = (0.5, 0.25, 0.25)$, $E_{\\mathrm{DFT}} = -8.48\\,\\mathrm{eV/atom}$。\n- $\\text{Ti(C0.5N0.5)-ordered2}$: $(x_{\\mathrm{Ti}}, x_{\\mathrm{C}}, x_{\\mathrm{N}}) = (0.5, 0.25, 0.25)$, $E_{\\mathrm{DFT}} = -8.40\\,\\mathrm{eV/atom}$。\n- $\\text{TiC0.25N0.75}$: $(x_{\\mathrm{Ti}}, x_{\\mathrm{C}}, x_{\\mathrm{N}}) = (0.5, 0.125, 0.375)$, $E_{\\mathrm{DFT}} = -8.47\\,\\mathrm{eV/atom}$。\n- $\\text{TiC0.75N0.25}$: $(x_{\\mathrm{Ti}}, x_{\\mathrm{C}}, x_{\\mathrm{N}}) = (0.5, 0.375, 0.125)$, $E_{\\mathrm{DFT}} = -8.38\\,\\mathrm{eV/atom}$。\n- $\\text{Ti2C}$: $(x_{\\mathrm{Ti}}, x_{\\mathrm{C}}, x_{\\mathrm{N}}) = (\\tfrac{2}{3}, \\tfrac{1}{3}, 0)$, $E_{\\mathrm{DFT}} = -7.40\\,\\mathrm{eV/atom}$。\n- $\\text{Ti2N}$: $(x_{\\mathrm{Ti}}, x_{\\mathrm{C}}, x_{\\mathrm{N}}) = (\\tfrac{2}{3}, 0, \\tfrac{1}{3})$, $E_{\\mathrm{DFT}} = -7.80\\,\\mathrm{eV/atom}$。\n- $\\text{Ti3C2}$: $(x_{\\mathrm{Ti}}, x_{\\mathrm{C}}, x_{\\mathrm{N}}) = (0.6, 0.4, 0)$, $E_{\\mathrm{DFT}} = -7.34\\,\\mathrm{eV/atom}$。\n- $\\text{Ti3N2}$: $(x_{\\mathrm{Ti}}, x_{\\mathrm{C}}, x_{\\mathrm{N}}) = (0.6, 0, 0.4)$, $E_{\\mathrm{DFT}} = -7.78\\,\\mathrm{eV/atom}$。\n\n测试套件:\n- 按照确切顺序，为以下相计算凸包之上能量 $E_{\\mathrm{above}}$（单位为 $\\mathrm{eV/atom}$）：\n$$\n[\\text{Ti}, \\text{C}, \\text{N}, \\text{TiC}, \\text{TiN}, \\text{Ti(C0.5N0.5)-ordered1}, \\text{Ti(C0.5N0.5)-ordered2}, \\text{TiC0.25N0.75}, \\text{TiC0.75N0.25}, \\text{Ti2C}, \\text{Ti2N}, \\text{Ti3C2}, \\text{Ti3N2}].\n$$\n\n程序要求：\n- 使用上述定义，从基本原理出发，实现 $E_{\\mathrm{form}}$ 的计算和下凸包的构建。\n- 将每个测试用例的最终结果 $E_{\\mathrm{above}}$ 以 $\\mathrm{eV/atom}$ 为单位表示，并四舍五入到三位小数。\n- 您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果（例如，$\\left[\\text{result}_1,\\text{result}_2,\\ldots\\right]$），不含多余的空格或文本。\n- 此任务不涉及角度计算。\n- 不要求也不允许用户输入；所有数据必须嵌入到程序中。", "solution": "所陈述的问题是有效的。这是一个在计算材料化学领域中定义明确的问题，其基础是密度泛函理论（DFT）和热力学稳定性分析的既定原则。所有必要的数据和定义均已提供，目标清晰且可形式化。我们将着手进行求解。\n\n任务是确定钛-碳-氮（Ti-C-N）三元体系中若干相的热力学稳定性。稳定性通过计算每个相的凸包之上能量 $E_{\\mathrm{above}}$ 来评估。如果一个相位于形成能的下凸包上（$E_{\\mathrm{above}} = 0$），则该相是稳定的；否则（$E_{\\mathrm{above}} > 0$），它是亚稳的。\n\n解决方案是通过遵循一系列源于材料热力学基本原理的逻辑步骤来构建的。\n\n首先，我们必须为给定的13个相中的每一个计算其单位原子的形成能 $E_{\\mathrm{form}}$。形成能用于量化当一个化合物由其处于参考态的组分元素形成时的能量变化。它由以下方程定义：\n$$\nE_{\\mathrm{form}} = E_{\\mathrm{DFT}} - \\sum_{i} x_i \\mu_i\n$$\n其中 $E_{\\mathrm{DFT}}$ 是通过DFT计算得到的相的单位原子总能量，$x_i$ 是元素 $i$ 的原子分数，而 $\\mu_i$ 是元素 $i$ 在其稳定元素参考态下的化学势。对于Ti-C-N体系，该公式为：\n$$\nE_{\\mathrm{form}} = E_{\\mathrm{DFT}} - \\left( x_{\\mathrm{Ti}} \\mu_{\\mathrm{Ti}} + x_{\\mathrm{C}} \\mu_{\\mathrm{C}} + x_{\\mathrm{N}} \\mu_{\\mathrm{N}} \\right)\n$$\n给定的化学势为 $\\mu_{\\mathrm{Ti}} = -6.80\\,\\mathrm{eV/atom}$，$\\mu_{\\mathrm{C}} = -7.40\\,\\mathrm{eV/atom}$ 和 $\\mu_{\\mathrm{N}} = -8.00\\,\\mathrm{eV/atom}$。每个相的组分 $(x_{\\mathrm{Ti}}, x_{\\mathrm{C}}, x_{\\mathrm{N}})$ 和 $E_{\\mathrm{DFT}}$ 均已提供。根据定义，元素相Ti、C和N的形成能为 $0\\,\\mathrm{eV/atom}$。\n\n第二，我们构建热力学基态包络面。对于给定的组分，可能存在多种结构排列（多晶型或有序结构），每种都有不同的 $E_{\\mathrm{DFT}}$。在给定组分下，热力学最稳定的相是形成能最低的那个。在所提供的数据中，组分为 $(x_{\\mathrm{Ti}}, x_{\\mathrm{C}}, x_{\\mathrm{N}}) = (0.5, 0.25, 0.25)$ 时存在两个相。我们必须确定该组分以及任何其他具有多个条目的组分下的基态，以构建凸包。所有其他相根据定义都是亚稳的。我们汇集一组点，代表数据集中每个唯一组分的基态相。这些位于三维空间 $(x_{\\mathrm{C}}, x_{\\mathrm{N}}, E_{\\mathrm{form}})$ 中的点，是我们构建凸包的顶点。\n\n第三，我们计算这组基态点的下凸包。凸包是包含所有点的最小凸集。在几何上，三维空间中的凸包是一个多面体，其顶点是输入点的一个子集。下凸包是该多面体表面形成下边界的部分。它代表了相图的基态线（或面）：任何稳定相的线性组合所具有的能量都位于该表面之上或之上。我们使用 `scipy.spatial.ConvexHull` 算法来寻找完整的三维凸包。构成下凸包的面（三角形）通过其法向量来识别；如果一个面的朝外法向量沿着 $E_{\\mathrm{form}}$ 轴的分量为负，则该面是下凸包的一部分。\n\n第四，对于原始测试套件中的每个相，我们计算其凸包之上能量 $E_{\\mathrm{above}}$。其定义为：\n$$\nE_{\\mathrm{above}} = E_{\\mathrm{form}} - E_{\\mathrm{hull}}(x_{\\mathrm{C}}, x_{\\mathrm{N}})\n$$\n其中 $E_{\\mathrm{hull}}(x_{\\mathrm{C}}, x_{\\mathrm{N}})$ 是在组分 $(x_{\\mathrm{C}}, x_{\\mathrm{N}})$ 处的下凸包能量。为了找到 $E_{\\mathrm{hull}}$，我们必须执行一个几何查询。下凸包的面顶点投影到 $(x_{\\mathrm{C}}, x_{\\mathrm{N}})$ 平面上时，形成一个点集。我们对这些投影点构建一个二维Delaunay三角剖分。这个三角剖分将组分空间划分为多个三角形，每个三角形对应下凸包的一个面。对于一个给定组分为 $(x_{\\mathrm{C}}, x_{\\mathrm{N}})$ 的测试相，我们首先定位包含该点的Delaunay三角形。然后，通过对该三角形三个顶点的 $E_{\\mathrm{form}}$ 值进行线性重心插值，来找到该点处的凸包能量 $E_{\\mathrm{hull}}$。如果一个相的点 $(x_{\\mathrm{C}}, x_{\\mathrm{N}}, E_{\\mathrm{form}})$ 是下凸包的顶点之一，那么根据定义，其 $E_{\\mathrm{above}}$ 为 $0$。对于一个亚稳相，其点位于凸包之上，从而产生一个正的 $E_{\\mathrm{above}}$。由于浮点运算，任何计算出的非常接近于零（例如，$< 10^{-9}$）的 $E_{\\mathrm{above}}$ 值都被视为零。\n\n测试套件中每个相的最终计算出的 $E_{\\mathrm{above}}$ 值按要求四舍五入到三位小数。整个过程在一个Python程序中实现，该程序作为此问题的答案提供。\n```python\nimport numpy as np\nfrom scipy.spatial import ConvexHull, Delaunay\n\ndef solve():\n    \"\"\"\n    Computes the energy above the convex hull for phases in the Ti-C-N system.\n    \"\"\"\n    # Define chemical potentials in eV/atom\n    mu = {\n        'Ti': -6.80,\n        'C': -7.40,\n        'N': -8.00,\n    }\n\n    # Dataset of phases from the problem statement\n    # Format: (label, (x_Ti, x_C, x_N), E_DFT)\n    test_cases_data = [\n        (\"Ti\", (1, 0, 0), -6.80),\n        (\"C\", (0, 1, 0), -7.40),\n        (\"N\", (0, 0, 1), -8.00),\n        (\"TiC\", (0.5, 0.5, 0), -8.30),\n        (\"TiN\", (0.5, 0, 0.5), -8.50),\n        (\"Ti(C0.5N0.5)-ordered1\", (0.5, 0.25, 0.25), -8.48),\n        (\"Ti(C0.5N0.5)-ordered2\", (0.5, 0.25, 0.25), -8.40),\n        (\"TiC0.25N0.75\", (0.5, 0.125, 0.375), -8.47),\n        (\"TiC0.75N0.25\", (0.5, 0.375, 0.125), -8.38),\n        (\"Ti2C\", (2/3, 1/3, 0), -7.40),\n        (\"Ti2N\", (2/3, 0, 1/3), -7.80),\n        (\"Ti3C2\", (0.6, 0.4, 0), -7.34),\n        (\"Ti3N2\", (0.6, 0, 0.4), -7.78),\n    ]\n\n    # Step 1: Calculate formation energy for all phases\n    all_phases = []\n    for label, comp, e_dft in test_cases_data:\n        x_ti, x_c, x_n = comp\n        e_ref = x_ti * mu['Ti'] + x_c * mu['C'] + x_n * mu['N']\n        e_form = e_dft - e_ref\n        all_phases.append({\n            \"label\": label,\n            \"comp_2d\": (x_c, x_n),\n            \"e_form\": e_form\n        })\n\n    # Step 2: Identify ground states for convex hull construction\n    ground_states = {}\n    for phase in all_phases:\n        comp_2d = phase[\"comp_2d\"]\n        e_form = phase[\"e_form\"]\n        if comp_2d not in ground_states or e_form  ground_states[comp_2d][\"e_form\"]:\n            ground_states[comp_2d] = phase\n    \n    hull_points_data = list(ground_states.values())\n    hull_points = np.array([[p[\"comp_2d\"][0], p[\"comp_2d\"][1], p[\"e_form\"]] for p in hull_points_data])\n\n    # Step 3: Construct the 3D convex hull and identify lower hull vertices\n    hull = ConvexHull(hull_points)\n    \n    # A facet is on the lower hull if its normal vector's z-component is negative.\n    lower_hull_facet_indices = np.where(hull.equations[:, 2]  0)[0]\n    \n    lower_hull_vertex_indices = np.unique(hull.simplices[lower_hull_facet_indices].flatten())\n    \n    lower_hull_points = hull.points[lower_hull_vertex_indices]\n\n    # Step 4: Triangulate the 2D projection of the lower hull points\n    lower_hull_points_2d = lower_hull_points[:, :2]\n    tri = Delaunay(lower_hull_points_2d)\n\n    # Step 5: Calculate energy above hull for each phase in the test suite\n    results = []\n    TOL = 1e-9 # Tolerance for floating point comparisons\n    \n    for phase in all_phases:\n        comp_2d = np.array(phase[\"comp_2d\"])\n        e_form = phase[\"e_form\"]\n        \n        simplex_index = tri.find_simplex(comp_2d)\n        \n        if simplex_index == -1:\n            dists = np.sum((lower_hull_points_2d - comp_2d)**2, axis=1)\n            closest_vertex_idx = np.argmin(dists)\n            e_hull = lower_hull_points[closest_vertex_idx, 2]\n\n        else:\n            simplex_vertices = tri.simplices[simplex_index]\n            \n            T = tri.transform[simplex_index, :2, :2]\n            r = tri.transform[simplex_index, 2, :]\n            bary_coords_AB = T @ (comp_2d - r)\n            \n            bary_coords = np.append(bary_coords_AB, 1 - np.sum(bary_coords_AB))\n            \n            vertex_energies = lower_hull_points[simplex_vertices, 2]\n            \n            e_hull = np.dot(bary_coords, vertex_energies)\n\n        e_above = e_form - e_hull\n        \n        if e_above  TOL:\n            e_above = 0.0\n            \n        results.append(round(e_above, 3))\n        \n    return f\"[{','.join(map(str, ['{:.3f}'.format(r) for r in results]))}]\"\n```", "answer": "[0.000,0.000,0.000,0.000,0.000,0.000,0.080,0.000,0.000,0.400,0.133,0.660,0.167]", "id": "2517139"}]}