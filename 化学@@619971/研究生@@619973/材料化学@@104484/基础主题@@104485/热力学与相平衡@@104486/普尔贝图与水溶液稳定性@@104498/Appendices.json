{"hands_on_practices": [{"introduction": "在评估材料在水溶液中的稳定性之前，我们必须首先界定溶剂——水本身的热力学稳定区域。这个稳定“窗口”构成了任何水体系普拜图的基础。这项练习将引导您从第一性原理出发，推导限定水稳定窗口的两条边界线（析氢反应和析氧反应）在电势-pH图上的斜率 [@problem_id:2515014]。掌握这一推导过程将揭示为何许多平衡线的斜率都是一个常数，并加深您对能斯特方程在复杂体系中应用的理解。", "problem": "水的普拜图（Pourbaix diagram）描绘了液态水在热力学上稳定，不会还原为氢气或氧化为氧气的电位 ($E$) 和酸度 ($\\text{pH}$) 范围。在酸性水溶液中，作为还原反应的边界半反应是：\n- $2\\text{H}^+ + 2e^- \\rightleftharpoons \\text{H}_2(g)$\n- $\\text{O}_2(g) + 4\\text{H}^+ + 4e^- \\rightleftharpoons 2\\text{H}_2\\text{O}(\\ell)$\n\n假设水合质子表现出理想行为，使得 $a_{\\text{H}^+} \\approx 10^{-\\text{pH}}$，液态水的活度为1，气体在其标准状态下的逸度为1。设电极电位 $E$ 以标准氢电极 (SHE) 为参比，且 $\\text{pH} = -\\log_{10} a_{\\text{H}^+}$。使用能斯特方程（适用于一般半反应）以及化学活度和 $\\text{pH}$ 的定义作为基本输入。取温度 $T = 298.15\\,\\text{K}$，普适气体常数 $R = 8.314462618\\,\\text{J mol}^{-1} \\text{K}^{-1}$，法拉第常数 $F = 96485.33212\\,\\text{C mol}^{-1}$。\n\n(a) 从第一性原理出发，推导上述两个水稳定性半反应中，每个反应的 $E$ 对 $\\text{pH}$ 的依赖关系，并证明两者的斜率 $\\mathrm{d}E/\\mathrm{d}(\\text{pH})$ 相同。你的推导必须明确地将能斯特方程中 $\\text{H}^+$ 的化学计量系数和电子数 $n$ 与 $\\text{pH}$-斜率联系起来。\n\n(b) 在 $T = 298.15\\,\\text{K}$ 时数值计算这个共同的斜率。将你的最终结果表示为单个实数，单位是伏特/pH单位。将你的最终答案四舍五入到四位有效数字。在最终的方框答案中不要写单位；在其他地方，单位应报告为伏特/pH单位。", "solution": "所给出的问题是基础电化学中的一个标准练习，并且是完全有效的。它要求从能斯特方程出发，推导水稳定性极限的电位-pH关系。我们将进行严谨的推导。\n\n(a) 推导 $E$ 对 $\\text{pH}$ 的依赖关系和共同斜率。\n\n分析始于温度 $T$ 下一般电化学半反应的能斯特方程：\n$$ \\text{Ox} + n e^{-} \\rightleftharpoons \\text{Red} $$\n其中 $\\text{Ox}$ 代表氧化态物种，$\\text{Red}$ 代表还原态物种，$n$ 是转移的电子数。相对于标准氢电极 (SHE) 的电极电位 $E$ 由下式给出：\n$$ E = E^{\\circ} - \\frac{RT}{nF} \\ln Q $$\n此处，$E^{\\circ}$ 是标准电极电位，$R$ 是普适气体常数，$F$ 是法拉第常数，$Q$ 是反应商，由参与反应物种的活度 ($a_i$) 定义，$Q = \\frac{\\prod a_{\\text{Red}}^{|\\nu_{\\text{Red}}|}}{\\prod a_{\\text{Ox}}^{|\\nu_{\\text{Ox}}|}} 。$\n\n许多半反应，包括定义水稳定性的那些反应，都涉及质子 $\\text{H}^{+}$。我们考虑这种反应写为还原形式的一般形式：\n$$ \\alpha\\,\\text{Ox} + m\\,\\text{H}^{+} + n\\,e^{-} \\rightleftharpoons \\beta\\,\\text{Red} + w\\,\\text{H}_{2}\\text{O} $$\n这个一般过程的反应商是：\n$$ Q = \\frac{a_{\\text{Red}}^{\\beta} \\, a_{\\text{H}_{2}\\text{O}}^{w}}{a_{\\text{Ox}}^{\\alpha} \\, a_{\\text{H}^{+}}^{m}} $$\n将此代入能斯特方程得到：\n$$ E = E^{\\circ} - \\frac{RT}{nF} \\ln \\left( \\frac{a_{\\text{Red}}^{\\beta} \\, a_{\\text{H}_{2}\\text{O}}^{w}}{a_{\\text{Ox}}^{\\alpha} \\, a_{\\text{H}^{+}}^{m}} \\right) $$\n利用对数的性质，可以重新整理此表达式：\n$$ E = E^{\\circ} - \\frac{RT}{nF} \\left( \\ln(a_{\\text{Red}}^{\\beta}) + \\ln(a_{\\text{H}_{2}\\text{O}}^{w}) - \\ln(a_{\\text{Ox}}^{\\alpha}) - \\ln(a_{\\text{H}^{+}}^{m}) \\right) $$\n$$ E = E^{\\circ} - \\frac{RT}{nF} \\ln \\left( \\frac{a_{\\text{Red}}^{\\beta} \\, a_{\\text{H}_{2}\\text{O}}^{w}}{a_{\\text{Ox}}^{\\alpha}} \\right) + \\frac{mRT}{nF} \\ln(a_{\\text{H}^{+}}) $$\n问题定义 $\\text{pH} = -\\log_{10}(a_{\\text{H}^{+}})$。我们必须将自然对数转换为以10为底的对数：$\\ln(x) = (\\ln 10) \\log_{10}(x)$。因此，$\\ln(a_{\\text{H}^{+}}) = (\\ln 10) \\log_{10}(a_{\\text{H}^{+}}) = -(\\ln 10)\\,\\text{pH}$。代入此式，得到电位作为 $\\text{pH}$ 的函数：\n$$ E = E^{\\circ} - \\frac{RT}{nF} \\ln \\left( \\frac{a_{\\text{Red}}^{\\beta} \\, a_{\\text{H}_{2}\\text{O}}^{w}}{a_{\\text{Ox}}^{\\alpha}} \\right) - \\frac{m}{n} \\frac{RT\\ln 10}{F} \\text{pH} $$\n对于普拜图的稳定性线，除 $\\text{H}^{+}$ 外，所有物种的活度均取为1。即，$a_{\\text{Ox}} = 1$，$a_{\\text{Red}} = 1$，且 $a_{\\text{H}_{2}\\text{O}} = 1$。在这些标准条件下，方程简化为：\n$$ E = E^{\\circ} - \\frac{m}{n} \\frac{RT\\ln 10}{F} \\text{pH} $$\n电位相对于 $\\text{pH}$ 的斜率是导数 $\\frac{\\mathrm{d}E}{\\mathrm{d}(\\text{pH})}$。从上述方程可以立即看出：\n$$ \\frac{\\mathrm{d}E}{\\mathrm{d}(\\text{pH})} = -\\frac{m}{n} \\frac{RT\\ln 10}{F} $$\n这个结果明确地将斜率与质子的化学计量系数 $m$ 和转移的电子数 $n$ 联系起来。\n\n现在，我们将此通用公式应用于所提供的两个特定半反应。\n\n1.  **$\\text{H}^{+}$ 还原为 $\\text{H}_{2}(g)$：**\n    $$ 2\\,\\text{H}^{+} + 2\\,e^{-} \\rightleftharpoons \\text{H}_{2}(g) $$\n    对于此反应，$\\text{H}^{+}$ 的化学计量系数为 $m=2$，电子数为 $n=2$。比值为 $\\frac{m}{n} = \\frac{2}{2} = 1$。根据定义，标准电位为 $E^{\\circ}_{\\text{H}^{+}/\\text{H}_{2}} = 0\\,\\text{V}$。此边界的电位为：\n    $$ E_{\\text{H}_{2}} = 0 - \\frac{2}{2} \\frac{RT\\ln 10}{F} \\text{pH} = - \\frac{RT\\ln 10}{F} \\text{pH} $$\n    其斜率为：\n    $$ \\frac{\\mathrm{d}E_{\\text{H}_{2}}}{\\mathrm{d}(\\text{pH})} = -\\frac{RT\\ln 10}{F} $$\n\n2.  **$\\text{O}_{2}(g)$ 还原为 $\\text{H}_{2}\\text{O}(\\ell)$：**\n    $$ \\text{O}_{2}(g) + 4\\,\\text{H}^{+} + 4\\,e^{-} \\rightleftharpoons 2\\,\\text{H}_{2}\\text{O}(\\ell) $$\n    对于此反应，$\\text{H}^{+}$ 的化学计量系数为 $m=4$，电子数为 $n=4$。比值为 $\\frac{m}{n} = \\frac{4}{4} = 1$。设其标准电位为 $E^{\\circ}_{\\text{O}_{2}/\\text{H}_{2}\\text{O}}$。此边界的电位为：\n    $$ E_{\\text{O}_{2}} = E^{\\circ}_{\\text{O}_{2}/\\text{H}_{2}\\text{O}} - \\frac{4}{4} \\frac{RT\\ln 10}{F} \\text{pH} = E^{\\circ}_{\\text{O}_{2}/\\text{H}_{2}\\text{O}} - \\frac{RT\\ln 10}{F} \\text{pH} $$\n    其斜率为：\n    $$ \\frac{\\mathrm{d}E_{\\text{O}_{2}}}{\\mathrm{d}(\\text{pH})} = -\\frac{RT\\ln 10}{F} $$\n\n两个斜率相同，这正是需要证明的。这种一致性的原因在于，对于定义水稳定性窗口的两个半反应，所消耗的质子数与转移的电子数之比 $\\frac{m}{n}$ 均为1。这就完成了(a)部分的推导。\n\n(b) 共同斜率的数值计算。\n\n共同斜率由表达式 $S = -\\frac{RT\\ln 10}{F}$ 给出。我们代入给定的物理常数：\n$T = 298.15\\,\\text{K}$\n$R = 8.314462618\\,\\text{J mol}^{-1} \\text{K}^{-1}$\n$F = 96485.33212\\,\\text{C mol}^{-1}$\n\n计算过程如下：\n$$ S = - \\frac{(8.314462618\\,\\text{J mol}^{-1} \\text{K}^{-1}) \\times (298.15\\,\\text{K}) \\times \\ln(10)}{96485.33212\\,\\text{C mol}^{-1}} $$\n项 $\\ln(10) \\approx 2.30258509$。\n表达式的单位是 $\\text{J C}^{-1}$，即伏特 ($\\text{V}$)。因此，斜率的单位是伏特/pH单位。\n$$ S = - \\frac{8.314462618 \\times 298.15 \\times 2.30258509}{96485.33212} \\, \\text{V} $$\n$$ S \\approx - \\frac{5706.059}{96485.33212} \\, \\text{V} $$\n$$ S \\approx -0.05915984... \\, \\text{V} $$\n问题要求答案四舍五入到四位有效数字。\n$$ S \\approx -0.05916 \\, \\text{V} $$\n这个值是室温电化学中的一个基本常数，通常被称为单质子、单电子过程的能斯特斜率。", "answer": "$$\n\\boxed{-0.05916}\n$$", "id": "2515014"}, {"introduction": "在简化的Pourbaix图中，溶解的金属通常被视为简单的自由离子（例如 $M^{3+}$）。然而在现实中，这些水合离子会与水反应，发生水解，形成一系列的羟基配合物（例如 $M(OH)^{2+}$），这深刻影响了材料的实际行为。本练习旨在阐明如何计算这些水解产物的分布，并从概念上理解水解现象如何改变金属氢氧化物的沉淀边界 [@problem_id:2515029]。通过这个实践，您将认识到忽略水解效应为何会导致对材料溶解度和腐蚀抗性的错误预测。", "problem": "水中的一种三价金属离子通过配位水分子的质子转移进行逐步水解。考虑在温度 $T=298.15\\,\\text{K}$ 和低离子强度（活度系数可近似为1）下的前两个水解步骤：\n$$\\text{M(H}_2\\text{O)}_6^{3+} \\rightleftharpoons \\text{M(H}_2\\text{O)}_5(\\text{OH})^{2+} + \\text{H}^+,$$\n$$\\text{M(H}_2\\text{O)}_5(\\text{OH})^{2+} \\rightleftharpoons \\text{M(H}_2\\text{O)}_4(\\text{OH})_2^{+} + \\text{H}^+.$$\n根据质量作用定律，将逐步酸解离常数定义为\n$$K_1 \\equiv \\frac{a_{\\text{M(OH)}^{2+}}\\,a_{\\text{H}^+}}{a_{\\text{M}^{3+}}}, \\qquad K_2 \\equiv \\frac{a_{\\text{M(OH)}_2^{+}}\\,a_{\\text{H}^+}}{a_{\\text{M(OH)}^{2+}}},$$\n其中，活度 $a_i$ 近似用摩尔浓度表示。在 $T=298.15\\,\\text{K}$ 时，取数值 $K_1 = 10^{-5.20}$ 和 $K_2 = 10^{-8.80}$。假设在偏酸性 $\\text{pH}$ 条件下，单核物种 $\\text{M}^{3+}$ 和 $\\text{M(OH)}^{2+}$ 在溶解物种形态中占主导地位。\n\n计算当总溶解金属的一半以 $\\text{M}^{3+}$ 形式存在，另一半以 $\\text{M(OH)}^{2+}$ 形式存在时的 $\\text{pH}$ 值。将您的答案四舍五入至三位有效数字。\n\n然后，仅使用基本平衡关系且不进行任何额外的数值计算，简要解释在此 $\\text{pH}$ 值下，相较于忽略水解作用的简化构建，考虑水解作用会如何改变 $\\text{M(OH)}_3(s)$ 在Pourbaix图（电位-pH图）上的沉淀边界。您的解释应基于 $\\text{M(OH)}_3(s)$ 的溶度积概念以及自由离子活度与总溶解金属浓度之间的关系，但您最终报告的答案必须仅为计算出的 $\\text{pH}$ 值。", "solution": "该问题描述了一个三价金属水合离子 $\\text{M(H}_2\\text{O)}_6^{3+}$ 逐步水解的情景，并要求在特定的物种分布条件下计算 $\\text{pH}$ 值，随后对与Pourbaix图相关的概念进行解释。我将首先处理计算部分，然后进行解释。\n\n问题陈述信息充分，且科学上是合理的。水解反应如下：\n$$\n\\text{M(H}_2\\text{O)}_6^{3+} \\rightleftharpoons \\text{M(H}_2\\text{O)}_5(\\text{OH})^{2+} + \\text{H}^+\n$$\n$$\n\\text{M(H}_2\\text{O)}_5(\\text{OH})^{2+} \\rightleftharpoons \\text{M(H}_2\\text{O)}_4(\\text{OH})_2^{+} + \\text{H}^+\n$$\n为简便起见，我们将 $\\text{M(H}_2\\text{O)}_6^{3+}$ 表示为 $\\text{M}^{3+}$，$\\text{M(H}_2\\text{O)}_5(\\text{OH})^{2+}$ 表示为 $\\text{M(OH)}^{2+}$，$\\text{M(H}_2\\text{O)}_4(\\text{OH})_2^{+}$ 表示为 $\\text{M(OH)}_2^{+}$。如题所述，活度近似用摩尔浓度表示。\n\n根据给定的假设，即只有前两个物种 $\\text{M}^{3+}$ 和 $\\text{M(OH)}^{2+}$占主导地位，总溶解金属浓度 $C_{\\text{tot}}$ 由它们的浓度之和给出：\n$$C_{\\text{tot}} \\approx [\\text{M}^{3+}] + [\\text{M(OH)}^{2+}]$$\n问题要求找出总溶解金属的一半以 $\\text{M}^{3+}$ 形式存在，另一半以 $\\text{M(OH)}^{2+}$ 形式存在时的 $\\text{pH}$ 值。该条件可用数学公式表示为：\n$$[\\text{M}^{3+}] = \\frac{1}{2} C_{\\text{tot}}$$\n$$[\\text{M(OH)}^{2+}] = \\frac{1}{2} C_{\\text{tot}}$$\n从这两个方程可以立即得出，这两个主要物种的浓度相等：\n$$[\\text{M}^{3+}] = [\\text{M(OH)}^{2+}]$$\n第一步水解的平衡由酸解离常数 $K_1$ 控制：\n$$K_1 = \\frac{[\\text{M(OH)}^{2+}][\\text{H}^+]}{[\\text{M}^{3+}]}$$\n将浓度相等的条件代入平衡表达式，我们发现金属物种的项可以消去：\n$$K_1 = \\frac{[\\text{M(OH)}^{2+}][\\text{H}^+]}{[\\text{M(OH)}^{2+}]} = [\\text{H}^+]$$\n这个非常直接的结果表明，当氢离子浓度在数值上等于第一个酸解离常数时，满足指定条件。我们已知在 $T = 298.15\\,\\text{K}$ 时，$K_1 = 10^{-5.20}$。\n因此，$[\\text{H}^+] = 10^{-5.20}\\,\\text{M}$。\n$\\text{pH}$ 的定义为 $\\text{pH} = -\\log_{10}([\\text{H}^+])$。我们现在可以计算所需的 $\\text{pH}$ 值：\n$$\\text{pH} = -\\log_{10}(K_1) = -\\log_{10}(10^{-5.20}) = 5.20$$\n答案必须保留三位有效数字。数值 $5.20$ 满足此要求。\n\n验证 $[\\text{M(OH)}_2^{+}]$ 可忽略这一假设的自洽性是谨慎的做法。第二个平衡由 $K_2$ 定义：\n$$K_2 = \\frac{[\\text{M(OH)}_2^{+}][\\text{H}^+]}{[\\text{M(OH)}^{2+}]}$$\n在计算出的 $\\text{pH}$ 值下，我们有 $[\\text{H}^+] = K_1$。我们可以求出第三个物种与第二个物种的浓度之比：\n$$\\frac{[\\text{M(OH)}_2^{+}]}{[\\text{M(OH)}^{2+}]} = \\frac{K_2}{[\\text{H}^+]} = \\frac{K_2}{K_1} = \\frac{10^{-8.80}}{10^{-5.20}} = 10^{-3.60}$$\n由于 $10^{-3.60} \\approx 2.5 \\times 10^{-4}$，$\\text{M(OH)}_2^{+}$ 的浓度不到 $\\text{M(OH)}^{2+}$ 浓度的 $0.03\\%$。这是一个可忽略的量，因此问题中给出的简化假设是有效且自洽的。\n\n对于问题的第二部分，要求解释水解作用对 $\\text{M(OH)}_3(s)$ 沉淀边界的影响。Pourbaix图描绘了不同物种的热力学稳定区域随电化学电位和 $\\text{pH}$ 变化的函数关系。溶解物种与像 $\\text{M(OH)}_3(s)$ 这样的固体沉淀物之间的边界由溶度积 $K_{sp}$ 决定。对于 $\\text{M(OH)}_3(s)$，沉淀平衡为：\n$$\\text{M}^{3+} + 3\\text{OH}^- \\rightleftharpoons \\text{M(OH)}_3(s), \\qquad K_{sp} = [\\text{M}^{3+}][\\text{OH}^-]^3$$\n一种简化的图表构建方法可能会忽略水解作用，从而错误地将总溶解金属浓度 $C_{\\text{tot}}$ 等同于自由离子浓度 $[\\text{M}^{3+}]$。\n然而，水解导致络合离子的形成，因此总溶解金属是所有物种浓度的总和：$C_{\\text{tot}} = [\\text{M}^{3+}] + [\\text{M(OH)}^{2+}] + [\\text{M(OH)}_2^{+}] + \\dots$。\n因此，自由离子的浓度只是总浓度的一部分：$[\\text{M}^{3+}] = \\alpha_0 C_{\\text{tot}}$，其中 $\\alpha_0 = (1 + K_1/[\\text{H}^+] + K_1K_2/[\\text{H}^+]^2 + \\dots)^{-1}$。由于对于任何有限的 $\\text{pH}$ 值，$\\alpha_0  1$，水解作用有效地降低了可用于形成沉淀的自由离子 $[\\text{M}^{3+}]$ 的浓度。\n在计算出的 $\\text{pH}=5.20$ 时，我们发现 $[\\text{M}^{3+}]$ 仅为总溶解金属浓度的一半左右（因为 $\\alpha_0 \\approx 0.5$）。要发生沉淀，离子积必须超过 $K_{sp}$。由于实际的 $[\\text{M}^{3+}]$ 低于 $C_{\\text{tot}}$，与简化情况相比，需要更高浓度的 $[\\text{OH}^-]$（即更高的 $\\text{pH}$ 值）才能达到饱和点。这意味着该金属的溶解度比不考虑水解时预测的要高。因此，溶解物种的稳定区域扩大，Pourbaix图上 $\\text{M(OH)}_3(s)$ 的沉淀边界向更高的 $\\text{pH}$ 值移动。", "answer": "$$\\boxed{5.20}$$", "id": "2515029"}, {"introduction": "手动绘制包含多种化学物种的精确Pourbaix图是一项繁琐且易于出错的任务，并且往往依赖于理想行为等简化假设。现代材料化学和地球化学领域广泛使用计算方法，通过同时求解所有相关的平衡方程来生成精确的物种形成图。这项高级实践将挑战您设计这样一个计算模型的核心算法，它整合了氧化还原平衡、水解、质量守恒和非理想溶液的活度修正 [@problem_id:2515057]。完成此练习不仅能让您深入了解现代热力学模拟软件的内部工作原理，还能为您在科研中解决复杂的化学平衡问题奠定坚实的计算基础。", "problem": "您的任务是实现一个计算算法，用于计算一种具有氧化还原活性的金属在电势–pH空间的一系列点上的水相形态，同时强制满足电中性和总质量平衡，并进行活度修正。该体系是一个温度为 $T=298.15\\,\\text{K}$ 的水溶液，其中含有一种三价金属，该金属会发生单电子还原反应生成二价态，并在水中发生分步水解。该算法必须基于以下基本定律和定义进行推导和实现，不得依赖这些陈述之外的任何简化方法：\n\n- 化学平衡的质量作用定律（使用活度）：如果反应式中水作为溶剂和纯液体，则平衡常数 $K$ 仅使用溶质的活度。\n- Nernst方程：对于还原半反应 $\\text{M}^{3+} + e^- \\rightleftharpoons \\text{M}^{2+}$，电势满足 $E = E^\\circ - \\dfrac{RT}{F} \\ln Q$，其中 $Q = \\dfrac{a_{\\text{M}^{2+}}}{a_{\\text{M}^{3+}}}$，$R$ 是通用气体常数，$F$ 是Faraday常数。\n- 电中性：溶液中所有带电物质的电荷加权摩尔浓度之和为零。\n- 金属的总质量平衡：所有含金属物质的摩尔浓度之和等于总的分析金属浓度。\n- 活度-浓度关系：$a_i = \\gamma_i c_i$，其中 $a_i$ 是活度，$c_i$ 是摩尔浓度，$\\gamma_i$ 是活度系数。\n- 在离子强度为 $I$ 时计算活度系数的Davies方程：对于电荷为 $z_i$ 的离子，$\\log_{10} \\gamma_i = -A z_i^2\\left(\\dfrac{\\sqrt{I}}{1+\\sqrt{I}} - 0.3 I \\right)$，其中对于 $T=298.15\\,\\text{K}$ 的水，$A=0.509$；对于中性物质，$\\gamma_i=1$。\n- 离子强度定义：$I = \\dfrac{1}{2}\\sum_i z_i^2 c_i$，对所有带电物质求和。\n- pH的氢离子定义：$\\text{pH} = -\\log_{10} a_{\\text{H}^+}$。\n- 水的自递质子反应（以活度表示）：$K_w = a_{\\text{H}^+} a_{\\text{OH}^-}$。\n\n模型体系和参数：\n- 半反应和标准电势：$\\text{M}^{3+} + e^- \\rightleftharpoons \\text{M}^{2+}$，在 $T=298.15\\,\\text{K}$ 时 $E^\\circ = 0.771\\,\\text{V}$。\n- 在 $T=298.15\\,\\text{K}$ 时的水解平衡（活度）：\n  1. $\\text{M}^{3+} + \\text{H}_2\\text{O} \\rightleftharpoons \\text{M(OH)}^{2+} + \\text{H}^+$，其中 $K_1 = 10^{-2.19}$。\n  2. $\\text{M(OH)}^{2+} + \\text{H}_2\\text{O} \\rightleftharpoons \\text{M(OH)}_2^{+} + \\text{H}^+$，其中 $K_2 = 10^{-3.50}$。\n  3. $\\text{M(OH)}_2^{+} + \\text{H}_2\\text{O} \\rightleftharpoons \\text{M(OH)}_3^{0} + \\text{H}^+$，其中 $K_3 = 10^{-6.00}$。\n- 水的离子积：$K_w = 10^{-14}$（以活度计）。\n- 常数：$R = 8.314462618\\,\\text{J mol}^{-1} \\text{K}^{-1}$，$F = 96485.33212\\,\\text{C mol}^{-1}$，$A=0.509$（在 $T=298.15\\,\\text{K}$ 时的Davies常数）。\n\n在每个 $(E,\\text{pH})$ 点需计算的未知水相物质：\n- $\\text{M}^{3+}$、$\\text{M}^{2+}$、$\\text{M(OH)}^{2+}$、$\\text{M(OH)}_2^{+}$、$\\text{M(OH)}_3^{0}$、$\\text{H}^+$、$\\text{OH}^-$，以及根据需要添加的一种单一非反应性背景抗衡离子，以强制实现电中性，其电荷 $z_{\\text{bal}} \\in \\{+1,-1\\}$ 且浓度 $c_{\\text{bal}} \\ge 0$，选择该离子使得总电荷恰好为零。\n\n算法要求：\n- 将pH视为氢离子活度的负常用对数：$a_{\\text{H}^+} = 10^{-\\text{pH}}$。\n- 使用Davies方程自洽地计算离子活度系数 $\\gamma_i$ 与离子强度 $I$。由于 $I$ 依赖于所有带电物质的浓度，而这些浓度又依赖于 $\\gamma_i$，因此您必须对 $I$ 执行不动点迭代直至收敛。\n- 在每次迭代中，通过添加带有适当符号的单一背景抗衡离子，精确地强制满足总金属质量平衡和电中性。在进行下一次活度系数迭代之前，必须重新计算包含该背景离子的离子强度。\n- 对于氧化还原电对，强制满足活度而非浓度之间的Nernst关系。对于水解反应，使用活度强制满足质量作用定律，并假设水的活度为1。\n\n在您的实现中使用的推导目标：\n- 从Nernst方程推导出活度比 $r = \\dfrac{a_{\\text{M}^{2+}}}{a_{\\text{M}^{3+}}} = \\exp\\!\\left(-\\dfrac{(E - E^\\circ)F}{RT}\\right)$。\n- 从分步水解平衡推导出 $a_{\\text{M(OH)}^{2+}} = \\dfrac{K_1 a_{\\text{M}^{3+}}}{a_{\\text{H}^+}}$，$a_{\\text{M(OH)}_2^{+}} = \\dfrac{K_1 K_2 a_{\\text{M}^{3+}}}{a_{\\text{H}^+}^2}$，以及 $a_{\\text{M(OH)}_3^{0}} = \\dfrac{K_1 K_2 K_3 a_{\\text{M}^{3+}}}{a_{\\text{H}^+}^3}$。\n- 使用 $a_i = \\gamma_i c_i$ 转换为浓度，并强制满足总金属平衡 $C_{\\text{M,tot}} = c_{\\text{M}^{3+}} + c_{\\text{M}^{2+}} + c_{\\text{M(OH)}^{2+}} + c_{\\text{M(OH)}_2^{+}} + c_{\\text{M(OH)}_3^{0}}$，从而显式求解 $a_{\\text{M}^{3+}}$。\n- 在每次迭代中，通过将背景离子的浓度设置为所有其他物质净电荷的绝对值并带有相反的符号，来强制满足电中性。\n- 迭代直至离子强度 $I$ 在一个严格的容差范围内收敛。\n\n测试套件：\n在 $T=298.15\\,\\text{K}$ 的条件下，为以下输入案例实现您的算法，每个案例由一个元组 $(\\text{pH}, E\\,(\\text{V}), C_{\\text{M,tot}}\\,(\\text{mol L}^{-1}))$ 指定：\n- 案例A: $(2.0,\\ 0.30,\\ 10^{-6})$\n- 案例B: $(6.0,\\ 0.771,\\ 10^{-6})$\n- 案例C: $(9.0,\\ 1.00,\\ 10^{-6})$\n- 案例D: $(8.0,\\ 0.20,\\ 10^{-4})$\n- 案例E: $(7.0,\\ 0.771,\\ 10^{-8})$\n\n对于每个案例，您的程序必须按顺序计算并返回以下四个量：\n1) 总溶解金属中以 $\\text{M}^{2+}$ 形式存在的分数，即 $c_{\\text{M}^{2+}}/C_{\\text{M,tot}}$（无量纲）。\n2) 总溶解金属中以中性物质 $\\text{M(OH)}_3^{0}$ 形式存在的分数，即 $c_{\\text{M(OH)}_3^{0}}/C_{\\text{M,tot}}$（无量纲）。\n3) 最终收敛的离子强度 $I$，单位为 $\\text{mol L}^{-1}$。\n4) 电中性绝对残差，即在添加背景离子后 $\\left|\\sum_i z_i c_i\\right|$ 的值，单位为 $\\text{mol L}^{-1}$。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含一个以逗号分隔的Python风格浮点数结果列表，该列表按A到E的顺序汇总了所有案例，每个案例按上述顺序贡献其四个结果。例如，输出必须类似于\n\"[v1,v2,v3,v4,v5,v6,v7,v8,v9,v10,v11,v12,v13,v14,v15,v16,v17,v18,v19,v20]\"\n其中恰好有 $20$ 个条目，对应于五个案例，每个案例四个值。所有离子强度和浓度的单位必须是 $\\text{mol L}^{-1}$；所有电势根据构造单位为 $\\text{V}$；分数为无量纲。本问题不涉及角度。将分数量表示为小数，而非百分比。", "solution": "该问题要求通过求解一组描述化学平衡的非线性方程组，来计算一个具有氧化还原活性的金属体系的水相形态。该求解过程受质量平衡和电中性约束，并使用Davies方程计算活度系数以考虑非理想效应。每次计算的指定输入是电势 $E$、pH值和金属的总分析浓度 $C_{\\text{M,tot}}$。温度固定在 $T = 298.15\\,\\text{K}$。\n\n该方程组是高度耦合的，因为物质浓度 $c_i$ 决定了离子强度 $I$，而离子强度 $I$ 又决定了活度系数 $\\gamma_i$，在平衡表达式中需要用活度系数通过 $a_i = \\gamma_i c_i$ 将活度 $a_i$ 与浓度关联起来。这种循环依赖性要求采用迭代数值方法。问题指定了对离子强度 $I$ 进行不动点迭代。\n\n化学体系包含以下物质：$\\text{M}^{3+}$、$\\text{M}^{2+}$、$\\text{M}^{3+}$ 的单核水解产物 $\\text{M(OH)}^{2+}$、$\\text{M(OH)}_2^{+}$ 和 $\\text{M(OH)}_3^{0}$，以及 $\\text{H}^+$ 和 $\\text{OH}^-$。引入一个额外的非反应性背景离子，其浓度为 $c_{\\text{bal}}$、电荷为 $z_{\\text{bal}} \\in \\{+1, -1\\}$，以强制实现完美的电中性。\n\n迭代算法按以下步骤进行：\n1.  用一个初始猜测值初始化离子强度 $I$，例如 $I^{(0)} = 0$。\n2.  在每次迭代 $k$ 中，使用当前的离子强度 $I^{(k)}$，通过Davies方程为每个电荷为 $z_i$ 的带电物质 $i$ 计算其活度系数 $\\gamma_i^{(k)}$：\n    $$ \\log_{10} \\gamma_i = -A z_i^2\\left(\\dfrac{\\sqrt{I}}{1+\\sqrt{I}} - 0.3 I \\right) $$\n    其中 $A = 0.509$。对于像 $\\text{M(OH)}_3^{0}$ 这样的中性物质，活度系数为1，即 $\\gamma_i = 1$。带电物质包括 $\\text{M}^{3+}$ ($z=3$)、$\\text{M}^{2+}$ ($z=2$)、$\\text{M(OH)}^{2+}$ ($z=2$)、$\\text{M(OH)}_2^{+}$ ($z=1$)、$\\text{H}^+$ ($z=1$)、$\\text{OH}^-$ ($z=-1$)以及背景离子 ($z=\\pm 1$)。\n\n3.  氢离子和氢氧根离子的活度由输入的pH值固定：\n    $$ a_{\\text{H}^+} = 10^{-\\text{pH}} $$\n    $$ a_{\\text{OH}^-} = \\frac{K_w}{a_{\\text{H}^+}} = \\frac{10^{-14}}{10^{-\\text{pH}}} $$\n\n4.  所有金属物质的活度都相对于一个单一的主控物质 $a_{\\text{M}^{3+}}$ 来表示。\n    对于反应 $\\text{M}^{3+} + e^- \\rightleftharpoons \\text{M}^{2+}$ 的Nernst方程给出了活度比：\n    $$ r = \\frac{a_{\\text{M}^{2+}}}{a_{\\text{M}^{3+}}} = \\exp\\left(-\\frac{(E - E^\\circ)F}{RT}\\right) $$\n    其中 $E^\\circ = 0.771\\,\\text{V}$，$R = 8.314462618\\,\\text{J mol}^{-1} \\text{K}^{-1}$，$F = 96485.33212\\,\\text{C mol}^{-1}$。\n    \n    对于水解反应 $\\text{M}^{3+} + j\\text{H}_2\\text{O} \\rightleftharpoons \\text{M(OH)}_j^{(3-j)+} + j\\text{H}^+$，活度通过累积平衡常数 $\\beta_j^*$ 关联起来：\n    - 对于 $j=1$：$\\text{M}^{3+} + \\text{H}_2\\text{O} \\rightleftharpoons \\text{M(OH)}^{2+} + \\text{H}^+$，$\\beta_1^* = K_1 = 10^{-2.19}$。\n    - 对于 $j=2$：$\\text{M}^{3+} + 2\\text{H}_2\\text{O} \\rightleftharpoons \\text{M(OH)}_2^{+} + 2\\text{H}^+$，$\\beta_2^* = K_1 K_2 = 10^{-5.69}$。\n    - 对于 $j=3$：$\\text{M}^{3+} + 3\\text{H}_2\\text{O} \\rightleftharpoons \\text{M(OH)}_3^{0} + 3\\text{H}^+$，$\\beta_3^* = K_1 K_2 K_3 = 10^{-11.69}$。\n    活度为：\n    $$ a_{\\text{M(OH)}_j^{(3-j)+}} = \\frac{\\beta_j^* a_{\\text{M}^{3+}}}{(a_{\\text{H}^+})^j} \\quad \\text{其中 } j \\in \\{1, 2, 3\\} $$\n\n5.  未知活度 $a_{\\text{M}^{3+}}$ 通过强制满足总金属质量平衡来确定：\n    $$ C_{\\text{M,tot}} = c_{\\text{M}^{3+}} + c_{\\text{M}^{2+}} + c_{\\text{M(OH)}^{2+}} + c_{\\text{M(OH)}_2^{+}} + c_{\\text{M(OH)}_3^{0}} $$\n    代入 $c_i = a_i/\\gamma_i$ 以及第4步中的表达式：\n    $$ C_{\\text{M,tot}} = \\frac{a_{\\text{M}^{3+}}}{\\gamma_{\\text{M}^{3+}}} + \\frac{r \\cdot a_{\\text{M}^{3+}}}{\\gamma_{\\text{M}^{2+}}} + \\sum_{j=1}^{3} \\frac{\\beta_j^* a_{\\text{M}^{3+}}}{(a_{\\text{H}^+})^j \\gamma_{\\text{M(OH)}_j^{(3-j)+}}} $$\n    求解 $a_{\\text{M}^{3+}}$ 得到：\n    $$ a_{\\text{M}^{3+}} = C_{\\text{M,tot}} \\left[ \\frac{1}{\\gamma_{\\text{M}^{3+}}} + \\frac{r}{\\gamma_{\\text{M}^{2+}}} + \\sum_{j=1}^{3} \\frac{\\beta_j^*}{(a_{\\text{H}^+})^j \\gamma_{\\text{M(OH)}_j^{(3-j)+}}} \\right]^{-1} $$\n\n6.  在 $a_{\\text{M}^{3+}}$ 已知的情况下，计算所有其他金属物质的活度，随后，使用 $c_i^{(k+1)} = a_i / \\gamma_i^{(k)}$ 即可得到当前迭代 $(k)$ 中所有物质（含金属物质、$\\text{H}^+$、$\\text{OH}^-$）的浓度。\n\n7.  通过计算除背景离子外的所有物质的净电荷来强制满足电中性：\n    $$ C_{\\text{net}} = \\sum_{i \\neq \\text{bal}} z_i c_i = 3c_{\\text{M}^{3+}} + 2c_{\\text{M}^{2+}} + 2c_{\\text{M(OH)}^{2+}} + c_{\\text{M(OH)}_2^{+}} + c_{\\text{H}^+} - c_{\\text{OH}^-} $$\n    背景离子的浓度和电荷被设定为能完美平衡此电荷：\n    $$ c_{\\text{bal}} = |C_{\\text{net}}| $$\n    $$ z_{\\text{bal}} = -\\mathrm{sign}(C_{\\text{net}}) $$\n\n8.  使用更新后的浓度（包括背景离子）计算新的离子强度 $I^{(k+1)}$：\n    $$ I^{(k+1)} = \\frac{1}{2} \\sum_{\\text{all species}} z_i^2 c_i^{(k+1)} = \\frac{1}{2}\\left( \\sum_{i \\neq \\text{bal}} z_i^2 c_i^{(k+1)} + z_{\\text{bal}}^2 c_{\\text{bal}} \\right) $$\n\n9.  将新值 $I^{(k+1)}$ 与旧值 $I^{(k)}$ 进行比较。如果 $|I^{(k+1)} - I^{(k)}|$ 小于指定的容差（例如，$10^{-15}$），则迭代已收敛。否则，设置 $I^{(k)} \\leftarrow I^{(k+1)}$ 并返回第2步。\n\n10. 一旦达到收敛，最终计算出的浓度将用于计算每个测试案例所需的输出指标：分数浓度 $c_{\\text{M}^{2+}}/C_{\\text{M,tot}}$ 和 $c_{\\text{M(OH)}_3^{0}}/C_{\\text{M,tot}}$，最终收敛的离子强度 $I$，以及电中性绝对残差 $|\\sum_i z_i c_i|$，该残差可作为数值验证，并且根据构造其值应接近于零。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes aqueous speciation for a redox-active metal system using a\n    fixed-point iteration on ionic strength to self-consistently solve for\n    concentrations, activity coefficients, and charge balance.\n    \"\"\"\n    # Define constants\n    R = 8.314462618  # J mol^-1 K^-1\n    F = 96485.33212  # C mol^-1\n    T = 298.15        # K\n    A_davies = 0.509  # Davies constant for water at 298.15 K\n\n    # Electrochemical and equilibrium parameters\n    E_circ = 0.771     # V\n    K1 = 10**(-2.19)\n    K2 = 10**(-3.50)\n    K3 = 10**(-6.00)\n    Kw = 10**(-14.0)\n\n    # Cumulative hydrolysis constants for M(3+)\n    # M(3+) + j*H2O = M(OH)j^(3-j)+ + j*H+\n    beta_star_1 = K1\n    beta_star_2 = K1 * K2\n    beta_star_3 = K1 * K2 * K3\n\n    def calculate_speciation(pH, E, C_M_tot):\n        \"\"\"\n        Performs the iterative calculation for a single (pH, E, C_M_tot) point.\n        \"\"\"\n        max_iter = 100\n        tolerance = 1e-15\n        \n        # Fixed activities based on inputs\n        a_H = 10**(-pH)\n        a_OH = Kw / a_H\n\n        # Nernst activity ratio for M2+/M3+ couple\n        RT_F = R * T / F\n        r_act = np.exp(-(E - E_circ) / RT_F)\n\n        # Iteration on Ionic Strength I\n        I = 0.0  # Initial guess (ideal solution)\n        concs = {}\n        for _ in range(max_iter):\n            I_old = I\n            \n            # 1. Calculate activity coefficients (gamma) using current I\n            gammas = {}\n            sqrt_I = np.sqrt(I)\n            # The Davies equation term is non-zero only for I > 0\n            if I > 0:\n                davies_term = (sqrt_I / (1 + sqrt_I)) - 0.3 * I\n            else:\n                davies_term = 0\n\n            # Charges for species involved in Davies calculation\n            z_vals = {'M3+': 3, 'M2+': 2, 'MOH_2p': 2, 'MOH2_p': 1, 'H+': 1, 'OH-': -1}\n            \n            for name, z in z_vals.items():\n                log10_gamma = -A_davies * (z**2) * davies_term\n                gammas[name] = 10**log10_gamma\n            gammas['MOH3_0'] = 1.0  # Neutral species\n\n            # 2. Solve for a_M3+ using total metal mass balance\n            sum_term = (1.0 / gammas['M3+'] +\n                        r_act / gammas['M2+'] +\n                        (beta_star_1 / a_H) / gammas['MOH_2p'] +\n                        (beta_star_2 / a_H**2) / gammas['MOH2_p'] +\n                        (beta_star_3 / a_H**3) / gammas['MOH3_0'])\n\n            a_M3plus = C_M_tot / sum_term if sum_term > 0 else 0.0\n\n            # 3. Calculate concentrations of all species for this iteration\n            # Metal species\n            concs['M3+'] = a_M3plus / gammas['M3+']\n            concs['M2+'] = (a_M3plus * r_act) / gammas['M2+']\n            concs['MOH_2p'] = (a_M3plus * beta_star_1 / a_H) / gammas['MOH_2p']\n            concs['MOH2_p'] = (a_M3plus * beta_star_2 / a_H**2) / gammas['MOH2_p']\n            concs['MOH3_0'] = (a_M3plus * beta_star_3 / a_H**3) / gammas['MOH3_0']\n            # H+ and OH-\n            concs['H+'] = a_H / gammas['H+']\n            concs['OH-'] = a_OH / gammas['OH-']\n\n            # 4. Enforce electroneutrality by adding a background ion\n            net_charge = (3 * concs['M3+'] + 2 * concs['M2+'] + 2 * concs['MOH_2p'] + \n                          1 * concs['MOH2_p'] + 1 * concs['H+'] - 1 * concs['OH-'])\n\n            c_bal = abs(net_charge)\n            z_bal = -np.sign(net_charge) if net_charge != 0 else 0\n            \n            # 5. Update ionic strength including the background ion\n            I = 0.5 * (9 * concs['M3+'] + 4 * concs['M2+'] + 4 * concs['MOH_2p'] + \n                       1 * concs['MOH2_p'] + 1 * concs['H+'] + 1 * concs['OH-'] + \n                       (z_bal**2) * c_bal)\n            \n            # 6. Check for convergence\n            if abs(I - I_old)  tolerance:\n                break\n\n        # After convergence, calculate final required quantities\n        frac_M2plus = concs.get('M2+', 0) / C_M_tot if C_M_tot > 0 else 0\n        frac_MOH3_0 = concs.get('MOH3_0', 0) / C_M_tot if C_M_tot > 0 else 0\n        \n        # Recalculate final charge for residual report\n        final_net_charge = (3*concs['M3+'] + 2*concs['M2+'] + 2*concs['MOH_2p'] + \n                           1*concs['MOH2_p'] + 1*concs['H+'] - 1*concs['OH-'])\n        final_c_bal = abs(final_net_charge)\n        final_z_bal = -np.sign(final_net_charge) if final_net_charge != 0 else 0\n        final_residual = abs(final_net_charge + final_z_bal * final_c_bal)\n\n        return [frac_M2plus, frac_MOH3_0, I, final_residual]\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (pH, E (V), C_M_tot (mol/L))\n        (2.0, 0.30, 1e-6),    # Case A\n        (6.0, 0.771, 1e-6),   # Case B\n        (9.0, 1.00, 1e-6),    # Case C\n        (8.0, 0.20, 1e-4),    # Case D\n        (7.0, 0.771, 1e-8)    # Case E\n    ]\n\n    results = []\n    for case in test_cases:\n        results.extend(calculate_speciation(*case))\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{v:.8e}' for v in results)}]\")\n\nsolve()\n```", "id": "2515057"}]}