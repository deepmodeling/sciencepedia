{"hands_on_practices": [{"introduction": "掌握一个科学概念的最佳途径之一是从其最基本的定义出发。这个练习将引导我们回到二维空间，从第一性原理推导正方晶格和六方晶格的配位数（CN）与原子堆积因子（APF）。通过直接比较这两种构型，你将深刻理解为何某些原子排列方式比其他方式更为致密，这是理解晶体结构稳定性的基础。[@problem_id:2475616]", "problem": "一个由半径为 $r$ 的相同、不重叠的硬质圆盘组成的单原子层，以两种不同的方式排列成布拉菲晶格：一种是正方晶格，另一种是六方（或三角）晶格。在二维（$2$D）空间中进行计算。严格从核心定义出发，对每种晶格推导：\n- 配位数（CN），定义为在最小中心距处的最近邻数量，以及\n- 二维原子堆积因子（APF），定义为当每个圆盘都恰好与其所有最近邻接触（即最近邻距离等于 $2r$）时，圆盘占据平面的面积分数 $\\eta$。\n\n仅使用以下基本定义：APF是在一个选定的原胞中所含圆盘材料的总面积除以该原胞的几何面积，并且每个原胞中的圆盘数量由跨越晶胞边界的圆盘面积的适当共享关系确定。不要假设任何针对这些晶格的预先制表的值或公式；请从这些定义中推导出它们。\n\n在完成两种推导后，将比值 $\\eta_{\\text{tri}}/\\eta_{\\text{sq}}$ 的精确值作为最终答案报告，其中 $\\eta_{\\text{tri}}$ 和 $\\eta_{\\text{sq}}$ 分别是三角晶格和正方晶格的二维原子堆积因子。最终答案应表示为单个精确表达式，无需数值取整，也无需单位。", "solution": "题目陈述已经过验证，被认为是科学上合理的、问题定义明确的、客观的且内部一致的。它提出了一个二维晶体学中的标准问题，可以按要求从第一性原理严格求解。给定的条件和定义足以得到明确的唯一解。我们现在开始推导。\n\n该问题要求推导两种不同布拉菲晶格（正方晶格和六方（或三角）晶格）的配位数（CN）和二维原子堆积因子（APF），记为 $\\eta$。APF 定义为一个原胞内被圆盘占据的面积与该原胞总面积之比。\n$$\n\\eta = \\frac{A_{\\text{disks}}}{A_{\\text{cell}}}\n$$\n根据定义，一个原胞恰好包含一个格点。当半径为 $r$ 的相同圆盘以每个格点为中心放置时，一个原胞内圆盘材料的总面积总是等于单个圆盘的面积，即 $\\pi r^{2}$。配位数是最近邻格点的数量。问题规定，圆盘的排列方式使得最近邻相互接触，这意味着最近邻圆盘中心之间的距离为 $2r$。\n\n**第1部分：正方晶格**\n\n对于一个二维正方晶格，我们可以将原胞基矢定义为：\n$$\n\\vec{a}_{1} = a\\hat{x} \\\\\n\\vec{a}_{2} = a\\hat{y}\n$$\n其中 $a$ 是晶格常数。原胞是一个边长为 $a$ 的正方形。对于以原点 $(0,0)$ 为中心的圆盘，其最近邻位于 $(\\pm a, 0)$ 和 $(0, \\pm a)$ 位置。\n\n**正方晶格的配位数（CN）：**\n到这些最近邻的距离是 $a$。显然，这样的邻居有 $4$ 个。\n$$\n\\text{CN}_{\\text{sq}} = 4\n$$\n\n**正方晶格的原子堆积因子（$\\eta_{\\text{sq}}$）：**\n最近邻圆盘相切的条件意味着中心距 $a$ 必须等于两个半径之和，即 $2r$。\n$$\na = 2r\n$$\n正方形原胞的面积 $A_{\\text{sq\\_cell}}$ 为：\n$$\nA_{\\text{sq\\_cell}} = a \\times a = a^{2} = (2r)^{2} = 4r^{2}\n$$\n每个原胞中的圆盘数量恰好为 $1$。因此，该晶胞内圆盘材料所占的总面积 $A_{\\text{disks}}$ 即为一个圆盘的面积。\n$$\nA_{\\text{disks}} = \\pi r^{2}\n$$\n正方晶格的原子堆积因子 $\\eta_{\\text{sq}}$ 是这些面积之比。\n$$\n\\eta_{\\text{sq}} = \\frac{A_{\\text{disks}}}{A_{\\text{sq\\_cell}}} = \\frac{\\pi r^{2}}{4r^{2}} = \\frac{\\pi}{4}\n$$\n\n**第2部分：六方（三角）晶格**\n\n六方晶格是二维空间中相同圆盘的最密堆积。我们可以将原胞基矢定义为：\n$$\n\\vec{b}_{1} = a\\hat{x} \\\\\n\\vec{b}_{2} = a \\cos\\left(\\frac{\\pi}{3}\\right)\\hat{x} + a \\sin\\left(\\frac{\\pi}{3}\\right)\\hat{y} = a\\left(\\frac{1}{2}\\hat{x} + \\frac{\\sqrt{3}}{2}\\hat{y}\\right)\n$$\n其中 $a$ 是晶格常数，代表原胞基矢的长度。$\\vec{b}_{1}$ 和 $\\vec{b}_{2}$ 之间的夹角是 $\\frac{\\pi}{3}$ 弧度，即 $60^\\circ$。原胞是一个边长为 $a$ 的菱形。\n\n**六方晶格的配位数（CN）：**\n位于原点的圆盘的最近邻位于由六个矢量 $\\pm\\vec{b}_{1}$、$\\pm\\vec{b}_{2}$ 和 $\\pm(\\vec{b}_{2}-\\vec{b}_{1})$ 定义的位置上。所有这些矢量的模都为 $a$。这样的邻居有 $6$ 个。\n$$\n\\text{CN}_{\\text{tri}} = 6\n$$\n\n**六方晶格的原子堆积因子（$\\eta_{\\text{tri}}$）：**\n相切条件要求最近邻距离（即晶格常数 $a$）必须等于 $2r$。\n$$\na = 2r\n$$\n菱形原胞的面积 $A_{\\text{tri\\_cell}}$ 可以计算为其晶格基矢的叉积的模，或者更简单地用底乘以高。底是 $|\\vec{b}_{1}| = a$，高是 $a \\sin(\\frac{\\pi}{3}) = a \\frac{\\sqrt{3}}{2}$。\n$$\nA_{\\text{tri\\_cell}} = a \\times \\left(a \\frac{\\sqrt{3}}{2}\\right) = \\frac{\\sqrt{3}}{2}a^{2}\n$$\n代入 $a = 2r$：\n$$\nA_{\\text{tri\\_cell}} = \\frac{\\sqrt{3}}{2}(2r)^{2} = \\frac{\\sqrt{3}}{2}(4r^{2}) = 2\\sqrt{3}r^{2}\n$$\n与任何原胞一样，该晶胞恰好包含一个圆盘的面积。\n$$\nA_{\\text{disks}} = \\pi r^{2}\n$$\n因此，六方晶格的原子堆积因子 $\\eta_{\\text{tri}}$ 是：\n$$\n\\eta_{\\text{tri}} = \\frac{A_{\\text{disks}}}{A_{\\text{tri\\_cell}}} = \\frac{\\pi r^{2}}{2\\sqrt{3}r^{2}} = \\frac{\\pi}{2\\sqrt{3}}\n$$\n\n**第3部分：堆积因子之比**\n\n最后一步是计算比值 $\\frac{\\eta_{\\text{tri}}}{\\eta_{\\text{sq}}}$。\n$$\n\\frac{\\eta_{\\text{tri}}}{\\eta_{\\text{sq}}} = \\frac{\\left(\\frac{\\pi}{2\\sqrt{3}}\\right)}{\\left(\\frac{\\pi}{4}\\right)}\n$$\n我们通过将分母取倒数并相乘来简化表达式：\n$$\n\\frac{\\eta_{\\text{tri}}}{\\eta_{\\text{sq}}} = \\frac{\\pi}{2\\sqrt{3}} \\times \\frac{4}{\\pi} = \\frac{4}{2\\sqrt{3}} = \\frac{2}{\\sqrt{3}}\n$$\n这就是所要求的比值的精确表达式。", "answer": "$$\\boxed{\\frac{2}{\\sqrt{3}}}$$", "id": "2475616"}, {"introduction": "在掌握了二维模型后，我们将把注意力转向更真实的三维晶体结构。这个练习聚焦于重要的面心立方（fcc）晶格，并要求你计算其八面体间隙位置能容纳的最大球体半径。这项技能对于理解合金的形成、杂质原子在晶体中的溶解度以及扩散机制至关重要。[@problem_id:2475691]", "problem": "将一个单原子晶体固体建模为以面心立方（fcc）结构排列的相同的、不可压缩的硬球，该结构可视为ABC堆积序列的密堆积层。设主体球的半径为$r$，常规立方晶胞的边长为$a$。考虑位于常规立方晶胞中心的八面体间隙位置。一个半径为$r_{\\text{oct}}$的间隙球被放置在该位置，它与周围的主体球相切，但不会使其变形。\n\n仅从关于面心立方晶格和硬球密堆积约束的基本几何事实出发，并使用笛卡尔坐标系中的欧几里得几何，完成以下任务：\n\n- 通过确定在fcc密堆积中哪些主体球相互接触，并计算相应的中心间距，来建立$a$与$r$之间的关系。\n- 确定立方体中心八面体位置周围最近的主体球中心，并用$a$表示八面体位置中心与那些主体球中心之间的中心间距。\n- 应用间隙球与其最近的主体球之间的相切条件，以$a$和$r$来确定$r_{\\text{oct}}$。\n- 消去$a$，得到比率$r_{\\text{oct}}/r$的闭式表达式。\n\n从晶格几何和硬球接触的第一性原理出发，证明每个几何步骤的合理性。将最终答案以$r_{\\text{oct}}/r$的精确解析表达式形式报告。如果额外提供小数值，请将其四舍五入到4位有效数字，并以无量纲小数的形式报告。", "solution": "所述问题是关于晶体结构，特别是面心立方（fcc）晶格几何分析的一个适定练习。它具有科学依据、内容自洽，是固态化学和物理学中的一个标准问题。因此，我们开始进行求解。\n\n我们建立一个笛卡尔坐标系，其原点位于常规立方晶胞的一个角点，坐标轴与立方体的边缘对齐。该常规晶胞是一个边长为$a$的立方体，占据了由$0 \\le x \\le a$，$0 \\le y \\le a$和$0 \\le z \\le a$定义的区域。\n\n在面心立方（fcc）晶格中，半径为$r$的相同球体以常规晶胞的8个角点和6个面心为中心。\n角点原子中心的坐标形式为$(ia, ja, ka)$，其中$i, j, k \\in \\{0, 1\\}$。\n面心原子中心的坐标为$(a/2, a/2, 0)$、$(a/2, 0, a/2)$、$(0, a/2, a/2)$及其排列组合。\n\n首先，我们必须建立晶格常数$a$与原子半径$r$之间的关系。fcc结构是一种密堆积排列。这意味着原子沿特定方向相互接触。在fcc晶格中，沿面对角线的原子是相切的。让我们考虑$xy$平面（$z=0$）上的面。有原子分别以角点$(0, 0, 0)$和面心$(a/2, a/2, 0)$为中心。这些是最近邻原子，因此在硬球模型中它们是相互接触的。\n\n这两个原子中心之间的距离$d$使用欧几里得距离公式计算：\n$$d = \\sqrt{\\left(\\frac{a}{2} - 0\\right)^2 + \\left(\\frac{a}{2} - 0\\right)^2 + (0 - 0)^2} = \\sqrt{\\frac{a^2}{4} + \\frac{a^2}{4}} = \\sqrt{\\frac{2a^2}{4}} = \\sqrt{\\frac{a^2}{2}} = \\frac{a}{\\sqrt{2}}$$\n由于这两个球体相切，它们中心之间的距离必须等于它们的半径之和，即$r + r = 2r$。\n将几何距离与半径之和相等，得出约束条件：\n$$2r = \\frac{a}{\\sqrt{2}}$$\n由此，我们推导出$a$和$r$之间的关系：\n$$a = 2\\sqrt{2}r \\quad (1)$$\n\n接下来，我们考虑位于常规立方晶胞中心的八面体间隙位置。该位置的坐标是$(\\frac{a}{2}, \\frac{a}{2}, \\frac{a}{2})$。我们必须确定离该位置最近的主体球。根据对称性，最近的主体原子是位于立方体6个面中心的原子。它们的坐标是：\n$(\\frac{a}{2}, \\frac{a}{2}, 0)$、$(\\frac{a}{2}, \\frac{a}{2}, a)$、$(\\frac{a}{2}, 0, \\frac{a}{2})$、$(\\frac{a}{2}, a, \\frac{a}{2})$、$(0, \\frac{a}{2}, \\frac{a}{2})$和$(a, \\frac{a}{2}, \\frac{a}{2})$。\n\n让我们计算从八面体位置中心$(\\frac{a}{2}, \\frac{a}{2}, \\frac{a}{2})$到其中一个最近的主体原子中心的距离，例如，位于$z=0$面上，中心在$(\\frac{a}{2}, \\frac{a}{2}, 0)$的原子。设此距离为$d_{\\text{oct-host}}$。\n$$d_{\\text{oct-host}} = \\sqrt{\\left(\\frac{a}{2} - \\frac{a}{2}\\right)^2 + \\left(\\frac{a}{2} - \\frac{a}{2}\\right)^2 + \\left(\\frac{a}{2} - 0\\right)^2} = \\sqrt{0 + 0 + \\left(\\frac{a}{2}\\right)^2} = \\frac{a}{2}$$\n根据立方对称性的要求，到所有6个面心原子的距离是相同的。\n\n问题陈述，一个半径为$r_{\\text{oct}}$的间隙球被放置在这个八面体位置，并与这6个周围的主体球相切。相切条件意味着间隙球中心与相邻主体球中心之间的距离是它们的半径之和，即$r_{\\text{oct}} + r$。\n因此，我们有以下关系：\n$$d_{\\text{oct-host}} = r_{\\text{oct}} + r$$\n代入计算出的距离$d_{\\text{oct-host}} = a/2$：\n$$\\frac{a}{2} = r_{\\text{oct}} + r \\quad (2)$$\n\n我们现在有一个包含两个方程的方程组：\n$$(1): \\quad a = 2\\sqrt{2}r$$\n$$(2): \\quad \\frac{a}{2} = r_{\\text{oct}} + r$$\n我们的目标是求出比率$r_{\\text{oct}}/r$。为实现这一目标，我们从方程组中消去$a$。将方程$(1)$代入方程$(2)$:\n$$\\frac{2\\sqrt{2}r}{2} = r_{\\text{oct}} + r$$\n这可以简化为：\n$$\\sqrt{2}r = r_{\\text{oct}} + r$$\n现在，我们求解$r_{\\text{oct}}$（用$r$表示）：\n$$r_{\\text{oct}} = (\\sqrt{2} - 1)r$$\n最后，我们计算所需的无量纲比率$r_{\\text{oct}}/r$：\n$$\\frac{r_{\\text{oct}}}{r} = \\sqrt{2} - 1$$\n这是该比率的精确解析表达式。\n数值上，这个值约等于 $\\sqrt{2} - 1 \\approx 1.41421356... - 1 = 0.41421356...$。四舍五入到4位有效数字，该比率为$0.4142$。", "answer": "$$\\boxed{\\sqrt{2} - 1}$$", "id": "2475691"}, {"introduction": "真实的材料世界远比完美的晶格复杂，非晶态材料（如金属玻璃）就是一个典型例子。这项实践將理论与现代计算材料科学连接起来，你将使用强大的 Voronoi 镶嵌分析方法来处理模拟的原子数据。通过这个练习，你将学会量化非晶结构中的局域配位数和堆积密度，并验证关于二十面体短程有序与高堆积效率之间关联性的著名假说。[@problem_id:2475684]", "problem": "给定一组代表锆基金属玻璃的原子位点。每个位点由三项指定：一个化学物种标签，一个表示为整数列表 $\\langle n_{3}, n_{4}, n_{5}, n_{6} \\rangle$ 的 Voronoi 指数（该指数统计了位点周围 Voronoi 多面体上具有 $k$ 条边的面的数量，其中 $k \\in \\{3,4,5,6\\}$），以及一个单位为 $\\text{\\AA}^{3}$ 的 Voronoi 胞体积 $V$。您将编写一个程序，对每个位点数据集，使用 Voronoi 指数对局域环境进行分类，计算每个位点的局域堆积分数，并定量地关联二十面体配位数 $12$ 的普遍性与高局域堆积密度。\n\n需要使用的基本定义和事实：\n- 围绕离散原子中心的 Voronoi 镶嵌将空间划分为多个区域，每个区域包含所有比其他任何中心更接近给定中心的点。一个位点的 Voronoi 多面体上 $k$-边形面的数量由 Voronoi 指数 $\\langle n_{3}, n_{4}, n_{5}, n_{6} \\rangle$ 汇总。\n- 一个位点的配位数 (CN) 是其不同最近邻的数量，等于其 Voronoi 多面体上的总面数。根据指数可得，$\\mathrm{CN} = \\sum_{k} n_{k}$；此处 $k \\in \\{3,4,5,6\\}$，因此 $\\mathrm{CN} = n_{3} + n_{4} + n_{5} + n_{6}$。\n- 一个完美的二十面体有 $12$ 个五边形面，没有三角形、四边形或六边形面。因此，一个位点是严格二十面体的充要条件是其 Voronoi 指数恰好为 $\\langle 0, 0, 12, 0 \\rangle$，这也得出 $\\mathrm{CN} = 12$。\n- 一个位点的局域堆积分数（局域原子堆积因子）可以定义为该物种金属半径的球体体积与分配给该位点的 Voronoi 胞体积之比：对于金属半径为 $r$ 且 Voronoi 胞体积为 $V$ 的物种，定义\n$$\n\\phi = \\frac{\\frac{4}{3}\\pi r^{3}}{V}.\n$$\n该量是无量纲的。它是一个局域度量，类似于晶体原子堆积因子，基于 Voronoi 镶嵌给出的空间划分。\n\n对所涉及的物种使用以下金属半径：\n- Zr: $r_{\\mathrm{Zr}} = 1.60 \\,\\text{\\AA}$\n- Cu: $r_{\\mathrm{Cu}} = 1.28 \\,\\text{\\AA}$\n- Ni: $r_{\\mathrm{Ni}} = 1.25 \\,\\text{\\AA}$\n- Al: $r_{\\mathrm{Al}} = 1.43 \\,\\text{\\AA}$\n\n您对每个数据集的任务是：\n1. 对每个位点，计算其 $\\mathrm{CN}$，当且仅当 Voronoi 指数等于 $\\langle 0, 0, 12, 0 \\rangle$ 时，将该位点分类为严格二十面体，并使用上述公式计算局域堆积分数 $\\phi$。所有计算必须使用提供的半径和单位为 $\\text{\\AA}^{3}$ 的 Voronoi 胞体积 $V$。\n2. 对该数据集，计算以下五个量：\n   - 严格二十面体位点的比例，定义为指标 $I$ 的均值，如果位点是严格二十面体，则 $I = 1$，否则 $I = 0$。\n   - 严格二十面体位点中的平均局域堆积分数。如果没有严格二十面体位点，则将此平均值定义为 $0$。\n   - 非二十面体位点中的平均局域堆积分数。如果没有非二十面体位点，则将此平均值定义为 $0$。\n   - 严格二十面体位点与非二十面体位点的平均局域堆积分数之差（二十面体减去非二十面体）。\n   - 严格二十面体指标的二元向量 $I$ 与局域堆积分数向量 $\\phi$ 之间的皮尔逊相关系数，计算公式为\n     $$\n     \\rho(I,\\phi) = \\frac{\\sum_{i=1}^{N} (I_{i}-\\overline{I}) (\\phi_{i}-\\overline{\\phi})}{\\sqrt{\\sum_{i=1}^{N} (I_{i}-\\overline{I})^{2}} \\, \\sqrt{\\sum_{i=1}^{N} (\\phi_{i}-\\overline{\\phi})^{2}}}.\n     $$\n     如果分母中的任一方差为零（即所有 $I_{i}$ 都相同或所有 $\\phi_{i}$ 都相同），则定义 $\\rho(I,\\phi) = 0$。\n\n将所有报告的量表示为十进制数（不带百分号），并将局域堆积分数视为无量纲。\n\n在您的程序中实现的测试套件（每个数据集是一个位点列表，其形式为（物种，Voronoi 指数，Voronoi 体积 $V$（单位：$\\text{\\AA}^{3}$）））：\n\n- 数据集 A:\n  - $\\mathrm{Zr}$, $\\langle 0, 0, 12, 0 \\rangle$, $V = 24.8$\n  - $\\mathrm{Zr}$, $\\langle 0, 0, 12, 0 \\rangle$, $V = 23.5$\n  - $\\mathrm{Cu}$, $\\langle 0, 2, 8, 2 \\rangle$, $V = 14.7$\n  - $\\mathrm{Cu}$, $\\langle 0, 1, 10, 1 \\rangle$, $V = 13.2$\n  - $\\mathrm{Ni}$, $\\langle 0, 0, 12, 0 \\rangle$, $V = 12.0$\n  - $\\mathrm{Ni}$, $\\langle 1, 0, 10, 1 \\rangle$, $V = 13.5$\n  - $\\mathrm{Al}$, $\\langle 0, 0, 12, 0 \\rangle$, $V = 16.8$\n  - $\\mathrm{Al}$, $\\langle 0, 3, 6, 3 \\rangle$, $V = 16.5$\n  - $\\mathrm{Zr}$, $\\langle 0, 0, 12, 0 \\rangle$, $V = 25.2$\n  - $\\mathrm{Zr}$, $\\langle 0, 4, 4, 4 \\rangle$, $V = 26.0$\n  - $\\mathrm{Cu}$, $\\langle 0, 0, 12, 0 \\rangle$, $V = 13.8$\n  - $\\mathrm{Ni}$, $\\langle 0, 0, 12, 0 \\rangle$, $V = 12.5$\n\n- 数据集 B:\n  - $\\mathrm{Zr}$, $\\langle 0, 0, 12, 0 \\rangle$, $V = 24.0$\n  - $\\mathrm{Zr}$, $\\langle 0, 0, 12, 0 \\rangle$, $V = 23.8$\n  - $\\mathrm{Zr}$, $\\langle 0, 1, 10, 1 \\rangle$, $V = 25.0$\n  - $\\mathrm{Cu}$, $\\langle 0, 0, 12, 0 \\rangle$, $V = 14.0$\n  - $\\mathrm{Cu}$, $\\langle 0, 2, 8, 2 \\rangle$, $V = 14.5$\n  - $\\mathrm{Ni}$, $\\langle 0, 0, 12, 0 \\rangle$, $V = 12.4$\n  - $\\mathrm{Ni}$, $\\langle 0, 0, 12, 0 \\rangle$, $V = 12.8$\n  - $\\mathrm{Al}$, $\\langle 0, 0, 12, 0 \\rangle$, $V = 17.5$\n  - $\\mathrm{Al}$, $\\langle 0, 3, 6, 3 \\rangle$, $V = 16.0$\n  - $\\mathrm{Cu}$, $\\langle 0, 0, 12, 0 \\rangle$, $V = 13.9$\n  - $\\mathrm{Zr}$, $\\langle 0, 0, 12, 0 \\rangle$, $V = 24.5$\n  - $\\mathrm{Ni}$, $\\langle 0, 1, 10, 1 \\rangle$, $V = 13.0$\n\n- 数据集 C:\n  - $\\mathrm{Zr}$, $\\langle 0, 2, 8, 2 \\rangle$, $V = 25.5$\n  - $\\mathrm{Zr}$, $\\langle 0, 3, 6, 3 \\rangle$, $V = 26.2$\n  - $\\mathrm{Cu}$, $\\langle 0, 1, 10, 1 \\rangle$, $V = 15.2$\n  - $\\mathrm{Ni}$, $\\langle 1, 0, 10, 1 \\rangle$, $V = 13.7$\n  - $\\mathrm{Al}$, $\\langle 0, 4, 4, 4 \\rangle$, $V = 18.0$\n  - $\\mathrm{Cu}$, $\\langle 0, 2, 8, 2 \\rangle$, $V = 14.2$\n  - $\\mathrm{Ni}$, $\\langle 0, 3, 6, 3 \\rangle$, $V = 12.9$\n  - $\\mathrm{Al}$, $\\langle 0, 1, 10, 1 \\rangle$, $V = 17.0$\n  - $\\mathrm{Zr}$, $\\langle 0, 1, 10, 1 \\rangle$, $V = 24.8$\n  - $\\mathrm{Cu}$, $\\langle 0, 4, 4, 4 \\rangle$, $V = 15.5$\n\n- 数据集 D:\n  - $\\mathrm{Zr}$, $\\langle 0, 0, 12, 0 \\rangle$, $V = 24.2$\n  - $\\mathrm{Zr}$, $\\langle 0, 0, 12, 0 \\rangle$, $V = 23.9$\n  - $\\mathrm{Cu}$, $\\langle 0, 0, 12, 0 \\rangle$, $V = 13.6$\n  - $\\mathrm{Ni}$, $\\langle 0, 0, 12, 0 \\rangle$, $V = 12.3$\n  - $\\mathrm{Al}$, $\\langle 0, 0, 12, 0 \\rangle$, $V = 16.6$\n  - $\\mathrm{Zr}$, $\\langle 0, 0, 12, 0 \\rangle$, $V = 24.7$\n\n最终输出格式：\n-您的程序应生成单行输出，其中包含一个列表，内含四个结果向量，每个数据集一个，按 A、B、C、D 的顺序排列。每个结果向量必须是一个包含五个浮点数的列表，顺序与上述第 $2$ 项中指定的顺序相同。最终打印的行必须恰好是一个 Python 风格的列表的列表，例如：\n[$[$f_A, mI_A, mN_A, d_A, r_A$],$ $[$f_B, mI_B, mN_B, d_B, r_B$],$ $[$f_C, mI_C, mN_C, d_C, r_C$],$ $[$f_D, mI_D, mN_D, d_D, r_D$]$]\n其中 $f_{\\cdot}$ 是严格二十面体的比例，$mI_{\\cdot}$ 是二十面体位点中的平均 $\\phi$（若无则为 $0$），$mN_{\\cdot}$ 是非二十面体位点中的平均 $\\phi$（若无则为 $0$），$d_{\\cdot} = mI_{\\cdot} - mN_{\\cdot}$，以及 $r_{\\cdot}$ 是皮尔逊相关系数 $\\rho(I,\\phi)$，并遵循当方差为零时 $\\rho = 0$ 的约定。您可以四舍五入到任何合理的小数位数；这些值是无量纲的，并且必须以十进制数形式打印（不带百分号）。", "solution": "问题陈述已经过严格验证，并被确定为有效。它在科学上基于计算材料科学的原理，特别是使用 Voronoi 镶嵌分析非晶结构。该问题定义明确，所有术语、常数和计算过程都得到了明确无误的定义。它没有事实错误、矛盾和主观论断。所提供的数据对于多组分金属玻璃体系是物理上合理的。因此，我将继续提供完整解决方案。\n\n目标是通过将几何描述符（Voronoi 指数）与物理性质（局域堆积分数）相关联，来分析模型金属玻璃中的局域原子环境。该分析旨在量化一个假设，即原子的局域二十面体排列代表高堆积密度的构型，这是玻璃形成理论中的一个核心概念。该解决方案通过对每个提供的数据集执行系统的、分两阶段的计算过程来完成。\n\n首先，对每个单独的原子位点进行分析。对于一个给定的位点，我们获得了其化学物种、其 Voronoi 指数 $\\langle n_{3}, n_{4}, n_{5}, n_{6} \\rangle$ 和其 Voronoi 胞体积 $V$。\n\n$1$. 化学物种（例如 $\\mathrm{Zr}$、$\\mathrm{Cu}$、$\\mathrm{Ni}$、$\\mathrm{Al}$）决定了中心原子的金属半径 $r$。指定的半径为：$r_{\\mathrm{Zr}} = 1.60 \\,\\text{\\AA}$，$r_{\\mathrm{Cu}} = 1.28 \\,\\text{\\AA}$，$r_{\\mathrm{Ni}} = 1.25 \\,\\text{\\AA}$，以及 $r_{\\mathrm{Al}} = 1.43 \\,\\text{\\AA}$。\n\n$2$. 计算位点的局域原子堆积分数 $\\phi$。这个量是晶体固体中原子堆积因子的局域类似物，定义为原子体积（模型化为半径为 $r$ 的球体）与其 Voronoi 胞体积 $V$ 之比：\n$$\n\\phi = \\frac{\\frac{4}{3}\\pi r^{3}}{V}\n$$\n$\\phi$ 值越高，表示原子周围的空间堆积越有效。\n\n$3$. 局域配位环境根据其 Voronoi 指数进行分类。为每个位点分配一个二元指标变量 $I$。根据所提供的完美二十面体的定义，当且仅当一个位点的 Voronoi 指数恰好为 $\\langle 0, 0, 12, 0 \\rangle$ 时，该位点被分类为“严格二十面体”。因此，我们定义：\n$$\nI = \\begin{cases} 1 & \\text{if Voronoi index is } \\langle 0, 0, 12, 0 \\rangle \\\\ 0 & \\text{otherwise} \\end{cases}\n$$\n这种分类将位点划分为两个不同的总体以进行统计比较。请注意，虽然配位数由 $\\mathrm{CN} = n_{3} + n_{4} + n_{5} + n_{6}$ 给出，但分类严格依赖于完整的指数，而不仅仅是 $\\mathrm{CN}=12$。\n\n其次，在处理完一个数据集中的所有 $N$ 个位点以生成一组对 $\\{ (I_i, \\phi_i) \\}_{i=1}^N$ 后，计算五个聚合统计量来表征整个数据集。\n\n$1$. 严格二十面体位点的比例 $f$，是指标变量的算术平均值：\n$$\nf = \\frac{1}{N} \\sum_{i=1}^{N} I_i\n$$\n\n$2$. 使用指标 $I$ 将位点进行划分。计算严格二十面体位点（$I=1$）的平均局域堆积分数（记为 $mI$）和非二十面体位点（$I=0$）的平均值（记为 $mN$）。根据问题陈述，如果任一总体为空，其对应的平均值定义为 $0$。\n\n$3$. 计算平均堆积分数之差 $d = mI - mN$。该值直接衡量了与二十面体配位相关的堆积密度的提升（如果有的话）。正的 $d$ 值支持二十面体序与更紧密堆积相关的假设。\n\n$4$. 指标向量 $I$ 和堆积分数向量 $\\phi$ 之间的皮尔逊相关系数 $\\rho(I, \\phi)$ 使用标准公式计算：\n$$\n\\rho(I,\\phi) = \\frac{\\sum_{i=1}^{N} (I_{i}-\\overline{I}) (\\phi_{i}-\\overline{\\phi})}{\\sqrt{\\sum_{i=1}^{N} (I_{i}-\\overline{I})^{2}} \\, \\sqrt{\\sum_{i=1}^{N} (\\phi_{i}-\\overline{\\phi})^{2}}}\n$$\n其中 $\\overline{I}$ 和 $\\overline{\\phi}$ 分别是 $I$ 和 $\\phi$ 的样本均值。该系数衡量了作为二十面体的二元属性与局域堆积密度的连续属性之间的线性关系的强度和方向。按照规定，如果任一向量的方差为零（即所有位点都是二十面体或所有位点都是非二十面体），则相关系数 $\\rho(I, \\phi)$ 定义为 $0$。\n\n将此完整过程应用于测试套件中提供的四个数据集中的每一个，以生成最终结果。", "answer": "```python\nimport numpy as np\nimport math\n\ndef solve():\n    \"\"\"\n    Solves the problem of analyzing local atomic environments in a metallic glass.\n    \"\"\"\n\n    # Foundational definitions and facts\n    RADII = {\n        \"Zr\": 1.60,\n        \"Cu\": 1.28,\n        \"Ni\": 1.25,\n        \"Al\": 1.43,\n    }\n    ATOMIC_VOLUMES = {\n        species: (4 / 3) * math.pi * (radius**3)\n        for species, radius in RADII.items()\n    }\n    ICOSAHEDRAL_INDEX = (0, 0, 12, 0)\n\n    # Test suite\n    datasets = {\n        \"A\": [\n            (\"Zr\", (0, 0, 12, 0), 24.8),\n            (\"Zr\", (0, 0, 12, 0), 23.5),\n            (\"Cu\", (0, 2, 8, 2), 14.7),\n            (\"Cu\", (0, 1, 10, 1), 13.2),\n            (\"Ni\", (0, 0, 12, 0), 12.0),\n            (\"Ni\", (1, 0, 10, 1), 13.5),\n            (\"Al\", (0, 0, 12, 0), 16.8),\n            (\"Al\", (0, 3, 6, 3), 16.5),\n            (\"Zr\", (0, 0, 12, 0), 25.2),\n            (\"Zr\", (0, 4, 4, 4), 26.0),\n            (\"Cu\", (0, 0, 12, 0), 13.8),\n            (\"Ni\", (0, 0, 12, 0), 12.5),\n        ],\n        \"B\": [\n            (\"Zr\", (0, 0, 12, 0), 24.0),\n            (\"Zr\", (0, 0, 12, 0), 23.8),\n            (\"Zr\", (0, 1, 10, 1), 25.0),\n            (\"Cu\", (0, 0, 12, 0), 14.0),\n            (\"Cu\", (0, 2, 8, 2), 14.5),\n            (\"Ni\", (0, 0, 12, 0), 12.4),\n            (\"Ni\", (0, 0, 12, 0), 12.8),\n            (\"Al\", (0, 0, 12, 0), 17.5),\n            (\"Al\", (0, 3, 6, 3), 16.0),\n            (\"Cu\", (0, 0, 12, 0), 13.9),\n            (\"Zr\", (0, 0, 12, 0), 24.5),\n            (\"Ni\", (0, 1, 10, 1), 13.0),\n        ],\n        \"C\": [\n            (\"Zr\", (0, 2, 8, 2), 25.5),\n            (\"Zr\", (0, 3, 6, 3), 26.2),\n            (\"Cu\", (0, 1, 10, 1), 15.2),\n            (\"Ni\", (1, 0, 10, 1), 13.7),\n            (\"Al\", (0, 4, 4, 4), 18.0),\n            (\"Cu\", (0, 2, 8, 2), 14.2),\n            (\"Ni\", (0, 3, 6, 3), 12.9),\n            (\"Al\", (0, 1, 10, 1), 17.0),\n            (\"Zr\", (0, 1, 10, 1), 24.8),\n            (\"Cu\", (0, 4, 4, 4), 15.5),\n        ],\n        \"D\": [\n            (\"Zr\", (0, 0, 12, 0), 24.2),\n            (\"Zr\", (0, 0, 12, 0), 23.9),\n            (\"Cu\", (0, 0, 12, 0), 13.6),\n            (\"Ni\", (0, 0, 12, 0), 12.3),\n            (\"Al\", (0, 0, 12, 0), 16.6),\n            (\"Zr\", (0, 0, 12, 0), 24.7),\n        ],\n    }\n\n    def analyze_dataset(dataset):\n        \"\"\"\n        Computes the five required statistical quantities for a single dataset.\n        \"\"\"\n        if not dataset:\n            return [0.0, 0.0, 0.0, 0.0, 0.0]\n\n        # Stage 1: Per-site analysis\n        indicators = []\n        packing_fractions = []\n        \n        for site in dataset:\n            species, voronoi_index, voronoi_volume = site\n            \n            # Classify site\n            is_icosahedral = 1 if voronoi_index == ICOSAHEDRAL_INDEX else 0\n            indicators.append(is_icosahedral)\n            \n            # Compute local packing fraction\n            atomic_volume = ATOMIC_VOLUMES[species]\n            phi = atomic_volume / voronoi_volume\n            packing_fractions.append(phi)\n            \n        indicators = np.array(indicators)\n        packing_fractions = np.array(packing_fractions)\n\n        # Stage 2: Dataset-level statistical analysis\n        \n        # 1. Fraction of strictly icosahedral sites\n        f_ico = np.mean(indicators)\n        \n        # 2. Mean local packing fraction among strictly icosahedral sites\n        phi_ico = packing_fractions[indicators == 1]\n        mean_phi_ico = np.mean(phi_ico) if phi_ico.size > 0 else 0.0\n        \n        # 3. Mean local packing fraction among non-icosahedral sites\n        phi_non_ico = packing_fractions[indicators == 0]\n        mean_phi_non_ico = np.mean(phi_non_ico) if phi_non_ico.size > 0 else 0.0\n        \n        # 4. Difference in means\n        diff_means = mean_phi_ico - mean_phi_non_ico\n        \n        # 5. Pearson correlation coefficient\n        # Check for zero variance as per problem specification\n        if np.std(indicators) == 0 or np.std(packing_fractions) == 0:\n            correlation = 0.0\n        else:\n            # np.corrcoef returns a 2x2 matrix, we need the off-diagonal element\n            correlation = np.corrcoef(indicators, packing_fractions)[0, 1]\n            \n        return [f_ico, mean_phi_ico, mean_phi_non_ico, diff_means, correlation]\n\n    # Process all datasets in the specified order A, B, C, D\n    all_results = []\n    for key in sorted(datasets.keys()):\n        dataset = datasets[key]\n        result_vector = analyze_dataset(dataset)\n        all_results.append(result_vector)\n    \n    # Final output formatting\n    # Using np.round for consistent floating point representation in the string\n    formatted_results = [\n        \"[\" + \",\".join(map(str, np.round(res, 8))) + \"]\" for res in all_results\n    ]\n    print(f\"[{','.join(formatted_results)}]\")\n\n\nsolve()\n```", "id": "2475684"}]}