{"hands_on_practices": [{"introduction": "我们从一个基本问题开始：如何从一组给定的空间群生成元，推导出晶体中一个原子的所有等效位置？这个练习将指导您使用塞茨(Seitz)表示法，手动操作对称性算符，从一个初始的任意位置 $(x,y,z)$ 出发，生成单斜晶系空间群 $P2_1/c$ 中的所有等效点。通过这个基本实践，我们不仅能确认该空间群的一般威克夫(Wyckoff)位置多重数为4，更重要的是能将抽象的对称操作与晶胞中原子的具体坐标联系起来，从而真正“动手”理解空间群的含义。", "problem": "一个原始单斜晶体的空间群为 $P2_{1}/c$，处于特异轴为 $b$ 轴的常规设定下。该空间群由 Bravais 晶格平移和两个非初基对称操作生成，用 Seitz 记法 $\\{R \\mid \\mathbf{t}\\}$ 表示为：\n- 绕 $b$ 轴的二次螺旋轴 $\\{C_{2y} \\mid 0,\\tfrac{1}{2},0\\}$，以及\n- 垂直于 $b$ 轴的 $c$-滑移面 $\\{m_{y} \\mid 0,0,\\tfrac{1}{2}\\}$。\n\n此处的 $\\{R \\mid \\mathbf{t}\\}$ 对分数坐标 $\\mathbf{r} = (x,y,z)$ 的作用为 $\\mathbf{r} \\mapsto R\\,\\mathbf{r} + \\mathbf{t}$，其中 $C_{2y} = \\mathrm{diag}(-1,1,-1)$ 且 $m_{y} = \\mathrm{diag}(1,-1,1)$。\n\n从分数坐标为 $(x,y,z)$ 的一个广义位置出发，仅使用这两个生成元和单位操作来：\n1) 明确推导出一个单胞内所有对称等效位置的集合（即，模去整数晶格平移后的位置），并且\n2) 从空间群陪集和点位对称性的第一性原理出发，论证 $P2_{1}/c$ 中的广义 Wyckoff 多重度等于你找到的不同位置的数量。\n\n你的最终答案必须是广义 Wyckoff 多重度，以单个无量纲整数形式给出。请勿四舍五入。", "solution": "所陈述的问题在科学上是合理的、提法恰当且自洽的。它描述了空间群 $P2_1/c$，其原点选择是有效的，尽管并非标准选择。我们将严格使用所提供的生成元进行推导。\n\n问题要求做两件事：首先，使用给定的生成元推导一个广义点 $(x,y,z)$ 的对称等效位置集合；其次，为广义 Wyckoff 多重度提供一个第一性原理的论证。\n\n设空间群为 $G$，纯晶格平移子群为 $T$。点群 $P$ 与商群 $G/T$ 同构。点群的阶 $|P|$ 决定了 $G$ 相对于 $T$ 的陪集分解中的陪集数量。\n\n所提供的非初基操作的生成元以 Seitz 记法 $\\{R \\mid \\mathbf{t}\\}$ 给出，其中 $R$ 是旋转矩阵，$\\mathbf{t}$ 是平移矢量。其对位置矢量 $\\mathbf{r} = (x,y,z)$ 的作用是 $\\mathbf{r} \\mapsto R\\mathbf{r} + \\mathbf{t}$。\n\n生成元为：\n1. 一个二次螺旋轴操作，$g_1 = \\{C_{2y} \\mid \\mathbf{t}_1\\}$，其中 $R_1 = C_{2y} = \\mathrm{diag}(-1,1,-1)$ 且 $\\mathbf{t}_1 = (0, \\frac{1}{2}, 0)$。\n2. 一个 c-滑移面操作，$g_2 = \\{m_y \\mid \\mathbf{t}_2\\}$，其中 $R_2 = m_y = \\mathrm{diag}(1,-1,1)$ 且 $\\mathbf{t}_2 = (0, 0, \\frac{1}{2})$。\n\n单位操作为 $g_0 = \\{E \\mid \\mathbf{0}\\}$，其中 $E$ 是单位矩阵，$\\mathbf{0}$ 是零矢量。\n\n首先，我们从一个广义位置 $\\mathbf{r}_1 = (x,y,z)$ 开始，生成等效位置的集合。\n\n1.  将单位操作 $g_0$ 应用于 $\\mathbf{r}_1$：\n    $$g_0 \\mathbf{r}_1 = E\\mathbf{r}_1 + \\mathbf{0} = (x,y,z)$$\n\n2.  将第一个生成元 $g_1$ 应用于 $\\mathbf{r}_1$：\n    $$g_1 \\mathbf{r}_1 = C_{2y}\\mathbf{r}_1 + \\mathbf{t}_1 = \\begin{pmatrix} -1 & 0 & 0 \\\\ 0 & 1 & 0 \\\\ 0 & 0 & -1 \\end{pmatrix} \\begin{pmatrix} x \\\\ y \\\\ z \\end{pmatrix} + \\begin{pmatrix} 0 \\\\ \\frac{1}{2} \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} -x \\\\ y+\\frac{1}{2} \\\\ -z \\end{pmatrix}$$\n    这给出第二个位置，$\\mathbf{r}_2 = (-x, y+\\frac{1}{2}, -z)$。\n\n3.  将第二个生成元 $g_2$ 应用于 $\\mathbf{r}_1$：\n    $$g_2 \\mathbf{r}_1 = m_y\\mathbf{r}_1 + \\mathbf{t}_2 = \\begin{pmatrix} 1 & 0 & 0 \\\\ 0 & -1 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix} \\begin{pmatrix} x \\\\ y \\\\ z \\end{pmatrix} + \\begin{pmatrix} 0 \\\\ 0 \\\\ \\frac{1}{2} \\end{pmatrix} = \\begin{pmatrix} x \\\\ -y \\\\ z+\\frac{1}{2} \\end{pmatrix}$$\n    这给出第三个位置，$\\mathbf{r}_3 = (x, -y, z+\\frac{1}{2})$。\n\n4.  为了使群封闭，我们必须考虑生成元的复合。让我们计算操作 $g_3 = g_2 g_1$。一个操作 $\\{R_a | \\mathbf{t}_a\\}$ 之后再进行 $\\{R_b | \\mathbf{t}_b\\}$ 操作，结果是 $\\{R_b R_a | R_b \\mathbf{t}_a + \\mathbf{t}_b\\}$。\n    产生的操作是 $\\{R_2 R_1 \\mid R_2 \\mathbf{t}_1 + \\mathbf{t}_2\\}$。\n    旋转部分为 $R_2 R_1 = m_y C_{2y} = \\mathrm{diag}(1,-1,1)\\mathrm{diag}(-1,1,-1) = \\mathrm{diag}(-1,-1,-1) = -E = i$，即反演操作。\n    平移部分为 $R_2 \\mathbf{t}_1 + \\mathbf{t}_2 = \\mathrm{diag}(1,-1,1)(0, \\frac{1}{2}, 0) + (0, 0, \\frac{1}{2}) = (0, -\\frac{1}{2}, 0) + (0, 0, \\frac{1}{2}) = (0, -\\frac{1}{2}, \\frac{1}{2})$。\n    因此，第四个操作是 $g_3 = \\{i \\mid 0, -\\frac{1}{2}, \\frac{1}{2}\\}$。将其应用于 $\\mathbf{r}_1$：\n    $$g_3 \\mathbf{r}_1 = i\\mathbf{r}_1 + (0, -\\frac{1}{2}, \\frac{1}{2}) = (-x, -y, -z) + (0, -\\frac{1}{2}, \\frac{1}{2}) = (-x, -y-\\frac{1}{2}, -z+\\frac{1}{2})$$\n    这给出第四个位置，$\\mathbf{r}_4 = (-x, -y-\\frac{1}{2}, -z+\\frac{1}{2})$。\n\n生成的位置集合为：\n1. $(x,y,z)$\n2. $(-x, y+\\frac{1}{2}, -z)$\n3. $(x, -y, z+\\frac{1}{2})$\n4. $(-x, -y-\\frac{1}{2}, -z+\\frac{1}{2})$\n\n对于 $(x,y,z)$ 的一个广义选择，这四个位置是不同的，并且不能通过任何整数晶格平移相互关联。操作集合 $\\{g_0, g_1, g_2, g_2 g_1\\}$ 构成一个4阶群，对应于点群 $2/m$。因此，我们已经找到了所有等效位置。\n\n至此，问题的第一部分完成。\n\n对于第二部分，我们从第一性原理进行论证。Wyckoff 位置的多重度是在一个单胞内由空间群操作生成的等效点的数量。它由以下公式给出：\n$$M = \\frac{|P|}{|S_{\\mathbf{r}}^{P}|}$$\n其中 $|P|$ 是晶体的晶体学点群的阶，而 $|S_{\\mathbf{r}}^{P}|$ 是位置 $\\mathbf{r}$ 的点位对称点群的阶。\n\n“广义位置”被定义为这样一个位置 $\\mathbf{r}$，其点位对称性是最低的，即点位对称群 $S_{\\mathbf{r}}$ 只包含单位操作（以及纯晶格平移）。这意味着对于任何非平庸的对称操作 $g_k \\in G$（其中 $g_k \\notin T$），将其应用于 $\\mathbf{r}$ 不会得到一个与 $\\mathbf{r}$ 平移等效的点。用数学语言表述，对于任何 $g_k \\notin T$，都有 $g_k \\mathbf{r} \\not\\equiv \\mathbf{r} \\pmod{T}$。对于一个广义位置，其点位对称点群是平凡群，$S_{\\mathbf{r}}^{P} = \\{E\\}$，所以其阶为 $|S_{\\mathbf{r}}^{P}| = 1$。\n\n因此，对于一个广义位置，其多重度为：\n$$M_{\\text{general}} = \\frac{|P|}{1} = |P|$$\n\n因此，广义 Wyckoff 多重度等于该空间群的点群的阶。\n\n对于空间群 $P2_1/c$，其相应的点群是 $2/m$。该点群的元包括单位操作 ($E$)、二次旋转 ($2$)、镜面反映 ($m$) 和反演 ($i$)。该群的阶为 $|P| = 4$。\n\n因此，空间群 $P2_1/c$ 的广义 Wyckoff 多重度为 $4$。这与我们在第一部分中的明确推导完全一致，我们在那里为一个广义起始点 $(x,y,z)$ 找到了恰好 $4$ 个不同的等效位置。根本原因在于，根据定义，一个广义点没有任何特殊对称性，因此将 $G/T$ 的 $|P|$ 个不同陪集代表元中的每一个应用于该点，都必须在单胞内产生一个不同的点。", "answer": "$$ \\boxed{4} $$", "id": "2536947"}, {"introduction": "在理解了一般位置后，一个自然而然的问题是：如果一个原子恰好位于某个对称元素（如旋转轴或反演中心）上，会发生什么？这种情况对应于特殊的威克夫位置，其具有更高的位点对称性，并导致多重数（即等效点的数量）减少。这个练习将带您探讨 $P2_1/c$ 空间群中的特殊位置，通过寻找被反演操作固定的点来确定其坐标，并从第一性原理计算其多重数。这有助于深刻理解位点对称性、不动点和多重数之间的内在联系。", "problem": "一个单斜晶体属于空间群 $P2_{1}/c$ (《国际晶体学表》空间群编号 $14$)，其处于常规设定下，单斜轴为 $b$ 轴，且原点位于一个反演中心。其对称操作可以由相对于平移子群的以下陪集代表元给出 (用塞茨记号 $\\{R|\\mathbf{t}\\}$ 表示，其作用于分数坐标 $\\mathbf{r} = (x,y,z)$ 的方式为 $\\mathbf{r} \\mapsto R\\mathbf{r} + \\mathbf{t}$)：\n- $\\{ \\mathbf{1} | (0,0,0) \\}$ (恒等操作)\n- $\\{ -\\mathbf{1} | (0,0,0) \\}$ (反演操作)\n- $\\{ C_{2y} | (0, \\tfrac{1}{2}, \\tfrac{1}{2}) \\}$ (二次螺旋轴)，其中 $C_{2y} = \\mathrm{diag}(-1,1,-1)$\n- $\\{ m_{y} | (0, \\tfrac{1}{2}, \\tfrac{1}{2}) \\}$ ($c$-滑移面)，其中 $m_{y} = \\mathrm{diag}(1,-1,1)$\n\n一般维科夫位置的点座对称性为 $1$，在这些陪集代表元的作用下，每个原胞内会产生一个包含 $4$ 个点的轨道。一个点座对称性为 $\\bar{1}$ 的特殊位置是空间群中某个反演操作的不动点。仅使用点座对称性作为点的稳定子以及对称操作的定义，确定对 $(x,y,z)$ 的显式约束，使其位于一个点座对称性为 $\\bar{1}$ 的特殊位置上。然后，从第一性原理出发，计算该特殊维科夫位置的多重度 (每个原胞的等效点数)。将你的最终答案表示为一个无单位的整数。", "solution": "一个点 $\\mathbf{r} = (x,y,z)$ 的点座对称性为 $\\bar{1}$，意味着它位于一个反演中心上。在数学上，这表示该点是某个反演操作的不动点。\n\n空间群 $P2_1/c$（编号 14）在其标准设定下，原点位于一个反演中心。这意味着 $\\{ -\\mathbf{1} | (0,0,0) \\}$ 是群的一个对称操作。其他所有的反演中心都与此原点通过晶格平移相关联。因此，任何一个反演操作都可以写成 $\\{-\\mathbf{1} | \\mathbf{n}\\}$ 的形式，其中 $\\mathbf{n}$ 是一个整数分量构成的晶格平移向量。\n\n一个点 $\\mathbf{r}$ 是一个反演中心，当且仅当它满足不动点条件：\n$$ \\{-\\mathbf{1} | \\mathbf{n}\\} \\mathbf{r} \\equiv \\mathbf{r} \\pmod{T_{\\mathrm{conv}}} $$\n其中 $T_{\\mathrm{conv}}$ 代表任意整数晶格平移。展开此式：\n$$ -\\mathbf{r} + \\mathbf{n} = \\mathbf{r} + \\mathbf{m} $$\n其中 $\\mathbf{m}$ 是另一个整数晶格平移向量。整理后得到：\n$$ 2\\mathbf{r} = \\mathbf{n} - \\mathbf{m} $$\n由于 $\\mathbf{n}$ 和 $\\mathbf{m}$ 都是整数向量，它们的差也是一个整数向量，我们称之为 $\\mathbf{k} = (k_1, k_2, k_3)$。因此，不动点必须满足：\n$$ 2x = k_1, \\quad 2y = k_2, \\quad 2z = k_3 $$\n这得出的结论是，所有反演中心的坐标分量 $x, y, z$ 都必须是 $0$ 或 $\\tfrac{1}{2}$ 的倍数。在单个晶胞内（$0 \\le x,y,z  1$），可能的坐标是：\n$$ x \\in \\{0, \\tfrac{1}{2}\\}, \\quad y \\in \\{0, \\tfrac{1}{2}\\}, \\quad z \\in \\{0, \\tfrac{1}{2}\\} $$\n这些坐标定义了 $P2_1/c$ 中所有点座对称性为 $\\bar{1}$ 的特殊维科夫位置。这组坐标共有8个点，它们构成了四个不等价的维科夫位置（$2a, 2b, 2c, 2d$）。\n\n接下来，我们从第一性原理计算这些特殊位置的多重度。\n根据轨道-稳定子定理，多重度 $M$ 的计算公式为：\n$$ M = \\frac{|P|}{|S_{\\mathbf{r}}^{P}|} $$\n其中 $|P|$ 是晶体点群的阶，而 $|S_{\\mathbf{r}}^{P}|$ 是位置 $\\mathbf{r}$ 的点位对称群的阶。\n\n对于空间群 $P2_1/c$，其点群是 $2/m$。该点群包含恒等($E$)、二次旋转($2$)、镜面反映($m$)和反演($\\bar{1}$) 四个操作，因此其阶 $|P| = 4$。\n我们正在寻找的特殊位置，其点座对称性被指定为 $\\bar{1}$。这个对称群包含恒等操作和反演操作，因此其阶 $|S_{\\mathbf{r}}^{P}| = 2$。\n\n将这些值代入公式：\n$$ M = \\frac{4}{2} = 2 $$\n因此，在 $P2_1/c$ 中，任何一个点座对称性为 $\\bar{1}$ 的特殊维科夫位置的多重度都是 $2$。这与国际晶体学表中对 $2a, 2b, 2c, 2d$ 位置的描述一致。", "answer": "$$\\boxed{2}$$", "id": "2536891"}, {"introduction": "我们已经通过手动计算熟悉了生成等效位置的过程，但这在处理复杂结构时既繁琐又容易出错。如何将这个过程系统化、算法化，使其能被计算机程序可靠地执行？本练习要求您从多个算法描述中，辨析出一种基于群论第一性原理的、能够正确并完整地枚举出所有威克夫等效位置的算法。这不仅是对您理论知识的考验，更是从“手动计算”迈向“算法思维”的关键一步，这对于理解和使用现代晶体学分析软件至关重要。", "problem": "一个晶体空间群由一组有限的 Seitz 算符 $\\{\\mathbf{R}_i \\mid \\mathbf{t}_i\\}$ 生成，其群乘法为 $\\{\\mathbf{R}_1 \\mid \\mathbf{t}_1\\}\\{\\mathbf{R}_2 \\mid \\mathbf{t}_2\\} = \\{\\mathbf{R}_1\\mathbf{R}_2 \\mid \\mathbf{R}_1 \\mathbf{t}_2 + \\mathbf{t}_1\\}$。在具有分数坐标的常规晶胞中，设 $\\mathbf{r}_0 \\in \\mathbb{R}^3$ 表示一个原子位置。请您概述一个正确的、可终止的、基于群论第一性原理的算法，以枚举常规晶胞内所有与 $\\mathbf{r}_0$ 等效的位置，从而获得 Wyckoff 轨道及其重复数。\n\n仅使用以下基本定义和事实：\n- 空间群 $G$ 通过 $\\{\\mathbf{R}\\mid\\mathbf{t}\\} : \\mathbf{r} \\mapsto \\mathbf{R}\\mathbf{r} + \\mathbf{t}$ 作用于点。\n- 与常规晶胞相关联、由分数坐标中的单位步长生成的纯平移子群是 $T_{\\mathrm{conv}}=\\{\\{\\mathbf{I}\\mid \\mathbf{n}\\}: \\mathbf{n}\\in \\mathbb{Z}^3\\}$。\n- 如果两个位置相差一个 Bravais 晶格的平移，则它们在周期性晶体中代表同一个点；在常规晶胞列表中，保留那些因非整数的定心平移（不属于 $T_{\\mathrm{conv}}$）而不同的、不重复的位置。\n- $\\mathbf{r}_0$ 在 $G$ 作用下模 $T_{\\mathrm{conv}}$ 的轨道，由所有通过减去 $\\mathbb{Z}^3$ 中的整数向量而约化回常规晶胞内的像构成。\n- $\\mathbf{r}_0$ 的位置对称子群（稳定子群）由所有满足 $\\mathbf{R}\\mathbf{r}_0+\\mathbf{t}=\\mathbf{r}_0+\\mathbf{n}$ (对于某个 $\\mathbf{n}\\in \\mathbb{Z}^3$) 的 $\\{\\mathbf{R}\\mid\\mathbf{t}\\}\\in G$ 组成。\n\n以下哪个选项明确描述了一个正确且完整的算法，该算法从生成元 $\\{\\mathbf{R}_i \\mid \\mathbf{t}_i\\}$ 出发，枚举了常规晶胞中所有与 $\\mathbf{r}_0$ 等效的位置，正确地处理了非整模操作和定心，避免了对纯平移的无限枚举，并以正确的重复数（轨道大小）终止？\n\nA. 通过给定生成元的广度优先闭包，构建 $G/T_{\\mathrm{conv}}$ 的一个有限陪集代表元集合：从 $\\{\\mathbf{I}\\mid \\mathbf{0}\\}$ 开始，重复乘以生成元，每次相乘后通过减去一个整数向量来约化平移部分，使得 $\\mathbf{t}\\in [0,1)^3$；将新的代表元存储为不同的序对 $(\\mathbf{R},\\mathbf{t}\\bmod \\mathbb{Z}^3)$，当没有新的代表元出现时停止。如果常规设置中存在定心平移，则将其视为形式为 $\\{\\mathbf{I}\\mid \\mathbf{c}_j\\}$ 的额外生成元。然后，将每个存储的代表元 $\\{\\mathbf{R}\\mid \\mathbf{t}\\}$ 应用于 $\\mathbf{r}_0$ 得到 $\\mathbf{r}'=\\mathbf{R}\\mathbf{r}_0+\\mathbf{t}$，通过减去一个整数向量将 $\\mathbf{r}'$ 约化到常规晶胞中，使得 $\\mathbf{r}'\\in [0,1)^3$，并在数值容差内去重。最终得到的集合即为常规晶胞中的完整 Wyckoff 轨道，其重复数等于其基数。位置对称子群通过选择那些满足 $\\mathbf{R}\\mathbf{r}_0+\\mathbf{t}=\\mathbf{r}_0+\\mathbf{n}$ (对于某个 $\\mathbf{n}\\in\\mathbb{Z}^3$) 的代表元获得。\n\nB. 枚举生成元的所有词，直到一个预设的词长截断，将它们应用于 $\\mathbf{r}_0$，并通过减去整数和平移来约化位置，使得所有 $\\mathbf{r}'$ 都映射到一个原胞中。在作用于 $\\mathbf{r}_0$ 之前，通过将 $\\{\\mathbf{R}\\mid \\mathbf{t}\\}$ 投影为 $\\{\\mathbf{R}\\mid \\mathbf{0}\\}$ 来丢弃任何具有分数平移部分的操作（例如螺旋或滑移）；在原胞中去重后获得最终的位置集合。\n\nC. 通过仅取生成元的旋转部分 $\\mathbf{R}$ 来构造晶体学点群，将其闭包为一个有限的旋转群，并将每个 $\\mathbf{R}$ 应用于 $\\mathbf{r}_0$ 得到 $\\mathbf{r}'=\\mathbf{R}\\mathbf{r}_0$。通过减去整数向量将 $\\mathbf{r}'$ 约化到 $[0,1)^3$ 并去重。得到的集合即为常规晶胞中的等效位置列表；Seitz 算符的平移部分可以忽略，因为它们只生成 Bravais 平移。\n\nD. 首先通过测试每个生成元乘积直到一个截断长度是否满足等式 $\\mathbf{R}\\mathbf{r}_0+\\mathbf{t}=\\mathbf{r}_0$ 来计算位置对称阶；从点群阶数与此位置对称阶数的比值来估计重复数。然后，通过将点群的每个旋转 $\\mathbf{R}$ 应用于 $\\mathbf{r}_0$，约化到 $[0,1)^3$，并保留与估计的重复数一样多的不同位置来生成等效位置；在枚举步骤中可以忽略非整模分数平移和定心，因为重复数已经确定。", "solution": "我们从基本定义开始。空间群 $G$ 是作用于 $\\mathbb{R}^3$ 的欧几里得等距群的一个子群；每个元素作为仿射等距作用，用 Seitz 符号 $\\{\\mathbf{R}\\mid\\mathbf{t}\\}$ 表示，其线性部分 $\\mathbf{R}$（一个行列式为 $\\pm 1$ 且与晶格兼容的正交矩阵）和平移部分 $\\mathbf{t}$（在常规晶胞分数坐标基下可能是分数的）。群法则是 $\\{\\mathbf{R}_1 \\mid \\mathbf{t}_1\\}\\{\\mathbf{R}_2 \\mid \\mathbf{t}_2\\} = \\{\\mathbf{R}_1\\mathbf{R}_2 \\mid \\mathbf{R}_1 \\mathbf{t}_2 + \\mathbf{t}_1\\}$，对位置 $\\mathbf{r}$ 的作用是 $\\mathbf{r}\\mapsto \\mathbf{R}\\mathbf{r}+\\mathbf{t}$。\n\n为了枚举常规晶胞内一个位置 $\\mathbf{r}_0$ 的轨道，我们依赖于两个关键的群论结构：\n\n- 与常规晶胞关联的平移子群，$T_{\\mathrm{conv}}=\\{\\{\\mathbf{I}\\mid \\mathbf{n}\\}: \\mathbf{n}\\in \\mathbb{Z}^3\\}$，表示分数坐标的整数平移。在定心晶格中，定心向量不属于 $T_{\\mathrm{conv}}$；相反，它们是 Bravais 晶格的额外纯平移，作为明确的对称操作出现，并在常规晶胞列表中生成不同的位置。\n\n- 有限商群 $G/T_{\\mathrm{conv}}$ 捕捉了模整数平移后不同的仿射对称操作。其有限性源于晶体学限制，这意味着只有有限多个不同的旋转部分 $\\mathbf{R}$，并且对于每个 $\\mathbf{R}$，平移部分可以模 $\\mathbb{Z}^3$ 约化到紧致域 $[0,1)^3$ 中，从而由一组有限的生成元产生有限多个不同的序对 $(\\mathbf{R},\\mathbf{t}\\bmod \\mathbb{Z}^3)$。\n\n因此，一个基于这些原理的算法应该：\n\n- 通过在模 $T_{\\mathrm{conv}}$ 下工作，避免对无限平移子群的显式枚举。\n\n- 精确地包含非整模元素（螺旋轴和滑移面），按照它们在 Seitz 算符中的分数 $\\mathbf{t}$ 进行处理，因为它们会产生不同的陪集代表元和 $\\mathbf{r}_0$ 的不同像。\n\n- 在常规分数坐标系下工作时，将定心平移作为生成元集中的纯平移对称操作来合并，从而使通过定心相关的等效位置在常规晶胞列表中作为不同位置保留下来。\n\n- 依赖于 $G/T_{\\mathrm{conv}}$ 的有限性，并使用在生成元下的闭包以及模 $\\mathbb{Z}^3$ 的约化来确保终止。\n\n现在我们评估每个选项。\n\n选项A：该选项描述了通过生成元的闭包来构造 $G/T_{\\mathrm{conv}}$ 的一组完整陪集代表元，并在每次乘法后对平移部分进行模 $\\mathbb{Z}^3$ 约化。具体来说，维护一个形式为 $\\{\\mathbf{R}\\mid\\mathbf{t}_{\\mathrm{red}}\\}$ 且 $\\mathbf{t}_{\\mathrm{red}}\\in [0,1)^3$ 的代表元集合 $\\mathcal{H}$；从 $\\{\\mathbf{I}\\mid\\mathbf{0}\\}$ 开始，对于每个生成元 $\\{\\mathbf{R}_i\\mid \\mathbf{t}_i\\}$ 和每个 $\\{\\mathbf{R}\\mid\\mathbf{t}\\}\\in \\mathcal{H}$，形成 $\\{\\mathbf{R}_i\\mathbf{R}\\mid \\mathbf{R}_i\\mathbf{t}+\\mathbf{t}_i\\}$，并通过减去一个整数向量将其平移部分约化到 $[0,1)^3$ 内。如果序对 $(\\mathbf{R}_i\\mathbf{R},(\\mathbf{R}_i\\mathbf{t}+\\mathbf{t}_i)\\bmod \\mathbb{Z}^3)$ 是新的，则存储它。因为 $G/T_{\\mathrm{conv}}$ 是有限的，这个过程将以一个有限的集合 $\\mathcal{H}$ 终止，该集合列出了所有模整数平移的不同仿射对称性。接下来，将每个 $\\{\\mathbf{R}\\mid\\mathbf{t}\\}\\in \\mathcal{H}$ 应用于 $\\mathbf{r}_0$ 得到 $\\mathbf{r}'=\\mathbf{R}\\mathbf{r}_0+\\mathbf{t}$，并通过减去一个整数向量将 $\\mathbf{r}'$ 约化到常规晶胞中，使得 $\\mathbf{r}'\\in [0,1)^3$。在数值容差内去重以处理浮点运算。这产生了常规晶胞内的完整轨道（Wyckoff 等效位置）。重复数就是获得的唯一位置的数量。位置对称子群通过稳定子条件 $\\mathbf{R}\\mathbf{r}_0+\\mathbf{t}=\\mathbf{r}_0+\\mathbf{n}$ (对于某个 $\\mathbf{n}\\in \\mathbb{Z}^3$) 来识别。这正是所期望的、符合原理的算法；它尊重非整模操作，将定心作为对称操作包含在内，通过对 $T_{\\mathrm{conv}}$ 取商避免了无限平移枚举，并且能够终止。\n\n结论：正确。\n\n选项B：该选项建议枚举生成元的所有词，直到一个任意的截断长度，并丢弃非整模分数平移，方法是进行投影 $\\{\\mathbf{R}\\mid \\mathbf{t}\\}\\mapsto \\{\\mathbf{R}\\mid \\mathbf{0}\\}$。它还通过减去整数和定心平移将位置约化到一个原胞。这里有多个错误。首先，截断词长不能保证闭包，可能会遗漏群元素；其次，投影掉分数 $\\mathbf{t}$ 消除了螺旋和滑移操作的真实对称性内容，导致位置错误；第三，通过定心平移进行约化会将因定心而相关的位置映到同一点上，这删除了常规晶胞列表中应出现的不同位置；第四，该方法没有通过模 $T_{\\mathrm{conv}}$ 工作来消除无限平移子群，而是依赖于一个任意的截断。因此，它不能保证所期望的正确性或终止性。\n\n结论：错误。\n\n选项C：该选项完全忽略平移部分，仅用旋转 $\\mathbf{R}$ 进行操作。这仅在空间群是整模群且位置位于某个特殊原点，使得作用于 $\\mathbf{r}_0$ 时所有 $\\mathbf{t}$ 都等价于 $\\mathbf{0}$ (模 $\\mathbb{Z}^3$) 的情况下才有效，而这通常不成立。在非整模群中，甚至在具有非原点选择的整模群中，分数 $\\mathbf{t}$ 会以非平凡的方式移动位置，这对于得到正确的轨道至关重要。因此，该算法通常会遗漏由螺旋和滑移分量或由定心平移生成的等效位置。\n\n结论：错误。\n\n选项D：该选项试图通过测试严格相等性 $\\mathbf{R}\\mathbf{r}_0+\\mathbf{t}=\\mathbf{r}_0$（而不是正确的模 $\\mathbb{Z}^3$ 条件）来计算位置对称性，这通常会低估稳定子群的阶数，因为稳定子群元素可能满足 $\\mathbf{R}\\mathbf{r}_0+\\mathbf{t}=\\mathbf{r}_0+\\mathbf{n}$ 且 $\\mathbf{n}\\in \\mathbb{Z}^3\\setminus\\{\\mathbf{0}\\}$。然后它使用点群阶数和这个有缺陷的位置对称阶数来估计重复数，并最终仅通过应用旋转来枚举位置，在生成坐标时忽略了非整模分数平移和定心。即使在某些情况下重复数估计恰好在数值上是正确的，其枚举过程通常也会产生一组错误的坐标。它还依赖于截断，并且不能确保模 $T_{\\mathrm{conv}}$ 的闭包。\n\n结论：错误。\n\n因此，选项A是唯一与空间群作用、模 $T_{\\mathrm{conv}}$ 的陪集以及 Wyckoff 位置和重复数的轨道-稳定子框架相符的正确且完整的算法。", "answer": "$$\\boxed{A}$$", "id": "2536907"}]}