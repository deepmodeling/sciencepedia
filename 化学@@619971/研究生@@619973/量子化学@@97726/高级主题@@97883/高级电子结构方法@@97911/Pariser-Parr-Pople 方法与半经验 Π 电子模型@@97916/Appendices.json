{"hands_on_practices": [{"introduction": "为了真正掌握Pariser-Parr-Pople方法，我们从最简单的π电子体系——乙烯——开始。这项基础练习将指导您手动计算其基态能量和键级，并明确地将电子排斥纳入考量。通过将PPP计算结果与休克尔模型进行对比，您将具体理解PPP方法如何提供一个更符合物理真实的描述 [@problem_id:2913410]。", "problem": "考虑乙烯，其 $\\pi$ 体系在单-$p_{z}$ 最小基组下建模，包含两个位点，标记为 $1$ 和 $2$，碳-碳距离为 $R_{\\mathrm{CC}}=1.34\\,\\text{\\AA}$。使用 Pariser–Parr–Pople (PPP) $\\pi$ 电子哈密顿量，在忽略微分重叠 (NDO) 近似和对 $N=2$ 个 $\\pi$ 电子进行自旋限制闭壳层处理（限制性 Hartree–Fock (RHF)）的条件下进行计算。单电子参数为库仑积分 $\\alpha=0\\,\\text{eV}$ 和最近邻之间的共振积分 $\\beta=-2.50\\,\\text{eV}$。在位电子-电子排斥为 $U=\\gamma_{11}=\\gamma_{22}=11.00\\,\\text{eV}$，位点间库仑相互作用 $\\gamma_{12}=\\gamma_{21}$ 由 Ohno 插值法在一致单位下给出：\n$$\n\\gamma_{12} \\;=\\; \\frac{14.397\\,\\text{eV}\\cdot\\text{\\AA}}{\\sqrt{R_{\\mathrm{CC}}^{2}+\\delta^{2}}}\n\\quad\\text{其中}\\quad\n\\delta \\;=\\; \\frac{14.397\\,\\text{eV}\\cdot\\text{\\AA}}{U}.\n$$\n假设每个碳原子为 $\\pi$ 体系贡献的价电子数为 $z_{i}=1$。\n\n从写为如下形式的 PPP 哈密顿量开始：\n$$\n\\hat{H} \\;=\\; \\sum_{i,j,\\sigma} h_{ij}\\, \\hat{c}_{i\\sigma}^{\\dagger}\\hat{c}_{j\\sigma}\n\\;+\\; \\frac{1}{2}\\sum_{i,j} \\gamma_{ij}\\,\\big(\\hat{n}_{i}-z_{i}\\big)\\big(\\hat{n}_{j}-z_{j}\\big),\n$$\n其中 $h_{ii}=\\alpha$ 且 $h_{12}=h_{21}=\\beta$，$\\hat{n}_{i}=\\sum_{\\sigma}\\hat{c}_{i\\sigma}^{\\dagger}\\hat{c}_{i\\sigma}$，$\\sigma$ 遍历所有自旋态。使用适用于 RHF 处理的自洽场方法，确定自洽位点布居数 $n_{i}$ 和两个碳原子之间的键级，\n$$\nP_{12} \\;=\\; 2\\sum_{\\text{occ.}} c_{1}\\,c_{2},\n$$\n其中求和遍历 RHF 基态中的双占据分子轨道，$c_{i}$ 是在位点基下相应的分子轨道系数。\n\n然后，计算：\n- 乙烯的 PPP 基态 $\\pi$ 电子能量。\n- 忽略电子-电子相互作用但使用相同的 $\\alpha$ 和 $\\beta$ 值，得到的 Hückel 分子轨道 (HMO) 对相同物理量的预测值。\n- 基于 PPP 哈密顿量的结构，进行简要且有原则的比较，解释该分子中 PPP 和 Hückel 方法结果的任何相同或不同之处。\n\n作为最终报告值，请提供 PPP C–C 键级 $P_{12}$，形式为一个纯数（无量纲）。将您的答案四舍五入到四位有效数字。", "solution": "所给问题是量子化学中的一个标准练习，具体涉及将 Pariser-Parr-Pople (PPP) 半经验方法应用于乙烯的 $\\pi$ 电子体系。该问题具有科学依据，提法明确，并且提供了所有必要的参数。因此，该问题是有效的，可以推导出解决方案。\n\n该体系是乙烯 ($C_2H_4$)，被建模为一个双位点（$\\phi_1$, $\\phi_2$）体系，包含 $N=2$ 个 $\\pi$ 电子。基组由每个碳原子上的一个 $p_z$ 原子轨道组成。我们将在自旋限制 Hartree-Fock (RHF) 框架内解决这个问题。\n\n首先，我们计算必要的参数。在位排斥能已给出，$U=\\gamma_{11}=\\gamma_{22}=11.00\\,\\text{eV}$。位点间库仑相互作用 $\\gamma_{12}$ 使用 Ohno 插值公式计算。碳-碳距离为 $R_{\\mathrm{CC}}=1.34\\,\\text{\\AA}$。参数 $\\delta$ 为：\n$$\n\\delta = \\frac{14.397\\,\\text{eV}\\cdot\\text{\\AA}}{U} = \\frac{14.397\\,\\text{eV}\\cdot\\text{\\AA}}{11.00\\,\\text{eV}} \\approx 1.3088\\,\\text{\\AA}\n$$\n现在，我们计算 $\\gamma_{12}$：\n$$\n\\gamma_{12} = \\frac{14.397\\,\\text{eV}\\cdot\\text{\\AA}}{\\sqrt{R_{\\mathrm{CC}}^{2}+\\delta^{2}}} = \\frac{14.397\\,\\text{eV}\\cdot\\text{\\AA}}{\\sqrt{(1.34\\,\\text{\\AA})^{2}+(1.3088\\,\\text{\\AA})^{2}}} = \\frac{14.397\\,\\text{eV}\\cdot\\text{\\AA}}{\\sqrt{1.7956+1.7130}\\,\\text{\\AA}} = \\frac{14.397\\,\\text{eV}\\cdot\\text{\\AA}}{1.8731\\,\\text{\\AA}} \\approx 7.686\\,\\text{eV}\n$$\n\n在 PPP-RHF 方法中，我们在一个迭代自洽场 (SCF) 过程中求解 Roothaan-Hall 方程 $FC=SC\\epsilon$。对于一个正交归一的原子轨道基组，$S=I$。Fock 矩阵元 $F_{ij}$ 由以下公式给出：\n$$\nF_{ii} = H_{ii}^{\\text{core}} + \\frac{1}{2} P_{ii} \\gamma_{ii} + \\sum_{k \\neq i} P_{kk} \\gamma_{ik}\n$$\n$$\nF_{ij} = H_{ij}^{\\text{core}} - \\frac{1}{2} P_{ij} \\gamma_{ij} \\quad (i \\neq j)\n$$\n其中 $P_{ij}$ 是密度矩阵的矩阵元，$P_{ij} = 2\\sum_{k}^{\\text{occ}} c_{ki}^{*}c_{kj}$。核心哈密顿量矩阵元 $H_{ij}^{\\text{core}}$ 为：\n$$\nH_{ii}^{\\text{core}} = \\alpha - \\sum_{k \\neq i} z_k \\gamma_{ik}\n$$\n$$\nH_{ij}^{\\text{core}} = \\beta_{ij} \\quad (i \\neq j)\n$$\n给定的参数是库仑积分 $\\alpha=0\\,\\text{eV}$、共振积分 $\\beta=-2.50\\,\\text{eV}$（对最近邻）以及核心电荷 $z_1=z_2=1$。\n\n对于乙烯，核心哈密顿量矩阵为：\n$$\nH^{\\text{core}} = \\begin{pmatrix} \\alpha - z_2\\gamma_{12} & \\beta \\\\ \\beta & \\alpha - z_1\\gamma_{12} \\end{pmatrix} = \\begin{pmatrix} -\\gamma_{12} & \\beta \\\\ \\beta & -\\gamma_{12} \\end{pmatrix}\n$$\n由于乙烯分子的对称性，两个碳位点是等价的。因此，每个位点上的电子布居数必须相等：$n_1 = n_2$。因为总共有 $N=2$ 个电子，所以 $n_1+n_2=2$，这意味着 $n_1=n_2=1$。密度矩阵的对角元为 $P_{ii}=n_i$，所以 $P_{11}=P_{22}=1$。这种均匀的电荷分布是中性交替烃的一个众所周知的结果，它简化了计算，从而无需进行迭代过程。\n\n当 $P_{11}=P_{22}=1$ 时，Fock 矩阵的对角元变为：\n$$\nF_{11} = H_{11}^{\\text{core}} + \\frac{1}{2}P_{11}\\gamma_{11} + P_{22}\\gamma_{12} = (-\\gamma_{12}) + \\frac{1}{2}(1)\\gamma_{11} + (1)\\gamma_{12} = \\frac{1}{2}\\gamma_{11}\n$$\n$$\nF_{22} = H_{22}^{\\text{core}} + \\frac{1}{2}P_{22}\\gamma_{22} + P_{11}\\gamma_{12} = (-\\gamma_{12}) + \\frac{1}{2}(1)\\gamma_{22} + (1)\\gamma_{12} = \\frac{1}{2}\\gamma_{22}\n$$\n因为 $\\gamma_{11}=\\gamma_{22}$，所以我们有 $F_{11}=F_{22}$。非对角元 $F_{12}$ 是：\n$$\nF_{12} = H_{12}^{\\text{core}} - \\frac{1}{2}P_{12}\\gamma_{12} = \\beta - \\frac{1}{2}P_{12}\\gamma_{12}\n$$\nFock 矩阵是对称的，且对角元相等：$F = \\begin{pmatrix} A & B \\\\ B & A \\end{pmatrix}$。无论 $B$ 的具体值是多少，这种矩阵的本征矢量总是 $\\psi_1 = \\frac{1}{\\sqrt{2}}(\\phi_1 + \\phi_2)$（成键）和 $\\psi_2 = \\frac{1}{\\sqrt{2}}(\\phi_1 - \\phi_2)$（反键）。基态由两个电子占据成键分子轨道 $\\psi_1$ 构成。\n这个被占据的分子轨道 (MO) 的系数为 $c_1=c_2=1/\\sqrt{2}$。\n\n然后计算自洽键级 $P_{12}$：\n$$\nP_{12} = 2 \\sum_{\\text{occ.}} c_{1}\\,c_{2} = 2 \\left(\\frac{1}{\\sqrt{2}}\\right)\\left(\\frac{1}{\\sqrt{2}}\\right) = 1\n$$\n这证实了解的自洽性：从 $n_1=n_2=1$ 开始，可以得到分子轨道系数，从而产生 $P_{12}=1$ 和 $n_1=P_{11}=2c_1^2=1$，$n_2=P_{22}=2c_2^2=1$。自洽位点布居数为 $n_1=1$，$n_2=1$，C-C 键级为 $P_{12}=1$。\n\n接下来，我们计算基态能量。\n\n**PPP 基态能量：**\nPPP 模型中的总 $\\pi$ 电子能量是电子能量和核-核排斥能的总和，$E_{PPP} = E_{\\pi} + E_{\\text{core-core}}$。总能量的一个便捷表达式是：\n$$\nE_{PPP} = \\sum_{i} n_{i} \\left(\\alpha + \\frac{1}{4}n_{i}\\gamma_{ii}\\right) + 2\\sum_{i<j} P_{ij}\\beta_{ij} + \\sum_{i<j} \\left((n_i-z_i)(n_j-z_j) - \\frac{1}{2}P_{ij}^2\\right)\\gamma_{ij}\n$$\n使用我们的自洽结果（$n_1=n_2=1$, $P_{12}=1$, $z_1=z_2=1$）：\n$$\nE_{PPP} = n_1(\\alpha+\\frac{1}{4}n_1\\gamma_{11}) + n_2(\\alpha+\\frac{1}{4}n_2\\gamma_{22}) + 2P_{12}\\beta + \\left((n_1-z_1)(n_2-z_2) - \\frac{1}{2}P_{12}^2\\right)\\gamma_{12}\n$$\n$$\nE_{PPP} = 1(0+\\frac{1}{4}(1)(11.00)) + 1(0+\\frac{1}{4}(1)(11.00)) + 2(1)(-2.50) + \\left((1-1)(1-1) - \\frac{1}{2}(1)^2\\right)(7.686)\n$$\n$$\nE_{PPP} = 2\\left(\\frac{11.00}{4}\\right) - 5.00 + \\left(0 - \\frac{1}{2}\\right)(7.686) = 5.50 - 5.00 - 3.843 = -3.343\\,\\text{eV}\n$$\n解析上，表达式为 $E_{PPP} = 2\\alpha + 2\\beta + \\frac{1}{2}\\gamma_{11} - \\frac{1}{2}\\gamma_{12}$。\n\n**Hückel 分子轨道 (HMO) 预测：**\nHMO 方法忽略所有电子-电子相互作用。哈密顿量矩阵仅为：\n$$\nH^{HMO} = \\begin{pmatrix} \\alpha & \\beta \\\\ \\beta & \\alpha \\end{pmatrix}\n$$\n本征值为 $\\epsilon_{\\pm} = \\alpha \\pm \\beta$。基态有两个电子在成键轨道中，能量为 $\\epsilon_{+} = \\alpha + \\beta$。总的 HMO 能量是：\n$$\nE_{HMO} = 2(\\alpha + \\beta) = 2(0 - 2.50\\,\\text{eV}) = -5.00\\,\\text{eV}\n$$\n对于该分子，分子轨道系数与 PPP 情况下的相同，即 $c_1=c_2=1/\\sqrt{2}$。因此，键级和布居数是相同的：$P_{12}=1$ 且 $n_1=n_2=1$。\n\n**比较：**\n- **布居数和键级：** PPP 和 HMO 方法都预测出相同的位点布居数（$n_i=1$）和键级（$P_{12}=1$）。这是因为乙烯的高对称性（$D_{2h}$）将分子轨道系数限制为 $(1/\\sqrt{2}, \\pm 1/\\sqrt{2})$。对于中性交替烃，均匀的电荷分布（$n_i=z_i=1$）在 HMO 理论中是一个严格的结果，并且在自洽的 PPP 计算中得到保持。\n- **$\\pi$ 电子能量：** 能量显著不同：$E_{PPP} = -3.343\\,\\text{eV}$ 和 $E_{HMO} = -5.00\\,\\text{eV}$。差异为 $E_{PPP} - E_{HMO} = (2\\alpha+2\\beta + \\frac{1}{2}\\gamma_{11} - \\frac{1}{2}\\gamma_{12}) - (2\\alpha+2\\beta) = \\frac{1}{2}(\\gamma_{11} - \\gamma_{12})$。数值上，这是 $\\frac{1}{2}(11.00 - 7.686) = 1.657\\,\\text{eV}$。PPP 能量更高（更不稳定），因为它显式地包含了两个 $\\pi$ 电子之间的排斥能。HMO 方法完全忽略了这种排斥，导致能量被人为地低估。项 $\\frac{1}{2}(\\gamma_{11} - \\gamma_{12})$ 代表了在离域成键轨道中两个电子在其运动上的平均净排斥。\n\n问题要求以 PPP C-C 键级 $P_{12}$ 作为最终答案。该值被确定为恰好是 $1$。保留四位有效数字，即为 $1.000$。", "answer": "$$\n\\boxed{1.000}\n$$", "id": "2913410"}, {"introduction": "现在我们进阶到苯，这是一个芳香性和分子对称性的经典范例。本实践的重点是从对称性匹配的分子轨道直接推导出π键级，这是将量子理论与化学结构联系起来的关键一步。通过这个计算，您将看到对称性如何决定波函数的形态，并揭示为何对于交替烃中的特定性质，PPP方法的结果与更简单的休克尔理论出人意料地一致 [@problem_id:2913455]。", "problem": "考虑苯为一个平面正六边形，其离域的$\\pi$电子使用零微分重叠 (ZDO) 近似下的 Pariser–Parr–Pople (PPP) 方法进行描述。假设一个限制性 Hartree–Fock (RHF) 闭壳层基态，一个仅包含每个碳原子上的一个 $p_{z}$ 轨道的$\\pi$基组，统一的在位库仑参数 $\\alpha$，统一的最近邻共振参数 $\\beta$，以及统一的电子-电子排斥积分，使得在 $\\{p_{z}\\}$ 基组中的单电子 Fock 矩阵是一个具有相同最近邻耦合的循环矩阵。根据对称性和平移不变性，占据的正则分子轨道 (MO) 是二面体 $D_{6h}$ 群的离域对称性匹配线性组合 (SALC)，对于三个成键分子轨道，可以选择环上标记为 $j=0,1,2,3,4,5$ 的原子位点上的以下实数正交归一集：\n- 全对称的 $a_{1g}$ 轨道：\n$$\nc_{j}^{(a_{1g})}=\\frac{1}{\\sqrt{6}} \\quad \\text{对于所有 } j 。\n$$\n- 在实数余弦-正弦基中表示的二重简并的 $e_{1g}$ 对：\n$$\nc_{j}^{(e_{1g,c})}=\\sqrt{\\frac{2}{6}}\\cos\\!\\left(\\frac{2\\pi j}{6}\\right), \\qquad\nc_{j}^{(e_{1g,s})}=\\sqrt{\\frac{2}{6}}\\sin\\!\\left(\\frac{2\\pi j}{6}\\right).\n$$\n苯有 $6$ 个$\\pi$电子，它们双重占据了这三个成键分子轨道。\n\n从 ZDO $\\pi$电子模型中 RHF Slater 行列式的单电子密度矩阵的定义，以及正则分子轨道的原子轨道线性组合 (LCAO) 表示出发，推导最近邻$\\pi$键级 $p_{12}$ 关于占据的分子轨道系数的表达式。然后，使用上述的 SALC 计算位点 $j=0$ 和 $j=1$ 之间的最近邻$\\pi$键级 $p_{12}$。将您的最终答案表示为一个精确分数。您可以评论您的结果与 Hückel 分子轨道理论值 $2/3$ 的比较，但您提交的数值答案必须仅为键级值本身，以无单位的精确分数形式。", "solution": "问题陈述有效。这是一个在量子化学中提法得当的问题，具有科学依据且内部一致。我们将继续进行求解。\n\n核心任务是在限制性 Hartree-Fock (RHF) 框架内计算苯中的最近邻$\\pi$键级。原子中心 $\\mu$ 和 $\\nu$ 之间的$\\pi$键级 $p_{\\mu\\nu}$ 是单电子密度矩阵的一个元素 $P_{\\mu\\nu}$。对于一个由单个 Slater 行列式描述的闭壳层体系，其中每个空间分子轨道 (MO) $\\psi_i$（共 $N_{\\text{occ}}$ 个）都被双重占据，其在原子轨道 (AO) 基组 $\\{\\phi_\\mu\\}$ 中的密度矩阵元素定义为：\n$$\nP_{\\mu\\nu} = 2 \\sum_{i=1}^{N_{\\text{occ}}} C_{\\mu i} C_{\\nu i}\n$$\n在此定义中，$C_{\\mu i}$ 是第 $i$ 个分子轨道 $\\psi_i$ 中原子轨道 $\\phi_\\mu$ 的系数，即 $\\psi_i = \\sum_\\mu C_{\\mu i} \\phi_\\mu$。假设分子轨道是实数的，这对于给定的实数 SALC 基组是合适的。求和遍历所有占据的分子轨道。对于 $\\mu \\neq \\nu$，键级 $p_{\\mu\\nu}$ 与 $P_{\\mu\\nu}$ 相同。\n\n该体系是苯，有 $6$ 个$\\pi$电子。这些电子双重占据了能量最低的 $3$ 个成键分子轨道。问题将这些占据的分子轨道作为 $p_z$ 原子轨道的对称性匹配线性组合 (SALC) 给出，我们将其标记为碳原子 $j$ 的 $\\phi_j$，其中 $j=0, 1, ..., 5$。占据的分子轨道数量为 $N_{\\text{occ}} = 3$。问题要求计算位点 $j=0$ 和 $j=1$ 之间的最近邻键级，我们记为 $p_{01}$。使用通用公式，可得：\n$$\np_{01} = P_{01} = 2 \\sum_{i=1}^{3} C_{0i} C_{1i}\n$$\n三个占据的分子轨道分别为 $a_{1g}$ 轨道和简并的 $e_{1g}$ 轨道对。我们将其表示为 $\\psi_1 = \\psi_{a_{1g}}$，$\\psi_2 = \\psi_{e_{1g,c}}$ 和 $\\psi_3 = \\psi_{e_{1g,s}}$。问题陈述中给出了系数 $C_{ji}$。\n\n每个占据的分子轨道的系数如下：\n1. 对于 $a_{1g}$ 轨道 ($\\psi_1$)：\n$$\nC_{j1} = c_{j}^{(a_{1g})} = \\frac{1}{\\sqrt{6}} \\quad \\text{对于所有 } j。\n$$\n2. 对于 $e_{1g,c}$ 轨道 ($\\psi_2$)：\n$$\nC_{j2} = c_{j}^{(e_{1g,c})} = \\sqrt{\\frac{2}{6}} \\cos\\left(\\frac{2\\pi j}{6}\\right) = \\frac{1}{\\sqrt{3}} \\cos\\left(\\frac{\\pi j}{3}\\right).\n$$\n3. 对于 $e_{1g,s}$ 轨道 ($\\psi_3$)：\n$$\nC_{j3} = c_{j}^{(e_{1g,s})} = \\sqrt{\\frac{2}{6}} \\sin\\left(\\frac{2\\pi j}{6}\\right) = \\frac{1}{\\sqrt{3}} \\sin\\left(\\frac{\\pi j}{3}\\right).\n$$\n\n我们需要计算位点 $j=0$ 和 $j=1$ 的这些系数。\n\n对于位点 $j=0$：\n- $C_{01} = \\frac{1}{\\sqrt{6}}$\n- $C_{02} = \\frac{1}{\\sqrt{3}} \\cos(0) = \\frac{1}{\\sqrt{3}}$\n- $C_{03} = \\frac{1}{\\sqrt{3}} \\sin(0) = 0$\n\n对于位点 $j=1$：\n- $C_{11} = \\frac{1}{\\sqrt{6}}$\n- $C_{12} = \\frac{1}{\\sqrt{3}} \\cos\\left(\\frac{\\pi}{3}\\right) = \\frac{1}{\\sqrt{3}} \\cdot \\frac{1}{2} = \\frac{1}{2\\sqrt{3}}$\n- $C_{13} = \\frac{1}{\\sqrt{3}} \\sin\\left(\\frac{\\pi}{3}\\right) = \\frac{1}{\\sqrt{3}} \\cdot \\frac{\\sqrt{3}}{2} = \\frac{1}{2}$\n\n现在我们将这些值代入键级 $p_{01}$ 的表达式中：\n$$\np_{01} = 2 \\left( C_{01}C_{11} + C_{02}C_{12} + C_{03}C_{13} \\right)\n$$\n$$\np_{01} = 2 \\left[ \\left(\\frac{1}{\\sqrt{6}}\\right) \\left(\\frac{1}{\\sqrt{6}}\\right) + \\left(\\frac{1}{\\sqrt{3}}\\right) \\left(\\frac{1}{2\\sqrt{3}}\\right) + (0) \\left(\\frac{1}{2}\\right) \\right]\n$$\n我们计算和中的每一项：\n- 第一项（来自 $a_{1g}$ 的贡献）：$\\frac{1}{\\sqrt{6}} \\cdot \\frac{1}{\\sqrt{6}} = \\frac{1}{6}$\n- 第二项（来自 $e_{1g,c}$ 的贡献）：$\\frac{1}{\\sqrt{3}} \\cdot \\frac{1}{2\\sqrt{3}} = \\frac{1}{2 \\cdot 3} = \\frac{1}{6}$\n- 第三项（来自 $e_{1g,s}$ 的贡献）：$0 \\cdot \\frac{1}{2} = 0$\n\n将这些贡献相加：\n$$\n\\sum_{i=1}^{3} C_{0i} C_{1i} = \\frac{1}{6} + \\frac{1}{6} + 0 = \\frac{2}{6} = \\frac{1}{3}\n$$\n最后，我们将结果乘以因子 $2$，因为每个轨道都被双重占据：\n$$\np_{01} = 2 \\left( \\frac{1}{3} \\right) = \\frac{2}{3}\n$$\n这就是位点 $0$ 和 $1$ 之间的最近邻$\\pi$键级。由于苯分子的旋转对称性，这个值对于所有最近邻对都是相同的，因此 $p_{01} = p_{12} = \\dots = p_{50}$。\n\n值得一提的是，这个结果与 Hückel 分子轨道 (HMO) 理论得到的结果之间的关系。计算出的键级 $\\frac{2}{3}$ 与简单的 HMO 理论对苯得到的值相同。这并非巧合。尽管问题是在更复杂的 Pariser–Parr–Pople (PPP) 方法（该方法明确处理了电子-电子排斥）的背景下提出的，但关键的简化在于提供了最终的分子轨道系数。对于像苯这样的高对称性分子（$D_{6h}$ 点群），分子轨道的形式完全由对称性决定。所提供的 SALC 正是能够对角化任何具有给定对称性的哈密顿量（包括 Hückel 和自洽的 PPP-Fock 哈密顿量）的特征向量的实数值形式。由于键级的计算只依赖于占据的分子轨道系数，而这些系数又由对称性决定，因此结果与底层哈密顿模型（Hückel vs. PPP）的具体细节无关。与 HMO 理论相比，PPP 方法会得出不同的轨道能量和总能量，但基态的密度矩阵保持不变。", "answer": "$$\\boxed{\\frac{2}{3}}$$", "id": "2913455"}, {"introduction": "检验理解程度的最终方式是从头构建一个可工作的模型。这项综合性实践将挑战您为一个杂原子芳香环——吡啶——编写一个完整的自洽场（SCF）程序。通过编写PPP迭代过程的代码，您将亲眼见证该方法如何处理引入如氮这样的电负性更强的原子，并预测由此产生的非均匀π电荷分布——这是简单的休克尔理论无法企及的 [@problem_id:2913454]。", "problem": "构建一个完整、可运行的程序，为对应于苯和吡啶的中性、闭壳层、具有六个位点的平面环状体系，建立并求解一个 Pariser-Parr-Pople (PPP) 半经验模型。您必须从以下基本依据和定义出发。\n\n1) 对 PPP 模型，在零微分重叠 (Zero Differential Overlap, ZDO) 近似下使用限制性 Hartree-Fock (RHF) 方法。每个位点代表一个正交归一的原子 $p_z$ 轨道，在参考构型中每个位点有一个 $\\pi$ 电子。$\\pi$ 电子数等于位点数，并且该体系是闭壳层的，因此双占据分子轨道的数量为 $N_{\\mathrm{occ}} = N/2$，其中位点数 $N=6$。\n\n2) 单电子哈密顿矩阵元由 $h_{ij} = \\alpha_i \\delta_{ij} + \\beta_{ij}$ 给出，其中 $\\alpha_i$ 是位点（库仑）能，$\\beta_{ij}$ 是最近邻原子间的共振（跃迁）积分，其他情况为零，$\\delta_{ij}$ 是克罗内克 δ (Kronecker delta)。\n\n3) 使用 Ohno 公式，通过位点对角项和位点间项来近似双电子电子排斥积分。定义 $\\gamma_{ii} = U_i$，即位点 $i$ 上的在位库仑排斥。对于 $i \\neq j$，位点间相互作用为\n$$\n\\gamma_{ij} = \\frac{K}{\\sqrt{R_{ij}^2 + \\left(\\frac{K}{U_{ij}^{\\mathrm{eff}}}\\right)^2}},\n$$\n其中 $K = 14.397 \\ \\mathrm{eV \\cdot \\AA}$ 是静电转换因子，$R_{ij}$ 是以 $\\mathrm{\\AA}$ 为单位的位点间距离，而 $U_{ij}^{\\mathrm{eff}} = \\frac{U_i + U_j}{2}$ 是进入 Ohno 插值公式的有效在位参数。\n\n4) 在 PPP 的 ZDO 近似中，RHF Fock 矩阵 $F$ 为\n$$\nF_{ii} = h_{ii} + \\sum_{k} \\gamma_{ik} \\left(P_{kk} - z_k\\right),\n\\qquad\nF_{ij} = h_{ij} - \\frac{1}{2} \\gamma_{ij} P_{ij} \\quad (i \\neq j),\n$$\n其中 $P$ 是自旋求和的密度矩阵，$z_k$ 是参考构型中分配给位点 $k$ 的 $\\pi$ 电子数，此处所有位点的 $z_k=1$。对于闭壳层体系，密度矩阵为\n$$\nP_{ij} = 2 \\sum_{m=1}^{N_{\\mathrm{occ}}} C_{i m} C_{j m},\n$$\n其中 $C$ 的列是通过对角化 $F$ 得到的正交归一的分子轨道系数。\n\n5) 位点 $i$ 上的 $\\pi$ 原子电荷定义为与参考布居的偏差，\n$$\nq_i = z_i - n_i,\n\\quad \\text{其中} \\quad\nn_i = P_{ii},\n$$\n因此对于中性体系，有 $\\sum_i q_i = 0$。\n\n几何和连接性设置：\n- 将六个位点放置在 $xy$ 平面内一个边长为 $s = 1.40 \\ \\mathrm{\\AA}$ 的正六边形上。使用外接圆半径 $r = s$ 和坐标 $x_i = r \\cos \\theta_i$, $y_i = r \\sin \\theta_i$，其中对于 $i \\in \\{0,1,2,3,4,5\\}$，$\\theta_i = \\frac{2\\pi i}{6}$。位点间距离 $R_{ij}$ 是这些坐标之间的欧几里得距离。\n- 最近邻连接性是环的邻接关系：位点 $i$ 与位点 $(i-1) \\bmod 6$ 和 $(i+1) \\bmod 6$ 成键。所有其他的 $\\beta_{ij}$ 均为零。\n\n参数化：\n- 使用“标准碳参数”：$\\alpha_{\\mathrm{C}} = 0.00 \\ \\mathrm{eV}$，$U_{\\mathrm{C}} = 11.26 \\ \\mathrm{eV}$，以及 $\\beta_{\\mathrm{CC}} = -2.50 \\ \\mathrm{eV}$。\n- 对于吡啶中一个位点上的氮，案例2使用 $\\alpha_{\\mathrm{N}} = -2.00 \\ \\mathrm{eV}$、$U_{\\mathrm{N}} = 12.00 \\ \\mathrm{eV}$，案例3使用一个修改后的 $U_{\\mathrm{N}} = 14.00 \\ \\mathrm{eV}$。对于吡啶中的碳-氮键，使用每个案例指定的 $\\beta_{\\mathrm{CN}}$。\n\n自洽场 (Self-consistent field, SCF)：\n- 使用上面定义的 $F$ 矩阵执行一个 RHF 自洽过程，初始猜测为 $P^{(0)} = \\mathrm{diag}(1,1,1,1,1,1)$，并使用简单的线性混合 $P^{(n+1)} \\leftarrow \\lambda P_{\\mathrm{new}}^{(n+1)} + (1-\\lambda) P^{(n)}$，其中混合参数为常数 $0 < \\lambda < 1$。\n- 收敛判据：使用密度变化的均方根 (root-mean-square, RMS) 范数，\n$$\n\\Delta_{\\mathrm{RMS}} = \\sqrt{\\frac{1}{N^2} \\sum_{i,j} \\left(P^{(n+1)}_{ij} - P^{(n)}_{ij}\\right)^2},\n$$\n并在 $\\Delta_{\\mathrm{RMS}} < 10^{-10}$ 时停止。如果在 500 次迭代内未达到收敛，则停止并使用最后一次迭代的结果。\n\n角度单位是弧度。能量必须以电子伏特 (eV) 处理，距离必须以埃 ($\\mathrm{\\AA}$) 处理。输出的电荷是无量纲的。\n\n测试套件：\n在六位点环上运行以下三个案例。杂原子（如果存在）位于位点 0，所有其他位点均为碳。对于每个案例，按顺序报告 $\\pi$ 原子电荷 $q_i$（$i=0,1,2,3,4,5$）。\n\n- 案例1 (苯参考): 所有位点都是碳，因此对每一对最近邻原子使用 $\\alpha_{\\mathrm{C}}$、$U_{\\mathrm{C}}$ 和 $\\beta_{\\mathrm{CC}}$。\n- 案例2 (吡啶): 位点 0 是氮，其参数为 $\\alpha_{\\mathrm{N}} = -2.00 \\ \\mathrm{eV}$，$U_{\\mathrm{N}} = 12.00 \\ \\mathrm{eV}$；碳-氮最近邻键使用 $\\beta_{\\mathrm{CN}} = -2.20 \\ \\mathrm{eV}$；所有其他最近邻键使用 $\\beta_{\\mathrm{CC}}$；所有其余位点均为碳，使用标准碳参数。\n- 案例3 (边缘变体): 与案例2相同，但使用 $U_{\\mathrm{N}} = 14.00 \\ \\mathrm{eV}$ 和 $\\beta_{\\mathrm{CN}} = -1.80 \\ \\mathrm{eV}$。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个由逗号分隔的列表，该列表包含三个内部列表，每个内部列表按顺序 $[q_0,q_1,q_2,q_3,q_4,q_5]$ 包含一个案例的六个位点电荷。输出中任何地方都不能有空格。每个电荷必须四舍五入到小数点后六位。\n- 例如，输出格式必须类似于：[[q00,q01,q02,q03,q04,q05],[q10,q11,q12,q13,q14,q15],[q20,q21,q22,q23,q24,q25]]，其中 $qab$ 表示案例 $a$ 的第 $b$ 个位点。", "solution": "问题陈述要求构建一个自洽场程序，来求解苯和吡啶的 Pariser-Parr-Pople (PPP) 模型。该任务是在零微分重叠 (ZDO) 近似下直接应用限制性 Hartree-Fock (RHF) 方法。该问题定义明确、科学上合理，是计算量子化学中的一个标准练习。解决方案通过算法化地实现指定的自洽场 (SCF) 过程来进行。\n\n首先，我们建立分子框架。该体系由 $N=6$ 个原子位点组成，它们排列在 $xy$ 平面内一个边长为 $s=1.40 \\ \\mathrm{\\AA}$ 的正六边形上。位点 $i \\in \\{0, 1, \\dots, 5\\}$ 的位置由笛卡尔坐标 $(x_i, y_i)$ 给出，其中 $x_i = r \\cos \\theta_i$，$y_i = r \\sin \\theta_i$，外接圆半径为 $r=s$，角度为 $\\theta_i = \\frac{2\\pi i}{N}$。元素为 $R_{ij} = \\sqrt{(x_i - x_j)^2 + (y_i - y_j)^2}$ 的欧几里得距离矩阵 $R$ 是根据这些坐标计算得出的。\n\n电子哈密顿量是在每个位点一个 $p_z$ 原子轨道的基组中构建的。哈密顿量的单电子部分，即核心哈密顿量 $h$，其矩阵元为 $h_{ij} = \\alpha_i \\delta_{ij} + \\beta_{ij}$。对角元素 $\\alpha_i$ 是位点能量，它取决于原子类型（碳或氮）。非对角元素 $\\beta_{ij}$ 是共振积分，仅对最近邻位点非零。\n\n在 ZDO 近似下，双电子排斥积分 (ERI) 得以简化。只保留库仑型积分 $\\gamma_{ij} \\equiv (ii|jj)$。在位积分是 $\\gamma_{ii} = U_i$。对于 $i \\neq j$ 的位点间积分使用 Ohno 插值公式计算：\n$$\n\\gamma_{ij} = \\frac{K}{\\sqrt{R_{ij}^2 + \\left(\\frac{K}{U_{ij}^{\\mathrm{eff}}}\\right)^2}}\n$$\n其中 $K = 14.397 \\ \\mathrm{eV \\cdot \\AA}$ 是一个转换因子，$U_{ij}^{\\mathrm{eff}} = (U_i + U_j)/2$ 是有效在位排斥。这些积分只计算一次并存储在矩阵 $\\gamma$ 中，因为它们与电子密度无关。\n\n计算的核心是求解闭壳层体系的 Roothaan-Hall 方程 $FC = EC$ 的 SCF 过程。Fock 矩阵 $F$ 依赖于密度矩阵 $P$。该过程是迭代的：\n1. 对密度矩阵做一个初始猜测。问题指定了 $P^{(0)} = \\mathrm{diag}(1, 1, 1, 1, 1, 1)$，这对应于每个位点上局域一个 $\\pi$ 电子，从而初始时原子呈电中性。\n2. 在每次迭代 $n$ 中，使用当前的密度矩阵 $P^{(n-1)}$ 构建 Fock 矩阵 $F^{(n)}$：\n$$\nF_{ii} = h_{ii} + \\sum_{k=0}^{N-1} \\gamma_{ik} (P_{kk}^{(n-1)} - z_k)\n$$\n$$\nF_{ij} = h_{ij} - \\frac{1}{2} \\gamma_{ij} P_{ij}^{(n-1)} \\quad (i \\neq j)\n$$\n此处，$z_k=1$ 是位点 $k$ 的核心电荷。\n3. 通过对角化 $F^{(n)}$ 来求解久期方程 $F^{(n)} C^{(n)} = E^{(n)} C^{(n)}$。这会得到分子轨道 (MO) 能量 $E_m$（本征值）和 MO 系数向量 $C_m$（本征向量）。\n4. 从能量最低的 $N_{\\mathrm{occ}} = N/2 = 3$ 个（被占据的）MO 的系数构建一个新的密度矩阵 $P_{\\mathrm{new}, ij}^{(n)}$：\n$$\nP_{\\mathrm{new}, ij}^{(n)} = 2 \\sum_{m=0}^{N_{\\mathrm{occ}}-1} C_{im}^{(n)} C_{jm}^{(n)}\n$$\n5. 为了帮助收敛，下一次迭代的密度矩阵通过新旧矩阵的线性混合形成：$P^{(n)} = \\lambda P_{\\mathrm{new}}^{(n)} + (1-\\lambda) P^{(n-1)}$。指定混合参数 $\\lambda$ 的范围在 $(0,1)$ 内；为了稳定收敛，使用 $\\lambda=0.5$ 的标准选择。\n6. 重复此过程，直到连续迭代之间的密度矩阵变化低于一个阈值，$\\Delta_{\\mathrm{RMS}} = \\sqrt{\\frac{1}{N^2} \\sum_{i,j} (P^{(n)}_{ij} - P^{(n-1)}_{ij})^2} < 10^{-10}$。\n\n一旦 SCF 过程收敛，最终的密度矩阵 $P$ 就被用来计算 $\\pi$ 原子电荷。位点 $i$ 上的电子布居是 $n_i = P_{ii}$。净电荷是核心电荷与此布居之间的差值：$q_i = z_i - n_i = 1 - P_{ii}$。\n\n通过定义适当的参数集来实现三个指定的测试案例：\n- **案例1 (苯):** 所有 $6$ 个位点都是碳原子。对于所有 $i$，$\\alpha_i = \\alpha_{\\mathrm{C}} = 0.00 \\ \\mathrm{eV}$ 且 $U_i = U_{\\mathrm{C}} = 11.26 \\ \\mathrm{eV}$。所有最近邻共振积分均为 $\\beta = \\beta_{\\mathrm{CC}} = -2.50 \\ \\mathrm{eV}$。\n- **案例2 (吡啶):** 位点 $i=0$ 是一个氮原子，位点 $i \\in \\{1, \\dots, 5\\}$ 是碳原子。参数为：$\\alpha_0 = \\alpha_{\\mathrm{N}} = -2.00 \\ \\mathrm{eV}$ 且 $U_0 = U_{\\mathrm{N}} = 12.00 \\ \\mathrm{eV}$。碳位点使用 $\\alpha_{\\mathrm{C}}$ 和 $U_{\\mathrm{C}}$。C-N 键，即 $(0,1)$ 和 $(0,5)$，其 $\\beta = \\beta_{\\mathrm{CN}} = -2.20 \\ \\mathrm{eV}$，而其他 C-C 键使用 $\\beta_{\\mathrm{CC}}$。\n- **案例3 (吡啶变体):** 设置与案例2相同，但氮和 C-N 键的参数被修改为：$U_0 = U_{\\mathrm{N}} = 14.00 \\ \\mathrm{eV}$ 和 $\\beta_{\\mathrm{CN}} = -1.80 \\ \\mathrm{eV}$。\n\n该程序将这整个逻辑封装在一个函数中，并对每个案例调用该函数。然后将得到的电荷向量格式化为所需的单行输出字符串。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to set up and run the PPP calculations for the specified test cases.\n    \"\"\"\n\n    def solve_ppp_scf(params):\n        \"\"\"\n        Performs a Pariser-Parr-Pople SCF calculation for a given set of parameters.\n        \"\"\"\n        # Unpack parameters\n        num_sites = params['num_sites']\n        side_length = params['side_length']\n        alpha_vals = np.array(params['alpha'])\n        u_vals = np.array(params['u'])\n        beta_map = params['beta']\n        \n        # SCF hyperparameters from problem statement or reasonable defaults\n        lambda_mix = 0.5\n        max_iter = 500\n        conv_tol = 1e-10\n        \n        K = 14.397  # eV * Angstrom\n\n        # 1. Geometry: regular hexagon coordinates and distance matrix\n        coords = np.zeros((num_sites, 2))\n        for i in range(num_sites):\n            angle = 2 * np.pi * i / num_sites\n            coords[i, 0] = side_length * np.cos(angle)\n            coords[i, 1] = side_length * np.sin(angle)\n\n        dist_matrix = np.zeros((num_sites, num_sites))\n        for i in range(num_sites):\n            for j in range(i, num_sites):\n                dist = np.linalg.norm(coords[i] - coords[j])\n                dist_matrix[i, j] = dist_matrix[j, i] = dist\n\n        # 2. Setup core Hamiltonian (h) and two-electron repulsion integrals (gamma)\n        beta_matrix = np.zeros((num_sites, num_sites))\n        for (i, j), val in beta_map.items():\n            beta_matrix[i, j] = beta_matrix[j, i] = val\n        h_core = np.diag(alpha_vals) + beta_matrix\n\n        gamma_matrix = np.zeros((num_sites, num_sites))\n        for i in range(num_sites):\n            gamma_matrix[i, i] = u_vals[i]\n            for j in range(i + 1, num_sites):\n                u_eff = (u_vals[i] + u_vals[j]) / 2.0\n                val = K / np.sqrt(dist_matrix[i, j]**2 + (K / u_eff)**2)\n                gamma_matrix[i, j] = gamma_matrix[j, i] = val\n\n        # 3. SCF procedure\n        num_electrons = num_sites\n        num_occ = num_electrons // 2\n        core_charges = np.ones(num_sites)  # z_k = 1 for all sites\n\n        # Initial guess for density matrix P\n        p_matrix = np.diag(np.ones(num_sites))\n\n        for _ in range(max_iter):\n            p_old = p_matrix.copy()\n\n            # Build Fock matrix F\n            # The calculation is split to correctly handle diagonal and off-diagonal parts\n            fock_matrix = h_core.copy()\n            # Off-diagonal part\n            fock_matrix -= 0.5 * p_matrix * gamma_matrix\n            # Diagonal part\n            p_diag = np.diag(p_matrix)\n            fock_diag_update = gamma_matrix @ (p_diag - core_charges)\n            np.fill_diagonal(fock_matrix, h_core.diagonal() + fock_diag_update)\n            \n            # Solve the generalized eigenvalue problem FC = SCe (S is identity here)\n            _, eigvecs = np.linalg.eigh(fock_matrix)\n            c_occ = eigvecs[:, :num_occ]\n\n            # Calculate new density matrix\n            p_new = 2.0 * (c_occ @ c_occ.T)\n\n            # Apply linear mixing\n            p_matrix = lambda_mix * p_new + (1.0 - lambda_mix) * p_old\n\n            # Check for convergence\n            delta_rms = np.sqrt(np.sum((p_matrix - p_old)**2) / (num_sites**2))\n            if delta_rms < conv_tol:\n                break\n        \n        # 4. Post-SCF: calculate pi-charges\n        pi_population = np.diag(p_matrix)\n        pi_charges = core_charges - pi_population\n        return pi_charges.tolist()\n\n    # Define parameters for the three test cases\n    N = 6\n    S = 1.40\n    ALPHA_C = 0.0\n    U_C = 11.26\n    BETA_CC = -2.50\n    ALPHA_N = -2.00\n\n    # Case 1: Benzene\n    beta_benzene = {}\n    for i in range(N):\n        j = (i + 1) % N\n        key = tuple(sorted((i, j)))\n        beta_benzene[key] = BETA_CC\n    case1_params = {\n        'num_sites': N, 'side_length': S, 'alpha': [ALPHA_C] * N,\n        'u': [U_C] * N, 'beta': beta_benzene\n    }\n\n    # Case 2: Pyridine\n    U_N_2 = 12.00\n    BETA_CN_2 = -2.20\n    alpha_pyd_2 = [ALPHA_N] + [ALPHA_C] * (N - 1)\n    u_pyd_2 = [U_N_2] + [U_C] * (N - 1)\n    beta_pyd_2 = {}\n    for i in range(N):\n        j = (i + 1) % N\n        key = tuple(sorted((i, j)))\n        if 0 in key: # Site 0 is N\n            beta_pyd_2[key] = BETA_CN_2\n        else:\n            beta_pyd_2[key] = BETA_CC\n    case2_params = {\n        'num_sites': N, 'side_length': S, 'alpha': alpha_pyd_2,\n        'u': u_pyd_2, 'beta': beta_pyd_2\n    }\n\n    # Case 3: Pyridine variant\n    U_N_3 = 14.00\n    BETA_CN_3 = -1.80\n    u_pyd_3 = [U_N_3] + [U_C] * (N - 1)\n    beta_pyd_3 = {}\n    for i in range(N):\n        j = (i + 1) % N\n        key = tuple(sorted((i, j)))\n        if 0 in key: # Site 0 is N\n            beta_pyd_3[key] = BETA_CN_3\n        else:\n            beta_pyd_3[key] = BETA_CC\n    case3_params = {\n        'num_sites': N, 'side_length': S, 'alpha': alpha_pyd_2, # Same alpha as case 2\n        'u': u_pyd_3, 'beta': beta_pyd_3\n    }\n    \n    test_cases = [case1_params, case2_params, case3_params]\n    \n    all_results = [solve_ppp_scf(case) for case in test_cases]\n\n    # Format the final output string as specified\n    case_strings = []\n    for case_result in all_results:\n        charge_strings = [f\"{q:.6f}\" for q in case_result]\n        case_strings.append(f\"[{','.join(charge_strings)}]\")\n    \n    final_output = f\"[[{','.join(case_strings)}]]\"\n    print(final_output)\n\nsolve()\n```", "id": "2913454"}]}