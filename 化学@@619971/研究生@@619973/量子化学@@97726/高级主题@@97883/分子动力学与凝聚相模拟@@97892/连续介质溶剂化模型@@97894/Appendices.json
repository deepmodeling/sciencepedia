{"hands_on_practices": [{"introduction": "连续介质溶剂化模型的基石是 Born 模型，它为我们理解离子溶剂化提供了基本的静电图像。这项练习将带您回到经典电磁学的第一性原理，从麦克斯韦方程和静电能量密度的定义出发，推导至关重要的 Born 溶剂化能公式。通过这个推导，您将深刻理解溶剂极化功和静电溶剂化能之间的物理联系。[@problem_id:2882409]", "problem": "在可极化连续介质模型 (PCM) 和类导体屏蔽模型 (COSMO) 中使用的连续介质静电极限下，考虑一个单价离子，该离子被建模为大小为 $e$ 的点电荷，固定于半径为 $a$ 的球形真空腔的中心，此真空腔嵌入在绝对介电常数为 $\\epsilon$ 的无限大、线性、均匀、各向同性的介电溶剂中。真空介电常数为 $\\epsilon_{0}$。假设响应是纯静电、非色散的，并且极化介质所需的可逆功等于在腔外存在介电质的状态与各处皆为真空的参考状态之间的静电场能量变化，两种状态下的电荷均为 $e$，腔半径均为 $a$。\n\n仅从静电学的麦克斯韦方程（特别是高斯定律）和静电能量密度的定义出发，推导当电荷存在时极化溶剂所需的可逆功。用 $e$、$\\epsilon_{0}$、$\\epsilon$ 和 $a$ 将你的最终答案表示为一个闭合形式的解析表达式。能量以焦耳为单位表示。无需进行数值计算，也无需四舍五入。", "solution": "我们将溶质建模为位于半径为 $a$ 的球形腔中心的、大小为 $e$ 的点电荷。区域 $r<a$ 是真空，介电常数为 $\\epsilon_{0}$；区域 $r>a$ 是无限大的介电质，绝对介电常数为 $\\epsilon$。该系统具有球对称性。\n\n我们使用两个基本原理：\n- 静电学中积分形式的高斯定律，对于球对称场，通过用半径为 $r$ 的球形高斯面包裹电荷，可得出径向电场 $E(r)$。\n- 线性介电质中的静电能量密度 $u(r) = \\tfrac{1}{2}\\,\\epsilon\\,|E(r)|^{2}$，以及总场能量 $U = \\int u(r)\\,dV$。\n\n定义在相同电荷 $e$ 和腔半径 $a$ 下的两种构型：\n- 参考构型（各处皆为真空）：对于所有 $r>0$，介电常数为 $\\epsilon_{0}$。\n- 溶剂化构型（腔外为介电质）：对于 $0<r<a$，介电常数为 $\\epsilon_{0}$；对于 $r>a$，介电常数为 $\\epsilon$。\n\n根据高斯定律，对于以电荷为中心、半径为 $r$ 的球形高斯面，径向电场满足\n$$\n4\\pi r^{2}\\,\\epsilon_{\\text{eff}}(r)\\,E(r) = e,\n$$\n其中 $\\epsilon_{\\text{eff}}(r)$ 是半径 $r$ 处区域的介电常数。因此，\n- 在参考构型中（各处皆为真空），对于所有 $r>0$，\n$$\nE_{\\text{vac}}(r) = \\frac{e}{4\\pi\\,\\epsilon_{0}\\,r^{2}}.\n$$\n- 在溶剂化构型中，\n$$\nE_{\\text{in}}(r) = \\frac{e}{4\\pi\\,\\epsilon_{0}\\,r^{2}} \\quad \\text{for} \\quad 0<r<a, \\qquad\nE_{\\text{out}}(r) = \\frac{e}{4\\pi\\,\\epsilon\\,r^{2}} \\quad \\text{for} \\quad r>a.\n$$\n在没有自由表面电荷的情况下，这满足了 $\\mathbf{D}=\\epsilon \\mathbf{E}$ 的法向分量在 $r=a$ 的球形界面上是连续的。\n\n在固定电荷下极化溶剂所需的可逆功等于溶剂化构型与参考（真空）构型之间的静电场能量变化：\n$$\n\\Delta U \\equiv U_{\\text{solv}} - U_{\\text{vac}}.\n$$\n由于两种构型中腔内（$0<r<a$）的电场是相同的，且两者的介电常数均为 $\\epsilon_{0}$，所以能量差仅来自于区域 $r>a$。因此，\n$$\n\\Delta U = \\int_{r>a} \\left[ \\tfrac{1}{2}\\,\\epsilon\\,|E_{\\text{out}}(r)|^{2} - \\tfrac{1}{2}\\,\\epsilon_{0}\\,|E_{\\text{vac}}(r)|^{2} \\right] dV.\n$$\n代入电场并利用球对称性，$dV = 4\\pi r^{2}\\,dr$：\n$$\n\\Delta U = \\int_{a}^{\\infty} \\left[ \\tfrac{1}{2}\\,\\epsilon \\left( \\frac{e}{4\\pi\\,\\epsilon\\,r^{2}} \\right)^{2} - \\tfrac{1}{2}\\,\\epsilon_{0} \\left( \\frac{e}{4\\pi\\,\\epsilon_{0}\\,r^{2}} \\right)^{2} \\right] 4\\pi r^{2}\\,dr.\n$$\n简化每一项：\n$$\n\\tfrac{1}{2}\\,\\epsilon \\left( \\frac{e}{4\\pi\\,\\epsilon\\,r^{2}} \\right)^{2} = \\frac{1}{2}\\,\\frac{e^{2}}{16\\pi^{2}}\\,\\frac{1}{\\epsilon}\\,\\frac{1}{r^{4}}, \n\\qquad\n\\tfrac{1}{2}\\,\\epsilon_{0} \\left( \\frac{e}{4\\pi\\,\\epsilon_{0}\\,r^{2}} \\right)^{2} = \\frac{1}{2}\\,\\frac{e^{2}}{16\\pi^{2}}\\,\\frac{1}{\\epsilon_{0}}\\,\\frac{1}{r^{4}}.\n$$\n因此，\n$$\n\\Delta U \n= \\int_{a}^{\\infty} \\left[ \\frac{1}{2}\\,\\frac{e^{2}}{16\\pi^{2}}\\,\\frac{1}{r^{4}} \\left( \\frac{1}{\\epsilon} - \\frac{1}{\\epsilon_{0}} \\right) \\right] 4\\pi r^{2}\\,dr\n= \\frac{e^{2}}{32\\pi^{2}} \\left( \\frac{1}{\\epsilon} - \\frac{1}{\\epsilon_{0}} \\right) 4\\pi \\int_{a}^{\\infty} \\frac{dr}{r^{2}}.\n$$\n计算径向积分：\n$$\n\\int_{a}^{\\infty} \\frac{dr}{r^{2}} = \\left[ -\\frac{1}{r} \\right]_{a}^{\\infty} = \\frac{1}{a}.\n$$\n所以，\n$$\n\\Delta U \n= \\frac{e^{2}}{32\\pi^{2}} \\left( \\frac{1}{\\epsilon} - \\frac{1}{\\epsilon_{0}} \\right) 4\\pi \\cdot \\frac{1}{a}\n= \\frac{e^{2}}{8\\pi\\,a} \\left( \\frac{1}{\\epsilon} - \\frac{1}{\\epsilon_{0}} \\right).\n$$\n这就是在固定电荷 $e$ 下极化介电质所需的可逆功。由于通常 $\\epsilon > \\epsilon_{0}$，因子 $\\left( \\tfrac{1}{\\epsilon} - \\tfrac{1}{\\epsilon_{0}} \\right)$ 为负，且 $\\Delta U<0$，表明溶剂化过程是稳定的。用相对介电常数 $\\epsilon_{r}=\\epsilon/\\epsilon_{0}$ 表示，可以写成\n$$\n\\Delta U = -\\,\\frac{e^{2}}{8\\pi\\,\\epsilon_{0}\\,a}\\left( 1 - \\frac{1}{\\epsilon_{r}} \\right),\n$$\n这是我们熟悉的玻恩溶剂化能表达式。所要求的用 $e$、$\\epsilon_{0}$、$\\epsilon$ 和 $a$ 表示的最终表达式是\n$$\n\\Delta U = \\frac{e^{2}}{8\\pi\\,a} \\left( \\frac{1}{\\epsilon} - \\frac{1}{\\epsilon_{0}} \\right).\n$$\n在国际单位制中，该能量以焦耳表示。", "answer": "$$\\boxed{\\frac{e^{2}}{8\\pi\\,a}\\left(\\frac{1}{\\epsilon}-\\frac{1}{\\epsilon_{0}}\\right)}$$", "id": "2882409"}, {"introduction": "一个完备的溶剂化模型除了静电相互作用外，还必须考虑非静电效应，例如空穴形成能和色散-排斥能。这项实践指导您构建一个包含静电和非静电项的完整溶剂化自由能模型。您将分析总溶剂化自由能如何随着空穴半径的变化而缩放，这是一个在实际计算中至关重要且常被调节的参数。[@problem_id:2882347]", "problem": "在可极化连续介质模型 (PCM) 和类导体屏蔽模型 (COSMO) 中，溶剂化自由能被分解为一个静电贡献和非静电贡献。静电贡献源于溶质电荷分布与极化连续介质之间的相互作用，而非静电贡献则量化了空腔形成和色散-排斥作用。考虑一个理想化的溶质，表示为一个中心带有点电荷 $q$、未缩放半径为 $R$ 的单球体，该球体嵌入在相对介电常数 $\\varepsilon>1$ 的溶剂中。溶质空腔是通过将所有原子半径统一乘以一个缩放因子 $s>0$ 来构建的，因此球形空腔的半径变为 $R_{s}=sR$。\n\n假设采用标准的 PCM 边值问题公式，其中空腔内部的介电常数为 $1$，外部为 $\\varepsilon$。对于非静电贡献，采用广泛使用的线性分解，将其分为表面项和体积项，其系数分别为 $\\gamma$ (有效表面张力) 和 $p$ (有效类压强系数)。\n\n从经典静电学和基本几何学出发，且不引用任何目标公式，完成以下任务：\n1. 对于球形空腔，在统一缩放 $R\\to R_{s}=sR$ 的条件下，推导空腔表面积和体积如何变化。\n2. 求解一个点电荷 $q$ 位于半径为 $R_s$、内部介电常数为 $1$、外部介电常数为 $\\varepsilon$ 的球形空腔中心时的静电边值问题，以获得电荷所在位置的反应势。利用此结果推导溶剂化自由能的静电贡献作为 $s$ 的函数。\n3. 将这些结果与分解为表面项和体积项的非静电贡献相结合，以获得总溶剂化自由能作为 $s$ 的函数。\n\n完全在原子单位制下进行计算，并以 Hartree 为单位表示最终能量。提供一个关于总溶剂化自由能 $\\Delta G_{\\mathrm{solv}}(s)$ 的单一闭式解析表达式，该表达式用 $q$、$R$、$\\varepsilon$、$\\gamma$、$p$ 和 $s$ 表示。", "solution": "该问题是有效的，因为它在科学上基于经典静电学和计算化学的既有模型，问题提法恰当，并以客观、正式的方式呈现。唯一解所需的所有必要参数都已提供。我们将按要求进行推导。\n\n任务是推导总溶剂化自由能 $\\Delta G_{\\mathrm{solv}}(s)$。该体系为一个中心带有点电荷 $q$、未缩放半径为 $R$ 的球形溶质，放置于半径为 $R_s = sR$ 的空腔中，该空腔嵌入在相对介电常数为 $\\varepsilon$ 的介电连续体中。总自由能是静电贡献和非静电贡献之和。\n\n首先，我们推导缩放后球形空腔的几何性质。该空腔是一个半径为 $R_s = sR$ 的球体。\n半径为 $r$ 的球体的表面积由 $A = 4\\pi r^2$ 给出。对于我们的空腔，半径为 $R_s$，因此表面积 $A(s)$ 为：\n$$A(s) = 4\\pi R_s^2 = 4\\pi (sR)^2 = 4\\pi s^2 R^2$$\n半径为 $r$ 的球体的体积由 $V = \\frac{4}{3}\\pi r^3$ 给出。对于我们的空腔，体积 $V(s)$ 为：\n$$V(s) = \\frac{4}{3}\\pi R_s^3 = \\frac{4}{3}\\pi (sR)^3 = \\frac{4}{3}\\pi s^3 R^3$$\n这些表达式量化了空腔表面积和体积对缩放因子 $s$ 的依赖关系。\n\n其次，我们确定溶剂化自由能的静电贡献 $\\Delta G_{el}$。这需要求解静电边值问题。我们使用原子单位制，其中库仑常数 $1/(4\\pi\\varepsilon_0)$ 等于 $1$。静电势 $\\Phi$ 由泊松方程确定。\n\n我们将空间划分为两个区域：空腔内部 ($r < R_s$) 和空腔外部 ($r > R_s$)。\n在空腔内部（区域 I, $r < R_s$），介电常数为 $\\varepsilon_{in} = 1$。电势 $\\Phi_{in}$ 由原点处的点电荷 $q$ 和周围介质的极化共同产生。电荷本身的电势为 $q/r$。由极化介质产生的电势，即反应势 $\\Phi_{reac}$，在空腔内部满足拉普拉斯方程 $\\nabla^2 \\Phi_{reac} = 0$。由于问题的球对称性，$\\Phi_{reac}$ 也必须是球对称的。在原点 ($r=0$) 处正则的拉普拉斯方程通解是一个常数，我们将其记为 $C_1$。\n因此，内部总电势为：\n$$\\Phi_{in}(r) = \\frac{q}{r} + C_1$$\n在空腔外部（区域 II, $r > R_s$），介电常数为 $\\varepsilon_{out} = \\varepsilon$。该区域是无源的，因此电势 $\\Phi_{out}$ 满足拉普拉斯方程 $\\nabla^2 \\Phi_{out} = 0$。球对称且在 $r \\to \\infty$ 时趋于零的通解形式为 $C_2/r$。\n因此，外部电势为：\n$$\\Phi_{out}(r) = \\frac{C_2}{r}$$\n常数 $C_1$ 和 $C_2$ 由空腔表面 $r = R_s$ 处的边界条件确定。\n1.  静电势在边界上必须是连续的：\n    $$\\Phi_{in}(R_s) = \\Phi_{out}(R_s) \\implies \\frac{q}{R_s} + C_1 = \\frac{C_2}{R_s}$$\n2.  电位移场 $\\mathbf{D} = -\\varepsilon \\nabla \\Phi$ 的法向分量在边界上必须是连续的。对于球形边界，这意味着 $\\varepsilon_{in} \\frac{\\partial \\Phi_{in}}{\\partial r}\\Big|_{r=R_s} = \\varepsilon_{out} \\frac{\\partial \\Phi_{out}}{\\partial r}\\Big|_{r=R_s}$。\n    当 $\\varepsilon_{in}=1$ 且 $\\varepsilon_{out}=\\varepsilon$ 时：\n    $$\\frac{\\partial \\Phi_{in}}{\\partial r} = -\\frac{q}{r^2} \\quad \\text{and} \\quad \\frac{\\partial \\Phi_{out}}{\\partial r} = -\\frac{C_2}{r^2}$$\n    在 $r=R_s$ 处应用边界条件：\n    $$1 \\cdot \\left(-\\frac{q}{R_s^2}\\right) = \\varepsilon \\cdot \\left(-\\frac{C_2}{R_s^2}\\right) \\implies q = \\varepsilon C_2 \\implies C_2 = \\frac{q}{\\varepsilon}$$\n现在我们将 $C_2$ 代入第一个边界条件以求解 $C_1$：\n$$\\frac{q}{R_s} + C_1 = \\frac{1}{R_s} \\left(\\frac{q}{\\varepsilon}\\right) \\implies C_1 = \\frac{q}{R_s\\varepsilon} - \\frac{q}{R_s} = \\frac{q}{R_s} \\left(\\frac{1}{\\varepsilon} - 1\\right) = -\\frac{q}{R_s}\\left(1 - \\frac{1}{\\varepsilon}\\right)$$\n电荷所在位置 ($r=0$) 的反应势为 $\\Phi_{reac}(0) = C_1$。静电溶剂化自由能是在极化介质中产生电荷 $q$ 所做的功，即 $\\frac{1}{2}q\\Phi_{reac}(0)$。\n$$\\Delta G_{el} = \\frac{1}{2} q C_1 = \\frac{1}{2} q \\left[-\\frac{q}{R_s}\\left(1 - \\frac{1}{\\varepsilon}\\right)\\right] = -\\frac{q^2}{2R_s}\\left(1 - \\frac{1}{\\varepsilon}\\right)$$\n代入 $R_s=sR$，我们得到静电贡献作为 $s$ 的函数：\n$$\\Delta G_{el}(s) = -\\frac{q^2}{2sR}\\left(1 - \\frac{1}{\\varepsilon}\\right)$$\n\n第三，我们组合得到总溶剂化自由能。题目将非静电贡献定义为表面项和体积项之和：$\\Delta G_{non-el} = \\gamma A + pV$。使用我们先前推导的 $A(s)$ 和 $V(s)$ 的表达式：\n$$\\Delta G_{non-el}(s) = \\gamma (4\\pi s^2 R^2) + p \\left(\\frac{4}{3}\\pi s^3 R^3\\right)$$\n总溶剂化自由能 $\\Delta G_{\\mathrm{solv}}(s)$ 是静电贡献和非静电贡献之和：\n$$\\Delta G_{\\mathrm{solv}}(s) = \\Delta G_{el}(s) + \\Delta G_{non-el}(s)$$\n$$\\Delta G_{\\mathrm{solv}}(s) = -\\frac{q^2}{2sR}\\left(1 - \\frac{1}{\\varepsilon}\\right) + 4\\pi\\gamma s^2 R^2 + \\frac{4}{3}\\pi p s^3 R^3$$\n这就是总溶剂化自由能作为缩放因子 $s$ 以及给定参数 $q$、$R$、$\\varepsilon$、$\\gamma$ 和 $p$ 的函数的最终闭式表达式。", "answer": "$$\\boxed{-\\frac{q^2}{2sR}\\left(1 - \\frac{1}{\\varepsilon}\\right) + 4\\pi\\gamma s^2 R^2 + \\frac{4}{3}\\pi p s^3 R^3}$$", "id": "2882347"}, {"introduction": "任何计算模型的预测能力都取决于其参数的准确性。这最后一个动手实践将理论与应用联系起来，要求您编写一个程序来量化所计算的溶剂化自由能对原子半径选择的敏感性。通过完成这项任务，您将直接体验到在科研中应用和评估连续介质模型时的一个关键环节——参数敏感性分析。[@problem_id:2882419]", "problem": "在可极化连续介质模型 (PCM) 的框架内，为不同原子半径集对球形离子溶剂化自由能计算值的影响，构建一个有原则且可检验的灵敏度分析。从静电学和充电自由能的定义出发。不要先验地假设任何特定的连续介质溶剂化公式。相反，您需要推导出一个表达式，用于计算一个球形离子的溶剂化自由能。该离子被视为一个位于半径为 $r$ 的球形空腔中心的点电荷，此空腔嵌入在相对介电常数为 $\\varepsilon_{r}$ 的线性、均匀、各向同性的电介质中。请使用以下基本原理：\n\n- 静电势 $\\phi(\\mathbf{r})$ 在物质中遵循泊松方程 $\\nabla \\cdot \\left( \\varepsilon \\nabla \\phi \\right) = -\\rho$，其中 $\\varepsilon = \\varepsilon_{0} \\varepsilon_{r}$，$\\varepsilon_{0}$ 是真空介电常数，$\\varepsilon_{r}$ 是相对介电常数。\n- 溶剂化自由能定义为在电介质中将离子从 $0$ 充电到 $q$ 所做的可逆功，减去在真空中的功，即通过极化诱导电势（反应场）计算的充电自由能之差。\n- 在电介质界面处的边界条件要求电场的切向分量和电位移的法向分量是连续的。\n\n基于这些原理，推导出一个关于电荷为 $q$、空腔半径为 $r$ 的球形离子相对于真空的溶剂化自由能的闭式表达式，该表达式应使用 $\\varepsilon_{0}$、$\\varepsilon_{r}$、$q$、$r$ 和基本常数来表示。推导完成后，实现一个程序，该程序能够：\n\n- 将以埃（ångström）为单位的半径转换为米。使用 $1\\,\\text{\\AA} = 10^{-10}\\,\\text{m}$。\n- 使用以基本电荷 $e$ 为单位指定的电荷，并使用 $e = 1.602176634 \\times 10^{-19}\\,\\text{C}$ 将其转换为库仑。\n- 使用阿伏伽德罗常数 $N_{\\mathrm{A}} = 6.02214076 \\times 10^{23}\\,\\text{mol}^{-1}$ 将单粒子能量转换为摩尔能量。\n- 使用真空介电常数 $\\varepsilon_{0} = 8.8541878128 \\times 10^{-12}\\,\\text{F}\\,\\text{m}^{-1}$。\n- 以 $\\text{kJ}\\,\\text{mol}^{-1}$ 为单位计算最终的溶剂化自由能。\n\n您必须量化两种不同的有效空腔半径集（被解释为类 Bondi 半径和类通用力场 (UFF) 半径）对每种离子计算出的溶剂化自由能的影响。对于每个测试用例，请计算：\n\n- 两种半径集（UFF 减 Bondi）下溶剂化自由能的绝对差，单位为 $\\text{kJ}\\,\\text{mol}^{-1}$。\n- 一个相对于 Bondi 半径值的无量纲有限差分弹性（归一化灵敏度），其定义如下：\n$$\nE \\equiv \\frac{\\Delta G(r_{\\mathrm{UFF}}) - \\Delta G(r_{\\mathrm{Bondi}})}{\\Delta G(r_{\\mathrm{Bondi}})} \\Bigg/ \\frac{r_{\\mathrm{UFF}} - r_{\\mathrm{Bondi}}}{r_{\\mathrm{Bondi}}}.\n$$\n如果分子比率或分母比率中的分母为零（即，当 $\\Delta G(r_{\\mathrm{Bondi}}) = 0$ 或 $r_{\\mathrm{UFF}} = r_{\\mathrm{Bondi}}$ 时），则在该测试用例中将 $E$ 定义为 $0.0$。\n\n物理和数值单位：\n- 所有最终的溶剂化自由能和绝对差均以 $\\text{kJ}\\,\\text{mol}^{-1}$ 表示。\n- 弹性 $E$ 是无单位的（无量纲的）。\n\n测试套件：\n对下述每种离子，使用指定的相对介电常数 $\\varepsilon_{r}$ 值和半径集。电荷以 $e$ 为单位，半径以埃为单位，$\\varepsilon_{r}$ 是无量纲的。\n\n- 案例 1：名称 = Na$^{+}$，$q = +1$，$\\varepsilon_{r} = 78.3553$，$r_{\\mathrm{Bondi}} = 2.27$，$r_{\\mathrm{UFF}} = 2.35$。\n- 案例 2：名称 = Cl$^{-}$，$q = -1$，$\\varepsilon_{r} = 78.3553$，$r_{\\mathrm{Bondi}} = 1.75$，$r_{\\mathrm{UFF}} = 1.948$。\n- 案例 3：名称 = Mg$^{2+}$，$q = +2$，$\\varepsilon_{r} = 78.3553$，$r_{\\mathrm{Bondi}} = 1.73$，$r_{\\mathrm{UFF}} = 1.50$。\n- 案例 4：名称 = F$^{-}$，$q = -1$，$\\varepsilon_{r} = 78.3553$，$r_{\\mathrm{Bondi}} = 1.47$，$r_{\\mathrm{UFF}} = 1.571$。\n- 案例 5 (简并半径)：名称 = X$^{+}$，$q = +1$，$\\varepsilon_{r} = 78.3553$，$r_{\\mathrm{Bondi}} = 1.50$，$r_{\\mathrm{UFF}} = 1.50$。\n- 案例 6 (边界电介质)：名称 = V$^{+}$，$q = +1$，$\\varepsilon_{r} = 1.0$，$r_{\\mathrm{Bondi}} = 2.00$，$r_{\\mathrm{UFF}} = 2.20$。\n\n您的程序应：\n- 实现从第一性原理推导出的闭式公式，为每个半径集和每个测试用例计算溶剂化自由能。\n- 按案例 1 到 6 的顺序，生成配对序列 $[\\ |\\Delta G_{\\mathrm{UFF}} - \\Delta G_{\\mathrm{Bondi}}|,\\ E\\ ]$，并将其展平为单个数字列表。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含所有结果，形式为一个逗号分隔的列表，并用方括号括起来，数字顺序为 $[\\ \\text{absdiff}_{1}, E_{1}, \\text{absdiff}_{2}, E_{2}, \\ldots, \\text{absdiff}_{6}, E_{6}\\ ]$。\n- 能量差异以 $\\text{kJ}\\,\\text{mol}^{-1}$ 表示，弹性为无量纲数字。在打印前将每个数字四舍五入到 6 位小数。", "solution": "所述问题是有效的。它具有科学依据、提法明确且客观。它要求推导连续介质静电学中的一个基本结果——离子溶剂化的 Born 模型，并将其应用于灵敏度分析。该问题是自洽的，提供了所有必需的物理常数、参数和定义。我们将按要求从第一性原理开始进行推导。\n\n该系统由位于原点的点电荷 $q$ 组成，它处于一个半径为 $r$ 的球形空腔内。空间被划分为两个区域：内部区域（$R < r$）是真空，其相对介电常数 $\\varepsilon_{r,in} = 1$；外部区域（$R > r$）是连续电介质，其相对介电常数为 $\\varepsilon_r$。静电势 $\\phi$ 受泊松方程 $\\nabla \\cdot (\\varepsilon_0 \\varepsilon_r \\nabla \\phi) = -\\rho_{free}$ 的支配。\n\n由于问题的球对称性，静电势 $\\phi$ 仅是距原点径向距离 $R$ 的函数。\n\n在空腔内部（$0 < R < r$），除点电荷所在的原点外，电荷密度为零。电势 $\\phi_{in}(R)$ 是点电荷自身产生的电势与来自极化电介质的反应势 $\\phi_{reac}$ 的叠加。反应势必须是拉普拉斯方程 $\\nabla^2 \\phi_{reac} = 0$ 的一个解，并且在原点（$R=0$）处是正则的。在球坐标中，唯一具有球对称性的此类解是一个常数 $C$。因此，空腔内部的总电势为：\n$$\n\\phi_{in}(R) = \\frac{q}{4\\pi\\varepsilon_0 R} + C\n$$\n这种形式正确地捕捉了由点电荷引起的在 $R=0$ 处的奇点。\n\n在空腔外部（$R > r$），该区域是无电荷的，因此电势 $\\phi_{out}(R)$ 必须满足拉普拉斯方程 $\\nabla^2 \\phi_{out}(R) = 0$。当 $R \\to \\infty$ 时趋于零的解是：\n$$\n\\phi_{out}(R) = \\frac{A}{R}\n$$\n其中 $A$ 是一个待定常数。\n\n常数 $A$ 和 $C$ 可以通过在介电分界面 $R=r$ 处应用静电学的标准边界条件来求得。\n\n1. 电势在边界上必须是连续的：$\\phi_{in}(r) = \\phi_{out}(r)$。\n$$\n\\frac{q}{4\\pi\\varepsilon_0 r} + C = \\frac{A}{r} \\quad (1)\n$$\n\n2. 电位移矢量 $\\mathbf{D}$ 的法向分量在边界上必须是连续的。由于界面上没有自由表面电荷，因此 $D_{\\perp,in}(r) = D_{\\perp,out}(r)$。电场由 $\\mathbf{E} = -\\nabla\\phi$ 给出，对于径向电势，其唯一分量是 $E_R = -d\\phi/dR$。位移矢量为 $\\mathbf{D} = \\varepsilon \\mathbf{E}$。边界条件变为：\n$$\n\\varepsilon_{in} \\left(-\\frac{d\\phi_{in}}{dR}\\right)\\bigg|_{R=r} = \\varepsilon_{out} \\left(-\\frac{d\\phi_{out}}{dR}\\right)\\bigg|_{R=r}\n$$\n当 $\\varepsilon_{in} = \\varepsilon_0$ 且 $\\varepsilon_{out} = \\varepsilon_0 \\varepsilon_r$ 时，该式可简化为：\n$$\n\\left(\\frac{d\\phi_{in}}{dR}\\right)\\bigg|_{R=r} = \\varepsilon_r \\left(\\frac{d\\phi_{out}}{dR}\\right)\\bigg|_{R=r}\n$$\n计算导数：\n$$\n\\frac{d\\phi_{in}}{dR} = -\\frac{q}{4\\pi\\varepsilon_0 R^2}\n\\quad \\text{和} \\quad\n\\frac{d\\phi_{out}}{dR} = -\\frac{A}{R^2}\n$$\n将这些代入 $R=r$ 处的边界条件：\n$$\n-\\frac{q}{4\\pi\\varepsilon_0 r^2} = \\varepsilon_r \\left(-\\frac{A}{r^2}\\right)\n$$\n这直接给出了常数 $A$：\n$$\nA = \\frac{q}{4\\pi\\varepsilon_0 \\varepsilon_r}\n$$\n现在，将 $A$ 代回方程 $(1)$ 来求解 $C$：\n$$\n\\frac{q}{4\\pi\\varepsilon_0 r} + C = \\frac{1}{r} \\left(\\frac{q}{4\\pi\\varepsilon_0 \\varepsilon_r}\\right)\n$$\n$$\nC = \\frac{q}{4\\pi\\varepsilon_0 r \\varepsilon_r} - \\frac{q}{4\\pi\\varepsilon_0 r} = \\frac{q}{4\\pi\\varepsilon_0 r} \\left(\\frac{1}{\\varepsilon_r} - 1\\right)\n$$\n常数 $C$ 代表在点电荷位置（$R=0$）处的反应势 $\\phi_{reac}$。该电势是由电介质中感应出的极化电荷产生的。\n\n溶剂化自由能 $\\Delta G$ 是抵抗此反应势将离子从电荷 $0$ 充电到其最终电荷 $q$ 所需的功。这在数学上表示为：\n$$\n\\Delta G = \\int_0^q \\phi_{reac}(q') dq'\n$$\n反应势与引起它的电荷 $q'$ 呈线性关系：\n$$\n\\phi_{reac}(q') = \\frac{q'}{4\\pi\\varepsilon_0 r} \\left(\\frac{1}{\\varepsilon_r} - 1\\right)\n$$\n执行积分可得：\n$$\n\\Delta G = \\int_0^q \\frac{q'}{4\\pi\\varepsilon_0 r} \\left(\\frac{1}{\\varepsilon_r} - 1\\right) dq' = \\frac{1}{4\\pi\\varepsilon_0 r} \\left(\\frac{1}{\\varepsilon_r} - 1\\right) \\int_0^q q' dq'\n$$\n$$\n\\Delta G = \\frac{1}{4\\pi\\varepsilon_0 r} \\left(\\frac{1}{\\varepsilon_r} - 1\\right) \\left[\\frac{(q')^2}{2}\\right]_0^q\n$$\n溶剂化自由能的最终表达式是 Born 方程：\n$$\n\\Delta G = -\\frac{q^2}{8\\pi\\varepsilon_0 r} \\left(1 - \\frac{1}{\\varepsilon_r}\\right)\n$$\n该表达式给出了单个离子的能量，单位为焦耳。为了实现计算，必须将其转换为摩尔量，单位为 $\\text{kJ}\\,\\text{mol}^{-1}$。电荷 $q$ 以基本电荷 $e$ 为单位给出，半径 $r$ 以埃为单位给出，需要进行适当的单位转换。\n\n以 $\\text{kJ}\\,\\text{mol}^{-1}$ 为单位的摩尔溶剂化自由能 $\\Delta G_{\\text{molar}}$ 为：\n$$\n\\Delta G_{\\text{molar}}[\\text{kJ}\\,\\text{mol}^{-1}] = \\Delta G \\times N_A \\times \\frac{1}{1000}\n$$\n其中 $N_A$ 是阿伏伽德罗常数。Born 方程中使用的电荷 $q$ 是 $q_{val} \\times e$，其中 $q_{val}$ 是整数电荷数。半径 $r$ 是 $r_{val} \\times 10^{-10}\\,\\text{m}$。\n\n灵敏度分析需要为每种离子计算两个量：\n1. 溶剂化能的绝对差：$|\\Delta G(r_{\\mathrm{UFF}}) - \\Delta G(r_{\\mathrm{Bondi}})|$。\n2. 无量纲有限差分弹性 $E$：\n$$\nE = \\frac{\\Delta G(r_{\\mathrm{UFF}}) - \\Delta G(r_{\\mathrm{Bondi}})}{\\Delta G(r_{\\mathrm{Bondi}})} \\Bigg/ \\frac{r_{\\mathrm{UFF}} - r_{\\mathrm{Bondi}}}{r_{\\mathrm{Bondi}}}\n$$\n问题规定，如果任一比率中的分母为零（即，如果 $r_{\\mathrm{UFF}} = r_{\\mathrm{Bondi}}$ 或 $\\Delta G(r_{\\mathrm{Bondi}}) = 0$），则必须将 $E$ 设置为 $0.0$。当 $q=0$ 或 $\\varepsilon_r=1$ 时，会出现条件 $\\Delta G(r_{\\mathrm{Bondi}}) = 0$。\n\n程序将实现推导出的 $\\Delta G$ 公式，执行必要的单位转换，并为每个指定的测试用例计算这两个指标。最终的数值结果将按要求四舍五入到六位小数。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the sensitivity of solvation free energy to atomic radius changes\n    based on the Born model of ion solvation.\n    \"\"\"\n\n    # Physical constants\n    ANGSTROM_TO_M = 1e-10  # m/Å\n    E_CHARGE = 1.602176634e-19  # C\n    N_AVOGADRO = 6.02214076e23  # mol^-1\n    EPSILON_0 = 8.8541878128e-12  # F/m\n\n    test_cases = [\n        # name, q (in e), eps_r, r_bondi (Å), r_uff (Å)\n        ('Na+', 1, 78.3553, 2.27, 2.35),\n        ('Cl-', -1, 78.3553, 1.75, 1.948),\n        ('Mg2+', 2, 78.3553, 1.73, 1.50),\n        ('F-', -1, 78.3553, 1.47, 1.571),\n        ('X+', 1, 78.3553, 1.50, 1.50),\n        ('V+', 1, 1.0, 2.00, 2.20),\n    ]\n\n    def compute_solvation_energy(q_val, r_val_angstrom, eps_r):\n        \"\"\"\n        Calculates the molar solvation free energy in kJ/mol using the Born equation.\n        \n        Args:\n            q_val (float): Charge of the ion in units of elementary charge e.\n            r_val_angstrom (float): Radius of the cavity in Ångströms.\n            eps_r (float): Relative permittivity of the solvent.\n            \n        Returns:\n            float: Molar solvation free energy in kJ/mol.\n        \"\"\"\n        if eps_r <= 0:\n            raise ValueError(\"Relative permittivity must be positive.\")\n        if r_val_angstrom <= 0:\n            raise ValueError(\"Radius must be positive.\")\n\n        # Handle the case of vacuum, where solvation energy is zero.\n        if eps_r == 1.0:\n            return 0.0\n\n        # Convert to SI units\n        q = q_val * E_CHARGE  # Charge in Coulombs\n        r = r_val_angstrom * ANGSTROM_TO_M  # Radius in meters\n\n        # Born equation for single ion energy (in Joules)\n        # delta_G = - (q^2 / (8 * pi * eps_0 * r)) * (1 - 1/eps_r)\n        \n        # Pre-calculate constant factor to avoid repeating computations\n        prefactor = - (q**2) / (8 * np.pi * EPSILON_0)  # J*m\n        dielectric_factor = 1.0 - (1.0 / eps_r)\n        \n        delta_g_ion = prefactor * dielectric_factor / r  # J\n\n        # Convert to molar energy in kJ/mol\n        delta_g_molar_kj = delta_g_ion * N_AVOGADRO / 1000.0\n        \n        return delta_g_molar_kj\n\n    results = []\n    for _, q_val, eps_r, r_bondi, r_uff in test_cases:\n        \n        # Compute solvation free energies for both radii\n        delta_g_bondi = compute_solvation_energy(q_val, r_bondi, eps_r)\n        delta_g_uff = compute_solvation_energy(q_val, r_uff, eps_r)\n        \n        # 1. Absolute difference in solvation free energies\n        abs_diff = abs(delta_g_uff - delta_g_bondi)\n        \n        # 2. Dimensionless finite-difference elasticity E\n        # E = ( (delta_g_uff - delta_g_bondi) / delta_g_bondi ) / ( (r_uff - r_bondi) / r_bondi )\n        \n        # Handle special cases for E as per problem description\n        if r_uff == r_bondi or delta_g_bondi == 0.0:\n            elasticity = 0.0\n        else:\n            rel_delta_g_change = (delta_g_uff - delta_g_bondi) / delta_g_bondi\n            rel_r_change = (r_uff - r_bondi) / r_bondi\n            elasticity = rel_delta_g_change / rel_r_change\n\n        results.extend([abs_diff, elasticity])\n\n    # Format output to 6 decimal places and print\n    formatted_results = [f\"{num:.6f}\" for num in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2882419"}]}