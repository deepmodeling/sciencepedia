{"hands_on_practices": [{"introduction": "在冻结密度嵌入（FDE）理论中，核心的量是非加和非相互作用动能 $T_s^{\\mathrm{nadd}}[\\rho_A, \\rho_B]$，它描述了不同子系统电子密度之间的泡利排斥作用。第一个练习将我们带回密度泛函理论的本源，推导这一项最简单的近似——Thomas–Fermi 泛函。通过从均匀电子气模型出发，你不仅将推导出这个基础性的泛函，还将批判性地分析其内在的局限性，从而为理解为何需要更高级的近似方法以进行精确的化学模拟提供一个至关重要的视角。[@problem_id:2893022]", "problem": "考虑一个被限制在具有周期性边界条件的大盒子中的无相互作用、自旋非极化的电子气。电子占据平面波轨道，直至由密度决定的费米波矢 $k_{\\mathrm F}$。使用以下基本事实作为出发点：\n- 单位 $k$ 空间体积内的单电子态数目是恒定的，每个空间轨道可被 $2$ 个电子（两种自旋态）占据。\n- 被占据平面波的无相互作用动能密度是通过在费米球上对 $\\hbar^2 k^2/(2m)$ 进行积分得到的。\n- 在原子单位制中，$\\hbar = m_e = e = 1$，无相互作用动能算符为 $-\\tfrac{1}{2}\\nabla^2$。\n\n任务：\n1) 基于这些基础，推导均匀电子气所蕴含的动能密度对电子密度 $\\rho(\\mathbf r)$ 的局域依赖关系，从而得出通常称为 Thomas–Fermi 泛函的局域动能泛函形式。确定乘以 $\\rho(\\mathbf r)$ 幂次的空间积分的无量纲常数 $C_F$。\n2) 在子系统密度泛函理论（DFT）中，对于两个密度分别为 $\\rho_A$ 和 $\\rho_B$ 的子系统，其非加和性无相互作用动能（NAKE）定义为\n$$\nT_s^{\\mathrm{nadd}}[\\rho_A,\\rho_B] \\equiv T_s[\\rho_A+\\rho_B] - T_s[\\rho_A] - T_s[\\rho_B].\n$$\n在冻结密度嵌入（FDE）中，泛函导数 $\\delta T_s^{\\mathrm{nadd}}/\\delta \\rho_A$ 构成了嵌入势的一部分，该嵌入势在子系统之间强制执行泡利不相容原理。基于第一性原理和 Thomas–Fermi 近似的局域性，论述当两个子系统密度显著重叠时（例如，在共价键区域），其定性行为和局限性。\n\n哪个选项同时正确给出了第 $1)$ 部分的常数 $C_F$ 和第 $2)$ 部分的准确定性评估？\n\nA) $C_F = \\dfrac{3}{10}\\left(3\\pi^2\\right)^{2/3}$；作为重叠区域的 NAKE，Thomas–Fermi 形式因其凸性而严格局域且为正，但它通常低估了泡利势垒的大小和空间结构，在单轨道极限下失效，并且在共价键和电荷转移情况下表现不佳。\n\nB) $C_F = \\dfrac{3}{5}\\left(3\\pi^2\\right)^{2/3}$；作为重叠区域的 NAKE，Thomas–Fermi 形式变得精确，因为密度高且近似均匀，因此即使对于共价键，它也能正确捕捉泡利势垒。\n\nC) $C_F = \\dfrac{1}{2}\\left(3\\pi^2\\right)^{2/3}$；作为重叠区域的 NAKE，Thomas–Fermi 形式因其超加和性而为负，因此产生虚假的吸引力，在所有情况下都导致电子过度离域。\n\nD) $C_F = \\dfrac{3}{10}\\left(6\\pi^2\\right)^{2/3}$；作为重叠区域的 NAKE，Thomas–Fermi 形式严重高估了泡利排斥势垒，并且通常在弱相互作用复合物中也会阻止电荷转移。", "solution": "该问题分两部分。首先，我们必须为无相互作用的均匀电子气推导 Thomas–Fermi 动能泛函，并确定常数因子 $C_F$。其次，我们分析当此泛函用作子系统密度泛函理论（DFT）中非加和性无相互作用动能（NAKE）的近似时，特别是在电子密度重叠区域，其定性行为。\n\n### 第 1 部分：Thomas–Fermi 泛函和常数 $C_F$ 的推导\n\n我们从问题给出的关于体积为 $V$、具有周期性边界条件的盒子中的无相互作用、自旋非极化电子气的第一性原理出发。\n\n1.  **电子密度 $\\rho$ 与费米波矢 $k_{\\mathrm F}$ 之间的关系**\n\n    倒易空间（$k$-空间）微元体积 $d^3k$ 内可用的单电子态数目为 $V/(2\\pi)^3 d^3k$。由于电子是费米子，每个空间轨道（由波矢 $\\mathbf{k}$ 定义）可以被两个自旋相反的电子占据（自旋简并因子 $g_s=2$）。在零温下，所有波矢大小 $|\\mathbf{k}| \\le k_{\\mathrm F}$ 的态都被占据，形成一个费米球。\n\n    电子总数 $N$ 是通过对费米球体积内的态密度进行积分得到的：\n    $$ N = g_s \\left( \\frac{V}{(2\\pi)^3} \\right) \\int_{|\\mathbf{k}| \\le k_{\\mathrm F}} d^3k $$\n    该积分就是费米球的体积，即 $\\frac{4}{3}\\pi k_{\\mathrm F}^3$。\n    $$ N = 2 \\left( \\frac{V}{8\\pi^3} \\right) \\left( \\frac{4}{3}\\pi k_{\\mathrm F}^3 \\right) = \\frac{V}{3\\pi^2} k_{\\mathrm F}^3 $$\n    电子密度为 $\\rho = N/V$。因此，我们建立了均匀电子气的密度与费米波矢之间的基本关系：\n    $$ \\rho = \\frac{k_{\\mathrm F}^3}{3\\pi^2} \\implies k_{\\mathrm F} = (3\\pi^2 \\rho)^{1/3} $$\n\n2.  **动能密度的推导**\n\n    问题说明我们使用原子单位制，其中 $\\hbar=1$ 且电子质量 $m_e=1$。处于平面波态 $\\exp(i\\mathbf{k}\\cdot\\mathbf{r})$ 的单个电子的动能为 $\\frac{1}{2}k^2$。总的无相互作用动能 $T_s$ 是所有被占据态的能量之和：\n    $$ T_s = g_s \\left( \\frac{V}{(2\\pi)^3} \\right) \\int_{|\\mathbf{k}| \\le k_{\\mathrm F}} \\frac{1}{2}k^2 d^3k $$\n    为计算此积分，我们切换到 $k$ 空间中的球坐标，其中 $d^3k = 4\\pi k^2 dk$：\n    $$ T_s = 2 \\left( \\frac{V}{8\\pi^3} \\right) \\int_0^{k_{\\mathrm F}} \\left( \\frac{1}{2}k^2 \\right) (4\\pi k^2) dk = \\frac{V}{2\\pi^2} \\int_0^{k_{\\mathrm F}} k^4 dk $$\n    执行积分：\n    $$ T_s = \\frac{V}{2\\pi^2} \\left[ \\frac{k^5}{5} \\right]_0^{k_{\\mathrm F}} = \\frac{V}{10\\pi^2} k_{\\mathrm F}^5 $$\n    为了得到动能密度 $\\tau_s = T_s/V$，我们有：\n    $$ \\tau_s = \\frac{k_{\\mathrm F}^5}{10\\pi^2} $$\n    现在，我们通过代入 $k_{\\mathrm F} = (3\\pi^2 \\rho)^{1/3}$，将 $\\tau_s$ 表示为密度 $\\rho$ 的函数：\n    $$ \\tau_s(\\rho) = \\frac{1}{10\\pi^2} \\left( (3\\pi^2 \\rho)^{1/3} \\right)^5 = \\frac{1}{10\\pi^2} (3\\pi^2)^{5/3} \\rho^{5/3} $$\n    简化常数因子：\n    $$ \\frac{(3\\pi^2)^{5/3}}{10\\pi^2} = \\frac{(3\\pi^2) \\cdot (3\\pi^2)^{2/3}}{10\\pi^2} = \\frac{3}{10}(3\\pi^2)^{2/3} $$\n    这就得到了均匀电子气的动能密度，即 Thomas–Fermi 动能密度：\n    $$ \\tau_s^{\\mathrm{TF}}(\\rho) = \\frac{3}{10}(3\\pi^2)^{2/3} \\rho^{5/3} $$\n    Thomas–Fermi 泛函是通过将局域密度近似（LDA）应用于动能得到的，它假设这种局域关系对于非均匀密度 $\\rho(\\mathbf{r})$ 也成立：\n    $$ T_s^{\\mathrm{TF}}[\\rho] = \\int \\tau_s^{\\mathrm{TF}}(\\rho(\\mathbf{r})) d^3r = \\int C_F \\rho(\\mathbf{r})^{5/3} d^3r $$\n    通过比较，我们确定常数 $C_F$：\n    $$ C_F = \\frac{3}{10}(3\\pi^2)^{2/3} $$\n\n### 第 2 部分：Thomas–Fermi NAKE 泛函的分析\n\n非加和性无相互作用动能（NAKE）定义为：\n$$ T_s^{\\mathrm{nadd}}[\\rho_A,\\rho_B] \\equiv T_s[\\rho_A+\\rho_B] - T_s[\\rho_A] - T_s[\\rho_B] $$\n当两个电子分布 $\\rho_A$ 和 $\\rho_B$ 重叠时，该项说明了由泡利不相容原理引起的动能变化。在 Thomas–Fermi 近似中：\n$$ T_s^{\\mathrm{nadd, TF}}[\\rho_A, \\rho_B] = C_F \\int \\left( (\\rho_A(\\mathbf{r}) + \\rho_B(\\mathbf{r}))^{5/3} - \\rho_A(\\mathbf{r})^{5/3} - \\rho_B(\\mathbf{r})^{5/3} \\right) d^3r $$\n\n**定性行为与局限性：**\n\n1.  **正性和凸性：** 对于 $x > 0$，函数 $f(x) = x^{p}$（其中 $p = 5/3 > 1$）是严格凸函数。这类函数的一个性质是，对于任意 $a,b > 0$，都有 $(a+b)^p > a^p + b^p$。因此，只要 $\\rho_A$ 和 $\\rho_B$ 都不为零，被积函数 $(\\rho_A + \\rho_B)^{5/3} - \\rho_A^{5/3} - \\rho_B^{5/3}$ 就严格为正。因此，$T_s^{\\mathrm{nadd, TF}}$ 总是正的。这正确地捕捉了泡利原理的排斥性质，即密度重叠会增加系统的动能。\n\n2.  **局域性和低估：** Thomas–Fermi 模型是为均匀电子气推导的，是一个纯粹的*局域*泛函，意味着在点 $\\mathbf{r}$ 处的动能仅依赖于该点的密度 $\\rho$。然而，真实的动能是高度非局域的，依赖于整个轨道结构。在密度显著重叠的区域，例如共价键中，密度变化迅速。TF 近似缺乏关于密度梯度或轨道结构的信息，无法捕捉真实泡利排斥势（“泡利势垒”）复杂的空间特征。TF NAKE 严重*低估*了这种排斥的大小，是其一个有据可查的失败之处。\n\n3.  **在单轨道极限下的失败：** 考虑一个由单轨道 $\\psi$ 描述的系统，例如氢原子。对于将其密度 $\\rho = |\\psi|^2$ 划分为两个虚构子系统 $\\rho_A = f\\rho$ 和 $\\rho_B = (1-f)\\rho$ （其中 $0 < f < 1$）的任何划分方式，精确的 NAKE 都必须为零，因为没有子系统间的泡利不相容原理需要考虑。然而，TF 泛函给出了一个非零的正 NAKE：$T_s^{\\mathrm{nadd, TF}} = C_F (1-f^{5/3}-(1-f)^{5/3}) \\int \\rho^{5/3} d^3r > 0$。这个灾难性的失败表明它无法正确描述具有少量电子或轨道的系统。\n\n4.  **对成键和电荷转移的影响：** 因为 TF NAKE 低估了泡利排斥，在 FDE 计算中使用它会导致子系统过度重叠。在共价键中，这会导致对键长和键能的不准确描述。对于弱相互作用体系，被低估的排斥可能导致从一个子系统到另一个子系统的虚假电荷转移，因为该过程的动能代价没有被正确计算。\n\n### 选项评估\n\n*   **A) $C_F = \\dfrac{3}{10}\\left(3\\pi^2\\right)^{2/3}$；作为重叠区域的 NAKE，Thomas–Fermi 形式因其凸性而严格局域且为正，但它通常低估了泡利势垒的大小和空间结构，在单轨道极限下失效，并且在共价键和电荷转移情况下表现不佳。**\n    $C_F$ 的值与我们的推导一致。定性评估准确地描述了该泛函的正性、其局域性质以及其众所周知的缺陷：低估泡利势垒、在单轨道极限下失效，以及在共价键和电荷转移体系中表现不佳。\n    **结论：正确。**\n\n*   **B) $C_F = \\dfrac{3}{5}\\left(3\\pi^2\\right)^{2/3}$；作为重叠区域的 NAKE，Thomas–Fermi 形式变得精确，因为密度高且近似均匀，因此即使对于共价键，它也能正确捕捉泡利势垒。**\n    常数 $C_F$ 不正确（是 $3/10$ 而不是 $3/5$）。定性评估也不正确；TF 近似对于共价键并非精确，并且对泡利势垒的捕捉很差。\n    **结论：不正确。**\n\n*   **C) $C_F = \\dfrac{1}{2}\\left(3\\pi^2\\right)^{2/3}$；作为重叠区域的 NAKE，Thomas–Fermi 形式因其超加和性而为负，因此产生虚假的吸引力，在所有情况下都导致电子过度离域。**\n    常数 $C_F$ 不正确（是 $3/10$ 而不是 $1/2$）。定性评估也不正确；TF NAKE 是正的（排斥性），而不是负的（吸引性）。\n    **结论：不正确。**\n\n*   **D) $C_F = \\dfrac{3}{10}\\left(6\\pi^2\\right)^{2/3}$；作为重叠区域的 NAKE，Thomas–Fermi 形式严重高估了泡利排斥势垒，并且通常在弱相互作用复合物中也会阻止电荷转移。**\n    常数 $C_F$ 不正确；它包含 $(6\\pi^2)^{2/3}$，这与自旋密度泛函有关，而不是题目所要求的自旋非极化总密度泛函。定性评估也不正确；TF NAKE *低估*了泡利排斥，而不是高估。\n    **结论：不正确。**", "answer": "$$\\boxed{A}$$", "id": "2893022"}, {"introduction": "尽管改进非加和动能泛函至关重要，但子系统DFT中的许多挑战源于其底层DFT近似中一个更根本性的问题：离域误差。这种误差会导致子系统上出现虚假的非整数电荷，这是一种非物理的人为现象，可能使计算变得毫无意义。本实践采用一个极简的双能级模型，通过解析方式展示了常见近似泛函中导数不连续性的缺失如何不可避免地导致这种非整数电荷问题，为理解这一关键概念性障碍提供了清晰而有力的洞见。[@problem_id:2893026]", "problem": "考虑在 Kohn–Sham 密度泛函理论 (KS-DFT) 框架下，通过冻结密度嵌入 (FDE) 方法处理的两个弱相互作用子系统 $A$ 和 $B$。设总电子数固定为 $N=N_{A}^{0}+N_{B}^{0}$，其中 $N_{A}^{0}$ 和 $N_{B}^{0}$ 为整数。我们使用一个最小二能级模型来分析电荷转移，该模型中仅保留每个子系统的前线（最高占据/最低未占）响应，并且子系统间的相互作用以净电荷转移的二次惩罚项形式引入。假设以下具有物理动机且科学上标准的要素：\n\n- 精确的基态能量作为电子数的函数是分段线性的，在整数点处存在拐点（导数不连续性）。相反，缺少导数不连续性的近似密度泛函在每个整数电子数附近是光滑且严格凸的。\n- 在此最小模型中，我们将每个孤立子系统在其整数电子数 $N_{i}^{0}$ 附近的光滑近似能量，通过其在电子转移量 $\\Delta N$ 上的二阶泰勒展开进行参数化：\n  $$E_{A}(N_{A}^{0}+\\Delta N)=E_{A}(N_{A}^{0})+\\mu_{A}\\,\\Delta N+\\frac{1}{2}\\eta_{A}\\,(\\Delta N)^{2},$$\n  $$E_{B}(N_{B}^{0}-\\Delta N)=E_{B}(N_{B}^{0})-\\mu_{B}\\,\\Delta N+\\frac{1}{2}\\eta_{B}\\,(\\Delta N)^{2},$$\n  其中 $i\\in\\{A,B\\}$，$\\mu_{i}$ 是 $E_{i}(N_{i})$ 在 $N_{i}^{0}$ 处的左导数（光滑近似下的子系统化学势），而 $\\eta_{i}>0$ 是相应的曲率（化学硬度）。\n- 惩罚电荷分离的嵌入介导相互作用，其主导阶由一个二次项表示：\n  $$U_{\\text{emb}}(\\Delta N)=\\kappa\\,(\\Delta N)^{2},$$\n  其中 $\\kappa>0$ 概括了 FDE 中的长程静电作用和非加和动能/交换相关刚度。\n\n因此，总模型能量作为从 $B$ 到 $A$ 的电子转移量 $\\Delta N$ 的函数为\n$$E_{\\text{tot}}(\\Delta N)=E_{A}(N_{A}^{0}+\\Delta N)+E_{B}(N_{B}^{0}-\\Delta N)+U_{\\text{emb}}(\\Delta N).$$\n\n仅使用基态的变分原理和化学势是能量对电子数导数的定义，确定在这个光滑（无导数不连续性）模型中使 $E_{\\text{tot}}(\\Delta N)$ 最小化的平衡电子转移量 $\\Delta N^{\\ast}$。将最终答案表示为由 $\\mu_{A}$、$\\mu_{B}$、$\\eta_{A}$、$\\eta_{B}$ 和 $\\kappa$ 构成的闭合形式解析表达式。除上述假设外，不允许任何其他额外假设。以单个解析表达式的形式提供最终答案。", "solution": "该问题陈述已经过严格验证，并被认为是有效的。它科学地基于 Kohn-Sham 密度泛函理论 (KS-DFT) 和冻结密度嵌入 (FDE) 的原理，是适定的，并且没有矛盾或含糊之处。它提出了一个用于描述子系统间电荷转移的标准（尽管是简化的）模型，该模型可以使用微积分的基本原理解答。\n\n目标是找到使系统总能量 $E_{\\text{tot}}(\\Delta N)$ 最小化的平衡电子转移量，记为 $\\Delta N^{\\ast}$。变分原理规定，该最小值对应于总能量对变分参数 $\\Delta N$ 的一阶导数为零的点。\n\n系统的总能量由各个子系统的能量与嵌入相互作用能之和给出：\n$$E_{\\text{tot}}(\\Delta N) = E_{A}(N_{A}^{0}+\\Delta N) + E_{B}(N_{B}^{0}-\\Delta N) + U_{\\text{emb}}(\\Delta N)$$\n\n我们将每项对应的二次模型代入：\n$$E_{A}(N_{A}^{0}+\\Delta N) = E_{A}(N_{A}^{0})+\\mu_{A}\\,\\Delta N+\\frac{1}{2}\\eta_{A}\\,(\\Delta N)^{2}$$\n$$E_{B}(N_{B}^{0}-\\Delta N) = E_{B}(N_{B}^{0})-\\mu_{B}\\,\\Delta N+\\frac{1}{2}\\eta_{B}\\,(\\Delta N)^{2}$$\n$$U_{\\text{emb}}(\\Delta N) = \\kappa\\,(\\Delta N)^{2}$$\n\n合并这些项得到总能量的完整表达式：\n$$E_{\\text{tot}}(\\Delta N) = \\left( E_{A}(N_{A}^{0})+\\mu_{A}\\,\\Delta N+\\frac{1}{2}\\eta_{A}\\,(\\Delta N)^{2} \\right) + \\left( E_{B}(N_{B}^{0})-\\mu_{B}\\,\\Delta N+\\frac{1}{2}\\eta_{B}\\,(\\Delta N)^{2} \\right) + \\kappa\\,(\\Delta N)^{2}$$\n\n为简化起见，我们按 $\\Delta N$ 的幂次对各项进行分组。$E_{A}(N_{A}^{0})$ 和 $E_{B}(N_{B}^{0})$ 项相对于 $\\Delta N$ 是常数。\n$$E_{\\text{tot}}(\\Delta N) = \\left( E_{A}(N_{A}^{0}) + E_{B}(N_{B}^{0}) \\right) + (\\mu_{A} - \\mu_{B})\\,\\Delta N + \\left( \\frac{1}{2}\\eta_{A} + \\frac{1}{2}\\eta_{B} + \\kappa \\right)(\\Delta N)^{2}$$\n$$E_{\\text{tot}}(\\Delta N) = C + (\\mu_{A} - \\mu_{B})\\,\\Delta N + \\frac{1}{2}(\\eta_{A} + \\eta_{B} + 2\\kappa)(\\Delta N)^{2}$$\n其中 $C = E_{A}(N_{A}^{0}) + E_{B}(N_{B}^{0})$ 是一个常数。\n\n为求最小值，我们将 $E_{\\text{tot}}(\\Delta N)$ 对 $\\Delta N$ 求导，并令结果为零：\n$$\\frac{dE_{\\text{tot}}}{d(\\Delta N)} = \\frac{d}{d(\\Delta N)}\\left[ C + (\\mu_{A} - \\mu_{B})\\,\\Delta N + \\frac{1}{2}(\\eta_{A} + \\eta_{B} + 2\\kappa)(\\Delta N)^{2} \\right] = 0$$\n$$\\frac{dE_{\\text{tot}}}{d(\\Delta N)} = (\\mu_{A} - \\mu_{B}) + (\\eta_{A} + \\eta_{B} + 2\\kappa)\\,\\Delta N = 0$$\n\n我们解此线性方程以求平衡转移量 $\\Delta N = \\Delta N^{\\ast}$：\n$$(\\eta_{A} + \\eta_{B} + 2\\kappa)\\,\\Delta N^{\\ast} = -(\\mu_{A} - \\mu_{B})$$\n$$\\Delta N^{\\ast} = \\frac{-(\\mu_{A} - \\mu_{B})}{\\eta_{A} + \\eta_{B} + 2\\kappa}$$\n$$\\Delta N^{\\ast} = \\frac{\\mu_{B} - \\mu_{A}}{\\eta_{A} + \\eta_{B} + 2\\kappa}$$\n\n为确认此驻点是一个极小值点，我们计算总能量的二阶导数：\n$$\\frac{d^{2}E_{\\text{tot}}}{d(\\Delta N)^{2}} = \\frac{d}{d(\\Delta N)}\\left[ (\\mu_{A} - \\mu_{B}) + (\\eta_{A} + \\eta_{B} + 2\\kappa)\\,\\Delta N \\right]$$\n$$\\frac{d^{2}E_{\\text{tot}}}{d(\\Delta N)^{2}} = \\eta_{A} + \\eta_{B} + 2\\kappa$$\n问题陈述指明化学硬度 $\\eta_{A}$ 和 $\\eta_{B}$ 为正，嵌入刚度 $\\kappa$ 也为正。因此，和 $\\eta_{A} + \\eta_{B} + 2\\kappa$ 严格为正。正的二阶导数证实了函数 $E_{\\text{tot}}(\\Delta N)$ 是凸函数，且所确定的值 $\\Delta N^{\\ast}$ 对应于唯一的全局最小值。这一结果在物理上是合理的：电荷转移由化学势差 $(\\mu_{B} - \\mu_{A})$ 驱动，并受到子系统硬度与嵌入惩罚项之和的阻碍。", "answer": "$$\\boxed{\\frac{\\mu_{B} - \\mu_{A}}{\\eta_{A} + \\eta_{B} + 2\\kappa}}$$", "id": "2893026"}, {"introduction": "在探讨了理论基础和概念陷阱之后，我们现在转向实际的计算实现。本练习旨在弥合理论与代码之间的鸿沟，要求你构建一个一维模型，比较两种用于施加泡利排斥的截然不同的策略：FDE中基于势的方法和另一种基于投影的嵌入方法。通过在不同条件下对每种方案的轨道能量进行数值计算，你将获得将不同理论思想转化为计算实践的亲身经验，并观察它们对电子结构产生的不同影响。[@problem_id:2893048]", "problem": "考虑一个用于冻结密度嵌入（Frozen Density Embedding, FDE）和基于投影的嵌入的一维玩具模型，该模型捕捉了子系统嵌入机制的本质，同时在计算上易于处理且内容自洽。我们使用原子单位（能量单位为哈特里，长度单位为玻尔）。子系统密度泛函理论划分将总电子密度分为两个子系统，分别表示为子系统A和环境B，其真实空间密度为 $n_{A}(x)$ 和 $n_{B}(x)$。在此模型中，子系统A经历其自身的外势，并被嵌入在冻结的环境密度 $n_{B}(x)$ 的存在下。您将计算当两种方法都在相同冻结密度下构建时，基于势的FDE和基于投影的嵌入两者最低嵌入轨道能量的差异。\n\n基本和建模假设：\n- 在具有狄利克雷（Dirichlet）边界条件的一维域上，对子系统A使用类Kohn–Sham单粒子方程。动能算符为原子单位下的标准非相对论算符 $T = -\\tfrac{1}{2} \\tfrac{d^{2}}{dx^{2}}$。\n- 使用一个玩具式的局域无轨道动能泛函来定义驱动嵌入势的非加和动能贡献。具体来说，令无相互作用动能近似为 $T_{s}[n] = \\alpha \\int n(x)^{2} \\, dx$，其中 $\\alpha &gt; 0$ 为给定常数。其泛函导数为 $\\delta T_{s}/\\delta n = 2 \\alpha n(x)$。于是，对A子系统势的非加和动能贡献为\n$$\nv_{\\mathrm{nadd}}^{\\mathrm{kin}}[n_{A},n_{B}](x) = \\frac{\\delta}{\\delta n_{A}(x)}\\left( T_{s}[n_{A}+n_{B}] - T_{s}[n_{A}] \\right) = 2 \\alpha n_{B}(x).\n$$\n- 忽略库仑（哈特里）和交换相关项，因此唯一的嵌入贡献是上述非加和动能项。\n- 对于基于投影的嵌入，强制子系统A的轨道与给定的环境轨道 $\\varphi_{B}(x)$ 正交，该环境轨道为单个电子再现了环境密度 $n_{B}(x)$，即 $\\varphi_{B}(x) = \\sqrt{n_{B}(x)}$（实数且非负）。这通过一个强度为 $\\lambda \\ge 0$ 的能级移动投影算符来强制执行，产生一个加和算符 $\\lambda \\hat{P}_{B}$，其中 $\\hat{P}_{B} = |\\varphi_{B}\\rangle \\langle \\varphi_{B}|$。\n\n离散化和算符：\n- 考虑一个长度为 $L$ 的有限一维盒子，在 $x=0$ 和 $x=L$ 处具有狄利克雷边界条件。用一个包含端点的 $N_{\\mathrm{tot}}$ 个点的均匀网格离散化该区间，间距为 $\\Delta x = L/(N_{\\mathrm{tot}}-1)$。仅在 $N = N_{\\mathrm{tot}}-2$ 个内部点 $\\{ x_{i} \\}_{i=1}^{N}$ 上进行计算。\n- 使用标准的二阶三点有限差分近似，在内部网格上离散化动能算符 $T$（对应于 $-\\tfrac{1}{2} \\tfrac{d^{2}}{dx^{2}}$）：\n$$\nT_{ii} = \\frac{1}{\\Delta x^{2}}, \\quad T_{i,i\\pm 1} = -\\frac{1}{2 \\Delta x^{2}}.\n$$\n- 将乘法势 $v(x)$ 表示为对角矩阵 $V = \\mathrm{diag}\\big(v(x_{1}),\\dots,v(x_{N})\\big)$。\n- 将到 $\\varphi_{B}$ 上的能级移动投影算符以离散形式表示为\n$$\nP_{B} = \\Delta x \\, \\boldsymbol{\\varphi}_{B} \\boldsymbol{\\varphi}_{B}^{\\mathsf{T}},\n$$\n其中 $\\boldsymbol{\\varphi}_{B}$ 是值 $\\varphi_{B}(x_{i})$ 构成的向量，经过归一化以满足离散条件 $\\sum_{i=1}^{N} \\varphi_{B}(x_{i})^{2} \\Delta x = 1$。此选择确保 $P_{B} \\boldsymbol{\\varphi}_{B} = \\boldsymbol{\\varphi}_{B}$ 并且 $P_{B}$ 作为相对于 $\\Delta x$ 加权内积的正确投影算符。\n\n子系统要素：\n- 将子系统A的外势定义为一个以 $c_{A}$ 为中心的吸引性高斯势阱：\n$$\nv_{A}^{\\mathrm{ext}}(x) = -V_{0} \\exp\\!\\left( -\\frac{(x-c_{A})^{2}}{2 \\sigma_{v}^{2}} \\right).\n$$\n- 将环境密度 $n_{B}(x)$ 定义为一个以 $c_{B}$ 为中心的归一化高斯函数：\n$$\nn_{B}(x) = \\frac{N_{B}}{\\sqrt{2\\pi} \\sigma_{n}} \\exp\\!\\left( -\\frac{(x-c_{B})^{2}}{2 \\sigma_{n}^{2}} \\right),\n$$\n其中电子数 $N_{B}=1$，通过缩放在有限网格上进行归一化，使得 $\\sum_{i=1}^{N} n_{B}(x_{i}) \\Delta x = 1$。令 $\\varphi_{B}(x) = \\sqrt{n_{B}(x)}$，并根据需要重新归一化以满足上述离散归一化条件。\n\n嵌入哈密顿量和目标量：\n- 用于子系统A的基于势的FDE使用哈密顿量\n$$\nH_{\\mathrm{pot}} = T + \\mathrm{diag}\\!\\big(v_{A}^{\\mathrm{ext}}(x)\\big) + \\mathrm{diag}\\!\\big(2\\alpha \\, n_{B}(x)\\big).\n$$\n- 用于子系统A的基于投影的嵌入使用\n$$\nH_{\\mathrm{proj}} = T + \\mathrm{diag}\\!\\big(v_{A}^{\\mathrm{ext}}(x)\\big) + \\lambda P_{B}.\n$$\n- 令 $\\varepsilon_{\\mathrm{pot}}$ 和 $\\varepsilon_{\\mathrm{proj}}$ 分别表示 $H_{\\mathrm{pot}}$ 和 $H_{\\mathrm{proj}}$ 的最低本征值（基态轨道能量）。计算其差值\n$$\n\\Delta \\varepsilon = \\varepsilon_{\\mathrm{pot}} - \\varepsilon_{\\mathrm{proj}}.\n$$\n\n数值参数和测试套件：\n- 将全局参数固定为 $L = 20.0$，$N_{\\mathrm{tot}} = 220$，$V_{0} = 8.0$，$\\sigma_{v} = 0.6$，$\\sigma_{n} = 0.7$，$\\alpha = 1.0$。将子系统中心对称地放置在盒子中点 $L/2$ 的两侧，间距为 $d$，即 $c_{A} = L/2 - d/2$ 和 $c_{B} = L/2 + d/2$。\n- 对于每个测试用例，您将获得一对参数 $(d,\\lambda)$，并且必须计算 $\\Delta \\varepsilon$（以哈特里为单位的浮点数）。使用以下四个测试用例：\n    1. $(d,\\lambda) = (4.0, 50.0)$。\n    2. $(d,\\lambda) = (10.0, 50.0)$。\n    3. $(d,\\lambda) = (1.5, 50.0)$。\n    4. $(d,\\lambda) = (4.0, 0.0)$。\n这些分别涵盖了中等重叠、弱重叠、强重叠以及无投影的边缘情况。\n\n程序要求：\n- 严格按照上述说明构建离散化的算符，求解两个对称本征值问题以获得每个测试用例的 $\\varepsilon_{\\mathrm{pot}}$ 和 $\\varepsilon_{\\mathrm{proj}}$，并计算 $\\Delta \\varepsilon$。\n- 所有能量均以哈特里表示。您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表的结果（例如，“[$x_{1}$,$x_{2}$,$x_{3}$,$x_{4}$]”），其中每个条目是对应测试用例的浮点数 $\\Delta \\varepsilon$。将每个条目四舍五入到 $6$ 位小数。", "solution": "所呈现的问题是一个有效且适定的量子化学计算练习。它要求在一个简化的一维玩具模型中，对两种不同的嵌入方法——基于势的冻结密度嵌入（FDE）和基于投影的嵌入——进行数值实现和比较。所有参数、方程和数值方案都已明确定义，从而可以得到唯一且可验证的解。该问题在科学上基于子系统密度泛函理论的原理。\n\n目标是为子系统A的两个不同嵌入哈密顿量计算最低轨道能量之间的差异 $\\Delta \\varepsilon = \\varepsilon_{\\mathrm{pot}} - \\varepsilon_{\\mathrm{proj}}$。这里，$\\varepsilon_{\\mathrm{pot}}$ 是基于势的FDE哈密顿量 $H_{\\mathrm{pot}}$ 的最低本征值，而 $\\varepsilon_{\\mathrm{proj}}$ 是基于投影的嵌入哈密顿量 $H_{\\mathrm{proj}}$ 的最低本征值。必须对四个指定的测试用例进行计算，每个用例由一对参数 $(d, \\lambda)$ 定义。\n\n求解方法如下：\n\n首先，我们建立离散化的一维实空间网格。系统被限制在长度为 $L=20.0$ 的盒子中。该域被离散化为 $N_{\\mathrm{tot}}=220$ 个等距点。计算在 $N = N_{\\mathrm{tot}}-2 = 218$ 个内部网格点 $\\{x_i\\}_{i=1}^{N}$ 上进行。网格间距为 $\\Delta x = L / (N_{\\mathrm{tot}}-1)$。内部网格点坐标的向量表示为 $\\mathbf{x}$。\n\n其次，我们在此离散网格上构建算符的矩阵表示。所有矩阵的维度均为 $N \\times N$。\n动能算符 $T = -\\frac{1}{2}\\frac{d^2}{dx^2}$ 使用中心有限差分格式进行离散化，得到一个实对称三对角矩阵 $\\mathbf{T}$，其元素为：\n$$\nT_{ij} =\n\\begin{cases}\n1 / (\\Delta x)^2 & \\text{若 } i=j \\\\\n-1 / (2 (\\Delta x)^2) & \\text{若 } |i-j|=1 \\\\\n0 & \\text{其他情况}\n\\end{cases}\n$$\n\n对于每个由分离距离 $d$ 和投影强度 $\\lambda$ 定义的测试用例，我们构建所需的势和投影算符：\n1.  子系统中心设置为 $c_{A} = L/2 - d/2$ 和 $c_{B} = L/2 + d/2$。\n2.  在每个网格点 $x_i$ 上评估子系统A的外势 $v_{A}^{\\mathrm{ext}}(x) = -V_{0} \\exp(-\\frac{(x-c_{A})^{2}}{2 \\sigma_{v}^{2}})$，形成一个向量 $\\mathbf{v}_{A}^{\\mathrm{ext}}$。这表示为一个对角矩阵 $\\mathbf{V}_{A}^{\\mathrm{ext}} = \\mathrm{diag}(\\mathbf{v}_{A}^{\\mathrm{ext}})$。参数固定为 $V_0=8.0$ 和 $\\sigma_v=0.6$。\n3.  环境密度 $n_{B}(x)$ 建模为以 $c_B$ 为中心、宽度为 $\\sigma_n=0.7$ 的高斯函数。首先在网格上评估它，然后进行数值归一化，使得离散积分 $\\sum_{i=1}^{N} n_{B}(x_i) \\Delta x = 1$。得到的向量表示为 $\\mathbf{n}_{B}$。\n4.  基于势的嵌入贡献由非加和动能势 $v_{\\mathrm{nadd}}^{\\mathrm{kin}}(x) = 2 \\alpha n_{B}(x)$ 定义，其中 $\\alpha=1.0$。这表示为一个对角矩阵 $\\mathbf{V}_{\\mathrm{nadd}}^{\\mathrm{kin}} = \\mathrm{diag}(2 \\alpha \\mathbf{n}_{B})$。\n5.  基于投影的嵌入算符需要环境轨道 $\\boldsymbol{\\varphi}_{B}$ 和相应的投影算符 $\\mathbf{P}_{B}$。轨道定义为 $\\boldsymbol{\\varphi}_{B} = \\sqrt{\\mathbf{n}_{B}}$。由于 $\\mathbf{n}_{B}$ 已经归一化为在 $\\Delta x$ 加权下求和为 $1$，$\\boldsymbol{\\varphi}_{B}$ 自动满足所需的归一化条件 $\\sum_{i=1}^{N} \\varphi_{B}(x_i)^2 \\Delta x = 1$。然后，投影矩阵构造为 $\\mathbf{P}_{B} = \\Delta x \\, \\boldsymbol{\\varphi}_{B} \\boldsymbol{\\varphi}_{B}^{\\mathsf{T}}$，其中 $\\boldsymbol{\\varphi}_{B}^{\\mathsf{T}}$ 是列向量 $\\boldsymbol{\\varphi}_{B}$ 的转置。\n\n第三，我们组装两个哈密顿矩阵：\n基于势的FDE哈密顿量是：\n$$\nH_{\\mathrm{pot}} = \\mathbf{T} + \\mathbf{V}_{A}^{\\mathrm{ext}} + \\mathbf{V}_{\\mathrm{nadd}}^{\\mathrm{kin}} = \\mathbf{T} + \\mathrm{diag}(\\mathbf{v}_{A}^{\\mathrm{ext}} + 2 \\alpha \\mathbf{n}_{B})\n$$\n基于投影的嵌入哈密顿量是：\n$$\nH_{\\mathrm{proj}} = \\mathbf{T} + \\mathbf{V}_{A}^{\\mathrm{ext}} + \\lambda \\mathbf{P}_{B}\n$$\n$H_{\\mathrm{pot}}$ 和 $H_{\\mathrm{proj}}$ 都是实对称矩阵。\n\n第四，我们求解每个哈密顿量的本征值问题。最低本征值 $\\varepsilon_{\\mathrm{pot}}$ 和 $\\varepsilon_{\\mathrm{proj}}$ 对应于每种嵌入方案的基态轨道能量。这些能量通过数值对角化 $H_{\\mathrm{pot}}$ 和 $H_{\\mathrm{proj}}$ 并从所得谱中提取最小本征值来找到。此任务采用标准的对称矩阵数值线性代数程序。\n\n最后，对于每个 $(d, \\lambda)$ 对，目标量计算为差值 $\\Delta \\varepsilon = \\varepsilon_{\\mathrm{pot}} - \\varepsilon_{\\mathrm{proj}}$。对所有四个测试用例重复此过程，以生成最终的结果列表。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the 1D embedding problem for the given test cases.\n    \"\"\"\n\n    # --- Global parameters ---\n    L = 20.0\n    N_tot = 220\n    V0 = 8.0\n    sigma_v = 0.6\n    sigma_n = 0.7\n    alpha = 1.0\n\n    # --- Grid setup ---\n    N = N_tot - 2\n    delta_x = L / (N_tot - 1)\n    x_grid = np.linspace(delta_x, L - delta_x, N)\n\n    # --- Construct Kinetic Energy Matrix T ---\n    diag_val = 1.0 / (delta_x**2)\n    off_diag_val = -0.5 / (delta_x**2)\n    \n    T = (np.diag(np.full(N, diag_val)) + \n         np.diag(np.full(N - 1, off_diag_val), k=1) +\n         np.diag(np.full(N - 1, off_diag_val), k=-1))\n\n    # --- Test cases from the problem statement ---\n    test_cases = [\n        (4.0, 50.0),   # 1. Moderate overlap\n        (10.0, 50.0),  # 2. Weak overlap\n        (1.5, 50.0),   # 3. Strong overlap\n        (4.0, 0.0),    # 4. No projection\n    ]\n\n    results = []\n\n    for d, lam in test_cases:\n        # --- Construct potential- and density-related terms for the current case ---\n        \n        # 1. Subsystem centers\n        c_A = L / 2.0 - d / 2.0\n        c_B = L / 2.0 + d / 2.0\n\n        # 2. Subsystem A external potential vector\n        v_A_ext = -V0 * np.exp(-((x_grid - c_A)**2) / (2.0 * sigma_v**2))\n\n        # 3. Environment density vector n_B (normalized on the grid)\n        n_B_unnormalized = np.exp(-((x_grid - c_B)**2) / (2.0 * sigma_n**2))\n        norm_const_n = np.sum(n_B_unnormalized) * delta_x\n        n_B = n_B_unnormalized / norm_const_n\n\n        # 4. Environment orbital vector phi_B\n        # This is automatically normalized due to n_B's normalization\n        phi_B = np.sqrt(n_B)\n\n        # --- Assemble Hamiltonians ---\n\n        # 1. Potential-based Hamiltonian (H_pot)\n        v_nadd_kin = 2.0 * alpha * n_B\n        H_pot = T + np.diag(v_A_ext + v_nadd_kin)\n\n        # 2. Projection-based Hamiltonian (H_proj)\n        P_B = delta_x * np.outer(phi_B, phi_B)\n        H_proj = T + np.diag(v_A_ext) + lam * P_B\n\n        # --- Solve eigenvalue problems for lowest eigenvalue ---\n        # np.linalg.eigvalsh is efficient for symmetric matrices and returns sorted eigenvalues\n        \n        eps_pot = np.linalg.eigvalsh(H_pot)[0]\n        eps_proj = np.linalg.eigvalsh(H_proj)[0]\n\n        # --- Compute the difference and store the result ---\n        delta_eps = eps_pot - eps_proj\n        results.append(delta_eps)\n\n    # --- Final print statement in the exact required format ---\n    print(f\"[{','.join(f'{r:.6f}' for r in results)}]\")\n\nsolve()\n```", "id": "2893048"}]}