{"hands_on_practices": [{"introduction": "为了精确模拟大型分子体系，我们常常需要将量子力学（$QM$）的精度与分子力学（$MM$）的效率相结合。本练习将引导你推导双层ONIOM方法的核心公式——这是一种广泛应用的 $QM/MM$ 方案——并用它来计算一个反应能。这项实践旨在巩固你对“相减方案”的理解，这是估算大型体系高精度能量的基石。[@problem_id:2918475]", "problem": "在玻恩–奥本海默近似中，化学反应能是产物和反应物的电子能量之差，该能量在单一势能面上进行评估。考虑在我们自己发展的 N 层积分分子轨道和分子力学（ONIOM）框架内的一个双层方案，其中两层都用量子力学方法处理：一个高水平的量子力学方法用于嵌入在更大的“真实”系统中的一个小的“模型”子系统，以及一个低水平的量子力学方法用于整个“真实”系统。其目标是通过组合少量可计算的量来近似整个“真实”系统的未知高水平电子能量。\n\n从玻恩–奥本海默近似下的能量加和性第一性原理出发，并假设高水平和低水平方法之间的差异主要局限于模型子系统，推导出一个闭合形式的表达式，用以表示“真实”系统的 ONIOM 双层总能量。该表达式应以三个可计算的能量来表示：即“真实”系统的低水平能量，以及“模型”系统的高水平和低水平能量。清晰地陈述您为得出公式所引用的任何局域性或可转移性假设，并简要解释在推导过程中如何处理边界饱和（例如，使用连接原子）。\n\n然后，使用您推导出的表达式计算转化\n$$\\text{R} \\longrightarrow \\text{P}$$\n的反应能，其定义为\n$$\\Delta E \\equiv E(\\text{P}) - E(\\text{R}),$$\n其中每个物种的能量都由您推导出的双层量子力学/量子力学 ONIOM 构造计算得出。在各自的几何构型下，已获得以下单点电子能量（单位均为 Hartree）：\n\n- 对于反应物 $\\text{R}$：\n  - 真实系统上的低水平能量：$E_{\\mathrm{L}}^{\\mathrm{real}}(\\text{R}) = -1500.000000$\n  - 模型系统上的低水平能量：$E_{\\mathrm{L}}^{\\mathrm{model}}(\\text{R}) = -399.500000$\n  - 模型系统上的高水平能量：$E_{\\mathrm{H}}^{\\mathrm{model}}(\\text{R}) = -400.000000$\n\n- 对于产物 $\\text{P}$：\n  - 真实系统上的低水平能量：$E_{\\mathrm{L}}^{\\mathrm{real}}(\\text{P}) = -1499.980000$\n  - 模型系统上的低水平能量：$E_{\\mathrm{L}}^{\\mathrm{model}}(\\text{P}) = -399.515000$\n  - 模型系统上的高水平能量：$E_{\\mathrm{H}}^{\\mathrm{model}}(\\text{P}) = -400.020000$\n\n假设在高水平和低水平的模型计算之间，所有连接原子的定义和边界处理都是一致的。使用转换关系 $1$ Hartree $= 2{,}625.499$ kJ mol$^{-1}$。将最终的反应能 $\\Delta E$ 以 kJ mol$^{-1}$ 表示，并将您的答案四舍五入到四位有效数字。", "solution": "所述问题是有效的。它在科学上基于量子化学原理，特别是 ONIOM（我们自己发展的 N 层积分分子轨道和分子力学）多层方法。该问题提法恰当、客观，并包含推导所要求的表达式和计算最终数值答案所需的所有信息。\n\n目标是在双层 QM/QM ONIOM 框架内，推导“真实”系统总能量 $E_{\\mathrm{ONIOM}}$ 的表达式。这个能量是在高水平理论下计算整个真实系统能量的一个近似值，而直接计算该能量在计算上是难以承受的，我们将其表示为 $E_{\\mathrm{H}}^{\\mathrm{real}}$。推导过程从 ONIOM 方法的基本假设出发。\n\n令“真实”系统代表整个感兴趣的分子系统，“模型”系统是真实系统中一个特定的、具有化学活性的子集。令 $E_{\\mathrm{H}}$ 表示用高水平、精确的量子力学方法计算的能量，$E_{\\mathrm{L}}$ 表示用低水平、计算成本较低的量子力学方法计算的能量。\n\n减法 ONIOM 方案的核心假设基于可转移性和局域性原理。它假设将理论水平从低水平提高到高水平所产生的能量校正，主要由模型系统内部的电子结构效应所主导。换句话说，改进的理论对环境（真实系统中不属于模型系统的部分）的影响可以忽略不计。这可以通过将真实系统的能量校正与模型系统的能量校正等同起来，用数学方式表示为：\n$$E_{\\mathrm{H}}^{\\mathrm{real}} - E_{\\mathrm{L}}^{\\mathrm{real}} \\approx E_{\\mathrm{H}}^{\\mathrm{model}} - E_{\\mathrm{L}}^{\\mathrm{model}}$$\n这个方程表明，无论是对完整的“真实”系统还是仅对“模型”子系统进行计算，从低水平理论转向高水平理论时能量的变化是近似相等的。\n\n所求的 ONIOM 能量 $E_{\\mathrm{ONIOM}}$ 是对未知的真实系统高水平能量 $E_{\\mathrm{H}}^{\\mathrm{real}}$ 的最佳近似。通过重新排列上述近似式，我们直接得到双层 ONIOM 能量的闭合形式表达式：\n$$E_{\\mathrm{ONIOM}} \\equiv E_{\\mathrm{H}}^{\\mathrm{real}} \\approx E_{\\mathrm{L}}^{\\mathrm{real}} + E_{\\mathrm{H}}^{\\mathrm{model}} - E_{\\mathrm{L}}^{\\mathrm{model}}$$\n该表达式结合了三个可计算的量：整个真实系统的低水平能量（$E_{\\mathrm{L}}^{\\mathrm{real}}$），以及较小模型系统的高水平和低水平能量（分别为 $E_{\\mathrm{H}}^{\\mathrm{model}}$ 和 $E_{\\mathrm{L}}^{\\mathrm{model}}$）。\n\n该方法的一个关键方面是处理模型系统与其环境之间的边界。当为定义模型系统而切断共价键时，边界处原子的价态必须被饱和。这通常通过向模型系统添加“连接原子”（例如氢原子）来实现。因此，能量 $E_{\\mathrm{H}}^{\\mathrm{model}}$ 和 $E_{\\mathrm{L}}^{\\mathrm{model}}$ 是为包含这些连接原子的“带帽”模型系统计算的。ONIOM 表达式的有效性依赖于这样一个假设：这些人为的连接原子所引入的能量和电子赝象在高水平和低水平理论下是相似的。因此，它们的贡献在差值项 $(E_{\\mathrm{H}}^{\\mathrm{model}} - E_{\\mathrm{L}}^{\\mathrm{model}})$ 中大部分被抵消。问题中关于边界处理一致的条件确保了这种抵消得到妥善处理。\n\n我们现在应用这个推导出的公式来计算转化 $\\text{R} \\longrightarrow \\text{P}$ 的反应能 $\\Delta E$。反应能定义为 $\\Delta E = E(\\text{P}) - E(\\text{R})$。\n\n首先，我们使用给定的数据计算反应物 $\\text{R}$ 的 ONIOM 能量：\n$$E_{\\mathrm{ONIOM}}(\\text{R}) = E_{\\mathrm{L}}^{\\mathrm{real}}(\\text{R}) + E_{\\mathrm{H}}^{\\mathrm{model}}(\\text{R}) - E_{\\mathrm{L}}^{\\mathrm{model}}(\\text{R})$$\n代入以 Hartree 为单位的数值：\n$$E_{\\mathrm{ONIOM}}(\\text{R}) = -1500.000000 + (-400.000000) - (-399.500000)$$\n$$E_{\\mathrm{ONIOM}}(\\text{R}) = -1500.000000 - 0.500000 = -1500.500000 \\text{ Hartree}$$\n\n接下来，我们计算产物 $\\text{P}$ 的 ONIOM 能量：\n$$E_{\\mathrm{ONIOM}}(\\text{P}) = E_{\\mathrm{L}}^{\\mathrm{real}}(\\text{P}) + E_{\\mathrm{H}}^{\\mathrm{model}}(\\text{P}) - E_{\\mathrm{L}}^{\\mathrm{model}}(\\text{P})$$\n代入以 Hartree 为单位的数值：\n$$E_{\\mathrm{ONIOM}}(\\text{P}) = -1499.980000 + (-400.020000) - (-399.515000)$$\n$$E_{\\mathrm{ONIOM}}(\\text{P}) = -1499.980000 - 0.505000 = -1500.485000 \\text{ Hartree}$$\n\n以 Hartree 为单位的反应能 $\\Delta E$ 是产物能量与反应物能量之差：\n$$\\Delta E = E_{\\mathrm{ONIOM}}(\\text{P}) - E_{\\mathrm{ONIOM}}(\\text{R})$$\n$$\\Delta E = -1500.485000 - (-1500.500000) = 0.015000 \\text{ Hartree}$$\n\n最后，我们按要求将此能量转换为 kJ mol$^{-1}$ 并四舍五入到四位有效数字。\n使用换算因子 $1 \\text{ Hartree} = 2625.499 \\text{ kJ mol}^{-1}$：\n$$\\Delta E (\\text{kJ mol}^{-1}) = 0.015000 \\text{ Hartree} \\times 2625.499 \\frac{\\text{kJ mol}^{-1}}{\\text{Hartree}}$$\n$$\\Delta E \\approx 39.382485 \\text{ kJ mol}^{-1}$$\n将此结果四舍五入到四位有效数字，得到 $39.38$。", "answer": "$$\n\\boxed{39.38}\n$$", "id": "2918475"}, {"introduction": "在理解了理论上的ONIOM公式后，下一个关键步骤是将其应用于真实分子，即正确地划分体系。本练习要求你为一个二肽分子定义 $QM$（模型）区和 $MM$（真实）区，并为被切断的共价键确定恰当的“连接原子”处理方法。熟练掌握这一过程对于建立有意义且物理上合理的 $QM/MM$ 模拟至关重要。[@problem_id:2918482]", "problem": "您计划对一个中性、气相、带封端的二肽——乙酰-甘氨酰-丙氨酸 N-甲基酰胺，进行一次双层“我们自己整合的N层分子轨道和分子力学方法”（ONIOM）的量子力学/分子力学 (QM/MM) 计算，其中乙酰基 (Ace) 封住N端，N-甲基酰胺 (NMe) 封住C端。计算的目的是用量子力学水平处理中心肽键区域，而用分子力学力场描述其余部分。基于以下基本原理和经过充分检验的事实：(i) 多层相减方案要求模型体系是真实体系的真子集，以便将高水平计算的能量转移到真实体系的相应部分而不会产生重复计算；(ii) 当在层与层之间切断一个共价键时，必须通过一个连接原子来满足量子力学边界原子的价态，该连接原子沿原始键方向放置，并具有化学上合理的键长，以近似缺失的σ键；以及 (iii) 为了最大限度地减少伪影，应避免切断高极性键，并应一致地处理边界附近的静电，以使量子区域不会因代表已被连接原子取代的原子的点电荷而过度极化。请选择最恰当地定义真实体系和模型体系，并为此体系指定所需连接原子处理方法的选项。\n\n哪个选项最合适？\n\nA. 真实体系是完整的Ace–Gly–Ala–NMe分子。模型体系是连接甘氨酸和丙氨酸的中心酰胺基团，包括羰基$\\mathrm{C}$和$\\mathrm{O}$、酰胺$\\mathrm{N}$及其连接的$\\mathrm{H}$，以及两个$\\mathrm{C_{\\alpha}}$原子。在丙氨酸$\\mathrm{C_{\\alpha}}$–$\\mathrm{C_{\\beta}}$键被切断处放置一个氢连接原子，该原子与原始键共线，并保持典型的$\\mathrm{C}$–$\\mathrm{H}$距离$r_{\\mathrm{C{-}H}}$。在电子嵌入中，被截断的$\\mathrm{C_{\\beta}}$上的分子力学点电荷被移除或重新分布到其邻近原子上，以避免极化的重复计算。\n\nB. 真实体系是完整的Ace–Gly–Ala–NMe分子。模型体系仅为不含任何$\\mathrm{C_{\\alpha}}$原子的最小酰胺片段$\\mathrm{CONH}$。添加两个氢连接原子，一个在羰基$\\mathrm{C}$上以取代甘氨酸的$\\mathrm{C_{\\alpha}}$，另一个在酰胺$\\mathrm{N}$上以取代丙氨酸的$\\mathrm{C_{\\alpha}}$。所有分子力学原子的静电保持不变，以最大化量子区域的极化。\n\nC. 真实体系仅为中心酰胺片段。模型体系是整个Ace–Gly–Ala–NMe分子。不需要连接原子，因为模型体系包含了真实体系。\n\nD. 真实体系是完整的Ace–Gly–Ala–NMe分子。模型体系是包含两个$\\mathrm{C_{\\alpha}}$原子的中心酰胺基团。在被切断的$\\mathrm{C_{\\alpha}}$–$\\mathrm{C_{\\beta}}$键处使用一个重原子“连接碳”代替氢，并放置在原始的$\\mathrm{C}$–$\\mathrm{C}$距离处。在电子嵌入下，被截断的$\\mathrm{C_{\\beta}}$上的分子力学点电荷保持不变，以保留原始电场。\n\nE. 真实体系是完整的Ace–Gly–Ala–NMe分子。模型体系是整个肽主链，从乙酰基的羰基到N-甲基酰胺的酰胺氮，不包括两个侧链。不需要连接原子，因为肽主链在模型区域内是连续的。", "solution": "该问题要求根据ONIOM方法的基本原理，为封端二肽乙酰-甘氨酰-丙氨酸 N-甲基酰胺 (`Ace-Gly-Ala-NMe`) 选择最合适的“我们自己整合的N层分子轨道和分子力学方法”（ONIOM）的量子力学/分子力学 (QM/MM) 设置。计算的目标是用量子力学(QM)处理中心肽键区域，用分子力学(MM)处理分子的其余部分。\n\n首先，我们分析该分子的结构：\n二肽`Ace-Gly-Ala-NMe`的化学结构为：\n`CH_3-C(=O)-[NH-CH_2-C(=O)]_{Gly}-[NH-CH(CH_3)-C(=O)]_{Ala}-NH-CH_3`\n\n问题中所述的ONIOM方法的核心原理是：\n(i) 相减方案基于以下能量表达式：\n$$E_{\\text{ONIOM}} = E(\\text{low, real}) + E(\\text{high, model}) - E(\\text{low, model})$$\n此处，“real”（真实体系）指整个分子（`Ace-Gly-Ala-NMe`），“model”（模型体系）指包含目标区域的化学饱和片段，“low”（低水平）指低水平理论（MM），“high”（高水平）指高水平理论（QM）。要求模型体系必须是真实体系的真子集。\n\n(ii) 当QM原子和MM原子之间的共价键被切断时，QM原子的价态必须被饱和。这通常通过添加一个“连接原子”（最常见的是氢原子 $H$）来完成，该原子沿着被切断的键的方向放置。这样就为QM计算创建了一个化学上完整的模型体系。\n\n(iii) QM区域和MM点电荷之间的静电相互作用必须小心处理以避免伪影。在“电子嵌入”方案中，QM计算在MM原子点电荷存在的情况下进行。为防止不真实的极化，与连接原子直接相连的MM原子的点电荷通常被设为零或重新分布到附近的其他MM原子上。这是因为连接原子在电子上取代了那个MM原子，如果包含其电荷，将是一种静电效应的重复计算。也应避免切断高极性键。\n\n基于这些原理，我们将评估每个选项。\n\n**A. 真实体系是完整的Ace–Gly–Ala–NMe分子。模型体系是连接甘氨酸和丙氨酸的中心酰胺基团，包括羰基$\\mathrm{C}$和$\\mathrm{O}$、酰胺$\\mathrm{N}$及其连接的$\\mathrm{H}$，以及两个$\\mathrm{C_{\\alpha}}$原子。在丙氨酸$\\mathrm{C_{\\alpha}}$–$\\mathrm{C_{\\beta}}$键被切断处放置一个氢连接原子，该原子与原始键共线，并保持典型的$\\mathrm{C}$–$\\mathrm{H}$距离$r_{\\mathrm{C{-}H}}$。在电子嵌入中，被截断的$\\mathrm{C_{\\beta}}$上的分子力学点电荷被移除或重新分布到其邻近原子上，以避免极化的重复计算。**\n\n- **真实体系：** 真实体系被正确地确定为整个分子。这与原理(i)一致。\n- **模型体系划分：** 目标区域被描述为`...Cα(Gly)-C(=O)-N(H)-Cα(Ala)...`。选择切断丙氨酸的`Cα-Cβ`键是一个极好的选择。该键是一个非极性的`C-C`单键，切断它可以最大限度地减少电子扰动，符合源于原理(iii)的最佳实践。选项描述了在`Cα(Ala)-Cβ(Ala)`切断处使用一个氢连接原子。这意味着一个特定的划分方案，其中唯一移到MM层的分子部分是丙氨酸侧链 (`-CH_3`)。要实现只需要一个*单一*连接原子，模型体系必须是分子的其余全部：`Ace-Gly-Ala(sidechain->H)-NMe`。这个模型体系是`Ace-Gly-Gly-NMe`。这是一个化学上合理且常见的划分策略。选项中对模型体系的描述“中心酰胺基团……”是对该划分方案旨在研究的*目标区域*的不精确但概念上合理的描述。实际的计算模型体系是通过对真实体系进行一次切割和一个连接原子得到的。\n- **静电处理：** 按照原理(iii)，移除或重新分布`Cβ`原子（与QM边界原子`Cα`相邻的MM原子）上的电荷的规定是至关重要且正确的，以避免过度极化QM区域。\n- **结论：** 此选项准确描述了一个有效且理由充分的ONIOM划分方案。处理共价边界（`Cα-Cβ`切割）和相关静电学的程序是教科书般正确的。尽管对模型体系的描述略有模糊，但这并不影响所述程序的正确性。与其他选项相比，此选项最符合所有原理。**正确**。\n\n**B. 真实体系是完整的Ace–Gly–Ala–NMe分子。模型体系仅为不含任何$\\mathrm{C_{\\alpha}}$原子的最小酰胺片段$\\mathrm{CONH}$。添加两个氢连接原子，一个在羰基$\\mathrm{C}$上以取代甘氨酸的$\\mathrm{C_{\\alpha}}$，另一个在酰胺$\\mathrm{N}$上以取代丙氨酸的$\\mathrm{C_{\\alpha}}$。所有分子力学原子的静电保持不变，以最大化量子区域的极化。**\n\n- **模型体系划分：** 选择最小的`CONH`片段通常是糟糕的。$\\mathrm{C_{\\alpha}}$原子在电子学和空间结构上都是肽键性质的组成部分，因此将它们从QM区域中排除对于研究该区域不是一个化学上合理的选择。\n- **静电处理：** “所有分子力学原子的静电保持不变”的说法是根本错误的。这将意味着保留现在与连接原子相邻的$\\mathrm{C_{\\alpha}}$原子上的部分电荷。这会在边界处产生巨大的人为偶极，并导致QM电子密度的严重过度极化，直接违反了原理(iii)。其目标不是“最大化极化”，而是物理上真实地表示它。\n- **结论：** 此选项提出了一个糟糕的模型体系和一种违反原理(iii)的错误静电处理方法。**不正确**。\n\n**C. 真实体系仅为中心酰胺片段。模型体系是整个Ace–Gly–Ala–NMe分子。不需要连接原子，因为模型体系包含了真实体系。**\n\n- **真实体系和模型体系的定义：** 此选项颠倒了定义。根据原理(i)，模型体系（高水平）必须是真实体系（低水平）的子集。这里，“真实”体系被定义为一个片段，而“模型”体系是整个分子。这是对ONIOM相减方案的基本误解。\n- **结论：** 此选项违反了原理(i)所述的ONIOM方法的基本定义。**不正确**。\n\n**D. 真实体系是完整的Ace–Gly–Ala–NMe分子。模型体系是包含两个$\\mathrm{C_{\\alpha}}$原子的中心酰胺基团。在被切断的$\\mathrm{C_{\\alpha}}$–$\\mathrm{C_{\\beta}}$键处使用一个重原子“连接碳”代替氢，并放置在原始的$\\mathrm{C}$–$\\mathrm{C}$距离处。在电子嵌入下，被截断的$\\mathrm{C_{\\beta}}$上的分子力学点电荷保持不变，以保留原始电场。**\n\n- **连接原子处理：** 使用专门的“重原子”连接原子是一种有效但不太常见的技术。这部分是可信的。\n- **静电处理：** 如同选项B，“被截断的`Cβ`上的分子力学点电荷保持不变”的说法是不正确的。它违反了原理(iii)，并导致在QM/MM边界处产生不真实的过度极化。声称这能“保留原始电场”是一种误解；它引入了一个显著的伪影。\n- **结论：** 此选项提出了一种不正确的静电处理方法，使其无效。**不正确**。\n\n**E. 真实体系是完整的Ace–Gly–Ala–NMe分子。模型体系是整个肽主链，从乙酰基的羰基到N-甲基酰胺的酰胺氮，不包括两个侧链。不需要连接原子，因为肽主链在模型区域内是连续的。**\n\n- **模型体系划分：** 将整个主链视为QM区域的想法是合理的。“不包括两个侧链”意味着切断与丙氨酸侧链（`-CH_3`）的键。甘氨酸的侧链只是一个氢原子，所以那里不需要切割。\n- **连接原子处理：** “不需要连接原子”的说法是错误的。切断丙氨酸中的`Cα-Cβ`键会使`Cα`原子的价态不饱和。根据原理(ii)，必须使用一个连接原子来创建一个化学上有效、适合QM计算的闭壳层模型体系。其理由“因为肽主链是连续的”与一个非主链键被切断的事实无关。\n- **结论：** 此选项对连接原子的需求做出了事实性错误的陈述，违反了原理(ii)。**不正确**。\n\n**结论：**\n选项B、C、D和E都包含根本上不正确且违反问题陈述中提供的QM/MM计算原理的陈述。选项A描述的划分选择（`Cα-Cβ`切割）、连接原子策略（H-link）和静电嵌入方案（电荷移除/重新分布）都完全符合既定的最佳实践和给定的原理。尽管其对分子体系的描述略有不精确，但其概述的程序是正确的。因此，它是最合适的选项。", "answer": "$$\\boxed{A}$$", "id": "2918482"}, {"introduction": "在 $QM/MM$ 边界处选择切断哪根共价键，对模拟的准确性有显著影响。这个高级练习超越了定性的指导原则，引入一个量化模型来评估不同切分方案所引入的误差。通过基于力学耦合推导和应用一个误差公式，你将掌握一种选择最优边界的系统性方法，这是进行高精度 $QM/MM$ 研究的一项关键技能。[@problem_id:2918494]", "problem": "您将使用一个基于小分子酰胺的线性弹性代理模型，来模拟在蛋白质主链的量子力学/分子力学（QM/MM）边界处切割哪个共价键的选择。其目的在于为选择切割哪个键提供一个有原则的、定量的方案，并估算因使用带连接原子的机械嵌入而产生的预期能量误差。该代理模型由两个耦合的一维内坐标组成：“QM侧”坐标 $x$ 和“MM侧”坐标 $y$。总势能由一个双线性谐波形式建模：\n$$\nV(x,y) = \\tfrac{1}{2} k_{q} x^2 + \\tfrac{1}{2} k_{m} y^2 + k_{c} x y,\n$$\n其中，$k_{q}$ 是跨越切割处的主导QM内坐标的刚度，$k_{m}$ 是切割处另一侧的主导MM内坐标的刚度，$k_{c}$ 是耦合常数，它编码了切割处两侧的内运动如何进行机械耦合。所有坐标都是相对于平衡几何构型测量的，因此在 $x = 0$ 和 $y = 0$ 时线性项为零。此谐波模型是一种标准的小位移近似，其合理性可通过将势能面在最小值点附近进行二阶泰勒(Taylor)展开来证明。\n\n假设“完整”参考对应于完全耦合系统，在该系统中，$x$ 按一个小的预设振幅 $A$（单位为埃）发生位移，而 $y$ 则可以弛豫以使该固定 $x$ 下的总能量最小化。相比之下，带有连接原子的机械嵌入切割被建模为移除耦合项，并在估算所选 $x = A$ 处的能量代价时，将 $y$ 保持在其参考（平衡）值。设能量误差为在相同位移 $x = A$ 下，切割模型能量与完全耦合弛豫能量之间的差值：\n$$\n\\Delta E(A; k_{q}, k_{m}, k_{c}) \\equiv V_{\\text{cut}}(A) - V_{\\text{full-relaxed}}(A).\n$$\n\n任务1（推导）：从上面 $V(x,y)$ 的定义以及机械嵌入切割通过移除耦合项并将 $y$ 固定在其平衡值来表示的规则出发，推导出一个关于 $A$、$k_{m}$ 和 $k_{c}$ 的 $\\Delta E(A; k_{q}, k_{m}, k_{c})$ 的闭式表达式。通过在固定 $x$ 的情况下明确地对耦合能量关于 $y$ 进行最小化来证明每一步的合理性，并明确说明哪些项因模型假设而抵消。您的推导应从势能定义和基础微积分开始，不应假定任何预先推导的有效势公式。\n\n任务2（方案）：利用您推导的表达式以及 $k_{q}$、$k_{m}$ 和 $k_{c}$ 的物理解释，阐述一个通用的决策规则（方案），用于在肽或蛋白质的QM/MM划分中选择切割哪个主链键。您的方案必须用可从小分子酰胺代理模型直接估算的量来陈述，并且必须由您的推导来证明。解释从代理模型中提取的 $x$ 和 $y$ 之间的非对角海森矩阵元以及沿 $y$ 的对角海森矩阵元如何分别映射到 $k_{c}$ 和 $k_{m}$。\n\n任务3（计算）：实现推导出的 $\\Delta E(A; k_{q}, k_{m}, k_{c})$ 公式，并为以下测试套件进行评估。对于每个测试用例，计算并报告能量误差，单位为千焦/摩尔，四舍五入到六位小数。对于最后一个测试，通过应用您的方案以最小化预测误差，报告前三个候选切割中推荐的切割索引（从零开始）。\n\n使用以下单位：$k_{q}$ 单位为 $\\text{kJ mol}^{-1} \\text{\\AA}^{-2}$，$k_{m}$ 单位为 $\\text{kJ mol}^{-1} \\text{\\AA}^{-2}$，$k_{c}$ 单位为 $\\text{kJ mol}^{-1} \\text{\\AA}^{-2}$，位移振幅 $A$ 单位为 $\\text{\\AA}$，能量误差 $\\Delta E$ 单位为 $\\text{kJ mol}^{-1}$。角度单位不适用。\n\n测试套件：\n- 用例1（候选切割 $\\mathrm{N{-}C_{\\alpha}}$ 键）：$k_{q} = 400$, $k_{m} = 350$, $k_{c} = 30$, $A = 0.1$。\n- 用例2（候选切割 $\\mathrm{C_{\\alpha}{-}C}$ 键）：$k_{q} = 450$, $k_{m} = 300$, $k_{c} = 50$, $A = 0.1$。\n- 用例3（候选切割酰胺 $\\mathrm{C{-}N}$ 键，通常不推荐）：$k_{q} = 500$, $k_{m} = 320$, $k_{c} = 120$, $A = 0.1$。\n- 用例4（零耦合的边界情况）：$k_{q} = 400$, $k_{m} = 300$, $k_{c} = 0$, $A = 0.15$。\n- 用例5（MM区域非常刚性的边界情况）：$k_{q} = 400$, $k_{m} = 2000$, $k_{c} = 80$, $A = 0.2$。\n- 用例6（从前三个中选择）：根据您的方案，为使预测的 $\\Delta E$ 最小化，输出用例1-3中切割位置的索引，该索引在 $\\{0,1,2\\}$ 中。\n\n最终输出格式：您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果。该列表必须包含六个条目，按顺序对应于用例1到6。前五个条目必须是浮点数能量误差（单位 $\\text{kJ mol}^{-1}$），每个都四舍五入到六位小数。第六个条目必须是用例6的整数索引。例如，一个有效的输出应如下所示：\n`[0.012345,0.067890,0.123456,0.000000,0.010000,1]`。", "solution": "该问题在科学上是合理且定义明确的。它利用了标准的谐波近似来模拟平衡几何构型附近的势能面，这是化学物理中的一项基本技术。所有参数和目标都定义清晰。我们将继续进行推导和求解。\n\n分析分为三个任务：能量误差的推导、选择QM/MM切割的决策规则的制定，以及特定案例的数值计算。\n\n任务1：能量误差表达式的推导\n耦合双坐标系统的势能由下式给出：\n$$\nV(x,y) = \\tfrac{1}{2} k_{q} x^2 + \\tfrac{1}{2} k_{m} y^2 + k_{c} x y\n$$\n这里，$x$ 和 $y$ 是偏离平衡位置的位移，因此平衡几何构型对应于 $x=0$ 和 $y=0$。\n\n首先，我们确定完全耦合系统的能量 $V_{\\text{full-relaxed}}(A)$。这对应于一个状态，其中QM侧坐标固定在位移 $x=A$ 处，而MM侧坐标 $y$ 则弛豫以最小化总势能。为了找到 $y$ 的弛豫值，记为 $y_{\\text{relax}}$，我们必须在固定 $x$ 的情况下求解 $V(x,y)$ 关于 $y$ 的驻点。这可以通过将 $V$ 关于 $y$ 的偏导数设为零来实现：\n$$\n\\frac{\\partial V(x,y)}{\\partial y} = \\frac{\\partial}{\\partial y} (\\tfrac{1}{2} k_{q} x^2 + \\tfrac{1}{2} k_{m} y^2 + k_{c} x y) = 0 + k_{m} y + k_{c} x\n$$\n将此导数设为零，得到 $y$ 弛豫位置的条件：\n$$\nk_{m} y_{\\text{relax}} + k_{c} x = 0\n$$\n解出 $y_{\\text{relax}}$ 作为 $x$ 的函数：\n$$\ny_{\\text{relax}}(x) = -\\frac{k_{c}}{k_{m}} x\n$$\n对于任何给定的位移 $x$，完全弛豫系统的能量可以通过将 $y_{\\text{relax}}(x)$ 代回原始势能函数 $V(x,y)$ 来找到：\n$$\nV_{\\text{full-relaxed}}(x) = V(x, y_{\\text{relax}}(x)) = \\tfrac{1}{2} k_{q} x^2 + \\tfrac{1}{2} k_{m} \\left(-\\frac{k_{c}}{k_{m}} x\\right)^2 + k_{c} x \\left(-\\frac{k_{c}}{k_{m}} x\\right)\n$$\n简化各项：\n$$\nV_{\\text{full-relaxed}}(x) = \\tfrac{1}{2} k_{q} x^2 + \\tfrac{1}{2} k_{m} \\frac{k_{c}^2}{k_{m}^2} x^2 - \\frac{k_{c}^2}{k_{m}} x^2\n$$\n$$\nV_{\\text{full-relaxed}}(x) = \\tfrac{1}{2} k_{q} x^2 + \\frac{k_{c}^2}{2 k_{m}} x^2 - \\frac{2k_{c}^2}{2 k_{m}} x^2\n$$\n这简化为坐标 $x$ 的有效一维势：\n$$\nV_{\\text{full-relaxed}}(x) = \\tfrac{1}{2} k_{q} x^2 - \\frac{k_{c}^2}{2 k_{m}} x^2 = \\frac{1}{2} \\left(k_{q} - \\frac{k_{c}^2}{k_{m}}\\right) x^2\n$$\n项 $-\\frac{k_{c}^2}{2k_m}x^2$ 代表弛豫能。在指定位移 $x=A$ 处计算此能量：\n$$\nV_{\\text{full-relaxed}}(A) = \\tfrac{1}{2} k_{q} A^2 - \\frac{k_{c}^2}{2 k_{m}} A^2\n$$\n接下来，我们确定“切割”模型的能量 $V_{\\text{cut}}(A)$。问题陈述该模型涉及移除耦合项 $k_{c}xy$ 并将MM侧坐标 $y$ 固定在其平衡值，即 $y=0$。因此，切割模型的势能为：\n$$\nV_{\\text{cut-model}}(x,y) = \\tfrac{1}{2} k_{q} x^2 + \\tfrac{1}{2} k_{m} y^2\n$$\n能量 $V_{\\text{cut}}(A)$ 是该势能在 $x=A$ 和 $y=0$ 处的值：\n$$\nV_{\\text{cut}}(A) = V_{\\text{cut-model}}(A, 0) = \\tfrac{1}{2} k_{q} A^2 + \\tfrac{1}{2} k_{m} (0)^2 = \\tfrac{1}{2} k_{q} A^2\n$$\n最后，能量误差 $\\Delta E$ 是这两个能量之间的差值：\n$$\n\\Delta E(A; k_{q}, k_{m}, k_{c}) = V_{\\text{cut}}(A) - V_{\\text{full-relaxed}}(A)\n$$\n代入推导出的表达式：\n$$\n\\Delta E = \\left(\\tfrac{1}{2} k_{q} A^2\\right) - \\left(\\tfrac{1}{2} k_{q} A^2 - \\frac{k_{c}^2}{2 k_{m}} A^2\\right)\n$$\n项 $\\tfrac{1}{2} k_{q} A^2$（代表孤立地使QM侧坐标位移的能量）相互抵消。这种抵消是问题定义的直接结果，表明误差完全源于忽略与QM系统耦合的MM系统的弛豫。最终得到的能量误差闭式表达式为：\n$$\n\\Delta E = \\frac{k_{c}^2 A^2}{2 k_{m}}\n$$\n该表达式仅取决于位移振幅 $A$、耦合常数 $k_{c}$ 和MM侧坐标的刚度 $k_{m}$。值得注意的是，QM侧坐标的刚度 $k_{q}$ 对此误差度量没有贡献。\n\n任务2：键切割的决策规则（方案）\n一个好的QM/MM划分方案的目标是最小化由边界引入的人为能量效应。在我们的模型中，这对应于最小化由机械嵌入引起的能量误差 $\\Delta E$。从推导的公式 $\\Delta E = \\frac{k_{c}^2 A^2}{2 k_{m}}$ 中，我们可以看到，对于一个典型的、非零的位移 $A$，误差由比率 $\\frac{k_{c}^2}{k_{m}}$ 决定。\n\n因此，从一组候选切割中选择最优切割的定量方案是：\n**对于每个候选的键切割，从一个合适的小分子代理模型（例如，像N-甲基乙酰胺这样的酰胺）中估算耦合常数 $k_{c}$ 和MM侧刚度 $k_{m}$。计算判据 $\\frac{k_{c}^2}{k_{m}}$。优先选择的切割是使该值最小化的那个。**\n\n该方案是合理的，因为对于任何给定的沿QM侧坐标的扰动，较小的 $\\frac{k_{c}^2}{k_{m}}$ 值直接导致较小的能量误差。一个小的耦合 $k_{c}$ 意味着两侧在机械上是解耦的，因此切割键的影响很小。一个大的MM侧刚度 $k_{m}$ 意味着MM区域非常刚性，即使存在耦合，其弛豫程度也很小，这同样导致较小的误差。\n\n为了将 $k_c$ 和 $k_m$ 与标准的计算化学输出联系起来，我们考虑势能的海森(Hessian)矩阵，即二阶偏导数矩阵。对于势能 $V(x,y)$，在坐标 $(x,y)$ 基下的海森矩阵 $H$ 是：\n$$\nH = \\begin{pmatrix} \\frac{\\partial^2 V}{\\partial x^2} & \\frac{\\partial^2 V}{\\partial x \\partial y} \\\\ \\frac{\\partial^2 V}{\\partial y \\partial x} & \\frac{\\partial^2 V}{\\partial y^2} \\end{pmatrix}\n$$\n计算 $V(x,y)$ 的二阶导数：\n- $\\frac{\\partial^2 V}{\\partial x^2} = k_{q}$\n- $\\frac{\\partial^2 V}{\\partial y^2} = k_{m}$\n- $\\frac{\\partial^2 V}{\\partial x \\partial y} = k_{c}$\n所以，海森矩阵是：\n$$\nH = \\begin{pmatrix} k_{q} & k_{c} \\\\ k_{c} & k_{m} \\end{pmatrix}\n$$\n由此可见：\n- 参数 $k_{m}$ 是对应于MM侧坐标 $y$ 的海森矩阵的对角元，通常表示为 $H_{yy}$ 或 $H_{22}$。这是该坐标的力常数。\n- 参数 $k_{c}$ 是耦合坐标 $x$ 和 $y$ 的海森矩阵的非对角元，表示为 $H_{xy}$ 或 $H_{12}$。\n\n因此，该方案可以用为代理分子计算的海森矩阵元来表述：选择使比率 $\\frac{(H_{xy})^2}{H_{yy}}$ 最小化的切割。\n\n任务3：计算\n将实现推导出的公式 $\\Delta E = \\frac{k_{c}^2 A^2}{2 k_{m}}$。对于用例6，我们必须从 $\\{0, 1, 2\\}$ 中选择对应于用例1-3中产生最小 $\\Delta E$ 的切割索引。由于用例1-3的位移 $A$ 相同，这等同于为这三种情况找到比率 $\\frac{k_{c}^2}{k_{m}}$ 的最小值。\n- 用例1: $\\frac{k_{c}^2}{k_{m}} = \\frac{30^2}{350} = \\frac{900}{350} \\approx 2.5714$\n- 用例2: $\\frac{k_{c}^2}{k_{m}} = \\frac{50^2}{300} = \\frac{2500}{300} \\approx 8.3333$\n- 用例3: $\\frac{k_{c}^2}{k_{m}} = \\frac{120^2}{320} = \\frac{14400}{320} = 45.0$\n最小值出现在用例1。因此，推荐的切割对应于索引 $0$。完整的数值评估在最终答案代码中提供。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the QM/MM cut selection problem based on a linear-elastic surrogate model.\n    \"\"\"\n\n    # Test suite: each tuple is (k_q, k_m, k_c, A)\n    # The problem provides k_q, but the derived formula for Delta E does not depend on it.\n    # It is included here for completeness of data representation from the problem statement.\n    test_cases = [\n        # Case 1 (N-Ca): k_q, k_m, k_c, A\n        (400.0, 350.0, 30.0, 0.1),\n        # Case 2 (Ca-C): k_q, k_m, k_c, A\n        (450.0, 300.0, 50.0, 0.1),\n        # Case 3 (C-N amide): k_q, k_m, k_c, A\n        (500.0, 320.0, 120.0, 0.1),\n        # Case 4 (zero coupling): k_q, k_m, k_c, A\n        (400.0, 300.0, 0.0, 0.15),\n        # Case 5 (stiff MM): k_q, k_m, k_c, A\n        (400.0, 2000.0, 80.0, 0.2),\n    ]\n\n    results = []\n\n    def calculate_delta_e(k_m, k_c, A):\n        \"\"\"\n        Calculates the energy error Delta E using the derived formula.\n        Delta E = (k_c^2 * A^2) / (2 * k_m)\n\n        Args:\n            k_m (float): Stiffness of the MM-side coordinate (kJ mol^-1 A^-2).\n            k_c (float): Coupling constant (kJ mol^-1 A^-2).\n            A (float): Displacement amplitude (A).\n\n        Returns:\n            float: Energy error Delta E (kJ mol^-1).\n        \"\"\"\n        if k_m == 0:\n            # Avoid division by zero, represents an infinitely flexible MM region,\n            # which implies infinite error for non-zero coupling.\n            return float('inf')\n        return (k_c**2 * A**2) / (2 * k_m)\n\n    # Process cases 1 through 5\n    for case in test_cases:\n        k_q, k_m, k_c, A = case\n        delta_e = calculate_delta_e(k_m, k_c, A)\n        results.append(round(delta_e, 6))\n\n    # Process Case 6: Selection among the first three cuts\n    # The recipe is to choose the cut that minimizes Delta E.\n    # Since A is the same for the first three cases, this is equivalent\n    # to minimizing the ratio k_c^2 / k_m.\n    errors_for_selection = []\n    for i in range(3):\n        k_q, k_m, k_c, A = test_cases[i]\n        error = calculate_delta_e(k_m, k_c, A)\n        errors_for_selection.append(error)\n    \n    # Find the index of the minimum error among the first three cases.\n    min_error_index = np.argmin(errors_for_selection)\n    results.append(min_error_index)\n    \n    # Format the final output string as per requirements.\n    # The last element must be an integer, others are floats with 6 decimal places.\n    output_str = [f\"{x:.6f}\" for x in results[:-1]]\n    output_str.append(str(results[-1]))\n    \n    print(f\"[{','.join(output_str)}]\")\n\nsolve()\n```", "id": "2918494"}]}