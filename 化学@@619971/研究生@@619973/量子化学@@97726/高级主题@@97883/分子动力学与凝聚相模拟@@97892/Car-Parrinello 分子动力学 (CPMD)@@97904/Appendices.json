{"hands_on_practices": [{"introduction": "任何 Car-Parrinello 分子动力学 (CPMD) 模拟都始于设置关键参数，即赝电子质量 $\\mu$ 和积分时间步长 $\\Delta t$。这些参数在理论讨论中通常以原子单位定义，但在实际工作和文献中，我们更常使用如飞秒 (fs) 和统一原子质量单位 (u) 等更具体的单位。此练习 [@problem_id:2878271] 提供了在这些单位系统之间进行转换的基本实践，这是正确解释、设置 CPMD 模拟并确保您的参数选择合理的一项基本技能。", "problem": "在Car-Parrinello分子动力学 (CPMD) 中，电子自由度被赋予一个虚拟质量参数 $\\mu$，并以一个有限的时间步长 $\\Delta t$ 进行演化。考虑一个CPMD模拟，其使用的虚拟质量为 $\\mu = 400$ 原子单位 (a.u.)，时间步长为 $\\Delta t = 5$ 原子单位。从原子单位的基本定义出发，推导将时间步长 $\\Delta t$ 表示为飞秒（femtoseconds）以及将虚拟质量 $\\mu$ 表示为统一原子质量单位（unified atomic mass units）的转换公式。然后进行数值转换。\n\n仅使用以下基本定义和常数作为基础：\n- 原子单位时间为 $t_{\\mathrm{au}} \\equiv \\hbar / E_{\\mathrm{h}}$。\n- 原子单位质量为 $m_{\\mathrm{au}} \\equiv m_{e}$。\n- 一飞秒为 $1\\,\\mathrm{fs} = 10^{-15}\\,\\mathrm{s}$。\n- 一统一原子质量单位为 $1\\,\\mathrm{u} = 1.66053906660 \\times 10^{-27}\\,\\mathrm{kg}$。\n- 约化普朗克常数: $\\hbar = 1.054571817 \\times 10^{-34}\\,\\mathrm{J\\,s}$。\n- 哈特里能量: $E_{\\mathrm{h}} = 4.3597447222071 \\times 10^{-18}\\,\\mathrm{J}$。\n- 电子质量: $m_{e} = 9.1093837015 \\times 10^{-31}\\,\\mathrm{kg}$。\n\n为评估合理性，可作参考的是：许多CPMD研究报告称，对于在 $300$–$800$ a.u. 范围内的 $\\mu$，只要保持绝热分离，稳定的时间步长通常落在 $0.08$–$0.20\\,\\mathrm{fs}$ 的范围内。\n\n任务：\n1. 推导表达式，用于将任意以原子单位表示的时间步长 $\\Delta t_{\\mathrm{au}}$ 转换为飞秒，以及将任意以原子单位表示的虚拟质量 $\\mu_{\\mathrm{au}}$ 转换为统一原子质量单位。\n2. 将你推导的公式应用于给定值 $\\Delta t_{\\mathrm{au}} = 5$ 和 $\\mu_{\\mathrm{au}} = 400$。\n3. 简要论证对于给定的 $\\mu$ 值，转换后的 $\\Delta t$ 是否与上述文献中的典型范围一致。\n4. 报告以飞秒为单位的转换后的 $\\Delta t$ 值，四舍五入保留四位有效数字。最终答案以 $\\mathrm{fs}$ 为单位表示。\n\n最终数值答案只需报告转换后的 $\\Delta t$；所有推理和单位检查都应在推导过程中体现。", "solution": "目标是从原子单位的基本定义出发，将虚拟电子质量参数 $\\mu$ 从原子单位转换为统一原子质量单位，并将时间步长 $\\Delta t$ 从原子单位转换为飞秒。\n\n根据定义，原子单位时间为\n$$\nt_{\\mathrm{au}} \\equiv \\frac{\\hbar}{E_{\\mathrm{h}}}.\n$$\n因此，任何以原子单位表示的时间步长 $\\Delta t_{\\mathrm{au}}$ 都对应一个物理时间\n$$\n\\Delta t = \\Delta t_{\\mathrm{au}} \\, t_{\\mathrm{au}} = \\Delta t_{\\mathrm{au}} \\, \\frac{\\hbar}{E_{\\mathrm{h}}}.\n$$\n要将 $\\Delta t$ 以飞秒为单位表示，我们使用 $1\\,\\mathrm{fs} = 10^{-15}\\,\\mathrm{s}$，可写为\n$$\n\\Delta t_{\\mathrm{fs}} = \\Delta t_{\\mathrm{au}} \\, \\frac{\\hbar}{E_{\\mathrm{h}}} \\times \\frac{1}{10^{-15}}.\n$$\n代入给定的常数，\n$$\nt_{\\mathrm{au}} = \\frac{\\hbar}{E_{\\mathrm{h}}} = \\frac{1.054571817 \\times 10^{-34}\\,\\mathrm{J\\,s}}{4.3597447222071 \\times 10^{-18}\\,\\mathrm{J}} = 2.4188843265857 \\times 10^{-17}\\,\\mathrm{s}.\n$$\n因此，\n$$\nt_{\\mathrm{au}} = 2.4188843265857 \\times 10^{-17}\\,\\mathrm{s} = 0.024188843265857\\,\\mathrm{fs}.\n$$\n对于给定的 $\\Delta t_{\\mathrm{au}} = 5$，\n$$\n\\Delta t_{\\mathrm{fs}} = 5 \\times 0.024188843265857 = 0.120944216329285\\,\\mathrm{fs}.\n$$\n\n接下来，对于虚拟质量参数，原子单位质量定义为\n$$\nm_{\\mathrm{au}} \\equiv m_{e}.\n$$\n因此，一个以原子单位表示的虚拟质量 $\\mu_{\\mathrm{au}}$ 对应一个物理质量\n$$\n\\mu = \\mu_{\\mathrm{au}} \\, m_{e}.\n$$\n要将 $\\mu$ 以统一原子质量单位表示，使用 $1\\,\\mathrm{u} = 1.66053906660 \\times 10^{-27}\\,\\mathrm{kg}$。因此，\n$$\n\\mu_{\\mathrm{u}} = \\frac{\\mu}{1\\,\\mathrm{u}} = \\mu_{\\mathrm{au}} \\, \\frac{m_{e}}{1\\,\\mathrm{u}}.\n$$\n当 $\\mu_{\\mathrm{au}} = 400$ 时，\n$$\n\\mu = 400 \\times 9.1093837015 \\times 10^{-31}\\,\\mathrm{kg} = 3.6437534806 \\times 10^{-28}\\,\\mathrm{kg},\n$$\n并且\n$$\n\\mu_{\\mathrm{u}} = \\frac{3.6437534806 \\times 10^{-28}}{1.66053906660 \\times 10^{-27}} = 0.219432\\ \\text{(以u为单位)}.\n$$\n等效地，使用已知比率 $m_{e} = 5.48579909065 \\times 10^{-4}\\,\\mathrm{u}$，\n$$\n\\mu_{\\mathrm{u}} = 400 \\times 5.48579909065 \\times 10^{-4} = 0.219431963626,\n$$\n这与上面的直接除法结果一致。\n\n与文献的一致性检查：对于在 $300$–$800$ a.u. 范围内的 $\\mu$，文献报道的稳定时间步长通常在 $0.08$–$0.20\\,\\mathrm{fs}$ 的范围内。我们转换得到的值 $\\Delta t_{\\mathrm{fs}} \\approx 0.120944216329285\\,\\mathrm{fs}$ 很好地落在这个范围内，这与典型的CPMD实践和绝热分离的要求是一致的。\n\n最后，将 $\\Delta t_{\\mathrm{fs}}$ 四舍五入到四位有效数字，得到\n$$\n\\Delta t_{\\mathrm{fs}} = 0.1209\\,\\mathrm{fs}.\n$$", "answer": "$$\\boxed{0.1209}$$", "id": "2878271"}, {"introduction": "CPMD 的基石是快速运动的赝电子与较慢的原子核之间的“绝热分离”。当这个条件被破坏时，模拟结果将变得不符合物理实际。通过一个简化的、但抓住了原子核与电子耦合运动核心物理的一维模型，我们可以深入探究这一关键概念。通过这个编码练习 [@problem_id:2451945]，您将亲手模拟选择不当赝电子质量 $\\mu$ 所带来的后果，观察由此产生的能量漂移，从而对为何绝热性对于准确的 CPMD 模拟至关重要获得切实的理解。", "problem": "考虑一个 Car-Parrinello 分子动力学 (CPMD) 的一维玩具模型，该模型只有一个质量为 $M$ 的离子坐标 $R(t)$ 和一个虚构质量为 $\\mu$ 的电子虚构坐标 $c(t)$。该系统由拉格朗日量\n$$\nL = \\frac{M}{2}\\,\\dot{R}^2 + \\frac{\\mu}{2}\\,\\dot{c}^2 - \\left[\\frac{k}{2}\\,(R - R_0)^2 + \\frac{k_e}{2}\\,(c - R)^2\\right]\n$$\n描述。\n全文假设使用原子单位（Hartree 原子单位）：位置以 bohr 为单位，质量以电子质量为单位，时间以原子时间单位为单位，能量以 hartree 为单位。参数值固定为 $M = 10$，$k = 1$，$k_e = 50$ 和 $R_0 = 0$。初始条件为 $R(0) = 1$，$\\dot{R}(0) = 0$，$c(0) = 0$ 和 $\\dot{c}(0) = 0$。\n\n设离子 Born–Oppenheimer 能量定义为\n$$\nE_{\\mathrm{BO}}(t) = \\frac{M}{2}\\,\\dot{R}(t)^2 + \\frac{k}{2}\\,\\big(R(t) - R_0\\big)^2,\n$$\n电子-离子失配度为 $m(t) = c(t) - R(t)$。\n\n您的任务是实现一个程序，对于每个指定的参数集 $(\\mu, \\Delta t, T)$，使用均匀时间步长 $\\Delta t$ 在时间区间 $[0, T]$ 上模拟由上述拉格朗日量的 Euler–Lagrange 方程所控制的动力学，并计算以下三个诊断量：\n- 离子 Born–Oppenheimer 能量漂移 $\\Delta E_{\\mathrm{BO}} = E_{\\mathrm{BO}}(T) - E_{\\mathrm{BO}}(0)$，以 hartree 为单位报告。\n- 最大绝对离子位移 $D_{\\max} = \\max_{t \\in [0,T]} |R(t) - R_0|$，以 bohr 为单位报告。\n- 均方失配度 $M_2 = \\frac{1}{N}\\sum_{i=0}^{N-1} m(t_i)^2$，其中 $t_i$ 是均匀间隔的模拟时间点，以 bohr$^2$ 为单位报告。\n\n测试套件由以下四个案例组成，每个案例以 $(\\mu, \\Delta t, T)$ 形式给出：\n- 案例 A: $(0.1, 0.01, 50.0)$\n- 案例 B: $(10.0, 0.01, 50.0)$\n- 案例 C: $(50.0, 0.01, 50.0)$\n- 案例 D: $(125.0, 0.01, 50.0)$\n\n所有量都必须以原子单位表示。您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果，每个测试案例贡献一个包含三个浮点数的子列表，顺序为 $[\\Delta E_{\\mathrm{BO}}, D_{\\max}, M_2]$。例如，输出格式必须是\n$$\n\\big[\\,[\\Delta E_{\\mathrm{BO}}^{(A)}, D_{\\max}^{(A)}, M_2^{(A)}], [\\Delta E_{\\mathrm{BO}}^{(B)}, D_{\\max}^{(B)}, M_2^{(B)}], [\\Delta E_{\\mathrm{BO}}^{(C)}, D_{\\max}^{(C)}, M_2^{(C)}], [\\Delta E_{\\mathrm{BO}}^{(D)}, D_{\\max}^{(D)}, M_2^{(D)}]\\,\\big].\n$$\n不应打印任何额外文本。数字必须以原子单位的标准十进制浮点数形式报告。", "solution": "该问题是有效的。它提出了一个来自计算化学领域的适定物理模型，提供了所有必要的参数和初始条件来模拟系统动力学并计算所需的诊断量。\n\n问题的核心是使用数值积分法求解由所给拉格朗日量推导出的运动方程。带离子坐标 $R(t)$ 和虚构电子坐标 $c(t)$ 的一维系统的拉格朗日量为：\n$$\nL = \\frac{M}{2}\\,\\dot{R}^2 + \\frac{\\mu}{2}\\,\\dot{c}^2 - V(R, c)\n$$\n其中势能 $V(R, c)$ 由下式给出：\n$$\nV(R, c) = \\frac{k}{2}\\,(R - R_0)^2 + \\frac{k_e}{2}\\,(c - R)^2\n$$\n动力学由 Euler-Lagrange 方程 $\\frac{d}{dt}\\left(\\frac{\\partial L}{\\partial \\dot{q}}\\right) - \\frac{\\partial L}{\\partial q} = 0$ 控制，对每个坐标 $q \\in \\{R, c\\}$ 均适用。\n\n对于离子坐标 $R(t)$：\n偏导数为：\n$$\n\\frac{\\partial L}{\\partial \\dot{R}} = M\\dot{R}\n$$\n$$\n\\frac{\\partial L}{\\partial R} = -\\frac{\\partial V}{\\partial R} = -\\left[ k(R - R_0) - k_e(c - R) \\right] = -k(R - R_0) + k_e(c - R)\n$$\n这得到了第一个运动方程：\n$$\nM\\ddot{R} = -k(R - R_0) + k_e(c - R)\n$$\n\n对于电子坐标 $c(t)$：\n偏导数为：\n$$\n\\frac{\\partial L}{\\partial \\dot{c}} = \\mu\\dot{c}\n$$\n$$\n\\frac{\\partial L}{\\partial c} = -\\frac{\\partial V}{\\partial c} = -\\left[ k_e(c - R) \\right] = -k_e(c - R)\n$$\n这得到了第二个运动方程：\n$$\n\\mu\\ddot{c} = -k_e(c - R)\n$$\n\n这两个耦合的二阶常微分方程可以数值求解。我们将每个坐标上的力定义为 $F_R = M\\ddot{R}$ 和 $F_c = \\mu\\ddot{c}$。加速度则为 $a_R(t) = F_R/M$ 和 $a_c(t) = F_c/\\mu$：\n$$\na_R(t) = \\frac{1}{M}\\left[-k(R(t) - R_0) + k_e(c(t) - R(t))\\right]\n$$\n$$\na_c(t) = \\frac{1}{\\mu}\\left[-k_e(c(t) - R(t))\\right]\n$$\n\n为了在时间区间 $[0, T]$ 上以时间步长 $\\Delta t$ 从初始状态 $(R(0), \\dot{R}(0), c(0), \\dot{c}(0))$ 积分这些运动方程，我们将采用 Velocity Verlet 算法。这种常见的辛积分器因其良好的能量守恒特性而非常适合分子动力学。对于一个通用坐标 $x(t)$、其速度 $v(t)$ 和加速度 $a(t)$，该算法的一个步骤是：\n1.  将速度更新半步：$v(t + \\Delta t/2) = v(t) + a(t) \\frac{\\Delta t}{2}$。\n2.  将位置更新一整步：$x(t + \\Delta t) = x(t) + v(t + \\Delta t/2) \\Delta t$。\n3.  使用新位置 $x(t + \\Delta t)$ 计算新的加速度 $a(t + \\Delta t)$。\n4.  将速度更新一整步：$v(t + \\Delta t) = v(t + \\Delta t/2) + a(t + \\Delta t) \\frac{\\Delta t}{2}$。\n\n在每个时间步，此算法同时应用于坐标 $R$ 和 $c$。模拟开始时，根据初始位置 $R(0)$ 和 $c(0)$ 计算初始加速度 $a_R(0)$ 和 $a_c(0)$。然后循环进行 $N_{steps} = \\text{int}(T/\\Delta t)$ 步。\n\n在模拟过程中，我们计算所需的三个诊断量：\n1.  **离子 Born–Oppenheimer 能量漂移, $\\Delta E_{\\mathrm{BO}}$**：\n    这被定义为 $\\Delta E_{\\mathrm{BO}} = E_{\\mathrm{BO}}(T) - E_{\\mathrm{BO}}(0)$。初始能量 $E_{\\mathrm{BO}}(0)$ 是使用初始条件计算的：\n    $$\n    E_{\\mathrm{BO}}(0) = \\frac{M}{2}\\,\\dot{R}(0)^2 + \\frac{k}{2}\\,\\big(R(0) - R_0\\big)^2 = \\frac{10}{2}\\,(0)^2 + \\frac{1}{2}\\,(1 - 0)^2 = 0.5 \\text{ hartree}\n    $$\n    最终能量 $E_{\\mathrm{BO}}(T) = \\frac{M}{2}\\,\\dot{R}(T)^2 + \\frac{k}{2}\\,\\big(R(T) - R_0\\big)^2$ 是使用模拟结束时的位置 $R(T)$ 和速度 $\\dot{R}(T)$ 计算的。\n\n2.  **最大绝对离子位移, $D_{\\max}$**：\n    这是 $D_{\\max} = \\max_{t \\in [0,T]} |R(t) - R_0|$。当 $R_0 = 0$ 时，这便是 $\\max_{t \\in [0,T]} |R(t)|$。我们初始化一个变量 $D_{\\max} = |R(0)|$，并在每个时间步 $t_i$ 用 $\\max(D_{\\max}, |R(t_i)|)$ 对其进行更新。\n\n3.  **均方失配度, $M_2$**：\n    这被定义为 $M_2 = \\frac{1}{N}\\sum_{i=0}^{N-1} m(t_i)^2$。我们将其解释为在模拟轨迹的所有离散时间点上（从 $t_0=0$ 到 $t_{N_{steps}}=T$）失配度平方 $m(t)^2 = (c(t) - R(t))^2$ 的时间平均值。总点数为 $N_{points} = N_{steps} + 1$。因此，公式为：\n    $$\n    M_2 = \\frac{1}{N_{steps}+1}\\sum_{i=0}^{N_{steps}} \\left(c(t_i) - R(t_i)\\right)^2\n    $$\n    在整个模拟过程中，会维持一个 $(c(t_i) - R(t_i))^2$ 的运行总和，并在最后除以总点数。\n\n固定参数为 $M = 10$, $k = 1$, $k_e = 50$, 和 $R_0 = 0$。初始条件为 $R(0) = 1$, $\\dot{R}(0) = 0$, $c(0) = 0$, 和 $\\dot{c}(0) = 0$。对每个测试案例 $(\\mu, \\Delta t, T)$ 运行模拟，以获得相应的诊断量。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef simulate(mu, dt, T):\n    \"\"\"\n    Simulates the 1D Car-Parrinello toy model and computes diagnostics.\n\n    Args:\n        mu (float): The fictitious electronic mass.\n        dt (float): The time step for numerical integration.\n        T (float): The total simulation time.\n\n    Returns:\n        list: A list containing [delta_E_BO, D_max, M_2].\n    \"\"\"\n    # Fixed parameters in atomic units\n    M = 10.0\n    k = 1.0\n    ke = 50.0\n    R0_eq = 0.0\n\n    # Initial conditions in atomic units\n    R = 1.0\n    R_dot = 0.0\n    c = 0.0\n    c_dot = 0.0\n\n    # To ensure the number of steps is correct even with floating point inaccuracies\n    num_steps = int(round(T / dt))\n\n    # Calculate initial Born-Oppenheimer energy\n    E_BO_initial = 0.5 * M * R_dot**2 + 0.5 * k * (R - R0_eq)**2\n\n    # Initialize diagnostics\n    # D_max: Maximum absolute ionic displacement\n    max_displacement = abs(R - R0_eq)\n    # M_2: Mean-squared mismatch\n    sum_sq_mismatch = (c - R)**2\n    num_points = 1\n\n    # Initial accelerations\n    a_R = (-k * (R - R0_eq) + ke * (c - R)) / M\n    a_c = (-ke * (c - R)) / mu\n\n    # Main simulation loop using Velocity Verlet algorithm\n    for _ in range(num_steps):\n        # 1. Update velocities to half-step\n        R_dot_half = R_dot + 0.5 * a_R * dt\n        c_dot_half = c_dot + 0.5 * a_c * dt\n\n        # 2. Update positions to full-step\n        R = R + R_dot_half * dt\n        c = c + c_dot_half * dt\n\n        # 3. Compute new accelerations at the new positions\n        a_R = (-k * (R - R0_eq) + ke * (c - R)) / M\n        a_c = (-ke * (c - R)) / mu\n\n        # 4. Update velocities to full-step\n        R_dot = R_dot_half + 0.5 * a_R * dt\n        c_dot = c_dot_half + 0.5 * a_c * dt\n\n        # Update diagnostics at each step\n        max_displacement = max(max_displacement, abs(R - R0_eq))\n        sum_sq_mismatch += (c - R)**2\n        num_points += 1\n\n    # Calculate final Born-Oppenheimer energy\n    E_BO_final = 0.5 * M * R_dot**2 + 0.5 * k * (R - R0_eq)**2\n\n    # Finalize diagnostic calculations\n    delta_E_BO = E_BO_final - E_BO_initial\n    mean_sq_mismatch = sum_sq_mismatch / num_points\n\n    return [delta_E_BO, max_displacement, mean_sq_mismatch]\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (mu, delta_t, T)\n    test_cases = [\n        (0.1, 0.01, 50.0),   # Case A\n        (10.0, 0.01, 50.0),  # Case B\n        (50.0, 0.01, 50.0),  # Case C\n        (125.0, 0.01, 50.0), # Case D\n    ]\n\n    results = []\n    for case in test_cases:\n        mu, delta_t, T_final = case\n        result = simulate(mu, delta_t, T_final)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    # The default str() representation of a list of lists matches the format\n    # `[[val1, val2, ...], [val1, val2, ...]]`\n    # including spaces after commas inside the sublists.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2451945"}, {"introduction": "在真实的 CPMD 模拟中，我们如何判断绝热分离是否得到维持？一个关键的诊断工具是分析赝电子动能 $T_e(t)$ 的行为。绝热性的破坏通常表现为从离子到赝电子的共振能量转移，这可以在 $T_e(t)$ 的频谱中检测为特定的峰。这个实践问题 [@problem_id:2878295] 旨在挑战您解读一个真实模拟场景的结果，将观察到的频谱特征与潜在的共振物理问题联系起来，并提出有效的解决方案，从而磨练您作为计算诊断专家的技能。", "problem": "使用 Kohn–Sham 密度泛函理论 (DFT) 对一个绝缘固体进行了一次 Car–Parrinello 分子动力学 (CPMD) 模拟。虚拟电子自由度以虚拟质量参数 $\\mu$ 和时间步长 $\\Delta t$ 进行演化。在时长为 $T_{\\mathrm{obs}}$ 的轨迹上，瞬时虚拟电子动能被监测为 $T_e(t)$。你通过离散傅里叶变换计算 $T_e(t)$ 的功率谱密度，并从离子的速度自相关函数计算离子振动谱。报告了以下的观察结果和设置：\n\n- 虚拟电子质量: $\\mu = 700\\,\\mathrm{a.u.}$\n- 时间步长: $\\Delta t = 0.12\\,\\mathrm{fs}$\n- 轨迹长度: $T_{\\mathrm{obs}} = 20\\,\\mathrm{ps}$\n- Kohn–Sham 带隙（时间平均）: $E_{\\mathrm{gap}} \\approx 1.2\\,\\mathrm{eV}$\n- 离子振动谱在 $\\omega_1 \\approx 360\\,\\mathrm{cm}^{-1}$ 和 $\\omega_2 \\approx 720\\,\\mathrm{cm}^{-1}$ 处显示出显著的峰。\n- $T_e(t)$ 的功率谱，记作 $S_{T_e}(\\omega) \\propto \\left|\\int_{0}^{T_{\\mathrm{obs}}} T_e(t)\\,e^{-i \\omega t}\\,dt\\right|^2$，除了一个宽的高频带外，还在 $\\omega \\approx 360\\,\\mathrm{cm}^{-1}$ 和 $\\omega \\approx 720\\,\\mathrm{cm}^{-1}$ 处表现出清晰的峰。\n\n仅使用 Car–Parrinello 拉格朗日动力学的第一性原理、微振动分析、受驱谐振子和傅里叶分析的基本性质，回答以下问题。哪些陈述与观察结果一致，并指出了缓解该问题的有效参数更改？\n\nA. 峰的重合仅意味着由有限的 $\\Delta t$ 引起的数值混叠；仅减小 $\\Delta t$ 而不改变 $\\mu$ 将会移除 $S_{T_e}(\\omega)$ 中的峰。\n\nB. 峰的重合表明离子运动正在共振驱动虚拟电子自由度；减小 $\\mu$ 将会增加特征电子频率（近似按 $\\mu^{-1/2}$ 变化），从而改善绝热分离。\n\nC. 为抑制耦合，应该增加 $\\mu$ 以使电子模式减慢，从而无法跟随离子运动。\n\nD. 保持 $\\mu$ 不变但减小 $\\Delta t$ 将会消除 $S_{T_e}(\\omega)$ 中的共振峰，因为该效应纯粹是由于时间离散化误差引起的。\n\nE. 将一个 Nosé–Hoover (NH) 链式恒温器耦合到虚拟电子动能上，同时为离子保持一个独立的恒温器，可以阻尼共振能量转移，并将 $T_e(t)$ 稳定在一个小的目标值附近。\n\nF. 增加平面波动能截断将自动地将电子振荡频率移至所有离子频率之上，从而无论 $\\mu$ 取何值都能移除这些峰。\n\nG. 一个实用的绝热解耦判据是确保 $\\omega_e^{\\min} \\gtrsim c\\,\\omega_{\\max}^{\\mathrm{ion}}$，其中 $c \\in [5,10]$；因此，给定观测到的 $\\omega_{\\max}^{\\mathrm{ion}} \\approx 720\\,\\mathrm{cm}^{-1}$，应该选择 $\\mu$ 使得最小电子振荡频率满足 $\\omega_e^{\\min} \\gtrsim 5\\times 720\\,\\mathrm{cm}^{-1}$。", "solution": "需对问题陈述进行验证。\n\n### 步骤 1：提取已知条件\n问题陈述中提供了以下数据和观察结果：\n- 虚拟电子质量: $\\mu = 700\\,\\mathrm{a.u.}$\n- 时间步长: $\\Delta t = 0.12\\,\\mathrm{fs}$\n- 轨迹时长: $T_{\\mathrm{obs}} = 20\\,\\mathrm{ps}$\n- 时间平均的 Kohn–Sham 带隙: $E_{\\mathrm{gap}} \\approx 1.2\\,\\mathrm{eV}$\n- 离子振动谱峰: $\\omega_1 \\approx 360\\,\\mathrm{cm}^{-1}$ 和 $\\omega_2 \\approx 720\\,\\mathrm{cm}^{-1}$\n- 虚拟电子动能的功率谱 $S_{T_e}(\\omega)$ 在 $\\omega \\approx 360\\,\\mathrm{cm}^{-1}$ 和 $\\omega \\approx 720\\,\\mathrm{cm}^{-1}$ 处显示出峰。\n- 功率谱的定义: $S_{T_e}(\\omega) \\propto \\left|\\int_{0}^{T_{\\mathrm{obs}}} T_e(t)\\,e^{-i \\omega t}\\,dt\\right|^2$\n- 虚拟电子动能: $T_e(t)$\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题描述了 Car-Parrinello 分子动力学 (CPMD) 中的一个场景，这是计算量子化学中的一种成熟方法。\n- **科学基础**：所呈现的概念——虚拟电子质量、虚拟动能、绝热分离、离子振动谱和共振能量转移——是 CPMD 理论和实践的标准核心。虚拟电子动能中的谱污染场景是 CPMD 模拟中一个经典且有充分文献记载的问题。该问题在科学上是合理的。\n- **良构性**：该问题提供了一系列观察结果，并要求找出一致的理论陈述和实用的缓解策略。该问题可以根据 CPMD 的既定原理来回答。可以确定一组唯一的正确和不正确的陈述。\n- **客观性和完整性**：该问题使用精确的技术语言陈述。所提供的数据足以诊断物理问题并评估所提出的解决方案。例如，$\\mu$、$E_{\\mathrm{gap}}$ 和离子频率的值允许对绝热条件进行定量检验。没有缺少必要信息，也没有矛盾之处。\n\n### 步骤 3：结论和行动\n问题陈述在科学上是合理的、良构的且内部一致。这是一个可以解决的有效问题。\n\n### 推导与分析\n\nCar-Parrinello 分子动力学的基础是拉格朗日量：\n$$L_{CP} = \\frac{1}{2}\\mu\\sum_i \\int |\\dot{\\psi}_i(\\mathbf{r},t)|^2 d\\mathbf{r} + \\frac{1}{2}\\sum_I M_I |\\dot{\\mathbf{R}}_I|^2 - E_{KS}[\\{\\psi_i\\}, \\{\\mathbf{R}_I\\}]$$\n其中第一项是具有虚拟质量 $\\mu$ 的电子轨道 $\\psi_i$ 的虚拟动能，第二项是质量为 $M_I$、位置为 $\\mathbf{R}_I$ 的离子的经典动能，而 $E_{KS}$ 是 Kohn-Sham 能量泛函。\n\nCPMD 的目标是近似真实的 Born-Oppenheimer (BO) 动力学，其中对于任何给定的离子构型，电子都会瞬时弛豫到基态。如果虚拟电子自由度的演化时间尺度远快于离子，即满足所谓的绝热分离条件，就能实现这一目标。\n\n电子轨道的运动方程为 $\\mu \\ddot{\\psi}_i = -\\frac{\\delta E_{KS}}{\\delta \\psi_i^*}$。这描述了一组振子。在 BO 面附近，电子轨道以一个频率谱 $\\{\\omega_e\\}$ 振荡。这些频率中的最低频率 $\\omega_e^{\\min}$ 至关重要。对于一个带隙为 $E_{\\mathrm{gap}}$ 的绝缘系统，一个很好的近似是：\n$$\\omega_e^{\\min} \\approx \\sqrt{\\frac{2 E_{\\mathrm{gap}}}{\\mu}}$$\n绝热分离条件要求这个最低电子频率显著高于最高离子振动频率 $\\omega_{\\max}^{\\mathrm{ion}}$。一个常见的经验法则是 $\\omega_e^{\\min} / \\omega_{\\max}^{\\mathrm{ion}} \\gtrsim 5-10$。\n\n让我们用给定的参数来验证这个条件。首先，我们将单位转换为一个一致的体系（原子单位，a.u.）。\n- $\\mu = 700\\,\\mathrm{a.u.}$\n- $E_{\\mathrm{gap}} \\approx 1.2\\,\\mathrm{eV} \\approx 1.2 \\times 0.03675\\,\\mathrm{a.u.} \\approx 0.0441\\,\\mathrm{a.u.}$\n- 最低电子频率（原子单位）为：\n$$\\omega_e^{\\min} (\\mathrm{a.u.}) \\approx \\sqrt{\\frac{2 \\times 0.0441}{700}} \\approx \\sqrt{1.26 \\times 10^{-4}} \\approx 0.0112\\,\\mathrm{a.u.}$$\n- 为了与离子频率进行比较，我们将其转换为 $\\mathrm{cm}^{-1}$（使用 $1\\,\\mathrm{a.u. of frequency} \\approx 2.1947 \\times 10^5\\,\\mathrm{cm}^{-1}$）：\n$$\\omega_e^{\\min} (\\mathrm{cm}^{-1}) \\approx 0.0112 \\times 2.1947 \\times 10^5 \\approx 2460\\,\\mathrm{cm}^{-1}$$\n- 给出的最高离子频率为 $\\omega_{\\max}^{\\mathrm{ion}} = \\omega_2 \\approx 720\\,\\mathrm{cm}^{-1}$。\n- 该比率为 $\\omega_e^{\\min} / \\omega_{\\max}^{\\mathrm{ion}} \\approx 2460 / 720 \\approx 3.4$。\n\n这个比率很小，违反了良好绝热性的典型条件。当一个电子频率 $\\omega_e$ 接近一个离子频率 $\\omega_{\\mathrm{ion}}$ 时，离子运动会对电子子系统起到共振驱动力的作用。这会导致能量从离子长期转移到虚拟电子动能 $T_e(t)$。$T_e(t)$ 的功率谱 $S_{T_e}(\\omega)$ 随之会在驱动频率处，即在离子振动频率处，表现出峰值。问题陈述恰好证实了这一点：$S_{T_e}(\\omega)$ 在离子频率 $360\\,\\mathrm{cm}^{-1}$ 和 $720\\,\\mathrm{cm}^{-1}$ 处有峰。这是绝热分离被破坏的经典特征。\n\n### 逐项分析\n\n**A. 峰的重合仅意味着由有限的 $\\Delta t$ 引起的数值混叠；仅减小 $\\Delta t$ 而不改变 $\\mu$ 将会移除 $S_{T_e}(\\omega)$ 中的峰。**\n如果采样频率低于信号中最高频率的两倍，就会发生混叠。时间步长为 $\\Delta t = 0.12\\,\\mathrm{fs}$。奈奎斯特频率为 $\\omega_N = \\pi / \\Delta t$。\n$\\omega_N = \\pi / (0.12 \\times 10^{-15}\\,\\mathrm{s}) \\approx 2.6 \\times 10^{16}\\,\\mathrm{rad/s}$。以波数表示，这是 $\\omega_N (\\mathrm{cm}^{-1}) = \\omega_N (\\mathrm{rad/s}) / (2\\pi c) \\approx (2.6 \\times 10^{16}) / (2\\pi \\times 3 \\times 10^{10}) \\approx 1.4 \\times 10^5\\,\\mathrm{cm}^{-1}$。系统中的最高频率是电子频率。即使是最高的电子频率，对应于深层核心能级和高位空态之间的跃迁，也远低于这个奈奎斯特频率。观察到的问题是物理共振，而不是数值混叠的假象。减小 $\\Delta t$ 对于稳定积分是必需的，但不会修复潜在的共振问题。\n结论：**错误**。\n\n**B. 峰的重合表明离子运动正在共振驱动虚拟电子自由度；减小 $\\mu$ 将会增加特征电子频率（近似按 $\\mu^{-1/2}$ 变化），从而改善绝热分离。**\n该陈述正确地指出了物理现象：由于绝热分离不佳导致的共振驱动。它还提出了标准的解决方案。由于 $\\omega_e \\propto \\mu^{-1/2}$，减小虚拟质量 $\\mu$ 将增加所有电子频率 $\\omega_e$。这将使电子谱移向更高频率，使其远离离子谱，从而恢复绝热分离。这将抑制共振能量转移。\n结论：**正确**。\n\n**C. 为抑制耦合，应该增加 $\\mu$ 以使电子模式减慢，从而无法跟随离子运动。**\n这与正确的做法相反。增加 $\\mu$ 会降低电子频率 ($\\omega_e \\propto \\mu^{-1/2}$)，通过使 $\\omega_e$ 更接近 $\\omega_{\\mathrm{ion}}$ 而使共振问题恶化。目标是让电子绝热地跟随离子运动，这要求电子的响应要快得多，而不是更慢。\n结论：**错误**。\n\n**D. 保持 $\\mu$ 不变但减小 $\\Delta t$ 将会消除 $S_{T_e}(\\omega)$ 中的共振峰，因为该效应纯粹是由于时间离散化误差引起的。**\n这是对选项 A 中错误逻辑的重述。问题是物理性的，根植于拉格朗日量中物理参数 $\\mu$ 的选择，而不是来自时间步长 $\\Delta t$ 的数值误差。一个更小的 $\\Delta t$ 会更精确地模拟共振动力学，但不会消除共振本身。\n结论：**错误**。\n\n**E. 将一个 Nosé–Hoover (NH) 链式恒温器耦合到虚拟电子动能上，同时为离子保持一个独立的恒温器，可以阻尼共振能量转移，并将 $T_e(t)$ 稳定在一个小的目标值附近。**\n这描述了一种有效且常用的技术。共振导致虚拟电子自由度的“加热”，意味着 $T_e(t)$ 随时间增长。将恒温器（如 NH 链）直接应用于电子子系统，可以持续移除这种非物理的过剩能量，使 $T_e(t)$ 保持在一个小且恒定的值。即使频率上的绝热条件没有被完美满足，这也强制执行了电子保持在 BO 面附近的条件。这是针对绝热分离不佳症状的一种实用补救措施。\n结论：**正确**。\n\n**F. 增加平面波动能截断将自动地将电子振荡频率移至所有离子频率之上，从而无论 $\\mu$ 取何值都能移除这些峰。**\n平面波截断能 $E_{cut}$ 决定了表示电子轨道的基组质量。增加 $E_{cut}$ 会导致对总能量 $E_{KS}$ 及其导数的更精确计算。虽然这将精确化电子能带结构的值，包括 $E_{\\mathrm{gap}}$，但它不会改变 $\\omega_e \\propto \\mu^{-1/2}$ 这个基本依赖关系。时间尺度分离的主要控制参数是 $\\mu$。$\\mu$ 的糟糕选择不能仅通过改善基组来修复。\n结论：**错误**。\n\n**G. 一个实用的绝热解耦判据是确保 $\\omega_e^{\\min} \\gtrsim c\\,\\omega_{\\max}^{\\mathrm{ion}}$，其中 $c \\in [5,10]$；因此，给定观测到的 $\\omega_{\\max}^{\\mathrm{ion}} \\approx 720\\,\\mathrm{cm}^{-1}$，应该选择 $\\mu$ 使得最小电子振荡频率满足 $\\omega_e^{\\min} \\gtrsim 5\\times 720\\,\\mathrm{cm}^{-1}$。**\n该陈述正确地阐述了绝热分离的定量判据。它从数据中正确地识别出 $\\omega_{\\max}^{\\mathrm{ion}} \\approx 720\\,\\mathrm{cm}^{-1}$。然后它应用经验法则，计算出所需的最小电子频率，$\\omega_e^{\\min} \\gtrsim 5 \\times 720\\,\\mathrm{cm}^{-1} = 3600\\,\\mathrm{cm}^{-1}$。如我们的计算所示，当前的设置得出 $\\omega_e^{\\min} \\approx 2460\\,\\mathrm{cm}^{-1}$，这不满足该判据。该陈述对情况进行了正确的分析，并含蓄地指向了必要的调整（减小 $\\mu$ 以将 $\\omega_e^{\\min}$ 增加到该阈值之上），这与选项 B 一致。\n结论：**正确**。", "answer": "$$\\boxed{BEG}$$", "id": "2878295"}]}