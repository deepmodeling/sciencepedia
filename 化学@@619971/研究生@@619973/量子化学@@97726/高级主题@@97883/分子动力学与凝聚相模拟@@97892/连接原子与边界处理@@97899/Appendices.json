{"hands_on_practices": [{"introduction": "在量子力学/分子力学 ($QM/MM$) 模拟中，连接原子 (Link Atom, LA) 方案是处理跨越共价键的边界最直接的方法之一。该方案的成功与否，首先取决于如何精确地放置连接原子。本练习将通过基本的矢量几何来巩固这一核心技能，要求您推导并计算决定连接原子位置的关键参数，这是正确实施任何连接原子方案的基石。[@problem_id:2902779]", "problem": "在切断一个量子区域原子和一个分子力学区域原子之间共价键的量子力学/分子力学 (QM/MM) 划分中，连接原子 (LA) 方案通过一个与原始化学键共线放置的氢原子来取代断开的量子区域价键。设分子力学边界原子的位置矢量为 $\\mathbf{r}_{\\mathrm{M}}$，量子边界原子的位置矢量为 $\\mathbf{r}_{\\mathrm{Q}}$。氢连接原子被约束在一条通过 $\\mathbf{r}_{\\mathrm{Q}}$ 且方向背离 $\\mathbf{r}_{\\mathrm{M}}$ 的直线上，其定义为\n$$\n\\mathbf{r}_{\\mathrm{H}} \\;=\\; \\mathbf{r}_{\\mathrm{Q}} \\;+\\; \\lambda \\bigl(\\mathbf{r}_{\\mathrm{Q}} - \\mathbf{r}_{\\mathrm{M}}\\bigr),\n$$\n其中某个标量 $\\lambda \\in \\mathbb{R}$ 将由一个键长约束确定。\n\n请仅从矢量几何和共价键长作为目标距离约束的定义出发，推导出用目标连接键长 $L_{\\mathrm{QH}}$ 和距离 $|\\mathbf{r}_{\\mathrm{Q}}-\\mathbf{r}_{\\mathrm{M}}|$ 来表示 $\\lambda$ 的解析表达式。然后，对于在饱和环境中切断一个碳-碳键的情况，取共价半径 $r_{\\mathrm{cov}}(\\mathrm{C_{sp^3}})=0.77\\,\\text{\\AA}$ 和 $r_{\\mathrm{cov}}(\\mathrm{H})=0.31\\,\\text{\\AA}$ 作为约束，设定目标碳-氢距离 $L_{\\mathrm{QH}} = r_{\\mathrm{cov}}(\\mathrm{C_{sp^3}}) + r_{\\mathrm{cov}}(\\mathrm{H})$。对一个特定的几何构型，使用以下坐标（单位为\\AA）：\n$$\n\\mathbf{r}_{\\mathrm{M}} = \\bigl(0.350,\\,-0.120,\\,0.980\\bigr), \\qquad\n\\mathbf{r}_{\\mathrm{Q}} = \\bigl(1.615,\\,0.420,\\,1.330\\bigr).\n$$\n计算由共价半径约束所隐含的 $\\lambda$ 的数值。将您的答案四舍五入至四位有效数字。仅报告无量纲标量 $\\lambda$ 作为您的最终答案。", "solution": "问题陈述已经过评估并被判定为有效。它在科学上基于计算化学的原理，特别是量子力学/分子力学 (QM/MM) 的连接原子方法。该问题是适定的，提供了所有必要的数据和约束以确定一个唯一且有意义的解。我们将继续进行推导和计算。\n\n目标是找到标量参数 $\\lambda$，该参数将氢连接原子 $\\text{H}$ 定位在由量子原子 $\\text{Q}$ 和分子力学原子 $\\text{M}$ 所定义的直线上。连接原子的位置矢量 $\\mathbf{r}_{\\mathrm{H}}$ 由以下关系式给出：\n$$\n\\mathbf{r}_{\\mathrm{H}} = \\mathbf{r}_{\\mathrm{Q}} + \\lambda (\\mathbf{r}_{\\mathrm{Q}} - \\mathbf{r}_{\\mathrm{M}})\n$$\n其中 $\\mathbf{r}_{\\mathrm{Q}}$ 和 $\\mathbf{r}_{\\mathrm{M}}$ 分别是量子边界原子和分子力学边界原子的位置矢量。\n\n参数 $\\lambda$ 由量子原子 $\\text{Q}$ 和连接原子 $\\text{H}$ 之间的键长约束确定。设这个目标键长用 $L_{\\mathrm{QH}}$ 表示。根据定义，该距离是连接这两个原子的矢量的模：\n$$\nL_{\\mathrm{QH}} = |\\mathbf{r}_{\\mathrm{H}} - \\mathbf{r}_{\\mathrm{Q}}|\n$$\n我们将给定的 $\\mathbf{r}_{\\mathrm{H}}$ 表达式代入此约束方程：\n$$\n\\mathbf{r}_{\\mathrm{H}} - \\mathbf{r}_{\\mathrm{Q}} = \\left(\\mathbf{r}_{\\mathrm{Q}} + \\lambda (\\mathbf{r}_{\\mathrm{Q}} - \\mathbf{r}_{\\mathrm{M}})\\right) - \\mathbf{r}_{\\mathrm{Q}} = \\lambda (\\mathbf{r}_{\\mathrm{Q}} - \\mathbf{r}_{\\mathrm{M}})\n$$\n取两边的模：\n$$\n|\\mathbf{r}_{\\mathrm{H}} - \\mathbf{r}_{\\mathrm{Q}}| = |\\lambda (\\mathbf{r}_{\\mathrm{Q}} - \\mathbf{r}_{\\mathrm{M}})|\n$$\n对于标量 $c$ 和矢量 $\\mathbf{v}$，利用矢量范数的性质 $|c\\mathbf{v}| = |c||\\mathbf{v}|$，我们得到：\n$$\nL_{\\mathrm{QH}} = |\\lambda| |\\mathbf{r}_{\\mathrm{Q}} - \\mathbf{r}_{\\mathrm{M}}|\n$$\n问题指明连接原子被放置在“背离 $\\mathbf{r}_{\\mathrm{M}}$ 的方向上”。这意味着位移矢量 $\\mathbf{r}_{\\mathrm{H}} - \\mathbf{r}_{\\mathrm{Q}}$ 必须与矢量 $\\mathbf{r}_{\\mathrm{Q}} - \\mathbf{r}_{\\mathrm{M}}$ 平行且同向。根据关系式 $\\mathbf{r}_{\\mathrm{H}} - \\mathbf{r}_{\\mathrm{Q}} = \\lambda (\\mathbf{r}_{\\mathrm{Q}} - \\mathbf{r}_{\\mathrm{M}})$，该条件意味着 $\\lambda$ 必须是一个正标量，因此 $|\\lambda| = \\lambda$。所以，约束简化为：\n$$\nL_{\\mathrm{QH}} = \\lambda |\\mathbf{r}_{\\mathrm{Q}} - \\mathbf{r}_{\\mathrm{M}}|\n$$\n求解 $\\lambda$ 得到所需的解析表达式：\n$$\n\\lambda = \\frac{L_{\\mathrm{QH}}}{|\\mathbf{r}_{\\mathrm{Q}} - \\mathbf{r}_{\\mathrm{M}}|}\n$$\n此表达式用目标连接键长 $L_{\\mathrm{QH}}$ 和原始成键原子间的距离 $|\\mathbf{r}_{\\mathrm{Q}}-\\mathbf{r}_{\\mathrm{M}}|$ 来表示 $\\lambda$。\n\n我们现在对给定的具体情况进行数值计算。\n目标键长 $L_{\\mathrm{QH}}$ 由一个 $\\mathrm{C_{sp^3}}$ 原子（量子原子 $\\text{Q}$）和一个氢原子（连接原子 $\\text{H}$）的共价半径之和设定。\n给定 $r_{\\mathrm{cov}}(\\mathrm{C_{sp^3}}) = 0.77\\,\\text{\\AA}$ 和 $r_{\\mathrm{cov}}(\\mathrm{H}) = 0.31\\,\\text{\\AA}$：\n$$\nL_{\\mathrm{QH}} = r_{\\mathrm{cov}}(\\mathrm{C_{sp^3}}) + r_{\\mathrm{cov}}(\\mathrm{H}) = 0.77\\,\\text{\\AA} + 0.31\\,\\text{\\AA} = 1.08\\,\\text{\\AA}\n$$\n接下来，我们计算距离 $|\\mathbf{r}_{\\mathrm{Q}} - \\mathbf{r}_{\\mathrm{M}}|$。给定的位置矢量单位为埃（Ångström）：\n$$\n\\mathbf{r}_{\\mathrm{M}} = \\begin{pmatrix} 0.350 \\\\ -0.120 \\\\ 0.980 \\end{pmatrix}, \\qquad\n\\mathbf{r}_{\\mathrm{Q}} = \\begin{pmatrix} 1.615 \\\\ 0.420 \\\\ 1.330 \\end{pmatrix}\n$$\n差分矢量为：\n$$\n\\mathbf{r}_{\\mathrm{Q}} - \\mathbf{r}_{\\mathrm{M}} = \\begin{pmatrix} 1.615 - 0.350 \\\\ 0.420 - (-0.120) \\\\ 1.330 - 0.980 \\end{pmatrix} = \\begin{pmatrix} 1.265 \\\\ 0.540 \\\\ 0.350 \\end{pmatrix}\n$$\n该矢量的模通过欧几里得范数求得：\n$$\n|\\mathbf{r}_{\\mathrm{Q}} - \\mathbf{r}_{\\mathrm{M}}| = \\sqrt{(1.265)^{2} + (0.540)^{2} + (0.350)^{2}}\n$$\n$$\n|\\mathbf{r}_{\\mathrm{Q}} - \\mathbf{r}_{\\mathrm{M}}| = \\sqrt{1.600225 + 0.2916 + 0.1225} = \\sqrt{2.014325} \\approx 1.41926917\\,\\text{\\AA}\n$$\n初始的 C–C 键长约为 $1.42\\,\\text{\\AA}$，这是一个合理的值，尽管比典型的单键要短。\n\n最后，我们将 $L_{\\mathrm{QH}}$ 和 $|\\mathbf{r}_{\\mathrm{Q}} - \\mathbf{r}_{\\mathrm{M}}|$ 的数值代入我们推导出的 $\\lambda$ 表达式中：\n$$\n\\lambda = \\frac{1.08}{1.41926917} \\approx 0.7609653\n$$\n问题要求答案四舍五入至四位有效数字。\n$$\n\\lambda \\approx 0.7610\n$$\n末尾的零是有效数字，必须保留。这个无量纲标量就是解。", "answer": "$$\\boxed{0.7610}$$", "id": "2902779"}, {"introduction": "掌握了连接原子的几何设置后，下一步是理解选择在哪里切断化学键所带来的深远化学影响。仅仅进行机械的划分是远远不够的。本练习通过一个经典的乙醇分子案例，引导您深入分析切断极性键 (如 $C-O$) 与非极性键 (如 $C-C$) 的差异，从而辨识不同划分方案中丢失或引入的伪影，例如静电、诱导和轨道相互作用的扭曲。[@problem_id:2902682]", "problem": "考虑乙醇分子 $\\mathrm{CH_3{-}CH_2{-}OH}$，该分子在混合量子力学/分子力学 (QM/MM) 框架（Quantum Mechanics/Molecular Mechanics (QM/MM)）内进行描述。其总能量在 Born–Oppenheimer 近似水平上通过一个划分的哈密顿量建模：\n$$\n\\hat{H}_{\\mathrm{tot}} = \\hat{H}_{\\mathrm{QM}} + \\hat{H}_{\\mathrm{MM}} + \\hat{H}_{\\mathrm{QM/MM}},\n$$\n其中 $\\hat{H}_{\\mathrm{QM}}$ 作用于量子区域中的电子和原子核，$\\hat{H}_{\\mathrm{MM}}$ 是对分子力学区域的经典力场描述，而 $\\hat{H}_{\\mathrm{QM/MM}}$ 则描述了耦合作用（例如，点电荷的静电嵌入、范德华相互作用，以及移除在共价键切割处否则会被重复计算的成键项）。\n\n为了创建一个最小边界，通常使用连接原子构造：跨越 QM/MM 划分的共价键被切断，QM 边界的价键由一个连接原子（通常是氢）饱和，该连接原子与被切断的键共线放置，并保持典型的键长（例如，$r_{\\mathrm{C{-}H}} \\approx 1.09\\,\\mathrm{\\AA}$）。记 $q_i$ 为 MM 点电荷，$\\mathbf{r}$ 为电子坐标；在静电嵌入中，附加的单电子算符近似为\n$$\n\\hat{V}_{\\mathrm{emb}}(\\mathbf{r}) = \\sum_i \\frac{q_i}{4\\pi\\varepsilon_0 \\lvert \\mathbf{r} - \\mathbf{R}_i \\rvert}.\n$$\n\n分析以下两种乙醇划分方案以及切割不同化学键的物理含义：\n\n- 情况 $\\mathrm{I}$（C–C 键切割）：QM 区域包含 $\\mathrm{HO{-}CH_2}$（氧、羟基氢和 $\\alpha$ 碳），而 $\\mathrm{CH_3}$ 甲基在 MM 区域。切割位置在 $\\mathrm{C_\\alpha{-}C_\\beta}$ 键上，一个连接氢原子在 QM 侧饱和了 $\\mathrm{C_\\alpha}$ 的价键。\n- 情况 $\\mathrm{II}$（C–O 键切割）：QM 区域包含 $\\mathrm{CH_3{-}CH_2}$（乙基片段），而 $\\mathrm{OH}$ 基团在 MM 区域。切割位置在 $\\mathrm{C_\\alpha{-}O}$ 键上，一个连接氢原子在 QM 侧饱和了 $\\mathrm{C_\\alpha}$ 的价键。\n\n仅使用关于划分的哈密顿量、来自 MM 点电荷的静电作用、短程交换排斥和泡利效应（在 QM/MM 共价键切割处缺失）以及化学上合理的轨道相互作用（例如，超共轭 $\\sigma \\rightarrow \\sigma^\\ast$ 和孤对电子给予 $n \\rightarrow \\sigma^\\ast$）的基本考虑，判断哪个陈述正确地指出了在每种情况下丢失或虚假重复的主导物理相互作用，以及控制这些误差所需的边界校正。\n\n选项：\nA. 在情况 $\\mathrm{I}$（C–C 键切割）中，丢失的主导相互作用是 $\\mathrm{CH_3}$ 基团与 $\\mathrm{C_\\alpha{-}O}$ 框架之间的弱穿键超共轭作用，以及 $\\mathrm{CH_3}$ 对 $\\mathrm{C_\\alpha}$ 的轻微诱导极化。标准的连接氢方法，加上移除跨越切割边界的 MM 成键项（例如，跨边界的 $1$–$2$ 和 $1$–$3$ 项），通常是足够的；由于甲基片段极性很弱，不需要特殊的电荷操纵。在情况 $\\mathrm{II}$（C–O 键切割）中，用非极性的 $\\mathrm{C{-}H}$ 连接键取代极性的 $\\mathrm{C{-}O}$ 键，移除了氧对 $\\mathrm{C_\\alpha}$ 的强诱导极化和 $n(\\mathrm{O}) \\rightarrow \\sigma^\\ast(\\mathrm{C{-}C})$ 给予作用；此外，一个邻近的 MM 氧点电荷会在 $\\hat{V}_{\\mathrm{emb}}$ 中过度极化 QM 电子密度，而跨断键的泡利排斥却不存在。因此，除了移除跨边界的 MM 成键项外，还应应用边界校正，例如电荷迁移（设置或减小 $q_{\\mathrm{O}}$ 并将其重新分配给相邻原子）和/或在 QM 侧进行赝键/有效核处理，以模拟氧的电负性并减轻过度极化。\n\nB. 在情况 $\\mathrm{I}$（C–C 键切割）中，甲基片段具有高度极化性，因此电荷迁移至关重要；没有它，强的诱导效应会丢失。在情况 $\\mathrm{II}$（C–O 键切割）中，连接氢忠实地再现了氧的极化能力，因此除了移除跨边界的 MM 成键项外，不需要其他边界校正，也没有化学上显著的轨道相互作用丢失。\n\nC. 这两种切割在物理上是等效的：因为在 QM/MM 共价键切割中只丢失了色散作用，所以两种情况使用相同的边界校正就足够了。为了恢复色散作用并避免重复计算，应该保留跨切割边界的 MM 成键项，并包含未修改的静电作用。\n\nD. 在情况 $\\mathrm{I}$（C–C 键切割）中，主导的重复误差是静电重复计算，因为连接氢带有一个与 QM 密度相互作用的 MM 点电荷；因此必须删除连接氢的 MM 电荷。在情况 $\\mathrm{II}$（C–O 键切割）中，诱导和孤对电子给予效应通过静电嵌入被自动保留，色散作用是唯一丢失的主要相互作用；因此不需要电荷迁移或赝键。", "solution": "所呈现的问题陈述是有效的。它在科学上基于混合量子力学/分子力学 (QM/MM) 模拟的既定原则，特别是用于处理 QM/MM 边界共价键的连接原子方法。该问题提法恰当，为比较分析乙醇分子的两种划分方案提供了清晰客观的基础。所引用的物理效应——静电嵌入、泡利排斥、诱导效应和超共轭——都是该领域的标准概念。基于这些基本原理进行严谨的分析是可能的。\n\n跨共价键进行 QM/MM 划分的核心挑战在于，用经典 MM 描述取代一个 QM 原子会如何影响 QM 区域的电子结构。连接原子方法切断化学键，在 QM 区域中产生一个开放价键，该价键随后被饱和，通常由一个氢原子完成。MM 片段仅通过 $\\hat{H}_{\\mathrm{QM/MM}}$ 项与 QM 区域相互作用，在所述的静电嵌入方案中，该项主要由 QM 电子密度与 MM 点电荷之间的库仑相互作用 $\\hat{V}_{\\mathrm{emb}}(\\mathbf{r})$ 决定。该方案未能捕捉 QM 和 MM 片段之间跨越先前化学键的短程量子效应，例如泡利排斥、电荷转移和交换-相关作用。这种近似的质量关键取决于被切断键的性质。一个指导原则是，如果可以避免，QM/MM 边界不应切割高极性键或共轭体系。\n\n情况 $\\mathrm{I}$（C–C 键切割）分析：\nQM 区域是 $\\mathrm{HO{-}CH_2}$，MM 区域是 $\\mathrm{CH_3}$。被切断的键是 $\\mathrm{C_\\alpha{-}C_\\beta}$ 键。此键连接两个 $sp^3$ 杂化的碳原子，其特点是极性低。在 QM 计算中，这个 $\\mathrm{C_\\alpha{-}C_\\beta}$ 键被一个 $\\mathrm{C_\\alpha{-}H}$ 键取代，其中 H 是连接原子。$\\mathrm{C{-}H}$ 键的极性也很低。因此，用氢原子取代甲基并不会对 $\\mathrm{C_\\alpha}$ 原子的局部电子环境引入剧烈的微扰。丢失的主要量子力学效应是：\n$1$. 甲基的诱导效应，它是弱给电子性的。这被甲基原子上的 MM 点电荷通过 $\\hat{V}_{\\mathrm{emb}}$ 部分且不完美地模仿。\n$2$. 超共轭，涉及诸如 $\\sigma_{\\mathrm{C_\\beta H}} \\rightarrow \\sigma^\\ast_{\\mathrm{C_\\alpha O}}$ 的轨道相互作用。这些穿键离域效应本质上是量子力学的，在经典 MM 描述中完全不存在。\n$3$. QM 片段的电子云与 MM 甲基之间的泡利排斥。\n鉴于对于一个 $\\mathrm{C{-}C}$ 键来说，这些丢失的相互作用相对较弱，标准的连接原子方案，辅以移除涉及两个区域的原子的成键 MM 项（键、角、二面角）以防止重复计算，通常被认为是一个合理的近似。对于这种非极性切割，通常不认为需要特殊的电荷修改。\n\n情况 $\\mathrm{II}$（C–O 键切割）分析：\nQM 区域是 $\\mathrm{CH_3{-}CH_2}$，MM 区域是 $\\mathrm{OH}$ 基团。被切断的键是 $\\mathrm{C_\\alpha{-}O}$ 键。由于碳（约 2.55）和氧（约 3.44）之间巨大的电负性差异，此键是高极性的。在 QM 计算中，电负性很强的氧原子被一个氢连接原子取代。这构成了严重的电子微扰，原因如下：\n$1$. 失去强诱导效应：氧原子的强吸电子性显著地极化了整个乙基片段，而这种性质丢失了。QM 系统被建模为乙烷（$\\mathrm{CH_3{-}CH_3}$），它是非极性的，这是对乙醇中极化乙基的根本上糟糕的表示。\n$2$. 失去孤对电子相互作用：氧原子拥有两对孤对电子（$n_{\\mathrm{O}}$）。这些孤对电子可以参与超共轭给予，进入乙基的反键轨道，例如 $n_{\\mathrm{O}} \\rightarrow \\sigma^\\ast_{\\mathrm{C_\\alpha C_\\beta}}$。这种显著的量子力学稳定化相互作用完全不存在。\n$3$. 虚假的过度极化：MM 氧原子带有一个可观的负点电荷（$q_{\\mathrm{O}}$）。在静电嵌入哈密顿量 $\\hat{V}_{\\mathrm{emb}}$ 中，此电荷位于非常靠近 QM 区域的位置。如果没有来自氧原子核和价电子的相应泡利排斥（这些在 MM 模型中不存在），这个大的负电荷会不切实际地吸引 QM 电子密度，导致其向 MM 原子“溢出”。这是一个众所周知的赝象。\n\n由于这些严重问题，切割像 $\\mathrm{C{-}O}$ 这样的极性键需要比标准连接原子方法更复杂的边界校正。这些校正包括电荷迁移方案（例如，设置 $q_{\\mathrm{O}}=0$ 并将电荷重新分配给更远的 MM 原子以减轻过度极化）和/或在边界 QM 原子（$\\mathrm{C_\\alpha}$）上使用特殊化的势，如赝键或有效核势，以更好地模仿缺失原子（氧）的电负性和空间位阻性质。\n\n选项评估：\n\nA. 该陈述正确地指出了情况 $\\mathrm{I}$ 中丢失的相互作用是“弱的穿键超共轭作用”和“轻微的诱导极化”，并正确地得出结论，即标准的连接原子处理通常是足够的，因为甲基是弱极性的。对于情况 $\\mathrm{II}$，它正确地指出了关键问题：通过用非极性的 $\\mathrm{C{-}H}$ 连接取代极性的 $\\mathrm{C{-}O}$ 键，移除了“强的诱导极化”和“$n(\\mathrm{O}) \\rightarrow \\sigma^\\ast(\\mathrm{C{-}C})$ 给予”作用。它准确地描述了在没有泡利排斥的情况下，来自 MM 氧电荷的过度极化赝象。最后，它正确地规定了必要的高级校正，例如“电荷迁移”或“赝键/有效核处理”。整个陈述与 QM/MM 理论的原则完全一致。\n结论：**正确**。\n\nB. 该陈述在情况 $\\mathrm{I}$ 中声称甲基片段是“高度极化的”，需要电荷迁移。这是错误的；甲基是弱给电子基团，不是高度极化的。它在情况 $\\mathrm{II}$ 中声称“连接氢忠实地再现了氧的极化能力”。由于 H 和 O 之间电负性的巨大差异，这在根本上是不正确的。因此，其关于不需要特殊校正的结论也是错误的。\n结论：**不正确**。\n\nC. 该陈述以“两种切割在物理上是等效的”这一错误前提开始。如前所述，切割非极性的 C–C 键和高极性的 C–O 键具有截然不同的物理和电子后果。它错误地声称“只有色散作用丢失”，忽略了诱导、超共轭和泡利排斥。它还建议保留跨切割边界的 MM 成键项，这将导致灾难性的力的重复计算。\n结论：**不正确**。\n\nD. 该陈述错误地将情况 $\\mathrm{I}$ 中的主导误差识别为来自连接氢 MM 点电荷的静电重复计算。在标准实现中，连接原子没有 MM 点电荷；它纯粹是一个 QM 实体。对于情况 $\\mathrm{II}$，它错误地声称“诱导和孤对电子给予效应通过静电嵌入被自动保留”。这与事实恰恰相反；经典静电嵌入无法捕捉这些固有的量子力学轨道效应，这正是切割极性键存在问题的原因。\n结论：**不正确**。", "answer": "$$\\boxed{A}$$", "id": "2902682"}, {"introduction": "概念上的理解最终需要通过定量分析来验证和深化。本实践将指导您构建一个简化的计算模型，以量化不同边界处理方案（如连接原子 LA、广义杂化轨道 GHO 和赝键 PB）引入的能量和电子布居伪影。通过与一个完整的量子化学参考模型进行比较，该练习旨在培养一种严谨的测试和评估方法，这对于在实际研究中选择和验证合适的 $QM/MM$ 边界方案至关重要。[@problem_id:2918439]", "problem": "设计一个基于物理原理的计算测试，用于量化在量子力学/分子力学 (QM/MM) 划分中，于不同位置切断肽键时，由不同边界处理方法所引入的赝象。目标是测量三种常见的边界处理方法——连接原子 (LA)、广义杂化轨道 (GHO) 和赝键 (PB)——相对于一个最小的全量子参考体系，对酰胺键的量子力学可观测量所造成的扭曲。\n\n从有限维紧束缚 (Hückel-类型) 模型的定态薛定谔方程出发，该模型是量子化学中对局域价轨道的一种经过充分检验的抽象：对于哈密顿矩阵 $\\mathbf{H}$ 和波函数系数向量 $\\mathbf{c}$，其本征值问题为\n$$\n\\mathbf{H}\\,\\mathbf{c} \\;=\\; E\\,\\mathbf{c}.\n$$\n考虑一个线性位点链，用以最简化地表示酰胺 $\\pi$ 体系及其直接环境。使用单电子图像，其中只有一个双占据的分子轨道：每个电子的可观测能量是最低本征值 $E_{\\min}$，而位点布居数由对应于 $E_{\\min}$ 的归一化本征向量各分量的模平方给出。\n\n定义以下模型。\n\n- 全参考模型：\n  - 左环境模型 (在 $\\mathrm{C_{\\alpha}}$–$\\mathrm{C}$ 键处切断)：一个排序为 $\\left[\\mathrm{L},\\mathrm{C},\\mathrm{N}\\right]$ 的三位点哈密顿量，\n    $$\n    \\mathbf{H}_{\\mathrm{full}}^{\\mathrm{left}} \\;=\\;\n    \\begin{bmatrix}\n    \\varepsilon_{\\mathrm{L}} & t_{\\mathrm{LC}} & 0 \\\\\n    t_{\\mathrm{LC}} & \\varepsilon_{\\mathrm{C}} & t_{\\mathrm{CN}} \\\\\n    0 & t_{\\mathrm{CN}} & \\varepsilon_{\\mathrm{N}}\n    \\end{bmatrix}.\n    $$\n  - 右环境模型 (在 $\\mathrm{N}$–$\\mathrm{C'}$ 键处切断)：一个排序为 $\\left[\\mathrm{C},\\mathrm{N},\\mathrm{R}\\right]$ 的三位点哈密顿量，\n    $$\n    \\mathbf{H}_{\\mathrm{full}}^{\\mathrm{right}} \\;=\\;\n    \\begin{bmatrix}\n    \\varepsilon_{\\mathrm{C}} & t_{\\mathrm{CN}} & 0 \\\\\n    t_{\\mathrm{CN}} & \\varepsilon_{\\mathrm{N}} & t_{\\mathrm{NR}} \\\\\n    0 & t_{\\mathrm{NR}} & \\varepsilon_{\\mathrm{R}}\n    \\end{bmatrix}.\n    $$\n  在两种情况下，对角元均为位点能量，单位为电子伏特 (eV)，非对角元为最近邻耦合，单位也为电子伏特 (eV)。最低本征值 $E_{\\min}^{\\mathrm{full}}$ 及其归一化本征向量 $\\mathbf{c}^{\\mathrm{full}}$ 提供参考基准。\n\n- 用于酰胺键 $\\left[\\mathrm{C},\\mathrm{N}\\right]$ 的简化双位点量子区域：\n  $$\n  \\mathbf{H}_{\\mathrm{QM}} \\;=\\;\n  \\begin{bmatrix}\n  \\varepsilon_{\\mathrm{C}}^{\\mathrm{eff}} & t_{\\mathrm{CN}}^{\\mathrm{eff}} \\\\\n  t_{\\mathrm{CN}}^{\\mathrm{eff}} & \\varepsilon_{\\mathrm{N}}^{\\mathrm{eff}}\n  \\end{bmatrix},\n  $$\n  其中有效参数 $\\varepsilon_{\\mathrm{C}}^{\\mathrm{eff}}$、$\\varepsilon_{\\mathrm{N}}^{\\mathrm{eff}}$ 和 $t_{\\mathrm{CN}}^{\\mathrm{eff}}$ 取决于边界处理方法以及切断在哪一侧。\n\n定义三种边界处理方法，其有效参数规则如下，这些规则基于二阶 Löwdin 划分和有物理动机的近似。\n\n- 连接原子 (LA)：用一个类氢连接取代缺失的共价伴侣，通过二阶微扰仅修正边界位点的在位能，而内部耦合保持不变。\n  - 对于左侧切断，边界位点为 $\\mathrm{C}$：\n    $$\n    \\varepsilon_{\\mathrm{C}}^{\\mathrm{eff}} \\;=\\; \\varepsilon_{\\mathrm{C}} \\;+\\; \\frac{t_{\\mathrm{CH}}^{2}}{\\varepsilon_{\\mathrm{C}} - \\varepsilon_{\\mathrm{H}}}, \n    \\quad\n    \\varepsilon_{\\mathrm{N}}^{\\mathrm{eff}} \\;=\\; \\varepsilon_{\\mathrm{N}},\n    \\quad\n    t_{\\mathrm{CN}}^{\\mathrm{eff}} \\;=\\; t_{\\mathrm{CN}}.\n    $$\n  - 对于右侧切断，边界位点为 $\\mathrm{N}$：\n    $$\n    \\varepsilon_{\\mathrm{N}}^{\\mathrm{eff}} \\;=\\; \\varepsilon_{\\mathrm{N}} \\;+\\; \\frac{t_{\\mathrm{NH}}^{2}}{\\varepsilon_{\\mathrm{N}} - \\varepsilon_{\\mathrm{H}}}, \n    \\quad\n    \\varepsilon_{\\mathrm{C}}^{\\mathrm{eff}} \\;=\\; \\varepsilon_{\\mathrm{C}},\n    \\quad\n    t_{\\mathrm{CN}}^{\\mathrm{eff}} \\;=\\; t_{\\mathrm{CN}}.\n    $$\n\n- 广义杂化轨道 (GHO)：通过结合部分二阶在位能移和减小内部耦合来模拟切断处的再杂化，以解释朝向环境的杂化占据。\n  - 令 $\\alpha$ 为一个缩减因子，满足 $0 < \\alpha < 1$。定义\n    $$\n    f \\;=\\; \\frac{t_{\\mathrm{env}}^{2}}{t_{\\mathrm{env}}^{2} + t_{\\mathrm{CN}}^{2}}, \n    \\quad s \\;=\\; \\sqrt{1 - f}.\n    $$\n    对于左侧切断：\n    $$\n    \\varepsilon_{\\mathrm{C}}^{\\mathrm{eff}} \\;=\\; \\varepsilon_{\\mathrm{C}} \\;+\\; \\alpha\\,\\frac{t_{\\mathrm{LC}}^{2}}{\\varepsilon_{\\mathrm{C}} - \\varepsilon_{\\mathrm{L}}},\n    \\quad\n    \\varepsilon_{\\mathrm{N}}^{\\mathrm{eff}} \\;=\\; \\varepsilon_{\\mathrm{N}},\n    \\quad\n    t_{\\mathrm{CN}}^{\\mathrm{eff}} \\;=\\; s\\,t_{\\mathrm{CN}}.\n    $$\n    对于右侧切断：\n    $$\n    \\varepsilon_{\\mathrm{N}}^{\\mathrm{eff}} \\;=\\; \\varepsilon_{\\mathrm{N}} \\;+\\; \\alpha\\,\\frac{t_{\\mathrm{NR}}^{2}}{\\varepsilon_{\\mathrm{N}} - \\varepsilon_{\\mathrm{R}}},\n    \\quad\n    \\varepsilon_{\\mathrm{C}}^{\\mathrm{eff}} \\;=\\; \\varepsilon_{\\mathrm{C}},\n    \\quad\n    t_{\\mathrm{CN}}^{\\mathrm{eff}} \\;=\\; s\\,t_{\\mathrm{CN}}.\n    $$\n\n- 赝键 (PB)：在二阶上对环境进行积分消除，以获得边界位点上的一个有效在位能移，同时保持内部耦合不变 (这是在参考能量等于边界位点能量处所做的非能量依赖近似)。\n  - 对于左侧切断：\n    $$\n    \\varepsilon_{\\mathrm{C}}^{\\mathrm{eff}} \\;=\\; \\varepsilon_{\\mathrm{C}} \\;+\\; \\frac{t_{\\mathrm{LC}}^{2}}{\\varepsilon_{\\mathrm{C}} - \\varepsilon_{\\mathrm{L}}},\n    \\quad\n    \\varepsilon_{\\mathrm{N}}^{\\mathrm{eff}} \\;=\\; \\varepsilon_{\\mathrm{N}},\n    \\quad\n    t_{\\mathrm{CN}}^{\\mathrm{eff}} \\;=\\; t_{\\mathrm{CN}}.\n    $$\n  - 对于右侧切断：\n    $$\n    \\varepsilon_{\\mathrm{N}}^{\\mathrm{eff}} \\;=\\; \\varepsilon_{\\mathrm{N}} \\;+\\; \\frac{t_{\\mathrm{NR}}^{2}}{\\varepsilon_{\\mathrm{N}} - \\varepsilon_{\\mathrm{R}}},\n    \\quad\n    \\varepsilon_{\\mathrm{C}}^{\\mathrm{eff}} \\;=\\; \\varepsilon_{\\mathrm{C}},\n    \\quad\n    t_{\\mathrm{CN}}^{\\mathrm{eff}} \\;=\\; t_{\\mathrm{CN}}.\n    $$\n\n对任何情况，定义如下的量化赝象。\n\n- 能级赝象 (单位为电子伏特, eV)：令 $E_{\\min}^{\\mathrm{full}}$ 为相关 $\\mathbf{H}_{\\mathrm{full}}$ 的最低本征值，$E_{\\min}^{\\mathrm{method}}$ 为由边界方法构建的 $\\mathbf{H}_{\\mathrm{QM}}$ 的最低本征值。定义\n  $$\n  \\Delta E \\;=\\; E_{\\min}^{\\mathrm{method}} \\;-\\; E_{\\min}^{\\mathrm{full}} \\quad \\text{(in eV)}.\n  $$\n\n- 布居数赝象 (无量纲)：令 $\\mathbf{c}^{\\mathrm{full}}$ 为全模型中 $E_{\\min}^{\\mathrm{full}}$ 对应的归一化本征向量，$\\mathbf{u}^{\\mathrm{method}}$ 为双位点模型中 $E_{\\min}^{\\mathrm{method}}$ 对应的归一化本征向量。定义量子区域的索引为 $\\mathcal{Q}=\\{\\mathrm{C},\\mathrm{N}\\}$。计算全模型在量子区域上的布居数，并在此区域内重新归一化：\n  $$\n  p_{\\mathrm{C}}^{\\mathrm{full}} \\;=\\; \\frac{|c_{\\mathrm{C}}^{\\mathrm{full}}|^{2}}{|c_{\\mathrm{C}}^{\\mathrm{full}}|^{2} + |c_{\\mathrm{N}}^{\\mathrm{full}}|^{2}}, \n  \\quad\n  p_{\\mathrm{N}}^{\\mathrm{full}} \\;=\\; \\frac{|c_{\\mathrm{N}}^{\\mathrm{full}}|^{2}}{|c_{\\mathrm{C}}^{\\mathrm{full}}|^{2} + |c_{\\mathrm{N}}^{\\mathrm{full}}|^{2}}.\n  $$\n  计算方法模型的布居数 $p_{\\mathrm{C}}^{\\mathrm{method}} = |u_{\\mathrm{C}}^{\\mathrm{method}}|^{2}$ 和 $p_{\\mathrm{N}}^{\\mathrm{method}} = |u_{\\mathrm{N}}^{\\mathrm{method}}|^{2}$。布居数赝象是欧几里得范数\n  $$\n  D \\;=\\; \\sqrt{\\left(p_{\\mathrm{C}}^{\\mathrm{method}} - p_{\\mathrm{C}}^{\\mathrm{full}}\\right)^{2} + \\left(p_{\\mathrm{N}}^{\\mathrm{method}} - p_{\\mathrm{N}}^{\\mathrm{full}}\\right)^{2}}.\n  $$\n\n实现一个程序，对于下述每个测试案例，构建相应的全哈密顿量和简化哈密顿量，计算 $\\Delta E$ 和 $D$，并报告输出结果。\n\n使用以下常数和参数值，所有能量和耦合均以电子伏特 (eV) 表示：\n\n- 核心酰胺参数：\n  - $\\varepsilon_{\\mathrm{C}} = -10.0$,\n  - $\\varepsilon_{\\mathrm{N}} = -12.0$,\n  - $t_{\\mathrm{CN}} = -2.0$.\n- 环境参数 (用于全模型)：\n  - $\\varepsilon_{\\mathrm{L}} = \\varepsilon_{\\mathrm{R}} = -11.0$,\n  - $t_{\\mathrm{LC}}$ 和 $t_{\\mathrm{NR}}$ 将在每个测试案例中指定为 $t_{\\mathrm{env}}$.\n- 连接原子参数 (仅用于 LA 有效模型)：\n  - $\\varepsilon_{\\mathrm{H}} = -13.6$,\n  - $t_{\\mathrm{CH}} = t_{\\mathrm{NH}} = -1.0$.\n- 广义杂化轨道缩放参数：\n  - $\\alpha = 0.5$.\n\n定义包含六个案例的测试套件，以探究不同方面：\n\n- 案例 $\\mathrm{A}$：左侧切断，使用 LA，$t_{\\mathrm{env}} = -1.0$.\n- 案例 $\\mathrm{B}$：左侧切断，使用 GHO，$t_{\\mathrm{env}} = -1.0$.\n- 案例 $\\mathrm{C}$：左侧切断，使用 PB，$t_{\\mathrm{env}} = -1.0$.\n- 案例 $\\mathrm{D}$：右侧切断，使用 LA，$t_{\\mathrm{env}} = -1.0$.\n- 案例 $\\mathrm{E}$ (边缘情况，弱耦合)：左侧切断，使用 LA，$t_{\\mathrm{env}} = -0.1$.\n- 案例 $\\mathrm{F}$ (边缘情况，强耦合)：左侧切断，使用 PB，$t_{\\mathrm{env}} = -3.0$.\n\n角度单位不适用。能量必须以电子伏特 (eV) 报告。布居数赝象是无量纲的。您的程序必须生成单行输出，其中包含所有六个案例的结果，形式为包含在方括号内的逗号分隔列表，按如下顺序排列\n$$\n\\left[\\Delta E_{\\mathrm{A}},\\, D_{\\mathrm{A}},\\, \\Delta E_{\\mathrm{B}},\\, D_{\\mathrm{B}},\\, \\Delta E_{\\mathrm{C}},\\, D_{\\mathrm{C}},\\, \\Delta E_{\\mathrm{D}},\\, D_{\\mathrm{D}},\\, \\Delta E_{\\mathrm{E}},\\, D_{\\mathrm{E}},\\, \\Delta E_{\\mathrm{F}},\\, D_{\\mathrm{F}}\\right],\n$$\n每个浮点数四舍五入到 6 位小数。$\\Delta E$ 以电子伏特 (eV) 表示，$D$ 为无量纲数。不应打印任何其他文本。最终程序必须是完整的，并且无需外部输入或文件即可运行。", "solution": "所提出的问题是计算量子化学中一个定义明确的练习。它在科学上基于紧束缚理论和QM/MM边界方法的原理，在数学上是一致的，并为获得唯一解提供了所需的全部参数和定义。任务是制定并实现一个计算流程，以在一个简化的肽模型中量化由不同共价键切断方案产生的赝象。因此，该问题被认为是有效的，并将提供一个严谨的解决方案。\n\n问题的核心是为几个模型哈密顿量求解表示为矩阵本征值问题 $\\mathbf{H}\\,\\mathbf{c} = E\\,\\mathbf{c}$ 的定态薛定谔方程，并比较结果。对每个测试案例，可以通过遵循一个三步流程来系统地构建解决方案：首先，建立全量子参考基准；其次，根据指定的边界处理方法构建简化的双位点量子力学 (QM) 模型；第三，通过比较两个模型的可观测量来计算定义的赝象。\n\n参考计算始于构建一个代表未划分系统的 $3 \\times 3$ 哈密顿矩阵 $\\mathbf{H}_{\\mathrm{full}}$。该系统包含酰胺键原子碳 ($C$) 和氮 ($N$)，外加一个来自左侧 ($L$) 或右侧 ($R$) 的环境位点。对于在左侧的切断，排序基矢为 $[\\mathrm{L}, \\mathrm{C}, \\mathrm{N}]$，哈密顿量为：\n$$\n\\mathbf{H}_{\\mathrm{full}}^{\\mathrm{left}} =\n\\begin{bmatrix}\n\\varepsilon_{\\mathrm{L}} & t_{\\mathrm{LC}} & 0 \\\\\nt_{\\mathrm{LC}} & \\varepsilon_{\\mathrm{C}} & t_{\\mathrm{CN}} \\\\\n0 & t_{\\mathrm{CN}} & \\varepsilon_{\\mathrm{N}}\n\\end{bmatrix}\n$$\n对于在右侧的切断，基矢为 $[\\mathrm{C}, \\mathrm{N}, \\mathrm{R}]$，哈密顿量为：\n$$\n\\mathbf{H}_{\\mathrm{full}}^{\\mathrm{right}} =\n\\begin{bmatrix}\n\\varepsilon_{\\mathrm{C}} & t_{\\mathrm{CN}} & 0 \\\\\nt_{\\mathrm{CN}} & \\varepsilon_{\\mathrm{N}} & t_{\\mathrm{NR}} \\\\\n0 & t_{\\mathrm{NR}} & \\varepsilon_{\\mathrm{R}}\n\\end{bmatrix}\n$$\n参数 $\\varepsilon_i$ 是在位能，$t_{ij}$ 是耦合项。由于这些矩阵是实对称的，它们的本征值是实数，本征向量是正交的。我们求解 $\\mathbf{H}_{\\mathrm{full}}$ 的本征值问题，以找到其最低本征值 $E_{\\min}^{\\mathrm{full}}$ 和相应的归一化本征向量 $\\mathbf{c}^{\\mathrm{full}} = [c_1, c_2, c_3]^T$。然后提取 QM 区域的向量分量 $c_{\\mathrm{C}}^{\\mathrm{full}}$ 和 $c_{\\mathrm{N}}^{\\mathrm{full}}$。它们的模平方被用来计算 QM 区域内的参考布居数，经过重新归一化后：\n$$\np_{\\mathrm{C}}^{\\mathrm{full}} = \\frac{|c_{\\mathrm{C}}^{\\mathrm{full}}|^{2}}{|c_{\\mathrm{C}}^{\\mathrm{full}}|^{2} + |c_{\\mathrm{N}}^{\\mathrm{full}}|^{2}}, \\quad p_{\\mathrm{N}}^{\\mathrm{full}} = 1 - p_{\\mathrm{C}}^{\\mathrm{full}}\n$$\n\n接下来，我们为简化的双位点 QM 区域 $[\\mathrm{C}, \\mathrm{N}]$ 构建有效的 $2 \\times 2$ 哈密顿量 $\\mathbf{H}_{\\mathrm{QM}}$：\n$$\n\\mathbf{H}_{\\mathrm{QM}} =\n\\begin{bmatrix}\n\\varepsilon_{\\mathrm{C}}^{\\mathrm{eff}} & t_{\\mathrm{CN}}^{\\mathrm{eff}} \\\\\nt_{\\mathrm{CN}}^{\\mathrm{eff}} & \\varepsilon_{\\mathrm{N}}^{\\mathrm{eff}}\n\\end{bmatrix}\n$$\n有效参数取决于边界处理方法——连接原子 (LA)、广义杂化轨道 (GHO) 或赝键 (PB)——以及切断的位置。\n\n对于连接原子 (LA) 方法，环境被一个类氢原子取代。对于左侧切断，这会修正边界位点 $\\mathrm{C}$ 的能量：\n$$\n\\varepsilon_{\\mathrm{C}}^{\\mathrm{eff}} = \\varepsilon_{\\mathrm{C}} + \\frac{t_{\\mathrm{CH}}^{2}}{\\varepsilon_{\\mathrm{C}} - \\varepsilon_{\\mathrm{H}}}\n$$\n其他参数保持不变：$\\varepsilon_{\\mathrm{N}}^{\\mathrm{eff}} = \\varepsilon_{\\mathrm{N}}$ 和 $t_{\\mathrm{CN}}^{\\mathrm{eff}} = t_{\\mathrm{CN}}$。对于右侧切断，类似的修正会使用 $t_{\\mathrm{NH}}$ 应用于 $\\varepsilon_{\\mathrm{N}}$。\n\n对于广义杂化轨道 (GHO) 方法，在位能和内部耦合都会被调整。对于左侧切断，当 $t_{\\mathrm{env}} = t_{\\mathrm{LC}}$ 时，我们定义因子 $f = \\frac{t_{\\mathrm{env}}^{2}}{t_{\\mathrm{env}}^{2} + t_{\\mathrm{CN}}^{2}}$ 和 $s = \\sqrt{1 - f}$。有效参数为：\n$$\n\\varepsilon_{\\mathrm{C}}^{\\mathrm{eff}} = \\varepsilon_{\\mathrm{C}} + \\alpha\\,\\frac{t_{\\mathrm{LC}}^{2}}{\\varepsilon_{\\mathrm{C}} - \\varepsilon_{\\mathrm{L}}}, \\quad \\varepsilon_{\\mathrm{N}}^{\\mathrm{eff}} = \\varepsilon_{\\mathrm{N}}, \\quad t_{\\mathrm{CN}}^{\\mathrm{eff}} = s\\,t_{\\mathrm{CN}}\n$$\n其中 $\\alpha$ 是一个缩放因子。类似的规则适用于右侧切断。\n\n对于赝键 (PB) 方法，通过对边界位点能量的二阶微扰修正来积分消除环境的影响。对于左侧切断，修正为：\n$$\n\\varepsilon_{\\mathrm{C}}^{\\mathrm{eff}} = \\varepsilon_{\\mathrm{C}} + \\frac{t_{\\mathrm{LC}}^{2}}{\\varepsilon_{\\mathrm{C}} - \\varepsilon_{\\mathrm{L}}}\n$$\n其他参数不变：$\\varepsilon_{\\mathrm{N}}^{\\mathrm{eff}} = \\varepsilon_{\\mathrm{N}}$ 和 $t_{\\mathrm{CN}}^{\\mathrm{eff}} = t_{\\mathrm{CN}}$。类似的规则适用于右侧切断。此方法在形式上与 LA 方法相同，但关键区别在于它使用真实的环境参数（$\\varepsilon_{\\mathrm{L}}$, $t_{\\mathrm{LC}}$），而不是标准化的连接原子参数（$\\varepsilon_{\\mathrm{H}}$, $t_{\\mathrm{CH}}$）。\n\n一旦为给定方法构建了 $\\mathbf{H}_{\\mathrm{QM}}$，我们求解其本征值问题，以找到最低本征值 $E_{\\min}^{\\mathrm{method}}$ 及其对应的归一化本征向量 $\\mathbf{u}^{\\mathrm{method}} = [u_{\\mathrm{C}}, u_{\\mathrm{N}}]^T$。此方法的布居数则简单地为 $p_{\\mathrm{C}}^{\\mathrm{method}} = |u_{\\mathrm{C}}|^{2}$ 和 $p_{\\mathrm{N}}^{\\mathrm{method}} = |u_{\\mathrm{N}}|^{2}$。\n\n最后，计算赝象。能级赝象 $\\Delta E$ 衡量基态能量的绝对误差：\n$$\n\\Delta E = E_{\\min}^{\\mathrm{method}} - E_{\\min}^{\\mathrm{full}}\n$$\n布居数赝象 $D$ 将 QM 区域内电子分布的扭曲量化为布居数向量之间的欧几里得距离：\n$$\nD = \\sqrt{\\left(p_{\\mathrm{C}}^{\\mathrm{method}} - p_{\\mathrm{C}}^{\\mathrm{full}}\\right)^{2} + \\left(p_{\\mathrm{N}}^{\\mathrm{method}} - p_{\\mathrm{N}}^{\\mathrm{full}}\\right)^{2}}\n$$\n此协议将应用于六个指定的测试案例中的每一个。一个计算程序将实现这些步骤，使用数值线性代数库来求解 $3 \\times 3$ 和 $2 \\times 2$ 矩阵的本征值问题。最终输出是每个案例计算出的赝象 $(\\Delta E, D)$ 的有序列表。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the QM/MM boundary artifact problem by calculating energy and\n    population artifacts for six test cases.\n    \"\"\"\n\n    # Define constants and parameters in electronvolt (eV)\n    params = {\n        'eps_C': -10.0,\n        'eps_N': -12.0,\n        't_CN': -2.0,\n        'eps_L': -11.0,\n        'eps_R': -11.0,  # Same as eps_L as per problem\n        'eps_H': -13.6,\n        't_CH': -1.0,\n        't_NH': -1.0,    # Same as t_CH as per problem\n        'alpha': 0.5,\n    }\n\n    # Define the six test cases\n    # Each tuple: (case_name, cut_side, method, t_env)\n    test_cases = [\n        ('A', 'left', 'LA', -1.0),\n        ('B', 'left', 'GHO', -1.0),\n        ('C', 'left', 'PB', -1.0),\n        ('D', 'right', 'LA', -1.0),\n        ('E', 'left', 'LA', -0.1),\n        ('F', 'left', 'PB', -3.0),\n    ]\n\n    results = []\n    \n    for _, cut_side, method, t_env in test_cases:\n        # Step 1: Construct and solve the full reference model\n        if cut_side == 'left':\n            t_LC = t_env\n            H_full = np.array([\n                [params['eps_L'], t_LC, 0],\n                [t_LC, params['eps_C'], params['t_CN']],\n                [0, params['t_CN'], params['eps_N']]\n            ])\n            # QM region corresponds to indices 1 (C) and 2 (N)\n            qm_indices = [1, 2]\n        else: # cut_side == 'right'\n            t_NR = t_env\n            H_full = np.array([\n                [params['eps_C'], params['t_CN'], 0],\n                [params['t_CN'], params['eps_N'], t_NR],\n                [0, t_NR, params['eps_R']]\n            ])\n            # QM region corresponds to indices 0 (C) and 1 (N)\n            qm_indices = [0, 1]\n\n        evals_full, evecs_full = np.linalg.eigh(H_full)\n        E_min_full = evals_full[0]\n        c_full = evecs_full[:, 0]\n\n        # Step 2: Calculate reference populations\n        c_C_full = c_full[qm_indices[0]]\n        c_N_full = c_full[qm_indices[1]]\n        \n        pop_C_full_unnorm = c_C_full**2\n        pop_N_full_unnorm = c_N_full**2\n        norm_factor = pop_C_full_unnorm + pop_N_full_unnorm\n        \n        p_C_full = pop_C_full_unnorm / norm_factor\n        p_N_full = pop_N_full_unnorm / norm_factor\n        \n        # Step 3: Construct the reduced QM model based on the method\n        eps_C_eff = params['eps_C']\n        eps_N_eff = params['eps_N']\n        t_CN_eff = params['t_CN']\n\n        if method == 'LA':\n            if cut_side == 'left':\n                eps_C_eff += params['t_CH']**2 / (params['eps_C'] - params['eps_H'])\n            else: # right\n                eps_N_eff += params['t_NH']**2 / (params['eps_N'] - params['eps_H'])\n        \n        elif method == 'GHO':\n            f = t_env**2 / (t_env**2 + params['t_CN']**2)\n            s = np.sqrt(1 - f)\n            t_CN_eff = s * params['t_CN']\n            if cut_side == 'left':\n                eps_C_eff += params['alpha'] * t_env**2 / (params['eps_C'] - params['eps_L'])\n            else: # right\n                eps_N_eff += params['alpha'] * t_env**2 / (params['eps_N'] - params['eps_R'])\n\n        elif method == 'PB':\n            if cut_side == 'left':\n                eps_C_eff += t_env**2 / (params['eps_C'] - params['eps_L'])\n            else: # right\n                eps_N_eff += t_env**2 / (params['eps_N'] - params['eps_R'])\n\n        H_QM = np.array([\n            [eps_C_eff, t_CN_eff],\n            [t_CN_eff, eps_N_eff]\n        ])\n\n        # Step 4: Solve the QM model\n        evals_method, evecs_method = np.linalg.eigh(H_QM)\n        E_min_method = evals_method[0]\n        u_method = evecs_method[:, 0]\n\n        p_C_method = u_method[0]**2\n        p_N_method = u_method[1]**2\n        \n        # Step 5: Calculate artifacts\n        delta_E = E_min_method - E_min_full\n        D = np.sqrt((p_C_method - p_C_full)**2 + (p_N_method - p_N_full)**2)\n\n        results.extend([delta_E, D])\n\n    # Final print statement in the exact required format\n    # The format string ensures each number is rounded to 6 decimal places.\n    output_str = f\"[{','.join([f'{r:.6f}' for r in results])}]\"\n    print(output_str)\n\nsolve()\n```", "id": "2918439"}]}