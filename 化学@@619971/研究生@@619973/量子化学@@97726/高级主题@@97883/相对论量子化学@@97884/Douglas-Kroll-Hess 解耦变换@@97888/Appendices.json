{"hands_on_practices": [{"introduction": "本章的第一个实践是一个概念性练习，旨在梳理 Douglas-Kroll-Hess (DKH) 变换的完整程序。此练习强调了将四分量狄拉克哈密顿算符 $H$ 变换为二分量有效哈密顿算符所需的一系列矩阵操作。掌握这个工作流程是实现或正确使用 DKH 方法的第一步，并为后续更详细的计算提供了高层次的蓝图 [@problem_id:2887198]。", "problem": "在相对论量子化学中，获得纯电子有效哈密顿算符的一条常用路径始于在有限非正交基中表示的四分量狄拉克单电子算符。考虑在一个具有重叠矩阵 $\\mathbf{S}$ 的基中，狄拉克哈密顿算符 $\\mathbf{H}$ 的矩阵表示，其中 $\\mathbf{S}$ 是正定的，并且 $\\mathbf{H}$ 相对于狄拉克矩阵 $\\beta$ 进行了划分。Douglas-Kroll-Hess (DKH) 解耦通过一系列矩阵运算进行，旨在将 $\\mathbf{H}$ 相对于正能和负能子空间进行块对角化，从而为正能（电子）态生成一个二分量哈密顿算符。\n\n哪个选项最佳地概述了获得这样一个指定阶数下的解耦二分量哈密顿算符的科学正确且内部一致的矩阵步骤序列，并强调了以下几点：基的正交归一化，相对于 $\\beta$ 构建偶算符块 $\\mathbf{E}$ 和奇算符块 $\\mathbf{O}$，确定一个在所选阶数下强制解耦的反厄米生成元 $\\mathbf{S}$，以及应用 Baker-Campbell-Hausdorff (BCH) 展开来实现幺正变换？\n\nA. \n- 通过寻找满足 $\\mathbf{X}^\\dagger \\mathbf{S} \\mathbf{X} = \\mathbf{I}$ 的 $\\mathbf{X}$ 来执行对称正交归一化，并变换到正交归一化度规：$\\mathbf{H}_o = \\mathbf{X}^\\dagger \\mathbf{H} \\mathbf{X}$。\n- 通过定义与 $\\beta$ 对易的 $\\mathbf{E}$ 和与 $\\beta$ 反对易的 $\\mathbf{O}$，将 $\\mathbf{H}_o$ 分解为相对于 $\\beta$ 的偶部和奇部。\n- 从线性化块解耦条件中确定一个反厄米、奇性的生成元 $\\mathbf{S}$，从而使奇数块在目标阶数下被抵消。\n- 构建幺正算符 $\\mathbf{U} = e^{\\mathbf{S}}$，并使用 Baker-Campbell-Hausdorff (BCH) 展开来计算 $\\mathbf{H}' = e^{\\mathbf{S}} \\mathbf{H}_o e^{-\\mathbf{S}}$，并与所需阶数一致地进行截断。\n- 将 $\\mathbf{H}'$ 的正能块作为解耦的二分量哈密顿算符（如果需要，可选择使用 $\\mathbf{X}$ 反变换以返回到原始基）。\n\nB.\n- 在原始非正交基中，将 $\\mathbf{H}$ 分裂为厄米和反厄米部分，并将其标记为 $\\mathbf{E}$ 和 $\\mathbf{O}$。\n- 选择一个厄米生成元 $\\mathbf{S}$ 并定义一个幺正算符 $\\mathbf{U} = e^{i \\mathbf{S}}$。\n- 应用 BCH 展开以获得 $\\mathbf{H}'$ 并提取左上块作为二分量哈密顿算符。\n- 如果需要，可在最后执行正交归一化。\n\nC.\n- 首先如选项 A 中那样对基进行正交归一化。\n- 将 $\\mathbf{E}$ 定义为 $\\mathbf{H}_o$ 的左上块，将 $\\mathbf{O}$ 定义为左下块，并选择一个块对角生成元 $\\mathbf{S}$。\n- 应用 BCH 展开并将左上块识别为解耦的二分量哈密顿算符。\n\nD.\n- 跳过正交归一化，而是定义一个广义对易子 $[\\mathbf{A},\\mathbf{B}]_{\\mathbf{S}} = \\mathbf{A}\\mathbf{S}\\mathbf{B} - \\mathbf{B}\\mathbf{S}\\mathbf{A}$，以直接在非正交基中进行 BCH 展开。\n- 从此广义框架中确定一个厄米、奇性的生成元 $\\mathbf{S}$ 并形成 $\\mathbf{U} = e^{\\mathbf{S}}$。\n- 通过使用 $[\\cdot,\\cdot]_{\\mathbf{S}}$ 的 BCH 级数计算 $\\mathbf{H}'$，并读出左上块作为二分量哈密顿算符。\n\nE.\n- 如选项 A 中那样对基进行正交归一化并构建偶部和奇部。\n- 将生成元直接设置为 $\\mathbf{S} = -\\mathbf{O}$，并通过 $\\mathbf{U} \\approx \\mathbf{I} + \\mathbf{S}$ 来近似幺正算符。\n- 计算 $\\mathbf{H}' = \\mathbf{U}\\mathbf{H}_o\\mathbf{U}^\\dagger$ 而不使用 BCH 展开，并仅保留一阶项，然后将左上块作为二分量哈密顿算符。\n\n选择唯一最佳的选项，该选项满足上述解耦策略，并且与基于矩阵代数和 Baker-Campbell-Hausdorff (BCH) 展开的系统性、阶数可控的 DKH 过程相一致。", "solution": "首先将对问题陈述进行严格验证。\n\n### 第 1 步：提取已知条件\n- **背景**：相对论量子化学，从四分量狄拉克单电子算符获得纯电子有效哈密顿算符。\n- **起点**：在具有重叠矩阵 $\\mathbf{S}$ 的有限非正交基中，狄拉克哈密顿算符 $\\mathbf{H}$ 的矩阵表示。\n- **性质**：$\\mathbf{S}$ 是正定的。$\\mathbf{H}$ 相对于狄拉克矩阵 $\\beta$ 进行了划分。\n- **方法**：通过一系列矩阵运算进行 Douglas-Kroll-Hess (DKH) 解耦。\n- **目标**：将 $\\mathbf{H}$ 相对于正能和负能子空间进行块对角化，从而为正能（电子）态生成一个二分量哈密顿算符。\n- **问题**：确定哪个选项最佳地概述了此类解耦的科学正确且内部一致的矩阵步骤序列，并强调了关键阶段：\n    1. 基的正交归一化。\n    2. 相对于 $\\beta$ 构建偶算符块 $\\mathbf{E}$ 和奇算符块 $\\mathbf{O}$。\n    3. 确定一个反厄米生成元 $\\mathbf{S}$（注意：符号 $\\mathbf{S}$ 同时用于重叠矩阵和生成元；必须根据上下文区分）。\n    4. 应用 Baker-Campbell-Hausdorff (BCH) 展开进行幺正变换。\n\n### 第 2 步：使用提取的已知条件进行验证\n- **科学依据**：该问题描述了 Douglas-Kroll-Hess 变换的矩阵形式，这是现代相对论量子化学用以计算重元素性质的基石。所提出的概念——狄拉克哈密顿算符、非正交基组、重叠矩阵、块对角化、幺正变换和 Baker-Campbell-Hausdorff 展开——在这一领域都是标准且基本正确的。\n- **适定性**：该问题要求从一组选项中选择对一个标准科学过程的“最佳”描述。鉴于 DKH 方法是一个定义明确的算法，选项中应该存在一个正确且更优的描述，这使得该问题是适定的。\n- **客观性**：该问题以精确、技术性的语言陈述，没有主观性或歧义。\n- **缺陷分析**：\n    1.  **科学谬误**：前提是对量子化学中概念的真实表述。\n    2.  **不相关性**：该问题直接且完全是关于 *Douglas-Kroll-Hess 解耦变换*。\n    3.  **不完整/矛盾**：问题陈述是自洽的。符号 $\\mathbf{S}$ 同时用于重叠矩阵和变换生成元，这在符号上可能令人困惑，但并非根本性矛盾，因为其含义可以从选项中使用的上下文辨别。这是文献中常见（尽管可能不是最优）的做法。\n    4.  **不可行性**：所描述的过程不仅可行，而且已在众多量子化学软件包中实现。\n    5.  **不适定性**：该问题结构清晰，要求识别一个正确的程序，如果其中一个选项是正确的，那么它就有一个唯一解。\n\n### 第 3 步：结论与行动\n问题陈述是**有效的**。它基于相对论量子化学的既定原则，提出了一个清晰且科学合理的问题。我现在将继续推导解决方案并评估各个选项。\n\n### Douglas-Kroll-Hess 过程的推导\n\n目标是将四分量狄拉克哈密顿算符 $\\mathbf{H}$ 变换为块对角形式，从而解耦电子（正能）和正电子（负能）的自由度。\n\n1.  **正交归一化**：我们从非正交基中的广义本征值问题开始：\n    $$ \\mathbf{H} \\mathbf{c} = E \\mathbf{S} \\mathbf{c} $$\n    幺正变换的标准代数操作是在正交归一化基中定义的。因此，第一步是变换到一个度规为单位矩阵的基。使用变换矩阵 $\\mathbf{X} = \\mathbf{S}^{-1/2}$ 执行对称正交归一化，其中 $\\mathbf{S}$ 是重叠矩阵。变换后的哈密顿算符 $\\mathbf{H}_o$ 和本征矢量 $\\mathbf{c}_o$ 是：\n    $$ \\mathbf{H}_o = \\mathbf{X}^\\dagger \\mathbf{H} \\mathbf{X}, \\quad \\mathbf{c}_o = \\mathbf{X}^{-1} \\mathbf{c} $$\n    这将问题转换为一个标准本征值问题：\n    $$ \\mathbf{H}_o \\mathbf{c}_o = E \\mathbf{c}_o $$\n    这一步对于有效应用标准矩阵对易代数和指数运算至关重要。\n\n2.  **分解**：变换后的哈密顿算符 $\\mathbf{H}_o$ 被分解为相对于狄拉克矩阵 $\\beta$ 的偶部和奇部。偶部 $\\mathbf{E}$ 与 $\\beta$ 对易，奇部 $\\mathbf{O}$ 与 $\\beta$ 反对易。\n    $$ \\mathbf{H}_o = \\mathbf{E} + \\mathbf{O} $$\n    其中\n    $$ \\mathbf{E} = \\frac{1}{2}(\\mathbf{H}_o + \\beta \\mathbf{H}_o \\beta), \\quad [\\mathbf{E}, \\beta] = 0 $$\n    $$ \\mathbf{O} = \\frac{1}{2}(\\mathbf{H}_o - \\beta \\mathbf{H}_o \\beta), \\quad \\{\\mathbf{O}, \\beta\\} = \\mathbf{O}\\beta + \\beta\\mathbf{O} = 0 $$\n    在标准表示中，$\\mathbf{E}$ 是块对角的，而 $\\mathbf{O}$ 是块非对角的。$\\mathbf{O}$ 的存在耦合了正能态和负能态。目标是找到一个消除 $\\mathbf{O}$ 的幺正变换。\n\n3.  **幺正变换**：我们寻求一个能将 $\\mathbf{H}_o$ 块对角化的幺正变换 $\\mathbf{U}$：\n    $$ \\mathbf{H}' = \\mathbf{U} \\mathbf{H}_o \\mathbf{U}^\\dagger $$\n    使得 $\\mathbf{H}'$ 是纯偶性的。该变换表示为一个反厄米生成元的指数，我们称之为 $\\mathbf{A}$ 以避免与重叠矩阵 $\\mathbf{S}$ 混淆。\n    $$ \\mathbf{U} = e^{\\mathbf{A}}, \\quad \\mathbf{A}^\\dagger = -\\mathbf{A} $$\n    为了使此变换能消除奇算符 $\\mathbf{O}$，生成元 $\\mathbf{A}$ 本身必须是奇性的：$\\{\\mathbf{A}, \\beta\\} = 0$。\n\n4.  **确定生成元**：变换后的哈密顿算符 $\\mathbf{H}'$ 使用 Baker-Campbell-Hausdorff (BCH) 公式展开：\n    $$ \\mathbf{H}' = e^{\\mathbf{A}} \\mathbf{H}_o e^{-\\mathbf{A}} = \\mathbf{H}_o + [\\mathbf{A}, \\mathbf{H}_o] + \\frac{1}{2!} [\\mathbf{A}, [\\mathbf{A}, \\mathbf{H}_o]] + \\dots $$\n    解耦的条件是 $\\mathbf{H}'$ 的奇部消失。使用对易关系（$[\\text{奇},\\text{偶}]=\\text{奇}, [\\text{奇},\\text{奇}]=\\text{偶}$），收集展开式中的奇数项：\n    $$ \\mathbf{O}' = \\mathbf{O} + [\\mathbf{A}, \\mathbf{E}] + \\frac{1}{2!} [\\mathbf{A}, [\\mathbf{A}, \\mathbf{O}]] + \\dots = 0 $$\n    DKH 过程以迭代方式求解此方程以获得指定阶数的 $\\mathbf{A}$。生成元的一阶近似 $\\mathbf{A}^{(1)}$ 从线性化条件中获得：\n    $$ \\mathbf{O} + [\\mathbf{A}^{(1)}, \\mathbf{E}] = 0 $$\n    这是关于 $\\mathbf{A}^{(1)}$ 的西尔维斯特型方程。更高阶的项被系统地找到。\n\n5.  **最终哈密顿算符**：一旦生成元 $\\mathbf{A}$ 被确定到所需阶数，就使用一致截断的 BCH 展开来计算变换后的哈密顿算符 $\\mathbf{H}'$。所得到的块对角矩阵 $\\mathbf{H}'$ 的左上块就是二分量的、解耦的电子哈密顿算符。\n\n### 逐项分析\n\n**选项 A：** 此选项概述了以下序列：\n- 对基进行正交归一化以得到 $\\mathbf{H}_o = \\mathbf{X}^\\dagger \\mathbf{H} \\mathbf{X}$。这是正确的。\n- 将 $\\mathbf{H}_o$ 分解为相对于 $\\beta$ 的偶部（$\\mathbf{E}$）和奇部（$\\mathbf{O}$）。这是正确的。\n- 从线性化解耦条件中确定一个反厄米的、奇性的生成元（此处命名为 $\\mathbf{S}$），以在目标阶数下抵消奇数块。这正确地描述了生成元的性质以及如何确定它。\n- 构建幺正算符 $\\mathbf{U} = e^{\\mathbf{S}}$ 并使用 BCH 展开来计算 $\\mathbf{H}'$，并与所需阶数一致地进行截断。这是变换的正确应用。\n- 提取 $\\mathbf{H}'$ 的正能块作为最终的哈密顿算符。这是最后且正确的步骤。\n此选项中的每一步在科学上都是合理的，并且遵循了标准的、系统性的 DKH 过程。\n**结论：正确**\n\n**选项 B：** 此选项包含多个基本错误：\n- 它建议将 $\\mathbf{H}$ 分裂为厄米和反厄米部分，这是不正确的。分解是相对于 $\\beta$ 分为偶部和奇部。算符 $\\mathbf{E}$ 和 $\\mathbf{O}$ 本身都是厄米的。\n- 它提议使用一个厄米生成元 $\\mathbf{S}$ 来形成 $\\mathbf{U} = e^{i\\mathbf{S}}$。DKH 生成元必须相对于 $\\beta$ 是*奇性的*。一个通用的厄米算符是行不通的。标准约定也使用一个*反厄米*生成元 $\\mathbf{A}$，使得 $\\mathbf{U} = e^{\\mathbf{A}}$。\n- 它在非正交基中执行这些步骤，并将正交归一化视为可选的最后一步。这是颠倒的；正交归一化是使标准对易代数适用的必要第一步。\n**结论：错误**\n\n**选项 C：** 此选项在定义上犯了关键性错误：\n- 它错误地将 $\\mathbf{E}$ 定义为仅为 $\\mathbf{H}_o$ 的左上块，将 $\\mathbf{O}$ 定义为仅为左下块。这是一个严重的误解。$\\mathbf{E}$ 是整个块对角部分，而 $\\mathbf{O}$ 是整个块非对角部分。\n- 它建议选择一个块对角（偶性）生成元。偶性生成元与 $\\beta$ 对易，无法执行消除奇算符 $\\mathbf{O}$ 所需的旋转。生成元必须是奇性的（块非对角）。\n**结论：错误**\n\n**选项 D：** 此选项有两个显著问题：\n- 它提议跳过正交归一化并使用一个广义对易子。虽然非正交基的形式体系确实存在，但它们不是标准的，且更为复杂。问题所要求概述的通用 DKH 方法始于正交归一化。\n- 它声称生成元 $\\mathbf{S}$ 是厄米的，并用于形成 $\\mathbf{U} = e^{\\mathbf{S}}$。为使 $\\mathbf{U}$ 成为幺正的，其生成元必须是反厄米的。这是一个基本的数学错误。\n**结论：错误**\n\n**选项 E：** 此选项提出了一个不正确且过于简化的近似：\n- 它将生成元直接设置为 $\\mathbf{S} = -\\mathbf{O}$。这是不正确的。生成元是通过求解方程 $[\\mathbf{S}, \\mathbf{E}] = -\\mathbf{O}$ 找到的，在一般情况下这并不简化为 $\\mathbf{S} = -\\mathbf{O}$。\n- 它将幺正变换近似为 $\\mathbf{H}' = (\\mathbf{I} + \\mathbf{S})\\mathbf{H}_o(\\mathbf{I} - \\mathbf{S})$，这是一个低阶展开。然而，关于 $\\mathbf{S}$ 的前提是错误的，这使得整个过程作为 DKH 的表示是无效的。DKH 方法是一个系统性的、逐阶的展开，而不是这个特定的粗略近似。\n**结论：错误**\n\n总之，选项 A 是唯一一个对基于矩阵的 Douglas-Kroll-Hess 解耦过程提供了完整、一致且科学准确描述的选项。", "answer": "$$\\boxed{A}$$", "id": "2887198"}, {"introduction": "任何相对论计算的一个关键要素是能够正确描述狄拉克旋量大、小分量的基组。本练习通过受限动能平衡 (Restricted Kinetic Balance, RKB) 条件提供动手实践，这是一种从大分量基函数 $\\chi_L$ 生成小分量基函数 $\\chi_S$ 的基本技术。通过完成此计算，您将对由狄拉克方程决定的两个分量之间的联系，即 $\\chi_S \\propto (\\boldsymbol{\\sigma}\\cdot\\mathbf{p})\\chi_L$，有更具体的理解 [@problem_id:2887145]。", "problem": "在基于 Douglas–Kroll–Hess (DKH) 解耦合的相对论量子化学处理中，限制性动能平衡 (Restricted Kinetic Balance, RKB) 方案通过关系式 $\\chi_{S} \\propto \\left(\\boldsymbol{\\sigma}\\cdot\\mathbf{p}\\right)\\chi_{L}$，由给定的大分量基函数构建小分量基函数，其中 $\\boldsymbol{\\sigma}$ 表示泡利矩阵矢量，$\\mathbf{p}$ 是动量算符。考虑一个以原点为中心的归一化大分量旋量基函数，其空间部分由一个 $s$-型高斯函数基元和一个自旋向上的双分量旋量给出，\n$$\n\\chi_{L}(\\mathbf{r}) \\;=\\; g(\\mathbf{r})\\,\\xi,\\quad g(\\mathbf{r}) \\;=\\; N\\,\\exp\\!\\left(-\\alpha\\,r^{2}\\right),\\quad \\xi \\;=\\; \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix},\n$$\n其中 $\\alpha > 0$ 是高斯指数，$N$ 是归一化常数。在原子单位制中进行计算，即 $\\hbar = 1$，$m_{e} = 1$，且动量算符为 $\\mathbf{p} = -\\,\\mathrm{i}\\,\\boldsymbol{\\nabla}$。RKB 小分量基函数定义为\n$$\n\\chi_{S}(\\mathbf{r}) \\;=\\; \\kappa\\,\\left(\\boldsymbol{\\sigma}\\cdot\\mathbf{p}\\right)\\chi_{L}(\\mathbf{r}),\n$$\n其中 $\\kappa$ 为实比例常数。请确定 $\\kappa$ 的值，使得小分量基函数是归一化的，即：\n$$\n\\int \\chi_{S}^{\\dagger}(\\mathbf{r})\\,\\chi_{S}(\\mathbf{r})\\,\\mathrm{d}^{3}\\mathbf{r} \\;=\\; 1.\n$$\n请将最终答案表示为仅含 $\\alpha$ 的闭合形式解析表达式。使用原子单位制，不要进行任何数值取整。最终答案必须是无单位的单一表达式。", "solution": "该问题是有效的，因为它在相对论量子化学中有科学依据，提法明确，目标清晰，并且内容自洽。我将开始解答。\n\n目标是确定实比例常数 $\\kappa$，使得小分量旋量基函数 $\\chi_{S}(\\mathbf{r})$ 归一化为1。归一化条件由下式给出：\n$$\n\\int \\chi_{S}^{\\dagger}(\\mathbf{r})\\,\\chi_{S}(\\mathbf{r})\\,\\mathrm{d}^{3}\\mathbf{r} = 1\n$$\n首先，我们必须确定大分量基函数 $\\chi_{L}(\\mathbf{r})$ 的归一化常数 $N$。大分量由 $\\chi_{L}(\\mathbf{r}) = g(\\mathbf{r})\\xi$ 给出，其中 $g(\\mathbf{r}) = N\\exp(-\\alpha r^2)$ 且 $\\xi = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$。$\\chi_L$ 的归一化条件是 $\\int \\chi_{L}^{\\dagger}(\\mathbf{r})\\chi_{L}(\\mathbf{r})\\,\\mathrm{d}^{3}\\mathbf{r} = 1$。\n被积函数为 $\\chi_{L}^{\\dagger}\\chi_{L} = (g^{*}(\\mathbf{r})\\xi^{\\dagger})(g(\\mathbf{r})\\xi) = |g(\\mathbf{r})|^2 (\\xi^{\\dagger}\\xi)$。由于 $g(\\mathbf{r})$ 是实函数，因此 $|g(\\mathbf{r})|^2 = g(\\mathbf{r})^2 = N^2 \\exp(-2\\alpha r^2)$。旋量部分为 $\\xi^{\\dagger}\\xi = \\begin{pmatrix} 1 & 0 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} = 1$。\n因此，$\\chi_L$ 的归一化条件变为：\n$$\n\\int N^2 \\exp(-2\\alpha r^2) \\,\\mathrm{d}^{3}\\mathbf{r} = 1\n$$\n这是一个标准的三维高斯积分。$\\exp(-ar^2)$ 在全空间上的积分为 $(\\pi/a)^{3/2}$。当 $a = 2\\alpha$ 时，我们有：\n$$\nN^2 \\left(\\frac{\\pi}{2\\alpha}\\right)^{3/2} = 1\n$$\n求解 $N^2$，我们得到大分量的归一化常数的平方：\n$$\nN^2 = \\left(\\frac{2\\alpha}{\\pi}\\right)^{3/2}\n$$\n接下来，我们构造小分量函数 $\\chi_{S}(\\mathbf{r})$：\n$$\n\\chi_{S}(\\mathbf{r}) = \\kappa\\,(\\boldsymbol{\\sigma}\\cdot\\mathbf{p})\\chi_{L}(\\mathbf{r})\n$$\n使用原子单位制中的动量算符 $\\mathbf{p} = -\\mathrm{i}\\boldsymbol{\\nabla}$，我们有：\n$$\n\\chi_{S}(\\mathbf{r}) = \\kappa (-\\mathrm{i}\\boldsymbol{\\sigma}\\cdot\\boldsymbol{\\nabla}) [N \\exp(-\\alpha r^2) \\xi] = -\\mathrm{i} \\kappa N [(\\boldsymbol{\\sigma}\\cdot\\boldsymbol{\\nabla})\\exp(-\\alpha r^2)] \\xi\n$$\n高斯函数的梯度为 $\\boldsymbol{\\nabla}\\exp(-\\alpha r^2) = -2\\alpha\\mathbf{r}\\exp(-\\alpha r^2)$。将此代入 $\\chi_S$ 的表达式：\n$$\n\\chi_{S}(\\mathbf{r}) = -\\mathrm{i} \\kappa N [\\boldsymbol{\\sigma}\\cdot(-2\\alpha\\mathbf{r})] \\exp(-\\alpha r^2) \\xi = 2\\mathrm{i}\\alpha N \\kappa (\\boldsymbol{\\sigma}\\cdot\\mathbf{r}) \\exp(-\\alpha r^2) \\xi\n$$\n现在，我们建立 $\\chi_S$ 的归一化积分。首先，我们计算被积函数 $\\chi_{S}^{\\dagger}\\chi_{S}$。其伴随 $\\chi_{S}^{\\dagger}$ 为：\n$$\n\\chi_{S}^{\\dagger}(\\mathbf{r}) = [2\\mathrm{i}\\alpha N \\kappa (\\boldsymbol{\\sigma}\\cdot\\mathbf{r}) \\exp(-\\alpha r^2) \\xi]^{\\dagger} = -2\\mathrm{i}\\alpha N \\kappa \\exp(-\\alpha r^2) \\xi^{\\dagger} (\\boldsymbol{\\sigma}\\cdot\\mathbf{r})^{\\dagger}\n$$\n由于 $\\mathbf{r}$ 的分量是实数，且泡利矩阵 $\\sigma_i$ 是厄米的，所以 $(\\boldsymbol{\\sigma}\\cdot\\mathbf{r})^{\\dagger} = \\boldsymbol{\\sigma}\\cdot\\mathbf{r}$。因此：\n$$\n\\chi_{S}^{\\dagger}(\\mathbf{r}) = -2\\mathrm{i}\\alpha N \\kappa \\exp(-\\alpha r^2) \\xi^{\\dagger} (\\boldsymbol{\\sigma}\\cdot\\mathbf{r})\n$$\n乘积 $\\chi_{S}^{\\dagger}\\chi_{S}$ 为：\n$$\n\\chi_{S}^{\\dagger}\\chi_{S} = (-2\\mathrm{i}\\alpha N \\kappa \\exp(-\\alpha r^2) \\xi^{\\dagger} (\\boldsymbol{\\sigma}\\cdot\\mathbf{r}))(2\\mathrm{i}\\alpha N \\kappa (\\boldsymbol{\\sigma}\\cdot\\mathbf{r}) \\exp(-\\alpha r^2) \\xi)\n$$\n$$\n\\chi_{S}^{\\dagger}\\chi_{S} = 4(\\alpha N \\kappa)^2 \\exp(-2\\alpha r^2) \\xi^{\\dagger} (\\boldsymbol{\\sigma}\\cdot\\mathbf{r})^2 \\xi\n$$\n我们使用恒等式 $(\\boldsymbol{\\sigma}\\cdot\\mathbf{A})(\\boldsymbol{\\sigma}\\cdot\\mathbf{B}) = (\\mathbf{A}\\cdot\\mathbf{B})I_2 + \\mathrm{i}\\boldsymbol{\\sigma}\\cdot(\\mathbf{A}\\times\\mathbf{B})$，其中 $I_2$ 是 $2 \\times 2$ 单位矩阵。对于 $\\mathbf{A} = \\mathbf{B} = \\mathbf{r}$，该式简化为 $(\\boldsymbol{\\sigma}\\cdot\\mathbf{r})^2 = (\\mathbf{r}\\cdot\\mathbf{r})I_2 + \\mathrm{i}\\boldsymbol{\\sigma}\\cdot(\\mathbf{r}\\times\\mathbf{r}) = r^2 I_2$，因为 $\\mathbf{r}\\times\\mathbf{r} = \\mathbf{0}$。\n将此代入 $\\chi_{S}^{\\dagger}\\chi_{S}$ 的表达式中：\n$$\n\\chi_{S}^{\\dagger}\\chi_{S} = 4(\\alpha N \\kappa)^2 \\exp(-2\\alpha r^2) \\xi^{\\dagger} (r^2 I_2) \\xi = 4(\\alpha N \\kappa)^2 r^2 \\exp(-2\\alpha r^2) (\\xi^{\\dagger}\\xi)\n$$\n由于 $\\xi^{\\dagger}\\xi = 1$，被积函数是一个标量函数：\n$$\n\\chi_{S}^{\\dagger}\\chi_{S} = 4\\alpha^2 N^2 \\kappa^2 r^2 \\exp(-2\\alpha r^2)\n$$\n因此，归一化条件为：\n$$\n\\int 4\\alpha^2 N^2 \\kappa^2 r^2 \\exp(-2\\alpha r^2) \\,\\mathrm{d}^{3}\\mathbf{r} = 1\n$$\n$$\n4\\alpha^2 N^2 \\kappa^2 \\int r^2 \\exp(-2\\alpha r^2) \\,\\mathrm{d}^{3}\\mathbf{r} = 1\n$$\n为计算积分 $\\int r^2 \\exp(-ar^2) \\,\\mathrm{d}^{3}\\mathbf{r}$ (其中 $a=2\\alpha$)，我们可以对标准高斯积分就参数 $a$ 求导：\n$$\n\\int \\exp(-ar^2)\\,\\mathrm{d}^{3}\\mathbf{r} = \\left(\\frac{\\pi}{a}\\right)^{3/2}\n$$\n$$\n\\int r^2 \\exp(-ar^2) \\,\\mathrm{d}^{3}\\mathbf{r} = -\\frac{\\mathrm{d}}{\\mathrm{d}a} \\int \\exp(-ar^2)\\,\\mathrm{d}^{3}\\mathbf{r} = -\\frac{\\mathrm{d}}{\\mathrm{d}a} \\left(\\pi^{3/2} a^{-3/2}\\right) = -\\pi^{3/2} \\left(-\\frac{3}{2} a^{-5/2}\\right) = \\frac{3\\pi^{3/2}}{2} a^{-5/2}\n$$\n代入 $a = 2\\alpha$，积分为 $\\frac{3\\pi^{3/2}}{2}(2\\alpha)^{-5/2}$。现在我们将此结果以及 $N^2$ 的表达式代入归一化方程：\n$$\n4\\alpha^2 \\kappa^2 \\left(\\frac{2\\alpha}{\\pi}\\right)^{3/2} \\left(\\frac{3\\pi^{3/2}}{2}(2\\alpha)^{-5/2}\\right) = 1\n$$\n合并同类项以化简表达式：\n$$\n4\\alpha^2 \\kappa^2 \\frac{(2\\alpha)^{3/2}}{\\pi^{3/2}} \\frac{3\\pi^{3/2}}{2} (2\\alpha)^{-5/2} = 1\n$$\n$\\pi^{3/2}$ 项相互抵消：\n$$\n4\\alpha^2 \\kappa^2 \\frac{3}{2} (2\\alpha)^{3/2 - 5/2} = 1\n$$\n$$\n4\\alpha^2 \\kappa^2 \\frac{3}{2} (2\\alpha)^{-1} = 1\n$$\n$$\n4\\alpha^2 \\kappa^2 \\frac{3}{2} \\frac{1}{2\\alpha} = 1\n$$\n$$\n\\frac{12\\alpha^2 \\kappa^2}{4\\alpha} = 1\n$$\n$$\n3\\alpha\\kappa^2 = 1\n$$\n最后，求解 $\\kappa$：\n$$\n\\kappa^2 = \\frac{1}{3\\alpha}\n$$\n由于 $\\kappa$ 是一个实常数且 $\\alpha > 0$，按照归一化常数的惯例，我们取正实数根：\n$$\n\\kappa = \\sqrt{\\frac{1}{3\\alpha}} = \\frac{1}{\\sqrt{3\\alpha}}\n$$", "answer": "$$\n\\boxed{\\frac{1}{\\sqrt{3\\alpha}}}\n$$", "id": "2887145"}, {"introduction": "DKH 变换不仅改变了哈密顿算符 $H$，还改变了所有其他性质算符 $A$ 的表示，这种现象被称为“图像变换”(picture change)。在计算重元素的性质时，忽略这一点会导致严重错误。最后一个实践使用一个最小的计算模型来量化图像变换误差 $\\Delta$，清晰地说明了为什么变换性质算符对于获得准确结果至关重要 [@problem_id:2887184]。", "problem": "构建一个最小的、自洽的计算任务，用于在使用二阶 Douglas-Kroll-Hess (DKH2) 解耦变换时，量化单电子性质的图像变换（PC）误差。请从单电子 Dirac 哈密顿算符的块结构出发，\n$$\nH \\;=\\; \\beta\\,M \\;+\\; E \\;+\\; O,\n$$\n其中 $M \\equiv m c^2$ 是一个正标量，$\\beta$ 是一个对角元素为 $+1$ 和 $-1$ 的 $2\\times 2$ 对角矩阵，$E$ 是偶部分（与 $\\beta$ 对易），因此是对角的，而 $O$ 是奇部分（与 $\\beta$ 反对易），因此是纯非对角的。令 $U=\\exp(i S)$ 为幺正解耦变换，其奇算符生成元 $S$ 的选择应使得在使用 Baker-Campbell-Hausdorff (BCH) 级数展开时，$H$ 的奇部在小参数 $1/M$ 的一阶上被消除。在 $1/M$ 的二阶上进行一致的处理，以定义 DKH2 有效偶哈密顿算符及相应的二阶变换（图像变换）后的性质算符。假定单电子性质算符 $A$ 是偶算符（与 $\\beta$ 对易）。\n\n您的程序必须实现以下内容，仅使用线性代数和对易子作为基本运算，不依赖本问题陈述中给出的任何快捷公式：\n\n- 使用 $U^\\dagger H U$ 的 BCH 展开，选择奇算符生成元 $S$ 以消除 $H$ 的一阶奇贡献，并保留至 $1/M$ 的二阶项，以获得偶 DKH2 哈密顿算符。利用此结果确定与解耦表象中上双旋量分量相对应的正能投影算符 $P_+ \\equiv (\\mathbf{1}+\\beta)/2$。\n\n- 使用相同的 BCH 展开并保留至 $1/M$ 的二阶项，将偶性质算符 $A$ 变换为其图像变换形式，并将其投影到正能子空间上。将得到的正能性质值记为 $\\langle A\\rangle_{\\mathrm{PC}}$。\n\n- 通过将原始算符 $A$ 投影到上述构建的 DKH2 哈密顿算符的解耦表象中的正能子空间上，计算相应的未变换（非 PC）正能性质值 $\\langle A\\rangle_{\\mathrm{nonPC}}$。\n\n- 将忽略图像变换所引入的 PC 误差量化为标量差\n$$\n\\Delta \\equiv \\langle A\\rangle_{\\mathrm{nonPC}} - \\langle A\\rangle_{\\mathrm{PC}}。\n$$\n\n在与奇偶结构一致的最小 $2\\times 2$ 模型中表示所有矩阵：\n- $\\beta = \\begin{pmatrix} 1 & 0 \\\\ 0 & -1 \\end{pmatrix}$。\n- $E = \\mathrm{diag}(e_u, e_l)$，其中 $e_u$ 和 $e_l$ 为实标量。\n- $O = \\begin{pmatrix} 0 & t \\\\ t & 0 \\end{pmatrix}$，其中 $t$ 为实标量耦合。\n- $A = \\mathrm{diag}(a_u, a_l)$，其中 $a_u$ 和 $a_l$ 为实标量。\n- $M > 0$ 是一个实标量。\n\n在本练习中，所有量均视为无量纲，因此不需要物理单位。\n\n您的程序必须对以下五个测试用例中的每一个评估标量误差 $\\Delta$，每个用例由元组 $(M, t, e_u, e_l, a_u, a_l)$ 指定：\n- 用例 1: $(1000.0, 0.8, 0.2, 0.2, 0.5, 0.5)$。\n- 用例 2: $(100.0, 0.5, 0.0, 0.0, 1.0, 2.0)$。\n- 用例 3: $(50.0, 0.0, 0.3, -0.1, -1.0, 1.0)$。\n- 用例 4: $(10.0, 1.5, 0.0, 0.0, 0.0, 1.0)$。\n- 用例 5: $(20.0, 3.0, 1.0, 1.5, 2.0, 1.0)$。\n\n实现要求与指南：\n- 将对易子视为 $[X,Y] \\equiv XY - YX$。\n- 通过与 $\\beta$ 的对易或反对易关系来对算符进行奇偶分类。\n- 对哈密顿算符和性质算符同时使用 BCH 级数展开至 $1/M$ 的二阶，并强制要求所选的奇算符生成元 $S$ 消除 $H$ 的一阶奇数项。\n- 在解耦表象中使用正能投影算符 $P_+ \\equiv (\\mathbf{1}+\\beta)/2$ 来提取正能值。\n\n您的程序应产生单行输出，其中包含用方括号括起来的、以逗号分隔的结果列表（例如，“[x1,x2,x3,x4,x5]”）。列表中的每个条目必须是对应于相应测试用例的 $\\Delta$ 值的浮点数，具有合理的浮点格式。不应打印任何额外文本。", "solution": "所陈述的问题具有科学依据、提法恰当且无矛盾。它提出了相对论量子化学中一个标准的、尽管是简化了的任务：在二阶 Douglas-Kroll-Hess (DKH2) 框架内推导单电子性质的图像变换误差。我们将进行形式化推导。\n\n目标是计算图像变换误差 $\\Delta \\equiv \\langle A\\rangle_{\\mathrm{nonPC}} - \\langle A\\rangle_{\\mathrm{PC}}$。这需要推导 DKH2 解耦变换及其对性质算符 $A$ 的影响。分析将在展开参数 $1/M$ 的二阶上进行一致的处理。\n\n单电子 Dirac 哈密顿算符由 $H = \\beta M + E + O$ 给出，其中 $H_E = \\beta M + E$ 是偶部分，$H_O = O$ 是奇部分。解耦变换是一个幺正算符 $U = \\exp(W)$，其中生成元 $W$ 是反厄米且为奇算符，即 $\\{W, \\beta\\} = 0$ 且 $W^\\dagger = -W$。变换后的哈密顿量为 $H' = U^\\dagger H U = e^{-W} H e^{W}$。我们使用 Baker-Campbell-Hausdorff (BCH) 展开：\n$$ H' = H + [H, W] + \\frac{1}{2!} [[H, W], W] + \\dots $$\n选择生成元 $W$ 以在最低阶上消除 $H$ 的奇部分。到一阶为止，$H'$ 的奇部分为 $H'_O \\approx O + [\\beta M + E, W]$。我们要求抵消主导项：\n$$ O + [\\beta M, W] = 0 $$\n由于 $W$ 是奇算符，它与 $\\beta$ 反对易，因此 $[\\beta, W] = \\beta W - W \\beta = \\beta W - (-\\beta W) = 2\\beta W$。该条件变为：\n$$ O + 2M\\beta W = 0 \\implies W = -\\frac{1}{2M} \\beta O $$\n这个生成元 $W$ 的量级为 $O(1/M)$。由于 $O$ 和 $\\beta$ 是厄米的，$\\beta O$ 是反厄米的，因此 $W$ 也是反厄米的，符合要求。\n\n接下来，我们计算变换后的性质算符 $A' = U^\\dagger A U = e^{-W} A e^{W}$。由于算符 $A$ 是偶算符，其 BCH 展开为：\n$$ A' = A + [A, W] + \\frac{1}{2!} [[A, W], W] + \\dots $$\n我们必须按奇偶特性对各项进行分类。$A$ 是偶算符，$W$ 是奇算符。\n- $A$：偶。\n- $[A, W]$：偶算符和奇算符的对易子是奇算符。\n- $[[A, W], W]$：奇算符和奇算符的对易子是偶算符。\n因此，$A'$ 的偶部分是 $A'_E = A + \\frac{1}{2}[[A, W], W] + \\dots$。\n为了在 $O(1/M^2)$ 阶上保持一致，我们只需要计算第二项，因为 $W$ 是 $O(1/M)$ 阶的。\n$$ [[A, W], W] = \\left[ \\left[A, -\\frac{1}{2M} \\beta O\\right], -\\frac{1}{2M} \\beta O \\right] = \\frac{1}{4M^2} [ [A, \\beta O], \\beta O ] $$\n由于 $A$ 是偶算符，它与 $\\beta$ 对易，因此 $[A, \\beta O] = \\beta A O - \\beta O A = \\beta[A,O]$。代入此式：\n$$ [[A, W], W] = \\frac{1}{4M^2} [\\beta[A,O], \\beta O] $$\n因此，二阶图像变换后的性质算符（偶部分）为：\n$$ A'_{E} = A + \\frac{1}{8M^2} [\\beta[A,O], \\beta O] $$\n图像变换后的性质值 $\\langle A\\rangle_{\\mathrm{PC}}$ 是正能期望值，通过将 $A'_{E}$ 投影到由投影算符 $P_+ = (\\mathbf{1}+\\beta)/2$ 定义的正能子空间上获得。对于块对角结构，这对应于矩阵的左上角元素。\n\n非图像变换值 $\\langle A\\rangle_{\\mathrm{nonPC}}$ 是通过将原始算符 $A$ 投影到同一正能子空间上获得的。在此基底下，这正是 $A$ 的左上角元素。给定指定的矩阵形式：\n$A = \\begin{pmatrix} a_u & 0 \\\\ 0 & a_l \\end{pmatrix}$。\n该投影产生标量值：\n$$ \\langle A\\rangle_{\\mathrm{nonPC}} = a_u $$\n\n为了找到 $\\langle A\\rangle_{\\mathrm{PC}}$，我们计算修正项的矩阵形式。所用矩阵为：\n$\\beta = \\begin{pmatrix} 1 & 0 \\\\ 0 & -1 \\end{pmatrix}$， $O = \\begin{pmatrix} 0 & t \\\\ t & 0 \\end{pmatrix}$。\n首先，我们计算对易子：\n$$ [A,O] = \\begin{pmatrix} a_u & 0 \\\\ 0 & a_l \\end{pmatrix} \\begin{pmatrix} 0 & t \\\\ t & 0 \\end{pmatrix} - \\begin{pmatrix} 0 & t \\\\ t & 0 \\end{pmatrix} \\begin{pmatrix} a_u & 0 \\\\ 0 & a_l \\end{pmatrix} = \\begin{pmatrix} 0 & (a_u-a_l)t \\\\ -(a_u-a_l)t & 0 \\end{pmatrix} $$\n$$ \\beta[A,O] = \\begin{pmatrix} 1 & 0 \\\\ 0 & -1 \\end{pmatrix} \\begin{pmatrix} 0 & (a_u-a_l)t \\\\ -(a_u-a_l)t & 0 \\end{pmatrix} = (a_u-a_l) \\begin{pmatrix} 0 & t \\\\ t & 0 \\end{pmatrix} = (a_u-a_l)O $$\n$$ \\beta O = \\begin{pmatrix} 1 & 0 \\\\ 0 & -1 \\end{pmatrix} \\begin{pmatrix} 0 & t \\\\ t & 0 \\end{pmatrix} = \\begin{pmatrix} 0 & t \\\\ -t & 0 \\end{pmatrix} $$\n现在计算外层对易子 $[\\beta[A,O], \\beta O]$：\n$$ [\\beta[A,O], \\beta O] = [(a_u-a_l)O, \\beta O] = (a_u-a_l)[O, \\beta O] $$\n$$ [O, \\beta O] = O(\\beta O) - (\\beta O)O = -\\beta O^2 - \\beta O^2 = -2\\beta O^2 $$\n$O^2 = \\begin{pmatrix} 0 & t \\\\ t & 0 \\end{pmatrix} \\begin{pmatrix} 0 & t \\\\ t & 0 \\end{pmatrix} = \\begin{pmatrix} t^2 & 0 \\\\ 0 & t^2 \\end{pmatrix} = t^2\\mathbf{1}$。\n所以，$[O, \\beta O] = -2\\beta (t^2 \\mathbf{1}) = -2t^2\\beta$。\n完整的对易子为：\n$$ [\\beta[A,O], \\beta O] = (a_u-a_l)(-2t^2\\beta) = -2(a_u-a_l)t^2\\beta $$\n$A'_E$ 中的修正项为：\n$$ \\frac{1}{8M^2} [-2(a_u-a_l)t^2\\beta] = -\\frac{(a_u-a_l)t^2}{4M^2}\\beta $$\n图像变换后的算符为：\n$$ A'_{E} = A - \\frac{(a_u-a_l)t^2}{4M^2}\\beta = \\begin{pmatrix} a_u & 0 \\\\ 0 & a_l \\end{pmatrix} - \\frac{(a_u-a_l)t^2}{4M^2}\\begin{pmatrix} 1 & 0 \\\\ 0 & -1 \\end{pmatrix} $$\n正能投影（左上角元素）为：\n$$ \\langle A\\rangle_{\\mathrm{PC}} = a_u - \\frac{(a_u-a_l)t^2}{4M^2} $$\n最后，图像变换误差 $\\Delta$ 计算为差值：\n$$ \\Delta = \\langle A\\rangle_{\\mathrm{nonPC}} - \\langle A\\rangle_{\\mathrm{PC}} = a_u - \\left( a_u - \\frac{(a_u-a_l)t^2}{4M^2} \\right) $$\n$$ \\Delta = \\frac{(a_u-a_l)t^2}{4M^2} $$\n这就是给定模型在 $1/M$ 的二阶上图像变换误差的最终解析表达式。来自算符 $E$ 的参数 $e_u$ 和 $e_l$ 并未出现在 $\\Delta$ 的最终表达式中，因为它们只对 DKH2 哈密顿量有贡献，而在此阶数上对算符 $A$ 的图像变换没有贡献。我们现在将使用此公式计算给定测试用例的结果。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the picture-change (PC) error for a one-electron property\n    using the second-order Douglas-Kroll-Hess (DKH2) decoupling transformation\n    within a simplified 2x2 model.\n    \"\"\"\n\n    # Test cases are provided as tuples: (M, t, e_u, e_l, a_u, a_l)\n    test_cases = [\n        (1000.0, 0.8, 0.2, 0.2, 0.5, 0.5), # Case 1\n        (100.0, 0.5, 0.0, 0.0, 1.0, 2.0), # Case 2\n        (50.0, 0.0, 0.3, -0.1, -1.0, 1.0), # Case 3\n        (10.0, 1.5, 0.0, 0.0, 0.0, 1.0), # Case 4\n        (20.0, 3.0, 1.0, 1.5, 2.0, 1.0), # Case 5\n    ]\n\n    results = []\n    for case in test_cases:\n        M, t, e_u, e_l, a_u, a_l = case\n\n        # The picture-change error Delta is derived from first principles using\n        # the Baker-Campbell-Hausdorff expansion for the transformed property\n        # operator A' = U_dagger * A * U, consistent to second order in 1/M.\n        # The untransformed property value is the (1,1) element of A, which is a_u.\n        # The transformed property value is the (1,1) element of the even part\n        # of A', which is a_u - (a_u - a_l) * t**2 / (4 * M**2).\n        # The error Delta is the difference between the two.\n        #\n        # Delta = <A>_nonPC - <A>_PC\n        #       = a_u - (a_u - (a_u - a_l) * t**2 / (4 * M**2))\n        #       = (a_u - a_l) * t**2 / (4 * M**2)\n\n        # M is given as a positive scalar, so no division by zero is expected.\n        delta = (a_u - a_l) * (t ** 2) / (4 * (M ** 2))\n        results.append(delta)\n\n    # Format the output as a comma-separated list in square brackets.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```", "id": "2887184"}]}