{"hands_on_practices": [{"introduction": "任何能量分解分析 (Energy Decomposition Analysis, EDA) 的出发点都是一个准确的总相互作用能，即 $E_{\\text{int}}$。然而，在使用有限原子中心基组进行计算时，一个名为基组叠加误差 (Basis Set Superposition Error, BSSE) 的计算赝象会人为地增强分子间的吸引力。这项实践将指导你应用 Boys–Bernardi 衡消校正方案，这是消除 BSSE 并获得物理意义上更可靠的 $E_{\\text{int}}$ 的标准方法，从而为后续任何有效的能量分解奠定坚实的基础 [@problem_id:2889721]。", "problem": "在玻恩-奥本海默近似下，于固定几何构型研究了一个由片段 $\\mathrm{A}$ 和 $\\mathrm{B}$ 组成的模型二聚体。在同一电子结构水平上，使用片段局域基组和二聚体增广基组，计算了复合物和孤立片段的单点电子能量（单位为哈特里），以探究基组叠加误差（BSSE）。提供了以下物理量：\n- 在二聚体基组下的复合物能量：$E_{\\mathrm{AB}} = -152.438765$。\n- 在各自单体基组下的片段能量：$E_{\\mathrm{A}}^{\\mathrm{A}} = -76.211345$，$E_{\\mathrm{B}}^{\\mathrm{B}} = -76.120987$。\n- 在包含鬼函数（Boys–Bernardi衡消设置）的完整二聚体基组下的片段能量：$E_{\\mathrm{A}}^{\\mathrm{AB}} = -76.223456$，$E_{\\mathrm{B}}^{\\mathrm{AB}} = -76.132001$。\n\n请仅从超分子相互作用能的基本定义和基组叠加误差的物理起源出发，构建一个逻辑一致的方案，用以报告经过和未经衡消校正的相互作用能。然后，将此方案应用于上述数据，以获得两个值：未校正的超分子相互作用能和经Boys–Bernardi衡消校正的相互作用能。使用精确换算关系 $1$ 哈特里 $= 2625.49962\\ \\mathrm{kJ\\,mol^{-1}}$，将两个答案均以 $\\mathrm{kJ\\,mol^{-1}}$ 为单位表示，并将每个值四舍五入至四位有效数字。\n\n在您的推导过程中，用不超过一个简短段落的篇幅进行论述，将您的方案与能量分解分析（EDA）的一般目标联系起来，并解释报告经过与未经衡消校正的相互作用能在阐释上的后果，重点关注哪种物理效应被减弱以及可能仍然存在哪些偏差。\n\n将您的最终两个数值结果以有序对 $\\big(E_{\\text{int}}^{\\text{uncorrected}},\\ E_{\\text{int}}^{\\text{CP}}\\big)$ 的形式报告，单位为 $\\mathrm{kJ\\,mol^{-1}}$，并按要求进行四舍五入。在最终的方框答案中不要包含单位。", "solution": "该问题具有科学依据，阐述清晰，并为获得唯一解提供了所有必要信息。所提供的能量值与变分原理一致，具体而言，当在更大的基组中计算时，片段能量会降低（$E_{\\mathrm{A}}^{\\mathrm{AB}} < E_{\\mathrm{A}}^{\\mathrm{A}}$ 且 $E_{\\mathrm{B}}^{\\mathrm{AB}} < E_{\\mathrm{B}}^{\\mathrm{B}}$）。因此，我将着手进行分析。\n\n基本目标是确定超分子相互作用能 $E_{\\text{int}}$，其定义为由孤立的、非相互作用的片段 $\\mathrm{A}$ 和 $\\mathrm{B}$ 形成复合物 $\\mathrm{AB}$ 时的能量变化：\n$$E_{\\text{int}} = E(\\text{复合物}) - \\sum E(\\text{孤立片段})$$\n在量子化学中，由于使用有限的、以原子为中心的基组，该物理量的计算变得复杂，并由此产生基组叠加误差（BSSE）。所制定的方案必须解决这一人为误差。\n\n首先，我们构建未校正的相互作用能 $E_{\\text{int}}^{\\text{uncorrected}}$。这是对该定义最直接、然而也最朴素的应用。在此方法中，将在完整二聚体基组中计算的复合物能量 $E_{\\mathrm{AB}}$（复合体系的上标 $\\mathrm{AB}$ 是隐式的）与孤立片段的能量之和 $E_{\\mathrm{A}}^{\\mathrm{A}}$ 和 $E_{\\mathrm{B}}^{\\mathrm{B}}$ 进行比较，其中每个片段的能量仅使用其自身的、以单体为中心的基组进行计算。\n其公式为：\n$$E_{\\text{int}}^{\\text{uncorrected}} = E_{\\mathrm{AB}} - (E_{\\mathrm{A}}^{\\mathrm{A}} + E_{\\mathrm{B}}^{\\mathrm{B}})$$\n该方法存在根本性缺陷，因为与在超分子复合物中相比，孤立的片段 $\\mathrm{A}$ 和 $\\mathrm{B}$ 是用更小、灵活性更差的基组来描述的。在复合物内部，片段 $\\mathrm{A}$ 可以“借用”片段 $\\mathrm{B}$ 的基函数来降低其自身能量，反之亦然。这是一种非物理的稳定化效应，是不完备基组所导致的人为误差，称为 BSSE。\n\n为修正此问题，我们构建了经Boys–Bernardi衡消（CP）校正的相互作用能 $E_{\\text{int}}^{\\text{CP}}$。该方案的逻辑是在*完全相同*的基组——即完整二聚体的基组——内评估所有四个物种（$E_{\\mathrm{AB}}$、$E_{\\mathrm{A}}$、$E_{\\mathrm{B}}$ 以及作为参考的空空间）的能量。这通过在片段 $\\mathrm{B}$ 的基函数（称为“鬼”轨道，不含原子核或电子）存在的情况下计算片段 $\\mathrm{A}$ 的能量，得到 $E_{\\mathrm{A}}^{\\mathrm{AB}}$，并对片段 $\\mathrm{B}$ 进行类似计算得到 $E_{\\mathrm{B}}^{\\mathrm{AB}}$ 来实现。这确保了复合物和片段的基组是平衡的，从而消除了由BSSE引起的人为稳定化效应。\n经CP校正的公式为：\n$$E_{\\text{int}}^{\\text{CP}} = E_{\\mathrm{AB}} - (E_{\\mathrm{A}}^{\\mathrm{AB}} + E_{\\mathrm{B}}^{\\mathrm{AB}})$$\n\n对于任何能量分解分析（EDA）方案而言，这种确定可靠相互作用能的方案都是强制性的第一步。EDA方法将总相互作用能 $E_{\\text{int}}$ 分解为物理上不同的组分，如静电、交换-排斥、诱导/极化和色散/电荷转移。将未经校正的能量 $E_{\\text{int}}^{\\text{uncorrected}}$ 作为EDA的输入将是一个严重错误，因为它将真实的物理相互作用与BSSE这一人为误差混为一谈，导致对结合能的高估和对其组分的错误解读。经衡消校正的值 $E_{\\text{int}}^{\\text{CP}}$ 通过减弱基组不平衡问题，为相互作用能提供了一个物理上更为合理的估计。但必须指出，即使是 $E_{\\text{int}}^{\\text{CP}}$ 也是一个依赖于模型的量，其准确性受所选理论水平和基组的限制，且校正方案本身也并非完美。固定的几何构型约束也忽略了将单体变形为其在复合物中构型所需的能量。\n\n我们现在将此方案应用于给定的数据。换算因子为 $C = 2625.49962\\ \\mathrm{kJ\\,mol^{-1}}\\,\\text{哈特里}^{-1}$。\n给定的能量（单位：哈特里）如下：\n$E_{\\mathrm{AB}} = -152.438765$\n$E_{\\mathrm{A}}^{\\mathrm{A}} = -76.211345$\n$E_{\\mathrm{B}}^{\\mathrm{B}} = -76.120987$\n$E_{\\mathrm{A}}^{\\mathrm{AB}} = -76.223456$\n$E_{\\mathrm{B}}^{\\mathrm{AB}} = -76.132001$\n\n未校正相互作用能的计算：\n$$E_{\\text{int}}^{\\text{uncorrected}} = -152.438765 - (-76.211345 + (-76.120987))$$\n$$E_{\\text{int}}^{\\text{uncorrected}} = -152.438765 - (-152.332332) = -0.106433\\ \\text{hartree}$$\n以 $\\mathrm{kJ\\,mol^{-1}}$ 为单位：\n$$E_{\\text{int}}^{\\text{uncorrected}} = -0.106433 \\times 2625.49962 = -279.4310... \\approx -279.4\\ \\mathrm{kJ\\,mol^{-1}}$$\n\n经衡消校正的相互作用能的计算：\n$$E_{\\text{int}}^{\\text{CP}} = -152.438765 - (-76.223456 + (-76.132001))$$\n$$E_{\\text{int}}^{\\text{CP}} = -152.438765 - (-152.355457) = -0.083308\\ \\text{hartree}$$\n以 $\\mathrm{kJ\\,mol^{-1}}$ 为单位：\n$$E_{\\text{int}}^{\\text{CP}} = -0.083308 \\times 2625.49962 = -218.7186... \\approx -218.7\\ \\mathrm{kJ\\,mol^{-1}}$$\n\n需要报告的两个值是 $E_{\\text{int}}^{\\text{uncorrected}} = -279.4\\ \\mathrm{kJ\\,mol^{-1}}$ 和 $E_{\\text{int}}^{\\text{CP}} = -218.7\\ \\mathrm{kJ\\,mol^{-1}}$。BSSE的大小是二者之差，约为 $60.7\\ \\mathrm{kJ\\,mol^{-1}}$，这突显了该校正的至关重要性。", "answer": "$$\n\\boxed{(-279.4, -218.7)}\n$$", "id": "2889721"}, {"introduction": "能量分解分析的核心价值在于将复杂的总相互作用能拆分为诸如静电、极化、色散等物理上直观的组分。本练习聚焦于极化或诱导能 ($E_{\\text{ind}}$)，通过一个简化的经典静电模型来估算水分子的诱导能。通过这个练习，你将能够把对称匹配微扰理论 (SAPT) 中抽象的量子力学术语与经典物理中偶极子、电场和极化率等熟悉的概念联系起来，从而建立对分子间相互作用来源的深刻物理直觉 [@problem_id:2889700]。", "problem": "在量子化学的能量分解分析中，对称性匹配微扰理论 (Symmetry-Adapted Perturbation Theory, SAPT) 将一个二阶诱导项（表示为 $E_{\\text{ind}}^{(2)}$）归因于相互作用单体相互极化所产生的稳定化作用。考虑一个氢键水二聚体，它被建模为两个刚性单体 $A$ 和 $B$。这两个单体被理想化为位于其中心且沿分子间氧-氧轴共线排列的点永久偶极。分子间距为 $R = 2.98\\,\\text{\\AA}$，并且两个永久偶极矢量都与该轴共线。假设每个单体的永久偶极矩大小为 $\\mu_{A} = \\mu_{B} = 1.85\\,\\mathrm{D}$，各向同性静态极化率为 $\\alpha_{A} = \\alpha_{B} = 1.45\\,\\text{\\AA}^{3}$。忽略所有更高阶的多极子、交换-诱导、穿透和阻尼效应，并将极化响应视为线性响应。\n\n从经典静电学和线性响应理论出发，对相互极化进行最低阶建模，并推导出该二聚体二阶诱导能 $E_{\\text{ind}}^{(2)}$ 关于 $\\alpha$、$\\mu$ 和 $R$ 的表达式。使用原子单位计算您的表达式的数值，用于场-偶极相互作用，然后转换为摩尔能量单位。请使用以下转换数据：\n- $1\\,\\mathrm{D} = 0.393430307$ 原子单位偶极矩，\n- $1\\,\\text{\\AA} = 1.889726125\\,a_{0}$，\n- $1\\,\\text{\\AA}^{3} = (1.889726125)^{3}\\,a_{0}^{3}$，\n- $1\\,\\text{hartree} = 2625.49962\\,\\mathrm{kJ\\,mol^{-1}}$。\n\n仅供定性参考，文献中报道的处于平衡位置附近的氢键水二聚体的 SAPT 二阶诱导能典型值在 $-4$ 至 $-8\\,\\mathrm{kJ\\,mol^{-1}}$ 的范围内。\n\n计算此模型的 $E_{\\text{ind}}^{(2)}$ 数值。以 $\\mathrm{kJ\\,mol^{-1}}$ 为单位表示您的最终答案，并四舍五入至三位有效数字。", "solution": "首先对问题进行验证。\n\n**第一步：提取已知条件**\n- **体系**：氢键水二聚体，建模为两个刚性单体 $A$ 和 $B$。\n- **模型**：点永久偶极位于其中心，沿分子间氧-氧轴共线排列。\n- **分子间距**：$R = 2.98\\,\\text{\\AA}$。\n- **永久偶极矩大小**：$\\mu_{A} = \\mu_{B} = 1.85\\,\\mathrm{D}$。\n- **各向同性静态极化率**：$\\alpha_{A} = \\alpha_{B} = 1.45\\,\\text{\\AA}^{3}$。\n- **近似**：忽略更高阶的多极子、交换-诱导、穿透和阻尼效应。将极化响应视为线性响应。\n- **目标**：推导二阶诱导能 $E_{\\text{ind}}^{(2)}$ 的表达式，并计算其数值，单位为 $\\mathrm{kJ\\,mol^{-1}}$，四舍五入至三位有效数字。\n- **转换数据**：\n    - $1\\,\\mathrm{D} = 0.393430307$ 原子单位偶极矩 ($e\\,a_0$)。\n    - $1\\,\\text{\\AA} = 1.889726125\\,a_{0}$。\n    - $1\\,\\text{\\AA}^{3} = (1.889726125)^{3}\\,a_{0}^{3}$。\n    - $1\\,\\text{hartree} = 2625.49962\\,\\mathrm{kJ\\,mol^{-1}}$。\n\n**第二步：使用提取的已知条件进行验证**\n- **科学基础**：该问题使用一个简化但标准的经典静电模型来近似一个量子力学能量组分。在物理化学中，这是一种用于教学目的和解释计算结果的常见且有效的方法。该模型基于静电学的基本原理。\n- **良态性**：该问题是自洽的，提供了所有必需的物理量和转换因子。目标陈述清晰。可以从所提供的信息中确定唯一解。\n- **客观性**：该问题以精确的技术语言陈述，没有主观性或歧义。\n- **结论**：该问题具有科学基础，是良态的、客观的，并且没有明显缺陷。因此被判定为**有效**。\n\n**第三步：推导与求解**\n在此模型中，二阶诱导能 $E_{\\text{ind}}^{(2)}$ 是由每个单体在另一个单体的静电场中极化所产生的稳定化能量之和。我们将在原子单位制下进行推导，其中库仑常数 $\\frac{1}{4\\pi\\epsilon_0}$ 等于 $1$。\n\n设单体 $A$ 位于原点，单体 $B$ 位于沿 z 轴距离为 $R$ 的位置。问题陈述，永久偶极矩 $\\vec{\\mu}_A$ 和 $\\vec{\\mu}_B$ 与分子间轴共线。由单体 $A$ 的永久偶极在单体 $B$ 位置产生的电场 $\\vec{\\mathcal{E}}_B$ 由偶极轴向场公式给出：\n$$\n\\vec{\\mathcal{E}}_B = \\frac{2\\vec{\\mu}_A}{R^3}\n$$\n该电场在单体 $B$ 上诱导出一个偶极矩 $\\vec{\\mu}_{\\mathrm{ind},B}$。根据线性响应近似，此诱导偶极矩为：\n$$\n\\vec{\\mu}_{\\mathrm{ind},B} = \\alpha_B \\vec{\\mathcal{E}}_B = \\frac{2\\alpha_B \\vec{\\mu}_A}{R^3}\n$$\n此诱导偶极矩在产生它的电场中的能量，即单体 $B$ 的诱导能，由下式给出：\n$$\nE_{\\text{ind}, B \\leftarrow A} = -\\frac{1}{2}\\alpha_B |\\vec{\\mathcal{E}}_B|^2\n$$\n因子 $\\frac{1}{2}$ 源于极化单体所需的功。代入电场的表达式：\n$$\nE_{\\text{ind}, B \\leftarrow A} = -\\frac{1}{2}\\alpha_B \\left( \\frac{2\\mu_A}{R^3} \\right)^2 = -\\frac{2\\alpha_B \\mu_A^2}{R^6}\n$$\n根据对称性，由单体 $B$ 在单体 $A$ 位置产生的电场 $\\vec{\\mathcal{E}}_A$ 具有相同的形式，因此单体 $A$ 上的诱导能为：\n$$\nE_{\\text{ind}, A \\leftarrow B} = -\\frac{1}{2}\\alpha_A |\\vec{\\mathcal{E}}_A|^2 = -\\frac{1}{2}\\alpha_A \\left( \\frac{2\\mu_B}{R^3} \\right)^2 = -\\frac{2\\alpha_A \\mu_B^2}{R^6}\n$$\n总的二阶诱导能 $E_{\\text{ind}}^{(2)}$ 是这两个贡献的总和，这符合 SAPT 在此阶忽略相互诱导反馈的定义：\n$$\nE_{\\text{ind}}^{(2)} = E_{\\text{ind}, B \\leftarrow A} + E_{\\text{ind}, A \\leftarrow B} = -\\frac{2\\alpha_B \\mu_A^2}{R^6} - \\frac{2\\alpha_A \\mu_B^2}{R^6}\n$$\n鉴于两个单体相同，$\\mu_A = \\mu_B = \\mu$ 且 $\\alpha_A = \\alpha_B = \\alpha$。表达式简化为：\n$$\nE_{\\text{ind}}^{(2)} = -\\frac{4\\alpha \\mu^2}{R^6}\n$$\n现在我们计算其数值。所有物理量都必须转换为原子单位（长度为 $a_0$，偶极矩为 $e\\,a_0$，极化率体积为 $a_0^3$）。\n给定的值为：\n$\\mu = 1.85\\,\\mathrm{D}$\n$\\alpha = 1.45\\,\\text{\\AA}^{3}$\n$R = 2.98\\,\\text{\\AA}$\n\n转换为原子单位：\n$$\n\\mu_{\\mathrm{a.u.}} = 1.85 \\times 0.393430307 = 0.727846068\\, e\\,a_0\n$$\n$$\n\\alpha_{\\mathrm{a.u.}} = 1.45 \\times (1.889726125)^3 = 1.45 \\times 6.748334424 = 9.785084915\\, a_0^3\n$$\n$$\nR_{\\mathrm{a.u.}} = 2.98 \\times 1.889726125 = 5.631383853\\, a_0\n$$\n将这些值代入推导出的公式中，得到以哈特里（Hartrees, $E_h$）为单位的能量：\n$$\nE_{\\text{ind}}^{(2)} = - \\frac{4 \\times (9.785084915) \\times (0.727846068)^2}{(5.631383853)^6}\n$$\n$$\nE_{\\text{ind}}^{(2)} = - \\frac{4 \\times 9.785084915 \\times 0.529760120}{31899.65084} = - \\frac{20.7335606}{31899.65084} = -0.000649962\\,E_h\n$$\n最后，我们使用提供的转换因子将此能量转换为摩尔单位：\n$$\nE_{\\text{ind}}^{(2)} (\\mathrm{kJ\\,mol^{-1}}) = -0.000649962\\,E_h \\times 2625.49962\\,\\mathrm{kJ\\,mol^{-1}}\\,E_h^{-1}\n$$\n$$\nE_{\\text{ind}}^{(2)} = -1.70642\\,\\mathrm{kJ\\,mol^{-1}}\n$$\n按要求四舍五入至三位有效数字：\n$$\nE_{\\text{ind}}^{(2)} \\approx -1.71\\,\\mathrm{kJ\\,mol^{-1}}\n$$\n该值的绝对值小于文献中对最低能量水二聚体的典型值，这是预料之中的，因为此模型采用了高度理想化的几何构型，并忽略了其他物理效应。", "answer": "$$\n\\boxed{-1.71}\n$$", "id": "2889700"}, {"introduction": "在理解了 EDA 的基本概念和物理图像之后，下一步是深入其在量子化学软件中的具体实现。本练习将引导你从第一性原理出发，设计一个计算极化能的数值协议，这正是耦合微扰 Hartree-Fock (CPHF) 或线性响应密度泛函理论 (LR-DFT) 的核心。通过解决一个微扰响应线性方程组，你将亲手实现从分子轨道理论到可计算的能量项的过程，揭示现代 EDA 方案背后严谨的计算机制 [@problem_id:2889710]。", "problem": "设计并实现一个与能量分解分析（EDA）一致的完整数值方案，用以通过耦合微扰Hartree–Fock（CPHF）或线性响应密度泛函理论（LR-DFT）计算极化能。其目标是计算一个碎片的极化能，该能量在EDA中定义为：在一个碎片因其伙伴产生的冻结静电场作用下，其电子密度发生内部弛豫所导致的能量降低，同时排除碎片间的电荷转移。您的实现必须基于以下广为接受的基本原理。\n\n从电子能量泛函 $E[\\rho]$ 的Rayleigh–Ritz变分原理及其二次展开式出发，该展开式针对由代表其伙伴嵌入场的外部微扰势 $ \\delta v $ 所诱导的微小密度变化 $ \\delta \\rho $。在正交归一的分子轨道基中，将密度变化限制于碎片内部的占据轨道到虚拟轨道的旋转，这种旋转强制执行了无电荷转移的约束，并通过一个覆盖所有允许的占据-虚拟轨道对的轨道旋转振幅实向量 $ \\mathbf{t} $ 进行参数化。用正则分子轨道来表示未受微扰的碎片，其中对于每个占据轨道 $i$ 和虚拟轨道 $a$，其轨道能差为 $ \\Delta_{ai} = \\varepsilon_{a} - \\varepsilon_{i} $。在受限的响应子空间中，用一个对称正定的Hessian矩阵 $ \\mathbf{H} = \\mathbf{D} + \\mathbf{K} $ 来模拟能量的二次展开，其中 $ \\mathbf{D} = \\mathrm{diag}(\\Delta_{ai}) $，$ \\mathbf{K} $ 是编码理论水平信息的屏蔽核：对于CPHF，它包含库仑-交换耦合；对于LR-DFT，它包含Hartree项加上交换-相关核的贡献。令广义力（右侧项）为嵌入势 $ \\delta v $ 在占据-虚拟轨道对上的投影向量 $ \\mathbf{f} $。\n\n您的程序必须以数值方式实现该线性响应方案，通过求解耦合微扰线性系统得到振幅 $ \\mathbf{t} $，然后评估相应的二阶能量降低，该能量降低定义了EDA极化能。该方案必须：\n- 只使用提供的 $ \\Delta_{ai} $ 值、对称矩阵 $ \\mathbf{K} $ 以及向量 $ \\mathbf{f} $。不得引入任何额外的经验参数。\n- 求解由响应平稳性条件所蕴含的、关于 $ \\mathbf{t} $ 的适定对称线性系统。\n- 在二次能量展开的框架内，根据收敛的振幅和广义力计算二阶极化能，单位为Hartree。\n- 对于正定的Hessian矩阵，确保所得的极化能为非正值（能量降低或为零）。\n\n物理单位：所有能量必须以Hartree表示。不使用角度。将每个极化能以Hartree为单位的浮点数形式输出。\n\n测试套件：\n对于以下各种情况，激发空间由占据-虚拟轨道对枚举，数据以数值数组形式提供：\n- 情况1（单激发，屏蔽的CPHF/LR-DFT类）：\n  - $ \\Delta = [\\,0.6\\,] $\n  - $ \\mathbf{K} = \\begin{bmatrix} 0.2 \\end{bmatrix} $\n  - $ \\mathbf{f} = [\\,0.05\\,] $\n- 情况2（双激发，对角核）：\n  - $ \\Delta = [\\,0.5,\\,1.0\\,] $\n  - $ \\mathbf{K} = \\begin{bmatrix} 0.1 & 0 \\\\ 0 & 0.2 \\end{bmatrix} $\n  - $ \\mathbf{f} = [\\,0.04,\\,0.02\\,] $\n- 情况3（双激发，非对角耦合）：\n  - $ \\Delta = [\\,0.7,\\,0.9\\,] $\n  - $ \\mathbf{K} = \\begin{bmatrix} 0.3 & 0.05 \\\\ 0.05 & 0.25 \\end{bmatrix} $\n  - $ \\mathbf{f} = [\\,0.03,\\,0.025\\,] $\n- 情况4（边界条件，小能隙，无屏蔽）：\n  - $ \\Delta = [\\,0.05\\,] $\n  - $ \\mathbf{K} = \\begin{bmatrix} 0.0 \\end{bmatrix} $\n  - $ \\mathbf{f} = [\\,0.01\\,] $\n\n最终输出格式：\n您的程序应生成单行输出，其中包含四种情况的极化能，形式为用方括号括起来的逗号分隔列表，例如 $[x_1,x_2,x_3,x_4]$，其中每个 $x_k$ 是您的方案计算出的以Hartree为单位的浮点数。不应打印任何附加文本。", "solution": "该问题要求在一个标准的能量分解分析（EDA）框架内，实现一个计算极化能 $E_{\\text{pol}}$ 的数值方案。其理论基础是，在外部静电势 $\\delta v$ 存在的情况下，对碎片电子能量的二次近似进行变分最小化。\n\n碎片的总能量，包括其与外场的相互作用，是轨道旋转振幅的函数，由向量 $\\mathbf{t}$ 表示。这些振幅参数化了碎片内部的密度弛豫 $\\delta \\rho$，同时禁止了碎片间的电荷转移。由此极化引起的能量变化，在 $\\mathbf{t}$ 的二阶以内，由以下模型给出：\n$$ E_{\\text{pol}}(\\mathbf{t}) = \\frac{1}{2} \\mathbf{t}^T \\mathbf{H} \\mathbf{t} + \\mathbf{f}^T \\mathbf{t} $$\n此处，$\\mathbf{f}$ 是广义力向量，代表微扰 $\\delta v$ 与一阶密度响应之间的耦合。矩阵 $\\mathbf{H}$ 是孤立碎片的电子Hessian矩阵，其形式为轨道能隙对角矩阵 $\\mathbf{D} = \\mathrm{diag}(\\Delta_{ai})$ 与屏蔽核 $\\mathbf{K}$ 之和。Hessian矩阵 $\\mathbf{H} = \\mathbf{D} + \\mathbf{K}$ 是对称且正定的，这反映了未受微扰基态的稳定性。\n\n根据Rayleigh–Ritz变分原理，物理响应对应于使 $E_{\\text{pol}}(\\mathbf{t})$ 最小化的振幅 $\\mathbf{t}$。通过将能量对 $\\mathbf{t}$ 的梯度设为零来找到此最小值：\n$$ \\nabla_{\\mathbf{t}} E_{\\text{pol}}(\\mathbf{t}) = \\mathbf{H} \\mathbf{t} + \\mathbf{f} = \\mathbf{0} $$\n该条件产生了一个关于最优响应向量 $\\mathbf{t}$ 的线性方程组：\n$$ \\mathbf{H} \\mathbf{t} = -\\mathbf{f} $$\n由于 $\\mathbf{H}$ 是对称正定的，存在唯一解 $\\mathbf{t} = -\\mathbf{H}^{-1}\\mathbf{f}$，且该解对应于一个稳定的能量极小值。\n\n极化能是在此最优 $\\mathbf{t}$ 处的 $E_{\\text{pol}}(\\mathbf{t})$ 值。将条件 $\\mathbf{H}\\mathbf{t} = -\\mathbf{f}$ 代入能量表达式，可得到一个计算上更方便的公式：\n$$ E_{\\text{pol}} = \\frac{1}{2} \\mathbf{t}^T (\\mathbf{H}\\mathbf{t}) + \\mathbf{f}^T \\mathbf{t} = \\frac{1}{2} \\mathbf{t}^T (-\\mathbf{f}) + \\mathbf{f}^T \\mathbf{t} = -\\frac{1}{2} \\mathbf{f}^T \\mathbf{t} + \\mathbf{f}^T \\mathbf{t} = \\frac{1}{2} \\mathbf{f}^T \\mathbf{t} $$\n这个表达式 $E_{\\text{pol}} = \\frac{1}{2} \\mathbf{f} \\cdot \\mathbf{t}$ 确立了该数值方案的最后一步。极化能的非正性是有保证的，因为代入 $\\mathbf{t} = -\\mathbf{H}^{-1}\\mathbf{f}$ 会得到 $E_{\\text{pol}} = -\\frac{1}{2}\\mathbf{f}^T\\mathbf{H}^{-1}\\mathbf{f}$。对于正定矩阵 $\\mathbf{H}$，其逆矩阵 $\\mathbf{H}^{-1}$ 也是正定的，这意味着二次型 $\\mathbf{f}^T\\mathbf{H}^{-1}\\mathbf{f} \\ge 0$，因此 $E_{\\text{pol}} \\le 0$。\n\n所需的数值方案如下：\n$1$. 对每个测试用例，通过将提供的屏蔽核 $\\mathbf{K}$ 加到由轨道能差 $\\Delta_{ai}$ 构成的对角矩阵 $\\mathbf{D}$ 上，来构建Hessian矩阵 $\\mathbf{H}$。\n$2$. 求解线性系统 $\\mathbf{H}\\mathbf{t} = -\\mathbf{f}$ 以获得响应向量 $\\mathbf{t}$。\n$3$. 使用公式 $E_{\\text{pol}} = \\frac{1}{2} \\mathbf{f}^T \\mathbf{t}$ 计算极化能，单位为Hartree。\n将此过程应用于每个提供的测试用例。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes polarization energies for a series of test cases based on\n    a linear-response model (CPHF/LR-DFT) within an EDA framework.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"delta\": np.array([0.6]),\n            \"K\": np.array([[0.2]]),\n            \"f\": np.array([0.05])\n        },\n        {\n            \"delta\": np.array([0.5, 1.0]),\n            \"K\": np.array([[0.1, 0.0], [0.0, 0.2]]),\n            \"f\": np.array([0.04, 0.02])\n        },\n        {\n            \"delta\": np.array([0.7, 0.9]),\n            \"K\": np.array([[0.3, 0.05], [0.05, 0.25]]),\n            \"f\": np.array([0.03, 0.025])\n        },\n        {\n            \"delta\": np.array([0.05]),\n            \"K\": np.array([[0.0]]),\n            \"f\": np.array([0.01])\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        # Extract data for the current case\n        delta_vals = case[\"delta\"]\n        K_matrix = case[\"K\"]\n        f_vector = case[\"f\"]\n        \n        # 1. Construct the Hessian matrix H = D + K.\n        # D is the diagonal matrix of orbital energy differences.\n        D_matrix = np.diag(delta_vals)\n        H_matrix = D_matrix + K_matrix\n        \n        # 2. Solve the linear system H * t = -f for the response vector t.\n        # The right-hand side of the linear equation is the negative of the force vector.\n        rhs = -f_vector\n        t_vector = np.linalg.solve(H_matrix, rhs)\n        \n        # 3. Compute the polarization energy E_pol = 0.5 * f^T * t.\n        # This is implemented as a dot product between f and t.\n        polarization_energy = 0.5 * np.dot(f_vector, t_vector)\n        \n        results.append(polarization_energy)\n\n    # Final print statement in the exact required format.\n    # The output is a comma-separated list of floating-point numbers in square brackets.\n    result_str = \",\".join(map(str, results))\n    print(f\"[{result_str}]\")\n\nsolve()\n```", "id": "2889710"}]}