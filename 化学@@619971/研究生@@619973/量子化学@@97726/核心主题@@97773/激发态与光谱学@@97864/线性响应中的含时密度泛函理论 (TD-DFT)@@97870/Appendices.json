{"hands_on_practices": [{"introduction": "第一个实践练习旨在建立 TDDFT 计算产生的光谱信息与关键材料属性（静态极化率）之间的直接联系。通过推导和应用“状态求和”公式，您将获得将线性响应理论的基本输出转化为具有物理意义的量的实践经验。[@problem_id:2932938]", "problem": "一个单电子模型体系在电偶极近似下，通过含时密度泛函理论（TDDFT）的线性响应机制进行描述。各向同性、含频偶极极化率 $\\,\\alpha(\\omega)\\,$ 由感生偶极矩与外加匀强电场之间的线性关系定义。考虑偶极-偶极响应函数的 Lehmann 表示以及偶极振子强度的标准长度规范定义。仅使用基本的线性响应定义和守恒定律（如 Thomas–Reiche–Kuhn 求和规则）作为出发点。\n\n给定一个由三个离散激发态组成的模型 TDDFT 激发谱，其跃迁能量（单位为哈特里原子单位）和各向同性振子强度（无量纲）如下：\n- $\\,\\omega_{10} = 0.25\\,$，$\\,f_{01} = 0.30\\,$，\n- $\\,\\omega_{20} = 0.40\\,$，$\\,f_{02} = 0.45\\,$，\n- $\\,\\omega_{30} = 0.80\\,$，$\\,f_{03} = 0.15\\,$。\n\n假设对于此单电子模型，Thomas–Reiche–Kuhn 求和规则精确成立，即 $\\,\\sum_{n} f_{0n} = 1.000\\,$。为了涵盖给定三个态之外的所有更高能的离散和连续激发，用一个平均能量为 $\\,\\omega_{\\mathrm{eff}} = 1.50\\,$、振子强度为 $\\,f_{\\mathrm{tail}} = 1.000 - (0.30 + 0.45 + 0.15)\\,$ 的单次有效跃迁来近似剩余振子强度。\n\n任务：\n1. 从偶极极化率张量的线性响应定义和振子强度的长度规范定义出发，推导静态各向同性偶极极化率 $\\,\\alpha(0)\\,$ 以激发能 $\\,\\omega_{n0}\\,$ 和各向同性振子强度 $\\,f_{0n}\\,$ 表示的态求和表达式。\n2. 使用你推导出的表达式和模型谱（包括有效尾部），计算 $\\,\\alpha(0)\\,$ 的数值。\n\n以原子单位体积 $\\,a_0^3\\,$ 表示最终的极化率，并将最终数值答案四舍五入到四位有效数字。", "solution": "所给问题经核实具有科学依据，提法明确且客观。这是应用线性响应含时密度泛函理论（TDDFT）的一个标准练习。下面开始解题。\n\n问题分为两部分：首先，推导一个关键公式；其次，进行数值应用。\n\n第一部分：推导静态极化率表达式。\n\n出发点是含频偶极极化率张量 $\\alpha_{ij}(\\omega)$ 的 Lehmann 表示，该表示源于二阶微扰理论。在原子单位（其中 $\\hbar = e = m_e = 4\\pi\\epsilon_0 = 1$）下，其表达式为：\n$$ \\alpha_{ij}(\\omega) = \\sum_{n \\neq 0} \\left( \\frac{\\langle \\Psi_0 | \\hat{d}_i | \\Psi_n \\rangle \\langle \\Psi_n | \\hat{d}_j | \\Psi_0 \\rangle}{\\omega_{n0} - \\omega} + \\frac{\\langle \\Psi_0 | \\hat{d}_j | \\Psi_n \\rangle \\langle \\Psi_n | \\hat{d}_i | \\Psi_0 \\rangle}{\\omega_{n0} + \\omega} \\right) $$\n此处，$\\Psi_0$ 和 $\\Psi_n$ 分别是电子基态和激发态。$\\hat{d}_i$ 是电偶极算符的第 $i$ 个笛卡尔分量。量 $\\omega_{n0} = E_n - E_0$ 是从基态到第 $n$ 个激发态的激发能。为清晰起见，省略了与微扰的绝热开启相关的无穷小项 $i\\eta$，因为我们关心的是非共振频率 $\\omega$。\n\n问题要求的是各向同性极化率 $\\alpha(\\omega)$，它通过对张量的对角分量求平均得到：\n$$ \\alpha(\\omega) = \\frac{1}{3} \\sum_{i=x,y,z} \\alpha_{ii}(\\omega) $$\n代入 $\\alpha_{ii}(\\omega)$ 的表达式可得：\n$$ \\alpha(\\omega) = \\frac{1}{3} \\sum_{n \\neq 0} \\sum_{i=x,y,z} |\\langle \\Psi_0 | \\hat{d}_i | \\Psi_n \\rangle|^2 \\left( \\frac{1}{\\omega_{n0} - \\omega} + \\frac{1}{\\omega_{n0} + \\omega} \\right) $$\n合并括号中的项得到：\n$$ \\frac{1}{\\omega_{n0} - \\omega} + \\frac{1}{\\omega_{n0} + \\omega} = \\frac{(\\omega_{n0} + \\omega) + (\\omega_{n0} - \\omega)}{(\\omega_{n0} - \\omega)(\\omega_{n0} + \\omega)} = \\frac{2\\omega_{n0}}{\\omega_{n0}^2 - \\omega^2} $$\n因此，动态各向同性极化率的表达式变为：\n$$ \\alpha(\\omega) = \\sum_{n \\neq 0} \\frac{2\\omega_{n0}}{3(\\omega_{n0}^2 - \\omega^2)} \\sum_{i=x,y,z} |\\langle \\Psi_0 | \\hat{d}_i | \\Psi_n \\rangle|^2 $$\n下一步是引入各向同性振子强度 $f_{0n}$。问题指定使用长度规范定义，在原子单位下为：\n$$ f_{0n} = \\frac{2}{3} \\omega_{n0} \\sum_{i=x,y,z} |\\langle \\Psi_0 | \\hat{d}_i | \\Psi_n \\rangle|^2 $$\n该定义允许替换跃迁偶极矩平方和。重排 $f_{0n}$ 的定义，我们得到：\n$$ \\sum_{i=x,y,z} |\\langle \\Psi_0 | \\hat{d}_i | \\Psi_n \\rangle|^2 = \\frac{3 f_{0n}}{2 \\omega_{n0}} $$\n将此代入 $\\alpha(\\omega)$ 的表达式中：\n$$ \\alpha(\\omega) = \\sum_{n \\neq 0} \\frac{2\\omega_{n0}}{3(\\omega_{n0}^2 - \\omega^2)} \\left( \\frac{3 f_{0n}}{2 \\omega_{n0}} \\right) $$\n简化后得到著名的动态各向同性极化率的态求和公式：\n$$ \\alpha(\\omega) = \\sum_{n \\neq 0} \\frac{f_{0n}}{\\omega_{n0}^2 - \\omega^2} $$\n问题要求的是静态极化率 $\\alpha(0)$，即频率 $\\omega$ 趋近于零时 $\\alpha(\\omega)$ 的极限。\n$$ \\alpha(0) = \\lim_{\\omega \\to 0} \\sum_{n \\neq 0} \\frac{f_{0n}}{\\omega_{n0}^2 - \\omega^2} = \\sum_{n \\neq 0} \\frac{f_{0n}}{\\omega_{n0}^2} $$\n这就是所要求的以激发能和振子强度表示的静态各向同性偶极极化率的表达式。至此，第一部分任务完成。\n\n第二部分：$\\alpha(0)$ 的数值计算。\n\n我们使用推导出的公式 $\\alpha(0) = \\sum_{n \\neq 0} \\frac{f_{0n}}{\\omega_{n0}^2}$。该模型谱由三个明确的态和一个用于说明剩余振子强度的“尾部”组成。\n对于单电子体系，Thomas–Reiche–Kuhn 求和规则指出 $\\sum_n f_{0n} = 1$。给定振子强度的总和是：\n$$ f_{01} + f_{02} + f_{03} = 0.30 + 0.45 + 0.15 = 0.90 $$\n因此，剩余振子强度（我们标记为 $f_{\\text{tail}}$）为：\n$$ f_{\\text{tail}} = 1.000 - 0.90 = 0.10 $$\n该剩余强度与一个有效能量 $\\omega_{\\text{eff}} = 1.50$ Hartree 相关联。\n\n总的静态极化率通过对四个有效跃迁的贡献求和来计算：\n$$ \\alpha(0) = \\frac{f_{01}}{\\omega_{10}^2} + \\frac{f_{02}}{\\omega_{20}^2} + \\frac{f_{03}}{\\omega_{30}^2} + \\frac{f_{\\text{tail}}}{\\omega_{\\text{eff}}^2} $$\n代入给定的数值：\n$$ \\alpha(0) = \\frac{0.30}{(0.25)^2} + \\frac{0.45}{(0.40)^2} + \\frac{0.15}{(0.80)^2} + \\frac{0.10}{(1.50)^2} $$\n我们计算每一项：\n$$ \\frac{0.30}{0.0625} = 4.8 $$\n$$ \\frac{0.45}{0.16} = 2.8125 $$\n$$ \\frac{0.15}{0.64} = 0.234375 $$\n$$ \\frac{0.10}{2.25} = 0.0444... $$\n总和为：\n$$ \\alpha(0) = 4.8 + 2.8125 + 0.234375 + 0.0444... = 7.8913194... $$\n结果的单位是原子单位体积（$a_0^3$）。问题要求将最终答案四舍五入到四位有效数字。\n$$ \\alpha(0) \\approx 7.891 \\, a_0^3 $$\n这就是最终的数值结果。", "answer": "$$\\boxed{7.891}$$", "id": "2932938"}, {"introduction": "这个练习超越了简单的应用，深入探讨了制约 TDDFT 的基本理论约束。通过分析可精确求解的胡克原子模型，您将从第一性原理出发，证明质心运动独立于电子-电子相互作用，并揭示这对精确交换相关核的结构意味着什么。这个实践突显了理想化模型如何为多体理论的形式结构提供深刻的见解。[@problem_id:2932929]", "problem": "考虑一个被称为胡克原子的双电子体系：两个电子，质量均为 $1$，电荷均为 $-1$，在一个频率为 $\\omega$ 的三维各向同性谐振子势阱中运动，并通过库仑排斥相互作用。在原子单位下，其哈密顿算符为\n$$\n\\hat{H} = \\sum_{i=1}^{2}\\left(-\\frac{1}{2}\\nabla_{i}^{2} + \\frac{1}{2}\\,\\omega^{2}\\,|\\mathbf{r}_{i}|^{2}\\right) + \\frac{1}{|\\mathbf{r}_{1} - \\mathbf{r}_{2}|}.\n$$\n现施加一个沿 $x$ 轴极化的、空间均匀的弱含时电场，其微扰项为\n$$\n\\delta \\hat{V}(t) = - \\mathcal{E}\\,\\cos(\\Omega t)\\,\\sum_{i=1}^{2} x_{i},\n$$\n其中 $\\mathcal{E}$ 是一个小的实数振幅，$\\Omega$ 是驱动角频率。请在电偶极近似下进行计算。\n\n1) 从含时薛定谔方程和未微扰哈密顿算符的结构出发，使用质心坐标和相对坐标，从第一性原理论证：最低的偶极允许的精确激发能（沿 $x$ 轴的精确线性密度响应中的第一个极点）等于 $\\omega$，且与电子-电子相互作用强度无关。请在推导中明确说明您使用的任何对易性或可分性。\n\n2) 现在，在含时密度泛函理论（TDDFT）的线性响应机制下，对一个闭壳层基态，使用精确的 Kohn-Sham（KS）系统分析相同的激发。令 $\\Delta \\varepsilon$ 表示与 $x$ 极化偶极算符耦合的第一个未占据空间轨道和最高已占据空间轨道之间的 KS 单粒子能量差。请仅援引谐振子势阱的公认约束条件，将偶极允许响应的 $\\Delta \\varepsilon$ 与 $\\omega$ 联系起来。\n\n3) 在 TDDFT 的 Tamm-Dancoff 近似（TDA）中，考虑由沿 $x$ 轴的主要 KS 跃迁 $| \\phi_{0} \\rangle \\to | \\phi_{1} \\rangle$ 张成的单极点子空间。用 $K_{d}$ 表示该子空间上 Hartree-交换-相关核（在跃迁密度度规下）的对角矩阵元。使用线性响应框架（不假设任何特定的近似泛函），将 TDDFT TDA 激发能 $\\omega_{\\mathrm{TDDFT}}$ 表示为 $\\Delta \\varepsilon$ 和 $K_{d}$ 的函数，然后要求其与第 1 部分的精确结果一致，以确定 $K_{d}$ 作为 $\\omega$ 的函数。\n\n请以 Hartree 为单位给出 $K_{d}$ 的最终答案。无需四舍五入。", "solution": "本题将首先被验证，若判定有效，则按要求分三部分求解。\n\n第一步是严格验证问题陈述的有效性。\n\n逐字提取给定条件：\n- 体系：一个被称为胡克原子的双电子体系。\n- 粒子性质：两个电子，质量均为 $1$，电荷均为 $-1$。\n- 外势：一个频率为 $\\omega$ 的三维各向同性谐振子势阱。\n- 相互作用：库仑排斥，势为 $1/|\\mathbf{r}_{1} - \\mathbf{r}_{2}|$。\n- 未微扰哈密顿算符：$\\hat{H} = \\sum_{i=1}^{2}\\left(-\\frac{1}{2}\\nabla_{i}^{2} + \\frac{1}{2}\\,\\omega^{2}\\,|\\mathbf{r}_{i}|^{2}\\right) + \\frac{1}{|\\mathbf{r}_{1} - \\mathbf{r}_{2}|}$。\n- 微扰：$\\delta \\hat{V}(t) = - \\mathcal{E}\\,\\cos(\\Omega t)\\,\\sum_{i=1}^{2} x_{i}$。\n- 微扰性质：小的实数振幅 $\\mathcal{E}$，驱动角频率 $\\Omega$。\n- 近似：电偶极近似。\n- 第 1 部分目标：从第一性原理论证最低的偶极允许的精确激发能为 $\\omega$。\n- 第 2 部分目标：在精确 Kohn-Sham (KS) 理论框架下，将相关的 KS 轨道能隙 $\\Delta \\varepsilon$ 与 $\\omega$ 联系起来。\n- 第 3 部分目标：使用含时密度泛函理论（TDDFT）的 Tamm-Dancoff 近似（TDA），将激发能 $\\omega_{\\mathrm{TDDFT}}$ 表示为 $\\Delta \\varepsilon$ 和一个核矩阵元 $K_{d}$ 的函数。通过要求其与精确结果一致来确定 $K_{d}(\\omega)$。\n\n验证结论：\n该问题具有科学依据，提法明确且客观。它基于量子力学和 TDDFT 的既定原理，并利用了一个标准模型体系（胡克原子）。问题逻辑结构清晰，包含了严格推导所需的所有信息。这是理论化学中一个有深度的问题，旨在检验对多体物理和电子结构理论的基本理解。该问题有效。我们开始求解。\n\n第 1 部分：精确偶极激发能\n\n该问题通过将哈密顿算符变换到质心（COM）和相对坐标系来解决。设两个电子的位置分别为 $\\mathbf{r}_{1}$ 和 $\\mathbf{r}_{2}$。\n质心坐标为 $\\mathbf{R} = \\frac{\\mathbf{r}_{1} + \\mathbf{r}_{2}}{2}$。\n相对坐标为 $\\mathbf{r} = \\mathbf{r}_{1} - \\mathbf{r}_{2}$。\n电子质量为 $m_{1}=m_{2}=1$（原子单位）。总质量为 $M = m_{1} + m_{2} = 2$，折合质量为 $\\mu = \\frac{m_{1}m_{2}}{m_{1}+m_{2}} = \\frac{1}{2}$。\n\n动能算符变换如下：\n$$\n-\\frac{1}{2}\\nabla_{1}^{2} - \\frac{1}{2}\\nabla_{2}^{2} = -\\frac{1}{2M}\\nabla_{\\mathbf{R}}^{2} - \\frac{1}{2\\mu}\\nabla_{\\mathbf{r}}^{2} = -\\frac{1}{4}\\nabla_{\\mathbf{R}}^{2} - \\nabla_{\\mathbf{r}}^{2}\n$$\n谐振子势项变换如下：\n$$\n\\frac{1}{2}\\omega^{2}|\\mathbf{r}_{1}|^{2} + \\frac{1}{2}\\omega^{2}|\\mathbf{r}_{2}|^{2} = \\frac{1}{2}\\omega^{2}(|\\mathbf{R} + \\frac{1}{2}\\mathbf{r}|^{2} + |\\mathbf{R} - \\frac{1}{2}\\mathbf{r}|^{2}) = \\frac{1}{2}\\omega^{2}(2|\\mathbf{R}|^{2} + \\frac{1}{2}|\\mathbf{r}|^{2}) = \\omega^{2}|\\mathbf{R}|^{2} + \\frac{1}{4}\\omega^{2}|\\mathbf{r}|^{2}\n$$\n根据定义，库仑相互作用项仅依赖于相对坐标：$\\frac{1}{|\\mathbf{r}_{1} - \\mathbf{r}_{2}|} = \\frac{1}{|\\mathbf{r}|}$。\n\n总哈密顿算符 $\\hat{H}$ 分解为质心部分和相对部分：\n$$\n\\hat{H} = \\left(-\\frac{1}{4}\\nabla_{\\mathbf{R}}^{2} + \\omega^{2}|\\mathbf{R}|^{2}\\right) + \\left(-\\nabla_{\\mathbf{r}}^{2} + \\frac{1}{4}\\omega^{2}|\\mathbf{r}|^{2} + \\frac{1}{|\\mathbf{r}|}\\right) = \\hat{H}_{\\mathrm{COM}}(\\mathbf{R}) + \\hat{H}_{\\mathrm{rel}}(\\mathbf{r})\n$$\n质心哈密顿算符 $\\hat{H}_{\\mathrm{COM}} = -\\frac{1}{2(2)}\\nabla_{\\mathbf{R}}^{2} + \\frac{1}{2}(2)\\omega^{2}|\\mathbf{R}|^{2}$ 描述了一个质量为 $M=2$ 的单粒子在频率为 $\\omega$ 的三维各向同性谐振子势中的运动。$\\hat{H}_{\\mathrm{COM}}$ 的能量本征值为 $E_{\\mathrm{COM}} = (N + \\frac{3}{2})\\omega$，其中 $N=n_{X}+n_{Y}+n_{Z}$ 是总量子数。\n\n微扰由沿 $x$ 轴的电偶极算符 $\\hat{D}_{x} = \\sum_{i=1}^{2} x_{i}$ 描述。在新坐标系中，$x_{1} = X + \\frac{1}{2}x$，$x_{2} = X - \\frac{1}{2}x$，因此该算符变为：\n$$\n\\hat{D}_{x} = (X + \\frac{1}{2}x) + (X - \\frac{1}{2}x) = 2X\n$$\n偶极算符*仅*依赖于质心坐标 $X$。由于哈密顿算符是可分的，并且偶极算符仅作用于质心子系统，因此该算符引起的跃迁只能改变质心运动的量子态，而由 $\\hat{H}_{\\mathrm{rel}}$ 描述的相对运动的状态保持不变。这是广义 Kohn 定理的一种体现。\n\n体系的基态为 $\\Psi_{0} = \\Phi_{0}(\\mathbf{R})\\psi_{0}(\\mathbf{r})$，其中 $\\Phi_{0}$ 是 $\\hat{H}_{\\mathrm{COM}}$ 的基态，$\\psi_{0}$ 是 $\\hat{H}_{\\mathrm{rel}}$ 的基态。状态 $\\Phi_{0}$ 对应于 $N=0$（即 $n_{X}=n_{Y}=n_{Z}=0$），其能量为 $E_{\\mathrm{COM},0} = \\frac{3}{2}\\omega$。\n算符 $X$ 的选择定则为 $\\Delta n_{X} = \\pm 1$。因此，从基态出发的最低能量偶极允许跃迁将质心运动从 $n_{X}=0$ 激发到 $n_{X}=1$，而 $n_{Y}$ 和 $n_{Z}$ 保持为 $0$。最终的质心态量子数为 $n_{X}=1, n_{Y}=0, n_{Z}=0$，因此 $N=1$。这个末态的能量为 $E_{\\mathrm{COM},1} = (1 + \\frac{3}{2})\\omega = \\frac{5}{2}\\omega$。\n此跃迁的精确激发能是质心能量的差值，因为相对能量没有改变：\n$$\n\\Delta E = E_{\\mathrm{COM},1} - E_{\\mathrm{COM},0} = \\frac{5}{2}\\omega - \\frac{3}{2}\\omega = \\omega\n$$\n该结果是精确的，并且与电子-电子相互作用的强度无关。\n\n第 2 部分：Kohn-Sham 轨道能量差\n\n在 TDDFT 中，相互作用体系的精确含时密度 $n(\\mathbf{r}, t)$ 可由一个在有效含时 KS 势下演化的虚构的无相互作用 Kohn-Sham (KS) 体系复现。相互作用体系的线性密度响应必须与 KS 体系的线性密度响应完全相同。\n对于谐振子外势中的相互作用体系，由均匀电场激发的质心运动以裸势阱频率 $\\omega$ 振荡。这意味着精确的密度响应函数在 $\\omega$ 处有一个极点。\n为了复现这一结果，KS 体系的响应也必须在 $\\omega$ 处有一个极点。裸 KS 响应函数 $\\chi_{s}(\\Omega)$ 的极点出现在 KS 轨道能量差 $\\varepsilon_{a} - \\varepsilon_{i}$ 处，其中 $\\varepsilon_{i}$ 是已占据轨道的能量，$\\varepsilon_{a}$ 是未占据轨道的能量。TDDFT 线性响应方程随后通过 Hartree-交换-相关 (Hxc) 核将这些极点移动到真实的激发能位置。\n然而，对于谐振子势阱中偶极激发这一特殊情况，一个被称为谐振子势定理（或 KS-Kohn 定理）的强约束要求精确的 Hxc 核对偶极振荡频率不提供任何校正。因此，裸 KS 响应函数的相关极点必须已经位于精确的频率上。\n该体系是一个闭壳层双电子原子，因此最高已占据分子轨道（HOMO）是一个球对称的 $s$ 型轨道。偶极算符 $x$ 具有奇宇称，根据选择定则，它会诱导向 $p$ 型对称轨道的跃迁。第一组未占据轨道（LUMO）是简并的 $p$ 轨道。问题将 $\\Delta \\varepsilon$ 定义为与 $x$ 极化偶极算符耦合的能量最低的已占据轨道和未占据轨道之间的 KS 能量差。这对应于 HOMO-LUMO 能量差，即 $\\Delta \\varepsilon = \\varepsilon_{\\mathrm{LUMO}} - \\varepsilon_{\\mathrm{HOMO}}$。\n为了满足谐振子势定理，精确 KS 体系中的这个能隙必须等于势阱频率：\n$$\n\\Delta \\varepsilon = \\omega\n$$\n\n第 3 部分：TDA 核矩阵元\n\n在 Tamm-Dancoff 近似（TDA）中，激发能 $\\omega_{\\mathrm{TDDFT}}$ 通过求解本征值问题 $\\mathbf{A} \\mathbf{F} = \\omega_{\\mathrm{TDDFT}} \\mathbf{F}$ 得到，其中矩阵 $\\mathbf{A}$ 由 $A_{ia,jb} = \\delta_{ij}\\delta_{ab}(\\varepsilon_{a} - \\varepsilon_{i}) + K_{ia,jb}$ 给出。这里，$K_{ia,jb}$ 是 Hxc 核的矩阵元。\n该问题要求考虑一个单极点子空间，这意味着我们只考虑从 HOMO（记为 $i$）到 LUMO（记为 $a$）的主要跃迁。矩阵 $\\mathbf{A}$ 变为一个 $1 \\times 1$ 矩阵，即一个标量。本征值方程非常简单：\n$$\n\\omega_{\\mathrm{TDDFT}} = (\\varepsilon_{a} - \\varepsilon_{i}) + K_{ia,ia}\n$$\n根据问题的符号表示，$\\Delta \\varepsilon = \\varepsilon_{a} - \\varepsilon_{i}$ 且 $K_{d} = K_{ia,ia}$ 是此跃迁的对角核矩阵元。因此，TDA 激发能为：\n$$\n\\omega_{\\mathrm{TDDFT}} = \\Delta \\varepsilon + K_{d}\n$$\n现在，我们施加条件，要求这个 TDDFT TDA 结果与第 1 部分推导出的精确激发能 $\\omega$ 一致。\n$$\n\\omega = \\Delta \\varepsilon + K_{d}\n$$\n根据第 2 部分的分析，对于精确的 KS 体系，我们有约束条件 $\\Delta \\varepsilon = \\omega$。将此代入方程可得：\n$$\n\\omega = \\omega + K_{d}\n$$\n这个方程意味着核矩阵元必须为零。\n$$\nK_{d} = 0\n$$\n这个结果 $K_d = 0$ 表明，对于精确的 Hxc 泛函，在谐振子势中，对质心激发的 TDA 核的 Hartree 贡献和交换-相关贡献之和恰好为零。这种抵消是一个已知的性质，对于 TDDFT 在此类体系中恢复正确的偶极响应至关重要。任何不能实现这种抵消的近似泛函都将对该模式产生不正确的激发能。", "answer": "$$\n\\boxed{0}\n$$", "id": "2932929"}, {"introduction": "这最后一个实践练习处理了标准 TDDFT 中最著名的挑战之一：对电荷转移激发的描述。通过一个计算练习，您将模拟这一失败，并定量地探索现代范围分离混合泛函如何通过恢复正确的长程电子-空穴相互作用来纠正它。这个问题弥合了理论理解与先进泛函开发的实际应用之间的差距。[@problem_id:2932958]", "problem": "给定一个双片段的给体-受体系统，其中心间距为 $R$ (单位为玻尔)。给体的电离势为 $I$ (单位为哈特里)，受体的电子亲和能为 $A$ (单位为哈特里)。在含时密度泛函理论 (TDDFT) 的线性响应机制下，并使用 Tamm–Dancoff 近似 (TDA) 以及一个由给体最高占据轨道到受体最低未占轨道跃迁主导的单极点模型进行研究。假设片段之间无重叠，且基态下片段间的电子交换可以忽略不计。\n\n从线性响应 Kohn–Sham 理论的基本原理和核的定义出发，按以下步骤进行：\n- 使用 Kohn–Sham (KS) 独立粒子跃迁能作为基本带隙，即将给体电离势与受体电子亲和能之差 $I - A$ 作为独立粒子贡献。利用关于精确 Kohn–Sham 势和基本带隙的公认事实来证明此做法的合理性。\n- 通过一个范围分离杂化 (RSH) 交换相关核来引入电子-空穴相互作用，该核由参数 $\\mu$ (单位为 bohr$^{-1}$) 和 $f_{\\mathrm{LR}}$ (无量纲) 表征。参数 $\\mu$ 设定了短程和长程物理之间的分离长度尺度，$f_{\\mathrm{LR}}$ 是在长程部分施加的精确交换的比例。通过结合独立粒子项和长程核贡献，在单极点、无重叠极限下，推导电荷转移激发能 $\\Omega_{\\mathrm{RSH}}(R;\\mu,f_{\\mathrm{LR}})$ 的闭合形式解析模型。您的推导应基于库仑相互作用的标准范围分离恒等式，以及将长程核解释为在分离距离 $R$ 处产生电子-空穴吸引的观点。\n- 将电荷转移激发的精确长程渐近线定义为 $\\Omega_{\\text{exact}}(R) = I - A - 1/R$ (原子单位)。解释为什么对于大距离 $R$ 处的无重叠片段，这是正确的渐近线。\n\n实现一个程序，对下面的每个测试用例，计算：\n1. 范围分离杂化模型的激发能 $\\Omega_{\\mathrm{RSH}}$ (单位为哈特里)。\n2. 精确长程渐近线 $\\Omega_{\\mathrm{exact}}$ (单位为哈特里)。\n3. 差值 $\\Delta = \\Omega_{\\mathrm{RSH}} - \\Omega_{\\mathrm{exact}}$ (单位为哈特里)。\n\n所有能量必须以哈特里表示，并四舍五入到六位小数。距离 $R$ 必须以玻尔为单位，不涉及角度。您的程序必须生成单行输出，包含一个逗号分隔的列表的列表形式的结果，其中每个内部列表的形式为 $[\\Omega_{\\mathrm{RSH}}, \\Omega_{\\mathrm{exact}}, \\Delta]$，顺序与测试套件相同。例如：“[[x1,y1,z1],[x2,y2,z2],...]”。\n\n使用以下测试套件（每个元组为 $(I, A, R, \\mu, f_{\\mathrm{LR}})$，其中 $I$ 和 $A$ 的单位为哈特里，$R$ 的单位为玻尔，$\\mu$ 的单位为 bohr$^{-1}$，$f_{\\mathrm{LR}}$ 为无量纲）：\n- 情况 $1$ (理想情况，接近渐近分离且具有全长程精确交换)： $(\\,0.5,\\,0.1,\\,10.0,\\,0.3,\\,1.0\\,)$。\n- 情况 $2$ (与情况 1 相同，但没有长程精确交换，以测试已知的缺陷)： $(\\,0.5,\\,0.1,\\,10.0,\\,0.3,\\,0.0\\,)$。\n- 情况 $3$ (中等分离，大的 $\\mu$ 值导致有效的全长程行为)： $(\\,0.6,\\,0.05,\\,3.0,\\,2.0,\\,1.0\\,)$。\n- 情况 $4$ (短分离，以探究渐近模型的失效)： $(\\,0.6,\\,0.05,\\,1.0,\\,0.3,\\,1.0\\,)$。\n- 情况 $5$ (部分长程精确交换)： $(\\,0.45,\\,0.2,\\,7.5,\\,0.5,\\,0.7\\,)$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如：“[[result11,result12,result13],[result21,result22,result23],...]”）。每个结果必须是四舍五入到六位小数的浮点数。", "solution": "问题陈述已经过验证，并被认定为有效。它在科学上基于含时密度泛函理论 (TDDFT) 的原理，问题设定良好，提供了所有必要信息，并且表述客观。它要求进行一个非平凡的推导，然后进行数值实现，构成一个合法的科学问题。\n\n我们继续进行推导和求解。\n\n核心任务是为一个给体-受体系统中的最低电荷转移 (CT) 激发能 $\\Omega$ 建模。我们在 Tamm-Dancoff 近似 (TDA) 下的线性响应 TDDFT 框架内工作。对于一个由占据轨道 $i$ 到虚拟轨道 $a$ 的单次跃迁主导的系统，激发能 $\\Omega$ 的 TDA 方程简化为：\n$$\n\\Omega = \\omega_{ia} + K_{ia,ia}\n$$\n这里，$\\omega_{ia} = \\epsilon_a - \\epsilon_i$ 是来自基态 Kohn-Sham (KS) 计算的轨道能级差，其中 $\\epsilon_i$ 是给体的最高占据分子轨道 (HOMO) 的能量，$\\epsilon_a$ 是受体的最低未占分子轨道 (LUMO) 的能量。项 $K_{ia,ia}$ 是考虑了电子-空穴相互作用的耦合矩阵元。\n\n首先，我们处理独立粒子项 $\\omega_{ia}$。问题要求使用基本带隙 $I - A$ 作为此项。这可以通过考虑所涉物理量的物理意义来证明其合理性。电离势 $I$ 是从给体中移除一个电子所需的能量, $D \\rightarrow D^+ + e^-$。电子亲和能 $A$ 是一个电子附着到受体上时释放的能量, $A + e^- \\rightarrow A^-$。因此，在无限分离时，从中性对 $D \\dots A$ 创建一个分离的离子对 $D^+ \\dots A^-$ 所需的能量恰好是 $I-A$。在精确 KS 理论的背景下，一个系统的 HOMO 能量等于其电离势的负值，$\\epsilon_{\\mathrm{HOMO}} = -I$。虽然 LUMO 能量通常不以同样简单的方式与电子亲和能相关，但对于大距离分离的双片段系统，KS 轨道能级差 $\\epsilon_a - \\epsilon_i$ 趋近于 $I_D - A_A$。因此，近似 $\\omega_{ia} \\approx I - A$ 是建立 CT 激发模型的一个物理上合理的起点。\n\n其次，我们推导相互作用项 $K_{ia,ia}$。这一项源于交换相关核 $f_{xc}$ 和 Hartree 势。在 TDA 中，耦合矩阵元为：\n$$\nK_{ia,ia} = \\iint \\phi_i^*(\\mathbf{r}_1)\\phi_a(\\mathbf{r}_1) \\left( \\frac{1}{|\\mathbf{r}_1 - \\mathbf{r}_2|} + f_{xc}(\\mathbf{r}_1, \\mathbf{r}_2) \\right) \\phi_i(\\mathbf{r}_2)\\phi_a^*(\\mathbf{r}_2) \\, d\\mathbf{r}_1 d\\mathbf{r}_2\n$$\n对于无重叠片段之间的 CT 激发，跃迁密度 $\\phi_i^*(\\mathbf{r})\\phi_a(\\mathbf{r})$ 基本上处处为零。对于传统的（半）局域密度泛函，其中 $f_{xc}$ 是密度的局域或半局域函数，这会导致整个耦合项 $K_{ia,ia}$ 消失。这导致了此类泛函的众所周知的失败，即预测 $\\Omega_{\\mathrm{CT}} \\approx I - A$，且与分离距离 $R$ 无关。\n\n范围分离杂化 (RSH) 泛函通过引入一部分非局域的精确 (Hartree-Fock) 交换，特别是在长程部分，来纠正这个缺陷。RSH 泛函的交换相关核包含一个源自精确交换算符的长程分量。精确交换对耦合矩阵的贡献由下式给出：\n$$\nK_{ia,ia}^{\\text{x}} = - \\iint \\phi_i^*(\\mathbf{r}_1)\\phi_a(\\mathbf{r}_1) \\left( f_{\\text{LR}} \\frac{\\text{erf}(\\mu|\\mathbf{r}_1 - \\mathbf{r}_2|)}{|\\mathbf{r}_1 - \\mathbf{r}_2|} \\right) \\phi_a^*(\\mathbf{r}_2)\\phi_i(\\mathbf{r}_2) \\, d\\mathbf{r}_1 d\\mathbf{r}_2\n$$\n这是交换积分，通常表示为 $-(ia|ai)$。由于轨道 $i$ 和 $a$ 的无重叠特性，该积分计算结果为由交换算符的长程部分介导的空穴密度 $|\\phi_i(\\mathbf{r}_1)|^2$ 和电子密度 $|\\phi_a(\\mathbf{r}_2)|^2$ 之间的库仑吸引力。\n$$\nK_{ia,ia} \\approx - f_{\\text{LR}} \\iint |\\phi_i(\\mathbf{r}_1)|^2 \\left( \\frac{\\text{erf}(\\mu|\\mathbf{r}_1 - \\mathbf{r}_2|)}{|\\mathbf{r}_1 - \\mathbf{r}_2|} \\right) |\\phi_a(\\mathbf{r}_2)|^2 \\, d\\mathbf{r}_1 d\\mathbf{r}_2\n$$\n对于以较大中心间距 $R$ 分离的片段，我们可以将空穴和电子密度近似为位于各自片段中心的点电荷。在此近似下，$|\\mathbf{r}_1 - \\mathbf{r}_2| \\approx R$，积分简化为：\n$$\nK_{ia,ia} \\approx -f_{\\text{LR}} \\frac{\\text{erf}(\\mu R)}{R}\n$$\n结合独立粒子项和相互作用项，我们得到 RSH 电荷转移激发能的闭合形式模型：\n$$\n\\Omega_{\\text{RSH}}(R; \\mu, f_{\\text{LR}}) = I - A - f_{\\text{LR}} \\frac{\\text{erf}(\\mu R)}{R}\n$$\n\n第三，我们建立 CT 激发能的正确渐近形式。对于在较大分离距离 $R$ 处的两个无重叠片段，从中性基态 $DA$ 创建 CT 态 $D^+A^-$ 的能量可以通过基本物理原理确定。这个过程包含两个步骤：首先，在无限分离处生成离子对，这需要能量 $I - A$；其次，将点状离子 $D^+$ 和 $A^-$ 从无穷远处带到分离距离 $R$ 处，这会释放库仑吸引能。在原子单位制（能量单位为哈特里，距离单位为玻尔）中，这个静电能量为 $-1/R$。因此，总能量为：\n$$\n\\Omega_{\\text{exact}}(R) = I - A - \\frac{1}{R}\n$$\n这是一个正确的理论必须恢复的精确渐近极限。我们推导的 RSH 模型在 $f_{\\text{LR}}=1$ 和 $\\mu R \\gg 1$ 时可以做到这一点，因为当 $x \\to \\infty$ 时，$\\mathrm{erf}(x) \\to 1$。\n\n最后，模型与精确渐近线之间的差值 $\\Delta$ 为：\n$$\n\\Delta = \\Omega_{\\text{RSH}} - \\Omega_{\\text{exact}} = \\left( I - A - f_{\\text{LR}} \\frac{\\text{erf}(\\mu R)}{R} \\right) - \\left( I - A - \\frac{1}{R} \\right) = \\frac{1}{R} - f_{\\text{LR}} \\frac{\\text{erf}(\\mu R)}{R}\n$$\n\n该实现将为每个测试用例计算以下三个量：\n1.  $\\Omega_{\\text{RSH}} = I - A - f_{\\text{LR}} \\frac{\\text{erf}(\\mu R)}{R}$\n2.  $\\Omega_{\\text{exact}} = I - A - \\frac{1}{R}$\n3.  $\\Delta = \\frac{1}{R} \\left( 1 - f_{\\text{LR}} \\, \\mathrm{erf}(\\mu R) \\right)$\n\n所有计算均在原子单位制（哈特里和玻尔）下进行。", "answer": "```python\nimport numpy as np\nfrom scipy.special import erf\n\ndef solve():\n    \"\"\"\n    Computes charge-transfer excitation energies for a donor-acceptor system\n    using a simplified TDDFT model and compares them to the exact asymptote.\n    \"\"\"\n\n    # Test suite: (I, A, R, mu, f_LR)\n    # I: Ionization potential (Hartree)\n    # A: Electron affinity (Hartree)\n    # R: Donor-acceptor distance (bohr)\n    # mu: Range-separation parameter (bohr^-1)\n    # f_LR: Fraction of long-range exact exchange (dimensionless)\n    test_cases = [\n        (0.5, 0.1, 10.0, 0.3, 1.0),\n        (0.5, 0.1, 10.0, 0.3, 0.0),\n        (0.6, 0.05, 3.0, 2.0, 1.0),\n        (0.6, 0.05, 1.0, 0.3, 1.0),\n        (0.45, 0.2, 7.5, 0.5, 0.7),\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        I, A, R, mu, f_LR = case\n\n        # Ensure R is not zero to avoid division by zero\n        if R <= 0:\n            raise ValueError(\"Distance R must be positive.\")\n\n        # Independent-particle energy (fundamental gap)\n        # This is the energy to create the ion pair at infinite separation.\n        omega_ia = I - A\n\n        # Calculate Omega_RSH using the derived model\n        # Omega_RSH = I - A - f_LR * erf(mu * R) / R\n        interaction_term_rsh = f_LR * erf(mu * R) / R\n        omega_rsh = omega_ia - interaction_term_rsh\n\n        # Calculate the exact long-range asymptotic energy\n        # Omega_exact = I - A - 1/R\n        interaction_term_exact = 1.0 / R\n        omega_exact = omega_ia - interaction_term_exact\n\n        # Calculate the difference Delta\n        # Delta = Omega_RSH - Omega_exact\n        delta = omega_rsh - omega_exact\n\n        # Round all results to six decimal places\n        rounded_omega_rsh = round(omega_rsh, 6)\n        rounded_omega_exact = round(omega_exact, 6)\n        rounded_delta = round(delta, 6)\n\n        results.append([rounded_omega_rsh, rounded_omega_exact, rounded_delta])\n\n    # Format the output string as a list of lists.\n    # e.g., \"[[result11,result12,result13],[result21,result22,result23],...]\"\n    output_str = \"[\" + \",\".join([f\"[{r[0]:.6f},{r[1]:.6f},{r[2]:.6f}]\" for r in results]) + \"]\"\n    \n    print(output_str)\n\nsolve()\n```", "id": "2932958"}]}