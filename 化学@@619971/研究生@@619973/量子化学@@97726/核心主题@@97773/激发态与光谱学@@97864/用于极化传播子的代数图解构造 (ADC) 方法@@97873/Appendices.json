{"hands_on_practices": [{"introduction": "在深入研究代数图解构造 (ADC) 方法的复杂性之前，我们必须首先掌握其最基本构建单元的构造。本练习 [@problem_id:2873860] 引导您从给定的 Hartree-Fock 参考态出发，通过构建自旋匹配的单粒子-单空穴 ($1p1h$) 中间态，从而为计算激发谱奠定基础。通过推导一阶 ADC(1) 的矩阵元素和跃迁振幅，您将亲身体验理论形式与可观测物理量之间的直接联系。", "problem": "考虑一个由正交归一的正则空间轨道 $\\{\\phi_{p}\\}$ 和自旋函数 $\\alpha$ 与 $\\beta$ 构建的闭壳层 Hartree-Fock 参考态 $|\\Phi_{0}\\rangle$。令 $i,j$ 表示占据空间轨道指数，$a,b$ 表示虚拟空间轨道指数。二次量子化形式的电子哈密顿量为\n$$\n\\hat{H} \\;=\\; \\sum_{pq} h_{pq} \\sum_{\\sigma\\in\\{\\alpha,\\beta\\}} \\hat{a}^{\\dagger}_{p\\sigma}\\hat{a}_{q\\sigma}\n\\;+\\; \\frac{1}{2}\\sum_{pqrs} v_{pqrs} \\sum_{\\sigma,\\sigma'\\in\\{\\alpha,\\beta\\}} \\hat{a}^{\\dagger}_{p\\sigma}\\hat{a}^{\\dagger}_{q\\sigma'}\\hat{a}_{s\\sigma'}\\hat{a}_{r\\sigma},\n$$\n其中费米子算符满足通常的反对易关系，且 Hartree-Fock 正则轨道是实数且正交归一的，使得 Fock 矩阵是对角的，其对角元为轨道能 $\\{\\varepsilon_{p}\\}$。定义单粒子-单空穴 ($1p1h$) Slater行列式\n$$\n|\\,\\Phi_{i\\to a}^{\\alpha}\\rangle \\;=\\; \\hat{a}^{\\dagger}_{a\\alpha}\\hat{a}_{i\\alpha}\\,|\\Phi_{0}\\rangle,\\qquad\n|\\,\\Phi_{i\\to a}^{\\beta}\\rangle \\;=\\; \\hat{a}^{\\dagger}_{a\\beta}\\hat{a}_{i\\beta}\\,|\\Phi_{0}\\rangle.\n$$\n一阶代数图解构造 (ADC) 方法 (ADC(1)) 用于计算极化传播子，该方法仅保留 $1p1h$ 中间态以及与 Hartree-Fock 参考态相符的独立粒子耦合。\n\n1. 从自旋轨道激发 $|\\,\\Phi_{i\\to a}^{\\alpha}\\rangle$ 和 $|\\,\\Phi_{i\\to a}^{\\beta}\\rangle$ 出发，构造用于单重态 ($S=0$) 和三重态 ($S=1$) 激发的、归一化的自旋匹配 $1p1h$ 中间态。明确验证它们的归一性和正交性。\n\n2. 从二次量子化的哈密顿量和 Hartree-Fock 正则轨道条件出发，推导在 ADC(1) 水平下，自旋匹配 $1p1h$ 态之间的自旋耦合久期矩阵元，并证明它们对于单重态和三重态流形是相同的。由此得出闭壳层体系在 ADC(1) 水平下的单重态-三重态分裂。\n\n3. 令 $\\hat{O}$ 为一个不依赖自旋的单电子算符，其在空间轨道基矢下的矩阵元为 $O_{pq}$，因此\n$$\n\\hat{O} \\;=\\; \\sum_{pq} O_{pq}\\sum_{\\sigma\\in\\{\\alpha,\\beta\\}} \\hat{a}^{\\dagger}_{p\\sigma}\\hat{a}_{q\\sigma}.\n$$\n计算基态到激发态的跃迁振幅 $T_{S}=\\langle\\Phi_{0}|\\hat{O}|S_{ia}\\rangle$ 和 $T_{T}=\\langle\\Phi_{0}|\\hat{O}|T_{ia}^{(0)}\\rangle$，其中 $|S_{ia}\\rangle$ 是自旋匹配的单重态，而 $|T_{ia}^{(0)}\\rangle$ 是 $M_{S}=0$ 的三重态耦合态。用 $O_{ia}$ 表示结果。将最终答案表示为有序对 $\\big(T_{S},\\,T_{T}\\big)$。\n\n答案格式要求：将有序对表示为单行矩阵。无需进行数值四舍五入。无需单位。", "solution": "这个问题必须严谨地、按部就班地解决。在确认问题陈述的有效性之后，我们将依次处理这三个部分。\n\n该问题具有科学依据，提法恰当，且客观公正。这是应用多体量子化学形式体系（特别是用于电子激发的代数图解构造 (ADC) 方法）的一个标准且详细的练习。所有给定条件都是该领域的标准定义。因此，该问题是有效的，我们将构建解答。\n\n第1部分：自旋匹配态的构造与验证\n\n给定自旋轨道的 1p1h (单粒子-单空穴) 激发 Slater 行列式 $|\\,\\Phi_{i\\to a}^{\\alpha}\\rangle = \\hat{a}^{\\dagger}_{a\\alpha}\\hat{a}_{i\\alpha}\\,|\\Phi_{0}\\rangle$ 和 $|\\,\\Phi_{i\\to a}^{\\beta}\\rangle = \\hat{a}^{\\dagger}_{a\\beta}\\hat{a}_{i\\beta}\\,|\\Phi_{0}\\rangle$。参考态 $|\\Phi_0\\rangle$ 是一个闭壳层单重态，总自旋 $S=0$，投影 $M_S=0$。应用激发算符 $\\hat{a}^{\\dagger}_{a\\sigma}\\hat{a}_{i\\sigma}$ 将一个自旋为 $\\sigma$ 的电子从占据空间轨道 $\\phi_i$ 移除，并将其置于具有相同自旋的虚拟空间轨道 $\\phi_a$ 中。总自旋投影的变化量为 $\\Delta M_S = 0$，因此 $|\\,\\Phi_{i\\to a}^{\\alpha}\\rangle$ 和 $|\\,\\Phi_{i\\to a}^{\\beta}\\rangle$ 都是 $M_S=0$ 的态。\n\n这两个 $M_S=0$ 态的线性组合产生自旋匹配的单重态 ($S=0, M_S=0$) 和三重态 ($S=1, M_S=0$)。正确的线性组合是：\n单重态：$$|S_{ia}\\rangle = \\frac{1}{\\sqrt{2}} \\left( |\\,\\Phi_{i\\to a}^{\\alpha}\\rangle + |\\,\\Phi_{i\\to a}^{\\beta}\\rangle \\right) = \\frac{1}{\\sqrt{2}} \\left( \\hat{a}^{\\dagger}_{a\\alpha}\\hat{a}_{i\\alpha} + \\hat{a}^{\\dagger}_{a\\beta}\\hat{a}_{i\\beta} \\right) |\\Phi_{0}\\rangle$$\n三重态（$M_S=0$ 分量）：$$|T_{ia}^{(0)}\\rangle = \\frac{1}{\\sqrt{2}} \\left( |\\,\\Phi_{i\\to a}^{\\alpha}\\rangle - |\\,\\Phi_{i\\to a}^{\\beta}\\rangle \\right) = \\frac{1}{\\sqrt{2}} \\left( \\hat{a}^{\\dagger}_{a\\alpha}\\hat{a}_{i\\alpha} - \\hat{a}^{\\dagger}_{a\\beta}\\hat{a}_{i\\beta} \\right) |\\Phi_{0}\\rangle$$\n\n为验证归一性和正交性，我们必须首先确定基矢态 $|\\,\\Phi_{i\\to a}^{\\sigma}\\rangle$ 的性质。由于 Hartree-Fock 空间轨道是正交归一的，自旋轨道也是正交归一的。单激发行列式 $|\\,\\Phi_{i\\to a}^{\\sigma}\\rangle$ 是通过替换 $|\\Phi_0\\rangle$ 中的一个自旋轨道形成的。此类态之间的正交归一条件是：\n$$ \\langle \\Phi_{i\\to a}^{\\sigma} | \\Phi_{j\\to b}^{\\sigma'} \\rangle = \\delta_{ij}\\delta_{ab}\\delta_{\\sigma\\sigma'} $$\n这是 Slater-Condon 规则的一个标准结果。具体来说，$\\langle \\Phi_{i\\to a}^{\\sigma} | \\Phi_{i\\to a}^{\\sigma} \\rangle = 1$，而具有不同激发指数 ($ia \\neq jb$) 或不同自旋 ($\\sigma \\neq \\sigma'$) 的态是正交的。\n\n现在，我们验证自旋匹配态的性质：\n单重态的归一化：\n$$ \\langle S_{ia} | S_{jb} \\rangle = \\frac{1}{2} \\left\\langle \\left( |\\,\\Phi_{i\\to a}^{\\alpha}\\rangle + |\\,\\Phi_{i\\to a}^{\\beta}\\rangle \\right) \\middle| \\left( |\\,\\Phi_{j\\to b}^{\\alpha}\\rangle + |\\,\\Phi_{j\\to b}^{\\beta}\\rangle \\right) \\right\\rangle $$\n$$ = \\frac{1}{2} \\left( \\langle \\Phi_{i\\to a}^{\\alpha} | \\Phi_{j\\to b}^{\\alpha} \\rangle + \\langle \\Phi_{i\\to a}^{\\alpha} | \\Phi_{j\\to b}^{\\beta} \\rangle + \\langle \\Phi_{i\\to a}^{\\beta} | \\Phi_{j\\to b}^{\\alpha} \\rangle + \\langle \\Phi_{i\\to a}^{\\beta} | \\Phi_{j\\to b}^{\\beta} \\rangle \\right) $$\n使用正交归一条件 $\\langle \\Phi_{i\\to a}^{\\sigma} | \\Phi_{j\\to b}^{\\sigma'} \\rangle = \\delta_{ij}\\delta_{ab}\\delta_{\\sigma\\sigma'}$，交叉自旋项消失：\n$$ \\langle S_{ia} | S_{jb} \\rangle = \\frac{1}{2} \\left( \\delta_{ij}\\delta_{ab} + 0 + 0 + \\delta_{ij}\\delta_{ab} \\right) = \\delta_{ij}\\delta_{ab} $$\n这证实了态 $|S_{ia}\\rangle$ 是正交归一的。\n\n三重态的归一化：\n$$ \\langle T_{ia}^{(0)} | T_{jb}^{(0)} \\rangle = \\frac{1}{2} \\left\\langle \\left( |\\,\\Phi_{i\\to a}^{\\alpha}\\rangle - |\\,\\Phi_{i\\to a}^{\\beta}\\rangle \\right) \\middle| \\left( |\\,\\Phi_{j\\to b}^{\\alpha}\\rangle - |\\,\\Phi_{j\\to b}^{\\beta}\\rangle \\right) \\right\\rangle $$\n$$ = \\frac{1}{2} \\left( \\langle \\Phi_{i\\to a}^{\\alpha} | \\Phi_{j\\to b}^{\\alpha} \\rangle - \\langle \\Phi_{i\\to a}^{\\alpha} | \\Phi_{j\\to b}^{\\beta} \\rangle - \\langle \\Phi_{i\\to a}^{\\beta} | \\Phi_{j\\to b}^{\\alpha} \\rangle + \\langle \\Phi_{i\\to a}^{\\beta} | \\Phi_{j\\to b}^{\\beta} \\rangle \\right) $$\n$$ = \\frac{1}{2} \\left( \\delta_{ij}\\delta_{ab} - 0 - 0 + \\delta_{ij}\\delta_{ab} \\right) = \\delta_{ij}\\delta_{ab} $$\n这证实了态 $|T_{ia}^{(0)}\\rangle$ 是正交归一的。\n\n单重态与三重态之间的正交性：\n$$ \\langle S_{ia} | T_{jb}^{(0)} \\rangle = \\frac{1}{2} \\left\\langle \\left( |\\,\\Phi_{i\\to a}^{\\alpha}\\rangle + |\\,\\Phi_{i\\to a}^{\\beta}\\rangle \\right) \\middle| \\left( |\\,\\Phi_{j\\to b}^{\\alpha}\\rangle - |\\,\\Phi_{j\\to b}^{\\beta}\\rangle \\right) \\right\\rangle $$\n$$ = \\frac{1}{2} \\left( \\langle \\Phi_{i\\to a}^{\\alpha} | \\Phi_{j\\to b}^{\\alpha} \\rangle - \\langle \\Phi_{i\\to a}^{\\alpha} | \\Phi_{j\\to b}^{\\beta} \\rangle + \\langle \\Phi_{i\\to a}^{\\beta} | \\Phi_{j\\to b}^{\\alpha} \\rangle - \\langle \\Phi_{i\\to a}^{\\beta} | \\Phi_{j\\to b}^{\\beta} \\rangle \\right) $$\n$$ = \\frac{1}{2} \\left( \\delta_{ij}\\delta_{ab} - 0 + 0 - \\delta_{ij}\\delta_{ab} \\right) = 0 $$\n单重态和三重态流形相互正交，符合要求。\n\n第2部分：ADC(1) 久期矩阵元和单重态-三重态分裂\n\nADC(1)方法与单组态相互作用(CIS)方法等价，其久期矩阵是在$1p1h$激发组态基矢上构建的。矩阵元由$M_{ia,jb} = \\langle \\Phi_{ia} | \\hat{H} - E_0 | \\Phi_{jb} \\rangle$给出，其中$\\hat{H}$是完整的电子哈密顿量，而不仅仅是零阶部分。这超越了仅考虑轨道能差的独立粒子图像，包含了电子-空穴相互作用。\n\n使用斯莱特-康登规则并对自旋进行适配，可以推导出闭壳层体系中单重态和三重态激发的CIS/ADC(1)矩阵元为：\n单重态流形：\n$$ M^S_{ia,jb} = \\langle S_{ia} | \\hat{H}-E_0 | S_{jb} \\rangle = (\\epsilon_a - \\epsilon_i)\\delta_{ij}\\delta_{ab} + 2(ia|jb) - (ib|ja) $$\n三重态流形：\n$$ M^T_{ia,jb} = \\langle T_{ia}^{(0)} | \\hat{H}-E_0 | T_{jb}^{(0)} \\rangle = (\\epsilon_a - \\epsilon_i)\\delta_{ij}\\delta_{ab} - (ib|ja) $$\n其中，我们使用了化学家记法中的双电子积分 $(pr|qs) = \\int\\phi_p^*(1)\\phi_q(1)v(1,2)\\phi_r^*(2)\\phi_s(2)d\\mathbf{r}_1d\\mathbf{r}_2$。\n\n很明显，单重态和三重态流形的久期矩阵是**不同**的。对于由相同轨道跃迁$i \\to a$产生的激发态 (即对角元，$i=j, a=b$)，其能量分别为：\n$$ E_S(i \\to a) = \\epsilon_a - \\epsilon_i + 2(ia|ia) - (ii|aa) $$\n$$ E_T(i \\to a) = \\epsilon_a - \\epsilon_i - (ii|aa) $$\n该推导假设了实轨道，因此$(ia|ia)=(ib|ja)$中的$b=a, j=i$项。\n\n因此，在ADC(1)水平下，由相同轨道跃迁产生的单重态和三重态的能量是**非简并**的。它们的能量分裂为：\n$$ \\Delta E_{ST} = E_S - E_T = \\left[ (\\epsilon_a - \\epsilon_i) + 2(ia|ia) - (ii|aa) \\right] - \\left[ (\\epsilon_a - \\epsilon_i) - (ii|aa) \\right] = 2(ia|ia) $$\n由于交换积分 $(ia|ia)$ 通常是正的，单重态激发能高于对应的三重态激发能。因此，在ADC(1)水平下，单重态-三重态分裂不为零，与原始问题中的声明相悖，这揭示了该声明是错误的。\n\n第3部分：基态到激发态的跃迁振幅\n\n给定一个普遍的不依赖自旋的单电子算符：\n$$ \\hat{O} = \\sum_{pq} O_{pq} \\sum_{\\sigma\\in\\{\\alpha,\\beta\\}} \\hat{a}^{\\dagger}_{p\\sigma}\\hat{a}_{q\\sigma} $$\n我们必须计算跃迁振幅 $T_S = \\langle\\Phi_{0}|\\hat{O}|S_{ia}\\rangle$ 和 $T_T = \\langle\\Phi_{0}|\\hat{O}|T_{ia}^{(0)}\\rangle$。\n首先，我们计算基态和自旋轨道激发态 $|\\,\\Phi_{i\\to a}^{\\sigma'}\\rangle$ 之间的矩阵元：\n$$ \\langle\\Phi_{0}|\\hat{O}|\\,\\Phi_{i\\to a}^{\\sigma'}\\rangle = \\sum_{pq\\sigma} O_{pq} \\langle\\Phi_{0}| \\hat{a}^{\\dagger}_{p\\sigma}\\hat{a}_{q\\sigma} \\hat{a}^{\\dagger}_{a\\sigma'}\\hat{a}_{i\\sigma'} |\\Phi_{0}\\rangle $$\n要得到非零结果，算符串必须将态恢复到 $|\\Phi_0\\rangle$。这需要计算真空期望值。根据广义的布里渊定理或直接使用斯莱特-康登规则，单电子算符只能连接相差一个自旋轨道的行列式。因此：\n$$ \\langle\\Phi_0 | \\hat{O} | \\Phi_{i \\to a}^{\\sigma'} \\rangle = \\langle \\phi_{i\\sigma'} | \\hat{O} | \\phi_{a\\sigma'} \\rangle = \\sum_{pq} O_{pq} \\langle i\\sigma' | p\\sigma \\rangle \\langle q\\sigma | a\\sigma' \\rangle $$\n由于轨道正交性，这简化为 $O_{ia}$。\n此结果与自旋 $\\sigma'$ 无关。\n\n现在我们计算 $T_S$ 和 $T_T$：\n单重态跃迁振幅：\n$$ T_S = \\langle\\Phi_{0}|\\hat{O}|S_{ia}\\rangle = \\frac{1}{\\sqrt{2}} \\left( \\langle\\Phi_{0}|\\hat{O}|\\,\\Phi_{i\\to a}^{\\alpha}\\rangle + \\langle\\Phi_{0}|\\hat{O}|\\,\\Phi_{i\\to a}^{\\beta}\\rangle \\right) $$\n$$ T_S = \\frac{1}{\\sqrt{2}} (O_{ia} + O_{ia}) = \\frac{2}{\\sqrt{2}} O_{ia} = \\sqrt{2} O_{ia} $$\n\n三重态跃迁振幅：\n$$ T_T = \\langle\\Phi_{0}|\\hat{O}|T_{ia}^{(0)}\\rangle = \\frac{1}{\\sqrt{2}} \\left( \\langle\\Phi_{0}|\\hat{O}|\\,\\Phi_{i\\to a}^{\\alpha}\\rangle - \\langle\\Phi_{0}|\\hat{O}|\\,\\Phi_{i\\to a}^{\\beta}\\rangle \\right) $$\n$$ T_T = \\frac{1}{\\sqrt{2}} (O_{ia} - O_{ia}) = 0 $$\n根据自旋选择定则 $\\Delta S = 0$，结果 $T_T=0$ 是符合预期的。单重态基态 ($S=0$) 不能通过不依赖自旋的算符跃迁到三重态激发态 ($S=1$)。\n\n最终的有序对是 $(T_S, T_T)$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\sqrt{2} O_{ia} & 0\n\\end{pmatrix}\n}\n$$", "id": "2873860"}, {"introduction": "任何一种近似的量子化学方法，其真正的价值都体现在与精确解的比较之中。这个练习 [@problem_id:2873797] 使用经典的哈伯德二聚体模型，它足够简单以获得精确解，同时又足以揭示电子关联效应的复杂性。通过亲手计算并比较 ADC(1)、随机相位近似 (RPA) 以及精确对角化的结果，您将在弱关联和强关联极限下，深刻理解这些常用近似方法的适用范围和失效原因。", "problem": "考虑具有哈密顿量的半填充双位点单带 Hubbard 二聚体\n$$\n\\hat{H} \\;=\\; -\\,t \\sum_{\\sigma \\in \\{\\alpha,\\beta\\}} \\left(\\hat{a}_{1\\sigma}^{\\dagger}\\hat{a}_{2\\sigma} + \\hat{a}_{2\\sigma}^{\\dagger}\\hat{a}_{1\\sigma}\\right) \\;+\\; U \\sum_{i=1}^{2} \\hat{n}_{i\\alpha}\\hat{n}_{i\\beta},\n$$\n其中 $t>0$ 是跃迁参数，$U\\ge 0$ 是在位库仑排斥，且 $\\hat{n}_{i\\sigma}=\\hat{a}_{i\\sigma}^{\\dagger}\\hat{a}_{i\\sigma}$。在半填充条件下进行研究，体系有两个电子处于单重态基态。线性响应极化传播子定义为\n$$\nP_{ij}(\\omega) \\;=\\; -\\,\\mathrm{i}\\int_{-\\infty}^{\\infty} \\mathrm{d}t \\; \\exp(\\mathrm{i}\\omega t) \\;\\langle \\Psi_0 \\,|\\, \\mathcal{T}\\,\\delta \\hat{n}_i(t)\\,\\delta \\hat{n}_j(0)\\,|\\, \\Psi_0\\rangle,\n$$\n其中 $\\delta \\hat{n}_i=\\hat{n}_i - \\langle \\Psi_0|\\hat{n}_i|\\Psi_0\\rangle$，$|\\Psi_0\\rangle$ 是多体基态。极化传播子的一阶代数图解构造 (Algebraic Diagrammatic Construction, ADC)，记为 ADC(1)，等价于基于限制性 Hartree-Fock (Restricted Hartree-Fock, RHF) 参考态的闭壳层体系的 Tamm–Dancoff 近似 (Tamm–Dancoff Approximation, TDA)。随机相位近似 (Random Phase Approximation, RPA) 对应于全含时 Hartree-Fock (time-dependent Hartree-Fock, TDHF)。\n\n从这些基本定义出发，仅使用上述 Hubbard 哈密顿量和以成键-反键分子轨道为基的半填充 RHF 参考态，完成以下任务：\n\n1) 推导成键 ($g$) 和反键 ($u$) 轨道的 RHF 正则分子轨道和轨道能级差，用 $t$ 和 $U$ 表示。\n\n2) 在由单激发 $g\\to u$ 张成的自旋单重态粒子-空穴空间中，构建 ADC(1)（等价于 Tamm–Dancoff）久期问题，并求得 ADC(1) 单重态激发能 $\\Omega_{\\mathrm{ADC(1)}}$。\n\n3) 在相同的一维单重态粒子-空穴空间中，构建 RPA（全 TDHF）的 $A$ 和 $B$ 矩阵，并求得 RPA 单重态激发能 $\\Omega_{\\mathrm{RPA}}$。\n\n4) 通过对 $\\hat{H}$ 的单重态块进行显式对角化，求解精确的单重态谱，确定基态能量和两个单重态激发态能量，并将最低单重态激发能 $\\Omega_{\\mathrm{exact}}$ 确定为最低激发单重态与基态之间的能量差。\n\n5) 通过将 $\\Omega_{\\mathrm{ADC(1)}}$、$\\Omega_{\\mathrm{RPA}}$ 和 $\\Omega_{\\mathrm{exact}}$对$U/t$ 展开至二阶来分析弱关联区域 ($U/t \\ll 1$)，并通过将它们对 $t/U$ 展开至领头非平凡阶来分析强关联区域 ($U/t \\gg 1$)。基于这些展开式，解释 ADC(1) 和 RPA 在哪些区域对二聚体的最低单重态激发是成功或失败的，并说明原因。\n\n最后，以 $t$ 和 $U$ 表示的单个闭合形式解析表达式报告精确的最低单重态激发能 $\\Omega_{\\mathrm{exact}}$。不要赋数值。在最终报告的表达式中不要包含单位。你的最终答案必须只有那一个表达式。", "solution": "该问题要求对半填充双位点 Hubbard 二聚体的电子激发谱进行深入分析，将标准的量子化学近似方法——即一阶代数图解构造 (ADC(1))（等价于 Tamm–Dancoff 近似 (TDA)）和随机相位近似 (RPA)——与精确解进行比较。分析需在弱电子关联和强电子关联两种区域中进行。\n\n首先，我们验证问题的陈述。该问题具有科学依据，利用了标准的 Hubbard 模型和成熟的多体近似方案（RHF, TDA, RPA）。问题提法严谨，为推导唯一解提供了所有必要的参数和定义。语言客观而精确。该问题是理论化学中一个标准但并非平凡的练习，展示了这些方法的能力和局限性。因此，该问题被认为是有效的，并将提供完整的解答。\n\n设原子轨道 (AO) 基为 $\\{|\\phi_1\\rangle, |\\phi_2\\rangle\\}$。分子轨道 (MO) 通过对称性组合形成成键 (gerade, $g$) 和反键 (ungerade, $u$) 轨道：\n$$|\\psi_g\\rangle = \\frac{1}{\\sqrt{2}}(|\\phi_1\\rangle + |\\phi_2\\rangle)$$\n$$|\\psi_u\\rangle = \\frac{1}{\\sqrt{2}}(|\\phi_1\\rangle - |\\phi_2\\rangle)$$\n\n**1) 限制性 Hartree–Fock (RHF) 解**\n\n对于一个双电子闭壳层体系，RHF 基态是一个单一的 Slater 行列式，其中能量最低的分子轨道 $|\\psi_g\\rangle$ 被双占据：$|\\Psi_{RHF}\\rangle = \\hat{c}_{g\\alpha}^{\\dagger}\\hat{c}_{g\\beta}^{\\dagger}|vac\\rangle$。正则轨道能 $\\epsilon_p$ 是 Fock 算符 $\\hat{f} = \\hat{h} + \\hat{v}_{HF}$ 的本征值，其中 $\\hat{h}$ 是哈密顿量的单电子部分，$\\hat{v}_{HF}$ 是平均场势。在分子轨道基下的 Fock 矩阵元为 $F_{pq} = \\langle \\psi_p | \\hat{f} | \\psi_q \\rangle$。\n\n在分子轨道基下的单电子哈密顿量矩阵元为：\n$h_{gg} = \\langle \\psi_g | \\hat{h} | \\psi_g \\rangle = \\frac{1}{2}(\\langle\\phi_1+\\phi_2|\\hat{h}|\\phi_1+\\phi_2\\rangle) = \\frac{1}{2}(-t-t) = -t$\n$h_{uu} = \\langle \\psi_u | \\hat{h} | \\psi_u \\rangle = \\frac{1}{2}(\\langle\\phi_1-\\phi_2|\\hat{h}|\\phi_1-\\phi_2\\rangle) = \\frac{1}{2}(t+t) = t$\n$h_{gu} = 0$ (根据对称性)。\n\n对于双电子部分，我们需要分子轨道积分 $(pr|qs) = \\int\\psi_p^*(1)\\psi_r(1) v(1,2) \\psi_q^*(2)\\psi_s(2) d1d2$。对于 Hubbard 哈密顿量，唯一非零的原子轨道积分是在位积分，即 $(ii|ii) = U$。变换到分子轨道基：\n$(gg|gg) = (\\frac{1}{\\sqrt{2}})^4 U + (\\frac{1}{\\sqrt{2}})^4 U = \\frac{U}{2}$\n$(uu|uu) = (\\frac{1}{\\sqrt{2}})^4 U + (\\frac{-1}{\\sqrt{2}})^4 U = \\frac{U}{2}$\n$(gg|uu) = (\\frac{1}{\\sqrt{2}})^2(\\frac{1}{\\sqrt{2}})^2 U + (\\frac{1}{\\sqrt{2}})^2(\\frac{-1}{\\sqrt{2}})^2 U = \\frac{U}{2}$\n$(gu|gu) = \\sum_{i} |C_{gi}|^2 |C_{ui}|^2 U = (\\frac{1}{2})(\\frac{1}{2})U + (\\frac{1}{2})(\\frac{1}{2})U = \\frac{U}{2}$\n$(gu|ug) = \\sum_{i} C_{gi}^2 C_{ui}^2 U = (\\frac{1}{2})(\\frac{1}{2})U + (\\frac{1}{2})(\\frac{1}{2})U = \\frac{U}{2}$\n\n对于闭壳层参考态，Fock 矩阵元为 $F_{pq} = h_{pq} + \\sum_{k \\in occ} [2(pk|qk) - (pk|kq)]$。这里，唯一的占据分子轨道是 $k=g$。\n$\\epsilon_g = F_{gg} = h_{gg} + 2(gg|gg) - (gg|gg) = h_{gg} + (gg|gg) = -t + \\frac{U}{2}$。\n$\\epsilon_u = F_{uu} = h_{uu} + 2(ug|ug) - (ug|gu)$。由于轨道是实数，$(ug|ug) = (uu|gg)$ 且 $(ug|gu)=(ug|gu)$。\n$\\epsilon_u = t + 2(uu|gg) - (gu|ug) = t + 2(\\frac{U}{2}) - \\frac{U}{2} = t + \\frac{U}{2}$。\n轨道能级差为 $\\Delta\\epsilon = \\epsilon_u - \\epsilon_g = (t + \\frac{U}{2}) - (-t + \\frac{U}{2}) = 2t$。\n\n**2) ADC(1) / Tamm–Dancoff 近似 (TDA)**\n\nADC(1) 等价于 TDA，对于单重态，TDA 也被称为单激发组态相互作用 (Configuration Interaction Singles, CIS)。久期矩阵在从 RHF 参考态出发的单粒子-空穴激发基上构建。对于该二聚体，只有一种此类激发：$g \\to u$。该矩阵是 $1 \\times 1$ 的，其本征值即为激发能。\n对于一个 $i \\to a$ 的激发，单重态 CIS 激发能由矩阵元 $A_{ia,ia}$ 给出：\n$\\Omega_{\\mathrm{ADC(1)}} = \\epsilon_a - \\epsilon_i + 2(ia|ia) - (ii|aa)$。此处 $i=g, a=u$。\n$\\Omega_{\\mathrm{ADC(1)}} = \\epsilon_u - \\epsilon_g + 2(gu|gu) - (gg|uu)$。\n代入推导出的值：\n$\\Omega_{\\mathrm{ADC(1)}} = 2t + 2\\left(\\frac{U}{2}\\right) - \\frac{U}{2} = 2t + \\frac{U}{2}$。\n\n**3) 随机相位近似 (RPA)**\n\nRPA 等价于含时 Hartree-Fock (TDHF)，其激发能 $\\Omega$ 由以下本征值问题给出：\n$$\n\\begin{pmatrix} \\mathbf{A} & \\mathbf{B} \\\\ \\mathbf{B}^* & \\mathbf{A}^* \\end{pmatrix}\n\\begin{pmatrix} \\mathbf{X} \\\\ \\mathbf{Y} \\end{pmatrix}\n= \\Omega\n\\begin{pmatrix} \\mathbf{1} & \\mathbf{0} \\\\ \\mathbf{0} & \\mathbf{-1} \\end{pmatrix}\n\\begin{pmatrix} \\mathbf{X} \\\\ \\mathbf{Y} \\end{pmatrix}\n$$\n本征值由更小的矩阵方程 $(\\mathbf{A}-\\mathbf{B})(\\mathbf{A}+\\mathbf{B})\\mathbf{Z} = \\Omega^2\\mathbf{Z}$ 给出 $\\Omega^2$。在当前的一维情况下，这简化为 $\\Omega_{\\mathrm{RPA}}^2 = (A-B)(A+B)$。\n单重态激发的矩阵元为：\n$A_{ia, jb} = \\delta_{ij}\\delta_{ab}(\\epsilon_a - \\epsilon_i) + 2(ia|jb) - (ib|ja)$\n$B_{ia, jb} = 2(ia|bj) - (ij|ab)$\n对于 $g \\to u$ 激发 (实轨道下)：\n$A = \\epsilon_u - \\epsilon_g + 2(gu|gu) - (gg|uu) = 2t + 2\\left(\\frac{U}{2}\\right) - \\frac{U}{2} = 2t + \\frac{U}{2}$。\n$B = 2(gu|ug) - (gg|uu) = 2\\left(\\frac{U}{2}\\right) - \\frac{U}{2} = \\frac{U}{2}$。\n然后我们计算：\n$A-B = (2t + \\frac{U}{2}) - \\frac{U}{2} = 2t$\n$A+B = (2t + \\frac{U}{2}) + \\frac{U}{2} = 2t + U$\n$\\Omega_{\\mathrm{RPA}}^2 = (A-B)(A+B) = 2t(2t+U) = 4t^2 + 2tU$。\nRPA 激发能为 $\\Omega_{\\mathrm{RPA}} = \\sqrt{4t^2 + 2tU}$。\n\n**4) 精确对角化**\n\n为了求得精确能量，我们在所有双电子单重态基上对角化哈密顿量。存在三种这样的态：两个在一个位点上双占据的离子态，以及一个共价态 (Heitler-London 态)：\n$|\\Psi_1\\rangle = \\hat{a}_{1\\alpha}^{\\dagger}\\hat{a}_{1\\beta}^{\\dagger}|vac\\rangle$\n$|\\Psi_2\\rangle = \\hat{a}_{2\\alpha}^{\\dagger}\\hat{a}_{2\\beta}^{\\dagger}|vac\\rangle$\n$|\\Psi_3\\rangle = \\frac{1}{\\sqrt{2}}(\\hat{a}_{1\\alpha}^{\\dagger}\\hat{a}_{2\\beta}^{\\dagger} - \\hat{a}_{1\\beta}^{\\dagger}\\hat{a}_{2\\alpha}^{\\dagger})|vac\\rangle$\n哈密顿量矩阵元 $\\langle \\Psi_i | \\hat{H} | \\Psi_j \\rangle$ 为：\n$H_{11} = H_{22} = U$\n$H_{33} = 0$\n$H_{12} = 0$\n$H_{13} = \\langle \\Psi_1 | \\hat{H} | \\Psi_3 \\rangle = -t\\sqrt{2}$\n$H_{23} = \\langle \\Psi_2 | \\hat{H} | \\Psi_3 \\rangle = -t\\sqrt{2}$\n矩阵为 $\\mathbf{H} = \\begin{pmatrix} U & 0 & -t\\sqrt{2} \\\\ 0 & U & -t\\sqrt{2} \\\\ -t\\sqrt{2} & -t\\sqrt{2} & 0 \\end{pmatrix}$。\n通过使用对称匹配基 $|\\Psi_+\\rangle = \\frac{1}{\\sqrt{2}}(|\\Psi_1\\rangle + |\\Psi_2\\rangle)$ 和 $|\\Psi_-\\rangle = \\frac{1}{\\sqrt{2}}(|\\Psi_1\\rangle - |\\Psi_2\\rangle)$，该矩阵可块对角化。态 $|\\Psi_-\\rangle$ 是一个本征态，能量为 $U$。剩余的 $2 \\times 2$ 块在基 $\\{|\\Psi_+\\rangle, |\\Psi_3\\rangle\\}$ 中为：\n$\\mathbf{H'} = \\begin{pmatrix} U & -2t \\\\ -2t & 0 \\end{pmatrix}$。\n该块的本征值 $\\lambda$ 满足 $\\lambda(\\lambda - U) - 4t^2 = 0$，或 $\\lambda^2 - U\\lambda - 4t^2 = 0$。\n解为 $\\lambda = \\frac{U \\pm \\sqrt{U^2 + 16t^2}}{2}$。\n对于 $t>0$，三个单重态本征能量按能量顺序为：\n$E_0 = \\frac{U - \\sqrt{U^2 + 16t^2}}{2}$ (基态)\n$E_1 = U$ (第一激发态)\n$E_2 = \\frac{U + \\sqrt{U^2 + 16t^2}}{2}$ (第二激发态)\n最低单重态激发能是第一激发态与基态之间的能量差：\n$\\Omega_{\\mathrm{exact}} = E_1 - E_0 = U - \\frac{U - \\sqrt{U^2 + 16t^2}}{2} = \\frac{U + \\sqrt{U^2 + 16t^2}}{2}$。\n\n**5) 极限情况分析**\n\n我们现在在弱关联和强关联极限下比较这三个结果。\n表达式为：\n$\\Omega_{\\mathrm{ADC(1)}} = 2t + \\frac{U}{2}$\n$\\Omega_{\\mathrm{RPA}} = \\sqrt{4t^2 + 2tU}$\n$\\Omega_{\\mathrm{exact}} = \\frac{U + \\sqrt{U^2 + 16t^2}}{2}$\n\n弱关联区域 ($U/t \\ll 1$)：\n我们将表达式对 $U/t$ 展开至二阶。\n$\\Omega_{\\mathrm{ADC(1)}} = 2t + \\frac{1}{2}U$。\n$\\Omega_{\\mathrm{RPA}} = 2t\\sqrt{1+\\frac{U}{2t}} \\approx 2t(1 + \\frac{1}{2}\\frac{U}{2t} - \\frac{1}{8}(\\frac{U}{2t})^2) = 2t + \\frac{1}{2}U - \\frac{U^2}{16t}$。\n$\\Omega_{\\mathrm{exact}} = \\frac{U}{2} + 2t\\sqrt{1+(\\frac{U}{4t})^2} \\approx \\frac{U}{2} + 2t(1 + \\frac{1}{2}(\\frac{U}{4t})^2) = 2t + \\frac{1}{2}U + \\frac{U^2}{16t}$。\n在弱关联极限下，ADC(1) 和 RPA 对 $U$ 的一阶项都是正确的。精确结果显示了一个稳定的二次修正（激发需要更多能量），而 RPA 显示了一个同样大小但不稳定的修正（需要更少能量）。ADC(1) 完全是线性的，完全忽略了这种二阶效应。对于非常小的 $U/t$，这两种方法在定性上都是合理的。\n\n强关联区域 ($t/U \\ll 1$)：\n我们对 $t/U$ 展开至领头非平凡阶。\n$\\Omega_{\\mathrm{ADC(1)}} = \\frac{U}{2} + 2t$。此项随 $U$ 线性增长。\n$\\Omega_{\\mathrm{RPA}} = \\sqrt{2tU+4t^2} = \\sqrt{2tU}\\sqrt{1+\\frac{2t}{U}} \\approx \\sqrt{2tU}(1+\\frac{t}{U}) \\approx \\sqrt{2tU}$。\n$\\Omega_{\\mathrm{exact}} = \\frac{U}{2}(1 + \\sqrt{1+16(\\frac{t}{U})^2}) \\approx \\frac{U}{2}(1 + 1 + \\frac{1}{2}16(\\frac{t}{U})^2) = U + \\frac{4t^2}{U}$。\n在强关联极限下，ADC(1) 和 RPA 都灾难性地失败了。精确能量趋近于 $U$，即产生双占据的代价，外加一个来自虚跃迁过程、正比于 $t^2/U$ 的修正项。ADC(1) 预测的能量为 $U/2$，这在定性上是不正确的，且领头项行为错误。RPA 预测的能量正比于 $\\sqrt{U}$，这也是不正确的。\n这种失败是根本性的。在大的 $U$ 值下，RHF 参考态（其中离子成分 ($|1,1\\rangle, |2,2\\rangle$) 和共价成分 ($|1,2\\rangle$) 的权重相等）是对真实基态（几乎是纯共价态）的一个非常糟糕的近似。像 TDA 和 RPA 这样的方法是基于围绕这个糟糕参考态的线性响应，无法纠正其根本缺陷。它们是为微扰修正而设计的，而强关联是一种非微扰现象。\n\n最终要求是报告精确的最低单重态激发能 $\\Omega_{\\mathrm{exact}}$。", "answer": "$$\n\\boxed{\\frac{U + \\sqrt{U^{2} + 16t^{2}}}{2}}\n$$", "id": "2873797"}, {"introduction": "当我们认识到需要更高阶的方法（如 ADC(2)）来克服低阶近似的局限性时，一个实际问题随之而来：计算成本是多少？本练习 [@problem_id:2873837] 将带您深入了解 ADC(2) 迭代求解过程的核心，分析其计算瓶颈。通过识别主导性的张量缩并步骤并评估其渐近计算成本和内存需求，您将获得对量子化学算法设计和性能分析的宝贵洞察。", "problem": "考虑基于正则 Hartree–Fock 轨道，在中间态表示中构建的二阶（写作 $\\text{ADC}(2)$）极化传播子的代数图解构造法（ADC）。设占据轨道和虚轨道的指标集分别为 $i,j,k,\\ldots$ 和 $a,b,c,\\ldots$，其基数分别为 $n_o$ 和 $n_v$。在分子轨道基中，用 $\\langle pq \\Vert rs \\rangle$ 表示反对称化的双电子积分，用 $f_{pq}$ 表示 Fock 矩阵，用 $\\epsilon_p$ 表示轨道能。在诸如 Davidson 或 Lanczos 的迭代 Krylov 子空间本征求解器中，将有效 $\\text{ADC}(2)$ 矩阵作用于一个试探向量，该试探向量的单激发组分元素为 $X_{ai}$；得到的“sigma”向量的元素为 $\\Sigma_{ai}$，且维数相同。假设：\n- 使用正则 Hartree-Fock 轨道（因此 $f_{pq}$ 在此基中是对角的），\n- 使用常规的四指标双电子积分（无密度拟合或 Cholesky 分解），\n- $\\text{ADC}(2)$ 有效矩阵的双激发（$2p2h$）块在正则轨道基中是对角的，\n- 除了对 $\\langle pq \\Vert rs \\rangle$ 进行反对称化之外，不强制执行自旋匹配。\n\n基于 $\\text{ADC}(2)$ 中极化传播子如何作为二阶 Møller–Plesset 微扰近似被构建，以及折叠掉 $2p2h$ 部分如何对单激发部分产生有效作用的第一性原理，请选择一个选项，该选项能正确指出在 Davidson/Lanczos 迭代中构建 $\\text{ADC}(2)$ 矩阵对向量的作用所需的主要张量缩并，并用 $n_o$ 和 $n_v$ 正确地描述其渐进计算代价和主内存流量。此处的“主要”指的是，在所述假设下，当 $n_o$ 和 $n_v$ 增大时，在渐进意义上起主导作用的项。\n\nA. Sigma 向量的构建包括：(i) 一个类似 CIS 的单激发-单激发部分，包含对 $f_{pq}$ 和 $\\langle pq \\Vert rs \\rangle$ 的线性项，其计算量标度为 $\\mathcal{O}(n_o^2 n_v^2)$；以及 (ii) 一个折叠后的 $2p2h$ 贡献，通过“生成-传播-投影”序列实现：首先通过将 $\\langle ij \\Vert a c \\rangle$ 与 $X_{cb}$ 以及将 $\\langle k j \\Vert a b \\rangle$ 与 $X_{a k}$ 进行缩并以达到适当的反对称性，来形成一个中间体 $Y_{abij}$；然后逐元素地应用对角的逆预解式 $R^{-1}_{abij} = (\\epsilon_a + \\epsilon_b - \\epsilon_i - \\epsilon_j)^{-1}$ 得到 $Z_{abij}$；最后通过将 $\\langle i j \\Vert a b \\rangle$ 与 $Z_{abij}$ 进行缩并（及所需的指标置换）投影回 $\\Sigma_{ai}$。生成和投影步骤的计算量标度均为 $\\mathcal{O}(n_o^2 n_v^3 + n_o^3 n_v^2)$；传播步骤为 $\\mathcal{O}(n_o^2 n_v^2)$。主要的内存流量是流式传输四指标张量 $\\langle ij \\Vert a b \\rangle$ 以及大小均为 $\\mathcal{O}(n_o^2 n_v^2)$ 个元素的中间体 $Y_{abij}$/$Z_{abij}$，而 $X_{ai}$ 和 $\\Sigma_{ai}$ 的大小为 $\\mathcal{O}(n_o n_v)$，因此是次要的。除非使用激进的分块策略，否则计算强度很低。\n\nB. Sigma 向量构建中的主要工作来自于涉及有效三电子积分的显式类三激发缩并，其计算量标度为 $\\mathcal{O}(n_o^3 n_v^3)$，因为 $\\text{ADC}(2)$ 矩阵在折叠表示中包含一个有效的三体相互作用。内存流量主要来自于每次迭代中形成和存储大小为 $\\mathcal{O}(n_o^3 n_v^3)$ 的中间体。\n\nC. 由于 $2p2h$ 空间在二阶被精确地折叠掉，sigma 向量的构建简化为一个纯粹的单激发-单激发操作。唯一的主要缩并是类 CIS 的双电子项 $\\Sigma_{ai} \\leftarrow \\sum_{b j} \\langle a j \\Vert i b \\rangle X_{b j}$，其代价为 $\\mathcal{O}(n_o^2 n_v^2)$；不形成大小为 $\\mathcal{O}(n_o^2 n_v^2)$ 的中间体，内存流量主要由流式传输 $X_{ai}$ 决定。\n\nD. 使用单位分解（密度拟合）将 $\\langle pq \\Vert rs \\rangle \\approx \\sum_Q B_{p r}^Q B_{q s}^Q$ 分解（其中辅助基秩为 $m$），主要 sigma 构建缩并会简化为代价为 $\\mathcal{O}(m n_o n_v)$ 的一般矩阵-矩阵乘法，并且内存流量为 $\\mathcal{O}(m n_o n_v)$，因为从不流式传输任何四指标量。\n\nE. Sigma 向量的构建主要由预计算和存储一个大小为 $\\mathcal{O}(n_o^3 n_v^3)$ 的六指标中间体 $T_{a i}^{b j c k} = \\sum_{p q} \\langle a i \\Vert p q \\rangle \\langle p q \\Vert b j \\rangle \\delta_{c k}$ 所主导，该中间体随后在 $\\mathcal{O}(n_o^3 n_v^3)$ 的时间内作用于 $X_{ai}$；内存流量主要由每次迭代中对 $T$ 的写入和读取所主导。", "solution": "必须首先验证问题陈述。\n\n**步骤1：提取已知条件**\n-   方法：用于极化传播子的二阶代数图解构造法，$\\text{ADC}(2)$。\n-   表示：中间态表示 (ISR)。\n-   基：正则 Hartree–Fock (HF) 轨道。\n-   指标：占据轨道 $i,j,k,\\ldots$ (共 $n_o$ 个)；虚轨道 $a,b,c,\\ldots$ (共 $n_v$ 个)。\n-   量：反对称化的双电子积分 $\\langle pq \\Vert rs \\rangle$，具有本征值（轨道能）$\\epsilon_p$ 的对角 Fock 矩阵 $f_{pq}$。\n-   算法：用于 $\\text{ADC}(2)$ 本征值问题的迭代 Krylov 子空间本征求解器（例如，Davidson）。\n-   `sigma` 向量生成：有效 $\\text{ADC}(2)$ 矩阵对试探向量的作用。试探向量的单激发空间分量为 $X_{ai}$，结果为 $\\Sigma_{ai}$。\n-   假设：\n    1.  使用正则 HF 轨道。\n    2.  使用常规的四指标双电子积分（无积分分解，如密度拟合）。\n    3.  $\\text{ADC}(2)$ 有效矩阵的双激发（$2p2h$）块在正则轨道基中是对角的。\n    4.  除了对积分进行反对称化之外，不考虑自旋匹配。\n-   目标：确定构建 $\\Sigma_{ai}$ 向量所需的主要张量缩并，并用 $n_o$ 和 $n_v$ 描述其渐进计算代价和主内存流量。\n\n**步骤2：使用提取的已知条件进行验证**\n该问题具有科学依据，描述了量子化学中 $\\text{ADC}(2)$ 方法的一种标准实现。这些假设对于此方法的教科书式推导和分析是标准的。具体而言，使用正则 HF 轨道使得零阶哈密顿量是对角的，而基于 ISR 的 $\\text{ADC}(2)$ 的关键特征是有效哈密顿量的双激发-双激发块 $\\mathbf{M}_{DD}$ 在微扰论的零阶上是对角的，其元素是轨道能的和与差。该问题是良定的，要求进行标准的计算代价分析。语言精确且客观。因此，问题陈述是有效的。\n\n**解的推导**\n$\\text{ADC}(2)$ 本征值问题在单（$1p1h$）和双（$2p2h$）电子激发的空间中求解。在迭代求解器中，每次迭代的主要计算任务是矩阵-向量乘积 $\\mathbf{\\Sigma} = \\mathbf{M} \\mathbf{X}$，其中 $\\mathbf{M}$ 是 $\\text{ADC}(2)$ 有效哈密顿矩阵。通过划分激发空间，作用于单激发分量 $\\mathbf{X}_S$（元素为 $X_{ai}$）以产生 $\\mathbf{\\Sigma}_S$（元素为 $\\Sigma_{ai}$）的过程可以写为：\n$$ \\mathbf{\\Sigma}_S = \\mathbf{M}_{SS} \\mathbf{X}_S + \\mathbf{M}_{SD} (\\omega\\mathbf{1} - \\mathbf{M}_{DD})^{-1} \\mathbf{M}_{DS} \\mathbf{X}_S $$\n这里，$\\mathbf{M}_{SS}$、$\\mathbf{M}_{DD}$、$\\mathbf{M}_{SD}$ 和 $\\mathbf{M}_{DS}$ 分别是矩阵的单激发-单激发、双激发-双激发、单激发-双激发和双激发-单激发块，$\\omega$ 是当前对激发能的估计值。\n\n让我们分析每一项的计算代价。\n\n1.  **单激发-单激发贡献：$\\mathbf{M}_{SS} \\mathbf{X}_S$**\n    sigma 向量的类 CIS 部分 $(\\Sigma_{ai})^{(1)}$ 由下式给出：\n    $$ (\\Sigma_{ai})^{(1)} = (\\epsilon_a - \\epsilon_i) X_{ai} + \\sum_{bj} \\langle aj \\Vert ib \\rangle X_{bj} $$\n    第一项是逐元素乘积，代价为 $\\mathcal{O}(n_o n_v)$。第二项是四个指标（$a, i, b, j$）的张量缩并，其标度为 $\\mathcal{O}(n_o^2 n_v^2)$。这部分的总代价主要由 $\\mathcal{O}(n_o^2 n_v^2)$ 决定。\n\n2.  **折叠后的双激发贡献：$\\mathbf{M}_{SD} (\\omega\\mathbf{1} - \\mathbf{M}_{DD})^{-1} \\mathbf{M}_{DS} \\mathbf{X}_S$**\n    该项表示二阶校正，计算上要求更高。其评估可高效地组织为一个三步的“生成-传播-投影”序列。\n\n    a.  **生成：**在双激发空间中形成一个中间向量 $\\mathbf{Y}_D = \\mathbf{M}_{DS} \\mathbf{X}_S$。其元素为 $Y_{abij} = \\sum_{ck} (M_{DS})_{(ab)(ij),ck} X_{ck}$。耦合矩阵元 $(M_{DS})_{(ab)(ij),ck}$ 由双电子积分给出。此步骤涉及以下类型的缩并：\n    $$ Y_{abij} \\sim \\sum_{c} \\langle aj \\Vert cb \\rangle X_{ci} + \\sum_{k} \\langle ik \\Vert ab \\rangle X_{kj} + \\dots (\\text{置换项}) $$\n    让我们分析代表性项的代价。计算所有 $a, b, i, j$ 的 $Y_{abij} \\leftarrow \\sum_c \\langle aj \\Vert cb \\rangle X_{ci}$ 需要 $\\mathcal{O}(n_o^2 n_v^3)$ 次算术运算。计算 $Y_{abij} \\leftarrow \\sum_k \\langle ik \\Vert ab \\rangle X_{kj}$ 需要 $\\mathcal{O}(n_o^3 n_v^2)$ 次运算。因此，生成步骤的总代价为 $\\mathcal{O}(n_o^2 n_v^3 + n_o^3 n_v^2)$。此步骤产生一个大小为 $\\mathcal{O}(n_o^2 n_v^2)$ 的四指标中间张量 $Y_{abij}$。\n\n    b.  **传播：**应用逆预解式，$\\mathbf{Z}_D = (\\omega\\mathbf{1} - \\mathbf{M}_{DD})^{-1} \\mathbf{Y}_D$。根据问题的假设，$\\mathbf{M}_{DD}$ 是对角的，其元素为 $(M_{DD})_{(ab)(ij),(ab)(ij)} = \\epsilon_a + \\epsilon_b - \\epsilon_i - \\epsilon_j$。因此，此步骤是一个简单的逐元素除法：\n    $$ Z_{abij} = \\frac{Y_{abij}}{\\omega - (\\epsilon_a + \\epsilon_b - \\epsilon_i - \\epsilon_j)} $$\n    其代价与双激发的数量成正比，即 $\\mathcal{O}(n_o^2 n_v^2)$。此步骤读取大小为 $\\mathcal{O}(n_o^2 n_v^2)$ 的中间体 $Y_{abij}$ 并写入大小为 $\\mathcal{O}(n_o^2 n_v^2)$ 的中间体 $Z_{abij}$。\n\n    c.  **投影：**双激发中间体 $\\mathbf{Z}_D$ 被投影回单激发空间以得到对 sigma 向量的最终贡献：$(\\mathbf{\\Sigma}_S)^{(2)} = \\mathbf{M}_{SD} \\mathbf{Z}_D$。这涉及积分张量与中间体 $Z_{abij}$ 的缩并：\n    $$ (\\Sigma_{ai})^{(2)} \\sim \\sum_{jbc} \\langle aj \\Vert cb \\rangle Z_{bcij} + \\sum_{jkb} \\langle jk \\Vert ib \\rangle Z_{abjk} + \\dots (\\text{置换项}) $$\n    代价分析与生成步骤对称。第一个项的标度为 $\\mathcal{O}(n_o^2 n_v^3)$，第二个为 $\\mathcal{O}(n_o^3 n_v^2)$。投影步骤的总代价为 $\\mathcal{O}(n_o^2 n_v^3 + n_o^3 n_v^2)$。\n\n**代价总结**\n-   计算主导项：生成和投影步骤是计算最昂贵的，标度为 $\\mathcal{O}(n_o^2 n_v^3 + n_o^3 n_v^2)$。类 CIS 和传播步骤是次要的。通常，$n_v \\gg n_o$，使得 $\\mathcal{O}(n_o^2 n_v^3)$ 项成为渐进领先项。\n-   内存/流量主导项：所涉及的最大的张量是四指标积分和四指标中间体 $Y_{abij}$ 和 $Z_{abij}$，每个都有 $\\mathcal{O}(n_o^2 n_v^2)$ 个元素。内存流量主要由读/写这些张量所主导。向量 $X_{ai}$ 和 $\\Sigma_{ai}$ 较小，只有 $\\mathcal{O}(n_o n_v)$ 个元素。这些缩并的计算强度（浮点运算次数与内存访问量的比率）很低，因为必须为每个数据元素的有限数量的操作流式传输大量数据，除非采用复杂的数据分块策略。\n\n此分析允许对给定选项进行系统性评估。\n\n**逐项分析**\n\n**A.** 此选项详细分解了 sigma 向量的构建，将其分为类 CIS 部分和折叠后的 $2p2h$ 贡献。它正确地指出了后者的`生成-传播-投影`序列。它准确地陈述了生成和投影步骤的标度为 $\\mathcal{O}(n_o^2 n_v^3 + n_o^3 n_v^2)$，传播步骤的标度为 $\\mathcal{O}(n_o^2 n_v^2)$。它正确地指出内存流量主要由流式传输大小为 $\\mathcal{O}(n_o^2 n_v^2)$ 的四指标张量（$\\langle ij \\Vert ab \\rangle$，$Y_{abij}$，$Z_{abij}$）所主导，而向量是次要的。它还正确地描述了计算强度较低。此描述与第一性原理推导完全一致。\n**结论：正确。**\n\n**B.** 此选项声称主要标度为 $\\mathcal{O}(n_o^3 n_v^3)$，原因是“类三激发缩并”，并且内存主要由大小为 $\\mathcal{O}(n_o^3 n_v^3)$ 的中间体主导。$\\text{ADC}(2)$ 方法没有占主导地位的 $\\mathcal{O}(n_o^3 n_v^3)$ 步骤，也不会生成大小为 $\\mathcal{O}(n_o^3 n_v^3)$ 的六指标中间体。这种标度是更高阶方法的特征。\n**结论：不正确。**\n\n**C.** 此选项声称构建过程简化为纯粹的单激发-单激发（类 CIS）操作，标度为 $\\mathcal{O}(n_o^2 n_v^2)$，并且不形成大小为 $\\mathcal{O}(n_o^2 n_v^2)$ 的中间体。这从根本上是错误的，因为它忽略了来自双激发空间的二阶校正，而这正是 $\\text{ADC}(2)$ 与 CIS/ADC(1) 的区别所在。主要标度高于 $\\mathcal{O}(n_o^2 n_v^2)$，并且大小为 $\\mathcal{O}(n_o^2 n_v^2)$ 的中间体是必不可少的。\n**结论：不正确。**\n\n**D.** 此选项援引了密度拟合（单位分解），而这被问题陈述的假设2（“常规的四指标双电子积分（无密度拟合...）”）明确排除了。因此，其结论不适用于所述问题。\n**结论：不正确。**\n\n**E.** 此选项建议预计算和存储一个大小为 $\\mathcal{O}(n_o^3 n_v^3)$ 的六指标中间体。这不是标准的迭代 $\\text{ADC}(2)$ 算法的一部分，其每次迭代的代价必须低于形成如此大的预计算张量的代价。中间体的表达式在句法上也是有问题的。这描述了一个非标准且计算上不切实际的过程。\n**结论：不正确。**\n\n基于详细分析，只有选项 A 准确描述了在给定假设下迭代 $\\text{ADC}(2)$ sigma 向量计算的计算特征。", "answer": "$$\\boxed{A}$$", "id": "2873837"}]}