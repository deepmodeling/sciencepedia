{"hands_on_practices": [{"introduction": "我们从量子力学中最基础的可解模型之一——量子谐振子（QHO）开始。该练习旨在巩固系统能量响应外加电场与静态极化率 $\\alpha$ 之间的基本联系，这一联系是通过微扰理论建立的。通过这个理想化的场景，你将运用微扰理论从第一性原理推导极化率，并证明对称性如何决定了哪些高阶响应性质（如奇数阶超极化率）必然为零，这是一个在光谱学和非线性光学中具有深远影响的普适原则。[@problem_id:2915753]", "problem": "考虑一个电荷为 $q$、质量为 $m$ 的单个粒子，在谐振子势 $V_{0}(x)=\\tfrac{1}{2} m \\omega^{2} x^{2}$ 中沿一维空间坐标 $x$ 运动。一个大小为 $F$ 的均匀静电场沿 $x$ 方向施加，因此总哈密顿量为 $H(F)=H_{0}+V(F)$，其中 $H_{0}=\\tfrac{p^{2}}{2m}+\\tfrac{1}{2} m \\omega^{2} x^{2}$ 且 $V(F)=-q F x$。在电偶极近似下进行计算，并假设定态是非简并的。\n\n从定态薛定谔方程和非简并定态微扰理论出发，仅使用基本定义，完成以下任务：\n- 从基态能量的场依赖性，推导基态的静态（零频）线性极化率 $\\alpha$。你的推导必须从 $\\alpha$ 的定义（即基态能量对场在零场下的二阶导数）开始，并通过对 $F$ 进行系统性微扰来展开。\n- 利用未受扰势的反演对称性，证明该系统的所有奇数阶静态超极化率均为零。\n\n请将静态极化率的最终结果表示为包含 $q$、$m$ 和 $\\omega$ 的闭合形式解析表达式。物理量使用国际单位制（SI）的约定，但不要代入数值。最终答案只需报告你得到的 $\\alpha$ 的表达式。不需要四舍五入，也不需要进行数值计算。", "solution": "问题陈述已经过严格验证。\n\n**已知条件：**\n1. 系统：一个电荷为 $q$、质量为 $m$ 的粒子在一维空间 $x$ 中运动。\n2. 未受扰哈密顿量：$H_{0}=\\tfrac{p^{2}}{2m}+\\tfrac{1}{2} m \\omega^{2} x^{2}$。\n3. 微扰：$V(F)=-q F x$，来自大小为 $F$ 的均匀静电场。\n4. 总哈密顿量：$H(F)=H_{0}+V(F)$。\n5. 状态：系统的基态，其对于 $H_0$ 是非简并的。\n6. 极化率的定义：$\\alpha = -\\frac{\\partial^2 E_0(F)}{\\partial F^2}|_{F=0}$，其中 $E_0(F)$ 是存在电场时的基态能量。\n7. 任务：(i) 推导静态线性极化率 $\\alpha$。(ii) 证明所有奇数阶静态超极化率均为零。\n\n**验证结论：**\n该问题具有科学依据，因为它描述了静态电场下的规范量子谐振子，这是量子力学中的一个基本模型。问题提法恰当，所有必要组成部分都已定义，语言客观。各项假设均一致。因此，该问题被判定为**有效**，我们可以开始求解。\n\n根据要求，解答分为两部分。\n\n**第一部分：静态线性极化率 $\\alpha$ 的推导**\n\n我们从基态（记为 $|0\\rangle$）静态极化率的定义开始，它是其能量 $E_0(F)$ 的函数：\n$$\n\\alpha = -\\left.\\frac{\\partial^2 E_0(F)}{\\partial F^2}\\right|_{F=0}\n$$\n为了计算该式，我们使用非简并定态微扰理论，将基态能量表示为电场强度 $F$ 的幂级数。微扰哈密顿量为 $V = -qFx$。基态能量 $E_0(F)$ 展开为：\n$$\nE_0(F) = E_0^{(0)} + E_0^{(1)} + E_0^{(2)} + \\dots\n$$\n其中 $E_0^{(k)}$ 是能量的 $k$ 阶修正。未受扰基态能量为 $E_0^{(0)} = \\frac{1}{2}\\hbar\\omega$。\n\n一阶能量修正由微扰在未受扰基态 $|0\\rangle$ 中的期望值给出：\n$$\nE_0^{(1)} = \\langle 0 | V | 0 \\rangle = \\langle 0 | -qFx | 0 \\rangle = -qF \\langle 0 | x | 0 \\rangle\n$$\n对于量子谐振子，其本征态具有确定的宇称。基态波函数 $\\psi_0^{(0)}(x)$ 是一个偶函数。位置算符 $x$ 是一个奇算符。期望值 $\\langle 0 | x | 0 \\rangle$ 是乘积 $\\psi_0^{(0)*} x \\psi_0^{(0)}$（这是一个奇函数）在对称区间 $(-\\infty, \\infty)$ 上的积分。该积分恒等于零。因此：\n$$\nE_0^{(1)} = 0\n$$\n\n二阶能量修正由下式给出：\n$$\nE_0^{(2)} = \\sum_{k \\neq 0} \\frac{|\\langle k | V | 0 \\rangle|^2}{E_0^{(0)} - E_k^{(0)}}\n$$\n代入 $V = -qFx$ 并提出与场相关的项，我们得到：\n$$\nE_0^{(2)} = (-qF)^2 \\sum_{k \\neq 0} \\frac{|\\langle k | x | 0 \\rangle|^2}{E_0^{(0)} - E_k^{(0)}} = q^2 F^2 \\sum_{k \\neq 0} \\frac{|\\langle k | x | 0 \\rangle|^2}{E_0^{(0)} - E_k^{(0)}}\n$$\n为计算矩阵元 $\\langle k | x | 0 \\rangle$，我们用湮灭算符 ($a$) 和产生算符 ($a^\\dagger$) 来表示位置算符 $x$：\n$$\nx = \\sqrt{\\frac{\\hbar}{2m\\omega}}(a + a^\\dagger)\n$$\n这些算符作用在基态 $|0\\rangle$ 上的结果是 $a|0\\rangle = 0$ 和 $a^\\dagger|0\\rangle = |1\\rangle$。因此，矩阵元为：\n$$\n\\langle k | x | 0 \\rangle = \\sqrt{\\frac{\\hbar}{2m\\omega}} \\langle k | a + a^\\dagger | 0 \\rangle = \\sqrt{\\frac{\\hbar}{2m\\omega}} (\\langle k | a | 0 \\rangle + \\langle k | a^\\dagger | 0 \\rangle) = \\sqrt{\\frac{\\hbar}{2m\\omega}} \\langle k | 1 \\rangle\n$$\n由于正交条件 $\\langle k | 1 \\rangle = \\delta_{k1}$，该矩阵元仅在 $k=1$ 时非零。因此 $E_0^{(2)}$ 的求和式简化为单项：\n$$\nE_0^{(2)} = q^2 F^2 \\frac{|\\langle 1 | x | 0 \\rangle|^2}{E_0^{(0)} - E_1^{(0)}}\n$$\n未受扰能级为 $E_n^{(0)} = (n + \\frac{1}{2})\\hbar\\omega$。因此，$E_0^{(0)} = \\frac{1}{2}\\hbar\\omega$ 且 $E_1^{(0)} = \\frac{3}{2}\\hbar\\omega$。能量分母为 $E_0^{(0)} - E_1^{(0)} = -\\hbar\\omega$。矩阵元的平方为 $|\\langle 1 | x | 0 \\rangle|^2 = \\left(\\sqrt{\\frac{\\hbar}{2m\\omega}}\\right)^2 = \\frac{\\hbar}{2m\\omega}$。\n代入这些结果，得到二阶能量修正：\n$$\nE_0^{(2)} = q^2 F^2 \\frac{\\frac{\\hbar}{2m\\omega}}{-\\hbar\\omega} = -\\frac{q^2 F^2}{2m\\omega^2}\n$$\n基态能量展开到 $F$ 的二阶为：\n$$\nE_0(F) \\approx E_0^{(0)} + E_0^{(1)} + E_0^{(2)} = \\frac{1}{2}\\hbar\\omega + 0 - \\frac{q^2 F^2}{2m\\omega^2}\n$$\n现在，我们根据其定义计算极化率：\n$$\n\\frac{\\partial E_0(F)}{\\partial F} \\approx -\\frac{q^2 F}{m\\omega^2}\n$$\n$$\n\\frac{\\partial^2 E_0(F)}{\\partial F^2} \\approx -\\frac{q^2}{m\\omega^2}\n$$\n二阶导数是常数，因此在 $F=0$ 处取极限是直接的。\n$$\n\\alpha = -\\left.\\frac{\\partial^2 E_0(F)}{\\partial F^2}\\right|_{F=0} = - \\left( -\\frac{q^2}{m\\omega^2} \\right) = \\frac{q^2}{m\\omega^2}\n$$\n值得注意的是，对于谐振子，这个结果是精确的。完整的哈密顿量 $H(F)$ 可以通过配方法精确求解，这表明能量本征值对 $F$ 具有纯粹的二次依赖关系。因此，所有 $k > 2$ 的微扰修正 $E_0^{(k)}$ 都恒等于零。\n\n**第二部分：奇数阶静态超极化率的消失**\n\n奇数阶静态超极化率（例如 $\\beta$、$\\delta$ 等）是通过能量对场在零场下的奇数阶导数来定义的。例如，$\\beta = -\\frac{\\partial^3 E_0(F)}{\\partial F^3}|_{F=0}$。我们将证明所有这些量都为零。\n\n该证明依赖于哈密顿量的对称性。\n1. 未受扰哈密顿量 $H_0 = \\frac{p^2}{2m} + \\frac{1}{2}m\\omega^2 x^2$ 在宇称变换 $\\mathcal{P}$ 下是不变的，在一维情况下，宇称变换意味着 $x \\to -x$ 和 $p \\to -p$。动能项 ($p^2$) 和势能项 ($x^2$) 都是各自算符的偶函数。因此，$[H_0, \\mathcal{P}] = 0$。\n2. 微扰 $V(F) = -qFx$ 是 $x$ 的奇函数。\n3. 考虑场为 $-F$ 时的总哈密顿量，即 $H(-F) = H_0 + qFx$。我们通过相似变换将宇称算符 $\\mathcal{P}$ 作用于 $H(-F)$：\n$$\n\\mathcal{P} H(-F) \\mathcal{P}^{-1} = \\mathcal{P} (H_0 + qFx) \\mathcal{P}^{-1} = \\mathcal{P}H_0\\mathcal{P}^{-1} + qF (\\mathcal{P}x\\mathcal{P}^{-1})\n$$\n由于 $[H_0, \\mathcal{P}]=0$，所以 $\\mathcal{P}H_0\\mathcal{P}^{-1} = H_0$。位置算符的变换为 $\\mathcal{P}x\\mathcal{P}^{-1} = -x$。因此：\n$$\n\\mathcal{P} H(-F) \\mathcal{P}^{-1} = H_0 - qFx = H(F)\n$$\n这表明哈密顿量 $H(F)$ 和 $H(-F)$ 是幺正等价的。幺正等价的算符具有相同的本征值谱。\n4. 设 $H(F)$ 的能量本征值集合为 $\\{ E_n(F) \\}$。那么我们必有 $\\{ E_n(F) \\} = \\{ E_n(-F) \\}$。\n5. 问题陈述指出，未受扰系统的定态是非简并的。对于较小的场强 $F$，这种非简并性得以保持。因此，能态的顺序得以维持，这意味着对于每个单独的能态 $n$，都有 $E_n(F) = E_n(-F)$。\n6. 因此，基态能量 $E_0(F)$ 必须是场强 $F$ 的偶函数。\n7. 一个偶函数 $f(z) = f(-z)$，其在 $z=0$ 处的泰勒级数展开式只能包含偶次幂：$f(z) = \\sum_{j=0}^{\\infty} c_{2j} z^{2j}$。\n8. 因此，$E_0(F)$ 在 $F=0$ 附近的展开式必须具有以下形式：\n$$\nE_0(F) = E_0^{(0)} + c_2 F^2 + c_4 F^4 + \\dots\n$$\n$F$ 的所有奇次幂的系数都必须为零。\n9. 奇数阶超极化率由 $E_0(F)$ 在 $F=0$ 处的奇数阶导数定义。对于任何奇数 $2k+1$（其中 $k \\geq 0$）：\n$$\n\\left.\\frac{\\partial^{2k+1} E_0(F)}{\\partial F^{2k+1}}\\right|_{F=0} = 0\n$$\n这证明了基态的所有奇数阶静态超极化率均为零。这是一个普遍结论，适用于任何其未受扰态具有反演对称中心的系统。", "answer": "$$\n\\boxed{\\frac{q^2}{m\\omega^2}}\n$$", "id": "2915753"}, {"introduction": "在从解析理论转向实际计算的过程中，有限场方法是计算化学中确定响应性质的主力。虽然微扰理论提供了形式化的“态求和”表达式，但该练习将指导你如何通过一系列在不同电场强度下进行的能量计算来提取高阶响应性质，例如二阶超极化率 $\\gamma_{zzzz}$。更重要的是，本练习引入了一项关键技能：如何将底层量子化学计算的数值不确定性传播到最终的导出性质中，从而将量子理论与统计数据分析联系起来。[@problem_id:2915758]", "problem": "在原子单位制下，考虑一个固定几何构型的分子，其电子基态为非简并态，置于沿 $z$ 轴施加的静态、空间均匀电场 $F_{z}$ 中。在 Born–Oppenheimer (BO) 近似和不含时 Rayleigh–Schrödinger (RS) 微扰理论的框架内，与场相关的电子哈密顿量可以写为 $H(F_{z}) = H_{0} - \\mu_{z} F_{z}$，其中 $\\mu_{z}$ 是电偶极矩算符的 $z$ 分量。假设精确的基态能量 $E(F_{z})$ 在 $F_{z}=0$ 的一个邻域内是解析的。\n\n你在 $F_{z}=0$ 附近的一个邻域内（包括正值和负值场），对 $N$ 个场强值 $\\{F_{k}\\}_{k=1}^{N}$ 进行了单点电子能量计算，并通过普通最小二乘法 (OLS) 将这些数据拟合到以下四次模型：\n$$\nE(F_{z}) \\approx a_{0} + a_{1} F_{z} + a_{2} F_{z}^{2} + a_{3} F_{z}^{3} + a_{4} F_{z}^{4}.\n$$\n设 $X$ 是一个 $N \\times 5$ 的设计矩阵，其第 $k$ 行为 $\\big(1,\\,F_{k},\\,F_{k}^{2},\\,F_{k}^{3},\\,F_{k}^{4}\\big)$，并设残差向量为 $r = y - X \\hat{a}$，其中 $y$ 汇集了计算出的能量，$\\hat{a}$ 是系数向量 $a = (a_{0},a_{1},a_{2},a_{3},a_{4})^{\\top}$ 的 OLS 估计量。假设能量误差是独立同分布的，服从均值为零、方差为 $\\sigma^{2}$ 的高斯分布，并定义残差平方和 (RSS) 为 $\\mathrm{RSS} = r^{\\top} r$。设 $p=5$ 为拟合参数的数量，并设噪声方差的无偏估计量为 $s^{2} = \\mathrm{RSS}/(N-p)$。\n\n仅使用 RS 微扰理论中电响应张量的场导数定义以及在同方差高斯噪声下 OLS 的标准线性回归理论：\n\n1.  推导如何从拟合的四次系数 $a_{4}$ 中提取静态二阶超极化率分量 $\\gamma_{zzzz}(0;0,0,0)$。你的结果必须明确指出关联 $\\gamma_{zzzz}(0;0,0,0)$ 与 $a_{4}$ 的整体符号和精确的乘法常数。\n\n2.  推导 $\\gamma_{zzzz}(0;0,0,0)$ 估计值的标准不确定度（标准误差）的闭式表达式，用 $\\mathrm{RSS}$、$N$ 和设计矩阵 $X$ 来表示。使用矩阵 $(X^{\\top} X)^{-1}$ 的 $(5,5)$ 元素来表达你的结果。将标准不确定度表示为方差的正平方根。\n\n全过程使用原子单位制。将你的最终答案表示为一个包含两个条目的行矩阵：第一个条目是用 $a_{4}$ 表示的 $\\gamma_{zzzz}(0;0,0,0)$ 的表达式，第二个条目是用 $\\mathrm{RSS}$、$N$ 和 $X$ 表示其标准不确定度的表达式。无需进行数值取整。", "solution": "在尝试解答之前，需对问题陈述进行验证。\n\n### 步骤1：提取已知条件\n- **体系**：一个在 Born–Oppenheimer (BO) 近似下具有非简并电子基态和固定几何构型的分子。\n- **微扰**：一个沿 $z$ 轴施加的静态、空间均匀电场 $F_{z}$。\n- **哈密顿量**：与场相关的电子哈密顿量为 $H(F_{z}) = H_{0} - \\mu_{z} F_{z}$，其中 $\\mu_{z}$ 是电偶极矩算符的 $z$ 分量。\n- **能量**：假设基态能量 $E(F_{z})$ 在 $F_{z}=0$ 的一个邻域内是解析函数。\n- **数据与模型**：在场强 $\\{F_{k}\\}_{k=1}^{N}$ 下的 $N$ 个能量计算值 $\\{E_k\\}$ 通过普通最小二乘法 (OLS) 拟合到四次模型 $E(F_{z}) \\approx a_{0} + a_{1} F_{z} + a_{2} F_{z}^{2} + a_{3} F_{z}^{3} + a_{4} F_{z}^{4}$。\n- **线性回归参数**：\n    - 设计矩阵 $X$ 是一个 $N \\times 5$ 的矩阵，其第 $k$ 行为 $\\big(1,\\,F_{k},\\,F_{k}^{2},\\,F_{k}^{3},\\,F_{k}^{4}\\big)$。\n    - 系数向量为 $a = (a_{0},a_{1},a_{2},a_{3},a_{4})^{\\top}$，其 OLS 估计量为 $\\hat{a}$。问题将估计的系数表示为 $a_4$。\n    - 参数数量为 $p=5$。\n- **统计假设**：\n    - 能量误差是独立同分布 (i.i.d.) 的高斯随机变量，均值为零，方差为 $\\sigma^{2}$。\n    - 残差平方和为 $\\mathrm{RSS} = r^{\\top} r$，其中 $r = y - X \\hat{a}$。\n    - 噪声方差的一个无偏估计量是 $s^{2} = \\mathrm{RSS}/(N-p)$。\n- **任务**：\n    1.  推导静态二阶超极化率分量 $\\gamma_{zzzz}(0;0,0,0)$ 与拟合系数 $a_{4}$ 之间的关系，包括符号和乘法常数。\n    2.  推导 $\\gamma_{zzzz}(0;0,0,0)$ 估计值的标准不确定度，用 $\\mathrm{RSS}$、$N$ 和矩阵 $(X^{\\top} X)^{-1}$ 的 $(5,5)$ 元素来表示。\n\n### 步骤2：使用提取的已知条件进行验证\n该问题描述了用于计算分子电学性质的有限场方法，这是计算量子化学中的一种标准技术。其物理模型（BO 近似、RS 微扰理论）、数学表述（能量的泰勒级数展开）和统计分析（OLS 回归）都是可靠且正确结合的。\n\n- **科学上合理**：该问题牢固地植根于量子力学和统计理论的既定原则。哈密顿量、微扰以及作为能量导数的极化率概念都是基础性的。\n- **问题明确**：问题陈述清晰，提供了推导所需表达式的所有必要信息。目标具体，且有唯一解。\n- **客观性**：语言精确、技术性强，没有任何主观性或模糊性。\n\n该问题没有表现出任何诸如科学上不合理、不完整、矛盾或不可行等缺陷。这是一个定义明确的问题，旨在检验物理理论与数据分析方法学之间的联系。\n\n### 步骤3：结论与行动\n该问题是有效的。下面将推导完整的解答。\n\n### 推导\n\n根据问题陈述的要求，解答分为两部分。所有计算均在原子单位制下进行。\n\n**第1部分：提取二阶超极化率 $\\gamma_{zzzz}(0;0,0,0)$**\n\n分子在静态电场 $F_{z}$ 存在下的能量 $E(F_{z})$ 可以在 $F_{z}=0$ 附近展开为泰勒级数：\n$$\nE(F_{z}) = E(0) + \\left(\\frac{\\partial E}{\\partial F_{z}}\\right)_{F_{z}=0} F_{z} + \\frac{1}{2!} \\left(\\frac{\\partial^{2} E}{\\partial F_{z}^{2}}\\right)_{F_{z}=0} F_{z}^{2} + \\frac{1}{3!} \\left(\\frac{\\partial^{3} E}{\\partial F_{z}^{3}}\\right)_{F_{z}=0} F_{z}^{3} + \\frac{1}{4!} \\left(\\frac{\\partial^{4} E}{\\partial F_{z}^{4}}\\right)_{F_{z}=0} F_{z}^{4} + O(F_{z}^{5})\n$$\n问题指出应使用电响应张量的场导数定义。对于沿 $z$ 轴的静态场，永久偶极矩 ($\\mu_{z}$)、极化率 ($\\alpha_{zz}$)、一阶超极化率 ($\\beta_{zzz}$) 和二阶超极化率 ($\\gamma_{zzzz}$) 定义如下：\n$$\n\\mu_{z} = -\\left(\\frac{\\partial E}{\\partial F_{z}}\\right)_{F_{z}=0}\n$$\n$$\n\\alpha_{zz} = -\\left(\\frac{\\partial^{2} E}{\\partial F_{z}^{2}}\\right)_{F_{z}=0}\n$$\n$$\n\\beta_{zzz} = -\\left(\\frac{\\partial^{3} E}{\\partial F_{z}^{3}}\\right)_{F_{z}=0}\n$$\n$$\n\\gamma_{zzzz}(0;0,0,0) = -\\left(\\frac{\\partial^{4} E}{\\partial F_{z}^{4}}\\right)_{F_{z}=0}\n$$\n符号 $\\gamma_{zzzz}(0;0,0,0)$ 明确表示这是一个静态性质，这与使用静态场 $F_z$ 是一致的。将这些定义代入能量的泰勒级数中，得到：\n$$\nE(F_{z}) = E(0) - \\mu_{z} F_{z} - \\frac{1}{2!} \\alpha_{zz} F_{z}^{2} - \\frac{1}{3!} \\beta_{zzz} F_{z}^{3} - \\frac{1}{4!} \\gamma_{zzzz}(0;0,0,0) F_{z}^{4} + O(F_{z}^{5})\n$$\n该问题涉及将计算出的能量拟合到四次模型：\n$$\nE(F_{z}) \\approx a_{0} + a_{1} F_{z} + a_{2} F_{z}^{2} + a_{3} F_{z}^{3} + a_{4} F_{z}^{4}\n$$\n通过比较理论泰勒展开式和拟合多项式中 $F_{z}$ 各次幂的系数，我们可以将拟合系数 $\\{a_i\\}$ 与物理性质关联起来。具体而言，对于 $F_{z}^{4}$ 项的系数，我们有：\n$$\na_{4} \\approx -\\frac{1}{4!} \\gamma_{zzzz}(0;0,0,0)\n$$\n因为 $4! = 24$，我们有 $a_{4} \\approx -\\frac{1}{24} \\gamma_{zzzz}(0;0,0,0)$。\n因此，二阶超极化率分量的估计值，此处表示为 $\\gamma_{zzzz}(0;0,0,0)$，可以从拟合系数 $a_{4}$ 中提取出来：\n$$\n\\gamma_{zzzz}(0;0,0,0) = -24 a_{4}\n$$\n乘法常数为 $-24$。\n\n**第2部分：$\\gamma_{zzzz}(0;0,0,0)$ 估计值的标准不确定度**\n\n这部分需要用到普通最小二乘法 (OLS) 回归的理论结果。估计的系数向量 $\\hat{a}$ 的协方差矩阵由下式给出：\n$$\n\\mathrm{Cov}(\\hat{a}) = \\sigma^{2} (X^{\\top} X)^{-1}\n$$\n其中 $\\sigma^{2}$ 是能量计算中误差的真实方差。由于 $\\sigma^{2}$ 未知，它被其无偏估计量 $s^{2} = \\frac{\\mathrm{RSS}}{N-p}$ 所替代，其中 $p=5$ 是拟合参数的数量。因此，$\\hat{a}$ 的估计协方差矩阵为：\n$$\n\\widehat{\\mathrm{Cov}}(\\hat{a}) = s^{2} (X^{\\top} X)^{-1} = \\frac{\\mathrm{RSS}}{N-5} (X^{\\top} X)^{-1}\n$$\n特定系数估计值 $\\hat{a}_{j}$ 的方差是该矩阵的相应对角元。对于系数 $\\hat{a}_{4}$（第五个系数，对应于索引 $j=5$），估计的方差是：\n$$\n\\widehat{\\mathrm{Var}}(\\hat{a}_{4}) = \\frac{\\mathrm{RSS}}{N-5} \\left[ (X^{\\top} X)^{-1} \\right]_{55}\n$$\n其中 $\\left[ (X^{\\top} X)^{-1} \\right]_{55}$ 表示矩阵 $(X^{\\top} X)^{-1}$ 的 $(5,5)$ 元素。\n\n根据第1部分，超极化率的估计值（表示为 $\\hat{\\gamma}_{zzzz}$）与系数的估计值 $\\hat{a}_{4}$ 通过一个常数因子相关联：\n$$\n\\hat{\\gamma}_{zzzz}(0;0,0,0) = -24 \\hat{a}_{4}\n$$\n一个由常数 $c$ 缩放的随机变量的方差由规则 $\\mathrm{Var}(cZ) = c^{2}\\mathrm{Var}(Z)$ 给出。应用此规则来求 $\\hat{\\gamma}_{zzzz}(0;0,0,0)$ 的估计方差：\n$$\n\\widehat{\\mathrm{Var}}(\\hat{\\gamma}_{zzzz}(0;0,0,0)) = \\widehat{\\mathrm{Var}}(-24 \\hat{a}_{4}) = (-24)^{2} \\widehat{\\mathrm{Var}}(\\hat{a}_{4}) = 576 \\, \\widehat{\\mathrm{Var}}(\\hat{a}_{4})\n$$\n代入 $\\widehat{\\mathrm{Var}}(\\hat{a}_{4})$ 的表达式：\n$$\n\\widehat{\\mathrm{Var}}(\\hat{\\gamma}_{zzzz}(0;0,0,0)) = 576 \\left( \\frac{\\mathrm{RSS}}{N-5} \\right) \\left[ (X^{\\top} X)^{-1} \\right]_{55}\n$$\n标准不确定度，通常表示为标准误差，是估计方差的正平方根。设其为 $u(\\hat{\\gamma}_{zzzz})$。\n$$\nu(\\hat{\\gamma}_{zzzz}(0;0,0,0)) = \\sqrt{\\widehat{\\mathrm{Var}}(\\hat{\\gamma}_{zzzz}(0;0,0,0))} = \\sqrt{576 \\frac{\\mathrm{RSS}}{N-5} \\left[ (X^{\\top} X)^{-1} \\right]_{55}}\n$$\n$$\nu(\\hat{\\gamma}_{zzzz}(0;0,0,0)) = 24 \\sqrt{\\frac{\\mathrm{RSS}}{N-5} \\left[ (X^{\\top} X)^{-1} \\right]_{55}}\n$$\n此表达式用指定的量给出了超极化率估计值的标准不确定度。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n-24 a_{4} & 24 \\sqrt{\\frac{\\mathrm{RSS}}{N-5} \\left[ (X^{\\top} X)^{-1} \\right]_{55}}\n\\end{pmatrix}\n}\n$$", "id": "2915758"}, {"introduction": "最后的实践环节是亲手实现并直接比较计算极化率的两种主要方法。通过为一个简单但非平凡的非谐振子模型编写代码，你将实现“解析导数”（基于微扰理论）和“有限场”两种方法。这个练习迫使你直面并量化响应性质计算中的两个主要误差来源：由基组不完备性引起的内在量子化学误差，以及有限场方法中固有的数值微分误差，从而加深对这些计算方法优势和局限性的理解。[@problem_id:2915784]", "problem": "考虑一个小分子中，电子在外加静电场方向上运动分量的单电子模型。全程使用原子单位（a.u.）。在沿 $x$ 轴方向、大小为 $F$ 的匀强电场存在时，有效的一维哈密顿量为\n$$\n\\hat{H}(F) = \\frac{\\hat{p}^2}{2} + \\frac{1}{2}\\,\\omega^2 \\hat{x}^2 + \\lambda \\hat{x}^4 - F \\hat{x},\n$$\n其中物理参数 $\\omega$ 和 $\\lambda$ 为固定的实正常数。静态偶极极化率 $\\alpha$ 由精确基态能量 $E(F)$ 在 $F=0$ 处对 $F$ 的二阶导数通过级数 $E(F) = E(0) - \\mu F - \\tfrac{1}{2}\\alpha F^2 - \\cdots$ 定义，因此 $\\alpha = -\\left.\\dfrac{d^2 E}{dF^2}\\right|_{F=0}$。\n\n您的任务是使用截断谐振子基组对该哈密顿量实现两种独立的 $\\alpha$ 计算，并比较结果：\n- 基于关于 $F=0$ 的二阶 Rayleigh–Schrödinger 微扰理论的定态线性响应，使用所选截断基组中 $\\hat{H}(0)$ 的本征态和本征值计算出的“解析导数”值。\n- 使用在相同截断基组中通过精确对角化计算出的基态能量 $E(F)$ 的中心二阶有限差分得到的“有限场”估计值。\n\n为构建截断基组和哈密顿矩阵，请按以下步骤进行，不要假设任何非从第一性原理推导的黑箱公式。使用基频为 $\\omega_b$ 的参考谐振子的数态 $\\{\\lvert n \\rangle\\}_{n=0}^{N-1}$ 作为您的归一正交基。使用满足 $[\\hat{a},\\hat{a}^\\dagger]=1$ 的阶梯算符 $\\hat{a}$ 和 $\\hat{a}^\\dagger$，并将 $\\hat{x}$ 和 $\\hat{p}$ 用 $\\hat{a}$ 和 $\\hat{a}^\\dagger$ 表示。使用它们构建 $\\hat{x}$ 的矩阵表示，然后通过显式矩阵乘法构成 $\\hat{x}^2$ 和 $\\hat{x}^4$。令 $\\hat{H}_b = \\omega_b\\left(\\hat{a}^\\dagger \\hat{a} + \\tfrac{1}{2}\\right)$ 表示基谐振子哈密顿量。使用恒等式 $\\tfrac{\\hat{p}^2}{2} = \\hat{H}_b - \\tfrac{1}{2}\\,\\omega_b^2 \\hat{x}^2$，在截断基组中为给定的物理参数 $\\omega$ 和 $\\lambda$ 组装无场哈密顿矩阵，形式如下\n$$\n\\hat{H}(0) = \\hat{H}_b + \\frac{1}{2}\\left(\\omega^2 - \\omega_b^2\\right)\\hat{x}^2 + \\lambda \\hat{x}^4,\n$$\n以及场扰动哈密顿量\n$$\n\\hat{H}(F) = \\hat{H}(0) - F \\hat{x}.\n$$\n\n通过应用定态二阶微扰理论（等效于定态线性响应理论），在 $F=0$ 时，根据截断基组内 $\\hat{H}(0)$ 的本征对来计算“解析导数”极化率。将“有限场”极化率计算为 $\\hat{H}(F)$ 基态能量在 $\\pm F$ 和 $0$ 处的二阶中心有限差分商的负值。为分析差异，还需使用相同的“解析导数”方法，但采用一个大得多的基组大小 $N_{\\mathrm{ref}}$，来计算一个高度收敛的参考极化率 $\\alpha_{\\mathrm{ref}}$。\n\n在原子单位下使用以下固定的物理参数和基频：$\\omega = 0.7$, $\\lambda = 0.02$, $\\omega_b = 0.7$。使用以下基组大小 $N$ 和有限场步长 $F$ 的测试集：\n- 测试 1: $N=12$, $F=10^{-3}$。\n- 测试 2: $N=12$, $F=5\\times 10^{-2}$。\n- 测试 3: $N=4$, $F=10^{-3}$。\n- 测试 4: $N=8$, $F=10^{-5}$。\n- 测试 5: $N=20$, $F=10^{-3}$。\n\n使用 $N_{\\mathrm{ref}} = 100$ 来定义 $\\alpha_{\\mathrm{ref}}$。\n\n对于每个测试用例，产生两个浮点数：\n- $\\Delta_{\\mathrm{FF}} = \\alpha_{\\mathrm{analytic}}(N) - \\alpha_{\\mathrm{finite\\text{-}field}}(N,F)$，它在固定的 $N$ 下分离出给定 $F$ 的数值微分误差。\n- $\\Delta_{\\mathrm{basis}} = \\alpha_{\\mathrm{ref}} - \\alpha_{\\mathrm{analytic}}(N)$，它在 $F=0$ 时分离出基组不完备性误差。\n\n所有输出均以原子单位表示。您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，结果按以下顺序排列\n$$\n[\\Delta_{\\mathrm{FF}}^{(1)}, \\Delta_{\\mathrm{basis}}^{(1)}, \\Delta_{\\mathrm{FF}}^{(2)}, \\Delta_{\\mathrm{basis}}^{(2)}, \\ldots, \\Delta_{\\mathrm{FF}}^{(5)}, \\Delta_{\\mathrm{basis}}^{(5)}].\n$$", "solution": "所述问题是计算量子化学中一个科学上合理且适定的练习。它要求在一个截断基组内，使用两种标准方法——微扰理论和有限场方法——计算一维非谐振子模型的静态偶极极化率。所有参数和步骤都已明确定义，从而可以得到唯一且可验证的解。我们将着手进行推导与实现。\n\n该物理系统由以下原子单位下的哈密顿量描述：\n$$\n\\hat{H}(F) = \\frac{\\hat{p}^2}{2} + \\frac{1}{2}\\,\\omega^2 \\hat{x}^2 + \\lambda \\hat{x}^4 - F \\hat{x}\n$$\n其中 $F$ 是静电场的大小。静态极化率 $\\alpha$ 通过基态能量 $E(F)$ 在 $F=0$ 附近的泰勒展开定义：\n$$\nE(F) = E(0) - \\mu F - \\frac{1}{2}\\alpha F^2 + \\mathcal{O}(F^3)\n$$\n由此可见，$\\alpha = -\\left.\\dfrac{d^2 E}{dF^2}\\right|_{F=0}$。我们的任务是使用一个维度为 $N$ 的截断基组来计算 $\\alpha$。\n\n**1. 基组与算符表示**\n\n我们使用一个截断基组，它由频率为 $\\omega_b$ 的参考谐振子的前 $N$ 个数态 $\\{\\lvert n \\rangle\\}_{n=0}^{N-1}$ 组成。这些态是归一正交的，$\\langle m | n \\rangle = \\delta_{mn}$。\n\n位置算符 $\\hat{x}$ 用此参考谐振子的阶梯算符 $\\hat{a}$ 和 $\\hat{a}^\\dagger$ 表示：\n$$\n\\hat{x} = \\sqrt{\\frac{1}{2\\omega_b}} (\\hat{a} + \\hat{a}^\\dagger)\n$$\n在此基组中，阶梯算符的矩阵元是众所周知的：\n$$\n\\langle m | \\hat{a} | n \\rangle = \\sqrt{n}\\,\\delta_{m,n-1}\n$$\n$$\n\\langle m | \\hat{a}^\\dagger | n \\rangle = \\sqrt{n+1}\\,\\delta_{m,n+1}\n$$\n由此，我们构建 $\\hat{a}$ 和 $\\hat{a}^\\dagger$ 的 $N \\times N$ 矩阵表示，并随后构建 $\\hat{x}$ 的矩阵 $\\mathbf{X}$。\n\n**2. 哈密顿矩阵的构建**\n\n动能算符 $\\frac{\\hat{p}^2}{2}$ 通过恒等式 $\\frac{\\hat{p}^2}{2} = \\hat{H}_b - \\frac{1}{2}\\omega_b^2 \\hat{x}^2$ 与参考谐振子哈密顿量 $\\hat{H}_b = \\omega_b(\\hat{a}^\\dagger\\hat{a} + \\frac{1}{2})$ 相关联。将此代入无场哈密顿量 $\\hat{H}(0)$ 的表达式中，得到：\n$$\n\\hat{H}(0) = \\left(\\hat{H}_b - \\frac{1}{2}\\omega_b^2 \\hat{x}^2\\right) + \\frac{1}{2}\\omega^2 \\hat{x}^2 + \\lambda \\hat{x}^4 = \\hat{H}_b + \\frac{1}{2}(\\omega^2 - \\omega_b^2)\\hat{x}^2 + \\lambda \\hat{x}^4\n$$\n问题指定 $\\omega = \\omega_b = 0.7$ a.u.，这使得表达式极大简化为：\n$$\n\\hat{H}(0) = \\hat{H}_b + \\lambda \\hat{x}^4\n$$\n$\\hat{H}_b$ 的矩阵（表示为 $\\mathbf{H}_b$）在数态基下是对角的，其矩阵元为 $(\\mathbf{H}_b)_{nn} = \\omega_b(n + \\frac{1}{2})$。$\\hat{x}^4$ 的矩阵（表示为 $\\mathbf{X}^4$）是通过将 $\\mathbf{X}$ 自身进行四次显式矩阵乘法得到的。因此，无场哈密顿矩阵为 $\\mathbf{H}(0) = \\mathbf{H}_b + \\lambda \\mathbf{X}^4$。那么，在电场 $F$ 存在时的完整哈密顿量由如下矩阵表示：\n$$\n\\mathbf{H}(F) = \\mathbf{H}(0) - F\\mathbf{X}\n$$\n由于这些矩阵是实对称的，它们的本征值是实数，其本征矢量构成一个归一正交基。\n\n**3. 解析导数极化率：$\\alpha_{\\mathrm{analytic}}(N)$**\n\n此方法使用不含时的非简并 Rayleigh-Schrödinger 微扰理论。我们将 $\\hat{H}(0)$ 视为未扰哈密顿量，将 $\\hat{V} = -F\\hat{x}$ 视为微扰。对基态能量 $E_0^{(0)}$ 的二阶修正由下式给出：\n$$\nE^{(2)} = \\sum_{k \\neq 0} \\frac{|\\langle\\psi_k^{(0)}| \\hat{V} |\\psi_0^{(0)}\\rangle|^2}{E_0^{(0)} - E_k^{(0)}} = F^2 \\sum_{k \\neq 0} \\frac{|\\langle\\psi_k^{(0)}| \\hat{x} |\\psi_0^{(0)}\\rangle|^2}{E_0^{(0)} - E_k^{(0)}}\n$$\n其中 $\\{E_k^{(0)}, |\\psi_k^{(0)}\\rangle\\}$ 是在大小为 $N$ 的截断基组内计算出的 $\\hat{H}(0)$ 的本征对。将其与能量展开式 $E(F) \\approx E_0^{(0)} + E^{(1)} + E^{(2)}$ 比较，其中由于 $\\hat{H}(0)$ 的对称性，$E^{(1)}=0$。我们识别出 $E^{(2)} = -\\frac{1}{2}\\alpha F^2$。这就得到了极化率的遍历态求和公式：\n$$\n\\alpha_{\\mathrm{analytic}}(N) = 2 \\sum_{k=1}^{N-1} \\frac{|\\langle\\psi_k^{(0)}| \\hat{x} |\\psi_0^{(0)}\\rangle|^2}{E_k^{(0)} - E_0^{(0)}}\n$$\n计算步骤如下：\n1. 构建 $N \\times N$ 矩阵 $\\mathbf{H}(0)$。\n2. 数值对角化 $\\mathbf{H}(0)$ 以获得其按能量排序的本征值 $\\{E_k^{(0)}\\}_{k=0}^{N-1}$ 和对应的本征矢量 $\\{|\\psi_k^{(0)}\\rangle\\}_{k=0}^{N-1}$。\n3. 构建矩阵 $\\mathbf{X}$。\n4. 使用计算出的本征值和本征矢量计算求和。矩阵元 $\\langle\\psi_k^{(0)}| \\hat{x} |\\psi_0^{(0)}\\rangle$ 被计算为 $\\mathbf{c}_k^\\intercal \\mathbf{X} \\mathbf{c}_0$，其中 $\\mathbf{c}_k$ 是表示 $|\\psi_k^{(0)}\\rangle$ 的列矢量。\n\n**4. 有限场极化率: $\\alpha_{\\mathrm{finite-field}}(N,F)$**\n\n此方法通过数值近似能量的二阶导数来计算 $\\alpha$。在 $F=0$ 处对 $E''(F)$ 的二阶中心有限差分近似为：\n$$\n\\left.\\frac{d^2E}{dF^2}\\right|_{F=0} \\approx \\frac{E(F) - 2E(0) + E(-F)}{F^2}\n$$\n当 $F=0$ 时，哈密顿量具有对称势，因此其本征态具有确定的宇称。微扰 $-F\\hat{x}$ 是反对称的。因此，哈密顿量 $\\hat{H}(F)$ 和 $\\hat{H}(-F)$ 在宇称算符下是酉等价的，这意味着它们的能谱是相同的。特别地，它们的基态能量相等：$E(F) = E(-F)$。因此，对 $\\alpha$ 的近似简化为：\n$$\n\\alpha_{\\mathrm{finite-field}}(N, F) = -\\frac{E(F) - 2E(0) + E(-F)}{F^2} = -\\frac{2(E(F) - E(0))}{F^2}\n$$\n计算步骤如下：\n1. 构建 $N \\times N$ 矩阵 $\\mathbf{H}(0)$ 并找到其最低本征值 $E(0)$。\n2. 对于一个小的场强 $F$，构建矩阵 $\\mathbf{H}(F) = \\mathbf{H}(0) - F\\mathbf{X}$ 并找到其最低本征值 $E(F)$。\n3. 使用简化公式计算 $\\alpha$。\n\n**5. 参考计算与误差分析**\n\n使用解析方法和一个大的基组大小 $N_{\\mathrm{ref}} = 100$ 计算得到一个高度收敛的参考极化率 $\\alpha_{\\mathrm{ref}}$。该值用作基准。\n\n然后我们为每个测试用例 $(N,F)$ 计算两个误差度量：\n- $\\Delta_{\\mathrm{FF}} = \\alpha_{\\mathrm{analytic}}(N) - \\alpha_{\\mathrm{finite-field}}(N,F)$：它分离出有限差分近似本身的误差，该误差为 $\\mathcal{O}(F^2)$ 阶，再加上二阶微扰理论未包含的高阶电子响应项。它是在固定的基组大小 $N$ 下计算的。\n- $\\Delta_{\\mathrm{basis}} = \\alpha_{\\mathrm{ref}} - \\alpha_{\\mathrm{analytic}}(N)$：它分离出由于大小为 $N$ 的基组不完备性而产生的误差。它比较了从相同微扰理论形式体系推导出的两个结果，两者仅在基组大小上有所不同。\n\n现在将遵循这个完整且经过验证的步骤进行实现。", "answer": "```python\nimport numpy as np\n\ndef build_operators(N, omega_b):\n    \"\"\"\n    Builds matrix representations of a, a_dagger, and x operators.\n    \n    Args:\n        N (int): The size of the truncated harmonic oscillator basis.\n        omega_b (float): The frequency of the reference harmonic oscillator.\n\n    Returns:\n        tuple: Matrices for a, a_dagger, and x.\n    \"\"\"\n    # Annihilation operator\n    a = np.zeros((N, N), dtype=float)\n    for n in range(1, N):\n        a[n - 1, n] = np.sqrt(n)\n\n    # Creation operator\n    a_dag = a.T\n\n    # Position operator\n    x_mat = np.sqrt(1.0 / (2.0 * omega_b)) * (a + a_dag)\n    \n    return a, a_dag, x_mat\n\ndef get_hamiltonian_matrix(N, omega, lambda_, omega_b, x_mat):\n    \"\"\"\n    Builds the field-free Hamiltonian matrix H(0).\n    \n    Args:\n        N (int): The size of the basis.\n        omega (float): Physical frequency parameter.\n        lambda_ (float): Anharmonicity parameter.\n        omega_b (float): Basis frequency.\n        x_mat (np.ndarray): Matrix for the position operator.\n\n    Returns:\n        np.ndarray: The matrix for H(0).\n    \"\"\"\n    # Basis Hamiltonian H_b\n    n_op = np.diag(np.arange(N, dtype=float))\n    h_b = omega_b * (n_op + 0.5 * np.identity(N))\n\n    # x^2 and x^4 matrices\n    x2_mat = x_mat @ x_mat\n    x4_mat = x2_mat @ x2_mat\n\n    # Field-free Hamiltonian H(0)\n    h0_mat = h_b + 0.5 * (omega**2 - omega_b**2) * x2_mat + lambda_ * x4_mat\n    \n    return h0_mat\n\ndef compute_alpha_analytic(N, omega, lambda_, omega_b):\n    \"\"\"\n    Computes polarizability using the sum-over-states formula (perturbation theory).\n    \"\"\"\n    _, _, x_mat = build_operators(N, omega_b)\n    h0_mat = get_hamiltonian_matrix(N, omega, lambda_, omega_b, x_mat)\n\n    # Diagonalize H(0) to get eigenpairs\n    evals, evecs = np.linalg.eigh(h0_mat)\n    E0 = evals[0]\n    psi0 = evecs[:, 0]\n    \n    alpha = 0.0\n    for k in range(1, N):\n        Ek = evals[k]\n        psik = evecs[:, k]\n        \n        matrix_element = psik.T @ x_mat @ psi0\n        alpha += (matrix_element**2) / (Ek - E0)\n        \n    return 2.0 * alpha\n\ndef compute_alpha_finite_field(N, F, omega, lambda_, omega_b):\n    \"\"\"\n    Computes polarizability using the finite-field method.\n    \"\"\"\n    _, _, x_mat = build_operators(N, omega_b)\n    h0_mat = get_hamiltonian_matrix(N, omega, lambda_, omega_b, x_mat)\n\n    # Ground state energy at F=0\n    # Use eigvalsh as we only need the lowest eigenvalue\n    E0 = np.linalg.eigvalsh(h0_mat)[0]\n\n    # Hamiltonian at field F\n    hF_mat = h0_mat - F * x_mat\n\n    # Ground state energy at field F\n    EF = np.linalg.eigvalsh(hF_mat)[0]\n    \n    # Polarizability from central finite difference\n    # Note: E(F) = E(-F) due to symmetry, so the formula simplifies\n    alpha = -2.0 * (EF - E0) / (F**2)\n    \n    return alpha\n\ndef solve():\n    # Fixed physical parameters in atomic units\n    omega = 0.7\n    lambda_ = 0.02\n    omega_b = 0.7\n\n    # Test suite of (N, F) pairs\n    test_cases = [\n        (12, 1e-3),\n        (12, 5e-2),\n        (4, 1e-3),\n        (8, 1e-5),\n        (20, 1e-3),\n    ]\n\n    # Compute reference polarizability with a large basis\n    N_ref = 100\n    alpha_ref = compute_alpha_analytic(N_ref, omega, lambda_, omega_b)\n\n    results = []\n    \n    for N, F in test_cases:\n        # Compute analytic polarizability for the current basis size N\n        alpha_analytic = compute_alpha_analytic(N, omega, lambda_, omega_b)\n\n        # Compute finite-field polarizability for the current N and F\n        alpha_finite_field = compute_alpha_finite_field(N, F, omega, lambda_, omega_b)\n\n        # Calculate the two discrepancy metrics\n        # Delta_FF: Isolates numerical differentiation error\n        delta_ff = alpha_analytic - alpha_finite_field\n        \n        # Delta_basis: Isolates basis set incompleteness error\n        delta_basis = alpha_ref - alpha_analytic\n        \n        results.extend([delta_ff, delta_basis])\n\n    # Format the output as a comma-separated list in brackets\n    print(f\"[{','.join(f'{res:.8e}' for res in results)}]\")\n\nsolve()\n```", "id": "2915784"}]}