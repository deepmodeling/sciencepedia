{"hands_on_practices": [{"introduction": "Slater型轨道 ($Slater-type \\ orbitals$, STO) 为原子轨道的精确描述提供了物理上直观的形式，但其数学上的复杂性给计算带来了挑战。要深入理解STO的特性，第一步是掌握其基础数学属性，其中归一化是确保波函数物理解释有效性的基本要求。这个练习将引导你推导一个通用STO的归一化常数，让你熟练掌握在球坐标下处理指数型函数积分的关键数学技巧。[@problem_id:2924812]", "id": "2924812", "problem": "考虑一个在 $3$ 维空间中归一化的斯莱特型轨道 (STO)，其形式为\n$$\\chi_{n\\ell m}(r,\\theta,\\phi) \\;=\\; \\mathcal{N}\\, r^{\\,n-1}\\, \\exp(-\\zeta r)\\, Y_{\\ell m}(\\theta,\\phi),$$\n其中 $n \\in \\mathbb{R}$ 且 $n>0$，$\\zeta \\in \\mathbb{R}$ 且 $\\zeta>0$，$Y_{\\ell m}(\\theta,\\phi)$ 是一个在单位球面上归一化的球谐函数，使得 $\\int |Y_{\\ell m}(\\theta,\\phi)|^{2}\\, d\\Omega \\;=\\; 1$。归一化常数 $\\mathcal{N}$ 的选择应使得 $\\int_{\\mathbb{R}^{3}} |\\chi_{n\\ell m}(\\mathbf{r})|^{2}\\, d^{3}\\mathbf{r} \\;=\\; 1$。使用欧拉伽马函数的定义 $\\Gamma(s) \\;=\\; \\int_{0}^{\\infty} t^{\\,s-1}\\, \\exp(-t)\\, dt$（其中 $s>0$）作为一个基本工具。\n\n从球坐标系中的归一化定义出发，并仅使用这些基本事实，推导归一化常数 $\\mathcal{N}$ 作为 $n$ 和 $\\zeta$ 的函数的精确封闭形式表达式。以最简形式的单一解析表达式给出你的最终答案。不带单位。不需要进行数值近似。", "solution": "所述问题是量子化学中的一个标准推导，在数学上是适定的，在科学上是有根据的。它没有矛盾或含糊之处。我们将开始推导。\n\n推导的出发点是斯莱特型轨道 (STO) 的归一化条件，该条件要求在 $3$ 维空间中任何位置找到粒子的总概率为1。这表示为：\n$$\n\\int_{\\mathbb{R}^{3}} |\\chi_{n\\ell m}(\\mathbf{r})|^{2}\\, d^{3}\\mathbf{r} = 1\n$$\n在球坐标系中，体积元 $d^{3}\\mathbf{r}$ 为 $r^{2} \\sin\\theta \\, dr \\, d\\theta \\, d\\phi$，可以写成 $r^{2} \\,dr \\,d\\Omega$，其中 $d\\Omega = \\sin\\theta \\,d\\theta \\,d\\phi$ 是立体角元。\n\nSTO 绝对值的平方由下式给出：\n$$\n|\\chi_{n\\ell m}(r,\\theta,\\phi)|^{2} = \\left| \\mathcal{N}\\, r^{n-1}\\, \\exp(-\\zeta r)\\, Y_{\\ell m}(\\theta,\\phi) \\right|^{2}\n$$\n假设归一化常数 $\\mathcal{N}$ 是一个正实数，并注意到 $r$、$n$ 和 $\\zeta$ 都是正实数，上式可简化为：\n$$\n|\\chi_{n\\ell m}(r,\\theta,\\phi)|^{2} = \\mathcal{N}^{2}\\, (r^{n-1})^{2}\\, (\\exp(-\\zeta r))^{2}\\, |Y_{\\ell m}(\\theta,\\phi)|^{2} = \\mathcal{N}^{2}\\, r^{2n-2}\\, \\exp(-2\\zeta r)\\, |Y_{\\ell m}(\\theta,\\phi)|^{2}\n$$\n将此代入归一化积分，我们得到：\n$$\n\\int_{0}^{2\\pi} \\int_{0}^{\\pi} \\int_{0}^{\\infty} \\left( \\mathcal{N}^{2}\\, r^{2n-2}\\, \\exp(-2\\zeta r)\\, |Y_{\\ell m}(\\theta,\\phi)|^{2} \\right) r^{2} \\sin\\theta \\,dr \\,d\\theta \\,d\\phi = 1\n$$\n常数 $\\mathcal{N}^{2}$ 可以从积分中提出。由于函数的可分离性，积分可以分为径向部分（涉及 $r$）和角向部分（涉及 $\\theta$ 和 $\\phi$）。\n$$\n\\mathcal{N}^{2} \\left( \\int_{0}^{\\infty} r^{2n-2}\\, \\exp(-2\\zeta r)\\, r^{2} \\,dr \\right) \\left( \\int_{0}^{2\\pi} \\int_{0}^{\\pi} |Y_{\\ell m}(\\theta,\\phi)|^{2} \\sin\\theta \\,d\\theta \\,d\\phi \\right) = 1\n$$\n简化径向项的被积函数可得 $r^{2n-2+2} = r^{2n}$。角向积分是关于立体角 $d\\Omega$ 的积分。表达式变为：\n$$\n\\mathcal{N}^{2} \\left( \\int_{0}^{\\infty} r^{2n}\\, \\exp(-2\\zeta r) \\,dr \\right) \\left( \\int_{\\text{unit sphere}} |Y_{\\ell m}(\\theta,\\phi)|^{2} \\,d\\Omega \\right) = 1\n$$\n问题陈述中给出球谐函数 $Y_{\\ell m}(\\theta,\\phi)$ 在单位球面上是归一化的，这意味着：\n$$\n\\int |Y_{\\ell m}(\\theta,\\phi)|^{2}\\, d\\Omega \\;=\\; 1\n$$\n因此，我们的归一化方程简化为求解径向积分：\n$$\n\\mathcal{N}^{2} \\int_{0}^{\\infty} r^{2n}\\, \\exp(-2\\zeta r) \\,dr = 1\n$$\n将此积分记为 $I$。为了求解 $I = \\int_{0}^{\\infty} r^{2n}\\, \\exp(-2\\zeta r) \\,dr$，我们进行变量替换，以匹配欧拉伽马函数 $\\Gamma(s) = \\int_{0}^{\\infty} t^{s-1}\\, \\exp(-t)\\, dt$ 的形式。\n令 $t = 2\\zeta r$。这意味着 $r = \\frac{t}{2\\zeta}$ 且 $dr = \\frac{1}{2\\zeta} dt$。积分上下限保持不变，仍为从 $t=0$ 到 $t=\\infty$。\n将这些代入积分 $I$ 中：\n$$\nI = \\int_{0}^{\\infty} \\left(\\frac{t}{2\\zeta}\\right)^{2n} \\exp(-t) \\left(\\frac{1}{2\\zeta} dt\\right)\n$$\n我们重新整理各项并提出常数：\n$$\nI = \\frac{1}{(2\\zeta)^{2n}} \\frac{1}{2\\zeta} \\int_{0}^{\\infty} t^{2n} \\exp(-t) \\,dt = \\frac{1}{(2\\zeta)^{2n+1}} \\int_{0}^{\\infty} t^{2n} \\exp(-t) \\,dt\n$$\n剩余的积分具有伽马函数 $\\Gamma(s)$ 的形式，其中 $s-1 = 2n$，这意味着 $s = 2n+1$。由于题目说明 $n>0$，我们有 $2n+1 > 1$，因此伽马函数是良定义的。\n$$\n\\int_{0}^{\\infty} t^{2n} \\exp(-t) \\,dt = \\Gamma(2n+1)\n$$\n因此，径向积分 $I$ 为：\n$$\nI = \\frac{\\Gamma(2n+1)}{(2\\zeta)^{2n+1}}\n$$\n将此结果代回归一化方程：\n$$\n\\mathcal{N}^{2} \\left( \\frac{\\Gamma(2n+1)}{(2\\zeta)^{2n+1}} \\right) = 1\n$$\n解出 $\\mathcal{N}^{2}$：\n$$\n\\mathcal{N}^{2} = \\frac{(2\\zeta)^{2n+1}}{\\Gamma(2n+1)}\n$$\n对归一化常数取正平方根：\n$$\n\\mathcal{N} = \\sqrt{\\frac{(2\\zeta)^{2n+1}}{\\Gamma(2n+1)}} = \\frac{\\left((2\\zeta)^{2n+1}\\right)^{1/2}}{\\left(\\Gamma(2n+1)\\right)^{1/2}} = \\frac{(2\\zeta)^{n + 1/2}}{\\sqrt{\\Gamma(2n+1)}}\n$$\n这就是归一化常数 $\\mathcal{N}$ 作为参数 $n$ 和 $\\zeta$ 的函数的最终封闭形式表达式。", "answer": "$$\\boxed{\\frac{(2\\zeta)^{n + \\frac{1}{2}}}{\\sqrt{\\Gamma(2n+1)}}}$$"}, {"introduction": "尽管STO在物理上更为精确，但现代量子化学计算广泛使用高斯型轨道 ($Gaussian-type \\ orbitals$, GTO) 的线性组合来近似它们，以简化积分计算。一个关键的挑战是如何用没有径向节点的简单GTO来构建具有正确节点结构的更高级原子轨道（如$2s$、$3p$等）。此练习通过构建一个类$2s$轨道，让你亲身体验基组构建的核心思想，即如何通过施加正交性条件来确定高斯函数的组合系数，从而生成具有正确物理特征的轨道。[@problem_id:1395748]", "id": "1395748", "problem": "在计算量子化学中，斯莱特型轨道 (STO) 能够精确地表示原子波函数，但会导致计算量巨大的积分。为了克服这一难题，STO 通常被近似为高斯型轨道 (GTO) 的线性组合。对于1s壳层以上的原子轨道，一个基本特征是存在一个或多个径向节。\n\n考虑一个试探波函数 $\\Psi(\\vec{r})$，它通过以原点为中心的两个原初s型高斯轨道 (GTO) 的线性组合来近似一个类2s轨道。该波函数的未归一化径向部分由下式给出：\n$$ \\psi(r) = c_1 \\exp(-\\alpha_1 r^2) + c_2 \\exp(-\\alpha_2 r^2) $$\n此处，$r$ 是离原子核的径向距离，$c_1$ 和 $c_2$ 是实值线性组合系数，而 $\\alpha_1$ 和 $\\alpha_2$ 是正实值轨道指数，它们决定了高斯函数的宽度。不失一般性地，假设 $\\alpha_1 > \\alpha_2 > 0$，这意味着第一个高斯函数更“紧凑”，而第二个更“弥散”。\n\n为使 $\\psi(r)$ 能正确表示一个类2s轨道，它必须拥有一个径向节。这可以通过将其构造为与相应的类1s轨道正交来实现，而类1s轨道由基组中最弥散的原初高斯轨道模拟。请推导系数与指数之间必须满足的特定代数关系，即找出比率 $c_1/c_2$ 作为 $\\alpha_1$ 和 $\\alpha_2$ 的函数。", "solution": "为了强制一个类2s轨道具有径向节，该试探函数必须与由最弥散的原初GTO模拟的类1s轨道正交。当 $\\alpha_{1}>\\alpha_{2}>0$ 时，类1s轨道（在归一化因子之外）由 $\\exp(-\\alpha_{2} r^{2})$ 表示。正交条件是全空间上的重叠积分为零：\n$$\n\\int \\psi(\\vec{r})\\,\\exp(-\\alpha_{2} r^{2})\\,d^{3}r=0.\n$$\n将 $\\psi(\\vec{r})=c_{1}\\exp(-\\alpha_{1} r^{2})+c_{2}\\exp(-\\alpha_{2} r^{2})$ 代入，上式变为\n$$\nc_{1}\\int \\exp\\!\\big(-( \\alpha_{1}+\\alpha_{2}) r^{2}\\big)\\,d^{3}r+c_{2}\\int \\exp\\!\\big(-2\\alpha_{2} r^{2}\\big)\\,d^{3}r=0.\n$$\n使用标准的三维高斯积分\n$$\n\\int \\exp(-\\beta r^{2})\\,d^{3}r=\\pi^{3/2}\\beta^{-3/2}\\quad (\\beta>0),\n$$\n正交条件简化为\n$$\nc_{1}\\,\\pi^{3/2}(\\alpha_{1}+\\alpha_{2})^{-3/2}+c_{2}\\,\\pi^{3/2}(2\\alpha_{2})^{-3/2}=0.\n$$\n消去公因子 $\\pi^{3/2}$ 并求解比率 $c_{1}/c_{2}$，可得\n$$\n\\frac{c_{1}}{c_{2}}=-\\frac{(2\\alpha_{2})^{-3/2}}{(\\alpha_{1}+\\alpha_{2})^{-3/2}}=-\\left(\\frac{\\alpha_{1}+\\alpha_{2}}{2\\alpha_{2}}\\right)^{3/2}.\n$$\n系数和指数之间的这个代数关系确保了 $\\psi$ 与类1s轨道正交，因此具有类2s轨道所要求的径向节。", "answer": "$$\\boxed{-\\left(\\frac{\\alpha_{1}+\\alpha_{2}}{2\\alpha_{2}}\\right)^{3/2}}$$"}, {"introduction": "在量子化学计算中，双电子排斥积分 ($electron \\ repulsion \\ integral$, ERI) 的计算是计算量最大、也最核心的部分。高效计算这些海量积分的能力，正是GTO相对于STO的决定性优势所在。这项综合性练习不仅要求你从第一性原理出发，推导四个$s$型GTO之间的ERI解析表达式，还将引导你将其转化为计算机代码，从而将理论知识与实际的编程技能相结合，让你深刻理解Hartree-Fock等从头计算方法的心脏。[@problem_id:2924824]", "id": "2924824", "problem": "考虑四个归一化的 s 型原初高斯型轨道 (GTOs) 在三维欧几里得空间中的电子排斥积分。每个中心位于位置 $\\mathbf{A} \\in \\mathbb{R}^3$、指数为 $\\alpha &gt; 0$ 的 s 型原初 GTO 定义为\n$$\n\\phi_{\\alpha,\\mathbf{A}}(\\mathbf{r}) = N(\\alpha)\\, \\exp\\!\\left(-\\alpha \\lVert \\mathbf{r} - \\mathbf{A} \\rVert^2\\right),\n$$\n其中\n$$\nN(\\alpha) = \\left(\\frac{2\\alpha}{\\pi}\\right)^{3/4}\n$$\n是确保\n$$\n\\int_{\\mathbb{R}^3} \\left|\\phi_{\\alpha,\\mathbf{A}}(\\mathbf{r})\\right|^2 \\, d\\mathbf{r} = 1\n$$\n的归一化常数。\n电子排斥积分是如下的六维库仑积分\n$$\n(\\mu\\nu\\mid\\lambda\\sigma) = \\int_{\\mathbb{R}^3}\\!\\!\\int_{\\mathbb{R}^3} \\phi_{\\alpha_\\mu,\\mathbf{A}}(\\mathbf{r}_1)\\,\\phi_{\\beta_\\nu,\\mathbf{B}}(\\mathbf{r}_1)\\,\\frac{1}{\\lVert \\mathbf{r}_1 - \\mathbf{r}_2 \\rVert}\\,\\phi_{\\gamma_\\lambda,\\mathbf{C}}(\\mathbf{r}_2)\\,\\phi_{\\delta_\\sigma,\\mathbf{D}}(\\mathbf{r}_2)\\, d\\mathbf{r}_1\\, d\\mathbf{r}_2.\n$$\n你可以假定高斯乘积定理，并使用 n 阶 Boys 函数的定义，\n$$\nF_n(T) = \\int_0^1 x^{2n}\\, e^{-T x^2}\\, dx,\n$$\n作为经过充分检验的出发点。基于这些基础和库仑核 $1/\\lVert\\mathbf{r}_1-\\mathbf{r}_2\\rVert$，为四个 s 型原初轨道（即所有四个高斯函数上的角动量均为零）的情况推导 $(\\mu\\nu\\mid\\lambda\\sigma)$ 的解析表达式。你的推导过程应明确地追踪所有的归一化因子。\n\n然后，将此表达式实现为一个程序，对于给定的中心和指数集，以原子单位数值计算 $(\\mu\\nu\\mid\\lambda\\sigma)$。为保证数值稳定性，你的实现应能正确处理 $F_0(T)$ 中 $T \\to 0$ 的情况。\n\n使用以下参数集测试套件，每个参数集指定为 $\\left(\\mathbf{A}, \\alpha, \\mathbf{B}, \\beta, \\mathbf{C}, \\gamma, \\mathbf{D}, \\delta\\right)$，所有位置以玻尔为单位，所有指数以逆平方玻尔为单位：\n- 测试 1 (所有中心重合，指数不同): $\\left(\\,(0,0,0),\\, 0.5,\\, (0,0,0),\\, 0.4,\\, (0,0,0),\\, 0.3,\\, (0,0,0),\\, 0.2\\,\\right)$。\n- 测试 2 (沿正交方向的两对邻近中心): $\\left(\\,(0,0,0),\\, 0.8,\\, (0.5,0,0),\\, 0.7,\\, (0,0.2,0),\\, 0.6,\\, (0.5,0.2,0),\\, 0.5\\,\\right)$。\n- 测试 3 (弥散函数，较大间距): $\\left(\\,(0,0,0),\\, 0.05,\\, (2,0,0),\\, 0.04,\\, (0,2,0),\\, 0.03,\\, (2,2,0),\\, 0.02\\,\\right)$。\n- 测试 4 (紧凑函数，非常接近的中心): $\\left(\\,(0,0,0),\\, 5.0,\\, (0.1,0,0),\\, 6.0,\\, (0,0.1,0),\\, 7.0,\\, (0.1,0.1,0),\\, 8.0\\,\\right)$。\n- 测试 5 (非对称构型): $\\left(\\,(0,0,0),\\, 0.9,\\, (1.2,0.5,-0.3),\\, 1.1,\\, (-0.7,0.4,1.1),\\, 0.6,\\, (0.5,-0.2,0.9),\\, 1.4\\,\\right)$。\n\n要求:\n- 以原子单位实现计算，并将每个结果以原子单位的浮点数形式报告。\n- 程序必须是自包含的，无需输入，并计算上述测试套件的五个值。\n- 你的程序应产生单行输出，包含一个用方括号括起来的逗号分隔的结果列表（例如，$[\\text{result}_1,\\text{result}_2,\\text{result}_3,\\text{result}_4,\\text{result}_5]$）。每个 $\\text{result}_i$ 必须是一个浮点数。你可以假定使用双精度算术。", "solution": "所给出的问题陈述是理论与计算化学中一个标准的、适定的问题。它具有科学依据、是客观的，并包含了进行严谨推导和后续数值实现所需的所有信息。其中没有矛盾、歧义或违反物理原理之处。因此，该问题被认为是有效的，我将着手解答。\n\n任务是推导四个 s 型原初高斯型轨道 (GTOs) 之间的电子排斥积分 (ERI) 的解析表达式，然后对该公式进行数值实现。ERI 由下式给出：\n$$\n(\\mu\\nu\\mid\\lambda\\sigma) = \\int_{\\mathbb{R}^3}\\!\\!\\int_{\\mathbb{R}^3} \\phi_{\\alpha,\\mathbf{A}}(\\mathbf{r}_1)\\,\\phi_{\\beta,\\mathbf{B}}(\\mathbf{r}_1)\\,\\frac{1}{\\lVert \\mathbf{r}_1 - \\mathbf{r}_2 \\rVert}\\,\\phi_{\\gamma,\\mathbf{C}}(\\mathbf{r}_2)\\,\\phi_{\\delta,\\mathbf{D}}(\\mathbf{r}_2)\\, d\\mathbf{r}_1\\, d\\mathbf{r}_2\n$$\n其中每个 GTO 都是一个归一化函数：\n$$\n\\phi_{\\zeta,\\mathbf{Z}}(\\mathbf{r}) = \\left(\\frac{2\\zeta}{\\pi}\\right)^{3/4} \\exp\\!\\left(-\\zeta \\lVert \\mathbf{r} - \\mathbf{Z} \\rVert^2\\right)\n$$\n推导过程分为三个主要阶段：\n1.  应用高斯乘积定理来化简 GTOs 的乘积。\n2.  对得到的关于库仑算符的六维积分进行求值。\n3.  组合所有项，包括归一化常数。\n\n**步骤一：高斯乘积定理**\n两个中心分别位于 $\\mathbf{A}$ 和 $\\mathbf{B}$、指数分别为 $\\alpha$ 和 $\\beta$ 的 s 型 GTO 的乘积可以表示为单个高斯函数。首先，考虑指数部分的乘积：\n$$\n\\exp(-\\alpha \\lVert\\mathbf{r} - \\mathbf{A}\\rVert^2) \\exp(-\\beta \\lVert\\mathbf{r} - \\mathbf{B}\\rVert^2) = \\exp(-\\alpha(\\mathbf{r}-\\mathbf{A})\\cdot(\\mathbf{r}-\\mathbf{A}) - \\beta(\\mathbf{r}-\\mathbf{B})\\cdot(\\mathbf{r}-\\mathbf{B}))\n$$\n通过展开平方项并对变量 $\\mathbf{r}$ 配方，我们得到：\n$$\n\\exp(-\\alpha \\lVert\\mathbf{r} - \\mathbf{A}\\rVert^2) \\exp(-\\beta \\lVert\\mathbf{r} - \\mathbf{B}\\rVert^2) = \\exp\\left(-\\frac{\\alpha\\beta}{\\alpha+\\beta}\\lVert\\mathbf{A}-\\mathbf{B}\\rVert^2\\right) \\exp\\left(-(\\alpha+\\beta)\\left\\lVert\\mathbf{r} - \\frac{\\alpha\\mathbf{A}+\\beta\\mathbf{B}}{\\alpha+\\beta}\\right\\rVert^2\\right)\n$$\n这就是高斯乘积定理。让我们为乘积分布定义新的参数：\n- 组合指数: $p = \\alpha+\\beta$\n- 新中心: $\\mathbf{P} = \\frac{\\alpha\\mathbf{A}+\\beta\\mathbf{B}}{p}$\n- 来自中心间距的前因子: $K_{AB} = \\exp\\left(-\\frac{\\alpha\\beta}{p}\\lVert\\mathbf{A}-\\mathbf{B}\\rVert^2\\right)$\n\n两个归一化的 GTO $\\phi_{\\alpha,\\mathbf{A}}(\\mathbf{r}_1)\\phi_{\\beta,\\mathbf{B}}(\\mathbf{r}_1)$ 的乘积是一个中心在 $\\mathbf{P}$、指数为 $p$ 的未归一化的高斯函数，再乘以归一化常数和因子 $K_{AB}$：\n$$\n\\phi_{\\alpha,\\mathbf{A}}(\\mathbf{r}_1)\\phi_{\\beta,\\mathbf{B}}(\\mathbf{r}_1) = N(\\alpha)N(\\beta) K_{AB} \\exp(-p \\lVert\\mathbf{r}_1-\\mathbf{P}\\rVert^2)\n$$\n类似地，对于依赖于 $\\mathbf{r}_2$ 的 GTOs：\n- 组合指数: $q = \\gamma+\\delta$\n- 新中心: $\\mathbf{Q} = \\frac{\\gamma\\mathbf{C}+\\delta\\mathbf{D}}{q}$\n- 来自中心间距的前因子: $K_{CD} = \\exp\\left(-\\frac{\\gamma\\delta}{q}\\lVert\\mathbf{C}-\\mathbf{D}\\rVert^2\\right)$\n其乘积为：\n$$\n\\phi_{\\gamma,\\mathbf{C}}(\\mathbf{r}_2)\\phi_{\\delta,\\mathbf{D}}(\\mathbf{r}_2) = N(\\gamma)N(\\delta) K_{CD} \\exp(-q \\lVert\\mathbf{r}_2-\\mathbf{Q}\\rVert^2)\n$$\n将这些代入 ERI 表达式，我们将常数从积分中分离出来：\n$$\n(\\mu\\nu\\mid\\lambda\\sigma) = N(\\alpha)N(\\beta)N(\\gamma)N(\\delta) K_{AB} K_{CD} \\int_{\\mathbb{R}^3}\\!\\!\\int_{\\mathbb{R}^3} \\exp(-p\\lVert\\mathbf{r}_1-\\mathbf{P}\\rVert^2) \\frac{1}{\\lVert\\mathbf{r}_1-\\mathbf{r}_2\\rVert} \\exp(-q\\lVert\\mathbf{r}_2-\\mathbf{Q}\\rVert^2) \\, d\\mathbf{r}_1 d\\mathbf{r}_2\n$$\n让我们将剩余的积分记为 $I_{rep}$：\n$$\nI_{rep} = \\int_{\\mathbb{R}^3}\\!\\!\\int_{\\mathbb{R}^3} \\exp(-p\\lVert\\mathbf{r}_1-\\mathbf{P}\\rVert^2) \\frac{1}{\\lVert\\mathbf{r}_1-\\mathbf{r}_2\\rVert} \\exp(-q\\lVert\\mathbf{r}_2-\\mathbf{Q}\\rVert^2) \\, d\\mathbf{r}_1 d\\mathbf{r}_2\n$$\n该积分表示中心分别位于 $\\mathbf{P}$ 和 $\\mathbf{Q}$ 的两个未归一化的球形高斯电荷分布之间的经典库仑排斥能。\n\n**步骤二：排斥积分的求值**\n这是一个标准积分，可以用多种方法求值。一种稳健的方法是利用库仑算符 $1/r_{12}$ 的积分表示，即通过其傅里叶变换。根据帕塞瓦尔定理，该积分可以在倒易空间中写为：\n$$\nI_{rep} = \\frac{1}{(2\\pi)^3} \\int_{\\mathbb{R}^3} \\tilde{\\rho}_p(\\mathbf{k})^* \\tilde{V}(\\mathbf{k}) \\tilde{\\rho}_q(\\mathbf{k}) \\, d\\mathbf{k}\n$$\n其中 $\\tilde{\\rho}_p(\\mathbf{k})$ 和 $\\tilde{\\rho}_q(\\mathbf{k})$ 分别是高斯电荷分布 $\\rho_p(\\mathbf{r}_1) = \\exp(-p\\lVert\\mathbf{r}_1-\\mathbf{P}\\rVert^2)$ 和 $\\rho_q(\\mathbf{r}_2) = \\exp(-q\\lVert\\mathbf{r}_2-\\mathbf{Q}\\rVert^2)$ 的傅里叶变换。\n一般高斯函数的傅里叶变换为：\n$$\n\\int_{\\mathbb{R}^3} \\exp(-\\zeta\\lVert\\mathbf{r}-\\mathbf{Z}\\rVert^2) e^{i\\mathbf{k}\\cdot\\mathbf{r}} \\, d\\mathbf{r} = \\left(\\frac{\\pi}{\\zeta}\\right)^{3/2} \\exp\\left(-\\frac{k^2}{4\\zeta}\\right) e^{i\\mathbf{k}\\cdot\\mathbf{Z}}\n$$\n应用此公式，我们得到：\n$$\n\\tilde{\\rho}_p(\\mathbf{k}) = \\left(\\frac{\\pi}{p}\\right)^{3/2} \\exp\\left(-\\frac{k^2}{4p}\\right) e^{i\\mathbf{k}\\cdot\\mathbf{P}} \\quad \\text{和} \\quad \\tilde{\\rho}_q(\\mathbf{k}) = \\left(\\frac{\\pi}{q}\\right)^{3/2} \\exp\\left(-\\frac{k^2}{4q}\\right) e^{i\\mathbf{k}\\cdot\\mathbf{Q}}\n$$\n将这些代入倒易空间积分：\n$$\nI_{rep} = \\frac{1}{8\\pi^3} \\int \\left(\\frac{\\pi}{p}\\right)^{3/2} e^{-\\frac{k^2}{4p}} e^{-i\\mathbf{k}\\cdot\\mathbf{P}} \\cdot \\frac{4\\pi}{k^2} \\cdot \\left(\\frac{\\pi}{q}\\right)^{3/2} e^{-\\frac{k^2}{4q}} e^{i\\mathbf{k}\\cdot\\mathbf{Q}} \\, d\\mathbf{k}\n$$\n$$\nI_{rep} = \\frac{\\pi^3}{8\\pi^3(pq)^{3/2}} (4\\pi) \\int \\frac{1}{k^2} \\exp\\left(-\\left(\\frac{1}{4p}+\\frac{1}{4q}\\right)k^2\\right) e^{i\\mathbf{k}\\cdot(\\mathbf{Q}-\\mathbf{P})} \\, d\\mathbf{k}\n$$\n令 $\\mathbf{R}_{PQ} = \\mathbf{P}-\\mathbf{Q}$ 和 $\\zeta = \\frac{1}{4p}+\\frac{1}{4q} = \\frac{p+q}{4pq}$。积分简化为：\n$$\nI_{rep} = \\frac{\\pi}{2(pq)^{3/2}} \\int \\frac{e^{-\\zeta k^2}}{k^2} e^{-i\\mathbf{k}\\cdot\\mathbf{R}_{PQ}} \\, d\\mathbf{k}\n$$\n剩余的积分是 $e^{-\\zeta k^2}/k^2$ 的傅里叶逆变换。其值已知为 $\\frac{\\pi \\text{erf}(\\lVert\\mathbf{R}_{PQ}\\rVert / (2\\sqrt{\\zeta}))}{\\lVert\\mathbf{R}_{PQ}\\rVert}$。不，这是不正确的。积分 $\\int \\frac{e^{-\\zeta k^2}}{k^2}e^{i\\mathbf{k}\\cdot\\mathbf{R}}d\\mathbf{k}$ 的值为 $\\frac{2\\pi^2}{\\lVert\\mathbf{R}\\rVert}\\text{erf}\\left(\\frac{\\lVert\\mathbf{R}\\rVert}{2\\sqrt{\\zeta}}\\right)$。\n$$\nI_{rep} = \\frac{\\pi}{2(pq)^{3/2}} \\cdot \\frac{2\\pi^2}{\\lVert\\mathbf{R}_{PQ}\\rVert} \\text{erf}\\left(\\frac{\\lVert\\mathbf{R}_{PQ}\\rVert}{2\\sqrt{\\zeta}}\\right) = \\frac{\\pi^3}{(pq)^{3/2}\\lVert\\mathbf{R}_{PQ}\\rVert} \\text{erf}\\left(\\lVert\\mathbf{R}_{PQ}\\rVert\\sqrt{\\frac{pq}{p+q}}\\right)\n$$\n我们现在将其与 Boys 函数 $F_n(T) = \\int_0^1 x^{2n} e^{-Tx^2} dx$ 联系起来。对于 $n=0$，我们有其与误差函数的关系：$F_0(T) = \\frac{\\sqrt{\\pi}}{2\\sqrt{T}}\\text{erf}(\\sqrt{T})$。\n令 $T = \\frac{pq}{p+q}\\lVert\\mathbf{P}-\\mathbf{Q}\\rVert^2$。那么 $\\sqrt{T} = \\lVert\\mathbf{R}_{PQ}\\rVert\\sqrt{\\frac{pq}{p+q}}$。\n因此，$\\text{erf}(\\sqrt{T}) = \\frac{2\\sqrt{T}}{\\sqrt{\\pi}}F_0(T)$。\n将此代入 $I_{rep}$ 的表达式中：\n$$\nI_{rep} = \\frac{\\pi^3}{(pq)^{3/2}\\lVert\\mathbf{R}_{PQ}\\rVert} \\frac{2\\sqrt{T}}{\\sqrt{\\pi}}F_0(T) = \\frac{2\\pi^{5/2}}{(pq)^{3/2}\\lVert\\mathbf{R}_{PQ}\\rVert} \\left(\\lVert\\mathbf{R}_{PQ}\\rVert\\sqrt{\\frac{pq}{p+q}}\\right) F_0(T) = \\frac{2\\pi^{5/2}}{pq\\sqrt{p+q}}F_0(T)\n$$\n这便是两个未归一化的高斯乘积分布之间的排斥积分的最终表达式。\n\n**步骤三：组合最终表达式**\n总 ERI 是归一化常数、$K$ 因子和 $I_{rep}$ 的乘积。\n组合的归一化因子是：\n$$\nN_{total} = N(\\alpha)N(\\beta)N(\\gamma)N(\\delta) = \\left(\\frac{2\\alpha}{\\pi}\\right)^{3/4}\\left(\\frac{2\\beta}{\\pi}\\right)^{3/4}\\left(\\frac{2\\gamma}{\\pi}\\right)^{3/4}\\left(\\frac{2\\delta}{\\pi}\\right)^{3/4} = \\left(\\frac{16\\alpha\\beta\\gamma\\delta}{\\pi^4}\\right)^{3/4} = \\frac{8(\\alpha\\beta\\gamma\\delta)^{3/4}}{\\pi^3}\n$$\n组合所有部分：\n$$\n(\\mu\\nu\\mid\\lambda\\sigma) = N_{total} \\cdot K_{AB} \\cdot K_{CD} \\cdot I_{rep}\n$$\n$$\n(\\mu\\nu\\mid\\lambda\\sigma) = \\frac{8(\\alpha\\beta\\gamma\\delta)^{3/4}}{\\pi^3} \\cdot K_{AB} K_{CD} \\cdot \\frac{2\\pi^{5/2}}{pq\\sqrt{p+q}} F_0(T)\n$$\n化简 $\\pi$ 的幂次：\n$$\n(\\mu\\nu\\mid\\lambda\\sigma) = \\frac{16(\\alpha\\beta\\gamma\\delta)^{3/4}}{\\sqrt{\\pi}pq\\sqrt{p+q}} K_{AB} K_{CD} F_0\\left(\\frac{pq}{p+q}\\lVert\\mathbf{P}-\\mathbf{Q}\\rVert^2\\right)\n$$\n这就是四个归一化的 s 型 GTO 之间 ERI 的最终解析表达式。\n\n**关于 $F_0(T)$ 的数值考量**\n对于小的 $T$ 值（例如 $T \\to 0$），表达式 $F_0(T) = \\frac{\\sqrt{\\pi}}{2\\sqrt{T}}\\text{erf}(\\sqrt{T})$ 会因为除以一个小数而变得数值不稳定。在此极限下，我们可以使用 $F_0(T)$ 定义中指数的泰勒级数展开：\n$$\nF_0(T) = \\int_0^1 \\left(1 - Tx^2 + \\frac{T^2x^4}{2} - \\frac{T^3x^6}{6} + \\dots\\right) dx = 1 - \\frac{T}{3} + \\frac{T^2}{10} - \\frac{T^3}{42} + O(T^4)\n$$\n该展开式为小 $T$ 提供了精确的结果。对于较大的 $T$，基于 `erf` 的公式是稳定且高效的。可以使用一个阈值（例如 $T < 10^{-8}$）在这两种求值方法之间切换。\n\n实现将计算参数 $p, q, \\mathbf{P}, \\mathbf{Q}, K_{AB}, K_{CD}, T$，数值求值 $F_0(T)$，然后使用推导出的公式组合出最终结果。", "answer": "```python\nimport numpy as np\nfrom scipy.special import erf\n\ndef solve():\n    \"\"\"\n    Computes the electron repulsion integral for four s-type Gaussian orbitals\n    for a given set of test cases.\n    \"\"\"\n\n    def boys_f0(T):\n        \"\"\"\n        Computes the Boys function F_0(T) with numerical stability for small T.\n        F_0(T) = integral from 0 to 1 of exp(-T*x^2) dx.\n        \"\"\"\n        if T < 1e-8:\n            # Taylor series expansion for small T to avoid numerical instability\n            # F_0(T) = 1 - T/3 + T^2/10 - T^3/42 + T^4/216 - ...\n            return 1.0 - T / 3.0 + T**2 / 10.0 - T**3 / 42.0\n        else:\n            # Standard formula using the error function for larger T\n            # F_0(T) = 0.5 * sqrt(pi/T) * erf(sqrt(T))\n            return 0.5 * np.sqrt(np.pi / T) * erf(np.sqrt(T))\n\n    def compute_eri_ssss(A, alpha, B, beta, C, gamma, D, delta):\n        \"\"\"\n        Calculates the electron repulsion integral (ab|cd) for four\n        normalized s-type primitive Gaussian-type orbitals.\n\n        Args:\n            A, B, C, D (np.ndarray): 3D coordinates of the centers.\n            alpha, beta, gamma, delta (float): Exponents of the GTOs.\n\n        Returns:\n            float: The value of the electron repulsion integral in atomic units.\n        \"\"\"\n        # Convert inputs to numpy arrays for vector operations\n        A, B, C, D = map(np.array, [A, B, C, D])\n\n        # Step 1: Combine exponents and centers from Gaussian Product Theorem\n        p = alpha + beta\n        q = gamma + delta\n\n        P = (alpha * A + beta * B) / p\n        Q = (gamma * C + delta * D) / q\n\n        # Step 2: Compute prefactors from center separations\n        norm_A_minus_B_sq = np.linalg.norm(A - B)**2\n        K_ab = np.exp(-alpha * beta / p * norm_A_minus_B_sq)\n\n        norm_C_minus_D_sq = np.linalg.norm(C - D)**2\n        K_cd = np.exp(-gamma * delta / q * norm_C_minus_D_sq)\n\n        # Step 3: Compute the argument for the Boys function\n        norm_P_minus_Q_sq = np.linalg.norm(P - Q)**2\n        T = (p * q / (p + q)) * norm_P_minus_Q_sq\n\n        # Step 4: Evaluate the Boys function F_0(T)\n        F0_T = boys_f0(T)\n\n        # Step 5: Assemble the final expression for the ERI\n        # Formula derived in the solution:\n        # (ab|cd) = (16 * (alpha*beta*gamma*delta)**(3/4)) / (sqrt(pi) * p*q*sqrt(p+q)) * K_ab * K_cd * F_0(T)\n        \n        numerator = 16.0 * (alpha * beta * gamma * delta)**0.75\n        denominator = np.sqrt(np.pi) * p * q * np.sqrt(p + q)\n        \n        prefactor = numerator / denominator\n\n        eri_value = prefactor * K_ab * K_cd * F0_T\n\n        return eri_value\n\n    # Test cases defined in the problem statement.\n    # Each case: (A, alpha, B, beta, C, gamma, D, delta)\n    test_cases = [\n        # Test 1\n        ((0,0,0), 0.5, (0,0,0), 0.4, (0,0,0), 0.3, (0,0,0), 0.2),\n        # Test 2\n        ((0,0,0), 0.8, (0.5,0,0), 0.7, (0,0.2,0), 0.6, (0.5,0.2,0), 0.5),\n        # Test 3\n        ((0,0,0), 0.05, (2,0,0), 0.04, (0,2,0), 0.03, (2,2,0), 0.02),\n        # Test 4\n        ((0,0,0), 5.0, (0.1,0,0), 6.0, (0,0.1,0), 7.0, (0.1,0.1,0), 8.0),\n        # Test 5\n        ((0,0,0), 0.9, (1.2,0.5,-0.3), 1.1, (-0.7,0.4,1.1), 0.6, (0.5,-0.2,0.9), 1.4)\n    ]\n\n    results = []\n    for params in test_cases:\n        result = compute_eri_ssss(*params)\n        results.append(result)\n        \n    # Format the final output as a comma-separated list in brackets.\n    # Using a general format specifier to avoid trailing zeros where not needed.\n    # Using repr() to ensure machine-readable precision as produced by double-precision floats.\n    results_str = [repr(r) for r in results]\n    print(f\"[{','.join(results_str)}]\")\n\nsolve()\n```"}]}