{"hands_on_practices": [{"introduction": "在平均场理论中，单斯莱特行列式是描述电子态的基本构件。然而，对于开壳层体系，一个直观的构想——例如将一个 $\\alpha$ 自旋电子和一个 $\\beta$ 自旋电子分别置于不同的空间轨道 $\\phi_a$ 和 $\\phi_b$ 中——所构成的行列式通常不再是总自旋平方算符 $\\hat{S}^2$ 的本征态。这项练习将引导你从第一性原理出发，推导 $\\hat{S}^2$ 的期望值，从而定量地理解“自旋污染”的来源，这是掌握开壳层量子化学方法的关键第一步。[@problem_id:2911701]", "problem": "考虑一个由自旋轨道 $\\chi_{a} = \\phi_{a}(\\mathbf{r}) \\alpha(\\omega)$ 和 $\\chi_{b} = \\phi_{b}(\\mathbf{r}) \\beta(\\omega)$ 构建的单 Slater 行列式所描述的双电子体系，其中 $\\phi_a$ 和 $\\phi_b$ 是归一化（但不一定正交）的空间轨道，而 $\\alpha$、$\\beta$ 是通常的自旋函数。设该行列式为\n$$\n\\Psi = \\frac{1}{\\sqrt{2}}\n\\begin{vmatrix}\n\\phi_{a}(1)\\alpha(1)  \\phi_{b}(1)\\beta(1) \\\\\n\\phi_{a}(2)\\alpha(2)  \\phi_{b}(2)\\beta(2)\n\\end{vmatrix}.\n$$\n从双电子自旋的基本定义出发，即总自旋算符 $\\hat{S}^{2} = \\hat{\\mathbf{s}}_{1}^{2} + \\hat{\\mathbf{s}}_{2}^{2} + 2\\,\\hat{\\mathbf{s}}_{1}\\cdot\\hat{\\mathbf{s}}_{2}$，其单电子本征值为 $\\hat{\\mathbf{s}}_{i}^{2}\\alpha = \\frac{3}{4}\\alpha$、$\\hat{\\mathbf{s}}_{i}^{2}\\beta = \\frac{3}{4}\\beta$，以及正交归一的单重态-三重态自旋基，推导该行列式期望值 $\\langle \\hat{S}^{2} \\rangle$ 的解析表达式，用空间轨道交叠\n$$\nS_{ab} \\equiv \\langle \\phi_{a} | \\phi_{b} \\rangle = \\int \\phi_{a}^{*}(\\mathbf{r})\\,\\phi_{b}(\\mathbf{r})\\,d\\mathbf{r}\n$$\n来表示。然后，仅使用第一性原理和你推导出的表达式，确定使得该行列式成为 $\\hat{S}^{2}$ 的本征函数（即自旋纯态）时 $|S_{ab}|$ 的值。请以一个二分量行向量 $(\\langle \\hat{S}^{2} \\rangle,\\; |S_{ab}|_{\\text{spin-pure}})$ 的形式给出你的最终答案。不需要数值近似，也不需要单位。", "solution": "我们从占据自旋轨道 $\\chi_{a} = \\phi_{a}\\alpha$ 和 $\\chi_{b} = \\phi_{b}\\beta$ 的双电子 Slater 行列式的定义开始：\n$$\n\\Psi = \\frac{1}{\\sqrt{2}}\\left[\\phi_{a}(1)\\alpha(1)\\,\\phi_{b}(2)\\beta(2) - \\phi_{a}(2)\\alpha(2)\\,\\phi_{b}(1)\\beta(1)\\right].\n$$\n引入标准的单重态和三重态 ($M_{S}=0$) 自旋函数，\n$$\n\\Omega \\equiv \\frac{1}{\\sqrt{2}}\\left[\\alpha(1)\\beta(2) - \\beta(1)\\alpha(2)\\right], \\qquad\n\\Sigma \\equiv \\frac{1}{\\sqrt{2}}\\left[\\alpha(1)\\beta(2) + \\beta(1)\\alpha(2)\\right],\n$$\n它们是正交归一的，并满足\n$$\n\\hat{S}^{2}\\Omega = 0\\cdot \\Omega, \\qquad \\hat{S}^{2}\\Sigma = 2\\cdot \\Sigma,\n$$\n因为对于双电子体系，单重态的总自旋为 $S=0$，三重态的总自旋为 $S=1$，对应的 $S(S+1)$ 本征值分别为 $0$ 和 $2$。\n\n通过将自旋乘积用 $\\Omega$ 和 $\\Sigma$ 表示来重写行列式：\n\\begin{align*}\n\\alpha(1)\\beta(2) = \\frac{1}{\\sqrt{2}}\\left(\\Sigma + \\Omega\\right), \\\\\n\\beta(1)\\alpha(2) = \\frac{1}{\\sqrt{2}}\\left(\\Sigma - \\Omega\\right).\n\\end{align*}\n代入 $\\Psi$ 并合并对称和反对称的空间组合，我们得到\n\\begin{align*}\n\\Psi = \\frac{1}{\\sqrt{2}}\\left[\\phi_{a}(1)\\phi_{b}(2)\\,\\frac{\\Sigma+\\Omega}{\\sqrt{2}} - \\phi_{b}(1)\\phi_{a}(2)\\,\\frac{\\Sigma-\\Omega}{\\sqrt{2}}\\right] \\\\\n= \\frac{1}{2}\\left[\\left(\\phi_{a}(1)\\phi_{b}(2) - \\phi_{b}(1)\\phi_{a}(2)\\right)\\Sigma + \\left(\\phi_{a}(1)\\phi_{b}(2) + \\phi_{b}(1)\\phi_{a}(2)\\right)\\Omega\\right].\n\\end{align*}\n定义反对称和对称的空间因子\n$$\n\\Phi_{A} \\equiv \\frac{1}{\\sqrt{2}}\\left[\\phi_{a}(1)\\phi_{b}(2) - \\phi_{b}(1)\\phi_{a}(2)\\right], \\qquad\n\\Phi_{S} \\equiv \\frac{1}{\\sqrt{2}}\\left[\\phi_{a}(1)\\phi_{b}(2) + \\phi_{b}(1)\\phi_{a}(2)\\right],\n$$\n使得\n$$\n\\Psi = \\frac{1}{\\sqrt{2}}\\left[\\Phi_{A}\\,\\Sigma + \\Phi_{S}\\,\\Omega\\right].\n$$\n因为 $\\Sigma$ 和 $\\Omega$ 是正交归一的并且具有相反的置换对称性，所以混合内积为零：\n$$\n\\langle \\Phi_{A}\\Sigma | \\Phi_{S}\\Omega \\rangle = 0.\n$$\n$\\Psi$ 的模方为\n$$\n\\langle \\Psi | \\Psi \\rangle = \\frac{1}{2}\\left(\\langle \\Phi_{A}|\\Phi_{A}\\rangle + \\langle \\Phi_{S}|\\Phi_{S}\\rangle\\right).\n$$\n使用归一化的空间轨道和定义 $S_{ab} \\equiv \\langle \\phi_{a}|\\phi_{b}\\rangle$，可以计算出\n\\begin{align*}\n\\langle \\Phi_{A}|\\Phi_{A}\\rangle = \\frac{1}{2}\\left(\\langle ab|ab\\rangle - \\langle ab|ba\\rangle - \\langle ba|ab\\rangle + \\langle ba|ba\\rangle\\right) = 1 - |S_{ab}|^{2}, \\\\\n\\langle \\Phi_{S}|\\Phi_{S}\\rangle = \\frac{1}{2}\\left(\\langle ab|ab\\rangle + \\langle ab|ba\\rangle + \\langle ba|ab\\rangle + \\langle ba|ba\\rangle\\right) = 1 + |S_{ab}|^{2},\n\\end{align*}\n其中 $\\langle ab|ba\\rangle = \\langle \\phi_{a}(1)\\phi_{b}(2)|\\phi_{b}(1)\\phi_{a}(2)\\rangle = S_{ab}S_{ba} = |S_{ab}|^{2}$，并且由于归一化，$\\langle ab|ab\\rangle = \\langle ba|ba\\rangle = 1$。因此，\n$$\n\\langle \\Psi | \\Psi \\rangle = \\frac{1}{2}\\left[(1 - |S_{ab}|^{2}) + (1 + |S_{ab}|^{2})\\right] = 1,\n$$\n这正是一个由正交归一的自旋轨道构建的归一化 Slater 行列式所预期的结果。\n\n$\\hat{S}^{2}$ 的期望值则为\n\\begin{align*}\n\\langle \\hat{S}^{2} \\rangle = \\langle \\Psi | \\hat{S}^{2} | \\Psi \\rangle \\\\\n= \\frac{1}{2}\\left[\\langle \\Phi_{A}\\Sigma | \\hat{S}^{2} | \\Phi_{A}\\Sigma \\rangle + \\langle \\Phi_{S}\\Omega | \\hat{S}^{2} | \\Phi_{S}\\Omega \\rangle\\right] \\\\\n= \\frac{1}{2}\\left[2\\,\\langle \\Phi_{A}|\\Phi_{A}\\rangle + 0\\cdot \\langle \\Phi_{S}|\\Phi_{S}\\rangle\\right] \\\\\n= \\langle \\Phi_{A}|\\Phi_{A}\\rangle \\\\\n= 1 - |S_{ab}|^{2}.\n\\end{align*}\n因此，\n$$\n\\langle \\hat{S}^{2} \\rangle = 1 - |\\langle \\phi_{a}|\\phi_{b}\\rangle|^{2}.\n$$\n\n为了确定行列式何时是自旋纯态（$\\hat{S}^{2}$ 的本征函数），我们注意到一个本征态必须是本征值为 $0$ 的纯单重态，或者是本征值为 $2$ 的纯三重态。从推导出的表达式可知，$\\langle \\hat{S}^{2} \\rangle$ 位于区间 $[0,1]$ 内，因为根据 Cauchy–Schwarz 不等式，$0 \\le |S_{ab}| \\le 1$。因此，该行列式永远无法实现三重态值 $2$；一个纯的 $M_{S}=0$ 三重态需要行列式的自旋匹配线性组合。实现自旋纯的唯一可能性是单重态情况，这要求\n$$\n\\langle \\hat{S}^{2} \\rangle = 0 \\quad \\Longleftrightarrow \\quad 1 - |S_{ab}|^{2} = 0 \\quad \\Longleftrightarrow \\quad |S_{ab}| = 1.\n$$\n对于归一化的轨道，当且仅当 $\\phi_{b} = \\exp(i\\theta)\\,\\phi_{a}$（对于某个实数 $\\theta$）时，即两个空间轨道在相差一个全局相位因子的情况下是相同时，$|S_{ab}| = 1$ 成立。这对应于闭壳层单重态，而不是一个真正的开壳层行列式。因此，除了平凡的闭壳层极限情况外，一个包含一个 $\\alpha$ 电子和一个 $\\beta$ 电子的单开壳层行列式不是自旋纯的。\n\n所要求的二分量最终答案是 $\\langle \\hat{S}^{2} \\rangle$ 的解析表达式和产生自旋纯行列式的 $|S_{ab}|$ 的值：\n$$\n\\left(\\langle \\hat{S}^{2} \\rangle,\\; |S_{ab}|_{\\text{spin-pure}}\\right) = \\left(1 - |S_{ab}|^{2},\\; 1\\right).\n$$", "answer": "$$\\boxed{\\begin{pmatrix}1 - |S_{ab}|^{2}  1\\end{pmatrix}}$$", "id": "2911701"}, {"introduction": "既然我们已经知道简单的开壳层行列式可能存在自旋污染，一个自然的问题是：是否存在重要情况下单个行列式本身就是纯自旋态？一个典型的例子就是用于描述双重态（即含一个未成对电子）体系的限制性开壳层哈特里-福克 (ROHF) 波函数。这项练习要求你通过严格证明，来揭示为何这种特定的波函数构造能够保证其自旋纯粹性，这是ROHF方法在处理此类体系时的一个核心优势。[@problem_id:2911616]", "problem": "考虑一个具有$N_{\\mathrm{c}}$个双占据空间轨道 $\\{\\phi_i\\}_{i=1}^{N_{\\mathrm{c}}}$ 和一个单占据空间轨道 $\\phi_u$ 的$N$-电子限制性开壳层Hartree–Fock (ROHF)参考态。自旋轨道占据为 $\\{\\phi_1\\alpha,\\phi_1\\beta;\\ldots;\\phi_{N_{\\mathrm{c}}}\\alpha,\\phi_{N_{\\mathrm{c}}}\\beta;\\phi_u\\alpha\\}$，因此正好有一个自旋为$\\alpha$的未配对电子。令 $\\lvert \\Phi \\rangle$ 表示相应的Slater行列式。总自旋算符为 $\\hat{S}_x$、$\\hat{S}_y$、$\\hat{S}_z$ 和 $\\hat{S}^2 = \\hat{S}_x^2 + \\hat{S}_y^2 + \\hat{S}_z^2$, 它们由单电子自旋算符构造而成，升降算符为 $\\hat{S}_{\\pm} = \\hat{S}_x \\pm i \\hat{S}_y$。从标准的自旋角动量代数和Slater行列式的反对称性出发。\n\n(a) 证明 $\\lvert \\Phi \\rangle$ 是 $\\hat{S}_z$ 的严格本征函数，其本征值为 $M_S = \\tfrac{1}{2}$，并且它被总自旋升算符湮灭，即 $\\hat{S}_+ \\lvert \\Phi \\rangle = 0$。\n\n(b) 仅使用角动量代数和(a)部分确立的性质，证明 $\\lvert \\Phi \\rangle$ 是 $\\hat{S}^2$ 的严格本征函数，其总自旋为 $S = \\tfrac{1}{2}$。\n\n(c) 显式计算期望值 $\\langle \\Phi \\rvert \\hat{S}^2 \\lvert \\Phi \\rangle$ 以确认其自旋纯度。将最终答案表示为无量纲数 $\\langle \\hat{S}^2 \\rangle / \\hbar^2$。无需四舍五入；以单个数字的形式给出精确值。", "solution": "所述问题是量子化学中关于单行列式波函数自旋性质的一个标准、适定的练习。它具有科学依据、自洽且客观。所有前提和定义均与量子力学和角动量理论的既定原理一致。因此，该问题是有效的，并将提供解答。\n\n总电子数为 $N=2N_{\\mathrm{c}}+1$。自旋为$\\alpha$的电子数为 $N_{\\alpha} = N_{\\mathrm{c}}+1$，自旋为$\\beta$的电子数为 $N_{\\beta} = N_{\\mathrm{c}}$。总自旋算符是单电子算符的和：$\\hat{S}_z = \\sum_{j=1}^{N} \\hat{s}_{z,j}$ 和 $\\hat{S}_{\\pm} = \\sum_{j=1}^{N} \\hat{s}_{\\pm,j}$。\n\n(a) 证明 $\\lvert\\Phi\\rangle$ 是 $\\hat{S}_z$ 的本征函数且被 $\\hat{S}_+$ 湮灭。\n\nSlater行列式是任何可以写成单电子算符之和的算符（例如 $\\hat{S}_z$）的本征函数。总本征值是每个已占据自旋轨道的单电子本征值之和。对于自旋为$\\alpha$的电子，单电子自旋算符 $\\hat{s}_z$ 的本征值为 $+\\frac{1}{2}\\hbar$；对于自旋为$\\beta$的电子，其本征值为 $-\\frac{1}{2}\\hbar$。对于行列式 $\\lvert\\Phi\\rangle$，总的 $\\hat{S}_z$ 本征值为：\n$$ \\hat{S}_z \\lvert\\Phi\\rangle = \\left( \\sum_{j=1}^{N} m_{s,j} \\right) \\hbar \\lvert\\Phi\\rangle = \\left( N_{\\alpha} \\cdot \\left(+\\frac{1}{2}\\right) + N_{\\beta} \\cdot \\left(-\\frac{1}{2}\\right) \\right) \\hbar \\lvert\\Phi\\rangle $$\n代入 $N_{\\alpha}$ 和 $N_{\\beta}$ 的值：\n$$ \\hat{S}_z \\lvert\\Phi\\rangle = \\left( (N_{\\mathrm{c}}+1) \\cdot \\frac{1}{2} - N_{\\mathrm{c}} \\cdot \\frac{1}{2} \\right) \\hbar \\lvert\\Phi\\rangle = \\left( \\frac{N_{\\mathrm{c}}}{2} + \\frac{1}{2} - \\frac{N_{\\mathrm{c}}}{2} \\right) \\hbar \\lvert\\Phi\\rangle = \\frac{1}{2}\\hbar \\lvert\\Phi\\rangle $$\n这证明了 $\\lvert\\Phi\\rangle$ 是 $\\hat{S}_z$ 的本征函数，其量子数为 $M_S = \\frac{1}{2}$。\n\n接下来，我们分析自旋升算符 $\\hat{S}_+ = \\sum_{j=1}^{N} \\hat{s}_{+,j}$ 的作用。单电子算符 $\\hat{s}_+$ 作用在自旋函数上，其结果为 $\\hat{s}_+ \\alpha = 0$ 和 $\\hat{s}_+ \\beta = \\hbar \\alpha$。当 $\\hat{S}_+$ 作用在Slater行列式 $\\lvert\\Phi\\rangle$上时，它会产生一系列行列式的和，其中每一项都是一个电子的自旋被 $\\hat{s}_+$ 作用后的结果。\n$$ \\hat{S}_+ \\lvert\\Phi\\rangle = \\sum_{j=1}^{N} \\hat{s}_{+,j} \\lvert\\Phi\\rangle $$\n如果电子$j$处于一个$\\alpha$自旋的自旋轨道中（例如 $\\phi_k\\alpha$），$\\hat{s}_{+,j}$ 对其作用的结果为零。如果电子$j$处于一个$\\beta$自旋的自旋轨道中（例如 $\\phi_i\\beta$），算符会试图将其自旋翻转为$\\alpha$：$\\hat{s}_{+,j}(\\phi_i\\beta) = \\hbar(\\phi_i\\alpha)$。然而，对于所有双占据轨道 $\\{\\phi_i\\}_{i=1}^{N_{\\mathrm{c}}}$，自旋轨道 $\\phi_i\\alpha$ 在行列式 $\\lvert\\Phi\\rangle$ 中已经被占据。将算符 $\\hat{s}_{+,j}$ 应用于自旋轨道 $\\phi_i\\beta$ 将产生一个新的行列式，其中自旋轨道 $\\phi_i\\alpha$ 出现两次。根据泡利不相容原理，具有两个相同列（或行）的行列式恒等于零。因为所有的$\\beta$自旋都属于双占据空间轨道，所以和中的每一项都为零。\n$$ \\hat{S}_+ \\lvert\\Phi\\rangle = 0 $$\n这就完成了(a)部分的证明。\n\n(b) 证明 $\\lvert\\Phi\\rangle$ 是 $\\hat{S}^2$ 的本征函数。\n\n我们使用角动量算符的基本对易关系，由此得到恒等式 $\\hat{S}^2 = \\hat{S}_- \\hat{S}_+ + \\hat{S}_z^2 + \\hbar \\hat{S}_z$。我们将此算符作用于态 $\\lvert\\Phi\\rangle$：\n$$ \\hat{S}^2 \\lvert\\Phi\\rangle = (\\hat{S}_- \\hat{S}_+ + \\hat{S}_z^2 + \\hbar \\hat{S}_z) \\lvert\\Phi\\rangle $$\n使用(a)部分确立的结果，即 $\\hat{S}_+ \\lvert\\Phi\\rangle = 0$ 和 $\\hat{S}_z \\lvert\\Phi\\rangle = \\frac{1}{2}\\hbar \\lvert\\Phi\\rangle$：\n$$ \\hat{S}^2 \\lvert\\Phi\\rangle = \\hat{S}_- (\\hat{S}_+ \\lvert\\Phi\\rangle) + \\hat{S}_z (\\hat{S}_z \\lvert\\Phi\\rangle) + \\hbar (\\hat{S}_z \\lvert\\Phi\\rangle) $$\n$$ \\hat{S}^2 \\lvert\\Phi\\rangle = \\hat{S}_- (0) + \\hat{S}_z \\left(\\frac{1}{2}\\hbar \\lvert\\Phi\\rangle\\right) + \\hbar \\left(\\frac{1}{2}\\hbar \\lvert\\Phi\\rangle\\right) $$\n$$ \\hat{S}^2 \\lvert\\Phi\\rangle = 0 + \\frac{1}{2}\\hbar (\\hat{S}_z \\lvert\\Phi\\rangle) + \\frac{1}{2}\\hbar^2 \\lvert\\Phi\\rangle $$\n再次代入 $\\hat{S}_z$ 的作用：\n$$ \\hat{S}^2 \\lvert\\Phi\\rangle = \\frac{1}{2}\\hbar \\left(\\frac{1}{2}\\hbar \\lvert\\Phi\\rangle\\right) + \\frac{1}{2}\\hbar^2 \\lvert\\Phi\\rangle = \\left(\\frac{1}{4}\\hbar^2 + \\frac{1}{2}\\hbar^2\\right) \\lvert\\Phi\\rangle = \\frac{3}{4}\\hbar^2 \\lvert\\Phi\\rangle $$\n$\\hat{S}^2$ 的本征值为 $\\frac{3}{4}\\hbar^2$。对于一个自旋本征函数，其本征值的形式为 $S(S+1)\\hbar^2$。令 $S(S+1) = \\frac{3}{4}$，并求解 $S \\ge 0$，我们得到 $S = \\frac{1}{2}$。因此，$\\lvert\\Phi\\rangle$ 是一个总自旋为 $S = \\frac{1}{2}$ 的纯自旋态。\n\n(c) 显式计算期望值 $\\langle \\Phi \\rvert \\hat{S}^2 \\lvert \\Phi \\rangle$。\n\n从(b)部分我们已经知道 $\\hat{S}^2 \\lvert\\Phi\\rangle = \\frac{3}{4}\\hbar^2 \\lvert\\Phi\\rangle$。因此，期望值为：\n$$ \\langle \\Phi \\rvert \\hat{S}^2 \\lvert \\Phi \\rangle = \\langle \\Phi \\rvert \\left( \\frac{3}{4}\\hbar^2 \\lvert \\Phi \\rangle \\right) = \\frac{3}{4}\\hbar^2 \\langle \\Phi \\rvert \\Phi \\rangle $$\n由于 $\\lvert \\Phi \\rangle$ 是一个归一化的Slater行列式，所以 $\\langle \\Phi \\rvert \\Phi \\rangle = 1$。因此，$\\langle \\hat{S}^2 \\rangle = \\frac{3}{4}\\hbar^2$。\n为了通过显式计算（而不依赖于(b)部分的结果）来证实这一点，我们可以使用另一个恒等式 $\\hat{S}^2 = \\hat{S}_+ \\hat{S}_- + \\hat{S}_z^2 - \\hbar \\hat{S}_z$。期望值为：\n$$ \\langle \\hat{S}^2 \\rangle = \\langle \\Phi | (\\hat{S}_+ \\hat{S}_- + \\hat{S}_z^2 - \\hbar \\hat{S}_z) | \\Phi \\rangle = \\langle \\Phi | \\hat{S}_+ \\hat{S}_- | \\Phi \\rangle + \\langle \\Phi | \\hat{S}_z^2 | \\Phi \\rangle - \\hbar \\langle \\Phi | \\hat{S}_z | \\Phi \\rangle $$\n使用 $\\hat{S}_z \\lvert\\Phi\\rangle = \\frac{1}{2}\\hbar \\lvert\\Phi\\rangle$，最后两项为：\n$$ \\langle \\hat{S}_z^2 \\rangle - \\hbar \\langle \\hat{S}_z \\rangle = \\left(\\frac{1}{2}\\hbar\\right)^2 - \\hbar\\left(\\frac{1}{2}\\hbar\\right) = \\frac{1}{4}\\hbar^2 - \\frac{1}{2}\\hbar^2 = -\\frac{1}{4}\\hbar^2 $$\n现在我们计算第一项 $\\langle \\Phi | \\hat{S}_+ \\hat{S}_- | \\Phi \\rangle = \\langle \\hat{S}_- \\Phi | \\hat{S}_- \\Phi \\rangle$。我们必须计算 $\\hat{S}_- = \\sum_{j=1}^{N} \\hat{s}_{-,j}$ 对 $\\lvert\\Phi\\rangle$ 的作用。单电子算符 $\\hat{s}_-$ 的作用为 $\\hat{s}_- \\alpha = \\hbar \\beta$ 和 $\\hat{s}_- \\beta = 0$。\n算符 $\\hat{s}_{-,j}$ 只有在作用于$\\alpha$自旋轨道时才会产生非零结果。\n- 如果它作用于一个双占据的核心轨道，$\\hat{s}_{-,j}(\\phi_i\\alpha) = \\hbar(\\phi_i\\beta)$，会创建一个包含两个 $\\phi_i\\beta$ 自旋轨道的行列式，其值为零。\n- 如果它作用于单占据轨道，$\\hat{s}_{-,j}(\\phi_u\\alpha) = \\hbar(\\phi_u\\beta)$。这将创建一个新的非零Slater行列式，我们称之为 $\\lvert\\Phi'\\rangle$，其自旋轨道集合为 $\\{\\phi_1\\alpha,\\phi_1\\beta;\\ldots;\\phi_{N_{\\mathrm{c}}}\\alpha,\\phi_{N_{\\mathrm{c}}}\\beta;\\phi_u\\beta\\}$。\n因此，对所有电子的求和塌缩为一项：\n$$ \\hat{S}_- \\lvert\\Phi\\rangle = \\hbar \\lvert\\Phi'\\rangle $$\n现在我们计算其范数：\n$$ \\langle \\hat{S}_- \\Phi | \\hat{S}_- \\Phi \\rangle = \\langle \\hbar \\Phi' | \\hbar \\Phi' \\rangle = \\hbar^2 \\langle \\Phi' | \\Phi' \\rangle $$\n由于 $\\lvert\\Phi'\\rangle$ 也是由一组规范正交的自旋轨道构成的归一化Slater行列式，因此 $\\langle \\Phi' | \\Phi' \\rangle = 1$。所以，$\\langle \\Phi | \\hat{S}_+ \\hat{S}_- | \\Phi \\rangle = \\hbar^2$。\n合并所有部分：\n$$ \\langle \\hat{S}^2 \\rangle = \\hbar^2 - \\frac{1}{4}\\hbar^2 = \\frac{3}{4}\\hbar^2 $$\n这一显式计算证实了ROHF行列式的自旋纯度。所要求的无量纲值为：\n$$ \\frac{\\langle \\hat{S}^2 \\rangle}{\\hbar^2} = \\frac{3}{4} $$", "answer": "$$\\boxed{\\frac{3}{4}}$$", "id": "2911616"}, {"introduction": "从解析证明过渡到计算实践，我们可以更深入地理解不同理论方法的优劣。非限制性 (UHF) 和限制性开壳层 (ROHF) 哈特里-福克方法在变分灵活性与保持自旋对称性之间做出了不同的权衡。本练习将指导你构建一个计算实验，在一个简化的氧分子模型上并排比较这些方法，并通过编程实现来亲身体验自旋污染的数值后果以及自旋投影技术的修正效果。[@problem_id:2911621]", "problem": "考虑一个用于分子氧的、基于第一性原理的最小开壳层模型，该模型分离出 $\\pi$-流形中自旋对称性的基本物理，同时在计算上是可行的。使用一个由 $M=7$ 个正交归一的空间轨道组成的基组，标记如下：两个深层芯轨道 $\\{c_1,c_2\\}$，两个 $\\pi$-成键轨道 $\\{\\pi_x,\\pi_y\\}$，两个 $\\pi^\\ast$ 反键轨道 $\\{\\pi^\\ast_x,\\pi^\\ast_y\\}$，以及一个额外的高能量虚轨道 $v$。将单电子哈密顿量（以原子单位，哈特里计）指定为一个实对称矩阵 $h \\in \\mathbb{R}^{M\\times M}$，其对角元为\n$c_1:\\,E_{c_1}=-5.0$，$c_2:\\,E_{c_2}=-3.0$，$\\pi_x:\\,E_{\\pi}=-\\Delta$，$\\pi_y:\\,E_{\\pi}=-\\Delta$，$\\pi^\\ast_x:\\,E_{\\pi^\\ast}=+\\Delta$，$\\pi^\\ast_y:\\,E_{\\pi^\\ast}=+\\Delta$，$v:\\,E_v=+3.0$，且仅在对称性匹配的 $\\pi$ 轨道对之间存在非对角耦合，\n$h_{\\pi_x,\\pi^\\ast_x}=h_{\\pi^\\ast_x,\\pi_x}=-\\beta$，$h_{\\pi_y,\\pi^\\ast_y}=h_{\\pi^\\ast_y,\\pi_y}=-\\beta$，所有其他非对角元为零。这个 $h$ 矩阵模拟了 $\\pi$-成键/反键分裂和最小混合。\n\n在平均场水平上使用密度-密度库仑矩阵 $J\\in\\mathbb{R}^{M\\times M}$ 和简化的交换矩阵 $K\\in\\mathbb{R}^{M\\times M}$ 来模拟电子排斥，定义为 $J_{ii}=U$，$J_{ij}=J$（当 $i\\neq j$ 时），$K_{ii}=U$，$K_{ij}=K$（当 $i\\neq j$ 时）。考虑总共有 $N_\\alpha=6$ 和 $N_\\beta=4$ 个电子（$N_{\\text{tot}}=10$），这在性质上对应于 $\\mathrm{O}_2$ 的三重态基态特性，即在 $\\pi^\\ast$ 流形中有两个未配对的 $\\alpha$ 电子。\n\n对于给定的自旋 $\\sigma\\in\\{\\alpha,\\beta\\}$，令 $P^\\sigma\\in\\mathbb{R}^{M\\times M}$ 为由已占据分子轨道构建的自旋密度矩阵，总密度为 $P=P^\\alpha+P^\\beta$。定义对角占据数向量 $n^\\sigma\\in\\mathbb{R}^M$ 为 $n^\\sigma_i=(P^\\sigma)_{ii}$，$n=n^\\alpha+n^\\beta$。通过以下公式构建自旋相关的福克矩阵：\n$$\nF^\\sigma \\;=\\; h \\;+\\; \\operatorname{diag}\\!\\big(J\\,n - K\\,n^\\sigma\\big),\n$$\n其中对角算符将向量应用于一个零矩阵的对角线。对于给定的 $(P^\\alpha,P^\\beta)$ 对，总哈特里-福克能量泛函（以哈特里计）为：\n$$\nE[P^\\alpha,P^\\beta] \\;=\\; \\sum_{\\sigma\\in\\{\\alpha,\\beta\\}} \\operatorname{Tr}\\!\\big(h\\,P^\\sigma\\big) \\;+\\; \\tfrac{1}{2}\\,n^\\mathsf{T} J\\,n \\;-\\; \\tfrac{1}{2}\\Big( (n^\\alpha)^\\mathsf{T} K\\,n^\\alpha + (n^\\beta)^\\mathsf{T} K\\,n^\\beta \\Big).\n$$\n\n任务 A (非限制性哈特里-福克, UHF)：从通过对角化 $h$ 并为每个自旋占据能量最低的 $N_\\alpha$ 和 $N_\\beta$ 个轨道得到的初始猜测开始，执行自洽场 (SCF) 流程。在每次迭代中，构建 $F^\\alpha$ 和 $F^\\beta$，对它们进行对角化以获得分子轨道，填充最低的 $N_\\alpha$ 和 $N_\\beta$ 个轨道以构建更新的 $P^\\alpha$ 和 $P^\\beta$，并使用线性混合进行迭代，直到总能量的变化低于 $10^{-10}$ 哈特里。收敛后，计算：\n- 总能量 $E_{\\text{UHF}}$（以哈特里计），\n- 单个斯莱特行列式的自旋平方期望值 $\\langle S^2 \\rangle_{\\text{UHF}}$，在正交归一基下使用著名的公式：\n$$\n\\langle S^2 \\rangle \\;=\\; S_z\\,(S_z+1) \\;+\\; N_\\beta \\;-\\; \\operatorname{Tr}\\!\\big(S\\,S^\\mathsf{T}\\big), \\quad S_z=\\tfrac{1}{2}(N_\\alpha-N_\\beta),\n$$\n其中 $S = (C^\\alpha_{\\text{occ}})^\\mathsf{T} C^\\beta_{\\text{occ}}$ 是已占据的 $\\alpha$-自旋和 $\\beta$-自旋分子轨道之间的重叠矩阵，而 $C^\\sigma_{\\text{occ}}$ 集合了 $F^\\sigma$ 的特征向量矩阵的已占据列，\n- 两个反键轨道上的自旋密度，定义为 $P^\\alpha-P^\\beta$ 在 $\\pi^\\ast_x$ 和 $\\pi^\\ast_y$ 基函数上的对角元。\n\n任务 B (限制性开壳层哈特里-福克, ROHF)：通过迭代单一的“平均”福克矩阵，为两种自旋强制使用一个共同的空间轨道集 $C$：\n$$\nF_{\\text{R}} \\;=\\; h \\;+\\; \\operatorname{diag}\\!\\big(J\\,n - \\tfrac{1}{2}K\\,n\\big),\n$$\n其中 $n$ 是基于当前的共同轨道和 ROHF 的占据模式构建的：将能量最低的 $N_\\beta$ 个轨道作为双占据轨道（每个轨道一个 $\\alpha$ 和一个 $\\beta$ 电子），并将接下来的 $(N_\\alpha - N_\\beta)$ 个轨道作为由 $\\alpha$ 电子单占据的轨道。像 UHF 一样迭代直至收敛。然后计算：\n- 总能量 $E_{\\text{ROHF}}$（以哈特里计），通过使用收敛的 ROHF 密度计算 $E[P^\\alpha,P^\\beta]$，\n- 自旋平方值 $\\langle S^2 \\rangle_{\\text{ROHF}}$，对于一个纯自旋三重态，其值应等于 $S(S+1)$，其中 $S=1$，即 $\\langle S^2 \\rangle_{\\text{ROHF}}=2$，\n- $\\pi^\\ast_x$ 和 $\\pi^\\ast_y$ 上的自旋密度。\n\n任务 C (通过子空间投影的自旋投影哈特里-福克, “PUHF”)：从收敛的 UHF 已占据子空间开始，定义 $\\alpha$-占据投影算符 $P_A = C^\\alpha_{\\text{occ}} (C^\\alpha_{\\text{occ}})^\\mathsf{T}$。将 $\\beta$-占据轨道投影到这个子空间中以“湮灭”自旋污染：\n$$\n\\widetilde{C}^\\beta_{\\text{occ}} \\;=\\; P_A\\, C^\\beta_{\\text{occ}}, \\quad C^\\beta_{\\text{proj}} \\;=\\; \\widetilde{C}^\\beta_{\\text{occ}}\\,\\Big(\\big(\\widetilde{C}^\\beta_{\\text{occ}}\\big)^\\mathsf{T}\\widetilde{C}^\\beta_{\\text{occ}}\\Big)^{-1/2},\n$$\n其中逆平方根是对称正交归一化。定义 $P^\\alpha_{\\text{PUHF}} = C^\\alpha_{\\text{occ}} (C^\\alpha_{\\text{occ}})^\\mathsf{T}$ 和 $P^\\beta_{\\text{PUHF}} = C^\\beta_{\\text{proj}} (C^\\beta_{\\text{proj}})^\\mathsf{T}$。计算：\n- 投影能量 $E_{\\text{PUHF}}=E[P^\\alpha_{\\text{PUHF}},P^\\beta_{\\text{PUHF}}]$（以哈特里计），\n- 投影的 $\\langle S^2 \\rangle_{\\text{PUHF}}$，使用相同的公式计算，对于所构建的态，其值必须精确为 $2$，\n- 从 $P^\\alpha_{\\text{PUHF}}-P^\\beta_{\\text{PUHF}}$ 计算出的 $\\pi^\\ast_x$ 和 $\\pi^\\ast_y$ 上的自旋密度。\n\n使用以下三组参数集 $(\\Delta,\\beta,U,J,K)$ 作为测试套件，以评估对称性破缺和恢复：\n- 情况 1: $(\\Delta,\\beta,U,J,K)=(1.0,\\,0.2,\\,1.5,\\,0.8,\\,0.3)$，\n- 情况 2: $(\\Delta,\\beta,U,J,K)=(1.0,\\,0.2,\\,1.5,\\,0.8,\\,0.0)$，\n- 情况 3: $(\\Delta,\\beta,U,J,K)=(1.2,\\,0.5,\\,1.5,\\,0.6,\\,0.6)$。\n\n对于每种情况，运行任务 A-C 并收集一个包含八个数字的列表：\n$[E_{\\text{UHF}},\\langle S^2\\rangle_{\\text{UHF}},E_{\\text{ROHF}},\\langle S^2\\rangle_{\\text{ROHF}},E_{\\text{PUHF}},\\langle S^2\\rangle_{\\text{PUHF}},m_{\\pi^\\ast_x},m_{\\pi^\\ast_y}]$，\n其中 $m_{\\pi^\\ast_x}$ 和 $m_{\\pi^\\ast_y}$ 分别是 $\\pi^\\ast_x$ 和 $\\pi^\\ast_y$ 上的自旋密度。所有能量必须以哈特里表示，所有其他量均为无量纲。你的程序应生成单行输出，其中包含由这三个此类列表组成的逗号分隔列表，并用方括号括起来（例如，$[[\\dots],[\\dots],[\\dots]]$）。", "solution": "该问题提出了一个定义明确的量子化学计算练习，要求对一个简化的分子氧模型实施并应用三种基于哈特里-福克的方法。该模型虽然没有采用从头算积分评估的全部复杂性，但它在科学上是合理的、自洽的，并为研究开壳层自旋对称性现象提供了一个有效的框架。任务的规定具有足够的细节和形式精度，足以得到一个唯一且可验证的数值解。因此，该问题被认为是有效的。\n\n问题的核心在于求解一个由 $M=7$ 个正交归一轨道组成的基组中，包含 $N_\\alpha=6$ 个自旋向上和 $N_\\beta=4$ 个自旋向下电子的系统的自洽场 (SCF) 方程。总自旋投影为 $S_z = \\frac{1}{2}(N_\\alpha - N_\\beta) = 1$，对应于一个三重态。该模型由一个单电子哈密顿量 $h$ 和简化的双电子相互作用矩阵 $J$ 和 $K$ 定义。\n\n基轨道索引如下：$c_1 \\to 0$，$c_2 \\to 1$，$\\pi_x \\to 2$，$\\pi_y \\to 3$，$\\pi^\\ast_x \\to 4$，$\\pi^\\ast_y \\to 5$，$v \\to 6$。\n\n单电子哈密顿矩阵 $h \\in \\mathbb{R}^{7 \\times 7}$ 由其给定的对角能量和非对角耦合构建：\n$$\nh = \\begin{pmatrix}\n-5.0  0  0  0  0  0  0 \\\\\n0  -3.0  0  0  0  0  0 \\\\\n0  0  -\\Delta  0  -\\beta  0  0 \\\\\n0  0  0  -\\Delta  0  -\\beta  0 \\\\\n0  0  -\\beta  0  \\Delta  0  0 \\\\\n0  0  0  -\\beta  0  \\Delta  0 \\\\\n0  0  0  0  0  0  3.0\n\\end{pmatrix}\n$$\n双电子相互作用矩阵 $J, K \\in \\mathbb{R}^{7 \\times 7}$ 定义为 $J_{ii}=U$，$J_{ij}=J$（当 $i \\neq j$ 时），$K$ 也类似。这些可以构建为 $J_{\\text{matrix}} = J \\cdot \\mathbf{1} + (U-J) \\cdot I$，其中 $\\mathbf{1}$ 是全一矩阵，$I$ 是单位矩阵。\n\n由自旋密度矩阵 $P^\\alpha$ 和 $P^\\beta$ 定义的态的总能量由下式给出：\n$$\nE[P^\\alpha,P^\\beta] \\;=\\; \\sum_{\\sigma\\in\\{\\alpha,\\beta\\}} \\operatorname{Tr}\\!\\big(h\\,P^\\sigma\\big) \\;+\\; \\tfrac{1}{2}\\,n^\\mathsf{T} J\\,n \\;-\\; \\tfrac{1}{2}\\Big( (n^\\alpha)^\\mathsf{T} K\\,n^\\alpha + (n^\\beta)^\\mathsf{T} K\\,n^\\beta \\Big)\n$$\n其中 $n^\\sigma$ 是 $P^\\sigma$ 的对角元组成的向量。\n\n**任务 A：非限制性哈特里-福克 (UHF)**\n在 UHF 方法中，$\\alpha$ 和 $\\beta$ 电子的空间轨道可以不同。SCF 过程对两个独立的福克矩阵进行：\n$$\nF^\\sigma \\;=\\; h \\;+\\; \\operatorname{diag}\\!\\big(J\\,n - K\\,n^\\sigma\\big)\n$$\n流程如下：\n1.  **初始化**：对角化 $h$ 以获得初始分子轨道（MOs），$C_0$。构建初始密度矩阵 $P^\\alpha_0 = \\sum_{i=0}^{N_\\alpha-1} (C_0)_i (C_0)_i^\\mathsf{T}$ 和 $P^\\beta_0 = \\sum_{i=0}^{N_\\beta-1} (C_0)_i (C_0)_i^\\mathsf{T}$。\n2.  **SCF 迭代**：\n    a.  从当前的密度矩阵 $P^\\alpha$ 和 $P^\\beta$ 计算占据数向量 $n^\\alpha$ 和 $n^\\beta$。\n    b.  构建福克矩阵 $F^\\alpha$ 和 $F^\\beta$。\n    c.  对每个福克矩阵进行对角化：$F^\\sigma C^\\sigma = C^\\sigma \\varepsilon^\\sigma$。\n    d.  通过占据能量最低的 $N_\\sigma$ 个轨道形成新的密度矩阵 $P^\\sigma_{\\text{calc}}$。\n    e.  对密度矩阵应用线性混合以确保平滑收敛：$P^\\sigma_{\\text{new}} = (1-\\lambda)P^\\sigma_{\\text{old}} + \\lambda P^\\sigma_{\\text{calc}}$，其中混合参数 $\\lambda \\in (0,1]$。\n    f.  计算新的总能量 $E_{\\text{new}}$。\n3.  **收敛**：重复 SCF 循环，直到总能量变化 $|E_{\\text{new}} - E_{\\text{old}}|$ 小于 $10^{-10}$ 哈特里。\n4.  **SCF 后计算**：收敛后，计算总能量 $E_{\\text{UHF}}$ 和自旋平方期望值 $\\langle S^2 \\rangle_{\\text{UHF}}$，使用公式：\n$$\n\\langle S^2 \\rangle = S_z(S_z+1) + N_\\beta - \\operatorname{Tr}(S S^\\mathsf{T}), \\quad \\text{where } S = (C^\\alpha_{\\text{occ}})^\\mathsf{T} C^\\beta_{\\text{occ}}\n$$\n$\\langle S^2 \\rangle_{\\text{UHF}}$ 的值大于 $S(S+1)=2$ 表明存在自旋污染。\n\n**任务 B：限制性开壳层哈特里-福克 (ROHF)**\nROHF 方法强制所有电子使用一套共同的空间轨道。该问题定义了一个特定的简化 ROHF 类过程，使用单一的平均福克矩阵：\n$$\nF_{\\text{R}} \\;=\\; h \\;+\\; \\operatorname{diag}\\!\\big(J\\,n - \\tfrac{1}{2}K\\,n\\big)\n$$\n流程如下：\n1.  **初始化**：从对角化 $h$ 得到的 MOs 开始。\n2.  **SCF 迭代**：\n    a.  从当前的共同 MOs $C$ 中，确定已占据子空间：$N_\\beta=4$ 个双占据轨道和 $(N_\\alpha-N_\\beta)=2$ 个单占据（$\\alpha$-自旋）轨道。\n    b.  构建相应的密度矩阵 $P^\\alpha$ 和 $P^\\beta$ 及其占据数向量 $n^\\alpha, n^\\beta$。\n    c.  构建平均福克矩阵 $F_R$。\n    d.  对角化 $F_R$ 以获得一套新的共同 MOs，$C_{\\text{new}}$。\n    e.  对 MOs 或密度矩阵应用混合并重复。\n3.  **收敛**：迭代直到能量变化低于阈值。\n4.  **SCF 后计算**：使用通用能量泛函和收敛的 ROHF 密度计算总能量 $E_{\\text{ROHF}}$。由于使用共同的轨道集，自旋平方值 $\\langle S^2 \\rangle_{\\text{ROHF}}$ 将精确为 $2$。\n\n**任务 C：自旋投影哈特里-福克 (PUHF)**\n此任务涉及对收敛的 UHF 解进行一个后处理步骤以消除自旋污染。该过程是自旋投影的一个简化版本，流程如下：\n1.  从收敛的 UHF MOs 开始，$C^\\alpha_{\\text{occ}}$ ($M \\times N_\\alpha$) 和 $C^\\beta_{\\text{occ}}$ ($M \\times N_\\beta$)。\n2.  定义到 $\\alpha$-占据子空间的投影算符：$P_A = C^\\alpha_{\\text{occ}} (C^\\alpha_{\\text{occ}})^\\mathsf{T}$。\n3.  问题陈述是将 $\\beta$-占据轨道投影到 $\\alpha$-占据空间中，而不是其补空间。$\\widetilde{C}^\\beta_{\\text{occ}} = P_A\\, C^\\beta_{\\text{occ}}$。\n4.  对得到的投影 $\\beta$-轨道集进行对称正交归一化：\n$$\nC^\\beta_{\\text{proj}} \\;=\\; \\widetilde{C}^\\beta_{\\text{occ}}\\,\\Big(\\big(\\widetilde{C}^\\beta_{\\text{occ}}\\big)^\\mathsf{T}\\widetilde{C}^\\beta_{\\text{occ}}\\Big)^{-1/2}\n$$\n格拉姆矩阵 $G = (\\widetilde{C}^\\beta_{\\text{occ}})^\\mathsf{T}\\widetilde{C}^\\beta_{\\text{occ}}$ 的逆平方根通过其特征分解进行稳健计算：$G=W\\Lambda W^\\mathsf{T}$，所以 $G^{-1/2} = W\\Lambda^{-1/2}W^\\mathsf{T}$。\n5.  构建投影密度矩阵：$P^\\alpha_{\\text{PUHF}} = P^\\alpha_{\\text{UHF}}$ 和 $P^\\beta_{\\text{PUHF}} = C^\\beta_{\\text{proj}} (C^\\beta_{\\text{proj}})^\\mathsf{T}$。\n6.  **计算**：计算能量 $E_{\\text{PUHF}} = E[P^\\alpha_{\\text{PUHF}}, P^\\beta_{\\text{PUHF}}]$。此状态的自旋平方期望值 $\\langle S^2 \\rangle_{\\text{PUHF}}$ 必须精确得到 $2$，这由投影的代数性质所保证。\n\n最后，计算 $\\pi^\\ast_x$ (索引 4) 和 $\\pi^\\ast_y$ (索引 5) 轨道上的自旋密度，$m_i = (P^\\alpha - P^\\beta)_{ii}$。问题要求在最终输出列表中报告一对自旋密度。根据其在 PUHF 结果之后的位置，最合乎逻辑的解释是报告来自最终的、自旋投影态 $(P^\\alpha_{\\text{PUHF}} - P^\\beta_{\\text{PUHF}})$ 的密度。\n\n实现过程将通过为每个任务定义 Python 函数，设置所需矩阵，并遍历所提供的三个参数案例来进行。", "answer": "```python\nimport numpy as np\nfrom scipy.linalg import eigh, inv\n\ndef matrix_inv_sqrt(A):\n    \"\"\"Computes the inverse square root of a symmetric matrix A using eigendecomposition.\"\"\"\n    eigvals, eigvecs = eigh(A)\n    # Check for near-zero eigenvalues to avoid division by zero\n    inv_sqrt_eigvals = np.array([1.0 / np.sqrt(v) if v  1e-15 else 0.0 for v in eigvals])\n    return eigvecs @ np.diag(inv_sqrt_eigvals) @ eigvecs.T\n\ndef calculate_energy(h, J, K, P_alpha, P_beta):\n    \"\"\"Calculates the total energy from density matrices.\"\"\"\n    n_alpha = np.diag(P_alpha)\n    n_beta = np.diag(P_beta)\n    n = n_alpha + n_beta\n    \n    E_one_electron = np.trace(h @ P_alpha) + np.trace(h @ P_beta)\n    E_coulomb = 0.5 * n.T @ J @ n\n    E_exchange = -0.5 * (n_alpha.T @ K @ n_alpha + n_beta.T @ K @ n_beta)\n    \n    return E_one_electron + E_coulomb + E_exchange\n\ndef calculate_s2(C_alpha_occ, C_beta_occ, N_alpha, N_beta):\n    \"\"\"Calculates the S^2 expectation value.\"\"\"\n    S_z = 0.5 * (N_alpha - N_beta)\n    S_overlap = C_alpha_occ.T @ C_beta_occ\n    trace_term = np.trace(S_overlap @ S_overlap.T)\n    return S_z * (S_z + 1) + N_beta - trace_term\n\ndef run_uhf(h, J, K, M, N_alpha, N_beta, mix_param, max_iter, tol):\n    \"\"\"Performs a UHF SCF calculation.\"\"\"\n    # Initial guess from h\n    _, C0 = eigh(h)\n    P_alpha = C0[:, :N_alpha] @ C0[:, :N_alpha].T\n    P_beta = C0[:, :N_beta] @ C0[:, :N_beta].T\n    \n    E_old = 0.0\n    for i in range(max_iter):\n        n_alpha = np.diag(P_alpha)\n        n_beta = np.diag(P_beta)\n        n = n_alpha + n_beta\n        \n        # Build Fock matrices\n        F_alpha = h + np.diag(J @ n - K @ n_alpha)\n        F_beta = h + np.diag(J @ n - K @ n_beta)\n        \n        # Diagonalize Fock matrices\n        eps_alpha, C_alpha = eigh(F_alpha)\n        eps_beta, C_beta = eigh(F_beta)\n        \n        # Form new density matrices\n        P_alpha_calc = C_alpha[:, :N_alpha] @ C_alpha[:, :N_alpha].T\n        P_beta_calc = C_beta[:, :N_beta] @ C_beta[:, :N_beta].T\n        \n        # Mix density matrices\n        P_alpha = (1 - mix_param) * P_alpha + mix_param * P_alpha_calc\n        P_beta = (1 - mix_param) * P_beta + mix_param * P_beta_calc\n        \n        # Calculate energy and check convergence\n        E_new = calculate_energy(h, J, K, P_alpha, P_beta)\n        if abs(E_new - E_old)  tol:\n            break\n        E_old = E_new\n    \n    E_uhf = E_new\n    # Final C matrices from final densities\n    _, C_alpha = eigh(h + np.diag(J @ (np.diag(P_alpha) + np.diag(P_beta)) - K @ np.diag(P_alpha)))\n    _, C_beta  = eigh(h + np.diag(J @ (np.diag(P_alpha) + np.diag(P_beta)) - K @ np.diag(P_beta)))\n\n    C_alpha_occ = C_alpha[:, :N_alpha]\n    C_beta_occ = C_beta[:, :N_beta]\n    \n    s2_uhf = calculate_s2(C_alpha_occ, C_beta_occ, N_alpha, N_beta)\n    \n    return E_uhf, s2_uhf, C_alpha_occ, C_beta_occ, P_alpha, P_beta\n\ndef run_rohf(h, J, K, M, N_alpha, N_beta, mix_param, max_iter, tol):\n    \"\"\"Performs an ROHF SCF calculation.\"\"\"\n    # Initial guess\n    _, C = eigh(h)\n    \n    n_closed = N_beta\n    n_open = N_alpha - N_beta\n    \n    E_old = 0.0\n    for i in range(max_iter):\n        C_closed = C[:, :n_closed]\n        C_open = C[:, n_closed:n_closed + n_open]\n        \n        P_double = C_closed @ C_closed.T\n        P_single = C_open @ C_open.T\n        \n        P_alpha = P_double + P_single\n        P_beta = P_double\n        \n        n_alpha = np.diag(P_alpha)\n        n_beta = np.diag(P_beta)\n        n = n_alpha + n_beta\n        \n        # Build average Fock matrix\n        F_r = h + np.diag(J @ n - 0.5 * K @ n)\n        \n        # Diagonalize to get new orbitals\n        _, C_new = eigh(F_r)\n        \n        # Mix orbitals (by mixing Fock matrices implicitly before diag is tricky, mixing C is complex, easiest to mix P)\n        P_alpha_new = (1-mix_param)*P_alpha + mix_param*((C_new[:,:n_closed]@C_new[:,:n_closed].T) + (C_new[:,n_closed:n_closed+n_open]@C_new[:,n_closed:n_closed+n_open].T))\n        P_beta_new = (1-mix_param)*P_beta + mix_param*(C_new[:,:n_closed]@C_new[:,:n_closed].T)\n        \n        P_alpha, P_beta = P_alpha_new, P_beta_new\n        _, C = eigh(h + np.diag(J @ (np.diag(P_alpha)+np.diag(P_beta)) - 0.5 * K @ (np.diag(P_alpha)+np.diag(P_beta))))\n\n        E_new = calculate_energy(h, J, K, P_alpha, P_beta)\n        if abs(E_new - E_old)  tol:\n            break\n        E_old = E_new\n\n    E_rohf = E_new\n    \n    # S^2 is 2 by construction for this type of ROHF state\n    s2_rohf = 2.0\n    \n    return E_rohf, s2_rohf\n\ndef run_puhf(h, J, K, C_alpha_occ, C_beta_occ, N_alpha, N_beta):\n    \"\"\"Performs a PUHF calculation from a UHF solution.\"\"\"\n    P_alpha_uhf = C_alpha_occ @ C_alpha_occ.T\n    \n    # Project beta orbitals\n    P_A = C_alpha_occ @ C_alpha_occ.T\n    C_beta_tilde = P_A @ C_beta_occ\n    \n    # Orthonormalize\n    G = C_beta_tilde.T @ C_beta_tilde\n    G_inv_sqrt = matrix_inv_sqrt(G)\n    C_beta_proj = C_beta_tilde @ G_inv_sqrt\n    \n    P_alpha_puhf = P_alpha_uhf\n    P_beta_puhf = C_beta_proj @ C_beta_proj.T\n    \n    # Calculate energy and S^2\n    E_puhf = calculate_energy(h, J, K, P_alpha_puhf, P_beta_puhf)\n    s2_puhf = calculate_s2(C_alpha_occ, C_beta_proj, N_alpha, N_beta)\n    \n    # Spin densities\n    spin_density_matrix = P_alpha_puhf - P_beta_puhf\n    m_pi_star_x = spin_density_matrix[4, 4]\n    m_pi_star_y = spin_density_matrix[5, 5]\n    \n    return E_puhf, s2_puhf, m_pi_star_x, m_pi_star_y\n\ndef solve():\n    test_cases = [\n        (1.0, 0.2, 1.5, 0.8, 0.3),  # Case 1\n        (1.0, 0.2, 1.5, 0.8, 0.0),  # Case 2\n        (1.2, 0.5, 1.5, 0.6, 0.6),  # Case 3\n    ]\n    \n    all_results = []\n    \n    M = 7\n    N_alpha = 6\n    N_beta = 4\n    \n    # SCF parameters\n    mix_param = 0.5\n    max_iter = 200\n    tol = 1e-10\n\n    for case in test_cases:\n        Delta, beta, U, J_param, K_param = case\n        \n        # Setup matrices\n        h = np.zeros((M, M))\n        h[0, 0] = -5.0\n        h[1, 1] = -3.0\n        h[2, 2] = -Delta\n        h[3, 3] = -Delta\n        h[4, 4] = Delta\n        h[5, 5] = Delta\n        h[6, 6] = 3.0\n        h[2, 4] = h[4, 2] = -beta\n        h[3, 5] = h[5, 3] = -beta\n        \n        J_mat = np.full((M, M), J_param)\n        np.fill_diagonal(J_mat, U)\n        \n        K_mat = np.full((M, M), K_param)\n        np.fill_diagonal(K_mat, U)\n        \n        # Task A: UHF\n        E_uhf, s2_uhf, C_alpha_occ, C_beta_occ, _, _ = run_uhf(\n            h, J_mat, K_mat, M, N_alpha, N_beta, mix_param, max_iter, tol\n        )\n        \n        # Task B: ROHF\n        E_rohf, s2_rohf = run_rohf(\n            h, J_mat, K_mat, M, N_alpha, N_beta, mix_param, max_iter, tol\n        )\n        \n        # Task C: PUHF\n        E_puhf, s2_puhf, m_x, m_y = run_puhf(\n            h, J_mat, K_mat, C_alpha_occ, C_beta_occ, N_alpha, N_beta\n        )\n        \n        # Collect results for the case\n        case_results = [\n            E_uhf, s2_uhf, E_rohf, s2_rohf, E_puhf, s2_puhf, m_x, m_y\n        ]\n        all_results.append(f\"[{','.join(f'{x:.8f}' for x in case_results)}]\")\n\n    print(f\"[{','.join(all_results)}]\")\n\nsolve()\n```", "id": "2911621"}]}