{"hands_on_practices": [{"introduction": "对于开壳层体系，从单个分子轨道中电离一个电子可能产生能量不同的多个末态（即多重态），这是库普曼斯定理简单图像的一个重要扩展。本练习将运用基本的斯莱特-康登规则（Slater-Condon rules），从第一性原理出发推导这种能量分裂，揭示“一个轨道对应一个电离能”这一简化观点之外的物理真实性。[@problem_id:2901769]", "problem": "考虑一个在 Hartree–Fock (HF) 理论水平上描述的开壳层中性物种，其具有正交归一的空间轨道和自旋函数。其电子构型包含一个单占据空间轨道 $s$（含一个 $\\alpha$ 电子）和一个双占据空间轨道 $p$（含一个 $\\alpha$ 电子和一个 $\\beta$ 电子）。假设一个仅由空间轨道 $s$ 和 $p$ 组成的最小活性空间，并忽略平均场之外的轨道弛豫和电子相关。使用 Koopmans’ 定理和 Slater–Condon 规则来分析从 $p$ 轨道移除一个 $\\alpha$ 或 $\\beta$ 电子的电离过程。\n\n令 $h_{q}$ 表示空间轨道 $q \\in \\{s,p\\}$ 中的单电子核哈密顿量期望值，$J_{pq}$ 为空间轨道 $p$ 和 $q$ 之间的库仑积分，$K_{pq}$ 为空间轨道 $p$ 和 $q$ 之间的交换积分，其常规定义为 $J_{pq}=(pp|qq)$ 和 $K_{pq}=(pq|qp)$。所有空间轨道均为正交归一的。\n\n以 Slater–Condon 规则为基础（一个 Slater 行列式的能量等于单电子项之和，加上成对的库仑项并减去自旋相同电子对的交换项），并结合 Koopmans 定理（电离能等于在不考虑轨道弛豫的情况下计算的总能量差 $E_{\\text{ion}}-E_{\\text{neu}}$），执行以下操作：\n\n- 构建由 $s$ 轨道中的一个 $\\alpha$ 电子和双占据的 $p$ 轨道构成的中性态的 HF 能量。\n- 构建从 $p$ 轨道移除一个电子后产生的双电子阳离子态的对角哈密顿矩阵元：一个是在 $s$ 和 $p$ 轨道中具有平行自旋的状态，另一个是在 $s$ 和 $p$ 轨道中具有反平行自旋的状态。确定每种状态的自旋多重度。\n- 利用这些结果，写出到达两种阳离子态的 Koopmans 电离能，并由此获得因从 $p$ 轨道移除电子而达到的两种自旋态所对应的电离能之间的多重态分裂 $\\Delta_{\\mathrm{IE}}$。\n\n提供仅用交换积分 $K_{sp}$ 表示的多重态分裂 $\\Delta_{\\mathrm{IE}}$ 的最终解析表达式。最终答案必须是单一的封闭形式符号表达式。请勿四舍五入。最终答案以不带单位的形式表示。", "solution": "所述问题具有科学依据，提法明确，且无内部矛盾或歧义。它代表了开壳层量子化学中一个标准但并非无足轻重的练习，其基于 Hartree–Fock 理论、Slater-Condon 规则以及冻结轨道近似下的 Koopmans 定理的既定原理。因此，我们可以进行推导。\n\n第一步是确定中性开壳层物种的能量。给定的电子构型是空间轨道 $s$ 中有一个 $\\alpha$ 电子，空间轨道 $p$ 为双占据。这对应于一个由单一 Slater 行列式 $|\\Psi_{\\text{neu}}\\rangle = |s\\alpha, p\\alpha, p\\beta\\rangle$ 描述的三电子体系。总自旋投影为 $M_S = \\frac{1}{2} + \\frac{1}{2} - \\frac{1}{2} = \\frac{1}{2}$，因此这是一个二重态。\n\n由单一 Slater 行列式表示的状态的能量由 Slater-Condon 规则给出，其值为每个占据自旋轨道的单电子能量之和，加上所有唯一的占据自旋轨道对的双电子库仑积分减去交换积分之和。\n$$ E = \\sum_{i} h_i + \\sum_{i<j} (J_{ij} - K_{ij}) $$\n其中求和遍及所有占据的自旋轨道。对于我们的中性态，自旋轨道为 $\\{s\\alpha, p\\alpha, p\\beta\\}$。\n\n能量的单电子部分是：\n$$ E^{(1)}_{\\text{neu}} = \\langle s\\alpha | \\hat{h} | s\\alpha \\rangle + \\langle p\\alpha | \\hat{h} | p\\alpha \\rangle + \\langle p\\beta | \\hat{h} | p\\beta \\rangle = h_s + h_p + h_p = h_s + 2h_p $$\n双电子部分涉及三对自旋轨道：\n1. 对 $(s\\alpha, p\\alpha)$：这些自旋轨道具有平行自旋。相互作用能为 $J_{s\\alpha, p\\alpha} - K_{s\\alpha, p\\alpha}$。用空间轨道表示，即为 $J_{sp} - K_{sp}$。\n2. 对 $(s\\alpha, p\\beta)$：这些自旋轨道具有反平行自旋。交换项 $K_{s\\alpha, p\\beta}$ 为零。相互作用能为 $J_{s\\alpha, p\\beta} = J_{sp}$。\n3. 对 $(p\\alpha, p\\beta)$：这些自旋轨道具有反平行自旋。交换项为零。相互作用能为 $J_{p\\alpha, p\\beta} = J_{pp}$。\n\n中性态的总能量 $E_{\\text{neu}}$ 是这些项的总和：\n$$ E_{\\text{neu}} = (h_s + 2h_p) + (J_{sp} - K_{sp}) + J_{sp} + J_{pp} = h_s + 2h_p + 2J_{sp} + J_{pp} - K_{sp} $$\n\n接下来，我们考虑从 $p$ 轨道移除一个电子所形成的阳离子态。得到的双电子构型为 $(s)^1(p)^1$。该构型产生两种自旋多重态：一个单重态 ($S=0$) 和一个三重态 ($S=1$)。\n\n$s$ 和 $p$ 中自旋平行的状态对应于三重态。其自旋多重度为 $2S+1 = 2(1)+1 = 3$。我们可以通过考虑由单一 Slater 行列式 $|\\Psi_{\\text{triplet}}\\rangle = |s\\alpha, p\\alpha\\rangle$ 表示的 $M_S=1$ 分量来求其能量。\n对这个双电子态使用 Slater-Condon 规则：\n$$ E_{\\text{triplet}} = h_s + h_p + (J_{s\\alpha, p\\alpha} - K_{s\\alpha, p\\alpha}) = h_s + h_p + J_{sp} - K_{sp} $$\n\n$s$ 和 $p$ 中自旋反平行的状态对应于单重态。其自旋多重度为 $2S+1 = 2(0)+1 = 1$。$M_S=0$ 的单重态波函数是两个 Slater 行列式的线性组合：\n$$ |\\Psi_{\\text{singlet}}\\rangle = \\frac{1}{\\sqrt{2}} \\left( |s\\alpha, p\\beta\\rangle - |s\\beta, p\\alpha\\rangle \\right) $$\n这个状态的能量是期望值 $E_{\\text{singlet}} = \\langle\\Psi_{\\text{singlet}}|\\hat{H}|\\Psi_{\\text{singlet}}\\rangle$。这涉及两个行列式之间的对角和非对角矩阵元。\n对角元相等：\n$$ \\langle s\\alpha, p\\beta | \\hat{H} | s\\alpha, p\\beta \\rangle = h_s + h_p + J_{sp} $$\n在相差两个自旋轨道（$s\\alpha \\leftrightarrow s\\beta$, $p\\beta \\leftrightarrow p\\alpha$）的行列式之间的非对角元 $\\langle s\\alpha, p\\beta | \\hat{H} | s\\beta, p\\alpha \\rangle$ 仅由双电子算符给出：它等于 $-K_{sp}$。\n因此，单重态能量为：\n$$ E_{\\text{singlet}} = \\frac{1}{2} \\left[ \\langle s\\alpha, p\\beta | \\hat{H} | s\\alpha, p\\beta \\rangle + \\langle s\\beta, p\\alpha | \\hat{H} | s\\beta, p\\alpha \\rangle - 2\\langle s\\alpha, p\\beta | \\hat{H} | s\\beta, p\\alpha \\rangle \\right] $$\n$$ E_{\\text{singlet}} = \\frac{1}{2} \\left[ (h_s + h_p + J_{sp}) + (h_s + h_p + J_{sp}) - 2(-K_{sp}) \\right] = h_s + h_p + J_{sp} + K_{sp} $$\n\n问题将 Koopmans 电离能 (IE) 定义为使用冻结轨道计算的能量差 $E_{\\text{ion}} - E_{\\text{neu}}$。我们计算到达两个最终多重态的电离能。\n\n到三重态阳离子的电离能为：\n$$ IE_{\\to T} = E_{\\text{triplet}} - E_{\\text{neu}} = (h_s + h_p + J_{sp} - K_{sp}) - (h_s + 2h_p + 2J_{sp} + J_{pp} - K_{sp}) $$\n$$ IE_{\\to T} = -h_p - J_{sp} - J_{pp} $$\n\n到单重态阳离子的电离能为：\n$$ IE_{\\to S} = E_{\\text{singlet}} - E_{\\text{neu}} = (h_s + h_p + J_{sp} + K_{sp}) - (h_s + 2h_p + 2J_{sp} + J_{pp} - K_{sp}) $$\n$$ IE_{\\to S} = -h_p - J_{sp} - J_{pp} + 2K_{sp} $$\n\n最后，多重态分裂 $\\Delta_{\\mathrm{IE}}$ 是这两个电离能之差。由于交换积分是正定的 ($K_{sp}>0$)，单重态的能量高于三重态，因此 $IE_{\\to S} > IE_{\\to T}$。\n$$ \\Delta_{\\mathrm{IE}} = IE_{\\to S} - IE_{\\to T} $$\n$$ \\Delta_{\\mathrm{IE}} = (-h_p - J_{sp} - J_{pp} + 2K_{sp}) - (-h_p - J_{sp} - J_{pp}) $$\n$$ \\Delta_{\\mathrm{IE}} = 2K_{sp} $$\n因此，发现两个最终多重态之间的电离能分裂是空间轨道 $s$ 和 $p$ 之间交换积分的两倍。", "answer": "$$\n\\boxed{2K_{sp}}\n$$", "id": "2901769"}, {"introduction": "轨道弛豫是冻结轨道近似中忽略的另一个关键物理效应，它可能显著改变电离能的预测值。在本练习中，您将构建一个简洁而有力的微扰理论模型，以解析地量化弛豫效应的大小。通过这个模型，您将证明轨道弛豫甚至能够颠覆库普曼斯定理所预测的电离顺序，从而深刻理解其作为零阶近似的本质。[@problem_id:2901820]", "problem": "考虑一个闭壳层 Hartree–Fock (HF) 参考态，其具有两个占据空间轨道 $\\phi_a$ 和 $\\phi_b$（轨道能分别为 $\\varepsilon_a$ 和 $\\varepsilon_b$），以及一个相关的单一虚轨道 $\\phi_v$（能量为 $\\varepsilon_v$）。假设能量排序为 $\\varepsilon_a < \\varepsilon_b < \\varepsilon_v$，所有能量均相对于真空能级测量，因此占据轨道能为负值。在冻结轨道近似中，Koopmans 定理断言，与从轨道 $i \\in \\{a,b\\}$ 中移除一个电子相关的垂直电离能为 $I_i^{\\mathrm{K}} = -\\varepsilon_i$。\n\n为对阳离子中的轨道弛豫进行建模，将弛豫限制在空穴轨道 $i$ 和虚轨道 $v$ 之间的单个混合通道内，该混合由电离后平均场变化所产生的有效单电子算符 $\\widehat{W}_i$ 驱动。令 $\\kappa_i = \\langle \\phi_v | \\widehat{W}_i | \\phi_i \\rangle$ 为与移除电子 $i$ 相关的 $(N-1)$-电子阳离子在单电子子空间 $\\mathrm{span}\\{\\phi_i,\\phi_v\\}$ 中唯一的非零非对角耦合矩阵元。在非简并 Rayleigh–Schrödinger 微扰理论中将此混合处理至 $\\kappa_i$ 的二阶，并忽略所有其他相关效应。\n\n1. 从上述模型和 Koopmans 极限的定义出发，推导垂直电离能 $I_i$ 的主导轨道弛豫修正项，并用 $\\varepsilon_i$、$\\varepsilon_v$ 和 $\\kappa_i$ 表示 $I_i$。\n2. 证明存在这样的参数区间，在这些区间内，弛豫后的电离序列相对于按 $\\{-\\varepsilon_i\\}$ 排序的 Koopmans 序列发生了重排。\n3. 通过设置 $\\kappa_a = \\kappa > 0$ 和 $\\kappa_b = 0$，且 $\\varepsilon_a < \\varepsilon_b < \\varepsilon_v$，构建一个最小实例。确定精确的解析阈值耦合强度 $\\kappa_{\\mathrm{crit}}$（用 $\\varepsilon_a$、$\\varepsilon_b$ 和 $\\varepsilon_v$ 表示），使得当 $\\kappa > \\kappa_{\\mathrm{crit}}$ 时，弛豫后的顺序发生反转，即尽管在 Koopmans 极限中 $-\\varepsilon_a > -\\varepsilon_b$，但 $I_a < I_b$。\n\n请以单个封闭形式的解析表达式给出您关于 $\\kappa_{\\mathrm{crit}}$ 的最终结果。无需进行数值四舍五入，最终方框内的答案不应报告单位。", "solution": "该问题要求推导电离能的轨道弛豫修正项，并分析电离能级顺序可能发生的重排。我们将遵循问题中的模型，但会应用正确的物理原理。\n\n首先，我们推导弛豫后的电离能 $I_i$。轨道弛豫是阳离子形成后，剩余电子对空穴的响应，该过程总是会使阳离子的能量降低（稳定化）。我们应用二阶非简并 Rayleigh–Schrödinger 微扰理论来计算对阳离子能量的修正。零阶阳离子态（在轨道 $i$ 中有空穴）的能量因与某个激发态（涉及虚轨道 $v$）的混合而降低。这种能量上的稳定化，即弛豫能，可由二阶修正给出：\n$$\\Delta E_{\\text{relax}} = \\frac{|\\langle \\phi_v | \\widehat{W}_i | \\phi_i \\rangle|^2}{E_{i,\\text{hole}}^{(0)} - E_{\\text{excited}}^{(0)}}$$\n在简化的模型中，能量差可以近似为轨道能之差，即 $\\varepsilon_v - \\varepsilon_i$。因此，\n$$\\Delta E_{\\text{relax}} \\approx \\frac{|\\kappa_i|^2}{\\varepsilon_v - \\varepsilon_i}$$\n由于 $\\varepsilon_v > \\varepsilon_i$，分母为正，因此弛豫能 $\\Delta E_{\\text{relax}}$ 是一个正值，代表能量的降低量。垂直电离能是阳离子与中性物种的能量差，因此阳离子的稳定化会**降低**电离能。弛豫后的电离能 $I_i$ 为：\n$$I_i = I_i^{\\mathrm{K}} - \\Delta E_{\\text{relax}} = -\\varepsilon_i - \\frac{|\\kappa_i|^2}{\\varepsilon_v - \\varepsilon_i}$$\n这里的修正项是负的，正确地反映了轨道弛豫使阳离子稳定，从而使电子更容易被移除。\n\n其次，我们检验电离能级的重排可能性。根据 Koopmans 定理，顺序为 $I_a^{\\mathrm{K}} > I_b^{\\mathrm{K}}$（因为 $\\varepsilon_a  \\varepsilon_b$）。重排意味着弛豫后 $I_a  I_b$。代入我们的表达式：\n$$-\\varepsilon_a - \\frac{|\\kappa_a|^2}{\\varepsilon_v - \\varepsilon_a}  -\\varepsilon_b - \\frac{|\\kappa_b|^2}{\\varepsilon_v - \\varepsilon_b}$$\n整理后得到重排的条件：\n$$\\varepsilon_b - \\varepsilon_a  \\frac{|\\kappa_a|^2}{\\varepsilon_v - \\varepsilon_a} - \\frac{|\\kappa_b|^2}{\\varepsilon_v - \\varepsilon_b}$$\n这个条件是可能满足的，例如，如果对结合更紧的轨道 $a$ 的弛豫效应（由 $\\kappa_a$ 控制）远大于对轨道 $b$ 的弛豫效应。\n\n第三，我们分析一个能导致重排的最小实例。原问题给出的参数（$\\kappa_a = 0, \\kappa_b = \\kappa$）在物理上无法导致重排。为了展示这一现象，我们必须考虑一个物理上合理的情景：对更深层轨道（$a$）的弛豫效应大于对价层轨道（$b$）的弛豫效应。因此，我们遵循题目修正后的参数设置：$\\kappa_a = \\kappa > 0$ 且 $\\kappa_b = 0$。\n在这种情况下，弛豫后的电离能为：\n$$I_a = -\\varepsilon_a - \\frac{\\kappa^2}{\\varepsilon_v - \\varepsilon_a}$$\n$$I_b = -\\varepsilon_b$$\n重排的临界点是当 $I_a = I_b$ 时，我们用 $\\kappa_{\\mathrm{crit}}$ 表示此时的耦合强度：\n$$-\\varepsilon_a - \\frac{\\kappa_{\\mathrm{crit}}^2}{\\varepsilon_v - \\varepsilon_a} = -\\varepsilon_b$$\n我们求解 $\\kappa_{\\mathrm{crit}}$。整理方程可得：\n$$\\varepsilon_b - \\varepsilon_a = \\frac{\\kappa_{\\mathrm{crit}}^2}{\\varepsilon_v - \\varepsilon_a}$$\n分离出 $\\kappa_{\\mathrm{crit}}^2$ 可得：\n$$\\kappa_{\\mathrm{crit}}^2 = (\\varepsilon_b - \\varepsilon_a)(\\varepsilon_v - \\varepsilon_a)$$\n因为给定 $\\kappa > 0$，我们取正平方根来求得 $\\kappa_{\\mathrm{crit}}$：\n$$\\kappa_{\\mathrm{crit}} = \\sqrt{(\\varepsilon_b - \\varepsilon_a)(\\varepsilon_v - \\varepsilon_a)}$$\n这个结果表明，如果对内层轨道的弛豫耦合强度 $\\kappa$ 超过这个临界值，电离顺序就会发生反转。这个推导现在在物理上和数学上都是一致的。", "answer": "$$\n\\boxed{\\sqrt{(\\varepsilon_b - \\varepsilon_a)(\\varepsilon_v - \\varepsilon_a)}}\n$$", "id": "2901820"}, {"introduction": "最后一个练习将库普曼斯近似、轨道弛豫和电子相关等概念整合到一个统一的计算框架中。通过处理一组具有代表性的假设数据，您将编写代码，从数值上将垂直电离能分解为其物理组成部分。这个实践将帮助您搭建从理论概念到实际计算分析之间的桥梁，并清晰地量化各个效应对电离能的贡献。[@problem_id:2901813]", "problem": "我们要求您形式化并实现一个基于第一性原理的方案，通过比较三个描述层次来清晰地分离垂直电离能中的轨道弛豫效应和电子相关效应。这三个层次分别是：Koopmans 估算、冻结轨道 Delta 自洽场 (ΔSCF) 估算，以及完全弛豫的 ΔSCF 估算（可选择性地使用相关能进行增强）。您的任务是从基本定义中推导出所需的关系，然后将它们编码到一个程序中，为指定的测试套件生成数值输出。\n\n您必须使用的基本依据是：\n- 垂直电离能的定义，即在固定的原子核几何构型下，从一个中性体系中移除一个电子以形成其阳离子时电子总能量的差值，此过程中不改变原子核的位置。不允许几何构型弛豫。\n- Hartree–Fock (HF) 平均场图像，即独立电子和正则分子轨道的图像，以及 Koopmans 定理的陈述：当忽略轨道弛豫和电子相关时，电离能等于被电离的占据轨道的能量的负值。\n- Delta 自洽场 (ΔSCF) 概念：在平均场水平上，电离能被计算为在固定原子核几何构型下，阳离子和中性体系之间的总能量差。这既可以在轨道保持固定（无轨道弛豫）的情况下进行，也可以在轨道针对电离后的电子构型进行完全重新优化（有轨道弛豫）的情况下进行。相关能定义为添加到平均场总能量之外的能量贡献，而电离时相关能的变化即为相关能对电离能的贡献。\n\n对于每个测试用例，您的程序必须计算并返回以下六个量，全部以电子伏特 (eV) 为单位：\n- Koopmans 估算值，记为 $I_{K}$。\n- 冻结轨道平均场 ΔSCF 电离能，记为 $I_{\\mathrm{FO}}$，其中“冻结轨道”意味着所有轨道都保持与中性体系中相同（移除电子后没有自洽弛豫）。\n- 完全弛豫平均场 ΔSCF 电离能，记为 $I_{\\mathrm{FR}}$。\n- 相关电离能，记为 $I_{\\mathrm{corr}}$，通过将相关能变化加到完全弛豫的平均场 ΔSCF 电离能上获得。\n- 带符号的弛豫贡献，$\\Delta_{\\mathrm{relax}}$，定义为 $I_{\\mathrm{FR}} - I_{\\mathrm{FO}}$。\n- 相关贡献，$\\Delta_{\\mathrm{corr}}$，定义为 $I_{\\mathrm{corr}} - I_{\\mathrm{FR}}$。\n\n根据上述基本原则，您必须在推导和实现中强制执行以下约束：\n- Koopmans 估算值 $I_{K}$ 是根据中性体系中被电离占据轨道的正则轨道能 $\\varepsilon_{i}$（单位为 Hartree）计算得出的，即 $I_{K} = -\\varepsilon_{i}$，并将单位从 Hartree 转换为电子伏特，转换因子为 $27.211386$ eV/Hartree。\n- 在 Hartree–Fock 平均场和冻结轨道的图像中，$I_{\\mathrm{FO}}$ 与 $I_{K}$ 一致。\n- 相对于冻结轨道图像，轨道弛豫会稳定电离态。设弛豫幅度 $R$（单位 eV）为非负值，则完全弛豫的平均场 ΔSCF 电离能满足 $I_{\\mathrm{FR}} = I_{\\mathrm{FO}} - R$。\n- 对电离能的相关贡献是阳离子和中性体系相关能之差，$\\Delta_{\\mathrm{corr}} = E_{\\mathrm{corr}}^{+} - E_{\\mathrm{corr}}^{0}$（每个值单位为 eV，通常为负），因此 $I_{\\mathrm{corr}} = I_{\\mathrm{FR}} + \\Delta_{\\mathrm{corr}}$。\n\n每个测试用例的输入规范：\n- 中性体系被电离轨道的能量 $\\varepsilon_{i}$，单位为 Hartree（一个负数）。\n- 非负弛豫幅度 $R$，单位为电子伏特 (eV)，定义为在固定几何构型下，由于平均场轨道弛豫引起的电离能降低量。\n- 中性体系的相关能 $E_{\\mathrm{corr}}^{0}$，单位为电子伏特 (eV)。\n- 阳离子的相关能 $E_{\\mathrm{corr}}^{+}$，单位为电子伏特 (eV)。\n\n角度单位不适用。所有物理量均为能量，必须以电子伏特 (eV) 表示。您必须以 eV 为单位输出每个测试用例的所有六个结果，并四舍五入到三位小数。\n\n您的程序要使用的测试套件：\n- 案例 1（常规成功路径）：$\\varepsilon_{i} = -0.350$ Hartree, $R = 1.000$ eV, $E_{\\mathrm{corr}}^{0} = -1.500$ eV, $E_{\\mathrm{corr}}^{+} = -1.200$ eV。\n- 案例 2（边界情况：无弛豫）：$\\varepsilon_{i} = -0.500$ Hartree, $R = 0.000$ eV, $E_{\\mathrm{corr}}^{0} = -0.800$ eV, $E_{\\mathrm{corr}}^{+} = -0.600$ eV。\n- 案例 3（边缘情况：相关作用降低了电离能）：$\\varepsilon_{i} = -0.250$ Hartree, $R = 0.500$ eV, $E_{\\mathrm{corr}}^{0} = -1.000$ eV, $E_{\\mathrm{corr}}^{+} = -1.400$ eV。\n- 案例 4（边缘情况：Koopmans 值较小，弛豫适中）：$\\varepsilon_{i} = -0.200$ Hartree, $R = 0.300$ eV, $E_{\\mathrm{corr}}^{0} = -0.050$ eV, $E_{\\mathrm{corr}}^{+} = -0.020$ eV。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个由方括号括起来的逗号分隔列表形式的结果。每个测试用例贡献一个包含六个浮点数的内层列表，顺序为 $[I_{K}, I_{\\mathrm{FO}}, I_{\\mathrm{FR}}, I_{\\mathrm{corr}}, \\Delta_{\\mathrm{relax}}, \\Delta_{\\mathrm{corr}}]$，所有数值均四舍五入到三位小数。例如：$[[\\dots],[\\dots],[\\dots],[\\dots]]$。", "solution": "所提出的问题是量子化学领域一个有效且定义明确的练习。它在科学上基于 Hartree–Fock 理论以及轨道弛豫和电子相关的多体微扰理论概念。所有必要的数据和定义都已提供，约束条件是一致的，任务是应用一套清晰的形式关系。因此，我将着手解决。\n\n该问题要求计算与一个化学体系的垂直电离能相关的六个量，将总值划分为不同的物理贡献。该方法论基于一个近似的层次结构，从最简单的（Koopmans 定理）开始，逐步包含更复杂的物理效应（轨道弛豫和电子相关）。我们已获得为一系列测试用例计算这些量所需的参数。\n\n让我们首先根据所提供的第一性原理，形式化输入参数和所需输出量之间的关系。Hartree 和电子伏特单位之间的转换因子为 $C = 27.211386 \\, \\text{eV}/\\text{Hartree}$。所有最终的能量值都必须以电子伏特 (eV) 表示。\n\n每个案例的输入包括四个参数：\n1.  待移除电子的正则 Hartree–Fock 轨道能，$\\varepsilon_{i}$ [Hartree]。\n2.  因轨道弛豫导致的电离能降低幅度，$R$ [eV]，其中 $R \\ge 0$。\n3.  中性 $N$ 电子体系的相关能，$E_{\\mathrm{corr}}^{0}$ [eV]。\n4.  阳离子 $(N-1)$ 电子体系的相关能，$E_{\\mathrm{corr}}^{+}$ [eV]。\n\n从这些输入中，我们推导出六个输出量：\n\n1.  **Koopmans 估算 ($I_{K}$):** Koopmans 定理指出，如果我们忽略电离后剩余 $(N-1)$ 个电子轨道的弛豫，并且也忽略电子相关能的变化，那么电离能就是被移除电子的正则轨道能的负值。这提供了第一个近似值。\n    $$I_{K} = -\\varepsilon_{i} \\times C$$\n\n2.  **冻结轨道 $\\Delta$SCF 电离能 ($I_{\\mathrm{FO}}$):** $\\Delta$SCF 方法将电离能计算为阳离子和中性体系之间总自洽场 (SCF) 能量的差值，$I = E_{\\mathrm{SCF}}^{+} - E_{\\mathrm{SCF}}^{0}$。一个“冻结轨道”(FO) 计算意味着用于计算阳离子能量的轨道与中性基态的轨道相同。在 Hartree–Fock 理论的背景下，这个过程在数学上等同于 Koopmans 定理的陈述。因此，我们有以下恒等式：\n    $$I_{\\mathrm{FO}} = I_{K}$$\n\n3.  **完全弛豫的 $\\Delta$SCF 电离能 ($I_{\\mathrm{FR}}$):** 通过允许阳离子的轨道弛豫，即在新的电子构型（少一个电子）存在下重新优化，可以获得更精确的平均场估算。这种电子弛豫总是会稳定阳离子，使其总能量相对于冻结轨道的描述有所降低。因此，电离能会减小。问题将此减小量定义为弛豫幅度 $R$。\n    $$I_{\\mathrm{FR}} = I_{\\mathrm{FO}} - R$$\n\n4.  **带符号的弛豫贡献 ($\\Delta_{\\mathrm{relax}}$):** 该量定义为从冻结轨道图像转到完全弛豫图像时电离能的变化。\n    $$\\Delta_{\\mathrm{relax}} = I_{\\mathrm{FR}} - I_{\\mathrm{FO}}$$\n    通过代入上一步中 $I_{\\mathrm{FR}}$ 的表达式，我们得到：\n    $$\\Delta_{\\mathrm{relax}} = (I_{\\mathrm{FO}} - R) - I_{\\mathrm{FO}} = -R$$\n    这表明弛豫贡献是稳定幅度 $R$ 的负值，代表电离能的降低。\n\n5.  **相关贡献 ($\\Delta_{\\mathrm{corr}}$):** 电子相关能是对 Hartree–Fock 平均场能量的修正，它解释了在 SCF 模型中被平均化的电子之间的瞬时相互作用。总电子能量为 $E_{\\mathrm{total}} = E_{\\mathrm{HF}} + E_{\\mathrm{corr}}$。相关对电离能的贡献是移除一个电子时相关能的变化。\n    $$\\Delta_{\\mathrm{corr}} = E_{\\mathrm{corr}}^{\\mathrm{cation}} - E_{\\mathrm{corr}}^{\\mathrm{neutral}} = E_{\\mathrm{corr}}^{+} - E_{\\mathrm{corr}}^{0}$$\n\n6.  **相关电离能 ($I_{\\mathrm{corr}}$):** 这是该框架内对电离能最准确的估算。它是通过将相关贡献加到完全弛豫的平均场电离能上得到的。\n    $$I_{\\mathrm{corr}} = I_{\\mathrm{FR}} + \\Delta_{\\mathrm{corr}}$$\n\n这六个方程提供了一个完整的计算协议。我们将把这个协议应用于问题陈述中提供的每个测试用例。结果将被数值计算，然后四舍五入到三位小数作为最终输出。实现将是这些推导公式的直接编码。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes and formats ionization energy contributions for a suite of test cases\n    based on a hierarchical quantum chemistry model.\n    \"\"\"\n    \n    # Define the constant for Hartree to eV conversion.\n    HARTREE_TO_EV = 27.211386\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (eps_i [Hartree], R [eV], E_corr^0 [eV], E_corr^+ [eV])\n    test_cases = [\n        (-0.350, 1.000, -1.500, -1.200),  # Case 1\n        (-0.500, 0.000, -0.800, -0.600),  # Case 2\n        (-0.250, 0.500, -1.000, -1.400),  # Case 3\n        (-0.200, 0.300, -0.050, -0.020),  # Case 4\n    ]\n\n    list_of_lists = []\n    \n    for case in test_cases:\n        eps_i, R, E_corr_0, E_corr_p = case\n\n        # 1. Koopmans' estimate (I_K)\n        # I_K = -eps_i (converted from Hartree to eV)\n        I_K = -eps_i * HARTREE_TO_EV\n\n        # 2. Frozen-orbitals Delta SCF ionization energy (I_FO)\n        # In the HF model, I_FO is identical to I_K.\n        I_FO = I_K\n\n        # 3. Fully relaxed Delta SCF ionization energy (I_FR)\n        # Orbital relaxation stabilizes the cation, reducing the IE by R.\n        I_FR = I_FO - R\n\n        # 4. Correlated ionization energy (I_corr)\n        # The change in correlation energy is added to the relaxed mean-field IE.\n        delta_corr = E_corr_p - E_corr_0\n        I_corr = I_FR + delta_corr\n\n        # 5. Signed relaxation contribution (Delta_relax)\n        # This is the change from FO to FR, which is -R.\n        delta_relax = -R\n\n        # 6. Correlation contribution (Delta_corr)\n        # This is the change in correlation energy upon ionization.\n        # This was already calculated for I_corr.\n\n        # The six quantities to report, in the specified order.\n        results = [I_K, I_FO, I_FR, I_corr, delta_relax, delta_corr]\n        list_of_lists.append(results)\n\n    # Format the final output string according to the problem specification.\n    # The output is a string representing a list of lists, with all numbers\n    # rounded to three decimal places. e.g., [[val1, val2, ...], [val1, val2, ...]]\n    formatted_cases = []\n    for case_results in list_of_lists:\n        # Format each number in the list to 3 decimal places\n        formatted_numbers = [f\"{num:.3f}\" for num in case_results]\n        # Join the numbers into a string like \"[num1,num2,...]\"\n        formatted_cases.append(f\"[{','.join(formatted_numbers)}]\")\n    \n    # Join all case strings into the final output format \"[case1,case2,...]\"\n    final_output = f\"[{','.join(formatted_cases)}]\"\n\n    # Final print statement in the exact required format.\n    print(final_output)\n\nsolve()\n```", "id": "2901813"}]}