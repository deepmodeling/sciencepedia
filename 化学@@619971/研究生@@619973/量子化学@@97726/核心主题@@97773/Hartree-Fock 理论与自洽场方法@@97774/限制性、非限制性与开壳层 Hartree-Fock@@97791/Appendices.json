{"hands_on_practices": [{"introduction": "非限制性哈特里-福克 (Unrestricted Hartree-Fock, UHF) 方法提供了更大的变分灵活性，但其代价通常是产生非纯自旋态的波函数。这种“自旋污染”不仅仅是一个定性上的缺陷，更是一个可以量化的物理量。本练习将引导你从第一性原理出发，推导一个普遍的双电子UHF行列式中自旋平方算符的期望值 $\\langle \\hat{S}^2 \\rangle$，从而直接揭示自旋污染程度与 $\\alpha$ 和 $\\beta$ 空间轨道之间的交叠积分之间的数学关系。[@problem_id:2921436]", "problem": "考虑一个由两个归一化的空间轨道 $\\,\\psi_{a}\\,$ 和 $\\,\\psi_{b}\\,$ 以及自旋函数 $\\,\\alpha\\,$ 和 $\\,\\beta\\,$ 构建的双电子非限制性哈特里-福克 (UHF) 单行列式波函数。其斯莱特行列式（反对称乘积）为\n$$\n\\Phi(1,2) \\;=\\; \\frac{1}{\\sqrt{2}}\\Big[\\psi_{a}(\\mathbf{r}_{1})\\,\\alpha(1)\\,\\psi_{b}(\\mathbf{r}_{2})\\,\\beta(2)\\;-\\;\\psi_{a}(\\mathbf{r}_{2})\\,\\alpha(2)\\,\\psi_{b}(\\mathbf{r}_{1})\\,\\beta(1)\\Big],\n$$\n其中归一化条件为 $\\,\\langle \\psi_{a}|\\psi_{a}\\rangle = \\langle \\psi_{b}|\\psi_{b}\\rangle = 1\\,$，重叠 $\\,S_{ab}=\\langle \\psi_{a}|\\psi_{b}\\rangle\\,$ 可能为复数。请仅使用总自旋算符 $\\,\\hat{S}^{2} = \\hat{S}_{1}^{2} + \\hat{S}_{2}^{2} + 2\\,\\hat{\\mathbf{S}}_{1}\\!\\cdot\\!\\hat{\\mathbf{S}}_{2}\\,$ 的第一性原理定义以及自旋函数和反对称乘积的性质，推导期望值 $\\,\\langle \\hat{S}^{2}\\rangle\\,$ 关于 $\\,S_{ab}\\,$ 的精确闭式表达式。\n\n你的最终答案必须是只含 $\\,S_{ab}\\,$ 的单个闭式解析表达式。无需单位。无需四舍五入。", "solution": "该问题已经过验证，被认定是有效的。这是一个量子化学中的适定问题，它在科学上是合理的、自洽的且客观的。我们现在开始进行形式推导。\n\n任务是计算给定双电子非限制性哈特里-福克 (UHF) 波函数的总自旋平方算符的期望值 $\\langle \\hat{S}^{2}\\rangle$。该波函数是一个单斯莱特行列式：\n$$\n\\Phi(1,2) \\;=\\; \\frac{1}{\\sqrt{2}}\\Big[\\psi_{a}(\\mathbf{r}_{1})\\,\\alpha(1)\\,\\psi_{b}(\\mathbf{r}_{2})\\,\\beta(2)\\;-\\;\\psi_{a}(\\mathbf{r}_{2})\\,\\alpha(2)\\,\\psi_{b}(\\mathbf{r}_{1})\\,\\beta(1)\\Big]\n$$\n使用狄拉克符号可以将其简写为：\n$$\n|\\Phi\\rangle \\;=\\; \\frac{1}{\\sqrt{2}}\\Big(|\\psi_a \\alpha\\rangle_1 |\\psi_b \\beta\\rangle_2 - |\\psi_b \\beta\\rangle_1 |\\psi_a \\alpha\\rangle_2\\Big)\n$$\n空间轨道 $\\psi_a$ 和 $\\psi_b$ 是归一化的，$\\langle \\psi_{a}|\\psi_{a}\\rangle = 1$ 且 $\\langle \\psi_{b}|\\psi_{b}\\rangle = 1$，具有非零的重叠积分 $S_{ab}=\\langle \\psi_{a}|\\psi_{b}\\rangle$。自旋函数 $\\alpha$ 和 $\\beta$ 是标准正交的。\n\n首先，我们必须验证所给波函数 $|\\Phi\\rangle$ 是归一化的。其模方为 $\\langle\\Phi|\\Phi\\rangle$：\n$$\n\\langle\\Phi|\\Phi\\rangle = \\frac{1}{2} \\left\\langle \\psi_a \\alpha(1)\\psi_b \\beta(2) - \\psi_b \\beta(1)\\psi_a \\alpha(2) \\Big| \\psi_a \\alpha(1)\\psi_b \\beta(2) - \\psi_b \\beta(1)\\psi_a \\alpha(2) \\right\\rangle\n$$\n展开后得到四项。我们对两个电子的空间和自旋坐标进行积分，记为 $\\int d\\tau_1 d\\tau_2$。\n$$\n\\langle\\Phi|\\Phi\\rangle = \\frac{1}{2}\\Big( \\langle\\psi_a\\alpha(1)\\psi_b\\beta(2)|\\psi_a\\alpha(1)\\psi_b\\beta(2)\\rangle - \\langle\\psi_a\\alpha(1)\\psi_b\\beta(2)|\\psi_b\\beta(1)\\psi_a\\alpha(2)\\rangle - \\langle\\psi_b\\beta(1)\\psi_a\\alpha(2)|\\psi_a\\alpha(1)\\psi_b\\beta(2)\\rangle + \\langle\\psi_b\\beta(1)\\psi_a\\alpha(2)|\\psi_b\\beta(1)\\psi_a\\alpha(2)\\rangle \\Big)\n$$\n我们计算每个内积：\n\\begin{itemize}\n    \\item $\\langle\\psi_a\\alpha|\\psi_a\\alpha\\rangle\\langle\\psi_b\\beta|\\psi_b\\beta\\rangle = \\langle\\psi_a|\\psi_a\\rangle\\langle\\alpha|\\alpha\\rangle\\langle\\psi_b|\\psi_b\\rangle\\langle\\beta|\\beta\\rangle = (1)(1)(1)(1) = 1$。\n    \\item $\\langle\\psi_a\\alpha|\\psi_b\\beta\\rangle\\langle\\psi_b\\beta|\\psi_a\\alpha\\rangle = (\\langle\\psi_a|\\psi_b\\rangle\\langle\\alpha|\\beta\\rangle)(\\langle\\psi_b|\\psi_a\\rangle\\langle\\beta|\\alpha\\rangle) = (S_{ab} \\cdot 0)(S_{ab}^* \\cdot 0) = 0$。\n    \\item 第三项是第二项的复共轭，因此也为 $0$。\n    \\item $\\langle\\psi_b\\beta|\\psi_b\\beta\\rangle\\langle\\psi_a\\alpha|\\psi_a\\alpha\\rangle = (1)(1)(1)(1) = 1$。\n\\end{itemize}\n因此，$\\langle\\Phi|\\Phi\\rangle = \\frac{1}{2}(1 - 0 - 0 + 1) = 1$。波函数是归一化的。\n\n双电子系统的总自旋算符 $\\hat{S}^{2}$ 由 $\\hat{S}^{2} = (\\hat{\\mathbf{S}}_{1} + \\hat{\\mathbf{S}}_{2})^2 = \\hat{S}_{1}^{2} + \\hat{S}_{2}^{2} + 2\\hat{\\mathbf{S}}_{1}\\cdot\\hat{\\mathbf{S}}_{2}$ 给出。我们使用原子单位，其中 $\\hbar=1$。点积可以展开为升降算符 $\\hat{S}_{\\pm} = \\hat{S}_x \\pm i\\hat{S}_y$ 和 $z$ 分量算符 $\\hat{S}_z$ 的形式：\n$$\n\\hat{S}^{2} = \\hat{S}_{1}^{2} + \\hat{S}_{2}^{2} + 2\\hat{S}_{z,1}\\hat{S}_{z,2} + \\hat{S}_{+,1}\\hat{S}_{-,2} + \\hat{S}_{-,1}\\hat{S}_{+,2}\n$$\n期望值为 $\\langle \\hat{S}^{2}\\rangle = \\langle \\Phi|\\hat{S}^{2}|\\Phi\\rangle$。我们逐项计算其贡献。\n\n单电子自旋平方算符 $\\hat{S}_{i}^{2}$ 作用于任何自旋为 $1/2$ 的波函数上，得到的本征值为 $s(s+1) = \\frac{1}{2}(\\frac{1}{2}+1) = \\frac{3}{4}$。\n$$\n\\langle \\Phi|(\\hat{S}_{1}^{2} + \\hat{S}_{2}^{2})|\\Phi\\rangle = \\langle \\Phi|(\\frac{3}{4} + \\frac{3}{4})|\\Phi\\rangle = \\frac{3}{2}\\langle\\Phi|\\Phi\\rangle = \\frac{3}{2}\n$$\n\n接下来，我们计算 $2\\hat{S}_{z,1}\\hat{S}_{z,2}$ 项。自旋函数 $\\alpha$ 和 $\\beta$ 是 $\\hat{S}_z$ 的本征函数，其本征值分别为 $+\\frac{1}{2}$ 和 $-\\frac{1}{2}$。\n$$\n2\\hat{S}_{z,1}\\hat{S}_{z,2}|\\Phi\\rangle = \\frac{2}{\\sqrt{2}} \\Big[ (\\hat{S}_{z,1}\\psi_a\\alpha(1))(\\hat{S}_{z,2}\\psi_b\\beta(2)) - (\\hat{S}_{z,2}\\psi_a\\alpha(2))(\\hat{S}_{z,1}\\psi_b\\beta(1)) \\Big]\n$$\n$$\n= \\frac{2}{\\sqrt{2}} \\Big[ (\\frac{1}{2}\\psi_a\\alpha(1))(-\\frac{1}{2}\\psi_b\\beta(2)) - (\\frac{1}{2}\\psi_a\\alpha(2))(-\\frac{1}{2}\\psi_b\\beta(1)) \\Big]\n$$\n$$\n= -\\frac{1}{2} \\cdot \\frac{1}{\\sqrt{2}} \\Big[ \\psi_a\\alpha(1)\\psi_b\\beta(2) - \\psi_a\\alpha(2)\\psi_b\\beta(1) \\Big] = -\\frac{1}{2}|\\Phi\\rangle\n$$\n因此，该项的期望值为 $\\langle \\Phi|2\\hat{S}_{z,1}\\hat{S}_{z,2}|\\Phi\\rangle = \\langle \\Phi|-\\frac{1}{2}|\\Phi\\rangle = -\\frac{1}{2}$。\n将这些对角项合并，我们得到的贡献为 $\\frac{3}{2} - \\frac{1}{2} = 1$。\n\n现在，我们必须计算自旋翻转项 $\\hat{S}_{+,1}\\hat{S}_{-,2} + \\hat{S}_{-,1}\\hat{S}_{+,2}$ 的贡献。我们使用升降算符的性质：$\\hat{S}_+\\alpha = 0$, $\\hat{S}_+\\beta = \\alpha$, $\\hat{S}_-\\alpha = \\beta$, $\\hat{S}_-\\beta = 0$。\n我们来计算每个算符对 $|\\Phi\\rangle$ 的作用：\n$$\n\\hat{S}_{+,1}\\hat{S}_{-,2}|\\Phi\\rangle = \\frac{1}{\\sqrt{2}} \\Big[ \\hat{S}_{+,1}\\hat{S}_{-,2}\\big(\\psi_a\\alpha(1)\\psi_b\\beta(2)\\big) - \\hat{S}_{+,1}\\hat{S}_{-,2}\\big(\\psi_b\\beta(1)\\psi_a\\alpha(2)\\big) \\Big]\n$$\n第一项为零，因为 $\\hat{S}_{+,1}\\alpha(1) = 0$。第二项变为：\n$$\n-\\frac{1}{\\sqrt{2}} \\big(\\hat{S}_{+,1}\\psi_b\\beta(1)\\big)\\big(\\hat{S}_{-,2}\\psi_a\\alpha(2)\\big) = -\\frac{1}{\\sqrt{2}} \\big(\\psi_b\\alpha(1)\\big)\\big(\\psi_a\\beta(2)\\big)\n$$\n所以，$\\hat{S}_{+,1}\\hat{S}_{-,2}|\\Phi\\rangle = -\\frac{1}{\\sqrt{2}} \\psi_b\\alpha(1)\\psi_a\\beta(2)$。\n\n类似地，对于 $\\hat{S}_{-,1}\\hat{S}_{+,2}$：\n$$\n\\hat{S}_{-,1}\\hat{S}_{+,2}|\\Phi\\rangle = \\frac{1}{\\sqrt{2}} \\Big[ \\hat{S}_{-,1}\\hat{S}_{+,2}\\big(\\psi_a\\alpha(1)\\psi_b\\beta(2)\\big) - \\hat{S}_{-,1}\\hat{S}_{+,2}\\big(\\psi_b\\beta(1)\\psi_a\\alpha(2)\\big) \\Big]\n$$\n第二项为零，因为 $\\hat{S}_{+,2}\\alpha(2) = 0$。第一项变为：\n$$\n\\frac{1}{\\sqrt{2}} \\big(\\hat{S}_{-,1}\\psi_a\\alpha(1)\\big)\\big(\\hat{S}_{+,2}\\psi_b\\beta(2)\\big) = \\frac{1}{\\sqrt{2}} \\big(\\psi_a\\beta(1)\\big)\\big(\\psi_b\\alpha(2)\\big)\n$$\n所以，$\\hat{S}_{-,1}\\hat{S}_{+,2}|\\Phi\\rangle = \\frac{1}{\\sqrt{2}} \\psi_a\\beta(1)\\psi_b\\alpha(2)$。\n\n现在我们计算期望值 $\\langle \\Phi | (\\hat{S}_{+,1}\\hat{S}_{-,2} + \\hat{S}_{-,1}\\hat{S}_{+,2}) | \\Phi \\rangle$：\n$$\n= \\left\\langle \\Phi \\left| \\left(-\\frac{1}{\\sqrt{2}} \\psi_b\\alpha(1)\\psi_a\\beta(2) + \\frac{1}{\\sqrt{2}} \\psi_a\\beta(1)\\psi_b\\alpha(2)\\right) \\right.\\right\\rangle\n$$\n$$\n= -\\frac{1}{\\sqrt{2}} \\langle \\Phi | \\psi_b\\alpha(1)\\psi_a\\beta(2) \\rangle + \\frac{1}{\\sqrt{2}} \\langle \\Phi | \\psi_a\\beta(1)\\psi_b\\alpha(2) \\rangle\n$$\n我们通过代入 $|\\Phi\\rangle$ 来计算每个内积：\n第一个内积:\n$$\n\\langle \\Phi | \\psi_b\\alpha(1)\\psi_a\\beta(2) \\rangle = \\frac{1}{\\sqrt{2}}\\langle \\psi_a\\alpha(1)\\psi_b\\beta(2) - \\psi_b\\beta(1)\\psi_a\\alpha(2) | \\psi_b\\alpha(1)\\psi_a\\beta(2) \\rangle\n$$\n$$\n= \\frac{1}{\\sqrt{2}} \\Big( \\langle\\psi_a\\alpha(1)|\\psi_b\\alpha(1)\\rangle\\langle\\psi_b\\beta(2)|\\psi_a\\beta(2)\\rangle - \\langle\\psi_b\\beta(1)|\\psi_b\\alpha(1)\\rangle\\langle\\psi_a\\alpha(2)|\\psi_a\\beta(2)\\rangle \\Big)\n$$\n第二项为零，因为 $\\langle\\beta|\\alpha\\rangle=0$。第一项为：\n$$\n\\frac{1}{\\sqrt{2}} \\big( \\langle\\psi_a|\\psi_b\\rangle\\langle\\alpha|\\alpha\\rangle \\cdot \\langle\\psi_b|\\psi_a\\rangle\\langle\\beta|\\beta\\rangle \\big) = \\frac{1}{\\sqrt{2}} (S_{ab} \\cdot 1 \\cdot S_{ab}^* \\cdot 1) = \\frac{1}{\\sqrt{2}} |S_{ab}|^2\n$$\n第二个内积:\n$$\n\\langle \\Phi | \\psi_a\\beta(1)\\psi_b\\alpha(2) \\rangle = \\frac{1}{\\sqrt{2}}\\langle \\psi_a\\alpha(1)\\psi_b\\beta(2) - \\psi_b\\beta(1)\\psi_a\\alpha(2) | \\psi_a\\beta(1)\\psi_b\\alpha(2) \\rangle\n$$\n$$\n= \\frac{1}{\\sqrt{2}} \\Big( \\langle\\psi_a\\alpha(1)|\\psi_a\\beta(1)\\rangle\\langle\\psi_b\\beta(2)|\\psi_b\\alpha(2)\\rangle - \\langle\\psi_b\\beta(1)|\\psi_a\\beta(1)\\rangle\\langle\\psi_a\\alpha(2)|\\psi_b\\alpha(2)\\rangle \\Big)\n$$\n第一项为零，因为 $\\langle\\alpha|\\beta\\rangle=0$。第二项为：\n$$\n-\\frac{1}{\\sqrt{2}} \\big( \\langle\\psi_b|\\psi_a\\rangle\\langle\\beta|\\beta\\rangle \\cdot \\langle\\psi_a|\\psi_b\\rangle\\langle\\alpha|\\alpha\\rangle \\big) = -\\frac{1}{\\sqrt{2}} (S_{ab}^* \\cdot 1 \\cdot S_{ab} \\cdot 1) = -\\frac{1}{\\sqrt{2}} |S_{ab}|^2\n$$\n将这些结果合并，得到自旋翻转项的期望值：\n$$\n= -\\frac{1}{\\sqrt{2}} \\left( \\frac{1}{\\sqrt{2}}|S_{ab}|^2 \\right) + \\frac{1}{\\sqrt{2}} \\left( -\\frac{1}{\\sqrt{2}}|S_{ab}|^2 \\right) = -\\frac{1}{2}|S_{ab}|^2 - \\frac{1}{2}|S_{ab}|^2 = -|S_{ab}|^2\n$$\n最后，我们将所有贡献相加，得到 $\\hat{S}^2$ 的总期望值：\n$$\n\\langle \\hat{S}^2 \\rangle = \\left(\\frac{3}{2}\\right) + \\left(-\\frac{1}{2}\\right) + \\left(-|S_{ab}|^2\\right) = 1 - |S_{ab}|^2\n$$\n这个结果是 UHF 波函数中自旋污染的度量。对于一个纯单重态（$S=0$，$\\langle \\hat{S}^2 \\rangle=0$），我们需要 $|S_{ab}|^2=1$，这在 $\\psi_a=\\psi_b$ 时发生，对应于限制性哈特里-福克 (RHF) 描述。对于正交的空间轨道（$S_{ab}=0$），$\\langle \\hat{S}^2 \\rangle=1$，这表明该状态是单重态（$S=0$）和三重态（$S=1$）分量的等量混合。", "answer": "$$\n\\boxed{1 - |S_{ab}|^2}\n$$", "id": "2921436"}, {"introduction": "在建立了自旋污染的数学根源之后，我们现在转向一个典型的化学问题，在这个问题中自旋污染变得至关重要：氢分子（$H_2$）的解离过程。限制性哈特里-福克（RHF）方法无法正确描述这一过程，而UHF方法虽然存在严重的自旋污染，却能给出定性正确的解离极限。本练习将引导你分析解离极限下的 $H_2$ 分子的UHF波函数，并准确理解为何其 $\\langle \\hat{S}^2 \\rangle$ 的值会趋近于1，这清晰地表明了波函数已经变成了真实的单重基态与一个三重态的非物理性混合。[@problem_id:2466572]", "problem": "考虑具有两个电子的氢分子，记作 $\\mathrm{H}_2$。在非限制性哈特里-福克 (Unrestricted Hartree-Fock, UHF) 近似中，允许 $\\alpha$-自旋和 $\\beta$-自旋的电子占据不同的空间轨道。在核间距 $R \\to \\infty$ 的大分离极限下，假设有两个分别以原子 $A$ 和 $B$ 为中心的正交归一、局域化的单电子轨道 $\\phi_A(\\mathbf{r})$ 和 $\\phi_B(\\mathbf{r})$，其交叠可忽略不计，即 $\\langle \\phi_A | \\phi_B \\rangle \\approx 0$。一个典型的在解离极限下的破缺对称UHF行列式将一个 $\\alpha$ 电子局域在 $A$ 上，一个 $\\beta$ 电子局域在 $B$ 上，即它使用由自旋轨道 $\\phi_A(\\mathbf{r})\\alpha$ 和 $\\phi_B(\\mathbf{r})\\beta$ 构建的Slater行列式。\n\n仅从以下几点出发：(i) Slater行列式在粒子交换下强制反对称性的定义，(ii) 总自旋单重态和三重态的标准双电子自旋本征函数\n$$\n\\chi_S = \\frac{1}{\\sqrt{2}}\\left(\\alpha(1)\\beta(2)-\\beta(1)\\alpha(2)\\right),\\quad\n\\chi_{T0} = \\frac{1}{\\sqrt{2}}\\left(\\alpha(1)\\beta(2)+\\beta(1)\\alpha(2)\\right),\n$$\n以及 (iii) 在 $R \\to \\infty$ 且交叠可忽略的极限下，对称和反对称乘积 $\\phi_A(1)\\phi_B(2)\\pm \\phi_B(1)\\phi_A(2)$ 是正交且范数相等的事实，分析UHF行列式在电子交换下的行为，将其分解为总自旋本征函数，并以此推断在解离极限下UHF态的期望值 $\\langle \\hat{S}^2 \\rangle$。忽略自旋-轨道耦合和任何外部场。\n\n哪个选项正确且精确地解释了为什么对解离的 $\\mathrm{H}_2$ 进行UHF计算会得到 $\\langle \\hat{S}^2 \\rangle \\to 1$，而不是单重态的值 $0$？\n\nA. 在 $R \\to \\infty$ 时，将一个 $\\alpha$ 电子定域于 $A$、一个 $\\beta$ 电子定域于 $B$ 的破缺对称UHF行列式可以写成总自旋单重态和 $M_S=0$ 三重态的等权重叠加，因为对称和反对称的空间组合变得正交且范数相等；因此 $\\langle \\hat{S}^2 \\rangle = \\tfrac{1}{2}\\cdot 0 + \\tfrac{1}{2}\\cdot 2 = 1$。\n\nB. 根据其构造，非限制性哈特里-福克 (UHF) 约束了 $\\langle \\hat{S}^2 \\rangle = \\langle \\hat{S}_z^2 \\rangle$；对于一个 $\\alpha$ 电子和一个 $\\beta$ 电子，$M_S=0$ 意味着 $\\langle \\hat{S}^2 \\rangle = 1$。\n\nC. 在 $R \\to \\infty$ 时，$\\mathrm{H}_2$ 的真实基态变为总自旋 $S=1$ 的三重态，所以UHF正确地预测了 $\\langle \\hat{S}^2 \\rangle \\to 1$。\n\nD. 在UHF中，$\\alpha$ 和 $\\beta$ 空间轨道在所有键长下都被强制要求相同，这使得行列式成为一个纯单重态；$\\langle \\hat{S}^2 \\rangle \\to 1$ 的偏差完全源于数值舍入误差。\n\n选择唯一一个选项。", "solution": "问题陈述关注的是氢分子 $\\mathrm{H}_2$ 在解离极限 ($R \\to \\infty$) 下的非限制性哈特里-福克 (UHF) 波函数的行为。该分析将基于量子力学的基本原理。\n\n首先，需要对问题陈述进行验证。\n\n**步骤1：提取已知条件**\n- 体系：$\\mathrm{H}_2$ 分子，两个电子。\n- 方法：非限制性哈特里-福克 (UHF)。\n- 极限：大核间距，$R \\to \\infty$。\n- 基组：两个正交归一、局域化的原子轨道 $\\phi_A(\\mathbf{r})$ 和 $\\phi_B(\\mathbf{r})$，其交叠可忽略不计，$\\langle \\phi_A | \\phi_B \\rangle \\approx 0$。\n- UHF波函数：由自旋轨道 $\\phi_A(\\mathbf{r})\\alpha$ 和 $\\phi_B(\\mathbf{r})\\beta$ 构建的Slater行列式。\n- 给定原理(i)：Slater行列式在粒子交换下强制反对称性。\n- 给定原理(ii)：单重态 ($S=0$) 和三重态 ($S=1$) 的 $M_S=0$ 分量的双电子总自旋本征函数为\n$$\n\\chi_S = \\frac{1}{\\sqrt{2}}\\left(\\alpha(1)\\beta(2)-\\beta(1)\\alpha(2)\\right)\n$$\n$$\n\\chi_{T0} = \\frac{1}{\\sqrt{2}}\\left(\\alpha(1)\\beta(2)+\\beta(1)\\alpha(2)\\right)\n$$\n- 给定原理(iii)：在 $R \\to \\infty$ 时，空间函数 $\\phi_A(1)\\phi_B(2)\\pm \\phi_B(1)\\phi_A(2)$ 是正交且范数相等。\n- 任务：将UHF行列式分解为总自旋本征函数，并用此求出期望值 $\\langle \\hat{S}^2 \\rangle$。\n\n**步骤2：使用提取的已知条件进行验证**\n该问题在科学上是合理的。关于解离 $\\mathrm{H}_2$ 的UHF方法的描述是量子化学中的一个经典例子，常用于阐释自旋污染的概念。所给定的原理是正确的定义以及指定极限下的推论。问题提得很好，提供了足够的信息来推导出所需的结果。语言精确且客观。未发现任何缺陷。\n\n**步骤3：结论与行动**\n问题有效。将推导一个完整的解。\n\n**推导**\n\nUHF波函数 $\\Psi_{UHF}$ 被描述为由自旋轨道 $\\psi_1 = \\phi_A\\alpha$ 和 $\\psi_2 = \\phi_B\\beta$ 构建的Slater行列式。对于一个双电子体系，它表示为：\n$$\n\\Psi_{UHF}(1, 2) = \\frac{1}{\\sqrt{2}} \\begin{vmatrix} \\psi_1(1) & \\psi_2(1) \\\\ \\psi_1(2) & \\psi_2(2) \\end{vmatrix} = \\frac{1}{\\sqrt{2}} \\begin{vmatrix} \\phi_A(1)\\alpha(1) & \\phi_B(1)\\beta(1) \\\\ \\phi_A(2)\\alpha(2) & \\phi_B(2)\\beta(2) \\end{vmatrix}\n$$\n展开行列式，我们得到：\n$$\n\\Psi_{UHF}(1, 2) = \\frac{1}{\\sqrt{2}} \\left[ \\phi_A(1)\\alpha(1)\\phi_B(2)\\beta(2) - \\phi_B(1)\\beta(1)\\phi_A(2)\\alpha(2) \\right]\n$$\n为了分析该状态的自旋特性，我们必须用所提供的总自旋本征函数 $\\chi_S$ 和 $\\chi_{T0}$ 来表示它。为此，我们通过重新排列 $\\chi_S$ 和 $\\chi_{T0}$ 的定义来表示简单的自旋乘积 $\\alpha(1)\\beta(2)$ 和 $\\beta(1)\\alpha(2)$：\n$$\n\\chi_{T0} + \\chi_S = \\sqrt{2} \\alpha(1)\\beta(2) \\implies \\alpha(1)\\beta(2) = \\frac{1}{\\sqrt{2}}(\\chi_{T0} + \\chi_S)\n$$\n$$\n\\chi_{T0} - \\chi_S = \\sqrt{2} \\beta(1)\\alpha(2) \\implies \\beta(1)\\alpha(2) = \\frac{1}{\\sqrt{2}}(\\chi_{T0} - \\chi_S)\n$$\n将这些代入 $\\Psi_{UHF}$ 的表达式中：\n$$\n\\Psi_{UHF}(1, 2) = \\frac{1}{\\sqrt{2}} \\left[ \\phi_A(1)\\phi_B(2) \\frac{1}{\\sqrt{2}}(\\chi_{T0} + \\chi_S) - \\phi_B(1)\\phi_A(2) \\frac{1}{\\sqrt{2}}(\\chi_{T0} - \\chi_S) \\right]\n$$\n合并含有 $\\chi_S$ 和 $\\chi_{T0}$ 的项：\n$$\n\\Psi_{UHF}(1, 2) = \\frac{1}{2} \\left[ (\\phi_A(1)\\phi_B(2) - \\phi_B(1)\\phi_A(2))\\chi_{T0} + (\\phi_A(1)\\phi_B(2) + \\phi_B(1)\\phi_A(2))\\chi_S \\right]\n$$\n我们定义未归一化的对称和反对称空间波函数：\n$$\n\\Phi_{\\text{sym}}(1,2) = \\phi_A(1)\\phi_B(2) + \\phi_B(1)\\phi_A(2)\n$$\n$$\n\\Phi_{\\text{asym}}(1,2) = \\phi_A(1)\\phi_B(2) - \\phi_B(1)\\phi_A(2)\n$$\n基态单重态波函数 $\\Psi_S$ 必须具有对称的空间部分，而 $M_S=0$ 的三重态波函数 $\\Psi_{T0}$ 必须具有反对称的空间部分。在 $R \\to \\infty$ 极限下，其中 $\\langle \\phi_A|\\phi_B \\rangle \\approx 0$，归一化后的版本是：\n$$\n\\Psi_S = \\frac{1}{\\sqrt{2}}\\Phi_{\\text{sym}}(1,2) \\chi_S \\quad (\\hat{S}^2 \\text{ 的本征函数，本征值为 } S(S+1)=0)\n$$\n$$\n\\Psi_{T0} = \\frac{1}{\\sqrt{2}}\\Phi_{\\text{asym}}(1,2) \\chi_{T0} \\quad (\\hat{S}^2 \\text{ 的本征函数，本征值为 } S(S+1)=2)\n$$\n使用这些定义，我们可以重写 $\\Psi_{UHF}$ 的表达式：\n$$\n\\Psi_{UHF} = \\frac{1}{2} \\left[ \\sqrt{2}\\Psi_{T0} + \\sqrt{2}\\Psi_S \\right] = \\frac{1}{\\sqrt{2}} ( \\Psi_S + \\Psi_{T0} )\n$$\n这表明破缺对称的UHF波函数不是一个纯自旋态（不是 $\\hat{S}^2$ 的本征函数）。相反，它是纯单重态 $\\Psi_S$ 和纯 $M_S=0$ 三重态 $\\Psi_{T0}$ 的线性组合，系数相等，均为 $1/\\sqrt{2}$。\n\n对于态 $\\Psi_{UHF}$，总自旋平方算符 $\\hat{S}^2$ 的期望值计算如下：\n$$\n\\langle \\hat{S}^2 \\rangle = \\langle \\Psi_{UHF} | \\hat{S}^2 | \\Psi_{UHF} \\rangle = \\left\\langle \\frac{1}{\\sqrt{2}}(\\Psi_S + \\Psi_{T0}) \\left| \\hat{S}^2 \\right| \\frac{1}{\\sqrt{2}}(\\Psi_S + \\Psi_{T0}) \\right\\rangle\n$$\n$$\n\\langle \\hat{S}^2 \\rangle = \\frac{1}{2} \\langle \\Psi_S + \\Psi_{T0} | \\hat{S}^2 \\Psi_S + \\hat{S}^2 \\Psi_{T0} \\rangle = \\frac{1}{2} \\langle \\Psi_S + \\Psi_{T0} | 0 \\cdot \\Psi_S + 2 \\cdot \\Psi_{T0} \\rangle\n$$\n由于 $\\Psi_S$ 和 $\\Psi_{T0}$ 是 $\\hat{S}^2$ 的本征函数，且本征值不同，所以它们是正交的，即 $\\langle \\Psi_S | \\Psi_{T0} \\rangle = 0$。利用这种正交性：\n$$\n\\langle \\hat{S}^2 \\rangle = \\frac{1}{2} \\left[ \\langle \\Psi_S | 2\\Psi_{T0} \\rangle + \\langle \\Psi_{T0} | 2\\Psi_{T0} \\rangle \\right] = \\frac{1}{2} \\left[ 0 + 2\\langle \\Psi_{T0} | \\Psi_{T0} \\rangle \\right]\n$$\n由于 $\\Psi_{T0}$ 是归一化的，所以 $\\langle \\Psi_{T0} | \\Psi_{T0} \\rangle = 1$。\n$$\n\\langle \\hat{S}^2 \\rangle = \\frac{1}{2} (2 \\cdot 1) = 1\n$$\n这个结果的出现是因为UHF态是单重态（概率为 $|1/\\sqrt{2}|^2 = 1/2$，对期望值的贡献为 $0$）和三重态（概率为 $|1/\\sqrt{2}|^2 = 1/2$，对期望值的贡献为 $2$）的等权重混合。平均值为 $(1/2) \\cdot 0 + (1/2) \\cdot 2 = 1$。\n\n**逐项分析**\n\nA. 在 $R \\to \\infty$ 时，将一个 $\\alpha$ 电子定域于 $A$、一个 $\\beta$ 电子定域于 $B$ 的破缺对称UHF行列式可以写成总自旋单重态和 $M_S=0$ 三重态的等权重叠加，因为对称和反对称的空间组合变得正交且范数相等；因此 $\\langle \\hat{S}^2 \\rangle = \\tfrac{1}{2}\\cdot 0 + \\tfrac{1}{2}\\cdot 2 = 1$。\n该选项是对上述推导的精确而准确的总结。分解为等权重叠加是正确的。所提供的理由（空间组合的正交性和相等范数）是正确的根本原因。最终的计算是正确的。\n结论：**正确**。\n\nB. 根据其构造，非限制性哈特里-福克 (UHF) 约束了 $\\langle \\hat{S}^2 \\rangle = \\langle \\hat{S}_z^2 \\rangle$；对于一个 $\\alpha$ 电子和一个 $\\beta$ 电子，$M_S=0$ 意味着 $\\langle \\hat{S}^2 \\rangle = 1$。\n这个陈述是不正确的。UHF并不施加 $\\langle \\hat{S}^2 \\rangle = \\langle \\hat{S}_z^2 \\rangle$ 的约束。对于所讨论的态，我们有一个 $\\alpha$ 电子和一个 $\\beta$ 电子，所以 $M_S = (N_\\alpha - N_\\beta)/2 = 0$。因此，$\\langle \\hat{S}_z \\rangle = 0$ 且 $\\langle \\hat{S}_z^2 \\rangle = 0$。这个错误的约束将意味着 $\\langle \\hat{S}^2 \\rangle = 0$，这与已知结果相矛盾。最后的推论“$M_S=0$ 意味着 $\\langle \\hat{S}^2 \\rangle = 1$”是没有根据且不正确的。\n结论：**不正确**。\n\nC. 在 $R \\to \\infty$ 时，$\\mathrm{H}_2$ 的真实基态变为总自旋 $S=1$ 的三重态，所以UHF正确地预测了 $\\langle \\hat{S}^2 \\rangle \\to 1$。\n这在事实上是不正确的。对于所有的核间距 $R$，$\\mathrm{H}_2$ 的基态都是一个单重态 ($S=0$)。在解离时，这个基态与最低的三重态 ($S=1$) 发生简并，但它本身不会变成三重态。真实的基态总是具有 $\\langle \\hat{S}^2 \\rangle = 0$。UHF得到 $\\langle \\hat{S}^2 \\rangle \\to 1$ 的结果是单行列式近似的一个众所周知的缺陷，称为自旋污染，而不是一个正确的预测。\n结论：**不正确**。\n\nD. 在UHF中，$\\alpha$ 和 $\\beta$ 空间轨道在所有键长下都被强制要求相同，这使得行列式成为一个纯单重态；$\\langle \\hat{S}^2 \\rangle \\to 1$ 的偏差完全源于数值舍入误差。\n这个陈述歪曲了UHF方法。强制 $\\alpha$ 和 $\\beta$ 空间轨道相同的方法是限制性哈特里-福克 (RHF)，而不是UHF。UHF的本质恰恰是允许这些轨道不同，这也就是导致在大 $R$ 处出现破缺对称解的原因。$\\langle \\hat{S}^2 \\rangle$ 从 $0$ 偏离到 $1$ 是UHF波函数在此极限下的一个基本性质，而不是一个微小的数值误差。\n结论：**不正确**。", "answer": "$$\\boxed{A}$$", "id": "2466572"}, {"introduction": "对量子化学方法的深刻理解要求我们将理论概念与其计算实现联系起来。这最后一个练习将专注于构建福克矩阵（Fock matrix），它是所有哈特里-福克计算的核心部分。你将把RHF、UHF和ROHF福克矩阵的规范定义转化为一个计算算法，从而揭示不同的自旋处理方式如何导致构建有效单电子哈密顿量的独特程序，以及这对计算成本意味着什么。[@problem_id:2921462]", "problem": "您的任务是形式化并实现量子化学中三种 Hartree-Fock 方法的 Fock 矩阵构建：限制性 Hartree-Fock (RHF)、非限制性 Hartree-Fock (UHF) 和限制性开壳层 Hartree-Fock (ROHF)。请完全在原子轨道基组中进行操作。您编写的程序必须使用从 Hartree-Fock 变分原理推导出的定义来计算 Fock 矩阵，并为每个变体提供领头阶的计算成本估计。所有量均采用原子单位，任何标量形式的类能结果（例如，Fock 矩阵的迹）都必须理解为以 Hartree 为单位。\n\n从基本定义开始：\n\n- 令单电子核心哈密顿矩阵表示为 $h_{\\mu \\nu}$。\n- 令物理学家标记法中的双电子排斥积分表示为 $(\\mu \\nu \\mid \\lambda \\sigma)$，其具有通常的 $8$ 重置换对称性 $(\\mu \\nu \\mid \\lambda \\sigma) = (\\nu \\mu \\mid \\lambda \\sigma) = (\\mu \\nu \\mid \\sigma \\lambda) = (\\lambda \\sigma \\mid \\mu \\nu) = \\dots$。\n- 对于任何密度矩阵 $P_{\\lambda \\sigma}$，将库仑和交换收缩定义为线性映射：\n  $$J_{\\mu \\nu}[P] \\equiv \\sum_{\\lambda \\sigma} (\\mu \\nu \\mid \\lambda \\sigma) \\, P_{\\lambda \\sigma}, \\qquad K_{\\mu \\nu}[P] \\equiv \\sum_{\\lambda \\sigma} (\\mu \\lambda \\mid \\nu \\sigma) \\, P_{\\lambda \\sigma}.$$\n- 用 $P^{\\alpha}$ 和 $P^{\\beta}$ 表示自旋分辨密度，用 $P^{\\mathrm{D}} \\equiv P^{\\alpha} + P^{\\beta}$ 表示总（自旋求和）密度。\n\n仅使用这些定义，构建以下 Fock 矩阵：\n\n1. 限制性 Hartree-Fock (RHF 风格，使用总密度)：\n   $$F^{\\mathrm{RHF}} \\equiv h + J[P^{\\mathrm{D}}] - \\tfrac{1}{2} K[P^{\\mathrm{D}}].$$\n\n2. 非限制性 Hartree-Fock (UHF)：\n   $$F^{\\alpha} \\equiv h + J[P^{\\alpha} + P^{\\beta}] - K[P^{\\alpha}], \\qquad F^{\\beta} \\equiv h + J[P^{\\alpha} + P^{\\beta}] - K[P^{\\beta}].$$\n\n3. 限制性开壳层 Hartree-Fock (ROHF，用于轨道优化的自旋平均有效 Fock)：\n   $$F^{\\mathrm{ROHF}} \\equiv \\tfrac{1}{2}\\big(F^{\\alpha} + F^{\\beta}\\big).$$\n\n在所有情况下，$F$ 都是一个索引为 $(\\mu,\\nu)$ 的矩阵。\n\n领头阶计算成本模型：\n\n- 在此模型中，将使用稠密数组对 $J[P]$ 或 $K[P]$ 的每次求值都视为一次单一的收缩，其领头阶成本随基函数数量 $N$ 的变化标度为 $\\mathcal{O}(N^4)$，并带有一个与 $N$ 无关的恒定前置因子。\n- 计算构建每个 Fock 矩阵表达式一次所需的此类稠密双电子收缩的数量，并将此数量报告为乘以 $\\mathcal{O}(N^4)$ 标度的领头阶系数 $\\gamma$。例如，如果需要一次 $J$ 收缩和两次 $K$ 收缩，则报告 $\\gamma = 3$。\n\n您的程序必须：\n\n- 对每个测试用例，使用上述定义计算 $F^{\\mathrm{RHF}}$、$F^{\\alpha}$、$F^{\\beta}$ 和 $F^{\\mathrm{ROHF}}$。\n- 对于每个计算出的 Fock 矩阵 $F$，返回标量 $\\operatorname{tr}(F)$，该值在原子单位下以 Hartree 为单位，并作为浮点数返回。\n- 对于每个变体 (RHF, UHF, ROHF)，根据上述表达式所隐含的稠密 $J$ 和 $K$ 收缩的最小数量，将领头阶收缩次数 $\\gamma$ 作为整数返回。\n- 所有角度（若有）都必须以弧度为单位。此任务中不存在角度。\n- 所有结果都必须作为不带单位注释的纯数字返回；但是，请将迹解释为 Hartree。\n\n测试套件规范：\n\n对于每个测试用例，您将获得确定性构建的 $N$、$h$、$(\\mu \\nu \\mid \\lambda \\sigma)$，以及表示在正交归一基组中占据数的对角自旋密度 $P^{\\alpha}$、$P^{\\beta}$。确定性构建规则如下：\n\n- 单电子矩阵：\n  $$h_{ij} = \\begin{cases}\n  -0.5 - 0.1 \\, i & \\text{if } i=j,\\\\\n  -0.1 \\left(1 + |i-j|\\right) & \\text{if } i \\neq j,\n  \\end{cases}$$\n  对于从零开始的索引 $i,j \\in \\{0,\\dots,N-1\\}$。\n\n- 双电子积分：\n  $$(i j \\mid k \\ell) = \\frac{1}{1 + i + j + k + \\ell},$$\n  其满足所有必需的置换对称性且严格为正。\n\n- 在给定基组中，自旋密度是对角的：\n  $$P^{\\alpha}_{ii} = \\begin{cases} 1 & \\text{if } i < n_{\\alpha},\\\\ 0 & \\text{otherwise,} \\end{cases} \\qquad\n  P^{\\beta}_{ii} = \\begin{cases} 1 & \\text{if } i < n_{\\beta},\\\\ 0 & \\text{otherwise,} \\end{cases}$$\n  所有非对角元素均为 $0$。\n\n使用以下测试套件，涵盖闭壳层、开壳层和单基函数边缘情况：\n\n- 情况 A (闭壳层)：$N = 2$，$n_{\\alpha} = 1$，$n_{\\beta} = 1$。\n- 情况 B (开壳层双重态)：$N = 3$，$n_{\\alpha} = 2$，$n_{\\beta} = 1$。\n- 情况 C (高自旋边缘情况)：$N = 1$，$n_{\\alpha} = 1$，$n_{\\beta} = 0$。\n\n要求的最终输出格式：\n\n- 您的程序应生成单行输出，其中包含用方括号括起来的、以逗号分隔的结果列表。\n- 每个测试用例的结果必须是以下形式的列表\n  $$\\big[\\operatorname{tr}(F^{\\mathrm{RHF}}), \\operatorname{tr}(F^{\\alpha}), \\operatorname{tr}(F^{\\beta}), \\operatorname{tr}(F^{\\mathrm{ROHF}}), \\gamma_{\\mathrm{RHF}}, \\gamma_{\\mathrm{UHF}}, \\gamma_{\\mathrm{ROHF}}\\big].$$\n- 将三个测试用例的列表聚合到一个单一的外部列表中。例如：\n  $$\\big[ [\\dots], [\\dots], [\\dots] \\big].$$\n输出中的所有数字都必须是纯数字（无单位或符号），且整个输出必须是有效的单行 Python 列表字面量。", "solution": "该问题要求对 Hartree-Fock 方法的三个变体进行形式化实现和计算成本分析：限制性 Hartree-Fock (RHF)、非限制性 Hartree-Fock (UHF) 以及限制性开壳层 Hartree-Fock (ROHF) 的一种特定形式。该问题是适定的，其科学基础是已建立的量子化学理论，并为获得唯一解提供了所有必要的定义和数据。因此，该问题被认为是有效的。\n\n解决方案首先定义基本量和操作，然后为每种方法推导 Fock 矩阵的结构，分析计算成本，最后概述实现逻辑。\n\n**1. 基本定义**\n\n我们在原子轨道 (AO) 基组中进行操作，用希腊字母索引如 $\\mu, \\nu, \\lambda, \\sigma$ 表示。基函数的数量为 $N$。\n\n- **核心哈密顿矩阵 ($h$)**：矩阵 $h_{\\mu\\nu}$ 包含单电子项，代表一个电子的动能及其在原子核场中的势能。\n\n- **双电子排斥积分 (ERIs)**：张量 $(\\mu \\nu \\mid \\lambda \\sigma)$ 代表两个电子之间的库仑排斥能，其中一个电子由电荷分布 $\\phi_\\mu^* \\phi_\\nu$ 描述，另一个由 $\\phi_\\lambda^* \\phi_\\sigma$ 描述。在物理学家标记法中，其定义为：\n$$(\\mu \\nu \\mid \\lambda \\sigma) = \\iint \\phi_\\mu^*(\\mathbf{r}_1) \\phi_\\nu(\\mathbf{r}_1) \\frac{1}{|\\mathbf{r}_1 - \\mathbf{r}_2|} \\phi_\\lambda^*(\\mathbf{r}_2) \\phi_\\sigma(\\mathbf{r}_2) \\, d\\mathbf{r}_1 d\\mathbf{r}_2.$$\n该张量具有 $8$ 重置换对称性，即 $(\\mu \\nu \\mid \\lambda \\sigma) = (\\nu \\mu \\mid \\lambda \\sigma) = (\\mu \\nu \\mid \\sigma \\lambda) = (\\lambda \\sigma \\mid \\mu \\nu)$，依此类推。\n\n- **密度矩阵 ($P^\\alpha, P^\\beta$)**：自旋密度矩阵分别描述 $\\alpha$ 自旋和 $\\beta$ 自旋电子的单电子分布。总密度矩阵是自旋密度的总和：\n$$P^{\\mathrm{D}} = P^{\\alpha} + P^{\\beta}.$$\n\n- **库仑和交换算符 ($J$ 和 $K$)**：双电子相互作用通过库仑 ($J$) 和交换 ($K$) 矩阵被纳入有效单电子 Fock 算符中。它们由给定密度矩阵 $P$ 的构造通过以下张量收缩定义：\n$$J_{\\mu \\nu}[P] \\equiv \\sum_{\\lambda \\sigma} (\\mu \\nu \\mid \\lambda \\sigma) \\, P_{\\lambda \\sigma}$$\n$$K_{\\mu \\nu}[P] \\equiv \\sum_{\\lambda \\sigma} (\\mu \\lambda \\mid \\nu \\sigma) \\, P_{\\lambda \\sigma}$$\n$J$ 矩阵代表一个电子从所有电子的平均电荷分布中感受到的经典库仑排斥。$K$ 矩阵是一个源于泡利不相容原理的纯粹量子力学术语，代表了同自旋电子之间的非经典相互作用。\n\n**2. Fock 矩阵构建与成本分析**\n\nFock 矩阵 $F$ 是 Hartree-Fock 近似中的有效单电子哈密顿量。其具体形式取决于施加在波函数上的自旋约束。\n\n**2.1. 限制性 Hartree-Fock (RHF)**\n\nRHF 方法适用于闭壳层体系，其中所有电子都在空间轨道中成对。控制所有电子的单一 Fock 矩阵为：\n$$F^{\\mathrm{RHF}} \\equiv h + J[P^{\\mathrm{D}}] - \\tfrac{1}{2} K[P^{\\mathrm{D}}].$$\n在这里，一个电子通过库仑项与总电子密度 $P^{\\mathrm{D}}$ 相互作用。交换相互作用是与同自旋的电子进行的。在闭壳层体系中，一半电子具有 $\\alpha$ 自旋，一半具有 $\\beta$ 自旋，这导致从总密度构建的交换项上带有一个 $\\tfrac{1}{2}$ 的因子。\n\n*   **计算成本 ($\\gamma_{\\mathrm{RHF}}$)**：要构建 $F^{\\mathrm{RHF}}$，必须计算 $J[P^{\\mathrm{D}}]$ 和 $K[P^{\\mathrm{D}}]$。这是两个不同的收缩，每个收缩的标度均为 $\\mathcal{O}(N^4)$。因此，领头阶收缩次数为 $\\gamma_{\\mathrm{RHF}} = 2$。\n\n**2.2. 非限制性 Hartree-Fock (UHF)**\n\nUHF 方法允许 $\\alpha$ 自旋和 $\\beta$ 自旋电子占据不同的空间轨道集。这对于开壳层体系或具有显著自旋极化的体系是必需的。构建了两个不同的 Fock 矩阵：\n$$F^{\\alpha} \\equiv h + J[P^{\\alpha} + P^{\\beta}] - K[P^{\\alpha}]$$\n$$F^{\\beta} \\equiv h + J[P^{\\alpha} + P^{\\beta}] - K[P^{\\beta}]$$\n一个 $\\alpha$ 电子感受到来自所有电子（密度为 $P^{\\alpha} + P^{\\beta}$）的库仑排斥，但只与其他 $\\alpha$ 电子（密度为 $P^{\\alpha}$）发生交换相互作用。一个对称的论证适用于 $\\beta$ 电子。项 $J[P^{\\alpha} + P^{\\beta}]$ 等价于 $J[P^{\\mathrm{D}}]$。\n\n*   **计算成本 ($\\gamma_{\\mathrm{UHF}}$)**：要同时构建 $F^{\\alpha}$ 和 $F^{\\beta}$，我们需要三个独立的 $\\mathcal{O}(N^4)$ 收缩：一个库仑项 $J[P^{\\mathrm{D}}]$ 和两个交换项 $K[P^{\\alpha}]$ 和 $K[P^{\\beta}]$。因此，领头阶收缩次数为 $\\gamma_{\\mathrm{UHF}} = 3$。\n\n**2.3. 限制性开壳层 Hartree-Fock (ROHF)**\n\nROHF 方法通过强制双占据轨道和单占据轨道共享相同的空间部分来处理开壳层体系。用于轨道优化的有效 Fock 矩阵有多种形式。本问题指定了一种特定的自旋平均形式：\n$$F^{\\mathrm{ROHF}} \\equiv \\tfrac{1}{2}\\big(F^{\\alpha} + F^{\\beta}\\big).$$\n代入 $F^{\\alpha}$ 和 $F^{\\beta}$ 的 UHF 表达式：\n$$F^{\\mathrm{ROHF}} = \\tfrac{1}{2} \\left( (h + J[P^{\\mathrm{D}}] - K[P^{\\alpha}]) + (h + J[P^{\\mathrm{D}}] - K[P^{\\beta}]) \\right)$$\n$$F^{\\mathrm{ROHF}} = h + J[P^{\\mathrm{D}}] - \\tfrac{1}{2} \\left( K[P^{\\alpha}] + K[P^{\\beta}] \\right).$$\n这代表了一个单一的有效哈密顿量，其本征函数可用于更新空间轨道。\n\n*   **计算成本($\\gamma_{\\mathrm{ROHF}}$)**: 为了从基本分量构建 $F^{\\mathrm{ROHF}}$，必须计算与 UHF 方法所需的相同的三个收缩：$J[P^{\\mathrm{D}}]$、$K[P^{\\alpha}]$ 和 $K[P^{\\beta}]$。因此，成本与 UHF 相同，$\\gamma_{\\mathrm{ROHF}} = 3$。\n\n**3. 实现算法**\n\n对于每个由 ($N, n_{\\alpha}, n_{\\beta}$) 定义的测试用例，执行以下步骤：\n1.  根据提供的确定性规则，构建 $N \\times N$ 核心哈密顿矩阵 $h$。\n2.  根据其规则，构建 $N \\times N \\times N \\times N$ 双电子排斥积分张量 $(\\mu \\nu \\mid \\lambda \\sigma)$。\n3.  根据占据数 $n_{\\alpha}$ 和 $n_{\\beta}$，构建对角的 $N \\times N$ 自旋密度矩阵 $P^{\\alpha}$ 和 $P^{\\beta}$。\n4.  计算总密度矩阵 $P^{\\mathrm{D}} = P^{\\alpha} + P^{\\beta}$。\n5.  使用 `numpy.einsum` 实现 $J[P]$ 和 $K[P]$ 收缩，以提高效率和清晰度。具体来说，$J_{\\mu\\nu}[P] = \\sum_{\\lambda\\sigma} (\\mu\\nu|\\lambda\\sigma) P_{\\lambda\\sigma}$ 变为 `np.einsum('uvls,ls->uv', ERI, P)`，$K_{\\mu\\nu}[P] = \\sum_{\\lambda\\sigma} (\\mu\\lambda|\\nu\\sigma) P_{\\lambda\\sigma}$ 变为 `np.einsum('ulvs,ls->uv', ERI, P)`。\n6.  使用上面推导的公式以及计算出的 $J$ 和 $K$ 矩阵，构建 Fock 矩阵 $F^{\\mathrm{RHF}}$、$F^{\\alpha}$、$F^{\\beta}$ 和 $F^{\\mathrm{ROHF}}$。\n7.  使用 `numpy.trace` 计算每个 Fock 矩阵的迹 $\\operatorname{tr}(F)$。\n8.  将每个测试用例的迹和预先确定的整数系数 $\\gamma$ 收集到一个列表中。\n9.  将所有测试用例的结果聚合到一个最终列表中以供输出。\n\n此过程正确且严谨地实现了指定的问题。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes RHF, UHF, and ROHF Fock matrices and their associated\n    computational costs for a given set of test cases.\n    \"\"\"\n\n    # Test cases are defined by (N, n_alpha, n_beta)\n    # N: number of basis functions\n    # n_alpha: number of alpha-spin electrons/occupied orbitals\n    # n_beta: number of beta-spin electrons/occupied orbitals\n    test_cases = [\n        (2, 1, 1),  # Case A: closed-shell\n        (3, 2, 1),  # Case B: open-shell doublet\n        (1, 1, 0),  # Case C: high-spin edge case\n    ]\n\n    # Leading-order computational cost coefficients (contraction counts)\n    # RHF: J[P_D], K[P_D] -> 2 contractions\n    gamma_rhf = 2\n    # UHF: J[P_D], K[P_alpha], K[P_beta] -> 3 contractions\n    gamma_uhf = 3\n    # ROHF (from scratch): J[P_D], K[P_alpha], K[P_beta] -> 3 contractions\n    gamma_rohf = 3\n\n    all_results = []\n\n    for N, n_alpha, n_beta in test_cases:\n        # 1. Construct one-electron core Hamiltonian matrix (h)\n        h = np.zeros((N, N))\n        for i in range(N):\n            for j in range(N):\n                if i == j:\n                    h[i, j] = -0.5 - 0.1 * i\n                else:\n                    h[i, j] = -0.1 * (1.0 + abs(i - j))\n\n        # 2. Construct two-electron repulsion integral tensor (ERI)\n        # Using physicist's notation (uv|ls)\n        eri = np.zeros((N, N, N, N))\n        for i in range(N):\n            for j in range(N):\n                for k in range(N):\n                    for l in range(N):\n                        eri[i, j, k, l] = 1.0 / (1.0 + i + j + k + l)\n\n        # 3. Construct spin-density matrices (P_alpha, P_beta)\n        # These are diagonal, representing occupations in the given basis.\n        p_alpha_diag = np.array([1.0 if i < n_alpha else 0.0 for i in range(N)])\n        p_beta_diag = np.array([1.0 if i < n_beta else 0.0 for i in range(N)])\n        P_alpha = np.diag(p_alpha_diag)\n        P_beta = np.diag(p_beta_diag)\n        \n        # 4. Total density matrix\n        P_total = P_alpha + P_beta\n\n        # 5. Define J and K builder functions using einsum\n        def build_J(P, eri_tensor):\n            # J[u,v] = sum_{l,s} (uv|ls) P[l,s]\n            return np.einsum('uvls,ls->uv', eri_tensor, P, optimize=True)\n\n        def build_K(P, eri_tensor):\n            # K[u,v] = sum_{l,s} (ul|vs) P[l,s]\n            return np.einsum('ulvs,ls->uv', eri_tensor, P, optimize=True)\n\n        # --- RHF Calculation ---\n        J_total_rhf = build_J(P_total, eri)\n        K_total_rhf = build_K(P_total, eri)\n        F_rhf = h + J_total_rhf - 0.5 * K_total_rhf\n        tr_rhf = np.trace(F_rhf)\n\n        # --- UHF Calculation ---\n        J_total_uhf = build_J(P_total, eri) # Same as J_total_rhf\n        K_alpha = build_K(P_alpha, eri)\n        K_beta = build_K(P_beta, eri)\n        \n        F_alpha = h + J_total_uhf - K_alpha\n        F_beta = h + J_total_uhf - K_beta\n        tr_alpha = np.trace(F_alpha)\n        tr_beta = np.trace(F_beta)\n\n        # --- ROHF Calculation ---\n        # Based on theproblem's definition F_rohf = 0.5 * (F_alpha + F_beta)\n        F_rohf = 0.5 * (F_alpha + F_beta)\n        tr_rohf = np.trace(F_rohf)\n        \n        # Assemble the results for the current test case\n        case_results = [\n            tr_rhf, \n            tr_alpha, \n            tr_beta, \n            tr_rohf, \n            gamma_rhf, \n            gamma_uhf, \n            gamma_rohf\n        ]\n        all_results.append(case_results)\n\n    # Final print statement in the exact required format.\n    # The f-string representation of a list of lists is a valid Python list literal.\n    print(f\"{all_results}\")\n\nsolve()\n```", "id": "2921462"}]}