{"hands_on_practices": [{"introduction": "这项实践是基础性的，旨在巩固您对如何将Slater-Condon规则应用于具体多电子系统的理解。通过显式地计算自旋积分，您还将更深刻地体会到自旋选择定则的来源，这是电子结构理论的基石之一。[@problem_id:2924391]", "problem": "考虑在 Born–Oppenheimer 近似下，对于固定原子核的非相对论、无自旋的电子哈密顿算符，\n$$\n\\hat{H}=\\sum_{k=1}^{N}\\hat{h}(k)+\\sum_{1\\le k<\\ell\\le N}\\hat{g}(k,\\ell),\n$$\n其单电子算符为\n$$\n\\hat{h}(k)=-\\frac{1}{2}\\nabla_k^2-\\sum_{A}\\frac{Z_A}{|\\mathbf{r}_k-\\mathbf{R}_A|},\n$$\n双电子库仑算符为\n$$\n\\hat{g}(k,\\ell)=\\frac{1}{r_{k\\ell}}.\n$$\n令 $x\\equiv(\\mathbf{r},\\omega)$ 表示组合的空间与自旋坐标。设 $\\{\\chi_p(x)\\}$ 为一组标准正交的自旋轨道，其下述五个明确指定的成员由标准正交的空间轨道 $\\{\\phi_p(\\mathbf{r})\\}$ 和自旋函数 $\\alpha(\\omega)$、$\\beta(\\omega)$ 构成：\n$$\n\\chi_1(x)=\\phi_1(\\mathbf{r})\\,\\alpha(\\omega),\\quad\n\\chi_2(x)=\\phi_2(\\mathbf{r})\\,\\alpha(\\omega),\\quad\n\\chi_3(x)=\\phi_3(\\mathbf{r})\\,\\beta(\\omega),\n$$\n$$\n\\chi_4(x)=\\phi_4(\\mathbf{r})\\,\\alpha(\\omega),\\quad\n\\chi_5(x)=\\phi_5(\\mathbf{r})\\,\\beta(\\omega).\n$$\n所有自旋函数都是标准正交的，$\\int \\alpha^{*}(\\omega)\\alpha(\\omega)\\,d\\omega=\\int \\beta^{*}(\\omega)\\beta(\\omega)\\,d\\omega=1$ 且 $\\int \\alpha^{*}(\\omega)\\beta(\\omega)\\,d\\omega=0$，所有空间轨道也都是标准正交的，$\\int \\phi_p^{*}(\\mathbf{r})\\phi_q(\\mathbf{r})\\,d\\mathbf{r}=\\delta_{pq}$。\n\n考虑一个由三 ($3$) 个电子组成的体系，其 Slater 行列式为\n$$\n\\Phi_0(x_1,x_2,x_3)=\\frac{1}{\\sqrt{3!}}\n\\begin{vmatrix}\n\\chi_1(x_1) & \\chi_2(x_1) & \\chi_3(x_1) \\\\\n\\chi_1(x_2) & \\chi_2(x_2) & \\chi_3(x_2) \\\\\n\\chi_1(x_3) & \\chi_2(x_3) & \\chi_3(x_3)\n\\end{vmatrix}.\n$$\n通过在固定列位置进行轨道替换（不重新排列各列），定义三个单激发行列式：$\\Phi_1^{4}$ 通过替换 $\\chi_1\\to\\chi_4$ 得到，$\\Phi_3^{5}$ 通过替换 $\\chi_3\\to\\chi_5$ 得到，以及 $\\Phi_1^{5}$ 通过替换 $\\chi_1\\to\\chi_5$ 得到。\n\n引入标准的单电子和双电子自旋轨道积分，\n$$\nh_{pq}=\\int \\chi_p^{*}(x)\\,\\hat{h}(1)\\,\\chi_q(x)\\,dx,\n$$\n$$\n(pq|rs)=\\iint \\chi_p^{*}(x_1)\\chi_q^{*}(x_2)\\,\\frac{1}{r_{12}}\\,\\chi_r(x_1)\\chi_s(x_2)\\,dx_1\\,dx_2,\n$$\n其中 $dx\\equiv d\\mathbf{r}\\,d\\omega$ 且 $dx_1\\,dx_2\\equiv d\\mathbf{r}_1\\,d\\omega_1\\,d\\mathbf{r}_2\\,d\\omega_2$。\n\n从这些定义和哈密顿算符出发，仅利用 Slater 行列式的标准正交性和反对称性，计算以下哈密顿矩阵元，并以 $h_{pq}$ 和 $(pq|rs)$ 的形式给出完全简化的解析形式：\n- 对角能量 $E_0=\\langle \\Phi_0|\\hat{H}|\\Phi_0\\rangle$。\n- 单激发耦合项 $V_{1\\to 4}=\\langle \\Phi_0|\\hat{H}|\\Phi_1^{4}\\rangle$，$V_{3\\to 5}=\\langle \\Phi_0|\\hat{H}|\\Phi_3^{5}\\rangle$ 和 $V_{1\\to 5}=\\langle \\Phi_0|\\hat{H}|\\Phi_1^{5}\\rangle$。\n\n通过显式计算自旋积分来确认哪些项会消失及其原因，从而建立自旋守恒与自旋翻转单激发的选择定则。\n\n将最终答案表示为单行矩阵 $\\big(E_0,\\;V_{1\\to 4},\\;V_{3\\to 5},\\;V_{1\\to 5}\\big)$，仅使用 $h_{pq}$ 和 $(pq|rs)$。不需要进行数值计算，也无取整要求。最终答案中不包含单位。", "solution": "该问题要求计算 Slater 行列式之间的哈密顿矩阵元。求解过程始于对问题陈述的验证。该问题被认为是科学基础扎实、提法恰当、客观且自洽的。这是量子化学中的一个标准练习，因此被认为是有效的。我们可以开始求解。\n\n哈密顿算符由单电子算符 $\\hat{F} = \\sum_{k=1}^{N} \\hat{h}(k)$ 和双电子算符 $\\hat{G} = \\sum_{1 \\le k < \\ell \\le N} \\hat{g}(k,\\ell)$ 的和给出，其中对于本问题 $N=3$。此哈密顿算符在由标准正交自旋轨道集 $\\{\\chi_p\\}$ 构建的 Slater 行列式之间的矩阵元，由 Slater-Condon 规则确定。这些规则是波函数的反对称性和自旋轨道的标准正交性的直接结果。\n\n设 $\\Psi_A$ 和 $\\Psi_B$ 为两个 N 电子 Slater 行列式。\n$1.$ 若 $\\Psi_A$ 和 $\\Psi_B$ 相同，$\\Psi_A = |\\chi_{a_1} \\chi_{a_2} \\dots \\chi_{a_N}\\rangle$，则对角矩阵元为：\n$$\n\\langle \\Psi_A | \\hat{H} | \\Psi_A \\rangle = \\sum_{i=1}^{N} h_{a_i a_i} + \\sum_{1 \\le i < j \\le N} \\left[ (a_i a_j | a_i a_j) - (a_i a_j | a_j a_i) \\right]\n$$\n$2.$ 若 $\\Psi_B$ 与 $\\Psi_A$ 仅相差一个自旋轨道，即 $\\Psi_A$ 中的 $\\chi_{a_p}$ 在 $\\Psi_B$ 中被 $\\chi_{b_q}$ 替换，则非对角矩阵元为：\n$$\n\\langle \\Psi_A | \\hat{H} | \\Psi_B \\rangle = h_{a_p b_q} + \\sum_{j=1, j \\ne p}^{N} \\left[ (a_p a_j | b_q a_j) - (a_p a_j | a_j b_q) \\right]\n$$\n$3.$ 若 $\\Psi_A$ 和 $\\Psi_B$ 相差两个或更多自旋轨道，则 $\\hat{H}$ 的矩阵元为零。\n\n单电子和双电子积分是基于自旋轨道定义的。由于算符 $\\hat{h}$ 和 $\\hat{g}$ 均与自旋无关，这些积分可以分解为空间部分和自旋部分。\n设一个自旋轨道为 $\\chi_p(x) = \\phi_p(\\mathbf{r})\\sigma_p(\\omega)$，其中 $\\sigma_p$ 为 $\\alpha$ 或 $\\beta$。\n单电子积分为：\n$$\nh_{pq} = \\int \\chi_p^{*}(x)\\hat{h}(1)\\chi_q(x)dx = \\left( \\int \\phi_p^{*}(\\mathbf{r})\\hat{h}(1)\\phi_q(\\mathbf{r})d\\mathbf{r} \\right) \\left( \\int \\sigma_p^{*}(\\omega)\\sigma_q(\\omega)d\\omega \\right) = h_{pq}^{\\text{space}} \\delta_{\\sigma_p, \\sigma_q}\n$$\n双电子积分为：\n$$\n(pq|rs) = \\iint \\chi_p^{*}(x_1)\\chi_q^{*}(x_2)\\frac{1}{r_{12}}\\chi_r(x_1)\\chi_s(x_2)dx_1 dx_2 = [\\phi_p\\phi_r|\\phi_q\\phi_s] \\delta_{\\sigma_p, \\sigma_r} \\delta_{\\sigma_q, \\sigma_s}\n$$\n其中 $[\\phi_p\\phi_r|\\phi_q\\phi_s]$ 表示积分的空间部分。克罗内克 $\\delta_{\\sigma_i,\\sigma_j}$ 保证了自旋守恒。\n\n参考行列式为 $\\Phi_0 = |\\chi_1 \\chi_2 \\chi_3\\rangle$。自旋分配为 $\\chi_1=\\phi_1\\alpha$，$\\chi_2=\\phi_2\\alpha$，$\\chi_3=\\phi_3\\beta$。\n\n**1. 对角能量 $E_0 = \\langle \\Phi_0|\\hat{H}|\\Phi_0\\rangle$**\n占据的自旋轨道集为 $\\{\\chi_1, \\chi_2, \\chi_3\\}$。应用对角的 Slater-Condon 规则：\n$$\nE_0 = h_{11} + h_{22} + h_{33} + [(12|12) - (12|21)] + [(13|13) - (13|31)] + [(23|23) - (23|32)]\n$$\n我们检查每一项的自旋部分。\n- $h_{11}, h_{22}, h_{33}$：自旋函数相同，例如 $\\delta_{\\sigma_1, \\sigma_1}=1$。这些项非零。\n- $(12|12)$：一个库仑积分。自旋因子为 $\\delta_{\\sigma_1, \\sigma_1}\\delta_{\\sigma_2, \\sigma_2} = \\delta_{\\alpha, \\alpha}\\delta_{\\alpha, \\alpha} = 1$。非零。\n- $(12|21)$：一个交换积分。自旋因子为 $\\delta_{\\sigma_1, \\sigma_2}\\delta_{\\sigma_2, \\sigma_1} = \\delta_{\\alpha, \\alpha}\\delta_{\\alpha, \\alpha} = 1$。非零。\n- $(13|13)$：一个库仑积分。自旋因子为 $\\delta_{\\sigma_1, \\sigma_1}\\delta_{\\sigma_3, \\sigma_3} = \\delta_{\\alpha, \\alpha}\\delta_{\\beta, \\beta} = 1$。非零。\n- $(13|31)$：一个交换积分。自旋因子为 $\\delta_{\\sigma_1, \\sigma_3}\\delta_{\\sigma_3, \\sigma_1} = \\delta_{\\alpha, \\beta}\\delta_{\\beta, \\alpha} = 0$。此项为零。\n- $(23|23)$：一个库仑积分。自旋因子为 $\\delta_{\\sigma_2, \\sigma_2}\\delta_{\\sigma_3, \\sigma_3} = \\delta_{\\alpha, \\alpha}\\delta_{\\beta, \\beta} = 1$。非零。\n- $(23|32)$：一个交换积分。自旋因子为 $\\delta_{\\sigma_2, \\sigma_3}\\delta_{\\sigma_3, \\sigma_2} = \\delta_{\\alpha, \\beta}\\delta_{\\beta, \\alpha} = 0$。此项为零。\n\n不同自旋的自旋轨道之间的交换积分为零。因此，能量为：\n$$\nE_0 = h_{11} + h_{22} + h_{33} + (12|12) - (12|21) + (13|13) + (23|23)\n$$\n\n**2. 单激发 $V_{1\\to 4}=\\langle \\Phi_0|\\hat{H}|\\Phi_1^{4}\\rangle$**\n$\\Phi_1^{4} = |\\chi_4 \\chi_2 \\chi_3\\rangle$。这是一个单激发 $\\chi_1 \\to \\chi_4$。旁观自旋轨道为 $\\chi_2$ 和 $\\chi_3$。自旋分配为 $\\sigma_1=\\alpha, \\sigma_2=\\alpha, \\sigma_3=\\beta, \\sigma_4=\\alpha$。这是一个自旋守恒的激发。\n应用单激发规则：\n$$\nV_{1\\to 4} = h_{14} + [(12|42) - (12|24)] + [(13|43) - (13|34)]\n$$\n- $h_{14}$：自旋因子为 $\\delta_{\\sigma_1, \\sigma_4} = \\delta_{\\alpha, \\alpha} = 1$。非零。\n- $(12|42)$：类库仑积分。自旋因子 $\\delta_{\\sigma_1, \\sigma_4}\\delta_{\\sigma_2, \\sigma_2} = \\delta_{\\alpha, \\alpha}\\delta_{\\alpha, \\alpha} = 1$。非零。\n- $(12|24)$：类交换积分。自旋因子 $\\delta_{\\sigma_1, \\sigma_2}\\delta_{\\sigma_2, \\sigma_4} = \\delta_{\\alpha, \\alpha}\\delta_{\\alpha, \\alpha} = 1$。非零。\n- $(13|43)$：类库仑积分。自旋因子 $\\delta_{\\sigma_1, \\sigma_4}\\delta_{\\sigma_3, \\sigma_3} = \\delta_{\\alpha, \\alpha}\\delta_{\\beta, \\beta} = 1$。非零。\n- $(13|34)$：类交换积分。自旋因子 $\\delta_{\\sigma_1, \\sigma_3}\\delta_{\\sigma_3, \\sigma_4} = \\delta_{\\alpha, \\beta}\\delta_{\\beta, \\alpha} = 0$。此项为零。\n该矩阵元为：\n$$\nV_{1\\to 4} = h_{14} + (12|42) - (12|24) + (13|43)\n$$\n\n**3. 单激发 $V_{3\\to 5}=\\langle \\Phi_0|\\hat{H}|\\Phi_3^{5}\\rangle$**\n$\\Phi_3^{5} = |\\chi_1 \\chi_2 \\chi_5\\rangle$。这是一个单激发 $\\chi_3 \\to \\chi_5$。旁观自旋轨道为 $\\chi_1$ 和 $\\chi_2$。自旋分配为 $\\sigma_1=\\alpha, \\sigma_2=\\alpha, \\sigma_3=\\beta, \\sigma_5=\\beta$。这也是一个自旋守恒的激发。\n应用单激发规则：\n$$\nV_{3\\to 5} = h_{35} + [(31|51) - (31|15)] + [(32|52) - (32|25)]\n$$\n- $h_{35}$：自旋因子为 $\\delta_{\\sigma_3, \\sigma_5} = \\delta_{\\beta, \\beta} = 1$。非零。\n- $(31|51)$：类库仑积分。自旋因子 $\\delta_{\\sigma_3, \\sigma_5}\\delta_{\\sigma_1, \\sigma_1} = \\delta_{\\beta, \\beta}\\delta_{\\alpha, \\alpha} = 1$。非零。\n- $(31|15)$：类交换积分。自旋因子 $\\delta_{\\sigma_3, \\sigma_1}\\delta_{\\sigma_1, \\sigma_5} = \\delta_{\\beta, \\alpha}\\delta_{\\alpha, \\beta} = 0$。此项为零。\n- $(32|52)$：类库仑积分。自旋因子 $\\delta_{\\sigma_3, \\sigma_5}\\delta_{\\sigma_2, \\sigma_2} = \\delta_{\\beta, \\beta}\\delta_{\\alpha, \\alpha} = 1$。非零。\n- $(32|25)$：类交换积分。自旋因子 $\\delta_{\\sigma_3, \\sigma_2}\\delta_{\\sigma_2, \\sigma_5} = \\delta_{\\beta, \\alpha}\\delta_{\\alpha, \\beta} = 0$。此项为零。\n该矩阵元为：\n$$\nV_{3\\to 5} = h_{35} + (31|51) + (32|52)\n$$\n\n**4. 单激发 $V_{1\\to 5}=\\langle \\Phi_0|\\hat{H}|\\Phi_1^{5}\\rangle$**\n$\\Phi_1^{5} = |\\chi_5 \\chi_2 \\chi_3\\rangle$。这是一个单激发 $\\chi_1 \\to \\chi_5$。旁观自旋轨道为 $\\chi_2$ 和 $\\chi_3$。自旋分配为 $\\sigma_1=\\alpha, \\sigma_2=\\alpha, \\sigma_3=\\beta, \\sigma_5=\\beta$。这是一个自旋翻转的激发（$\\alpha \\to \\beta$）。总自旋投影从 $\\Phi_0$ 的 $M_S=1/2$ 变为 $\\Phi_1^5$ 的 $M_S=-1/2$。由于哈密顿算符 $\\hat{H}$ 不含自旋，它与总自旋投影算符 $\\hat{S}_z$ 对易，因此它在具有不同 $M_S$ 本征值的态之间的矩阵元必须为零。我们通过显式计算积分来证实这一点。\n应用单激发规则：\n$$\nV_{1\\to 5} = h_{15} + [(12|52) - (12|25)] + [(13|53) - (13|35)]\n$$\n- $h_{15}$：自旋因子为 $\\delta_{\\sigma_1, \\sigma_5} = \\delta_{\\alpha, \\beta} = 0$。为零。\n- $(12|52)$：自旋因子 $\\delta_{\\sigma_1, \\sigma_5}\\delta_{\\sigma_2, \\sigma_2} = \\delta_{\\alpha, \\beta}\\delta_{\\alpha, \\alpha} = 0 \\cdot 1 = 0$。为零。\n- $(12|25)$：自旋因子 $\\delta_{\\sigma_1, \\sigma_2}\\delta_{\\sigma_2, \\sigma_5} = \\delta_{\\alpha, \\alpha}\\delta_{\\alpha, \\beta} = 1 \\cdot 0 = 0$。为零。\n- $(13|53)$：自旋因子 $\\delta_{\\sigma_1, \\sigma_5}\\delta_{\\sigma_3, \\sigma_3} = \\delta_{\\alpha, \\beta}\\delta_{\\beta, \\beta} = 0 \\cdot 1 = 0$。为零。\n- $(13|35)$：自旋因子 $\\delta_{\\sigma_1, \\sigma_3}\\delta_{\\sigma_3, \\sigma_5} = \\delta_{\\alpha, \\beta}\\delta_{\\beta, \\beta} = 0 \\cdot 1 = 0$。为零。\n表达式中的每一项都因自旋正交性而为零。\n$$\nV_{1\\to 5} = 0\n$$\n这个结果明确地展示了该无自旋哈密顿算符的选择定则：它不能引起改变体系净自旋的跃迁。\n\n综合所有结果，我们得到了所要求的四个量的最终表达式。这些结果以所要求的矩阵格式呈现。", "answer": "$$\n\\boxed{\\begin{pmatrix} h_{11} + h_{22} + h_{33} + (12|12) - (12|21) + (13|13) + (23|23) & h_{14} + (12|42) - (12|24) + (13|43) & h_{35} + (31|51) + (32|52) & 0 \\end{pmatrix}}\n$$", "id": "2924391"}, {"introduction": "在上一练习的基础上，本实践将指导您系统地为一个小型系统构建完整的哈密顿量矩阵。这是全组态相互作用(Full Configuration Interaction, FCI)计算中的核心任务，而FCI是量子化学方法的精确基准。这个练习能帮助您理解单个矩阵元如何组合起来描述完整的电子问题，并让您将Slater-Condon规则与强大的二次量子化形式联系起来。[@problem_id:2797542]", "problem": "考虑一个非相对论的、钳定原子核的双电子问题，在二次量子化形式下，有四个正交归一的自旋轨道，其指标 $p \\in \\{1,2,3,4\\}$ 分别对应于 $\\{1\\alpha, 1\\beta, 2\\alpha, 2\\beta\\}$。电子哈密顿量为\n$$\n\\hat{H} \\;=\\; \\sum_{p,q} h_{pq}\\, \\hat{a}_{p}^{\\dagger}\\hat{a}_{q} \\;+\\; \\frac{1}{2}\\sum_{p,q,r,s} (pq|rs)\\, \\hat{a}_{p}^{\\dagger}\\hat{a}_{q}^{\\dagger}\\hat{a}_{s}\\hat{a}_{r},\n$$\n其中 $\\hat{a}_{p}^{\\dagger}$ 和 $\\hat{a}_{p}$ 是费米子产生和湮灭算符，服从正则反对易关系，$h_{pq}$ 是单电子积分，而 $(pq|rs)$ 是化学家标记法下的双电子库仑积分。所有量均采用哈特里原子单位。\n\n给定以下非零的单电子积分 $h_{pq}$ (厄米的，因此 $h_{pq}=h_{qp}$):\n- $h_{11} = h_{22} = -1.000$, $h_{33} = h_{44} = -0.500$,\n- $h_{13} = h_{31} = -0.100$, $h_{24} = h_{42} = -0.100$,\n- 所有其他 $h_{pq} = 0$。\n\n双电子自旋轨道积分 $(pq|rs)$ 由以下非零的空间轨道库仑-交换数据构建，并遵循所有置换对称性，所有其他空间积分为零：\n- $(11|11) = 0.700$, $(22|22) = 0.600$,\n- $(11|22) = (22|11) = 0.500$,\n- $(12|21) = (21|12) = 0.200$,\n- 所有其他空间 $(\\mu\\nu|\\lambda\\kappa) = 0$。\n通过自旋选择定则映射到自旋轨道积分：$(p q|r s)$ 非零的条件是 $p$ 的自旋等于 $r$ 的自旋，且 $q$ 的自旋等于 $s$ 的自旋，此时 $(p q|r s)$ 的值等于相应的空间积分 $(\\mu\\nu|\\lambda\\kappa)$，其中 $p\\to\\mu, q\\to\\nu, r\\to\\lambda, s\\to\\kappa$ 表示相关的空间轨道标签。\n\n在由四个自旋轨道构建的所有双电子行列式构成的斯莱特行列式基组中进行计算，为了固定相位，按自旋轨道指标递增的顺序列出：\n- $\\lvert D_{1} \\rangle = \\lvert 1,2 \\rangle$, $\\lvert D_{2} \\rangle = \\lvert 1,3 \\rangle$, $\\lvert D_{3} \\rangle = \\lvert 1,4 \\rangle$,\n- $\\lvert D_{4} \\rangle = \\lvert 2,3 \\rangle$, $\\lvert D_{5} \\rangle = \\lvert 2,4 \\rangle$, $\\lvert D_{6} \\rangle = \\lvert 3,4 \\rangle$.\n\n任务：\n1. 从二次量子化哈密顿量和费米子反对易关系出发，通过直接利用给定的 $h_{pq}$ 和 $(pq|rs)$ 计算所有矩阵元 $\\langle D_{I} \\lvert \\hat{H} \\rvert D_{J} \\rangle$，构建上述行列式基组下的完整 $6\\times 6$ 全组态相互作用 (FCI) 哈密顿矩阵。\n2. 使用您构建的矩阵，明确地验证其厄米性以及与反对称性的一致性（即由反对易关系和 $(pq|rs)$ 的对称性推导出的斯莱特-康登规则所蕴含的结构）。\n3. FCI 哈密顿矩阵的迹是多少？以哈特里 (Hartree) 为单位表示最终答案。无需四舍五入；报告精确值。", "solution": "该问题陈述是量子化学中的一个标准的、适定的问题，具体是在四个自旋轨道基组内对一个双电子体系进行全组态相互作用 (FCI) 计算。该问题具有科学依据，是完整且客观的，没有任何缺陷。我们开始求解。\n\n求解需要构建给定斯莱特行列式基组下的 $6 \\times 6$ 哈密顿矩阵 $\\mathbf{H}$。矩阵元 $H_{IJ} = \\langle D_{I} | \\hat{H} | D_{J} \\rangle$ 使用斯莱特-康登规则进行计算，这些规则是将二次量子化哈密顿量作用于斯莱特行列式并使用费米子反对易关系 $\\{\\hat{a}_p, \\hat{a}_q\\} = 0$, $\\{\\hat{a}_p^\\dagger, \\hat{a}_q^\\dagger\\} = 0$ 和 $\\{\\hat{a}_p, \\hat{a}_q^\\dagger\\} = \\delta_{pq}$ 的直接结果。\n\n基行列式为：\n$\\lvert D_{1} \\rangle = \\lvert 1,2 \\rangle$ ($M_S=0$), $\\lvert D_{2} \\rangle = \\lvert 1,3 \\rangle$ ($M_S=1$), $\\lvert D_{3} \\rangle = \\lvert 1,4 \\rangle$ ($M_S=0$),\n$\\lvert D_{4} \\rangle = \\lvert 2,3 \\rangle$ ($M_S=0$), $\\lvert D_{5} \\rangle = \\lvert 2,4 \\rangle$ ($M_S=-1$), $\\lvert D_{6} \\rangle = \\lvert 3,4 \\rangle$ ($M_S=0$).\n\n哈密顿量是非相对论的且与自旋无关，因此它与总自旋投影算符 $\\hat{S}_z$ 对易。这意味着哈密顿矩阵在行列式基组下是块对角的，非零矩阵元只存在于具有相同 $M_S$ 值的行列式之间。基组可分为三个块：$M_S=1$ ($\\{D_2\\}$)，$M_S=-1$ ($\\{D_5\\}$) 和 $M_S=0$ ($\\{D_1, D_3, D_4, D_6\\}$)。\n\n首先，我们必须根据给定的空间积分 $(\\mu\\nu|\\lambda\\kappa)$ 和选择定则，推导出所需的非零自旋轨道积分 $(pq|rs)$。自旋轨道映射为 $1 \\to (1, \\alpha)$、$2 \\to (1, \\beta)$、$3 \\to (2, \\alpha)$、$4 \\to (2, \\beta)$。\n一个积分 $(pq|rs)$ 只有在 $\\sigma(p)=\\sigma(r)$ 且 $\\sigma(q)=\\sigma(s)$ 时才非零，其值由空间积分 $(\\mu(p)\\mu(q)|\\mu(r)\\mu(s))$ 给出。\n\n由 $(11|11) = 0.700$ 得：$(12|12)=0.700$。其他像 $(11|11)$ 这样的积分不会被使用，因为它们涉及一对相同的自旋轨道。\n由 $(22|22) = 0.600$ 得：$(34|34)=0.600$。\n由 $(11|22) = 0.500$ 得：这对应于 $\\mu(p)=1, \\mu(q)=1, \\mu(r)=2, \\mu(s)=2$。根据自旋规则，这会产生 $(12|34)=0.500$ (自旋 $(\\alpha,\\beta) \\to (\\alpha,\\beta)$) 和 $(21|43)=0.500$ (自旋 $(\\beta,\\alpha) \\to (\\beta,\\alpha)$)。\n由 $(12|21) = 0.200$ 得：这对应于 $\\mu(p)=1, \\mu(q)=2, \\mu(r)=2, \\mu(s)=1$。这会产生 $(13|31)=0.200$ (自旋 $(\\alpha,\\alpha) \\to (\\alpha,\\alpha)$)，$(24|42)=0.200$ (自旋 $(\\beta,\\beta) \\to (\\beta,\\beta)$)，以及 $(14|32)=0.200$ (自旋 $(\\alpha,\\beta) \\to (\\alpha,\\beta)$)，和 $(23|41)=0.200$ (自旋 $(\\beta,\\alpha) \\to (\\beta,\\alpha)$)。\n\n现在我们应用斯莱特-康登规则。\n对于对角元 $\\langle D | \\hat{H} | D \\rangle$ 其中 $|D\\rangle = |i,j\\rangle$：\n$\\langle i,j | \\hat{H} | i,j \\rangle = h_{ii} + h_{jj} + (ij|ij) - (ij|ji)$.\n$H_{11} = \\langle 1,2|\\hat{H}|1,2\\rangle = h_{11}+h_{22}+(12|12)-(12|21) = -1.000-1.000+0.700-0 = -1.300$.\n$H_{22} = \\langle 1,3|\\hat{H}|1,3\\rangle = h_{11}+h_{33}+(13|13)-(13|31) = -1.000-0.500+0-0.200 = -1.700$.\n$H_{33} = \\langle 1,4|\\hat{H}|1,4\\rangle = h_{11}+h_{44}+(14|14)-(14|41) = -1.000-0.500+0-0 = -1.500$.\n$H_{44} = \\langle 2,3|\\hat{H}|2,3\\rangle = h_{22}+h_{33}+(23|23)-(23|32) = -1.000-0.500+0-0 = -1.500$.\n$H_{55} = \\langle 2,4|\\hat{H}|2,4\\rangle = h_{22}+h_{44}+(24|24)-(24|42) = -1.000-0.500+0-0.200 = -1.700$.\n$H_{66} = \\langle 3,4|\\hat{H}|3,4\\rangle = h_{33}+h_{44}+(34|34)-(34|43) = -0.500-0.500+0.600-0 = -0.400$.\n\n对于相差一个自旋轨道的行列式之间的非对角元，例如 $\\langle i,j|\\hat{H}|k,j\\rangle$ (激发 $i \\to k$)：\n对于 $I \\neq J$: $\\langle i,j|\\hat{H}|k,j\\rangle = \\pm (h_{ik} + (ij|kj)-(ij|jk))$。符号取决于轨道的排列顺序。\n$H_{13}=\\langle 1,2|\\hat{H}|1,4\\rangle$：激发 $2 \\to 4$，公共轨道为 $1$。矩阵元为 $h_{24} + (21|41) - (21|14) = -0.100+0-0 = -0.100$。\n$H_{14}=\\langle 1,2|\\hat{H}|2,3\\rangle$：激发 $1 \\to 3$，公共轨道为 $2$。考虑到轨道顺序的符号校正，矩阵元为 $-h_{13} - ((12|32)-(12|23)) = -(-0.100) - (0-0) = 0.100$。\n$H_{36}=\\langle 1,4|\\hat{H}|3,4\\rangle$：激发 $1 \\to 3$，公共轨道为 $4$。矩阵元为 $h_{13} + (14|34) - (14|43) = -0.100+0-0 = -0.100$。\n$H_{46}=\\langle 2,3|\\hat{H}|3,4\\rangle$：激发 $2 \\to 4$，公共轨道为 $3$。考虑到符号校正，矩阵元为 $-h_{24} - ((23|43)-(23|34)) = -(-0.100) - (0-0) = 0.100$。\n\n对于相差两个自旋轨道的行列式之间的非对角元，例如 $\\langle i,j|\\hat{H}|k,l\\rangle$：\n对于 $I \\neq J$: $\\langle i,j|\\hat{H}|k,l\\rangle = \\pm ((ij|kl)-(ij|lk))$.\n$H_{16}=\\langle 1,2|\\hat{H}|3,4\\rangle$：激发 $(1,2) \\to (3,4)$。矩阵元为 $(12|34) - (12|43) = 0.500-0 = 0.500$。\n$H_{34}=\\langle 1,4|\\hat{H}|2,3\\rangle$：激发 $(1,4) \\to (2,3)$。矩阵元为 $(14|23)-(14|32) = 0-0.200 = -0.200$。\n\n所有其他非对角矩阵元均为零，原因是 $M_S$ 守恒或相关积分为零。\n\n**1. 全 CI 哈密顿矩阵**\n将这些矩阵元组合起来，得到 $6 \\times 6$ 的 FCI 矩阵 $\\mathbf{H}$：\n$$\n\\mathbf{H} =\n\\begin{pmatrix}\n-1.300 & 0 & -0.100 & 0.100 & 0 & 0.500 \\\\\n0 & -1.700 & 0 & 0 & 0 & 0 \\\\\n-0.100 & 0 & -1.500 & -0.200 & 0 & -0.100 \\\\\n0.100 & 0 & -0.200 & -1.500 & 0 & 0.100 \\\\\n0 & 0 & 0 & 0 & -1.700 & 0 \\\\\n0.500 & 0 & -0.100 & 0.100 & 0 & -0.400\n\\end{pmatrix}\n$$\n\n**2. 厄米性和一致性**\n构建的矩阵是显式厄米的，因为对所有 $I,J$ 都有 $H_{IJ} = H_{JI}$（因为所有矩阵元都是实数）。该结构与斯莱特-康登规则的推论和基本对称性完全一致。关于 $M_S$ 的块对角性质是显而易见的：如果 $D_I$ 和 $D_J$ 具有不同的 $M_S$ 值，则矩阵元 $H_{IJ}$ 为零。具体来说，基态 $\\lvert D_2 \\rangle$ ($M_S=1$) 和 $\\lvert D_5 \\rangle$ ($M_S=-1$) 与所有其他态以及彼此之间都是解耦的。剩下的态 $D_1, D_3, D_4, D_6$ 构成 $M_S=0$ 块。这证实了计算的物理一致性。\n\n**3. FCI 哈密顿矩阵的迹**\n矩阵的迹是对角元之和。\n$$ \\text{Tr}(\\mathbf{H}) = \\sum_{I=1}^{6} H_{II} $$\n$$ \\text{Tr}(\\mathbf{H}) = (-1.300) + (-1.700) + (-1.500) + (-1.500) + (-1.700) + (-0.400) $$\n$$ \\text{Tr}(\\mathbf{H}) = -8.100 $$\n迹为 $-8.100$ Hartree。\n\n作为验证，迹也可以使用在一个 N 轨道基组中 n 电子 FCI 哈密顿量的迹的通用公式来计算：\n$$ \\text{Tr}(\\mathbf{H}) = \\binom{N-1}{n-1}\\sum_{p=1}^N h_{pp} + \\binom{N-2}{n-2}\\sum_{p<q}^N \\left((pq|pq) - (pq|qp)\\right) $$\n对于 $N=4, n=2$：\n单电子部分的贡献为 $\\binom{4-1}{2-1}\\sum_p h_{pp} = 3(h_{11}+h_{22}+h_{33}+h_{44}) = 3(-3.000) = -9.000$。\n双电子部分的贡献为 $\\binom{4-2}{2-2}\\sum_{p<q}((pq|pq)-(pq|qp))$。该和等于先前为每个对角元计算的双电子贡献之和：$0.700 - 0.200 + 0 + 0 - 0.200 + 0.600 = 0.900$。因此贡献为 $1 \\times 0.900 = 0.900$。\n总迹因此为 $-9.000 + 0.900 = -8.100$。\n这个结果与直接对对角元求和得到的结果相匹配，从而验证了计算的正确性。", "answer": "$$\\boxed{-8.100}$$", "id": "2797542"}, {"introduction": "源于费米子反对称性的符号约定，是理论计算和代码实现中一个常见的错误来源。本练习旨在通过要求您开发一个算法来确定任意两个Slater行列式之间的相对符号，从而弥合抽象规则与实际计算之间的鸿沟。对于任何希望实现或理解多体电子结构代码的研究者来说，掌握这一逻辑至关重要。[@problem_id:2924367]", "problem": "考虑一个固定的参考 Slater 行列式，它由一个包含 $M$ 个自旋轨道的位串指定，其中最低有效位对应于自旋轨道指数 $0$，下一位对应于指数 $1$，以此类推，直到指数 $M-1$。一个位于位置 $i$ 的位值为 $1$ 表示自旋轨道 $i$ 被占据，而 $0$ 表示未被占据。对于具有相同电子数（即相同数量的 $1$ 位）并由同一 $M$ 个自旋轨道上的第二个位串表示的任何其他 Slater 行列式，其相对于参考行列式的相对符号定义为：通过使用与费米子波函数的反对称性一致的、明确定义的湮灭和产生操作序列，将参考行列式变换为目标行列式时所获得的费米子相位因子。任务是设计一个算法，在给定 $M$、参考位串和目标行列式位串的情况下，计算出这个符号为 $+1$ 或 $-1$。\n\n您必须基于以下基本原理来设计您的算法：\n- 对应于已占据自旋轨道 $i_1<i_2<\\cdots<i_N$ 的 Slater 行列式 $|\\Phi\\rangle$ 表示为费米子产生算符的有序乘积 $a^\\dagger_{i_1} a^\\dagger_{i_2} \\cdots a^\\dagger_{i_N} |0\\rangle$。\n- 费米子算符的正则反对易关系成立：$\\{a_p, a_q^\\dagger\\} = a_p a_q^\\dagger + a_q^\\dagger a_p = \\delta_{pq}$ 以及 $\\{a_p, a_q\\} = \\{a_p^\\dagger, a_q^\\dagger\\} = 0$。\n- 在二次量子化中，将 $a_i$（湮灭）或 $a_i^\\dagger$（产生）算符作用于一个 Slater 行列式，会产生一个相位因子 $(-1)^{n_{<i}}$，其中 $n_{<i}$ 是当前行列式中指数严格小于 $i$ 的已占据自旋轨道的数量。\n\n您的程序必须：\n- 实现一个算法，该算法仅使用上述原理，为任何一对具有相同汉明权重（相同电子数）的位串计算符号因子 $s \\in \\{+1,-1\\}$。除了直接从这些原理推导出的内容外，您不得假设或使用任何捷径公式。\n- 将位串视为在最低有效 $M$ 位编码占据情况的非负整数。您应使用 $2^M-1$ 来屏蔽任何可能存在的更高位，以确保只考虑前 $M$ 个自旋轨道。\n\n定义以下由参数三元组 $(M,\\ \\text{ref},\\ \\text{det})$ 构成的测试套件，其中所有整数均为十进制表示：\n- 情况 A (恒等变换，基线): $(8,\\ 45,\\ 45)$，即参考和目标均占据 $\\{0,2,3,5\\}$。\n- 情况 B (奇宇称单激发): $(8,\\ 45,\\ 101)$，即参考 $\\{0,2,3,5\\}$ 到目标 $\\{0,2,5,6\\}$。\n- 情况 C (偶宇称单激发): $(8,\\ 45,\\ 46)$，即参考 $\\{0,2,3,5\\}$ 到目标 $\\{1,2,3,5\\}$。\n- 情况 D (偶宇称双激发): $(8,\\ 45,\\ 75)$，即参考 $\\{0,2,3,5\\}$ 到目标 $\\{0,1,3,6\\}$。\n- 情况 E (偶宇称双激发): $(8,\\ 45,\\ 116)$，即参考 $\\{0,2,3,5\\}$ 到目标 $\\{2,4,5,6\\}$。\n- 情况 F (奇宇称三激发): $(8,\\ 45,\\ 90)$，即参考 $\\{0,2,3,5\\}$ 到目标 $\\{1,3,4,6\\}$。\n- 情况 G (向下、偶宇称单激发): $(8,\\ 45,\\ 29)$，即参考 $\\{0,2,3,5\\}$ 到目标 $\\{0,2,3,4\\}$。\n- 情况 H ($M$ 不同，偶宇称): $(6,\\ 19,\\ 41)$，即参考 $\\{0,1,4\\}$ 到目标 $\\{0,3,5\\}$。\n- 情况 I ($M$ 不同，奇宇称): $(6,\\ 19,\\ 14)$，即参考 $\\{0,1,4\\}$ 到目标 $\\{1,2,3\\}$。\n\n您的程序应：\n- 对每种情况，计算并返回符号 $+1$ 或 $-1$。\n- 将所有情况的结果汇总到单行输出中，该行包含一个用方括号括起来的逗号分隔列表，例如 $[1,-1,1]$。\n\n假设和约束：\n- 您必须只考虑每个位串的最低有效 $M$ 位（用 $2^M-1$ 进行屏蔽）。\n- 如果参考和目标位串的汉明权重（电子数）不同，则对于当前任务，符号是未定义的；但是，所有提供的测试用例都满足汉明权重相等的条件。\n- 此问题不涉及物理单位；所有量均为无量纲整数。", "solution": "所述问题是有效的。这是一个良定的、有科学依据的练习，旨在应用费米子体系二次量子化的基本原理，这是量子化学中的一个标准课题。我们将通过严格的、分步的推导来获得解决方案。\n\n任务是计算两个由 $M$ 个自旋轨道上的整数位串表示的 Slater 行列式 $|\\Phi_{ref}\\rangle$ 和 $|\\Phi_{det}\\rangle$ 之间的相对符号 $s \\in \\{+1, -1\\}$。这个符号是费米子波函数反对称性的直接结果，该反对称性由正则反对易关系 $\\{a_p^\\dagger, a_q^\\dagger\\} = \\{a_p, a_q\\} = 0$ 和 $\\{a_p, a_q^\\dagger\\} = \\delta_{pq}$ 形式化。\n\n提供的一个核心原理是，将产生算符 $a_i^\\dagger$ 或湮灭算符 $a_i$ 作用于一个 Slater 行列式会引入一个相位因子 $(-1)^{n_{<i}}$，其中 $n_{<i}$ 是指数严格小于 $i$ 的已占据自旋轨道的数量。这个相位源于将该算符排列到定义行列式的产生算符有序乘积中的正则位置，每次算符交换都会贡献一个因子 $-1$。\n\n为了找到将 $|\\Phi_{ref}\\rangle$ 变换为 $|\\Phi_{det}\\rangle$ 的总符号，我们将模拟一个执行此变换的基本操作序列，并累积由此产生的相位因子。由于两个行列式具有相同的电子数（汉明权重相等），该变换可以表示为一系列先湮灭后产生的操作。\n\n设参考行列式和目标行列式的整数表示分别为 $d_{ref}$ 和 $d_{tgt}$。已占据自旋轨道的指数集由值为 $1$ 的位的位置隐式定义。从 $|\\Phi_{ref}\\rangle$ 到 $|\\Phi_{det}\\rangle$ 的变换需要：\n1. 从集合 $H$ 中的自旋轨道湮灭电子，这些轨道在 $|\\Phi_{ref}\\rangle$ 中被占据但在 $|\\Phi_{det}\\rangle$ 中未被占据。这些是“空穴”态。\n2. 在集合 $P$ 中的自旋轨道上产生电子，这些轨道在 $|\\Phi_{det}\\rangle$ 中被占据但在 $|\\Phi_{ref}\\rangle$ 中未被占据。这些是“粒子”态。\n\n为确保符号的唯一定义，我们必须为这些操作采用一种正则顺序。我们将使用标准约定，即首先执行所有湮灭操作，然后执行所有产生操作。此外，湮灭操作按自旋轨道指数的降序执行，产生操作按指数的升序执行。这种选择确保了某个算符的应用不会改变同一序列中稍后应用的任何算符的占据数（即，当湮灭 $a_{h_i}$ 然后湮灭 $a_{h_j}$ 且 $h_i > h_j$ 时，对 $n_{<h_j}$ 的计数不受先前在 $h_i$ 处移除电子的影响）。\n\n算法流程如下：\n\n1.  **初始化**：\n    - 参考行列式和目标行列式的输入整数用 $(2^M-1)$ 进行屏蔽，以仅考虑 $M$ 个指定的自旋轨道。设屏蔽后的行列式为 $d_{ref}$ 和 $d_{tgt}$。\n    - 初始化总符号因子 $s = +1$。\n    - 初始化行列式的工作副本 $d_{current} = d_{ref}$。\n\n2.  **识别并排序空穴/粒子态**：\n    - 空穴指数集 $H$ 由在 $d_{ref}$ 中为 $1$ 但在 $d_{tgt}$ 中为 $0$ 的位位置确定。收集这些指数并按降序排序。\n    - 粒子指数集 $P$ 由在 $d_{tgt}$ 中为 $1$ 但在 $d_{ref}$ 中为 $0$ 的位位置确定。收集这些指数并按升序排序。\n\n3.  **湮灭阶段**：\n    - 对于每个空穴指数 $h \\in H$：\n        a. 计算在 $d_{current}$ 中指数小于 $h$ 的已占据自旋轨道的数量。这是较低位的布居数（popcount）：$n_{<h} = \\text{popcount}(d_{current} \\ \\& \\ ((1 \\ll h) - 1))$。`popcount` 函数计算整数中置为 1 的位数。\n        b. 如果 $n_{<h}$ 是奇数，则符号翻转：$s \\leftarrow s \\times (-1)$。\n        c. 通过湮灭 $h$ 处的电子来更新工作行列式：$d_{current} \\leftarrow d_{current} \\oplus (1 \\ll h)$，其中 $\\oplus$ 是按位异或操作。\n\n4.  **产生阶段**：\n    - 所有湮灭操作完成后，工作行列式 $d_{current}$ 表示对应于两个行列式共有的轨道的中间状态。\n    - 对于每个粒子指数 $p \\in P$：\n        a. 计算在 $d_{current}$ 中指数小于 $p$ 的已占据自旋轨道的数量：$n_{<p} = \\text{popcount}(d_{current} \\ \\& \\ ((1 \\ll p) - 1))$。\n        b. 如果 $n_{<p}$ 是奇数，则符号翻转：$s \\leftarrow s \\times (-1)$。\n        c. 通过在 $p$ 处产生电子来更新工作行列式：$d_{current} \\leftarrow d_{current} \\oplus (1 \\ll p)$。\n\n5.  **最终结果**：\n    - 完成后，$d_{current}$ 将等于 $d_{tgt}$，累积的变量 $s$ 将持有最终的相对符号。\n\n这种过程性模拟直接实现了费米子对易关系的推论。它按要求从第一性原理构建，不依赖任何未声明或未推导的捷径公式。", "answer": "```python\nimport numpy as np\n# from scipy import ...\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print results.\n    \"\"\"\n    test_cases = [\n        # (M, ref, det)\n        (8, 45, 45),    # Case A\n        (8, 45, 101),   # Case B\n        (8, 45, 46),    # Case C\n        (8, 45, 75),    # Case D\n        (8, 45, 116),   # Case E\n        (8, 45, 90),    # Case F\n        (8, 45, 29),    # Case G\n        (6, 19, 41),    # Case H\n        (6, 19, 14),    # Case I\n    ]\n\n    results = []\n    for M, ref, det in test_cases:\n        sign = calculate_fermionic_sign(M, ref, det)\n        results.append(sign)\n\n    print(f\"[{','.join(map(str, results))}]\")\n\ndef calculate_fermionic_sign(M, ref, det):\n    \"\"\"\n    Calculates the fermionic sign between two Slater determinants.\n\n    The sign is computed by simulating the transformation from the reference\n    to the target determinant via a canonical sequence of annihilation and\n    creation operations, accumulating the phase at each step.\n\n    Args:\n        M (int): The number of spin-orbitals in the basis.\n        ref (int): The reference determinant as a bitstring integer.\n        det (int): The target determinant as a bitstring integer.\n\n    Returns:\n        int: The sign factor (+1 or -1).\n    \"\"\"\n    # 1. Initialization and Masking\n    # Ensure only the least significant M bits are considered.\n    bitmask = (1  M) - 1\n    ref = bitmask\n    det = bitmask\n\n    if ref == det:\n        return 1\n\n    # 2. Identify Hole and Particle States\n    holes_mask = ref  ~det\n    particles_mask = det  ~ref\n\n    h_indices = []\n    p_indices = []\n\n    for i in range(M):\n        if (holes_mask >> i)  1:\n            h_indices.append(i)\n        if (particles_mask >> i)  1:\n            p_indices.append(i)\n\n    # Sort according to the canonical prescription:\n    # Annihilate from high index to low.\n    h_indices.sort(reverse=True)\n    # Create from low index to high.\n    p_indices.sort()\n\n    total_sign = 1\n    current_det = ref\n\n    # 3. Annihilation Phase\n    for h in h_indices:\n        # Count occupied orbitals with index less than h.\n        less_than_mask = (1  h) - 1\n        n_less_than = (current_det  less_than_mask).bit_count()\n        \n        # Accumulate phase factor (-1)^n_less_than.\n        if n_less_than % 2 != 0:\n            total_sign *= -1\n            \n        # Annihilate electron at orbital h.\n        current_det ^= (1  h)\n\n    # 4. Creation Phase\n    for p in p_indices:\n        # Count occupied orbitals with index less than p.\n        less_than_mask = (1  p) - 1\n        n_less_than = (current_det  less_than_mask).bit_count()\n\n        # Accumulate phase factor (-1)^n_less_than.\n        if n_less_than % 2 != 0:\n            total_sign *= -1\n            \n        # Create electron at orbital p.\n        current_det ^= (1  p)\n\n    # 5. Final Result\n    # As a sanity check, the final determinant must match the target.\n    # assert current_det == det\n    return total_sign\n\nsolve()\n```", "id": "2924367"}]}