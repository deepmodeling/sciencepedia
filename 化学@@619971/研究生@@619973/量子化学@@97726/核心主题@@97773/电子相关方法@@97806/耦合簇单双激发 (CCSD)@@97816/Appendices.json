{"hands_on_practices": [{"introduction": "耦合簇理论之所以强大，部分原因在于其系统性的构建方式。为了深刻理解为何 CCSD（Coupled Cluster Singles and Doubles）是相关能计算的“黄金标准”，一个有效的方法是首先分析其简化形式。这个练习将引导你探讨一个假设性的“耦合簇单激发”（CCS）模型，并推导其能量和幅值方程。[@problem_id:2453785] 通过这个过程，你将从根本上理解为何仅有单激发不足以描述从正则 Hartree-Fock 参考态出发的电子相关，从而揭示双激发在 CCSD 方法中的核心作用。", "problem": "在耦合簇单双激发 (CCSD) 框架内，考虑截断模型耦合簇单激发 (CCS)，其中簇算符仅限于单激发。设参考态为由正则分子轨道构建的闭壳层限制性哈特里-福克 (RHF) 行列式。耦合簇 (CC) 波函数定义为 $\\lvert\\Psi\\rangle = e^{\\hat{T}}\\lvert\\Phi_0\\rangle$，相似变换哈密顿量定义为 $\\bar{H} = e^{-\\hat{T}} \\hat{H} e^{\\hat{T}}$。在 CCS 中，簇算符为 $\\hat{T} = \\hat{T}_{1}$，其中 $\\hat{T}_{1} = \\sum_{i a} t_{i}^{a}\\,\\hat{a}_{a}^{\\dagger}\\hat{a}_{i}$，$i,j,\\ldots$ 表示 $\\lvert\\Phi_0\\rangle$ 中的已占据自旋轨道，$a,b,\\ldots$ 表示虚拟自旋轨道，而 $\\hat{a}_{p}^{\\dagger}, \\hat{a}_{p}$ 分别是产生和湮灭算符。\n\n仅使用这些定义以及正则 RHF 的性质，即福克算符的已占据-虚拟块为零（$f_{a}^{i} = 0$ 对所有已占据轨道 $i$ 和虚拟轨道 $a$ 成立），完成以下任务：\n1) 写出以 $\\bar{H}$ 的投影表示的 CCS 能量表达式。\n2) 写出以 $\\bar{H}$ 的投影表示的 CCS 单激发振幅方程。\n3) 对于上述的闭壳层正则 RHF 参考态，确定 CCS 相关能，其定义为 $E_{\\text{corr}}^{\\text{CCS}} = E_{\\text{CCS}} - E_{\\text{RHF}}$。\n\n以哈特里 (hartree) 为单位表示最终的相关能。最终答案必须是单个实数。无需进行四舍五入。", "solution": "所述问题是有效的。它在科学上基于量子化学中已建立的耦合簇方法理论，是良定的、客观的，并包含了进行严格推导所需的所有信息。我们将着手进行解答。\n\n该问题要求在耦合簇单激发 (CCS) 框架内，从一个正则限制性哈特里-福克 (RHF) 参考行列式 $\\lvert\\Phi_0\\rangle$ 出发，进行一个分为三部分的推导。\n\n任何耦合簇方法的基本方程都是通过将薛定谔方程 $\\hat{H}\\lvert\\Psi\\rangle = E\\lvert\\Psi\\rangle$ 投影到参考态和激发态流形上推导出来的。使用 CC 拟设 $\\lvert\\Psi\\rangle = e^{\\hat{T}}\\lvert\\Phi_0\\rangle$ 和相似变换哈密顿量 $\\bar{H} = e^{-\\hat{T}}\\hat{H}e^{\\hat{T}}$，可以推导出求解能量和簇振幅的方程组。\n\n1) CCS 能量表达式。\n\n总能量 $E_{\\text{CCS}}$ 是通过将相似变换后的薛定谔方程 $e^{-\\hat{T}}\\hat{H}e^{\\hat{T}}\\lvert\\Phi_0\\rangle = E_{\\text{CCS}}\\lvert\\Phi_0\\rangle$ 投影到参考态 $\\langle\\Phi_0\\rvert$ 上得到的。这一步在方程两边左乘 $\\langle\\Phi_0\\rvert$ 并利用 $\\langle\\Phi_0\\rvert\\Phi_0\\rangle = 1$：\n$$\n\\langle\\Phi_0\\rvert e^{-\\hat{T}}\\hat{H}e^{\\hat{T}}\\lvert\\Phi_0\\rangle = \\langle\\Phi_0\\rvert E_{\\text{CCS}} \\lvert\\Phi_0\\rangle = E_{\\text{CCS}}\n$$\n因此，以相似变换哈密顿量 $\\bar{H} = e^{-\\hat{T}}\\hat{H}e^{\\hat{T}}$ 表示，总能量表达式为：\n$$\nE_{\\text{CCS}} = \\langle\\Phi_0\\rvert \\bar{H} \\lvert\\Phi_0\\rangle\n$$\n\n2) CCS 单激发振幅方程。\n\n簇振幅 $t_{i}^{a}$ 的方程是通过将 CC 薛定谔方程投影到单激发行列式流形 $\\lvert\\Phi_{i}^{a}\\rangle = \\hat{a}_{a}^{\\dagger}\\hat{a}_{i}\\lvert\\Phi_0\\rangle$ 上得到的。最直接的方法是要求相似变换后的薛定谔方程在激发流形上的投影为零。对于 CCS，我们将方程 $e^{-\\hat{T}}\\hat{H}e^{\\hat{T}}\\lvert\\Phi_0\\rangle = E_{\\text{CCS}}\\lvert\\Phi_0\\rangle$ 投影到 $\\langle\\Phi_i^a\\rvert$ 上：\n$$\n\\langle\\Phi_i^a\\rvert e^{-\\hat{T}}\\hat{H}e^{\\hat{T}}\\lvert\\Phi_0\\rangle = \\langle\\Phi_i^a\\rvert E_{\\text{CCS}}\\lvert\\Phi_0\\rangle = 0\n$$\n这得到 CCS 单激发振幅方程：\n$$ \\langle \\Phi_{i}^{a} \\rvert \\bar{H} \\lvert \\Phi_{0} \\rangle = 0 \\quad \\forall i \\in \\text{occ}, a \\in \\text{virt} $$\n这为包含在 $\\bar{H} = e^{-\\hat{T}_{1}}\\hat{H}e^{\\hat{T}_{1}}$ 中的振幅 $t_{i}^{a}$ 提供了一组耦合的非线性方程。\n\n3) 正则 RHF 参考态下的 CCS 相关能。\n\n相关能定义为 $E_{\\text{corr}}^{\\text{CCS}} = E_{\\text{CCS}} - E_{\\text{RHF}}$。我们必须首先解振幅方程以求出 $t_{i}^{a}$ 的值，然后将它们代入能量表达式。\n\n让我们分析振幅方程 $\\langle \\Phi_{i}^{a} \\rvert \\bar{H} \\lvert \\Phi_{0} \\rangle = 0$。使用 $\\bar{H}$ 的 Baker-Campbell-Hausdorff (BCH) 展开式以及正规序哈密顿量 $\\hat{H}_N = \\hat{H} - E_{\\text{RHF}}$（对于它有 $\\hat{H}_N\\lvert\\Phi_0\\rangle = 0$），振幅方程变为：\n$$ \\langle \\Phi_{i}^{a} \\rvert (\\hat{H}_N + [\\hat{H}_N, \\hat{T}_{1}] + \\frac{1}{2}[[\\hat{H}_N, \\hat{T}_{1}], \\hat{T}_{1}] + \\dots) \\lvert \\Phi_{0} \\rangle = 0 $$\n我们来分析各项：\n- 第一项是 $\\langle \\Phi_{i}^{a} \\rvert \\hat{H}_N \\lvert \\Phi_{0} \\rangle$。对于哈特里-福克参考态，该矩阵元由 Brillouin 定理给出：$\\langle \\Phi_{i}^{a} \\rvert \\hat{H} \\lvert \\Phi_{0} \\rangle = f_{i}^{a}$。在正则分子轨道基底下，福克矩阵是对角的，连接已占据 ($i$) 和虚拟 ($a$) 轨道的块为零。问题明确给出了这个条件为 $f_{a}^{i} = 0$。假设采用标准的物理学家风格的标记法，$f_p^q = \\int \\phi_p^*(x) \\hat{f} \\phi_q(x) dx$，这对应于 $f_i^a=0$。因此，这第一项为零。\n- 剩余的项都是来自 $\\hat{T}_{1}$ 的振幅 $t_{j}^{b}$ 的函数。例如，关于 $t$ 的线性项来自 $\\langle \\Phi_{i}^{a} \\rvert [\\hat{H}_N, \\hat{T}_{1}] \\lvert \\Phi_{0} \\rangle$。\n\n由于常数项（非齐次项）$\\langle \\Phi_{i}^{a} \\rvert \\hat{H}_N \\lvert \\Phi_{0} \\rangle$ 为零，CCS 振幅方程成为关于变量 $t_{i}^{a}$ 的一个齐次非线性方程组：\n$$ 0 = \\sum_{j,b} C_{ij}^{ab} t_{j}^{b} + \\sum_{j,b,k,c} D_{ijk}^{abc} t_{j}^{b}t_{k}^{c} + \\dots $$\n齐次方程组总存在平凡解，在本例中即为：\n$$ t_{i}^{a} = 0 \\quad \\forall i,a $$\n虽然非线性方程可能有多个解，但这个平凡解是与无相互作用极限连续相连的解，并且对于一个稳定的哈特里-福克参考态来说，这是物理上正确的解。\n\n现在，我们计算相关能 $E_{\\text{corr}}^{\\text{CCS}}$。利用连簇定理，能量可以写成振幅的函数。\n$$ E_{\\text{corr}}^{\\text{CCS}} = \\langle \\Phi_{0} \\rvert \\hat{H}_N e^{\\hat{T}_1} \\lvert \\Phi_{0} \\rangle_{C} = \\langle \\Phi_{0} \\rvert \\hat{H}_N (1 + \\hat{T}_1 + \\frac{1}{2}\\hat{T}_1^2 + \\dots) \\lvert \\Phi_0 \\rangle_C $$\n- 根据定义，$\\langle \\Phi_{0} \\rvert \\hat{H}_N \\lvert \\Phi_{0} \\rangle_{C} = 0$。\n- 由于正则 RHF 条件，$\\langle \\Phi_{0} \\rvert \\hat{H}_N \\hat{T}_{1} \\lvert \\Phi_{0} \\rangle_{C} = \\sum_{i,a} t_{i}^{a} \\langle \\Phi_{0} \\rvert \\hat{H}_N \\lvert \\Phi_{i}^{a} \\rangle = \\sum_{i,a} t_{i}^{a} f_{i}^{a} = 0$。\n- 第一个可能的非零贡献将来自振幅的二次项，例如 $\\frac{1}{2} \\langle \\Phi_{0} \\rvert \\hat{W}_N \\hat{T}_1^2 \\lvert \\Phi_{0} \\rangle_{C}$，其中 $\\hat{W}_N$ 是正规序涨落势。一个具体的表达式是：\n$$ E_{\\text{corr}}^{\\text{CCS}} = \\frac{1}{4} \\sum_{ijab} (t_{i}^{a}t_{j}^{b} - t_{i}^{b}t_{j}^{a})\\langle ij || ab \\rangle $$\n其中 $\\langle ij || ab \\rangle$ 是反对称化的双电子积分。\n由于振幅方程的解是对于所有 $i$ 和 $a$ 都有 $t_{i}^{a}=0$，我们将此结果代入能量表达式。$E_{\\text{corr}}^{\\text{CCS}}$ 的求和中的每一项都包含振幅的乘积，因此每一项都为零。\n\n因此，CCS 相关能精确为零。\n$$ E_{\\text{corr}}^{\\text{CCS}} = 0 $$\n这个结果证明了 CCS 方法的一个基本性质：对于正则哈特里-福克参考态，它不能恢复任何相关能。仅含单激发的模型无法描述电子相关，因为它从一个单激发通过哈密顿量与基态解耦的参考态出发，而 Brillouin 定理保证了这一条件。相关效应主要源于双电子相互作用，这至少需要双激发组态，而在像 CCSD 这样的更高级别的 CC 理论中由 $\\hat{T}_2$ 处理。\n最终答案是 $0$ 哈特里。", "answer": "$$\n\\boxed{0}\n$$", "id": "2453785"}, {"introduction": "在认识到双激发（doubles）的必要性之后，下一个关键问题是：CCSD 方法的理论能力边界在哪里？这个练习将引导你证明一个 CCSD 理论的基石性结论——对于任意双电子体系，在给定基组下，CCSD 方法能够给出精确的能量。[@problem_id:237876] 你需要分析 CCSD 波函数指数形式展开后的结构，并将其与双电子体系的完全组态相互作用（FCI）波函数进行比较。完成这一证明将加深你对耦合簇波函数结构的理解，并体会到该方法在一个基本而重要的场景中的精确性。", "problem": "在量子化学中，耦合簇 (CC) 方法是计算原子和分子电子结构的强大工具。CC 波函数由拟设 $\\lvert\\Psi_{\\text{CC}}\\rangle = e^{\\hat{T}} \\lvert\\Phi_0\\rangle$ 给出，其中 $\\lvert\\Phi_0\\rangle$ 是参考单行列式波函数（通常是 Hartree-Fock 基态），而 $\\hat{T}$ 是簇算符。簇算符是激发算符之和，$\\hat{T} = \\hat{T}_1 + \\hat{T}_2 + \\dots + \\hat{T}_N$，其中 $\\hat{T}_k$ 从参考态产生所有 $k$ 重激发，$N$ 是电子总数。\n\n耦合簇单双激发 (CCSD) 方法是一种常见的近似，其中簇算符被截断为只包含单激发和双激发：$\\hat{T} \\approx \\hat{T}_{\\text{CCSD}} = \\hat{T}_1 + \\hat{T}_2$。定义激发算符的能量和振幅通过求解 CC 方程得到：\n$$\nE_{\\text{CCSD}} = \\langle \\Phi_0 \\rvert e^{-\\hat{T}} \\hat{H} e^{\\hat{T}} \\lvert \\Phi_0 \\rangle\n$$\n$$\n\\langle \\Phi_{\\mu} \\rvert e^{-\\hat{T}} \\hat{H} e^{\\hat{T}} \\lvert \\Phi_0 \\rangle = 0\n$$\n其中 $\\hat{H}$ 是电子哈密顿量，而 $\\lvert\\Phi_{\\mu}\\rangle$ 代表单激发和双激发行列式的空间。\n\n对于任何给定体系，在选定的单粒子基组内，全组态相互作用 (FCI) 方法给出精确的基态能量 $E_{\\text{FCI}}$。FCI 波函数包含所有可能的激发行列式的贡献。对于一个双电子体系，FCI 展开最多包含双激发。\n\n考虑一个普遍的双电子体系。通过分析精确 (FCI) 波函数的结构及其与 CCSD 波函数拟设的关系，推导能量差 $\\Delta E = E_{\\text{FCI}} - E_{\\text{CCSD}}$ 的最终简化表达式。", "solution": "1. 相关拟设与方程：\n$$\\lvert\\Psi_{\\text{CC}}\\rangle=e^{\\hat{T}}\\lvert\\Phi_0\\rangle,\\qquad \\hat{T}=\\hat{T}_1+\\hat{T}_2$$  \n双电子体系的精确 FCI 波函数仅张成 $\\lvert\\Phi_0\\rangle$、单激发和双激发的空间。\n2. 展开簇指数：\n$$e^{\\hat{T}_1+\\hat{T}_2}=1+\\hat{T}_1+\\hat{T}_2+\\tfrac12\\hat{T}_1^2+\\dots$$  \n对于双电子体系，高阶项消失：$\\hat{T}_2^2=0$ 且当 $n\\ge3$ 时 $\\hat{T}_1^n=0$。\n3. CCSD 波函数为\n$$\\lvert\\Psi_{\\text{CCSD}}\\rangle=(1+\\hat{T}_1)\\lvert\\Phi_0\\rangle+(\\hat{T}_2+\\tfrac12\\hat{T}_1^2)\\lvert\\Phi_0\\rangle,$$  \n它精确地张成了单激发和双激发的 FCI 空间。\n4. 因此 CCSD 能量等于 FCI 能量，$E_{\\text{CCSD}}=E_{\\text{FCI}}$，且\n$$\\Delta E=E_{\\text{FCI}}-E_{\\text{CCSD}}=0.$$", "answer": "$$\\boxed{0}$$", "id": "237876"}, {"introduction": "尽管 CCSD 在理论上极为优美，并且对双电子体系是精确的，但其在多电子分子中的广泛应用却受到计算成本的严格限制。理论的优雅必须面对计算资源的现实。这个练习将带你深入 CCSD 计算的核心，分析其最耗时步骤的计算复杂度。[@problem_id:2453758] 你将通过分析双激发幅值方程中的一个关键张量缩并项，推导出该方法的计算量如何随占据轨道数 $n_o$ 和虚轨道数 $n_v$ 变化。这个实践对于计算化学家至关重要，它揭示了精度与可行性之间的权衡，并解释了为何 CCSD 既是“黄金标准”又是一种计算昂贵的方法。", "problem": "考虑一个在正则 Hartree–Fock 分子轨道基中描述的闭壳层分子。在耦合簇单双激发（Coupled Cluster Singles and Doubles, CCSD）的自旋轨道表述中，设占据自旋轨道的数量为 $n_o$，虚拟自旋轨道的数量为 $n_v$。使用 $i,j,k,\\dots$ 表示占据轨道指标，使用 $a,b,c,d,\\dots$ 表示虚拟轨道指标。反对称化双电子积分为 $\\langle pq||rs\\rangle \\equiv \\langle pq|rs\\rangle - \\langle pq|sr\\rangle$。\n\n专注于使用一种不利用任何置换对称性且不应用任何筛选的朴素稠密算法，为所有的 $(i,j,a,b)$ 构建双激发振幅残差 $R_{ij}^{ab}$。在对 $R_{ij}^{ab}$ 有贡献的各项中，考虑如下张量缩并\n$$\nR_{ij}^{ab} \\leftarrow \\sum_{c,d} \\langle ab||cd\\rangle\\, \\tau_{ij}^{cd},\n$$\n其中 $\\tau_{ij}^{cd}$ 是一个与 $t_{ij}^{cd}$ 具有相同指标结构的类双激发中间体，求和遍及所有虚拟指标 $c$ 和 $d$。\n\n假设计算成本主要由标量乘法次数决定，且加法具有相同的标度行为，请推导为所有 $i,j,a,b$ 计算上述缩并的首项计算成本（操作计数），将其表示为 $n_o$ 和 $n_v$ 的函数。将最终答案表示为关于 $n_o$ 和 $n_v$ 的单个单项式，忽略所有常数前因子和低阶项。", "solution": "问题陈述经过验证，被认为是有效的。这是一个在计算量子化学领域内，关于耦合簇理论计算成本分析的适定的、有科学依据的问题。所有术语和条件都定义清晰，从而可以进行严谨且客观的推导。\n\n任务是确定计算一个对耦合簇单双激发（Coupled Cluster Singles and Doubles, CCSD）振幅残差 $R_{ij}^{ab}$ 有贡献的特定张量缩并的首项计算成本。该缩并由下式给出：\n$$\nR_{ij}^{ab} \\leftarrow \\sum_{c,d} \\langle ab||cd\\rangle\\, \\tau_{ij}^{cd}\n$$\n此更新必须对占据自旋轨道指标 $i,j$ 和虚拟自旋轨道指标 $a,b$ 的所有组合执行。变量 $n_o$ 和 $n_v$ 分别代表占据和虚拟自旋轨道的数量。\n\n问题指定了一种“不利用任何置换对称性的朴素稠密算法”。这意味着一种使用嵌套循环遍历所有指标的直接实现。由标量乘法主导的总计算成本，可以通过计算所需的浮点运算总数来确定。\n\n让我们分析表达式中涉及的指标。\n残差张量 $R_{ij}^{ab}$ 有四个外部指标：\n- $i$ 遍及 $n_o$ 个占据自旋轨道。\n- $j$ 遍及 $n_o$ 个占据自旋轨道。\n- $a$ 遍及 $n_v$ 个虚拟自旋轨道。\n- $b$ 遍及 $n_v$ 个虚拟自旋轨道。\n\n由于问题声明不利用任何置换对称性，我们独立地考虑这些指标的所有组合。因此，必须计算的残差张量 $R_{ij}^{ab}$ 中的元素总数是其指标范围的乘积：\n$$\n\\text{元素数量} = n_o \\times n_o \\times n_v \\times n_v = n_o^2 n_v^2\n$$\n\n对于这 $n_o^2 n_v^2$ 个元素中的每一个，我们都必须计算右侧的求和。此求和涉及两个内部指标 $c$ 和 $d$，并对它们进行求和。\n- $c$ 遍及所有 $n_v$ 个虚拟自旋轨道。\n- $d$ 遍及所有 $n_v$ 个虚拟自旋轨道。\n\n单个元素 $R_{ij}^{ab}$ 的求和为 $\\sum_{c,d} \\langle ab||cd\\rangle\\, \\tau_{ij}^{cd}$。要计算此和，我们遍历 $c$ 和 $d$ 的所有可能值。这个双重求和中的项数为：\n$$\n\\text{求和中的项数} = n_v \\times n_v = n_v^2\n$$\n和中的每一项 $\\langle ab||cd\\rangle\\, \\tau_{ij}^{cd}$ 都涉及双电子积分张量 $\\langle ab||cd\\rangle$ 中的一个元素与中间体张量 $\\tau_{ij}^{cd}$ 中的一个元素的乘法。这构成一次标量乘法。假设加法具有类似的标度行为，计算单个元素 $R_{ij}^{ab}$ 的成本与求和中的项数成正比。\n$$\n\\text{每个 } R_{ij}^{ab} \\text{ 元素的成本} \\propto n_v^2\n$$\n总计算成本是待计算的残差元素数量与计算每个元素的成本的乘积。\n$$\n\\text{总成本} \\propto (\\text{R}_{ij}^{ab} \\text{ 的元素数量}) \\times (\\text{每个元素的成本})\n$$\n代入上面推导出的表达式：\n$$\n\\text{总成本} \\propto (n_o^2 n_v^2) \\times (n_v^2) = n_o^2 n_v^4\n$$\n一个直接的基于循环的实现如下所示：\n```\nFor i = 1 to n_o\n  For j = 1 to n_o\n    For a = 1 to n_v\n      For b = 1 to n_v\n        accumulator = 0\n        For c = 1 to n_v\n          For d = 1 to n_v\n            // One multiplication and one addition\n            accumulator += get_integral(a,b,c,d) * get_tau(i,j,c,d)\n        R(i,j,a,b) += accumulator\n```\n最内层操作对六个指标的每个组合执行一次。迭代总数，也就是主要的计算标度，是循环范围的乘积：$n_o \\times n_o \\times n_v \\times n_v \\times n_v \\times n_v = n_o^2 n_v^4$。\n\n问题要求以单个单项式形式给出首项成本，并忽略常数前因子。因此，计算成本的标度为 $n_o^2 n_v^4$。", "answer": "$$\n\\boxed{n_o^{2} n_v^{4}}\n$$", "id": "2453758"}]}