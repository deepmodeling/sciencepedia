{"hands_on_practices": [{"introduction": "在量子力学中，对称性是简化问题的有力工具。在直接进行复杂的积分计算之前，我们常常可以利用宇称等基本原理来推断出重要的物理结果。这个练习将展示，当一个具有确定宇称的非简并态受到一个奇宇称微扰时，其一阶能量修正必然为零，这突显了哈密顿量与微扰项的对称性如何决定了系统的响应。[@problem_id:1212254]", "problem": "考虑一个三维空间中的无自旋粒子，其未受扰动的哈密顿量为\n$$H_0 = -\\frac{\\hbar^2}{2m}\\nabla^2 + U(\\mathbf{r}),$$  \n其中势能 $U(\\mathbf{r})$ 在空间反演（宇称）下不变，即 $U(-\\mathbf{r}) = U(\\mathbf{r})$。因此，$H_0$ 的每个非简并本征态 $|n\\rangle$ 满足\n$$H_0|n\\rangle = E_n^{(0)}|n\\rangle,\\qquad P|n\\rangle = \\pi_n|n\\rangle,\\quad \\pi_n=\\pm1,$$  \n其中 $P$ 是宇称算符，其作用为 $(P\\psi)(\\mathbf{r})=\\psi(-\\mathbf{r})$。  \n\n现在引入一个小的微扰\n$$V(\\mathbf{r}),\\quad V(-\\mathbf{r})=-V(\\mathbf{r}),$$  \n它在宇称变换下是奇的。使用一阶非简并微扰理论，判断一阶能量修正\n$$E_n^{(1)}=\\langle n|V|n\\rangle$$  \n是否始终为零。回答 1 (是) 或 0 (否)。", "solution": "一阶能量修正由下式给出：\n\n$$\nE_n^{(1)} = \\langle n | V | n \\rangle\n$$\n\n其中 $ |n\\rangle $ 是 $ H_0 $ 的一个具有确定宇称的非简并本征态，满足 $ P|n\\rangle = \\pi_n |n\\rangle $ 且 $ \\pi_n = \\pm 1 $。微扰 $ V $ 在宇称变换下是奇的，因此 $ V(-\\mathbf{r}) = -V(\\mathbf{r}) $，这意味着算符关系为：\n\n$$\nP V P^{-1} = -V\n$$\n\n由于 $ P $ 是幺正且厄米的 ($ P^\\dagger = P $) 并且满足 $ P^2 = I $，我们有 $ P^{-1} = P $。因此：\n\n$$\nP V P = -V\n$$\n\n重新整理得到：\n\n$$\nV P = -P V\n$$\n\n现在计算 $ E_n^{(1)} $：\n\n$$\nE_n^{(1)} = \\langle n | V | n \\rangle = \\langle n | V I | n \\rangle = \\langle n | V P^2 | n \\rangle\n$$\n\n使用 $ V P = -P V $：\n\n$$\n\\langle n | V P^2 | n \\rangle = \\langle n | (V P) P | n \\rangle = \\langle n | (-P V) P | n \\rangle = - \\langle n | P V P | n \\rangle\n$$\n\n由于 $ P | n \\rangle = \\pi_n | n \\rangle $，因此：\n\n$$\nV P | n \\rangle = V (\\pi_n | n \\rangle) = \\pi_n V | n \\rangle\n$$\n\n代入后得到：\n\n$$\n- \\langle n | P V P | n \\rangle = - \\langle n | P (V P | n \\rangle) = - \\langle n | P (\\pi_n V | n \\rangle) = - \\pi_n \\langle n | P V | n \\rangle\n$$\n\n$ P | n \\rangle = \\pi_n | n \\rangle $ 的伴随是 $ \\langle n | P^\\dagger = \\langle n | P = \\pi_n \\langle n | $，所以：\n\n$$\n\\langle n | P V | n \\rangle = \\pi_n \\langle n | V | n \\rangle\n$$\n\n因此：\n\n$$\n- \\pi_n \\langle n | P V | n \\rangle = - \\pi_n (\\pi_n \\langle n | V | n \\rangle) = - \\pi_n^2 \\langle n | V | n \\rangle\n$$\n\n由于 $ \\pi_n^2 = 1 $：\n\n$$\n- \\pi_n^2 \\langle n | V | n \\rangle = - (1) \\langle n | V | n \\rangle = - \\langle n | V | n \\rangle\n$$\n\n所以：\n\n$$\nE_n^{(1)} = - E_n^{(1)}\n$$\n\n这意味着：\n\n$$\n2 E_n^{(1)} = 0 \\quad \\Rightarrow \\quad E_n^{(1)} = 0\n$$\n\n因此，对于任何非简并本征态 $ |n\\rangle $，一阶能量修正始终为零。", "answer": "$$ \\boxed{1} $$", "id": "1212254"}, {"introduction": "当对称性无法使一阶能量修正为零，或当系统处理简并态时，我们就需要一套系统的计算方法。这个问题将引导你处理简并微扰理论这一核心课题，即初始微扰如何解除能级简并。通过“二维无限深方势阱”这个熟悉的模型，本练习将演示在简并子空间中构建并对角化微扰矩阵的标准流程。[@problem_id:222600]", "problem": "一个质量为 $m$ 的粒子被限制在势为 $V(x,y)$ 的二维无限深方势阱中。当 $0 < x < L$ 且 $0 < y < L$ 时，势为零，其他情况下为无穷大。系统的非微扰哈密顿量为 $H_0 = -\\frac{\\hbar^2}{2m}\\left(\\frac{\\partial^2}{\\partial x^2} + \\frac{\\partial^2}{\\partial y^2}\\right)$。其本征函数和本征值由 $\\psi^{(0)}_{n_x, n_y}(x,y) = \\frac{2}{L} \\sin\\left(\\frac{n_x \\pi x}{L}\\right) \\sin\\left(\\frac{n_y \\pi y}{L}\\right)$ 和 $E^{(0)}_{n_x, n_y} = \\frac{\\pi^2 \\hbar^2}{2mL^2}(n_x^2 + n_y^2)$ 给出，其中 $n_x, n_y$ 是正整数。\n\n系统受到一个弱微扰，由哈密顿量 $H' = \\lambda \\delta(x-y)$ 描述，其中 $\\lambda$ 是一个小的实数常量，$\\delta(z)$ 是 Dirac δ函数。\n\n使用一阶简并微扰理论，确定系统第一激发能级的能量分裂。", "solution": "1. 非微扰简并态：\n   $$\\psi_{1,2}^{(0)}(x,y)=\\frac{2}{L}\\sin\\!\\bigl(\\tfrac{\\pi x}{L}\\bigr)\\sin\\!\\bigl(\\tfrac{2\\pi y}{L}\\bigr),\\quad\n     \\psi_{2,1}^{(0)}(x,y)=\\frac{2}{L}\\sin\\!\\bigl(\\tfrac{2\\pi x}{L}\\bigr)\\sin\\!\\bigl(\\tfrac{\\pi y}{L}\\bigr).$$  \n\n2. 在此基下的微扰矩阵元：\n   $$H'_{ij}=\\lambda\\iint_{0}^{L}\\psi_i^{(0)}(x,y)\\,\\delta(x-y)\\,\\psi_j^{(0)}(x,y)\\,dx\\,dy\n             =\\lambda\\int_{0}^{L}\\psi_i^{(0)}(x,x)\\,\\psi_j^{(0)}(x,x)\\,dx.$$  \n\n3. 计算公共积分\n   $$\\alpha=\\int_{0}^{L}\\psi_{1,2}^{(0)}(x,x)^{2}\\,dx\n               =\\int_{0}^{L}\\Bigl(\\frac{2}{L}\\sin\\!\\tfrac{\\pi x}{L}\\sin\\!\\tfrac{2\\pi x}{L}\\Bigr)^{2}dx\n               =\\frac{4}{L^{2}}\\int_{0}^{L}\\sin^{2}\\!\\tfrac{\\pi x}{L}\\,\\sin^{2}\\!\\tfrac{2\\pi x}{L}\\,dx.$$  \n   使用恒等式\n   $$\\sin^{2}A\\,\\sin^{2}B\n     =\\frac{1}{4}\\bigl[1-\\cos2A-\\cos2B+\\tfrac12(\\cos(2A+2B)+\\cos(2A-2B))\\bigr],$$  \n   因此所有余弦积分在 $[0,L]$ 区间上都为零，且\n   $$\\int_{0}^{L}\\sin^{2}\\!\\tfrac{\\pi x}{L}\\,\\sin^{2}\\!\\tfrac{2\\pi x}{L}\\,dx\n     =\\frac{L}{4},$$  \n   因此\n   $$\\alpha=\\frac{4}{L^{2}}\\cdot\\frac{L}{4}=\\frac{1}{L}.$$  \n\n4. 在 $\\{\\psi_{1,2},\\psi_{2,1}\\}$ 基下的微扰矩阵：\n   $$H'=\\lambda\n     \\begin{pmatrix}\\alpha&\\alpha\\\\\\alpha&\\alpha\\end{pmatrix}\n     =\\frac{\\lambda}{L}\n     \\begin{pmatrix}1&1\\\\1&1\\end{pmatrix}.$$  \n\n5. 本征值（一阶能量修正）：\n   $$E^{(1)}_{\\pm}=\\{0,\\;2\\lambda/L\\},$$  \n   所以分裂为\n   $$\\Delta E=2\\lambda/L.$$", "answer": "$$\\boxed{\\frac{2\\lambda}{L}}$$", "id": "222600"}, {"introduction": "标准的瑞利-薛定谔（Rayleigh-Schrödinger）微扰理论在处理近简并系统时可能会失效，这要求我们以更批判性的视角审视其适用范围。本练习将超越纸笔计算，带你进入计算化学的领域，要求你比较RS理论与布里渊-魏格纳（Brillouin-Wigner）理论的性能。通过编程实现并对照精确解来测试这两种方法，你将更深刻地理解它们各自的优缺点，并对微扰近似的可靠性建立起实践性的直觉。[@problem_id:2933735]", "problem": "考虑一个以原子单位（哈特里原子单位制）表示的两态电子模型，其不含时哈密顿量可分割为 $H(\\lambda) = H_0 + \\lambda V$，其中 $H_0$ 是精确可解的，而 $V$ 是一个由无量纲参数 $\\lambda$ 缩放的小微扰。设在 $H_0$ 的未微扰本征基矢 $\\{\\lvert 1 \\rangle, \\lvert 2 \\rangle\\}$ 中，未微扰哈密顿量和微扰由下式给出：\n- $H_0 = \\mathrm{diag}(E_1, E_2)$，其中 $E_1 < E_2$，\n- $V = \\begin{pmatrix} 0 & v \\\\ v & 0 \\end{pmatrix}$，其中 $v$ 为实数，\n并在所有数值计算中取 $\\lambda = 1$。当 $\\lvert E_1 - E_2 \\rvert$ 相对于 $\\lvert v \\rvert$ 很小时，这是一个近简并模型。\n\n你的任务是从不含时微扰理论的第一性原理出发，实现满足以下功能的数值程序：\n- 对每个测试用例构建精确的哈密顿量 $H(\\lambda)$，并通过精确对角化获得其较低的精确本征值 $E_{\\mathrm{exact,lower}}$，\n- 使用上述定义的基矢，为态 $\\lvert 1 \\rangle$ 推导并实现非简并 Rayleigh–Schrödinger (RS) 微扰理论的二阶（关于 $\\lambda$）能量近似，并在 $\\lambda=1$ 处求值以生成 $E_{\\mathrm{RS}}$，\n- 为同一个态推导并实现 Brillouin–Wigner (BW) 微扰理论的自洽能量方程，并求解该方程以获得对应于较低根的 BW 能量 $E_{\\mathrm{BW,lower}}$，\n- 通过计算绝对误差 $\\lvert E_{\\mathrm{RS}} - E_{\\mathrm{exact,lower}} \\rvert$ 和 $\\lvert E_{\\mathrm{BW,lower}} - E_{\\mathrm{exact,lower}} \\rvert$ 来量化每种近似与精确对角化结果的偏差。\n\n你的推导必须严格基于不含时薛定谔方程 $H(\\lambda)\\lvert \\psi(\\lambda) \\rangle = E(\\lambda)\\lvert \\psi(\\lambda) \\rangle$、按 $\\lambda$ 幂次展开的微扰级数的定义、厄米矩阵的线性代数性质，以及将薛定谔方程投影到未微扰本征基矢上的方法。不要假定任何预先给定的微扰理论公式；相反，应从这些基本原理出发进行推理，以获得实现所需的工作表达式。\n\n使用原子单位，其中所有能量（包括 $E_1$、$E_2$、$v$ 及任何能量类的输出）必须以哈特里 (Hartree) 为单位表示。以哈特里为单位报告绝对误差。不涉及角度。\n\n实现你的程序以评估以下参数三元组 $(E_1, E_2, v)$ 的测试套件：\n- 测试 $1$: $(E_1, E_2, v) = (-0.05, 0.05, 0.02)$，\n- 测试 $2$: $(E_1, E_2, v) = (-0.005, 0.005, 0.02)$，\n- 测试 $3$: $(E_1, E_2, v) = (-0.5, 0.5, 0.02)$，\n- 测试 $4$: $(E_1, E_2, v) = (-0.1, 0.1, 0.0)$，\n- 测试 $5$: $(E_1, E_2, v) = (0.10, 0.11, 0.003)$，\n- 测试 $6$: $(E_1, E_2, v) = (0.0, 10^{-6}, 5\\times 10^{-4})$。\n\n对于每个测试用例，你的程序必须以哈特里为单位输出一个包含两个浮点数的列表 $[\\lvert E_{\\mathrm{RS}} - E_{\\mathrm{exact,lower}} \\rvert, \\lvert E_{\\mathrm{BW,lower}} - E_{\\mathrm{exact,lower}} \\rvert]$。将所有测试用例的结果汇总到单一行，格式化为由方括号括起来的逗号分隔列表，其中每个元素是对应一个测试用例的含两个浮点数的列表。例如，输出必须形如 $[[x_1,y_1],[x_2,y_2],\\ldots,[x_6,y_6]]$，不含任何额外的空白或文本。\n\n你的程序应生成单行输出，其中包含以方括号括起来的逗号分隔列表形式的结果（例如，$[[ \\text{result}_{1,1},\\text{result}_{1,2}],[\\text{result}_{2,1},\\text{result}_{2,2}],\\ldots]$）。", "solution": "所提出的问题是量子力学微扰理论中一个标准的、良构的练习。我们将对其进行验证并随后求解。\n\n**问题验证**\n\n首先，我们必须提取已知条件。该问题定义了一个由哈密顿量 $H(\\lambda) = H_0 + \\lambda V$ 支配的两态系统。在未微扰本征态基矢 $\\{\\lvert 1 \\rangle, \\lvert 2 \\rangle\\}$ 中，未微扰哈密顿量 $H_0$ 和微扰 $V$ 表示如下：\n$$\nH_0 = \\begin{pmatrix} E_1 & 0 \\\\ 0 & E_2 \\end{pmatrix}, \\quad E_1 < E_2\n$$\n$$\nV = \\begin{pmatrix} 0 & v \\\\ v & 0 \\end{pmatrix}, \\quad v \\in \\mathbb{R}\n$$\n在所有数值计算中，微扰参数 $\\lambda$ 均设为 $1$。任务是求解源自态 $\\lvert 1 \\rangle$ 的较低精确本征值、二阶 Rayleigh-Schrödinger (RS) 能量和 Brillouin-Wigner (BW) 能量，并计算这些近似的绝对误差。所有推导都必须从第一性原理出发。\n\n该问题在科学上是合理的，因为它基于两能级系统的不含时薛定谔方程，这是量子力学的基石。它是良构的，提供了求解唯一解所需的所有矩阵和参数。其语言客观而精确。问题是完备的、一致的且计算上可行的。它没有违反任何验证标准。因此，该问题被视为有效。我们现在开始推导所需的表达式。\n\n**1. 精确本征值**\n\n当 $\\lambda=1$ 时，完整的哈密顿量是 $H = H_0 + V$。在给定的基矢中，其矩阵表示为：\n$$\nH = \\begin{pmatrix} E_1 & v \\\\ v & E_2 \\end{pmatrix}\n$$\n本征值 $E$ 是特征方程 $\\det(H - E I) = 0$ 的根：\n$$\n\\det \\begin{pmatrix} E_1 - E & v \\\\ v & E_2 - E \\end{pmatrix} = 0\n$$\n$$\n(E_1 - E)(E_2 - E) - v^2 = 0\n$$\n$$\nE^2 - (E_1 + E_2)E + E_1 E_2 - v^2 = 0\n$$\n这是一个关于 $E$ 的二次方程。应用二次公式，我们得到两个精确本征值：\n$$\nE_{\\pm} = \\frac{(E_1 + E_2) \\pm \\sqrt{(E_1 + E_2)^2 - 4(E_1 E_2 - v^2)}}{2}\n$$\n$$\nE_{\\pm} = \\frac{(E_1 + E_2) \\pm \\sqrt{E_1^2 + 2E_1E_2 + E_2^2 - 4E_1E_2 + 4v^2}}{2}\n$$\n$$\nE_{\\pm} = \\frac{(E_1 + E_2) \\pm \\sqrt{(E_1 - E_2)^2 + 4v^2}}{2}\n$$\n问题要求的是较低的精确本征值，我们记为 $E_{\\mathrm{exact,lower}}$。这对应于公式中的负号，因为平方根项总是非负的。\n$$\nE_{\\mathrm{exact,lower}} = \\frac{1}{2}\\left( (E_1 + E_2) - \\sqrt{(E_2 - E_1)^2 + 4v^2} \\right)\n$$\n这个表达式是精确的，将用作我们近似计算的基准。\n\n**2. Rayleigh-Schrödinger (RS) 微扰理论**\n\n我们从不含时薛定谔方程 $H(\\lambda)\\lvert \\psi(\\lambda) \\rangle = E(\\lambda)\\lvert \\psi(\\lambda) \\rangle$ 出发。我们将能量 $E(\\lambda)$ 和态 $\\lvert \\psi(\\lambda) \\rangle$ 展开为 $\\lambda$ 的幂级数：\n$$\nE(\\lambda) = E^{(0)} + \\lambda E^{(1)} + \\lambda^2 E^{(2)} + \\mathcal{O}(\\lambda^3)\n$$\n$$\n\\lvert \\psi(\\lambda) \\rangle = \\lvert \\psi^{(0)} \\rangle + \\lambda \\lvert \\psi^{(1)} \\rangle + \\lambda^2 \\lvert \\psi^{(2)} \\rangle + \\mathcal{O}(\\lambda^3)\n$$\n我们关心的是从未微扰态 $\\lvert 1 \\rangle$ 演化而来的态。因此，我们设 $\\lvert \\psi^{(0)} \\rangle = \\lvert 1 \\rangle$ 和 $E^{(0)} = E_1$。将展开式代入薛定谔方程：\n$$\n(H_0 + \\lambda V)(\\lvert 1 \\rangle + \\lambda \\lvert \\psi^{(1)} \\rangle + \\dots) = (E_1 + \\lambda E^{(1)} + \\lambda^2 E^{(2)} + \\dots)(\\lvert 1 \\rangle + \\lambda \\lvert \\psi^{(1)} \\rangle + \\dots)\n$$\n我们收集 $\\lambda$ 的同阶项。\n零阶方程 $H_0 \\lvert 1 \\rangle = E_1 \\lvert 1 \\rangle$ 根据定义是满足的。\n\n对于一阶项 ($\\mathcal{O}(\\lambda^1)$)：\n$$\nH_0 \\lvert \\psi^{(1)} \\rangle + V \\lvert 1 \\rangle = E_1 \\lvert \\psi^{(1)} \\rangle + E^{(1)} \\lvert 1 \\rangle\n$$\n为了求一阶能量修正 $E^{(1)}$，我们将此方程投影到 $\\langle 1 \\rvert$上：\n$$\n\\langle 1 \\rvert H_0 \\lvert \\psi^{(1)} \\rangle + \\langle 1 \\rvert V \\lvert 1 \\rangle = E_1 \\langle 1 \\rvert \\psi^{(1)} \\rangle + E^{(1)} \\langle 1 \\rvert 1 \\rangle\n$$\n由于 $H_0$ 是厄米的且 $\\langle 1 \\rvert H_0 = E_1 \\langle 1 \\rvert$，左边的第一项变为 $E_1 \\langle 1 \\rvert \\psi^{(1)} \\rangle$。又因为 $\\langle 1 \\rvert 1 \\rangle = 1$，方程简化为：\n$$\nE_1 \\langle 1 \\rvert \\psi^{(1)} \\rangle + V_{11} = E_1 \\langle 1 \\rvert \\psi^{(1)} \\rangle + E^{(1)}\n$$\n$$\nE^{(1)} = V_{11}\n$$\n根据问题定义，$V$ 的对角元素为零，所以 $V_{11} = 0$。因此，$E^{(1)} = 0$。\n\n对于二阶项 ($\\mathcal{O}(\\lambda^2)$)：\n$$\nH_0 \\lvert \\psi^{(2)} \\rangle + V \\lvert \\psi^{(1)} \\rangle = E_1 \\lvert \\psi^{(2)} \\rangle + E^{(1)} \\lvert \\psi^{(1)} \\rangle + E^{(2)} \\lvert 1 \\rangle\n$$\n投影到 $\\langle 1 \\rvert$ 上：\n$$\n\\langle 1 \\rvert H_0 \\lvert \\psi^{(2)} \\rangle + \\langle 1 \\rvert V \\lvert \\psi^{(1)} \\rangle = E_1 \\langle 1 \\rvert \\psi^{(2)} \\rangle + E^{(1)} \\langle 1 \\rvert \\psi^{(1)} \\rangle + E^{(2)} \\langle 1 \\rvert 1 \\rangle\n$$\n两边的第一项相互抵消，剩下：\n$$\nE^{(2)} = \\langle 1 \\rvert V \\lvert \\psi^{(1)} \\rangle - E^{(1)} \\langle 1 \\rvert \\psi^{(1)} \\rangle\n$$\n由于 $E^{(1)} = 0$，上式简化为 $E^{(2)} = \\langle 1 \\rvert V \\lvert \\psi^{(1)} \\rangle$。我们必须先求出一阶波函数修正 $\\lvert \\psi^{(1)} \\rangle$。从一阶方程重新整理得到：\n$$\n(H_0 - E_1) \\lvert \\psi^{(1)} \\rangle = (E^{(1)} - V) \\lvert 1 \\rangle = -V \\lvert 1 \\rangle\n$$\n我们将 $\\lvert \\psi^{(1)} \\rangle$ 在未微扰基矢中展开：$\\lvert \\psi^{(1)} \\rangle = c_{11} \\lvert 1 \\rangle + c_{12} \\lvert 2 \\rangle$。RS 理论中的标准约定是设 $\\langle 1 \\rvert \\psi^{(1)} \\rangle = 0$，这意味着 $c_{11} = 0$。所以，$\\lvert \\psi^{(1)} \\rangle = c_{12} \\lvert 2 \\rangle$。将 $\\lvert \\psi^{(1)} \\rangle$ 的方程投影到 $\\langle 2 \\rvert$ 上：\n$$\n\\langle 2 \\rvert (H_0 - E_1) (c_{12} \\lvert 2 \\rangle) = -\\langle 2 \\rvert V \\lvert 1 \\rangle\n$$\n$$\nc_{12} \\langle 2 \\rvert (E_2 - E_1) \\lvert 2 \\rangle = -V_{21}\n$$\n$$\nc_{12} (E_2 - E_1) = -v\n$$\n$$\nc_{12} = \\frac{-v}{E_2 - E_1}\n$$\n所以，$\\lvert \\psi^{(1)} \\rangle = \\frac{-v}{E_2 - E_1} \\lvert 2 \\rangle$。现在我们可以计算 $E^{(2)}$：\n$$\nE^{(2)} = \\langle 1 \\rvert V \\left( \\frac{-v}{E_2 - E_1} \\lvert 2 \\rangle \\right) = \\frac{-v}{E_2 - E_1} \\langle 1 \\rvert V \\lvert 2 \\rangle = \\frac{-v}{E_2 - E_1} V_{12}\n$$\n因为 $V_{12} = v$，我们有：\n$$\nE^{(2)} = -\\frac{v^2}{E_2 - E_1}\n$$\n近似到二阶的 RS 能量为 $E_{\\mathrm{RS}} = E^{(0)} + \\lambda E^{(1)} + \\lambda^2 E^{(2)}$。在 $\\lambda = 1$ 处求值：\n$$\nE_{\\mathrm{RS}} = E_1 - \\frac{v^2}{E_2 - E_1}\n$$\n\n**3. Brillouin-Wigner (BW) 微扰理论**\n\nBW 公式避免在方程内部展开能量 $E$。我们再次从薛定谔方程出发，设 $\\lambda=1$：$(H_0 + V) \\lvert \\psi \\rangle = E \\lvert \\psi \\rangle$。我们可以将其写作：\n$$\n(E - H_0) \\lvert \\psi \\rangle = V \\lvert \\psi \\rangle\n$$\n让我们在未微扰基矢中表示未知态 $\\lvert \\psi \\rangle$：$\\lvert \\psi \\rangle = c_1 \\lvert 1 \\rangle + c_2 \\lvert 2 \\rangle$。将此代入薛定谔方程的矩阵形式：\n$$\n\\begin{pmatrix} E_1 & v \\\\ v & E_2 \\end{pmatrix} \\begin{pmatrix} c_1 \\\\ c_2 \\end{pmatrix} = E \\begin{pmatrix} c_1 \\\\ c_2 \\end{pmatrix}\n$$\n这得到一个由两个线性方程组成的方程组：\n$$\nE_1 c_1 + v c_2 = E c_1  \\quad \\implies \\quad (E - E_1) c_1 = v c_2\n$$\n$$\nv c_1 + E_2 c_2 = E c_2  \\quad \\implies \\quad v c_1 = (E - E_2) c_2\n$$\nBW 理论使用中间归一化，对于从 $\\lvert 1 \\rangle$ 演化而来的态，这意味着我们将其在 $\\lvert 1 \\rangle$ 方向上的分量固定为 1。即，我们设 $c_1 = 1$。方程变为：\n$$\nE - E_1 = v c_2\n$$\n$$\nv = (E - E_2) c_2\n$$\n从第二个方程中，我们将 $c_2$ 表示为 $c_2 = \\frac{v}{E - E_2}$。然后将其代入第一个方程：\n$$\nE - E_1 = v \\left( \\frac{v}{E - E_2} \\right)\n$$\n这就得到了 BW 能量 $E$ 的自洽方程：\n$$\nE = E_1 + \\frac{v^2}{E - E_2}\n$$\n为求解 $E$，我们将其整理成多项式形式：\n$$\n(E - E_1)(E - E_2) = v^2\n$$\n$$\nE^2 - (E_1 + E_2)E + E_1 E_2 - v^2 = 0\n$$\n这正是在求解精确本征值时得到的特征方程。在 BW 形式中，$E$ 的解就是系统的精确能量。这是一个关于两能级系统的已知结果。问题要求的是较低的根 $E_{\\mathrm{BW,lower}}$，它必然等于 $E_{\\mathrm{exact,lower}}$：\n$$\nE_{\\mathrm{BW,lower}} = \\frac{1}{2}\\left( (E_1 + E_2) - \\sqrt{(E_2 - E_1)^2 + 4v^2} \\right)\n$$\n\n**4. 误差计算**\n绝对误差计算如下：\n$$\n\\text{Error}_{\\mathrm{RS}} = \\lvert E_{\\mathrm{RS}} - E_{\\mathrm{exact,lower}} \\rvert\n$$\n$$\n\\text{Error}_{\\mathrm{BW}} = \\lvert E_{\\mathrm{BW,lower}} - E_{\\mathrm{exact,lower}} \\rvert\n$$\n从我们的推导中可以清楚地看到，对于这个特定问题，$E_{\\mathrm{BW,lower}} = E_{\\mathrm{exact,lower}}$，因此对于所有测试用例，$\\text{Error}_{\\mathrm{BW}}$ 将恒等于零。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes absolute errors for Rayleigh-Schrödinger and Brillouin-Wigner\n    perturbation theories for a two-level system against exact diagonalization.\n    \"\"\"\n    \n    # Test cases are given as tuples (E1, E2, v) in Hartree atomic units.\n    # E1, E2 are unperturbed energies; v is the off-diagonal coupling.\n    test_cases = [\n        (-0.05, 0.05, 0.02),      # Test 1\n        (-0.005, 0.005, 0.02),    # Test 2\n        (-0.5, 0.5, 0.02),        # Test 3\n        (-0.1, 0.1, 0.0),         # Test 4\n        (0.10, 0.11, 0.003),      # Test 5\n        (0.0, 1e-6, 5e-4),        # Test 6\n    ]\n\n    all_results = []\n\n    for case in test_cases:\n        e1, e2, v = case\n\n        # The unperturbed energy difference, delta_e = E2 - E1.\n        delta_e = e2 - e1\n\n        # 1. Calculation of the lower exact eigenvalue from the characteristic equation.\n        # E_exact_lower = 0.5 * ( (e1 + e2) - sqrt((e2 - e1)^2 + 4*v^2) )\n        sqrt_term = np.sqrt(delta_e**2 + 4 * v**2)\n        e_exact_lower = 0.5 * (e1 + e2 - sqrt_term)\n\n        # 2. Calculation of the Rayleigh-Schrödinger energy to second order.\n        # E_RS = E1 - v^2 / (E2 - E1)\n        # This formula is valid as E1 != E2 in all test cases.\n        if delta_e == 0: # Avoid division by zero for degenerate case, although not in tests\n            e_rs = e1\n        else:\n            e_rs = e1 - (v**2) / delta_e\n\n        # 3. Calculation of the Brillouin-Wigner energy for the lower root.\n        # For a two-level system, the BW self-consistent equation yields a quadratic\n        # equation identical to the exact secular equation. Thus, its roots are the exact energies.\n        e_bw_lower = e_exact_lower\n\n        # 4. Computation of absolute errors for both theories.\n        error_rs = np.abs(e_rs - e_exact_lower)\n        error_bw = np.abs(e_bw_lower - e_exact_lower)  # This is analytically 0.0\n\n        all_results.append([error_rs, error_bw])\n\n    # Format the final output string as a list of lists: [[err1,err2],[err3,err4],...].\n    # The format must be exact, with no whitespace inside the inner brackets.\n    result_str = \"[\" + \",\".join([f\"[{res[0]},{res[1]}]\" for res in all_results]) + \"]\"\n    \n    print(result_str)\n\nsolve()\n```", "id": "2933735"}]}