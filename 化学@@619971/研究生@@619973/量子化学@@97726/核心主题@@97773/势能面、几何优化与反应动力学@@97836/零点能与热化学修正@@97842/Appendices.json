{"hands_on_practices": [{"introduction": "本练习是热化学矫正的第一步，也是最基本的一步：从谐振频率计算零点振动能（ZPVE）。这个练习将阐明分子振动的量子性质如何直接影响其基态能量，这是连接量子力学计算和实验热力学的关键基础。通过这个计算，您将掌握将光谱数据（波数）转化为原子单位能量的核心技能 [@problem_id:2936574]。", "problem": "一个线性三原子分子已在其平衡构型下，通过谐振子近似进行了表征。计算得到的谐振动波数（已移除所有虚频）分别为 $2349\\ \\text{cm}^{-1}$、$1333\\ \\text{cm}^{-1}$、$667\\ \\text{cm}^{-1}$ 和 $667\\ \\text{cm}^{-1}$。请仅从量子谐振子能级结构以及连接能量与波数的光谱关系出发，推导一个用给定波数计算零点振动能（ZPVE）的公式。然后，对 ZPVE 进行数值计算，并将其结果以哈特里原子能量单位（哈特里）表示。使用转换因子 $1\\ \\text{Hartree} = 219474.63137\\ \\text{cm}^{-1}$。请明确验证您转换过程中的单位一致性。将您的最终数值答案四舍五入至六位有效数字，并以哈特里为单位表示最终能量。", "solution": "该问题被验证为具有科学依据、良定且客观。它基于量子力学和分子光谱学的基本原理，并为获得唯一解提供了充分且一致的信息。\n\n零点振动能（ZPVE）的推导始于单个量子谐振子（QHO）的能级。对于频率为 $\\nu$ 的一个振动简正模式，其允许的能级由以下表达式给出：\n$$ E_n = \\left(n + \\frac{1}{2}\\right)h\\nu $$\n其中 $h$ 是普朗克常数，$n$ 是振动量子数，可取整数值 $n = 0, 1, 2, \\dots$。零点能（ZPE）是谐振子可能具有的最低能量，对应于 $n=0$ 的振动基态。将 $n=0$ 代入能级表达式，得到单个模式的 ZPE：\n$$ E_0 = \\left(0 + \\frac{1}{2}\\right)h\\nu = \\frac{1}{2}h\\nu $$\n一个多原子分子拥有多个振动简正模式。在谐振子近似下，分子的总振动能是其所有独立简正模式能量的总和。对于一个含有 $N$ 个原子的线性分子，其振动模式数为 $3N-5$。本题涉及一个线性三原子分子，因此 $N=3$，得出 $3(3)-5=4$ 个振动模式。这与题目提供的四个振动波数相符。\n\n分子的总零点振动能（ZPVE）是其所有 $M=4$ 个振动模式的零点能之和：\n$$ \\text{ZPVE} = \\sum_{i=1}^{M} E_{0,i} = \\sum_{i=1}^{4} \\frac{1}{2}h\\nu_i = \\frac{1}{2}h \\sum_{i=1}^{4} \\nu_i $$\n题目以波数 $\\tilde{\\nu}_i$ 的形式提供了振动数据，其单位是 $\\text{cm}^{-1}$。连接能量 $E$、频率 $\\nu$ 和波数 $\\tilde{\\nu}$ 的光谱关系是 $E = h\\nu = hc\\tilde{\\nu}$，其中 $c$ 是光速。使用这个关系，单个模式 $i$ 的 ZPE 可以用其波数表示为：\n$$ E_{0,i} = \\frac{1}{2}hc\\tilde{\\nu}_i $$\n因此，分子的总 ZPVE 是：\n$$ \\text{ZPVE} = \\sum_{i=1}^{4} \\frac{1}{2}hc\\tilde{\\nu}_i = \\frac{1}{2}hc \\sum_{i=1}^{4} \\tilde{\\nu}_i $$\n物理量 $\\frac{1}{2} \\sum_{i=1}^{4} \\tilde{\\nu}_i$ 表示以波数单位（$\\text{cm}^{-1}$）表示的 ZPVE。我们使用给定的数据来计算这个值：$\\tilde{\\nu}_1 = 2349\\ \\text{cm}^{-1}$，$\\tilde{\\nu}_2 = 1333\\ \\text{cm}^{-1}$，$\\tilde{\\nu}_3 = 667\\ \\text{cm}^{-1}$ 和 $\\tilde{\\nu}_4 = 667\\ \\text{cm}^{-1}$。波数之和为：\n$$ \\sum_{i=1}^{4} \\tilde{\\nu}_i = 2349\\ \\text{cm}^{-1} + 1333\\ \\text{cm}^{-1} + 667\\ \\text{cm}^{-1} + 667\\ \\text{cm}^{-1} = 5016\\ \\text{cm}^{-1} $$\n那么，以波数单位表示的 ZPVE 是：\n$$ \\tilde{E}_{\\text{ZPVE}} = \\frac{1}{2} \\sum_{i=1}^{4} \\tilde{\\nu}_i = \\frac{1}{2} (5016\\ \\text{cm}^{-1}) = 2508\\ \\text{cm}^{-1} $$\n最后一步是将这个能量从倒易厘米（$\\text{cm}^{-1}$）单位转换为原子能量单位，即哈特里（$E_h$）。题目提供了转换因子：$1\\ E_h = 219474.63137\\ \\text{cm}^{-1}$。\n\n有必要验证单位的一致性。关系式 $1\\ E_h = C\\ \\text{cm}^{-1}$（其中 $C = 219474.63137$）意味着一个哈特里的能量对应于一个波数为 $C$ 的量子。要将以 $\\text{cm}^{-1}$ 表示的能量 $\\tilde{E}$ 转换为以哈特里为单位的等效值 $E$，必须除以这个转换因子。单位处理如下：\n$$ E\\ [E_h] = \\frac{\\tilde{E}\\ [\\text{cm}^{-1}]}{C\\ [\\text{cm}^{-1}/E_h]} $$\n此操作表明 $\\text{cm}^{-1}$ 单位被消去，得到以 $E_h$ 为单位的结果，从而证实了转换的量纲一致性。\n\n现在我们进行数值计算：\n$$ \\text{ZPVE}\\ [E_h] = \\frac{2508}{219474.63137} \\approx 0.011427281\\ E_h $$\n题目要求答案四舍五入到六位有效数字。第一个非零数字是第一位有效数字。因此，我们将该值四舍五入为 $0.0114273$。", "answer": "$$\\boxed{0.0114273}$$", "id": "2936574"}, {"introduction": "在计算了零点能之后，下一步是考虑温度对热化学性质的影响。本练习将指导您构建振动配分函数，并用它来计算分子的振动熵，这是在有限温度下最重要的热力学矫正之一。通过从第一性原理推导和计算熵，您将更深入地理解统计力学如何将微观的量子能级与宏观的热力学函数联系起来 [@problem_id:2936575]。", "problem": "一个非线性四原子分子有 $3N-6=6$ 个简谐振动简正模式。将每个模式视为一个独立的量子谐振子，其能级为 $E_{n,k} = h \\nu_k \\left(n + \\frac{1}{2}\\right)$（对于模式 $k$），其中 $\\nu_k$ 是与波数 $\\tilde{\\nu}_k$ 对应的频率。测得的基本波数为：\n- $\\tilde{\\nu}_1 = 220\\,\\mathrm{cm^{-1}}$\n- $\\tilde{\\nu}_2 = 350\\,\\mathrm{cm^{-1}}$\n- $\\tilde{\\nu}_3 = 600\\,\\mathrm{cm^{-1}}$\n- $\\tilde{\\nu}_4 = 1020\\,\\mathrm{cm^{-1}}$\n- $\\tilde{\\nu}_5 = 1540\\,\\mathrm{cm^{-1}}$\n- $\\tilde{\\nu}_6 = 3120\\,\\mathrm{cm^{-1}}$\n\n假设所有模式都是非简并、可分离和简谐的。在温度 $T = 500\\,\\mathrm{K}$ 下，完成以下任务：\n\n1. 从正则配分函数定义 $q_{\\text{vib},k} = \\sum_{n=0}^{\\infty} \\exp\\!\\left(-\\beta E_{n,k}\\right)$（其中 $\\beta = 1/(k_B T)$）和简谐振子能谱出发，通过对几何级数进行显式求和，推导出单模式振动配分函数 $q_{\\text{vib},k}$。将总分子振动配分函数构建为 $Q_{\\text{vib}} = \\prod_{k=1}^{6} q_{\\text{vib},k}$。\n2. 根据正则定义，用 $Q_{\\text{vib}}$ 和模式频率表示一摩尔分子的总振动熵 $S_{\\text{vib}}(T)$。在 $T=500\\,\\mathrm{K}$ 时，对给定的一组波数进行 $S_{\\text{vib}}$ 的数值计算。\n\n使用以下常数：$h = 6.62607015\\times 10^{-34}\\,\\mathrm{J\\cdot s}$，$c = 2.99792458\\times 10^{10}\\,\\mathrm{cm\\cdot s^{-1}}$，$k_B = 1.380649\\times 10^{-23}\\,\\mathrm{J\\cdot K^{-1}}$，$N_A = 6.02214076\\times 10^{23}\\,\\mathrm{mol^{-1}}$，以及 $R = N_A k_B = 8.314462618\\,\\mathrm{J\\cdot mol^{-1}\\cdot K^{-1}}$。您也可以使用 $hc/k_B = 1.438776877\\,\\mathrm{K\\cdot cm}$。\n\n将最终的熵以 $\\mathrm{J\\cdot mol^{-1}\\cdot K^{-1}}$ 为单位表示为一个数值，并将答案保留到四位有效数字。", "solution": "该问题要求在给定基本振动波数的情况下，推导一个非线性四原子分子在指定温度下的分子振动配分函数，并随后计算其摩尔振动熵。\n\n首先，我们验证问题的有效性。已知条件如下：\n- 一个非线性四原子分子 ($N=4$)，有 $3N-6=3(4)-6=6$ 个振动模式。\n- 六个基本振动波数为 $\\tilde{\\nu}_1 = 220\\,\\mathrm{cm^{-1}}$、$\\tilde{\\nu}_2 = 350\\,\\mathrm{cm^{-1}}$、$\\tilde{\\nu}_3 = 600\\,\\mathrm{cm^{-1}}$、$\\tilde{\\nu}_4 = 1020\\,\\mathrm{cm^{-1}}$、$\\tilde{\\nu}_5 = 1540\\,\\mathrm{cm^{-1}}$ 和 $\\tilde{\\nu}_6 = 3120\\,\\mathrm{cm^{-1}}$。\n- 温度为 $T = 500\\,\\mathrm{K}$。\n- 振动模式被视为独立的量子谐振子。\n- 模式 $k$ 的能级为 $E_{n,k} = h \\nu_k (n + 1/2)$，其中 $\\nu_k = c\\tilde{\\nu}_k$。\n- 提供了所需的常数：$h$、$c$、$k_B$、$N_A$、$R$ 以及复合常数 $hc/k_B$。\n\n该问题基于量子力学和统计力学中的标准谐振子模型，具有科学依据。问题是适定的，为获得唯一解提供了所有必要信息。语言客观而精确。因此，该问题是有效的，我们可以进行求解。\n\n第1部分：振动配分函数的推导\n\n单个振动模式 $k$（被视为一个量子谐振子）的正则配分函数由其所有量子态 $n$ 的求和给出：\n$$q_{\\text{vib},k} = \\sum_{n=0}^{\\infty} \\exp(-\\beta E_{n,k})$$\n其中 $\\beta = 1/(k_B T)$，能级为 $E_{n,k} = hc\\tilde{\\nu}_k(n + 1/2)$。将能量表达式代入配分函数定义中，得到：\n$$q_{\\text{vib},k} = \\sum_{n=0}^{\\infty} \\exp\\left(-\\beta hc\\tilde{\\nu}_k \\left(n + \\frac{1}{2}\\right)\\right)$$\n我们可以提出对应于零点能（$n=0$）的项，因为它与求和指数 $n$ 无关：\n$$q_{\\text{vib},k} = \\exp\\left(-\\frac{\\beta hc\\tilde{\\nu}_k}{2}\\right) \\sum_{n=0}^{\\infty} \\exp(-n\\beta hc\\tilde{\\nu}_k)$$\n该求和是一个形式为 $\\sum_{n=0}^{\\infty} x^n$ 的几何级数，其中 $x = \\exp(-\\beta hc\\tilde{\\nu}_k)$。因为 $\\beta$、$h$、$c$ 和 $\\tilde{\\nu}_k$ 都是正数，所以我们有 $0 < x < 1$。这种级数的和为 $1/(1-x)$。因此，该求和的计算结果为：\n$$\\sum_{n=0}^{\\infty} \\left[\\exp(-\\beta hc\\tilde{\\nu}_k)\\right]^n = \\frac{1}{1 - \\exp(-\\beta hc\\tilde{\\nu}_k)}$$\n将此结果代回，我们得到以势能阱底部为能量零点的单模式振动配分函数的表达式：\n$$q_{\\text{vib},k} = \\frac{\\exp(-\\beta hc\\tilde{\\nu}_k / 2)}{1 - \\exp(-\\beta hc\\tilde{\\nu}_k)}$$\n由于假定振动模式是独立且可分离的，总分子振动配分函数 $Q_{\\text{vib}}$ 是6个模式各自配分函数的乘积：\n$$Q_{\\text{vib}} = \\prod_{k=1}^{6} q_{\\text{vib},k} = \\prod_{k=1}^{6} \\frac{\\exp(-\\beta hc\\tilde{\\nu}_k / 2)}{1 - \\exp(-\\beta hc\\tilde{\\nu}_k)}$$\n\n第2部分：摩尔振动熵的推导与计算\n\n摩尔振动熵 $S_{\\text{vib}}$ 可通过统计力学的基本关系式 $S = (U-A)/T$ 推导。对于一摩尔理想气体，此关系变为 $S_{molar} = U_{molar}/T + R \\ln Q$。振动内能 $U_{vib}$ 和振动配分函数对数 $\\ln Q_{vib}$ 都是各简正模式贡献的总和。对于单个模式 $k$：\n$$ \\ln q_{\\text{vib},k} = -\\frac{\\beta hc\\tilde{\\nu}_k}{2} - \\ln(1 - \\exp(-\\beta hc\\tilde{\\nu}_k)) $$\n$$ U_{\\text{vib},k} = N_A k_B T^2 \\frac{d \\ln q_{\\text{vib},k}}{dT} = N_A \\left( \\frac{hc\\tilde{\\nu}_k}{2} + \\frac{hc\\tilde{\\nu}_k}{\\exp(\\beta hc\\tilde{\\nu}_k) - 1} \\right) $$\n将以上两式代入摩尔熵的表达式 $S_{\\text{vib},k} = U_{\\text{vib},k}/T + R \\ln q_{\\text{vib},k}$：\n$$ S_{\\text{vib},k} = \\frac{N_A}{T} \\left( \\frac{hc\\tilde{\\nu}_k}{2} + \\frac{hc\\tilde{\\nu}_k}{\\exp(\\beta hc\\tilde{\\nu}_k) - 1} \\right) + R \\left( -\\frac{\\beta hc\\tilde{\\nu}_k}{2} - \\ln(1 - \\exp(-\\beta hc\\tilde{\\nu}_k)) \\right) $$\n注意到 $R = N_A k_B$ 且 $\\beta=1/(k_B T)$，因此 $\\frac{N_A hc\\tilde{\\nu}_k}{2T} = R \\frac{\\beta hc\\tilde{\\nu}_k}{2}$。零点能相关的项相互抵消，这表明熵作为无序度的量度，与能量零点的选择无关。整理后，单个模式的振动熵为：\n$$ S_{\\text{vib},k} = R \\left[ \\frac{\\beta hc\\tilde{\\nu}_k}{\\exp(\\beta hc\\tilde{\\nu}_k) - 1} - \\ln(1 - \\exp(-\\beta hc\\tilde{\\nu}_k)) \\right] $$\n分子的总振动熵是所有模式贡献的总和:\n$$S_{\\text{vib}} = R \\sum_{k=1}^{6} \\left[ \\frac{\\beta hc\\tilde{\\nu}_k}{\\exp(\\beta hc\\tilde{\\nu}_k) - 1} - \\ln(1 - \\exp(-\\beta hc\\tilde{\\nu}_k)) \\right]$$\n为了进行数值计算，我们定义一个无量纲变量 $x_k = \\beta hc\\tilde{\\nu}_k = \\frac{hc\\tilde{\\nu}_k}{k_B T}$。表达式变为：\n$$S_{\\text{vib}} = R \\sum_{k=1}^{6} \\left[ \\frac{x_k}{\\exp(x_k) - 1} - \\ln(1 - \\exp(-x_k)) \\right]$$\n我们使用给定的常数 $T = 500\\,\\mathrm{K}$ 和 $\\frac{hc}{k_B} = 1.438776877\\,\\mathrm{K\\cdot cm}$。\n首先，计算 $x_k = \\tilde{\\nu}_k \\times \\frac{hc}{k_B T} = \\tilde{\\nu}_k \\times \\frac{1.438776877\\,\\mathrm{K\\cdot cm}}{500\\,\\mathrm{K}} = \\tilde{\\nu}_k \\times 0.002877553754\\,\\mathrm{cm}$。\n每个模式的 $x_k$ 值为：\n- $x_1 = 220 \\times 0.002877... = 0.63306$\n- $x_2 = 350 \\times 0.002877... = 1.00714$\n- $x_3 = 600 \\times 0.002877... = 1.72653$\n- $x_4 = 1020 \\times 0.002877... = 2.93510$\n- $x_5 = 1540 \\times 0.002877... = 4.43143$\n- $x_6 = 3120 \\times 0.002877... = 8.97801$\n\n现在，我们计算每个模式的熵贡献 $S_{\\text{vib}, k}/R$：\n- $S_1/R = \\frac{0.63306}{\\exp(0.63306) - 1} - \\ln(1 - \\exp(-0.63306)) = 0.71663 + 0.75702 = 1.47365$\n- $S_2/R = \\frac{1.00714}{\\exp(1.00714) - 1} - \\ln(1 - \\exp(-1.00714)) = 0.57952 + 0.45453 = 1.03405$\n- $S_3/R = \\frac{1.72653}{\\exp(1.72653) - 1} - \\ln(1 - \\exp(-1.72653)) = 0.37359 + 0.19595 = 0.56954$\n- $S_4/R = \\frac{2.93510}{\\exp(2.93510) - 1} - \\ln(1 - \\exp(-2.93510)) = 0.16469 + 0.05459 = 0.21928$\n- $S_5/R = \\frac{4.43143}{\\exp(4.43143) - 1} - \\ln(1 - \\exp(-4.43143)) = 0.05336 + 0.01202 = 0.06538$\n- $S_6/R = \\frac{8.97801}{\\exp(8.97801) - 1} - \\ln(1 - \\exp(-8.97801)) = 0.00113 + 0.00013 = 0.00126$\n\n总无量纲熵是这些贡献的总和：\n$$\\frac{S_{\\text{vib}}}{R} = \\sum_{k=1}^{6} \\frac{S_k}{R} = 1.47365 + 1.03405 + 0.56954 + 0.21928 + 0.06538 + 0.00126 = 3.36316$$\n最后，我们乘以摩尔气体常数 $R = 8.314462618\\,\\mathrm{J\\cdot mol^{-1}\\cdot K^{-1}}$：\n$$S_{\\text{vib}} = 3.36316 \\times 8.314462618\\,\\mathrm{J\\cdot mol^{-1}\\cdot K^{-1}} = 27.9566\\,\\mathrm{J\\cdot mol^{-1}\\cdot K^{-1}}$$\n按要求将最终答案四舍五入到四位有效数字，得到 $27.96\\,\\mathrm{J\\cdot mol^{-1}\\cdot K^{-1}}$。", "answer": "$$\\boxed{27.96}$$", "id": "2936575"}, {"introduction": "谐振子模型虽然强大，但对于低频、大幅度的运动（如分子内旋转）则会引入显著误差。本高级练习旨在解决这一局限性，要求您通过编程实现一个更精确的受阻转子模型来处理这类非谐性效应。您将学习如何拟合势能面、从第一性原理推导和计算受阻转子与谐振子的自由能，并最终量化两者之间的热化学矫正差异 [@problem_id:2936576]。", "problem": "给定您一维扭转势能面的离散扫描数据，形式为角度和能量对。您的任务是编写一个完整的程序，对每次扫描进行如下操作：将截断傅里叶级数拟合到周期性势能上，使用半经典受阻转子模型计算扭转自由能，根据拟合势能在全局最小值处的局部曲率计算谐振子自由能，并返回每个测试用例的热化学校正，其定义为吉布斯自由能之差 $\\Delta G^\\circ(T) = G^\\circ_{\\mathrm{HR}}(T) - G^\\circ_{\\mathrm{HO}}(T)$。所有自由能必须以 $\\mathrm{kJ/mol}$ 为单位报告（每摩尔），并四舍五入到六位小数。\n\n在您的推导和算法设计中，您可以引用的基本出发点仅限于：统计力学的正则配分函数定义、量子化谐振子能谱和配分函数，以及通过在有适当相空间归一化和对称数的情况下对角动量和角度积分得到的一维受阻转子的经典极限。您必须从这些基础出发，推导出您所使用的任何工作公式。您必须通过将最小值处的曲率与给定转动惯量的转子微小振动的运动方程联系起来，来证明您是如何从拟合势能中获得局部扭转角频率的。在您的推导中，不允许使用任何其他快捷公式。\n\n输入数据与单位：\n- 每个测试用例提供：\n  - 一个角度列表（单位：度），$\\{\\phi_i\\}_{i=1}^{N}$，覆盖一个完整周期 $[0^\\circ,360^\\circ)$。\n  - 一个对应的能量列表（单位：$\\mathrm{kJ/mol}$），$\\{E_i\\}_{i=1}^{N}$，对应于那些角度。\n  - 一个对称数 $\\sigma$（无量纲整数），表示等效最小值之间的不可区分性。\n  - 一个用于扭转运动的标量转动惯量 $I$（单位：$\\mathrm{kg \\cdot m^2}$）。\n  - 一个温度 $T$（单位：$\\mathrm{K}$）。\n  - 一个用于傅里叶拟合的最高阶数的正整数 $M$。\n- 您的程序必须在所有三角函数运算中将角度转换为弧度。\n- 您的程序必须在适当时使用 Avogadro 常数将能量从 $\\mathrm{kJ/mol}$ 转换为焦耳/分子。\n\n建模要求：\n- 通过线性最小二乘法，将形式为 $V(\\phi) \\approx c_0 + \\sum_{n=1}^{M} \\left[a_n \\cos(n \\phi) + b_n \\sin(n \\phi)\\right]$ 的截断傅里叶级数拟合到所提供的 $(\\phi_i,E_i)$ 数据（其中 $\\phi_i$ 以弧度为单位）。拟合必须包含常数项。所有系数必须根据数据确定，不得假设。\n- 以数值方式确定拟合的 $V(\\phi)$ 在 $[0,2\\pi)$ 上的全局最小值 $\\phi_0$，并平移势能，使得在所有后续热力学计算中 $V(\\phi_0)=0$。\n- 通过微振动关系，从拟合势能在 $\\phi_0$ 处的二阶导数和给定的 $I$ 中，获得谐振子模型的扭转角频率 $\\omega$。\n- 根据量子化谐振子的第一性原理，在温度 $T$ 下计算此扭转对自由能的谐振子贡献。\n- 通过计算遵循含对称数 $\\sigma$ 的正则相空间积分得到的一维经典受阻转子配分函数，来计算受阻转子自由能。位形积分 $\\int_0^{2\\pi} \\exp[-\\beta V(\\phi)] \\, d\\phi$ 必须以足够高的精度进行数值计算；角度 $\\phi$ 必须以弧度为单位。您的程序必须确保整个计算过程中能量单位的一致性。\n- 所需的热化学校正为 $\\Delta G^\\circ(T) = G^\\circ_{\\mathrm{HR}}(T) - G^\\circ_{\\mathrm{HO}}(T)$。\n\n物理常数：\n- 使用 Boltzmann 常数 $k_{\\mathrm{B}}$（单位 $\\mathrm{J/K}$）、Planck 常数 $h$（单位 $\\mathrm{J \\cdot s}$）、约化 Planck 常数 $\\hbar = h/(2\\pi)$ 和 Avogadro 常数 $N_{\\mathrm{A}}$（单位 $\\mathrm{mol^{-1}}$）。\n- 所有结果必须以 $\\mathrm{kJ/mol}$ 为单位报告。\n\n数值要求：\n- 对于平滑势能，对 $\\phi$ 的数值积分的相对误差必须优于 $10^{-8}$；您可以使用任何稳健的求积法或足够精细的复合求积法则来确保这一点。\n- 傅里叶拟合必须数值稳定；请使用标准的线性最小二乘法。\n\n角度单位：\n- 所有以度为单位提供的角度，在进行任何三角或积分计算之前必须转换为弧度。所有关于角度的积分都必须以弧度进行。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个逗号分隔的结果列表，列表置于方括号内，每个条目是对应测试用例的 $\\Delta G^\\circ(T)$ 值（单位 $\\mathrm{kJ/mol}$），四舍五入到六位小数，顺序与下面的测试套件相同。例如：$[x_1,x_2,x_3]$。\n\n测试套件：\n- 测试用例 $1$ (中等三​重势垒):\n  - 角度（度）：$[0,30,60,90,120,150,180,210,240,270,300,330]$。\n  - 能量（$\\mathrm{kJ/mol}$）：$[0.0,6.2,12.0,6.2,0.0,6.2,12.0,6.2,0.0,6.2,12.0,6.2]$。\n  - 对称数：$\\sigma = 3$。\n  - 转动惯量：$I = 6.0\\times 10^{-47}\\ \\mathrm{kg \\cdot m^2}$。\n  - 温度：$T = 298.15\\ \\mathrm{K}$。\n  - 傅里叶阶数：$M = 6$。\n- 测试用例 $2$ (高温下近似自由的三重转子):\n  - 角度（度）：$[0,30,60,90,120,150,180,210,240,270,300,330]$。\n  - 能量（$\\mathrm{kJ/mol}$）：$[0.0,0.30,0.50,0.30,0.0,0.30,0.50,0.30,0.0,0.30,0.50,0.30]$。\n  - 对称数：$\\sigma = 3$。\n  - 转动惯量：$I = 1.5\\times 10^{-46}\\ \\mathrm{kg \\cdot m^2}$。\n  - 温度：$T = 600.0\\ \\mathrm{K}$。\n  - 傅里叶阶数：$M = 6$。\n- 测试用例 $3$ (低温下的高二重势垒):\n  - 角度（度）：$[0,30,60,90,120,150,180,210,240,270,300,330]$。\n  - 能量（$\\mathrm{kJ/mol}$）：$[0.0,5.0,15.0,20.0,15.0,5.0,0.0,5.0,15.0,20.0,15.0,5.0]$。\n  - 对称数：$\\sigma = 1$。\n  - 转动惯量：$I = 3.0\\times 10^{-47}\\ \\mathrm{kg \\cdot m^2}$。\n  - 温度：$T = 200.0\\ \\mathrm{K}$。\n  - 傅里叶阶数：$M = 4$。\n\n您的程序必须端到端地实现完整的流程，并按上述要求生成单行输出。不应读取用户输入；测试套件固定如此处所给。所有输出必须以 $\\mathrm{kJ/mol}$ 表示，四舍五入到六位小数，并按 $[\\Delta G^\\circ_1,\\Delta G^\\circ_2,\\Delta G^\\circ_3]$ 的顺序排列。", "solution": "问题陈述已经过严格评估，并被确定为有效。它在科学上基于统计力学和量子化学的原理，问题提出得很好，并提供了推导唯一且有意义的解所需的所有必要信息。所规定的方法论——拟合势能、通过谐振子和受阻转子模型从第一性原理推导热力学性质——是计算化学中的一个标准且可靠的程序。我们开始求解。\n\n目标是计算热化学校正 $\\Delta G^\\circ(T) = G^\\circ_{\\mathrm{HR}}(T) - G^\\circ_{\\mathrm{HO}}(T)$，其中 $G^\\circ_{\\mathrm{HR}}(T)$ 是来自半经典受阻转子模型的吉布斯自由能，$G^\\circ_{\\mathrm{HO}}(T)$ 是来自量子谐振子模型的吉布斯自由能。这需要多步推导和计算。\n\n**1. 势能面拟合**\n\n以 $(\\phi_i, E_i)$ 对形式给出的离散势能数据，必须首先用一个连续函数 $V(\\phi)$ 来表示。问题指定了一个 $M$ 阶的截断傅里叶级数：\n$$ V_{fit}(\\phi) = c_0 + \\sum_{n=1}^{M} \\left[ a_n \\cos(n\\phi) + b_n \\sin(n\\phi) \\right] $$\n这是一个线性模型，其中系数 $\\{c_0, a_n, b_n\\}_{n=1}^M$ 是未知的。我们通过最小化残差平方和 $S = \\sum_{i=1}^{N} [V_{fit}(\\phi_i) - E_i]^2$ 来确定它们，其中 $N$ 是数据点的数量。这是一个线性最小二乘问题。我们构建一个大小为 $N \\times (2M+1)$ 的设计矩阵 $\\mathbf{X}$ 和一个观测能量向量 $\\mathbf{E}$。对于角度为 $\\phi_i$ 的第 $i$ 个数据点，设计矩阵的元素是：\n$$ X_{i,0} = 1 $$\n$$ X_{i, 2n-1} = \\cos(n\\phi_i), \\quad n=1, ..., M $$\n$$ X_{i, 2n} = \\sin(n\\phi_i), \\quad n=1, ..., M $$\n系数向量 $\\mathbf{c} = [c_0, a_1, b_1, \\ldots, a_M, b_M]^T$ 通过求解正规方程 $\\mathbf{X}^T \\mathbf{X} \\mathbf{c} = \\mathbf{X}^T \\mathbf{E}$ 得到。在计算过程中，我们将输入的角度从度转换为弧度，并使用 Avogadro 常数 $N_A$ 将输入的能量从 $\\mathrm{kJ/mol}$ 转换为焦耳/分子。\n\n在获得系数后，我们就得到了一个连续的势能函数 $V_{fit}(\\phi)$。然后，我们必须通过数值优化在区间 $[0, 2\\pi)$ 上找到它的全局最小值 $\\phi_0$。对于所有后续的热力学计算，势能被平移，使其最小值为零：$V'(\\phi) = V_{fit}(\\phi) - V_{fit}(\\phi_0)$。\n\n**2. 谐振子 (HO) 模型**\n\nHO 模型用一个二次函数来近似最小值 $\\phi_0$ 附近的势能，该函数是 $V'(\\phi)$ 在 $\\phi_0$ 附近的二阶泰勒展开：\n$$ V_{HO}(\\phi) \\approx \\frac{1}{2} k_{tor} (\\phi - \\phi_0)^2 $$\n这里，$k_{tor}$ 是扭转力常数，由势能在最小值处的二阶导数给出：\n$$ k_{tor} = \\frac{d^2 V'}{d\\phi^2}\\bigg|_{\\phi=\\phi_0} = \\frac{d^2 V_{fit}}{d\\phi^2}\\bigg|_{\\phi=\\phi_0} $$\n拟合势能的二阶导数是：\n$$ \\frac{d^2 V_{fit}}{d\\phi^2} = -\\sum_{n=1}^{M} n^2 \\left[ a_n \\cos(n\\phi) + b_n \\sin(n\\phi) \\right] $$\n在恢复力矩 $\\tau = -k_{tor}(\\phi - \\phi_0)$ 作用下，转动惯量为 $I$ 的转子的经典运动方程是 $I \\ddot{\\phi} = -k_{tor}(\\phi - \\phi_0)$。这是一个角频率为 $\\omega$ 的简谐振子方程：\n$$ \\omega = \\sqrt{\\frac{k_{tor}}{I}} = \\sqrt{\\frac{1}{I} \\frac{d^2 V_{fit}}{d\\phi^2}\\bigg|_{\\phi=\\phi_0}} $$\n在此计算中，势能及其导数必须使用国际单位制（焦耳）。\n量子谐振子的能级是量子化的：\n$$ E_n = \\left(n + \\frac{1}{2}\\right) \\hbar \\omega, \\quad n = 0, 1, 2, \\ldots $$\n其中 $\\hbar$ 是约化 Planck 常数。分子配分函数 $q_{\\mathrm{HO}}$ 是对所有状态的求和：\n$$ q_{\\mathrm{HO}} = \\sum_{n=0}^{\\infty} e^{-\\beta E_n} = \\sum_{n=0}^{\\infty} e^{-\\beta (n + 1/2) \\hbar \\omega} = e^{-\\beta \\hbar \\omega / 2} \\sum_{n=0}^{\\infty} (e^{-\\beta \\hbar \\omega})^n $$\n其中 $\\beta = 1/(k_B T)$，$k_B$ 是 Boltzmann 常数，$T$ 是温度。这个几何级数求和为 $1/(1 - e^{-\\beta \\hbar \\omega})$，所以：\n$$ q_{\\mathrm{HO}} = \\frac{e^{-\\beta \\hbar \\omega / 2}}{1 - e^{-\\beta \\hbar \\omega}} $$\n此配分函数是相对于势阱的最小值计算的。该模式对摩尔吉布斯自由能的贡献由 $G^\\circ = -RT \\ln q = -N_A k_B T \\ln q$ 给出。\n$$ G^\\circ_{\\mathrm{HO}}(T) = -N_A k_B T \\ln\\left(\\frac{e^{-\\beta \\hbar \\omega / 2}}{1 - e^{-\\beta \\hbar \\omega}}\\right) = N_A k_B T \\left(\\frac{\\beta \\hbar \\omega}{2} + \\ln(1 - e^{-\\beta \\hbar \\omega}) \\right) $$\n一个更清晰的形式是：\n$$ G^\\circ_{\\mathrm{HO}}(T) = N_A \\left( \\frac{1}{2}\\hbar\\omega + k_B T \\ln(1 - e^{-\\beta\\hbar\\omega}) \\right) $$\n\n**3. 受阻转子 (HR) 模型**\n\n问题指定了一维受阻转子的经典极限。配分函数由相空间积分推导得出。对于哈密顿量为 $H(p_\\phi, \\phi) = p_\\phi^2/(2I) + V'(\\phi)$ 的系统，其中 $p_\\phi$ 是角动量，配分函数为：\n$$ q_{\\mathrm{HR}} = \\frac{1}{\\sigma h} \\int_{-\\infty}^{\\infty} dp_\\phi \\int_{0}^{2\\pi} d\\phi \\, \\exp\\left[-\\beta H(p_\\phi, \\phi)\\right] $$\n这里，$h$ 是 Planck 常数，$\\sigma$ 是对称数。动量和角度的积分是可分离的：\n$$ q_{\\mathrm{HR}} = \\frac{1}{\\sigma h} \\left( \\int_{-\\infty}^{\\infty} e^{-\\beta p_\\phi^2 / (2I)} dp_\\phi \\right) \\left( \\int_{0}^{2\\pi} e^{-\\beta V'(\\phi)} d\\phi \\right) $$\n动量积分是一个高斯积分，$\\int_{-\\infty}^{\\infty} e^{-ax^2}dx = \\sqrt{\\pi/a}$，其中 $a = \\beta/(2I)$。\n$$ \\int_{-\\infty}^{\\infty} e^{-\\beta p_\\phi^2 / (2I)} dp_\\phi = \\sqrt{\\frac{2\\pi I}{\\beta}} = \\sqrt{2\\pi I k_B T} $$\n将其代回，我们得到受阻转子的配分函数：\n$$ q_{\\mathrm{HR}} = \\frac{\\sqrt{2\\pi I k_B T}}{\\sigma h} \\int_{0}^{2\\pi} e^{-\\beta V'(\\phi)} d\\phi $$\n剩余的位形积分必须使用拟合且平移过的势能 $V'(\\phi)$ 进行数值计算。对摩尔吉布斯自由能的贡献为：\n$$ G^\\circ_{\\mathrm{HR}}(T) = -N_A k_B T \\ln(q_{\\mathrm{HR}}) $$\n\n**4. 热化学校正 $\\Delta G^\\circ(T)$**\n\n最终所需的量是两个模型之间的差值：\n$$ \\Delta G^\\circ(T) = G^\\circ_{\\mathrm{HR}}(T) - G^\\circ_{\\mathrm{HO}}(T) = -N_A k_B T \\ln(q_{\\mathrm{HR}}) - [-N_A k_B T \\ln(q_{\\mathrm{HO}})] $$\n$$ \\Delta G^\\circ(T) = -N_A k_B T \\ln\\left(\\frac{q_{\\mathrm{HR}}}{q_{\\mathrm{HO}}}\\right) $$\n代入配分函数的表达式：\n$$ \\Delta G^\\circ(T) = -N_A k_B T \\ln\\left[ \\frac{\\sqrt{2\\pi I k_B T}}{\\sigma h} \\left( \\frac{1 - e^{-\\beta \\hbar \\omega}}{e^{-\\beta \\hbar \\omega / 2}} \\right) \\int_{0}^{2\\pi} e^{-\\beta V'(\\phi)} d\\phi \\right] $$\n这个表达式将为每个测试用例进行计算。所有中间计算都在国际单位制（J, kg, m, s, K, mol）下执行，最终结果 $\\Delta G^\\circ(T)$ 从 $\\mathrm{J/mol}$ 转换为 $\\mathrm{kJ/mol}$。\n\n计算实现将遵循这些推导步骤：数据转换、最小二乘拟合、数值最小化、导数求值、数值积分以及最终的热力学量组合。", "answer": "[-2.956165,-2.721455,-0.607420]", "id": "2936576"}]}