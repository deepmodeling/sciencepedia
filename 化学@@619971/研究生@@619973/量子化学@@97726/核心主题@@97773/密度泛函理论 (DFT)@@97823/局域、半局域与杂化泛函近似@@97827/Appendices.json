{"hands_on_practices": [{"introduction": "广义梯度近似 (GGA) 通过引入约化密度梯度 $s$ 来改进局部密度近似 (LDA)。这个练习将让你亲手为最简单的体系——氢原子——推导 $s$ 的解析表达式。通过分析 $s$ 在不同区域的行为，你将能深刻理解 GGA 所依赖的“缓变密度”假设为何会失效，并揭示其固有的局限性。[@problem_id:2903617]", "problem": "考虑真空中的非相对论基态氢原子。其精确的科恩-沈（Kohn–Sham, KS）单电子轨道等于实的类氢 $1s$ 轨道。设空间坐标为 $\\mathbf{r}$，其中 $r = |\\mathbf{r}|$，并设玻尔半径为 $a_{0}$。归一化的 $1s$ 轨道为 $\\psi_{1s}(\\mathbf{r}) = \\frac{1}{\\sqrt{\\pi}\\,a_{0}^{3/2}} \\exp\\!\\left(-\\frac{r}{a_{0}}\\right)$。相应的电子密度为 $\\rho(\\mathbf{r}) = |\\psi_{1s}(\\mathbf{r})|^{2}$。广义梯度近似（generalized gradient approximations, GGA）中使用的约化密度梯度定义为\n\n$$\ns(\\mathbf{r}) \\equiv \\frac{|\\nabla \\rho(\\mathbf{r})|}{2\\,k_{F}(\\mathbf{r})\\,\\rho(\\mathbf{r})}, \\quad\\text{其中}\\quad k_{F}(\\mathbf{r}) \\equiv \\big(3\\pi^{2}\\rho(\\mathbf{r})\\big)^{1/3}.\n$$\n\n仅使用这些定义和球坐标系下的标准矢量微积分，推导氢 $1s$ 密度下的 $s(r)$ 的显式解析表达式。然后，仅根据作为梯度展开基础的小 $s$ 判据，论证对于此单电子密度，半局域广义梯度近似在整个空间中是否应接近于局域密度近似（local density approximation, LDA）。在你的论证中，请明确说明你所考虑的任何极限情况。你最终报告的答案必须是 $s(r)$ 的显式封闭形式表达式。最终答案中请勿包含单位，也勿提供任何评论。", "solution": "所述问题具有科学依据，提法恰当，客观，并包含了完整推导和合理论证所需的所有必要信息。因此，该问题被认定为有效。我们开始求解。\n\n该问题要求推导基态氢原子的约化密度梯度 $s(r)$，并分析其行为，以评估广义梯度近似（GGA）相对于局域密度近似（LDA）的适用性。\n\n首先，我们根据给定的 $1s$ 轨道 $\\psi_{1s}(\\mathbf{r})$ 确定电子密度 $\\rho(\\mathbf{r})$。给定的轨道为：\n$$\n\\psi_{1s}(\\mathbf{r}) = \\frac{1}{\\sqrt{\\pi}\\,a_{0}^{3/2}} \\exp\\left(-\\frac{r}{a_{0}}\\right)\n$$\n其中 $r = |\\mathbf{r}|$ 且 $a_0$ 是玻尔半径。由于该轨道是实值函数，电子密度 $\\rho(\\mathbf{r}) = |\\psi_{1s}(\\mathbf{r})|^{2}$ 可简化为 $\\rho(\\mathbf{r}) = \\psi_{1s}(\\mathbf{r})^{2}$。该密度是球对称的，因此我们将其表示为 $\\rho(r)$：\n$$\n\\rho(r) = \\left( \\frac{1}{\\sqrt{\\pi}\\,a_{0}^{3/2}} \\exp\\left(-\\frac{r}{a_{0}}\\right) \\right)^{2} = \\frac{1}{\\pi a_{0}^{3}} \\exp\\left(-\\frac{2r}{a_{0}}\\right)\n$$\n\n接下来，我们计算密度的梯度 $\\nabla \\rho(r)$。在球坐标系中，对于一个只依赖于径向坐标 $r$ 的函数，其梯度简化为 $\\nabla\\rho(r) = \\frac{d\\rho}{dr}\\hat{\\mathbf{r}}$，其中 $\\hat{\\mathbf{r}}$ 是径向单位矢量。我们计算 $\\rho(r)$ 对 $r$ 的导数：\n$$\n\\frac{d\\rho}{dr} = \\frac{d}{dr} \\left[ \\frac{1}{\\pi a_{0}^{3}} \\exp\\left(-\\frac{2r}{a_{0}}\\right) \\right] = \\frac{1}{\\pi a_{0}^{3}} \\left(-\\frac{2}{a_{0}}\\right) \\exp\\left(-\\frac{2r}{a_{0}}\\right) = -\\frac{2}{a_{0}} \\rho(r)\n$$\n因此，梯度为 $\\nabla \\rho(r) = -\\frac{2}{a_{0}}\\rho(r)\\hat{\\mathbf{r}}$。\n\n$s(r)$ 的分子需要梯度的模 $|\\nabla \\rho(r)|$。由于 $\\rho(r)$ 始终为正且 $|\\hat{\\mathbf{r}}|=1$：\n$$\n|\\nabla \\rho(r)| = \\left| -\\frac{2}{a_{0}}\\rho(r)\\hat{\\mathbf{r}} \\right| = \\frac{2}{a_{0}}\\rho(r)\n$$\n\n现在，我们确定局域 Thomas-Fermi 波矢 $k_{F}(r)$，其定义为 $k_{F}(r) = (3\\pi^{2}\\rho(r))^{1/3}$。代入 $\\rho(r)$ 的表达式：\n$$\nk_{F}(r) = \\left[ 3\\pi^{2} \\left( \\frac{1}{\\pi a_{0}^{3}} \\exp\\left(-\\frac{2r}{a_{0}}\\right) \\right) \\right]^{1/3} = \\left[ \\frac{3\\pi}{a_{0}^{3}} \\exp\\left(-\\frac{2r}{a_{0}}\\right) \\right]^{1/3} = \\frac{(3\\pi)^{1/3}}{a_{0}} \\exp\\left(-\\frac{2r}{3a_{0}}\\right)\n$$\n\n最后，我们使用其定义来组合出约化密度梯度 $s(r)$：\n$$\ns(r) = \\frac{|\\nabla \\rho(r)|}{2\\,k_{F}(r)\\,\\rho(r)}\n$$\n代入 $|\\nabla \\rho(r)|$ 和 $k_{F}(r)$ 的表达式：\n$$\ns(r) = \\frac{\\frac{2}{a_{0}}\\rho(r)}{2 \\left[ \\frac{(3\\pi)^{1/3}}{a_{0}} \\exp\\left(-\\frac{2r}{3a_{0}}\\right) \\right] \\rho(r)}\n$$\n项 $2$、$\\rho(r)$ 和 $a_{0}$ 消去，剩下：\n$$\ns(r) = \\frac{1}{(3\\pi)^{1/3} \\exp\\left(-\\frac{2r}{3a_{0}}\\right)} = \\frac{1}{(3\\pi)^{1/3}} \\exp\\left(\\frac{2r}{3a_{0}}\\right)\n$$\n这就是氢 $1s$ 密度的 $s(r)$ 的显式解析表达式。\n\n对于问题的第二部分，我们必须论证对于该体系，GGA 泛函是否应接近于 LDA。在交换相关泛函中包含密度梯度的理论基础是梯度展开，它是关于密度梯度的泰勒级数。这种展开仅在密度是“缓变”的情况下有效。约化密度梯度 $s(\\mathbf{r})$ 是量化这种变化的无量纲参数。缓变密度的条件，也就是梯度展开有效性的条件，是 $s(\\mathbf{r}) \\ll 1$。在满足此条件的区域，GGA 预期是对 LDA 的一个小的修正，它们的结果应该相似。\n\n我们现在分析所推导的氢原子的 $s(r)$ 在整个空间中的行为。其表达式为 $s(r) = (3\\pi)^{-1/3} \\exp(2r/(3a_0))$。\n我们考虑两个重要的极限情况：\n$1$. 在原子核附近，当 $r \\to 0$ 时：\n$$\n\\lim_{r\\to 0} s(r) = \\frac{1}{(3\\pi)^{1/3}} \\exp(0) = \\frac{1}{(3\\pi)^{1/3}} \\approx 0.473\n$$\n这个值是一个数量级为 1 的常数；它并不远小于 $1$。\n$2$. 在尾部区域，远离原子核，当 $r \\to \\infty$ 时：\n$$\n\\lim_{r\\to \\infty} s(r) = \\frac{1}{(3\\pi)^{1/3}} \\lim_{r\\to \\infty} \\exp\\left(\\frac{2r}{3a_{0}}\\right) = \\infty\n$$\n在密度衰减的区域，$s(r)$ 的值呈指数增长并发散。\n\n对于氢原子，“小 $s$” 判据 $s(r) \\ll 1$ 在空间的任何地方都不满足。 $s(r)$ 在原子核处的值最小为 $\\approx 0.473$，并随着 $r$ 的增大而无界增长。因此，就梯度展开要求精确性而言，氢原子的密度并非缓变的。因此，不应期望半局域 GGA 会接近于 LDA。与 $s \\ll 1$ 条件的显著偏离，特别是尾部的发散，表明这个单电子体系对于任何基于小梯度假设的泛函来说都是一个具有挑战性的案例。这是自相互作用问题的一种表现，该问题在 LDA 和标准 GGA 中对于单电子密度尤为严重。", "answer": "$$\n\\boxed{\\frac{1}{(3\\pi)^{1/3}} \\exp\\left(\\frac{2r}{3a_{0}}\\right)}\n$$", "id": "2903617"}, {"introduction": "Meta-GGA 泛函位于“雅各布天梯”的第三级，它们通过引入动能密度来提供额外信息。本练习将探索一个关键的 meta-GGA 成分——非均匀性指标 $\\alpha$，并计算其在单轨道区域和均匀电子气这两个物理极限下的值。这个过程将展示 meta-GGA 泛函如何通过区分不同的电子环境来系统性地提升其性能。[@problem_id:2903593]", "problem": "考虑 Kohn–Sham 密度泛函理论 (KS-DFT) 中的元广义梯度近似 (meta-GGA)，它使用由下式定义的非均匀性指标\n$$\\alpha(\\mathbf{r})=\\frac{\\tau(\\mathbf{r})-\\tau_{W}(\\mathbf{r})}{\\tau_{\\mathrm{UEG}}(\\mathbf{r})}.$$\n此处，$\\tau(\\mathbf{r})$ 是正定的 Kohn–Sham 动能密度\n$$\\tau(\\mathbf{r})=\\frac{1}{2}\\sum_{i}^{\\mathrm{occ}}|\\nabla \\psi_{i}(\\mathbf{r})|^{2},$$\n$\\tau_{W}(\\mathbf{r})$ 是 von Weizsäcker 动能密度\n$$\\tau_{W}(\\mathbf{r})=\\frac{|\\nabla n(\\mathbf{r})|^{2}}{8\\,n(\\mathbf{r})},$$\n而 $\\tau_{\\mathrm{UEG}}(\\mathbf{r})$ 是在局域密度 $n(\\mathbf{r})$ 下的均匀电子气 (UEG) 的动能密度\n$$\\tau_{\\mathrm{UEG}}(\\mathbf{r})=\\frac{3}{10}\\left(3\\pi^{2}\\right)^{2/3}\\left[n(\\mathbf{r})\\right]^{5/3}.$$\n所有表达式均采用 Hartree 原子单位。\n\n(a) 对于基态氢原子，取实的 Kohn–Sham 轨道为精确的 $1s$ 轨道\n$$\\psi_{1s}(\\mathbf{r})=\\frac{1}{\\sqrt{\\pi}}\\,\\exp(-r),$$\n使得电子密度为 $n(\\mathbf{r})=|\\psi_{1s}(\\mathbf{r})|^{2}=\\pi^{-1}\\exp(-2r)$。计算 $\\alpha(\\mathbf{r})$。\n\n(b) 对于密度恒为 $n(\\mathbf{r})=n_{0}$ 的均匀电子气，计算 $\\alpha(\\mathbf{r})$。\n\n然后，基于这些极限，定性地解释：为了恢复适当的精确约束，在固定的约化梯度 $s$ 下，元广义梯度近似 (meta-GGA) 的交换增强因子 $F_{x}(s,\\alpha)$ 应如何作为 $\\alpha$ 的函数，在单轨道极限与类金属的均匀极限中进行调控。\n\n请将 (a) 和 (b) 两部分的 $\\alpha$ 值按 $\\big(\\alpha_{\\text{H-1s}}(\\mathbf{r}),\\,\\alpha_{\\text{UEG}}\\big)$ 的顺序写成一个行向量作为最终答案。无需进行数值四舍五入，最终的方框答案中不应包含物理单位。", "solution": "所给出的问题是 Kohn-Sham 密度泛函理论形式体系中的一个标准练习，具体涉及元广义梯度近似 (meta-GGA) 泛函的构造。该问题提法恰当，有科学依据，并包含了求解所需的所有信息。我将开始解答。\n\n该问题要求计算非均匀性指标 $\\alpha(\\mathbf{r})$ 在两种极限情况下的值，并随后定性讨论其在泛函设计中的作用。所提供的定义为\n$$ \\alpha(\\mathbf{r})=\\frac{\\tau(\\mathbf{r})-\\tau_{W}(\\mathbf{r})}{\\tau_{\\mathrm{UEG}}(\\mathbf{r})} $$\n其中 $\\tau(\\mathbf{r})$ 是 Kohn-Sham 动能密度，$\\tau_{W}(\\mathbf{r})$ 是 von Weizsäcker 动能密度，而 $\\tau_{\\mathrm{UEG}}(\\mathbf{r})$ 是在相同局域密度 $n(\\mathbf{r})$ 下的均匀电子气 (UEG) 的动能密度。\n\n(a) 基态氢原子的情况。\n对于任何由单个实 Kohn-Sham 空间轨道 $\\psi(\\mathbf{r})$ 描述的体系（被一个或两个电子占据，形成一个单重态对），电子密度由 $n(\\mathbf{r}) = N |\\psi(\\mathbf{r})|^2$ 给出，其中 $N$ 是占据数（1 或 2）。对于氢原子，$N=1$，密度为 $n(\\mathbf{r}) = |\\psi_{1s}(\\mathbf{r})|^2$。\n\n对于这种单轨道情况，Kohn-Sham 动能密度为\n$$ \\tau(\\mathbf{r}) = \\frac{1}{2} |\\nabla \\psi_{1s}(\\mathbf{r})|^2 $$\nvon Weizsäcker 动能密度定义为\n$$ \\tau_{W}(\\mathbf{r}) = \\frac{|\\nabla n(\\mathbf{r})|^2}{8n(\\mathbf{r})} $$\n让我们为这种普遍的单轨道情况建立 $\\tau(\\mathbf{r})$ 和 $\\tau_{W}(\\mathbf{r})$ 之间的关系。密度的梯度是\n$$ \\nabla n(\\mathbf{r}) = \\nabla |\\psi_{1s}(\\mathbf{r})|^2 = \\nabla (\\psi_{1s}(\\mathbf{r}) \\cdot \\psi_{1s}(\\mathbf{r})) = 2 \\psi_{1s}(\\mathbf{r}) \\nabla \\psi_{1s}(\\mathbf{r}) $$\n因为轨道 $\\psi_{1s}$ 是实的。该梯度的模的平方是\n$$ |\\nabla n(\\mathbf{r})|^2 = 4 |\\psi_{1s}(\\mathbf{r})|^2 |\\nabla \\psi_{1s}(\\mathbf{r})|^2 = 4 n(\\mathbf{r}) |\\nabla \\psi_{1s}(\\mathbf{r})|^2 $$\n将此代入 $\\tau_{W}(\\mathbf{r})$ 的表达式中可得\n$$ \\tau_{W}(\\mathbf{r}) = \\frac{4 n(\\mathbf{r}) |\\nabla \\psi_{1s}(\\mathbf{r})|^2}{8 n(\\mathbf{r})} = \\frac{1}{2} |\\nabla \\psi_{1s}(\\mathbf{r})|^2 $$\n这与 Kohn-Sham 动能密度 $\\tau(\\mathbf{r})$ 的表达式相同。因此，对于由单个实轨道描述的任何空间区域，$\\tau(\\mathbf{r}) = \\tau_{W}(\\mathbf{r})$ 是一个数学恒等式。\n\n这可以用给定的轨道 $\\psi_{1s}(\\mathbf{r})=\\frac{1}{\\sqrt{\\pi}}\\,\\exp(-r)$ 进行显式验证。\n密度为 $n(r) = \\pi^{-1}\\exp(-2r)$。梯度为 $\\nabla n(r) = \\frac{dn}{dr}\\hat{\\mathbf{r}} = -2\\pi^{-1}\\exp(-2r)\\hat{\\mathbf{r}} = -2n(r)\\hat{\\mathbf{r}}$。\n因此， $|\\nabla n(r)|^2 = 4n(r)^2$。\n所以， $\\tau_{W}(r) = \\frac{4n(r)^2}{8n(r)} = \\frac{1}{2}n(r)$。\n对于 Kohn-Sham 动能密度，$\\nabla \\psi_{1s}(r) = \\frac{d\\psi_{1s}}{dr}\\hat{\\mathbf{r}} = -\\frac{1}{\\sqrt{\\pi}}\\exp(-r)\\hat{\\mathbf{r}} = -\\psi_{1s}(r)\\hat{\\mathbf{r}}$。\n那么， $|\\nabla \\psi_{1s}(r)|^2 = \\psi_{1s}(r)^2 = n(r)$。\n所以， $\\tau(r) = \\frac{1}{2}|\\nabla \\psi_{1s}(r)|^2 = \\frac{1}{2}n(r)$。\n显式计算证实了 $\\tau(r) = \\tau_W(r)$。\n\n$\\alpha(\\mathbf{r})$ 表达式的分子是 $\\tau(\\mathbf{r}) - \\tau_{W}(\\mathbf{r}) = 0$。\n对于任何具有非零密度的区域，分母 $\\tau_{\\mathrm{UEG}}(\\mathbf{r})$ 都不为零。因此，对于氢原子，非均匀性指标是\n$$ \\alpha_{\\text{H-1s}}(\\mathbf{r}) = 0 $$\n这个结果对所有 $n(\\mathbf{r}) \\neq 0$ 的点 $\\mathbf{r}$ 都成立。\n\n(b) 均匀电子气 (UEG) 的情况。\n对于均匀电子气，电子密度是恒定的，即 $n(\\mathbf{r}) = n_0$。\n密度的梯度为 $\\nabla n(\\mathbf{r}) = \\nabla n_0 = 0$。\n将此代入 von Weizsäcker 动能密度的定义中可得\n$$ \\tau_{W}(\\mathbf{r}) = \\frac{|\\nabla n_0|^2}{8n_0} = \\frac{0}{8n_0} = 0 $$\n对于一个 UEG（其轨道是平面波），其 Kohn-Sham 动能密度恰好是模型量 $\\tau_{\\mathrm{UEG}}(\\mathbf{r})$ 所要表示的。在体积 $V$ 中的 $N$ 个电子的总动能是 $T = N \\frac{3}{5} E_F$，其中 $E_F$ 是费米能。在原子单位中，这导出的动能密度为 $\\tau = T/V = \\frac{3}{10}(3\\pi^2)^{2/3}n_0^{5/3}$。\n因此，根据 UEG 体系和相应模型密度的定义，\n$$ \\tau(\\mathbf{r}) = \\tau_{\\mathrm{UEG}}(\\mathbf{r}) = \\frac{3}{10}\\left(3\\pi^{2}\\right)^{2/3}n_0^{5/3} $$\n现在我们计算 UEG 的 $\\alpha(\\mathbf{r})$：\n$$ \\alpha_{\\text{UEG}} = \\frac{\\tau(\\mathbf{r}) - \\tau_{W}(\\mathbf{r})}{\\tau_{\\mathrm{UEG}}(\\mathbf{r})} = \\frac{\\tau_{\\mathrm{UEG}}(\\mathbf{r}) - 0}{\\tau_{\\mathrm{UEG}}(\\mathbf{r})} = 1 $$\n这对任何 $n_0 > 0$ 都有效。\n\n对 meta-GGA 泛函设计的定性解释。\n上述计算表明，同轨道指标 $\\alpha$ 用于区分两种根本不同的物理情景。\n1.  $\\alpha = 0$：此极限对应于单轨道区域，例如氢原子、任何有限体系电子密度的尾部区域或某些共价键。在这些区域，交换相关泛函必须满足无自相互作用误差（SIE）的约束。对于单电子体系，精确交换能 $E_x$ 必须完全抵消人为的 Hartree 自排斥能 $E_H$。\n2.  $\\alpha = 1$：此极限对应于均匀电子气，这是简单金属内部的特征，并作为构建局域和半局域密度泛函的基准。在此极限下，约化密度梯度 $s=|\\nabla n|/[2(3\\pi^2)^{1/3}n^{4/3}]=0$，交换增强因子 $F_x(s=0, \\alpha=1)$ 必须等于 1，以恢复 UEG 的精确 Dirac 交换能。\n\n仅依赖于 $n$ 和 $s$ 的标准 GGA 泛函无法区分这两个极限。它们的设计目的是通过引入梯度修正来改进局域密度近似，其增强因子 $F_x(s)$ 通常是 $s$ 的单调函数。这对于 $\\alpha \\approx 1$ 的情景效果尚可，但对于 $\\alpha = 0$ 的情景则会灾难性地失败，导致显著的自相互作用误差。较大的 $s$ 值既可能出现在快速变化的多电子体系中，也可能出现在单轨道的尾部区域；GGA 无法区分这两种情况。\n\n而 meta-GGA 泛函通过 $\\alpha$ 依赖于 $\\tau$，可以解决这种模糊性。增强因子 $F_x(s, \\alpha)$ 被设计用来根据 $\\alpha$ 的值调节其行为。为满足精确约束：\n-   在 $\\alpha \\approx 1$ (类金属) 的区域，$F_x(s, \\alpha)$ 的行为应像一个高级的 GGA，为缓变到中等变化的电子气中的交换作用提供精确的描述。\n-   在 $\\alpha \\to 0$ (单轨道) 的区域，$F_x(s, \\alpha)$ 必须被抑制。在固定的非零 $s$ 值下，当 $\\alpha$ 从 1 变到 0 时，$F_x$ 的值必须减小。这种抑制对于消除或至少大大减少自相互作用误差至关重要。像 SCAN (Strongly Constrained and Appropriately Normed) 这样的泛函明确使用一个依赖于 $\\alpha$ 的切换函数在这两种行为之间进行插值，从而对所有单电子密度强制施加无自相互作用的约束。\n\n总之，$\\alpha$ 的作用是告知泛函关于局域电子结构的信息，使 $F_x(s, \\alpha)$ 能够调整其形式，以在物理上适用于多电子离域环境或单轨道局域环境。", "answer": "$$\n\\boxed{\\begin{pmatrix} 0 & 1 \\end{pmatrix}}\n$$", "id": "2903593"}, {"introduction": "杂化泛函通过混合一部分精确交换来修正半局域泛函中的自相互作用误差，但精确交换的混合比例 $a$ 涉及关键的权衡。本计算练习使用一个简化的线性模型来量化参数 $a$ 的变化如何同时影响热化学（原子化能）和反应动力学（反应能垒）的准确性。这个实践将揭示泛函设计中的一个核心困境，并解释为何存在不同混合比例的杂化泛函。[@problem_id:2903641]", "problem": "考虑密度泛函理论（Kohn–Sham DFT）的 Kohn–Sham 公式，其中对于一个密度为 $\\rho(\\mathbf{r})$ 的电子系统，其基态总能量由无相互作用动能、经典电子-电子排斥能、外势能以及交换相关能的总和给出。在广义杂化泛函近似中，交换相关能被建模为精确 Hartree–Fock 交换与一个半局域交换和一个半局域相关的凸组合，该组合由一个分数参数 $a \\in [0,1]$ 控制。在冻结密度近似下（忽略密度相对于 $a$ 的弛豫），物种 $S$ 的总能量可以写为\n$$\nE_{\\mathrm{tot}}(S;a) \\approx E_{\\mathrm{sl}}(S) + a \\,\\Delta_x(S),\n$$\n其中 $E_{\\mathrm{sl}}(S)$ 是在参考半局域泛函（具有半局域交换相关）下的总能量，$\\Delta_x(S) = E_x^{\\mathrm{HF}}(S) - E_x^{\\mathrm{sl}}(S)$ 是精确 Hartree–Fock 交换与半局域交换之间的差值，两者均在参考密度下进行评估。这个线性模型被广泛用于概念性分析，以研究在改变 $a$ 时，热化学准确度与能垒高度之间的权衡关系。\n\n您的任务是实现这个模型，用以计算在一个小型测试集上的原子化能和一个原型能垒高度，并将它们表示为精确交换分数 $a$ 的函数。然后，通过与提供的高水平参考值进行比较，量化这种权衡关系。所有能量都必须以 hartree 为单位表示。\n\n定义：\n- 一个由组分原子 $\\{A_i\\}$ 构成的分子 $M$ 的原子化能为\n$$\nD_e(M;a) = \\sum_i E_{\\mathrm{tot}}(A_i;a) - E_{\\mathrm{tot}}(M;a).\n$$\n- 氢交换反应 $ \\mathrm{H} + \\mathrm{H}_2 \\rightleftharpoons \\mathrm{H}_3^{\\ddagger} \\to \\mathrm{H} + \\mathrm{H}_2$ 的能垒高度建模为\n$$\nB(a) = E_{\\mathrm{tot}}(\\mathrm{H}_3^{\\ddagger};a) - \\left[E_{\\mathrm{tot}}(\\mathrm{H};a) + E_{\\mathrm{tot}}(\\mathrm{H}_2;a)\\right].\n$$\n- 对于一组分子 $\\{M_j\\}_{j=1}^N$（其参考值为 $\\{D_e^{\\mathrm{ref}}(M_j)\\}$），原子化能的平均绝对误差为\n$$\n\\mathrm{MAE}(a) = \\frac{1}{N}\\sum_{j=1}^N \\left| D_e(M_j;a) - D_e^{\\mathrm{ref}}(M_j) \\right|.\n$$\n\n使用以下物种及其 $E_{\\mathrm{sl}}(S)$ 和 $\\Delta_x(S)$ 值的数据集（单位为 hartree）：\n- 原子：\n  - $\\mathrm{H}$：$E_{\\mathrm{sl}}(\\mathrm{H}) = -0.500$，$\\Delta_x(\\mathrm{H}) = -0.025$。\n  - $\\mathrm{C}$：$E_{\\mathrm{sl}}(\\mathrm{C}) = -37.600$，$\\Delta_x(\\mathrm{C}) = -0.500$。\n  - $\\mathrm{O}$：$E_{\\mathrm{sl}}(\\mathrm{O}) = -74.800$，$\\Delta_x(\\mathrm{O}) = -0.650$。\n- 分子：\n  - $\\mathrm{H}_2$：$E_{\\mathrm{sl}}(\\mathrm{H}_2) = -1.174$，$\\Delta_x(\\mathrm{H}_2) = -0.030$。\n  - $\\mathrm{CH}_4$：$E_{\\mathrm{sl}}(\\mathrm{CH}_4) = -40.235$，$\\Delta_x(\\mathrm{CH}_4) = -0.400$。\n  - $\\mathrm{H}_2\\mathrm{O}$：$E_{\\mathrm{sl}}(\\mathrm{H}_2\\mathrm{O}) = -76.180$，$\\Delta_x(\\mathrm{H}_2\\mathrm{O}) = -0.500$。\n- 过渡态：\n  - $\\mathrm{H}_3^{\\ddagger}$：$E_{\\mathrm{sl}}(\\mathrm{H}_3^{\\ddagger}) = -1.664$，$\\Delta_x(\\mathrm{H}_3^{\\ddagger}) = -0.020$。\n\n使用以下参考原子化能（单位为 hartree）：\n- $D_e^{\\mathrm{ref}}(\\mathrm{H}_2) = 0.1746$，\n- $D_e^{\\mathrm{ref}}(\\mathrm{CH}_4) = 0.6250$，\n- $D_e^{\\mathrm{ref}}(\\mathrm{H}_2\\mathrm{O}) = 0.3700$。\n\n使用以下参考能垒高度（单位为 hartree）：\n- $B^{\\mathrm{ref}} = 0.0150$。\n\n对于测试套件 $\\{0.0,\\,0.15,\\,0.25,\\,0.50,\\,1.00\\}$ 中的每一个 $a$ 值，计算：\n- 分子集 $\\{\\mathrm{H}_2,\\,\\mathrm{CH}_4,\\,\\mathrm{H}_2\\mathrm{O}\\}$ 的平均绝对误差 $\\mathrm{MAE}(a)$。\n- 通过 $\\mathrm{H}_3^{\\ddagger}$ 和 $\\mathrm{H} + \\mathrm{H}_2$ 建模的氢交换反应的能垒高度绝对误差 $\\left|B(a) - B^{\\mathrm{ref}}\\right|$。\n\n您的程序必须生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。结果的排列顺序如下：对于给定测试套件中的每个 $a$ 值，依次附加两个浮点数 $\\mathrm{MAE}(a)$ 和 $\\left|B(a) - B^{\\mathrm{ref}}\\right|$。所有输出都必须以 hartree 为单位，并四舍五入到 $6$ 位小数。例如，输出格式必须完全是\n$$\n[\\mathrm{MAE}(a_1),|B(a_1)-B^{\\mathrm{ref}}|,\\mathrm{MAE}(a_2),|B(a_2)-B^{\\mathrm{ref}}|,\\ldots].\n$$\n除了这个单行列表外，不应打印任何其他文本。", "solution": "该问题已经过验证，被认为是科学上合理、提法明确且客观的。它提出了一个来自量子化学的标准（尽管是简化的）模型，用于分析杂化密度泛函。所有必需的数据和定义均已提供，任务是直接应用这些原理。因此，我们可以着手进行严谨的求解。\n\n核心任务是分析一个简化的杂化泛函模型在热化学（原子化能）和动力学（反应能垒）性质方面的性能。物种 $S$ 的总能量被建模为精确交换分数 $a$ 的线性函数：\n$$\nE_{\\mathrm{tot}}(S;a) = E_{\\mathrm{sl}}(S) + a \\cdot \\Delta_x(S)\n$$\n其中 $E_{\\mathrm{sl}}(S)$ 是来自参考半局域泛函的能量，$\\Delta_x(S)$ 是交换校正项。\n\n首先，我们必须推导出原子化能和能垒高度作为 $a$ 的函数的表达式。\n\n第 1 步：原子化能模型的推导\n由原子 $\\{A_i\\}$ 组成的分子 $M$ 的原子化能 $D_e(M;a)$ 定义为组分原子与分子之间的能量差：\n$$\nD_e(M;a) = \\sum_i E_{\\mathrm{tot}}(A_i;a) - E_{\\mathrm{tot}}(M;a)\n$$\n将线性模型代入每一项：\n$$\nD_e(M;a) = \\sum_i \\left( E_{\\mathrm{sl}}(A_i) + a \\cdot \\Delta_x(A_i) \\right) - \\left( E_{\\mathrm{sl}}(M) + a \\cdot \\Delta_x(M) \\right)\n$$\n通过按 $a$ 的幂次重新排列和组合各项，我们得到了原子化能的线性模型：\n$$\nD_e(M;a) = \\left( \\sum_i E_{\\mathrm{sl}}(A_i) - E_{\\mathrm{sl}}(M) \\right) + a \\cdot \\left( \\sum_i \\Delta_x(A_i) - \\Delta_x(M) \\right)\n$$\n我们定义半局域原子化能 $D_e^{\\mathrm{sl}}(M)$ 和相应的交换校正项 $\\Delta D_x(M)$：\n$$\nD_e^{\\mathrm{sl}}(M) = \\sum_i E_{\\mathrm{sl}}(A_i) - E_{\\mathrm{sl}}(M)\n$$\n$$\n\\Delta D_x(M) = \\sum_i \\Delta_x(A_i) - \\Delta_x(M)\n$$\n模型简化为：\n$$\nD_e(M;a) = D_e^{\\mathrm{sl}}(M) + a \\cdot \\Delta D_x(M)\n$$\n\n第 2 步：能垒高度模型的推导\n反应 $\\mathrm{H} + \\mathrm{H}_2 \\to \\mathrm{H}_3^{\\ddagger}$ 的能垒高度 $B(a)$ 定义为过渡态与反应物之间的能量差：\n$$\nB(a) = E_{\\mathrm{tot}}(\\mathrm{H}_3^{\\ddagger};a) - \\left( E_{\\mathrm{tot}}(\\mathrm{H};a) + E_{\\mathrm{tot}}(\\mathrm{H}_2;a) \\right)\n$$\n代入线性模型：\n$$\nB(a) = \\left( E_{\\mathrm{sl}}(\\mathrm{H}_3^{\\ddagger}) + a \\cdot \\Delta_x(\\mathrm{H}_3^{\\ddagger}) \\right) - \\left[ \\left( E_{\\mathrm{sl}}(\\mathrm{H}) + a \\cdot \\Delta_x(\\mathrm{H}) \\right) + \\left( E_{\\mathrm{sl}}(\\mathrm{H}_2) + a \\cdot \\Delta_x(\\mathrm{H}_2) \\right) \\right]\n$$\n重新排列各项可得到能垒高度的线性模型：\n$$\nB(a) = \\left( E_{\\mathrm{sl}}(\\mathrm{H}_3^{\\ddagger}) - E_{\\mathrm{sl}}(\\mathrm{H}) - E_{\\mathrm{sl}}(\\mathrm{H}_2) \\right) + a \\cdot \\left( \\Delta_x(\\mathrm{H}_3^{\\ddagger}) - \\Delta_x(\\mathrm{H}) - \\Delta_x(\\mathrm{H}_2) \\right)\n$$\n我们定义半局域能垒高度 $B^{\\mathrm{sl}}$ 及其交换校正 $\\Delta B_x$：\n$$\nB^{\\mathrm{sl}} = E_{\\mathrm{sl}}(\\mathrm{H}_3^{\\ddagger}) - E_{\\mathrm{sl}}(\\mathrm{H}) - E_{\\mathrm{sl}}(\\mathrm{H}_2)\n$$\n$$\n\\Delta B_x = \\Delta_x(\\mathrm{H}_3^{\\ddagger}) - \\Delta_x(\\mathrm{H}) - \\Delta_x(\\mathrm{H}_2)\n$$\n能垒高度的模型变为：\n$$\nB(a) = B^{\\mathrm{sl}} + a \\cdot \\Delta B_x\n$$\n\n第 3 步：模型参数的计算\n使用所提供的数据，我们计算线性模型的参数。所有能量的单位均为 hartree。\n\n对于 $\\mathrm{H}_2$：\n$D_e^{\\mathrm{sl}}(\\mathrm{H}_2) = 2 \\cdot E_{\\mathrm{sl}}(\\mathrm{H}) - E_{\\mathrm{sl}}(\\mathrm{H}_2) = 2 \\cdot (-0.500) - (-1.174) = 0.174$\n$\\Delta D_x(\\mathrm{H}_2) = 2 \\cdot \\Delta_x(\\mathrm{H}) - \\Delta_x(\\mathrm{H}_2) = 2 \\cdot (-0.025) - (-0.030) = -0.020$\n$D_e(\\mathrm{H}_2; a) = 0.174 - 0.020 \\cdot a$\n\n对于 $\\mathrm{CH}_4$：\n$D_e^{\\mathrm{sl}}(\\mathrm{CH}_4) = E_{\\mathrm{sl}}(\\mathrm{C}) + 4 \\cdot E_{\\mathrm{sl}}(\\mathrm{H}) - E_{\\mathrm{sl}}(\\mathrm{CH}_4) = -37.600 + 4 \\cdot (-0.500) - (-40.235) = 0.635$\n$\\Delta D_x(\\mathrm{CH}_4) = \\Delta_x(\\mathrm{C}) + 4 \\cdot \\Delta_x(\\mathrm{H}) - \\Delta_x(\\mathrm{CH}_4) = -0.500 + 4 \\cdot (-0.025) - (-0.400) = -0.200$\n$D_e(\\mathrm{CH}_4; a) = 0.635 - 0.200 \\cdot a$\n\n对于 $\\mathrm{H}_2\\mathrm{O}$：\n$D_e^{\\mathrm{sl}}(\\mathrm{H}_2\\mathrm{O}) = 2 \\cdot E_{\\mathrm{sl}}(\\mathrm{H}) + E_{\\mathrm{sl}}(\\mathrm{O}) - E_{\\mathrm{sl}}(\\mathrm{H}_2\\mathrm{O}) = 2 \\cdot (-0.500) - 74.800 - (-76.180) = 0.380$\n$\\Delta D_x(\\mathrm{H}_2\\mathrm{O}) = 2 \\cdot \\Delta_x(\\mathrm{H}) + \\Delta_x(\\mathrm{O}) - \\Delta_x(\\mathrm{H}_2\\mathrm{O}) = 2 \\cdot (-0.025) - 0.650 - (-0.500) = -0.200$\n$D_e(\\mathrm{H}_2\\mathrm{O}; a) = 0.380 - 0.200 \\cdot a$\n\n对于反应能垒：\n$B^{\\mathrm{sl}} = E_{\\mathrm{sl}}(\\mathrm{H}_3^{\\ddagger}) - E_{\\mathrm{sl}}(\\mathrm{H}) - E_{\\mathrm{sl}}(\\mathrm{H}_2) = -1.664 - (-0.500) - (-1.174) = 0.010$\n$\\Delta B_x = \\Delta_x(\\mathrm{H}_3^{\\ddagger}) - \\Delta_x(\\mathrm{H}) - \\Delta_x(\\mathrm{H}_2) = -0.020 - (-0.025) - (-0.030) = 0.035$\n$B(a) = 0.010 + 0.035 \\cdot a$\n\n第 4 步：计算测试套件的误差\n我们现在为每个 $a \\in \\{0.0, 0.15, 0.25, 0.50, 1.00\\}$ 计算原子化能的平均绝对误差（$\\mathrm{MAE}(a)$）和能垒高度的绝对误差（$|B(a) - B^{\\mathrm{ref}}|$）。\n\n对于 $a=0.0$：\n$D_e(\\mathrm{H}_2; 0.0) = 0.174$，误差 = $|0.174 - 0.1746| = 0.0006$\n$D_e(\\mathrm{CH}_4; 0.0) = 0.635$，误差 = $|0.635 - 0.6250| = 0.0100$\n$D_e(\\mathrm{H}_2\\mathrm{O}; 0.0) = 0.380$，误差 = $|0.380 - 0.3700| = 0.0100$\n$\\mathrm{MAE}(0.0) = (0.0006 + 0.0100 + 0.0100) / 3 \\approx 0.006867$\n$B(0.0) = 0.010$，误差 = $|0.010 - 0.0150| = 0.0050$\n\n对于 $a=0.15$：\n$D_e(\\mathrm{H}_2; 0.15) = 0.171$，误差 = $|0.171 - 0.1746| = 0.0036$\n$D_e(\\mathrm{CH}_4; 0.15) = 0.605$，误差 = $|0.605 - 0.6250| = 0.0200$\n$D_e(\\mathrm{H}_2\\mathrm{O}; 0.15) = 0.350$，误差 = $|0.350 - 0.3700| = 0.0200$\n$\\mathrm{MAE}(0.15) = (0.0036 + 0.0200 + 0.0200) / 3 \\approx 0.014533$\n$B(0.15) = 0.01525$，误差 = $|0.01525 - 0.0150| = 0.00025$\n\n对于 $a=0.25$：\n$D_e(\\mathrm{H}_2; 0.25) = 0.169$，误差 = $|0.169 - 0.1746| = 0.0056$\n$D_e(\\mathrm{CH}_4; 0.25) = 0.585$，误差 = $|0.585 - 0.6250| = 0.0400$\n$D_e(\\mathrm{H}_2\\mathrm{O}; 0.25) = 0.330$，误差 = $|0.330 - 0.3700| = 0.0400$\n$\\mathrm{MAE}(0.25) = (0.0056 + 0.0400 + 0.0400) / 3 \\approx 0.028533$\n$B(0.25) = 0.01875$，误差 = $|0.01875 - 0.0150| = 0.00375$\n\n对于 $a=0.50$：\n$D_e(\\mathrm{H}_2; 0.50) = 0.164$，误差 = $|0.164 - 0.1746| = 0.0106$\n$D_e(\\mathrm{CH}_4; 0.50) = 0.535$，误差 = $|0.535 - 0.6250| = 0.0900$\n$D_e(\\mathrm{H}_2\\mathrm{O}; 0.50) = 0.280$，误差 = $|0.280 - 0.3700| = 0.0900$\n$\\mathrm{MAE}(0.50) = (0.0106 + 0.0900 + 0.0900) / 3 \\approx 0.063533$\n$B(0.50) = 0.0275$，误差 = $|0.0275 - 0.0150| = 0.0125$\n\n对于 $a=1.00$：\n$D_e(\\mathrm{H}_2; 1.00) = 0.154$，误差 = $|0.154 - 0.1746| = 0.0206$\n$D_e(\\mathrm{CH}_4; 1.00) = 0.435$，误差 = $|0.435 - 0.6250| = 0.1900$\n$D_e(\\mathrm{H}_2\\mathrm{O}; 1.00) = 0.180$，误差 = $|0.180 - 0.3700| = 0.1900$\n$\\mathrm{MAE}(1.00) = (0.0206 + 0.1900 + 0.1900) / 3 \\approx 0.133533$\n$B(1.00) = 0.045$，误差 = $|0.045 - 0.0150| = 0.0300$\n\n结果揭示了杂化 DFT 中一个众所周知的权衡关系：较低的 $a$ 值（例如 $a=0$）对热化学计算（$\\mathrm{MAE}$ 较小）更有利，而需要较高的 $a$ 值来校正困扰半局域泛函的自相互作用误差，该误差会导致系统性地低估能垒高度。对于该体系，能垒高度的误差在 $a=0.15$ 附近最小化，而热化学误差在 $a=0.0$ 时最小化。这种冲突是设计具有广泛适用性的密度泛函时的一个根本性挑战。\n现在将基于这些计算进行实现。", "answer": "```\n[0.006867,0.005000,0.014533,0.000250,0.028533,0.003750,0.063533,0.012500,0.133533,0.030000]\n```", "id": "2903641"}]}