{"hands_on_practices": [{"introduction": "密度泛函理论的数学基础植根于变分法。要从能量最小化原理推导出核心的 Kohn-Sham 方程，必须掌握泛函导数这一基本数学工具。本练习旨在通过一个具体的例子，帮助您动手实践泛函导数的计算，从而深刻理解能量对电子密度的一阶响应是如何定义的。[@problem_id:2634146]", "problem": "在密度泛函理论 (DFT) 中，Hohenberg-Kohn 定理断言基态能量是电子密度的泛函，而 Kohn-Sham (KS) 方程则源于一个涉及相对于密度的泛函导数的 Euler-Lagrange 平稳性条件。从 Banach 空间上泛函可微性的基本定义和基本变分原理出发，按以下步骤进行。\n\n- 定义一个泛函 $F$ 在赋范线性空间 $X$ 中一点 $n$ 处，沿方向 $h \\in X$ 的 Gâteaux 导数和 Fréchet 导数。\n- 考虑 $X = L^{2}(\\mathbb{R}^{3})$ 上的泛函\n$$\nF[n] = \\int_{\\mathbb{R}^{3}} w(\\mathbf{r})\\, n^{2}(\\mathbf{r})\\, d^3\\mathbf{r},\n$$\n其中 $n \\in L^{2}(\\mathbb{R}^{3})$ 是一个实值密度，$w : \\mathbb{R}^{3} \\to \\mathbb{R}$ 是一个给定的权重函数。仅使用这些定义和 $L^{p}$ 空间的基本性质，计算泛函导数 $\\delta F/\\delta n(\\mathbf{r})$，其意义在于 Gâteaux 导数可以表示为一个对偶配对 $\\langle \\delta F/\\delta n, h \\rangle = \\int_{\\mathbb{R}^{3}} \\left(\\delta F/\\delta n(\\mathbf{r})\\right) h(\\mathbf{r})\\, d^3\\mathbf{r}$，对所有 $h \\in L^{2}(\\mathbb{R}^{3})$ 成立。阐述在何种关于 $w$ 的最小充分假设下：\n  1. 对于所有 $n \\in L^{2}(\\mathbb{R}^{3})$ 和 $h \\in L^{2}(\\mathbb{R}^{3})$，Gâteaux 导数存在；\n  2. 在 $L^{2}(\\mathbb{R}^{3})$ 上，Gâteaux 导数与 Fréchet 导数一致；\n  3. 泛函导数 $\\delta F/\\delta n(\\mathbf{r})$ 可由 $L^{2}(\\mathbb{R}^{3})$ 中的一个函数表示。\n- 简要阐述在约束条件 $\\int_{\\mathbb{R}^{3}} n(\\mathbf{r})\\, d^3\\mathbf{r} = N$ 下，最小化形式为 $E[n] = F[n] + \\int_{\\mathbb{R}^{3}} v_{\\mathrm{ext}}(\\mathbf{r})\\, n(\\mathbf{r})\\, d^3\\mathbf{r}$ 的能量的 Euler-Lagrange 平稳性条件，并指出 Lagrange 乘子 $\\mu$ 的作用。您无需解出 $n$ 或 $\\mu$。\n\n您的最终答案应为 $\\delta F/\\delta n(\\mathbf{r})$ 的闭式解析表达式。不需要进行数值计算，也不需要单位。最终答案必须是单个表达式，而不是方程或不等式。", "solution": "问题陈述已经过验证，被认定为有效。它在科学上基于泛函分析的原理及其在密度泛函理论中的应用，是良定的，并且使用客观和精确的语言表述。所有必要信息均已提供。不存在矛盾或谬误。我们可以开始解题。\n\n该问题要求在密度泛函理论的背景下对一个泛函进行多步推导和分析。我们将有条不紊地处理每个部分。\n\n首先，我们定义所需的导数。设 $F: X \\to \\mathbb{R}$ 是赋范线性空间 $X$ 上的一个泛函。\n\n泛函 $F$ 在点 $n \\in X$ 处沿方向 $h \\in X$ 的 Gâteaux 导数定义为以下极限：\n$$\nDF(n; h) = \\lim_{\\epsilon \\to 0} \\frac{F[n + \\epsilon h] - F[n]}{\\epsilon}\n$$\n前提是该极限存在。这是一种方向导数。\n\n泛函 $F$ 在 $n \\in X$ 处的 Fréchet 导数是一个有界线性算子 $A_n: X \\to \\mathbb{R}$，使得：\n$$\n\\lim_{\\|h\\|_{X} \\to 0} \\frac{|F[n+h] - F[n] - A_n(h)|}{\\|h\\|_{X}} = 0\n$$\n如果存在这样的算子 $A_n$，它是唯一的，并记为 $F'(n)$。Fréchet 导数存在的条件是 Gâteaux 导数对所有方向 $h$ 都存在，并且是关于 $h$ 的有界线性算子，即 $DF(n; h) = A_n(h)$。\n\n接下来，我们考虑空间 $X = L^{2}(\\mathbb{R}^{3})$ 上的特定泛函 $F[n] = \\int_{\\mathbb{R}^{3}} w(\\mathbf{r})\\, n^{2}(\\mathbf{r})\\, d^3\\mathbf{r}$。我们计算它的 Gâteaux 导数。\n设 $n, h \\in L^{2}(\\mathbb{R}^{3})$ 且 $\\epsilon \\in \\mathbb{R}$。我们计算泛函在 $n + \\epsilon h$ 处的值：\n$$\nF[n + \\epsilon h] = \\int_{\\mathbb{R}^{3}} w(\\mathbf{r}) (n(\\mathbf{r}) + \\epsilon h(\\mathbf{r}))^{2} \\, d^3\\mathbf{r}\n$$\n展开被积函数：\n$$\nw(\\mathbf{r}) (n(\\mathbf{r}) + \\epsilon h(\\mathbf{r}))^{2} = w(\\mathbf{r}) \\left( n^{2}(\\mathbf{r}) + 2\\epsilon n(\\mathbf{r}) h(\\mathbf{r}) + \\epsilon^{2} h^{2}(\\mathbf{r}) \\right)\n$$\n假设各项的积分都存在，我们可以写出：\n$$\nF[n + \\epsilon h] = \\int_{\\mathbb{R}^{3}} w(\\mathbf{r}) n^{2}(\\mathbf{r}) \\, d^3\\mathbf{r} + 2\\epsilon \\int_{\\mathbb{R}^{3}} w(\\mathbf{r}) n(\\mathbf{r}) h(\\mathbf{r}) \\, d^3\\mathbf{r} + \\epsilon^{2} \\int_{\\mathbb{R}^{3}} w(\\mathbf{r}) h^{2}(\\mathbf{r}) \\, d^3\\mathbf{r}\n$$\n$$\nF[n + \\epsilon h] = F[n] + 2\\epsilon \\int_{\\mathbb{R}^{3}} w(\\mathbf{r}) n(\\mathbf{r}) h(\\mathbf{r}) \\, d^3\\mathbf{r} + \\epsilon^{2} \\int_{\\mathbb{R}^{3}} w(\\mathbf{r}) h^{2}(\\mathbf{r}) \\, d^3\\mathbf{r}\n$$\n现在我们构造 Gâteaux 导数的差商：\n$$\n\\frac{F[n + \\epsilon h] - F[n]}{\\epsilon} = 2 \\int_{\\mathbb{R}^{3}} w(\\mathbf{r}) n(\\mathbf{r}) h(\\mathbf{r}) \\, d^3\\mathbf{r} + \\epsilon \\int_{\\mathbb{R}^{3}} w(\\mathbf{r}) h^{2}(\\mathbf{r}) \\, d^3\\mathbf{r}\n$$\n取极限 $\\epsilon \\to 0$：\n$$\nDF(n; h) = \\lim_{\\epsilon \\to 0} \\left( 2 \\int_{\\mathbb{R}^{3}} w(\\mathbf{r}) n(\\mathbf{r}) h(\\mathbf{r}) \\, d^3\\mathbf{r} + \\epsilon \\int_{\\mathbb{R}^{3}} w(\\mathbf{r}) h^{2}(\\mathbf{r}) \\, d^3\\mathbf{r} \\right) = 2 \\int_{\\mathbb{R}^{3}} w(\\mathbf{r}) n(\\mathbf{r}) h(\\mathbf{r}) \\, d^3\\mathbf{r}\n$$\n这就是 Gâteaux 导数。问题将泛函导数 $\\frac{\\delta F}{\\delta n(\\mathbf{r})}$ 定义为通过 $L^{2}(\\mathbb{R}^{3})$ 上的内积来表示 Gâteaux 导数的那个函数：\n$$\nDF(n; h) = \\int_{\\mathbb{R}^{3}} \\frac{\\delta F}{\\delta n(\\mathbf{r})} h(\\mathbf{r}) \\, d^3\\mathbf{r}\n$$\n将此形式与我们的结果进行比较，我们确定泛函导数为：\n$$\n\\frac{\\delta F}{\\delta n(\\mathbf{r})} = 2w(\\mathbf{r})n(\\mathbf{r})\n$$\n现在我们必须确定对权重函数 $w(\\mathbf{r})$ 的最小充分假设。\n1. 为使 Gâteaux 导数对所有 $n, h \\in L^{2}(\\mathbb{R}^{3})$ 都存在，其推导中的积分必须是有限的。特别地，$\\int w(\\mathbf{r}) n(\\mathbf{r}) h(\\mathbf{r}) \\, d^3\\mathbf{r}$ 和 $\\int w(\\mathbf{r}) h^{2}(\\mathbf{r}) \\, d^3\\mathbf{r}$ 必须收敛。根据 Cauchy-Schwarz 不等式，两个 $L^{2}$ 函数的乘积属于 $L^{1}$。因此 $n(\\mathbf{r})h(\\mathbf{r}) \\in L^{1}(\\mathbb{R}^{3})$ 并且 $h^{2}(\\mathbf{r}) \\in L^{1}(\\mathbb{R}^{3})$。为使包含 $w(\\mathbf{r})$ 的积分对 $n, h \\in L^{2}(\\mathbb{R}^{3})$ 的所有选择都收敛，一个充分必要条件是 $w(\\mathbf{r})$ 是一个本质有界函数，即 $w \\in L^{\\infty}(\\mathbb{R}^{3})$。如果 $w \\in L^{\\infty}(\\mathbb{R}^{3})$，则 $|\\int wnh \\, d^3\\mathbf{r}| \\le \\|w\\|_{\\infty} \\int |nh| \\, d^3\\mathbf{r} \\le \\|w\\|_{\\infty} \\|n\\|_{2} \\|h\\|_{2}  \\infty$。\n\n2. 为使 Gâteaux 导数与 Fréchet 导数一致，我们必须检查极限条件。Gâteaux 导数 $DF(n; h)$ 定义了一个关于 $h$ 的线性算子，我们记为 $A_n(h)$。余项为 $R(h) = F[n+h] - F[n] - A_n(h)$。\n$$\nR(h) = \\int_{\\mathbb{R}^{3}} w(\\mathbf{r})h^{2}(\\mathbf{r}) \\, d^3\\mathbf{r}\n$$\n我们必须证明 $\\lim_{\\|h\\|_{2} \\to 0} \\frac{|R(h)|}{\\|h\\|_{2}} = 0$。\n如果我们假设 $w \\in L^{\\infty}(\\mathbb{R}^{3})$，则 $|w(\\mathbf{r})| \\le \\|w\\|_{\\infty}$ 几乎处处成立。\n$$\n|R(h)| = \\left| \\int w(\\mathbf{r}) h^{2}(\\mathbf{r}) \\, d^3\\mathbf{r} \\right| \\le \\int |w(\\mathbf{r})| h^{2}(\\mathbf{r}) \\, d^3\\mathbf{r} \\le \\|w\\|_{\\infty} \\int h^{2}(\\mathbf{r}) \\, d^3\\mathbf{r} = \\|w\\|_{\\infty} \\|h\\|_{2}^{2}\n$$\n因此，该比值是有界的：\n$$\n\\frac{|R(h)|}{\\|h\\|_{2}} \\le \\frac{\\|w\\|_{\\infty} \\|h\\|_{2}^{2}}{\\|h\\|_{2}} = \\|w\\|_{\\infty} \\|h\\|_{2}\n$$\n当 $\\|h\\|_{2} \\to 0$ 时，可得 $\\|w\\|_{\\infty} \\|h\\|_{2} \\to 0$。因此，极限为 $0$，Fréchet 导数存在且等于 Gâteaux 导数。条件 $w \\in L^{\\infty}(\\mathbb{R}^{3})$ 是充分的。\n\n3. 为使泛函导数 $\\frac{\\delta F}{\\delta n(\\mathbf{r})} = 2w(\\mathbf{r})n(\\mathbf{r})$ 对任何 $n \\in L^{2}(\\mathbb{R}^{3})$ 都属于 $L^{2}(\\mathbb{R}^{3})$，我们需要映射 $n \\mapsto wn$ 是一个从 $L^{2}$到 $L^{2}$ 的有界算子。这当且仅当 $w \\in L^{\\infty}(\\mathbb{R}^{3})$ 时成立。如果 $w \\in L^{\\infty}$，则\n$$\n\\left\\| \\frac{\\delta F}{\\delta n} \\right\\|_{2}^{2} = \\int |2w(\\mathbf{r})n(\\mathbf{r})|^{2} \\, d^3\\mathbf{r} = 4 \\int |w(\\mathbf{r})|^{2} |n(\\mathbf{r})|^{2} \\, d^3\\mathbf{r} \\le 4\\|w\\|_{\\infty}^{2} \\int |n(\\mathbf{r})|^{2} \\, d^3\\mathbf{r} = 4\\|w\\|_{\\infty}^{2} \\|n\\|_{2}^{2}  \\infty\n$$\n因此，单个条件 $w \\in L^{\\infty}(\\mathbb{R}^{3})$ 对所有三个要求都是充分的。\n\n最后，我们阐述在约束条件 $\\int_{\\mathbb{R}^{3}} n(\\mathbf{r})\\, d^3\\mathbf{r} = N$ 下最小化能量泛函 $E[n] = F[n] + \\int_{\\mathbb{R}^{3}} v_{\\mathrm{ext}}(\\mathbf{r})\\, n(\\mathbf{r})\\, d^3\\mathbf{r}$ 的 Euler-Lagrange 平稳性条件。\n这是一个约束变分问题。我们引入一个 Lagrange 乘子 $\\mu$ 来施加该约束。我们定义一个辅助泛函 $\\mathcal{L}[n]$：\n$$\n\\mathcal{L}[n] = E[n] - \\mu \\left( \\int_{\\mathbb{R}^{3}} n(\\mathbf{r}) \\, d^3\\mathbf{r} - N \\right)\n$$\n平稳性条件要求 $\\mathcal{L}[n]$ 相对于 $n(\\mathbf{r})$ 的泛函导数对所有 $\\mathbf{r}$ 都为零：\n$$\n\\frac{\\delta \\mathcal{L}}{\\delta n(\\mathbf{r})} = 0\n$$\n我们计算 $\\mathcal{L}[n]$ 中每一项的泛函导数：\n$$\n\\frac{\\delta F}{\\delta n(\\mathbf{r})} = 2w(\\mathbf{r})n(\\mathbf{r})\n$$\n$$\n\\frac{\\delta}{\\delta n(\\mathbf{r})} \\int_{\\mathbb{R}^{3}} v_{\\mathrm{ext}}(\\mathbf{r}') n(\\mathbf{r}') \\, d^3\\mathbf{r}' = v_{\\mathrm{ext}}(\\mathbf{r})\n$$\n$$\n\\frac{\\delta}{\\delta n(\\mathbf{r})} \\left( -\\mu \\int_{\\mathbb{R}^{3}} n(\\mathbf{r}') \\, d^3\\mathbf{r}' \\right) = -\\mu\n$$\n常数项 $-\\mu(-N)$ 的导数为零。结合这些结果，Euler-Lagrange 方程为：\n$$\n\\frac{\\delta E}{\\delta n(\\mathbf{r})} - \\mu = 2w(\\mathbf{r})n(\\mathbf{r}) + v_{\\mathrm{ext}}(\\mathbf{r}) - \\mu = 0\n$$\n或者，更常见的写法是：\n$$\n2w(\\mathbf{r})n(\\mathbf{r}) + v_{\\mathrm{ext}}(\\mathbf{r}) = \\mu\n$$\nLagrange 乘子 $\\mu$ 是一个常数，由所得密度 $n(\\mathbf{r})$ 的积分等于总粒子数 $N$ 这一条件确定。在量子力学和 DFT 的背景下，$\\mu$ 被确定为系统的化学势。它确保了能量的变分仅对那些保持总粒子数守恒的密度变分才为零。\n问题要求给出 $\\delta F/\\delta n(\\mathbf{r})$ 的解析表达式，我们已经确定其为 $2w(\\mathbf{r})n(\\mathbf{r})$。", "answer": "$$\n\\boxed{2w(\\mathbf{r})n(\\mathbf{r})}\n$$", "id": "2634146"}, {"introduction": "自相互作用误差（Self-Interaction Error, SIE）是近似密度泛函面临的一个核心挑战，即一个电子不应与自身相互作用。本练习将通过分析最简单的单电子体系——氢原子，来具体揭示这一概念。您将计算并证明，对于精确的泛函，交换能 $E_x[n]$ 如何完美地抵消了非物理的 Hartree 自相互作用能 $E_H[n]$，这是所有近似泛函都力求达到的重要条件。[@problem_id:2634155]", "problem": "考虑一个单电子在位于原点的电荷为 $Z=1$ 的点核的外部库仑势中运动。使用原子单位制，此时玻尔半径为 $a_{0}=1$，能量单位为哈特里 (Hartree)。其精确的归一化基态电子密度是球对称的，由 $n(r)=\\frac{1}{\\pi}\\exp(-2r)$ 给出。\n\n从密度泛函理论（DFT）的第一性原理出发，即 Hohenberg–Kohn 定理和 Kohn–Sham (KS) 构造，以哈特里能量泛函 $E_{\\mathrm{H}}[n]=\\frac{1}{2}\\int\\int \\frac{n(\\mathbf{r})\\,n(\\mathbf{r}')}{|\\mathbf{r}-\\mathbf{r}'|}\\,d^{3}\\mathbf{r}\\,d^{3}\\mathbf{r}'$、能够复现 $n(r)$ 的单占据轨道的 Kohn–Sham 动能 $T_{s}[n]$，以及外部势能项 $\\int v_{\\mathrm{ext}}(\\mathbf{r})\\,n(\\mathbf{r})\\,d^{3}\\mathbf{r}$（其中 $v_{\\mathrm{ext}}(\\mathbf{r})=-1/r$）的定义为基础。请按以下步骤进行：\n\n- 对于给定的 $n(r)$，精确计算哈特里能量 $E_{\\mathrm{H}}[n]=\\frac{1}{2}\\int\\int \\frac{n(\\mathbf{r})\\,n(\\mathbf{r}')}{|\\mathbf{r}-\\mathbf{r}'|}\\,d^{3}\\mathbf{r}\\,d^{3}\\mathbf{r}'$。您的推导必须是明确且自洽的；您可以使用针对球对称密度的泊松方程或库仑核的傅里叶表示，但必须展示所有中间步骤。\n- 利用单电子密度的精确交换性质，分析证明交换能 $E_{x}[n]$ 如何抵消 $E_{\\mathrm{H}}[n]$ 中包含的自相互作用，并论证为何在此极限下相关能 $E_{c}[n]$ 为零。\n- 在证明了该抵消关系后，通过使用满足 $|\\varphi(\\mathbf{r})|^{2}=n(\\mathbf{r})$ 的单个归一化 KS 轨道 $\\varphi(\\mathbf{r})$，精确计算给定 $n(r)$ 的 $T_{s}[n]$ 和外部势能 $\\int v_{\\mathrm{ext}}(\\mathbf{r})\\,n(\\mathbf{r})\\,d^{3}\\mathbf{r}$。\n- 综合所有部分，求得精确的总基态能量 $E[n]$。\n\n以哈特里 (Hartree) 为单位表示最终的总能量。您的最终答案应为一个精确的数字。在最终的方框答案中不要包含单位。", "solution": "所提出的问题在密度泛函理论（DFT）框架内是有效、科学合理且适定的。我们将按要求进行推导。该体系是一个在原子单位制下描述的、处于电荷为 $Z=1$ 的原子核势场中的单电子。其精确的基态电子密度由 $n(r) = \\frac{1}{\\pi}\\exp(-2r)$ 给出。\n\n首先，我们计算哈特里能量泛函 $E_{\\mathrm{H}}[n]$，其定义为电荷密度的经典静电自排斥能：\n$$E_{\\mathrm{H}}[n] = \\frac{1}{2}\\iint \\frac{n(\\mathbf{r})n(\\mathbf{r}')}{|\\mathbf{r}-\\mathbf{r}'|} d^{3}\\mathbf{r} d^{3}\\mathbf{r}'$$\n对于球对称密度 $n(r)$，最有效的计算方法是首先求出哈特里势 $v_{\\mathrm{H}}(r) = \\int \\frac{n(\\mathbf{r}')}{|\\mathbf{r}-\\mathbf{r}'|} d^{3}\\mathbf{r}'$。势 $v_{\\mathrm{H}}(r)$ 是泊松方程 $\\nabla^2 v_{\\mathrm{H}}(r) = -4\\pi n(r)$ 的解。考虑到球对称性，拉普拉斯算子为 $\\nabla^2 = \\frac{1}{r^2}\\frac{d}{dr}\\left(r^2\\frac{d}{dr}\\right)$。\n因此，我们求解：\n$$\\frac{1}{r^2}\\frac{d}{dr}\\left(r^2\\frac{d v_{\\mathrm{H}}}{dr}\\right) = -4\\pi \\left(\\frac{1}{\\pi}\\exp(-2r)\\right) = -4\\exp(-2r)$$\n对 $r$ 从 $0$ 到 $r'$ 积分，得到电场乘以 $-r'^2$：\n$$r'^2 \\frac{d v_{\\mathrm{H}}}{dr'} = -4 \\int_{0}^{r'} s^2 \\exp(-2s) ds$$\n该积分使用分部积分法求解：$\\int s^2 \\exp(-as) ds = -\\frac{\\exp(-as)}{a^3}(a^2s^2 + 2as + 2)$。\n当 $a=2$ 时，可得：\n$$r'^2 \\frac{d v_{\\mathrm{H}}}{dr'} = -4 \\left[ -\\frac{\\exp(-2s)}{8}(4s^2 + 4s + 2) \\right]_0^{r'} = -4 \\left( -\\frac{\\exp(-2r')}{8}(4r'^2 + 4r' + 2) + \\frac{2}{8} \\right) = \\frac{1}{2}\\exp(-2r')(4r'^2 + 4r' + 2) - 1 = (2r'^2+2r'+1)\\exp(-2r') - 1$$\n静电势 $v_{\\mathrm{H}}(r)$ 可通过对电场的相反数 $E(r) = -\\frac{d v_{\\mathrm{H}}}{dr}$ 从 $r$ 到 $\\infty$ 积分得到，以满足边界条件 $v_{\\mathrm{H}}(\\infty)=0$。\n$$v_{\\mathrm{H}}(r) = \\int_{r}^{\\infty} -\\frac{d v_{\\mathrm{H}}}{dr'} dr' = \\int_{r}^{\\infty} \\frac{1}{r'^2}\\left(1 - (2r'^2+2r'+1)\\exp(-2r')\\right) dr'$$\n$$v_{\\mathrm{H}}(r) = \\int_{r}^{\\infty} \\frac{1}{r'^2} dr' - \\int_{r}^{\\infty} \\left(2+\\frac{2}{r'}+\\frac{1}{r'^2}\\right)\\exp(-2r') dr'$$\n第一个积分是 $\\left[-\\frac{1}{r'}\\right]_r^\\infty = \\frac{1}{r}$。第二个积分的原函数是 $-\\left(1+\\frac{1}{r'}\\right)\\exp(-2r')$。\n$$v_{\\mathrm{H}}(r) = \\frac{1}{r} - \\left[ -\\left(1+\\frac{1}{r'}\\right)\\exp(-2r') \\right]_r^\\infty = \\frac{1}{r} - \\left(0 - \\left(-\\left(1+\\frac{1}{r}\\right)\\exp(-2r)\\right)\\right) = \\frac{1}{r} - \\frac{1+r}{r}\\exp(-2r)$$\n现在，我们可以计算哈特里能量：\n$$E_{\\mathrm{H}}[n] = \\frac{1}{2} \\int n(r) v_{\\mathrm{H}}(r) d^3\\mathbf{r} = \\frac{1}{2} \\int_{0}^{\\infty} \\left(\\frac{1}{\\pi}\\exp(-2r)\\right) \\left(\\frac{1}{r} - \\frac{1+r}{r}\\exp(-2r)\\right) 4\\pi r^2 dr$$\n$$E_{\\mathrm{H}}[n] = 2 \\int_{0}^{\\infty} r^2 \\exp(-2r) \\left(\\frac{1}{r} - \\frac{1+r}{r}\\exp(-2r)\\right) dr = 2 \\int_{0}^{\\infty} (r\\exp(-2r) - (r+r^2)\\exp(-4r)) dr$$\n使用标准积分 $\\int_0^\\infty x^k \\exp(-ax) dx = k!/a^{k+1}$：\n$$E_{\\mathrm{H}}[n] = 2 \\left( \\int_0^\\infty r\\exp(-2r)dr - \\int_0^\\infty r\\exp(-4r)dr - \\int_0^\\infty r^2\\exp(-4r)dr \\right)$$\n$$E_{\\mathrm{H}}[n] = 2 \\left( \\frac{1!}{2^2} - \\frac{1!}{4^2} - \\frac{2!}{4^3} \\right) = 2 \\left( \\frac{1}{4} - \\frac{1}{16} - \\frac{2}{64} \\right) = 2 \\left( \\frac{4}{16} - \\frac{1}{16} - \\frac{1}{32} \\right) = 2 \\left( \\frac{3}{16} - \\frac{1}{32} \\right) = 2 \\left( \\frac{6-1}{32} \\right) = \\frac{5}{16}$$\n\n接下来，我们讨论交换相关泛函 $E_{\\mathrm{xc}}[n]$。对于单电子体系，其精确基态能量是单电子哈密顿算符 $\\hat{H} = \\hat{T} + \\hat{V}_{\\mathrm{ext}}$ 的期望值，该算符不包含电子-电子相互作用项。在 Kohn-Sham 形式体系中，总能量为 $E[n] = T_s[n] + E_{\\mathrm{ext}}[n] + E_{\\mathrm{H}}[n] + E_{\\mathrm{xc}}[n]$。由于 $T_s[n]$ 和 $E_{\\mathrm{ext}}[n]$ 被定义为能够复现密度 $n$ 的无相互作用 KS 体系的动能和外部势能，对于此单电子体系，它们与真实的动能和势能是相同的。因此，为了使 DFT 能量等于精确能量，必须有 $E_{\\mathrm{H}}[n] + E_{\\mathrm{xc}}[n] = 0$。交换相关能由交换能 $E_{x}[n]$ 和相关能 $E_{c}[n]$ 组成。对于单个占据轨道 $\\varphi(\\mathbf{r})$，精确交换能由 $E_{x}[n] = -\\frac{1}{2}\\iint \\frac{|\\varphi(\\mathbf{r}_1)|^2|\\varphi(\\mathbf{r}_2)|^2}{|\\mathbf{r}_1-\\mathbf{r}_2|}d^3\\mathbf{r}_1 d^3\\mathbf{r}_2$ 给出。鉴于 $n(\\mathbf{r})=|\\varphi(\\mathbf{r})|^2$，此式变为 $E_{x}[n] = -E_{\\mathrm{H}}[n]$。这表明交换能精确地抵消了哈特里能量中包含的虚假自相互作用。因此，为了使总和为零，相关能 $E_{c}[n]$ 必须为零。这与相关能的定义——即精确能量与 Hartree-Fock 能量之差——是一致的，因为对于单电子体系，这两者是相同的。\n\n在 $E_{\\mathrm{H}}[n] + E_{x}[n] + E_{c}[n] = 0$ 的条件下，总能量简化为 $E[n] = T_s[n] + E_{\\mathrm{ext}}[n]$。我们现在计算这两项。\n能够复现密度 $n(r) = \\frac{1}{\\pi}\\exp(-2r)$ 的单个归一化 KS 轨道是 $\\varphi(r) = \\sqrt{n(r)} = \\frac{1}{\\sqrt{\\pi}}\\exp(-r)$，因为基态轨道可以选择为实数且为正。\n外部势能为：\n$$E_{\\mathrm{ext}}[n] = \\int v_{\\mathrm{ext}}(\\mathbf{r}) n(\\mathbf{r}) d^3\\mathbf{r} = \\int_{0}^{\\infty} \\left(-\\frac{1}{r}\\right) \\left(\\frac{1}{\\pi}\\exp(-2r)\\right) 4\\pi r^2 dr$$\n$$E_{\\mathrm{ext}}[n] = -4 \\int_{0}^{\\infty} r\\exp(-2r) dr = -4 \\left(\\frac{1!}{2^2}\\right) = -4 \\left(\\frac{1}{4}\\right) = -1 \\text{ Hartree}$$\nKohn-Sham 动能为 $T_s[n] = \\int \\varphi^*(\\mathbf{r})(-\\frac{1}{2}\\nabla^2)\\varphi(\\mathbf{r}) d^3\\mathbf{r}$。使用分部积分法（格林第一恒等式），这等价于：\n$$T_s[n] = \\frac{1}{2} \\int |\\nabla \\varphi(\\mathbf{r})|^2 d^3\\mathbf{r}$$\n对于我们的径向轨道，$\\nabla\\varphi(r) = \\frac{d\\varphi}{dr}\\hat{\\mathbf{r}} = -\\frac{1}{\\sqrt{\\pi}}\\exp(-r)\\hat{\\mathbf{r}} = -\\varphi(r)\\hat{\\mathbf{r}}$。\n因此， $|\\nabla \\varphi(r)|^2 = (\\nabla\\varphi) \\cdot (\\nabla\\varphi) = (-\\varphi\\hat{\\mathbf{r}}) \\cdot (-\\varphi\\hat{\\mathbf{r}}) = \\varphi(r)^2 = n(r)$。\n$$T_s[n] = \\frac{1}{2} \\int n(r) d^3\\mathbf{r}$$\n由于密度被归一化为一个电子，故 $\\int n(r) d^3\\mathbf{r} = 1$。\n$$T_s[n] = \\frac{1}{2}(1) = \\frac{1}{2} \\text{ Hartree}$$\n\n最后，我们将各部分组合起来，得到总基态能量：\n$$E[n] = T_s[n] + E_{\\mathrm{ext}}[n] = \\frac{1}{2} + (-1) = -\\frac{1}{2} \\text{ Hartree}$$\n此结果与已知的氢原子精确能量相符，这在预料之中。", "answer": "$$\\boxed{-\\frac{1}{2}}$$", "id": "2634155"}, {"introduction": "在前一个练习的基础上，本实践将进一步探讨常见的近似泛函（如 GGA）中自相互作用误差未能完全消除所带来的后果。通过考察具有分数电子数的体系，我们可以量化其总能量 $E(N)$ 对精确线性行为的偏离程度。这个练习将帮助您理解近似泛函的这种“弯曲”错误与离域误差（delocalization error）之间的深刻联系，这是理解和改进密度泛函的关键一步。[@problem_id:2634165]", "problem": "一个处于外库仑势中的氢原子有一个束缚电子，其精确基态能量在原子单位 (Hartree) 下为 $E(1) = -\\tfrac{1}{2}$。考虑类氢原子基态密度 $n_{1}(\\mathbf{r})$ 以及分数电子数 $N \\in [0,1]$ 的系综描述，其密度为 $n_{N}(\\mathbf{r}) = N\\,n_{1}(\\mathbf{r})$。密度泛函理论 (DFT) 的总能量泛函为\n$$\nE[n] \\;=\\; T_{s}[n] \\;+\\; E_{H}[n] \\;+\\; E_{xc}[n] \\;+\\; \\int v_{\\mathrm{ne}}(\\mathbf{r})\\,n(\\mathbf{r})\\,d^{3}\\mathbf{r},\n$$\n其中 $T_{s}[n]$ 是无相互作用动能，$E_{H}[n]$ 是 Hartree 能量，$E_{xc}[n]$ 是交换相关能。在单电子极限下，对于任何此类密度标度，精确的交换相关能会抵消 Hartree 能量，即 $E_{xc}^{\\mathrm{exact}}[n_{N}] = -E_{H}[n_{N}]$，这意味着 $E(N)$ 在 $N=0$ 和 $N=1$ 之间是精确分段线性的。\n\n现在考虑一个近似的广义梯度近似 (GGA)，对于单电子密度，其交换能的标度关系为\n$$\nE_{x}^{\\mathrm{GGA}}[n_{N}] \\;=\\; -\\lambda\\,U_{1}\\,N^{4/3},\n$$\n其中 $U_{1} \\equiv E_{H}[n_{1}] = \\tfrac{5}{16}$，且对于此单电子密度，相关可以忽略不计。参数 $\\lambda \\in (0,1)$ 表征了自相互作用的不完全抵消；对于一个类似 Perdew–Burke–Ernzerhof (PBE) 的 GGA，取 $\\lambda = 0.90$。由于系综构造，假设 $T_{s}[n_{N}]$ 和 $\\int v_{\\mathrm{ne}}\\,n_{N}$ 随 $N$ 线性变化。\n\n1) 从以上定义出发，推导偏差\n$$\n\\delta(N) \\;=\\; E^{\\mathrm{GGA}}(N) \\;-\\; L(N),\n$$\n的解析表达式，其中 $L(N)$ 是近似 GGA 能量在两个端点之间的直线插值，$L(N) = (1-N)\\,E^{\\mathrm{GGA}}(0) + N\\,E^{\\mathrm{GGA}}(1)$。\n\n2) 利用你的表达式，计算当 $\\lambda = 0.90$ 时 $\\delta\\!\\left(\\tfrac{1}{2}\\right)$ 的值。最终结果以 Hartree 为单位表示，并四舍五入到四位有效数字。\n\n最后，利用 $E_{H}[n_{N}]$ 和 $E_{x}^{\\mathrm{GGA}}[n_{N}]$ 的密度标度行为，简要解释为什么在单电子极限下，对于氢原子，近似的 GGA 会在 $N=0$ 和 $N=1$ 之间产生一个凸的 $E(N)$ 曲线。", "solution": "该问题要求使用近似的广义梯度近似 (GGA) 泛函，对具有分数电子数 $N$ 的类氢体系的能量进行分析。任务是推导与线性的偏差 $\\delta(N)$，计算其在 $N = \\frac{1}{2}$ 处的值，并解释能量曲线 $E^{\\mathrm{GGA}}(N)$ 的凸性。\n\n首先，我们建立在此 GGA 近似下总能量 $E^{\\mathrm{GGA}}(N)$ 作为分数电子数 $N \\in [0,1]$ 的函数表达式。总能量泛函由下式给出：\n$$\nE[n] = T_{s}[n] + E_{H}[n] + E_{xc}[n] + \\int v_{\\mathrm{ne}}(\\mathbf{r})\\,n(\\mathbf{r})\\,d^{3}\\mathbf{r}\n$$\n问题指明相关能可以忽略不计，因此 $E_{xc}[n] \\approx E_{x}[n]$。具有 $N$ 个电子的体系的密度为 $n_{N}(\\mathbf{r}) = N\\,n_{1}(\\mathbf{r})$。我们必须确定每个能量分量随 $N$ 的标度关系。\n\n无相互作用电子动能 $T_{s}[n_{N}]$ 和核-电子吸引能 $V_{\\mathrm{ne}}[n_{N}] = \\int v_{\\mathrm{ne}}(\\mathbf{r})\\,n_{N}(\\mathbf{r})\\,d^{3}\\mathbf{r}$ 被设定为随 $N$ 线性标度。这与密度的系综定义是一致的。令 $T_{s}[n_{1}]$ 和 $V_{\\mathrm{ne}}[n_{1}]$ 为单电子体系 ($N=1$) 的值。那么：\n$$\nT_{s}[n_{N}] = N\\,T_{s}[n_{1}]\n$$\n$$\nV_{\\mathrm{ne}}[n_{N}] = N\\,V_{\\mathrm{ne}}[n_{1}]\n$$\n我们定义一个常数 $K_{1} = T_{s}[n_{1}] + V_{\\mathrm{ne}}[n_{1}]$，它包含了所有随 $N$ 线性标度的项。\n\nHartree 能量 $E_{H}[n]$ 是密度的二次方。其随 $N$ 的标度关系为：\n$$\nE_{H}[n_{N}] = \\frac{1}{2} \\iint \\frac{n_{N}(\\mathbf{r})\\,n_{N}(\\mathbf{r'})}{|\\mathbf{r}-\\mathbf{r'}|}\\,d^{3}\\mathbf{r}\\,d^{3}\\mathbf{r'} = \\frac{1}{2} \\iint \\frac{N n_{1}(\\mathbf{r})\\,N n_{1}(\\mathbf{r'})}{|\\mathbf{r}-\\mathbf{r'}|}\\,d^{3}\\mathbf{r}\\,d^{3}\\mathbf{r'} = N^{2} \\left( \\frac{1}{2} \\iint \\frac{n_{1}(\\mathbf{r})\\,n_{1}(\\mathbf{r'})}{|\\mathbf{r}-\\mathbf{r'}|}\\,d^{3}\\mathbf{r}\\,d^{3}\\mathbf{r'} \\right) = N^{2} E_{H}[n_{1}]\n$$\n使用给定的定义 $U_{1} = E_{H}[n_{1}]$，我们有 $E_{H}[n_{N}] = U_{1}\\,N^{2}$。\n\n近似的 GGA 交换能的标度关系为：\n$$\nE_{x}^{\\mathrm{GGA}}[n_{N}] = -\\lambda\\,U_{1}\\,N^{4/3}\n$$\n\n综合这些分量，$N$ 个电子的总 GGA 能量为：\n$$\nE^{\\mathrm{GGA}}(N) = T_{s}[n_{N}] + V_{\\mathrm{ne}}[n_{N}] + E_{H}[n_{N}] + E_{x}^{\\mathrm{GGA}}[n_{N}] = N\\,(T_{s}[n_{1}] + V_{\\mathrm{ne}}[n_{1}]) + U_{1}\\,N^{2} - \\lambda\\,U_{1}\\,N^{4/3}\n$$\n$$\nE^{\\mathrm{GGA}}(N) = K_{1}\\,N + U_{1}\\,N^{2} - \\lambda\\,U_{1}\\,N^{4/3}\n$$\n\n现在，我们推导与线性的偏差 $\\delta(N) = E^{\\mathrm{GGA}}(N) - L(N)$ 的表达式。线性插值 $L(N)$ 定义为 $L(N) = (1-N)\\,E^{\\mathrm{GGA}}(0) + N\\,E^{\\mathrm{GGA}}(1)$。我们必须首先计算在端点 $N=0$ 和 $N=1$ 处的能量。\n对于 $N=0$，密度为零，所以所有能量分量都为零：\n$$\nE^{\\mathrm{GGA}}(0) = 0\n$$\n对于 $N=1$：\n$$\nE^{\\mathrm{GGA}}(1) = K_{1}\\,(1) + U_{1}\\,(1)^{2} - \\lambda\\,U_{1}\\,(1)^{4/3} = K_{1} + U_{1} - \\lambda\\,U_{1}\n$$\n因此，线性插值为：\n$$\nL(N) = (1-N)\\,(0) + N\\,(K_{1} + U_{1} - \\lambda\\,U_{1}) = K_{1}\\,N + U_{1}\\,N - \\lambda\\,U_{1}\\,N\n$$\n偏差 $\\delta(N)$ 可通过从 $E^{\\mathrm{GGA}}(N)$ 中减去 $L(N)$ 得到：\n$$\n\\delta(N) = E^{\\mathrm{GGA}}(N) - L(N) = (K_{1}\\,N + U_{1}\\,N^{2} - \\lambda\\,U_{1}\\,N^{4/3}) - (K_{1}\\,N + U_{1}\\,N - \\lambda\\,U_{1}\\,N)\n$$\n$$\n\\delta(N) = U_{1}\\,N^{2} - U_{1}\\,N - \\lambda\\,U_{1}\\,N^{4/3} + \\lambda\\,U_{1}\\,N\n$$\n提出公因子 $U_{1}$，得到偏差的最终解析表达式：\n$$\n\\delta(N) = U_{1} \\left[ (N^{2} - N) - \\lambda(N^{4/3} - N) \\right]\n$$\n这便完成了问题的第一部分。\n\n对于第二部分，我们必须使用 $\\lambda = 0.90$ 和 $U_{1} = \\frac{5}{16}$ Hartree 来计算 $\\delta\\!\\left(\\frac{1}{2}\\right)$。我们将这些值代入推导出的 $\\delta(N)$ 表达式中：\n$$\n\\delta\\!\\left(\\frac{1}{2}\\right) = \\frac{5}{16} \\left[ \\left(\\left(\\frac{1}{2}\\right)^{2} - \\frac{1}{2}\\right) - 0.90\\left(\\left(\\frac{1}{2}\\right)^{4/3} - \\frac{1}{2}\\right) \\right]\n$$\n$$\n\\delta\\!\\left(\\frac{1}{2}\\right) = \\frac{5}{16} \\left[ \\left(\\frac{1}{4} - \\frac{1}{2}\\right) - 0.90\\left(\\left(\\frac{1}{2}\\right)^{4/3} - \\frac{1}{2}\\right) \\right]\n$$\n$$\n\\delta\\!\\left(\\frac{1}{2}\\right) = \\frac{5}{16} \\left[ -\\frac{1}{4} - 0.90\\left(2^{-4/3} - \\frac{1}{2}\\right) \\right]\n$$\n现在，我们计算其数值：\n$$\n2^{-4/3} \\approx 0.39685026\n$$\n$$\n\\delta\\!\\left(\\frac{1}{2}\\right) \\approx \\frac{5}{16} \\left[ -0.25 - 0.90(0.39685026 - 0.5) \\right]\n$$\n$$\n\\delta\\!\\left(\\frac{1}{2}\\right) \\approx \\frac{5}{16} \\left[ -0.25 - 0.90(-0.10314974) \\right]\n$$\n$$\n\\delta\\!\\left(\\frac{1}{2}\\right) \\approx \\frac{5}{16} \\left[ -0.25 + 0.092834766 \\right]\n$$\n$$\n\\delta\\!\\left(\\frac{1}{2}\\right) \\approx \\frac{5}{16} [-0.157165234] \\approx 0.3125 \\times (-0.157165234)\n$$\n$$\n\\delta\\!\\left(\\frac{1}{2}\\right) \\approx -0.0491141356 \\, \\text{Hartree}\n$$\n将结果四舍五入到四位有效数字，我们得到 $\\delta\\!\\left(\\frac{1}{2}\\right) = -0.04911$ Hartree。\n\n对于最后一部分，我们必须解释 $N \\in (0,1)$ 时 $E^{\\mathrm{GGA}}(N)$ 曲线凸性的来源。如果一个函数的曲线位于连接其端点的直线段的下方或与其重合，则该函数是凸的。这意味着对于 $N \\in [0,1]$，有 $\\delta(N) = E^{\\mathrm{GGA}}(N) - L(N) \\leq 0$。我们计算出的 $\\delta\\!\\left(\\frac{1}{2}\\right)$ 为负值，这与凸性是一致的。\n\n对于单电子体系，精确能量 $E(N)$ 的线性源于伪自相互作用 Hartree 能量 $E_{H}[n_{N}]$ 被精确的交换相关能 $E_{xc}^{\\mathrm{exact}}[n_{N}] = -E_{H}[n_{N}]$ 完全抵消。在近似的 GGA 能量中，非线性项是 $E_{H}[n_{N}]$ 和 $E_{x}^{\\mathrm{GGA}}[n_{N}]$。非线性偏差 $\\delta(N)$ 的来源是这两项之和。\nHartree 能量的标度关系为 $E_{H}[n_{N}] = U_{1}N^{2}$。一个与 $N^2$ 成正比的函数是内禀凸的（其二阶导数是正常数 $2U_1$）。\n近似的 GGA 交换能的标度关系为 $E_{x}^{\\mathrm{GGA}}[n_{N}] = -\\lambda U_{1}N^{4/3}$。一个与 $-N^{4/3}$ 成正比的函数是凹的（其二阶导数为 $-\\frac{4\\lambda U_1}{9}N^{-2/3}$，是负值）。\n\n总能量曲线的曲率由凸的 Hartree 项和凹的近似交换项之间的竞争决定。能量的总非线性部分是 $E_{\\mathrm{nl}}(N) = U_{1}N^{2} - \\lambda U_{1}N^{4/3}$。精确的交换能本应以一种能够完全抵消来自 Hartree 能量的 $N^2$ 项的方式进行标度。而具有 $N^{4/3}$ 标度关系的 GGA 交换能无法做到这一点。由于凸的 Hartree 项的指数（$2$）大于凹的交换项的指数（$4/3$），Hartree 自相互作用的凸性行为主导了能量曲线的整体形状。GGA 中这种自相互作用的不完全抵消导致了残余的凸曲率，使得总能量 $E^{\\mathrm{GGA}}(N)$ 向下弯曲，低于直线插值。这一现象是许多近似密度泛函中固有的离域误差的一种表现。", "answer": "$$\n\\boxed{-0.04911}\n$$", "id": "2634165"}]}