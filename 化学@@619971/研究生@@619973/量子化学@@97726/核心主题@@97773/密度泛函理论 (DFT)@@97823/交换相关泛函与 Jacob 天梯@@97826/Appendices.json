{"hands_on_practices": [{"introduction": "我们的实践之旅始于雅各布阶梯的第一级：局域密度近似（LDA）。尽管LDA概念简洁，但它存在一个被称为自相互作用误差（SIE）的根本缺陷。本练习将通过一个基础计算来揭示这一问题：您将亲自计算氢原子的LDA交换能，并量化其与精确解的偏差，从而直观地理解为何近似泛函无法完全抵消电子对自身的伪库仑排斥。[@problem_id:2890214]", "problem": "考虑密度泛函近似中雅各布阶梯 (Jacob’s ladder) 的第一级，即科恩-尚 (Kohn–Sham) 密度泛函理论 (DFT) 中用于交换能的局域 (自旋) 密度近似 (LSDA)。对于一个普遍的自旋密度 $(n_{\\uparrow},n_{\\downarrow})$，LSDA 交换泛函定义为\n$$\nE_{x}^{\\mathrm{LSDA}}[n_{\\uparrow},n_{\\downarrow}] \\;=\\; -\\frac{3}{4}\\left(\\frac{3}{\\pi}\\right)^{1/3} \\int \\left(n_{\\uparrow}(\\mathbf{r})^{4/3} + n_{\\downarrow}(\\mathbf{r})^{4/3}\\right)\\, d\\mathbf{r}.\n$$\n对于单电子体系，自旋密度是完全极化的，因此 $n_{\\uparrow}(\\mathbf{r}) = n(\\mathbf{r})$ 且 $n_{\\downarrow}(\\mathbf{r})=0$。单电子体系的精确科恩-尚交换能必须抵消经典的库仑 (Hartree) 自相互作用，其中 Hartree 能量为\n$$\nE_{H}[n] \\;=\\; \\frac{1}{2}\\int \\int \\frac{n(\\mathbf{r})\\,n(\\mathbf{r'})}{|\\mathbf{r}-\\mathbf{r'}|}\\, d\\mathbf{r}\\, d\\mathbf{r'}.\n$$\n因此，对于一个真实的单电子密度，精确交换能为 $E_{x}^{\\mathrm{exact}}[n] = -E_{H}[n]$，且相关能为零。\n\n取氢原子基态（单电子）密度，以原子单位（Hartree 原子单位）表示为\n$$\nn(\\mathbf{r}) \\;=\\; \\frac{1}{\\pi}\\,\\exp(-2 r),\n$$\n其中 $r = |\\mathbf{r}|$ 且玻尔半径 $a_{0}=1$。\n\n从这些定义出发，且不引入任何其他近似，进行必要的积分以：\n1) 计算给定密度的 LSDA 交换能 $E_{x}^{\\mathrm{LSDA}}[n]$，以及\n2) 通过与精确的单电子交换能进行比较，来量化残余交换自相互作用误差，即计算\n$$\n\\Delta_{x} \\;=\\; E_{x}^{\\mathrm{LSDA}}[n] - E_{x}^{\\mathrm{exact}}[n] \\;=\\; E_{x}^{\\mathrm{LSDA}}[n] + E_{H}[n].\n$$\n\n将您的最终答案表示为以哈特里 (hartree) 为单位的精确解析表达式。无需进行数值四舍五入。在最终答案中提供所要求的两个量。", "solution": "该问题陈述经过验证，其科学依据充分、问题设定良好且内部逻辑一致。它给出了一个密度泛函理论中的标准计算，但它指定了 LSDA 泛函的一种形式，计算时必须严格遵守。任务是计算氢原子基态密度的 LSDA 交换能以及相应的残余自相互作用误差。我们继续进行推导。\n\n该问题要求计算两个量：LSDA 交换能 $E_{x}^{\\mathrm{LSDA}}[n]$ 和残余交换自相互作用误差 $\\Delta_{x}$。我们将按顺序计算它们。\n\n首先，我们计算 LSDA 交换能 $E_{x}^{\\mathrm{LSDA}}[n]$。问题中给出了该泛函：\n$$\nE_{x}^{\\mathrm{LSDA}}[n_{\\uparrow},n_{\\downarrow}] \\;=\\; -\\frac{3}{4}\\left(\\frac{3}{\\pi}\\right)^{1/3} \\int \\left(n_{\\uparrow}(\\mathbf{r})^{4/3} + n_{\\downarrow}(\\mathbf{r})^{4/3}\\right)\\, d\\mathbf{r}\n$$\n对于像氢原子这样的单电子体系，自旋密度是完全极化的。我们设置 $n_{\\uparrow}(\\mathbf{r}) = n(\\mathbf{r})$ 和 $n_{\\downarrow}(\\mathbf{r}) = 0$。该泛函简化为：\n$$\nE_{x}^{\\mathrm{LSDA}}[n] \\;=\\; -\\frac{3}{4}\\left(\\frac{3}{\\pi}\\right)^{1/3} \\int n(\\mathbf{r})^{4/3}\\, d\\mathbf{r}\n$$\n氢原子的基态密度以原子单位给出为：\n$$\nn(\\mathbf{r}) \\;=\\; \\frac{1}{\\pi}\\,\\exp(-2 r)\n$$\n其中 $r=|\\mathbf{r}|$。我们将密度取 $4/3$ 次幂：\n$$\nn(\\mathbf{r})^{4/3} \\;=\\; \\left(\\frac{1}{\\pi}\\,\\exp(-2 r)\\right)^{4/3} \\;=\\; \\frac{1}{\\pi^{4/3}}\\,\\exp\\left(-\\frac{8}{3} r\\right)\n$$\n积分遍及整个空间。由于被积函数是球对称的，我们可以使用球坐标对角变量进行积分，得到一个 $4\\pi$ 因子。体积元为 $d\\mathbf{r} = 4\\pi r^2 dr$。\n$$\n\\int n(\\mathbf{r})^{4/3}\\, d\\mathbf{r} \\;=\\; \\int_0^\\infty \\frac{1}{\\pi^{4/3}}\\,\\exp\\left(-\\frac{8}{3} r\\right) (4\\pi r^2)\\,dr \\;=\\; \\frac{4\\pi}{\\pi^{4/3}} \\int_0^\\infty r^2 \\exp\\left(-\\frac{8}{3} r\\right)\\,dr \\;=\\; 4\\pi^{-1/3} \\int_0^\\infty r^2 \\exp\\left(-\\frac{8}{3} r\\right)\\,dr\n$$\n这是一个标准积分，形式为 $\\int_0^\\infty x^n \\exp(-ax)\\,dx = \\frac{n!}{a^{n+1}}$。这里，$n=2$ 且 $a=8/3$。\n$$\n\\int_0^\\infty r^2 \\exp\\left(-\\frac{8}{3} r\\right)\\,dr \\;=\\; \\frac{2!}{(8/3)^3} \\;=\\; \\frac{2}{512/27} \\;=\\; \\frac{54}{512} \\;=\\; \\frac{27}{256}\n$$\n将此结果代回，我们得到积分后的密度项：\n$$\n\\int n(\\mathbf{r})^{4/3}\\, d\\mathbf{r} \\;=\\; 4\\pi^{-1/3} \\left(\\frac{27}{256}\\right) \\;=\\; \\frac{27}{64}\\pi^{-1/3}\n$$\n现在，我们计算 $E_{x}^{\\mathrm{LSDA}}[n]$：\n$$\nE_{x}^{\\mathrm{LSDA}}[n] \\;=\\; -\\frac{3}{4}\\left(\\frac{3}{\\pi}\\right)^{1/3} \\left(\\frac{27}{64}\\pi^{-1/3}\\right) \\;=\\; -\\frac{3 \\cdot 3^{1/3} \\cdot 27}{4 \\cdot 64 \\cdot \\pi^{(1/3+1/3)}} = -\\frac{3^1 \\cdot 3^{1/3} \\cdot 3^3}{256 \\pi^{2/3}} = -\\frac{3^{13/3}}{256\\pi^{2/3}}\n$$\n\n接下来，我们计算残余自相互作用误差 $\\Delta_x = E_{x}^{\\mathrm{LSDA}}[n] + E_{H}[n]$。这需要计算 Hartree 能量 $E_H[n]$。\n$$\nE_{H}[n] \\;=\\; \\frac{1}{2}\\int \\int \\frac{n(\\mathbf{r})\\,n(\\mathbf{r'})}{|\\mathbf{r}-\\mathbf{r'}|}\\, d\\mathbf{r}\\, d\\mathbf{r'}\n$$\n这是电荷分布 $n(\\mathbf{r})$ 的经典静电自能。它可以计算为 $E_H[n] = \\frac{1}{2}\\int n(\\mathbf{r})\\phi(\\mathbf{r})\\,d\\mathbf{r}$，其中 $\\phi(\\mathbf{r})$ 是由密度 $n(\\mathbf{r})$ 产生的静电势。对于球对称密度 $n(r)$，距离原点 $r$ 处的势 $\\phi(r)$ 由下式给出：\n$$\n\\phi(r) \\;=\\; \\frac{1}{r} \\int_0^r n(r')\\,4\\pi r'^2\\,dr' + \\int_r^\\infty \\frac{n(r')\\,4\\pi r'^2}{r'}\\,dr'\n$$\n使用 $n(r') = \\frac{1}{\\pi}\\exp(-2r')$，第一项（半径为 $r$ 的球内电荷除以 $r$）为：\n$$\n\\frac{1}{r} \\int_0^r \\frac{1}{\\pi}\\exp(-2r')\\,4\\pi r'^2\\,dr' = \\frac{4}{r} \\int_0^r r'^2 \\exp(-2r')\\,dr' = \\frac{4}{r} \\left[-\\frac{\\exp(-2r')}{2}(r'^2+r'+1/2)\\right]_0^r = \\frac{1}{r}\\left[1 - \\exp(-2r)(2r^2+2r+1)\\right]\n$$\n第二项（半径为 $r$ 的球外电荷产生的势）为：\n$$\n\\int_r^\\infty \\frac{1}{\\pi}\\exp(-2r')\\,\\frac{4\\pi r'^2}{r'}\\,dr' = 4 \\int_r^\\infty r'\\exp(-2r')\\,dr' = 4\\left[-\\frac{\\exp(-2r')}{2}(r'+1/2)\\right]_r^\\infty = \\exp(-2r)(2r+1)\n$$\n结合这两项，势为：\n$$\n\\phi(r) \\;=\\; \\frac{1}{r} - \\frac{\\exp(-2r)(2r^2+2r+1)}{r} + \\exp(-2r)(2r+1) \\;=\\; \\frac{1}{r} - \\exp(-2r)(2r+2+1/r) + \\exp(-2r)(2r+1) \\;=\\; \\frac{1}{r} - \\exp(-2r)(1+1/r)\n$$\n现在我们可以计算 Hartree 能量：\n$$\nE_H[n] \\;=\\; \\frac{1}{2}\\int_0^\\infty n(r)\\phi(r)\\,4\\pi r^2\\,dr \\;=\\; \\frac{1}{2}\\int_0^\\infty \\left(\\frac{1}{\\pi}\\exp(-2r)\\right) \\left(\\frac{1}{r} - \\exp(-2r)(1+1/r)\\right) 4\\pi r^2\\,dr\n$$\n$$\nE_H[n] \\;=\\; 2 \\int_0^\\infty r^2 \\exp(-2r) \\left(\\frac{1}{r} - \\exp(-2r) - \\frac{\\exp(-2r)}{r}\\right)\\,dr \\;=\\; 2 \\int_0^\\infty \\left(r\\exp(-2r) - r^2\\exp(-4r) - r\\exp(-4r)\\right)\\,dr\n$$\n这个表达式包含三个标准积分：\n$$\n\\int_0^\\infty r\\exp(-2r)\\,dr = \\frac{1!}{2^2} = \\frac{1}{4}\n$$\n$$\n\\int_0^\\infty r^2\\exp(-4r)\\,dr = \\frac{2!}{4^3} = \\frac{2}{64} = \\frac{1}{32}\n$$\n$$\n\\int_0^\\infty r\\exp(-4r)\\,dr = \\frac{1!}{4^2} = \\frac{1}{16}\n$$\n代入这些值：\n$$\nE_H[n] \\;=\\; 2 \\left(\\frac{1}{4} - \\frac{1}{32} - \\frac{1}{16}\\right) \\;=\\; 2 \\left(\\frac{8}{32} - \\frac{1}{32} - \\frac{2}{32}\\right) \\;=\\; 2 \\left(\\frac{5}{32}\\right) \\;=\\; \\frac{5}{16}\n$$\n这个单电子体系的精确交换能为 $E_{x}^{\\mathrm{exact}}[n] = -E_{H}[n] = -5/16$。\n\n最后，残余交换自相互作用误差为：\n$$\n\\Delta_{x} \\;=\\; E_{x}^{\\mathrm{LSDA}}[n] + E_{H}[n] \\;=\\; -\\frac{3^{13/3}}{256\\pi^{2/3}} + \\frac{5}{16}\n$$\n所要求的两个量是 $E_{x}^{\\mathrm{LSDA}}[n]$ 和 $\\Delta_{x}$。", "answer": "$$\n\\boxed{\\begin{pmatrix} -\\dfrac{3^{13/3}}{256\\pi^{2/3}} & \\dfrac{5}{16} - \\dfrac{3^{13/3}}{256\\pi^{2/3}} \\end{pmatrix}}\n$$", "id": "2890214"}, {"introduction": "为了改进LDA，我们登上雅各布阶梯的第二级：广义梯度近似（GGA）。GGA通过引入电子密度的梯度信息，使其能够感知密度的空间变化，从而超越了LDA的“局域”视野。本练习将通过一个理想化的电子密度模型，让您推导出一个简单的GGA泛函所带来的能量修正的解析表达式。通过这个过程，您将清晰地看到约化密度梯度 $s$ 是如何成为区分不同化学环境并改进交换能计算的关键。[@problem_id:2890262]", "problem": "考虑一个在科恩-尚密度泛函理论 (DFT) 框架下描述的自旋非极化电子体系。使用原子单位（能量单位为哈特里，长度单位为玻尔）。设电子密度是球对称的，并由高斯模型给出\n$$\nn(\\mathbf{r}) = n_{0}\\,\\exp\\!\\left(-\\alpha r^{2}\\right),\n$$\n其中参数 $n_{0} > 0$ 且 $\\alpha > 0$。在局域密度近似 (LDA) 中，交换能为\n$$\nE_{x}^{\\mathrm{LDA}} = \\int \\varepsilon_{x}^{\\mathrm{LDA}}(n(\\mathbf{r}))\\,d^{3}\\mathbf{r}, \\quad \\varepsilon_{x}^{\\mathrm{LDA}}(n) = -C_{x}\\,n^{4/3},\n$$\n其中 $C_{x} = \\frac{3}{4}\\left(\\frac{3}{\\pi}\\right)^{1/3}$。在雅各布阶梯的第二级，考虑一个形式如下的广义梯度近似 (GGA) 交换泛函\n$$\nE_{x}^{\\mathrm{GGA}} = \\int \\varepsilon_{x}^{\\mathrm{LDA}}(n(\\mathbf{r}))\\,F_{x}(s(\\mathbf{r}))\\,d^{3}\\mathbf{r},\n$$\n其增强因子为\n$$\nF_{x}(s) = 1 + \\mu\\,s^{2},\n$$\n其中 $\\mu > 0$ 是一个常数，$s(\\mathbf{r})$ 是约化密度梯度\n$$\ns(\\mathbf{r}) = \\frac{|\\nabla n(\\mathbf{r})|}{2\\,k_{F}(\\mathbf{r})\\,n(\\mathbf{r})}, \\qquad k_{F}(\\mathbf{r}) = \\left(3\\pi^{2} n(\\mathbf{r})\\right)^{1/3}.\n$$\n从第一性原理和给定的定义出发，推导交换能差\n$$\n\\Delta E_{x} \\equiv E_{x}^{\\mathrm{GGA}} - E_{x}^{\\mathrm{LDA}}\n$$\n关于 $n_{0}$、$\\alpha$ 和 $\\mu$ 的闭式解析表达式。将你的最终答案以哈特里 (Hartree) 为单位表示为一个简化的单一表达式（无数值近似或四舍五入）。", "solution": "我们从局域密度近似 (LDA) 和广义梯度近似 (GGA) 中交换能的定义开始。对于一个自旋非极化体系，LDA 交换能量密度为\n$$\n\\varepsilon_{x}^{\\mathrm{LDA}}(n) = -C_{x}\\,n^{4/3}, \\qquad C_{x} = \\frac{3}{4}\\left(\\frac{3}{\\pi}\\right)^{1/3}.\n$$\n在雅各布阶梯的第二级，一个 GGA 交换泛函使用一个依赖于约化梯度 $s(\\mathbf{r})$ 的增强因子 $F_{x}(s)$：\n$$\nE_{x}^{\\mathrm{GGA}} = \\int \\varepsilon_{x}^{\\mathrm{LDA}}(n(\\mathbf{r}))\\,F_{x}(s(\\mathbf{r}))\\,d^{3}\\mathbf{r}, \\qquad s(\\mathbf{r}) = \\frac{|\\nabla n(\\mathbf{r})|}{2\\,k_{F}(\\mathbf{r})\\,n(\\mathbf{r})}, \\quad k_{F}(\\mathbf{r}) = \\left(3\\pi^{2}n(\\mathbf{r})\\right)^{1/3}.\n$$\n当 $F_{x}(s) = 1 + \\mu s^{2}$ 时，交换能差为\n$$\n\\Delta E_{x} = E_{x}^{\\mathrm{GGA}} - E_{x}^{\\mathrm{LDA}} = \\int \\varepsilon_{x}^{\\mathrm{LDA}}(n(\\mathbf{r}))\\left(F_{x}(s(\\mathbf{r})) - 1\\right)\\,d^{3}\\mathbf{r} = \\mu \\int \\varepsilon_{x}^{\\mathrm{LDA}}(n(\\mathbf{r}))\\,s(\\mathbf{r})^{2}\\,d^{3}\\mathbf{r}.\n$$\n\n我们现在对给定的密度 $n(\\mathbf{r}) = n_{0}\\exp(-\\alpha r^{2})$ 计算 $s(\\mathbf{r})$。根据球对称性，\n$$\n\\nabla n(\\mathbf{r}) = \\frac{d n}{dr}\\,\\hat{\\mathbf{r}} = -2\\alpha r\\,n(\\mathbf{r})\\,\\hat{\\mathbf{r}}, \\qquad |\\nabla n(\\mathbf{r})| = 2\\alpha r\\,n(\\mathbf{r}).\n$$\n因此，\n$$\ns(\\mathbf{r}) = \\frac{2\\alpha r\\,n(\\mathbf{r})}{2\\,k_{F}(\\mathbf{r})\\,n(\\mathbf{r})} = \\frac{\\alpha r}{k_{F}(\\mathbf{r})} = \\frac{\\alpha r}{\\left(3\\pi^{2} n(\\mathbf{r})\\right)^{1/3}}.\n$$\n因此，\n$$\ns(\\mathbf{r})^{2} = \\frac{\\alpha^{2} r^{2}}{\\left(3\\pi^{2}\\right)^{2/3}}\\,n(\\mathbf{r})^{-2/3}.\n$$\n\n将 $\\varepsilon_{x}^{\\mathrm{LDA}}$ 和 $s^{2}$ 代入 $\\Delta E_{x}$：\n$$\n\\Delta E_{x} = \\mu \\int \\left[-C_{x}\\,n(\\mathbf{r})^{4/3}\\right]\\left[\\frac{\\alpha^{2} r^{2}}{\\left(3\\pi^{2}\\right)^{2/3}}\\,n(\\mathbf{r})^{-2/3}\\right]d^{3}\\mathbf{r} = -\\mu\\,C_{x}\\,\\frac{\\alpha^{2}}{\\left(3\\pi^{2}\\right)^{2/3}} \\int r^{2}\\,n(\\mathbf{r})^{2/3}\\,d^{3}\\mathbf{r}.\n$$\n对于高斯密度，\n$$\nn(\\mathbf{r})^{2/3} = n_{0}^{2/3}\\,\\exp\\!\\left(-\\frac{2}{3}\\alpha r^{2}\\right).\n$$\n在球坐标中 $d^{3}\\mathbf{r} = 4\\pi r^{2}dr$，所以\n$$\n\\int r^{2}\\,n(\\mathbf{r})^{2/3}\\,d^{3}\\mathbf{r} = 4\\pi\\,n_{0}^{2/3}\\int_{0}^{\\infty} r^{4}\\,\\exp\\!\\left(-a r^{2}\\right)\\,dr, \\qquad a \\equiv \\frac{2}{3}\\alpha.\n$$\n对于 $a > 0$ 和整数 $m \\ge 0$ 的标准积分为\n$$\n\\int_{0}^{\\infty} r^{2m}\\,\\exp(-a r^{2})\\,dr = \\frac{1}{2}\\,a^{-(m+1/2)}\\,\\Gamma\\!\\left(m+\\frac{1}{2}\\right),\n$$\n当 $m = 2$ 时，给出\n$$\n\\int_{0}^{\\infty} r^{4}\\,\\exp(-a r^{2})\\,dr = \\frac{1}{2}\\,a^{-5/2}\\,\\Gamma\\!\\left(\\frac{5}{2}\\right) = \\frac{1}{2}\\,a^{-5/2}\\,\\frac{3\\sqrt{\\pi}}{4} = \\frac{3\\sqrt{\\pi}}{8}\\,a^{-5/2}.\n$$\n因此，\n$$\n\\int r^{2}\\,n(\\mathbf{r})^{2/3}\\,d^{3}\\mathbf{r} = 4\\pi\\,n_{0}^{2/3}\\,\\frac{3\\sqrt{\\pi}}{8}\\,a^{-5/2} = \\frac{3\\pi\\sqrt{\\pi}}{2}\\,n_{0}^{2/3}\\,a^{-5/2}.\n$$\n由于 $a = \\frac{2}{3}\\alpha$，我们有 $a^{-5/2} = \\left(\\frac{3}{2}\\right)^{5/2}\\alpha^{-5/2}$。因此，\n$$\n\\int r^{2}\\,n(\\mathbf{r})^{2/3}\\,d^{3}\\mathbf{r} = \\frac{3\\pi\\sqrt{\\pi}}{2}\\,n_{0}^{2/3}\\,\\left(\\frac{3}{2}\\right)^{5/2}\\alpha^{-5/2}.\n$$\n将此代入 $\\Delta E_{x}$：\n$$\n\\Delta E_{x} = -\\mu\\,C_{x}\\,\\frac{\\alpha^{2}}{\\left(3\\pi^{2}\\right)^{2/3}} \\cdot \\frac{3\\pi\\sqrt{\\pi}}{2}\\,n_{0}^{2/3}\\,\\left(\\frac{3}{2}\\right)^{5/2}\\alpha^{-5/2}.\n$$\n合并 $\\alpha$ 的幂次：\n$$\n\\alpha^{2}\\,\\alpha^{-5/2} = \\alpha^{-1/2}.\n$$\n现在简化常数。首先使用\n$$\nC_{x} = \\frac{3}{4}\\left(\\frac{3}{\\pi}\\right)^{1/3}, \\qquad \\frac{C_{x}}{\\left(3\\pi^{2}\\right)^{2/3}} = \\frac{3}{4}\\left(\\frac{3}{\\pi}\\right)^{1/3}\\left(3\\pi^{2}\\right)^{-2/3} = \\frac{3^{1/3} \\cdot 3^{-2/3}}{4} \\pi^{-1/3} \\pi^{-4/3} = \\frac{3^{-1/3}}{4}\\pi^{-5/3}.\n$$\n然后\n$$\n\\Delta E_{x} = -\\mu\\,n_{0}^{2/3}\\,\\alpha^{-1/2}\\left[\\frac{3^{-1/3}}{4}\\,\\pi^{-5/3}\\right]\\left[\\frac{3\\pi\\sqrt{\\pi}}{2}\\right]\\left[\\left(\\frac{3}{2}\\right)^{5/2}\\right].\n$$\n合并 $\\pi$ 的因子：\n$$\n\\pi^{-5/3}\\cdot \\pi\\cdot \\sqrt{\\pi} = \\pi^{-5/3+1+1/2} = \\pi^{-1/6}.\n$$\n合并 $3$ 和 $2$ 的因子：\n$$\n\\frac{3^{-1/3}\\cdot 3 \\cdot 3^{5/2}}{4 \\cdot 2 \\cdot 2^{5/2}} = \\frac{3^{-1/3 + 1 + 5/2}}{2^{2+1+5/2}} = \\frac{3^{19/6}}{2^{11/2}}.\n$$\n因此，\n$$\n\\Delta E_{x} = -\\mu\\,\\frac{3^{19/6}}{2^{11/2}\\,\\pi^{1/6}}\\,n_{0}^{2/3}\\,\\alpha^{-1/2}.\n$$\n该解法有误，重新推导。\n$$\nC_{x} = \\frac{3}{4}\\left(\\frac{3}{\\pi}\\right)^{1/3}.\n$$\n$$\n\\Delta E_x = -\\mu n_0^{2/3} \\alpha^{-1/2} \\left[ \\frac{3}{4}\\left(\\frac{3}{\\pi}\\right)^{1/3} \\frac{1}{(3\\pi^2)^{2/3}} \\frac{3\\pi\\sqrt{\\pi}}{2} \\left(\\frac{3}{2}\\right)^{5/2} \\right].\n$$\n$$\n\\text{Constant part} = \\frac{3}{4} \\frac{3^{1/3}}{\\pi^{1/3}} \\frac{1}{3^{2/3}\\pi^{4/3}} \\frac{3\\pi^{3/2}}{2} \\frac{3^{5/2}}{2^{5/2}} = \\frac{3 \\cdot 3^{1/3} \\cdot 3 \\cdot 3^{5/2}}{4 \\cdot 3^{2/3} \\cdot 2 \\cdot 2^{5/2}} \\frac{\\pi^{3/2}}{\\pi^{1/3}\\pi^{4/3}} = \\frac{3^{1+1/3+1+5/2-2/3}}{2^{2+1+5/2}} \\frac{\\pi^{3/2}}{\\pi^{5/3}} = \\frac{3^{2-1/3+5/2}}{2^{11/2}} \\pi^{3/2-5/3} = \\frac{3^{(12-2+15)/6}}{2^{11/2}} \\pi^{(9-10)/6} = \\frac{3^{25/6}}{2^{11/2}} \\pi^{-1/6}.\n$$\n因此\n$$\n\\Delta E_{x} = -\\mu\\,\\frac{3^{25/6}}{2^{11/2}\\,\\pi^{1/6}}\\,n_{0}^{2/3}\\,\\alpha^{-1/2}.\n$$\n原解答中的简化步骤有误，但最终结果意外正确。修正推导过程。\n将 $\\varepsilon_{x}^{\\mathrm{LDA}}$ 和 $s^{2}$ 代入 $\\Delta E_{x}$：\n$$\n\\Delta E_{x} = \\mu \\int \\left[-C_{x}\\,n(\\mathbf{r})^{4/3}\\right]\\left[\\frac{\\alpha^{2} r^{2}}{\\left(3\\pi^{2}\\right)^{2/3}}\\,n(\\mathbf{r})^{-2/3}\\right]d^{3}\\mathbf{r} = -\\mu\\,C_{x}\\,\\frac{\\alpha^{2}}{\\left(3\\pi^{2}\\right)^{2/3}} \\int r^{2}\\,n(\\mathbf{r})^{2/3}\\,d^{3}\\mathbf{r}.\n$$\n积分项为:\n$$\n\\int r^{2}\\,n(\\mathbf{r})^{2/3}\\,d^{3}\\mathbf{r} = \\frac{3\\pi\\sqrt{\\pi}}{2}\\,n_{0}^{2/3}\\,\\left(\\frac{3}{2}\\right)^{5/2}\\alpha^{-5/2}.\n$$\n代入 $\\Delta E_{x}$：\n$$\n\\Delta E_{x} = -\\mu\\,C_{x}\\,\\frac{\\alpha^{2}}{\\left(3\\pi^{2}\\right)^{2/3}} \\cdot \\frac{3\\pi\\sqrt{\\pi}}{2}\\,n_{0}^{2/3}\\,\\left(\\frac{3}{2}\\right)^{5/2}\\alpha^{-5/2} = -\\mu\\,n_{0}^{2/3}\\,\\alpha^{-1/2} \\left( C_{x} \\frac{1}{(3\\pi^2)^{2/3}} \\frac{3\\pi^{3/2}}{2} \\left(\\frac{3}{2}\\right)^{5/2} \\right).\n$$\n常数部分为:\n$$\n\\left( \\frac{3}{4}\\left(\\frac{3}{\\pi}\\right)^{1/3} \\right) \\left( \\frac{1}{3^{2/3}\\pi^{4/3}} \\right) \\left( \\frac{3\\pi^{3/2}}{2} \\right) \\left( \\frac{3^{5/2}}{2^{5/2}} \\right) = \\frac{3 \\cdot 3^{1/3} \\cdot 3 \\cdot 3^{5/2}}{4 \\cdot 3^{2/3} \\cdot 2 \\cdot 2^{5/2}} \\frac{\\pi^{3/2}}{\\pi^{1/3}\\pi^{4/3}} = \\frac{3^{2-1/3+5/2}}{2^{3+5/2}} \\pi^{3/2-5/3} = \\frac{3^{25/6}}{2^{11/2}} \\pi^{-1/6}.\n$$\n最终表达式为：\n$$\n\\Delta E_{x} = -\\mu\\,\\frac{3^{25/6}}{2^{11/2}\\,\\pi^{1/6}}\\,n_{0}^{2/3}\\,\\alpha^{-1/2}.\n$$\n这是从 LDA 变为具有 $F_{x}(s) = 1 + \\mu s^{2}$ 的特定 GGA 时，交换能变化的所需闭式解析表达式，单位为哈特里。负号与 $s \\ne 0$ 时 $F_{x}(s) > 1$ 的情况一致，这使得 GGA 交换能比 LDA 交换能更具吸引力。", "answer": "$$\\boxed{-\\,\\mu\\,\\frac{3^{25/6}}{2^{11/2}\\,\\pi^{1/6}}\\,n_{0}^{2/3}\\,\\alpha^{-1/2}}$$", "id": "2890262"}, {"introduction": "登上阶梯的第四级，我们遇到了混合泛函，它通过引入一部分精确的Hartree-Fock交换来显著提高计算精度。然而，这种混合并非没有代价，而是一种精妙的权衡。本练习模拟了这种“权衡的艺术”：您将分析增加精确交换的比例如何能够有效减少离域误差，但同时又会加剧静态相关误差。通过这个实践，您将深刻理解设计普适性泛函所面临的核心挑战，以及为何不同比例的混合方案适用于不同类型的问题。[@problem_id:2890240]", "problem": "考虑交换相关近似在 Kohn–Sham 密度泛函理论 (DFT) 中所扮演的角色（其通过 Jacob 阶梯进行组织），特别是考虑引入一部分精确 (Hartree–Fock) 交换以构成全局杂化泛函（第四级）所带来的影响。使用原子单位，因此所有能量均以 hartree 为单位。您将分析两种基于精确约束的误差度量，它们分别用于诊断离域误差和静态相关误差，并且您将对这些误差如何随精确交换组分的引入而变化进行建模。\n\n作为基本依据，请使用以下经过充分检验的事实与定义：\n1) 对于精确泛函，在固定外势下，基态能量作为电子数 $N$ 的函数，在相邻整数之间是分段线性的；对于近似泛函，在整数之间的开区间内对分段线性的偏离可通过曲率 $\\,\\kappa \\equiv \\dfrac{d^{2}E}{dN^{2}}\\,$ 来量化，该曲率对于精确泛函为零。\n2) 对于精确泛函，在氢分子 $\\mathrm{H}_{2}$ 的解离极限下，固定电子数 $N=1$ 时，自旋限制系综的能量作为分数自旋极化 $y$ 的函数是恒定的；对于近似泛函，对恒定性的偏离可通过展开式 $\\,E(y) = E(0) + \\dfrac{1}{2}\\mu\\,y^{2} + O(y^{4})\\,$ 中的二次项系数 $\\,\\mu\\,$ 来量化，该系数对于精确泛函为零。\n3) 全局杂化泛函线性地混合了交换相关贡献：对于混合比例 $a \\in [0,1]$，其交换相关能为 $\\,E_{\\text{xc}}^{(a)} = a\\,E_{x}^{\\text{HF}} + (1-a)\\,E_{\\text{xc}}^{\\text{DFA}}\\,$，其中 Hartree–Fock (HF) 表示精确交换，而密度泛函近似 (Density Functional Approximation, DFA) 表示一个半局域的第二级或第三级泛函。假设 DFA 的相关部分不依赖于 $a$。\n\n对于与两种极限组分相关的两个诊断系数，请使用以下科学上合理、固定的参考值（它们被视为常数，用以表征各组分在指定范围内的响应）：\n- 对于单电子体系中的离域误差（例如，在固定几何构型附近的 $\\mathrm{H}_{2}^{+}$ 问题），曲率常数为 $\\,\\kappa_{\\text{DFA}} = +0.30\\,$ 和 $\\,\\kappa_{\\text{HF}} = -0.20\\,$（单位为 hartree）。\n- 对于在大核间距（例如，$R = 10.0$ bohr）下被拉伸的 $\\mathrm{H}_{2}$ 中的静态相关误差，分数自旋二次项系数为 $\\,\\mu_{\\text{DFA}} = 0.10\\,$ 和 $\\,\\mu_{\\text{HF}} = 0.50\\,$（单位为 hartree）。\n\n任务 A（推导）：仅从上述第 (1)–(3) 项出发，推导混合比例为 $a$ 的杂化混合如何传播至两个诊断系数。具体而言，请用 $a$、$\\,\\kappa_{\\text{DFA}}\\,$、$\\,\\kappa_{\\text{HF}}\\,$、$\\,\\mu_{\\text{DFA}}\\,$ 和 $\\,\\mu_{\\text{HF}}\\,$ 来表示杂化曲率 $\\,\\kappa(a)\\,$ 和杂化分数自旋系数 $\\,\\mu(a)\\,$。然后，将需要报告的量值定义为 $\\,|\\kappa(a)|\\,$（离域误差大小）和 $\\,\\mu(a)\\,$（静态相关误差大小）。\n\n任务 B（计算）：对于一组测试用例，计算 $\\,|\\kappa(a)|\\,$、$\\,\\mu(a)\\,$ 和一个权衡分数\n$$\nS(a) = w_{d}\\,|\\kappa(a)| + w_{s}\\,\\mu(a),\n$$\n其中 $\\,w_{d}\\,$ 和 $\\,w_{s}\\,$ 为非负权重。所有报告的量值都必须以 hartree 为单位。您的程序必须实现任务 A 中推导出的公式，并评估以下测试套件，该套件用于探测边界情况和内部点：\n- 测试 1：$\\,a=0.0\\,$, $\\,w_{d}=1.0\\,$, $\\,w_{s}=1.0\\,$。\n- 测试 2：$\\,a=1.0\\,$, $\\,w_{d}=1.0\\,$, $\\,w_{s}=1.0\\,$。\n- 测试 3：$\\,a=0.25\\,$, $\\,w_{d}=2.0\\,$, $\\,w_{s}=1.0\\,$。\n- 测试 4：$\\,a=0.75\\,$, $\\,w_{d}=1.0\\,$, $\\,w_{s}=2.0\\,$。\n- 测试 5：$\\,a=0.50\\,$, $\\,w_{d}=1.0\\,$, $\\,w_{s}=1.5\\,$。\n\n您的程序应生成单行输出，其中包含所有测试的结果，形式为一个用方括号括起来的、以逗号分隔的列表。每个测试的结果必须是一个三元列表，顺序为 $[\\,|\\kappa(a)|,\\,\\mu(a),\\,S(a)\\,]$，其中每个浮点数四舍五入到六位小数，所有能量单位均为 hartree。例如，整体结构必须为\n$\\,\\big[\\,[x_{1},y_{1},z_{1}],\\,[x_{2},y_{2},z_{2}],\\,\\dots\\,\\big]\\,$,\n打印在同一行且无空格。", "solution": "在继续之前，对问题陈述进行严格验证。\n\n**步骤 1：提取已知条件**\n问题提供了以下定义、常数和任务：\n- **误差度量**：\n    - 离域误差度量：能量相对于电子数 $N$ 的曲率 $\\kappa \\equiv \\dfrac{d^{2}E}{dN^{2}}$。\n    - 静态相关误差度量：能量 $E(y) = E(0) + \\dfrac{1}{2}\\mu\\,y^{2} + O(y^{4})$ 对分数自旋极化 $y$ 的展开式中的二次项系数 $\\mu$。\n- **杂化泛函模型**：对于混合比例 $a \\in [0,1]$，交换相关能定义为 $E_{\\text{xc}}^{(a)} = a\\,E_{x}^{\\text{HF}} + (1-a)\\,E_{\\text{xc}}^{\\text{DFA}}$。\n- **参考常数**（单位为 hartree）：\n    - 曲率：$\\kappa_{\\text{DFA}} = +0.30$, $\\kappa_{\\text{HF}} = -0.20$。\n    - 分数自旋系数：$\\mu_{\\text{DFA}} = 0.10$, $\\mu_{\\text{HF}} = 0.50$。\n- **任务 A（推导）**：将 $\\kappa(a)$ 和 $\\mu(a)$ 推导为 $a$ 和参考常数的函数。将报告的误差大小定义为 $|\\kappa(a)|$ 和 $\\mu(a)$。\n- **任务 B（计算）**：为一组给定的测试用例计算 $|\\kappa(a)|$、$\\mu(a)$ 和权衡分数 $S(a) = w_{d}\\,|\\kappa(a)| + w_{s}\\,\\mu(a)$。\n\n**步骤 2：使用提取的已知条件进行验证**\n该问题在科学上基于 Kohn-Sham 密度泛函理论的原理，特别探讨了杂化泛函的行为，这是现代量子化学的一个核心课题。误差度量 $\\kappa$ 和 $\\mu$ 的定义在研究文献中是标准方法，用于诊断对能量泛函已知精确约束的违背情况。交换相关泛函的线性混合模型即为全局杂化泛函的定义。所提供的数值常数是对半局域 DFA（其存在离域误差，导致 $E(N)$ 曲率是凸的，即 $\\kappa > 0$）和 Hartree-Fock 理论（其由于自相互作用而存在定域误差，导致 $E(N)$ 曲率是凹的，即 $\\kappa < 0$，并且也表现出大的静态相关误差）已知相反误差的物理上合理的表示。该问题是自洽的、适定的，并且没有矛盾或含糊之处。\n\n**步骤 3：结论与行动**\n问题被认定为有效。将提供解答。\n\n---\n\n**任务 A：推导**\n\n这项任务要求推导诊断系数 $\\kappa(a)$ 和 $\\mu(a)$ 对混合比例 $a$ 的函数依赖关系。\n\n在广义 Kohn-Sham (GKS) 框架内，由混合参数为 $a$ 的杂化泛函所描述的系统的总电子能是 GKS 轨道集（或等效地，密度矩阵）的泛函。使用指定的交换相关能定义，总能量泛函为：\n$$E^{(a)} = T_s + V_{ne} + J + E_{\\text{xc}}^{(a)} = T_s + V_{ne} + J + a\\,E_{x}^{\\text{HF}} + (1-a)\\,E_{\\text{xc}}^{\\text{DFA}}$$\n其中所有项都是自洽密度 $\\rho^{(a)}$（或产生该密度的轨道）的泛函。由于 $\\rho^{(a)}$ 对参数 $a$ 存在隐式依赖关系，对 $E^{(a)}$ 的二阶导数进行直接分析是复杂的。\n\n一个标准且物理上合理的简化是援引一个类似于一阶微扰理论的原理。总能量对于围绕自洽解的密度一阶变分是驻定的。因此，在一个很好的近似下，我们可以通过使用一个固定的参考密度（例如，来自纯 DFA 计算的密度 $\\rho^{\\text{DFA}}$）来评估受扰动的泛函，从而分析能量的变化。这导出了如下近似：\n$$E^{(a)}[\\rho^{\\text{DFA}}] \\approx E^{\\text{DFA}}[\\rho^{\\text{DFA}}] + a \\left( E_x^{\\text{HF}}[\\rho^{\\text{DFA}}] - E_{\\text{xc}}^{\\text{DFA}}[\\rho^{\\text{DFA}}] \\right)$$\n该公式表明，能量 $E^{(a)}$ 可被视为混合参数 $a$ 的线性函数。因此，能量对 $a$ 以外的任何参数的导数也将表现出这种线性依赖关系。\n\n对于曲率 $\\kappa(a) = \\frac{d^2E^{(a)}}{dN^2}$，在保持外势固定的情况下，对近似能量表达式求关于电子数 $N$ 的二阶导数，会得到一个关于 $a$ 的线性函数。我们可以通过其在端点 $a=0$ 和 $a=1$ 处的值来确定此函数。\n在 $a=0$ 时，泛函是纯 DFA，因此我们必须有 $\\kappa(0) = \\kappa_{\\text{DFA}}$。\n在 $a=1$ 时，该模型应恢复 HF 极限的性质，因此我们必须有 $\\kappa(1) = \\kappa_{\\text{HF}}$。\n连接这两点的一个线性函数是一个简单的线性插值：\n$$\\kappa(a) = (1-a)\\kappa(0) + a\\kappa(1)$$\n代入已知的端点值，我们得到杂化曲率的最终表达式：\n$$\\kappa(a) = (1-a)\\kappa_{\\text{DFA}} + a\\kappa_{\\text{HF}}$$\n\n同样的推理也适用于静态相关误差度量 $\\mu(a)$。该系数由能量对分数自旋极化 $y$ 的二阶导数在 $y=0$ 处的值得到：$\\mu(a) = \\frac{d^2 E^{(a)}}{dy^2} \\big|_{y=0}$。遵循相同的逻辑，此性质也必须在纯 DFA 和纯 HF 值之间进行线性插值。\n$$\\mu(a) = (1-a)\\mu(0) + a\\mu(1)$$\n代入已知的参考值 $\\mu(0) = \\mu_{\\text{DFA}}$ 和 $\\mu(1) = \\mu_{\\text{HF}}$，可得：\n$$\\mu(a) = (1-a)\\mu_{\\text{DFA}} + a\\mu_{\\text{HF}}$$\n\n**任务 B：计算**\n\n推导出的公式被用于执行计算任务。报告的量值为：离域误差大小 $|\\kappa(a)|$ 和静态相关误差大小 $\\mu(a)$（因为对于 $a \\in [0,1]$，$\\mu(a)$ 是非负的）。权衡分数为 $S(a) = w_{d}\\,|\\kappa(a)| + w_{s}\\,\\mu(a)$。最终答案部分的 Python 程序为指定的测试套件执行这些计算。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the DFT hybrid functional error analysis problem.\n    \"\"\"\n    \n    # Define reference values from the problem statement (in Hartree).\n    kappa_dfa = 0.30\n    kappa_hf = -0.20\n    mu_dfa = 0.10\n    mu_hf = 0.50\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (a, w_d, w_s)\n    test_cases = [\n        (0.0, 1.0, 1.0),   # Test 1\n        (1.0, 1.0, 1.0),   # Test 2\n        (0.25, 2.0, 1.0),  # Test 3\n        (0.75, 1.0, 2.0),  # Test 4\n        (0.50, 1.0, 1.5),  # Test 5\n    ]\n\n    results_for_printing = []\n\n    for case in test_cases:\n        a, w_d, w_s = case\n\n        # Task A: Implement the derived formulas for kappa(a) and mu(a).\n        # kappa(a) = (1-a)*kappa_DFA + a*kappa_HF\n        kappa_a = (1.0 - a) * kappa_dfa + a * kappa_hf\n        \n        # mu(a) = (1-a)*mu_DFA + a*mu_HF\n        mu_a = (1.0 - a) * mu_dfa + a * mu_hf\n\n        # The problem specifies reporting |kappa(a)| for the delocalization error magnitude.\n        abs_kappa_a = np.abs(kappa_a)\n\n        # Task B: Compute the trade-off score S(a).\n        # S(a) = w_d * |kappa(a)| + w_s * mu(a)\n        score_a = w_d * abs_kappa_a + w_s * mu_a\n\n        # Format the result for the current test case as a string \"[x,y,z]\"\n        # with numbers rounded to six decimal places.\n        case_result_str = (\n            f\"[{abs_kappa_a:.6f},{mu_a:.6f},{score_a:.6f}]\"\n        )\n        results_for_printing.append(case_result_str)\n\n    # Final print statement in the exact required format: [[x1,y1,z1],[x2,y2,z2],...]\n    # without any spaces.\n    print(f\"[{','.join(results_for_printing)}]\")\n\nsolve()\n```", "id": "2890240"}]}