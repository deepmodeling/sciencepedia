{"hands_on_practices": [{"introduction": "化学硬度 $\\eta$ 的形式定义涉及能量对电子数的二阶偏导数，这在概念上可能显得抽象。本练习旨在通过有限差分近似，将该定义与可通过计算或实验获得的量——电离势 $I$ 和电子亲和能 $A$ ——联系起来。通过这个实践，你将掌握将理论概念转化为可操作计算量的基本方法。[@problem_id:2879233]", "problem": "考虑在固定外势 $v(\\mathbf{r})$（即，固定的核几何构型与电荷）下，基态电子能量作为电子数 $N$ 的函数 $E(N)$。在概念密度泛函理论 (DFT) 中，化学势定义为 $\\mu = \\left(\\frac{\\partial E}{\\partial N}\\right)_{v}$，全局化学硬度定义为 $\\eta = \\frac{1}{2}\\left(\\frac{\\partial^{2} E}{\\partial N^{2}}\\right)_{v}$。一个经过充分检验的事实是，在固定 $v(\\mathbf{r})$ 时，$E(N)$ 在整数之间是分段线性的，并在整数 $N$ 处表现出导数不连续性。当所有能量都在相同的几何构型下计算时（垂直过程），垂直电离势和电子亲和能分别通过能量差 $I = E(N-1) - E(N)$ 和 $A = E(N) - E(N+1)$ 与能量相关联。\n\n任务：\n1) 在整数 $N$ 处，使用对称三点有限差分近似来计算 $\\left(\\frac{\\partial^{2} E}{\\partial N^{2}}\\right)_{v}$，推导一个用 $I$ 和 $A$ 表示 $\\eta$ 的表达式，该表达式需与上述定义以及固定 $v(\\mathbf{r})$ 的条件相符。\n2) 对于一个特定分子，在单一固定几何构型下的高水平电子结构计算得出的垂直电离势 $I = 9.47~\\text{eV}$ 和垂直电子亲和能 $A = 1.82~\\text{eV}$。计算全局硬度 $\\eta$ 的值（以电子伏特为单位）。将最终数值结果四舍五入至四位有效数字，并以 $\\text{eV}$ 为单位表示答案。", "solution": "问题陈述已经过严格验证，被认为是具有科学依据、内容自洽且提法恰当的。它是在概念密度泛函理论 (DFT) 中的一个标准练习，没有事实错误、矛盾或含糊不清之处。因此，我们将着手解答。\n\n该问题分为两部分。首先，我们必须根据垂直电离势 $I$ 和垂直电子亲和能 $A$ 推导出全局化学硬度 $\\eta$ 的表达式。其次，我们必须使用所提供的数据计算 $\\eta$ 的数值。\n\n第1部分：推导 $\\eta$ 的表达式。\n\n全局化学硬度定义为：\n$$ \\eta = \\frac{1}{2}\\left(\\frac{\\partial^{2} E}{\\partial N^{2}}\\right)_{v} $$\n其中 $E(N)$ 是在固定外势 $v(\\mathbf{r})$ 下，作为电子数 $N$ 的函数的基态电子能量。\n\n题目要求在整数电子数 $N$ 处，使用对称三点有限差分近似来计算二阶偏导数 $\\left(\\frac{\\partial^{2} E}{\\partial N^{2}}\\right)_{v}$。对于函数 $f(x)$ 在点 $x$ 处的二阶导数，其对称三点有限差分近似的一般公式为：\n$$ f''(x) \\approx \\frac{f(x+h) - 2f(x) + f(x-h)}{h^2} $$\n在我们的具体情况中，函数是 $E(N)$，计算点是整数 $N$，步长 $h$ 对应于增加或减少一个电子，因此 $h=1$。将此近似应用于能量函数 $E(N)$，可得：\n$$ \\left(\\frac{\\partial^{2} E}{\\partial N^{2}}\\right)_{v} \\approx \\frac{E(N+1) - 2E(N) + E(N-1)}{1^2} = E(N-1) - 2E(N) + E(N+1) $$\n将此结果代入硬度 $\\eta$ 的定义中，我们得到：\n$$ \\eta \\approx \\frac{1}{2} \\left[ E(N-1) - 2E(N) + E(N+1) \\right] $$\n为了用电离势 $I$ 和电子亲和能 $A$ 来表示它，我们回顾一下它们的定义：\n$$ I = E(N-1) - E(N) $$\n$$ A = E(N) - E(N+1) $$\n这些是用于垂直过程的定义，意味着所有能量都在相同的固定核几何构型下计算，这与固定外势条件 $(\\dots)_{v}$ 是一致的。\n\n我们可以通过重新组合能量项来整理 $\\eta$ 的表达式：\n$$ \\eta \\approx \\frac{1}{2} \\left[ (E(N-1) - E(N)) + (E(N+1) - E(N)) \\right] $$\n第一项 $(E(N-1) - E(N))$ 正是电离势 $I$ 的定义。第二项 $(E(N+1) - E(N))$ 是电子亲和能 $A$ 的负值，因为根据定义 $A = E(N) - E(N+1)$，可得 $E(N+1) - E(N) = -A$。\n\n将这些代入 $\\eta$ 的表达式中，得到所需的关系式：\n$$ \\eta = \\frac{1}{2} (I - A) $$\n这个表达式被称为 Parr-Pearson 硬度近似，是任务第一部分的结果。在此使用等号是合理的，因为在此概念框架内，这个有限差分公式构成了硬度的一个操作性定义。\n\n第2部分：$\\eta$ 的数值计算。\n\n在第二部分，我们被给予一个特定分子的以下数值：\n- 垂直电离势: $I = 9.47~\\text{eV}$\n- 垂直电子亲和能: $A = 1.82~\\text{eV}$\n\n使用上面推导出的公式，我们现在可以计算全局硬度 $\\eta$：\n$$ \\eta = \\frac{1}{2} (9.47~\\text{eV} - 1.82~\\text{eV}) $$\n执行括号内的减法：\n$$ \\eta = \\frac{1}{2} (7.65~\\text{eV}) $$\n最后，完成计算：\n$$ \\eta = 3.825~\\text{eV} $$\n题目要求结果四舍五入至四位有效数字。计算值 $3.825$ 已恰好包含四位有效数字。因此，无需进一步四舍五入。最终答案是 $3.825~\\text{eV}$。", "answer": "$$\n\\boxed{3.825}\n$$", "id": "2879233"}, {"introduction": "掌握了化学势和硬度的计算方法后，一个自然而然的问题是：这些量如何帮助我们理解和预测化学反应性？本练习将引导你推导两个相互作用的化学碎片之间的电荷转移量 $\\Delta N$。通过最小化系统的总能量，你将亲身体验化学势（或电负性）如何驱动电荷流动，而化学硬度又如何抑制这一过程，从而深入理解化学相互作用的核心驱动力。[@problem_id:2879209]", "problem": "两个孤立的片段，标记为 $A$ 和 $B$，其基态电子数分别为 $N_A^{0}$ 和 $N_B^{0}$。它们被置于弱接触状态，使得在保持外势固定的情况下，少量电荷可以在它们之间转移。定义 $\\Delta N$ 为从片段 $B$ 转移到片段 $A$ 的电子数，因此新的电子数为 $N_A = N_A^{0} + \\Delta N$ 和 $N_B = N_B^{0} - \\Delta N$。在小电荷转移范围内进行计算，在该范围内，每个片段的能量关于电子数的二阶展开是准确的。\n\n使用来自概念密度泛函理论（density functional theory (DFT)）的以下基本定义：\n- 片段 $X \\in \\{A,B\\}$ 的化学势 $\\mu_{X}$ 为 $\\mu_{X} = \\left(\\frac{\\partial E_{X}}{\\partial N_{X}}\\right)_{v}$。\n- 片段 $X$ 的化学硬度 $\\eta_{X}$ 为 $\\eta_{X} = \\frac{1}{2}\\left(\\frac{\\partial^{2} E_{X}}{\\partial N_{X}^{2}}\\right)_{v}$。\n- Mulliken–Parr电负性 $\\chi_{X}$ 与化学势的关系为 $\\chi_{X} = -\\mu_{X}$。\n\n假设能量展开中高于二次的项可以忽略不计，并且每个片段的硬度为正。构建该片段对的总能量 $E_{\\text{tot}}(\\Delta N)$，展开至 $\\Delta N$ 的二次项，并确定使 $E_{\\text{tot}}(\\Delta N)$ 最小化的 $\\Delta N$ 的值。将你的最终答案仅用 $\\chi_A$、$\\chi_B$、$\\eta_A$ 和 $\\eta_B$ 表示为一个单一的闭式解析表达式。无需单位。无需数值取舍。", "solution": "任务是从化学势、硬度和电负性的定义出发，在电子数的二次近似下，求得使总能量最小化的电荷转移量 $\\Delta N$。\n\n根据定义，对于固定的外势下的每个片段 $X \\in \\{A,B\\}$，我们将其能量作为电子数 $N_X$ 的函数，在孤立整数 $N_X^{0}$ 附近进行泰勒展开。化学硬度的定义为 $\\eta_{X} = \\frac{1}{2}\\left(\\frac{\\partial^{2} E_{X}}{\\partial N_{X}^{2}}\\right)_{v}$。因此，能量的二阶展开式为：\n$$\nE_X(N_X^{0} + \\delta N_X) \\approx E_X(N_X^{0}) + \\left(\\frac{\\partial E_X}{\\partial N_X}\\right)_{v} \\delta N_X + \\frac{1}{2}\\left(\\frac{\\partial^{2} E_X}{\\partial N_X^{2}}\\right)_{v} (\\delta N_X)^{2}\n$$\n$$\nE_X(N_X^{0} + \\delta N_X) \\approx E_X(N_X^{0}) + \\mu_X \\delta N_X + \\eta_X (\\delta N_X)^{2}\n$$\n其中 $\\mu_X$ 是化学势，$\\eta_X$ 是化学硬度。孤立片段的稳定性意味着 $\\eta_X > 0$。\n\n根据题目中的约定，$\\Delta N$ 是从 $B$ 转移到 $A$ 的电子数，因此\n$$\nN_A = N_A^{0} + \\Delta N \\quad \\Rightarrow \\quad \\delta N_A = \\Delta N\n$$\n$$\nN_B = N_B^{0} - \\Delta N \\quad \\Rightarrow \\quad \\delta N_B = -\\Delta N\n$$\n\n使用两个片段的二次展开，总能量 $E_{\\text{tot}}(\\Delta N) = E_A(N_A) + E_B(N_B)$ 为：\n$$\nE_{\\text{tot}}(\\Delta N) \\approx \\left[E_A(N_A^{0}) + \\mu_A \\Delta N + \\eta_A (\\Delta N)^{2}\\right] + \\left[E_B(N_B^{0}) + \\mu_B (-\\Delta N) + \\eta_B (-\\Delta N)^{2}\\right]\n$$\n将各项合并整理，\n$$\nE_{\\text{tot}}(\\Delta N) \\approx \\left[E_A(N_A^{0}) + E_B(N_B^{0})\\right] + (\\mu_A - \\mu_B) \\Delta N + (\\eta_A + \\eta_B) (\\Delta N)^{2}\n$$\n\n为了找到使能量最小化的 $\\Delta N$，对 $E_{\\text{tot}}$ 关于 $\\Delta N$ 求导并令其为零：\n$$\n\\frac{dE_{\\text{tot}}}{d\\Delta N} = (\\mu_A - \\mu_B) + 2(\\eta_A + \\eta_B) \\Delta N = 0\n$$\n求解 $\\Delta N$ 可得：\n$$\n\\Delta N^{*} = -\\frac{\\mu_A - \\mu_B}{2(\\eta_A + \\eta_B)} = \\frac{\\mu_B - \\mu_A}{2(\\eta_A + \\eta_B)}\n$$\n\n现在使用电负性与化学势之间的关系，$\\chi_X = -\\mu_X$，因此 $\\mu_B - \\mu_A = -\\chi_B - (-\\chi_A) = \\chi_A - \\chi_B$。所以，\n$$\n\\Delta N^{*} = \\frac{\\chi_A - \\chi_B}{2(\\eta_A + \\eta_B)}\n$$\n\n我们可以通过检查二阶导数来验证该驻点是一个极小值点：\n$$\n\\frac{d^{2}E_{\\text{tot}}}{d(\\Delta N)^{2}} = 2(\\eta_A + \\eta_B)\n$$\n根据 $\\eta_A > 0$ 和 $\\eta_B > 0$ 的既定假设，该值为正。因此，上述表达式确实是在二次近似下使能量最小化的电荷转移量。\n\n所求的结果，仅用 $\\chi_A$、$\\chi_B$、$\\eta_A$ 和 $\\eta_B$ 表示为：\n$$\n\\Delta N^{*} = \\frac{\\chi_A - \\chi_B}{2(\\eta_A + \\eta_B)}\n$$", "answer": "$$\\boxed{\\frac{\\chi_A-\\chi_B}{2(\\eta_A+\\eta_B)}}$$", "id": "2879209"}, {"introduction": "在应用密度泛函理论（DFT）进行实际计算时，我们有两种常见的方法来估算电离势 $I$ 和电子亲和能 $A$：一种是通过总能量差（$\\Delta$SCF 方法），另一种是利用前线轨道能量。本练习将让你通过具体数据，量化这两种方法在计算化学硬度时产生的差异。通过这项对比，你将深刻理解近似交换相关泛函的内在缺陷（如自相互作用误差），并学会在应用概念 DFT 理论时，批判性地审视计算结果的可靠性。[@problem_id:2879242]", "problem": "给定一组基态总能量和前线轨道本征值，每一组都是由使用不同交换相关泛函的密度泛函理论 (DFT) 计算，针对相同的中性体系得出的。您的任务是形式化并量化使用总能量差与使用前线轨道本征值对计算全局化学硬度的影响。\n\n从概念密度泛函理论 (DFT) 中的以下基本依据出发：\n- 在固定的外势 $v(\\mathbf{r})$下，零温基态能量，记为 $E(N)$，是关于（可能为分数的）电子数 $N$ 的分段线性函数，在整数 $N$ 处有拐点。\n- 化学势 $\\mu$ 是一阶导数 $\\mu = \\left(\\partial E / \\partial N\\right)_{v}$，在整数 $N$ 处理解为单侧导数。\n- 全局化学硬度 $\\eta$ 是二阶导数 $\\eta = \\frac{1}{2}\\left(\\partial^{2} E / \\partial N^{2}\\right)_{v}$，通过在整数 $N$ 处的有限差分来解释。\n- 电离能 $I$ 和电子亲和能 $A$ 由固定核几何和外势下的基态能量差定义：移除或增加一个电子会使能量发生明确定义的变化。\n\n仅使用这些基础，完成以下任务：\n1. 以整数电子数 $N$、$N-1$ 和 $N+1$ 处的总能量差形式，推导电离能 $I$ 和电子亲和能 $A$ 的表达式。\n2. 在整数 $N$ 处，使用步长 $\\Delta N = 1$ 的对称有限差分构造，推导全局化学硬度 $\\eta$ 关于 $I$ 和 $A$ 的表达式。\n3. 使用 Kohn–Sham 密度泛函理论（KS-DFT; Kohn–Sham）、前线轨道理论和 Janak 定理，得到以中性体系的最高占据分子轨道 (HOMO) 和最低未占分子轨道 (LUMO) 的 Kohn–Sham 本征值表示的 $I$ 和 $A$ 的近似表达式。清楚地陈述您需要对近似泛函的交换相关导数不连续性做出的任何假设。\n4. 定义以下诊断指标，以量化使用前线本征值近似替代总能量差时对全局硬度的影响：\n   - 硬度的绝对偏差，$\\Delta \\eta_{\\mathrm{abs}} = \\left|\\eta_{\\Delta E} - \\eta_{\\mathrm{orb}}\\right|$。\n   - 硬度的相对偏差，$\\Delta \\eta_{\\mathrm{rel}} = \\Delta \\eta_{\\mathrm{abs}} / \\eta_{\\Delta E}$。\n   此处，$\\eta_{\\Delta E}$ 是从总能量差计算的硬度，而 $\\eta_{\\mathrm{orb}}$ 是从前线轨道近似计算的硬度。\n5. 实现一个程序，对于下面的每个测试用例，计算 $I$、$A$、$\\eta_{\\Delta E}$、对 $I$ 和 $A$ 的前线轨道近似值、相应的 $\\eta_{\\mathrm{orb}}$，以及最后的两个诊断指标 $\\Delta \\eta_{\\mathrm{abs}}$ 和 $\\Delta \\eta_{\\mathrm{rel}}$。\n\n所有能量都以电子伏特 (eV) 为单位，所有要求的涉及能量的输出都必须以电子伏特报告。相对偏差是无量纲的。使用以下参数值测试套件（每个对应一个独立的“泛函”标签，但都应作为单独的测试用例处理）：\n\n- 测试用例 $1$ (类 GGA):\n  - $E(N-1) = -90.800\\,\\mathrm{eV}$，$E(N) = -100.000\\,\\mathrm{eV}$，$E(N+1) = -100.800\\,\\mathrm{eV}$\n  - $\\epsilon_{\\mathrm{HOMO}} = -4.700\\,\\mathrm{eV}$，$\\epsilon_{\\mathrm{LUMO}} = +0.800\\,\\mathrm{eV}$\n\n- 测试用例 $2$ (类杂化):\n  - $E(N-1) = -93.300\\,\\mathrm{eV}$，$E(N) = -102.000\\,\\mathrm{eV}$，$E(N+1) = -103.300\\,\\mathrm{eV}$\n  - $\\epsilon_{\\mathrm{HOMO}} = -7.200\\,\\mathrm{eV}$，$\\epsilon_{\\mathrm{LUMO}} = -0.300\\,\\mathrm{eV}$\n\n- 测试用例 $3$ (类范围分离杂化):\n  - $E(N-1) = -91.900\\,\\mathrm{eV}$，$E(N) = -101.000\\,\\mathrm{eV}$，$E(N+1) = -102.000\\,\\mathrm{eV}$\n  - $\\epsilon_{\\mathrm{HOMO}} = -9.000\\,\\mathrm{eV}$，$\\epsilon_{\\mathrm{LUMO}} = -1.200\\,\\mathrm{eV}$\n\n- 测试用例 $4$ (类 LDA，具有负电子亲和能):\n  - $E(N-1) = -91.000\\,\\mathrm{eV}$，$E(N) = -99.000\\,\\mathrm{eV}$，$E(N+1) = -98.500\\,\\mathrm{eV}$\n  - $\\epsilon_{\\mathrm{HOMO}} = -3.500\\,\\mathrm{eV}$，$\\epsilon_{\\mathrm{LUMO}} = +1.000\\,\\mathrm{eV}$\n\n- 测试用例 $5$ (类 meta-GGA，具有近零电子亲和能):\n  - $E(N-1) = -113.000\\,\\mathrm{eV}$，$E(N) = -120.000\\,\\mathrm{eV}$，$E(N+1) = -120.000\\,\\mathrm{eV}$\n  - $\\epsilon_{\\mathrm{HOMO}} = -4.000\\,\\mathrm{eV}$，$\\epsilon_{\\mathrm{LUMO}} = 0.000\\,\\mathrm{eV}$\n\n您的程序必须为每个测试用例计算列表 $[\\eta_{\\Delta E}, \\eta_{\\mathrm{orb}}, \\Delta \\eta_{\\mathrm{abs}}, \\Delta \\eta_{\\mathrm{rel}}]$，并按此顺序排列，其中：\n- $\\eta_{\\Delta E}$ 和 $\\eta_{\\mathrm{orb}}$ 的单位是 $\\mathrm{eV}$，必须四舍五入到 $6$ 位小数。\n- $\\Delta \\eta_{\\mathrm{abs}}$ 的单位是 $\\mathrm{eV}$，必须四舍五入到 $6$ 位小数。\n- $\\Delta \\eta_{\\mathrm{rel}}$ 是无量纲的，必须四舍五入到 $6$ 位小数。\n\n最终输出格式：您的程序应生成一行输出，包含一个由列表组成的逗号分隔列表，其中每个内部列表对应一个测试用例，例如 $[[\\cdots],[\\cdots],\\ldots]$。输出行中不允许有多余的空格或文本。", "solution": "问题陈述经分析，被认为是科学上合理的、定义良好、客观且内部一致的。它提出了概念密度泛函理论 (DFT) 领域中的一个有效任务。我们开始进行解答。\n\n该问题要求系统地比较计算全局化学硬度 $\\eta$ 的两种方法。第一种方法依赖于总能量差 ($\\Delta E$)，而第二种方法依赖于前线 Kohn-Sham 轨道本征值。此分析通过从第一性原理推导相关表达式，然后将其应用于所提供的数据集来执行。\n\n### 1. 基于总能量的电离能 ($I$) 与电子亲和能 ($A$)\n\n根据定义，垂直电离能 $I$ 是在固定的核几何结构下，从一个有 $N$ 个电子的体系中移除一个电子所需的能量。它是 $(N-1)$ 电子体系和 $N$ 电子体系基态之间的能量差。\n\n$$I = E(N-1) - E(N)$$\n\n类似地，垂直电子亲和能 $A$ 是向 $N$ 电子体系中添加一个电子时释放的能量。它是 $N$ 电子体系和 $(N+1)$ 电子体系基态之间的能量差。$A$ 的正值表明阴离子相对于中性物种是稳定的。\n\n$$A = E(N) - E(N+1)$$\n\n假定所提供的能量 $E(N-1)$、$E(N)$ 和 $E(N+1)$ 是相应电子数的真实基态能量，则在给定框架内，这些关于 $I$ 和 $A$ 的表达式是精确的。\n\n### 2. 基于 $I$ 和 $A$ 的全局硬度 ($\\eta$)\n\n全局化学硬度 $\\eta$ 定义为在恒定外势 $v(\\mathbf{r})$ 下，能量 $E$ 相对于电子数 $N$ 的二阶导数的一半。\n\n$$\\eta = \\frac{1}{2} \\left(\\frac{\\partial^2 E}{\\partial N^2}\\right)_v$$\n\n为了对整数电子数 $N$ 求值，我们必须使用有限差分近似，因为函数 $E(N)$ 是分段线性的，在整数 $N$ 处的导数不连续。我们使用步长 $\\Delta N = 1$ 构建一个对称的二阶有限差分。\n\n一阶导数 $\\left(\\partial E / \\partial N\\right)_v$ 是化学势 $\\mu$。在整数 $N$ 处，有两个单侧导数：\n- 从右侧的导数 $(N \\to N+1)$：$\\mu^+ = \\frac{E(N+1)-E(N)}{(N+1)-N} = E(N+1)-E(N) = -A$。\n- 从左侧的导数 $(N \\to N-1)$：$\\mu^- = \\frac{E(N)-E(N-1)}{N-(N-1)} = E(N)-E(N-1) = -I$。\n\n二阶导数是一阶导数的变化率。使用以 $N$ 为中心的中心差分：\n\n$$\\left(\\frac{\\partial^2 E}{\\partial N^2}\\right)_v \\approx \\frac{\\mu^+ - \\mu^-}{1} = (-A) - (-I) = I - A$$\n\n将此代入硬度的定义，得到基于总能量差的硬度表达式，我们记为 $\\eta_{\\Delta E}$：\n\n$$\\eta_{\\Delta E} = \\frac{1}{2}(I - A)$$\n\n结合 $I$ 和 $A$ 的表达式，我们得到：\n\n$$\\eta_{\\Delta E} = \\frac{1}{2}([E(N-1) - E(N)] - [E(N) - E(N+1)]) = \\frac{E(N-1) + E(N+1) - 2E(N)}{2}$$\n\n该表达式代表歧化反应（$2M \\rightarrow M^+ + M^-$）能隙的一半。\n\n### 3. 基于前线轨道的 $I$ 和 $A$ 近似\n\n在 Kohn-Sham (KS) DFT 框架内，Janak 定理指出，总能量对第 $i$ 个 KS 轨道占据数 $n_i$ 的导数等于该轨道的本征值 $\\epsilon_i$。\n\n$$\\frac{\\partial E}{\\partial n_i} = \\epsilon_i$$\n\n对于精确的交换相关 (XC) 泛函，可以证明电离能恰好是最高占据分子轨道 (HOMO) 能量的负值：$I = -\\epsilon_{\\mathrm{HOMO}}$。然而，电子亲和能的关系因 XC 势的导数不连续性 $\\Delta_{xc}$ 而变得复杂，这导致最低未占分子轨道 (LUMO) 的能量 $\\epsilon_{\\mathrm{LUMO}}$ 在其占据数从 $0$ 变为非零值时发生不连续的移动。\n\n对于近似的 XC 泛函，如局部密度近似 (LDA) 和广义梯度近似 (GGAs)，这种导数不连续性几乎为零。这导致 KS 轨道能隙 ($\\epsilon_{\\mathrm{LUMO}}-\\epsilon_{\\mathrm{HOMO}}$) 严重低估了基本能隙 ($I-A$)。尽管存在这一已知缺陷，一种常见的做法是采用类似 Koopmans 的近似来计算 $I$ 和 $A$。\n\n**假设：** 我们假设所使用的 XC 泛函具有可忽略的导数不连续性。这使得电离能和电子亲和能可以直接从 $N$ 电子中性体系的 HOMO 和 LUMO 本征值近似得到。\n\n在此假设下，我们有：\n\n$$I_{\\mathrm{orb}} \\approx -\\epsilon_{\\mathrm{HOMO}}$$\n$$A_{\\mathrm{orb}} \\approx -\\epsilon_{\\mathrm{LUMO}}$$\n\n使用这些基于轨道的 $I$ 和 $A$ 近似，我们可以定义一个基于轨道的硬度 $\\eta_{\\mathrm{orb}}$：\n\n$$\\eta_{\\mathrm{orb}} = \\frac{1}{2}(I_{\\mathrm{orb}} - A_{\\mathrm{orb}}) = \\frac{1}{2}((-\\epsilon_{\\mathrm{HOMO}}) - (-\\epsilon_{\\mathrm{LUMO}}))$$\n\n$$\\eta_{\\mathrm{orb}} = \\frac{\\epsilon_{\\mathrm{LUMO}} - \\epsilon_{\\mathrm{HOMO}}}{2}$$\n\n这表明，在这些近似下，硬度就是 HOMO-LUMO 能隙的一半。$\\eta_{\\Delta E}$ 和 $\\eta_{\\mathrm{orb}}$ 之间的差异是近似 XC 泛函缺陷的直接后果，特别是其自相互作用误差和缺乏导数不连续性。\n\n### 4. 诊断偏差\n\n为了量化两种计算硬度方法之间的差异，我们使用问题陈述中定义的诊断度量。\n\n- 硬度的绝对偏差：\n  $$\\Delta \\eta_{\\mathrm{abs}} = |\\eta_{\\Delta E} - \\eta_{\\mathrm{orb}}|$$\n\n- 硬度的相对偏差：\n  $$\\Delta \\eta_{\\mathrm{rel}} = \\frac{\\Delta \\eta_{\\mathrm{abs}}}{\\eta_{\\Delta E}}$$\n这假设 $\\eta_{\\Delta E} \\neq 0$，对于所有给定的测试用例都成立，因为能量 $E(N)$ 是凸的。\n\n现在将使用推导出的公式为每个测试用例计算这些指标。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the DFT hardness problem by calculating and comparing hardness values\n    derived from total energy differences and frontier orbital energies.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each tuple contains: (E(N-1), E(N), E(N+1), e_homo, e_lumo) in eV.\n    test_cases = [\n        # Test case 1 (GGA-like)\n        (-90.800, -100.000, -100.800, -4.700, 0.800),\n        # Test case 2 (hybrid-like)\n        (-93.300, -102.000, -103.300, -7.200, -0.300),\n        # Test case 3 (range-separated hybrid-like)\n        (-91.900, -101.000, -102.000, -9.000, -1.200),\n        # Test case 4 (LDA-like with negative electron affinity)\n        (-91.000, -99.000, -98.500, -3.500, 1.000),\n        # Test case 5 (meta-GGA-like with near-zero electron affinity)\n        (-113.000, -120.000, -120.000, -4.000, 0.000),\n    ]\n\n    all_results = []\n    for case in test_cases:\n        e_n_minus_1, e_n, e_n_plus_1, eps_homo, eps_lumo = case\n\n        # 1. Calculate properties from total energy differences (Delta E method).\n        # Ionization energy I = E(N-1) - E(N)\n        i_delta_e = e_n_minus_1 - e_n\n        # Electron affinity A = E(N) - E(N+1)\n        a_delta_e = e_n - e_n_plus_1\n        # Hardness eta_delta_e = (I - A) / 2\n        eta_delta_e = (i_delta_e - a_delta_e) / 2.0\n\n        # 2. Calculate properties from frontier orbital eigenvalues (Orbital method).\n        # Hardness eta_orb = (epsilon_LUMO - epsilon_HOMO) / 2\n        eta_orb = (eps_lumo - eps_homo) / 2.0\n\n        # 3. Calculate the diagnostic deviations.\n        # Absolute deviation\n        delta_eta_abs = abs(eta_delta_e - eta_orb)\n        # Relative deviation\n        # The problem setup ensures eta_delta_e is non-zero.\n        delta_eta_rel = delta_eta_abs / eta_delta_e if eta_delta_e != 0 else 0.0\n\n        # 4. Format results to 6 decimal places as strings.\n        case_results = [\n            f\"{eta_delta_e:.6f}\",\n            f\"{eta_orb:.6f}\",\n            f\"{delta_eta_abs:.6f}\",\n            f\"{delta_eta_rel:.6f}\",\n        ]\n        all_results.append(case_results)\n\n    # 5. Format the final output string as a comma-separated list of lists.\n    # e.g., [[val1,val2,...],[val1,val2,...]]\n    inner_lists_str = [f\"[{','.join(res)}]\" for res in all_results]\n    final_output_str = f\"[{','.join(inner_lists_str)}]\"\n\n    print(final_output_str)\n\nsolve()\n```", "id": "2879242"}]}