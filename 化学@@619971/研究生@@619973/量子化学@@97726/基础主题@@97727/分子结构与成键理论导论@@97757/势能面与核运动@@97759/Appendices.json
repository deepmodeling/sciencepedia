{"hands_on_practices": [{"introduction": "在深入研究核运动之前，我们首先需要构建其发生的“舞台”：势能面（PES）。本实践将挑战你像一位现代计算化学家一样思考，从第一性原理数据出发，规划一个完整且有原则的工作流程来构建一个全局、高保真度的势能面。通过关注基本物理对称性，例如相同原子核的置换不变性，你将为创建不仅精确而且具有物理意义的势能面制定一个蓝图。[@problem_id:2917132]", "problem": "你的任务是在 Born–Oppenheimer (BO) 框架内，为一个含有相同原子的多原子分子（为具体起见，考虑甲烷 $ \\mathrm{CH_4} $，其质子标签在物理上是不可区分的）构建一个全局基态势能面。在 BO 框架下，势能面是电子基态能量 $ E(\\mathbf{R}) $ 作为 $ N $ 个原子核的 $ 3N $ 维核坐标矢量 $ \\mathbf{R} $ 的函数。精确的 $ E(\\mathbf{R}) $ 在 $ \\mathbf{R} $ 的整体平移和旋转，以及任何属于相同原子核的坐标置换下是不变的；任何拟合表示都必须遵循这些对称性。你可以获取从头算数据：在采样构型 $ \\{ \\mathbf{R}_i \\} $ 处的能量 $ E(\\mathbf{R}_i) $ 和核梯度 $ \\nabla_{\\mathbf{R}} E(\\mathbf{R}_i) $。目标表示是一个置换不变多项式 (Permutationally Invariant Polynomial, PIP)，即一个关于内坐标特征的多项式，它在相同原子核的置换下是精确不变的。\n\n请选择所有构成一个有效的、对称性一致的、且有原则的工作流程的选项，以获得一个可用于驱动核运动（例如，经典动力学或核量子动力学）的全局 PIP 拟合，该流程需从第一性原理和经过充分检验的事实出发。你的推理应依据：(i) $ E(\\mathbf{R}) $ 的 BO 定义，(ii) 电子哈密顿量所蕴含的不变性，以及 (iii) 将支配核运动的力 $ \\mathbf{F}(\\mathbf{R}) = - \\nabla_{\\mathbf{R}} E(\\mathbf{R}) $ 识别出来。\n\nA. 通过在平衡结构附近的狭窄区域内进行随机笛卡尔位移来采样 $ \\mathbf{R} $，只计算 $ E(\\mathbf{R}) $，并用一个关于 $ 3N $ 个笛卡尔分量的普通多项式进行拟合，不移除平移或旋转，也不施加任何对称性约束。通过对多项式求导以获得 $ \\nabla_{\\mathbf{R}} E(\\mathbf{R}) $ 来进行验证，并检查拟合出的力在最小值附近是否平滑。\n\nB. 生成一个涵盖化学相关区域的设计 $ \\{ \\mathbf{R}_i \\} $，包括近平衡区、过渡态邻域和解离通道，方法是使用内坐标提议（例如，键的拉伸、角度的弯曲）和在 $ 3N - 6 $ 维内坐标子空间（对于非线性分子）中的随机位移。计算 $ E(\\mathbf{R}_i) $ 和 $ \\nabla_{\\mathbf{R}} E(\\mathbf{R}_i) $。构建一个内坐标特征（例如，原子间距离 $ r_{ab} $ 和角度余弦的函数）的基，通过对称化使其在相同原子的置换群下显式不变，并通过最小化一个用单位一致的权重对能量和梯度残差进行加权的复合损失函数来拟合线性 PIP 展开。使用正则化以避免过拟合，并在与对称性相关的留出集上进行验证。\n\nC. 为降低计算成本，通过在粗糙的笛卡尔网格上对从头算能量进行有限差分近似来计算梯度 $ \\nabla_{\\mathbf{R}} E(\\mathbf{R}_i) $，并用笛卡尔坐标下的通用核回归器进行拟合。置换不变性无需强制执行，因为核回归器可以逼近任何平滑函数，并将从数据中隐式地学习对称性。验证可以仅限于复现能量；力无需匹配。\n\nD. 从 BO 电子基态出发。通过沿简正模式扰动平衡构型来构建初始点集 $ \\{ \\mathbf{R}_i \\} $，以覆盖宽广的能量范围，并增加沿反应坐标和在大分离距离下的构型，以捕捉正确的渐近行为。使用一致的从头算方法计算 $ E(\\mathbf{R}_i) $ 和 $ \\nabla_{\\mathbf{R}} E(\\mathbf{R}_i) $。将 $ \\mathbf{R} $ 映射到一组内蕴的、旋转和平移不变的描述符，然后在基函数构建阶段，通过强制执行相关置换群（例如，对于四个氢原子的 $ S_4 $ 群）下的不变性来构建 PIP 基。通过一个正则化的最小二乘问题确定系数，该问题同时以适当的权重匹配能量和梯度，并通过检查与对称性相关的预测以及驻点处的局域曲率（例如，由 Hessian 矩阵导出的谐振频率）进行验证。\n\nE. 对组合的能量和梯度数据，拟合一个无约束的笛卡尔坐标多项式。训练后，通过对所有应用于输入坐标的相同原子的置换，对拟合的多项式进行平均，来强制执行置换不变性；这消除了对内坐标或不变基的需求。旋转和平移不变性可以忽略，因为拟合后的置换平均可确保最终模型是物理的。\n\n选择所有适用项。", "solution": "我们从 Born–Oppenheimer (BO) 分离出发，其中总的分子哈密顿量被近似为一个由核坐标 $ \\mathbf{R} $ 参数化的电子哈密顿量 $ \\hat{H}_e(\\mathbf{r}; \\mathbf{R}) $，从而产生电子基态能量 $ E(\\mathbf{R}) $，它定义了原子核运动所在的势能面 (PES)。电子哈密顿量在 $ \\mathbf{R} $ 的整体平移和旋转，以及与物理上不可区分的原子核相关联的坐标的置换下是不变的。因此，精确的 PES 满足：\n- $ E(\\mathbf{R}) = E(\\mathbf{R} + \\mathbf{a}) $ 对于任意平移 $ \\mathbf{a} $，\n- $ E(\\mathbf{R}) = E(\\mathbf{Q}\\mathbf{R}) $ 对于 $ \\mathrm{SO}(3) $ 中的任意整体旋转 $ \\mathbf{Q} $，\n- $ E(\\mathbf{R}) = E(P \\cdot \\mathbf{R}) $ 对于置换相同原子核的对称群中的任意置换 $ P $。\n\n核运动由力 $ \\mathbf{F}(\\mathbf{R}) = - \\nabla_{\\mathbf{R}} E(\\mathbf{R}) $ 支配，这些力直接出现在经典动力学的牛顿方程中，以及在核量子动力学中的核动能加势能算符中。根据 Hellmann–Feynman (HF) 定理，当电子波函数充分收敛时，从头算梯度 $ \\nabla_{\\mathbf{R}} E(\\mathbf{R}) $ 提供了具有物理意义的力。在拟合中同时包含 $ E(\\mathbf{R}) $ 和 $ \\nabla_{\\mathbf{R}} E(\\mathbf{R}) $ 可以提高斜率和曲率的局域准确性，并在全局范围内约束拟合。\n\n置换不变多项式 (Permutationally Invariant Polynomial, PIP) 是通过构建内坐标特征（例如，原子间距离 $ r_{ab} $ 或其平滑变换，以及角度余弦）的多项式基函数，并在相关置换群下对这些基函数进行对称化而构造的，从而使每个基元都精确不变。使用内坐标消除了对整体旋转和平移的显式依赖；采用对称化的基函数确保了在相同原子核的置换下的精确相等性。拟合通常涉及求解一个正则化的最小二乘问题，该问题最小化一个如下的复合损失函数：\n\n$$\n\\mathcal{L} = w_E \\sum_i \\big( E_{\\text{fit}}(\\mathbf{R}_i) - E_{\\text{ref}}(\\mathbf{R}_i) \\big)^2 + w_g \\sum_i \\big\\| \\nabla_{\\mathbf{R}} E_{\\text{fit}}(\\mathbf{R}_i) - \\nabla_{\\mathbf{R}} E_{\\text{ref}}(\\mathbf{R}_i) \\big\\|^2 + \\lambda \\| \\mathbf{c} \\|^2 ,\n$$\n\n其中 $ w_E $ 和 $ w_g $ 确保单位一致性，$ \\lambda $ 是针对系数 $ \\mathbf{c} $ 的 Tikhonov 正则化参数。为实现全局保真度，训练集必须采样近平衡区、过渡态区域和远离平衡的构型，包括解离极限，以使拟合遵循正确的渐近行为。\n\n我们现在分析每个选项。\n\n选项 A:\n- 直接使用笛卡尔分量，并且不移除整体旋转或平移。这与 $ E(\\mathbf{R}) $ 的不变性相矛盾；一个通用的笛卡尔坐标多项式会虚假地依赖于取向和位置。\n- 忽略了相同原子核的置换对称性，因此对于一个置换 $ P $，通常有 $ E(\\mathbf{R}) \\neq E(P \\cdot \\mathbf{R}) $。\n- 仅在最小值附近采样，这无法支持一个全局 PES，并且会导致在微小邻域之外的核运动外推效果很差。\n- 只拟合能量，失去了来自力的约束，并且只验证“平滑性”，这不是一个基于物理的标准。\n结论：不正确。\n\n选项 B:\n- 设计的 $ \\{ \\mathbf{R}_i \\} $ 涵盖了广泛的构型，包括反应和解离区域。这对于全局 PES 是必需的。\n- 对非线性分子使用 $ 3N - 6 $ 维子空间中的内坐标来移除旋转和平移，从而满足这些不变性。\n- 计算能量 $ E(\\mathbf{R}_i) $ 和梯度 $ \\nabla_{\\mathbf{R}} E(\\mathbf{R}_i) $；后者通过 $ \\mathbf{F}(\\mathbf{R}) = - \\nabla_{\\mathbf{R}} E(\\mathbf{R}) $ 编码了力，提高了对核运动的保真度。\n- 通过在相同原子的置换群下进行显式对称化来构建 PIP 基，从而通过构造保证了精确的置换不变性。\n- 通过适当的加权和正则化来最小化一个复合的能量加梯度损失，这是一种有原则且广泛使用的方法。\n- 在与对称性相关的留出集上进行验证，直接测试不变性和迁移性。\n结论：正确。\n\n选项 C:\n- 在笛卡尔空间的粗糙网格上通过能量的有限差分计算梯度；除非网格极细，否则这种近似会增加数值噪声和偏差，这违背了获得可靠 $ \\nabla_{\\mathbf{R}} E(\\mathbf{R}) $ 的既定目标。\n- 在笛卡尔坐标下拟合一个通用核，而不强制执行不变性。除非核函数和输入是为此而专门构造的，否则核回归器不会自动满足置换不变性，也不会移除平移和旋转自由度。\n- 在验证中省略了力的匹配，尽管力对于核运动至关重要。\n结论：不正确。\n\n选项 D:\n- 将构造建立在 BO 基础上，并沿简正模式和反应坐标进行采样，同时包含大分离距离以捕捉渐近通道；这支持了全局保真度。\n- 计算一致的从头算 $ E(\\mathbf{R}_i) $ 和 $ \\nabla_{\\mathbf{R}} E(\\mathbf{R}_i) $，利用 HF 力来约束拟合。\n- 转换为内蕴的、旋转和平移不变的描述符，并通过在基函数层面强制执行置换不变性来构建 PIP 基（例如，对 $ \\mathrm{CH_4} $ 中的四个氢原子使用 $ S_4 $ 群的作用）。\n- 通过对能量和梯度进行带适当权重的正则化最小二乘拟合来确定系数，这是一个有原则且稳定的过程。\n- 使用对称性检查和局域曲率（由 Hessian 矩阵导出的谐振频率）进行验证，这直接关系到核振动性质。\n结论：正确。\n\n选项 E:\n- 拟合一个无约束的笛卡尔坐标多项式，然后对拟合的函数在所有置换上进行平均。虽然置换平均可以在事后强制执行置换不变性，但它没有解决旋转和平移不变性的问题，由于输入是笛卡尔坐标，这些不变性仍然被违反。\n- 拟合后对称化不能保证得到的模型能够最优地匹配能量和梯度；它还可能破坏在拟合过程中学到的力的一致性，因为该操作是在系数优化之后应用的，而不是在基函数构建阶段强制执行的。\n- 明确排除了对内坐标或不变基的需求，并忽略了旋转/平移不变性，这与 $ E(\\mathbf{R}) $ 所要求的对称性相矛盾。\n结论：不正确。\n\n因此，有效的、对称性一致的、且有原则的工作流程是选项 B 和 D 中描述的那些。", "answer": "$$\\boxed{BD}$$", "id": "2917132"}, {"introduction": "一旦势能面被确立，核的运动就由作用在其上的力所支配，这个力定义为能量的负梯度，即 $\\mathbf{F} = - \\nabla E(\\mathbf{R})$。本实践将深入探讨在实际量子化学计算中使用原子中心基组时的一个关键微妙之处：这些力的来源。你将推导并量化“Pulay 力”，这是一个源于基组不完备性的重要修正项，从而更深刻地理解在量子世界中力是如何被计算及其代表的意义。[@problem_id:2917146]", "problem": "在 Born–Oppenheimer 近似中，固定原子核位置下的电子能量 $E$ 是通过求解一个带有正交归一性约束的稳态变分问题得到的，该问题针对非正交原子轨道（AO）基组中的分子轨道（MO）系数。考虑一个带有正交归一性约束 $C^{\\top} S C = I$ 的 Hartree–Fock (HF) 或 Kohn-Sham 密度泛函理论 (DFT) 的拉格朗日量，其中 $C$ 是原子轨道到分子轨道的系数矩阵，$S$ 是原子轨道重叠矩阵。坐标为 $R$ 的原子核所受的力为 $F = -\\partial E / \\partial R$，并且在依赖于位置的基组（如高斯函数）中，该力包含一个依赖于 $\\partial S/\\partial R$ 的 Pulay 项。\n\n任务1（推导）：从带有正交归一性约束的稳态拉格朗日量出发，并且仅使用 (i) 电子能量在自洽时对轨道变分是稳态的，以及 (ii) 基组通过 $S(R)$ 依赖于 $R$ 这两点，推导沿原子核坐标 $R$ 的 Pulay 力贡献，其形式为包含重叠矩阵导数的迹。你的推导必须用能量加权密度矩阵 $E_{\\mu\\nu}^{\\mathrm{AO}}$ 和 $\\partial S_{\\mu\\nu}/\\partial R$ 来表示 Pulay 力，不得引用任何预先记下的最终力公式。\n\n任务2（特化为最小双函数高斯模型）：考虑一个单电子同核双原子阳离子，其具有两个位于 $x$ 轴上 $\\pm R/2$ 处的相同、归一化的 $s$ 型高斯基元原子轨道（AOs）$\\{\\chi_A,\\chi_B\\}$，具有相同的指数 $\\alpha$。假设：\n- AO 重叠为 $S(R) = \\exp(-\\alpha R^{2}/2)$。\n- 导数为 $\\frac{dS}{dR} = -\\alpha R \\exp(-\\alpha R^{2}/2)$。\n- 对 AO 哈密顿矩阵使用 Wolfsberg–Helmholtz (WH) 近似，$H_{AB}(R) = K\\,S(R)\\,[H_{AA}(R) + H_{BB}(R)]/2$，并取一个同核常数单电子对角元 $H_{AA}(R) = H_{BB}(R) = h$，因此 $H(R) = \\begin{pmatrix} h & k\\,S(R) \\\\ k\\,S(R) & h \\end{pmatrix}$，其中 $k = K h$。\n- 求解广义本征值问题 $(H - \\varepsilon S)c = 0$ 以得到成键态，并使用归一化的对称 MO。\n\n使用这些假设，将沿核间距 $R$ 的 Pulay 力完全用 $h$，$k$，$\\alpha$ 和 $S(R)$ 表示。\n\n任务3（数值计算）：使用原子单位（能量单位为 Hartree，长度单位为 bohr），在给定的几何构型和参数下，计算沿 $R$ 的 Pulay 力：\n- $\\alpha = 1.0\\,\\mathrm{bohr}^{-2}$，\n- $h = -0.500\\,\\mathrm{Hartree}$，\n- $K = 1.75$，因此 $k = K h$，\n- $R = 2.000\\,\\mathrm{bohr}$。\n将 Pulay 力的最终数值答案四舍五入到四位有效数字。以原子单位（Hartree/bohr）表示该力。最终答案必须是一个数字。", "solution": "所给问题是量子化学中解析导数理论的一个标准练习。它在科学上是合理的，在数学上是适定的，并包含了求解所需的所有信息。我们将按要求进行推导和计算。\n\n原子核所受的力是总电子能量相对于原子核坐标的负梯度，$F_A = -\\nabla_A E$。能量 $E$ 相对于原子核坐标 $R$ 的全导数由链式法则给出。能量是分子轨道系数 $C$ 的函数，而 $C$ 依赖于 $R$；同时能量也通过用于构建哈密顿矩阵 $H$ 和重叠矩阵 $S$ 的基函数而显式地依赖于 $R$。\n$$\n\\frac{dE}{dR} = \\frac{\\partial E}{\\partial R} + \\sum_{\\mu, i} \\frac{\\partial E}{\\partial C_{\\mu i}} \\frac{dC_{\\mu i}}{dR}\n$$\n问题指明，在自洽时能量对轨道变分是稳态的。这个条件意味着第二项（依赖于 MO 系数对微扰的响应）为零。然而，这只在变分参数 $C$ 不受约束时才成立。在非正交基组中，MO 系数受到正交归一性约束 $C^{\\dagger}SC = I$ 的限制。处理此类约束优化的正确方法是拉格朗日乘子法。\n\n任务1：Pulay 力的推导\n我们构建用于能量最小化的拉格朗日量 $\\mathcal{L}$，并使用拉格朗日乘子 $\\varepsilon_{ji}$ 来引入正交归一性约束：\n$$\n\\mathcal{L} = E(C, H) - \\sum_{i,j}^{\\text{occ}} \\varepsilon_{ji} \\left(\\sum_{\\mu,\\nu} C_{\\mu i}^* S_{\\mu\\nu} C_{\\nu j} - \\delta_{ij}\\right)\n$$\n在自洽场 (SCF) 解处，拉格朗日量对 MO 系数的变化是稳态的，即 $\\partial \\mathcal{L} / \\partial C = 0$。这个条件导出了 Hartree-Fock 或 Kohn-Sham 方程。此外，在解点上，拉格朗日量的值等于电子能量，$E = \\mathcal{L}$。\n\n为了求原子核的力，我们计算能量对原子核坐标 $R$ 的全导数。由于在任意 $R$ 的解上都有 $E=\\mathcal{L}$，我们可以对 $\\mathcal{L}$ 进行微分：\n$$\n\\frac{dE}{dR} = \\frac{d\\mathcal{L}}{dR} = \\frac{\\partial \\mathcal{L}}{\\partial R} + \\sum_{\\mu, i} \\frac{\\partial \\mathcal{L}}{\\partial C_{\\mu i}} \\frac{dC_{\\mu i}}{dR} + \\sum_{\\mu, i} \\frac{\\partial \\mathcal{L}}{\\partial C_{\\mu i}^*} \\frac{dC_{\\mu i}^*}{dR}\n$$\n由于稳态条件，涉及系数导数的项 $\\partial \\mathcal{L} / \\partial C$ 和 $\\partial \\mathcal{L} / \\partial C^*$ 均为零。力的表达式大大简化，这一结果被称为约束变分下的 Hellmann-Feynman 定理：\n$$\n\\frac{dE}{dR} = \\frac{\\partial \\mathcal{L}}{\\partial R}\n$$\n偏导数 $\\partial/\\partial R$ 只作用于显式依赖于 $R$ 的量，即哈密顿矩阵 $H$ 和重叠矩阵 $S$。在此偏导数下，MO 系数 $C$ 被视为常数。\n$$\n\\frac{\\partial \\mathcal{L}}{\\partial R} = \\frac{\\partial E}{\\partial R} - \\sum_{i,j}^{\\text{occ}} \\varepsilon_{ji} \\frac{\\partial}{\\partial R}\\left(C_i^{\\dagger} S C_j\\right) = \\frac{\\partial E}{\\partial R} - \\sum_{i,j}^{\\text{occ}} \\varepsilon_{ji} \\left(C_i^{\\dagger} \\frac{\\partial S}{\\partial R} C_j\\right)\n$$\n项 $\\partial E / \\partial R$ 包含了构成哈密顿矩阵的单电子和双电子积分的导数。这产生了标准的 Hellmann-Feynman 力。第二项纯粹源于基函数重叠对原子核坐标的依赖性。这就是 Pulay 力的来源。\n\n在收敛时，拉格朗日乘子矩阵 $\\varepsilon$ 是对角的（在正则 MO 基中），对角线上的元素是轨道能量，即 $\\varepsilon_{ji} = \\varepsilon_i \\delta_{ij}$。表达式变为：\n$$\n\\frac{dE}{dR} = \\frac{\\partial E}{\\partial R} - \\sum_{i}^{\\text{occ}} \\varepsilon_i \\left(C_i^{\\dagger} \\frac{\\partial S}{\\partial R} C_i\\right)\n$$\n对能量梯度的 Pulay 贡献是第二项：\n$$\n\\left(\\frac{dE}{dR}\\right)_{\\text{Pulay}} = - \\sum_{i}^{\\text{occ}} \\varepsilon_i \\left(C_i^{\\dagger} \\frac{\\partial S}{\\partial R} C_i\\right)\n$$\n这可以写成迹的形式。为简单起见，我们假设系数为实数，$C_i^\\top$。\n$$\n\\left(\\frac{dE}{dR}\\right)_{\\text{Pulay}} = - \\sum_{i}^{\\text{occ}} \\varepsilon_i \\text{Tr}\\left(C_i^{\\top} \\frac{\\partial S}{\\partial R} C_i\\right) = - \\sum_{i}^{\\text{occ}} \\varepsilon_i \\text{Tr}\\left(\\frac{\\partial S}{\\partial R} C_i C_i^{\\top}\\right)\n$$\n利用迹的线性性质，我们交换求和与迹算子：\n$$\n\\left(\\frac{dE}{dR}\\right)_{\\text{Pulay}} = - \\text{Tr}\\left(\\frac{\\partial S}{\\partial R} \\sum_{i}^{\\text{occ}} \\varepsilon_i C_i C_i^{\\top}\\right)\n$$\n我们识别出能量加权密度矩阵，在问题陈述中记为 $E^{\\mathrm{AO}}$（通常记为 $W$），其元素为 $E_{\\mu\\nu}^{\\mathrm{AO}} = \\sum_{i}^{\\text{occ}} \\varepsilon_i C_{\\mu i} C_{\\nu i}$。矩阵形式为 $E^{\\mathrm{AO}} = \\sum_i^{\\text{occ}} \\varepsilon_i C_i C_i^{\\top}$。\n因此，对梯度的 Pulay 贡献为：\n$$\n\\left(\\frac{dE}{dR}\\right)_{\\text{Pulay}} = - \\text{Tr}\\left(\\frac{\\partial S}{\\partial R} E^{\\mathrm{AO}}\\right)\n$$\n力是梯度的负值，所以 Pulay 力是：\n$$\nF_{\\text{Pulay}} = + \\text{Tr}\\left(E^{\\mathrm{AO}} \\frac{\\partial S}{\\partial R}\\right) = \\sum_{\\mu,\\nu} E_{\\mu\\nu}^{\\mathrm{AO}} \\left(\\frac{\\partial S}{\\partial R}\\right)_{\\nu\\mu}\n$$\n这就完成了任务1的推导。\n\n任务2：特化为最小模型\n给定一个单电子体系，其哈密顿矩阵 $H$ 和重叠矩阵 $S$ 均为 $2 \\times 2$。矩阵为：\n$$\nH = \\begin{pmatrix} h & kS(R) \\\\ kS(R) & h \\end{pmatrix}, \\quad S = \\begin{pmatrix} 1 & S(R) \\\\ S(R) & 1 \\end{pmatrix}\n$$\n其中 $S(R)$ 表示非对角重叠元素 $S_{AB}(R)$。首先，我们求解广义本征值问题 $(H-\\varepsilon S)c = 0$ 来求轨道能量和系数。久期方程为 $\\det(H-\\varepsilon S) = 0$：\n$$\n\\det\\begin{pmatrix} h-\\varepsilon & kS(R)-\\varepsilon S(R) \\\\ kS(R)-\\varepsilon S(R) & h-\\varepsilon \\end{pmatrix} = (h-\\varepsilon)^2 - (kS(R)-\\varepsilon S(R))^2 = 0\n$$\n这产生两个能量 $\\varepsilon$ 的解：\n$$\nh-\\varepsilon = \\pm S(R)(k-\\varepsilon) \\implies \\varepsilon = \\frac{h \\mp kS(R)}{1 \\mp S(R)}\n$$\n问题要求成键态，它对应于原子轨道的对称组合 ($c_A=c_B$)。这对应于能量较低的根，即 $\\varepsilon_1 = \\frac{h+kS(R)}{1+S(R)}$。\n\n对应的本征向量是 $C_1 = c \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$。我们从条件 $C_1^{\\top} S C_1 = 1$ 中求出归一化常数 $c$：\n$$\nc^2 \\begin{pmatrix} 1 & 1 \\end{pmatrix} \\begin{pmatrix} 1 & S(R) \\\\ S(R) & 1 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} = c^2 (1+S(R)+S(R)+1) = 2c^2(1+S(R)) = 1\n$$\n所以，$c = \\frac{1}{\\sqrt{2(1+S(R))}}$。占据轨道的系数向量是 $C_1 = \\frac{1}{\\sqrt{2(1+S(R))}}\\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$。\n\n该体系有一个电子，所以只有这个成键轨道被占据。能量加权密度矩阵 $E^{\\mathrm{AO}}$ (或 $W$) 是：\n$$\nE^{\\mathrm{AO}} = \\varepsilon_1 C_1 C_1^{\\top} = \\left(\\frac{h+kS(R)}{1+S(R)}\\right) \\left(\\frac{1}{2(1+S(R))}\\right) \\begin{pmatrix} 1 & 1 \\\\ 1 & 1 \\end{pmatrix} = \\frac{h+kS(R)}{2(1+S(R))^2} \\begin{pmatrix} 1 & 1 \\\\ 1 & 1 \\end{pmatrix}\n$$\n重叠矩阵相对于 $R$ 的导数是：\n$$\n\\frac{\\partial S}{\\partial R} = \\begin{pmatrix} 0 & \\frac{dS(R)}{dR} \\\\ \\frac{dS(R)}{dR} & 0 \\end{pmatrix} = \\begin{pmatrix} 0 & -\\alpha R S(R) \\\\ -\\alpha R S(R) & 0 \\end{pmatrix}\n$$\n现在我们使用任务1中推导的迹公式来计算 Pulay 力。为简洁起见，我们用 $S$ 代替 $S(R)$。\n$$\nF_{\\text{Pulay}} = \\text{Tr}\\left(E^{\\mathrm{AO}} \\frac{\\partial S}{\\partial R}\\right) = \\text{Tr}\\left( \\frac{h+kS}{2(1+S)^2} \\begin{pmatrix} 1 & 1 \\\\ 1 & 1 \\end{pmatrix} \\begin{pmatrix} 0 & -\\alpha R S \\\\ -\\alpha R S & 0 \\end{pmatrix} \\right)\n$$\n$$\nF_{\\text{Pulay}} = \\frac{h+kS}{2(1+S)^2} \\text{Tr}\\left( \\begin{pmatrix} -\\alpha R S & -\\alpha R S \\\\ -\\alpha R S & -\\alpha R S \\end{pmatrix} \\right)\n$$\n所得矩阵的迹是 $(-\\alpha R S) + (-\\alpha R S) = -2\\alpha R S$。\n$$\nF_{\\text{Pulay}} = \\frac{h+kS}{2(1+S)^2} (-2\\alpha R S) = -\\frac{\\alpha R S(R) [h+kS(R)]}{[1+S(R)]^2}\n$$\n这就是用给定参数表示的 Pulay 力的最终表达式。\n\n任务3：数值计算\n给定以下原子单位制下的参数：\n- $\\alpha = 1.0\\,\\mathrm{bohr}^{-2}$\n- $h = -0.500\\,\\mathrm{Hartree}$\n- $K = 1.75$ (无量纲)\n- $R = 2.000\\,\\mathrm{bohr}$\n\n首先，我们计算 $k$ 和 $S(R)$：\n$k = K h = 1.75 \\times (-0.500) = -0.875\\,\\mathrm{Hartree}$。\n$S(R) = \\exp(-\\alpha R^2 / 2) = \\exp(-1.0 \\times (2.000)^2 / 2) = \\exp(-2.0)$。\n$S(2.000) \\approx 0.135335$。\n\n现在，我们将这些值代入 Pulay 力的表达式中：\n$$\nF_{\\text{Pulay}} = -\\frac{(1.0)(2.000)(0.135335) [-0.500 + (-0.875)(0.135335)]}{[1+0.135335]^2}\n$$\n$$\nF_{\\text{Pulay}} = -\\frac{(0.27067) [-0.500 - 0.118418]}{[1.135335]^2}\n$$\n$$\nF_{\\text{Pulay}} = -\\frac{(0.27067)(-0.618418)}{1.288985}\n$$\n$$\nF_{\\text{Pulay}} = \\frac{0.16739}{1.288985} \\approx 0.129862\\,\\mathrm{Hartree}/\\mathrm{bohr}\n$$\n将结果四舍五入到四位有效数字，我们得到 Pulay 力的数值。\n$$\nF_{\\text{Pulay}} \\approx 0.1299\\,\\text{Hartree/bohr}\n$$", "answer": "$$\\boxed{0.1299}$$", "id": "2917146"}, {"introduction": "有了精确的势能面和对力的清晰理解，我们现在可以模拟引人入胜的核量子动力学过程。本练习将处理最显著的非经典现象之一：量子隧穿。你将通过编程实现并比较半经典的 WKB 近似与数值精确的有限差分方法，来计算双阱势中的隧道分裂，从而直观地观察到粒子如何穿越势能面上经典禁闭的区域。[@problem_id:2917145]", "problem": "考虑一个在一维对称双势阱势能面上的核运动，其势能由四次形式 $V(x) = a \\,(x^2 - b^2)^2$ 定义，单位为原子单位（a.u.），其中约化普朗克常数 $\\hbar = 1$，电子质量 $m_e = 1$，能量单位为哈特里（hartree），长度单位为玻尔（bohr）。核质量 $m$ 在哈密顿算符 $H = -\\dfrac{1}{2 m}\\dfrac{d^2}{dx^2} + V(x)$ 中被视为一个标量参数。势能极小值点位于 $x = \\pm b$，其值为 $V(\\pm b) = 0$；中心势垒位于 $x = 0$，其高度为 $V(0) = a b^4$。任务是计算最低振动双重态的隧穿分裂，并将解析半经典估计值与精确数值结果进行比较。\n\n从定态薛定谔方程和 Wentzel–Kramers–Brillouin (WKB) 近似的基本定义出发，推导一种计算方法，该方法针对给定的参数集 $(m,a,b)$ 执行以下操作：\n\n- 在极小值点 $x = b$ 处构建局域谐振子近似，以从 $V''(b)$ 和 $m$ 估算单势阱基态能量 $E_0$ 和小振幅角频率 $\\omega_0$。\n- 使用一维 WKB 势垒穿透分析，通过计算能量为 $E_0$ 时内转折点之间经典禁区的虚数经典作用量，来估算最低双重态的隧穿分裂 $\\Delta_{\\text{WKB}}$。\n- 使用有限差分法（FDM），在有限区间 $[-L,L]$ 上施加 Dirichlet 边界条件，通过对均匀网格上的哈密顿算符进行数值对角化来计算精确分裂 $\\Delta_{\\text{exact}}$。使用二阶中心差分动能算符构建对称三对角哈密顿矩阵，并求得两个最低本征值 $E_0^{\\text{exact}}$ 和 $E_1^{\\text{exact}}$；然后设 $\\Delta_{\\text{exact}} = E_1^{\\text{exact}} - E_0^{\\text{exact}}$。\n\n您的程序必须实现这两种方法，并为每个测试用例报告：\n- $\\Delta_{\\text{exact}}$，单位为哈特里 (hartree)，\n- $\\Delta_{\\text{WKB}}$，单位为哈特里 (hartree)，\n- 绝对差 $|\\Delta_{\\text{exact}} - \\Delta_{\\text{WKB}}|$，单位为哈特里 (hartree)。\n\n所有能量必须以哈特里为单位表示，每个报告的浮点数必须四舍五入到 8 位小数。\n\n您必须使用科学标准算法实现您自己的作用量积分的数值积分和三对角哈密顿矩阵的对角化，但您可以使用经过充分测试的数值库例程来进行求根、数值积分和对称三对角本征求解。\n\n测试套件与离散化细节：\n- 对所有测试用例使用相同的网格和计算盒子：$L = 6.0$ 玻尔（bohr），以及一个包含 $N = 2000$ 个总点的均匀网格；通过将哈密顿算符限制在 $N-2$ 个内部点上，在 $x = \\pm L$ 处施加 Dirichlet 边界条件。\n- 使用以下 3 个参数集 $(m,a,b)$，这些参数集经选择用于探测不同的势垒区域，同时保持科学真实性和数值稳定性：\n  - A 类（中到高势垒）：$(m,a,b) = (1.0, 1.0, 1.5)$。\n  - B 类（中等势垒）：$(m,a,b) = (1.0, 3.0, 1.0)$。\n  - C 类（近阈值势垒，WKB 压力测试）：$(m,a,b) = (1.0, 20.0, 0.7)$。\n  \n对于每种情况，确保势垒高度 $a b^4$ 超过局域谐振子零点能估计值 $E_0$，以便 WKB 分析存在经典禁区。\n\n最终输出格式：\n- 您的程序应产生单行输出，其中包含一个扁平的浮点数列表，按 $[\\Delta_{\\text{exact}}^{(A)}, \\Delta_{\\text{WKB}}^{(A)}, |\\Delta_{\\text{exact}}^{(A)} - \\Delta_{\\text{WKB}}^{(A)}|, \\Delta_{\\text{exact}}^{(B)}, \\Delta_{\\text{WKB}}^{(B)}, |\\Delta_{\\text{exact}}^{(B)} - \\Delta_{\\text{WKB}}^{(B)}|, \\Delta_{\\text{exact}}^{(C)}, \\Delta_{\\text{WKB}}^{(C)}, |\\Delta_{\\text{exact}}^{(C)} - \\Delta_{\\text{WKB}}^{(C)}|]$ 的顺序排列，四舍五入到 8 位小数，并用方括号括起来，值之间用逗号分隔，单行共 9 个浮点数。\n\n本问题不涉及角度单位。本问题不涉及百分比。输出中出现的所有物理量必须以哈特里（hartree）为单位，并四舍五入到 8 位小数。不得打印任何其他文本。", "solution": "所提出的问题是计算量子力学中的一个标准练习，并且是有效的。它具有科学依据、问题适定、客观，并包含获得唯一解所需的所有必要信息。该任务涉及求解质量为 $m$ 的粒子在对称双势阱 $V(x) = a (x^2 - b^2)^2$ 中的一维定态薛定谔方程。目标是计算基态双重态的能量分裂 $\\Delta E$，这种分裂源于通过中心势垒的量子隧穿效应。这将通过两种不同的方法完成：一种是半经典的 Wentzel–Kramers–Brillouin (WKB) 近似，另一种是使用有限差分法（FDM）的数值精确对角化。两种方法的结果将进行比较。我们在原子单位（其中 $\\hbar = 1$）下工作。哈密顿算符由下式给出：\n$$\nH = -\\dfrac{1}{2 m}\\dfrac{d^2}{dx^2} + V(x)\n$$\n\n首先，我们推导 WKB 近似的计算步骤。该方法提供了一个解析估计，它在高而宽的势垒极限下是准确的。\n\n对称双势阱中最低双重态能量分裂的 WKB 公式为：\n$$\n\\Delta_{\\text{WKB}} = \\frac{\\hbar \\omega_0}{\\pi} e^{-S/\\hbar}\n$$\n在原子单位中，这变为 $\\Delta_{\\text{WKB}} = \\frac{\\omega_0}{\\pi} e^{-S}$。其中，$\\omega_0$ 是单个势阱内小振荡的经典角频率，而 $S$ 是穿透势垒的经典作用量。\n\n为了找到 $\\omega_0$，我们在势函数 $V(x)$ 的一个极小值点（例如 $x=b$）附近进行谐振子近似。将势函数在 $x=b$ 附近展开至二阶泰勒级数：$V(x) \\approx V(b) + V'(b)(x-b) + \\frac{1}{2}V''(b)(x-b)^2$。\n势函数的定义使得 $V(b) = 0$ 且 $V'(x) = 4ax(x^2-b^2)$，因此 $V'(b)=0$。其二阶导数为 $V''(x) = 4a(3x^2 - b^2)$，这给出 $V''(b) = 4a(3b^2 - b^2) = 8ab^2$。\n近似的谐振子势为 $V_{\\text{HO}}(x) = \\frac{1}{2}(8ab^2)(x-b)^2$。这对应于一个劲度系数为 $k = 8ab^2$ 的谐振子。因此，角频率为 $\\omega_0 = \\sqrt{k/m} = \\sqrt{8ab^2/m}$。\n\n在此单势阱谐振子近似下的基态能量是零点能 $E_0 = \\frac{1}{2}\\hbar\\omega_0$。当 $\\hbar=1$ 时，我们有：\n$$\nE_0 = \\frac{1}{2}\\omega_0 = \\sqrt{\\frac{2ab^2}{m}}\n$$\n这个能量 $E_0$ 在 WKB 计算中用作隧穿粒子的能级。\n\n作用量积分 $S$，也称为 Gamow 因子指数，是在经典禁区内计算的：\n$$\nS = \\int_{-c}^{c} |p(x)| \\, dx = \\int_{-c}^{c} \\sqrt{2m(V(x) - E_0)} \\, dx\n$$\n积分限 $\\pm c$ 是内经典转折点，在这些点上能量 $E_0$ 等于势能 $V(x)$。通过求解方程 $V(x) = E_0$ 来找到它们：$a(x^2 - b^2)^2 = E_0 \\implies x^2 - b^2 = \\pm\\sqrt{E_0/a} \\implies x^2 = b^2 \\pm \\sqrt{E_0/a}$。\n内转折点对应于 $x^2$ 的较小正解，因此我们取负号：$c^2 = b^2 - \\sqrt{E_0/a}$，即 $c = \\sqrt{b^2 - \\sqrt{E_0/a}}$。问题条件保证了势垒高度 $V(0) = ab^4$ 大于 $E_0$，从而确保 $c$ 存在实数解。对于此势函数，作用量 $S$ 的积分没有简单的解析解，必须进行数值计算。\n\n接下来，我们详细介绍使用有限差分法（FDM）的数值精确方法。该方法将连续的微分薛定谔方程转化为一个离散的矩阵本征值问题。\n\n空间域 $[-L, L]$ 被离散化为一个包含 $N$ 个点的均匀网格 $x_i = -L + i \\cdot \\Delta x$（其中 $i=0, \\dots, N-1$），网格间距为 $\\Delta x = 2L/(N-1)$。波函数 $\\psi(x)$ 由其在这些网格点上的值构成的向量表示，即 $\\vec{\\psi} = (\\psi_0, \\psi_1, \\dots, \\psi_{N-1})^T$。\n\n动能算符中的二阶导数通过二阶中心差分来近似：\n$$\n\\frac{d^2\\psi}{dx^2}\\bigg|_{x_i} \\approx \\frac{\\psi(x_{i+1}) - 2\\psi(x_i) + \\psi(x_{i-1})}{(\\Delta x)^2}\n$$\n问题指定了 Dirichlet 边界条件，即 $\\psi(-L) = \\psi(L) = 0$，这等价于 $\\psi_0 = 0$ 和 $\\psi_{N-1} = 0$。这意味着我们只需要求解 $N-2$ 个内部点（从 $x_1$ 到 $x_{N-2}$）的波函数。在内部点 $x_j$（其中 $j=1, \\dots, N-2$）处的薛定谔方程变为：\n$$\n-\\frac{1}{2m} \\left( \\frac{\\psi_{j+1} - 2\\psi_j + \\psi_{j-1}}{(\\Delta x)^2} \\right) + V(x_j)\\psi_j = E \\psi_j\n$$\n这可以重排为一个矩阵方程 $\\mathbf{H}\\vec{\\psi'} = E\\vec{\\psi'}$，其中 $\\vec{\\psi'}$ 是内部点上波函数值的向量，而 $\\mathbf{H}$ 是一个 $(N-2) \\times (N-2)$ 的对称三对角矩阵。该矩阵的元素为：\n- 对角元素：$H_{jj} = \\frac{1}{m(\\Delta x)^2} + V(x_{j})$\n- 非对角元素：$H_{j,j+1} = H_{j+1,j} = -\\frac{1}{2m(\\Delta x)^2}$\n\n这个矩阵本征值问题可以通过数值方法求解，以找到本征值 $E_n$。两个最低的本征值 $E_0^{\\text{exact}}$ 和 $E_1^{\\text{exact}}$ 对应于基态和第一激发态，它们构成了隧穿双重态。数值精确分裂则为：\n$$\n\\Delta_{\\text{exact}} = E_1^{\\text{exact}} - E_0^{\\text{exact}}\n$$\n\n所提供的程序实现了这两种方法。对于 WKB 计算，它首先计算 $\\omega_0$ 和 $E_0$，然后使用一个求根算法（`scipy.optimize.brentq`）找到转折点 $c$，最后使用数值积分（`scipy.integrate.quad`）计算作用量积分 $S$。对于 FDM 计算，它构建了三对角哈密顿矩阵，并使用一个专门的本征求解器（`scipy.linalg.eigh_tridiagonal`）来高效地找到两个最低的本征值。然后，程序计算并报告每个测试用例所需的量。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import integrate, linalg, optimize\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for the given test cases and print the results.\n    \"\"\"\n    # Discretization and simulation box parameters as specified.\n    L = 6.0\n    N = 2000\n\n    # Test cases: (m, a, b) parameter sets.\n    test_cases = [\n        # Case A (moderate-to-high barrier)\n        (1.0, 1.0, 1.5),\n        # Case B (moderate barrier)\n        (1.0, 3.0, 1.0),\n        # Case C (near-threshold barrier, WKB stress test)\n        (1.0, 20.0, 0.7),\n    ]\n\n    # List to store all 9 final results.\n    final_results = []\n\n    for m, a, b in test_cases:\n        delta_exact, delta_wkb, abs_diff = calculate_splitting(m, a, b, L, N)\n        final_results.extend([\n            round(delta_exact, 8),\n            round(delta_wkb, 8),\n            round(abs_diff, 8)\n        ])\n\n    # Print the results in the exact specified format.\n    print(f\"[{','.join(map(str, final_results))}]\")\n\ndef calculate_splitting(m, a, b, L, N):\n    \"\"\"\n    Calculates the tunneling splitting using both FDM and WKB methods.\n\n    Args:\n        m (float): Mass of the particle.\n        a (float): Parameter 'a' of the potential V(x).\n        b (float): Parameter 'b' of the potential V(x), defines minima at +/- b.\n        L (float): Half-width of the simulation box [-L, L].\n        N (int): Number of grid points.\n\n    Returns:\n        tuple: A tuple containing (delta_exact, delta_wkb, abs_diff).\n    \"\"\"\n\n    # --- Part 1: Numerical \"Exact\" Calculation using Finite Difference Method ---\n\n    # Define the potential energy function.\n    def V(x):\n        return a * (x**2 - b**2)**2\n\n    # Set up the spatial grid. We only consider N-2 interior points.\n    x_grid = np.linspace(-L, L, N)\n    dx = x_grid[1] - x_grid[0]\n    x_interior = x_grid[1:-1] # Grid points from x_1 to x_{N-2}\n\n    # Construct the tridiagonal Hamiltonian matrix elements.\n    # Diagonal elements: 1/(m*dx^2) + V(x_i)\n    diag_elements = (1.0 / (m * dx**2)) + V(x_interior)\n\n    # Off-diagonal elements: -1/(2*m*dx^2)\n    # There are N-3 off-diagonal elements for an (N-2)x(N-2) matrix.\n    offdiag_elements = -1.0 / (2.0 * m * dx**2) * np.ones(N - 3)\n\n    # Diagonalize the tridiagonal matrix to find the two lowest eigenvalues.\n    # `eigh_tridiagonal` returns eigenvalues in ascending order.\n    # select='i' and select_range=(0, 1) requests the first two eigenvalues (indices 0 and 1).\n    eigenvalues = linalg.eigh_tridiagonal(diag_elements, offdiag_elements, select='i', select_range=(0, 1))[0]\n    E0_exact, E1_exact = eigenvalues\n\n    # Calculate the \"exact\" tunneling splitting.\n    delta_exact = E1_exact - E0_exact\n\n    # --- Part 2: Semiclassical WKB Calculation ---\n\n    # Calculate the harmonic frequency at the well minimum.\n    # k = V''(b) = 8*a*b^2. omega0 = sqrt(k/m).\n    omega0 = np.sqrt(8 * a * b**2 / m)\n\n    # Estimate the ground state energy E0 using the harmonic approximation (ZPE).\n    # In atomic units (hbar=1), E0 = 0.5 * omega0.\n    E0_harmonic = 0.5 * omega0\n\n    # Find the inner classical turning points +/- c by solving V(x) = E0_harmonic.\n    # This is equivalent to finding the root of f(x) = V(x) - E0 = 0.\n    def turning_point_eq(x):\n        return V(x) - E0_harmonic\n\n    # We search for the positive root 'c' in the interval [0, b].\n    # brentq is a robust root-finding algorithm.\n    c = optimize.brentq(turning_point_eq, 0, b)\n    \n    # Define the integrand for the action integral S.\n    def action_integrand(x):\n        return np.sqrt(2 * m * (V(x) - E0_harmonic))\n    \n    # Numerically integrate from -c to c to find the action S.\n    # We use scipy.integrate.quad for this.\n    S, _ = integrate.quad(action_integrand, -c, c)\n    \n    # Calculate the WKB tunneling splitting.\n    # delta_wkb = (omega0 / pi) * exp(-S) since hbar=1.\n    delta_wkb = (omega0 / np.pi) * np.exp(-S)\n    \n    # Calculate the absolute difference between the two methods.\n    abs_diff = np.abs(delta_exact - delta_wkb)\n\n    return delta_exact, delta_wkb, abs_diff\n\n# Execute the main function when the script is run.\nif __name__ == \"__main__\":\n    solve()\n```", "id": "2917145"}]}