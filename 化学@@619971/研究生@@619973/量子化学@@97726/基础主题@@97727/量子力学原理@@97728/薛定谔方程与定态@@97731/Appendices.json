{"hands_on_practices": [{"introduction": "有限深方势阱是量子力学中的一个典型问题，其重要性在于它构成了从理想化的无限深势阱到更真实物理系统的基本桥梁。通过求解这个模型，我们将从第一性原理出发，严格应用定态薛定谔方程和波函数连续性边界条件，最终推导出束缚态能量所必须满足的超越方程。这项实践不仅能加深对量子化条件来源的理解，也为处理更复杂的量子束缚态问题奠定了坚实的数学和物理基础。[@problem_id:2922248]", "problem": "考虑一个一维对称有限深方势阱，其定义为\n$$\nV(x)=\\begin{cases}\n- V_{0}, & |x|<a,\\\\\n0, & |x|\\ge a,\n\\end{cases}\n$$\n其中 $V_{0}>0$，$a>0$，以及一个质量为 $m$ 的粒子。束缚态的能量 $E$ 满足 $-V_{0}<E<0$。从定态薛定谔方程出发，并对物理上可接受的定态施加必需的边界条件和连续性条件，完成以下任务：\n\n- 从第一性原理推导决定此势阱中偶宇称和奇宇称定态的束缚态能量的超越量子化条件。\n- 引入无量纲参数 $z\\equiv k a$、$y\\equiv \\kappa a$（其中 $k\\equiv \\sqrt{2 m (E+V_{0})}/\\hbar$ 且 $\\kappa\\equiv \\sqrt{2 m (-E)}/\\hbar$）以及无量纲势阱参数 $z_{0}\\equiv a \\sqrt{2 m V_{0}}/\\hbar$。用 $z$、$y$ 和 $z_{0}$ 表示你的量子化条件。\n- 仅使用你推导出的结果，确定存在至少一个束缚态所要求的无量纲势阱参数 $z_{0}$ 的最小值。将你的最终答案表示为一个精确的数字。无需四舍五入。最终答案是无量纲的；不要包含单位。", "solution": "首先将根据所需标准对问题陈述进行验证。\n\n**步骤1：提取已知条件**\n- 势：$V(x)=\\begin{cases} -V_{0}, & |x|<a \\\\ 0, & |x|\\ge a \\end{cases}$\n- 约束条件：$V_{0}>0$，$a>0$\n- 粒子质量：$m$\n- 束缚态能量范围：$-V_{0}<E<0$\n- 任务1：推导偶宇称和奇宇称定态的超越量子化条件。\n- 任务2：引入无量纲参数 $z\\equiv k a$、$y\\equiv \\kappa a$（其中 $k\\equiv \\sqrt{2 m (E+V_{0})}/\\hbar$ 且 $\\kappa\\equiv \\sqrt{2 m (-E)}/\\hbar$）以及无量纲势阱参数 $z_{0}\\equiv a \\sqrt{2 m V_{0}}/\\hbar$。用这些变量表示量子化条件。\n- 任务3：确定存在至少一个束缚态所需的 $z_{0}$ 的最小值。\n\n**步骤2：使用提取的已知条件进行验证**\n该问题是关于有限深势阱的一维量子力学中的一个标准、基础练习。\n- **有科学依据**：该问题建立在定态薛定谔方程和量子力学原理之上。它在科学上是合理的，在事实上是正确的。\n- **适定的**：该问题定义清晰，结构化。它要求通过分步推导最终得到一个特定的值。该问题解的存在性和唯一性是公认的。\n- **客观的**：语言精确、数学化，没有任何主观或模糊的术语。\n\n一个有效问题的所有条件都已满足。没有科学缺陷、歧义或矛盾。\n\n**步骤3：结论与行动**\n该问题有效。现在将提供一个完整、有理有据的解答。\n\n**量子化条件的推导**\n\n对于一个在势 $V(x)$ 中质量为 $m$ 的粒子，其定态薛定谔方程（TISE）为：\n$$\n-\\frac{\\hbar^2}{2m} \\frac{d^2\\psi(x)}{dx^2} + V(x)\\psi(x) = E\\psi(x)\n$$\n我们考虑束缚态，其中 $-V_{0} < E < 0$。我们在由势定义的三个区域中求解 TISE。\n\n**区域 I ($x \\ge a$) 和区域 III ($x \\le -a$)**：\n在这些区域中，$V(x)=0$。TISE 变为：\n$$\n\\frac{d^2\\psi}{dx^2} = \\frac{2mE}{\\hbar^2}\\psi = \\kappa^2\\psi\n$$\n其中我们定义了 $\\kappa \\equiv \\frac{\\sqrt{2m(-E)}}{\\hbar}$。由于 $E<0$，$\\kappa$ 是一个实的正常量。通解是 $\\psi(x) = C_1 e^{\\kappa x} + C_2 e^{-\\kappa x}$。对于束缚态，波函数必须是可归一化的，这要求当 $|x| \\to \\infty$ 时 $\\psi(x) \\to 0$。\n- 在区域 I ($x \\ge a$) 中，我们必须舍去 $e^{\\kappa x}$ 项，所以 $\\psi_I(x) = A e^{-\\kappa x}$。\n- 在区域 III ($x \\le -a$) 中，我们必须舍去 $e^{-\\kappa x}$ 项，所以 $\\psi_{III}(x) = B e^{\\kappa x}$。\n\n**区域 II ($|x| < a$)**：\n在该区域中，$V(x) = -V_0$。TISE 变为：\n$$\n\\frac{d^2\\psi}{dx^2} = -\\frac{2m(E+V_0)}{\\hbar^2}\\psi = -k^2\\psi\n$$\n其中我们定义了 $k \\equiv \\frac{\\sqrt{2m(E+V_0)}}{\\hbar}$。由于 $E > -V_0$，$k$ 是一个实的正常量。通解是 $\\psi_{II}(x) = C \\cos(kx) + D \\sin(kx)$。\n\n势 $V(x)$ 是对称的，即 $V(x) = V(-x)$。因此，定态可以选择为具有确定宇称（偶宇称或奇宇称）。\n\n**偶宇称解 ($\\psi(-x) = \\psi(x)$)**：\n对于偶函数解，区域 II 中的波函数必须是 $\\psi_{II}(x) = C \\cos(kx)$。根据对称性，区域 I 和 III 中的解必须具有 $\\psi(x) = A e^{-\\kappa|x|}$ 的形式（对于 $|x| \\ge a$）。我们在 $x=a$ 处应用边界条件（$\\psi(x)$ 及其导数 $\\psi'(x)$ 的连续性）。\n\\begin{align*} \\psi_{II}(a) &= \\psi_I(a) \\implies C \\cos(ka) = A e^{-\\kappa a} \\\\ \\psi_{II}'(a) &= \\psi_I'(a) \\implies -k C \\sin(ka) = -\\kappa A e^{-\\kappa a} \\end{align*}\n将第二个方程除以第一个方程（假设 $C, A, \\cos(ka) \\ne 0$）得到：\n$$\n\\frac{-k C \\sin(ka)}{C \\cos(ka)} = \\frac{-\\kappa A e^{-\\kappa a}}{A e^{-\\kappa a}} \\implies k \\tan(ka) = \\kappa\n$$\n这是偶宇称束缚态的超越量子化条件。\n\n**奇宇称解 ($\\psi(-x) = -\\psi(x)$)**：\n对于奇函数解，区域 II 中的波函数必须是 $\\psi_{II}(x) = D \\sin(kx)$。区域 I 和 III 中的解必须具有 $\\psi(x) = A \\cdot \\text{sgn}(x) e^{-\\kappa|x|}$ 的形式（对于 $|x| \\ge a$），以确保 $\\psi(a)=A e^{-\\kappa a}$ 和 $\\psi(-a)=-A e^{\\kappa a}$。我们在 $x=a$ 处应用边界条件。\n\\begin{align*} \\psi_{II}(a) &= \\psi_I(a) \\implies D \\sin(ka) = A e^{-\\kappa a} \\\\ \\psi_{II}'(a) &= \\psi_I'(a) \\implies k D \\cos(ka) = -\\kappa A e^{-\\kappa a} \\end{align*}\n将第二个方程除以第一个方程（假设 $D, A, \\sin(ka) \\ne 0$）给出：\n$$\n\\frac{k D \\cos(ka)}{D \\sin(ka)} = \\frac{-\\kappa A e^{-\\kappa a}}{A e^{-\\kappa a}} \\implies k \\cot(ka) = -\\kappa \\quad \\text{or} \\quad -k \\cot(ka) = \\kappa\n$$\n这是奇宇称束缚态的超越量子化条件。\n\n**无量纲表示**\n我们引入无量纲变量 $z = ka$、$y = \\kappa a$ 和 $z_0 = \\frac{a}{\\hbar}\\sqrt{2mV_0}$。我们建立它们之间的关系：\n$$\nk^2 = \\frac{2m(E+V_0)}{\\hbar^2} \\implies k^2 a^2 = \\frac{2ma^2(E+V_0)}{\\hbar^2} = z^2\n$$\n$$\n\\kappa^2 = \\frac{2m(-E)}{\\hbar^2} \\implies \\kappa^2 a^2 = -\\frac{2ma^2 E}{\\hbar^2} = y^2\n$$\n将这两个表达式相加：\n$$\nz^2 + y^2 = \\frac{2ma^2}{\\hbar^2}(E+V_0 - E) = \\frac{2ma^2 V_0}{\\hbar^2} = \\left(\\frac{a}{\\hbar}\\sqrt{2mV_0}\\right)^2 = z_0^2\n$$\n因此，我们在 $(z, y)$ 平面内得到了一个圆的方程：$z^2 + y^2 = z_0^2$。\n现在我们通过乘以 $a$ 将量子化条件用这些变量表示：\n- **偶宇称态**：$ka \\tan(ka) = \\kappa a \\implies z \\tan(z) = y$\n- **奇宇称态**：$-ka \\cot(ka) = \\kappa a \\implies -z \\cot(z) = y$\n\n**束缚态存在的最小条件**\n束缚态存在的条件是，在第一象限（$z>0$, $y>0$，因为对于一个能量在 $E \\in (-V_0, 0)$ 范围内的非平凡束缚态，$k, \\kappa, a > 0$）中，圆 $z^2+y^2=z_0^2$ 与超越曲线之间存在交点。\n\n基态对应于最低的允许能量，也就是当势阱参数 $z_0$ 从 0 开始增加时第一个出现的解。让我们分析图解法。\n- **偶宇称态**：曲线 $y = z \\tan(z)$ 从原点 $(0,0)$ 开始并递增，在 $z = \\pi/2$ 处趋近于一条垂直渐近线。\n- **奇宇称态**：曲线 $y = -z \\cot(z)$ 在第一象限的第一支从点 $(\\pi/2, 0)$ 开始，并递增，趋向于 $z=\\pi$ 处的渐近线。\n- **圆**：$y = \\sqrt{z_0^2 - z^2}$ 是一个以原点为中心、半径为 $z_0$ 的四分之一圆。\n\n为了至少存在一个束缚态，我们寻找能产生交点的最小 $z_0 > 0$。对于对称势，基态总是偶宇称态，所以我们首先考察偶宇称态的条件。\n\n考虑偶宇称态曲线 $y=z \\tan(z)$ 和圆 $y=\\sqrt{z_0^2-z^2}$。让我们分析在原点附近，$z \\to 0$ 时的行为。\n曲线 $y = z \\tan(z)$ 从原点 $(0,0)$ 开始。对于小的 $z$，$\\tan(z) \\approx z$，所以 $y \\approx z^2$。圆 $y = \\sqrt{z_0^2-z^2}$ 从 y 轴上的点 $(0, z_0)$ 开始。当 $z$ 从 0 开始增加时，曲线 $y=z \\tan(z)$ 从 $y=0$ 上升，而圆弧从 $y=z_0$ 下降。因为一个从 0 开始，另一个从 $z_0 > 0$ 开始，并且两者都是连续的，所以对于任何 $z_0 > 0$ 的值，它们必定相交。\n\n更形式化地，令 $f(z) = z \\tan(z)$ 和 $g(z) = \\sqrt{z_0^2 - z^2}$。我们在为 $z \\in (0, z_0)$ 寻找 $f(z) = g(z)$ 的解。令 $h(z) = g(z) - f(z) = \\sqrt{z_0^2 - z^2} - z \\tan(z)$。\n对于区间 $(0, \\pi/2)$ 内的任意 $z_0$，我们可以在定义域 $[0, z_0]$ 的端点处计算 $h(z)$ 的值：\n- 在 $z=0$ 处：$h(0) = \\sqrt{z_0^2 - 0} - 0 = z_0 > 0$。\n- 在 $z=z_0$ 处：$h(z_0) = \\sqrt{z_0^2 - z_0^2} - z_0 \\tan(z_0) = -z_0 \\tan(z_0)$。由于 $z_0 \\in (0, \\pi/2)$，$\\tan(z_0) > 0$，所以 $h(z_0) < 0$。\n由于 $h(z)$ 在 $[0, z_0]$ 上是连续函数，并且其值从 $z=0$ 处的正值变为 $z=z_0$ 处的负值，根据介值定理，必定存在至少一个根 $z \\in (0, z_0)$。即使对于 $z_0 \\ge \\pi/2$，解也保证存在，因为当 $z=\\pi/2$ 时曲线 $y=z\\tan(z)$ 趋于无穷大，而圆保持有限。\n\n因此，对于任何任意小但为正的势阱强度，即对于任何 $z_0 > 0$，都存在一个偶宇称束缚态。\n问题要求存在*至少一个*束缚态所需的 $z_0$ 的最小值。存在束缚态的 $z_0$ 值的集合是 $(0, \\infty)$。最小值是这个集合的下确界（最大下界）。\n$$\n\\inf \\{z_0 \\in \\mathbb{R} \\mid z_0 > 0\\} = 0\n$$\n为了完整起见，第一个奇宇称态仅在圆足够大以与从 $(\\pi/2, 0)$ 开始的奇宇称态曲线 $y=-z\\cot(z)$ 相交时才出现。这要求圆的半径 $z_0$ 至少为 $\\pi/2$。第一个奇宇称态的阈值是 $z_0 = \\pi/2$。然而，由于对于任何 $z_0 > 0$，偶宇称态总是存在，所以这才是系统的真正基态。“至少一个束缚态”的要求对任何正的 $z_0$ 都满足。因此，最小值为 0。", "answer": "$$\n\\boxed{0}\n$$", "id": "2922248"}, {"introduction": "虽然少数理想化系统存在精确解析解，但量子化学中遇到的大多数问题都必须依赖于近似方法。变分原理是其中最强大和基础的工具之一，它为近似求解体系的基态能量提供了一个严格的理论上界。在此练习中，我们将对四次谐振子这一非精确可解模型应用变分法，通过最小化能量泛函来优化试探波函数，从而揭示高斯型试探函数如何捕捉系统的主要物理特征，并进行标度分析以理解能量与哈密顿量参数间的深刻关系。[@problem_id:2922377]", "problem": "考虑一个质量为 $m$ 的粒子在纯四次势 $V(x)=\\lambda x^{4}$（其中 $\\lambda>0$）中的一维定态薛定谔方程：\n$$\n\\left[-\\frac{\\hbar^{2}}{2m}\\frac{d^{2}}{dx^{2}}+\\lambda x^{4}\\right]\\psi(x)=E\\,\\psi(x).\n$$\n使用 Rayleigh–Ritz 变分原理，该原理指出对于任意归一化的试探函数 $\\psi$，其期望值 $\\langle \\psi|\\hat{H}|\\psi\\rangle$ 提供了对精确基态能量的一个上界。请按以下步骤进行。\n\n使用归一化的高斯试探函数族\n$$\n\\psi_{\\alpha}(x)=\\left(\\frac{\\alpha}{\\pi}\\right)^{\\frac{1}{4}}\\exp\\!\\left(-\\frac{\\alpha x^{2}}{2}\\right),\n$$\n（其中变分参数 $\\alpha>0$）来构造变分能量泛函 $E(\\alpha)=\\langle \\psi_{\\alpha}|\\hat{H}|\\psi_{\\alpha}\\rangle$。然后，通过最小化 $E(\\alpha)$（对 $\\alpha$ 求极小值），获得基态能量的优化变分上界 $E_{\\mathrm{var}}(\\lambda,m,\\hbar)$ 的一个闭合形式解析表达式。\n\n此外，从定态薛定谔方程出发，进行标度分析，以确定精确基态能量如何随 $\\lambda$、$m$ 和 $\\hbar$ 变化，并将该标度关系与您在变分上界中发现的依赖关系进行比较。\n\n将您的最终答案表示为 $E_{\\mathrm{var}}(\\lambda,m,\\hbar)$ 的单一闭合形式解析表达式。无需进行数值计算或四舍五入，也无需在最终答案中报告单位。", "solution": "在尝试求解之前，对问题进行验证。\n\n**第 1 步：提取已知条件**\n-   一维定态薛定谔方程：$\\left[-\\frac{\\hbar^{2}}{2m}\\frac{d^{2}}{dx^{2}}+\\lambda x^{4}\\right]\\psi(x)=E\\,\\psi(x)$。\n-   势函数为 $V(x)=\\lambda x^{4}$，其中 $\\lambda > 0$。粒子质量为 $m$。\n-   变分原理：对于任意归一化的试探函数 $\\psi$，其期望值 $\\langle \\psi|\\hat{H}|\\psi\\rangle$ 是精确基态能量的一个上界。\n-   归一化的试探波函数族：$\\psi_{\\alpha}(x)=\\left(\\frac{\\alpha}{\\pi}\\right)^{\\frac{1}{4}}\\exp\\!\\left(-\\frac{\\alpha x^{2}}{2}\\right)$，其中变分参数 $\\alpha>0$。\n-   任务 1：构造变分能量泛函 $E(\\alpha)=\\langle \\psi_{\\alpha}|\\hat{H}|\\psi_{\\alpha}\\rangle$。\n-   任务 2：通过最小化 $E(\\alpha)$（对 $\\alpha$ 求极小值），获得优化的变分上界 $E_{\\mathrm{var}}(\\lambda,m,\\hbar)$ 的一个闭合形式解析表达式。\n-   任务 3：对薛定谔方程进行标度分析，以确定精确基态能量的标度关系，并将其与变分结果进行比较。\n\n**第 2 步：使用提取的已知条件进行验证**\n-   **科学基础与客观性：** 该问题涉及定态薛定谔方程、四次谐振子势以及 Rayleigh-Ritz 变分原理。这些都是量子力学和量子化学中基本且成熟的概念。语言精确、客观。\n-   **良态问题：** 这是一个良态问题。它明确了哈密顿量、一个有效的试探波函数族，以及应用标准近似方法（变分原理）的一套清晰指令。其目标是找到一个解析表达式，这是一个数学上合理的目标。\n-   **完整与一致：** 该问题提供了所有必要信息。哈密顿量已定义，试探函数以归一化形式给出，变分参数空间（$\\alpha>0$）也已指定。信息之间没有矛盾。\n\n**第 3 步：结论与行动**\n该问题是有效的，因为它科学上合理、良态且信息自洽。将提供完整解答。\n\n**求解推导**\n\n系统的哈密顿算符 $\\hat{H}$ 由动能算符 $\\hat{T}$ 和势能算符 $\\hat{V}$ 的和给出。\n$$\n\\hat{H} = \\hat{T} + \\hat{V} = -\\frac{\\hbar^{2}}{2m}\\frac{d^{2}}{dx^{2}} + \\lambda x^{4}\n$$\n变分能量泛函 $E(\\alpha)$ 是哈密顿量相对于试探波函数 $\\psi_{\\alpha}(x)$ 的期望值。\n$$\nE(\\alpha) = \\langle \\psi_{\\alpha} | \\hat{H} | \\psi_{\\alpha} \\rangle = \\int_{-\\infty}^{\\infty} \\psi_{\\alpha}^{*}(x) \\hat{H} \\psi_{\\alpha}(x) dx\n$$\n由于试探波函数 $\\psi_{\\alpha}(x)$ 是实函数，因此 $\\psi_{\\alpha}^{*}(x) = \\psi_{\\alpha}(x)$。能量泛函可以分解为动能和势能的期望值：\n$$\nE(\\alpha) = \\langle T \\rangle_{\\alpha} + \\langle V \\rangle_{\\alpha}\n$$\n试探波函数为 $\\psi_{\\alpha}(x) = \\left(\\frac{\\alpha}{\\pi}\\right)^{1/4}\\exp\\left(-\\frac{\\alpha x^{2}}{2}\\right)$。相应的概率密度为 $\\psi_{\\alpha}^{2}(x) = \\left(\\frac{\\alpha}{\\pi}\\right)^{1/2}\\exp\\left(-\\alpha x^{2}\\right)$，这是一个高斯分布。\n\n**1. 动能期望值 $\\langle T \\rangle_{\\alpha}$**\n动能期望值可计算如下：\n$$\n\\langle T \\rangle_{\\alpha} = \\int_{-\\infty}^{\\infty} \\psi_{\\alpha}(x) \\left(-\\frac{\\hbar^{2}}{2m}\\frac{d^{2}}{dx^{2}}\\right) \\psi_{\\alpha}(x) dx\n$$\n使用分部积分，这等价于：\n$$\n\\langle T \\rangle_{\\alpha} = \\frac{\\hbar^{2}}{2m} \\int_{-\\infty}^{\\infty} \\left(\\frac{d\\psi_{\\alpha}}{dx}\\right)^{2} dx\n$$\n首先，我们求试探函数的导数：\n$$\n\\frac{d\\psi_{\\alpha}}{dx} = \\left(\\frac{\\alpha}{\\pi}\\right)^{1/4} \\exp\\left(-\\frac{\\alpha x^{2}}{2}\\right) (-\\alpha x) = -\\alpha x \\psi_{\\alpha}(x)\n$$\n因此，$\\left(\\frac{d\\psi_{\\alpha}}{dx}\\right)^{2} = \\alpha^{2} x^{2} \\psi_{\\alpha}^{2}(x)$。将此代入 $\\langle T \\rangle_{\\alpha}$ 的积分中：\n$$\n\\langle T \\rangle_{\\alpha} = \\frac{\\hbar^{2}\\alpha^{2}}{2m} \\int_{-\\infty}^{\\infty} x^{2} \\psi_{\\alpha}^{2}(x) dx = \\frac{\\hbar^{2}\\alpha^{2}}{2m} \\langle x^{2} \\rangle_{\\alpha}\n$$\n项 $\\langle x^{2} \\rangle_{\\alpha}$ 是高斯概率分布 $\\psi_{\\alpha}^{2}(x)$ 的方差，已知其值为 $\\frac{1}{2\\alpha}$。我们可以通过标准积分 $\\int_{-\\infty}^{\\infty} x^{2}e^{-ax^{2}}dx = \\frac{1}{2a}\\sqrt{\\frac{\\pi}{a}}$ 来验证这一点。\n$$\n\\langle x^{2} \\rangle_{\\alpha} = \\left(\\frac{\\alpha}{\\pi}\\right)^{1/2} \\int_{-\\infty}^{\\infty} x^{2}e^{-\\alpha x^{2}}dx = \\left(\\frac{\\alpha}{\\pi}\\right)^{1/2} \\left(\\frac{1}{2\\alpha}\\sqrt{\\frac{\\pi}{\\alpha}}\\right) = \\frac{1}{2\\alpha}\n$$\n将此结果代回 $\\langle T \\rangle_{\\alpha}$ 的表达式中：\n$$\n\\langle T \\rangle_{\\alpha} = \\frac{\\hbar^{2}\\alpha^{2}}{2m} \\left(\\frac{1}{2\\alpha}\\right) = \\frac{\\hbar^{2}\\alpha}{4m}\n$$\n\n**2. 势能期望值 $\\langle V \\rangle_{\\alpha}$**\n势能期望值为：\n$$\n\\langle V \\rangle_{\\alpha} = \\int_{-\\infty}^{\\infty} \\psi_{\\alpha}(x) (\\lambda x^{4}) \\psi_{\\alpha}(x) dx = \\lambda \\int_{-\\infty}^{\\infty} x^{4} \\psi_{\\alpha}^{2}(x) dx = \\lambda \\langle x^{4} \\rangle_{\\alpha}\n$$\n我们需要计算四阶矩 $\\langle x^{4} \\rangle_{\\alpha}$。使用标准积分 $\\int_{-\\infty}^{\\infty} x^{4}e^{-ax^{2}}dx = \\frac{3}{4a^{2}}\\sqrt{\\frac{\\pi}{a}}$：\n$$\n\\langle x^{4} \\rangle_{\\alpha} = \\left(\\frac{\\alpha}{\\pi}\\right)^{1/2} \\int_{-\\infty}^{\\infty} x^{4}e^{-\\alpha x^{2}}dx = \\left(\\frac{\\alpha}{\\pi}\\right)^{1/2} \\left(\\frac{3}{4\\alpha^{2}}\\sqrt{\\frac{\\pi}{\\alpha}}\\right) = \\frac{3}{4\\alpha^{2}}\n$$\n因此，势能期望值为：\n$$\n\\langle V \\rangle_{\\alpha} = \\lambda \\left(\\frac{3}{4\\alpha^{2}}\\right) = \\frac{3\\lambda}{4\\alpha^{2}}\n$$\n\n**3. 能量泛函 $E(\\alpha)$ 的最小化**\n总能量泛函是动能和势能部分之和：\n$$\nE(\\alpha) = \\langle T \\rangle_{\\alpha} + \\langle V \\rangle_{\\alpha} = \\frac{\\hbar^{2}\\alpha}{4m} + \\frac{3\\lambda}{4\\alpha^{2}}\n$$\n为了找到使该能量最小化的 $\\alpha$ 值，我们将 $E(\\alpha)$ 对 $\\alpha$ 求导，并令其结果为零：\n$$\n\\frac{dE(\\alpha)}{d\\alpha} = \\frac{d}{d\\alpha} \\left( \\frac{\\hbar^{2}\\alpha}{4m} + \\frac{3\\lambda}{4\\alpha^{2}} \\right) = \\frac{\\hbar^{2}}{4m} - \\frac{6\\lambda}{4\\alpha^{3}} = 0\n$$\n$$\n\\frac{\\hbar^{2}}{4m} = \\frac{3\\lambda}{2\\alpha^{3}}\n$$\n求解 $\\alpha$ 的最优值，我们记为 $\\alpha_{\\mathrm{min}}$：\n$$\n\\alpha_{\\mathrm{min}}^{3} = \\frac{12m\\lambda}{2\\hbar^{2}} = \\frac{6m\\lambda}{\\hbar^{2}} \\implies \\alpha_{\\mathrm{min}} = \\left(\\frac{6m\\lambda}{\\hbar^{2}}\\right)^{1/3}\n$$\n二阶导数 $\\frac{d^{2}E}{d\\alpha^{2}} = \\frac{18\\lambda}{4\\alpha^{4}} = \\frac{9\\lambda}{2\\alpha^{4}}$ 对于 $\\lambda > 0$ 和 $\\alpha > 0$ 均为正，确认了这是一个极小值点。\n\n**4. 优化的变分能量 $E_{\\mathrm{var}}$**\n将 $\\alpha_{\\mathrm{min}}$ 代入 $E(\\alpha)$ 的表达式中，即可得到优化的变分能量 $E_{\\mathrm{var}}$：\n$$\nE_{\\mathrm{var}} = E(\\alpha_{\\mathrm{min}}) = \\frac{\\hbar^{2}\\alpha_{\\mathrm{min}}}{4m} + \\frac{3\\lambda}{4\\alpha_{\\mathrm{min}}^{2}}\n$$\n在极小值点，我们有关系式 $\\frac{\\hbar^{2}}{4m} = \\frac{3\\lambda}{2\\alpha_{\\mathrm{min}}^{3}}$。两边乘以 $\\alpha_{\\mathrm{min}}$ 得到 $\\frac{\\hbar^{2}\\alpha_{\\mathrm{min}}}{4m} = \\frac{3\\lambda}{2\\alpha_{\\mathrm{min}}^{2}}$。这表明在极小值点，$\\langle T \\rangle = 2\\langle V \\rangle$，这与势函数为 $V(x) \\propto x^{n}$ 时的维里定理（其中 $n=4$ 时应为 $2\\langle T \\rangle = n\\langle V \\rangle$）是一致的。\n我们可以仅用其中一项来表示 $E_{\\mathrm{var}}$。例如，$E_{\\mathrm{var}} = \\langle T \\rangle + \\frac{1}{2}\\langle T \\rangle = \\frac{3}{2}\\langle T \\rangle$。\n$$\nE_{\\mathrm{var}} = \\frac{3}{2} \\left( \\frac{\\hbar^{2}\\alpha_{\\mathrm{min}}}{4m} \\right) = \\frac{3\\hbar^{2}}{8m} \\alpha_{\\mathrm{min}}\n$$\n代入 $\\alpha_{\\mathrm{min}}$ 的表达式：\n$$\nE_{\\mathrm{var}} = \\frac{3\\hbar^{2}}{8m} \\left(\\frac{6m\\lambda}{\\hbar^{2}}\\right)^{1/3} = \\frac{3\\hbar^{2}}{8m} \\frac{(6m\\lambda)^{1/3}}{(\\hbar^{2})^{1/3}}\n$$\n$$\nE_{\\mathrm{var}} = \\frac{3 \\cdot 6^{1/3}}{8} \\hbar^{2-2/3} m^{-1+1/3} \\lambda^{1/3} = \\frac{3 \\cdot 6^{1/3}}{8} \\hbar^{4/3} m^{-2/3} \\lambda^{1/3}\n$$\n这个表达式可以重写以组合参数：\n$$\nE_{\\mathrm{var}}(\\lambda,m,\\hbar) = \\frac{3 \\cdot 6^{1/3}}{8} \\left( \\frac{\\lambda \\hbar^{4}}{m^{2}} \\right)^{1/3}\n$$\n\n**5. 精确能量的标度分析**\n从薛定谔方程出发：\n$$\n-\\frac{\\hbar^{2}}{2m}\\frac{d^{2}\\psi}{dx^{2}} + \\lambda x^{4} \\psi = E\\psi\n$$\n我们引入一个无量纲坐标 $u = x/x_{0}$，其中 $x_{0}$ 是某个特征长度。于是 $x=ux_{0}$ 且 $\\frac{d^{2}}{dx^{2}} = \\frac{1}{x_{0}^{2}}\\frac{d^{2}}{du^{2}}$。以 $u$ 表示的方程变为：\n$$\n-\\frac{\\hbar^{2}}{2mx_{0}^{2}}\\frac{d^{2}\\psi}{du^{2}} + \\lambda (ux_{0})^{4} \\psi = E\\psi\n$$\n为了使方程无量纲化，我们乘以 $\\frac{2mx_{0}^{2}}{\\hbar^{2}}$：\n$$\n-\\frac{d^{2}\\psi}{du^{2}} + \\frac{2m\\lambda x_{0}^{6}}{\\hbar^{2}} u^{4} \\psi = \\frac{2mEx_{0}^{2}}{\\hbar^{2}} \\psi\n$$\n我们选择 $x_{0}$ 使得势能项的系数为 1：\n$$\n\\frac{2m\\lambda x_{0}^{6}}{\\hbar^{2}} = 1 \\implies x_{0}^{6} = \\frac{\\hbar^{2}}{2m\\lambda} \\implies x_{0} = \\left(\\frac{\\hbar^{2}}{2m\\lambda}\\right)^{1/6}\n$$\n方程于是呈现为一个无量纲本征值问题的形式：\n$$\n\\left(-\\frac{d^{2}}{du^{2}} + u^{4}\\right) \\psi = \\mathcal{E}\\psi\n$$\n其中 $\\mathcal{E} = \\frac{2mEx_{0}^{2}}{\\hbar^{2}}$ 是一个无量纲的能量本征值。基态将对应于最低的本征值 $\\mathcal{E}_{0}$，它是一个纯数。物理能量 $E$ 与 $\\mathcal{E}$ 的关系为：\n$$\nE = \\mathcal{E} \\frac{\\hbar^{2}}{2mx_{0}^{2}}\n$$\n代入 $x_{0}^{2} = \\left(\\frac{\\hbar^{2}}{2m\\lambda}\\right)^{1/3}$：\n$$\nE = \\mathcal{E} \\frac{\\hbar^{2}}{2m} \\left(\\frac{\\hbar^{2}}{2m\\lambda}\\right)^{-1/3} = \\mathcal{E} \\frac{\\hbar^{2}}{2m} \\left(\\frac{2m\\lambda}{\\hbar^{2}}\\right)^{1/3} = \\mathcal{E} \\frac{\\hbar^{2}}{2m} \\frac{(2m\\lambda)^{1/3}}{(\\hbar^{2})^{1/3}}\n$$\n$$\nE = \\left(\\frac{\\mathcal{E} \\cdot 2^{1/3}}{2}\\right) \\hbar^{4/3} m^{-2/3} \\lambda^{1/3}\n$$\n因此，精确能量 $E$ 必须随参数按 $E \\propto \\hbar^{4/3} m^{-2/3} \\lambda^{1/3}$ 的规律标度，或者等价地 $E \\propto \\left( \\frac{\\lambda \\hbar^{4}}{m^{2}} \\right)^{1/3}$。\n\n**比较与结论**\n变分上界 $E_{\\mathrm{var}} \\propto \\left( \\frac{\\lambda \\hbar^{4}}{m^{2}} \\right)^{1/3}$ 与真实基态能量具有完全相同的对 $\\lambda, m, \\hbar$ 的标度依赖关系。这表明，高斯试探波函数虽然不是精确解，但它捕捉了系统正确的基准标度特性。变分能量与精确能量之间的差异仅在于数值前置因子。\n题目要求给出优化的变分上界 $E_{\\mathrm{var}}(\\lambda,m,\\hbar)$ 的闭合形式解析表达式。", "answer": "$$\n\\boxed{\\frac{3 \\cdot 6^{1/3}}{8} \\left( \\frac{\\lambda \\hbar^{4}}{m^{2}} \\right)^{1/3}}\n$$", "id": "2922377"}, {"introduction": "将连续的量子力学方程转化为可在计算机上求解的离散问题，是现代计算化学的核心。本练习将通过有限差分法，带你亲手实现这一转变，将一维定态薛定谔方程构建为一个矩阵本征值问题。这个过程不仅能让你直观地看到数值解如何收敛于精确解，更能让你深刻理解网格间距等离散化参数如何影响计算的精度，为日后使用和开发更高级的量子化学计算程序打下至关重要的实践基础。[@problem_id:2922376]", "problem": "考虑一个质量为 $m$ 的单个粒子在势能 $V(x)$ 中运动的一维不含时薛定谔方程 (TISE)，该方程以 $\\hbar = 1$ 和 $m = 1$ 的无量纲单位书写。您需要将 TISE 表述为一个在均匀网格上带有狄利克雷边界条件的有限差分特征值问题，并分析网格间距如何影响定态能量和波函数的精度。\n\n使用的基本原理：\n- 定态的定义，即 TISE $H \\psi(x) = E \\psi(x)$ 的解，其中 $H = -\\frac{1}{2}\\frac{d^2}{dx^2} + V(x)$。\n- 在均匀网格上二阶导数的中心差分近似。\n- 用于束缚态或无限深势阱的标准狄利克雷边界条件，$\\psi(a) = 0$ 和 $\\psi(b) = 0$。\n- 中心差分会引入一个与网格间距的平方成正比的截断误差。\n- 使用 $L^2$ 内积来评估波函数的精度。\n\n你的任务：\n1. 从 TISE 和均匀网格上二阶导数的中心差分近似出发，推导在有限区间 $[a,b]$ 上带有狄利克雷边界条件的哈密顿算符的离散矩阵特征值问题。不要假设任何预先推导的有限差分模板或矩阵形式；而是根据上面列出的第一性原理进行推导。\n2. 实现一个程序，该程序构建内部网格点上的离散哈密顿量，计算最低的 $k$ 个定态能量和波函数，并将其与指定测试势能的精确参考解进行比较。在你的实现中使用以下原则：\n   - 使用一个具有 $M$ 个内部点的均匀网格，因此网格间距为 $h = \\frac{b-a}{M+1}$，内部点为 $x_i = a + i h$，其中 $i = 1, \\dots, M$。\n   - 在 $x=a$ 和 $x=b$ 处施加狄利克雷边界条件。\n   - 计算离散哈密顿量的 $k$ 个最低特征值和相应的特征向量。\n   - 对于 $\\{0,1,\\dots,k-1\\}$ 中的每个状态索引 $n$，计算相对能量误差 $\\left|\\frac{E_n^{\\mathrm{num}} - E_n^{\\mathrm{exact}}}{E_n^{\\mathrm{exact}}}\\right|$ 和波函数不忠实度 $1 - \\left|\\langle \\psi_n^{\\mathrm{num}}, \\psi_n^{\\mathrm{exact}} \\rangle_h \\right|$，其中 $\\langle f,g \\rangle_h = \\sum_{i=1}^{M} f(x_i) g(x_i)\\, h$ 是离散 $L^2$ 内积。在评估重叠之前，确保根据此离散内积对数值波函数和精确波函数进行归一化。通过取重叠的绝对值来处理特征向量的任意符号。\n3. 通过报告每个测试案例中前 $k$ 个状态的最差误差，分析网格间距 $h$ 如何影响计算出的定态能量和波函数。\n\n势能及精确参考数据：\n- 角频率为 $\\omega$ 的谐振子：$V(x) = \\tfrac{1}{2} \\omega^2 x^2$，精确能量为 $E_n^{\\mathrm{exact}} = \\left(n + \\tfrac{1}{2}\\right)\\omega$，精确本征函数为 $\\psi_n^{\\mathrm{exact}}(x) = \\frac{1}{\\sqrt{2^n n!}} \\left(\\frac{\\omega}{\\pi}\\right)^{1/4} H_n\\!\\left(\\sqrt{\\omega}\\, x\\right) \\exp\\!\\left(-\\tfrac{1}{2}\\omega x^2\\right)$，其中 $H_n$ 是物理学家厄米多项式，$n \\in \\{0,1,2,\\dots\\}$。\n- 在 $[0,L]$ 上的无限深方势阱：当 $x \\in (0,L)$ 时 $V(x) = 0$，在区间外 $V(x) = +\\infty$。精确能量为 $E_n^{\\mathrm{exact}} = \\frac{\\pi^2 n^2}{2 L^2}$，其中 $n \\in \\{1,2,3,\\dots\\}$，精确本征函数为 $\\psi_n^{\\mathrm{exact}}(x) = \\sqrt{\\frac{2}{L}} \\sin\\!\\left(\\frac{n\\pi x}{L}\\right)$（在 $(0,L)$ 上），且 $\\psi_n^{\\mathrm{exact}}(0)=\\psi_n^{\\mathrm{exact}}(L)=0$。为了与离散结果进行比较，通过索引将第 $n$ 个数值状态与相应的第 $n$ 个精确状态进行匹配。\n\n单位：\n- 完全在指定的无量纲单位中工作，即 $\\hbar = 1$ 和 $m = 1$。将能量和误差报告为无量纲数。\n\n测试套件：\n所有情况均使用 $k = 3$。对于每种情况，计算前 $k$ 个状态中的最大相对能量误差和最差波函数不忠实度，并按此顺序输出这两个浮点数。\n- 案例 1（谐振子，粗糙网格）：$\\omega = 1$, $a = -8$, $b = 8$, $M = 41$。\n- 案例 2（谐振子，中等网格）：$\\omega = 1$, $a = -8$, $b = 8$, $M = 201$。\n- 案例 3（谐振子，精细网格）：$\\omega = 1$, $a = -8$, $b = 8$, $M = 801$。\n- 案例 4（无限深方势阱，中等网格）：$L = 1$, $a = 0$, $b = L$, $M = 51$。\n- 案例 5（无限深方势阱，粗糙网格）：$L = 1$, $a = 0$, $b = L$, $M = 11$。\n\n答案规范：\n- 对于 5 个测试案例中的每一个，计算：\n  - 前 $k=3$ 个状态的最大相对能量误差，对于谐振子定义为 $\\max_{0 \\le n \\le 2} \\left|\\frac{E_n^{\\mathrm{num}} - E_n^{\\mathrm{exact}}}{E_n^{\\mathrm{exact}}}\\right|$，对于无限深势阱定义为 $\\max_{1 \\le n \\le 3} \\left|\\frac{E_n^{\\mathrm{num}} - E_n^{\\mathrm{exact}}}{E_n^{\\mathrm{exact}}}\\right|$（注意索引的移位）。\n  - 相同状态下的最差波函数不忠实度，定义为 $\\max \\left(1 - \\left|\\langle \\psi_n^{\\mathrm{num}}, \\psi_n^{\\mathrm{exact}} \\rangle_h \\right|\\right)$，其中两个函数都在离散 $L^2$ 范数下归一化。\n- 你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果。该列表必须按以下顺序包含 10 个浮点数：对于案例 1，是两个浮点数（能量误差，波函数不忠实度），然后是案例 2 的两个浮点数，以此类推直到案例 5。例如，一个带有占位符值的输出将如下所示：$[e_1,w_1,e_2,w_2,e_3,w_3,e_4,w_4,e_5,w_5]$。\n\n你的实现必须是一个完整、可运行的程序，该程序按照所述从第一性原理构建有限差分哈密顿量，计算所需的量，并以指定的格式精确打印最终结果行。", "solution": "提交评估的问题 R-891-B 是有效的。它在科学上是合理的、良态的，并且为获得唯一解提供了所有必要的数据和条件。该问题是计算量子物理学中的一个标准练习，具体来说是使用有限差分法数值求解一维不含时薛定谔方程。我将按要求进行推导和计算求解。\n\n### 1. 离散哈密顿矩阵的推导\n\n出发点是在无量纲单位（$\\hbar = 1, m = 1$）下的一维不含时薛定谔方程 (TISE)：\n$$\nH \\psi(x) = E \\psi(x)\n$$\n其中哈密顿算符 $H$ 由下式给出：\n$$\nH = -\\frac{1}{2}\\frac{d^2}{dx^2} + V(x)\n$$\n我们将空间域 $[a, b]$ 离散化为一个均匀网格。假设有 $M$ 个内部网格点。总区间数为 $M+1$。网格间距为 $h = \\frac{b-a}{M+1}$。网格点为 $x_i = a + i h$，其中 $i = 0, 1, \\dots, M+1$。内部点为 $\\{x_1, \\dots, x_M\\}$。这些点上的波函数值记为 $\\psi_i = \\psi(x_i)$。\n\n狄利克雷边界条件要求波函数在区域边界处为零：\n$$\n\\psi(a) = \\psi(x_0) = \\psi_0 = 0\n$$\n$$\n\\psi(b) = \\psi(x_{M+1}) = \\psi_{M+1} = 0\n$$\n波函数的二阶导数 $\\frac{d^2\\psi}{dx^2}$ 在一个内部网格点 $x_i$ 处使用中心差分公式进行近似，该公式的截断误差为 $O(h^2)$ 阶：\n$$\n\\frac{d^2\\psi}{dx^2}\\bigg|_{x=x_i} \\approx \\frac{\\psi(x_i+h) - 2\\psi(x_i) + \\psi(x_i-h)}{h^2} = \\frac{\\psi_{i+1} - 2\\psi_i + \\psi_{i-1}}{h^2}\n$$\n将此近似代入 TISE，我们得到每个内部点 $x_i$（其中 $i = 1, \\dots, M$）的离散方程：\n$$\n-\\frac{1}{2} \\left( \\frac{\\psi_{i+1} - 2\\psi_i + \\psi_{i-1}}{h^2} \\right) + V(x_i)\\psi_i = E\\psi_i\n$$\n重新整理各项以组合 $\\psi_j$ 分量，得到：\n$$\n-\\frac{1}{2h^2}\\psi_{i-1} + \\left( \\frac{1}{h^2} + V(x_i) \\right) \\psi_i - \\frac{1}{2h^2}\\psi_{i+1} = E\\psi_i\n$$\n这代表了关于未知波函数值 $\\{\\psi_1, \\dots, \\psi_M\\}$ 的一个包含 $M$ 个耦合线性代数方程的系统。该系统可以写成矩阵形式的特征值问题：\n$$\n\\mathbf{H} \\vec{\\psi} = E \\vec{\\psi}\n$$\n其中 $\\vec{\\psi} = [\\psi_1, \\psi_2, \\dots, \\psi_M]^T$ 是内部网格点上波函数值的列向量，$\\mathbf{H}$ 是 $M \\times M$ 的离散哈密顿矩阵。\n\n矩阵元 $H_{ij}$ 通过考虑每个 $i$ 的方程来确定：\n- 对于 $i=1$：$-\\frac{1}{2h^2}\\psi_0 + \\left(\\frac{1}{h^2} + V_1\\right)\\psi_1 - \\frac{1}{2h^2}\\psi_2 = E\\psi_1$。由于 $\\psi_0=0$，方程变为 $\\left(\\frac{1}{h^2} + V_1\\right)\\psi_1 - \\frac{1}{2h^2}\\psi_2 = E\\psi_1$。\n- 对于 $1 < i < M$：$-\\frac{1}{2h^2}\\psi_{i-1} + \\left(\\frac{1}{h^2} + V_i\\right)\\psi_i - \\frac{1}{2h^2}\\psi_{i+1} = E\\psi_i$。\n- 对于 $i=M$：$-\\frac{1}{2h^2}\\psi_{M-1} + \\left(\\frac{1}{h^2} + V_M\\right)\\psi_M - \\frac{1}{2h^2}\\psi_{M+1} = E\\psi_M$。由于 $\\psi_{M+1}=0$，方程变为 $-\\frac{1}{2h^2}\\psi_{M-1} + \\left(\\frac{1}{h^2} + V_M\\right)\\psi_M = E\\psi_M$。\n\n从这些方程中，我们可以构建哈密顿矩阵 $\\mathbf{H}$。它是一个实对称三对角矩阵，其元素如下：\n- 对角元：$H_{ii} = \\frac{1}{h^2} + V(x_i)$，其中 $i = 1, \\dots, M$。\n- 非对角元（次对角线和超对角线）：$H_{i,i+1} = H_{i+1,i} = -\\frac{1}{2h^2}$，其中 $i=1, \\dots, M-1$。\n- 所有其他元素均为零。\n\n这就完成了离散矩阵特征值问题的推导。\n\n### 2. 数值实现与分析\n\n数值求解过程如下：\n1.  **构建哈密顿矩阵**：对于每个测试案例，使用网格参数（$a, b, M$）和势能 $V(x)$ 来构建上面推导的 $M \\times M$ 矩阵 $\\mathbf{H}$。\n2.  **求解特征值问题**：计算实对称矩阵 $\\mathbf{H}$ 的特征值（定态能量 $E_n^{\\mathrm{num}}$）和特征向量（离散化波函数 $\\vec{\\psi}_n^{\\mathrm{num}}$）。我们为此使用一个优化的数值库例程，它提供升序排列的特征值和相应的标准正交特征向量。我们选择最低的 $k=3$ 个解。标准特征求解器产生的特征向量通常是根据欧几里得范数进行归一化的，例如 $\\sum_{i=1}^M (\\psi_{n,i}^{\\mathrm{num}})^2 = 1$。\n3.  **计算精确解**：对于每个数值态 $n$，根据为谐振子和无限深方势阱提供的解析公式计算相应的精确能量 $E_n^{\\mathrm{exact}}$ 和精确波函数 $\\psi_n^{\\mathrm{exact}}(x)$。对于无限深方势阱，数值态 $n=0, 1, 2$ 对应于量子数为 $n=1, 2, 3$ 的精确态。\n4.  **离散化和归一化波函数**：\n    -   在内部网格点 $\\{x_i\\}$ 上评估精确波函数 $\\psi_n^{\\mathrm{exact}}(x)$ 以形成向量 $\\vec{\\phi}_n^{\\mathrm{exact}}$。\n    -   数值特征向量 $\\vec{\\psi}_n^{\\mathrm{num}}$ 和精确波函数向量 $\\vec{\\phi}_n^{\\mathrm{exact}}$ 都必须根据离散 $L^2$ 内积进行归一化，该内积定义为 $\\langle f,g \\rangle_h = \\sum_{i=1}^{M} f(x_i) g(x_i)\\, h$。如果 $\\langle f,f \\rangle_h = 1$，则向量 $\\vec{f}$ 是归一化的。\n    -   来自特征求解器（欧几里得范数为1）的数值特征向量 $\\vec{\\psi}_n^{\\mathrm{num}}$ 通过除以 $\\sqrt{h}$ 进行归一化。记为 $\\tilde{\\psi}_n^{\\mathrm{num}}$。\n    -   精确波函数向量 $\\vec{\\phi}_n^{\\mathrm{exact}}$ 通过除以其离散范数 $N_{\\mathrm{exact}} = \\sqrt{\\langle \\phi_n^{\\mathrm{exact}}, \\phi_n^{\\mathrm{exact}} \\rangle_h}$ 来进行归一化。记为 $\\tilde{\\psi}_n^{\\mathrm{exact}}$。\n5.  **计算误差**：对于 $k=3$ 个最低状态中的每一个：\n    -   **相对能量误差**：$\\epsilon_E(n) = \\left|\\frac{E_n^{\\mathrm{num}} - E_n^{\\mathrm{exact}}}{E_n^{\\mathrm{exact}}}\\right|$。\n    -   **波函数不忠实度**：重叠计算为 $C_n = \\langle \\tilde{\\psi}_n^{\\mathrm{num}}, \\tilde{\\psi}_n^{\\mathrm{exact}} \\rangle_h$。不忠实度是 $\\epsilon_\\psi(n) = 1 - |C_n|$。取绝对值以考虑特征向量的任意符号。\n6.  **报告最差情况误差**：对于每个测试案例，计算并报告前 $k=3$ 个状态的最大相对能量误差 $\\max_{n} \\epsilon_E(n)$ 和最大波函数不忠实度 $\\max_{n} \\epsilon_\\psi(n)$。对所有五个测试案例重复此过程。结果汇总到单个列表中作为最终输出。", "answer": "```python\nimport numpy as np\nfrom scipy.linalg import eigh\nfrom scipy.special import hermite, factorial\n\ndef solve():\n    \"\"\"\n    Solves the 1D TISE for given potentials using the finite difference method\n    and computes errors against exact solutions.\n    \"\"\"\n\n    test_cases = [\n        # Case 1: Harmonic oscillator, coarse grid\n        {'type': 'ho', 'omega': 1.0, 'a': -8.0, 'b': 8.0, 'M': 41, 'k': 3},\n        # Case 2: Harmonic oscillator, moderate grid\n        {'type': 'ho', 'omega': 1.0, 'a': -8.0, 'b': 8.0, 'M': 201, 'k': 3},\n        # Case 3: Harmonic oscillator, fine grid\n        {'type': 'ho', 'omega': 1.0, 'a': -8.0, 'b': 8.0, 'M': 801, 'k': 3},\n        # Case 4: Infinite square well, moderate grid\n        {'type': 'isw', 'L': 1.0, 'a': 0.0, 'b': 1.0, 'M': 51, 'k': 3},\n        # Case 5: Infinite square well, coarse grid\n        {'type': 'isw', 'L': 1.0, 'a': 0.0, 'b': 1.0, 'M': 11, 'k': 3},\n    ]\n\n    all_results = []\n    for case in test_cases:\n        max_energy_error, max_wf_infidelity = compute_errors(case)\n        all_results.extend([max_energy_error, max_wf_infidelity])\n\n    print(f\"[{','.join(f'{x:.7e}' for x in all_results)}]\")\n\ndef compute_errors(params):\n    \"\"\"\n    Computes max energy error and wavefunction infidelity for a single test case.\n    \"\"\"\n    potential_type = params['type']\n    a, b, M, k = params['a'], params['b'], params['M'], params['k']\n\n    # 1. Set up the grid\n    h = (b - a) / (M + 1)\n    x = np.linspace(a + h, b - h, M)\n\n    # 2. Define the potential\n    if potential_type == 'ho':\n        omega = params['omega']\n        V = 0.5 * omega**2 * x**2\n    elif potential_type == 'isw':\n        V = np.zeros(M)\n    else:\n        raise ValueError(\"Unknown potential type\")\n\n    # 3. Construct the Hamiltonian matrix\n    T_diag = np.ones(M) / h**2\n    T_offdiag = -1.0 / (2.0 * h**2) * np.ones(M - 1)\n    \n    H = np.diag(T_diag + V) + np.diag(T_offdiag, k=1) + np.diag(T_offdiag, k=-1)\n\n    # 4. Solve the eigenvalue problem\n    # eigh returns eigenvalues in ascending order and corresponding eigenvectors\n    eigenvalues, eigenvectors = eigh(H)\n    \n    # Select the lowest k states\n    num_energies = eigenvalues[:k]\n    num_wavefunctions = eigenvectors[:, :k]\n\n    energy_errors = []\n    wf_infidelities = []\n\n    for n_idx in range(k):\n        # 5. Get numerical solution\n        E_num = num_energies[n_idx]\n        psi_num_unnormalized = num_wavefunctions[:, n_idx]\n\n        # 6. Get exact solution\n        if potential_type == 'ho':\n            n = n_idx\n            omega = params['omega']\n            E_exact = (n + 0.5) * omega\n\n            # Physicists' Hermite polynomials\n            Hn_poly = hermite(n)\n            # Normalization constant for continuous L2 norm on (-inf, inf)\n            norm_const = 1.0 / np.sqrt(2**n * factorial(n)) * (omega / np.pi)**0.25\n            psi_exact_on_grid = norm_const * Hn_poly(np.sqrt(omega) * x) * np.exp(-0.5 * omega * x**2)\n        \n        elif potential_type == 'isw':\n            n = n_idx + 1 # Physical quantum number n=1,2,3...\n            L = params['L']\n            E_exact = (n**2 * np.pi**2) / (2 * L**2)\n            \n            # Normalization constant for continuous L2 norm on [0, L]\n            norm_const = np.sqrt(2.0 / L)\n            psi_exact_on_grid = norm_const * np.sin(n * np.pi * x / L)\n\n        # 7. Normalize wavefunctions using the discrete L2 inner product\n        # The inner product is defined as <f|g>_h = sum(f*g*h)\n        \n        # Eigenvectors from eigh are normalized to sum(psi^2) = 1.\n        # We need sum(psi^2 * h) = 1, so we must divide by sqrt(h).\n        psi_num_norm = psi_num_unnormalized / np.sqrt(h)\n\n        # Normalize the exact wavefunction on the grid\n        norm_sq_exact = np.sum(psi_exact_on_grid**2) * h\n        psi_exact_norm = psi_exact_on_grid / np.sqrt(norm_sq_exact)\n\n        # 8. Calculate errors\n        # Relative energy error\n        rel_energy_error = np.abs((E_num - E_exact) / E_exact)\n        energy_errors.append(rel_energy_error)\n\n        # Wavefunction infidelity: 1 - |<psi_num, psi_exact>_h|\n        # The overlap includes the factor of h from the inner product definition.\n        overlap = np.sum(psi_num_norm * psi_exact_norm) * h\n        infidelity = 1.0 - np.abs(overlap)\n        wf_infidelities.append(infidelity)\n\n    return np.max(energy_errors), np.max(wf_infidelities)\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "2922376"}]}