{"hands_on_practices": [{"introduction": "高斯波包是描述局域粒子的一种理想化的量子力学模型。与直觉中的经典粒子不同，一个自由量子粒子的波包会随着时间不可避免地弥散开来。本练习将引导你从第一性原理出发，推导这种量子弥散的具体形式，并计算其特征时间 [@problem_id:2892591]。通过分析结果，你将深入理解质量 $m$、初始局域化程度 $\\sigma$ 以及普朗克常数 $\\hbar$ 如何共同决定了波包的演化。", "problem": "一个质量为 $m$ 的一维自由粒子在时刻 $t=0$ 时被制备在归一化的高斯波包中\n$$\n\\psi(x,0)=\\left(\\frac{1}{2\\pi\\sigma^{2}}\\right)^{1/4}\\exp\\!\\left[-\\frac{(x-x_{0})^{2}}{4\\sigma^{2}}+\\frac{i p_{0} x}{\\hbar}\\right],\n$$\n其中 $\\sigma>0$ 是一个实数宽度参数，$x_{0}\\in\\mathbb{R}$ 是初始平均位置，$p_{0}\\in\\mathbb{R}$ 是初始平均动量，$\\hbar$ 是约化普朗克常数。该粒子在哈密顿量为 $\\hat{H}=\\hat{p}^{2}/(2m)$ 的自由粒子的含时薛定谔方程下演化，且满足正则对易关系 $[\\hat{x},\\hat{p}]=i\\hbar$。\n\n仅从这些基本原理出发，推导位置方差 $\\operatorname{Var}[x](t)$ 的时间依赖关系，并确定空间方差相对于其在 $t=0$ 时的初始值增加一倍的第一个正时刻 $t_{s}$。将你得到的 $t_{s}$ 最终答案表示为 $m$、$\\sigma$ 和 $\\hbar$ 的闭式表达式。然后，基于你推导的表达式，简要讨论 $t_{s}$ 如何依赖于 $m$、$\\sigma$ 和 $\\hbar$，并解释在经典极限 $m\\to\\infty$ 下的行为。\n\n你最终报告的答案必须仅为 $t_{s}$ 的单一解析表达式。", "solution": "在尝试任何解答之前，将首先对问题进行严格的验证程序。\n\n问题验证\n\n步骤 1：提取已知条件\n问题逐字提供了以下信息：\n- 一个质量为 $m$ 的一维自由粒子。\n- 初始状态在 $t=0$ 时：一个归一化的高斯波包 $\\psi(x,0)=\\left(\\frac{1}{2\\pi\\sigma^{2}}\\right)^{1/4}\\exp\\!\\left[-\\frac{(x-x_{0})^{2}}{4\\sigma^{2}}+\\frac{i p_{0} x}{\\hbar}\\right]$。\n- 参数：$\\sigma>0$ 是一个实数宽度参数，$x_{0}\\in\\mathbb{R}$ 是初始平均位置，$p_{0}\\in\\mathbb{R}$ 是初始平均动量，$\\hbar$ 是约化普朗克常数。\n- 动力学：粒子在自由粒子的含时薛定谔方程下演化。\n- 哈密顿量：$\\hat{H}=\\hat{p}^{2}/(2m)$。\n- 对易关系：$[\\hat{x},\\hat{p}]=i\\hbar$。\n- 目标：推导位置方差 $\\operatorname{Var}[x](t)$ 的时间依赖关系。\n- 目标：确定空间方差相对于其初始值增加一倍的第一个正时刻 $t_{s}$，即 $\\operatorname{Var}[x](t_{s})=2\\operatorname{Var}[x](0)$。\n- 目标：将 $t_{s}$ 的最终答案表示为 $m$、$\\sigma$ 和 $\\hbar$ 的闭式表达式。\n- 目标：讨论 $t_{s}$ 对各参数的依赖关系及其在经典极限下的行为。\n\n步骤 2：使用提取的已知条件进行验证\n根据所需标准对问题进行审查。\n- **科学基础**：该问题是量子力学中关于自由粒子高斯波包动力学的经典练习。所有原理、方程和定义——薛定谔方程、自由粒子哈密顿量、正则对易关系以及高斯波包的形式——都是标准的且根本上正确的。\n- **适定性**：该问题是适定的。初始状态已指定，运动的控制方程已给出，待计算的量已明确定义。预期存在唯一且稳定的解。\n- **客观性**：该问题以精确、客观的数学语言陈述，没有歧义或主观内容。\n- **缺陷分析**：问题陈述中存在一个微小的不一致之处，它要求答案以“秒”为单位表示，却没有提供任何数值，但这一要求立即被“提供一个‘闭式表达式’”的指令以及最终答案必须是单一解析表达式的全局规则所取代。这个小瑕疵不会使问题无效；它仅仅要求我们采纳更具体、更主导的指令进行正确解释。此外，该问题是自洽的、一致的且科学上合理的。\n\n步骤 3：结论与行动\n该问题是**有效的**。将推导解答。\n\n解答\n求方差时间演化的最直接方法是使用海森堡绘景，该绘景描述了算符的时间演化。位置算符 $\\hat{x}$ 在时刻 $t$ 的方差由 $\\operatorname{Var}[x](t) = \\langle \\hat{x}(t)^2 \\rangle - \\langle \\hat{x}(t) \\rangle^2$ 给出，其中期望值是相对于初始态 $\\psi(x,0)$ 计算的。\n\n算符 $\\hat{A}(t)$ 的海森堡运动方程为 $\\frac{d\\hat{A}(t)}{dt} = \\frac{1}{i\\hbar}[\\hat{A}(t), \\hat{H}]$。自由粒子的哈密顿量为 $\\hat{H} = \\frac{\\hat{p}^2}{2m}$。\n\n首先，我们确定位置算符 $\\hat{x}(t)$ 和动量算符 $\\hat{p}(t)$ 的时间演化。在 $t=0$ 时，我们有 $\\hat{x}(0) = \\hat{x}$ 和 $\\hat{p}(0) = \\hat{p}$。\n对于动量算符：\n$$ \\frac{d\\hat{p}(t)}{dt} = \\frac{1}{i\\hbar}[\\hat{p}, \\frac{\\hat{p}^2}{2m}] = 0 $$\n因此，动量算符是一个运动守恒量：$\\hat{p}(t) = \\hat{p}(0) = \\hat{p}$。\n\n对于位置算符：\n$$ \\frac{d\\hat{x}(t)}{dt} = \\frac{1}{i\\hbar}[\\hat{x}, \\frac{\\hat{p}^2}{2m}] = \\frac{1}{2mi\\hbar}([\\hat{x},\\hat{p}]\\hat{p} + \\hat{p}[\\hat{x},\\hat{p}]) = \\frac{1}{2mi\\hbar}(i\\hbar\\hat{p} + \\hat{p}i\\hbar) = \\frac{\\hat{p}}{m} $$\n对时间积分得到：\n$$ \\hat{x}(t) = \\hat{x}(0) + \\frac{\\hat{p}(0)}{m}t = \\hat{x} + \\frac{\\hat{p}}{m}t $$\n\n接下来，我们计算相对于初始态 $\\psi(x,0)$ 的期望值。在 $t=0$ 时的概率密度为：\n$$ |\\psi(x,0)|^2 = \\left(\\frac{1}{2\\pi\\sigma^2}\\right)^{1/2} \\exp\\left[-\\frac{(x-x_0)^2}{2\\sigma^2}\\right] $$\n这是一个均值为 $x_0$、方差为 $\\sigma^2$ 的正态分布。\n通过观察和对称性论证，在 $t=0$ 时的位置和动量期望值为：\n$$ \\langle \\hat{x} \\rangle_0 = x_0 $$\n$$ \\langle \\hat{p} \\rangle_0 = p_0 $$\n在 $t=0$ 时的位置方差由参数 $\\sigma$ 直接给出：\n$$ \\operatorname{Var}[x](0) = (\\Delta x)_0^2 = \\langle (\\hat{x} - \\langle \\hat{x} \\rangle_0)^2 \\rangle_0 = \\sigma^2 $$\n初始态是一个最小不确定性高斯波包，因此它满足条件 $(\\Delta x)_0 (\\Delta p)_0 = \\hbar/2$。由此，我们求得初始动量方差：\n$$ (\\Delta p)_0^2 = \\frac{\\hbar^2}{4(\\Delta x)_0^2} = \\frac{\\hbar^2}{4\\sigma^2} $$\n\n现在，我们求含时期望值。\n平均位置为：\n$$ \\langle \\hat{x} \\rangle(t) = \\langle \\hat{x}(t) \\rangle_0 = \\left\\langle \\hat{x} + \\frac{\\hat{p}}{m}t \\right\\rangle_0 = \\langle \\hat{x} \\rangle_0 + \\frac{\\langle \\hat{p} \\rangle_0}{m}t = x_0 + \\frac{p_0}{m}t $$\n这描述了波包中心的经典轨道。\n\n位置算符平方的期望值为：\n$$ \\langle \\hat{x}^2 \\rangle(t) = \\langle \\hat{x}(t)^2 \\rangle_0 = \\left\\langle \\left(\\hat{x} + \\frac{\\hat{p}}{m}t\\right)^2 \\right\\rangle_0 = \\left\\langle \\hat{x}^2 + \\frac{t}{m}(\\hat{x}\\hat{p}+\\hat{p}\\hat{x}) + \\frac{t^2}{m^2}\\hat{p}^2 \\right\\rangle_0 $$\n$$ \\langle \\hat{x}^2 \\rangle(t) = \\langle \\hat{x}^2 \\rangle_0 + \\frac{t}{m}\\langle \\hat{x}\\hat{p}+\\hat{p}\\hat{x} \\rangle_0 + \\frac{t^2}{m^2}\\langle \\hat{p}^2 \\rangle_0 $$\n我们需要初始的二阶矩 $\\langle \\hat{x}^2 \\rangle_0$ 和 $\\langle \\hat{p}^2 \\rangle_0$。\n$$ \\langle \\hat{x}^2 \\rangle_0 = (\\Delta x)_0^2 + \\langle \\hat{x} \\rangle_0^2 = \\sigma^2 + x_0^2 $$\n$$ \\langle \\hat{p}^2 \\rangle_0 = (\\Delta p)_0^2 + \\langle \\hat{p} \\rangle_0^2 = \\frac{\\hbar^2}{4\\sigma^2} + p_0^2 $$\n相关项为 $\\langle \\hat{x}\\hat{p}+\\hat{p}\\hat{x} \\rangle_0$。因为 $\\hat{x}\\hat{p}+\\hat{p}\\hat{x} = 2\\hat{x}\\hat{p} - [\\hat{x},\\hat{p}] = 2\\hat{x}\\hat{p} - i\\hbar$，其期望值为 $2\\langle \\hat{x}\\hat{p} \\rangle_0 - i\\hbar$。此外，$\\langle (\\hat{x}\\hat{p})^\\dagger \\rangle_0 = \\langle \\hat{p}\\hat{x} \\rangle_0 = \\langle \\hat{x}\\hat{p} \\rangle_0^*$。因此 $\\langle \\hat{x}\\hat{p}+\\hat{p}\\hat{x} \\rangle_0 = 2\\operatorname{Re}(\\langle \\hat{x}\\hat{p} \\rangle_0)$。直接计算表明 $\\langle \\hat{x}\\hat{p} \\rangle_0 = x_0 p_0 + i\\hbar/2$。所以，\n$$ \\langle \\hat{x}\\hat{p}+\\hat{p}\\hat{x} \\rangle_0 = 2\\operatorname{Re}(x_0 p_0 + i\\hbar/2) = 2x_0 p_0 $$\n将这些代入 $\\langle \\hat{x}^2 \\rangle(t)$ 的表达式中：\n$$ \\langle \\hat{x}^2 \\rangle(t) = (\\sigma^2 + x_0^2) + \\frac{t}{m}(2x_0 p_0) + \\frac{t^2}{m^2}\\left(\\frac{\\hbar^2}{4\\sigma^2} + p_0^2\\right) $$\n$$ \\langle \\hat{x}^2 \\rangle(t) = \\sigma^2 + \\frac{\\hbar^2 t^2}{4m^2\\sigma^2} + \\left(x_0^2 + \\frac{2x_0 p_0}{m}t + \\frac{p_0^2 t^2}{m^2}\\right) $$\n\n现在我们计算方差 $\\operatorname{Var}[x](t) = \\langle \\hat{x}^2 \\rangle(t) - (\\langle \\hat{x} \\rangle(t))^2$：\n$$ (\\langle \\hat{x} \\rangle(t))^2 = \\left(x_0 + \\frac{p_0}{m}t\\right)^2 = x_0^2 + \\frac{2x_0 p_0}{m}t + \\frac{p_0^2 t^2}{m^2} $$\n从 $\\langle \\hat{x}^2 \\rangle(t)$ 中减去此项：\n$$ \\operatorname{Var}[x](t) = \\left(\\sigma^2 + \\frac{\\hbar^2 t^2}{4m^2\\sigma^2} + x_0^2 + \\frac{2x_0 p_0}{m}t + \\frac{p_0^2 t^2}{m^2}\\right) - \\left(x_0^2 + \\frac{2x_0 p_0}{m}t + \\frac{p_0^2 t^2}{m^2}\\right) $$\n$$ \\operatorname{Var}[x](t) = \\sigma^2 + \\frac{\\hbar^2 t^2}{4m^2\\sigma^2} $$\n这个基本结果表明，波包的方差随时间二次方增长。这种展宽与初始位置 $x_0$ 和初始动量 $p_0$ 无关。\n\n问题要求解方差从其初始值增加一倍的时间 $t_s$。\n初始方差为 $\\operatorname{Var}[x](0) = \\sigma^2$。\n我们必须求解方程 $\\operatorname{Var}[x](t_s) = 2\\operatorname{Var}[x](0)$：\n$$ \\sigma^2 + \\frac{\\hbar^2 t_s^2}{4m^2\\sigma^2} = 2\\sigma^2 $$\n$$ \\frac{\\hbar^2 t_s^2}{4m^2\\sigma^2} = \\sigma^2 $$\n$$ t_s^2 = \\frac{4m^2\\sigma^4}{\\hbar^2} $$\n取正根得到第一个正时刻 $t_s$：\n$$ t_s = \\frac{2m\\sigma^2}{\\hbar} $$\n\n结果讨论：\n波包方差增加一倍所需的时间 $t_s$ 是量子展宽的一个特征时间。它对各参数的依赖关系很有启发性：\n- $t_s \\propto m$：展宽时间与质量成正比。较重的粒子表现出较慢的量子展宽，这与对应原理一致；大质量物体表现得更经典。\n- $t_s \\propto \\sigma^2$：展宽时间与初始宽度的平方成正比。一个初始时非常局域化（$\\sigma$ 很小）的波包，根据不确定性原理，其动量不确定性 $(\\Delta p \\sim \\hbar/\\sigma)$ 很大。多样化的动量分量导致波包迅速散开。相反，一个初始时很宽（$\\sigma$ 很大）的波包动量不确定性很小，因此其各分量以几乎相同的速度传播，导致展宽非常缓慢。\n- $t_s \\propto 1/\\hbar$：展宽时间与约化普朗克常数成反比。在经典极限 $\\hbar \\to 0$ 下，$t_s \\to \\infty$。这表明量子展宽是一种纯粹的量子力学效应，在经典力学中会消失。经典粒子分布只会平移，其内在宽度不会改变。\n- 在极限 $m \\to \\infty$ 下，$t_s \\to \\infty$。这意味着无限大质量的粒子不会经历量子展宽，这加强了经典极限行为的结论。宏观物体的质量如此之大，以至于它们的量子展宽时间长得惊人，实际上无法观测到。", "answer": "$$\n\\boxed{\\frac{2m\\sigma^{2}}{\\hbar}}\n$$", "id": "2892591"}, {"introduction": "自由粒子的无限制弥散引出了一个关键问题：如果粒子被限制在空间中的一个有限区域内，其动力学行为会发生什么变化？本练习通过对比无限深势阱中的波包与自由空间中的波包的演化，来深入探讨边界条件的影响 [@problem_id:2892676]。通过计算束缚态波包位置涨落的长时间平均值，你将发现束缚系统与自由系统在长时间尺度下有着本质不同的动力学特性。", "problem": "考虑一个质量为 $m$ 的无自旋非相对论粒子在一维空间中运动。从第一性原理出发，分析以下两种情景。\n\n情景 A（受限）：粒子处于宽度为 $L$ 的无限深方势阱中，势能为 $V(x)=0$（对于 $0<x<L$）及 $V(x)=+\\infty$（其他情况）。在时刻 $t=0$ 时，归一化状态是一个最小不确定性高斯波包，中心位于势阱中点 $x=L/2$，平均动量为零，位置方差为 $\\sigma^{2}$，其中 $0<\\sigma \\ll L$：\n$$\n\\psi(x,0)=\\left(\\frac{1}{2\\pi \\sigma^{2}}\\right)^{1/4}\\exp\\!\\left(-\\frac{(x-\\frac{L}{2})^{2}}{4\\sigma^{2}}\\right),\n$$\n该波包被理解为限制在 $0<x<L$ 范围内（对于 $\\sigma\\ll L$，势阱外的波包尾部可以忽略不计）。令 $\\{|n\\rangle\\}$ 表示哈密顿量在 $[0,L]$ 上的定态本征基，并将 $\\psi(x,0)$ 展开为 $\\psi(x,0) = \\sum_{n=1}^{\\infty} c_{n}\\,\\phi_{n}(x)$。\n\n情景 B（自由）：同样的高斯波包初始态在整个实轴 $\\mathbb{R}$ 上根据自由粒子哈密顿量演化。\n\n任务：\n- 从无限深势阱的定态 Schrödinger 方程及其相应边界条件出发，推导归一化的本征函数 $\\phi_{n}(x)$ 和对应的能量本征值 $E_{n}$。\n- 仅使用基本原理（幺正时间演化和时间平均的定义），推导势阱中位置方差的无限长时间平均值，\n$$\n\\overline{\\operatorname{Var}}_{L}=\\lim_{T\\to\\infty}\\frac{1}{T}\\int_{0}^{T}\\Big(\\langle x^{2}\\rangle_{t}-\\langle x\\rangle_{t}^{2}\\Big)\\,dt,\n$$\n用 $L$ 和展开系数 $\\{c_{n}\\}$ 表示。精确计算势阱基矢下的对角矩阵元 $\\langle n\\lvert x^{2}\\rvert n\\rangle$。然后，在 $\\sigma/L\\to 0$ 的渐近区域，对于中心在 $x=L/2$ 且平均动量为零的波包，通过将高斯波包投影到势阱本征态上并进行必要的渐近分析来近似系数 $c_{n}$，从而求得以 $L$ 和 $\\sigma$ 表示的 $\\overline{\\operatorname{Var}}_{L}$ 的领头非平凡项的闭合解析表达式。\n- 对于情景 B，使用 Heisenberg 运动方程求出在相同初始状态下自由粒子的位置方差 $\\operatorname{Var}_{\\infty}(t)$ 随时间的变化关系。然后计算极限\n$$\nR=\\lim_{t\\to\\infty}\\frac{\\overline{\\operatorname{Var}}_{L}}{\\operatorname{Var}_{\\infty}(t)}.\n$$\n\n答案规格：\n- 你的最终答案必须包含两项：在 $\\sigma/L\\to 0$ 极限下，用 $L$和 $\\sigma$ 表示的 $\\overline{\\operatorname{Var}}_{L}$ 的领头阶解析表达式，以及数值 $R$。\n- 使用 $\\mathrm{pmatrix}$ 环境将最终答案表示为单行矩阵，顺序为 $\\begin{pmatrix} \\overline{\\operatorname{Var}}_{L} & R \\end{pmatrix}$。\n- 只提供符号（无数值代入，无单位）。\n- 无需四舍五入；提供精确的闭合形式表达式。", "solution": "问题陈述已经过分析，被认为是有效的。这是一个在标准非相对论量子力学中适定的问题，没有科学或逻辑上的不一致之处。\n\n解答按要求分为三个部分进行。\n\n首先，确定无限深方势阱的定态。对于宽度为 $L$ 的势阱中质量为 $m$ 的粒子，其定态 Schrödinger 方程为\n$$\n-\\frac{\\hbar^{2}}{2m}\\frac{d^{2}\\phi(x)}{dx^{2}} = E\\phi(x)\n$$\n对于 $x \\in (0, L)$，边界条件为 $\\phi(0)=\\phi(L)=0$。通解为 $\\phi(x) = A\\sin(kx) + B\\cos(kx)$。条件 $\\phi(0)=0$ 意味着 $B=0$。条件 $\\phi(L)=0$ 意味着 $A\\sin(kL)=0$，对于非平庸解，这要求 $kL = n\\pi$，其中 $n$ 为正整数（$n \\in \\{1, 2, 3, \\dots\\}$）。动量是量子化的，$k_{n} = \\frac{n\\pi}{L}$。\n将 $k_{n}$ 代入 Schrödinger 方程，可得到能量本征值：\n$$\nE_{n} = \\frac{\\hbar^{2}k_{n}^{2}}{2m} = \\frac{n^{2}\\pi^{2}\\hbar^{2}}{2mL^{2}}.\n$$\n本征函数为 $\\phi_{n}(x) = A\\sin(\\frac{n\\pi x}{L})$。归一化要求 $\\int_{0}^{L} |\\phi_{n}(x)|^{2} dx = 1$。\n$$\n|A|^{2}\\int_{0}^{L}\\sin^{2}\\left(\\frac{n\\pi x}{L}\\right)dx = |A|^{2}\\frac{L}{2} = 1 \\implies A = \\sqrt{\\frac{2}{L}}.\n$$\n因此，归一化的本征函数是\n$$\n\\phi_{n}(x) = \\sqrt{\\frac{2}{L}}\\sin\\left(\\frac{n\\pi x}{L}\\right).\n$$\n\n其次，计算势阱中位置方差的无限长时间平均值 $\\overline{\\operatorname{Var}}_{L}$。一个普通态 $|\\psi(t)\\rangle$ 可由能量本征基展开给出：\n$$\n|\\psi(t)\\rangle = \\sum_{n=1}^{\\infty} c_{n} e^{-iE_{n}t/\\hbar} |n\\rangle,\n$$\n其中 $|n\\rangle$ 对应于本征函数 $\\phi_{n}(x)$，且 $c_{n}=\\langle n|\\psi(0)\\rangle$。在时刻 $t$ 的方差是 $\\operatorname{Var}_{L}(t) = \\langle x^{2} \\rangle_{t} - \\langle x \\rangle_{t}^{2}$。\n算符期望值 $\\langle O \\rangle_{t}$ 的时间平均值为\n$$\n\\overline{\\langle O \\rangle} = \\lim_{T\\to\\infty} \\frac{1}{T}\\int_{0}^{T} \\sum_{m,n} c_{m}^{*}c_{n} e^{i(E_{m}-E_{n})t/\\hbar} \\langle m|O|n\\rangle dt.\n$$\n由于能量 $E_n$ 是非简并的，时间平均只保留 $m=n$ 的常数项：\n$$\n\\overline{\\langle O \\rangle} = \\sum_{n} |c_{n}|^{2} \\langle n|O|n\\rangle.\n$$\n问题要求计算 $\\overline{\\operatorname{Var}}_{L} = \\overline{\\langle x^{2} \\rangle_{t} - \\langle x \\rangle_{t}^{2}} = \\overline{\\langle x^{2} \\rangle_{t}} - \\overline{\\langle x \\rangle_{t}^{2}}$。\n第一项很简单：$\\overline{\\langle x^{2} \\rangle_{t}} = \\sum_{n} |c_{n}|^{2} \\langle n|x^{2}|n\\rangle$。\n对于第二项 $\\overline{\\langle x \\rangle_{t}^{2}}$，我们分析一个乘积的时间平均。假设跃迁频率没有偶然简并（对于 $\\{m,n\\} \\neq \\{p,q\\}$ 和 $\\{m,n\\} \\neq \\{q,p\\}$，有 $E_m-E_n \\neq E_p-E_q$），则时间平均 $\\overline{\\langle A \\rangle_{t}\\langle B \\rangle_{t}}$ 等于 $\\overline{\\langle A \\rangle_{t}}\\cdot\\overline{\\langle B \\rangle_{t}} + \\sum_{m \\neq n} \\langle A \\rangle_{mn}\\langle B \\rangle_{nm}$，其中 $\\langle O \\rangle_{mn} = c_m^* c_n \\langle m|O|n\\rangle$。令 $A=B=x$，我们得到：\n$$\n\\overline{\\langle x \\rangle_{t}^{2}} = \\left(\\sum_{n}|c_{n}|^{2}\\langle n|x|n\\rangle\\right)^{2} + \\sum_{m\\neq n} |c_{m}|^{2}|c_{n}|^{2}|\\langle m|x|n\\rangle|^{2}.\n$$\n初始态 $\\psi(x,0)$ 是一个以 $x=L/2$ 为中心的高斯函数，是关于 $x-L/2$ 的一个偶函数。本征函数 $\\phi_n(x)$ 关于 $x=L/2$ 具有确定的宇称：$\\phi_n(L-x) = (-1)^{n+1}\\phi_n(x)$。当 $n$ 为奇数时，$\\phi_n$ 是偶函数；当 $n$ 为偶数时，$\\phi_n$ 是奇函数。展开系数 $c_n = \\int_0^L \\phi_n^*(x)\\psi(x,0)dx$ 仅在 $n$ 为奇数时非零。\n算符 $x$ 可以写成 $(x-L/2) + L/2$。项 $(x-L/2)$ 关于中心 $L/2$ 是奇函数。因此，其矩阵元 $\\langle m|x-L/2|n\\rangle$ 仅在 $m$ 和 $n$ 具有相反宇称时非零。由于我们的状态只包含奇数 $n$ 的分量，所以对于所有相关的 $m, n$，都有 $\\langle m|x-L/2|n\\rangle = 0$。\n于是 $\\langle m|x|n\\rangle = \\langle m|x-L/2|n\\rangle + (L/2)\\langle m|n\\rangle = (L/2)\\delta_{mn}$。\n这意味着对于 $m\\neq n$（$m,n$ 均为奇数），$\\langle m|x|n\\rangle=0$；而 $\\langle n|x|n\\rangle = L/2$。\n时间平均方差的表达式显著简化为：\n$$\n\\overline{\\operatorname{Var}}_{L} = \\sum_{n \\text{ odd}} |c_{n}|^{2}\\langle n|x^{2}|n\\rangle - \\left(\\sum_{n \\text{ odd}}|c_{n}|^{2}\\frac{L}{2}\\right)^{2} = \\sum_{n \\text{ odd}} |c_{n}|^{2}\\langle n|x^{2}|n\\rangle - \\frac{L^{2}}{4}.\n$$\n对角矩阵元 $\\langle n|x^{2}|n\\rangle$ 计算如下：\n$$\n\\langle n|x^{2}|n\\rangle = \\frac{2}{L}\\int_{0}^{L} x^{2}\\sin^{2}\\left(\\frac{n\\pi x}{L}\\right)dx = L^{2}\\left(\\frac{1}{3} - \\frac{1}{2n^{2}\\pi^{2}}\\right).\n$$\n将此代入 $\\overline{\\operatorname{Var}}_{L}$ 的表达式并使用 $\\sum_{n \\text{ odd}}|c_n|^2=1$：\n$$\n\\overline{\\operatorname{Var}}_{L} = \\sum_{n \\text{ odd}}|c_n|^2 L^2\\left(\\frac{1}{3} - \\frac{1}{2n^2\\pi^2}\\right) - \\frac{L^2}{4} = \\frac{L^2}{3} - \\frac{L^2}{4} - \\frac{L^2}{2\\pi^2}\\sum_{n \\text{ odd}}\\frac{|c_n|^2}{n^2} = \\frac{L^{2}}{12} - \\frac{L^{2}}{2\\pi^{2}}\\sum_{n \\text{ odd}}\\frac{|c_n|^2}{n^2}.\n$$\n为了在 $\\sigma/L \\to 0$ 的极限下求值，我们求出奇数 $n$ 的系数 $c_{n}$：\n$$\nc_{n} = \\int_{0}^{L} \\phi_{n}^{*}(x)\\psi(x,0)dx \\approx \\sqrt{\\frac{2}{L}}\\left(\\frac{1}{2\\pi\\sigma^{2}}\\right)^{1/4}\\int_{-\\infty}^{\\infty}\\sin\\left(\\frac{n\\pi x}{L}\\right)\\exp\\left(-\\frac{(x-L/2)^{2}}{4\\sigma^{2}}\\right)dx.\n$$\n当 $n$ 为奇数时，$\\sin(\\frac{n\\pi x}{L})$ 变为 $(-1)^{(n-1)/2}\\cos(\\frac{n\\pi(x-L/2)}{L})$。该积分为高斯函数的傅里叶变换，得出\n$|c_n|^{2} \\approx \\frac{4\\sqrt{2\\pi}\\sigma}{L}\\exp\\left(-\\frac{2n^{2}\\pi^{2}\\sigma^{2}}{L^{2}}\\right)$ for odd $n$.\n求和变为 $S = \\sum_{n \\text{ odd}}\\frac{|c_n|^2}{n^2} = \\frac{4\\sqrt{2\\pi}\\sigma}{L}\\sum_{n \\text{ odd}}\\frac{1}{n^2}\\exp\\left(-\\frac{2n^{2}\\pi^{2}\\sigma^{2}}{L^{2}}\\right)$。\n在 $\\sigma/L \\to 0$ 的极限下，指数项趋近于 $1$，而对 $n$ 的求和由级数 $\\sum_{n \\text{ odd}} \\frac{1}{n^2} = \\frac{\\pi^{2}}{8}$ 的领头项主导。\n$$\nS \\approx \\frac{4\\sqrt{2\\pi}\\sigma}{L} \\cdot \\frac{\\pi^{2}}{8} = \\frac{\\sqrt{2\\pi}\\pi^{2}\\sigma}{2L}.\n$$\n将此代入 $\\overline{\\operatorname{Var}}_{L}$ 的表达式中：\n$$\n\\overline{\\operatorname{Var}}_{L} \\approx \\frac{L^{2}}{12} - \\frac{L^{2}}{2\\pi^{2}}\\left(\\frac{\\sqrt{2\\pi}\\pi^{2}\\sigma}{2L}\\right) = \\frac{L^{2}}{12} - \\frac{\\sqrt{2\\pi}L\\sigma}{4}.\n$$\n这是时间平均方差的领头阶表达式。\n\n第三，计算自由粒子的方差。对于自由粒子哈密顿量 $H=p^{2}/(2m)$，Heisenberg 运动方程给出 $\\hat{p}(t)=\\hat{p}(0)$ 和 $\\hat{x}(t)=\\hat{x}(0)+\\frac{\\hat{p}(0)}{m}t$。\n初始态是最小不确定性高斯波包，其 $\\langle x(0)\\rangle = L/2$，$\\operatorname{Var}(x(0))=\\sigma^{2}$，$\\langle p(0)\\rangle = 0$，以及 $\\operatorname{Var}(p(0)) = \\sigma_{p}^{2}=\\frac{\\hbar^{2}}{4\\sigma^{2}}$。对于该状态，位置-动量协方差为零。\n期望值为 $\\langle x \\rangle_{t} = \\langle x(0) \\rangle + \\frac{\\langle p(0)\\rangle}{m}t = L/2$。\n$\\langle x^{2} \\rangle_{t} = \\langle (\\hat{x}(0)+\\frac{\\hat{p}(0)}{m}t)^{2} \\rangle = \\langle x(0)^{2} \\rangle + \\frac{t}{m}\\langle \\hat{x}(0)\\hat{p}(0)+\\hat{p}(0)\\hat{x}(0) \\rangle + \\frac{t^{2}}{m^{2}}\\langle p(0)^{2} \\rangle$。\n其中 $\\langle x(0)^{2} \\rangle = \\operatorname{Var}(x(0)) + \\langle x(0) \\rangle^{2} = \\sigma^{2}+(L/2)^{2}$，$\\langle \\hat{x}(0)\\hat{p}(0)+\\hat{p}(0)\\hat{x}(0) \\rangle = 0$，且 $\\langle p(0)^{2} \\rangle = \\sigma_{p}^{2}$。\n自由粒子的方差为\n$$\n\\operatorname{Var}_{\\infty}(t) = \\langle x^{2} \\rangle_{t} - \\langle x \\rangle_{t}^{2} = \\left(\\sigma^{2}+\\frac{L^{2}}{4}\\right) + \\frac{t^{2}}{m^{2}}\\frac{\\hbar^{2}}{4\\sigma^{2}} - \\left(\\frac{L}{2}\\right)^{2} = \\sigma^{2} + \\frac{\\hbar^{2}t^{2}}{4m^{2}\\sigma^{2}}.\n$$\n\n最后，计算比值 $R$：\n$$\nR = \\lim_{t\\to\\infty}\\frac{\\overline{\\operatorname{Var}}_{L}}{\\operatorname{Var}_{\\infty}(t)} = \\lim_{t\\to\\infty}\\frac{\\frac{L^{2}}{12} - \\frac{\\sqrt{2\\pi}L\\sigma}{4}}{\\sigma^{2} + \\frac{\\hbar^{2}t^{2}}{4m^{2}\\sigma^{2}}}.\n$$\n分子是一个有限常数，而分母随时间二次方增长。因此，极限为零。\n$$\nR=0.\n$$\n\n最终答案是 $\\overline{\\operatorname{Var}}_{L}$ 的表达式和 $R$ 的值。", "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{L^{2}}{12} - \\frac{\\sqrt{2\\pi}L\\sigma}{4} & 0 \\end{pmatrix}}\n$$", "id": "2892676"}, {"introduction": "从解析推导转向计算实践，我们将探索如何用计算机模拟量子动力学。虽然简单系统的演化可以精确求解，但大多数实际问题都依赖于数值方法。本练习将介绍一种强大的时间演化算法——算符分裂法，并要求你亲手实现它 [@problem_id:2892564]。此练习的关键在于，你将通过代码验证一个深刻的理论结论：对于自由粒子（即势能 $V=0$），这个看似近似的数值算法实际上是精确的，这为连接理论物理与计算科学提供了坚实的桥梁。", "problem": "实现一个一维、二阶对称算子分裂时间传播子，用于处理在周期性盒子中由含时薛定谔方程所描述的量子粒子，并在自由粒子极限下验证其简化为动能相位的精确应用。所有计算完全在原子单位下进行，其中 $\\hbar = 1$ 且粒子质量 $m = 1$。\n\n从一维空间中单个粒子的含时薛定谔方程出发：\n$$\n\\mathrm{i}\\,\\frac{\\partial}{\\partial t}\\,\\psi(x,t) \\;=\\; \\hat{H}\\,\\psi(x,t),\\qquad \\hat{H} \\;=\\; \\hat{T} + \\hat{V},\n$$\n其中动能算符为 $\\hat{T} = -\\frac{1}{2}\\frac{\\partial^2}{\\partial x^2}$，势能算符为乘法算符 $(\\hat{V}\\psi)(x) = V(x)\\,\\psi(x)$。在一个时间步长 $\\Delta t$ 内的精确演化由幺正传播子 $\\hat{U}(\\Delta t) = \\exp\\!\\left(-\\mathrm{i}\\,\\hat{H}\\,\\Delta t\\right)$ 给出。一种二阶精确的对称算子分裂（也称为 Strang 分裂）将精确传播子替换为一系列子步骤的组合，这些子步骤交替地应用由 $\\hat{T}$ 产生的自由演化和由 $\\hat{V}$ 产生的逐点势能演化，并在时间上对称排列。\n\n在一个长度为 $L$ 的周期性区间上，使用 $N$ 个等距网格点 $x_j = j\\,\\Delta x$（$j \\in \\{0,1,\\dots,N-1\\}$，$\\Delta x = L/N$）进行离散化，由 $\\hat{T}$ 产生的自由演化在动量表象中是对角的。设 $k_n = \\frac{2\\pi}{L} n$ 表示与网格相关的离散角波数，其中 $n$ 遍历与离散傅里叶变换一致的 $N$ 个模式。在时间增量 $\\Delta t$ 内的自由演化对应于将每个傅里叶模式乘以与其动能 $T(k_n) = \\frac{1}{2}k_n^2$ 相关联的动能相位因子。\n\n任务：\n1.  根据上述定义，并且除了指数和对易子的标准性质外不调用任何黑箱结果，推导出一个二阶精确的对称算子分裂方案，该方案在周期性网格上将 $\\psi(x,t)$ 在哈密顿量 $\\hat{H} = \\hat{T} + \\hat{V}$ 的作用下演化一个时间步长 $\\Delta t$。您的推导必须从基本的含时薛定谔方程和精确传播子为 $\\exp(-\\mathrm{i}\\,\\hat{H}\\,\\Delta t)$ 这一事实出发。\n2.  将您的方案特化到自由粒子极限 $V(x) \\equiv 0$，并证明在周期性网格上，该方案简化为动量空间中动能相位的精确应用。也就是说，证明对于总时间 $t = M\\,\\Delta t$（其中 $M \\geq 0$ 为整数），$M$ 次重复的分裂步骤与单次谱方法应用精确自由传播子 $\\exp\\!\\left(-\\mathrm{i}\\,\\hat{T}\\,t\\right)$ 的结果相同。\n3.  使用在周期性网格上通过快速傅里叶变换（FFT; Fast Fourier Transform）计算的离散傅里叶变换来实现您的方案。通过乘以适当的动能相位因子来在动量空间进行动能更新，并通过逐点乘以势能相位因子来在实空间进行势能更新。\n4.  在自由粒子极限 $V(x)=0$ 的情况下，通过数值方法验证多步二阶分裂与在相同总时间内单次精确自由演化的结果一致。通过计算网格上的 $L^2$-范数差异来完成此验证，其定义为：\n$$\n\\left\\|\\psi - \\phi\\right\\|_{L^2(\\text{grid})} \\;=\\; \\left(\\sum_{j=0}^{N-1} \\left|\\psi_j - \\phi_j\\right|^2\\,\\Delta x\\right)^{1/2}.\n$$\n使用归一化的初始态 $\\psi(x,0)$。\n\n您的程序必须硬编码以下测试套件，并以浮点数形式输出每种情况的 $L^2$-范数差异。所有计算均在原子单位下进行且无量纲；无需报告任何物理单位。在所有情况下，网格在 $[0,L)$ 上是周期性的。\n\n如上所述，设 $\\Delta x = L/N$ 和 $k_n = \\frac{2\\pi}{L} n$。对于一个中心在 $x_0$、宽度为 $\\sigma$、平均波数值为 $k_0$ 的高斯波包，使用\n$$\n\\psi(x,0) \\;=\\; \\frac{1}{(\\pi\\sigma^2)^{1/4}}\\,\\exp\\!\\left(-\\frac{(x-x_0)^2}{2\\sigma^2}\\right)\\,\\exp\\!\\left(\\mathrm{i}\\,k_0\\,x\\right),\n$$\n然后进行离散归一化，使得 $\\sum_j |\\psi_j|^2 \\Delta x = 1$。对于网格上波数为 $k_0$ 的平面波，使用 $\\psi(x,0) = L^{-1/2}\\,\\exp(\\mathrm{i}\\,k_0\\,x)$。\n\n测试套件：\n-   案例 A（常规路径高斯波包）：$N=1024$，$L=100.0$，$x_0=25.0$，$\\sigma=2.0$，$k_0=1.25$，$\\Delta t=0.05$，$M=200$，$V(x)\\equiv 0$。\n-   案例 B（零时间边界）：与案例 A 参数相同，但 $\\Delta t=0.0$，$M=0$，$V(x)\\equiv 0$。\n-   案例 C（网格对齐的平面波）：$N=1024$，$L=100.0$，选择模式索引 $m=100$ 使得 $k_0=\\frac{2\\pi}{L}m$，初始化 $\\psi(x,0) = L^{-1/2}\\exp(\\mathrm{i}\\,k_0 x)$，取 $\\Delta t=0.03$，$M=333$，$V(x)\\equiv 0$。\n-   案例 D（接近奈奎斯特频率的高波数高斯波包）：$N=1024$，$L=100.0$，$x_0=40.0$，$\\sigma=10.0$，设 $k_{\\max}=\\pi/\\Delta x$ 并选择 $k_0=0.8\\,k_{\\max}$，取 $\\Delta t=0.02$，$M=250$，$V(x)\\equiv 0$。\n\n对于每种情况，计算以下两者之间的 $L^2$-范数差异：\n-   应用 $M$ 步 $V(x)=0$ 的二阶对称分裂得到的状态，以及\n-   在动量空间中对总时间 $t=M\\,\\Delta t$ 应用一次精确自由演化得到的状态。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如，\"[r_A,r_B,r_C,r_D]\"），其中 $r_A$、$r_B$、$r_C$、$r_D$ 是按案例 A、B、C、D 顺序定义的四个浮点数差异。不允许有其他输出。", "solution": "该问题要求推导、分析和实现用于一维含时薛定谔方程的二阶对称算子分裂传播子，并特别关注其在自由粒子极限下的精确性。我们将按顺序处理每个任务。所有计算均在原子单位下进行，其中 $\\hbar=1$ 且粒子质量 $m=1$。\n\n控制方程为\n$$\n\\mathrm{i}\\,\\frac{\\partial}{\\partial t}\\,\\psi(x,t) \\;=\\; \\hat{H}\\,\\psi(x,t)\n$$\n其中哈密顿量为 $\\hat{H} = \\hat{T} + \\hat{V}$，$\\hat{T} = -\\frac{1}{2}\\frac{\\partial^2}{\\partial x^2}$ 且 $(\\hat{V}\\psi)(x) = V(x)\\,\\psi(x)$。在一个时间步长 $\\Delta t$ 上的形式解为\n$$\n\\psi(x, t+\\Delta t) = \\exp(-\\mathrm{i}\\hat{H}\\Delta t)\\,\\psi(x,t)\n$$\n由于算符 $\\hat{T}$ 和 $\\hat{V}$ 通常不对易，即 $[\\hat{T}, \\hat{V}] \\neq 0$，因此和的指数不能分解为指数的乘积：$\\exp(-\\mathrm{i}(\\hat{T}+\\hat{V})\\Delta t) \\neq \\exp(-\\mathrm{i}\\hat{T}\\Delta t)\\exp(-\\mathrm{i}\\hat{V}\\Delta t)$。算子分裂方法提供了一种系统的方式，将完整传播子近似为仅涉及 $\\hat{T}$ 或 $\\hat{V}$ 的一系列传播子。\n\n**任务 1：二阶对称传播子的推导**\n\n我们寻求对精确传播子 $\\hat{U}(\\Delta t) = \\exp(-\\mathrm{i}(\\hat{T}+\\hat{V})\\Delta t)$ 的一个近似 $\\hat{U}_{approx}(\\Delta t)$，该近似在 $\\Delta t$ 上具有二阶精度。一种对称组合，即 Strang 分裂，由下式给出：\n$$\n\\hat{U}_{approx}(\\Delta t) \\;=\\; \\exp(-\\mathrm{i}\\hat{T}\\frac{\\Delta t}{2})\\,\\exp(-\\mathrm{i}\\hat{V}\\Delta t)\\,\\exp(-\\mathrm{i}\\hat{T}\\frac{\\Delta t}{2})\n$$\n为证明这是一个二阶近似，我们比较 $\\hat{U}_{approx}(\\Delta t)$ 和精确传播子 $\\hat{U}(\\Delta t)$ 关于 $\\Delta t$ 幂次的泰勒级数展开。\n\n精确传播子的展开式为：\n$$\n\\hat{U}(\\Delta t) = \\mathbf{1} - \\mathrm{i}(\\hat{T}+\\hat{V})\\Delta t + \\frac{(-\\mathrm{i})^2}{2!}(\\hat{T}+\\hat{V})^2(\\Delta t)^2 + O((\\Delta t)^3)\n$$\n$$\n\\hat{U}(\\Delta t) = \\mathbf{1} - \\mathrm{i}(\\hat{T}+\\hat{V})\\Delta t - \\frac{1}{2}(\\hat{T}^2 + \\hat{T}\\hat{V} + \\hat{V}\\hat{T} + \\hat{V}^2)(\\Delta t)^2 + O((\\Delta t)^3)\n$$\n现在，我们展开近似传播子的各个部分：\n$$\n\\exp(-\\mathrm{i}\\hat{T}\\frac{\\Delta t}{2}) = \\mathbf{1} - \\mathrm{i}\\frac{\\hat{T}\\Delta t}{2} - \\frac{1}{2}(\\frac{\\hat{T}\\Delta t}{2})^2 + O((\\Delta t)^3) = \\mathbf{1} - \\mathrm{i}\\frac{\\hat{T}\\Delta t}{2} - \\frac{\\hat{T}^2(\\Delta t)^2}{8} + O((\\Delta t)^3)\n$$\n$$\n\\exp(-\\mathrm{i}\\hat{V}\\Delta t) = \\mathbf{1} - \\mathrm{i}\\hat{V}\\Delta t - \\frac{1}{2}(\\hat{V}\\Delta t)^2 + O((\\Delta t)^3) = \\mathbf{1} - \\mathrm{i}\\hat{V}\\Delta t - \\frac{\\hat{V}^2(\\Delta t)^2}{2} + O((\\Delta t)^3)\n$$\n将这些展开式相乘得到 $\\hat{U}_{approx}(\\Delta t)$：\n$$\n\\hat{U}_{approx}(\\Delta t) = \\left( \\mathbf{1} - \\mathrm{i}\\frac{\\hat{T}\\Delta t}{2} - \\frac{\\hat{T}^2(\\Delta t)^2}{8} \\right) \\left( \\mathbf{1} - \\mathrm{i}\\hat{V}\\Delta t - \\frac{\\hat{V}^2(\\Delta t)^2}{2} \\right) \\left( \\mathbf{1} - \\mathrm{i}\\frac{\\hat{T}\\Delta t}{2} - \\frac{\\hat{T}^2(\\Delta t)^2}{8} \\right) + O((\\Delta t)^3)\n$$\n我们按 $\\Delta t$ 的幂次收集项：\n$(\\Delta t)^0$ 阶的项是 $\\mathbf{1} \\cdot \\mathbf{1} \\cdot \\mathbf{1} = \\mathbf{1}$，匹配。\n$(\\Delta t)^1$ 阶的项是：\n$$\n(-\\mathrm{i}\\frac{\\hat{T}}{2})\\Delta t + (-\\mathrm{i}\\hat{V})\\Delta t + (-\\mathrm{i}\\frac{\\hat{T}}{2})\\Delta t = -\\mathrm{i}(\\hat{T}+\\hat{V})\\Delta t\n$$\n这也与精确展开式匹配。\n$(\\Delta t)^2$ 阶的项是所有系数包含 $(\\Delta t)^2$ 的算符乘积之和：\n$$\n\\underbrace{ \\left(-\\mathrm{i}\\frac{\\hat{T}}{2}\\right)\\left(-\\mathrm{i}\\hat{V}\\right)(\\Delta t)^2 }_{-\\frac{1}{2}\\hat{T}\\hat{V}(\\Delta t)^2} + \\underbrace{ \\left(-\\mathrm{i}\\frac{\\hat{T}}{2}\\right)\\left(-\\mathrm{i}\\frac{\\hat{T}}{2}\\right)(\\Delta t)^2 }_{-\\frac{1}{4}\\hat{T}^2(\\Delta t)^2} + \\underbrace{ \\left(-\\mathrm{i}\\hat{V}\\right)\\left(-\\mathrm{i}\\frac{\\hat{T}}{2}\\right)(\\Delta t)^2 }_{-\\frac{1}{2}\\hat{V}\\hat{T}(\\Delta t)^2} + \\underbrace{ \\left(-\\frac{\\hat{T}^2}{8}\\right)(\\Delta t)^2 + \\left(-\\frac{\\hat{V}^2}{2}\\right)(\\Delta t)^2 + \\left(-\\frac{\\hat{T}^2}{8}\\right)(\\Delta t)^2 }_{\\text{来自单个展开式中的平方项}}\n$$\n将这些项求和：\n$$\n(\\Delta t)^2 \\left( -\\frac{1}{2}\\hat{T}\\hat{V} - \\frac{1}{4}\\hat{T}^2 - \\frac{1}{2}\\hat{V}\\hat{T} - \\frac{1}{8}\\hat{T}^2 - \\frac{1}{2}\\hat{V}^2 - \\frac{1}{8}\\hat{T}^2 \\right) = (\\Delta t)^2 \\left( -\\frac{1}{2}(\\hat{T}\\hat{V} + \\hat{V}\\hat{T}) - \\frac{1}{2}\\hat{V}^2 - (\\frac{1}{4}+\\frac{1}{8}+\\frac{1}{8})\\hat{T}^2 \\right)\n$$\n$$\n= (\\Delta t)^2 \\left( -\\frac{1}{2}(\\hat{T}^2 + \\hat{T}\\hat{V} + \\hat{V}\\hat{T} + \\hat{V}^2) \\right) = -\\frac{1}{2}(\\hat{T}+\\hat{V})^2 (\\Delta t)^2\n$$\n这精确地匹配了 $\\hat{U}(\\Delta t)$ 展开式中的二阶项。由于 $\\hat{U}(\\Delta t)$ 和 $\\hat{U}_{approx}(\\Delta t)$ 的展开式在直到并包括 $(\\Delta t)^2$ 阶的项上都一致，因此对称分裂方案是二阶精确的。局部误差为 $O((\\Delta t)^3)$。\n\n**任务 2：特化到自由粒子极限**\n\n在自由粒子极限下，势能恒为零，$V(x) \\equiv 0$，这意味着算符 $\\hat{V} = 0$。哈密顿量简化为 $\\hat{H} = \\hat{T}$。\n一个时间步长 $\\Delta t$ 的精确传播子是 $\\hat{U}(\\Delta t) = \\exp(-\\mathrm{i}\\hat{T}\\Delta t)$。\n让我们在此条件下评估对称分裂传播子 $\\hat{U}_{approx}(\\Delta t)$：\n$$\n\\hat{U}_{approx}(\\Delta t) \\;=\\; \\exp(-\\mathrm{i}\\hat{T}\\frac{\\Delta t}{2})\\,\\exp(-\\mathrm{i}(0)\\Delta t)\\,\\exp(-\\mathrm{i}\\hat{T}\\frac{\\Delta t}{2})\n$$\n由于零算符的指数是单位算符，$\\exp(0) = \\mathbf{1}$，此表达式简化为：\n$$\n\\hat{U}_{approx}(\\Delta t) \\;=\\; \\exp(-\\mathrm{i}\\hat{T}\\frac{\\Delta t}{2})\\,\\mathbf{1}\\,\\exp(-\\mathrm{i}\\hat{T}\\frac{\\Delta t}{2}) \\;=\\; \\exp(-\\mathrm{i}\\hat{T}\\frac{\\Delta t}{2})\\,\\exp(-\\mathrm{i}\\hat{T}\\frac{\\Delta t}{2})\n$$\n一个算符永远与自身对易。因此，我们可以将指数相加：如果 $[\\hat{A},\\hat{B}]=0$，则 $\\exp(\\hat{A})\\exp(\\hat{B}) = \\exp(\\hat{A}+\\hat{B})$。\n$$\n\\hat{U}_{approx}(\\Delta t) \\;=\\; \\exp\\left(-\\mathrm{i}\\hat{T}\\frac{\\Delta t}{2} - \\mathrm{i}\\hat{T}\\frac{\\Delta t}{2}\\right) \\;=\\; \\exp(-\\mathrm{i}\\hat{T}\\Delta t)\n$$\n这与精确的自由粒子传播子 $\\hat{U}(\\Delta t)$ 完全相同。因此，对于任何单个时间步长 $\\Delta t$，对称分裂方案对于自由粒子而言不是近似，而是精确的。\n\n现在，考虑在总时间 $t = M\\Delta t$ 内的演化，这是通过应用传播子 $M$ 次实现的。时间 $t$ 时的状态由下式给出：\n$$\n\\psi(x, t) = \\left(\\hat{U}_{approx}(\\Delta t)\\right)^M \\psi(x, 0)\n$$\n代入我们对自由粒子情况的结果：\n$$\n\\psi(x, t) = \\left(\\exp(-\\mathrm{i}\\hat{T}\\Delta t)\\right)^M \\psi(x, 0)\n$$\n同样，由于乘积中的所有算符都相同，它们相互对易，我们可以将指数相加：\n$$\n\\psi(x, t) = \\exp(-M \\cdot \\mathrm{i}\\hat{T}\\Delta t) \\psi(x, 0) = \\exp(-\\mathrm{i}\\hat{T}(M\\Delta t)) \\psi(x, 0)\n$$\n由于 $t = M\\Delta t$，我们有：\n$$\n\\psi(x, t) = \\exp(-\\mathrm{i}\\hat{T}t) \\psi(x, 0)\n$$\n这恰好是通过一步应用总时间 $t$ 的精确自由演化传播子所得到的状态。这证明了对于自由粒子，重复 $M$ 次分裂步骤的结果与在总时长内单次谱方法应用精确自由传播子的结果是相同的。\n\n**任务 3 和 4：实现与数值验证策略**\n\n传播子的作用在一个长度为 $L$ 的周期性区间上的 $N$ 个离散点 $x_j=j\\Delta x$ 上实现。\n势能传播子 $\\exp(-\\mathrm{i}\\hat{V}\\tau)$ 在实空间是局域的；它对波函数 $\\psi_j = \\psi(x_j)$ 的作用是逐点相乘：$(\\exp(-\\mathrm{i}\\hat{V}\\tau)\\psi)_j = \\exp(-\\mathrm{i}V(x_j)\\tau)\\psi_j$。对于自由粒子情况 $V(x)=0$，这只是乘以 1。\n\n动能传播子 $\\exp(-\\mathrm{i}\\hat{T}\\tau)$ 在动量空间是局域的。我们使用通过快速傅里叶变换（FFT）算法计算的离散傅里叶变换（DFT）在实空间和动量空间表象之间切换。\n$\\exp(-\\mathrm{i}\\hat{T}\\tau)$ 对 $\\psi$ 的作用计算如下：\n1.  变换到动量空间：$\\tilde{\\psi}(k_n) = \\mathcal{F}\\{\\psi(x_j)\\}$，其中 $\\mathcal{F}$ 表示 DFT。\n2.  应用动能相位：$\\tilde{\\psi}'(k_n) = \\exp(-\\mathrm{i} T(k_n) \\tau) \\tilde{\\psi}(k_n)$，其中动能为 $T(k_n) = \\frac{1}{2}k_n^2$。离散波数 $k_n$ 是对应于 DFT 的波数。\n3.  变换回实空间：$\\psi'(x_j) = \\mathcal{F}^{-1}\\{\\tilde{\\psi}'(k_n)\\}$。\n\n结合这些，多步分裂演化的算法如下：\n在 $t=0$ 初始化 $\\psi_j$。对于 $m=1, \\dots, M$：\n  a. 应用动能半步：$\\psi \\leftarrow \\mathcal{F}^{-1}\\{\\exp(-\\mathrm{i} k_n^2/2 \\cdot \\Delta t/2) \\mathcal{F}\\{\\psi\\}\\}$。\n  b. 应用势能步：对于 $V(x)=0$，这是一个恒等操作。\n  c. 应用动能半步：$\\psi \\leftarrow \\mathcal{F}^{-1}\\{\\exp(-\\mathrm{i} k_n^2/2 \\cdot \\Delta t/2) \\mathcal{F}\\{\\psi\\}\\}$。\n\n单次精确演化计算如下：\n  a. 设总时间 $t = M\\Delta t$。\n  b. 应用完整动能步：$\\psi_{exact} \\leftarrow \\mathcal{F}^{-1}\\{\\exp(-\\mathrm{i} k_n^2/2 \\cdot t) \\mathcal{F}\\{\\psi\\}\\}$。\n\n如任务 2 所示，这两个过程在代数上是等价的。因此，数值验证将计算由两种方法产生的波函数之间的差异的 $L^2$-范数。一个理想实现的程序应该产生一个机器浮点精度量级的差异，从而证实实现正确地反映了分析结果。度量标准是：\n$$\n\\left\\|\\psi_{split} - \\psi_{exact}\\right\\|_{L^2(\\text{grid})} \\;=\\; \\left(\\sum_{j=0}^{N-1} \\left|\\psi_{split,j} - \\psi_{exact,j}\\right|^2\\,\\Delta x\\right)^{1/2}\n$$\n该测试套件探索了不同的初始条件（高斯波包、平面波）和参数（时间步长、波数），以确保此结论的稳健性。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.fft import fft, ifft, fftfreq\n\ndef solve():\n    \"\"\"\n    Solves the problem by implementing and verifying the symmetric operator-splitting\n    propagator for the free-particle Schrödinger equation.\n    \"\"\"\n\n    test_cases = [\n        # Case A: Happy path Gaussian\n        {\n            \"N\": 1024, \"L\": 100.0, \"x0\": 25.0, \"sigma\": 2.0, \"k0\": 1.25,\n            \"dt\": 0.05, \"M\": 200, \"type\": \"gaussian\"\n        },\n        # Case B: Zero-time boundary\n        {\n            \"N\": 1024, \"L\": 100.0, \"x0\": 25.0, \"sigma\": 2.0, \"k0\": 1.25,\n            \"dt\": 0.0, \"M\": 0, \"type\": \"gaussian\"\n        },\n        # Case C: Grid-aligned plane wave\n        {\n            \"N\": 1024, \"L\": 100.0, \"m\": 100,\n            \"dt\": 0.03, \"M\": 333, \"type\": \"plane_wave\"\n        },\n        # Case D: High-wavenumber Gaussian near Nyquist\n        {\n            \"N\": 1024, \"L\": 100.0, \"x0\": 40.0, \"sigma\": 10.0, \"k0_factor\": 0.8,\n            \"dt\": 0.02, \"M\": 250, \"type\": \"high_k_gaussian\"\n        }\n    ]\n\n    results = []\n\n    for case in test_cases:\n        N = case[\"N\"]\n        L = case[\"L\"]\n        dt = case[\"dt\"]\n        M = case[\"M\"]\n        \n        # 1. Set up spatial and momentum grids\n        dx = L / N\n        x = np.linspace(0.0, L, N, endpoint=False)\n        k = 2 * np.pi * fftfreq(N, d=dx)\n        \n        # 2. Initialize wavefunction psi0\n        if case[\"type\"] == \"gaussian\":\n            x0 = case[\"x0\"]\n            sigma = case[\"sigma\"]\n            k0 = case[\"k0\"]\n            # Unnormalized Gaussian\n            psi0 = (1.0 / (np.pi * sigma**2)**0.25) * \\\n                   np.exp(-(x - x0)**2 / (2 * sigma**2)) * \\\n                   np.exp(1j * k0 * x)\n        elif case[\"type\"] == \"plane_wave\":\n            m = case[\"m\"]\n            k0 = 2 * np.pi * m / L\n            psi0 = (1.0 / np.sqrt(L)) * np.exp(1j * k0 * x)\n        elif case[\"type\"] == \"high_k_gaussian\":\n            x0 = case[\"x0\"]\n            sigma = case[\"sigma\"]\n            k_max = np.pi / dx\n            k0 = case[\"k0_factor\"] * k_max\n            psi0 = (1.0 / (np.pi * sigma**2)**0.25) * \\\n                   np.exp(-(x - x0)**2 / (2 * sigma**2)) * \\\n                   np.exp(1j * k0 * x)\n        else:\n            raise ValueError(f\"Unknown case type: {case['type']}\")\n\n        # Discrete normalization for Gaussians, plane wave is already normalized\n        if \"gaussian\" in case[\"type\"]:\n            norm_factor = np.sqrt(np.sum(np.abs(psi0)**2) * dx)\n            psi0 /= norm_factor\n\n        # 3. Method 1: Multi-step splitting evolution for V=0\n        psi_split = np.copy(psi0)\n        \n        # Kinetic energy propagator for a half time step\n        # For V=0, V-step is identity. The two half-steps can be combined for efficiency,\n        # but we implement them separately to model the Strang splitting algorithm structure.\n        kinetic_propagator_half = np.exp(-1j * 0.5 * k**2 * dt / 2)\n        \n        # Explicit V=0 potential propagator (identity)\n        potential_propagator = np.ones(N) # exp(-i*0*dt) = 1\n\n        for _ in range(M):\n            # First kinetic half-step\n            psi_k = fft(psi_split)\n            psi_k *= kinetic_propagator_half\n            psi_split = ifft(psi_k)\n            \n            # Potential step (identity for V=0)\n            psi_split *= potential_propagator\n\n            # Second kinetic half-step\n            psi_k = fft(psi_split)\n            psi_k *= kinetic_propagator_half\n            psi_split = ifft(psi_k)\n            \n        # 4. Method 2: One-shot exact evolution\n        total_time = M * dt\n        kinetic_propagator_full = np.exp(-1j * 0.5 * k**2 * total_time)\n        psi0_k = fft(psi0)\n        psi_exact_k = psi0_k * kinetic_propagator_full\n        psi_exact = ifft(psi_exact_k)\n\n        # 5. Compute L2-norm difference\n        diff_norm = np.sqrt(np.sum(np.abs(psi_split - psi_exact)**2) * dx)\n        results.append(diff_norm)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2892564"}]}