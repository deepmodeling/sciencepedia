{"hands_on_practices": [{"introduction": "我们从最简单的参考体系——理想溶液——开始。理解完全由熵驱动的理想混合过程，是量化真实溶液非理想性的必要基准。本练习将通过计算这一基本热力学量，帮助你巩固对混合自发性的根本来源的理解。[@problem_id:2651320]", "problem": "在恒温恒压下，通过将两种纯液体 $1$ 和 $2$ 在 $T=298\\ \\mathrm{K}$ 时进行等温等压混合，形成了一种遵从Raoult定律的理想溶液。混合物中组分 $1$ 的摩尔分数为 $x_{1}=0.3$，且 $x_{2}=1-x_{1}$。考虑从分离的纯液体到相同 $T$ 和 $p$ 下的最终溶液的热力学混合过程，利用化学势的基本关系式和混合吉布斯自由能的定义，推导出理想溶液的摩尔混合吉布斯自由能作为成分的函数。\n\n接着，在给定的温度和成分下，对该摩尔混合吉布斯自由能进行数值计算。最终数值答案以 $\\mathrm{J\\,mol^{-1}}$ 为单位表示，并四舍五入至四位有效数字。使用 $R=8.314\\,462\\,618\\ \\mathrm{J\\,mol^{-1}\\,K^{-1}}$。在你的论证中，简要评论结果的符号和大小与混合熵以及超额混合吉布斯自由能的关系。", "solution": "问题陈述已经过评估，并被认为是有效的。它具有科学依据，提法得当，并包含推导出唯一且有意义解所需的所有信息。我们可以开始分析。\n\n目标是推导出二元理想溶液的摩尔混合吉布斯自由能 $\\Delta g_{\\text{mix}}$ 的表达式，然后在给定的成分和温度下计算其数值。\n\n在恒定温度 $T$ 和压力 $p$ 下，混合过程的吉布斯自由能 $\\Delta G_{\\text{mix}}$ 定义为最终混合物的吉布斯自由能 $G_{\\text{mixture}}$ 与混合前各纯组分的吉布斯自由能之和 $G_{\\text{pure}}$ 之差。\n$$ \\Delta G_{\\text{mix}} = G_{\\text{mixture}} - G_{\\text{pure}} $$\n一个系统的吉布斯自由能可以用其组分的化学势 $\\mu_i$ 和物质的量 $n_i$ 来表示。对于组分 $1$ 和 $2$ 的二元混合物，溶液的吉布斯自由能为：\n$$ G_{\\text{mixture}} = n_1 \\mu_1 + n_2 \\mu_2 $$\n分离的纯组分的总吉布斯自由能为：\n$$ G_{\\text{pure}} = n_1 \\mu_1^* + n_2 \\mu_2^* $$\n其中 $\\mu_i^*$ 是纯组分 $i$ 在相同温度 $T$ 和压力 $p$ 下的化学势。\n\n将这些表达式代入 $\\Delta G_{\\text{mix}}$ 的定义中，可得：\n$$ \\Delta G_{\\text{mix}} = (n_1 \\mu_1 + n_2 \\mu_2) - (n_1 \\mu_1^* + n_2 \\mu_2^*) $$\n$$ \\Delta G_{\\text{mix}} = n_1 (\\mu_1 - \\mu_1^*) + n_2 (\\mu_2 - \\mu_2^*) $$\n问题指明该混合物为理想溶液。对于理想溶液，混合物中各组分 $i$ 的化学势与纯组分化学势之间有以下基本关系：\n$$ \\mu_i = \\mu_i^* + RT \\ln(x_i) $$\n其中 $R$ 是普适气体常数，$T$ 是绝对温度，$x_i$ 是混合物中组分 $i$ 的摩尔分数。\n\n将此关系代入 $\\Delta G_{\\text{mix}}$ 的表达式中：\n$$ \\Delta G_{\\text{mix}} = n_1 (RT \\ln x_1) + n_2 (RT \\ln x_2) $$\n为了得到摩尔混合吉布斯自由能 $\\Delta g_{\\text{mix}}$，我们将 $\\Delta G_{\\text{mix}}$ 除以总摩尔数 $n = n_1 + n_2$。\n$$ \\Delta g_{\\text{mix}} = \\frac{\\Delta G_{\\text{mix}}}{n} = \\frac{n_1}{n} RT \\ln x_1 + \\frac{n_2}{n} RT \\ln x_2 $$\n认识到摩尔分数的定义为 $x_i = n_i / n$，我们得到理想二元溶液的摩尔混合吉布斯自由能的通用表达式：\n$$ \\Delta g_{\\text{mix}} = RT (x_1 \\ln x_1 + x_2 \\ln x_2) $$\n正如所要求，该表达式是成分和温度的函数。\n\n现在，我们使用给定数据对该量进行数值计算：\n-   温度, $T = 298 \\ \\mathrm{K}$\n-   气体常数, $R = 8.314\\,462\\,618 \\ \\mathrm{J\\,mol^{-1}\\,K^{-1}}$\n-   组分 $1$ 的摩尔分数, $x_1 = 0.3$\n-   组分 $2$ 的摩尔分数, $x_2 = 1 - x_1 = 1 - 0.3 = 0.7$\n\n将这些值代入推导出的方程：\n$$ \\Delta g_{\\text{mix}} = (8.314\\,462\\,618 \\ \\mathrm{J\\,mol^{-1}\\,K^{-1}}) \\times (298 \\ \\mathrm{K}) \\times [0.3 \\ln(0.3) + 0.7 \\ln(0.7)] $$\n首先，我们计算括号内的项：\n$$ \\ln(0.3) \\approx -1.20397 $$\n$$ \\ln(0.7) \\approx -0.35667 $$\n$$ 0.3 \\times (-1.20397) + 0.7 \\times (-0.35667) \\approx -0.36119 - 0.24967 = -0.61086 $$\n现在，我们完成计算：\n$$ \\Delta g_{\\text{mix}} \\approx (8.314\\,462\\,618 \\ \\mathrm{J\\,mol^{-1}\\,K^{-1}}) \\times (298 \\ \\mathrm{K}) \\times (-0.61086) $$\n$$ \\Delta g_{\\text{mix}} \\approx (2477.71086 \\ \\mathrm{J\\,mol^{-1}}) \\times (-0.61086) $$\n$$ \\Delta g_{\\text{mix}} \\approx -1513.56 \\ \\mathrm{J\\,mol^{-1}} $$\n按要求将结果四舍五入至四位有效数字：\n$$ \\Delta g_{\\text{mix}} \\approx -1514 \\ \\mathrm{J\\,mol^{-1}} $$\n\n最后，我们对结果进行评论。对于任何混合过程，混合吉布斯自由能与混合焓和混合熵的关系为 $\\Delta G_{\\text{mix}} = \\Delta H_{\\text{mix}} - T\\Delta S_{\\text{mix}}$。对于理想溶液，一个定义性特征是其混合焓为零，即 $\\Delta H_{\\text{mix}}^{\\text{ideal}} = 0$。这是因为假设不同种分子（$1-2$）之间的分子间相互作用与同种分子（$1-1$ 和 $2-2$）之间相互作用的平均值相同。因此，对于理想溶液：\n$$ \\Delta g_{\\text{mix}}^{\\text{ideal}} = -T \\Delta s_{\\text{mix}}^{\\text{ideal}} $$\n摩尔混合熵由 $\\Delta s_{\\text{mix}}^{\\text{ideal}} = -R(x_1 \\ln x_1 + x_2 \\ln x_2)$ 给出。由于 $x_1$ 和 $x_2$ 是介于 $0$ 和 $1$ 之间的分数，它们的对数值为负。因此，对于混合物，$(x_1 \\ln x_1 + x_2 \\ln x_2)$ 这一项总是负的。这使得 $\\Delta s_{\\text{mix}}^{\\text{ideal}}$ 总是正的，反映了混合后随机性的增加。因此，对于所有成分（纯组分 $x_i=1$ 时除外）和正温度，$\\Delta g_{\\text{mix}}^{\\text{ideal}}$ 必须为负，这表明理想组分的混合是一个自发过程。我们计算出的值 $-1514 \\ \\mathrm{J\\,mol^{-1}}$ 是负的，与这一基本原理一致。\n\n超额吉布斯自由能 $G^E$ 定义为真实溶液的混合吉布斯自由能与理想溶液的混合吉布斯自由能之差：$G^E = \\Delta g_{\\text{mix}} - \\Delta g_{\\text{mix}}^{\\text{ideal}}$。由于问题指定形成的是理想溶液，根据定义，超额吉布斯自由能为零：$G^E = 0$。所计算的值代表了理想体系的混合吉布斯自由能，它完全由正的混合熵所驱动。", "answer": "$$\\boxed{-1514}$$", "id": "2651320"}, {"introduction": "从理想世界过渡到真实混合物，超额函数（如超额体积 $v^E$）为我们量化了与理想行为的偏差。这个实践将演示如何从直接的实验测量（密度）中计算出超额性质，并根据其符号来解读组分间潜在的分子间相互作用。[@problem_id:2651283]", "problem": "在温度 $T=298.15\\ \\mathrm{K}$ 和压力 $P=1.00\\ \\mathrm{bar}$ 下，由组分 $1$（丙酮）和组分 $2$（氯仿）制备了一种二元液体混合物。该混合物的摩尔分数为 $x_1=0.600$ 和 $x_2=0.400$，测得的质量密度为 $\\rho=1.1100\\ \\mathrm{g}\\ \\mathrm{cm}^{-3}$。纯组分的摩尔质量分别为 $M_1=58.08\\ \\mathrm{g}\\ \\mathrm{mol}^{-1}$ 和 $M_2=119.38\\ \\mathrm{g}\\ \\mathrm{mol}^{-1}$。在相同的 $T$ 和 $P$下，纯组分的摩尔体积分别为 $v_1^{*}=74.00\\ \\mathrm{cm}^3\\ \\mathrm{mol}^{-1}$ 和 $v_2^{*}=80.20\\ \\mathrm{cm}^3\\ \\mathrm{mol}^{-1}$。\n\n从密度、摩尔体积和摩尔超额性质的基本定义出发，确定该混合物在给定 $T$ 和 $P$ 下的混合摩尔超额体积 $v^{E}$。将最终数值结果四舍五入至四位有效数字。最终结果以 $\\mathrm{cm}^3\\ \\mathrm{mol}^{-1}$ 为单位表示。然后，简要地用文字解释 $v^{E}$ 的符号对于该混合物中分子间相互作用的意义。", "solution": "所述问题在科学上是合理的、自洽的且表述清晰。它是一个关于液体混合物性质的物理化学标准练习。所有必需的数据均已提供，不存在矛盾或模糊之处。因此，我们可以进行严谨的求解。\n\n混合摩尔超额体积，记为 $v^E$，定义为混合物的实际摩尔体积 $v$ 与该混合物在表现为理想溶液时所应具有的摩尔体积 $v^{id}$ 之间的差值。其基本定义为：\n$$v^E = v - v^{id}$$\n为了确定 $v^E$，我们必须根据所提供的数据计算出 $v$ 和 $v^{id}$。\n\n首先，我们计算理想混合物的摩尔体积 $v^{id}$。对于理想溶液，纯组分的体积在摩尔基础上是可加的。因此，理想摩尔体积是纯组分摩尔体积 $v_1^*$ 和 $v_2^*$ 的摩尔分数加权平均值。\n$$v^{id} = x_1 v_1^* + x_2 v_2^*$$\n代入给定的摩尔分数 $x_1 = 0.600$ 和 $x_2 = 0.400$，以及纯组分摩尔体积 $v_1^{*} = 74.00\\ \\mathrm{cm}^3\\ \\mathrm{mol}^{-1}$ 和 $v_2^{*} = 80.20\\ \\mathrm{cm}^3\\ \\mathrm{mol}^{-1}$：\n$$v^{id} = (0.600)(74.00\\ \\mathrm{cm}^3\\ \\mathrm{mol}^{-1}) + (0.400)(80.20\\ \\mathrm{cm}^3\\ \\mathrm{mol}^{-1})$$\n$$v^{id} = 44.40\\ \\mathrm{cm}^3\\ \\mathrm{mol}^{-1} + 32.08\\ \\mathrm{cm}^3\\ \\mathrm{mol}^{-1} = 76.48\\ \\mathrm{cm}^3\\ \\mathrm{mol}^{-1}$$\n\n接下来，我们必须确定真实混合物的实际摩尔体积 $v$。摩尔体积定义为混合物的平均摩尔质量 $M_{avg}$ 除以其质量密度 $\\rho$。\n$$v = \\frac{M_{avg}}{\\rho}$$\n平均摩尔质量 $M_{avg}$ 是各组分摩尔质量 $M_1$ 和 $M_2$ 的摩尔分数加权平均值。\n$$M_{avg} = x_1 M_1 + x_2 M_2$$\n使用给定的摩尔质量 $M_1 = 58.08\\ \\mathrm{g}\\ \\mathrm{mol}^{-1}$ 和 $M_2 = 119.38\\ \\mathrm{g}\\ \\mathrm{mol}^{-1}$：\n$$M_{avg} = (0.600)(58.08\\ \\mathrm{g}\\ \\mathrm{mol}^{-1}) + (0.400)(119.38\\ \\mathrm{g}\\ \\mathrm{mol}^{-1})$$\n$$M_{avg} = 34.848\\ \\mathrm{g}\\ \\mathrm{mol}^{-1} + 47.752\\ \\mathrm{g}\\ \\mathrm{mol}^{-1} = 82.600\\ \\mathrm{g}\\ \\mathrm{mol}^{-1}$$\n现在，我们可以使用给定的密度 $\\rho = 1.1100\\ \\mathrm{g}\\ \\mathrm{cm}^{-3}$ 来计算实际摩尔体积 $v$：\n$$v = \\frac{82.600\\ \\mathrm{g}\\ \\mathrm{mol}^{-1}}{1.1100\\ \\mathrm{g}\\ \\mathrm{cm}^{-3}} \\approx 74.4144\\ \\mathrm{cm}^3\\ \\mathrm{mol}^{-1}$$\n\n在确定了 $v$ 和 $v^{id}$ 之后，我们现在可以计算摩尔超额体积 $v^E$。\n$$v^E = v - v^{id} = 74.4144\\ \\mathrm{cm}^3\\ \\mathrm{mol}^{-1} - 76.48\\ \\mathrm{cm}^3\\ \\mathrm{mol}^{-1}$$\n$$v^E = -2.0656\\ \\mathrm{cm}^3\\ \\mathrm{mol}^{-1}$$\n题目要求将结果四舍五入至四位有效数字。\n$$v^E \\approx -2.066\\ \\mathrm{cm}^3\\ \\mathrm{mol}^{-1}$$\n\n摩尔超额体积的符号为了解混合物中与纯组分相比的分子间相互作用的性质提供了线索。如此处所得，$v^E$ 的负值表示混合时发生了体积收缩。这表明混合物的体积小于混合前纯组分体积的总和。发生这种收缩是因为异种分子（丙酮-氯仿）之间的吸引力强于同种分子（丙酮-丙酮和氯仿-氯仿）之间吸引力的平均值。在这个特定体系中，氯仿上电负性强的氯原子使其唯一的氢原子呈现异常的酸性。这使得氯仿的氢原子与丙酮的羰基氧之间能够形成相对较强的氢键。这种特定的相互作用导致混合物中分子堆积得更紧密，从而产生了观测到的负超额体积。", "answer": "$$\n\\boxed{-2.066}\n$$", "id": "2651283"}, {"introduction": "现在我们进入一个更高级的实际应用：使用复杂的模型（如 NRTL）来描述高度非理想的体系。这些模型的强大之处在于其参数，而这些参数必须通过实验数据来确定。本练习将指导你推导必要的理论关系（无限稀释活度系数 $\\gamma_i^{\\infty}$），并利用它们进行参数回归，这是化学工程和物理化学中的一项核心任务。[@problem_id:2651323]", "problem": "考虑一个处于等温等压条件下的二元液体混合物，该混合物已建立汽-液平衡，且汽相表现为理想气体。感兴趣的活度系数模型为 Wilson 模型和非随机双液体 (Non-Random Two-Liquid, NRTL) 模型。您必须选择其中一个模型，并从第一性原理出发进行推导。在本问题中，您需要对二元混合物使用 NRTL 模型。\n\n仅从基本定义和经过充分检验的事实出发，推导由 NRTL 模型描述的二元混合物在无限稀释时的极限活度系数（表示为 $\\gamma_{1}^{\\infty}$ 和 $\\gamma_{2}^{\\infty}$）的解析表达式。从汽-液平衡时的化学势相等、Raoult 定律和 Henry 定律的定义，以及摩尔超额吉布斯自由能及其与活度系数的关系的定义开始。假设气相是理想的，且压力足够低，可以忽略 Poynting 校正和逸度系数与1的偏差。\n\n然后，使用您推导出的 $\\gamma_{1}^{\\infty}$ 和 $\\gamma_{2}^{\\infty}$ 的解析表达式，为 NRTL 二元交互作用参数构建一个回归问题。在二元 NRTL 模型中，引入无量纲参数 $\\tau_{12}$、$\\tau_{21}$ 和非随机性参数 $\\alpha$（假设其与组成无关，并且两个方向上相同，即 $\\alpha_{12}=\\alpha_{21}=\\alpha$）。将 $\\alpha$ 视为已知，通过比较模型预测的 $\\gamma_{i}^{\\infty}$ 与实验 Henry 定律常数和同温度下纯组分饱和蒸汽压所隐含的值，来回归 $\\tau_{12}$ 和 $\\tau_{21}$。\n\n所有物理量必须在自洽的单位体系中处理，并且您必须明确使用以下事实：\n- 当 $x_{i} \\to 0$ 时，组分 $i$ 在无限稀释时的气相分压遵循 Henry 定律 $p_{i} = x_{i} H_{i}$，其中 $H_{i}$ 是组分 $i$ 在溶剂中的 Henry 定律常数（单位为 $\\mathrm{Pa}$）。\n- 使用活度系数的 Raoult 定律为 $p_{i} = x_{i} \\gamma_{i} p_{i}^{\\mathrm{sat}}$，其中 $p_{i}^{\\mathrm{sat}}$ 是系统温度下纯组分的饱和蒸汽压（单位为 $\\mathrm{Pa}$）。\n- 活度系数 $\\gamma_{i}$ 通过 $\\ln \\gamma_{i} = \\left( \\partial (n g^E/RT) / \\partial n_{i} \\right)_{T,p,n_{j\\neq i}}$ 与偏摩尔超额吉布斯自由能相关联，其中 $g^E$ 是摩尔超额吉布斯自由能，$R$ 是普适气体常数，$T$ 是绝对温度，$n$ 是总摩尔数。\n\n使用这些基础，推导出 $\\gamma_{i}^{\\infty}$ 关于 NRTL 参数 $\\tau_{12}$、$\\tau_{21}$ 和 $\\alpha$ 的闭式表达式，不假设任何关于无限稀释极限的先验结果。然后，将模型的 $\\gamma_{i}^{\\infty}$ 与由 $H_{i}$ 和 $p_{i}^{\\mathrm{sat}}$ 隐含的值相等，以在固定的 $\\alpha$ 和 $T$ 下获得关于两个未知数 $\\tau_{12}$ 和 $\\tau_{21}$ 的两个非线性方程。\n\n您的程序必须通过最小化极限活度系数对数的残差平方和来求解这些非线性方程，以应对下述每个测试用例。每个测试用例的最终输出是回归得到的参数值 $\\tau_{12}$ 和 $\\tau_{21}$（无量纲）。使用以下普适常数和单位：\n- 温度 $T$ 单位为 $\\mathrm{K}$。\n- 类压力物理量 $H_{i}$ 和 $p_{i}^{\\mathrm{sat}}$ 单位为 $\\mathrm{Pa}$。\n- 普适气体常数 $R$ 单位为 $\\mathrm{J\\,mol^{-1}\\,K^{-1}}$，但在此回归中您不需要其数值，因为 $\\tau_{ij}$ 直接作为无量纲数处理。\n\n测试套件（每个用例是一个元组 $(T,\\ p_{1}^{\\mathrm{sat}},\\ p_{2}^{\\mathrm{sat}},\\ H_{1},\\ H_{2},\\ \\alpha)$，所有压力单位为 $\\mathrm{Pa}$，温度单位为 $\\mathrm{K}$，$\\alpha$ 无量纲）：\n- 用例 A (一般非理想)：$(298.15,\\ 50000,\\ 20000,\\ 125000,\\ 36000,\\ 0.3)$。通过 $H_{i}/p_{i}^{\\mathrm{sat}}$，这对应于目标值 $\\gamma_{1}^{\\infty} = 2.5$ 和 $\\gamma_{2}^{\\infty} = 1.8$。\n- 用例 B (理想边界)：$(298.15,\\ 40000,\\ 30000,\\ 40000,\\ 30000,\\ 0.3)$。这对应于 $\\gamma_{1}^{\\infty} = 1$ 和 $\\gamma_{2}^{\\infty} = 1$。\n- 用例 C (强不对称性)：$(313.15,\\ 8000,\\ 3200,\\ 48000,\\ 3840,\\ 0.47)$。这对应于 $\\gamma_{1}^{\\infty} = 6.0$ 和 $\\gamma_{2}^{\\infty} = 1.2$。\n\n要求的最终输出格式：\n- 您的程序应生成单行输出，其中包含三个测试用例的连接结果，形式为包含六个浮点数的逗号分隔列表，顺序为 $[\\tau_{12}^{(A)},\\ \\tau_{21}^{(A)},\\ \\tau_{12}^{(B)},\\ \\tau_{21}^{(B)},\\ \\tau_{12}^{(C)},\\ \\tau_{21}^{(C)}]$，四舍五入到六位小数，并用方括号括起来。例如，一个有效的输出行应类似于 $[0.123456,0.234567,0.000000,0.000000,1.234568,0.345679]$。", "solution": "所述问题是有效的。其科学基础在于化学热力学原理，问题本身是适定的，并包含了获得唯一解所需的所有信息。任务是首先从非随机双液体（NRTL）模型中推导出极限活度系数的解析表达式，然后使用这些表达式从实验数据中回归二元交互作用参数。我将继续进行推导和求解。\n\n任何组分 $i$ 的汽-液平衡（VLE）的基本条件是其在液相（$L$）和汽相（$V$）中的化学势 $\\mu_i$ 相等：\n$$ \\mu_i^L(T, p, \\mathbf{x}) = \\mu_i^V(T, p, \\mathbf{y}) $$\n其中 $T$ 是绝对温度，$p$ 是总压力，$\\mathbf{x}$ 和 $\\mathbf{y}$ 分别是液相和汽相中的摩尔分数向量。\n\n假设汽相表现为理想气体，组分 $i$ 在汽相中的化学势为：\n$$ \\mu_i^V = \\mu_i^{\\text{ig, ref}}(T, p^\\circ) + RT \\ln\\left(\\frac{p_i}{p^\\circ}\\right) $$\n其中 $p_i = y_i p$ 是组分 $i$ 的分压，$p^\\circ$ 是一个参考压力。\n\n在液相中，非理想性由活度系数 $\\gamma_i$ 来描述：\n$$ \\mu_i^L = \\mu_i^{\\text{pure liquid}}(T, p) + RT \\ln(x_i \\gamma_i) $$\n在平衡时结合这些关系，并假设纯液体 $i$ 的逸度可以很好地由其饱和压力 $p_i^{\\text{sat}}$ 近似（即，在低压下忽略 Poynting 校正），可以得到修正的 Raoult 定律：\n$$ p_i = x_i \\gamma_i p_i^{\\text{sat}} $$\n\n在组分 $i$ 无限稀释时，其分压由 Henry 定律决定：\n$$ p_i = x_i H_i, \\quad \\text{当 } x_i \\to 0 $$\n其中 $H_i$ 是 Henry 定律常数。通过在无限稀释极限下（此时 $\\gamma_i$ 趋近其极限值 $\\gamma_i^\\infty$）将修正的 Raoult 定律和 Henry 定律的表达式等同起来，我们发现：\n$$ \\lim_{x_i \\to 0} (x_i \\gamma_i p_i^{\\text{sat}}) = \\lim_{x_i \\to 0} (x_i H_i) $$\n$$ \\gamma_i^\\infty p_i^{\\text{sat}} = H_i $$\n这提供了基于可测量性质的极限活度系数的“实验”或目标值：\n$$ \\gamma_{i, \\text{exp}}^\\infty = \\frac{H_i}{p_i^{\\text{sat}}} $$\n\n下一步是从所选的热力学模型 NRTL 中获得 $\\gamma_i^\\infty$ 的理论表达式。活度系数由摩尔超额吉布斯自由能 $g^E$ 通过基本关系式推导得出：\n$$ \\ln \\gamma_i = \\frac{\\bar{g}_i^E}{RT} = \\left( \\frac{\\partial (n g^E / RT)}{\\partial n_i} \\right)_{T, p, n_{j \\neq i}} $$\n对于二元混合物，NRTL 模型将 $g^E$ 定义为：\n$$ \\frac{g^E}{RT} = x_1 x_2 \\left( \\frac{\\tau_{21} G_{21}}{x_1 + x_2 G_{21}} + \\frac{\\tau_{12} G_{12}}{x_2 + x_1 G_{12}} \\right) $$\n其中 $G_{ij} = \\exp(-\\alpha \\tau_{ij})$，且问题指定了单一的非随机性参数 $\\alpha = \\alpha_{12} = \\alpha_{21}$。\n\n对 NRTL 的 $g^E/RT$ 表达式应用偏导数，得到活度系数。对于二元体系，表达式为：\n$$ \\ln \\gamma_1 = x_2^2 \\left[ \\tau_{21} \\left( \\frac{G_{21}}{x_1 + x_2 G_{21}} \\right)^2 + \\frac{\\tau_{12} G_{12}}{(x_2 + x_1 G_{12})^2} \\right] $$\n$$ \\ln \\gamma_2 = x_1^2 \\left[ \\tau_{12} \\left( \\frac{G_{12}}{x_2 + x_1 G_{12}} \\right)^2 + \\frac{\\tau_{21} G_{21}}{(x_1 + x_2 G_{21})^2} \\right] $$\n为求组分1的极限活度系数，我们在其摩尔分数 $x_1 \\to 0$（因此 $x_2 \\to 1$）的极限下计算 $\\ln \\gamma_1$：\n$$ \\ln \\gamma_1^\\infty = \\lim_{x_1 \\to 0, x_2 \\to 1} (\\ln \\gamma_1) = (1)^2 \\left[ \\tau_{21} \\left( \\frac{G_{21}}{0 + 1 \\cdot G_{21}} \\right)^2 + \\frac{\\tau_{12} G_{12}}{(1 + 0 \\cdot G_{12})^2} \\right] $$\n表达式简化为：\n$$ \\ln \\gamma_1^\\infty = \\tau_{21} + \\tau_{12} G_{12} = \\tau_{21} + \\tau_{12} \\exp(-\\alpha \\tau_{12}) $$\n根据对称性，组分2的极限活度系数（当 $x_2 \\to 0$ 且 $x_1 \\to 1$ 时）为：\n$$ \\ln \\gamma_2^\\infty = \\tau_{12} + \\tau_{21} G_{21} = \\tau_{12} + \\tau_{21} \\exp(-\\alpha \\tau_{21}) $$\n这些就是从 NRTL 模型推导出的所需极限活度系数的解析表达式。\n\n回归问题在于找到参数 $\\tau_{12}$ 和 $\\tau_{21}$，使得模型预测与实验值相匹配。我们将模型预测的极限活度系数的对数与实验值的对数相等：\n$$ \\ln\\left(\\frac{H_1}{p_1^{\\mathrm{sat}}}\\right) = \\tau_{21} + \\tau_{12} \\exp(-\\alpha \\tau_{12}) $$\n$$ \\ln\\left(\\frac{H_2}{p_2^{\\mathrm{sat}}}\\right) = \\tau_{12} + \\tau_{21} \\exp(-\\alpha \\tau_{21}) $$\n这构成了一个关于两个未知数 $\\tau_{12}$ 和 $\\tau_{21}$ 的非线性方程组。该问题通过数值方法最小化活度系数对数的残差平方和来求解。需要最小化的目标函数是：\n$$ S(\\tau_{12}, \\tau_{21}) = \\left[ \\ln\\left(\\frac{H_1}{p_1^{\\mathrm{sat}}}\\right) - \\left(\\tau_{21} + \\tau_{12} e^{-\\alpha\\tau_{12}}\\right) \\right]^2 + \\left[ \\ln\\left(\\frac{H_2}{p_2^{\\mathrm{sat}}}\\right) - \\left(\\tau_{12} + \\tau_{21} e^{-\\alpha\\tau_{21}}\\right) \\right]^2 $$\n使用一个非线性最小二乘求解器来找到使 $S$ 最小化的 $(\\tau_{12}, \\tau_{21})$ 的值，并对每个给定的测试用例进行计算。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import least_squares\n\ndef solve():\n    \"\"\"\n    Solves for NRTL binary interaction parameters tau12 and tau21 for three\n    test cases by fitting to limiting activity coefficients derived from\n    Henry's constants and saturation pressures.\n    \"\"\"\n    \n    # Test suite: (T, p1_sat, p2_sat, H1, H2, alpha)\n    # Pressures are in Pa, Temperature in K.\n    test_cases = [\n        # Case A (general nonideal)\n        (298.15, 50000.0, 20000.0, 125000.0, 36000.0, 0.3),\n        # Case B (ideal boundary)\n        (298.15, 40000.0, 30000.0, 40000.0, 30000.0, 0.3),\n        # Case C (strong asymmetry)\n        (313.15, 8000.0, 3200.0, 48000.0, 3840.0, 0.47),\n    ]\n\n    all_results = []\n    \n    for case in test_cases:\n        _T, p1_sat, p2_sat, H1, H2, alpha = case\n        \n        # Calculate target values for the logarithm of limiting activity coefficients\n        # from experimental data.\n        # gamma_1_inf_exp = H1 / p1_sat\n        # gamma_2_inf_exp = H2 / p2_sat\n        log_gamma1_inf_exp = np.log(H1 / p1_sat)\n        log_gamma2_inf_exp = np.log(H2 / p2_sat)\n\n        def residual_function(tau):\n            \"\"\"\n            Calculates the residuals between the model-predicted log activity\n            coefficients and the target experimental values.\n            \n            Args:\n                tau (list or np.ndarray): A list containing [tau12, tau21].\n            \n            Returns:\n                list: A list of two residuals.\n            \"\"\"\n            tau12, tau21 = tau\n            \n            # Model prediction for log(gamma_1_inf) using the derived expression:\n            # ln(gamma_1^inf) = tau_21 + tau_12 * exp(-alpha * tau_12)\n            log_gamma1_inf_model = tau21 + tau12 * np.exp(-alpha * tau12)\n            \n            # Model prediction for log(gamma_2_inf) using the derived expression:\n            # ln(gamma_2^inf) = tau_12 + tau_21 * exp(-alpha * tau_21)\n            log_gamma2_inf_model = tau12 + tau21 * np.exp(-alpha * tau21)\n            \n            # Calculate residuals\n            res1 = log_gamma1_inf_model - log_gamma1_inf_exp\n            res2 = log_gamma2_inf_model - log_gamma2_inf_exp\n            \n            return [res1, res2]\n\n        # Initial guess for the parameters [tau12, tau21].\n        # A zero guess is a good starting point, corresponding to an ideal solution.\n        tau_initial_guess = [0.0, 0.0]\n\n        # Use scipy's least_squares solver to find the optimal tau values\n        # by minimizing the sum of squares of the residuals.\n        solution = least_squares(residual_function, tau_initial_guess)\n        \n        # The optimal parameters are in the 'x' attribute of the result object.\n        tau12_fit, tau21_fit = solution.x\n        \n        # Append the regressed parameters to the results list.\n        all_results.extend([tau12_fit, tau21_fit])\n\n    # Format the final output string as specified: a single line with\n    # comma-separated values rounded to six decimal places, enclosed in brackets.\n    formatted_results = [f\"{r:.6f}\" for r in all_results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2651323"}]}