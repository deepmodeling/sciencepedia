{"hands_on_practices": [{"introduction": "逸度系数 $\\phi$ 是衡量真实气体偏离理想行为的主要指标。虽然对于某些特定的状态方程，我们可以推导出 $\\phi$ 的解析表达式，但更基本、更通用的方法是直接对余留吉布斯能的积分定义式进行数值计算。该练习将引导您从第一性原理出发，推导核心积分关系式 $\\ln \\phi = \\int (Z-1)/P DP$，并编写程序求解该积分，从而掌握一种强大且可推广的热力学建模技能。[@problem_id:2642551]", "problem": "为了通过逸度系数来量化与理想气体行为的偏差，使用一个真实状态方程对恒温下的纯气体进行建模。从纯物质的热力学基本原理出发，推导一个逸度系数自然对数的表达式，该表达式应适用于在恒温下对压力进行一维积分的数值计算，且不借助任何特定于模型的简化表达式。然后，实现一个程序，该程序使用一个三次状态方程来计算作为压力函数的压缩因子，从而对该积分进行数值计算。\n\n您可以使用的基本原理包括：纯物质的化学势和逸度的定义、压缩因子的定义、恒温下的平衡热力学，以及经过充分检验的真实气体状态方程。不要假设或从任何预先推导出的逸度系数闭合形式表达式出发。\n\n使用 Peng–Robinson 状态方程对气体进行建模，其摩尔形式为\n$$\nP \\;=\\; \\frac{R T}{\\bar{V} - b} \\;-\\; \\frac{a \\,\\alpha(T)}{\\bar{V}^{2} + 2 b \\bar{V} - b^{2}} \\,,\n$$\n其中 $P$ 是压力，$T$ 是温度，$\\bar{V}$ 是摩尔体积，$R$ 是通用气体常数。这些参数由临界性质和偏心因子指定如下\n$$\na \\;=\\; 0.45724 \\,\\frac{R^{2} T_{\\mathrm{c}}^{2}}{P_{\\mathrm{c}}}, \\quad\nb \\;=\\; 0.07780 \\,\\frac{R T_{\\mathrm{c}}}{P_{\\mathrm{c}}}, \\quad\n\\alpha(T) \\;=\\; \\left[1 + \\kappa \\left(1 - \\sqrt{T/T_{\\mathrm{c}}}\\right)\\right]^{2},\n$$\n其中\n$$\n\\kappa \\;=\\; 0.37464 + 1.54226\\,\\omega - 0.26992\\,\\omega^{2},\n$$\n式中 $T_{\\mathrm{c}}$ 是临界温度，$P_{\\mathrm{c}}$ 是临界压力，$\\omega$ 是偏心因子。压缩因子为 $Z \\equiv \\dfrac{P \\bar{V}}{R T}$，对于 Peng–Robinson 状态方程，在固定的 $T$ 和 $P$ 下，它满足一个关于 $Z$ 的三次方程。当存在多个实根时，为气相选择最大的实根。\n\n需使用的数值和物理细节：\n- 使用通用气体常数 $R = 8.314462618 \\ \\mathrm{J \\, mol^{-1} \\, K^{-1}}$。\n- 所有温度单位必须是 $\\mathrm{K}$，所有压力单位必须是 $\\mathrm{Pa}$，所有能量单位必须是 $\\mathrm{J \\, mol^{-1}}$。\n- 采用纯气体的气相标准态：在相同 $T$ 和 $P$ 下的假想理想气体。在此约定中，逸度系数 $\\phi$ 由 $f = \\phi P$ 定义，且极限 $P \\to 0$ 意味着 $\\phi \\to 1$。\n- 将恒温下逸度系数自然对数的积分作为从 $P \\to 0$ 到目标压力 $P$ 的压力积分进行计算。使用在 $P \\to 0$ 时表现良好的求积法进行数值积分（例如，将积分变量转换为压力的自然对数，以便 $d(\\ln P) = dP/P$）。\n\n需要实现和评估的测试套件，每个案例指定为 $(\\text{名称}; T, P, T_{\\mathrm{c}}, P_{\\mathrm{c}}, \\omega)$:\n- 案例 A: methane; $T = 300 \\ \\mathrm{K}$, $P = 1.0 \\times 10^{5} \\ \\mathrm{Pa}$, $T_{\\mathrm{c}} = 190.564 \\ \\mathrm{K}$, $P_{\\mathrm{c}} = 4.5992 \\times 10^{6} \\ \\mathrm{Pa}$, $\\omega = 0.011$。\n- 案例 B: methane; $T = 300 \\ \\mathrm{K}$, $P = 5.0 \\times 10^{6} \\ \\mathrm{Pa}$, $T_{\\mathrm{c}} = 190.564 \\ \\mathrm{K}$, $P_{\\mathrm{c}} = 4.5992 \\times 10^{6} \\ \\mathrm{Pa}$, $\\omega = 0.011$。\n- 案例 C: carbon dioxide; $T = 320 \\ \\mathrm{K}$, $P = 1.0 \\times 10^{7} \\ \\mathrm{Pa}$, $T_{\\mathrm{c}} = 304.1282 \\ \\mathrm{K}$, $P_{\\mathrm{c}} = 7.3773 \\times 10^{6} \\ \\mathrm{Pa}$, $\\omega = 0.22394$。\n- 案例 D: nitrogen; $T = 200 \\ \\mathrm{K}$, $P = 2.0 \\times 10^{6} \\ \\mathrm{Pa}$, $T_{\\mathrm{c}} = 126.2 \\ \\mathrm{K}$, $P_{\\mathrm{c}} = 3.3958 \\times 10^{6} \\ \\mathrm{Pa}$, $\\omega = 0.0372$。\n- 案例 E: methane; $T = 300 \\ \\mathrm{K}$, $P = 1.0 \\times 10^{2} \\ \\mathrm{Pa}$, $T_{\\mathrm{c}} = 190.564 \\ \\mathrm{K}$, $P_{\\mathrm{c}} = 4.5992 \\times 10^{6} \\ \\mathrm{Pa}$, $\\omega = 0.011$。\n\n您的程序应针对每个案例，使用所述方法计算逸度系数的自然对数 $\\ln \\phi$（无量纲）。最终输出必须是单行，包含一个 Python 风格的列表，其中是案例 A、B、C、D、E 的 $\\ln \\phi$ 值，顺序与此一致，每个值四舍五入到 $8$ 位小数。例如，格式必须严格为\n$[\\ell_{A},\\ell_{B},\\ell_{C},\\ell_{D},\\ell_{E}]$\n其中每个 $\\ell$ 是对应案例计算出的 $\\ln \\phi$ 值。您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果（例如，$[x_{1},x_{2},x_{3}]$）。不应打印任何额外文本。", "solution": "从恒定温度 $T$ 下的纯物质开始。在恒温下，化学势 $\\mu$ 的微分形式由基本热力学恒等式给出\n$$\n\\left(\\frac{\\partial \\mu}{\\partial P}\\right)_{T} \\;=\\; \\bar{V},\n$$\n其中 $\\bar{V}$ 是摩尔体积。对于理想气体，相应的关系为\n$$\n\\left(\\frac{\\partial \\mu^{\\mathrm{ig}}}{\\partial P}\\right)_{T} \\;=\\; \\bar{V}^{\\mathrm{ig}} \\;=\\; \\frac{R T}{P}.\n$$\n定义剩余化学势 $\\mu^{\\mathrm{R}} \\equiv \\mu - \\mu^{\\mathrm{ig}}$。则在恒温下，\n$$\n\\left(\\frac{\\partial \\mu^{\\mathrm{R}}}{\\partial P}\\right)_{T} \\;=\\; \\bar{V} - \\frac{R T}{P}.\n$$\n引入压缩因子 $Z \\equiv \\dfrac{P \\bar{V}}{R T}$，因此 $\\bar{V} = \\dfrac{Z R T}{P}$。代入前一个表达式可得\n$$\n\\left(\\frac{\\partial \\mu^{\\mathrm{R}}}{\\partial P}\\right)_{T} \\;=\\; \\frac{Z R T}{P} - \\frac{R T}{P} \\;=\\; (Z - 1)\\,\\frac{R T}{P}.\n$$\n两边同除以 $R T$，并在恒定温度 $T$ 下从 $P \\to 0$ 积分到有限压力 $P$：\n$$\n\\frac{\\mu^{\\mathrm{R}}(T,P)}{R T} \\;=\\; \\int_{0}^{P} \\frac{Z(T,P') - 1}{P'} \\, dP'.\n$$\n根据纯气体标准态（在相同 $T$ 和 $P$ 下的假想理想气体）的逸度 $f$ 的定义，化学势可以写成\n$$\n\\mu(T,P) \\;=\\; \\mu^{\\circ}(T) + R T \\ln\\!\\left(\\frac{f}{P^{\\circ}}\\right), \\qquad\n\\mu^{\\mathrm{ig}}(T,P) \\;=\\; \\mu^{\\circ}(T) + R T \\ln\\!\\left(\\frac{P}{P^{\\circ}}\\right),\n$$\n因此剩余化学势为\n$$\n\\mu^{\\mathrm{R}}(T,P) \\;=\\; \\mu(T,P) - \\mu^{\\mathrm{ig}}(T,P) \\;=\\; R T \\ln\\!\\left(\\frac{f}{P}\\right) \\;=\\; R T \\ln \\phi,\n$$\n其中 $\\phi \\equiv f/P$ 是逸度系数，并且当 $P \\to 0$ 时 $\\phi \\to 1$。与积分表达式比较，立即得到精确的恒等式\n$$\n\\ln \\phi(T,P) \\;=\\; \\int_{0}^{P} \\frac{Z(T,P') - 1}{P'} \\, dP'.\n$$\n该关系式即为所求的逸度系数自然对数的定温压力积分，它是从第一性原理推导出来的，没有任何特定于状态方程的简化方法。如果将变量转换为 $s \\equiv \\ln P$，由于 $d s = dP / P$，该式在数值上表现良好，从而得到\n$$\n\\ln \\phi(T,P) \\;=\\; \\int_{-\\infty}^{\\ln P} \\left[ Z\\big(T, e^{s}\\big) - 1 \\right] \\, ds.\n$$\n在实践中，由于对于任何真实状态方程，当 $P \\to 0$ 时 $Z \\to 1$，因此该积分可以通过在 $s = \\ln P$ 网格上使用梯形法则，从一个很小的压力 $P_{\\min} \\ll P$ 积分到 $P$ 来进行数值计算。\n\n为了计算给定 $T$ 和 $P$ 下的 $Z(T,P)$，采用 Peng–Robinson 状态方程（一种经过充分检验的三次状态方程）。根据以下定义\n$$\na \\;=\\; 0.45724 \\,\\frac{R^{2} T_{\\mathrm{c}}^{2}}{P_{\\mathrm{c}}}, \\qquad\nb \\;=\\; 0.07780 \\,\\frac{R T_{\\mathrm{c}}}{P_{\\mathrm{c}}}, \\qquad\n\\kappa \\;=\\; 0.37464 + 1.54226\\,\\omega - 0.26992\\,\\omega^{2},\n$$\n$$\n\\alpha(T) \\;=\\; \\left[1 + \\kappa \\left(1 - \\sqrt{T/T_{\\mathrm{c}}}\\right)\\right]^{2},\n$$\n定义无量纲参数\n$$\nA \\;=\\; \\frac{a \\,\\alpha(T)\\, P}{R^{2} T^{2}}, \\qquad B \\;=\\; \\frac{b\\,P}{R T}.\n$$\n压缩因子 $Z$ 被确定为以下三次多项式的一个实根\n$$\nZ^{3} - (1 - B) Z^{2} + \\big(A - 3 B^{2} - 2 B\\big) Z - \\big(A B - B^{2} - B^{3}\\big) \\;=\\; 0.\n$$\n对于气相，当存在多个实根时，选择最大的实根。这样就得到了被积函数所需的 $Z(T,P)$。\n\n计算 $\\ln \\phi$ 的算法步骤：\n- 对于每个案例，在指定的 $T$ 下，根据 $T_{\\mathrm{c}}$、$P_{\\mathrm{c}}$ 和 $\\omega$ 计算 $a$、$b$、$\\kappa$ 和 $\\alpha(T)$。\n- 对于从 $P_{\\min}$ 到目标压力 $P$ 的对数间隔压力网格（其中 $P_{\\min}$ 的选择应满足 $P_{\\min} \\ll P$，例如 $P_{\\min} = \\max\\!\\big(10^{-12} \\ \\mathrm{Pa}, 10^{-8} P\\big)$），计算 $A$ 和 $B$，构建三次方程，并求解 $Z$（选择最大的实根）。\n- 在 $\\ln P$ 网格上计算被积函数 $Z - 1$，并使用 $s = \\ln P$ 上的梯形法则计算积分以获得 $\\ln \\phi$。\n- 由于当 $P \\to 0$ 时被积函数趋于零，因此对于足够小的 $P_{\\min}$，积分下限部分的贡献可以忽略不计，并且在 $s$ 上的数值求积是稳定的。\n\n数值参数和输出：\n- 使用 $R = 8.314462618 \\ \\mathrm{J \\, mol^{-1} \\, K^{-1}}$。\n- 单位：$T$ 以 $\\mathrm{K}$ 为单位，$P$ 以 $\\mathrm{Pa}$ 为单位。\n- 对于每个测试案例，计算 $\\ln \\phi$ 并四舍五入到 $8$ 位小数。\n- 输出单行，其中包含一个 Python 风格的列表 $[\\ell_{A},\\ell_{B},\\ell_{C},\\ell_{D},\\ell_{E}]$，对应于五个案例（methane 在 $T = 300 \\ \\mathrm{K}, P = 1.0 \\times 10^{5} \\ \\mathrm{Pa}$；methane 在 $T = 300 \\ \\mathrm{K}, P = 5.0 \\times 10^{6} \\ \\mathrm{Pa}$；carbon dioxide 在 $T = 320 \\ \\mathrm{K}, P = 1.0 \\times 10^{7} \\ \\mathrm{Pa}$；nitrogen 在 $T = 200 \\ \\mathrm{K}, P = 2.0 \\times 10^{6} \\ \\mathrm{Pa}$；methane 在 $T = 300 \\ \\mathrm{K}, P = 1.0 \\times 10^{2} \\ \\mathrm{Pa}$）。\n\n测试覆盖理由：\n- 案例 A 探测低压行为，此时 $Z \\approx 1$ 且 $\\ln \\phi$ 接近于 $0$。\n- 案例 B 考察相同气体和温度下的中到高压情况，揭示显著的非理想性。\n- 案例 C 探索高压下的超临界 carbon dioxide，此时非理想性很强。\n- 案例 D 考虑超临界温度和中等压力下的 nitrogen。\n- 案例 E 是一个极低压极限，用以测试对 $P \\to 0$ 行为的数值处理能力。\n\n此方法遵循气相标准态，并通过将热力学恒等式 $\\ln \\phi = \\int_{0}^{P} (Z - 1)\\, dP'/P'$ 与一个提供 $Z(T,P)$ 的状态方程相结合，直接计算纯气体的逸度系数。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\nR = 8.314462618  # J/mol/K\n\ndef pr_parameters(T, Tc, Pc, omega):\n    # Peng–Robinson parameter calculations\n    a = 0.45724 * R**2 * Tc**2 / Pc\n    b = 0.07780 * R * Tc / Pc\n    kappa = 0.37464 + 1.54226 * omega - 0.26992 * omega**2\n    alpha = (1.0 + kappa * (1.0 - np.sqrt(T / Tc))) ** 2\n    return a, b, alpha\n\ndef pr_Z_vapor(P, T, a, b, alpha):\n    # Compute Z by solving the Peng–Robinson cubic and selecting the vapor root (largest real root)\n    # Dimensionless parameters\n    A = a * alpha * P / (R**2 * T**2)\n    B = b * P / (R * T)\n    # Coefficients of Z cubic: Z^3 - (1 - B) Z^2 + (A - 3 B^2 - 2 B) Z - (A B - B^2 - B^3) = 0\n    coeffs = [1.0,\n              -(1.0 - B),\n              (A - 3.0 * B * B - 2.0 * B),\n              -(A * B - B * B - B**3)]\n    roots = np.roots(coeffs)\n    # Filter real roots\n    real_roots = [r.real for r in roots if abs(r.imag) < 1e-10]\n    if not real_roots:\n        # Fallback: return ideal gas if numerical issue\n        return 1.0\n    # Vapor root is largest real root\n    Z = max(real_roots)\n    return float(Z)\n\ndef ln_phi_via_integration(T, P, Tc, Pc, omega):\n    if P <= 0.0:\n        return 0.0\n    a, b, alpha = pr_parameters(T, Tc, Pc, omega)\n    # Define log-pressure integration bounds\n    # Start from a small pressure; ensure several decades below target P\n    P_min = max(1e-12, 1e-8 * P)\n    if P_min >= P:\n        # If target P is extremely small, shrink P_min\n        P_min = min(P * 1e-3, P * 0.5)\n        if P_min <= 0.0:\n            P_min = P * 1e-3 if P > 0 else 1e-12\n    s0 = np.log(P_min)\n    s1 = np.log(P)\n    # Number of integration points (log-spaced). Use more points for higher P to improve accuracy.\n    # Heuristic: base + logarithmic range scaled points\n    log_range = max(1.0, (s1 - s0))\n    npts = int(min(5000, max(200, 300 * log_range)))\n    s = np.linspace(s0, s1, npts)\n    P_grid = np.exp(s)\n    # Compute Z on the grid\n    Z_vals = np.empty_like(P_grid)\n    for i, Pi in enumerate(P_grid):\n        Z_vals[i] = pr_Z_vapor(Pi, T, a, b, alpha)\n    integrand = Z_vals - 1.0\n    # Trapezoidal rule in s = ln P\n    lnphi = np.trapz(integrand, s)\n    return float(lnphi)\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each tuple: (name, T[K], P[Pa], Tc[K], Pc[Pa], omega)\n    test_cases = [\n        (\"methane-A\", 300.0, 1.0e5, 190.564, 4.5992e6, 0.011),      # Case A\n        (\"methane-B\", 300.0, 5.0e6, 190.564, 4.5992e6, 0.011),      # Case B\n        (\"carbon-dioxide-C\", 320.0, 1.0e7, 304.1282, 7.3773e6, 0.22394),  # Case C\n        (\"nitrogen-D\", 200.0, 2.0e6, 126.2, 3.3958e6, 0.0372),      # Case D\n        (\"methane-E\", 300.0, 1.0e2, 190.564, 4.5992e6, 0.011),      # Case E\n    ]\n\n    results = []\n    for _, T, P, Tc, Pc, omega in test_cases:\n        lnphi = ln_phi_via_integration(T, P, Tc, Pc, omega)\n        # Round to 8 decimal places as required\n        results.append(f\"{lnphi:.8f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "2642551"}, {"introduction": "确定液体的逸度，特别是当它被压缩到远离其饱和点时，是一项重要的挑战。本练习将演示一种标准而强大的技术：从一个已知的参考态（与其蒸气相平衡的饱和液体）出发，然后对压力变化进行校正。这个过程会引出波因廷因子 (Poynting factor) 的推导和应用，它定量地将液体的摩尔体积与其逸度的压力依赖性联系起来。[@problem_id:2642547]", "problem": "一种处于温度 $T = 298.15\\,\\text{K}$ 的纯液体（丙酮），从其在饱和压力下与自身蒸气平衡的状态，被压缩至一个更高的压力状态。从纯物质的化学势可通过其逸度 $f$ 写为 $\\mu(T,P) = \\mu^{\\circ}(T) + RT \\ln\\!\\big(f/f^{\\circ}\\big)$（其中 $f^{\\circ}$ 为选定的参考逸度）的基本定义出发，结合相平衡时共存相化学势相等的条件，以及纯凝聚相在恒温下的热力学恒等式 $d\\mu = V\\,dP$，推导出一个用于计算该液体在较高压力下逸度的工作表达式。然后，将液体视为具有恒定等温压缩系数的弱可压缩流体，利用下列数据计算该表达式的值。\n\n已知：\n- 在 $298.15\\,\\text{K}$ 下的饱和压力：$P_{\\text{sat}} = 0.304\\,\\text{bar}$。\n- 在 $P_{\\text{sat}}$ 下的蒸气逸度系数：$\\phi^{\\text{sat}} = 0.998$。\n- 在 $P_{0} = 1.000\\,\\text{bar}$ 下的液体摩尔体积：$V_{0} = 73.5\\,\\text{cm}^{3}\\,\\text{mol}^{-1}$。\n- 等温压缩系数（假设在压力区间内为常数）：$\\kappa_{T} = 1.15 \\times 10^{-9}\\,\\text{Pa}^{-1}$。\n- 将液体摩尔体积处理为关于压力 $P_{0}$ 的线性函数：$V_{\\text{liq}}(P) \\approx V_{0}\\big[1 - \\kappa_{T}(P - P_{0})\\big]$。\n- 普适气体常数：$R = 8.314462618\\,\\text{J}\\,\\text{mol}^{-1}\\,\\text{K}^{-1}$。\n\n目标压力：$P = 100.0\\,\\text{bar}$。在进行积分和指数运算时，请一致使用国际单位制（SI）。请将液体在 $T = 298.15\\,\\text{K}$ 和 $P = 100.0\\,\\text{bar}$ 下的最终逸度以 bar 为单位表示，并将您的答案四舍五入到四位有效数字。", "solution": "推导始于给定温度 $T$ 和相应饱和压力 $P_{\\text{sat}}$ 下纯液体与其蒸气之间的相平衡条件。在平衡时，两相的化学势相等：\n$$ \\mu_{\\text{liq}}(T, P_{\\text{sat}}) = \\mu_{\\text{vap}}(T, P_{\\text{sat}}) $$\n根据逸度 $f$ 的定义，纯物质的化学势 $\\mu$ 由 $\\mu(T,P) = \\mu^{\\circ}(T) + RT \\ln(f/f^{\\circ})$ 给出，其中 $\\mu^{\\circ}$ 是标准态下的化学势，$f^{\\circ}$ 是该状态下的逸度。因此，化学势相等意味着共存相的逸度也相等：\n$$ f_{\\text{liq}}(T, P_{\\text{sat}}) = f_{\\text{vap}}(T, P_{\\text{sat}}) $$\n蒸气（一种气体）的逸度通过逸度系数 $\\phi = f/P$ 与压力相关联。在饱和状态下，这得到 $f_{\\text{vap}}(T, P_{\\text{sat}}) = \\phi^{\\text{sat}} P_{\\text{sat}}$。因此，液体在饱和压力下的逸度，我们记为 $f_{\\text{liq}}^{\\text{sat}}$，是：\n$$ f_{\\text{liq}}^{\\text{sat}} = f_{\\text{liq}}(T, P_{\\text{sat}}) = \\phi^{\\text{sat}} P_{\\text{sat}} $$\n这个值作为我们的参考点。\n\n接下来，我们考虑在恒定温度 $T$ 下，将液体从其饱和压力 $P_{\\text{sat}}$ 压缩到更高压力 $P$ 的过程。纯物质在恒温下化学势随压力的变化由以下基本热力学关系式给出：\n$$ d\\mu_{\\text{liq}} = V_{\\text{liq}} dP $$\n其中 $V_{\\text{liq}}$ 是液体的摩尔体积。为了求得最终压力 $P$ 下的化学势，我们将此表达式从初始状态 $(T, P_{\\text{sat}})$ 积分到最终状态 $(T, P)$：\n$$ \\int_{\\mu_{\\text{liq}}(T, P_{\\text{sat}})}^{\\mu_{\\text{liq}}(T, P)} d\\mu = \\int_{P_{\\text{sat}}}^{P} V_{\\text{liq}}(P') dP' $$\n$$ \\mu_{\\text{liq}}(T, P) - \\mu_{\\text{liq}}(T, P_{\\text{sat}}) = \\int_{P_{\\text{sat}}}^{P} V_{\\text{liq}}(P') dP' $$\n我们再次使用逸度的定义，从中可以得出 $\\mu(T, P) - \\mu(T, P_{\\text{sat}}) = RT \\ln(f_{\\text{liq}}(T, P) / f_{\\text{liq}}(T, P_{\\text{sat}}))$。将此代入积分后的方程，得到：\n$$ RT \\ln\\left(\\frac{f_{\\text{liq}}(T, P)}{f_{\\text{liq}}^{\\text{sat}}}\\right) = \\int_{P_{\\text{sat}}}^{P} V_{\\text{liq}}(P') dP' $$\n解出压缩液体逸度 $f_{\\text{liq}}(T, P)$，我们得到通用的工作表达式：\n$$ f_{\\text{liq}}(T, P) = f_{\\text{liq}}^{\\text{sat}} \\exp\\left( \\frac{1}{RT} \\int_{P_{\\text{sat}}}^{P} V_{\\text{liq}}(P') dP' \\right) $$\n代入 $f_{\\text{liq}}^{\\text{sat}} = \\phi^{\\text{sat}} P_{\\text{sat}}$，上式变为：\n$$ f_{\\text{liq}}(T, P) = (\\phi^{\\text{sat}} P_{\\text{sat}}) \\exp\\left( \\frac{1}{RT} \\int_{P_{\\text{sat}}}^{P} V_{\\text{liq}}(P') dP' \\right) $$\n指数项被称为 Poynting 修正因子。\n\n现在，我们使用给定的数据来计算这个表达式的值。液体的摩尔体积被表述为压力的线性函数：$V_{\\text{liq}}(P) = V_{0}\\big[1 - \\kappa_{T}(P - P_{0})\\big]$。我们将其代入积分：\n$$ \\int_{P_{\\text{sat}}}^{P} V_{0}\\big[1 - \\kappa_{T}(P' - P_{0})\\big] dP' = V_0 \\int_{P_{\\text{sat}}}^{P} (1 + \\kappa_{T}P_{0} - \\kappa_{T}P') dP' $$\n进行积分：\n$$ \\int V_{\\text{liq}} dP' = V_0 \\left[ (1 + \\kappa_T P_0)P' - \\frac{\\kappa_T}{2} (P')^2 \\right]_{P_{\\text{sat}}}^{P} $$\n$$ = V_0 \\left( (1 + \\kappa_T P_0)(P - P_{\\text{sat}}) - \\frac{\\kappa_T}{2} (P^2 - P_{\\text{sat}}^2) \\right) $$\n进行数值计算时，所有物理量必须采用一致的国际单位制（SI）单位。\n已知数据：\n$T = 298.15\\,\\text{K}$\n$R = 8.314462618\\,\\text{J}\\,\\text{mol}^{-1}\\,\\text{K}^{-1}$\n$P_{\\text{sat}} = 0.304\\,\\text{bar} = 0.304 \\times 10^5\\,\\text{Pa} = 3.04 \\times 10^4\\,\\text{Pa}$\n$P = 100.0\\,\\text{bar} = 100.0 \\times 10^5\\,\\text{Pa} = 1.000 \\times 10^7\\,\\text{Pa}$\n$\\phi^{\\text{sat}} = 0.998$\n$V_{0} = 73.5\\,\\text{cm}^{3}\\,\\text{mol}^{-1} = 73.5 \\times (10^{-2}\\,\\text{m})^3\\,\\text{mol}^{-1} = 7.35 \\times 10^{-5}\\,\\text{m}^{3}\\,\\text{mol}^{-1}$\n$P_{0} = 1.000\\,\\text{bar} = 1.000 \\times 10^5\\,\\text{Pa}$\n$\\kappa_{T} = 1.15 \\times 10^{-9}\\,\\text{Pa}^{-1}$\n\n首先，我们计算液体在饱和状态下的逸度：\n$f_{\\text{liq}}^{\\text{sat}} = \\phi^{\\text{sat}} P_{\\text{sat}} = 0.998 \\times 0.304\\,\\text{bar} = 0.303392\\,\\text{bar}$.\n\n接下来，我们计算积分的值，设其为 $I$：\n$P - P_{\\text{sat}} = 1.000 \\times 10^7 - 3.04 \\times 10^4 = 9.9696 \\times 10^6\\,\\text{Pa}$\n$P^2 - P_{\\text{sat}}^2 = (1.000 \\times 10^7)^2 - (3.04 \\times 10^4)^2 = 10^{14} - 9.2416 \\times 10^8 = 9.999907584 \\times 10^{13}\\,\\text{Pa}^2$\n$I = (7.35 \\times 10^{-5}) \\left( (1 + (1.15 \\times 10^{-9})(1.000 \\times 10^5))(9.9696 \\times 10^6) - \\frac{1.15 \\times 10^{-9}}{2} (9.999907584 \\times 10^{13}) \\right)$\n$I = (7.35 \\times 10^{-5}) \\left( (1.000115)(9.9696 \\times 10^6) - (5.75 \\times 10^{-10})(9.999907584 \\times 10^{13}) \\right)$\n$I = (7.35 \\times 10^{-5}) \\left( 9.9707465... \\times 10^6 - 57499.468... \\right)$\n$I = (7.35 \\times 10^{-5}) \\left( 9913247.0... \\right) = 728.6236...\\,\\text{J}\\,\\text{mol}^{-1}$\n\n现在，我们计算 Poynting 因子的指数：\n$\\frac{I}{RT} = \\frac{728.6236\\,\\text{J}\\,\\text{mol}^{-1}}{(8.314462618\\,\\text{J}\\,\\text{mol}^{-1}\\,\\text{K}^{-1})(298.15\\,\\text{K})} = \\frac{728.6236}{2478.9555} = 0.293924...$\n\nPoynting 因子是：\n$\\exp(0.293924) = 1.34168...$\n\n最后，我们计算压缩液体的逸度：\n$f_{\\text{liq}}(T, P) = f_{\\text{liq}}^{\\text{sat}} \\times \\exp\\left(\\frac{I}{RT}\\right) = (0.303392\\,\\text{bar}) \\times (1.34168...)$\n$f_{\\text{liq}}(T, P) = 0.407073...\\,\\text{bar}$\n\n按要求将结果四舍五入到四位有效数字：\n$f_{\\text{liq}}(100.0\\,\\text{bar}) = 0.4071\\,\\text{bar}$.", "answer": "$$\\boxed{0.4071}$$", "id": "2642547"}, {"introduction": "本练习将为液体建立的原理扩展到固相，在固相中，活度 (activity) 的概念常被用来描述对标准态的偏离。在地球化学或材料科学等领域中遇到的高压条件，可以显著改变固体的化学势。该实践涉及从第一性原理进行严格推导，展示如何通过对固体的摩尔体积进行积分来计算其在高压下的活度，同时考虑其可压缩性的影响。[@problem_id:2642548]", "problem": "在温度 $T$ 下，一种纯晶体固体 $S$ 的等温压缩系数 $\\kappa_{T}$ 在中等压力范围内可视为常数。$S$ 的标准态定义为在相同温度 $T$ 和参考压力 $P^{\\ominus} = 1\\ \\mathrm{bar}$ 下的纯固体。在压力 $P$ 下，该固体的活度 $a_{S}(T,P)$ 由化学势关系式 $\\mu_{S}(T,P) = \\mu_{S}^{\\ominus}(T,P^{\\ominus}) + RT \\ln a_{S}(T,P)$ 定义。仅从基本关系式 $(\\partial \\mu/\\partial P)_{T} = \\bar{V}$ 和 $\\kappa_{T} = -\\frac{1}{\\bar{V}} \\left(\\frac{\\partial \\bar{V}}{\\partial P}\\right)_{T}$ 出发，推导 $a_{S}(T,P)$ 的表达式，该表达式用 $\\bar{V}(T,P^{\\ominus})$、$\\kappa_{T}$、$R$、$T$、$P$ 和 $P^{\\ominus}$ 表示，并假设 $\\kappa_{T}$ 在区间 $[P^{\\ominus},P]$ 内与 $P$ 无关。\n\n然后，使用 $T = 350\\ \\mathrm{K}$ 时的以下数据对 $a_{S}$ 进行数值计算：\n- 参考压力下的摩尔体积：$\\bar{V}(T,P^{\\ominus}) = 52.0\\ \\mathrm{cm^{3}\\ mol^{-1}}$，\n- 等温压缩系数：$\\kappa_{T} = 1.20 \\times 10^{-10}\\ \\mathrm{Pa^{-1}}$，\n- 最终压力：$P = 600\\ \\mathrm{bar}$，\n- 参考压力：$P^{\\ominus} = 1.00\\ \\mathrm{bar}$，\n- 普适气体常数：$R = 8.314462618\\ \\mathrm{J\\ mol^{-1}\\ K^{-1}}$。\n\n将最终答案表示为 $a_{S}$ 的无量纲数，并四舍五入到三位有效数字。", "solution": "活度 $a_{S}(T,P)$ 由化学势 $\\mu_{S}(T,P)$ 的关系式定义：\n$$ \\mu_{S}(T,P) - \\mu_{S}^{\\ominus}(T,P^{\\ominus}) = RT \\ln a_{S}(T,P) $$\n其中 $\\mu_{S}^{\\ominus}(T,P^{\\ominus})$ 是在参考压力 $P^{\\ominus}$ 下定义的标准态化学势。温度 $T$ 是恒定的。\n\n在恒定温度下，化学势随压力的变化由基本关系式给出：\n$$ \\left(\\frac{\\partial \\mu_{S}}{\\partial P}\\right)_{T} = \\bar{V} $$\n其中 $\\bar{V}$ 是固体的摩尔体积。为了求得差值 $\\mu_{S}(T,P) - \\mu_{S}^{\\ominus}(T,P^{\\ominus})$，我们必须将此表达式从参考压力 $P^{\\ominus}$ 积分到最终压力 $P$。准确地说，我们对一个虚拟压力变量 $P'$ 在区间 $[P^{\\ominus}, P]$ 上进行积分。\n$$ \\mu_{S}(T,P) - \\mu_{S}^{\\ominus}(T,P^{\\ominus}) = \\int_{P^{\\ominus}}^{P} \\bar{V}(T,P') \\,dP' $$\n因此，\n$$ RT \\ln a_{S}(T,P) = \\int_{P^{\\ominus}}^{P} \\bar{V}(T,P') \\,dP' $$\n题目说明，等温压缩系数 $\\kappa_{T}$ 在所研究的压力范围内是常数。$\\kappa_{T}$ 的定义是：\n$$ \\kappa_{T} = -\\frac{1}{\\bar{V}} \\left(\\frac{\\partial \\bar{V}}{\\partial P}\\right)_{T} $$\n为了确定摩尔体积 $\\bar{V}(P')$ 对压力的依赖关系，我们重排并积分这个微分方程。同样，我们从压力为 $P^{\\ominus}$ 的参考态（此时摩尔体积为 $\\bar{V}(T,P^{\\ominus})$）积分到一个任意压力为 $P'$ 的状态（此时摩尔体积为 $\\bar{V}(T,P')$）。\n$$ \\frac{d\\bar{V}}{\\bar{V}} = -\\kappa_{T} dP $$\n$$ \\int_{\\bar{V}(T,P^{\\ominus})}^{\\bar{V}(T,P')} \\frac{d\\bar{V}}{\\bar{V}} = -\\int_{P^{\\ominus}}^{P'} \\kappa_{T} \\,dP'' $$\n由于假设 $\\kappa_{T}$ 与压力无关，因此可以将其从积分中提出：\n$$ \\ln\\left(\\frac{\\bar{V}(T,P')}{\\bar{V}(T,P^{\\ominus})}\\right) = -\\kappa_{T} (P' - P^{\\ominus}) $$\n解出 $\\bar{V}(T,P')$ 得：\n$$ \\bar{V}(T,P') = \\bar{V}(T,P^{\\ominus}) \\exp[-\\kappa_{T}(P' - P^{\\ominus})] $$\n现在，将此摩尔体积的表达式代回到化学势差的积分中。为简洁起见，我们将 $\\bar{V}(T,P^{\\ominus})$ 记为 $\\bar{V}^{\\ominus}$。\n$$ RT \\ln a_{S}(T,P) = \\int_{P^{\\ominus}}^{P} \\bar{V}^{\\ominus} \\exp[-\\kappa_{T}(P' - P^{\\ominus})] \\,dP' $$\n项 $\\bar{V}^{\\ominus}$ 相对于积分变量 $P'$ 是一个常数。我们进行积分：\n$$ \\int_{P^{\\ominus}}^{P} \\exp[-\\kappa_{T}(P' - P^{\\ominus})] \\,dP' = \\left[ -\\frac{1}{\\kappa_{T}} \\exp[-\\kappa_{T}(P' - P^{\\ominus})] \\right]_{P' = P^{\\ominus}}^{P' = P} $$\n$$ = -\\frac{1}{\\kappa_{T}} \\left( \\exp[-\\kappa_{T}(P - P^{\\ominus})] - \\exp[-\\kappa_{T}(P^{\\ominus} - P^{\\ominus})] \\right) $$\n$$ = -\\frac{1}{\\kappa_{T}} \\left( \\exp[-\\kappa_{T}(P - P^{\\ominus})] - 1 \\right) = \\frac{1}{\\kappa_{T}} \\left( 1 - \\exp[-\\kappa_{T}(P - P^{\\ominus})] \\right) $$\n将此结果代回，我们得到：\n$$ RT \\ln a_{S}(T,P) = \\frac{\\bar{V}^{\\ominus}}{\\kappa_{T}} \\left( 1 - \\exp[-\\kappa_{T}(P - P^{\\ominus})] \\right) $$\n解出活度 $a_{S}(T,P)$，得到最终的解析表达式：\n$$ a_{S}(T,P) = \\exp\\left[ \\frac{\\bar{V}^{\\ominus}}{RT\\kappa_{T}} \\left( 1 - \\exp[-\\kappa_{T}(P - P^{\\ominus})] \\right) \\right] $$\n推导至此完成。\n\n对于数值计算，我们有以下给定数据：\n$T = 350\\ \\mathrm{K}$\n$\\bar{V}^{\\ominus} = 52.0\\ \\mathrm{cm^{3}\\ mol^{-1}}$\n$\\kappa_{T} = 1.20 \\times 10^{-10}\\ \\mathrm{Pa^{-1}}$\n$P = 600\\ \\mathrm{bar}$\n$P^{\\ominus} = 1.00\\ \\mathrm{bar}$\n$R = 8.314462618\\ \\mathrm{J\\ mol^{-1}\\ K^{-1}}$\n\n为保持一致性，所有量都必须转换为国际单位制（SI）基本单位。\n$\\bar{V}^{\\ominus} = 52.0\\ \\mathrm{cm^{3}\\ mol^{-1}} = 52.0 \\times (10^{-2}\\ \\mathrm{m})^{3}\\ \\mathrm{mol^{-1}} = 5.20 \\times 10^{-5}\\ \\mathrm{m^{3}\\ mol^{-1}}$\n$P = 600\\ \\mathrm{bar} = 600 \\times 10^{5}\\ \\mathrm{Pa} = 6.00 \\times 10^{7}\\ \\mathrm{Pa}$\n$P^{\\ominus} = 1.00\\ \\mathrm{bar} = 1.00 \\times 10^{5}\\ \\mathrm{Pa}$\n压力差为 $P - P^{\\ominus} = (600 - 1) \\times 10^{5}\\ \\mathrm{Pa} = 599 \\times 10^{5}\\ \\mathrm{Pa} = 5.99 \\times 10^{7}\\ \\mathrm{Pa}$。\n\n我们首先计算内部指数函数的参数：\n$$ -\\kappa_{T}(P - P^{\\ominus}) = -(1.20 \\times 10^{-10}\\ \\mathrm{Pa^{-1}}) \\times (5.99 \\times 10^{7}\\ \\mathrm{Pa}) = -7.188 \\times 10^{-3} $$\n正如预期的那样，这是一个无量纲的量。\n\n接下来，我们计算主表达式中括号内的项：\n$$ 1 - \\exp[-\\kappa_{T}(P - P^{\\ominus})] = 1 - \\exp(-7.188 \\times 10^{-3}) = 1 - 0.9928354... = 7.16457... \\times 10^{-3} $$\n现在我们计算前置因子 $\\frac{\\bar{V}^{\\ominus}}{RT\\kappa_{T}}$。此项的单位是 $(\\mathrm{m^{3}\\ mol^{-1}}) / ((\\mathrm{J\\ mol^{-1}\\ K^{-1}}) \\times \\mathrm{K} \\times \\mathrm{Pa^{-1}})$。由于 $1\\ \\mathrm{J} = 1\\ \\mathrm{Pa \\cdot m^{3}}$，单位简化为 $(\\mathrm{m^{3}\\ mol^{-1}}) / (\\mathrm{m^{3}\\ mol^{-1}})$，是无量纲的。\n$$ \\frac{\\bar{V}^{\\ominus}}{RT\\kappa_{T}} = \\frac{5.20 \\times 10^{-5}\\ \\mathrm{m^{3}\\ mol^{-1}}}{(8.31446...\\ \\mathrm{J\\ mol^{-1}\\ K^{-1}}) \\times (350\\ \\mathrm{K}) \\times (1.20 \\times 10^{-10}\\ \\mathrm{Pa^{-1}})} $$\n$$ \\frac{\\bar{V}^{\\ominus}}{RT\\kappa_{T}} = \\frac{5.20 \\times 10^{-5}}{2910.06... \\times 1.20 \\times 10^{-10}} = \\frac{5.20 \\times 10^{-5}}{3.49207...\\times 10^{-7}} = 148.908... $$\n外部指数的完整参数是这两个结果的乘积：\n$$ \\mathrm{Exponent} = (148.908...) \\times (7.16457... \\times 10^{-3}) = 1.06689... $$\n最后，活度 $a_{S}$ 是该值的指数：\n$$ a_{S} = \\exp(1.06689...) = 2.90647... $$\n根据题目要求，四舍五入到三位有效数字，我们得到最终的数值答案。\n$$ a_{S} \\approx 2.91 $$\n这个值大于1，正确地表明由于压力从 $1\\ \\mathrm{bar}$ 显著增加到 $600\\ \\mathrm{bar}$，固体的化学势增加了。", "answer": "$$\n\\boxed{2.91}\n$$", "id": "2642548"}]}