{"hands_on_practices": [{"introduction": "表面张力驱使液体系统趋向于最小化其表面积以降低能量，这一基本原理引发了许多有趣的现象。本练习探讨了这一原理的一个经典结果：Plateau-Rayleigh 不稳定性，即液体射流自发地破裂成液滴的过程。通过分析表面微小扰动如何影响总表面能，您将推导出稳定与不稳定之间的临界条件，这对于理解从喷墨打印到乳液形成等多种技术至关重要。[@problem_id:2007082]", "problem": "在喷墨打印等技术中，液滴的形成是通过精确控制细液流的破裂来实现的。这一现象可以通过Plateau-Rayleigh不稳定性来理解，该不稳定性描述了圆柱形流体柱如何由于表面张力而变得不稳定。\n\n考虑一个理想化的、无限长的圆柱形射流，它由无粘性、不可压缩的液体组成，初始半径均匀为 $R_0$，表面张力为常数 $\\gamma$。该射流处于真空中。然后，该射流的半径沿其长度方向受到一个微小的、轴对称的正弦扰动。由于给定射流段的体积守恒这一物理约束，可以从数学上证明，相对于初始未受扰动的圆柱体，长度为 $L$（其中 $L$ 是扰动波长的整数倍）的一段射流的总表面积变化量 $\\Delta S$ 由以下表达式给出：\n$$\n\\Delta S = \\frac{\\pi L \\epsilon^2}{2R_0} (k^2 R_0^2 - 1)\n$$\n此处，$\\epsilon$ 是扰动的小振幅（$\\epsilon \\ll R_0$），$k$ 是正弦扰动的波数。\n\n射流的稳定性由其表面能 $E_S = \\gamma S$ 的变化决定。如果一个扰动导致系统总表面能的净减少，那么它就被认为是不稳定的，并将自发增长。这种自发增长最终导致射流破裂成液滴。\n\n利用所提供的信息，确定临界波长 $\\lambda_c$，它标志着稳定扰动和不稳定扰动之间的边界。任何波长 $\\lambda > \\lambda_c$ 的扰动都将是不稳定的。波数与波长的关系为 $k=2\\pi/\\lambda$。请将 $\\lambda_c$ 的最终答案表示为 $R_0$ 的函数。", "solution": "对于长度为 $L$（扰动波长的整数倍）的一段射流，其表面积的变化量由下式给出\n$$\n\\Delta S = \\frac{\\pi L \\epsilon^{2}}{2 R_{0}} \\left(k^{2} R_{0}^{2} - 1\\right).\n$$\n表面能为 $E_{S} = \\gamma S$，因此由扰动引起的表面能变化为\n$$\n\\Delta E_{S} = \\gamma \\Delta S = \\gamma \\frac{\\pi L \\epsilon^{2}}{2 R_{0}} \\left(k^{2} R_{0}^{2} - 1\\right).\n$$\n由于 $\\gamma>0$，$\\Delta E_{S}$ 的符号由因子 $\\left(k^{2} R_{0}^{2} - 1\\right)$ 决定。如果一个扰动使表面能减小，即 $\\Delta E_{S}<0$，则该扰动是不稳定的，这要求\n$$\nk^{2} R_{0}^{2} - 1 < 0 \\quad \\Longrightarrow \\quad k R_{0} < 1.\n$$\n将表面能变化量设为零，可得到区分稳定与不稳定的临界条件：\n$$\nk_{c}^{2} R_{0}^{2} - 1 = 0 \\quad \\Longrightarrow \\quad k_{c} = \\frac{1}{R_{0}}.\n$$\n使用波数和波长之间的关系 $k = \\frac{2\\pi}{\\lambda}$，临界波长为\n$$\n\\lambda_{c} = \\frac{2\\pi}{k_{c}} = 2\\pi R_{0}.\n$$\n因此，波长 $\\lambda > \\lambda_{c}$ 的扰动是不稳定的，并且临界波长是初始半径的线性函数。", "answer": "$$\\boxed{2\\pi R_{0}}$$", "id": "2007082"}, {"introduction": "在能量最小化原理的基础上，我们可以通过设计表面微结构来精确控制润湿行为，从而创造出超疏水等功能材料。此问题挑战您分析一个液滴在规则纹理表面上的热力学稳定性，即比较其处于完全浸润的 Wenzel 状态和悬浮的 Cassie-Baxter 状态时的吉布斯自由能。确定这两种状态之间的转变条件，是理解和设计先进界面材料的核心。[@problem_id:1893642]", "problem": "一滴液体被放置在一个设计用于展现超疏水特性的固体表面上。该表面由规则的方形微柱阵列构成。每根微柱具有方形横截面，边长为 $L$，高度均匀为 $H$。这些微柱排列成一个方形晶格，中心间距为 $D$，其中 $D > L$。该平坦固体材料的固有润湿行为由 Young 氏接触角 $\\theta_Y$ 描述，它通过 Young 氏方程 $\\gamma_{LV} \\cos\\theta_Y = \\gamma_{SV} - \\gamma_{SL}$ 将固-液（$\\gamma_{SL}$）、固-气（$\\gamma_{SV}$）和液-气（$\\gamma_{LV}$）界面的界面张力联系起来。\n\n在这种织构化表面上，液体可以以两种不同状态之一存在：\n1.  **Wenzel 状态**：液体完全润湿表面形貌，填充了微柱之间的凹槽。固-液界面包括柱顶、侧壁和基底。\n2.  **Cassie-Baxter 状态**：液体悬浮在微柱顶部，将蒸气（或空气）捕获在下方的空腔中。液滴底部形成一个复合界面，在柱顶上是固-液界面，在间隙上方是液-气界面。\n\n热力学稳定状态是使总界面吉布斯自由能最小化的状态。这两种状态之间的转变定义为发生在一个临界固有接触角 $\\theta_C$ 处，此时 Wenzel 状态和 Cassie-Baxter 状态的吉布斯自由能相等。\n\n你的任务是推导出对应于此热力学转变点的 $\\cos\\theta_C$ 的符号表达式。请用几何参数 $L$、 $H$ 和 $D$ 来表示你的答案。", "solution": "我们比较 Wenzel 状态和 Cassie-Baxter 状态下，每个织构单元晶胞的界面吉布斯自由能。考虑一个边长为 $D$ 的方形单元晶胞，其中包含一个边长为 $L$、高度为 $H$ 的方形微柱。\n\n一个晶胞内的几何面积：\n- 柱顶面积：$A_{\\text{top}} = L^{2}$。\n- 柱侧壁面积：$A_{\\text{side}} = 4 L H$。\n- 微柱间的基底面积：$A_{\\text{base}} = D^{2} - L^{2}$。\n- 晶胞内实际的粗糙固体面积：$A_{r} = A_{\\text{top}} + A_{\\text{side}} + A_{\\text{base}} = D^{2} + 4 L H$。\n- 间隙的投影面积：$A_{\\text{gap}} = D^{2} - L^{2}$。\n\n我们计算接触区域内相对于初始干燥织构表面（晶胞内处处为固-气界面）的界面能变化。对于给定的基底面积，液滴的宏观液-气表面对于两种状态是共同的，在比较两种状态时会相互抵消；因此，我们只计算接触区域下方的界面变化。\n\nWenzel 状态：液体完全润湿了基面下方的织构。所有粗糙固体区域都从固-气界面转变为固-液界面，且基面下方没有新的液-气界面产生。每个晶胞的能量变化为\n$$\nE_{W} = (\\gamma_{SL} - \\gamma_{SV}) A_{r} = (\\gamma_{SL} - \\gamma_{SV}) \\left(D^{2} + 4 L H\\right).\n$$\n\nCassie-Baxter 状态：只有柱顶被润湿；侧壁和基底保持为固-气界面。此外，一个液-气界面跨越了液滴下方的间隙。每个晶胞的能量变化为\n$$\nE_{C} = (\\gamma_{SL} - \\gamma_{SV}) A_{\\text{top}} + \\gamma_{LV} A_{\\text{gap}} = (\\gamma_{SL} - \\gamma_{SV}) L^{2} + \\gamma_{LV} \\left(D^{2} - L^{2}\\right).\n$$\n\n在热力学转变点，$E_{W} = E_{C}$。使用 Young 氏方程 $\\gamma_{LV} \\cos \\theta_{Y} = \\gamma_{SV} - \\gamma_{SL}$，即 $\\gamma_{SL} - \\gamma_{SV} = - \\gamma_{LV} \\cos \\theta_{Y}$，并用 $\\theta_C$ 表示临界固有角，我们设\n$$\n(\\gamma_{SL} - \\gamma_{SV}) \\left(D^{2} + 4 L H\\right) = (\\gamma_{SL} - \\gamma_{SV}) L^{2} + \\gamma_{LV} \\left(D^{2} - L^{2}\\right),\n$$\n可简化为\n$$\n(\\gamma_{SL} - \\gamma_{SV}) \\left(D^{2} - L^{2} + 4 L H\\right) = \\gamma_{LV} \\left(D^{2} - L^{2}\\right).\n$$\n代入 $\\gamma_{SL} - \\gamma_{SV} = - \\gamma_{LV} \\cos \\theta_{C}$ 得到\n$$\n- \\gamma_{LV} \\cos \\theta_{C} \\left(D^{2} - L^{2} + 4 L H\\right) = \\gamma_{LV} \\left(D^{2} - L^{2}\\right).\n$$\n消去 $\\gamma_{LV}$ 并求解 $\\cos \\theta_{C}$ 得\n$$\n\\cos \\theta_{C} = - \\frac{D^{2} - L^{2}}{D^{2} - L^{2} + 4 L H}.\n$$\n该表达式仅依赖于几何参数 $L$、 $H$ 和 $D$，符合要求。它也可以写成熟悉的形式 $\\cos \\theta_{C} = - (1 - f)/(r - f)$，其中 $f = L^{2}/D^{2}$ 且 $r = 1 + 4 L H / D^{2}$，但题目所要求的用 $L$、 $H$ 和 $D$ 表示的形式已如上所示。", "answer": "$$\\boxed{-\\frac{D^{2} - L^{2}}{D^{2} - L^{2} + 4 L H}}$$", "id": "1893642"}, {"introduction": "当系统变得复杂，纯粹的解析模型不再适用时，分子模拟成为研究界面现象的强大工具。本项高级练习将引导您从理论转向计算实践，探索两种计算表面张力的基本方法：基于压力张量各向异性的力学路径和基于虚功原理的热力学测试面积路径。这项实践将让您亲身体验如何将第一性原理的定义转化为可在现代模拟研究中应用的具体算法。[@problem_id:2670014]", "problem": "在一个具有平面气液界面的板层几何结构中，对一种单组分流体进行模拟，模拟沿界面法线方向施加了周期性边界条件。目标是利用两种源于第一性原理且基于模拟的独特路径来计算表面张力：通过压力张量各向异性的力学路径，以及通过虚拟面积微扰的热力学测试面积路径。\n\n从基本定义出发：\n\n- 表面自由能（表面张力）定义为在温度、粒子数和体积固定的条件下，亥姆霍兹自由能对界面面积的导数，即 $ \\gamma = \\left(\\partial F / \\partial A\\right)_{T,N,V} $。\n- 对于平面界面，微观Irving–Kirkwood (IK)应力理论将表面张力与跨界面的应力各向异性积分关联起来。在一个包含两个相同界面的周期性板层中，需要仔细考虑界面的多重性。\n- 对于测试面积方法，在体积固定的情况下，小的虚拟面积变化会导致位形能的改变，该改变可通过自由能的二阶累积量展开与表面张力关联起来。\n\n你的任务是基于上述原理实现这两条路径，不使用任何无法从这些原理推导出的简化公式，并汇总下列测试组的数值结果。所有计算必须与所述的物理单位保持一致，最终结果必须以毫牛顿每米 (mN/m) 表示，并四舍五入到六位小数。\n\n力学路径测试用例（具有两个界面的平面板层，沿 $z$ 轴周期性）：\n\n- 用例 M1（理想情况，局域化界面区域）：系统盒子长度 $L_z = 10.0$ nm，并以 $\\Delta z = 0.001$ nm 的间距均匀离散化。局域压力张量的法向和切向分量由于界面的存在而沿 $z$ 轴变化，它们由各向同性的背景压力 $P_0 = 30.0$ MPa 和一个由两个高斯峰组成的各向异性场构建。这两个高斯峰中心位于 $\\pm z_0$，其中 $z_0 = 2.0$ nm，标准差 $\\sigma = 0.1$ nm，峰值振幅 $A = 50.0$ MPa。具体而言，在每个网格点 $z$，将各向异性 $\\Delta P(z)$ 构建为中心在 $\\pm z_0$、振幅为 $A$、宽度为 $\\sigma$ 的两个高斯函数的和，然后定义 $P_N(z) = P_0 + \\frac{1}{2} \\Delta P(z)$ 和 $P_T(z) = P_0 - \\frac{1}{2} \\Delta P(z)$。使用适用于具有两个界面的周期性板层的力学路径计算表面张力。答案以 mN/m 表示。\n- 用例 M2（边缘情况，均匀流体）：与用例 M1 相同，只是各向异性振幅 $A = 0.0$ MPa。这对应于没有界面的情况，应在数值精度范围内返回零表面张力。答案以 mN/m 表示。\n\n热力学测试面积测试用例（对具有两个界面的板层在恒定体积下进行虚拟微扰）：\n\n- 用例 TA（热力学路径，二阶累积量）：考虑一组 $n = 5$ 个独立的、小的、虚拟的面积增加形变，其量值为 $\\Delta A = 1.0$ nm$^2$，应用于温度为 $T = 300.0$ K 的系统。对于每次形变 $i \\in \\{1,\\dots,5\\}$，设位形能的瞬时变化为 $\\Delta U_i$。通过定义一个基线能量 $U_0 = 1.46 \\times 10^{-19}$ J 和一个标度 $s$ 来构建一个人工的、热力学上一致的数据集，该标度 $s$ 的选择使得累积量校正具有指定的量值 $C = 2.0 \\times 10^{-21}$ J。具体地，使用 $k_B = 1.380\\,649 \\times 10^{-23}$ J/K，设 $\\beta = 1/(k_B T)$，令 $s = \\sqrt{C/\\beta}$，并定义五个能量变化为 $\\Delta U_i \\in \\{U_0 - 2s,\\; U_0 - s,\\; U_0,\\; U_0 + s,\\; U_0 + 2s\\}$。使用适用于恒定体积下小微扰的自由能变化的二阶累积量展开，并在将自由能变化与表面张力关联时考虑板层中存在两个界面。在计算表面张力之前将所有面积单位转换为平方米。答案以 mN/m 表示。\n\n物理和数值单位：\n\n- 沿 $z$ 轴的长度单位为纳米 (nm)；压力单位为兆帕 (MPa)；能量单位为焦耳 (J)；温度单位为开尔文 (K)；面积单位为平方纳米 (nm$^2$)。\n- 对于力学路径，请注意，将单位为 MPa 的压力对单位为 nm 的长度进行积分，所得单位为 MPa·nm，这等于 mN/m，因为 $1$ MPa $\\times 1$ nm $= 10^{6}$ Pa $\\times 10^{-9}$ m $= 10^{-3}$ N/m $= 1$ mN/m。\n- 对于测试面积路径，使用 $1$ nm$^2 = 10^{-18}$ m$^2$ 将 $\\Delta A$ 从 nm$^2$ 转换为 m$^2$。\n\n最终输出格式：\n\n- 您的程序应生成单行输出，其中包含三个用例 [M1, M2, TA] 的结果（按此顺序），形式为用方括号括起来的逗号分隔列表，例如，“[$\\gamma_{\\mathrm{M1}}$, $\\gamma_{\\mathrm{M2}}$, $\\gamma_{\\mathrm{TA}}$]”。每个条目必须是单位为 mN/m 的浮点数，四舍五入到六位小数，且不含任何附加文本。\n\n待实现的测试组摘要：\n\n- 用例 M1：$L_z = 10.0$ nm, $\\Delta z = 0.001$ nm, $P_0 = 30.0$ MPa, $A = 50.0$ MPa, $\\sigma = 0.1$ nm, $z_0 = 2.0$ nm。\n- 用例 M2：$L_z = 10.0$ nm, $\\Delta z = 0.001$ nm, $P_0 = 30.0$ MPa, $A = 0.0$ MPa, $\\sigma = 0.1$ nm, $z_0 = 2.0$ nm。\n- 用例 TA：$T = 300.0$ K, $k_B = 1.380\\,649 \\times 10^{-23}$ J/K, $\\Delta A = 1.0$ nm$^2$, $U_0 = 1.46 \\times 10^{-19}$ J, $C = 2.0 \\times 10^{-21}$ J, $n = 5$ 个能量变化如上所述。\n\n您的解决方案应从上述基本原理出发，以证明所用计算程序的合理性，然后忠实地实现它们，以生成所要求的结果。", "solution": "该问题要求使用两种不同的第一性原理方法——基于压力张量的力学路径和热力学测试面积路径——来计算具有平面界面的单组分流体的表面张力 $\\gamma$。该问题提法恰当，有科学依据，并为获得唯一解提供了足够的信息。我们将依次对每种方法进行分析。\n\n首先，我们分析力学路径。平面界面的表面张力通过压力张量的积分各向异性进行力学定义。对于垂直于 $z$ 轴的单个界面，从Irving-Kirkwood应力理论推导出的基本公式为：\n$$\n\\gamma = \\int_{-\\infty}^{\\infty} [P_N(z) - P_T(z)] dz\n$$\n其中 $P_N(z)$ 是压力张量的法向分量（沿 $z$ 轴），$P_T(z)$ 是切向分量（在 $xy$ 平面内），两者都是跨界面位置 $z$ 的函数。\n\n问题描述了一个在长度为 $L_z$ 的区域上沿 $z$ 方向具有周期性边界条件的板层几何结构。该系统包含两个相同的、对称的气液界面。在整个模拟盒子中对压力各向异性的积分捕捉了两个界面的贡献。由于 $\\gamma$ 是单个界面的内禀属性，我们必须将积分总值除以界面的数量，即 $2$。\n$$\n\\gamma = \\frac{1}{2} \\int_{-L_z/2}^{L_z/2} [P_N(z) - P_T(z)] dz\n$$\n问题提供了基于各向同性背景压力 $P_0$ 和各向异性场 $\\Delta P(z)$ 的压力分量的本构关系：$P_N(z) = P_0 + \\frac{1}{2} \\Delta P(z)$ 和 $P_T(z) = P_0 - \\frac{1}{2} \\Delta P(z)$。由此，压力各向异性即为 $P_N(z) - P_T(z) = \\Delta P(z)$。各向异性场 $\\Delta P(z)$ 被建模为两个高斯函数的和，每个函数代表一个界面：\n$$\n\\Delta P(z) = A \\left[ \\exp\\left(-\\frac{(z-z_0)^2}{2\\sigma^2}\\right) + \\exp\\left(-\\frac{(z+z_0)^2}{2\\sigma^2}\\right) \\right]\n$$\n其中 $A$ 是振幅，$\\sigma$ 是标准差（宽度），$\\pm z_0$ 是两个界面的位置。表面张力的表达式变为：\n$$\n\\gamma = \\frac{A}{2} \\int_{-L_z/2}^{L_z/2} \\left[ \\exp\\left(-\\frac{(z-z_0)^2}{2\\sigma^2}\\right) + \\exp\\left(-\\frac{(z+z_0)^2}{2\\sigma^2}\\right) \\right] dz\n$$\n给定离散化步长 $\\Delta z$，该积分必须进行数值计算。梯形法则是完成此任务的合适且准确的方法。物理单位是一致的：将压力（单位 MPa）对长度（单位 nm）积分，得到的结果单位为 MPa·nm，这等同于所要求的 mN/m。\n\n对于用例 M1，参数为 $L_z = 10.0$ nm, $\\Delta z = 0.001$ nm, $A = 50.0$ MPa, $\\sigma = 0.1$ nm, and $z_0 = 2.0$ nm。将定义的 $\\Delta P(z)$ 在 $[-5.0, 5.0]$ nm 范围内进行数值积分并除以 2，将得到表面张力 $\\gamma_{\\mathrm{M1}}$。\n\n对于用例 M2，设置完全相同，只是振幅 $A = 0.0$ MPa。这对应于没有压力各向异性的均匀流体（对所有 $z$ 均有 $\\Delta P(z) = 0$）。因此，积分为零，表面张力 $\\gamma_{\\mathrm{M2}}$ 必须为 $0.0$。这是一个关键的合理性检查。\n\n接下来，我们分析热力学测试面积路径。表面张力的热力学定义为在恒定温度 $T$ 、粒子数 $N$ 和体积 $V$下，亥姆霍兹自由能 $F$ 对界面面积 $A_{int}$ 的导数：\n$$\n\\gamma = \\left(\\frac{\\partial F}{\\partial A_{int}}\\right)_{T,N,V}\n$$\n对于一个小的、有限的面积微扰，这可以近似为 $\\gamma \\approx \\Delta F / \\Delta A_{int}$。由于一个改变系统位形能 $\\Delta U$ 的微扰所引起的亥姆霍兹自由能变化 $\\Delta F$ 由自由能微扰公式给出：\n$$\n\\Delta F = -k_B T \\ln \\langle e^{-\\beta \\Delta U} \\rangle\n$$\n其中 $\\beta = 1/(k_B T)$，尖括号表示系综平均。对于小微扰，我们可以使用二阶累积量展开：\n$$\n\\Delta F \\approx \\langle \\Delta U \\rangle - \\frac{\\beta}{2} \\left( \\langle (\\Delta U)^2 \\rangle - \\langle \\Delta U \\rangle^2 \\right) = \\langle \\Delta U \\rangle - \\frac{\\beta}{2} \\text{Var}(\\Delta U)\n$$\n问题陈述提供了一个包含 $n=5$ 个能量变化 $\\Delta U_i$ 的人工数据集，以及二阶累积量校正的指定值 $C = 2.0 \\times 10^{-21}$ J。因此，自由能变化为 $\\Delta F = \\langle \\Delta U \\rangle - C$。平均能量变化 $\\langle \\Delta U \\rangle$ 从所提供的数据集计算得出。问题指定的 $\\Delta U_i$ 值为 $\\{U_0 - 2s, U_0 - s, U_0, U_0 + s, U_0 + 2s\\}$，由此可以清楚地看出平均值为 $\\langle \\Delta U \\rangle = U_0 = 1.46 \\times 10^{-19}$ J。\n\n$\\Delta F$ 和 $\\gamma$ 之间的关系必须考虑板层中的两个界面。微扰是应用于模拟盒子横截面的一个量值为 $\\Delta A = 1.0$ nm$^2$ 的面积变化。这会同时改变两个界面的面积。因此，界面总面积的变化为 $\\Delta A_{int} = 2\\Delta A$。表面张力则为：\n$$\n\\gamma = \\frac{\\Delta F}{\\Delta A_{int}} = \\frac{\\langle \\Delta U \\rangle - C}{2\\Delta A}\n$$\n对于用例 TA，给定 $U_0 = 1.46 \\times 10^{-19}$ J, $C = 2.0 \\times 10^{-21}$ J, 以及 $\\Delta A = 1.0$ nm$^2$。我们必须使用一致的国际单位制单位（SI units）进行计算。面积 $\\Delta A$ 必须使用换算关系 $1$ nm$^2 = 10^{-18}$ m$^2$ 从 nm$^2$ 转换为 m$^2$。得到的 $\\gamma$ 单位将是 J/m$^2$，这等同于 N/m。最后，这个结果必须通过乘以 $1000$ 转换为 mN/m。\n\n实施过程将首先基于这些推导出的公式为每个用例定义函数。力学路径用例的数值积分将使用梯形法执行。热力学路径的计算是一个代数求值。所有结果将按要求四舍五入到六位小数。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main solver function to compute surface tension for all test cases.\n    \"\"\"\n\n    def solve_mechanical_route(Lz, dz, P0, A, sigma, z0):\n        \"\"\"\n        Calculates surface tension via the mechanical route (pressure tensor).\n        \n        Args:\n            Lz (float): Box length in z-direction (nm).\n            dz (float): Discretization spacing (nm).\n            P0 (float): Isotropic background pressure (MPa).\n            A (float): Anisotropy peak amplitude (MPa).\n            sigma (float): Standard deviation of Gaussian peaks (nm).\n            z0 (float): Position of Gaussian peaks (nm).\n            \n        Returns:\n            float: Surface tension in mN/m.\n        \"\"\"\n        # Create the discretized z-axis for the periodic box\n        z_points = np.arange(-Lz / 2.0, Lz / 2.0 + dz, dz)\n\n        # Calculate the pressure anisotropy profile delta_P(z) = P_N(z) - P_T(z)\n        gaussian1 = A * np.exp(-(z_points - z0)**2 / (2.0 * sigma**2))\n        gaussian2 = A * np.exp(-(z_points + z0)**2 / (2.0 * sigma**2))\n        delta_P = gaussian1 + gaussian2\n        \n        # Numerically integrate delta_P(z) over the box length using the trapezoidal rule.\n        # np.trapz(y, x) computes the integral of y wrt x.\n        integral = np.trapz(delta_P, z_points)\n\n        # For a system with two interfaces, the surface tension gamma of a single\n        # interface is half the total integral. The units are MPa*nm, which\n        # is equivalent to mN/m.\n        gamma = 0.5 * integral\n        \n        return gamma\n\n    def solve_thermodynamic_route(T, kB, delta_A_nm2, U0, C):\n        \"\"\"\n        Calculates surface tension via the thermodynamic test-area route.\n\n        Args:\n            T (float): Temperature (K).\n            kB (float): Boltzmann constant (J/K).\n            delta_A_nm2 (float): Area perturbation (nm^2).\n            U0 (float): Baseline average energy change (J).\n            C (float): Second-order cumulant correction (J).\n\n        Returns:\n            float: Surface tension in mN/m.\n        \"\"\"\n        # The average energy change <Delta U> is given as U0.\n        avg_delta_U = U0\n        \n        # The Helmholtz free energy change is given by the second-order expansion.\n        # Delta F = <Delta U> - C\n        delta_F = avg_delta_U - C\n\n        # Convert area perturbation from nm^2 to m^2.\n        # 1 nm^2 = 1e-18 m^2\n        delta_A_m2 = delta_A_nm2 * 1e-18\n\n        # The system has two interfaces, so the total change in interfacial area is 2 * delta_A.\n        total_delta_A = 2.0 * delta_A_m2\n\n        # Surface tension gamma = Delta F / (total area change)\n        # The resulting unit is J/m^2, which is equivalent to N/m.\n        gamma_in_Nm = delta_F / total_delta_A\n\n        # Convert from N/m to mN/m by multiplying by 1000.\n        gamma_in_mNm = gamma_in_Nm * 1000.0\n        \n        return gamma_in_mNm\n\n    # Define the test cases from the problem statement.\n    test_cases = {\n        'M1': {\n            'Lz': 10.0, 'dz': 0.001, 'P0': 30.0, 'A': 50.0, \n            'sigma': 0.1, 'z0': 2.0\n        },\n        'M2': {\n            'Lz': 10.0, 'dz': 0.001, 'P0': 30.0, 'A': 0.0, \n            'sigma': 0.1, 'z0': 2.0\n        },\n        'TA': {\n            'T': 300.0, 'kB': 1.380649e-23, 'delta_A_nm2': 1.0,\n            'U0': 1.46e-19, 'C': 2.0e-21\n        }\n    }\n    \n    # Calculate results for each case\n    gamma_m1 = solve_mechanical_route(**test_cases['M1'])\n    gamma_m2 = solve_mechanical_route(**test_cases['M2'])\n    gamma_ta = solve_thermodynamic_route(**test_cases['TA'])\n    \n    # Collect and round results to six decimal places\n    results = [\n        round(gamma_m1, 6),\n        round(gamma_m2, 6),\n        round(gamma_ta, 6)\n    ]\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2670014"}]}