{"hands_on_practices": [{"introduction": "密度泛函理论的语言是泛函分析。本练习 [@problem_id:2634146] 让你亲自动手计算一个简单泛函的泛函导数，这是从变分原理推导Hohenberg-Kohn定理和Kohn-Sham方程的核心数学技能。通过这个实践，你将不仅学会如何应用定义，还将理解其背后的严格数学假设。", "problem": "在密度泛函理论 (DFT) 中，Hohenberg-Kohn 定理断言基态能量是电子密度的泛函，而 Kohn-Sham (KS) 方程则源于一个涉及对密度求泛函导数的欧拉-拉格朗日平稳性条件。从巴拿赫空间 (Banach space) 上泛函可微性的基本定义和基本变分原理出发，按以下步骤进行。\n\n- 定义泛函 $F$ 在赋范线性空间 $X$ 中的点 $n$ 处，沿方向 $h \\in X$ 的 Gâteaux 导数和 Fréchet 导数。\n- 考虑 $X = L^{2}(\\mathbb{R}^{3})$ 上的泛函\n$$\nF[n] = \\int_{\\mathbb{R}^{3}} w(\\mathbf{r})\\, n^{2}(\\mathbf{r})\\, d\\mathbf{r},\n$$\n其中 $n \\in L^{2}(\\mathbb{R}^{3})$ 是一个实值密度，$w : \\mathbb{R}^{3} \\to \\mathbb{R}$ 是一个给定的权重函数。仅使用这些定义和 $L^{p}$ 空间的基本性质，计算泛函导数 $\\delta F/\\delta n(\\mathbf{r})$，其意义在于 Gâteaux 导数可以表示为对偶配对 $\\langle \\delta F/\\delta n, h \\rangle = \\int_{\\mathbb{R}^{3}} \\left(\\delta F/\\delta n(\\mathbf{r})\\right) h(\\mathbf{r})\\, d\\mathbf{r}$，对所有 $h \\in L^{2}(\\mathbb{R}^{3})$ 成立。陈述在何种关于 $w$ 的最小充分假设下：\n  1. 对于所有 $n \\in L^{2}(\\mathbb{R}^{3})$ 和 $h \\in L^{2}(\\mathbb{R}^{3})$，Gâteaux 导数都存在；\n  2. 在 $L^{2}(\\mathbb{R}^{3})$ 上，Gâteaux 导数与 Fréchet 导数一致；\n  3. 泛函导数 $\\delta F/\\delta n(\\mathbf{r})$ 可由 $L^{2}(\\mathbb{R}^{3})$ 中的一个函数表示。\n- 简要阐述在约束条件 $\\int_{\\mathbb{R}^{3}} n(\\mathbf{r})\\, d\\mathbf{r} = N$ 下，最小化形式为 $E[n] = F[n] + \\int_{\\mathbb{R}^{3}} v_{\\mathrm{ext}}(\\mathbf{r})\\, n(\\mathbf{r})\\, d\\mathbf{r}$ 的能量的欧拉-拉格朗日平稳性条件，并指明拉格朗日乘子 $\\mu$ 的作用。您无需解出 $n$ 或 $\\mu$。\n\n您的最终答案应该是 $\\delta F/\\delta n(\\mathbf{r})$ 的闭式解析表达式。不需要进行数值计算，也不需要单位。最终答案必须是单个表达式，而不是方程或不等式。", "solution": "问题陈述已经过验证，并被认定为有效。它在科学上基于泛函分析及其在密度泛函理论中应用的原理，是适定的，并以客观和精确的语言表述。所有必要信息均已提供。不存在任何矛盾或谬误。我们可以开始求解。\n\n该问题需要在密度泛函理论的背景下对一个泛函进行多步推导和分析。我们将有条不紊地依次处理每个部分。\n\n首先，我们定义所要求的导数。设 $F: X \\to \\mathbb{R}$ 是赋范线性空间 $X$ 上的一个泛函。\n\n$F$ 在点 $n \\in X$ 处沿方向 $h \\in X$ 的 Gâteaux 导数定义为以下极限：\n$$\nDF(n; h) = \\lim_{\\epsilon \\to 0} \\frac{F[n + \\epsilon h] - F[n]}{\\epsilon}\n$$\n前提是该极限存在。这是一种方向导数。\n\n$F$ 在 $n \\in X$ 处的 Fréchet 导数是一个有界线性算子 $A_n: X \\to \\mathbb{R}$，使得：\n$$\n\\lim_{\\|h\\|_{X} \\to 0} \\frac{|F[n+h] - F[n] - A_n(h)|}{\\|h\\|_{X}} = 0\n$$\n如果这样的算子 $A_n$ 存在，则它是唯一的，并记为 $F'(n)$。为使 Fréchet 导数存在，Gâteaux 导数必须对所有方向 $h$ 都存在，并且必须是关于 $h$ 的有界线性算子，即 $DF(n; h) = A_n(h)$。\n\n接下来，我们考虑空间 $X = L^{2}(\\mathbb{R}^{3})$ 上的特定泛函 $F[n] = \\int_{\\mathbb{R}^{3}} w(\\mathbf{r})\\, n^{2}(\\mathbf{r})\\, d\\mathbf{r}$。我们计算其 Gâteaux 导数。\n令 $n, h \\in L^{2}(\\mathbb{R}^{3})$ 且 $\\epsilon \\in \\mathbb{R}$。我们在 $n + \\epsilon h$ 处计算该泛函的值：\n$$\nF[n + \\epsilon h] = \\int_{\\mathbb{R}^{3}} w(\\mathbf{r}) (n(\\mathbf{r}) + \\epsilon h(\\mathbf{r}))^{2} \\, d\\mathbf{r}\n$$\n展开被积函数：\n$$\nw(\\mathbf{r}) (n(\\mathbf{r}) + \\epsilon h(\\mathbf{r}))^{2} = w(\\mathbf{r}) \\left( n^{2}(\\mathbf{r}) + 2\\epsilon n(\\mathbf{r}) h(\\mathbf{r}) + \\epsilon^{2} h^{2}(\\mathbf{r}) \\right)\n$$\n假设每一项的积分都存在，我们可以写出：\n$$\nF[n + \\epsilon h] = \\int_{\\mathbb{R}^{3}} w(\\mathbf{r}) n^{2}(\\mathbf{r}) \\, d\\mathbf{r} + 2\\epsilon \\int_{\\mathbb{R}^{3}} w(\\mathbf{r}) n(\\mathbf{r}) h(\\mathbf{r}) \\, d\\mathbf{r} + \\epsilon^{2} \\int_{\\mathbb{R}^{3}} w(\\mathbf{r}) h^{2}(\\mathbf{r}) \\, d\\mathbf{r}\n$$\n$$\nF[n + \\epsilon h] = F[n] + 2\\epsilon \\int_{\\mathbb{R}^{3}} w(\\mathbf{r}) n(\\mathbf{r}) h(\\mathbf{r}) \\, d\\mathbf{r} + \\epsilon^{2} \\int_{\\mathbb{R}^{3}} w(\\mathbf{r}) h^{2}(\\mathbf{r}) \\, d\\mathbf{r}\n$$\n现在我们构造 Gâteaux 导数的差商：\n$$\n\\frac{F[n + \\epsilon h] - F[n]}{\\epsilon} = 2 \\int_{\\mathbb{R}^{3}} w(\\mathbf{r}) n(\\mathbf{r}) h(\\mathbf{r}) \\, d\\mathbf{r} + \\epsilon \\int_{\\mathbb{R}^{3}} w(\\mathbf{r}) h^{2}(\\mathbf{r}) \\, d\\mathbf{r}\n$$\n取极限 $\\epsilon \\to 0$：\n$$\nDF(n; h) = \\lim_{\\epsilon \\to 0} \\left( 2 \\int_{\\mathbb{R}^{3}} w(\\mathbf{r}) n(\\mathbf{r}) h(\\mathbf{r}) \\, d\\mathbf{r} + \\epsilon \\int_{\\mathbb{R}^{3}} w(\\mathbf{r}) h^{2}(\\mathbf{r}) \\, d\\mathbf{r} \\right) = 2 \\int_{\\mathbb{R}^{3}} w(\\mathbf{r}) n(\\mathbf{r}) h(\\mathbf{r}) \\, d\\mathbf{r}\n$$\n这就是 Gâteaux 导数。问题将泛函导数 $\\frac{\\delta F}{\\delta n(\\mathbf{r})}$ 定义为通过 $L^{2}(\\mathbb{R}^{3})$ 上的内积来表示 Gâteaux 导数的函数：\n$$\nDF(n; h) = \\int_{\\mathbb{R}^{3}} \\frac{\\delta F}{\\delta n(\\mathbf{r})} h(\\mathbf{r}) \\, d\\mathbf{r}\n$$\n通过将此形式与我们的结果进行比较，我们确定泛函导数为：\n$$\n\\frac{\\delta F}{\\delta n(\\mathbf{r})} = 2w(\\mathbf{r})n(\\mathbf{r})\n$$\n现在我们必须确定对权重函数 $w(\\mathbf{r})$ 的最小充分假设。\n1. 为使 Gâteaux 导数对所有 $n, h \\in L^{2}(\\mathbb{R}^{3})$ 都存在，其推导过程中的积分必须是有限的。具体来说，$\\int w(\\mathbf{r}) n(\\mathbf{r}) h(\\mathbf{r}) \\, d\\mathbf{r}$ 和 $\\int w(\\mathbf{r}) h^{2}(\\mathbf{r}) \\, d\\mathbf{r}$ 必须收敛。根据 Cauchy-Schwarz 不等式，两个 $L^{2}$ 函数的乘积属于 $L^{1}$。因此 $n(\\mathbf{r})h(\\mathbf{r}) \\in L^{1}(\\mathbb{R}^{3})$ 且 $h^{2}(\\mathbf{r}) \\in L^{1}(\\mathbb{R}^{3})$。为使包含 $w(\\mathbf{r})$ 的积分对所有 $n, h \\in L^{2}(\\mathbb{R}^{3})$ 的选择都收敛，一个充分必要条件是 $w(\\mathbf{r})$ 是一个本性有界函数，即 $w \\in L^{\\infty}(\\mathbb{R}^{3})$。如果 $w \\in L^{\\infty}(\\mathbb{R}^{3})$，那么 $|\\int wnh \\, d\\mathbf{r}| \\le \\|w\\|_{\\infty} \\int |nh| \\, d\\mathbf{r} \\le \\|w\\|_{\\infty} \\|n\\|_{2} \\|h\\|_{2} < \\infty$。\n\n2. 为使 Gâteaux 导数与 Fréchet 导数一致，我们必须检查极限条件。Gâteaux 导数 $DF(n; h)$ 定义了关于 $h$ 的一个线性算子，我们记为 $A_n(h)$。余项为 $R(h) = F[n+h] - F[n] - A_n(h)$。\n$$\nR(h) = \\int_{\\mathbb{R}^{3}} w(\\mathbf{r})h^{2}(\\mathbf{r}) \\, d\\mathbf{r}\n$$\n我们必须证明 $\\lim_{\\|h\\|_{2} \\to 0} \\frac{|R(h)|}{\\|h\\|_{2}} = 0$。\n如果我们假设 $w \\in L^{\\infty}(\\mathbb{R}^{3})$，那么几乎处处有 $|w(\\mathbf{r})| \\le \\|w\\|_{\\infty}$。\n$$\n|R(h)| = \\left| \\int w(\\mathbf{r}) h^{2}(\\mathbf{r}) \\, d\\mathbf{r} \\right| \\le \\int |w(\\mathbf{r})| h^{2}(\\mathbf{r}) \\, d\\mathbf{r} \\le \\|w\\|_{\\infty} \\int h^{2}(\\mathbf{r}) \\, d\\mathbf{r} = \\|w\\|_{\\infty} \\|h\\|_{2}^{2}\n$$\n因此，该比值是有界的：\n$$\n\\frac{|R(h)|}{\\|h\\|_{2}} \\le \\frac{\\|w\\|_{\\infty} \\|h\\|_{2}^{2}}{\\|h\\|_{2}} = \\|w\\|_{\\infty} \\|h\\|_{2}\n$$\n当 $\\|h\\|_{2} \\to 0$ 时，可得 $\\|w\\|_{\\infty} \\|h\\|_{2} \\to 0$。因此，极限为 $0$，Fréchet 导数存在且等于 Gâteaux 导数。条件 $w \\in L^{\\infty}(\\mathbb{R}^{3})$ 是充分的。\n\n3. 为使泛函导数 $\\frac{\\delta F}{\\delta n(\\mathbf{r})} = 2w(\\mathbf{r})n(\\mathbf{r})$ 对任何 $n \\in L^{2}(\\mathbb{R}^{3})$ 都在 $L^{2}(\\mathbb{R}^{3})$ 中，我们需要映射 $n \\mapsto wn$ 是一个从 $L^{2}$ 到 $L^{2}$ 的有界算子。这当且仅当 $w \\in L^{\\infty}(\\mathbb{R}^{3})$ 时成立。如果 $w \\in L^{\\infty}$，那么\n$$\n\\left\\| \\frac{\\delta F}{\\delta n} \\right\\|_{2}^{2} = \\int |2w(\\mathbf{r})n(\\mathbf{r})|^{2} \\, d\\mathbf{r} = 4 \\int |w(\\mathbf{r})|^{2} |n(\\mathbf{r})|^{2} \\, d\\mathbf{r} \\le 4\\|w\\|_{\\infty}^{2} \\int |n(\\mathbf{r})|^{2} \\, d\\mathbf{r} = 4\\|w\\|_{\\infty}^{2} \\|n\\|_{2}^{2} < \\infty\n$$\n因此，单一条件 $w \\in L^{\\infty}(\\mathbb{R}^{3})$ 对所有三个要求都是充分的。\n\n最后，我们阐述在约束条件 $\\int_{\\mathbb{R}^{3}} n(\\mathbf{r})\\, d\\mathbf{r} = N$ 下，最小化能量泛函 $E[n] = F[n] + \\int_{\\mathbb{R}^{3}} v_{\\mathrm{ext}}(\\mathbf{r})\\, n(\\mathbf{r})\\, d\\mathbf{r}$ 的欧拉-拉格朗日平稳性条件。\n这是一个约束变分问题。我们引入一个拉格朗日乘子 $\\mu$ 来施加约束。我们定义一个辅助泛函 $\\mathcal{L}[n]$：\n$$\n\\mathcal{L}[n] = E[n] - \\mu \\left( \\int_{\\mathbb{R}^{3}} n(\\mathbf{r}) \\, d\\mathbf{r} - N \\right)\n$$\n平稳性条件要求 $\\mathcal{L}[n]$ 对 $n(\\mathbf{r})$ 的泛函导数对所有 $\\mathbf{r}$ 都为零：\n$$\n\\frac{\\delta \\mathcal{L}}{\\delta n(\\mathbf{r})} = 0\n$$\n我们计算 $\\mathcal{L}[n]$ 中每一项的泛函导数：\n$$\n\\frac{\\delta F}{\\delta n(\\mathbf{r})} = 2w(\\mathbf{r})n(\\mathbf{r})\n$$\n$$\n\\frac{\\delta}{\\delta n(\\mathbf{r})} \\int_{\\mathbb{R}^{3}} v_{\\mathrm{ext}}(\\mathbf{r}') n(\\mathbf{r}') \\, d\\mathbf{r}' = v_{\\mathrm{ext}}(\\mathbf{r})\n$$\n$$\n\\frac{\\delta}{\\delta n(\\mathbf{r})} \\left( -\\mu \\int_{\\mathbb{R}^{3}} n(\\mathbf{r}') \\, d\\mathbf{r}' \\right) = -\\mu\n$$\n常数项 $-\\mu(-N)$ 的导数为零。综合这些结果，欧拉-拉格朗日方程为：\n$$\n\\frac{\\delta E}{\\delta n(\\mathbf{r})} - \\mu = 2w(\\mathbf{r})n(\\mathbf{r}) + v_{\\mathrm{ext}}(\\mathbf{r}) - \\mu = 0\n$$\n或者，更常见的写法是：\n$$\n2w(\\mathbf{r})n(\\mathbf{r}) + v_{\\mathrm{ext}}(\\mathbf{r}) = \\mu\n$$\n拉格朗日乘子 $\\mu$ 是一个常数，由所得密度 $n(\\mathbf{r})$ 积分得到总粒子数 $N$ 的条件确定。在量子力学和 DFT 的背景下，$\\mu$ 被认为是系统的化学势。它确保了能量的变分仅对那些保持总粒子数守恒的密度变分才为零。\n问题要求给出 $\\delta F/\\delta n(\\mathbf{r})$ 的解析表达式，我们已确定其为 $2w(\\mathbf{r})n(\\mathbf{r})$。", "answer": "$$\n\\boxed{2w(\\mathbf{r})n(\\mathbf{r})}\n$$", "id": "2634146"}, {"introduction": "尽管精确的密度泛函理论非常强大，但在实践中我们必须使用近似的交换相关泛函。这个练习 [@problem_id:2634165] 通过一个单电子体系（氢原子）的理想化模型，揭示了许多近似泛函（如 GGA）的一个关键缺陷——自相互作用误差。通过计算分数电荷下能量 $E(N)$ 与线性行为的偏离，你将获得对这一普遍问题的具体、定量的理解。", "problem": "一个处于外部库仑势中的氢原子有一个束缚电子，其精确基态能量在原子单位 (Hartree)下为 $E(1) = -\\tfrac{1}{2}$。考虑类氢原子基态密度 $n_{1}(\\mathbf{r})$ 以及电子数为分数 $N \\in [0,1]$ 的系综描述，其密度为 $n_{N}(\\mathbf{r}) = N\\,n_{1}(\\mathbf{r})$。密度泛函理论 (DFT) 的总能量泛函为\n$$\nE[n] \\;=\\; T_{s}[n] \\;+\\; E_{H}[n] \\;+\\; E_{xc}[n] \\;+\\; \\int v_{\\mathrm{ne}}(\\mathbf{r})\\,n(\\mathbf{r})\\,d\\mathbf{r},\n$$\n其中 $T_{s}[n]$ 是无相互作用动能，$E_{H}[n]$ 是 Hartree 能量，$E_{xc}[n]$ 是交换相关能。在单电子极限下，对于任何此类密度标度，精确的交换相关能会抵消 Hartree 能量，即 $E_{xc}^{\\mathrm{exact}}[n_{N}] = -E_{H}[n_{N}]$，这意味着 $E(N)$ 在 $N=0$ 和 $N=1$ 之间是精确分段线性的。\n\n现在考虑一种近似的广义梯度近似 (GGA)，在该近似下，对于单电子密度，交换能的标度关系为\n$$\nE_{x}^{\\mathrm{GGA}}[n_{N}] \\;=\\; -\\lambda\\,U_{1}\\,N^{4/3},\n$$\n其中 $U_{1} \\equiv E_{H}[n_{1}] = \\tfrac{5}{16}$ 且在该单电子密度下，相关作用可以忽略不计。参数 $\\lambda \\in (0,1)$ 表征了自相互作用的不完全抵消；对于一个类似于 Perdew–Burke–Ernzerhof (PBE) 的 GGA，取 $\\lambda = 0.90$。假设由于系综构造，$T_{s}[n_{N}]$ 和 $\\int v_{\\mathrm{ne}}\\,n_{N}$ 与 $N$ 呈线性标度关系。\n\n1) 从以上定义出发，推导偏差的解析表达式\n$$\n\\delta(N) \\;=\\; E^{\\mathrm{GGA}}(N) \\;-\\; L(N),\n$$\n其中 $L(N)$ 是在端点处的近似 GGA 能量之间的直线插值，$L(N) = (1-N)\\,E^{\\mathrm{GGA}}(0) + N\\,E^{\\mathrm{GGA}}(1)$。\n\n2) 利用您的表达式，计算当 $\\lambda = 0.90$ 时 $\\delta\\!\\left(\\tfrac{1}{2}\\right)$ 的值。以 Hartree 为单位表示最终结果，并四舍五入到四位有效数字。\n\n最后，利用 $E_{H}[n_{N}]$ 和 $E_{x}^{\\mathrm{GGA}}[n_{N}]$ 的密度标度行为，简要解释为什么在单电子极限下，对于氢原子，近似 GGA 会产生一个在 $N=0$ 和 $N=1$ 之间凸的 $E(N)$ 曲线。", "solution": "该问题要求使用一种近似的广义梯度近似 (GGA) 泛函，分析具有分数电子数 $N$ 的类氢体系的能量。任务是推导线性偏差 $\\delta(N)$，计算其在 $N = \\frac{1}{2}$ 处的值，并解释能量曲线 $E^{\\mathrm{GGA}}(N)$ 的凸性。\n\n首先，我们建立在该 GGA 近似下的总能量 $E^{\\mathrm{GGA}}(N)$ 作为分数电子数 $N \\in [0,1]$ 的函数表达式。总能量泛函由下式给出：\n$$\nE[n] = T_{s}[n] + E_{H}[n] + E_{xc}[n] + \\int v_{\\mathrm{ne}}(\\mathbf{r})\\,n(\\mathbf{r})\\,d\\mathbf{r}\n$$\n问题指明相关能可以忽略不计，因此 $E_{xc}[n] \\approx E_{x}[n]$。对于一个有 $N$ 个电子的体系，其密度为 $n_{N}(\\mathbf{r}) = N\\,n_{1}(\\mathbf{r})$。我们必须确定每个能量分量随 $N$ 的标度关系。\n\n无相互作用电子的动能 $T_{s}[n_{N}]$ 和核-电子吸引能 $V_{\\mathrm{ne}}[n_{N}] = \\int v_{\\mathrm{ne}}(\\mathbf{r})\\,n_{N}(\\mathbf{r})\\,d\\mathbf{r}$，被说明与 $N$ 呈线性标度关系。这与密度的系综定义是一致的。设 $T_{s}[n_{1}]$ 和 $V_{\\mathrm{ne}}[n_{1}]$ 为单电子体系 ($N=1$) 时的值。那么：\n$$\nT_{s}[n_{N}] = N\\,T_{s}[n_{1}]\n$$\n$$\nV_{\\mathrm{ne}}[n_{N}] = N\\,V_{\\mathrm{ne}}[n_{1}]\n$$\n让我们定义一个常数 $K_{1} = T_{s}[n_{1}] + V_{\\mathrm{ne}}[n_{1}]$，它包含了所有与 $N$ 呈线性标度关系的项。\n\nHartree 能量 $E_{H}[n]$ 是密度的二次方项。它随 $N$ 的标度关系为：\n$$\nE_{H}[n_{N}] = \\frac{1}{2} \\iint \\frac{n_{N}(\\mathbf{r})\\,n_{N}(\\mathbf{r'})}{|\\mathbf{r}-\\mathbf{r'}|}\\,d\\mathbf{r}\\,d\\mathbf{r'} = \\frac{1}{2} \\iint \\frac{N n_{1}(\\mathbf{r})\\,N n_{1}(\\mathbf{r'})}{|\\mathbf{r}-\\mathbf{r'}|}\\,d\\mathbf{r}\\,d\\mathbf{r'} = N^{2} \\left( \\frac{1}{2} \\iint \\frac{n_{1}(\\mathbf{r})\\,n_{1}(\\mathbf{r'})}{|\\mathbf{r}-\\mathbf{r'}|}\\,d\\mathbf{r}\\,d\\mathbf{r'} \\right) = N^{2} E_{H}[n_{1}]\n$$\n使用给定的定义 $U_{1} = E_{H}[n_{1}]$，我们有 $E_{H}[n_{N}] = U_{1}\\,N^{2}$。\n\n近似的 GGA 交换能按如下方式标度：\n$$\nE_{x}^{\\mathrm{GGA}}[n_{N}] = -\\lambda\\,U_{1}\\,N^{4/3}\n$$\n\n结合这些分量，$N$ 电子的总 GGA 能量为：\n$$\nE^{\\mathrm{GGA}}(N) = T_{s}[n_{N}] + V_{\\mathrm{ne}}[n_{N}] + E_{H}[n_{N}] + E_{x}^{\\mathrm{GGA}}[n_{N}] = N\\,(T_{s}[n_{1}] + V_{\\mathrm{ne}}[n_{1}]) + U_{1}\\,N^{2} - \\lambda\\,U_{1}\\,N^{4/3}\n$$\n$$\nE^{\\mathrm{GGA}}(N) = K_{1}\\,N + U_{1}\\,N^{2} - \\lambda\\,U_{1}\\,N^{4/3}\n$$\n\n现在，我们推导线性偏差的表达式 $\\delta(N) = E^{\\mathrm{GGA}}(N) - L(N)$。线性插值 $L(N)$ 定义为 $L(N) = (1-N)\\,E^{\\mathrm{GGA}}(0) + N\\,E^{\\mathrm{GGA}}(1)$。我们必须首先计算在端点 $N=0$ 和 $N=1$ 处的能量。\n对于 $N=0$，密度为零，所以所有能量分量都为零：\n$$\nE^{\\mathrm{GGA}}(0) = 0\n$$\n对于 $N=1$：\n$$\nE^{\\mathrm{GGA}}(1) = K_{1}\\,(1) + U_{1}\\,(1)^{2} - \\lambda\\,U_{1}\\,(1)^{4/3} = K_{1} + U_{1} - \\lambda\\,U_{1}\n$$\n因此，线性插值为：\n$$\nL(N) = (1-N)\\,(0) + N\\,(K_{1} + U_{1} - \\lambda\\,U_{1}) = K_{1}\\,N + U_{1}\\,N - \\lambda\\,U_{1}\\,N\n$$\n偏差 $\\delta(N)$ 可通过从 $E^{\\mathrm{GGA}}(N)$ 中减去 $L(N)$ 得到：\n$$\n\\delta(N) = E^{\\mathrm{GGA}}(N) - L(N) = (K_{1}\\,N + U_{1}\\,N^{2} - \\lambda\\,U_{1}\\,N^{4/3}) - (K_{1}\\,N + U_{1}\\,N - \\lambda\\,U_{1}\\,N)\n$$\n$$\n\\delta(N) = U_{1}\\,N^{2} - U_{1}\\,N - \\lambda\\,U_{1}\\,N^{4/3} + \\lambda\\,U_{1}\\,N\n$$\n提出公因子 $U_{1}$，得到偏差的最终解析表达式：\n$$\n\\delta(N) = U_{1} \\left[ (N^{2} - N) - \\lambda(N^{4/3} - N) \\right]\n$$\n这就完成了问题的第一部分。\n\n对于第二部分，我们必须使用 $\\lambda = 0.90$ 和 $U_{1} = \\frac{5}{16}$ Hartree 计算 $\\delta\\!\\left(\\frac{1}{2}\\right)$ 的值。我们将这些值代入推导出的 $\\delta(N)$ 表达式中：\n$$\n\\delta\\!\\left(\\frac{1}{2}\\right) = \\frac{5}{16} \\left[ \\left(\\left(\\frac{1}{2}\\right)^{2} - \\frac{1}{2}\\right) - 0.90\\left(\\left(\\frac{1}{2}\\right)^{4/3} - \\frac{1}{2}\\right) \\right]\n$$\n$$\n\\delta\\!\\left(\\frac{1}{2}\\right) = \\frac{5}{16} \\left[ \\left(\\frac{1}{4} - \\frac{1}{2}\\right) - 0.90\\left(\\left(\\frac{1}{2}\\right)^{4/3} - \\frac{1}{2}\\right) \\right]\n$$\n$$\n\\delta\\!\\left(\\frac{1}{2}\\right) = \\frac{5}{16} \\left[ -\\frac{1}{4} - 0.90\\left(2^{-4/3} - \\frac{1}{2}\\right) \\right]\n$$\n现在，我们计算其数值：\n$$\n2^{-4/3} \\approx 0.39685026\n$$\n$$\n\\delta\\!\\left(\\frac{1}{2}\\right) \\approx \\frac{5}{16} \\left[ -0.25 - 0.90(0.39685026 - 0.5) \\right]\n$$\n$$\n\\delta\\!\\left(\\frac{1}{2}\\right) \\approx \\frac{5}{16} \\left[ -0.25 - 0.90(-0.10314974) \\right]\n$$\n$$\n\\delta\\!\\left(\\frac{1}{2}\\right) \\approx \\frac{5}{16} \\left[ -0.25 + 0.092834766 \\right]\n$$\n$$\n\\delta\\!\\left(\\frac{1}{2}\\right) \\approx \\frac{5}{16} [-0.157165234] \\approx 0.3125 \\times (-0.157165234)\n$$\n$$\n\\delta\\!\\left(\\frac{1}{2}\\right) \\approx -0.0491141356 \\, \\text{Hartree}\n$$\n将结果四舍五入到四位有效数字，我们得到 $\\delta\\!\\left(\\frac{1}{2}\\right) = -0.04911$ Hartree。\n\n对于最后一部分，我们必须解释 $E^{\\mathrm{GGA}}(N)$ 曲线在 $N \\in (0,1)$ 区间内凸性的来源。如果一个函数的曲线位于连接其端点的线段上或其下方，则该函数是凸的。这意味着对于 $N \\in [0,1]$，有 $\\delta(N) = E^{\\mathrm{GGA}}(N) - L(N) \\leq 0$。我们得到的 $\\delta\\!\\left(\\frac{1}{2}\\right)$ 的负值结果与凸性是一致的。\n\n对于单电子体系，精确能量 $E(N)$ 的线性源于精确的交换相关能 $E_{xc}^{\\mathrm{exact}}[n_{N}] = -E_{H}[n_{N}]$ 对虚假的自相互作用 Hartree 能量 $E_{H}[n_{N}]$ 的完全抵消。近似 GGA 能量中的非线性项是 $E_{H}[n_{N}]$ 和 $E_{x}^{\\mathrm{GGA}}[n_{N}]$。非线性偏差 $\\delta(N)$ 的来源是这两项之和。\nHartree 能量的标度关系为 $E_{H}[n_{N}] = U_{1}N^{2}$。一个与 $N^2$ 成正比的函数是天然凸的（其二阶导数是一个正常数 $2U_1$）。\n近似的 GGA 交换能的标度关系为 $E_{x}^{\\mathrm{GGA}}[n_{N}] = -\\lambda U_{1}N^{4/3}$。一个与 $-N^{4/3}$ 成正比的函数是凹的（其二阶导数为 $-\\frac{4\\lambda U_1}{9}N^{-2/3}$，是负的）。\n\n总能量曲线的曲率是由凸的 Hartree 项和凹的近似交换项之间的竞争决定的。能量的总非线性部分是 $E_{\\mathrm{nl}}(N) = U_{1}N^{2} - \\lambda U_{1}N^{4/3}$。精确的交换能必须以一种能够完全抵消来自 Hartree 能量的 $N^2$ 项的方式进行标度。而具有 $N^{4/3}$ 标度关系的 GGA 交换能未能做到这一点。因为凸的 Hartree 项的指数（2）大于凹的交换项的指数（4/3），所以 Hartree 自相互作用的凸行为主导了能量曲线的总体形状。GGA 中自相互作用的这种不完全抵消导致了残余的凸曲率，使得总能量 $E^{\\mathrm{GGA}}(N)$ 向下弯曲到直线插值的下方。这种现象是许多近似密度泛函所固有的离域误差的一种表现。", "answer": "$$\n\\boxed{-0.04911}\n$$", "id": "2634165"}, {"introduction": "科恩-沈（KS）能隙为何通常显著小于实验测得的基本带隙？这个所谓的“带隙问题”源于精确交换相关泛函中一个微妙而深刻的特性——导数不连续性。本练习 [@problem_id:2634174] 提供了一个简化的模型系统，让你能够通过计算总能量和KS本征值，亲手量化这个不连续性 $\\Delta_{\\text{xc}}$，从而揭示KS图像与真实多体物理之间的重要差异。", "problem": "一个对称的两能级相互作用模型被用于研究密度泛函理论中，一个具有 $N=2$ 个电子的自旋非极化系统的导数不连续性问题。该模型有两个自旋简并的空间轨道和一个相互作用，通过全组态相互作用计算，得到以下数值精确的多体基态能量：\n- 对于 $N-1=1$ 个电子：$E(1) = -1.00$ eV。\n- 对于 $N=2$ 个电子：$E(2) = -3.00$ eV。\n- 对于 $N+1=3$ 个电子：$E(3) = -4.20$ eV。\n\n一个重现了 $N=2$ 基态密度的自洽 Kohn–Sham 计算，得到了已占据的最高占据分子轨道 (HOMO) 和未占据的最低未占据分子轨道 (LUMO) 的两个单粒子本征值（每个自旋）：\n- $\\varepsilon_{\\text{HOMO}}(N) = -2.00$ eV，\n- $\\varepsilon_{\\text{LUMO}}(N) = -1.50$ eV。\n\n从第一性原理出发，使用电离能和电子亲和能以总能量表示的定义，求出该相互作用系统的多体基本带隙，然后根据给定的自洽本征值求出 Kohn–Sham 带隙，最后在 Hohenberg–Kohn 框架的意义下，通过比较这两个带隙，确定该系统的交换相关导数不连续性 $\\Delta_{\\text{xc}}$。请以 eV 为单位表示 $\\Delta_{\\text{xc}}$ 的最终值，并将答案四舍五入到三位有效数字。", "solution": "该问题要求确定一个双电子系统的交换相关导数不连续性，记作 $\\Delta_{\\text{xc}}$。这个量源于 Kohn-Sham (KS) 单粒子图像在描述激发能方面的一个根本缺陷。在密度泛函理论的精确表述中，一个相互作用多体系统的基本带隙 $E_g$ 与其对应的 Kohn-Sham 系统的带隙 $E_g^{\\text{KS}}$ 通过以下方程相关联：\n$$ E_g = E_g^{\\text{KS}} + \\Delta_{\\text{xc}} $$\n我们的任务是通过首先根据所提供的数据计算 $E_g$ 和 $E_g^{\\text{KS}}$ 来计算 $\\Delta_{\\text{xc}}$。\n\n基本带隙 $E_g$ 定义为系统的电离能 ($I$) 和其电子亲和能 ($A$) 之间的差值。\n$$ E_g = I - A $$\n\n设 $E(M)$ 为具有 $M$ 个电子的系统的多体基态能量。对于 $N$ 电子系统，电离能是移除一个电子所需的最小能量，定义为：\n$$ I = E(N-1) - E(N) $$\n电子亲和能是增加一个电子时释放的能量，定义为：\n$$ A = E(N) - E(N+1) $$\n\n问题提供了该 $N=2$ 电子系统所需的总能量：\n- $E(N-1) = E(1) = -1.00 \\text{ eV}$\n- $E(N) = E(2) = -3.00 \\text{ eV}$\n- $E(N+1) = E(3) = -4.20 \\text{ eV}$\n\n使用这些值，我们计算电离能 $I$：\n$$ I = E(1) - E(2) = (-1.00 \\text{ eV}) - (-3.00 \\text{ eV}) = 2.00 \\text{ eV} $$\n接下来，我们计算电子亲和能 $A$：\n$$ A = E(2) - E(3) = (-3.00 \\text{ eV}) - (-4.20 \\text{ eV}) = 1.20 \\text{ eV} $$\n在确定了 $I$ 和 $A$ 之后，基本带隙 $E_g$ 为：\n$$ E_g = I - A = 2.00 \\text{ eV} - 1.20 \\text{ eV} = 0.80 \\text{ eV} $$\n\n现在，我们来计算 Kohn-Sham 带隙 $E_g^{\\text{KS}}$。它被定义为对 $N$ 电子系统计算出的最低未占据分子轨道 (LUMO) 和最高占据分子轨道 (HOMO) 的单粒子能量之差。\n$$ E_g^{\\text{KS}} = \\varepsilon_{\\text{LUMO}}(N) - \\varepsilon_{\\text{HOMO}}(N) $$\n\n问题提供了 $N=2$ 系统的自洽 KS 本征值：\n- $\\varepsilon_{\\text{HOMO}}(N) = -2.00 \\text{ eV}$\n- $\\varepsilon_{\\text{LUMO}}(N) = -1.50 \\text{ eV}$\n\n使用这些值，我们计算 Kohn-Sham 带隙：\n$$ E_g^{\\text{KS}} = (-1.50 \\text{ eV}) - (-2.00 \\text{ eV}) = 0.50 \\text{ eV} $$\n\n一个关键的一致性检查是注意到，对于精确密度和精确的 KS 势，HOMO 能量恰好是电离能的负值：$\\varepsilon_{\\text{HOMO}}(N) = -I$。我们计算出的电离能是 $I=2.00 \\text{ eV}$，因此 $-I = -2.00 \\text{ eV}$。这与给定的 $\\varepsilon_{\\text{HOMO}}(N) = -2.00 \\text{ eV}$ 相匹配，这证实了在 KS 计算产生给定密度的精确 KS 势的假设下，问题陈述的内部一致性。\n\n最后，我们可以通过重新整理基本关系式来确定交换相关导数不连续性 $\\Delta_{\\text{xc}}$：\n$$ \\Delta_{\\text{xc}} = E_g - E_g^{\\text{KS}} $$\n代入我们计算出的带隙值：\n$$ \\Delta_{\\text{xc}} = 0.80 \\text{ eV} - 0.50 \\text{ eV} = 0.30 \\text{ eV} $$\n\n问题要求答案保留三位有效数字。数值 $0.30$ 有两位有效数字。为了用三位有效数字表示，我们在后面加一个零。\n$$ \\Delta_{\\text{xc}} = 0.300 \\text{ eV} $$\n此值表示当电子数跨越整数值 $N=2$ 时，交换相关势的突变，这是一个纯粹的多体效应，在单粒子 Kohn-Sham 图像中不存在，但对于获得物理系统的正确基本带隙至关重要。", "answer": "$$\\boxed{0.300}$$", "id": "2634174"}]}