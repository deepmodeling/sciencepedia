{"hands_on_practices": [{"introduction": "为了真正理解 Hartree-Fock-Roothaan 方程，我们必须超越其抽象的矩阵形式，深入探究自洽场（Self-Consistent Field, SCF）程序在实践中是如何运作的。这项练习将引导您为一个简单的“玩具”系统，一步步地完成单次SCF迭代 [@problem_id:2643602]。通过手动构建福克（Fock）矩阵 $F$、求解广义本征值问题、更新密度矩阵 $P$，您将对分子轨道理论核心的计算引擎获得具体而深刻的理解。", "problem": "考虑一个用于阐明在非正交原子轨道 (AO) 基组中闭壳层分子的 Hartree–Fock–Roothaan 方程的极简玩具系统。有 $2$ 个电子双占据一个空间分子轨道（限制性闭壳层）。该基组的维度为 $2$，其原子轨道重叠矩阵为\n$$\nS \\;=\\; \\begin{pmatrix}\n1.0 & 0.2 \\\\\n0.2 & 1.0\n\\end{pmatrix}.\n$$\n单电子核心哈密顿量矩阵（以哈特里原子单位计）为\n$$\nH^{\\text{core}} \\;=\\; \\begin{pmatrix}\n-1.0 & -0.2 \\\\\n-0.2 & -0.5\n\\end{pmatrix}.\n$$\n电子排斥积分以化学家记法 $(\\mu\\nu|\\lambda\\sigma)$ 给出，并遵循标准的置换对称性。唯一的非零双电子积分（以哈特里计）为\n$$\n(11|11)=0.7,\\quad (22|22)=0.6,\\quad (11|22)=(22|11)=0.2,\\quad (12|12)=(21|21)=(12|21)=(21|12)=0.25,\n$$\n所有其他的 $(\\mu\\nu|\\lambda\\sigma)$ 均为零。假设核排斥能为 $0$ 哈特里。\n\n从初始零密度开始，根据限制性闭壳层系统的 Hartree–Fock–Roothaan 方法，显式地执行一次自洽场 (SCF) 迭代：在 AO 基组中对角化初始 Fock 矩阵的广义本征值问题，以获得能量最低的归一化分子轨道（通过 $S$-正交归一化），构建更新后的 AO 密度矩阵，使用更新后的密度重建 Fock 矩阵，然后计算闭壳层电子能量。请使用适用于非正交 AO 基组中 Hartree–Fock 理论的标准闭壳层定义。\n\n以哈特里为单位表示最终的电子能量（不包括核排斥能），并将您的答案四舍五入到四位有效数字。您的最终答案必须是单个实数。", "solution": "该问题要求对一个限制性闭壳层系统执行一次完整的自洽场 (SCF) 迭代，如 Hartree-Fock-Roothaan 方程所述。该系统由一个包含两个原子轨道 (AO) 的非正交基组中的 $2$ 个电子组成。最终目标是计算单次迭代后的电子能量。\n\nAO 基组中的 Hartree-Fock-Roothaan 方程是一个广义本征值问题：\n$$ FC = SCE $$\n其中 $F$ 是 Fock 矩阵，$C$ 是分子轨道 (MO) 系数矩阵，$S$ 是 AO 重叠矩阵，$E$ 是轨道能量 $\\epsilon_i$ 的对角矩阵。\n\n对于限制性闭壳层系统，Fock 矩阵的元素 $F_{\\mu\\nu}$ 由下式给出：\n$$ F_{\\mu\\nu} = H_{\\mu\\nu}^{\\text{core}} + \\sum_{\\lambda\\sigma} P_{\\lambda\\sigma} \\left[ (\\mu\\nu|\\lambda\\sigma) - \\frac{1}{2}(\\mu\\lambda|\\nu\\sigma) \\right] $$\n这里，$H^{\\text{core}}$ 是核心哈密顿量，$(\\mu\\nu|\\lambda\\sigma)$ 是化学家记法中的双电子排斥积分，$P$ 是密度矩阵。对于一个有 $N$ 个电子的系统，密度矩阵元 $P_{\\lambda\\sigma}$ 定义为：\n$$ P_{\\lambda\\sigma} = 2 \\sum_{i=1}^{N/2} C_{\\lambda i} C_{\\sigma i}^* $$\n其中求和遍历所有已占据的分子轨道。对于本问题，$N=2$，所以求和仅针对能量最低的分子轨道 $i=1$。\n\n电子能量 $E_{elec}$ 使用收敛的密度矩阵和 Fock 矩阵计算得出：\n$$ E_{elec} = \\frac{1}{2} \\sum_{\\mu\\nu} P_{\\nu\\mu} (H_{\\mu\\nu}^{\\text{core}} + F_{\\mu\\nu}) $$\n鉴于矩阵是实对称的，这等价于 $E_{elec} = \\frac{1}{2} \\text{Tr}[P(H^{\\text{core}} + F)]$。\n\nSCF 过程从密度矩阵 $P^{(0)}$ 的初始猜测开始。\n**第 0 步：初始猜测**\n问题指定了初始零密度。因此，初始密度矩阵 $P^{(0)}$ 是一个 $2 \\times 2$ 的零矩阵：\n$$ P^{(0)} = \\begin{pmatrix} 0 & 0 \\\\ 0 & 0 \\end{pmatrix} $$\n\n**第 1 步：初始 Fock 矩阵**\n使用 $P^{(0)}$，我们构建初始 Fock 矩阵 $F^{(0)}$。由于 $P^{(0)}$ 是一个零矩阵，Fock 矩阵表达式中的双电子项为零。因此，初始 Fock 矩阵等于核心哈密顿量：\n$$ F^{(0)} = H^{\\text{core}} = \\begin{pmatrix} -1.0 & -0.2 \\\\ -0.2 & -0.5 \\end{pmatrix} $$\n\n**第 2 步：求解广义本征值问题**\n我们求解广义本征值问题 $F^{(0)}C^{(1)} = SC^{(1)}E^{(1)}$，以找到第一次迭代的分子轨道系数 $C^{(1)}$ 和能量 $E^{(1)}$。这需要求解久期方程 $\\det(F^{(0)} - \\epsilon S) = 0$。\n$$ \\det \\left( \\begin{pmatrix} -1.0 & -0.2 \\\\ -0.2 & -0.5 \\end{pmatrix} - \\epsilon \\begin{pmatrix} 1.0 & 0.2 \\\\ 0.2 & 1.0 \\end{pmatrix} \\right) = 0 $$\n$$ \\det \\begin{pmatrix} -1.0 - \\epsilon & -0.2 - 0.2\\epsilon \\\\ -0.2 - 0.2\\epsilon & -0.5 - \\epsilon \\end{pmatrix} = 0 $$\n行列式为：\n$$ (-1.0 - \\epsilon)(-0.5 - \\epsilon) - (-0.2 - 0.2\\epsilon)^2 = 0 $$\n$$ (1.0 + \\epsilon)(0.5 + \\epsilon) - (0.2)^2(1.0 + \\epsilon)^2 = 0 $$\n$$ (1.0 + \\epsilon) \\left[ (0.5 + \\epsilon) - 0.04(1.0 + \\epsilon) \\right] = 0 $$\n$$ (1.0 + \\epsilon) (0.5 + \\epsilon - 0.04 - 0.04\\epsilon) = 0 $$\n$$ (1.0 + \\epsilon) (0.96\\epsilon + 0.46) = 0 $$\n此方程得到两个轨道能量：$\\epsilon_1 = -1.0$ 和 $\\epsilon_2 = -0.46/0.96 \\approx -0.47917$。能量最低的轨道是 $\\epsilon_1 = -1.0$。\n\n**第 3 步：确定并归一化能量最低的分子轨道**\n我们通过求解 $(F^{(0)} - \\epsilon_1 S)C_1 = 0$ 来找到对应于 $\\epsilon_1 = -1.0$ 的本征向量 $C_1$：\n$$ \\left( \\begin{pmatrix} -1.0 & -0.2 \\\\ -0.2 & -0.5 \\end{pmatrix} - (-1.0) \\begin{pmatrix} 1.0 & 0.2 \\\\ 0.2 & 1.0 \\end{pmatrix} \\right) \\begin{pmatrix} c_{11} \\\\ c_{21} \\end{pmatrix} = \\begin{pmatrix} 0 & 0 \\\\ 0 & 0.5 \\end{pmatrix} \\begin{pmatrix} c_{11} \\\\ c_{21} \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix} $$\n第二行给出 $0.5 c_{21} = 0$，所以 $c_{21}=0$。第一行 $0=0$ 对 $c_{11}$ 没有提供约束。我们可以设 $c_{11}=1$，得到未归一化的本征向量 $C_1' = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$。\n分子轨道必须根据 $C_1^\\dagger S C_1 = 1$ 进行归一化。\n$$ \\begin{pmatrix} 1 & 0 \\end{pmatrix} \\begin{pmatrix} 1.0 & 0.2 \\\\ 0.2 & 1.0 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 1 & 0 \\end{pmatrix} \\begin{pmatrix} 1.0 \\\\ 0.2 \\end{pmatrix} = 1.0 $$\n归一化常数为 $1$，所以归一化的分子轨道系数向量为 $C_1^{(1)} = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$。\n\n**第 4 步：构建更新的密度矩阵**\n$2$ 个电子位于单个已占据分子轨道 $\\psi_1$ 中，新的密度矩阵 $P^{(1)}$ 为：\n$$ P_{\\mu\\nu}^{(1)} = 2 C_{\\mu 1}^{(1)} C_{\\nu 1}^{(1)} $$\n使用 $C_1^{(1)} = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$，我们得到：\n$P_{11}^{(1)} = 2(1)(1) = 2$\n$P_{12}^{(1)} = P_{21}^{(1)} = 2(1)(0) = 0$\n$P_{22}^{(1)} = 2(0)(0) = 0$\n$$ P^{(1)} = \\begin{pmatrix} 2 & 0 \\\\ 0 & 0 \\end{pmatrix} $$\n\n**第 5 步：重建 Fock 矩阵**\n更新后的 Fock 矩阵 $F^{(1)}$ 使用 $P^{(1)}$ 构建。一个矩阵元的一般表达式为：\n$$ F_{\\mu\\nu}^{(1)} = H_{\\mu\\nu}^{\\text{core}} + \\sum_{\\lambda\\sigma} P_{\\lambda\\sigma}^{(1)} \\left[ (\\mu\\nu|\\lambda\\sigma) - \\frac{1}{2}(\\mu\\lambda|\\nu\\sigma) \\right] $$\n因为只有 $P_{11}^{(1)} = 2$ 是非零的，所以求和简化为 $\\lambda=\\sigma=1$ 的项：\n$$ F_{\\mu\\nu}^{(1)} = H_{\\mu\\nu}^{\\text{core}} + P_{11}^{(1)} \\left[ (\\mu\\nu|11) - \\frac{1}{2}(\\mu 1|\\nu 1) \\right] = H_{\\mu\\nu}^{\\text{core}} + 2 \\left[ (\\mu\\nu|11) - \\frac{1}{2}(\\mu 1|\\nu 1) \\right] $$\n未列出的积分为零。\n对于 $F_{11}^{(1)}$：$(\\mu=1, \\nu=1)$\n$$ F_{11}^{(1)} = H_{11}^{\\text{core}} + 2 \\left[ (11|11) - \\frac{1}{2}(11|11) \\right] = H_{11}^{\\text{core}} + (11|11) = -1.0 + 0.7 = -0.3 $$\n对于 $F_{22}^{(1)}$：$(\\mu=2, \\nu=2)$\n$$ F_{22}^{(1)} = H_{22}^{\\text{core}} + 2 \\left[ (22|11) - \\frac{1}{2}(21|21) \\right] = -0.5 + 2 \\left[ 0.2 - \\frac{1}{2}(0.25) \\right] = -0.5 + 2(0.075) = -0.35 $$\n对于 $F_{12}^{(1)}$：$(\\mu=1, \\nu=2)$\n$$ F_{12}^{(1)} = H_{12}^{\\text{core}} + 2 \\left[ (12|11) - \\frac{1}{2}(11|21) \\right] $$\n积分 $(12|11)$ 和 $(11|21)$ 不在非零积分列表中，因此它们为 $0$。\n$$ F_{12}^{(1)} = H_{12}^{\\text{core}} + 0 = -0.2 $$\n根据对称性，$F_{21}^{(1)} = -0.2$。新的 Fock 矩阵为：\n$$ F^{(1)} = \\begin{pmatrix} -0.3 & -0.2 \\\\ -0.2 & -0.35 \\end{pmatrix} $$\n\n**第 6 步：计算电子能量**\n一次迭代后的电子能量 $E_{elec}^{(1)}$ 使用 $P^{(1)}$ 和 $F^{(1)}$ 计算：\n$$ E_{elec}^{(1)} = \\frac{1}{2} \\sum_{\\mu\\nu} P_{\\mu\\nu}^{(1)} (H_{\\mu\\nu}^{\\text{core}} + F_{\\mu\\nu}^{(1)}) $$\n由于 $P^{(1)}$ 只有一个非零元素 $P_{11}^{(1)}=2$：\n$$ E_{elec}^{(1)} = \\frac{1}{2} P_{11}^{(1)} (H_{11}^{\\text{core}} + F_{11}^{(1)}) = \\frac{1}{2} (2) (-1.0 + (-0.3)) = 1 \\cdot (-1.3) = -1.3 $$\n一次 SCF 迭代后，不包括核排斥能的电子能量为 $-1.3$ 哈特里。\n\n题目要求答案四舍五入到四位有效数字。这得到 $-1.300$。", "answer": "$$\\boxed{-1.300}$$", "id": "2643602"}, {"introduction": "初学者一个常见的困惑点是标准本征值问题（$Fc = \\epsilon c$）与使用非正交基组时出现的广义本征值问题（$FC = SCE$）之间的区别。本练习将通过一个思想实验，故意要求您忽略重叠矩阵 $S$ 的作用，直接观察这种不正确假设所带来的后果 [@problem_id:2464744]。这个练习旨在突出，在非正交基组的框架下，重叠矩阵是确保物理模型正确性的关键，忽略它将导致对分子轨道能量的错误描述。", "problem": "考虑氢分子 $H_2$ 在由两个氢 $1s$ 轨道组成的最小基组中的 Hartree-Fock-Roothaan (HFR) 方程。HFR 方程可以写为广义本征值问题 $F \\mathbf{c} = S \\mathbf{c} \\varepsilon$，其中 $F$ 是 Fock 矩阵，$S$ 是重叠矩阵，$\\mathbf{c}$ 是分子轨道系数向量，$\\varepsilon$ 是轨道能量。在本问题中，您需要在故意不正确的假设下求解这些方程，即基组是标准正交的，也就是说，通过设置 $S = I$，其中 $I$ 是单位矩阵。在此假设下，问题简化为求解 $F$ 的普通本征值。\n\n对于下述每个测试用例，都给定一个对称的 $2 \\times 2$ 实数 Fock 矩阵 $F$（以 Hartree 原子单位）和相应的重叠矩阵 $S$（在求解时必须忽略该矩阵）。每个用例对应 $H_2$ 的一个不同的核间距 $R$（以 Bohr 为单位）。您在每个用例中的任务是通过求解 $F \\mathbf{c} = \\varepsilon \\mathbf{c}$ 来计算两个分子轨道能量，并按升序报告它们。所有能量必须以 Hartree 为单位表示，并四舍五入到六位小数。\n\n测试套件（每个用例提供 $R$、$F$ 和 $S$；在计算本征值时，您必须忽略 $S$ 并且只使用 $F$）：\n\n- 用例 1 ($R = 0.5$ Bohr):\n  - $F^{(1)} = \\begin{pmatrix} -0.5 & -0.8402976848102109 \\\\ -0.8402976848102109 & -0.5 \\end{pmatrix}$\n  - $S^{(1)} = \\begin{pmatrix} 1.0 & 0.9603402112116696 \\\\ 0.9603402112116696 & 1.0 \\end{pmatrix}$\n- 用例 2 ($R = 1.4$ Bohr):\n  - $F^{(2)} = \\begin{pmatrix} -0.5 & -0.658824888663992 \\\\ -0.658824888663992 & -0.5 \\end{pmatrix}$\n  - $S^{(2)} = \\begin{pmatrix} 1.0 & 0.7529427299017052 \\\\ 0.7529427299017052 & 1.0 \\end{pmatrix}$\n- 用例 3 ($R = 2.0$ Bohr):\n  - $F^{(3)} = \\begin{pmatrix} -0.5 & -0.5131462822721565 \\\\ -0.5131462822721565 & -0.5 \\end{pmatrix}$\n  - $S^{(3)} = \\begin{pmatrix} 1.0 & 0.5864528940253217 \\\\ 0.5864528940253217 & 1.0 \\end{pmatrix}$\n- 用例 4 ($R = 4.0$ Bohr):\n  - $F^{(4)} = \\begin{pmatrix} -0.5 & -0.16560390161897155 \\\\ -0.16560390161897155 & -0.5 \\end{pmatrix}$\n  - $S^{(4)} = \\begin{pmatrix} 1.0 & 0.1892616018502532 \\\\ 0.1892616018502532 & 1.0 \\end{pmatrix}$\n\n要求：\n\n- 对于每个用例，计算 $F$ 的两个本征值（以 Hartree 为单位），将它们按升序排序，并将每个值四舍五入到六位小数。\n- 将所有四个用例的结果汇总到一行：一个包含四个子列表的列表，每个子列表包含该用例的两个四舍五入后的本征值。\n- 最终输出格式：一行包含结果，格式为无空格、逗号分隔的子列表列表，例如 $[[a_1,a_2],[b_1,b_2],[c_1,c_2],[d_1,d_2]]$，其中每个符号代表一个四舍五入到六位小数的十进制数。\n\n您的程序应生成单行输出，其中包含用方括号括起来、无空格的逗号分隔列表形式的结果（例如，[[e_{11},e_{12}],[e_{21},e_{22}],[e_{31},e_{32}],[e_{41},e_{42}]]）。", "solution": "问题陈述已经过验证。它在一个清晰但理想化的科学背景下，提出了一个定义明确的数学任务。该问题是自洽的，其参数是一致的，并且拥有唯一的解。故意使用重叠矩阵 $S$ 是单位矩阵 $I$ 这一物理上不正确的假设，并不会使该问题作为一个计算练习失效；它仅仅是为此设定了条件。我们将继续进行求解。\n\n该问题要求在最小基组中求解氢分子 $H_2$ 的 Hartree-Fock-Roothaan (HFR) 方程。这些方程的一般形式是广义本征值问题：\n$$F \\mathbf{c} = S \\mathbf{c} \\varepsilon$$\n其中 $F$ 是 Fock 矩阵，$S$ 是重叠矩阵，$\\mathbf{c}$ 是分子轨道系数向量，$\\varepsilon$ 代表轨道能量。问题指示我们作出基函数是标准正交的这一简化但物理上不正确的假设。这意味着将重叠矩阵 $S$ 设置为单位矩阵 $I$，从而将 HFR 方程简化为标准本征值问题：\n$$F \\mathbf{c} = \\varepsilon \\mathbf{c}$$\n我们的任务是为给定的几个 $2 \\times 2$ Fock 矩阵找出本征值 $\\varepsilon$。\n\n对于一个一般的 $2 \\times 2$ 矩阵 $M = \\begin{pmatrix} m_{11} & m_{12} \\\\ m_{21} & m_{22} \\end{pmatrix}$，其本征值 $\\varepsilon$ 是特征多项式 $\\det(M - \\varepsilon I) = 0$ 的根。\n$$\n\\det \\begin{pmatrix} m_{11} - \\varepsilon & m_{12} \\\\ m_{21} & m_{22} - \\varepsilon \\end{pmatrix} = (m_{11} - \\varepsilon)(m_{22} - \\varepsilon) - m_{12}m_{21} = 0\n$$\n在本问题中，所有提供的 Fock 矩阵 $F$ 都是实对称的，并具有从 $H_2$ 分子对称性派生出的特定结构：\n$$\nF = \\begin{pmatrix} a & b \\\\ b & a \\end{pmatrix}\n$$\n其中 $a = -0.5$，$b$ 是一个负实数，代表共振积分，其值取决于核间距 $R$。\n\n对于此特定形式，特征方程为：\n$$\n(a - \\varepsilon)^2 - b^2 = 0\n$$\n这导出了本征值的简单解析解：\n$$\na - \\varepsilon = \\pm b\n$$\n$$\n\\varepsilon = a \\mp b\n$$\n因此，两个分子轨道能量为 $\\varepsilon_1 = a - b$ 和 $\\varepsilon_2 = a + b$。由于在所有给定用例中 $b$ 均为负数，$a+b$ 将对应于较低能量的（成键）轨道，而 $a-b$ 将对应于较高能量的（反键）轨道。任务要求按升序报告它们，即 $[\\varepsilon_2, \\varepsilon_1]$。\n\n让我们以用例 1（$R = 0.5$ Bohr）为例演示该过程：\n给定的 Fock 矩阵为：\n$$\nF^{(1)} = \\begin{pmatrix} -0.5 & -0.8402976848102109 \\\\ -0.8402976848102109 & -0.5 \\end{pmatrix}\n$$\n此处，$a = -0.5$ 且 $b = -0.8402976848102109$。\n轨道能量为：\n$$\n\\varepsilon_{lower} = a + b = -0.5 + (-0.8402976848102109) = -1.3402976848102109 \\, \\text{Hartree}\n$$\n$$\n\\varepsilon_{upper} = a - b = -0.5 - (-0.8402976848102109) = 0.3402976848102109 \\, \\text{Hartree}\n$$\n将这些值四舍五入到六位小数，我们得到 $-1.340298$ 和 $0.340298$。\n\n将此严谨的程序应用于所有四个用例，得出以下分子轨道能量，已按升序排列并四舍五入至六位小数：\n\n用例 1 ($R=0.5$ Bohr): $[-1.340298, 0.340298]$\n用例 2 ($R=1.4$ Bohr): $[-1.158825, 0.158825]$\n用例 3 ($R=2.0$ Bohr): $[-1.013146, 0.013146]$\n用例 4 ($R=4.0$ Bohr): $[-0.665604, -0.334396]$\n\n将编写一个数值程序来系统地执行这些计算，以确保精度并遵守指定的输出格式。该程序将对每个矩阵 $F^{(i)}$ 进行对角化以找到其本征值，对它们进行排序、四舍五入，并按要求格式化结果。这种计算方法与所演示的解析推导是等效的。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the standard eigenvalue problem F c = e c for a series of\n    2x2 real symmetric Fock matrices F, representing the H2 molecule\n    under the incorrect assumption of an orthonormal basis.\n    \"\"\"\n\n    # Define the Fock matrices for the four test cases from the problem statement.\n    # The overlap matrices S are ignored as per the problem's instructions.\n    test_cases = [\n        # Case 1 (R = 0.5 Bohr)\n        np.array([\n            [-0.5, -0.8402976848102109],\n            [-0.8402976848102109, -0.5]\n        ]),\n        # Case 2 (R = 1.4 Bohr)\n        np.array([\n            [-0.5, -0.658824888663992],\n            [-0.658824888663992, -0.5]\n        ]),\n        # Case 3 (R = 2.0 Bohr)\n        np.array([\n            [-0.5, -0.5131462822721565],\n            [-0.5131462822721565, -0.5]\n        ]),\n        # Case 4 (R = 4.0 Bohr)\n        np.array([\n            [-0.5, -0.16560390161897155],\n            [-0.16560390161897155, -0.5]\n        ])\n    ]\n\n    all_results = []\n    for F_matrix in test_cases:\n        # For a real symmetric matrix, np.linalg.eigvalsh is efficient and\n        # returns the eigenvalues in ascending order.\n        eigenvalues = np.linalg.eigvalsh(F_matrix)\n        \n        # Round each eigenvalue to six decimal places.\n        rounded_eigenvalues = np.round(eigenvalues, 6).tolist()\n        \n        all_results.append(rounded_eigenvalues)\n\n    # Format the final output string to match the specified format precisely.\n    # The string representation of the list is manipulated to remove all spaces.\n    # Example: '[[val1, val2], [val3, val4]]' -> '[[val1,val2],[val3,val4]]'\n    final_output_string = str(all_results).replace(\" \", \"\")\n\n    # Final print statement in the exact required format.\n    print(final_output_string)\n\nsolve()\n```", "id": "2464744"}, {"introduction": "在真实的量子化学计算中，尤其是在使用大型或弥散的基组时，基函数之间可能并非完全线性无关。这种“线性依赖”问题在数学上表现为重叠矩阵 $S$ 的奇异或近奇异性，给数值求解带来巨大挑战。这个问题将引导您从理论层面分析由奇异重叠矩阵引发的数学难题及其在计算实践中的解决方案 [@problem_id:2464743]。理解这些问题及其标准处理方法，例如通过舍弃“冗余”基函数进行正则正交化，对于诊断计算故障和领会现代量子化学软件的稳健性至关重要。", "problem": "在针对闭壳层体系的 Hartree-Fock-Roothaan 方法中，分子轨道被展开为一组有限的、通常非正交的原子轨道 (AO) 基组。由此产生的广义本征值问题是 $F C = S C \\varepsilon$，其中 $F$ 是在 AO 基下的 Fock 矩阵，$S$ 是 AO 重叠矩阵，其矩阵元为 $S_{\\mu \\nu} = \\langle \\chi_{\\mu} | \\chi_{\\nu} \\rangle$，$C$ 汇集了分子轨道系数，而 $\\varepsilon$ 是轨道能量的对角矩阵。考虑这样一种情况：所选的 AO 基组存在精确的线性相关性，因此重叠矩阵 $S$ 是奇异的（秩亏的）。\n\n在这种情况下，下列哪些陈述是正确的？选择所有适用的选项。\n\nA. 广义本征值问题 $F C = S C \\varepsilon$ 是不适定的，因为 $S$ 不可逆；在 $S$ 的非平凡零空间存在的情况下，系数向量不是唯一的，因为在零空间中添加任何分量都不会改变 AO 空间范数和物理轨道。\n\nB. 当 $S$ 是奇异的时，无法构建基于 $X = S^{-1/2}$ 的典范正交化；一种标准的解决方法是对角化 $S = U s U^{\\dagger}$，舍弃 $s_{ii}$ 低于某个数值阈值的本征向量，并仅使用保留的子空间设置 $X = U_{r} s_{r}^{-1/2} U_{r}^{\\dagger}$，从而消除线性相关性。\n\nC. 即使当 $S$ 是奇异的，执行 Cholesky 分解 $S = L L^{\\dagger}$ 也总能成功，因此可以安全地构建 $X = L^{-1}$ 来进行正交化，而无需修改基组。\n\nD. 用一个小的 $\\delta > 0$ 将 $S$ 替换为 $S + \\delta I$，在 $\\delta \\to 0^{+}$ 的极限下，保证能保留 Hartree-Fock 稳定点，同时保留完整的基组，因此这是一种精确且通常首选的解决方法。\n\nE. 基组中的线性相关性意味着 $S$ 至少有一个负本征值，这违反了变分原理，并从根本上导致 Hartree-Fock 方法失败。", "solution": "该问题探讨了在针对闭壳层体系的 Hartree-Fock-Roothaan 方法中，原子轨道 (AO) 基组中的线性相关性所带来的后果。问题的核心是广义本征值方程 $F C = S C \\varepsilon$，其中由于这些线性相关性，重叠矩阵 $S$ 是奇异的（秩亏的）。一个奇异的 $S$ 矩阵具有非平凡的零空间，意味着存在至少一个非零向量 $v$ 使得 $S v = 0$。这会带来重大的数学和数值影响，我们将对每个陈述进行分析。\n\n重叠矩阵 $S$ 的矩阵元为 $S_{\\mu\\nu} = \\langle \\chi_\\mu | \\chi_\\nu \\rangle$，它是一个 Gram 矩阵。根据其构造，它是半正定的。对于任何复向量 $c$，二次型 $c^{\\dagger} S c = \\sum_{\\mu,\\nu} c_\\mu^* S_{\\mu\\nu} c_\\nu = \\langle \\sum_\\mu c_\\mu \\chi_\\mu | \\sum_\\nu c_\\nu \\chi_\\nu \\rangle = \\| \\sum_\\mu c_\\mu \\chi_\\mu \\|^2 \\ge 0$。矩阵 $S$ 是奇异的，当且仅当存在一个非零向量 $v$ 使得 $v^{\\dagger} S v = 0$，这对应于基函数的某个线性组合为零函数，即 $\\sum_\\mu v_\\mu \\chi_\\mu = 0$。这意味着 $S$ 至少有一个本征值为零，而所有其他本征值均为正。\n\n我们现在来评估每个陈述。\n\n**A. 广义本征值问题 $F C = S C \\varepsilon$ 是不适定的，因为 $S$ 不可逆；在 $S$ 的非平凡零空间存在的情况下，系数向量不是唯一的，因为在零空间中添加任何分量都不会改变 AO 空间范数和物理轨道。**\n\n该陈述是正确的。\n1.  **不适定性与 S 的不可逆性**：对于右侧矩阵 $S$ 是奇异的广义本征值问题，它确实是不适定的。标准的求解算法通常需要将问题转换为标准本征值问题，这涉及 $S$ 的逆或其平方根 $S^{-1/2}$。由于奇异矩阵不可逆，这些标准程序会失败。\n2.  **系数向量的唯一性**：设 $\\phi_i = \\sum_\\mu c_{i\\mu} \\chi_\\mu$ 是由系数向量 $c_i$ 描述的分子轨道 (MO)。设 $v$ 是 $S$ 零空间中的任意向量，根据定义，它对应于一个线性相关性 $\\sum_\\mu v_\\mu \\chi_\\mu = 0$。考虑一个新的系数向量 $c'_i = c_i + \\alpha v$，其中 $\\alpha$ 为某个标量。对应于 $c'_i$ 的物理轨道是 $\\phi'_i = \\sum_\\mu (c_{i\\mu} + \\alpha v_\\mu) \\chi_\\mu = \\sum_\\mu c_{i\\mu} \\chi_\\mu + \\alpha \\sum_\\mu v_\\mu \\chi_\\mu = \\phi_i + 0 = \\phi_i$。物理轨道保持不变。\n3.  **AO 空间范数的不变性**：MO 系数向量的范数是相对于度规 $S$ 定义的，即 $\\|c_i\\|^2 = c_i^\\dagger S c_i$。对于新向量 $c'_i$，其范数为 $\\|c'_i\\|^2 = (c_i + \\alpha v)^\\dagger S (c_i + \\alpha v) = c_i^\\dagger S c_i + \\alpha c_i^\\dagger S v + \\alpha^* v^\\dagger S c_i + |\\alpha|^2 v^\\dagger S v$。因为 $v$ 在 $S$ 的零空间中，所以有 $Sv=0$，又因为 $S$ 是厄米矩阵，所以 $v^\\dagger S = (Sv)^\\dagger = 0$。因此，$\\|c'_i\\|^2 = c_i^\\dagger S c_i = \\|c_i\\|^2$。范数也保持不变。\n\n不同的系数向量（$c_i$ 和 $c_i + \\alpha v$）映射到同一个物理对象（MO $\\phi_i$）并且具有相同的范数，这一事实表明了表示上的冗余。这种不明确性是不适定问题的一个标志。\n\n对 A 的裁定：**正确**。\n\n**B. 当 $S$ 是奇异的时，无法构建基于 $X = S^{-1/2}$ 的典范正交化；一种标准的解决方法是对角化 $S = U s U^{\\dagger}$，舍弃 $s_{ii}$ 低于某个数值阈值的本征向量，并仅使用保留的子空间设置 $X = U_{r} s_{r}^{-1/2} U_{r}^{\\dagger}$，从而消除线性相关性。**\n\n该陈述也是正确的。\n1.  **典范正交化的失败**：典范正交化过程使用变换矩阵 $X = S^{-1/2}$ 将基变换为标准正交基。算符 $S^{-1/2}$ 仅对正定矩阵有明确定义。由于 $S$ 是奇异的，它不是正定的（它是半正定的），其逆 $S^{-1}$ 和平方根的逆 $S^{-1/2}$ 都不存在。\n2.  **标准解决方法**：所述的过程是量子化学程序中用于处理线性相关性的标准且最稳健的方法。\n    *   对半正定矩阵 $S$ 进行对角化：$S U = U s$，其中 $U$ 是本征向量构成的幺正矩阵，$s$ 是非负本征值构成的对角矩阵。\n    *   $S$ 的奇异性表现为一个或多个零本征值。在数值实践中，低于某个阈值的本征值被视为零。\n    *   与这些近零本征值相对应的本征向量张成了基组的线性相关部分。这些本征向量被舍弃。\n    *   余下的对应于显著本征值 ($s_r$) 的本征向量 ($U_r$) 被用来构造一个变换，将基变换到一个更小的、非冗余的标准正交基。\n    *   虽然变换矩阵最常被构造成矩形矩阵 $X = U_r s_r^{-1/2}$，它将 N 维 AO 空间映射到 $N_r$ 维正交空间，但选项中给出的表达式 $X = U_r s_r^{-1/2} U_r^\\dagger$ 是 $S^{1/2}$ 的 Moore-Penrose 伪逆。该矩阵的作用是向非冗余子空间上的投影，并且是解决该问题的一个有效步骤的组成部分。对整体策略——对角化 $S$ 并移除有问题的子空间——的描述是完全准确的，并代表了当前最先进的技术水平。\n\n对 B 的裁定：**正确**。\n\n**C. 即使当 $S$ 是奇异的，执行 Cholesky 分解 $S = L L^{\\dagger}$ 也总能成功，因此可以安全地构建 $X = L^{-1}$ 来进行正交化，而无需修改基组。**\n\n该陈述是错误的。\nCholesky 分解 $S = L L^{\\dagger}$（其中 $L$ 是一个具有正对角元的下三角矩阵）存在，当且仅当 $S$ 是一个正定矩阵。对于一个半正定但奇异的矩阵 $S$，标准的 Cholesky 算法会失败。在分解过程中，算法将需要对一个零或负数取平方根，或除以一个零对角元。具体来说，$L$ 的一个对角元会变成零，使得 $L$ 奇异，其逆 $L^{-1}$ 未定义。因此，不能“安全地构建 $X = L^{-1}$”。虽然存在用于半正定矩阵的带主元选择的改进 Cholesky 算法，但它们不会产生一个与原始维度相同的可逆三角因子 $L$，并且必须修改（缩减）基组，这与本陈述相矛盾。\n\n对 C 的裁定：**错误**。\n\n**D. 用一个小的 $\\delta > 0$ 将 $S$ 替换为 $S + \\delta I$，在 $\\delta \\to 0^{+}$ 的极限下，保证能保留 Hartree-Fock 稳定点，同时保留完整的基组，因此这是一种精确且通常首选的解决方法。**\n\n该陈述是错误的。\n这种技术被称为 Tikhonov 正则化。用 $S' = S + \\delta I$ 替换 $S$ 会使矩阵对于任何 $\\delta > 0$ 都变为正定，因为 $S$ 的所有本征值 $\\lambda_i$ 都变成了 $\\lambda_i + \\delta > 0$。这使得求逆 $S'^{-1}$ 成为可能，并使问题在数值上变得可处理。然而，这种方法是一种近似，而不是“精确的”解决方法。它将标准正交条件修改为 $C^\\dagger(S + \\delta I)C = I$，这与原始问题的约束 $C^\\dagger S C=I$ 在物理上是不同的。得到的波函数和能量将依赖于 $\\delta$。虽然可以研究 $\\delta \\to 0^+$ 的极限，但当问题再次变得不适定时，这个极限在数值上是不稳定的。无法保证在没有更复杂的处理的情况下，解会收敛到原始问题的正确物理稳定点。选项 B 中描述的过程通常更受青睐，因为它在数值上是稳定的，并且对应于对数学冗余的精确移除。\n\n对 D 的裁定：**错误**。\n\n**E. 基组中的线性相关性意味着 $S$ 至少有一个负本征值，这违反了变分原理，并从根本上导致 Hartree-Fock 方法失败。**\n\n该陈述是错误的。\n如引言部分的分析所示，重叠矩阵 $S$ 是半正定的。其本征值必须是非负的 ($\\lambda_i \\ge 0$)。线性相关性意味着 $S$ 是奇异的，这表示它必须有至少一个本征值恰好为零。这并不意味着存在负本征值。该陈述的前提在事实上是错误的。\n\n对 E 的裁定：**错误**。\n\n总之，陈述 A 和 B 正确地描述了问题的性质及其标准解决方法。", "answer": "$$\\boxed{AB}$$", "id": "2464743"}]}