{"hands_on_practices": [{"introduction": "经典理想气体是统计力学中的一个基石模型。本练习将引导你从第一性原理出发，亲手推导在一个与粒子库和热库接触的开放系统（即巨正则系综）中，经典理想气体的粒子数涨落遵循泊松分布。通过这个实践，你将加深对巨正则配分函数如何决定系统微观态概率分布的理解，并掌握从配分函数计算宏观可观测量（如平均粒子数 $\\langle N \\rangle$ 和其涨落 $\\langle(\\Delta N)^{2}\\rangle$）的核心技能。[@problem_id:2816826]", "problem": "一团由质量为 $m$ 的粒子组成的单原子经典理想气体，与一个温度为 $T$、化学势为 $\\mu$ 的热源和粒子源接触，占据一个固定的体积 $V$。在巨正则系综 (GCE) 的框架下处理该系统。仅从以下基本定义出发：\n- 包含 Gibbs 修正的相空间积分形式的 $N$ 粒子经典正则配分函数，\n- 以活度加权的对粒子数求和形式的巨配分函数，\n推导粒子数分布，并证明粒子数涨落是泊松分布的。然后以闭合形式计算粒子数方差 $\\langle(\\Delta N)^{2}\\rangle$。你可以符号化地定义热德布罗意波长 $\\lambda$，但除了从给定定义可推导出的性质外，不要假定任何额外性质。\n\n将最终答案表示为含 $z$、$V$ 和 $\\lambda$ 的单个闭合形式解析表达式，其中 $z$ 是活度 $z = \\exp(\\beta \\mu)$，而 $\\beta = 1/(k_{B}T)$。不包括单位。不要提供不等式或方程。最终答案必须是单个表达式。", "solution": "所述问题在科学上是合理的、适定的、客观的。它是统计力学中的一个标准推导，可以从指定的第一性原理出发进行求解。我们将进行推导。\n\n这个问题的基础是 $N$ 粒子经典正则配分函数 $Q_N(T,V)$，描述的是一个在逆温 $\\beta = 1/(k_B T)$ 下，处于体积 $V$ 中、由 $N$ 个质量为 $m$ 的不可区分、无相互作用的粒子组成的系统。其定义包含了针对不可区分性的 Gibbs 修正，由对 $6N$ 维相空间的积分给出：\n$$\nQ_N(T,V) = \\frac{1}{N! h^{3N}} \\int \\prod_{i=1}^N d^3\\mathbf{q}_i d^3\\mathbf{p}_i \\, \\exp(-\\beta H(\\{\\mathbf{q}_i, \\mathbf{p}_i\\}))\n$$\n对于单原子理想气体，哈密顿量 $H$ 仅包含粒子的动能，且与它们的位置 $\\{\\mathbf{q}_i\\}$ 无关：\n$$\nH(\\{\\mathbf{p}_i\\}) = \\sum_{i=1}^N \\frac{|\\mathbf{p}_i|^2}{2m}\n$$\n由于哈密顿量的可分离性，相空间积分可以分解为对位置和动量坐标的积分。对 $N$ 个粒子的空间坐标积分得到体积项：\n$$\n\\int \\prod_{i=1}^N d^3\\mathbf{q}_i = \\left(\\int_V d^3\\mathbf{q}\\right)^N = V^N\n$$\n对动量坐标的积分也分离为 $N$ 个相同的单粒子积分的乘积：\n$$\n\\int \\prod_{i=1}^N d^3\\mathbf{p}_i \\, \\exp\\left(-\\beta \\sum_{j=1}^N \\frac{|\\mathbf{p}_j|^2}{2m}\\right) = \\left[ \\int d^3\\mathbf{p} \\, \\exp\\left(-\\frac{\\beta |\\mathbf{p}|^2}{2m}\\right) \\right]^N\n$$\n单粒子动量积分是一个标准的三维高斯积分：\n$$\n\\int d^3\\mathbf{p} \\, \\exp\\left(-\\frac{\\beta |\\mathbf{p}|^2}{2m}\\right) = \\left[ \\int_{-\\infty}^{\\infty} dp \\, \\exp\\left(-\\frac{\\beta p^2}{2m}\\right) \\right]^3\n$$\n使用一维高斯积分的结果 $\\int_{-\\infty}^{\\infty} \\exp(-ax^2)dx = \\sqrt{\\pi/a}$，我们得到：\n$$\n\\int_{-\\infty}^{\\infty} dp \\, \\exp\\left(-\\frac{\\beta p^2}{2m}\\right) = \\sqrt{\\frac{2\\pi m}{\\beta}}\n$$\n这就给出了三维动量积分的值为 $(2\\pi m/\\beta)^{3/2}$。\n将这些结果代回 $Q_N(T,V)$ 的表达式，我们发现：\n$$\nQ_N(T,V) = \\frac{1}{N! h^{3N}} V^N \\left(\\frac{2\\pi m}{\\beta}\\right)^{3N/2} = \\frac{1}{N!} \\left[ V \\left(\\frac{2\\pi m}{h^2 \\beta}\\right)^{3/2} \\right]^N\n$$\n我们将热德布罗意波长 $\\lambda$ 定义为 $\\lambda = h\\sqrt{\\beta/(2\\pi m)}$。使用此定义，正则配分函数获得了一个紧凑的形式：\n$$\nQ_N(T,V) = \\frac{1}{N!} \\left(\\frac{V}{\\lambda^3}\\right)^N\n$$\n这是 $N$ 个经典理想气体粒子的正则配分函数。它通过 $Q_N = Q_1^N/N!$ 与单粒子配分函数 $Q_1 = V/\\lambda^3$ 相关联。\n\n现在，我们转向巨正则系综 (GCE)。巨配分函数 $\\Xi(T,V,\\mu)$ 定义为对所有可能的粒子数 $N \\in \\{0, 1, 2, ...\\}$ 的态求和，并通过活度 $z = \\exp(\\beta\\mu)$ 由化学势 $\\mu$ 加权：\n$$\n\\Xi(T,V,\\mu) = \\sum_{N=0}^{\\infty} z^N Q_N(T,V)\n$$\n代入我们得到的 $Q_N$ 的结果，我们有：\n$$\n\\Xi = \\sum_{N=0}^{\\infty} z^N \\frac{1}{N!} \\left(\\frac{V}{\\lambda^3}\\right)^N = \\sum_{N=0}^{\\infty} \\frac{1}{N!} \\left(\\frac{zV}{\\lambda^3}\\right)^N\n$$\n这个求和是指数函数 $\\exp(x) = \\sum_{k=0}^{\\infty} x^k/k!$ 的麦克劳林级数。令 $x = zV/\\lambda^3$，我们得到巨配分函数的闭合形式：\n$$\n\\Xi = \\exp\\left(\\frac{zV}{\\lambda^3}\\right)\n$$\n在系统中找到特定粒子数 $N$ 的概率 $P(N)$ 是求和中相应项与总和 $\\Xi$ 的比值：\n$$\nP(N) = \\frac{z^N Q_N}{\\Xi} = \\frac{\\frac{1}{N!} (zV/\\lambda^3)^N}{\\exp(zV/\\lambda^3)} = \\frac{(zV/\\lambda^3)^N}{N!} \\exp\\left(-\\frac{zV}{\\lambda^3}\\right)\n$$\n这就是粒子数分布函数。为了证明它是泊松分布的，我们将其与离散随机变量 $k$ 的泊松分布标准形式 $P(k;\\alpha) = \\frac{\\alpha^k e^{-\\alpha}}{k!}$进行比较，其中 $\\alpha$ 是平均值 $\\langle k \\rangle$。我们推导出的 $P(N)$ 精确地匹配此形式，其参数 $\\alpha$ 由下式给出：\n$$\n\\alpha = \\frac{zV}{\\lambda^3}\n$$\n因此，粒子数分布确实是泊松分布的。系统中的平均粒子数是 $\\langle N \\rangle = \\alpha = zV/\\lambda^3$。\n\n最后，我们计算粒子数的方差 $\\langle(\\Delta N)^2\\rangle$。泊松分布的一个众所周知的性质是其方差等于其均值：\n$$\n\\langle(\\Delta N)^2\\rangle = \\langle N^2 \\rangle - \\langle N \\rangle^2 = \\langle N \\rangle\n$$\n因此，理想气体在巨正则系综中的粒子数方差为：\n$$\n\\langle(\\Delta N)^2\\rangle = \\langle N \\rangle = \\frac{zV}{\\lambda^3}\n$$\n这是严格从给定定义推导出的粒子数方差的最终闭合形式表达式。", "answer": "$$\\boxed{\\frac{zV}{\\lambda^3}}$$", "id": "2816826"}, {"introduction": "在从经典系统转向非相互作用的量子系统时，我们不仅关心总粒子数的行为，更关心粒子如何在各个能级上分布。本练习旨在探讨一个基本问题：在巨正则系综中，两个不同单粒子量子态的布居数 $n_i$ 和 $n_j$ 的涨落是否是相互关联的？解答这个问题将揭示非相互作用系综的一个根本性质，即不同能级的占据是统计独立的，这对于理解玻色子和费米子的统计行为至关重要。[@problem_id:1208450]", "problem": "考虑一个由无相互作用的量子粒子（玻色子或费米子）组成的系统，这些粒子占据一系列由 $k$ 索引的单粒子态，每个态的能量为 $\\epsilon_k$。该系统与一个恒定温度 $T$ 和化学势 $\\mu$ 的热库和粒子库处于热平衡状态。因此，该系统的统计性质由巨正则系综描述。\n\n设 $n_i$ 和 $n_j$ 分别是两个不同单粒子量子态（标记为 $i$ 和 $j$，其中 $i \\neq j$）的占据数。这些占据数涨落之间的关联由协方差量化，定义为：\n$$\n\\text{Cov}(n_i, n_j) = \\langle n_i n_j \\rangle - \\langle n_i \\rangle \\langle n_j \\rangle\n$$\n其中 $\\langle \\cdot \\rangle$ 表示在巨正则系综中的热平均值。\n\n你的任务是确定对于该系统，占据数 $n_i$ 和 $n_j$ 的涨落是否相关。如果它们是相关的（即 $\\text{Cov}(n_i, n_j) \\neq 0$），你的答案应为1。如果它们是不相关的（即 $\\text{Cov}(n_i, n_j) = 0$），你的答案应为0。", "solution": "该系统由无相互作用的量子粒子（玻色子或费米子）组成，与温度为 $T$、化学势为 $\\mu$ 的热库和粒子库处于热平衡状态。由于没有相互作用，巨正则配分函数 $\\Xi$ 可以分解为各个单态配分函数的乘积：\n\n$$\n\\Xi = \\prod_k \\Xi_k\n$$\n\n其中 $\\Xi_k$ 是态 $k$ 的配分函数。对于费米子，$\\Xi_k = 1 + e^{-\\beta(\\epsilon_k - \\mu)}$；对于玻色子，$\\Xi_k = (1 - e^{-\\beta(\\epsilon_k - \\mu)})^{-1}$，其中 $\\beta = 1/(k_B T)$。\n\n占据数 $n_k$ 的热平均值为：\n\n$$\n\\langle n_k \\rangle = \\frac{1}{\\beta} \\frac{\\partial \\ln \\Xi_k}{\\partial \\mu}.\n$$\n\n对于不同的态 $i \\neq j$，联合期望值 $\\langle n_i n_j \\rangle$ 为：\n\n$$\n\\langle n_i n_j \\rangle = \\frac{1}{\\Xi} \\sum_{\\{n\\}} n_i n_j e^{-\\beta (E - \\mu N)}\n$$\n\n其中求和遍及所有占据数构型。由于粒子是无相互作用的，能量 $E$ 和总粒子数 $N$ 是对各单态贡献的求和，这导致概率分布可以因子分解：\n\n$$\nP(\\{n_k\\}) = \\prod_k P_k(n_k)\n$$\n\n其中 $P_k(n_k)$ 是态 $k$ 的概率分布。因此：\n\n$$\n\\langle n_i n_j \\rangle = \\sum_{n_i} \\sum_{n_j} n_i n_j P_i(n_i) P_j(n_j) = \\left( \\sum_{n_i} n_i P_i(n_i) \\right) \\left( \\sum_{n_j} n_j P_j(n_j) \\right) = \\langle n_i \\rangle \\langle n_j \\rangle.\n$$\n\n协方差为：\n\n$$\n\\text{Cov}(n_i, n_j) = \\langle n_i n_j \\rangle - \\langle n_i \\rangle \\langle n_j \\rangle = \\langle n_i \\rangle \\langle n_j \\rangle - \\langle n_i \\rangle \\langle n_j \\rangle = 0.\n$$\n\n这个结果对玻色子和费米子都成立，因为对于无相互作用的粒子，无论其量子统计性质如何，这种因子分解都是有效的。", "answer": "$$ \\boxed{0} $$", "id": "1208450"}, {"introduction": "粒子数涨落与热力学响应函数（如等温压缩率或化学势感受性）之间的关系，即涨落-响应定理，不仅仅是一个理论上的精巧结论，更是一个强大的研究工具。本练习将理论与现代计算物理实践相结合，向你展示如何利用这一关系来研究临界现象。你将学习如何通过分析有限尺寸晶格气体模型中的粒子数涨落数据，来数值估算相变过程中的临界指数 $\\gamma/\\nu$ 和 $\\eta$，这直接模拟了凝聚态物理研究中的一种常用分析方法。[@problem_id:2675496]", "problem": "你的任务是为巨正则系综（GCE）中的格点气体开发并实现一种基于第一性原理的、有限尺寸标度的临界指数估计量。你的方法必须从 GCE 和涨落-响应关系的第一性原理出发，并且必须对测量得到的粒子数涨落和磁化率的系统尺寸序列进行操作。本问题中的所有量均为无量纲量。你的程序必须产生单行输出，其中包含一个用方括号括起来的、以逗号分隔的结果列表。\n\n基本原理和定义：\n- 巨正则系综（GCE）的配分函数定义为 $\\Xi(\\beta,\\mu,V) = \\sum_{N \\geq 0} \\exp(\\beta \\mu N) Z_N(\\beta,V)$，其中 $\\beta = 1/(k_{\\mathrm{B}} T)$，$\\mu$ 是化学势，$V$ 是体积，$Z_N(\\beta,V)$ 是粒子数 $N$ 固定时的正则配分函数。\n- 粒子数 $N$ 的累积量由 $\\ln \\Xi(\\beta,\\mu,V)$ 对场 $f \\equiv \\beta \\mu$ 的导数得出：\n  - $\\langle N \\rangle = \\partial \\ln \\Xi / \\partial f$，\n  - $\\mathrm{Var}(N) = \\partial^2 \\ln \\Xi / \\partial f^2 = \\partial \\langle N \\rangle / \\partial f$。\n- 定义单位体积磁化率（感受率）$\\kappa$，其相对于 GCE 场 $f = \\beta \\mu$ 的表达式为 $\\kappa \\equiv V^{-1} \\, \\partial \\langle N \\rangle / \\partial f$。根据定义可直接推导出 $\\mathrm{Var}(N) = V \\, \\kappa$。\n\n有限尺寸标度设定：\n- 对于格点气体，在临界点处，当关联长度 $\\xi \\gtrsim L$ 时，它由系统尺寸 $L$ 控制。在 $d$ 维空间中，预期响应函数在临界点处会表现出关于 $L$ 的纯幂律标度行为。假设单位体积磁化率 $\\kappa(L)$ 和粒子数方差 $\\mathrm{Var}(N;L)$ 在临界点处渐近地服从关于 $L$ 的纯幂律，且具有非普适振幅。\n- 临界指数 $\\gamma$ 和 $\\nu$ 分别描述了热力学极限中磁化率和关联长度的发散行为，而反常维度 $\\eta$ 与临界二点关联的衰减有关。你的目标是通过有限尺寸标度，从每个观测量中独立地估计比值 $\\gamma/\\nu$，然后使用连接 $\\gamma/\\nu$ 和 $\\eta$ 的标度关系来估计 $\\eta$。\n\n你的程序必须执行的任务：\n1. 仅使用上述基本原理，构建一个基于第一性原理的指数比值 $\\gamma/\\nu$ 的估计量，该估计量源自：\n   - 单位体积磁化率 $\\kappa(L)$ 的标度行为，\n   - 总粒子数方差 $\\mathrm{Var}(N;L)$ 的标度行为，\n   同时需仔细考虑空间维度 $d$ 以及关系式 $\\mathrm{Var}(N) = V \\kappa$（其中 $V = L^d$）。\n2. 对于下述测试套件中的每个数据集，计算：\n   - 从 $\\kappa(L)$ 获得的 $\\gamma/\\nu$ 估计值，\n   - 从 $\\mathrm{Var}(N;L)$ 获得的 $\\gamma/\\nu$ 估计值，\n   - 通过对两个 $\\gamma/\\nu$ 估计值求平均，并调用连接 $\\gamma/\\nu$ 和 $\\eta$ 的临界标度关系得到的 $\\eta$ 估计值。\n3. 使用对数变量的线性回归来从每个观测量对 $L$ 的依赖关系中估计幂律指数。将所有报告的量四舍五入到 $6$ 位小数。\n\n测试套件：\n每个测试用例都指定了空间维度 $d$、一个非普适振幅 $A > 0$、一个指数比值目标 $r \\equiv \\gamma/\\nu$ 以及一组线性尺寸 $L$。测量的序列由临界的、有限尺寸的形式定义：\n$\\kappa(L) = A \\, L^{r}$ 和 $\\mathrm{Var}(N;L) = L^{d} \\, \\kappa(L)$。\n对于下面的每个测试用例 $(d,A,r,\\{L\\})$，构建相应的序列 $\\{\\kappa(L)\\}$ 和 $\\{\\mathrm{Var}(N;L)\\}$，然后应用你的估计量。\n\n- 用例 1：\n  - $d = 2$，$A = 0.6$，$r = 1.75$，$L \\in \\{8,12,16,24,32\\}$。\n- 用例 2：\n  - $d = 3$，$A = 1.2$，$r = 1.96$，$L \\in \\{6,8,10,12,16\\}$。\n- 用例 3：\n  - $d = 2$，$A = 2.5$，$r = 1.5$，$L \\in \\{4,6,8,10\\}$。\n\n要求的最终输出格式：\n- 你的程序应产生单行输出，其中包含一个用方括号括起来的、以逗号分隔的结果列表。对于每个用例，按顺序输出：\n  - 从 $\\kappa(L)$ 估计的 $\\gamma/\\nu$，\n  - 从 $\\mathrm{Var}(N;L)$ 估计的 $\\gamma/\\nu$，\n  - 从两个 $\\gamma/\\nu$ 估计值的平均值计算出的 $\\eta$。\n- 所有输出必须四舍五入到 $6$ 位小数。\n- 最终输出必须将三个用例的结果扁平化为一个列表，例如：$[\\mathrm{case1\\_gk},\\mathrm{case1\\_gv},\\mathrm{case1\\_\\eta},\\mathrm{case2\\_gk},\\mathrm{case2\\_gv},\\mathrm{case2\\_\\eta},\\mathrm{case3\\_gk},\\mathrm{case3\\_gv},\\mathrm{case3\\_\\eta}]$。", "solution": "经严格审查，该问题陈述有效。其科学基础扎根于统计力学和临界现象原理，内部逻辑一致，且提法明确。我们继续进行求解。\n\n目标是从 $d$ 维格点气体在临界点处的有限尺寸标度（FSS）数据中，推导并实现临界指数比 $\\gamma/\\nu$ 和反常维度 $\\eta$ 的估计量。数据以单位体积磁化率 $\\kappa(L)$ 和总粒子数方差 $\\mathrm{Var}(N;L)$ 作为线性系统尺寸 $L$ 的函数形式给出。\n\n首先，我们根据单位体积磁化率 $\\kappa(L)$ 的标度行为建立 $\\gamma/\\nu$ 的估计量。在临界现象理论中，一个在热力学极限下（其中 $t$ 是距临界点的距离度量）以 $|t|^{-\\lambda}$ 形式发散的响应函数，在尺寸为 $L$ 的有限系统中，于临界点处预期会按 $L^{\\lambda/\\nu}$ 进行标度。预测磁化率以指数 $\\gamma$ 发散，因此 FSS 假设为 $\\kappa(L) \\sim L^{\\gamma/\\nu}$。问题为数据提供了特定的函数形式：\n$$\n\\kappa(L) = A L^r\n$$\n其中指数 $r$ 定义为 $r \\equiv \\gamma/\\nu$。为了提取这个指数，我们通过对两边取自然对数，将其转换为线性关系：\n$$\n\\ln(\\kappa(L)) = \\ln(A) + r \\ln(L)\n$$\n此方程形如 $y = c + m x$，其中 $y = \\ln(\\kappa(L))$，$x = \\ln(L)$，截距 $c = \\ln(A)$，斜率 $m = r$。因此，$\\gamma/\\nu$ 的第一个估计量，我们记作 $(\\gamma/\\nu)_{\\kappa}$，是数据点 $(\\ln(L), \\ln(\\kappa(L)))$ 线性回归拟合的斜率。\n$$\n(\\gamma/\\nu)_{\\kappa} = \\frac{d[\\ln(\\kappa(L))]}{d[\\ln(L)]}\n$$\n\n其次，我们从粒子数方差 $\\mathrm{Var}(N;L)$ 的标度行为推导 $\\gamma/\\nu$ 的估计量。我们从给定的基本涨落-响应关系开始：\n$$\n\\mathrm{Var}(N) = V \\kappa\n$$\n对于一个 $d$ 维超立方系统，系统体积 $V$ 为 $V = L^d$。代入这个关系以及 $\\kappa(L)$ 的 FSS 形式，得到方差的标度行为：\n$$\n\\mathrm{Var}(N;L) = L^d \\kappa(L) \\sim L^d L^{\\gamma/\\nu} = L^{d + \\gamma/\\nu}\n$$\n问题中给出的数据生成规则 $\\mathrm{Var}(N;L) = L^{d} \\, \\kappa(L) = L^d(A L^r) = A L^{d+r}$ 与此推导一致。取自然对数得：\n$$\n\\ln(\\mathrm{Var}(N;L)) = \\ln(A) + (d+r) \\ln(L)\n$$\n这同样是一个线性关系。$\\ln(\\mathrm{Var}(N;L))$ 对 $\\ln(L)$ 的曲线斜率为 $m' = d+r = d+\\gamma/\\nu$。为了从方差数据中找到 $\\gamma/\\nu$ 的估计量（记作 $(\\gamma/\\nu)_{\\mathrm{Var}}$），我们必须通过回归计算斜率 $m'$，然后减去空间维度 $d$：\n$$\n(\\gamma/\\nu)_{\\mathrm{Var}} = \\frac{d[\\ln(\\mathrm{Var}(N;L))]}{d[\\ln(L)]} - d\n$$\n\n第三，我们构建反常维度 $\\eta$ 的估计量。连接 $\\gamma$、$\\nu$ 和 $\\eta$ 的标准标度关系是：\n$$\n\\gamma = \\nu(2-\\eta)\n$$\n可以将其重新整理，用比值 $\\gamma/\\nu$ 来表示 $\\eta$：\n$$\n\\eta = 2 - \\gamma/\\nu\n$$\n根据问题规范，我们首先根据两种独立方法计算比值 $\\gamma/\\nu$ 的平均估计值：\n$$\n(\\gamma/\\nu)_{\\mathrm{avg}} = \\frac{1}{2} \\left[ (\\gamma/\\nu)_{\\kappa} + (\\gamma/\\nu)_{\\mathrm{Var}} \\right]\n$$\n于是，$\\eta$ 的最终估计量为：\n$$\n\\eta_{\\mathrm{est}} = 2 - (\\gamma/\\nu)_{\\mathrm{avg}}\n$$\n\n对每个测试用例 $(d, A, r, \\{L_i\\})$ 的计算流程如下：\n1. 使用给定的公式 $\\kappa(L) = A L^r$ 和 $\\mathrm{Var}(N;L) = L^d \\kappa(L)$ 构建数据序列 $\\{\\kappa(L_i)\\}$ 和 $\\{\\mathrm{Var}(N;L_i)\\}$。\n2. 创建对数变量的向量：$x_i = \\ln(L_i)$，$y_{\\kappa,i} = \\ln(\\kappa(L_i))$ 和 $y_{\\mathrm{Var},i} = \\ln(\\mathrm{Var}(N;L_i))$。\n3. 对 $(x_i, y_{\\kappa,i})$ 进行线性回归，求出斜率 $m_{\\kappa}$。这给出估计值 $(\\gamma/\\nu)_\\kappa = m_{\\kappa}$。\n4. 对 $(x_i, y_{\\mathrm{Var},i})$ 进行线性回归，求出斜率 $m_{\\mathrm{Var}}$。估计值为 $(\\gamma/\\nu)_{\\mathrm{Var}} = m_{\\mathrm{Var}} - d$。\n5. 计算平均值 $(\\gamma/\\nu)_{\\mathrm{avg}}$ 和估计值 $\\eta_{\\mathrm{est}} = 2 - (\\gamma/\\nu)_{\\mathrm{avg}}$。\n6. 将得到的三个值 $(\\gamma/\\nu)_\\kappa$、$(\\gamma/\\nu)_{\\mathrm{Var}}$ 和 $\\eta_{\\mathrm{est}}$ 四舍五入到 $6$ 位小数以供报告。\n\n此流程将应用于所有测试用例，并将结果汇总成一个扁平化的列表。由于输入数据是根据无噪声的完美幂律生成的，线性回归将得出精确的指数，因此我们预期在所有用例中，受浮点精度影响，$(\\gamma/\\nu)_\\kappa = (\\gamma/\\nu)_{\\mathrm{Var}} = r$。", "answer": "```python\nimport numpy as np\nfrom scipy.stats import linregress\n\ndef solve():\n    \"\"\"\n    Solves the problem of estimating critical exponents from finite-size scaling data.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (d, A, r, L_list)\n    # d: spatial dimension\n    # A: nonuniversal amplitude\n    # r: exponent ratio gamma/nu\n    # L_list: list of linear system sizes\n    test_cases = [\n        (2, 0.6, 1.75, [8, 12, 16, 24, 32]),\n        (3, 1.2, 1.96, [6, 8, 10, 12, 16]),\n        (2, 2.5, 1.5, [4, 6, 8, 10]),\n    ]\n\n    all_results_flat = []\n\n    for case in test_cases:\n        d, A, r, L_values = case\n\n        # Convert list of L values to a numpy array for vectorized operations\n        L = np.array(L_values, dtype=np.float64)\n\n        # 1. Generate data series according to the problem's model\n        # Per-volume susceptibility: kappa(L) = A * L^r\n        kappa = A * (L ** r)\n        # Total particle-number variance: Var(N;L) = L^d * kappa(L)\n        var_N = (L ** d) * kappa\n\n        # 2. Transform to logarithmic variables for linear regression\n        log_L = np.log(L)\n        log_kappa = np.log(kappa)\n        log_var_N = np.log(var_N)\n\n        # 3. Perform linear regression for kappa(L) data\n        # The equation is log(kappa) = log(A) + r * log(L). The slope is 'r'.\n        kappa_regression = linregress(log_L, log_kappa)\n        gamma_nu_from_kappa = kappa_regression.slope\n\n        # 4. Perform linear regression for Var(N;L) data\n        # The equation is log(Var(N)) = log(A) + (d+r) * log(L). The slope is 'd+r'.\n        var_N_regression = linregress(log_L, log_var_N)\n        gamma_nu_from_var = var_N_regression.slope - d\n\n        # 5. Calculate the estimate for the anomalous dimension eta\n        # First, average the two estimates for gamma/nu.\n        gamma_nu_avg = (gamma_nu_from_kappa + gamma_nu_from_var) / 2.0\n        # Then, use the scaling relation eta = 2 - gamma/nu.\n        eta_est = 2.0 - gamma_nu_avg\n\n        # 6. Append formatted results to the list\n        all_results_flat.append(f\"{gamma_nu_from_kappa:.6f}\")\n        all_results_flat.append(f\"{gamma_nu_from_var:.6f}\")\n        all_results_flat.append(f\"{eta_est:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(all_results_flat)}]\")\n\nsolve()\n```", "id": "2675496"}]}