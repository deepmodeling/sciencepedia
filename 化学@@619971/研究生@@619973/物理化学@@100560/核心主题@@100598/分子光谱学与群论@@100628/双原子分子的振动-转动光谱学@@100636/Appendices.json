{"hands_on_practices": [{"introduction": "谐振子模型是理解分子振动的基石，但它忽略了化学键在拉伸时最终会断裂这一事实。莫尔斯势提供了一个更真实的描述，引入了非谐性 (anharmonicity) 的概念。本练习将引导你推导基于莫尔斯振子的振动跃迁波数，并计算基频带 (fundamental band) 和第一泛频带 (first overtone) 的位置，让你亲身体会非谐性常数 $x_e$ 如何导致泛频带的频率偏离谐振子模型的整数倍预测。[@problem_id:2667133]", "problem": "一个异核双原子分子的振动可以很好地用 Morse 势来描述。在振转光谱学中，振动能级之间的谱带起点（忽略转动精细结构时的跃迁波数）是通过振动项值之差获得的。请从 Morse 振子的标准光谱项值表达式出发，并根据跃迁波数的基本定义（能级能量差除以普朗克常数和光速的乘积），推导振动能级 $v''$ 与 $v'$ 之间跃迁波数 $\\tilde{\\nu}(v' \\leftarrow v'')$ 的通用表达式。然后，对于一个振动常数 $\\omega_e = 3000\\,\\mathrm{cm^{-1}}$ 和 $x_e = 0.010$ 的分子，计算跃迁 $v=0 \\to 1$ 和 $v=0 \\to 2$ 的谱带起点（以波数为单位）。最后，将第一泛音的“谐振预测值”定义为 $2\\tilde{\\nu}_0$，其中 $\\tilde{\\nu}_0$ 是同一分子的基频带起点 $\\tilde{\\nu}(1 \\leftarrow 0)$，并计算偏差 $\\Delta \\equiv \\tilde{\\nu}(2 \\leftarrow 0) - 2\\tilde{\\nu}_0$。\n\n将所有请求的量以 $\\mathrm{cm^{-1}}$ 为单位表示，并将答案四舍五入到 $4$ 位有效数字。按顺序 $\\big(\\tilde{\\nu}(1 \\leftarrow 0),\\, \\tilde{\\nu}(2 \\leftarrow 0),\\, 2\\tilde{\\nu}_0,\\, \\Delta\\big)$ 将最终结果以单行矩阵的形式报告。", "solution": "所述问题具有科学依据，提法明确且客观。所有必要的参数均已提供，所需的计算基于分子光谱学的基本原理。该问题是有效的。\n\n分析始于由 Morse 势描述的非谐振子的标准振动项值 $G(v)$ 表达式。这些项值以波数（$\\mathrm{cm^{-1}}$）为单位，由以下公式给出：\n$$\nG(v) = \\omega_e \\left( v + \\frac{1}{2} \\right) - \\omega_e x_e \\left( v + \\frac{1}{2} \\right)^2\n$$\n在此方程中，$v$ 是振动量子数（$v = 0, 1, 2, \\dots$），$\\omega_e$ 是以波数为单位的谐振频率，而 $x_e$是无量纲的非谐性常数。\n\n从量子数为 $v''$ 的初态到量子数为 $v'$ 的末态的光谱跃迁波数 $\\tilde{\\nu}(v' \\leftarrow v'')$ 是它们各自项值之差：\n$$\n\\tilde{\\nu}(v' \\leftarrow v'') = G(v') - G(v'')\n$$\n将 $G(v)$ 的表达式代入此关系式，我们推导出振动跃迁谱带起点的通用表达式：\n$$\n\\tilde{\\nu}(v' \\leftarrow v'') = \\left[ \\omega_e \\left( v' + \\frac{1}{2} \\right) - \\omega_e x_e \\left( v' + \\frac{1}{2} \\right)^2 \\right] - \\left[ \\omega_e \\left( v'' + \\frac{1}{2} \\right) - \\omega_e x_e \\left( v'' + \\frac{1}{2} \\right)^2 \\right]\n$$\n通过合并 $\\omega_e$ 和 $\\omega_e x_e$ 的项，可以简化此表达式：\n$$\n\\tilde{\\nu}(v' \\leftarrow v'') = \\omega_e \\left( v' - v'' \\right) - \\omega_e x_e \\left[ \\left( v' + \\frac{1}{2} \\right)^2 - \\left( v'' + \\frac{1}{2} \\right)^2 \\right]\n$$\n利用平方差恒等式 $a^2 - b^2 = (a-b)(a+b)$，方括号中的项变为：\n$$\n\\left( v' + \\frac{1}{2} \\right)^2 - \\left( v'' + \\frac{1}{2} \\right)^2 = \\left( (v' + \\frac{1}{2}) - (v'' + \\frac{1}{2}) \\right) \\left( (v' + \\frac{1}{2}) + (v'' + \\frac{1}{2}) \\right) = (v' - v'')(v' + v'' + 1)\n$$\n将其代回，得到跃迁波数的通用表达式：\n$$\n\\tilde{\\nu}(v' \\leftarrow v'') = \\omega_e (v' - v'') - \\omega_e x_e (v' - v'')(v' + v'' + 1)\n$$\n这就是所要求的通用推导。\n\n现在，我们为振动常数 $\\omega_e = 3000\\,\\mathrm{cm^{-1}}$ 和 $x_e = 0.010$ 的分子计算指定量。非谐性乘积为 $\\omega_e x_e = 3000 \\times 0.010 = 30\\,\\mathrm{cm^{-1}}$。\n\n$1$. 基频跃迁，$\\tilde{\\nu}(1 \\leftarrow 0)$：\n对于此跃迁，$v''=0$ 且 $v'=1$。使用推导出的公式：\n$$\n\\tilde{\\nu}(1 \\leftarrow 0) = \\omega_e(1 - 0) - \\omega_e x_e(1 - 0)(1 + 0 + 1) = \\omega_e - 2\\omega_e x_e\n$$\n代入数值：\n$$\n\\tilde{\\nu}(1 \\leftarrow 0) = 3000\\,\\mathrm{cm^{-1}} - 2(30\\,\\mathrm{cm^{-1}}) = 3000\\,\\mathrm{cm^{-1}} - 60\\,\\mathrm{cm^{-1}} = 2940\\,\\mathrm{cm^{-1}}\n$$\n\n$2$. 第一泛音跃迁，$\\tilde{\\nu}(2 \\leftarrow 0)$：\n对于此跃迁，$v''=0$ 且 $v'=2$。使用推导出的公式：\n$$\n\\tilde{\\nu}(2 \\leftarrow 0) = \\omega_e(2 - 0) - \\omega_e x_e(2 - 0)(2 + 0 + 1) = 2\\omega_e - 6\\omega_e x_e\n$$\n代入数值：\n$$\n\\tilde{\\nu}(2 \\leftarrow 0) = 2(3000\\,\\mathrm{cm^{-1}}) - 6(30\\,\\mathrm{cm^{-1}}) = 6000\\,\\mathrm{cm^{-1}} - 180\\,\\mathrm{cm^{-1}} = 5820\\,\\mathrm{cm^{-1}}\n$$\n\n$3$. 第一泛音的谐振预测值，$2\\tilde{\\nu}_0$：\n题目定义 $\\tilde{\\nu}_0 = \\tilde{\\nu}(1 \\leftarrow 0)$。根据我们的计算，$\\tilde{\\nu}_0 = 2940\\,\\mathrm{cm^{-1}}$。因此，谐振预测值为：\n$$\n2\\tilde{\\nu}_0 = 2 \\times 2940\\,\\mathrm{cm^{-1}} = 5880\\,\\mathrm{cm^{-1}}\n$$\n\n$4$. 偏差，$\\Delta$：\n偏差定义为 $\\Delta \\equiv \\tilde{\\nu}(2 \\leftarrow 0) - 2\\tilde{\\nu}_0$。使用计算出的值：\n$$\n\\Delta = 5820\\,\\mathrm{cm^{-1}} - 5880\\,\\mathrm{cm^{-1}} = -60\\,\\mathrm{cm^{-1}}\n$$\n从符号上看，此偏差为：\n$$\n\\Delta = (2\\omega_e - 6\\omega_e x_e) - 2(\\omega_e - 2\\omega_e x_e) = 2\\omega_e - 6\\omega_e x_e - 2\\omega_e + 4\\omega_e x_e = -2\\omega_e x_e\n$$\n计算证实：$\\Delta = -2(30\\,\\mathrm{cm^{-1}}) = -60\\,\\mathrm{cm^{-1}}$。\n\n题目要求将最终答案四舍五入到 $4$ 位有效数字。\n- $\\tilde{\\nu}(1 \\leftarrow 0) = 2940\\,\\mathrm{cm^{-1}}$ 报告为 $2940$。\n- $\\tilde{\\nu}(2 \\leftarrow 0) = 5820\\,\\mathrm{cm^{-1}}$ 报告为 $5820$。\n- $2\\tilde{\\nu}_0 = 5880\\,\\mathrm{cm^{-1}}$ 报告为 $5880$。\n- $\\Delta = -60\\,\\mathrm{cm^{-1}}$ 必须写成 $4$ 位有效数字，即 $-60.00$。\n\n按要求将最终结果组合成一个单行矩阵。", "answer": "$$\n\\boxed{\\begin{pmatrix} 2940 & 5820 & 5880 & -60.00 \\end{pmatrix}}\n$$", "id": "2667133"}, {"introduction": "气相分子的振动跃迁总是伴随着转动能级的改变，从而在光谱上呈现出精细结构。本练习将聚焦于转振光谱中的 $R$ 支，要求你从刚性转子模型的基本原理出发，推导并计算一系列谱线的位置。通过这个过程，你将清晰地理解带源 $\\tilde{\\nu}_{0}$ 以及跃迁前后振动态的转动常数 $B'$ 和 $B''$ 是如何共同决定谱图特征的。[@problem_id:2667078]", "problem": "一种气相异核双原子分子在刚性转子和谐振子近似有效且离心畸变可忽略的条件下，观测其吸收光谱。该跃迁对应于一个振动基频带，其谱带原点（纯振动能项差）为 $\\tilde{\\nu}_{0} = 2143.27\\,\\mathrm{cm^{-1}}$。在较低和较高振动能态中的转动常数分别为 $B'' = 1.9225\\,\\mathrm{cm^{-1}}$ 和 $B' = 1.9000\\,\\mathrm{cm^{-1}}$。\n\n从刚性转子的振动能项值 $G(v)$ 和转动能项值 $F_{v}(J)$ 的定义，以及异核双原子分子转振跃迁的电偶极选择定则出发，推导用 $\\tilde{\\nu}_{0}$、$B'$、$B''$和$J''$表示的$R$支谱线位置 $\\tilde{\\nu}_{R}(J'')$ 的表达式。然后计算 $R(0)$ 到 $R(3)$ 谱线的位置（以波数为单位）。\n\n将每个最终谱线位置以 $\\mathrm{cm^{-1}}$ 为单位表示，并四舍五入到五位有效数字。", "solution": "该问题要求在刚性转子和谐振子近似下，推导异核双原子分子R支谱线的位置，然后计算特定谱线的位置。我们从基本原理开始。\n\n双原子分子的总转振能量，以波数（$\\mathrm{cm^{-1}}$）为单位的能项值 $\\tilde{T}(v, J)$ 表示，是其振动能项值 $\\tilde{G}(v)$ 与其转动能项值 $\\tilde{F}_{v}(J)$ 的和。\n$$ \\tilde{T}(v, J) = \\tilde{G}(v) + \\tilde{F}_{v}(J) $$\n在谐振子近似下，振动能项值由下式给出：\n$$ \\tilde{G}(v) = \\tilde{\\omega}_{e} \\left(v + \\frac{1}{2}\\right) $$\n其中 $\\tilde{\\omega}_{e}$ 是谐性振动频率，$v$ 是振动量子数（$v=0, 1, 2, \\dots$）。\n在刚性转子近似下，给定振动能态 $v$ 的转动能项值为：\n$$ \\tilde{F}_{v}(J) = \\tilde{B}_{v} J(J+1) $$\n其中 $\\tilde{B}_{v}$ 是该振动能态的转动常数，$J$ 是转动量子数（$J=0, 1, 2, \\dots$）。题目说明离心畸变可忽略，因此不需要更多项。\n\n对应于从较低转振能态 $(v'', J'')$ 到较高能态 $(v', J')$ 跃迁的吸收谱线的波数 $\\tilde{\\nu}$ 是它们能项值的差：\n$$ \\tilde{\\nu} = \\tilde{T}(v', J') - \\tilde{T}(v'', J'') = [\\tilde{G}(v') + \\tilde{F}_{v'}(J')] - [\\tilde{G}(v'') + \\tilde{F}_{v''}(J'')] $$\n这个表达式可以重新整理，以分开振动和转动的贡献：\n$$ \\tilde{\\nu} = [\\tilde{G}(v') - \\tilde{G}(v'')] + [\\tilde{F}_{v'}(J') - \\tilde{F}_{v''}(J'')] $$\n问题指定了振动基频跃迁，这意味着 $v''=0$ 和 $v'=1$。第一项 $[\\tilde{G}(1) - \\tilde{G}(0)]$ 是纯振动能量差，称为谱带原点 $\\tilde{\\nu}_{0}$。转动能项值取决于相应振动能态的转动常数，我们将其记为较高能态（$v'=1$）的 $\\tilde{B}'$ 和较低能态（$v''=0$）的 $\\tilde{B}''$。因此，谱线位置的表达式变为：\n$$ \\tilde{\\nu} = \\tilde{\\nu}_{0} + \\tilde{B}' J'(J'+1) - \\tilde{B}'' J''(J''+1) $$\n对于异核双原子分子，伴随振动跃迁的转动跃迁的电偶极选择定则是 $\\Delta J = J' - J'' = \\pm 1$。R支对应于 $\\Delta J = +1$ 的跃迁，这意味着 $J' = J'' + 1$。允许的初始转动量子数为 $J'' = 0, 1, 2, \\dots$。\n\n将 $J' = J'' + 1$ 代入通用方程，得到R支谱线位置 $\\tilde{\\nu}_{R}(J'')$ 的表达式：\n$$ \\tilde{\\nu}_{R}(J'') = \\tilde{\\nu}_{0} + \\tilde{B}' (J''+1)((J''+1)+1) - \\tilde{B}'' J''(J''+1) $$\n$$ \\tilde{\\nu}_{R}(J'') = \\tilde{\\nu}_{0} + \\tilde{B}' (J''+1)(J''+2) - \\tilde{B}'' J''(J''+1) $$\n这是一个有效的表达式。为了得到一个关于 $J''$ 更有条理的多项式形式，我们展开各项：\n$$ \\tilde{\\nu}_{R}(J'') = \\tilde{\\nu}_{0} + \\tilde{B}'(J''^{2} + 3J'' + 2) - \\tilde{B}''(J''^{2} + J'') $$\n$$ \\tilde{\\nu}_{R}(J'') = \\tilde{\\nu}_{0} + 2\\tilde{B}' + (3\\tilde{B}' - \\tilde{B}'')J'' + (\\tilde{B}' - \\tilde{B}'')J''^{2} $$\n这就是用 $\\tilde{\\nu}_{0}$、$\\tilde{B}'$、$\\tilde{B}''$ 和 $J''$ 表示的R支谱线位置的推导表达式。\n\n现在，我们使用给定的数据：$\\tilde{\\nu}_{0} = 2143.27\\,\\mathrm{cm^{-1}}$，$\\tilde{B}'' = 1.9225\\,\\mathrm{cm^{-1}}$ 和 $\\tilde{B}' = 1.9000\\,\\mathrm{cm^{-1}}$，来计算 R($0$)、R($1$)、R($2$) 和 R($3$) 谱线的位置。使用未展开的形式进行计算更为直接。\n\n对于R($0$)谱线，初始态为 $J''=0$：\n$$ \\tilde{\\nu}_{R}(0) = \\tilde{\\nu}_{0} + \\tilde{B}'(0+1)(0+2) - \\tilde{B}''(0)(0+1) = \\tilde{\\nu}_{0} + 2\\tilde{B}' $$\n$$ \\tilde{\\nu}_{R}(0) = 2143.27 + 2(1.9000) = 2143.27 + 3.8000 = 2147.07\\,\\mathrm{cm^{-1}} $$\n四舍五入到五位有效数字，得到 $2147.1\\,\\mathrm{cm^{-1}}$。\n\n对于R($1$)谱线，初始态为 $J''=1$：\n$$ \\tilde{\\nu}_{R}(1) = \\tilde{\\nu}_{0} + \\tilde{B}'(1+1)(1+2) - \\tilde{B}''(1)(1+1) = \\tilde{\\nu}_{0} + 6\\tilde{B}' - 2\\tilde{B}'' $$\n$$ \\tilde{\\nu}_{R}(1) = 2143.27 + 6(1.9000) - 2(1.9225) = 2143.27 + 11.4000 - 3.8450 = 2150.825\\,\\mathrm{cm^{-1}} $$\n四舍五入到五位有效数字，得到 $2150.8\\,\\mathrm{cm^{-1}}$。\n\n对于R($2$)谱线，初始态为 $J''=2$：\n$$ \\tilde{\\nu}_{R}(2) = \\tilde{\\nu}_{0} + \\tilde{B}'(2+1)(2+2) - \\tilde{B}''(2)(2+1) = \\tilde{\\nu}_{0} + 12\\tilde{B}' - 6\\tilde{B}'' $$\n$$ \\tilde{\\nu}_{R}(2) = 2143.27 + 12(1.9000) - 6(1.9225) = 2143.27 + 22.8000 - 11.5350 = 2154.535\\,\\mathrm{cm^{-1}} $$\n四舍五入到五位有效数字，得到 $2154.5\\,\\mathrm{cm^{-1}}$。\n\n对于R($3$)谱线，初始态为 $J''=3$：\n$$ \\tilde{\\nu}_{R}(3) = \\tilde{\\nu}_{0} + \\tilde{B}'(3+1)(3+2) - \\tilde{B}''(3)(3+1) = \\tilde{\\nu}_{0} + 20\\tilde{B}' - 12\\tilde{B}'' $$\n$$ \\tilde{\\nu}_{R}(3) = 2143.27 + 20(1.9000) - 12(1.9225) = 2143.27 + 38.0000 - 23.0700 = 2158.200\\,\\mathrm{cm^{-1}} $$\n四舍五入到五位有效数字，得到 $2158.2\\,\\mathrm{cm^{-1}}$。\n\n计算出的 R($0$)、R($1$)、R($2$) 和 R($3$) 的谱线位置，四舍五入到五位有效数字后，分别为 $2147.1\\,\\mathrm{cm^{-1}}$、$2150.8\\,\\mathrm{cm^{-1}}$、$2154.5\\,\\mathrm{cm^{-1}}$ 和 $2158.2\\,\\mathrm{cm^{-1}}$。", "answer": "$$\n\\boxed{\\begin{pmatrix} 2147.1 & 2150.8 & 2154.5 & 2158.2 \\end{pmatrix}}\n$$", "id": "2667078"}, {"introduction": "从理论模型到实验数据的分析是科学研究的关键一步。本练习模拟了光谱学家的核心工作：从观测到的谱线数据中提取分子的物理参数。你将通过一个计算实践，学习如何将 $R$ 支谱线位置拟合到一个理论模型中，从而精确地求解出上下振动态的转动常数 $B'$ 和 $B''$。这项练习不仅巩固了你对转振光谱理论的理解，还培养了关键的数据分析技能。[@problem_id:2667113]", "problem": "您的任务是构建一个程序，用于模拟双原子分子的红外（IR）转动-振动R-支谱线位置，然后通过将谱线位置拟合为有效转动指数的二次函数，来推断较高和较低振动态中的转动常数。您的设计必须且只能从以下基础原理出发：每个振动态的带有一次离心畸变的刚性转子转动项值、R-支跃迁的选择定则以及谱带原点的定义。具体来说，对于一个处于由 $v$ 索引的振动态的双原子分子，其转动项值定义为 $F_v(J) = B_v J(J+1) - D_v \\left[J(J+1)\\right]^2$（单位为反厘米），R-支的选择定则是 $\\Delta J = +1$（即 $J' = J'' + 1$），谱带原点为 $\\tilde{\\nu}_0 = G(v') - G(v'')$（单位为反厘米）。您的实现必须使用这些定义来模拟谱线位置，并且不得假定任何无法从这些定义推导出的其他表达式。\n\n对于从 $(v'', J'')$ 到 $(v', J')$ 的跃迁，其谱线位置（以反厘米为单位）是谱带原点与较高能态和较低能态转动项值之差的总和。仅使用上述定义，对每个测试用例，通过将谱带原点与较高能态减去较低能态的转动项值（其中 $J' = J'' + 1$）相加，来模拟指定整数 $J''$ 范围内的R-支谱线位置。\n\n然后，对于每个模拟的R-支，使用模型 $\\tilde{\\nu}_R(x) = a_0 + a_1 x + a_2 x^2$ 对谱线位置 $\\tilde{\\nu}_R$ 进行关于变量 $x \\equiv J'' + 1$ 的最小二乘二次拟合。从拟合得到的系数中，推导出较高能态和较低能态的转动常数 $B'$ 和 $B''$，过程中不得引用任何无法从上述基础原理推导出的公式。报告 $B'$ 和 $B''$ 的值（单位为反厘米），并报告 $B' < B''$ 是否成立。\n\n您的程序必须使用以下由物理上合理的参数集组成的测试套件。每个测试用例指定了谱带原点 $\\tilde{\\nu}_0$（单位：反厘米）、较高能态转动常数 $B'$（单位：反厘米）、较低能态转动常数 $B''$（单位：反厘米）、较高能态离心畸变常数 $D'$（单位：反厘米）、较低能态离心畸变常数 $D''$（单位：反厘米）以及 $J''$ 值的包含范围。您必须计算以反厘米为单位的谱线位置，然后进行二次拟合。对于所有报告的 $B$ 值，答案需以反厘米为单位表示，并四舍五入到小数点后恰好 $6$ 位。\n\n测试套件：\n- 案例 A（带有轻微离心畸变的理想情况）：$\\tilde{\\nu}_0 = 2143.26$, $B' = 1.92252$, $B'' = 1.93128$, $D' = 6.10\\times 10^{-6}$, $D'' = 6.121\\times 10^{-6}$, $J'' \\in \\{0, 1, \\dots, 15\\}$。\n- 案例 B（无离心畸变，曲率显著）：$\\tilde{\\nu}_0 = 3000.00$, $B' = 1.90000$, $B'' = 2.00000$, $D' = 0.0$, $D'' = 0.0$, $J'' \\in \\{0, 1, \\dots, 20\\}$。\n- 案例 C（由于 $B' = B''$ 而在 $x$ 上近似线性，但有畸变）：$\\tilde{\\nu}_0 = 1800.00$, $B' = 1.50000$, $B'' = 1.50000$, $D' = 5.00\\times 10^{-6}$, $D'' = 5.00\\times 10^{-6}$, $J'' \\in \\{0, 1, \\dots, 25\\}$。\n- 案例 D（畸变常数不等，较高的 $J''$ 窗口）：$\\tilde{\\nu}_0 = 2500.00$, $B' = 1.68000$, $B'' = 1.70000$, $D' = 6.00\\times 10^{-6}$, $D'' = 4.00\\times 10^{-6}$, $J'' \\in \\{10, 11, \\dots, 30\\}$。\n\n您的程序应生成单行输出，其中包含一个由方括号括起来的逗号分隔列表形式的结果，每个元素都是一个形如 $[B'\\_{\\text{fit}}, B''\\_{\\text{fit}}, \\text{is\\_Bprime\\_less\\_than\\_Bdoubleprime}]$ 的子列表。每个子列表的前两个条目是四舍五入到小数点后恰好 $6$ 位的拟合转动常数（单位为反厘米），最后一个条目是使用未四舍五入的拟合值判断 $B' < B''$ 是否成立的布尔值。例如，针对两个案例的输出看起来会是 $[[1.234000,1.345000,True],[1.500000,1.500000,False]]$。\n\n角度单位不适用。所有物理量都必须以反厘米为单位表示。您的程序的最终输出必须是与指定格式完全匹配的单行文本。不得打印任何其他文本。", "solution": "所提出的问题是计算物理化学领域一个明确定义的练习，具体涉及双原子分子转动-振动光谱的分析。该问题在科学上是合理的，表述正确，并且提供了解决问题所需的所有必要参数。因此，它被视为一个有效的问题。\n\n任务是首先模拟转振光谱R-支的谱线位置，然后通过多项式拟合从这些模拟数据中确定转动常数 $B'$ 和 $B''$。这个过程模拟了分析实验光谱数据时常用的一个流程。\n\n首先，我们必须根据所提供的基本原理，建立R-支谱线位置 $\\tilde{\\nu}_R(J'')$ 的理论表达式。一个转振能级 $(v, J)$ 的能量由振动项值 $G(v)$ 和转动项值 $F_v(J)$ 之和给出。从一个较低能态 $(v'', J'')$ 到一个较高能态 $(v', J')$ 的跃迁波数是它们项能量的差值：\n$$ \\tilde{\\nu} = [G(v') + F_{v'}(J')] - [G(v'') + F_{v''}(J'')] $$\n这可以被重新整理，方法是分别收集振动部分和转动部分。振动部分定义了谱带原点,  $\\tilde{\\nu}_0 = G(v') - G(v'')$。\n$$ \\tilde{\\nu} = \\tilde{\\nu}_0 + F_{v'}(J') - F_{v''}(J'') $$\n对于一个给定的振动态 $v$，其转动项值由下式给出：\n$$ F_v(J) = B_v J(J+1) - D_v \\left[J(J+1)\\right]^2 $$\n其中 $B_v$ 是转动常数，$D_v$ 是一阶离心畸变常数。\n\n对于R-支，选择定则是 $\\Delta J = J' - J'' = +1$，即 $J' = J'' + 1$。将这个规则和项值的表达式代入跃迁波数方程，我们得到R-支谱线位置作为较低能态转动量子数 $J''$ 的函数表达式：\n$$ \\tilde{\\nu}_R(J'') = \\tilde{\\nu}_0 + \\left( B' (J''+1)(J''+2) - D' \\left[(J''+1)(J''+2)\\right]^2 \\right) - \\left( B'' J''(J''+1) - D'' \\left[J''(J''+1)\\right]^2 \\right) $$\n在这里，单撇号表示较高振动态 $v'$（因此 $B' \\equiv B_{v'}$ 且 $D' \\equiv D_{v'}$），双撇号表示较低振动态 $v''$（因此 $B'' \\equiv B_{v''}$ 且 $D'' \\equiv D_{v''}$）。该方程将用于在给定的 $J''$ 范围内模拟“实验”谱线位置。\n\n问题的第二部分要求将这些谱线位置拟合为一个关于新变量 $x \\equiv J'' + 1$ 的二次模型。该模型如下：\n$$ \\tilde{\\nu}_R(x) = a_0 + a_1 x + a_2 x^2 $$\n为了将拟合系数 $a_0$, $a_1$ 和 $a_2$ 与物理常数联系起来，我们必须用 $x$ 来重新表示 $\\tilde{\\nu}_R$ 的理论公式。我们将 $J'' = x-1$ 代入表达式的理想刚性转子部分（暂时忽略畸变项，因为拟合模型只是二次的）：\n$$ \\tilde{\\nu}_R(J'') \\approx \\tilde{\\nu}_0 + B'(J''+1)(J''+2) - B''J''(J''+1) $$\n代入 $x=J''+1$ 得到 $J''+2 = x+1$ 和 $J'' = x-1$:\n$$ \\tilde{\\nu}_R(x) \\approx \\tilde{\\nu}_0 + B'x(x+1) - B''(x-1)x $$\n展开并按 $x$ 的幂次合并同类项：\n$$ \\tilde{\\nu}_R(x) \\approx \\tilde{\\nu}_0 + (B'x^2 + B'x) - (B''x^2 - B''x) $$\n$$ \\tilde{\\nu}_R(x) \\approx \\tilde{\\nu}_0 + (B' + B'')x + (B' - B'')x^2 $$\n将此表达式与拟合模型 $\\tilde{\\nu}_R(x) = a_0 + a_1 x + a_2 x^2$ 进行比较，我们可以确定各项系数：\n$$ a_0 \\approx \\tilde{\\nu}_0 $$\n$$ a_1 \\approx B' + B'' $$\n$$ a_2 \\approx B' - B'' $$\n这些关系是近似的，因为在推导过程中忽略了离心畸变项（该项贡献了 $x$ 的三次和四次项），而这些项在模拟数据中是存在的。最小二乘拟合将找到最佳的二次近似，而高阶项的影响将导致拟合参数与这种理想关系产生轻微偏差。尽管如此，问题要求我们使用这些推导出的关系从拟合系数中求出转动常数。\n\n现在我们为 $B'$ 和 $B''$ 建立一个二元线性方程组：\n$$ a_1 = B' + B'' $$\n$$ a_2 = B' - B'' $$\n将这两个方程相加得到 $a_1 + a_2 = 2B'$，由此得出：\n$$ B' = \\frac{a_1 + a_2}{2} $$\n用第一个方程减去第二个方程得到 $a_1 - a_2 = 2B''$，由此得出：\n$$ B'' = \\frac{a_1 - a_2}{2} $$\n这些就是从二次拟合系数中推导转动常数所需的公式。布尔条件 $B' < B''$ 可以通过比较由这些公式得到的未四舍五入的数值来检验。这个比较等价于检验 $(a_1+a_2)/2 < (a_1-a_2)/2$，可简化为 $a_2 < -a_2$，即 $2a_2 < 0$，此式当且仅当 $a_2 < 0$ 时成立。\n\n计算流程如下：\n1. 对于每个测试用例，在指定范围内为 $J''$ 生成一个整数值数组。\n2. 计算相应的 $x$ 值数组，其中 $x = J'' + 1$。\n3. 使用包含离心畸变常数 $D'$ 和 $D''$ 的 $\\tilde{\\nu}_R(J'')$ 完整表达式，计算模拟的谱线位置。\n4. 使用2次多项式，对谱线位置（y值）与 $x$ 值（x值）进行最小二乘多项式拟合。这将得出系数 $a_2, a_1, a_0$。\n5. 使用推导出的公式计算拟合的转动常数 $B'_{\\text{fit}} = (a_1 + a_2)/2$ 和 $B''_{\\text{fit}} = (a_1 - a_2)/2$。\n6. 确定表达式 $B'_{\\text{fit}} < B''_{\\text{fit}}$ 的布尔值。\n7. 按规定格式化结果：四舍五入后的 $B'_{\\text{fit}}$、四舍五入后的 $B''_{\\text{fit}}$ 以及布尔标志，并为所有测试用例收集这些结果。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Simulates R-branch rovibrational line positions for a diatomic molecule,\n    fits them to a quadratic model, and infers the rotational constants.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case: (nu0, B_prime, B_double_prime, D_prime, D_double_prime, J_range_start, J_range_end)\n    test_cases = [\n        (2143.26, 1.92252, 1.93128, 6.10e-6, 6.121e-6, 0, 15),\n        (3000.00, 1.90000, 2.00000, 0.0, 0.0, 0, 20),\n        (1800.00, 1.50000, 1.50000, 5.00e-6, 5.00e-6, 0, 25),\n        (2500.00, 1.68000, 1.70000, 6.00e-6, 4.00e-6, 10, 30),\n    ]\n\n    results = []\n    for case in test_cases:\n        nu0, Bp, Bpp, Dp, Dpp, J_min, J_max = case\n\n        # 1. Generate J'' and x = J'' + 1 values.\n        # The range is inclusive, so J_max + 1.\n        J_double_prime = np.arange(J_min, J_max + 1)\n        x_var = J_double_prime + 1\n\n        # 2. Simulate R-branch line positions using the full expression.\n        # F_v(J) = B_v * J*(J+1) - D_v * (J*(J+1))^2\n        # nu_R(J'') = nu0 + F_v'(J''+1) - F_v''(J'')\n        \n        # Upper state term value F_v'(J''+1)\n        J_prime = J_double_prime + 1\n        term_val_prime = Bp * J_prime * (J_prime + 1) - Dp * (J_prime * (J_prime + 1))**2\n        \n        # Lower state term value F_v''(J'')\n        term_val_double_prime = Bpp * J_double_prime * (J_double_prime + 1) - Dpp * (J_double_prime * (J_double_prime + 1))**2\n\n        # Line positions nu_R\n        nu_R = nu0 + term_val_prime - term_val_double_prime\n\n        # 3. Perform a least-squares quadratic fit: nu_R = a2*x^2 + a1*x + a0\n        # np.polyfit returns coefficients in order of decreasing power, [a2, a1, a0].\n        coeffs = np.polyfit(x_var, nu_R, 2)\n        a2, a1, a0 = coeffs[0], coeffs[1], coeffs[2]\n\n        # 4. Deduce B' and B'' from the fitted coefficients a1 and a2.\n        # a1 = B' + B''\n        # a2 = B' - B''\n        # Solving for B' and B'':\n        # B' = (a1 + a2) / 2\n        # B'' = (a1 - a2) / 2\n        B_prime_fit = (a1 + a2) / 2\n        B_double_prime_fit = (a1 - a2) / 2\n\n        # 5. Check the condition B'_fit < B''_fit using unrounded values.\n        is_Bprime_less_than_Bdoubleprime = B_prime_fit < B_double_prime_fit\n\n        # 6. Round the fitted B values to 6 decimal places for reporting.\n        B_prime_fit_rounded = round(B_prime_fit, 6)\n        B_double_prime_fit_rounded = round(B_double_prime_fit, 6)\n        \n        # Format as a list for final output\n        results.append([B_prime_fit_rounded, B_double_prime_fit_rounded, is_Bprime_less_than_Bdoubleprime])\n\n    # Final print statement in the exact required format.\n    # The format requires floats to have 6 decimal places, which can be achieved with formatting.\n    # The list comprehension builds the string for each sublist.\n    formatted_results = [f\"[{res[0]:.6f},{res[1]:.6f},{'True' if res[2] else 'False'}]\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2667113"}]}