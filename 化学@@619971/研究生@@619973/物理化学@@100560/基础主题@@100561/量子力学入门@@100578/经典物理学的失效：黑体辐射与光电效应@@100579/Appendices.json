{"hands_on_practices": [{"introduction": "这个首个练习将深入探讨 Planck 黑体辐射定律中一个微妙但至关重要的方面。你将通过数学方法探究，为何辐射光谱的峰值在使用频率 $\\nu$ 或波长 $\\lambda$ 作为变量进行绘制时会出现在不同的位置。通过推导并求解这些峰值的条件，你将巩固对谱密度如何变换的理解，并认识到在物理学中严谨的数学处理是何等重要 [@problem_id:2639775]。", "problem": "一个处于温度 $T$ 的热力学平衡状态的空腔发射电磁辐射，其特性由普朗克光谱辐射亮度描述。令 $B_{\\nu}(\\nu,T)$ 表示单位频率间隔的光谱辐射亮度，$B_{\\lambda}(\\lambda,T)$ 表示单位波长间隔的光谱辐射亮度。普朗克定律由下式给出：\n$$\nB_{\\nu}(\\nu,T) \\;=\\; \\frac{2 h \\nu^{3}}{c^{2}} \\,\\frac{1}{\\exp\\!\\left(\\frac{h \\nu}{k_{\\mathrm B} T}\\right)-1}, \n\\qquad\nB_{\\lambda}(\\lambda,T) \\;=\\; \\frac{2 h c^{2}}{\\lambda^{5}} \\,\\frac{1}{\\exp\\!\\left(\\frac{h c}{\\lambda k_{\\mathrm B} T}\\right)-1},\n$$\n其中 $h$ 是普朗克常数，$k_{\\mathrm B}$ 是玻尔兹曼常数，$c$ 是真空中的光速。这两种光谱密度通过换元法则 $B_{\\lambda}(\\lambda,T)\\, \\mathrm d\\lambda \\,=\\, B_{\\nu}(\\nu,T)\\, \\mathrm d\\nu$（其中 $\\nu = c/\\lambda$）相关联。\n\n仅使用微积分和上述关系作为出发点，完成以下任务：\n\n1. 基于换元法则，从数学上解释为什么 $B_{\\nu}$ 作为 $\\nu$ 的函数的峰值（最大值）所对应的无量纲变量 $x = h \\nu/(k_{\\mathrm B} T)$ 的值，与 $B_{\\lambda}$ 作为 $\\lambda$ 的函数的峰值所对应的无量纲变量 $y = h c/(\\lambda k_{\\mathrm B} T)$ 的值不同。\n\n2. 通过对 $B_{\\nu}(\\nu,T)$ 和 $B_{\\lambda}(\\lambda,T)$ 各自的自然自变量求导并令其为零，确定其最大值的平稳条件。数值求解这些条件，得到使函数最大化的值 $x_{\\nu}^{\\ast}$ 和 $x_{\\lambda}^{\\ast}$。\n\n3. 计算数值比率 $x_{\\nu}^{\\ast}/x_{\\lambda}^{\\ast}$。将最终答案表示为一个无量纲数，并四舍五入到六位有效数字。", "solution": "该问题要求对黑体辐射的普朗克分布进行多步分析，重点关注当其表示为频率函数与波长函数时其最大值的位置。解答按要求分三部分进行。\n\n首先，我们必须从数学上解释为什么单位频率的光谱辐射亮度 $B_{\\nu}(\\nu,T)$ 和单位波长的光谱辐射亮度 $B_{\\lambda}(\\lambda,T)$ 的峰值不会出现在对应的频率和波长值上。这两个分布不是彼此的简单重述，而是通过改变了函数形式的变量替换相关联。辐射到微小频率区间 $[\\nu, \\nu+\\mathrm d\\nu]$ 内的能量必须等于辐射到相应波长区间 $[\\lambda, \\lambda+\\mathrm d\\lambda]$ 内的能量。由于频率 $\\nu$ 和波长 $\\lambda$ 成反比关系，一个量的增加对应于另一个量的减少，因此我们必须使能量元的大小相等：$B_{\\nu}(\\nu,T) |\\mathrm d\\nu| = B_{\\lambda}(\\lambda,T) |\\mathrm d\\lambda|$。这意味着函数本身通过变量变换的雅可比式相关联：\n$$\nB_{\\lambda}(\\lambda,T) = B_{\\nu}(\\nu,T) \\left|\\frac{\\mathrm d\\nu}{\\mathrm d\\lambda}\\right|\n$$\n给定关系 $\\nu = c/\\lambda$，雅可比式为：\n$$\n\\left|\\frac{\\mathrm d\\nu}{\\mathrm d\\lambda}\\right| = \\left|-\\frac{c}{\\lambda^2}\\right| = \\frac{c}{\\lambda^2}\n$$\n因此，两种光谱辐射亮度函数之间的关系是：\n$$\nB_{\\lambda}(\\lambda,T) = B_{\\nu}(\\nu(\\lambda), T) \\frac{c}{\\lambda^2}\n$$\n为了找到 $B_{\\lambda}$ 关于 $\\lambda$ 的最大值，我们必须将其导数设为零：$\\frac{\\mathrm{d}B_{\\lambda}}{\\mathrm{d}\\lambda} = 0$。应用乘法法则和链式法则 $\\frac{\\mathrm{d}B_{\\nu}}{\\mathrm{d}\\lambda} = \\frac{\\mathrm{d}B_{\\nu}}{\\mathrm{d}\\nu}\\frac{\\mathrm{d}\\nu}{\\mathrm{d}\\lambda} = \\frac{\\mathrm{d}B_{\\nu}}{\\mathrm{d}\\nu}\\left(-\\frac{c}{\\lambda^2}\\right)$：\n$$\n\\frac{\\mathrm{d}B_{\\lambda}}{\\mathrm{d}\\lambda} = \\frac{\\mathrm{d}}{\\mathrm{d}\\lambda}\\left(B_{\\nu} \\frac{c}{\\lambda^2}\\right) = \\frac{\\mathrm{d}B_{\\nu}}{\\mathrm{d}\\lambda}\\frac{c}{\\lambda^2} + B_{\\nu} \\left(-\\frac{2c}{\\lambda^3}\\right) = \\left(\\frac{\\mathrm{d}B_{\\nu}}{\\mathrm{d}\\nu}\\left(-\\frac{c}{\\lambda^2}\\right)\\right)\\frac{c}{\\lambda^2} - \\frac{2c}{\\lambda^3}B_{\\nu} = 0\n$$\n$$\n-\\frac{c^2}{\\lambda^4}\\frac{\\mathrm{d}B_{\\nu}}{\\mathrm{d}\\nu} - \\frac{2c}{\\lambda^3}B_{\\nu} = 0\n$$\n频率分布 $B_{\\nu}$ 的峰值出现在频率 $\\nu^{\\ast}$ 处，此时 $\\frac{\\mathrm{d}B_{\\nu}}{\\mathrm{d}\\nu} = 0$。让我们在对应的波长 $\\lambda' = c/\\nu^{\\ast}$ 处检验 $B_{\\lambda}$ 峰值的条件。在此波长下，方程的第一项 $-\\frac{c^2}{(\\lambda')^4}\\frac{\\mathrm{d}B_{\\nu}}{\\mathrm{d}\\nu}$ 变为零。方程简化为：\n$$\n-\\frac{2c}{(\\lambda')^3}B_{\\nu}(\\nu^{\\ast}, T) = 0\n$$\n由于 $B_{\\nu}$ 在其最大值处是严格为正的，因此该方程不成立。这证明了 $B_{\\lambda}(\\lambda,T)$ 的最大值并不出现在对应于 $B_{\\nu}(\\nu,T)$ 频率最大值的波长 $\\lambda' = c/\\nu^{\\ast}$ 处。其数学原因是存在一个非恒定因子 $\\frac{c}{\\lambda^2}$，它以不同的方式对分布进行加权。最大化函数 $f(x)$ 与最大化函数 $g(x)f(x)$ 是不同的问题，除非 $g(x)$ 是一个常数。\n\n第二，我们确定最大值的平稳条件。对于 $B_{\\nu}(\\nu,T)$，我们引入无量纲变量 $x = \\frac{h\\nu}{k_{\\mathrm{B}}T}$。普朗克函数变为：\n$$\nB_{\\nu}(\\nu,T) = \\frac{2 h}{c^2} \\left(\\frac{k_{\\mathrm B} T}{h}\\right)^3 x^3 \\frac{1}{\\exp(x)-1}\n$$\n为了求最大值，我们只需要最大化表达式中依赖于 $\\nu$ 的部分，即 $f(x) = \\frac{x^3}{\\exp(x)-1}$。将其关于 $x$ 的导数设为零：\n$$\n\\frac{\\mathrm{d}f}{\\mathrm{d}x} = \\frac{3x^2(\\exp(x)-1) - x^3\\exp(x)}{(\\exp(x)-1)^2} = 0\n$$\n对于 $x>0$，这简化为 $3(\\exp(x)-1) - x\\exp(x) = 0$，可以重新整理为超越方程：\n$$\n3 - x = 3\\exp(-x)\n$$\n这是使函数取最大值的值 $x_{\\nu}^{\\ast}$ 的平稳条件。\n\n对于 $B_{\\lambda}(\\lambda,T)$，我们使用无量纲变量 $y = \\frac{hc}{\\lambda k_{\\mathrm{B}}T}$。该函数变为：\n$$\nB_{\\lambda}(\\lambda,T) = \\frac{2hc^2}{\\lambda^5} \\frac{1}{\\exp(y)-1} = \\frac{2hc^2}{\\left(\\frac{hc}{yk_{\\mathrm B}T}\\right)^5} \\frac{1}{\\exp(y)-1} = \\frac{2k_{\\mathrm B}^5 T^5}{h^4 c^3} \\frac{y^5}{\\exp(y)-1}\n$$\n为了求最大值，我们最大化 $g(y) = \\frac{y^5}{\\exp(y)-1}$。将其关于 $y$ 的导数设为零：\n$$\n\\frac{\\mathrm{d}g}{\\mathrm{d}y} = \\frac{5y^4(\\exp(y)-1) - y^5\\exp(y)}{(\\exp(y)-1)^2} = 0\n$$\n对于 $y>0$，这简化为 $5(\\exp(y)-1) - y\\exp(y) = 0$，得到超越方程：\n$$\n5 - y = 5\\exp(-y)\n$$\n这是使函数取最大值的值的平稳条件，问题中将其记为 $x_{\\lambda}^{\\ast}$。\n\n这些超越方程必须通过数值方法求解。\n方程 $3-x=3\\exp(-x)$ 的解是 $x_{\\nu}^{\\ast} \\approx 2.82143937$。\n方程 $5-y=5\\exp(-y)$ 的解是 $x_{\\lambda}^{\\ast} \\approx 4.96511423$。\n\n第三，我们计算所要求的比率。\n这两个值的比率是：\n$$\n\\frac{x_{\\nu}^{\\ast}}{x_{\\lambda}^{\\ast}} = \\frac{2.82143937...}{4.96511423...} \\approx 0.56825316...\n$$\n按要求四舍五入到六位有效数字，得到 $0.568253$。", "answer": "$$\\boxed{0.568253}$$", "id": "2639775"}, {"introduction": "在 Planck 定律的理论基础上，本练习将转向实验数据的分析。你将利用描述黑体总辐射功率的 Stefan-Boltzmann 定律，来分析一组给定的温度和功率测量数据。这个实践将让你从数据中提取 Stefan-Boltzmann 常数 $\\sigma$ 的值，并进一步揭示宏观热力学与量子力学之间的深刻联系——你将用 $\\sigma$ 的值来推算出 Planck 常数 $h$ [@problem_id:2639828]。", "problem": "您会获得多个合成的实验数据集，这些数据集报告了近黑体等温源在不同绝对温度下发射的总辐射功率。假设该源处于真空中，其周围环境的入射辐射可以忽略不计。基本原理是，黑体的谱辐亮度遵循 Planck 分布，并且对于理想黑体，总半球辐射出射度与绝对温度的四次方成正比。一个发射率为 $\\,\\varepsilon\\,$、面积为 $\\,A\\,$ 的近黑体表面，其发射的总功率为 $\\,P \\approx \\varepsilon\\,A\\,\\sigma\\,T^{4}\\,$，其中 $\\,\\sigma\\,$ 是 Stefan–Boltzmann 常数。您的任务是，对每个数据集使用强制通过原点的普通最小二乘法 (OLS) 分析 $\\,P\\,$ 与 $\\,T^{4}\\,$ 的关系，以估计 $\\,\\sigma\\,$，然后利用已知的 Boltzmann 常数 $\\,k_{\\mathrm B}\\,$ 和光速 $\\,c\\,$，从拟合出的 $\\,\\sigma\\,$ 推断出 Planck 常数 $\\,h\\,$。您不得在基本定律之外假设任何经验性简化公式；相反，您应实现一个通过对 Planck 定律进行频率和立体角积分而得出的方法。\n\n使用以下常量（国际单位制 (SI)）：\n- Boltzmann 常数: $\\,k_{\\mathrm B} = 1.380649\\times 10^{-23}\\,\\mathrm{J\\,K^{-1}}$。\n- 真空中的光速: $\\,c = 299792458\\,\\mathrm{m\\,s^{-1}}$。\n- 圆周率: $\\,\\pi \\approx 3.141592653589793\\,$。\n\n对于每个数据集，定义 $\\,x_i = T_i^{4}\\,$ 和 $\\,y_i = P_i\\,$，并计算强制通过原点的 OLS 斜率\n$$\nm \\;=\\; \\frac{\\sum_i x_i\\,y_i}{\\sum_i x_i^{2}}\\,,\n$$\n在模型 $\\,P \\approx \\varepsilon\\,A\\,\\sigma\\,T^{4}\\,$ 下，该斜率是对 $\\,m \\approx \\varepsilon\\,A\\,\\sigma\\,$ 的估计。使用该斜率来恢复\n$$\n\\hat{\\sigma} \\;=\\; \\frac{m}{\\varepsilon\\,A}\\,.\n$$\n然后，利用对 Planck 分布在所有频率和发射半球上积分所隐含的关系，推导出一个表达式，使您能够从 $\\,\\hat{\\sigma}\\,$ 以及 $\\,k_{\\mathrm B}\\,$和$\\,c\\,$计算出 $\\,h\\,$，并对 $\\,\\hat{h}\\,$ 进行数值计算。\n\n单位和数值格式要求：\n- 温度 $\\,T\\,$ 的单位是开尔文 ($\\,\\mathrm{K}\\,$)，功率 $\\,P\\,$ 的单位是瓦特 ($\\,\\mathrm{W}\\,$)，面积 $\\,A\\,$ 的单位是平方米 ($\\,\\mathrm{m^2}\\,$)，发射率 $\\,\\varepsilon\\,$ 是无量纲的。\n- 报告的 $\\,\\hat{\\sigma}\\,$ 单位为 $\\,\\mathrm{W\\,m^{-2}\\,K^{-4}}\\,$，$\\,\\hat{h}\\,$ 单位为 $\\,\\mathrm{J\\,s}\\,$。\n- 对于输出，将每个浮点数格式化为科学记数法，小数点后恰好有五位数字（即，使用一个尾数，其小数点前有一位数字，小数点后有五位数字，后跟 $\\,\\mathrm{e}\\,$ 和一个带符号的两位或三位指数，例如 $\\,1.23456\\mathrm{e}{-03}\\,$）。\n\n测试套件（每个案例列出了 $\\,\\varepsilon\\,$、$\\,A\\,$、温度 $\\,\\{T_i\\}\\,$ 和测得的总功率 $\\,\\{P_i\\}\\,$）：\n- 案例 $\\,1\\,$（理想情况，近黑体，中等面积）：\n  - $\\,\\varepsilon = 0.98\\,$, $\\,A = 0.05\\,\\mathrm{m^2}\\,$.\n  - $\\,T\\,\\mathrm{[K]}$: $[400,500,600,700,800]$.\n  - $\\,P\\,\\mathrm{[W]}$: $[61.12721469,\\,188.655216581875,\\,340.091457104176,\\,685.113880020931,\\,1133.066827390976]$.\n- 案例 $\\,2\\,$（小面积，低功率，基本为黑体）：\n  - $\\,\\varepsilon = 1.0\\,$, $\\,A = 1.0\\times 10^{-4}\\,\\mathrm{m^2}\\,$.\n  - $\\,T\\,\\mathrm{[K]}$: $[100,200,300,400]$.\n  - $\\,P\\,\\mathrm{[W]}$: $[1.5670374419\\times 10^{-3},\\,8.0725990704\\times 10^{-3},\\,4.79300327939\\times 10^{-2},\\,1.43157581\\times 10^{-1}]$.\n- 案例 $\\,3\\,$（边界情况：高温，窄范围，发射率小于1）：\n  - $\\,\\varepsilon = 0.85\\,$, $\\,A = 1.0\\times 10^{-2}\\,\\mathrm{m^2}\\,$.\n  - $\\,T\\,\\mathrm{[K]}$: $[1000,1020,980,1010,990]$.\n  - $\\,P\\,\\mathrm{[W]}$: $[4.82781825615\\times 10^{2},\\,5.205075388531092\\times 10^{2},\\,4.450695094642045\\times 10^{2},\\,5.011522204820897\\times 10^{2},\\,4.635898185783018\\times 10^{2}]$.\n- 案例 $\\,4\\,$（边界情况：从低到高的 $\\,T\\,$ 跨度，非黑体，微小的加性失真）：\n  - $\\,\\varepsilon = 0.60\\,$, $\\,A = 2.0\\times 10^{-2}\\,\\mathrm{m^2}\\,$.\n  - $\\,T\\,\\mathrm{[K]}$: $[300,450,650,900]$.\n  - $\\,P\\,\\mathrm{[W]}$: $[6.311603935268,\\,27.10249492229425,\\,122.96367283579426,\\,444.93991875672]$.\n\n您的程序应为每个案例计算数值对 $[\\hat{\\sigma},\\hat{h}]$，使用上文指定的单位，将这两个值格式化为小数点后恰好有五位数字的科学记数法，并生成单行输出，该行包含一个由方括号括起来的、由这些数值对组成的逗号分隔列表。具体来说，输出必须采用\n$[[\\hat{\\sigma}_1,\\hat{h}_1],[\\hat{\\sigma}_2,\\hat{h}_2],[\\hat{\\sigma}_3,\\hat{h}_3],[\\hat{\\sigma}_4,\\hat{h}_4]]$\n的格式，并且行中任何地方都不能有空格。", "solution": "### 解法推导\n首要任务是建立 Stefan-Boltzmann 常数 $\\,\\sigma\\,$ 与基本常数 $\\,h\\,$、$\\,k_{\\mathrm B}\\,$ 和 $\\,c\\,$ 之间的关系。这种关系源于对谱辐亮度的 Planck 分布进行积分。\n\n1.  **Planck 定律**：在绝对温度 $\\,T\\,$ 和频率 $\\,\\nu\\,$下，黑体的谱辐亮度 $\\,B_{\\nu}\\,$（单位面积、单位立体角、单位频率的功率）由 Planck 定律给出：\n    $$\n    B_{\\nu}(\\nu, T) = \\frac{2 h \\nu^3}{c^2} \\frac{1}{e^{h\\nu / (k_{\\mathrm B} T)} - 1}\n    $$\n    其中 $\\,h\\,$ 是 Planck 常数，$\\,k_{\\mathrm B}\\,$ 是 Boltzmann 常数，$\\,c\\,$ 是光速。\n\n2.  **谱出射度**：为了找到从单位面积辐射到半球空间的总功率，我们必须首先找到谱出射度 $\\,M_{\\nu}\\,$。对于像黑体这样的朗伯各向同性辐射体，出射度与辐亮度通过一个因子 $\\,\\pi\\,$ 相关联。\n    $$\n    M_{\\nu}(\\nu, T) = \\pi B_{\\nu}(\\nu, T) = \\frac{2 \\pi h \\nu^3}{c^2} \\frac{1}{e^{h\\nu / (k_{\\mathrm B} T)} - 1}\n    $$\n\n3.  **总出射度 (Stefan-Boltzmann 定律)**：总出射度 $\\,M(T)\\,$ 是通过将谱出射度在从 $\\,0\\,$ 到 $\\,\\infty\\,$ 的所有频率上积分得到的。\n    $$\n    M(T) = \\int_0^{\\infty} M_{\\nu}(\\nu, T) \\, d\\nu = \\int_0^{\\infty} \\frac{2 \\pi h \\nu^3}{c^2} \\frac{1}{e^{h\\nu / (k_{\\mathrm B} T)} - 1} \\, d\\nu\n    $$\n    为了求解这个积分，我们进行换元。令 $\\,x = \\frac{h\\nu}{k_{\\mathrm B} T}\\,$。那么 $\\,\\nu = \\frac{k_{\\mathrm B} T}{h} x\\,$ 且 $\\,d\\nu = \\frac{k_{\\mathrm B} T}{h} dx\\,$。积分限仍然是 $\\,0\\,$ 和 $\\,\\infty\\,$。\n    将这些代入积分中：\n    $$\n    M(T) = \\frac{2 \\pi h}{c^2} \\int_0^{\\infty} \\left(\\frac{k_{\\mathrm B} T}{h} x\\right)^3 \\frac{1}{e^x - 1} \\left(\\frac{k_{\\mathrm B} T}{h}\\right) \\, dx\n    $$\n    我们可以将常数和依赖于 $\\,T\\,$ 的项组合起来并移到积分外：\n    $$\n    M(T) = \\frac{2 \\pi h}{c^2} \\frac{(k_{\\mathrm B} T)^4}{h^4} \\int_0^{\\infty} \\frac{x^3}{e^x - 1} \\, dx = \\left( \\frac{2 \\pi k_B^4}{c^2 h^3} \\int_0^{\\infty} \\frac{x^3}{e^x - 1} \\, dx \\right) T^4\n    $$\n    该积分是一个与 Bose-Einstein 积分相关的标准形式，其求值结果为 Gamma 函数 $\\,\\Gamma(z)\\,$ 和 Riemann zeta 函数 $\\,\\zeta(z)\\,$ 的乘积。\n    $$\n    \\int_0^{\\infty} \\frac{x^{s-1}}{e^x - 1} \\, dx = \\Gamma(s)\\zeta(s)\n    $$\n    在我们的例子中，$\\,s-1 = 3\\,$，所以 $\\,s=4\\,$。\n    $$\n    \\int_0^{\\infty} \\frac{x^3}{e^x - 1} \\, dx = \\Gamma(4)\\zeta(4) = (3!) \\left(\\frac{\\pi^4}{90}\\right) = 6 \\cdot \\frac{\\pi^4}{90} = \\frac{\\pi^4}{15}\n    $$\n    将此结果代回到 $\\,M(T)\\,$ 的表达式中：\n    $$\n    M(T) = \\left( \\frac{2 \\pi k_B^4}{c^2 h^3} \\cdot \\frac{\\pi^4}{15} \\right) T^4 = \\left( \\frac{2 \\pi^5 k_B^4}{15 c^2 h^3} \\right) T^4\n    $$\n    Stefan-Boltzmann 定律表明 $\\,M(T) = \\sigma T^4\\,$。通过将我们推导出的表达式与该定律进行比较，我们确定 Stefan-Boltzmann 常数 $\\,\\sigma\\,$ 为：\n    $$\n    \\sigma = \\frac{2 \\pi^5 k_B^4}{15 c^2 h^3}\n    $$\n\n4.  **推断 Planck 常数**：问题要求我们从 $\\,\\sigma\\,$ 的测量值来估计 $\\,h\\,$。我们重排方程以求解 $\\,h\\,$：\n    $$\n    h^3 = \\frac{2 \\pi^5 k_B^4}{15 c^2 \\sigma} \\implies h = \\left( \\frac{2 \\pi^5 k_B^4}{15 c^2 \\sigma} \\right)^{1/3}\n    $$\n    这是计算所需的最终公式。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the blackbody radiation problem by estimating Stefan-Boltzmann\n    and Planck constants from synthetic experimental data.\n    \"\"\"\n    # Define fundamental constants as per the problem statement\n    k_B = 1.380649e-23  # Boltzmann constant in J/K\n    c = 299792458.0     # Speed of light in m/s\n    pi = 3.141592653589793 # Pi\n\n    # Define the test cases from the problem statement.\n    # Each case: (emissivity, area, Temperatures [K], Powers [W])\n    test_cases = [\n        (0.98, 0.05,\n         np.array([400.0, 500.0, 600.0, 700.0, 800.0]),\n         np.array([61.12721469, 188.655216581875, 340.091457104176, 685.113880020931, 1133.066827390976])),\n        (1.0, 1.0e-4,\n         np.array([100.0, 200.0, 300.0, 400.0]),\n         np.array([1.5670374419e-3, 8.0725990704e-3, 4.79300327939e-2, 1.43157581e-1])),\n        (0.85, 1.0e-2,\n         np.array([1000.0, 1020.0, 980.0, 1010.0, 990.0]),\n         np.array([4.82781825615e2, 5.205075388531092e2, 4.450695094642045e2, 5.011522204820897e2, 4.635898185783018e2])),\n        (0.60, 2.0e-2,\n         np.array([300.0, 450.0, 650.0, 900.0]),\n         np.array([6.311603935268, 27.10249492229425, 122.96367283579426, 444.93991875672]))\n    ]\n\n    results_list = []\n    for case in test_cases:\n        epsilon, A, T_vals, P_vals = case\n        \n        # Define x_i = T_i^4 and y_i = P_i\n        x = T_vals**4\n        y = P_vals\n        \n        # Compute the forced-through-origin OLS slope m = sum(x*y) / sum(x^2)\n        # The model is P = (epsilon * A * sigma) * T^4, so m estimates (epsilon * A * sigma)\n        sum_xy = np.sum(x * y)\n        sum_x_squared = np.sum(x**2)\n        m_hat = sum_xy / sum_x_squared\n        \n        # Estimate sigma from the slope m_hat\n        # m_hat = epsilon * A * sigma_hat => sigma_hat = m_hat / (epsilon * A)\n        sigma_hat = m_hat / (epsilon * A)\n        \n        # Infer Planck's constant h from the estimated sigma_hat.\n        # sigma = (2 * pi^5 * k_B^4) / (15 * c^2 * h^3)\n        # h^3 = (2 * pi^5 * k_B^4) / (15 * c^2 * sigma)\n        # h = ((2 * pi^5 * k_B^4) / (15 * c^2 * sigma))^(1/3)\n        numerator = 2.0 * (pi**5) * (k_B**4)\n        denominator = 15.0 * (c**2) * sigma_hat\n        h_hat = (numerator / denominator)**(1.0/3.0)\n        \n        # Format the results to scientific notation with 5 digits after the decimal point\n        sigma_str = \"{:.5e}\".format(sigma_hat)\n        h_str = \"{:.5e}\".format(h_hat)\n        \n        results_list.append(f\"[{sigma_str},{h_str}]\")\n\n    final_output = f\"[{','.join(results_list)}]\"\n    print(final_output)\n\nsolve()\n```", "id": "2639828"}, {"introduction": "我们最后的练习将焦点转移到经典物理学的第二个主要“失败”案例：光电效应。你将分析一组关于遏止电压 $V_{\\mathrm{s}}$ 随入射光频率 $\\nu$ 变化的模拟实验数据，这是证实 Einstein 光量子理论的奠基性实验。通过进行线性回归分析，你不仅能确定材料的逸出功 $\\phi$，还将获得 Planck 常数 $h$ 的一个独立实验值，从而进一步巩固其作为自然界普适常数的地位 [@problem_id:2639808]。", "problem": "一个在洁净金属表面上进行的单色光电效应实验，产生了一组测量的截止电压作为入射光频率的函数。仅假设以下基本事实：(i) 光能以离散的量子形式传递，每个量子的能量为 $h\\,\\nu$，其中 $h$ 是普朗克常数，$\\nu$ 是光频率；(ii) 发射电子的最大动能是光子能量与表面逸出功 $\\phi$ 之间的差值；(iii) 截止电压 $V_{\\mathrm{s}}$ 由最大电子动能与电功 $e\\,V_{\\mathrm{s}}$ 相等来定义，其中 $e$ 是元电荷。同时假设所测量的截止电压存在加性、同方差、零均值的测量误差。您的目标是通过截止电压对频率的线性回归来推断 $h$ 和 $\\phi$，并使用经典线性模型理论来量化不确定性。\n\n使用元电荷的精确值 $e = 1.602176634\\times 10^{-19}\\,\\mathrm{C}$。对于置信区间，使用 $0.95$ 的双边置信水平（即覆盖概率为 $0.95$），并通过自由度为 $N-2$ 的 Student's $t$ 分布来模拟不确定性，其中 $N$ 是拟合中的数据点数量。\n\n测试组。对于以下每种情况，给定频率值 $\\{\\nu_i\\}$（单位为 $\\mathrm{Hz}$）和测量的截止电压 $\\{V_{\\mathrm{s},i}\\}$（单位为 $\\mathrm{V}$）。将所有点视为等权重。\n\n- 情况 A:\n  - 频率 (单位 $\\mathrm{Hz}$): $[\\;5.5\\times 10^{14},\\;6.0\\times 10^{14},\\;6.5\\times 10^{14},\\;7.0\\times 10^{14},\\;7.5\\times 10^{14},\\;8.0\\times 10^{14},\\;8.5\\times 10^{14}\\;]$.\n  - 截止电压 (单位 $\\mathrm{V}$): $[\\;0.0866172328,\\;0.2764006176,\\;0.4961830024,\\;0.6889673872,\\;0.905750772,\\;1.0995341568,\\;1.3183175416\\;]$.\n\n- 情况 B:\n  - 频率 (单位 $\\mathrm{Hz}$): $[\\;5.0\\times 10^{14},\\;7.0\\times 10^{14},\\;9.0\\times 10^{14},\\;1.10\\times 10^{15},\\;1.20\\times 10^{15}\\;]$.\n  - 截止电压 (单位 $\\mathrm{V}$): $[\\;0.068333848,\\;0.8942673872,\\;1.7224009264,\\;2.5488344656,\\;2.9630012352\\;]$.\n\n- 情况 C:\n  - 频率 (单位 $\\mathrm{Hz}$): $[\\;7.8\\times 10^{14},\\;7.9\\times 10^{14},\\;8.0\\times 10^{14},\\;8.1\\times 10^{14},\\;8.2\\times 10^{14}\\;]$.\n  - 截止电压 (单位 $\\mathrm{V}$): $[\\;0.21382080288,\\;0.28517747984,\\;0.2985341568,\\;0.36389083376,\\;0.37524751072\\;]$.\n\n需对每种情况执行的任务：\n1) 根据基本事实，推导出 $V_{\\mathrm{s}}$ 对 $\\nu$ 的仿射依赖关系，并拟合一条无加权的普通最小二乘直线 $V_{\\mathrm{s}} = a\\,\\nu + b$。\n2) 使用具有同方差高斯误差的经典线性模型，通过自由度为 $N-2$ 的 Student's $t$ 分布，计算斜率 $a$ 和截距 $b$ 的双边 $0.95$ 置信区间。\n3) 仅使用量纲一致性和基本事实，将拟合参数及其置信区间转换为对 $h$ 和 $\\phi$ 的估计值。$h$ 以 $\\mathrm{J\\,s}$ 表示，$\\phi$ 以 $\\mathrm{eV}$ 表示。对每种情况，报告列表 $[\\,\\hat{h},\\,h_{\\mathrm{low}},\\,h_{\\mathrm{high}},\\,\\hat{\\phi},\\,\\phi_{\\mathrm{low}},\\,\\phi_{\\mathrm{high}}\\,]$，其中每个边界是相应的双边 $0.95$ 置信端点。\n4) 数值格式：所有报告的数字均以十进制科学记数法或标准十进制形式表示，并四舍五入至六位有效数字。\n5) 单位：$h$ 必须以 $\\mathrm{J\\,s}$ 为单位，$\\phi$ 必须以 $\\mathrm{eV}$ 为单位。\n\n最终输出格式。您的程序应产生单行输出，其中包含三个情况的结果，形式为由逗号分隔的列表的列表，并用方括号括起来，例如：“[[caseA_results],[caseB_results],[caseC_results]]”。每个内部列表必须严格采用 $[\\,\\hat{h},\\,h_{\\mathrm{low}},\\,h_{\\mathrm{high}},\\,\\hat{\\phi},\\,\\phi_{\\mathrm{low}},\\,\\phi_{\\mathrm{high}}\\,]$ 的形式，并具有所需的舍入和单位。不应打印任何其他文本。", "solution": "**1. 线性模型的推导**\n基本事实提供了必要的关系。光电子的最大动能 $K_{\\mathrm{max}}$ 由爱因斯坦方程给出：\n$$K_{\\mathrm{max}} = h\\nu - \\phi$$\n其中 $h$ 是普朗克常数，$\\nu$ 是入射光的频率，$\\phi$ 是金属表面的逸出功。\n\n截止电压 $V_{\\mathrm{s}}$ 是阻止能量最高的电子所需的电势。该电势对一个电子所做的功为 $eV_{\\mathrm{s}}$，其中 $e$ 是元电荷。根据定义，这个功等于最大动能：\n$$K_{\\mathrm{max}} = eV_{\\mathrm{s}}$$\n令两个 $K_{\\mathrm{max}}$ 的表达式相等，得到：\n$$eV_{\\mathrm{s}} = h\\nu - \\phi$$\n为了得到所需的 $V_{\\mathrm{s}}$ 对 $\\nu$ 的仿射依赖关系，我们重排该方程：\n$$V_{\\mathrm{s}} = \\left(\\frac{h}{e}\\right)\\nu - \\frac{\\phi}{e}$$\n该方程的形式为 $V_{\\mathrm{s}} = a\\nu + b$，其中斜率 $a$ 和截距 $b$ 被确定为：\n$$a = \\frac{h}{e}$$\n$$b = -\\frac{\\phi}{e}$$\n\n**2. 普通最小二乘 (OLS) 回归**\n对于一组 $N$ 个数据点 $(\\nu_i, V_{\\mathrm{s},i})$，我们寻求参数 $\\hat{a}$ 和 $\\hat{b}$ 以最小化残差平方和 $SSR = \\sum_{i=1}^{N} (V_{\\mathrm{s},i} - (\\hat{a}\\nu_i + \\hat{b}))^2$。OLS 估计量为：\n$$\\hat{a} = \\frac{\\sum_{i=1}^{N} (\\nu_i - \\bar{\\nu})(V_{\\mathrm{s},i} - \\bar{V}_{\\mathrm{s}})}{\\sum_{i=1}^{N} (\\nu_i - \\bar{\\nu})^2}$$\n$$\\hat{b} = \\bar{V}_{\\mathrm{s}} - \\hat{a}\\bar{\\nu}$$\n其中 $\\bar{\\nu} = \\frac{1}{N}\\sum\\nu_i$ 和 $\\bar{V}_{\\mathrm{s}} = \\frac{1}{N}\\sum V_{\\mathrm{s},i}$ 是样本均值。\n\n**3. 不确定性量化**\n在同方差、不相关、零均值误差的假设下，误差的方差估计为：\n$$s^2 = \\frac{SSR}{N-2}$$\n其中 $N-2$ 代表自由度。估计斜率 ($\\hat{a}$) 和截距 ($\\hat{b}$) 的标准误是：\n$$SE(\\hat{a}) = \\sqrt{\\frac{s^2}{\\sum (\\nu_i - \\bar{\\nu})^2}}$$\n$$SE(\\hat{b}) = \\sqrt{s^2 \\left( \\frac{1}{N} + \\frac{\\bar{\\nu}^2}{\\sum (\\nu_i - \\bar{\\nu})^2} \\right)}$$\n任何参数 $\\theta$（$a$ 或 $b$）的双边 $0.95$ 置信区间的构造如下：\n$$CI(\\theta) = [\\hat{\\theta} - t_{\\alpha/2, N-2} \\cdot SE(\\hat{\\theta}),\\; \\hat{\\theta} + t_{\\alpha/2, N-2} \\cdot SE(\\hat{\\theta})]$$\n其中 $\\alpha = 1 - 0.95 = 0.05$，而 $t_{\\alpha/2, N-2}$ 是来自 Student's $t$ 分布的临界值，对应于概率 $1 - \\alpha/2 = 0.975$ 和 $N-2$ 自由度。\n\n**4. 转换为物理参数**\n根据关系式 $a = h/e$ 和 $b = -\\phi/e$，我们推导出 $h$ 和 $\\phi$ 的估计量：\n$$\\hat{h} = \\hat{a} \\cdot e$$\n$$\\hat{\\phi} = -\\hat{b} \\cdot e$$\n$\\hat{h}$ 的单位是 $(\\mathrm{V}\\cdot\\mathrm{s}) \\cdot \\mathrm{C} = (\\mathrm{J}/\\mathrm{C} \\cdot \\mathrm{s}) \\cdot \\mathrm{C} = \\mathrm{J}\\cdot\\mathrm{s}$。\n逸出功 $\\phi$ 要求以电子伏特 ($\\mathrm{eV}$) 为单位。上面计算出的 $\\phi$ 值的单位是焦耳。为了转换为电子伏特，我们除以元电荷 $e$：\n$$\\hat{\\phi}_{\\mathrm{eV}} = \\frac{\\hat{\\phi}}{e} = \\frac{-\\hat{b} \\cdot e}{e} = -\\hat{b}$$\n因此，以 $\\mathrm{eV}$ 为单位的逸出功的数值就是截距 $b$（单位为伏特）的负值。\n\n$h$ 和 $\\phi_{\\mathrm{eV}}$ 的置信区间是通过对 $a$ 和 $b$ 的置信限应用相同的变换得到的：\n$$CI(h) = [h_{\\mathrm{low}}, h_{\\mathrm{high}}] = [\\hat{a}_{\\mathrm{low}} \\cdot e, \\hat{a}_{\\mathrm{high}} \\cdot e]$$\n$$CI(\\phi_{\\mathrm{eV}}) = [\\phi_{\\mathrm{low}}, \\phi_{\\mathrm{high}}] = [-\\hat{b}_{\\mathrm{high}}, -\\hat{b}_{\\mathrm{low}}]$$\n注意由于取负号，$\\phi_{\\mathrm{eV}}$ 的上限和下限发生了反转。", "answer": "```python\nimport numpy as np\nfrom scipy.stats import t\n\ndef solve():\n    \"\"\"\n    Main function to solve the photoelectric effect problem for all given cases.\n    \"\"\"\n    e = 1.602176634e-19  # Elementary charge in Coulombs\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"nu\": np.array([5.5e14, 6.0e14, 6.5e14, 7.0e14, 7.5e14, 8.0e14, 8.5e14]),\n            \"Vs\": np.array([0.0866172328, 0.2764006176, 0.4961830024, 0.6889673872, 0.905750772, 1.0995341568, 1.3183175416])\n        },\n        {\n            \"nu\": np.array([5.0e14, 7.0e14, 9.0e14, 1.10e15, 1.20e15]),\n            \"Vs\": np.array([0.068333848, 0.8942673872, 1.7224009264, 2.5488344656, 2.9630012352])\n        },\n        {\n            \"nu\": np.array([7.8e14, 7.9e14, 8.0e14, 8.1e14, 8.2e14]),\n            \"Vs\": np.array([0.21382080288, 0.28517747984, 0.2985341568, 0.36389083376, 0.37524751072])\n        }\n    ]\n\n    all_results = []\n    for case in test_cases:\n        result = process_case(case[\"nu\"], case[\"Vs\"], e)\n        all_results.append(result)\n\n    # Format the final output string as per requirements\n    formatted_case_results = []\n    for res_list in all_results:\n        inner_list_str = ','.join([f'{num:.5e}' for num in res_list])\n        formatted_case_results.append(f'[{inner_list_str}]')\n    \n    final_output_str = f\"[{','.join(formatted_case_results)}]\"\n    print(final_output_str)\n\ndef process_case(nu, Vs, e):\n    \"\"\"\n    Performs linear regression and uncertainty analysis for a single case.\n    \n    Args:\n        nu (np.ndarray): Array of frequencies in Hz.\n        Vs (np.ndarray): Array of stopping potentials in V.\n        e (float): Elementary charge in C.\n    \n    Returns:\n        list: A list containing [h_hat, h_low, h_high, phi_hat, phi_low, phi_high].\n    \"\"\"\n    N = len(nu)\n    df = N - 2\n    \n    # Perform ordinary least squares regression\n    nu_bar = np.mean(nu)\n    Vs_bar = np.mean(Vs)\n    \n    ss_nu = np.sum((nu - nu_bar)**2)\n    sp_nu_Vs = np.sum((nu - nu_bar) * (Vs - Vs_bar))\n    \n    a_hat = sp_nu_Vs / ss_nu\n    b_hat = Vs_bar - a_hat * nu_bar\n    \n    # Calculate residuals and estimate error variance\n    Vs_pred = a_hat * nu + b_hat\n    ssr = np.sum((Vs - Vs_pred)**2)\n    s2 = ssr / df\n    \n    # Calculate standard errors of the parameters\n    se_a = np.sqrt(s2 / ss_nu)\n    se_b = np.sqrt(s2 * (1/N + nu_bar**2 / ss_nu))\n    \n    # Find the critical t-value for a 95% confidence interval\n    alpha = 0.05\n    t_crit = t.ppf(1 - alpha/2, df)\n    \n    # Calculate confidence intervals for a and b\n    a_margin = t_crit * se_a\n    b_margin = t_crit * se_b\n    \n    a_low = a_hat - a_margin\n    a_high = a_hat + a_margin\n    \n    b_low = b_hat - b_margin\n    b_high = b_hat + b_margin\n    \n    # Convert regression parameters to physical constants\n    # h = a * e\n    h_hat = a_hat * e\n    h_low = a_low * e\n    h_high = a_high * e\n    \n    # phi_eV = -b\n    phi_hat_eV = -b_hat\n    phi_low_eV = -b_high  # Note the swap due to negation\n    phi_high_eV = -b_low # Note the swap due to negation\n    \n    return [h_hat, h_low, h_high, phi_hat_eV, phi_low_eV, phi_high_eV]\n\nsolve()\n```", "id": "2639808"}]}