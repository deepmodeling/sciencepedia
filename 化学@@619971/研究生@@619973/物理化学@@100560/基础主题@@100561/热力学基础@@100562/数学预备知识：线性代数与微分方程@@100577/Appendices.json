{"hands_on_practices": [{"introduction": "在量子化学的计算中，变分法等近似技术常常依赖于将试验波函数在一组正交的基函数中展开。Gram-Schmidt 正交化过程提供了一种从任意线性无关函数集构造标准正交基的通用算法。本练习将引导您在一个函数空间中，从简单的幂函数 $\\{1, x, x^2\\}$ 出发，亲手构建出一组正交多项式，这组多项式正是物理学和化学中广泛应用的勒让德多项式（Legendre polynomials）。[@problem_id:2648934]", "problem": "在许多物理化学的变分近似中，通常会将一个试探函数展开为在一个有限区间上正交归一的低阶多项式基。考虑在$[-1,1]$上的平方可积函数空间$L^{2}([-1,1])$，其配有加权内积\n$$\\langle f,g\\rangle=\\int_{-1}^{1} f(x)\\,g(x)\\,w(x)\\,dx,$$\n权重为$w(x)=1$。从有序集$\\{1,x,x^{2}\\}$出发，应用格兰姆-施密特正交归一化过程（使用此内积）来构造一个正交归一基 $\\{\\varphi_{0}(x),\\varphi_{1}(x),\\varphi_{2}(x)\\}$。然后，将每个$\\varphi_{n}(x)$（$n=0,1,2$）与$[-1,1]$上相应的归一化勒让德多项式对应起来。\n\n请以$x$的三个封闭形式表达式明确地给出最终的正交归一基，按阶数升序排列。你的最终答案必须是包含这三个表达式的单行矩阵。无需四舍五入。", "solution": "所述问题是有效的。这是一个标准且适定的练习，内容涉及将格兰姆-施密特正交归一化过程应用于函数空间中的一组基函数，这是物理化学和量子力学中的一项基本技术。所有必要的组成部分——初始函数集、区间以及内积的定义——均已提供，并且在数学上和科学上都是合理的。我们将开始求解。\n\n设初始的线性无关函数集为$\\{v_{0}(x), v_{1}(x), v_{2}(x)\\}$，其中$v_{0}(x) = 1$，$v_{1}(x) = x$，$v_{2}(x) = x^{2}$。在空间$L^{2}([-1,1])$上的内积由$\\langle f, g \\rangle = \\int_{-1}^{1} f(x)g(x)dx$给出，因为权重函数为$w(x) = 1$。格兰姆-施密特过程生成一个正交基$\\{u_{0}(x), u_{1}(x), u_{2}(x)\\}$，然后将其归一化以产生正交归一基$\\{\\varphi_{0}(x), \\varphi_{1}(x), \\varphi_{2}(x)\\}$，其中$\\varphi_{n}(x) = \\frac{u_{n}(x)}{\\|u_{n}(x)\\|}$且$\\|f(x)\\| = \\sqrt{\\langle f, f \\rangle}$。\n\n第一步：构造$\\varphi_{0}(x)$。\n第一个正交函数是$u_{0}(x) = v_{0}(x) = 1$。\n我们计算其范数的平方：\n$$ \\|u_{0}(x)\\|^{2} = \\langle 1, 1 \\rangle = \\int_{-1}^{1} (1)(1) \\, dx = [x]_{-1}^{1} = 1 - (-1) = 2. $$\n范数为$\\|u_{0}(x)\\| = \\sqrt{2}$。\n第一个正交归一函数是：\n$$ \\varphi_{0}(x) = \\frac{u_{0}(x)}{\\|u_{0}(x)\\|} = \\frac{1}{\\sqrt{2}}. $$\n这对应于0阶的归一化勒让德多项式，因为$P_{0}(x) = 1$且在$[-1,1]$上的归一化常数为$\\sqrt{\\frac{2(0)+1}{2}} = \\frac{1}{\\sqrt{2}}$。\n\n第二步：构造$\\varphi_{1}(x)$。\n第二个正交函数$u_{1}(x)$通过从$v_{1}(x)$中减去其在$u_{0}(x)$上的投影得到：\n$$ u_{1}(x) = v_{1}(x) - \\frac{\\langle v_{1}, u_{0} \\rangle}{\\|u_{0}\\|^{2}} u_{0}(x). $$\n首先，计算内积$\\langle v_{1}, u_{0} \\rangle$：\n$$ \\langle v_{1}, u_{0} \\rangle = \\langle x, 1 \\rangle = \\int_{-1}^{1} x \\cdot 1 \\, dx = \\left[\\frac{x^{2}}{2}\\right]_{-1}^{1} = \\frac{1^{2}}{2} - \\frac{(-1)^{2}}{2} = 0. $$\n因为内积为0，函数$v_{1}(x)=x$和$u_{0}(x)=1$已经正交。因此，\n$$ u_{1}(x) = v_{1}(x) = x. $$\n现在，我们计算$u_{1}(x)$的范数的平方：\n$$ \\|u_{1}(x)\\|^{2} = \\langle x, x \\rangle = \\int_{-1}^{1} x^{2} \\, dx = \\left[\\frac{x^{3}}{3}\\right]_{-1}^{1} = \\frac{1^{3}}{3} - \\frac{(-1)^{3}}{3} = \\frac{1}{3} + \\frac{1}{3} = \\frac{2}{3}. $$\n范数为$\\|u_{1}(x)\\| = \\sqrt{\\frac{2}{3}}$。\n第二个正交归一函数是：\n$$ \\varphi_{1}(x) = \\frac{u_{1}(x)}{\\|u_{1}(x)\\|} = \\frac{x}{\\sqrt{2/3}} = \\sqrt{\\frac{3}{2}}x. $$\n这对应于1阶的归一化勒让德多项式，因为$P_{1}(x) = x$且归一化常数为$\\sqrt{\\frac{2(1)+1}{2}} = \\sqrt{\\frac{3}{2}}$。\n\n第三步：构造$\\varphi_{2}(x)$。\n第三个正交函数$u_{2}(x)$通过从$v_{2}(x)$中减去其在$u_{0}(x)$和$u_{1}(x)$上的投影得到：\n$$ u_{2}(x) = v_{2}(x) - \\frac{\\langle v_{2}, u_{0} \\rangle}{\\|u_{0}\\|^{2}} u_{0}(x) - \\frac{\\langle v_{2}, u_{1} \\rangle}{\\|u_{1}\\|^{2}} u_{1}(x). $$\n我们计算所需的内积：\n$$ \\langle v_{2}, u_{0} \\rangle = \\langle x^{2}, 1 \\rangle = \\int_{-1}^{1} x^{2} \\, dx = \\left[\\frac{x^{3}}{3}\\right]_{-1}^{1} = \\frac{2}{3}. $$\n$$ \\langle v_{2}, u_{1} \\rangle = \\langle x^{2}, x \\rangle = \\int_{-1}^{1} x^{3} \\, dx = \\left[\\frac{x^{4}}{4}\\right]_{-1}^{1} = 0. $$\n代入已知值$\\|u_{0}\\|^{2}=2$和$\\|u_{1}\\|^{2}=2/3$：\n$$ u_{2}(x) = x^{2} - \\frac{2/3}{2}(1) - \\frac{0}{2/3}(x) = x^{2} - \\frac{1}{3}. $$\n接下来，我们计算$u_{2}(x)$的范数的平方：\n$$ \\|u_{2}(x)\\|^{2} = \\left\\langle x^{2} - \\frac{1}{3}, x^{2} - \\frac{1}{3} \\right\\rangle = \\int_{-1}^{1} \\left(x^{2} - \\frac{1}{3}\\right)^{2} dx = \\int_{-1}^{1} \\left(x^{4} - \\frac{2}{3}x^{2} + \\frac{1}{9}\\right) dx. $$\n$$ = \\left[\\frac{x^{5}}{5} - \\frac{2}{9}x^{3} + \\frac{1}{9}x\\right]_{-1}^{1} = \\left(\\frac{1}{5} - \\frac{2}{9} + \\frac{1}{9}\\right) - \\left(-\\frac{1}{5} + \\frac{2}{9} - \\frac{1}{9}\\right) = 2\\left(\\frac{1}{5} - \\frac{1}{9}\\right) = 2\\left(\\frac{9-5}{45}\\right) = \\frac{8}{45}. $$\n范数为$\\|u_{2}(x)\\| = \\sqrt{\\frac{8}{45}}$。\n第三个正交归一函数是：\n$$ \\varphi_{2}(x) = \\frac{u_{2}(x)}{\\|u_{2}(x)\\|} = \\frac{x^{2} - \\frac{1}{3}}{\\sqrt{8/45}} = \\sqrt{\\frac{45}{8}}\\left(x^{2} - \\frac{1}{3}\\right). $$\n为了将其与标准的勒让德多项式$P_{2}(x) = \\frac{1}{2}(3x^{2}-1)$对齐，我们可以重写$u_{2}(x) = x^{2} - \\frac{1}{3} = \\frac{3x^{2}-1}{3} = \\frac{2}{3}P_{2}(x)$。\n归一化因子为$\\sqrt{\\frac{45}{8}} = \\sqrt{\\frac{9 \\cdot 5}{4 \\cdot 2}} = \\frac{3\\sqrt{5}}{2\\sqrt{2}}$。因此，\n$$ \\varphi_{2}(x) = \\frac{3\\sqrt{5}}{2\\sqrt{2}}\\left(\\frac{1}{3}(3x^{2}-1)\\right) = \\frac{\\sqrt{5}}{2\\sqrt{2}}(3x^{2}-1) = \\sqrt{\\frac{5}{8}}(3x^{2}-1). $$\n这对应于2阶的归一化勒让德多项式，因为归一化常数为$\\sqrt{\\frac{2(2)+1}{2}} = \\sqrt{\\frac{5}{2}}$，且$\\varphi_{2}(x) = \\sqrt{\\frac{5}{2}}P_{2}(x)$。\n\n最终得到的正交归一基为$\\{\\varphi_{0}(x), \\varphi_{1}(x), \\varphi_{2}(x)\\}$。其显式形式为：\n$\\varphi_{0}(x) = \\frac{1}{\\sqrt{2}}$\n$\\varphi_{1}(x) = \\sqrt{\\frac{3}{2}}x$\n$\\varphi_{2}(x) = \\sqrt{\\frac{5}{8}}(3x^{2}-1)$", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{1}{\\sqrt{2}} & \\sqrt{\\frac{3}{2}}x & \\sqrt{\\frac{5}{8}}(3x^2-1)\n\\end{pmatrix}\n}\n$$", "id": "2648934"}, {"introduction": "理想量子系统由厄米（Hermitian）算符描述，其本征值为实数。然而，真实的开放系统，如溶液中的分子，与环境存在能量交换，其性质需由非厄米算符描述，导致本征值为复数。本练习模拟了一个核心的物理化学问题：光谱信号的位置（由复本征值的虚部决定）如何因微小扰动而变得不稳定。通过分析一个非厄米矩阵的本征值敏感性，您将学习如何将左右本征向量的几何关系与物理可观测量（如光谱峰位）的稳定性联系起来，这是理解开放系统动力学的重要一步。[@problem_id:2648932]", "problem": "对于一个弱驱动分子系统，其在频域（旋转坐标系）中的双共振线性响应算符可以由一个非厄米$2\\times 2$矩阵来建模，该矩阵的单极点决定了光谱峰位。考虑矩阵\n$$\nA \\;=\\; \\begin{pmatrix}\n-1.50\\times 10^{8} + i\\,6.00\\times 10^{9} & 6.00\\times 10^{7} \\\\\n0 & -1.60\\times 10^{8} + i\\,5.98\\times 10^{9}\n\\end{pmatrix}\\ \\ (\\mathrm{s}^{-1})\\,,\n$$\n其特征值为极点的位置。设$\\lambda_{1}$表示与第一个对角元相关的特征值。微小的环境涨落会引起一个加性微扰$\\delta A$，其谱范数为$\\|\\delta A\\|_{2} = 5.00\\times 10^{6}\\ \\mathrm{s}^{-1}$。\n\n从单特征值的右和左特征向量的定义$A v = \\lambda v$和$A^{\\dagger} w = \\overline{\\lambda}\\, w$出发，并结合线性微扰分析以及谱范数下的柯西-施瓦茨不等式，通过与$\\lambda_{1}$相关的单位范数左、右特征向量之间的锐角$\\theta$来表示$\\lambda_{1}$对$\\delta A$的灵敏度。然后，对于给定的矩阵$A$：\n- 确定这些特征向量所决定的角度因子，\n- 用它来获得共振角频率漂移量值，即$|\\delta\\,\\mathrm{Im}\\,\\lambda_{1}|$，的最紧一阶上界。\n\n报告此上界的数值，单位为$\\mathrm{s}^{-1}$，并四舍五入到$3$位有效数字。最终答案必须是一个数字。", "solution": "该问题是有效的，因为它在科学上基于应用于物理化学的线性代数和微扰理论原理，是适定的（提供了所有必要信息），并且表述客观。\n\n我们被要求分析一个非厄米矩阵$A$的单特征值对微扰$\\delta A$的一阶灵敏度。设$\\lambda$是$A$的一个单特征值，其对应的右特征向量为$v$，左特征向量为$w$。根据定义，它们满足：\n$$Av = \\lambda v$$\n$$w^{\\dagger}A = \\lambda w^{\\dagger}$$\n第二个方程是左特征向量的定义，它与问题中给出的$A^{\\dagger}w = \\overline{\\lambda} w$等价。\n考虑微扰后的矩阵$A' = A + \\delta A$。微扰后的特征值$\\lambda' = \\lambda + \\delta\\lambda$和特征向量$v' = v + \\delta v$满足$(A + \\delta A)(v + \\delta v) = (\\lambda + \\delta\\lambda)(v + \\delta v)$。展开此方程并只保留微扰的一阶项，我们得到：\n$$Av + A(\\delta v) + (\\delta A)v \\approx \\lambda v + \\lambda(\\delta v) + (\\delta\\lambda)v$$\n使用$Av = \\lambda v$，我们将表达式简化为：\n$$A(\\delta v) + (\\delta A)v \\approx \\lambda(\\delta v) + (\\delta\\lambda)v$$\n重新整理得到：\n$$(A - \\lambda I)\\delta v \\approx (\\delta\\lambda)v - (\\delta A)v$$\n左乘左特征向量的伴随$w^{\\dagger}$，我们得到：\n$$w^{\\dagger}(A - \\lambda I)\\delta v \\approx w^{\\dagger}(\\delta\\lambda)v - w^{\\dagger}(\\delta A)v$$\n左边的项为零，因为$w^{\\dagger}(A - \\lambda I) = w^{\\dagger}A - \\lambda w^{\\dagger} = \\lambda w^{\\dagger} - \\lambda w^{\\dagger} = 0^{\\dagger}$。因此，我们有：\n$$0 \\approx (\\delta\\lambda)w^{\\dagger}v - w^{\\dagger}(\\delta A)v$$\n解出一阶修正$\\delta\\lambda$，得到标准结果：\n$$\\delta\\lambda \\approx \\frac{w^{\\dagger}(\\delta A)v}{w^{\\dagger}v}$$\n为了找到该修正量值$|\\delta\\lambda|$的一个上界，我们取其绝对值，并对分子应用柯西-施瓦茨不等式，同时结合谱范数$\\|\\cdot\\|_2$的定义：\n$$|\\delta\\lambda| \\approx \\frac{|w^{\\dagger}(\\delta A)v|}{|w^{\\dagger}v|} \\le \\frac{\\|w\\|_2 \\|(\\delta A)v\\|_2}{|w^{\\dagger}v|} \\le \\frac{\\|w\\|_2 \\|\\delta A\\|_2 \\|v\\|_2}{|w^{\\dagger}v|}$$\n对于单位范数特征向量，$\\|v\\|_2 = 1$且$\\|w\\|_2 = 1$，表达式得以简化。项$w^{\\dagger}v$是内积$\\langle w, v \\rangle$。其量值由$|w^{\\dagger}v| = \\cos\\theta$给出，其中$\\theta$是特征向量之间的夹角。问题指定$\\theta$为锐角，所以$\\cos\\theta \\ge 0$。因此，特征值的灵敏度表示为：\n$$|\\delta\\lambda| \\le \\frac{\\|\\delta A\\|_2}{\\cos\\theta}$$\n因此，灵敏度由因子$1/\\cos\\theta$决定，该因子是特征值的条件数。这就是所要求的“角度因子”。\n\n问题要求$|\\delta\\,\\mathrm{Im}\\,\\lambda_1|$的最紧一阶上界。我们注意到$|\\delta\\,\\mathrm{Im}\\,\\lambda_1| = |\\mathrm{Im}(\\delta\\lambda_1)| \\le |\\delta\\lambda_1|$。这个界是紧的，因为可以构造一个微扰$\\delta A$（具体来说，一个形式为$k w v^\\dagger$的秩一微扰，其中$k$具有适当的复相位），使得$\\delta\\lambda_1$成为纯虚数，并且其量值等于该上界。因此，$|\\delta\\,\\mathrm{Im}\\,\\lambda_1|$的最紧上界与$|\\delta\\lambda_1|$的相同：\n$$\\max |\\delta\\,\\mathrm{Im}\\,\\lambda_1| = \\frac{\\|\\delta A\\|_2}{\\cos\\theta_1}$$\n其中$\\theta_1$是与$\\lambda_1$对应的左、右特征向量之间的夹角。\n\n现在，我们将此应用到给定的矩阵：\n$$A = \\begin{pmatrix} -1.50\\times 10^{8} + i\\,6.00\\times 10^{9} & 6.00\\times 10^{7} \\\\ 0 & -1.60\\times 10^{8} + i\\,5.98\\times 10^{9} \\end{pmatrix}$$\n由于$A$是一个上三角矩阵，其特征值即为其对角元。与第一个对角元相关的特征值是$\\lambda_1$：\n$$\\lambda_1 = -1.50\\times 10^{8} + i\\,6.00\\times 10^{9}\\ \\mathrm{s}^{-1}$$\n右特征向量$v_1$通过求解$(A - \\lambda_1 I)v_1 = 0$来找到：\n$$\\begin{pmatrix} 0 & 6.00\\times 10^{7} \\\\ 0 & (-1.60\\times 10^{8} + i\\,5.98\\times 10^{9}) - (-1.50\\times 10^{8} + i\\,6.00\\times 10^{9}) \\end{pmatrix} \\begin{pmatrix} x \\\\ y \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}$$\n$$\\begin{pmatrix} 0 & 6.00\\times 10^{7} \\\\ 0 & -1.0\\times 10^{7} - i\\,2.0\\times 10^{7} \\end{pmatrix} \\begin{pmatrix} x \\\\ y \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}$$\n第一行给出$(6.00\\times 10^{7})y = 0$，这意味着$y=0$。我们可以选择$x=1$。归一化的右特征向量是$v_1 = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$。\n\n左特征向量$w_1$通过求解$w_1^{\\dagger}(A - \\lambda_1 I) = 0^{\\dagger}$来找到：\n$$\\begin{pmatrix} \\bar{p} & \\bar{q} \\end{pmatrix} \\begin{pmatrix} 0 & 6.00\\times 10^{7} \\\\ 0 & -1.0\\times 10^{7} - i\\,2.0\\times 10^{7} \\end{pmatrix} = \\begin{pmatrix} 0 & 0 \\end{pmatrix}$$\n这产生了一个单一方程：$\\bar{p}(6.00\\times 10^{7}) + \\bar{q}(-1.0\\times 10^{7} - i\\,2.0\\times 10^{7}) = 0$。\n$$6\\bar{p} = \\bar{q}(1+2i) \\implies \\bar{q} = \\frac{6\\bar{p}}{1+2i} = \\frac{6(1-2i)}{1^2+2^2}\\bar{p} = \\frac{6}{5}(1-2i)\\bar{p}$$\n选择$p=1$，我们得到$q = \\frac{6}{5}(1+2i)$。未归一化的左特征向量是$w_{1, \\text{un-norm}} = \\begin{pmatrix} 1 \\\\ \\frac{6}{5}(1+2i) \\end{pmatrix}$。\n范数的平方是$\\|w_{1, \\text{un-norm}}\\|_2^2 = |1|^2 + |\\frac{6}{5}(1+2i)|^2 = 1 + \\frac{36}{25}(1^2+2^2) = 1 + \\frac{36}{25}(5) = 1 + \\frac{36}{5} = \\frac{41}{5}$。\n范数是$\\|w_{1, \\text{un-norm}}\\|_2 = \\sqrt{41/5}$。\n归一化的左特征向量是$w_1 = \\sqrt{\\frac{5}{41}} \\begin{pmatrix} 1 \\\\ \\frac{6}{5}(1+2i) \\end{pmatrix}$。\n\n接下来，我们计算$\\cos\\theta_1 = |w_1^{\\dagger}v_1|$:\n$$w_1^{\\dagger}v_1 = \\sqrt{\\frac{5}{41}} \\begin{pmatrix} 1 & \\frac{6}{5}(1-2i) \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} = \\sqrt{\\frac{5}{41}}$$\n所以，$\\cos\\theta_1 = \\sqrt{5/41}$。\n角度因子，也就是条件数，是$1/\\cos\\theta_1 = \\sqrt{41/5} = \\sqrt{8.2}$。\n\n最后，我们使用给定的微扰范数$\\|\\delta A\\|_2 = 5.00\\times 10^{6}\\ \\mathrm{s}^{-1}$来计算$|\\delta\\,\\mathrm{Im}\\,\\lambda_1|$的最紧一阶上界：\n$$\\text{上界} = \\frac{\\|\\delta A\\|_2}{\\cos\\theta_1} = (5.00\\times 10^{6}) \\times \\sqrt{8.2}$$\n$$\\text{上界} \\approx (5.00\\times 10^{6}) \\times 2.863564 = 14.31782 \\times 10^{6} = 1.431782 \\times 10^{7}\\ \\mathrm{s}^{-1}$$\n四舍五入到3位有效数字，上界为$1.43 \\times 10^{7}\\ \\mathrm{s}^{-1}$。", "answer": "$$\\boxed{1.43 \\times 10^{7}}$$", "id": "2648932"}, {"introduction": "化学反应网络和分子弛豫过程往往包含速率相差悬殊的多个步骤，这类动力学系统在数学上称为“刚性”（stiff）常微分方程组。标准的显式数值积分方法在处理刚性问题时，为保证稳定性必须采用极小的步长，从而导致计算效率低下。本练习将指导您实现一种隐式中点法，它是一种 A-稳定的方法，能够以较大的步长高效、稳定地求解刚性方程。掌握此类数值方法对于从事化学动力学模拟和复杂系统建模的研究者至关重要。[@problem_id:2648885]", "problem": "考虑向量形式的常系数线性初值问题 $ \\dot{\\mathbf{y}}(t) = \\mathbf{A}\\,\\mathbf{y}(t) $，其中 $ \\mathbf{y}(0) = \\mathbf{y}_0 $，且 $ \\mathbf{A} \\in \\mathbb{C}^{m \\times m} $ 是一个固定矩阵。你的任务是从积分形式 $ \\mathbf{y}(t_{n+1}) = \\mathbf{y}(t_n) + \\int_{t_n}^{t_{n+1}} \\mathbf{A}\\,\\mathbf{y}(t)\\,\\mathrm{d}t $ 和中点求积法则出发，推导并实现针对此问题的隐式中点时间步进法。使用得到的格式在标量测试方程 $ \\dot{y}(t) = \\lambda\\,y(t) $（其中 $ \\lambda \\in \\mathbb{C} $）上研究其精度和稳定性。不得使用任何未由此基础推导出的公式。\n\n你的程序必须：\n- 对常数矩阵 $ \\mathbf{A} $ 实现隐式中点法，将每一步简化为求解一个线性系统，该系统的系数矩阵对于所有固定步长 $ h $ 的步都相同，并将其重复应用于 $ N = T/h $ 个步长，以计算在时间 $ T $ 的近似值。\n- 对于标量测试方程，推导放大因子 $ R(z) $，其中 $ z = h\\,\\lambda $，并用它来评估在复平面上的线性稳定性。\n\n测试套件规范：\n1. 标量测试方程上的二阶精度（全局阶）：\n   - 使用 $ \\lambda = -50 $、$ y(0) = 1 $ 和最终时间 $ T = 1 $。\n   - 使用步长 $ h \\in \\{ 2^{-4},\\,2^{-5},\\,2^{-6},\\,2^{-7} \\} $，以确保在每种情况下 $ N = T/h $ 均为整数。\n   - 对于每个 $ h $，计算在 $ T $ 时的绝对误差，即 $ e(h) = \\lvert y_N - \\exp(\\lambda\\,T) \\rvert $。\n   - 通过对 $ \\log(e(h)) $ 与 $ \\log(h) $ 在 $ h $ 值集合上进行最小二乘拟合来估计观测阶 $ p $。报告 $ p $，四舍五入到三位小数。\n\n2. 通过放大因子在标量测试方程上验证 $ A $-稳定性：\n   - 推导将该方法应用于 $ \\dot{y} = \\lambda\\,y $ 时的 $ R(z) $。\n   - 对于集合 $ \\mathcal{Z} = \\{ 0,\\,-1,\\,-10,\\,-1000,\\,-1+10\\,\\mathrm{i},\\,-1-10\\,\\mathrm{i},\\,100\\,\\mathrm{i},\\,-100\\,\\mathrm{i} \\} $，计算布尔值 $ b(z) $，当且仅当 $ \\lvert R(z) \\rvert \\le 1 + \\epsilon $（容差 $ \\epsilon = 10^{-12} $）时为真，否则为假。报告列表 $ [\\,b(z)\\,:\\,z \\in \\mathcal{Z}\\,] $，并保持给定的顺序。\n\n3. 刚性线性系统传播检验：\n   - 令 $ \\mathbf{A} = \\mathrm{diag}(-1000,\\,-1) \\in \\mathbb{R}^{2 \\times 2} $，$ \\mathbf{y}_0 = [\\,1,\\,1\\,]^\\top $，以及 $ h = 1 $、$ T = 1 $（因此 $ N = 1 $ 步）。\n   - 计算隐式中点法对此 $ \\mathbf{A} $ 的单步放大矩阵 $ \\mathbf{M}(h) $，然后计算其谱半径 $ \\rho(\\mathbf{M}(h)) $。\n   - 报告 $ \\rho(\\mathbf{M}(h)) $，四舍五入到六位小数，以及一个布尔值 $ b_\\rho $，当且仅当 $ \\rho(\\mathbf{M}(h)) \\le 1 + \\epsilon $（使用与上文相同的 $ \\epsilon $）时为真。\n\n最终输出格式：\n- 你的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果，不含空格。\n- 输出必须采用 $ [\\,p,\\,[b(0),b(-1),b(-10),b(-1000),b(-1+10\\,\\mathrm{i}),b(-1-10\\,\\mathrm{i}),b(100\\,\\mathrm{i}),b(-100\\,\\mathrm{i})],\\,\\rho(\\mathbf{M}(1)),\\,b_\\rho\\,] $ 的形式，其中 $ p $ 四舍五入到三位小数，$ \\rho(\\mathbf{M}(1)) $ 四舍五入到六位小数，所有布尔值均不四舍五入。\n- 本问题不涉及物理单位，也不使用角度。所有数值应按规定视作无量纲的实数或复数。", "solution": "该问题是有效的，因为它构成了常微分方程数值分析中的一个标准的、适定的练习，它基于既定的数学原理，并包含获得唯一解所需的所有必要信息。\n\n我们首先为向量形式的线性初值问题 $\\dot{\\mathbf{y}}(t) = \\mathbf{A}\\,\\mathbf{y}(t)$ 推导隐式中点法。起点是解在从 $t_n$ 到 $t_{n+1} = t_n + h$ 的一个时间步长上的精确积分表示：\n$$\n\\mathbf{y}(t_{n+1}) = \\mathbf{y}(t_n) + \\int_{t_n}^{t_{n+1}} \\mathbf{A}\\,\\mathbf{y}(t)\\,\\mathrm{d}t\n$$\n该积分使用中点求积法则进行近似，即 $\\int_{a}^{b} f(t)\\,\\mathrm{d}t \\approx (b-a) f(\\frac{a+b}{2})$。将此法则应用于我们的方程，其中被积函数为 $\\mathbf{A}\\,\\mathbf{y}(t)$，步长为 $h = t_{n+1} - t_n$，中点时间为 $t_{n+1/2} = t_n + h/2$，我们得到以下数值格式：\n$$\n\\mathbf{y}_{n+1} = \\mathbf{y}_n + h (\\mathbf{A}\\,\\mathbf{y}(t_{n+1/2}))\n$$\n这个格式是隐式的，因为它依赖于尚未知晓的时间 $t_{n+1/2}$ 处的解。对于隐式中点法则，值 $\\mathbf{y}(t_{n+1/2})$ 通过区间起点和终点值的平均值来近似：\n$$\n\\mathbf{y}(t_{n+1/2}) \\approx \\frac{\\mathbf{y}_n + \\mathbf{y}_{n+1}}{2}\n$$\n将此近似代入格式中得到：\n$$\n\\mathbf{y}_{n+1} = \\mathbf{y}_n + h \\mathbf{A} \\left( \\frac{\\mathbf{y}_n + \\mathbf{y}_{n+1}}{2} \\right)\n$$\n为了求解 $\\mathbf{y}_{n+1}$，我们重新整理各项：\n$$\n\\mathbf{y}_{n+1} - \\frac{h}{2} \\mathbf{A} \\mathbf{y}_{n+1} = \\mathbf{y}_n + \\frac{h}{2} \\mathbf{A} \\mathbf{y}_n\n$$\n在左侧提取 $\\mathbf{y}_{n+1}$，在右侧提取 $\\mathbf{y}_n$，其中 $\\mathbf{I}$ 是单位矩阵，我们得到：\n$$\n\\left(\\mathbf{I} - \\frac{h}{2} \\mathbf{A}\\right) \\mathbf{y}_{n+1} = \\left(\\mathbf{I} + \\frac{h}{2} \\mathbf{A}\\right) \\mathbf{y}_n\n$$\n这是一个关于 $\\mathbf{y}_{n+1}$ 的线性系统，其系数矩阵 $(\\mathbf{I} - \\frac{h}{2}\\mathbf{A})$ 对于固定的步长 $h$ 是常数。通过矩阵求逆可得其形式解：\n$$\n\\mathbf{y}_{n+1} = \\left(\\mathbf{I} - \\frac{h}{2} \\mathbf{A}\\right)^{-1} \\left(\\mathbf{I} + \\frac{h}{2} \\mathbf{A}\\right) \\mathbf{y}_n\n$$\n矩阵 $\\mathbf{M}(h) = (\\mathbf{I} - \\frac{h}{2} \\mathbf{A})^{-1} (\\mathbf{I} + \\frac{h}{2} \\mathbf{A})$ 是单步放大矩阵。\n\n对于标量测试方程 $\\dot{y}(t) = \\lambda y(t)$，矩阵 $\\mathbf{A}$ 就是标量 $\\lambda \\in \\mathbb{C}$。该格式变为：\n$$\ny_{n+1} = \\left(1 - \\frac{h\\lambda}{2}\\right)^{-1} \\left(1 + \\frac{h\\lambda}{2}\\right) y_n\n$$\n因此，放大因子 $R(z)$（其中 $z = h\\lambda$）为：\n$$\nR(z) = \\frac{1 + z/2}{1 - z/2}\n$$\n\n任务 1：精度。隐式中点法是一种对称方法，已知其全局误差为 2 阶，即 $e(h) = \\mathcal{O}(h^2)$。这意味着在固定时间 $T$ 的误差 $e(h)$ 的行为类似于 $e(h) \\approx C h^p$，其中 $C$ 为某个常数，$p$ 为阶数。取自然对数，我们有 $\\log(e(h)) \\approx \\log(C) + p \\log(h)$。对 $\\log(e(h))$ 与 $\\log(h)$ 进行线性最小二乘拟合将得到观测阶 $p$ 作为斜率。我们为 $\\lambda = -50$，$y(0) = 1$，$T=1$ 和 $h \\in \\{2^{-4}, 2^{-5}, 2^{-6}, 2^{-7}\\}$ 计算这个值。精确解为 $y(T) = \\exp(\\lambda T)$。数值解为 $y_N = (R(h\\lambda))^N y_0$，其中 $N=T/h$。\n\n任务 2：A-稳定性。如果一个方法的绝对稳定区域包含整个复平面的左半部分，即对于所有满足 $\\mathrm{Re}(z) \\le 0$ 的 $z \\in \\mathbb{C}$ 都有 $|R(z)| \\le 1$，则该方法是 A-稳定的。对于我们的 $R(z)$，令 $z = x + iy$，其中 $x \\le 0$。\n$$\n|R(z)|^2 = \\left| \\frac{1 + (x+iy)/2}{1 - (x+iy)/2} \\right|^2 = \\frac{|(1+x/2) + i(y/2)|^2}{|(1-x/2) - i(y/2)|^2} = \\frac{(1+x/2)^2 + (y/2)^2}{(1-x/2)^2 + (y/2)^2} = \\frac{1 + x + (x^2+y^2)/4}{1 - x + (x^2+y^2)/4}\n$$\n由于 $x \\le 0$，我们有 $1+x \\le 1-x$。分子小于或等于分母，因此 $|R(z)|^2 \\le 1$。该方法是 A-稳定的。我们将为一组测试点 $\\mathcal{Z}$ 验证 $|R(z)| \\le 1 + \\epsilon$，这些测试点都位于左半平面或虚轴上。\n\n任务 3：刚性系统。对于一个线性系统，方法的稳定性由放大矩阵的谱半径 $\\rho(\\mathbf{M}(h))$ 决定。如果 $\\mathbf{A}$ 可对角化，其特征值为 $\\{\\lambda_i\\}$，那么 $\\mathbf{M}(h)$ 的特征值为 $\\{R(h\\lambda_i)\\}$。谱半径为 $\\rho(\\mathbf{M}(h)) = \\max_i |R(h\\lambda_i)|$。对于给定的对角矩阵 $\\mathbf{A} = \\mathrm{diag}(-1000, -1)$，特征值为 $\\lambda_1 = -1000$ 和 $\\lambda_2 = -1$。当 $h=1$ 时，$R$ 的参数为 $z_1 = -1000$ 和 $z_2 = -1$。谱半径为 $\\rho(\\mathbf{M}(1)) = \\max(|R(-1000)|, |R(-1)|)$。我们计算这个值并检查它是否受 $1 + \\epsilon$ 的限制。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the specified numerical analysis problem involving the implicit midpoint method.\n    \"\"\"\n\n    # --- Task 1: Second-order accuracy (global order) ---\n    lambda_val = -50.0\n    y0 = 1.0\n    T = 1.0\n    h_values = np.array([2**-4, 2**-5, 2**-6, 2**-7])\n\n    # Amplification factor R(z) for the implicit midpoint method\n    R = lambda z: (1 + z / 2.0) / (1 - z / 2.0)\n\n    # Exact solution at time T\n    y_exact = np.exp(lambda_val * T)\n\n    errors = []\n    for h in h_values:\n        N = int(T / h)\n        z = h * lambda_val\n        # For a linear scalar problem, y_N = R(z)^N * y_0\n        y_N = (R(z)**N) * y0\n        errors.append(np.abs(y_N - y_exact))\n    \n    errors = np.array(errors)\n\n    # Estimate order p by fitting log(error) vs log(h)\n    # log(error) = p * log(h) + C\n    p = np.polyfit(np.log(h_values), np.log(errors), 1)[0]\n    p_rounded = round(p, 3)\n\n    # --- Task 2: A-stability on the scalar test equation ---\n    epsilon = 1e-12\n    z_values_complex = [\n        complex(0, 0), complex(-1, 0), complex(-10, 0), complex(-1000, 0),\n        complex(-1, 10), complex(-1, -10),\n        complex(0, 100), complex(0, -100)\n    ]\n\n    b_values = []\n    for z in z_values_complex:\n        # np.abs for complex numbers gives the modulus\n        is_stable = np.abs(R(z)) <= 1.0 + epsilon\n        b_values.append(is_stable)\n\n    # --- Task 3: Stiff linear system propagation check ---\n    # A = diag(-1000, -1), so eigenvalues are lambda_1 = -1000, lambda_2 = -1\n    lambda_1 = -1000.0\n    lambda_2 = -1.0\n    h_stiff = 1.0\n\n    # The arguments for the amplification factor R(z)\n    z1 = h_stiff * lambda_1\n    z2 = h_stiff * lambda_2\n    \n    # The spectral radius of the amplification matrix M(h) is max(|R(h*lambda_i)|)\n    rho_M_h = np.max([np.abs(R(z1)), np.abs(R(z2))])\n    rho_M_h_rounded = round(rho_M_h, 6)\n\n    # Check if the method is stable for this stiff problem (rho <= 1)\n    b_rho = rho_M_h <= 1.0 + epsilon\n\n    # --- Final Output Formatting ---\n    # The format requires a list-like string with no spaces.\n    # Python's bool string representation 'True'/'False' is what is expected.\n    b_values_str = f\"[{','.join(map(str, b_values))}]\"\n    final_output = f\"[{p_rounded},{b_values_str},{rho_M_h_rounded},{b_rho}]\"\n    # Remove all spaces for the final strict format\n    print(final_output.replace(\" \", \"\"))\n\nsolve()\n```", "id": "2648885"}]}