{"hands_on_practices": [{"introduction": "热力学测量为我们探究微观世界提供了一个强有力的窗口。一个看似简单的宏观量，如恒压摩尔热容 $C_{p,m}$，实际上蕴含了关于分子结构和内禀运动的丰富信息。本练习将引导你从一个实验测得的 $C_{p,m}$ 值出发，反向推断一种未知气体分子的可能几何构型，从而实践能量均分定理的应用 [@problem_id:1983439]。", "problem": "一位化学工程师正在表征一种新合成的未知气态化合物，该化合物在室温（$298 \\, \\text{K}$）和低压下，可以被精确地建模为理想气体。通过仔细的量热测量，测得其恒压摩尔热容 $C_{p,m}$ 为 $29.05 \\, \\text{J}\\,\\text{mol}^{-1}\\,\\text{K}^{-1}$。根据能量均分定理，并假设在此温度下振动对热容的贡献可以忽略不计，请确定该化合物最可能的分子结构。理想气体常数 $R = 8.314 \\, \\text{J}\\,\\text{mol}^{-1}\\,\\text{K}^{-1}$。\n\nA. 单原子\n\nB. 双原子或线性多原子\n\nC. 非线性多原子\n\nD. 所提供的信息不足以做出判断。", "solution": "在低压下，该气体为理想气体。根据能量均分定理，在室温下振动贡献可忽略不计，每个二次自由度对每摩尔的平均能量贡献为 $\\frac{1}{2}RT$，因此对于 $f$ 个活动的二次自由度，摩尔内能为\n$$\nU_{m}=\\frac{f}{2}RT,\n$$\n因此，摩尔热容为\n$$\nC_{V,m}=\\left(\\frac{\\partial U_{m}}{\\partial T}\\right)_{V}=\\frac{f}{2}R,\\qquad C_{p,m}=C_{V,m}+R=\\left(\\frac{f}{2}+1\\right)R.\n$$\n平动贡献总是 $3$ 个自由度。转动贡献取决于分子结构：\n- 单原子分子：在经典水平上没有转动二次能量，因此有效自由度 $f=3$，于是\n$$\nC_{p,m}^{\\text{mono}}=\\frac{5}{2}R.\n$$\n- 双原子或线性多原子分子：两个转动自由度，$f=3+2=5$，于是\n$$\nC_{p,m}^{\\text{linear}}=\\frac{7}{2}R.\n$$\n- 非线性多原子分子：三个转动自由度，$f=3+3=6$，于是\n$$\nC_{p,m}^{\\text{nonlin}}=4R.\n$$\n测得的值为 $C_{p,m}=29.05\\,\\text{J}\\,\\text{mol}^{-1}\\,\\text{K}^{-1}$。用 $R$ 进行归一化，\n$$\n\\frac{C_{p,m}}{R}=\\frac{29.05}{8.314}\\approx 3.50\\approx \\frac{7}{2},\n$$\n这与双原子或线性多原子分子的预测值 $\\frac{7}{2}R$ 相匹配，并且与单原子分子的 $\\frac{5}{2}R$ 和非线性多原子分子的 $4R$ 有明显区别。因此，最可能的分子结构是双原子或线性多原子。", "answer": "$$\\boxed{B}$$", "id": "1983439"}, {"introduction": "经典的能量均分定理虽然实用，但在处理量子化能级系统时会失效。本练习将通过研究一个双能级原子系统，带领你深入探讨这种情况，这是一个在光谱学和激光物理学等领域都至关重要的基础模型。你将运用统计力学的强大形式体系，从配分函数出发，推导出该系统的热容 $C_V$，并探索其在包括有趣的负绝对温度区域在内的行为 [@problem_id:1969896]。", "problem": "一个用于描述受激辐射光放大（LASER，激光）增益介质的简化模型，由可近似为两能级系统的原子组成。考虑一个由 $N$ 个此类无相互作用、可分辨的原子组成的系统，该系统保持在恒定体积下。每个原子都有一个能量为 $\\epsilon_0$ 的基态和一个能量为 $\\epsilon_1$ 的激发态。令能隙表示为 $\\Delta \\epsilon = \\epsilon_1 - \\epsilon_0$。\n\n该系统与温度为 $T$ 的热库处于热平衡状态，温度 $T$ 可以为正或负。在此模型中，正温度对应于正常粒子数分布（更多原子处于基态），而负绝对温度对应于粒子数反转状态（更多原子处于激发态），这是激光运转的必要条件。\n\n您的任务是确定这整个由 $N$ 个原子组成的系统的恒定体积下的总热容 $C_V$。请将您的答案表示为 $N$、$\\Delta \\epsilon$、温度 $T$ 和玻尔兹曼常数 $k_B$ 的函数。", "solution": "我们考虑 $N$ 个无相互作用、可分辨的两能级原子，它们处于固定体积下，并与温度为 $T$ 的热库接触。令两个能级为 $\\epsilon_{0}$ 和 $\\epsilon_{1}$，能隙为 $\\Delta \\epsilon = \\epsilon_{1} - \\epsilon_{0}$。热容 $C_{V}$ 定义为恒定体积下内能对温度的导数，对于正则系综，它可以从配分函数中获得。\n\n给所有能级加上一个常数，会使内能移动一个不依赖于 $T$ 的常数，因此不会改变 $C_{V}$。我们利用这一点，将两个能级对称地置于零点两侧：将单个原子的能量设置为 $-\\Delta \\epsilon/2$ 和 $+\\Delta \\epsilon/2$。这样做可以使所有对温度的导数保持不变，并使代数运算更加清晰。\n\n对于单个原子，其正则配分函数为\n$$\nz = \\sum_{i} \\exp(-\\beta \\epsilon_{i}) = \\exp\\!\\left(\\beta \\frac{\\Delta \\epsilon}{2}\\right) + \\exp\\!\\left(-\\beta \\frac{\\Delta \\epsilon}{2}\\right) = 2 \\cosh\\!\\left(\\beta \\frac{\\Delta \\epsilon}{2}\\right),\n$$\n其中 $\\beta = 1/(k_{B} T)$，它可以是正的或负的。\n\n每个原子的内能由正则关系式 $u = - \\partial \\ln z / \\partial \\beta$ 给出：\n$$\nu = - \\frac{\\partial}{\\partial \\beta} \\ln\\!\\left[2 \\cosh\\!\\left(\\beta \\frac{\\Delta \\epsilon}{2}\\right)\\right]\n= - \\frac{1}{2 \\cosh\\!\\left(\\beta \\frac{\\Delta \\epsilon}{2}\\right)} \\cdot 2 \\cdot \\frac{\\Delta \\epsilon}{2} \\sinh\\!\\left(\\beta \\frac{\\Delta \\epsilon}{2}\\right)\n= - \\frac{\\Delta \\epsilon}{2} \\tanh\\!\\left(\\beta \\frac{\\Delta \\epsilon}{2}\\right).\n$$\n\n每个原子在恒定体积下的热容为 $c_{V} = (\\partial u / \\partial T)_{V}$。使用链式法则和 $\\beta = 1/(k_{B} T)$，\n$$\nc_{V} = \\frac{\\partial u}{\\partial \\beta} \\cdot \\frac{\\partial \\beta}{\\partial T}\n= \\left[- \\frac{\\Delta \\epsilon}{2} \\cdot \\frac{\\partial}{\\partial \\beta} \\tanh\\!\\left(\\beta \\frac{\\Delta \\epsilon}{2}\\right)\\right] \\cdot \\left(- \\frac{1}{k_{B} T^{2}}\\right).\n$$\n由于 $\\frac{d}{dx} \\tanh x = \\frac{1}{\\cosh^{2} x}$ 且 $\\frac{\\partial}{\\partial \\beta} \\tanh\\!\\left(\\beta \\frac{\\Delta \\epsilon}{2}\\right) = \\frac{\\Delta \\epsilon}{2} \\cdot \\frac{1}{\\cosh^{2}\\!\\left(\\beta \\frac{\\Delta \\epsilon}{2}\\right)}$，我们得到\n$$\n\\frac{\\partial u}{\\partial \\beta} = - \\frac{\\Delta \\epsilon}{2} \\cdot \\frac{\\Delta \\epsilon}{2} \\cdot \\frac{1}{\\cosh^{2}\\!\\left(\\beta \\frac{\\Delta \\epsilon}{2}\\right)} = - \\frac{(\\Delta \\epsilon)^{2}}{4} \\cdot \\frac{1}{\\cosh^{2}\\!\\left(\\beta \\frac{\\Delta \\epsilon}{2}\\right)}.\n$$\n因此，\n$$\nc_{V} = \\frac{(\\Delta \\epsilon)^{2}}{4} \\cdot \\frac{1}{\\cosh^{2}\\!\\left(\\beta \\frac{\\Delta \\epsilon}{2}\\right)} \\cdot \\frac{1}{k_{B} T^{2}}\n= k_{B} \\left(\\frac{\\Delta \\epsilon}{2 k_{B} T}\\right)^{2} \\frac{1}{\\cosh^{2}\\!\\left(\\frac{\\Delta \\epsilon}{2 k_{B} T}\\right)}.\n$$\n\n对于 $N$ 个独立的原子，能量是可加的，因此热容也是可加的，从而得到总热容\n$$\nC_{V} = N \\, c_{V} = N \\, k_{B} \\left(\\frac{\\Delta \\epsilon}{2 k_{B} T}\\right)^{2} \\frac{1}{\\cosh^{2}\\!\\left(\\frac{\\Delta \\epsilon}{2 k_{B} T}\\right)}.\n$$\n该表达式对正负 $T$ 均有效，因为它仅通过 $T^{2}$ 和关于 $\\Delta \\epsilon/(2 k_{B} T)$ 的偶函数 $\\cosh$ 来依赖于 $T$。", "answer": "$$\\boxed{N k_{B} \\left(\\frac{\\Delta \\epsilon}{2 k_{B} T}\\right)^{2} \\frac{1}{\\cosh^{2}\\!\\left(\\frac{\\Delta \\epsilon}{2 k_{B} T}\\right)}}$$", "id": "1969896"}, {"introduction": "在现代物理化学中，计算机模拟是计算热力学性质不可或缺的工具。这个高级练习旨在连接理论与实践，要求你通过数值方法验证统计力学中的一个基石恒等式：通过能量涨落计算的热容与通过平均能量对温度的导数计算的热容是等价的。通过模拟一个模型系统，你不仅将验证这一理论联系，还将亲身体验计算研究中有限取样和数值微分所带来的实际挑战 [@problem_id:2643817]。", "problem": "要求您为在恒定粒子数、体积和温度系综 (NVT) 中采样的系统，形式化、推导并数值验证两条独立的通往等容热容的正则系综路径。目标是检验当通过有限长度的 NVT“模拟”进行估算时，由能量涨落和由温度导数计算出的等容热容是否一致，并量化在不同采样条件下的差异。\n\n从正则系综及其基本定义开始。设哈密顿量为 $H(\\mathbf{q},\\mathbf{p})$，定义逆温度为 $\\beta = 1/\\left(k_{\\mathrm B} T\\right)$，其中 $k_{\\mathrm B}$ 是玻尔兹曼常数，$T$ 是绝对温度。正则配分函数为\n$$\nZ(\\beta) = \\int \\mathrm{d}\\mathbf{q}\\,\\mathrm{d}\\mathbf{p}\\,\\exp\\!\\left(-\\beta\\,H(\\mathbf{q},\\mathbf{p})\\right).\n$$\n任意可观测量 $A$ 的系综平均值为\n$$\n\\langle A\\rangle_{\\beta} = \\frac{1}{Z(\\beta)} \\int \\mathrm{d}\\mathbf{q}\\,\\mathrm{d}\\mathbf{p}\\,A(\\mathbf{q},\\mathbf{p})\\,\\exp\\!\\left(-\\beta\\,H(\\mathbf{q},\\mathbf{p})\\right).\n$$\n仅使用这些定义，推导系统等容热容 $C_V$ 的两个独立表达式：一个用定容下平均总能量对温度的导数表示，另一个用正则系综中总能量的平衡涨落表示。您的推导必须从上述正则定义出发，并且不得预先假设目标表达式的任何最终形式。\n\n对于数值验证，考虑一类其总能量是 $f$ 个独立二次自由度之和的系统。对于此类系统，微正则态密度随能量的幂次缩放，这导致正则能量分布为伽马分布。您将通过从给定 $f$ 和 $T$ 的正则能量分布中独立采样总能量来模拟“NVT 模拟”。使用 $k_{\\mathrm B} = 1.380649\\times 10^{-23}\\,\\mathrm{J}\\,\\mathrm{K}^{-1}$。\n\n对于下面的每个测试用例，在目标温度 $T_0$ 下，通过以下方式估算 $C_V$：\n- 在 $T_0$ 下的涨落路径，使用在 $T_0$ 采样的能量。\n- 温度导数路径，通过估算三个温度 $T_- = (1-\\delta)\\,T_0$、$T_0$ 和 $T_+ = (1+\\delta)\\,T_0$ 下的 $\\langle E\\rangle$，然后对 $T_0$ 处的斜率 $\\mathrm{d}\\langle E\\rangle/\\mathrm{d}T$ 进行对称有限差分估算。\n\n对于每个测试用例，报告两个 $C_V$ 估算值之间的绝对差，单位为 $\\mathrm{J}\\,\\mathrm{K}^{-1}$。将报告的每个差异以 $\\mathrm{J}\\,\\mathrm{K}^{-1}$ 为单位表示，并四舍五入到 $6$ 位有效数字。\n\n测试套件 (每个元组列出 $(f,\\,T_0,\\,N,\\,\\delta,\\,\\text{seed})$):\n- 用例 A (充分采样): $(60,\\;300\\,\\mathrm{K},\\;200000,\\;0.05,\\;12345)$\n- 用例 B (采样不足): $(6,\\;300\\,\\mathrm{K},\\;2000,\\;0.05,\\;2024)$\n- 用例 C (高温下自由度极少): $(2,\\;1000\\,\\mathrm{K},\\;1000,\\;0.10,\\;777)$\n- 用例 D (自由度多，中等采样): $(300,\\;300\\,\\mathrm{K},\\;50000,\\;0.02,\\;424242)$\n\n需要遵守的实现细节：\n- 将总能量 $E$ 建模为一个伽马分布的随机变量，该变量适用于温度 $T$ 下 $f$ 个独立二次自由度之和，并为给定测试用例所需的每个温度独立采样 $N$ 个能量。\n- 根据指定的种子，为每个测试用例使用独立的随机数流。\n- 对于导数路径，使用基于 $T_+$ 和 $T_-$ 处 $\\langle E\\rangle$ 的对称有限差分法。\n- 对于涨落路径，使用无偏样本方差从 $T_0$ 下的 $N$ 个能量估算方差。\n- 在数值上，所有能量以 $\\mathrm{J}$ 表示，所有热容以 $\\mathrm{J}\\,\\mathrm{K}^{-1}$ 表示。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，按上述测试套件的顺序列出结果。每个条目必须是相应测试用例的两个 $C_V$ 估算值之间的绝对差，单位为 $\\mathrm{J}\\,\\mathrm{K}^{-1}$，并四舍五入到 $6$ 位有效数字 (例如, $[1.23457\\mathrm{e}{-05},2.34568\\mathrm{e}{-06},\\dots]$)。不允许有其他输出。", "solution": "我们从正则系综开始。配分函数为 $Z(\\beta) = \\int \\mathrm{d}\\mathbf{q}\\,\\mathrm{d}\\mathbf{p}\\,\\exp\\!\\left(-\\beta\\,H(\\mathbf{q},\\mathbf{p})\\right)$，其中 $\\beta = 1/\\left(k_{\\mathrm B} T\\right)$。总能量 $E = H(\\mathbf{q},\\mathbf{p})$ 的系综平均值为\n$$\n\\langle E\\rangle_{\\beta} = \\frac{1}{Z(\\beta)} \\int \\mathrm{d}\\mathbf{q}\\,\\mathrm{d}\\mathbf{p}\\,H(\\mathbf{q},\\mathbf{p})\\,\\exp\\!\\left(-\\beta\\,H(\\mathbf{q},\\mathbf{p})\\right).\n$$\n从 $Z(\\beta)$ 推导出的一个著名恒等式是 $\\langle E\\rangle_{\\beta} = -\\partial \\ln Z/\\partial \\beta$。对 $\\beta$ 再求一次导数可得\n$$\n\\frac{\\partial \\langle E\\rangle}{\\partial \\beta} = -\\frac{\\partial^2 \\ln Z}{\\partial \\beta^2} = -\\left(\\langle E^2\\rangle - \\langle E\\rangle^2\\right) = -\\mathrm{Var}(E).\n$$\n使用 $\\beta = 1/\\left(k_{\\mathrm B} T\\right)$，我们有 $\\mathrm{d}\\beta/\\mathrm{d}T = -1/\\left(k_{\\mathrm B} T^2\\right)$。根据链式法则，\n$$\n\\frac{\\mathrm{d}\\langle E\\rangle}{\\mathrm{d}T} = \\frac{\\mathrm{d}\\langle E\\rangle}{\\mathrm{d}\\beta}\\,\\frac{\\mathrm{d}\\beta}{\\mathrm{d}T} = \\left(-\\mathrm{Var}(E)\\right)\\left(-\\frac{1}{k_{\\mathrm B} T^2}\\right) = \\frac{\\mathrm{Var}(E)}{k_{\\mathrm B} T^2}.\n$$\n因此，在正则系综中定义为 $C_V = \\left(\\partial \\langle E\\rangle/\\partial T\\right)_V$ 的等容热容，有两个等价的表达式：\n- 导数路径：$C_V = \\left(\\partial \\langle E\\rangle/\\partial T\\right)_V$。\n- 涨落路径：$C_V = \\mathrm{Var}(E)/\\left(k_{\\mathrm B} T^2\\right)$。\n\n对于任何不显式依赖于温度的哈密顿量 $H$，这些表达式在正则系综中是精确的。它们为我们的数值测试提供了理论基础。\n\n为了构建一个解析上易于处理的类 NVT 采样器，我们现在专门研究一类其总能量是 $f$ 个独立二次自由度之和的系统。对于这样的系统，微正则态密度按 $g(E)\\propto E^{f/2 - 1}$ 的形式缩放。在正则系综中，总能量的概率密度则为\n$$\np(E;\\beta) = \\frac{1}{Z_E(\\beta)}\\,g(E)\\,\\mathrm{e}^{-\\beta E} \\propto E^{\\alpha-1}\\,\\mathrm{e}^{-E/\\theta},\n$$\n其中形状参数为 $\\alpha = f/2$，尺度参数为 $\\theta = k_{\\mathrm B} T$。这正是一个形状为 $\\alpha$、尺度为 $\\theta$ 的伽马分布。其矩为 $\\langle E\\rangle = \\alpha\\,\\theta$ 和 $\\mathrm{Var}(E) = \\alpha\\,\\theta^2$。因此，这类系统的精确等容热容为 $C_V = \\alpha\\,k_{\\mathrm B} = (f/2)\\,k_{\\mathrm B}$。然而，在有限的“模拟”中，我们无法获得精确的矩，而是样本估算值，这导致在存在统计噪声和数值微分误差时，两条数值路径之间出现差异。\n\n数值测试的算法设计：\n1. 对每个测试用例，固定 $f$、$T_0$、$N$、$\\delta$ 和随机种子。设置 $k_{\\mathrm B} = 1.380649\\times 10^{-23}\\,\\mathrm{J}\\,\\mathrm{K}^{-1}$。\n2. 定义 $\\alpha = f/2$，并对任意温度 $T$，设置 $\\theta(T) = k_{\\mathrm B} T$。\n3. 从形状为 $\\alpha$、尺度为 $\\theta(T_0)$ 的伽马分布中采样 $N$ 个独立能量，以模拟 $T_0$ 下的 NVT 轨迹。计算无偏样本方差 $\\widehat{\\mathrm{Var}}(E;T_0)$ 并构建涨落估算式\n$$\n\\widehat{C_V}^{(\\mathrm{fluc})}(T_0) = \\frac{\\widehat{\\mathrm{Var}}(E;T_0)}{k_{\\mathrm B} T_0^2}.\n$$\n4. 对于导数路径，定义 $T_- = (1-\\delta)\\,T_0$ 和 $T_+ = (1+\\delta)\\,T_0$。在 $T_-$ 和 $T_+$ 下，从伽马分布中独立采样 $N$ 个能量，并计算相应的样本均值 $\\widehat{\\langle E\\rangle}(T_-)$ 和 $\\widehat{\\langle E\\rangle}(T_+)$。构建对称有限差分估算式\n$$\n\\widehat{C_V}^{(\\mathrm{deriv})}(T_0) = \\frac{\\widehat{\\langle E\\rangle}(T_+) - \\widehat{\\langle E\\rangle}(T_-)}{T_+ - T_-}.\n$$\n5. 对每个测试用例，计算绝对差\n$$\n\\Delta = \\left|\\widehat{C_V}^{(\\mathrm{fluc})}(T_0) - \\widehat{C_V}^{(\\mathrm{deriv})}(T_0)\\right|\n$$\n以 $\\mathrm{J}\\,\\mathrm{K}^{-1}$ 为单位。\n6. 按测试套件的顺序，将四个 $\\Delta$ 值输出为单行：一个用方括号括起来的逗号分隔列表，每个值都四舍五入到 $6$ 位有效数字。\n\n科学真实性与差异来源：\n- 有限采样：对于有限的 $N$，样本方差和有限差分斜率都存在噪声，导致非零的 $\\Delta$。对于独立样本，采样误差大致按 $N^{-1/2}$ 缩放。\n- 数值微分：导数路径使用有限的温度增量来估算斜率。对于非线性的 $\\langle E\\rangle(T)$，过大的 $\\delta$ 会引入截断误差；过小的 $\\delta$ 会放大统计噪声。在我们的二次基准模型中，$\\langle E\\rangle(T)$ 与 $T$ 呈线性关系，因此截断误差消失，但噪声依然存在。\n- 自相关和平衡 (此处未显式建模)：在真实的 NVT 分子动力学中，相关的样本会减小有效样本量并使朴素的误差估算产生偏差；不充分的平衡会对两条路径都产生偏差。\n- 恒温器伪影和非正则采样 (此处未建模)：如果构型分布偏离正则分布，涨落-导数恒等式可能看起来会失效。\n- 在理想的正则采样下，当 $N\\to\\infty$ 时，两条路径收敛到相同的值，并且报告的 $\\Delta$ 值会随着 $N$ 和 $f$ 的增加而减小（后者是因为相对涨落减小），这与中心极限定理以及两个估算量对于 $C_V$ 都是一致的这一事实相符。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef sample_energies_gamma(f, T, N, rng, k_B):\n    \"\"\"\n    Sample total energies for a system with f quadratic degrees of freedom\n    from the canonical ensemble at temperature T using the gamma distribution.\n    shape = alpha = f/2\n    scale = theta = k_B * T\n    \"\"\"\n    alpha = 0.5 * f\n    theta = k_B * T\n    # numpy.random.Generator.gamma uses shape (k) and scale (theta)\n    E = rng.gamma(shape=alpha, scale=theta, size=N)\n    return E\n\ndef cv_fluctuation(energies, T, k_B):\n    \"\"\"\n    Compute C_V via the fluctuation formula using unbiased sample variance.\n    \"\"\"\n    var_e = np.var(energies, ddof=1)\n    return var_e / (k_B * T * T)\n\ndef cv_derivative(f, T0, delta, N, rng, k_B):\n    \"\"\"\n    Compute C_V via finite difference derivative using sample means at T+ and T-.\n    \"\"\"\n    T_minus = (1.0 - delta) * T0\n    T_plus = (1.0 + delta) * T0\n    E_minus = sample_energies_gamma(f, T_minus, N, rng, k_B)\n    E_plus = sample_energies_gamma(f, T_plus, N, rng, k_B)\n    mean_minus = np.mean(E_minus)\n    mean_plus = np.mean(E_plus)\n    slope = (mean_plus - mean_minus) / (T_plus - T_minus)\n    return slope\n\ndef solve():\n    # Constants\n    k_B = 1.380649e-23  # J/K\n\n    # Define the test cases from the problem statement.\n    # Each case: (f, T0 [K], N samples, delta, seed)\n    test_cases = [\n        (60, 300.0, 200000, 0.05, 12345),   # Case A\n        (6, 300.0, 2000, 0.05, 2024),       # Case B\n        (2, 1000.0, 1000, 0.10, 777),       # Case C\n        (300, 300.0, 50000, 0.02, 424242),  # Case D\n    ]\n\n    results = []\n    for f, T0, N, delta, seed in test_cases:\n        rng = np.random.default_rng(seed)\n        # Fluctuation route at T0\n        E_T0 = sample_energies_gamma(f, T0, N, rng, k_B)\n        cv_fluc = cv_fluctuation(E_T0, T0, k_B)\n        # Derivative route via symmetric finite difference\n        # Use a new RNG stream for derivative sampling to avoid overlap\n        rng_deriv = np.random.default_rng(seed + 1)\n        cv_der = cv_derivative(f, T0, delta, N, rng_deriv, k_B)\n        diff = abs(cv_fluc - cv_der)\n        # Round to 6 significant figures for output formatting\n        results.append(diff)\n\n    # Format each float to 6 significant figures using general format\n    formatted = []\n    for x in results:\n        # Use numpy formatting to ensure scientific notation for very small values\n        formatted.append(f\"{x:.6g}\")\n    print(f\"[{','.join(formatted)}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "2643817"}]}