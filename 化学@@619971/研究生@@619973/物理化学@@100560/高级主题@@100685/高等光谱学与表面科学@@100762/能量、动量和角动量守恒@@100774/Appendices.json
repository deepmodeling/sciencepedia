{"hands_on_practices": [{"introduction": "守恒定律不仅是经验观察的结果，更深植于系统的对称性之中。拉格朗日力学为揭示这种深刻联系提供了强有力的工具：若系统的拉格朗日量 $L$ 在某个坐标变换下保持不变（即存在对称性），那么与之共轭的动量必然守恒。本练习 [@problem_id:2632504] 将指导你完成一个具体的推导，展示对于中心势场，角动量的 $z$ 分量是如何从系统绕 $z$ 轴的旋转对称性中自然产生的。", "problem": "一个质量为 $m$ 的单个原子在中心势 $V(r)$ 的作用下于三维空间中运动，其中 $r$ 是原子到一固定原点的距离。通过笛卡尔坐标变换 $x = r \\sin\\theta \\cos\\phi$、$y = r \\sin\\theta \\sin\\phi$ 和 $z = r \\cos\\theta$ 引入球极坐标 $(r,\\theta,\\phi)$。从动能的定义 $T = \\tfrac{1}{2} m \\left(\\dot{x}^{2} + \\dot{y}^{2} + \\dot{z}^{2}\\right)$ 和拉格朗日量 $L = T - V$ 出发，推导与广义坐标 $(r,\\theta,\\phi)$ 相关联的共轭动量 $(p_{r},p_{\\theta},p_{\\phi})$ 的表达式。然后，仅使用拉格朗日力学的第一性原理，证明对于中心势，$p_{\\phi}$ 是守恒的。\n\n假设角度以弧度为单位。请以行矩阵 $\\begin{pmatrix}p_{r} & p_{\\theta} & p_{\\phi}\\end{pmatrix}$ 的形式给出最终答案，并用 $m$、$r$、$\\theta$、$\\dot{r}$、$\\dot{\\theta}$ 和 $\\dot{\\phi}$ 表示。答案中不应包含单位。无需进行数值近似或四舍五入。你的推导过程必须从基本定律和核心定义出发，不得直接引用目标结果。", "solution": "该问题陈述是经典力学中的一个标准练习，为分析提供了一个有效且适定的框架。它是基于科学的、自洽的且客观的。我们将着手进行推导。\n\n目标是推导在中心势中运动的粒子的球极坐标下的共轭动量，并证明与方位角 $\\phi$ 共轭的动量是守恒的。\n\n我们从给定的笛卡尔坐标 $(x, y, z)$ 及其到球极坐标 $(r, \\theta, \\phi)$ 的变换开始：\n$$x = r \\sin\\theta \\cos\\phi$$\n$$y = r \\sin\\theta \\sin\\phi$$\n$$z = r \\cos\\theta$$\n\n为了用球坐标表示动能 $T$，我们必须首先求出笛卡尔坐标对时间的导数。使用对时间 $t$ 求导的链式法则：\n$$\\dot{x} = \\frac{dx}{dt} = \\frac{\\partial x}{\\partial r}\\dot{r} + \\frac{\\partial x}{\\partial \\theta}\\dot{\\theta} + \\frac{\\partial x}{\\partial \\phi}\\dot{\\phi} = \\dot{r}\\sin\\theta\\cos\\phi + r\\dot{\\theta}\\cos\\theta\\cos\\phi - r\\dot{\\phi}\\sin\\theta\\sin\\phi$$\n$$\\dot{y} = \\frac{dy}{dt} = \\frac{\\partial y}{\\partial r}\\dot{r} + \\frac{\\partial y}{\\partial \\theta}\\dot{\\theta} + \\frac{\\partial y}{\\partial \\phi}\\dot{\\phi} = \\dot{r}\\sin\\theta\\sin\\phi + r\\dot{\\theta}\\cos\\theta\\sin\\phi + r\\dot{\\phi}\\sin\\theta\\cos\\phi$$\n$$\\dot{z} = \\frac{dz}{dt} = \\frac{\\partial z}{\\partial r}\\dot{r} + \\frac{\\partial z}{\\partial \\theta}\\dot{\\theta} + \\frac{\\partial z}{\\partial \\phi}\\dot{\\phi} = \\dot{r}\\cos\\theta - r\\dot{\\theta}\\sin\\theta$$\n\n接下来，我们计算这些速度的平方和 $\\dot{x}^{2} + \\dot{y}^{2} + \\dot{z}^{2}$。\n首先，我们对 $\\dot{x}^{2}$ 和 $\\dot{y}^{2}$ 求和：\n$$\\dot{x}^{2} + \\dot{y}^{2} = (\\dot{r}\\sin\\theta\\cos\\phi + r\\dot{\\theta}\\cos\\theta\\cos\\phi - r\\dot{\\phi}\\sin\\theta\\sin\\phi)^{2} + (\\dot{r}\\sin\\theta\\sin\\phi + r\\dot{\\theta}\\cos\\theta\\sin\\phi + r\\dot{\\phi}\\sin\\theta\\cos\\phi)^{2}$$\n展开并按广义速度分组各项：\n\\begin{itemize}\n    \\item 含有 $\\dot{r}^{2}$ 的项：$\\dot{r}^{2}\\sin^{2}\\theta\\cos^{2}\\phi + \\dot{r}^{2}\\sin^{2}\\theta\\sin^{2}\\phi = \\dot{r}^{2}\\sin^{2}\\theta(\\cos^{2}\\phi + \\sin^{2}\\phi) = \\dot{r}^{2}\\sin^{2}\\theta$\n    \\item 含有 $\\dot{\\theta}^{2}$ 的项：$r^{2}\\dot{\\theta}^{2}\\cos^{2}\\theta\\cos^{2}\\phi + r^{2}\\dot{\\theta}^{2}\\cos^{2}\\theta\\sin^{2}\\phi = r^{2}\\dot{\\theta}^{2}\\cos^{2}\\theta(\\cos^{2}\\phi + \\sin^{2}\\phi) = r^{2}\\dot{\\theta}^{2}\\cos^{2}\\theta$\n    \\item 含有 $\\dot{\\phi}^{2}$ 的项：$r^{2}\\dot{\\phi}^{2}\\sin^{2}\\theta\\sin^{2}\\phi + r^{2}\\dot{\\phi}^{2}\\sin^{2}\\theta\\cos^{2}\\phi = r^{2}\\dot{\\phi}^{2}\\sin^{2}\\theta(\\sin^{2}\\phi + \\cos^{2}\\phi) = r^{2}\\dot{\\phi}^{2}\\sin^{2}\\theta$\n    \\item 含有 $\\dot{r}\\dot{\\theta}$ 的交叉项：$2\\dot{r}r\\dot{\\theta}\\sin\\theta\\cos\\theta\\cos^{2}\\phi + 2\\dot{r}r\\dot{\\theta}\\sin\\theta\\cos\\theta\\sin^{2}\\phi = 2\\dot{r}r\\dot{\\theta}\\sin\\theta\\cos\\theta$\n    \\item 含有 $\\dot{r}\\dot{\\phi}$ 的交叉项：$-2\\dot{r}r\\dot{\\phi}\\sin^{2}\\theta\\cos\\phi\\sin\\phi + 2\\dot{r}r\\dot{\\phi}\\sin^{2}\\theta\\sin\\phi\\cos\\phi = 0$\n    \\item 含有 $\\dot{\\theta}\\dot{\\phi}$ 的交叉项：$-2r^{2}\\dot{\\theta}\\dot{\\phi}\\cos\\theta\\sin\\theta\\cos\\phi\\sin\\phi + 2r^{2}\\dot{\\theta}\\dot{\\phi}\\cos\\theta\\sin\\theta\\sin\\phi\\cos\\phi = 0$\n\\end{itemize}\n将这些结果相加，我们得到：\n$$\\dot{x}^{2} + \\dot{y}^{2} = \\dot{r}^{2}\\sin^{2}\\theta + r^{2}\\dot{\\theta}^{2}\\cos^{2}\\theta + r^{2}\\dot{\\phi}^{2}\\sin^{2}\\theta + 2\\dot{r}r\\dot{\\theta}\\sin\\theta\\cos\\theta$$\n现在，我们加上 $\\dot{z}^{2}$：\n$$\\dot{z}^{2} = (\\dot{r}\\cos\\theta - r\\dot{\\theta}\\sin\\theta)^{2} = \\dot{r}^{2}\\cos^{2}\\theta - 2\\dot{r}r\\dot{\\theta}\\cos\\theta\\sin\\theta + r^{2}\\dot{\\theta}^{2}\\sin^{2}\\theta$$\n总和为：\n$$\\dot{x}^{2} + \\dot{y}^{2} + \\dot{z}^{2} = (\\dot{r}^{2}\\sin^{2}\\theta + \\dot{r}^{2}\\cos^{2}\\theta) + (r^{2}\\dot{\\theta}^{2}\\cos^{2}\\theta + r^{2}\\dot{\\theta}^{2}\\sin^{2}\\theta) + r^{2}\\dot{\\phi}^{2}\\sin^{2}\\theta$$\n使用恒等式 $\\sin^{2}\\theta + \\cos^{2}\\theta = 1$，我们将其化简为：\n$$\\dot{x}^{2} + \\dot{y}^{2} + \\dot{z}^{2} = \\dot{r}^{2} + r^{2}\\dot{\\theta}^{2} + r^{2}\\sin^{2}\\theta\\dot{\\phi}^{2}$$\n因此，动能 $T$ 为：\n$$T = \\frac{1}{2}m(\\dot{r}^{2} + r^{2}\\dot{\\theta}^{2} + r^{2}\\sin^{2}\\theta\\dot{\\phi}^{2})$$\n拉格朗日量 $L$ 定义为 $L = T - V$。由于势是中心势，$V = V(r)$，它仅是 $r$ 的函数。\n$$L(r, \\theta, \\dot{r}, \\dot{\\theta}, \\dot{\\phi}) = \\frac{1}{2}m(\\dot{r}^{2} + r^{2}\\dot{\\theta}^{2} + r^{2}\\sin^{2}\\theta\\dot{\\phi}^{2}) - V(r)$$\n与广义坐标 $q$ 共轭的广义动量 $p_{q}$ 定义为 $p_{q} = \\frac{\\partial L}{\\partial \\dot{q}}$。我们将此定义应用于每个坐标 $(r, \\theta, \\phi)$：\n$r$ 的共轭动量：\n$$p_{r} = \\frac{\\partial L}{\\partial \\dot{r}} = \\frac{\\partial}{\\partial \\dot{r}}\\left[\\frac{1}{2}m(\\dot{r}^{2} + r^{2}\\dot{\\theta}^{2} + r^{2}\\sin^{2}\\theta\\dot{\\phi}^{2}) - V(r)\\right] = m\\dot{r}$$\n$\\theta$ 的共轭动量：\n$$p_{\\theta} = \\frac{\\partial L}{\\partial \\dot{\\theta}} = \\frac{\\partial}{\\partial \\dot{\\theta}}\\left[\\frac{1}{2}m(\\dot{r}^{2} + r^{2}\\dot{\\theta}^{2} + r^{2}\\sin^{2}\\theta\\dot{\\phi}^{2}) - V(r)\\right] = mr^{2}\\dot{\\theta}$$\n$\\phi$ 的共轭动量：\n$$p_{\\phi} = \\frac{\\partial L}{\\partial \\dot{\\phi}} = \\frac{\\partial}{\\partial \\dot{\\phi}}\\left[\\frac{1}{2}m(\\dot{r}^{2} + r^{2}\\dot{\\theta}^{2} + r^{2}\\sin^{2}\\theta\\dot{\\phi}^{2}) - V(r)\\right] = mr^{2}\\sin^{2}\\theta\\dot{\\phi}$$\n这些就是共轭动量的表达式。\n\n现在我们必须证明 $p_{\\phi}$ 是守恒的。根据拉格朗日力学，广义坐标 $q$ 的运动方程是欧拉-拉格朗日方程 (Euler-Lagrange equation)：\n$$\\frac{d}{dt}\\left(\\frac{\\partial L}{\\partial \\dot{q}}\\right) - \\frac{\\partial L}{\\partial q} = 0$$\n对于坐标 $\\phi$，该方程为：\n$$\\frac{d}{dt}\\left(\\frac{\\partial L}{\\partial \\dot{\\phi}}\\right) - \\frac{\\partial L}{\\partial \\phi} = 0$$\n代入我们关于 $p_{\\phi} = \\frac{\\partial L}{\\partial \\dot{\\phi}}$ 的结果，我们得到：\n$$\\frac{dp_{\\phi}}{dt} = \\frac{\\partial L}{\\partial \\phi}$$\n如果一个量的全时间导数为零，则该量是守恒的。因此，$p_{\\phi}$ 守恒当且仅当 $\\frac{\\partial L}{\\partial \\phi} = 0$。我们来考察拉格朗日量：\n$$L = \\frac{1}{2}m(\\dot{r}^{2} + r^{2}\\dot{\\theta}^{2} + r^{2}\\sin^{2}\\theta\\dot{\\phi}^{2}) - V(r)$$\n拉格朗日量依赖于 $r$、$\\theta$、$\\dot{r}$、$\\dot{\\theta}$ 和 $\\dot{\\phi}$，但它不显式依赖于坐标 $\\phi$。这有两个原因：1）用球坐标表示的自由粒子的动能项与 $\\phi$ 无关，这反映了空间相对于绕原点旋转的各向同性；2）势 $V(r)$ 是中心势，这意味着它是球面对称的，因此也与 $\\phi$ 无关。\n因此，$L$ 对 $\\phi$ 的偏导数恒等于零：\n$$\\frac{\\partial L}{\\partial \\phi} = 0$$\n将此结果代入 $\\phi$ 的欧拉-拉格朗日方程，得到：\n$$\\frac{dp_{\\phi}}{dt} = 0$$\n这证明了 $p_{\\phi}$ 是一个运动常量。像本例中的 $\\phi$ 这样不显式出现在拉格朗日量中的坐标，被称为循环坐标或可忽略坐标。其共轭动量的守恒是系统相对于绕 z 轴旋转对称性的一个直接推论，这是 Noether 定理的一个实例。\n共轭动量的表达式至此最终确定。", "answer": "$$\\boxed{\\begin{pmatrix} m\\dot{r} & mr^{2}\\dot{\\theta} & mr^{2}\\sin^{2}\\theta\\dot{\\phi} \\end{pmatrix}}$$", "id": "2632504"}, {"introduction": "从经典领域过渡到量子世界，我们不禁要问：当分子与激光等外场相互作用时，能量守恒是如何体现的？本练习将带你探索量子力学中的功-能定理，证明外场对分子所做的“功”，即传递给系统的总能量，恰好等于分子内能期望值的变化。通过分析一个被共振脉冲驱动的二能级系统的动力学过程 [@problem_id:2632486]，你将亲手验证能量如何从场转移到分子，最终表现为分子的激发能，这与吸收一个能量为 $\\hbar \\omega_{0}$ 的光子是等效的。", "problem": "一个孤立的单分子生色团被建模为一个两能级系统，其稳态为 $\\lvert g \\rangle$ 和 $\\lvert e \\rangle$，裸哈密顿量为 $H_{0}$，能级间距为 $\\hbar \\omega_{0}$，其中 $H_{0} \\lvert g \\rangle = 0$ 且 $H_{0} \\lvert e \\rangle = \\hbar \\omega_{0} \\lvert e \\rangle$。该分子在电偶极近似下与一个线性偏振的经典电场相互作用\n$$\nE(t) = E_{0} \\cos(\\omega_{0} t)\\, f(t),\n$$\n其中包络 $f(t)$ 在有限时长 $T$ 内平滑地开启和关闭电场，使得 $f(0)=0$ 且 $f(T)=0$。偶极算符为 $\\hat{\\mu} = \\mu \\left(\\lvert e \\rangle \\langle g \\rvert + \\lvert g \\rangle \\langle e \\rvert \\right)$，其中 $\\mu>0$ 为实数，且其方向与电场偏振方向一致。总哈密顿量为 $H(t) = H_{0} - \\hat{\\mu}\\, E(t)$，且无耗散。\n\n假设精确共振且旋转波近似 (RWA) 成立。包络 $f(t)$ 的选择使得脉冲面积等于 $\\pi$，即：\n$$\n\\int_{0}^{T} \\frac{\\mu E_{0}}{\\hbar} f(t)\\, dt = \\pi,\n$$\n这确保了在脉冲结束时，布居数从 $\\lvert g \\rangle$ 完全转移到 $\\lvert e \\rangle$。系统在 $t=0$ 时被制备在基态 $\\lvert g \\rangle$。\n\n仅使用含时哈密顿量的基本动力学关系和上述设置，计算在区间 $[0,T]$ 内电场对该两能级系统所做的总功 $W$，其定义为\n$$\nW \\equiv \\int_{0}^{T} \\left\\langle \\frac{\\partial H(t)}{\\partial t} \\right\\rangle dt,\n$$\n并通过考虑与共振场的光子交换来验证能量守恒。\n\n将 $W$ 的最终答案表示为以 $\\hbar$ 和 $\\omega_{0}$ 表示的闭合形式符号表达式。在最终的方框表达式中不要包含单位。在您的解中进行物理解释。", "solution": "对问题陈述的分析表明其是有效的。这是一个提法恰当、有科学依据的问题，属于物理化学中的一个标准课题——光与物质相互作用的量子力学。所有必要信息均已提供，不存在内部矛盾或违反物理原理之处。我们可以开始求解。\n\n该问题要求计算在时间区间 $[0, T]$ 内，经典电场对两能级系统所做的总功 $W$。功的定义为：\n$$\nW = \\int_{0}^{T} \\left\\langle \\frac{\\partial H(t)}{\\partial t} \\right\\rangle dt\n$$\n其中 $H(t)$ 是系统的总含时哈密顿量，期望值是针对系统随时间演化的状态 $\\lvert \\psi(t) \\rangle$ 计算的。\n\n从含时薛定谔方程 $i\\hbar \\frac{d}{dt} \\lvert \\psi(t) \\rangle = H(t) \\lvert \\psi(t) \\rangle$ 推导出的一个基本结果是功-能定理的量子力学等价形式。哈密顿量期望值的时间导数由下式给出：\n$$\n\\frac{d}{dt} \\langle H(t) \\rangle = \\frac{d}{dt} \\langle \\psi(t) | H(t) | \\psi(t) \\rangle = \\left\\langle \\frac{d \\psi}{dt} \\right| H(t) \\left| \\psi(t) \\right\\rangle + \\left\\langle \\psi(t) \\right| H(t) \\left| \\frac{d \\psi}{dt} \\right\\rangle + \\left\\langle \\psi(t) \\left| \\frac{\\partial H(t)}{\\partial t} \\right| \\psi(t) \\right\\rangle\n$$\n代入薛定谔方程及其共轭形式，我们得到：\n$$\n\\frac{d}{dt} \\langle H(t) \\rangle = \\frac{1}{-i\\hbar} \\langle \\psi | H^{\\dagger} H | \\psi \\rangle + \\frac{1}{i\\hbar} \\langle \\psi | H H | \\psi \\rangle + \\left\\langle \\frac{\\partial H(t)}{\\partial t} \\right\\rangle\n$$\n由于哈密顿量 $H(t)$ 是厄米算符（$H^{\\dagger}(t)=H(t)$），前两项相互抵消。这就得到了直接关系式：\n$$\n\\frac{d}{dt} \\langle H(t) \\rangle = \\left\\langle \\frac{\\partial H(t)}{\\partial t} \\right\\rangle\n$$\n将此表达式从 $t=0$ 到 $t=T$ 对时间进行积分，即可得到所做的总功：\n$$\nW = \\int_{0}^{T} \\frac{d}{dt} \\langle H(t) \\rangle dt = \\langle H(T) \\rangle - \\langle H(0) \\rangle\n$$\n因此，问题简化为求解相互作用开始和结束时总哈密顿量的期望值。\n\n在初始时刻 $t=0$，系统处于基态 $\\lvert \\psi(0) \\rangle = \\lvert g \\rangle$。根据题设，此时电场包络 $f(t)$ 为零，$f(0)=0$。因此，总哈密顿量为 $H(0) = H_{0} - \\hat{\\mu} E_0 f(0) \\cos(0) = H_{0}$。初始能量期望值为：\n$$\n\\langle H(0) \\rangle = \\langle \\psi(0) | H_{0} | \\psi(0) \\rangle = \\langle g | H_{0} | g \\rangle = 0\n$$\n这与问题中对基态能量的定义一致。\n\n接下来，我们确定系统在最终时刻 $t=T$ 的状态。在旋转波近似 (RWA) 和共振条件下，状态的演化由哈密顿量 $H(t) = H_0 - \\hat{\\mu} E(t)$ 决定。在相对于 $H_0$ 的相互作用绘景中，态矢量 $\\lvert \\psi_I(t) \\rangle = \\exp(i H_0 t / \\hbar) \\lvert \\psi(t) \\rangle$ 的演化遵循哈密顿量 $H_I^{RWA}(t)$。在共振时，该哈密顿量为：\n$$\nH_I^{RWA}(t) = -\\frac{\\mu E_0 f(t)}{2} \\left( \\lvert e \\rangle \\langle g \\rvert + \\lvert g \\rangle \\langle e \\rvert \\right)\n$$\n让我们定义含时拉比频率 $\\Omega_R(t) = \\frac{\\mu E_0 f(t)}{\\hbar}$。对于初始态 $\\lvert \\psi_I(0) \\rangle = \\lvert g \\rangle$，薛定谔方程 $i\\hbar \\frac{d}{dt}|\\psi_I(t)\\rangle=H_I^{RWA}(t)|\\psi_I(t)\\rangle$ 的解是拉比动力学的一个标准结果：\n$$\n\\lvert \\psi_I(t) \\rangle = \\cos\\left(\\frac{1}{2}\\int_0^t \\Omega_R(t') dt'\\right) \\lvert g \\rangle - i \\sin\\left(\\frac{1}{2}\\int_0^t \\Omega_R(t') dt'\\right) \\lvert e \\rangle\n$$\n问题陈述指出脉冲面积为 $\\pi$。脉冲面积 $\\theta(T)$ 定义为：\n$$\n\\theta(T) = \\int_0^T \\Omega_R(t) dt = \\int_0^T \\frac{\\mu E_0 f(t)}{\\hbar} dt = \\pi\n$$\n将此代入 $t=T$ 时的状态表达式中：\n$$\n\\lvert \\psi_I(T) \\rangle = \\cos\\left(\\frac{\\pi}{2}\\right) \\lvert g \\rangle - i \\sin\\left(\\frac{\\pi}{2}\\right) \\lvert e \\rangle = (0)\\lvert g \\rangle - i(1)\\lvert e \\rangle = -i \\lvert e \\rangle\n$$\n这证实了从 $\\lvert g \\rangle$到 $\\lvert e \\rangle$ 的完全布居数转移。\n为了求出期望值 $\\langle H(T) \\rangle$，我们需要薛定谔绘景中的状态：\n$$\n\\lvert \\psi(T) \\rangle = e^{-i H_0 T / \\hbar} \\lvert \\psi_I(T) \\rangle = e^{-i H_0 T / \\hbar} (-i \\lvert e \\rangle) = -i e^{-i \\omega_0 T} \\lvert e \\rangle\n$$\n在最终时刻 $t=T$，包络函数再次为零，$f(T)=0$。因此，哈密顿量为 $H(T) = H_0$。能量期望值为：\n$$\n\\langle H(T) \\rangle = \\langle \\psi(T) | H_0 | \\psi(T) \\rangle = \\left( i e^{i \\omega_0 T} \\langle e | \\right) H_0 \\left( -i e^{-i \\omega_0 T} \\lvert e \\rangle \\right) = \\langle e | H_0 | e \\rangle = \\hbar \\omega_0\n$$\n因此，电场做的总功为：\n$$\nW = \\langle H(T) \\rangle - \\langle H(0) \\rangle = \\hbar \\omega_0 - 0 = \\hbar \\omega_0\n$$\n从物理上讲，这个结果可以解释如下。功 $W$ 代表从外场转移到分子系统的净能量。计算表明，该能量恰好是 $\\hbar \\omega_0$。分子内能（裸哈密顿量 $H_0$ 的期望值）的变化量为 $\\Delta \\langle H_0 \\rangle = \\langle H_0 \\rangle_T - \\langle H_0 \\rangle_0 = \\hbar \\omega_0 - 0 = \\hbar\\omega_0$。因此，电场所做的功完全转化为分子的激发能。\n这个过程验证了能量守恒。分子获得了能量 $\\hbar\\omega_0$，而这个能量是由电磁场提供的。在量子化场的图像中，这对应于从共振场中吸收一个能量为 $\\hbar\\omega_0$ 的单光子，导致分子从其基态跃迁到激发态。孤立的分子-场系统的总能量是守恒的。", "answer": "$$\\boxed{\\hbar \\omega_{0}}$$", "id": "2632486"}, {"introduction": "理论定律是精确的，但它们在计算机模拟中的数值实现却面临挑战。我们如何在分子动力学（MD）模拟中有效地维持守恒定律？本练习 [@problem_id:2632556] 旨在考察不同数值积分算法的性能，对比为保持哈密顿动力学几何结构而设计的辛积分算法（如速度 Verlet 算法）与更简单的非辛积分算法（如显式欧拉法）。通过亲手实现并测试这些积分器，你将获得模拟物理系统的第一手经验，直观地观察到能量漂移现象，并理解为何选择合适的算法对生成物理上可靠的模拟结果至关重要。", "problem": "考虑一个二维空间中的双粒子分子动力学模型，其运动由牛顿第二定律 $m \\,\\mathbf{\\ddot{r}}_i = \\mathbf{F}_i$ 控制，其中 $i \\in \\{1,2\\}$，$m$ 是粒子质量，$\\mathbf{r}_i \\in \\mathbb{R}^2$ 是粒子 $i$ 的位置。粒子通过中心、保守的谐波势 $V(\\mathbf{r}_1,\\mathbf{r}_2) = \\tfrac{1}{2} k \\lVert \\mathbf{r}_1 - \\mathbf{r}_2 \\rVert^2$ 相互作用，其中弹簧常数 $k > 0$。因此，保守力为 $\\mathbf{F}_{1}^{\\mathrm{cons}} = -\\nabla_{\\mathbf{r}_1} V = -k(\\mathbf{r}_1 - \\mathbf{r}_2)$ 和 $\\mathbf{F}_{2}^{\\mathrm{cons}} = -\\mathbf{F}_{1}^{\\mathrm{cons}}$。可选地，一个线性粘性阻力 $\\mathbf{F}_i^{\\mathrm{drag}} = -\\gamma m \\mathbf{v}_i$ 可能会作用于每个粒子，其中 $\\gamma \\ge 0$ 且 $\\mathbf{v}_i = \\mathbf{\\dot{r}}_i$。\n\n使用 Lennard-Jones 约化单位：选择质量 $m = 1$，长度 $\\sigma = 1$，能量 $\\epsilon = 1$，因此约化时间单位为 $\\tau = \\sqrt{m \\sigma^2/\\epsilon} = 1$。所有报告的量都必须用这些约化单位表示。具体来说：\n- 能量漂移率以 $\\epsilon/\\tau$ 为单位报告。\n- 动量漂移率以 $(m \\sigma)/\\tau^2$ 为单位报告。\n- 角动量漂移率以 $(m \\sigma^2)/\\tau^2$ 为单位报告。\n\n初始条件设置如下。令 $k = 1$，$a = 1$，并定义相对坐标的自然频率 $\\omega = \\sqrt{2k/m}$。初始化位置和速度为\n$\\mathbf{r}_1(0) = (a, 0)$，$\\mathbf{r}_2(0) = (-a, 0)$，$\\mathbf{v}_1(0) = (u, v_0)$，$\\mathbf{v}_2(0) = (u, -v_0)$，\n其中 $u = 0.3$ 且 $v_0 = \\omega a$。这些初始条件在保持空间对称性的同时，产生非零的总线动量和角动量。\n\n为运动方程实现两种时间积分器：\n- 一个应用于保守力的辛 velocity Verlet 积分器，其中粘性阻力作为速度相关的力在加速度评估中被包含。\n- 一个非辛显式 Euler 积分器。\n\n在每次模拟中，对于时间步长 $\\Delta t > 0$ 和整数步数 $N \\ge 1$，将系统从时间 $t = 0$ 演化到时间 $t = N \\Delta t$，在每个采样时间 $t_n$ 计算总能量 $E(t_n) = \\sum_{i=1}^2 \\tfrac{1}{2} m \\lVert \\mathbf{v}_i(t_n) \\rVert^2 + V(\\mathbf{r}_1(t_n),\\mathbf{r}_2(t_n))$，总线动量的大小 $P(t_n) = \\lVert \\sum_{i=1}^2 m \\mathbf{v}_i(t_n) \\rVert$，以及总角动量的大小（平面外）$L(t_n) = \\left| \\sum_{i=1}^2 m \\left( x_i(t_n) v_{i,y}(t_n) - y_i(t_n) v_{i,x}(t_n) \\right) \\right|$，其中 $\\mathbf{r}_i(t_n) = (x_i(t_n), y_i(t_n))$ 且 $\\mathbf{v}_i(t_n) = (v_{i,x}(t_n), v_{i,y}(t_n))$。\n\n对于每个轨迹，通过相对于时间的最小二乘最佳拟合斜率来量化 $E$、$P$ 和 $L$ 的漂移。对于某个量 $Y \\in \\{E,P,L\\}$ 的样本 $\\{(t_n, Y_n)\\}_{n=0}^N$，将漂移率定义为仿射近似 $Y(t) \\approx a_Y t + b_Y$ 的斜率 $a_Y$，该仿射近似使残差平方和最小化。最终报告的漂移率必须是斜率 $a_E$、$a_P$ 和 $a_L$。\n\n您的程序必须实现以上内容，并为以下四个测试用例组成的测试套件生成结果，每个用例由积分器选择、阻力系数 $\\gamma$、时间步长 $\\Delta t$ 和步数 $N$ 指定：\n- 用例 1：velocity Verlet, $\\gamma = 0$, $\\Delta t = 0.01$, $N = 20000$。\n- 用例 2：velocity Verlet, $\\gamma = 0.05$, $\\Delta t = 0.01$, $N = 20000$。\n- 用例 3：explicit Euler, $\\gamma = 0$, $\\Delta t = 0.005$, $N = 20000$。\n- 用例 4：explicit Euler, $\\gamma = 0$, $\\Delta t = 0.02$, $N = 5000$。\n\n科学真实性约束：\n- 仅使用上述指定的力。\n- 确保积分器的实现不包含除所述阻力模型之外的隐藏稳定器或恒温器。\n- 回归必须使用从 $t_0 = 0$ 到 $t_N = N \\Delta t$（含）的所有采样时间。\n\n您的程序必须输出一个单行，其中包含一个逗号分隔的列表，该列表由四个内部列表组成，每个内部列表对应一个测试用例，其中包含按能量、动量大小、角动量大小顺序排列的三个漂移率 $[a_E, a_P, a_L]$。所有数字必须四舍五入到 $6$ 位小数。输出格式必须严格为\n\"[[aE1,aP1,aL1],[aE2,aP2,aL2],[aE3,aP3,aL3],[aE4,aP4,aL4]]\"\n且无空格。例如，如果一个用例产生了 $a_E = 0$、$a_P = 0$ 和 $a_L = 0$，它将在最终列表中贡献 \"[0.000000,0.000000,0.000000]\"。\n\n预期的概念性行为（您的数值结果应清楚地显示这一点）是：对于保守力和辛积分器（用例 1），总能量没有系统性漂移（有界振荡误差，斜率接近零）；而非辛积分器（用例 3 和 4）则表现出系统性能量漂移，其大小随时间步长的增加而增加。非保守力（用例 2）的存在应导致负能量漂移，以及由于耗散损失造成的总动量和角动量的衰减。您的代码必须计算出这些结果，而不是假设它们。", "solution": "问题陈述已得到严格验证，并被确定为科学上合理、适定且完整。所有参数和条件都已明确指定，没有歧义。该问题是计算物理学中的一个标准练习，适合用于说明数值积分器的性质和守恒定律的原理。我们现在开始阐述正式解法。\n\n### 1. 数学模型\n\n该系统由两个质量为 $m$ 的粒子组成，它们位于二维空间中，位置为 $\\mathbf{r}_1, \\mathbf{r}_2 \\in \\mathbb{R}^2$。其动力学由牛顿第二定律控制：\n$$m \\mathbf{\\ddot{r}}_i = \\mathbf{F}_i, \\quad i \\in \\{1, 2\\}$$\n作用于粒子 $i$ 上的总力 $\\mathbf{F}_i$ 是保守相互作用力 $\\mathbf{F}_i^{\\mathrm{cons}}$ 和非保守阻力 $\\mathbf{F}_i^{\\mathrm{drag}}$ 的总和。\n\n保守力源于谐波势 $V = \\tfrac{1}{2} k \\lVert \\mathbf{r}_1 - \\mathbf{r}_2 \\rVert^2$：\n$$\\mathbf{F}_{1}^{\\mathrm{cons}} = -\\nabla_{\\mathbf{r}_1} V = -k(\\mathbf{r}_1 - \\mathbf{r}_2)$$\n$$\\mathbf{F}_{2}^{\\mathrm{cons}} = -\\nabla_{\\mathbf{r}_2} V = -k(\\mathbf{r}_2 - \\mathbf{r}_1) = k(\\mathbf{r}_1 - \\mathbf{r}_2)$$\n注意，这些力遵循牛顿第三定律，$\\mathbf{F}_{1}^{\\mathrm{cons}} = -\\mathbf{F}_{2}^{\\mathrm{cons}}$。\n\n可选的阻力是线性粘性阻力：\n$$\\mathbf{F}_i^{\\mathrm{drag}} = -\\gamma m \\mathbf{v}_i$$\n其中 $\\gamma \\ge 0$ 是阻力系数，$\\mathbf{v}_i = \\mathbf{\\dot{r}}_i$ 是速度。\n\n因此，每个粒子的加速度为：\n$$\\mathbf{a}_1 = \\frac{\\mathbf{F}_1}{m} = -\\frac{k}{m}(\\mathbf{r}_1 - \\mathbf{r}_2) - \\gamma \\mathbf{v}_1$$\n$$\\mathbf{a}_2 = \\frac{\\mathbf{F}_2}{m} = \\frac{k}{m}(\\mathbf{r}_1 - \\mathbf{r}_2) - \\gamma \\mathbf{v}_2$$\n\n### 2. 关注的物理量\n\n我们监测三个关键的物理量：\n1.  **总能量 ($E$)**：动能和势能之和。\n    $$E = \\sum_{i=1}^2 \\frac{1}{2} m \\lVert \\mathbf{v}_i \\rVert^2 + \\frac{1}{2} k \\lVert \\mathbf{r}_1 - \\mathbf{r}_2 \\rVert^2$$\n2.  **总线动量的大小 ($P$)**：\n    $$P = \\left\\lVert \\sum_{i=1}^2 m \\mathbf{v}_i \\right\\rVert$$\n3.  **总角动量的大小 ($L$)**：(平面外) $z$分量的大小。\n    $$L = \\left| \\sum_{i=1}^2 m (x_i v_{i,y} - y_i v_{i,x}) \\right|$$\n\n在没有阻力（$\\gamma = 0$）的情况下，作用于系统的总力为零（$\\mathbf{F}_1 + \\mathbf{F}_2 = \\mathbf{0}$），绕原点的总力矩也为零。因此，总线动量和总角动量是精确守恒的。由于唯一的力是保守力，总能量也守恒。当 $\\gamma > 0$ 时，这些守恒定律被打破。\n\n### 3. 数值积分方案\n\n我们使用时间步长 $\\Delta t > 0$ 对运动方程进行离散化。令 $\\mathbf{r}_n = \\mathbf{r}(t_n)$ 和 $\\mathbf{v}_n = \\mathbf{v}(t_n)$ 为时间 $t_n = n \\Delta t$ 时的状态。\n\n#### 3.1. 显式 Euler 积分器\n这是一种一阶、非辛方法。第 $n+1$ 步的状态由第 $n$ 步的状态计算得出：\n$$\\mathbf{v}_{n+1} = \\mathbf{v}_n + \\mathbf{a}(\\mathbf{r}_n, \\mathbf{v}_n) \\Delta t$$\n$$\\mathbf{r}_{n+1} = \\mathbf{r}_n + \\mathbf{v}_n \\Delta t$$\n该方法简单，但以其较差的长期稳定性和能量守恒性而闻名。\n\n#### 3.2. Velocity Verlet 积分器\n这是一种用于哈密顿系统的二阶辛方法。对于速度相关的力，采用一种常见的改动。算法流程如下：\n1.  计算半步速度更新：\n    $$\\mathbf{v}_{n+1/2} = \\mathbf{v}_n + \\frac{1}{2} \\mathbf{a}(\\mathbf{r}_n, \\mathbf{v}_n) \\Delta t$$\n2.  将位置更新到完整的下一步：\n    $$\\mathbf{r}_{n+1} = \\mathbf{r}_n + \\mathbf{v}_{n+1/2} \\Delta t$$\n3.  在新位置计算加速度，对速度相关项使用半步速度：\n    $$\\mathbf{a}_{n+1} = \\mathbf{a}(\\mathbf{r}_{n+1}, \\mathbf{v}_{n+1/2})$$\n4.  完成速度更新：\n    $$\\mathbf{v}_{n+1} = \\mathbf{v}_{n+1/2} + \\frac{1}{2} \\mathbf{a}_{n+1} \\Delta t$$\n对于保守系统（$\\gamma=0$），该算法是辛的，并表现出优异的长期能量稳定性。当存在非保守力时，它不再是严格的辛算法，但仍然是一种稳健且广泛使用的积分方案。\n\n### 4. 漂移率分析\n\n对于每个模拟轨迹，我们为每个量 $Y \\in \\{E, P, L\\}$ 生成一个数据点的时间序列 $\\{(t_n, Y_n)\\}_{n=0}^N$。为了量化系统性漂移，我们执行简单的线性回归，将直线 $Y(t) \\approx a_Y t + b_Y$ 拟合到数据上。漂移率是斜率 $a_Y$，使用普通最小二乘法的标准公式计算：\n$$a_Y = \\frac{(N+1) \\sum_{n=0}^N (t_n Y_n) - (\\sum_{n=0}^N t_n)(\\sum_{n=0}^N Y_n)}{(N+1) \\sum_{n=0}^N t_n^2 - (\\sum_{n=0}^N t_n)^2}$$\n此计算将使用 `scipy.stats` 库中的 `linregress` 函数进行数值计算。\n\n### 5. 初始条件\n在约化单位中，$m=1$，$k=1$，$a=1$，$u=0.3$。自然频率为 $\\omega = \\sqrt{2k/m} = \\sqrt{2}$，因此 $v_0 = \\omega a = \\sqrt{2}$。初始位置和速度为：\n$$\\mathbf{r}_1(0) = (1, 0), \\quad \\mathbf{r}_2(0) = (-1, 0)$$\n$$\\mathbf{v}_1(0) = (0.3, \\sqrt{2}), \\quad \\mathbf{v}_2(0) = (0.3, -\\sqrt{2})$$\n对于每个测试用例，模拟将根据指定的动力学演化此初始状态。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.stats import linregress\n\ndef solve():\n    \"\"\"\n    Solves the two-particle molecular dynamics problem for four test cases\n    and reports the drift rates of energy, momentum, and angular momentum.\n    \"\"\"\n\n    test_cases = [\n        # Case 1: velocity Verlet, gamma = 0, dt = 0.01, N = 20000\n        {'integrator': 'verlet', 'gamma': 0.0, 'dt': 0.01, 'N': 20000},\n        # Case 2: velocity Verlet, gamma = 0.05, dt = 0.01, N = 20000\n        {'integrator': 'verlet', 'gamma': 0.05, 'dt': 0.01, 'N': 20000},\n        # Case 3: explicit Euler, gamma = 0, dt = 0.005, N = 20000\n        {'integrator': 'euler', 'gamma': 0.0, 'dt': 0.005, 'N': 20000},\n        # Case 4: explicit Euler, gamma = 0, dt = 0.02, N = 5000\n        {'integrator': 'euler', 'gamma': 0.0, 'dt': 0.02, 'N': 5000},\n    ]\n\n    all_results = []\n\n    def get_accelerations(r, v, k, gamma, m):\n        \"\"\"Computes accelerations for the two particles.\"\"\"\n        r_rel = r[0] - r[1]\n        F_cons_1 = -k * r_rel\n        F_cons_2 = k * r_rel\n\n        F_drag_1 = -gamma * m * v[0]\n        F_drag_2 = -gamma * m * v[1]\n        \n        F1 = F_cons_1 + F_drag_1\n        F2 = F_cons_2 + F_drag_2\n\n        # In reduced units, m=1, but included for generality\n        return np.array([F1 / m, F2 / m])\n\n    for case in test_cases:\n        # Unpack parameters\n        integrator_type = case['integrator']\n        gamma = case['gamma']\n        dt = case['dt']\n        N = case['N']\n\n        # System constants and initial conditions in reduced units\n        m = 1.0\n        k = 1.0\n        a = 1.0\n        u = 0.3\n        omega = np.sqrt(2.0 * k / m)\n        v0 = omega * a\n        \n        r = np.array([[a, 0.0], [-a, 0.0]], dtype=np.float64)\n        v = np.array([[u, v0], [u, -v0]], dtype=np.float64)\n\n        # Data storage\n        times = np.linspace(0, N * dt, N + 1)\n        E_series = np.zeros(N + 1)\n        P_series = np.zeros(N + 1)\n        L_series = np.zeros(N + 1)\n\n        # Main simulation loop\n        for n in range(N + 1):\n            # Calculate and store quantities at the current step t_n\n            r_rel = r[0] - r[1]\n            potential_E = 0.5 * k * np.dot(r_rel, r_rel)\n            kinetic_E = 0.5 * m * (np.sum(v[0]**2) + np.sum(v[1]**2))\n            E_series[n] = kinetic_E + potential_E\n\n            P_vec = m * (v[0] + v[1])\n            P_series[n] = np.linalg.norm(P_vec)\n\n            L_z = m * (r[0, 0] * v[0, 1] - r[0, 1] * v[0, 0]) + \\\n                  m * (r[1, 0] * v[1, 1] - r[1, 1] * v[1, 0])\n            L_series[n] = np.abs(L_z)\n            \n            if n == N:\n                break # All data points collected\n            \n            # --- Integrator Step ---\n            if integrator_type == 'euler':\n                accel = get_accelerations(r, v, k, gamma, m)\n                r_new = r + v * dt\n                v_new = v + accel * dt\n                r, v = r_new, v_new\n            elif integrator_type == 'verlet':\n                accel = get_accelerations(r, v, k, gamma, m)\n                v_half = v + 0.5 * accel * dt\n                r_new = r + v_half * dt\n                # For velocity-dependent force, use v_half in the next acceleration calculation\n                accel_new = get_accelerations(r_new, v_half, k, gamma, m)\n                v_new = v_half + 0.5 * accel_new * dt\n                r, v = r_new, v_new\n        \n        # --- Analysis: Calculate drift rates via linear regression ---\n        slope_E = linregress(times, E_series).slope\n        slope_P = linregress(times, P_series).slope\n        slope_L = linregress(times, L_series).slope\n        \n        all_results.append([slope_E, slope_P, slope_L])\n\n    # --- Format and print the final output ---\n    # The output string must be a single line with no spaces\n    formatted_results = []\n    for res in all_results:\n        # Format each number to 6 decimal places and join with commas\n        formatted_case = \",\".join([f\"{val:.6f}\" for val in res])\n        formatted_results.append(f\"[{formatted_case}]\")\n    \n    # Join the case results with commas and enclose in brackets\n    final_output = f\"[{','.join(formatted_results)}]\"\n    print(final_output)\n\nsolve()\n```", "id": "2632556"}]}