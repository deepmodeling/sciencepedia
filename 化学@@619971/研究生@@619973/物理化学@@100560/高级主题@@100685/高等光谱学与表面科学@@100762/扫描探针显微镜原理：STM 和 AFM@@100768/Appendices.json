{"hands_on_practices": [{"introduction": "扫描隧道显微镜（STM）的核心是量子隧穿效应，其中隧穿电流 $I$ 对针尖-样品距离 $z$ 极其敏感。本练习旨在运用半经典的 WKB 近似，推导并量化这种指数依赖关系与有效势垒高度 $\\phi_{\\mathrm{app}}$ 之间的联系。通过分析实验中测量的 $I(z)$ 谱，我们可以提取出表面的一个基本电子性质，这深刻地揭示了 STM 如何超越单纯的地形成像，提供丰富的物理信息。[@problem_id:2662479]", "problem": "在扫描隧道显微镜（STM）中，$I(z)$谱学测量在固定的小偏压下记录隧穿电流 $I$ 作为真空针尖-样品间距 $z$ 的函数。考虑一个可以把真空势垒建模为一维，并且势垒高度有效恒定且与能量无关的情形，该势垒高度等于相对于费米能级测量的表观势垒高度 $\\phi_{\\mathrm{app}}$。从不含时薛定谔方程和用于穿过经典禁区的隧穿效应的半经典Wentzel–Kramers–Brillouin（WKB）近似出发，推导 $\\ln I$ 对 $z$ 的曲线斜率 $s \\equiv d(\\ln I)/dz$ 与 $\\phi_{\\mathrm{app}}$、电子质量 $m_{e}$ 和约化普朗克常数 $\\hbar$ 之间的关系。然后，对于在足够小的偏压下（势垒高度可视为恒定）测得的斜率 $s = -22\\,\\mathrm{nm}^{-1}$，计算 $\\phi_{\\mathrm{app}}$ 的值，以电子伏特为单位。\n\n使用以下常量：$\\hbar = 1.054\\,571\\,817 \\times 10^{-34}\\,\\mathrm{J\\,s}$，$m_{e} = 9.109\\,383\\,56 \\times 10^{-31}\\,\\mathrm{kg}$，以及 $1\\,\\mathrm{eV} = 1.602\\,176\\,634 \\times 10^{-19}\\,\\mathrm{J}$。将 $\\phi_{\\mathrm{app}}$ 的最终数值答案四舍五入到三位有效数字，并以 $\\mathrm{eV}$ 表示。", "solution": "所述问题具有科学依据，提法明确，并包含足够的信息以获得唯一解。这是一个将量子隧穿原理应用于扫描隧道显微镜操作的标准练习。我们将进行推导和后续计算。\n\n任务是首先推导斜率 $s \\equiv d(\\ln I)/dz$ 的关系式，然后计算表观势垒高度 $\\phi_{\\mathrm{app}}$。出发点是不含时薛定谔方程和Wentzel–Kramers–Brillouin（WKB）近似。\n\n在固定的小偏压下，隧穿电流 $I$ 与电子从针尖隧穿到样品（或反之）的量子力学透射概率 $T$ 成正比。我们可以将其写为 $I \\propto T$。对电流的主要贡献来自费米能级 $E_F$ 处的电子。\n\nWKB近似给出了质量为 $m_e$、能量为 $E$ 的粒子从 $x=0$ 到 $x=z$ 穿过势垒 $V(x)$ 的透射系数 $T$ 为：\n$$\nT \\approx \\exp\\left( -2 \\int_{0}^{z} \\sqrt{\\frac{2m_e (V(x') - E)}{\\hbar^2}} \\, dx' \\right)\n$$\n在这个问题中，我们将真空间隙建模为一维方形势垒。\n势垒高度是恒定的，由表观势垒高度 $\\phi_{\\mathrm{app}}$ 给出，该高度是相对于费米能级定义的。因此，对于势垒内部的所有 $x'$（即 $0 < x' < z$），有 $V(x') - E = \\phi_{\\mathrm{app}}$。\n将这些条件代入WKB公式：\n$$\nT \\approx \\exp\\left( -2 \\int_{0}^{z} \\sqrt{\\frac{2m_e \\phi_{\\mathrm{app}}}{\\hbar^2}} \\, dx' \\right)\n$$\n由于被积函数相对于积分变量 $x'$ 是一个常数，该积分是平凡的：\n$$\n\\int_{0}^{z} \\sqrt{\\frac{2m_e \\phi_{\\mathrm{app}}}{\\hbar^2}} \\, dx' = \\sqrt{\\frac{2m_e \\phi_{\\mathrm{app}}}{\\hbar^2}} \\int_{0}^{z} dx' = z \\frac{\\sqrt{2m_e \\phi_{\\mathrm{app}}}}{\\hbar}\n$$\n将此结果代回到 $T$ 的表达式中：\n$$\nT(z) \\approx \\exp\\left( -2z \\frac{\\sqrt{2m_e \\phi_{\\mathrm{app}}}}{\\hbar} \\right)\n$$\n隧穿电流 $I(z)$ 与 $T(z)$ 成正比，因此我们可以写出：\n$$\nI(z) \\approx C \\exp\\left( -2z \\frac{\\sqrt{2m_e \\phi_{\\mathrm{app}}}}{\\hbar} \\right)\n$$\n其中 $C$ 是一个比例常数，它取决于针尖和样品的电子态密度以及偏压，但与间距 $z$ 无关。\n\n题目要求我们求斜率 $s \\equiv d(\\ln I)/dz$。首先，我们对 $I(z)$ 取自然对数：\n$$\n\\ln I(z) \\approx \\ln \\left( C \\exp\\left( -2z \\frac{\\sqrt{2m_e \\phi_{\\mathrm{app}}}}{\\hbar} \\right) \\right) = \\ln C + \\ln \\left( \\exp\\left( -2z \\frac{\\sqrt{2m_e \\phi_{\\mathrm{app}}}}{\\hbar} \\right) \\right)\n$$\n$$\n\\ln I(z) \\approx \\ln C - 2z \\frac{\\sqrt{2m_e \\phi_{\\mathrm{app}}}}{\\hbar}\n$$\n现在，我们对 $z$ 求导以求得斜率 $s$：\n$$\ns = \\frac{d(\\ln I)}{dz} \\approx \\frac{d}{dz} \\left( \\ln C - 2z \\frac{\\sqrt{2m_e \\phi_{\\mathrm{app}}}}{\\hbar} \\right)\n$$\n由于 $\\ln C$、$\\phi_{\\mathrm{app}}$、$m_e$ 和 $\\hbar$ 都是相对于 $z$ 的常数，导数为：\n$$\ns = -2 \\frac{\\sqrt{2m_e \\phi_{\\mathrm{app}}}}{\\hbar}\n$$\n这就是所要求的斜率 $s$ 与物理常数 $\\phi_{\\mathrm{app}}$、$m_e$ 和 $\\hbar$ 之间的关系。\n\n对于问题的第二部分，我们必须根据测得的斜率 $s = -22\\,\\mathrm{nm}^{-1}$ 来计算 $\\phi_{\\mathrm{app}}$。我们重新整理推导出的方程以求解 $\\phi_{\\mathrm{app}}$：\n$$\ns^2 = \\left( -2 \\frac{\\sqrt{2m_e \\phi_{\\mathrm{app}}}}{\\hbar} \\right)^2 = 4 \\frac{2m_e \\phi_{\\mathrm{app}}}{\\hbar^2} = \\frac{8m_e \\phi_{\\mathrm{app}}}{\\hbar^2}\n$$\n$$\n\\phi_{\\mathrm{app}} = \\frac{s^2 \\hbar^2}{8m_e}\n$$\n如果所有量都采用国际单位制（SI units），该表达式将得出 $\\phi_{\\mathrm{app}}$ 的值，单位为焦耳。我们已知以下数值：\n$s = -22\\,\\mathrm{nm}^{-1} = -22 \\times 10^9\\,\\mathrm{m}^{-1}$\n$\\hbar = 1.054571817 \\times 10^{-34}\\,\\mathrm{J\\,s}$\n$m_e = 9.10938356 \\times 10^{-31}\\,\\mathrm{kg}$\n\n代入这些值：\n$$\n\\phi_{\\mathrm{app}} = \\frac{(-22 \\times 10^9\\,\\mathrm{m}^{-1})^2 (1.054571817 \\times 10^{-34}\\,\\mathrm{J\\,s})^2}{8 (9.10938356 \\times 10^{-31}\\,\\mathrm{kg})}\n$$\n$$\n\\phi_{\\mathrm{app}} = \\frac{(484 \\times 10^{18}\\,\\mathrm{m}^{-2}) (1.112119 \\times 10^{-68}\\,\\mathrm{J^2\\,s^2})}{7.2875068 \\times 10^{-30}\\,\\mathrm{kg}}\n$$\n$$\n\\phi_{\\mathrm{app}} = \\frac{5.382658 \\times 10^{-49}\\,\\mathrm{J^2\\,s^2\\,m^{-2}}}{7.2875068 \\times 10^{-30}\\,\\mathrm{kg}}\n$$\n回顾 $1\\,\\mathrm{J} = 1\\,\\mathrm{kg\\,m^2\\,s^{-2}}$，单位正确地解析为焦耳。\n$$\n\\phi_{\\mathrm{app}} \\approx 7.38613 \\times 10^{-19}\\,\\mathrm{J}\n$$\n问题要求答案以电子伏特（$\\mathrm{eV}$）为单位。我们使用给定的转换因子 $1\\,\\mathrm{eV} = 1.602176634 \\times 10^{-19}\\,\\mathrm{J}$。该数值在数值上等于元电荷 $e$。\n$$\n\\phi_{\\mathrm{app}} [\\mathrm{eV}] = \\frac{\\phi_{\\mathrm{app}} [\\mathrm{J}]}{1.602176634 \\times 10^{-19}\\,\\mathrm{J/eV}}\n$$\n$$\n\\phi_{\\mathrm{app}} [\\mathrm{eV}] = \\frac{7.38613 \\times 10^{-19}\\,\\mathrm{J}}{1.602176634 \\times 10^{-19}\\,\\mathrm{J/eV}} \\approx 4.60999\\,\\mathrm{eV}\n$$\n按要求将最终答案四舍五入到三位有效数字，得到 $4.61\\,\\mathrm{eV}$。", "answer": "$$\n\\boxed{4.61}\n$$", "id": "2662479"}, {"introduction": "在原子力显微镜（AFM）中，针尖通过各种力与样品表面相互作用，当针尖靠近表面时，长程吸引力可能导致系统出现机械不稳定性。本练习将引导你通过分析悬臂-样品耦合系统的总势能，从第一性原理出发推导这种“跳接触”（jump-to-contact）不稳定性的发生条件。理解并能够预测这一现象对于正确解译力曲线和避免不必要的针尖损坏至关重要，是掌握 AFM 操作的一个关键环节。[@problem_id:2662545]", "problem": "在原子力显微镜 (AFM) 中，半径为 $R$ 的球形针尖向平坦表面的静态逼近过程，由悬臂梁的弹性恢复力与保守的针尖-样品相互作用力之间的平衡所决定。考虑一个弹性系数为 $k$ 的悬臂梁，在保守的针尖-样品作用力 $F_{\\mathrm{ts}}(z)$ 下偏转了 $x$，其中 $z$ 是瞬时的针尖-样品间距。对于非延迟色散力占主导地位的纳米尺度间距，我们使用球面-平面间的范德华相互作用来模拟针尖-样品作用力，即 $F_{\\mathrm{ts}}(z)=-A_{H}R/(6z^{2})$，其中 $A_{H}$ 是 Hamaker 常数。\n\n从耦合系统的总势能出发，利用适用于保守单自由度系统的平衡与稳定性条件，推导静态失稳（跳接触）开始的条件，并用 $k$ 和 $\\partial F_{\\mathrm{ts}}/\\partial z$ 表示。然后，当 $A_{H}=10^{-19}\\,\\mathrm{J}$，$R=20\\,\\mathrm{nm}$，$k=0.5\\,\\mathrm{N/m}$ 时，计算在给定范德华力模型下，等式首次被满足时的吸附距离 $z_{\\mathrm{snap}}$。将最终数值答案以纳米为单位表示，并四舍五入到三位有效数字。", "solution": "所陈述的问题在科学上是可靠的、提法得当，并包含了完整求解所需的所有信息。它描述了原子力显微镜物理学中的一个标准情景，依赖于力学和分子间力的基本原理。我将继续进行推导和计算。\n\n该系统由一个悬臂梁和一个与样品表面相互作用的针尖组成。该系统的总势能 $U_{\\mathrm{total}}$ 是储存在悬臂梁中的弹性势能 $U_{\\mathrm{el}}$ 与针尖-样品相互作用势能 $U_{\\mathrm{ts}}$ 之和。设悬臂梁支撑点的位置固定在距离样品表面为 $d$ 的地方。我们定义瞬时针尖-样品间距为 $z$。那么，对于吸引力情景，假设 $z<d$，悬臂梁相对于其平衡位置的偏转量为 $x=d-z$。\n\n悬臂梁的弹性势能，被建模为一个弹性系数为 $k$ 的简单弹簧，由下式给出：\n$$U_{\\mathrm{el}} = \\frac{1}{2}kx^2 = \\frac{1}{2}k(d-z)^2$$\n针尖-样品相互作用势 $U_{\\mathrm{ts}}(z)$ 与保守的针尖-样品作用力 $F_{\\mathrm{ts}}(z)$ 通过定义 $F_{\\mathrm{ts}}(z) = -\\frac{dU_{\\mathrm{ts}}(z)}{dz}$ 相关联。\n\n对于固定的悬臂梁支撑位置 $d$，系统的总势能是单一自由度 $z$ 的函数：\n$$U_{\\mathrm{total}}(z; d) = U_{\\mathrm{el}} + U_{\\mathrm{ts}}(z) = \\frac{1}{2}k(d-z)^2 + U_{\\mathrm{ts}}(z)$$\n当总势能相对于 $z$ 处于极值时，系统处于机械平衡状态。该条件表示为总势能对 $z$ 的一阶导数为零：\n$$\\frac{\\partial U_{\\mathrm{total}}}{\\partial z} = 0$$\n计算这个导数，我们得到：\n$$\\frac{\\partial}{\\partial z} \\left[ \\frac{1}{2}k(d-z)^2 + U_{\\mathrm{ts}}(z) \\right] = k(d-z)(-1) + \\frac{dU_{\\mathrm{ts}}(z)}{dz} = -k(d-z) - F_{\\mathrm{ts}}(z) = 0$$\n这等效于力平衡方程 $k(d-z) = -F_{\\mathrm{ts}}(z)$，即悬臂梁的弹性恢复力 $F_{\\mathrm{el}} = kx$ 与针尖-样品相互作用力 $-F_{\\mathrm{ts}}(z)$ 相平衡。\n\n为了使平衡稳定，势能必须处于一个局域最小值。这要求总势能对 $z$ 的二阶导数为正：\n$$\\frac{\\partial^2 U_{\\mathrm{total}}}{\\partial z^2} > 0$$\n我们计算二阶导数：\n$$\\frac{\\partial^2 U_{\\mathrm{total}}}{\\partial z^2} = \\frac{\\partial}{\\partial z} \\left[ -k(d-z) - F_{\\mathrm{ts}}(z) \\right] = k - \\frac{\\partial F_{\\mathrm{ts}}(z)}{\\partial z}$$\n因此，稳定平衡的条件是 $k - \\frac{\\partial F_{\\mathrm{ts}}(z)}{\\partial z} > 0$，或者 $k > \\frac{\\partial F_{\\mathrm{ts}}(z)}{\\partial z}$。\n\n静态失稳的开始，即所谓的“跳接触”或“吸附”现象，发生在系统从稳定平衡过渡到不稳定平衡时。这发生在势能形貌从具有一个最小值变为具有一个拐点的点，这对应于稳定性条件变为等式。因此，失稳开始的条件是：\n$$k = \\frac{\\partial F_{\\mathrm{ts}}(z)}{\\partial z}$$\n这是从第一性原理推导出的静态失稳开始的一般条件。它表明，当吸引性针尖-样品作用力的梯度（“相互作用刚度”）等于悬臂梁的弹性系数时，就会发生失稳。\n\n现在，我们将此条件应用于所提供的球面-平面范德华相互作用的特定力模型：\n$$F_{\\mathrm{ts}}(z) = -\\frac{A_{H}R}{6z^2} = -\\frac{A_{H}R}{6}z^{-2}$$\n其中 $A_{H}$ 是 Hamaker 常数，$R$ 是针尖半径。我们必须计算这个力对间距 $z$ 的导数：\n$$\\frac{\\partial F_{\\mathrm{ts}}}{\\partial z} = \\frac{d}{dz}\\left(-\\frac{A_{H}R}{6}z^{-2}\\right) = -\\frac{A_{H}R}{6}(-2)z^{-3} = \\frac{2A_{H}R}{6z^3} = \\frac{A_{H}R}{3z^3}$$\n将此表达式代入失稳条件，得到吸附距离 $z_{\\mathrm{snap}}$ 的方程：\n$$k = \\frac{A_{H}R}{3z_{\\mathrm{snap}}^3}$$\n我们现在求解 $z_{\\mathrm{snap}}$：\n$$z_{\\mathrm{snap}}^3 = \\frac{A_{H}R}{3k}$$\n$$z_{\\mathrm{snap}} = \\left( \\frac{A_{H}R}{3k} \\right)^{1/3}$$\n\n最后，我们使用所提供的数据计算 $z_{\\mathrm{snap}}$ 的数值，确保所有量都采用国际单位制（SI）。\n已知:\n$A_{H} = 10^{-19}\\,\\mathrm{J}$\n$R = 20\\,\\mathrm{nm} = 20 \\times 10^{-9}\\,\\mathrm{m}$\n$k = 0.5\\,\\mathrm{N/m}$\n\n将这些值代入 $z_{\\mathrm{snap}}$ 的表达式中：\n$$z_{\\mathrm{snap}} = \\left( \\frac{(10^{-19}\\,\\mathrm{J}) \\times (20 \\times 10^{-9}\\,\\mathrm{m})}{3 \\times (0.5\\,\\mathrm{N/m})} \\right)^{1/3}$$\n内部单位为 $\\frac{\\mathrm{J} \\cdot \\mathrm{m}}{\\mathrm{N/m}} = \\frac{(\\mathrm{N} \\cdot \\mathrm{m}) \\cdot \\mathrm{m}}{\\mathrm{N/m}} = \\mathrm{m}^3$，所以 $z_{\\mathrm{snap}}$ 的结果单位将是米，这是正确的。\n$$z_{\\mathrm{snap}} = \\left( \\frac{20 \\times 10^{-28}}{1.5} \\right)^{1/3}\\,\\mathrm{m} = \\left( \\frac{40}{3} \\times 10^{-28} \\right)^{1/3}\\,\\mathrm{m}$$\n为了简化立方根的计算，我们将 $10$ 的指数调整为 $3$ 的倍数：\n$$z_{\\mathrm{snap}} = \\left( \\frac{4}{3} \\times 10^{-27} \\right)^{1/3}\\,\\mathrm{m} = \\left(\\frac{4}{3}\\right)^{1/3} \\times (10^{-27})^{1/3}\\,\\mathrm{m} = \\left(\\frac{4}{3}\\right)^{1/3} \\times 10^{-9}\\,\\mathrm{m}$$\n这意味着 $z_{\\mathrm{snap}}$ 以纳米为单位的数值等于 $(\\frac{4}{3})^{1/3}$。\n$$\\left(\\frac{4}{3}\\right)^{1/3} \\approx (1.3333...)^{1/3} \\approx 1.100643$$\n所以，$z_{\\mathrm{snap}} \\approx 1.100643\\,\\mathrm{nm}$。\n问题要求答案四舍五入到三位有效数字。\n$$z_{\\mathrm{snap}} \\approx 1.10\\,\\mathrm{nm}$$", "answer": "$$\\boxed{1.10}$$", "id": "2662545"}, {"introduction": "所有扫描探针显微技术（SPM）的成功都依赖于精确的纳米级定位，这通常由压电扫描器实现。然而，这些扫描器本身存在非理想行为，如迟滞和非线性，会引入图像畸变。这个计算实践将指导你如何基于扫描器的位移响应数据，建立模型并量化这些关键的仪器伪影。掌握这项技能对于仪器校准和图像校正至关重要，它构成了连接理论概念与实际数据采集和分析的重要桥梁。[@problem_id:2662481]", "problem": "您的任务是量化扫描探针显微镜 (Scanning Probe Microscopy, SPM) 中使用的压电扫描器的迟滞和非线性，特别是在扫描隧道显微镜 (Scanning Tunneling Microscopy, STM) 和原子力显微镜 (Atomic Force Microscopy, AFM) 的背景下。在典型实验中，驱动扫描器的压电致动器由于铁电畴物理和材料蠕变，其位移与电压的关系呈现出路径依赖性，从而产生不同的正向和反向曲线。在物理化学和材料表征中，一个常见且经过充分检验的建模方法是将每次扫描用电压的低阶多项式来近似，然后计算在指定范围内总结迟滞和静态非线性的指标。\n\n从以下基本依据出发：\n\n- 扫描器位移与施加电压的关系在有限范围内可以很好地通过施加电压的截断多项式来近似。这一方法源于工作点附近的 Taylor 展开，并被广泛用于捕捉压电致动器的低阶非线性和迟滞。\n- 对于每个扫描方向，使用普通最小二乘法通过最小化模型预测与观测数据之间的残差平方和来估计模型参数。\n\n您的程序必须为每个测试用例实现以下内容：\n\n1. 数据生成：\n   - 使用一个均匀的电压网格，包含 $N = 201$ 个点，范围从 $V_{\\min} = -50\\,\\mathrm{V}$ 到 $V_{\\max} = +50\\,\\mathrm{V}$。\n   - 按如下方式生成一个正向和一个反向的合成位移数据集。定义基础位移为 $x_{\\mathrm{base}}(V) = a_{1} V + a_{2} V^{2} + a_{3} V^{3}$，并定义一个反对称的迟滞贡献为 $h(V) = h_{1} V + h_{3} V^{3}$。然后：\n     - 正向扫描位移（无噪声）：$x_{\\mathrm{f,true}}(V) = x_{\\mathrm{base}}(V) + h(V)$。\n     - 反向扫描位移（无噪声）：$x_{\\mathrm{b,true}}(V) = x_{\\mathrm{base}}(V) - h(V)$。\n   - 对每个位移样本添加均值为零、标准差为 $\\sigma$ 的独立同分布高斯噪声。为保证可复现性，每个测试用例中，正向扫描使用给定的整数种子 $s$ 初始化伪随机数生成器，反向扫描使用种子 $s+1$。\n   - 位移单位必须是 $\\mathrm{nm}$，电压单位必须是 $\\mathrm{V}$。\n\n2. 多项式拟合：\n   - 使用普通最小二乘法（最小化残差平方和）将正向数据集和反向数据集分别拟合到关于 $V$ 的 $d = 3$ 次多项式。\n\n3. 迟滞幅度：\n   - 在一个从 $-50\\,\\mathrm{V}$ 到 $+50\\,\\mathrm{V}$ 的包含 $M = 1001$ 个电压点的密集均匀评估网格上，计算拟合的正向曲线 $x_{\\mathrm{f,fit}}(V)$ 和拟合的反向曲线 $x_{\\mathrm{b,fit}}(V)$。\n   - 定义迟滞幅度 $H$ 为这两条拟合曲线在该范围内的最大绝对差值：\n     $$H = \\max_{V \\in [-50\\,\\mathrm{V},\\, +50\\,\\mathrm{V}]} \\left| x_{\\mathrm{f,fit}}(V) - x_{\\mathrm{b,fit}}(V) \\right|$$\n   - 报告 $H$，单位为 $\\mathrm{nm}$，四舍五入到3位小数。\n\n4. 静态非线性：\n   - 在相同的密集网格上，定义平均拟合曲线 $m(V) = \\dfrac{x_{\\mathrm{f,fit}}(V) + x_{\\mathrm{b,fit}}(V)}{2}$。\n   - 在密集网格上，通过普通最小二乘法将 $m(V)$ 拟合到一个理想的线性参考 $L(V)$（即，一个关于 $V$ 的1次多项式）。\n   - 定义满量程范围 $\\mathrm{FSR} = L(+50\\,\\mathrm{V}) - L(-50\\,\\mathrm{V})$。\n   - 定义静态非线性为与线性参考的最大绝对偏差，并用满量程范围进行归一化：\n     $$\\mathrm{NL} = \\frac{ \\max_{V \\in [-50\\,\\mathrm{V},\\, +50\\,\\mathrm{V}]} \\left| m(V) - L(V) \\right| }{ \\mathrm{FSR} }$$\n   - 报告 $\\mathrm{NL}$，形式为无单位小数（非百分比），四舍五入到6位小数。\n\n5. 输出格式：\n   - 对于每个测试用例，输出一个包含两个条目 $[H, \\mathrm{NL}]$ 的列表。\n   - 您的程序应生成单行输出，其中包含所有测试用例的结果，格式为一个由方括号括起来的逗号分隔列表，具体来说是一个列表的列表：$\\big[ [H_{1}, \\mathrm{NL}_{1}], [H_{2}, \\mathrm{NL}_{2}], \\dots \\big]$。\n\n测试套件（请完全按照指定参数使用；所有系数的单位根据 $\\mathrm{V}$ 的相应幂次确定，最终以 $\\mathrm{nm}$ 为基准）：\n\n- 案例1（轻微迟滞，弱非线性）：\n  - $a_{1} = 2.00$, $a_{2} = -1.0\\times 10^{-3}$, $a_{3} = 5.0\\times 10^{-6}$,\n  - $h_{1} = 0.20$, $h_{3} = 1.0\\times 10^{-5}$,\n  - $\\sigma = 0.02$, $s = 42$.\n- 案例2（强迟滞，中等非线性）：\n  - $a_{1} = 2.00$, $a_{2} = -1.0\\times 10^{-3}$, $a_{3} = 1.0\\times 10^{-5}$,\n  - $h_{1} = 1.00$, $h_{3} = 3.0\\times 10^{-5}$,\n  - $\\sigma = 0.01$, $s = 7$.\n- 案例3（纯线性，无迟滞，无噪声）：\n  - $a_{1} = 1.50$, $a_{2} = 0.0$, $a_{3} = 0.0$,\n  - $h_{1} = 0.0$, $h_{3} = 0.0$,\n  - $\\sigma = 0.0$, $s = 0$.\n- 案例4（轻微非线性，小迟滞）：\n  - $a_{1} = 1.80$, $a_{2} = 1.5\\times 10^{-3}$, $a_{3} = -4.0\\times 10^{-6}$,\n  - $h_{1} = 0.10$, $h_{3} = 0.0$,\n  - $\\sigma = 0.015$, $s = 123$.\n\n角度单位不适用。请确保 $H$ 以 $\\mathrm{nm}$ 为单位表示，四舍五入到3位小数，$\\mathrm{NL}$ 以小数形式表示，四舍五入到6位小数。您的程序应生成单行输出，包含所有结果，格式为方括号括起来的逗号分隔列表，例如：$[[H_{1},\\mathrm{NL}_{1}],[H_{2},\\mathrm{NL}_{2}],[H_{3},\\mathrm{NL}_{3}],[H_{4},\\mathrm{NL}_{4}]]$。", "solution": "问题陈述已经过严格验证。它具有科学依据，定义明确且客观。它正确地阐述了实验物理化学中用于表征扫描探针显微镜中压电致动器的标准程序。所提供的模型、定义和参数是一致的、符合物理现实的，并且足以得出一个唯一且有意义的解。因此，该问题被认定为有效。\n\n该解决方案需要实现一个计算协议，以量化压电扫描器的两个关键性能指标：迟滞和静态非线性。该方法按一系列逻辑步骤进行，从合成真实的测量数据开始，到计算指定的性能指标结束。\n\n首先，我们必须生成模拟物理扫描器行为的合成数据。压电元件的位移 $x$ 作为施加电压 $V$ 的函数，本质上是非线性的并表现出迟滞。截断多项式模型是在有限工作范围内对这种行为的公认近似。我们定义一个基础位移曲线，$x_{\\mathrm{base}}(V) = a_{1} V + a_{2} V^{2} + a_{3} V^{3}$，它捕捉了基本的非线性响应。在此基础上，我们添加一个迟滞贡献，$h(V) = h_{1} V + h_{3} V^{3}$，对于正向扫描，该贡献被加上，对于反向扫描，则被减去，从而形成一个特征迟滞回线。因此，真实的、无噪声的位移函数是：\n$$x_{\\mathrm{f,true}}(V) = x_{\\mathrm{base}}(V) + h(V)$$\n$$x_{\\mathrm{b,true}}(V) = x_{\\mathrm{base}}(V) - h(V)$$\n实验测量总是会受到噪声的干扰。我们通过向每个数据点添加标准差为 $\\sigma$ 的独立同分布高斯噪声来模拟这一点。这是在一个从 $V_{\\min}=-50\\,\\mathrm{V}$ 到 $V_{\\max}=+50\\,\\mathrm{V}$ 的包含 $N=201$ 个电压点 $V_i$ 的离散网格上执行的。分别使用伪随机数生成器种子 $s$ 和 $s+1$ 用于正向和反向扫描，以正确模拟两次测量运行的统计独立性。\n\n其次，我们必须从这些带噪声的合成数据中估计潜在的扫描器响应。在真实实验中，真实的函数 $x_{\\mathrm{f,true}}(V)$ 和 $x_{\\mathrm{b,true}}(V)$ 是未知的。我们通过将正向和反向数据集独立地拟合到一个 $d=3$ 次多项式来近似它们。这是一个使用普通最小二乘法 (OLS) 解决的模型辨识问题。OLS 确定一组多项式系数 $\\{c_k\\}$，以最小化残差平方和 $\\sum_i (x_{\\mathrm{data}}(V_i) - \\sum_{k=0}^{d} c_k V_i^k)^2$。此过程产生两条估计的响应曲线，$x_{\\mathrm{f,fit}}(V)$ 和 $x_{\\mathrm{b,fit}}(V)$。\n\n第三，我们量化迟滞幅度 $H$。迟滞是扫描器位移的路径依赖性。它被量化为在整个电压范围内，拟合的正向和反向曲线之间的最大分离。为精确确定该最大值，我们在一个包含 $M=1001$ 个点的密集网格上评估拟合的多项式。迟滞幅度则为：\n$$H = \\max_{V \\in [V_{\\min},\\, V_{\\max}]} \\left| x_{\\mathrm{f,fit}}(V) - x_{\\mathrm{b,fit}}(V) \\right|$$\n\n第四，我们量化静态非线性 $\\mathrm{NL}$。该指标描述了扫描器的平均响应与理想线性行为的偏离程度。我们首先计算平均路径 $m(V) = \\frac{1}{2}(x_{\\mathrm{f,fit}}(V) + x_{\\mathrm{b,fit}}(V))$，它代表了扫描器响应的静态、非迟滞部分。然后，通过对密集评估网格上的 $m(V)$ 进行一阶多项式的 OLS 拟合，确定一个理想的线性参考 $L(V)$。静态非线性是平均路径与此线性参考之间的最大绝对偏差，并用线性拟合的满量程范围 (FSR) 进行归一化，其中 $\\mathrm{FSR} = L(V_{\\max}) - L(V_{\\min})$。这种归一化产生了一个无量纲的量，适用于比较不同的扫描器。其公式为：\n$$\\mathrm{NL} = \\frac{ \\max_{V \\in [V_{\\min},\\, V_{\\max}]} \\left| m(V) - L(V) \\right| }{ \\mathrm{FSR} }$$\n如果 $\\mathrm{FSR}$ 为零，会出现特殊情况；然而，对于任何非平凡的扫描器响应 ($a_1 \\neq 0$)，这种情况不会发生。\n\n最终程序将对四个指定的测试用例中的每一个执行这整个序列，并将得到的 $[H, \\mathrm{NL}]$ 对整理成一个符合要求的单一输出结构。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the SPM scanner characterization problem for a suite of test cases.\n    \"\"\"\n    test_cases = [\n        # Case 1: mild hysteresis, weak nonlinearity\n        {\n            \"a_coeffs\": (2.00, -1.0e-3, 5.0e-6),  # a1, a2, a3\n            \"h_coeffs\": (0.20, 1.0e-5),       # h1, h3\n            \"sigma\": 0.02,\n            \"seed\": 42\n        },\n        # Case 2: strong hysteresis, moderate nonlinearity\n        {\n            \"a_coeffs\": (2.00, -1.0e-3, 1.0e-5),\n            \"h_coeffs\": (1.00, 3.0e-5),\n            \"sigma\": 0.01,\n            \"seed\": 7\n        },\n        # Case 3: purely linear, no hysteresis, noiseless\n        {\n            \"a_coeffs\": (1.50, 0.0, 0.0),\n            \"h_coeffs\": (0.0, 0.0),\n            \"sigma\": 0.0,\n            \"seed\": 0\n        },\n        # Case 4: mild nonlinearity with small hysteresis\n        {\n            \"a_coeffs\": (1.80, 1.5e-3, -4.0e-6),\n            \"h_coeffs\": (0.10, 0.0),\n            \"sigma\": 0.015,\n            \"seed\": 123\n        }\n    ]\n\n    all_results = []\n\n    for case in test_cases:\n        # Unpack parameters\n        a1, a2, a3 = case[\"a_coeffs\"]\n        h1, h3 = case[\"h_coeffs\"]\n        sigma = case[\"sigma\"]\n        s = case[\"seed\"]\n\n        # Define constants\n        N = 201\n        M = 1001\n        V_min, V_max = -50.0, 50.0\n        fit_degree = 3\n\n        # 1. Data generation\n        V_data = np.linspace(V_min, V_max, N)\n\n        def x_base(V):\n            return a1 * V + a2 * V**2 + a3 * V**3\n\n        def h(V):\n            return h1 * V + h3 * V**3\n\n        x_f_true = x_base(V_data) + h(V_data)\n        x_b_true = x_base(V_data) - h(V_data)\n\n        # Generate noise\n        rng_f = np.random.default_rng(seed=s)\n        noise_f = rng_f.normal(0, sigma, N)\n        rng_b = np.random.default_rng(seed=s + 1)\n        noise_b = rng_b.normal(0, sigma, N)\n\n        x_f_data = x_f_true + noise_f\n        x_b_data = x_b_true + noise_b\n        \n        # 2. Polynomial fitting\n        coeffs_f = np.polyfit(V_data, x_f_data, fit_degree)\n        coeffs_b = np.polyfit(V_data, x_b_data, fit_degree)\n\n        poly_f = np.poly1d(coeffs_f)\n        poly_b = np.poly1d(coeffs_b)\n\n        # 3. Hysteresis magnitude (H)\n        V_eval = np.linspace(V_min, V_max, M)\n        x_f_fit = poly_f(V_eval)\n        x_b_fit = poly_b(V_eval)\n\n        H = np.max(np.abs(x_f_fit - x_b_fit))\n\n        # 4. Static nonlinearity (NL)\n        m_V = (x_f_fit + x_b_fit) / 2.0\n        \n        # Fit linear reference L(V) to m(V)\n        coeffs_L = np.polyfit(V_eval, m_V, 1)\n        poly_L = np.poly1d(coeffs_L)\n        \n        # Calculate full-scale range (FSR)\n        FSR = poly_L(V_max) - poly_L(V_min)\n        \n        # Calculate nonlinearity\n        L_V = poly_L(V_eval)\n        max_deviation = np.max(np.abs(m_V - L_V))\n\n        # Handle FSR=0 case to avoid division by zero, although unlikely with given inputs\n        if np.isclose(FSR, 0):\n             NL = 0.0\n        else:\n             NL = max_deviation / FSR\n             \n        # Format results for the current case\n        result = [round(H, 3), round(NL, 6)]\n        all_results.append(result)\n\n    # Final print statement in the exact required format.\n    # The default string representation of a list in Python is the required format.\n    print(f\"[{','.join(map(str, all_results))}]\")\n\nsolve()\n```", "id": "2662481"}]}