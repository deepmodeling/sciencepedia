{"hands_on_practices": [{"introduction": "本练习旨在建立热力学和化学动力学之间的基础联系。通过考虑一个简单的可逆反应，您将推导出一个熵产生率的显式表达式，从而展示热力学驱动力（化学亲和势 $A$）如何决定化学过程的耗散和不可逆性。这项实践将巩固您对熵产生与反应速率和热力学不平衡之间关系的理解。[@problem_id:375492]", "problem": "在非平衡态热力学理论中，对于一个经历单一化学反应的系统，其单位体积的局域熵产生率 $\\sigma$ 由热力学力和相应的流的乘积给出。对于化学反应，这表示为：\n$$\n\\sigma = \\frac{A \\cdot v}{T}\n$$\n其中 $A$ 是反应的化学亲和势，$v$ 是净反应速率，$T$ 是绝对温度。德东德不等式 $A \\cdot v \\ge 0$ 是热力学第二定律 ($\\sigma \\ge 0$) 的一个直接推论。\n\n考虑一个在恒定温度 $T$ 和压力 $P$ 下，在理想溶液中发生的单一基元可逆反应 $R \\rightleftharpoons P$。\n\n该反应的动力学由质量作用定律描述。净反应速率 $v$ 是正向速率 $v_f$ 和逆向速率 $v_b$ 之差：\n$$\nv = v_f - v_b\n$$\n其中 $v_f = k_f c_R$ 且 $v_b = k_b c_P$。此处，$k_f$ 和 $k_b$ 分别是正向和逆向速率常数，$c_R$ 和 $c_P$ 分别是反应物和产物的摩尔浓度。\n\n系统的热力学性质由各物种的化学势来描述。对于理想溶液，物种 $i$ 的化学势由下式给出：\n$$\n\\mu_i = \\mu_i^\\ominus + RT \\ln c_i\n$$\n其中 $\\mu_i^\\ominus$ 是标准化学势，$R$ 是普适气体常数。该反应的化学亲和势定义为：\n$$\nA = \\mu_R - \\mu_P\n$$\n\n结合动力学和热力学的描述，推导局域熵产生率 $\\sigma$ 的表达式，使其仅为亲和势 $A$、正向反应速率 $v_f$、温度 $T$ 和普适气体常数 $R$ 的函数。", "solution": "我们从熵产生公式和质量作用定律开始：\n$$\n\\sigma = \\frac{A\\,v}{T}, \n\\quad v = v_f - v_b, \n\\quad v_f = k_f c_R,\\; v_b = k_b c_P.\n$$\n对于理想溶液，\n$$\n\\mu_i = \\mu_i^\\ominus + R T\\ln c_i,\n\\quad A = \\mu_R - \\mu_P\n= \\Delta\\mu^\\ominus + R T\\ln\\frac{c_R}{c_P}.\n$$\n在平衡状态下 $\\mu_R=\\mu_P$，因此 $\\Delta\\mu^\\ominus = R T\\ln K_{\\rm eq}$ 且 $K_{\\rm eq}=k_f/k_b$。于是\n$$\nA = R T\\ln K_{\\rm eq} + R T\\ln\\frac{c_R}{c_P}\n= R T\\ln\\frac{k_f c_R}{k_b c_P}\n= R T\\ln\\frac{v_f}{v_b}.\n$$\n于是\n$$\n\\frac{v_f}{v_b} = e^{A/(R T)}, \n\\quad v_b = v_f\\,e^{-A/(R T)},\n$$\n$$\nv = v_f - v_f e^{-A/(R T)} \n= v_f\\Bigl(1 - e^{-A/(R T)}\\Bigr).\n$$\n代入 $\\sigma$ 的表达式得到\n$$\n\\sigma = \\frac{A}{T}\\,v_f\\Bigl(1 - e^{-A/(R T)}\\Bigr).\n$$", "answer": "$$\\boxed{\\frac{A\\,v_f}{T}\\bigl(1 - e^{-A/(R T)}\\bigr)}$$", "id": "375492"}, {"introduction": "这项实践将引导您从计算转向深刻的概念性推理，进行一次思想实验。通过探究负扩散系数 $D$ 这一假设情景，您将揭示热力学第二定律的深远影响，它不仅要求熵产生非负，还确保了描述输运过程的宏观演化方程在数学上是稳定的且在物理上是有意义的。这项练习将连接热力学、稳定性理论和 Onsager 关系，加深您对输运系数物理约束的理解。[@problem_id:2484525]", "problem": "一个浓度场为 $c(\\mathbf{x}, t)$ 的单一扩散溶质，在均匀温度 $T$ 和压力 $p$ 的恒温恒压条件下，于静止溶剂中演化。该系统包含在一个周期性区域内，因此空间傅里叶分析是适用的。溶质相对于质心坐标系的扩散通量表示为 $\\mathbf{J}(\\mathbf{x}, t)$。假设系统处于局域平衡状态，并忽略所有交叉效应（仅考虑单一扩散物种）。本构关系假定为驱动组分梯度的线性函数，即 $\\mathbf{J} = - D \\nabla c$，其中 $D$ 是一个空间上均匀的常数，其符号不作先验假设。质量守恒以 $\\partial c/\\partial t + \\nabla \\cdot \\mathbf{J} = 0$ 的形式成立。该溶质表现为理想稀组分，因此其化学势 $\\mu$ 遵循理想稀溶液的标准平衡热力学。根据热力学第二定律，局域熵产生密度必须为非负。\n\n在这些条件下，下列哪个陈述必然成立？\n\nA. 热力学第二定律要求 $D \\ge 0$；如果 $D < 0$，则存在 $\\nabla c \\ne \\mathbf{0}$ 的浓度场，对于这些场，只要 $c > 0$，局域熵产生密度就严格为负。\n\nB. 如果 $D < 0$，在均匀态 $c_0 > 0$ 附近的小扰动 $\\delta c(\\mathbf{x}, t)$ 的线性化演化包含形为 $\\exp\\!\\left(\\mathrm{i}\\,\\mathbf{k}\\cdot\\mathbf{x}\\right)$ 的空间傅里叶模式，这些模式会以 $\\exp\\!\\left(|D|\\,k^2\\, t\\right)$ 的形式增长，因此任意短的波长会以最快速度放大，使得初值问题变得不适定。\n\nC. 对于 $D < 0$ 时任何对热力学第二定律的表观违背，都可以通过在保持 $\\mathbf{J} = - D \\nabla c$ 的同时重新定义熵通量来消除；因此，负的 $D$ 在不改变驱动力的情况下是热力学上允许的。\n\nD. 在固定的 $T$ 和 $p$ 下的理想稀溶液中，$D$ 的符号与线性定律 $\\mathbf{J} = - (L/T)\\,\\nabla \\mu$ 中的 Onsager 系数 $L$ 的符号相同，并且由于 Onsager 矩阵的正定性要求 $L > 0$，因此 $D$ 必须为正。\n\nE. 即使 $D < 0$，在周期性边界条件下，扩散偏微分方程仍然是适定的，因为溶质总质量守恒，且 $c$ 的 $L^2$ 范数不会随时间增加。", "solution": "首先对问题陈述进行验证。\n\n### 第 1 步：提取已知条件\n\n- **系统**：在静止溶剂中的单一扩散溶质，其浓度场为 $c(\\mathbf{x}, t)$。\n- **条件**：恒温恒压，处于均匀温度 $T$ 和压力 $p$。\n- **区域**：周期性区域，允许进行空间傅里叶分析。\n- **通量**：相对于质心坐标系的扩散通量为 $\\mathbf{J}(\\mathbf{x}, t)$。\n- **假设**：局域平衡成立。忽略交叉效应。\n- **本构关系**：$\\mathbf{J} = - D \\nabla c$，其中 $D$ 是一个空间均匀常数。$D$ 的符号不作先验假设。\n- **守恒定律**：质量守恒为 $\\partial c/\\partial t + \\nabla \\cdot \\mathbf{J} = 0$。\n- **热力学**：\n    1. 溶质表现为理想稀组分；其化学势 $\\mu$ 遵循标准平衡热力学。\n    2. 根据热力学第二定律，局域熵产生密度必须为非负（$\\sigma_s \\ge 0$）。\n\n### 第 2 步：使用提取的已知条件进行验证\n\n该问题是输运现象和非平衡热力学中的一个理论练习。它提出了一个标准的物理场景，然后在一个其他方面都一致的物理和数学框架内，询问一个可能非物理的参数选择（$D < 0$）会带来什么后果。\n\n- **科学上成立**：该问题基于质量传递（菲克定律）、守恒定律和热力学（第二定律、理想溶液的化学势）的基本原理。询问 $D < 0$ 的后果是检验这些原理一致性的有效方法。它不是将谬误当作事实来陈述，而是提出了一个有待检验的假设。\n- **表述清晰**：问题陈述清晰，并包含检验所给陈述所需的所有信息。问题没有歧义。\n- **客观**：语言精确，没有主观论断。\n\n该问题是一个有效的理论探究。它没有违反任何无效性标准。\n\n### 第 3 步：结论与行动\n\n该问题是有效的。将推导完整的解答。\n\n### 基本关系的推导\n\n首先，我们结合本构关系和守恒定律。\n将 $\\mathbf{J} = -D \\nabla c$ 代入 $\\frac{\\partial c}{\\partial t} + \\nabla \\cdot \\mathbf{J} = 0$，并利用 $D$ 是空间均匀常数这一事实，我们得到扩散方程：\n$$\n\\frac{\\partial c}{\\partial t} = \\nabla \\cdot (D \\nabla c) = D \\nabla^2 c\n$$\n这是浓度场 $c(\\mathbf{x}, t)$ 的控制偏微分方程（PDE）。\n\n其次，我们构筑由热力学第二定律施加的约束。在恒温（$T=\\text{const}$）和恒压（$p=\\text{const}$）条件下，扩散过程的局域熵产生密度 $\\sigma_s$ 由热力学通量和力的乘积给出：\n$$\n\\sigma_s = -\\frac{1}{T} \\mathbf{J} \\cdot \\nabla \\mu\n$$\n热力学第二定律要求 $\\sigma_s \\ge 0$。\n问题陈述该溶质是理想稀组分。其化学势 $\\mu$ 由下式给出：\n$$\n\\mu(c, T, p) = \\mu^{\\ominus}(T, p) + k_B T \\ln(c)\n$$\n其中 $k_B$ 是玻尔兹曼常数，$\\mu^{\\ominus}$ 是一个仅依赖于 $T$ 和 $p$ 的参考势。由于 $T$ 和 $p$ 是均匀的，$\\mu$ 的梯度为：\n$$\n\\nabla \\mu = \\nabla(\\mu^{\\ominus} + k_B T \\ln c) = k_B T \\nabla(\\ln c) = k_B T \\frac{1}{c} \\nabla c\n$$\n现在，我们将 $\\mathbf{J}$ 和 $\\nabla\\mu$ 的表达式代入熵产生的公式：\n$$\n\\sigma_s = -\\frac{1}{T} (-D \\nabla c) \\cdot \\left(k_B T \\frac{1}{c} \\nabla c\\right) = \\frac{D k_B}{c} (\\nabla c)^2 = \\frac{D k_B}{c} |\\nabla c|^2\n$$\n热力学第二定律规定 $\\sigma_s \\ge 0$。由于 $k_B > 0$，浓度 $c$ 必须为非负（$c \\ge 0$），且 $|\\nabla c|^2 \\ge 0$。对于任何 $c > 0$ 且浓度不均匀（$\\nabla c \\neq \\mathbf{0}$）的区域，不等式 $\\sigma_s \\ge 0$ 只有在 $D \\ge 0$ 时才能满足。\n\n### 逐项分析\n\n**A. 热力学第二定律要求 $D \\ge 0$；如果 $D < 0$，则存在 $\\nabla c \\ne \\mathbf{0}$ 的浓度场，对于这些场，只要 $c > 0$，局域熵产生密度就严格为负。**\n\n如上所述，$\\sigma_s = \\frac{D k_B}{c} |\\nabla c|^2$。热力学第二定律要求 $\\sigma_s \\ge 0$，这意味着 $D \\ge 0$。这验证了陈述的第一部分。对于第二部分，假设 $D < 0$。如果我们选择任何一个 $\\nabla c \\neq \\mathbf{0}$ 且 $c > 0$ 的浓度场（一个非均匀的浓度分布），那么 $D < 0$，$k_B > 0$，$c > 0$，且 $|\\nabla c|^2 > 0$。这些项的乘积将严格为负：$\\sigma_s < 0$。这违反了热力学第二定律。因此，该陈述是所述热力学原理的直接且正确的推论。\n\n**结论：正确**\n\n**B. 如果 $D < 0$，在均匀态 $c_0 > 0$ 附近的小扰动 $\\delta c(\\mathbf{x}, t)$ 的线性化演化包含形为 $\\exp\\!\\left(\\mathrm{i}\\,\\mathbf{k}\\cdot\\mathbf{x}\\right)$ 的空间傅里叶模式，这些模式会以 $\\exp\\!\\left(|D|\\,k^2\\, t\\right)$ 的形式增长，因此任意短的波长会以最快速度放大，使得初值问题变得不适定。**\n\n我们对扩散方程 $\\frac{\\partial c}{\\partial t} = D \\nabla^2 c$ 进行线性稳定性分析。令 $c(\\mathbf{x}, t) = c_0 + \\delta c(\\mathbf{x}, t)$，其中 $c_0$ 是一个恒定的背景浓度。扰动 $\\delta c$ 的线性化方程是 $\\frac{\\partial (\\delta c)}{\\partial t} = D \\nabla^2 (\\delta c)$。我们考虑扰动的单个空间傅里叶模式：$\\delta c(\\mathbf{x}, t) = \\hat{c}(t) e^{i \\mathbf{k} \\cdot \\mathbf{x}}$。将其代入 PDE 得到：\n$$\n\\frac{d\\hat{c}}{dt} e^{i \\mathbf{k} \\cdot \\mathbf{x}} = D \\hat{c}(t) \\nabla^2(e^{i \\mathbf{k} \\cdot \\mathbf{x}}) = D \\hat{c}(t) (-k^2) e^{i \\mathbf{k} \\cdot \\mathbf{x}}\n$$\n其中 $k = |\\mathbf{k}|$ 是波数。这给出了振幅 $\\hat{c}(t)$ 的常微分方程：\n$$\n\\frac{d\\hat{c}}{dt} = -D k^2 \\hat{c}(t)\n$$\n其解为 $\\hat{c}(t) = \\hat{c}(0) e^{-D k^2 t}$。现在，令 $D < 0$，所以我们可以写成 $D = -|D|$。解变为：\n$$\n\\hat{c}(t) = \\hat{c}(0) e^{-(-|D|) k^2 t} = \\hat{c}(0) e^{|D| k^2 t}\n$$\n这显示了指数增长，增长率为 $\\omega(k) = |D| k^2$。增长率随波数 $k$ 平方增长。当 $k \\to \\infty$（即对于任意短的波长 $\\lambda = 2\\pi/k \\to 0$），增长率 $\\omega(k) \\to \\infty$。这意味着高频噪声几乎会瞬间被放大，这是数学上不适定问题（特别是违反 Hadamard 适定性）的一个典型特征。该陈述完全正确。这个方程被称为反向热方程。\n\n**结论：正确**\n\n**C. 对于 $D < 0$ 时任何对热力学第二定律的表观违背，都可以通过在保持 $\\mathbf{J} = - D \\nabla c$ 的同时重新定义熵通量来消除；因此，负的 $D$ 在不改变驱动力的情况下是热力学上允许的。**\n\n非平衡热力学的结构不是任意的。局域熵产生 $\\sigma_s$ 被确定为共轭热力学通量 $\\mathbf{J}_i$ 和力 $\\mathbf{X}_i$ 的乘积之和，即 $\\sigma_s = \\sum_i \\mathbf{J}_i \\cdot \\mathbf{X}_i$。在这个问题中，通量是 $\\mathbf{J}$，力是 $\\mathbf{X} = -\\frac{1}{T}\\nabla \\mu$。熵产生是 $\\sigma_s = \\mathbf{J} \\cdot \\mathbf{X}$。该陈述建议保持通量（$\\mathbf{J} = -D\\nabla c$）和驱动力（$\\nabla \\mu$，即 $\\mathbf{X}$ 的梯度部分）都不变。如果 $\\mathbf{J}$ 和 $\\mathbf{X}$ 不变，它们的乘积 $\\sigma_s$ 也不变。熵平衡方程是 $\\partial s/\\partial t + \\nabla \\cdot \\mathbf{J}_s = \\sigma_s$。虽然在数学上可以定义一个新的熵通量 $\\mathbf{J}_s' = \\mathbf{J}_s + \\mathbf{V}$，从而得到一个新的“产生”项 $\\sigma_s' = \\sigma_s - \\nabla \\cdot \\mathbf{V}$，但这在物理上是无意义的操作。将熵产生分解为通量、力和熵产生项是基于基本物理原理的，而不是任意的数学重新定义。$D < 0$ 对第二定律的违背是物理性的，而非“表观上的”。\n\n**结论：错误**\n\n**D. 在固定的 $T$ 和 $p$ 下的理想稀溶液中，$D$ 的符号与线性定律 $\\mathbf{J} = - (L/T)\\,\\nabla \\mu$ 中的 Onsager 系数 $L$ 的符号相同，并且由于 Onsager 矩阵的正定性要求 $L > 0$，因此 $D$ 必须为正。**\n\n线性非平衡热力学假定通量和力之间存在线性关系：$\\mathbf{J} = L \\mathbf{X}$。这里，通量是 $\\mathbf{J}$，力是 $\\mathbf{X} = -\\frac{1}{T}\\nabla \\mu$。所以，Onsager 关系是 $\\mathbf{J} = - \\frac{L}{T} \\nabla \\mu$。我们将其与菲克定律 $\\mathbf{J} = -D \\nabla c$ 进行比较。使用我们之前推导的理想稀溶液中 $\\nabla \\mu$ 的结果：\n$$\n-D \\nabla c = -\\frac{L}{T} \\left(k_B T \\frac{\\nabla c}{c}\\right) = -\\frac{L k_B}{c} \\nabla c\n$$\n为使此等式对任意 $\\nabla c$ 成立，我们必须有：\n$$\nD = \\frac{L k_B}{c}\n$$\n由于 $k_B > 0$ 且 $c > 0$，因此 $D$ 的符号与 Onsager 系数 $L$ 的符号相同。一个从第二定律和微观可逆性推导出的基本结果是，Onsager 系数矩阵是半正定的。对于单个独立过程，这意味着标量系数 $L$ 必须为非负，$L \\ge 0$。要发生任何实际的输运， $L$ 必须为严格正值，$L > 0$。由此必然得出 $D$ 必须为正。这个陈述为扩散系数的正性提供了一个正确且根本的论证。\n\n**结论：正确**\n\n**E. 即使 $D < 0$，在周期性边界条件下，扩散偏微分方程仍然是适定的，因为溶质总质量守恒，且 $c$ 的 $L^2$ 范数不会随时间增加。**\n\n总质量为 $M(t) = \\int_\\Omega c(\\mathbf{x}, t) \\, dV$。其时间导数为：\n$$\n\\frac{dM}{dt} = \\int_\\Omega \\frac{\\partial c}{\\partial t} \\, dV = \\int_\\Omega D \\nabla^2 c \\, dV = D \\int_\\Omega \\nabla \\cdot (\\nabla c) \\, dV = D \\oint_{\\partial \\Omega} \\nabla c \\cdot d\\mathbf{S}\n$$\n对于周期性边界条件，面积分为零，因此 $\\frac{dM}{dt} = 0$。无论 $D$ 的符号如何，总质量都守恒。该论断的第一部分是正确的。\n现在考虑 $L^2$ 范数的平方 $\\|c\\|^2_{L^2} = \\int_\\Omega c^2 \\, dV$ 的时间演化。\n$$\n\\frac{d}{dt} \\int_\\Omega c^2 \\, dV = \\int_\\Omega 2c \\frac{\\partial c}{\\partial t} \\, dV = \\int_\\Omega 2c (D \\nabla^2 c) \\, dV\n$$\n使用格林第一恒等式和周期性边界条件，边界项消失：\n$$\n\\frac{d}{dt} \\|c\\|^2_{L^2} = 2D \\left( \\oint_{\\partial \\Omega} c \\nabla c \\cdot d\\mathbf{S} - \\int_\\Omega |\\nabla c|^2 \\, dV \\right) = -2D \\int_\\Omega |\\nabla c|^2 \\, dV\n$$\n如果 $D < 0$，令 $D = -|D|$。那么 $\\frac{d}{dt} \\|c\\|^2_{L^2} = 2|D| \\int_\\Omega |\\nabla c|^2 \\, dV$。由于 $\\int_\\Omega |\\nabla c|^2 \\, dV \\ge 0$，时间导数是非负的。如果解不是均匀的，则 $L^2$ 范数会增加。该陈述中关于 $L^2$ 范数*不会增加*的说法是错误的。此外，如选项 B 的分析所示，当 $D < 0$ 时，问题是不适定的。质量守恒不足以保证适定性。\n\n**结论：错误**", "answer": "$$\\boxed{ABD}$$", "id": "2484525"}, {"introduction": "本练习将理论与现代计算实践相结合，反映了非平衡现象在当前研究中的处理方式。您将编写一个程序来模拟带有噪声的时间序列数据，这类似于非平衡分子动力学（NEMD）模拟的结果，并用它来计算各种输运过程的熵产生率。这将使抽象的通量-力乘积 ($J X$) 概念变得具体化，并展示如何从涨落的数据中提取出宏观的耗散率。[@problem_id:2654957]", "problem": "非平衡分子动力学 (NEMD) 模拟会产生响应外部施加的热力学力的瞬时通量时间序列。在线性非平衡热力学中，瞬时局域熵产生速率密度是通量和力的双线性形式。您将实现一个程序，为几种典型的不可逆过程构建合成的 NEMD 时间序列，并通过时间平均计算稳态熵产生速率密度。\n\n从以下基本原理开始：\n- 对于单过程情形，局域熵平衡可以写为 $\\partial s / \\partial t + \\nabla \\cdot \\mathbf{J}_s = \\sigma$，其中 $\\sigma \\ge 0$ 是局域熵产生速率密度。\n- 在线性近平衡区域，单个过程对的熵产生为 $\\sigma = \\langle J X \\rangle$，其中 $J$ 表示与标量热力学力 $X$ 共轭的标量通量分量，而 $\\langle \\cdot \\rangle$ 是稳态条件下的系综平均或时间平均。\n- 对于所考虑的三个过程：\n  - 一维热传导：$J \\equiv J_q$（热通量，单位为 $\\mathrm{W}\\,\\mathrm{m}^{-2}$），$X \\equiv \\nabla (1/T)$（逆温度梯度，单位为 $\\mathrm{K}^{-1}\\,\\mathrm{m}^{-1}$），因此 $\\sigma = \\langle J_q \\, \\nabla (1/T) \\rangle$，单位为 $\\mathrm{W}\\,\\mathrm{m}^{-3}\\,\\mathrm{K}^{-1}$。\n  - 简单剪切流：$J \\equiv \\tau_{xy}$（剪切应力，单位为 $\\mathrm{Pa}$），$X \\equiv \\dot{\\gamma}/T$（剪切速率除以温度，单位为 $\\mathrm{s}^{-1}\\,\\mathrm{K}^{-1}$），因此 $\\sigma = \\langle \\tau_{xy} \\, \\dot{\\gamma}/T \\rangle$，单位为 $\\mathrm{W}\\,\\mathrm{m}^{-3}\\,\\mathrm{K}^{-1}$。\n  - 电传导：$J \\equiv J_e$（电流密度，单位为 $\\mathrm{A}\\,\\mathrm{m}^{-2}$），$X \\equiv E/T$（电场强度除以温度，单位为 $\\mathrm{V}\\,\\mathrm{m}^{-1}\\,\\mathrm{K}^{-1}$），因此 $\\sigma = \\langle J_e \\, E/T \\rangle$，单位为 $\\mathrm{W}\\,\\mathrm{m}^{-3}\\,\\mathrm{K}^{-1}$。\n\n您将使用带加性高斯噪声的线性响应模型生成合成的稳态时间序列，以模拟 NEMD 数据：\n- 对于恒定的力序列 $X_t \\equiv X$ 和一个选定的真实线性系数 $L_{\\mathrm{true}}$，通量序列为 $J_t = L_{\\mathrm{true}} X + \\epsilon_t$，其中 $\\epsilon_t \\sim \\mathcal{N}(0, \\sigma_{\\epsilon}^2)$ 表示热涨落和采样涨落。\n- 稳态熵产生速率密度的估计量是时间平均 $\\hat{\\sigma} = \\frac{1}{N} \\sum_{t=1}^{N} J_t X_t$。\n\n实现一个程序，它对下面的每个测试用例，使用指定的参数和一个固定的伪随机数生成器种子，构建相应的长度为 $N$ 的时间序列 $(J_t, X_t)$，然后计算 $\\hat{\\sigma}$。\n\n伪随机数生成器使用固定种子 $s = 2025$。对于 $X$ 非零的用例，使用给定的噪声分数 $f$ 设置 $\\sigma_{\\epsilon} = f \\, |L_{\\mathrm{true}} X|$。对于零力用例，设置 $X_t \\equiv 0$，并使用指定的绝对标准差 $\\sigma_{\\epsilon}$ 从 $\\mathcal{N}(0, \\sigma_{\\epsilon}^2)$ 中抽取 $J_t$。\n\n测试套件（四个用例）：\n- 用例 H（热传导）：\n  - 长度 $N = 10000$\n  - 温度 $T = 300\\ \\mathrm{K}$\n  - 热导率 $\\kappa = 0.6\\ \\mathrm{W}\\,\\mathrm{m}^{-1}\\,\\mathrm{K}^{-1}$\n  - 真实系数 $L_{\\mathrm{true}} = \\kappa T^2$\n  - 恒定热力学力 $X = 1.0 \\times 10^{-5}\\ \\mathrm{K}^{-1}\\,\\mathrm{m}^{-1}$\n  - 噪声分数 $f = 0.05$\n- 用例 S（简单剪切）：\n  - 长度 $N = 10000$\n  - 温度 $T = 300\\ \\mathrm{K}$\n  - 动力黏度 $\\eta = 1.0 \\times 10^{-3}\\ \\mathrm{Pa}\\,\\mathrm{s}$\n  - 真实系数 $L_{\\mathrm{true}} = \\eta T$\n  - 剪切速率 $\\dot{\\gamma} = 1000\\ \\mathrm{s}^{-1}$；力 $X = \\dot{\\gamma}/T$\n  - 噪声分数 $f = 0.05$\n- 用例 E（电传导）：\n  - 长度 $N = 10000$\n  - 温度 $T = 300\\ \\mathrm{K}$\n  - 电导率 $\\sigma_e = 1.0 \\times 10^{6}\\ \\mathrm{S}\\,\\mathrm{m}^{-1}$\n  - 真实系数 $L_{\\mathrm{true}} = \\sigma_e T$\n  - 电场 $E = 10\\ \\mathrm{V}\\,\\mathrm{m}^{-1}$；力 $X = E/T$\n  - 噪声分数 $f = 0.01$\n- 用例 Z（零力边界情况）：\n  - 长度 $N = 10000$\n  - 温度 $T = 300\\ \\mathrm{K}$\n  - 设置 $X \\equiv 0$\n  - 选择任意 $L_{\\mathrm{true}}$（为确定起见，取 $L_{\\mathrm{true}} = 1.0$；由于 $X = 0$，该值无关紧要）\n  - 绝对噪声标准差 $\\sigma_{\\epsilon} = 1.0$，以通量的单位计\n\n计算和输出要求：\n- 对每个用例，计算时间平均估计量 $\\hat{\\sigma} = \\frac{1}{N} \\sum_{t=1}^{N} J_t X_t$。\n- 将每个 $\\hat{\\sigma}$ 以 $\\mathrm{W}\\,\\mathrm{m}^{-3}\\,\\mathrm{K}^{-1}$ 为单位表示，并四舍五入到六位有效数字。\n- 您的程序应生成单行输出，其中包含四个结果，格式为逗号分隔的列表，并用方括号括起来（例如，“[result_H,result_S,result_E,result_Z]”），不含空格。", "solution": "我们从局域熵平衡开始，$\\partial s / \\partial t + \\nabla \\cdot \\mathbf{J}_s = \\sigma$，其中 $\\sigma \\ge 0$ 是局域熵产生速率密度。对于在线性近平衡区域运行的单个不可逆过程，$\\sigma$ 的典型表达式是通量及其共轭热力学力的双线性形式。在适用于非平衡分子动力学 (NEMD) 的稳态性和均匀性条件下，时空平均等于系综平均，因此可以估计\n$$\n\\sigma = \\langle J X \\rangle,\n$$\n其中 $J$ 是标量通量，$X$ 是与该过程相关的标量力。此处使用的三个过程都适用于此框架：\n\n1. 一维空间热传导：\n   - 通量：$J \\equiv J_q$，单位为 $\\mathrm{W}\\,\\mathrm{m}^{-2}$。\n   - 力：$X \\equiv \\nabla(1/T)$，单位为 $\\mathrm{K}^{-1}\\,\\mathrm{m}^{-1}$。\n   - 熵产生密度：$\\sigma = \\langle J_q \\, \\nabla(1/T) \\rangle$，单位为 $\\mathrm{W}\\,\\mathrm{m}^{-3}\\,\\mathrm{K}^{-1}$。\n   - 在线性不可逆热力学中，傅里叶定律 $J_q = -\\kappa \\nabla T$ 可以改写为 $J_q = L_{\\mathrm{true}} X$，其中 $L_{\\mathrm{true}} = \\kappa T^2$，因为 $X = \\nabla(1/T) = -\\nabla T / T^2$。\n\n2. 简单剪切流：\n   - 通量：$J \\equiv \\tau_{xy}$，单位为 $\\mathrm{Pa}$。\n   - 力：$X \\equiv \\dot{\\gamma} / T$，单位为 $\\mathrm{s}^{-1}\\,\\mathrm{K}^{-1}$。\n   - 熵产生密度：$\\sigma = \\langle \\tau_{xy} \\, \\dot{\\gamma} / T \\rangle$，单位为 $\\mathrm{W}\\,\\mathrm{m}^{-3}\\,\\mathrm{K}^{-1}$。\n   - 牛顿流变学给出 $\\tau_{xy} = \\eta \\dot{\\gamma}$，因此 $J = L_{\\mathrm{true}} X$，其中 $L_{\\mathrm{true}} = \\eta T$。\n\n3. 电传导：\n   - 通量：$J \\equiv J_e$，单位为 $\\mathrm{A}\\,\\mathrm{m}^{-2}$。\n   - 力：$X \\equiv E / T$，单位为 $\\mathrm{V}\\,\\mathrm{m}^{-1}\\,\\mathrm{K}^{-1}$。\n   - 熵产生密度：$\\sigma = \\langle J_e \\, E / T \\rangle$，单位为 $\\mathrm{W}\\,\\mathrm{m}^{-3}\\,\\mathrm{K}^{-1}$。\n   - 欧姆定律 $J_e = \\sigma_e E$ 变为 $J = L_{\\mathrm{true}} X$，其中 $L_{\\mathrm{true}} = \\sigma_e T$。\n\n在 NEMD 中，人们在指定的力 $\\{X_t\\}_{t=1}^N$ 下测量瞬时通量值的时间序列 $\\{J_t\\}_{t=1}^N$。在稳态、遍历的定态下，估计量\n$$\n\\hat{\\sigma} = \\frac{1}{N} \\sum_{t=1}^{N} J_t X_t\n$$\n是 $\\sigma$ 的一致估计量。为模拟此类数据，我们采用带加性高斯噪声的线性响应模型：\n$$\nJ_t = L_{\\mathrm{true}} X_t + \\epsilon_t, \\quad \\epsilon_t \\sim \\mathcal{N}(0, \\sigma_{\\epsilon}^2).\n$$\n对于非零力用例，我们选择 $\\sigma_{\\epsilon} = f\\,|L_{\\mathrm{true}} X|$，其中 $f$ 是指定的噪声分数，代表一个恒定的相对噪声。对于零力边界情况，我们设置 $X_t \\equiv 0$，并将 $\\sigma_{\\epsilon}$ 设为固定的绝对值，以模拟平衡态下的自发通量涨落。固定种子 $s = 2025$ 确保了结果的可复现性。\n\n每个用例的算法步骤：\n1. 解析参数 $(N, T, \\text{材料参数}, L_{\\mathrm{true}}, X, f \\text{ 或 } \\sigma_{\\epsilon})$。\n2. 将 $X_t \\equiv X$ 构建为长度为 $N$ 的常数数组。\n3. 当 $X \\ne 0$ 时，设置 $\\sigma_{\\epsilon} = f \\, |L_{\\mathrm{true}} X|$，否则使用提供的绝对值 $\\sigma_{\\epsilon}$。\n4. 用 $\\epsilon_t \\sim \\mathcal{N}(0, \\sigma_{\\epsilon}^2)$ 生成 $J_t = L_{\\mathrm{true}} X + \\epsilon_t$。\n5. 计算 $\\hat{\\sigma} = \\frac{1}{N} \\sum_{t=1}^N J_t X_t$。\n6. 以 $\\mathrm{W}\\,\\mathrm{m}^{-3}\\,\\mathrm{K}^{-1}$ 为单位报告 $\\hat{\\sigma}$，四舍五入到六位有效数字。\n\n与理论进行的健全性检查（无噪声预测）：\n- 用例 H：$\\sigma_{\\text{theory}} = L_{\\mathrm{true}} X^2 = (\\kappa T^2) X^2$。在 $\\kappa = 0.6\\ \\mathrm{W}\\,\\mathrm{m}^{-1}\\,\\mathrm{K}^{-1}$、$T = 300\\ \\mathrm{K}$、$X = 1.0 \\times 10^{-5}\\ \\mathrm{K}^{-1}\\,\\mathrm{m}^{-1}$ 的条件下，可得 $L_{\\mathrm{true}} = 54000\\ \\mathrm{W}\\,\\mathrm{K}\\,\\mathrm{m}^{-1}$ 和 $\\sigma_{\\text{theory}} = 5.4 \\times 10^{-6}\\ \\mathrm{W}\\,\\mathrm{m}^{-3}\\,\\mathrm{K}^{-1}$。\n- 用例 S：$\\sigma_{\\text{theory}} = \\eta \\dot{\\gamma}^2 / T$。在 $\\eta = 1.0 \\times 10^{-3}\\ \\mathrm{Pa}\\,\\mathrm{s}$、$\\dot{\\gamma} = 1000\\ \\mathrm{s}^{-1}$、$T = 300\\ \\mathrm{K}$ 的条件下，可得 $\\sigma_{\\text{theory}} \\approx 3.333333\\ \\mathrm{W}\\,\\mathrm{m}^{-3}\\,\\mathrm{K}^{-1}$。\n- 用例 E：$\\sigma_{\\text{theory}} = \\sigma_e E^2 / T$。在 $\\sigma_e = 1.0 \\times 10^{6}\\ \\mathrm{S}\\,\\mathrm{m}^{-1}$、$E = 10\\ \\mathrm{V}\\,\\mathrm{m}^{-1}$、$T = 300\\ \\mathrm{K}$ 的条件下，可得 $\\sigma_{\\text{theory}} \\approx 333333.333333\\ \\mathrm{W}\\,\\mathrm{m}^{-3}\\,\\mathrm{K}^{-1}$。\n- 用例 Z：$\\sigma_{\\text{theory}} = 0$，因为 $X \\equiv 0$ 意味着对于所有 $t$，$J_t X_t \\equiv 0$。\n\n因为估计量关于 $J_t$ 和 $X_t$ 是线性的，且噪声均值为零，所以 $\\hat{\\sigma}$ 的期望值等于理论值，而其方差随 $1/N$ 减小。使用指定的 $N$ 和噪声水平会产生很小的采样误差，因此计算值应在四舍五入到六位有效数字的精度内与理论预测紧密匹配。\n\n所要求的程序对这四个测试用例执行此过程，并打印单行结果“[sigma_H,sigma_S,sigma_E,sigma_Z]”，其中每个值都以 $\\mathrm{W}\\,\\mathrm{m}^{-3}\\,\\mathrm{K}^{-1}$ 为单位，并四舍五入到六位有效数字。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef simulate_entropy_production(N, L_true, X, rng, noise_frac=None, noise_abs=None):\n    \"\"\"\n    Simulate a stationary time series for a single process and estimate entropy production.\n    Parameters:\n        N (int): length of time series\n        L_true (float): true linear-response coefficient\n        X (float): constant thermodynamic force\n        rng (np.random.Generator): random number generator\n        noise_frac (float or None): relative noise sigma as fraction of |L_true * X|\n        noise_abs (float or None): absolute noise sigma (used when X == 0)\n    Returns:\n        float: estimated entropy production density, mean(J_t * X_t)\n    \"\"\"\n    # Determine noise standard deviation\n    if X == 0.0:\n        if noise_abs is None:\n            raise ValueError(\"noise_abs must be provided when X == 0\")\n        sigma_eps = float(noise_abs)\n    else:\n        if noise_frac is None:\n            raise ValueError(\"noise_frac must be provided when X != 0\")\n        sigma_eps = float(noise_frac) * abs(L_true * X)\n\n    # Generate flux time series with additive Gaussian noise\n    eps = rng.normal(loc=0.0, scale=sigma_eps, size=N)\n    J = L_true * X + eps\n\n    # Constant force time series\n    # Entropy production estimator: mean of instantaneous products\n    sigma_hat = float(np.mean(J * X))\n    return sigma_hat\n\ndef solve():\n    rng = np.random.default_rng(2025)\n\n    # Case H: Heat conduction\n    N_H = 10000\n    T_H = 300.0  # K\n    kappa = 0.6  # W m^-1 K^-1\n    L_true_H = kappa * (T_H ** 2)  # W K m^-1\n    X_H = 1.0e-5  # K^-1 m^-1\n    f_H = 0.05\n\n    sigma_H = simulate_entropy_production(N=N_H, L_true=L_true_H, X=X_H,\n                                          rng=rng, noise_frac=f_H, noise_abs=None)\n\n    # Case S: Simple shear\n    N_S = 10000\n    T_S = 300.0  # K\n    eta = 1.0e-3  # Pa s\n    L_true_S = eta * T_S  # Pa K s\n    gamma_dot = 1000.0  # s^-1\n    X_S = gamma_dot / T_S  # s^-1 K^-1\n    f_S = 0.05\n\n    sigma_S = simulate_entropy_production(N=N_S, L_true=L_true_S, X=X_S,\n                                          rng=rng, noise_frac=f_S, noise_abs=None)\n\n    # Case E: Electrical conduction\n    N_E = 10000\n    T_E = 300.0  # K\n    sigma_e = 1.0e6  # S m^-1\n    L_true_E = sigma_e * T_E  # A K V^-1 m^-1\n    E_field = 10.0  # V m^-1\n    X_E = E_field / T_E  # V m^-1 K^-1\n    f_E = 0.01\n\n    sigma_E = simulate_entropy_production(N=N_E, L_true=L_true_E, X=X_E,\n                                          rng=rng, noise_frac=f_E, noise_abs=None)\n\n    # Case Z: Zero-force edge case\n    N_Z = 10000\n    L_true_Z = 1.0  # arbitrary, irrelevant since X=0\n    X_Z = 0.0\n    noise_abs_Z = 1.0  # absolute noise in flux units\n\n    sigma_Z = simulate_entropy_production(N=N_Z, L_true=L_true_Z, X=X_Z,\n                                          rng=rng, noise_frac=None, noise_abs=noise_abs_Z)\n\n    # Prepare results rounded to six significant digits\n    results = [sigma_H, sigma_S, sigma_E, sigma_Z]\n    formatted = [format(x, \".6g\") for x in results]\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(formatted)}]\")\n\nsolve()\n```", "id": "2654957"}]}