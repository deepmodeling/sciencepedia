{"hands_on_practices": [{"introduction": "在物理学中，对称性原理扮演着核心角色。对于一个其势能仅仅是在空间中平移的系统，其平衡态性质，因此也包括其自由能，理应保持不变。本练习 [@problem_id:2677133] 要求您从第一性原理出发证明这一基本事实，并思考当自由能变化 $\\Delta F = 0$ 时，这对通过Jarzynski等式和Crooks涨落定理进行的非平衡功测量意味着什么。", "problem": "一个质量为 $m$ 的经典粒子在一维空间 $x \\in \\mathbb{R}$ 中运动，同时与温度为 $T$ 的热浴（正则系综）弱耦合。其在控制参数 $\\ell$ 下的哈密顿量为 $H(p,x;\\ell)=\\frac{p^{2}}{2m}+V(x-\\ell)$，其中 $V$ 是一个固定的、足够强的约束势，以确保所有必需的积分都收敛，而 $\\ell$ 将此势在空间中进行刚性平移。系统初始时在 $\\ell=0$ 处处于平衡状态。考虑一个在有限时间内将势从 $\\ell=0$ 平移到 $\\ell=L$ 的过程，在此期间粒子始终与温度为 $T$ 的热浴接触。\n\n仅使用正则配分函数和亥姆霍兹自由能的定义，从第一性原理出发解释为什么与此纯平移相关的平衡亥姆霍兹自由能变化 $\\Delta F \\equiv F(L)-F(0)$ 精确为零，且与 $L$ 无关。然后，通过显式计算经典正则配分函数 $Z(\\ell)$ 并证明其与 $\\ell$ 无关，来验证这一结论。最后，简要评论该结果如何与针对势的任意有限时间平移的 Jarzynski 等式和 Crooks 涨落定理的非平衡陈述相一致。\n\n你的最终答案必须是 $\\Delta F$ 的精确解析值。以焦耳为单位表示最终能量。无需四舍五入。", "solution": "问题陈述已经过评估，被认为是有效的。这是一个在经典统计力学中提法恰当、有科学依据的问题。我们将进行严谨的求解。\n\n该问题要求三件事：首先，从原理上解释为什么对于势的简单平移，平衡亥姆霍兹自由能变化 $\\Delta F$ 为零；其次，通过计算配分函数来显式验证这一事实；第三，简要评论该结果与非平衡涨落定理的一致性。\n\n让我们开始。亥姆霍兹自由能 $F$ 是通过正则配分函数 $Z$ 在温度 $T$ 下定义的：\n$$F = -k_B T \\ln Z$$\n其中 $k_B$ 是玻尔兹曼常数。因此，与控制参数从 $\\ell=0$ 变为 $\\ell=L$ 相关的自由能变化是\n$$\\Delta F = F(L) - F(0) = -k_B T \\ln Z(L) - (-k_B T \\ln Z(0)) = -k_B T \\ln\\left(\\frac{Z(L)}{Z(0)}\\right)$$\n为了证明 $\\Delta F = 0$，我们必须证明 $Z(L) = Z(0)$。\n\n对于具有哈密顿量 $H(p,x;\\ell)$ 的一维单粒子系统，其经典正则配分函数由相空间上的积分给出：\n$$Z(\\ell) = \\frac{1}{h} \\int_{-\\infty}^{\\infty} dp \\int_{-\\infty}^{\\infty} dx \\, \\exp(-\\beta H(p,x;\\ell))$$\n其中 $\\beta = \\frac{1}{k_B T}$，$h$ 是一个具有作用量单位的常数（普朗克常数），它使得 $Z$ 无量纲，但其值与 $\\Delta F$ 的计算无关。代入给定的哈密顿量 $H(p,x;\\ell) = \\frac{p^2}{2m} + V(x-\\ell)$，我们得到：\n$$Z(\\ell) = \\frac{1}{h} \\int_{-\\infty}^{\\infty} dp \\int_{-\\infty}^{\\infty} dx \\, \\exp\\left(-\\beta \\left[ \\frac{p^2}{2m} + V(x-\\ell) \\right]\\right)$$\n\n为了从第一性原理证明 $Z(\\ell)$ 与 $\\ell$ 无关，考虑 $Z(L)$ 的表达式：\n$$Z(L) = \\frac{1}{h} \\int_{-\\infty}^{\\infty} dp \\int_{-\\infty}^{\\infty} dx \\, \\exp\\left(-\\beta \\left[ \\frac{p^2}{2m} + V(x-L) \\right]\\right)$$\n在对 $x$ 的空间积分中，我们进行变量替换。令 $x' = x-L$。因此，$x = x'+L$ 且微分元为 $dx = dx'$。由于 $x$ 的原始积分域是 $(-\\infty, \\infty)$，所以 $x'$ 的新积分域也是 $(-\\infty, \\infty)$。将此代入 $Z(L)$ 的表达式中：\n$$Z(L) = \\frac{1}{h} \\int_{-\\infty}^{\\infty} dp \\int_{-\\infty}^{\\infty} dx' \\, \\exp\\left(-\\beta \\left[ \\frac{p^2}{2m} + V((x'+L)-L) \\right]\\right)$$\n$$Z(L) = \\frac{1}{h} \\int_{-\\infty}^{\\infty} dp \\int_{-\\infty}^{\\infty} dx' \\, \\exp\\left(-\\beta \\left[ \\frac{p^2}{2m} + V(x') \\right]\\right)$$\n现在，将此表达式与 $\\ell=0$ 时的配分函数进行比较：\n$$Z(0) = \\frac{1}{h} \\int_{-\\infty}^{\\infty} dp \\int_{-\\infty}^{\\infty} dx \\, \\exp\\left(-\\beta \\left[ \\frac{p^2}{2m} + V(x) \\right]\\right)$$\n$Z(L)$ 和 $Z(0)$ 的表达式是相同的。积分变量是一个哑变量；无论是用 $x$ 还是 $x'$ 表示，对于定积分的值都没有影响。这表明，由于全空间积分测度的平移不变性，$Z(L) = Z(0)$。因此，\n$$\\Delta F = -k_B T \\ln\\left(\\frac{Z(L)}{Z(0)}\\right) = -k_B T \\ln(1) = 0$$\n\n接下来，我们通过显式计算 $Z(\\ell)$ 来验证这一结论。该积分可以分解为动量部分和位置部分：\n$$Z(\\ell) = \\left( \\frac{1}{h} \\int_{-\\infty}^{\\infty} dp \\, \\exp\\left(-\\frac{\\beta p^2}{2m}\\right) \\right) \\left( \\int_{-\\infty}^{\\infty} dx \\, \\exp(-\\beta V(x-\\ell)) \\right)$$\n动量积分是标准的高斯积分 $\\int_{-\\infty}^{\\infty} \\exp(-ax^2)dx = \\sqrt{\\pi/a}$。此处，$a = \\frac{\\beta}{2m}$。\n$$\\int_{-\\infty}^{\\infty} dp \\, \\exp\\left(-\\frac{\\beta p^2}{2m}\\right) = \\sqrt{\\frac{2m\\pi}{\\beta}} = \\sqrt{2\\pi m k_B T}$$\n让我们将配分函数的组态部分表示为 $Z_x(\\ell)$：\n$$Z_x(\\ell) = \\int_{-\\infty}^{\\infty} dx \\, \\exp(-\\beta V(x-\\ell))$$\n和之前一样，我们进行变量替换 $x' = x-\\ell$，因此 $dx = dx'$。积分上下限不变。\n$$Z_x(\\ell) = \\int_{-\\infty}^{\\infty} dx' \\, \\exp(-\\beta V(x'))$$\n这个积分产生一个常数值，它依赖于势 $V$ 的形状和温度 $T$，但显然与参数 $\\ell$ 无关。我们称这个常数为 $C_V = \\int_{-\\infty}^{\\infty} \\exp(-\\beta V(x')) dx'$。问题陈述已说明势具有足够的约束性以确保该积分收敛。\n所以，总配分函数为：\n$$Z(\\ell) = \\frac{1}{h} \\sqrt{2\\pi m k_B T} \\cdot C_V$$\n由于 $Z(\\ell)$ 的这个表达式不包含 $\\ell$，配分函数相对于控制参数是一个常数。因此，$Z(L) = Z(0)$，并且当势被平移时，平衡亥姆霍兹自由能不发生改变：$F(L) = F(0)$，这意味着 $\\Delta F = 0$。这显式地验证了我们最初的结论。\n\n最后，我们评论其与 Jarzynski 等式和 Crooks 涨落定理的一致性。Jarzynski 等式指出，对于一个非平衡过程，\n$$\\langle \\exp(-\\beta W) \\rangle = \\exp(-\\beta \\Delta F)$$\n其中 $W$ 是对系统做的功，平均值是对从平衡态开始的轨迹系综取的。在我们的例子中，我们已经证明了 $\\Delta F = 0$。因此，对于任何将势从 $\\ell=0$ 平移到 $\\ell=L$ 的过程，Jarzynski 等式变为：\n$$\\langle \\exp(-\\beta W) \\rangle = 1$$\n这是一个非平凡的预测。尽管对于任何有限时间的过程，都会做功并以热的形式耗散（根据热力学第二定律，我们期望 $\\langle W \\rangle \\ge \\Delta F$，所以 $\\langle W \\rangle \\ge 0$），但这个功的特定指数平均值必须精确等于 1。\n\nCrooks 涨落定理关联了正向过程的功分布 $P_F(W)$ 和时间反演过程的功分布 $P_R(-W)$:\n$$\\frac{P_F(W)}{P_R(-W)} = \\exp(\\beta(W - \\Delta F))$$\n对于我们的系统，由于 $\\Delta F = 0$，这简化为：\n$$\\frac{P_F(W)}{P_R(-W)} = \\exp(\\beta W)$$\n这被称为稳态涨落定理，或者在这种对称的背景下，它显示了功分布与其反向过程之间的直接关系。因此，$\\Delta F=0$ 的结果从根本上与这些定理相一致，并为将它们应用于这一特定物理情境提供了关键输入。$\\Delta F=0$ 的物理基础是空间的均匀性，这意味着系统的平衡性质不能依赖于约束势的绝对位置。", "answer": "$$\n\\boxed{0}\n$$", "id": "2677133"}, {"introduction": "基于前一个练习中 $\\Delta F=0$ 的概念，本实践将深入探讨其微观细节。通过对在移动谐振子势阱中的过阻尼粒子建立Langevin动力学模型，我们可以精确计算所做的功及其统计特性 [@problem_id:2677138]。这个练习有力地展示了Jarzynski等式是如何从底层的随机动力学和涨落-耗散关系中涌现出来的，为抽象的理论提供了坚实的计算基础。", "problem": "一个坐标为 $x(t)$ 的过阻尼布朗粒子在由 $V(x,t)=\\tfrac{1}{2}k\\left(x-vt\\right)^{2}$ 给出的一维时谐势中演化，其中 $k>0$ 是刚度， $v$ 是势阱中心的恒定平移速度。该粒子与绝对温度为 $T$ 的热浴接触，其逆温度为 $\\beta \\equiv 1/(k_{B}T)$，其中 $k_{B}$ 是 Boltzmann 常数。该粒子的过阻尼动力学遵循朗之万方程，摩擦系数 $\\gamma$ 为常数，\n$$\n\\gamma\\,\\dot{x}(t) \\;=\\; -\\partial_{x}V(x,t) \\;+\\; \\xi(t),\n$$\n其中随机力 $\\xi(t)$ 是均值为零的高斯力，并满足涨落-耗散关系 $\\langle \\xi(t)\\,\\xi(s)\\rangle = 2\\gamma k_{B}T\\,\\delta(t-s)$。在时间 $t=0$ 时，粒子相对于 $V(x,0)=\\tfrac{1}{2}k x^{2}$ 处于平衡状态。\n\n将在时间间隔 $[0,\\tau]$ 内，由外部驱动对粒子所做的总功定义为\n$$\nW \\;=\\; \\int_{0}^{\\tau}\\! dt\\, \\left.\\frac{\\partial V(x,t)}{\\partial t}\\right|_{x=x(t)}.\n$$\n\n任务：\n- 仅从朗之万动力学、涨落-耗散关系以及上述功 $W$ 的定义出发，推导在有限协议时长 $\\tau>0$ 后，平均值 $\\langle W\\rangle$ 和方差 $\\mathrm{Var}(W)$ 的闭式表达式，用 $k$、$\\gamma$、 $v$、$\\beta$ 和 $\\tau$ 表示。\n- 然后，利用你得到的功的统计特性（不援引任何外部等式或定理），精确计算指数平均值 $\\langle \\exp(-\\beta W)\\rangle$。\n\n报告 $\\langle \\exp(-\\beta W)\\rangle$ 的精确值作为你的最终答案。不要包含单位，也不要四舍五入。", "solution": "所述问题具有科学依据、提法恰当、客观且内部一致。这是随机热力学中的一个标准问题，并且可以从基本原理推导出唯一解。因此，该问题是有效的，我将继续进行推导。\n\n势由 $V(x,t) = \\frac{1}{2}k(x-vt)^2$ 给出。在时间间隔 $[0,\\tau]$ 内对粒子所做的功 $W$ 定义为\n$$\nW = \\int_{0}^{\\tau} dt\\, \\frac{\\partial V(x(t),t)}{\\partial t}.\n$$\n势对时间的偏导数为\n$$\n\\frac{\\partial V(x,t)}{\\partial t} = \\frac{1}{2}k \\cdot 2(x-vt) \\cdot (-v) = -kv(x-vt).\n$$\n因此，功是粒子轨迹 $x(t)$ 的一个泛函：\n$$\nW = -kv \\int_{0}^{\\tau} dt\\, [x(t) - vt].\n$$\n粒子的轨迹 $x(t)$ 由过阻尼朗之万方程决定：\n$$\n\\gamma \\dot{x}(t) = -\\frac{\\partial V(x,t)}{\\partial x} + \\xi(t) = -k(x(t)-vt) + \\xi(t).\n$$\n这是一个线性一阶非齐次随机微分方程，可以重新排列为：\n$$\n\\dot{x}(t) + \\frac{k}{\\gamma} x(t) = \\frac{k}{\\gamma} vt + \\frac{1}{\\gamma} \\xi(t).\n$$\n令 $\\tau_r = \\gamma/k$ 为系统的特征弛豫时间。方程变为：\n$$\n\\dot{x}(t) + \\frac{1}{\\tau_r} x(t) = \\frac{vt}{\\tau_r} + \\frac{1}{\\gamma} \\xi(t).\n$$\n此方程在初始条件 $x(0)$ 下的正式解可通过使用积分因子 $e^{t/\\tau_r}$ 求得：\n$$\nx(t) = x(0)e^{-t/\\tau_r} + \\int_{0}^{t} ds\\, e^{-(t-s)/\\tau_r} \\left( \\frac{vs}{\\tau_r} + \\frac{1}{\\gamma}\\xi(s) \\right).\n$$\n在 $t=0$ 时，系统与势 $V(x,0) = \\frac{1}{2}kx^2$ 处于热平衡状态。初始位置 $x(0)$ 的概率分布是 Boltzmann 分布：\n$$\np_{eq}(x(0)) = \\frac{1}{Z_0} \\exp(-\\beta V(x(0),0)) = \\sqrt{\\frac{\\beta k}{2\\pi}} \\exp\\left(-\\frac{\\beta k}{2}x(0)^2\\right).\n$$\n这是一个高斯分布，其均值为 $\\langle x(0) \\rangle = 0$，方差为 $\\langle x(0)^2 \\rangle = \\frac{1}{\\beta k}$。噪声 $\\xi(t)$ 也是一个均值为 $\\langle \\xi(t) \\rangle = 0$ 的高斯过程。\n\n首先，我们计算平均功 $\\langle W \\rangle$。这需要计算平均轨迹 $\\langle x(t) \\rangle$。对 $x(t)$ 的解取期望值：\n$$\n\\langle x(t) \\rangle = \\langle x(0) \\rangle e^{-t/\\tau_r} + \\int_{0}^{t} ds\\, e^{-(t-s)/\\tau_r} \\left( \\frac{vs}{\\tau_r} + \\frac{1}{\\gamma} \\langle \\xi(s) \\rangle \\right).\n$$\n由于 $\\langle x(0) \\rangle = 0$ 和 $\\langle \\xi(s) \\rangle = 0$，上式简化为：\n$$\n\\langle x(t) \\rangle = \\frac{v}{\\tau_r} e^{-t/\\tau_r} \\int_{0}^{t} ds\\, s e^{s/\\tau_r}.\n$$\n分部积分得到：\n$$\n\\int_{0}^{t} s e^{s/\\tau_r} ds = \\left[s\\tau_r e^{s/\\tau_r}\\right]_0^t - \\int_0^t \\tau_r e^{s/\\tau_r} ds = t\\tau_r e^{t/\\tau_r} - \\tau_r^2 (e^{t/\\tau_r} - 1).\n$$\n将其代回，我们得到平均轨迹：\n$$\n\\langle x(t) \\rangle = \\frac{v}{\\tau_r} e^{-t/\\tau_r} \\left( t\\tau_r e^{t/\\tau_r} - \\tau_r^2 e^{t/\\tau_r} + \\tau_r^2 \\right) = v(t - \\tau_r + \\tau_r e^{-t/\\tau_r}).\n$$\n现在我们可以计算平均功：\n$$\n\\langle W \\rangle = -kv \\int_{0}^{\\tau} dt\\, [\\langle x(t) \\rangle - vt] = -kv \\int_{0}^{\\tau} dt\\, [v(t - \\tau_r + \\tau_r e^{-t/\\tau_r}) - vt].\n$$\n$$\n\\langle W \\rangle = -kv \\int_{0}^{\\tau} dt\\, [-v\\tau_r + v\\tau_r e^{-t/\\tau_r}] = kv^2\\tau_r \\int_{0}^{\\tau} dt\\, (1 - e^{-t/\\tau_r}).\n$$\n$$\n\\langle W \\rangle = kv^2\\tau_r \\left[t + \\tau_r e^{-t/\\tau_r}\\right]_0^{\\tau} = kv^2\\tau_r \\left( (\\tau + \\tau_r e^{-\\tau/\\tau_r}) - (0 + \\tau_r) \\right).\n$$\n$$\n\\langle W \\rangle = kv^2\\tau_r \\left(\\tau - \\tau_r(1 - e^{-\\tau/\\tau_r})\\right).\n$$\n代入 $\\tau_r = \\gamma/k$：\n$$\n\\langle W \\rangle = k v^2 \\frac{\\gamma}{k} \\left(\\tau - \\frac{\\gamma}{k}(1-e^{-k\\tau/\\gamma})\\right) = \\gamma v^2 \\tau - \\frac{\\gamma^2 v^2}{k}(1-e^{-k\\tau/\\gamma}).\n$$\n\n接下来，我们计算功的方差，$\\mathrm{Var}(W) = \\langle (W-\\langle W \\rangle)^2 \\rangle$。\n$$\nW - \\langle W \\rangle = -kv \\int_{0}^{\\tau} dt\\, [x(t) - \\langle x(t) \\rangle].\n$$\n令平均路径周围的涨落为 $y(t) = x(t) - \\langle x(t) \\rangle$。则 $W - \\langle W \\rangle = -kv \\int_{0}^{\\tau} dt\\, y(t)$。\n$$\n\\mathrm{Var}(W) = k^2 v^2 \\int_{0}^{\\tau} dt_1 \\int_{0}^{\\tau} dt_2\\, \\langle y(t_1)y(t_2) \\rangle.\n$$\n涨落过程 $y(t)$ 由下式给出\n$$\ny(t) = y(0)e^{-t/\\tau_r} + \\frac{1}{\\gamma} \\int_0^t ds\\, e^{-(t-s)/\\tau_r} \\xi(s),\n$$\n其中 $y(0) = x(0) - \\langle x(0) \\rangle = x(0)$。由于初始状态与随后的噪声无关，$\\langle y(0)\\xi(s) \\rangle = \\langle x(0) \\rangle \\langle \\xi(s) \\rangle = 0$。$y(t)$ 的自相关函数为：\n$$\n\\langle y(t_1)y(t_2) \\rangle = \\langle y(0)^2 \\rangle e^{-(t_1+t_2)/\\tau_r} + \\frac{1}{\\gamma^2} \\int_0^{t_1} ds_1 \\int_0^{t_2} ds_2 e^{-(t_1-s_1)/\\tau_r} e^{-(t_2-s_2)/\\tau_r} \\langle \\xi(s_1)\\xi(s_2) \\rangle.\n$$\n使用 $\\langle y(0)^2 \\rangle = \\langle x(0)^2 \\rangle = \\frac{1}{\\beta k}$ 和 $\\langle \\xi(s_1)\\xi(s_2) \\rangle = \\frac{2\\gamma}{\\beta}\\delta(s_1-s_2)$，并假设 $t_1 \\le t_2$：\n$$\n\\langle y(t_1)y(t_2) \\rangle = \\frac{1}{\\beta k}e^{-(t_1+t_2)/\\tau_r} + \\frac{2}{\\gamma\\beta} \\int_0^{t_1} ds_1\\, e^{-(t_1-s_1)/\\tau_r}e^{-(t_2-s_1)/\\tau_r}.\n$$\n$$\n= \\frac{1}{\\beta k}e^{-(t_1+t_2)/\\tau_r} + \\frac{2}{\\gamma\\beta} e^{-(t_1+t_2)/\\tau_r} \\int_0^{t_1} ds_1\\, e^{2s_1/\\tau_r}.\n$$\n$$\n= \\frac{1}{\\beta k}e^{-(t_1+t_2)/\\tau_r} + \\frac{2}{\\gamma\\beta} e^{-(t_1+t_2)/\\tau_r} \\left[\\frac{\\tau_r}{2}e^{2s_1/\\tau_r}\\right]_0^{t_1} = \\frac{1}{\\beta k}e^{-(t_1+t_2)/\\tau_r} + \\frac{\\tau_r}{\\gamma\\beta} e^{-(t_1+t_2)/\\tau_r} (e^{2t_1/\\tau_r} - 1).\n$$\n由于 $\\tau_r = \\gamma/k$，我们有 $\\frac{\\tau_r}{\\gamma\\beta} = \\frac{1}{k\\beta}$。\n$$\n\\langle y(t_1)y(t_2) \\rangle = \\frac{1}{\\beta k}e^{-(t_1+t_2)/\\tau_r} + \\frac{1}{k\\beta} (e^{(t_1-t_2)/\\tau_r} - e^{-(t_1+t_2)/\\tau_r}) = \\frac{1}{\\beta k}e^{-(t_2-t_1)/\\tau_r}.\n$$\n对于一般的 $t_1, t_2$，有 $\\langle y(t_1)y(t_2) \\rangle = \\frac{1}{\\beta k}e^{-|t_1-t_2|/\\tau_r}$。因此，功的方差为：\n$$\n\\mathrm{Var}(W) = \\frac{k^2 v^2}{\\beta k} \\int_{0}^{\\tau} dt_1 \\int_{0}^{\\tau} dt_2\\, e^{-|t_1-t_2|/\\tau_r} = \\frac{kv^2}{\\beta} \\left( 2 \\int_0^\\tau dt_2 \\int_0^{t_2} dt_1 e^{-(t_2-t_1)/\\tau_r} \\right).\n$$\n内部积分为 $\\int_0^{t_2} e^{t_1/\\tau_r} dt_1 = \\tau_r(e^{t_2/\\tau_r}-1)$。\n$$\n\\mathrm{Var}(W) = \\frac{kv^2}{\\beta} \\left( 2\\tau_r \\int_0^\\tau dt_2\\, e^{-t_2/\\tau_r}(e^{t_2/\\tau_r}-1) \\right) = \\frac{2kv^2\\tau_r}{\\beta} \\int_0^\\tau dt_2\\, (1 - e^{-t_2/\\tau_r}).\n$$\n$$\n\\mathrm{Var}(W) = \\frac{2kv^2\\tau_r}{\\beta} \\left[t_2 + \\tau_r e^{-t_2/\\tau_r}\\right]_0^{\\tau} = \\frac{2kv^2\\tau_r}{\\beta} \\left( \\tau - \\tau_r(1-e^{-\\tau/\\tau_r}) \\right).\n$$\n将此表达式与推导出的 $\\langle W \\rangle$ 表达式进行比较：\n$$\n\\mathrm{Var}(W) = \\frac{2}{\\beta} \\left( kv^2\\tau_r \\left( \\tau - \\tau_r(1-e^{-\\tau/\\tau_r}) \\right) \\right) = \\frac{2}{\\beta} \\langle W \\rangle.\n$$\n这是功的涨落-耗散关系的一个特例，是按要求从第一性原理推导出来的。\n\n最后，我们计算 $\\langle \\exp(-\\beta W) \\rangle$。过程 $x(t)$ 由一个具有高斯初始条件和高斯白噪声的线性朗之万方程驱动。因此，$x(t)$ 是一个高斯随机过程。功 $W$ 是 $x(t)$ 的线性泛函，这意味着 $W$ 是一个高斯随机变量。高斯随机变量完全由其均值 $\\langle W \\rangle$ 和方差 $\\mathrm{Var}(W)$ 决定。高斯变量 $W$ 的指数的期望值由其矩生成函数的公式给出：\n$$\n\\langle \\exp(-\\beta W) \\rangle = \\exp\\left(-\\beta \\langle W \\rangle + \\frac{1}{2}(-\\beta)^2 \\mathrm{Var}(W)\\right) = \\exp\\left(-\\beta \\langle W \\rangle + \\frac{1}{2}\\beta^2 \\mathrm{Var}(W)\\right).\n$$\n使用我们通过对功的统计特性进行显式计算所推导出的关系 $\\mathrm{Var}(W) = \\frac{2}{\\beta} \\langle W \\rangle$：\n$$\n\\langle \\exp(-\\beta W) \\rangle = \\exp\\left(-\\beta \\langle W \\rangle + \\frac{1}{2}\\beta^2 \\left(\\frac{2}{\\beta} \\langle W \\rangle\\right)\\right) = \\exp(-\\beta \\langle W \\rangle + \\beta \\langle W \\rangle) = \\exp(0) = 1.\n$$\n这个结果是严格通过朗之万动力学计算功的统计量，并利用高斯积分的性质得到的，没有以 Jarzynski 等式为前提进行援引。", "answer": "$$\\boxed{1}$$", "id": "2677138"}, {"introduction": "现在，我们将这些思想推广到一个涉及测量和反馈的迷人场景中——以著名的麦克斯韦妖为典型。本练习 [@problem_id:2677157] 探讨了Jarzynski等式如何被修正以包含测量过程中获取的信息量 $I$。通过完成这一实践，您将验证广义Jarzynski等式，并定量地理解信息如何能够被“转化”为功，这触及了热力学与信息论交叉领域的核心。", "problem": "一个理想气体的单个经典粒子被限制在长度为 $L$ 的一维盒子中，并与温度为 $T$ 的热浴接触。系统最初处于平衡状态，其位置呈均匀分布。在 $x=L/2$ 处准静态地插入一个薄的、不可穿透的隔板，将盒子分成两个长度相等的单元，每个长度为 $L/2$。进行一次测量以确定粒子所在的单元 $x \\in \\{\\mathrm{L},\\mathrm{R}\\}$，得到结果 $y \\in \\{\\mathrm{L},\\mathrm{R}\\}$。该测量具有对称错误率 $0<\\varepsilon<\\tfrac{1}{2}$，因此 $p(y=x\\,|\\,x)=1-\\varepsilon$ 且 $p(y\\neq x\\,|\\,x)=\\varepsilon$。$x$ 的先验概率为 $p(x=\\mathrm{L})=p(x=\\mathrm{R})=\\tfrac{1}{2}$。根据测量结果 $y$，一个反馈协议准静态地移动隔板，使得标记为 $y$ 的单元长度变为 $gL$，而相对的单元长度变为 $(1-g)L$，其中 $g\\in(0,1)$ 是一个固定的控制参数。然后移除隔板，恢复长度为 $L$ 的原始盒子，从而闭合循环，使得净外部参数变化满足 $\\Delta F=0$。\n\n仅使用以下基本原理：(i) 对于单个理想粒子，在可及长度从 $V_i$ 到 $V_f$ 的可逆等温变化过程中，外界对系统做的功为 $W=-k_B T \\ln(V_f/V_i)$，其中 $k_B$ 是玻尔兹曼常数，以及 (ii) 测量的逐点（轨迹级）信息内容为 $i(x,y)=\\ln\\!\\big(p(x,y)/[p(x)p(y)]\\big)$，互信息为 $I=\\langle i(x,y)\\rangle$，其中平均值是对联合分布 $p(x,y)$ 求得的。\n\n任务：\n1) 计算互信息 $I$ 作为 $\\varepsilon$ 的函数。\n2) 计算反馈移动隔板过程中的结果平均功 $\\langle W\\rangle$ 作为 $g$ 和 $\\varepsilon$ 的函数，并确定使 $\\langle W\\rangle$ 最小化的值 $g^{\\star}$。用 $k_B T$ 和 $\\varepsilon$ 表示最小化的平均功 $\\langle W\\rangle_{\\min}$，并将其与 $I$ 进行比较。\n3) 定义 $\\beta=1/(k_B T)$ 和指数项 $E(g)=\\langle \\exp\\big(-\\beta\\,[W-\\Delta F]-i(x,y)\\big)\\rangle$，其中平均值是针对所述协议在联合分布 $p(x,y)$ 上求得的。以闭合形式计算 $E(g)$，并将其简化为一个与 $g$ 和 $\\varepsilon$ 无关的值。\n\n给出 $E(g)$ 的值作为最终答案，它是一个没有单位的单一数字。由于结果是精确且无量纲的，因此不需要四舍五入。", "solution": "审视问题陈述的有效性。\n\n**步骤1：提取已知条件**\n- 系统：一个理想气体的单个经典粒子，位于长度为 $L$ 的一维盒子中。\n- 热力学状态：与温度为 $T$ 的热浴接触；初始处于平衡状态。\n- 过程：\n    1. 在 $x=L/2$ 处准静态地插入一个薄的、不可穿透的隔板。\n    2. 测量粒子所在的单元 $x \\in \\{\\mathrm{L},\\mathrm{R}\\}$，得到结果 $y \\in \\{\\mathrm{L},\\mathrm{R}\\}$。\n    3. 一个反馈协议准静态地移动隔板，将单元长度更改为 $gL$（对于单元 $y$）和 $(1-g)L$（对于另一个单元），其中 $g\\in(0,1)$。\n    4. 移除隔板，恢复长度为 $L$ 的盒子。平衡自由能的净变化为 $\\Delta F=0$。\n- 概率：\n    - 先验概率：$p(x=\\mathrm{L})=p(x=\\mathrm{R})=\\frac{1}{2}$。\n    - 似然（对称误差）：对于 $0<\\varepsilon<\\frac{1}{2}$，$p(y=x\\,|\\,x)=1-\\varepsilon$ 且 $p(y\\neq x\\,|\\,x)=\\varepsilon$。\n- 基本定律：\n    - (i) 从体积（长度）$V_i$ 到 $V_f$ 的可逆等温变化所做的功：$W=-k_B T \\ln(V_f/V_i)$。\n    - (ii) 逐点信息：$i(x,y)=\\ln\\!\\big(p(x,y)/[p(x)p(y)]\\big)$。互信息：$I=\\langle i(x,y)\\rangle$。\n- 任务：\n    1. 计算互信息 $I$ 作为 $\\varepsilon$ 的函数。\n    2. 计算结果平均功 $\\langle W\\rangle$ 作为 $g$ 和 $\\varepsilon$ 的函数。确定使 $\\langle W\\rangle$ 最小化的值 $g^{\\star}$。用 $k_B T$ 和 $\\varepsilon$ 表示 $\\langle W\\rangle_{\\min}$，并将其与 $I$ 进行比较。\n    3. 定义 $\\beta=1/(k_B T)$ 和 $E(g)=\\langle \\exp\\big(-\\beta\\,[W-\\Delta F]-i(x,y)\\big)\\rangle$。计算 $E(g)$。\n\n**步骤2：有效性验证**\n该问题具有科学依据，植根于随机热力学这一成熟领域。它提出了一个带有反馈控制的麦克斯韦妖的标准模型，将热力学功与信息论量联系起来。该设置是一个良构的理论练习，没有矛盾、歧义或伪科学主张。提供的功和信息的公式是标准定义。条件 $\\Delta F=0$ 与一个循环过程一致，在该过程中外部参数返回其初始值。解决该问题所需的所有信息都已提供。\n\n**步骤3：结论**\n问题有效。将提供解答。\n\n**解答推导**\n\n首先，我们必须确定相关的概率分布。\n粒子位置 $x$ 的先验分布已知为 $p(x=\\mathrm{L}) = p(x=\\mathrm{R}) = \\frac{1}{2}$。\n给定 $x$ 时，测量结果 $y$ 的条件概率为 $p(y=x|x) = 1-\\varepsilon$ 和 $p(y \\neq x|x) = \\varepsilon$。\n联合概率分布 $p(x,y) = p(y|x)p(x)$ 为：\n$p(x=\\mathrm{L}, y=\\mathrm{L}) = p(y=\\mathrm{L}|x=\\mathrm{L})p(x=\\mathrm{L}) = (1-\\varepsilon)\\frac{1}{2}$\n$p(x=\\mathrm{L}, y=\\mathrm{R}) = p(y=\\mathrm{R}|x=\\mathrm{L})p(x=\\mathrm{L}) = \\varepsilon\\frac{1}{2}$\n$p(x=\\mathrm{R}, y=\\mathrm{L}) = p(y=\\mathrm{L}|x=\\mathrm{R})p(x=\\mathrm{R}) = \\varepsilon\\frac{1}{2}$\n$p(x=\\mathrm{R}, y=\\mathrm{R}) = p(y=\\mathrm{R}|x=\\mathrm{R})p(x=\\mathrm{R}) = (1-\\varepsilon)\\frac{1}{2}$\n\n结果 $y$ 的边际分布为 $p(y) = \\sum_x p(x,y)$:\n$p(y=\\mathrm{L}) = p(\\mathrm{L},\\mathrm{L}) + p(\\mathrm{R},\\mathrm{L}) = \\frac{1-\\varepsilon}{2} + \\frac{\\varepsilon}{2} = \\frac{1}{2}$\n$p(y=\\mathrm{R}) = p(\\mathrm{L},\\mathrm{R}) + p(\\mathrm{R},\\mathrm{R}) = \\frac{\\varepsilon}{2} + \\frac{1-\\varepsilon}{2} = \\frac{1}{2}$\n由于对称性，测量结果是无偏的。\n\n**任务1：互信息 $I$**\n互信息为 $I = \\langle i(x,y) \\rangle = \\sum_{x,y} p(x,y) \\ln \\frac{p(x,y)}{p(x)p(y)}$。\n这也可以表示为 $I = H(Y) - H(Y|X)$，其中 $H$ 表示熵。\n结果分布的熵为 $H(Y) = -\\sum_y p(y)\\ln p(y) = -(\\frac{1}{2}\\ln\\frac{1}{2} + \\frac{1}{2}\\ln\\frac{1}{2}) = \\ln(2)$。\n条件熵为 $H(Y|X) = -\\sum_{x} p(x) \\sum_y p(y|x)\\ln p(y|x)$。\n对于 $x=\\mathrm{L}$，条件概率为 $p(y=\\mathrm{L}|x=\\mathrm{L}) = 1-\\varepsilon$ 和 $p(y=\\mathrm{R}|x=\\mathrm{L}) = \\varepsilon$。\n对于 $x=\\mathrm{R}$，条件概率为 $p(y=\\mathrm{L}|x=\\mathrm{R}) = \\varepsilon$ 和 $p(y=\\mathrm{R}|x=\\mathrm{R}) = 1-\\varepsilon$。\n给定两个状态的 $p(x)=\\frac{1}{2}$，\n$H(Y|X) = -\\frac{1}{2} \\big( (1-\\varepsilon)\\ln(1-\\varepsilon) + \\varepsilon\\ln(\\varepsilon) \\big) - \\frac{1}{2} \\big( \\varepsilon\\ln(\\varepsilon) + (1-\\varepsilon)\\ln(1-\\varepsilon) \\big)$\n$H(Y|X) = - \\big( (1-\\varepsilon)\\ln(1-\\varepsilon) + \\varepsilon\\ln(\\varepsilon) \\big)$。\n因此，互信息为：\n$$I = \\ln(2) + (1-\\varepsilon)\\ln(1-\\varepsilon) + \\varepsilon\\ln(\\varepsilon)$$\n\n**任务2：平均功 $\\langle W \\rangle$ 及其最小化**\n功 $W(x,y)$ 是在反馈步骤中（即移动隔板时）完成的。粒子被限制在初始长度为 $L/2$ 的单个单元中。\n如果结果是 $y=\\mathrm{L}$，左侧单元的体积从 $V_i=L/2$ 变为 $V_f=gL$，右侧单元的体积从 $V_i=L/2$ 变为 $V_f=(1-g)L$。\n如果粒子在左侧单元（$x=\\mathrm{L}$），功为 $W(\\mathrm{L},\\mathrm{L}) = -k_B T \\ln(\\frac{gL}{L/2}) = -k_B T \\ln(2g)$。\n如果粒子在右侧单元（$x=\\mathrm{R}$），功为 $W(\\mathrm{R},\\mathrm{L}) = -k_B T \\ln(\\frac{(1-g)L}{L/2}) = -k_B T \\ln(2(1-g))$。\n\n如果结果是 $y=\\mathrm{R}$，左侧单元的体积变为 $(1-g)L$，右侧单元的体积变为 $gL$。\n如果粒子在左侧单元（$x=\\mathrm{L}$），功为 $W(\\mathrm{L},\\mathrm{R}) = -k_B T \\ln(\\frac{(1-g)L}{L/2}) = -k_B T \\ln(2(1-g))$。\n如果粒子在右侧单元（$x=\\mathrm{R}$），功为 $W(\\mathrm{R},\\mathrm{R}) = -k_B T \\ln(\\frac{gL}{L/2}) = -k_B T \\ln(2g)$。\n\n平均功为 $\\langle W \\rangle = \\sum_{x,y} p(x,y) W(x,y)$:\n$\\langle W \\rangle = p(\\mathrm{L},\\mathrm{L})W(\\mathrm{L},\\mathrm{L}) + p(\\mathrm{L},\\mathrm{R})W(\\mathrm{L},\\mathrm{R}) + p(\\mathrm{R},\\mathrm{L})W(\\mathrm{R},\\mathrm{L}) + p(\\mathrm{R},\\mathrm{R})W(\\mathrm{R},\\mathrm{R})$\n$\\langle W \\rangle = \\frac{1-\\varepsilon}{2}[-k_B T \\ln(2g)] + \\frac{\\varepsilon}{2}[-k_B T \\ln(2(1-g))] + \\frac{\\varepsilon}{2}[-k_B T \\ln(2(1-g))] + \\frac{1-\\varepsilon}{2}[-k_B T \\ln(2g)]$\n$\\langle W \\rangle = (1-\\varepsilon)[-k_B T \\ln(2g)] + \\varepsilon[-k_B T \\ln(2(1-g))]$\n$\\langle W \\rangle = -k_B T \\big( (1-\\varepsilon)\\ln(2g) + \\varepsilon\\ln(2(1-g)) \\big)$\n$\\langle W \\rangle = -k_B T \\big( (1-\\varepsilon)(\\ln(2)+\\ln(g)) + \\varepsilon(\\ln(2)+\\ln(1-g)) \\big)$\n$\\langle W \\rangle = -k_B T \\big( \\ln(2) + (1-\\varepsilon)\\ln(g) + \\varepsilon\\ln(1-g) \\big)$\n\n为了最小化 $\\langle W(g) \\rangle$，我们必须最大化函数 $f(g) = (1-\\varepsilon)\\ln(g) + \\varepsilon\\ln(1-g)$。\n我们将其对 $g$ 的导数设为零：\n$\\frac{df}{dg} = \\frac{1-\\varepsilon}{g} - \\frac{\\varepsilon}{1-g} = 0 \\implies \\frac{1-\\varepsilon}{g} = \\frac{\\varepsilon}{1-g}$\n$ (1-\\varepsilon)(1-g) = \\varepsilon g \\implies 1-g-\\varepsilon+\\varepsilon g = \\varepsilon g \\implies 1-\\varepsilon = g$.\n最优控制参数为 $g^{\\star} = 1-\\varepsilon$。二阶导数 $\\frac{d^2f}{dg^2} = -\\frac{1-\\varepsilon}{g^2} - \\frac{\\varepsilon}{(1-g)^2} < 0$，证实了 $f(g)$ 存在最大值，因此 $\\langle W \\rangle$ 存在最小值。\n\n将 $g^{\\star}$ 代回 $\\langle W \\rangle$：\n$\\langle W \\rangle_{\\min} = -k_B T \\big( \\ln(2) + (1-\\varepsilon)\\ln(1-\\varepsilon) + \\varepsilon\\ln(1-(1-\\varepsilon)) \\big)$\n$\\langle W \\rangle_{\\min} = -k_B T \\big( \\ln(2) + (1-\\varepsilon)\\ln(1-\\varepsilon) + \\varepsilon\\ln(\\varepsilon) \\big)$\n\n将此与任务1中的互信息进行比较，我们发现：\n$$\\langle W \\rangle_{\\min} = -k_B T I$$\n这个结果表明，通过反馈协议可以从系统中提取的最大平均功 ($-\\langle W \\rangle_{\\min}$) 等于从测量中获取的互信息（通过乘以 $k_B T$ 转换为能量单位）。这是随机热力学中一个更普适原理的具体实例。\n\n**任务3：$E(g)$ 的计算**\n我们被要求计算 $E(g)=\\langle \\exp\\big(-\\beta\\,[W-\\Delta F]-i(x,y)\\big)\\rangle$。\n给定 $\\beta = 1/(k_B T)$ 和 $\\Delta F = 0$，上式简化为 $E(g) = \\langle \\exp(-\\beta W - i(x,y)) \\rangle$。\n平均值是在联合分布 $p(x,y)$ 上求得的：\n$$E(g) = \\sum_{x,y} p(x,y) \\exp(-\\beta W(x,y) - i(x,y))$$\n使用逐点信息的定义 $i(x,y)=\\ln\\frac{p(x,y)}{p(x)p(y)}$，我们可以写出 $\\exp(-i(x,y)) = \\frac{p(x)p(y)}{p(x,y)}$。\n将此代入 $E(g)$ 的表达式中：\n$$E(g) = \\sum_{x,y} p(x,y) \\exp(-\\beta W(x,y)) \\frac{p(x)p(y)}{p(x,y)} = \\sum_{x,y} p(x)p(y) \\exp(-\\beta W(x,y))$$\n这一简化是关键步骤。表达式现在只依赖于边际分布和功函数。\n我们有对所有 $x,y$，$p(x)=\\frac{1}{2}$ 和 $p(y)=\\frac{1}{2}$，所以 $p(x)p(y) = \\frac{1}{4}$。\n功项的指数化为 $\\exp(-\\beta W) = \\exp(\\frac{1}{k_B T} k_B T \\ln(\\frac{V_f}{V_i})) = \\frac{V_f}{V_i}$。\n让我们为这4种情况分别计算 $\\exp(-\\beta W(x,y))$ :\n1. $x=\\mathrm{L}, y=\\mathrm{L}$: $V_i=L/2$, $V_f=gL$. $\\exp(-\\beta W(\\mathrm{L},\\mathrm{L})) = \\frac{gL}{L/2} = 2g$.\n2. $x=\\mathrm{L}, y=\\mathrm{R}$: $V_i=L/2$, $V_f=(1-g)L$. $\\exp(-\\beta W(\\mathrm{L},\\mathrm{R})) = \\frac{(1-g)L}{L/2} = 2(1-g)$.\n3. $x=\\mathrm{R}, y=\\mathrm{L}$: $V_i=L/2$, $V_f=(1-g)L$. $\\exp(-\\beta W(\\mathrm{R},\\mathrm{L})) = \\frac{(1-g)L}{L/2} = 2(1-g)$.\n4. $x=\\mathrm{R}, y=\\mathrm{R}$: $V_i=L/2$, $V_f=gL$. $\\exp(-\\beta W(\\mathrm{R},\\mathrm{R})) = \\frac{gL}{L/2} = 2g$.\n\n现在，我们计算 $E(g)$ 的和：\n$E(g) = p(\\mathrm{L})p(\\mathrm{L})\\exp(-\\beta W(\\mathrm{L},\\mathrm{L})) + p(\\mathrm{L})p(\\mathrm{R})\\exp(-\\beta W(\\mathrm{L},\\mathrm{R})) + p(\\mathrm{R})p(\\mathrm{L})\\exp(-\\beta W(\\mathrm{R},\\mathrm{L})) + p(\\mathrm{R})p(\\mathrm{R})\\exp(-\\beta W(\\mathrm{R},\\mathrm{R}))$\n$E(g) = \\frac{1}{4} (2g) + \\frac{1}{4} (2(1-g)) + \\frac{1}{4} (2(1-g)) + \\frac{1}{4} (2g)$\n$E(g) = \\frac{1}{4} \\big( 2g + 2 - 2g + 2 - 2g + 2g \\big)$\n$E(g) = \\frac{1}{4} (4)$\n$E(g) = 1$.\n\n这个结果是一个纯数，与参数 $g$ 和 $\\varepsilon$ 无关，符合要求。这是带有反馈控制系统的广义 Jarzynski 等式的一种体现，该等式最初由 Sagawa 和 Ueda 推导得出。这个恒等式是非平衡统计力学的一个基本结果。", "answer": "$$\\boxed{1}$$", "id": "2677157"}]}