{"hands_on_practices": [{"introduction": "本节练习将带你深入波包动力学的核心：数值求解含时薛定谔方程。你将亲手实现应用广泛的分裂算符方法，该方法利用快速傅里叶变换来高效地演化波包。此练习特别关注如何将该方法应用于含时势场——这是模拟体系与外场相互作用的关键情况——并要求你量化不同二阶传播方案的数值精度。[@problem_id:2658913]", "problem": "考虑一个质量为 $m$ 的一维粒子在含时势 $V(x,t)$ 中的含时薛定谔方程，该方程以 $\\hbar = 1$ 和 $m = 1$ 的无量纲单位表示：\n$$\n\\mathrm{i}\\,\\frac{\\partial}{\\partial t}\\,\\psi(x,t) \\;=\\; \\left[-\\frac{1}{2}\\frac{\\partial^2}{\\partial x^2} + V(x,t)\\right] \\psi(x,t).\n$$\n您的任务是构建一个程序，使用时间演化算符的两种二阶分解方法（分裂算符法），在均匀空间网格上将一个初始波包演化一个时间步长 $\\Delta t$，并相对于高保真度参考来量化每种方案的单步误差。这两种要实现的方案是：\n\n- 一种对称中点分裂方案，它在中间时刻 $t + \\Delta t/2$ 对势进行采样。\n\n- 一种对称的踢-漂移-踢（KDK）方案，它在初始时刻 $t$ 和最终时刻 $t + \\Delta t$ 对势进行采样。\n\n请使用以下具有物理动机且数值稳定的要素，所有要素均采用相同的无量纲单位：\n\n- 空间网格：一个长度为 $L$ 的周期性区域，用 $N$ 个点进行离散。使用 $N = 512$ 和 $L = 50$。\n\n- 波矢网格：定义与所选 $L$ 和 $N$ 一致的离散傅里叶模式 $k$，并在谱空间中实现动能演化。\n\n- 势：\n$$\nV(x,t) \\;=\\; \\frac{1}{2}\\,\\omega^2\\,x^2 \\;+\\; A\\,x\\,\\cos(\\Omega\\,t),\n$$\n其中 $\\omega$ 是静态谐振频率，$A$ 是驱动振幅，$\\Omega$ 是驱动频率。\n\n- $t_0$ 时刻的初始波包：\n$$\n\\psi(x,t_0) \\;=\\; \\left(\\pi \\sigma^2\\right)^{-1/4} \\exp\\!\\left[-\\frac{(x-x_0)^2}{2\\sigma^2} + \\mathrm{i}\\,p_0\\,(x - x_0)\\right],\n$$\n其中 $x_0 = 0$，$p_0 = 0$，$\\sigma = 1$。确保数值归一化 $\\int |\\psi(x,t_0)|^2\\,dx = 1$ 在网格上成立。\n\n需要实现的两个单步二阶传播子是：\n\n- 中点分裂（对势使用中点时刻 $t+\\Delta t/2$）：\n  1. 在位置空间中乘以 $\\exp\\!\\left[-\\mathrm{i}\\,\\frac{\\Delta t}{2}\\,V(x,\\,t+\\Delta t/2)\\right]$。\n  2. 在傅里叶空间中乘以 $\\exp\\!\\left[-\\mathrm{i}\\,\\Delta t\\,\\frac{k^2}{2}\\right]$（动能步）。\n  3. 在位置空间中乘以 $\\exp\\!\\left[-\\mathrm{i}\\,\\frac{\\Delta t}{2}\\,V(x,\\,t+\\Delta t/2)\\right]$。\n\n- 踢-漂移-踢（对势使用端点时刻 $t$ 和 $t+\\Delta t$）：\n  1. 在位置空间中乘以 $\\exp\\!\\left[-\\mathrm{i}\\,\\frac{\\Delta t}{2}\\,V(x,\\,t)\\right]$。\n  2. 在傅里叶空间中乘以 $\\exp\\!\\left[-\\mathrm{i}\\,\\Delta t\\,\\frac{k^2}{2}\\right]$（动能步）。\n  3. 在位置空间中乘以 $\\exp\\!\\left[-\\mathrm{i}\\,\\frac{\\Delta t}{2}\\,V(x,\\,t+\\Delta t)\\right]$。\n\n作为高保真度的单步参考，通过将区间 $\\Delta t$ 细分为 $n$ 个大小为 $\\delta t = \\Delta t/n$ 的相等子步，并在每个子步应用踢-漂移-踢方案，来近似时间排序指数。为减少残余的二阶子步误差，应用 Richardson 外推法：用 $n$ 和 $2n$ 个子步计算两个参考末态，并按如下方式组合它们：\n$$\n\\psi_{\\mathrm{ref}} \\;\\approx\\; \\frac{4\\,\\psi_{2n} - \\psi_{n}}{3}.\n$$\n在计算误差之前，将 $\\psi_{\\mathrm{ref}}$ 和每个测试方案的输出归一化到单位范数，并通过内积 $\\langle \\psi_{\\mathrm{ref}}\\mid \\psi\\rangle$ 的相位将每个演化后的态 $\\psi$ 对齐到 $\\psi_{\\mathrm{ref}}$，以消除任何全局相位。\n\n将演化态 $\\psi_\\star$ 的单步误差定义为与参考态之差的离散 $L^2$ 范数：\n$$\n\\varepsilon_{\\star} \\;=\\; \\left(\\sum_{j=0}^{N-1} \\left|\\psi_\\star(x_j) - \\psi_{\\mathrm{ref}}(x_j)\\right|^2 \\,\\Delta x\\right)^{1/2}.\n$$\n对于每个测试用例，报告 $\\varepsilon_{\\mathrm{mid}}$、$\\varepsilon_{\\mathrm{KDK}}$ 以及比值 $\\varepsilon_{\\mathrm{mid}}/\\varepsilon_{\\mathrm{KDK}}$。\n\n所有计算均在指定的无量纲单位中进行。角度应以弧度处理。\n\n测试套件：\n使用以下五组参数 $\\{\\Delta t, \\omega, A, \\Omega, t_0\\}$ 来探测典型、静态、快速驱动、大步长和小步长等情形：\n- 用例 1：$\\Delta t = 0.2$, $\\omega = 0.2$, $A = 0.2$, $\\Omega = 1.5$, $t_0 = 0$。\n- 用例 2：$\\Delta t = 0.2$, $\\omega = 0.3$, $A = 0.0$, $\\Omega = 1.0$, $t_0 = 0$。\n- 用例 3：$\\Delta t = 0.2$, $\\omega = 0.2$, $A = 0.5$, $\\Omega = 15.0$, $t_0 = 0$。\n- 用例 4：$\\Delta t = 0.4$, $\\omega = 0.2$, $A = 0.2$, $\\Omega = 2.5$, $t_0 = 0$。\n- 用例 5：$\\Delta t = 0.05$, $\\omega = 0.2$, $A = 1.0$, $\\Omega = 5.0$, $t_0 = 0$。\n\n答案规格与输出格式：\n- 对于每种情况，计算列表 $[\\varepsilon_{\\mathrm{mid}}, \\varepsilon_{\\mathrm{KDK}}, \\varepsilon_{\\mathrm{mid}}/\\varepsilon_{\\mathrm{KDK}}]$。\n- 您的程序应生成单行输出，其中包含所有五种情况的结果，形式为一个以逗号分隔的列表的列表，并用一对单独的方括号括起来。所有数字必须以具有 $10$ 位有效数字的科学记数法打印。例如： \n\"[ [1.2345678900e-03,2.3456789000e-04,5.2631578947e+00], [ ... ], ... ]\"。", "solution": "所提出的问题是计算量子动力学中的一个标准练习，要求为一个具有含时哈密顿量的一维系统实现并比较两种二阶分裂算符方法。该问题具有科学依据、是良定的，并且所有参数和程序都规定得足够清晰，可以得到一个唯一的、可验证的数值解。关于高保真度参考计算的子步数 $n$ 的潜在模糊性，可以通过将任务解释为实现者必须做出合理选择以确保收敛来解决；选择 $n=100$ 是合适的。因此，该问题被认为是有效的，并将构建一个正确的解。\n\n量子态 $\\psi(x,t)$ 的时间演化遵循含时薛定谔方程（TDSE）。在 $\\hbar=1$ 和粒子质量 $m=1$ 的无量纲单位中，该方程为：\n$$\n\\mathrm{i}\\,\\frac{\\partial}{\\partial t}\\,\\psi(x,t) \\;=\\; \\hat{H}(t)\\,\\psi(x,t) \\;=\\; \\left[\\hat{T} + \\hat{V}(x,t)\\right] \\psi(x,t)\n$$\n其中 $\\hat{T} = -\\frac{1}{2}\\frac{\\partial^2}{\\partial x^2}$ 是动能算符，$\\hat{V}(x,t)$ 是含时势能算符。\n\n从 $t$ 到 $t+\\Delta t$ 的单个时间步长的形式解由时间演化算符 $\\hat{U}(t+\\Delta t, t)$ 作用于初始态给出：\n$$\n\\psi(x, t+\\Delta t) = \\hat{U}(t+\\Delta t, t) \\, \\psi(x, t)\n$$\n其中 $\\hat{U}$ 是一个时间排序指数：\n$$\n\\hat{U}(t+\\Delta t, t) = \\mathcal{T} \\exp\\left(-\\mathrm{i} \\int_t^{t+\\Delta t} \\hat{H}(t') dt'\\right)\n$$\n时间排序算符 $\\mathcal{T}$ 是必需的，因为不同时刻的哈密顿量 $\\hat{H}(t')$ 可能不对易，即 $[\\hat{H}(t_1), \\hat{H}(t_2)] \\neq 0$。\n\n对于数值实现，我们采用分裂算符方法。该方法依赖于这样一个事实：虽然 $\\hat{H}(t)$ 是复杂的，但其组成部分 $\\hat{T}$ 和 $\\hat{V}(t)$ 更为简单。动能算符 $\\hat{T}$ 在动量（倒易）空间中是对角的，而势算符 $\\hat{V}(x,t)$ 在位置（实）空间中是对角的。通过快速傅里叶变换（FFT）在这两种表示之间转换，可以高效地应用对应于 $\\hat{T}$ 和 $\\hat{V}(t)$ 的演化算符。\n\n$\\hat{T}$ 和 $\\hat{V}(t)$ 的不对易性意味着 $\\exp(-\\mathrm{i}\\Delta t(\\hat{T} + \\hat{V})) \\neq \\exp(-\\mathrm{i}\\Delta t\\hat{T})\\exp(-\\mathrm{i}\\Delta t\\hat{V})$。Baker-Campbell-Hausdorff (BCH) 公式提供了一种近似组合演化的方法。一种通用的对称二阶分解，即 Strang 分裂，其形式如下：\n$$\n\\exp(-\\mathrm{i}\\Delta t (\\hat{A} + \\hat{B})) = \\exp(-\\mathrm{i}\\frac{\\Delta t}{2}\\hat{A}) \\exp(-\\mathrm{i}\\Delta t \\hat{B}) \\exp(-\\mathrm{i}\\frac{\\Delta t}{2}\\hat{A}) + \\mathcal{O}(\\Delta t^3)\n$$\n对于含时势，我们还必须对时间积分进行近似。两种常见的二阶方案源于不同的近似方法。\n\n**1. 中点分裂方案：**\n该方案使用中点法则来近似积分后的哈密顿量：$\\int_t^{t+\\Delta t} \\hat{H}(t') dt' \\approx \\Delta t \\hat{H}(t+\\Delta t/2)$。将 Strang 分裂应用于此有效哈密顿量，得到传播子：\n$$\n\\hat{U}_{\\mathrm{mid}}(t+\\Delta t, t) \\approx \\exp\\left(-\\mathrm{i}\\frac{\\Delta t}{2}\\hat{V}(x, t+\\frac{\\Delta t}{2})\\right) \\exp\\left(-\\mathrm{i}\\Delta t\\hat{T}\\right) \\exp\\left(-\\mathrm{i}\\frac{\\Delta t}{2}\\hat{V}(x, t+\\frac{\\Delta t}{2})\\right)\n$$\n该方法是对称的，并且通常是鲁棒的。对于单个步长，其精度为 $\\mathcal{O}(\\Delta t^3)$ 阶。\n\n**2. 踢-漂移-踢 (KDK) 方案：**\n该方案可以看作是对演化的势能部分应用梯形法则。它是速度 Verlet 算法的一个变体，其结构为：在起始时刻进行半步势能踢，然后进行整步动能漂移，最后在结束时刻进行另一次半步势能踢：\n$$\n\\hat{U}_{\\mathrm{KDK}}(t+\\Delta t, t) \\approx \\exp\\left(-\\mathrm{i}\\frac{\\Delta t}{2}\\hat{V}(x, t+\\Delta t)\\right) \\exp\\left(-\\mathrm{i}\\Delta t\\hat{T}\\right) \\exp\\left(-\\mathrm{i}\\frac{\\Delta t}{2}\\hat{V}(x, t)\\right)\n$$\n尽管其势能项不对称，但该方法也是二阶精确的。这两种方案的主导误差项不同，尤其是在包含势的二阶时间导数 $\\partial_t^2 \\hat{V}$ 的项的系数上。这导致了不同的性能特征，特别是在势快速变化的情况下。\n\n**数值实现：**\n模拟在长度为 $L=50$ 的周期性空间域上，在一个包含 $N=512$ 个点的网格上执行。网格点为 $x_j = j\\Delta x - L/2$，其中 $j \\in \\{0, \\dots, N-1\\}$，步长为 $\\Delta x = L/N$。用于 FFT 的相应波矢网格为 $k_m = 2\\pi m/L$，其中 $m \\in \\{-N/2, \\dots, N/2-1\\}$，这可以方便地由 `numpy.fft.fftfreq` 生成。\n\n初始态是一个高斯波包，必须在网格上进行数值归一化：$\\psi' = \\psi / \\sqrt{\\sum_j |\\psi(x_j)|^2 \\Delta x}$。\n\n对于一个通用的对称传播子 $\\hat{U} \\approx e^{-\\mathrm{i}\\tau \\hat{V}_B}e^{-\\mathrm{i}\\Delta t \\hat{T}}e^{-\\mathrm{i}\\tau \\hat{V}_A}$，演化步骤如下：\n1. 在位置空间中应用第一个势算符：$\\psi'(x) = \\exp(-\\mathrm{i}\\tau V_A(x)) \\psi(x)$。\n2. 使用 FFT 变换到动量空间：$\\tilde{\\psi}'(k) = \\mathcal{F}[\\psi'(x)]$。\n3. 在动量空间中应用动能算符：$\\tilde{\\psi}''(k) = \\exp(-\\mathrm{i}\\Delta t k^2/2) \\tilde{\\psi}'(k)$。\n4. 使用逆 FFT 变换回位置空间：$\\psi''(x) = \\mathcal{F}^{-1}[\\tilde{\\psi}''(k)]$。\n5. 应用第二个势算符：$\\psi_{\\text{final}}(x) = \\exp(-\\mathrm{i}\\tau V_B(x)) \\psi''(x)$。\n\n**高保真度参考与误差计算：**\n使用 Richardson 外推法生成单个步长 $\\Delta t$ 的高精度参考解。由于 KDK 方案的单步误差为 $\\mathcal{O}(\\delta t^3)$，在固定区间上的全局误差为 $\\mathcal{O}(\\delta t^2)$，因此我们可以消除主导误差项。我们通过采用 $n$ 个大小为 $\\delta t_n = \\Delta t/n$ 的小步长来计算末态 $\\psi_n$，并采用 $2n$ 个大小为 $\\delta t_{2n} = \\Delta t/(2n)$ 的步长来计算末态 $\\psi_{2n}$。外推得到的高阶结果为：\n$$\n\\psi_{\\mathrm{ref}} = \\frac{4\\psi_{2n} - \\psi_n}{3}\n$$\n该结果的全局误差为 $\\mathcal{O}(\\delta t^4)$。我们将使用 $n=100$。\n\n在误差计算之前，所有演化后的波函数（$\\psi_{\\mathrm{mid}}$、$\\psi_{\\mathrm{KDK}}$）和参考波函数（$\\psi_{\\mathrm{ref}}$）都在数值上重新归一化为1。为了在不受任意全局相位影响的情况下比较它们，每个测试态 $\\psi_\\star$ 都通过乘以一个相位因子 $e^{-\\mathrm{i}\\phi}$ 与参考态对齐，其中 $\\phi = \\arg(\\langle \\psi_{\\mathrm{ref}} | \\psi_\\star \\rangle)$。这会最大化它们的交叠。\n\n误差则为与参考态之差的离散 $L^2$ 范数：\n$$\n\\varepsilon_{\\star} = \\sqrt{ \\sum_{j=0}^{N-1} |\\psi'_\\star(x_j) - \\psi_{\\mathrm{ref}}(x_j)|^2 \\Delta x }\n$$\n其中 $\\psi'_\\star$ 是归一化并进行了相位校准的态。\n\n对于静态情况（$A=0$），势不依赖于时间。中点分裂方案和 KDK 方案均等同于不含时哈密顿量的标准 Strang 分裂，因为 $V(x,t) = V(x,t+\\Delta t/2) = V(x, t+\\Delta t)$。因此，它们的单步误差应该相同，其比值应为 $1$。这可作为对实现的关键验证。对于含时势，特别是对于高驱动频率 $\\Omega$ 的情况，涉及 $V$ 的时间导数的误差项变得显著，两种方案的性能预计会产生差异。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the quantum dynamics problem specified, comparing two second-order\n    split-operator methods for a time-dependent potential.\n    \"\"\"\n    \n    # --- Physical and numerical constants ---\n    N = 512  # Number of spatial grid points\n    L = 50.0 # Length of the periodic spatial domain\n    \n    # --- Grid setup ---\n    dx = L / N\n    x = np.linspace(-L / 2, L / 2, N, endpoint=False)\n    k = 2 * np.pi * np.fft.fftfreq(N, d=dx)\n    \n    # --- Test cases ---\n    # {Δt, ω, A, Ω, t₀}\n    test_cases = [\n        (0.2, 0.2, 0.2, 1.5, 0.0), # Case 1: Typical\n        (0.2, 0.3, 0.0, 1.0, 0.0), # Case 2: Static\n        (0.2, 0.2, 0.5, 15.0, 0.0),# Case 3: Rapidly driven\n        (0.4, 0.2, 0.2, 2.5, 0.0), # Case 4: Large step\n        (0.05, 0.2, 1.0, 5.0, 0.0),# Case 5: Small step\n    ]\n\n    results = []\n\n    def get_potential(t, omega, A, Omega):\n        return 0.5 * omega**2 * x**2 + A * x * np.cos(Omega * t)\n\n    def get_initial_state(x0, p0, sigma):\n        psi = (np.pi * sigma**2)**(-0.25) * np.exp(\n            -(x - x0)**2 / (2 * sigma**2) + 1j * p0 * (x - x0)\n        )\n        # Numerical normalization\n        norm = np.sqrt(np.sum(np.abs(psi)**2) * dx)\n        return psi / norm\n\n    def kdk_step(psi_in, t_start, dt, omega, A, Omega, T_op):\n        # Kick-Drift-Kick step\n        V_start = get_potential(t_start, omega, A, Omega)\n        V_end = get_potential(t_start + dt, omega, A, Omega)\n\n        V_op_start = np.exp(-1j * dt / 2.0 * V_start)\n        V_op_end = np.exp(-1j * dt / 2.0 * V_end)\n\n        psi_half = V_op_start * psi_in\n        psi_k = np.fft.fft(psi_half)\n        psi_k_evolved = T_op * psi_k\n        psi_evolved_half = np.fft.ifft(psi_k_evolved)\n        \n        return V_op_end * psi_evolved_half\n\n    for case in test_cases:\n        dt, omega, A, Omega, t0 = case\n        \n        # --- Initial State ---\n        psi0 = get_initial_state(x0=0.0, p0=0.0, sigma=1.0)\n        \n        # --- Propagators ---\n        # Kinetic energy operator for the full step dt\n        T_op_full_step = np.exp(-1j * dt * k**2 / 2.0)\n        \n        # 1. Midpoint Split Scheme\n        V_mid = get_potential(t0 + dt / 2.0, omega, A, Omega)\n        V_op_mid = np.exp(-1j * dt / 2.0 * V_mid)\n        \n        psi_mid_half = V_op_mid * psi0\n        psi_mid_k = np.fft.fft(psi_mid_half)\n        psi_mid_k_evolved = T_op_full_step * psi_mid_k\n        psi_mid_evolved_half = np.fft.ifft(psi_mid_k_evolved)\n        psi_mid = V_op_mid * psi_mid_evolved_half\n\n        # 2. Kick-Drift-Kick (KDK) Scheme\n        V_t0 = get_potential(t0, omega, A, Omega)\n        V_t1 = get_potential(t0 + dt, omega, A, Omega)\n        V_op_t0 = np.exp(-1j * dt / 2.0 * V_t0)\n        V_op_t1 = np.exp(-1j * dt / 2.0 * V_t1)\n        \n        psi_kdk_half = V_op_t0 * psi0\n        psi_kdk_k = np.fft.fft(psi_kdk_half)\n        psi_kdk_k_evolved = T_op_full_step * psi_kdk_k\n        psi_kdk_evolved_half = np.fft.ifft(psi_kdk_k_evolved)\n        psi_kdk = V_op_t1 * psi_kdk_evolved_half\n\n        # 3. High-Fidelity Reference using Richardson Extrapolation\n        n = 100\n        \n        # Propagate with n steps\n        psi_n = psi0.copy()\n        dt_n = dt / n\n        T_op_n = np.exp(-1j * dt_n * k**2 / 2.0)\n        for i in range(n):\n            t_current = t0 + i * dt_n\n            psi_n = kdk_step(psi_n, t_current, dt_n, omega, A, Omega, T_op_n)\n\n        # Propagate with 2n steps\n        psi_2n = psi0.copy()\n        dt_2n = dt / (2 * n)\n        T_op_2n = np.exp(-1j * dt_2n * k**2 / 2.0)\n        for i in range(2 * n):\n            t_current = t0 + i * dt_2n\n            psi_2n = kdk_step(psi_2n, t_current, dt_2n, omega, A, Omega, T_op_2n)\n            \n        psi_ref_unnorm = (4.0 * psi_2n - psi_n) / 3.0\n\n        # --- Error Calculation ---\n        # Normalize all resulting wavefunctions\n        norm_mid = np.sqrt(np.sum(np.abs(psi_mid)**2) * dx)\n        psi_mid_norm = psi_mid / norm_mid\n        \n        norm_kdk = np.sqrt(np.sum(np.abs(psi_kdk)**2) * dx)\n        psi_kdk_norm = psi_kdk / norm_kdk\n        \n        norm_ref = np.sqrt(np.sum(np.abs(psi_ref_unnorm)**2) * dx)\n        psi_ref = psi_ref_unnorm / norm_ref\n\n        # Phase alignment and error computation\n        states_to_test = {'mid': psi_mid_norm, 'kdk': psi_kdk_norm}\n        errors = {}\n\n        for key, psi_star in states_to_test.items():\n            overlap = np.sum(np.conj(psi_ref) * psi_star) * dx\n            phase_factor = np.conj(overlap) / np.abs(overlap)\n            psi_star_aligned = psi_star * phase_factor\n            \n            error = np.sqrt(np.sum(np.abs(psi_star_aligned - psi_ref)**2) * dx)\n            errors[key] = error\n        \n        err_mid = errors['mid']\n        err_kdk = errors['kdk']\n        ratio = err_mid / err_kdk if err_kdk != 0 else float('inf')\n\n        results.append([err_mid, err_kdk, ratio])\n\n    # --- Format and Print Output ---\n    output_str = \", \".join(\n        f\"[{res[0]:.10e}, {res[1]:.10e}, {res[2]:.10e}]\" for res in results\n    )\n    print(f\"[{output_str}]\")\n\nsolve()\n\n```", "id": "2658913"}, {"introduction": "现在，我们将注意力转向路径积分模拟的实践层面。在计算中，路径积分由一个具有有限珠子数 $P$ 的“环状聚合物”来近似，这不可避免地引入了特罗特 (Trotter) 离散化误差。本练习旨在让你分析此误差随 $P$ 的标度行为，并应用强大的理查森外推法 (Richardson extrapolation) 来系统地消除主要的误差项，从而加速模拟结果向精确量子极限的收敛。[@problem_id:2658892]", "problem": "考虑一个质量为 $m$ 的一维量子粒子，在逆温度为 $\\beta$ 时处于非谐势 $V(x)=\\tfrac{1}{2} m \\omega^{2} x^{2}+\\alpha x^{4}$ 中。其势能的精确量子热平均值为 $\\langle V\\rangle=\\operatorname{Tr}\\left(\\hat{\\rho}_{\\beta}\\,\\hat{V}\\right)$，其中 $\\hat{\\rho}_{\\beta}=e^{-\\beta \\hat{H}}/Z$ 且 $\\hat{H}=\\hat{T}+\\hat{V}$。在标准的虚时路径积分表示中，我们使用二阶Trotter分解，通过具有 $P$ 个复制（“珠子”）的环状聚合物离散化来近似 $e^{-\\beta \\hat{H}}$，并通过对从环状聚合物分布中抽样的 $V$ 进行珠子平均来估计 $\\langle V\\rangle$；将此估计量记为 $\\langle V\\rangle_{P}$。假设 $V(x)$ 足够光滑，使得 Baker–Campbell–Hausdorff 展开所需的所有对易子都存在且有界，并考虑在固定的 $\\beta$下，$P\\to\\infty$ 的情况。\n\n关于 $\\langle V\\rangle_{P}$ 中的有限珠子数偏差以及一种实用的 $P\\to\\infty$ 外推策略，以下哪些陈述是正确的？\n\nA. 对于原始二阶Trotter分解，在固定的 $\\beta$ 下，偏差 $\\delta_{P}=\\langle V\\rangle_{P}-\\langle V\\rangle$ 的标度为 $O\\!\\left(P^{-1}\\right)$。因此，一个关于 $1/P$ 呈线性的两点 Richardson 外推 $\\langle V\\rangle_{\\infty}\\approx \\langle V\\rangle_{2P}+\\left(\\langle V\\rangle_{2P}-\\langle V\\rangle_{P}\\right)$ 是渐近无偏的。\n\nB. 对于原始二阶Trotter分解，在固定的 $\\beta$ 下，偏差 $\\delta_{P}=\\langle V\\rangle_{P}-\\langle V\\rangle$ 的标度为 $O\\!\\left(P^{-2}\\right)$。因此，一个关于 $1/P^{2}$ 呈线性的两点 Richardson 外推\n$\\langle V\\rangle_{\\infty}\\approx \\langle V\\rangle_{2P}+\\dfrac{\\langle V\\rangle_{2P}-\\langle V\\rangle_{P}}{2^{2}-1}=\\langle V\\rangle_{2P}+\\dfrac{\\langle V\\rangle_{2P}-\\langle V\\rangle_{P}}{3}$ 是渐近无偏的。\n\nC. 对于任何凸的非谐势 $V(x)$，$\\langle V\\rangle_{P}$ 中主导偏差项的系数总是正的，这意味着对所有 $P$ 都有 $\\langle V\\rangle_{P}\\ge \\langle V\\rangle$，所以 $\\langle V\\rangle_{P}$ 是一个关于 $P$ 的单调递减序列，因此不需要外推。\n\nD. 如果采用 Takahashi–Imada (TI) 高阶分解，即使用一个包含了基于 $[V,[T,V]]$ 的对易子修正的有效势进行抽样，并对 $V$ 使用一致的对角估计量，那么在固定的 $\\beta$ 下，$\\langle V\\rangle_{P}$ 中的主导偏差标度为 $O\\!\\left(P^{-4}\\right)$。因此，一个关于 $1/P^{4}$ 呈线性的两点 Richardson 外推\n$\\langle V\\rangle_{\\infty}\\approx \\langle V\\rangle_{2P}+\\dfrac{\\langle V\\rangle_{2P}-\\langle V\\rangle_{P}}{2^{4}-1}=\\langle V\\rangle_{2P}+\\dfrac{\\langle V\\rangle_{2P}-\\langle V\\rangle_{P}}{15}$ 是渐近无偏且更高效的。\n\nE. 对于任何非谐势，使用质心维里估计量来计算势能可以消除所有的 Trotter 离散化偏差，从而对任何有限的 $P$ 都有 $\\langle V\\rangle_{P}=\\langle V\\rangle$。\n\n选择所有适用项。", "solution": "问题陈述描述了如何使用具有有限数量珠子 $P$ 的虚时路径积分形式，计算一维粒子在非谐势中势能的热期望值 $\\langle V \\rangle$。问题的核心在于分析由玻尔兹曼算符 $e^{-\\beta \\hat{H}}$ 的二阶 Trotter 分解所引起的离散化误差或偏差 $\\delta_{P}=\\langle V\\rangle_{P}-\\langle V\\rangle$。\n\n首先，我们建立理论基础。精确的量子统计配分函数是 $Z = \\operatorname{Tr}(e^{-\\beta \\hat{H}})$，其中哈密顿量为 $\\hat{H} = \\hat{T} + \\hat{V}$，动能为 $\\hat{T}=\\hat{p}^2/(2m)$，势能为 $\\hat{V}=V(\\hat{x})$。势能的期望值为 $\\langle V \\rangle = \\operatorname{Tr}(\\hat{V} e^{-\\beta \\hat{H}}) / Z$。\n\n在路径积分表述中，玻尔兹曼算符 $e^{-\\beta \\hat{H}}$ 被离散化为 $P$ 个小的虚时间步长 $\\tau = \\beta/P$。问题指定了使用对称的二阶 Trotter 分解：\n$$e^{-\\tau \\hat{H}} \\approx e^{-\\tau \\hat{V}/2} e^{-\\tau \\hat{T}} e^{-\\tau \\hat{V}/2}$$\n完整算符的近似为 $(e^{-\\tau \\hat{V}/2} e^{-\\tau \\hat{T}} e^{-\\tau \\hat{V}/2})^P$。这为离散化系统定义了一个有效哈密顿量，其性质在 $P \\to \\infty$ 时收敛到精确的量子系统。\n\n问题指出，$\\langle V \\rangle$ 是通过对 $V$ 进行珠子平均来估计的，这是一种原始或对角估计量：\n$$\\langle V \\rangle_P = \\left\\langle \\frac{1}{P} \\sum_{j=1}^P V(x_j) \\right\\rangle_P$$\n其中平均值 $\\langle \\dots \\rangle_P$ 是在对应于从二阶 Trotter 公式导出的离散化环状聚合物作用量的玻尔兹曼分布上进行的。\n\n对于使用有限数量的珠子 $P$ 计算的算符期望值，其误差或偏差 $\\delta_P = \\langle V \\rangle_P - \\langle V \\rangle$ 可以通过 Baker-Campbell-Hausdorff 展开或路径积分误差分析得出。对于一个仅依赖于位置的一般算符 $\\hat{A} = A(\\hat{x})$，使用原始估计量和二阶 Trotter 方案计算其期望值，其主导阶误差由下式给出：\n$$\\langle A \\rangle_P - \\langle A \\rangle = -\\frac{\\beta^2 \\hbar^2}{24 m P^2} \\left\\langle \\frac{dA}{dx} \\frac{dV}{dx} \\right\\rangle + O(P^{-4})$$\n在我们的具体案例中，我们感兴趣的算符是势能本身，即 $\\hat{A} = \\hat{V}$。因此，我们有 $A(x) = V(x)$ 和 $dA/dx = V'(x)$。势能估计量的偏差为：\n$$\\delta_P = \\langle V \\rangle_P - \\langle V \\rangle = -\\frac{\\beta^2 \\hbar^2}{24 m P^2} \\langle (V'(x))^2 \\rangle + O(P^{-4})$$\n这个基本结果展示了两个关键性质：\n1.  主导误差项随 $P$ 的标度为 $O(P^{-2})$。\n2.  $P^{-2}$ 项的系数是负的，因为 $\\beta$、$\\hbar$、$m$ 是正常数，且期望值 $\\langle (V'(x))^2 \\rangle$ 必须是非负的（对于任何非平凡的势和物理态，该值是严格为正的）。\n\n这种误差标度行为意味着，对于大的 $P$，期望值可以写成一个关于 $1/P^2$ 的展开式：\n$$\\langle V \\rangle_P = \\langle V \\rangle_\\infty + \\frac{c_2}{P^2} + \\frac{c_4}{P^4} + \\dots$$\n其中 $\\langle V \\rangle_\\infty$ 是精确的量子值 $\\langle V \\rangle$。这种规则的误差展开允许使用 Richardson 外推来加速向 $P \\to \\infty$ 极限的收敛。对于一个以 $P^{-2}$ 幂次展开的误差级数，使用 $P$ 和 $2P$ 个珠子的模拟结果进行两点外推的公式为：\n$$A_\\infty \\approx A_{2P} + \\frac{A_{2P}-A_P}{2^n-1}$$\n其中 $n=2$ 是主导误差项的阶数。\n\n基于此，我们评估每个陈述。\n\n**A. 对于原始二阶Trotter分解，偏差 $\\delta_{P}=\\langle V\\rangle_{P}-\\langle V\\rangle$ 的标度为 $O\\!\\left(P^{-1}\\right)$ 在固定的 $\\beta$ 下。因此，一个关于 $1/P$ 呈线性的两点 Richardson 外推 $\\langle V\\rangle_{\\infty}\\approx \\langle V\\rangle_{2P}+\\left(\\langle V\\rangle_{2P}-\\langle V\\rangle_{P}\\right)$ 是渐近无偏的。**\n该陈述**不正确**。如上推导，对于二阶 Trotter 分解，偏差的标度为 $O(P^{-2})$，而不是 $O(P^{-1})$。$O(P^{-1})$ 的标度行为是一阶（原始）Trotter 分解 $e^{-\\tau\\hat{H}} \\approx e^{-\\tau\\hat{T}}e^{-\\tau\\hat{V}}$ 的特征。虽然给定的外推公式对于 $O(P^{-1})$ 误差是正确的，但对于指定的方法，其标度行为的前提是错误的。\n\n**B. 对于原始二阶Trotter分解，偏差 $\\delta_{P}=\\langle V\\rangle_{P}-\\langle V\\rangle$ 的标度为 $O\\!\\left(P^{-2}\\right)$ 在固定的 $\\beta$ 下。因此，一个关于 $1/P^{2}$ 呈线性的两点 Richardson 外推\n$\\langle V\\rangle_{\\infty}\\approx \\langle V\\rangle_{2P}+\\dfrac{\\langle V\\rangle_{2P}-\\langle V\\rangle_{P}}{2^{2}-1}=\\langle V\\rangle_{2P}+\\dfrac{\\langle V\\rangle_{2P}-\\langle V\\rangle_{P}}{3}$ 是渐近无偏的。**\n该陈述**正确**。如我们所示，偏差的标度确实是 $O(P^{-2})$。对于阶数 $n=2$ 的误差，Richardson 外推公式为 $\\langle V \\rangle_\\infty \\approx \\langle V \\rangle_{2P} + (\\langle V \\rangle_{2P} - \\langle V \\rangle_{P})/(2^2-1)$，这可以简化为给定的表达式。误差的标度行为和外推公式都是正确的。\n\n**C. 对于任何凸的非谐势 $V(x)$，$\\langle V\\rangle_{P}$ 中主导偏差项的系数总是正的，这意味着对所有 $P$ 都有 $\\langle V\\rangle_{P}\\ge \\langle V\\rangle$，所以 $\\langle V\\rangle_{P}$ 是一个关于 $P$ 的单调递减序列，因此不需要外推。**\n该陈述**不正确**。主导偏差项的系数与 $-\\langle (V'(x))^2 \\rangle$ 成正比。由于 $\\langle (V'(x))^2 \\rangle > 0$，该系数总是*负的*。这意味着对于大的 $P$，有 $\\langle V \\rangle_P \\le \\langle V \\rangle$，并且序列 $\\langle V\\rangle_P$ 从下方趋近于精确结果，即它是一个关于 $P$ 的单调*递增*序列。此外，即使它是一个单调序列，外推仍然是一种非常有价值且标准的技术，用以从有限 $P$ 的计算中获得对 $P\\to\\infty$ 极限更准确的估计。\n\n**D. 如果采用 Takahashi–Imada (TI) 高阶分解，即使用一个包含了基于 $[V,[T,V]]$ 的对易子修正的有效势进行抽样，并对 $V$ 使用一致的对角估计量，那么在固定的 $\\beta$ 下，$\\langle V\\rangle_{P}$ 中的主导偏差标度为 $O\\!\\left(P^{-4}\\right)$。因此，一个关于 $1/P^{4}$ 呈线性的两点 Richardson 外推\n$\\langle V\\rangle_{\\infty}\\approx \\langle V\\rangle_{2P}+\\dfrac{\\langle V\\rangle_{2P}-\\langle V\\rangle_{P}}{2^{4}-1}=\\langle V\\rangle_{2P}+\\dfrac{\\langle V\\rangle_{2P}-\\langle V\\rangle_{P}}{15}$ 是渐近无偏且更高效的。**\n该陈述**正确**。Takahashi-Imada 分解是一种著名的高阶方法，专门用于消除路径积分中的 $O(P^{-2})$ 误差项。它通过引入一个包含与 $(V'(x))^2$ 成正比的修正项的修正势来实现这一点。当从这个修正势产生的分布中抽样，并对原始势能使用一致的估计量时，期望值的误差确实标度为 $O(P^{-4})$。对于阶数 $n=4$ 的误差，相应的 Richardson 外推公式需要一个分母 $2^4-1=15$，这与提供的公式相符。这种更快的收敛速度使得计算效率显著提高，因为可以用更小的 $P$ 达到更高的精度。\n\n**E. 使用质心维里估计量来计算势能可以消除所有的 Trotter 离散化偏差，对于任何非谐势，从而对任何有限的 $P$ 都有 $\\langle V\\rangle_{P}=\\langle V\\rangle$。**\n该陈述**不正确**。这种说法过于绝对了。虽然在*谐*势中，某些可观测量的特定估计量可能没有离散化误差（因为谐振子路径积分可以精确求解），但对于像本题这样的一般*非谐*势，这并不成立。Trotter 离散化是一种近似，对于一般势，有限 $P$ 的计算总会存在一个残余误差，这个误差只有在 $P \\to \\infty$ 的极限下才会消失。没有任何已知的势能估计量能够在有限 $P$ 的情况下消除*任何*非谐势的这种误差。质心维里估计量是一个强大的工具，尤其是在计算动能时，但对于一般非谐系统中的势能，它并不具备如此神奇的性质。", "answer": "$$\\boxed{BD}$$", "id": "2658892"}]}