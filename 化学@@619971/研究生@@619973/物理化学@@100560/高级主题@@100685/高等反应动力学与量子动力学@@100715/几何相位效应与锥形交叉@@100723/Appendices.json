{"hands_on_practices": [{"introduction": "我们从振动耦合理论的基石——$E \\otimes e$ Jahn-Teller 模型开始。这项练习要求您完成一项基础性的理论推导，通过对角化模型哈密顿量，您不仅将亲眼见到著名的“墨西哥帽”势能面，还将解析地计算出环绕圆锥交叉点时产生的 $\\pi$ 几何相位。这个练习旨在让您从第一性原理出发，牢固掌握该量子效应的数学本源。[@problem_id:2642890]", "problem": "一个对称性为 $E$ 的双重简并电子态与一个对称性为 $e$ 的双重简并振动模式发生线性耦合，在非绝热电子基下，通过一个标准的雅恩-泰勒（Jahn–Teller, JT）类型的线性振动耦合哈密顿量来对其高对称性几何构型附近进行建模。在玻恩-奥本海默（Born–Oppenheimer, BO）框架下，绝热势能面是通过求解固定原子核坐标时电子哈密顿量的本征值得出的。考虑以下双模 $E \\otimes e$ JT哈密顿量（由于仅需求解势能面，因此忽略原子核动能项）：\n$$\nH(Q_1,Q_2) \\;=\\; \\frac{1}{2}\\,k\\,(Q_1^{2}+Q_2^{2})\\,\\mathbb{I}\n\\;+\\;\n\\begin{pmatrix}\nV\\,Q_1 & V\\,Q_2\\\\\nV\\,Q_2 & -V\\,Q_1\n\\end{pmatrix},\n$$\n其中 $Q_1$ 和 $Q_2$ 是 $e$ 模式的质量加权简正坐标，$k>0$ 是一个有效力常数，$V>0$ 是一个线性振动耦合常数，$\\mathbb{I}$ 是 $2\\times 2$ 单位矩阵。\n\n任务：\n- 引入极坐标 $Q_1=r\\cos\\phi$ 和 $Q_2=r\\sin\\phi$，其中 $r\\ge 0$ 且 $0\\le \\phi<2\\pi$，并用$r$和$\\phi$重写哈密顿量。\n- 仅使用玻恩-奥本海默分离原理和标准矩阵对角化方法，推导两个绝热势能面 $E_{+}(r)$ 和 $E_{-}(r)$ 作为 $r$ 的显式函数。\n- 识别并论证在原点 $r=0$ 处存在一个锥形交叉点。\n- 对于较低的绝热电子态 $\\lvert \\chi_{-}(\\phi)\\rangle$（选择为在 $0<\\phi<2\\pi$ 上实值且连续），使用几何（贝里）相位 $\\gamma = i\\oint \\langle \\chi_{-}(\\phi)\\rvert \\partial_{\\phi} \\chi_{-}(\\phi)\\rangle\\, d\\phi$ 的定义，并结合在 $\\phi=2\\pi$ 处的适当修补，计算在固定 $r>0$ 时绕锥形交叉点逆时针一周所累积的几何相位。将此角度以弧度表示。\n\n将你的最终答案表示为有序三元组 $\\big(E_{+}(r),\\,E_{-}(r),\\,\\gamma\\big)$。无需进行数值代入；请提供精确的符号表达式。如果出现角度，请以弧度表示。", "solution": "首先必须验证问题陈述的科学合理性、完整性和客观性。\n\n第1步：提取已知条件\n-   给出的双模 $E \\otimes e$ 雅恩-泰勒哈密顿量为：\n    $$\n    H(Q_1,Q_2) \\;=\\; \\frac{1}{2}\\,k\\,(Q_1^{2}+Q_2^{2})\\,\\mathbb{I}\n    \\;+\\;\n    \\begin{pmatrix}\n    V\\,Q_1 & V\\,Q_2\\\\\n    V\\,Q_2 & -V\\,Q_1\n    \\end{pmatrix}\n    $$\n-   $Q_1$ 和 $Q_2$ 是质量加权简正坐标。\n-   $k > 0$ 是一个有效力常数。\n-   $V > 0$ 是一个线性振动耦合常数。\n-   $\\mathbb{I}$ 是 $2 \\times 2$ 单位矩阵。\n-   指定了向极坐标的变换：$Q_1 = r\\cos\\phi$ 和 $Q_2 = r\\sin\\phi$，其中 $r \\ge 0$ 且 $0 \\le \\phi < 2\\pi$。\n-   给出了几何相位的定义：$\\gamma = i\\oint \\langle \\chi_{-}(\\phi)\\rvert \\partial_{\\phi} \\chi_{-}(\\phi)\\rangle\\, d\\phi$。\n-   较低的绝热电子态 $\\lvert \\chi_{-}(\\phi)\\rangle$ 被选择为在 $0 < \\phi < 2\\pi$ 上实值且连续。\n-   几何相位的环路是在固定 $r > 0$ 下的逆时针方向。\n\n第2步：使用提取的已知条件进行验证\n-   **科学依据**：该问题描述了线性的 $E \\otimes e$ 雅恩-泰勒效应，这是分子物理和物理化学的基石。该哈密顿量是用于描述电子简并系统中振动耦合的标准模型。玻恩-奥本海默势能面、锥形交叉点和几何（贝里）相位等概念都是基本且已确立的原理。该问题具有科学严谨性。\n-   **适定性**：这些任务是明确定义的数学运算：变量替换、矩阵对角化和线积分求值。所有必要的参数和定义（$H$、$k$、$V$、$\\gamma$）都已提供，确保可以推导出唯一且有意义的解。\n-   **客观性**：该问题是用精确且无歧义的数学和理论物理语言表述的。没有主观陈述或意见。\n\n第3步：结论与行动\n问题有效。它科学合理、适定且客观。将提供完整的解答。\n\n**解答推导**\n\n问题要求对所提供的雅恩-泰勒哈密顿量进行系统分析。\n\n**1. 极坐标中的哈密顿量**\n\n第一个任务是将哈密顿量用极坐标 $r$ 和 $\\phi$ 表示。我们将 $Q_1 = r\\cos\\phi$ 和 $Q_2 = r\\sin\\phi$ 代入给定的 $H(Q_1, Q_2)$ 表达式中。\n谐振项变为 $\\frac{1}{2}k(Q_1^2 + Q_2^2) = \\frac{1}{2}k(r^2\\cos^2\\phi + r^2\\sin^2\\phi) = \\frac{1}{2}kr^2$。\n耦合矩阵变为：\n$$\n\\begin{pmatrix}\nV\\,Q_1 & V\\,Q_2 \\\\\nV\\,Q_2 & -V\\,Q_1\n\\end{pmatrix}\n= V\n\\begin{pmatrix}\nr\\cos\\phi & r\\sin\\phi \\\\\nr\\sin\\phi & -r\\cos\\phi\n\\end{pmatrix}\n= V r\n\\begin{pmatrix}\n\\cos\\phi & \\sin\\phi \\\\\n\\sin\\phi & -\\cos\\phi\n\\end{pmatrix}\n$$\n结合这些项，极坐标下的完整哈密顿量为：\n$$\nH(r, \\phi) = \\frac{1}{2}kr^2\\mathbb{I} + V r \\begin{pmatrix} \\cos\\phi & \\sin\\phi \\\\ \\sin\\phi & -\\cos\\phi \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{2}kr^2 + Vr\\cos\\phi & Vr\\sin\\phi \\\\ Vr\\sin\\phi & \\frac{1}{2}kr^2 - Vr\\cos\\phi \\end{pmatrix}\n$$\n\n**2. 绝热势能面**\n\n绝热势能面，记为 $E_{\\pm}(r)$，是哈密顿矩阵 $H(r, \\phi)$ 的本征值。我们通过求解特征方程 $\\det(H - E\\mathbb{I}) = 0$ 来找到本征值。\n$$\n\\left| \\begin{array}{cc} \\frac{1}{2}kr^2 + Vr\\cos\\phi - E & Vr\\sin\\phi \\\\ Vr\\sin\\phi & \\frac{1}{2}kr^2 - Vr\\cos\\phi - E \\end{array} \\right| = 0\n$$\n让我们定义一个平移的本征值 $E' = E - \\frac{1}{2}kr^2$。方程简化为：\n$$\n\\left| \\begin{array}{cc} Vr\\cos\\phi - E' & Vr\\sin\\phi \\\\ Vr\\sin\\phi & -Vr\\cos\\phi - E' \\end{array} \\right| = 0\n$$\n$$\n(Vr\\cos\\phi - E')(-Vr\\cos\\phi - E') - (Vr\\sin\\phi)^2 = 0\n$$\n$$\n-(E')^2 - (Vr\\cos\\phi)^2 - (Vr\\sin\\phi)^2 = 0\n$$\n$$\n-(E')^2 - V^2r^2(\\cos^2\\phi + \\sin^2\\phi) = 0\n$$\n$$\n(E')^2 = V^2r^2 \\implies E' = \\pm Vr\n$$\n将 $E' = E - \\frac{1}{2}kr^2$ 代回，我们找到本征值：\n$$\nE = \\frac{1}{2}kr^2 \\pm Vr\n$$\n这两个就是绝热势能面。它们仅依赖于 $r$，而不依赖于 $\\phi$，这是 $E \\otimes e$ 雅恩-泰勒效应的一个特征。较高和较低的势能面是：\n$$\nE_{+}(r) = \\frac{1}{2}kr^2 + Vr\n$$\n$$\nE_{-}(r) = \\frac{1}{2}kr^2 - Vr\n$$\n\n**3. 锥形交叉点**\n\n锥形交叉点是原子核坐标空间中的一个点，在该点上两个或多个势能面发生简并。从推导出的 $E_{+}(r)$ 和 $E_{-}(r)$ 的表达式来看：\n两个势能面之间的能量差为 $\\Delta E(r) = E_{+}(r) - E_{-}(r) = 2Vr$。\n势能面发生简并当且仅当 $\\Delta E(r) = 0$，对于 $V > 0$ 这仅在 $r=0$ 时发生。在这一点，$Q_1 = 0$ 且 $Q_2 = 0$，两个势能面具有相同的能量 $E_{+}(0) = E_{-}(0) = 0$。对于任何 $r > 0$，简并被解除，能量分裂随 $r$ 线性增长。这种两个势能面在一个点相交并线性分离的几何构型，定义了一个锥形交叉点。高对称性点 $r=0$ 是锥体的顶点。\n\n**4. 几何相位**\n\n为了计算几何相位 $\\gamma$，我们首先需要对应于较低能量面 $E_{-}(r) = \\frac{1}{2}kr^2 - Vr$ 的归一化本征矢量 $|\\chi_{-}(\\phi)\\rangle$。本征矢量方程为：\n$$\nH(r, \\phi) |\\chi_{-}\\rangle = E_{-} |\\chi_{-}\\rangle\n$$\n$$\n\\left( \\frac{1}{2}kr^2\\mathbb{I} + Vr \\begin{pmatrix} \\cos\\phi & \\sin\\phi \\\\ \\sin\\phi & -\\cos\\phi \\end{pmatrix} \\right) |\\chi_{-}\\rangle = \\left(\\frac{1}{2}kr^2 - Vr\\right) |\\chi_{-}\\rangle\n$$\n对于 $r > 0$，这简化为：\n$$\n\\begin{pmatrix} \\cos\\phi & \\sin\\phi \\\\ \\sin\\phi & -\\cos\\phi \\end{pmatrix} |\\chi_{-}\\rangle = -|\\chi_{-}\\rangle\n$$\n设 $|\\chi_{-}\\rangle = \\begin{pmatrix} c_1 \\\\ c_2 \\end{pmatrix}$。第一行给出的方程是：\n$$\nc_1\\cos\\phi + c_2\\sin\\phi = -c_1 \\implies c_1(1+\\cos\\phi) + c_2\\sin\\phi = 0\n$$\n使用半角恒等式 $1+\\cos\\phi = 2\\cos^2(\\phi/2)$ 和 $\\sin\\phi = 2\\sin(\\phi/2)\\cos(\\phi/2)$，我们得到：\n$$\nc_1(2\\cos^2(\\phi/2)) + c_2(2\\sin(\\phi/2)\\cos(\\phi/2)) = 0\n$$\n对于 $\\phi \\neq \\pi$，我们可以除以 $2\\cos(\\phi/2)$ 得到 $c_1\\cos(\\phi/2) + c_2\\sin(\\phi/2) = 0$。\n满足此条件和问题中在 $0 < \\phi < 2\\pi$ 上连续性要求的归一化实矢量是：\n$$\n|\\chi_{-}(\\phi)\\rangle = \\begin{pmatrix} \\sin(\\phi/2) \\\\ -\\cos(\\phi/2) \\end{pmatrix}\n$$\n我们必须考察该本征矢量在闭合环路 $\\phi: 0 \\to 2\\pi$ 上的行为。\n$|\\chi_{-}(0)\\rangle = \\begin{pmatrix} 0 \\\\ -1 \\end{pmatrix}$ 和 $|\\chi_{-}(2\\pi)\\rangle = \\begin{pmatrix} \\sin(\\pi) \\\\ -\\cos(\\pi) \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}$。\n因此，$|\\chi_{-}(2\\pi)\\rangle = -|\\chi_{-}(0)\\rangle$。该状态矢量是双值的；它在绕锥形交叉点完成一圈后会获得一个符号变化。\n\n问题提供了定义 $\\gamma = i\\oint \\langle \\chi_{-}(\\phi)\\rvert \\partial_{\\phi} \\chi_{-}(\\phi)\\rangle\\, d\\phi$。朴素地将此应用于我们的实本征矢量 $|\\chi_{-}(\\phi)\\rangle$ 会得到零结果，因为对于任何归一化的实矢量 $|\\psi\\rangle$，$\\langle\\psi|\\partial_{\\phi}\\psi\\rangle = (\\partial_{\\phi}\\langle\\psi|)|\\psi\\rangle = \\frac{1}{2}\\partial_{\\phi}\\langle\\psi|\\psi\\rangle = \\frac{1}{2}\\partial_{\\phi}(1) = 0$。\n\n这个明显的悖论可以通过考虑“在$\\phi=2\\pi$处进行适当修补”这一说法来解决。几何相位的积分定义是针对单值态的。我们的态 $|\\chi_{-}(\\phi)\\rangle$ 不是单值的。我们必须首先通过将 $|\\chi_{-}(\\phi)\\rangle$ 乘以一个相位因子来构造一个单值态 $|\\tilde{\\chi}(\\phi)\\rangle$，这是一个规范变换。设 $|\\tilde{\\chi}(\\phi)\\rangle = e^{i f(\\phi)} |\\chi_{-}(\\phi)\\rangle$。为了使 $|\\tilde{\\chi}(\\phi)\\rangle$ 是单值的，我们需要 $|\\tilde{\\chi}(2\\pi)\\rangle = |\\tilde{\\chi}(0)\\rangle$。\n$$\ne^{i f(2\\pi)} |\\chi_{-}(2\\pi)\\rangle = e^{i f(0)} |\\chi_{-}(0)\\rangle \\implies e^{i f(2\\pi)} (-|\\chi_{-}(0)\\rangle) = e^{i f(0)} |\\chi_{-}(0)\\rangle\n$$\n这要求 $e^{i(f(2\\pi) - f(0))} = -1 = e^{i\\pi}$。$f(\\phi)$ 的一个有效选择是 $f(\\phi) = -\\phi/2$，这得出 $f(2\\pi) - f(0) = -\\pi$。我们选择这个规范。那么 $|\\tilde{\\chi}(\\phi)\\rangle = e^{-i\\phi/2} |\\chi_{-}(\\phi)\\rangle$ 是单值的。\n几何相位是规范不变的，必须对这个单值态进行计算。贝里联络 $A_{\\phi}$ 的变换方式为 $A_{\\phi} \\to \\tilde{A}_{\\phi} = A_{\\phi} - \\partial_{\\phi}f(\\phi)$。\n如前所示，原始联络为 $A_{\\phi} = i\\langle \\chi_{-}|\\partial_{\\phi}\\chi_{-}\\rangle = 0$。\n新的联络为 $\\tilde{A}_{\\phi} = 0 - \\partial_{\\phi}(-\\phi/2) = 1/2$。\n几何相位是这个新联络沿路径的积分：\n$$\n\\gamma = \\oint \\tilde{A}_{\\phi} d\\phi = \\int_{0}^{2\\pi} \\frac{1}{2} d\\phi = \\pi\n$$\n这就是电子态环绕一个锥形交叉点时获得的众所周知的 $\\pi$ 贝里相位。\n\n最终答案是有序三元组 $(E_{+}(r), E_{-}(r), \\gamma)$。\n$E_{+}(r) = \\frac{1}{2} kr^2 + Vr$\n$E_{-}(r) = \\frac{1}{2} kr^2 - Vr$\n$\\gamma = \\pi$", "answer": "$$\n\\boxed{\\left( \\frac{1}{2} k r^{2} + V r, \\frac{1}{2} k r^{2} - V r, \\pi \\right)}\n$$", "id": "2642890"}, {"introduction": "理论给予了我们一个清晰的解析图景，但计算模拟能为我们提供更直观的验证。这项计算实践将几何相位的抽象概念转化为具体的算法，您将通过追踪绝热波函数沿离散路径的演化来计算相位。这个练习旨在通过亲手编程，数值化地验证几何相位的拓扑性质——即只有环绕奇点的路径才会累积非零相位，从而加深对理论的理解。[@problem_id:2642870]", "problem": "考虑一个双核坐标 $Q_x$ 和 $Q_y$ 中的 $E\\otimes e$ Jahn–Teller 锥形交叉的双态线性振动耦合模型。在固定的非绝热基中，电子哈密顿量由下式给出\n$$\n\\hat{H}_{\\mathrm{el}}(Q_x,Q_y) = \\kappa \\left( Q_x \\,\\hat{\\sigma}_x + Q_y \\,\\hat{\\sigma}_z \\right),\n$$\n其中 $\\hat{\\sigma}_x$ 和 $\\hat{\\sigma}_z$ 是泡利矩阵，$\\kappa$ 是一个实耦合常数。在无量纲单位中，取 $\\kappa = 1$。对于每个核几何构型 $\\mathbf{R} = (Q_x,Q_y)$，将绝热电子基态 $\\lvert n(\\mathbf{R})\\rangle$ 定义为 $\\hat{H}_{\\mathrm{el}}(\\mathbf{R})$ 具有最低本征值的归一化本征矢量。\n\n给定一个由 $N$ 个核几何构型组成的离散化闭合回路 $\\{\\mathbf{R}_k\\}_{k=0}^{N-1}$，其满足周期性闭合条件 $\\mathbf{R}_N \\equiv \\mathbf{R}_0$，定义重叠乘积\n$$\nP = \\prod_{k=0}^{N-1} \\left\\langle n(\\mathbf{R}_k)\\,\\middle|\\,n\\!\\left(\\mathbf{R}_{k+1}\\right)\\right\\rangle,\n$$\n和相关的几何相位\n$$\n\\gamma = \\arg(P),\n$$\n其中 $\\arg(\\cdot)$ 表示在区间 $(-\\pi,\\pi]$ 内以弧度为单位的复主辐角。所有角度必须以弧度为单位，所有量均为无量纲。\n\n仅使用上述定义和基本的线性代数运算，构建一个程序，该程序：\n- 通过求解 $\\hat{H}_{\\mathrm{el}}(\\mathbf{R}_k)$ 的本征值问题，在每个离散化几何构型上构建绝热基态 $\\lvert n(\\mathbf{R}_k)\\rangle$。\n- 对以下测试套件中的每个回路计算重叠乘积 $P$ 和主值 $\\gamma = \\arg(P)$。\n\n测试套件 (每个回路都通过 $k\\in\\{0,1,\\dots,N-1\\}$ 参数化，并满足周期性闭合条件 $k=N\\mapsto 0$):\n1. 以 $(0,0)$ 为中心、环绕原点的圆，单圈环绕：$\\mathbf{R}_k = \\big(r\\cos\\theta_k,\\, r\\sin\\theta_k\\big)$，其中 $r=1$，$\\theta_k = 2\\pi\\,k/N$，$N=720$。\n2. 不环绕原点的圆：中心在 $(2,0)$，半径 $r=1$，单圈环绕，使用相同的离散化 $\\theta_k = 2\\pi\\,k/N$，$N=720$。\n3. 以 $(0,0)$ 为中心、双圈环绕的圆：$\\theta_k = 4\\pi\\,k/N$，$r=1$，$N=720$。\n4. 以 $(0,0)$ 为中心的小圆，非常接近锥形交叉点但未穿过：$r=10^{-3}$，单圈环绕，$\\theta_k = 2\\pi\\,k/N$，$N=2000$。\n5. 环绕原点的椭圆：中心 $(c_x,c_y)=(0.4,-0.2)$，半轴 $a=1.0$，$b=0.6$，单圈环绕，$\\theta_k = 2\\pi\\,k/N$，$N=1000$，路径 $\\mathbf{R}_k = \\big(c_x + a\\cos\\theta_k,\\, c_y + b\\sin\\theta_k\\big)$。\n\n您的程序必须按照上述定义精确计算每个回路的 $\\gamma$，并将最终结果以单行形式输出，该行包含一个浮点数列表，单位为弧度，四舍五入到 $6$ 位小数，并按测试套件中列出的顺序排列。最终输出格式必须严格为：\n\"[gamma_1,gamma_2,gamma_3,gamma_4,gamma_5]\"\n\n不需要外部输入。所有角度必须以弧度为单位。所有量均为无量纲。这个问题旨在数值上证明，环绕锥形交叉的回路得到的重叠乘积结果与 $-1$ 一致，对应于 $\\gamma$ 等于 $\\pi$ (模 $2\\pi$)，而不环绕锥形交叉的回路得到的结果与 $+1$ 一致，对应于 $\\gamma$ 等于 $0$ (模 $2\\pi$)。", "solution": "该问题要求对一个双态量子系统进行几何相位（贝里相位）的数值计算，该系统的哈密顿量依赖于两个参数 $Q_x$ 和 $Q_y$。系统在 $(Q_x, Q_y)$ 参数空间中沿一闭合回路运动，并计算其累积的几何相位。这个问题用作一个数值演示，展示几何相位的一个关键特性：对于环绕电子简并点（锥形交叉点）的任何回路，其值为 $\\pi$（模 $2\\pi$），而对于不环绕该点的任何回路，其值为 $0$。\n\n首先，我们形式化地写出电子哈密顿量。问题陈述了在非绝热基中的哈密顿量为 $\\hat{H}_{\\mathrm{el}}(Q_x,Q_y) = \\kappa \\left( Q_x \\,\\hat{\\sigma}_x + Q_y \\,\\hat{\\sigma}_z \\right)$。在耦合常数 $\\kappa = 1$ 和泡利矩阵的标准矩阵表示 $\\hat{\\sigma}_x = \\begin{pmatrix} 0 & 1 \\\\ 1 & 0 \\end{pmatrix}$ 和 $\\hat{\\sigma}_z = \\begin{pmatrix} 1 & 0 \\\\ 0 & -1 \\end{pmatrix}$ 下，对于给定的核几何构型 $\\mathbf{R} = (Q_x, Q_y)$，哈密顿量是一个 $2\\times2$ 矩阵：\n$$\nH(\\mathbf{R}) = \\begin{pmatrix} Q_y & Q_x \\\\ Q_x & -Q_y \\end{pmatrix}\n$$\n该矩阵是实对称的，因此是厄米（Hermitian）的。它的本征值是实数，本征矢量是正交的。通过求解特征方程 $\\det(H - E\\mathbb{I}) = 0$ 可以找到本征值，其结果为 $E^2 - Q_x^2 - Q_y^2 = 0$。两个能量面为 $E_{\\pm}(\\mathbf{R}) = \\pm\\sqrt{Q_x^2 + Q_y^2}$。这两个能量面在唯一点，即原点 $(Q_x, Q_y) = (0, 0)$ 相交，形成一个锥形交叉。在所有其他点，这两个态之间存在非零的能隙。\n\n计算任务的核心是确定沿着离散化闭合回路 $\\{\\mathbf{R}_k\\}_{k=0}^{N-1}$ 的每个几何构型 $\\mathbf{R}_k$ 的绝热基态 $\\lvert n(\\mathbf{R})\\rangle$。基态是对应于最低本征值 $E_-(\\mathbf{R}) = -\\sqrt{Q_x^2 + Q_y^2}$ 的归一化本征矢量。这是一个标准的数值本征值问题。对于给定路径上的每个点 $\\mathbf{R}_k$，我们构造矩阵 $H(\\mathbf{R}_k)$ 并对其进行数值对角化，以找到本征值和本征矢量。我们选择对应于最小本征值的本征矢量。我们将沿路径的基态序列表示为 $\\{\\lvert n(\\mathbf{R}_k)\\rangle\\}_{k=0}^{N}$。注意，我们必须计算 $N+1$ 个态，以包含回路闭合点 $\\mathbf{R}_N = \\mathbf{R}_0$。\n\n几何相位 $\\gamma$ 通过重叠乘积 $P = \\prod_{k=0}^{N-1} \\left\\langle n(\\mathbf{R}_k)\\,\\middle|\\,n\\!\\left(\\mathbf{R}_{k+1}\\right)\\right\\rangle$ 定义。相位则为 $\\gamma = \\arg(P)$，其中 $\\arg(\\cdot)$ 是复主辐角在区间 $(-\\pi, \\pi]$ 内的值。乘积中的每一项 $\\left\\langle n(\\mathbf{R}_k)\\,\\middle|\\,n\\!\\left(\\mathbf{R}_{k+1}\\right)\\right\\rangle$ 是第 $k$ 步的基态与第 $k+1$ 步的基态的复内积。\n\n数值实现中的一个关键细节是本征矢量的相位。数值本征求解器返回的本征矢量仅在相差一个模为 $1$ 的任意复相位因子下是确定的。然而，只要使用确定性本征求解器，所选的乘积 $P$ 的定义对这种模糊性是鲁棒的。与每个本征矢量相关的任意相位因子（例如 $\\lvert n(\\mathbf{R}_k)\\rangle$ 的 $e^{i\\alpha_k}$）在总乘积中会相互抵消。项 $\\left\\langle n(\\mathbf{R}_k)\\,\\middle|\\,n\\!\\left(\\mathbf{R}_{k+1}\\right)\\right\\rangle$ 将包含一个相位因子 $e^{-i\\alpha_k}e^{i\\alpha_{k+1}}$。在完整乘积 $\\prod_{k=0}^{N-1}$ 中，这些项会级数伸缩相消，最终只留下一个因子 $e^{i(\\alpha_N - \\alpha_0)}$。由于回路是闭合的，$\\mathbf{R}_N = \\mathbf{R}_0$，哈密顿量是相同的，确定性求解器将产生相同的本征矢量，即 $\\lvert n(\\mathbf{R}_N)\\rangle = \\lvert n(\\mathbf{R}_0)\\rangle$，这意味着 $\\alpha_N = \\alpha_0$。因此，相位因子为 $1$，计算是有效的。\n\n对于每个测试用例，算法流程如下：\n1.  定义路径参数：中心 $(c_x, c_y)$，半轴 $(a, b)$，步数 $N$，以及环绕圈数 $w$。\n2.  生成一个由 $N+1$ 个核几何构型组成的序列 $\\{\\mathbf{R}_k\\}_{k=0}^{N}$ 来离散化路径。参数化为 $\\mathbf{R}_k = \\big(c_x + a\\cos(w \\cdot 2\\pi k/N),\\, c_y + b\\sin(w \\cdot 2\\pi k/N)\\big)$。\n3.  对每个几何构型 $\\mathbf{R}_k$，构建哈密顿矩阵 $H(\\mathbf{R}_k)$。\n4.  使用数值本征求解器（例如，`numpy.linalg.eigh`）找到 $H(\\mathbf{R}_k)$ 的本征值和本征矢量。基态 $\\lvert n(\\mathbf{R}_k)\\rangle$ 是对应于最小本征值的本征矢量。存储所有 $N+1$ 个基态。\n5.  初始化一个复变量 $P=1.0+0.0j$。\n6.  从 $k=0$ 到 $N-1$ 迭代，计算重叠 $s_k = \\left\\langle n(\\mathbf{R}_k)\\,\\middle|\\,n\\!\\left(\\mathbf{R}_{k+1}\\right)\\right\\rangle$ 并更新乘积 $P \\leftarrow P \\times s_k$。使用共轭复内积是至关重要的。\n7.  最后，使用一个返回区间 $(-\\pi, \\pi]$ 内主值的函数计算几何相位 $\\gamma = \\arg(P)$。\n将此过程应用于问题陈述中定义的五个测试用例中的每一个。结果将数值上证实，环绕原点处锥形交叉的回路会得到 $\\gamma \\approx \\pi$，而那些不环绕的回路会得到 $\\gamma \\approx 0$。一个环绕两圈的回路将累积 $2\\pi$ 的总相位，其主值为 $0$。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef calculate_geometric_phase(path_params):\n    \"\"\"\n    Computes the geometric phase for a given closed loop in the parameter space.\n\n    Args:\n        path_params (tuple): A tuple containing the parameters of the loop:\n            (center_x, center_y, a, b, N, windings)\n            - center_x, center_y: Coordinates of the center of the ellipse.\n            - a, b: Semi-axes of the ellipse.\n            - N: Number of discretization steps.\n            - windings: Number of times the loop is traversed.\n\n    Returns:\n        float: The calculated geometric phase gamma in radians.\n    \"\"\"\n    # Unpack parameters from the input tuple\n    center_x, center_y, a, b, N, windings = path_params\n\n    # 1. Generate the sequence of N+1 nuclear geometries {R_k} for k=0...N\n    # The path is parameterized by theta, which goes from 0 to (windings * 2*pi).\n    # We need N+1 points to ensure the loop closure R_N = R_0 is included for the overlap calculation.\n    k_values = np.arange(N + 1)\n    thetas = windings * 2 * np.pi * k_values / N\n    q_x_coords = center_x + a * np.cos(thetas)\n    q_y_coords = center_y + b * np.sin(thetas)\n\n    # 2. Compute the ground state eigenvector at each point along the path\n    ground_states = []\n    for k in range(N + 1):\n        Qx = q_x_coords[k]\n        Qy = q_y_coords[k]\n        \n        # Build the 2x2 electronic Hamiltonian matrix\n        # H = [[Qy, Qx], [Qx, -Qy]]\n        H = np.array([[Qy, Qx], [Qx, -Qy]], dtype=np.float64)\n        \n        # Solve the eigenvalue problem for the Hermitian matrix H.\n        # np.linalg.eigh returns eigenvalues in ascending order and corresponding\n        # eigenvectors as columns of a matrix.\n        eigenvalues, eigenvectors = np.linalg.eigh(H)\n        \n        # The ground state is the eigenvector corresponding to the lowest eigenvalue.\n        # This will be the first column of the `eigenvectors` matrix.\n        # We convert it to a complex type for subsequent calculations.\n        ground_state = eigenvectors[:, 0].astype(np.complex128)\n        ground_states.append(ground_state)\n        \n    # 3. Compute the overlap product P\n    # P = product_{k=0}^{N-1} <n(R_k)|n(R_{k+1})>\n    P = 1.0 + 0.0j\n    for k in range(N):\n        n_k = ground_states[k]\n        n_k_plus_1 = ground_states[k+1]\n        \n        # Calculate the inner product <n_k|n_{k+1}>.\n        # np.vdot computes the dot product with the conjugate of the first vector.\n        overlap = np.vdot(n_k, n_k_plus_1)\n        P *= overlap\n        \n    # 4. Compute the geometric phase gamma as the argument of P\n    # np.angle returns the angle in the interval (-pi, pi].\n    gamma = np.angle(P)\n    \n    return gamma\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print the results.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (center_x, center_y, a, b, N, windings)\n    # For a circle, a = b = radius.\n    test_cases = [\n        # 1. Circle centered at (0,0) enclosing the origin, one winding.\n        (0.0, 0.0, 1.0, 1.0, 720, 1),\n        # 2. Circle not enclosing the origin.\n        (2.0, 0.0, 1.0, 1.0, 720, 1),\n        # 3. Circle centered at (0,0) with two windings.\n        (0.0, 0.0, 1.0, 1.0, 720, 2),\n        # 4. Small circle centered at (0,0), enclosing the origin.\n        (0.0, 0.0, 1e-3, 1e-3, 2000, 1),\n        # 5. Ellipse enclosing the origin.\n        (0.4, -0.2, 1.0, 0.6, 1000, 1),\n    ]\n\n    results = []\n    for params in test_cases:\n        gamma = calculate_geometric_phase(params)\n        # Round the result to 6 decimal places as required.\n        results.append(round(gamma, 6))\n\n    # Final print statement in the exact required format.\n    # The formatted string must be a single line.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2642870"}, {"introduction": "几何相位最终的意义体现在它对化学现实的影响上。这项练习将带领您探究这一量子效应对化学反应结果的直接控制作用。通过一个精简的量子干涉模型，您将量化比较包含与不包含几何相位时，反应产物分支比的显著差异，从而直观地理解拓扑相位如何通过干涉效应“指挥”分子命运。[@problem_id:2642908]", "problem": "考虑一个在 Born–Oppenheimer 表象中具有锥形交叉的最小双态光解离模型。总分子波函数近似为核波函数和绝热电子波函数的乘积。在锥形交叉附近，绝热电子态绕缝（seam）走一闭合圈后会改变符号，这会在核波函数上引入一个 $\\,\\pi\\,$ 的几何（Berry）相位，以保持波函数的单值性。在一个半经典图像中，若有两条主导的核路径相干地贡献于某一给定的产物通道，则总的核振幅是各路径振幅的相干叠加，每条路径振幅都带有一个动力学相位，并且如果适用，则每奇数次绕缝（winding）会增加一个 $\\,\\pi\\,$ 的几何相位。\n\n你的任务是，使用一个简化的、通用的、纯数学的干涉模型来基准测试（benchmark）包含几何相位对非绝热分支比的影响。该模型模拟了考虑相位的“最少切换表面跳跃”（phase-aware Fewest Switches Surface Hopping, FSSH）方法的精髓，并与忽略几何相位的标准实现进行对比。假设如下：\n\n- 存在两条从初态制备区到产物区的相干路径，它们主导了动力学过程，通往两个对称相关的产物通道（标记为“top”和“bottom”）。复路径振幅的模分别为 $\\,\\sqrt{p}\\,$ 和 $\\,\\sqrt{1-p}\\,$，其中 $\\,p \\in [0,1]\\,$ 是与其中一条路径相关的 Landau–Zener 型非绝热跃迁概率。这一选择意味着一条路径是非绝热的，其经典权重为 $\\,p\\,$，而另一条是绝热的，其经典权重为 $\\,1-p\\,$。\n- 两条路径之间的相对动力学相位是一个以弧度为单位的实数 $\\,\\Delta \\phi\\,$。\n- 环绕宇称（winding parity）$\\,w \\in \\{0,1\\}\\,$ 表示干涉路径构成的净环路是否奇数次环绕锥形交叉（$\\,w=1\\,$）或非奇数次（$\\,w=0\\,$）。考虑相位的模型将其中一条路径乘以拓扑因子 $\\,(-1)^w\\,$，而标准模型则无论实际宇称如何，都设定 $\\,w=0\\,$。\n- 两个对称相关的产物通道被建模为两条路径振幅的偶宇称和奇宇称叠加。“top”通道取偶宇称叠加，“bottom”通道取奇宇称叠加。\n\n任务。对于下面测试套件中的每一组参数 $\\,\\{p,\\Delta \\phi,w\\}\\,$，计算：\n1. “标准”的“top”通道分支比，通过忽略几何相位获得（即，在相位因子中使用 $\\,w=0\\,$）。\n2. “考虑相位”的“top”通道分支比，通过按规定引入几何相位（使用指定的 $\\,w\\,$）获得。\n3. “top”通道分支比的“考虑相位”模型与“标准”模型之差。\n\n需要实现的建模规则：\n- 将两个复路径振幅表示为 $\\,a_1=\\sqrt{p}\\,e^{i\\phi_1}\\,$ 和 $\\,a_2=\\sqrt{1-p}\\,e^{i\\phi_2}\\,$，其中 $\\,\\Delta \\phi=\\phi_2-\\phi_1\\,$。不失一般性，可设 $\\,\\phi_1=0\\,$，因此 $\\,a_1=\\sqrt{p}\\,$ 且 $\\,a_2=\\sqrt{1-p}\\,e^{i\\Delta \\phi}\\,$。\n- 在考虑相位的模型中，通过将 $\\,a_2\\,$ 乘以 $\\,(-1)^w\\,$ 来包含几何相位。在标准模型中，即使提供了非零值，也设 $\\,w=0\\,$。\n- “top”通道的振幅是两条路径的偶宇称叠加，“bottom”通道的振幅是奇宇称叠加。通过计算这些振幅的模平方来得到相应的概率。“top”通道分支比是“top”通道的概率除以“top”和“bottom”通道概率之和。\n- 所有角度均以弧度为单位。除了已声明的无量纲量外，不需要其他物理单位。\n\n测试套件（每个三元组为 $\\,\\{p,\\Delta \\phi,w\\}\\,$）：\n- 案例 $\\,1\\,$: $\\,\\{\\,0.25,\\ \\pi/3,\\ 1\\,\\}\\,$.\n- 案例 $\\,2\\,$: $\\,\\{\\,0.5,\\ 0.0,\\ 1\\,\\}\\,$.\n- 案例 $\\,3\\,$: $\\,\\{\\,0.01,\\ \\pi/2,\\ 1\\,\\}\\,$.\n- 案例 $\\,4\\,$: $\\,\\{\\,0.5,\\ \\pi,\\ 0\\,\\}\\,$.\n- 案例 $\\,5\\,$: $\\,\\{\\,0.0,\\ 1.234,\\ 1\\,\\}\\,$.\n- 案例 $\\,6\\,$: $\\,\\{\\,1.0,\\ 2.468,\\ 1\\,\\}\\,$.\n- 案例 $\\,7\\,$: $\\,\\{\\,0.3,\\ 2.0,\\ 1\\,\\}\\,$.\n- 案例 $\\,8\\,$: $\\,\\{\\,0.3,\\ 2.0,\\ 0\\,\\}\\,$.\n\n要求的最终输出格式：\n- 你的程序应生成单行输出，其中包含八个案例的“top”通道分支比之差（考虑相位模型减去标准模型），按顺序排列，形式为用方括号括起来的逗号分隔列表，例如 $\\,\\big[\\text{result}_1,\\text{result}_2,\\ldots,\\text{result}_8\\big]\\,$。", "solution": "问题陈述经评估有效。它具有科学依据，提法明确，客观且自成体系。它基于物理化学中量子动力学的既定原理，特别是关于锥形交叉附近的几何相位，提出了一个清晰、可形式化的任务。所提供的模型虽然经过简化，却是研究此类量子效应的一个标准且不平凡的理论构造。其中没有矛盾、歧义或事实错误。因此，我将继续进行推导和求解。\n\n问题要求计算“考虑相位”的模型（包含几何相位）和“标准”模型（忽略几何相位）之间“top”通道分支比的差异。该解是通过对两条相干路径之间的量子干涉进行建模而得出的。\n\n首先，我们定义两条干涉路径的复振幅。根据问题陈述，我们将非绝热路径的振幅指定为 $a_1$，绝热路径的振幅指定为 $a_2$。它们的模分别为 $\\sqrt{p}$ 和 $\\sqrt{1-p}$，其中 $p$ 是非绝热跃迁概率。相对动力学相位为 $\\Delta \\phi$。不失一般性，我们可以将第一条路径的相位设为 $0$。\n$$\na_1 = \\sqrt{p}\n$$\n$$\na_2 = \\sqrt{1-p} \\, e^{i\\Delta \\phi}\n$$\n\n几何相位以拓扑因子 $(-1)^w = e^{i\\pi w}$ 的形式引入，其中 $w \\in \\{0,1\\}$ 是环绕宇称。在考虑相位的模型中，该因子乘以其中一个路径振幅。我们将其应用于 $a_2$，得到修改后的振幅 $a_2'$。对两个模型都有效的 $a_2'$ 的通用表达式为：\n$$\na_2' = a_2 \\cdot e^{i\\pi w} = \\sqrt{1-p} \\, e^{i(\\Delta \\phi + \\pi w)}\n$$\n对于“标准”模型，$w$ 总是取 $0$。对于“考虑相位”的模型，$w$ 取测试案例中提供的值，即 $0$ 或 $1$。\n\n“top”和“bottom”产物通道的振幅被定义为两条路径振幅 $a_1$ 和 $a_2'$ 的偶宇称和奇宇称叠加。我们可以将它们写为：\n$$\nA_{\\text{top}} = a_1 + a_2'\n$$\n$$\nA_{\\text{bottom}} = a_1 - a_2'\n$$\n使用诸如 $1/\\sqrt{2}$ 之类的归一化因子是不必要的，因为它将在分支比的计算中被抵消。\n\n每个通道的概率是其各自振幅的模平方。\n“top”通道的概率 $P_{\\text{top}}$ 为：\n$$\nP_{\\text{top}} = |A_{\\text{top}}|^2 = |a_1 + a_2'|^2 = |a_1|^2 + |a_2'|^2 + 2\\text{Re}(a_1^* a_2')\n$$\n代入 $a_1$ 和 $a_2'$ 的表达式：\n$$\n|a_1|^2 = p\n$$\n$$\n|a_2'|^2 = 1 - p\n$$\n$$\na_1^* a_2' = \\sqrt{p} \\left( \\sqrt{1-p} \\, e^{i(\\Delta \\phi + \\pi w)} \\right) = \\sqrt{p(1-p)} e^{i(\\Delta \\phi + \\pi w)}\n$$\n$$\n2\\text{Re}(a_1^* a_2') = 2\\sqrt{p(1-p)} \\cos(\\Delta \\phi + \\pi w)\n$$\n因此，概率 $P_{\\text{top}}$ 变为：\n$$\nP_{\\text{top}} = p + (1-p) + 2\\sqrt{p(1-p)} \\cos(\\Delta \\phi + \\pi w) = 1 + 2\\sqrt{p(1-p)} \\cos(\\Delta \\phi + \\pi w)\n$$\n类似地，“bottom”通道的概率 $P_{\\text{bottom}}$ 为：\n$$\nP_{\\text{bottom}} = |A_{\\text{bottom}}|^2 = |a_1 - a_2'|^2 = |a_1|^2 + |a_2'|^2 - 2\\text{Re}(a_1^* a_2')\n$$\n$$\nP_{\\text{bottom}} = 1 - 2\\sqrt{p(1-p)} \\cos(\\Delta \\phi + \\pi w)\n$$\n总概率 $P_{\\text{total}} = P_{\\text{top}} + P_{\\text{bottom}}$ 为：\n$$\nP_{\\text{total}} = \\left( 1 + 2\\sqrt{p(1-p)} \\cos(\\Delta \\phi + \\pi w) \\right) + \\left( 1 - 2\\sqrt{p(1-p)} \\cos(\\Delta \\phi + \\pi w) \\right) = 2\n$$\n总概率是一个常数，这证实了该模型中的通量守恒。\n\n“top”通道分支比 $B_{\\text{top}}$ 是“top”通道概率与总概率的比值：\n$$\nB_{\\text{top}}(p, \\Delta\\phi, w) = \\frac{P_{\\text{top}}}{P_{\\text{total}}} = \\frac{1 + 2\\sqrt{p(1-p)} \\cos(\\Delta \\phi + \\pi w)}{2} = \\frac{1}{2} + \\sqrt{p(1-p)} \\cos(\\Delta \\phi + \\pi w)\n$$\n这是“top”通道分支比的通用表达式。\n\n现在，我们可以定义“标准”模型和“考虑相位”模型的分支比。\n标准模型分支比 $B_{\\text{top}}^{\\text{std}}$ 是通过设 $w=0$ 得到的：\n$$\nB_{\\text{top}}^{\\text{std}} = \\frac{1}{2} + \\sqrt{p(1-p)} \\cos(\\Delta \\phi)\n$$\n考虑相位的模型分支比 $B_{\\text{top}}^{\\text{aware}}$ 使用给定的环绕宇称 $w$：\n$$\nB_{\\text{top}}^{\\text{aware}} = \\frac{1}{2} + \\sqrt{p(1-p)} \\cos(\\Delta \\phi + \\pi w)\n$$\n所求的量是差值 $\\Delta B_{\\text{top}} = B_{\\text{top}}^{\\text{aware}} - B_{\\text{top}}^{\\text{std}}$：\n$$\n\\Delta B_{\\text{top}} = \\left( \\frac{1}{2} + \\sqrt{p(1-p)} \\cos(\\Delta \\phi + \\pi w) \\right) - \\left( \\frac{1}{2} + \\sqrt{p(1-p)} \\cos(\\Delta \\phi) \\right)\n$$\n$$\n\\Delta B_{\\text{top}}(p, \\Delta\\phi, w) = \\sqrt{p(1-p)} \\left( \\cos(\\Delta \\phi + \\pi w) - \\cos(\\Delta \\phi) \\right)\n$$\n这个最终的简洁表达式将用于求解每个测试案例。注意，如果 $w=0$，差值显然为 $0$。如果 $w=1$，使用 $\\cos(x+\\pi) = -\\cos(x)$ 可将表达式简化为：\n$$\n\\Delta B_{\\text{top}}(p, \\Delta\\phi, 1) = \\sqrt{p(1-p)} (-\\cos(\\Delta \\phi) - \\cos(\\Delta \\phi)) = -2\\sqrt{p(1-p)}\\cos(\\Delta \\phi)\n$$\n干涉项与 $\\sqrt{p(1-p)}$ 成正比，因此如果 $p=0$ 或 $p=1$，差值为零，这与预期相符，因为干涉需要两条振幅非零的路径。\n\n所提供的 Python 代码实现了这个最终公式，用以计算测试套件中每组参数的差值。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the difference in top-channel branching ratio between phase-aware and\n    standard models for a series of test cases.\n    \"\"\"\n\n    # Test suite: each tuple is {p, Δφ, w}\n    test_cases = [\n        (0.25, np.pi / 3, 1),\n        (0.5, 0.0, 1),\n        (0.01, np.pi / 2, 1),\n        (0.5, np.pi, 0),\n        (0.0, 1.234, 1),\n        (1.0, 2.468, 1),\n        (0.3, 2.0, 1),\n        (0.3, 2.0, 0),\n    ]\n\n    results = []\n    for p, delta_phi, w in test_cases:\n        # The difference in branching ratio is given by the formula:\n        # ΔB_top = sqrt(p(1-p)) * (cos(Δφ + πw) - cos(Δφ))\n        # This formula naturally handles all edge cases:\n        # - If w=0, the difference is 0.\n        # - If p=0 or p=1, the interference prefactor sqrt(p(1-p)) is 0, so the difference is 0.\n        \n        # Calculate the interference prefactor.\n        # Using 1.0 to ensure floating-point arithmetic.\n        interference_prefactor = np.sqrt(p * (1.0 - p))\n        \n        # Calculate the cosine terms for the phase-aware and standard models.\n        cos_term_aware = np.cos(delta_phi + np.pi * w)\n        cos_term_standard = np.cos(delta_phi)\n        \n        # Compute the final difference.\n        diff = interference_prefactor * (cos_term_aware - cos_term_standard)\n        results.append(diff)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2642908"}]}