{"hands_on_practices": [{"introduction": "理论的掌握必须通过实践来巩固。本节的第一个练习将引导你分析非绝热动力学中的一个核心场景：避开交叉。通过对一个简洁但功能强大的双态模型的解析求解，你将亲手推导出绝热势能面、能隙以及驱动跃迁的非绝热耦合项。这项实践旨在深化你对电子哈密顿量、绝热势能面以及非绝热耦合之间内在联系的理解[@problem_id:2655278]。", "problem": "一个双原子分子在避免交叉附近的模型由一个依赖于单一核坐标 $R$ 的双态非绝热电子哈密顿量描述，\n$$\nH_{e}(R)=\\begin{pmatrix}\n\\alpha R & V\\\\\nV & -\\alpha R\n\\end{pmatrix},\n$$\n其中 $\\alpha$ 和 $V$ 是实常数，其量纲分别为单位长度的能量和能量。在电子运动与核运动的玻恩-奥本海默 (BO) 分离近似下，绝热势能面定义为在固定 $R$ 处电子哈密顿量的本征值，而相应的绝热电子态是其关联的本征矢量。从绝热态是在固定 $R$ 处不含时电子薛定谔方程的定态解的定义出发，并利用厄米矩阵及其本征问题的基本性质：\n\n- 通过对角化 $H_{e}(R)$，推导两个绝热势能面 $E_{+}(R)$ 和 $E_{-}(R)$ 的解析形式。\n- 定义绝热能隙 $\\Delta E(R)=E_{+}(R)-E_{-}(R)$，并确定使该能隙最小化的核坐标 $R_{\\min}$。计算相应的最小值 $\\Delta E_{\\min}$。\n- 使用绝热本征矢量，引入一个混合角 $\\theta(R)$，用非绝热基来参数化绝熱态，并将非绝热导数耦合 $d_{12}(R)=\\langle \\phi_{1}(R)|\\partial/\\partial R|\\phi_{2}(R)\\rangle$ 表示为 $\\theta(R)$ 及其导数的函数。确定 $|d_{12}(R)|$ 在何处达到最大值，并从您的表达式中提取一个 $R$ 的特征长度标度，该标度量化了避免交叉区域的空间范围。\n- 将 $E_{-}(R)$ 在 $R=R_{\\min}$ 附近展开至二阶，以获得该点的局部曲率，并根据下绝热面的局部形状解释该曲率的符号。\n\n作为最终答案，报告最小绝热能隙 $\\Delta E_{\\min}$ 用 $\\alpha$ 和 $V$ 表示的闭合形式表达式。不需要进行数值计算，最终答案中不应报告单位。", "solution": "所陈述的问题具有科学依据、是良定的、客观且自洽的。它使用一个标准的双态模型哈密顿量来探讨非绝热动力学的基本概念。该问题是有效的，并且可以构建出完整的解答。\n\n非绝热电子哈密顿量由下式给出\n$$\nH_{e}(R)=\\begin{pmatrix}\n\\alpha R & V\\\\\nV & -\\alpha R\n\\end{pmatrix}\n$$\n其中 $R$ 是核坐标，$\\alpha$ 和 $V$ 是实常数。\n\n绝热势能面，我记为 $E_{\\pm}(R)$，是 $H_{e}(R)$ 的本征值。为了找到这些值，我们求解特征方程 $\\det(H_{e}(R) - E \\cdot I) = 0$，其中 $I$ 是 $2 \\times 2$ 的单位矩阵。\n$$\n\\det \\begin{pmatrix}\n\\alpha R - E & V\\\\\nV & -\\alpha R - E\n\\end{pmatrix} = 0\n$$\n$$\n(\\alpha R - E)(-\\alpha R - E) - V^2 = 0\n$$\n$$\n-(\\alpha R)^2 - \\alpha R E + \\alpha R E + E^2 - V^2 = 0\n$$\n$$\nE^2 = (\\alpha R)^2 + V^2\n$$\n因此，两个本征值为：\n$$\nE_{\\pm}(R) = \\pm \\sqrt{(\\alpha R)^2 + V^2}\n$$\n这些是两个绝热势能面的解析形式。我们定义 $E_{+}(R) = \\sqrt{(\\alpha R)^2 + V^2}$ 为上势能面，$E_{-}(R) = -\\sqrt{(\\alpha R)^2 + V^2}$ 为下势能面。\n\n接下来，我们将绝热能隙 $\\Delta E(R)$ 定义为两个势能面之差：\n$$\n\\Delta E(R) = E_{+}(R) - E_{-}(R) = \\sqrt{(\\alpha R)^2 + V^2} - (-\\sqrt{(\\alpha R)^2 + V^2}) = 2\\sqrt{(\\alpha R)^2 + V^2}\n$$\n为了找到使该能隙最小化的核坐标 $R_{\\min}$，我们必须求函数 $\\Delta E(R)$ 的最小值。这等价于最小化平方根下的表达式 $f(R) = (\\alpha R)^2 + V^2$。我们通过将关于 $R$ 的一阶导数设为零来求极值：\n$$\n\\frac{d f(R)}{dR} = \\frac{d}{dR}((\\alpha R)^2 + V^2) = 2\\alpha^2 R = 0\n$$\n该条件仅在 $R = 0$ 时满足。二阶导数 $\\frac{d^2 f(R)}{dR^2} = 2\\alpha^2$ 是正的（假设 $\\alpha \\neq 0$），这证实了 $R_{\\min} = 0$ 是一个极小值点。\n最小绝热能隙的值可以通过将 $R_{\\min} = 0$ 代入 $\\Delta E(R)$ 的表达式得到：\n$$\n\\Delta E_{\\min} = \\Delta E(0) = 2\\sqrt{(\\alpha \\cdot 0)^2 + V^2} = 2\\sqrt{V^2} = 2|V|\n$$\n由于 $V$ 是一个实常数，为了完全的数学严谨性，需要使用绝对值。\n\n现在，我们引入一个混合角 $\\theta(R)$ 来参数化绝热态。绝热态是 $H_e(R)$ 的本征矢量。它们通过一个旋转与非绝热基态 $|d_1\\rangle = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$ 和 $|d_2\\rangle = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}$ 相关联。我们定义绝热态为：\n$$\n|\\phi_1(R)\\rangle = |\\phi_-(R)\\rangle = \\begin{pmatrix} -\\sin(\\theta(R)) \\\\ \\cos(\\theta(R)) \\end{pmatrix}\n$$\n$$\n|\\phi_2(R)\\rangle = |\\phi_+(R)\\rangle = \\begin{pmatrix} \\cos(\\theta(R)) \\\\ \\sin(\\theta(R)) \\end{pmatrix}\n$$\n这种选择确保了这些态是规范正交的。为了使它们成为本征矢量，在此基中表示的哈密顿量必须是对角的。对角化的条件是变换后的哈密顿量 $U^{\\dagger} H_e U$ 的非对角元为零，其中 $U(R)$ 是以本征矢量为列的旋转矩阵。这导出了以下关系：\n$$\n\\tan(2\\theta(R)) = \\frac{V}{\\alpha R}\n$$\n非绝热导数耦合为 $d_{12}(R)=\\langle \\phi_{1}(R)|\\partial/\\partial R|\\phi_{2}(R)\\rangle$。我们计算 $|\\phi_2(R)\\rangle$ 的导数：\n$$\n\\frac{\\partial}{\\partial R}|\\phi_2(R)\\rangle = \\frac{\\partial}{\\partial R}\\begin{pmatrix} \\cos(\\theta(R)) \\\\ \\sin(\\theta(R)) \\end{pmatrix} = \\frac{d\\theta}{dR} \\begin{pmatrix} -\\sin(\\theta(R)) \\\\ \\cos(\\theta(R)) \\end{pmatrix} = \\frac{d\\theta}{dR}|\\phi_1(R)\\rangle\n$$\n将此代入耦合的定义中：\n$$\nd_{12}(R) = \\langle \\phi_1(R) | \\frac{\\partial}{\\partial R} | \\phi_2(R) \\rangle = \\frac{d\\theta}{dR} \\langle \\phi_1(R) | \\phi_1(R) \\rangle = \\frac{d\\theta}{dR}\n$$\n为了求得 $\\frac{d\\theta}{dR}$，我们对 $\\tan(2\\theta) = V/(\\alpha R)$ 关于 $R$ 求导：\n$$\n\\sec^2(2\\theta) \\cdot 2\\frac{d\\theta}{dR} = -\\frac{V}{\\alpha R^2}\n$$\n$$\n\\frac{d\\theta}{dR} = -\\frac{V}{2\\alpha R^2 \\sec^2(2\\theta)} = -\\frac{V \\cos^2(2\\theta)}{2\\alpha R^2}\n$$\n从关系式 $\\tan(2\\theta) = V/(\\alpha R)$，我们得到 $\\cos^2(2\\theta) = \\frac{(\\alpha R)^2}{(\\alpha R)^2+V^2}$。代入此式可得：\n$$\nd_{12}(R) = -\\frac{V}{2\\alpha R^2} \\frac{(\\alpha R)^2}{(\\alpha R)^2+V^2} = -\\frac{V\\alpha}{2((\\alpha R)^2+V^2)}\n$$\n耦合的大小为 $|d_{12}(R)| = \\frac{|V\\alpha|}{2((\\alpha R)^2+V^2)}$。该函数是一个以 $R=0$ 为中心的洛伦兹函数。其最大值出现在分母最小时，即 $R=0$ 处。此耦合区域的空间范围由其宽度表征。当 $(\\alpha R)^2 = V^2$ 或 $|R| = |V/\\alpha|$ 时，该函数的值降至其最大值的一半。因此，避免交叉区域的一个特征长度标度是\n$$\nL = \\frac{|V|}{|\\alpha|}\n$$\n这个量纲为长度的长度标度，量化了绝热态的特性从一个非绝热态转变为另一个非绝热态的速度。\n\n最后，我们将 $E_{-}(R) = -\\sqrt{(\\alpha R)^2 + V^2}$ 在 $R_{\\min}=0$ 附近展开至二阶。这是一个泰勒展开。\n$$\nE_{-}(R) \\approx E_{-}(0) + \\left.\\frac{dE_{-}}{dR}\\right|_{R=0} R + \\frac{1}{2} \\left.\\frac{d^2E_{-}}{dR^2}\\right|_{R=0} R^2\n$$\n我们有 $E_{-}(0) = -|V|$。一阶导数为：\n$$\n\\frac{dE_{-}}{dR} = -\\frac{1}{2}((\\alpha R)^2 + V^2)^{-1/2}(2\\alpha^2 R) = -\\frac{\\alpha^2 R}{\\sqrt{(\\alpha R)^2 + V^2}}\n$$\n在 $R=0$ 处，$\\left.\\frac{dE_{-}}{dR}\\right|_{R=0} = 0$，正如对极值点的预期。二阶导数为：\n$$\n\\frac{d^2E_{-}}{dR^2} = -\\alpha^2 \\frac{d}{dR} \\left( R ((\\alpha R)^2 + V^2)^{-1/2} \\right) = -\\alpha^2 \\left( \\frac{1}{\\sqrt{(\\alpha R)^2+V^2}} - \\frac{\\alpha^2 R^2}{((\\alpha R)^2+V^2)^{3/2}} \\right)\n$$\n$$\n\\frac{d^2E_{-}}{dR^2} = -\\alpha^2 \\frac{((\\alpha R)^2+V^2) - \\alpha^2 R^2}{((\\alpha R)^2+V^2)^{3/2}} = -\\frac{\\alpha^2 V^2}{((\\alpha R)^2+V^2)^{3/2}}\n$$\n在 $R=0$ 处的局部曲率是此二階导数在 $R=0$ 处的值：\n$$\n\\left.\\frac{d^2E_{-}}{dR^2}\\right|_{R=0} = -\\frac{\\alpha^2 V^2}{(V^2)^{3/2}} = -\\frac{\\alpha^2 V^2}{|V|^3} = -\\frac{\\alpha^2}{|V|}\n$$\n曲率的符号为负（因为 $\\alpha^2 \\ge 0$ 且 $|V|>0$）。在一阶导数为零的点，负曲率表示一个局部极大值。因此，下绝热面 $E_{-}(R)$ 在避免交叉点 $R=0$ 处有一个势垒。", "answer": "$$\n\\boxed{2|V|}\n$$", "id": "2655278"}, {"introduction": "在理解了非绝热跃迁发生的区域之后，下一个关键问题是如何在模拟中处理这一事件。这个练习聚焦于最少切换表面跳跃（FSSH）算法的核心机制：跃迁发生时核动量的调整。你将推导出一个在满足总能量守恒和动量最小改变量原则下的动量更新规则，这项练习让你洞悉物理原理如何转化为具体的算法步骤，这对于实现或深入理解表面跳跃模拟至关重要[@problem_id:2655257]。", "problem": "考虑一个由 $N$ 个耦合核自由度组成的体系，该体系在原子单位下，具有一个对称正定质量矩阵 $M \\in \\mathbb{R}^{N \\times N}$ 和核动量 $p \\in \\mathbb{R}^{N}$，并在绝热电子态 $i$ 上演化。在某一构型 $R$ 处，该体系尝试进行一次到电子态 $j$ 的非绝热跃迁（跳跃），其能量差为 $\\Delta E = E_{j}(R) - E_{i}(R)$，其中 $E_{i}(R)$ 和 $E_{j}(R)$ 是绝热电子能量。令 $d_{ij}(R) \\in \\mathbb{R}^{N}$ 表示跃迁点处的非绝热耦合矢量。\n\n假设遵循最少开关曲面跳跃的以下建模原则：(i) 跃迁过程中总能量守恒，(ii) 仅调整核动量沿非绝热耦合方向的分量，以及 (iii) 在所有满足能量守恒的此类调整中，选择动量大小变化最小的那一个。这些原则意味着一个形式为 $p' = p + \\alpha\\, M d_{ij}(R)$ 的允许更新，其中 $\\alpha \\in \\mathbb{R}$ 为某个标量，$p'$ 是跃迁后的动量。\n\n仅从动能的二次型 $T(p) = \\tfrac{1}{2} p^{\\mathsf{T}} M^{-1} p$ 和能量守恒要求 $T(p') + E_{j}(R) = T(p) + E_{i}(R)$ 出发，推导 $p'$ 的闭式表达式以及一个标量判别式，该判别式的符号决定了是否存在实数值的 $\\alpha$。如果在所述的可行性条件下，没有实数值的 $\\alpha$ 满足能量守恒，则称该跃迁为受阻跃迁。\n\n将你的最终答案表示为一个数对，该数对由更新后的动量 $p'$ 和判别式 $D$ 组成，并以 $M$、$p$、$d_{ij}(R)$ 和 $\\Delta E$ 表示。你可以使用符号函数 $\\operatorname{sgn}(\\cdot)$ 来编码最小变化的选择。无需进行数值计算。将你的结果以单一符号表达式的形式给出。", "solution": "问题要求在最少开关曲面跳跃的原则下，推导更新后的核动量 $p'$ 和相关的判别式 $D$。推导从总能量守恒的基本原则开始。\n\n跃迁前的总能量为 $E_{total} = T(p) + E_{i}(R)$，跃迁后的总能量为 $E'_{total} = T(p') + E_{j}(R)$。动能由二次型 $T(p) = \\frac{1}{2} p^{\\mathsf{T}} M^{-1} p$ 给出。\n原则(i)，总能量守恒，要求 $E_{total} = E'_{total}$：\n$$T(p) + E_{i}(R) = T(p') + E_{j}(R)$$\n重排此方程得到动能的变化：\n$$T(p') - T(p) = E_{i}(R) - E_{j}(R) = -\\Delta E$$\n代入动能函数的定义：\n$$\\frac{1}{2} (p')^{\\mathsf{T}} M^{-1} p' - \\frac{1}{2} p^{\\mathsf{T}} M^{-1} p = -\\Delta E$$\n原则(ii)指出，更新后的动量 $p'$ 具有形式 $p' = p + \\alpha M d_{ij}$，其中 $\\alpha \\in \\mathbb{R}$ 为某个标量，$d_{ij}$ 是 $d_{ij}(R)$ 的简写。我们将这个 $p'$ 的表达式代入能量守恒方程：\n$$\\frac{1}{2} (p + \\alpha M d_{ij})^{\\mathsf{T}} M^{-1} (p + \\alpha M d_{ij}) - \\frac{1}{2} p^{\\mathsf{T}} M^{-1} p = -\\Delta E$$\n我们展开第一项。由于质量矩阵 $M$ 是对称的（$M^{\\mathsf{T}} = M$），我们有：\n$$(p + \\alpha M d_{ij})^{\\mathsf{T}} M^{-1} (p + \\alpha M d_{ij}) = (p^{\\mathsf{T}} + \\alpha d_{ij}^{\\mathsf{T}} M^{\\mathsf{T}}) M^{-1} (p + \\alpha M d_{ij})$$\n$$= (p^{\\mathsf{T}} + \\alpha d_{ij}^{\\mathsf{T}} M) (M^{-1}p + \\alpha d_{ij})$$\n$$= p^{\\mathsf{T}} M^{-1} p + \\alpha p^{\\mathsf{T}} d_{ij} + \\alpha d_{ij}^{\\mathsf{T}} M M^{-1} p + \\alpha^2 d_{ij}^{\\mathsf{T}} M d_{ij}$$\n中间两项是相等的，因为 $d_{ij}^{\\mathsf{T}} p = (p^{\\mathsf{T}} d_{ij})^{\\mathsf{T}}$，并且由于这是一个标量，它等于其自身的转置 $p^{\\mathsf{T}} d_{ij}$。展开式简化为：\n$$p^{\\mathsf{T}} M^{-1} p + 2\\alpha (p^{\\mathsf{T}} d_{ij}) + \\alpha^2 (d_{ij}^{\\mathsf{T}} M d_{ij})$$\n将此代回能量方程：\n$$\\frac{1}{2} \\left[ p^{\\mathsf{T}} M^{-1} p + 2\\alpha (p^{\\mathsf{T}} d_{ij}) + \\alpha^2 (d_{ij}^{\\mathsf{T}} M d_{ij}) \\right] - \\frac{1}{2} p^{\\mathsf{T}} M^{-1} p = -\\Delta E$$\n$p^{\\mathsf{T}} M^{-1} p$ 项相消：\n$$\\alpha (p^{\\mathsf{T}} d_{ij}) + \\frac{1}{2} \\alpha^2 (d_{ij}^{\\mathsf{T}} M d_{ij}) = -\\Delta E$$\n这可以重排为关于 $\\alpha$ 的标准二次方程，形式为 $A_q \\alpha^2 + B_q \\alpha + C_q = 0$：\n$$\\left( \\frac{1}{2} d_{ij}^{\\mathsf{T}} M d_{ij} \\right) \\alpha^2 + \\left( p^{\\mathsf{T}} d_{ij} \\right) \\alpha + \\Delta E = 0$$\n系数为：\n$A_q = \\frac{1}{2} d_{ij}^{\\mathsf{T}} M d_{ij}$\n$B_q = p^{\\mathsf{T}} d_{ij}$\n$C_q = \\Delta E$\n\n关于 $\\alpha$ 的实数解存在的充要条件是这个二次方程的判别式为非负数。这就是问题所要求的判别式。我们称之为 $D$。\n$$D = B_q^2 - 4 A_q C_q = (p^{\\mathsf{T}} d_{ij})^2 - 4 \\left( \\frac{1}{2} d_{ij}^{\\mathsf{T}} M d_{ij} \\right) (\\Delta E)$$\n$$D = (p^{\\mathsf{T}} d_{ij})^2 - 2 \\Delta E (d_{ij}^{\\mathsf{T}} M d_{ij})$$\n如果 $D < 0$，则跃迁是受阻的，因为没有实数 $\\alpha$ 能满足能量守恒。\n如果 $D \\ge 0$，$\\alpha$ 的解由二次求根公式给出：\n$$\\alpha = \\frac{-B_q \\pm \\sqrt{D}}{2 A_q} = \\frac{-(p^{\\mathsf{T}} d_{ij}) \\pm \\sqrt{(p^{\\mathsf{T}} d_{ij})^2 - 2 \\Delta E (d_{ij}^{\\mathsf{T}} M d_{ij})}}{d_{ij}^{\\mathsf{T}} M d_{ij}}$$\n原则(iii)要求选择对应动量大小变化最小的解。动量的变化是 $\\Delta p = p' - p = \\alpha M d_{ij}$。其大小由 $|\\alpha|$ 决定，因为 $\\| \\Delta p \\| = \\| \\alpha M d_{ij} \\| = |\\alpha| \\cdot \\| M d_{ij} \\|$。为使变化最小，我们必须选择绝对值较小的根 $\\alpha$。\n\n设两个根为 $\\alpha_1 = \\frac{-B_q + \\sqrt{D}}{2A_q}$ 和 $\\alpha_2 = \\frac{-B_q - \\sqrt{D}}{2A_q}$。\n我们通过考虑 $B_q = p^{\\mathsf{T}} d_{ij}$ 的符号来分析哪个根的绝对值更小。\n系数 $A_q = \\frac{1}{2} d_{ij}^{\\mathsf{T}} M d_{ij}$ 是严格为正的，因为 $M$ 是正定的且 $d_{ij}$ 非零。\n- 如果 $B_q > 0$，则 $-B_q$ 为负。$\\alpha_2$ 的分子是 $-B_q - \\sqrt{D}$，是一个负项与一个非正项的和。$\\alpha_1$ 的分子是 $-B_q + \\sqrt{D}$，它表示一个差。因此，$|-B_q + \\sqrt{D}| < |-B_q - \\sqrt{D}|$，这意味着 $|\\alpha_1| < |\\alpha_2|$。正确的选择是 $\\alpha_1$。\n- 如果 $B_q < 0$，则 $-B_q$ 为正。$\\alpha_1$ 的分子是 $-B_q + \\sqrt{D}$，是一个正项与一个非负项的和。$\\alpha_2$ 的分子是 $-B_q - \\sqrt{D}$，是一个差。因此，$|-B_q - \\sqrt{D}| < |-B_q + \\sqrt{D}|$，且 $|\\alpha_2| < |\\alpha_1|$。正确的选择是 $\\alpha_2$。\n- 如果 $B_q = 0$，两个根为 $\\alpha = \\pm \\frac{\\sqrt{D}}{2A_q}$，它们的绝对值相等。最小变化原则不足以得出唯一选择。但是，题目允许使用 $\\operatorname{sgn}(\\cdot)$ 函数，这表明可以采用一个约定。\n\n根的选择可以使用符号函数 $\\operatorname{sgn}(B_q)$ 来紧凑地表示。\n所选的根具有形式 $\\frac{-B_q + \\operatorname{sgn}(B_q) \\sqrt{D}}{2 A_q}$。\n- 如果 $B_q > 0$，$\\operatorname{sgn}(B_q)=1$，我们得到 $\\frac{-B_q + \\sqrt{D}}{2A_q}$，即 $\\alpha_1$。\n- 如果 $B_q < 0$，$\\operatorname{sgn}(B_q)=-1$，我们得到 $\\frac{-B_q - \\sqrt{D}}{2A_q}$，即 $\\alpha_2$。\n- 如果 $B_q = 0$，定义 $\\operatorname{sgn}(0)=1$ 提供了一个唯一的选择，$\\alpha = \\frac{\\sqrt{D}}{2A_q}$。这解决了模糊性。\n\n因此，所选的 $\\alpha$ 值为：\n$$\\alpha = \\frac{-(p^{\\mathsf{T}} d_{ij}) + \\operatorname{sgn}(p^{\\mathsf{T}} d_{ij}) \\sqrt{(p^{\\mathsf{T}} d_{ij})^2 - 2 \\Delta E (d_{ij}^{\\mathsf{T}} M d_{ij})}}{d_{ij}^{\\mathsf{T}} M d_{ij}}$$\n最后，我们将这个 $\\alpha$ 的表达式代入 $p'$ 的形式中，以获得跃迁后动量的最终闭式表达式：\n$$p' = p + \\left( \\frac{-(p^{\\mathsf{T}} d_{ij}) + \\operatorname{sgn}(p^{\\mathsf{T}} d_{ij}) \\sqrt{(p^{\\mathsf{T}} d_{ij})^2 - 2 \\Delta E (d_{ij}^{\\mathsf{T}} M d_{ij})}}{d_{ij}^{\\mathsf{T}} M d_{ij}} \\right) M d_{ij}$$\n所要求的两个量是这个 $p'$ 的表达式和判别式 $D$。", "answer": "$$ \\boxed{ \\begin{pmatrix} p + \\left( \\frac{-(p^{\\mathsf{T}} d_{ij}) + \\operatorname{sgn}(p^{\\mathsf{T}} d_{ij}) \\sqrt{(p^{\\mathsf{T}} d_{ij})^{2} - 2 \\Delta E (d_{ij}^{\\mathsf{T}} M d_{ij})}}{d_{ij}^{\\mathsf{T}} M d_{ij}} \\right) M d_{ij} & (p^{\\mathsf{T}} d_{ij})^{2} - 2 \\Delta E (d_{ij}^{\\mathsf{T}} M d_{ij}) \\end{pmatrix} } $$", "id": "2655257"}, {"introduction": "最后的练习将理论与计算实践相结合，让你通过编程来验证核心概念。本题要求你为经典的 Landau-Zener 模型数值求解含时薛定谔方程（TDSE）。通过将精确的数值解与 FSSH 中使用的著名解析公式进行比较，你不仅可以验证理论的正确性，还能对不同模拟方法的准确性和适用范围获得更深刻的定量认识[@problem_id:2655262]。", "problem": "考虑一个在非绝热表象下的两能级 Landau–Zener 模型，其含时电子哈密顿量由下式给出：\n$$\nH(t) = \\begin{pmatrix}\n\\frac{v\\,t}{2} & \\Delta\\\\\n\\Delta & -\\frac{v\\,t}{2}\n\\end{pmatrix},\n$$\n其中，$t$ 是时间，$\\Delta > 0$ 是一个恒定的非绝热耦合，而 $v > 0$ 是非绝热能量差的扫描速率。假设约化普朗克常数为 $ \\hbar = 1 $。绝热本征能量为 $ \\pm \\varepsilon(t) $，其中 $ \\varepsilon(t) = \\sqrt{\\Delta^2 + \\left(\\frac{v\\,t}{2}\\right)^2} $。对于足够大的 $|t|$，绝热基矢与非绝热基矢在相差一个相位因子的情况下重合，瞬时绝热态是 $H(t)$ 的本征矢量。\n\n从第一性原理出发，使用含时薛定谔方程 (TDSE)，\n$$\ni \\frac{d}{dt} \\Psi(t) = H(t)\\, \\Psi(t),\n$$\n来计算渐近电子布居数，其定义如下：在远小于零的负时间 $t_0 \\ll 0$ 时，将电子态初始化为绝热基态，然后传播到远大于零的正时间 $t_f \\gg 0$，并投影到 $t_f$ 时的绝热激发态上。该投影的模方即为渐近激发态绝热布居数。在混合量子-经典方法的背景下，对于与上述线性时间依赖性相对应的指定经典轨迹 $x(t)$，Ehrenfest 动力学预测的电子演化与 TDSE 对此两能级模型预测的相同，因为沿着给定路径，电子振幅在相同的哈密顿量下演化。对于 Fewest Switches Surface Hopping (FSSH)，在以恒定扫描速率 $v$ 单次通过一个避免交叉且无反射的情况下，绝热态之间的渐近非绝热跃迁概率是，作为此标准模型中一个经过充分检验的事实，\n$$\nP_{\\mathrm{FSSH}} = \\exp\\left( -\\frac{2\\pi \\Delta^2}{v} \\right).\n$$\n您必须为每组参数 $(\\Delta, v)$ 计算三个量：\n- $P_{\\mathrm{EH}}$：由 Ehrenfest 动力学预测的渐近激发态绝热布居数，通过从 $t_0$ 到 $t_f$ 数值积分 TDSE 获得，其中初始条件为 $t_0$ 时的瞬时绝热基态，然后将最终波函数投影到 $t_f$ 时的瞬时绝热激发态上。\n- $P_{\\mathrm{FSSH}}$：使用上述公式得出的 Fewest Switches Surface Hopping 预测值。\n- $P_{\\mathrm{exact}}$：通过如 $P_{\\mathrm{EH}}$ 所述的数值积分 TDSE 获得的精确量子结果。\n\n请采用以下原则性的数值方案，以确保渐近条件和准确性，而不在传播过程中依赖快捷公式：\n- 选择 $t_0 = -T$ 和 $t_f = +T$，其中 $T$ 足够大以至于 $|v T| \\gg \\Delta$。一个稳健的选择是 $T = \\max(20, 40\\,\\Delta/v)$。\n- 在非绝热基矢下，使用高精度时间积分器对 TDSE 进行积分，其绝对和相对容差分别不劣于 $10^{-10}$ 和 $10^{-8}$，并确保波函数范数与 1 的差值保持在 $10^{-8}$ 以内。\n- 定义初始条件 $\\Psi(t_0)$ 为 $H(t_0)$ 的绝热基态本征矢量，并计算最终到 $H(t_f)$ 的绝热激发态本征矢量的投影，将内积的模方作为布居数。\n\n问题中不出现角度，除了采用的约定 $ \\hbar = 1 $ 外没有其他物理单位，因此不需要单位转换。所有概率都表示为保留六位小数的十进制数。\n\n测试套件：\n为以下每组参数 $(\\Delta, v)$ 计算三元组 $\\left(P_{\\mathrm{EH}}, P_{\\mathrm{FSSH}}, P_{\\mathrm{exact}}\\right)$：\n1. $(\\Delta, v) = (0.1, 1.0)$\n2. $(\\Delta, v) = (0.5, 1.0)$\n3. $(\\Delta, v) = (0.5, 0.2)$\n4. $(\\Delta, v) = (1.0, 5.0)$\n\n最终输出格式：\n您的程序应生成单行输出，其中包含用方括号括起来的、以逗号分隔的结果列表。对于每个测试用例，按 $[P_{\\mathrm{EH}}, P_{\\mathrm{FSSH}}, P_{\\mathrm{exact}}]$ 的顺序列出三个四舍五入后的概率，并将所有用例按上述顺序串联成一个扁平列表。例如，输出必须如下所示：\n\"[EH1,FSSH1,EXACT1,EH2,FSSH2,EXACT2,EH3,FSSH3,EXACT3,EH4,FSSH4,EXACT4]\"\n每个条目都四舍五入到六位小数。", "solution": "该问题要求计算两能级 Landau-Zener 系统的非绝热跃迁概率。首先评估问题陈述的有效性。\n\n### 问题验证\n\n**第 1 步：提取已知条件**\n-   **哈密顿量**：含时非绝热哈密顿量为 $H(t) = \\begin{pmatrix} \\frac{v\\,t}{2} & \\Delta\\\\ \\Delta & -\\frac{v\\,t}{2} \\end{pmatrix}$。\n-   **参数**：非绝热耦合 $\\Delta > 0$，扫描速率 $v > 0$。\n-   **常数**：约化普朗克常数 $\\hbar = 1$。\n-   **绝热能量**：$\\pm \\varepsilon(t)$，其中 $\\varepsilon(t) = \\sqrt{\\Delta^2 + \\left(\\frac{v\\,t}{2}\\right)^2}$。\n-   **运动方程**：含时薛定谔方程 (TDSE)，$i \\frac{d}{dt} \\Psi(t) = H(t)\\, \\Psi(t)$。\n-   **过程**：系统在 $t_0 \\ll 0$ 时初始化于绝热基态，传播至 $t_f \\gg 0$，然后最终态投影到 $t_f$ 时的绝热激发态。该投影的模方即为所求布居数。\n-   **待计算量**：\n    1.  $P_{\\mathrm{EH}}$：来自 Ehrenfest 动力学的渐近激发态绝热布居数，对于此模型，这等同于 TDSE 的直接数值解。\n    2.  $P_{\\mathrm{FSSH}}$：Fewest Switches Surface Hopping 非绝热跃迁概率，由解析公式 $P_{\\mathrm{FSSH}} = \\exp\\left( -\\frac{2\\pi \\Delta^2}{v} \\right)$ 给出。\n    3.  $P_{\\mathrm{exact}}$：精确量子结果，定义为通过与 $P_{\\mathrm{EH}}$ 相同的数值 TDSE 积分获得。\n-   **数值方案**：\n    -   积分时间：$t_0 = -T$, $t_f = +T$，其中 $T = \\max(20, 40\\,\\Delta/v)$。\n    -   积分器容差：`atol` $\\le 10^{-10}$，`rtol` $\\le 10^{-8}$。\n    -   初始条件：$\\Psi(t_0)$ 是 $H(t_0)$ 的瞬时绝热基态本征矢量。\n    -   最终观测量：$H(t_f)$ 的瞬时绝热激发态本征矢量中的布居数。\n-   **测试套件**：$(\\Delta, v)$ 对：$(0.1, 1.0)$、$(0.5, 1.0)$、$(0.5, 0.2)$、$(1.0, 5.0)$。\n\n**第 2 步：使用提取的已知条件进行验证**\n-   **科学依据**：该问题在根本上是合理的。它基于 Landau-Zener 模型（非绝热动力学的基石）和 TDSE（量子力学的基本方程）。$P_{\\mathrm{FSSH}}$ 的公式是众所周知的解析 Landau-Zener 跃迁概率，已知 FSSH 在此模型中能重现该结果。关于对于具有指定路径的电子子系统，Ehrenfest 动力学与 TDSE 等价的陈述是正确的。\n-   **适定性**：该问题是适定的。它提供了清晰的初始状态、确定性的演化方程以及待测量量的精确定义。数值方案指定了获得唯一稳定解所需的所有参数。\n-   **客观性**：问题以精确、客观和标准的科学语言陈述。\n-   **缺陷分析**：\n    -   问题指出，$P_{\\mathrm{EH}}$ 和 $P_{\\mathrm{exact}}$ 要通过 a) TDSE 积分计算，并且 b) 分别与 Ehrenfest 动力学和精确量子动力学相关。鉴于预设的经典路径，这两者确实是相同的。这不是一个逻辑缺陷，而是一种测试理解的方式，即对于此模型，Ehrenfest 的电子运动方程就是 TDSE。\n    -   问题正确地将非绝热跃迁概率（从绝热基态到绝热激发态）与解析的 Landau-Zener 公式（标记为 $P_{\\mathrm{FSSH}}$）对应起来。这是一致的。\n    -   不存在其他如不完整性、矛盾或不可行性等缺陷。\n\n**第 3 步：结论与行动**\n问题是 **有效的**。将提供一个解决方案。\n\n### 解法推导\n\n中心任务是求解态矢量 $\\Psi(t) = \\begin{pmatrix} c_1(t) \\\\ c_2(t) \\end{pmatrix}$ 的 TDSE, $i \\frac{d\\Psi}{dt} = H(t)\\Psi$。通过将复系数 $c_k(t)$ 分解为实部和虚部 $c_k(t) = c_{k,R}(t) + i c_{k,I}(t)$，这可以被表述为一个由四个实值一阶常微分方程 (ODE) 组成的系统。待积分的系统是：\n$$\n\\frac{d}{dt} \\begin{pmatrix} c_{1,R} \\\\ c_{1,I} \\\\ c_{2,R} \\\\ c_{2,I} \\end{pmatrix} = \\begin{pmatrix} 0 & \\frac{vt}{2} & 0 & \\Delta \\\\ -\\frac{vt}{2} & 0 & -\\Delta & 0 \\\\ 0 & \\Delta & 0 & -\\frac{vt}{2} \\\\ -\\Delta & 0 & \\frac{vt}{2} & 0 \\end{pmatrix} \\begin{pmatrix} c_{1,R} \\\\ c_{1,I} \\\\ c_{2,R} \\\\ c_{2,I} \\end{pmatrix}\n$$\n该系统从 $t_0 = -T$ 积分到 $t_f = T$。\n\n**初始和最终状态**：初始状态 $\\Psi(t_0)$ 和最终投影状态必须是 $H(t)$ 的瞬时绝热本征矢量。这些本征矢量的数值稳定表示是使用混合角形式推导出来的。哈密顿量可以写成 $H(t) = \\varepsilon(t) (\\cos\\alpha(t)\\sigma_z + \\sin\\alpha(t)\\sigma_x)$，其中 $\\sigma_i$ 是泡利矩阵，$\\cos\\alpha(t) = (vt/2)/\\varepsilon(t)$ 且 $\\sin\\alpha(t) = \\Delta/\\varepsilon(t)$。对应于本征值 $\\mp\\varepsilon(t)$（基态/激发态）的归一化本征矢量是：\n$$\n\\Psi_{GS}(t) = \\begin{pmatrix} -\\sin(\\alpha(t)/2) \\\\ \\cos(\\alpha(t)/2) \\end{pmatrix} \\quad , \\quad \\Psi_{ES}(t) = \\begin{pmatrix} \\cos(\\alpha(t)/2) \\\\ \\sin(\\alpha(t)/2) \\end{pmatrix}\n$$\n其中 $\\alpha(t) = \\arctan_2(\\Delta, vt/2)$ 确保了正确的相位。分量 $\\cos(\\alpha/2)$ 和 $\\sin(\\alpha/2)$ 使用半角恒等式进行稳健计算。\n\n-   **初始条件**：系统在 $t_0 = -T$ 时从绝热基态开始。初始态矢量为 $\\Psi(t_0) = \\Psi_{GS}(-T)$。\n-   **数值积分**：我们使用一个高阶自适应步长积分器（DOP853，一个 8 阶 Dormand-Prince 方法），并采用严格的容差（`rtol=1e-8`, `atol=1e-10`）来求解该 ODE 系统，从而得到最终的态矢量 $\\Psi(t_f)$。\n-   **最终投影**：问题要求计算在 $t_f=T$ 时处于绝热激发态的布居数。这是通过将最终状态 $\\Psi(t_f)$ 投影到目标本征矢量 $\\Psi_{ES}(T)$ 上来计算的。概率是此投影的模方：\n    $$\n    P = \\left| \\langle \\Psi_{ES}(T) | \\Psi(T) \\rangle \\right|^2 = \\left| (\\Psi_{ES}(T))^\\dagger \\Psi(T) \\right|^2\n    $$\n这个数值上获得的概率根据问题定义同时给出了 $P_{\\mathrm{EH}}$ 和 $P_{\\mathrm{exact}}$。$P_{\\mathrm{FSSH}}$ 是通过其解析公式独立计算的。数值结果与解析结果之间的紧密一致性可作为对该实现的一种验证。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for all test cases and print the results.\n    \"\"\"\n\n    def get_adiabatic_eigenvectors(t, delta, v):\n        \"\"\"\n        Computes the instantaneous adiabatic ground and excited state eigenvectors\n        of the Landau-Zener Hamiltonian for a given time t.\n\n        The method uses a numerically stable mixing angle representation.\n        The Hamiltonian is H(t) = (vt/2)sigma_z + delta*sigma_x.\n        We find the angle alpha such that cos(alpha) = (vt/2)/eps and sin(alpha) = delta/eps.\n        The eigenvectors of cos(alpha)sigma_z + sin(alpha)sigma_x are used.\n        \"\"\"\n        vt_half = v * t / 2.0\n        # Use np.hypot for stable calculation of the norm\n        epsilon = np.hypot(delta, vt_half)\n\n        # A small epsilon can lead to division by zero if delta and t are both zero.\n        if epsilon == 0.0:\n            # At t=0, delta=0, H is zero matrix. Any vector is an eigenvector.\n            # However, delta > 0 is a premise. This case is for robustness.\n            # At t=0, delta > 0, cos_alpha is 0.\n            return np.array([ -np.sqrt(0.5), np.sqrt(0.5)], dtype=complex), \\\n                   np.array([ np.sqrt(0.5), np.sqrt(0.5)], dtype=complex)\n\n        cos_alpha = vt_half / epsilon\n        \n        # Using half-angle identities for numerical stability.\n        # cos(alpha/2)^2 = (1+cos(alpha))/2\n        # sin(alpha/2)^2 = (1-cos(alpha))/2\n        # Since delta > 0, sin(alpha) = delta/epsilon is always non-negative.\n        # This implies alpha is in [0, pi], so alpha/2 is in [0, pi/2].\n        # Thus, sin(alpha/2) is always non-negative.\n        cos_half_alpha = np.sqrt((1.0 + cos_alpha) / 2.0)\n        sin_half_alpha = np.sqrt((1.0 - cos_alpha) / 2.0)\n        \n        psi_gs = np.array([-sin_half_alpha, cos_half_alpha], dtype=complex)\n        psi_es = np.array([cos_half_alpha, sin_half_alpha], dtype=complex)\n        \n        return psi_gs, psi_es\n\n    def calculate_probabilities(delta, v):\n        \"\"\"\n        Solves the TDSE for the Landau-Zener problem for a given (delta, v) pair.\n        Returns the triplet (P_EH, P_FSSH, P_exact).\n        \"\"\"\n        # 1. Set up integration time T according to the specified protocol.\n        T = max(20.0, 40.0 * delta / v)\n        t_span = [-T, T]\n\n        # 2. Define the RHS of the TDSE for a real-valued 4-component vector.\n        # The equation is d(psi)/dt = -i*H*psi.\n        # Let psi = c_R + i*c_I. Then d(c_R)/dt = H*c_I and d(c_I)/dt = -H*c_R.\n        def tdse_rhs(t, y, delta_p, v_p):\n            h11 = v_p * t / 2.0\n            h22 = -v_p * t / 2.0\n            h12 = delta_p\n            \n            c1r, c1i, c2r, c2i = y\n            \n            dc1r_dt = h11 * c1i + h12 * c2i\n            dc1i_dt = -h11 * c1r - h12 * c2r\n            dc2r_dt = h12 * c1i + h22 * c2i # H is symmetric, h21 = h12\n            dc2i_dt = -h12 * c1r - h22 * c2r\n        \n            return np.array([dc1r_dt, dc1i_dt, dc2r_dt, dc2i_dt])\n\n        # 3. Define the initial condition: Adiabatic ground state at t = -T.\n        psi_gs_initial, _ = get_adiabatic_eigenvectors(-T, delta, v)\n        # The initial state is real-valued in this representation.\n        y0 = np.array([psi_gs_initial[0].real, 0.0, psi_gs_initial[1].real, 0.0])\n\n        # 4. Integrate the TDSE using a high-accuracy solver.\n        sol = solve_ivp(\n            fun=tdse_rhs,\n            t_span=t_span,\n            y0=y0,\n            args=(delta, v),\n            method='DOP853',\n            rtol=1e-8,\n            atol=1e-10\n        )\n\n        # 5. Reconstruct the complex final wavefunction from the real vector.\n        y_final = sol.y[:, -1]\n        psi_final = np.array([y_final[0] + 1j * y_final[1], y_final[2] + 1j * y_final[3]])\n\n        # 6. Verify norm conservation as a sanity check.\n        norm_final = np.linalg.norm(psi_final)\n        if not np.isclose(norm_final, 1.0, atol=1e-8):\n            # This check is good practice but not expected to fail with these settings.\n            raise ValueError(f\"Wavefunction norm conservation failed: norm = {norm_final}\")\n\n        # 7. Define the target state: Adiabatic excited state at t = T.\n        _, psi_es_final = get_adiabatic_eigenvectors(T, delta, v)\n\n        # 8. Compute the projection and the resulting probability.\n        # P = |<psi_ES(T)|psi(T)>|^2\n        projection = np.vdot(psi_es_final, psi_final)\n        prob_exact = np.abs(projection)**2\n        # As per the problem, P_EH is computed identically to P_exact.\n        prob_eh = prob_exact\n\n        # 9. Compute P_FSSH from the analytical Landau-Zener formula.\n        prob_fssh = np.exp(-2.0 * np.pi * delta**2 / v)\n\n        return prob_eh, prob_fssh, prob_exact\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (0.1, 1.0),\n        (0.5, 1.0),\n        (0.5, 0.2),\n        (1.0, 5.0)\n    ]\n\n    all_results = []\n    for delta_val, v_val in test_cases:\n        p_eh, p_fssh, p_exact = calculate_probabilities(delta_val, v_val)\n        all_results.extend([\n            round(p_eh, 6),\n            round(p_fssh, 6),\n            round(p_exact, 6)\n        ])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, all_results))}]\")\n\nsolve()\n```", "id": "2655262"}]}