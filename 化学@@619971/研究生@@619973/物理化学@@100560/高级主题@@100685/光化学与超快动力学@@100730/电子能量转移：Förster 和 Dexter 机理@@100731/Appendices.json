{"hands_on_practices": [{"introduction": "这项基础练习将引导你探索福斯特共振能量转移（FRET）的核心动力学。通过从给定的基本物理事实出发，推导和计算能量转移速率及效率 [@problem_id:2637333]，你将建立起关于距离如何调控能量转移过程的坚实定量理解。这是掌握FRET作为“光谱尺”应用的第一步。", "problem": "考虑一个供体-受体对，其经历了以电偶极-偶极耦合为主导的长程电子能量转移，即 Förster 共振能量转移 (FRET)。在没有任何受体存在的情况下，供体的未猝灭激发态寿命为 $\\tau_D = 4\\,\\text{ns}$。供体-受体中心间距为 $R = 5\\,\\text{nm}$。该对的 Förster 半径 $R_0$ 为 $R_0 = 6\\,\\text{nm}$。仅使用以下基本事实：\n- 对于 FRET 中的偶极-偶极耦合，转移速率与距离的负六次方成反比。\n- Förster 半径 $R_0$ 被定义为能量转移速率等于供体自然（未猝灭）衰变速率时的间距。\n- 独立的一级衰变通道的速率在线性相加后得到总衰变速率，分支分数等于各通道速率与总速率之比。\n\n任务：\n1. 从这些事实出发，推导 FRET 转移速率 $k_F(R)$ 关于 $\\tau_D$、$R_0$ 和 $R$ 的表达式。\n2. 使用给定参数数值计算 $k_F(R)$，速率单位为 $\\text{s}^{-1}$。\n3. 利用供体自然衰变和 FRET 之间的动力学竞争，推导 FRET 效率 $E(R)$ 的表达式，并使用给定参数进行数值计算。\n\n将最终答案报告为效率 $E(R)$，一个无量纲数，四舍五入到四位有效数字。如果计算中间量，请将所有速率表示为 $\\text{s}^{-1}$，所有时间表示为 $\\text{s}$。", "solution": "在尝试任何解答之前，首先对问题陈述进行验证。\n\n首先，逐字提取已知条件：\n- 过程：以电偶极-偶极耦合为主导的长程电子能量转移 (FRET)。\n- 供体未猝灭激发态寿命：$\\tau_D = 4\\,\\text{ns}$。\n- 供体-受体间距：$R = 5\\,\\text{nm}$。\n- Förster 半径：$R_0 = 6\\,\\text{nm}$。\n- 基本事实 1：对于 FRET 中的偶极-偶极耦合，转移速率与距离的负六次方成反比。\n- 基本事实 2：Förster 半径 $R_0$ 被定义为能量转移速率等于供体自然（未猝灭）衰变速率时的间距。\n- 基本事实 3：独立的一级衰变通道的速率在线性相加后得到总衰变速率，分支分数等于各通道速率与总速率之比。\n\n接下来，对这些已知条件进行验证。该问题具有科学依据，因为它使用既定的理论框架描述了 Förster 共振能量转移。速率对距离的负六次方依赖关系、Förster 半径的定义以及动力学竞争模型都是物理化学中基本且正确的原理。该问题提法恰当，为获得唯一解提供了所有必要信息。语言客观而精确。所提供的数值（$\\tau_D$, $R$, $R_0$）对于典型分子体系是物理上现实的。该问题是一个标准的、不简单的练习，需要正确应用第一性原理。未发现任何缺陷。该问题被认为是有效的。\n\n解答过程按顺序处理三个任务。\n\n任务 1：推导 FRET 转移速率 $k_F(R)$。\n根据第一个基本事实，FRET 速率 $k_F$ 与供体-受体间距 $R$ 的负六次方成正比。这可以写成：\n$$k_F(R) = C R^{-6}$$\n其中 $C$ 是比例常数。\n\n为了确定这个常数，我们使用第二个基本事实。Förster 半径 $R_0$ 是 FRET 速率等于供体自然衰变速率 $k_D$ 时的距离。自然衰变速率是未猝灭寿命 $\\tau_D$ 的倒数：\n$$k_D = \\frac{1}{\\tau_D}$$\n根据定义，在 $R = R_0$ 时：\n$$k_F(R_0) = k_D = \\frac{1}{\\tau_D}$$\n将 $R = R_0$ 代入我们的速率表达式中得到：\n$$k_F(R_0) = C R_0^{-6}$$\n将这两个表达式相等，我们可以求出 $C$：\n$$C R_0^{-6} = \\frac{1}{\\tau_D} \\implies C = \\frac{R_0^6}{\\tau_D}$$\n将 $C$ 的这个表达式代回 $k_F(R)$ 的一般速率定律，得到转移速率作为 $R$ 的函数的最终表达式：\n$$k_F(R) = \\left(\\frac{R_0^6}{\\tau_D}\\right) R^{-6} = \\frac{1}{\\tau_D} \\left(\\frac{R_0}{R}\\right)^6$$\n\n任务 2：数值计算 $k_F(R)$。\n问题提供了以下数值：$\\tau_D = 4\\,\\text{ns} = 4 \\times 10^{-9}\\,\\text{s}$，$R_0 = 6\\,\\text{nm}$，以及 $R = 5\\,\\text{nm}$。我们可以将这些数值代入推导出的表达式中。比值 $R_0/R$ 是无量纲的，因此距离单位是一致的。\n$$k_F(R=5\\,\\text{nm}) = \\frac{1}{4 \\times 10^{-9}\\,\\text{s}} \\left(\\frac{6\\,\\text{nm}}{5\\,\\text{nm}}\\right)^6$$\n$$k_F(R=5\\,\\text{nm}) = (2.5 \\times 10^8\\,\\text{s}^{-1}) \\times (1.2)^6$$\n$$k_F(R=5\\,\\text{nm}) = (2.5 \\times 10^8\\,\\text{s}^{-1}) \\times 2.985984$$\n$$k_F(R=5\\,\\text{nm}) \\approx 7.46496 \\times 10^8\\,\\text{s}^{-1}$$\n\n任务 3：推导并数值计算 FRET 效率 $E(R)$。\n在受体存在的情况下，供体的激发态有两个竞争的衰变通道：其自身的自然衰变（速率 $k_D$）和向受体的能量转移（速率 $k_F(R)$）。根据第三个基本事实，总衰变速率 $k_{\\text{total}}$ 是这些独立一级过程速率的总和：\n$$k_{\\text{total}} = k_D + k_F(R)$$\nFRET 效率 $E$ 定义为通过能量转移发生的供体去激发的比例。这对应于 FRET 通道的分支分数：\n$$E(R) = \\frac{k_F(R)}{k_{\\text{total}}} = \\frac{k_F(R)}{k_D + k_F(R)}$$\n现在，我们代入 $k_D$ 和 $k_F(R)$ 的表达式：\n$$E(R) = \\frac{\\frac{1}{\\tau_D} \\left(\\frac{R_0}{R}\\right)^6}{\\frac{1}{\\tau_D} + \\frac{1}{\\tau_D} \\left(\\frac{R_0}{R}\\right)^6}$$\n项 $1/\\tau_D$ 是分子和分母的公因子，因此可以消掉：\n$$E(R) = \\frac{\\left(\\frac{R_0}{R}\\right)^6}{1 + \\left(\\frac{R_0}{R}\\right)^6}$$\n为了得到一个更简洁的形式，可以将分子和分母同乘以 $R^6$：\n$$E(R) = \\frac{R_0^6}{R^6 + R_0^6}$$\n这就是 FRET 效率的一般表达式。\n\n最后，我们使用给定的数值 $R = 5\\,\\text{nm}$ 和 $R_0 = 6\\,\\text{nm}$ 对此表达式进行数值计算：\n$$E = \\frac{(6)^6}{(5)^6 + (6)^6} = \\frac{46656}{15625 + 46656} = \\frac{46656}{62281}$$\n$$E \\approx 0.74911319$$\n按要求四舍五入到四位有效数字，得到：\n$$E \\approx 0.7491$$", "answer": "$$\n\\boxed{0.7491}\n$$", "id": "2637333"}, {"introduction": "从理想理论走向实验现实，这项实践解决了一个关键问题：通过FRET测量的距离有多可靠？你将运用误差传播分析，来确定实验参数（如量子产率 $\\Phi_D$ 和光谱重叠积分 $J$）的不确定性如何影响最终计算出的福斯特距离 $R_0$ 和推断的供体-受体间距 $R$ [@problem_id:2637295]。这项练习对于批判性地评估FRET数据和理解“光谱尺”的精度限制至关重要。", "problem": "在均匀介质中研究一个表现出Förster共振能量转移（FRET）的供体-受体对。在没有受体的情况下，供体的激发态衰减以寿命 $\\,\\tau_D\\,$ 和量子产率 $\\,\\Phi_D\\,$ 为特征。从供体到受体的非辐射共振偶极-偶极转移速率 $\\,k_T\\,$ 满足 $\\,k_T \\propto \\kappa^2 r^{-6} J n^{-4}\\,$，其中 $\\,\\kappa^2\\,$ 是偶极取向因子，$\\,r\\,$ 是供体-受体间距，$\\,J\\,$ 是供体-受体光谱重叠积分，$\\,n\\,$ 是介质的折射率。Förster距离 $\\,R_0\\,$ 通过标准的FRET公式定义，该公式通过一个已知的比例常数将 $\\,R_0^6\\,$ 与 $\\,\\kappa^2\\,$, $\\,\\Phi_D\\,$, $\\,n\\,$ 和 $\\,J\\,$ 关联起来（假设此常数是精确已知的，不带来任何不确定度）。能量转移效率 $\\,E\\,$ 通过基本的动力学竞争与转移速率和供体衰减相关，因此取决于比值 $\\,R/R_0\\,$，其中 $\\,R\\,$ 是从测量的 $\\,E\\,$ 推断出的供体-受体间距。\n\n假设 $\\,\\kappa^2\\,$, $\\,n\\,$, $\\,\\Phi_D\\,$ 和 $\\,J\\,$ 是独立测量的，其相对标准不确定度很小，分别为 $\\,\\varepsilon_{\\kappa^2} \\equiv \\sigma_{\\kappa^2}/\\kappa^2\\,$, $\\,\\varepsilon_{n} \\equiv \\sigma_{n}/n\\,$, $\\,\\varepsilon_{\\Phi_D} \\equiv \\sigma_{\\Phi_D}/\\Phi_D\\,$ 和 $\\,\\varepsilon_{J} \\equiv \\sigma_{J}/J\\,$。转移效率 $\\,E\\,$ 的测量具有绝对标准不确定度 $\\,\\sigma_E\\,$，且与其他输入量无关。假设所有不确定度都很小，服从高斯分布，并且相互不相关，因此一阶（线性）不确定度传播法则适用。\n\n从导出 $\\,E\\,$ 作为 $\\,R/R_0\\,$ 函数的基本动力学定义出发，并根据 $\\,R_0\\,$ 对 $\\,\\kappa^2\\,$, $\\,\\Phi_D\\,$, $\\,n\\,$ 和 $\\,J\\,$ 的既定依赖关系，推导以下物理量的解析表达式：\n- Förster距离的相对标准不确定度 $\\,\\sigma_{R_0}/R_0\\,$，用 $\\,\\varepsilon_{\\kappa^2}\\,$, $\\,\\varepsilon_{n}\\,$, $\\,\\varepsilon_{\\Phi_D}\\,$ 和 $\\,\\varepsilon_{J}\\,$ 表示；以及\n- 推断距离的相对标准不确定度 $\\,\\sigma_{R}/R\\,$，用 $\\,\\varepsilon_{\\kappa^2}\\,$, $\\,\\varepsilon_{n}\\,$, $\\,\\varepsilon_{\\Phi_D}\\,$, $\\,\\varepsilon_{J}\\,$, $\\,E\\,$ 和 $\\,\\sigma_E\\,$ 表示。\n\n将你的最终答案表示为一个闭合形式的解析行向量 $\\,\\big(\\sigma_{R_0}/R_0\\;\\;\\sigma_{R}/R\\big)\\,$。最终表达式中不应包含单位。不需要进行数值计算或四舍五入。", "solution": "所提出的问题是关于Förster共振能量转移（FRET）这一公认光物理现象背景下不确定度传播的一个标准练习。它要求应用一阶误差分析来推导Förster距离 $R_0$ 和推断的供体-受体间距 $R$ 的相对不确定度表达式。\n\n首先，有必要对问题陈述进行验证。\n已知条件如下：\n- 无受体时供体的激发态寿命：$\\tau_D$\n- 无受体时供体的量子产率：$\\Phi_D$\n- 能量转移速率 $k_T$ 正比于 $\\kappa^2 r^{-6} J n^{-4}$。\n- Förster距离 $R_0^6$ 通过一个没有不确定度的比例常数与 $\\kappa^2$, $\\Phi_D$, $n$ 和 $J$ 相关。明确的标准关系是 $R_0^6 \\propto \\kappa^2 \\Phi_D J n^{-4}$。\n- 能量转移效率 $E$ 与比值 $R/R_0$ 相关，其中 $R$ 是推断的供体-受体间距。\n- 独立输入量的相对标准不确定度为 $\\varepsilon_{\\kappa^2} = \\sigma_{\\kappa^2}/\\kappa^2$、$\\varepsilon_{n} \\equiv \\sigma_{n}/n$、$\\varepsilon_{\\Phi_D} \\equiv \\sigma_{\\Phi_D}/\\Phi_D$ 和 $\\varepsilon_{J} \\equiv \\sigma_{J}/J$。\n- 测量的效率 $E$ 的绝对标准不确定度是 $\\sigma_E$。\n- 所有不确定度都很小，服从高斯分布且相互不相关，这使得线性误差传播方法得以应用。\n\n这个问题是有科学依据的，因为FRET理论是现代生物物理学和物理化学的基石。所提供的关系式是标准的。该问题是适定的、客观的，并包含足够的信息来推导所要求的表达式。问题中没有矛盾或模糊之处。因此，该问题被认为是有效的，可以构建解答。\n\n根据要求，解答过程分两部分进行。\n\n第1部分：推导Förster距离的相对不确定度 $\\sigma_{R_0}/R_0$。\n\nFörster距离 $R_0$ 由以下关系式定义：\n$$R_0^6 = C \\cdot \\kappa^2 \\Phi_D J n^{-4}$$\n其中 $C$ 是一个包含了基本物理常数和数值因子的常数。问题陈述 $C$ 是精确已知的，因此 $\\sigma_C = 0$。\n物理量 $R_0$ 可以表示为：\n$$R_0 = (C \\kappa^2 \\Phi_D J n^{-4})^{1/6}$$\n为求得相对不确定度 $\\sigma_{R_0}/R_0$，我们使用针对微小、不相关误差的标准传播公式。最方便的方法是从对 $R_0$ 的表达式取自然对数开始：\n$$\\ln(R_0) = \\frac{1}{6} \\left( \\ln(C) + \\ln(\\kappa^2) + \\ln(\\Phi_D) + \\ln(J) - 4\\ln(n) \\right)$$\n对于微小不确定度，$\\ln(R_0)$ 的方差与相对不确定度的平方 $(\\sigma_{R_0}/R_0)^2$ 相关。通过微分并将独立变量的方差进行平方和叠加，我们得到：\n$$(\\sigma_{\\ln(R_0)})^2 = \\left(\\frac{\\sigma_{R_0}}{R_0}\\right)^2 = \\left(\\frac{\\partial \\ln(R_0)}{\\partial \\ln(\\kappa^2)}\\right)^2 (\\sigma_{\\ln(\\kappa^2)})^2 + \\left(\\frac{\\partial \\ln(R_0)}{\\partial \\ln(\\Phi_D)}\\right)^2 (\\sigma_{\\ln(\\Phi_D)})^2 + \\left(\\frac{\\partial \\ln(R_0)}{\\partial \\ln(J)}\\right)^2 (\\sigma_{\\ln(J)})^2 + \\left(\\frac{\\partial \\ln(R_0)}{\\partial \\ln(n)}\\right)^2 (\\sigma_{\\ln(n)})^2$$\n偏导数是对数表达式中的系数：\n$$\\frac{\\partial \\ln(R_0)}{\\partial \\ln(\\kappa^2)} = \\frac{1}{6}, \\quad \\frac{\\partial \\ln(R_0)}{\\partial \\ln(\\Phi_D)} = \\frac{1}{6}, \\quad \\frac{\\partial \\ln(R_0)}{\\partial \\ln(J)} = \\frac{1}{6}, \\quad \\frac{\\partial \\ln(R_0)}{\\partial \\ln(n)} = -\\frac{4}{6} = -\\frac{2}{3}$$\n另外，对于任意变量$X$，$(\\sigma_{\\ln(X)})^2 = (\\sigma_X/X)^2 = \\varepsilon_X^2$。将这些代入方差方程，得到：\n$$\\left(\\frac{\\sigma_{R_0}}{R_0}\\right)^2 = \\left(\\frac{1}{6}\\right)^2 \\varepsilon_{\\kappa^2}^2 + \\left(\\frac{1}{6}\\right)^2 \\varepsilon_{\\Phi_D}^2 + \\left(\\frac{1}{6}\\right)^2 \\varepsilon_{J}^2 + \\left(-\\frac{4}{6}\\right)^2 \\varepsilon_{n}^2$$\n$$\\left(\\frac{\\sigma_{R_0}}{R_0}\\right)^2 = \\frac{1}{36} \\left( \\varepsilon_{\\kappa^2}^2 + \\varepsilon_{\\Phi_D}^2 + \\varepsilon_{J}^2 + 16 \\varepsilon_{n}^2 \\right)$$\n取平方根，得到 $R_0$ 相对不确定度的最终表达式：\n$$\\frac{\\sigma_{R_0}}{R_0} = \\frac{1}{6} \\sqrt{\\varepsilon_{\\kappa^2}^2 + \\varepsilon_{\\Phi_D}^2 + \\varepsilon_{J}^2 + 16\\varepsilon_{n}^2}$$\n\n第2部分：推导推断距离的相对不确定度 $\\sigma_R/R$。\n\n能量转移效率 $E$ 由供体的内禀衰减（速率 $k_D = 1/\\tau_D$）和向受体的能量转移（速率 $k_T$）之间的动力学竞争定义：\n$$E = \\frac{k_T}{k_D + k_T}$$\n转移速率 $k_T$ 通过以下表达式与Förster距离 $R_0$ 和供体-受体间距 $R$ 相关：\n$$k_T = k_D \\left(\\frac{R_0}{R}\\right)^6$$\n将此代入效率方程，得到 $E$ 和 $R$ 之间的基本关系：\n$$E = \\frac{k_D (R_0/R)^6}{k_D + k_D (R_0/R)^6} = \\frac{(R_0/R)^6}{1 + (R_0/R)^6} = \\frac{R_0^6}{R^6 + R_0^6}$$\n我们必须解出该方程中以 $E$ 和 $R_0$ 表示的 $R$：\n$$E(R^6 + R_0^6) = R_0^6 \\implies E R^6 = R_0^6 (1 - E) \\implies R^6 = R_0^6 \\left(\\frac{1-E}{E}\\right)$$\n$$R = R_0 \\left(\\frac{1-E}{E}\\right)^{1/6} = R_0 \\left(E^{-1} - 1\\right)^{1/6}$$\n推断距离 $R$ 是两个独立随机变量的函数：$R_0$（其不确定度在第1部分中推导）和测量的效率 $E$。我们再次使用不确定度传播。取自然对数：\n$$\\ln(R) = \\ln(R_0) + \\frac{1}{6}\\ln\\left(\\frac{1-E}{E}\\right) = \\ln(R_0) + \\frac{1}{6}\\left[\\ln(1-E) - \\ln(E)\\right]$$\n$\\ln(R)$ 的方差由来自独立变量 $R_0$ 和 $E$ 的贡献的平方和给出：\n$$\\left(\\frac{\\sigma_R}{R}\\right)^2 = \\left(\\frac{\\partial \\ln(R)}{\\partial \\ln(R_0)}\\right)^2 (\\sigma_{\\ln(R_0)})^2 + \\left(\\frac{\\partial \\ln(R)}{\\partial E}\\right)^2 \\sigma_E^2$$\n偏导数为：\n$$\\frac{\\partial \\ln(R)}{\\partial \\ln(R_0)} = 1$$\n$$\\frac{\\partial \\ln(R)}{\\partial E} = \\frac{1}{6} \\left(\\frac{-1}{1-E} - \\frac{1}{E}\\right) = -\\frac{1}{6} \\left(\\frac{E + 1 - E}{E(1-E)}\\right) = -\\frac{1}{6E(1-E)}$$\n将这些代入方差方程：\n$$\\left(\\frac{\\sigma_R}{R}\\right)^2 = (1)^2 \\left(\\frac{\\sigma_{R_0}}{R_0}\\right)^2 + \\left(-\\frac{1}{6E(1-E)}\\right)^2 \\sigma_E^2$$\n$$\\left(\\frac{\\sigma_R}{R}\\right)^2 = \\left(\\frac{\\sigma_{R_0}}{R_0}\\right)^2 + \\frac{\\sigma_E^2}{36 E^2 (1-E)^2}$$\n现在，我们代入第1部分中得到的 $(\\sigma_{R_0}/R_0)^2$ 的表达式：\n$$\\left(\\frac{\\sigma_R}{R}\\right)^2 = \\frac{1}{36} \\left(\\varepsilon_{\\kappa^2}^2 + \\varepsilon_{\\Phi_D}^2 + \\varepsilon_{J}^2 + 16\\varepsilon_{n}^2\\right) + \\frac{\\sigma_E^2}{36 E^2 (1-E)^2}$$\n$$\\left(\\frac{\\sigma_R}{R}\\right)^2 = \\frac{1}{36} \\left(\\varepsilon_{\\kappa^2}^2 + \\varepsilon_{\\Phi_D}^2 + \\varepsilon_{J}^2 + 16\\varepsilon_{n}^2 + \\frac{\\sigma_E^2}{E^2 (1-E)^2}\\right)$$\n取平方根，得到 $R$ 相对不确定度的最终表达式：\n$$\\frac{\\sigma_R}{R} = \\frac{1}{6} \\sqrt{\\varepsilon_{\\kappa^2}^2 + \\varepsilon_{\\Phi_D}^2 + \\varepsilon_{J}^2 + 16\\varepsilon_{n}^2 + \\frac{\\sigma_E^2}{E^2(1-E)^2}}$$\n推导至此完成。最终答案以包含两个推导表达式的行向量形式呈现。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{1}{6}\\sqrt{\\varepsilon_{\\kappa^2}^{2} + \\varepsilon_{\\Phi_D}^{2} + \\varepsilon_{J}^{2} + 16\\varepsilon_{n}^{2}} & \\frac{1}{6}\\sqrt{\\varepsilon_{\\kappa^2}^{2} + \\varepsilon_{\\Phi_D}^{2} + \\varepsilon_{J}^{2} + 16\\varepsilon_{n}^{2} + \\frac{\\sigma_E^2}{E^2(1-E)^2}}\n\\end{pmatrix}\n}\n$$", "id": "2637295"}, {"introduction": "作为一项高级实践，本练习将挑战你为一个更复杂且真实的场景建模：溶液中分子的随机分布下的FRET过程。你需要将FRET动力学原理与空间统计学相结合，以预测整个分子系综的效率分布，并探讨实验中重要的探测偏差概念 [@problem_id:2637340]。这个练习旨在弥合单分子理论与系综水平实验观测之间的鸿沟，是迈向研究级建模的重要一步。", "problem": "要求您构建一个完整且可运行的程序，用于在给定固定的Förster半径和一组受体数密度的情况下，预测三维均匀稀溶液中供体和受体的Förster共振能量转移（FRET）效率的分布特征。您的程序必须从第一性原理以及关于随机溶液中非辐射偶极-偶极能量转移和空间统计学的成熟理论出发，推导出其计算步骤，不得依赖任何未经论证的捷径公式。\n\n场景假设如下：\n- 一个供体分子沉浸在数密度为 $\\rho$（单位为 $\\mathrm{nm}^{-3}$）的三维均匀受体溶液中。供体浓度足够稀，使得供体-供体相互作用可以忽略不计，且最近的受体主导了能量转移事件的统计特性。\n- 供体-受体能量转移遵循弱耦合区域中的长程偶极-偶极耦合机制，其Förster半径 $R_0$（单位为 $\\mathrm{nm}$）固定。仅存在供体时的激发态寿命为 $\\tau_{D0}$，仅存在供体时的衰变速率为 $k_{D0} = 1/\\tau_{D0}$。\n- FRET效率定义为导致能量转移至受体的供体激发所占的比例，即在仅有供体发生衰变之前发生能量转移的概率。\n- 溶液是充分混合且统计各向同性的。受体的位置遵循空间泊松过程，这意味着最近邻距离分布完全由 $\\rho$ 决定。\n\n从FRET效率作为能量转移和仅有供体衰变之间动力学竞争的定义出发，并基于弱耦合极限下非辐射偶极-偶极转移的已知距离依赖关系，您必须：\n1. 推导FRET效率 $E$ 与供体-受体间距 $r$ 之间的函数关系 $E(r)$。\n2. 推导由数密度为 $\\rho$ 的空间泊松过程所决定的最近邻距离概率密度 $p_r(r)$。\n3. 使用上述关系，将群体水平的平均效率表示为一个按 $p_r(r)$ 加权的、对 $r$ 的积分。\n4. 将可探测性偏差建模为一个硬阈值：只有效率 $E \\ge E_{\\min}$ 的分子对才能被探测到。将此阈值转换为距离空间中的一个截断（即满足阈值条件的 $r$ 的一个上限），并推导以下表达式：\n   - 可探测分数 $P_{\\mathrm{detect}}(\\rho, R_0, E_{\\min})$。\n   - 可探测样本的平均效率 $\\mu_{\\mathrm{det}}(\\rho, R_0, E_{\\min})$。\n   - 无偏群体平均效率 $\\mu_{\\mathrm{true}}(\\rho, R_0)$。\n这些表达式必须通过在物理相关 $r$ 范围内使用稳定的数值积分方法进行数值实现。\n\n对于每个测试用例，您的程序必须计算一组由三个浮点数组成的输出：\n- $P_{\\mathrm{detect}}$（无量纲），\n- $\\mu_{\\mathrm{true}}$（无量纲），\n- $\\mu_{\\mathrm{det}}$（无量纲）。\n\n您的程序应生成单行输出，其中包含用方括号括起来的、以逗号分隔的结果列表。对于 $N$ 个测试用例，输出必须是一个长度为 $3N$ 的展平列表，其顺序严格为\n$[P_{\\mathrm{detect}}^{(1)}, \\mu_{\\mathrm{true}}^{(1)}, \\mu_{\\mathrm{det}}^{(1)}, P_{\\mathrm{detect}}^{(2)}, \\mu_{\\mathrm{true}}^{(2)}, \\mu_{\\mathrm{det}}^{(2)}, \\dots]$，\n每个数字都需精确到小数点后六位。\n\n物理单位和常数：\n- 所有结果均以无量纲浮点数报告。\n- 在您的公式和代码中，使用单位为 $\\mathrm{nm}$ 的 $R_0$ 和单位为 $\\mathrm{nm}^{-3}$ 的 $\\rho$ 作为输入。\n- 本问题不涉及角度。\n\n您的程序需要评估的测试套件：\n- 情况 $1$：$R_0 = 5.0\\,\\mathrm{nm}$，$\\rho = 6.022\\times 10^{-7}\\,\\mathrm{nm}^{-3}$，$E_{\\min} = 0.0$。\n- 情况 $2$：$R_0 = 5.0\\,\\mathrm{nm}$，$\\rho = 6.022\\times 10^{-7}\\,\\mathrm{nm}^{-3}$，$E_{\\min} = 0.3$。\n- 情况 $3$：$R_0 = 5.0\\,\\mathrm{nm}$，$\\rho = 6.022\\times 10^{-5}\\,\\mathrm{nm}^{-3}$，$E_{\\min} = 0.0$。\n- 情况 $4$：$R_0 = 5.0\\,\\mathrm{nm}$，$\\rho = 6.022\\times 10^{-3}\\,\\mathrm{nm}^{-3}$，$E_{\\min} = 0.5$。\n- 情况 $5$：$R_0 = 3.5\\,\\mathrm{nm}$，$\\rho = 6.022\\times 10^{-5}\\,\\mathrm{nm}^{-3}$，$E_{\\min} = 0.2$。\n\n算法约束和数值报告：\n- 在 $r \\in [0, \\infty)$ 范围内，使用适当的绝对和相对容差稳健地实现数值积分，以确保结果的稳定性。\n- 当 $E_{\\min} = 0$ 时，根据定义，所有分子对都是可探测的，且 $\\mu_{\\mathrm{det}} = \\mu_{\\mathrm{true}}$；您的程序必须反映这一点以作为一致性检查。\n- 将所有报告的数字精确到小数点后六位，并以指定的展平列表格式在单行上输出。", "solution": "问题陈述已经过验证，被认为是有效的。它具有科学依据，问题定义明确，是客观的，并包含了推导唯一且有意义解所需的所有必要信息。该问题要求从第一性原理出发推导Förster共振能量转移（FRET）效率的统计特性，这是物理化学中一个标准且重要的练习。\n\n解决方案分为四个部分：$1$) 推导单分子FRET效率作为距离的函数；$2$) 推导最近受体距离分布；$3$) 将群体水平的平均效率表述为积分形式；以及$4$) 引入探测偏差。\n\n**$1$. FRET效率 $E(r)$ 作为供体-受体距离 $r$ 的函数**\n\n能量转移效率 $E$ 定义为转移过程的量子产率。它表示一个激发的供体通过能量转移至受体而衰变的概率，而不是通过其固有的衰变途径（例如，荧光、非辐射猝灭）衰变。这可以表示为速率之比：\n$$\nE = \\frac{k_{ET}}{k_{ET} + k_{D0}}\n$$\n其中 $k_{ET}$ 是能量转移速率，$k_{D0}$ 是在没有任何受体存在时供体的衰变速率。仅有供体时的寿命为 $\\tau_{D0} = 1/k_{D0}$。\n\n根据Förster的偶极-偶极耦合理论，能量转移速率 $k_{ET}$ 取决于供体和受体之间距离 $r$ 的六次方反比：\n$$\nk_{ET}(r) = k_{D0} \\left( \\frac{R_0}{r} \\right)^6\n$$\n此处，$R_0$ 是Förster半径，定义为能量转移效率为 $50\\%$ 时的特征距离。此时 $k_{ET}(R_0) = k_{D0}$。\n\n将 $k_{ET}(r)$ 的表达式代入效率的定义中，得到 $E(r)$ 的函数形式：\n$$\nE(r) = \\frac{k_{D0} (R_0/r)^6}{k_{D0} (R_0/r)^6 + k_{D0}} = \\frac{(R_0/r)^6}{1 + (R_0/r)^6} = \\frac{R_0^6}{r^6 + R_0^6}\n$$\n这就是所要求的FRET效率 $E$ 和供体-受体间距 $r$ 之间的关系。\n\n**$2$. 最近邻距离概率密度 $p_r(r)$**\n\n问题陈述指出，受体在三维均匀溶液中根据数密度为 $\\rho$ 的空间泊松过程分布。我们需要找到从一个给定供体到其最近受体的距离 $r$ 的概率密度函数 $p_r(r)$。\n\n让我们求解在以供体为中心、半径为 $r$ 的球体内没有受体的概率。该球体的体积为 $V(r) = \\frac{4}{3}\\pi r^3$。对于泊松过程，在平均粒子数为 $\\lambda = \\rho V$ 的体积 $V$ 中找到 $k$ 个粒子的概率为 $P(k; \\lambda) = \\frac{\\lambda^k e^{-\\lambda}}{k!}$。\n在该球体中找到零个受体（$k=0$）的概率为：\n$$\nP(\\text{V(r)内无受体}) = P(k=0) = e^{-\\rho V(r)} = e^{-\\frac{4}{3}\\pi r^3 \\rho}\n$$\n这也是最近邻距离 $R_{NN}$ 大于 $r$ 的概率，即最近邻距离的互补累积分布函数（CCDF）。\n$$\nP(R_{NN} > r) = e^{-\\frac{4}{3}\\pi r^3 \\rho}\n$$\n因此，累积分布函数（CDF）$F_r(r) = P(R_{NN} \\le r)$ 为：\n$$\nF_r(r) = 1 - P(R_{NN} > r) = 1 - e^{-\\frac{4}{3}\\pi r^3 \\rho}\n$$\n概率密度函数（PDF）$p_r(r)$ 是CDF对 $r$ 的导数：\n$$\np_r(r) = \\frac{dF_r(r)}{dr} = \\frac{d}{dr}\\left( 1 - e^{-\\frac{4}{3}\\pi r^3 \\rho} \\right) = -e^{-\\frac{4}{3}\\pi r^3 \\rho} \\cdot \\left( -\\frac{4}{3}\\pi \\rho \\cdot 3r^2 \\right)\n$$\n$$\np_r(r) = 4\\pi r^2 \\rho \\, e^{-\\frac{4}{3}\\pi r^3 \\rho}\n$$\n这就是所要求的最近邻距离 $r$ 的PDF，适用于 $r \\ge 0$。\n\n**$3$. 无偏群体平均效率 $\\mu_{\\mathrm{true}}$**\n\n真实平均效率 $\\mu_{\\mathrm{true}}$ 是效率 $E(r)$ 在整个供体-受体距离群体上的期望值，按概率密度 $p_r(r)$ 进行加权。它通过将 $E(r)$ 和 $p_r(r)$ 的乘积在所有可能的距离（从 $0$ 到 $\\infty$）上积分来计算。\n$$\n\\mu_{\\mathrm{true}} = \\langle E(r) \\rangle = \\int_{0}^{\\infty} E(r) \\, p_r(r) \\, dr\n$$\n代入推导出的 $E(r)$ 和 $p_r(r)$ 的表达式：\n$$\n\\mu_{\\mathrm{true}}(\\rho, R_0) = \\int_{0}^{\\infty} \\left( \\frac{R_0^6}{R_0^6 + r^6} \\right) \\left( 4\\pi r^2 \\rho \\, e^{-\\frac{4}{3}\\pi r^3 \\rho} \\right) dr\n$$\n该积分没有简单的闭式解析解，必须进行数值计算。\n\n**$4$. 建模可探测性偏差**\n\n问题引入了一个探测阈值，只有效率 $E \\ge E_{\\min}$ 的供体-受体对才被认为是“可探测的”。\n\n首先，我们将效率阈值转换为距离阈值。由于 $E(r)$ 是 $r$ 的单调递减函数，条件 $E(r) \\ge E_{\\min}$ 对应于分离距离的一个上限，我们将其表示为 $r_{\\max}$。\n$$\n\\frac{R_0^6}{R_0^6 + r^6} \\ge E_{\\min}\n$$\n$$\nR_0^6 \\ge E_{\\min}(R_0^6 + r^6) \\implies R_0^6(1 - E_{\\min}) \\ge E_{\\min}r^6\n$$\n$$\nr^6 \\le R_0^6 \\frac{1 - E_{\\min}}{E_{\\min}} \\implies r \\le R_0 \\left( \\frac{1 - E_{\\min}}{E_{\\min}} \\right)^{1/6}\n$$\n因此，可探测的最大距离为：\n$$\nr_{\\max}(R_0, E_{\\min}) = R_0 \\left( \\frac{1 - E_{\\min}}{E_{\\min}} \\right)^{1/6}\n$$\n该表达式在 $0 < E_{\\min} < 1$ 时有效。如果 $E_{\\min} = 0$，则对所有距离都满足条件，因此 $r_{\\max} \\to \\infty$。如果 $E_{\\min} \\ge 1$，则 $r_{\\max} = 0$。\n\n可探测分子对的分数 $P_{\\mathrm{detect}}$ 是最近邻距离在可探测范围 $[0, r_{\\max}]$ 内的概率。这由最近邻距离的CDF在 $r_{\\max}$ 处的值给出：\n$$\nP_{\\mathrm{detect}} = P(r \\le r_{\\max}) = \\int_0^{r_{\\max}} p_r(r) \\, dr = F_r(r_{\\max})\n$$\n$$\nP_{\\mathrm{detect}}(\\rho, R_0, E_{\\min}) = 1 - e^{-\\frac{4}{3}\\pi r_{\\max}^3 \\rho}\n$$\n对于 $E_{\\min} = 0$ 的特殊情况，$r_{\\max} \\to \\infty$，因此 $P_{\\mathrm{detect}} = 1$。\n\n可探测样本的平均效率 $\\mu_{\\mathrm{det}}$ 是在给定 $r \\le r_{\\max}$ 条件下 $E(r)$ 的条件期望。它通过在可探测范围 $[0, r_{\\max}]$ 上积分，并除以探测概率 $P_{\\mathrm{detect}}$ 进行归一化来计算。\n$$\n\\mu_{\\mathrm{det}} = \\frac{\\int_{0}^{r_{\\max}} E(r) \\, p_r(r) \\, dr}{\\int_{0}^{r_{\\max}} p_r(r) \\, dr} = \\frac{1}{P_{\\mathrm{detect}}} \\int_{0}^{r_{\\max}} E(r) \\, p_r(r) \\, dr\n$$\n分子与计算 $\\mu_{\\mathrm{true}}$ 的积分相同，但积分上限为有限值 $r_{\\max}$。\n$$\n\\mu_{\\mathrm{det}}(\\rho, R_0, E_{\\min}) = \\frac{1}{P_{\\mathrm{detect}}} \\int_{0}^{r_{\\max}} \\left( \\frac{R_0^6}{R_0^6 + r^6} \\right) \\left( 4\\pi r^2 \\rho \\, e^{-\\frac{4}{3}\\pi r^3 \\rho} \\right) dr\n$$\n当 $E_{\\min} = 0$ 时，我们有 $r_{\\max} \\to \\infty$ 且 $P_{\\mathrm{detect}} = 1$，这正确地导出了 $\\mu_{\\mathrm{det}} = \\mu_{\\mathrm{true}}$。\n\n**$5$. 数值实现策略**\n\n程序将为每个测试用例 $(\\rho, R_0, E_{\\min})$ 实现推导出的公式。计算的核心是对 $f(r) = E(r) p_r(r)$ 的积分进行数值评估。\n$$\nf(r, \\rho, R_0) = \\left( \\frac{R_0^6}{R_0^6 + r^6} \\right) \\left( 4\\pi r^2 \\rho \\, e^{-\\frac{4}{3}\\pi r^3 \\rho} \\right)\n$$\n计算过程如下：\n$1$. 对于给定的 $(R_0, \\rho, E_{\\min})$，首先确定 $r_{\\max}$。如果 $E_{\\min}=0$，$r_{\\max}$ 为无穷大。否则，使用公式 $r_{\\max} = R_0((1-E_{\\min})/E_{\\min})^{1/6}$。\n$2$. 通过将 $f(r, \\rho, R_0)$ 从 $r=0$ 到 $r=\\infty$ 进行数值积分来计算 $\\mu_{\\mathrm{true}}$。\n$3$. 计算 $P_{\\mathrm{detect}}$。如果 $E_{\\min}=0$，$P_{\\mathrm{detect}}=1$。否则，使用公式 $P_{\\mathrm{detect}} = 1 - \\exp(-\\frac{4}{3}\\pi r_{\\max}^3 \\rho)$。\n$4$. 计算 $\\mu_{\\mathrm{det}}$。如果 $E_{\\min}=0$，则 $\\mu_{\\mathrm{det}}=\\mu_{\\mathrm{true}}$。否则，将 $f(r, \\rho, R_0)$ 从 $r=0$ 到 $r=r_{\\max}$ 进行数值积分，然后将结果除以 $P_{\\mathrm{detect}}$。\n\n`scipy.integrate.quad` 函数适用于这些数值积分，因为它能稳健地处理有限和无限积分限。每个测试用例的最终结果是三元组 $(P_{\\mathrm{detect}}, \\mu_{\\mathrm{true}}, \\mu_{\\mathrm{det}})$，并按指定格式进行格式化。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import integrate\n\ndef solve():\n    \"\"\"\n    Computes distributional characteristics of FRET efficiency for a set of test cases.\n    The derivation is based on first principles of FRET kinetics and spatial statistics.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple (R0 (nm), rho (nm^-3), Emin (dimensionless)).\n    test_cases = [\n        (5.0, 6.022e-7, 0.0),\n        (5.0, 6.022e-7, 0.3),\n        (5.0, 6.022e-5, 0.0),\n        (5.0, 6.022e-3, 0.5),\n        (3.5, 6.022e-5, 0.2),\n    ]\n\n    all_results = []\n\n    def calculate_fret_stats(R0, rho, Emin):\n        \"\"\"\n        Calculates P_detect, mu_true, and mu_det for a single set of parameters.\n\n        Args:\n            R0 (float): Förster radius in nm.\n            rho (float): Acceptor number density in nm^-3.\n            Emin (float): Minimum detectable efficiency threshold.\n\n        Returns:\n            tuple: (P_detect, mu_true, mu_det)\n        \"\"\"\n\n        # Define the integrand, which is the product of E(r) and p_r(r).\n        # E(r) = R0^6 / (R0^6 + r^6)\n        # p_r(r) = 4 * pi * r^2 * rho * exp(-4/3 * pi * r^3 * rho)\n        R0_6 = R0**6\n        const_p_r_1 = 4 * np.pi * rho\n        const_p_r_2 = -4/3 * np.pi * rho\n\n        def integrand(r):\n            efficiency = R0_6 / (R0_6 + r**6)\n            prob_density = const_p_r_1 * r**2 * np.exp(const_p_r_2 * r**3)\n            return efficiency * prob_density\n\n        # 1. Calculate the unbiased population mean efficiency (mu_true).\n        # This integral is always over r from 0 to infinity.\n        # quad returns a tuple (integral_value, error_estimate). We take the value.\n        mu_true, _ = integrate.quad(integrand, 0, np.inf)\n\n        # 2. Handle the detectability bias based on Emin.\n        if Emin == 0.0:\n            # No bias, all pairs are detectable.\n            P_detect = 1.0\n            mu_det = mu_true\n        elif Emin >= 1.0:\n            # Pathological case: nothing is detectable.\n            P_detect = 0.0\n            mu_det = 0.0 # Mean of an empty set is undefined, 0 is a reasonable default.\n        else:\n            # 2a. Calculate the maximum detectable distance, r_max.\n            r_max = R0 * ((1 - Emin) / Emin)**(1/6)\n            \n            # 2b. Calculate the detected fraction, P_detect.\n            # This is the integral of p_r(r) from 0 to r_max, which has an analytical solution.\n            P_detect = 1 - np.exp(const_p_r_2 * r_max**3)\n\n            # 2c. Calculate the detected-sample mean efficiency, mu_det.\n            if P_detect < 1e-15: # Practically zero probability of detection\n                mu_det = 0.0\n            else:\n                # The numerator is the integral of the same integrand but up to r_max.\n                mu_det_numerator, _ = integrate.quad(integrand, 0, r_max)\n                mu_det = mu_det_numerator / P_detect\n\n        return P_detect, mu_true, mu_det\n\n    for case in test_cases:\n        R0, rho, Emin = case\n        results_tuple = calculate_fret_stats(R0, rho, Emin)\n        all_results.extend(results_tuple)\n    \n    # Format the results for the final output string.\n    # Each number must be rounded to exactly six digits after the decimal point.\n    formatted_results = [f\"{x:.6f}\" for x in all_results]\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2637340"}]}