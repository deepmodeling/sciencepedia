{"hands_on_practices": [{"introduction": "经典密度泛函理论的基石是变分原理，即流体的平衡密度分布使巨势泛函最小化。第一个实践是一项基础练习，它将这一抽象原理转化为一个具体的、自洽的密度分布积分方程。掌握这一推导至关重要，因为它构成了经典密度泛函理论几乎所有应用的起点，无论是简单模型的解析解还是复杂系统的数值计算。[@problem_id:2763947]", "problem": "考虑一个在经典密度泛函理论（CDFT）框架下描述的单组分经典流体。其内禀亥姆霍兹自由能泛函分解为 $F[n]=F_{\\text{id}}[n]+F_{\\text{hs}}[n]+F_{\\text{att}}[n]$，其中理想气体贡献为 $F_{\\text{id}}[n]=k_{B}T\\int d\\mathbf{r}\\,n(\\mathbf{r})\\left[\\ln\\!\\left(\\Lambda^{3}n(\\mathbf{r})\\right)-1\\right]$（$\\Lambda$ 为热德布罗意波长），硬球超额贡献 $F_{\\text{hs}}[n]$ 是一个未知但定义明确的泛函，平均场吸引贡献为 $F_{\\text{att}}[n]=\\frac{1}{2}\\int d\\mathbf{r}\\,d\\mathbf{r}'\\,n(\\mathbf{r})\\,n(\\mathbf{r}')\\,u_{\\text{att}}(|\\mathbf{r}-\\mathbf{r}'|)$（$u_{\\text{att}}(r)$ 为给定的对吸引势）。该系统处于固定的温度 $T$ 和化学势 $\\mu$下，并受到一个给定的外场 $V_{\\text{ext}}(\\mathbf{r})$ 的作用。\n\n从平衡密度分布 $n(\\mathbf{r})$ 使巨势泛函 $\\Omega[n]=F[n]+\\int d\\mathbf{r}\\,n(\\mathbf{r})\\left(V_{\\text{ext}}(\\mathbf{r})-\\mu\\right)$ 最小化的变分原理出发，推导欧拉-拉格朗日平稳性条件，并将其整理，以获得关于 $n(\\mathbf{r})$ 的显式自洽积分方程。\n\n将最终结果表示为显式闭合形式的泛函表达式 $G[n](\\mathbf{r})$，使得 $n(\\mathbf{r})=G[n](\\mathbf{r})$。仅报告 $G[n](\\mathbf{r})$ 的表达式，用 $\\mu$、$T$、$\\Lambda$、$V_{\\text{ext}}(\\mathbf{r})$、$u_{\\text{att}}(r)$ 以及泛函导数 $\\delta F_{\\text{hs}}[n]/\\delta n(\\mathbf{r})$ 来表示。最终答案中不要包含等号。在推导过程中明确定义 $\\beta=1/(k_{B}T)$。不需要进行数值计算。", "solution": "问题陈述已经过严格验证。\n\n**步骤1：提取已知条件**\n- **系统**：单组分经典流体。\n- **框架**：经典密度泛函理论（CDFT）。\n- **内禀亥姆霍兹自由能泛函**：$F[n]=F_{\\text{id}}[n]+F_{\\text{hs}}[n]+F_{\\text{att}}[n]$。\n- **理想气体贡献**：$F_{\\text{id}}[n]=k_{B}T\\int d\\mathbf{r}\\,n(\\mathbf{r})\\left[\\ln\\!\\left(\\Lambda^{3}n(\\mathbf{r})\\right)-1\\right]$，其中 $\\Lambda$ 是热德布罗意波长。\n- **硬球超额贡献**：$F_{\\text{hs}}[n]$，一个未指定的泛函。\n- **平均场吸引贡献**：$F_{\\text{att}}[n]=\\frac{1}{2}\\int d\\mathbf{r}\\,d\\mathbf{r}'\\,n(\\mathbf{r})\\,n(\\mathbf{r}')\\,u_{\\text{att}}(|\\mathbf{r}-\\mathbf{r}'|)$，其中 $u_{\\text{att}}(r)$ 是给定的吸引势。\n- **热力学条件**：系统处于固定的温度 $T$ 和化学势 $\\mu$。\n- **外场**：$V_{\\text{ext}}(\\mathbf{r})$。\n- **巨势泛函**：$\\Omega[n]=F[n]+\\int d\\mathbf{r}\\,n(\\mathbf{r})\\left(V_{\\text{ext}}(\\mathbf{r})-\\mu\\right)$。\n- **变分原理**：平衡密度分布 $n(\\mathbf{r})$ 使 $\\Omega[n]$ 最小化。\n- **任务**：从变分原理推导欧拉-拉格朗日方程，并将其表示为自洽方程 $n(\\mathbf{r})=G[n](\\mathbf{r})$。\n- **输出要求**：报告 $G[n](\\mathbf{r})$ 的泛函表达式。\n\n**步骤2：使用提取的已知条件进行验证**\n- **科学依据**：该问题是经典密度泛函理论这一成熟领域中的一个标准、基础的推导。所有定义和原理都是正确的。\n- **适定性**：问题陈述清晰，推导所需的所有信息均已提供。目标是推导一种已知类型的方程，该方程具有唯一的形式结构。\n- **客观性**：问题以精确、客观、科学的语言表述。\n\n**步骤3：结论与行动**\n该问题科学上合理、适定、客观，且不含任何模糊或矛盾之处。判定为**有效**。我们继续进行求解。\n\n平衡密度分布 $n(\\mathbf{r})$ 是使巨势泛函 $\\Omega[n]$ 最小化的函数。该条件由欧拉-拉格朗日方程表示，即 $\\Omega[n]$ 对 $n(\\mathbf{r})$ 的泛函导数在平衡时必须为零：\n$$\n\\frac{\\delta \\Omega[n]}{\\delta n(\\mathbf{r})} = 0\n$$\n巨势泛函由下式给出：\n$$\n\\Omega[n] = F_{\\text{id}}[n] + F_{\\text{hs}}[n] + F_{\\text{att}}[n] + \\int d\\mathbf{r}'\\, n(\\mathbf{r}') V_{\\text{ext}}(\\mathbf{r}') - \\mu \\int d\\mathbf{r}'\\, n(\\mathbf{r}')\n$$\n我们计算每一项对 $n(\\mathbf{r})$ 的泛函导数。为避免混淆，积分变量用撇号 $\\mathbf{r}'$ 表示。\n\n1.  **理想气体项**，$F_{\\text{id}}[n]$：\n    该泛函为 $F_{\\text{id}}[n] = \\int d\\mathbf{r}'\\, f(n(\\mathbf{r}'))$，其中自由能密度为 $f(n) = k_{B}T\\left(n\\ln(\\Lambda^{3}n) - n\\right)$。其泛函导数是被积函数对 $n$ 的偏导数，在 $n=n(\\mathbf{r})$ 处取值：\n    $$\n    \\frac{\\delta F_{\\text{id}}[n]}{\\delta n(\\mathbf{r})} = \\frac{d}{dn}\\left[k_{B}T\\left(n\\ln(\\Lambda^{3}n) - n\\right)\\right]_{n=n(\\mathbf{r})} = k_{B}T\\left[ \\ln(\\Lambda^{3}n(\\mathbf{r})) + n(\\mathbf{r})\\frac{\\Lambda^{3}}{n(\\mathbf{r})\\Lambda^{3}} - 1 \\right] = k_{B}T \\ln(\\Lambda^{3}n(\\mathbf{r}))\n    $$\n\n2.  **硬球项**，$F_{\\text{hs}}[n]$：\n    由于该泛函未明确给出，其泛函导数按要求保留为符号形式：$\\frac{\\delta F_{\\text{hs}}[n]}{\\delta n(\\mathbf{r})}$。\n\n3.  **吸引项**，$F_{\\text{att}}[n]$：\n    该泛函为 $F_{\\text{att}}[n]=\\frac{1}{2}\\int d\\mathbf{r}'\\,d\\mathbf{r}''\\,n(\\mathbf{r}')\\,n(\\mathbf{r}'')\\,u_{\\text{att}}(|\\mathbf{r}'-\\mathbf{r}''|)$。由于被积函数关于 $\\mathbf{r}'$ 和 $\\mathbf{r}''$ 的交换具有对称性，其泛函导数为：\n    $$\n    \\frac{\\delta F_{\\text{att}}[n]}{\\delta n(\\mathbf{r})} = \\int d\\mathbf{r}'\\, n(\\mathbf{r}')\\, u_{\\text{att}}(|\\mathbf{r}-\\mathbf{r}'|)\n    $$\n\n4.  **外势项**：\n    $$\n    \\frac{\\delta}{\\delta n(\\mathbf{r})} \\int d\\mathbf{r}'\\, n(\\mathbf{r}') V_{\\text{ext}}(\\mathbf{r}') = \\int d\\mathbf{r}'\\, V_{\\text{ext}}(\\mathbf{r}') \\frac{\\delta n(\\mathbf{r}')}{\\delta n(\\mathbf{r})} = \\int d\\mathbf{r}'\\, V_{\\text{ext}}(\\mathbf{r}') \\delta(\\mathbf{r}' - \\mathbf{r}) = V_{\\text{ext}}(\\mathbf{r})\n    $$\n\n5.  **化学势项**：\n    $$\n    \\frac{\\delta}{\\delta n(\\mathbf{r})} \\left[ -\\mu \\int d\\mathbf{r}'\\, n(\\mathbf{r}') \\right] = -\\mu \\int d\\mathbf{r}'\\, \\frac{\\delta n(\\mathbf{r}')}{\\delta n(\\mathbf{r})} = -\\mu \\int d\\mathbf{r}'\\, \\delta(\\mathbf{r}' - \\mathbf{r}) = -\\mu\n    $$\n将这些结果合并，得到欧拉-拉格朗日方程：\n$$\nk_{B}T \\ln(\\Lambda^{3}n(\\mathbf{r})) + \\frac{\\delta F_{\\text{hs}}[n]}{\\delta n(\\mathbf{r})} + \\int d\\mathbf{r}'\\,n(\\mathbf{r}')\\,u_{\\text{att}}(|\\mathbf{r}-\\mathbf{r}'|) + V_{\\text{ext}}(\\mathbf{r}) - \\mu = 0\n$$\n为了得到关于 $n(\\mathbf{r})$ 的自洽方程，我们重新整理这个平稳性条件以分离出 $n(\\mathbf{r})$。首先，我们分离对数项：\n$$\nk_{B}T \\ln(\\Lambda^{3}n(\\mathbf{r})) = \\mu - V_{\\text{ext}}(\\mathbf{r}) - \\frac{\\delta F_{\\text{hs}}[n]}{\\delta n(\\mathbf{r})} - \\int d\\mathbf{r}'\\,n(\\mathbf{r}')\\,u_{\\text{att}}(|\\mathbf{r}-\\mathbf{r}'|)\n$$\n我们定义逆温度 $\\beta = \\frac{1}{k_{B}T}$。两边同除以 $k_{B}T$ 得：\n$$\n\\ln(\\Lambda^{3}n(\\mathbf{r})) = \\beta \\left[ \\mu - V_{\\text{ext}}(\\mathbf{r}) - \\frac{\\delta F_{\\text{hs}}[n]}{\\delta n(\\mathbf{r})} - \\int d\\mathbf{r}'\\,n(\\mathbf{r}')\\,u_{\\text{att}}(|\\mathbf{r}-\\mathbf{r}'|) \\right]\n$$\n对两边取指数：\n$$\n\\Lambda^{3}n(\\mathbf{r}) = \\exp\\left( \\beta \\left[ \\mu - V_{\\text{ext}}(\\mathbf{r}) - \\frac{\\delta F_{\\text{hs}}[n]}{\\delta n(\\mathbf{r})} - \\int d\\mathbf{r}'\\,n(\\mathbf{r}')\\,u_{\\text{att}}(|\\mathbf{r}-\\mathbf{r}'|) \\right] \\right)\n$$\n最后，解出 $n(\\mathbf{r})$，得到所需形式的自洽积分方程 $n(\\mathbf{r}) = G[n](\\mathbf{r})$，其中泛函 $G[n](\\mathbf{r})$ 为：\n$$\nG[n](\\mathbf{r}) = \\frac{1}{\\Lambda^{3}} \\exp\\left( \\beta \\left[ \\mu - V_{\\text{ext}}(\\mathbf{r}) - \\frac{\\delta F_{\\text{hs}}[n]}{\\delta n(\\mathbf{r})} - \\int d\\mathbf{r}'\\,n(\\mathbf{r}')\\,u_{\\text{att}}(|\\mathbf{r}-\\mathbf{r}'|) \\right] \\right)\n$$\n这就是问题所要求的最终表达式。", "answer": "$$\n\\boxed{\\frac{1}{\\Lambda^{3}} \\exp\\left( \\beta \\left( \\mu - V_{\\text{ext}}(\\mathbf{r}) - \\frac{\\delta F_{\\text{hs}}[n]}{\\delta n(\\mathbf{r})} - \\int d\\mathbf{r}'\\,n(\\mathbf{r}')\\,u_{\\text{att}}(|\\mathbf{r}-\\mathbf{r}'|) \\right) \\right)}\n$$", "id": "2763947"}, {"introduction": "尽管普适的自洽方程包含一个形式化的超额亥姆霍兹自由能泛函 $F_\\mathrm{ex}[n]$，但建立对该项所代表物理意义的直观理解至关重要。本实践通过研究一个可精确求解的“玩具模型”——零维腔体，在形式化的密度泛函理论框架与基础的统计力学之间架起了一座桥梁。通过推导一个最多只能容纳一个粒子的系统的精确超额自由能，您将深刻理解 $F_\\mathrm{ex}[n]$ 是如何捕捉理想气体图像之外的粒子间相互作用效应的。[@problem_id:2763950]", "problem": "考虑一个在经典密度泛函理论 (DFT) 框架下处理的经典硬球流体，处于一个最多只能容纳一 ($1$) 个粒子的外部空腔的零维极限下。令 $\\beta \\equiv 1/(k_{B}T)$，并用 $\\eta \\in [0,1)$ 表示空腔的平衡平均占据数，在 DFT 中，它对应于密度的积分，$\\eta = \\int n(\\mathbf{r})\\,d\\mathbf{r}$，并且是此极限下唯一的非平凡自由度。仅使用基础的统计力学定义，即巨配分函数、巨势以及在固定平均占据数下巨势与亥姆霍兹自由能之间的勒让德变换关系，确定作为 $\\eta$ 的函数的精确零维硬球超额亥姆霍兹自由能泛函，\n$$\n\\beta F_{\\text{hs}}^{\\text{(0D)}}(\\eta) = \\beta\\Big(F_{\\text{int}}^{\\text{(0D)}}(\\eta) - F_{\\text{id}}^{\\text{(0D)}}(\\eta)\\Big),\n$$\n其中 $F_{\\text{int}}^{\\text{(0D)}}$ 是空腔中相互作用的硬球系统的精确亥姆霍兹自由能，$F_{\\text{id}}^{\\text{(0D)}}$ 是同一空腔中对应的理想气体的亥姆霍兹自由能。在单位制下进行计算，其中空腔的单粒子构型积分为1，因此活度为 $z=\\exp(\\beta\\mu)$，$\\mu$ 是化学势。你的答案必须是 $\\beta F_{\\text{hs}}^{\\text{(0D)}}(\\eta)$（无量纲）的一个单一的、仅用 $\\eta$ 表示的闭式解析表达式。不需要进行数值计算。", "solution": "问题需要经过验证。\n\n步骤 1：提取已知条件\n- 系统：零维 ($0D$) 空腔中的经典硬球流体。\n- 理论：经典密度泛函理论 (DFT)。\n- 约束：空腔最多只能容纳一 ($1$) 个粒子。\n- 符号：$\\beta \\equiv 1/(k_{B}T)$。\n- 变量：$\\eta \\in [0,1)$ 是平衡平均占据数，定义为 $\\eta = \\int n(\\mathbf{r})\\,d\\mathbf{r}$。\n- 目标：确定精确的零维硬球超额亥姆霍兹自由能泛函 $\\beta F_{\\text{hs}}^{\\text{(0D)}}(\\eta)$。\n- 定义：$\\beta F_{\\text{hs}}^{\\text{(0D)}}(\\eta) = \\beta\\big(F_{\\text{int}}^{\\text{(0D)}}(\\eta) - F_{\\text{id}}^{\\text{(0D)}}(\\eta)\\big)$。\n- $F_{\\text{int}}^{\\text{(0D)}}(\\eta)$ 是相互作用系统的精确亥姆霍兹自由能。\n- $F_{\\text{id}}^{\\text{(0D)}}(\\eta)$ 是对应的理想气体亥姆霍兹自由能。\n- 归一化：空腔的单粒子构型积分为1。\n- 活度：$z = \\exp(\\beta\\mu)$，其中 $\\mu$ 是化学势。\n\n步骤 2：使用提取的已知条件进行验证\n该问题具有科学依据，是统计力学和经典DFT中一个明确定义的理论练习。这是一个适定问题，提供了足够的信息，可以使用基本原理推导出唯一解。术语精确且客观。该问题不违反任何物理定律，而是使用了一种标准的理论简化（$0D$ 极限）来检验巨配分函数和勒让德变换等基本概念的应用。设定是自洽且一致的。\n\n步骤 3：结论与行动\n问题有效，将提供解答。\n\n解答过程从巨正则系综的基本原理出发。该系统是一个处于固定体积、温度 $T$ 和化学势 $\\mu$ 的空腔。核心量是巨配分函数 $\\Xi$，定义为：\n$$\n\\Xi = \\sum_{N=0}^{\\infty} \\frac{z^N}{N!} Q_N\n$$\n其中 $z = \\exp(\\beta\\mu)$ 是活度，$Q_N$ 是 $N$ 个粒子的正则构型积分。问题陈述，单粒子构型积分 $Q_1$ 为1。\n\n首先，我们考虑相互作用的“硬球”系统。空腔最多只能容纳一个粒子的约束是硬球相互作用在这一 $0D$ 极限下的体现。这意味着粒子数 $N$ 只能是 $0$ 或 $1$。因此，这个相互作用系统的巨配分函数 $\\Xi_{\\text{int}}$ 为：\n$$\n\\Xi_{\\text{int}} = \\frac{z^0}{0!} Q_0 + \\frac{z^1}{1!} Q_1 = 1 + z\n$$\n这里，根据定义我们使用了 $Q_0 = 1$，并根据已知条件使用了 $Q_1=1$。对于 $N > 1$，无限排斥意味着 $Q_N = 0$。\n\n接下来，我们考虑对应的理想气体系统。理想气体由无相互作用的点粒子组成。在同一个空腔中，可以容纳任意数量的此类粒子。理想气体的巨配分函数 $\\Xi_{\\text{id}}$ 为：\n$$\n\\Xi_{\\text{id}} = \\sum_{N=0}^{\\infty} \\frac{z^N}{N!} (Q_1)^N = \\sum_{N=0}^{\\infty} \\frac{z^N}{N!} = \\exp(z)\n$$\n这里我们使用了理想气体的性质 $Q_N = (Q_1)^N$。\n\n巨势 $\\Omega$ 通过 $\\beta\\Omega = -\\ln\\Xi$ 与巨配分函数相关。\n对于相互作用系统：\n$$\n\\beta\\Omega_{\\text{int}} = -\\ln(\\Xi_{\\text{int}}) = -\\ln(1+z)\n$$\n对于理想气体系统：\n$$\n\\beta\\Omega_{\\text{id}} = -\\ln(\\Xi_{\\text{id}}) = -\\ln(\\exp(z)) = -z\n$$\n空腔中的平均粒子数，用 $\\eta$ 表示，由 $\\eta = \\langle N \\rangle = z \\frac{\\partial(\\ln \\Xi)}{\\partial z}$ 给出。\n对于相互作用系统，平均占据数 $\\eta$ 为：\n$$\n\\eta = z \\frac{\\partial}{\\partial z} \\ln(1+z) = \\frac{z}{1+z}\n$$\n这个方程将平均占据数 $\\eta$ 与活度 $z$ 联系起来。我们可以将其反转以将 $z$ 表示为 $\\eta$ 的函数：\n$$\n\\eta(1+z) = z \\implies \\eta = z(1-\\eta) \\implies z = \\frac{\\eta}{1-\\eta}\n$$\n由于 $z = \\exp(\\beta\\mu)$，相互作用系统的化学势为 $\\beta\\mu = \\ln(z) = \\ln\\left(\\frac{\\eta}{1-\\eta}\\right)$。\n\n亥姆霍兹自由能 $F$ 是通过勒让德变换从巨势 $\\Omega$ 获得的： $F(\\eta) = \\Omega + \\mu\\eta$。在无量纲单位中，这表示为 $\\beta F(\\eta) = \\beta\\Omega + (\\beta\\mu)\\eta$。\n\n现在我们通过代入用 $\\eta$ 表示的 $\\beta\\Omega_{\\text{int}}$ 和 $\\beta\\mu$ 的表达式来计算相互作用系统的亥姆霍兹自由能 $\\beta F_{\\text{int}}(\\eta)$：\n$$\n\\beta F_{\\text{int}}(\\eta) = -\\ln(1+z) + \\eta \\ln(z)\n$$\n使用 $z = \\frac{\\eta}{1-\\eta}$ 和 $1+z = 1+\\frac{\\eta}{1-\\eta} = \\frac{1}{1-\\eta}$，我们得到：\n$$\n\\beta F_{\\text{int}}(\\eta) = -\\ln\\left(\\frac{1}{1-\\eta}\\right) + \\eta \\ln\\left(\\frac{\\eta}{1-\\eta}\\right)\n$$\n$$\n\\beta F_{\\text{int}}(\\eta) = \\ln(1-\\eta) + \\eta \\ln(\\eta) - \\eta \\ln(1-\\eta)\n$$\n$$\n\\beta F_{\\text{int}}(\\eta) = (1-\\eta)\\ln(1-\\eta) + \\eta\\ln(\\eta)\n$$\n这是相互作用系统的总无量纲亥姆霍兹自由能。\n\n接下来，我们确定理想气体的亥姆霍兹自由能 $F_{\\text{id}}$。在DFT中，理想气体参考系统必须具有相同的单体密度分布，在这种 $0D$ 情况下，这意味着它必须具有与相互作用系统相同的平均占据数 $\\eta$。\n对于理想气体，平均占据数 $\\eta_{\\text{id}}$ 是：\n$$\n\\eta_{\\text{id}} = z \\frac{\\partial}{\\partial z} \\ln(\\exp(z)) = z\n$$\n因此，为了达到平均占据数 $\\eta$，理想气体的活度必须为 $z = \\eta$，这意味着其化学势为 $\\beta\\mu_{\\text{id}} = \\ln(\\eta)$。\n在此活度下，理想气体的巨势为 $\\beta\\Omega_{\\text{id}} = -z = -\\eta$。\n对平均占据数为 $\\eta$ 的理想气体系统应用勒让德变换：\n$$\n\\beta F_{\\text{id}}(\\eta) = \\beta\\Omega_{\\text{id}} + (\\beta\\mu_{\\text{id}})\\eta = -\\eta + \\eta\\ln(\\eta)\n$$\n这个表达式，$\\beta F_{\\text{id}}(\\eta) = \\eta\\ln(\\eta) - \\eta$，是著名的 $0D$ 理想气体的无量纲自由能。\n\n最后，超额亥姆霍兹自由能是相互作用自由能与理想气体自由能之差：\n$$\n\\beta F_{\\text{hs}}^{\\text{(0D)}}(\\eta) = \\beta F_{\\text{int}}(\\eta) - \\beta F_{\\text{id}}(\\eta)\n$$\n$$\n\\beta F_{\\text{hs}}^{\\text{(0D)}}(\\eta) = \\big[ (1-\\eta)\\ln(1-\\eta) + \\eta\\ln(\\eta) \\big] - \\big[ \\eta\\ln(\\eta) - \\eta \\big]\n$$\n$$\n\\beta F_{\\text{hs}}^{\\text{(0D)}}(\\eta) = (1-\\eta)\\ln(1-\\eta) + \\eta\\ln(\\eta) - \\eta\\ln(\\eta) + \\eta\n$$\n$$\n\\beta F_{\\text{hs}}^{\\text{(0D)}}(\\eta) = (1-\\eta)\\ln(1-\\eta) + \\eta\n$$\n这是在指定的零维极限下，硬球流体的无量纲超额亥姆霍兹自由能泛函的精确表达式，完全用平均占据数 $\\eta$ 表示。", "answer": "$$\n\\boxed{(1-\\eta)\\ln(1-\\eta) + \\eta}\n$$", "id": "2763950"}, {"introduction": "在建立了理论框架并形成了概念直觉之后，我们现在将这些工具应用于一个具体的物理系统。此实践涉及一维流体模型，并要求您验证任何有效物理理论的基石：热力学自洽性。您将通过两条独立的热力学路径——能量路径和压缩率路径——来推导压力，并通过解析推导与数值计算证明它们会得到相同的结果，从而证实所选平均场近似的内在一致性。[@problem_id:2629205]", "problem": "考虑一种一维空间中的均匀流体，它由长度为 $a$ 的不可穿透的棒（一维硬棒）组成，数密度为 $\\rho$，并可能受到一个吸引尾势的作用。在经典密度泛函理论 (DFT) 的框架内进行研究，其定义如下。亥姆霍兹自由能泛函被分解为一个理想部分和一个过量部分，其中过量部分又分为硬棒参考贡献和平均场吸引贡献。直接关联函数由过量自由能的二阶泛函导数定义。零波数下的结构因子和等温压缩率通过压缩率求和规则相联系。压强可以通过热力学路径（通过巨势最小值）和压缩率路径（通过对压缩率关系进行积分）来计算。\n\n模型设定：\n- 对势 $u(x)$ 由一个硬核和一个吸引尾组成：\n  - 对于 $|x| < a$，$u(x) = +\\infty$\n  - 对于 $|x| \\ge a$，$w(x) = -\\varepsilon \\exp\\!\\big(-\\kappa(|x| - a)\\big)$，其中 $\\varepsilon > 0$ 且 $\\kappa > 0$。\n- 使用约化单位，其中 $k_\\mathrm{B} T = 1$，因此所有能量都是无量纲的，所有压强都应以 $\\beta P$ 的形式报告，其中 $\\beta = 1$。所有长度的单位与 $a$ 相同；密度 $\\rho$ 的单位是长度的倒数。您必须在任何情况下都确保 $\\rho a < 1$。\n\n使用的基本定义：\n- 理想气体亥姆霍兹自由能密度 $f_\\mathrm{id}(\\rho)$、硬棒过量自由能密度 $f_\\mathrm{ex}^{\\mathrm{HR}}(\\rho)$ 和平均场吸引贡献 $f_\\mathrm{att}(\\rho)$ 以下式进入计算 $f(\\rho) = f_\\mathrm{id}(\\rho) + f_\\mathrm{ex}^{\\mathrm{HR}}(\\rho) + f_\\mathrm{att}(\\rho)$。\n- 化学势为 $\\mu(\\rho) = \\partial f(\\rho)/\\partial \\rho$（在恒定温度下）。\n- 对于均匀流体，压强的热力学路径为 $P_\\mathrm{T}(\\rho) = \\rho\\,\\mu(\\rho) - f(\\rho)$。\n- 过量平均场贡献源于对势，在密度上表现为双线性项，其二阶泛函导数定义了对直接关联函数 $c^{(2)}(x)$ 的平均场贡献。\n- 直接关联函数 $c^{(2)}(x)$ 由 $c^{(2)}(x-x') = -\\delta^2 \\big(\\beta F_\\mathrm{ex}[\\rho]\\big)/\\delta\\rho(x)\\,\\delta\\rho(x')$ 定义，在均匀密度 $\\rho$ 下求值；其在零波数下的空间傅里叶变换为 $\\tilde{c}(0) = \\int_{-\\infty}^{\\infty} c^{(2)}(x)\\,dx$。\n- 对于均匀流体，压缩率求和规则给出 $\\partial (\\beta P)/\\partial \\rho = 1 - \\rho\\,\\tilde{c}(0)$。\n- 硬棒参考系在一维中是可精确求解的；您可以使用其经过充分检验的状态方程或自由能，以确保您实现的任何路径中硬核部分的一致性。\n\n任务：\n1. 在经典密度泛函理论 (DFT) 框架内，从第一性原理出发，为上述均匀流体的无量纲压强 $\\beta P(\\rho)$ 推导出两个独立的表达式：\n   - 热力学路径 $P_\\mathrm{T}(\\rho)$，通过 $P = \\rho\\,\\mu - f$，使用将 $f(\\rho)$ 分解为理想、硬棒过量和平均场吸引部分的方法。\n   - 压缩率路径 $P_\\mathrm{C}(\\rho)$，通过在 $\\rho' = 0$ 到 $\\rho$ 的区间上对压缩率关系 $\\partial (\\beta P)/\\partial \\rho = 1 - \\rho\\,\\tilde{c}(0)$ 进行积分，边界条件为 $\\beta P(0) = 0$，并使用由相同的 $F_\\mathrm{ex}$ 分解（硬棒参考加上平均场吸引）所蕴含的直接关联函数。\n2. 在您的推导中，您必须：\n   - 确定与一维硬棒状态方程一致的精确硬棒过量自由能密度，并用其获得参考部分的 $P_\\mathrm{T}(\\rho)$。\n   - 计算吸引尾 $w(x)$ 的空间积分，以获得其对平均场自由能和 $\\tilde{c}(0)$ 的贡献，并将其一致地包含在两条路径中。\n   - 确保压缩率路径是作为 $\\partial(\\beta P)/\\partial \\rho'$ 从 $\\rho'=0$ 到 $\\rho$ 的显式 $\\rho'$ 积分来实现的；不要在未说明如何从被积函数得到闭式反导数的情况下，通过代入它来走捷径。\n3. 实现一个程序，该程序对下面的每个测试用例计算：\n   - 通过热力学路径计算的 $\\beta P_\\mathrm{T}(\\rho)$，\n   - 通过压缩率路径计算的 $\\beta P_\\mathrm{C}(\\rho)$（通过对 $\\rho'$ 进行数值积分），\n   - 绝对差 $\\Delta(\\rho) = \\big|\\beta P_\\mathrm{T}(\\rho) - \\beta P_\\mathrm{C}(\\rho)\\big|$。\n   您的数值积分必须具有足够高的精度，以确保任何差异都纯粹是数值上的，并且很小。\n\n测试套件：\n使用以下参数元组 $(a,\\kappa,\\varepsilon,\\rho)$，所有参数均采用约化单位，且 $\\beta = 1$：\n- 案例 $1$：$(1.0,\\,1.5,\\,0.5,\\,0.10)$。\n- 案例 $2$：$(1.0,\\,0.5,\\,1.5,\\,0.40)$。\n- 案例 $3$：$(1.0,\\,3.0,\\,2.0,\\,0.95)$。\n- 案例 $4$：$(0.5,\\,2.0,\\,1.0,\\,0.60)$。\n- 案例 $5$：$(1.0,\\,5.0,\\,5.0,\\,0.30)$。\n- 案例 $6$：$(1.0,\\,1.0,\\,1.0,\\,0.00)$。\n\n答案规格：\n- 对于每个案例，输出如上定义的单个浮点数 $\\Delta(\\rho)$。\n- 最终输出必须是一行，按顺序包含案例1到6的结果，形式为用方括号括起来的逗号分隔列表，例如 $[\\Delta_1,\\Delta_2,\\dots,\\Delta_6]$。\n- 所有输出都是无量纲的 $\\beta P$ 差值。不应打印任何其他文本。", "solution": "所提出的问题是流体统计力学中的一个标准练习，它在科学上是有效的、适定的且内部一致的。它要求从单个底层的自由能泛函出发，为一个一维流体模型推导并比较通向其状态方程的两条不同路径。这用于证明所选平均场近似的热力学一致性。我将进行所需的推导。\n\n该模型是一个一维硬棒流体，棒长为 $a$，具有成对吸引势尾。热力学状态由数密度 $\\rho$ 定义。所有计算都在约化单位下进行，其中热能 $k_\\mathrm{B}T = 1$，使得逆温度 $\\beta = 1$。分析仅限于堆积分数 $\\eta = \\rho a < 1$ 的物理区域内。\n\n总亥姆霍兹自由能密度 $f(\\rho)$ 分解为理想气体、硬棒过量和平均场吸引贡献：\n$$f(\\rho) = f_\\mathrm{id}(\\rho) + f_\\mathrm{ex}^{\\mathrm{HR}}(\\rho) + f_\\mathrm{att}(\\rho)$$\n所有自由能密度都以 $k_\\mathrm{B}T$ 为单位表示。\n\n**热力学压强 $P_\\mathrm{T}(\\rho)$ 的推导**\n\n对于均匀流体，压强的热力学路径由勒让德变换关系给出：\n$$\\beta P_\\mathrm{T}(\\rho) = \\rho\\,\\mu(\\rho) - f(\\rho)$$\n其中 $\\mu(\\rho) = \\partial f(\\rho)/\\partial \\rho$ 是化学势。为了计算这个值，我们必须首先确定 $f(\\rho)$ 的三个分量的显式形式。\n\n1.  **理想气体自由能密度, $f_\\mathrm{id}(\\rho)$**：一维理想气体的精确表达式是 $f_\\mathrm{id}(\\rho) = \\rho(\\ln(\\rho\\Lambda) - 1)$，其中 $\\Lambda$ 是热德布罗意波长。$\\Lambda$ 项对化学势贡献一个加性常数，并且不影响压强。因此，为了我们的目的，我们使用标准形式：\n    $$f_\\mathrm{id}(\\rho) = \\rho\\ln\\rho - \\rho$$\n\n2.  **硬棒过量自由能密度, $f_\\mathrm{ex}^{\\mathrm{HR}}(\\rho)$**：一维硬棒流体（Tonks 气体）的状态方程已知是精确的，即 $\\beta P^{\\mathrm{HR}}(\\rho) = \\rho/(1-\\rho a)$。与此状态方程一致的过量自由能密度是：\n    $$f_\\mathrm{ex}^{\\mathrm{HR}}(\\rho) = -\\rho\\ln(1 - \\rho a)$$\n    这可以通过将热力学压强公式应用于硬棒系统 $f^{\\mathrm{HR}}(\\rho) = f_\\mathrm{id}(\\rho) + f_\\mathrm{ex}^{\\mathrm{HR}}(\\rho)$ 来验证，该方法正确地恢复了 Tonks 气体的状态方程。\n\n3.  **平均场吸引自由能密度, $f_\\mathrm{att}(\\rho)$**：问题为势的吸引部分 $w(x)$ 指定了一个随机相或平均场近似。在此近似下，相应的过量自由能泛函在密度分布上是双线性的。对于密度为 $\\rho$ 的均匀流体，这简化为自由能密度中的一个二次项：\n    $$f_\\mathrm{att}(\\rho) = \\frac{1}{2}\\rho^2 \\int_{-\\infty}^{\\infty} \\beta w(x) \\,dx$$\n    在 $\\beta=1$ 的情况下，我们计算吸引尾 $w(x) = -\\varepsilon \\exp(-\\kappa(|x| - a))$ 在 $|x| \\geq a$ 上的积分。由于对称性，该积分为正半轴上积分的两倍：\n    $$\\int_{-\\infty}^{\\infty} w(x) \\,dx = 2 \\int_{a}^{\\infty} \\left[-\\varepsilon e^{-\\kappa(x-a)}\\right] \\,dx = -2\\varepsilon e^{\\kappa a} \\int_{a}^{\\infty} e^{-\\kappa x} \\,dx$$\n    $$= -2\\varepsilon e^{\\kappa a} \\left[ -\\frac{1}{\\kappa} e^{-\\kappa x} \\right]_{a}^{\\infty} = -2\\varepsilon e^{\\kappa a} \\left( 0 - \\left(-\\frac{1}{\\kappa}e^{-\\kappa a}\\right) \\right) = -\\frac{2\\varepsilon}{\\kappa}$$\n    让我们将吸引的积分强度定义为正常数 $\\alpha = 2\\varepsilon/\\kappa$。那么吸引自由能密度是：\n    $$f_\\mathrm{att}(\\rho) = -\\frac{\\alpha}{2}\\rho^2$$\n\n结合这些分量，总自由能密度为：\n$$f(\\rho) = (\\rho\\ln\\rho - \\rho) - \\rho\\ln(1 - \\rho a) - \\frac{\\alpha}{2}\\rho^2$$\n接下来，我们计算总化学势 $\\mu(\\rho) = \\partial f(\\rho)/\\partial \\rho$：\n$$\\mu(\\rho) = (\\ln\\rho + 1 - 1) - \\left( \\ln(1-\\rho a) + \\rho \\frac{-a}{1-\\rho a} \\right) - \\alpha\\rho$$\n$$\\mu(\\rho) = \\ln\\rho - \\ln(1-\\rho a) + \\frac{\\rho a}{1-\\rho a} - \\alpha\\rho$$\n最后，我们将 $f(\\rho)$ 和 $\\mu(\\rho)$ 代入压强公式：\n$$\\beta P_\\mathrm{T}(\\rho) = \\rho\\left[ \\ln\\rho - \\ln(1-\\rho a) + \\frac{\\rho a}{1-\\rho a} - \\alpha\\rho \\right] - \\left[ (\\rho\\ln\\rho - \\rho) - \\rho\\ln(1 - \\rho a) - \\frac{\\alpha}{2}\\rho^2 \\right]$$\n展开后对数项相消：\n$$\\beta P_\\mathrm{T}(\\rho) = (\\rho\\ln\\rho - \\rho\\ln(1-\\rho a)) + \\frac{\\rho^2 a}{1-\\rho a} - \\alpha\\rho^2 - (\\rho\\ln\\rho - \\rho\\ln(1-\\rho a)) + \\rho - \\frac{\\alpha}{2}\\rho^2$$\n$$\\beta P_\\mathrm{T}(\\rho) = \\rho + \\frac{\\rho^2 a}{1-\\rho a} - \\frac{\\alpha}{2}\\rho^2 = \\frac{\\rho(1-\\rho a) + \\rho^2 a}{1-\\rho a} - \\frac{\\alpha}{2}\\rho^2$$\n这简化为热力学压强的最终表达式：\n$$\\beta P_\\mathrm{T}(\\rho) = \\frac{\\rho}{1 - \\rho a} - \\frac{\\alpha}{2}\\rho^2$$\n\n**压缩率压强 $P_\\mathrm{C}(\\rho)$ 的推导**\n\n压缩率路径利用了压缩率求和规则，该规则将压强对密度的导数与直接关联函数 $c^{(2)}(x)$ 联系起来：\n$$\\frac{\\partial(\\beta P)}{\\partial \\rho} = 1 - \\rho\\,\\tilde{c}(0)$$\n其中 $\\tilde{c}(0) = \\int_{-\\infty}^{\\infty} c^{(2)}(x) \\,dx$。压强是通过将此关系从零密度状态（在该状态下压强必须为零）积分得到的：\n$$\\beta P_\\mathrm{C}(\\rho) = \\int_{0}^{\\rho} \\left( 1 - \\rho'\\,\\tilde{c}(0;\\rho') \\right) \\,d\\rho'$$\n\n直接关联函数由过量自由能泛函的二阶泛函导数定义，$c^{(2)}(x-x') = -\\delta^2(\\beta F_\\mathrm{ex})/\\delta\\rho(x)\\delta\\rho(x')$。由于我们的过量自由能是一个和，$F_\\mathrm{ex} = F_\\mathrm{ex}^{\\mathrm{HR}} + F_\\mathrm{att}$，直接关联函数也是一个和，$c^{(2)}(x) = c_\\mathrm{HR}^{(2)}(x) + c_\\mathrm{att}^{(2)}(x)$。这种可加性也延续到其积分上，$\\tilde{c}(0) = \\tilde{c}_\\mathrm{HR}(0) + \\tilde{c}_\\mathrm{att}(0)$。\n\n1.  **对 $\\tilde{c}(0)$ 的吸引贡献**：对于指定的平均场泛函 $\\beta F_\\mathrm{att}[\\rho] = \\frac{1}{2} \\iint \\rho(x) w(x-x') \\rho(x') \\,dx\\,dx'$，其二阶泛函导数直接给出：\n    $$c_\\mathrm{att}^{(2)}(x) = -\\beta w(x)$$\n    对其积分得到对 $\\tilde{c}(0)$ 的贡献，该贡献与密度无关：\n    $$\\tilde{c}_\\mathrm{att}(0) = \\int_{-\\infty}^{\\infty} [-\\beta w(x)] \\,dx = - \\int_{-\\infty}^{\\infty} w(x) \\,dx = -(-\\alpha) = \\alpha$$\n\n2.  **对 $\\tilde{c}(0)$ 的硬棒贡献**：对于硬棒系统，压缩率关系为 $\\partial(\\beta P^{\\mathrm{HR}})/\\partial \\rho = 1 - \\rho\\,\\tilde{c}_\\mathrm{HR}(0)$。我们不需要 $\\tilde{c}_\\mathrm{HR}(0;\\rho)$ 的显式形式；相反，我们可以使用已知的压强导数：\n    $$\\frac{\\partial(\\beta P^{\\mathrm{HR}})}{\\partial\\rho} = \\frac{\\partial}{\\partial\\rho} \\left( \\frac{\\rho}{1-\\rho a} \\right) = \\frac{(1)(1-\\rho a) - (\\rho)(-a)}{(1-\\rho a)^2} = \\frac{1}{(1-\\rho a)^2}$$\n    因此，$1 - \\rho\\,\\tilde{c}_\\mathrm{HR}(0) = 1/(1-\\rho a)^2$。\n\n现在我们为总压强组装完整的被积函数：\n$$\\frac{\\partial(\\beta P)}{\\partial\\rho} = 1 - \\rho\\left[\\tilde{c}_\\mathrm{HR}(0;\\rho) + \\tilde{c}_\\mathrm{att}(0)\\right] = \\left[1 - \\rho\\,\\tilde{c}_\\mathrm{HR}(0;\\rho)\\right] - \\rho\\,\\tilde{c}_\\mathrm{att}(0)$$\n代入各部分的表达式：\n$$\\frac{\\partial(\\beta P)}{\\partial\\rho} = \\frac{1}{(1-\\rho a)^2} - \\rho\\alpha$$\n\n问题要求对该表达式的积分进行数值评估。因此，通过压缩率路径得到的压强由以下定积分给出：\n$$\\beta P_\\mathrm{C}(\\rho) = \\int_{0}^{\\rho} \\left( \\frac{1}{(1-\\rho'a)^2} - \\alpha\\rho' \\right) \\,d\\rho'$$\n\n为了验证，我们可以解析地计算这个积分：\n$$\\int_{0}^{\\rho} \\left( \\frac{1}{(1-\\rho'a)^2} - \\alpha\\rho' \\right) \\,d\\rho' = \\left[ \\frac{1}{a(1-\\rho'a)} - \\frac{\\alpha}{2}(\\rho')^2 \\right]_{0}^{\\rho}$$\n$$= \\left(\\frac{1}{a(1-\\rho a)} - \\frac{\\alpha}{2}\\rho^2\\right) - \\left(\\frac{1}{a(1-0)} - 0\\right) = \\frac{1 - (1-\\rho a)}{a(1-\\rho a)} - \\frac{\\alpha}{2}\\rho^2$$\n$$= \\frac{\\rho a}{a(1-\\rho a)} - \\frac{\\alpha}{2}\\rho^2 = \\frac{\\rho}{1-\\rho a} - \\frac{\\alpha}{2}\\rho^2$$\n$P_\\mathrm{C}(\\rho)$ 的解析结果与 $P_\\mathrm{T}(\\rho)$ 的表达式完全相同。这证实了平均场模型的热力学自洽性。数值实现将计算差值 $\\Delta(\\rho) = |\\beta P_\\mathrm{T}(\\rho) - \\beta P_\\mathrm{C}(\\rho)|$，该值仅由于数值积分算法的有限精度而应为非零。\n\n**数值实现**\n\n附带的程序实现了这两条路径。$\\beta P_\\mathrm{T}(\\rho)$ 使用其闭式表达式计算。$\\beta P_\\mathrm{C}(\\rho)$ 是通过使用 `scipy.integrate.quad` 函数（一种高精度自适应求积方法）对 $\\partial(\\beta P)/\\partial\\rho$ 的导出表达式从 $\\rho'=0$ 到 $\\rho$进行数值积分来计算的。然后为每个测试用例计算绝对差 $\\Delta(\\rho)$。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import quad\n\ndef solve():\n    \"\"\"\n    Computes and compares pressure in a 1D fluid model via two thermodynamic routes.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each tuple is (a, kappa, epsilon, rho)\n    test_cases = [\n        (1.0, 1.5, 0.5, 0.10),\n        (1.0, 0.5, 1.5, 0.40),\n        (1.0, 3.0, 2.0, 0.95),\n        (0.5, 2.0, 1.0, 0.60),\n        (1.0, 5.0, 5.0, 0.30),\n        (1.0, 1.0, 1.0, 0.00),\n    ]\n\n    results = []\n\n    def integrand(rho_prime, a, alpha):\n        \"\"\"\n        The integrand for the compressibility route, representing d(beta*P)/d(rho').\n        It is the sum of the hard-rod and attractive contributions.\n        \n        Args:\n            rho_prime (float): The integration variable (density).\n            a (float): The hard rod length.\n            alpha (float): The integrated strength of the attraction.\n            \n        Returns:\n            float: The value of the derivative of pressure w.r.t. density.\n        \"\"\"\n        # The hard-rod part is d(P_HR)/d(rho) = 1 / (1 - rho*a)^2\n        # The attractive part is d(P_att)/d(rho) = -alpha * rho\n        return 1.0 / (1.0 - rho_prime * a)**2 - alpha * rho_prime\n\n    for case in test_cases:\n        a, kappa, epsilon, rho = case\n\n        # Handle the trivial case of zero density.\n        if rho == 0.0:\n            results.append(0.0)\n            continue\n\n        # Calculate the integrated strength of the attractive potential, alpha.\n        # alpha = 2 * epsilon / kappa\n        alpha = 2.0 * epsilon / kappa\n\n        # 1. Thermodynamic Route (P_T)\n        # beta*P_T = rho/(1-rho*a) - (alpha/2)*rho^2\n        # This is the sum of the exact hard-rod pressure and the mean-field attractive pressure.\n        p_thermo = rho / (1.0 - rho * a) - (alpha / 2.0) * rho**2\n\n        # 2. Compressibility Route (P_C)\n        # beta*P_C is the integral of d(beta*P)/d(rho') from 0 to rho.\n        # We use numerical quadrature as required.\n        p_compressibility, _ = quad(integrand, 0, rho, args=(a, alpha))\n\n        # 3. Absolute Difference\n        # The difference should be close to zero, limited by numerical precision.\n        delta = abs(p_thermo - p_compressibility)\n        results.append(delta)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```", "id": "2629205"}]}