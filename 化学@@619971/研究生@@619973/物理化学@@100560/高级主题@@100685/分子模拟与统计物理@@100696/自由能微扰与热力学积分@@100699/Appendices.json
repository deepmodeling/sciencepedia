{"hands_on_practices": [{"introduction": "这个练习旨在巩固自由能微扰（FEP）的理论基础。您将从统计力学的第一性原理出发，推导著名的兹旺齐格方程（Zwanzig equation），这是自由能计算的基石之一 [@problem_id:2774310]。通过将此公式应用于一个可解析求解的谐振子模型，您将对一个抽象的统计平均如何转化为具体的自由能差获得切实的理解。", "problem": "一个经典粒子在与绝对温度为 $T$ 的热浴接触的实数轴上运动，其坐标为 $x$，该系统由正则系综描述。考虑两个势能函数，参考势能 $U_{A}(x)=\\tfrac{1}{2} k x^{2}$（力常数 $k0$），以及微扰势能 $U_{B}(x)=U_{A}(x)+\\epsilon x$，其中 $\\epsilon$ 是一个具有力维度的常数。令 $F_{A}$ 和 $F_{B}$ 分别表示相应的亥姆霍兹自由能。仅使用配分函数 $Z=\\int \\exp(-\\beta U)\\,\\mathrm{d}x$ 和亥姆霍兹自由能 $F=-k_{B}T \\ln Z$ 的正则定义（其中 $k_{B}$ 是玻尔兹曼常数，$\\beta=1/(k_{B}T)$），从第一性原理推导一个关系式，将自由能差 $\\Delta F \\equiv F_{B}-F_{A}$ 表示为在由 $U_{A}(x)$ 生成的分布上的构型系综平均。然后，对于谐振子参考势能 $U_{A}(x)=\\tfrac{1}{2} k x^{2}$，精确计算该平均值，以获得 $\\Delta F$ 作为一个仅含 $k$ 和 $\\epsilon$ 的函数的闭式解析表达式。将最终能量以焦耳为单位表示。以单个解析表达式的形式提供最终答案；不要代入数值或进行任何四舍五入。", "solution": "首先对问题陈述进行验证。\n\n**步骤1：提取已知条件**\n- 系统：一个在实数轴上运动的经典粒子，坐标为 $x$。\n- 系综：正则系综，绝对温度为 $T$。\n- 参考势能：$U_{A}(x)=\\tfrac{1}{2} k x^{2}$，其中 $k0$ 是力常数。\n- 微扰势能：$U_{B}(x)=U_{A}(x)+\\epsilon x$，其中 $\\epsilon$ 是一个常数力。\n- 亥姆霍兹自由能：$F_{A}$ 对应于势能为 $U_A$ 的系统，$F_{B}$ 对应于势能为 $U_B$ 的系统。\n- 配分函数定义：$Z=\\int \\exp(-\\beta U)\\,\\mathrm{d}x$。积分范围为整个实数轴，从 $-\\infty$ 到 $+\\infty$。\n- 亥姆霍兹自由能定义：$F=-k_{B}T \\ln Z$。\n- 常数：$k_{B}$ 是玻尔兹曼常数，且 $\\beta = 1/(k_{B}T)$。\n- 目标1：推导一个将自由能差 $\\Delta F \\equiv F_{B}-F_{A}$ 表示为在由 $U_{A}(x)$ 生成的分布上的构型系综平均的关系式。\n- 目标2：对给定的 $U_{A}(x)$ 计算该平均值。\n- 目标3：获得 $\\Delta F$ 作为一个仅含 $k$ 和 $\\epsilon$ 的函数的闭式解析表达式。\n- 最终格式要求：最终能量表达式的单位应为焦耳。\n\n**步骤2：使用提取的已知条件进行验证**\n该问题在科学上基于经典统计力学的原理。它提出了一个计算受线性项微扰的谐振子自由能差的标准教科书案例。势能 $U_A(x)$ 和 $U_B(x)$ 是良态的，确保了相应的配分函数是收敛的高斯积分。该问题是适定的、自洽的，并且所有术语都有明确定义。这是一个可形式化的理论化学/物理问题，具体涉及自由能微扰理论。该问题没有科学或事实上的不健全之处，没有矛盾，也没有缺失信息。要求将最终能量以焦耳为单位表示，这被解释为要求最终表达式具有能量量纲，这是标准做法。\n\n**步骤3：结论与行动**\n该问题被判定为**有效**。将从第一性原理构建解答。\n\n**推导与解答**\n\n亥姆霍兹自由能 $F$ 通过正则配分函数 $Z$ 定义为 $F = -k_{B}T \\ln Z$，其中 $Z = \\int_{-\\infty}^{\\infty} \\exp(-\\beta U(x))\\,\\mathrm{d}x$ 且 $\\beta = (k_{B}T)^{-1}$。\n\n对于参考系统 A 和微扰系统 B，各自的自由能为：\n$$F_{A} = -k_{B}T \\ln Z_{A}$$\n$$F_{B} = -k_{B}T \\ln Z_{B}$$\n其中\n$$Z_{A} = \\int_{-\\infty}^{\\infty} \\exp(-\\beta U_{A}(x))\\,\\mathrm{d}x$$\n$$Z_{B} = \\int_{-\\infty}^{\\infty} \\exp(-\\beta U_{B}(x))\\,\\mathrm{d}x$$\n\n自由能差为 $\\Delta F = F_{B} - F_{A}$：\n$$\\Delta F = (-k_{B}T \\ln Z_{B}) - (-k_{B}T \\ln Z_{A}) = -k_{B}T (\\ln Z_{B} - \\ln Z_{A}) = -k_{B}T \\ln\\left(\\frac{Z_{B}}{Z_{A}}\\right)$$\n\n我们现在来表示比值 $Z_{B}/Z_{A}$。我们将 $U_{B}(x) = U_{A}(x) + \\epsilon x$ 的定义代入 $Z_B$ 的表达式中：\n$$Z_{B} = \\int_{-\\infty}^{\\infty} \\exp(-\\beta (U_{A}(x) + \\epsilon x))\\,\\mathrm{d}x = \\int_{-\\infty}^{\\infty} \\exp(-\\beta U_{A}(x)) \\exp(-\\beta \\epsilon x)\\,\\mathrm{d}x$$\n\n于是该比值为：\n$$\\frac{Z_{B}}{Z_{A}} = \\frac{\\int_{-\\infty}^{\\infty} \\exp(-\\beta U_{A}(x)) \\exp(-\\beta \\epsilon x)\\,\\mathrm{d}x}{\\int_{-\\infty}^{\\infty} \\exp(-\\beta U_{A}(x))\\,\\mathrm{d}x}$$\n\n我们认识到这就是正则系综平均的定义。在参考系综 (A) 中，在位置 $x$ 处找到粒子的概率密度函数由下式给出：\n$$\\rho_{A}(x) = \\frac{\\exp(-\\beta U_{A}(x))}{Z_{A}}$$\n在参考系综中，某个量 $Q(x)$ 的系综平均定义为 $\\langle Q \\rangle_{A} = \\int_{-\\infty}^{\\infty} Q(x) \\rho_{A}(x)\\,\\mathrm{d}x$。\n\n因此，比值 $Z_{B}/Z_A$ 正是在由 $U_A(x)$ 生成的分布上对量 $\\exp(-\\beta \\epsilon x)$ 的系综平均：\n$$\\frac{Z_{B}}{Z_{A}} = \\int_{-\\infty}^{\\infty} \\frac{\\exp(-\\beta U_{A}(x))}{Z_{A}} \\exp(-\\beta \\epsilon x)\\,\\mathrm{d}x = \\langle \\exp(-\\beta \\epsilon x) \\rangle_{A}$$\n\n将此代回 $\\Delta F$ 的表达式，我们得到所求的关系式，这是自由能微扰理论的一个基本结果：\n$$\\Delta F = -k_{B}T \\ln \\langle \\exp(-\\beta \\epsilon x) \\rangle_{A}$$\n这将自由能差表示为一个完全在参考态 A 上计算的系综平均的函数。\n\n下一步是为给定的谐振子参考势能 $U_{A}(x) = \\frac{1}{2} k x^{2}$ 精确计算该系综平均值。\n需要计算的平均值为：\n$$\\langle \\exp(-\\beta \\epsilon x) \\rangle_{A} = \\frac{\\int_{-\\infty}^{\\infty} \\exp(-\\beta (\\frac{1}{2}kx^{2})) \\exp(-\\beta \\epsilon x)\\,\\mathrm{d}x}{\\int_{-\\infty}^{\\infty} \\exp(-\\beta (\\frac{1}{2}kx^{2}))\\,\\mathrm{d}x}$$\n\n分母是配分函数 $Z_A$。它是一个形式为 $\\int_{-\\infty}^{\\infty} \\exp(-ax^{2}) \\mathrm{d}x = \\sqrt{\\pi/a}$ 的标准高斯积分。令 $a = \\frac{\\beta k}{2}$，我们得到：\n$$Z_{A} = \\sqrt{\\frac{2\\pi}{\\beta k}}$$\n\n分子积分，我们称之为 $I_{num}$，是：\n$$I_{num} = \\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{\\beta k}{2}x^{2} - \\beta \\epsilon x\\right)\\,\\mathrm{d}x$$\n这也是一个高斯积分，我们可以通过对指数部分进行配方法来求解：\n$$-\\frac{\\beta k}{2}x^{2} - \\beta \\epsilon x = -\\frac{\\beta k}{2}\\left(x^{2} + \\frac{2\\epsilon}{k}x\\right) = -\\frac{\\beta k}{2}\\left(\\left(x + \\frac{\\epsilon}{k}\\right)^{2} - \\frac{\\epsilon^{2}}{k^{2}}\\right)$$\n$$= -\\frac{\\beta k}{2}\\left(x + \\frac{\\epsilon}{k}\\right)^{2} + \\frac{\\beta \\epsilon^{2}}{2k}$$\n\n将此代回 $I_{num}$ 的积分中：\n$$I_{num} = \\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{\\beta k}{2}\\left(x + \\frac{\\epsilon}{k}\\right)^{2} + \\frac{\\beta \\epsilon^{2}}{2k}\\right)\\,\\mathrm{d}x$$\n$$I_{num} = \\exp\\left(\\frac{\\beta \\epsilon^{2}}{2k}\\right) \\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{\\beta k}{2}\\left(x + \\frac{\\epsilon}{k}\\right)^{2}\\right)\\,\\mathrm{d}x$$\n令 $y = x + \\frac{\\epsilon}{k}$，则 $\\mathrm{d}y = \\mathrm{d}x$。积分上下限保持为 $(-\\infty, \\infty)$。该积分变为：\n$$\\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{\\beta k}{2}y^{2}\\right)\\,\\mathrm{d}y = Z_{A}$$\n\n因此，分子是 $I_{num} = \\exp\\left(\\frac{\\beta \\epsilon^{2}}{2k}\\right) Z_{A}$。\n\n现在我们可以计算系综平均值：\n$$\\langle \\exp(-\\beta \\epsilon x) \\rangle_{A} = \\frac{I_{num}}{Z_{A}} = \\frac{\\exp\\left(\\frac{\\beta \\epsilon^{2}}{2k}\\right) Z_{A}}{Z_{A}} = \\exp\\left(\\frac{\\beta \\epsilon^{2}}{2k}\\right)$$\n\n最后，我们计算自由能差 $\\Delta F$：\n$$\\Delta F = -k_{B}T \\ln \\left( \\exp\\left(\\frac{\\beta \\epsilon^{2}}{2k}\\right) \\right) = -k_{B}T \\left( \\frac{\\beta \\epsilon^{2}}{2k} \\right)$$\n使用定义 $\\beta = (k_{B}T)^{-1}$：\n$$\\Delta F = -k_{B}T \\left( \\frac{1}{k_{B}T} \\frac{\\epsilon^{2}}{2k} \\right) = -\\frac{\\epsilon^{2}}{2k}$$\n\n这就是自由能差 $\\Delta F$ 作为一个仅含 $k$ 和 $\\epsilon$ 的函数的最终闭式表达式。$\\epsilon$ 的单位是力 ($[F]$)，$k$ 的单位是力/长度 ($[F]/[L]$)。该表达式的单位是 $[F]^2 / ([F]/[L]) = [F] \\cdot [L]$，也就是能量。因此，在国际单位制（SI system）中，该表达式的单位是焦耳，满足了问题的所有条件。", "answer": "$$\n\\boxed{-\\frac{\\epsilon^{2}}{2k}}\n$$", "id": "2774310"}, {"introduction": "在FEP框架的基础上，这个实践介绍了其强大的对应方法：热力学积分（TI）。您将使用三种不同的方法——直接计算、TI和FEP——来计算同一谐振子系统的自由能差 [@problem_id:2642319]。这个练习有力地阐释了自由能作为状态函数的概念，证明了计算出的差值与所选择的计算路径无关，从而加深了您对这些核心方法等价性的理解。", "problem": "考虑一个经典一维谐振子，其势能为 $U(x;k)=\\tfrac{1}{2}k x^{2}$，其中 $k0$ 是力常数，$x$ 是笛卡尔坐标。在正则系综中，于恒定温度 $T$ 下进行计算。假设只考虑构型贡献（动能项与 $k$ 无关，在不同 $k$ 值的状态之间的自由能差计算中会相消）。令 $k_{B}$ 表示玻尔兹曼常数，且 $\\beta \\equiv 1/(k_{B}T)$。\n\na) 从正则构型配分函数的定义 $Z_{\\mathrm{conf}}(k,T)=\\int_{-\\infty}^{\\infty}\\exp\\!\\left(-\\beta U(x;k)\\right)\\,\\mathrm{d}x$ 出发，推导精确的构型亥姆霍兹自由能 $A_{\\mathrm{conf}}(k,T)$。\n\nb) 考虑在恒定温度 $T$ 下，将力常数从 $k_{0}0$ 变为 $k_{1}0$。引入一个耦合参数 $\\lambda\\in[0,1]$，它定义了一个插值哈密顿量 $U_{\\lambda}(x)=\\tfrac{1}{2}k(\\lambda)x^{2}$，其中 $k(\\lambda)=(1-\\lambda)k_{0}+\\lambda k_{1}$。从系综的基本定义出发，使用热力学积分（TI）方法推导自由能差 $\\Delta A \\equiv A_{\\mathrm{conf}}(k_{1},T)-A_{\\mathrm{conf}}(k_{0},T)$ 的表达式，其中 TI 表示热力学积分。\n\nc) 从正则配分函数之比出发，对此同一变换，推导并精确计算自由能微扰（FEP）估计量，其中FEP表示自由能微扰。也就是说，将 $\\Delta A$ 表示为在 $k_{0}$ 参考系综下的平均值，并解析地计算该平均值。\n\n你的最终答案应为 $\\Delta A$ 的一个单一、闭合形式的解析表达式，用 $k_{0}$、$k_{1}$、$k_{B}$ 和 $T$ 表示。不需要进行数值计算。将最终结果表示为单个解析表达式。最终方框内的答案不要包含单位。", "solution": "该问题陈述经核实具有科学依据、提法恰当且客观。它基于经典统计力学的标准原理，提出了一个可通过既有方法轻松解决的典型问题。不存在逻辑矛盾、信息缺失或事实不准确之处。该问题有效。我们开始求解。\n\n该问题要求计算当一维经典谐振子的力常数在恒温 $T$ 下从 $k_{0}$ 变为 $k_{1}$ 时的亥姆霍兹自由能差 $\\Delta A$。我们将按要求通过三种不同的方法推导这个量。\n\n(a) 精确的构型亥姆霍兹自由能 $A_{\\mathrm{conf}}(k,T)$\n\n对于一个在温度 $T$ 下势能为 $U(x;k)$ 的系统，其构型配分函数 $Z_{\\mathrm{conf}}$ 由下式给出\n$$\nZ_{\\mathrm{conf}}(k,T) = \\int_{-\\infty}^{\\infty} \\exp(-\\beta U(x;k)) \\, \\mathrm{d}x\n$$\n其中 $\\beta = 1/(k_{B}T)$。对于谐振子，势能为 $U(x;k) = \\frac{1}{2}kx^{2}$。将此代入配分函数的定义，得到\n$$\nZ_{\\mathrm{conf}}(k,T) = \\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{1}{2}\\beta k x^{2}\\right) \\, \\mathrm{d}x\n$$\n这是一个形式为 $\\int_{-\\infty}^{\\infty} \\exp(-ax^{2}) \\, \\mathrm{d}x = \\sqrt{\\frac{\\pi}{a}}$ 的标准高斯积分。在我们的情况中，常数 $a$ 是 $\\frac{\\beta k}{2}$。因此，该积分的计算结果为\n$$\nZ_{\\mathrm{conf}}(k,T) = \\sqrt{\\frac{\\pi}{\\frac{\\beta k}{2}}} = \\sqrt{\\frac{2\\pi}{\\beta k}}\n$$\n亥姆霍兹自由能 $A$ 通过基本方程 $A = -k_{B}T \\ln Z = -\\frac{1}{\\beta} \\ln Z$ 与配分函数 $Z$ 相关。因此，对亥姆霍兹自由能的构型贡献为\n$$\nA_{\\mathrm{conf}}(k,T) = -\\frac{1}{\\beta} \\ln Z_{\\mathrm{conf}}(k,T) = -\\frac{1}{\\beta} \\ln\\left(\\sqrt{\\frac{2\\pi}{\\beta k}}\\right)\n$$\n利用对数性质 $\\ln(\\sqrt{y}) = \\frac{1}{2}\\ln(y)$，我们得到\n$$\nA_{\\mathrm{conf}}(k,T) = -\\frac{1}{2\\beta} \\ln\\left(\\frac{2\\pi}{\\beta k}\\right) = \\frac{1}{2\\beta} \\ln\\left(\\frac{\\beta k}{2\\pi}\\right)\n$$\n这就是一维谐振子构型亥姆霍兹自由能的精确表达式。\n\n(b) 通过热力学积分（TI）计算自由能差\n\n热力学积分（TI）提供了一种计算两个状态之间自由能差的方法，即对哈密顿量相对于耦合参数 $\\lambda$ 的导数的系综平均值进行积分。自由能差由下式给出\n$$\n\\Delta A = \\int_{0}^{1} \\left\\langle \\frac{\\partial U_{\\lambda}(x)}{\\partial \\lambda} \\right\\rangle_{\\lambda} \\, \\mathrm{d}\\lambda\n$$\n其中 $U_{\\lambda}(x)$ 是在状态 0（$\\lambda=0$）和状态 1（$\\lambda=1$）之间插值的系统势能，$\\langle \\dots \\rangle_{\\lambda}$ 表示在势能为 $U_{\\lambda}(x)$ 的系统上进行的系综平均。\n\n插值势由 $U_{\\lambda}(x) = \\frac{1}{2}k(\\lambda)x^{2}$ 给出，其中 $k(\\lambda) = (1-\\lambda)k_{0} + \\lambda k_{1}$。首先，我们计算 $U_{\\lambda}(x)$ 对 $\\lambda$ 的偏导数：\n$$\n\\frac{\\partial U_{\\lambda}(x)}{\\partial \\lambda} = \\frac{1}{2} \\frac{\\mathrm{d}k(\\lambda)}{\\mathrm{d}\\lambda} x^{2} = \\frac{1}{2} (k_{1} - k_{0}) x^{2}\n$$\n接下来，我们必须在由势能 $U_{\\lambda}(x)$ 定义的正则系综中计算这个量的系综平均值 $\\langle \\frac{\\partial U_{\\lambda}(x)}{\\partial \\lambda} \\rangle_{\\lambda}$：\n$$\n\\left\\langle \\frac{\\partial U_{\\lambda}(x)}{\\partial \\lambda} \\right\\rangle_{\\lambda} = \\left\\langle \\frac{1}{2} (k_{1} - k_{0}) x^{2} \\right\\rangle_{\\lambda} = \\frac{1}{2} (k_{1} - k_{0}) \\langle x^{2} \\rangle_{\\lambda}\n$$\n量 $\\langle x^{2} \\rangle_{\\lambda}$ 是力常数为 $k(\\lambda)$ 的谐振子的均方位移。对于经典一维谐振子，能量均分定理指出其平均势能为 $\\langle \\frac{1}{2}k(\\lambda)x^{2} \\rangle_{\\lambda} = \\frac{1}{2}k_{B}T$。由此，我们直接得到均方位移：\n$$\n\\langle x^{2} \\rangle_{\\lambda} = \\frac{k_{B}T}{k(\\lambda)} = \\frac{1}{\\beta k(\\lambda)}\n$$\n将此结果代入系综平均导数的表达式，得到\n$$\n\\left\\langle \\frac{\\partial U_{\\lambda}(x)}{\\partial \\lambda} \\right\\rangle_{\\lambda} = \\frac{1}{2} (k_{1} - k_{0}) \\frac{1}{\\beta k(\\lambda)} = \\frac{k_{1} - k_{0}}{2\\beta((1-\\lambda)k_{0} + \\lambda k_{1})}\n$$\n现在我们可以对 $\\lambda$ 从 0 到 1 进行积分：\n$$\n\\Delta A = \\int_{0}^{1} \\frac{k_{1} - k_{0}}{2\\beta((1-\\lambda)k_{0} + \\lambda k_{1})} \\, \\mathrm{d}\\lambda\n$$\n设分母为 $f(\\lambda) = (1-\\lambda)k_{0} + \\lambda k_{1} = k_{0} + \\lambda(k_{1}-k_{0})$。其导数为 $f'(\\lambda) = k_{1} - k_{0}$。该积分的形式为 $\\int \\frac{f'(\\lambda)}{f(\\lambda)}\\mathrm{d}\\lambda = \\ln(f(\\lambda))$。\n$$\n\\Delta A = \\frac{1}{2\\beta} \\left[ \\ln\\left((1-\\lambda)k_{0} + \\lambda k_{1}\\right) \\right]_{0}^{1} = \\frac{1}{2\\beta} (\\ln(k_{1}) - \\ln(k_{0})) = \\frac{1}{2\\beta} \\ln\\left(\\frac{k_{1}}{k_{0}}\\right)\n$$\n\n(c) 通过自由能微扰（FEP）计算自由能差\n\n自由能微扰（FEP）公式，也称为 Zwanzig 方程，将自由能差表示为在参考态上计算的势能差的系综平均值。选择力常数为 $k_{0}$ 的初始态作为参考态，公式为\n$$\n\\Delta A = A_{1} - A_{0} = -\\frac{1}{\\beta} \\ln \\left\\langle \\exp\\left(-\\beta (U_{1}(x) - U_{0}(x))\\right) \\right\\rangle_{0}\n$$\n这里，$U_{0}(x) = \\frac{1}{2}k_{0}x^{2}$，$U_{1}(x) = \\frac{1}{2}k_{1}x^{2}$，$\\langle \\dots \\rangle_{0}$ 表示在参考态 0 上的系综平均。势能差为 $\\Delta U(x) = U_{1}(x) - U_{0}(x) = \\frac{1}{2}(k_{1}-k_{0})x^{2}$。\n\n系综平均计算如下\n$$\n\\left\\langle \\exp(-\\beta \\Delta U(x)) \\right\\rangle_{0} = \\frac{\\int_{-\\infty}^{\\infty} \\exp(-\\beta \\Delta U(x)) \\exp(-\\beta U_{0}(x)) \\, \\mathrm{d}x}{\\int_{-\\infty}^{\\infty} \\exp(-\\beta U_{0}(x)) \\, \\mathrm{d}x}\n$$\n分子被积函数中指数的自变量为\n$$\n-\\beta \\Delta U(x) - \\beta U_{0}(x) = -\\beta \\left(\\frac{1}{2}(k_{1}-k_{0})x^{2} + \\frac{1}{2}k_{0}x^{2}\\right) = -\\frac{1}{2}\\beta k_{1}x^{2} = -\\beta U_1(x)\n$$\n因此，系综平均是两个配分函数之比：\n$$\n\\left\\langle \\exp(-\\beta \\Delta U(x)) \\right\\rangle_{0} = \\frac{\\int_{-\\infty}^{\\infty} \\exp(-\\beta U_{1}(x)) \\, \\mathrm{d}x}{\\int_{-\\infty}^{\\infty} \\exp(-\\beta U_{0}(x)) \\, \\mathrm{d}x} = \\frac{Z_{\\mathrm{conf}}(k_1, T)}{Z_{\\mathrm{conf}}(k_0, T)}\n$$\n使用 (a) 部分得到的 $Z_{\\mathrm{conf}}$ 结果，$Z_{\\mathrm{conf}}(k,T) = \\sqrt{\\frac{2\\pi}{\\beta k}}$，我们有\n$$\n\\frac{Z_{\\mathrm{conf}}(k_1, T)}{Z_{\\mathrm{conf}}(k_0, T)} = \\frac{\\sqrt{\\frac{2\\pi}{\\beta k_{1}}}}{\\sqrt{\\frac{2\\pi}{\\beta k_{0}}}} = \\sqrt{\\frac{k_{0}}{k_{1}}}\n$$\n将此代回 $\\Delta A$ 的 FEP 公式中：\n$$\n\\Delta A = -\\frac{1}{\\beta} \\ln\\left(\\sqrt{\\frac{k_{0}}{k_{1}}}\\right) = -\\frac{1}{2\\beta} \\ln\\left(\\frac{k_{0}}{k_{1}}\\right) = \\frac{1}{2\\beta} \\ln\\left(\\frac{k_{1}}{k_{0}}\\right)\n$$\n所有三种方法——从 $A$ 的定义直接计算、热力学积分和自由能微扰——均得出相同的结果，这与一致性要求相符。将 $\\beta = 1/(k_{B}T)$ 代入，即可推导出亥姆霍兹自由能变化量的最终表达式：\n$$\n\\Delta A = \\frac{1}{2}k_{B}T \\ln\\left(\\frac{k_{1}}{k_{0}}\\right)\n$$\n这就是所求的 $\\Delta A$ 的单一、闭合形式的解析表达式。", "answer": "$$\n\\boxed{\\frac{1}{2} k_{B} T \\ln\\left(\\frac{k_{1}}{k_{0}}\\right)}\n$$", "id": "2642319"}, {"introduction": "在实际的模拟中，由于采样问题，直接应用兹旺齐格方程可能具有挑战性。这个高级问题探讨了一个至关重要的理论和实践近似，它将自由能差与势能差 $\\Delta U$ 的统计分布联系起来 [@problem_id:2642298]。通过假设该分布为高斯分布，您将推导出二阶累积量展开公式，这一结果为理解状态重叠与计算得到的自由能之间的关系提供了深刻的见解。", "problem": "考虑两个分别标记为 $0$ 和 $1$ 的经典多粒子态，其在绝对温度 $T$ 下的势能函数分别为 $U_{0}(\\mathbf{x})$ 和 $U_{1}(\\mathbf{x})$。设亥姆霍兹自由能差定义为 $\\Delta A \\equiv A_{1}-A_{0}$，其中 $A_{i}=-k_{B}T \\ln Z_{i}$，且 $Z_{i}=\\int \\exp(-\\beta U_{i}(\\mathbf{x}))\\,d\\mathbf{x}$ 为正则配分函数，其中 $\\beta \\equiv 1/(k_{B}T)$ 且 $k_{B}$ 为玻尔兹曼常数。定义态 $0$ 的平衡概率密度为 $\\pi_{0}(\\mathbf{x})=Z_{0}^{-1}\\exp(-\\beta U_{0}(\\mathbf{x}))$，势能差为 $\\Delta U(\\mathbf{x}) \\equiv U_{1}(\\mathbf{x})-U_{0}(\\mathbf{x})$。假定在 $\\pi_{0}$ 分布下，随机变量 $\\Delta U$ 服从均值为 $\\mu$、方差为 $\\sigma^{2}$ 的高斯分布，即相对于 $\\pi_{0}$ 有 $\\Delta U \\sim \\mathcal{N}(\\mu,\\sigma^{2})$。\n\n仅使用上述正则定义和关于 $\\Delta U$ 的高斯假设，推导自由能差 $\\Delta A$ 的一个封闭形式表达式，该表达式应以 $\\mu$、$\\sigma$、$k_{B}$ 和 $T$ 表示。然后，基于统计力学的第一性原理和高斯矩生成函数的性质，解释您所推导表达式的有效性范围（形式上和实践中），内容需包括关于分布形状和抽样可靠性的假设。\n\n将最终答案表示为仅含 $\\mu$、$\\sigma$、$k_{B}$ 和 $T$ 的单个解析表达式。在最终的方框结果中，请勿代入数值或包含单位。无需四舍五入。", "solution": "该问题要求在特定假设下，即势能差 $\\Delta U$ 在从态 $0$ 的平衡系综中抽样时服从高斯分布，推导两态（$0$ 和 $1$）之间的亥姆霍兹自由能差 $\\Delta A$ 的封闭形式表达式。此外，问题还要求解释该表达式的有效性范围。\n\n推导从所提供的基本定义开始。态 $i$ 的亥姆霍兹自由能由 $A_{i} = -k_{B}T \\ln Z_{i}$ 给出，其中 $k_{B}$ 是玻尔兹曼常数，$T$ 是绝对温度，$Z_{i}$ 是态 $i$ 的正则配分函数。因此，自由能差为：\n$$\n\\Delta A = A_{1} - A_{0} = (-k_{B}T \\ln Z_{1}) - (-k_{B}T \\ln Z_{0}) = -k_{B}T \\ln\\left(\\frac{Z_{1}}{Z_{0}}\\right)\n$$\n配分函数由对系统所有微观态 $\\mathbf{x}$ 的积分定义：\n$$\nZ_{i} = \\int \\exp(-\\beta U_{i}(\\mathbf{x}))\\,d\\mathbf{x}\n$$\n其中 $\\beta = 1/(k_{B}T)$，$U_{i}(\\mathbf{x})$ 是态 $i$ 的势能函数。\n\n为了计算配分函数的比值，我们执行一个自由能微扰理论中的核心标准操作。我们将比值 $Z_{1}/Z_{0}$ 表示如下：\n$$\n\\frac{Z_{1}}{Z_{0}} = \\frac{\\int \\exp(-\\beta U_{1}(\\mathbf{x}))\\,d\\mathbf{x}}{Z_{0}}\n$$\n我们将被积函数同乘以并同除以一个非零量 $\\exp(-\\beta U_{0}(\\mathbf{x}))$：\n$$\n\\frac{Z_{1}}{Z_{0}} = \\int \\frac{\\exp(-\\beta U_{1}(\\mathbf{x}))}{\\exp(-\\beta U_{0}(\\mathbf{x}))} \\frac{\\exp(-\\beta U_{0}(\\mathbf{x}))}{Z_{0}} \\,d\\mathbf{x}\n$$\n利用势能差 $\\Delta U(\\mathbf{x}) = U_{1}(\\mathbf{x}) - U_{0}(\\mathbf{x}))$ 和态 $0$ 的平衡概率密度 $\\pi_{0}(\\mathbf{x}) = Z_{0}^{-1}\\exp(-\\beta U_{0}(\\mathbf{x}))$ 的定义，上式可重写为：\n$$\n\\frac{Z_{1}}{Z_{0}} = \\int \\exp(-\\beta \\Delta U(\\mathbf{x})) \\pi_{0}(\\mathbf{x}) \\,d\\mathbf{x}\n$$\n根据定义，该积分是量 $\\exp(-\\beta \\Delta U)$ 在态 $0$ 系综上的期望值。我们将其期望值表示为 $\\langle \\exp(-\\beta \\Delta U) \\rangle_{0}$。\n$$\n\\frac{Z_{1}}{Z_{0}} = \\langle \\exp(-\\beta \\Delta U) \\rangle_{0}\n$$\n将此结果代入 $\\Delta A$ 的表达式，得到 Zwanzig 方程：\n$$\n\\Delta A = -k_{B}T \\ln\\langle \\exp(-\\beta \\Delta U) \\rangle_{0}\n$$\n现在，我们必须引入问题的核心假设：随机变量 $\\Delta U$ 在根据概率密度 $\\pi_{0}(\\mathbf{x})$ 抽样时，服从均值为 $\\mu$、方差为 $\\sigma^{2}$ 的高斯分布 $\\mathcal{N}(\\mu, \\sigma^{2})$。\n\n期望值 $\\langle \\exp(-\\beta \\Delta U) \\rangle_{0}$ 等价于随机变量 $\\Delta U$ 的矩生成函数 (MGF) 在 $t = -\\beta$ 处的值，该函数记为 $M_{\\Delta U}(t)$。随机变量 $X$ 的矩生成函数定义为 $M_{X}(t) = \\langle \\exp(tX) \\rangle$。对于一个服从高斯分布的随机变量 $X \\sim \\mathcal{N}(\\mu, \\sigma^{2})$，其矩生成函数是概率论中的一个标准结果：\n$$\nM_{X}(t) = \\exp\\left(\\mu t + \\frac{1}{2}\\sigma^{2}t^{2}\\right)\n$$\n将此应用于我们的变量 $\\Delta U$，并在 $t = -\\beta$ 处求值：\n$$\n\\langle \\exp(-\\beta \\Delta U) \\rangle_{0} = M_{\\Delta U}(-\\beta) = \\exp\\left(\\mu(-\\beta) + \\frac{1}{2}\\sigma^{2}(-\\beta)^{2}\\right) = \\exp\\left(-\\beta\\mu + \\frac{1}{2}\\beta^{2}\\sigma^{2}\\right)\n$$\n现在我们将此结果代回 $\\Delta A$ 的表达式中：\n$$\n\\Delta A = -k_{B}T \\ln\\left[\\exp\\left(-\\beta\\mu + \\frac{1}{2}\\beta^{2}\\sigma^{2}\\right)\\right]\n$$\n对数和指数是互为反函数，这可将表达式简化为：\n$$\n\\Delta A = -k_{B}T \\left(-\\beta\\mu + \\frac{1}{2}\\beta^{2}\\sigma^{2}\\right)\n$$\n最后，代入 $\\beta = 1/(k_{B}T)$：\n$$\n\\Delta A = -k_{B}T \\left(-\\frac{\\mu}{k_{B}T} + \\frac{1}{2}\\frac{\\sigma^{2}}{(k_{B}T)^{2}}\\right) = \\mu - \\frac{\\sigma^{2}}{2k_{B}T}\n$$\n这就是在给定高斯假设下，自由能差的封闭形式表达式。\n\n此表达式的有效性范围必须从两个角度来考虑：形式上的和实践中的。\n\n形式上，推导 $\\Delta A = \\mu - \\frac{\\sigma^{2}}{2k_{B}T}$ 是一个精确的恒等式，它完全取决于一个前提，即在 $\\pi_{0}$ 分布下 $\\Delta U$ 的分布是完美的高斯分布。这是因为自由能差可以表示为累积量展开式：\n$$\n\\Delta A = \\sum_{n=1}^{\\infty} \\frac{(-\\beta)^{n-1}}{n!} C_{n} = C_{1} - \\frac{\\beta}{2}C_{2} + \\frac{\\beta^{2}}{6}C_{3} - \\dots\n$$\n其中 $C_{n}$ 是 $\\Delta U$ 分布的 n 阶累积量。对于任何分布，$C_{1} = \\mu$ 且 $C_{2} = \\sigma^{2}$。高斯分布的一个定义性属性是，所有阶数 $n  2$ 的累积量都恒等于零（$C_{3}=C_{4}=\\dots=0$）。因此，对于一个完美的高斯分布，累积量级数在第二项后精确截断，从而得到我们推导出的结果。\n\n在实践中，真实物理系统中 $\\Delta U$ 的分布很少（如果曾经有过的话）是完美高斯分布。该表达式作为近似的有效性取决于几个因素：\n$1$. 分布形状：只有当 $\\Delta U$ 的真实分布接近高斯分布时，该近似才准确。这种情况更可能发生在大型复杂系统中，其中总能量差 $\\Delta U$ 源于许多微小、弱相关的贡献之和，从而引发一种类中心极限定理的行为。如果 $\\Delta U$ 由少数几个强的、特定的相互作用（例如，单个共价键或关键氢键的形成或断裂）主导，该近似将会失效，因为这可能导致高度偏斜甚至双峰的分布。从累积量的角度来看，这意味着当高阶累积量（如偏度 $C_{3}$ 和超额峰度 $C_{4}$）与 $\\mu$ 和 $\\sigma^{2}$ 相比可以忽略不计时，该近似是有效的。\n$2$. 态的重叠：方差 $\\sigma^{2}$ 可作为衡量态 $0$ 和态 $1$ 势能面之间“距离”或重叠度不足的指标。小方差（例如 $\\sigma \\lesssim k_{B}T$）意味着良好的重叠，这表示态 $1$ 的重要构型在态 $0$ 的系综中得到了相当好的抽样。在这种情况下，$\\Delta U$ 分布较窄，更可能对称且表现良好，从而使得高斯近似更为稳健。相反，大方差（$\\sigma \\gg k_{B}T$）表示重叠性差，此时 $\\Delta U$ 分布较宽。在这种情况下，分布更容易出现非高斯特征（例如重尾），二阶近似会失效。\n$3$. 抽样可靠性：尽管计算 $\\mu = \\langle \\Delta U \\rangle_{0}$ 和 $\\sigma^{2} = \\langle (\\Delta U - \\mu)^{2} \\rangle_{0}$ 通常比直接计算 $\\langle \\exp(-\\beta \\Delta U) \\rangle_{0}$（后者对分布尾部的罕见事件高度敏感）在统计上要稳定得多，但最终结果的准确性仍然取决于获得这两个初阶矩的收敛估计。任何实际计算，例如分子动力学模拟，都必须足够长，以充分抽样态 $0$ 的相空间，确保计算出的 $\\mu$ 和 $\\sigma^{2}$ 能代表真实的平衡值。不充分的抽样将导致有偏的矩和不准确的 $\\Delta A$。\n\n总而言之，该表达式对于高斯能量差分布是形式上精确的。在实践中，当两个态足够相似（$\\sigma^{2}$ 较小）、系统足够复杂以致中心极限定理近似成立，以及计算抽样足以使能量差的均值和方差收敛时，它是一个有用的近似。", "answer": "$$\\boxed{\\mu - \\frac{\\sigma^{2}}{2k_{B}T}}$$", "id": "2642298"}]}