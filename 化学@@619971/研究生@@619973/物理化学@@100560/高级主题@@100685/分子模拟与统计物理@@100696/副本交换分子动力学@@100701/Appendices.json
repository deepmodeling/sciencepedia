{"hands_on_practices": [{"introduction": "副本交换分子动力学（REMD）中的交换接受概率公式取决于瞬时能量，但这如何转化为整个模拟过程中的平均接受率呢？此练习将使用高斯近似这一常见而强大的工具，来处理能量涨落的统计特性。通过这项实践，您将把微观的 Metropolis 准则与宏观的、可观测的模拟性能联系起来，从而能够分析和理解为何给定的温度间距会产生特定的交换效率。", "problem": "在副本交换分子动力学 (REMD) 中，两个处于逆温 $\\beta_1$ 和 $\\beta_2$ 的副本尝试以 Metropolis 接受概率交换温度，该概率由 $\\min\\!\\left(1,\\exp\\!\\left((\\beta_1-\\beta_2)\\,(E_1-E_2)\\right)\\right)$ 给出，其中 $E_1$ 和 $E_2$ 是分别在温度 $T_1$ 和 $T_2$ 下从正则系综中独立抽样的瞬时势能。考虑两个相邻的温度 $T_1=300\\ \\mathrm{K}$ 和 $T_2=330\\ \\mathrm{K}$。假设在这些温度下测得的能量统计数据（能量以每摩尔表示）近似为高斯分布，其均值为 $\\mu_1=-500.0\\ \\mathrm{kJ\\,mol^{-1}}$ 和 $\\mu_2=-440.0\\ \\mathrm{kJ\\,mol^{-1}}$，方差为 $\\sigma_1^2=1496.6033\\ \\mathrm{kJ^2\\,mol^{-2}}$ 和 $\\sigma_2^2=1810.8900\\ \\mathrm{kJ^2\\,mol^{-2}}$。假设两个能量样本是独立的，并且正则能量分布的高斯近似是有效的。\n\n仅从正则系综的定义、交换的 Metropolis 接受准则以及上述的独立性和高斯假设出发，推导在这些条件下期望交换接受概率的解析表达式，并进行数值计算。使用气体常数 $R=0.008314462618\\ \\mathrm{kJ\\,mol^{-1}\\,K^{-1}}$，以便 $\\beta_i = 1/(R T_i)$ 与每摩尔能量单位保持一致。将最终的期望接受概率四舍五入到四位有效数字。最终答案以纯数字形式表示（无单位）。", "solution": "所述问题具有科学依据、提法明确且客观。所有必要数据和明确定义的假设均已提供。它代表了副本交换分子动力学模拟分析中的一个标准计算。因此，该问题是有效的，并将提供解答。\n\n目标是计算在逆温 $\\beta_1$ 和 $\\beta_2$ 下两个副本之间进行交换的 Metropolis 接受概率的期望值 $\\langle P_{\\text{acc}} \\rangle$。接受概率由下式给出：\n$$\nP_{\\text{acc}}(E_1, E_2) = \\min\\!\\left(1, \\exp\\!\\left((\\beta_1-\\beta_2)(E_1-E_2)\\right)\\right)\n$$\n其中 $E_1$ 和 $E_2$ 是副本的势能。它们是从各自的正则系综中独立抽取的随机变量。问题陈述这些能量分布近似为高斯分布：$E_1 \\sim \\mathcal{N}(\\mu_1, \\sigma_1^2)$ 和 $E_2 \\sim \\mathcal{N}(\\mu_2, \\sigma_2^2)$。\n\n我们定义逆温差 $\\Delta\\beta = \\beta_1 - \\beta_2$ 和能量差 $\\Delta E = E_1 - E_2$。接受概率简化为 $P_{\\text{acc}}(\\Delta E) = \\min(1, \\exp(\\Delta\\beta \\Delta E))$。由于 $E_1$ 和 $E_2$ 是独立的高斯随机变量，它们的差 $\\Delta E$ 也是一个高斯随机变量。其分布为 $\\Delta E \\sim \\mathcal{N}(\\mu_{\\Delta}, \\sigma_{\\Delta}^2)$，参数如下：\n均值：$\\mu_{\\Delta} = \\mathbb{E}[E_1 - E_2] = \\mathbb{E}[E_1] - \\mathbb{E}[E_2] = \\mu_1 - \\mu_2$。\n方差：$\\sigma_{\\Delta}^2 = \\text{Var}(E_1 - E_2) = \\text{Var}(E_1) + \\text{Var}(-E_2) = \\text{Var}(E_1) + (-1)^2\\text{Var}(E_2) = \\sigma_1^2 + \\sigma_2^2$。\n\n期望接受概率通过对 $\\Delta E$ 的概率分布（我们记为 $p_{\\Delta}(x)$）进行积分来求得：\n$$\n\\langle P_{\\text{acc}} \\rangle = \\mathbb{E}[P_{\\text{acc}}(\\Delta E)] = \\int_{-\\infty}^{\\infty} \\min(1, \\exp(\\Delta\\beta x)) p_{\\Delta}(x) dx\n$$\n其中 $p_{\\Delta}(x) = \\frac{1}{\\sqrt{2\\pi\\sigma_{\\Delta}^2}} \\exp\\left(-\\frac{(x - \\mu_{\\Delta})^2}{2\\sigma_{\\Delta}^2}\\right)$。\n\n给定 $T_1 = 300\\ \\mathrm{K}$ 和 $T_2 = 330\\ \\mathrm{K}$，我们有 $T_1  T_2$，这意味着 $\\beta_1 = 1/(RT_1)  1/(RT_2) = \\beta_2$。因此，$\\Delta\\beta  0$。这使我们能够根据指数函数参数 $x = \\Delta E$ 的符号来拆分积分：\n- 如果 $x  0$，那么 $\\Delta\\beta x  0$，所以 $\\exp(\\Delta\\beta x)  1$，并且 $\\min(1, \\exp(\\Delta\\beta x)) = 1$。\n- 如果 $x \\le 0$，那么 $\\Delta\\beta x \\le 0$，所以 $\\exp(\\Delta\\beta x) \\le 1$，并且 $\\min(1, \\exp(\\Delta\\beta x)) = \\exp(\\Delta\\beta x)$。\n\n因此，期望积分被拆分为两部分：\n$$\n\\langle P_{\\text{acc}} \\rangle = \\int_{0}^{\\infty} 1 \\cdot p_{\\Delta}(x) dx + \\int_{-\\infty}^{0} \\exp(\\Delta\\beta x) p_{\\Delta}(x) dx\n$$\n第一个积分是 $\\Delta E  0$ 的概率，可以用标准正态分布的累积分布函数（CDF）表示，$\\Phi(z) = \\frac{1}{\\sqrt{2\\pi}} \\int_{-\\infty}^z \\exp(-t^2/2) dt$。\n$$\n\\int_{0}^{\\infty} p_{\\Delta}(x) dx = P(\\Delta E  0) = 1 - P(\\Delta E \\le 0) = 1 - \\Phi\\left(\\frac{0 - \\mu_{\\Delta}}{\\sigma_{\\Delta}}\\right) = 1 - \\Phi\\left(-\\frac{\\mu_{\\Delta}}{\\sigma_{\\Delta}}\\right) = \\Phi\\left(\\frac{\\mu_{\\Delta}}{\\sigma_{\\Delta}}\\right)\n$$\n第二个积分需要我们合并被积函数中的指数项：\n$$\n\\int_{-\\infty}^{0} \\exp(\\Delta\\beta x) \\frac{1}{\\sqrt{2\\pi\\sigma_{\\Delta}^2}} \\exp\\left(-\\frac{(x - \\mu_{\\Delta})^2}{2\\sigma_{\\Delta}^2}\\right) dx\n$$\n通过对指数中的 $x$ 进行配方，可以将此积分求解为一个常数因子乘以另一个高斯变量的CDF。这个过程最终得到一个解析表达式。\n将所有部分组合起来，最终的解析表达式为：\n$$\n\\langle P_{\\text{acc}} \\rangle = \\Phi\\left(\\frac{\\mu_{\\Delta}}{\\sigma_{\\Delta}}\\right) + \\exp\\left(\\mu_{\\Delta}\\Delta\\beta + \\frac{\\sigma_{\\Delta}^2(\\Delta\\beta)^2}{2}\\right) \\Phi\\left(-\\frac{\\mu_{\\Delta} + \\sigma_{\\Delta}^2\\Delta\\beta}{\\sigma_{\\Delta}}\\right)\n$$\n现在，我们代入给定的数值。\n$R = 0.008314462618\\ \\mathrm{kJ\\,mol^{-1}\\,K^{-1}}$。\n温度：$T_1 = 300\\ \\mathrm{K}$， $T_2 = 330\\ \\mathrm{K}$。\n$\\Delta\\beta = \\frac{1}{R}\\left(\\frac{1}{T_1} - \\frac{1}{T_2}\\right) = \\frac{1}{0.008314462618}\\left(\\frac{1}{300} - \\frac{1}{330}\\right) = \\frac{1}{0.008314462618}\\left(\\frac{30}{99000}\\right) \\approx 0.036446164\\ (\\mathrm{kJ\\,mol^{-1}})^{-1}$。\n\n能量统计：\n$\\mu_1 = -500.0\\ \\mathrm{kJ\\,mol^{-1}}$， $\\mu_2 = -440.0\\ \\mathrm{kJ\\,mol^{-1}}$。\n$\\sigma_1^2 = 1496.6033\\ \\mathrm{kJ^2\\,mol^{-2}}$， $\\sigma_2^2 = 1810.8900\\ \\mathrm{kJ^2\\,mol^{-2}}$。\n\n$\\Delta E$ 分布的参数：\n$\\mu_{\\Delta} = \\mu_1 - \\mu_2 = -500.0 - (-440.0) = -60.0\\ \\mathrm{kJ\\,mol^{-1}}$。\n$\\sigma_{\\Delta}^2 = \\sigma_1^2 + \\sigma_2^2 = 1496.6033 + 1810.8900 = 3307.4933\\ \\mathrm{kJ^2\\,mol^{-2}}$。\n$\\sigma_{\\Delta} = \\sqrt{3307.4933} \\approx 57.5108085\\ \\mathrm{kJ\\,mol^{-1}}$。\n\n我们计算解析表达式中函数的参数：\n第一个 $\\Phi$ 的参数：$\\frac{\\mu_{\\Delta}}{\\sigma_{\\Delta}} = \\frac{-60.0}{57.5108085} \\approx -1.043282$。\n$\\Phi(-1.043282) \\approx 0.14841$。\n\n指数项的指数：$\\mu_{\\Delta}\\Delta\\beta + \\frac{\\sigma_{\\Delta}^2(\\Delta\\beta)^2}{2}$\n第 1 项：$\\mu_{\\Delta}\\Delta\\beta = -60.0 \\times 0.036446164 \\approx -2.186770$。\n第 2 项：$\\frac{\\sigma_{\\Delta}^2(\\Delta\\beta)^2}{2} = \\frac{3307.4933 \\times (0.036446164)^2}{2} \\approx \\frac{4.393433}{2} = 2.196717$。\n指数 = $-2.186770 + 2.196717 = 0.009947$。\n$\\exp(0.009947) \\approx 1.009996$。\n\n第二个 $\\Phi$ 的参数：$-\\frac{\\mu_{\\Delta} + \\sigma_{\\Delta}^2\\Delta\\beta}{\\sigma_{\\Delta}}$\n$\\sigma_{\\Delta}^2\\Delta\\beta = 3307.4933 \\times 0.036446164 \\approx 120.5483$。\n参数 $= -\\frac{-60.0 + 120.5483}{57.5108085} = -\\frac{60.5483}{57.5108085} \\approx -1.052816$。\n$\\Phi(-1.052816) \\approx 0.14620$。\n\n最后，我们计算 $\\langle P_{\\text{acc}} \\rangle$：\n$\\langle P_{\\text{acc}} \\rangle \\approx 0.14841 + (1.009996) \\times (0.14620) \\approx 0.14841 + 0.147661 \\approx 0.296071$。\n\n四舍五入到四位有效数字，结果是 $0.2961$。", "answer": "$$\n\\boxed{0.2961}\n$$", "id": "2666608"}, {"introduction": "上一个练习展示了如何根据能量统计数据来预测交换接受率，现在我们将解决其逆问题：如何选择合适的温度阶梯以达到理想的接受率。此练习利用了接受率、温度间距以及系统热容 $C_V$ 之间的关系。这项实践是一项至关重要的设计技能，能帮助您设置高效的 REMD 模拟，确保副本之间有良好的混合，同时避免因温度设置过近或过远而浪费计算资源。", "problem": "为一个系统构建一个复本交换分子动力学 (REMD) 温度阶梯，该系统在参考温度 $T = 300\\ \\mathrm{K}$ 附近的定容热容为 $C_V = 1000\\,k_{\\mathrm{B}}$。在定容热容恒定的正则系综能量涨落的高斯模型下，通过对两个复本的联合正则能量分布上的 Metropolis 接受准则进行平均，可以从第一性原理得到相邻温度 $T$ 和 $T+\\Delta T$ 之间的期望交换接受概率。仅使用正则系综的基本关系、Metropolis 准则以及由大热容所保证的高斯近似，推导接受概率作为温度比的函数，并用它来估计该系统在 $T=300\\ \\mathrm{K}$ 时达到 $0.3$ 的期望接受率所需的温度增量 $\\Delta T$。\n\n以 $\\mathrm{K}$ 为单位表示您对 $\\Delta T$ 的最终答案，并将结果四舍五入到四位有效数字。", "solution": "所述问题在科学上是合理的、内容自洽且定义明确。它要求在一组特定的标准近似下推导复本交换分子动力学 (REMD) 的接受概率，并进行后续的数值计算。我们将着手进行解答。\n\n复本交换的基本原理是在系统复本的扩展系综上执行一次蒙特卡洛移动，该移动包括交换两个复本的温度。考虑两个复本 $1$ 和 $2$，它们具有固定的构型，势能分别为 $E_1$ 和 $E_2$。复本 $1$ 处于温度 $T_1$（逆温度 $\\beta_1 = 1/(k_B T_1)$），复本 $2$ 处于温度 $T_2$（逆温度 $\\beta_2 = 1/(k_B T_2)$）。此状态在扩展正则系综中的总概率正比于 $\\exp(-\\beta_1 E_1 - \\beta_2 E_2)$。\n\n提议进行一次交换，将温度 $T_2$ 分配给复本 $1$，温度 $T_1$ 分配给复本 $2$。新状态的概率正比于 $\\exp(-\\beta_2 E_1 - \\beta_1 E_2)$。此交换的接受概率由 Metropolis 准则给出：\n$$\np_{\\text{swap}}(E_1, E_2) = \\min\\left(1, \\exp\\left((\\beta_1 - \\beta_2)(E_1 - E_2)\\right)\\right)\n$$\n令 $\\Delta\\beta = \\beta_1 - \\beta_2$ 且 $\\Delta E = E_1 - E_2$。则接受概率为：\n$$\np_{\\text{swap}}(\\Delta E) = \\min(1, \\exp(\\Delta\\beta \\cdot \\Delta E))\n$$\n在模拟中，能量 $E_1$ 和 $E_2$ 是从其各自温度下的正则概率分布 $P(E_1; T_1)$ 和 $P(E_2; T_2)$ 中抽取的随机变量，可以近似为高斯分布。根据统计力学，能量方差为 $\\sigma_E^2 = k_B T^2 C_V$，平均能量变化为 $d\\langle E \\rangle = C_V dT$。由于两个复本独立，能量差 $\\Delta E = E_1 - E_2$ 也是高斯分布的。\n\n期望接受概率 $\\langle p \\rangle$ 是通过对 $\\Delta E$ 的概率分布上的 $p_{\\text{swap}}(\\Delta E)$ 进行平均得到的。令 $X = \\Delta\\beta \\cdot \\Delta E$。精确计算 $\\langle p \\rangle = \\int \\min(1, e^x)P(x)dx$ 需要求解一个复杂的积分（如练习1所示），这使得直接求解 $\\Delta T$ 变得困难。然而，一个在实践中广泛使用且准确的近似是，对于小的温度间隔（$\\Delta T \\ll T$），平均接受概率可以简化为：\n$$\n\\langle p \\rangle \\approx 2\\Phi\\left(-\\frac{\\sigma_X}{2}\\right)\n$$\n其中 $\\sigma_X$ 是变量 $X$ 的标准差，$\\Phi$ 是标准正态分布的累积分布函数（CDF）。此近似在小 $\\Delta T$ 极限下成立，此时有 $\\sigma_X^2 \\approx -2\\langle X \\rangle$。\n此外，在小 $\\Delta T$ 近似下，$\\sigma_X$ 本身也可以简化。令 $T_1=T, T_2=T+\\Delta T$：\n$$\n\\sigma_X^2 = (\\Delta\\beta)^2 \\text{Var}(\\Delta E) = \\left(\\frac{\\Delta T}{k_B T(T+\\Delta T)}\\right)^2 k_B C_V (T^2 + (T+\\Delta T)^2) \\approx \\frac{C_V}{k_B} \\frac{(\\Delta T)^2 (T^2+T^2)}{(T^2)^2} = 2\\frac{C_V}{k_B} \\left(\\frac{\\Delta T}{T}\\right)^2\n$$\n因此，$\\sigma_X \\approx \\sqrt{2 \\frac{C_V}{k_B}} \\frac{\\Delta T}{T}$。我们将使用这些近似来估计 $\\Delta T$。\n\n现在，我们必须根据给定的参数估计 $\\Delta T$：$\\langle p \\rangle = 0.3$，$C_V = 1000\\,k_B$ (因此 $C_V/k_B = 1000$)，以及 $T = 300\\ \\mathrm{K}$。\n需要求解的方程是：\n$$\n0.3 = 2\\Phi\\left(-\\frac{\\sigma_X}{2}\\right)\n$$\n首先，我们求出 $\\Phi$ 的自变量。令 $z = -\\sigma_X/2$。\n$$\n\\Phi(z) = \\frac{0.3}{2} = 0.15\n$$\n使用标准正态分布的逆累积分布函数，我们求出 $z$ 的值：\n$$\nz = \\Phi^{-1}(0.15) \\approx -1.036433\n$$\n因此，我们得到 $-\\sigma_X/2 \\approx -1.036433$，即 $\\sigma_X \\approx 2.072866$。\n现在代入 $\\sigma_X$ 的近似表达式：\n$$\n2.072866 \\approx \\sqrt{2 \\frac{C_V}{k_B}} \\frac{\\Delta T}{T} = \\sqrt{2 \\times 1000} \\frac{\\Delta T}{300}\n$$\n求解 $\\Delta T$：\n$$\n\\Delta T \\approx \\frac{2.072866 \\times 300}{\\sqrt{2000}} = \\frac{621.8598}{44.72136} \\approx 13.905\\ \\mathrm{K}\n$$\n将结果四舍五入到四位有效数字，得到 $\\Delta T = 13.91\\ \\mathrm{K}$。", "answer": "$$\\boxed{13.91}$$", "id": "2666613"}]}