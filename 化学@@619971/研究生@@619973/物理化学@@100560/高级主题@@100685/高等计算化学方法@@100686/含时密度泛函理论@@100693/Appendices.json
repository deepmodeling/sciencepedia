{"hands_on_practices": [{"introduction": "理论计算的威力在于它能连接微观世界的构型与宏观世界的可观测量。本练习将引导你使用位移谐振子模型，将 TD-DFT 计算中得到的激发态相对于基态的几何结构弛豫（以简正坐标位移 $\\Delta Q$ 表示）与光谱实验中的斯托克斯位移建立直接联系。通过这个实践，你将深刻理解分子的光物理过程（吸收、弛豫、发射）是如何由其势能面的形态决定的，这是连接电子结构理论与实验光谱学的关键一步。[@problem_id:2466206]", "problem": "考虑一个与线性响应含时密度泛函理论 (TD-DFT) 一致的模型，其中分子的基态和第一电子激发态由共享同一组简正模的位移谐波势表示。设存在 $M$ 个独立的简正模，其无量纲简正坐标为 $\\{Q_i\\}_{i=1}^M$。基态势能面的最小值点在 $\\mathbf{Q}=\\mathbf{0}$ 处，而激发态势能面的最小值点在 $\\mathbf{Q}=\\Delta \\mathbf{Q}$ 处，其分量为 $\\{\\Delta Q_i\\}_{i=1}^M$。每个模式 $i$ 的振动量子为 $\\hbar \\omega_i$，单位为 $\\mathrm{eV}$。两个最小值点之间的绝热 $0\\text{–}0$ 能隙为 $E_{00}$，单位为 $\\mathrm{eV}$。假设 Condon 近似成立，不存在 Duschinsky 转动，态间曲率相同，并且在这些假设下零点能的差异可以忽略不计。\n\n模式 $i$ 的黄昆-里斯 (Huang–Rhys) 因子（无量纲）定义为 $S_i = \\dfrac{(\\Delta Q_i)^2}{2}$。利用位移谐波模型的第一性原理和 Franck–Condon 原理，对每组参数确定以下物理量：\n- 垂直吸收能 $E_{\\text{abs}}$，单位为 $\\mathrm{eV}$，\n- 垂直发射能 $E_{\\text{em}}$，单位为 $\\mathrm{eV}$，\n- 斯托克斯位移 $\\Delta_{\\text{Stokes}}$，单位为 $\\mathrm{eV}$，\n- 以及一个布尔值 $b$，如果 $\\Delta_{\\text{Stokes}}$ 大于或等于给定的目标值 $T$（单位为 $\\mathrm{eV}$），则 $b$ 为 $\\,\\texttt{True}\\,$，否则为 $\\,\\texttt{False}\\,$。\n\n报告的所有能量均以 $\\mathrm{eV}$ 为单位，并四舍五入到 $6$ 位小数。布尔值必须通过比较 $\\Delta_{\\text{Stokes}} \\ge T$ 来确定。本问题不涉及角度。本问题不涉及百分比。\n\n测试集（每个案例指定 $(E_{00}, \\{\\hbar \\omega_i\\}, \\{\\Delta Q_i\\}, T)$）：\n- 案例 1：$E_{00} = 2.50$，$\\{\\hbar \\omega_i\\} = [0.200,\\,0.150]$，$\\{\\Delta Q_i\\} = [1.0,\\,0.5]$，$T = 0.20$。\n- 案例 2：$E_{00} = 2.20$，$\\{\\hbar \\omega_i\\} = [0.100,\\,0.200]$，$\\{\\Delta Q_i\\} = [0.0,\\,0.0]$，$T = 0.05$。\n- 案例 3：$E_{00} = 1.80$，$\\{\\hbar \\omega_i\\} = [0.050,\\,0.080,\\,0.120]$，$\\{\\Delta Q_i\\} = [2.0,\\,1.0,\\,0.5]$，$T = 0.31$。\n- 案例 4：$E_{00} = 3.00$，$\\{\\hbar \\omega_i\\} = [0.180]$，$\\{\\Delta Q_i\\} = [3.0]$，$T = 1.70$。\n\n您的程序应生成单行输出，其中包含一个由方括号括起来的逗号分隔列表，列表中的每个测试案例结果本身也是一个形式为 $[E_{\\text{abs}}, E_{\\text{em}}, \\Delta_{\\text{Stokes}}, b]$ 的列表。格式中不能有多余的空格，能量值必须四舍五入到 $6$ 位小数。例如，一个有效的输出形式为 $[[x_1,y_1,z_1,\\texttt{True}],[x_2,y_2,z_2,\\texttt{False}]]$，其中 $x_k$、$y_k$ 和 $z_k$ 是四舍五入到 $6$ 位小数的数字字符串。", "solution": "经评估，问题陈述有效。其科学基础是量子力学和分子光谱学原理，特别是用于解释振动光谱的位移谐波振子模型。该问题提法恰当、客观，并为每个测试案例提供了推导唯一解所需的所有信息。所提供的物理参数是符合实际的。\n\n解法从指定模型的第一性原理推导得出。该模型包含两个电子态，即基态 ($g$) 和激发态 ($e$)，其势能面 $U_g$ 和 $U_e$ 在 $M$ 个无量纲简正坐标 $\\{Q_i\\}_{i=1}^M$ 的基上被描述为多维谐波势。\n\n基态势能面 $U_g(\\mathbf{Q})$ 的最小值点定义在原点 $\\mathbf{Q}=\\mathbf{0}$ 处，其表达式为：\n$$ U_g(\\mathbf{Q}) = \\sum_{i=1}^{M} \\frac{1}{2} \\hbar \\omega_i Q_i^2 $$\n其中 $\\hbar \\omega_i$ 是模式 $i$ 的振动量子。最小值点的能量为 $U_g(\\mathbf{0}) = 0$。\n\n激发态势能面 $U_e(\\mathbf{Q})$ 具有相同的振动频率（相同的曲率），但其最小值点位移至 $\\mathbf{Q} = \\Delta \\mathbf{Q}$，并且在能量上移动了绝热 $0\\text{–}0$ 能隙 $E_{00}$。其形式为：\n$$ U_e(\\mathbf{Q}) = E_{00} + \\sum_{i=1}^{M} \\frac{1}{2} \\hbar \\omega_i (Q_i - \\Delta Q_i)^2 $$\n激发态最小值点的能量为 $U_e(\\Delta \\mathbf{Q}) = E_{00}$。\n\n根据 Franck-Condon 原理，电子跃迁（吸收和发射）是垂直的，这意味着它们在核运动的时间尺度上是瞬时发生的。因此，在跃迁过程中核坐标不发生改变。\n\n垂直吸收能 $E_{\\text{abs}}$ 对应于从基态的平衡几何构型（$\\mathbf{Q}=\\mathbf{0}$）到激发态的跃迁。它是两个态在 $\\mathbf{Q}=\\mathbf{0}$ 处的能量差：\n$$ E_{\\text{abs}} = U_e(\\mathbf{0}) - U_g(\\mathbf{0}) $$\n代入势能表达式：\n$$ E_{\\text{abs}} = \\left( E_{00} + \\sum_{i=1}^{M} \\frac{1}{2} \\hbar \\omega_i (0 - \\Delta Q_i)^2 \\right) - 0 = E_{00} + \\sum_{i=1}^{M} \\frac{1}{2} \\hbar \\omega_i (\\Delta Q_i)^2 $$\n我们将重组能 $\\lambda$ 定义为将基态几何构型扭曲到激发态平衡几何构型所需的能量：\n$$ \\lambda = U_g(\\Delta \\mathbf{Q}) - U_g(\\mathbf{0}) = \\sum_{i=1}^{M} \\frac{1}{2} \\hbar \\omega_i (\\Delta Q_i)^2 $$\n因此，吸收能可以写成：\n$$ E_{\\text{abs}} = E_{00} + \\lambda $$\n\n垂直发射能 $E_{\\text{em}}$ 对应于从激发态的平衡几何构型（$\\mathbf{Q}=\\Delta \\mathbf{Q}$）到基态的跃迁。它是两个态在 $\\mathbf{Q}=\\Delta \\mathbf{Q}$ 处的能量差：\n$$ E_{\\text{em}} = U_e(\\Delta \\mathbf{Q}) - U_g(\\Delta \\mathbf{Q}) $$\n代入势能表达式和 $\\lambda$ 的定义：\n$$ E_{\\text{em}} = E_{00} - \\sum_{i=1}^{M} \\frac{1}{2} \\hbar \\omega_i (\\Delta Q_i)^2 = E_{00} - \\lambda $$\n\n斯托克斯位移 $\\Delta_{\\text{Stokes}}$ 是垂直吸收能和垂直发射能之间的差值：\n$$ \\Delta_{\\text{Stokes}} = E_{\\text{abs}} - E_{\\text{em}} $$\n代入推导出的 $E_{\\text{abs}}$ 和 $E_{\\text{em}}$ 的表达式：\n$$ \\Delta_{\\text{Stokes}} = (E_{00} + \\lambda) - (E_{00} - \\lambda) = 2\\lambda $$\n这可以用给定的参数明确表示为：\n$$ \\Delta_{\\text{Stokes}} = 2 \\sum_{i=1}^{M} \\frac{1}{2} \\hbar \\omega_i (\\Delta Q_i)^2 = \\sum_{i=1}^{M} \\hbar \\omega_i (\\Delta Q_i)^2 $$\n问题将黄昆-里斯 (Huang-Rhys) 因子定义为 $S_i = \\frac{(\\Delta Q_i)^2}{2}$。重组能也可以写成 $\\lambda = \\sum_i S_i \\hbar\\omega_i$。\n\n最后，通过将计算出的斯托克斯位移与给定的目标值 $T$ 直接比较来确定布尔值 $b$：\n$$ b = (\\Delta_{\\text{Stokes}} \\ge T) $$\n\n对于给定的参数集 $(E_{00}, \\{\\hbar \\omega_i\\}, \\{\\Delta Q_i\\}, T)$，算法如下：\n1. 计算总重组能 $\\lambda = \\sum_{i=1}^{M} \\frac{1}{2} \\hbar \\omega_i (\\Delta Q_i)^2$。\n2. 计算 $E_{\\text{abs}} = E_{00} + \\lambda$。\n3. 计算 $E_{\\text{em}} = E_{00} - \\lambda$。\n4. 计算 $\\Delta_{\\text{Stokes}} = 2\\lambda$。\n5. 通过评估条件 $\\Delta_{\\text{Stokes}} \\ge T$ 来确定 $b$。\n6. 报告四舍五入到 $6$ 位小数的能量和布尔值。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for vertical absorption/emission energies, Stokes shift, and a boolean\n    comparison based on a displaced harmonic oscillator model.\n    \"\"\"\n    # Test suite with parameters (E_00, {hbar*omega_i}, {Delta Q_i}, T).\n    # All energies are in eV. Delta Q_i are dimensionless.\n    test_cases = [\n        # Case 1\n        (2.50, [0.200, 0.150], [1.0, 0.5], 0.20),\n        # Case 2\n        (2.20, [0.100, 0.200], [0.0, 0.0], 0.05),\n        # Case 3\n        (1.80, [0.050, 0.080, 0.120], [2.0, 1.0, 0.5], 0.31),\n        # Case 4\n        (3.00, [0.180], [3.0], 1.70),\n    ]\n\n    results_str_list = []\n    for case in test_cases:\n        E00, hw_list, dQ_list, T = case\n        \n        # Convert lists to NumPy arrays for efficient vectorized calculations.\n        hw = np.array(hw_list)\n        dQ = np.array(dQ_list)\n\n        # Calculate the total reorganization energy (lambda) in eV.\n        # lambda = sum_i (1/2 * hbar*omega_i * (Delta Q_i)^2)\n        reorganization_energy = 0.5 * np.sum(hw * (dQ**2))\n        \n        # Calculate the vertical absorption energy (E_abs) in eV.\n        E_abs = E00 + reorganization_energy\n        \n        # Calculate the vertical emission energy (E_em) in eV.\n        E_em = E00 - reorganization_energy\n        \n        # The Stokes shift is the difference between absorption and emission,\n        # which equals twice the reorganization energy.\n        Delta_Stokes = 2.0 * reorganization_energy\n        \n        # Determine the boolean value by comparing the Stokes shift to the target T.\n        b = Delta_Stokes >= T\n        \n        # Format the results as a string according to requirements.\n        # Energies are rounded to 6 decimal places.\n        # Boolean is converted to a string ('True' or 'False').\n        case_result_str = (\n            f\"[{E_abs:.6f},\"\n            f\"{E_em:.6f},\"\n            f\"{Delta_Stokes:.6f},\"\n            f\"{str(b)}]\"\n        )\n        results_str_list.append(case_result_str)\n\n    # Join all case results into a single string for the final output.\n    final_output = f\"[{','.join(results_str_list)}]\"\n    print(final_output)\n\nsolve()\n```", "id": "2466206"}, {"introduction": "在利用 TD-DFT 探索未知领域之前，我们必须了解它的“阿喀琉斯之踵”。本练习将带你直面 TD-DFT 最著名的失败案例之一：长程电荷转移（CT）激发问题。你将从第一性原理出发，推导并计算物理上正确的 CT 激发能，并将其与使用标准泛函（如 GGA）的 TD-DFT 所得的错误结果进行对比。这个练习将让你从根本上理解为何局部和半局部泛函会系统性地低估 CT 激发能，这对于在实际研究中选择合适的计算方法至关重要。[@problem_id:2466214]", "problem": "你需要编写一个完整、可运行的程序，在一个最小化但有科学依据的模型中，演示含时密度泛函理论（TD-DFT）如何在使用标准广义梯度近似（GGA）泛函时，错误地预测空间分离的给体-受体对中存在一个虚假的低能量电荷转移激发。你的程序必须从第一性原理出发实现以下逻辑。\n\n从密度泛函理论（DFT）中电离势和电子亲和能的基本定义，以及分离电荷的静电相互作用出发。使用这些原理推导一个在大分离距离下，从给体到受体的最低电荷转移激发能的表达式。然后，使用线性响应 TD-DFT，并基于以下事实：对于空间上不重叠的轨道，绝热半局域 Hartree-交换-相关核产生的耦合可以忽略不计，从而推导出半局域 GGA 泛函所做的相应预测。最后，通过引入导数不连续性，将 Kohn-Sham 轨道能量差与基本能隙联系起来。在你的推导中，不要使用或引用任何已有的简化公式；相反，仅从以下基本依据进行推理：\n- 基本定义：通过总能量差定义的电离势 $I$ 和电子亲和能 $A$，以及相距为 $R$ 的两个单位电荷之间的静电相互作用能。\n- 线性响应理论核心思想：激发能源于一个由非相互作用跃迁能和耦合项决定的响应极点，并且对于轨道重叠可忽略的空间分离片段间的电荷转移，局域和绝热的核几乎不提供长程耦合。\n- 一个经充分检验的概念性事实：多体基本能隙通过导数不连续性与 Kohn-Sham 能隙相关联。\n\n实现一个最小化的双片段模型，对每个测试用例使用以下参数：\n- 给体电离势 $I_D$，单位为 Hartree。\n- 受体电子亲和能 $A_A$，单位为 Hartree。\n- 中心间距 $R$，单位为 bohr。\n- 一个有效的正导数不连续性参数 $\\Delta_{\\mathrm{xc}}$，单位为 Hartree，用于描述半局域 GGA 泛函典型的能隙低估特性。\n\n对每个测试用例，计算：\n1. 基于上述原理推导的、物理上合理的长程分离电荷转移激发能，以 Hartree 为单位，此处记为 $E_{\\mathrm{true}}$。\n2. 绝热半局域 GGA TD-DFT 对相同电荷转移激发的预测值，以 Hartree 为单位，此处记为 $E_{\\mathrm{GGA}}$。\n3. 带符号误差 $\\Delta E = E_{\\mathrm{GGA}} - E_{\\mathrm{true}}$，单位为 Hartree。\n4. 一个布尔标志，当且仅当 GGA 预测值是虚假地偏低时为真，定义为严格不等式 $E_{\\mathrm{GGA}} < E_{\\mathrm{true}}$。\n\n你的程序必须使用以下固定的参数元组 $(I_D,A_A,R,\\Delta_{\\mathrm{xc}})$ 测试套件，单位为原子单位（能量为 Hartree，距离为 bohr）：\n- 测试 1（一般分离对）：$(0.30, 0.08, 30.0, 0.12)$。\n- 测试 2（极大分离距离）：$(0.30, 0.08, 200.0, 0.12)$。\n- 测试 3（小基本能隙导致接近于零的 GGA 激发）：$(0.20, 0.08, 25.0, 0.12)$。\n- 测试 4（数值平衡点，即在此 $R$ 处，能隙低估值等于缺失的静电作用）：$(0.25, 0.05, 8.\\overline{3}, 0.12)$，其中 $8.\\overline{3}$ 表示 $25/3$ bohr。\n\n所有能量必须以 Hartree 表示，并四舍五入到六位小数。对于每个测试用例，你的程序必须按顺序输出 $E_{\\mathrm{true}}$、$E_{\\mathrm{GGA}}$、$\\Delta E$ 和布尔标志这四个值。将所有测试用例的结果汇总到一个扁平列表中。你的程序应产生单行输出，包含由方括号括起来的、以逗号分隔的结果列表（例如，“[result1,result2,result3,...]”）。\n\n不涉及角度单位。不允许外部输入；程序必须是完全自包含的，并在执行后产生所需的单行输出。", "solution": "问题陈述具有科学依据，提法恰当，并包含了推导唯一解所需的所有信息。它描述了常见密度泛函近似的一种众所周知的失效模式。因此，该问题被认为是有效的，并将基于所提供的第一性原理来构建一个解决方案。\n\n我们首先推导物理上正确的、在大分离距离下的电荷转移（$CT$）激发能的表达式，记为 $E_{\\mathrm{true}}$。一次 $CT$ 激发涉及将一个电子从相距为 $R$ 的给体分子 $D$ 移动到受体分子 $A$。该过程可表示为 $D^0A^0 \\rightarrow D^+A^-$。此激发的能量 $\\omega_{CT}$ 是末态和初态总能量之差：\n$$ \\omega_{CT} = E(D^+A^-) - E(D^0A^0) $$\n在大分离距离 $R$ 的极限下，组合系统的能量可以近似为其无相互作用的组成片段的能量之和，再加上它们的经典静电相互作用能。对于初始中性态，其能量为：\n$$ E(D^0A^0) \\approx E(D^0) + E(A^0) $$\n对于最终的离子态，其能量包括新形成的离子之间的静电吸引力：\n$$ E(D^+A^-) \\approx E(D^+) + E(A^-) + E_{\\mathrm{int}} $$\n此处，$E(X)$ 表示物种 $X$ 的总能量。$D^+$ 上的 $+1e$ 点电荷与 $A^-$ 上的 $-1e$ 点电荷之间的相互作用能 $E_{\\mathrm{int}}$ 由库仑定律给出。在原子单位制中（能量单位为 Hartree，距离单位为 bohr），该值为：\n$$ E_{\\mathrm{int}} = -\\frac{1}{R} $$\n将这些表达式代入 $\\omega_{CT}$ 的方程，我们得到：\n$$ \\omega_{CT} \\approx \\left( E(D^+) + E(A^-) - \\frac{1}{R} \\right) - \\left( E(D^0) + E(A^0) \\right) $$\n重排各项，按物种分组可得：\n$$ \\omega_{CT} \\approx \\left( E(D^+) - E(D^0) \\right) + \\left( E(A^-) - E(A^0) \\right) - \\frac{1}{R} $$\n括号中的项对应于基本定义。给体的电离势 $I_D$ 是移除一个电子所需的能量：\n$$ I_D = E(D^+) - E(D^0) $$\n受体的电子亲和能 $A_A$ 是捕获一个电子所释放的能量，定义为：\n$$ A_A = E(A^0) - E(A^-) $$\n根据此定义，可以得出 $E(A^-) - E(A^0) = -A_A$。通过代入 $I_D$ 和 $A_A$ 的定义，我们得到了真实的长程分离电荷转移激发能的表达式：\n$$ E_{\\mathrm{true}} = I_D - A_A - \\frac{1}{R} $$\n\n接下来，我们推导绝热半局域含时密度泛函理论（$TD-DFT$）的相应预测值，记为 $E_{\\mathrm{GGA}}$。在线性响应 $TD-DFT$ 中，激发能 $\\omega$ 作为矩阵方程的本征值得出。对于从一个已占据 Kohn-Sham（$KS$）轨道 $\\phi_i$ 到一个空 $KS$ 轨道 $\\phi_a$ 的单次激发，其在绝热近似下的激发能由下式给出：\n$$ \\omega_{ia} = \\varepsilon_a - \\varepsilon_i + K_{ia,ia} $$\n其中 $\\varepsilon_i$ 和 $\\varepsilon_a$ 是 $KS$ 轨道的能量，而 $K_{ia,ia}$ 是耦合矩阵元。该矩阵元依赖于 Hartree-交换-相关（$HXC$）核 $f_{HXC}$：\n$$ K_{ia,ia} = \\iint \\phi_i^*(\\mathbf{r})\\phi_a(\\mathbf{r}) f_{HXC}(\\mathbf{r}, \\mathbf{r}') \\phi_a^*(\\mathbf{r}')\\phi_i(\\mathbf{r}') d\\mathbf{r} d\\mathbf{r}' $$\n对于我们所考虑的 $CT$ 激发，已占据轨道 $\\phi_i$ 是给体的最高已占分子轨道（$HOMO_D$），而空轨道 $\\phi_a$ 是受体的最低未占分子轨道（$LUMO_A$）。在大分离距离 $R$ 下，这些轨道在空间上是孤立的，它们的重叠乘积 $\\phi_i(\\mathbf{r})\\phi_a(\\mathbf{r})$ 对所有 $\\mathbf{r}$ 而言均可忽略不计。\n对于像广义梯度近似（$GGA$）这样的半局域泛函，其核 $f_{HXC}^{GGA}(\\mathbf{r}, \\mathbf{r}')$ 是有效局域的，意味着它会随着距离 $|\\mathbf{r} - \\mathbf{r}'|$ 的增加而迅速衰减至零。局域核和可忽略的轨道重叠相结合，导致耦合积分 $K_{ia,ia}$ 变为零：\n$$ K_{ia,ia}^{GGA} \\approx 0 $$\n因此，$TD-GGA$ 的激发能虚假地简化为所涉及的 $KS$ 轨道能量的简单差值：\n$$ E_{\\mathrm{GGA}} = \\omega_{CT}^{GGA} \\approx \\varepsilon_{LUMO,A} - \\varepsilon_{HOMO,D} $$\n为了使该表达式有用，我们必须将此 $KS$ 轨道能隙与物理量 $I_D$ 和 $A_A$ 联系起来。组合的 $D-A$ 系统的基本多体能隙为 $E_{gap} = I_D - A_A$。相应的 $KS$ 能隙为 $\\varepsilon_{gap}^{KS} = \\varepsilon_{LUMO,A} - \\varepsilon_{HOMO,D}$。对于一个精确泛函，这些量通过交换相关势的导数不连续性 $\\Delta_{xc}$ 相关联：\n$$ E_{gap} = \\varepsilon_{gap}^{KS} + \\Delta_{xc} \\implies I_D - A_A = (\\varepsilon_{LUMO,A} - \\varepsilon_{HOMO,D}) + \\Delta_{xc} $$\n像 $GGA$ 这样的近似泛函已知存在一个系统性误差，该误差有效对应于缺失的导数不连续性。问题提供了一个有效参数 $\\Delta_{\\mathrm{xc}} > 0$ 来模拟这一缺陷。在 $GGA$ 框架下，重排 $KS$ 能隙的预测方程可得：\n$$ \\varepsilon_{LUMO,A}^{GGA} - \\varepsilon_{HOMO,D}^{GGA} = (I_D - A_A) - \\Delta_{\\mathrm{xc}} $$\n这给出了 $TD-GGA$ 电荷转移激发能的最终表达式：\n$$ E_{\\mathrm{GGA}} = I_D - A_A - \\Delta_{\\mathrm{xc}} $$\n这个结果错误地显示，激发能在大的 $R$ 值下趋于一个常数，完全没有体现正确的 $-1/R$ 渐进行为。\n\n最后，我们计算带符号误差 $\\Delta E$ 并建立虚假低预测的条件。误差是 $GGA$ 值与真实值之差：\n$$ \\Delta E = E_{\\mathrm{GGA}} - E_{\\mathrm{true}} = (I_D - A_A - \\Delta_{\\mathrm{xc}}) - \\left(I_D - A_A - \\frac{1}{R}\\right) $$\n$$ \\Delta E = \\frac{1}{R} - \\Delta_{\\mathrm{xc}} $$\n当且仅当 $E_{\\mathrm{GGA}} < E_{\\mathrm{true}}$ 时，$GGA$ 的预测是虚假地偏低，这意味着 $\\Delta E < 0$。这给出了条件：\n$$ \\frac{1}{R} - \\Delta_{\\mathrm{xc}} < 0 \\implies \\frac{1}{R} < \\Delta_{\\mathrm{xc}} $$\n随着分离距离 $R$ 的增加，$1/R$ 减小。对于任何具有非零能隙低估误差（$\\Delta_{\\mathrm{xc}} > 0$）的系统，总存在一个分离距离，超过此距离后该不等式即成立，这证明了绝热半局域泛函在描述长程电荷转移方面的根本性失败。以下程序实现了这些推导出的公式。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the true and TD-GGA charge-transfer excitation energies for a\n    series of donor-acceptor pairs to demonstrate the failure of semilocal DFT.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    # Each tuple is (I_D, A_A, R, delta_xc) in atomic units.\n    test_cases = [\n        # Test 1: General separated pair\n        (0.30, 0.08, 30.0, 0.12),\n        # Test 2: Very large separation\n        (0.30, 0.08, 200.0, 0.12),\n        # Test 3: Small fundamental gap\n        (0.20, 0.08, 25.0, 0.12),\n        # Test 4: Numerical balance point\n        (0.25, 0.05, 25.0/3.0, 0.12),\n    ]\n\n    results = []\n    for case in test_cases:\n        I_D, A_A, R, delta_xc = case\n        \n        # 1. Calculate the physically motivated charge-transfer energy, E_true.\n        # This is derived from E_true = I_D - A_A - 1/R.\n        E_true = I_D - A_A - 1.0/R\n        \n        # 2. Calculate the adiabatic semilocal GGA TD-DFT prediction, E_GGA.\n        # This is derived from E_GGA = I_D - A_A - delta_xc.\n        E_gga = I_D - A_A - delta_xc\n        \n        # 3. Calculate the signed error, delta_E.\n        # This is delta_E = E_GGA - E_true, which simplifies to 1/R - delta_xc.\n        delta_E = 1.0/R - delta_xc\n\n        # 4. Determine if the GGA prediction is spuriously low.\n        # This is true if E_GGA < E_true.\n        is_spurious = E_gga  E_true\n\n        # Append the four required results for this test case.\n        # Energies are rounded to six decimal places.\n        results.append(np.round(E_true, 6))\n        results.append(np.round(E_gga, 6))\n        results.append(np.round(delta_E, 6))\n        results.append(is_spurious)\n        \n    # Final print statement in the exact required format.\n    # The boolean `True`/`False` is converted to string \"True\"/\"False\".\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2466214"}, {"introduction": "TD-DFT 的标准形式（绝热近似）本质上是为描述单电子激发而设计的，但分子的电子世界远比这更丰富。本练习将通过一个经典的共轭体系——丁二烯——来揭示 TD-DFT 面对多电子激发态时的局限性。你将使用简化的 Hückel 模型来证明，标准 TD-DFT 的光谱中天然地“丢失”了重要的双电子激发态（如丁二烯的 $2^1A_g$ 态），从而理解为何在研究某些特定类型的分子和激发过程时，我们需要超越标准的 TD-DFT 框架。[@problem_id:2466175]", "problem": "考虑一个线性丁二烯分子，在 Hückel 紧束缚近似下，将其模拟为一条由 $4$ 个共轭碳原子 $p_z$ 轨道组成的链。设在位能为零，最近邻耦合沿链交替。具体来说，将链上的位点标记为 $1$–$4$，并定义 Hückel 哈密顿量 $H \\in \\mathbb{R}^{4 \\times 4}$（单位为电子伏特 eV）如下：\n$$\nH = \\begin{pmatrix}\n0  \\beta_1  0  0 \\\\\n\\beta_1  0  \\beta_2  0 \\\\\n0  \\beta_2  0  \\beta_1 \\\\\n0  0  \\beta_1  0\n\\end{pmatrix},\n$$\n其中 $\\beta_1 = \\beta(1+\\delta)$ 且 $\\beta_2 = \\beta(1-\\delta)$，$\\beta \\lt 0$ 是基本耦合，$\\delta \\in [0,1)$ 是键交替参数。假设有 $4$ 个 $\\pi$ 电子，因此在零温下，能量最低的两个分子轨道被双占据，而能量最高的两个轨道是空的。\n\n在含时密度泛函理论 (TD-DFT) 的绝热 Tamm–Dancoff 近似 (TDA) 中，忽略电子-空穴相互作用核（即独立粒子极限），单重态激发能等于所有轨道能量差的集合 $\\{\\varepsilon_a - \\varepsilon_i\\}$，其中 $i$ 遍历 $2$ 个占据轨道，$a$ 遍历 $2$ 个虚拟轨道。我们感兴趣的低能双激发，即丁二烯中的 $2^1A_g$ 态，主要由将两个电子从最高占据分子轨道 (HOMO) 激发到最低未占分子轨道 (LUMO) 构成。在相同的独立粒子图像中，其能量的粗略估计值为 $2(\\varepsilon_{\\mathrm{LUMO}} - \\varepsilon_{\\mathrm{HOMO}})$。\n\n你的任务是编写一个程序，对下面测试套件中给出的每个参数集 $(\\beta,\\delta,\\tau)$，完全以电子伏特 (eV) 为单位执行以下操作：\n\n1. 根据 $\\beta$ 和 $\\delta$ 构建 $H$，并确定所有四个轨道能量 $\\varepsilon_1 \\le \\varepsilon_2 \\le \\varepsilon_3 \\le \\varepsilon_4$。\n2. 将能量最低的两个轨道指标确定为占据轨道，能量最高的两个轨道指标确定为虚拟轨道。\n3. 形成所有独立粒子（绝热 TDA）单重态激发能的集合 $\\{\\varepsilon_a - \\varepsilon_i\\}$，其中 $i \\in \\{1,2\\}$ 且 $a \\in \\{3,4\\}$，并确定其中的最低激发能。\n4. 计算粗略的双激发估计值 $E_{\\mathrm{double}} = 2(\\varepsilon_3 - \\varepsilon_2)$。\n5. 判断绝热 TDA 仅含单重态的光谱中，是否存在任何一个激发能与 $E_{\\mathrm{double}}$ 的差值在容差 $\\tau$ 范围内，即判断 $\\min_{E \\in \\{\\varepsilon_a - \\varepsilon_i\\}} |E - E_{\\mathrm{double}}| \\le \\tau$ 是否成立。\n\n测试套件（每个元组为 $(\\beta,\\delta,\\tau)$，单位 eV）：\n- 情况 1：$(\\beta,\\delta,\\tau) = (-2.5,\\,0.2,\\,0.05)$。\n- 情况 2：$(\\beta,\\delta,\\tau) = (-2.0,\\,0.0,\\,0.05)$。\n- 情况 3：$(\\beta,\\delta,\\tau) = (-3.0,\\,0.4,\\,0.10)$。\n- 情况 4：$(\\beta,\\delta,\\tau) = (-2.5,\\,0.8,\\,0.10)$。\n\n输出规范：\n- 对每种情况，生成一个包含三个条目的列表：$[E_{\\min}, E_{\\mathrm{double}}, \\mathrm{found}]$，其中 $E_{\\min}$ 是最低的独立粒子单重态激发能（单位 eV），$E_{\\mathrm{double}}$ 是粗略的双激发估计值（单位 eV），$\\mathrm{found}$ 是一个布尔值，当且仅当存在一个独立粒子单重态激发能与 $E_{\\mathrm{double}}$ 的差值在 $\\tau$ 范围内时为 $\\mathrm{True}$，否则为 $\\mathrm{False}$。\n- 将 $E_{\\min}$ 和 $E_{\\mathrm{double}}$ 以 eV 表示，均四舍五入到三位小数。\n- 你的程序应生成单行输出，其中包含所有四个测试用例的结果，形式为一个用方括号括起来的逗号分隔列表。每个用例的三元组本身也必须用方括号括起来。例如：\"[[x1,y1,True],[x2,y2,False],[x3,y3,False],[x4,y4,True]]\"，其中 $x_k$ 和 $y_k$ 是四舍五入到三位小数的十进制数。\n\n所有能量均以电子伏特 (eV) 回答，并按规定四舍五入至三位小数。不涉及角度。任何地方都不要使用百分比；如果需要，请使用小数。最终输出必须是遵循上述格式的单行文本。", "solution": "所提出的问题是计算量子化学领域一个有效且明确定义的问题。它要求在 Hückel 紧束缚框架内，使用含时密度泛函理论 (TD-DFT) 在独立粒子极限下的概念，对线性丁二烯模型的电子激发能进行分析。\n\n其基本的科学任务是通过求解给定体系的定态薛定谔方程来确定分子轨道能量，这在原子轨道基组下表现为矩阵本征值问题的形式：\n$$ H \\mathbf{c}_k = \\varepsilon_k \\mathbf{c}_k $$\n此处，$H$ 是 Hückel 哈密顿矩阵，$\\varepsilon_k$ 是分子轨道能量，$\\mathbf{c}_k$ 是相应的分子轨道系数。该问题为包含四个位点的链提供了 $4 \\times 4$ 哈密顿矩阵的显式形式，其在位能（对角元素）设为零，最近邻耦合（非对角元素）$\\beta_1$ 和 $\\beta_2$ 交替出现：\n$$ H = \\begin{pmatrix} 0  \\beta_1  0  0 \\\\ \\beta_1  0  \\beta_2  0 \\\\ 0  \\beta_2  0  \\beta_1 \\\\ 0  0  \\beta_1  0 \\end{pmatrix} $$\n耦合通过基本耦合 $\\beta  0$ 和键交替参数 $\\delta \\in [0,1)$ 定义：\n$$ \\beta_1 = \\beta(1+\\delta) $$\n$$ \\beta_2 = \\beta(1-\\delta) $$\n由于 $H$ 是一个实对称矩阵，其四个本征值 $\\varepsilon_1 \\le \\varepsilon_2 \\le \\varepsilon_3 \\le \\varepsilon_4$ 均为实数。这些本征值代表了四个 $\\pi$ 分子轨道的能量。\n\n该体系包含 $4$ 个 $\\pi$ 电子。根据构造原理 (Aufbau principle)，在零温下，这些电子占据能量最低的可用轨道。每个轨道可以容纳两个自旋相反的电子。因此，能量最低的两个分子轨道 $\\varepsilon_1$ 和 $\\varepsilon_2$ 是双占据的。它们构成了占据轨道集。能量较高的两个轨道，其能量为 $\\varepsilon_3$ 和 $\\varepsilon_4$，是未占据的，被称为虚拟轨道。最高占据分子轨道 (HOMO) 的能量为 $\\varepsilon_{\\mathrm{HOMO}} = \\varepsilon_2$，最低未占分子轨道 (LUMO) 的能量为 $\\varepsilon_{\\mathrm{LUMO}} = \\varepsilon_3$。\n\n之后，问题要求在 TD-DFT 的绝热 Tamm-Dancoff 近似 (TDA) 内考虑电子激发，并忽略相互作用核。在这种独立粒子图像中，单重态激发能就是虚拟轨道与占据轨道之间的能量差。所有此类单粒子激发能的集合 $E_{\\text{single}}$ 由下式给出：\n$$ \\{ \\varepsilon_a - \\varepsilon_i \\mid i \\in \\{1, 2\\}, a \\in \\{3, 4\\} \\} $$\n这会产生四种可能的激发能：$\\varepsilon_3 - \\varepsilon_1$、$\\varepsilon_3 - \\varepsilon_2$、$\\varepsilon_4 - \\varepsilon_1$ 和 $\\varepsilon_4 - \\varepsilon_2$。其中最低的一个是 HOMO-LUMO 能隙，即 $E_{\\min} = \\varepsilon_3 - \\varepsilon_2$。\n\n将两个电子从 HOMO 激发到 LUMO 的双激发能量的粗略估计值由下式给出：\n$$ E_{\\mathrm{double}} = 2(\\varepsilon_{\\mathrm{LUMO}} - \\varepsilon_{\\mathrm{HOMO}}) = 2(\\varepsilon_3 - \\varepsilon_2) $$\n核心任务是确定该双激发能量是否与任何一个单激发能量“偶然”简并。这通过检查 $E_{\\mathrm{double}}$ 与四个单激发能量中任意一个的绝对差是否小于或等于给定的容差 $\\tau$ 来测试。也就是说，我们必须检查以下条件是否成立：\n$$ \\min_{E \\in \\{\\varepsilon_a - \\varepsilon_i\\}} |E - E_{\\mathrm{double}}| \\le \\tau $$\n\n针对每个测试用例 $(\\beta, \\delta, \\tau)$ 的算法流程如下：\n1.  使用给定的 $\\beta$ 和 $\\delta$ 构建矩阵 $H$。\n2.  数值计算 $H$ 的四个本征值。我们按非递减顺序将它们标记为：$\\varepsilon_1, \\varepsilon_2, \\varepsilon_3, \\varepsilon_4$。\n3.  计算四个单激发能：$E_{1 \\to 3} = \\varepsilon_3 - \\varepsilon_1$，$E_{2 \\to 3} = \\varepsilon_3 - \\varepsilon_2$，$E_{1 \\to 4} = \\varepsilon_4 - \\varepsilon_1$ 和 $E_{2 \\to 4} = \\varepsilon_4 - \\varepsilon_2$。\n4.  确定最低单激发能，$E_{\\min} = E_{2 \\to 3} = \\varepsilon_3 - \\varepsilon_2$。\n5.  计算粗略的双激发能估计值，$E_{\\mathrm{double}} = 2 \\cdot E_{\\min}$。\n6.  计算 $E_{\\mathrm{double}}$ 与四个单激发能量中每一个的最小绝对差。\n7.  将此最小差值与容差 $\\tau$ 进行比较，以确定布尔值 `found`。\n8.  格式化所需的输出值 $E_{\\min}$ 和 $E_{\\mathrm{double}}$，四舍五入到三位小数。\n这个流程在所提供的 Python 代码中实现，利用 `numpy` 库进行高效且准确的矩阵对角化。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the butadiene excitation energy problem for a given test suite.\n\n    The function iterates through a set of parameters (beta, delta, tau),\n    constructs the Hückel Hamiltonian for a 4-site linear polyene with\n    alternating bond couplings, and calculates its eigenvalues (orbital energies).\n    It then determines single and double excitation energies as defined in the\n    problem statement and checks for their near-degeneracy within a given\n    tolerance.\n    \"\"\"\n    # Test suite: tuples of (beta, delta, tau) in eV\n    test_cases = [\n        (-2.5, 0.2, 0.05),\n        (-2.0, 0.0, 0.05),\n        (-3.0, 0.4, 0.10),\n        (-2.5, 0.8, 0.10),\n    ]\n\n    # This list will hold the string representation of each case's result list\n    all_results_str = []\n\n    for beta, delta, tau in test_cases:\n        # Step 1: Construct the Hückel Hamiltonian matrix H\n        beta1 = beta * (1 + delta)\n        beta2 = beta * (1 - delta)\n        \n        H = np.array([\n            [0.0,   beta1, 0.0,   0.0  ],\n            [beta1, 0.0,   beta2, 0.0  ],\n            [0.0,   beta2, 0.0,   beta1],\n            [0.0,   0.0,   beta1, 0.0  ]\n        ], dtype=float)\n\n        # Step 1 (cont.): Determine all four orbital energies (eigenvalues of H)\n        # np.linalg.eigh returns sorted eigenvalues for a symmetric matrix, which is appropriate here.\n        orbital_energies = np.linalg.eigh(H)[0]\n        \n        eps1, eps2, eps3, eps4 = orbital_energies\n        \n        # Step 2: Identify occupied and virtual orbitals based on energy ordering.\n        # Occupied orbitals correspond to the two lowest energies: eps1, eps2.\n        # Virtual orbitals correspond to the two highest energies: eps3, eps4.\n        # HOMO energy is eps2, LUMO energy is eps3.\n        eps_homo = eps2\n        eps_lumo = eps3\n\n        # Step 3: Form the set of independent-particle singlet excitation energies.\n        # These are {eps_a - eps_i} for i in {1,2} and a in {3,4}.\n        single_excitations = [\n            eps3 - eps1,\n            eps3 - eps2,  # This is the HOMO-LUMO gap\n            eps4 - eps1,\n            eps4 - eps2\n        ]\n        \n        # The lowest singlet excitation energy is the HOMO-LUMO gap.\n        E_min = eps_lumo - eps_homo\n\n        # Step 4: Compute the naive double-excitation estimate.\n        E_double = 2 * (eps_lumo - eps_homo)\n\n        # Step 5: Decide whether any single excitation energy is within tau of E_double.\n        min_abs_diff = min([abs(E - E_double) for E in single_excitations])\n        found = min_abs_diff = tau\n\n        # Store the formatted result string for the current case.\n        # The f-string formatting `{value:.3f}` ensures rounding to three decimal places.\n        case_result_str = f\"[{E_min:.3f},{E_double:.3f},{found}]\"\n        all_results_str.append(case_result_str)\n\n    # Print the final output as a single line, following the specified format.\n    # The format is a list of lists, represented as a string.\n    print(f\"[{','.join(all_results_str)}]\")\n\n# Execute the solver function.\nsolve()\n\n```", "id": "2466175"}]}