{"hands_on_practices": [{"introduction": "多参考微扰理论（特别是像 CASPT2 这样的方法）中的一个重要挑战是“闯入态”问题。这些处于参考空间之外的态与参考态近简并，导致微扰公式 $E^{(2)} = \\sum_{I} |\\langle \\Psi_0 | \\hat{V} | I \\rangle|^2 / (E_0^{(0)} - E_I^{(0)})$ 中出现极小的能量分母，并可能引起不符合物理的能量尖峰。本练习将让你通过计算并比较使用无能级移动、实数能级移动和虚数能级移动得到的二阶能量校正，从而深入了解能级移动这一缓解此问题的实用技术。[@problem_id:2654359]", "problem": "一个多参考微扰理论模型定义如下。一个能量为 $E_0^{(0)}$ 的归一化零阶参考态 $\\lvert \\Psi_0 \\rangle$ 通过微扰 $\\hat{V}$ 与一个由 $M$ 个组态 $\\{\\lvert \\mu \\rangle\\}$ 构成的外部空间耦合，这些组态的零阶能量为 $E_{\\mu}^{(0)}$。定义激发能分母为 $\\Delta \\equiv E_{\\mu}^{(0)} - E_0^{(0)}$。在该模型中，分母 $\\Delta$ 独立同分布，服从区间 $[a,b]$ 上的均匀分布，且耦合强度为常数，即对于所有 $\\mu$ 都有 $|\\langle \\Psi_0 \\lvert \\hat{V} \\rvert \\mu \\rangle| = v$。假设连续谱近似（将离散求和替换为在给定分布上的平均值乘以 $M$）是有效的。\n\n在多参考设置下，使用二阶瑞利-薛定谔 (Rayleigh–Schrödinger) 能量校正表达式，并采用在实际多参考微扰理论中使用的标准能级移动正则化方法。计算使用以下方法的二阶能量：\n- 无能级移动，\n- 大小为 $s$ 的实数能级移动，\n- 大小为 $\\eta$ 的虚数能级移动，其中具有物理意义的能量是复数表达式的实部。\n\n该模型的参数为 $M = 100$, $v = 0.010\\,E_h$, $a = 0.020\\,E_h$, $b = 0.800\\,E_h$, $s = 0.200\\,E_h$ 以及 $\\eta = 0.200\\,E_h$。\n\n按（无移动、实数移动、虚数移动）的顺序报告三个数值能量。将您的答案四舍五入到 $4$ 位有效数字，并以 $E_h$ 为单位表示每个能量。", "solution": "首先将对问题陈述进行严格的验证过程。\n\n### 步骤 1：提取已知条件\n逐字提取的已知条件如下：\n- 一个能量为 $E_0^{(0)}$ 的归一化零阶参考态 $\\lvert \\Psi_0 \\rangle$。\n- 一个由 $M$ 个组态 $\\{\\lvert \\mu \\rangle\\}$ 构成的外部空间，其零阶能量为 $E_{\\mu}^{(0)}$。\n- 微扰耦合 $\\hat{V}$。\n- 激发能分母: $\\Delta \\equiv E_{\\mu}^{(0)} - E_0^{(0)}$。\n- $\\Delta$ 的分布：独立同分布，服从区间 $[a,b]$ 上的均匀分布。\n- 恒定的耦合强度：对于所有 $\\mu$，都有 $|\\langle \\Psi_0 \\lvert \\hat{V} \\rvert \\mu \\rangle| = v$。\n- 连续谱近似有效。\n- 能量校正将使用二阶瑞利-薛定谔表达式计算。\n- 考虑三种正则化分母的情况：无能级移动、实数能级移动 $s$、以及虚数能级移动 $\\eta$（取最终能量的实部）。\n- 参数：$M = 100$, $v = 0.010\\,E_h$, $a = 0.020\\,E_h$, $b = 0.800\\,E_h$, $s = 0.200\\,E_h$, $\\eta = 0.200\\,E_h$。\n\n### 步骤 2：使用提取的已知条件进行验证\n根据所需标准对问题进行分析。\n1.  **科学依据**：该问题描述了一个简化的模型哈密顿量，用于研究多参考微扰理论，这是量子化学中一个标准且成熟的方法。对能量分母使用均匀分布和恒定耦合是一种常见的理论简化，以实现解析可解性。能级移动（使用实数或虚数移动）是一种标准技术（例如，在 CASPT2 中），用于处理近简并情况并改善收敛性。该问题在科学上是合理的。\n2.  **适定性**：该问题是适定的。它提供了一个明确的目标（计算三个能量值），以及推导每种情况下唯一解所需的所有必要参数和物理假设（连续谱近似、均匀分布）。\n3.  **客观性**：问题陈述使用了精确、客观和形式化的科学语言，没有任何主观性或含糊之处。\n4.  **完备性与一致性**：所提供的数据（$M$, $v$, $a$, $b$, $s$, $\\eta$）是完备且量纲一致的（所有能量均以 $E_h$ 为单位）。不存在矛盾之处。\n\n### 步骤 3：结论与行动\n该问题被判定为**有效**。这是一个来自理论物理化学领域的、适定的、有科学依据的问题。将提供解答。\n\n对于参考态 $\\lvert \\Psi_0 \\rangle$ 的二阶瑞利-薛定谔微扰理论 (RSPT) 能量校正由下式给出：\n$$ E^{(2)} = \\sum_{\\mu \\ne 0} \\frac{|\\langle \\Psi_0 | \\hat{V} | \\mu \\rangle|^2}{E_0^{(0)} - E_{\\mu}^{(0)}} $$\n使用所提供的定义，其中 $\\Delta_\\mu = E_{\\mu}^{(0)} - E_0^{(0)}$ 且 $|\\langle \\Psi_0 | \\hat{V} | \\mu \\rangle| = v$，表达式变为：\n$$ E^{(2)} = -\\sum_{\\mu=1}^{M} \\frac{v^2}{\\Delta_\\mu} $$\n问题规定使用连续谱近似。对 $M$ 个离散态的求和被替换为对能量分母分布的积分。在 $[a,b]$ 上均匀分布的概率密度函数 $P(\\Delta)$ 为：当 $\\Delta \\in [a,b]$ 时，$P(\\Delta) = \\frac{1}{b-a}$，否则为 0。求和替换如下：\n$$ \\sum_{\\mu=1}^{M} f(\\Delta_\\mu) \\to M \\int_a^b f(\\Delta) P(\\Delta) d\\Delta = \\frac{M}{b-a} \\int_a^b f(\\Delta) d\\Delta $$\n\n**情况 1：无能级移动**\n要积分的函数是 $f(\\Delta) = -\\frac{v^2}{\\Delta}$。二阶能量为：\n$$ E_{no\\_shift}^{(2)} = \\frac{M}{b-a} \\int_a^b \\left(-\\frac{v^2}{\\Delta}\\right) d\\Delta = -\\frac{M v^2}{b-a} \\int_a^b \\frac{1}{\\Delta} d\\Delta $$\n该积分的计算结果为 $\\ln(\\Delta)$，因此：\n$$ E_{no\\_shift}^{(2)} = -\\frac{M v^2}{b-a} [\\ln(\\Delta)]_a^b = -\\frac{M v^2}{b-a} \\ln\\left(\\frac{b}{a}\\right) $$\n代入给定的数值：$M=100$, $v=0.010$, $a=0.020$, $b=0.800$。\n$$ E_{no\\_shift}^{(2)} = -\\frac{100 \\times (0.010)^2}{0.800 - 0.020} \\ln\\left(\\frac{0.800}{0.020}\\right) = -\\frac{0.01}{0.780} \\ln(40) $$\n$$ E_{no\\_shift}^{(2)} \\approx -0.0128205 \\times 3.6888795 \\approx -0.0472933 \\, E_h $$\n四舍五入到 $4$ 位有效数字，结果为 $-0.04729 \\, E_h$。\n\n**情况 2：大小为 $s$ 的实数能级移动**\n分母移动了一个实数值 $s$。函数变为 $f(\\Delta) = -\\frac{v^2}{\\Delta + s}$。\n$$ E_{real\\_shift}^{(2)} = -\\frac{M v^2}{b-a} \\int_a^b \\frac{1}{\\Delta + s} d\\Delta $$\n该积分的计算结果为 $\\ln(\\Delta + s)$：\n$$ E_{real\\_shift}^{(2)} = -\\frac{M v^2}{b-a} [\\ln(\\Delta + s)]_a^b = -\\frac{M v^2}{b-a} \\ln\\left(\\frac{b+s}{a+s}\\right) $$\n代入数值，其中 $s=0.200$：\n$$ E_{real\\_shift}^{(2)} = -\\frac{100 \\times (0.010)^2}{0.780} \\ln\\left(\\frac{0.800 + 0.200}{0.020 + 0.200}\\right) = -\\frac{0.01}{0.780} \\ln\\left(\\frac{1.000}{0.220}\\right) $$\n$$ E_{real\\_shift}^{(2)} \\approx -0.0128205 \\times \\ln(4.5454...) \\approx -0.0128205 \\times 1.5141278 \\approx -0.0194118 \\, E_h $$\n四舍五入到 $4$ 位有效数字，结果为 $-0.01941 \\, E_h$。\n\n**情况 3：大小为 $\\eta$ 的虚数能级移动**\n分母移动了一个虚数值 $i\\eta$。复数能量为：\n$$ E_{complex}^{(2)} = -\\frac{M v^2}{b-a} \\int_a^b \\frac{1}{\\Delta + i\\eta} d\\Delta $$\n具有物理意义的能量是实部，$E_{imag\\_shift}^{(2)} = \\text{Re}(E_{complex}^{(2)})$。我们取被积函数的实部：\n$$ \\text{Re}\\left(\\frac{1}{\\Delta + i\\eta}\\right) = \\text{Re}\\left(\\frac{\\Delta - i\\eta}{(\\Delta + i\\eta)(\\Delta - i\\eta)}\\right) = \\frac{\\Delta}{\\Delta^2 + \\eta^2} $$\n因此，能量为：\n$$ E_{imag\\_shift}^{(2)} = -\\frac{M v^2}{b-a} \\int_a^b \\frac{\\Delta}{\\Delta^2 + \\eta^2} d\\Delta $$\n为了求解该积分，我们使用换元法，令 $u = \\Delta^2 + \\eta^2$，则 $du = 2\\Delta d\\Delta$。\n$$ \\int \\frac{\\Delta}{\\Delta^2 + \\eta^2} d\\Delta = \\frac{1}{2} \\int \\frac{1}{u} du = \\frac{1}{2}\\ln(u) = \\frac{1}{2}\\ln(\\Delta^2 + \\eta^2) $$\n定积分为：\n$$ \\int_a^b \\frac{\\Delta}{\\Delta^2 + \\eta^2} d\\Delta = \\frac{1}{2} [\\ln(\\Delta^2 + \\eta^2)]_a^b = \\frac{1}{2} \\ln\\left(\\frac{b^2 + \\eta^2}{a^2 + \\eta^2}\\right) $$\n能量校正为：\n$$ E_{imag\\_shift}^{(2)} = -\\frac{M v^2}{2(b-a)} \\ln\\left(\\frac{b^2 + \\eta^2}{a^2 + \\eta^2}\\right) $$\n代入数值，其中 $\\eta=0.200$：\n$$ E_{imag\\_shift}^{(2)} = -\\frac{100 \\times (0.010)^2}{2(0.780)} \\ln\\left(\\frac{(0.800)^2 + (0.200)^2}{(0.020)^2 + (0.200)^2}\\right) = -\\frac{0.01}{1.56} \\ln\\left(\\frac{0.64 + 0.04}{0.0004 + 0.04}\\right) $$\n$$ E_{imag\\_shift}^{(2)} = -\\frac{0.01}{1.56} \\ln\\left(\\frac{0.68}{0.0404}\\right) \\approx -0.006410256 \\times \\ln(16.83168...) $$\n$$ E_{imag\\_shift}^{(2)} \\approx -0.006410256 \\times 2.823226 \\approx -0.0180998 \\, E_h $$\n四舍五入到 $4$ 位有效数字，结果为 $-0.01810 \\, E_h$。\n\n所要求的三个能量，按（无移动、实数移动、虚数移动）的顺序，并四舍五入到四位有效数字，分别为 $-0.04729\\,E_h$、$-0.01941\\,E_h$和 $-0.01810\\,E_h$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n-0.04729 & -0.01941 & -0.01810\n\\end{pmatrix}\n}\n$$", "id": "2654359"}, {"introduction": "除了数值稳定性，评估量子化学方法的一个基本标准是大小一致性，它确保由两个不相互作用的片段组成的体系的能量等于各个片段能量的总和。不同的 MRPT 方法在这方面表现出不同的行为。本练习使用一个简化的理论模型，帮助你证明为何 N 电子价态微扰理论 (NEVPT2) 在设计上是大小一致的，而标准形式的 CASPT2 却不是，从而澄清不同方法除了修复数值不稳定性之外的理论优势。[@problem_id:2459090]", "problem": "您将使用一个最小化的、完全指定的玩具模型来分析大小一致性，该模型抽象了两种著名的多参考二阶微扰理论：带实数能级移动的完全活性空间二阶微扰理论 (CASPT2) 和 N 电子价态微扰理论 (NEVPT2)。考虑两个无相互作用的片段，标记为 $A$ 和 $B$，其零阶模型态是其片段模型态的张量积。每个片段 $X \\in \\{A,B\\}$ 都有一个外部构型，其特征是相对于其片段模型态的能隙 $\\Delta_X > 0$ 以及模型构型与外部构型之间的实数耦合振幅 $g_X$。假设总哈密顿量是严格可分的，因此没有片段间的耦合。令 $s \\ge 0$ 表示一个实数能级移动。\n\n对于 NEVPT2 的抽象（Epstein–Nesbet 可分构造），将片段的二阶校正定义为\n$$\nE^{(2)}_{\\mathrm{NEV}}(X) = -\\frac{g_X^2}{\\Delta_X},\n$$\n对于复合的无相互作用二聚体 $AB$，定义为\n$$\nE^{(2)}_{\\mathrm{NEV}}(AB) = -\\frac{g_A^2}{\\Delta_A} - \\frac{g_B^2}{\\Delta_B}。\n$$\n这种构造通过为仅 A 和仅 B 的激发分配不同的外部空间来强制实现强可分性。\n\n对于带能级移动的 CASPT2 的抽象（内收缩、能级移动构造），将片段的二阶校正定义为\n$$\nE^{(2)}_{\\mathrm{CAS}}(X;s) = -\\frac{g_X^2}{\\Delta_X + s}。\n$$\n对于复合的无相互作用二聚体 $AB$，在一个单一外部类的层面上对内收缩进行建模，该类将仅 A 和仅 B 的外部构型合并成一个总耦合为 $g_A + g_B$ 并具有有效平均分母的收缩外部向量。定义\n$$\n\\overline{\\Delta}_{AB}(s) = \\frac{\\Delta_A + \\Delta_B}{2} + s,\n\\quad\nE^{(2)}_{\\mathrm{CAS}}(AB;s) = -\\frac{(g_A + g_B)^2}{\\overline{\\Delta}_{AB}(s)}。\n$$\n该构造模拟了内收缩的不可分效应，并结合了应用于合并激发类的全局能级移动。\n\n对于给定的方法，将大小一致性定义为 $E^{(2)}(\\mathrm{AB}) = E^{(2)}(\\mathrm{A}) + E^{(2)}(\\mathrm{B})$。对于下面的每一组参数，评估在上述抽象中 NEVPT2 和带能级移动的 CASPT2 是否满足大小一致性，绝对容差为 $\\tau = 1\\times 10^{-12}$。您的程序应为每个测试用例计算两个布尔值：\n- 第一个布尔值指示 NEVPT2 是否具有大小一致性，\n- 第二个布尔值指示带能级移动的 CASPT2 是否具有大小一致性。\n\n使用以下参数值测试套件 $(\\Delta_A, g_A, \\Delta_B, g_B, s)$:\n1. $(0.8, 0.25, 1.1, 0.18, 0.2)$\n2. $(0.5, 0.3, 1.5, 0.1, 0.05)$\n3. $(0.7, 0.2, 2.0, 0.0, 0.3)$\n4. $(0.5, 0.3, 0.5, 0.3, 1000.0)$\n\n所有量纲均为无量纲。不出现角度。不使用百分比。\n\n最终输出格式：您的程序应生成一行输出，其中包含一个用方括号括起来的逗号分隔列表，结果按以下顺序排列\n$[\\text{NEV-1}, \\text{CAS-1}, \\text{NEV-2}, \\text{CAS-2}, \\text{NEV-3}, \\text{CAS-3}, \\text{NEV-4}, \\text{CAS-4}]$，\n其中每个条目都是在绝对容差 $\\tau = 1\\times 10^{-12}$ 下计算出的布尔值。", "solution": "问题陈述已经过验证，被认为是科学上合理的、适定的和客观的。它在计算化学领域提出了一个有效的理论练习，使用简化但合理的模型来研究多参考微扰理论中的大小一致性属性。该问题是自包含的，并为唯一解提供了所有必要的定义和数据。因此，我们可以进行严谨的分析。\n\n任务是评估两种抽象的二阶微扰理论 NEVPT2 和 CASPT2，对于一个由两个无相互作用片段 $A$ 和 $B$ 组成的系统的大小一致性。大小一致性要求复合系统（二聚体）的能量等于单个片段能量之和，即 $E^{(2)}(AB) = E^{(2)}(A) + E^{(2)}(B)$。我们对每个模型评估此条件。数值相等的容差定为 $\\tau = 1 \\times 10^{-12}$。\n\n首先，我们分析 N 电子价态微扰理论 (NEVPT2) 的抽象。\n单个片段 $X \\in \\{A, B\\}$ 的二阶能量校正由下式给出：\n$$\nE^{(2)}_{\\mathrm{NEV}}(X) = -\\frac{g_X^2}{\\Delta_X}\n$$\n因此，片段能量之和为：\n$$\nE^{(2)}_{\\mathrm{NEV}}(A) + E^{(2)}_{\\mathrm{NEV}}(B) = \\left(-\\frac{g_A^2}{\\Delta_A}\\right) + \\left(-\\frac{g_B^2}{\\Delta_B}\\right) = -\\frac{g_A^2}{\\Delta_A} - \\frac{g_B^2}{\\Delta_B}\n$$\n无相互作用二聚体 $AB$ 的能量定义为：\n$$\nE^{(2)}_{\\mathrm{NEV}}(AB) = -\\frac{g_A^2}{\\Delta_A} - \\frac{g_B^2}{\\Delta_B}\n$$\n通过直接比较，我们可以看到大小一致性条件\n$$\nE^{(2)}_{\\mathrm{NEV}}(AB) = E^{(2)}_{\\mathrm{NEV}}(A) + E^{(2)}_{\\mathrm{NEV}}(B)\n$$\n根据定义是精确满足的。该模型被构造成严格可分的，或称“强大小一致的”。大小一致性误差在解析上为零。因此，对于任何参数集 $(\\Delta_A, g_A, \\Delta_B, g_B, s)$，其中 $\\Delta_A, \\Delta_B > 0$，该模型都是大小一致的。\n\n接下来，我们分析带实数能级移动的完全活性空间二阶微扰理论 (CASPT2) 的抽象。\n带能级移动 $s \\ge 0$ 的单个片段 $X \\in \\{A, B\\}$ 的二阶能量校正为：\n$$\nE^{(2)}_{\\mathrm{CAS}}(X;s) = -\\frac{g_X^2}{\\Delta_X + s}\n$$\n片段能量之和为：\n$$\nE^{(2)}_{\\mathrm{CAS}}(A;s) + E^{(2)}_{\\mathrm{CAS}}(B;s) = -\\frac{g_A^2}{\\Delta_A + s} - \\frac{g_B^2}{\\Delta_B + s}\n$$\n二聚体 $AB$ 的能量使用具有平均分母的内收缩模型定义：\n$$\nE^{(2)}_{\\mathrm{CAS}}(AB;s) = -\\frac{(g_A + g_B)^2}{\\overline{\\Delta}_{AB}(s)} = -\\frac{(g_A + g_B)^2}{\\frac{\\Delta_A + \\Delta_B}{2} + s}\n$$\n大小一致性误差 $\\delta E$ 是二聚体能量与片段能量之和之间的差值：\n$$\n\\delta E = E^{(2)}_{\\mathrm{CAS}}(AB;s) - \\left( E^{(2)}_{\\mathrm{CAS}}(A;s) + E^{(2)}_{\\mathrm{CAS}}(B;s) \\right)\n$$\n$$\n\\delta E = \\left( \\frac{g_A^2}{\\Delta_A + s} + \\frac{g_B^2}{\\Delta_B + s} \\right) - \\frac{(g_A + g_B)^2}{\\frac{\\Delta_A + \\Delta_B}{2} + s}\n$$\n该表达式通常不等于零。因此，该模型通常不是大小一致的。大小一致性误差源于该模型模仿真实 CASPT2 的两个特征：对合并的激发类使用单一的平均分母，以及由于内收缩（此处建模为 $(g_A + g_B)^2$）导致分子的不可分性。只有当 $|\\delta E| \\le \\tau$ 时，大小一致性才成立。我们必须对每个测试用例评估此条件。\n\n情况 1: $(\\Delta_A, g_A, \\Delta_B, g_B, s) = (0.8, 0.25, 1.1, 0.18, 0.2)$\n- NEVPT2：根据定义是大小一致的。结果：True。\n- CASPT2:\n  - $E^{(2)}_{\\mathrm{CAS}}(A;s) + E^{(2)}_{\\mathrm{CAS}}(B;s) = -\\frac{0.25^2}{0.8+0.2} - \\frac{0.18^2}{1.1+0.2} = -0.0625 - \\frac{0.0324}{1.3} \\approx -0.0874230769$\n  - $E^{(2)}_{\\mathrm{CAS}}(AB;s) = -\\frac{(0.25+0.18)^2}{\\frac{0.8+1.1}{2}+0.2} = -\\frac{0.43^2}{1.15} = -\\frac{0.1849}{1.15} \\approx -0.1607826087$\n  - $|\\delta E| \\approx |-0.1607826087 - (-0.0874230769)| \\approx 0.0733595318 \\gg \\tau$。不是大小一致的。结果：False。\n\n情况 2: $(\\Delta_A, g_A, \\Delta_B, g_B, s) = (0.5, 0.3, 1.5, 0.1, 0.05)$\n- NEVPT2：根据定义是大小一致的。结果：True。\n- CASPT2:\n  - $E^{(2)}_{\\mathrm{CAS}}(A;s) + E^{(2)}_{\\mathrm{CAS}}(B;s) = -\\frac{0.3^2}{0.5+0.05} - \\frac{0.1^2}{1.5+0.05} = -\\frac{0.09}{0.55} - \\frac{0.01}{1.55} \\approx -0.1700879765$\n  - $E^{(2)}_{\\mathrm{CAS}}(AB;s) = -\\frac{(0.3+0.1)^2}{\\frac{0.5+1.5}{2}+0.05} = -\\frac{0.4^2}{1.05} = -\\frac{0.16}{1.05} \\approx -0.1523809524$\n  - $|\\delta E| \\approx |-0.1523809524 - (-0.1700879765)| \\approx 0.0177070241 \\gg \\tau$。不是大小一致的。结果：False。\n\n情况 3: $(\\Delta_A, g_A, \\Delta_B, g_B, s) = (0.7, 0.2, 2.0, 0.0, 0.3)$\n- NEVPT2：根据定义是大小一致的。结果：True。\n- CASPT2：此处，$g_B=0$。误差变为 $\\delta E = g_A^2 \\left( \\frac{1}{\\Delta_A+s} - \\frac{1}{\\frac{\\Delta_A+\\Delta_B}{2}+s} \\right)$。除非 $\\Delta_A = \\Delta_B$，否则该值不为零。此处 $\\Delta_A \\neq \\Delta_B$。\n  - $E^{(2)}_{\\mathrm{CAS}}(A;s) + E^{(2)}_{\\mathrm{CAS}}(B;s) = -\\frac{0.2^2}{0.7+0.3} - \\frac{0^2}{2.0+0.3} = -0.04$\n  - $E^{(2)}_{\\mathrm{CAS}}(AB;s) = -\\frac{(0.2+0)^2}{\\frac{0.7+2.0}{2}+0.3} = -\\frac{0.04}{1.65} \\approx -0.0242424242$\n  - $|\\delta E| \\approx |-0.0242424242 - (-0.04)| \\approx 0.0157575758 \\gg \\tau$。不是大小一致的。结果：False。\n\n情况 4: $(\\Delta_A, g_A, \\Delta_B, g_B, s) = (0.5, 0.3, 0.5, 0.3, 1000.0)$\n- NEVPT2：根据定义是大小一致的。结果：True。\n- CASPT2：能级移动 $s$ 很大。在 $s \\to \\infty$ 的极限下，误差趋近于零，为 $\\delta E \\approx -2g_A g_B / s$。对于一个有限但很大的 $s$，误差很小但不为零。\n  - $E^{(2)}_{\\mathrm{CAS}}(A;s) + E^{(2)}_{\\mathrm{CAS}}(B;s) = -\\frac{0.3^2}{0.5+1000} - \\frac{0.3^2}{0.5+1000} = -2 \\frac{0.09}{1000.5} \\approx -0.0001799100$\n  - $E^{(2)}_{\\mathrm{CAS}}(AB;s) = -\\frac{(0.3+0.3)^2}{\\frac{0.5+0.5}{2}+1000} = -\\frac{0.6^2}{1000.5} = -\\frac{0.36}{1000.5} \\approx -0.0003598201$\n  - $|\\delta E| \\approx |-0.0003598201 - (-0.0001799100)| \\approx 0.0001799101 \\gg \\tau$。不是大小一致的。结果：False。\n\n总之，对于所有测试用例，NEVPT2 抽象都是大小一致的，而 CASPT2 抽象对于任何测试用例都不是大小一致的，因为该模型固有地引入了一个在给定条件下不会消失的大小一致性误差。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Analyzes the size-consistency of two abstract multireference perturbation\n    theory models (NEVPT2 and CASPT2) for a series of test cases.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (delta_A, g_A, delta_B, g_B, s)\n    test_cases = [\n        (0.8, 0.25, 1.1, 0.18, 0.2),\n        (0.5, 0.3, 1.5, 0.1, 0.05),\n        (0.7, 0.2, 2.0, 0.0, 0.3),\n        (0.5, 0.3, 0.5, 0.3, 1000.0),\n    ]\n\n    # Absolute tolerance for checking size-consistency\n    tau = 1.0e-12\n\n    results = []\n    for case in test_cases:\n        delta_A, g_A, delta_B, g_B, s = case\n\n        # --- NEVPT2 Validation ---\n        # The NEVPT2 abstraction defines the dimer energy as the exact sum of\n        # the fragment energies:\n        # E2_NEV(AB) = -g_A^2/delta_A - g_B^2/delta_B\n        # E2_NEV(A) + E2_NEV(B) = (-g_A^2/delta_A) + (-g_B^2/delta_B)\n        # These are analytically identical. The size-consistency error is zero.\n        # Therefore, the result for NEVPT2 is always True.\n        results.append(True)\n\n        # --- CASPT2-with-level-shift Validation ---\n        # Sum of fragment energies\n        E2_CAS_A = -g_A**2 / (delta_A + s)\n        if delta_B > 0: # Avoid division by zero if delta_B was 0, though problem states > 0\n            E2_CAS_B = -g_B**2 / (delta_B + s)\n        else:\n            E2_CAS_B = 0.0\n        \n        sum_E2_CAS = E2_CAS_A + E2_CAS_B\n\n        # Dimer energy\n        delta_AB_bar = (delta_A + delta_B) / 2.0 + s\n        E2_CAS_AB = -(g_A + g_B)**2 / delta_AB_bar\n\n        # Check for size-consistency\n        error_cas = abs(E2_CAS_AB - sum_E2_CAS)\n        is_cas_consistent = error_cas = tau\n        results.append(is_cas_consistent)\n\n    # Final print statement in the exact required format.\n    # The map(str, ...) converts Python booleans (True, False) to strings.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2459090"}, {"introduction": "任何多参考计算（包括 MRPT）的结果都关键性地依赖于零阶参考波函数的选择，而这又是由活性空间定义的。最终的微扰能量对哪些轨道被视为“活性”的微小变化有多敏感？这个高级练习提供了一个定量框架，让你通过计算二阶能量 $E^{(2)}$ 相对于一个混合了活性轨道和外部轨道的旋转角 $\\theta$ 的曲率来研究这个问题，这有助于洞察所选活性空间的稳定性。[@problem_id:2654375]", "problem": "一个小型多参考微扰理论 (MRPT) 模型被用于量化一个混合了活性轨道与外部（虚）轨道的轨道旋转如何传播到二阶微扰能量中。考虑一个特定态的完全活性空间 (CAS) 参考态，其中单个活性空间轨道（记为 $a$）在参考密度中的分数占据数为 $n_{a}$，而单个外部空间轨道（记为 $r$）位于活性空间之外。假设只有一个重要的收缩激发类对二阶能量有贡献：从活性轨道 $a$ 中移除一个电子并将其放入外部轨道 $r$ 中（一个单电子附着-脱附过程）。\n\n设未微扰哈密顿量 $H_{0}$ 在未旋转的正交归一轨道基 $\\{|a\\rangle, |r\\rangle\\}$ 中是对角的，其单电子能量分别为 $\\epsilon_{a}$ 和 $\\epsilon_{r}$。一个角度为 $\\theta$ 的幺正旋转将 $|a\\rangle$ 和 $|r\\rangle$ 混合成 $|a(\\theta)\\rangle$ 和 $|r(\\theta)\\rangle$，其关系如下\n$$\n|a(\\theta)\\rangle = \\cos\\theta\\,|a\\rangle + \\sin\\theta\\,|r\\rangle,\\qquad\n|r(\\theta)\\rangle = -\\sin\\theta\\,|a\\rangle + \\cos\\theta\\,|r\\rangle.\n$$\n在这个旋转后的基中，$H_{0}$ 的轨道能量变换如下\n$$\n\\epsilon_{a}(\\theta) = \\epsilon_{a}\\cos^{2}\\theta + \\epsilon_{r}\\sin^{2}\\theta,\\qquad\n\\epsilon_{r}(\\theta) = \\epsilon_{a}\\sin^{2}\\theta + \\epsilon_{r}\\cos^{2}\\theta.\n$$\n\n在 Rayleigh–Schrödinger 微扰理论框架内计算二阶能量，\n$$\nE^{(2)} = \\sum_{I\\notin \\mathcal{P}} \\frac{|\\langle \\Psi_{0} | V | I\\rangle|^{2}}{E_{0}^{(0)} - E_{I}^{(0)}},\n$$\n其中 $\\mathcal{P}$ 是模型（参考）空间， $|\\Psi_{0}\\rangle$ 是参考态，$V$ 是将参考态与外部态耦合的微扰，$E_{0}^{(0)}$ 和 $E_{I}^{(0)}$ 是零阶能量。对此单收缩类使用以下标准半正则 MRPT 假设：\n- 与外部类的耦合平方取决于广义 Fock 矩阵元 $f_{ar}$ 和活性占据数，即 $|\\langle \\Psi_{0}|V|I\\rangle|^{2} = n_{a}\\,f_{ar}^{2}$，并且与 $\\theta$ 无关。\n- 此类的零阶能量分母取决于旋转后的轨道能量差，即 $E_{0}^{(0)} - E_{I}^{(0)} = \\epsilon_{a}(\\theta) - \\epsilon_{r}(\\theta)$。\n\n使用以下数值\n$$\nn_{a} = 1.2,\\quad f_{ar} = 0.050\\ \\text{Hartree},\\quad \\epsilon_{a} = -0.500\\ \\text{Hartree},\\quad \\epsilon_{r} = 0.300\\ \\text{Hartree},\n$$\n为此单类模型定义 $E^{(2)}(\\theta)$，并使用中心三点格式计算在 $\\theta=0$ 处的曲率（关于旋转角的二阶导数）的有限差分估计值\n$$\n\\frac{d^{2}E^{(2)}}{d\\theta^{2}}\\bigg|_{\\theta=0} \\approx \\frac{E^{(2)}(h) - 2E^{(2)}(0) + E^{(2)}(-h)}{h^{2}},\n$$\n步长 $h = 0.050$ 弧度。\n\n将您的答案四舍五入至四位有效数字。最终曲率以 Hartree/弧度² 为单位表示。您的最终答案必须是一个数字。", "solution": "问题陈述经验证是自洽的，在理论化学框架内具有科学依据，并且是适定的。所有必要的数据、定义和方程均已提供，并且没有内部矛盾或事实错误。该问题是将多参考微扰理论原理应用于简化模型系统的一个有效练习。我们将开始解题。\n\n目标是计算二阶微扰能量 $E^{(2)}$ 关于轨道旋转角 $\\theta$ 在 $\\theta=0$ 处的曲率。曲率是二阶导数，将使用三点中心有限差分格式进行估计。\n\n首先，我们必须构建显式函数 $E^{(2)}(\\theta)$。二阶 Rayleigh-Schrödinger 微扰能量的通用公式如下：\n$$\nE^{(2)} = \\sum_{I\\notin \\mathcal{P}} \\frac{|\\langle \\Psi_{0} | V | I\\rangle|^{2}}{E_{0}^{(0)} - E_{I}^{(0)}}\n$$\n问题指明只有一个收缩激发类对该求和有贡献。对于此类，耦合矩阵元的平方被给定为一个常数：\n$$\n|\\langle \\Psi_{0}|V|I\\rangle|^{2} = n_{a} f_{ar}^{2}\n$$\n零阶能量分母被给定为旋转后轨道能量的函数：\n$$\nE_{0}^{(0)} - E_{I}^{(0)} = \\epsilon_{a}(\\theta) - \\epsilon_{r}(\\theta)\n$$\n旋转后的轨道能量定义为：\n$$\n\\epsilon_{a}(\\theta) = \\epsilon_{a}\\cos^{2}\\theta + \\epsilon_{r}\\sin^{2}\\theta\n$$\n$$\n\\epsilon_{r}(\\theta) = \\epsilon_{a}\\sin^{2}\\theta + \\epsilon_{r}\\cos^{2}\\theta\n$$\n我们将这些代入分母表达式中：\n$$\n\\epsilon_{a}(\\theta) - \\epsilon_{r}(\\theta) = (\\epsilon_{a}\\cos^{2}\\theta + \\epsilon_{r}\\sin^{2}\\theta) - (\\epsilon_{a}\\sin^{2}\\theta + \\epsilon_{r}\\cos^{2}\\theta)\n$$\n$$\n= \\epsilon_{a}(\\cos^{2}\\theta - \\sin^{2}\\theta) - \\epsilon_{r}(\\cos^{2}\\theta - \\sin^{2}\\theta)\n$$\n使用三角恒等式 $\\cos(2\\theta) = \\cos^{2}\\theta - \\sin^{2}\\theta$，上式简化为：\n$$\n\\epsilon_{a}(\\theta) - \\epsilon_{r}(\\theta) = (\\epsilon_{a} - \\epsilon_{r}) \\cos(2\\theta)\n$$\n结合分子和分母，二阶能量作为旋转角函数的表达式为：\n$$\nE^{(2)}(\\theta) = \\frac{n_{a} f_{ar}^{2}}{(\\epsilon_{a} - \\epsilon_{r}) \\cos(2\\theta)}\n$$\n现在，我们代入所提供的数值：\n$n_{a} = 1.2$\n$f_{ar} = 0.050\\ \\text{Hartree}$\n$\\epsilon_{a} = -0.500\\ \\text{Hartree}$\n$\\epsilon_{r} = 0.300\\ \\text{Hartree}$\n\n分子是：\n$$\nn_{a} f_{ar}^{2} = 1.2 \\times (0.050)^{2} = 1.2 \\times 0.0025 = 0.003\\ \\text{Hartree}^{2}\n$$\n分母中的能量差是：\n$$\n\\epsilon_{a} - \\epsilon_{r} = -0.500 - 0.300 = -0.800\\ \\text{Hartree}\n$$\n因此，函数 $E^{(2)}(\\theta)$ 变为：\n$$\nE^{(2)}(\\theta) = \\frac{0.003}{-0.800 \\cos(2\\theta)} = -\\frac{0.00375}{\\cos(2\\theta)}\\ \\text{Hartree}\n$$\n在 $\\theta=0$ 处的曲率将使用中心有限差分公式进行估计，步长 $h = 0.050$ 弧度：\n$$\n\\frac{d^{2}E^{(2)}}{d\\theta^{2}}\\bigg|_{\\theta=0} \\approx \\frac{E^{(2)}(h) - 2E^{(2)}(0) + E^{(2)}(-h)}{h^{2}}\n$$\n我们必须计算三个点处的能量：$\\theta=0$，$\\theta=h=0.050$，以及 $\\theta=-h=-0.050$。\n\n对于 $\\theta=0$：\n$$\nE^{(2)}(0) = -\\frac{0.00375}{\\cos(2 \\times 0)} = -\\frac{0.00375}{\\cos(0)} = -\\frac{0.00375}{1} = -0.00375\\ \\text{Hartree}\n$$\n对于 $\\theta=h=0.050$：\n$$\nE^{(2)}(0.050) = -\\frac{0.00375}{\\cos(2 \\times 0.050)} = -\\frac{0.00375}{\\cos(0.1)}\n$$\n使用计算器计算 $\\cos(0.1)$（以弧度为单位）：$\\cos(0.1) \\approx 0.995004165$。\n$$\nE^{(2)}(0.050) \\approx -\\frac{0.00375}{0.995004165} \\approx -0.003768817\\ \\text{Hartree}\n$$\n对于 $\\theta=-h=-0.050$：\n由于余弦函数是偶函数，$\\cos(-x) = \\cos(x)$，我们有 $\\cos(-0.1) = \\cos(0.1)$。因此：\n$$\nE^{(2)}(-0.050) = E^{(2)}(0.050) \\approx -0.003768817\\ \\text{Hartree}\n$$\n现在，将这些值代入有限差分公式。步长的平方是 $h^{2} = (0.050)^{2} = 0.0025\\ \\text{rad}^{2}$。\n$$\n\\frac{d^{2}E^{(2)}}{d\\theta^{2}}\\bigg|_{\\theta=0} \\approx \\frac{(-0.003768817) - 2(-0.00375) + (-0.003768817)}{0.0025}\n$$\n$$\n\\approx \\frac{2 \\times (-0.003768817) + 0.0075}{0.0025}\n$$\n$$\n\\approx \\frac{-0.007537634 + 0.0075}{0.0025}\n$$\n$$\n\\approx \\frac{-0.000037634}{0.0025} \\approx -0.0150536\\ \\text{Hartree}/\\text{rad}^{2}\n$$\n问题要求答案四舍五入到四位有效数字。\n$$\n-0.0150536 \\approx -0.01505\n$$\n最终估计的曲率为 $-0.01505$ Hartree/弧度²。", "answer": "$$\n\\boxed{-0.01505}\n$$", "id": "2654375"}]}