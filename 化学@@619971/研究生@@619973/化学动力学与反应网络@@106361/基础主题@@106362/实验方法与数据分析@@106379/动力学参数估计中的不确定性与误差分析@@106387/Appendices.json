{"hands_on_practices": [{"introduction": "我们探索的第一步是理解模型参数如何影响系统行为。灵敏度分析是连接模型参数与可观测输出的基本工具。在此练习中，您将通过一个简单的一级反应推导出速率常数 $k$ 的灵敏度系数，并分析其随时间的动态变化 [@problem_id:2692536]。掌握系统对参数最敏感（和最不敏感）的时刻，是设计信息丰富的实验和理解参数可估性（identifiability）的关键。", "problem": "在一个混合均匀、等温、恒容的间歇式反应器中，考虑一个遵循质量作用定律的从物种 $A$ 到物种 $B$ 的不可逆单分子反应。设 $x_{A}(t)$ 表示物种 $A$ 在时间 $t$ 的浓度，并设 $k>0$ 为一级反应速率常数。$x_{A}(t)$ 的动态变化遵循常微分方程 (ODE) $\\,\\frac{d x_{A}}{d t}=-k\\,x_{A}\\,$，其初始条件为 $\\,x_{A}(0)=x_{0}>0\\,$.\n\n任务：\n- 仅从该常微分方程和初始条件出发，推导出 $x_{A}(t)$ 的闭式解。\n- 使用关于参数的局部灵敏度系数的定义 $S_{k}(t)=\\frac{\\partial x_{A}(t)}{\\partial k}$，计算 $S_{k}(t)$ 的闭式表达式。\n- 从第一性原理简要解释 $|S_{k}(t)|$ 在 $t$ 较小和 $t$ 较大时如何随时间 $t$ 变化，并确定 $|S_{k}(t)|$ 达到最大值的时间以及相应的最大值。\n\n答案规格：\n- 将 $S_{k}(t)$ 的单一符号表达式作为最终答案。\n- 无需进行数值舍入。\n- 在最终的方框答案中不要包含单位。", "solution": "已对所提供的问题陈述进行分析，并确定其有效。这是一个来自化学动力学领域的、有科学依据、提法恰当且客观的问题。这是一个求解一阶常微分方程和进行灵敏度分析的标准练习，这两者都是基本步骤。我们将开始推导。\n\n物种 $A$ 的浓度（记为 $x_{A}(t)$）的动态变化由以下初值问题描述：\n$$ \\frac{dx_{A}}{dt} = -k x_{A}, \\quad x_{A}(0) = x_{0} $$\n其中 $k > 0$ 且 $x_{0} > 0$。这是一个一阶线性齐次常微分方程。该方程是可分离变量的，可以通过直接积分求解。\n$$ \\frac{dx_{A}}{x_{A}} = -k dt $$\n我们将两边从初始时间 $t=0$ 积分到任意时间 $t$。\n$$ \\int_{x_{A}(0)}^{x_{A}(t)} \\frac{1}{\\xi} d\\xi = \\int_{0}^{t} -k d\\tau $$\n积分得出：\n$$ [\\ln|\\xi|]_{x_{0}}^{x_{A}(t)} = [-k\\tau]_{0}^{t} $$\n$$ \\ln|x_{A}(t)| - \\ln|x_{0}| = -kt $$\n鉴于浓度 $x_{A}$ 必须为非负值，且初始浓度 $x_{0}$ 为正值，因此在所有有限时间 $t$ 内，$x_{A}(t)$ 将保持为正。因此，可以去掉绝对值符号。\n$$ \\ln\\left(\\frac{x_{A}(t)}{x_{0}}\\right) = -kt $$\n通过对两边取指数，我们得到浓度曲线的闭式解：\n$$ x_{A}(t) = x_{0} \\exp(-kt) $$\n至此完成第一个任务。\n\n第二个任务是计算 $x_{A}(t)$ 关于参数 $k$ 的局部灵敏度系数，其定义为 $S_{k}(t) = \\frac{\\partial x_{A}(t)}{\\partial k}$。我们可以通过对已推导出的 $x_{A}(t)$ 表达式关于 $k$ 求导来直接计算，并将 $x_{0}$ 和 $t$ 视为常数。\n$$ S_{k}(t) = \\frac{\\partial}{\\partial k} \\left( x_{0} \\exp(-kt) \\right) $$\n使用链式求导法则，我们得到：\n$$ S_{k}(t) = x_{0} \\cdot \\exp(-kt) \\cdot \\frac{\\partial}{\\partial k}(-kt) $$\n$$ S_{k}(t) = x_{0} \\exp(-kt) (-t) $$\n因此，灵敏度系数的闭式表达式为：\n$$ S_{k}(t) = -t x_{0} \\exp(-kt) $$\n\n最后一个任务是分析灵敏度大小 $|S_{k}(t)|$ 的行为并找到其最大值。由于 $t \\ge 0$， $x_{0} > 0$ 且 $\\exp(-kt) > 0$，其大小为：\n$$ |S_{k}(t)| = t x_{0} \\exp(-kt) $$\n\n$t$ 较小情况下的行为：当 $t \\to 0^{+}$ 时，我们可以通过考虑指数项的泰勒级数展开来分析其行为，$\\exp(-kt) \\approx 1 - kt + \\mathcal{O}((kt)^{2})$。\n$$ |S_{k}(t)| \\approx t x_{0} (1 - kt) = x_{0}t - kx_{0}t^{2} $$\n当 $t$ 较小时，线性项占主导，因此 $|S_{k}(t)|$ 随时间线性变化，即 $|S_{k}(t)| \\propto t$。这在物理上是直观的：在 $t=0$ 时，没有反应发生，所以浓度 $x_A(0)=x_0$ 与 $k$ 无关，使得灵敏度为零。随着反应的开始，浓度对速率常数 $k$ 的依赖性逐渐增强。\n\n$t$ 较大情况下的行为：当 $t \\to \\infty$ 时，指数项 $\\exp(-kt)$ 衰减到零的速度远快于线性项 $t$ 的增长速度。我们可以正式地计算这个极限：\n$$ \\lim_{t \\to \\infty} |S_{k}(t)| = \\lim_{t \\to \\infty} t x_{0} \\exp(-kt) = x_{0} \\lim_{t \\to \\infty} \\frac{t}{\\exp(kt)} $$\n这是一个 $\\frac{\\infty}{\\infty}$ 的不定式。应用 L'Hôpital 法则：\n$$ x_{0} \\lim_{t \\to \\infty} \\frac{\\frac{d}{dt}(t)}{\\frac{d}{dt}(\\exp(kt))} = x_{0} \\lim_{t \\to \\infty} \\frac{1}{k \\exp(kt)} = 0 $$\n因此，当 $t \\to \\infty$ 时， $|S_{k}(t)| \\to 0$。这在物理上也是合理的：经过很长一段时间后，反应趋于完成（$x_{A} \\to 0$），这个最终状态与 $k$ 的具体值无关（只要 $k>0$）。系统的状态对于其达到该状态的速率变得不敏感。\n\n为了找到 $|S_{k}(t)|$ 达到最大值的时间，我们必须通过将其对时间的一阶导数设为零来找到临界点。\n$$ \\frac{d}{dt}|S_{k}(t)| = \\frac{d}{dt} \\left( t x_{0} \\exp(-kt) \\right) $$\n使用乘积法则：\n$$ \\frac{d}{dt}|S_{k}(t)| = x_{0} \\left[ (1)\\exp(-kt) + t(-k \\exp(-kt)) \\right] = x_{0} \\exp(-kt) (1-kt) $$\n将导数设为零：\n$$ x_{0} \\exp(-kt) (1-kt) = 0 $$\n由于 $x_{0} > 0$ 且 $\\exp(-kt) > 0$，只有当 $1-kt = 0$ 时，该方程才成立。这给出了最大灵敏度出现的时间：\n$$ t_{\\text{max}} = \\frac{1}{k} $$\n该时间对应于一级衰减过程的特征时间常数。为确认这是一个最大值，我们可以检验二阶导数的符号，或者简单地注意到 $|S_k(0)|=0$ 且当 $t \\to \\infty$ 时 $|S_k(t)| \\to 0$，而 $t=1/k$ 是唯一的正临界点。因此，函数必然在此处达到其最大值。\n\n将 $t_{\\text{max}}$ 代入 $|S_{k}(t)|$ 的表达式中，可求得灵敏度的最大值：\n$$ |S_{k}(t_{\\text{max}})| = \\left(\\frac{1}{k}\\right) x_{0} \\exp\\left(-k\\left(\\frac{1}{k}\\right)\\right) = \\frac{x_{0}}{k} \\exp(-1) = \\frac{x_{0}}{ke} $$\n总而言之，浓度 $x_A$ 对速率常数 $k$ 的灵敏度初始为零，在特征时间 $t=1/k$ 时增加到最大值 $\\frac{x_0}{ke}$，然后随着反应趋于完成而衰减至零。该时间点代表了速率常数 $k$ 的一个微小相对变化对物种 $A$ 的浓度产生最大绝对影响的时刻。", "answer": "$$\n\\boxed{-t x_{0} \\exp(-k t)}\n$$", "id": "2692536"}, {"introduction": "在了解了灵敏度系数后，下一步自然是量化测量数据中包含的关于未知参数的“信息”量。本练习将介绍 Fisher 信息矩阵（FIM），它将灵敏度与参数不确定性在存在噪声的情况下正式联系起来 [@problem_id:2692578]。您将推导 Fisher 信息，并最终解决一个实验设计中的核心问题：确定最佳采样时间以最大化关于速率常数的信息，这揭示了信号累积与信号衰减之间的根本权衡。", "problem": "考虑一个不可逆、等温、混合均匀的间歇反应 $A \\to B$，该反应遵循质量作用动力学，其一级速率常数为 $k$ (单位 $\\,\\mathrm{s}^{-1}$)。物种 $A$ 的浓度，记作 $x_A(t)$，其演变遵循常微分方程 $\\mathrm{d}x_A/\\mathrm{d}t=-k\\,x_A$，初始条件为 $x_A(0)=x_0$，其中 $x_0>0$ 为已知。你在采样时间 $\\{t_i\\}_{i=1}^n$ 对 $x_A(t)$ 进行了 $n$ 次独立测量，观测模型为 $y_i=x_A(t_i)+\\varepsilon_i$，其中噪声 $\\varepsilon_i$ 是独立同分布的，服从均值为零、方差为 $\\sigma^2$ 的高斯分布，且 $\\sigma^2$ 已知。\n\n仅使用所述的动力学、观测模型以及统计估计理论中 Fisher 信息的定义，推导 $k$ 的标量 Fisher 信息（记作 $F_{kk}(k)$）的闭式表达式，该表达式用 $x_0$、$\\sigma^2$、$k$ 和 $\\{t_i\\}_{i=1}^n$ 表示。然后，通过找出当 $k$ 视为已知时，使单次采样对 $F_{kk}(k)$ 的贡献最大化的采样时间 $t^\\star$（视为连续变量），来分析 $F_{kk}(k)$ 如何依赖于采样方案 $\\{t_i\\}_{i=1}^n$。请简要定性解释决定此最大值点的权衡关系。\n\nFisher 信息的单位用平方秒表示，但在最终的方框答案中不要包含单位。你的最终答案必须是关于 $F_{kk}(k)$ 的单个解析表达式，并尽可能化简。", "solution": "首先对问题陈述进行验证。\n\n**步骤 1：提取已知条件**\n- 反应：$A \\to B$，不可逆、等温、混合均匀、间歇。\n- 动力学：质量作用、一级。\n- 速率常数：$k$，单位为 $\\mathrm{s}^{-1}$。\n- 状态模型 (ODE)：$\\frac{\\mathrm{d}x_A}{\\mathrm{d}t}=-k\\,x_A$。\n- 初始条件：$x_A(0)=x_0$，其中 $x_0 > 0$ 已知。\n- 测量次数：$n$。\n- 采样时间：$\\{t_i\\}_{i=1}^n$。\n- 观测模型：$y_i=x_A(t_i)+\\varepsilon_i$。\n- 噪声模型：$\\varepsilon_i$ 是来自均值为零、方差已知的正态分布的独立同分布 (i.i.d.) 随机变量，即 $\\varepsilon_i \\sim \\mathcal{N}(0, \\sigma^2)$。\n\n**步骤 2：使用提取的已知条件进行验证**\n根据所需标准对问题进行评估。\n- **科学依据**：该问题建立在化学动力学（一级衰减）和统计估计理论（加性高斯噪声下参数估计的 Fisher 信息）的基本原理之上。这些都是标准、成熟的模型。该设定在科学上是合理的。\n- **适定性**：该问题提供了推导所求量所需的所有信息。模型被完全指定，参数被定义，任务也以数学上的精确性进行了陈述。存在唯一且有意义的解。\n- **客观性**：该问题使用客观的技术语言表述，没有任何主观或模糊的术语。\n\n该问题没有表现出任何列出的缺陷。它并非科学上不合理、不可形式化、不完整、不切实际、不适定、琐碎或不可验证。\n\n**步骤 3：结论与行动**\n问题有效。将提供一个完整的解。\n\n推导从第一性原理开始。\n首先，我们必须求解控制物种 $A$ 浓度 $x_A(t)$ 的常微分方程。方程为 $\\frac{\\mathrm{d}x_A}{\\mathrm{d}t} = -k x_A$。这是一个可分离的一阶线性微分方程。\n$$\n\\frac{\\mathrm{d}x_A}{x_A} = -k \\, \\mathrm{d}t\n$$\n对两边积分，时间从 $0$ 到 $t$，浓度从 $x_A(0)$ 到 $x_A(t)$：\n$$\n\\int_{x_A(0)}^{x_A(t)} \\frac{1}{\\xi} \\, \\mathrm{d}\\xi = \\int_0^t -k \\, \\mathrm{d}\\tau\n$$\n$$\n\\ln(x_A(t)) - \\ln(x_A(0)) = -kt\n$$\n给定初始条件 $x_A(0) = x_0$，我们得到：\n$$\n\\ln\\left(\\frac{x_A(t)}{x_0}\\right) = -kt\n$$\n对两边取指数，得到浓度分布的解：\n$$\nx_A(t) = x_0 \\exp(-kt)\n$$\n观测模型为 $y_i = x_A(t_i) + \\varepsilon_i$，其中 $\\varepsilon_i \\sim \\mathcal{N}(0, \\sigma^2)$。这意味着每次测量 $y_i$ 都是一个从均值为 $\\mu_i = x_A(t_i)$、方差为 $\\sigma^2$ 的高斯分布中抽取的随机变量。在参数 $k$ 给定的情况下，单次测量 $y_i$ 的概率密度函数为：\n$$\np(y_i | k) = \\frac{1}{\\sqrt{2\\pi\\sigma^2}} \\exp\\left(-\\frac{(y_i - x_A(t_i))^2}{2\\sigma^2}\\right)\n$$\nFisher 信息提供了一种度量，用于衡量一个可观测随机变量所携带的、关于一个未知参数（该随机变量的概率依赖于此参数）的信息量。对于单个参数 $\\theta$ 和受到独立、加性、零均值、恒定方差 $\\sigma^2$ 的高斯噪声污染的观测值，Fisher 信息简化为对所有测量值的求和：\n$$\nF_{\\theta\\theta}(\\theta) = \\sum_{i=1}^n \\frac{1}{\\sigma^2} \\left( \\frac{\\partial \\mu_i}{\\partial \\theta} \\right)^2\n$$\n在我们的问题中，参数是 $\\theta = k$，在时间 $t_i$ 的测量均值是 $\\mu_i = x_A(t_i; k)$。因此，对于 $k$ 的标量 Fisher 信息，记作 $F_{kk}(k)$，为：\n$$\nF_{kk}(k) = \\sum_{i=1}^n \\frac{1}{\\sigma^2} \\left( \\frac{\\partial x_A(t_i)}{\\partial k} \\right)^2\n$$\n我们必须计算状态 $x_A(t)$ 相对于参数 $k$ 的偏导数。这个导数被称为状态对参数的灵敏度。\n$$\n\\frac{\\partial x_A(t)}{\\partial k} = \\frac{\\partial}{\\partial k} \\left( x_0 \\exp(-kt) \\right)\n$$\n由于 $x_0$ 和 $t$ 不是 $k$ 的函数，我们应用链式法则：\n$$\n\\frac{\\partial x_A(t)}{\\partial k} = x_0 \\exp(-kt) \\cdot \\frac{\\partial}{\\partial k}(-kt) = x_0 \\exp(-kt) \\cdot (-t) = -t x_0 \\exp(-kt)\n$$\n现在，我们将此灵敏度表达式代回 Fisher 信息的公式中：\n$$\nF_{kk}(k) = \\sum_{i=1}^n \\frac{1}{\\sigma^2} \\left( -t_i x_0 \\exp(-kt_i) \\right)^2\n$$\n化简求和内的表达式：\n$$\nF_{kk}(k) = \\sum_{i=1}^n \\frac{1}{\\sigma^2} \\left( t_i^2 x_0^2 \\exp(-2kt_i) \\right)\n$$\n由于 $x_0$ 和 $\\sigma^2$ 对所有测量都是常数，它们可以从求和中提出来：\n$$\nF_{kk}(k) = \\frac{x_0^2}{\\sigma^2} \\sum_{i=1}^n t_i^2 \\exp(-2kt_i)\n$$\n这就是速率常数 $k$ 的 Fisher 信息的闭式表达式。$x_0$ 和 $\\sigma$ 的单位是浓度，使得比率 $x_0^2/\\sigma^2$ 无量纲。速率常数 $k$ 的单位是 $\\mathrm{s}^{-1}$，时间 $t_i$ 的单位是 $\\mathrm{s}$，所以指数的参数 $-2kt_i$ 是无量纲的。$t_i^2$ 项的单位是 $\\mathrm{s}^2$，因此整个 $F_{kk}(k)$ 表达式的单位是 $\\mathrm{s}^2$，符合要求。\n\n接下来，我们分析使单次采样的 Fisher 信息贡献最大化的采样时间 $t^\\star$。在时间 $t$ 进行单次采样的贡献是求和项：\n$$\nf(t; k) = \\frac{x_0^2}{\\sigma^2} t^2 \\exp(-2kt)\n$$\n为了找到使该函数最大化的时间 $t$，我们计算它关于 $t$ 的导数并令其为零。$\\frac{x_0^2}{\\sigma^2}$ 项是一个正常数，不影响最大值的位置。令 $g(t) = t^2 \\exp(-2kt)$。\n$$\n\\frac{\\mathrm{d}g}{\\mathrm{d}t} = \\frac{\\mathrm{d}}{\\mathrm{d}t} \\left( t^2 \\exp(-2kt) \\right)\n$$\n使用微分乘法法则：\n$$\n\\frac{\\mathrm{d}g}{\\mathrm{d}t} = (2t) \\exp(-2kt) + t^2 \\exp(-2kt) \\cdot (-2k) = (2t - 2kt^2) \\exp(-2kt)\n$$\n我们令导数为零以找到临界点：\n$$\n(2t - 2kt^2) \\exp(-2kt) = 2t(1-kt) \\exp(-2kt) = 0\n$$\n对于有物理意义的时间 $t > 0$，$2t \\exp(-2kt)$ 项总是正的。因此，极值点发生在：\n$$\n1-kt = 0 \\implies kt = 1 \\implies t^\\star = \\frac{1}{k}\n$$\n为了确认这是一个最大值，我们考察其二阶导数。\n$$\n\\frac{\\mathrm{d}^2g}{\\mathrm{d}t^2} = \\frac{\\mathrm{d}}{\\mathrm{d}t} \\left( (2t - 2kt^2) \\exp(-2kt) \\right) = (2 - 4kt)\\exp(-2kt) + (2t - 2kt^2)(-2k)\\exp(-2kt)\n$$\n$$\n\\frac{\\mathrm{d}^2g}{\\mathrm{d}t^2} = (2 - 4kt - 4kt + 4k^2t^2)\\exp(-2kt) = (2 - 8kt + 4k^2t^2)\\exp(-2kt)\n$$\n在 $t = t^\\star = 1/k$ 处求值：\n$$\n\\left. \\frac{\\mathrm{d}^2g}{\\mathrm{d}t^2} \\right|_{t=1/k} = (2 - 8k(1/k) + 4k^2(1/k)^2)\\exp(-2k(1/k)) = (2 - 8 + 4)\\exp(-2) = -2\\exp(-2)\n$$\n由于二阶导数为负， $t^\\star = 1/k$ 确实是一个局部最大值。由于当 $t \\to 0^+$ 时 $g(t) \\to 0$ 且当 $t \\to \\infty$ 时 $g(t) \\to 0$，这是对于 $t>0$ 的全局最大值。\n\n这个最优采样时间的存在反映了一个基本的权衡。信息含量与灵敏度的平方成正比，即 $(\\frac{\\partial x_A}{\\partial k})^2 = t^2 x_A(t)^2$。这个表达式包含两个相互竞争的因素。$t^2$ 因子表明对 $k$ 的灵敏度随时间增加；等待更长时间可以让速率的影响累积起来。然而，$x_A(t)^2 = (x_0 \\exp(-kt))^2$ 因子表明，随着时间的推移，反应物浓度呈指数衰减。当浓度趋近于零时，信噪比下降，测量所含信息变少。最优采样时间 $t^\\star = 1/k$，即该反应的特征时间常数，代表了这种权衡达到完美平衡的点。在这个时间点，浓度已衰减至 $x_A(1/k) = x_0 \\exp(-1)$，这是一个与初始状态显著不同的值，但仍然足够大，可以以合理的精度进行测量。", "answer": "$$\n\\boxed{\\frac{x_0^2}{\\sigma^2} \\sum_{i=1}^n t_i^2 \\exp(-2kt_i)}\n$$", "id": "2692578"}, {"introduction": "超越为单个模型估计参数的范畴，我们进入更高级的任务：在多个竞争模型之间进行选择。这个动手编程练习将引导您实施似然比检验（Likelihood Ratio Test, LRT），这是一种强大的统计假设检验方法，用于判断数据是否支持某个特定反应路径的存在 [@problem_id:2692475]。通过比较一个完整模型与其嵌套的简化模型，您将学会一种实用且定量的方法来进行模型选择，并评估模型中特定组分（如一条反应路径）的统计显著性。", "problem": "考虑一个不可逆、等温、充分混合的分支一级反应网络，该网络包含单一反应物和两个产物分支：$A \\to B$ 的速率常数为 $k_1$，$A \\to C$ 的速率常数为 $k_2$。物种浓度 $A(t)$、$B(t)$ 和 $C(t)$ 的确定性质谱作用动力学满足以下常微分方程组 (ODEs)\n$$\n\\frac{dA}{dt} = -(k_1 + k_2) A, \\quad \\frac{dB}{dt} = k_1 A, \\quad \\frac{dC}{dt} = k_2 A,\n$$\n初始条件为 $A(0) = A_0$，$B(0) = 0$，$C(0) = 0$。初始浓度已知且等于 $A_0 = 1.0 \\, \\text{mol} \\cdot \\text{L}^{-1}$。\n\n假设在测量时间 $t_i$（单位：秒），测得的产物浓度 $y_{B,i}$ 和 $y_{C,i}$ 是围绕真实状态值 $B(t_i)$ 和 $C(t_i)$ 的独立高斯测量值：\n$$\ny_{B,i} \\sim \\mathcal{N}(B(t_i), \\sigma_B^2), \\quad y_{C,i} \\sim \\mathcal{N}(C(t_i), \\sigma_C^2),\n$$\n其标准差已知且恒定，为 $\\sigma_B = \\sigma_C = 2.0 \\times 10^{-2} \\, \\text{mol} \\cdot \\text{L}^{-1}$。\n\n您的任务是实现一个似然比检验 (LRT)，用于检验复合假设 $H_0: k_1 = 0$（不存在直接的 $A \\to B$ 路径）与备择假设 $H_1: k_1 > 0$。在 $H_0$ 和 $H_1$ 中，都将 $k_2$ 视为讨厌参数。您将：\n- 在完整模型 $H_1$（$k_1$ 和 $k_2$ 均为自由且非负）和约束模型 $H_0$（固定 $k_1 = 0$，优化 $k_2 \\ge 0$）下，计算最大似然估计 (MLE)。\n- 使用具有已知方差的高斯测量模型，为数据集 $\\{(t_i, y_{B,i}, y_{C,i})\\}_{i=1}^n$ 构建对数似然，并计算似然比统计量\n$$\n\\Lambda = 2\\left(\\ell(\\widehat{k}_1,\\widehat{k}_2) - \\ell(0,\\widehat{k}_2^{(0)})\\right),\n$$\n其中 $\\ell(\\cdot)$ 是对数似然，帽子符号表示相应模型下的最大似然估计值。在标准正则性假设下，将 $H_0$ 下的 $\\Lambda$ 近似视为服从 $\\chi^2_1$ 分布，并计算 $p$ 值：$p = 1 - F_{\\chi^2_1}(\\Lambda)$，表示为无单位的小数。注意：如果由于优化容差导致 $\\Lambda$ 在数值上为负，则将其设为 $\\Lambda = 0$。\n\n您必须实现一个完整的程序，对于下方的每个测试案例，通过精确求解常微分方程并在给定时间点上，使用指定的“真实”参数值计算 $B(t)$ 和 $C(t)$，来构建一个无噪声数据集，然后如上所述执行似然比检验。所有物理单位必须保持一致：时间单位为秒，速率常数单位为 $\\text{s}^{-1}$，浓度单位为 $\\text{mol} \\cdot \\text{L}^{-1}$。输出的 $p$ 值是纯数字（无百分号的小数）。\n\n您必须使用且不得偏离的基本和建模假设：\n- 如常微分方程系统所述的一级质量作用动力学。\n- 测量误差的独立性和高斯性，且方差已知。\n- 在每个假设下，使用最大似然估计 (MLE) 进行参数估计。\n\n测试套件（使用 $A_0 = 1.0 \\, \\text{mol} \\cdot \\text{L}^{-1}$ 和给定的真实参数，从模型中精确构建 $y_{B,i}$ 和 $y_{C,i}$，不添加噪声）：\n- 案例1（一般情况，$H_0$ 为假）：时间 $t = [0.0, 0.5, 1.0, 2.0, 3.0, 4.0]$ 秒；真实参数 $k_1^\\star = 0.25 \\text{ s}^{-1}$，$k_2^\\star = 0.50 \\text{ s}^{-1}$。\n- 案例2（边界情况，$H_0$ 为真）：时间 $t = [0.0, 0.5, 1.0, 2.0, 3.0, 4.0]$ 秒；真实参数 $k_1^\\star = 0.0 \\text{ s}^{-1}$，$k_2^\\star = 0.50 \\text{ s}^{-1}$。\n- 案例3（弱信号）：时间 $t = [0.0, 0.5, 1.0, 2.0, 3.0, 4.0]$ 秒；真实参数 $k_1^\\star = 0.05 \\text{ s}^{-1}$，$k_2^\\star = 0.50 \\text{ s}^{-1}$。\n\n数值和统计要求：\n- 精确求解一级动力学的常微分方程组，为每个案例生成 $B(t_i)$ 和 $C(t_i)$。\n- 在每个假设下，通过最大化似然（等价于最小化高斯模型所隐含的加权残差平方和）来获得最大似然估计值。\n- 计算 $\\Lambda$，然后假设参考分布为 $\\chi^2_1$ 分布来计算 $p$ 值。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含三个 $p$ 值，按上述案例顺序排列，格式为一个用方括号括起来的逗号分隔列表，每个值小数点后至少报告六位数字。例如，如果三个 $p$ 值分别为 $p_1$、$p_2$、$p_3$，则输出必须如下所示：\n$[p_1,p_2,p_3]$。", "solution": "该问题要求实现一个似然比检验（LRT），以区分两个嵌套的动力学模型。任务的核心是在两种不同假设下对速率常数进行最大似然估计（MLE），然后利用这些结果计算检验统计量。该问题的有效性已得到确认，因为它在科学上基于化学动力学和统计推断的既定原则，问题陈述清晰且提供了所有必要信息，其表述是客观的。我们将进行严谨、分步的求解。\n\n首先，我们定义动力学模型及其解析解。该反应网络由物种 $A$ 的分支一级衰变给出：\n$$\nA \\xrightarrow{k_1} B \\\\\nA \\xrightarrow{k_2} C\n$$\n基于质量作用定律，其动力学由一个线性常微分方程组（ODEs）描述：\n$$\n\\frac{d[A]}{dt} = -(k_1 + k_2) [A], \\quad \\frac{d[B]}{dt} = k_1 [A], \\quad \\frac{d[C]}{dt} = k_2 [A]\n$$\n初始条件为 $[A](0) = A_0$，$[B](0) = 0$，$[C](0) = 0$。为简洁起见，我们用 $A(t)$、$B(t)$ 和 $C(t)$ 表示浓度。给定的初始浓度为 $A_0 = 1.0 \\, \\text{mol} \\cdot \\text{L}^{-1}$。\n\n$A(t)$ 的常微分方程是可分离的，积分后得到：\n$$\nA(t) = A_0 e^{-(k_1 + k_2)t}\n$$\n将此解代入 $B(t)$ 和 $C(t)$ 的方程，并从 $t=0$ 积分到 $t$，即可得到产物浓度的精确解析解。对于任意非零的速率常数之和 $k_1+k_2 > 0$：\n$$\nB(t) = \\int_0^t k_1 A_0 e^{-(k_1 + k_2)\\tau} d\\tau = \\frac{k_1 A_0}{k_1 + k_2} \\left(1 - e^{-(k_1 + k_2)t}\\right)\n$$\n$$\nC(t) = \\int_0^t k_2 A_0 e^{-(k_1 + k_2)\\tau} d\\tau = \\frac{k_2 A_0}{k_1 + k_2} \\left(1 - e^{-(k_1 + k_2)t}\\right)\n$$\n在 $k_1 + k_2 = 0$ 的特殊情况下，根据速率常数的非负约束，这意味着 $k_1 = 0$ 且 $k_2 = 0$，此时解是平凡的：$A(t) = A_0$ 且 $B(t) = C(t) = 0$。\n\n接下来，我们构建测量的统计模型。在时间点 $\\{t_i\\}_{i=1}^n$，测得的浓度为 $y_{B,i}$ 和 $y_{C,i}$。假设它们是从以真实浓度为中心的高斯分布中抽取的独立随机变量：\n$$\ny_{B,i} \\sim \\mathcal{N}(B(t_i | k_1, k_2), \\sigma_B^2), \\quad y_{C,i} \\sim \\mathcal{N}(C(t_i | k_1, k_2), \\sigma_C^2)\n$$\n标准差已知且相等：$\\sigma_B = \\sigma_C = \\sigma = 2.0 \\times 10^{-2} \\, \\text{mol} \\cdot \\text{L}^{-1}$。整个数据集 $\\{(t_i, y_{B,i}, y_{C,i})\\}_{i=1}^n$ 的对数似然函数 $\\ell(k_1, k_2)$ 是每个独立测量值的对数概率之和：\n$$\n\\ell(k_1, k_2) = \\sum_{i=1}^n \\left( -\\frac{(y_{B,i} - B(t_i))^2}{2\\sigma^2} - \\frac{(y_{C,i} - C(t_i))^2}{2\\sigma^2} - \\log(2\\pi\\sigma^2) \\right)\n$$\n最大化此对数似然函数等价于最小化其负数，在移除常数项后，这又等价于最小化加权残差平方和（SSR）。由于方差是恒定的，这可以简化为最小化未加权的 SSR，其定义为：\n$$\nS(k_1, k_2) = \\sum_{i=1}^n \\left[ (y_{B,i} - B(t_i | k_1, k_2))^2 + (y_{C,i} - C(t_i | k_1, k_2))^2 \\right]\n$$\n参数的最大似然估计值（MLEs）是使此 SSR 函数最小化的值。\n\n该问题提出了一个假设检验。原假设 $H_0$ 假定路径 $A \\to B$ 不存在，而备择假设 $H_1$ 代表完整模型。速率常数必须为非负。\n- 原假设 $H_0: k_1 = 0$，其中 $k_2 \\ge 0$ 为讨厌参数。\n- 备择假设 $H_1: k_1 > 0$，其中 $k_2 \\ge 0$ 为讨厌参数。最大似然估计在 $k_1 \\ge 0, k_2 \\ge 0$ 的空间中寻找。\n\n为了执行似然比检验，我们通过最小化 SSR 来找到两种假设下的最大似然估计值：\n1.  在 $H_1$ 下，我们找到 $(\\widehat{k}_1, \\widehat{k}_2) = \\text{argmin}_{k_1 \\ge 0, k_2 \\ge 0} S(k_1, k_2)$。令最小 SSR 为 $\\widehat{S}_1 = S(\\widehat{k}_1, \\widehat{k}_2)$。这需要一个二维约束数值优化。\n2.  在 $H_0$ 下，我们设置 $k_1 = 0$。模型简化为 $B(t) = 0$ 和 $C(t) = A_0(1 - e^{-k_2 t})$。我们找到 $\\widehat{k}_2^{(0)} = \\text{argmin}_{k_2 \\ge 0} S(0, k_2)$。令最小 SSR 为 $\\widehat{S}_0 = S(0, \\widehat{k}_2^{(0)})$。这是一个一维约束数值优化。\n\n似然比检验统计量 $\\Lambda$ 定义为：\n$$\n\\Lambda = 2 \\left(\\ell(\\widehat{k}_1, \\widehat{k}_2) - \\ell(0, \\widehat{k}_2^{(0)})\\right)\n$$\n用 SSR 值代入对数似然的表达式：\n$$\n\\Lambda = 2 \\left( \\left(-\\frac{\\widehat{S}_1}{2\\sigma^2} - C\\right) - \\left(-\\frac{\\widehat{S}_0}{2\\sigma^2} - C\\right) \\right) = \\frac{\\widehat{S}_0 - \\widehat{S}_1}{\\sigma^2}\n$$\n其中 $C$ 代表常数项。因为 $H_0$ 是 $H_1$ 的一个嵌套子模型，所以必然有 $\\widehat{S}_0 \\ge \\widehat{S}_1$，因此 $\\Lambda \\ge 0$。任何由于优化器容差而导致的数值上为负的 $\\Lambda$ 值都应设为 $0$。\n\n在原假设 $H_0$ 下，且满足标准正则性条件时，$\\Lambda$ 服从卡方分布。自由度是 $H_1$ 和 $H_0$ 之间自由参数数量的差，即 $2 - 1 = 1$。问题指定使用 $\\chi^2_1$ 分布。$p$ 值是在假设 $H_0$ 为真的情况下，观察到至少与计算出的检验统计量一样极端的检验统计量的概率：\n$$\np = P(\\chi^2_1 \\ge \\Lambda) = 1 - F_{\\chi^2_1}(\\Lambda)\n$$\n其中 $F_{\\chi^2_1}$ 是自由度为 1 的 $\\chi^2$ 分布的累积分布函数（CDF）。\n\n对于每个测试案例的总体算法如下：\n1.  使用 $B(t)$ 和 $C(t)$ 的解析解以及给定的“真实”参数 $k_1^\\star$ 和 $k_2^\\star$，生成一个无噪声数据集 $\\{ (t_i, y_{B,i}, y_{C,i}) \\}$。\n2.  为 $H_1$ 定义 SSR 的目标函数 $S(k_1, k_2)$，为 $H_0$ 定义 $S(0, k_2)$。\n3.  使用数值优化算法（例如，来自 SciPy 的 L-BFGS-B）在速率常数非负的约束下，分别找到每个假设下的最小 SSR，即 $\\widehat{S}_1$ 和 $\\widehat{S}_0$。\n4.  计算 LRT 统计量 $\\Lambda = \\max(0, (\\widehat{S}_0 - \\widehat{S}_1)/\\sigma^2)$。\n5.  使用 $\\chi^2_1$ CDF 计算 $p$ 值。\n将对所提供的3个测试案例实施此程序。", "answer": "```python\nimport numpy as np\nfrom scipy.optimize import minimize\nfrom scipy.stats import chi2\n\ndef solve():\n    \"\"\"\n    Implements a Likelihood Ratio Test for a branched first-order reaction network.\n    \"\"\"\n    # Define problem constants\n    A0 = 1.0\n    SIGMA = 2.0e-2\n\n    # Test cases from the problem statement\n    test_cases = [\n        {\n            \"times\": np.array([0.0, 0.5, 1.0, 2.0, 3.0, 4.0]),\n            \"k1_true\": 0.25,\n            \"k2_true\": 0.50,\n        },\n        {\n            \"times\": np.array([0.0, 0.5, 1.0, 2.0, 3.0, 4.0]),\n            \"k1_true\": 0.0,\n            \"k2_true\": 0.50,\n        },\n        {\n            \"times\": np.array([0.0, 0.5, 1.0, 2.0, 3.0, 4.0]),\n            \"k1_true\": 0.05,\n            \"k2_true\": 0.50,\n        },\n    ]\n\n    p_values = []\n\n    def model_full(t, k1, k2):\n        \"\"\"Analytical solution for B(t) and C(t) for the full model.\"\"\"\n        k_sum = k1 + k2\n        t = np.asarray(t)\n        \n        # Handle the case k1+k2 -> 0 to avoid numerical instability\n        if np.abs(k_sum) < 1e-9:\n            B = k1 * A0 * t\n            C = k2 * A0 * t\n        else:\n            # Use of np.expm1 to maintain precision for small arguments\n            term = -k_sum * t\n            factor = -np.expm1(term) / k_sum\n            B = k1 * A0 * factor\n            C = k2 * A0 * factor\n        return B, C\n\n    def model_H0(t, k2):\n        \"\"\"Analytical solution for C(t) under H0 (k1=0). B(t) is always 0.\"\"\"\n        t = np.asarray(t)\n        # Use of np.expm1 for precision\n        C = A0 * (-np.expm1(-k2 * t))\n        return C\n\n    for case in test_cases:\n        t_data = case[\"times\"]\n        k1_true = case[\"k1_true\"]\n        k2_true = case[\"k2_true\"]\n\n        # Generate noise-free measurement data\n        y_B, y_C = model_full(t_data, k1_true, k2_true)\n\n        # Objective function for H1 (minimizing SSR)\n        def objective_H1(k):\n            k1, k2 = k\n            B_model, C_model = model_full(t_data, k1, k2)\n            ssr = np.sum((y_B - B_model) ** 2) + np.sum((y_C - C_model) ** 2)\n            return ssr\n        \n        # Objective function for H0 (minimizing SSR)\n        def objective_H0(k):\n            k2 = k[0]\n            # Under H0, B_model is always 0\n            C_model = model_H0(t_data, k2)\n            ssr = np.sum(y_B ** 2) + np.sum((y_C - C_model) ** 2)\n            return ssr\n\n        # Perform MLE for H1\n        # Initial guess can be small positive numbers\n        initial_guess_H1 = [0.1, 0.1]\n        bounds_H1 = [(0, None), (0, None)]\n        res_H1 = minimize(\n            objective_H1, initial_guess_H1, method='L-BFGS-B', bounds=bounds_H1\n        )\n        S_hat_1 = res_H1.fun\n        \n        # Perform MLE for H0\n        initial_guess_H0 = [0.1]\n        bounds_H0 = [(0, None)]\n        res_H0 = minimize(\n            objective_H0, initial_guess_H0, method='L-BFGS-B', bounds=bounds_H0\n        )\n        S_hat_0 = res_H0.fun\n\n        # Calculate the Likelihood Ratio Test statistic\n        Lambda = (S_hat_0 - S_hat_1) / (SIGMA ** 2)\n        \n        # Enforce non-negativity due to numerical tolerances\n        Lambda = max(0.0, Lambda)\n        \n        # Calculate the p-value using the chi-squared distribution with 1 df\n        p_val = 1.0 - chi2.cdf(Lambda, df=1)\n        p_values.append(p_val)\n\n    # Format the final output as specified\n    print(f\"[{','.join([f'{p:.6f}' for p in p_values])}]\")\n\nif __name__ == '__main__':\n    solve()\n```", "id": "2692475"}]}