{"hands_on_practices": [{"introduction": "在进行任何参数估计之前，一个至关重要的问题是：我们想要估计的参数是否“可辨识”？结构可辨识性分析探究的是，在理想的无噪声数据条件下，我们是否能够从模型的输出中唯一地确定参数值。这个问题 [@problem_id:2627935] 探讨了一个经典的平行反应系统，你将通过推导发现，仅观测反应物浓度时，并非所有速率常数都能被独立确定，并学习如何通过重参数化来分离可辨识与不可辨识的部分。", "problem": "考虑平行、不可逆的基元反应 $A \\to B$ 和 $A \\to C$，其一级反应速率常数分别为 $k_{1}>0$ 和 $k_{2}>0$。初始量 $A(0)$ 为 $A_{0}>0$。您仅在时间 $t_{i}\\ge 0$，$i=1,\\dots,n$ 观测反应物 $A$ 的时间历程，测量模型为加性高斯模型：$y_{i}=A(t_{i})+\\varepsilon_{i}$，其中误差 $\\varepsilon_{i}$ 是独立同分布 (i.i.d.) 的，服从 $\\varepsilon_{i}\\sim \\mathcal{N}(0,\\sigma^{2})$，且方差 $\\sigma^{2}>0$ 已知。\n\n从质量作用定律和贝叶斯定理出发，推导出 $A(t)$ 的解，写出给定 $(k_{1},k_{2})$ 时 $y_{1:n}=(y_{1},\\dots,y_{n})$ 的似然函数，并确定仅从 $A$ 的测量值中，$(k_{1},k_{2})$ 的哪些组合是结构可辨识的。然后，构造一个光滑、一对一的重参数化 $(k_{1},k_{2})\\mapsto (\\kappa,\\phi)$，其中 $\\kappa>0$ 且 $\\phi\\in(0,1)$，使得似然函数仅依赖于 $\\kappa$，而当仅测量 $A$ 时，从数据中无法推知 $\\phi$。同时，提供逆映射 $(\\kappa,\\phi)\\mapsto (k_{1},k_{2})$ 以及适用于贝叶斯变量变换计算的该变量变换的雅可比行列式的绝对值。\n\n您最终报告的答案必须仅为用 $(k_{1},k_2)$ 的解析表达式表示的重参数化 $(\\kappa,\\phi)$，并写成单个行向量的形式。本题不包含任何单位，且无需进行数值舍入。", "solution": "该问题陈述具有科学性、适定性和客观性，是化学动力学和参数估计领域的一个标准练习。下面开始求解。\n\n首先，我们必须推导物种$A$的浓度随时间变化的解析解 $A(t)$。该体系包含两个平行、不可逆的一级基元反应：\n$$A \\xrightarrow{k_1} B$$\n$$A \\xrightarrow{k_2} C$$\n根据质量作用定律，$A$ 的消耗速率是两个反应速率之和。第一个反应的速率为 $r_1 = k_1 A(t)$，第二个反应的速率为 $r_2 = k_2 A(t)$。因此，控制 $A$ 浓度的微分方程为：\n$$\\frac{dA}{dt} = -r_1 - r_2 = -k_1 A(t) - k_2 A(t) = -(k_1 + k_2) A(t)$$\n这是一个一阶线性常微分方程，初始条件为 $A(0) = A_0$。我们可以用分离变量法求解：\n$$\\frac{dA}{A} = -(k_1 + k_2) dt$$\n将两边从时间 $t=0$ 积分到一般时间 $t$ 可得：\n$$\\int_{A_0}^{A(t)} \\frac{1}{A'} dA' = -\\int_{0}^{t} (k_1 + k_2) d\\tau$$\n$$\\ln(A(t)) - \\ln(A_0) = -(k_1 + k_2) t$$\n$$\\ln\\left(\\frac{A(t)}{A_0}\\right) = -(k_1 + k_2) t$$\n对两边取指数可得 $A(t)$ 的解：\n$$A(t) = A_0 \\exp(-(k_1 + k_2)t)$$\n\n接下来，我们构建观测数据 $y_{1:n} = (y_1, \\dots, y_n)$ 在给定参数 $k_1$ 和 $k_2$ 下的似然函数。测量模型为 $y_i = A(t_i) + \\varepsilon_i$，其中测量误差 $\\varepsilon_i$ 独立同分布，服从均值为 $0$、方差为 $\\sigma^2$ (已知) 的正态分布，即 $\\varepsilon_i \\sim \\mathcal{N}(0, \\sigma^2)$。这意味着每个观测值 $y_i$ 也服从正态分布，其均值为 $A(t_i)$，方差为 $\\sigma^2$，即 $y_i \\sim \\mathcal{N}(A(t_i), \\sigma^2)$。单个观测值 $y_i$ 的概率密度函数为：\n$$p(y_i | k_1, k_2, A_0, \\sigma^2) = \\frac{1}{\\sqrt{2\\pi\\sigma^2}} \\exp\\left(-\\frac{(y_i - A(t_i))^2}{2\\sigma^2}\\right)$$\n代入 $A(t_i)$ 的表达式：\n$$p(y_i | k_1, k_2) = \\frac{1}{\\sqrt{2\\pi\\sigma^2}} \\exp\\left(-\\frac{(y_i - A_0 \\exp(-(k_1 + k_2)t_i))^2}{2\\sigma^2}\\right)$$\n由于各次测量是独立的，整个数据集 $y_{1:n}$ 的似然函数是各单个概率密度的乘积：\n$$L(k_1, k_2 | y_{1:n}) = p(y_{1:n} | k_1, k_2) = \\prod_{i=1}^{n} p(y_i | k_1, k_2)$$\n$$L(k_1, k_2 | y_{1:n}) = \\left(\\frac{1}{2\\pi\\sigma^2}\\right)^{n/2} \\exp\\left(-\\frac{1}{2\\sigma^2} \\sum_{i=1}^{n} \\left(y_i - A_0 \\exp(-(k_1 + k_2)t_i)\\right)^2\\right)$$\n\n现在，我们必须确定哪些参数组合是结构可辨识的。结构可辨识性关系到参数是否可以从系统输出的无噪声观测中唯一确定。考察解 $A(t) = A_0 \\exp(-(k_1 + k_2)t)$ 和相应的似然函数，很明显，它们对速率常数 $k_1$ 和 $k_2$ 的依赖关系仅体现在它们的和 $k_1+k_2$ 上。任何两个满足 $k_1 + k_2 = k'_1 + k'_2$ 的不同速率常数对，例如 $(k_1, k_2)$ 和 $(k'_1, k'_2)$，都将产生完全相同的 $A(t)$ 时间历程，从而得到相同的似然值。因此，仅使用物种 $A$ 的测量值是不可能区分这些参数集的。单个参数 $k_1$ 和 $k_2$ 是结构不可辨识的。唯一可辨识的参数组合是有效速率常数，即其和 $\\kappa = k_1 + k_2$。\n\n任务是找到一个重参数化 $(k_1, k_2) \\mapsto (\\kappa, \\phi)$，它能将可辨识部分 ($\\kappa$) 与不可辨识部分 ($\\phi$) 分离开来。\n我们将可辨识参数 $\\kappa$ 定义为速率常数之和：\n$$\\kappa = k_1 + k_2$$\n由于 $k_1>0$ 和 $k_2>0$，因此 $\\kappa>0$。\n不可辨识的参数 $\\phi$ 应捕捉总反应通量在两条路径之间的分布。一个自然的选择是第一个反应对应的速率占总速率的比例：\n$$\\phi = \\frac{k_1}{k_1 + k_2} = \\frac{k_1}{\\kappa}$$\n由于 $k_1 > 0$ 和 $k_2 > 0$，我们有 $0 < k_1 < k_1 + k_2$，这意味着 $0 < \\phi < 1$。因此，重参数化由以下映射给出：\n$$(k_1, k_2) \\mapsto \\left(\\kappa(k_1, k_2), \\phi(k_1, k_2)\\right) = \\left(k_1 + k_2, \\frac{k_1}{k_1 + k_2}\\right)$$\n对于 $k_1, k_2 > 0$，此映射是光滑且一对一的。用这些新参数表示，似然函数变为：\n$$L(\\kappa | y_{1:n}) = \\left(\\frac{1}{2\\pi\\sigma^2}\\right)^{n/2} \\exp\\left(-\\frac{1}{2\\sigma^2} \\sum_{i=1}^{n} \\left(y_i - A_0 \\exp(-\\kappa t_i)\\right)^2\\right)$$\n正如所要求的那样，似然函数仅依赖于 $\\kappa$，而从 $A(t)$ 的数据中无法推知 $\\phi$。\n\n逆映射 $(\\kappa, \\phi) \\mapsto (k_1, k_2)$ 可通过求解 $k_1$ 和 $k_2$ 得到：\n从 $\\phi = k_1/\\kappa$ 可得 $k_1 = \\kappa\\phi$。\n将其代入 $\\kappa = k_1 + k_2$ 得到 $\\kappa = \\kappa\\phi + k_2$，从而得出 $k_2 = \\kappa - \\kappa\\phi = \\kappa(1-\\phi)$。\n因此，逆映射为：\n$$(k_1, k_2) = (\\kappa\\phi, \\kappa(1-\\phi))$$\n\n最后，对于贝叶斯变量变换，我们需要从新参数 $(\\kappa, \\phi)$到旧参数 $(k_1, k_2)$ 的变换的雅可比行列式。映射 $(\\kappa, \\phi) \\mapsto (k_1, k_2)$ 的雅可比矩阵 $J$ 为：\n$$J = \\begin{pmatrix} \\frac{\\partial k_1}{\\partial \\kappa} & \\frac{\\partial k_1}{\\partial \\phi} \\\\ \\frac{\\partial k_2}{\\partial \\kappa} & \\frac{\\partial k_2}{\\partial \\phi} \\end{pmatrix} = \\begin{pmatrix} \\phi & \\kappa \\\\ 1 - \\phi & -\\kappa \\end{pmatrix}$$\n该矩阵的行列式为：\n$$\\det(J) = (\\phi)(-\\kappa) - (\\kappa)(1-\\phi) = -\\kappa\\phi - \\kappa + \\kappa\\phi = -\\kappa$$\n雅可比行列式的绝对值为 $|\\det(J)| = |-\\kappa| = \\kappa$，因为 $\\kappa > 0$。\n\n问题要求将重参数化 $(\\kappa, \\phi)$ 表示为关于 $(k_1, k_2)$ 的解析表达式。这些就是上面推导出的表达式。", "answer": "$$\\boxed{\\begin{pmatrix} k_1 + k_2 & \\frac{k_1}{k_1 + k_2} \\end{pmatrix}}$$", "id": "2627935"}, {"introduction": "似然函数是连接动力学模型预测与实验观测数据的桥梁，是贝叶斯推断的核心。为了高效地在参数空间中寻找后验分布的最优解（最大后验估计）或进行采样（如使用哈密顿蒙特卡洛），计算似然函数的对数及其梯度至关重要。这个练习 [@problem_id:2628012] 要求你从基本原理出发，为基于常微分方程的通用反应网络模型推导对数似然函数及其梯度表达式，这是进行任何基于梯度的推断算法的第一步。", "problem": "一个包含 $d$ 个化学物种的确定性、充分混合的化学反应网络由反应速率常微分方程 (ODE) $\\mathrm{d}x/\\mathrm{d}t = f(x,\\theta)$ 及其初始条件 $x(0;\\theta) = x_{0}$ 建模，其中 $x(t;\\theta) \\in \\mathbb{R}^{d}$ 是在时间 $t$ 时的浓度向量，$\\theta \\in \\mathbb{R}^{p}$ 是一个未知动力学参数的向量（例如，质量作用动力学下的速率常数）。设 $t_{1},\\dots,t_{n}$ 为不同的观测时间。在每个时间 $t_{i}$，只测量物种的一个子集：观测算子 $h \\in \\mathbb{R}^{m \\times d}$ 是一个固定的选择矩阵，其行是标准基向量，用于选择 $x(t;\\theta)$ 的 $m \\leq d$ 个分量。测量模型是\n$$\ny_{i} \\;=\\; h\\,x(t_{i};\\theta) \\;+\\; \\varepsilon_{i}, \\quad i=1,\\dots,n,\n$$\n其中误差 $\\varepsilon_{i} \\in \\mathbb{R}^{m}$ 是独立同分布的，服从 $\\varepsilon_{i} \\sim \\mathcal{N}(0, \\sigma^{2} I_{m})$，且方差 $\\sigma^{2} > 0$ 是已知的。\n\n给定数据 $\\{y_{i}\\}_{i=1}^{n}$ 和上述模型，从第一性原理出发，推导对数似然 $\\ell(\\theta) = \\ln p(\\{y_{i}\\}_{i=1}^{n} \\mid \\theta, \\sigma^{2})$ 及其关于 $\\theta$ 的梯度的闭式表达式。将梯度用残差 $r_{i}(\\theta) = y_{i} - h\\,x(t_{i};\\theta)$ 和状态灵敏度 $G_{i}(\\theta) = \\partial x(t_{i};\\theta)/\\partial \\theta \\in \\mathbb{R}^{d \\times p}$ 来表示。不要舍弃不依赖于 $\\theta$ 的加性常数。你的最终答案必须是包含对数似然及其梯度的数对，写成显式的解析表达式。不需要数值计算，也不需要单位。", "solution": "问题陈述已经过验证，被认为是合理的。它提出了一个常微分方程模型参数估计中的标准、适定问题，这是化学动力学和系统生物学中的一个常见任务。我们开始进行推导。\n\n问题要求从第一性原理出发，推导对数似然函数 $\\ell(\\theta)$ 及其梯度 $\\nabla_{\\theta}\\ell(\\theta)$。\n\n首先，我们推导对数似然函数 $\\ell(\\theta) = \\ln p(\\{y_{i}\\}_{i=1}^{n} \\mid \\theta, \\sigma^{2})$。\n在时间 $t_i$ 的单个观测 $y_i$ 的测量模型由 $y_{i} = h\\,x(t_{i};\\theta) + \\varepsilon_{i}$ 给出。测量误差 $\\varepsilon_{i}$ 是一个服从多元正态分布的随机变量，$\\varepsilon_{i} \\sim \\mathcal{N}(0, \\sigma^{2} I_{m})$，其中 $I_m$ 是 $m \\times m$ 的单位矩阵。\n这意味着在给定参数向量 $\\theta$ 的条件下，观测值 $y_i$ 的条件分布也是一个多元正态分布。该分布的均值是确定性模型的预测 $\\mu_i(\\theta) = h\\,x(t_{i};\\theta)$，协方差矩阵是 $\\Sigma = \\sigma^{2} I_{m}$。\n所以，$y_{i} \\mid \\theta, \\sigma^2 \\sim \\mathcal{N}(h\\,x(t_{i};\\theta), \\sigma^{2} I_{m})$。\n\n对于单个观测向量 $y_i \\in \\mathbb{R}^m$，其概率密度函数 (PDF) 由多元正态 PDF 的一般形式给出：\n$$p(y_i \\mid \\theta, \\sigma^2) = \\frac{1}{(2\\pi)^{m/2} |\\sigma^2 I_m|^{1/2}} \\exp\\left(-\\frac{1}{2} (y_i - h x(t_i;\\theta))^T (\\sigma^2 I_m)^{-1} (y_i - h x(t_i;\\theta))\\right)$$\n协方差矩阵的行列式是 $|\\sigma^2 I_m| = (\\sigma^2)^m = \\sigma^{2m}$。协方差矩阵的逆是 $(\\sigma^2 I_m)^{-1} = \\frac{1}{\\sigma^2}I_m$。\n将这些代入 PDF 表达式可得：\n$$p(y_i \\mid \\theta, \\sigma^2) = \\frac{1}{(2\\pi\\sigma^2)^{m/2}} \\exp\\left(-\\frac{1}{2\\sigma^2} (y_i - h x(t_i;\\theta))^T (y_i - h x(t_i;\\theta))\\right)$$\n指数中的二次型是残差向量的欧几里得范数的平方，$\\|y_i - h x(t_i;\\theta)\\|_2^2$。\n因此，单个数据点的 PDF 为：\n$$p(y_i \\mid \\theta, \\sigma^2) = \\frac{1}{(2\\pi\\sigma^2)^{m/2}} \\exp\\left(-\\frac{1}{2\\sigma^2} \\|y_i - h x(t_i;\\theta)\\|_2^2\\right)$$\n问题陈述中指出误差 $\\varepsilon_i$ 是独立同分布的。这意味着观测值 $\\{y_i\\}_{i=1}^n$ 在给定 $\\theta$ 的条件下是条件独立的。因此，整个数据集的联合似然是各个似然的乘积：\n$$L(\\theta) = p(\\{y_{i}\\}_{i=1}^{n} \\mid \\theta, \\sigma^{2}) = \\prod_{i=1}^{n} p(y_{i} \\mid \\theta, \\sigma^{2})$$\n$$L(\\theta) = \\prod_{i=1}^{n} \\left[ \\frac{1}{(2\\pi\\sigma^2)^{m/2}} \\exp\\left(-\\frac{1}{2\\sigma^2} \\|y_i - h x(t_i;\\theta)\\|_2^2\\right) \\right]$$\n$$L(\\theta) = \\left( \\frac{1}{(2\\pi\\sigma^2)^{m/2}} \\right)^n \\exp\\left( \\sum_{i=1}^{n} -\\frac{1}{2\\sigma^2} \\|y_i - h x(t_i;\\theta)\\|_2^2 \\right)$$\n$$L(\\theta) = \\frac{1}{(2\\pi\\sigma^2)^{nm/2}} \\exp\\left(-\\frac{1}{2\\sigma^2} \\sum_{i=1}^{n} \\|y_i - h x(t_i;\\theta)\\|_2^2\\right)$$\n对数似然 $\\ell(\\theta)$ 是似然函数 $L(\\theta)$ 的自然对数。取对数：\n$$\\ell(\\theta) = \\ln(L(\\theta)) = \\ln\\left( \\frac{1}{(2\\pi\\sigma^2)^{nm/2}} \\right) + \\ln\\left(\\exp\\left(-\\frac{1}{2\\sigma^2} \\sum_{i=1}^{n} \\|y_i - h x(t_i;\\theta)\\|_2^2\\right)\\right)$$\n$$\\ell(\\theta) = -\\frac{nm}{2}\\ln(2\\pi\\sigma^2) - \\frac{1}{2\\sigma^2} \\sum_{i=1}^{n} \\|y_i - h x(t_i;\\theta)\\|_2^2$$\n这就是对数似然的闭式表达式。由于 $\\sigma^2$ 是已知的，第一项是关于 $\\theta$ 的常数，但根据问题要求予以保留。\n\n接下来，我们推导对数似然关于 $\\theta$ 的梯度，记为 $\\nabla_{\\theta}\\ell(\\theta)$。\n我们将 $\\ell(\\theta)$ 的表达式对参数向量 $\\theta \\in \\mathbb{R}^p$ 求导。\n$$\\nabla_{\\theta}\\ell(\\theta) = \\frac{\\partial}{\\partial\\theta} \\left( -\\frac{nm}{2}\\ln(2\\pi\\sigma^2) - \\frac{1}{2\\sigma^2} \\sum_{i=1}^{n} \\|y_i - h x(t_i;\\theta)\\|_2^2 \\right)$$\n第一项相对于 $\\theta$ 是常数，因此其梯度为零向量。\n$$\\nabla_{\\theta}\\ell(\\theta) = - \\frac{1}{2\\sigma^2} \\frac{\\partial}{\\partial\\theta} \\left( \\sum_{i=1}^{n} \\|y_i - h x(t_i;\\theta)\\|_2^2 \\right)$$\n梯度算子可以移到求和符号内部：\n$$\\nabla_{\\theta}\\ell(\\theta) = - \\frac{1}{2\\sigma^2} \\sum_{i=1}^{n} \\frac{\\partial}{\\partial\\theta} \\|y_i - h x(t_i;\\theta)\\|_2^2$$\n我们使用残差向量的表示法 $r_i(\\theta) = y_i - h x(t_i;\\theta)$。要微分的项是 $\\|r_i(\\theta)\\|_2^2 = r_i(\\theta)^T r_i(\\theta)$。\n使用向量微积分的链式法则，范数平方的梯度为 $\\frac{\\partial}{\\partial\\theta} (u^T u) = 2 \\left(\\frac{\\partial u}{\\partial\\theta}\\right)^T u$，其中 $\\frac{\\partial u}{\\partial\\theta}$ 是向量 $u$ 关于向量 $\\theta$ 的雅可比矩阵。\n让我们应用这个法则：\n$$\\frac{\\partial}{\\partial\\theta} \\|r_i(\\theta)\\|_2^2 = 2 \\left(\\frac{\\partial r_i(\\theta)}{\\partial\\theta}\\right)^T r_i(\\theta)$$\n现在我们必须求出残差的雅可比矩阵，$\\frac{\\partial r_i(\\theta)}{\\partial\\theta}$。\n$$\\frac{\\partial r_i(\\theta)}{\\partial\\theta} = \\frac{\\partial}{\\partial\\theta} (y_i - h x(t_i;\\theta)) = - \\frac{\\partial}{\\partial\\theta} (h x(t_i;\\theta)) = -h \\frac{\\partial x(t_i;\\theta)}{\\partial\\theta}$$\n问题给出了状态灵敏度矩阵的定义：$G_i(\\theta) = \\frac{\\partial x(t_i;\\theta)}{\\partial\\theta}$。这是一个 $d \\times p$ 矩阵。\n将此代入残差的雅可比矩阵可得：\n$$\\frac{\\partial r_i(\\theta)}{\\partial\\theta} = -h G_i(\\theta)$$\n这是一个 $m \\times p$ 矩阵。现在将此结果代回范数平方的梯度表达式中：\n$$\\frac{\\partial}{\\partial\\theta} \\|r_i(\\theta)\\|_2^2 = 2 (-h G_i(\\theta))^T r_i(\\theta) = -2 (G_i(\\theta)^T h^T) r_i(\\theta)$$\n这是一个 $p \\times 1$ 的列向量，这对于梯度来说是正确的维度。\n最后，我们将此结果代回到 $\\nabla_{\\theta}\\ell(\\theta)$ 的表达式中：\n$$\\nabla_{\\theta}\\ell(\\theta) = - \\frac{1}{2\\sigma^2} \\sum_{i=1}^{n} \\left( -2 G_i(\\theta)^T h^T r_i(\\theta) \\right)$$\n$$\\nabla_{\\theta}\\ell(\\theta) = \\frac{1}{\\sigma^2} \\sum_{i=1}^{n} G_i(\\theta)^T h^T r_i(\\theta)$$\n这就是对数似然梯度的最终表达式，按要求用残差 $r_i(\\theta)$ 和灵敏度 $G_i(\\theta)$ 表示。\n\n这对结果，即对数似然及其梯度，是：\n对数似然：$\\ell(\\theta) = -\\frac{nm}{2}\\ln(2\\pi\\sigma^2) - \\frac{1}{2\\sigma^2} \\sum_{i=1}^{n} \\|r_i(\\theta)\\|_2^2$\n梯度：$\\nabla_{\\theta}\\ell(\\theta) = \\frac{1}{\\sigma^2} \\sum_{i=1}^{n} G_i(\\theta)^T h^T r_i(\\theta)$\n其中 $r_{i}(\\theta) = y_{i} - h\\,x(t_{i};\\theta)$。", "answer": "$$\n\\boxed{\n\\pmatrix{\n-\\frac{nm}{2}\\ln(2\\pi\\sigma^2) - \\frac{1}{2\\sigma^2}\\sum_{i=1}^{n} \\|y_i - h x(t_i;\\theta)\\|_2^2 & \\frac{1}{\\sigma^2}\\sum_{i=1}^{n} G_i(\\theta)^T h^T (y_i - h x(t_i;\\theta))\n}\n}\n$$", "id": "2628012"}, {"introduction": "本练习将前面所学的概念融会贯通，带你走完一个完整的贝叶斯推断流程。通过分析一个简单的一级反应，你将学习如何为速率常数 $k$ 和噪声方差 $\\sigma^2$ 选择共轭先验分布，这是一个强大的技术，可以在某些情况下得到解析形式的后验分布。你的任务 [@problem_id:2627944] 是推导速率常数的边际后验分布，并利用它来计算一个可信区间，从而对参数进行定量的不确定性评估。", "problem": "一个单步不可逆一级反应 $A \\to B$ 在一个充分混合的等温间歇式反应器中进行，速率常数为 $k$。$A$ 的浓度满足质量作用定律 $[A](t) = [A]_0 \\exp(-k t)$。一台仪器报告 $A$ 浓度的自然对数，并带有加性高斯噪声：对于采样时间 $t_i$ 和真实浓度 $[A](t_i)$，测量模型为\n$$\ny_i \\;=\\; \\ln [A](t_i) \\;+\\; \\varepsilon_i, \\qquad \\varepsilon_i \\stackrel{\\text{i.i.d.}}{\\sim} \\mathcal{N}(0,\\sigma^2).\n$$\n假设 $[A]_0$ 已知且等于 $[A]_0 = 1.0$，因此 $\\ln [A]_0 = 0$。定义转换后的响应 $r_i = \\ln [A]_0 - y_i$，从而回归模型为\n$$\nr_i \\;=\\; k\\, t_i \\;+\\; \\eta_i, \\qquad \\eta_i \\stackrel{\\text{i.i.d.}}{\\sim} \\mathcal{N}(0,\\sigma^2),\n$$\n这是一个无截距、斜率为 $k$ 的高斯线性模型。给定在时间 $t = (t_1,\\dots,t_5) = (1,2,3,4,5)$ 秒（$\\mathrm{s}$）下的 $n=5$ 次测量，观测到的对数浓度为\n$$\ny = (y_1,\\dots,y_5) = \\big(-0.29,\\,-0.62,\\,-0.87,\\,-1.21,\\,-1.50\\big).\n$$\n采用共轭正态-逆伽马 (N-IG) 先验：在 $\\sigma^2$ 的条件下，$k$ 的先验是高斯分布，\n$$\nk \\mid \\sigma^2 \\;\\sim\\; \\mathcal{N}\\!\\Big(m_0,\\; \\frac{\\sigma^2}{\\kappa_0}\\Big),\n$$\n其超参数为 $m_0 = 0.2$ 和 $\\kappa_0 = 1$，而噪声方差的先验是逆伽马 (IG) 分布，\n$$\n\\sigma^2 \\;\\sim\\; \\mathrm{Inverse\\text{-}Gamma}(\\alpha_0,\\beta_0),\n$$\n其形状参数 $\\alpha_0 = 2$ 和尺度参数 $\\beta_0 = 0.01$，由密度函数 $p(\\sigma^2) \\propto (\\sigma^2)^{-(\\alpha_0+1)} \\exp(-\\beta_0/\\sigma^2)$（对于 $\\sigma^2>0$）参数化。\n\n任务：\n- 从高斯似然和 N-IG 先验出发，通过解析地对 $\\sigma^2$ 积分，推导出边缘后验密度 $p(k \\mid y)$。将你的结果以闭式形式表示（可忽略已知的归一化常数），并根据 $\\{(t_i,r_i)\\}_{i=1}^n$ 的充分统计量和超参数 $(m_0,\\kappa_0,\\alpha_0,\\beta_0)$，确定 $p(k \\mid y)$ 的分布形式及其参数。\n- 使用推导出的边缘后验，计算 $k$ 的 $0.95$ 等尾可信区间。将区间端点以 $\\mathrm{s}^{-1}$ 为单位表示，并将你的两个数值答案四舍五入至三位有效数字。", "solution": "对问题陈述进行验证。\n\n**步骤1：提取已知条件**\n-   反应模型：$A \\to B$，一级，不可逆，速率常数为 $k$。\n-   浓度动态：$[A](t) = [A]_0 \\exp(-k t)$。\n-   初始条件：$[A]_0 = 1.0$，因此 $\\ln [A]_0 = 0$。\n-   测量模型：$y_i = \\ln [A](t_i) + \\varepsilon_i$，其中 $\\varepsilon_i \\stackrel{\\text{i.i.d.}}{\\sim} \\mathcal{N}(0,\\sigma^2)$。\n-   转换响应：$r_i = \\ln [A]_0 - y_i$。\n-   回归模型：$r_i = k t_i + \\eta_i$，其中 $\\eta_i \\stackrel{\\text{i.i.d.}}{\\sim} \\mathcal{N}(0,\\sigma^2)$。\n-   数据：$n=5$ 次测量。\n-   时间：$t = (1, 2, 3, 4, 5)$。\n-   观测的对数浓度：$y = (-0.29, -0.62, -0.87, -1.21, -1.50)$。\n-   $k$ 的先验：$k \\mid \\sigma^2 \\sim \\mathcal{N}(m_0, \\sigma^2/\\kappa_0)$，其中 $m_0 = 0.2$ 且 $\\kappa_0 = 1$。\n-   $\\sigma^2$ 的先验：$\\sigma^2 \\sim \\mathrm{Inverse-Gamma}(\\alpha_0, \\beta_0)$，其中 $\\alpha_0 = 2$ 且 $\\beta_0 = 0.01$。\n\n**步骤2：使用提取的已知条件进行验证**\n-   **科学基础**：该问题是贝叶斯推断在化学动力学基本模型中的一个标准应用。一级反应的质量作用定律和高斯噪声模型是标准假设。在贝叶斯线性回归中，使用共轭正态-逆伽马先验是一种成熟的技术。该问题在科学上是合理的。\n-   **良态性**：该问题是良态的。它提供了所有必要的数据、一个完整的生成模型和正常的先验分布，确保存在一个唯一且有意义的后验分布。\n-   **客观性**：该问题的陈述具有精确的数学和统计定义，没有歧义或主观内容。\n-   **一致性检查**：回归模型 $r_i = k t_i + \\eta_i$ 的推导是一致的。从模型可知，$y_i = \\ln([A]_0 \\exp(-kt_i)) + \\varepsilon_i = \\ln[A]_0 - kt_i + \\varepsilon_i$。重新整理得到 $\\ln[A]_0 - y_i = kt_i - \\varepsilon_i$。设 $r_i = \\ln[A]_0 - y_i$ 并定义 $\\eta_i = -\\varepsilon_i$，又因为 $\\varepsilon_i \\sim \\mathcal{N}(0, \\sigma^2)$ 意味着 $\\eta_i \\sim \\mathcal{N}(0, \\sigma^2)$，所以该回归模型是正确构建的。\n\n**步骤3：结论与行动**\n该问题有效。现提供完整解法。\n\n**$k$ 的边缘后验推导**\n\n贝叶斯框架要求将数据的似然与参数的先验分布相结合，以获得后验分布。后验由贝叶斯定理给出：\n$$\np(k, \\sigma^2 \\mid r) \\propto p(r \\mid k, \\sigma^2) \\, p(k, \\sigma^2)\n$$\n其中 $r$ 表示观测响应向量 $(r_1, \\dots, r_n)$。\n\n似然函数 $p(r \\mid k, \\sigma^2)$ 从高斯噪声模型推导得出：\n$$\np(r \\mid k, \\sigma^2) = \\prod_{i=1}^n \\frac{1}{\\sqrt{2\\pi\\sigma^2}} \\exp\\left(-\\frac{(r_i - k t_i)^2}{2\\sigma^2}\\right) \\propto (\\sigma^2)^{-n/2} \\exp\\left(-\\frac{1}{2\\sigma^2} \\sum_{i=1}^n (r_i - k t_i)^2\\right)\n$$\n联合先验分布 $p(k, \\sigma^2)$ 被指定为正态-逆伽马分布，$p(k, \\sigma^2) = p(k \\mid \\sigma^2)p(\\sigma^2)$：\n$$\np(k \\mid \\sigma^2) \\propto (\\sigma^2)^{-1/2} \\exp\\left(-\\frac{\\kappa_0(k - m_0)^2}{2\\sigma^2}\\right)\n$$\n$$\np(\\sigma^2) \\propto (\\sigma^2)^{-(\\alpha_0+1)} \\exp\\left(-\\frac{\\beta_0}{\\sigma^2}\\right)\n$$\n将它们结合起来得到联合先验：\n$$\np(k, \\sigma^2) \\propto (\\sigma^2)^{-(\\alpha_0 + 1/2 + 1)} \\exp\\left(-\\frac{1}{2\\sigma^2} [2\\beta_0 + \\kappa_0(k - m_0)^2]\\right)\n$$\n联合后验分布与似然和先验的乘积成正比：\n$$\np(k, \\sigma^2 \\mid r) \\propto (\\sigma^2)^{-n/2} \\exp\\left(-\\frac{1}{2\\sigma^2} \\sum_{i=1}^n (r_i - k t_i)^2\\right) \\times (\\sigma^2)^{-(\\alpha_0 + 1/2 + 1)} \\exp\\left(-\\frac{1}{2\\sigma^2} [2\\beta_0 + \\kappa_0(k - m_0)^2]\\right)\n$$\n合并各项，我们得到：\n$$\np(k, \\sigma^2 \\mid r) \\propto (\\sigma^2)^{-(\\alpha_0 + n/2 + 1/2 + 1)} \\exp\\left(-\\frac{1}{2\\sigma^2} \\left[ \\sum(r_i - k t_i)^2 + \\kappa_0(k - m_0)^2 + 2\\beta_0 \\right]\\right)\n$$\n为了求出 $k$ 的边缘后验，我们对 $\\sigma^2$ 进行积分：\n$$\np(k \\mid r) = \\int_0^\\infty p(k, \\sigma^2 \\mid r) \\, d\\sigma^2\n$$\n令指数项为 $Q(k) = \\sum(r_i - k t_i)^2 + \\kappa_0(k - m_0)^2 + 2\\beta_0$。该积分具有以下形式：\n$$\np(k \\mid r) \\propto \\int_0^\\infty (\\sigma^2)^{-(\\alpha_0 + n/2 + 1/2 + 1)} \\exp\\left(-\\frac{Q(k)}{2\\sigma^2}\\right) d\\sigma^2\n$$\n这是 $\\sigma^2$ 的逆伽马分布的核。积分的计算结果为：\n$$\n\\int_0^\\infty (x)^{-(a+1)}\\exp(-b/x)dx \\propto b^{-a}\n$$\n在这里，$x = \\sigma^2$，$a = \\alpha_0 + n/2 + 1/2$，$b = Q(k)/2$。因此，\n$$\np(k \\mid r) \\propto \\left(\\frac{Q(k)}{2}\\right)^{-(\\alpha_0 + n/2 + 1/2)} \\propto [Q(k)]^{-(\\alpha_n + 1/2)}\n$$\n其中 $\\alpha_n = \\alpha_0 + n/2$。现在我们分析 $Q(k)$ 的结构。我们展开 $k$ 的二次项：\n$$\nQ(k) = \\left(\\sum t_i^2\\right)k^2 - 2\\left(\\sum r_i t_i\\right)k + \\sum r_i^2 + \\kappa_0(k^2 - 2m_0 k + m_0^2) + 2\\beta_0\n$$\n$$\nQ(k) = (\\kappa_0 + \\sum t_i^2)k^2 - 2(\\kappa_0 m_0 + \\sum r_i t_i)k + (\\sum r_i^2 + \\kappa_0 m_0^2 + 2\\beta_0)\n$$\n我们为联合 N-IG 后验定义后验超参数：\n$$\n\\kappa_n = \\kappa_0 + \\sum t_i^2\n$$\n$$\nm_n = \\frac{\\kappa_0 m_0 + \\sum r_i t_i}{\\kappa_n}\n$$\n对 $Q(k)$ 中的 $k$ 进行配方：\n$$\nQ(k) = \\kappa_n(k - m_n)^2 - \\kappa_n m_n^2 + (\\sum r_i^2 + \\kappa_0 m_0^2 + 2\\beta_0)\n$$\n让我们定义 $\\sigma^2$ 的后验尺度参数 $\\beta_n$：\n$$\n\\beta_n = \\beta_0 + \\frac{1}{2}\\left(\\sum r_i^2 + \\kappa_0 m_0^2 - \\kappa_n m_n^2\\right)\n$$\n那么 $Q(k)$ 可以写成：\n$$\nQ(k) = \\kappa_n(k - m_n)^2 + 2\\beta_n\n$$\n将此代回 $p(k \\mid r)$ 的表达式中：\n$$\np(k \\mid r) \\propto \\left[2\\beta_n + \\kappa_n(k - m_n)^2\\right]^{-(\\alpha_n + 1/2)} \\propto \\left[1 + \\frac{\\kappa_n(k - m_n)^2}{2\\beta_n}\\right]^{-(\\alpha_n + 1/2)}\n$$\n这是非标准化学生t分布的核。一个变量 $X \\sim t_{\\nu}(\\mu, s^2)$ 的概率密度函数（PDF）正比于 $(1 + \\frac{1}{\\nu}(\\frac{x-\\mu}{s})^2)^{-(\\nu+1)/2}$。\n匹配形式，我们确定自由度 $\\nu_n$、位置 $\\mu_n$ 和尺度 $s_n$：\n$\\frac{\\nu_n+1}{2} = \\alpha_n + \\frac{1}{2} \\implies \\nu_n = 2\\alpha_n$。\n$\\mu_n = m_n$。\n$\\frac{1}{\\nu_n s_n^2} = \\frac{\\kappa_n}{2\\beta_n} \\implies s_n^2 = \\frac{2\\beta_n}{\\nu_n \\kappa_n} = \\frac{2\\beta_n}{(2\\alpha_n)\\kappa_n} = \\frac{\\beta_n}{\\alpha_n \\kappa_n}$。\n因此，$k$ 的边缘后验分布是一个具有以下参数的学生t分布：\n-   自由度：$\\nu_n = 2\\alpha_n = 2\\alpha_0 + n$。\n-   位置：$\\mu_n = m_n = \\frac{\\kappa_0 m_0 + \\sum r_i t_i}{\\kappa_0 + \\sum t_i^2}$。\n-   尺度平方：$s_n^2 = \\frac{\\beta_n}{\\alpha_n \\kappa_n}$，其中 $\\beta_n = \\beta_0 + \\frac{1}{2}\\left(\\sum r_i^2 + \\kappa_0 m_0^2 - \\kappa_n m_n^2\\right)$。\n\n**可信区间的计算**\n\n首先，从数据中计算充分统计量。\n$n=5$，$t = (1, 2, 3, 4, 5)$，$y = (-0.29, -0.62, -0.87, -1.21, -1.50)$。\n当 $\\ln[A]_0 = 0$ 时，$r_i = -y_i$，所以 $r = (0.29, 0.62, 0.87, 1.21, 1.50)$。\n$\\sum t_i^2 = 1^2 + 2^2 + 3^2 + 4^2 + 5^2 = 1 + 4 + 9 + 16 + 25 = 55$。\n$\\sum r_i t_i = (0.29)(1) + (0.62)(2) + (0.87)(3) + (1.21)(4) + (1.50)(5) = 0.29 + 1.24 + 2.61 + 4.84 + 7.50 = 16.48$。\n$\\sum r_i^2 = 0.29^2 + 0.62^2 + 0.87^2 + 1.21^2 + 1.50^2 = 0.0841 + 0.3844 + 0.7569 + 1.4641 + 2.25 = 4.9395$。\n\n接下来，使用先验 $m_0=0.2, \\kappa_0=1, \\alpha_0=2, \\beta_0=0.01$ 计算后验超参数。\n$\\kappa_n = \\kappa_0 + \\sum t_i^2 = 1 + 55 = 56$。\n$m_n = \\frac{\\kappa_0 m_0 + \\sum r_i t_i}{\\kappa_n} = \\frac{1 \\times 0.2 + 16.48}{56} = \\frac{16.68}{56} \\approx 0.297857$。\n$\\alpha_n = \\alpha_0 + n/2 = 2 + 5/2 = 4.5$。\n$\\beta_n = \\beta_0 + \\frac{1}{2}\\left(\\sum r_i^2 + \\kappa_0 m_0^2 - \\kappa_n m_n^2\\right) = 0.01 + \\frac{1}{2}\\left(4.9395 + 1 \\times (0.2)^2 - 56 \\times (\\frac{16.68}{56})^2\\right)$\n$\\beta_n = 0.01 + \\frac{1}{2}\\left(4.9395 + 0.04 - \\frac{16.68^2}{56}\\right) = 0.01 + \\frac{1}{2}(4.9795 - 4.968257...) = 0.01 + 0.005621... = 0.0156214...$。\n\n现在，计算 k 的 t 分布的参数。\n自由度：$\\nu_n = 2\\alpha_n = 2 \\times 4.5 = 9$。\n位置：$\\mu_n = m_n = \\frac{16.68}{56} \\approx 0.297857$。\n尺度平方：$s_n^2 = \\frac{\\beta_n}{\\alpha_n \\kappa_n} = \\frac{0.0156214...}{4.5 \\times 56} = \\frac{0.0156214...}{252} \\approx 6.1989... \\times 10^{-5}$。\n尺度：$s_n = \\sqrt{s_n^2} \\approx 0.007873$。\n\n$k$ 的一个 $0.95$ 等尾可信区间由 $\\mu_n \\pm t_{0.975, \\nu_n} s_n$ 给出。\n具有 $\\nu_n=9$ 自由度的 t 分布的临界值为 $t_{0.975, 9} \\approx 2.262157$。\n区间的半宽为 $w = t_{0.975, 9} s_n \\approx 2.262157 \\times 0.007873 \\approx 0.017809$。\n区间为 $[\\mu_n - w, \\mu_n + w]$。\n下界：$L = 0.297857 - 0.017809 = 0.280048$。\n上界：$U = 0.297857 + 0.017809 = 0.315666$。\n\n四舍五入到三位有效数字，端点为 $0.280$ $\\mathrm{s}^{-1}$ 和 $0.316$ $\\mathrm{s}^{-1}$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.280 & 0.316\n\\end{pmatrix}\n}\n$$", "id": "2627944"}]}