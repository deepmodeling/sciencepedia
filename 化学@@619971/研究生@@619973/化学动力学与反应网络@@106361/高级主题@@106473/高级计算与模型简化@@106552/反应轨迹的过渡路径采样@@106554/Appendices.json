{"hands_on_practices": [{"introduction": "在模拟包含惯性效应的系统时（例如在欠阻尼朗之万动力学下），一个核心挑战是如何精确定义反应物和产物盆。这个定义直接影响我们如何识别真正的反应轨迹，并避免将快速的折返事件误判为反应。本练习探讨了在相空间（位置和动量）中定义物态的重要性，并阐明了这对路径采样模拟的准确性和效率有何影响。", "problem": "考虑一个质量为 $m$ 的单粒子在温度 $T$ 下，于 $d$ 维空间中一个光滑双稳势 $U(x)$ 内运动的欠阻尼朗之万动力学。其运动方程为\n$$\n\\dot{x} = \\frac{p}{m},\\quad \\dot{p} = -\\nabla U(x) - \\gamma\\,\\frac{p}{m} + \\sqrt{2\\,\\gamma\\,k_{\\mathrm{B}}T}\\,\\eta(t),\n$$\n其中 $x \\in \\mathbb{R}^d$，$p \\in \\mathbb{R}^d$，$\\gamma>0$ 是摩擦系数，$k_{\\mathrm{B}}$ 是玻尔兹曼常数，$\\eta(t)$ 是分量独立的标准白噪声。其稳态分布是相空间上的玻尔兹曼分布，其密度正比于 $\\exp\\{-\\beta[U(x)+\\|p\\|^2/(2m)]\\}$，其中 $\\beta=(k_{\\mathrm{B}}T)^{-1}$。您希望执行跃迁路径采样（Transition Path Sampling, TPS）来采样与两个势阱相关的两个亚稳盆之间的反应轨迹。\n\n定义这些盆有两种可能的方法：\n- 位形空间盆：$A_x=\\{x:\\|x-x_A\\|<\\varepsilon\\}$ 和 $B_x=\\{x:\\|x-x_B\\|<\\varepsilon\\}$，对于小的 $\\varepsilon>0$，完全忽略动量。\n- 相空间盆：子集 $A,B \\subset \\mathbb{R}^{2d}$，它们是相空间中两个亚稳态的不相交邻域，例如可以用投入子函数 $q$ 定义为 $A=\\{(x,p):q(x,p)\\le \\delta\\}$ 和 $B=\\{(x,p):q(x,p)\\ge 1-\\delta\\}$，其中 $\\delta \\in (0,1/2)$ 是一个小数，$q(x,p)$ 是从 $(x,p)$ 出发，在到达 $A$ 之前先到达 $B$ 的概率。\n\n假设该动力学相对于稳态测度是可逆的，并令时间反演对合为 $\\theta(x,p)=(x,-p)$。特别地，您可以假设细致平衡性质成立，并且当盆在相空间中定义时，$B=\\theta A$。\n\n关于将动量包含在盆的定义中如何影响反应轨迹的识别和采样，以下哪个/哪些陈述是正确的？\n\nA. 对于欠阻尼朗之万动力学，该过程在相空间 $(x,p)$ 中是马尔可夫过程，但在位形空间 $x$ 中不是；因此投入子函数必须定义为 $q(x,p)$，而仅在 $x$ 中定义的盆在识别反应轨迹时通常会导致虚假的重穿越。\n\nB. 通过 $A=\\{(x,p):q(x,p)\\le \\delta\\}$ 和 $B=\\{(x,p):q(x,p)\\ge 1-\\delta\\}$（对于小 $\\delta$）在相空间中定义盆，可以使反应轨迹的识别无歧义，并且当 $B=\\theta A$ 且 $\\theta(x,p)=(x,-p)$ 时，能确保跃迁路径系综中的时间反演对称性。\n\nC. 在盆的定义中包含动量必然会降低跃迁路径采样中标准双向打靶移动的接受概率，因为相空间盆比它们的位形空间对应物更小。\n\nD. 对于处于平衡状态的可逆欠阻尼朗之万动力学，如果 $B=\\theta A$，则投入子函数满足 $q(x,-p)=1-q(x,p)$，并且在 $q(x,p)<1/2$ 的位形空间分割面上的穿越不应被计为反应事件，无论速度的符号如何。\n\nE. 通过跃迁路径采样计算的精确平衡速率常数，对于盆是在位形空间还是在相空间中定义是不变的，前提是两种选择都能得到代表相同化学物种的、亚稳的、不相交的集合；包含动量的主要影响是减少错误分类和重穿越，从而提高估计器的效率，而不是改变真实的速率。\n\n选择所有适用项。", "solution": "对问题陈述进行验证。\n\n**步骤1：提取已知信息**\n- 一个质量为 $m$ 的单粒子在 $d$ 维空间中的动力学由欠阻尼朗之万方程描述：\n$$\n\\dot{x} = \\frac{p}{m}\n$$\n$$\n\\dot{p} = -\\nabla U(x) - \\gamma\\,\\frac{p}{m} + \\sqrt{2\\,\\gamma\\,k_{\\mathrm{B}}T}\\,\\eta(t)\n$$\n- $x \\in \\mathbb{R}^d$ 是位置，$p \\in \\mathbb{R}^d$ 是动量。\n- $U(x)$ 是一个光滑的双稳势。\n- $\\gamma>0$ 是摩擦系数。\n- $T$ 是温度，$k_{\\mathrm{B}}$ 是玻尔兹曼常数。\n- $\\eta(t)$ 是分量独立的标准白噪声。\n- 稳态分布的密度正比于 $\\exp\\{-\\beta[U(x)+\\|p\\|^2/(2m)]\\}$，其中 $\\beta=(k_{\\mathrm{B}}T)^{-1}$。\n- 目标是使用跃迁路径采样（TPS）来采样两个亚稳盆之间的反应轨迹。\n- 提出了两种盆的定义：\n    1. 位形空间盆：$A_x=\\{x:\\|x-x_A\\|<\\varepsilon\\}$ 和 $B_x=\\{x:\\|x-x_B\\|<\\varepsilon\\}$。\n    2. 相空间盆：$A=\\{(x,p):q(x,p)\\le \\delta\\}$ 和 $B=\\{(x,p):q(x,p)\\ge 1-\\delta\\}$，使用投入子函数 $q(x,p)$。\n- 投入子 $q(x,p)$ 是从 $(x,p)$ 出发，在到达 $A$ 之前先到达 $B$ 的概率。\n- 假设动力学相对于稳态测度是可逆的。\n- 时间反演对合为 $\\theta(x,p)=(x,-p)$。\n- 细致平衡性质成立。\n- 对于相空间盆，假设 $B=\\theta A$。\n\n**步骤2：使用提取的已知信息进行验证**\n该问题陈述具有科学依据、问题明确且客观。欠阻尼朗之万方程是在统计物理学中描述粒子在热环境中运动且惯性效应显著的标准模型。跃迁路径采样（TPS）是一种研究化学反应等稀有事件的成熟计算方法。在位形空间和相空间中对盆的定义都是文献中的标准做法。投入子函数的性质以及时间反演对称性的含义是稀有事件理论中的核心概念。该问题没有违反任何基本原理，是自洽的，并且使用了精确、无歧义的术语。所有提供的信息都是一致的，并且与所提问题相关。\n\n**步骤3：结论与行动**\n问题陈述有效。我将继续分析每个选项。\n\n**逐项分析**\n\n**A. 对于欠阻尼朗之万动力学，该过程在相空间 $(x,p)$ 中是马尔可夫过程，但在位形空间 $x$ 中不是；因此投入子函数必须定义为 $q(x,p)$，而仅在 $x$ 中定义的盆在识别反应轨迹时通常会导致虚假的重穿越。**\n\n系统在时间 $t$ 的状态由一对 $(x(t), p(t))$ 完全描述。朗之万方程表明，时间导数 $\\dot{x}$ 和 $\\dot{p}$ 仅依赖于当前状态 $(x(t), p(t))$ 和随机噪声项 $\\eta(t)$。这是在相空间 $\\mathbb{R}^{2d}$ 中马尔可夫过程的定义。\n然而，如果我们只考虑位置 $x(t)$，它的未来演化不仅取决于 $x(t)$，还取决于其时间导数 $\\dot{x}(t) = p(t)/m$。由于动量 $p(t)$ 未包含在状态描述中，因此过程 $x(t)$ 不是马尔可夫过程。动量充当了记忆变量。\n因为该过程仅在完整相空间中是马尔可夫的，所以为马尔可夫过程定义的投入子函数必须是状态变量的函数，即 $q(x,p)$。定义为 $q(x)$ 的投入子函数将是一个近似，仅在高摩擦（过阻尼）极限下有效，在该极限下动量瞬时平衡并可以被积分掉。\n当盆仅由位置定义时（例如 $A_x, B_x$），一条轨迹可以进入一个盆，例如 $B_x$，但携带着指向 $A_x$ 的大动量。因此，它可能在未达到平衡的情况下立即离开 $B_x$，导致一次短暂的、不成功的穿越事件。这些事件被称为重穿越。使用投入子 $q(x,p)$ 在相空间中恰当地定义盆，可以在很大程度上消除这种人为现象，因为一个状态 $(x,p)$ 只有在其返回 $A$ 的概率可以忽略不计时，才被认为处于盆 $B$ 中。因此，该陈述是对欠阻尼系统中模拟稀有事件的基本问题的正确总结。\n\n结论：**正确**。\n\n**B. 通过 $A=\\{(x,p):q(x,p)\\le \\delta\\}$ 和 $B=\\{(x,p):q(x,p)\\ge 1-\\delta\\}$（对于小 $\\delta$）在相空间中定义盆，可以使反应轨迹的识别无歧义，并且当 $B=\\theta A$ 且 $\\theta(x,p)=(x,-p)$ 时，能确保跃迁路径系综中的时间反演对称性。**\n\n一条反应轨迹被定义为一条从盆 $A$ 开始，在盆 $B$ 结束，且中途未返回 $A$ 的路径。用投入子函数的水平集来定义盆，如果一条轨迹从一个 $q \\le \\delta$ 的点开始，并在首次到达一个 $q \\ge 1-\\delta$ 的点时结束，那么它就被认为是反应性的。这个定义在数学上是精确的，在操作上是无歧义的。\n路径系综的时间反演对称性要求动力学可逆性和边界条件的对称性。问题陈述动力学是可逆的。设 $\\mathbf{z}(t)=(x(t), p(t))$ 是一条持续时间为 $\\tau$ 的反应轨迹，从 $A$ 开始，在 $B$ 结束。其时间反演的对应轨迹是 $\\hat{\\mathbf{z}}(t) = \\theta(\\mathbf{z}(\\tau-t))$。反向路径的起点是 $\\hat{\\mathbf{z}}(0) = \\theta(\\mathbf{z}(\\tau))$，位于 $\\theta B$ 中。终点是 $\\hat{\\mathbf{z}}(\\tau) = \\theta(\\mathbf{z}(0))$，位于 $\\theta A$ 中。为了使正向反应路径（$A \\to B$）的系综与反向反应路径（$B \\to A$）的系综在时间反演下相同，我们需要时间反演后的正向路径是有效的反向路径。这要求 $\\theta A = B$ 和 $\\theta B = A$。条件 $B=\\theta A$ 意味着 $\\theta B = \\theta(\\theta A) = A$，所以两个条件都满足了。路径概率测度的细致平衡接着确保了从 $A$ 到 $B$ 的路径的概率与其时间反演（即一条从 $B$ 到 $A$ 的路径）的概率相同。该陈述说“跃迁路径系综中的时间反演对称性”，这在这些条件下是可以实现的。\n\n结论：**正确**。\n\n**C. 在盆的定义中包含动量必然会降低跃迁路径采样中标准双向打靶移动的接受概率，因为相空间盆比它们的位形空间对应物更小。**\n\n该陈述就接受概率的必然降低做出了一个强有力的断言。在双向打靶移动中，接受概率取决于新生成的由前向和后向段组成的轨迹是否仍然连接盆 $A$ 和 $B$。使用基于投入子的相空间盆，通过滤除那些可能重穿越的点，为反应物和产物态提供了更具物理意义的定义。这可以防止生成那些短暂、虚假的偏离的试验路径。虽然它可能会拒绝一些用位形空间盆会被接受的路径（例如，一条仅仅擦过 $B_x$ 区域的路径），但它可能会接受其他与真实跃迁机制更相关的路径。通过将采样集中在“真实”的跃迁路径上，TPS 算法的效率通常会得到提高。效率的提高并非完全与接受率挂钩，但声称接受率必然降低是不正确的。在某些情况下，通过避免无效的提议，“有效”移动的接受率甚至可能增加。“相空间盆更小”这个前提的定义也不明确，它们对接受率的比较影响并不直接。因此，这种概括是没有根据的。\n\n结论：**不正确**。\n\n**D. 对于处于平衡状态的可逆欠阻尼朗之万动力学，如果 $B=\\theta A$，则投入子函数满足 $q(x,-p)=1-q(x,p)$，并且在 $q(x,p)<1/2$ 的位形空间分割面上的穿越不应被计为反应事件，无论速度的符号如何。**\n\n第一部分讨论了投入子函数的一个对称性质。设 $q(z)$ 是状态 $z=(x,p)$ 的投入子。考虑时间反演状态 $\\theta z = (x,-p)$。由于微观可逆性，从 $z$ 出发的轨迹在到达 $A$ 之前先到达 $B$ 的概率，等于从 $\\theta z$ 出发的时间反演轨迹在到达 $\\theta A$ 之前先到达 $\\theta B$ 的概率。考虑到盆的对称性 $B=\\theta A$（这意味着 $A=\\theta B$），这也就是从 $\\theta z$ 出发的轨迹在到达 $B$ 之前先到达 $A$ 的概率。根据定义，这个概率是 $1-q(\\theta z)$。所以我们有 $q(z) = 1-q(\\theta z)$，整理后得到 $q(\\theta z) = 1-q(z)$，即 $q(x,-p) = 1-q(x,p)$。$q(x,p)=1/2$ 的曲面是过渡态表面或分界线。陈述的第一部分是正确的。\n第二部分指出，在点 $(x,p)$ 处穿越位形空间分割面，如果 $q(x,p)<1/2$，则该事件不是反应事件。投入子的值是衡量对产物态 $B$ 投入程度的最终标准。如果 $q(x,p)<1/2$，那么状态 $(x,p)$ 更可能返回反应物盆 $A$，而不是前进到产物盆 $B$。因此，这样的状态位于真实分界线（$q=1/2$）的“反应物一侧”。任何通过这样一个点的轨迹，当它穿越一个启发式定义的位形空间表面时，尚未真正投入到反应中。这正是使用投入子来区分反应性和非反应性轨迹并滤除重穿越的原理。速度信息已经编码在投入子值 $q(x,p)$ 中，所以该陈述的结论是合理的。\n\n结论：**正确**。\n\n**E. 通过跃迁路径采样计算的精确平衡速率常数，对于盆是在位形空间还是在相空间中定义是不变的，前提是两种选择都能得到代表相同化学物种的、亚稳的、不相交的集合；包含动量的主要影响是减少错误分类和重穿越，从而提高估计器的效率，而不是改变真实的速率。**\n\n反应速率常数是一个宏观可观测量，它表征了稳定热力学态（化学物种）之间跃迁的时间尺度。因此，只要这些稳定态边界的定义能够恰当地包围亚稳区域并被显著的自由能垒分开，其真实值就不应依赖于定义的具体微观细节。这就是速率理论中的“平台原理”：计算出的速率应在一系列合理的盆定义上保持稳定。因此，真实的速率常数是不变的。\n盆定义的选择深刻影响这个速率的数值计算。正如在选项A的分析中确立的，对欠阻尼动力学使用位形空间盆会导致状态的错误分类，并将许多短暂的重穿越轨迹计为尝试的跃迁。这会降低任何速率估计器的统计性质。包含动量并使用基于投入子的相空间盆，在反应物、产物和过渡区域之间提供了更清晰的划分。这降低了速率估计器的方差，并提高了TPS计算的整体效率。这个选择影响的是方法的性能，而不是被测量的物理量。\n\n结论：**正确**。", "answer": "$$\\boxed{ABDE}$$", "id": "2690116"}, {"introduction": "在诸如前向通量采样 (FFS) 或过渡界面采样 (TIS) 等基于界面的方法中，计算效率高度依赖于中间界面的放置策略。一个优秀的界面布局可以将一个极小概率事件分解为一系列更大概率的步骤，从而显著降低计算成本。此练习将引导你设计一个自适应算法来优化界面位置，从而在固定的计算预算下最小化反应速率估计的方差。", "problem": "一个稀有反应事件 $A \\to B$ 通过一种基于界面的过渡路径方法（如前向流抽样 (FFS) 或过渡界面抽样 (TIS)）进行研究。设 $\\lambda(\\mathbf{x})$ 是一个从盆地 $A$ 到 $B$ 单调递增的序参量，并考虑一系列界面 $A \\equiv \\{\\lambda \\le \\lambda_{0}\\} \\prec \\{\\lambda=\\lambda_{1}\\} \\prec \\cdots \\prec \\{\\lambda=\\lambda_{M}\\} \\equiv \\{\\lambda \\ge \\lambda_{B}\\}$，其中 $\\lambda_{0}<\\lambda_{1}<\\cdots<\\lambda_{M}=\\lambda_{B}$。在每个界面 $\\lambda_{i}$ 处，发射 $N_{i}$ 条试验性轨迹，当它们到达 $\\lambda_{i+1}$ (成功) 或返回到 $A$ (失败) 时终止，从而产生条件概率 $p_{i}\\equiv P(\\lambda_{i+1}\\mid \\lambda_{i})$ 的一个估计量 $\\hat{p}_{i}$。总穿越概率为 $P_{A\\to B}=\\prod_{i=0}^{M-1}p_{i}$，速率为 $k_{AB}=\\Phi_{A0}\\,P_{A\\to B}$，其中 $\\Phi_{A0}$ 是离开 $A$ 并穿过 $\\lambda_{0}$ 的轨迹的稳态通量。假设一个简单的成本模型，其中每个试验性轨迹的成本在各个界面上近似恒定，并且在主导阶上，界面估计量在统计上是独立的，并在每个界面上服从二项涨落。\n\n哪个选项最好地描述了一种科学上合理的自适应算法，该算法用于放置界面，以使 $P(\\lambda_{i+1}\\mid \\lambda_{i})$ 在不同的 $i$ 之间近似恒定，并为在固定的总计算预算下估计量方差的预期减少提供了正确的第一性原理的论证？\n\nA. 从 $\\lambda_{0}$ 开始，选择一个目标成功概率 $p^{\\star}\\in(0,1)$（例如，$p^{\\star}\\approx 0.2$）。对于每个 $i$，使用从 $\\lambda_{i}$ 发出的包含 $K$ 次试验的短引导批次，来框定两个候选位置 $\\lambda_{i+1}^{-}$ 和 $\\lambda_{i+1}^{+}$，使得观察到的成功分数跨越 $p^{\\star}$，然后使用新的引导试验，在 $\\lambda$ 中应用二分法搜索，直到估计的 $\\hat{p}_{i}\\approx p^{\\star}$ 在一个容差范围内。重复此过程构造 $\\lambda_{i+1}$，并令 $i\\leftarrow i+1$，直到 $\\lambda_{M}=\\lambda_{B}$。在正式计算中，将 $N_{i}$ 大致均匀地分配到各个界面上（如果各界面的成本不同，则根据小的调整进行分配）。论证：对于二项方差 $\\mathrm{Var}(\\hat{p}_{i})=p_{i}(1-p_{i})/N_{i}$ 和独立性，delta方法展开给出相对方差 $\\mathrm{Var}(\\hat{P}_{A\\to B})/P_{A\\to B}^{2}\\approx \\sum_{i}(1-p_{i})/(p_{i}N_{i})$。对于固定的 $\\prod_{i}p_{i}$ 和固定的 $\\{N_{i}\\}$，当所有 $p_{i}$ 相等时，这个和最小，因此自适应地强制 $p_{i}\\approx p^{\\star}$ 会在固定总成本下减少方差。\n\nB. 在 $\\lambda$ 中均匀放置界面：$\\lambda_{i}=\\lambda_{0}+i(\\lambda_{B}-\\lambda_{0})/M$。在抽样过程中，自适应地调整 $N_{i}$，使得每个界面达到相同数量的成功试验次数 $N_{i} \\hat{p}_{i}$，这均衡了信息内容，从而最小化了方差。论证：相等的成功次数意味着对乘积的贡献是平衡的，这是最优的。\n\nC. 首先计算平均力势 $F(\\lambda)$，然后放置界面，使得自由能增量 $\\Delta F_{i}=F(\\lambda_{i+1})-F(\\lambda_{i})$ 相等。这将能垒均匀地划分，从而间接地使 $p_{i}$ 变得均匀，并因为能垒被均匀抽样而最小化方差。\n\nD. 使界面非常稀疏，以至于每个 $p_{i}\\ll 1$，然后通过选择非常大的 $N_{i}$ 来在这些界面上进行补偿。因为每个 $\\mathrm{Var}(\\hat{p}_{i})$ 随后与 $p_{i}/N_{i}$ 成比例，所以增大 $N_{i}$ 比增加更多界面能更有效地减少方差。\n\nE. 实时地估计提交者概率 $q(\\mathbf{x})\\equiv P(B\\ \\text{before}\\ A\\mid \\mathbf{x})$，并在提交者概率分位数 $q_{i}$ 处放置界面，使得 $q_{i+1}-q_{i}$ 是常数。因为提交者概率在界面之间是线性变化的，所以条件概率 $p_{i}$ 是相等的，并且无需进一步论证即可最小化方差。", "solution": "问题要求评估在过渡路径抽样方法（如前向流抽样 (FFS)）中放置界面的不同自适应算法，目标是在固定计算成本下，最小化所估计的速率常数的统计误差。核心思想是理解界面的放置（它决定了条件概率 $p_i$）和计算量的分配（$N_i$）如何影响总穿越概率 $P_{A\\to B}$ 的估计量的总体方差。\n\n首先，让我们确立基本原理。问题陈述，总穿越概率由条件概率的乘积给出：\n$$P_{A\\to B} = \\prod_{i=0}^{M-1} p_i$$\n其中 $p_i = P(\\lambda_{i+1} \\mid \\lambda_i)$ 是从界面 $i$ 开始的轨迹在返回状态 $A$ 之前到达界面 $i+1$ 的概率。该概率的估计量为 $\\hat{P}_{A\\to B} = \\prod_{i=0}^{M-1} \\hat{p}_i$。\n\n分析统计误差的关键是计算该估计量的相对方差 $\\mathrm{Var}(\\hat{P}_{A\\to B}) / P_{A\\to B}^2$。对于小误差，这可以近似为估计量对数的方差。这是 delta方法的一个标准应用。\n$$ \\frac{\\mathrm{Var}(\\hat{P}_{A\\to B})}{P_{A\\to B}^2} \\approx \\mathrm{Var}(\\ln \\hat{P}_{A\\to B}) = \\mathrm{Var}\\left(\\sum_{i=0}^{M-1} \\ln \\hat{p}_i\\right) $$\n问题陈述，不同界面的估计量 $\\hat{p}_i$ 在统计上是独立的。因此，和的方差等于方差的和：\n$$ \\mathrm{Var}\\left(\\sum_{i=0}^{M-1} \\ln \\hat{p}_i\\right) = \\sum_{i=0}^{M-1} \\mathrm{Var}(\\ln \\hat{p}_i) $$\n再次对每一项使用 delta 方法，$\\mathrm{Var}(\\ln \\hat{p}_i) \\approx \\mathrm{Var}(\\hat{p}_i) / p_i^2$。\n问题假设每个界面的 $N_i$ 次试验的成功/失败服从二项涨落。估计量 $\\hat{p}_i$ 是成功试验的比例，因此其方差由二项方差给出：\n$$ \\mathrm{Var}(\\hat{p}_i) = \\frac{p_i(1 - p_i)}{N_i} $$\n结合这些结果，得到总概率估计量相对方差的表达式：\n$$ \\mathcal{V} \\equiv \\frac{\\mathrm{Var}(\\hat{P}_{A\\to B})}{P_{A\\to B}^2} \\approx \\sum_{i=0}^{M-1} \\frac{\\mathrm{Var}(\\hat{p}_i)}{p_i^2} = \\sum_{i=0}^{M-1} \\frac{p_i(1 - p_i)/N_i}{p_i^2} = \\sum_{i=0}^{M-1} \\frac{1 - p_i}{p_i N_i} $$\n优化问题是在固定的总计算成本约束下，最小化此方差 $\\mathcal{V}$。假设每次试验的成本恒定，这等价于固定总试验次数 $N_{tot} = \\sum_{i=0}^{M-1} N_i$。界面位置的选择决定了概率集合 $\\{p_i\\}$，其约束条件为 $\\prod_{i=0}^{M-1} p_i = P_{A\\to B}$。\n\n最直接的策略，也是某些选项所隐含建议的策略，是均匀分配计算预算，使得对所有 $i$ 都有 $N_i = N_{tot}/M$。在这种情况下，方差变为：\n$$ \\mathcal{V} \\approx \\frac{M}{N_{tot}} \\sum_{i=0}^{M-1} \\frac{1 - p_i}{p_i} = \\frac{M}{N_{tot}} \\left( \\sum_{i=0}^{M-1} \\frac{1}{p_i} - M \\right) $$\n为了在固定的 $M$ 下最小化此表达式，我们必须最小化和 $\\sum_{i=0}^{M-1} 1/p_i$，约束条件是乘积 $\\prod_{i=0}^{M-1} p_i = P_{A\\to B}$ 是常数。这是一个经典的优化问题，可以用拉格朗日乘子法解决。设 $f(\\{p_i\\}) = \\sum 1/p_i$，约束条件为 $g(\\{p_i\\}) = \\prod p_i - P_{A\\to B} = 0$。条件 $\\nabla f = \\mu \\nabla g$ 导致 $-\\frac{1}{p_k^2} = \\mu \\frac{\\prod p_i}{p_k}$，这意味着对所有 $k$，$1/p_k$ 是常数。因此，当所有概率都相等时达到最小值：$p_i = p = (P_{A\\to B})^{1/M}$。\n\n因此，在 $N_i$ 相等的假设下，放置界面的最优策略是选择它们，以使所有条件概率 $p_i$ 相等。\n\n现在，我们根据这个推导来评估每个选项。\n\n**A. 从 $\\lambda_{0}$ 开始，选择一个目标成功概率 $p^{\\star}\\in(0,1)$（例如，$p^{\\star}\\approx 0.2$）。对于每个 $i$，使用从 $\\lambda_{i}$ 发出的包含 $K$ 次试验的短引导批次，来框定两个候选位置 $\\lambda_{i+1}^{-}$ 和 $\\lambda_{i+1}^{+}$，使得观察到的成功分数跨越 $p^{\\star}$，然后使用新的引导试验，在 $\\lambda$ 中应用二分法搜索，直到估计的 $\\hat{p}_{i}\\approx p^{\\star}$ 在一个容差范围内。重复此过程构造 $\\lambda_{i+1}$，并令 $i\\leftarrow i+1$，直到 $\\lambda_{M}=\\lambda_{B}$。在正式计算中，将 $N_{i}$ 大致均匀地分配到各个界面上（如果各界面的成本不同，则根据小的调整进行分配）。论证：对于二项方差 $\\mathrm{Var}(\\hat{p}_{i})=p_{i}(1-p_{i})/N_{i}$ 和独立性，delta方法展开给出相对方差 $\\mathrm{Var}(\\hat{P}_{A\\to B})/P_{A\\to B}^{2}\\approx \\sum_{i}(1-p_{i})/(p_{i}N_{i})$。对于固定的 $\\prod_{i}p_{i}$ 和固定的 $\\{N_{i}\\}$，当所有 $p_{i}$ 相等时，这个和最小，因此自适应地强制 $p_{i}\\approx p^{\\star}$ 会在固定总成本下减少方差。**\n\n该选项提出的自适应算法直接旨在使所有 $p_i$ 等于一个目标值 $p^\\star$。所描述的使用引导运行和二分法搜索的过程是实现这一目标的实用且稳健的方法。其提供的论证恰好是上面推导出的论证：它正确地陈述了相对方差的公式，并断言对于固定的 $\\{N_i\\}$，当所有 $p_i$ 相等时达到最小值。这是一个正确的陈述。因此，所提出的算法及其论证都是合理的。**正确**。\n\n**B. 在 $\\lambda$ 中均匀放置界面：$\\lambda_{i}=\\lambda_{0}+i(\\lambda_{B}-\\lambda_{0})/M$。在抽样过程中，自适应地调整 $N_{i}$，使得每个界面达到相同数量的成功试验次数 $N_{i} \\hat{p}_{i}$，这均衡了信息内容，从而最小化了方差。论证：相等的成功次数意味着对乘积的贡献是平衡的，这是最优的。**\n\n这个选项是有缺陷的。首先，在 $\\lambda$ 中均匀放置界面是一种朴素的、非自适应的策略，通常会导致极不均匀的概率 $p_i$。其次，为了让每个界面达到相同数量的成功试验次数 $N_{i} \\hat{p}_{i}$ 而自适应地调整 $N_i$ 的建议并非最优。对于给定的 $\\{p_i\\}$ 集合，$N_i$ 的最优分配是 $N_i \\propto \\sqrt{(1-p_i)/p_i}$，而不是 $N_i \\propto 1/p_i$。其提供的论证（“均衡了信息内容”）是模糊的且不正确。**错误**。\n\n**C. 首先计算平均力势 $F(\\lambda)$，然后放置界面，使得自由能增量 $\\Delta F_{i}=F(\\lambda_{i+1})-F(\\lambda_{i})$ 相等。这将能垒均匀地划分，从而间接地使 $p_{i}$ 变得均匀，并因为能垒被均匀抽样而最小化方差。**\n\n这个策略效率低下，并且通常不正确。跨越一个高能垒计算平均力势 (PMF) 通常比稀有事件计算本身需要更多的计算量，这违背了 FFS 的目的。更重要的是，假设相等的自由能增量 $\\Delta F_i$ 会导致相等的条件概率 $p_i$ 是一种严重的过度简化。概率 $p_i$ 取决于动力学和自由能面的完整形状，特别是向 $\\lambda_{i+1}$ 前进和返回到状态 $A$ 之间的竞争。其论证含糊其辞且缺乏严谨性。**错误**。\n\n**D. 使界面非常稀疏，以至于每个 $p_{i}\\ll 1$，然后通过选择非常大的 $N_{i}$ 来在这些界面上进行补偿。因为每个 $\\mathrm{Var}(\\hat{p}_{i})$ 随后与 $p_{i}/N_{i}$ 成比例，所以增大 $N_{i}$ 比增加更多界面能更有效地减少方差。**\n\n这种方法在根本上是错误的。基于界面的方法的全部目的就是将一个单一的、非常稀有的事件（概率为 $P_{A\\to B} \\ll 1$）分解为一系列更频繁的事件（概率 $p_i$ 不是过小）。对于一个非常小的 $p_i$，必须运行极大数量的试验 $N_i \\gg 1/p_i$ 才能观察到几次成功。这会导致灾难性的效率损失。相对方差 $\\mathcal{V} \\approx \\sum_i 1/(p_i N_i)$ 表明，就方差而言，小的 $p_i$ 值代价极高。增加更多界面以提高单个 $p_i$ 值，远比试图通过暴力增加 $N_i$ 来克服一个小的 $p_i$ 值要高效得多。**错误**。\n\n**E. 实时地估计提交者概率 $q(\\mathbf{x})\\equiv P(B\\ \\text{before}\\ A\\mid \\mathbf{x})$，并在提交者概率分位数 $q_{i}$ 处放置界面，使得 $q_{i+1}-q_{i}$ 是常数。因为提交者概率在界面之间是线性变化的，所以条件概率 $p_{i}$ 是相等的，并且无需进一步论证即可最小化方差。**\n\n这个选项包含了几个理论和实践上的问题。虽然提交者概率 $q(\\mathbf{x})$ 确实是理想的反应坐标，但它通常是未知的。准确地估计它通常与原始的速率计算问题一样困难，这使得该建议成为循环论证。此外，“提交者概率在界面之间线性变化”的说法是错误的；提交者概率是系统坐标的一个复杂的非线性函数。最后，即使可以将界面定义为真实提交者概率的等值面，这些界面与 FFS 条件概率 $p_i$ 之间的关系也不像所暗示的那么简单，并且它不能自动保证 $p_i$ 相等。该选项没有为方差最小化提供有效的论证。**错误**。\n\n总之，选项 A 正确地描述了在 FFS 中放置界面的一个标准的、实用的自适应算法，并基于第一性原理的统计分析为其有效性提供了严谨且正确的论证。", "answer": "$$\\boxed{A}$$", "id": "2690120"}, {"introduction": "过渡界面采样 (TIS) 模拟的最终成果是一系列测量数据：穿过第一个界面的初始通量，以及轨迹成功穿过后续一系列界面的条件概率。本练习的核心任务是将这些零散的数据点整合起来，计算出总的反应速率常数 $k_{AB}$。此外，你还将学习如何使用标准误差传播方法，为你的计算结果提供一个严格的统计不确定性估计。", "problem": "一个双稳态化学系统具有反应物盆 $A$ 和产物盆 $B$。您沿着一个序参量 $\\lambda$，通过一系列不相交的界面 $\\{\\lambda_0, \\lambda_1, \\lambda_2, \\lambda_B\\}$ 进行过渡界面取样（Transition Interface Sampling, TIS），这些界面将 $A$ 和 $B$ 单调地分离开。过渡界面取样（TIS）框架将正向速率常数 $k_{AB}$ 定义为：离开 $A$ 的轨迹首次穿越最内层界面 $\\lambda_0$ 的通量，乘以这样一条首次穿越轨迹在返回 $A$ 之前最终到达 $B$ 的概率。\n\n通过独立的模拟，您获得了以下估计值及其单标准差不确定度（假设所有估计值都是无偏、高斯分布且相互独立的）：\n- $\\lambda_0$ 处的首次穿越通量：$\\Phi_{A,\\lambda_0} = 2.50 \\times 10^{-3} \\ \\mathrm{s}^{-1}$，标准不确定度为 $0.20 \\times 10^{-3} \\ \\mathrm{s}^{-1}$。\n- 条件界面穿越概率：$P(\\lambda_{1}\\mid \\lambda_0) = 0.45 \\pm 0.03$，$P(\\lambda_{2}\\mid \\lambda_1) = 0.38 \\pm 0.02$，以及 $P(\\lambda_{B}\\mid \\lambda_2) = 0.22 \\pm 0.015$。\n\n从过渡界面取样（TIS）中速率的既定定义和基本概率法则出发，完成以下任务：\n1. 推导 $k_{AB}$ 关于 $\\Phi_{A,\\lambda_0}$ 和条件概率 $P(\\lambda_{i+1}\\mid \\lambda_i)$ 的显式表达式。\n2. 使用所提供的数值计算 $k_{AB}$ 的中心估计值。\n3. 使用一阶 delta 方法进行独立输入的不确定度传播，推导并计算 $k_{AB}$ 的标准不确定度。\n\n清晰地表达中间的符号步骤。为便于评分，仅报告 $k_{AB}$ 的中心估计值，四舍五入到四位有效数字，单位为 $\\mathrm{s}^{-1}$。", "solution": "所给问题是过渡界面取样（TIS）原理在速率常数计算中的一个有效应用，且问题提法明确。我们将着手进行解答。\n\n问题要求三项内容：速率常数表达式的推导、其中心值以及相关的不确定度。我们将按顺序解决这些问题。\n\n首先，我们推导速率常数 $k_{AB}$ 的表达式。问题将速率常数定义为：离开反应物盆 $A$ 并穿过第一个界面 $\\lambda_0$ 的通量，与进行此首次穿越的轨迹在返回 $A$ 之前最终到达产物盆 $B$ 的概率的乘积。这可以表示为：\n$$k_{AB} = \\Phi_{A,\\lambda_0} \\times P(B \\mid A \\to \\lambda_0)$$\n其中 $\\Phi_{A,\\lambda_0}$ 是首次穿越通量，$P(B \\mid A \\to \\lambda_0)$ 是指一条轨迹刚从 $A$ 穿过 $\\lambda_0$ 后到达盆 $B$ 的条件概率。\n\nTIS 方法采用一系列不相交的有序界面来定义从 $A$ 到 $B$ 的路径。在本问题中，该路径由界面序列 $\\{\\lambda_0, \\lambda_1, \\lambda_2, \\lambda_B\\}$ 定义。要使轨迹从 $\\lambda_0$ 前进到 $B$，它必须在不返回 $A$ 的情况下相继穿过 $\\lambda_1$ 和 $\\lambda_2$。总概率 $P(B \\mid A \\to \\lambda_0)$ 可以使用概率的链式法则进行分解。设从 $\\lambda_{i-1}$ 出发的轨迹在返回 $A$ 之前到达界面 $\\lambda_i$ 的事件记为 $E_i$。我们感兴趣的是在已穿过 $\\lambda_0$（事件 $E_0$）的条件下到达 $B$（事件 $E_B$）的概率。\n$$P(E_B \\mid E_0)$$\n由于界面是有序的，到达事件 $E_B$ 之前必须先发生到达 $E_2$ 和 $E_1$ 的事件。链式法则给出：\n$$P(E_B \\mid E_0) = P(E_1 \\mid E_0) \\times P(E_2 \\mid E_1 \\cap E_0) \\times P(E_B \\mid E_2 \\cap E_1 \\cap E_0)$$\nTIS 的一个基本假设是，相对于界面而言，穿越过程是马尔可夫的（Markovian）。这意味着穿越下一个界面 $\\lambda_{i+1}$ 的概率仅取决于轨迹已到达 $\\lambda_i$ 这一事实，而与其之前的历史无关。因此，$P(E_2 \\mid E_1 \\cap E_0) = P(E_2 \\mid E_1)$ 且 $P(E_B \\mid E_2 \\cap E_1 \\cap E_0) = P(E_B \\mid E_2)$。\n问题陈述中提供的概率正是这些条件概率：$P(\\lambda_{i+1} \\mid \\lambda_i)$。因此，总概率是以下乘积：\n$$P(B \\mid A \\to \\lambda_0) = P(\\lambda_1 \\mid \\lambda_0) \\times P(\\lambda_2 \\mid \\lambda_1) \\times P(\\lambda_B \\mid \\lambda_2)$$\n将此代入速率表达式，我们得到 $k_{AB}$ 的显式公式：\n$$k_{AB} = \\Phi_{A,\\lambda_0} \\times P(\\lambda_1 \\mid \\lambda_0) \\times P(\\lambda_2 \\mid \\lambda_1) \\times P(\\lambda_B \\mid \\lambda_2)$$\n这完成了任务的第一部分。\n\n其次，我们使用所提供的值计算 $k_{AB}$ 的中心估计值：\n$\\Phi_{A,\\lambda_0} = 2.50 \\times 10^{-3} \\ \\mathrm{s}^{-1}$\n$P(\\lambda_1 \\mid \\lambda_0) = 0.45$\n$P(\\lambda_2 \\mid \\lambda_1) = 0.38$\n$P(\\lambda_B \\mid \\lambda_2) = 0.22$\n\n将这些值代入我们推导的表达式：\n$$k_{AB} = (2.50 \\times 10^{-3}) \\times (0.45) \\times (0.38) \\times (0.22)$$\n$$k_{AB} = (2.50 \\times 10^{-3}) \\times (0.171) \\times (0.22)$$\n$$k_{AB} = (2.50 \\times 10^{-3}) \\times 0.03762$$\n$$k_{AB} = 0.09405 \\times 10^{-3} \\ \\mathrm{s}^{-1} = 9.405 \\times 10^{-5} \\ \\mathrm{s}^{-1}$$\n速率常数的中心估计值为 $9.405 \\times 10^{-5} \\ \\mathrm{s}^{-1}$。\n\n第三，我们推导并计算 $k_{AB}$ 的标准不确定度，记为 $\\sigma_{k_{AB}}$。问题指定使用一阶 delta 方法进行独立输入的不确定度传播。设速率常数的函数为 $k_{AB} = f(x_1, x_2, x_3, x_4)$，其中 $x_1 = \\Phi_{A,\\lambda_0}$，$x_2 = P(\\lambda_1 \\mid \\lambda_0)$，$x_3 = P(\\lambda_2 \\mid \\lambda_1)$，以及 $x_4 = P(\\lambda_B \\mid \\lambda_2)$。方差 $\\sigma_{k_{AB}}^2$ 由下式给出：\n$$\\sigma_{k_{AB}}^2 \\approx \\sum_{i=1}^{4} \\left( \\frac{\\partial f}{\\partial x_i} \\right)^2 \\sigma_{x_i}^2$$\n偏导数为：\n$\\frac{\\partial k_{AB}}{\\partial x_1} = x_2 x_3 x_4 = \\frac{k_{AB}}{x_1}$\n$\\frac{\\partial k_{AB}}{\\partial x_2} = x_1 x_3 x_4 = \\frac{k_{AB}}{x_2}$\n$\\frac{\\partial k_{AB}}{\\partial x_3} = x_1 x_2 x_4 = \\frac{k_{AB}}{x_3}$\n$\\frac{\\partial k_{AB}}{\\partial x_4} = x_1 x_2 x_3 = \\frac{k_{AB}}{x_4}$\n\n将这些代入方差公式，得到：\n$$\\sigma_{k_{AB}}^2 \\approx \\left(\\frac{k_{AB}}{x_1}\\right)^2 \\sigma_{x_1}^2 + \\left(\\frac{k_{AB}}{x_2}\\right)^2 \\sigma_{x_2}^2 + \\left(\\frac{k_{AB}}{x_3}\\right)^2 \\sigma_{x_3}^2 + \\left(\\frac{k_{AB}}{x_4}\\right)^2 \\sigma_{x_4}^2$$\n两边同除以 $k_{AB}^2$ 得到相对不确定度的平方表达式：\n$$\\left(\\frac{\\sigma_{k_{AB}}}{k_{AB}}\\right)^2 \\approx \\left(\\frac{\\sigma_{x_1}}{x_1}\\right)^2 + \\left(\\frac{\\sigma_{x_2}}{x_2}\\right)^2 + \\left(\\frac{\\sigma_{x_3}}{x_3}\\right)^2 + \\left(\\frac{\\sigma_{x_4}}{x_4}\\right)^2$$\n现在我们计算输入量的相对不确定度的数值：\n$\\frac{\\sigma_{x_1}}{x_1} = \\frac{0.20 \\times 10^{-3}}{2.50 \\times 10^{-3}} = 0.08$\n$\\frac{\\sigma_{x_2}}{x_2} = \\frac{0.03}{0.45} = \\frac{1}{15} \\approx 0.06667$\n$\\frac{\\sigma_{x_3}}{x_3} = \\frac{0.02}{0.38} = \\frac{1}{19} \\approx 0.05263$\n$\\frac{\\sigma_{x_4}}{x_4} = \\frac{0.015}{0.22} = \\frac{3}{44} \\approx 0.06818$\n\n将这些值平方并求和：\n$$\\left(\\frac{\\sigma_{k_{AB}}}{k_{AB}}\\right)^2 \\approx (0.08)^2 + \\left(\\frac{1}{15}\\right)^2 + \\left(\\frac{1}{19}\\right)^2 + \\left(\\frac{3}{44}\\right)^2$$\n$$\\left(\\frac{\\sigma_{k_{AB}}}{k_{AB}}\\right)^2 \\approx 0.0064 + 0.004444... + 0.002770... + 0.004648... \\approx 0.018263$$\n相对不确定度是该总和的平方根：\n$$\\frac{\\sigma_{k_{AB}}}{k_{AB}} \\approx \\sqrt{0.018263} \\approx 0.1351$$\n最后，绝对不确定度 $\\sigma_{k_{AB}}$ 是：\n$$\\sigma_{k_{AB}} \\approx 0.1351 \\times k_{AB} = 0.1351 \\times (9.405 \\times 10^{-5}) \\approx 1.27 \\times 10^{-5} \\ \\mathrm{s}^{-1}$$\n完整结果是 $k_{AB} = (9.405 \\pm 1.27) \\times 10^{-5} \\ \\mathrm{s}^{-1}$。然而，题目的最终答案要求只指定中心估计值，并四舍五入到四位有效数字。计算出的值 $9.405 \\times 10^{-5}$ 已经有四位有效数字。", "answer": "$$\\boxed{9.405 \\times 10^{-5}}$$", "id": "2690077"}]}