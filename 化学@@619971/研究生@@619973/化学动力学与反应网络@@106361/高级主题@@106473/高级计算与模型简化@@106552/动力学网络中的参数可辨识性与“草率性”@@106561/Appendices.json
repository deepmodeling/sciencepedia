{"hands_on_practices": [{"introduction": "费雪信息矩阵（Fisher Information Matrix, FIM）是进行局部可辨识性分析的核心工具。其特征值量化了参数空间中不同方向上的信息含量，一个接近于零的特征值标志着一个“松散”或不可辨识的方向。本练习通过一个简洁的理想化情景，让您亲手推导并计算费雪信息矩阵的特征值与特征向量，从而牢固地建立起 FIM 谱性质与参数可辨识性及模型松散性之间的基本联系。[@problem_id:2661021]", "problem": "考虑一个化学反应网络的简化模型，其中只有两个有效速率常数之比会影响可观测测量值。设两个估计参数是这些速率常数的对数，记为 $\\theta_1$ 和 $\\theta_2$，它们是无量纲的。假设在对依赖于数据的项进行积分后，参数的似然函数呈现为脊形\n$$\nL(\\theta_1,\\theta_2) \\propto \\exp\\!\\left(-\\frac{(\\theta_1-\\theta_2)^2}{\\sigma^2}\\right),\n$$\n其中噪声标度为 $\\sigma>0$。从参数 $\\theta = (\\theta_1,\\theta_2)^{\\top}$ 的费雪信息矩阵 (FIM) 的定义出发，\n$$\nF_{ij}(\\theta) \\equiv -\\mathbb{E}\\!\\left[\\frac{\\partial^2}{\\partial \\theta_i \\partial \\theta_j} \\ln L(\\theta)\\right],\n$$\n推导对数似然函数的曲率性质，并证明该模型沿 $\\theta_1+\\theta_2$ 方向是“松垮”的（即主阶不可辨识）。具体而言，计算费雪信息矩阵的特征值和特征向量，确定“刚性”和“松垮”方向，并根据影响似然函数的参数组合来解释“松垮”现象的成因。\n\n你的最终数值目标是：以 $\\sigma$ 的闭式解析表达式形式报告费雪信息矩阵的非零特征值。无需四舍五入，不涉及单位。请将最终答案表示为关于 $\\sigma$ 的单个解析表达式。", "solution": "该问题要求对给定似然函数的参数可辨识性进行严格分析。在继续之前，我们必须验证问题的陈述。\n\n首先，我们提取给定信息。\n参数为 $\\theta_1$ 和 $\\theta_2$，构成向量 $\\theta = (\\theta_1, \\theta_2)^{\\top}$。\n似然函数由以下比例关系给出：\n$$\nL(\\theta_1,\\theta_2) \\propto \\exp\\!\\left(-\\frac{(\\theta_1-\\theta_2)^2}{\\sigma^2}\\right)\n$$\n其中 $\\sigma > 0$ 是一个常数。\n费雪信息矩阵 (FIM) 由其分量定义：\n$$\nF_{ij}(\\theta) \\equiv -\\mathbb{E}\\!\\left[\\frac{\\partial^2}{\\partial \\theta_i \\partial \\theta_j} \\ln L(\\theta)\\right]\n$$\n任务是计算该矩阵的特征值和特征向量，确定“刚性”和“松垮”方向，并解释模型“松垮”现象的来源。最终目标是报告 FIM 的非零特征值。\n\n该问题具有科学依据，是适定且客观的。这是模型参数敏感性和结构可辨识性研究中的一个标准练习。这种似然函数形式，即输出仅依赖于参数的特定组合，是导致不可辨识性的典型情景。所有必要信息均已提供，且问题在数学上是合理的。因此，该问题是有效的，我们可以进行求解。\n\n对数似然函数，记为 $\\ell(\\theta)$，通过取似然函数 $L(\\theta)$ 的自然对数得到。忽略对二阶导数没有影响的比例常数，我们有：\n$$\n\\ell(\\theta_1, \\theta_2) = \\ln(L(\\theta_1, \\theta_2)) = -\\frac{(\\theta_1-\\theta_2)^2}{\\sigma^2} = -\\frac{1}{\\sigma^2}(\\theta_1^2 - 2\\theta_1\\theta_2 + \\theta_2^2)\n$$\n为了构建 FIM，我们必须首先计算对数似然函数的 Hessian 矩阵 $H(\\theta)$，其元素为 $H_{ij} = \\frac{\\partial^2 \\ell}{\\partial \\theta_i \\partial \\theta_j}$。\n\n首先，我们计算 $\\ell(\\theta_1, \\theta_2)$ 的一阶偏导数：\n$$\n\\frac{\\partial \\ell}{\\partial \\theta_1} = -\\frac{1}{\\sigma^2}(2\\theta_1 - 2\\theta_2) = -\\frac{2(\\theta_1 - \\theta_2)}{\\sigma^2}\n$$\n$$\n\\frac{\\partial \\ell}{\\partial \\theta_2} = -\\frac{1}{\\sigma^2}(-2\\theta_1 + 2\\theta_2) = \\frac{2(\\theta_1 - \\theta_2)}{\\sigma^2}\n$$\n接下来，我们计算二阶偏导数：\n$$\nH_{11} = \\frac{\\partial^2 \\ell}{\\partial \\theta_1^2} = \\frac{\\partial}{\\partial \\theta_1}\\left(-\\frac{2\\theta_1 - 2\\theta_2}{\\sigma^2}\\right) = -\\frac{2}{\\sigma^2}\n$$\n$$\nH_{22} = \\frac{\\partial^2 \\ell}{\\partial \\theta_2^2} = \\frac{\\partial}{\\partial \\theta_2}\\left(\\frac{2\\theta_1 - 2\\theta_2}{\\sigma^2}\\right) = -\\frac{2}{\\sigma^2}\n$$\n$$\nH_{12} = \\frac{\\partial^2 \\ell}{\\partial \\theta_1 \\partial \\theta_2} = \\frac{\\partial}{\\partial \\theta_2}\\left(-\\frac{2\\theta_1 - 2\\theta_2}{\\sigma^2}\\right) = \\frac{2}{\\sigma^2}\n$$\n根据 Clairaut 定理，$H_{21} = H_{12}$，所以我们有 $H_{21} = \\frac{2}{\\sigma^2}$。\n\n因此，Hessian 矩阵 $H$ 为：\n$$\nH = \\begin{pmatrix} -\\frac{2}{\\sigma^2} & \\frac{2}{\\sigma^2} \\\\ \\frac{2}{\\sigma^2} & -\\frac{2}{\\sigma^2} \\end{pmatrix} = \\frac{2}{\\sigma^2} \\begin{pmatrix} -1 & 1 \\\\ 1 & -1 \\end{pmatrix}\n$$\nFIM 定义为 $F = -\\mathbb{E}[H]$。由于 Hessian 矩阵 $H$ 的元素是常数，不依赖于任何随机变量（数据）或参数 $\\theta$，因此期望运算是平凡的：$\\mathbb{E}[H] = H$。\n因此，FIM 为：\n$$\nF = -H = -\\left(\\frac{2}{\\sigma^2} \\begin{pmatrix} -1 & 1 \\\\ 1 & -1 \\end{pmatrix}\\right) = \\frac{2}{\\sigma^2} \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix}\n$$\n为了分析曲率性质和可辨识性，我们计算 FIM 的特征值和特征向量。特征值 $\\lambda$ 是特征方程 $\\det(F - \\lambda I) = 0$ 的根，其中 $I$ 是 $2 \\times 2$ 的单位矩阵。\n$$\n\\det\\left( \\begin{pmatrix} \\frac{2}{\\sigma^2} - \\lambda & -\\frac{2}{\\sigma^2} \\\\ -\\frac{2}{\\sigma^2} & \\frac{2}{\\sigma^2} - \\lambda \\end{pmatrix} \\right) = 0\n$$\n$$\n\\left(\\frac{2}{\\sigma^2} - \\lambda\\right)^2 - \\left(-\\frac{2}{\\sigma^2}\\right)^2 = 0\n$$\n$$\n\\left(\\frac{2}{\\sigma^2} - \\lambda\\right)^2 = \\left(\\frac{2}{\\sigma^2}\\right)^2\n$$\n该方程产生 $\\lambda$ 的两个解：\n1. $\\frac{2}{\\sigma^2} - \\lambda_1 = \\frac{2}{\\sigma^2} \\implies \\lambda_1 = 0$\n2. $\\frac{2}{\\sigma^2} - \\lambda_2 = -\\frac{2}{\\sigma^2} \\implies \\lambda_2 = \\frac{4}{\\sigma^2}$\n\nFIM 的特征值为 $\\lambda_1 = 0$ 和 $\\lambda_2 = \\frac{4}{\\sigma^2}$。\n\n接下来，我们求解相应的特征向量。\n对于特征值 $\\lambda_1 = 0$，特征向量 $v_1 = (x, y)^\\top$ 满足 $(F - 0 \\cdot I)v_1 = 0$：\n$$\n\\frac{2}{\\sigma^2} \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix} \\begin{pmatrix} x \\\\ y \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}\n$$\n这简化为方程 $x - y = 0$，即 $x = y$。特征向量是任何与 $(1, 1)^\\top$ 成比例的向量。我们选择归一化的特征向量 $v_1 = \\frac{1}{\\sqrt{2}}(1, 1)^\\top$。\n\n对于特征值 $\\lambda_2 = \\frac{4}{\\sigma^2}$，特征向量 $v_2 = (x, y)^\\top$ 满足 $(F - \\lambda_2 I)v_2 = 0$：\n$$\n\\left( \\frac{2}{\\sigma^2} \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix} - \\frac{4}{\\sigma^2} \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix} \\right) \\begin{pmatrix} x \\\\ y \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}\n$$\n$$\n\\left( \\begin{pmatrix} \\frac{2}{\\sigma^2} & -\\frac{2}{\\sigma^2} \\\\ -\\frac{2}{\\sigma^2} & \\frac{2}{\\sigma^2} \\end{pmatrix} - \\begin{pmatrix} \\frac{4}{\\sigma^2} & 0 \\\\ 0 & \\frac{4}{\\sigma^2} \\end{pmatrix} \\right) \\begin{pmatrix} x \\\\ y \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}\n$$\n$$\n\\frac{2}{\\sigma^2} \\begin{pmatrix} -1 & -1 \\\\ -1 & -1 \\end{pmatrix} \\begin{pmatrix} x \\\\ y \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}\n$$\n这简化为方程 $-x - y = 0$，即 $x = -y$。特征向量是任何与 $(1, -1)^\\top$ 成比例的向量。我们选择归一化的特征向量 $v_2 = \\frac{1}{\\sqrt{2}}(1, -1)^\\top$。\n\nFIM 的特征值对应于对数似然面在特征向量方向上的曲率。\n与非零特征值 $\\lambda_2 = \\frac{4}{\\sigma^2}$ 相关联的特征向量 $v_2$ 代表了参数空间中的“刚性”方向。该方向对应于参数组合 $\\theta_1 - \\theta_2$ 的变化。似然函数对沿此方向的扰动高度敏感，意味着这个参数组合受到数据的良好约束。\n与特征值 $\\lambda_1 = 0$ 相关联的特征向量 $v_1$ 代表了“松垮”方向。该方向对应于参数组合 $\\theta_1 + \\theta_2$ 的变化。零特征值表示对数似然面沿此方向是完全平坦的。因此，模型沿此参数方向是结构上不可辨识的。\n\n“松垮”现象，或者在本例中是完全不可辨识性，其产生原因在于似然函数 $L(\\theta_1, \\theta_2)$ 仅依赖于差值 $\\theta_1 - \\theta_2$。对参数的任何改动，只要 $\\theta_1$ 和 $\\theta_2$ 以相同量变化，即 $\\Delta\\theta_1 = \\Delta\\theta_2 = \\delta$，都会使 $\\theta_1 - \\theta_2$ 的值保持不变：$(\\theta_1+\\delta) - (\\theta_2+\\delta) = \\theta_1 - \\theta_2$。这种变化对应于在参数空间中沿向量 $(1, 1)^\\top$ 的移动，而这正是“松垮”的特征向量 $v_1$。由于沿此方向移动时似然函数不发生改变，数据完全没有提供任何关于参数组合 $\\theta_1 + \\theta_2$ 值的信息。这证明了模型沿对应于 $\\theta_1 + \\theta_2$ 的方向是“松垮”的（不可辨识的），符合题意。\n\n最后的任务是报告费雪信息矩阵的非零特征值。根据我们的推导，该值为 $\\frac{4}{\\sigma^2}$。", "answer": "$$\n\\boxed{\\frac{4}{\\sigma^2}}\n$$", "id": "2661021"}, {"introduction": "在将理论应用于实际的动力学系统时，我们常常会发现实验观测量是有限的，它们可能无法对所有独立的模型参数都敏感。本练习将探讨一个具体的催化循环模型，演示这种观测局限性如何导致结构不可辨识性问题。通过推导，您将揭示实验数据仅能确定某些参数组合（在本例中为速率常数的乘积），并进一步实践模型重参数化这一关键技能，以显式地分离模型中可辨识与不可辨识的部分。[@problem_id:2660969]", "problem": "一个在伪一级条件下的两步催化循环通过质量作用动力学进行建模。该模型描述了一个酶在释放产物前，在游离态和催化复合物之间循环转换的过程。设游离酶用 $E$ 表示，酶-底物复合物用 $C$ 表示，累积产物用 $P$ 表示。假设底物是饱和且恒定的，因此正向结合步骤相对于 $E$ 有效地为一级反应，速率常数为 $k_1$；而将 $C$ 转化回 $E$ 并产生 $P$ 的催化释放步骤发生的速率常数为 $k_2$。总酶量 $E_{\\mathrm{T}}$ 是守恒的，因此对于所有 $t \\ge 0$，有 $E(t) + C(t) = E_{\\mathrm{T}}$。其动力学方程为\n$$\n\\frac{dE}{dt} \\;=\\; -\\,k_1\\,E \\;+\\; k_2\\,C,\\qquad\n\\frac{dC}{dt} \\;=\\; k_1\\,E \\;-\\; k_2\\,C,\\qquad\n\\frac{dP}{dt} \\;=\\; k_2\\,C,\n$$\n初始条件为 $E(0)=E_{\\mathrm{T}}$，$C(0)=0$ 和 $P(0)=0$。假设实验设备无法解析完整的时间历程，而仅返回归一化产物的初始曲率，即标量统计量\n$$\ng \\;=\\; \\left.\\frac{d^2}{dt^2}\\,\\frac{P(t)}{E_{\\mathrm{T}}}\\right|_{t=0}.\n$$\n请仅使用给定的模型方程和守恒律，且除了伪一级动力学和守恒外不引入任何其他近似，推导 $g$ 关于 $k_1$、$k_2$ 和 $E_{\\mathrm{T}}$ 的表达式，并确定仅从 $g$ 可以结构辨识出 $k_1$ 和 $k_2$ 的哪些组合。然后，构建一个显式的重参数化 $\\phi:(k_1,k_2)\\mapsto(\\theta_1,\\theta_2)$，使得 $\\theta_1$ 可从 $g$ 结构辨识，而 $\\theta_2$ 不可从 $g$ 辨识，并且对于任何固定的可辨识组合，$\\phi$ 是一一对应的。最后，给出 $\\theta_1$ 作为 $k_1$ 和 $k_2$ 函数的显式表达式。将你的最终答案表示为一个仅含 $k_1$ 和 $k_2$ 的闭式解析表达式。不需要进行数值近似。", "solution": "该问题要求在一个简单的酶促循环中，推导一个与产物生成初始曲率相关的可观测量，然后分析参数的可辨识性。我们将基于所给的常微分方程组和初始条件进行直接计算。\n\n该系统由以下动力学方程和守恒律描述：\n$$\n\\frac{dE}{dt} = -k_1 E + k_2 C\n$$\n$$\n\\frac{dC}{dt} = k_1 E - k_2 C\n$$\n$$\n\\frac{dP}{dt} = k_2 C\n$$\n$$\nE(t) + C(t) = E_{\\mathrm{T}}\n$$\n初始条件为 $E(0) = E_{\\mathrm{T}}$，$C(0) = 0$ 和 $P(0) = 0$。参数 $k_1$、$k_2$ 和 $E_{\\mathrm{T}}$ 是正常数。\n\n实验可观测量是标量统计量 $g$，定义为归一化产物浓度的初始曲率：\n$$\ng = \\left.\\frac{d^2}{dt^2}\\,\\frac{P(t)}{E_{\\mathrm{T}}}\\right|_{t=0}\n$$\n为了计算 $g$，我们必须求出函数 $\\frac{P(t)}{E_{\\mathrm{T}}}$ 的二阶导数，并在 $t = 0$ 处对其求值。\n\n让我们首先求出归一化产物对时间 $t$ 的一阶导数：\n$$\n\\frac{d}{dt}\\left(\\frac{P(t)}{E_{\\mathrm{T}}}\\right) = \\frac{1}{E_{\\mathrm{T}}} \\frac{dP}{dt}\n$$\n代入给定的关于 $P$ 的微分方程 $\\frac{dP}{dt} = k_2 C(t)$，我们得到：\n$$\n\\frac{d}{dt}\\left(\\frac{P(t)}{E_{\\mathrm{T}}}\\right) = \\frac{k_2 C(t)}{E_{\\mathrm{T}}}\n$$\n现在，我们通过将上式对 $t$ 求导来计算二阶导数：\n$$\n\\frac{d^2}{dt^2}\\left(\\frac{P(t)}{E_{\\mathrm{T}}}\\right) = \\frac{d}{dt}\\left(\\frac{k_2 C(t)}{E_{\\mathrm{T}}}\\right) = \\frac{k_2}{E_{\\mathrm{T}}} \\frac{dC}{dt}\n$$\n$g$ 的值就是这个二阶导数在 $t=0$ 时的值：\n$$\ng = \\left.\\frac{k_2}{E_{\\mathrm{T}}} \\frac{dC}{dt}\\right|_{t=0}\n$$\n为了继续计算，我们必须确定 $\\frac{dC}{dt}$ 在 $t=0$ 时的值。我们使用关于 $C(t)$ 的微分方程：\n$$\n\\frac{dC}{dt} = k_1 E(t) - k_2 C(t)\n$$\n将此表达式在 $t=0$ 处求值，得到：\n$$\n\\left.\\frac{dC}{dt}\\right|_{t=0} = k_1 E(0) - k_2 C(0)\n$$\n给定的初始条件为 $E(0) = E_{\\mathrm{T}}$ 和 $C(0) = 0$。代入这些值得到：\n$$\n\\left.\\frac{dC}{dt}\\right|_{t=0} = k_1 (E_{\\mathrm{T}}) - k_2 (0) = k_1 E_{\\mathrm{T}}\n$$\n现在，我们将此结果代回到我们关于 $g$ 的表达式中：\n$$\ng = \\frac{k_2}{E_{\\mathrm{T}}} (k_1 E_{\\mathrm{T}})\n$$\n总酶浓度 $E_{\\mathrm{T}}$ 被消去，得到 $g$ 的最终表达式：\n$$\ng = k_1 k_2\n$$\n这个表达式给出了用模型参数 $k_1$ 和 $k_2$ 表示的可观测量 $g$。\n\n接下来，我们讨论结构可辨识性问题。实验测量提供了 $g$ 的一个值。从关系式 $g = k_1 k_2$ 中，我们看到实验仅能确定速率常数之积 $k_1 k_2$ 的值。从这单个信息中，不可能唯一地确定 $k_1$ 和 $k_2$ 各自的值。对于任何给定的测量值 $g_0$，参数空间中位于双曲线 $k_1 k_2 = g_0$ 上的任何参数对 $(k_1, k_2)$ 都与数据一致。因此，参数 $k_1$ 和 $k_2$ 单独地是结构不可辨识的。唯一能从可观测量 $g$ 结构辨识的参数组合是乘积 $k_1 k_2$。\n\n问题接着要求构建一个一一对应的重参数化 $\\phi:(k_1,k_2)\\mapsto(\\theta_1,\\theta_2)$，其中 $\\theta_1$ 可从 $g$ 的测量中结构辨识，而 $\\theta_2$ 是结构不可辨识的。基于我们的分析，可辨识参数 $\\theta_1$ 的自然选择是直接被测量到的组合：\n$$\n\\theta_1 = k_1 k_2\n$$\n对于不可辨识参数 $\\theta_2$，我们必须选择一个 $k_1$ 和 $k_2$ 的函数，该函数与 $\\theta_1$ 函数无关，并确保映射是可逆的。一个合适的选择是速率常数之比：\n$$\n\\theta_2 = \\frac{k_1}{k_2}\n$$\n可观测量 $g$ 不提供关于此比率的任何信息。为了确认对于正的 $k_1$ 和 $k_2$ 此重参数化是一一对应的，我们可以用 $\\theta_1$ 和 $\\theta_2$ 来求解 $k_1$ 和 $k_2$。将两式相乘得到 $k_1^2 = \\theta_1 \\theta_2$，因此 $k_1 = \\sqrt{\\theta_1 \\theta_2}$。将 $\\theta_1$ 的方程除以 $\\theta_2$ 的方程得到 $k_2^2 = \\theta_1 / \\theta_2$，因此 $k_2 = \\sqrt{\\theta_1 / \\theta_2}$。由于每一对 $\\theta_1 > 0, \\theta_2 > 0$ 的 $(\\theta_1, \\theta_2)$ 都映射到一对唯一的 $k_1 > 0, k_2 > 0$ 的 $(k_1, k_2)$，因此该映射是一一对应的。\n\n这个构造成功地将模型参数相对于给定的可观测量 $g$ 分离为一个可辨识部分 $\\theta_1$ 和一个不可辨识部分 $\\theta_2$。\n\n最后一个问题要求给出可辨识参数 $\\theta_1$ 作为 $k_1$ 和 $k_2$ 函数的显式表达式。根据我们的定义，该表达式为：\n$$\n\\theta_1 = k_1 k_2\n$$", "answer": "$$\\boxed{k_1 k_2}$$", "id": "2660969"}, {"introduction": "在识别出参数不可辨识性或松散性之后，一个自然而然的问题是：我们能做些什么来改善它？本练习将引导您从被动的分析转向主动的实验设计。您将学习如何应用最优实验设计（Optimal Experimental Design, OED）的理念，通过编程来选择一组最佳的采样时间点，以最大化费雪信息矩阵的最小特征值（即所谓的 E-最优性）。这项任务不仅能让您深入理解 FIM 的实际用途，也体现了可辨识性分析在指导科学研究以获取最大信息量方面的强大威力。[@problem_id:2661040]", "problem": "给定一个标量输出动力学模型，用于描述一个单步不可逆的趋于平衡过程，该过程由函数 $y(t) = A\\bigl(1 - e^{-k t}\\bigr)$ 描述，其中 $A$ 和 $k$ 是未知的正参数，分别代表振幅和一级反应速率常数。观测值遵循模型 $y_i = y(t_i; A, k) + \\varepsilon_i$，其中噪声项 $\\varepsilon_i$ 是独立同分布的高斯随机变量，均值为 $0$，方差为 $\\sigma^2$（即 $\\varepsilon_i \\sim \\mathcal{N}(0,\\sigma^2)$）。采样时间 $t_i$ 可以在样本数量的约束下进行选择。\n\n您的任务是设计一个程序，针对下面指定的每个测试用例，在给定的标称参数对 $(A_0, k_0)$ 下，选择一组采样时间，以最大化参数矢量 $\\theta = (A,k)$ 的费雪信息矩阵（FIM）的最小特征值。待最大化的设计准则为最小特征值（通常称为 $E$-最优设计目标），这是一个标准的方法，通过改善标称参数处期望对数似然函数的最差曲率方向来避免参数马虎性。\n\n使用的基本原理：\n- 测量模型 $y(t; A, k) = A\\bigl(1 - e^{-k t}\\bigr)$。\n- 独立高斯噪声，方差为 $\\sigma^2$。\n- 高斯噪声下独立观测的费雪信息矩阵，其定义与模型对 $\\theta = (A, k)$ 的灵敏度有关。\n\n设计约束和离散化：\n- 您必须从开闭区间 $(0,T]$ 上的一个包含 $M$ 个点的均匀网格中，精确选择 $N$ 个不同的采样时间。网格点为 $t_j = \\frac{j}{M} T$，其中 $j = 1, 2, \\dots, M$（注意 $t = 0$ 被排除）。\n- 样本必须按非递减顺序报告（因为时间是不同的，所以是严格递增的）。\n- 单位：所有时间以秒为单位报告，四舍五入到三位小数。\n- 平局处理：如果多组采样时间实现了相同的目标值（在目标值的 $10^{-12}$ 容差范围内），请选择字典序最小的时间序列（先比较第一个时间，然后是第二个，以此类推）。\n- 费雪信息矩阵必须在所提供的标称参数值 $(A_0, k_0)$ 和噪声方差 $\\sigma^2$ 下计算。\n\n计算内容：\n- 对每个测试用例，计算 $E$-最优采样方案，即最大化费雪信息矩阵最小特征值的那组 $N$ 个网格时间。\n\n测试套件：\n- 情况 1：$A_0 = 1.0$， $k_0 = 0.5\\,\\mathrm{s}^{-1}$， $\\sigma^2 = 1.0$， $T = 10.0\\,\\mathrm{s}$， $N = 2$， $M = 40$。\n- 情况 2：$A_0 = 2.0$， $k_0 = 1.0\\,\\mathrm{s}^{-1}$， $\\sigma^2 = 0.5$， $T = 5.0\\,\\mathrm{s}$， $N = 3$， $M = 50$。\n- 情况 3：$A_0 = 1.0$， $k_0 = 0.3\\,\\mathrm{s}^{-1}$， $\\sigma^2 = 2.0$， $T = 8.0\\,\\mathrm{s}$， $N = 1$， $M = 80$。\n- 情况 4：$A_0 = 0.5$， $k_0 = 0.2\\,\\mathrm{s}^{-1}$， $\\sigma^2 = 1.0$， $T = 20.0\\,\\mathrm{s}$， $N = 3$， $M = 40$。\n- 情况 5：$A_0 = 1.0$， $k_0 = 2.0\\,\\mathrm{s}^{-1}$， $\\sigma^2 = 0.1$， $T = 2.0\\,\\mathrm{s}$， $N = 2$， $M = 40$。\n\n答案规格：\n- 此问题不涉及角度单位。\n- 物理单位：输出采样时间单位为秒，每个值四舍五入到三位小数。\n- 最终输出格式：您的程序应生成单行输出，包含一个用方括号括起来的逗号分隔列表，其中每个测试用例的结果本身是一个用方括号括起来的、由所选采样时间（单位为秒）组成的逗号分隔列表。例如，如果有两个案例，最优时间分别为 $[1.250, 3.000]$ 和 $[0.750]$，则输出应是这样的一行：\n[ [1.250,3.000],[0.750] ]\n对于包含五个测试用例的本问题，您的程序必须精确打印一行，其中包含一个由五个列表组成的列表，顺序与上述测试套件相同，且无额外文本。\n\n注意：\n- 您必须根据给定的基本定义推导出此模型的费雪信息矩阵，并在计算中使用它。\n- 确保科学真实性：所有计算必须在所提供的标称值 $(A_0, k_0)$ 和 $\\sigma^2$ 下进行。最优设计必须在每个测试用例的 $\\binom{M}{N}$ 个网格子集中进行搜索。", "solution": "所呈现的问题是参数估计领域中针对非线性动态模型进行最优实验设计的经典练习。我们的任务是选择一组最优的采样时间，以便最好地识别动力学模型的参数，这是化学动力学和系统生物学中的一个常见挑战。最优性的标准是最大化费雪信息矩阵（FIM）的最小特征值，这被称为E-最优性。该准则旨在最小化参数置信椭球的长轴长度，从而改善参数的最差情况下的可估计性。问题是适定的、有科学依据的，并为严谨的求解提供了所有必要信息。\n\n解决方案主要分为两个阶段：首先，推导所需的数学对象，即费雪信息矩阵；其次，制定和执行一个计算算法，用于在设计空间中搜索最优的采样时间集合。\n\n**1. 费雪信息矩阵 (FIM)**\n\n在时间 $t$ 的单次观测模型由 $y(t) = A\\bigl(1 - e^{-k t}\\bigr)$ 给出。在时间 $t_i$ 的测量值 $y_i$ 受到独立同分布的高斯噪声 $\\varepsilon_i \\sim \\mathcal{N}(0,\\sigma^2)$ 的影响。参数矢量为 $\\theta = (A, k)$。\n\n对于这种具有独立同分布高斯噪声的模型，在时间点 $\\{t_1, t_2, \\dots, t_N\\}$ 进行的 $N$ 次观测的FIM是一个 $2 \\times 2$ 矩阵，由下式给出：\n$$\nF(\\theta) = \\frac{1}{\\sigma^2} \\sum_{i=1}^N \\mathbf{s}(t_i; \\theta) \\mathbf{s}(t_i; \\theta)^T\n$$\n其中 $\\mathbf{s}(t_i; \\theta)$ 是模型输出关于参数的灵敏度矢量，在时间 $t_i$ 进行评估。该矢量的分量是模型函数 $y(t; \\theta)$ 对每个参数的偏导数。\n\n让我们计算这些灵敏度：\n第一个参数是 $\\theta_1 = A$。其灵敏度为：\n$$\ns_A(t) = \\frac{\\partial y(t; A, k)}{\\partial A} = \\frac{\\partial}{\\partial A} \\left[ A(1 - e^{-kt}) \\right] = 1 - e^{-kt}\n$$\n第二个参数是 $\\theta_2 = k$。其灵敏度为：\n$$\ns_k(t) = \\frac{\\partial y(t; A, k)}{\\partial k} = \\frac{\\partial}{\\partial k} \\left[ A(1 - e^{-kt}) \\right] = A \\frac{\\partial}{\\partial k} ( -e^{-kt} ) = At e^{-kt}\n$$\n因此，灵敏度矢量为 $\\mathbf{s}(t; A, k) = [1 - e^{-kt}, At e^{-kt}]^T$。\n\nFIM是这些灵敏度矢量外积的和。对于一组 $N$ 个测量时间 $\\{t_i\\}$，在标称参数 $\\theta_0 = (A_0, k_0)$ 和噪声方差 $\\sigma^2$ 下评估的FIM元素为：\n$$\nF_{11} = \\frac{1}{\\sigma^2} \\sum_{i=1}^N \\left(1 - e^{-k_0 t_i}\\right)^2\n$$\n$$\nF_{12} = F_{21} = \\frac{1}{\\sigma^2} \\sum_{i=1}^N \\left(1 - e^{-k_0 t_i}\\right) (A_0 t_i e^{-k_0 t_i})\n$$\n$$\nF_{22} = \\frac{1}{\\sigma^2} \\sum_{i=1}^N \\left(A_0 t_i e^{-k_0 t_i}\\right)^2\n$$\n得到的FIM是-对称矩阵 $F = \\begin{pmatrix} F_{11} & F_{12} \\\\ F_{21} & F_{22} \\end{pmatrix}$。请注意，$1/\\sigma^2$ 项是整个矩阵的公共标量因子。由于我们是在最大化一个特征值，而当矩阵被缩放为 $\\alpha M$ 时，矩阵 $M$ 的特征值也会被缩放一个因子 $\\alpha$，所以这个常数会缩放目标函数，但不会改变最优点的位置。然而，为了确保正确性，必须包含它。\n\n**2. 目标函数和优化策略**\n\n目标是最大化FIM的最小特征值 $\\lambda_{\\min}(F)$。对于一个通用的 $2 \\times 2$ 对称矩阵 $F = \\begin{pmatrix} a & b \\\\ b & c \\end{pmatrix}$，特征值是特征多项式 $\\det(F - \\lambda I) = 0$ 的根，由下式给出：\n$$\n\\lambda = \\frac{(a+c) \\pm \\sqrt{(a-c)^2 + 4b^2}}{2}\n$$\n因此，最小特征值为：\n$$\n\\lambda_{\\min}(F) = \\frac{(F_{11} + F_{22}) - \\sqrt{(F_{11} - F_{22})^2 + 4F_{12}^2}}{2}\n$$\n我们的任务是从离散网格 $t_j = \\frac{j}{M} T$（其中 $j \\in \\{1, \\dots, M\\}$）中选择 $N$ 个不同的时间点，以最大化此值。\n\n从 $M$ 个点的网格中选择 $N$ 个时间点的方法数由二项式系数 $\\binom{M}{N}$ 给出。对于测试用例中指定的 $M$ 和 $N$ 的值，这个数字在计算上是可行的。例如，最大的案例需要检查 $\\binom{50}{3} = 19600$ 种组合。因此，直接的穷举搜索是一种可行且能保证最优的策略。\n\n每个测试用例的算法如下：\n1.  生成包含 $M$ 个可能采样时间的网格。\n2.  从该网格生成所有 $N$ 个采样时间的唯一组合。\n3.  初始化一个变量用于存储观测到的最大最小特征值 $\\lambda_{\\text{best}} \\leftarrow -1.0$，以及一个变量用于存储相应的时间集 $t_{\\text{best}}$。\n4.  遍历每一种时间组合：\n    a. 对于当前组合，通过对每个时间点的贡献求和来计算FIM元素 $F_{11}, F_{12}, F_{22}$。\n    b. 构建FIM并计算其最小特征值 $\\lambda_{\\text{current}}$。\n    c. 如果 $\\lambda_{\\text{current}}$ 比 $\\lambda_{\\text{best}}$ 大超过指定的容差（$10^{-12}$），则更新 $\\lambda_{\\text{best}} \\leftarrow \\lambda_{\\text{current}}$ 并将 $t_{\\text{best}}$ 更新为当前时间集。\n5.  平局处理规则规定，如果多个集合产生相同的最大特征值（在容差范围内），则应选择字典序最小的序列。通过遍历由标准库函数生成的组合（通常按字典序生成），并且仅在有严格改进时（即 `new > old + tolerance`）才进行更新，这个条件会自动得到满足。第一个达到最大值的组合将是字典序最小的。\n\n**3. 对 $N=1$ 特殊情况的分析**\n\n在情况3中，$N=1$，出现了一个关键细节。待估计的参数数量为 $p=2$（即 $A$ 和 $k$）。要使FIM为满秩（即可逆，所有特征值非零），需要至少在 $p$ 个时间点进行测量，且这些时间点的灵敏度矢量是线性无关的。\n\n对于 $N=1$，FIM是单个灵敏度矢量的外积，$F = \\frac{1}{\\sigma^2} \\mathbf{s}(t_1) \\mathbf{s}(t_1)^T$。这是一个 $2 \\times 2$ 的秩为1的矩阵（假设灵敏度矢量非零，这对于 $t>0$ 是成立的）。秩为1的矩阵有一个非零特征值和 $p-1=1$ 个零特征值。因此，对于任何单个采样时间 $t_1$ 的选择，FIM的最小特征值都是 $\\lambda_{\\min}(F) = 0$。\n\n目标函数在整个设计空间中是常数（零）。优化问题变得微不足道。根据问题的平局处理规则，我们必须选择字典序最小的时间序列。对于 $N=1$，这对应于网格上可用的单个最小时间点，即 $t_1 = T/M$。这个案例测试了对FIM性质的基本理解。\n\n通过实施这一逻辑，我们为所有给定的测试用例提供了稳健的解决方案。", "answer": "```python\nimport numpy as np\nimport itertools\n\ndef solve():\n    \"\"\"\n    Solves for the E-optimal experimental design for a set of kinetic model test cases.\n\n    For each case, it finds the set of N sampling times from a discrete grid that\n    maximizes the smallest eigenvalue of the Fisher Information Matrix (FIM).\n    \"\"\"\n\n    test_cases = [\n        # (A0, k0, sigma^2, T, N, M)\n        {'A0': 1.0, 'k0': 0.5, 'sigma2': 1.0, 'T': 10.0, 'N': 2, 'M': 40},\n        {'A0': 2.0, 'k0': 1.0, 'sigma2': 0.5, 'T': 5.0, 'N': 3, 'M': 50},\n        {'A0': 1.0, 'k0': 0.3, 'sigma2': 2.0, 'T': 8.0, 'N': 1, 'M': 80},\n        {'A0': 0.5, 'k0': 0.2, 'sigma2': 1.0, 'T': 20.0, 'N': 3, 'M': 40},\n        {'A0': 1.0, 'k0': 2.0, 'sigma2': 0.1, 'T': 2.0, 'N': 2, 'M': 40},\n    ]\n\n    all_results = []\n    \n    TOLERANCE = 1e-12\n\n    for case in test_cases:\n        A0 = case['A0']\n        k0 = case['k0']\n        sigma2 = case['sigma2']\n        T = case['T']\n        N = case['N']\n        M = case['M']\n\n        # Generate the grid of possible sampling times\n        time_grid = np.linspace(T/M, T, M)\n\n        # Special case: N < number of parameters (p=2)\n        # The FIM will be rank-deficient, so the smallest eigenvalue is always 0.\n        # By the tie-breaking rule, we must choose the lexicographically smallest sequence.\n        if N < 2:\n            # For N=1, this is the smallest time point.\n            best_times = (time_grid[0],)\n        else:\n            best_min_eig = -1.0\n            best_times = None\n\n            # Pre-calculate sensitivities for all grid points to speed up the loop\n            s_A = 1.0 - np.exp(-k0 * time_grid)\n            s_k = A0 * time_grid * np.exp(-k0 * time_grid)\n\n            # Map sensitivities to their time grid index\n            sens_map = {i: (s_A[i], s_k[i]) for i in range(M)}\n\n            # Generate all combinations of N indices from the grid\n            indices = range(M)\n            for time_indices in itertools.combinations(indices, N):\n                f11, f12, f22 = 0.0, 0.0, 0.0\n                \n                for index in time_indices:\n                    sa, sk = sens_map[index]\n                    f11 += sa**2\n                    f12 += sa * sk\n                    f22 += sk**2\n                \n                # Construct the FIM (including the 1/sigma^2 factor)\n                fim = (1.0 / sigma2) * np.array([[f11, f12], [f12, f22]])\n\n                # Calculate eigenvalues for the symmetric matrix\n                eigenvalues = np.linalg.eigvalsh(fim)\n                min_eig = eigenvalues[0]\n\n                # Update best result if a significantly better one is found.\n                # `itertools.combinations` generates tuples in lexicographical order,\n                # so the first combination that achieves the max value will be the\n                # lexicographically smallest one, satisfying the tie-breaker.\n                if min_eig > best_min_eig + TOLERANCE:\n                    best_min_eig = min_eig\n                    best_times = tuple(time_grid[i] for i in time_indices)\n\n        # Format the result for the current test case\n        formatted_times = [f\"{t:.3f}\" for t in best_times]\n        result_str = f\"[{','.join(formatted_times)}]\"\n        all_results.append(result_str)\n\n    # Print the final output in the required format\n    print(f\"[{','.join(all_results)}]\")\n\nsolve()\n\n```", "id": "2661040"}]}