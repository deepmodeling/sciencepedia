{"hands_on_practices": [{"introduction": "本节的第一个练习将通过最简单的化学系统——生灭过程——来探究确定性模型和随机模型之间最根本的区别。我们将从化学主方程出发，推导出系统内禀涨落的精确方差，并将其与确定性速率方程模型预测的（不存在的）方差进行比较。这个练习将清晰地揭示确定性模型在捕捉分子数量的内禀涨落方面的根本性失败 [@problem_id:2629136]。", "problem": "考虑单物种生灭反应网络\n- 生成：$\\varnothing \\xrightarrow{\\ \\alpha\\ } A$，倾向为 $a_{+}(n_A)=\\alpha$，\n- 消亡：$A \\xrightarrow{\\ \\beta\\ } \\varnothing$，倾向为 $a_{-}(n_A)=\\beta\\,n_A$，\n\n其中 $n_A \\in \\{0,1,2,\\dots\\}$ 是物种 $A$ 的分子数，$\\alpha>0$ 和 $\\beta>0$ 是恒定速率参数。在充分混合、恒定体积极限下，使用化学主方程进行描述。\n\n1. 从适用于任意测试函数 $f(n_A)$ 的主方程恒等式\n$$\n\\frac{d}{dt}\\langle f(n_A)\\rangle \\;=\\; \\left\\langle \\alpha\\big(f(n_A+1)-f(n_A)\\big) \\;+\\; \\beta n_A\\big(f(n_A-1)-f(n_A)\\big) \\right\\rangle,\n$$\n出发，推导精确的稳态均值 $\\langle n_A\\rangle$ 和方差 $\\operatorname{Var}(n_A)$。\n\n2. 现在，通过忽略涨落并将所有随机矩替换为均值的乘积，构建最低阶平均场（确定性）闭合。在此闭合中，唯一的动力学变量是均值 $m(t)=\\langle n_A(t)\\rangle$，它满足确定性速率方程 $dm/dt=\\alpha-\\beta m$，且更高阶的中心矩被视为零。使用此闭合，确定其预测的稳态方差，记为 $\\operatorname{Var}_{\\mathrm{mf}}(n_A)$。\n\n3. 将平均场闭合对稳态方差的相对误差定义为\n$$\n\\varepsilon\\!\\left(\\frac{\\alpha}{\\beta}\\right)\\;=\\;\\frac{\\left|\\operatorname{Var}_{\\mathrm{mf}}(n_A)-\\operatorname{Var}(n_A)\\right|}{\\operatorname{Var}(n_A)}.\n$$\n对于由 $\\alpha/\\beta\\in[1,10]$ 指定的低分子数区域，确定 $\\varepsilon(\\alpha/\\beta)$ 在此区间上的上确界（即最坏情况值）。最终答案以无单位的纯数表示。无需四舍五入。", "solution": "所述问题具有科学依据、提法恰当且内容自洽。它提出了随机化学动力学领域一个标准的可解问题，比较了精确的随机描述与确定性近似。问题中没有矛盾、歧义或事实错误。因此，我们将着手解答此问题。\n\n问题分为三个部分。我们将依次解答每一部分。\n\n第1部分：精确的稳态均值和方差\n\n给定任意测试函数 $f(n_A)$ 的期望值随时间演化的主方程恒等式：\n$$\n\\frac{d}{dt}\\langle f(n_A)\\rangle \\;=\\; \\left\\langle \\alpha\\big(f(n_A+1)-f(n_A)\\big) \\;+\\; \\beta n_A\\big(f(n_A-1)-f(n_A)\\big) \\right\\rangle\n$$\n在稳态下，任何期望值的时间导数均为零。因此，对于任意函数 $f$，我们有：\n$$\n\\left\\langle \\alpha\\big(f(n_A+1)-f(n_A)\\big) \\;+\\; \\beta n_A\\big(f(n_A-1)-f(n_A)\\big) \\right\\rangle = 0\n$$\n\n为了求得稳态均值 $\\langle n_A \\rangle$，我们选择测试函数 $f(n_A) = n_A$。相应的差值为 $f(n_A+1)-f(n_A) = (n_A+1)-n_A = 1$ 和 $f(n_A-1)-f(n_A) = (n_A-1)-n_A = -1$。将这些代入稳态恒等式，得到：\n$$\n\\left\\langle \\alpha(1) + \\beta n_A(-1) \\right\\rangle = 0\n$$\n$$\n\\langle \\alpha - \\beta n_A \\rangle = 0\n$$\n根据期望算符的线性性，上式变为：\n$$\n\\alpha - \\beta \\langle n_A \\rangle = 0\n$$\n解出均值，我们得到：\n$$\n\\langle n_A \\rangle = \\frac{\\alpha}{\\beta}\n$$\n\n为了求得稳态方差 $\\operatorname{Var}(n_A) = \\langle n_A^2 \\rangle - \\langle n_A \\rangle^2$，我们必须首先计算二阶矩 $\\langle n_A^2 \\rangle$。我们选择测试函数 $f(n_A) = n_A^2$。相应的差值为 $f(n_A+1)-f(n_A) = (n_A+1)^2-n_A^2 = 2n_A+1$ 和 $f(n_A-1)-f(n_A) = (n_A-1)^2-n_A^2 = -2n_A+1$。将这些代入稳态恒等式：\n$$\n\\left\\langle \\alpha(2n_A+1) + \\beta n_A(-2n_A+1) \\right\\rangle = 0\n$$\n$$\n\\langle 2\\alpha n_A + \\alpha - 2\\beta n_A^2 + \\beta n_A \\rangle = 0\n$$\n利用期望的线性性：\n$$\n(2\\alpha+\\beta)\\langle n_A \\rangle + \\alpha - 2\\beta \\langle n_A^2 \\rangle = 0\n$$\n我们解出 $\\langle n_A^2 \\rangle$：\n$$\n2\\beta \\langle n_A^2 \\rangle = (2\\alpha+\\beta)\\langle n_A \\rangle + \\alpha\n$$\n代入先前求得的稳态均值 $\\langle n_A \\rangle = \\alpha/\\beta$：\n$$\n2\\beta \\langle n_A^2 \\rangle = (2\\alpha+\\beta)\\left(\\frac{\\alpha}{\\beta}\\right) + \\alpha = \\frac{2\\alpha^2}{\\beta} + \\alpha + \\alpha = \\frac{2\\alpha^2}{\\beta} + 2\\alpha\n$$\n$$\n\\langle n_A^2 \\rangle = \\frac{1}{2\\beta}\\left(\\frac{2\\alpha^2}{\\beta} + 2\\alpha\\right) = \\frac{\\alpha^2}{\\beta^2} + \\frac{\\alpha}{\\beta}\n$$\n现在我们计算方差：\n$$\n\\operatorname{Var}(n_A) = \\langle n_A^2 \\rangle - \\langle n_A \\rangle^2 = \\left(\\frac{\\alpha^2}{\\beta^2} + \\frac{\\alpha}{\\beta}\\right) - \\left(\\frac{\\alpha}{\\beta}\\right)^2 = \\frac{\\alpha}{\\beta}\n$$\n因此，精确的稳态均值和方差都等于 $\\alpha/\\beta$。这与稳态分布是参数为 $\\lambda = \\alpha/\\beta$ 的泊松分布这一已知结果相符。\n\n第2部分：平均场方差\n\n问题通过一组明确的规则定义了“最低阶平均场（确定性）闭合”：a) 忽略涨落，b) 唯一的动力学变量是均值 $m(t) = \\langle n_A(t) \\rangle$，其演化遵循 $dm/dt = \\alpha - \\beta m$，c) 更高阶的中心矩被视为零。\n这些条件描述了一个确定性模型。在确定性框架中，不存在随机性的概念。系统在任何时刻的状态都是一个单一的、明确定义的值，而不是一个概率分布。量 $n_A$ 不再是一个随机变量，而是恒等于其均值，$n_A(t) \\equiv m(t)$。\n一个量的方差衡量的是其围绕均值的离散程度或涨落。对于一个确定性的量，不存在涨落。根据定义，一个常数或一个确定性演化变量的方差为零。“更高阶的中心矩被视为零”这一条件包括了二阶中心矩，即方差。因此，该闭合预测的方差为零。\n$$\n\\operatorname{Var}_{\\mathrm{mf}}(n_A) = 0\n$$\n\n第3部分：相对误差及其上确界\n\n平均场闭合对稳态方差的相对误差 $\\varepsilon$ 定义为：\n$$\n\\varepsilon\\!\\left(\\frac{\\alpha}{\\beta}\\right) = \\frac{\\left|\\operatorname{Var}_{\\mathrm{mf}}(n_A)-\\operatorname{Var}(n_A)\\right|}{\\operatorname{Var}(n_A)}\n$$\n代入第1部分和第2部分的结果：\n- 精确方差：$\\operatorname{Var}(n_A) = \\frac{\\alpha}{\\beta}$\n- 平均场方差：$\\operatorname{Var}_{\\mathrm{mf}}(n_A) = 0$\n\n误差的表达式变为：\n$$\n\\varepsilon\\!\\left(\\frac{\\alpha}{\\beta}\\right) = \\frac{\\left|0 - \\frac{\\alpha}{\\beta}\\right|}{\\frac{\\alpha}{\\beta}}\n$$\n鉴于 $\\alpha > 0$ 且 $\\beta > 0$，项 $\\alpha/\\beta$ 严格为正。对于指定的范围 $\\alpha/\\beta \\in [1, 10]$，分母不为零。\n因此，误差简化为：\n$$\n\\varepsilon\\!\\left(\\frac{\\alpha}{\\beta}\\right) = \\frac{\\frac{\\alpha}{\\beta}}{\\frac{\\alpha}{\\beta}} = 1\n$$\n相对误差是一个值为 $1$ 的常数函数。这表明确定性模型完全无法捕捉系统的涨落。\n\n最后的任务是找出此误差函数在区间 $\\alpha/\\beta \\in [1, 10]$ 上的上确界。一个常数函数在任何区间上的上确界就是该常数值本身。\n$$\n\\sup_{\\alpha/\\beta \\in [1, 10]} \\varepsilon\\!\\left(\\frac{\\alpha}{\\beta}\\right) = \\sup_{\\alpha/\\beta \\in [1, 10]} (1) = 1\n$$\n最坏情况下的相对误差是 $1$。", "answer": "$$\\boxed{1}$$", "id": "2629136"}, {"introduction": "在第一个例子的基础上，本练习将研究一个包含非线性反应（二聚化）的系统。我们将发现，随机涨落不仅仅是在平均值周围产生分布；它实际上可以使稳态平均值本身偏离确定性模型的预测。通过本练习，你将学习使用线性噪声近似 (Linear Noise Approximation, LNA) 和矩封闭 (moment-closure) 等强大工具来估算这种随机校正 [@problem_id:2629190]。", "problem": "考虑一个带有源和一阶损失的不可逆二聚化系统，\n$$\\varnothing \\xrightarrow{k_{0}} A,\\quad A \\xrightarrow{k_{1}} \\varnothing,\\quad A + A \\xrightarrow{k_{2}} D,$$\n在一个体积为 $\\,\\Omega = 1 \\,\\mathrm{fL} = 1 \\times 10^{-15}\\,\\mathrm{L}\\,$ 的充分混合体系中。假设在介观（随机）尺度上遵循质量作用动力学，并采用标准系统尺寸归一化：倾向函数为\n$$a_{1}(n_{A}) = k_{0}\\,\\Omega,\\quad a_{2}(n_{A}) = k_{1}\\,n_{A},\\quad a_{3}(n_{A}) = \\frac{k_{2}}{\\Omega}\\,n_{A}(n_{A}-1),$$\n且对 $n_{A}$ 的化学计量变化为 $\\nu_{1}=+1$, $\\nu_{2}=-1$, $\\nu_{3}=-2$。速率常数为\n$$k_{0} = 3.5 \\times 10^{14}\\,\\mathrm{(molecules)/(L \\cdot s)},\\quad k_{1} = 1.0 \\times 10^{-3}\\,\\mathrm{s}^{-1},\\quad k_{2} = 1.6 \\times 10^{-18}\\,\\mathrm{L/(molecule \\cdot s)}.$$\n\n仅从上述化学主方程 (CME) 定义和质量作用定律出发，完成以下任务。\n\n1) 推导物种 A 浓度 $a(t)$ 的确定性速率方程，并以闭合形式求解其正稳态 $a^{\\ast}$。将其转换为确定性稳态分子数预测值 $n_{\\mathrm{det}} = \\Omega\\,a^{\\ast}$。\n\n2) 在确定性不动点附近对化学朗之万方程 (CLE) 进行线性化，以获得 $n_{A}$ 涨落的一维线性噪声近似 (LNA)。通过求解线性化的奥恩斯坦-乌伦贝克过程的标量李雅普诺夫方程，计算稳态方差 $V \\equiv \\mathrm{Var}(n_{A})$。该方程用 CLE 漂移项相对于 $n_{A}$ 的雅可比矩阵 $J$ 和扩散强度 $B = \\sum_{r} \\nu_{r}^{2} a_{r}$ 来表示，所有这些量均在 $n_{\\mathrm{det}}$ 处取值。\n\n3) 使用步骤 2) 中得到的方差 $V$，通过高斯（二阶）矩闭合\n$$\\big\\langle n_{A}(n_{A}-1)\\big\\rangle \\approx \\langle n_{A}\\rangle^{2} - \\langle n_{A}\\rangle + V,$$\n对精确的一阶矩稳态方程\n$$0 = k_{0}\\,\\Omega - k_{1}\\,\\langle n_{A}\\rangle - \\frac{2k_{2}}{\\Omega}\\,\\big\\langle n_{A}(n_{A}-1)\\big\\rangle$$\n进行闭合。求解所得的二次方程，以获得稳态均值 $\\langle n_{A}\\rangle$ 的 LNA/矩闭合估计值。\n\n报告当 $\\Omega = 1 \\,\\mathrm{fL}$ 时，$\\langle n_{A}\\rangle$ 的最终数值，单位为分子。将答案四舍五入到四位有效数字。在你的推理过程中，还需陈述确定性预测值 $n_{\\mathrm{det}}$ 并讨论在低拷贝数下的偏差方向，但最终报告的值必须是你对 $\\langle n_{A}\\rangle$ 的随机估计值，以分子数表示。", "solution": "该问题要求对一个随机化学反应系统进行多步分析，从确定性近似过渡到使用线性噪声近似和矩闭合的更精确的随机估计。\n\n步骤1：确定性速率方程和稳态\n\n确定性模型描述了物种 A 浓度的演化，表示为 $a(t) = n_{A}(t)/\\Omega$，其中 $n_A$ 是 A 的分子数，$\\Omega$ 是系统体积。速率方程是通过考虑单位体积的宏观反应速率推导出来的。源反应 $\\varnothing \\rightarrow A$ 贡献项 $+k_0$。一阶损失反应 $A \\rightarrow \\varnothing$ 贡献项 $-k_1 a$。二聚化反应 $A + A \\rightarrow D$ 消耗两个 A 分子，贡献项 $-2k_2 a^2$。完整的速率方程是：\n$$ \\frac{da}{dt} = k_{0} - k_{1}a - 2k_{2}a^{2} $$\n在稳态下，$\\frac{da}{dt}=0$，这给出了稳态浓度 $a^{\\ast}$ 的一个二次方程：\n$$ 2k_{2}(a^{\\ast})^{2} + k_{1}a^{\\ast} - k_{0} = 0 $$\n求解物理上有意义的正根，得到：\n$$ a^{\\ast} = \\frac{-k_{1} + \\sqrt{k_{1}^{2} - 4(2k_{2})(-k_{0})}}{4k_{2}} = \\frac{-k_{1} + \\sqrt{k_{1}^{2} + 8k_{0}k_{2}}}{4k_{2}} $$\n稳态分子数的确定性预测值为 $n_{\\mathrm{det}} = \\Omega a^{\\ast}$。代入给定值：\n$k_{0} = 3.5 \\times 10^{14}\\,\\mathrm{(molecules)/(L \\cdot s)}$, $k_{1} = 1.0 \\times 10^{-3}\\,\\mathrm{s}^{-1}$, $k_{2} = 1.6 \\times 10^{-18}\\,\\mathrm{L/(molecule \\cdot s)}$, 以及 $\\Omega = 1 \\times 10^{-15}\\,\\mathrm{L}$。\n一个更直接计算 $n_{\\mathrm{det}}$ 的方法是使用标度化参数 $k_0' = k_0\\Omega = 0.35\\,\\mathrm{s^{-1}}$ 和 $k_2' = k_2/\\Omega = 1.6 \\times 10^{-3}\\,\\mathrm{(\\text{molecule} \\cdot s)^{-1}}$。将浓度方程乘以 $\\Omega$，我们得到关于 $n(t) = \\Omega a(t)$ 的方程：\n$ \\frac{dn}{dt} = k_0 \\Omega - k_1 n - 2 \\frac{k_2}{\\Omega} n^2 $。在稳态时，$n=n_{\\mathrm{det}}$:\n$$ 2\\left(\\frac{k_{2}}{\\Omega}\\right)n_{\\mathrm{det}}^{2} + k_{1}n_{\\mathrm{det}} - k_{0}\\Omega = 0 $$\n$$ 2(1.6 \\times 10^{-3}) n_{\\mathrm{det}}^{2} + (1.0 \\times 10^{-3})n_{\\mathrm{det}} - 0.35 = 0 $$\n$$ 0.0032\\,n_{\\mathrm{det}}^{2} + 0.001\\,n_{\\mathrm{det}} - 0.35 = 0 $$\n求解正根：\n$$ n_{\\mathrm{det}} = \\frac{-0.001 + \\sqrt{(0.001)^{2} - 4(0.0032)(-0.35)}}{2(0.0032)} = \\frac{-0.001 + \\sqrt{0.000001 + 0.00448}}{0.0064} \\approx 10.303 $$\n确定性预测值为 $n_{\\mathrm{det}} \\approx 10.30$ 分子。\n\n步骤2：线性噪声近似和稳态方差\n\n化学朗之万方程 (CLE) 将分子数 $n_{A}(t)$ 的演化描述为一个随机微分方程：\n$$ dn_{A} = A(n_{A})dt + \\sqrt{B(n_{A})}dW(t) $$\n漂移项 $A(n_{A})$ 是由倾向函数加权的化学计量变化之和：\n$$ A(n_{A}) = \\sum_{r=1}^{3} \\nu_{r}a_{r}(n_{A}) = (+1)k_{0}\\Omega + (-1)k_{1}n_{A} + (-2)\\frac{k_{2}}{\\Omega}n_{A}(n_{A}-1) $$\n$$ A(n_{A}) = k_{0}\\Omega - k_{1}n_{A} - \\frac{2k_{2}}{\\Omega}n_{A}(n_{A}-1) $$\n扩散项强度 $B(n_{A})$ 是由倾向函数加权的化学计量变化平方之和：\n$$ B(n_{A}) = \\sum_{r=1}^{3} \\nu_{r}^{2}a_{r}(n_{A}) = (+1)^{2}k_{0}\\Omega + (-1)^{2}k_{1}n_{A} + (-2)^{2}\\frac{k_{2}}{\\Omega}n_{A}(n_{A}-1) $$\n$$ B(n_{A}) = k_{0}\\Omega + k_{1}n_{A} + \\frac{4k_{2}}{\\Omega}n_{A}(n_{A}-1) $$\n线性噪声近似 (LNA) 在确定性不动点 $n_{\\mathrm{det}}$ 附近对 CLE 进行线性化。涨落 $\\xi = n_{A} - n_{\\mathrm{det}}$ 的动力学由一个奥恩斯坦-乌伦贝克过程 $d\\xi = J\\xi dt + \\sqrt{B}dW$ 近似，其中雅可比矩阵 $J$ 和扩散系数 $B$ 是在 $n_{\\mathrm{det}}$ 处取值的常数。\n雅可比矩阵是漂移项的导数：\n$$ J = \\frac{dA}{dn_{A}}\\bigg|_{n_{A}=n_{\\mathrm{det}}} = -k_{1} - \\frac{2k_{2}}{\\Omega}(2n_{\\mathrm{det}}-1) $$\n使用 $n_{\\mathrm{det}} \\approx 10.303$，$k_{1}=0.001$ 以及 $k_2/\\Omega=0.0016$：\n$$ J \\approx -0.001 - 2(0.0016)(2(10.303)-1) = -0.001 - 0.0032(19.606) \\approx -0.06374 $$\n扩散系数在 $n_{\\mathrm{det}}$ 处取值：\n$$ B = B(n_{\\mathrm{det}}) = k_{0}\\Omega + k_{1}n_{\\mathrm{det}} + \\frac{4k_{2}}{\\Omega}n_{\\mathrm{det}}(n_{\\mathrm{det}}-1) $$\n使用 $k_0 \\Omega = 0.35$ 和其他值：\n$$ B \\approx 0.35 + (0.001)(10.303) + 4(0.0016)(10.303)(9.303) \\approx 0.35 + 0.0103 + 0.6134 \\approx 0.9737 $$\nLNA 过程的稳态方差 $V = \\mathrm{Var}(n_A)$ 遵循标量李雅普诺夫方程 $2JV + B = 0$，可得：\n$$ V = -\\frac{B}{2J} \\approx -\\frac{0.9737}{2(-0.06374)} \\approx 7.638 $$\n\n步骤3：矩闭合和随机均值\n\n均值 $\\langle n_A \\rangle$ 随时间演化的精确方程由 CME 推导得出：\n$$ \\frac{d\\langle n_A \\rangle}{dt} = \\langle A(n_A) \\rangle = k_{0}\\Omega - k_{1}\\langle n_A \\rangle - \\frac{2k_2}{\\Omega}\\langle n_A(n_A-1) \\rangle $$\n在稳态下，$\\frac{d\\langle n_A \\rangle}{dt} = 0$。问题给出了二阶（高斯）矩闭合近似：\n$$ \\langle n_A(n_A-1) \\rangle \\approx \\langle n_A \\rangle^2 - \\langle n_A \\rangle + V $$\n其中 $V$ 是从 LNA 计算出的方差。将此代入稳态矩方程，得到关于 $x = \\langle n_A \\rangle$ 的一个闭合方程：\n$$ 0 = k_0\\Omega - k_1 x - \\frac{2k_2}{\\Omega}(x^2 - x + V) $$\n整理成标准二次方程形式 $Ax^2+Bx+C=0$：\n$$ \\left(\\frac{2k_2}{\\Omega}\\right)x^2 + \\left(k_1 - \\frac{2k_2}{\\Omega}\\right)x - \\left(k_0\\Omega - \\frac{2k_2}{\\Omega}V\\right) = 0 $$\n代入数值：$k_0 \\Omega = 0.35$, $k_1 = 0.001$, $k_2/\\Omega=0.0016$ 及 $V \\approx 7.638$。\n$$ (2 \\times 0.0016)x^2 + (0.001 - 2 \\times 0.0016)x - (0.35 - 2 \\times 0.0016 \\times 7.638) = 0 $$\n$$ 0.0032\\,x^2 - 0.0022\\,x - (0.35 - 0.02444) = 0 $$\n$$ 0.0032\\,x^2 - 0.0022\\,x - 0.32556 = 0 $$\n求解正根 $x = \\langle n_A \\rangle$:\n$$ \\langle n_A \\rangle = \\frac{-(-0.0022) + \\sqrt{(-0.0022)^2 - 4(0.0032)(-0.32556)}}{2(0.0032)} $$\n$$ \\langle n_A \\rangle = \\frac{0.0022 + \\sqrt{4.84 \\times 10^{-6} + 0.004167}}{0.0064} = \\frac{0.0022 + \\sqrt{0.004172}}{0.0064} \\approx \\frac{0.0022 + 0.06459}{0.0064} \\approx 10.436 $$\n四舍五入到四位有效数字，稳态均值的随机估计值为 $\\langle n_A \\rangle \\approx 10.44$ 分子。\n\n随机均值 $\\langle n_A \\rangle \\approx 10.44$ 高于确定性预测值 $n_{\\mathrm{det}} \\approx 10.30$。这种偏差是低拷贝数下非线性反应系统的特征。差异的产生是因为确定性模型用平均值的函数来近似非线性函数的平均值，即 $\\langle n_A^2 \\rangle \\approx \\langle n_A \\rangle^2$。随机分析对此进行了修正。二聚化反应的平均速率取决于 $\\langle n_A(n_A-1) \\rangle = \\langle n_A \\rangle^2 - \\langle n_A \\rangle + V$。而确定性速率则有效地取决于 $n_{\\mathrm{det}}^2$。对速率二次部分的修正近似为 $V - \\langle n_A \\rangle$。对于本系统，$V \\approx 7.64$ 且 $\\langle n_A \\rangle \\approx 10.44$，因此修正是负的。这意味着实际的平均二聚化速率低于简单确定性模型对相同分子数的预测值。因此，为了平衡恒定的产生速率，系统必须维持一个更高的平均分子数。", "answer": "$$\\boxed{10.44}$$", "id": "2629190"}, {"introduction": "我们的最后一个练习将超越“充分混合”的假设，探索低分子数下反应与扩散的相互作用。我们通过一个初始时反应物处于不同空间区域的模型，来计算首次反应事件的平均发生时间如何关键地依赖于扩散速率。这个计算练习表明，在确定性模型中常被忽略的空间异质性，完全可能成为化学过程的速率决定因素 [@problem_id:2629166]。", "problem": "考虑一个具有两个体积相等的充分混合体元（或称隔室）的双分子反应扩散系统。物种 $A$ 和 $B$ 仅在位于同一体元内时，通过不可逆反应 $A + B \\to C$ 发生反应，该反应遵循随机质量作用动力学。设随机速率常数为 $k$，单位为 $\\mathrm{s}^{-1}$ 每对共处分子对。每个 $A$ 或 $B$ 的分子以单分子跳跃速率 $D$（单位为 $\\mathrm{s}^{-1}$）在两个体元之间独立地进行扩散，这是一个对称跳跃过程。初始时，体元 $1$ 和 $2$ 中分别有 $n_A=(5,0)$ 个 $A$ 分子和 $n_B=(0,5)$ 个 $B$ 分子；也就是说，体元 $1$ 包含 $5$ 个 $A$ 分子和 $0$ 个 $B$ 分子，而体元 $2$ 包含 $0$ 个 $A$ 分子和 $5$ 个 $B$ 分子。初始时没有 $C$ 分子，且该过程在第一次 $A + B \\to C$ 反应发生时停止。\n\n您的任务是从第一性原理出发，计算首次反应事件的期望时间，并将其表示为扩散速率 $D$ 的函数。您必须在化学主方程（CME）框架下，将系统建模为基于每个体元中离散分子数的连续时间马尔可夫链，其中：\n- 如果体元 $1$ 中有 $x$ 个 $A$ 分子和 $y$ 个 $B$ 分子（因此体元 $2$ 中有 $5-x$ 个 $A$ 分子和 $5-y$ 个 $B$ 分子），那么总反应倾向（或风险率）为\n$$\nr(x,y) = k\\,[x\\,y + (5-x)\\,(5-y)].\n$$\n- 扩散倾向为：\n  - 对于物种 $A$：$x \\to x-1$ 的速率为 $D\\,x$， $x \\to x+1$ 的速率为 $D\\,(5-x)$。\n  - 对于物种 $B$：$y \\to y-1$ 的速率为 $D\\,y$，$y \\to y+1$ 的速率为 $D\\,(5-y)$。\n- 当反应发生时，状态被吸收（过程停止）；您需要计算从 $(x,y)=(5,0)$ 开始到这个吸收事件发生的期望时间。\n\n仅从化学主方程和连续时间马尔可夫链的核心定义出发：\n- 为瞬时状态空间 $(x,y)\\in\\{0,1,2,3,4,5\\}^2$ 构建生成元。\n- 推导期望吸收时间 $T(x,y)$ 的後向方程，其边界条件为吸收时等于零。\n- 求解得到的线性系统以获得 $T(5,0)$。\n\n使用数值 $k=0.1\\,\\mathrm{s}^{-1}$。将期望时间以秒为单位表示，结果为一个实数。\n\n测试套件：\n评估以下扩散速率（单位均为 $\\mathrm{s}^{-1}$）下首次反应事件的期望时间：\n- $D=0.0$ (边界情况),\n- $D=0.001$,\n- $D=0.05$,\n- $D=1.0$,\n- $D=50.0$.\n\n最终输出格式：\n您的程序必须计算上述五个 $D$ 值中每个值的期望时间，并生成单行输出，其中包含一个 Python 风格的列表，内含五个以秒为单位的结果，每个结果四舍五入到六位小数。如果期望时间是无穷大，则将其输出为浮点无穷大（例如， $+\\infty$ 应表示为 inf）。最终输出必须采用以下形式：\n\"[t1,t2,t3,t4,t5]\"\n其中 $t1$ 对应 $D=0.0$，$t2$ 对应 $D=0.001$，$t3$ 对应 $D=0.05$，$t4$ 对应 $D=1.0$，$t5$ 对应 $D=50.0$。", "solution": "该问题要求计算一个双体元双分子反应扩散系统中首次反应事件的期望时间。这是一个计算连续时间马尔可夫链（CTMC）中到达吸收态的平均首次穿越时间（MFPT）的经典问题。\n\n首先，我们对状态空间和动力学进行形式化。系统的状态由第一个体元中物种 $A$ 和 $B$ 的分子数定义。设 $x$ 为体元 $1$ 中 $A$ 的分子数，$y$ 为体元 $1$ 中 $B$ 的分子数。由于每个物种的总分子数是守恒的（直到发生反应），$N_A = 5$ 且 $N_B = 5$，因此体元 $2$ 中 $A$ 物种的分子数为 $5-x$，$B$ 物种的分子数为 $5-y$。因此，状态空间为 $(x,y) \\in \\{0, 1, 2, 3, 4, 5\\} \\times \\{0, 1, 2, 3, 4, 5\\}$，总共包含 $6 \\times 6 = 36$ 个离散状态。\n\n该过程是此状态空间上的一个连续时间马尔可夫链。状态之间的跃迁由扩散引起，而吸收由反应引起。这些事件的倾向（速率）如下：\n- $A$ 从体元 $1$ 扩散到 $2$：$x \\to x-1$，速率 $a_{x-1,y}(x,y) = D\\,x$。\n- $A$ 从体元 $2$ 扩散到 $1$：$x \\to x+1$，速率 $a_{x+1,y}(x,y) = D\\,(5-x)$。\n- $B$ 从体元 $1$ 扩散到 $2$：$y \\to y-1$，速率 $a_{x,y-1}(x,y) = D\\,y$。\n- $B$ 从体元 $2$ 扩散到 $1$：$y \\to y+1$，速率 $a_{x,y+1}(x,y) = D\\,(5-y)$。\n\n过程在第一次反应事件时终止（被吸收）。状态 $(x,y)$ 下的总反应速率是两个体元中反应速率的总和：\n$$ r(x,y) = k\\,x\\,y + k\\,(5-x)(5-y) $$\n这个速率 $r(x,y)$ 是从状态 $(x,y)$ 被吸收的速率。\n\n设 $T(x,y)$ 为在系统初始状态为 $(x,y)$ 的条件下，到第一次反应（吸收）的期望时间。我们可以使用针对 MFPT 的 Kolmogorov 後向方程推导出一组关于 $T(x,y)$ 的线性方程。对于任何瞬时态 $i$，期望时间 $T_i$ 满足以下关系：\n$$ -1 = \\sum_{j} Q_{ij} T_j $$\n其中 $Q$ 是该过程的生成元矩阵。在我们的情境中，状态是 $(x,y)$，$Q$ 是瞬时过程的生成元。$Q$ 的元素是：\n$Q_{(x,y) \\to (x',y')}$ 是从 $(x,y)$ 到另一不同状态 $(x',y')$ 的跃迁速率。这些就是扩散倾向。\n$Q_{(x,y) \\to (x,y)}$ 是离开状态 $(x,y)$ 的总速率的负值，该速率包括扩散和反应。\n离开状态 $(x,y)$ 的总速率为 $\\lambda(x,y)$：\n$$ \\lambda(x,y) = \\left( \\sum_{(x',y') \\neq (x,y)} a_{(x',y')}(x,y) \\right) + r(x,y) $$\n$$ \\lambda(x,y) = D\\,x + D\\,(5-x) + D\\,y + D\\,(5-y) + k[xy + (5-x)(5-y)] $$\n$$ \\lambda(x,y) = 10D + k[xy + (5-x)(5-y)] $$\n生成元的对角元素是 $Q_{(x,y)\\to(x,y)} = -\\lambda(x,y)$。\n\n因此，$T(x,y)$ 的後向方程为：\n$$ -1 = -\\lambda(x,y) T(x,y) + D\\,x\\,T(x-1,y) + D\\,(5-x)\\,T(x+1,y) + D\\,y\\,T(x,y-1) + D\\,(5-y)\\,T(x,y+1) $$\n在此，如果一个状态超出了定义的状态空间边界（例如 $x<0$ 或 $x>5$），我们取 $T(\\cdot,\\cdot)=0$。\n重新整理此方程，我们得到一个线性系统：\n$$ \\lambda(x,y) T(x,y) - D\\,x\\,T(x-1,y) - D\\,(5-x)\\,T(x+1,y) - D\\,y\\,T(x,y-1) - D\\,(5-y)T(x,y+1) = 1 $$\n这个系统必须对我们 $36$ 个状态空间中的每一个状态 $(x,y)$ 都成立。这可以表示为矩阵形式 $A \\mathbf{T} = \\mathbf{1}$，其中 $\\mathbf{T}$ 是包含 $36$ 个未知值 $T(x,y)$ 的列向量，$\\mathbf{1}$ 是一个全为一的列向量，$A$ 是一个 $36 \\times 36$ 的系数矩阵。\n如果我们使用单一索引 $i = 6x+y$ 对状态 $(x,y)$ 进行排序，矩阵 $A$ 的元素如下：\n- 对角元素：$A_{i,i} = \\lambda(x,y) = 10D + k[xy + (5-x)(5-y)]$。\n- 对于 $i = 6x+y$ 的非对角元素：\n  - $x > 0$ 时，$A_{i, 6(x-1)+y} = -D\\,x$。\n  - $x < 5$ 时，$A_{i, 6(x+1)+y} = -D\\,(5-x)$。\n  - $y > 0$ 时，$A_{i, 6x+(y-1)} = -D\\,y$。\n  - $y < 5$ 时，$A_{i, 6x+(y+1)} = -D\\,(5-y)$。\n  - 所有其他非对角元素均为 $0$。\n\n我们必须对给定的 $D$ 值和 $k=0.1\\,\\mathrm{s}^{-1}$ 求解这个线性系统。初始状态是 $(x,y)=(5,0)$，对应索引 $i = 6 \\cdot 5 + 0 = 30$。我们需要求解 $T(5,0)$。\n\n考虑 $D=0.0\\,\\mathrm{s}^{-1}$ 的特殊情况。\n当 $D=0$ 时，没有扩散。各个状态是解耦的。矩阵 $A$ 变成对角矩阵，其元素为 $A_{i,i} = \\lambda(x,y) = r(x,y) = k[xy + (5-x)(5-y)]$。\n方程组简化为对每个状态都成立的 $r(x,y) T(x,y) = 1$。\n初始状态是 $(5,0)$。在此状态下的反应速率为 $r(5,0) = k[5 \\cdot 0 + (5-5)(5-0)] = 0$。\n关于 $T(5,0)$ 的方程是 $0 \\cdot T(5,0) = 1$，这是不可能成立的。从物理上讲，如果系统从一个反应速率为零的状态开始，并且没有机制（扩散）可以转移到其他状态，那么反应将永远不会发生。反应的期望时间是无穷大。因此，对于 $D=0$，$T(5,0) = \\infty$。在这种情况下，矩阵 $A$是奇异的，这与推论一致。\n\n对于 $D > 0$，扩散将所有状态连接起来。由于存在反应速率不为零的状态（例如 $(1,1)$，其中 $r(1,1)=k(1+16)=1.7\\,\\mathrm{s}^{-1} > 0$），任何初始状态最终都可以到达一个吸收（反应）状态。因此，对于任何 $D>0$，MFPT 都是有限的，并且矩阵 $A$将是非奇异的。\n\n我们还可以考虑 $D \\to \\infty$ 的极限情况。在此极限下，扩散远快于反应，从而形成一个充分混合的系统。每个物种的分子在两个体元之间呈二项分布。一个分子位于体元 $1$ 的概率是 $p=1/2$。$A$ 分子的数量 $x$ 服从 $\\mathrm{Binomial}(5, 1/2)$ 分布，$y$ 也是如此。平均分子数为 $\\langle x \\rangle = 5 \\cdot 1/2 = 2.5$ 和 $\\langle y \\rangle = 5 \\cdot 1/2 = 2.5$。平均反应速率为 $\\langle r \\rangle = k[\\langle x \\rangle \\langle y \\rangle + \\langle 5-x \\rangle \\langle 5-y \\rangle] = k[2.5^2 + 2.5^2] = 12.5k$。当 $k=0.1\\,\\mathrm{s}^{-1}$ 时，$\\langle r \\rangle = 1.25\\,\\mathrm{s}^{-1}$。在这个充分混合的极限下，反应的期望时间约为 $1/\\langle r \\rangle = 1/1.25 = 0.8\\,\\mathrm{s}$。我们预计 $D=50.0$ 的结果会接近这个值，因为 $D \\gg k$。\n\n为了求得精确值，我们为每个给定的 $D>0$ 构建 $36 \\times 36$ 的矩阵 $A$，形成一个全为一的向量 $\\mathbf{b}$，然后求解线性系统 $A \\mathbf{T} = \\mathbf{b}$ 以得到期望时间向量 $\\mathbf{T}$。每种情况的答案是 $\\mathbf{T}$ 中对应于初始状态 $(5,0)$ 的元素。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the expected time to the first reaction event for a bimolecular\n    reaction-diffusion system using a Continuous-Time Markov Chain model.\n    \"\"\"\n    k = 0.1  # Reaction rate constant in s^-1 per pair\n    n_total = 5  # Total number of molecules of each species A and B\n\n    # Test suite for diffusion rates D in s^-1\n    test_cases_D = [0.0, 0.001, 0.05, 1.0, 50.0]\n\n    results = []\n\n    for D in test_cases_D:\n        # Case D=0: No diffusion.\n        # Initial state is (x=5, y=0), where x is count of A in voxel 1,\n        # y is count of B in voxel 1.\n        # Reaction rate r(x,y) = k*[x*y + (5-x)*(5-y)]\n        # r(5,0) = k*[5*0 + (5-5)*(5-0)] = 0.\n        # Since the system starts in a state with zero reaction rate and cannot\n        # diffuse to any other state, the expected time to reaction is infinite.\n        if D == 0.0:\n            results.append(np.inf)\n            continue\n\n        # For D > 0, we solve the system of linear equations A*T = b,\n        # where T is the vector of expected times.\n        num_states = (n_total + 1) ** 2\n        A = np.zeros((num_states, num_states))\n        b = np.ones(num_states)\n\n        for x in range(n_total + 1):\n            for y in range(n_total + 1):\n                # Map 2D state (x,y) to 1D index i\n                i = x * (n_total + 1) + y\n\n                # Total reaction rate (absorption rate) from state (x,y)\n                r_xy = k * (x * y + (n_total - x) * (n_total - y))\n                \n                # Total diffusion rate out of state (x,y)\n                # D*x + D*(n_total-x) + D*y + D*(n_total-y) = 2 * D * n_total\n                diff_rate_total = 2 * D * n_total\n                \n                # Total exit rate (from which the main diagonal of matrix A is derived)\n                lambda_xy = diff_rate_total + r_xy\n                \n                # Diagonal element of matrix A in AT=b system\n                A[i, i] = lambda_xy\n\n                # Off-diagonal elements for diffusion transitions\n                # Transition x -> x-1 (A from voxel 1 to 2)\n                if x > 0:\n                    j = (x - 1) * (n_total + 1) + y\n                    A[i, j] = -D * x\n                \n                # Transition x -> x+1 (A from voxel 2 to 1)\n                if x  n_total:\n                    j = (x + 1) * (n_total + 1) + y\n                    A[i, j] = -D * (n_total - x)\n                    \n                # Transition y -> y-1 (B from voxel 1 to 2)\n                if y > 0:\n                    j = x * (n_total + 1) + (y - 1)\n                    A[i, j] = -D * y\n\n                # Transition y -> y+1 (B from voxel 2 to 1)\n                if y  n_total:\n                    j = x * (n_total + 1) + (y + 1)\n                    A[i, j] = -D * (n_total - y)\n\n        # Solve the linear system A * T = b for T\n        T_vector = np.linalg.solve(A, b)\n\n        # The initial state is (x=5, y=0)\n        initial_state_idx = n_total * (n_total + 1) + 0\n        expected_time = T_vector[initial_state_idx]\n        results.append(expected_time)\n\n    # Format results for final output\n    formatted_results = []\n    for t in results:\n        if t == np.inf:\n            formatted_results.append('inf')\n        else:\n            formatted_results.append(f'{t:.6f}')\n    \n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2629166"}]}