{"hands_on_practices": [{"introduction": "在分析化学反应网络中的随机现象时，我们常常面对高维度的复杂系统。为了抓住核心动力学，例如噪声诱导的相变，一个关键的理论技巧是模型降维。本练习将引导你应用准稳态近似（Quasi-Steady-State Approximation, QSSA）这一强大工具，将一个二维的化学反应网络简化为一个有效的一维 Langevin 方程，从而为分析 Kramers 逃逸率和随机共振奠定基础。掌握这种方法对于从复杂的生物化学网络中提取可分析的随机模型至关重要。[@problem_id:2659058]", "problem": "考虑一个自调控单体物种 $X$ 的反应网络，它通过一个慢步骤二聚化成 $D$。反应如下：\n1. 零级反应生成 $X$，受二聚体 $D$ 激活：$\\varnothing \\to X$，倾向为 $a_{1}(n_{d},t) = \\alpha_{0} + \\alpha_{a}\\,\\frac{n_{d}}{K + n_{d}}\\left[1 + \\epsilon \\cos(\\omega t)\\right]$，其中 $n_{d}$ 是 $D$ 的拷贝数，$\\alpha_{0} > 0$ 是基础生产速率，$\\alpha_{a} \\ge 0$ 是激活剂强度，$K > 0$ 是半激活常数，$0 \\le \\epsilon \\ll 1$ 和 $\\omega > 0$ 定义了一个弱周期性驱动。\n2. 一级反应降解 $X$：$X \\to \\varnothing$，倾向为 $a_{2}(n_{x}) = \\gamma\\, n_{x}$，其中 $n_{x}$ 是 $X$ 的拷贝数，$\\gamma > 0$ 是降解速率。\n3. 慢二聚化：$2X \\to D$，倾向为 $a_{3}(n_{x}) = k_{d}\\,\\frac{n_{x}(n_{x}-1)}{2}$，其中 $k_{d} > 0$ 很小。\n4. 慢解离：$D \\to 2X$，倾向为 $a_{4}(n_{d}) = k_{r}\\, n_{d}$，其中 $k_{r} > 0$ 很小。\n\n假设一个介观体系，其中化学主方程（CME）可以很好地被化学朗之万方程（CLE）近似，并且存在明显的时间尺度分离，即 $X$ 的生灭动力学与二聚体的形成和解离相比是快速的（$\\gamma$ 很大，$k_{d}$ 和 $k_{r}$ 很小）。在 Itô 诠释下进行计算。你的任务是：\n\na) 从倾向和化学计量出发，写出关于 $(n_{x},n_{d})$ 的二维 CLE。\n\nb) 执行准稳态近似（QSSA），通过将快速的 $X$ 动力学设置为其瞬时稳态来消去 $n_{x}$，以 $n_{d}$ 表示。在此过程中，保留解离产生的到 $X$ 的源项 $+\\,2a_{4}$，但在小比率 $k_{d}/\\gamma$ 的主导阶上忽略相对于 $\\gamma n_{x}$ 的汇项 $-\\,2a_{3}$。求解准稳态单体拷贝数 $n_{x}^{*}(n_{d},t)$，用参数和 $n_{d}, t$ 表示。\n\nc) 将 $n_{x}^{*}(n_{d},t)$ 代入慢变的 $D$ 动力学中，得到一个关于 $n_{d}(t)$ 的有效一维朗之万方程，其形式为\n$$\n\\mathrm{d} n_{d} \\;=\\; f(n_{d},t)\\,\\mathrm{d}t \\;+\\; \\sqrt{g(n_{d},t)}\\,\\mathrm{d}W_{t},\n$$\n确定漂移项 $f(n_{d},t)$ 和扩散强度项 $g(n_{d},t)$，用 $n_{d}, t$ 和参数表示。你的推导应从 CME 到 CLE 近似和时间尺度分离的第一性原理出发，并明确所使用的任何近似。\n\nd) 这个有效随机微分方程适用于 Kramers 逃逸率估计（当 $\\epsilon=0$ 时）和随机共振（SR）分析（当 $0<\\epsilon\\ll 1$ 时），因为慢坐标 $n_{d}$ 通过 $a_{1}(n_{d},t)$ 经历一个弱的、周期性调制的漂移。最后，给出由你的 QSSA 推导出的漂移项 $f(n_{d},t)$ 的显式闭式表达式。\n\n最终答案只需提供 $f(n_{d},t)$ 的简化符号表达式，用 $\\alpha_{0}, \\alpha_{a}, K, \\epsilon, \\omega, \\gamma, k_{d}, k_{r}$ 以及变量 $n_{d}$ 和 $t$ 表示。最终的方框答案中不要包含单位。如果引入了任何辅助符号，请在最终表达式中将其消去。不需要进行数值计算。", "solution": "对问题陈述进行验证。\n\n**步骤1：提取给定条件**\n- **物种和拷贝数：** 单体 $X$ ($n_x$) 和二聚体 $D$ ($n_d$)。\n- **反应网络和倾向：**\n    1. $\\varnothing \\to X$: $a_{1}(n_{d},t) = \\alpha_{0} + \\alpha_{a}\\,\\frac{n_{d}}{K + n_{d}}\\left[1 + \\epsilon \\cos(\\omega t)\\right]$\n    2. $X \\to \\varnothing$: $a_{2}(n_{x}) = \\gamma\\, n_{x}$\n    3. $2X \\to D$: $a_{3}(n_{x}) = k_{d}\\,\\frac{n_{x}(n_{x}-1)}{2}$\n    4. $D \\to 2X$: $a_{4}(n_{d}) = k_{r}\\, n_{d}$\n- **参数和约束条件：**\n    - $\\alpha_{0} > 0$ (基础生产速率)\n    - $\\alpha_{a} \\ge 0$ (激活剂强度)\n    - $K > 0$ (半激活常数)\n    - $0 \\le \\epsilon \\ll 1$ (弱驱动振幅)\n    - $\\omega > 0$ (驱动频率)\n    - $\\gamma > 0$ 很大 (降解速率)\n    - $k_{d} > 0$ 很小 (二聚化速率)\n    - $k_{r} > 0$ 很小 (解离速率)\n- **假设：**\n    - 系统处于介观体系，因此使用化学朗之万方程（CLE）作为化学主方程（CME）的近似是合理的。\n    - 时间尺度分离：$X$ 的动力学是快速的，$D$ 的动力学是慢速的。\n    - 随机微分方程的 Itô 诠释。\n    - 对于准稳态近似（QSSA），在 $n_x$ 动力学方程中，相对于 $\\gamma n_x$，项 $-2a_3$ 被忽略，但项 $+2a_4$ 被保留。\n\n**步骤2：使用提取的给定条件进行验证**\n- **科学依据：** 该问题描述了一个带有周期性外部信号的基因自调控的经典模型，这是系统生物学和非平衡统计力学中的一个标准课题。反应倾向基于质量作用动力学和 Hill 型调控，这些都是公认的原理。该问题在科学上是合理的。\n- **良态问题：** 该问题提供了一套完整的反应、参数和约束条件。任务定义清晰，涉及随机化学动力学（CLE，QSSA）的标准（尽管是高级的）技术。可以推导出所要求的漂移项的唯一解析表达式。\n- **客观性：** 该问题以精确、客观和定量的语言表述，没有任何主观性或模糊性。\n\n**步骤3：结论和行动**\n该问题是有效的。这是一个来自随机化学动力学领域的、良态的、有科学依据的问题。将提供完整的解答。\n\n**求解推导**\n\n**a) 二维化学朗之万方程**\n\n系统的状态由拷贝数向量 $\\boldsymbol{n} = (n_x, n_d)^T$ 描述。反应 1、2、3、4 引起的拷贝数变化由化学计量向量 $\\boldsymbol{s}_1 = (1, 0)^T$、$\\boldsymbol{s}_2 = (-1, 0)^T$、$\\boldsymbol{s}_3 = (-2, 1)^T$ 和 $\\boldsymbol{s}_4 = (2, -1)^T$ 给出。对每个反应通道 $j$ 使用独立的维纳过程 $\\mathrm{d}W_j$，CLE 的一般形式为：\n$$ \\mathrm{d}\\boldsymbol{n} = \\sum_{j=1}^{4} \\boldsymbol{s}_j a_j(\\boldsymbol{n}, t) \\mathrm{d}t + \\sum_{j=1}^{4} \\boldsymbol{s}_j \\sqrt{a_j(\\boldsymbol{n}, t)} \\mathrm{d}W_j $$\n对每个物种分别写出：\n对于 $n_x$：\n$$ \\mathrm{d}n_x = (a_1 - a_2 - 2a_3 + 2a_4)\\mathrm{d}t + \\sqrt{a_1}\\mathrm{d}W_1 - \\sqrt{a_2}\\mathrm{d}W_2 - 2\\sqrt{a_3}\\mathrm{d}W_3 + 2\\sqrt{a_4}\\mathrm{d}W_4 $$\n对于 $n_d$：\n$$ \\mathrm{d}n_d = (a_3 - a_4)\\mathrm{d}t + \\sqrt{a_3}\\mathrm{d}W_3 - \\sqrt{a_4}\\mathrm{d}W_4 $$\n其中，倾向 $a_j$ 是问题陈述中定义的关于 $n_x, n_d,$ 和 $t$ 的函数。\n\n**b) 对 $n_x$ 的准稳态近似 (QSSA)**\n\n由于降解速率 $\\gamma$ 很大，变量 $n_x$ 是快速变量。由于 $k_d$ 和 $k_r$ 很小，变量 $n_d$ 是慢速变量。我们执行 QSSA，假设 $n_x$ 瞬时平衡到一个值 $n_x^*$，该值取决于慢速变量 $n_d$ 的当前状态和时间 $t$。我们将 $n_x$ 的 CLE 的确定性部分设为零：\n$$ \\frac{\\mathrm{d}n_x}{\\mathrm{d}t}|_{\\text{det}} = a_1(n_d, t) - a_2(n_x) - 2a_3(n_x) + 2a_4(n_d) = 0 $$\n问题指示，相对于快速降解项 $-a_2(n_x) = -\\gamma n_x$，忽略慢二聚化反应产生的项 $-2a_3(n_x) = -k_d n_x(n_x-1)$。这个近似是合理的，因为它们的特征速率之比 $k_d/\\gamma$ 很小。然而，我们必须保留项 $2a_4(n_d) = 2k_r n_d$。因此，QSSA 方程简化为：\n$$ a_1(n_d, t) - a_2(n_x^*) + 2a_4(n_d) = 0 $$\n$$ \\left(\\alpha_{0} + \\alpha_{a}\\,\\frac{n_{d}}{K + n_{d}}\\left[1 + \\epsilon \\cos(\\omega t)\\right]\\right) - \\gamma n_x^* + 2k_r n_d = 0 $$\n求解准稳态单体拷贝数 $n_x^*$：\n$$ n_x^*(n_d, t) = \\frac{1}{\\gamma} \\left( \\alpha_{0} + 2k_r n_d + \\alpha_{a}\\,\\frac{n_{d}}{K + n_{d}}\\left[1 + \\epsilon \\cos(\\omega t)\\right] \\right) $$\n\n**c) $n_d$ 的有效一维朗之万方程**\n\n为了获得慢变量 $n_d$ 的有效动力学，我们将 QSSA 结果代入 $n_d$ 的 CLE 中。一个严谨的过程是，在慢变量 $n_d$ 给定的条件下，对快变量 $n_x$ 的稳态分布求倾向的平均值。\n漂移项为 $f(n_d, t) = \\langle a_3(n_x) - a_4(n_d) \\rangle_{fast} = \\langle a_3(n_x) \\rangle_{fast} - a_4(n_d)$。\n对于固定的 $n_d$ 和 $t$，$n_x$ 的动力学近似为一个线性生灭过程，其出生率为 $B = a_1(n_d, t) + 2k_r n_d$，单位分子的死亡率为 $\\gamma$。在此近似下，$n_x$ 的稳态分布是均值为 $\\lambda = B/\\gamma = n_x^*(n_d, t)$ 的泊松分布。\n二聚化倾向 $a_3(n_x)$ 的平均值为：\n$$ \\langle a_3(n_x) \\rangle_{fast} = \\left\\langle k_d \\frac{n_x(n_x-1)}{2} \\right\\rangle_{fast} = \\frac{k_d}{2} \\langle n_x(n_x-1) \\rangle_{fast} $$\n对于均值为 $\\lambda$ 的泊松分布变量，其二阶阶乘矩为 $\\langle k(k-1) \\rangle = \\lambda^2$。因此：\n$$ \\langle a_3(n_x) \\rangle_{fast} = \\frac{k_d}{2} [n_x^*(n_d, t)]^2 $$\n$n_d$ 的有效一维朗之万方程的漂移项因此为：\n$$ f(n_d, t) = \\frac{k_d}{2} [n_x^*(n_d, t)]^2 - k_r n_d $$\n扩散强度 $g(n_d, t)$ 是影响 $n_d$ 的各反应的平均倾向之和：\n$$ g(n_d, t) = \\langle a_3(n_x) \\rangle_{fast} + a_4(n_d) = \\frac{k_d}{2} [n_x^*(n_d, t)]^2 + k_r n_d $$\n得到的有效一维朗之万方程为：\n$$ \\mathrm{d} n_{d} = \\left( \\frac{k_d}{2} [n_x^*(n_d, t)]^2 - k_r n_d \\right) \\mathrm{d}t + \\sqrt{\\frac{k_d}{2} [n_x^*(n_d, t)]^2 + k_r n_d} \\, \\mathrm{d}W_t $$\n\n**d) 漂移项 $f(n_d, t)$ 的显式表达式**\n\n最后的任务是提供漂移项 $f(n_d, t)$ 的显式闭式表达式。我们将 (b) 部分得到的 $n_x^*(n_d, t)$ 的表达式代入 (c) 部分找到的 $f(n_d, t)$ 表达式中：\n$$ f(n_d, t) = \\frac{k_d}{2} \\left[ \\frac{1}{\\gamma} \\left( \\alpha_{0} + 2k_r n_d + \\alpha_{a}\\,\\frac{n_{d}}{K + n_{d}}\\left[1 + \\epsilon \\cos(\\omega t)\\right] \\right) \\right]^2 - k_r n_d $$\n这可以写成：\n$$ f(n_d, t) = \\frac{k_d}{2\\gamma^2} \\left( \\alpha_{0} + 2k_r n_d + \\alpha_{a}\\,\\frac{n_{d}}{K + n_{d}}\\left[1 + \\epsilon \\cos(\\omega t)\\right] \\right)^2 - k_r n_d $$\n这就是描述慢二聚体动力学的有效朗之万方程的漂移项的最终表达式，它适用于分析系统中的双稳态和随机共振。", "answer": "$$\n\\boxed{\\frac{k_d}{2\\gamma^2} \\left( \\alpha_{0} + 2k_r n_d + \\alpha_{a}\\,\\frac{n_{d}}{K + n_{d}}\\left[1 + \\epsilon \\cos(\\omega t)\\right] \\right)^2 - k_r n_d}\n$$", "id": "2659058"}, {"introduction": "噪声在非线性系统中可以扮演一个令人惊讶的有序化角色，但其机制并非单一。随机共振（Stochastic Resonance, SR）和相干共振（Coherence Resonance, CR）是两个典型但机理不同的例子，前者依赖于外部周期性驱动，而后者是系统的内在特性。本练习作为一个思想实验，旨在挑战你仅凭事件时间序列的统计特征来设计一个区分这两种现象的实验方案，从而深化你对相位锁定、驻留时间分布等关键概念的理解，并培养将理论洞察转化为可观测判据的能力。[@problem_id:2659060]", "problem": "一个化学实验室正在研究两种特性明确的反应网络中的噪声驱动动力学，这两种网络可以通过弱调制流入物浓度和通过系统大小调节有效噪声强度来探测。第一个网络，系统 $S$，是一个双稳态开关，在介观尺度上可以通过一个生灭化学主方程（CME）来建模，该模型具有两个稳定的浓度盆和一个它们之间的激活势垒。一个周期为 $T$、振幅为 $\\epsilon$ 的流入物浓度的弱正弦调制使得势垒高度随时间缓慢变化。第二个网络，系统 $C$，是一种可兴奋的激活剂-抑制剂动力学（例如，处于可兴奋状态的Oregonator），在没有周期性驱动的情况下，具有特征性的偏移和恢复时间。在这两个实验中，唯一可用的时间序列是离散事件的时间：对于系统 $S$，是连续两次跨盆事件之间在某个给定盆内花费的驻留时间 $\\tau_{\\mathrm{res}}$；对于系统 $C$，是连续两次噪声触发的脉冲之间的峰间间隔 $\\tau_{\\mathrm{ISI}}$。\n\n你的目标是提出一种实验诊断方法，仅使用事件时间统计来区分系统 $S$ 中的随机共振（SR）和系统 $C$ 中的相干共振（CR）。请将你的推理建立在第一性原理之上：对于弱周期性调制和弱噪声下的双稳态转换，逃逸事件可以很好地由从CME中提取的类Kramers速率来描述，事件间时间可以建模为由时变风险函数驱动的更新过程。对于没有周期性驱动的可兴奋系统，峰间间隔可以建模为一个不应期加上一个噪声激活的等待时间。\n\n假设以下与标准渐近理论一致的理想化情况：在系统 $S$ 中，对于给定的势阱，瞬时逃逸速率可以近似为 $k(t)\\propto \\exp\\!\\big(-\\Delta U(t)/D\\big)$，其中 $\\Delta U(t)=\\Delta U_{0}-\\alpha\\,\\epsilon \\sin(2\\pi t/T)$，对于某个 $\\alpha>0$、小振幅 $\\epsilon$ 和有效噪声强度 $D$；在系统 $C$ 中，每次脉冲后存在一个绝对不应期 $\\tau_{\\mathrm{ref}}(D)$，在此期间不能发生新的脉冲，之后是一个具有近似恒定风险率 $r(D)$ 的噪声激活的等待时间。\n\n下列哪种测量方案能够仅使用事件时间以及（当存在时）外部驱动周期 $T$ 的知识，稳健地区分系统 $S$ 中的SR和系统 $C$ 中的CR？\n\nA. 估计每个事件时间相对于驱动的相位 $\\phi_{j}=2\\pi t_{j}/T \\bmod 2\\pi$，以及驻留时间密度 $p(\\tau_{\\mathrm{res}})$。如果环形相位分布显著非均匀，并且 $p(\\tau_{\\mathrm{res}})$ 是多峰的，峰值位于 $nT/2$ 附近（其中 $n\\in\\mathbb{N}$），这与一个周期为 $T$ 的风险函数一致，则判断为SR；如果相位是均匀的，并且峰间间隔密度 $p(\\tau_{\\mathrm{ISI}})$ 是单峰的，在 $\\tau_{\\mathrm{ref}}(D)$ 处有一个截断，并且在 $T$ 的谐波处没有峰值，则判断为CR。\n\nB. 比较假定共振时的平均事件率：如果平均转换率恰好等于 $2/T$，则判断为SR；如果它恰好等于 $1/T$，则判断为CR；否则保持未定。\n\nC. 将时间划分为长度为 $T$ 的窗口，并计算事件计数的法诺因子 $F$。如果 $F>1$，则判断为SR；如果 $F<1$，则判断为CR。\n\nD. 关闭周期性调制，扫描噪声强度 $D$，同时测量间隔的变异系数 $\\mathrm{CV}=\\sqrt{\\mathrm{Var}(\\tau)}/\\mathbb{E}[\\tau]$。如果 $\\mathrm{CV}(D)$ 在一个中间值 $D$ 处呈现出最小值，则判断为CR，因为SR需要驱动，因此不可能显示出这样的最小值。", "solution": "必须首先验证问题陈述的科学性和逻辑完整性。\n\n### 步骤1：提取已知条件\n\n已知条件逐字摘录自问题陈述：\n-   **系统S**：\n    -   一个由化学主方程（CME）建模的双稳态开关。\n    -   两个稳定的浓度盆和一个激活势垒。\n    -   一个周期为 $T$、振幅为 $\\epsilon$ 的流入物浓度的弱正弦调制。\n    -   时变势垒高度：$\\Delta U(t)=\\Delta U_{0}-\\alpha\\,\\epsilon \\sin(2\\pi t/T)$，其中 $\\alpha>0$。\n    -   有效噪声强度 $D$。\n    -   观测量：在给定盆中的驻留时间 $\\tau_{\\mathrm{res}}$。\n    -   瞬时逃逸速率近似：$k(t)\\propto \\exp\\!\\big(-\\Delta U(t)/D\\big)$。\n-   **系统C**：\n    -   一种可兴奋的激活剂-抑制剂动力学。\n    -   无周期性驱动。\n    -   特征性的偏移和恢复时间。\n    -   观测量：峰间间隔 $\\tau_{\\mathrm{ISI}}$。\n    -   绝对不应期 $\\tau_{\\mathrm{ref}}(D)$。\n    -   具有近似恒定风险率 $r(D)$ 的噪声激活等待时间。\n-   **目标**：提出一种实验诊断方法，仅使用事件时间统计来区分系统S中的随机共振（SR）和系统C中的相干共振（CR）。\n-   **知识**：事件时间以及（当存在时）外部驱动周期 $T$。\n\n### 步骤2：使用提取的已知条件进行验证\n\n1.  **科学依据**：该问题牢固地建立在物理和化学系统中随机过程的既定理论之上。对周期性驱动的双稳态系统中的随机共振（SR）和自治可兴奋系统中的相干共振（CR）的描述是统计物理学中的经典模型。使用类Kramers逃逸速率、化学主方程、风险函数和更新过程是标准的、严谨的形式体系。\n2.  **良构性**：该问题是良构的。它定义了两个不同的物理系统，并要求提出一个方案来根据它们的可观测统计量来区分它们。所提供的理想化条件确保了可以做出独特且有意义的区分。\n3.  **客观性**：该问题以精确、客观和定量的语言陈述，没有任何主观或模糊的术语。\n\n### 步骤3：结论与行动\n\n问题陈述有效。它在科学上是合理的，是自洽的，也是良构的。我将继续推导解决方案并评估各个选项。\n\n### 基于原理的推导与选项分析\n\n核心任务是在事件时间中识别出一个统计特征，该特征是系统S中随机共振（SR）所独有，而在系统C的相干共振（CR）中不存在，反之亦然。\n\n-   **系统S（随机共振）**：该系统的特点是噪声和周期性外部驱动的相互作用。从势阱中逃逸的速率 $k(t)$ 是周期性的，周期为 $T$：\n    $$k(t) \\propto \\exp\\left(-\\frac{\\Delta U_{0}-\\alpha\\,\\epsilon \\sin(2\\pi t/T)}{D}\\right)$$\n    当势垒最低时，即在 $\\sin(2\\pi t/T) = 1$ 的时间点 $t$，逃逸事件的概率最大。这导致系统的跃迁与外部驱动同步。这种同步对事件时间统计有两个主要后果：\n    1.  **锁相**：事件的发生时间 $t_j$ 将与驱动的相位相关。相位的分布 $\\phi_j = (2\\pi t_j/T) \\pmod{2\\pi}$ 将是非均匀的，在逃逸概率最高的地方显示出峰值。\n    2.  **多峰驻留时间分布**：驻留时间的分布 $p(\\tau_{\\mathrm{res}})$ 将反映逃逸机会的周期性。如果一个跃迁在某个周期的高逃逸概率窗口内没有发生，它很可能在下一个或再下一个窗口发生。这导致一个多峰的分布 $p(\\tau_{\\mathrm{res}})$，其峰值由驱动力的周期隔开。对于一个对称的双稳态系统，系统来回切换，其基本时间尺度是驱动周期的一半，即 $T/2$。因此，我们期望在这一特征时间的整数倍附近出现峰值。\n\n-   **系统C（相干共振）**：该系统是自治的；没有外部周期性驱动。动力学由内在属性决定：一个可兴奋阈值、一个噪声触发的“脉冲”，以及随后的不应期 $\\tau_{\\mathrm{ref}}(D)$。问题陈述中说明，峰间间隔 $\\tau_{\\mathrm{ISI}}$ 是绝对不应期和一个具有恒定风险率 $r(D)$ 的随机等待时间之和。\n    1.  **无锁相**：在没有外部周期性信号的情况下，系统没有可以同步的外部时钟。相对于任意周期 $T$ 计算的任何相位 $\\phi_j$ 都将是均匀分布的。\n    2.  **单峰峰间间隔分布**：不应期之后的等待时间 $\\tau_{\\mathrm{wait}}$ 是指数分布的，其概率密度为 $p(\\tau_{\\mathrm{wait}}) = r(D)e^{-r(D)\\tau_{\\mathrm{wait}}}$。总的峰间间隔为 $\\tau_{\\mathrm{ISI}} = \\tau_{\\mathrm{ref}}(D) + \\tau_{\\mathrm{wait}}$。因此，概率密度 $p(\\tau_{\\mathrm{ISI}})$ 是一个平移的指数分布：\n        $$p(\\tau_{\\mathrm{ISI}}) = \\begin{cases} r(D) e^{-r(D)(\\tau_{\\mathrm{ISI}} - \\tau_{\\mathrm{ref}}(D))} & \\text{if } \\tau_{\\mathrm{ISI}} \\ge \\tau_{\\mathrm{ref}}(D) \\\\ 0 & \\text{if } \\tau_{\\mathrm{ISI}} < \\tau_{\\mathrm{ref}}(D) \\end{cases}$$\n        该分布是严格单峰的，在 $\\tau_{\\mathrm{ISI}} = \\tau_{\\mathrm{ref}}(D)$ 处有最大值，并带有一个指数尾。它没有周期性结构。\n\n在确立了这些原理之后，我将评估每个选项。\n\n**A. 估计每个事件时间相对于驱动的相位 $\\phi_{j}=2\\pi t_{j}/T \\bmod 2\\pi$，以及驻留时间密度 $p(\\tau_{\\mathrm{res}})$。如果环形相位分布显著非均匀，并且 $p(\\tau_{\\mathrm{res}})$ 是多峰的，峰值位于 $nT/2$ 附近（其中 $n\\in\\mathbb{N}$），这与一个周期为 $T$ 的风险函数一致，则判断为SR；如果相位是均匀的，并且峰间间隔密度 $p(\\tau_{\\mathrm{ISI}})$ 是单峰的，在 $\\tau_{\\mathrm{ref}}(D)$ 处有一个截断，并且在 $T$ 的谐波处没有峰值，则判断为CR。**\n\n该方案提议检查以上推导出的关键特征。\n-   对于系统S（SR），它正确地指出了由于锁相，相位分布必须是非均匀的，并且由于逃逸机会的周期性，驻留时间分布 $p(\\tau_{\\mathrm{res}})$ 必须是多峰的。这是SR的一个明确特征。\n-   对于系统C（CR），它正确地指出了相对于外部周期 $T$ 的相位分布必须是均匀的，并且峰间间隔分布 $p(\\tau_{\\mathrm{ISI}})$ 必须是单峰的，并带有一个尖锐的截断（不应期）。这是CR的一个明确特征。\n所提出的方案是对SR和CR之间根本差异的直接而全面的检验。相位分析和间隔分布分析的结合提供了一种高度稳健的区分方法。\n\n**结论：正确。**\n\n**B. 比较假定共振时的平均事件率：如果平均转换率恰好等于 $2/T$，则判断为SR；如果它恰好等于 $1/T$，则判断为CR；否则保持未定。**\n\n-   对于系统S（SR），平均驻留时间 $\\mathbb{E}[\\tau_{\\mathrm{res}}]$ 等于 $T/2$ 的条件，或者等效地，平均速率 $1/\\mathbb{E}[\\tau_{\\mathrm{res}}] = 2/T$ 是最佳SR的时间尺度匹配条件。然而，SR是在一定参数范围内观察到的更广泛的现象，而不是由一个精确等式定义的状态。这个条件是共振峰值的一个近似，而不是一个严格的定律。依赖于一个精确的等式使得该方案不可靠。\n-   对于系统C（CR），没有外部驱动周期 $T$。其平均事件率 $1/\\mathbb{E}[\\tau_{\\mathrm{ISI}}]$ 由内在系统属性和噪声水平 $D$ 决定。该速率等于 $1/T$（其中 $T$ 来自另一个实验）的条件是完全任意的，没有物理基础。\n\n**结论：不正确。**\n\n**C. 将时间划分为长度为 $T$ 的窗口，并计算事件计数的法诺因子 $F$。如果 $F>1$，则判断为SR；如果 $F<1$，则判断为CR。**\n\n法诺因子 $F = \\mathrm{Var}(N_W) / \\mathbb{E}[N_W]$，衡量事件计数变异性与泊松过程（其 $F=1$）的偏离程度。\n-   对于系统S（SR），事件与驱动同步，导致它们在特定相位聚集。这种时间上的聚集增加了固定窗口内计数的方差，导致超泊松统计量，$F > 1$。\n-   对于系统C（CR），不应期为脉冲序列引入了规律性，使其比随机过程更有序。这导致计数方差相对于均值的减小，从而产生亚泊松统计量，$F < 1$。\n虽然这个方案捕捉到了一个重要的统计差异，但它没有选项A具体。例如，一个系统可能本身就具有阵发性（例如，一个具有复杂动力学的非驱动系统）并表现出 $F>1$，但并未经历SR。选项A的锁相测试将正确地识别出这样的系统没有经历SR。因此，选项A更稳健，因为它探测了与外部驱动同步的特定机制。\n\n**结论：不正确。**\n\n**D. 关闭周期性调制，扫描噪声强度 $D$，同时测量间隔的变异系数 $\\mathrm{CV}=\\sqrt{\\mathrm{Var}(\\tau)}/\\mathbb{E}[\\tau]$。如果 $\\mathrm{CV}(D)$ 在一个中间值 $D$ 处呈现出最小值，则判断为CR，因为SR需要驱动，因此不可能显示出这样的最小值。**\n\n该方案提出了一个针对无驱动系统的实验。\n-   对于驱动关闭（$\\epsilon=0$）的系统S，势垒是恒定的。逃逸过程是一个平稳泊松过程，驻留时间 $\\tau_{\\mathrm{res}}$ 是指数分布的。对于指数分布，$\\mathbb{E}[\\tau]=\\mu$ 且 $\\mathrm{Var}(\\tau)=\\mu^2$，因此对于所有噪声强度 $D$，$\\mathrm{CV}=1$。\n-   对于系统C，CR现象的定义是在一个最佳的非零噪声水平 $D$ 处出现最大的相干性（最小的 $\\mathrm{CV}$）。因此，观察到 $\\mathrm{CV}(D)$ 曲线中的一个最小值是CR的明确特征。\n这个方案正确地区分了*底层的物理系统*。然而，问题要求区分*系统S中的SR*和*系统C中的CR*。根据定义，SR是一种只有在驱动开启时才会发生的现象。该方案要求关闭驱动，从而破坏了人们本应识别的现象本身。这是一个区分双稳态系统和可兴奋系统的方案，而不是区分所观察到的SR和CR现象。选项A直接在它们定义的运行状态下分析这些现象。\n\n**结论：不正确。**\n\n### 总结\n\n选项A提供了最稳健和基础最合理的方案，用以使用指定的观测量来区分SR和CR。它直接测试了每种现象的定义性特征：SR与外部起搏器的同步，以及CR自治动力学中同步的缺失，并辅以能反映不同底层动力学的间隔分布分析。", "answer": "$$\\boxed{A}$$", "id": "2659060"}, {"introduction": "理论预测和概念理解最终需要通过可量化的指标进行验证。对于随机共振而言，其最明确的标志是系统输出的信噪比（Signal-to-Noise Ratio, SNR）随噪声强度的增加呈现非单调的“共振”峰。本练习将理论付诸实践，要求你通过编写代码来模拟一个受噪声和周期驱动力影响的双稳态系统，执行谱分析以计算 SNR，并最终实现一个决策规则来识别真正的随机共振现象。这个完整的计算流程将帮助你掌握从模型模拟到数据分析，再到现象验证的核心研究技能。[@problem_id:2659065]", "problem": "考虑一个受热涨落和弱周期性驱动影响的双稳态化学反应坐标。您将使用一个粗粒化的过阻尼朗之万方程，该方程模拟一个包含两个亚稳化学态的双稳态有效势。您的任务是设计并实现一个统计决策规则，通过考察输出信噪比（SNR）对噪声强度的依赖性，来区分真正的随机共振（SR）与平凡的确定性同步。该决策必须依赖于第一性原理，您的程序必须：生成时间序列，在驱动频率处估计信噪比，评估信噪比随噪声强度变化的非单调性，然后判断是否存在随机共振。所有测试用例的最终输出必须是包含布尔值列表的单行文本。\n\n基本建模与假设。使用一个对称四次势中具有正弦驱动力的双稳态反应坐标的过阻尼朗之万方程，\n$$\n\\mathrm{d}x = \\left(-\\frac{\\mathrm{d}U}{\\mathrm{d}x} + A\\cos(2\\pi f t)\\right)\\mathrm{d}t + \\sqrt{2D}\\,\\mathrm{d}W_t,\n$$\n其中 $x$ 是粗粒化反应坐标，$U(x)$ 是势能，$A$ 是驱动振幅，$f$ 是驱动频率，$D$ 是与 $U(x)$ 单位相同的有效噪声强度，$W_t$ 是标准维纳过程。使用四次势\n$$\nU(x) = \\frac{a}{4}x^4 - \\frac{b}{2}x^2,\n$$\n其中 $a>0$ 且 $b>0$，因此在 $\\pm \\sqrt{b/a}$ 附近有两个势阱。在无量纲单位和单位摩擦系数下进行计算。该系统代表了一个慢反应坐标附近的通用双稳态反应网络。驱动频率处的信噪比（SNR）根据 $x(t)$ 的功率谱密度定义，即驱动频率处的光谱功率与通过稳健估计得到的附近频率局部光谱背景之比。\n\n您的程序必须实现以下组件：\n\n1) 时域仿真。使用与连续态化学动力学的过阻尼朗之万动力学一致的标准时间离散化方案，对该随机微分方程进行数值积分，并为不同的噪声强度 $D$ 生成实现 $x(t)$。丢弃初始的瞬态部分，并使用剩余部分来估计能谱。\n\n2) 信噪比估计。使用 $x(t)$ 的离散傅里叶变换，估计单边功率谱密度，并计算驱动频率 $f$ 处的信噪比（SNR），其值为最接近 $f$ 的频率仓中的光谱功率与根据排除驱动仓的相邻频率仓计算出的噪声基底的稳健估计值之比。信噪比必须是一个正实数。\n\n3) 统计决策规则。设计一个检验，用于在以下两者之间做出决策：\n- 假设 $\\mathrm{H}_1$（真正的随机共振）：$A$ 是亚阈值的，因此在 $D\\to 0$ 时信噪比很小，并且信噪比作为 $D$ 的函数呈现出非单调的单峰依赖性，其内部最大值以具有科学意义的余量超过端点值。在小的 $D$ 范围内，信噪比随 $D$ 增加而增加；在大的 $D$ 范围内，它随 $D$ 增加而减小。\n- 假设 $\\mathrm{H}_0$（非随机共振，包括确定性同步）：信噪比在 $D=0$ 时已经很高，并且没有显示出可归因于噪声的内部最大值；或者信噪比在测试的 $D$ 范围内是单调的，没有足够突出的内部最大值。\n\n您的检验必须通过结合至少以下要素来形式化上述规则：(i) 检测 SNR 相对于 $D$ 的一个严格内部峰值，该峰值比两个端点值都大一个指定的余量；(ii) 离散斜率在峰值附近从正（低 $D$）变为负（高 $D$）的符号变化；以及 (iii) 检查当提供 $D=0$ 时，在 $\\mathrm{H}_1$ 假设下 $D=0$ 处的信噪比与峰值相比很小，但在 $\\mathrm{H}_0$ 假设下则不然。每个案例的最终决策必须是一个布尔值：如果接受 $\\mathrm{H}_1$，则返回 $True$，否则返回 $False$。\n\n数值细节。对势能使用以下参数集：$a=1$ 和 $b=1$。对于驱动，使用下面每个测试用例指定的 $f$。使用每个案例指定的时间步长 $\\Delta t$、总时间 $T$ 进行仿真，并丢弃前 $\\theta T$（其中 $\\theta=0.1$）作为瞬态。频率以与 $t$ 和 $x$ 无量纲相一致的反时间单位表示。当出现角度时，必须以弧度为单位。输出中不需要物理单位，因为输出是布尔值。\n\n测试套件。您的程序必须运行以下四个案例，并按指定顺序输出决策：\n\n- 案例 1（预期为真正的SR）：$A=0.15$, $f=0.05$, $D\\in\\{0.02, 0.05, 0.08, 0.12, 0.18\\}$, $\\Delta t=0.02$, $T=500$。\n- 案例 2（预期为确定性同步）：$A=0.80$, $f=0.05$, $D\\in\\{0.00, 0.02, 0.05, 0.08\\}$, $\\Delta t=0.02$, $T=500$。\n- 案例 3（无驱动；预期为非SR）：$A=0.00$, $f=0.05$, $D\\in\\{0.02, 0.05, 0.08, 0.12\\}$, $\\Delta t=0.02$, $T=500$。\n- 案例 4（在测试范围内单调；预期为非SR）：$A=0.10$, $f=0.02$, $D\\in\\{0.005, 0.010, 0.020, 0.030\\}$, $\\Delta t=0.02$, $T=800$。\n\n算法约束。在谱估计中使用窗函数以减少泄漏。噪声基底估计必须排除驱动仓周围至少 $\\pm 2$ 个频率仓的对称邻域。在不包括零频率的频带上使用稳健的统计量（例如，中位数）来估计噪声基底。对于给定的随机数生成器种子，您的决策规则必须是确定性的。\n\n最终输出格式。您的程序应生成一行输出，其中包含四个布尔决策，以逗号分隔，并用方括号括起来，顺序与上述案例一致。例如，打印的行必须如下所示\n$$\n[\\mathrm{True},\\mathrm{False},\\mathrm{False},\\mathrm{False}],\n$$\n但需使用您的方法根据仿真计算出的实际决策。\n\n您的程序必须是完全自包含的：它必须定义上述所有参数，在内部生成所有数据，并且只打印最终结果行。不允许有其他输出。", "solution": "该问题要求设计并实现一种计算方法，用以在一个双稳态化学系统中区分真正的随机共振（SR）与确定性同步或其他非共振行为。分析将基于系统对不同热噪声强度的响应。这需要仿真系统动力学，执行谱分析以量化输出信噪比（SNR），并应用一个基于SNR非单调行为（SR的标志）的 principled 决策规则。\n\n系统动力学由反应坐标 $x(t)$ 的过阻尼朗之万方程建模，该坐标受到势能力、周期性驱动力和随机热涨落的影响：\n$$\n\\mathrm{d}x = \\left(-\\frac{\\mathrm{d}U(x)}{\\mathrm{d}x} + A\\cos(2\\pi f t)\\right)\\mathrm{d}t + \\sqrt{2D}\\,\\mathrm{d}W_t\n$$\n在这里，$x$ 是无量纲反应坐标，$t$ 是无量纲时间，$U(x)$ 是双稳态势，$A$ 是外部周期性驱动的振幅，$f$ 是其频率，$D$ 是代表热能的噪声强度，$W_t$ 是模拟白噪声的标准维纳过程。势是一个对称的四次双阱势，由下式给出：\n$$\nU(x) = \\frac{a}{4}x^4 - \\frac{b}{2}x^2\n$$\n使用指定的参数 $a=1$ 和 $b=1$，势变为 $U(x) = \\frac{1}{4}x^4 - \\frac{1}{2}x^2$。该势在 $x = \\pm\\sqrt{b/a} = \\pm 1$ 处有两个稳定极小值，对应两个亚稳态化学态。这两个态由位于 $x=0$ 处的高度为 $\\Delta U = U(0) - U(\\pm 1) = 0 - (\\frac{1}{4} - \\frac{1}{2}) = \\frac{1}{4}$ 的势垒隔开。\n\n为了仿真系统的演化，我们必须对这个随机微分方程（SDE）进行数值积分。一阶欧拉-丸山方法是完成此任务的标准且合适选择。在时间步 $i$ 处，坐标 $x$ 的离散化更新规则是：\n$$\nx_{i+1} = x_i + \\left[ -(ax_i^3 - bx_i) + A\\cos(2\\pi f t_i) \\right] \\Delta t + \\sqrt{2D\\Delta t} Z_i\n$$\n其中 $t_i = i\\Delta t$，$\\Delta t$ 是时间步长，$Z_i$ 是从标准正态分布 $\\mathcal{N}(0,1)$ 中抽取的随机变量。每次仿真运行总时间 $T$，并丢弃生成的时间序列的初始 $10\\%$ 作为瞬态期，以确保分析是在系统的统计平稳态上进行的，从初始条件 $x(0)=-1$ 开始。\n\n信噪比（SNR）是检测SR的关键指标。它是从 $x(t)$ 的平稳时间序列的功率谱密度（PSD）中估计出来的。过程如下：\n1.  对时间序列数据应用汉宁窗以减少谱泄漏，这是有限时间傅里叶分析的一种人为现象。\n2.  使用窗函数的实数快速傅里叶变换（`rfft`）计算单边PSD。第 $k$ 个频率仓的功率 $P_k$ 与相应傅里叶系数的模的平方 $|X_k|^2$ 成正比。\n3.  信号功率 $S_{sig}$ 定义为最接近外部驱动频率 $f$ 的单个频率仓 $k_f$ 中包含的功率。\n4.  噪声功率 $S_{noise}$ 是对信号频率附近谱背景的稳健估计。它被计算为围绕信号仓 $k_f$ 的一个频率带中功率值的中位数。为避免信号峰值的污染，计算时排除了 $k_f$ 周围 $\\pm 2$ 个仓的区域。\n5.  SNR是无量纲比率 $\\text{SNR} = S_{sig} / S_{noise}$。\n\n最后一步是将决策规则应用于作为噪声强度 $D$ 函数的计算出的SNR值。对于每个测试用例，为一组给定的 $D$ 值 $\\{D_j\\}$ 计算SNR。然后分析得到的曲线 $\\text{SNR}(D)$，以确定是否存在SR。\n\n如果 $\\text{SNR}(D)$ 曲线表现出统计上显著的、非单调的单峰，则接受假设 $\\mathrm{H}_1$（真正的SR）。这通过以下联合判据形式化：\n1.  **内部峰值**：最大SNR必须出现在一个严格介于测试的最小和最大 $D$ 值之间的噪声强度 $D_{peak}$ 处。如果最大SNR出现在 $D$ 范围的任一端点，则认为行为在测试范围内是单调的，并拒绝 $\\mathrm{H}_1$。\n2.  **峰值显著性**：SR峰值必须显著大于范围边界处的背景信号响应。我们通过要求最大SNR $\\text{SNR}_{max}$ 大于端点SNR一个余量因子 $R_{margin}$ 来量化这一点。条件是 $\\text{SNR}_{max} > R_{margin} \\cdot \\text{SNR}_{first}$ 和 $\\text{SNR}_{max} > R_{margin} \\cdot \\text{SNR}_{last}$。为此规则选择 $R_{margin}=1.25$。\n3.  **亚阈值条件**：一个强（或“超阈值”）驱动即使在没有噪声（$D=0$）的情况下也能引起周期性切换，导致在 $D=0$ 时有很高的SNR。这是确定性同步，而非SR。为了区分这一点，如果 $D=0$ 是测试集的一部分，我们施加一个更严格的要求：峰值SNR必须远大于零噪声时的SNR。条件是 $\\text{SNR}_{max} > R_{sub} \\cdot \\text{SNR}_{D=0}$，选择的余量为 $R_{sub}=2.0$。\n\n如果给定测试用例的所有适用条件都得到满足，则结果为 `True`，表示存在SR。否则，结果为 `False`。这个基于SR物理原理的确定性规则，允许对所提供测试用例中系统行为进行稳健且可复现的分类。使用固定的随机种子以确保随机模拟本身是可复现的。", "answer": "```python\nimport numpy as np\nimport scipy.fft\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases for Stochastic Resonance detection.\n    \"\"\"\n    # Set a global seed for reproducibility of the stochastic simulations.\n    # The problem implies seeds are given, but they are not. A fixed seed must be used.\n    np.random.seed(42)\n\n    def run_simulation(a, b, A, f, D, dt, T, theta):\n        \"\"\"\n        Simulates the overdamped Langevin equation using the Euler-Maruyama method.\n        \n        Args:\n            a, b: Quartic potential parameters.\n            A, f: Drive amplitude and frequency.\n            D: Noise intensity.\n            dt: Time step.\n            T: Total simulation time.\n            theta: Fraction of time series to discard as transient.\n\n        Returns:\n            The stationary part of the time series x(t).\n        \"\"\"\n        num_steps = int(T / dt)\n        t = np.linspace(0, T, num_steps)\n        x = np.zeros(num_steps)\n        x[0] = -1.0  # Start at one of the potential minima\n\n        # Pre-generate random numbers for efficiency\n        white_noise = np.random.randn(num_steps)\n\n        # Euler-Maruyama integration\n        for i in range(num_steps - 1):\n            force = -(a * x[i]**3 - b * x[i]) + A * np.cos(2 * np.pi * f * t[i])\n            x[i+1] = x[i] + force * dt + np.sqrt(2 * D * dt) * white_noise[i]\n\n        transient_steps = int(theta * num_steps)\n        return x[transient_steps:]\n\n    def calculate_snr(ts, dt, f):\n        \"\"\"\n        Calculates the Signal-to-Noise Ratio (SNR) from a time series.\n\n        Args:\n            ts: The time series data.\n            dt: The time step of the series.\n            f: The drive frequency to find the signal peak.\n\n        Returns:\n            The estimated SNR.\n        \"\"\"\n        n = len(ts)\n        if n == 0:\n            return 0.0\n\n        # Apply Hanning window to reduce spectral leakage\n        windowed_ts = ts * np.hanning(n)\n\n        # Compute the real FFT and the corresponding frequencies\n        fft_coeffs = scipy.fft.rfft(windowed_ts)\n        fft_freqs = scipy.fft.rfftfreq(n, d=dt)\n        \n        # Power is the squared magnitude of the FFT coefficients\n        power = np.abs(fft_coeffs)**2\n\n        # Find the index of the frequency bin closest to the drive frequency\n        drive_idx = np.argmin(np.abs(fft_freqs - f))\n        \n        # Signal power is the power in the drive frequency bin\n        signal_power = power[drive_idx]\n        \n        # Define noise estimation band, excluding the peak and its immediate neighbors\n        noise_exclude_half_width = 2\n        noise_band_half_width = 15 # robustly estimate over a wider band\n        \n        noise_indices = []\n        low_start = max(1, drive_idx - noise_band_half_width) # Exclude DC component (index 0)\n        low_end = drive_idx - noise_exclude_half_width\n        if low_end > low_start:\n            noise_indices.extend(range(low_start, low_end))\n            \n        high_start = drive_idx + noise_exclude_half_width + 1\n        high_end = min(len(power), drive_idx + noise_band_half_width + 1)\n        if high_end > high_start:\n            noise_indices.extend(range(high_start, high_end))\n\n        if not noise_indices:\n            # Fallback if frequency bins are too few\n            return 1.0\n\n        # Noise power is the median of the power in the noise band\n        noise_power = np.median(power[noise_indices])\n\n        if noise_power == 0:\n            # Avoid division by zero; if noise is zero, SNR is effectively infinite\n            # but usually indicates an issue. Let's return a large number or 1.0 if signal is also 0.\n            return 1.0 if signal_power == 0 else 1e12\n\n        return signal_power / noise_power\n\n    def is_sr(d_values, snr_values):\n        \"\"\"\n        Applies the statistical decision rule to determine if Stochastic Resonance is present.\n\n        Args:\n            d_values: List of noise intensities.\n            snr_values: List of corresponding SNR values.\n\n        Returns:\n            True if SR is detected, False otherwise.\n        \"\"\"\n        # SR requires a non-monotonic curve with an interior peak. Min 3 points needed.\n        if len(d_values) < 3:\n            return False\n\n        snr_arr = np.array(snr_values)\n        i_max = np.argmax(snr_arr)\n        snr_max = snr_arr[i_max]\n\n        # 1. Interior Peak Condition: The maximum SNR must not be at the endpoints.\n        if not (0 < i_max < len(snr_arr) - 1):\n            return False\n        \n        # 2. Peak Prominence Condition: The peak must be significantly higher than endpoints.\n        margin = 1.25\n        is_prominent = snr_max > margin * snr_arr[0] and snr_max > margin * snr_arr[-1]\n        if not is_prominent:\n            return False\n            \n        # 3. Subthreshold Drive Condition: If D=0 is tested, SNR should show large gain.\n        # This rules out deterministic entrainment where SNR is already high at D=0.\n        if d_values[0] == 0.0:\n            subthreshold_margin = 2.0\n            if not (snr_max > subthreshold_margin * snr_arr[0]):\n                return False\n        \n        # If all conditions pass, it is classified as genuine SR.\n        return True\n\n    # --- Test Suite ---\n    \n    # Potential parameters\n    a, b = 1.0, 1.0\n    # Transient discard fraction\n    theta = 0.1\n\n    test_cases = [\n        {'id': 1, 'A': 0.15, 'f': 0.05, 'D_values': [0.02, 0.05, 0.08, 0.12, 0.18], 'dt': 0.02, 'T': 500},\n        {'id': 2, 'A': 0.80, 'f': 0.05, 'D_values': [0.00, 0.02, 0.05, 0.08], 'dt': 0.02, 'T': 500},\n        {'id': 3, 'A': 0.00, 'f': 0.05, 'D_values': [0.02, 0.05, 0.08, 0.12], 'dt': 0.02, 'T': 500},\n        {'id': 4, 'A': 0.10, 'f': 0.02, 'D_values': [0.005, 0.010, 0.020, 0.030], 'dt': 0.02, 'T': 800},\n    ]\n\n    results = []\n    for case in test_cases:\n        snr_values = []\n        for D in case['D_values']:\n            ts = run_simulation(a, b, case['A'], case['f'], D, case['dt'], case['T'], theta)\n            snr = calculate_snr(ts, case['dt'], case['f'])\n            snr_values.append(snr)\n        \n        decision = is_sr(case['D_values'], snr_values)\n        results.append(decision)\n\n    print(f\"[{','.join(map(str, results))}]\".replace(\"True\", \"True\").replace(\"False\", \"False\"))\n\nsolve()\n```", "id": "2659065"}]}