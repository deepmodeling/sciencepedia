{"hands_on_practices": [{"introduction": "掌握任何算法的最佳方式之一就是亲手执行一遍。本练习将引导你手动完成 Gillespie 直接法的两个核心步骤：对下一次反应发生的时间进行抽样，以及决定发生哪一个反应。我们将使用一个简单的生灭过程模型，这是随机过程中的一个基石，通过手动计算来揭开随机模拟算法的神秘面纱[@problem_id:2678033]。", "problem": "考虑一个分子群体 $X(t)$ 的单物种生灭过程，该过程具有两个反应通道：\n- 生成：$X \\to X + 1$，以恒定速率 $\\lambda$ 发生（这等价于 $\\varnothing \\to X$，倾向为 $\\lambda$）。\n- 消亡：$X \\to X - 1$，发生速率与当前群体数量成正比，倾向为 $\\mu X$。\n\n假设 $\\lambda = 2\\,\\mathrm{s^{-1}}$，$\\mu = 0.25\\,\\mathrm{s^{-1}}$ 每分子，以及初始条件 $X(0) = 3$。使用 Gillespie 直接法（也称为随机模拟算法），将每个事件间的等待时间视为一个指数随机变量，其速率等于瞬时总倾向，并根据与当前各项倾向成正比的概率选择下一个反应的通道。现提供三对独立的均匀随机种子 $(u_{1,k},u_{2,k})$，其中 $k \\in \\{1,2,3\\}$。对于每个事件 $k$，$u_{1,k}$ 用于抽样等待时间，而 $u_{2,k}$ 用于选择反应通道：\n- $(u_{1,1},u_{2,1}) = \\big(\\exp(-1.1),\\,0.8\\big)$,\n- $(u_{1,2},u_{2,2}) = \\big(\\exp(-0.05),\\,0.2\\big)$,\n- $(u_{1,3},u_{2,3}) = \\big(\\exp(-0.3),\\,0.55\\big)$.\n\n请手动执行 Gillespie 直接法的前三个事件，从时间 $t=0$ 开始，在每个事件后更新状态 $X$ 和绝对时间。仅使用上述定义，确定第三个反应事件发生的绝对时间 $t_3$。以秒为单位，用精确值表示最终答案。不要四舍五入；如果可能，请提供精确分数。最终答案必须是单个实数。", "solution": "对问题陈述进行验证。\n\n**步骤 1：提取已知条件**\n- 系统：单物种生灭过程，群体 $X(t)$。\n- 反应与倾向：\n  - 生成：$X \\to X + 1$（或 $\\varnothing \\to X$），倾向 $a_1 = \\lambda$。\n  - 消亡：$X \\to X - 1$，倾向 $a_2 = \\mu X$。\n- 速率常数：\n  - $\\lambda = 2\\,\\mathrm{s^{-1}}$。\n  - $\\mu = 0.25\\,\\mathrm{s^{-1}}$ 每分子。\n- 初始条件：$X(0) = 3$，时间 $t=0$。\n- 算法：Gillespie 直接法。事件间等待时间 $\\tau$ 从速率为 $a_{total}$ 的指数分布中抽样，其中 $a_{total}$ 是所有倾向的总和。公式为 $\\tau = \\frac{1}{a_{total}} \\ln(\\frac{1}{u_1})$。使用第二个均匀随机数 $u_2$，根据与各别倾向成正比的概率选择下一个反应通道。\n- 随机种子：针对事件 $k = 1, 2, 3$ 的三对均匀随机种子 $(u_{1,k}, u_{2,k})$：\n  - $(u_{1,1}, u_{2,1}) = (\\exp(-1.1), 0.8)$。\n  - $(u_{1,2}, u_{2,2}) = (\\exp(-0.05), 0.2)$。\n  - $(u_{1,3}, u_{2,3}) = (\\exp(-0.3), 0.55)$。\n- 目标：确定第三个反应事件的绝对时间 $t_3$。\n\n**步骤 2：使用提取的已知条件进行验证**\n根据验证标准对问题进行评估。\n- **科学依据**：问题描述了一个标准的生灭过程，这是随机化学动力学中的一个基本模型。Gillespie 算法是用于此类系统的经典、精确的模拟方法。其表述完全符合已确立的科学原理。\n- **适定性**：该问题是适定的。它提供了所有必要的参数、初始条件和特定的随机数序列，从而能够确定性地追踪随机模拟的前三个事件。目标清晰明确。\n- **客观性**：问题以精确、客观的语言陈述，不含任何主观或非科学内容。\n\n**结论与行动**\n该问题在科学上是合理的、自洽的且适定的。没有可识别的缺陷。因此，该问题是**有效的**。将推导求解。\n\n模拟逐个事件进行，在每一步更新系统状态 $(t, X)$。步骤 $k$ 开始时的状态为 $(t_{k-1}, X_{k-1})$。\n\n**初始状态 ($k=0$):**\n系统在时间 $t_0 = 0$ 开始，初始群体数量为 $X_0 = 3$。\n\n**事件 1 ($k=1$):**\n首先，我们根据状态 $(t_0, X_0)$ 计算两个反应通道的倾向。\n- 生成倾向：$a_1 = \\lambda = 2$。\n- 消亡倾向：$a_2 = \\mu X_0 = (0.25) \\cdot 3 = 0.75$。\n\n总倾向是各项倾向之和：\n$$a_{total,0} = a_1 + a_2 = 2 + 0.75 = 2.75 = \\frac{11}{4}$$\n第一个事件的等待时间 $\\tau_1$ 使用第一个随机种子 $u_{1,1} = \\exp(-1.1)$ 计算。\n$$\\tau_1 = \\frac{1}{a_{total,0}} \\ln\\left(\\frac{1}{u_{1,1}}\\right) = \\frac{1}{11/4} \\ln\\left(\\frac{1}{\\exp(-1.1)}\\right) = \\frac{4}{11} \\ln(\\exp(1.1)) = \\frac{4}{11} \\cdot (1.1) = \\frac{4.4}{11} = 0.4 = \\frac{2}{5}$$\n第一个事件发生的时间是：\n$$t_1 = t_0 + \\tau_1 = 0 + 0.4 = 0.4$$\n接下来，我们使用第二个随机种子 $u_{2,1} = 0.8$ 来确定发生哪个反应。如果 $u_{2,1} \\le \\frac{a_1}{a_{total,0}}$，则发生生成反应（通道 1）。\n$$\\frac{a_1}{a_{total,0}} = \\frac{2}{2.75} = \\frac{2}{11/4} = \\frac{8}{11} \\approx 0.727$$\n因为 $u_{2,1} = 0.8 > \\frac{8}{11}$，所以选择消亡反应（通道 2）。群体数量相应更新：\n$$X_1 = X_0 - 1 = 3 - 1 = 2$$\n第一个事件之后的状态是 $(t_1, X_1) = (0.4, 2)$。\n\n**事件 2 ($k=2$):**\n我们从状态 $(t_1, X_1) = (0.4, 2)$ 继续。\n- 生成倾向：$a_1 = \\lambda = 2$。\n- 消亡倾向：$a_2 = \\mu X_1 = (0.25) \\cdot 2 = 0.5$。\n\n总倾向是：\n$$a_{total,1} = a_1 + a_2 = 2 + 0.5 = 2.5 = \\frac{5}{2}$$\n第二个事件的等待时间 $\\tau_2$ 使用 $u_{1,2} = \\exp(-0.05)$ 计算。\n$$\\tau_2 = \\frac{1}{a_{total,1}} \\ln\\left(\\frac{1}{u_{1,2}}\\right) = \\frac{1}{5/2} \\ln\\left(\\frac{1}{\\exp(-0.05)}\\right) = \\frac{2}{5} \\ln(\\exp(0.05)) = \\frac{2}{5} \\cdot (0.05) = \\frac{0.1}{5} = 0.02 = \\frac{1}{50}$$\n第二个事件发生的时间是：\n$$t_2 = t_1 + \\tau_2 = 0.4 + 0.02 = 0.42 = \\frac{42}{100} = \\frac{21}{50}$$\n使用 $u_{2,2} = 0.2$ 选择反应。发生生成反应的条件是 $u_{2,2} \\le \\frac{a_1}{a_{total,1}}$。\n$$\\frac{a_1}{a_{total,1}} = \\frac{2}{2.5} = \\frac{4}{5} = 0.8$$\n因为 $u_{2,2} = 0.2 \\le 0.8$，所以选择生成反应。群体数量变为：\n$$X_2 = X_1 + 1 = 2 + 1 = 3$$\n第二个事件之后的状态是 $(t_2, X_2) = (0.42, 3)$。\n\n**事件 3 ($k=3$):**\n我们从状态 $(t_2, X_2) = (0.42, 3)$ 继续。群体数量已返回其初始值。\n- 生成倾向：$a_1 = \\lambda = 2$。\n- 消亡倾向：$a_2 = \\mu X_2 = (0.25) \\cdot 3 = 0.75$。\n\n总倾向与第一步相同：\n$$a_{total,2} = a_1 + a_2 = 2 + 0.75 = 2.75 = \\frac{11}{4}$$\n第三个事件的等待时间 $\\tau_3$ 使用 $u_{1,3} = \\exp(-0.3)$ 计算。\n$$\\tau_3 = \\frac{1}{a_{total,2}} \\ln\\left(\\frac{1}{u_{1,3}}\\right) = \\frac{1}{11/4} \\ln\\left(\\frac{1}{\\exp(-0.3)}\\right) = \\frac{4}{11} \\ln(\\exp(0.3)) = \\frac{4}{11} \\cdot (0.3) = \\frac{1.2}{11} = \\frac{12}{110} = \\frac{6}{55}$$\n第三个事件的绝对时间 $t_3$ 是等待时间的累积和：\n$$t_3 = t_2 + \\tau_3 = \\frac{21}{50} + \\frac{6}{55}$$\n为了将这些分数相加，我们找到一个公分母，即 $\\mathrm{lcm}(50, 55) = \\mathrm{lcm}(2 \\cdot 5^2, 5 \\cdot 11) = 2 \\cdot 5^2 \\cdot 11 = 550$。\n$$t_3 = \\frac{21 \\cdot 11}{50 \\cdot 11} + \\frac{6 \\cdot 10}{55 \\cdot 10} = \\frac{231}{550} + \\frac{60}{550} = \\frac{231 + 60}{550} = \\frac{291}{550}$$\n分数 $\\frac{291}{550}$ 是不可约的，因为分子的质因数是 $291 = 3 \\cdot 97$，而分母的质因数是 $550 = 2 \\cdot 5^2 \\cdot 11$，两者没有公因数。\n\n问题只要求时间 $t_3$。为了完整起见，第三个反应将是生成反应，因为 $u_{2,3} = 0.55 \\le \\frac{8}{11}$。\n\n最终答案是第三个事件发生的绝对时间。", "answer": "$$\\boxed{\\frac{291}{550}}$$", "id": "2678033"}, {"introduction": "第一反应法 (First Reaction Method, FRM) 是另一种在数学上与直接法等价的精确模拟方法。FRM 的核心思想不是为整个系统抽取一个等待时间，而是为每个反应通道构想一个独立的“时钟”，最先“敲响”的那个时钟决定了下一个事件。本练习将运用 FRM 来模拟一个二聚化反应，重点在于从第一性原理出发，推导并计算单个反应通道的等待时间，从而加深对该方法基础的理解[@problem_id:2678042]。", "problem": "考虑在一个充分混合、热平衡的定容系统中的不可逆二聚反应：\n$$2A \\rightarrow A_{2}.$$\n假设该双分子反应遵循质量作用随机动力学，其标准反应倾向由下式给出：\n$$a(x) = c\\,\\binom{x_{A}}{2} = c\\,\\frac{x_{A}(x_{A}-1)}{2},$$\n其中 $x_{A}$ 是 $A$ 的分子数，$c$ 是随机速率常数。系统在时间 $t=0$ 时的初始状态为 $x_{A}=4$ 和 $x_{A_{2}}=0$，随机速率常数为 $c=0.50\\,\\mathrm{s}^{-1}$。使用随机模拟算法 (SSA) 的第一反应方法 (FRM) 来模拟前两个反应事件。在每个 FRM 步骤中，为单一反应通道使用指定的独立均匀随机数种子：第一步使用 $u_{1}=0.80$，第二步使用 $u_{2}=0.30$，其中每个 $u_{i}$ 是从单位区间上的连续均匀分布中抽取的样本。\n\n仅从“在任何反应倾向恒定的时间区间内，没有反应发生的概率等于一个速率为该反应倾向的泊松过程的生存函数”这一核心定义出发，推导下一次反应事件的等待时间分布，并用它来计算第二次反应事件的绝对时间，记为 $t_{2}$。\n\n以秒为单位表示 $t_{2}$ 的最终答案，并将答案四舍五入到四位有效数字。", "solution": "首先对问题进行验证，以确保其科学和逻辑上的完整性。\n\n从问题陈述中逐字提取的给定条件如下：\n1.  反应：$2A \\rightarrow A_{2}$。\n2.  反应倾向函数：$a(x) = c\\,\\binom{x_{A}}{2} = c\\,\\frac{x_{A}(x_{A}-1)}{2}$。\n3.  时间 $t=0$ 时的初始条件：$x_{A} = 4$，$x_{A_{2}} = 0$。\n4.  随机速率常数：$c=0.50\\,\\mathrm{s}^{-1}$。\n5.  算法：第一反应方法 (FRM)。\n6.  单一反应通道的随机数种子：第一步为 $u_{1}=0.80$，第二步为 $u_{2}=0.30$。\n7.  推导的核心原理：“没有反应发生的概率是一个速率等于该反应倾向的泊松过程的生存函数。”\n8.  目标：计算第二次反应事件的绝对时间 $t_{2}$，并四舍五入到四位有效数字。\n\n经评估，该问题是 **有效的**。它在科学上基于已建立的随机化学动力学理论和随机模拟算法 (SSA)。二聚反应的模型是标准的，其反应倾向函数对于质量作用动力学是正确的。该问题提法得当，提供了计算唯一、可验证解所需的所有初始条件、参数和随机数。语言客观而精确。这项任务虽然涉及第一反应方法的一个简化案例（由于只有一个反应通道），但要求对随机模拟的核心原理进行严谨的推导和应用，因此并非易事。\n\n解题过程如下。\n\n首先，我们根据所述的第一原理推导下一次反应事件的等待时间 $\\tau$ 的公式。设系统处于状态 $x$，其中单一反应的反应倾向为 $a(x)$。只要状态不发生改变，该反应倾向就保持不变。设 $\\tau$ 是到下一次反应的等待时间的随机变量。问题指出，在时间间隔 $[0, t']$ 内没有反应事件发生的概率由一个速率为 $a(x)$ 的泊松过程的生存函数给出。对于一个速率为 $\\lambda$ 的泊松过程，在持续时间 $t'$ 内发生零次事件的概率是 $P(N(t')=0) = \\exp(-\\lambda t')$。将此原理应用于 $\\lambda = a(x)$，等待时间 $\\tau$ 大于某个值 $t'$ 的概率是：\n$$P(\\tau > t') = \\exp(-a(x)t')$$\n这是等待时间分布的生存函数。因此，累积分布函数 (CDF)，$F(t') = P(\\tau \\le t')$ 为：\n$$F(t') = 1 - P(\\tau > t') = 1 - \\exp(-a(x)t')$$\n这是速率参数为 $a(x)$ 的指数分布的累积分布函数。\n为了通过逆变换采样法从此分布中生成一个随机样本 $\\tau_{\\text{sample}}$，我们设 $F(\\tau_{\\text{sample}}) = u$，其中 $u$ 是从单位区间上的均匀分布 $\\mathcal{U}(0,1)$ 中抽取的一个随机数。\n$$u = 1 - \\exp(-a(x)\\tau_{\\text{sample}})$$\n对 $\\tau_{\\text{sample}}$ 求解：\n$$\\exp(-a(x)\\tau_{\\text{sample}}) = 1 - u$$\n$$-a(x)\\tau_{\\text{sample}} = \\ln(1 - u)$$\n$$\\tau_{\\text{sample}} = -\\frac{\\ln(1 - u)}{a(x)}$$\n由于从 $\\mathcal{U}(0,1)$ 中抽取的随机变量 $u$ 意味着 $1-u$ 也服从 $\\mathcal{U}(0,1)$ 分布，因此标准做法是使用计算上等效且更简单的公式：\n$$\\tau_{\\text{sample}} = -\\frac{\\ln(u)}{a(x)}$$\n这就是我们将用来计算等待时间的公式。对于只有一个反应通道的系统，第一反应方法 (FRM) 简化为在每一步直接应用此公式。\n\n**模拟步骤 1：**\n模拟在时间 $t_0 = 0$ 开始，初始状态为 $x(0) = (x_A, x_{A_2}) = (4, 0)$。\n在此状态下，反应 $2A \\rightarrow A_2$ 的反应倾向为 $a_0$。\n$$a_0 = c\\,\\frac{x_{A}(x_{A}-1)}{2} = (0.50\\,\\mathrm{s}^{-1})\\,\\frac{4(4-1)}{2} = (0.50\\,\\mathrm{s}^{-1})\\,\\frac{12}{2} = 3.0\\,\\mathrm{s}^{-1}$$\n第一次反应的等待时间 $\\tau_1$ 使用第一个随机数种子 $u_1 = 0.80$ 进行计算。\n$$\\tau_1 = -\\frac{\\ln(u_1)}{a_0} = -\\frac{\\ln(0.80)}{3.0\\,\\mathrm{s}^{-1}}$$\n使用自然对数 $\\ln(0.80) \\approx -0.22314$：\n$$\\tau_1 \\approx -\\frac{-0.22314}{3.0\\,\\mathrm{s}^{-1}} \\approx 0.07438\\,\\mathrm{s}$$\n第一次反应事件发生在时间 $t_1 = t_0 + \\tau_1 = 0 + \\tau_1 = \\tau_1$。\n系统状态根据反应 $2A \\rightarrow A_2$ 的化学计量进行更新，其对于物种数量 $(x_A, x_{A_2})$ 的状态改变向量为 $\\nu = (-2, +1)$。\n$t_1$ 时刻的新状态：\n$$x_A(t_1) = x_A(0) - 2 = 4 - 2 = 2$$\n$$x_{A_2}(t_1) = x_{A_2}(0) + 1 = 0 + 1 = 1$$\n第一次事件后的状态为 $x(t_1) = (2, 1)$。\n\n**模拟步骤 2：**\n系统现在处于状态 $x(t_1) = (2, 1)$。我们计算新的反应倾向 $a_1$。\n$$a_1 = c\\,\\frac{x_{A}(x_{A}-1)}{2} = (0.50\\,\\mathrm{s}^{-1})\\,\\frac{2(2-1)}{2} = (0.50\\,\\mathrm{s}^{-1})\\,\\frac{2}{2} = 0.50\\,\\mathrm{s}^{-1}$$\n第二次反应的等待时间 $\\tau_2$ 使用第二个随机数种子 $u_2 = 0.30$ 进行计算。\n$$\\tau_2 = -\\frac{\\ln(u_2)}{a_1} = -\\frac{\\ln(0.30)}{0.50\\,\\mathrm{s}^{-1}}$$\n使用自然对数 $\\ln(0.30) \\approx -1.2040$：\n$$\\tau_2 \\approx -\\frac{-1.2040}{0.50\\,\\mathrm{s}^{-1}} \\approx 2.4080\\,\\mathrm{s}$$\n第二次反应事件发生在绝对时间 $t_2$，即第一次事件的时间加上第二次的等待时间。\n$$t_2 = t_1 + \\tau_2 = \\tau_1 + \\tau_2$$\n代入 $\\tau_1$ 和 $\\tau_2$ 的表达式：\n$$t_2 = \\left(-\\frac{\\ln(0.80)}{3.0}\\right) + \\left(-\\frac{\\ln(0.30)}{0.50}\\right)\\,\\mathrm{s}$$\n使用更精确的对数值，$\\ln(0.80) \\approx -0.22314355$ 和 $\\ln(0.30) \\approx -1.20397280$：\n$$\\tau_1 \\approx \\frac{0.22314355}{3.0} \\approx 0.07438118\\,\\mathrm{s}$$\n$$\\tau_2 \\approx \\frac{1.20397280}{0.50} \\approx 2.40794560\\,\\mathrm{s}$$\n$$t_2 \\approx 0.07438118 + 2.40794560 = 2.48232678\\,\\mathrm{s}$$\n问题要求最终答案四舍五入到四位有效数字。\n$$t_2 \\approx 2.482\\,\\mathrm{s}$$", "answer": "$$\\boxed{2.482}$$", "id": "2678042"}, {"introduction": "在掌握了算法的基本操作之后，对于研究生水平的实践者来说，理解那些确保算法正确性的微妙之处至关重要。这个高级练习将我们的重点从模拟转向分析。我们将研究一个假设但合理的实现错误，并运用数学分析（具体来说，是一阶泰勒近似）来推导该错误对模拟时间的期望偏差，这有助于培养你不仅会使用算法，更能验证和调试算法的关键技能[@problem_id:2678083]。", "problem": "考虑一个在充分混合体积 $\\,\\Omega\\,$ 中的单物种生灭系统，该系统被建模为一个连续时间马尔可夫链 (CTMC)。两个反应通道为\n$$\nR_{1}:\\ \\varnothing \\xrightarrow{\\ \\kappa_{b}\\ } X,\\qquad R_{2}:\\ X \\xrightarrow{\\ \\kappa_{d}\\ } \\varnothing,\n$$\n在状态 $\\,x \\in \\mathbb{Z}_{\\ge 0}\\,$ 下，其倾向函数为 $\\,a_{1}(x) = \\Omega\\,\\kappa_{b}\\,$ 和 $\\,a_{2}(x) = \\kappa_{d}\\,x\\,$，因此总倾向为 $\\,a_{0}(x) = a_{1}(x)+a_{2}(x) = \\Omega\\,\\kappa_{b} + \\kappa_{d}\\,x\\,$。此处 $\\,\\kappa_{b}\\,$ 和 $\\,\\kappa_{d}\\,$ 是正常数速率常数，$\\,\\nu_{1}=+1\\,$ 和 $\\,\\nu_{2}=-1\\,$ 表示状态改变增量。\n\n在随机模拟算法 (SSA)（也称为 Gillespie 直接法）中，处于状态 $\\,x\\,$ 时的下一反应等待时间 $\\,\\tau\\,$ 服从速率为 $\\,a_{0}(x)\\,$ 的指数分布，而下一反应通道 $\\,J\\in\\{1,2\\}\\,$ 以概率 $\\,\\mathbb{P}(J=k\\,|\\,x)=a_{k}(x)/a_{0}(x)\\,$ 被抽取。然而，假设一个错误的实现方式在状态 $\\,x\\,$ 下根据正确的概率抽取了 $\\,J\\,$，但随后却从一个以反应后总速率为参数的指数分布中抽样等待时间，即从 $\\,\\mathrm{Exp}\\!\\big(a_{0}(x+\\nu_{J})\\big)\\,$ 中抽样。\n\n从CTMC和倾向函数的第一性原理出发，并假设总倾向在反应后的相对变化幅度很小，即 $\\,|a_{0}(x+\\nu_{k})-a_{0}(x)|/a_{0}(x)\\ll 1\\,$ 的情况下，推导此错误引入的期望等待时间的一阶无条件偏差，其定义为\n$$\n\\mathrm{Bias}(x)\\ :=\\ \\mathbb{E}[\\tau_{\\mathrm{wrong}}\\,|\\,x]\\ -\\ \\mathbb{E}[\\tau_{\\mathrm{true}}\\,|\\,x].\n$$\n请用 $\\,\\Omega\\,$, $\\,\\kappa_{b}\\,$, $\\,\\kappa_{d}\\,$ 和 $\\,x\\,$ 表示你的最终答案，形式为一个单一的闭式解析表达式。不要引入任何额外的参数。你的答案应该是一个单一的表达式；不需要四舍五入，也不应报告单位。", "solution": "所述问题具有科学依据，提法恰当，客观，且不含逻辑或事实矛盾。这是化学动力学随机模拟算法分析中的一个标准练习。因此，我们着手进行推导。\n\n该系统是一个连续时间马尔可夫链，其状态 $x \\in \\mathbb{Z}_{\\ge 0}$ 表示物种 $X$ 的分子数量。两个反应通道分别是零级出生反应 $R_1$ 和一级死亡反应 $R_2$。\n$$R_{1}:\\ \\varnothing \\xrightarrow{\\ \\kappa_{b}\\ } X$$\n$$R_{2}:\\ X \\xrightarrow{\\ \\kappa_{d}\\ } \\varnothing$$\n相应的倾向函数为 $a_{1}(x) = \\Omega\\kappa_{b}$ 和 $a_{2}(x) = \\kappa_{d}x$，其中 $\\Omega$ 是体积，$\\kappa_{b}, \\kappa_{d}$ 是正常数速率常数。总倾向为 $a_{0}(x) = a_{1}(x) + a_{2}(x) = \\Omega\\kappa_{b} + \\kappa_{d}x$。反应 $R_1$ 的状态改变向量是 $\\nu_{1}=+1$，反应 $R_2$ 的状态改变向量是 $\\nu_{2}=-1$。\n\n我们需要求期望等待时间的一阶无条件偏差 $\\mathrm{Bias}(x) = \\mathbb{E}[\\tau_{\\mathrm{wrong}}\\,|\\,x] - \\mathbb{E}[\\tau_{\\mathrm{true}}\\,|\\,x]$。\n\n首先，我们定义正确的随机模拟算法 (SSA) 的期望等待时间。在正确的算法中，给定系统处于状态 $x$，到下一次反应的等待时间 $\\tau_{\\mathrm{true}}$ 是从一个速率参数等于总倾向 $a_{0}(x)$ 的指数分布中抽取的。速率为 $\\lambda$ 的指数分布随机变量的期望值为 $1/\\lambda$。因此，真实的期望等待时间为\n$$\n\\mathbb{E}[\\tau_{\\mathrm{true}}\\,|\\,x] = \\frac{1}{a_0(x)}.\n$$\n\n接下来，我们分析错误的实现方式。在这种情况下，下一反应通道 $J \\in \\{1, 2\\}$ 以正确的概率 $\\mathbb{P}(J=k\\,|\\,x) = a_{k}(x)/a_{0}(x)$ 被选择。然而，等待时间 $\\tau_{\\mathrm{wrong}}$ 却是从一个速率参数对应于*反应后*状态的总倾向 $a_{0}(x+\\nu_J)$ 的指数分布中抽取的。\n\n为了求得无条件期望等待时间 $\\mathbb{E}[\\tau_{\\mathrm{wrong}}\\,|\\,x]$，我们必须使用全期望定律，对下一反应通道 $J$ 的所有可能结果进行平均：\n$$\n\\mathbb{E}[\\tau_{\\mathrm{wrong}}\\,|\\,x] = \\sum_{k=1}^{2} \\mathbb{E}[\\tau_{\\mathrm{wrong}}\\,|\\,J=k, x] \\cdot \\mathbb{P}(J=k\\,|\\,x).\n$$\n给定选择的反应是 $J=k$，等待时间从 $\\mathrm{Exp}(a_0(x+\\nu_k))$ 中抽样。因此其条件期望是：\n$$\n\\mathbb{E}[\\tau_{\\mathrm{wrong}}\\,|\\,J=k, x] = \\frac{1}{a_0(x+\\nu_k)}.\n$$\n将此结果和概率 $\\mathbb{P}(J=k\\,|\\,x)$ 代回无条件期望的公式中，我们得到：\n$$\n\\mathbb{E}[\\tau_{\\mathrm{wrong}}\\,|\\,x] = \\sum_{k=1}^{2} \\frac{1}{a_0(x+\\nu_k)} \\cdot \\frac{a_k(x)}{a_0(x)} = \\frac{1}{a_0(x)} \\left( \\frac{a_1(x)}{a_0(x+\\nu_1)} + \\frac{a_2(x)}{a_0(x+\\nu_2)} \\right).\n$$\n问题指明，分析应在总倾向的相对变化很小的情况下进行，即 $|a_0(x+\\nu_k) - a_0(x)|/a_0(x) \\ll 1$。这为函数 $f(y) = 1/y$ 在点 $y_0 = a_0(x)$ 附近进行一阶泰勒级数展开提供了依据。展开式为 $f(y) \\approx f(y_0) + f'(y_0)(y - y_0)$。由于 $f'(y) = -1/y^2$，我们有：\n$$\n\\frac{1}{a_0(x+\\nu_k)} \\approx \\frac{1}{a_0(x)} - \\frac{a_0(x+\\nu_k) - a_0(x)}{\\left[a_0(x)\\right]^2}.\n$$\n将此近似代入 $\\mathbb{E}[\\tau_{\\mathrm{wrong}}\\,|\\,x]$ 的表达式中：\n$$\n\\mathbb{E}[\\tau_{\\mathrm{wrong}}\\,|\\,x] \\approx \\frac{1}{a_0(x)} \\sum_{k=1}^{2} a_k(x) \\left( \\frac{1}{a_0(x)} - \\frac{a_0(x+\\nu_k) - a_0(x)}{\\left[a_0(x)\\right]^2} \\right).\n$$\n将各项展开：\n$$\n\\mathbb{E}[\\tau_{\\mathrm{wrong}}\\,|\\,x] \\approx \\frac{1}{\\left[a_0(x)\\right]^2} \\sum_{k=1}^{2} a_k(x) - \\frac{1}{\\left[a_0(x)\\right]^3} \\sum_{k=1}^{2} a_k(x) \\left[a_0(x+\\nu_k) - a_0(x)\\right].\n$$\n由于 $\\sum_{k=1}^{2} a_k(x) = a_0(x)$，第一项可简化为 $1/a_0(x)$，这恰好是 $\\mathbb{E}[\\tau_{\\mathrm{true}}\\,|\\,x]$。\n$$\n\\mathbb{E}[\\tau_{\\mathrm{wrong}}\\,|\\,x] \\approx \\frac{1}{a_0(x)} - \\frac{1}{\\left[a_0(x)\\right]^3} \\sum_{k=1}^{2} a_k(x) \\left[a_0(x+\\nu_k) - a_0(x)\\right].\n$$\n偏差是错误期望等待时间与真实期望等待时间之差。到一阶，这便是：\n$$\n\\mathrm{Bias}(x) = \\mathbb{E}[\\tau_{\\mathrm{wrong}}\\,|\\,x] - \\mathbb{E}[\\tau_{\\mathrm{true}}\\,|\\,x] \\approx - \\frac{1}{\\left[a_0(x)\\right]^3} \\sum_{k=1}^{2} a_k(x) \\left[a_0(x+\\nu_k) - a_0(x)\\right].\n$$\n现在我们必须为这个特定的生灭系统计算这个和。增量是 $\\nu_1 = +1$ 和 $\\nu_2 = -1$。总倾向的变化是：\n对于 $k=1$：$a_0(x+\\nu_1) - a_0(x) = a_0(x+1) - a_0(x) = (\\Omega\\kappa_b + \\kappa_d(x+1)) - (\\Omega\\kappa_b + \\kappa_d x) = \\kappa_d$。\n对于 $k=2$：$a_0(x+\\nu_2) - a_0(x) = a_0(x-1) - a_0(x) = (\\Omega\\kappa_b + \\kappa_d(x-1)) - (\\Omega\\kappa_b + \\kappa_d x) = -\\kappa_d$。\n\n因此，这个和是：\n$$\n\\sum_{k=1}^{2} a_k(x) \\left[a_0(x+\\nu_k) - a_0(x)\\right] = a_1(x)(\\kappa_d) + a_2(x)(-\\kappa_d).\n$$\n代入 $a_1(x)$ 和 $a_2(x)$ 的表达式：\n$$\n(\\Omega\\kappa_b)(\\kappa_d) - (\\kappa_d x)(\\kappa_d) = \\Omega\\kappa_b\\kappa_d - \\kappa_d^2 x = \\kappa_d(\\Omega\\kappa_b - \\kappa_d x).\n$$\n最后，将这个结果代回偏差的表达式中：\n$$\n\\mathrm{Bias}(x) = - \\frac{\\kappa_d(\\Omega\\kappa_b - \\kappa_d x)}{\\left[a_0(x)\\right]^3} = \\frac{\\kappa_d(\\kappa_d x - \\Omega\\kappa_b)}{\\left[a_0(x)\\right]^3}.\n$$\n用 $a_0(x)$ 的定义替换它，我们得到一阶偏差的最终表达式：\n$$\n\\mathrm{Bias}(x) = \\frac{\\kappa_d(\\kappa_d x - \\Omega\\kappa_b)}{(\\Omega\\kappa_b + \\kappa_d x)^3}.\n$$\n这就是所要求的闭式解析表达式。", "answer": "$$\n\\boxed{\\frac{\\kappa_{d}(\\kappa_{d}x - \\Omega\\kappa_{b})}{(\\Omega\\kappa_{b} + \\kappa_{d}x)^{3}}}\n$$", "id": "2678083"}]}