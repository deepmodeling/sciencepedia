{"hands_on_practices": [{"introduction": "本实践的核心是从第一性原理出发，推导马库斯理论的中心方程。通过将溶剂的集体运动简化为谐振子模型，我们将看到反应物和产物态的自由能表面可以被描绘为两个抛物线。本练习将引导你通过求解这两个抛物线的交点，来推导电子转移活化能 $\\Delta G^{\\ddagger}$ 的经典表达式，从而深刻理解它与反应驱动力 $\\Delta G^{0}$ 及重组能 $\\lambda$ 之间的二次函数关系 [@problem_id:2654278]。", "problem": "考虑在极性溶剂中，一个给予体和一个接受体之间发生的非绝热外层电子转移。在谐波线性响应近似下，沿单一集体坐标 $Q$ 用两个抛物线型标准自由能面来模拟溶剂重组。这两个自由能面具有相同的曲率参数 $\\kappa$，但极小值点不同，分别为 $Q_D$ (给予体) 和 $Q_A$ (接受体)。选择自由能零点，使得给予体极小值点的自由能为 $0$，并让接受体极小值点的自由能偏移一个标准自由能变（驱动力）$\\Delta G^{0}$。因此，这两个抛物线为\n$$\nG_D(Q) = \\frac{\\kappa}{2} \\left(Q - Q_D\\right)^{2}, \n\\qquad\nG_A(Q) = \\frac{\\kappa}{2} \\left(Q - Q_A\\right)^{2} + \\Delta G^{0}.\n$$\n根据标准热力学定义，将（外层）重组能定义为\n$$\n\\lambda \\equiv G_D(Q_A) - G_D(Q_D),\n$$\n即，在不改变电子态的情况下，在给予体势能面上使介质从 $Q_D$ 形变到 $Q_A$ 所需的自由能。假设沿 $Q$ 的反应遵循经典过渡态理论，那么正向电子转移的活化自由能 $\\Delta G^{\\ddagger}$ 是 $G_D(Q)$ 和 $G_A(Q)$ 的公共交点与给予体极小值点之间的自由能差。\n\n仅从这些定义和所述模型出发，推导 $\\Delta G^{\\ddagger}$ 关于 $\\lambda$ 和 $\\Delta G^{0}$ 的解析表达式，然后代入数值 $\\lambda = 75~\\text{kJ}\\,\\text{mol}^{-1}$ 和 $\\Delta G^{0} = -25~\\text{kJ}\\,\\text{mol}^{-1}$ 进行计算。最终能量以 kJ mol$^{-1}$ 为单位表示，并将答案四舍五入到四位有效数字。", "solution": "该问题要求推导电子转移反应活化自由能 $\\Delta G^{\\ddagger}$ 的经典Marcus表达式，并使用给定参数进行数值计算。推导过程必须从问题陈述中给出的基本定义出发。\n\n该体系由两个抛物线型自由能面描述，一个是给予体态（$D$），另一个是接受体态（$A$），它们都是集体溶剂坐标 $Q$ 的函数。\n给予体势能面由下式给出：\n$$G_D(Q) = \\frac{\\kappa}{2} (Q - Q_D)^{2}$$\n接受体势能面由下式给出：\n$$G_A(Q) = \\frac{\\kappa}{2} (Q - Q_A)^{2} + \\Delta G^{0}$$\n根据构造，给予体抛物线的极小值点在 $Q_D$ 处，其中 $G_D(Q_D) = 0$。接受体抛物线的极小值点在 $Q_A$ 处，其中 $G_A(Q_A) = \\Delta G^{0}$，此即为反应的标准自由能变。\n\n重组能 $\\lambda$ 定义为体系保持在给予体电子态势能面上，从给予体平衡几何构型移动到接受体平衡几何构型所需的能量。数学上表示为：\n$$\\lambda \\equiv G_D(Q_A) - G_D(Q_D)$$\n代入给定的表达式，我们有 $G_D(Q_D) = 0$ 和 $G_D(Q_A) = \\frac{\\kappa}{2}(Q_A - Q_D)^{2}$。因此，重组能为：\n$$\\lambda = \\frac{\\kappa}{2}(Q_A - Q_D)^{2}$$\n该方程建立了 $\\lambda$ 与模型参数 $\\kappa$ 以及极小值点位移 $(Q_A - Q_D)$ 之间的直接关系。\n\n活化自由能 $\\Delta G^{\\ddagger}$ 是体系在两个抛物线交点处的自由能，相对于给予体极小值点。设该交点（对应于过渡态）的坐标为 $Q^{\\ddagger}$。那么：\n$$\\Delta G^{\\ddagger} = G_D(Q^{\\ddagger}) - G_D(Q_D) = G_D(Q^{\\ddagger})$$\n为了找到 $Q^{\\ddagger}$，我们必须通过令 $G_D(Q) = G_A(Q)$ 来求解两个抛物线的交点：\n$$G_D(Q^{\\ddagger}) = G_A(Q^{\\ddagger})$$\n$$\\frac{\\kappa}{2} (Q^{\\ddagger} - Q_D)^{2} = \\frac{\\kappa}{2} (Q^{\\ddagger} - Q_A)^{2} + \\Delta G^{0}$$\n为简化代数运算，我们引入一个无量纲反应坐标 $q$，定义为：\n$$q = \\frac{Q - Q_D}{Q_A - Q_D}$$\n这个变换将给予体极小值点 $Q_D$ 映射到 $q=0$，将接受体极小值点 $Q_A$ 映射到 $q=1$。其逆变换为 $Q = Q_D + q(Q_A - Q_D)$。\n\n现在，我们用这个无量纲坐标 $q$ 来重写自由能函数。\n对于给予体势能面：\n$$G_D(q) = \\frac{\\kappa}{2} \\left[ (Q_D + q(Q_A - Q_D)) - Q_D \\right]^{2} = \\frac{\\kappa}{2} \\left[ q(Q_A - Q_D) \\right]^{2} = q^{2} \\left[ \\frac{\\kappa}{2}(Q_A - Q_D)^{2} \\right]$$\n使用我们关于 $\\lambda$ 的表达式，上式可简化为：\n$$G_D(q) = \\lambda q^{2}$$\n对于接受体势能面：\n$$G_A(q) = \\frac{\\kappa}{2} \\left[ (Q_D + q(Q_A - Q_D)) - Q_A \\right]^{2} + \\Delta G^{0} = \\frac{\\kappa}{2} \\left[ (q-1)(Q_A - Q_D) \\right]^{2} + \\Delta G^{0}$$\n$$G_A(q) = (q-1)^{2} \\left[ \\frac{\\kappa}{2}(Q_A - Q_D)^{2} \\right] + \\Delta G^{0}$$\n这可简化为：\n$$G_A(q) = \\lambda (q-1)^{2} + \\Delta G^{0}$$\n现在，我们通过令 $G_D(q^{\\ddagger})$ 和 $G_A(q^{\\ddagger})$ 相等来找到交点坐标 $q^{\\ddagger}$：\n$$\\lambda (q^{\\ddagger})^{2} = \\lambda (q^{\\ddagger}-1)^{2} + \\Delta G^{0}$$\n$$\\lambda (q^{\\ddagger})^{2} = \\lambda \\left((q^{\\ddagger})^{2} - 2q^{\\ddagger} + 1\\right) + \\Delta G^{0}$$\n$$\\lambda (q^{\\ddagger})^{2} = \\lambda (q^{\\ddagger})^{2} - 2\\lambda q^{\\ddagger} + \\lambda + \\Delta G^{0}$$\n$\\lambda (q^{\\ddagger})^{2}$ 项相互抵消。重新整理以求解 $q^{\\ddagger}$：\n$$2\\lambda q^{\\ddagger} = \\lambda + \\Delta G^{0}$$\n$$q^{\\ddagger} = \\frac{\\lambda + \\Delta G^{0}}{2\\lambda}$$\n活化自由能 $\\Delta G^{\\ddagger}$ 是给予体势能面在交点坐标 $q^{\\ddagger}$ 处的能量值：\n$$\\Delta G^{\\ddagger} = G_D(q^{\\ddagger}) = \\lambda (q^{\\ddagger})^{2}$$\n代入 $q^{\\ddagger}$ 的表达式：\n$$\\Delta G^{\\ddagger} = \\lambda \\left( \\frac{\\lambda + \\Delta G^{0}}{2\\lambda} \\right)^{2} = \\lambda \\frac{(\\lambda + \\Delta G^{0})^{2}}{4\\lambda^{2}}$$\n这可以简化为最终的解析表达式，即著名的Marcus方程：\n$$\\Delta G^{\\ddagger} = \\frac{(\\lambda + \\Delta G^{0})^{2}}{4\\lambda}$$\n这就是所要求的活化自由能关于重组能 $\\lambda$ 和标准自由能变 $\\Delta G^{0}$ 的解析表达式。\n\n现在，我们必须用给定的数值对该表达式进行数值计算：\n$\\lambda = 75~\\text{kJ}\\,\\text{mol}^{-1}$\n$\\Delta G^{0} = -25~\\text{kJ}\\,\\text{mol}^{-1}$\n\n将这些数值代入推导出的公式中：\n$$\\Delta G^{\\ddagger} = \\frac{(75 + (-25))^{2}}{4 \\times 75} = \\frac{(50)^{2}}{300} = \\frac{2500}{300} = \\frac{25}{3}~\\text{kJ}\\,\\text{mol}^{-1}$$\n题目要求答案四舍五入到四位有效数字。\n$$\\Delta G^{\\ddagger} = \\frac{25}{3} \\approx 8.3333...~\\text{kJ}\\,\\text{mol}^{-1}$$\n四舍五入到四位有效数字，得到 $8.333~\\text{kJ}\\,\\text{mol}^{-1}$。", "answer": "$$\\boxed{8.333}$$", "id": "2654278"}, {"introduction": "在掌握了活化能的表达式后，下一步是将其应用于预测实际的反应速率，并探索马库斯理论最著名的预测之一。本实践要求你从费米黄金定则出发，结合经典谐波溶剂模型，推导并编写一个程序来计算电子转移速率。通过这个计算实践，你将亲手验证马库斯理论的一个核心且反直觉的结论——当反应的放热程度超过重组能时，反应速率反而会下降，即进入所谓的“马库斯倒置区” [@problem_id:2654221]。", "problem": "您的任务是从基本物理原理出发，设计并实现一个程序，用于预测和诊断 Marcus 理论所描述的非绝热电子转移中倒转区的存在。考虑在经典溶剂中，于弱电子耦合极限下，由抛物线自由能面描述的供体-受体电子转移。仅从以下基本依据出发：(i) 用于非绝热跃迁的 Fermi 黄金定则，(ii) 产生抛物线自由能面的经典谐振溶剂模式，以及 (iii) 重组能 $\\lambda$ 的定义，即在不发生电荷转移的情况下，将环境从反应物构型重组到产物构型所需的能量。基于这些，推导出电子转移反应的速率表达式，该表达式依赖于温度，并且是驱动力 $\\Delta G^\\circ$、重组能 $\\lambda$、电子耦合强度 $\\lvert H \\rvert$ 和绝对温度 $T$ 的函数。您必须在核模式的经典、高温极限下进行推导，并假设与谐振浴存在线性耦合。除这些基础之外，不要预设任何特定的目标公式；推导过程必须从这些原理出发，符合逻辑地进行。\n\n程序必须实现所推导的表达式，以便为下方的每个测试案例，基于给定的驱动力列表 $\\{\\Delta G^\\circ_j\\}$，计算以下输出：\n1. 在给定的 $\\Delta G^\\circ$ 值列表中，速率达到最大值时的索引（从零开始）$i_\\mathrm{max}$。\n2. 一个布尔值 $b_\\mathrm{inv}$，用于指示列表中最放能一端的速率 $k(\\Delta G^\\circ_\\mathrm{last})$ 是否严格小于整个列表中的最大速率，即 $b_\\mathrm{inv} = \\big(k(\\Delta G^\\circ_\\mathrm{last}) < \\max_j k(\\Delta G^\\circ_j)\\big)$。这个布尔值在操作上诊断了所提供数据集最放能一端的倒转区。\n3. 无量纲比率 $r = k(\\Delta G^\\circ_\\mathrm{last})/k(\\Delta G^\\circ_\\mathrm{first})$。\n\n所有能量必须以电子伏特 ($\\mathrm{eV}$) 为单位，温度以开尔文 ($\\mathrm{K}$) 为单位，时间以秒 ($\\mathrm{s}$) 为单位。虽然电子转移速率 $k$ 的单位是 $\\mathrm{s}^{-1}$，但本问题不要求您输出速率。您必须在内部使用一致的单位计算速率，但要求的输出是一个整数、一个布尔值和一个无量纲浮点数，因此不需要输出带单位的数值。请使用单位为 $\\mathrm{eV}/\\mathrm{K}$ 的 Boltzmann 常数 $k_\\mathrm{B}$ 和单位为 $\\mathrm{eV}\\cdot\\mathrm{s}$ 的约化 Planck 常数 $\\hbar$ 以确保单位一致性。\n\n测试套件。对于每个测试案例，给定 $(\\lambda,\\lvert H\\rvert, T,\\{\\Delta G^\\circ\\})$，其中所有能量单位为 $\\mathrm{eV}$，温度单位为 $\\mathrm{K}$：\n\n- 测试 1（覆盖正常区到倒转区的通用“理想路径”）：$\\lambda = 0.6\\ \\mathrm{eV}$，$\\lvert H\\rvert = 0.005\\ \\mathrm{eV}$，$T = 300\\ \\mathrm{K}$，$\\{\\Delta G^\\circ\\} = [-0.10,-0.40,-0.60,-0.90,-1.20]\\ \\mathrm{eV}$。\n\n- 测试 2（边界情况：单点列表）：$\\lambda = 0.6\\ \\mathrm{eV}$，$\\lvert H\\rvert = 0.005\\ \\mathrm{eV}$，$T = 300\\ \\mathrm{K}$，$\\{\\Delta G^\\circ\\} = [-0.60]\\ \\mathrm{eV}$。\n\n- 测试 3（更强的重组能和更深的放能范围）：$\\lambda = 1.0\\ \\mathrm{eV}$，$\\lvert H\\rvert = 0.003\\ \\mathrm{eV}$，$T = 300\\ \\mathrm{K}$，$\\{\\Delta G^\\circ\\} = [-0.10,-0.60,-1.00,-1.50,-2.00]\\ \\mathrm{eV}$。\n\n- 测试 4（低温使 Franck–Condon 窗口变窄）：$\\lambda = 0.6\\ \\mathrm{eV}$，$\\lvert H\\rvert = 0.005\\ \\mathrm{eV}$，$T = 77\\ \\mathrm{K}$，$\\{\\Delta G^\\circ\\} = [-0.20,-0.50,-0.60,-0.80,-1.05]\\ \\mathrm{eV}$。\n\n您的程序必须根据上述定义为每个测试案例计算三元组 $\\big(i_\\mathrm{max}, b_\\mathrm{inv}, r\\big)$。最终输出格式必须是单行文本，包含一个逗号分隔的扁平化列表，该列表按顺序连接了四个测试案例的结果，并用方括号括起来。具体来说，如果测试 1 到 4 的结果分别是 $\\big(i_1,b_1,r_1\\big)$、$\\big(i_2,b_2,r_2\\big)$、$\\big(i_3,b_3,r_3\\big)$ 和 $\\big(i_4,b_4,r_4\\big)$，则打印：\n[ i1,b1,r1,i2,b2,r2,i3,b3,r3,i4,b4,r4 ]\n所有布尔值必须打印为字面量 True 或 False，所有实数必须打印为十进制浮点数。本问题不使用角度，因此不需要角度单位。不使用百分比；任何分数都应打印为小数。", "solution": "问题要求推导用于非绝热电子转移的经典 Marcus 理论速率表达式，并随后实现该表达式以分析特定的反应情景。推导必须源于指定的基本原理：Fermi 黄金定则、经典谐振溶剂模型以及重组能的标准定义。所述问题具有科学依据，定义明确且客观。它构成了理论物理化学中一个标准但并非无足轻重的练习。因此，该问题被认为是有效的。\n\n我们按照指示开始推导。\n\n**1. 基本原理**\n\n对于由弱电子耦合 $H = \\langle R | \\hat{H} | P \\rangle$ 促成的、在初反应物态 $|R\\rangle$ 和末产物态 $|P\\rangle$ 之间的非绝热跃迁，其速率常数 $k$ 由 Fermi 黄金定则给出：\n$$\nk = \\frac{2\\pi}{\\hbar} |H|^2 \\rho_{FC}\n$$\n此处，$\\hbar$ 是约化 Planck 常数，$\\rho_{FC}$ 代表 Franck-Condon 加权态密度。该项概括了核自由度（在此案例中为溶剂环境）对跃迁速率的贡献。\n\n溶剂通过单一的广义谐振反应坐标进行经典建模，我们将其表示为 $q$。反应物 (R) 和产物 (P) 态的自由能面是该坐标的抛物线函数：\n$$\nG_R(q) = \\lambda q^2\n$$\n$$\nG_P(q) = \\lambda(q-1)^2 + \\Delta G^\\circ\n$$\n此处，$q=0$ 对应于反应物电子态的平衡溶剂构型，而 $q=1$ 对应于产物态的平衡溶剂构型。$\\Delta G^\\circ$ 是标准反应自由能，或称驱动力。参数 $\\lambda$ 是重组能，定义为在不发生电子转移的情况下，将反应物体系从其平衡几何构型（$q=0$）扭曲到产物的平衡几何构型（$q=1$）所需的能量。这与我们的公式一致，因为 $G_R(1) = \\lambda(1)^2 = \\lambda$。\n\n**2. 活化自由能的推导**\n\n在经典 Marcus 图像中，电子转移发生在两个自由能面的交点处，在此交点，体系在两种电子态下具有相同的能量。这个交点 $q^\\ddagger$ 可以通过设置 $G_R(q) = G_P(q)$ 来找到：\n$$\n\\lambda (q^\\ddagger)^2 = \\lambda(q^\\ddagger-1)^2 + \\Delta G^\\circ\n$$\n展开二次项并化简可得：\n$$\n\\lambda (q^\\ddagger)^2 = \\lambda((q^\\ddagger)^2 - 2q^\\ddagger + 1) + \\Delta G^\\circ\n$$\n$$\n0 = -2\\lambda q^\\ddagger + \\lambda + \\Delta G^\\circ\n$$\n求解 $q^\\ddagger$：\n$$\nq^\\ddagger = \\frac{\\lambda + \\Delta G^\\circ}{2\\lambda}\n$$\n经典活化自由能 $\\Delta G^\\ddagger$ 是将体系沿反应物能面从其平衡构型（$q=0$）移动到过渡态构型（$q=q^\\ddagger$）所需的能量：\n$$\n\\Delta G^\\ddagger = G_R(q^\\ddagger) - G_R(0) = \\lambda (q^\\ddagger)^2 = \\lambda \\left( \\frac{\\lambda + \\Delta G^\\circ}{2\\lambda} \\right)^2\n$$\n$$\n\\Delta G^\\ddagger = \\frac{(\\lambda + \\Delta G^\\circ)^2}{4\\lambda}\n$$\n这就是著名的 Marcus 活化能垒表达式。\n\n**3. Franck-Condon 因子的推导**\n\n在高温（经典）极限下，Franck-Condon 项 $\\rho_{FC}$ 是找到体系处于满足跃迁能量守恒的构型的热平均概率。这等效于在交点处找到体系。我们可以使用反应物的 Boltzmann 概率分布 $P_R(q)$ 和一个 delta 函数来强制执行交叉条件，从而正式地写出 $\\rho_{FC}$：\n$$\n\\rho_{FC} = \\int_{-\\infty}^{\\infty} P_R(q) \\, \\delta(G_R(q) - G_P(q)) \\, dq\n$$\n谐振子的概率分布 $P_R(q)$ 是一个高斯函数：\n$$\nP_R(q) = \\frac{e^{-G_R(q) / (k_B T)}}{Z_R} = \\frac{e^{-\\lambda q^2 / (k_B T)}}{\\int_{-\\infty}^{\\infty} e^{-\\lambda q^2 / (k_B T)} dq}\n$$\n分母中的配分函数是 $Z_R = \\sqrt{\\pi k_B T / \\lambda}$。delta 函数的自变量是 $g(q) = G_R(q) - G_P(q) = 2\\lambda q - \\lambda - \\Delta G^\\circ$。$g(q)=0$ 的根是 $q^\\ddagger = (\\lambda + \\Delta G^\\circ)/(2\\lambda)$，其导数是 $g'(q) = 2\\lambda$。利用 delta 函数的性质 $\\int f(x)\\delta(g(x))dx = f(x_0)/|g'(x_0)|$，该积分变为：\n$$\n\\rho_{FC} = \\frac{P_R(q^\\ddagger)}{|g'(q^\\ddagger)|} = \\frac{1}{Z_R} \\frac{e^{-\\lambda(q^\\ddagger)^2 / (k_B T)}}{|2\\lambda|} = \\frac{1}{\\sqrt{\\pi k_B T / \\lambda}} \\frac{e^{-\\Delta G^\\ddagger / (k_B T)}}{2\\lambda}\n$$\n化简此表达式可得：\n$$\n\\rho_{FC} = \\frac{1}{\\sqrt{4\\pi\\lambda k_B T}} e^{-\\Delta G^\\ddagger / (k_B T)}\n$$\n\n**4. 最终速率表达式**\n\n将 $\\rho_{FC}$ 的表达式和推导出的活化能 $\\Delta G^\\ddagger$ 代回 Fermi 黄金定则，可得到用于电子转移速率的经典 Marcus 方程：\n$$\nk(\\Delta G^\\circ, \\lambda, |H|, T) = \\frac{2\\pi |H|^2}{\\hbar \\sqrt{4\\pi \\lambda k_B T}} \\exp\\left(-\\frac{(\\lambda + \\Delta G^\\circ)^2}{4\\lambda k_B T}\\right)\n$$\n该方程提供了作为驱动力 $\\Delta G^\\circ$、重组能 $\\lambda$、电子耦合 $|H|$ 和温度 $T$ 的函数的速率。它精确地描述了 Marcus 预测的三个区域：正常区（$\\Delta G^\\circ > -\\lambda$）、无活化区（$\\Delta G^\\circ = -\\lambda$）和倒转区（$\\Delta G^\\circ < -\\lambda$）。\n\n**5. 程序化实现**\n\n程序将实现这个最终的速率表达式。对于由一组参数 $(\\lambda, |H|, T, \\{\\Delta G^\\circ_j\\})$ 定义的每个测试案例，执行以下步骤：\n1. 对于输入列表中的每个相应驱动力 $\\Delta G^\\circ_j$，计算出一系列速率 $\\{k_j\\}$。使用的物理常数是 $k_B = 8.617333262 \\times 10^{-5} \\ \\mathrm{eV/K}$ 和 $\\hbar = 6.582119569 \\times 10^{-16} \\ \\mathrm{eV}\\cdot\\mathrm{s}$。\n2. 通过在计算出的速率列表 $\\{k_j\\}$ 中找到最大值的索引来确定索引 $i_\\mathrm{max}$。\n3. 如果最后一个（最放能的）驱动力下的速率 $k_\\mathrm{last}$ 严格小于找到的最大速率 $k_\\mathrm{max} = \\max_j k_j$，则布尔标志 $b_\\mathrm{inv}$ 的值为 True。否则，其值为 False。\n4. 无量纲比率 $r$ 计算为 $r = k_\\mathrm{last} / k_\\mathrm{first}$，其中 $k_\\mathrm{first}$ 是列表中第一个驱动力对应的速率。\n\n此过程应用于所有测试案例，所得的三元组 $(i_\\mathrm{max}, b_\\mathrm{inv}, r)$ 被连接成一个单一列表用于输出。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the Marcus theory problem by deriving and applying the classical rate equation.\n    \"\"\"\n    # Physical constants in specified units\n    # Boltzmann constant in eV/K\n    KB_EV_K = 8.617333262145e-5\n    # Reduced Planck constant in eV*s\n    HBAR_EV_S = 6.582119569e-16\n\n    # Test cases from the problem statement\n    # Format: (lambda (eV), |H| (eV), T (K), list of Delta G^0 (eV))\n    test_cases = [\n        (0.6, 0.005, 300, [-0.10, -0.40, -0.60, -0.90, -1.20]),\n        (0.6, 0.005, 300, [-0.60]),\n        (1.0, 0.003, 300, [-0.10, -0.60, -1.00, -1.50, -2.00]),\n        (0.6, 0.005, 77, [-0.20, -0.50, -0.60, -0.80, -1.05]),\n    ]\n\n    # This function implements the classical Marcus theory rate equation\n    def calculate_marcus_rate(delta_G, lam, H_mag, T):\n        \"\"\"\n        Calculates the nonadiabatic electron transfer rate using the classical Marcus equation.\n        \n        Args:\n            delta_G (float): Driving force in eV.\n            lam (float): Reorganization energy in eV.\n            H_mag (float): Magnitude of electronic coupling in eV.\n            T (float): Absolute temperature in K.\n            \n        Returns:\n            float: The electron transfer rate in s^-1.\n        \"\"\"\n        if lam = 0 or T = 0:\n            return 0.0\n            \n        k_B_T = KB_EV_K * T\n        \n        # Activation free energy\n        delta_G_ddagger = (lam + delta_G)**2 / (4 * lam)\n        \n        # Pre-exponential factor\n        prefactor = (2 * np.pi / HBAR_EV_S) * (H_mag**2) / np.sqrt(4 * np.pi * lam * k_B_T)\n        \n        # Exponential term\n        exponent = -delta_G_ddagger / k_B_T\n        \n        rate = prefactor * np.exp(exponent)\n        \n        return rate\n\n    all_results = []\n    for lam, H_mag, T, delta_G_list in test_cases:\n        # Calculate rates for the list of driving forces\n        rates = np.array([calculate_marcus_rate(dg, lam, H_mag, T) for dg in delta_G_list])\n\n        # 1. Find the index of the maximum rate\n        i_max = np.argmax(rates)\n        \n        # Handle the case of a single-point list where argmax is always 0\n        # The logic naturally handles this, but it's good to be aware.\n        \n        # 2. Diagnose the inverted region\n        max_rate = rates[i_max]\n        last_rate = rates[-1]\n        b_inv = last_rate  max_rate\n        \n        # 3. Calculate the rate ratio\n        first_rate = rates[0]\n        # Avoid division by zero, though not expected in these test cases\n        if first_rate > 0:\n            r = last_rate / first_rate\n        else:\n            r = np.inf if last_rate > 0 else 0.0 # Or some other indicator for an edge case\n\n        # Append the triplet of results\n        all_results.extend([i_max, b_inv, r])\n\n    # Format the final output string as specified\n    # map(str, ...) converts all items (int, bool, float) to their string representations\n    output_str = f\"[{','.join(map(str, all_results))}]\"\n    print(output_str)\n\nsolve()\n```", "id": "2654221"}, {"introduction": "理论模型的美妙之处在于其预测能力，但其参数的现实意义和获取途径同样重要。本练习旨在连接抽象的马库斯理论与现代计算化学实践，特别是分子动力学（MD）模拟。你将学习如何利用涨落-耗散定理的关键思想，从 MD 模拟中收集的垂直能隙（vertical energy gap）的统计数据（均值和方差），直接计算出理论中的核心参数——重组能 $\\lambda$ 和反应自由能 $\\Delta G^{\\circ}$ [@problem_id:2654293]。这个过程清晰地展示了如何从计算模拟中提取宏观热力学量，为理论验证和预测提供了坚实的数据基础。", "problem": "对一个温度为 $T = 298$ K 的给体-受体电子转移体系进行分子动力学 (MD) 模拟，得到了在状态 A (反应物) 和状态 B (产物) 的正则系综中采样的瞬时垂直能隙 $\\Delta \\equiv U_B - U_A$ 的分布。其直方图可以用具有相同标准差的高斯概率密度函数 (PDF) 很好地描述，这与谐波溶剂响应 (线性响应) 一致。提取的统计数据如下：\n- 状态 A 中的平均值：$\\langle \\Delta \\rangle_A = 0.97893$ eV。\n- 状态 B 中的平均值：$\\langle \\Delta \\rangle_B = -0.57893$ eV。\n- 两个状态下的标准差：$s = 0.20000$ eV。\n\n假设：\n- 正则系综满足 $P_i(\\Delta) \\propto \\exp[-\\beta F_i(\\Delta)]$，其中 $i \\in \\{A,B\\}$，$F_i(\\Delta)$ 是沿 $\\Delta$ 的朗道自由能，且 $\\beta \\equiv 1/(k_B T)$。\n- 围绕每个电子态的溶剂涨落是谐波的 (线性响应)，这导致了能隙的高斯统计特性、两态中相等的方差以及沿 $\\Delta$ 具有相等曲率的抛物线形自由能曲线。\n- 玻尔兹曼常数 $k_B = 8.617333262 \\times 10^{-5}$ eV/K。\n\n任务：\n1) 从玻尔兹曼关系和谐波假设出发，证明 $F_i(\\Delta)$ 是 $\\Delta$ 的二次函数，并且高斯方差 $s^2$ 与曲率相关。利用 A 和 B 之间标准自由能差 $\\Delta G^\\circ$ 的自由能微扰恒等式，用测得的 $\\Delta$ 的平均值和方差来表达重组能 $\\lambda$ 和 $\\Delta G^\\circ$。\n2) 使用这些关系，为等曲率抛物线面的电子转移过程推导活化自由能垒 $\\Delta G^{\\ddagger}$ 关于 $\\lambda$ 和 $\\Delta G^\\circ$ 的解析表达式。\n3) 使用所提供的数据数值计算 $\\Delta G^{\\ddagger}$。将最终的活化自由能以电子伏特 (eV) 为单位表示，并将答案四舍五入到四位有效数字。", "solution": "对问题陈述进行验证。\n\n**第一步：提取已知条件**\n- 温度：$T = 298$ K。\n- 体系：一个给体-受体电子转移体系。\n- 可观测量：瞬时垂直能隙 $\\Delta \\equiv U_B - U_A$。\n- 系综：状态 A (反应物) 和状态 B (产物) 的正则系综。\n- 概率密度函数 (PDF)：$\\Delta$ 的直方图呈高斯分布，且具有相同的标准差 $s$。\n- 状态 A 的统计数据：平均值 $\\langle \\Delta \\rangle_A = 0.97893$ eV。\n- 状态 B 的统计数据：平均值 $\\langle \\Delta \\rangle_B = -0.57893$ eV。\n- 两个状态下的标准差：$s = 0.20000$ eV。\n- 假设 1：PDF 遵循玻尔兹曼关系 $P_i(\\Delta) \\propto \\exp[-\\beta F_i(\\Delta)]$，其中 $i \\in \\{A,B\\}$，$F_i(\\Delta)$ 是朗道自由能，$\\beta \\equiv 1/(k_B T)$。\n- 假设 2：体系表现出谐波 (线性响应) 溶剂涨落，导致 $\\Delta$ 的高斯统计特性、两态中相等的方差以及沿 $\\Delta$ 具有相等曲率的抛物线形自由能曲线。\n- 常数：玻尔兹曼常数 $k_B = 8.617333262 \\times 10^{-5}$ eV/K。\n\n**第二步：使用提取的已知条件进行验证**\n该问题具有科学依据，是电子转移 Marcus 理论的一个标准应用，而 Marcus 理论是化学动力学中的一个基本概念。线性响应、谐波势和高斯统计的假设是基本 Marcus 模型的基础。所提供的数据在量纲上是一致的 (所有能量单位均为 eV)，且数值对于分子体系而言是物理上合理的。该问题是适定的，提供了足够的信息来推导所要求的量。语言客观而精确。该问题并非简单，因为它要求正确应用统计力学（$\\Delta$ 的涨落）和热力学（自由能面）之间的关系。\n\n**第三步：结论与行动**\n该问题被判定为**有效**。将提供完整的解答。\n\n***\n\n**任务 1：自由能曲线以及 $\\lambda$ 和 $\\Delta G^\\circ$ 表达式的推导**\n\n问题假设能隙的概率密度 $P_i(\\Delta)$ 与产生该涨落的朗道自由能 $F_i(\\Delta)$ 之间存在关系 $P_i(\\Delta) \\propto \\exp[-\\beta F_i(\\Delta)]$。同时，已知 $P_i(\\Delta)$ 是一个高斯函数。对于状态 A，该概率密度函数以其平均值 $\\langle \\Delta \\rangle_A$ 为中心，标准差为 $s$：\n$$P_A(\\Delta) = \\mathcal{N} \\exp\\left[-\\frac{(\\Delta - \\langle \\Delta \\rangle_A)^2}{2s^2}\\right]$$\n其中 $\\mathcal{N}$ 是归一化常数。\n\n通过比较 $P_A(\\Delta)$ 两个表达式的指数部分，我们发现：\n$$-\\beta F_A(\\Delta) = -\\frac{(\\Delta - \\langle \\Delta \\rangle_A)^2}{2s^2} + C$$\n其中 $C$ 是一个常数。整理得到 $F_A(\\Delta)$：\n$$F_A(\\Delta) = \\frac{1}{2\\beta s^2}(\\Delta - \\langle \\Delta \\rangle_A)^2 + C'$$\n此方程表明自由能曲线 $F_A(\\Delta)$ 是能隙 $\\Delta$ 的二次（抛物线）函数。这条抛物线的曲率由其对 $\\Delta$ 的二阶导数给出，该导数为常数：\n$$\\frac{d^2 F_A}{d\\Delta^2} = \\frac{1}{\\beta s^2}$$\n由于两个状态的 $s$ 相同，自由能曲线 $F_A(\\Delta)$ 和 $F_B(\\Delta)$ 的曲率也相同，这与问题的假设一致。\n\n为求得重组能 $\\lambda$ 和标准反应自由能 $\\Delta G^\\circ$ 的表达式，我们利用线性响应理论的结果。在该框架下，反应物 (A) 和产物 (B) 态的自由能面是作为集体溶剂坐标 $q$ 的函数的抛物线。设状态 A 的抛物线最小值点在 $q=0$ 处，状态 B 的在 $q=q_0$ 处。\n$$G_A(q) = \\frac{1}{2} k q^2$$\n$$G_B(q) = \\frac{1}{2} k (q-q_0)^2 + \\Delta G^\\circ$$\n重组能 $\\lambda$ 是将反应物体系从其平衡构型扭曲到产物的平衡构型所需的能量：$\\lambda = G_A(q_0) = \\frac{1}{2} k q_0^2$。\n垂直能隙 $\\Delta$ 是坐标 $q$ 的函数：$\\Delta(q) = G_B(q) - G_A(q)$。\n$$\\Delta(q) = \\left(\\frac{1}{2} k (q-q_0)^2 + \\Delta G^\\circ\\right) - \\left(\\frac{1}{2} k q^2\\right) = -k q_0 q + \\frac{1}{2} k q_0^2 + \\Delta G^\\circ = -k q_0 q + \\lambda + \\Delta G^\\circ$$\n状态 A 中的平均能隙是在其平衡位置 $q=0$ 附近采样的。因此：\n$$\\langle \\Delta \\rangle_A = \\Delta(q=0) = \\lambda + \\Delta G^\\circ$$\n状态 B 中的平均能隙是在其平衡位置 $q=q_0$ 附近采样的。因此：\n$$\\langle \\Delta \\rangle_B = \\Delta(q=q_0) = -k q_0^2 + \\lambda + \\Delta G^\\circ = -2\\lambda + \\lambda + \\Delta G^\\circ = -\\lambda + \\Delta G^\\circ$$\n我们现在得到了一个关于 $\\lambda$ 和 $\\Delta G^\\circ$ 的二元线性方程组：\n1) $\\langle \\Delta \\rangle_A = \\lambda + \\Delta G^\\circ$\n2) $\\langle \\Delta \\rangle_B = -\\lambda + \\Delta G^\\circ$\n\n方程 (1) 减去方程 (2) 得到：\n$$\\langle \\Delta \\rangle_A - \\langle \\Delta \\rangle_B = (\\lambda + \\Delta G^\\circ) - (-\\lambda + \\Delta G^\\circ) = 2\\lambda$$\n$$\\lambda = \\frac{1}{2} (\\langle \\Delta \\rangle_A - \\langle \\Delta \\rangle_B)$$\n方程 (1) 和方程 (2) 相加得到：\n$$\\langle \\Delta \\rangle_A + \\langle \\Delta \\rangle_B = (\\lambda + \\Delta G^\\circ) + (-\\lambda + \\Delta G^\\circ) = 2\\Delta G^\\circ$$\n$$\\Delta G^\\circ = \\frac{1}{2} (\\langle \\Delta \\rangle_A + \\langle \\Delta \\rangle_B)$$\n这些就是所求的表达式。自由能微扰恒等式 $\\exp(-\\beta \\Delta G^\\circ) = \\langle \\exp(-\\beta \\Delta) \\rangle_A$ 在应用于高斯分布时，会得到 $\\Delta G^\\circ = \\langle \\Delta \\rangle_A - \\frac{1}{2}\\beta s^2$。将此与 $\\langle \\Delta \\rangle_A = \\lambda + \\Delta G^\\circ$ 进行比较，我们得到涨落-耗散关系 $\\lambda = \\frac{1}{2}\\beta s^2$，这证实了模型的一致性。\n\n**任务 2：活化自由能 $\\Delta G^{\\ddagger}$ 的推导**\n\n活化自由能 $\\Delta G^{\\ddagger}$ 是从反应物能量最低点到过渡态的能垒高度。过渡态（坐标记为 $q^{\\ddagger}$）是反应物和产物自由能面相交的点：$G_A(q^{\\ddagger}) = G_B(q^{\\ddagger})$。\n$$\\frac{1}{2} k (q^{\\ddagger})^2 = \\frac{1}{2} k (q^{\\ddagger}-q_0)^2 + \\Delta G^\\circ$$\n展开平方项并简化：\n$$(q^{\\ddagger})^2 = (q^{\\ddagger})^2 - 2q^{\\ddagger}q_0 + q_0^2 + \\frac{2\\Delta G^\\circ}{k}$$\n$$2q^{\\ddagger}q_0 = q_0^2 + \\frac{2\\Delta G^\\circ}{k}$$\n$$q^{\\ddagger} = \\frac{q_0}{2} + \\frac{\\Delta G^\\circ}{kq_0}$$\n活化能为 $\\Delta G^{\\ddagger} = G_A(q^{\\ddagger}) = \\frac{1}{2} k (q^{\\ddagger})^2$。\n$$\\Delta G^{\\ddagger} = \\frac{1}{2} k \\left( \\frac{q_0}{2} + \\frac{\\Delta G^\\circ}{kq_0} \\right)^2 = \\frac{1}{2} k \\left( \\frac{q_0^2}{4} + \\frac{\\Delta G^\\circ}{k} + \\frac{(\\Delta G^\\circ)^2}{k^2 q_0^2} \\right)$$\n$$\\Delta G^{\\ddagger} = \\frac{k q_0^2}{8} + \\frac{\\Delta G^\\circ}{2} + \\frac{(\\Delta G^\\circ)^2}{2 k q_0^2}$$\n我们代入重组能的表达式 $\\lambda = \\frac{1}{2} k q_0^2$，这意味着 $k q_0^2 = 2\\lambda$：\n$$\\Delta G^{\\ddagger} = \\frac{2\\lambda}{8} + \\frac{\\Delta G^\\circ}{2} + \\frac{(\\Delta G^\\circ)^2}{2(2\\lambda)} = \\frac{\\lambda}{4} + \\frac{\\Delta G^\\circ}{2} + \\frac{(\\Delta G^\\circ)^2}{4\\lambda}$$\n这个表达式可以因式分解成一个更紧凑的形式：\n$$\\Delta G^{\\ddagger} = \\frac{1}{4\\lambda} \\left( \\lambda^2 + 2\\lambda\\Delta G^\\circ + (\\Delta G^\\circ)^2 \\right)$$\n因此，活化自由能的最终解析表达式为：\n$$\\Delta G^{\\ddagger} = \\frac{(\\lambda + \\Delta G^\\circ)^2}{4\\lambda}$$\n\n**任务 3：$\\Delta G^{\\ddagger}$ 的数值计算**\n\n首先，我们使用任务 1 中的表达式和所提供的数据计算 $\\lambda$ 和 $\\Delta G^\\circ$ 的数值：\n$\\langle \\Delta \\rangle_A = 0.97893$ eV\n$\\langle \\Delta \\rangle_B = -0.57893$ eV\n\n$$\\lambda = \\frac{1}{2} (0.97893 \\, \\text{eV} - (-0.57893 \\, \\text{eV})) = \\frac{1}{2} (1.55786 \\, \\text{eV}) = 0.77893 \\, \\text{eV}$$\n$$\\Delta G^\\circ = \\frac{1}{2} (0.97893 \\, \\text{eV} + (-0.57893 \\, \\text{eV})) = \\frac{1}{2} (0.40000 \\, \\text{eV}) = 0.20000 \\, \\text{eV}$$\n\n接下来，我们将这些值代入任务 2 中推导出的 $\\Delta G^{\\ddagger}$ 表达式中：\n$$\\Delta G^{\\ddagger} = \\frac{(\\lambda + \\Delta G^\\circ)^2}{4\\lambda} = \\frac{(0.77893 \\, \\text{eV} + 0.20000 \\, \\text{eV})^2}{4 \\times 0.77893 \\, \\text{eV}}$$\n$$\\Delta G^{\\ddagger} = \\frac{(0.97893 \\, \\text{eV})^2}{3.11572 \\, \\text{eV}} = \\frac{0.9583039... \\, \\text{eV}^2}{3.11572 \\, \\text{eV}} = 0.307563... \\, \\text{eV}$$\n\n问题要求将最终答案四舍五入到四位有效数字。\n$$\\Delta G^{\\ddagger} \\approx 0.3076 \\, \\text{eV}$$", "answer": "$$\n\\boxed{0.3076}\n$$", "id": "2654293"}]}