{"hands_on_practices": [{"introduction": "本节的第一个练习将引导你完成扩散驱动不稳定性条件的基石性数学推导。通过处理一个通用的 $2 \\times 2$ 雅可比矩阵 $J$，你将练习应用线性稳定性分析，以找到一个稳定系统可被扩散作用去稳定的参数空间，这个现象是模式形成的核心。[@problem_id:2661473]", "problem": "考虑一个一维空间中的双物种反应-扩散系统，该系统已进行无量纲化，使得第一个物种的扩散系数为1。设在均匀稳态附近的局部反应动力学线性化由雅可比矩阵表示\n$$\nJ \\;=\\;\n\\begin{pmatrix}\n1 & -2 \\\\\n3 & -5\n\\end{pmatrix},\n$$\n且扩散矩阵为\n$$\nD \\;=\\; \\operatorname{diag}(1,d),\n$$\n其中 $d>0$ 是第二个物种相对于第一个物种的（无量纲）扩散系数之比。用 $f_u$、$f_v$、$g_u$ 和 $g_v$ 表示在稳态下的反应速率的偏导数，因此 $J=\\begin{pmatrix} f_u & f_v \\\\ g_u & g_v \\end{pmatrix}$。\n\n从反应-扩散偏微分方程（PDE）中波数为 $k$ 的傅里叶模式微扰下空间均匀稳态的线性稳定性分析出发，并仅使用以下基本事实：（i）无扩散时动力学的稳定性要求迹 $\\tau=f_u+g_v$ 为负，行列式 $\\Delta=f_u g_v - f_v g_u$ 为正；（ii）扩散通过从 $J$ 中减去 $k^2 D$ 来修正线性算子。请完成以下任务：\n\n1. 推导增长率作为 $k^2$ 函数的色散关系，并由此获得尽管无扩散时动力学稳定，但仍存在扩散驱动不稳定性（图灵不稳定性）的充分必要条件。\n\n2. 将这些条件应用于给定的 $J$ 和 $D$，以确定发生图灵不稳定性的 $d$ 的范围。在该范围内，推导出不稳定波数带的端点 $k_{-}^2$ 和 $k_{+}^2$ 作为 $d$ 的函数的显式表达式。\n\n3. 确定临界扩散比 $d_c$（可能发生图灵不稳定性的最小 $d$ 值），并计算相应的临界波数 $k_c^2$（在此波数下，两个带端点在临界点合并）。\n\n将您的最终答案以单行矩阵 $\\bigl(d_c,\\,k_c^2\\bigr)$ 的形式给出。无需四舍五入；给出精确值。假设所有量都是无量纲的，因此无需报告物理单位。最终答案中不要包含任何不等式。", "solution": "该问题要求对一个双物种反应-扩散系统进行线性稳定性分析。系统的状态由浓度向量 $\\mathbf{c} = (u,v)^T$ 描述。从一个均匀稳态 $\\mathbf{c}_0$ 出发的小微扰 $\\delta\\mathbf{c}$ 的演化由以下线性化偏微分方程控制：\n$$ \\frac{\\partial}{\\partial t} \\delta\\mathbf{c} = J \\delta\\mathbf{c} + D \\nabla^2 \\delta\\mathbf{c} $$\n其中 $J$ 是反应动力学的雅可比矩阵，$D$ 是扩散系数的对角矩阵，两者都在稳态 $\\mathbf{c}_0$ 下求值。给定：\n$$ J = \\begin{pmatrix} f_u & f_v \\\\ g_u & g_v \\end{pmatrix} = \\begin{pmatrix} 1 & -2 \\\\ 3 & -5 \\end{pmatrix}, \\quad D = \\begin{pmatrix} 1 & 0 \\\\ 0 & d \\end{pmatrix} $$\n我们考虑一维空间中的傅里叶模式微扰 $\\delta\\mathbf{c}(x,t) = \\mathbf{u}_k \\exp(\\lambda t + i k x)$，其中 $k$ 是波数，$\\lambda$ 是增长率。将此代入控制方程，得到关于 $\\lambda$ 的特征值问题：\n$$ \\lambda \\mathbf{u}_k = (J - k^2 D) \\mathbf{u}_k $$\n增长率 $\\lambda$ 是矩阵 $J_k = J - k^2 D$ 的特征值。对于给定的波数 $k$，系统的稳定性由这些特征值实部的符号决定。特征值是特征多项式 $\\det(J_k - \\lambda I) = 0$ 的根，即\n$$ \\lambda^2 - \\tau_k \\lambda + \\Delta_k = 0 $$\n其中 $\\tau_k = \\operatorname{tr}(J_k)$ 且 $\\Delta_k = \\operatorname{det}(J_k)$。\n具体来说，迹为：\n$$ \\tau_k = \\operatorname{tr}(J - k^2 D) = (f_u - k^2) + (g_v - d k^2) = (f_u + g_v) - (1+d)k^2 = \\tau - (1+d)k^2 $$\n行列式为：\n$$ \\Delta_k = \\det(J - k^2 D) = (f_u - k^2)(g_v - d k^2) - f_v g_u = (f_u g_v - f_v g_u) - (d f_u + g_v)k^2 + d k^4 = \\Delta - (d f_u + g_v)k^2 + d k^4 $$\n当稳态对纯时间微扰（即 $k=0$ 时）稳定，但对某个波数 $k \\neq 0$ 的空间微扰不稳定时，就会发生扩散驱动的不稳定性，即图灵不稳定性。\n\n首先，我们验证没有扩散（$k=0$）时动力学的稳定性。$J$ 的特征值必须具有负实部。这要求 $\\tau = \\operatorname{tr}(J) < 0$ 且 $\\Delta = \\det(J) > 0$。对于给定的雅可比矩阵：\n$$ \\tau = f_u + g_v = 1 + (-5) = -4 $$\n$$ \\Delta = f_u g_v - f_v g_u = (1)(-5) - (-2)(3) = -5 + 6 = 1 $$\n由于 $\\tau = -4 < 0$ 且 $\\Delta = 1 > 0$，因此如题目所述，在没有扩散的情况下，空间均匀稳态是稳定的。\n\n接下来，我们寻求由扩散驱动的不稳定性的条件，即对于某个 $k^2 > 0$ 有 $\\operatorname{Re}(\\lambda) > 0$。特征方程的根为 $\\lambda = (\\tau_k \\pm \\sqrt{\\tau_k^2 - 4\\Delta_k}) / 2$。鉴于 $\\tau < 0$ 且 $d>0$，可知 $\\tau_k = \\tau - (1+d)k^2$ 对任何 $k$ 始终为负。因此，霍普夫分岔（Hopf bifurcation，即对某个 $k$ 有 $\\tau_k=0$）是不可能发生的。不稳定性只能在某个特征值变为实数且为正时出现。由于 $\\tau_k < 0$，要使 $\\lambda$ 为正，我们必须有 $\\sqrt{\\tau_k^2 - 4\\Delta_k} > -\\tau_k$，这等价于 $\\tau_k^2 - 4\\Delta_k > \\tau_k^2$，即 $\\Delta_k < 0$。\n\n因此，扩散驱动不稳定性的条件是 $\\Delta_k$ 必须在某个正的 $k^2$ 范围内为负。令 $K = k^2$。函数 $\\Delta_k(K) = d K^2 - (d f_u + g_v)K + \\Delta$ 是一个关于 $K$ 的开口向上的抛物线（因为 $d>0$）。在 $K=0$ 时，$\\Delta_k(0) = \\Delta > 0$。要使该抛物线在某个 $K>0$ 的区间内为负，必须满足两个条件：\n1. 抛物线的顶点必须位于正的 $K$ 值处。最小值出现在 $K = (d f_u + g_v)/(2d)$。这要求 $d f_u + g_v > 0$。\n2. 在此最小值处的 $\\Delta_k$ 值必须为负。最小值为 $\\Delta - (d f_u + g_v)^2 / (4d)$。因此，我们需要 $\\Delta - (d f_u + g_v)^2 / (4d) < 0$，这等价于 $(d f_u + g_v)^2 > 4d\\Delta$。\n这就完成了图灵不稳定性的一般充分必要条件的推导。\n\n现在我们将这些条件应用于给定的问题。当 $f_u=1$，$g_v=-5$，且 $\\Delta=1$ 时，条件变为：\n1. $d(1) + (-5) > 0 \\implies d > 5$。\n2. $(d(1) - 5)^2 > 4d(1) \\implies (d-5)^2 > 4d$。\n展开第二个不等式得到 $d^2 - 10d + 25 > 4d$，简化为 $d^2 - 14d + 25 > 0$。为了找出此不等式成立的条件，我们求解二次方程 $d^2 - 14d + 25 = 0$ 的根：\n$$ d = \\frac{14 \\pm \\sqrt{(-14)^2 - 4(1)(25)}}{2} = \\frac{14 \\pm \\sqrt{196 - 100}}{2} = \\frac{14 \\pm \\sqrt{96}}{2} = \\frac{14 \\pm 4\\sqrt{6}}{2} = 7 \\pm 2\\sqrt{6} $$\n抛物线 $d^2 - 14d + 25$ 在 $d > 7+2\\sqrt{6}$ 或 $d < 7-2\\sqrt{6}$ 时为正。我们必须同时满足这个条件和 $d>5$。\n根 $7-2\\sqrt{6} = 7-\\sqrt{24}$ 在 2 和 3 之间，因此区域 $d < 7-2\\sqrt{6}$ 与 $d>5$ 不相容。\n根 $7+2\\sqrt{6} = 7+\\sqrt{24}$ 大于 $7+\\sqrt{16}=11$，所以条件 $d > 7+2\\sqrt{6}$ 蕴含了 $d>5$。\n因此，发生图灵不稳定性的扩散比 $d$ 的范围是 $d > 7+2\\sqrt{6}$。\n\n不稳定波数带 $(k_{-}^2, k_{+}^2)$ 是 $\\Delta_k < 0$ 的 $k^2 > 0$ 的区间。端点 $k_{-}^2$ 和 $k_{+}^2$ 是方程 $\\Delta_k = d(k^2)^2 - (d-5)k^2 + 1 = 0$ 的根。对 $k^2$ 使用二次公式：\n$$ k^2 = \\frac{(d-5) \\pm \\sqrt{(d-5)^2 - 4d}}{2d} = \\frac{d-5 \\pm \\sqrt{d^2 - 14d + 25}}{2d} $$\n对于 $d > 7+2\\sqrt{6}$，判别式为正，并且由于 $d>5$，根的和 $(d-5)/d$ 与根的积 $1/d$ 均为正，这保证了 $k^2$ 有两个不同的正根。端点是：\n$$ k_{-}^2 = \\frac{d-5 - \\sqrt{d^2 - 14d + 25}}{2d}, \\quad k_{+}^2 = \\frac{d-5 + \\sqrt{d^2 - 14d + 25}}{2d} $$\n\n最后，我们确定临界扩散比 $d_c$ 和相应的临界波数 $k_c^2$。不稳定的临界点发生在满足不稳定性条件的最小 $d$ 值处。这对应于不稳定带出现的点，即当 $k_{-}^2 = k_{+}^2$ 时。这种情况发生在关于 $k^2$ 的二次方程的判别式为零时：\n$$ d_c^2 - 14d_c + 25 = 0 $$\n如前所述，满足约束条件 $d_c > 5$ 的唯一根是 $d_c = 7+2\\sqrt{6}$。这就是临界扩散比。\n\n在这个临界值下，波数 $k_c^2$ 是唯一的：\n$$ k_c^2 = \\frac{d_c - 5}{2d_c} $$\n代入 $d_c$ 的表达式：\n$$ k_c^2 = \\frac{(7+2\\sqrt{6}) - 5}{2(7+2\\sqrt{6})} = \\frac{2+2\\sqrt{6}}{2(7+2\\sqrt{6})} = \\frac{1+\\sqrt{6}}{7+2\\sqrt{6}} $$\n为了简化，我们将分母有理化：\n$$ k_c^2 = \\frac{1+\\sqrt{6}}{7+2\\sqrt{6}} \\cdot \\frac{7-2\\sqrt{6}}{7-2\\sqrt{6}} = \\frac{(1+\\sqrt{6})(7-2\\sqrt{6})}{7^2 - (2\\sqrt{6})^2} = \\frac{7 - 2\\sqrt{6} + 7\\sqrt{6} - 2(6)}{49 - 24} = \\frac{-5 + 5\\sqrt{6}}{25} = \\frac{5(\\sqrt{6}-1)}{25} $$\n$$ k_c^2 = \\frac{\\sqrt{6}-1}{5} $$\n所需的临界值为 $d_c = 7+2\\sqrt{6}$ 和 $k_c^2 = \\frac{\\sqrt{6}-1}{5}$。", "answer": "$$\\boxed{\\begin{pmatrix} 7+2\\sqrt{6} & \\frac{\\sqrt{6}-1}{5} \\end{pmatrix}}$$", "id": "2661473"}, {"introduction": "并非所有反应扩散系统都能产生图灵斑图。本实践将探讨一个关键的特例：具有守恒定律（如质量守恒）的系统。你将分析与此守恒律相关的零特征值在扩散作用下的行为，并揭示为何此类系统内在地抑制了扩散驱动的不稳定性。[@problem_id:2661454]", "problem": "考虑一个双物种反应扩散系统，该系统源于一个质量守恒的可逆相互转换网络。其中物种 $A$ 和 $B$ 通过 $A \\rightleftharpoons B$ 相互转换，正向速率常数为 $k_{1} \\gt 0$，逆向速率常数为 $k_{2} \\gt 0$。设 $a(t,x)$ 和 $b(t,x)$ 表示在一维无通量边界域中物种 $A$ 和 $B$ 的浓度。扩散是物种特异性的，扩散系数分别为 $D_{A} \\gt 0$ 和 $D_{B} \\gt 0$。其控制偏微分方程 (PDE) 为\n$$\n\\frac{\\partial a}{\\partial t} \\;=\\; -k_{1}\\,a \\;+\\; k_{2}\\,b \\;+\\; D_{A}\\,\\frac{\\partial^{2} a}{\\partial x^{2}}, \n\\qquad\n\\frac{\\partial b}{\\partial t} \\;=\\; k_{1}\\,a \\;-\\; k_{2}\\,b \\;+\\; D_{B}\\,\\frac{\\partial^{2} b}{\\partial x^{2}}.\n$$\n总质量 $m = \\int (a+b)\\,dx$ 在反应中是守恒的，因此空间均匀的反应子系统存在一个由 $m$ 参数化的单参数稳态族。对于任意固定的 $m$，将均匀平衡表示为 $(a^{*}(m), b^{*}(m))$。\n\n从反应扩散系统线性稳定性分析的第一性原理出发，并且不使用任何现成的不稳定性判据，完成以下任务：\n- 围绕一个均匀平衡点将PDE线性化，并进行傅里叶模态分解，以获得小波数 $k \\ge 0$ 的色散关系。\n- 识别出由于质量守恒而在 $k=0$ 处反应雅可比矩阵的零特征值，并确定在包含扩散的情况下，当 $k \\gt 0$ 时此特征值如何分裂，保留至 $k$ 的主导阶。\n- 仅使用 $2\\times 2$ 线性化算子的代数性质，评估在质量守恒约束子空间内，对于任何 $k \\gt 0$ 是否可能发生扩散驱动（类图灵）不稳定性。\n\n作为最终答案，请提供因扩散而从零分裂的增长率的主导阶项（关于 $k$）的闭式解析表达式，用 $k$、$k_{1}$、$k_{2}$、$D_{A}$ 和 $D_{B}$ 表示。将增长率以 $\\mathrm{s}^{-1}$ 为单位表示。无需数值，也无需四舍五入。", "solution": "该系统由以下关于浓度 $a(t,x)$ 和 $b(t,x)$ 的偏微分方程描述：\n$$\n\\frac{\\partial a}{\\partial t} = -k_{1}a + k_{2}b + D_{A}\\frac{\\partial^{2} a}{\\partial x^{2}}\n$$\n$$\n\\frac{\\partial b}{\\partial t} = k_{1}a - k_{2}b + D_{B}\\frac{\\partial^{2} b}{\\partial x^{2}}\n$$\n令状态向量为 $\\mathbf{c} = \\begin{pmatrix} a \\\\ b \\end{pmatrix}$。控制方程为 $\\frac{\\partial \\mathbf{c}}{\\partial t} = \\mathbf{f}(\\mathbf{c}) + \\mathbf{D} \\frac{\\partial^2 \\mathbf{c}}{\\partial x^2}$，其中反应动力学为 $\\mathbf{f}(\\mathbf{c}) = \\begin{pmatrix} -k_{1}a + k_{2}b \\\\ k_{1}a - k_{2}b \\end{pmatrix}$，扩散矩阵为 $\\mathbf{D} = \\begin{pmatrix} D_{A} & 0 \\\\ 0 & D_{B} \\end{pmatrix}$。\n\n首先，我们确定空间均匀稳态 $\\mathbf{c}^{*} = \\begin{pmatrix} a^{*} \\\\ b^{*} \\end{pmatrix}$。该状态必须满足 $\\mathbf{f}(\\mathbf{c}^{*}) = \\mathbf{0}$，这给出了条件 $-k_{1}a^{*} + k_{2}b^{*} = 0$，即 $k_{1}a^{*} = k_{2}b^{*}$。总浓度 $M = a^{*} + b^{*}$ 是一个自由参数，反映了质量守恒的性质。因此，存在一个单参数的均匀稳态族。\n\n接下来，我们在任意稳态 $\\mathbf{c}^{*}$ 周围对系统进行线性化。设 $\\mathbf{u}(t,x) = \\mathbf{c}(t,x) - \\mathbf{c}^{*}$ 为一个小微扰。线性化动力学由以下方程控制：\n$$\n\\frac{\\partial \\mathbf{u}}{\\partial t} = \\mathbf{J}\\mathbf{u} + \\mathbf{D} \\frac{\\partial^{2} \\mathbf{u}}{\\partial x^{2}}\n$$\n其中 $\\mathbf{J}$ 是在稳态下评估的反应动力学的雅可比矩阵：\n$$\n\\mathbf{J} = \\frac{\\partial \\mathbf{f}}{\\partial \\mathbf{c}}\\bigg|_{\\mathbf{c}=\\mathbf{c}^{*}} = \n\\begin{pmatrix} \n\\frac{\\partial}{\\partial a}(-k_{1}a + k_{2}b) & \\frac{\\partial}{\\partial b}(-k_{1}a + k_{2}b) \\\\\n\\frac{\\partial}{\\partial a}(k_{1}a - k_{2}b) & \\frac{\\partial}{\\partial b}(k_{1}a - k_{2}b)\n\\end{pmatrix}\n= \\begin{pmatrix} -k_{1} & k_{2} \\\\ k_{1} & -k_{2} \\end{pmatrix}\n$$\n注意，对于这个特定的线性反应网络，雅可比矩阵 $\\mathbf{J}$ 是常数，不依赖于具体的稳态 $(a^{*}, b^{*})$。\n\n为了分析对空间微扰的稳定性，我们进行傅里叶模态分解。我们寻求形式为 $\\mathbf{u}(t,x) = \\tilde{\\mathbf{u}} e^{\\lambda t + ikx}$ 的解，其中 $k$ 是空间模态的波数，$\\lambda$ 是其增长率。将此拟设代入线性化的PDE，对每个 $k$ 得到一个代数特征值问题：\n$$\n\\lambda \\tilde{\\mathbf{u}} = \\mathbf{J}\\tilde{\\mathbf{u}} + \\mathbf{D}(-k^{2})\\tilde{\\mathbf{u}} = (\\mathbf{J} - k^{2}\\mathbf{D})\\tilde{\\mathbf{u}}\n$$\n增长率 $\\lambda(k)$ 是矩阵 $\\mathbf{M}(k) = \\mathbf{J} - k^{2}\\mathbf{D}$ 的特征值。特征方程为 $\\det(\\mathbf{M}(k) - \\lambda\\mathbf{I}) = 0$。我们来计算 $\\mathbf{M}(k)$ 的迹和行列式：\n$$\n\\mathbf{M}(k) = \\begin{pmatrix} -k_{1} - k^{2}D_{A} & k_{2} \\\\ k_{1} & -k_{2} - k^{2}D_{B} \\end{pmatrix}\n$$\n$$\n\\mathrm{Tr}(\\mathbf{M}(k)) = (-k_{1} - k^{2}D_{A}) + (-k_{2} - k^{2}D_{B}) = -(k_{1}+k_{2}) - k^{2}(D_{A}+D_{B})\n$$\n$$\n\\det(\\mathbf{M}(k)) = (-k_{1} - k^{2}D_{A})(-k_{2} - k^{2}D_{B}) - k_{1}k_{2} = (k_{1}k_{2} + k^{2}k_{1}D_{B} + k^{2}k_{2}D_{A} + k^{4}D_{A}D_{B}) - k_{1}k_{2} = k^{2}(k_{1}D_{B} + k_{2}D_{A}) + k^{4}D_{A}D_{B}\n$$\n特征方程为 $\\lambda^{2} - \\mathrm{Tr}(\\mathbf{M}(k))\\lambda + \\det(\\mathbf{M}(k)) = 0$：\n$$\n\\lambda^{2} + \\left( (k_{1}+k_{2}) + k^{2}(D_{A}+D_{B}) \\right)\\lambda + \\left( k^{2}(k_{1}D_{B} + k_{2}D_{A}) + k^{4}D_{A}D_{B} \\right) = 0\n$$\n这是该系统的一般色散关系。\n\n对于均匀情况 ($k=0$)，方程简化为 $\\lambda^{2} + (k_{1}+k_{2})\\lambda = 0$，其根为 $\\lambda_{1}(0) = 0$ 和 $\\lambda_{2}(0) = -(k_{1}+k_{2})$。零特征值 $\\lambda_1(0)=0$ 的存在是质量守恒定律 $\\frac{\\partial}{\\partial t}(a+b) = (\\text{反应项}) + \\nabla \\cdot (D_A \\nabla a + D_B \\nabla b)$ 的直接结果。反应项之和为零，这意味着向量 $(1, 1)$ 是 $\\mathbf{J}$ 的一个左特征向量，其特征值为 $0$。由于另一个特征值是严格为负的 ($k_1, k_2 > 0$)，该稳态是稳定的。\n\n题目要求我们找到对于小的 $k > 0$，零特征值是如何分裂的。我们寻求当 $k \\to 0$ 时趋近于 $0$ 的特征多项式的根。设多项式为 $\\lambda^{2} + P(k^{2})\\lambda + Q(k^{2}) = 0$，其中 $P(k^{2}) = (k_{1}+k_{2}) + k^{2}(D_{A}+D_{B})$ 且 $Q(k^{2}) = k^{2}(k_{1}D_{B} + k_{2}D_{A}) + k^{4}D_{A}D_{B}$。根由 $\\lambda = \\frac{-P \\pm \\sqrt{P^{2}-4Q}}{2}$ 给出。\n对应于零特征值分裂的根是当 $k \\to 0$ 时消失的那个根。这是带有 `+` 号的根。\n对于小的 $k$，$Q(k^{2})$ 也很小。我们可以使用泰勒展开 $\\sqrt{1-x} \\approx 1 - x/2$。\n$$\n\\sqrt{P^{2}-4Q} = P\\sqrt{1 - \\frac{4Q}{P^{2}}} \\approx P\\left(1 - \\frac{2Q}{P^{2}}\\right) = P - \\frac{2Q}{P}\n$$\n将此代入特征值的解中，得到慢模 $\\lambda_{s}(k)$：\n$$\n\\lambda_{s}(k) \\approx \\frac{-P + (P - 2Q/P)}{2} = -\\frac{Q(k^{2})}{P(k^{2})}\n$$\n为了找到关于 $k$ 的主导阶项，我们对分子和分母针对小 $k^{2}$ 进行展开：\n$$\nQ(k^{2}) = (k_{1}D_{B} + k_{2}D_{A})k^{2} + \\mathcal{O}(k^{4})\n$$\n$$\nP(k^{2}) = (k_{1}+k_{2}) + \\mathcal{O}(k^{2})\n$$\n因此，慢模的近似值为：\n$$\n\\lambda_{s}(k) \\approx -\\frac{(k_{1}D_{B} + k_{2}D_{A})k^{2}}{k_{1}+k_{2}}\n$$\n这个表达式是增长率从零分裂的关于 $k$ 的主导阶项。这个增长率代表了总局部浓度 $a+b$ 中长波涨落的扩散弛豫。\n\n关于扩散驱动不稳定性的可能性：不稳定性要求对于某个 $k > 0$，有 $\\mathrm{Re}(\\lambda(k)) > 0$。\n特征多项式的系数为 $p_{1}(k) = \\mathrm{Tr}(\\mathbf{M}(k))$ 和 $p_0(k) = \\det(\\mathbf{M}(k))$。\n特征方程为 $\\lambda^2 - p_1(k) \\lambda + p_0(k) = 0$。\n对于所有 $k\\ge 0$ 和正参数 $k_{1}, k_{2}, D_{A}, D_{B}$：\n$$-p_{1}(k) = (k_{1}+k_{2}) + k^{2}(D_{A}+D_{B}) > 0$$\n$$p_{0}(k) = k^{2}(k_{1}D_{B} + k_{2}D_{A}) + k^{4}D_{A}D_{B} \\ge 0$$\n二次方程 $\\lambda^2 + c_1 \\lambda + c_0 = 0$ 的根，如果 $c_1 \\ge 0$ 且 $c_0 \\ge 0$，则其实部为非正。在我们的情况下，$c_1 = -p_1(k)$ 和 $c_0 = p_0(k)$。对于所有 $k \\ge 0$，这两个条件都满足。两个特征值的实部总是非正的。\n具体来说，如果根是实数 ($p_{1}^{2} - 4p_{0} \\ge 0$)，则根为 $\\frac{p_1 \\pm \\sqrt{p_1^2 - 4p_0}}{2}$。由于 $p_1 < 0$ 且 $\\sqrt{p_1^2 - 4p_0} \\le |p_1| = -p_1$，两个根都是非正的。如果根是复数 ($p_{1}^{2} - 4p_{0} < 0$)，它们的实部是 $p_1/2$，这是严格为负的。\n因此，没有任何模态可以有正的增长率。在这个系统中，扩散驱动的不稳定性是不可能发生的。这是预料之中的，因为该系统缺少必要的激活子-抑制子结构。\n\n所需的最终答案是分裂增长率的主导阶项。\n这就是 $\\lambda_{s}(k) \\approx -\\frac{k_{1}D_{B} + k_{2}D_{A}}{k_{1}+k_{2}} k^{2}$。该表达式本身就是主导阶项。", "answer": "$$\n\\boxed{-\\frac{k_{1} D_{B} + k_{2} D_{A}}{k_{1}+k_{2}} k^{2}}\n$$", "id": "2661454"}, {"introduction": "虽然解析方法能提供深刻的洞见，但它们通常难以应用于多物种系统。本练习将挑战你开发一种计算方法，以检验任何通用反应扩散系统中的图灵不稳定性。通过编写数值计算色散关系的算法，你将获得一个分析复杂网络的强大而通用的工具。[@problem_id:2661506]", "problem": "给定一个$n$物种化学反应网络的线性化反应扩散系统，其形式为空间均匀稳态，具有雅可比矩阵$J \\in \\mathbb{R}^{n \\times n}$和对角扩散矩阵$D = \\mathrm{diag}(d_1,\\dots,d_n)$，其中扩散系数$d_i \\in \\mathbb{R}_{>0}$为严格正值。对于每个空间傅里叶模式，其波数平方为$k^2 \\in \\mathbb{R}_{\\ge 0}$，扰动的线性化动力学根据矩阵$A(k^2) = J - k^2 D$演化。谱横坐标$\\alpha(k^2)$定义为矩阵$A(k^2)$特征值实部的最大值。\n\n您的任务是：\n- 设计并实现一个算法，在给定$J$和$D$的情况下，扫描一个指定的$k^2$值网格，并为每个网格点计算谱横坐标$\\alpha(k^2)$，然后返回该网格上的最大值$\\max_{k^2} \\alpha(k^2)$以及出现该最大值时的$k^2$。\n- 利用上述结果，判断$(J,D)$对是否表现出扩散驱动（图灵）不稳定性。其定义如下：均匀稳态在没有扩散时是线性稳定的（即$\\alpha(0) &lt; 0$），但存在某个$k^2 &gt; 0$使得$\\alpha(k^2) &gt; 0$。与零比较时，使用数值容差$\\varepsilon = 10^{-8}$以减轻浮点舍入误差。\n- 在代码的注释或文档中，根据反应扩散系统的线性稳定性分析基本原理，证明算法的正确性，并分析其关于物种数$n$和扫描网格点数$M$的计算复杂性。\n\n您可以假设以下基本原理：围绕均匀稳态对反应扩散系统进行线性化，会得到一个由$k^2$参数化的线性系统族，其增长率是$A(k^2) = J - k^2 D$的特征值。当均匀稳态在没有扩散的情况下是线性稳定的，但对于某个非零空间模式变得不稳定时，就会发生扩散驱动不稳定性。\n\n实现以下算法要求：\n- 在区间$[0,K_{\\max}]$上定义一个均匀网格$G = \\{k^2_m\\}_{m=0}^{M-1}$，间距为$\\Delta k^2$，其中$k^2_m = m \\,\\Delta k^2$，$K_{\\max} = (M-1)\\Delta k^2$。\n- 对于每个$k^2_m \\in G$，计算$A(k^2_m) = J - k^2_m D$，然后计算$A(k^2_m)$的所有特征值，并将这些特征值中的最大实部记录为$\\alpha(k^2_m)$。\n- 计算$\\alpha(0)$、网格上的最大谱横坐标$\\alpha_{\\max} = \\max_{m} \\alpha(k^2_m)$以及出现最大值时对应的$k^2$值$k^2_\\star$（如果出现平局，选择最小的$k^2_m$）。\n- 将图灵不稳定性指标确定为一个布尔值：\n  $$\\mathrm{is\\_turing} = \\big(\\alpha(0) &lt; -\\varepsilon\\big) \\wedge \\big(\\alpha_{\\max} &gt; \\varepsilon\\big).$$\n\n数值规格：\n- 使用容差$\\varepsilon = 10^{-8}$。\n- 使用均匀网格，其中$K_{\\max} = 10$且$\\Delta k^2 = 0.01$，即$M = 1001$。\n- 返回的浮点数输出四舍五入到$6$位小数。\n\n测试套件：\n对于每个测试用例，给定$(J,D)$，其中所有数值都是无量纲的。对所有用例使用共享的网格参数$K_{\\max} = 10$和$\\Delta k^2 = 0.01$。\n\n- 测试用例1（双物种，强差异扩散，预期出现扩散驱动不稳定性）：\n  $$J_1 = \\begin{bmatrix} 1 & 2 \\\\ -3 & -4 \\end{bmatrix}, \\quad D_1 = \\mathrm{diag}(0.1,\\,10).$$\n\n- 测试用例2（双物种，均等扩散，预期无扩散驱动不稳定性）：\n  $$J_2 = \\begin{bmatrix} 1 & 2 \\\\ -3 & -4 \\end{bmatrix}, \\quad D_2 = \\mathrm{diag}(1,\\,1).$$\n\n- 测试用例3（双物种，无扩散时不稳，根据定义不属于图灵不稳定性）：\n  $$J_3 = \\begin{bmatrix} 1 & 0 \\\\ 0 & -0.5 \\end{bmatrix}, \\quad D_3 = \\mathrm{diag}(0.1,\\,10).$$\n\n- 测试用例4（三物种，对角占优稳定雅可比矩阵，均等扩散，预期无扩散驱动不稳定性）：\n  $$J_4 = \\begin{bmatrix} -1 & 0.2 & 0 \\\\ 0.1 & -2 & 0.3 \\\\ 0 & 0.2 & -3 \\end{bmatrix}, \\quad D_4 = \\mathrm{diag}(1,\\,1,\\,1).$$\n\n输出规格：\n- 对每个测试用例，输出一个包含四项的列表：$[\\mathrm{is\\_turing},\\,\\alpha(0),\\,\\alpha_{\\max},\\,k^2_\\star]$，其中$\\mathrm{is\\_turing}$是一个布尔值，三个浮点数值四舍五入到$6$位小数。\n- 您的程序应生成单行输出，其中包含所有测试用例的结果，结果为一个逗号分隔的列表，并用方括号括起来，每个测试用例的结果本身也格式化为一个列表。例如：\n  $$[\\,[\\mathrm{True},-1.000000,0.123456,0.210000],\\,[\\mathrm{False},-0.500000,-0.100000,0.000000]\\,].$$\n\n您的代码必须是自包含的，不需要任何输入，并遵守上述指定的数值参数。此问题不涉及物理单位；所有量均为无量纲。算法的实现必须能够处理通用的$n$。", "solution": "该问题要求为一般的$n$物种反应扩散系统设计并实现一个数值算法，以测试扩散驱动（图灵）不稳定性。系统在均匀稳态附近的线性动力学由矩阵$A(k^2) = J - k^2 D$描述，其中$J \\in \\mathbb{R}^{n \\times n}$是反应的雅可比矩阵，$D = \\mathrm{diag}(d_1, \\dots, d_n)$是由正扩散系数$d_i > 0$构成的对角矩阵，$k^2 \\ge 0$是空间扰动的波数平方。\n\n对于给定的空间模式$k^2$，系统的线性稳定性由矩阵$A(k^2)$的谱横坐标决定，其定义为$\\alpha(k^2) = \\max_{j} \\{\\mathrm{Re}(\\lambda_j)\\}$，其中$\\{\\lambda_j\\}$是$A(k^2)$的特征值。正的谱横坐标$\\alpha(k^2) > 0$意味着波数为$k$的扰动将随时间指数增长，表示不稳定。负的谱横坐标$\\alpha(k^2) < 0$则意味着此类扰动会衰减，表示稳定。\n\n扩散驱动（或称图灵）不稳定性是一种特定现象，即一个对均匀扰动（在没有扩散时，即$k^2=0$）稳定的系统，在某个非零空间频率下由于扩散的存在而被驱动至不稳定。形式上，这对应于两个条件：\n1. 均匀稳态是稳定的：$\\alpha(0) < 0$。\n2. 存在某个波数范围，系统在该范围内是不稳定的：对于某个$k^2 > 0$，有$\\alpha(k^2) > 0$。\n\n用于验证给定$(J,D)$对是否满足这些条件的算法构造如下：\n\n首先，我们必须在一系列非负$k^2$值上研究函数$\\alpha(k^2)$的行为。由于对于一个通用的$n \\times n$矩阵，求其特征值的解析解是不可行的，并且解析地最大化$\\alpha(k^2)$也是难以处理的，因此我们采用数值方法。我们将关注的波数平方区间$[0, K_{\\max}]$离散化为一个均匀网格$G = \\{k^2_m\\}_{m=0}^{M-1}$，其指定间距为$\\Delta k^2$。在此问题中，给定的参数为$K_{\\max} = 10$和$\\Delta k^2 = 0.01$，从而得到$M=1001$个网格点。\n\n对于网格$G$中的每个点$k^2_m$，我们执行以下步骤：\n1. 为特定模式构建矩阵：$A(k^2_m) = J - k^2_m D$。\n2. 使用标准的数值线性代数程序计算$n \\times n$矩阵$A(k^2_m)$的全谱特征值。\n3. 通过找到计算出的特征值实部的最大值来计算该模式的谱横坐标：$\\alpha(k^2_m) = \\max_j \\{\\mathrm{Re}(\\lambda_j(A(k^2_m)))\\}$。\n\n遍历所有网格点后，我们得到一个代表在网格$G$上采样的函数$\\alpha(k^2)$的值数组。从这个数组中，我们提取必要的信息：\n- 在$k^2=0$处的谱横坐标，记为$\\alpha(0)$，是此数组的第一个元素。\n- 在扫描范围内的最大谱横坐标$\\alpha_{\\max} = \\max_{m} \\{\\alpha(k^2_m)\\}$，通过确定数组中的最大值来找到。\n- 对应的波数平方$k^2_\\star$是达到此最大值的网格点$k^2_m$。问题规定，如果出现平局，应选择最小的$k^2_m$。这可以通过查找数组中最大值的第一个索引的算法自然处理。\n\n最后，使用计算出的值和一个小的数值容差$\\varepsilon = 10^{-8}$来检查图灵不稳定性条件，以考虑浮点不精确性。布尔指标$\\mathrm{is\\_turing}$由以下逻辑谓词确定：\n$$ \\mathrm{is\\_turing} = (\\alpha(0) < -\\varepsilon) \\wedge (\\alpha_{\\max} > \\varepsilon) $$\n该表达式将图灵不稳定性的理论定义直接转化为一个可验证的数值测试。\n\n该算法的正确性依赖于线性稳定性理论的基本原理，以及一个假设，即所选网格足够精细，能够捕捉到连续函数$\\alpha(k^2)$的基本特征，包括其在区间$[0, K_{\\max}]$内的全局最大值。$K_{\\max}$的选择必须足够大，以包含相关的不稳定模式范围，这通常是与问题相关的。对于给定的测试用例，指定的网格是足够的。\n\n该算法的计算复杂性由其最密集的步骤决定，即主循环内的特征值计算。对于一个通用的$n \\times n$矩阵，标准特征值算法（如QR算法）的复杂性约为$O(n^3)$。由于此操作在波数网格上的每个点（共$M$个点）重复进行，该过程的总计算复杂性为$O(M \\cdot n^3)$。其余操作，如矩阵组装和查找结果数组的最大值，其复杂性较低，分别为$O(M \\cdot n)$和$O(M)$，不会改变整体的伸缩性。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main solver function that defines test cases, processes them,\n    and prints the results in the specified format.\n    \"\"\"\n    \n    # Numerical specifications\n    epsilon = 1e-8\n    k2_max = 10.0\n    delta_k2 = 0.01\n    \n    # Test cases defined as tuples of (Jacobian, Diffusion_matrix)\n    test_cases = [\n        # Test case 1 (two species, strongly differential diffusion)\n        (np.array([[1.0, 2.0], [-3.0, -4.0]]), \n         np.diag([0.1, 10.0])),\n        \n        # Test case 2 (two species, equal diffusion)\n        (np.array([[1.0, 2.0], [-3.0, -4.0]]),\n         np.diag([1.0, 1.0])),\n\n        # Test case 3 (two species, unstable without diffusion)\n        (np.array([[1.0, 0.0], [0.0, -0.5]]),\n         np.diag([0.1, 10.0])),\n\n        # Test case 4 (three species, diagonally dominant stable Jacobian)\n        (np.array([[-1.0, 0.2, 0.0], [0.1, -2.0, 0.3], [0.0, 0.2, -3.0]]),\n         np.diag([1.0, 1.0, 1.0]))\n    ]\n\n    # Generate the grid of k^2 values\n    num_points = int(k2_max / delta_k2) + 1\n    k2_grid = np.linspace(0, k2_max, num_points)\n\n    all_results = []\n    for J, D in test_cases:\n        result = process_case(J, D, k2_grid, epsilon)\n        all_results.append(result)\n\n    # Format the final output string according to the problem specification.\n    # Each sub-result is formatted as a string \"[bool,float,float,float]\"\n    # to avoid spaces introduced by Python's default list-to-string conversion.\n    result_strings = []\n    for res in all_results:\n        is_turing_str = str(res[0])\n        float_strs = [f\"{val:.6f}\" for val in res[1:]]\n        result_strings.append(f\"[{is_turing_str},{','.join(float_strs)}]\")\n    \n    # Join all sub-result strings and enclose in brackets.\n    final_output = f\"[{','.join(result_strings)}]\"\n    print(final_output)\n\ndef process_case(J, D, k2_grid, epsilon):\n    \"\"\"\n    Analyzes a single reaction-diffusion system (J, D) for Turing instability.\n\n    The algorithm's correctness derives from the direct application of linear stability\n    analysis for reaction-diffusion systems. By scanning a grid of wavenumbers (k),\n    it numerically approximates the dispersion relation alpha(k^2) and checks the\n    defining conditions for a Turing instability.\n\n    Complexity Analysis:\n    - n: number of species (size of matrix J)\n    - M: number of grid points in k2_grid\n    - The dominant operation is eigenvalue computation (O(n^3)) performed M times.\n    - Total complexity: O(M * n^3).\n\n    Args:\n        J (np.ndarray): The n x n Jacobian matrix.\n        D (np.ndarray): The n x n diagonal diffusion matrix.\n        k2_grid (np.ndarray): The grid of squared wavenumber values to scan.\n        epsilon (float): The numerical tolerance for comparisons with zero.\n\n    Returns:\n        list: A list containing [is_turing, alpha_0, alpha_max, k2_star].\n    \"\"\"\n    \n    alpha_values = []\n    for k2 in k2_grid:\n        # Construct the matrix A(k^2) = J - k^2 * D\n        A_k2 = J - k2 * D\n        \n        # Compute eigenvalues and find the spectral abscissa (max real part)\n        eigenvalues = np.linalg.eigvals(A_k2)\n        alpha_k2 = np.max(eigenvalues.real)\n        alpha_values.append(alpha_k2)\n\n    alpha_values = np.array(alpha_values)\n\n    # alpha(0) is the stability of the homogeneous steady state\n    alpha_0 = alpha_values[0]\n\n    # Find the maximum spectral abscissa over the grid and the corresponding k^2\n    # np.argmax() returns the index of the first occurrence of the maximum,\n    # which satisfies the tie-breaking rule (smallest k^2_m).\n    max_idx = np.argmax(alpha_values)\n    alpha_max = alpha_values[max_idx]\n    k2_star = k2_grid[max_idx]\n    \n    # Determine the Turing instability indicator based on the definition:\n    # Stable at k^2=0, but unstable for some k^2 > 0.\n    is_turing = (alpha_0 < -epsilon) and (alpha_max > epsilon)\n    \n    return [is_turing, alpha_0, alpha_max, k2_star]\n\n# Execute the solver\nsolve()\n\n```", "id": "2661506"}]}