{"hands_on_practices": [{"introduction": "我们学习吸附现象时，常从理想化的朗缪尔模型入手，但真实体系远为复杂。此练习将引导你超越理想模型，探索“随机顺序吸附”（Random Sequential Adsorption, RSA）这一更贴近现实的场景[@problem_id:2646769]。你将亲自计算一个双齿物种在表面上由于空间位阻而达到的最大覆盖度，即“阻塞极限”，并将其与忽略空间相关性的平均场理论预测进行比较，从而深刻理解吸附过程中空间约束的关键作用。", "problem": "一个双齿吸附质在吸附到一个晶体催化剂表面时会占据两个相邻的位点，该表面可以理想化为一个由相同位点组成的二维方格点阵。考虑不可逆吸附极限，即没有脱附和表面扩散：吸附尝试依次均匀随机地在相邻的位点对上进行，并且只有当所选位点对中的两个位点都为空时，尝试才能成功。这对应于随机顺序吸附（RSA）模型。设初始状态为空表面。\n\n令 $\\theta_{\\mathrm{site}}(t)$ 表示在时间 $t$ 时的位点覆盖度（即被占据的点阵位点比例），令 $\\theta_{\\mathrm{mol}}(t)$ 表示分子覆盖度（即每个位点上吸附的分子数），因此有 $\\theta_{\\mathrm{site}}(t) = 2\\,\\theta_{\\mathrm{mol}}(t)$。在一个忽略空间关联和局部性位点平衡之外的位阻效应的平均场处理中，分子覆盖度的理论饱和值将为 $\\theta_{\\mathrm{mol,MF}} = 1/2$。\n\n实际上，RSA会产生空间关联和位阻效应，这使得吸附在达到完全平铺之前，就在一个堵塞状态下停止。对于方格点阵上的二聚体（占据两位点的物种），堵塞时占据位点的分数是一个经过充分检验的数值常数，$\\theta_{\\mathrm{site},j} \\approx 0.9069$，该值是通过对大型方格点阵上的RSA进行高精度模拟确定的。\n\n从上述定义和RSA的动力学约束（即当不存在相邻的空位对时吸附停止）出发，计算堵塞时的最大分子覆盖度 $\\theta_{\\mathrm{mol},j}$，然后通过计算差额\n$$\n\\Delta \\equiv \\theta_{\\mathrm{mol,MF}} - \\theta_{\\mathrm{mol},j}\n$$\n来量化其与平均场预测值的偏差。\n将 $\\Delta$ 的值以纯数（无量纲）形式报告。将您的答案四舍五入到四位有效数字。", "solution": "所提出的问题是关于表面吸附动力学基础的一个有效练习，特别涉及随机顺序吸附（RSA）模型。该问题提法恰当，有科学依据，并包含了得到唯一解所需的所有信息。我们将着手进行分析。\n\n问题为在二维方格点阵上的双齿吸附质（我们称之为二聚体）定义了两种表面覆盖度的度量。第一种是位点覆盖度 $\\theta_{\\mathrm{site}}(t)$，定义为在时间 $t$ 时被吸附质占据的总点阵位点的比例。第二种是分子覆盖度 $\\theta_{\\mathrm{mol}}(t)$，定义为每个点阵位点上吸附的分子（二聚体）的数量。\n\n根据定义，每个二聚体分子恰好占据两个点阵位点。这导致位点覆盖度和分子覆盖度之间存在一个直接而严格的关系。每吸附一个分子，就有两个位点被占据。因此，被占据位点的总数总是吸附分子总数的两倍。当用点阵上的总位点数进行归一化时，这种关系对于分数覆盖度仍然成立：\n$$\n\\theta_{\\mathrm{site}}(t) = 2 \\cdot \\theta_{\\mathrm{mol}}(t)\n$$\n这个基本关系在所有时间 $t$ 都成立，从初始的空表面状态（$t=0$）到最终的堵塞状态（$t \\to \\infty$）。\n\n问题描述了最终（或饱和）覆盖度的两种情况。\n\n首先，介绍了一个简化的“平均场”模型。该模型忽略了空间关联和吸附的动力学约束，假设点阵可以被二聚体完全平铺。对于方格点阵，完全平铺对应于位点覆盖度 $\\theta_{\\mathrm{site}} = 1$。使用我们的基本关系，这将意味着分子覆盖度为 $\\theta_{\\mathrm{mol}} = 1/2$。问题陈述正确地将此值确定为分子饱和覆盖度的平均场预测值：\n$$\n\\theta_{\\mathrm{mol,MF}} = \\frac{1}{2} = 0.5\n$$\n\n其次，考虑了一个更现实的随机顺序吸附（RSA）模型。在此过程中，吸附尝试是在随机的相邻空位点对上进行的。随着表面被填充，找到这样的位点对变得越来越困难。该过程在“堵塞极限”处停止，此时不再有任何相邻的空位点对，即使可能存在孤立的单个空位点。这种现象被称为位阻效应，它阻止系统达到平均场情况下的完全平铺。堵塞极限的特征是位点覆盖度 $\\theta_{\\mathrm{site},j}$，该值严格小于1。问题为方格点阵上的二聚体提供了数值上已确定的值：\n$$\n\\theta_{\\mathrm{site},j} \\approx 0.9069\n$$\n该值表示在RSA动力学约束下，被占据位点的最大可能分数。\n\n我们的第一个任务是计算在此堵塞极限下的最大分子覆盖度，记为 $\\theta_{\\mathrm{mol},j}$。关系式 $\\theta_{\\mathrm{site}}(t) = 2 \\cdot \\theta_{\\mathrm{mol}}(t)$ 对这个系统普遍有效，因此也适用于堵塞极限。我们有：\n$$\n\\theta_{\\mathrm{site},j} = 2 \\cdot \\theta_{\\mathrm{mol},j}\n$$\n求解堵塞时的分子覆盖度，得到：\n$$\n\\theta_{\\mathrm{mol},j} = \\frac{\\theta_{\\mathrm{site},j}}{2}\n$$\n代入所提供的数值：\n$$\n\\theta_{\\mathrm{mol},j} \\approx \\frac{0.9069}{2} = 0.45345\n$$\n\n最后一个任务是量化这个现实的堵塞覆盖度与理想化的平均场预测值之间的偏差。这个偏差定义为差额 $\\Delta$：\n$$\n\\Delta \\equiv \\theta_{\\mathrm{mol,MF}} - \\theta_{\\mathrm{mol},j}\n$$\n我们已经确定了等式右边两项的值。将它们代入 $\\Delta$ 的定义中：\n$$\n\\Delta = \\frac{1}{2} - \\frac{\\theta_{\\mathrm{site},j}}{2}\n$$\n这可以改写为：\n$$\n\\Delta = \\frac{1 - \\theta_{\\mathrm{site},j}}{2}\n$$\n现在，我们使用给定的值 $\\theta_{\\mathrm{site},j} \\approx 0.9069$ 进行数值计算：\n$$\n\\Delta \\approx \\frac{1 - 0.9069}{2} = \\frac{0.0931}{2} = 0.04655\n$$\n问题要求结果报告为四位有效数字。我们计算出的值 $0.04655$ 已经有四位有效数字（首位的零不是有效数字）。因此，无需进一步四舍五入。这个差额 $\\Delta$ 代表了与假设的完美堆积相比，在随机顺序吸附过程中，由于其固有的动力学约束和空间无序性，以每个分子的基准来看，变得不可用的点阵分数。", "answer": "$$\\boxed{0.04655}$$", "id": "2646769"}, {"introduction": "在理解了吸附物如何占据表面之后，下一个关键问题是它们如何在表面上移动。表面扩散并非简单的无规行走，此练习将带你深入探索其背后的统计力学原理[@problem_id:2646798]。你将通过推导一个考虑了“记忆效应”的特定晶格上的示踪扩散系数 $D_{\\mathrm{tr}}$，来实践如何处理行走步骤之间的关联性，进而揭示微观跳跃动力学如何决定宏观输运性质。", "problem": "一个吸附原子在二维晶体表面上进行连续时间随机行走。吸附位点构成一个 Bravais 晶格，具有一组有限的最近邻键。设最近邻键矢量集为 $\\{\\mathbf{b}_j\\}_{j=1}^{z}$，对所有 $j$ 都有 $|\\mathbf{b}_j|=a$，其中 $a$ 是最近邻间距，$z$ 是配位数。跳跃是一个 Poisson 过程，每个被吸附物的总逸出率为 $\\nu$，因此两次跳跃之间的平均时间为 $1/\\nu$。每一步的跳跃方向选择由键取向集合上的一个 Markov 链控制。具体来说：\n- 在没有方向记忆但允许优先方向的情况下，选择方向 $j$ 的概率为 $p_j$，且满足 $\\sum_{j=1}^{z} p_j=1$（这些 $p_j$ 编码了晶格的各向异性）。\n- 在具有一步方向记忆的情况下，给定前一步是沿方向 $m$，选择方向 $j$ 的概率为 $\\Pi_{j|m}$，且对每个 $m$ 都满足 $\\sum_{j=1}^{z} \\Pi_{j|m}=1$。\n\n通过二维输运的 Einstein 关系式定义示踪扩散张量 $\\mathbf{D}$，\n$$\n\\mathbf{D}=\\lim_{t\\to\\infty}\\frac{\\langle \\Delta \\mathbf{r}(t)\\,\\Delta \\mathbf{r}(t)\\rangle}{2\\,t},\n$$\n其中 $\\Delta \\mathbf{r}(t)$ 是时间 $t$ 后的位移，$\\langle\\cdot\\rangle$ 表示对跳跃过程实现的系综平均。仅从这些定义以及等待时间与方向的统计独立性出发，完成以下任务：\n\n- 推导无关联（无记忆）扩散张量 $\\mathbf{D}_0$，用 $\\nu$、$\\{p_j\\}$ 和 $\\{\\mathbf{b}_j\\}$ 表示。\n- 当方向的稳态角分布是各向同性时，通过一个标量相关因子，展示方向关联如何修正 $\\mathbf{D}$。具体方法是，将 $\\mathbf{D}$ 用 $\\mathbf{D}_0$ 和方向自相关的无穷级数 $c_n=\\langle \\hat{\\mathbf{e}}_0\\cdot \\hat{\\mathbf{e}}_n\\rangle$ 表示，其中 $\\hat{\\mathbf{e}}_n$ 是第 $n$ 步方向的单位矢量。\n\n然后将你的结果应用于以下特定的表面扩散模型：\n\n- 晶格为二维三角晶格（配位数 $z=6$），其中 $|\\mathbf{b}_j|=a$，六个方向等距分布，夹角为 $\\pi/3$。\n- 等待时间统计保持为总率为 $\\nu$ 的 Poisson 过程。\n- 一步记忆是“回跳关联”：在给定前一步方向的条件下，下一步选择完全相反方向（转角为 $\\pi$）的概率为 $r$，选择其他五个方向之一的概率均为 $(1-r)/5$。\n- 不存在其他偏置来源，且六个方向上的稳态角分布是各向同性的。\n\n计算示踪扩散系数 $D_{\\mathrm{tr}}$（在此各向同性三角晶格情况下的标量扩散系数），并用 $a$、$\\nu$ 和 $r$ 表示为一个闭式表达式。将最终答案表示为符号表达式；不要代入数值。如果进行数值计算，扩散系数的单位应为平方米/秒。最终表达式中不要包含单位。", "solution": "该问题陈述是表面扩散统计力学中一个定义明确的练习。它在科学上是合理的、自洽的且客观的。所有给出的定义和条件在化学动力学和统计物理学领域都是标准的。该问题是有效的。\n\n我们将按要求分三部分进行推导。第一，无关联扩散张量 $\\mathbf{D}_0$。第二，关联张量 $\\mathbf{D}$ 与 $\\mathbf{D}_0$ 之间的一般关系。第三，将其应用于三角晶格上的特定扩散模型。\n\n时间 $t$ 后吸附原子的位移由单个跳跃矢量 $\\mathbf{s}_i$ 的总和给出，\n$$\n\\Delta\\mathbf{r}(t) = \\sum_{i=1}^{N(t)} \\mathbf{s}_i\n$$\n其中 $N(t)$ 是时间 $t$ 内的跳跃次数。跳跃是一个速率为 $\\nu$ 的 Poisson 过程，因此平均跳跃次数为 $\\langle N(t) \\rangle = \\nu t$。每个跳跃矢量 $\\mathbf{s}_i$ 是长度为 $a$ 的晶格键矢量 $\\{\\mathbf{b}_j\\}$ 之一。因此，我们可以写成 $\\mathbf{s}_i = a \\hat{\\mathbf{e}}_i$，其中 $\\hat{\\mathbf{e}}_i$ 是第 $i$ 次跳跃方向上的单位矢量。\n\n示踪扩散张量定义为\n$$\n\\mathbf{D} = \\lim_{t\\to\\infty} \\frac{\\langle \\Delta\\mathbf{r}(t) \\otimes \\Delta\\mathbf{r}(t) \\rangle}{2t}\n$$\n其中 $\\otimes$ 表示张量积。展开此式得到\n$$\n\\langle \\Delta\\mathbf{r}(t) \\otimes \\Delta\\mathbf{r}(t) \\rangle = \\left\\langle \\left( \\sum_{i=1}^{N(t)} \\mathbf{s}_i \\right) \\otimes \\left( \\sum_{k=1}^{N(t)} \\mathbf{s}_k \\right) \\right\\rangle = \\sum_{i,k} \\langle \\mathbf{s}_i \\otimes \\mathbf{s}_k \\rangle\n$$\n平均是对随机行走的所有实现进行的，包括步数和方向。\n\n**第一部分：无关联扩散张量 $\\mathbf{D}_0$**\n\n在无关联的情况下，每次跳跃的方向从分布 $\\{p_j\\}$ 中独立选择。我们假设没有净漂移，这意味着平均跳跃矢量为零：$\\langle \\mathbf{s} \\rangle = \\sum_{j=1}^{z} p_j \\mathbf{b}_j = \\mathbf{0}$。如果矢量集 $\\{\\mathbf{b}_j\\}$ 以及概率 $\\{p_j\\}$ 具有适当的对称性，此条件就成立，对于这里考虑的所有情况都是如此。对于独立的跳跃且 $\\langle \\mathbf{s} \\rangle = \\mathbf{0}$，不同跳跃矢量之间的关联为零：当 $i \\neq k$ 时，$\\langle \\mathbf{s}_i \\otimes \\mathbf{s}_k \\rangle = \\langle \\mathbf{s}_i \\rangle \\otimes \\langle \\mathbf{s}_k \\rangle = \\mathbf{0}$。关联项仅在 $i=k$ 时非零。\n$$\n\\langle \\Delta\\mathbf{r}(t) \\otimes \\Delta\\mathbf{r}(t) \\rangle = \\sum_{i=1}^{\\langle N(t) \\rangle} \\langle \\mathbf{s}_i \\otimes \\mathbf{s}_i \\rangle = \\langle N(t) \\rangle \\langle \\mathbf{s} \\otimes \\mathbf{s} \\rangle\n$$\n在此我们已将对随机步数 $N(t)$ 的求和替换为平均值，这对于平稳过程是有效的。$\\langle \\mathbf{s} \\otimes \\mathbf{s} \\rangle$ 是平均单次跳跃张量：\n$$\n\\langle \\mathbf{s} \\otimes \\mathbf{s} \\rangle = \\sum_{j=1}^{z} p_j (\\mathbf{b}_j \\otimes \\mathbf{b}_j)\n$$\n将 $\\langle N(t) \\rangle = \\nu t$ 代入 $\\mathbf{D}$ 的表达式：\n$$\n\\mathbf{D}_0 = \\lim_{t\\to\\infty} \\frac{\\nu t \\sum_{j=1}^{z} p_j (\\mathbf{b}_j \\otimes \\mathbf{b}_j)}{2t} = \\frac{\\nu}{2} \\sum_{j=1}^{z} p_j (\\mathbf{b}_j \\otimes \\mathbf{b}_j)\n$$\n这就是无关联扩散张量的表达式。\n\n**第二部分：关联扩散**\n\n存在方向记忆时，跳跃矢量不再独立，因此当 $i \\neq k$ 时 $\\langle \\mathbf{s}_i \\otimes \\mathbf{s}_k \\rangle \\neq \\mathbf{0}$。均方位移张量的表达式变为：\n$$\n\\langle \\Delta\\mathbf{r}(t) \\otimes \\Delta\\mathbf{r}(t) \\rangle = \\langle N(t) \\rangle \\langle \\mathbf{s} \\otimes \\mathbf{s} \\rangle + \\sum_{i \\neq k} \\langle \\mathbf{s}_i \\otimes \\mathbf{s}_k \\rangle\n$$\n假设方向是一个平稳 Markov 过程，则关联 $\\langle \\mathbf{s}_i \\otimes \\mathbf{s}_k \\rangle$ 仅依赖于间隔 $|i-k|=n$。\n$$\n\\langle \\Delta\\mathbf{r}(t) \\otimes \\Delta\\mathbf{r}(t) \\rangle = \\nu t \\langle \\mathbf{s} \\otimes \\mathbf{s} \\rangle + 2 \\sum_{i=1}^{\\nu t - 1} \\sum_{n=1}^{\\nu t - i} \\langle \\mathbf{s}_i \\otimes \\mathbf{s}_{i+n} \\rangle\n$$\n对于大的 $t$，此式可近似为：\n$$\n\\langle \\Delta\\mathbf{r}(t) \\otimes \\Delta\\mathbf{r}(t) \\rangle \\approx \\nu t \\left( \\langle \\mathbf{s} \\otimes \\mathbf{s} \\rangle + 2 \\sum_{n=1}^{\\infty} \\langle \\mathbf{s}_0 \\otimes \\mathbf{s}_n \\rangle \\right)\n$$\n于是扩散张量为：\n$$\n\\mathbf{D} = \\frac{\\nu}{2} \\left( \\langle \\mathbf{s} \\otimes \\mathbf{s} \\rangle + 2 \\sum_{n=1}^{\\infty} \\langle \\mathbf{s}_0 \\otimes \\mathbf{s}_n \\rangle \\right)\n$$\n问题指明了各向同性的稳态角分布，因此 $p_j = 1/z$。无关联张量则为 $\\mathbf{D}_0 = \\frac{\\nu}{2z} \\sum_{j=1}^{z} \\mathbf{b}_j \\otimes \\mathbf{b}_j$。项 $\\langle \\mathbf{s} \\otimes \\mathbf{s} \\rangle$ 是在此稳态分布上求平均，因此 $\\langle \\mathbf{s} \\otimes \\mathbf{s} \\rangle = \\sum_{j=1}^{z} \\frac{1}{z} \\mathbf{b}_j \\otimes \\mathbf{b}_j = \\frac{2}{\\nu} \\mathbf{D}_0$。因此，$\\mathbf{D} = \\mathbf{D}_0 + \\nu \\sum_{n=1}^{\\infty} \\langle \\mathbf{s}_0 \\otimes \\mathbf{s}_n \\rangle$。\n\n对于具有足够对称性的系统（如三角晶格），稳态分布的各向同性保证了 $\\mathbf{D}_0$ 和 $\\mathbf{D}$ 都是各向同性张量，即它们与单位张量 $\\mathbf{I}$ 成正比。设 $\\mathbf{D}=D\\mathbf{I}$ 和 $\\mathbf{D}_0=D_0\\mathbf{I}$。我们可以通过对张量方程取迹来找到标量关系。对于二维系统，$\\mathrm{Tr}(\\mathbf{I})=2$。\n$$\n\\mathrm{Tr}(\\mathbf{D}) = 2D \\quad \\text{和} \\quad \\mathrm{Tr}(\\mathbf{D}_0) = 2D_0\n$$\n使用性质 $\\mathrm{Tr}(\\mathbf{u} \\otimes \\mathbf{v}) = \\mathbf{u} \\cdot \\mathbf{v}$：\n$$\n2D = 2D_0 + \\nu \\sum_{n=1}^{\\infty} \\langle \\mathbf{s}_0 \\cdot \\mathbf{s}_n \\rangle\n$$\n因为 $\\mathbf{s}_i = a\\hat{\\mathbf{e}}_i$，我们有 $\\langle \\mathbf{s}_0 \\cdot \\mathbf{s}_n \\rangle = a^2 \\langle \\hat{\\mathbf{e}}_0 \\cdot \\hat{\\mathbf{e}}_n \\rangle = a^2 c_n$。\n$$\nD = D_0 + \\frac{\\nu a^2}{2} \\sum_{n=1}^{\\infty} c_n\n$$\n对于一个各向同性系统，$D_0 = \\frac{1}{2}\\mathrm{Tr}(\\mathbf{D}_0) = \\frac{1}{2}\\mathrm{Tr}(\\frac{\\nu a^2}{2z} \\sum_j \\hat{\\mathbf{b}}_j \\otimes \\hat{\\mathbf{b}}_j) = \\frac{\\nu a^2}{4z} \\sum_j |\\hat{\\mathbf{b}}_j|^2 = \\frac{\\nu a^2}{4}$。将 $D_0$ 代入 $D$ 的表达式：\n$$\nD = D_0 + 2D_0 \\sum_{n=1}^{\\infty} c_n = D_0 \\left(1 + 2\\sum_{n=1}^{\\infty} c_n\\right)\n$$\n由于 $\\mathbf{D}$ 和 $\\mathbf{D}_0$ 都是 $\\mathbf{I}$ 的标量倍数，这个关系对张量也同样成立：\n$$\n\\mathbf{D} = \\left(1 + 2\\sum_{n=1}^{\\infty} c_n\\right) \\mathbf{D}_0\n$$\n\n**第三部分：应用于特定模型**\n\n晶格是三角晶格 ($z=6$)，从方向 $m$ 到方向 $j$ 的转移概率为 $\\Pi_{j|m} = r$ (如果 $\\mathbf{b}_j = -\\mathbf{b}_m$) 且 $\\Pi_{j|m} = (1-r)/5$ (其他情况)。我们必须计算相关项 $c_n = \\langle \\hat{\\mathbf{e}}_0 \\cdot \\hat{\\mathbf{e}}_n \\rangle$。我们可以为 $c_n$ 建立一个递推关系。\n$$\nc_n = \\langle \\hat{\\mathbf{e}}_0 \\cdot \\hat{\\mathbf{e}}_n \\rangle = \\mathrm{E}[\\hat{\\mathbf{e}}_0 \\cdot \\mathrm{E}[\\hat{\\mathbf{e}}_n | \\hat{\\mathbf{e}}_{n-1}]]\n$$\n给定第 $(n-1)$ 步矢量，第 $n$ 步矢量的条件期望为：\n$$\n\\mathrm{E}[\\hat{\\mathbf{e}}_n | \\hat{\\mathbf{e}}_{n-1}] = r(-\\hat{\\mathbf{e}}_{n-1}) + \\frac{1-r}{5} \\sum_{j: \\hat{\\mathbf{b}}_j \\neq -\\hat{\\mathbf{e}}_{n-1}} \\hat{\\mathbf{b}}_j\n$$\n对于三角晶格，六个键矢量的集合之和为零：$\\sum_{j=1}^6 \\mathbf{b}_j = \\mathbf{0}$。因此，对五个非反向方向的求和为 $\\sum_{j: \\hat{\\mathbf{b}}_j \\neq -\\hat{\\mathbf{e}}_{n-1}} \\hat{\\mathbf{b}}_j = (\\sum_{j=1}^6 \\hat{\\mathbf{b}}_j) - (-\\hat{\\mathbf{e}}_{n-1}) = \\mathbf{0} + \\hat{\\mathbf{e}}_{n-1} = \\hat{\\mathbf{e}}_{n-1}$。\n将此代入条件期望：\n$$\n\\mathrm{E}[\\hat{\\mathbf{e}}_n | \\hat{\\mathbf{e}}_{n-1}] = -r\\hat{\\mathbf{e}}_{n-1} + \\frac{1-r}{5}\\hat{\\mathbf{e}}_{n-1} = \\left(\\frac{1-6r}{5}\\right) \\hat{\\mathbf{e}}_{n-1}\n$$\n设 $\\lambda = (1-6r)/5$。则 $c_n = \\langle \\hat{\\mathbf{e}}_0 \\cdot (\\lambda \\hat{\\mathbf{e}}_{n-1}) \\rangle = \\lambda \\langle \\hat{\\mathbf{e}}_0 \\cdot \\hat{\\mathbf{e}}_{n-1} \\rangle = \\lambda c_{n-1}$。这意味着 $c_n = \\lambda^n c_0$。由于 $c_0 = \\langle \\hat{\\mathbf{e}}_0 \\cdot \\hat{\\mathbf{e}}_0 \\rangle = 1$，我们有 $c_n = \\lambda^n$ (对于 $n \\ge 0$)。\n\n相关因子需要求和 $\\sum_{n=1}^{\\infty} c_n = \\sum_{n=1}^{\\infty} \\lambda^n$。这是一个几何级数，当 $|\\lambda| < 1$ 时收敛。其和为 $\\frac{\\lambda}{1-\\lambda}$。$r$ 的取值范围是 $[0,1]$，这使得 $\\lambda \\in [-1, 1/5]$。该级数在 $r \\in [0, 1)$ 时收敛，并且闭式表达式在 $r=1$ 处是连续的。\n因此，示踪扩散系数 $D_{\\mathrm{tr}}$ 为：\n$$\nD_{\\mathrm{tr}} = D_0 \\left(1 + 2 \\frac{\\lambda}{1-\\lambda}\\right) = D_0 \\left(\\frac{1 - \\lambda + 2\\lambda}{1-\\lambda}\\right) = D_0 \\frac{1+\\lambda}{1-\\lambda}\n$$\n代入 $D_0 = \\nu a^2 / 4$ 和 $\\lambda = (1-6r)/5$ 的表达式：\n$$\nD_{\\mathrm{tr}} = \\frac{\\nu a^2}{4} \\frac{1 + \\frac{1-6r}{5}}{1 - \\frac{1-6r}{5}} = \\frac{\\nu a^2}{4} \\frac{\\frac{5 + 1 - 6r}{5}}{\\frac{5 - (1-6r)}{5}} = \\frac{\\nu a^2}{4} \\frac{6-6r}{4+6r}\n$$\n$$\nD_{\\mathrm{tr}} = \\frac{\\nu a^2}{4} \\frac{6(1-r)}{2(2+3r)} = \\frac{3\\nu a^2(1-r)}{4(2+3r)}\n$$\n这是示踪扩散系数的最终表达式。作为检验，如果行走是真正无关联的，所有跳跃概率都相等，为 $1/6$。这对应于 $r = 1/6$。在这种情况下，$\\lambda=0$ 且 $D_{\\mathrm{tr}} = D_0 = \\nu a^2 / 4$。我们的公式给出：$D_{\\mathrm{tr}} = \\frac{3\\nu a^2(1-1/6)}{4(2+3/6)} = \\frac{3\\nu a^2(5/6)}{4(5/2)} = \\frac{\\nu a^2 (5/2)}{20/2} = \\frac{\\nu a^2}{4}$，这是正确的。对于最大反关联，$r=1$，得到 $D_{\\mathrm{tr}}=0$，这在物理上也是正确的，因为粒子被困在两个位点之间。", "answer": "$$\n\\boxed{\\frac{3\\nu a^{2}(1-r)}{4(2+3r)}}\n$$", "id": "2646798"}, {"introduction": "掌握了吸附和扩散的基本物理图像后，如何将这些理论模型与实验数据联系起来，是催化研究中的核心挑战。本练习将让你扮演计算科学家的角色，通过构建贝叶斯推断框架，从带有噪声的动力学数据中提取关键的吸附速率常数 $k_{\\mathrm{ads}}$ 和脱附速率常数 $k_{\\mathrm{des}}$ [@problem_id:2646792]。这项计算实践让你亲身体验如何应用基本动力学模型和现代数据科学方法来量化解析表面过程。", "problem": "给定一个用于一维等温非均相催化表面的确定性微观动力学模型，该模型包含吸附、解吸和表面扩散过程。设分数表面覆盖率表示为 $\\theta(x,t)\\in[0,1]$，定义在区域 $x\\in[0,L]$ 上，并采用周期性或无通量边界条件。$\\theta$ 的控制平衡方程为\n$$\n\\frac{\\partial \\theta}{\\partial t} \\;=\\; k_{\\mathrm{ads}}\\,P\\,(1-\\theta)\\;-\\;k_{\\mathrm{des}}\\,\\theta \\;+\\; D_{\\mathrm{s}}\\,\\frac{\\partial^2 \\theta}{\\partial x^2},\n$$\n其中 $k_{\\mathrm{ads}}$ (单位: $\\mathrm{Pa^{-1}\\ s^{-1}}$) 是吸附速率系数，$k_{\\mathrm{des}}$ (单位: $\\mathrm{s^{-1}}$) 是解吸速率系数，$P$ (单位: $\\mathrm{Pa}$) 是气体压力，$D_{\\mathrm{s}}$ (单位: $\\mathrm{m^2\\ s^{-1}}$) 是表面扩散系数。初始覆盖率 $\\theta(x,0)$ 的取值范围在 $[0,1]$ 内。对于空间平均值 $\\bar{\\theta}(t)=\\frac{1}{L}\\int_0^L \\theta(x,t)\\,dx$，在周期性或无通量边界条件下，扩散过程不改变平均值，该平均值根据以下确定性方程演化：\n$$\n\\frac{d\\bar{\\theta}}{dt} \\;=\\; k_{\\mathrm{ads}}\\,P\\,(1-\\bar{\\theta}) \\;-\\; k_{\\mathrm{des}}\\,\\bar{\\theta}.\n$$\n您在离散时间点 $t_1,\\ldots,t_N$ 收集了空间平均值的含噪声测量值：\n$$\ny_i \\;=\\; \\bar{\\theta}(t_i) \\;+\\; \\varepsilon_i,\\quad \\varepsilon_i\\stackrel{\\mathrm{iid}}{\\sim}\\mathcal{N}(0,\\sigma^2),\n$$\n其中噪声标准差 $\\sigma$ (单位：无量纲，与 $\\bar{\\theta}$ 相同) 已知。待推断的未知数是 $k_{\\mathrm{ads}}$ 和 $k_{\\mathrm{des}}$。采用独立的对数正态先验，实现为对数的高斯先验：\n$$\n\\log k_{\\mathrm{ads}} \\sim \\mathcal{N}(\\mu_a,s_a^2),\\qquad \\log k_{\\mathrm{des}} \\sim \\mathcal{N}(\\mu_d,s_d^2),\n$$\n其中超参数 $\\mu_a$、$s_a$、$\\mu_d$、$s_d$ 已给定。假设初始空间平均值 $\\bar{\\theta}(0)=\\bar{\\theta}_0$ 已知。\n\n您的任务是实现一个贝叶斯推断程序，该程序针对每个指定的测试用例，从确定性模型生成合成的含噪数据，并通过最大化后验密度（等效于最小化负对数后验）来计算 $k_{\\mathrm{ads}}$ 和 $k_{\\mathrm{des}}$ 的最大后验 (MAP) 估计值。仅使用以下建模基础：(i) Langmuir 吸附和一级解吸的位点平衡；(ii) Fick 表面扩散定律；(iii) 高斯噪声模型；(iv) 贝叶斯定理。似然函数必须根据 $\\bar{\\theta}(t)$ 的确定性模型预测值和高斯噪声假设来构建。为所有合成数据生成过程使用固定的随机种子 $42$，以确保可复现性。\n\n单位与表达式要求：\n- 以 $\\mathrm{Pa^{-1}\\ s^{-1}}$ 为单位表示 $k_{\\mathrm{ads}}$，以 $\\mathrm{s^{-1}}$ 为单位表示 $k_{\\mathrm{des}}$。您的程序应将这些值输出为不带单位符号的普通十进制浮点数。\n- 时间单位必须是 $\\mathrm{s}$，压力单位是 $\\mathrm{Pa}$，覆盖率是无量纲的。\n\n测试套件规范。对于每个测试用例，按如下方式定义参数。在每个用例中，从 $0$ 到 $T_{\\mathrm{end}}$（含）以 $\\Delta t_{\\mathrm{obs}}$ 为增量生成一个等间距网格作为测量时间 $t_i$，并使用真实参数通过评估 $\\bar{\\theta}(t)$ 的确定性模型并添加标准差为 $\\sigma$ 的独立高斯噪声来生成数据。提供表面扩散系数 $D_{\\mathrm{s}}$ 是为了科学上的完整性，但在所述边界条件下它不影响 $\\bar{\\theta}(t)$。\n\n- 测试用例 A（理想情况）：\n  - 真实参数：$k_{\\mathrm{ads}}^{\\mathrm{true}}=2\\times 10^{-5}\\ \\mathrm{Pa^{-1}\\ s^{-1}}$，$k_{\\mathrm{des}}^{\\mathrm{true}}=1\\times 10^{-3}\\ \\mathrm{s^{-1}}$。\n  - 操作条件：$P=100\\ \\mathrm{Pa}$，$D_{\\mathrm{s}}=1\\times 10^{-15}\\ \\mathrm{m^2\\ s^{-1}}$。\n  - 初始平均值：$\\bar{\\theta}_0=0.05$。\n  - 观测噪声：$\\sigma=0.01$。\n  - 观测窗口：$T_{\\mathrm{end}}=2000\\ \\mathrm{s}$，$\\Delta t_{\\mathrm{obs}}=50\\ \\mathrm{s}$。\n\n- 测试用例 B（低压，较慢的吸附过程）：\n  - 真实参数：$k_{\\mathrm{ads}}^{\\mathrm{true}}=5\\times 10^{-5}\\ \\mathrm{Pa^{-1}\\ s^{-1}}$，$k_{\\mathrm{des}}^{\\mathrm{true}}=1\\times 10^{-3}\\ \\mathrm{s^{-1}}$。\n  - 操作条件：$P=10\\ \\mathrm{Pa}$，$D_{\\mathrm{s}}=1\\times 10^{-15}\\ \\mathrm{m^2\\ s^{-1}}$。\n  - 初始平均值：$\\bar{\\theta}_0=0.20$。\n  - 观测噪声：$\\sigma=0.01$。\n  - 观测窗口：$T_{\\mathrm{end}}=3000\\ \\mathrm{s}$，$\\Delta t_{\\mathrm{obs}}=60\\ \\mathrm{s}$。\n\n- 测试用例 C（解吸主导的动力学）：\n  - 真实参数：$k_{\\mathrm{ads}}^{\\mathrm{true}}=2\\times 10^{-5}\\ \\mathrm{Pa^{-1}\\ s^{-1}}$，$k_{\\mathrm{des}}^{\\mathrm{true}}=1\\times 10^{-2}\\ \\mathrm{s^{-1}}$。\n  - 操作条件：$P=100\\ \\mathrm{Pa}$，$D_{\\mathrm{s}}=1\\times 10^{-15}\\ \\mathrm{m^2\\ s^{-1}}$。\n  - 初始平均值：$\\bar{\\theta}_0=0.10$。\n  - 观测噪声：$\\sigma=0.01$。\n  - 观测窗口：$T_{\\mathrm{end}}=600\\ \\mathrm{s}$，$\\Delta t_{\\mathrm{obs}}=20\\ \\mathrm{s}$。\n\n- 测试用例 D（高噪声，先验正则化的）：\n  - 真实参数：$k_{\\mathrm{ads}}^{\\mathrm{true}}=2\\times 10^{-5}\\ \\mathrm{Pa^{-1}\\ s^{-1}}$，$k_{\\mathrm{des}}^{\\mathrm{true}}=1\\times 10^{-3}\\ \\mathrm{s^{-1}}$。\n  - 操作条件：$P=100\\ \\mathrm{Pa}$，$D_{\\mathrm{s}}=1\\times 10^{-15}\\ \\mathrm{m^2\\ s^{-1}}$。\n  - 初始平均值：$\\bar{\\theta}_0=0.05$。\n  - 观测噪声：$\\sigma=0.05$。\n  - 观测窗口：$T_{\\mathrm{end}}=2000\\ \\mathrm{s}$，$\\Delta t_{\\mathrm{obs}}=50\\ \\mathrm{s}$。\n\n先验超参数（所有测试用例均使用相同值）：\n- $\\mu_a=\\log(1\\times 10^{-5})$, $s_a=2.0$。\n- $\\mu_d=\\log(1\\times 10^{-3})$, $s_d=2.0$。\n\n数学和算法要求：\n- 推导并使用由平均方程和初始条件 $\\bar{\\theta}(0)=\\bar{\\theta}_0$ 得到的 $\\bar{\\theta}(t)$ 的确定性解。\n- 根据给定的 $(k_{\\mathrm{ads}},k_{\\mathrm{des}})$ 和观测模型，为 $\\{y_i\\}_{i=1}^N$ 构建高斯似然函数。\n- 与 $\\log k_{\\mathrm{ads}}$ 和 $\\log k_{\\mathrm{des}}$ 的独立高斯先验结合，得到除归一化常数外的后验密度。\n- 通过最小化关于 $(\\log k_{\\mathrm{ads}},\\log k_{\\mathrm{des}})$ 的负对数后验来计算 MAP 估计值。\n- 使用固定的种子 $42$ 以产生可复现的噪声。\n\n最终输出格式：\n- 您的程序应生成一行输出，其中包含一个由方括号括起来的逗号分隔列表形式的结果，其中每个元素本身是针对一个测试用例的双元素列表，顺序为 $\\big[k_{\\mathrm{ads}}^{\\mathrm{MAP}},k_{\\mathrm{des}}^{\\mathrm{MAP}}\\big]$。例如，打印的输出必须如下所示\n$[ [k_{\\mathrm{ads}}^{\\mathrm{MAP},A},k_{\\mathrm{des}}^{\\mathrm{MAP},A}], [k_{\\mathrm{ads}}^{\\mathrm{MAP},B},k_{\\mathrm{des}}^{\\mathrm{MAP},B}], [k_{\\mathrm{ads}}^{\\mathrm{MAP},C},k_{\\mathrm{des}}^{\\mathrm{MAP},C}], [k_{\\mathrm{ads}}^{\\mathrm{MAP},D},k_{\\mathrm{des}}^{\\mathrm{MAP},D}] ]$\n用数值代替符号，且不包含任何单位字符串。", "solution": "所提出的问题经过了严格验证，被认为是科学上合理、适定、客观和完整的。它构成了将贝叶斯参数估计应用于化学动力学中经典模型的标准练习。因此，有必要提供一个解法。\n\n任务是从空间平均表面覆盖率 $\\bar{\\theta}(t)$ 的含噪声测量值中推断吸附和解吸速率系数 $k_{\\mathrm{ads}}$ 和 $k_{\\mathrm{des}}$。这需要一个涉及解析建模、统计公式化和数值优化的多步骤过程。\n\n首先，我们必须为可观测量 $\\bar{\\theta}(t)$ 建立确定性模型。问题陈述指出，对于周期性或无通量边界条件，表面覆盖率 $\\theta(x,t)$ 的偏微分方程可以进行空间平均，从而得到关于 $\\bar{\\theta}(t)$ 的常微分方程 (ODE)：\n$$\n\\frac{d\\bar{\\theta}}{dt} = k_{\\mathrm{ads}}P(1-\\bar{\\theta}) - k_{\\mathrm{des}}\\bar{\\theta}\n$$\n这是一个一阶线性常微分方程。它可以重新排列为：\n$$\n\\frac{d\\bar{\\theta}}{dt} + (k_{\\mathrm{ads}}P + k_{\\mathrm{des}})\\bar{\\theta} = k_{\\mathrm{ads}}P\n$$\n此方程在已知初始条件 $\\bar{\\theta}(0) = \\bar{\\theta}_0$ 下求解。其解析解是向一个稳态值的指数弛豫过程：\n$$\n\\bar{\\theta}(t; k_{\\mathrm{ads}}, k_{\\mathrm{des}}) = \\bar{\\theta}_{\\mathrm{ss}} + (\\bar{\\theta}_0 - \\bar{\\theta}_{\\mathrm{ss}}) e^{-t/\\tau}\n$$\n其中稳态覆盖率 $\\bar{\\theta}_{\\mathrm{ss}}$ 是 Langmuir 等温线：\n$$\n\\bar{\\theta}_{\\mathrm{ss}} = \\frac{k_{\\mathrm{ads}}P}{k_{\\mathrm{ads}}P + k_{\\mathrm{des}}}\n$$\n而特征弛豫时间常数 $\\tau$ 由下式给出：\n$$\n\\tau = \\frac{1}{k_{\\mathrm{ads}}P + k_{\\mathrm{des}}}\n$$\n$\\bar{\\theta}(t)$ 的这个解析表达式构成了我们统计分析中使用的预测模型。\n\n接下来，我们构建贝叶斯推断框架。目标是找到参数 $\\boldsymbol{\\phi} = (k_{\\mathrm{ads}}, k_{\\mathrm{des}})$ 的最大后验 (MAP) 估计。根据贝叶斯定理，给定数据 $\\boldsymbol{y} = \\{y_1, \\dots, y_N\\}$ 时参数的后验概率密度为：\n$$\np(\\boldsymbol{\\phi} | \\boldsymbol{y}) \\propto p(\\boldsymbol{y} | \\boldsymbol{\\phi}) \\, p(\\boldsymbol{\\phi})\n$$\n其中 $p(\\boldsymbol{y} | \\boldsymbol{\\phi})$ 是似然函数，$p(\\boldsymbol{\\phi})$ 是先验。\n\n似然函数源自测量模型 $y_i = \\bar{\\theta}(t_i; \\boldsymbol{\\phi}) + \\varepsilon_i$，其中误差 $\\varepsilon_i$ 是从正态分布 $\\mathcal{N}(0, \\sigma^2)$ 中抽取的独立同分布样本。整个数据集的似然函数是每次测量的概率之积：\n$$\np(\\boldsymbol{y} | \\boldsymbol{\\phi}) = \\prod_{i=1}^{N} \\frac{1}{\\sqrt{2\\pi\\sigma^2}} \\exp\\left( -\\frac{(y_i - \\bar{\\theta}(t_i; \\boldsymbol{\\phi}))^2}{2\\sigma^2} \\right)\n$$\n参数的先验分布被指定为独立的对数正态分布。这等效于参数的对数服从高斯先验：\n$$\n\\log k_{\\mathrm{ads}} \\sim \\mathcal{N}(\\mu_a, s_a^2)\n\\quad \\text{and} \\quad\n\\log k_{\\mathrm{des}} \\sim \\mathcal{N}(\\mu_d, s_d^2)\n$$\n因此，联合先验为：\n$$\np(\\boldsymbol{\\phi}) \\propto \\exp\\left( -\\frac{(\\log k_{\\mathrm{ads}} - \\mu_a)^2}{2s_a^2} -\\frac{(\\log k_{\\mathrm{des}} - \\mu_d)^2}{2s_d^2} \\right)\n$$\n最大化后验概率 $p(\\boldsymbol{\\phi} | \\boldsymbol{y})$ 等效于最小化其负对数。我们将目标函数 $\\mathcal{L}(\\boldsymbol{\\phi})$ 定义为负对数后验，省略了相对于 $\\boldsymbol{\\phi}$ 而言是常数的项：\n$$\n\\mathcal{L}(\\boldsymbol{\\phi}) = -\\log p(\\boldsymbol{y} | \\boldsymbol{\\phi}) - \\log p(\\boldsymbol{\\phi}) = \\frac{1}{2\\sigma^2}\\sum_{i=1}^{N} (y_i - \\bar{\\theta}(t_i; \\boldsymbol{\\phi}))^2 + \\frac{(\\log k_{\\mathrm{ads}} - \\mu_a)^2}{2s_a^2} + \\frac{(\\log k_{\\mathrm{des}} - \\mu_d)^2}{2s_d^2}\n$$\n为了数值稳定性和强制执行速率系数必须为正的物理约束，优化是针对参数的对数进行的。设 $\\alpha = \\log k_{\\mathrm{ads}}$ 和 $\\delta = \\log k_{\\mathrm{des}}$。目标函数变为：\n$$\n\\mathcal{L}(\\alpha, \\delta) = \\frac{1}{2\\sigma^2}\\sum_{i=1}^{N} (y_i - \\bar{\\theta}(t_i; e^\\alpha, e^\\delta))^2 + \\frac{(\\alpha - \\mu_a)^2}{2s_a^2} + \\frac{(\\delta - \\mu_d)^2}{2s_d^2}\n$$\n通过找到最小化 $\\mathcal{L}(\\alpha, \\delta)$ 的值 $(\\hat{\\alpha}, \\hat{\\delta})$，然后通过 $\\hat{k}_{\\mathrm{ads}} = e^{\\hat{\\alpha}}$ 和 $\\hat{k}_{\\mathrm{des}} = e^{\\hat{\\delta}}$ 将它们转换回来，即可获得 MAP 估计值 $(\\hat{k}_{\\mathrm{ads}}, \\hat{k}_{\\mathrm{des}})$。\n\n计算流程如下：\n1.  对每个测试用例，在指定区间内生成观测时间 $t_i$。\n2.  使用提供的真实参数计算精确的平均覆盖率 $\\bar{\\theta}(t_i)$。\n3.  通过向 $\\bar{\\theta}(t_i)$ 添加标准差为 $\\sigma$ 的高斯噪声来生成合成数据 $y_i$，使用固定的随机种子 $42$ 以保证可复现性。\n4.  定义一个函数，对于给定的对数参数对 $(\\alpha, \\delta)$ 和合成数据，计算负对数后验 $\\mathcal{L}(\\alpha, \\delta)$。\n5.  使用数值优化算法，特别是 `scipy.optimize.minimize` 中实现的 Nelder-Mead 单纯形法，找到最小化目标函数的值 $(\\hat{\\alpha}, \\hat{\\delta})$。优化的初始猜测值设为先验分布的均值 $(\\mu_a, \\mu_d)$。\n6.  将得到的最优对数参数取指数，以获得 MAP 估计值 $(\\hat{k}_{\\mathrm{ads}}, \\hat{k}_{\\mathrm{des}})$。\n7.  收集所有测试用例的结果，并将其格式化为指定的输出结构。\n这构成了解决该问题的完整而严谨的方法。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import minimize\n\ndef solve():\n    \"\"\"\n    Main solver function that generates synthetic data and computes MAP estimates\n    for kinetic parameters for a series of test cases.\n    \"\"\"\n    \n    # Test suite specification\n    test_cases = [\n        {\n            \"name\": \"A\",\n            \"k_true\": [2.0e-5, 1.0e-3],\n            \"P\": 100.0,\n            \"theta0\": 0.05,\n            \"sigma\": 0.01,\n            \"T_end\": 2000.0,\n            \"dt_obs\": 50.0\n        },\n        {\n            \"name\": \"B\",\n            \"k_true\": [5.0e-5, 1.0e-3],\n            \"P\": 10.0,\n            \"theta0\": 0.20,\n            \"sigma\": 0.01,\n            \"T_end\": 3000.0,\n            \"dt_obs\": 60.0\n        },\n        {\n            \"name\": \"C\",\n            \"k_true\": [2.0e-5, 1.0e-2],\n            \"P\": 100.0,\n            \"theta0\": 0.10,\n            \"sigma\": 0.01,\n            \"T_end\": 600.0,\n            \"dt_obs\": 20.0\n        },\n        {\n            \"name\": \"D\",\n            \"k_true\": [2.0e-5, 1.0e-3],\n            \"P\": 100.0,\n            \"theta0\": 0.05,\n            \"sigma\": 0.05,\n            \"T_end\": 2000.0,\n            \"dt_obs\": 50.0\n        }\n    ]\n\n    # Prior hyperparameter definitions\n    mu_a = np.log(1.0e-5)\n    s_a = 2.0\n    mu_d = np.log(1.0e-3)\n    s_d = 2.0\n\n    # Fixed random seed for reproducible noise generation\n    rng = np.random.default_rng(42)\n    \n    all_results = []\n\n    for case in test_cases:\n        # Step 1: Generate synthetic data\n        k_ads_true, k_des_true = case[\"k_true\"]\n        P = case[\"P\"]\n        theta0 = case[\"theta0\"]\n        sigma = case[\"sigma\"]\n        t_obs = np.arange(0, case[\"T_end\"] + case[\"dt_obs\"] / 2.0, case[\"dt_obs\"])\n\n        # Analytical model for mean coverage\n        def theta_model_func(t, k_ads, k_des, P_val, theta0_val):\n            term1 = k_ads * P_val\n            denominator = term1 + k_des\n            if denominator <= 0:  # Avoid division by zero/negative\n                # This should not be reachable with positive k values\n                return np.full_like(t, np.inf)\n            \n            theta_ss = term1 / denominator\n            tau_inv = denominator\n            \n            return theta_ss + (theta0_val - theta_ss) * np.exp(-t * tau_inv)\n\n        # Generate true coverage values and add noise\n        theta_bar_true = theta_model_func(t_obs, k_ads_true, k_des_true, P, theta0)\n        noise = rng.normal(0, sigma, size=len(t_obs))\n        y_obs = theta_bar_true + noise\n\n        # Step 2: Define the negative log-posterior objective function\n        def neg_log_posterior(log_params):\n            log_k_ads, log_k_des = log_params\n            k_ads = np.exp(log_k_ads)\n            k_des = np.exp(log_k_des)\n            \n            # Model prediction for current parameters\n            theta_predicted = theta_model_func(t_obs, k_ads, k_des, P, theta0)\n\n            # Term 1: Negative log-likelihood\n            # Sum of squared errors\n            sse = np.sum((y_obs - theta_predicted)**2)\n            neg_log_lik = sse / (2.0 * sigma**2)\n\n            # Term 2: Negative log-prior for k_ads\n            neg_log_prior_a = (log_k_ads - mu_a)**2 / (2.0 * s_a**2)\n            \n            # Term 3: Negative log-prior for k_des\n            neg_log_prior_d = (log_k_des - mu_d)**2 / (2.0 * s_d**2)\n            \n            return neg_log_lik + neg_log_prior_a + neg_log_prior_d\n\n        # Step 3: Minimize the objective function to find MAP estimates\n        # Initial guess is the mean of the prior distribution\n        initial_guess = [mu_a, mu_d]\n        \n        # Use a robust optimization method like Nelder-Mead\n        result = minimize(neg_log_posterior, initial_guess, method='Nelder-Mead')\n        \n        log_k_ads_map, log_k_des_map = result.x\n        \n        # Convert log parameters back to original scale\n        k_ads_map = np.exp(log_k_ads_map)\n        k_des_map = np.exp(log_k_des_map)\n\n        all_results.append([k_ads_map, k_des_map])\n\n    # Final print statement in the exact required format.\n    print(str(all_results).replace(\" \", \"\"))\n\nsolve()\n```", "id": "2646792"}]}