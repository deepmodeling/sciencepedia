{"hands_on_practices": [{"introduction": "RRK 理论是单分子反应统计理论的基石。该理论假设反应速率取决于在分子的所有振动模式中，能量随机分布后，反应坐标上偶然集中足够能量以越过能垒的概率。本练习将引导你从第一性原理出发，推导出经典的 RRK 速率常数表达式 [@problem_id:2671605]，这不仅能让你掌握其数学形式，还能深刻理解其背后的统计力学思想。", "problem": "一个非线性多原子分子有 $s$ 个独立的振动模式，这些模式可以通过分子内振动能量重分布 (IVR) 快速交换能量，因此在固定的总内能 $E$ 下，振动能量分量 $\\{e_1,\\dots,e_s\\}$ 会均匀地遍历微正则流形 $\\{e_i \\ge 0, \\sum_{i=1}^{s} e_i = E\\}$。在微正则单分子反应性的 Rice–Ramsperger–Kassel (RRK) 理论模型下，假设当一个指定的局域模式（反应坐标）携带的能量至少达到阈能 $E_0$ 时，反应就会发生，并且尝试越过此阈值的频率因子为 $\\nu$ (单位 $\\mathrm{s}^{-1}$)。仅使用这些假设，从第一性原理推导微正则 RRK 速率常数 $k_{\\mathrm{RRK}}(E)$ 作为 $E$、$E_0$、$s$ 和 $\\nu$ 的函数的解析表达式。然后，在 $s = 6$ 和 $\\nu = 1.00 \\times 10^{13}\\ \\mathrm{s}^{-1}$ 的条件下，计算当 $E = 2E_0$ 时该表达式的值。将 $k_{\\mathrm{RRK}}(2E_0)$ 的最终数值结果四舍五入到四位有效数字，并以 $\\mathrm{s}^{-1}$ 为单位表示。最后，用一两句话解释，在此模型中，当能量比 $E/E_0$ 固定时，$k_{\\mathrm{RRK}}(E)$ 随 $s$ 的变化趋势。（此解释部分无需数值输出）。", "solution": "所述问题具有科学依据、提法明确且客观。它是一个从第一性原理推导经典 Rice–Ramsperger–Kassel (RRK) 速率常数的标准练习。所有必要信息均已提供，且前提与该模型的基本假设一致。因此，该问题是有效的，我们着手进行解答。\n\n微正则速率常数 $k_{\\mathrm{RRK}}(E)$ 定义为频率因子 $\\nu$ 与分子处于反应构型的概率 $P(E, E_0, s)$ 的乘积。反应构型是指某个特定的振动模式（反应坐标）中的能量大于或等于临界阈能 $E_0$ 的构型。\n$$k_{\\mathrm{RRK}}(E) = \\nu P(E, E_0, s)$$\n问题假设存在快速的分子内振动能量重分布 (IVR)，这意味着在总能量为 $E$ 时，所有微观态都是等概率的。因此，概率 $P(E, E_0, s)$ 是对应于反应态的相空间体积与总可及相空间体积之比。\n\n我们将这 $s$ 个振动模式视为经典振子。核心任务是计算在总能量为 $\\sum_{i=1}^{s} e_i = E$ 的条件下，某个特定振子（比如振子1）的能量 $e_1 \\ge E_0$ 的统计概率。\n\n振子1的能量处于无穷小区间 $[e_1, e_1 + de_1]$ 内的概率，正比于剩余能量 $E - e_1$ 在其余 $s-1$ 个振子中分配的方式数。这由 $s-1$ 个振子在能量为 $E - e_1$ 时的态密度给出，我们记为 $\\rho_{s-1}(E - e_1)$。对于一个由 $k$ 个经典振子组成的系统，其在能量为 $\\mathcal{E}$ 时的态密度正比于 $\\mathcal{E}^{k-1}$。因此，$\\rho_{s-1}(E - e_1) \\propto (E - e_1)^{s-2}$。\n\n总状态数 $N_{\\text{total}}$ 正比于该密度对第一个振子的所有可能能量（从 $e_1=0$ 到 $e_1=E$）的积分。\n$$N_{\\text{total}} \\propto \\int_{0}^{E} \\rho_{s-1}(E - e_1) de_1 = \\int_{0}^{E} C (E - e_1)^{s-2} de_1$$\n其中 $C$ 是一个比例常数。该积分计算结果为：\n$$\\int_{0}^{E} C (E - e_1)^{s-2} de_1 = C \\left[ -\\frac{(E-e_1)^{s-1}}{s-1} \\right]_{0}^{E} = C \\frac{E^{s-1}}{s-1}$$\n因此，$N_{\\text{total}} \\propto E^{s-1}$。\n\n反应态数 $N_{\\text{reactive}}$ 对应于 $e_1 \\ge E_0$ 的构型。这可以通过对相同的态密度在区间 $e_1 \\in [E_0, E]$ 上积分得到。\n$$N_{\\text{reactive}} \\propto \\int_{E_0}^{E} \\rho_{s-1}(E - e_1) de_1 = \\int_{E_0}^{E} C (E - e_1)^{s-2} de_1$$\n该积分计算结果为：\n$$\\int_{E_0}^{E} C (E - e_1)^{s-2} de_1 = C \\left[ -\\frac{(E-e_1)^{s-1}}{s-1} \\right]_{E_0}^{E} = C \\frac{(E-E_0)^{s-1}}{s-1}$$\n因此，$N_{\\text{reactive}} \\propto (E-E_0)^{s-1}$。这在 $E \\ge E_0$ 时成立；如果 $E < E_0$，反应态数为 0。\n\n反应概率是 $N_{\\text{reactive}} / N_{\\text{total}}$ 的比值：\n$$P(E, E_0, s) = \\frac{(E-E_0)^{s-1}}{E^{s-1}} = \\left( \\frac{E-E_0}{E} \\right)^{s-1} = \\left( 1 - \\frac{E_0}{E} \\right)^{s-1}$$\n将此概率代入速率常数表达式，得到所求的解析公式：\n$$k_{\\mathrm{RRK}}(E) = \\nu \\left( 1 - \\frac{E_0}{E} \\right)^{s-1}$$\n这是解答的第一部分。\n\n接下来，我们用指定的参数计算该表达式的值：$s=6$，$E=2E_0$ 和 $\\nu = 1.00 \\times 10^{13}\\ \\mathrm{s}^{-1}$。\n代入这些值：\n$$k_{\\mathrm{RRK}}(2E_0) = (1.00 \\times 10^{13}) \\times \\left( 1 - \\frac{E_0}{2E_0} \\right)^{6-1}$$\n$$k_{\\mathrm{RRK}}(2E_0) = (1.00 \\times 10^{13}) \\times \\left( 1 - \\frac{1}{2} \\right)^{5}$$\n$$k_{\\mathrm{RRK}}(2E_0) = (1.00 \\times 10^{13}) \\times \\left( \\frac{1}{2} \\right)^{5}$$\n$$k_{\\mathrm{RRK}}(2E_0) = (1.00 \\times 10^{13}) \\times \\frac{1}{32}$$\n$$k_{\\mathrm{RRK}}(2E_0) = (1.00 \\times 10^{13}) \\times 0.03125$$\n$$k_{\\mathrm{RRK}}(2E_0) = 3.125 \\times 10^{11}\\ \\mathrm{s}^{-1}$$\n结果要求保留四位有效数字，而 $3.125 \\times 10^{11}$ 已满足该要求。\n\n最后，我们分析在固定的能量比 $E/E_0$ 下，$k_{\\mathrm{RRK}}(E)$ 随 $s$ 的变化趋势。令 $R = E/E_0$ 为一个常数，其中 $R > 1$。速率表达式变为 $k_{\\mathrm{RRK}}(E) = \\nu(1 - 1/R)^{s-1}$。由于 $R > 1$，幂的底数 $(1-1/R)$ 是一个严格小于 1 的正数。随着 $s$ 的增加，一个介于 0 和 1 之间的数被提升到更大的幂次 $s-1$ 时，其结果会变小。因此，在固定的能量比下，随着振动模式数 $s$ 的增加，速率常数 $k_{\\mathrm{RRK}}(E)$ 减小，这反映了能量在更多自由度中被统计稀释的效应。", "answer": "$$\\boxed{3.125 \\times 10^{11}}$$", "id": "2671605"}, {"introduction": "在 RRK 理论的基础上，RRKM 理论通过引入过渡态的概念和更精确的量子态计数，提供了对单分子反应速率更精确的描述。这个练习将通过一个简化的三模式体系，直接比较 RRK 和 RRKM 理论的预测 [@problem_id:2671548]。通过推导，你将发现 RRKM 理论如何为 RRK 理论中唯象的“尝试频率” $\\nu$ 提供了微观的、源于第一性原理的解释，从而揭示了 RRKM 方法的强大之处和更深刻的物理内涵。", "problem": "考虑一个模型单分子体系，其具有 $s=3$ 个振动自由度：两个正交的谐振浴模，角频率分别为 $\\omega_{1}$ 和 $\\omega_{2}$，以及一个反应坐标。在反应物势阱中，该反应坐标是一个角频率为 $\\omega_{r}$ 的束缚谐振模，沿此坐标的能垒是抛物线形的，其高度 $E_{0}$ 从势阱底部算起。假设分子内振动能量重排（IVR）是完全且快速的，因此在固定总能量 $E$ 时，根据等概率先验假设，振动能量分配的微正则分布是均匀的。同时假设模式可分，且经典（半经典）态计数方法有效。\n\n仅使用微正则系综的第一性原理、可分谐振模的经典相空间态计数以及过渡态理论（TST）的微正则形式，完成以下任务：\n\n- 在 Rice–Ramsperger–Kassel (RRK) 图像中，将能量分配视为在 $s=3$ 个等效振子中进行，并认为当反应模式中的能量超过 $E_{0}$ 时反应发生。设反应模式的尝试频率为 $\\nu$（每单位时间）。推导当 $E \\ge E_{0}$ 时，RRK 微正则速率 $k_{\\mathrm{RRK}}(E)$ 的显式表达式。\n\n- 在 Rice–Ramsperger–Kassel–Marcus (RRKM) 图像中，将过渡态处理为仅包含两个浴模（其频率 $\\omega_{1}$ 和 $\\omega_{2}$ 与反应物中的相同），且没有束缚的反应模式。使用半经典态计数，推导当 $E \\ge E_{0}$ 时，RRKM 微正则速率 $k_{\\mathrm{RRKM}}(E)$ 的显式表达式。\n\n然后，通过构建比值 $R(E) \\equiv k_{\\mathrm{RRK}}(E)/k_{\\mathrm{RRKM}}(E)$，来比较两种速率在不同能量 $E$ 下的差异，并用 $\\nu$、$\\omega_{r}$ 和基本常数给出一个关于 $R(E)$ 的单一闭式解析表达式。必要时可使用亥维赛德阶跃函数 $\\Theta(E-E_{0})$。无需进行数值计算。将最终答案表示为单一的闭式表达式；带框的最终答案中不应包含单位。如果引入任何中间数值，仅在必要时进行四舍五入并保留 $4$ 位有效数字，但带框的最终答案应为精确的符号表达式。", "solution": "所提供的问题陈述经核验，确认其科学基础扎实、设定良好、客观且自洽。它提出了一个关于单分子反应速率理论中两个基本模型（RRK 和 RRKM）的标准（尽管是简化的）比较研究，该研究基于统计力学的第一性原理。所有必需的参数和理论框架均已提供。该问题是有效的，下面将推导其严谨解。\n\n目标是推导微正则速率常数 $k_{\\mathrm{RRK}}(E)$ 和 $k_{\\mathrm{RRKM}}(E)$，然后确定它们的比值 $R(E) = k_{\\mathrm{RRK}}(E)/k_{\\mathrm{RRKM}}(E)$。\n\n首先，我们推导 Rice–Ramsperger–Kassel (RRK) 速率常数 $k_{\\mathrm{RRK}}(E)$ 的表达式。RRK 模型在其经典表述中，考虑总能量 $E$ 在 $s$ 个等效谐振子中的统计分布。假设当某个特定振子（即反应模式）中的能量超过一个临界能量 $E_{0}$ 时，反应就会发生。反应速率则是尝试频率 $\\nu$ 与反应模式能量不低于 $E_{0}$ 的概率的乘积。\n\n对于一个总能量为 $E$ 的 $s$ 个经典谐振子体系，在某个特定振子中发现能量为 $\\epsilon$ 的概率密度函数，正比于其余 $s-1$ 个振子在能量为 $E-\\epsilon$ 时的态密度。对于经典振子，态密度正比于能量的（振子数减一）次幂。因此，概率密度 $P(\\epsilon)$ 由下式给出：\n$$P(\\epsilon) d\\epsilon \\propto (E-\\epsilon)^{s-2} d\\epsilon$$\n为了求出概率，我们将此分布在其整个范围（从 $\\epsilon=0$ 到 $\\epsilon=E$）上进行归一化：\n$$\\int_{0}^{E} C(E-\\epsilon)^{s-2} d\\epsilon = 1$$\n其中 $C$ 是归一化常数。该积分计算结果为 $C \\left[ -\\frac{(E-\\epsilon)^{s-1}}{s-1} \\right]_{0}^{E} = C \\frac{E^{s-1}}{s-1} = 1$，这给出 $C = \\frac{s-1}{E^{s-1}}$。\n反应概率 $P_{\\mathrm{rxn}}$ 是反应模式中的能量大于或等于 $E_{0}$ 的概率。这可以通过将归一化的概率密度从 $E_{0}$ 积分到 $E$ 得到：\n$$P_{\\mathrm{rxn}}(E) = \\int_{E_{0}}^{E} \\frac{s-1}{E^{s-1}} (E-\\epsilon)^{s-2} d\\epsilon$$\n$$P_{\\mathrm{rxn}}(E) = \\frac{s-1}{E^{s-1}} \\left[ -\\frac{(E-\\epsilon)^{s-1}}{s-1} \\right]_{E_{0}}^{E} = \\frac{s-1}{E^{s-1}} \\left( 0 - \\left( -\\frac{(E-E_{0})^{s-1}}{s-1} \\right) \\right) = \\left(\\frac{E-E_{0}}{E}\\right)^{s-1}$$\nRRK 速率常数是此概率与尝试频率 $\\nu$ 的乘积。给定 $s=3$ 个等效振子，表达式变为：\n$$k_{\\mathrm{RRK}}(E) = \\nu P_{\\mathrm{rxn}}(E) = \\nu \\left(1 - \\frac{E_{0}}{E}\\right)^{3-1} = \\nu \\left(1 - \\frac{E_{0}}{E}\\right)^{2}$$\n该速率仅在 $E \\ge E_{0}$ 时非零，这可以使用亥维赛德阶跃函数 $\\Theta(E-E_{0})$ 来形式化地表示。\n$$k_{\\mathrm{RRK}}(E) = \\nu \\left(1 - \\frac{E_{0}}{E}\\right)^{2} \\Theta(E-E_{0})$$\n\n接下来，我们推导 Rice–Ramsperger–Kassel–Marcus (RRKM) 速率常数 $k_{\\mathrm{RRKM}}(E)$ 的表达式。该理论基于过渡态理论（TST）的微正则表述，其中速率由通过过渡态分割面的通量与能量为 $E$ 的反应物态布居数之比给出。其表达式为：\n$$k_{\\mathrm{RRKM}}(E) = \\frac{N^{\\ddagger}(E-E_{0})}{h \\rho(E)}$$\n其中 $N^{\\ddagger}(E-E_{0})$ 是过渡态（TS）在可用能量最高为 $E-E_{0}$ 时的态总和，$\\rho(E)$ 是反应物分子在能量为 $E$ 时的态密度，而 $h$ 是 Planck 常数。\n\n我们将对一个包含 $n$ 个角频率为 $\\omega_{i}$ 的可分谐振子的体系，使用半经典（高能经典极限）公式计算态总和 $N(E)$ 和态密度 $\\rho(E)$：\n$$N(E) = \\frac{E^{n}}{n! \\prod_{i=1}^{n} \\hbar\\omega_{i}}$$\n$$\\rho(E) = \\frac{d N(E)}{dE} = \\frac{E^{n-1}}{(n-1)! \\prod_{i=1}^{n} \\hbar\\omega_{i}}$$\n其中 $\\hbar$ 是约化 Planck 常数。\n\n对于反应物，我们有 $s=3$ 个振动模式，角频率为 $\\omega_{1}$、$\\omega_{2}$ 和 $\\omega_{r}$。反应物的态密度是：\n$$\\rho(E) = \\frac{E^{3-1}}{(3-1)! (\\hbar\\omega_{1})(\\hbar\\omega_{2})(\\hbar\\omega_{r})} = \\frac{E^{2}}{2 \\hbar^{3} \\omega_{1} \\omega_{2} \\omega_{r}}$$\n\n对于过渡态，反应模式转变为越过能垒的平移运动。过渡态被定义为具有余下的 $s-1=2$ 个振动模式，频率为 $\\omega_{1}$ 和 $\\omega_{2}$。这些模式可用的能量是总能量 $E$ 减去能垒高度 $E_{0}$。过渡态的态总和是：\n$$N^{\\ddagger}(E-E_{0}) = \\frac{(E-E_{0})^{2}}{2! (\\hbar\\omega_{1})(\\hbar\\omega_{2})} = \\frac{(E-E_{0})^{2}}{2 \\hbar^{2} \\omega_{1} \\omega_{2}}$$\n\n现在，我们将这些表达式代入RRKM速率方程：\n$$k_{\\mathrm{RRKM}}(E) = \\frac{N^{\\ddagger}(E-E_{0})}{h \\rho(E)} = \\frac{1}{h} \\frac{\\frac{(E-E_{0})^{2}}{2 \\hbar^{2} \\omega_{1} \\omega_{2}}}{\\frac{E^{2}}{2 \\hbar^{3} \\omega_{1} \\omega_{2} \\omega_{r}}}$$\n通过消去公因子（$2$、$\\hbar^{2}$、$\\omega_{1}$、$\\omega_{2}$）来简化表达式：\n$$k_{\\mathrm{RRKM}}(E) = \\frac{1}{h} \\frac{(E-E_{0})^{2}}{E^{2}} \\frac{\\hbar^{3} \\omega_{1} \\omega_{2} \\omega_{r}}{\\hbar^{2} \\omega_{1} \\omega_{2}} = \\frac{\\hbar\\omega_{r}}{h} \\left(\\frac{E-E_{0}}{E}\\right)^{2}$$\n使用关系式 $\\hbar = h/(2\\pi)$，我们得到：\n$$k_{\\mathrm{RRKM}}(E) = \\frac{\\omega_{r}}{2\\pi} \\left(1 - \\frac{E_{0}}{E}\\right)^{2}$$\n此表达式也仅在 $E \\ge E_{0}$ 时有效，因此我们可以写成：\n$$k_{\\mathrm{RRKM}}(E) = \\frac{\\omega_{r}}{2\\pi} \\left(1 - \\frac{E_{0}}{E}\\right)^{2} \\Theta(E-E_{0})$$\n注意，$\\omega_r/(2\\pi)$ 是反应模式谐振子的频率 $\\nu_r$。因此，RRKM 理论为尝试频率提供了一个第一性原理的诠释。\n\n最后，我们求出比值 $R(E) = k_{\\mathrm{RRK}}(E)/k_{\\mathrm{RRKM}}(E)$。对于速率不为零的能量 $E > E_0$：\n$$R(E) = \\frac{k_{\\mathrm{RRK}}(E)}{k_{\\mathrm{RRKM}}(E)} = \\frac{\\nu \\left(1 - \\frac{E_{0}}{E}\\right)^{2}}{\\frac{\\omega_{r}}{2\\pi} \\left(1 - \\frac{E_{0}}{E}\\right)^{2}}$$\n含能量的项 $\\left(1 - E_{0}/E\\right)^{2}$ 被完全消去。\n$$R(E) = \\frac{\\nu}{\\frac{\\omega_{r}}{2\\pi}} = \\frac{2\\pi\\nu}{\\omega_{r}}$$\n比值 $R(E)$ 是一个常数，与总能量 $E$ 无关。在本问题的特定条件下，此结果量化了较简单的 RRK 模型中的唯象尝试频率 $\\nu$ 与更详细的 RRKM 模型中反应模式的微观频率 $\\omega_{r}$ 之间的关系。", "answer": "$$\n\\boxed{\\frac{2\\pi\\nu}{\\omega_r}}\n$$", "id": "2671548"}, {"introduction": "理想的统计理论假设分子内部振动能量重分布（IVR）是瞬时且完全的，但真实分子的行为可能更为复杂。当 IVR 过程受限或缓慢时，反应会偏离统计行为，并表现出非单指数的动力学特征。本计算练习旨在模拟这种非统计动力学 [@problem_id:2671485]，你将构建一个模型，其中能量在分子中的分配本身是一个随机过程，并探索这种能量流动的微观动力学如何直接影响宏观可测量的存活概率 $S(t)$。", "problem": "在一级衰变过程中，单指数形式的生存概率假设系综中的每个成员都具有相同的速率常数。在许多单分子反应场景中，测得的生存概率 $S(t)$ 会偏离单指数形式，这可以通过部分分子内振动能量重分配 (IVR) 引起的微正则衰变速率的非均一性来解释。在 Rice–Ramsperger–Kassel (RRK) 微正则图像中，固定总能量下的单分子衰变受制于一个要求，即临界能量 $E_0$ 必须局域在振动模式的反应子空间内；部分 IVR 将能量流限制在一个有效的子空间，而非全部模式集。\n\n从以下基本要素出发：\n- 对于具有不随时间变化的一级速率常数 $k$ 的子系综，其生存概率为 $e^{-k t}$。\n- 对于具有非均一 $k$ 值的系综，其生存概率 $S(t)$ 等于 $e^{-k t}$ 在整个系综上的平均值，即速率分布的拉普拉斯变换。\n- 在 RRK 微正则框架中，对于 $m$ 个有效模式的反应子空间中的可用能量 $E_{\\text{avail}}$，速率随可用能量超过阈值的部分增加，并在 $E_{\\text{avail}} \\lt E_0$ 时为零。\n- 部分 IVR 可以通过引入总能量 $E_{\\text{tot}}$ 中的一个随机分数 $\\phi \\in [0,1]$ 来建模，该分数是动态可用于反应子空间的能量，因此 $E_{\\text{avail}} = \\phi E_{\\text{tot}}$。$\\phi$ 的非均一性可以通过一个在 $[0,1]$ 上有定义的概率密度 $g(\\phi)$ 来描述。\n\n您需要构建一个具体的、可测试的模型，并满足以下规范：\n1. 采用受 RRK 理论启发的微正则速率定律，用于能量为 $E_{\\text{avail}}$ 的有效 $m$ 模式反应子空间：\n   - 如果 $E_{\\text{avail}} \\ge E_0$，则 $k(\\phi) = \\nu \\left[1 - \\dfrac{E_0}{E_{\\text{avail}}}\\right]^{m-1}$，\n   - 如果 $E_{\\text{avail}} \\lt E_0$，则 $k(\\phi) = 0$，\n   其中 $\\nu$ 是一个频率因子，$m \\in \\mathbb{N}$ 代表反应坐标的有效耦合模式数。\n2. 假设 $\\phi$ 在 $[0,1]$ 上服从形状参数为 $(\\alpha,\\beta)$ 的 Beta 分布，即其概率密度 $g(\\phi) \\propto \\phi^{\\alpha - 1} (1 - \\phi)^{\\beta - 1}$。\n3. 仅使用上述定义，推导一个系综平均生存概率 $S(t)$ 的表达式。该表达式应为一个关于 $\\phi$ 的积分，并需要考虑到 $k(\\phi)=0$ 的亚阈值部分和 $k(\\phi)\\gt 0$ 的超阈值部分。您的表达式必须对任何 $t \\ge 0$、任何 $\\nu \\gt 0$、任何 $m \\in \\mathbb{N}$、任何 $E_0 \\ge 0$、任何 $E_{\\text{tot}} \\gt 0$ 以及任何 $\\alpha,\\beta \\gt 0$ 均有效。在您的推导中，请明确指出无量纲阈值比 $\\epsilon_0 \\equiv E_0/E_{\\text{tot}}$。\n4. 实现一个稳健的数值算法（在需要时使用数值积分）来为给定的参数集计算 $S(t)$。\n\n物理单位：\n- 时间 $t$ 必须以秒 (s) 为单位提供。\n- 生存概率 $S(t)$ 是无量纲的。\n- 频率因子 $\\nu$ 的单位是 $\\text{s}^{-1}$。能量 $E_0$ 和 $E_{\\text{tot}}$ 必须使用相同的单位；只有它们的比值 $\\epsilon_0 = E_0/E_{\\text{tot}}$进入最终表达式。\n\n您的程序必须为以下每个测试用例计算 $S(t)$，每个用例指定为一个元组 $(\\nu, E_0, E_{\\text{tot}}, m, \\alpha, \\beta, t)$：\n- 用例 A (正常路径): $(1.0\\times 10^6,\\, 1.0,\\, 1.5,\\, 4,\\, 5.0,\\, 7.0,\\, 2.0\\times 10^{-6})$。\n- 用例 B (近阈值平台): $(1.0\\times 10^6,\\, 1.0,\\, 1.01,\\, 4,\\, 2.0,\\, 8.0,\\, 1.0\\times 10^{-3})$。\n- 用例 C (高能量，强耦合): $(2.0\\times 10^6,\\, 1.0,\\, 5.0,\\, 6,\\, 5.0,\\, 5.0,\\, 2.0\\times 10^{-6})$。\n- 用例 D (零阈值特殊情况): $(3.0\\times 10^5,\\, 0.0,\\, 1.0,\\, 3,\\, 4.0,\\, 4.0,\\, 1.0\\times 10^{-5})$。\n- 用例 E (有效单模式边界情况，反应性和非反应性混合): $(1.0\\times 10^6,\\, 1.0,\\, 2.0,\\, 1,\\, 3.0,\\, 3.0,\\, 1.0\\times 10^{-6})$。\n- 用例 F (低于阈值，无反应): $(1.0\\times 10^6,\\, 1.0,\\, 0.9,\\, 4,\\, 2.0,\\, 2.0,\\, 1.0\\times 10^{-6})$。\n\n覆盖性设计：\n- 用例 A 探测具有中等阈值的非平凡非均一衰变。\n- 用例 B 探测一个具有大量亚阈值部分并因此引发长寿命平台的区间。\n- 用例 C 探测更高的能量和更大的 $m$。\n- 用例 D 强制 $E_0 = 0$，以在整个系综中产生纯粹的单指数极限。\n- 用例 E 强制 $m=1$，以产生一个具有解析基准解的双组分混合体系。\n- 用例 F 强制 $E_{\\text{tot}} \\lt E_0$，使得所有成员都处于亚阈值状态，因此 $S(t) = 1$。\n\n您的程序应生成单行输出，其中包含一个由方括号括起来的逗号分隔列表。每个元素必须是对应一个测试用例的 $S(t)$ 值，并四舍五入到六位小数。例如，输出格式必须与 “[$x_1,x_2,x_3,x_4,x_5,x_6$]” 完全一致，其中每个 $x_i$ 是一个小数点后恰好有六位数的小数，并且该行上没有其他文本。", "solution": "问题陈述已经过验证，被认为是科学上可靠、提法恰当且客观的。它提出了一个化学动力学中可解的问题，该问题建立在 RRK 理论和统计力学的既定原则之上。所有必需的参数和定义均已提供。\n\n主要目标是推导和计算系综平均生存概率 $S(t)$，适用于反应速率非均一的单分子反应。这种非均一性是部分分子内振动能量重分配 (IVR) 的结果。\n\n对于具有不随时间变化的速率常数 $k$ 的子系综，其生存概率由单指数衰变定律给出，$S(t, k) = e^{-k t}$。对于一个速率常数分布由概率密度函数 $P(k)$ 描述的系综，总生存概率 $S(t)$ 是在整个系综上的平均值：\n$$S(t) = \\int_0^\\infty e^{-k t} P(k) dk$$\n在这个问题中，非均一性是通过总能量中可用于反应子空间的分数 $\\phi \\in [0, 1]$ 来引入的。规定变量 $\\phi$ 服从形状参数为 $\\alpha > 0$ 和 $\\beta > 0$ 的 Beta 分布。$\\phi$ 的概率密度函数为：\n$$g(\\phi; \\alpha, \\beta) = \\frac{\\phi^{\\alpha-1}(1-\\phi)^{\\beta-1}}{B(\\alpha, \\beta)}$$\n其中 $B(\\alpha, \\beta) = \\frac{\\Gamma(\\alpha)\\Gamma(\\beta)}{\\Gamma(\\alpha+\\beta)}$ 是 Beta 函数。\n\n速率常数 $k$ 是 $\\phi$ 的函数，由修正的 RRK 定律确定。设 $E_{\\text{tot}}$ 为总能量，$E_0$ 为反应的临界能量。可用于反应子空间的能量为 $E_{\\text{avail}} = \\phi E_{\\text{tot}}$。速率定律定义为：\n$$\nk(\\phi) = \n\\begin{cases} \n\\nu \\left(1 - \\frac{E_0}{E_{\\text{avail}}}\\right)^{m-1} & \\text{if } E_{\\text{avail}} \\ge E_0 \\\\\n0 & \\text{if } E_{\\text{avail}} < E_0 \n\\end{cases}\n$$\n其中 $\\nu$ 是一个频率因子，$m \\in \\mathbb{N}$ 是有效模式数。我们定义无量纲阈值能量比 $\\epsilon_0 = E_0/E_{\\text{tot}}$。速率不为零的条件 $E_{\\text{avail}} \\ge E_0$ 变为 $\\phi E_{\\text{tot}} \\ge E_0$，或 $\\phi \\ge \\epsilon_0$。因此，速率定律可以用 $\\phi$ 和 $\\epsilon_0$ 表示为：\n$$\nk(\\phi) = \n\\begin{cases} \n\\nu \\left(1 - \\frac{\\epsilon_0}{\\phi}\\right)^{m-1} & \\text{if } \\phi \\ge \\epsilon_0 \\\\\n0 & \\text{if } \\phi < \\epsilon_0 \n\\end{cases}\n$$\n系综平均生存概率 $S(t)$ 是通过将 $e^{-k(\\phi)t}$ 对 $\\phi$ 的分布进行积分得到的：\n$$S(t) = \\int_0^1 e^{-k(\\phi)t} g(\\phi; \\alpha, \\beta) d\\phi$$\n该积分的行为取决于 $\\epsilon_0$ 的值。\n\n情况 1：$\\epsilon_0 \\ge 1$。这意味着 $E_0 \\ge E_{\\text{tot}}$。由于 $\\phi \\in [0, 1]$，对于系综中的所有成员，必然有 $\\phi \\le 1 \\le \\epsilon_0$。因此，对于所有的 $\\phi$，$k(\\phi)=0$，生存概率为：\n$$S(t) = \\int_0^1 e^0 g(\\phi; \\alpha, \\beta) d\\phi = \\int_0^1 g(\\phi; \\alpha, \\beta) d\\phi = 1$$\n这在物理上是正确的：如果总能量不足以克服能垒，则不会发生反应。\n\n情况 2：$0 \\le \\epsilon_0 < 1$。积分域 $[0, 1]$ 必须在阈值 $\\phi = \\epsilon_0$ 处分开：\n$$S(t) = \\int_0^{\\epsilon_0} e^{-k(\\phi)t} g(\\phi; \\alpha, \\beta) d\\phi + \\int_{\\epsilon_0}^1 e^{-k(\\phi)t} g(\\phi; \\alpha, \\beta) d\\phi$$\n对于第一个积分（亚阈值部分，$\\phi < \\epsilon_0$），$k(\\phi)=0$。该项代表非反应性群体的总概率：\n$$\\int_0^{\\epsilon_0} g(\\phi; \\alpha, \\beta) d\\phi = I_{\\epsilon_0}(\\alpha, \\beta)$$\n其中 $I_x(\\alpha, \\beta)$ 是正则化不完全 Beta 函数，也就是 Beta 分布的累积分布函数 (CDF)。\n对于第二个积分（超阈值部分，$\\phi \\ge \\epsilon_0$），$k(\\phi)$ 非零。该项是来自反应性群体的生存贡献：\n$$\\int_{\\epsilon_0}^1 \\exp\\left[-\\nu t \\left(1 - \\frac{\\epsilon_0}{\\phi}\\right)^{m-1}\\right] g(\\phi; \\alpha, \\beta) d\\phi$$\n将这些组合起来，当 $0 \\le \\epsilon_0 < 1$ 时，$S(t)$ 的完整表达式为：\n$$S(t) = I_{\\epsilon_0}(\\alpha, \\beta) + \\int_{\\epsilon_0}^1 \\exp\\left[-\\nu t \\left(1 - \\frac{\\epsilon_0}{\\phi}\\right)^{m-1}\\right] \\frac{\\phi^{\\alpha-1}(1-\\phi)^{\\beta-1}}{B(\\alpha, \\beta)} d\\phi$$\n对于任意参数，这个通用表达式通常无法解析积分，必须进行数值计算。\n\n特殊的极限情况可用于验证：\n- 如果 $E_0=0$，则 $\\epsilon_0=0$。对于所有 $\\phi > 0$，速率 $k(\\phi) = \\nu$ 变为常数。衰变是单指数的：$S(t) = e^{-\\nu t}$。\n- 如果 $m=1$，对于 $\\phi \\ge \\epsilon_0$，速率简化为 $k(\\phi) = \\nu$。系统简化为一个双态混合体系：一个非反应性部分 $I_{\\epsilon_0}(\\alpha, \\beta)$ 和一个以速率 $\\nu$ 衰变的反应性部分 $1-I_{\\epsilon_0}(\\alpha, \\beta)$。生存概率为 $S(t) = I_{\\epsilon_0}(\\alpha, \\beta) + (1-I_{\\epsilon_0}(\\alpha, \\beta))e^{-\\nu t}$。\n\n数值实现过程如下。构建一个函数，用于根据一组给定的参数 $(\\nu, E_0, E_{\\text{tot}}, m, \\alpha, \\beta, t)$ 计算 $S(t)$。\n1.  计算 $\\epsilon_0 = E_0/E_{\\text{tot}}$。\n2.  如果 $\\epsilon_0 \\ge 1$，函数返回 $1.0$。\n3.  如果 $0 \\le \\epsilon_0 < 1$，函数计算 $S(t)$ 的两个分量。第一项 $I_{\\epsilon_0}(\\alpha, \\beta)$ 使用 `scipy.stats.beta` 中提供的 Beta 分布的累积分布函数 (CDF) 计算。第二项，即对反应性群体的积分，通过 `scipy.integrate.quad` 使用数值积分计算。\n4.  最终结果是这两个分量之和。实现此算法以处理指定的测试用例。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.stats import beta as sp_stats_beta\nfrom scipy.integrate import quad\n\ndef calculate_s_t(params):\n    \"\"\"\n    Calculates the ensemble-averaged survival probability S(t).\n\n    Args:\n        params (tuple): A tuple containing the model parameters:\n                        (nu, E0, Etot, m, alpha, beta_param, t).\n\n    Returns:\n        float: The calculated survival probability S(t).\n    \"\"\"\n    nu, E0, Etot, m, alpha, beta_param, t = params\n\n    # The problem statement guarantees Etot > 0, so direct division is safe.\n    epsilon_0 = E0 / Etot\n\n    # Case 1: Total energy is below the threshold. No reaction occurs.\n    if epsilon_0 >= 1.0:\n        return 1.0\n\n    # Special Case: Zero threshold energy. Homogeneous kinetics.\n    # The general formula also works but this is a direct, efficient calculation.\n    if E0 == 0.0:  # This implies epsilon_0 = 0\n        return np.exp(-nu * t)\n\n    # General Case: 0  epsilon_0  1. The ensemble is heterogeneous.\n    \n    # Contribution from the non-reactive sub-ensemble (phi  epsilon_0).\n    # This is the value of the Beta distribution CDF at epsilon_0.\n    non_reactive_fraction = sp_stats_beta.cdf(epsilon_0, alpha, beta_param)\n    \n    # Contribution from the reactive sub-ensemble (phi >= epsilon_0).\n    # This part requires numerical integration.\n    def integrand(phi):\n        \"\"\"The function to be integrated: exp(-k(phi)*t) * g(phi).\"\"\"\n        # Safety check, although quad should stay within bounds.\n        if phi = epsilon_0:\n            return 0.0\n            \n        # RRK-inspired rate constant k(phi)\n        base = (phi - epsilon_0) / phi\n        rate_k = nu * (base ** (m - 1))\n        \n        # Probability density function g(phi)\n        pdf_val = sp_stats_beta.pdf(phi, alpha, beta_param)\n        \n        return np.exp(-rate_k * t) * pdf_val\n\n    # Numerical integration over the reactive range [epsilon_0, 1].\n    # Increased precision for robustness. quad returns (result, error_estimate).\n    reactive_contribution, _ = quad(\n        integrand, epsilon_0, 1.0, epsabs=1.49e-12, epsrel=1.49e-12\n    )\n    \n    # Total survival probability is the sum of contributions.\n    return non_reactive_fraction + reactive_contribution\n\ndef solve():\n    \"\"\"\n    Main function to define test cases, compute results, and print the output.\n    \"\"\"\n    # Define the test cases from the problem statement as tuples:\n    # (nu, E0, Etot, m, alpha, beta, t)\n    test_cases = [\n        # Case A: Happy path\n        (1.0e6, 1.0, 1.5, 4, 5.0, 7.0, 2.0e-6),\n        # Case B: Near-threshold plateau\n        (1.0e6, 1.0, 1.01, 4, 2.0, 8.0, 1.0e-3),\n        # Case C: High energy, stronger coupling\n        (2.0e6, 1.0, 5.0, 6, 5.0, 5.0, 2.0e-6),\n        # Case D: Zero threshold special case\n        (3.0e5, 0.0, 1.0, 3, 4.0, 4.0, 1.0e-5),\n        # Case E: Effective one-mode edge case\n        (1.0e6, 1.0, 2.0, 1, 3.0, 3.0, 1.0e-6),\n        # Case F: Below threshold, no reaction\n        (1.0e6, 1.0, 0.9, 4, 2.0, 2.0, 1.0e-6),\n    ]\n\n    results = []\n    for case in test_cases:\n        # Calculate S(t) for the current test case\n        s_t_value = calculate_s_t(case)\n        # Format the result to six decimal places for the final output string\n        results.append(f\"{s_t_value:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "2671485"}]}