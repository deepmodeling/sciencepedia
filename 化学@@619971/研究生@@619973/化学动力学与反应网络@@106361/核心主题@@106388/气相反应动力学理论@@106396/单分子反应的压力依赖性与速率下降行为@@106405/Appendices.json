{"hands_on_practices": [{"introduction": "单分子反应速率对压力的依赖性不仅取决于总压力，还取决于惰性“浴”气（bath gas）的化学性质。不同的气体分子在通过碰撞传递能量方面的效率不同。这个练习将通过计算“有效碰撞物浓度”来实践如何量化这些差异，从而使我们能够在不同的气体混合物中比较反应条件。[@problem_id:2665130]", "problem": "物种 $A$ 在背景气体 $M$ 存在下的单分子解离通过碰撞活化的中间体 $A^{*}$ 进行：\n$$A + M \\rightleftharpoons A^{*} + M,\\quad A^{*} \\rightarrow \\text{产物}.$$\n在固定温度下，低压极限速率系数 $k_{0}(T)$ 和高压极限速率系数 $k_{\\infty}(T)$ 是高能分子的性质，不依赖于背景气体的组成，而背景气体的组成通过有效碰撞物浓度来影响。对于具有第三体效率 $\\alpha_{i}$ 和摩尔分数 $x_{i}$ 的混合背景气体，有效碰撞物浓度 $[M]_{\\text{eff}}$ 的定义为，将每种背景组分的数密度按其效率进行加权。\n\n考虑在相同温度下的两种二元混合背景气体：\n- 混合物 1：氮气和氩气，其中 $x_{\\mathrm{N_{2}}}=0.70$，$x_{\\mathrm{Ar}}=0.30$。\n- 混合物 2：氩气和水，其中 $x_{\\mathrm{Ar}}=0.95$，$x_{\\mathrm{H_{2}O}}=0.05$。\n\n在此温度下，第三体效率为 $\\alpha_{\\mathrm{N_{2}}}=1.0$，$\\alpha_{\\mathrm{Ar}}=0.2$ 和 $\\alpha_{\\mathrm{H_{2}O}}=6.0$。假设所有混合物都表现为理想气体。\n\n仅使用 Lindemann 机理的基本动力学推理和理想气体定律，构建任意混合物的有效碰撞物浓度 $[M]_{\\text{eff}}$，并说明混合物组成如何通过折合压力控制压降曲线（例如，$\\ln(k/k_{\\infty})$ 对 $\\ln p$ 的图）的水平位置。然后，对于总压力为 $p_{1}=1.30\\,\\text{bar}$ 的混合物 1，确定必须施加于混合物 2 的总压力 $p_{2}$，以使两种混合物在此温度下具有相同的 $k/k_{\\infty}$ 值。\n\n将您计算出的 $p_{2}$ 最终数值四舍五入至四位有效数字，并以 bar 为单位表示。", "solution": "所述问题在科学上是合理的、自洽的且表述清晰。它描述了化学动力学中的一个标准情景，特别是通过 Lindemann-Hinshelwood 机理建模的单分子反应的压力依赖性，并且没有任何事实或逻辑上的矛盾。因此，我们可以进行严谨的求解。\n\n单分子反应方案如下所示：\n$$A + M \\rightleftharpoons A^{*} + M$$\n$$A^{*} \\rightarrow \\text{产物}$$\n相应的基元步骤是：\n1.  碰撞活化: $A + M \\xrightarrow{k_1} A^{*} + M$\n2.  碰撞失活: $A^{*} + M \\xrightarrow{k_{-1}} A + M$\n3.  单分子衰变: $A^{*} \\xrightarrow{k_2} \\text{产物}$\n\n我们对高能分子浓度 $[A^{*}]$ 应用稳态近似，假设其变化率为零：\n$$\\frac{d[A^{*}]}{dt} = k_1 [A][M] - k_{-1}[A^{*}][M] - k_2 [A^{*}] \\approx 0$$\n由此，我们解出 $A^{*}$ 的稳态浓度：\n$$[A^{*}] = \\frac{k_1 [A][M]}{k_{-1}[M] + k_2}$$\n产物的生成速率由 $v = k_2 [A^{*}]$ 给出，也可以用有效的一级速率系数 $k$ 定义为 $v = k[A]$。令这两个表达式相等，得到：\n$$k[A] = k_2 \\left( \\frac{k_1 [A][M]}{k_{-1}[M] + k_2} \\right)$$\n$$k = \\frac{k_1 k_2 [M]}{k_{-1}[M] + k_2}$$\n这个 $k$ 的表达式描述了从低压下的二级动力学到高压下的一级动力学的转变。\n\n高压极限速率系数 $k_{\\infty}$ 在 $[M] \\rightarrow \\infty$ 的极限下求得：\n$$k_{\\infty} = \\lim_{[M] \\to \\infty} \\frac{k_1 k_2 [M]}{k_{-1}[M] + k_2} = \\lim_{[M] \\to \\infty} \\frac{k_1 k_2}{k_{-1} + k_2/[M]} = \\frac{k_1 k_2}{k_{-1}}$$\n问题指出，对于混合背景气体，背景气体浓度 $[M]$ 必须替换为有效碰撞物浓度 $[M]_{\\text{eff}}$。这解释了背景气体组分的不同碰撞效率。因此，速率系数 $k$ 的更一般表达式为：\n$$k = \\frac{k_1 k_2 [M]_{\\text{eff}}}{k_{-1}[M]_{\\text{eff}} + k_2}$$\n其中我们将 $k_1$ 和 $k_{-1}$ 理解为参考碰撞物的速率系数。\n\n为分析压降行为，我们考虑比值 $k/k_{\\infty}$。将 $k$ 的表达式除以 $k_{\\infty}$ 的表达式：\n$$\\frac{k}{k_{\\infty}} = \\left( \\frac{k_1 k_2 [M]_{\\text{eff}}}{k_{-1}[M]_{\\text{eff}} + k_2} \\right) \\left( \\frac{k_{-1}}{k_1 k_2} \\right) = \\frac{k_{-1}[M]_{\\text{eff}}}{k_{-1}[M]_{\\text{eff}} + k_2}$$\n这可以重写为：\n$$\\frac{k}{k_{\\infty}} = \\frac{1}{1 + \\frac{k_2}{k_{-1}[M]_{\\text{eff}}}}$$\n这个方程表明，表征压降区位置的比值 $k/k_{\\infty}$ 是单一变量 $[M]_{\\text{eff}}$ 的函数。量 $k_2$ 和 $k_{-1}$ 仅依赖于反应物 $A$ 和温度 $T$，而与背景气体的性质无关。因此，压降曲线的水平位置（通常绘制为 $\\ln(k/k_{\\infty})$ 对 $\\ln(p)$ 的图）完全由 $[M]_{\\text{eff}}$ 决定。\n\n问题将混合物的有效碰撞物浓度定义为 $[M]_{\\text{eff}} = \\sum_{i} \\alpha_{i} [M_i]$，其中 $[M_i]$ 是背景组分 $i$ 的浓度，$\\alpha_i$ 是其第三体效率。假设理想气体行为，组分 $i$ 的浓度通过理想气体定律与其摩尔分数 $x_i$ 和总压力 $p$ 相关联：$[M_i] = \\frac{p_i}{RT} = \\frac{x_i p}{RT}$，其中 $R$ 是理想气体常数，$T$ 是绝对温度。\n将此代入 $[M]_{\\text{eff}}$ 的定义中：\n$$[M]_{\\text{eff}} = \\sum_{i} \\alpha_{i} \\left( \\frac{x_i p}{RT} \\right) = \\left( \\frac{p}{RT} \\right) \\sum_{i} \\alpha_{i} x_i$$\n让我们定义混合物平均效率为 $\\alpha_{\\text{mix}} = \\sum_{i} \\alpha_{i} x_i$。那么：\n$$[M]_{\\text{eff}} = \\alpha_{\\text{mix}} \\frac{p}{RT}$$\n问题要求找到混合物 2 的压力 $p_2$，使得它在压力 $p_1$ 下与混合物 1 具有相同的 $k/k_{\\infty}$ 值。由于两种混合物的温度相同，且 $k/k_{\\infty}$ 仅是 $[M]_{\\text{eff}}$ 的函数，因此条件是：\n$$([M]_{\\text{eff}})_1 = ([M]_{\\text{eff}})_2$$\n代入关联 $[M]_{\\text{eff}}$ 与压力和组成的表达式：\n$$\\alpha_{\\text{mix,1}} \\frac{p_1}{RT} = \\alpha_{\\text{mix,2}} \\frac{p_2}{RT}$$\n由于 $R$ 和 $T$ 相同，它们被消去，留下压力和混合物平均效率之间的直接关系：\n$$\\alpha_{\\text{mix,1}} p_1 = \\alpha_{\\text{mix,2}} p_2$$\n我们现在计算给定两种混合物的混合物平均效率。\n\n对于混合物 1 ($x_{\\mathrm{N_{2}}}=0.70, x_{\\mathrm{Ar}}=0.30$)：\n第三体效率为 $\\alpha_{\\mathrm{N_{2}}}=1.0$ 和 $\\alpha_{\\mathrm{Ar}}=0.2$。\n$$\\alpha_{\\text{mix,1}} = x_{\\mathrm{N_{2}}}\\alpha_{\\mathrm{N_{2}}} + x_{\\mathrm{Ar}}\\alpha_{\\mathrm{Ar}} = (0.70)(1.0) + (0.30)(0.2) = 0.70 + 0.06 = 0.76$$\n\n对于混合物 2 ($x_{\\mathrm{Ar}}=0.95, x_{\\mathrm{H_{2}O}}=0.05$)：\n第三体效率为 $\\alpha_{\\mathrm{Ar}}=0.2$ 和 $\\alpha_{\\mathrm{H_{2}O}}=6.0$。\n$$\\alpha_{\\text{mix,2}} = x_{\\mathrm{Ar}}\\alpha_{\\mathrm{Ar}} + x_{\\mathrm{H_{2}O}}\\alpha_{\\mathrm{H_{2}O}} = (0.95)(0.2) + (0.05)(6.0) = 0.19 + 0.30 = 0.49$$\n\n给定 $p_1 = 1.30\\,\\text{bar}$。我们现在可以求解 $p_2$：\n$$p_2 = p_1 \\frac{\\alpha_{\\text{mix,1}}}{\\alpha_{\\text{mix,2}}}$$\n$$p_2 = (1.30\\,\\text{bar}) \\frac{0.76}{0.49} = (1.30\\,\\text{bar}) \\times 1.55102... \\approx 2.0163265...\\,\\text{bar}$$\n按要求四舍五入至四位有效数字，我们得到混合物 2 的最终压力。\n$$p_2 = 2.016\\,\\text{bar}$$\n这个结果是合乎逻辑的：混合物 2 的平均碰撞效率 ($\\alpha_{\\text{mix,2}} = 0.49$) 低于混合物 1 ($\\alpha_{\\text{mix,1}} = 0.76$)。因此，混合物 2 需要更高的总压力才能达到相同的有效碰撞物浓度，从而在压降区处于相同的位置。", "answer": "$$\n\\boxed{2.016}\n$$", "id": "2665130"}, {"introduction": "为了在理论上处理碰撞能量转移，我们常常需要做出简化假设。两个最核心的假设是“强碰撞”和“弱碰撞”，它们代表了能量转移效率的两个极端情况。这个练习利用一个简化的三能级马尔可夫链模型，清晰地展示了这两种假设的数学形式及其对计算出的表观速率常数 $k_{\\mathrm{eff}}$ 的影响，从而帮助我们从根本上理解它们之间的差异。[@problem_id:2665065]", "problem": "考虑一个分子 $A$ 在浴气 $M$ 中单分子分解的活化-失活模型。该模型被表示为一个在三个能量递增的离散化能粒 $\\{1,2,3\\}$ 上的连续时间马尔可夫链 (CTMC)。只有能粒 $3$ 的能量在阈值以上，能以微正则速率常数 $k_3$ 分解为产物 $P$。与 $M$ 的碰撞会引起能量转移。浴气温度为 $T$，三个能粒的 Boltzmann 权重 (在归一化之前) 分别为 $1$、$\\alpha$ 和 $\\alpha^2$，其中 $\\alpha \\equiv \\exp(-\\varepsilon/(k_B T))$，$\\varepsilon>0$ 为某个能级间距， $k_B$ 为 Boltzmann 常数，$T$ 为温度。因此，归一化后的平衡概率为\n$$\np_1^{\\mathrm{eq}}=\\frac{1}{1+\\alpha+\\alpha^2},\\quad\np_2^{\\mathrm{eq}}=\\frac{\\alpha}{1+\\alpha+\\alpha^2},\\quad\np_3^{\\mathrm{eq}}=\\frac{\\alpha^2}{1+\\alpha+\\alpha^2}.\n$$\n您将比较在固定浴气数密度下的两种碰撞模型 (因此，下面所有由碰撞引起的速率都已是数密度加权后的值)。\n\n1) 弱碰撞模型 (最近邻能量转移)：碰撞仅引起最近邻跃迁，并满足相对于 Boltzmann 权重的细致平衡。设对于 $1\\to 2$ 和 $2\\to 3$ 两个过程，向上的最近邻碰撞速率均为 $a>0$。细致平衡则确定了向下的速率：\n$$\nq_{1\\to 2}=a,\\quad q_{2\\to 1}=\\frac{a}{\\alpha},\\quad q_{2\\to 3}=a,\\quad q_{3\\to 2}=\\frac{a}{\\alpha}.\n$$\n所有其他由碰撞引起的跃迁均为零。从能粒 $3$ 发生的单分子分解 $3\\to P$ 的速率为 $k_3$。\n\n2) 强碰撞模型 (每次碰撞完全随机化)：每次碰撞都会根据 Boltzmann 分布瞬时重新选择能粒。一个保持细致平衡且方便的 CTMC 生成元是\n$$\nq_{i\\to j}=\n\\begin{cases}\na_s\\,p_j^{\\mathrm{eq}}, & j\\neq i,\\\\\n-a_s\\left(1-p_i^{\\mathrm{eq}}\\right), & j=i,\n\\end{cases}\n$$\n其中碰撞频率参数 $a_s>0$。从能粒 $3$ 发生的单分子分解 $3\\to P$ 的速率为 $k_3$。\n\n对两种模型，将 $A\\to P$ 的有效一级速率常数 $k_{\\mathrm{eff}}$ 定义为单位 $A$ 总布居数的稳态产物通量。此处的稳态是通过将产物通量瞬时注入回能粒 $1$ 来维持的 (这是一种避免布居耗尽的标准稳态处理方法)，从而使系统保持在稳态非平衡状态。也就是说，令 $p_1$、$p_2$、$p_3$ 表示各能粒上的稳态概率，且 $p_1+p_2+p_3=1$，并对能粒 $1$ 施加一个与产物通量相等的源 $S$，即 $S = k_3 p_3$。然后，定义 $k_{\\mathrm{eff}} \\equiv k_3 p_3$。\n\n从 CTMC 主方程和上述定义出发，为每种碰撞模型解析地推导出 $k_{\\mathrm{eff}}$ 的表达式，用 $\\alpha$、$a$、$a_s$ 和 $k_3$ 表示。然后，代入以下数值计算两个模型的结果\n$$\n\\alpha=0.3,\\quad a=5.0\\times 10^{6}\\ \\text{s}^{-1},\\quad a_s=5.0\\times 10^{6}\\ \\text{s}^{-1},\\quad k_3=1.0\\times 10^{6}\\ \\text{s}^{-1}.\n$$\n将 $\\big(k_{\\mathrm{eff}}^{\\mathrm{weak}},\\,k_{\\mathrm{eff}}^{\\mathrm{strong}}\\big)$ 这对最终数值以行矩阵的形式报告，使用 LaTeX 的 $\\pmatrix$ 环境，并四舍五入到四位有效数字。速率单位为 $\\text{s}^{-1}$。", "solution": "该问题经过了验证，被认为是科学上合理、设定良好、客观且内部一致的。这是一个关于单分子反应理论的理论化学动力学标准问题。因此，将推导其解。\n\n目标是基于一个用于分子 $A$ 单分子分解的三态连续时间马尔可夫链 (CTMC) 模型，为弱碰撞和强碰撞这两种不同的碰撞模型推导有效的一级速率常数 $k_{\\mathrm{eff}}$。系统维持在一个稳态非平衡态，其中流向产物的布居通量 $k_3 p_3$ 作为源 $S$ 被重新注入到最低能量的能粒，即能粒 1。我们有 $S = k_3 p_3$，并且有效速率常数定义为 $k_{\\mathrm{eff}} \\equiv k_3 p_3$。总概率是归一化的，$p_1 + p_2 + p_3 = 1$。\n\n首先，我们分析弱碰撞模型。跃迁被限制在最近邻之间。三个能粒 $\\{p_1, p_2, p_3\\}$ 的概率的稳态主方程为：\n$$\n\\frac{dp_1}{dt} = q_{2\\to 1} p_2 - q_{1\\to 2} p_1 + S = 0\n$$\n$$\n\\frac{dp_2}{dt} = q_{1\\to 2} p_1 + q_{3\\to 2} p_3 - (q_{2\\to 1} + q_{2\\to 3}) p_2 = 0\n$$\n$$\n\\frac{dp_3}{dt} = q_{2\\to 3} p_2 - (q_{3\\to 2} + k_3) p_3 = 0\n$$\n代入给定的速率常数 ($q_{1\\to 2}=a$, $q_{2\\to 1}=a/\\alpha$, $q_{2\\to 3}=a$, $q_{3\\to 2}=a/\\alpha$) 和源 $S = k_3 p_3$，我们得到一个线性方程组：\n$$\n\\frac{a}{\\alpha} p_2 - a p_1 + k_3 p_3 = 0 \\quad (1)\n$$\n$$\na p_1 + \\frac{a}{\\alpha} p_3 - (\\frac{a}{\\alpha} + a) p_2 = 0 \\quad (2)\n$$\n$$\na p_2 - (\\frac{a}{\\alpha} + k_3) p_3 = 0 \\quad (3)\n$$\n从方程 $(3)$，我们可以用 $p_3$ 表示 $p_2$：\n$$\np_2 = \\frac{1}{a} \\left(\\frac{a}{\\alpha} + k_3\\right) p_3 = \\left(\\frac{1}{\\alpha} + \\frac{k_3}{a}\\right) p_3\n$$\n从方程 $(1)$，我们用 $p_2$ 和 $p_3$ 表示 $p_1$：\n$$\np_1 = \\frac{1}{a} \\left(\\frac{a}{\\alpha} p_2 + k_3 p_3\\right) = \\frac{p_2}{\\alpha} + \\frac{k_3}{a} p_3\n$$\n将 $p_2$ 的表达式代入这个 $p_1$ 的方程中：\n$$\np_1 = \\frac{1}{\\alpha} \\left(\\frac{1}{\\alpha} + \\frac{k_3}{a}\\right) p_3 + \\frac{k_3}{a} p_3 = \\left(\\frac{1}{\\alpha^2} + \\frac{k_3}{a\\alpha} + \\frac{k_3}{a}\\right) p_3\n$$\n现在，我们使用归一化条件 $p_1 + p_2 + p_3 = 1$：\n$$\n\\left(\\frac{1}{\\alpha^2} + \\frac{k_3}{a\\alpha} + \\frac{k_3}{a}\\right) p_3 + \\left(\\frac{1}{\\alpha} + \\frac{k_3}{a}\\right) p_3 + p_3 = 1\n$$\n提出因子 $p_3$：\n$$\np_3 \\left[ \\left(\\frac{1}{\\alpha^2} + \\frac{1}{\\alpha} + 1\\right) + \\frac{k_3}{a}\\left(\\frac{1+2\\alpha}{\\alpha}\\right) \\right] = 1\n$$\n$$\np_3 \\left[ \\frac{1+\\alpha+\\alpha^2}{\\alpha^2} + \\frac{k_3(1+2\\alpha)}{a\\alpha} \\right] = 1\n$$\n解出 $p_3$：\n$$\np_3 = \\left[ \\frac{1+\\alpha+\\alpha^2}{\\alpha^2} + \\frac{k_3(1+2\\alpha)}{a\\alpha} \\right]^{-1} = \\left[ \\frac{a(1+\\alpha+\\alpha^2) + k_3\\alpha(1+2\\alpha)}{a\\alpha^2} \\right]^{-1}\n$$\n有效速率常数为 $k_{\\mathrm{eff}}^{\\mathrm{weak}} = k_3 p_3$：\n$$\nk_{\\mathrm{eff}}^{\\mathrm{weak}} = \\frac{k_3 a \\alpha^2}{a(1+\\alpha+\\alpha^2) + k_3\\alpha(1+2\\alpha)}\n$$\n\n接下来，我们分析强碰撞模型。从态 $i$ 到态 $j$ 的碰撞诱导跃迁速率为 $q_{i\\to j} = a_s p_j^{\\mathrm{eq}}$ (对于 $j\\neq i$)。稳态主方程为：\n$$\n\\frac{dp_1}{dt} = \\sum_{j\\neq 1} a_s p_1^{\\mathrm{eq}} p_j - p_1 \\sum_{j\\neq 1} a_s p_j^{\\mathrm{eq}} + S = a_s p_1^{\\mathrm{eq}}(p_2+p_3) - a_s p_1(p_2^{\\mathrm{eq}}+p_3^{\\mathrm{eq}}) + k_3 p_3= 0\n$$\n$$\n\\frac{dp_2}{dt} = \\sum_{j\\neq 2} a_s p_2^{\\mathrm{eq}} p_j - p_2 \\sum_{j\\neq 2} a_s p_j^{\\mathrm{eq}} = a_s p_2^{\\mathrm{eq}}(p_1+p_3) - a_s p_2(p_1^{\\mathrm{eq}}+p_3^{\\mathrm{eq}}) = 0\n$$\n$$\n\\frac{dp_3}{dt} = \\sum_{j\\neq 3} a_s p_3^{\\mathrm{eq}} p_j - p_3 \\sum_{j\\neq 3} a_s p_j^{\\mathrm{eq}} - k_3 p_3 = a_s p_3^{\\mathrm{eq}}(p_1+p_2) - a_s p_3(p_1^{\\mathrm{eq}}+p_2^{\\mathrm{eq}}) - k_3 p_3 = 0\n$$\n使用归一化条件 $p_1+p_2+p_3=1$ 和 $p_1^{\\mathrm{eq}}+p_2^{\\mathrm{eq}}+p_3^{\\mathrm{eq}}=1$，方程简化为：\n对于态 2： $a_s p_2^{\\mathrm{eq}}(1-p_2) - a_s p_2(1-p_2^{\\mathrm{eq}}) = a_s p_2^{\\mathrm{eq}} - a_s p_2^{\\mathrm{eq}}p_2 - a_s p_2 + a_s p_2 p_2^{\\mathrm{eq}} = a_s(p_2^{\\mathrm{eq}}-p_2)=0$。 这得到 $p_2 = p_2^{\\mathrm{eq}}$。\n对于态 3： $a_s p_3^{\\mathrm{eq}}(1-p_3) - a_s p_3(1-p_3^{\\mathrm{eq}}) - k_3 p_3 = a_s(p_3^{\\mathrm{eq}}-p_3) - k_3 p_3 = 0$。 这得到 $(a_s+k_3)p_3 = a_s p_3^{\\mathrm{eq}}$，或 $p_3 = \\frac{a_s}{a_s+k_3} p_3^{\\mathrm{eq}}$。\n对于态 1： $a_s p_1^{\\mathrm{eq}}(1-p_1) - a_s p_1(1-p_1^{\\mathrm{eq}}) + k_3 p_3 = a_s(p_1^{\\mathrm{eq}}-p_1) + k_3 p_3 = 0$。 这得到 $p_1 = p_1^{\\mathrm{eq}} + \\frac{k_3}{a_s}p_3$。\n那么，有效速率常数 $k_{\\mathrm{eff}}^{\\mathrm{strong}} = k_3 p_3$ 为：\n$$\nk_{\\mathrm{eff}}^{\\mathrm{strong}} = k_3 \\left( \\frac{a_s}{a_s+k_3} p_3^{\\mathrm{eq}} \\right)\n$$\n代入 $p_3^{\\mathrm{eq}} = \\frac{\\alpha^2}{1+\\alpha+\\alpha^2}$：\n$$\nk_{\\mathrm{eff}}^{\\mathrm{strong}} = \\frac{k_3 a_s}{a_s+k_3} \\frac{\\alpha^2}{1+\\alpha+\\alpha^2}\n$$\n\n最后，我们计算数值。给定的参数是：\n$\\alpha=0.3$, $a=5.0\\times 10^{6}\\ \\text{s}^{-1}$, $a_s=5.0\\times 10^{6}\\ \\text{s}^{-1}$, $k_3=1.0\\times 10^{6}\\ \\text{s}^{-1}$。\n我们计算一些常用项：\n$\\alpha^2 = 0.3^2 = 0.09$。\n$1+\\alpha+\\alpha^2 = 1+0.3+0.09 = 1.39$。\n对于弱碰撞模型：\n$$\nk_{\\mathrm{eff}}^{\\mathrm{weak}} = \\frac{(1.0\\times 10^6)(5.0\\times 10^6)(0.09)}{(5.0\\times 10^6)(1.39) + (1.0\\times 10^6)(0.3)(1+2(0.3))}\n$$\n$$\nk_{\\mathrm{eff}}^{\\mathrm{weak}} = \\frac{4.5\\times 10^{11}}{6.95\\times 10^6 + (0.3\\times 10^6)(1.6)} = \\frac{4.5\\times 10^{11}}{6.95\\times 10^6 + 0.48\\times 10^6} = \\frac{4.5\\times 10^{11}}{7.43\\times 10^6} \\approx 60565.2759\\ \\text{s}^{-1}\n$$\n四舍五入到四位有效数字，$k_{\\mathrm{eff}}^{\\mathrm{weak}} = 6.057 \\times 10^4\\ \\text{s}^{-1}$。\n\n对于强碰撞模型：\n$$\nk_{\\mathrm{eff}}^{\\mathrm{strong}} = \\frac{(1.0\\times 10^6)(5.0\\times 10^6)}{(5.0\\times 10^6) + (1.0\\times 10^6)} \\times \\frac{0.09}{1.39}\n$$\n$$\nk_{\\mathrm{eff}}^{\\mathrm{strong}} = \\frac{5.0\\times 10^{12}}{6.0\\times 10^6} \\times \\frac{0.09}{1.39} = \\left(\\frac{5}{6}\\times 10^6\\right) \\times \\frac{0.09}{1.39} \\approx (833333.33) \\times (0.0647482) \\approx 53956.834\\ \\text{s}^{-1}\n$$\n四舍五入到四位有效数字，$k_{\\mathrm{eff}}^{\\mathrm{strong}} = 5.396 \\times 10^4\\ \\text{s}^{-1}$。\n按要求报告 $\\big(k_{\\mathrm{eff}}^{\\mathrm{weak}},\\,k_{\\mathrm{eff}}^{\\mathrm{strong}}\\big)$ 这对最终数值。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n6.057 \\times 10^4 & 5.396 \\times 10^4\n\\end{pmatrix}\n}\n$$", "id": "2665065"}, {"introduction": "为了精确预测单分子反应的坠落行为，理论化学家们使用能量分格主方程（energy-grained master equation）进行数值模拟。这个高阶练习将指导你构建并求解这样一个主方程，这是现代单分子速率理论的基石。通过将理想化的强碰撞模型与更真实的指数下降能量转移模型进行直接的定量比较，你将深入理解碰撞模型如何决定整个坠落曲线的形状。[@problem_id:2665109]", "problem": "您的任务是实现一个定量比较，用于对比在单分子反应中描述压力依赖性和衰减行为的两种碰撞能量转移模型。您需要通过计算和对比在指定的微正则速率 $k(E)$ 下，由每种模型预测的有效一级反应速率系数 $k_{\\text{eff}}(T,p)$。这两种模型是：(i) 强碰撞模型，在该模型中，每次碰撞都会将能量活化分子瞬时重新热化至正则分布；以及 (ii) 单指数下降（SED）模型（single-exponential-down，也称指数下降），在该模型中，每次碰撞向下转移的能量遵循指数分布，而向上跃迁则由细致平衡强制执行。您必须实现一个能量分格主方程，并将 $k_{\\text{eff}}(T,p)$ 提取为束缚态布居数动力学生成元的首个（即最大）实部特征值的负值。然后，对于每个测试用例，您必须输出比值 $k_{\\text{eff}}^{\\text{SC}}(T,p) / k_{\\text{eff}}^{\\text{SED}}(T,p)$ 的自然对数，其中上标分别表示强碰撞和单指数下降。\n\n使用的基础和定义：\n- 理想气体定律定义的数密度 $n$：$n = p / (k_{\\mathrm{B}} T)$，其中 $k_{\\mathrm{B}}$ 是玻尔兹曼常数，$T$ 是温度，$p$ 是压力。\n- 每个分子的硬球碰撞频率 $Z_{\\text{coll}}$：$Z_{\\text{coll}}(T,p) = n \\,\\sigma \\,\\bar v$，其中平均相对速率 $\\bar v = \\sqrt{\\frac{8 k_{\\mathrm{B}} T}{\\pi \\mu}}$，$\\sigma$ 是碰撞截面，$\\mu$ 是折合质量。\n- 在离散化能量格点 $\\{E_i\\}$ 上的正则（玻尔兹曼）能量分布：$\\pi_i \\propto \\exp\\!\\left(-\\frac{E_i}{k_{\\mathrm{B}} T}\\right)$，归一化为 $\\sum_i \\pi_i = 1$。\n- 关于能量分格上布居数向量 $\\mathbf{p}(t)$ 的能量分格主方程：\n  $$\\frac{d\\mathbf{p}}{dt} = \\left[ Z_{\\text{coll}}(T,p)\\,\\left(\\mathbf{P} - \\mathbf{I}\\right) - \\mathbf{K} \\right] \\mathbf{p},$$\n  其中 $\\mathbf{P}$ 是一个列随机矩阵，编码了能量格点之间每次碰撞的转移概率（碰撞核），$\\mathbf{I}$ 是单位矩阵，$\\mathbf{K}$ 是对角矩阵，其元素为 $K_{ii} = k(E_i)$。宏观有效一级速率常数是幸存布居数的长时间衰减率，由下式给出：\n  $$k_{\\text{eff}}(T,p) = -\\max\\left\\{\\Re(\\lambda): \\lambda \\in \\text{eig}\\left[Z_{\\text{coll}}(T,p)\\,(\\mathbf{P}-\\mathbf{I}) - \\mathbf{K}\\right]\\right\\}.$$\n- 微正则速率模型（其物理动机源于一个简化的Rice–Ramsperger–Kassel–Marcus风格的标度关系）：对于 $E \\ge E_0$，$k(E) = k_\\infty \\left(1 - \\frac{E_0}{E}\\right)^m$，对于 $E < E_0$，$k(E) = 0$，其中 $m$ 是一个控制速率在阈值以上如何上升的正整数，$k_\\infty$ 是高能极限。\n- 碰撞核：\n  1. 强碰撞模型：$\\mathbf{P}^{\\text{SC}}$ 的各列相同，且均等于正则分布 $\\boldsymbol{\\pi}$，即对所有 $i$，$P^{\\text{SC}}_{j i} = \\pi_j$。\n  2. 单指数下降模型：设特征向下跃迁能量为 $\\langle\\Delta E_{\\text{down}}\\rangle(T) = \\langle\\Delta E_{\\text{down}}\\rangle_0 \\left(\\frac{T}{T_0}\\right)^{n_d}$，其中 $T_0$ 是参考温度，$n_d$ 是一个指数，$\\langle\\Delta E_{\\text{down}}\\rangle_0$ 是一个常数。定义一个对称提议核 $S_{j i} = \\exp\\!\\left(-\\frac{|E_j-E_i|}{\\langle\\Delta E_{\\text{down}}\\rangle(T)}\\right)$，并通过Metropolis–Hastings构建来对 $\\boldsymbol{\\pi}$ 施加细致平衡：\n     $$W_{j i} = \\begin{cases}\n     S_{j i}\\,\\min\\!\\left(1, \\frac{\\pi_j}{\\pi_i}\\right), & j \\ne i,\\\\\n     1, & j = i,\n     \\end{cases} \\quad \\text{且} \\quad P^{\\text{SED}}_{j i} = \\frac{W_{j i}}{\\sum_k W_{k i}}.$$\n  这将得到一个列随机矩阵 $\\mathbf{P}^{\\text{SED}}$，其平均具有指数下降的步长，并满足精确的细致平衡。\n\n实现要求：\n- 使用一个包含 $N$ 个格点的等间距能量网格，范围从 $E_{\\min} = 0$ 到 $E_{\\max} = E_0 + \\alpha\\, k_{\\mathrm{B}} T$，其中 $N = 180$ 且 $\\alpha = 60$。计算中所有能量必须是每个分子的能量，单位为焦耳。对 $E_i$ 使用格点中心值。\n- 使用的常数：\n  - 玻尔兹曼常数 $k_{\\mathrm{B}} = 1.380649\\times 10^{-23}\\,\\mathrm{J/K}$。\n  - 阿伏伽德罗常数 $N_{\\mathrm{A}} = 6.02214076\\times 10^{23}\\,\\mathrm{mol^{-1}}$。\n  - 折合质量 $\\mu = 2.50\\times 10^{-26}\\,\\mathrm{kg}$。\n  - 硬球截面 $\\sigma = 5.00\\times 10^{-19}\\,\\mathrm{m^2}$。\n  - 每摩尔阈值能量 $E_{0,\\mathrm{mol}} = 8.00\\times 10^{4}\\,\\mathrm{J/mol}$，因此每个分子的阈值能量 $E_0 = E_{0,\\mathrm{mol}}/N_{\\mathrm{A}}$，单位为焦耳。\n  - 微正则高能极限 $k_\\infty = 1.00\\times 10^{12}\\,\\mathrm{s^{-1}}$。\n  - 微正则形状指数 $m = 2$。\n  - SED参考温度 $T_0 = 300\\,\\mathrm{K}$，向下跃迁参数 $\\langle\\Delta E_{\\text{down}}\\rangle_0 = 200\\,\\mathrm{cm^{-1}}$（使用 $1\\,\\mathrm{cm^{-1}} = 1.98644586\\times 10^{-23}\\,\\mathrm{J}$ 换算为每个分子的能量），以及指数 $n_d = 0.85$。\n- 对于每个测试用例 $(T,p)$，计算 $k_{\\text{eff}}^{\\text{SC}}(T,p)$ 和 $k_{\\text{eff}}^{\\text{SED}}(T,p)$（单位为 $\\mathrm{s^{-1}}$），然后返回无量纲量\n  $$\\Delta(T,p) = \\ln\\!\\left(\\frac{k_{\\text{eff}}^{\\text{SC}}(T,p)}{k_{\\text{eff}}^{\\text{SED}}(T,p)}\\right)。$$\n\n数值和算法说明：\n- 构建生成元 $\\mathbf{L} = Z_{\\text{coll}}(T,p)\\,(\\mathbf{P}-\\mathbf{I}) - \\mathbf{K}$ 并计算其特征值。有效速率 $k_{\\text{eff}}$ 是具有最大实部的特征值的负值。使用适用于实数非对称矩阵的稠密特征值求解器。\n- 通过显式归一化来确保 $\\mathbf{P}$ 的列随机性质在数值上得到满足。\n- 通过使用指定的 $N$ 和 $E_{\\max}$ 并谨慎计算玻尔兹曼因子来确保数值稳定性。\n\n测试套件和输出规范：\n- 使用以下五个测试用例 $(T,p)$，其中 $T$ 的单位是开尔文，$p$ 的单位是帕斯卡：\n  1. $(T,p) = (600\\,\\mathrm{K}, 100\\,\\mathrm{Pa})$，\n  2. $(T,p) = (600\\,\\mathrm{K}, 1.0\\times 10^{5}\\,\\mathrm{Pa})$，\n  3. $(T,p) = (1000\\,\\mathrm{K}, 1.0\\times 10^{4}\\,\\mathrm{Pa})$，\n  4. $(T,p) = (1000\\,\\mathrm{K}, 1.0\\times 10^{5}\\,\\mathrm{Pa})$，\n  5. $(T,p) = (1200\\,\\mathrm{K}, 5.0\\times 10^{4}\\,\\mathrm{Pa})$。\n- 您的程序应生成单行输出，其中包含一个逗号分隔的列表，用方括号括起，结果顺序与测试用例相同，每个条目是 $\\Delta(T,p)$ 的十进制表示（无量纲）。仅为格式示例：$[\\Delta_1,\\Delta_2,\\Delta_3,\\Delta_4,\\Delta_5]$。", "solution": "该问题要求在单分子反应的背景下，对用于碰撞能量转移的强碰撞（SC）模型和单指数下降（SED）模型进行定量比较。目标是针对一组给定的温度 $T$ 和压力 $p$ 计算有效一级速率常数 $k_{\\text{eff}}(T,p)$，然后确定这些速率常数之比的自然对数 $\\Delta(T,p) = \\ln(k_{\\text{eff}}^{\\text{SC}} / k_{\\text{eff}}^{\\text{SED}})$。\n\n该分析的基础是能量分格主方程，它描述了布居数向量 $\\mathbf{p}(t)$ 在内能态的离散格点 $\\{E_i\\}_{i=1}^N$ 上的时间演化。控制该过程的微分方程为：\n$$ \\frac{d\\mathbf{p}}{dt} = \\mathbf{L} \\mathbf{p} = \\left[ Z_{\\text{coll}}(T,p)\\,(\\mathbf{P} - \\mathbf{I}) - \\mathbf{K} \\right] \\mathbf{p}(t) $$\n此处，$\\mathbf{L}$ 是弛豫-反应矩阵，或称生成元。系统的长时间行为由 $\\mathbf{L}$ 具有最大实部的特征值主导。有效速率常数 $k_{\\text{eff}}$ 是此主导特征值的负值：\n$$ k_{\\text{eff}}(T,p) = -\\max\\left\\{\\Re(\\lambda): \\lambda \\in \\text{eig}(\\mathbf{L})\\right\\} $$\n生成元 $\\mathbf{L}$ 由三个不同的部分组成：碰撞频率 $Z_{\\text{coll}}(T,p)$、每次碰撞的转移概率矩阵 $\\mathbf{P}$ 以及微正则反应速率的对角矩阵 $\\mathbf{K}$。\n\n对于每个给定的 $(T,p)$ 对，计算 $\\Delta(T,p)$ 的分步流程如下：\n\n1.  **定义系统常数和能量格点：**\n    首先，所有物理常数均以国际单位制（SI）定义。阈值能量 $E_0$ 使用阿伏伽德罗常数 $N_{\\mathrm{A}}$ 从摩尔量（$E_{0,\\mathrm{mol}}$）转换为分子量：$E_0 = E_{0,\\mathrm{mol}} / N_{\\mathrm{A}}$。参考向下跃迁能量 $\\langle\\Delta E_{\\text{down}}\\rangle_0$ 从波数（$\\mathrm{cm^{-1}}$）转换为焦耳。\n    构建一个包含 $N=180$ 个点的等间距能量格点。该格点范围从 $E_{\\min}=0$ 到 $E_{\\max} = E_0 + \\alpha k_{\\mathrm{B}} T$，其中 $\\alpha=60$。第 $i$ 个格点的能量 $E_i$ 取为能量区间的中心值。能量步长为 $\\Delta E = E_{\\max}/N$，格点为 $E_i = (i + 0.5)\\Delta E$，其中 $i \\in \\{0, 1, \\dots, N-1\\}$。\n\n2.  **计算给定 $(T,p)$ 下与状态无关的量：**\n    对于每对温度 $T$ 和压力 $p$，我们计算仅依赖于这些宏观条件的量。\n    - 数密度 $n$ 由理想气体定律计算得出：$n = p / (k_{\\mathrm{B}} T)$。\n    - 硬球碰撞的平均相对速率 $\\bar{v}$ 由 $\\bar{v} = \\sqrt{8 k_{\\mathrm{B}} T / (\\pi \\mu)}$ 给出，其中 $\\mu$ 是折合质量。\n    - 每个分子的总碰撞频率为 $Z_{\\text{coll}}(T,p) = n\\,\\sigma\\,\\bar{v}$，其中 $\\sigma$ 是碰撞截面。\n\n3.  **构建与状态相关的矩阵：**\n    - **正则分布 $\\boldsymbol{\\pi}$：** 在能量格点上计算平衡态的玻尔兹曼布居数向量 $\\boldsymbol{\\pi}$。其元素为 $\\pi_i \\propto \\exp(-E_i / (k_{\\mathrm{B}} T))$。然后对该向量进行归一化，使得 $\\sum_i \\pi_i = 1$。\n    - **微正则速率矩阵 $\\mathbf{K}$：** 这是一个对角矩阵，其元素为 $K_{ii} = k(E_i)$。微正则速率 $k(E)$ 由以下模型给出：\n      $$ k(E_i) = \\begin{cases} k_\\infty \\left(1 - \\frac{E_0}{E_i}\\right)^m, & \\text{若 } E_i \\ge E_0 \\\\ 0, & \\text{若 } E_i < E_0 \\end{cases} $$\n      其中 $k_\\infty$ 是高压速率常数，$m=2$ 是形状指数。\n\n4.  **计算强碰撞模型的 $k_{\\text{eff}}^{\\text{SC}}$：**\n    - **转移矩阵 $\\mathbf{P}^{\\text{SC}}$：** 在强碰撞近似中，假定单次碰撞足以在碰撞分子之间重新建立能量的玻尔兹曼分布。因此，转移矩阵 $\\mathbf{P}^{\\text{SC}}$ 的各列相同，均为正则分布向量 $\\boldsymbol{\\pi}$。即，对于所有初始态 $i$，$P^{\\text{SC}}_{ji} = \\pi_j$。\n    - **生成元矩阵 $\\mathbf{L}^{\\text{SC}}$：** SC 模型的生成元构建为 $\\mathbf{L}^{\\text{SC}} = Z_{\\text{coll}}(T,p)(\\mathbf{P}^{\\text{SC}} - \\mathbf{I}) - \\mathbf{K}$，其中 $\\mathbf{I}$ 是单位矩阵。\n    - **特征值计算：** 计算实数非对称矩阵 $\\mathbf{L}^{\\text{SC}}$ 的特征值。有效速率常数通过 $k_{\\text{eff}}^{\\text{SC}}(T,p) = -\\max(\\Re(\\text{eig}(\\mathbf{L}^{\\text{SC}})))$ 求得。\n\n5.  **计算单指数下降模型的 $k_{\\text{eff}}^{\\text{SED}}$：**\n    - **特征能量转移 $\\langle\\Delta E_{\\text{down}}\\rangle$：** 失活碰撞中传递的平均能量依赖于温度，即 $\\langle\\Delta E_{\\text{down}}\\rangle(T) = \\langle\\Delta E_{\\text{down}}\\rangle_0 (T/T_0)^{n_d}$。\n    - **转移矩阵 $\\mathbf{P}^{\\text{SED}}$：** SED 核更为复杂。其构建旨在满足细致平衡。\n        i. 定义一个对称提议核 $\\mathbf{S}$，其元素为 $S_{ji} = \\exp(-|E_j - E_i| / \\langle\\Delta E_{\\text{down}}\\rangle(T))$。\n        ii. 使用 Metropolis-Hastings 准则形成一个中间矩阵 $\\mathbf{W}$，以对 $\\boldsymbol{\\pi}$ 施加细致平衡：对于 $j \\neq i$，$W_{ji} = S_{ji} \\min(1, \\pi_j/\\pi_i)$；对于 $j=i$，$W_{ii} = 1$。\n        iii. 最终的转移矩阵 $\\mathbf{P}^{\\text{SED}}$ 通过对 $\\mathbf{W}$ 的列进行归一化得到：$P^{\\text{SED}}_{ji} = W_{ji} / \\sum_k W_{ki}$。这确保了 $\\mathbf{P}^{\\text{SED}}$ 是列随机的。\n    - **生成元矩阵 $\\mathbf{L}^{\\text{SED}}$：** 此时生成元为 $\\mathbf{L}^{\\text{SED}} = Z_{\\text{coll}}(T,p)(\\mathbf{P}^{\\text{SED}} - \\mathbf{I}) - \\mathbf{K}$。\n    - **特征值计算：** 与 SC 模型类似，计算 $\\mathbf{L}^{\\text{SED}}$ 的特征值，并确定速率常数：$k_{\\text{eff}}^{\\text{SED}}(T,p) = -\\max(\\Re(\\text{eig}(\\mathbf{L}^{\\text{SED}})))$。\n\n6.  **计算最终比值：**\n    对于每个 $(T,p)$ 测试用例，计算最终所需量：\n    $$ \\Delta(T,p) = \\ln\\left(\\frac{k_{\\text{eff}}^{\\text{SC}}(T,p)}{k_{\\text{eff}}^{\\text{SED}}(T,p)}\\right) $$\n    收集所有测试用例的结果，并以指定格式呈现。整个过程使用 Python 及其 `numpy` 库进行数值实现，特别是利用该库的线性代数功能来对生成元矩阵进行特征值分解。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import constants as spc\n\ndef solve():\n    \"\"\"\n    Computes and contrasts the effective first-order rate coefficients for\n    unimolecular reactions from the strong-collision and single-exponential-down models.\n    \"\"\"\n\n    # --- Problem Constants ---\n    # Physical constants from scipy for precision\n    KB_J_PER_K = spc.k  # Boltzmann constant in J/K\n    NA_PER_MOL = spc.N_A  # Avogadro constant in mol^-1\n\n    # System-specific constants\n    MU_KG = 2.50e-26  # Reduced mass in kg\n    SIGMA_M2 = 5.00e-19  # Hard-sphere cross section in m^2\n    E0_MOL_J_PER_MOL = 8.00e4  # Threshold energy in J/mol\n    KINFTY_S_MINUS_1 = 1.00e12  # High-energy limit rate constant in s^-1\n    M_EXPONENT = 2  # Microcanonical rate shape exponent\n\n    # SED model parameters\n    T0_K = 300.0  # Reference temperature in K\n    CM_MINUS_1_TO_J = 1.98644586e-23  # Conversion factor\n    DELTA_E_DOWN_0_CM = 200.0  # Reference down-step energy in cm^-1\n    ND_EXPONENT = 0.85  # Temperature dependence exponent for SED\n\n    # Numerical grid parameters\n    N_GRAINS = 180\n    ALPHA_GRID = 60.0\n\n    # Convert constants to per-molecule SI units\n    E0_J = E0_MOL_J_PER_MOL / NA_PER_MOL\n    DELTA_E_DOWN_0_J = DELTA_E_DOWN_0_CM * CM_MINUS_1_TO_J\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (600.0, 100.0),            # (T in K, p in Pa)\n        (600.0, 1.0e5),\n        (1000.0, 1.0e4),\n        (1000.0, 1.0e5),\n        (1200.0, 5.0e4),\n    ]\n\n    results = []\n    for T_k, p_pa in test_cases:\n        # --- 1. Setup Energy Grid and State-Independent Quantities ---\n        e_max = E0_J + ALPHA_GRID * KB_J_PER_K * T_k\n        # Use bin centers for the energy grid\n        e_grid_edges = np.linspace(0, e_max, N_GRAINS + 1)\n        e_grid_centers = (e_grid_edges[:-1] + e_grid_edges[1:]) / 2.0\n\n        # --- 2. Calculate Collision Frequency ---\n        number_density = p_pa / (KB_J_PER_K * T_k)\n        mean_relative_speed = np.sqrt(8.0 * KB_J_PER_K * T_k / (np.pi * MU_KG))\n        z_coll = number_density * SIGMA_M2 * mean_relative_speed\n\n        # --- 3. Construct State-Dependent Matrices ---\n        # Canonical (Boltzmann) distribution vector\n        # Stable calculation of Boltzmann factors\n        exponents = -e_grid_centers / (KB_J_PER_K * T_k)\n        pi_vec = np.exp(exponents)\n        pi_vec /= np.sum(pi_vec)\n\n        # Microcanonical rate diagonal matrix K\n        k_vec = np.zeros(N_GRAINS)\n        reactive_mask = e_grid_centers >= E0_J\n        # Avoid division by zero, although grid centers are positive\n        energies_above_threshold = e_grid_centers[reactive_mask]\n        k_vec[reactive_mask] = KINFTY_S_MINUS_1 * \\\n            (1.0 - E0_J / energies_above_threshold)**M_EXPONENT\n        K_matrix = np.diag(k_vec)\n        \n        I_matrix = np.identity(N_GRAINS)\n\n        # --- 4. Strong-Collision Model ---\n        # Transition matrix has identical columns equal to pi_vec\n        P_sc = np.tile(pi_vec.reshape(-1, 1), (1, N_GRAINS))\n        \n        # Generator matrix L\n        L_sc = z_coll * (P_sc - I_matrix) - K_matrix\n        \n        # Eigenvalue calculation\n        eigvals_sc = np.linalg.eigvals(L_sc)\n        k_eff_sc = -np.max(np.real(eigvals_sc))\n\n        # --- 5. Single-Exponential-Down Model ---\n        # Characteristic down-step energy\n        delta_e_down = DELTA_E_DOWN_0_J * (T_k / T0_K)**ND_EXPONENT\n        \n        # Metropolis-Hastings kernel construction\n        # Symmetric proposal kernel S\n        e_diff_matrix = np.abs(e_grid_centers[:, np.newaxis] - e_grid_centers)\n        S_matrix = np.exp(-e_diff_matrix / delta_e_down)\n        \n        # Intermediate matrix W\n        # Using reshape for safe broadcasting\n        pi_ratio_matrix = pi_vec.reshape(-1, 1) / pi_vec.reshape(1, -1)\n        W_matrix = S_matrix * np.minimum(1.0, pi_ratio_matrix)\n        np.fill_diagonal(W_matrix, 1.0)\n        \n        # Column-normalize W to get the stochastic matrix P_sed\n        P_sed = W_matrix / np.sum(W_matrix, axis=0)\n        \n        # Generator matrix L\n        L_sed = z_coll * (P_sed - I_matrix) - K_matrix\n\n        # Eigenvalue calculation\n        eigvals_sed = np.linalg.eigvals(L_sed)\n        k_eff_sed = -np.max(np.real(eigvals_sed))\n\n        # --- 6. Calculate Final Ratio ---\n        delta = np.log(k_eff_sc / k_eff_sed)\n        results.append(delta)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.8f}' for r in results)}]\")\n\nsolve()\n```", "id": "2665109"}]}