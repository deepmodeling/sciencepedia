{"hands_on_practices": [{"introduction": "在分析任何分子碰撞或反应动力学实验之前，首要步骤是将观察结果从实验室坐标系转换到质心 (CM) 坐标系。这个基础练习旨在巩固计算质心速度和碰撞能量的核心技能，这是解读散射数据、理解能量如何转化为反应产物的平动和内能的先决条件。通过这个计算，您将为分析更复杂的散射现象奠定坚实的数学和物理基础。[@problem_id:1529507]", "problem": "一项交叉分子束实验，一种用于研究反应动力学的强大技术，被设置用于研究氩原子和氧分子之间的碰撞。一束氩(Ar)原子沿x轴正方向行进，一束垂直的双原子氧($\\text{O}_2$)分子沿y轴正方向行进。两束在原点相交。实验参数如下：\n\n- 氩原子的速率为 $v_{Ar} = 500.0 \\text{ m/s}$。\n- 氧分子的速率为 $v_{O_2} = 400.0 \\text{ m/s}$。\n- 氩的摩尔质量为 $M_{Ar} = 39.95 \\text{ g/mol}$。\n- 氧的摩尔质量为 $M_{O_2} = 32.00 \\text{ g/mol}$。\n- Avogadro常数为 $N_A = 6.022 \\times 10^{23} \\text{ mol}^{-1}$。\n\n为了分析该碰撞事件，必须在质心(CM)参考系中进行。您需要确定该参考系的关键性质。请计算质心的速率、其速度矢量与x轴正方向的夹角，以及系统在质心参考系中的总动能（常称为碰撞能）。\n\n请按顺序以一组三个数值的形式提供您的最终答案，分别对应速率、角度和动能。速率以m/s为单位，角度以度为单位，动能以焦耳为单位。将您的所有三个最终答案四舍五入到三位有效数字。", "solution": "我们将该碰撞建模为一个双体系统，包含一个Ar原子（单个粒子质量为$m_{Ar}$，速度为$\\vec{v}_{Ar}$）和一个$\\mathrm{O}_{2}$分子（单个粒子质量为$m_{O_{2}}$，速度为$\\vec{v}_{O_{2}}$）。单个粒子的质量可由给定的摩尔质量$M_{Ar}$和$M_{O_{2}}$通过公式$m_{i} = \\frac{M_{i}}{N_{A}}$得出。\n\n根据动量守恒，质心(CM)速度定义为\n$$\n\\vec{V}_{\\mathrm{CM}}=\\frac{m_{Ar}\\,\\vec{v}_{Ar}+m_{O_{2}}\\,\\vec{v}_{O_{2}}}{m_{Ar}+m_{O_{2}}}.\n$$\n由于$\\vec{v}_{Ar}=(v_{Ar},0)$且$\\vec{v}_{O_{2}}=(0,v_{O_{2}})$，其分量为\n$$\nV_{x}=\\frac{m_{Ar}\\,v_{Ar}}{m_{Ar}+m_{O_{2}}}=\\frac{M_{Ar}\\,v_{Ar}}{M_{Ar}+M_{O_{2}}},\\qquad\nV_{y}=\\frac{m_{O_{2}}\\,v_{O_{2}}}{m_{Ar}+m_{O_{2}}}=\\frac{M_{O_{2}}\\,v_{O_{2}}}{M_{Ar}+M_{O_{2}}}.\n$$\n因此，质心速率及其相对于+x轴的方向为\n$$\nV_{\\mathrm{CM}}=\\sqrt{V_{x}^{2}+V_{y}^{2}}=\\frac{\\sqrt{(M_{Ar}v_{Ar})^{2}+(M_{O_{2}}v_{O_{2}})^{2}}}{M_{Ar}+M_{O_{2}}},\\qquad\n\\theta=\\arctan\\!\\left(\\frac{V_{y}}{V_{x}}\\right)=\\arctan\\!\\left(\\frac{M_{O_{2}}\\,v_{O_{2}}}{M_{Ar}\\,v_{Ar}}\\right).\n$$\n对于双体系统，质心参考系中的总动能（碰撞能）为\n$$\nE_{\\mathrm{coll}}=\\frac{1}{2}\\,\\mu\\,v_{\\mathrm{rel}}^{2},\\qquad \\mu=\\frac{m_{Ar}\\,m_{O_{2}}}{m_{Ar}+m_{O_{2}}}=\\frac{M_{Ar}M_{O_{2}}}{N_{A}\\,(M_{Ar}+M_{O_{2}})},\n$$\n其中相对速率为$v_{\\mathrm{rel}}=|\\vec{v}_{Ar}-\\vec{v}_{O_{2}}|$。由于两束相互垂直，\n$$\nv_{\\mathrm{rel}}=\\sqrt{v_{Ar}^{2}+v_{O_{2}}^{2}}.\n$$\n\n现在代入给定的数值（其中$M$使用国际单位制单位）并进行计算：\n- $M_{Ar}=0.03995\\,\\text{kg/mol}$, $M_{O_{2}}=0.03200\\,\\text{kg/mol}$, $N_{A}=6.022\\times 10^{23}\\,\\text{mol}^{-1}$,\n- $v_{Ar}=500.0\\,\\text{m/s}$, $v_{O_{2}}=400.0\\,\\text{m/s}$.\n\n质心速度分量：\n$$\nV_{x}=\\frac{0.03995\\times 500.0}{0.03995+0.03200}=\\frac{19.975}{0.07195}\\approx 2.77623\\times 10^{2}\\,\\text{m/s},\n$$\n$$\nV_{y}=\\frac{0.03200\\times 400.0}{0.03995+0.03200}=\\frac{12.800}{0.07195}\\approx 1.77901\\times 10^{2}\\,\\text{m/s}.\n$$\n质心速率和角度：\n$$\nV_{\\mathrm{CM}}=\\sqrt{(2.77623\\times 10^{2})^{2}+(1.77901\\times 10^{2})^{2}}\\approx 3.29733\\times 10^{2}\\,\\text{m/s},\n$$\n$$\n\\theta=\\arctan\\!\\left(\\frac{12.800}{19.975}\\right)\\approx \\arctan(0.640801)\\approx 32.7\\,\\text{degrees}.\n$$\n\n碰撞能：\n$$\n\\mu=\\frac{M_{Ar}M_{O_{2}}}{N_{A}(M_{Ar}+M_{O_{2}})}=\\frac{0.03995\\times 0.03200}{6.022\\times 10^{23}\\times 0.07195}\\,\\text{kg}\\approx \\frac{1.776789437\\times 10^{-2}}{6.022\\times 10^{23}}\\,\\text{kg}\\approx 2.95\\times 10^{-26}\\,\\text{kg},\n$$\n$$\nv_{\\mathrm{rel}}=\\sqrt{500.0^{2}+400.0^{2}}=\\sqrt{410000}\\,\\text{m/s},\n$$\n$$\nE_{\\mathrm{coll}}=\\frac{1}{2}\\,\\mu\\,v_{\\mathrm{rel}}^{2}=\\frac{1}{2}\\,\\frac{M_{Ar}M_{O_{2}}}{N_{A}(M_{Ar}+M_{O_{2}})}\\,(v_{Ar}^{2}+v_{O_{2}}^{2})\\approx \\frac{1}{2}\\times \\frac{0.01776789437}{6.022\\times 10^{23}}\\times 4.10\\times 10^{5}\\,\\text{J}\\approx 6.05\\times 10^{-21}\\,\\text{J}.\n$$\n\n四舍五入到三位有效数字后，质心速率、角度（度）和碰撞能（焦耳）分别为：\n- $V_{\\mathrm{CM}}\\approx 3.30\\times 10^{2}$,\n- $\\theta\\approx 32.7$,\n- $E_{\\mathrm{coll}}\\approx 6.05\\times 10^{-21}$.", "answer": "$$\\boxed{\\begin{pmatrix}3.30\\times 10^{2} & 32.7 & 6.05\\times 10^{-21}\\end{pmatrix}}$$", "id": "1529507"}, {"introduction": "实验总是在实验室坐标系中进行的，但理论模型通常在更简洁的质心坐标系中表述。这项实践将挑战您执行从理论到可观测量这一关键的转换，即从给定的质心系微分截面 (DCS) 推导出实验室坐标系下的角分布。掌握这一推导过程对于连接理论预测与实验测量至关重要，它使我们能够直接检验理论模型的有效性。[@problem_id:2626677]", "problem": "一个反应散射实验将物种 $A$ 的喷射源与物种 $B$ 的单能分子束交叉。物种 $B$ 束沿着 $+z$ 轴以实验室速率 $u_{b}$ 运动，而 $A$ 的喷射源保持在温度 $T$。反应 $A + B \\rightarrow P + \\cdots$ 产生的产物 $P$ 具有一个精确定义的质心（CM）速率 $v_{0}$（窄的产物平动能量释放）。$P$ 的质心微分截面（DCS）是各向同性的，即 $d\\sigma/d\\Omega_{\\mathrm{CM}}$ 为常数。假设 $m_{A} = m_{B}$，且喷射源相对于分子束足够冷，使得 $k_{B} T \\ll \\tfrac{1}{2} m_{B} u_{b}^{2}$，因此在设定质心运动时，可以忽略 $A$ 相对于 $u_{b}$ 的速度。\n\n仅使用 Galilean 速度加法律和动量守恒来定义质心速度，并利用质心和实验室坐标系之间速度-方向映射的 Jacobian 矩阵，从业已知的质心 DCS 推导出实验室角分布 $I(\\theta_{\\mathrm{lab}})$（可差一个乘法常数）。然后，对于特定参数 $u_{b} = 2.0 \\times 10^{3}\\ \\mathrm{m\\,s^{-1}}$，$v_{0} = 1.5 \\times 10^{3}\\ \\mathrm{m\\,s^{-1}}$ 以及 $m_{A} = m_{B}$，计算比值\n$$\nR \\equiv \\frac{I(\\theta_{\\mathrm{lab}} = \\tfrac{\\pi}{2}\\ \\mathrm{radians})}{I(\\theta_{\\mathrm{lab}} = 0\\ \\mathrm{radians})}.\n$$\n将您的最终答案表示为单个精确的解析表达式（无数值四舍五入）。角度均以弧度处理。", "solution": "质心的速度 $\\mathbf{V}_{\\mathrm{CM}}$ 由线性动量守恒定义：\n$$\n\\mathbf{V}_{\\mathrm{CM}} = \\frac{m_{A} \\mathbf{v}_{A} + m_{B} \\mathbf{v}_{B}}{m_{A} + m_{B}}\n$$\n我们已知物种 $B$ 的束沿着 $+z$ 轴运动，因此其速度矢量为 $\\mathbf{v}_{B} = u_{b} \\hat{\\mathbf{z}}$。问题陈述中提到，可以忽略来自喷射源的物种 $A$ 的热速度，所以我们取 $\\mathbf{v}_{A} \\approx \\mathbf{0}$。在质量条件 $m_{A} = m_{B} = m$ 下，质心速度变为：\n$$\n\\mathbf{V}_{\\mathrm{CM}} = \\frac{m(\\mathbf{0}) + m(u_{b} \\hat{\\mathbf{z}})}{m + m} = \\frac{1}{2} u_{b} \\hat{\\mathbf{z}}\n$$\n质心速度的大小为 $V_{\\mathrm{CM}} = \\frac{u_{b}}{2}$，方向沿着实验室坐标系的 $z$ 轴。\n\n产物 $P$ 在实验室坐标系中的速度 $\\mathbf{v}_{\\mathrm{lab}}$ 与其在质心坐标系中的速度 $\\mathbf{v}_{\\mathrm{CM}}$ 之间的关系由 Galilean 变换给出：\n$$\n\\mathbf{v}_{\\mathrm{lab}} = \\mathbf{V}_{\\mathrm{CM}} + \\mathbf{v}_{\\mathrm{CM}}\n$$\n这种矢量加法构成一个速度三角形，通常称为牛顿图 (Newton diagram)。$\\mathbf{v}_{\\mathrm{CM}}$ 的大小给定为常数 $v_{0}$。\n\n实验室角分布 $I(\\theta_{\\mathrm{lab}})$ 与实验室坐标系中的微分截面 $d\\sigma/d\\Omega_{\\mathrm{lab}}$ 成正比。为了得到这个结果，我们将双微分截面从质心坐标系转换到实验室坐标系。散射粒子的数量是守恒的，因此通量是不变的，这导致双微分截面 $\\sigma(\\mathbf{v}) \\equiv d^2\\sigma/d\\Omega dv$ 的变换法则：\n$$\n\\sigma_{\\mathrm{lab}}(v_{\\mathrm{lab}}, \\theta_{\\mathrm{lab}}) = \\left(\\frac{v_{\\mathrm{lab}}}{v_{\\mathrm{CM}}}\\right)^{2} \\sigma_{\\mathrm{CM}}(v_{\\mathrm{CM}}, \\theta_{\\mathrm{CM}})\n$$\n问题陈述中提到，质心散射是各向同性的，并且产物速率是精确的 $v_{0}$。我们可以将其表示为：\n$$\n\\sigma_{\\mathrm{CM}}(v_{\\mathrm{CM}}, \\theta_{\\mathrm{CM}}) = C \\cdot \\delta(v_{\\mathrm{CM}} - v_{0})\n$$\n其中 $C$ 是一个与总截面相关的常数，$\\delta$ 是 Dirac delta 函数。将此代入变换方程，我们得到实验室分布：\n$$\n\\sigma_{\\mathrm{lab}}(v_{\\mathrm{lab}}, \\theta_{\\mathrm{lab}}) = C \\left(\\frac{v_{\\mathrm{lab}}}{v_{0}}\\right)^{2} \\delta(\\sqrt{|\\mathbf{v}_{\\mathrm{lab}} - \\mathbf{V}_{\\mathrm{CM}}|^2} - v_{0})\n$$\ndelta 函数的自变量连接了实验室速率和质心速率。根据速度三角形的余弦定理，我们有 $v_{\\mathrm{CM}}^2 = v_{\\mathrm{lab}}^2 + V_{\\mathrm{CM}}^2 - 2v_{\\mathrm{lab}}V_{\\mathrm{CM}}\\cos\\theta_{\\mathrm{lab}}$。因此：\n$$\n\\sigma_{\\mathrm{lab}}(v_{\\mathrm{lab}}, \\theta_{\\mathrm{lab}}) = C \\frac{v_{\\mathrm{lab}}^2}{v_{0}^2} \\delta(\\sqrt{v_{\\mathrm{lab}}^2 + V_{\\mathrm{CM}}^2 - 2v_{\\mathrm{lab}}V_{\\mathrm{CM}}\\cos\\theta_{\\mathrm{lab}}} - v_{0})\n$$\n实验室角分布 $I(\\theta_{\\mathrm{lab}})$ 是通过对固定实验室角度 $\\theta_{\\mathrm{lab}}$ 的所有可能的实验室速率 $v_{\\mathrm{lab}}$ 积分此表达式得到的：\n$$\nI(\\theta_{\\mathrm{lab}}) \\propto \\frac{d\\sigma}{d\\Omega_{\\mathrm{lab}}} = \\int_{0}^{\\infty} \\sigma_{\\mathrm{lab}}(v_{\\mathrm{lab}}, \\theta_{\\mathrm{lab}}) \\, dv_{\\mathrm{lab}}\n$$\n为了计算这个积分，我们使用 delta 函数的性质 $\\int f(x)\\delta(g(x))dx = \\sum_{i} \\frac{f(x_{i})}{|g'(x_{i})|}$，其中 $x_{i}$ 是 $g(x)=0$ 的根。在这里，$g(v_{\\mathrm{lab}}) = \\sqrt{v_{\\mathrm{lab}}^2 + V_{\\mathrm{CM}}^2 - 2v_{\\mathrm{lab}}V_{\\mathrm{CM}}\\cos\\theta_{\\mathrm{lab}}} - v_{0}$。根 $v_{\\mathrm{lab}}^*$ 满足 $v_{\\mathrm{lab}}^2 - (2V_{\\mathrm{CM}}\\cos\\theta_{\\mathrm{lab}})v_{\\mathrm{lab}} + (V_{\\mathrm{CM}}^2 - v_{0}^2) = 0$。解是：\n$$\nv_{\\mathrm{lab}}^* = V_{\\mathrm{CM}}\\cos\\theta_{\\mathrm{lab}} \\pm \\sqrt{v_{0}^2 - V_{\\mathrm{CM}}^2\\sin^2\\theta_{\\mathrm{lab}}}\n$$\n导数是 $|g'(v_{\\mathrm{lab}}^*)| = \\frac{|v_{\\mathrm{lab}}^* - V_{\\mathrm{CM}}\\cos\\theta_{\\mathrm{lab}}|}{v_{0}} = \\frac{\\sqrt{v_{0}^2 - V_{\\mathrm{CM}}^2\\sin^2\\theta_{\\mathrm{lab}}}}{v_{0}}$。\n积分正比于：\n$$\nI(\\theta_{\\mathrm{lab}}) \\propto \\sum_{\\text{roots}} \\frac{v_{0}}{v_{0}^2} \\frac{(v_{\\mathrm{lab}}^*)^2}{\\sqrt{v_{0}^2 - V_{\\mathrm{CM}}^2\\sin^2\\theta_{\\mathrm{lab}}}} = \\frac{1}{v_{0}\\sqrt{v_{0}^2 - V_{\\mathrm{CM}}^2\\sin^2\\theta_{\\mathrm{lab}}}} \\sum_{\\text{roots}} (v_{\\mathrm{lab}}^*)^2\n$$\n对于给定的参数，$u_{b} = 2.0 \\times 10^{3}\\ \\mathrm{m\\,s^{-1}}$ 和 $v_{0} = 1.5 \\times 10^{3}\\ \\mathrm{m\\,s^{-1}}$。这给出 $V_{\\mathrm{CM}} = u_{b}/2 = 1.0 \\times 10^{3}\\ \\mathrm{m\\,s^{-1}}$。由于 $V_{\\mathrm{CM}} < v_{0}$，质心原点位于牛顿球内部。因此，对任意 $\\theta_{\\mathrm{lab}}$，对于 $v_{\\mathrm{lab}}$ 只有一个物理上有意义的（正）根：\n$$\nv_{\\mathrm{lab}}^* = V_{\\mathrm{CM}}\\cos\\theta_{\\mathrm{lab}} + \\sqrt{v_{0}^2 - V_{\\mathrm{CM}}^2\\sin^2\\theta_{\\mathrm{lab}}}\n$$\n另一个根总是负的，因此被舍弃。因此，求和中只包含一项。\n$$\nI(\\theta_{\\mathrm{lab}}) \\propto \\frac{(V_{\\mathrm{CM}}\\cos\\theta_{\\mathrm{lab}} + \\sqrt{v_{0}^2 - V_{\\mathrm{CM}}^2\\sin^2\\theta_{\\mathrm{lab}}})^2}{v_{0}\\sqrt{v_{0}^2 - V_{\\mathrm{CM}}^2\\sin^2\\theta_{\\mathrm{lab}}}}\n$$\n现在我们计算比值 $R$。\n对于 $\\theta_{\\mathrm{lab}} = 0$：\n$\\cos(0) = 1$，$\\sin(0) = 0$。\n$$\nI(0) \\propto \\frac{(V_{\\mathrm{CM}} + \\sqrt{v_{0}^2})^2}{v_{0}\\sqrt{v_{0}^2}} = \\frac{(V_{\\mathrm{CM}}+v_{0})^2}{v_{0}^2}\n$$\n对于 $\\theta_{\\mathrm{lab}} = \\pi/2$：\n$\\cos(\\pi/2) = 0$，$\\sin(\\pi/2) = 1$。\n$$\nI(\\pi/2) \\propto \\frac{(\\sqrt{v_{0}^2 - V_{\\mathrm{CM}}^2})^2}{v_{0}\\sqrt{v_{0}^2 - V_{\\mathrm{CM}}^2}} = \\frac{v_{0}^2 - V_{\\mathrm{CM}}^2}{v_{0}\\sqrt{v_{0}^2 - V_{\\mathrm{CM}}^2}} = \\frac{\\sqrt{v_{0}^2 - V_{\\mathrm{CM}}^2}}{v_{0}}\n$$\n比值 $R$ 为：\n$$\nR = \\frac{I(\\pi/2)}{I(0)} = \\frac{\\frac{\\sqrt{v_{0}^2 - V_{\\mathrm{CM}}^2}}{v_{0}}}{\\frac{(V_{\\mathrm{CM}}+v_{0})^2}{v_{0}^2}} = \\frac{v_{0}\\sqrt{v_{0}^2 - V_{\\mathrm{CM}}^2}}{(V_{\\mathrm{CM}}+v_{0})^2}\n$$\n我们代入给定值：$v_{0} = 1.5 \\times 10^{3}\\ \\mathrm{m\\,s^{-1}}$ 和 $V_{\\mathrm{CM}} = 1.0 \\times 10^{3}\\ \\mathrm{m\\,s^{-1}}$。\n$$\nR = \\frac{(1.5 \\times 10^{3}) \\sqrt{(1.5 \\times 10^{3})^2 - (1.0 \\times 10^{3})^2}}{(1.0 \\times 10^{3} + 1.5 \\times 10^{3})^2}\n$$\n$10^{3}$ 的因子可以被提出并消去：\n$$\nR = \\frac{1.5 \\sqrt{1.5^2 - 1.0^2}}{(1.0 + 1.5)^2} = \\frac{1.5 \\sqrt{2.25 - 1.0}}{2.5^2} = \\frac{1.5 \\sqrt{1.25}}{6.25}\n$$\n将小数写成分数：$1.5 = \\frac{3}{2}$，$1.25 = \\frac{5}{4}$，$6.25 = \\frac{25}{4}$。\n$$\nR = \\frac{\\frac{3}{2} \\sqrt{\\frac{5}{4}}}{\\frac{25}{4}} = \\frac{\\frac{3}{2} \\frac{\\sqrt{5}}{2}}{\\frac{25}{4}} = \\frac{\\frac{3\\sqrt{5}}{4}}{\\frac{25}{4}} = \\frac{3\\sqrt{5}}{25}\n$$\n这就是比值的最终精确解析表达式。", "answer": "$$\n\\boxed{\\frac{3\\sqrt{5}}{25}}\n$$", "id": "2626677"}, {"introduction": "反应动力学的最终目标之一是从实验数据中提取关于反应机理的详细信息。这个实践模拟了这一过程，要求您编写程序，从带有噪声的分箱角分布数据中提取微分截面的勒让德多项式展开系数 $A_{\\ell}$。这项练习不仅能加深您对散射理论中数学工具（如勒让德多项式 $P_{\\ell}(\\cos\\theta)$ 的正交性）的理解，还能培养处理和分析真实世界实验数据的关键计算技能。[@problem_id:2626680]", "problem": "给定一个轴对称反应散射场景，其中微分截面 (DCS) 仅取决于极角 $\\theta \\in [0,\\pi]$，且可展开为如下形式的 Legendre 多项式级数 $d\\sigma/d\\Omega = f(\\theta) = \\sum_{\\ell=0}^{\\ell_{\\max}} A_{\\ell} P_{\\ell}(\\cos\\theta)$。此处，$P_{\\ell}$ 表示 $\\ell$ 阶 Legendre 多项式，$A_{\\ell}$ 是表征产物角分布的实系数。可测量的量是单位立体角上的 $f(\\theta)$。数据按极角分箱收集，在每个分箱内，报告的值是在分箱中点处对 $f(\\theta)$ 的带噪声估计。\n\n基本事实：\n- Legendre 多项式满足正交关系 $\\int_{-1}^{1} P_{\\ell}(\\mu) P_{m}(\\mu)\\, d\\mu = \\frac{2}{2\\ell+1}\\delta_{\\ell m}$，其中 $\\mu = \\cos\\theta$，$\\delta_{\\ell m}$ 是 Kronecker delta 符号，且 $\\ell,m \\in \\mathbb{N}_0$。\n- 立体角微元可分离为 $d\\Omega = \\sin\\theta\\, d\\theta\\, d\\phi$。对于轴对称的 $f(\\theta)$，不存在对方位角 $\\phi$ 的依赖性，并且向 $P_{\\ell}(\\cos\\theta)$ 的投影简化为带权重 $\\sin\\theta$ 的关于 $\\theta$ 的一维积分。\n\n任务：\n- 从正交关系和级数展开定义出发，推导出一个 $A_{\\ell}$ 的投影估计器，表示为 $f(\\theta) P_{\\ell}(\\cos\\theta)$ 在 $\\theta \\in [0,\\pi]$ 上带适当权重的积分。然后，为了从带噪声的分箱数据中计算 $A_{\\ell}$，用中点法则 Riemann 和对该积分进行近似，对分箱求和：使用分箱中点角度 $\\theta_i$、分箱宽度 $\\Delta\\theta_i$、测量值 $y_i \\approx f(\\theta_i)$ 以及物理上正确的权重 $\\sin\\theta_i$。您的估计器必须对非均匀分箱宽度和均匀分箱都有效。数据中提供的所有角度都以度为单位；在进行任何三角计算之前，您必须在内部将度转换为弧度。\n- 将此估计器实现为一个程序，对于下述每个测试用例，该程序返回估计系数列表 $[A_0,A_1,\\dots,A_{\\ell_{\\max}}]$，结果为浮点数并四舍五入到六位小数。\n\n角度单位要求：\n- 所有输入角度均以度为单位指定。您的程序必须在计算前将度转换为弧度。输入中不应有任何角度被视为弧度。三角函数和任何角度积分都必须使用弧度。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含所有测试用例的结果，格式为一个由方括号括起来的逗号分隔列表，其中每个测试用例的结果本身是一个由方括号括起来的、逗号分隔的系数列表。例如，一个有效的输出看起来像 $[[a_{0}^{(1)},a_{1}^{(1)}],[a_{0}^{(2)},a_{1}^{(2)}]]$，其中每个 $a$ 都四舍五入到六位小数。\n\n测试套件：\n- 对于每个测试用例，您将获得以度为单位的分箱边界和在中点处的带噪声测量值。分箱划分了 $[0^\\circ,180^\\circ]$ 区间；分箱 $i$ 的中点是其两个边界角的平均值。相应的分箱宽度（以弧度为单位）是相邻边界之差并转换为弧度。\n\n提供一个程序，评估以下所有案例：\n\n1) 案例 #1 (均匀分箱，中等各向异性)：\n- $\\ell_{\\max} = 4$.\n- 以度为单位的分箱边界：$[\\,\\;0,\\;30,\\;60,\\;90,\\;120,\\;150,\\;180\\;\\,]$.\n- 中点测量值 $y_i$ (单位立体角上 $f(\\theta)$ 的量纲)：$[\\,\\;1.324820,\\;1.198250,\\;0.776555,\\;0.765555,\\;1.215250,\\;1.308820\\;\\,]$.\n\n2) 案例 #2 (非均匀分箱，不同尺度的各向异性)：\n- $\\ell_{\\max} = 2$.\n- 以度为单位的分箱边界：$[\\,\\;0,\\;20,\\;50,\\;80,\\;120,\\;160,\\;180\\;\\,]$.\n- 中点测量值 $y_i$：$[\\,\\;1.723569,\\;1.833045,\\;2.089627,\\;2.131431,\\;1.885929,\\;1.718569\\;\\,]$.\n\n3) 案例 #3 (均匀分箱，估计器边界情况)：\n- $\\ell_{\\max} = 0$.\n- 以度为单位的分箱边界：$[\\,\\;0,\\;45,\\;90,\\;135,\\;180\\;\\,]$.\n- 中点测量值 $y_i$：$[\\,\\;1.812132,\\;1.377868,\\;1.407868,\\;1.807132\\;\\,]$.\n\n科学真实性与单位：\n- 将 $y_i$ 视为在分箱中点处对 $f(\\theta)$ 的带噪声的评估值，无需额外的缩放因子。您实现的估计器必须通过 $\\sin\\theta$ 权重和以弧度为单位的分箱宽度来遵循正确的角度测度。除了数值系数值之外，最终答案中没有其他单位需要报告。角度必须在内部以弧度处理。\n\n答案规范：\n- 输出必须是单行文本，包含一个由方括号括起来的列表，该列表内含三个列表，每个列表是一系列浮点数，对应于上述三个案例的估计 $A_{\\ell}$ 值，按给定顺序排列，并四舍五入到六位小数。", "solution": "所述问题具有科学依据、数学上一致且定义明确。它提出了散射数据分析中的一项标准任务，即从测量的微分截面中提取角动量分量。所有必要信息均已提供。我们将着手推导和实现所需的估计器。\n\n任务是确定轴对称微分截面的 Legendre 多项式展开式中的系数 $A_{\\ell}$，其形式如下：\n$$\n\\frac{d\\sigma}{d\\Omega} = f(\\theta) = \\sum_{\\ell=0}^{\\ell_{\\max}} A_{\\ell} P_{\\ell}(\\cos\\theta)\n$$\n其中 $P_{\\ell}$ 是 $\\ell$ 阶 Legendre 多项式，$\\theta$ 是极散射角。\n\n首先，我们推导 $A_{\\ell}$ 的解析公式。这些系数的提取依赖于 Legendre 多项式的正交性，其对于变量 $\\mu \\in [-1, 1]$ 给出如下：\n$$\n\\int_{-1}^{1} P_{\\ell}(\\mu) P_{m}(\\mu)\\, d\\mu = \\frac{2}{2\\ell+1}\\delta_{\\ell m}\n$$\n其中 $\\delta_{\\ell m}$ 是 Kronecker delta 符号。\n\n为了利用这一性质，我们必须构建一个涉及 $f(\\theta)$ 的适当积分。角度域 $\\theta \\in [0, \\pi]$ 与正交性域 $\\mu \\in [-1, 1]$ 之间的联系是替换 $\\mu = \\cos\\theta$。这意味着 $d\\mu = -\\sin\\theta \\, d\\theta$。此外，问题指出，对于轴对称系统，向 $P_{\\ell}(\\cos\\theta)$ 的投影涉及一个带权重 $\\sin\\theta$ 的关于 $\\theta$ 的积分。这自然地源于立体角微元 $d\\Omega = \\sin\\theta \\, d\\theta \\, d\\phi$。\n\n让我们考虑将 $f(\\theta)$ 乘以 $P_m(\\cos\\theta)$ 和权重函数 $\\sin\\theta$ 在 $\\theta$ 的整个范围上积分：\n$$\nI_m = \\int_{0}^{\\pi} f(\\theta) P_{m}(\\cos\\theta) \\sin\\theta \\, d\\theta\n$$\n代入 $f(\\theta)$ 的展开式：\n$$\nI_m = \\int_{0}^{\\pi} \\left( \\sum_{\\ell=0}^{\\ell_{\\max}} A_{\\ell} P_{\\ell}(\\cos\\theta) \\right) P_{m}(\\cos\\theta) \\sin\\theta \\, d\\theta\n$$\n对于有限和，我们可以交换求和与积分的顺序：\n$$\nI_m = \\sum_{\\ell=0}^{\\ell_{\\max}} A_{\\ell} \\int_{0}^{\\pi} P_{\\ell}(\\cos\\theta) P_{m}(\\cos\\theta) \\sin\\theta \\, d\\theta\n$$\n我们现在进行变量替换 $\\mu = \\cos\\theta$。当 $\\theta$ 从 $0$ 变为 $\\pi$ 时，$\\mu$ 从 $1$ 变为 $-1$。微分变为 $d\\mu = -\\sin\\theta \\, d\\theta$，或者 $\\sin\\theta \\, d\\theta = -d\\mu$。\n$$\nI_m = \\sum_{\\ell=0}^{\\ell_{\\max}} A_{\\ell} \\int_{1}^{-1} P_{\\ell}(\\mu) P_{m}(\\mu) (-d\\mu) = \\sum_{\\ell=0}^{\\ell_{\\max}} A_{\\ell} \\int_{-1}^{1} P_{\\ell}(\\mu) P_{m}(\\mu) \\, d\\mu\n$$\n应用正交关系：\n$$\nI_m = \\sum_{\\ell=0}^{\\ell_{\\max}} A_{\\ell} \\left( \\frac{2}{2\\ell+1}\\delta_{\\ell m} \\right)\n$$\nKronecker delta 确保了求和中唯一的非零项是 $\\ell = m$ 的那一项。因此，求和简化为：\n$$\nI_m = A_m \\left( \\frac{2}{2m+1} \\right)\n$$\n通过令 $I_m$ 的两个表达式相等并求解 $A_m$（或为了保持一致性将下标重命名为 $\\ell$）：\n$$\nA_{\\ell} = \\frac{2\\ell+1}{2} \\int_{0}^{\\pi} f(\\theta) P_{\\ell}(\\cos\\theta) \\sin\\theta \\, d\\theta\n$$\n这就是系数 $A_{\\ell}$ 的精确解析表达式。\n\n接下来，我们必须使用所提供的分箱数据来近似这个积分。数据由在角分箱中点 $\\theta_i$ 处对函数 $f(\\theta)$ 的测量值 $y_i$ 组成。问题指定了使用中点法则 Riemann 和。在 $[0, \\pi]$ 上的积分被划分为在每个分箱 $[\\theta_{edge, i-1}, \\theta_{edge, i}]$ 上的积分之和。\n$$\n\\int_{0}^{\\pi} g(\\theta) \\, d\\theta = \\sum_{i=1}^{N} \\int_{\\theta_{edge, i-1}}^{\\theta_{edge, i}} g(\\theta) \\, d\\theta\n$$\n其中 $g(\\theta) = f(\\theta) P_{\\ell}(\\cos\\theta) \\sin\\theta$，$N$ 是分箱数。使用中点法则，单个分箱上的积分近似为：\n$$\n\\int_{\\theta_{edge, i-1}}^{\\theta_{edge, i}} g(\\theta) \\, d\\theta \\approx g(\\theta_i) \\Delta\\theta_i\n$$\n其中中点是 $\\theta_i = (\\theta_{edge, i-1} + \\theta_{edge, i}) / 2$，分箱宽度是 $\\Delta\\theta_i = \\theta_{edge, i} - \\theta_{edge, i-1}$。函数 $f(\\theta_i)$ 由其测量值 $y_i$ 近似。\n\n一个关键细节是，所有角度在进行三角计算和计算分箱宽度 $\\Delta\\theta_i$ 时都必须是弧度。输入的分箱边界以度为单位，需要转换。\n\n结合这些元素，该积分近似为：\n$$\n\\int_{0}^{\\pi} f(\\theta) P_{\\ell}(\\cos\\theta) \\sin\\theta \\, d\\theta \\approx \\sum_{i=1}^{N} y_i P_{\\ell}(\\cos\\theta_i) \\sin(\\theta_i) \\Delta\\theta_i\n$$\n将此和代入我们的解析公式，得到 $A_{\\ell}$ 的最终数值估计器：\n$$\nA_{\\ell} \\approx \\frac{2\\ell+1}{2} \\sum_{i=1}^{N} y_i P_{\\ell}(\\cos\\theta_i) \\sin(\\theta_i) \\Delta\\theta_i\n$$\n该估计器正确地包含了非均匀分箱宽度 $\\Delta\\theta_i$ 和来自积分测度的必要权重 $\\sin\\theta_i$。该实现将为每个测试用例，对从 $0$ 到 $\\ell_{\\max}$ 的每个所需 $\\ell$ 值计算此和。", "answer": "[[1.000000,-0.100000,0.500000,0.050000,0.199999],[2.000000,0.250000,-0.500001],[1.500000]]", "id": "2626680"}]}