{"hands_on_practices": [{"introduction": "我们对聚合物凝胶的探索始于其形成过程。Flory-Stockmayer理论为我们理解单体如何通过化学键合形成无限大的网络结构提供了统计力学基础。本练习将引导您计算凝胶化的临界点，即发生凝胶化的最小反应程度$p_c$，这是从液体单体溶液到固体状凝胶转变的关键阈值 [@problem_id:2924764]。通过这个计算，您将亲身体验聚合反应的统计本质以及官能度$f$对网络形成的关键作用。", "problem": "一个逐步增长聚合物网络由单一类型的相同三官能支化剂形成，每种支化剂携带三个等效的反应基团。反应在任意一对未反应的基团之间以相等概率随机发生，分子内环化可忽略不计，且团簇是局部树状的。设 $f$ 表示支化剂的官能度，$p$ 表示反应程度（已形成化学键的反应基团所占的比例）。在 Flory–Stockmayer 凝胶理论的理想假设下，确定一个官能度 $f=3$ 的三官能体系开始发生凝胶化时的临界反应程度 $p_{c}$。仅报告 $p_{c}$ 的数值，该值等于初始凝胶点的转化率，并四舍五入至 $4$ 位有效数字。请将最终结果表示为一个无量纲的数。", "solution": "本题要求基于 Flory-Stockmayer 理论，确定一个由三官能单体组成的体系中发生凝胶化时的临界反应程度 $p_c$。该理论假设，凝胶化，即形成一个有效无限大的网络分子，发生在聚合物分布的重均分子量趋于无穷大时。这一事件可以通过考虑聚合体系内的支化过程来分析。\n\n其先验假设是所有官能团的反应活性均等，且所有反应均为分子间反应，这意味着分子内环化可以忽略不计。这使得聚合物团簇可以被视为树状结构，这是该模型的一个关键原则。\n\n让我们考虑聚合物团簇中的一个单体单元。该单体的官能度为 $f$。我们希望找到一个条件，使得从该单体延伸出的化学键路径具有非零的无限长概率。我们选择一个已属于某个较大分子的单体，并沿着其一个已反应的官能团追溯一条路径。这条键连接到另一个单体单元。网络形成的问题可以简化为确定从这第二个单体分支出去的新路径的期望数量。\n\n这第二个单体总共有 $f$ 个官能团。其中一个官能团是我们沿着路径到达它时所通过的化学键的一部分。因此，还剩下 $f-1$ 个官能团可用于进一步支化。反应程度 $p$ 定义为所有官能团中已发生反应的比例。因此，$p$ 也是任意随机选择一个官能团，该官能团已形成化学键的概率。\n\n从这第二个单体发出的新支链的期望数量，是其其他可用基团的数量 $f-1$ 乘以每个基团已反应的概率 $p$。这个量就是支化因子，我们可将其表示为 $\\sigma$。\n$$ \\sigma = (f-1)p $$\n为了使聚合物网络无限增长，每个已反应的单体平均必须引出至少另一条已反应的路径。如果 $\\sigma  1$，任何给定的支链都很可能终止，只形成有限大小的低聚物。如果 $\\sigma  1$，支链数量会激增，从而形成一个贯穿整个体系的无限网络。凝胶化开始的临界点，即凝胶点，恰好发生在该支化因子等于 $1$ 时。\n$$ \\sigma_c = (f-1)p_c = 1 $$\n此处，$p_c$ 是凝胶点时的临界反应程度。\n\n通过重新整理这个方程，我们可以用单体官能度 $f$ 来求解 $p_c$。\n$$ p_c = \\frac{1}{f-1} $$\n这就是著名的 Flory-Stockmayer 凝胶化条件，适用于单一类型 $f$-官能单体的聚合。\n\n题目指定了一个由三官能支化剂组成的体系，其官能度 $f$ 为 $3$。\n$$ f = 3 $$\n将此值代入 $p_c$ 的表达式中：\n$$ p_c = \\frac{1}{3-1} = \\frac{1}{2} $$\n题目要求提供一个四舍五入到 $4$ 位有效数字的数值。\n$$ p_c = 0.5000 $$\n这个结果是由 Flory 和 Stockmayer 阐述的凝胶化统计理论的直接且基本推论。", "answer": "$$\n\\boxed{0.5000}\n$$", "id": "2924764"}, {"introduction": "一旦凝胶网络形成，其力学性质便成为关注的焦点。橡胶弹性理论从统计力学出发，解释了凝胶和弹性体的宏观力学行为。本练习将指导您推导网络的剪切模量$G$，并比较经典的仿射网络模型与更真实的“幻影”网络模型 [@problem_id:2924782]。这个实践将帮助您建立起从分子参数（如链密度$\\nu$和交联点官能度$f$）到宏观力学响应之间的直接联系。", "problem": "一个在温度 $T=298$ K 下的轻度交联聚合物网络，包含数密度为 $\\nu = 200$ mol m$^{-3}$ 的弹性活性链，平均交联点官能度为 $f=4$。将网络链视为理想高斯链，并假设等温小应变剪切形变。以统计热力学为出发点，完成以下任务：\n\n- 从单根高斯链的熵弹性出发，并基于网络自由能是所有链自由能之和的观点，推导仿射网络在小应变下的剪切模量，用 $\\nu$、玻尔兹曼常数 $k_{B}$ 和 $T$ 表示。\n- 解释交联点的热涨落（幻象网络）如何减少独立约束的数量，并推导剪切模量的乘法折减因子（用 $f$ 表示）。\n- 结合这些结果，求出在给定 $\\nu$、$f$ 和 $T$ 条件下幻象网络的剪切模量，注意一致地使用适当的分子常数或摩尔常数。您可以使用关系式 $R = N_{A} k_{B}$，其中 $R$ 是通用气体常数，$N_{A}$ 是阿伏伽德罗常数。\n\n将幻象网络剪切模量的最终数值以千帕（kPa）为单位表示，并将您的答案四舍五入到三位有效数字。", "solution": "该问题陈述具有科学依据、提法明确，并包含足够的信息以获得唯一解。它描述了聚合物网络物理学中的一个标准问题。我们将进行推导和计算。\n\n该问题需要分三部分进行分析：首先，推导仿射网络的剪切模量；其次，引入对幻象网络的修正；第三，计算在幻象网络模型下剪切模量的最终数值。\n\n**第一部分：仿射网络的剪切模量**\n\n橡胶弹性的基础是将统计热力学应用于柔性聚合物链网络。对于单根理想高斯链，其末端距矢量 $\\vec{r}$ 的概率分布是高斯分布。其相对于参考态的熵 $S$ 由下式给出：\n$$S(\\vec{r}) = C - \\frac{3 k_B |\\vec{r}|^2}{2 \\langle r_0^2 \\rangle_{eq}}$$\n其中 $k_B$ 是玻尔兹曼常数，$\\langle r_0^2 \\rangle_{eq}$ 是链在未形变状态下的均方末端距。对于等温过程，亥姆霍兹自由能的变化 $A = U - TS$ 主要由熵的贡献决定，因为理想链的内能 $U$ 不随构象变化。因此，单根链的弹性自由能变化为：\n$$\\Delta A_{chain} = -T \\Delta S = \\frac{3 k_B T}{2 \\langle r_0^2 \\rangle_{eq}} (|\\vec{r}|^2 - |\\vec{r}_0|^2)$$\n\n仿射网络模型假定，网络的交联点与宏观物体的形变方式相同。如果宏观形变由形变梯度张量 $\\mathbf{\\Lambda}$ 描述，则链的末端距矢量从 $\\vec{r}_0$ 变换为 $\\vec{r} = \\mathbf{\\Lambda} \\cdot \\vec{r}_0$。我们考虑主拉伸比 $\\lambda_x, \\lambda_y, \\lambda_z$。\n\n网络的总弹性自由能密度 $W$ 是单位体积内所有弹性活性链的自由能变化之和。设 $\\nu_{strands}$ 是这些链的数密度。\n$$W = \\nu_{strands} \\langle \\Delta A_{chain} \\rangle = \\nu_{strands} \\left\\langle \\frac{3 k_B T}{2 \\langle r_0^2 \\rangle_{eq}} (|\\mathbf{\\Lambda} \\cdot \\vec{r}_0|^2 - |\\vec{r}_0|^2) \\right\\rangle$$\n该平均是针对初始矢量 $\\vec{r}_0$ 的各向同性分布进行的。对于各向同性分布，$\\langle x_0^2 \\rangle = \\langle y_0^2 \\rangle = \\langle z_0^2 \\rangle = \\frac{1}{3} \\langle r_0^2 \\rangle_{eq}$。对 $|\\mathbf{\\Lambda} \\cdot \\vec{r}_0|^2 = \\lambda_x^2 x_0^2 + \\lambda_y^2 y_0^2 + \\lambda_z^2 z_0^2$ 进行平均得到：\n$$\\langle |\\mathbf{\\Lambda} \\cdot \\vec{r}_0|^2 \\rangle = \\frac{1}{3} \\langle r_0^2 \\rangle_{eq} (\\lambda_x^2 + \\lambda_y^2 + \\lambda_z^2)$$\n将此代入 $W$ 的表达式中：\n$$W = \\nu_{strands} \\frac{3 k_B T}{2 \\langle r_0^2 \\rangle_{eq}} \\left( \\frac{1}{3} \\langle r_0^2 \\rangle_{eq} (\\lambda_x^2 + \\lambda_y^2 + \\lambda_z^2) - \\langle r_0^2 \\rangle_{eq} \\right)$$\n$$W = \\frac{1}{2} \\nu_{strands} k_B T (\\lambda_x^2 + \\lambda_y^2 + \\lambda_z^2 - 3)$$\n对于不可压缩材料，$\\det(\\mathbf{\\Lambda}) = \\lambda_x \\lambda_y \\lambda_z = 1$。项 $(\\lambda_x^2 + \\lambda_y^2 + \\lambda_z^2)$ 是左 Cauchy-Green 应变张量的第一不变量 $I_1$。所以，$W = \\frac{1}{2} \\nu_{strands} k_B T (I_1 - 3)$。\n\n剪切模量 $G$ 由简单剪切中的应力-应变关系确定。对于不可压缩的 neo-Hookean 材料，其 Cauchy 应力张量 $\\sigma$ 为 $\\sigma = -p\\mathbf{I} + 2 \\frac{dW}{dI_1} \\mathbf{B}$，其中 $\\mathbf{B}=\\mathbf{\\Lambda}\\mathbf{\\Lambda}^T$ 是左 Cauchy-Green 张量，$p$ 是一个任意压力。从我们得到的 $W$ 的表达式中，我们确定 $2 \\frac{dW}{dI_1} = \\nu_{strands} k_B T$。\n对于剪切量为 $\\gamma$ 的简单剪切，剪切应力分量为 $\\sigma_{xy} = G\\gamma$。理论上，$\\sigma_{xy} = (\\nu_{strands} k_B T) B_{xy}$。对于简单剪切，$B_{xy} = \\gamma$，所以 $\\sigma_{xy} = \\nu_{strands} k_B T \\gamma$。\n比较 $\\sigma_{xy}$ 的两个表达式，我们得到仿射网络的剪切模量：\n$$G_{affine} = \\nu_{strands} k_B T$$\n题目提供了链的摩尔密度 $\\nu$，单位为 mol m$^{-3}$。我们使用阿伏伽德罗常数 $N_A$ 从分子数密度 $\\nu_{strands}$ 进行转换：$\\nu_{strands} = \\nu N_A$。使用给定的关系式 $R=N_A k_B$：\n$$G_{affine} = (\\nu N_A) k_B T = \\nu (N_A k_B) T = \\nu R T$$\n\n**第二部分：幻象网络修正**\n\n仿射网络模型是一个过于简化的模型。它假设交联点固定在它们的仿射位置，忽略了它们的热运动。幻象网络模型允许交联点在其平均位置附近涨落，仅受连接到每个交联点的 $f$ 条链的约束。交联点重排的这种额外自由度减少了在给定宏观形变下储存的弹性势能，从而降低了剪切模量。\n\n幻象网络理论的核心结果是，弹性自由能与单位体积内网络的环阶数（或独立回路数） $\\xi$ 成正比。环阶数是将网络简化为无闭环结构所需的切割次数。它由 $\\xi = \\nu_{strands} - \\mu_{junct}$ 给出，其中 $\\mu_{junct}$ 是交联点的数密度。\n\n交联点的数量 $\\mu_{junct}$ 与链的数量 $\\nu_{strands}$ 和平均交联点官能度 $f$ 相关。每条链连接两个交联点，每个交联点是 $f$ 条链的交汇点。通过计算链端，我们得到 $2\\nu_{strands} = f\\mu_{junct}$，这给出 $\\mu_{junct} = \\frac{2}{f}\\nu_{strands}$。\n\n因此，幻象网络的剪切模量为：\n$$G_{phantom} = \\xi k_B T = (\\nu_{strands} - \\mu_{junct}) k_B T$$\n代入 $\\mu_{junct}$ 的表达式：\n$$G_{phantom} = \\left(\\nu_{strands} - \\frac{2}{f}\\nu_{strands}\\right) k_B T = \\nu_{strands} k_B T \\left(1 - \\frac{2}{f}\\right)$$\n作为幻象模量与仿射模量之比的乘法折减因子为：\n$$\\frac{G_{phantom}}{G_{affine}} = \\frac{\\nu_{strands} k_B T (1 - 2/f)}{\\nu_{strands} k_B T} = 1 - \\frac{2}{f}$$\n\n**第三部分：数值计算**\n\n我们现在使用所提供的数据计算幻象网络的剪切模量。控制方程为：\n$$G_{phantom} = \\nu R T \\left(1 - \\frac{2}{f}\\right)$$\n给定值为：\n-   $\\nu = 200$ mol m$^{-3}$\n-   $f = 4$\n-   $T = 298$ K\n-   通用气体常数 $R \\approx 8.314$ J mol$^{-1}$ K$^{-1}$\n\n首先，我们计算折减因子：\n$$1 - \\frac{2}{f} = 1 - \\frac{2}{4} = 1 - 0.5 = 0.5$$\n现在，将所有值代入 $G_{phantom}$ 的方程中：\n$$G_{phantom} = (200 \\text{ mol m}^{-3}) \\times (8.314 \\text{ J mol}^{-1} \\text{ K}^{-1}) \\times (298 \\text{ K}) \\times (0.5)$$\n$$G_{phantom} = 100 \\times 8.314 \\times 298 \\text{ J m}^{-3}$$\n$$G_{phantom} = 247757.2 \\text{ J m}^{-3}$$\n由于 $1$ J m$^{-3} = 1$ N m m$^{-3} = 1$ N m$^{-2} = 1$ Pa，我们有：\n$$G_{phantom} = 247757.2 \\text{ Pa}$$\n题目要求答案以千帕（kPa）为单位，所以我们进行转换：\n$$G_{phantom} = 247.7572 \\text{ kPa}$$\n四舍五入到三位有效数字，我们得到：\n$$G_{phantom} \\approx 248 \\text{ kPa}$$", "answer": "$$\\boxed{248}$$", "id": "2924782"}, {"introduction": "在实际研究中，我们常常需要从宏观测量反推微观网络结构。这个高级计算练习将向您展示一种强大的现代方法——贝叶斯联合推断——来整合力学测试和溶胀平衡这两种不同实验的数据 [@problem_id:2924693]。通过这种方法，您不仅可以得到对网络链密度$\\nu$的更稳健的估计，还能对其不确定性进行量化，这对于严谨的科学研究至关重要。", "problem": "您的任务是构建并实现一个贝叶斯联合推断，用于交联聚合物凝胶的单位聚合物（干）体积的弹性活性链密度，该密度以 $\\nu$ 表示，单位为 $\\mathrm{mol}\\,\\mathrm{m}^{-3}$。此过程需同时使用小应变力学测量和平衡溶胀数据。该推断必须基于以下经过充分检验的基础理论。\n\n1. 用于小应变剪切模量的幻象网络校正橡胶弹性理论：线性剪切模量 $G$（单位为 Pa）满足\n$$\nG \\;=\\; \\nu\\, R\\, T \\left(1 - \\frac{2}{f}\\right),\n$$\n其中，$R$ 是普适气体常数，单位为 $\\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$，$T$ 是绝对温度，单位为 $\\mathrm{K}$，而 $f$ 是交联点官能度（在同一交联点汇集的链的平均数量，满足 $f \\ge 3$）。此关系式通过因子 $\\left(1 - \\frac{2}{f}\\right)$ 引入了幻象网络校正。\n\n2. 在固定温度 $T$ 下，用于各向同性溶胀的 Flory–Rehner 平衡条件。该条件由凝胶和浴液中溶剂化学势相等（忽略外部应力）推导而来，它平衡了混合贡献与弹性贡献对渗透压的作用：\n$$\n\\ln(1-\\phi) + \\phi + \\chi\\,\\phi^{2} \\;+\\; \\nu \\left(1 - \\frac{2}{f}\\right) V_{1} \\left(\\phi^{1/3} - \\frac{\\phi}{2}\\right) \\;=\\; 0.\n$$\n在此，$\\phi$ 是溶胀凝胶中聚合物的体积分数（无量纲），$\\chi$ 是 Flory–Huggins 聚合物-溶剂相互作用参数（无量纲），$V_{1}$ 是溶剂的摩尔体积，单位为 $\\mathrm{m}^{3}\\,\\mathrm{mol}^{-1}$，而 $\\nu$ 与模量关系式中的摩尔活性链密度相同。上述形式假设聚合物和溶剂不可压缩，弹性是各向同性的高斯弹性并包含幻象网络校正，且使用聚合物干体积作为 $\\nu$ 的参考体积。\n\n测量模型和统计推断规范：\n\n- 对于每种凝胶，您会获得两个实验测量量：\n  - 一个小应变剪切模量测量值 $G_{\\mathrm{obs}}$（单位为 Pa），其已知标准差为 $\\sigma_{G}$（单位为 Pa）。\n  - 一个平衡聚合物体积分数测量值 $\\phi_{\\mathrm{obs}}$（无量纲），其已知标准差为 $\\sigma_{\\phi}$（无量纲）。\n- 假设独立高斯噪声：\n  - $G_{\\mathrm{obs}} \\sim \\mathcal{N}\\!\\left(G(\\nu),\\, \\sigma_{G}^{2}\\right)$，其中 $G(\\nu) = \\nu R T \\left(1 - \\frac{2}{f}\\right)$。\n  - $\\phi_{\\mathrm{obs}} \\sim \\mathcal{N}\\!\\left(\\phi^{\\ast}(\\nu),\\, \\sigma_{\\phi}^{2}\\right)$，其中 $\\phi^{\\ast}(\\nu)$ 是在给定参数下，上述 Flory–Rehner 方程在区间 $(0,1)$ 内的解。\n- 为 $\\nu$ 使用均匀先验，其在区间 $[0,\\nu_{\\max}]$（其中 $\\nu_{\\max} = 1000\\,\\mathrm{mol}\\,\\mathrm{m}^{-3}$）上为常数，在区间外为零。\n- 在一个包含 $N_{\\nu} = 4001$ 个点且覆盖 $[0,\\nu_{\\max}]$ 的均匀 $\\nu$ 值网格上，计算后验密度 $p(\\nu \\mid G_{\\mathrm{obs}}, \\phi_{\\mathrm{obs}})$（归一化前）。对每个网格点，通过在指定参数下数值求解 Flory–Rehner 方程（对于 $\\phi \\in (0,1)$）来评估 $\\phi^{\\ast}(\\nu)$。\n- 使用网格上的数值积分（可使用任何标准精确求积法，如梯形法则）对后验进行归一化。从归一化后的后验分布中，计算：\n  - 后验均值 $\\mathbb{E}[\\nu \\mid \\text{data}]$，单位为 $\\mathrm{mol}\\,\\mathrm{m}^{-3}$。\n  - 后验标准差 $\\sqrt{\\mathbb{V}[\\nu \\mid \\text{data}]}$，单位为 $\\mathrm{mol}\\,\\mathrm{m}^{-3}$。\n  - 最大后验 (MAP) 估计 $\\nu_{\\mathrm{MAP}}$，单位为 $\\mathrm{mol}\\,\\mathrm{m}^{-3}$（后验密度最高处的网格位置；若有并列，则取最小的 $\\nu$）。\n\n数值常数与约束：\n\n- 使用 $R = 8.314462618\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$。\n- 本问题中不涉及角度。\n- 所有报告的 $\\nu$ 值必须以 $\\mathrm{mol}\\,\\mathrm{m}^{-3}$ 为单位。\n- 为求解 $\\phi^{\\ast}(\\nu)$，在 $\\phi \\in [10^{-9},\\, 0.999]$ 范围内搜索，并通过为唯一根划定区间来确保求根的稳健性。\n\n测试集：\n\n在以下四个案例上评估您的程序。每个案例是一个元组 $(T, f, \\chi, V_{1}, G_{\\mathrm{obs}}, \\sigma_{G}, \\phi_{\\mathrm{obs}}, \\sigma_{\\phi})$：\n\n- 案例 1：$(298.0,\\, 4.0,\\, 0.47,\\, 18\\times 10^{-6},\\, 247800.0,\\, 10000.0,\\, 0.101,\\, 0.010)$。\n- 案例 2：$(298.0,\\, 6.0,\\, 0.50,\\, 18\\times 10^{-6},\\, 148700.0,\\, 100000.0,\\, 0.096,\\, 0.005)$。\n- 案例 3：$(298.0,\\, 3.0,\\, 0.45,\\, 18\\times 10^{-6},\\, 124000.0,\\, 5000.0,\\, 0.080,\\, 0.050)$。\n- 案例 4：$(298.0,\\, 4.0,\\, 0.60,\\, 18\\times 10^{-6},\\, 62000.0,\\, 3000.0,\\, 0.250,\\, 0.010)$。\n\n要求输出：\n\n- 对于每个案例，计算 $\\nu$ 的后验均值、后验标准差和 MAP 估计，单位为 $\\mathrm{mol}\\,\\mathrm{m}^{-3}$。\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。结果按案例和统计量排序，格式如下：\n  $[\\text{mean}_{1},\\text{std}_{1},\\text{map}_{1},\\text{mean}_{2},\\text{std}_{2},\\text{map}_{2},\\text{mean}_{3},\\text{std}_{3},\\text{map}_{3},\\text{mean}_{4},\\text{std}_{4},\\text{map}_{4}]$,\n  其中每个数字都四舍五入到恰好 $3$ 位小数，并且单位为 $\\mathrm{mol}\\,\\mathrm{m}^{-3}$。", "solution": "该问题有效。它在计算聚合物物理学领域是一个定义明确、科学上合理且数值上可解的问题。它基于已确立的橡胶弹性和聚合物溶液理论原理，并采用标准的贝叶斯统计框架进行数据融合。所有参数、常数和实验值在物理上都是真实且一致的。该问题是自洽的，并为其求解提供了明确的指令集。\n\n目标是通过结合两个独立的实验测量信息（小应变剪切模量 $G_{\\mathrm{obs}}$ 和平衡聚合物体积分数 $\\phi_{\\mathrm{obs}}$）来计算交联聚合物凝胶的弹性活性链密度 $\\nu$ 的后验概率分布。从该后验分布中，我们将计算后验均值 $\\mathbb{E}[\\nu \\mid \\text{data}]$、后验标准差 $\\sqrt{\\mathbb{V}[\\nu \\mid \\text{data}]}$ 以及最大后验 (MAP) 估计 $\\nu_{\\mathrm{MAP}}$。\n\n解决方案是在贝叶斯推断的框架内构建的。根据贝叶斯定理，在给定观测数据 ($G_{\\mathrm{obs}}, \\phi_{\\mathrm{obs}}$) 的条件下，参数 $\\nu$ 的后验概率与给定该参数时观测到数据的似然以及该参数本身的先验概率的乘积成正比：\n$$\np(\\nu \\mid G_{\\mathrm{obs}}, \\phi_{\\mathrm{obs}}) \\propto p(G_{\\mathrm{obs}}, \\phi_{\\mathrm{obs}} \\mid \\nu) \\, p(\\nu)\n$$\n鉴于模量和溶胀的测量在统计上是独立的，联合似然函数 $p(G_{\\mathrm{obs}}, \\phi_{\\mathrm{obs}} \\mid \\nu)$ 是各个似然函数的乘积：\n$$\np(G_{\\mathrm{obs}}, \\phi_{\\mathrm{obs}} \\mid \\nu) = p(G_{\\mathrm{obs}} \\mid \\nu) \\, p(\\phi_{\\mathrm{obs}} \\mid \\nu)\n$$\n问题为每个测量指定了高斯噪声模型。\n剪切模量测量值 $G_{\\mathrm{obs}}$ 的似然由一个以理论值 $G(\\nu)$ 为中心的正态分布给出：\n$$\np(G_{\\mathrm{obs}} \\mid \\nu) = \\frac{1}{\\sqrt{2\\pi}\\sigma_{G}} \\exp\\left( -\\frac{(G_{\\mathrm{obs}} - G(\\nu))^2}{2\\sigma_{G}^2} \\right)\n$$\n其中，基于橡胶弹性的幻象网络理论的剪切模量模型为\n$$\nG(\\nu) = \\nu\\, R\\, T \\left(1 - \\frac{2}{f}\\right).\n$$\n在此，$R$ 是普适气体常数，$T$ 是绝对温度，$f$ 是网络交联点官能度。\n\n聚合物体积分数测量值 $\\phi_{\\mathrm{obs}}$ 的似然同样由一个以理论平衡值 $\\phi^{\\ast}(\\nu)$ 为中心的正态分布给出：\n$$\np(\\phi_{\\mathrm{obs}} \\mid \\nu) = \\frac{1}{\\sqrt{2\\pi}\\sigma_{\\phi}} \\exp\\left( -\\frac{(\\phi_{\\mathrm{obs}} - \\phi^{\\ast}(\\nu))^2}{2\\sigma_{\\phi}^2} \\right)\n$$\n值 $\\phi^{\\ast}(\\nu)$ 是 Flory–Rehner 方程在区间 $(0,1)$ 内的唯一根，该方程平衡了聚合物-溶剂混合产生的渗透压和网络产生的弹性恢复压力：\n$$\n\\ln(1-\\phi) + \\phi + \\chi\\,\\phi^{2} + \\nu \\left(1 - \\frac{2}{f}\\right) V_{1} \\left(\\phi^{1/3} - \\frac{\\phi}{2}\\right) = 0\n$$\n其中 $\\chi$ 是 Flory-Huggins 相互作用参数，$V_{1}$ 是溶剂的摩尔体积。对于任何给定的 $\\nu$ 值，必须对此超越方程进行数值求解以得到 $\\phi^{\\ast}(\\nu)$。\n\n问题为 $\\nu$ 在一个物理上合理的范围 $[0, \\nu_{\\max}]$（其中 $\\nu_{\\max} = 1000\\,\\mathrm{mol}\\,\\mathrm{m}^{-3}$）内指定了均匀先验分布。这反映了在此范围内对 $\\nu$ 缺乏先验知识。\n$$\np(\\nu) =\n\\begin{cases}\n1/\\nu_{\\max}  \\text{if } 0 \\le \\nu \\le \\nu_{\\max} \\\\\n0  \\text{otherwise}\n\\end{cases}\n$$\n结合这些元素，未归一化的后验分布与似然的乘积成正比。为了数值稳定性，处理对数后验更有利。对数后验（不计加法常数）是对数似然之和：\n$$\n\\ln p(\\nu \\mid \\text{data}) = -\\frac{1}{2}\\left( \\frac{(G_{\\mathrm{obs}} - G(\\nu))^2}{\\sigma_{G}^2} + \\frac{(\\phi_{\\mathrm{obs}} - \\phi^{\\ast}(\\nu))^2}{\\sigma_{\\phi}^2} \\right) + \\text{constant}\n$$\n计算过程涉及在一个从 $0$ 到 $\\nu_{\\max}$ 的包含 $N_{\\nu} = 4001$ 个点的均匀网格上对参数 $\\nu$ 进行离散化。对于每个网格点 $\\nu_i$：\n1.  计算理论模量 $G(\\nu_i)$。\n2.  数值求解 Flory–Rehner 方程以找到 $\\phi^{\\ast}(\\nu_i)$。像 Brent 方法这样稳健的求根算法适用于此任务，并应用于指定的搜索区间 $\\phi \\in [10^{-9}, 0.999]$。在 $\\nu=0$ 时出现一个特殊情况：如果 $\\chi \\le 0.5$，聚合物处于良溶剂或 θ 溶剂中，会完全溶解，因此 $\\phi^{\\ast}(0)=0$。如果 $\\chi  0.5$（不良溶剂），可能会发生相分离，此时需求解 Flory-Huggins 方程（即 Flory-Rehner 方程中 $\\nu=0$ 的情况）以获得一个非零的 $\\phi$。\n3.  使用上述公式计算在 $\\nu_i$ 处的对数后验。\n\n在网格上计算出对数后验值后，我们对其进行指数运算以获得未归一化的后验概率密度。为防止数值下溢，在进行指数运算前，将对数后验通过减去其最大值来进行平移。然后，通过除以其积分（该积分使用梯形法则在 $\\nu_i$ 网格上进行数值计算）来对得到的未归一化后验数组进行归一化。\n\n设在网格点 $\\nu_i$ 处的归一化后验概率密度为 $p_i$。接着，按如下方式计算所需的后验统计量：\n- 后验均值：$\\mathbb{E}[\\nu \\mid \\text{data}] = \\int_{0}^{\\nu_{\\max}} \\nu \\, p(\\nu) \\, d\\nu \\approx \\sum_i \\nu_i \\, p_i \\, \\Delta\\nu$。这也通过梯形法则计算。\n- 后验方差：$\\mathbb{V}[\\nu \\mid \\text{data}] = \\mathbb{E}[\\nu^2] - (\\mathbb{E}[\\nu])^2$。二阶矩 $\\mathbb{E}[\\nu^2]$ 的计算方式与均值类似：$\\mathbb{E}[\\nu^2] = \\int_{0}^{\\nu_{\\max}} \\nu^2 \\, p(\\nu) \\, d\\nu \\approx \\sum_i \\nu_i^2 \\, p_i \\, \\Delta\\nu$。标准差是方差的平方根。\n- MAP 估计：$\\nu_{\\mathrm{MAP}}$ 是对应于后验密度 $p_i$ 最大值的 $\\nu_i$ 值。\n\n这种结构化的方法系统地将物理理论与统计推断相结合，从而为关键网络参数 $\\nu$ 得出一个稳健的估计，并附带其不确定性量化。", "answer": "```python\nimport numpy as np\nfrom scipy.optimize import brentq\n\ndef solve():\n    \"\"\"\n    Performs a Bayesian joint inference for the elastically active chain density (nu)\n    of crosslinked polymer gels using shear modulus and equilibrium swelling data.\n    \"\"\"\n    # Define constants\n    R = 8.314462618  # Universal gas constant in J mol^-1 K^-1\n    NU_MAX = 1000.0  # mol m^-3\n    N_NU = 4001     # Number of grid points for nu\n\n    # Define the test cases from the problem statement\n    test_cases = [\n        # (T, f, chi, V1, G_obs, sigma_G, phi_obs, sigma_phi)\n        (298.0, 4.0, 0.47, 18e-6, 247800.0, 10000.0, 0.101, 0.010),\n        (298.0, 6.0, 0.50, 18e-6, 148700.0, 100000.0, 0.096, 0.005),\n        (298.0, 3.0, 0.45, 18e-6, 124000.0, 5000.0, 0.080, 0.050),\n        (298.0, 4.0, 0.60, 18e-6, 62000.0, 3000.0, 0.250, 0.010),\n    ]\n\n    results = []\n    nu_grid = np.linspace(0, NU_MAX, N_NU)\n\n    for case in test_cases:\n        T, f, chi, V1, G_obs, sigma_G, phi_obs, sigma_phi = case\n\n        # --- Step 1: Pre-compute phi*(nu) for each nu on the grid ---\n        phi_star_values = np.zeros_like(nu_grid)\n\n        # Loop over nu grid to solve Flory-Rehner equation for phi_star\n        for i, nu in enumerate(nu_grid):\n            # Special handling for nu = 0\n            if nu == 0:\n                if chi = 0.5:\n                    phi_star_values[i] = 0.0\n                else: # Poor solvent case (chi  0.5), solve Flory-Huggins\n                    def fr_nu0(phi):\n                        # Equation: ln(1-phi) + phi + chi*phi^2 = 0\n                        if phi = 0 or phi = 1: return np.inf\n                        return np.log(1.0 - phi) + phi + chi * phi**2\n                    try:\n                        phi_star_values[i] = brentq(fr_nu0, 1e-9, 0.999)\n                    except ValueError:\n                        phi_star_values[i] = 0.0 # Fallback\n                continue\n\n            # Case for nu  0\n            C = nu * (1.0 - 2.0 / f) * V1\n            def fr_equation(phi):\n                if phi = 0 or phi = 1: return np.inf\n                mixing_term = np.log(1.0 - phi) + phi + chi * phi**2\n                elastic_term = C * (phi**(1.0/3.0) - phi / 2.0)\n                return mixing_term + elastic_term\n            \n            try:\n                # Based on analysis, a root is guaranteed in this interval for nu  0\n                phi_star_values[i] = brentq(fr_equation, 1e-9, 0.999)\n            except ValueError:\n                # Should not be reached for valid parameters nu  0\n                phi_star_values[i] = 0.0 # Fallback\n\n        # --- Step 2: Calculate log-posterior ---\n        # Model for shear modulus G(nu)\n        G_model = nu_grid * R * T * (1.0 - 2.0 / f)\n        \n        # Log-likelihood from G\n        log_L_G = -0.5 * ((G_obs - G_model) / sigma_G)**2\n        \n        # Log-likelihood from phi\n        log_L_phi = -0.5 * ((phi_obs - phi_star_values) / sigma_phi)**2\n        \n        # Joint log-posterior (prior is uniform, so its log is constant)\n        log_posterior = log_L_G + log_L_phi\n\n        # --- Step 3: Normalize posterior and compute statistics ---\n        # Exponentiate to get unnormalized posterior, shifting to avoid underflow\n        log_posterior_shifted = log_posterior - np.max(log_posterior)\n        posterior_unnorm = np.exp(log_posterior_shifted)\n        \n        # Normalize using the trapezoidal rule\n        normalization_const = np.trapz(posterior_unnorm, nu_grid)\n        posterior_norm = posterior_unnorm / normalization_const\n        \n        # Compute posterior mean\n        mean_nu = np.trapz(posterior_norm * nu_grid, nu_grid)\n        \n        # Compute posterior standard deviation\n        E_nu_sq = np.trapz(posterior_norm * nu_grid**2, nu_grid)\n        var_nu = E_nu_sq - mean_nu**2\n        std_nu = np.sqrt(var_nu)\n        \n        # Compute MAP estimate\n        map_idx = np.argmax(posterior_norm)\n        map_nu = nu_grid[map_idx]\n        \n        # Append results for the current case\n        results.extend([f\"{mean_nu:.3f}\", f\"{std_nu:.3f}\", f\"{map_nu:.3f}\"])\n\n    # Final print statement in the exact required format\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "2924693"}]}