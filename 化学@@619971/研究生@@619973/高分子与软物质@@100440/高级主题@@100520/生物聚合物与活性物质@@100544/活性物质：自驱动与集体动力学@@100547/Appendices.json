{"hands_on_practices": [{"introduction": "本练习提供了一个基础的纸笔训练，旨在帮助读者理解单粒子活性物质动力学。通过推导两种经典模型——主动布朗粒子（ABP）和奔跑-翻滚粒子（RTP）——的均方根位移（MSD），你将探索从短时弹道运动到长时扩散行为的普适性转变 [@problem_id:2906697]。这一基础计算对于掌握微观尺度上的持续运动如何导致宏观尺度上的增强扩散至关重要。", "problem": "考虑一个在恒定温度下，$d$维各向同性流体介质中的单个自驱动粒子，该粒子可以通过两种不同的方式建模：作为活性布朗粒子 (ABP) 和作为奔跑-翻滚粒子 (RTP)。在这两种模型中，粒子位置 $\\mathbf{r}(t)$ 遵循过阻尼运动学方程 $d\\mathbf{r}/dt = \\mathbf{v}(t) + \\sqrt{2 D_t}\\,\\boldsymbol{\\xi}(t)$ 演化，其中 $\\mathbf{v}(t) = v_0 \\mathbf{n}(t)$，自驱动速率 $v_0$ 为常数，$D_t$ 是平移扩散系数，$\\boldsymbol{\\xi}(t)$ 是零均值、单位方差且与 $\\mathbf{n}(t)$ 不相关的高斯白噪声。单位矢量 $\\mathbf{n}(t)$ 是自驱动的瞬时取向。对于 ABP，$\\mathbf{n}(t)$ 在单位 $(d-1)$维球面上进行各向同性旋转扩散，其旋转扩散系数为 $D_r$。对于 RTP，$\\mathbf{n}(t)$ 在两次瞬时翻滚之间是分段常数，翻滚事件以速率 $\\alpha$ 作为 Poisson 过程发生；每次翻滚都会将 $\\mathbf{n}(t)$ 重置为一个各向同性分布的新方向，该方向与其先前的值无关。\n\n仅使用基本定义和第一性原理（例如，速度的时间积分、平稳性和各向同性，以及均方位移和速度自相关之间的关系），完成以下任务：\n\n1. 从 $\\Delta \\mathbf{r}(t) = \\int_0^t \\mathbf{v}(s)\\,ds + \\text{热贡献项}$ 出发，以取向自相关函数 $C_n(t) = \\langle \\mathbf{n}(t)\\cdot \\mathbf{n}(0)\\rangle$ 的形式，推导均方位移 $\\langle |\\Delta \\mathbf{r}(t)|^2 \\rangle$ 的精确表达式。\n2. 对于 ABP，证明 $C_n(t)$ 是一个时间上的单指数函数，其退相关速率取决于 $d$ 和 $D_r$，并利用此结果求得对长时扩散系数的活性贡献，记为 $D_a^{\\mathrm{ABP}}$。\n3. 对于 RTP，计算 $C_n(t)$ 以及对长时扩散系数的相应活性贡献，记为 $D_a^{\\mathrm{RTP}}$。\n4. 将弹道-扩散交叉时间 $t_c$ 定义为唯一的正时间，在该时间点，由自驱动引起的短时弹道运动主导项 $v_0^2 t^2$ 等于仅由自驱动引起的长时扩散运动主导项的两倍，即\n$$\nv_0^2 t_c^2 = 2 d\\, D_a\\, t_c,\n$$\n其中 $D_a$ 是所考虑模型对长时扩散系数的活性贡献。使用此操作性定义，求出以 $d$、$D_r$ 和 $\\alpha$ 表示的 $t_c^{\\mathrm{ABP}}$ 和 $t_c^{\\mathrm{RTP}}$ 的闭式表达式。\n5. 基于你得到的均方位移表达式，比较 ABP 和 RTP 在中间时间段内随时间变化的标度关系，并指出交叉发生方式在定性上的任何相似之处或差异。\n\n将你的最终答案以行矩阵的形式返回，矩阵中依次包含 $t_c^{\\mathrm{ABP}}$ 和 $t_c^{\\mathrm{RTP}}$。在国际单位制 (SI) 中进行计算，时间单位为秒。最终方框内的答案不应包含单位。无需进行数值取整；提供精确的符号表达式。", "solution": "在尝试解答之前，需对问题陈述进行验证。\n\n首先，从问题陈述中逐字提取已知条件：\n- 粒子位置遵循过阻尼运动学方程 $d\\mathbf{r}/dt = \\mathbf{v}(t) + \\sqrt{2 D_t}\\,\\boldsymbol{\\xi}(t)$ 演化。\n- 自驱动速度为 $\\mathbf{v}(t) = v_0 \\mathbf{n}(t)$，其中 $v_0$ 是一个恒定速率。\n- 取向 $\\mathbf{n}(t)$ 是一个单位矢量。\n- 热噪声 $\\boldsymbol{\\xi}(t)$ 是零均值、单位方差的高斯白噪声，具体满足 $\\langle \\xi_i(t) \\xi_j(t') \\rangle = \\delta_{ij} \\delta(t-t')$，且与 $\\mathbf{n}(t)$ 不相关。\n- 平移扩散系数为 $D_t$。\n- 对于活性布朗粒子 (ABP)，$\\mathbf{n}(t)$ 在单位 $(d-1)$维球面上进行各向同性旋转扩散，其旋转扩散系数为 $D_r$。\n- 对于奔跑-翻滚粒子 (RTP)，$\\mathbf{n}(t)$ 以 Poisson 速率 $\\alpha$ 进行翻滚，之后重置为一个新的、各向同性随机的方向。\n- 取向自相关函数定义为 $C_n(t) = \\langle \\mathbf{n}(t)\\cdot \\mathbf{n}(0)\\rangle$。\n- 交叉时间 $t_c$ 由关系式 $v_0^2 t_c^2 = 2 d\\, D_a\\, t_c$ 定义，其中 $D_a$ 是对长时扩散系数的活性贡献。\n\n现在根据所需标准对问题进行验证。\n- **基于科学依据**：该问题基于活性布朗粒子和奔跑-翻滚粒子的经典模型，这些是活性物质物理学的基石。所用的数学框架是随机微分方程（Langevin 方程），这在统计力学中是标准方法。问题不含伪科学和事实错误。\n- **良定且客观**：问题提供了所有必要的定义、常数和模型描述。任务陈述清晰，并能基于已建立的物理原理导出一个唯一的、有意义的解。语言精确且客观。\n- **完整性**：问题是自洽的，不存在信息缺失或矛盾。\n\n结论是：该问题有效。我们可以着手求解。\n\n在时间间隔 $t$ 内粒子的位移通过对运动方程积分得到：\n$$\n\\Delta \\mathbf{r}(t) = \\mathbf{r}(t) - \\mathbf{r}(0) = \\int_0^t \\left( v_0 \\mathbf{n}(s) + \\sqrt{2 D_t} \\boldsymbol{\\xi}(s) \\right) ds\n$$\n均方位移 (MSD) 是 $\\langle |\\Delta \\mathbf{r}(t)|^2 \\rangle = \\langle \\Delta \\mathbf{r}(t) \\cdot \\Delta \\mathbf{r}(t) \\rangle$。我们展开此表达式：\n$$\n\\langle |\\Delta \\mathbf{r}(t)|^2 \\rangle = \\left\\langle \\left( \\int_0^t v_0 \\mathbf{n}(s) ds \\right) \\cdot \\left( \\int_0^t v_0 \\mathbf{n}(s') ds' \\right) \\right\\rangle + \\left\\langle \\left( \\int_0^t \\sqrt{2 D_t} \\boldsymbol{\\xi}(s) ds \\right) \\cdot \\left( \\int_0^t \\sqrt{2 D_t} \\boldsymbol{\\xi}(s') ds' \\right) \\right\\rangle + 2 \\left\\langle \\left( \\int_0^t v_0 \\mathbf{n}(s) ds \\right) \\cdot \\left( \\int_0^t \\sqrt{2 D_t} \\boldsymbol{\\xi}(s') ds' \\right) \\right\\rangle\n$$\n第一项是活性贡献。第二项是热贡献。第三项是交叉项。由于取向 $\\mathbf{n}(s)$ 和热噪声 $\\boldsymbol{\\xi}(s')$ 对于所有 $s$ 和 $s'$ 都不相关，且 $\\boldsymbol{\\xi}$ 的均值为零，交叉项为零。\n\n我们来计算热贡献：\n$$\n\\langle |\\Delta \\mathbf{r}(t)|_{\\text{thermal}}^2 \\rangle = 2 D_t \\int_0^t ds \\int_0^t ds' \\langle \\boldsymbol{\\xi}(s) \\cdot \\boldsymbol{\\xi}(s') \\rangle = 2 D_t \\int_0^t ds \\int_0^t ds' \\sum_{i=1}^d \\langle \\xi_i(s) \\xi_i(s') \\rangle\n$$\n利用白噪声的性质 $\\langle \\xi_i(s) \\xi_i(s') \\rangle = \\delta(s-s')$，我们得到：\n$$\n\\langle |\\Delta \\mathbf{r}(t)|_{\\text{thermal}}^2 \\rangle = 2 D_t \\int_0^t ds \\int_0^t ds' \\sum_{i=1}^d \\delta(s-s') = 2 D_t \\int_0^t ds \\cdot d = 2 d D_t t\n$$\n现在，我们用 $C_n(t)$ 来计算活性贡献：\n$$\n\\langle |\\Delta \\mathbf{r}(t)|_{\\text{active}}^2 \\rangle = v_0^2 \\int_0^t ds \\int_0^t ds' \\langle \\mathbf{n}(s) \\cdot \\mathbf{n}(s') \\rangle\n$$\n由于取向的底层随机过程具有平稳性，相关函数仅取决于时间差：$\\langle \\mathbf{n}(s) \\cdot \\mathbf{n}(s') \\rangle = C_n(|s-s'|)$。这个二重积分可以写成：\n$$\n\\int_0^t ds \\int_0^t ds' C_n(|s-s'|) = 2 \\int_0^t d\\tau (t-\\tau) C_n(\\tau)\n$$\n因此，总的均方位移是：\n$$\n\\langle |\\Delta \\mathbf{r}(t)|^2 \\rangle = 2 d D_t t + 2 v_0^2 \\int_0^t (t-\\tau) C_n(\\tau) d\\tau\n$$\n这完成了任务 1。\n\n对于任务 2 (ABP)，我们必须求出 $C_n(t)$。取向矢量 $\\mathbf{n}(t)$ 在 $(d-1)$维球面上进行旋转扩散。其概率分布的演化由旋转扩散方程 $\\partial_t P = D_r \\nabla_S^2 P$ 控制，其中 $\\nabla_S^2$ 是球面上的 Laplace-Beltrami 算子。取向自相关函数 $C_n(t) = \\langle \\mathbf{n}(t) \\cdot \\mathbf{n}(0) \\rangle$ 可以通过考虑第一阶球谐函数的弛豫来计算。算子 $-\\nabla_S^2$ 的本征值对于 $l$ 阶球谐函数是 $\\lambda_l = l(l+d-2)$。矢量 $\\mathbf{n}$ 的分量是一阶（$l=1$）球谐函数。任何 $l=1$ 模式的相关函数都以相应的本征值 $\\lambda_1 = 1(1+d-2) = d-1$ 衰减。因此，退相关速率是 $(d-1)D_r$。\n$$\nC_n(t) = \\langle \\mathbf{n}(0) \\cdot \\mathbf{n}(0) \\rangle \\exp(-(d-1)D_r t) = \\exp(-(d-1)D_r t)\n$$\n长时有效扩散系数 $D_{\\text{eff}}$ 可通过 MSD 的长时极限求得：$D_{\\text{eff}} = \\lim_{t\\to\\infty} \\frac{\\langle |\\Delta \\mathbf{r}(t)|^2 \\rangle}{2dt}$。总 MSD 为 $\\langle |\\Delta\\mathbf{r}(t)|^2\\rangle = 2dD_t t + 2 v_0^2 \\int_0^t (t-\\tau) C_n(\\tau)d\\tau$。在 $t \\to \\infty$ 的极限下，积分 $\\int_0^t (t-\\tau) C_n(\\tau)d\\tau \\approx t \\int_0^\\infty C_n(\\tau)d\\tau$。\n所以，$\\lim_{t\\to\\infty} \\langle |\\Delta \\mathbf{r}(t)|^2 \\rangle \\approx 2 d D_t t + 2 v_0^2 t \\int_0^\\infty C_n(\\tau) d\\tau$。\n有效扩散系数为 $D_{\\text{eff}} = D_t + D_a$，其中活性贡献为：\n$$\nD_a = \\frac{v_0^2}{d} \\int_0^\\infty C_n(\\tau)d\\tau\n$$\n对于 ABP，我们计算这个积分：\n$$\n\\int_0^\\infty C_n(\\tau)d\\tau = \\int_0^\\infty \\exp(-(d-1)D_r \\tau) d\\tau = \\frac{1}{(d-1)D_r}\n$$\n所以，ABP 的活性扩散系数为：\n$$\nD_a^{\\mathrm{ABP}} = \\frac{v_0^2}{d(d-1)D_r}\n$$\n这完成了任务 2。\n\n对于任务 3 (RTP)，我们求解其取向自相关函数 $C_n(t)$。以速率 $\\alpha$ 发生的翻滚事件会使取向随机化。在区间 $[0, t]$ 内没有翻滚发生的概率由 Poisson 分布给出，$P_0(t) = \\exp(-\\alpha t)$。如果没有翻滚发生，$\\mathbf{n}(t) = \\mathbf{n}(0)$。如果发生一次或多次翻滚，新的取向与初始取向不相关，因此 $\\langle \\mathbf{n}(t) \\cdot \\mathbf{n}(0) \\rangle_{\\text{tumbled}} = 0$。\n总相关是加权平均值：\n$$\nC_n(t) = \\langle \\mathbf{n}(t) \\cdot \\mathbf{n}(0) \\rangle = \\langle \\mathbf{n}(0) \\cdot \\mathbf{n}(0) \\rangle \\cdot P_0(t) + \\langle \\mathbf{n}(t) \\cdot \\mathbf{n}(0) \\rangle_{\\text{tumbled}} \\cdot (1-P_0(t))\n$$\n$$\nC_n(t) = 1 \\cdot \\exp(-\\alpha t) + 0 \\cdot (1-\\exp(-\\alpha t)) = \\exp(-\\alpha t)\n$$\n现在我们计算活性扩散系数 $D_a^{\\mathrm{RTP}}$：\n$$\n\\int_0^\\infty C_n(\\tau)d\\tau = \\int_0^\\infty \\exp(-\\alpha \\tau) d\\tau = \\frac{1}{\\alpha}\n$$\n$$\nD_a^{\\mathrm{RTP}} = \\frac{v_0^2}{d\\alpha}\n$$\n这完成了任务 3。\n\n对于任务 4，我们使用给定的定义来计算交叉时间 $t_c$：$v_0^2 t_c^2 = 2 d D_a t_c$。由于我们假设 $t_c > 0$，我们可以除以 $v_0^2 t_c$：\n$$\nt_c = \\frac{2d D_a}{v_0^2}\n$$\n对于 ABP：\n$$\nt_c^{\\mathrm{ABP}} = \\frac{2d}{v_0^2} D_a^{\\mathrm{ABP}} = \\frac{2d}{v_0^2} \\frac{v_0^2}{d(d-1)D_r} = \\frac{2}{(d-1)D_r}\n$$\n对于 RTP：\n$$\nt_c^{\\mathrm{RTP}} = \\frac{2d}{v_0^2} D_a^{\\mathrm{RTP}} = \\frac{2d}{v_0^2} \\frac{v_0^2}{d\\alpha} = \\frac{2}{\\alpha}\n$$\n这完成了任务 4。\n\n对于任务5，我们比较中间时间尺度上的标度关系。MSD 的活性部分由 $\\text{MSD}_a(t) = 2 v_0^2 \\int_0^t (t-\\tau) C_n(\\tau) d\\tau$ 给出。\n对于 ABP，令 $\\tau_p^{\\mathrm{ABP}} = 1/((d-1)D_r)$。那么 $C_n(t) = \\exp(-t/\\tau_p^{\\mathrm{ABP}})$。\n对于 RTP，令 $\\tau_p^{\\mathrm{RTP}} = 1/\\alpha$。那么 $C_n(t) = \\exp(-t/\\tau_p^{\\mathrm{RTP}})$。\n在这两种情况下，相关函数都是单指数函数，$C_n(t) = \\exp(-t/\\tau_p)$，其中 $\\tau_p$ 是取向的持续时间。\n我们来对一个通用的指数相关函数进行积分：\n$$\n\\int_0^t (t-\\tau) \\exp(-\\tau/\\tau_p) d\\tau = \\left[ -(t-\\tau)\\tau_p \\exp(-\\tau/\\tau_p) \\right]_0^t - \\int_0^t (-\\tau_p) \\exp(-\\tau/\\tau_p) (-1) d\\tau\n$$\n$$\n= t\\tau_p - \\tau_p \\int_0^t \\exp(-\\tau/\\tau_p) d\\tau = t\\tau_p - \\tau_p [-\\tau_p \\exp(-\\tau/\\tau_p)]_0^t = t\\tau_p - \\tau_p^2 (1 - \\exp(-t/\\tau_p))\n$$\n因此，对于这两种模型，当用各自的持续时间 $\\tau_p$ 表示时，MSD 的活性贡献具有相同的函数形式：\n$$\n\\text{MSD}_a(t) = 2 v_0^2 \\tau_p^2 \\left( \\frac{t}{\\tau_p} - 1 + \\exp(-t/\\tau_p) \\right)\n$$\n因此，从短时弹道区（对于 $t \\ll \\tau_p$，$\\text{MSD}_a(t) \\approx v_0^2 t^2$）到长时扩散区（对于 $t \\gg \\tau_p$，$\\text{MSD}_a(t) \\approx (2 v_0^2 \\tau_p) t$）的交叉对于两种模型在定性上是相同的。根本区别在于设定持续时间 $\\tau_p$ 的物理机制：ABP 是连续的旋转扩散，而 RTP 是离散的瞬时翻滚。然而，由均方位移表征的最终宏观运动表现出相同的交叉行为。\n\n最终答案需要 $t_c^{\\mathrm{ABP}}$ 和 $t_c^{\\mathrm{RTP}}$ 的表达式。\n$t_c^{\\mathrm{ABP}} = \\frac{2}{(d-1)D_r}$\n$t_c^{\\mathrm{RTP}} = \\frac{2}{\\alpha}$\n这些将以行矩阵的形式呈现。", "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{2}{(d-1)D_r} & \\frac{2}{\\alpha} \\end{pmatrix}}\n$$", "id": "2906697"}, {"introduction": "将理论与真实观测联系起来是物理学中的一项关键技能。本实践将挑战你像实验物理学家一样思考，通过推导从离散的粒子追踪数据中提取关键物理参数——自驱动速度（$v_0$）和旋转扩散系数（$D_r$）——的方法 [@problem_id:2906653]。你将学习如何巧妙地结合均方根位移和速度自相关函数的测量值，以构建能够抵抗如定位噪声等常见实验伪影的估计量。", "problem": "一个由二维活性布朗粒子（ABPs; Active Brownian Particles）组成的稀疏系综在离散时间 $t_{n} = n \\Delta$ 被追踪，观测窗口持续时间有限，为 $T = N \\Delta$，其中 $\\Delta$ 是帧间隔，且 $N \\gg 1$。每个粒子遵循过阻尼运动学方程\n$$\n\\dot{\\boldsymbol{r}}(t) = v_{0}\\,\\boldsymbol{u}(t) + \\sqrt{2 D_{t}}\\,\\boldsymbol{\\xi}(t),\n\\qquad\n\\dot{\\theta}(t) = \\sqrt{2 D_{r}}\\,\\eta(t),\n$$\n其中 $\\boldsymbol{r}(t)$ 是位置，$\\boldsymbol{u}(t) = (\\cos\\theta(t), \\sin\\theta(t))$ 是取向，$v_{0}$ 是恒定的自驱动速度，$D_{t}$ 是平动扩散系数，$D_{r}$ 是转动扩散系数，$\\boldsymbol{\\xi}(t)$ 和 $\\eta(t)$ 是均值为零、方差为一的独立高斯白噪声。取向关联是稳态的，满足 $\\langle \\boldsymbol{u}(t)\\cdot \\boldsymbol{u}(t+\\tau)\\rangle = \\exp(-D_{r}\\tau)$。\n\n在每一帧，位置以独立的、零均值的定位噪声被记录，因此测量得到的位置为 $\\boldsymbol{r}_{\\mathrm{m}}(t_{n}) = \\boldsymbol{r}(t_{n}) + \\boldsymbol{\\eta}_{n}$，其中对于笛卡尔分量 $\\alpha,\\beta \\in \\{x,y\\}$，有 $\\langle \\eta_{n,\\alpha}\\rangle = 0$ 和 $\\langle \\eta_{n,\\alpha}\\eta_{m,\\beta}\\rangle = \\sigma^{2}\\delta_{nm}\\delta_{\\alpha\\beta}$。定义延迟为 $\\tau = k \\Delta$ 的经验均方位移 (MSD) 为\n$$\nM_{\\mathrm{m}}(k\\Delta) = \\left\\langle \\left| \\boldsymbol{r}_{\\mathrm{m}}(t_{n+k}) - \\boldsymbol{r}_{\\mathrm{m}}(t_{n}) \\right|^{2} \\right\\rangle_{n},\n$$\n粗粒化速度由前向差分 $\\boldsymbol{v}_{\\mathrm{m}}(t_{n}) = \\big(\\boldsymbol{r}_{\\mathrm{m}}(t_{n+1}) - \\boldsymbol{r}_{\\mathrm{m}}(t_{n})\\big)/\\Delta$ 定义，延迟为 $\\ell \\Delta$ 的经验速度自相关函数 (VACF; velocity autocorrelation function) 由下式给出\n$$\nC_{\\mathrm{m}}(\\ell \\Delta) = \\left\\langle \\boldsymbol{v}_{\\mathrm{m}}(t_{n}) \\cdot \\boldsymbol{v}_{\\mathrm{m}}(t_{n+\\ell}) \\right\\rangle_{n}.\n$$\n假设 $1 \\le \\ell \\le \\ell_{\\max} \\ll N$，从而时间平均是良定义的，且边缘效应可以忽略。您可以假设在遍历极限下，经验平均在统计误差范围内等于系综平均。\n\n严格地从给定的随机运动学、定义以及已知的取向关联出发，推导出自驱动速度 $v_{0}$ 和转动扩散系数 $D_{r}$ 的估计量，这些估计量对定位噪声 $\\sigma^{2}$ 和有限差分具有鲁棒性。具体来说：\n\n1) 推导MSD的期望函数形式 $M_{\\mathrm{m}}(\\tau)$，包括定位噪声的贡献。利用此结果，构造一个由三个正延迟 $\\tau_{s} = \\Delta, 2\\Delta, 3\\Delta$ 组成的小延迟组合，该组合能够消除恒定的噪声偏移和随时间线性变化的扩散项，从而在 $D_{r} \\Delta \\to 0$ 时，得到一个对 $v_{0}^{2}$ 的渐近无偏的主阶估计。\n\n2) 推导当整数 $\\ell \\ge 1$ 时粗粒化VACF的期望函数形式 $C_{\\mathrm{m}}(\\ell \\Delta)$。证明当 $\\ell \\ge 1$ 时，平动扩散和定位噪声均无贡献，并且在 $\\Delta$ 上的有限差分会产生一个仅依赖于 $D_{r}\\Delta$ 的乘性形状因子。利用 $C_{\\mathrm{m}}(\\ell_{1}\\Delta)$ 和 $C_{\\mathrm{m}}(\\ell_{2}\\Delta)$ （其中 $\\ell_{2} > \\ell_{1} \\ge 1$ 为整数）的比值，消除未知振幅，从而获得一个对任意 $D_{r}\\Delta$ 都有效的 $D_{r}$ 闭式估计量。\n\n请用测得的 $M_{\\mathrm{m}}(\\Delta)$、$M_{\\mathrm{m}}(2\\Delta)$、$M_{\\mathrm{m}}(3\\Delta)$、$C_{\\mathrm{m}}(\\ell_{1}\\Delta)$、$C_{\\mathrm{m}}(\\ell_{2}\\Delta)$、$\\Delta$、$\\ell_{1}$ 和 $\\ell_{2}$ 明确地给出您的最终估计量 $\\hat{v}_{0}$ 和 $\\hat{D}_{r}$。不需要数值。最终答案必须是关于数对 $(\\hat{v}_{0}, \\hat{D}_{r})$ 的单个解析表达式；最终答案框中不要包含任何单位。如果使用了任何近似，请在您的推导中明确说明其有效范围。不要对任何量进行四舍五入。", "solution": "所述问题在科学上是合理的、良定的、客观的，并且在活性物质物理的既定框架内是自洽的。它提出了一个基于活性布朗粒子（ABP）模型的标准（尽管并非平凡）的解析任务。因此，该问题被认为是有效的，有必要进行完整推导。\n\n按照要求，解答分为两个子问题：首先，推导自驱动速度 $v_{0}$ 的估计量；其次，推导转动扩散系数 $D_{r}$ 的估计量。\n\n**第1部分：自驱动速度 $v_{0}$ 的估计量**\n\n我们首先推导ABP的理论均方位移（MSD），包括平动扩散和测量噪声的影响。位置 $\\boldsymbol{r}(t)$ 根据朗之万方程 $\\dot{\\boldsymbol{r}}(t) = v_{0}\\,\\boldsymbol{u}(t) + \\sqrt{2 D_{t}}\\,\\boldsymbol{\\xi}(t)$ 演化。在时间间隔 $\\tau$ 内的位移是\n$$\n\\Delta\\boldsymbol{r}(\\tau) = \\boldsymbol{r}(t+\\tau) - \\boldsymbol{r}(t) = v_{0} \\int_{t}^{t+\\tau} \\boldsymbol{u}(s)ds + \\sqrt{2 D_{t}} \\int_{t}^{t+\\tau} \\boldsymbol{\\xi}(s)ds.\n$$\n真实MSD，$M(\\tau) = \\langle |\\Delta\\boldsymbol{r}(\\tau)|^{2} \\rangle$，是通过对幅度平方取系综平均来计算的。自驱动项和平动噪声项是不相关的，因此它们的交叉项在平均后消失。总MSD是各项贡献之和。\n来自平动扩散的贡献是标准的：对于二维情况，$\\langle |\\sqrt{2 D_{t}} \\int_{t}^{t+\\tau} \\boldsymbol{\\xi}(s)ds|^{2} \\rangle = 4D_{t}\\tau$。\n来自活性运动的贡献是\n$$\nv_{0}^{2} \\left\\langle \\left| \\int_{t}^{t+\\tau} \\boldsymbol{u}(s)ds \\right|^{2} \\right\\rangle = v_{0}^{2} \\int_{t}^{t+\\tau} \\int_{t}^{t+\\tau} \\langle \\boldsymbol{u}(s) \\cdot \\boldsymbol{u}(s') \\rangle ds ds'.\n$$\n使用稳态取向关联 $\\langle \\boldsymbol{u}(s) \\cdot \\boldsymbol{u}(s') \\rangle = \\exp(-D_{r}|s-s'|)$，该二重积分的计算结果为\n$$\nv_{0}^{2} \\int_{0}^{\\tau} \\int_{0}^{\\tau} \\exp(-D_{r}|s-s'|) ds ds' = \\frac{2v_{0}^{2}}{D_{r}^{2}} \\left( D_{r}\\tau - 1 + \\exp(-D_{r}\\tau) \\right).\n$$\n因此，真实MSD为 $M(\\tau) = \\frac{2v_{0}^{2}}{D_{r}^{2}} (D_{r}\\tau - 1 + \\exp(-D_{r}\\tau)) + 4D_{t}\\tau$。\n\n测得的位置为 $\\boldsymbol{r}_{\\mathrm{m}}(t_{n}) = \\boldsymbol{r}(t_{n}) + \\boldsymbol{\\eta}_{n}$，其中 $\\boldsymbol{\\eta}_{n}$ 是定位噪声，满足 $\\langle \\eta_{n,\\alpha}\\eta_{m,\\beta}\\rangle = \\sigma^{2}\\delta_{nm}\\delta_{\\alpha\\beta}$。在延迟 $\\tau=k\\Delta$ 时的测量MSD为\n$$\nM_{\\mathrm{m}}(k\\Delta) = \\left\\langle |\\boldsymbol{r}_{\\mathrm{m}}(t_{n+k}) - \\boldsymbol{r}_{\\mathrm{m}}(t_{n})|^{2} \\right\\rangle = \\left\\langle |(\\boldsymbol{r}_{n+k} - \\boldsymbol{r}_{n}) + (\\boldsymbol{\\eta}_{n+k} - \\boldsymbol{\\eta}_{n})|^{2} \\right\\rangle.\n$$\n由于定位噪声与粒子的轨迹无关，交叉项消失。对于 $k \\ge 1$，$\\boldsymbol{\\eta}_{n+k}$ 和 $\\boldsymbol{\\eta}_{n}$ 是不相关的。因此，\n$$\nM_{\\mathrm{m}}(k\\Delta) = M(k\\Delta) + \\langle|\\boldsymbol{\\eta}_{n+k}|^{2}\\rangle + \\langle|\\boldsymbol{\\eta}_{n}|^{2}\\rangle = M(k\\Delta) + 2\\sigma^{2} + 2\\sigma^{2} = M(k\\Delta) + 4\\sigma^{2}.\n$$\n测量MSD的完整表达式为\n$$\nM_{\\mathrm{m}}(\\tau) = \\frac{2v_{0}^{2}}{D_{r}^{2}} \\left( D_{r}\\tau - 1 + \\exp(-D_{r}\\tau) \\right) + 4D_{t}\\tau + 4\\sigma^{2}.\n$$\n为了构造一个对 $\\sigma^{2}$ 和 $D_{t}$ 具有鲁棒性的 $v_{0}$ 估计量，我们构造一个在延迟 $\\tau_{s} = \\Delta, 2\\Delta, 3\\Delta$ 处测量MSD的线性组合，以消除常数项（$4\\sigma^2$）和随时间线性变化的项（$4D_t\\tau$）。应用于函数 $f(k\\Delta)$ 的离散二阶导数算子是 $f((k+1)\\Delta) - 2f(k\\Delta) + f((k-1)\\Delta)$。我们使用指定的延迟应用此结构：$M_{\\mathrm{m}}(3\\Delta) - 2M_{\\mathrm{m}}(2\\Delta) + M_{\\mathrm{m}}(\\Delta)$。此组合能完全消去任何 $A + B(k\\Delta)$ 形式的项。\n将此应用于完整的 $M_{\\mathrm{m}}(k\\Delta)$ 表达式，项 $4\\sigma^{2}+4D_{t}k\\Delta$ 和活性项的线性部分 $\\frac{2v_0^2}{D_r}k\\Delta$ 被完全抵消。剩下的是非线性部分的贡献：\n$$\nM_{\\mathrm{m}}(3\\Delta) - 2M_{\\mathrm{m}}(2\\Delta) + M_{\\mathrm{m}}(\\Delta) = \\frac{2v_{0}^{2}}{D_{r}^{2}} \\left[ \\left(\\exp(-3D_{r}\\Delta) - 2\\exp(-2D_{r}\\Delta) + \\exp(-D_{r}\\Delta)\\right) - (1-2+1) \\right].\n$$\n常数项部分为零。剩余的表达式正比于\n$$\n\\exp(-D_{r}\\Delta) - 2\\exp(-2D_{r}\\Delta) + \\exp(-3D_{r}\\Delta) = \\exp(-D_{r}\\Delta)(1 - \\exp(-D_{r}\\Delta))^{2}.\n$$\n所以，$M_{\\mathrm{m}}(3\\Delta) - 2M_{\\mathrm{m}}(2\\Delta) + M_{\\mathrm{m}}(\\Delta) = \\frac{2v_{0}^{2}}{D_{r}^{2}} \\exp(-D_{r}\\Delta) \\left(1 - \\exp(-D_{r}\\Delta)\\right)^{2}$。\n问题要求一个在 $D_{r}\\Delta \\to 0$ 时渐近无偏的估计量。在此极限下，我们展开指数函数：\n$1 - \\exp(-D_{r}\\Delta) = D_{r}\\Delta - \\frac{1}{2}(D_{r}\\Delta)^{2} + O((D_{r}\\Delta)^{3})$。\n$\\exp(-D_{r}\\Delta) = 1 - D_{r}\\Delta + O((D_{r}\\Delta)^{2})$。\n该组合变为：\n$$\n\\frac{2v_{0}^{2}}{D_{r}^{2}} (1 - D_{r}\\Delta + \\dots)(D_{r}\\Delta - \\dots)^{2} = \\frac{2v_{0}^{2}}{D_{r}^{2}} (1+\\dots)(D_{r}^{2}\\Delta^{2}+\\dots) = 2v_{0}^{2}\\Delta^{2} + O((D_{r}\\Delta)^{3}).\n$$\n主阶行为是 $2v_{0}^{2}\\Delta^{2}$。由此，我们构造 $v_{0}^{2}$ 的估计量：\n$$\n\\hat{v}_{0}^{2} = \\frac{M_{\\mathrm{m}}(3\\Delta) - 2M_{\\mathrm{m}}(2\\Delta) + M_{\\mathrm{m}}(\\Delta)}{2\\Delta^{2}}.\n$$\n取平方根得到 $v_{0}$ 的估计量。\n\n**第2部分：转动扩散系数 $D_{r}$ 的估计量**\n\n我们推导粗粒化速度自相关函数（VACF）的期望函数形式。测量的速度为 $\\boldsymbol{v}_{\\mathrm{m}}(t_{n}) = (\\boldsymbol{r}_{\\mathrm{m}}(t_{n+1}) - \\boldsymbol{r}_{\\mathrm{m}}(t_{n}))/\\Delta$。在延迟 $\\ell\\Delta$ 时的VACF为 $C_{\\mathrm{m}}(\\ell\\Delta) = \\langle \\boldsymbol{v}_{\\mathrm{m}}(t_{n}) \\cdot \\boldsymbol{v}_{\\mathrm{m}}(t_{n+\\ell}) \\rangle$。\n代入 $\\boldsymbol{v}_{\\mathrm{m}}$ 的定义，我们有\n$$\nC_{\\mathrm{m}}(\\ell\\Delta) = \\frac{1}{\\Delta^{2}} \\left\\langle \\left( \\Delta\\boldsymbol{r}_{n} + \\Delta\\boldsymbol{\\eta}_{n} \\right) \\cdot \\left( \\Delta\\boldsymbol{r}_{n+\\ell} + \\Delta\\boldsymbol{\\eta}_{n+\\ell} \\right) \\right\\rangle,\n$$\n其中 $\\Delta\\boldsymbol{r}_{j} = \\boldsymbol{r}_{j+1}-\\boldsymbol{r}_{j}$ 且 $\\Delta\\boldsymbol{\\eta}_{j} = \\boldsymbol{\\eta}_{j+1}-\\boldsymbol{\\eta}_{j}$。\n对于 $\\ell \\ge 1$，第一项中的噪声项时间索引 $n$ 和 $n+1$ 与第二项中的 $n+\\ell$ 和 $n+\\ell+1$ 不同。给定 $\\langle\\boldsymbol{\\eta}_{i}\\cdot\\boldsymbol{\\eta}_{j}\\rangle \\propto \\delta_{ij}$，噪声项 $\\langle \\Delta\\boldsymbol{\\eta}_{n} \\cdot \\Delta\\boldsymbol{\\eta}_{n+\\ell} \\rangle$ 为零。涉及 $\\Delta\\boldsymbol{r}$ 和 $\\Delta\\boldsymbol{\\eta}$ 的交叉项也为零。因此，对于 $\\ell \\ge 1$，定位噪声对VACF没有贡献。\n$$\nC_{\\mathrm{m}}(\\ell\\Delta) = C(\\ell\\Delta) = \\frac{1}{\\Delta^{2}} \\langle \\Delta\\boldsymbol{r}_{n} \\cdot \\Delta\\boldsymbol{r}_{n+\\ell} \\rangle.\n$$\n代入位移的积分形式 $\\Delta\\boldsymbol{r}_{n} = v_0 \\int_{n\\Delta}^{(n+1)\\Delta} \\boldsymbol{u}(t) dt + \\sqrt{2D_t} \\int_{n\\Delta}^{(n+1)\\Delta} \\boldsymbol{\\xi}(t) dt$。对于 $\\ell \\ge 1$，$\\Delta\\boldsymbol{r}_n$ 和 $\\Delta\\boldsymbol{r}_{n+\\ell}$ 的积分区间是不相交的。因此维纳过程的增量是不相关的，所以平动扩散项 $\\langle (\\int \\boldsymbol{\\xi} dt) \\cdot (\\int \\boldsymbol{\\xi} dt) \\rangle$ 消失。我们只剩下活性分量：\n$$\nC_{\\mathrm{m}}(\\ell\\Delta) = \\frac{v_{0}^{2}}{\\Delta^{2}} \\left\\langle \\left( \\int_{n\\Delta}^{(n+1)\\Delta} \\boldsymbol{u}(t) dt \\right) \\cdot \\left( \\int_{(n+\\ell)\\Delta}^{(n+\\ell+1)\\Delta} \\boldsymbol{u}(t') dt' \\right) \\right\\rangle = \\frac{v_{0}^{2}}{\\Delta^{2}} \\int_{n\\Delta}^{(n+1)\\Delta} dt \\int_{(n+\\ell)\\Delta}^{(n+\\ell+1)\\Delta} dt' \\langle \\boldsymbol{u}(t) \\cdot \\boldsymbol{u}(t') \\rangle.\n$$\n使用 $\\langle \\boldsymbol{u}(t) \\cdot \\boldsymbol{u}(t') \\rangle = \\exp(-D_{r}(t'-t))$ (对于 $t' > t$), 积分变得可分离：\n$$\n\\int_{0}^{\\Delta} ds \\int_{0}^{\\Delta} ds' \\exp(-D_{r}(\\ell\\Delta + s' - s)) = \\exp(-D_{r}\\ell\\Delta) \\left( \\int_{0}^{\\Delta} e^{D_{r}s} ds \\right) \\left( \\int_{0}^{\\Delta} e^{-D_{r}s'} ds' \\right).\n$$\n积分计算结果为：$\\int_{0}^{\\Delta} e^{\\pm D_{r}s} ds = \\frac{1}{\\pm D_{r}}(\\exp(\\pm D_{r}\\Delta) - 1)$。它们的乘积是 $\\frac{1}{-D_r^2}(e^{D_r\\Delta}-1)(e^{-D_r\\Delta}-1) = \\frac{1}{D_r^2}(2 - e^{D_r\\Delta} - e^{-D_r\\Delta}) = \\frac{2}{D_r^2}(1-\\cosh(D_r\\Delta)) = \\frac{4}{D_r^2}\\sinh^2(D_r\\Delta/2)$。\n综合所有部分，我们得到当 $\\ell \\ge 1$ 时的VACF：\n$$\nC_{\\mathrm{m}}(\\ell\\Delta) = \\frac{v_{0}^{2}}{\\Delta^{2}} \\exp(-D_{r}\\ell\\Delta) \\frac{4\\sinh^{2}(D_{r}\\Delta/2)}{D_{r}^{2}} = v_{0}^{2} \\left( \\frac{2\\sinh(D_{r}\\Delta/2)}{D_{r}\\Delta} \\right)^{2} \\exp(-D_{r}\\ell\\Delta).\n$$\n项 $\\left( \\frac{2\\sinh(D_{r}\\Delta/2)}{D_{r}\\Delta} \\right)^{2}$ 是由有限差分产生的乘性形状因子。它仅依赖于乘积 $D_{r}\\Delta$。总体形式为 $C_{\\mathrm{m}}(\\ell\\Delta) = A \\exp(-D_{r}\\ell\\Delta)$，其中振幅A与 $\\ell$ 无关。\n为了求得 $D_{r}$，我们取两个不同延迟 $\\ell_{2} > \\ell_{1} \\ge 1$ 处VACF的比值：\n$$\n\\frac{C_{\\mathrm{m}}(\\ell_{1}\\Delta)}{C_{\\mathrm{m}}(\\ell_{2}\\Delta)} = \\frac{A \\exp(-D_{r}\\ell_{1}\\Delta)}{A \\exp(-D_{r}\\ell_{2}\\Delta)} = \\exp(D_{r}(\\ell_{2}-\\ell_{1})\\Delta).\n$$\n该比值与 $v_{0}$ 和形状因子无关。解出 $D_{r}$ 可得一个对任意 $D_{r}\\Delta$ 值都有效的闭式估计量：\n$$\n\\ln\\left(\\frac{C_{\\mathrm{m}}(\\ell_{1}\\Delta)}{C_{\\mathrm{m}}(\\ell_{2}\\Delta)}\\right) = D_{r}(\\ell_{2}-\\ell_{1})\\Delta \\implies \\hat{D}_{r} = \\frac{1}{(\\ell_{2}-\\ell_{1})\\Delta} \\ln\\left(\\frac{C_{\\mathrm{m}}(\\ell_{1}\\Delta)}{C_{\\mathrm{m}}(\\ell_{2}\\Delta)}\\right).\n$$\n这就完成了所需估计量的推导。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\sqrt{\\frac{M_{\\mathrm{m}}(3\\Delta) - 2M_{\\mathrm{m}}(2\\Delta) + M_{\\mathrm{m}}(\\Delta)}{2\\Delta^2}} & \\frac{1}{(\\ell_2 - \\ell_1)\\Delta} \\ln\\left(\\frac{C_{\\mathrm{m}}(\\ell_1\\Delta)}{C_{\\mathrm{m}}(\\ell_2\\Delta)}\\right)\n\\end{pmatrix}\n}\n$$", "id": "2906653"}, {"introduction": "数值模拟是探索活性物质中复杂集体现象不可或缺的工具。这个计算实践将引导你思考精确模拟活性粒子所需的基本要素，重点关注积分时间步长 $\\Delta t$ 的关键选择 [@problem_id:2906656]。通过基于物理长度尺度和时间尺度推导并应用约束条件，你将培养一种直觉，了解如何确保你的模拟能够忠实地捕捉到关键的物理效应，例如粒子在边界处的积聚。", "problem": "考虑一个单一的、无相互作用的活性布朗粒子 (Active Brownian Particle, ABP)——一个具有内部取向的点状自驱动粒子——在二维空间中，该粒子靠近一个位于 $x=0$ 处的无限延伸、完全反射的直壁，其可及半空间由 $x \\ge 0$ 给出。该粒子沿其瞬时单位取向 $\\mathbf{p} = (\\cos \\theta, \\sin \\theta)$ 的自驱动速度为 $v_0$，其平动扩散率为 $D_t$，其取向角 $\\theta$ 的转动扩散率为 $D_r$。其随机动力学由成熟的过阻尼 Langevin 方程决定\n$$\n\\frac{d x}{d t} = v_0 \\cos \\theta + \\sqrt{2 D_t} \\, \\xi_x(t), \\quad\n\\frac{d y}{d t} = v_0 \\sin \\theta + \\sqrt{2 D_t} \\, \\xi_y(t), \\quad\n\\frac{d \\theta}{d t} = \\sqrt{2 D_r} \\, \\eta(t),\n$$\n其中 $\\xi_x(t)$、$\\xi_y(t)$ 和 $\\eta(t)$ 是独立的、单位方差的高斯白噪声。位于 $x=0$ 处的反射边界强制执行零通量条件，这可以通过将任何试图穿过壁的步长反射回 $x \\ge 0$ 的半空间来实现。\n\n你的任务是为取向和位置指定一个离散时间积分方案，该方案能够保持正确的转动扩散统计特性，并量化一个时间步长约束，以确保能够准确捕捉稳态下的壁面积累（即由于持续运动而在壁附近增强的概率密度）。你必须从上述基本随机方程出发，推导出一个使用时间步长 $\\Delta t$ 的算法。\n\n用于量化时间步长约束的精度标准应根据解析近壁边界层内的物理现象来定义。定义一个特征边界层长度尺度\n$$\n\\ell_\\star = \\max \\left( \\frac{v_0}{D_r}, \\sqrt{\\frac{D_t}{D_r}} \\right),\n$$\n该尺度为持续长度和扩散-转动耦合长度中的较大者。施加以下所有条件来限制 $\\Delta t$：\n- 转动解析度约束：要求时间步长能够解析转动弛豫时间，即\n$$\n\\Delta t \\le \\frac{\\beta}{D_r},\n$$\n其中 $\\beta$ 为一个固定常数。\n- 近壁法向位移约束：要求单步均方根法向位移的三倍标准差估计值是边界层长度尺度的一个小分数 $c_{\\mathrm{rms}}$。利用体相中取向噪声和平动噪声的独立性，取法向分量的均方根值为\n$$\n\\sqrt{\\frac{v_0^2}{2} \\, (\\Delta t)^2 + 2 D_t \\, \\Delta t},\n$$\n并施加\n$$\n3 \\sqrt{\\frac{v_0^2}{2} \\, (\\Delta t)^2 + 2 D_t \\, \\Delta t} \\le c_{\\mathrm{rms}} \\, \\ell_\\star.\n$$\n- 弹道步长约束：要求每个时间步长的确定性自驱动步长是边界层尺度的一个小分数 $c_{\\mathrm{bal}}$：\n$$\nv_0 \\, \\Delta t \\le c_{\\mathrm{bal}} \\, \\ell_\\star,\n$$\n以避免在 $D_t$ 较小时出现几何结构解析不足的情况。\n\n对于纯粹的被动极限 $v_0 = 0$，不存在稳态的壁面积累。在这种情况下，仅需强制执行转动解析度约束。\n\n采用固定的数值常数 $\\beta = 0.05$、$c_{\\mathrm{rms}} = 0.1$ 和 $c_{\\mathrm{bal}} = 0.1$。角度必须以弧度为单位。所有输出必须以秒为单位表示。\n\n对于以下测试套件中的每一组参数，你的程序必须计算最大允许时间步长 $\\Delta t_{\\max}$（单位为秒），该值是根据上述三个约束（或在 $v_0 = 0$ 时仅根据转动解析度约束）所隐含的最小值。结果必须四舍五入到 $6$ 位小数。\n\n测试套件 (附单位)：\n- 情况 1：$v_0 = 1.0$ 微米/秒，$D_r = 1.0$ /秒，$D_t = 0.05$ 平方微米/秒。\n- 情况 2：$v_0 = 3.0$ 微米/秒，$D_r = 0.5$ /秒，$D_t = 0.01$ 平方微米/秒。\n- 情况 3：$v_0 = 0.0$ 微米/秒，$D_r = 1.0$ /秒，$D_t = 0.10$ 平方微米/秒。\n- 情况 4：$v_0 = 1.0$ 微米/秒，$D_r = 10.0$ /秒，$D_t = 0.00$ 平方微米/秒。\n\n最终输出格式：你的程序应生成一行包含四个 $\\Delta t_{\\max}$ 值（单位为秒）的 Python 风格列表，四舍五入到 $6$ 位小数，条目之间用逗号分隔，无空格，例如 `[0.123456,0.234567,0.345678,0.456789]`。", "solution": "问题陈述已经过严格验证，被认为是有效的。它在科学上基于成熟的活性物质理论，特别是活性布朗粒子 (ABP) 模型。该问题是适定的，所有必要的参数和约束都已明确定义，从而允许一个唯一且有意义的解。语言客观而精确。我现在开始进行解答。\n\n任务有两个方面：首先，为给定的随机动力学指定一个离散时间积分方案；其次，根据一组特定的精度约束计算最大允许时间步长 $\\Delta t_{\\max}$。\n\n对于所提供的过阻尼 Langevin 方程组，一个合适的数值积分方案是 Euler-Maruyama 方法。这种一阶方法是随机微分方程（SDEs）的直接离散化，易于实现，同时保留了噪声项的基本统计特性。对于一个有限时间步长 $\\Delta t$ 的积分分两个阶段进行：首先更新取向，然后更新位置。\n\n1. **取向更新：** 取向角 $\\theta$ 的动力学由一个简单的转动扩散方程决定：\n$$ \\frac{d \\theta}{d t} = \\sqrt{2 D_r} \\, \\eta(t) $$\n该方程的 Euler-Maruyama 离散化形式为：\n$$ \\theta_{n+1} = \\theta_n + \\sqrt{2 D_r \\Delta t} \\, Z_{\\theta} $$\n在这里，$\\theta_n$ 是时间步 $n$ 处的角度，$Z_{\\theta}$ 是从均值为 $0$、方差为 $1$ 的标准正态分布中抽取的随机数。这个更新规则正确地模拟了角度的扩散性质，因为单步角度位移的方差是 $\\langle (\\theta_{n+1} - \\theta_n)^2 \\rangle = 2 D_r \\Delta t$。\n\n2. **位置更新：** 位置坐标 $(x, y)$ 基于时间步开始时的取向 $\\theta_n$ 进行更新：\n$$ x_{n+1} = x_n + v_0 \\cos(\\theta_n) \\Delta t + \\sqrt{2 D_t \\Delta t} \\, Z_x $$\n$$ y_{n+1} = y_n + v_0 \\sin(\\theta_n) \\Delta t + \\sqrt{2 D_t \\Delta t} \\, Z_y $$\n在这里，$Z_x$ 和 $Z_y$ 是两个独立的随机数，也从标准正态分布中抽取，并且独立于 $Z_{\\theta}$。\n\n3. **边界条件：** 问题指定在 $x=0$ 处有一个完全反射壁。在计算出新的临时位置 $(x_{n+1}, y_{n+1})$ 后，必须强制执行此约束。如果粒子试图穿过壁，即如果 $x_{n+1} < 0$，其 $x$ 坐标将被反射回可及区域内：\n$$ x_{n+1} \\rightarrow -x_{n+1} $$\n$y$ 坐标和取向 $\\theta$ 不受此反射影响。这实现了所要求的零通量边界条件。\n\n接下来，我们通过分析给定的约束来确定最大允许时间步长 $\\Delta t_{\\max}$。对于每组参数，$\\Delta t_{\\max}$ 是从这些条件推导出的上限中的最小值。数值常数为 $\\beta = 0.05$、$c_{\\mathrm{rms}} = 0.1$ 和 $c_{\\mathrm{bal}} = 0.1$。\n\n特征边界层长度尺度定义为 $\\ell_\\star = \\max \\left( \\frac{v_0}{D_r}, \\sqrt{\\frac{D_t}{D_r}} \\right)$。\n\n约束如下：\n\n**1. 转动解析度约束：**\n此约束确保转动运动得到充分解析。\n$$ \\Delta t \\le \\frac{\\beta}{D_r} $$\n这给出了一个上限 $\\Delta t_{1, \\max} = \\beta / D_r$。\n\n**2. 近壁法向位移约束：**\n这仅在 $v_0 > 0$ 时适用。它限制了在一个时间步长内垂直于壁的位移。\n$$ 3 \\sqrt{\\frac{v_0^2}{2} (\\Delta t)^2 + 2 D_t \\Delta t} \\le c_{\\mathrm{rms}} \\ell_\\star $$\n将两边平方并重新整理，得到关于 $\\Delta t$ 的二次不等式：\n$$ \\left( \\frac{9 v_0^2}{2} \\right) (\\Delta t)^2 + (18 D_t) \\Delta t - c_{\\mathrm{rms}}^2 \\ell_\\star^2 \\le 0 $$\n其形式为 $A (\\Delta t)^2 + B \\Delta t + C \\le 0$，其中 $A = 4.5 v_0^2 > 0$，$B = 18 D_t \\ge 0$，且 $C = -c_{\\mathrm{rms}}^2 \\ell_\\star^2 \\le 0$。对于 $\\Delta t > 0$ 的有效范围是 $0 < \\Delta t \\le \\Delta t_{2, \\max}$，其中 $\\Delta t_{2, \\max}$ 是二次方程 $A (\\Delta t)^2 + B \\Delta t + C = 0$ 的正根：\n$$ \\Delta t_{2, \\max} = \\frac{-B + \\sqrt{B^2 - 4AC}}{2A} = \\frac{-18 D_t + \\sqrt{(18 D_t)^2 + 18 v_0^2 c_{\\mathrm{rms}}^2 \\ell_\\star^2}}{9 v_0^2} $$\n在 $D_t = 0$ 的特殊情况下，不等式简化为 $3 v_0 \\Delta t / \\sqrt{2} \\le c_{\\mathrm{rms}} \\ell_\\star$，得出 $\\Delta t_{2, \\max} = \\frac{\\sqrt{2} c_{\\mathrm{rms}} \\ell_\\star}{3 v_0}$。\n\n**3. 弹道步长约束：**\n这也仅在 $v_0 > 0$ 时适用，并防止粒子在单次确定性步骤中越过边界层。\n$$ v_0 \\Delta t \\le c_{\\mathrm{bal}} \\ell_\\star $$\n这给出了上限 $\\Delta t_{3, \\max} = \\frac{c_{\\mathrm{bal}} \\ell_\\star}{v_0}$。\n\n对于任何 $v_0 > 0$ 的情况，最大时间步长为 $\\Delta t_{\\max} = \\min(\\Delta t_{1, \\max}, \\Delta t_{2, \\max}, \\Delta t_{3, \\max})$。\n对于被动情况 $v_0 = 0$，问题明确指出只需强制执行转动解析度约束，因此 $\\Delta t_{\\max} = \\Delta t_{1, \\max}$。\n\n我们现在将此框架应用于测试套件：\n\n**情况 1：** $v_0 = 1.0$，$D_r = 1.0$，$D_t = 0.05$。\n- $\\ell_\\star = \\max\\left( \\frac{1.0}{1.0}, \\sqrt{\\frac{0.05}{1.0}} \\right) = \\max(1.0, 0.2236...) = 1.0$。\n- $\\Delta t_{1, \\max} = \\frac{0.05}{1.0} = 0.05$。\n- $\\Delta t_{2, \\max} = \\frac{-18(0.05) + \\sqrt{(18 \\cdot 0.05)^2 + 18(1.0)^2(0.1)^2(1.0)^2}}{9(1.0)^2} = \\frac{-0.9 + \\sqrt{0.81 + 0.18}}{9} = \\frac{-0.9 + \\sqrt{0.99}}{9} \\approx 0.010554$。\n- $\\Delta t_{3, \\max} = \\frac{0.1 \\times 1.0}{1.0} = 0.1$。\n- $\\Delta t_{\\max} = \\min(0.05, 0.010554, 0.1) = 0.010554$。\n\n**情况 2：** $v_0 = 3.0$，$D_r = 0.5$，$D_t = 0.01$。\n- $\\ell_\\star = \\max\\left( \\frac{3.0}{0.5}, \\sqrt{\\frac{0.01}{0.5}} \\right) = \\max(6.0, 0.1414...) = 6.0$。\n- $\\Delta t_{1, \\max} = \\frac{0.05}{0.5} = 0.1$。\n- $\\Delta t_{2, \\max} = \\frac{-18(0.01) + \\sqrt{(18 \\cdot 0.01)^2 + 18(3.0)^2(0.1)^2(6.0)^2}}{9(3.0)^2} = \\frac{-0.18 + \\sqrt{0.0324 + 58.32}}{81} = \\frac{-0.18 + \\sqrt{58.3524}}{81} \\approx 0.092085$。\n- $\\Delta t_{3, \\max} = \\frac{0.1 \\times 6.0}{3.0} = 0.2$。\n- $\\Delta t_{\\max} = \\min(0.1, 0.092085, 0.2) = 0.092085$。\n\n**情况 3：** $v_0 = 0.0$，$D_r = 1.0$，$D_t = 0.10$。\n- 这是被动极限（$v_0 = 0$）。根据问题陈述，仅强制执行转动解析度约束。\n- $\\Delta t_{\\max} = \\Delta t_{1, \\max} = \\frac{0.05}{1.0} = 0.05$。\n\n**情况 4：** $v_0 = 1.0$，$D_r = 10.0$，$D_t = 0.0$。\n- $\\ell_\\star = \\max\\left( \\frac{1.0}{10.0}, \\sqrt{\\frac{0.0}{10.0}} \\right) = \\max(0.1, 0) = 0.1$。\n- $\\Delta t_{1, \\max} = \\frac{0.05}{10.0} = 0.005$。\n- 由于 $D_t = 0$，我们使用第二个约束的简化公式：$\\Delta t_{2, \\max} = \\frac{\\sqrt{2} \\times 0.1 \\times 0.1}{3 \\times 1.0} = \\frac{0.01\\sqrt{2}}{3} \\approx 0.004714$。\n- $\\Delta t_{3, \\max} = \\frac{0.1 \\times 0.1}{1.0} = 0.01$。\n- $\\Delta t_{\\max} = \\min(0.005, 0.004714, 0.01) = 0.004714$。\n\n最终结果，四舍五入到 6 位小数，是 $0.010554$、$0.092085$、$0.050000$ 和 $0.004714$。这些结果由最终答案中提供的程序计算得出。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the maximum allowable time step for simulating an Active Brownian\n    Particle near a wall, based on a set of accuracy constraints.\n    \"\"\"\n\n    # Define the fixed numerical constants from the problem statement.\n    BETA = 0.05\n    C_RMS = 0.1\n    C_BAL = 0.1\n\n    # Test suite with parameters (v0, Dr, Dt).\n    # Units: v0 [micrometer/s], Dr [1/s], Dt [micrometer^2/s]\n    test_cases = [\n        (1.0, 1.0, 0.05),   # Case 1\n        (3.0, 0.5, 0.01),   # Case 2\n        (0.0, 1.0, 0.10),   # Case 3\n        (1.0, 10.0, 0.00),  # Case 4\n    ]\n\n    results = []\n    for v0, Dr, Dt in test_cases:\n        # According to the problem, Dr > 0 is implicitly assumed.\n        # Rotational-resolution bound is always applicable.\n        dt_max_1 = BETA / Dr\n\n        # For the passive limit (v0 = 0), only the rotational-resolution bound is enforced.\n        if v0 == 0.0:\n            results.append(dt_max_1)\n            continue\n\n        # For active cases (v0 > 0), calculate the other two bounds.\n        \n        # Calculate characteristic boundary-layer length scale l_star.\n        l_star = np.max([v0 / Dr, np.sqrt(Dt / Dr)])\n\n        # Bound 2: Near-wall normal-displacement bound.\n        # This requires solving a quadratic inequality for dt:\n        # A * (dt)^2 + B * dt + C <= 0\n        # where A = 4.5 * v0^2, B = 18 * Dt, C = -c_rms^2 * l_star^2\n        A = 4.5 * v0**2\n        B = 18 * Dt\n        C = -C_RMS**2 * l_star**2\n        \n        # We need the positive root of A*x^2 + B*x + C = 0.\n        # dt_max_2 = (-B + sqrt(B^2 - 4*A*C)) / (2*A)\n        discriminant = B**2 - 4 * A * C\n        dt_max_2 = (-B + np.sqrt(discriminant)) / (2 * A)\n\n        # Bound 3: Ballistic step bound.\n        dt_max_3 = (C_BAL * l_star) / v0\n\n        # The maximum allowable time step is the minimum of the three bounds.\n        dt_max = np.min([dt_max_1, dt_max_2, dt_max_3])\n        results.append(dt_max)\n\n    # Format the output as a list of strings, rounded to 6 decimal places.\n    formatted_results = [f\"{r:.6f}\" for r in results]\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2906656"}]}