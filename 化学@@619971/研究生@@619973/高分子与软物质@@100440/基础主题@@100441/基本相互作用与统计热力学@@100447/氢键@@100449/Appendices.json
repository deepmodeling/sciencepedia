{"hands_on_practices": [{"introduction": "要定量理解氢键，第一步是建立其相互作用的数学模型。本练习将使用Lennard-Jones势和静电势的组合来模拟一个氢键，这是分子建模中的一种常用方法。通过计算其解离能 $D_e$，你将深入理解势能曲线的形状与化学键稳定性之间的根本联系。[@problem_id:123489]", "problem": "一个简化的氢键（如 `N-H···O` 键）一维模型，将相互作用势能描述为两个重原子（N 和 O）之间距离 $r$ 的函数。该势能 $U(r)$ 是一个范德华项和一个静电项之和。\n\n1.  范德华相互作用由标准的 Lennard-Jones (LJ) 势描述：\n    $$\n    U_{LJ}(r) = 4\\epsilon \\left[ \\left(\\frac{\\sigma}{r}\\right)^{12} - \\left(\\frac{\\sigma}{r}\\right)^{6} \\right]\n    $$\n    此处，$\\epsilon$ 是 LJ 势阱的深度，$\\sigma$ 是 LJ 势为零时的距离。\n\n2.  氢键的方向性、强静电特性通过以下有效吸引势进行建模：\n    $$\n    U_{elec}(r) = -\\frac{A}{r^6}\n    $$\n    其中 $A$ 是一个正常数，代表了此特定静电相互作用的强度。\n\nN-O 相互作用的总势能是这两项贡献之和：\n$$\nU(r) = U_{LJ}(r) + U_{elec}(r)\n$$\n\n解离能 $D_e$ 定义为将两个重原子从其平衡距离 $r_e$ 分离到无限远处所需的能量。鉴于无限分离处的势能为零，解离能等于平衡距离处势能的负值，即 $D_e = -U(r_e)$。\n\n计算该氢键模型的解离能 $D_e$。请用参数 $\\epsilon$、$\\sigma$ 和 $A$ 将您的答案表示为封闭形式的解析表达式。", "solution": "解离能由 $D_e = -U(r_e)$ 给出，其中 $r_e$ 是满足 $\\frac{dU}{dr} \\big|_{r=r_e} = 0$ 的平衡距离。总势能为：\n\n$$\nU(r) = 4\\epsilon \\left[ \\left( \\frac{\\sigma}{r} \\right)^{12} - \\left( \\frac{\\sigma}{r} \\right)^6 \\right] - \\frac{A}{r^6}\n$$\n\n用 $r^{-6}$ 改写 $U(r)$：\n\n$$\nU(r) = 4\\epsilon \\sigma^{12} r^{-12} - 4\\epsilon \\sigma^6 r^{-6} - A r^{-6} = 4\\epsilon \\sigma^{12} (r^{-6})^2 - (4\\epsilon \\sigma^6 + A) r^{-6}\n$$\n\n设 $x = r^{-6}$，则：\n\n$$\nU = 4\\epsilon \\sigma^{12} x^2 - (4\\epsilon \\sigma^6 + A) x\n$$\n\n关于 $r$ 的导数为：\n\n$$\n\\frac{dU}{dr} = \\frac{dU}{dx} \\frac{dx}{dr} = \\left[ 8\\epsilon \\sigma^{12} x - (4\\epsilon \\sigma^6 + A) \\right] \\cdot (-6 r^{-7})\n$$\n\n在平衡状态下，$ \\frac{dU}{dr} = 0 $，这意味着：\n\n$$\n8\\epsilon \\sigma^{12} x_e - (4\\epsilon \\sigma^6 + A) = 0\n$$\n\n其中 $x_e = r_e^{-6}$。解出 $x_e$：\n\n$$\nx_e = \\frac{4\\epsilon \\sigma^6 + A}{8\\epsilon \\sigma^{12}}\n$$\n\n现在，计算 $U(r_e)$：\n\n$$\nU(r_e) = 4\\epsilon \\sigma^{12} x_e^2 - (4\\epsilon \\sigma^6 + A) x_e\n$$\n\n代入 $x_e$：\n\n$$\nU(r_e) = 4\\epsilon \\sigma^{12} \\left( \\frac{4\\epsilon \\sigma^6 + A}{8\\epsilon \\sigma^{12}} \\right)^2 - (4\\epsilon \\sigma^6 + A) \\left( \\frac{4\\epsilon \\sigma^6 + A}{8\\epsilon \\sigma^{12}} \\right)\n$$\n\n化简：\n\n$$\nU(r_e) = 4\\epsilon \\sigma^{12} \\cdot \\frac{(4\\epsilon \\sigma^6 + A)^2}{64 \\epsilon^2 \\sigma^{24}} - \\frac{(4\\epsilon \\sigma^6 + A)^2}{8\\epsilon \\sigma^{12}} = \\frac{(4\\epsilon \\sigma^6 + A)^2}{16\\epsilon \\sigma^{12}} - \\frac{(4\\epsilon \\sigma^6 + A)^2}{8\\epsilon \\sigma^{12}}\n$$\n\n\n$$\nU(r_e) = \\frac{(4\\epsilon \\sigma^6 + A)^2}{\\sigma^{12}} \\left( \\frac{1}{16\\epsilon} - \\frac{1}{8\\epsilon} \\right) = \\frac{(4\\epsilon \\sigma^6 + A)^2}{\\sigma^{12}} \\left( -\\frac{1}{16\\epsilon} \\right) = -\\frac{(4\\epsilon \\sigma^6 + A)^2}{16\\epsilon \\sigma^{12}}\n$$\n\n因此，解离能为：\n\n$$\nD_e = -U(r_e) = \\frac{(4\\epsilon \\sigma^6 + A)^2}{16\\epsilon \\sigma^{12}}\n$$\n\n展开分子：\n\n$$\n(4\\epsilon \\sigma^6 + A)^2 = 16\\epsilon^2 \\sigma^{12} + 8\\epsilon \\sigma^6 A + A^2\n$$\n\n所以：\n\n$$\nD_e = \\frac{16\\epsilon^2 \\sigma^{12} + 8\\epsilon \\sigma^6 A + A^2}{16\\epsilon \\sigma^{12}} = \\epsilon + \\frac{A}{2\\sigma^6} + \\frac{A^2}{16\\epsilon \\sigma^{12}}\n$$", "answer": "$$\n\\boxed{\\epsilon + \\frac{A}{2\\sigma^{6}} + \\frac{A^{2}}{16\\epsilon \\sigma^{12}}}\n$$", "id": "123489"}, {"introduction": "超越单个化学键的范畴，本练习将探讨氢键网络的集体行为及其热力学后果。我们将对一个由水分子组成的环状结构应用著名的Bernal-Fowler冰规则，来计算质子所有可能的排布方式数量。这个实践将具体展示局域的成键规则如何导致宏观的剩余熵，这是理解水以及其他氢键体系性质的关键。[@problem_id:123520]", "problem": "在晶体冰中，氢原子（质子）的排列遵循伯纳尔-福勒冰规则 (Bernal-Fowler ice rules)：\n1. 每个氧原子都与恰好两个氢原子共价键合。\n2. 每个连接两个氧原子的氢键中，都恰好含有一个氢原子。\n\n这些规则导致了大量的可能质子构型，从而在零温度下产生剩余熵。\n\n考虑一个简化模型，该模型是一种在某些冰的多晶型物或笼形水合物中发现的结构基元。该结构由一个包含 $N$ 个氧原子的闭合环组成。每个氧原子 $O_i$（其中 $i=1, \\dots, N$）都呈四面体配位。其四个氢键中的两个将其与环内的邻居 $O_{i-1}$ 和 $O_{i+1}$ 连接起来（采用周期性边界条件，即 $O_{N+1} \\equiv O_1$）。每个氧原子的另外两个氢键则连接到晶格的其余部分，我们可以将其视为外部环境。\n\n对于一个由 $N=10$ 个氧原子组成的环，确定符合伯纳尔-福勒冰规则的允许质子构型的总数。", "solution": "伯纳尔-福勒冰规则要求：\n1. 每个氧原子恰好拥有两个共价键合的氢原子。\n2. 每个氢键中恰好只有一个氢原子。\n\n对于一个由 $N$ 个氧原子组成的环，每个氧原子 $O_i$（其中 $i = 1, \\dots, N$）有：\n- 两个环内键：连接到 $O_{i-1}$ 的左侧键（周期性边界下，$O_0 \\equiv O_N$）和连接到 $O_{i+1}$ 的右侧键（$O_{N+1} \\equiv O_1$）。\n- 两个连接到外部环境的键。\n\n定义 $L_i$ 为：\n\n$$\nL_i = \\begin{cases} \n1  \\text{如果 } O_i \\text{ 拥有左侧环内键（连接到 } O_{i-1}\\text{）中的质子}， \\\\\n0  \\text{如果 } O_{i-1} \\text{ 拥有该质子}。\n\\end{cases}\n$$\n\n右侧环内键（连接到 $O_{i+1}$）的质子所有权受到冰规则的约束：如果 $O_i$ 拥有该质子，那么 $O_{i+1}$ 就不能拥有，反之亦然。因此：\n\n$$\nR_i = 1 - L_{i+1},\n$$\n\n其中 $R_i$ 表示 $O_i$ 对右侧键中质子的所有权。\n\n每个氧原子总共必须拥有恰好两个质子。$O_i$ 拥有的质子来自：\n- 左侧环内键：$L_i$，\n- 右侧环内键：$R_i = 1 - L_{i+1}$，\n- 两个外部键：令 $E_{i1}, E_{i2} \\in \\{0,1\\}$ 表示 $O_i$ 对其中质子的所有权。\n\n方程为：\n\n$$\nL_i + (1 - L_{i+1}) + E_{i1} + E_{i2} = 2,\n$$\n\n简化为：\n\n$$\nL_i - L_{i+1} + s_i = 1, \\quad s_i = E_{i1} + E_{i2}, \\quad s_i \\in \\{0,1,2\\}.\n$$\n\n由于 $L_i, L_{i+1} \\in \\{0,1\\}$，所以 $L_i - L_{i+1} \\in \\{-1,0,1\\}$，并且 $s_i = 1 - L_i + L_{i+1}$ 总是在 $\\{0,1,2\\}$ 集合中。对于给定的 $s_i$，分配外部键质子的方式数量为：\n\n$$\nw(s_i) = \\begin{cases} \n1  \\text{如果 } s_i = 0 \\text{ 或 } s_i = 2, \\\\\n2  \\text{如果 } s_i = 1.\n\\end{cases}\n$$\n\n因此，$w(1 - L_i + L_{i+1})$ 仅取决于 $L_i$ 和 $L_{i+1}$。\n\n$L_i$ 和 $L_{i+1}$ 状态的转移矩阵 $T$ 为：\n\n$$\nT = \\begin{pmatrix}\nT_{00}  T_{01} \\\\\nT_{10}  T_{11}\n\\end{pmatrix}, \\quad \\text{其中} \\quad T_{ab} = w(1 - a + b) \\quad \\text{对于} \\quad a,b \\in \\{0,1\\}。\n$$\n\n计算矩阵元素：\n- $a=0, b=0$: $s_i = 1 - 0 + 0 = 1$, $w(1) = 2$ → $T_{00} = 2$，\n- $a=0, b=1$: $s_i = 1 - 0 + 1 = 2$, $w(2) = 1$ → $T_{01} = 1$，\n- $a=1, b=0$: $s_i = 1 - 1 + 0 = 0$, $w(0) = 1$ → $T_{10} = 1$，\n- $a=1, b=1$: $s_i = 1 - 1 + 1 = 1$, $w(1) = 2$ → $T_{11} = 2$。\n\n所以：\n\n$$\nT = \\begin{pmatrix}\n2  1 \\\\\n1  2\n\\end{pmatrix}.\n$$\n\n\n具有周期性边界条件的环的构型总数为 $\\operatorname{Tr}(T^N)$。$T$ 的特征值满足：\n\n$$\n\\det(T - \\lambda I) = \\det\\begin{pmatrix} 2 - \\lambda  1 \\\\ 1  2 - \\lambda \\end{pmatrix} = (2 - \\lambda)^2 - 1 = \\lambda^2 - 4\\lambda + 3 = 0.\n$$\n\n解为：\n\n$$\n\\lambda = \\frac{4 \\pm \\sqrt{16 - 12}}{2} = \\frac{4 \\pm 2}{2} \\implies \\lambda_1 = 3, \\lambda_2 = 1.\n$$\n\n因此：\n\n$$\n\\operatorname{Tr}(T^N) = \\lambda_1^N + \\lambda_2^N = 3^N + 1^N = 3^N + 1.\n$$\n\n\n对于 $N = 10$：\n\n$$\n3^{10} + 1 = 59049 + 1 = 59050.\n$$\n\n这是允许的质子构型的总数，包括环内键和外部键的构型。", "answer": "$$\\boxed{59050}$$", "id": "123520"}, {"introduction": "这项高级实践练习连接了理论与计算，旨在量化氢键在热力学上的重要性。我们将运用热力学积分这一强大技术，在一个模拟体系中通过“炼金术转换”将一个氢键逐渐“关闭”，并计算其亥姆霍兹自由能的变化 $\\Delta F$。通过这个练习，你将学会如何将氢键相互作用的贡献分解为焓和熵，从而更深刻地洞察分子间相互作用的驱动力。[@problem_id:2773869]", "problem": "考虑一个温度为 $T$ 的等温正则系综，用于描述一个纳米尺度界面体系，其中吸附质与周围流体之间的氢键相互作用通过一个炼金术耦合参数 $\\lambda \\in [0,1]$ 进行调节。势能分解为 $U(\\lambda) = U_{\\text{nonhb}} + s(\\lambda)\\,U_{\\text{hb}}$，其中 $U_{\\text{nonhb}}$ 是力场中与 $\\lambda$ 无关的部分，而 $U_{\\text{hb}}$ 是氢键相互作用能项。耦合方案 $s(\\lambda)$ 满足 $s(1)=1$ 和 $s(0)=0$，因此 $\\lambda=1$ 对应于完全相互作用的氢键状态，而 $\\lambda=0$ 对应于氢键关闭的状态。亥姆霍兹自由能定义为 $F(\\lambda) = -k_{\\mathrm{B}} T \\ln Z(\\lambda)$，其中 $Z(\\lambda)$ 是在 $\\lambda$ 时的正则配分函数。目标是计算关闭氢键的自由能变化 $\\Delta F_{\\text{off}} = F(0)-F(1)$，然后从内能和熵的贡献角度来解释它。请从第一性原理出发，使用正则配分函数的定义以及 $U(\\lambda)$ 对 $\\lambda$ 的依赖性，推导出一个可计算的 $\\Delta F_{\\text{off}}$ 表达式和一个从系综平均值数值评估该表达式的算法。仅使用提供的可观测量平均值和指定的耦合方案，除了基本定义外不引入任何额外假设。\n\n您的程序必须为每个测试案例计算：\n- 关闭氢键的亥姆霍兹自由能变化，$\\Delta F_{\\text{off}}$（单位：kJ/mol）。\n- 相应的内能变化 $\\Delta U_{\\text{off}} = \\langle U_{\\text{tot}} \\rangle_{\\lambda=0} - \\langle U_{\\text{tot}} \\rangle_{\\lambda=1}$（单位：kJ/mol），其中 $\\langle U_{\\text{tot}} \\rangle_{\\lambda}$ 是在固定 $\\lambda$ 下的系综平均总势能。\n- 由 $\\Delta F_{\\text{off}} = \\Delta U_{\\text{off}} - T\\,\\Delta S_{\\text{off}}$ 定义的熵变 $\\Delta S_{\\text{off}}$（单位：kJ/(mol·K)）。\n\n所有数值答案必须以指定单位表示，并四舍五入到三位小数。\n\n您将获得离散的 $\\lambda$ 网格、相应的系综平均值 $\\langle U_{\\text{hb}} \\rangle_{\\lambda}$（单位：kJ/mol）、端点平均值 $\\langle U_{\\text{tot}} \\rangle_{\\lambda=0}$ 和 $\\langle U_{\\text{tot}} \\rangle_{\\lambda=1}$（单位：kJ/mol），以及耦合方案 $s(\\lambda)$。请使用适用于具有偶数个子区间的等间距 $\\lambda$ 网格的数值求积方案来评估您推导中出现的任何 $\\lambda$ 积分。假设在每个 $\\lambda$ 处的抽样已经平衡并且对于数值求积来说足够收敛。\n\n测试套件（四个案例）：\n\n案例 A（理想情况，线性耦合）：\n- 温度 $T = 298.0\\,\\mathrm{K}$。\n- 耦合方案 $s(\\lambda) = \\lambda$ for $\\lambda \\in [0,1]$。\n- $\\lambda$-网格: $[0.0,\\,0.1,\\,0.2,\\,0.3,\\,0.4,\\,0.5,\\,0.6,\\,0.7,\\,0.8,\\,0.9,\\,1.0]$。\n- $\\langle U_{\\text{hb}} \\rangle_{\\lambda}$ (kJ/mol): $[-0.2,\\,-1.8,\\,-3.5,\\,-5.0,\\,-6.5,\\,-8.0,\\,-9.3,\\,-10.6,\\,-11.9,\\,-13.2,\\,-14.5]$。\n- $\\langle U_{\\text{tot}} \\rangle_{\\lambda=0} = -250.0\\,\\mathrm{kJ/mol}$, $\\langle U_{\\text{tot}} \\rangle_{\\lambda=1} = -262.0\\,\\mathrm{kJ/mol}$。\n\n案例 B（边界情况，氢键可忽略，线性耦合）：\n- 温度 $T = 298.0\\,\\mathrm{K}$。\n- 耦合方案 $s(\\lambda) = \\lambda$。\n- $\\lambda$-网格: $[0.0,\\,0.25,\\,0.5,\\,0.75,\\,1.0]$。\n- $\\langle U_{\\text{hb}} \\rangle_{\\lambda}$ (kJ/mol): $[0.0,\\,-0.1,\\,-0.2,\\,-0.1,\\,0.0]$。\n- $\\langle U_{\\text{tot}} \\rangle_{\\lambda=0} = -150.0\\,\\mathrm{kJ/mol}$, $\\langle U_{\\text{tot}} \\rangle_{\\lambda=1} = -150.2\\,\\mathrm{kJ/mol}$。\n\n案例 C（较低温度下更强的氢键作用，线性耦合）：\n- 温度 $T = 260.0\\,\\mathrm{K}$。\n- 耦合方案 $s(\\lambda) = \\lambda$。\n- $\\lambda$-网格: $[0.0,\\,0.125,\\,0.25,\\,0.375,\\,0.5,\\,0.625,\\,0.75,\\,0.875,\\,1.0]$。\n- $\\langle U_{\\text{hb}} \\rangle_{\\lambda}$ (kJ/mol): $[-0.5,\\,-4.0,\\,-8.0,\\,-12.0,\\,-16.0,\\,-20.0,\\,-24.0,\\,-27.0,\\,-30.0]$。\n- $\\langle U_{\\text{tot}} \\rangle_{\\lambda=0} = -300.0\\,\\mathrm{kJ/mol}$, $\\langle U_{\\text{tot}} \\rangle_{\\lambda=1} = -322.5\\,\\mathrm{kJ/mol}$。\n\n案例 D（非线性耦合，在 $\\lambda=0$ 附近软化）：\n- 温度 $T = 300.0\\,\\mathrm{K}$。\n- 耦合方案 $s(\\lambda) = \\lambda^{2}$。\n- $\\lambda$-网格: $[0.0,\\,0.1,\\,0.2,\\,0.3,\\,0.4,\\,0.5,\\,0.6,\\,0.7,\\,0.8,\\,0.9,\\,1.0]$。\n- $\\langle U_{\\text{hb}} \\rangle_{\\lambda}$ (kJ/mol): $[0.0,\\,-0.5,\\,-2.0,\\,-4.2,\\,-6.8,\\,-9.5,\\,-12.0,\\,-14.0,\\,-16.0,\\,-18.0,\\,-20.0]$。\n- $\\langle U_{\\text{tot}} \\rangle_{\\lambda=0} = -500.0\\,\\mathrm{kJ/mol}$, $\\langle U_{\\text{tot}} \\rangle_{\\lambda=1} = -510.0\\,\\mathrm{kJ/mol}$。\n\n要求的最终输出格式：\n- 您的程序应生成单行输出，其中包含按 A、B、C、D 顺序排列的各案例结果列表。每个案例的结果必须是一个 $[\\Delta F_{\\text{off}}, \\Delta U_{\\text{off}}, \\Delta S_{\\text{off}}]$ 列表，其中 $\\Delta F_{\\text{off}}$ 和 $\\Delta U_{\\text{off}}$ 的单位为 kJ/mol，$\\Delta S_{\\text{off}}$ 的单位为 kJ/(mol·K)，数值均四舍五入到三位小数。例如：$[[x_1,y_1,z_1],[x_2,y_2,z_2],[x_3,y_3,z_3],[x_4,y_4,z_4]]$。", "solution": "**控制方程的推导**\n\n亥姆霍兹自由能 $F(\\lambda)$ 由下式给出：\n$$F(\\lambda) = -k_{\\mathrm{B}} T \\ln Z(\\lambda)$$\n其中 $k_{\\mathrm{B}}$ 是玻尔兹曼常数，$T$ 是绝对温度，$Z(\\lambda)$ 是在给定耦合参数 $\\lambda$ 值下的正则配分函数。相关的依赖关系在于构型积分：\n$$Z(\\lambda) \\propto \\int d\\mathbf{q} \\, \\exp\\left(-\\frac{U(\\mathbf{q}, \\lambda)}{k_{\\mathrm{B}}T}\\right)$$\n为了找到自由能的变化，我们首先对 $F(\\lambda)$ 关于 $\\lambda$ 求导：\n$$\\frac{\\partial F}{\\partial \\lambda} = -k_{\\mathrm{B}} T \\frac{1}{Z(\\lambda)} \\frac{\\partial Z}{\\partial \\lambda} = \\frac{\\int d\\mathbf{q} \\, \\frac{\\partial U(\\mathbf{q}, \\lambda)}{\\partial \\lambda} \\exp\\left(-\\frac{U(\\mathbf{q}, \\lambda)}{k_{\\mathrm{B}}T}\\right)}{\\int d\\mathbf{q} \\, \\exp\\left(-\\frac{U(\\mathbf{q}, \\lambda)}{k_{\\mathrm{B}}T}\\right)}$$\n这是势能关于 $\\lambda$ 的导数的正则系综平均值的定义。因此，我们得到了热力学积分的基本关系：\n$$\\frac{\\partial F}{\\partial \\lambda} = \\left\\langle \\frac{\\partial U}{\\partial \\lambda} \\right\\rangle_{\\lambda}$$\n势能给出为 $U(\\lambda) = U_{\\text{nonhb}} + s(\\lambda)U_{\\text{hb}}$。对 $\\lambda$ 求导得到：\n$$\\frac{\\partial U}{\\partial \\lambda} = \\frac{\\partial s(\\lambda)}{\\partial \\lambda} U_{\\text{hb}} = s'(\\lambda) U_{\\text{hb}}$$\n因此，自由能导数变为：\n$$\\frac{\\partial F}{\\partial \\lambda} = \\left\\langle s'(\\lambda) U_{\\text{hb}} \\right\\rangle_{\\lambda} = s'(\\lambda) \\left\\langle U_{\\text{hb}} \\right\\rangle_{\\lambda}$$\n因为 $s'(\\lambda)$ 是 $\\lambda$ 的一个确定性函数，不随系统的微观状态波动。\n\n关闭氢键的总自由能变化 $\\Delta F_{\\text{off}} = F(\\lambda=0) - F(\\lambda=1)$，可以通过将此导数从 $\\lambda = 1$ 到 $\\lambda = 0$ 积分得到：\n$$\\Delta F_{\\text{off}} = \\int_{1}^{0} \\frac{\\partial F}{\\partial \\lambda} d\\lambda = \\int_{1}^{0} s'(\\lambda) \\left\\langle U_{\\text{hb}} \\right\\rangle_{\\lambda} d\\lambda = - \\int_{0}^{1} s'(\\lambda) \\left\\langle U_{\\text{hb}} \\right\\rangle_{\\lambda} d\\lambda$$\n这是待计算的最终表达式。\n\n**热力学分解**\n\n关闭氢键时内能的变化直接由端点平均值给出：\n$$\\Delta U_{\\text{off}} = \\langle U_{\\text{tot}} \\rangle_{\\lambda=0} - \\langle U_{\\text{tot}} \\rangle_{\\lambda=1}$$\n连接这些量的基本热力学关系是 $\\Delta F = \\Delta U - T\\Delta S$。对于关闭氢键的过程，这表示为：\n$$\\Delta F_{\\text{off}} = \\Delta U_{\\text{off}} - T \\Delta S_{\\text{off}}$$\n重新整理以求解熵变 $\\Delta S_{\\text{off}}$，得到：\n$$\\Delta S_{\\text{off}} = \\frac{\\Delta U_{\\text{off}} - \\Delta F_{\\text{off}}}{T}$$\n\n**计算算法**\n\n数值评估按以下步骤进行：\n1. 对于每个测试案例，确定温度 $T$、耦合方案的导数 $s'(\\lambda)$、$\\lambda$ 网格以及相应的平均能量。\n2. 对于网格上的每个点 $\\lambda_i$，计算被积函数的值 $I_i = s'(\\lambda_i) \\langle U_{\\text{hb}} \\rangle_{\\lambda_i}$。\n3. 使用辛普森1/3法则，根据离散值数值计算积分 $W = \\int_{0}^{1} I(\\lambda) d\\lambda$。\n4. 计算亥姆霍兹自由能变化：$\\Delta F_{\\text{off}} = -W$。\n5. 计算内能变化：$\\Delta U_{\\text{off}} = \\langle U_{\\text{tot}} \\rangle_{\\lambda=0} - \\langle U_{\\text{tot}} \\rangle_{\\lambda=1}$。\n6. 计算熵变：$\\Delta S_{\\text{off}} = (\\Delta U_{\\text{off}} - \\Delta F_{\\text{off}}) / T$。\n7. 将结果格式化并四舍五入到三位小数。\n\n以下是实现该算法的Python代码：\n```python\nimport numpy as np\nfrom scipy.integrate import simpson\n\ndef solve():\n    \"\"\"\n    Solves the thermodynamic integration problem for the given test cases.\n    \"\"\"\n\n    test_cases = [\n        {\n            \"T\": 298.0,\n            \"s_prime\": lambda l: 1.0,\n            \"lambdas\": np.array([0.0, 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1.0]),\n            \"U_hb\": np.array([-0.2, -1.8, -3.5, -5.0, -6.5, -8.0, -9.3, -10.6, -11.9, -13.2, -14.5]),\n            \"U_tot_0\": -250.0,\n            \"U_tot_1\": -262.0,\n        },\n        {\n            \"T\": 298.0,\n            \"s_prime\": lambda l: 1.0,\n            \"lambdas\": np.array([0.0, 0.25, 0.5, 0.75, 1.0]),\n            \"U_hb\": np.array([0.0, -0.1, -0.2, -0.1, 0.0]),\n            \"U_tot_0\": -150.0,\n            \"U_tot_1\": -150.2,\n        },\n        {\n            \"T\": 260.0,\n            \"s_prime\": lambda l: 1.0,\n            \"lambdas\": np.array([0.0, 0.125, 0.25, 0.375, 0.5, 0.625, 0.75, 0.875, 1.0]),\n            \"U_hb\": np.array([-0.5, -4.0, -8.0, -12.0, -16.0, -20.0, -24.0, -27.0, -30.0]),\n            \"U_tot_0\": -300.0,\n            \"U_tot_1\": -322.5,\n        },\n        {\n            \"T\": 300.0,\n            \"s_prime\": lambda l: 2 * l,\n            \"lambdas\": np.array([0.0, 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1.0]),\n            \"U_hb\": np.array([0.0, -0.5, -2.0, -4.2, -6.8, -9.5, -12.0, -14.0, -16.0, -18.0, -20.0]),\n            \"U_tot_0\": -500.0,\n            \"U_tot_1\": -510.0,\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        T = case[\"T\"]\n        s_prime = case[\"s_prime\"]\n        lambdas = case[\"lambdas\"]\n        U_hb_values = case[\"U_hb\"]\n        U_tot_0 = case[\"U_tot_0\"]\n        U_tot_1 = case[\"U_tot_1\"]\n\n        integrand = s_prime(lambdas) * U_hb_values\n        integral_value = simpson(y=integrand, x=lambdas)\n        \n        delta_F_off = -integral_value\n        delta_U_off = U_tot_0 - U_tot_1\n        delta_S_off = (delta_U_off - delta_F_off) / T\n\n        results.append([\n            round(delta_F_off, 3),\n            round(delta_U_off, 3),\n            round(delta_S_off, 3)\n        ])\n    \n    formatted_results = []\n    for r in results:\n        # Format each number to 3 decimal places\n        formatted_r = f\"[{r[0]:.3f},{r[1]:.3f},{r[2]:.3f}]\"\n        formatted_results.append(formatted_r)\n\n    # Print the final result string\n    # print(f\"[{','.join(formatted_results)}]\")\n```", "answer": "[[7.803,12.000,0.014],[0.117,0.200,0.000],[15.896,22.500,0.025],[11.754,10.000,-0.006]]", "id": "2773869"}]}