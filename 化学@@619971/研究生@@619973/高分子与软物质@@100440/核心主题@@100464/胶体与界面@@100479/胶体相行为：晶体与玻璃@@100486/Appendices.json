{"hands_on_practices": [{"introduction": "本练习将深入探讨控制胶体晶体结构的基本几何约束。堆积分数 $\\phi$ 是决定硬球体系相态的关键参数。本练习将指导你从第一性原理出发，推导球体可能达到的最大堆积分数——这是一个被称为开普勒猜想的里程碑式结果，也是理解致密颗粒物质的关键基准。你还将使用 Steinhardt 键序参数来定量地区分高度有序的晶体结构和无序的随机密堆积状态。[@problem_id:2909316]", "problem": "一种由无吸引力的硬胶体球组成的单分散悬浮液，在最大堆积时表现出晶体面心立方 (fcc) 或六方密堆积 (hcp) 序，并形成一种称为随机密堆积 (RCP) 的机械稳定的无序堵塞态。请考虑以下情况：\n\n1. 堆积分数定义为 $\\phi = V_{\\text{spheres}}/V_{\\text{cell}}$。对于由半径为 $R$ 的硬球组成的 fcc 晶体，边长为 $a$ 的立方晶胞总共包含 $4$ 个球体，在密堆积时，球体沿面-对角线发生几何接触。\n\n2. 单分散硬球的随机密堆积分数取为 $\\phi_{\\text{RCP}} = 0.64$。\n\n3. 为量化结构有序性，使用 Steinhardt 六阶键取向序参数 $Q_{6}$，其全局定义为\n$$\nQ_{6} = \\left(\\frac{4\\pi}{13}\\sum_{m=-6}^{6} \\left| \\left\\langle Y_{6m}(\\theta,\\varphi) \\right\\rangle \\right|^{2}\\right)^{1/2},\n$$\n其中 $\\left\\langle \\cdot \\right\\rangle$ 表示对由每个粒子的 $12$ 个最近邻所定义的键进行平均，然后再对所有粒子进行平均，而 $Y_{6m}$ 是 $6$ 阶球谐函数。对于具有 $12$ 个近邻的完美晶体，取 $Q_{6}^{\\text{fcc}} = 0.5745$，$Q_{6}^{\\text{hcp}} = 0.4848$。对于无序随机密堆积，取 $Q_{6}^{\\text{RCP}} = 0.2700$。\n\n4. 对于结构 $s \\in \\{\\text{fcc},\\text{hcp}\\}$，定义一个结合了堆积和键取向序的无量纲对比度指数，如下所示：\n$$\nC_{s} = \\left[ \\left( \\frac{\\phi_{s} - \\phi_{\\text{RCP}}}{\\phi_{\\text{cp}}} \\right)^{2} + \\left( \\frac{Q_{6}^{s} - Q_{6}^{\\text{RCP}}}{Q_{6}^{\\text{fcc}} - Q_{6}^{\\text{RCP}}} \\right)^{2} \\right]^{1/2},\n$$\n其中 $\\phi_{\\text{cp}}$ 是 fcc/hcp 结构的最大密堆积分数，且对于 fcc 和 hcp 两种结构，$\\phi_{s} = \\phi_{\\text{cp}}$。\n\n任务：\na) 从 fcc 晶格中硬球接触的几何约束出发，推导出 $\\phi_{\\text{cp}}$ 的闭合形式解。\nb) 使用给定的 $Q_{6}$ 值，计算比值\n$$\n\\mathcal{R} = \\frac{C_{\\text{fcc}}}{C_{\\text{hcp}}}.\n$$\n将您计算出的 $\\mathcal{R}$ 的最终答案表示为单个无量纲数，并四舍五入到四位有效数字。最终答案无需单位。", "solution": "该问题经核实，科学上合理、提问清晰且信息完整。我们将按要求分两部分进行解答。\n\na) 部分要求推导密堆积结构（具体为面心立方 (fcc) 晶格）的堆积分数 $\\phi_{\\text{cp}}$。堆积分数 $\\phi$ 定义为晶胞内所有球体的总体积与晶胞本身体积之比：\n$$\n\\phi = \\frac{V_{\\text{spheres}}}{V_{\\text{cell}}}\n$$\n对于半径为 $R$ 的单个球体，其体积为 $V_{\\text{sphere}} = \\frac{4}{3}\\pi R^{3}$。\n问题指出，fcc 晶胞总共包含 $N=4$ 个球体。这是晶体学中的一个已知结论，对应于 $8$ 个顶点球（每个对晶胞的贡献为 $1/8$）和 $6$ 个面心球（每个对晶胞的贡献为 $1/2$），总计 $8 \\times \\frac{1}{8} + 6 \\times \\frac{1}{2} = 1 + 3 = 4$ 个球体。\n因此，晶胞内球体所占的总体积为：\n$$\nV_{\\text{spheres}} = N \\times V_{\\text{sphere}} = 4 \\times \\frac{4}{3}\\pi R^{3} = \\frac{16}{3}\\pi R^{3}\n$$\n立方晶胞的体积为 $V_{\\text{cell}} = a^{3}$，其中 $a$ 是晶格常数或立方体的边长。为了确定 $\\phi$，我们必须将 $a$ 与 $R$ 联系起来。问题明确指出，对于硬球的密堆积排列，接触发生在立方晶胞的面-对角线上。\n\n对于边长为 $a$ 的立方体，其面-对角线的长度 $d$ 可由勾股定理给出：$d^{2} = a^{2} + a^{2} = 2a^{2}$，即 $d = a\\sqrt{2}$。\n沿着这条对角线，一个位于顶角的球体、一个位于面心的球体和位于相对顶角的球体三者相切。因此，整个对角线的长度包含第一个顶角球的半径、面心球的完整直径以及第二个顶角球的半径。\n因此，用球体半径 $R$ 表示的面-对角线长度为：\n$$\nd = R + 2R + R = 4R\n$$\n通过令两个关于对角线长度的表达式相等，我们建立了 $a$ 与 $R$ 之间的关系：\n$$\na\\sqrt{2} = 4R\n$$\n解出 $a$，我们得到：\n$$\na = \\frac{4R}{\\sqrt{2}} = 2\\sqrt{2}R\n$$\n现在，我们可以计算晶胞的体积：\n$$\nV_{\\text{cell}} = a^{3} = (2\\sqrt{2}R)^{3} = 2^{3}(\\sqrt{2})^{3}R^{3} = 8(2\\sqrt{2})R^{3} = 16\\sqrt{2}R^{3}\n$$\n最后，我们将 $V_{\\text{spheres}}$ 和 $V_{\\text{cell}}$ 的表达式代入堆积分数的定义中，求得密堆积分数 $\\phi_{\\text{cp}}$：\n$$\n\\phi_{\\text{cp}} = \\frac{V_{\\text{spheres}}}{V_{\\text{cell}}} = \\frac{\\frac{16}{3}\\pi R^{3}}{16\\sqrt{2}R^{3}}\n$$\n$16$ 和 $R^{3}$ 项相互消去，得到精确的闭合形式结果：\n$$\n\\phi_{\\text{cp}} = \\frac{\\pi}{3\\sqrt{2}}\n$$\n这是单分散球体可能的最大堆积分数，fcc 和 hcp 结构均可达到此值。\n\nb) 部分要求计算比值 $\\mathcal{R} = C_{\\text{fcc}}/C_{\\text{hcp}}$。对比度指数 $C_{s}$ 定义为：\n$$\nC_{s} = \\left[ \\left( \\frac{\\phi_{s} - \\phi_{\\text{RCP}}}{\\phi_{\\text{cp}}} \\right)^{2} + \\left( \\frac{Q_{6}^{s} - Q_{6}^{\\text{RCP}}}{Q_{6}^{\\text{fcc}} - Q_{6}^{\\text{RCP}}} \\right)^{2} \\right]^{1/2}\n$$\n问题明确指出，对于两种晶体结构，$\\phi_{s} = \\phi_{\\text{cp}}$。我们首先计算 $C_{\\text{fcc}}$。对于 $s = \\text{fcc}$，我们有 $\\phi_{s} = \\phi_{\\text{fcc}} = \\phi_{\\text{cp}}$ 和 $Q_{6}^{s} = Q_{6}^{\\text{fcc}}$。\n$$\nC_{\\text{fcc}} = \\left[ \\left( \\frac{\\phi_{\\text{cp}} - \\phi_{\\text{RCP}}}{\\phi_{\\text{cp}}} \\right)^{2} + \\left( \\frac{Q_{6}^{\\text{fcc}} - Q_{6}^{\\text{RCP}}}{Q_{6}^{\\text{fcc}} - Q_{6}^{\\text{RCP}}} \\right)^{2} \\right]^{1/2}\n$$\n方括号中的第二项简化为 $1^{2}=1$。因此：\n$$\nC_{\\text{fcc}} = \\left[ \\left( 1 - \\frac{\\phi_{\\text{RCP}}}{\\phi_{\\text{cp}}} \\right)^{2} + 1 \\right]^{1/2}\n$$\n接下来，我们计算 $C_{\\text{hcp}}$。对于 $s = \\text{hcp}$，我们有 $\\phi_{s} = \\phi_{\\text{hcp}} = \\phi_{\\text{cp}}$ 和 $Q_{6}^{s} = Q_{6}^{\\text{hcp}}$。\n$$\nC_{\\text{hcp}} = \\left[ \\left( \\frac{\\phi_{\\text{cp}} - \\phi_{\\text{RCP}}}{\\phi_{\\text{cp}}} \\right)^{2} + \\left( \\frac{Q_{6}^{\\text{hcp}} - Q_{6}^{\\text{RCP}}}{Q_{6}^{\\text{fcc}} - Q_{6}^{\\text{RCP}}} \\right)^{2} \\right]^{1/2}\n$$\n第一项与 $C_{\\text{fcc}}$ 中的相同。为了清晰起见，我们定义以下无量纲量：\n$$\nX = 1 - \\frac{\\phi_{\\text{RCP}}}{\\phi_{\\text{cp}}}\n$$\n$$\nY = \\frac{Q_{6}^{\\text{hcp}} - Q_{6}^{\\text{RCP}}}{Q_{6}^{\\text{fcc}} - Q_{6}^{\\text{RCP}}}\n$$\n根据这些定义，表达式变为：\n$$\nC_{\\text{fcc}} = \\left( X^{2} + 1 \\right)^{1/2}\n$$\n$$\nC_{\\text{hcp}} = \\left( X^{2} + Y^{2} \\right)^{1/2}\n$$\n所求的比值为：\n$$\n\\mathcal{R} = \\frac{C_{\\text{fcc}}}{C_{\\text{hcp}}} = \\frac{\\left( X^{2} + 1 \\right)^{1/2}}{\\left( X^{2} + Y^{2} \\right)^{1/2}} = \\left( \\frac{X^{2} + 1}{X^{2} + Y^{2}} \\right)^{1/2}\n$$\n现在我们代入所提供和推导出的数值：\n$\\phi_{\\text{cp}} = \\frac{\\pi}{3\\sqrt{2}} \\approx 0.740480$\n$\\phi_{\\text{RCP}} = 0.64$\n$Q_{6}^{\\text{fcc}} = 0.5745$\n$Q_{6}^{\\text{hcp}} = 0.4848$\n$Q_{6}^{\\text{RCP}} = 0.2700$\n\n首先，计算 $X$：\n$$\nX = 1 - \\frac{0.64}{\\pi/(3\\sqrt{2})} = 1 - \\frac{0.64 \\times 3\\sqrt{2}}{\\pi} \\approx 1 - \\frac{1.92 \\times 1.414214}{3.141593} \\approx 1 - 0.864303 \\approx 0.135697\n$$\n所以，$X^{2} \\approx (0.135697)^{2} \\approx 0.0184136$。\n\n接着，计算 $Y$：\n$$\nY = \\frac{0.4848 - 0.2700}{0.5745 - 0.2700} = \\frac{0.2148}{0.3045} \\approx 0.7054187\n$$\n所以，$Y^{2} \\approx (0.7054187)^{2} \\approx 0.497616$。\n\n现在我们计算比值 $\\mathcal{R}$：\n$$\n\\mathcal{R} = \\left( \\frac{0.0184136 + 1}{0.0184136 + 0.497616} \\right)^{1/2} = \\left( \\frac{1.0184136}{0.5160296} \\right)^{1/2} \\approx (1.97355)^{1/2} \\approx 1.404831\n$$\n按要求将结果四舍五入到四位有效数字，我们得到 $1.405$。", "answer": "$$\n\\boxed{1.405}\n$$", "id": "2909316"}, {"introduction": "在探索了单组分硬球之后，我们现在通过添加第二种组分——非吸附性聚合物——来增加系统的复杂性。这会在胶体之间产生一种有效的吸引力，即所谓的耗尽相互作用，这是一个纯粹由熵驱动的力的经典例子。本练习将指导你运用开创性的 Asakura-Oosawa 模型来量化该势的强度和范围，揭示宏观热力学（渗透压）如何决定微观粒子间的相互作用，并驱动相分离的发生。[@problem_id:2909337]", "problem": "将半径为 $a$ 的硬球胶体的单分散悬浮液与回转半径为 $R_{g}$ 的非吸附性理想聚合物线团的稀溶液在绝对温度 $T$ 下混合。假设聚合物-胶体相互作用纯粹是排除体积作用，并且每个胶体都被一个厚度等于聚合物回转半径的聚合物耗尽层所包围，因此排除半径为 $R_{\\mathrm{ex}}=a+R_{g}$。聚合物线团的数密度为 $\\rho_{p}$，因此在稀疏理想状态下，溶液的渗透压仅由聚合物的平移熵决定。考虑两个胶体在中心距为 $d$ 时的对相互作用。耗尽吸引力源于其聚合物排除区域的重叠。\n\n从理想聚合物溶液的渗透压和两个半径为 $R_{\\mathrm{ex}}$ 的等大球体重叠的几何形状出发，推导接触时的耗尽对势及其作用范围。然后，使用以下参数计算这些量的值：$a=5.00\\times 10^{-7}\\,\\mathrm{m}$，$R_{g}=5.00\\times 10^{-8}\\,\\mathrm{m}$，$\\rho_{p}=3.58\\times 10^{20}\\,\\mathrm{m}^{-3}$ 以及 $T=298\\,\\mathrm{K}$。定义聚合物-胶体尺寸比 $q=R_{g}/a$，并在得到接触时的结果后，表述对于一般的 $q$ 以及在 $q\\ll 1$ 的极限情况下，接触势阱深度如何随 $q$ 标度。\n\n答案规格：\n- 以 $k_{B}T$ 为单位，报告接触势阱深度的无量纲数值，即报告 $U_{\\mathrm{dep}}(0)/(k_{B}T)$。\n- 以 $a$ 为单位，报告相互作用范围的无量纲数值，即报告 $h_{r}/a$。\n- 将两个无量纲数均四舍五入至三位有效数字。\n- 对于随 $q$ 变化的标度关系的讨论，请在演算过程中用文字给出你的推理，但不要将其包含在最终的数值答案中。", "solution": "经评估，该问题陈述具有科学依据，提法恰当且内部一致。该问题提出了软物质物理学中的一个标准模型，即Asakura-Oosawa模型，可以从第一性原理推导出其唯一解。我们将进行推导。\n\n该问题要求计算浸没在回转半径为 $R_g$ 的理想、非吸附性聚合物线团稀溶液中的两个半径为 $a$ 的硬球胶体之间的耗尽对势。聚合物数密度为 $\\rho_p$，温度为 $T$。\n\n耗尽相互作用源于渗透压的不平衡。每个胶体周围都存在一个厚度为 $R_g$ 的聚合物耗尽层。因此，每个胶体都被一个半径为 $R_{\\mathrm{ex}} = a + R_g$ 的有效排除球包裹。当两个这样的胶体靠近，中心距 $d < 2R_{\\mathrm{ex}}$ 时，它们的排除球会发生重叠。这个之前聚合物线团中心无法进入的重叠区域，现在变得可以进入。聚合物可接触体积的增加导致其平移熵增加，相应地系统自由能降低。这种自由能的降低表现为胶体之间的一种吸引势。\n\n自由能的变化即为耗尽势 $U_{\\mathrm{dep}}(d)$，它等于聚合物库的渗透压 $\\Pi$ 填充新产生的可用体积 $V_{\\mathrm{overlap}}(d)$ 所做功的负值。\n$$U_{\\mathrm{dep}}(d) = -\\Pi V_{\\mathrm{overlap}}(d)$$\n对于稀疏的理想聚合物溶液，渗透压由范特霍夫定律给出：\n$$\\Pi = \\rho_p k_B T$$\n其中 $k_B$ 是玻尔兹曼常数。\n\n因此，相互作用势为：\n$$U_{\\mathrm{dep}}(d) = -\\rho_p k_B T V_{\\mathrm{overlap}}(d)$$\n只有在排除球重叠但胶体硬核不重叠的范围内，该势才不为零。这对应于中心距范围 $2a \\le d \\le 2R_{\\mathrm{ex}}$。当 $d > 2R_{\\mathrm{ex}}$ 时，$V_{\\mathrm{overlap}}(d) = 0$，因此 $U_{\\mathrm{dep}}(d) = 0$。当 $d < 2a$ 时，硬球势为无穷大。\n\n两个半径为 $R_{\\mathrm{ex}}$、中心距为 $d$ 的球体的相交体积是一个标准的几何结果：\n$$V_{\\mathrm{overlap}}(d) = \\frac{4\\pi}{3}R_{\\mathrm{ex}}^3 \\left(1 - \\frac{3d}{4R_{\\mathrm{ex}}} + \\frac{d^3}{16R_{\\mathrm{ex}}^3}\\right)$$\n问题要求计算接触时的势，这对应于硬核接触，即 $d=2a$。我们将此势记为 $U_{contact}$。\n$$U_{contact} = U_{\\mathrm{dep}}(d=2a) = -\\rho_p k_B T V_{\\mathrm{overlap}}(d=2a)$$\n我们将 $d=2a$ 代入 $V_{\\mathrm{overlap}}(d)$ 的表达式中：\n$$V_{\\mathrm{overlap}}(d=2a) = \\frac{4\\pi}{3}R_{\\mathrm{ex}}^3 \\left(1 - \\frac{3(2a)}{4R_{\\mathrm{ex}}} + \\frac{(2a)^3}{16R_{\\mathrm{ex}}^3}\\right) = \\frac{4\\pi}{3}R_{\\mathrm{ex}}^3 \\left(1 - \\frac{3a}{2R_{\\mathrm{ex}}} + \\frac{a^3}{2R_{\\mathrm{ex}}^3}\\right)$$\n为简化此表达式，我们引入聚合物-胶体尺寸比 $q = R_g/a$。由此得到 $R_{\\mathrm{ex}} = a+R_g = a(1+q)$。将此代入接触体积的表达式：\n$$V_{\\mathrm{overlap}}(d=2a) = \\frac{4\\pi}{3}(a(1+q))^3 \\left(1 - \\frac{3a}{2a(1+q)} + \\frac{a^3}{2(a(1+q))^3}\\right)$$\n$$V_{\\mathrm{overlap}}(d=2a) = \\frac{4\\pi a^3}{3}(1+q)^3 \\left(1 - \\frac{3}{2(1+q)} + \\frac{1}{2(1+q)^3}\\right)$$\n我们合并括号中的各项：\n$$\\frac{2(1+q)^3 - 3(1+q)^2 + 1}{2(1+q)^3} = \\frac{2(1+3q+3q^2+q^3) - 3(1+2q+q^2) + 1}{2(1+q)^3}$$\n$$= \\frac{(2+6q+6q^2+2q^3) - (3+6q+3q^2) + 1}{2(1+q)^3} = \\frac{3q^2+2q^3}{2(1+q)^3} = \\frac{q^2(3+2q)}{2(1+q)^3}$$\n将此结果代回体积表达式：\n$$V_{\\mathrm{overlap}}(d=2a) = \\frac{4\\pi a^3}{3}(1+q)^3 \\left(\\frac{q^2(3+2q)}{2(1+q)^3}\\right) = \\frac{2\\pi a^3}{3} q^2(3+2q)$$\n因此，无量纲接触势为：\n$$\\frac{U_{contact}}{k_B T} = -\\rho_p \\frac{V_{\\mathrm{overlap}}(d=2a)}{1} = -\\rho_p \\frac{2\\pi a^3}{3} q^2(3+2q)$$\n这就是所求的表达式。问题中使用的记号 $U_{\\mathrm{dep}}(0)$ 被解释为表面间距为零时的势，等效于 $d=2a$。\n\n相互作用范围 $h_r$ 是势不为零的最大表面间距。相互作用在 $d = 2R_{\\mathrm{ex}} = 2(a+R_g)$ 时开始。表面间距为 $h_s = d-2a$。其最大值是 $h_r = 2(a+R_g) - 2a = 2R_g$。\n无量纲相互作用范围是：\n$$\\frac{h_r}{a} = \\frac{2R_g}{a} = 2q$$\n\n现在我们使用给定参数计算这些量的值：$a=5.00\\times 10^{-7}\\,\\mathrm{m}$，$R_{g}=5.00\\times 10^{-8}\\,\\mathrm{m}$，$\\rho_{p}=3.58\\times 10^{20}\\,\\mathrm{m}^{-3}$以及 $T=298\\,\\mathrm{K}$。\n首先，我们计算尺寸比 $q$：\n$$q = \\frac{R_g}{a} = \\frac{5.00\\times 10^{-8}\\,\\mathrm{m}}{5.00\\times 10^{-7}\\,\\mathrm{m}} = 0.100$$\n无量纲相互作用范围是：\n$$\\frac{h_r}{a} = 2q = 2(0.100) = 0.200$$\n接下来，我们计算无量纲接触势阱深度：\n$$\\frac{U_{contact}}{k_B T} = -\\rho_p \\frac{2\\pi a^3}{3} q^2(3+2q)$$\n$$\\frac{U_{contact}}{k_B T} = -(3.58\\times 10^{20}\\,\\mathrm{m}^{-3}) \\frac{2\\pi (5.00\\times 10^{-7}\\,\\mathrm{m})^3}{3} (0.100)^2 (3+2(0.100))$$\n$$\\frac{U_{contact}}{k_B T} = -(3.58\\times 10^{20}) \\frac{2\\pi (1.25\\times 10^{-19}\\,\\mathrm{m}^3)}{3} (0.0100) (3.20) \\approx -2.9991$$\n四舍五入到三位有效数字，我们得到 $-3.00$。\n\n最后，我们分析接触势阱深度随尺寸比 $q$ 的标度关系。接触势的量值为 $|U_{contact}| \\propto q^2(3+2q)$。\n对于一般的 $q$，势阱深度按 $q^2(3+2q)$ 标度。\n在小聚合物极限下，$q \\ll 1$，该表达式得以简化。我们可以近似 $3+2q \\approx 3$。标度关系变为：\n$$|U_{contact}| \\propto q^2 \\quad (\\text{对于 } q \\ll 1)$$\n这被称为蛋白质极限或胶体极限。\n在大聚合物的相反极限下，$q \\gg 1$，我们可以近似 $3+2q \\approx 2q$。标度关系变为：\n$$|U_{contact}| \\propto q^2(2q) = 2q^3 \\quad (\\text{对于 } q \\gg 1)$$\n这被称为聚合物极限。问题特别要求的是一般情况和 $q \\ll 1$ 的极限。", "answer": "$$\n\\boxed{\\begin{pmatrix}-3.00 & 0.200\\end{pmatrix}}\n$$", "id": "2909337"}, {"introduction": "本练习旨在连接理论/计算模型与实验可观测量。计算机模拟通常计算实空间中的对关联函数 $g(r)$，而散射实验则直接测量倒易空间中的静态结构因子 $S(q)$。这项练习包含一个实践性的编程任务：实现连接这两个基本函数的数值傅里叶变换，让你亲身体验如何处理有限尺寸效应等常见的数值伪影，并学习应用窗函数来提高数据准确性。[@problem_id:2909330]", "problem": "你的任务是仅使用基本定义和数值积分方法，从一个径向采样的对相关函数 $g(r)$ 出发，计算三维各向同性胶体流体的静态结构因子 $S(q)$。你的目标是实现一个程序，该程序针对一组指定的截断半径和窗函数，计算 $S(q)$ 的第一主峰的高度，并报告该高度如何随着截断和窗函数的选择而变化。你必须确保所选离散化和近似方法的数值稳定性和科学合理性。\n\n从以下基本原理开始：\n\n- 静态结构因子 $S(q)$ 由微观密度涨落定义为 $S(q) = \\frac{1}{N} \\left\\langle \\sum_{j=1}^{N} \\sum_{k=1}^{N} e^{-i \\mathbf{q}\\cdot(\\mathbf{r}_j - \\mathbf{r}_k)} \\right\\rangle$，其中波矢大小为 $q = \\lvert \\mathbf{q} \\rvert$。\n- 对相关函数 $g(r)$ 的定义是，在一个参考粒子周围，半径为 $r$、厚度为 $\\mathrm{d} r$ 的球壳内，粒子的平均数量为 $4\\pi \\rho r^2 g(r) \\mathrm{d} r$，其中 $\\rho$ 是数密度， $r=\\lvert \\mathbf{r} \\rvert$。\n- 使用分解 $h(r) = g(r) - 1$ 和流体的各向同性，通过对全空间积分将 $S(q)$ 与 $h(r)$ 关联起来。不要假定任何预先推导好的一维变换；需从三维定义和各向同性原理出发，推导出所需的各向同性积分。\n\n然后，你必须基于这些原理实现一个数值算法，该算法：\n- 在以粒子直径 $\\sigma=1$ 为基准的约化单位下，在一个间距为 $\\Delta r$ 的均匀网格 $r \\in [0, R_{\\max}]$ 上，构建一个人工合成但物理上合理的 $g(r)$ 数据集。\n- 在进行变换之前，对 $h(r)$ 应用一个可选的窗函数 $w(r)$，以减轻有限尺寸截断带来的伪影。\n- 对一个均匀的 $q$ 值网格 $q \\in [q_{\\min}, q_{\\max}]$ 计算 $S(q)$，并通过在特定区间内扫描全局最大值来确定 $S(q)$ 的第一主峰。\n- 按明确指定的顺序报告每种情况下的峰高。\n\n所有量都必须是无量纲的，其中长度以 $\\sigma$ 为单位（因此密度以 $\\sigma^{-3}$ 为单位，波矢以 $\\sigma^{-1}$ 为单位）。静态结构因子 $S(q)$ 是无量纲的。你必须使用梯形法则进行数值积分，并确保对 $\\sin(x)/x$ 中 $x \\to 0$ 的特殊情况进行一致性处理。\n\n使用以下固定定义和参数来生成 $g(r)$：\n- 粒子直径为 $\\sigma = 1$。\n- 数密度为 $\\rho = 0.85$（单位为 $\\sigma^{-3}$）。\n- 对相关函数 $g(r)$ 定义如下：\n  - 对于 $0 \\le r &lt; \\sigma$，$g(r) = 0$。\n  - 对于 $r \\ge \\sigma$，$g(r) = 1 + A \\exp\\!\\left(-\\frac{r-\\sigma}{\\xi}\\right) \\cos\\!\\left(k_0 (r - \\sigma)\\right)$。\n  参数为 $A = 0.85$, $\\xi = 2.0$, $k_0 = 7.0$。\n- 径向网格间距为 $\\Delta r = 0.005$（单位为 $\\sigma$）。\n- 在 $[0, R_{\\max}]$ 上乘法应用于 $h(r)$ 的窗函数 $w(r)$：\n  - 矩形窗: $w(r) = 1$。\n  - 汉宁窗: $w(r) = \\tfrac{1}{2}\\left(1 - \\cos\\left(\\frac{2\\pi r}{R_{\\max}}\\right)\\right)$。\n- 波矢网格：在 $q \\in [q_{\\min}, q_{\\max}]$ 上均匀使用 $N_q = 5000$ 个点，其中 $q_{\\min} = 0.1$，$q_{\\max} = 20.0$。\n- 第一主峰搜索区间：限制在 $q \\in [q_{\\mathrm{low}}, q_{\\mathrm{high}}]$，其中 $q_{\\mathrm{low}} = 2.0$，$q_{\\mathrm{high}} = 12.0$。\n- 在所有出现 $\\frac{\\sin(x)}{x}$ 的计算中，你必须通过取其连续极限值 $1$ 来处理 $x=0$ 的情况。\n\n设计你的程序，使其为每个测试用例产生一个单一的度量值：在指定搜索区间内 $S(q)$ 的第一主峰的高度。\n\n测试套件：\n- 情况 1：$R_{\\max} = 30.0$，窗函数类型 = 矩形窗。\n- 情况 2：$R_{\\max} = 10.0$，窗函数类型 = 矩形窗。\n- 情况 3：$R_{\\max} = 10.0$，窗函数类型 = 汉宁窗。\n- 情况 4：$R_{\\max} = 30.0$，窗函数类型 = 汉宁窗。\n- 情况 5：$R_{\\max} = 6.0$，窗函数类型 = 矩形窗。\n\n你的程序必须产生单行输出，其中包含一个逗号分隔的峰高列表，用方括号括起来，并严格按照测试用例的顺序排列。每个值都必须四舍五入到恰好六位小数。例如，你的输出必须看起来像 `\"[x1,x2,x3,x4,x5]\"`，其中每个 $x_i$ 是一个小数点后有六位数字的浮点数。", "solution": "该问题要求从给定的径向分布函数 $g(r)$ 出发，通过数值傅里叶变换计算三维各向同性流体的静态结构因子 $S(q)$。\n\n1.  **理论基础**\n    静态结构因子 $S(q)$ 与总相关函数 $h(r) = g(r) - 1$ 通过以下傅里叶变换关系相关联：\n    $$ S(q) = 1 + \\rho \\int h(\\mathbf{r}) e^{-i \\mathbf{q} \\cdot \\mathbf{r}} \\, \\mathrm{d}^3 \\mathbf{r} $$\n    对于各向同性系统，$h(\\mathbf{r})$ 仅依赖于径向距离 $r$，即 $h(r)$。通过在球坐标中对角度进行积分，上述三维积分可以简化为一维积分：\n    $$ S(q) = 1 + 4 \\pi \\rho \\int_{0}^{\\infty} r^2 h(r) \\frac{\\sin(qr)}{qr} \\, \\mathrm{d}r $$\n    其中函数 $\\frac{\\sin(x)}{x}$ 在 $x \\to 0$ 时的极限为 $1$。\n\n2.  **数值实现**\n    我们采用数值方法来近似这个积分。由于 $g(r)$（以及 $h(r)$）仅在有限的径向范围 $[0, R_{\\max}]$ 内给出，积分被截断。为了减少截断引起的吉布斯振荡，我们在积分前将 $h(r)$ 乘以一个窗函数 $w(r)$。\n\n    算法步骤如下：\n    a. **生成 $g(r)$ 和 $h(r)$**：根据问题中给定的分段函数和参数，在 $[0, R_{\\max}]$ 的离散径向网格上生成 $g(r)$ 数据，然后计算 $h(r) = g(r) - 1$。\n    b. **应用窗函数**：将 $h(r)$ 与指定的窗函数（矩形窗或汉宁窗）相乘。\n    c. **数值积分**：对于每个给定的波矢 $q$ 值，使用梯形法则对以下被积函数进行数值积分：\n    $$ I(r) = 4 \\pi \\rho \\, r^2 h(r) w(r) \\frac{\\sin(qr)}{qr} $$\n    d. **计算 $S(q)$**：将积分结果加 $1$ 得到 $S(q)$。\n    e. **确定峰高**：在指定的 $q$ 值搜索区间 $[q_{\\mathrm{low}}, q_{\\mathrm{high}}]$ 内找到 $S(q)$ 的最大值。\n\n3.  **案例计算**\n    我们对问题中给出的五个测试案例分别执行上述算法。每个案例具有不同的截断半径 $R_{\\max}$ 和窗函数类型。\n    - **案例 1**：$R_{\\max}=30.0$, 矩形窗。长程关联被包含，但尖锐截断可能引入伪影。\n    - **案例 2**：$R_{\\max}=10.0$, 矩形窗。截断更严重，预计会显著影响峰高。\n    - **案例 3**：$R_{\\max}=10.0$, 汉宁窗。与案例2相比，汉宁窗通过平滑截断来抑制伪影，但可能会展宽峰并略微降低峰高。\n    - **案例 4**：$R_{\\max}=30.0$, 汉宁窗。与案例1相比，汉宁窗提供更平滑的截断。\n    - **案例 5**：$R_{\\max}=6.0$, 矩形窗。最严重的截断，预计结果偏差最大。\n\n    通过执行一个精确实现上述算法的程序，我们得到每个案例的峰高值，并按要求格式化输出。", "answer": "$$\n\\boxed{[2.868011,2.766346,2.859670,2.867959,2.706173]}\n$$", "id": "2909330"}]}