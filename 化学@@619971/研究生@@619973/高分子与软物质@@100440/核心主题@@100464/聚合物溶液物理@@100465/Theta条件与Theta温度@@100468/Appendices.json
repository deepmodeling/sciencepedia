{"hands_on_practices": [{"introduction": "本练习为理解 $\\Theta$ 条件奠定了理论基础。从高分子溶液最基本的模型——Flory-Huggins 自由能理论出发，您将推导出 $\\Theta$ 条件的判据。这项练习旨在巩固您对抽象的 $\\Theta$ 点概念（高分子链在此表现为理想链）如何通过渗透压的第二维里系数为零而被严格定义的理解。[@problem_id:2934645]", "problem": "在低聚合物体积分数下，分子溶剂中的长柔性聚合物可由每个格点的 Flory–Huggins (FH) 混合自由能来描述，\n$$\n\\frac{f}{k_B T} \\equiv g(\\phi;T) = \\frac{\\phi}{N}\\ln \\phi + (1-\\phi)\\ln(1-\\phi) + \\chi(T)\\,\\phi(1-\\phi),\n$$\n其中 $k_B$ 是玻尔兹曼常数，$T$ 是绝对温度，$\\phi$ 是聚合物体积分数，$N$ 是聚合度，$\\chi(T)$ 是依赖于温度的 FH 相互作用参数。渗透压由自由能密度通过标准热力学关系 $\\Pi = \\phi\\,(\\partial f/\\partial \\phi)_T - f$ 定义。$\\Theta$ 条件定义为在稀溶液极限下有效双体排除体积相互作用消失的点，这一点与渗透压状态方程的第二维里系数为零相吻合。该相互作用参数得到经验充分支持的温度依赖关系为\n$$\n\\chi(T) = \\frac{A}{T} + B,\n$$\n其中 $A$ 和 $B$ 是不依赖于温度的常数。\n\n从上面给出的 FH 自由能和渗透压的定义出发，在小 $\\phi$ 的极限下进行推导，并展示 $\\Theta$ 条件如何确定在 $\\Theta$ 温度 $T_{\\theta}$ 下 $\\chi$ 的值。然后，仅使用上述 $\\chi(T)$ 的经验形式，推导出一个用 $A$ 和 $B$ 表示的 $T_{\\theta}$ 的闭式表达式。最后，对于一个特定的聚合物-溶剂对，其 $A = 86.0\\,\\mathrm{K}$ 且 $B = 0.22$，计算 $T_{\\theta}$ 并以开尔文为单位报告其值。将答案四舍五入到四位有效数字。在你的推导过程中，简要解释 $A$ 和 $B$ 中包含了哪些热力学贡献，以及当 $T$ 变化时，为什么它们的符号对溶剂质量很重要。", "solution": "出发点是每个格点的 Flory–Huggins (FH) 自由能密度，\n$$\n\\frac{f}{k_B T} = \\frac{\\phi}{N}\\ln \\phi + (1-\\phi)\\ln(1-\\phi) + \\chi(T)\\,\\phi(1-\\phi).\n$$\n根据混合物的标准热力学，渗透压 $ \\Pi $ 可由自由能密度关于体积分数的勒让德变换得到，\n$$\n\\Pi = \\phi \\left(\\frac{\\partial f}{\\partial \\phi}\\right)_{T} - f.\n$$\n为了与维里系数建立联系，我们需要将渗透压按聚合物体积分数 $\\phi$ 的幂次进行稀溶液展开。我们首先在小 $\\phi$ 处使用自然对数的泰勒级数 $\\ln(1-\\phi) = -\\phi - \\phi^{2}/2 - \\phi^{3}/3 - \\cdots$ 来展开组合熵项。于是\n$$\n(1-\\phi)\\ln(1-\\phi) = (1-\\phi)\\left(-\\phi - \\frac{\\phi^{2}}{2} - \\frac{\\phi^{3}}{3} - \\cdots \\right) = -\\phi + \\frac{\\phi^{2}}{2} + \\mathcal{O}(\\phi^{3}).\n$$\n因此，保留到 $\\mathcal{O}(\\phi^{2})$ 的项，\n$$\n\\frac{f}{k_B T} = \\frac{\\phi}{N}\\ln \\phi - \\phi + \\frac{\\phi^{2}}{2} + \\chi(T)\\,\\phi - \\chi(T)\\,\\phi^{2} + \\mathcal{O}(\\phi^{3}).\n$$\n合并系数后得到，\n$$\n\\frac{f}{k_B T} = \\frac{\\phi}{N}\\ln \\phi + \\bigl[\\chi(T) - 1\\bigr]\\phi + \\left[\\frac{1}{2} - \\chi(T)\\right]\\phi^{2} + \\mathcal{O}(\\phi^{3}).\n$$\n我们现在使用 $\\Pi = \\phi (\\partial f/\\partial \\phi) - f$ 来计算 $\\Pi/(k_B T)$。首先计算导数，\n$$\n\\frac{1}{k_B T}\\left(\\frac{\\partial f}{\\partial \\phi}\\right)_{T} = \\frac{1}{N}\\left(\\ln \\phi + 1\\right) + \\bigl[\\chi(T) - 1\\bigr] + 2\\left[\\frac{1}{2} - \\chi(T)\\right]\\phi + \\mathcal{O}(\\phi^{2}).\n$$\n乘以 $\\phi$，\n$$\n\\frac{\\phi}{k_B T}\\left(\\frac{\\partial f}{\\partial \\phi}\\right)_{T} = \\frac{\\phi}{N}\\ln \\phi + \\frac{\\phi}{N} + \\bigl[\\chi(T) - 1\\bigr]\\phi + \\left[1 - 2\\chi(T)\\right]\\phi^{2} + \\mathcal{O}(\\phi^{3}).\n$$\n减去 $f/(k_B T)$ 得到以热能单位表示的渗透压，\n\\begin{align*}\n\\frac{\\Pi}{k_B T} &= \\left(\\frac{\\phi}{N}\\ln \\phi + \\frac{\\phi}{N} + \\bigl[\\chi(T) - 1\\bigr]\\phi + \\left[1 - 2\\chi(T)\\right]\\phi^{2} + \\cdots \\right) \\\\\n&\\quad - \\left(\\frac{\\phi}{N}\\ln \\phi + \\bigl[\\chi(T) - 1\\bigr]\\phi + \\left[\\frac{1}{2} - \\chi(T)\\right]\\phi^{2} + \\cdots \\right) \\\\\n&= \\frac{\\phi}{N} + \\left(1 - 2\\chi(T) - \\frac{1}{2} + \\chi(T)\\right)\\phi^{2} + \\mathcal{O}(\\phi^{3}) \\\\\n&= \\frac{\\phi}{N} + \\left(\\frac{1}{2} - \\chi(T)\\right)\\phi^{2} + \\mathcal{O}(\\phi^{3}).\n\\end{align*}\n这是精确到 $\\phi$ 二阶的渗透压状态方程。$\\phi^{2}$ 的系数是约化的第二维里系数（在格点模型中，其数值取决于微观体积单位的选择）。$\\Theta$ 条件定义为有效双体排除体积消失的点，即第二维里系数为零。因此，\n$$\n\\frac{1}{2} - \\chi\\bigl(T_{\\theta}\\bigr) = 0 \\quad \\Longrightarrow \\quad \\chi\\bigl(T_{\\theta}\\bigr) = \\frac{1}{2}.\n$$\n这就建立了用 FH 相互作用参数表示的 $\\Theta$ 条件。\n\n现在代入经验的温度依赖关系\n$$\n\\chi(T) = \\frac{A}{T} + B,\n$$\n其中 $A$ 和 $B$ 是不依赖于温度的常数。在 $T_{\\theta}$ 时，我们有\n$$\n\\frac{A}{T_{\\theta}} + B = \\frac{1}{2}.\n$$\n解出 $T_{\\theta}$，得到其闭式表达式\n$$\nT_{\\theta} = \\frac{A}{\\frac{1}{2} - B} = \\frac{2A}{1 - 2B}.\n$$\n\n对于 $A = 86.0\\,\\mathrm{K}$ 和 $B = 0.22$ 的特定聚合物-溶剂对，我们计算\n$$\nT_{\\theta} = \\frac{2 \\times 86.0}{1 - 2 \\times 0.22}\\ \\mathrm{K} = \\frac{172.0}{1 - 0.44}\\ \\mathrm{K} = \\frac{172.0}{0.56}\\ \\mathrm{K} \\approx 307.142857\\ \\mathrm{K}.\n$$\n四舍五入到四位有效数字后，可得\n$$\nT_{\\theta} \\approx 307.1\\ \\mathrm{K}.\n$$\n\n最后，我们对 $A$ 和 $B$ 进行热力学解释。在平均场格点处理中，相互作用参数可以分解为\n$$\n\\chi(T) \\simeq \\frac{\\Delta H_{\\mathrm{mix}}}{k_B T} - \\frac{\\Delta S_{\\mathrm{mix}}^{\\mathrm{nonideal}}}{k_B},\n$$\n其中 $\\Delta H_{\\mathrm{mix}}$ 代表每个格点的接触混合焓，$\\Delta S_{\\mathrm{mix}}^{\\mathrm{nonideal}}$ 则包含了 FH 自由能中已明确计入的理想组合项之外的非组合熵（例如，局部堆积、压缩性和链段相关性）。与 $\\chi(T) = A/T + B$ 比较，我们确定 $A \\propto \\Delta H_{\\mathrm{mix}}/k_B$ 是焓贡献，而 $B \\simeq -\\Delta S_{\\mathrm{mix}}^{\\mathrm{nonideal}}/k_B$ 是熵（不依赖于温度的）贡献。正的 $A$ 值表示混合在焓上是不利的，这种不利效应随着 $T$ 的升高而减弱，从而在较高温度下改善了溶剂质量。$B$ 的符号和大小会改变溶剂质量的基线，且这种改变不依赖于 $T$。$A$ 和 $B$ 通过 $T_{\\theta} = 2A/(1 - 2B)$ 共同决定 $T_{\\theta}$：较大的 $A$ 会提高 $T_{\\theta}$，而（在 $A$ 固定的情况下）较大的 $B$ 也会通过减小分母 $1 - 2B$ 来提高 $T_{\\theta}$。", "answer": "$$\\boxed{307.1}$$", "id": "2934645"}, {"introduction": "$\\Theta$ 温度不仅仅是一个热力学上的奇点，它标志着高分子链物理构象的深刻变化。本练习将超越格子模型，采用连续链的描述，通过微扰理论将微观相互作用直接与一个关键的宏观可观测量——线圈扩张因子 $\\alpha$ 联系起来。通过完成这项练习，您将能够量化当温度接近 $T_{\\theta}$ 时，真实链的尺寸如何逼近其理想、无扰的尺寸。[@problem_id:2934639]", "problem": "稀溶液中的理想柔性聚合物被建模为三维空间中的连续高斯链，其轮廓参数为 $s \\in [0,N]$，Kuhn长度为 $a$。首末矢量为 $R = r(N) - r(0)$，理想（高斯）均方首末距离为 $\\langle R^{2} \\rangle_{0} = a^{2} N$。溶剂介导的单体相互作用由具有强度为 $v(T)$ 的排除体积项的 Edwards 哈密顿量处理：\n$$\n\\beta \\mathcal{H}[r(\\cdot)] = \\frac{3}{2 a^{2}} \\int_{0}^{N} \\left| \\frac{d r}{ds} \\right|^{2} ds + \\frac{v(T)}{2} \\int_{0}^{N} \\int_{0}^{N} \\delta\\!\\left( r(s) - r(s') \\right) ds\\, ds',\n$$\n其中 $\\beta = 1/(k_{B} T)$，$\\delta(\\cdot)$ 是三维 Dirac δ 分布。定义膨胀因子 $\\alpha = \\sqrt{ \\langle R^{2} \\rangle / \\langle R^{2} \\rangle_{0} }$。$\\Theta$ 温度 $T_{\\theta}$ 由第二维里系数为零来定义，这意味着 $v(T_{\\theta}) = 0$。在 $T_{\\theta}$ 附近，经验上已经很好地确定了排除体积参数与温度呈线性关系：\n$$\nv(T) = v_{1} \\left( T - T_{\\theta} \\right) + \\text{更高阶项},\n$$\n其中常数斜率 $v_{1} = \\left. dv/dT \\right|_{T_{\\theta}}$ 与 $N$ 和 $a$ 无关。以高斯参考态（$v=0$）为基准，对 $v$ 做一阶微扰，使用基于上述哈密顿量的微扰理论，推导膨胀因子 $\\alpha$ 在 $T_{\\theta}$ 附近的主要温度依赖关系。您可以假设，在决定 $\\langle R^{2} \\rangle$ 一阶修正的连通（协方差）组合中，所有与局域 $\\delta$-相互作用相关的紫外发散都相互抵消，并且您可以使用理想链的标准高斯泛函平均。请提供 $\\alpha(T)$ 的单个闭合形式解析表达式作为最终答案，该表达式在 $\\left( T - T_{\\theta} \\right)$ 上精确到一阶，并用 $N$、$a$、$v_{1}$、$T$和$T_{\\theta}$及基本常数表示。不需要四舍五入，最终表达式应为无量纲。最终答案中不应包含任何余项。", "solution": "问题要求使用一阶微扰理论，推导聚合物膨胀因子 $\\alpha(T)$ 在 $\\Theta$ 温度 $T_{\\theta}$ 附近的温度依赖关系。\n\n该体系是一个由 Edwards 哈密顿量定义的连续高斯聚合物链：\n$$\n\\beta \\mathcal{H}[r(\\cdot)] = \\beta \\mathcal{H}_{0} + \\beta \\mathcal{H}_{int}\n$$\n其中理想（未微扰）部分为：\n$$\n\\beta \\mathcal{H}_{0} = \\frac{3}{2 a^{2}} \\int_{0}^{N} \\left| \\frac{d r}{ds} \\right|^{2} ds\n$$\n相互作用（微扰）部分为：\n$$\n\\beta \\mathcal{H}_{int} = \\frac{v(T)}{2} \\int_{0}^{N} \\int_{0}^{N} \\delta\\!\\left( r(s) - r(s') \\right) ds\\, ds'\n$$\n膨胀因子定义为 $\\alpha = \\sqrt{ \\langle R^{2} \\rangle / \\langle R^{2} \\rangle_{0} }$，其中 $R = r(N) - r(0)$ 是首末矢量。我们需要计算使用完整哈密顿量 $\\mathcal{H}$ 的 $\\langle R^2 \\rangle$。可观测量 $\\mathcal{O}$ 的平均值由下式给出：\n$$\n\\langle \\mathcal{O} \\rangle = \\frac{\\int \\mathcal{D}[r] \\mathcal{O} \\exp(-\\beta\\mathcal{H})}{\\int \\mathcal{D}[r] \\exp(-\\beta\\mathcal{H})}\n$$\n我们将 $\\beta \\mathcal{H}_{int}$ 视为一个小微扰。将指数项对 $v(T)$ 展开到一阶：\n$$\n\\exp(-\\beta\\mathcal{H}) = \\exp(-\\beta\\mathcal{H}_0 - \\beta\\mathcal{H}_{int}) \\approx \\exp(-\\beta\\mathcal{H}_0) (1 - \\beta\\mathcal{H}_{int})\n$$\n那么 $R^2$ 的平均值为：\n$$\n\\langle R^2 \\rangle \\approx \\frac{\\int \\mathcal{D}[r] R^2 (1 - \\beta\\mathcal{H}_{int}) \\exp(-\\beta\\mathcal{H}_0)}{\\int \\mathcal{D}[r] (1 - \\beta\\mathcal{H}_{int}) \\exp(-\\beta\\mathcal{H}_0)} = \\frac{\\langle R^2 (1 - \\beta\\mathcal{H}_{int}) \\rangle_0}{\\langle 1 - \\beta\\mathcal{H}_{int} \\rangle_0}\n$$\n其中 $\\langle \\cdot \\rangle_0$ 表示相对于未微扰哈密顿量 $\\mathcal{H}_0$ 的平均。\n展开此表达式并保留微扰的一阶项，得到累积量展开结果：\n$$\n\\langle R^2 \\rangle \\approx \\langle R^2 \\rangle_0 - \\left( \\langle R^2 (\\beta\\mathcal{H}_{int}) \\rangle_0 - \\langle R^2 \\rangle_0 \\langle \\beta\\mathcal{H}_{int} \\rangle_0 \\right)\n$$\n代入 $\\beta\\mathcal{H}_{int}$ 的表达式：\n$$\n\\langle R^2 \\rangle \\approx \\langle R^2 \\rangle_0 - \\frac{v(T)}{2} \\int_0^N ds \\int_0^N ds' \\left[ \\langle R^2 \\delta(r(s)-r(s')) \\rangle_0 - \\langle R^2 \\rangle_0 \\langle \\delta(r(s)-r(s')) \\rangle_0 \\right]\n$$\n方括号中的项是 $R^2$ 和两点接触密度的连通相关函数，或称协方差。\n对于由 $\\mathcal{H}_0$ 控制的高斯链，对应于不重叠链段的矢量在统计上是独立的。让我们假设 $0 \\le s' < s \\le N$。首末矢量可以分解为 $R = (r(N)-r(s)) + (r(s)-r(s')) + (r(s')-r(0))$。这三个矢量是均值为零的独立高斯变量。让我们分别将它们表示为 $u_1$、$u_2$ 和 $u_3$。\n这些链段的未微扰均方长度由问题中给出的标度关系给出：$\\langle u_1^2 \\rangle_0 = a^2(N-s)$，$\\langle u_2^2 \\rangle_0 = a^2(s-s')$，以及 $\\langle u_3^2 \\rangle_0 = a^2(s')$。总的未微扰均方首末距离为 $\\langle R^2 \\rangle_0 = \\langle (u_1+u_2+u_3)^2 \\rangle_0 = \\langle u_1^2 \\rangle_0 + \\langle u_2^2 \\rangle_0 + \\langle u_3^2 \\rangle_0 = a^2N$，这与前面一致。\n\n现在我们计算相关函数中的第一项：\n$$\n\\langle R^2 \\delta(r(s)-r(s')) \\rangle_0 = \\langle (u_1+u_2+u_3)^2 \\delta(u_2) \\rangle_0\n$$\n由于 delta 函数强制 $u_2=0$，并且 $u_1$、$u_2$、$u_3$ 是独立的，这变为：\n$$\n= \\langle (u_1+u_3)^2 \\rangle_0 \\langle \\delta(u_2) \\rangle_0 = (\\langle u_1^2 \\rangle_0 + \\langle u_3^2 \\rangle_0) \\langle \\delta(r(s)-r(s')) \\rangle_0\n$$\n$$\n= (a^2(N-s) + a^2s') \\langle \\delta(r(s)-r(s')) \\rangle_0\n$$\n因此，对于 $s > s'$，连通相关函数为：\n$$\n\\text{Cov}(\\dots) = (a^2(N-s) + a^2s') \\langle \\delta(\\dots) \\rangle_0 - (a^2N) \\langle \\delta(\\dots) \\rangle_0 = -a^2(s-s') \\langle \\delta(r(s)-r(s')) \\rangle_0\n$$\n对于三维高斯链，连接两点 $s$ 和 $s'$ 的矢量的概率密度由下式给出：\n$$\nP(r;s,s') = \\left( \\frac{3}{2\\pi \\langle |r(s)-r(s')|^2 \\rangle_0} \\right)^{3/2} \\exp\\left( - \\frac{3 r^2}{2 \\langle |r(s)-r(s')|^2 \\rangle_0} \\right)\n$$\n使用 $\\langle |r(s)-r(s')|^2 \\rangle_0 = a^2|s-s'|$，我们得到 $\\langle \\delta(r(s)-r(s')) \\rangle_0 = P(0;s,s') = \\left(\\frac{3}{2\\pi a^2|s-s'|}\\right)^{3/2}$。\n对 $\\langle R^2 \\rangle$ 的一阶修正为 $\\delta\\langle R^2 \\rangle = \\langle R^2 \\rangle - \\langle R^2 \\rangle_0$：\n$$\n\\delta \\langle R^2 \\rangle = - \\frac{v(T)}{2} \\int_0^N \\int_0^N ds ds' \\left[ -a^2|s-s'| \\left(\\frac{3}{2\\pi a^2|s-s'|}\\right)^{3/2} \\right]\n$$\n被积函数的对称性允许我们将其写为：\n$$\n\\delta \\langle R^2 \\rangle = v(T) \\int_0^N ds \\int_0^s ds' \\left[ a^2(s-s') \\left(\\frac{3}{2\\pi a^2(s-s')}\\right)^{3/2} \\right]\n$$\n$$\n\\delta \\langle R^2 \\rangle = v(T) a^2 \\left(\\frac{3}{2\\pi a^2}\\right)^{3/2} \\int_0^N ds \\int_0^s ds' (s-s')^{1 - 3/2} = v(T) a^2 \\left(\\frac{3}{2\\pi a^2}\\right)^{3/2} \\int_0^N ds \\int_0^s (s-s')^{-1/2} ds'\n$$\n内部积分的计算结果为：$\\int_0^s (s-s')^{-1/2} ds' = [-2(s-s')^{1/2}]_0^s = 2s^{1/2}$。\n外部积分变为：$\\int_0^N 2s^{1/2} ds = 2 \\left[\\frac{s^{3/2}}{3/2}\\right]_0^N = \\frac{4}{3}N^{3/2}$。\n所以，修正是：\n$$\n\\delta \\langle R^2 \\rangle = v(T) a^2 \\left(\\frac{3}{2\\pi a^2}\\right)^{3/2} \\frac{4}{3} N^{3/2}\n$$\n膨胀因子的平方是 $\\alpha^2 = \\langle R^2 \\rangle / \\langle R^2 \\rangle_0 = 1 + \\delta \\langle R^2 \\rangle / \\langle R^2 \\rangle_0$。\n使用 $\\langle R^2 \\rangle_0 = a^2N$：\n$$\n\\alpha^2(T) = 1 + \\frac{v(T) a^2 \\left(\\frac{3}{2\\pi a^2}\\right)^{3/2} \\frac{4}{3} N^{3/2}}{a^2N} = 1 + \\frac{4}{3} v(T) \\left(\\frac{3}{2\\pi a^2}\\right)^{3/2} N^{1/2}\n$$\n在 $\\Theta$ 温度 $T_{\\theta}$ 附近，排除体积参数由 $v(T) \\approx v_1(T - T_{\\theta})$ 给出。将此代入 $\\alpha^2(T)$ 的表达式：\n$$\n\\alpha^2(T) \\approx 1 + \\frac{4}{3} v_1(T - T_{\\theta}) \\left(\\frac{3}{2\\pi a^2}\\right)^{3/2} N^{1/2}\n$$\n对于小的 $x$，$\\sqrt{1+x} \\approx 1 + x/2$。由于在 $T_{\\theta}$ 附近 $v(T)$ 很小，我们可以将 $\\alpha(T) = \\sqrt{\\alpha^2(T)}$ 展开到一阶：\n$$\n\\alpha(T) \\approx 1 + \\frac{1}{2}(\\alpha^2(T) - 1) = 1 + \\frac{2}{3} v_1(T - T_{\\theta}) \\left(\\frac{3}{2\\pi a^2}\\right)^{3/2} N^{1/2}\n$$\n现在，我们简化常数前置因子：\n$$\n\\frac{2}{3} \\left(\\frac{3}{2\\pi}\\right)^{3/2} = \\frac{2}{3} \\frac{3\\sqrt{3}}{(2\\pi)^{3/2}} = \\frac{2\\sqrt{3}}{2\\sqrt{2}\\pi^{3/2}} = \\frac{\\sqrt{3}}{\\sqrt{2}\\pi^{3/2}} = \\frac{\\sqrt{6}}{2\\pi^{3/2}}\n$$\n将此与其他参数结合，我们得到膨胀因子的最终表达式：\n$$\n\\alpha(T) = 1 + \\left( \\frac{\\sqrt{6}}{2\\pi^{3/2}} \\right) \\frac{v_1 N^{1/2}}{a^3} (T - T_{\\theta})\n$$\n该表达式是无量纲的，并显示了当温度偏离 $\\Theta$ 温度时，膨胀因子从其理想值 1 的线性偏离。", "answer": "$$\n\\boxed{1 + \\frac{\\sqrt{6}}{2\\pi^{\\frac{3}{2}}} \\frac{v_{1} N^{\\frac{1}{2}}}{a^{3}} \\left( T - T_{\\theta} \\right)}\n$$", "id": "2934639"}, {"introduction": "在现代高分子科学中，计算机模拟是连接微观模型与实验观测的重要工具。本练习将挑战您像计算物理学家一样思考，设计一个从模拟数据中确定 $\\Theta$ 温度的流程。您将学习如何从测量高分子线圈间有效相互作用的对分布函数 $g(r)$ 中提取第二维里系数，并由此确定 $T_{\\theta}$。[@problem_id:2934617]", "problem": "要求您从第一性原理出发，形式化并实现一个过程，通过对分布函数计算第二维里系数，从而确定长聚合物链的 $\\Theta$ 温度（记为 $T_{\\theta}$）。您的推导必须从统计力学和聚合物溶液热力学的核心定义开始，不得假定任何专用公式为已知。然后，您需要将推导出的计算方法实现为一个程序。\n\n考虑一个由非常长的聚合物链组成的稀溶液，其中两个线团质心之间的有效相互作用的相关对关联是在温度 $T$ 下的对分布函数 $g(r \\mid T)$。假设有效相互作用是各向同性的，因此 $g(r \\mid T)$ 仅依赖于标量距离 $r$。$\\Theta$ 温度 $T_{\\theta}$ 定义为在长链极限下，有效双线团相互作用的第二维里系数为零时的温度。等效地，在 $T_{\\theta}$ 时，净排除体积效应与吸引贡献相互抵消，从而使得对理想性的主导偏离为零。\n\n在模拟实践中，$g(r \\mid T)$ 可以通过对长链使用一种结合了全局和局部移动（例如，枢轴移动和构象偏倚再生长移动）的蒙特卡洛方案来测量，以在稀溶液体系中平衡单链构象和双链的相对位置。本问题的目标不是构建完整的模拟，而是推导并实现一个将 $g(r \\mid T)$ 映射到第二维里系数，进而映射到 $T_{\\theta}$ 的计算过程。\n\n为了使问题具有普适可计算性，假设测得的 $g(r \\mid T)$ 可由以下简化模型很好地表示，该模型捕捉了长线团在 $T_{\\theta}$ 附近溶剂质量的温度依赖性：\n- 约化平均力势 $u(r;T)$ 通过 $g(r \\mid T) = \\exp[-u(r;T)]$ 定义。\n- 对于下文所有测试用例，取 $u(r;T) = a(T) \\exp\\!\\left[-\\left(\\dfrac{r}{R}\\right)^{2}\\right]$，其中 $R$ 是一个与线团尺寸成正比的正长度标度，$a(T)$ 是一个根据 $a(T) = a_{0} + a_{1} (T - T_{0})$ 随 $T$ 线性变化的标量振幅。\n- 无量纲约化第二维里系数定义为 $A_{2}^{\\ast}(T) \\equiv \\dfrac{B_{2}(T)}{(4\\pi/3) R^{3}}$，其中 $B_{2}(T)$ 是有效各向同性相互作用的普通第二维里系数。$\\Theta$ 条件为 $A_{2}^{\\ast}(T_{\\theta}) = 0$。\n\n任务：\n1. 从平均力势和适用于各向同性对关联的 Mayer $f$-函数的核心定义出发，为上述给定模型推导出一个用 $g(r \\mid T)$ 表示的 $A_{2}^{\\ast}(T)$ 的显式表达式。您必须使用基本定义和标准统计力学恒等式来证明每一步，而不是直接引用目标表达式。\n2. 使用您推导的表达式，设计一个稳健的数值算法。该算法在给定参数 $(R, a_{0}, a_{1}, T_{0})$ 和一个已知包含 $T_{\\theta}$ 的温度区间 $[T_{\\min}, T_{\\max}]$ 的情况下，通过数值积分计算 $A_{2}^{\\ast}(T)$，然后将 $T_{\\theta}$ 确定为该区间内 $A_{2}^{\\ast}(T) = 0$ 的唯一根。您的算法必须：\n   - 通过显式误差控制，高精度地计算所有必需的积分。\n   - 使用一种在存在符号变化时保证收敛的区间求根方法。\n   - 正确处理根与 $T_{\\min}$ 或 $T_{\\max}$ 重合的边界情况。\n3. 将该算法实现为一个程序，对于下方的每个测试用例，输出以开尔文为单位的 $T_{\\theta}$。将每个数值答案以 $\\mathrm{K}$ 为单位表示，并四舍五入到三位小数。\n\n测试套件：\n为以下三个独立的参数集提供结果，其中温度以开尔文为单位，长度以纳米为单位（您可以将 $R$ 视为一个外部长度标度；通过使用约化的、无量纲的 $A_{2}^{\\ast}$ 来确保您推导过程中的量纲一致性）：\n- 案例 1（常规内部根）：$R = 15\\,\\mathrm{nm}$, $a_{0} = 1.2$, $a_{1} = -0.01\\,\\mathrm{K}^{-1}$, $T_{0} = 300\\,\\mathrm{K}$, $T_{\\min} = 350\\,\\mathrm{K}$, $T_{\\max} = 500\\,\\mathrm{K}$。\n- 案例 2（位于区间下界的边界根）：$R = 12\\,\\mathrm{nm}$, $a_{0} = 0.5$, $a_{1} = 0.02\\,\\mathrm{K}^{-1}$, $T_{0} = 300\\,\\mathrm{K}$, $T_{\\min} = 275\\,\\mathrm{K}$, $T_{\\max} = 350\\,\\mathrm{K}$。\n- 案例 3（缓坡过零点）：$R = 20\\,\\mathrm{nm}$, $a_{0} = 0.02$, $a_{1} = -1.0\\times 10^{-4}\\,\\mathrm{K}^{-1}$, $T_{0} = 300\\,\\mathrm{K}$, $T_{\\min} = 450\\,\\mathrm{K}$, $T_{\\max} = 550\\,\\mathrm{K}$。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含三个计算出的 $T_{\\theta}$ 值（以开尔文为单位，四舍五入到三位小数），形式为一个用方括号括起来的逗号分隔列表（例如，`[420.000,275.000,500.000]`）。不允许有任何其他输出。\n\n不使用角度单位。不使用百分比。所有数值必须报告为不带百分号的十进制数。所有带有单位的物理量输出必须以上文指定的单位报告，即温度使用 $\\mathrm{K}$。", "solution": "该问题是有效的，因为它在科学上基于聚合物溶液热力学和统计力学的原理，是良定的，具有足够的信息以获得唯一解，并以客观、正式的语言表述。我们将进行完整的推导和解答。\n\n任务是为一个相互作用的聚合物线团模型确定其 $\\Theta$ 温度 $T_{\\theta}$。$\\Theta$ 温度被定义为聚合物线团间有效相互作用的第二维里系数 $B_{2}(T)$ 变为零时的温度。我们得到了对分布函数 $g(r \\mid T)$ 的一个模型，并被要求推导 $B_{2}(T)$ 的表达式，建立 $T_{\\theta}$ 的条件，并实现一个数值解法。\n\n首先，我们从统计力学中第二维里系数的基本定义开始，该定义适用于具有球对称、对加性平均力势 $W(r)$ 的系统。该定义由团簇积分给出：\n$$ B_{2}(T) = -\\frac{1}{2} \\int (\\exp[-\\beta W(r)] - 1) d\\mathbf{r} $$\n其中 $\\beta = (k_{B}T)^{-1}$，$k_{B}$ 是玻尔兹曼常数，积分遍及整个空间。对于球对称势，这简化为：\n$$ B_{2}(T) = -\\frac{1}{2} \\int_{0}^{\\infty} (\\exp[-\\beta W(r)] - 1) 4\\pi r^{2} dr = -2\\pi \\int_{0}^{\\infty} (\\exp[-\\beta W(r)] - 1) r^{2} dr $$\n\n对分布函数 $g(r \\mid T)$ 通过定义 $g(r \\mid T) = \\exp[-\\beta W(r)]$ 与平均力势 $W(r)$ 相关。问题提供了一个约化的、无量纲的平均力势 $u(r;T)$，使得 $g(r \\mid T) = \\exp[-u(r;T)]$。通过比较，我们发现 $u(r;T) = \\beta W(r)$。因此，我们可以直接用给定的 $g(r \\mid T)$ 来表示 $B_{2}(T)$：\n$$ B_{2}(T) = -2\\pi \\int_{0}^{\\infty} [g(r \\mid T) - 1] r^{2} dr $$\n\n问题指明了 $u(r;T)$ 的函数形式：\n$$ u(r;T) = a(T) \\exp\\left[-\\left(\\frac{r}{R}\\right)^{2}\\right] $$\n其中 $R$ 是聚合物线团的特征长度标度，$a(T)$ 是一个依赖于温度的振幅，由 $a(T) = a_{0} + a_{1} (T - T_{0})$ 给出。因此，对分布函数为：\n$$ g(r \\mid T) = \\exp\\left[-a(T)\\exp\\left(-\\left(\\frac{r}{R}\\right)^{2}\\right)\\right] $$\n将此代入 $B_{2}(T)$ 的表达式，我们得到：\n$$ B_{2}(T) = -2\\pi \\int_{0}^{\\infty} \\left\\{ \\exp\\left[-a(T)\\exp\\left(-\\left(\\frac{r}{R}\\right)^{2}\\right)\\right] - 1 \\right\\} r^{2} dr $$\n\n问题要求计算约化的、无量纲的第二维里系数 $A_{2}^{\\ast}(T)$，其定义为：\n$$ A_{2}^{\\ast}(T) = \\frac{B_{2}(T)}{\\frac{4\\pi}{3} R^{3}} $$\n这种无量纲形式很方便，因为它消除了对线团尺寸 $R$ 的显式依赖。为了证明这一点，我们在 $B_{2}(T)$ 的积分中进行变量替换。令无量纲距离为 $x = r/R$。则 $r = xR$ 且 $dr = R\\,dx$。\n$$ B_{2}(T) = -2\\pi \\int_{0}^{\\infty} \\left\\{ \\exp[-a(T)\\exp(-x^{2})] - 1 \\right\\} (xR)^{2} (R\\,dx) $$\n$$ B_{2}(T) = -2\\pi R^{3} \\int_{0}^{\\infty} x^{2} \\left\\{ \\exp[-a(T)\\exp(-x^{2})] - 1 \\right\\} dx $$\n现在，将此代入 $A_{2}^{\\ast}(T)$ 的定义中：\n$$ A_{2}^{\\ast}(T) = \\frac{-2\\pi R^{3} \\int_{0}^{\\infty} x^{2} \\left\\{ \\exp[-a(T)\\exp(-x^{2})] - 1 \\right\\} dx}{\\frac{4\\pi}{3} R^{3}} $$\n$R^{3}$ 项相互抵消，得到与 $R$ 无关的约化第二维里系数的最终表达式：\n$$ A_{2}^{\\ast}(T) = -\\frac{3}{2} \\int_{0}^{\\infty} x^{2} \\left\\{ \\exp[-a(T)\\exp(-x^{2})] - 1 \\right\\} dx $$\n这是我们数值计算程序的核心方程。$\\Theta$ 温度 $T_{\\theta}$ 是指在此温度下，聚合物-溶剂相互作用使得有效的线团-线团相互作用在平均意义上消失。这对应于条件 $A_{2}^{\\ast}(T_{\\theta}) = 0$。这意味着积分本身必须为零：\n$$ \\int_{0}^{\\infty} x^{2} \\left\\{ \\exp[-a(T_{\\theta})\\exp(-x^{2})] - 1 \\right\\} dx = 0 $$\n\n寻找 $T_{\\theta}$ 的数值算法如下：\n1. 我们必须实现一个函数，该函数使用提供的参数 $(a_{0}, a_{1}, T_{0})$ 来计算任意给定温度 $T$ 下的 $A_{2}^{\\ast}(T)$。\n2. 该函数将首先计算 $a(T) = a_{0} + a_{1}(T - T_{0})$。\n3. 然后，它将对定积分进行数值计算。被积函数 $f(x, a) = x^{2} (\\exp[-a\\exp(-x^{2})] - 1)$ 在 $x \\to \\infty$ 时迅速衰减至零，这使其适合在区间 $[0, \\infty)$ 上进行高精度数值积分。为此，我们将使用一个标准库程序，如 `scipy.integrate.quad`，它可以处理无限积分限并提供误差估计。\n4. 积分结果随后乘以预因子 $-\\frac{3}{2}$ 以获得 $A_{2}^{\\ast}(T)$。\n\n一旦我们有了函数 $A_{2}^{\\ast}(T)$，我们就必须在给定的温度区间 $[T_{\\min}, T_{\\max}]$ 内找到满足 $A_{2}^{\\ast}(T_{\\theta}) = 0$ 的根 $T_{\\theta}$。\n1. 需要一个稳健的区间求根方法。我们将使用 Brent-Dekker 方法，可以通过 `scipy.optimize.brentq` 调用。只要区间端点的函数值 $A_{2}^{\\ast}(T_{\\min})$ 和 $A_{2}^{\\ast}(T_{\\max})$ 符号相反，该方法就保证收敛。\n2. 问题要求正确处理边界情况。我们将首先显式检查 $A_{2}^{\\ast}(T_{\\min}) = 0$ 或 $A_{2}^{\\ast}(T_{\\max}) = 0$ 是否成立。如果成立，则根就是其中一个边界。否则，我们验证 $A_{2}^{\\ast}(T_{\\min}) \\cdot A_{2}^{\\ast}(T_{\\max}) < 0$ 成立，然后继续使用 `brentq` 算法。\n\n值得注意的是，对于给定的特定函数形式，被积函数 $x^{2} \\left\\{ \\exp[-a(T)\\exp(-x^{2})] - 1 \\right\\}$ 在 $a(T) < 0$ 时严格为正，在 $a(T) > 0$ 时严格为负，在 $a(T) = 0$ 时处处为零。因此，该积分值为零当且仅当 $a(T) = 0$。从而，$T_{\\theta}$ 可以通过解析求解 $a_{0} + a_{1} (T_{\\theta} - T_{0}) = 0$ 得到，即 $T_{\\theta} = T_{0} - a_{0}/a_{1}$。然而，问题明确指示我们要设计并实现涉及数值积分和求根的完整数值过程，我们也将遵循此要求。解析结果可以作为我们数值实现的一个验证。\n\n该实现将通过使用相应参数定义 $A_2^*(T)$ 函数来处理每个测试用例，然后在指定的温度区间内应用求根逻辑。最终结果将按要求四舍五入到三位小数。", "answer": "```python\nimport numpy as np\nfrom scipy import integrate\nfrom scipy import optimize\n\ndef solve():\n    \"\"\"\n    Derives and implements a procedure to find the theta temperature T_theta.\n    \"\"\"\n\n    test_cases = [\n        # Case 1 (general interior root)\n        # R is included for completeness but is not used in the calculation of T_theta.\n        {'R': 15.0, 'a0': 1.2, 'a1': -0.01, 'T0': 300.0, 'T_min': 350.0, 'T_max': 500.0},\n        # Case 2 (boundary root at lower bracket)\n        {'R': 12.0, 'a0': 0.5, 'a1': 0.02, 'T0': 300.0, 'T_min': 275.0, 'T_max': 350.0},\n        # Case 3 (shallow crossing)\n        {'R': 20.0, 'a0': 0.02, 'a1': -1.0e-4, 'T0': 300.0, 'T_min': 450.0, 'T_max': 550.0},\n    ]\n\n    results = []\n\n    for case in test_cases:\n        a0 = case['a0']\n        a1 = case['a1']\n        T0 = case['T0']\n        T_min = case['T_min']\n        T_max = case['T_max']\n\n        def integrand(x, a_T):\n            \"\"\"\n            The integrand for calculating the reduced second virial coefficient.\n            The expression is x^2 * (exp[-a(T)*exp(-x^2)] - 1).\n            \"\"\"\n            if x == 0:\n                return 0.0\n            return x**2 * (np.exp(-a_T * np.exp(-x**2)) - 1.0)\n\n        def compute_A2_star(T, a0_p, a1_p, T0_p):\n            \"\"\"\n            Computes the reduced second virial coefficient A2*(T) for a given temperature T.\n            \"\"\"\n            # Calculate the temperature-dependent amplitude a(T)\n            a_T = a0_p + a1_p * (T - T0_p)\n            \n            # Numerically integrate the function from 0 to infinity\n            # an additional argument 'a_T' is passed to the integrand function.\n            integral_val, _ = integrate.quad(integrand, 0, np.inf, args=(a_T,))\n            \n            # A2*(T) = -3/2 * integral\n            return -1.5 * integral_val\n\n        # Create the target function for the root finder.\n        # This function takes only temperature T as input.\n        target_func = lambda T: compute_A2_star(T, a0, a1, T0)\n\n        # Evaluate the function at the boundaries of the bracket\n        val_at_min = target_func(T_min)\n        val_at_max = target_func(T_max)\n\n        # Handle boundary cases and find the root\n        if np.isclose(val_at_min, 0.0):\n            # The root is at the lower boundary\n            T_theta = T_min\n        elif np.isclose(val_at_max, 0.0):\n            # The root is at the upper boundary\n            T_theta = T_max\n        else:\n            # For interior roots, use a bracketed root-finding method.\n            # The problem guarantees a sign change is present in these cases.\n            try:\n                T_theta = optimize.brentq(target_func, T_min, T_max)\n            except ValueError:\n                # This block should not be reached based on the problem description,\n                # but is included for robustness.\n                # It would be triggered if f(a) and f(b) have the same sign.\n                # For this specific problem, the analytical solution T_theta = T0 - a0/a1 could be used\n                # as a fallback, but we adhere to the numerical method instruction.\n                T_theta = np.nan # Indicate failure\n\n        # Append the result, rounded to three decimal places.\n        results.append(f\"{T_theta:.3f}\")\n\n    # Print the final output in the required format\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "2934617"}]}