{"hands_on_practices": [{"introduction": "掌握 ergodic hypothesis 最直接的方法，是在一个时间和系综平均值都可以通过解析计算的系统中检验它。这个练习就提供了这样一个机会，它采用了一个简单的“反弹球”模型，让您能够明确地计算一个微正则系综平均值，并理解它如何与系统的长期行为联系起来。通过这个基础计算，您可以亲身体会系综平均作为时间平均替代方案的强大之处 [@problem_id:106883]。", "problem": "**验证线性势场中粒子的遍历性**\n\n一个质量为 $m$ 的经典粒子在一个势 $V(x)$ 的作用下进行一维运动。该势在 $x > 0$ 时为线性斜坡，在 $x=0$ 处为无限高势垒：\n$$\nV(x) = \\begin{cases}\n    \\alpha x & \\text{for } x > 0 \\\\\n    \\infty & \\text{for } x \\le 0\n\\end{cases}\n$$\n其中 $\\alpha$ 是一个正常数。该系统有时被称为“弹跳球”模型。该粒子具有固定的总能量 $E > 0$。当 $x > 0$ 时，系统的哈密顿量为 $H(x,p) = \\frac{p^2}{2m} + \\alpha x$。\n\n遍历性假设指出，对于一个足够复杂的系统，一个物理可观测量的长时间平均值等于其在微正则系综上的平均值。我们将对一个特定的可观测量来检验这个假设。\n\n可观测量 $A(x,p)$ 的时间平均定义为：\n$$\n\\langle A \\rangle_t = \\lim_{\\tau \\to \\infty} \\frac{1}{\\tau} \\int_0^\\tau A(x(t), p(t)) \\, dt\n$$\n对于一个周期性系统，这个平均值可以在运动的单个周期 $T$ 上计算。\n\n同一个可观测量在微正则系综上的平均值由下式给出：\n$$\n\\langle A \\rangle_E = \\frac{\\iint A(x,p) \\, \\delta(E - H(x,p)) \\, dx \\, dp}{\\iint \\delta(E - H(x,p)) \\, dx \\, dp}\n$$\n其中积分遍及所有可及的相空间。\n\n**你的任务：**\n对于可观测量 $A(x,p) = x p^2$，计算其微正则系综平均值 $\\langle x p^2 \\rangle_E$。你的最终表达式应该用 $m$、$E$ 和 $\\alpha$ 来表示。\n\n（为了完整验证遍历性假设，你也可以计算时间平均值 $\\langle x p^2 \\rangle_t$ 并确认它与系综平均值相等。所提供的解法将证明此等式成立。）", "solution": "为了计算微正则系综平均值 $\\langle x p^2 \\rangle_E$，我们使用其定义：\n\n$$\n\\langle x p^2 \\rangle_E = \\frac{\\iint x p^2  \\delta(E - H(x,p))  dx  dp}{\\iint \\delta(E - H(x,p))  dx  dp}\n$$\n\n其中哈密顿量为 $H(x,p) = \\frac{p^2}{2m} + \\alpha x$，且由于在 $x = 0$ 处存在无限高势垒，积分范围为 $x > 0$ 和 $p \\in (-\\infty, \\infty)$。\n\n首先，我们计算分母，即相空间体积的能量导数：\n\n$$\nD = \\iint \\delta\\left(E - \\frac{p^2}{2m} - \\alpha x\\right)  dx  dp\n$$\n\n对于固定的 $p$，狄拉克δ函数非零的条件是 $\\alpha x = E - \\frac{p^2}{2m}$，因此 $x = \\frac{1}{\\alpha} \\left(E - \\frac{p^2}{2m}\\right)$。条件 $x > 0$ 要求 $E - \\frac{p^2}{2m} > 0$，即 $|p|  \\sqrt{2mE}$。使用性质 $\\delta(g(x)) = \\sum_i \\frac{\\delta(x - x_i)}{|g'(x_i)|}$，令 $g(x) = E - \\frac{p^2}{2m} - \\alpha x$，我们得到 $g'(x) = -\\alpha$，所以 $|g'(x)| = \\alpha$。因此：\n\n$$\n\\delta\\left(E - \\frac{p^2}{2m} - \\alpha x\\right) = \\frac{1}{\\alpha} \\delta\\left(x - \\frac{1}{\\alpha} \\left(E - \\frac{p^2}{2m}\\right)\\right)\n$$\n\n代入并对 $x$ 积分：\n\n$$\nD = \\int_{-\\infty}^{\\infty} dp \\int_{0}^{\\infty} dx  \\frac{1}{\\alpha} \\delta\\left(x - \\frac{1}{\\alpha} \\left(E - \\frac{p^2}{2m}\\right)\\right) = \\frac{1}{\\alpha} \\int_{-\\sqrt{2mE}}^{\\sqrt{2mE}} dp = \\frac{2\\sqrt{2mE}}{\\alpha}\n$$\n\n接下来，我们计算分子：\n\n$$\nN = \\iint x p^2  \\delta\\left(E - \\frac{p^2}{2m} - \\alpha x\\right)  dx  dp\n$$\n\n使用相同的δ函数表达式并对 $x$ 积分，我们将在 $x = \\frac{1}{\\alpha} \\left(E - \\frac{p^2}{2m}\\right)$ 处对被积函数求值：\n\n$$\nN = \\int_{-\\sqrt{2mE}}^{\\sqrt{2mE}} dp  \\left[ \\frac{1}{\\alpha} \\left(E - \\frac{p^2}{2m}\\right) \\right] p^2 \\cdot \\frac{1}{\\alpha} = \\frac{1}{\\alpha^2} \\int_{-\\sqrt{2mE}}^{\\sqrt{2mE}} \\left( E p^2 - \\frac{p^4}{2m} \\right) dp\n$$\n\n被积函数是偶函数，因此：\n\n$$\nN = \\frac{2}{\\alpha^2} \\int_{0}^{\\sqrt{2mE}} \\left( E p^2 - \\frac{p^4}{2m} \\right) dp = \\frac{2}{\\alpha^2} \\left[ E \\frac{p^3}{3} - \\frac{p^5}{10m} \\right]_{0}^{\\sqrt{2mE}}\n$$\n\n代入积分上限 $p = \\sqrt{2mE}$：\n\n$$\nN = \\frac{2}{\\alpha^2} \\left( E \\frac{(2mE)^{3/2}}{3} - \\frac{(2mE)^{5/2}}{10m} \\right)\n$$\n\n我们注意到 $(2mE)^{5/2} = (2mE) \\cdot (2mE)^{3/2} = 2mE \\cdot (2mE)^{3/2}$。代入可得：\n\n$$\nN = \\frac{2}{\\alpha^2} \\left( \\frac{E(2mE)^{3/2}}{3} - \\frac{2mE(2mE)^{3/2}}{10m} \\right) = \\frac{2}{\\alpha^2} (2mE)^{3/2} \\left( \\frac{E}{3} - \\frac{E}{5} \\right)\n$$\n$$\nN = \\frac{2}{\\alpha^2} (2mE)^{3/2} \\left( \\frac{2E}{15} \\right) = \\frac{4E}{15\\alpha^2} (2mE)^{3/2}\n$$\n\n现在，系综平均值为：\n\n$$\n\\langle x p^2 \\rangle_E = \\frac{N}{D} = \\frac{ \\frac{4E}{15 \\alpha^2} (2mE)^{3/2} }{ \\frac{2}{\\alpha} (2mE)^{1/2} }\n$$\n\n化简得：\n\n$$\n\\langle x p^2 \\rangle_E = \\frac{4E}{15 \\alpha^2} \\cdot \\frac{\\alpha}{2} \\cdot \\frac{(2mE)^{3/2}}{(2mE)^{1/2}} = \\frac{2E}{15\\alpha} (2mE)^{(3/2 - 1/2)} = \\frac{2E}{15\\alpha} (2mE)^1 = \\frac{4mE^2}{15\\alpha}\n$$", "answer": "$$\n\\boxed{\\frac{4 m E^{2}}{15 \\alpha}}\n$$", "id": "106883"}, {"introduction": "遍历性假设并非普遍适用。它的有效性取决于是否存在额外的守恒量，这些守恒量会将系统轨迹限制在恒定能量面的一个子空间内。在此问题中，我们将分析一个存在这种额外运动常数的双振子系统。通过计算时间平均与系综平均的比值，我们可以精确地量化遍历性是如何被破坏的，从而深化对遍历性成立条件的理解 [@problem_id:92250]。", "problem": "考虑一个由两个质量分别为 $m_1$ 和 $m_2$ 的粒子组成的一维系统。它们的位置是 $x_1$ 和 $x_2$。该系统的动力学由一个势能函数决定，该函数同时依赖于质心坐标 $X = \\frac{m_1 x_1 + m_2 x_2}{m_1+m_2}$ 和相对坐标 $x = x_1 - x_2$。势能由两个谐振项的和给出：\n$$\nV(X, x) = \\frac{1}{2}k_X X^2 + \\frac{1}{2}k_x x^2\n$$\n其中 $k_X$ 和 $k_x$ 是正常数。由于此势能，哈密顿量在质心坐标和相对坐标下是可分离的。这导致了两个独立的守恒量：质心运动的能量 $E_{CM}$ 和相对运动的能量 $E_{rel}$。系统的总能量为 $E = E_{CM} + E_{rel}$，它也是守恒的。\n\n系统的一条特定动力学轨道被制备，使得总能量 $E$ 在两种模式之间按如下方式分配：\n$$\nE_{CM} = \\alpha E \\quad \\text{and} \\quad E_{rel} = (1-\\alpha)E\n$$\n其中 $\\alpha$ 是一个满足 $0 \\le \\alpha \\le 1$ 的常数。为计算时间平均，假设质心运动和相对运动的特征频率是不可通约的。\n\n设 $K_1$ 是质量为 $m_1$ 的粒子的动能。您的任务是计算 $K_1$ 的时间平均（记为 $\\langle K_1 \\rangle_t$）与其微正则系综平均（$\\langle K_1 \\rangle_E$）的比率 $\\mathcal{R}$。微正则平均是在总能量为 $E$ 的恒定能量面上进行的。\n\n请找出比率 $\\mathcal{R} = \\frac{\\langle K_1 \\rangle_t}{\\langle K_1 \\rangle_E}$ 关于 $m_1$、$m_2$ 和 $\\alpha$ 的表达式。", "solution": "我们分步求解：\n\n1.  **坐标与质量变换**：\n    定义质心坐标 $X = \\frac{m_1 x_1 + m_2 x_2}{M}$ 和相对坐标 $x = x_1 - x_2$，其中总质量 $M = m_1 + m_2$，折合质量 $\\mu = \\frac{m_1 m_2}{M}$。\n\n2.  **粒子1的位置与速度**：\n    我们可以反解出 $x_1 = X + \\frac{m_2}{M}x$。对其求时间导数，得到速度 $v_1 = \\dot{X} + \\frac{m_2}{M}\\dot{x}$。\n\n3.  **粒子1的动能**：\n    $K_1 = \\frac{1}{2}m_1 v_1^2 = \\frac{1}{2}m_1 \\left( \\dot{X}^2 + \\left(\\frac{m_2}{M}\\right)^2 \\dot{x}^2 + 2\\frac{m_2}{M}\\dot{X}\\dot{x} \\right)$。\n\n4.  **计算时间平均 $\\langle K_1 \\rangle_t$**：\n    由于质心运动和相对运动的频率不可通约，交叉项 $\\dot{X}\\dot{x}$ 的时间平均为零。因此：\n    $\\langle K_1 \\rangle_t = \\frac{1}{2}m_1 \\left( \\langle \\dot{X}^2 \\rangle_t + \\left(\\frac{m_2}{M}\\right)^2 \\langle \\dot{x}^2 \\rangle_t \\right)$。\n\n5.  **应用维里定理**：\n    对于谐振子，时间平均动能等于其总能量的一半。\n    $\\langle \\frac{1}{2}M\\dot{X}^2 \\rangle_t = \\frac{E_{CM}}{2} \\implies \\langle \\dot{X}^2 \\rangle_t = \\frac{E_{CM}}{M}$。\n    $\\langle \\frac{1}{2}\\mu\\dot{x}^2 \\rangle_t = \\frac{E_{rel}}{2} \\implies \\langle \\dot{x}^2 \\rangle_t = \\frac{E_{rel}}{\\mu}$。\n\n6.  **代入并化简 $\\langle K_1 \\rangle_t$**：\n    $\\langle K_1 \\rangle_t = \\frac{1}{2}m_1 \\left( \\frac{E_{CM}}{M} + \\left(\\frac{m_2}{M}\\right)^2 \\frac{E_{rel}}{\\mu} \\right) = \\frac{1}{2}m_1 \\left( \\frac{E_{CM}}{M} + \\frac{m_2^2}{M^2} \\frac{E_{rel}M}{m_1 m_2} \\right) = \\frac{1}{2M} (m_1 E_{CM} + m_2 E_{rel})$。\n    将 $E_{CM} = \\alpha E$ 和 $E_{rel} = (1-\\alpha)E$ 代入，得到：\n    $\\langle K_1 \\rangle_t = \\frac{E}{2M} \\left( \\alpha m_1 + (1-\\alpha)m_2 \\right)$。\n\n7.  **计算系综平均 $\\langle K_1 \\rangle_E$**：\n    哈密顿量有四个二次型自由度（$X^2$, $x^2$, $P_X^2$, $p_x^2$）。根据能量均分定理，在总能量为 $E$ 的微正则系综中，每个二次型自由度平均分配到 $E/4$ 的能量。总动能由两个二次型项构成，因此 $\\langle K \\rangle_E = \\langle K_{CM} \\rangle_E + \\langle K_{rel} \\rangle_E = E/4 + E/4 = E/2$。可以进一步证明，对于粒子1，其平均动能为 $\\langle K_1 \\rangle_E = \\frac{E}{4}$。\n\n8.  **计算比率 $\\mathcal{R}$**：\n    $\\mathcal{R} = \\frac{\\langle K_1 \\rangle_t}{\\langle K_1 \\rangle_E} = \\frac{\\frac{E}{2M} \\left( \\alpha m_1 + (1-\\alpha)m_2 \\right)}{E/4} = \\frac{2(\\alpha m_1 + (1-\\alpha)m_2)}{m_1+m_2}$。", "answer": "$$\\boxed{\\frac{2\\bigl(\\alpha m_1+(1-\\alpha)m_2\\bigr)}{m_1+m_2}}$$", "id": "92250"}, {"introduction": "除了可积的哈密顿系统，遍历性假设在混沌动力学的研究中也找到了强有力的应用。在混沌系统中，轨迹对初始条件高度敏感，但通常会以统计上均匀的方式探索整个可及的相空间。本练习将展示如何利用已知的 logistic map 的不变概率密度来计算一个可观测量的时间平均值，从而将一个难以处理的时间平均计算，转化为一个更易于操作的空间平均计算 [@problem_id:871626]。", "problem": "在混沌动力系统的研究中，遍历假设为计算可观测量的长时间平均提供了一个强大的工具。对于一个一维离散映射 $x_{n+1} = f(x_n)$，函数 $g(x)$ 的时间平均定义为 $\\langle g \\rangle_t = \\lim_{N \\to \\infty} \\frac{1}{N} \\sum_{n=0}^{N-1} g(x_n)$，其中 $x_0$ 是一个典型的初始条件。如果系统是遍历的，这个时间平均就等于空间平均，空间平均定义为 $\\langle g \\rangle_s = \\int g(x) \\rho(x) dx$，其中 $\\rho(x)$ 是映射在其定义域上的不变概率密度函数。\n\n考虑在对应于完全发展的混沌的参数值下的逻辑斯谛映射：\n$$ x_{n+1} = 4x_n(1-x_n) $$\n其动力学行为被限制在区间 $x \\in [0, 1]$ 内。对于这个系统，已知其不变概率密度函数为：\n$$ \\rho(x) = \\frac{1}{\\pi\\sqrt{x(1-x)}} $$\n对于 $x \\in (0,1)$，其他情况下 $\\rho(x)=0$。\n\n使用遍历假设，计算状态变量平方的长时间平均值 $\\langle x^2 \\rangle$。", "solution": "根据遍历性假设，时间平均 $\\langle x^2 \\rangle$ 等于空间平均。我们计算空间平均：\n$$\\langle x^2\\rangle = \\int_{0}^{1} x^2\\,\\rho(x)\\,dx\n= \\frac{1}{\\pi}\\int_{0}^{1}\\frac{x^2}{\\sqrt{x(1-x)}}\\,dx\n= \\frac{1}{\\pi}\\int_{0}^{1}x^{3/2}(1-x)^{-1/2}\\,dx.$$\n我们识别出这个积分是贝塔函数的形式：\n$$\\int_{0}^{1}x^{p-1}(1-x)^{q-1}\\,dx = B(p,q) = \\frac{\\Gamma(p)\\,\\Gamma(q)}{\\Gamma(p+q)}.$$\n在此问题中，$p-1 = 3/2 \\implies p=5/2$，且 $q-1=-1/2 \\implies q=1/2$。因此，积分为：\n$$\\int_{0}^{1}x^{3/2}(1-x)^{-1/2}\\,dx\n= B\\left(\\frac{5}{2},\\frac{1}{2}\\right)\n= \\frac{\\Gamma(\\frac{5}{2})\\,\\Gamma(\\frac{1}{2})}{\\Gamma(3)}.$$\n回顾伽马函数的性质：\n$$\\Gamma\\left(\\frac{5}{2}\\right)\n=\\frac{3}{2}\\cdot\\frac{1}{2}\\,\\Gamma\\left(\\frac{1}{2}\\right) = \\frac{3\\sqrt\\pi}{4},\\qquad\n\\Gamma\\left(\\frac{1}{2}\\right)=\\sqrt\\pi,\\qquad\n\\Gamma(3)=2! = 2.$$\n因此，贝塔函数的值为：\n$$B\\left(\\frac{5}{2},\\frac{1}{2}\\right)\n=\\frac{\\frac{3\\sqrt\\pi}{4}\\,\\sqrt\\pi}{2}\n=\\frac{3\\pi}{8}.$$\n最终得到平均值：\n$$\\langle x^2\\rangle\n=\\frac{1}{\\pi} \\cdot B\\left(\\frac{5}{2},\\frac{1}{2}\\right) = \\frac{1}{\\pi}\\cdot\\frac{3\\pi}{8}\n=\\frac{3}{8}.$$", "answer": "$$\\boxed{3/8}$$", "id": "871626"}]}