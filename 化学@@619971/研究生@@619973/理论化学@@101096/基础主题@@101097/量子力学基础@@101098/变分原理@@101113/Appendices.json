{"hands_on_practices": [{"introduction": "我们将从一个经典且基础的例子开始：应用变分原理来估算氢原子的基态能量。这个练习将指导你选择一个高斯型试探波函数，从头计算其能量期望值，并通过对变分参数求极小值来优化该函数。通过这个实践[@problem_id:2823576]，你将掌握应用变分法的核心流程，这对于理解更复杂的量子化学计算至关重要。", "problem": "在哈特里原子单位 (a.u.) 中，对于一个在电荷为 $Z$ 的原子核场中的单电子，其非相对论类氢哈密顿量为 $H = -\\frac{1}{2} \\nabla^{2} - \\frac{Z}{r}$。考虑与氢原子 $1s$ 态的归一化实试探函数 $\\psi(\\mathbf{r})$ 相关联的瑞利商 $R[\\psi] = \\frac{\\langle \\psi | H | \\psi \\rangle}{\\langle \\psi | \\psi \\rangle}$。利用 Rayleigh-Ritz 变分原理，采用一个以原子核为中心的单参数 $s$ 型高斯试探函数，\n$$\n\\psi_{\\alpha}(\\mathbf{r}) = N(\\alpha) \\exp(-\\alpha r^{2}),\n$$\n其中 $\\alpha > 0$ 且 $N(\\alpha)$ 为归一化常数。请显式计算 $R[\\psi_{\\alpha}]$ 关于 $\\alpha$ 和 $Z$ 的表达式，然后将 $\\alpha$ 视为一个连续的变分参数，对该表达式关于 $\\alpha$ 进行最小化。导出使瑞利商最小化的最优高斯指数 $\\alpha^{\\star}$ 的精确解析表达式。在整个计算过程中保持 $Z$ 为符号。你的最终答案必须是 $\\alpha^{\\star}$ 关于 $Z$ 的单个闭式表达式。始终使用原子单位。不要使用预先制表的积分公式；从第一性原理计算所有需要的积分。不需要进行数值取整。", "solution": "提交分析的问题陈述被判定为**有效**。这是一个量子力学中提法恰当、有科学依据的问题，完全属于理论化学和原子物理的范畴。该问题是自洽的，其前提在事实上是正确的，并且没有歧义或矛盾。它代表了 Rayleigh-Ritz 变分原理的一个标准应用。我们开始进行解答。\n\n目标是为试探波函数 $\\psi_{\\alpha}(\\mathbf{r}) = N(\\alpha) \\exp(-\\alpha r^{2})$ 找到最优参数 $\\alpha^{\\star}$，以使核电荷为 $Z$ 的类氢原子的能量期望值最小化。在原子单位中，哈密顿量为 $H = -\\frac{1}{2} \\nabla^{2} - \\frac{Z}{r}$。变分能量由瑞利商 $E(\\alpha) = \\frac{\\langle \\psi_{\\alpha} | H | \\psi_{\\alpha} \\rangle}{\\langle \\psi_{\\alpha} | \\psi_{\\alpha} \\rangle}$ 给出。\n\n首先，我们对试探波函数进行归一化。归一化条件是 $\\langle \\psi_{\\alpha} | \\psi_{\\alpha} \\rangle = 1$。球坐标系中的体积元是 $d\\tau = r^{2} \\sin\\theta d\\theta d\\phi dr$。\n$$\n\\langle \\psi_{\\alpha} | \\psi_{\\alpha} \\rangle = \\int_{\\mathbb{R}^3} |\\psi_{\\alpha}(\\mathbf{r})|^2 d\\tau = N^{2} \\int_{0}^{2\\pi} d\\phi \\int_{0}^{\\pi} \\sin\\theta d\\theta \\int_{0}^{\\infty} \\exp(-2\\alpha r^{2}) r^{2} dr = 1\n$$\n角向积分得到 $4\\pi$。\n$$\n4\\pi N^{2} \\int_{0}^{\\infty} r^{2} \\exp(-2\\alpha r^{2}) dr = 1\n$$\n为了计算径向积分（我们记为 $I_2$），我们利用积分号下求导的技巧。考虑基本高斯积分 $I_0(a) = \\int_{0}^{\\infty} \\exp(-ar^{2}) dr = \\frac{1}{2}\\sqrt{\\frac{\\pi}{a}}$。\n积分 $I_2$ 可表示为：\n$$\nI_2 = \\int_{0}^{\\infty} r^{2} \\exp(-ar^{2}) dr = -\\frac{d}{da} I_0(a) = -\\frac{d}{da} \\left( \\frac{1}{2}\\sqrt{\\frac{\\pi}{a}} \\right) = -\\frac{\\sqrt{\\pi}}{2} \\left(-\\frac{1}{2}a^{-3/2}\\right) = \\frac{\\sqrt{\\pi}}{4a^{3/2}}\n$$\n在我们的情况中，参数是 $a = 2\\alpha$。\n$$\n\\int_{0}^{\\infty} r^{2} \\exp(-2\\alpha r^{2}) dr = \\frac{\\sqrt{\\pi}}{4(2\\alpha)^{3/2}} = \\frac{\\sqrt{\\pi}}{4 \\cdot 2\\sqrt{2} \\alpha^{3/2}} = \\frac{\\pi^{1/2}}{8\\sqrt{2}\\alpha^{3/2}}\n$$\n将此结果代入归一化条件：\n$$\n4\\pi N^{2} \\left( \\frac{\\pi^{1/2}}{8\\sqrt{2}\\alpha^{3/2}} \\right) = N^{2} \\frac{\\pi^{3/2}}{2\\sqrt{2}\\alpha^{3/2}} = 1\n$$\n求解归一化常数的平方 $N^{2}$：\n$$\nN^{2} = \\frac{2\\sqrt{2}\\alpha^{3/2}}{\\pi^{3/2}} = \\frac{2^{3/2}\\alpha^{3/2}}{\\pi^{3/2}} = \\left(\\frac{2\\alpha}{\\pi}\\right)^{3/2}\n$$\n对于归一化的波函数，能量为 $E(\\alpha) = \\langle \\psi_{\\alpha} | H | \\psi_{\\alpha} \\rangle = \\langle T \\rangle + \\langle V \\rangle$。\n\n接下来，我们计算动能的期望值，$\\langle T \\rangle = \\langle \\psi_{\\alpha} | -\\frac{1}{2}\\nabla^{2} | \\psi_{\\alpha} \\rangle$。\n一个更直接的方法是使用恒等式 $\\langle T \\rangle = \\frac{1}{2} \\int (\\nabla \\psi_{\\alpha}) \\cdot (\\nabla \\psi_{\\alpha}) d\\tau$，这可以通过分部积分得到。对于球对称函数 $\\psi_{\\alpha}(r)$，其梯度为 $\\nabla \\psi_{\\alpha} = \\frac{d\\psi_{\\alpha}}{dr}\\hat{r}$。\n$$\n\\frac{d\\psi_{\\alpha}}{dr} = N \\frac{d}{dr}(\\exp(-\\alpha r^{2})) = -2\\alpha r N \\exp(-\\alpha r^{2})\n$$\n梯度的模平方为：\n$$\n(\\nabla \\psi_{\\alpha}) \\cdot (\\nabla \\psi_{\\alpha}) = \\left| \\frac{d\\psi_{\\alpha}}{dr} \\right|^{2} = 4\\alpha^{2}r^{2}N^{2}\\exp(-2\\alpha r^{2})\n$$\n动能期望值为：\n$$\n\\langle T \\rangle = \\frac{1}{2} \\int (4\\alpha^{2}r^{2}N^{2}\\exp(-2\\alpha r^{2})) (r^{2} \\sin\\theta d\\theta d\\phi dr)\n$$\n$$\n\\langle T \\rangle = \\frac{1}{2} (4\\pi) (4\\alpha^{2}N^{2}) \\int_{0}^{\\infty} r^{4} \\exp(-2\\alpha r^{2}) dr = 8\\pi\\alpha^{2}N^{2} \\int_{0}^{\\infty} r^{4} \\exp(-2\\alpha r^{2}) dr\n$$\n所需的积分 $I_4 = \\int_{0}^{\\infty} r^{4} \\exp(-ar^{2}) dr$ 可通过对 $I_2$ 求导得到：\n$$\nI_4 = -\\frac{d}{da} I_2 = -\\frac{d}{da} \\left( \\frac{\\sqrt{\\pi}}{4}a^{-3/2} \\right) = -\\frac{\\sqrt{\\pi}}{4} \\left(-\\frac{3}{2}a^{-5/2}\\right) = \\frac{3\\sqrt{\\pi}}{8a^{5/2}}\n$$\n当 $a = 2\\alpha$ 时：\n$$\n\\int_{0}^{\\infty} r^{4} \\exp(-2\\alpha r^{2}) dr = \\frac{3\\sqrt{\\pi}}{8(2\\alpha)^{5/2}} = \\frac{3\\pi^{1/2}}{8 \\cdot 4\\sqrt{2}\\alpha^{5/2}} = \\frac{3\\pi^{1/2}}{32\\sqrt{2}\\alpha^{5/2}}\n$$\n将此结果代入 $\\langle T \\rangle$ 的表达式中：\n$$\n\\langle T \\rangle = 8\\pi\\alpha^{2}N^{2} \\left( \\frac{3\\pi^{1/2}}{32\\sqrt{2}\\alpha^{5/2}} \\right) = N^{2} \\frac{3\\pi^{3/2}\\alpha^{-1/2}}{4\\sqrt{2}}\n$$\n现在，代入 $N^{2}$ 的表达式：\n$$\n\\langle T \\rangle = \\left(\\frac{2\\sqrt{2}\\alpha^{3/2}}{\\pi^{3/2}}\\right) \\left( \\frac{3\\pi^{3/2}}{4\\sqrt{2}\\alpha^{1/2}} \\right) = \\frac{6}{4}\\alpha = \\frac{3}{2}\\alpha\n$$\n\n接下来，我们计算势能的期望值，$\\langle V \\rangle = \\langle \\psi_{\\alpha} | -\\frac{Z}{r} | \\psi_{\\alpha} \\rangle$。\n$$\n\\langle V \\rangle = -Z \\int |\\psi_{\\alpha}|^2 \\frac{1}{r} d\\tau = -Z (4\\pi) N^{2} \\int_{0}^{\\infty} \\exp(-2\\alpha r^{2}) \\frac{1}{r} r^{2} dr\n$$\n$$\n\\langle V \\rangle = -4\\pi Z N^{2} \\int_{0}^{\\infty} r \\exp(-2\\alpha r^{2}) dr\n$$\n积分 $\\int_{0}^{\\infty} r \\exp(-ar^{2}) dr$ 可通过换元法计算。令 $u = ar^{2}$，则 $du = 2ar dr$，所以 $r dr = \\frac{du}{2a}$。\n$$\n\\int_{0}^{\\infty} r \\exp(-ar^{2}) dr = \\int_{0}^{\\infty} \\exp(-u) \\frac{du}{2a} = \\frac{1}{2a} [-\\exp(-u)]_{0}^{\\infty} = \\frac{1}{2a}(0 - (-1)) = \\frac{1}{2a}\n$$\n当 $a = 2\\alpha$ 时，该积分为 $\\frac{1}{4\\alpha}$。\n$$\n\\langle V \\rangle = -4\\pi Z N^{2} \\left( \\frac{1}{4\\alpha} \\right) = -\\frac{\\pi Z N^{2}}{\\alpha}\n$$\n代入 $N^{2}$ 的表达式：\n$$\n\\langle V \\rangle = -\\frac{\\pi Z}{\\alpha} \\left( \\frac{2\\sqrt{2}\\alpha^{3/2}}{\\pi^{3/2}} \\right) = -Z \\frac{2\\sqrt{2}\\alpha^{1/2}}{\\pi^{1/2}} = -Z\\sqrt{\\frac{8\\alpha}{\\pi}}\n$$\n\n总能量作为 $\\alpha$ 的函数是：\n$$\nE(\\alpha) = \\langle T \\rangle + \\langle V \\rangle = \\frac{3}{2}\\alpha - Z\\sqrt{\\frac{8}{\\pi}}\\sqrt{\\alpha}\n$$\n为了找到使能量最小化的最优值 $\\alpha^{\\star}$，我们将 $E(\\alpha)$ 对 $\\alpha$ 求导，并令其结果为零：\n$$\n\\frac{dE}{d\\alpha} = \\frac{d}{d\\alpha} \\left( \\frac{3}{2}\\alpha - Z\\sqrt{\\frac{8}{\\pi}}\\alpha^{1/2} \\right) = \\frac{3}{2} - Z\\sqrt{\\frac{8}{\\pi}} \\left( \\frac{1}{2}\\alpha^{-1/2} \\right) = 0\n$$\n$$\n\\frac{3}{2} = \\frac{Z}{2} \\sqrt{\\frac{8}{\\pi\\alpha}}\n$$\n$$\n3 = Z \\sqrt{\\frac{8}{\\pi\\alpha}}\n$$\n两边平方得：\n$$\n9 = Z^{2} \\left( \\frac{8}{\\pi\\alpha} \\right)\n$$\n最后，解出最优参数 $\\alpha^{\\star}$：\n$$\n9\\pi\\alpha^{\\star} = 8Z^{2}\n$$\n$$\n\\alpha^{\\star} = \\frac{8Z^{2}}{9\\pi}\n$$\n这就是最优高斯指数的最终表达式。", "answer": "$$\\boxed{\\frac{8Z^{2}}{9\\pi}}$$", "id": "2823576"}, {"introduction": "掌握了优化单个试探函数的方法后，下一个关键问题是：我们如何评判一个试探函数的好坏？这个练习[@problem_id:2144152]通过对同一个势阱（狄拉克 $ \\delta $ 函数势）使用两种不同形式的试探函数（高斯函数和洛伦兹函数），来直接比较它们的表现。通过计算和比较两种情况下得到的能量上限，你将深刻体会到试探函数的选择对变分计算结果的决定性影响。", "problem": "一个质量为 $m$ 的粒子被限制在一维空间中，并受到一个吸引势 $V(x) = -\\alpha \\delta(x)$ 的作用，其中 $\\alpha$ 是一个实正常数，$\\delta(x)$ 是狄拉克δ函数。变分原理可用于估计该系统的基态能量，方法是计算给定试探波函数下哈密顿量的期望值。\n\n提出了两种不同的归一化试探波函数族：\n1. 高斯函数：$\\psi_G(x, \\beta) = N_G \\exp(-\\beta x^2)$，其中 $\\beta > 0$ 是一个变分参数， $N_G$ 是归一化常数。\n2. 洛伦兹函数：$\\psi_L(x, \\gamma) = N_L (\\gamma^2 + x^2)^{-1}$，其中 $\\gamma > 0$ 是一个变分参数， $N_L$ 是归一化常数。\n\n对于每种函数形式，需要对变分参数（$\\beta$ 或 $\\gamma$）进行优化，以找到可能的最低能量估计值。设高斯和洛伦兹试探函数的这些最低能量分别为 $E_G$ 和 $E_L$。请计算比值 $E_L/E_G$。", "solution": "我们对哈密顿量 $H = -\\frac{\\hbar^{2}}{2m}\\frac{d^{2}}{dx^{2}} - \\alpha \\delta(x)$ 使用变分原理。对于任何归一化的实试探波函数 $\\psi(x)$，其能量期望值为\n$$\nE[\\psi] = \\frac{\\hbar^{2}}{2m} \\int_{-\\infty}^{\\infty} \\left(\\frac{d\\psi}{dx}\\right)^{2} dx - \\alpha |\\psi(0)|^{2},\n$$\n其中动能项使用了分部积分，并利用了 $\\int \\delta(x) |\\psi(x)|^{2} dx = |\\psi(0)|^{2}$。\n\n高斯试探函数 $\\psi_{G}(x,\\beta) = N_{G} \\exp(-\\beta x^{2})$，其中 $\\beta>0$：\n归一化要求\n$$\n1 = \\int_{-\\infty}^{\\infty} |N_{G}|^{2} \\exp(-2\\beta x^{2}) dx = |N_{G}|^{2} \\sqrt{\\frac{\\pi}{2\\beta}},\n$$\n所以 $N_{G} = \\left(\\frac{2\\beta}{\\pi}\\right)^{1/4}$ 且 $|\\psi_{G}(0)|^{2} = |N_{G}|^{2} = \\sqrt{\\frac{2\\beta}{\\pi}}$。其导数为 $\\psi_{G}' = -2\\beta x \\psi_{G}$，因此\n$$\n\\int_{-\\infty}^{\\infty} (\\psi_{G}')^{2} dx = 4\\beta^{2} \\int_{-\\infty}^{\\infty} x^{2} |\\psi_{G}|^{2} dx = 4\\beta^{2} \\cdot \\frac{1}{4\\beta} = \\beta,\n$$\n这里利用 $\\int x^{2} e^{-2\\beta x^{2}} dx$ 和归一化条件得到 $\\langle x^{2}\\rangle = \\frac{1}{4\\beta}$。因此\n$$\nE_{G}(\\beta) = \\frac{\\hbar^{2}}{2m}\\beta - \\alpha \\sqrt{\\frac{2\\beta}{\\pi}}.\n$$\n进行优化，令 $\\frac{dE_{G}}{d\\beta} = \\frac{\\hbar^{2}}{2m} - \\alpha \\frac{1}{2}\\sqrt{\\frac{2}{\\pi}}\\beta^{-1/2} = 0$，这给出\n$$\n\\beta^{1/2} = \\frac{m\\alpha}{\\hbar^{2}} \\sqrt{\\frac{2}{\\pi}}, \\quad \\beta_{*} = \\frac{2}{\\pi}\\left(\\frac{m\\alpha}{\\hbar^{2}}\\right)^{2}.\n$$\n代入得，\n$$\nE_{G} = \\frac{\\hbar^{2}}{2m}\\beta_{*} - \\alpha \\sqrt{\\frac{2\\beta_{*}}{\\pi}} = \\frac{m\\alpha^{2}}{\\pi \\hbar^{2}} - \\frac{2 m \\alpha^{2}}{\\pi \\hbar^{2}} = - \\frac{m \\alpha^{2}}{\\pi \\hbar^{2}}.\n$$\n\n洛伦兹试探函数 $\\psi_{L}(x,\\gamma) = N_{L} (\\gamma^{2}+x^{2})^{-1}$，其中 $\\gamma>0$：\n归一化使用\n$$\n\\int_{-\\infty}^{\\infty} \\frac{dx}{(\\gamma^{2}+x^{2})^{2}} = \\frac{\\pi}{2\\gamma^{3}},\n$$\n因此 $N_{L} = \\sqrt{\\frac{2\\gamma^{3}}{\\pi}}$ 且\n$$\n|\\psi_{L}(0)|^{2} = \\frac{N_{L}^{2}}{\\gamma^{4}} = \\frac{2}{\\pi \\gamma}.\n$$\n其导数为 $\\psi_{L}' = N_{L}\\left[-\\frac{2x}{(\\gamma^{2}+x^{2})^{2}}\\right]$，所以\n$$\n\\int_{-\\infty}^{\\infty} (\\psi_{L}')^{2} dx = 4 N_{L}^{2} \\int_{-\\infty}^{\\infty} \\frac{x^{2}}{(\\gamma^{2}+x^{2})^{4}} dx.\n$$\n令 $x=\\gamma t$，则 $dx=\\gamma dt$，该积分变为\n$$\n\\int_{-\\infty}^{\\infty} \\frac{x^{2}}{(\\gamma^{2}+x^{2})^{4}} dx = \\gamma^{-5} \\int_{-\\infty}^{\\infty} \\frac{t^{2}}{(1+t^{2})^{4}} dt = \\gamma^{-5} \\cdot \\frac{\\pi}{16},\n$$\n其中使用了 $\\int_{-\\infty}^{\\infty} \\frac{t^{2}}{(1+t^{2})^{4}} dt = \\frac{\\pi}{16}$。因此\n$$\n\\int_{-\\infty}^{\\infty} (\\psi_{L}')^{2} dx = 4 \\cdot \\frac{2\\gamma^{3}}{\\pi} \\cdot \\frac{\\pi}{16} \\cdot \\gamma^{-5} = \\frac{1}{2}\\gamma^{-2},\n$$\n并且\n$$\nE_{L}(\\gamma) = \\frac{\\hbar^{2}}{2m} \\cdot \\frac{1}{2}\\gamma^{-2} - \\alpha \\cdot \\frac{2}{\\pi}\\gamma^{-1} = \\frac{\\hbar^{2}}{4m}\\gamma^{-2} - \\frac{2\\alpha}{\\pi}\\gamma^{-1}.\n$$\n令 $y=\\gamma^{-1}$，则 $E_{L}(y) = \\frac{\\hbar^{2}}{4m} y^{2} - \\frac{2\\alpha}{\\pi} y$，在 $y_{*} = \\frac{4 m \\alpha}{\\pi \\hbar^{2}}$ 处取得最小值，并且\n$$\nE_{L} = - \\frac{\\left(\\frac{2\\alpha}{\\pi}\\right)^{2}}{4 \\cdot \\frac{\\hbar^{2}}{4m}} = - \\frac{4 m \\alpha^{2}}{\\pi^{2} \\hbar^{2}}.\n$$\n\n最小能量之比为\n$$\n\\frac{E_{L}}{E_{G}} = \\frac{ - \\frac{4 m \\alpha^{2}}{\\pi^{2} \\hbar^{2}} }{ - \\frac{ m \\alpha^{2} }{ \\pi \\hbar^{2} } } = \\frac{4}{\\pi}.\n$$", "answer": "$$\\boxed{\\frac{4}{\\pi}}$$", "id": "2144152"}, {"introduction": "最后，我们将理论与现代量子化学的计算实践联系起来。在实际计算中，我们通常使用大型非正交基组，这会引入线性变分法中的一个关键数值问题：重叠矩阵 $ \\mathbf{S} $ 的近奇异性。这个高级练习[@problem_id:2823522]将引导你分析这种数值不稳定性的根源，并推导出典范正交化方法来解决它，确保变分计算的准确性和鲁棒性。", "problem": "在分子量子力学的线性变分法中，近似基态被表示为一组非正交基函数 $\\{ \\chi_{\\mu} \\}_{\\mu=1}^{M}$ 的线性组合，其系数向量为 $\\mathbf{c} \\in \\mathbb{R}^{M}$。在此试探子空间中，能量的瑞利商为\n$$\nE[\\mathbf{c}] \\;=\\; \\frac{\\mathbf{c}^{\\mathsf{T}} \\mathbf{H} \\,\\mathbf{c}}{\\mathbf{c}^{\\mathsf{T}} \\mathbf{S} \\,\\mathbf{c}},\n$$\n其中 $\\mathbf{H}$ 是哈密顿矩阵，其元素为 $H_{\\mu \\nu} = \\langle \\chi_{\\mu} | \\hat{H} | \\chi_{\\nu} \\rangle$，$\\mathbf{S}$ 是重叠矩阵，其元素为 $S_{\\mu \\nu} = \\langle \\chi_{\\mu} | \\chi_{\\nu} \\rangle$。矩阵 $\\mathbf{S}$ 是对称半正定的。当 $\\mathbf{S}$ 近奇异时，求解 $E[\\mathbf{c}]$ 极值的广义本征值问题可能会出现数值不稳定性。\n\n任务1（基于基本原理的分析）：仅使用瑞利商的性质以及 $\\mathbf{H}$ 和 $\\mathbf{S}$ 的对称性和定性，解释当试探向量序列与 $\\mathbf{S}$ 具有很小本征值的方向对齐时，为何会导致出现伪性的大幅值（包括极负值）变分能，从而损害数值稳定性。\n\n任务2（推导）：推导一个变换 $\\mathbf{X}$，它将 $\\mathbf{c} = \\mathbf{X}\\mathbf{d}$ 映射到一个新的表示，在该表示中，重叠矩阵在一个保留子空间上成为单位矩阵，同时舍弃与重叠本征值严格小于用户指定阈值 $\\tau > 0$ 相关的方向。推导必须从 $\\mathbf{S}$ 的谱性质以及要求变换后的瑞利商在保留子空间上是良定义的，并且该变换不改变该子空间内的变分排序开始。论证为何所得的正交归一化在保留良态方向的张成空间并根据舍弃规则最小化变分精度损失的意义上是典则的。\n\n任务3（应用与计算）：考虑一个三函数基，$M = 3$，其近奇异的重叠矩阵通过其谱分解指定\n$$\n\\mathbf{S} \\;=\\; \\mathbf{U}\\,\\mathrm{diag}(s_{1}, s_{2}, s_{3})\\,\\mathbf{U}^{\\mathsf{T}},\n$$\n其中正交矩阵 $\\mathbf{U}$ 的列向量为\n$$\n\\mathbf{u}_{1} \\;=\\; \\frac{1}{\\sqrt{3}}\\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix}, \\quad\n\\mathbf{u}_{2} \\;=\\; \\frac{1}{\\sqrt{2}}\\begin{pmatrix} 1 \\\\ -1 \\\\ 0 \\end{pmatrix}, \\quad\n\\mathbf{u}_{3} \\;=\\; \\frac{1}{\\sqrt{6}}\\begin{pmatrix} 1 \\\\ 1 \\\\ -2 \\end{pmatrix},\n$$\n重叠本征值为 $s_{1} = \\frac{19}{10}$，$s_{2} = 1$，$s_{3} = 10^{-4}$。哈密顿矩阵与 $\\mathbf{S}$ 谱对齐，\n$$\n\\mathbf{H} \\;=\\; \\mathbf{U}\\,\\mathrm{diag}(h_{1}, h_{2}, h_{3})\\,\\mathbf{U}^{\\mathsf{T}},\n$$\n其中 $h_{1} = -1$，$h_{2} = -\\frac{1}{2}$，$h_{3} = -2$。使用任务2中推导的变换，并设阈值 $\\tau = 10^{-3}$，在保留子空间中构建一个正交归一化表示，然后确定在该保留子空间中获得的变分基态能。最终能量以哈特里（原子单位）表示。如果可能，给出精确值；不要四舍五入。最终答案必须是单个数字或单个封闭形式的解析表达式。", "solution": "该问题科学依据充分，提法明确，并包含足够信息以获得唯一解。将按要求分三部分作答。\n\n第1部分：数值不稳定性分析\n\n变分能由瑞利商给出：\n$$\nE[\\mathbf{c}] \\;=\\; \\frac{\\mathbf{c}^{\\mathsf{T}} \\mathbf{H} \\,\\mathbf{c}}{\\mathbf{c}^{\\mathsf{T}} \\mathbf{S} \\,\\mathbf{c}}\n$$\n此处，$\\mathbf{c}$ 是试探波函数在非正交基函数 $\\{ \\chi_{\\mu} \\}$ 中的系数向量。矩阵 $\\mathbf{S}$ 是重叠矩阵，它是对称半正定的。其元素为 $S_{\\mu \\nu} = \\langle \\chi_{\\mu} | \\chi_{\\nu} \\rangle$。分母 $\\mathbf{c}^{\\mathsf{T}} \\mathbf{S} \\mathbf{c}$ 代表试探波函数模长的平方，即 $\\langle \\Psi | \\Psi \\rangle$，对于任何有物理意义的态都必须为正。值为零对应于零函数，是平凡解。\n\n由于 $\\mathbf{S}$ 是一个实对称矩阵，它可以进行谱分解 $\\mathbf{S} = \\mathbf{U} \\mathbf{s} \\mathbf{U}^{\\mathsf{T}}$，其中 $\\mathbf{U}$ 是一个正交矩阵，其列向量 $\\mathbf{u}_k$ 是 $\\mathbf{S}$ 的本征向量，而 $\\mathbf{s} = \\mathrm{diag}(s_1, s_2, \\dots, s_M)$ 是相应非负本征值的对角矩阵。\n\n考虑一个与 $\\mathbf{S}$ 的某个对应于极小本征值 $s_k \\approx 0$ 的本征向量 $\\mathbf{u}_k$对齐的试探向量 $\\mathbf{c}$。令 $\\mathbf{c} = \\mathbf{u}_k$。将其代入瑞利商：\n分母变为：\n$$\n\\mathbf{c}^{\\mathsf{T}} \\mathbf{S} \\mathbf{c} \\;=\\; \\mathbf{u}_k^{\\mathsf{T}} \\mathbf{S} \\mathbf{u}_k \\;=\\; \\mathbf{u}_k^{\\mathsf{T}} (s_k \\mathbf{u}_k) \\;=\\; s_k (\\mathbf{u}_k^{\\mathsf{T}} \\mathbf{u}_k) \\;=\\; s_k\n$$\n分子变为：\n$$\n\\mathbf{c}^{\\mathsf{T}} \\mathbf{H} \\mathbf{c} \\;=\\; \\mathbf{u}_k^{\\mathsf{T}} \\mathbf{H} \\mathbf{u}_k\n$$\n此项是由 $\\mathbf{u}_k$ 所代表的基函数组合的哈密顿量期望值。这是一个有限值，我们可将其记为 $\\tilde{H}_{kk} = \\mathbf{u}_k^{\\mathsf{T}} \\mathbf{H} \\mathbf{u}_k$。对于这个特定的试探向量，其能量为：\n$$\nE[\\mathbf{u}_k] \\;=\\; \\frac{\\tilde{H}_{kk}}{s_k}\n$$\n如果 $s_k$ 是一个非常小的正数（趋近于零），能量表达式的分母将变得极小以至趋于零。除非分子 $\\tilde{H}_{kk}$ 也恰好为零（特殊情况），否则能量 $E[\\mathbf{u}_k]$ 的绝对值将非常大。如果 $\\tilde{H}_{kk}$ 为负，能量将是一个很大的负数。如果 $\\tilde{H}_{kk}$ 为正，能量将是一个很大的正数。\n\n这种现象是数值不稳定性的根源。在浮点运算中，用一个接近机器精度的数去除一个有限数，会得到一个非常大的数。从物理角度看，一个小的本征值 $s_k$ 表明基函数在 $\\mathbf{u}_k$ 方向上几乎是线性相关的。这意味着一个非零的基函数组合产生了一个模长几乎为零的态。变分原理保证了计算出的能量 $E[\\mathbf{c}]$ 必须大于或等于真实的基态能量 $E_0$。然而，由于数值伪影，出现伪性极低的能量（例如，大的负值）虽然没有在字面上，但在精神上违反了这一原理。能量最小化过程可能会错误地将这样一个态识别为基态的近似，从而导致计算的灾难性失败。\n\n第2部分：典范正交归一化变换的推导\n\n目标是找到一个变换 $\\mathbf{c} = \\mathbf{X}\\mathbf{d}$，将广义本征值问题 $\\mathbf{H}\\mathbf{c} = E\\mathbf{S}\\mathbf{c}$ 转换为一个在基是数值稳定的子空间中的标准本征值问题。\n\n我们从重叠矩阵的谱分解 $\\mathbf{S} = \\mathbf{U}\\mathbf{s}\\mathbf{U}^{\\mathsf{T}}$ 开始。我们将本征值 $s_i$ 排序，并根据一个阈值 $\\tau > 0$ 进行划分。设索引集 $I_{good} = \\{ i \\mid s_i \\ge \\tau \\}$ 的大小为 $k$，索引集 $I_{bad} = \\{ i \\mid s_i < \\tau \\}$ 的大小为 $M-k$。我们用 $\\mathbf{U}$ 中对应于 $I_{good}$ 中本征值的 $k$ 个列向量构建矩阵 $\\mathbf{U}_{good}$，并用这些本征值构建对角矩阵 $\\mathbf{s}_{good}$。\n原始试探向量空间由 $\\mathbf{U}$ 的列向量张成。我们舍弃由具有小本征值的本征向量张成的子空间，从而有效地将我们的问题投影到由 $\\mathbf{U}_{good}$ 的列向量张成的“良态”子空间上。在这个保留子空间中的试探向量 $\\mathbf{c}$ 可以写成：\n$$\n\\mathbf{c} \\;=\\; \\mathbf{U}_{good} \\mathbf{c}'_{good}\n$$\n其中 $\\mathbf{c}'_{good}$ 是一个 $k \\times 1$ 的系数向量，其基为本征向量集 $\\{\\mathbf{u}_i\\}_{i \\in I_{good}}$。在此基中，重叠矩阵为 $\\mathbf{U}_{good}^{\\mathsf{T}} \\mathbf{S} \\mathbf{U}_{good} = \\mathbf{s}_{good}$。\n\n我们寻求一组新的系数 $\\mathbf{d}$，对应一个正交归一化的新基。这个变换是从 $\\mathbf{d}$（正交归一化基中的系数）到 $\\mathbf{c}$（原始基中的系数）。该变换由 $\\mathbf{c} = \\mathbf{X}\\mathbf{d}$ 给出。新基是正交归一化的要求转化为对重叠矩阵的条件：\n$$\n\\mathbf{I}_k \\;=\\; \\mathbf{X}^{\\mathsf{T}} \\mathbf{S} \\mathbf{X}\n$$\n其中 $\\mathbf{I}_k$ 是 $k \\times k$ 的单位矩阵。让我们为 $\\mathbf{X}$ 提出一种形式，使其能从新的 $k$ 维正交归一化空间映射到 $M$ 维原始空间，同时保持在良态子空间内。一个合乎逻辑的选择是使用良态本征向量 $\\mathbf{U}_{good}$ 并对其进行适当缩放。我们尝试：\n$$\n\\mathbf{X} \\;=\\; \\mathbf{U}_{good} \\mathbf{s}_{good}^{-1/2}\n$$\n其中 $\\mathbf{s}_{good}^{-1/2} = \\mathrm{diag}(1/\\sqrt{s_i})_{i \\in I_{good}}$。由于所有的 $s_i \\ge \\tau > 0$，该矩阵是良定义的。\n我们来验证正交归一化条件：\n$$\n\\mathbf{X}^{\\mathsf{T}} \\mathbf{S} \\mathbf{X} \\;=\\; (\\mathbf{U}_{good} \\mathbf{s}_{good}^{-1/2})^{\\mathsf{T}} \\mathbf{S} (\\mathbf{U}_{good} \\mathbf{s}_{good}^{-1/2}) \\;=\\; \\mathbf{s}_{good}^{-1/2} \\mathbf{U}_{good}^{\\mathsf{T}} \\mathbf{S} \\mathbf{U}_{good} \\mathbf{s}_{good}^{-1/2}\n$$\n中间项是 $\\mathbf{U}_{good}^{\\mathsf{T}} \\mathbf{S} \\mathbf{U}_{good}$。由于 $\\mathbf{S}\\mathbf{U}_{good} = \\mathbf{U}_{good}\\mathbf{s}_{good}$，该项可简化为 $\\mathbf{U}_{good}^{\\mathsf{T}} \\mathbf{U}_{good} \\mathbf{s}_{good} = \\mathbf{I}_k \\mathbf{s}_{good} = \\mathbf{s}_{good}$。将其代回：\n$$\n\\mathbf{X}^{\\mathsf{T}} \\mathbf{S} \\mathbf{X} \\;=\\; \\mathbf{s}_{good}^{-1/2} \\mathbf{s}_{good} \\mathbf{s}_{good}^{-1/2} \\;=\\; \\mathbf{I}_k\n$$\n条件得到满足。因此，推导出的变换为 $\\mathbf{X} = \\mathbf{U}_{good} \\mathbf{s}_{good}^{-1/2}$。这个过程被称为典范正交化。\n\n在新表示中，瑞利商变为：\n$$\nE[\\mathbf{d}] \\;=\\; \\frac{(\\mathbf{X}\\mathbf{d})^{\\mathsf{T}} \\mathbf{H} (\\mathbf{X}\\mathbf{d})}{(\\mathbf{X}\\mathbf{d})^{\\mathsf{T}} \\mathbf{S} (\\mathbf{X}\\mathbf{d})} \\;=\\; \\frac{\\mathbf{d}^{\\mathsf{T}} (\\mathbf{X}^{\\mathsf{T}} \\mathbf{H} \\mathbf{X}) \\mathbf{d}}{\\mathbf{d}^{\\mathsf{T}} \\mathbf{I}_k \\mathbf{d}} \\;=\\; \\frac{\\mathbf{d}^{\\mathsf{T}} \\mathbf{H}_{ortho} \\mathbf{d}}{\\mathbf{d}^{\\mathsf{T}} \\mathbf{d}}\n$$\n其中 $\\mathbf{H}_{ortho} = \\mathbf{X}^{\\mathsf{T}} \\mathbf{H} \\mathbf{X}$。问题现在变成了求解 $k \\times k$ 矩阵 $\\mathbf{H}_{ortho}$ 的标准本征值问题。$\\mathbf{H}_{ortho}$ 的本征值就是保留子空间中的变分能。\n\n这个过程是“典则的”，因为它是基于 $\\mathbf{S}$ 的谱分解。$\\mathbf{S}$ 的本征向量构成了一个唯一的基（在简并情况下除外），它将向量空间分解为具有不同线性相关程度的方向。通过舍弃具有小本征值的本征向量，我们以一种清晰且系统的方式移除了近线性相关的方向。保留的空间是由原始基函数的最“线性无关”的组合所张成的空间。乘以 $\\mathbf{s}_{good}^{-1/2}$ 的缩放是在该子空间内产生正交归一化基的唯一变换。在移除所有本征值低于 $\\tau$ 的本征向量这一硬性约束下，此过程最小化了变分灵活性的损失，从而在数值上审慎地保留了尽可能多的原始变分空间。\n\n第3部分：应用与计算\n\n给定一个3函数基（$M=3$），重叠本征值为 $s_{1} = \\frac{19}{10} = 1.9$，$s_{2} = 1$ 和 $s_{3} = 10^{-4}$。阈值为 $\\tau = 10^{-3} = 0.001$。\n我们确定要保留的本征值：\n- $s_{1} = 1.9 \\ge 10^{-3}$ (保留)\n- $s_{2} = 1 \\ge 10^{-3}$ (保留)\n- $s_{3} = 10^{-4} < 10^{-3}$ (舍弃)\n保留子空间是 $k=2$ 维的，由本征向量 $\\mathbf{u}_1$ 和 $\\mathbf{u}_2$ 张成。矩阵 $\\mathbf{U}_{good}$ 为 $[\\mathbf{u}_1, \\mathbf{u}_2]$，保留的本征值矩阵为 $\\mathbf{s}_{good} = \\mathrm{diag}(s_1, s_2) = \\mathrm{diag}(1.9, 1)$。\n\n在正交归一化基中的变换后的哈密顿矩阵为 $\\mathbf{H}_{ortho} = \\mathbf{X}^{\\mathsf{T}} \\mathbf{H} \\mathbf{X}$，其中 $\\mathbf{X} = \\mathbf{U}_{good} \\mathbf{s}_{good}^{-1/2}$。\n$$\n\\mathbf{H}_{ortho} \\;=\\; \\mathbf{s}_{good}^{-1/2} \\mathbf{U}_{good}^{\\mathsf{T}} \\mathbf{H} \\mathbf{U}_{good} \\mathbf{s}_{good}^{-1/2}\n$$\n问题说明 $\\mathbf{H}$ 与 $\\mathbf{S}$ 谱对齐，这意味着 $\\mathbf{H}$ 和 $\\mathbf{S}$ 可被同一个正交矩阵 $\\mathbf{U}$ 对角化。因此，$\\mathbf{U}^{\\mathsf{T}}\\mathbf{H}\\mathbf{U} = \\mathrm{diag}(h_1, h_2, h_3)$。矩阵 $\\mathbf{U}_{good}^{\\mathsf{T}} \\mathbf{H} \\mathbf{U}_{good}$ 是这个对角矩阵的左上角 $2 \\times 2$ 分块。\n$$\n\\mathbf{U}_{good}^{\\mathsf{T}} \\mathbf{H} \\mathbf{U}_{good} \\;=\\; \\mathrm{diag}(h_1, h_2) \\;=\\; \\mathrm{diag}(-1, -1/2)\n$$\n现在我们组装 $\\mathbf{H}_{ortho}$：\n$$\n\\mathbf{H}_{ortho} \\;=\\; \\mathrm{diag}(s_1^{-1/2}, s_2^{-1/2}) \\cdot \\mathrm{diag}(h_1, h_2) \\cdot \\mathrm{diag}(s_1^{-1/2}, s_2^{-1/2})\n$$\n由于所有矩阵都是对角矩阵，其乘积也是一个对角矩阵：\n$$\n\\mathbf{H}_{ortho} \\;=\\; \\mathrm{diag}\\left(\\frac{h_1}{s_1}, \\frac{h_2}{s_2}\\right)\n$$\n保留子空间中的变分能是 $\\mathbf{H}_{ortho}$ 的本征值，即其对角线元素：\n$E'_1 = \\frac{h_1}{s_1}$ 和 $E'_2 = \\frac{h_2}{s_2}$。\n代入给定值：\n$$\nE'_1 \\;=\\; \\frac{-1}{19/10} \\;=\\; -\\frac{10}{19}\n$$\n$$\nE'_2 \\;=\\; \\frac{-1/2}{1} \\;=\\; -\\frac{1}{2}\n$$\n保留子空间中的变分基态能是这些能量中的最小值：\n$$\nE_{ground} \\;=\\; \\min(E'_1, E'_2) \\;=\\; \\min\\left(-\\frac{10}{19}, -\\frac{1}{2}\\right)\n$$\n为了比较这两个值，我们找到一个公分母：$-\\frac{10}{19} = -\\frac{20}{38}$ 且 $-\\frac{1}{2} = -\\frac{19}{38}$。因为 $-20 < -19$，所以 $-\\frac{20}{38} < -\\frac{19}{38}$。\n因此，基态能为 $-\\frac{10}{19}$。问题是在原子单位下表述的，所以能量单位是哈特里。", "answer": "$$\n\\boxed{-\\frac{10}{19}}\n$$", "id": "2823522"}]}