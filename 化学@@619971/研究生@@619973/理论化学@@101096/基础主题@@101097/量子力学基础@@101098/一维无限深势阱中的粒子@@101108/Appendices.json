{"hands_on_practices": [{"introduction": "微扰理论是量子力学中处理无法精确求解但与可解问题相近的系统的核心工具。本练习旨在通过在一维无限深势阱中引入一个点状杂质，来实践非简并微扰理论的应用。通过这项练习，你将计算能量的一阶修正，并推导波函数导数在杂质点的不连续性条件，从而加深对微扰影响和波函数行为的理解。", "problem": "考虑一个质量为 $m$ 的非相对论性单粒子，被限制在宽度为 $L$ 的一维无限深势阱中，势阱在 $x=0$ 和 $x=L$ 处有无限高的势壁，因此物理波函数满足 $\\psi(0)=\\psi(L)=0$。未受扰哈密顿量在定义域 $x\\in(0,L)$ 上为 $\\hat{H}_{0}=-\\frac{\\hbar^{2}}{2m}\\frac{d^{2}}{dx^{2}}$。在势阱内部，引入一个由 Dirac delta 势 $V_{1}(x)=\\lambda\\,\\delta(x-a)$ 建模的局域点状杂质，其中 $0<a<L$ 且耦合常数 $\\lambda$ 为实数。针对与 $\\hat{H}_{0}$ 的未受扰定态相关的固定量子数 $n\\in\\mathbb{N}$ 进行研究。从不含时 Schrödinger 方程和边界条件出发，完成以下任务：\n\n1) 使用一阶、不含时、非简并微扰理论和一个妥善归一化的未受扰基，推导由 $V_{1}(x)$ 引起的第 $n$ 能级能量的一阶修正 $\\Delta E_{n}^{(1)}$ 的解析表达式，该表达式用 $n$、$L$、$a$ 和 $\\lambda$ 表示。\n\n2) 对于包含全哈密顿量 $\\hat{H}=\\hat{H}_{0}+V_{1}$ 的精确、非微扰的定态问题，通过对 Schrödinger 方程在一个无穷小区间 $[a-\\varepsilon,a+\\varepsilon]$ 上积分并取极限 $\\varepsilon\\to 0^{+}$，推导任意本征函数在跨越杂质时空间导数的跳变条件。定义导数不连续性为 $J\\equiv\\psi'(a^{+})-\\psi'(a^{-})$。将 $J$ 仅用 $m$、$\\hbar$、$\\lambda$ 和 $\\psi(a)$ 的值表示。\n\n将您的最终结果表示为闭合形式的解析表达式。无需四舍五入。将您的最终答案报告为一个包含两个条目的单行矩阵，顺序为 $\\big(\\Delta E_{n}^{(1)},\\,J\\big)$。最终答案中不应包含单位。所有符号必须在您的推导中明确定义。", "solution": "所给出的问题是初等量子力学中的一个标准练习，它在科学上是适定的、自洽的，且没有歧义。我们将着手进行其形式解。\n\n该系统是一个质量为 $m$ 的粒子，处于宽度为 $L$ 的一维无限深势阱中。当 $x \\in (0, L)$ 时，势 $V(x) = 0$；当 $x \\leq 0$ 和 $x \\geq L$ 时，势 $V(x) = \\infty$。未受扰的不含时 Schrödinger 方程由 $\\hat{H}_{0}\\psi(x) = E\\psi(x)$ 给出，其中未受扰哈密顿量为 $\\hat{H}_{0} = -\\frac{\\hbar^{2}}{2m}\\frac{d^{2}}{dx^{2}}$。边界条件为 $\\psi(0) = 0$ 和 $\\psi(L) = 0$。\n\n该未受扰系统的归一化定态波函数（本征函数）由下式给出：\n$$\n\\psi_{n}^{(0)}(x) = \\sqrt{\\frac{2}{L}}\\sin\\left(\\frac{n\\pi x}{L}\\right)\n$$\n其中量子数 $n \\in \\{1, 2, 3, \\dots\\}$。对应的能量本征值为：\n$$\nE_{n}^{(0)} = \\frac{n^{2}\\pi^{2}\\hbar^{2}}{2mL^{2}}\n$$\n由于每个 $n$ 值对应一个唯一的能级，因此能谱是非简并的。\n\n**第一部分：一阶能量修正**\n\n题目引入了一个微扰势 $V_{1}(x) = \\lambda\\,\\delta(x-a)$，其中 $\\lambda$ 是一个实常数且 $0 < a < L$。我们被要求使用不含时、非简并微扰理论来计算能级的一阶修正 $\\Delta E_{n}^{(1)}$。\n\n一阶能量修正的公式由微扰势在未受扰态 $|\\psi_{n}^{(0)}\\rangle$ 中的期望值给出：\n$$\n\\Delta E_{n}^{(1)} = \\langle \\psi_{n}^{(0)} | V_{1} | \\psi_{n}^{(0)} \\rangle = \\int_{-\\infty}^{\\infty} (\\psi_{n}^{(0)}(x))^{*} V_{1}(x) \\psi_{n}^{(0)}(x) \\, dx\n$$\n由于波函数仅在 $x \\in (0, L)$ 上非零，积分限变为 $0$ 和 $L$。未受扰波函数是实函数，所以 $(\\psi_{n}^{(0)}(x))^{*} = \\psi_{n}^{(0)}(x)$。代入 $\\psi_{n}^{(0)}(x)$ 和 $V_{1}(x)$ 的表达式：\n$$\n\\Delta E_{n}^{(1)} = \\int_{0}^{L} \\left(\\sqrt{\\frac{2}{L}}\\sin\\left(\\frac{n\\pi x}{L}\\right)\\right) \\left(\\lambda\\,\\delta(x-a)\\right) \\left(\\sqrt{\\frac{2}{L}}\\sin\\left(\\frac{n\\pi x}{L}\\right)\\right) \\, dx\n$$\n合并各项，我们得到：\n$$\n\\Delta E_{n}^{(1)} = \\frac{2\\lambda}{L} \\int_{0}^{L} \\sin^{2}\\left(\\frac{n\\pi x}{L}\\right) \\delta(x-a) \\, dx\n$$\n我们使用 Dirac delta 函数的筛选性质，该性质表明，对于一个在 $x=a$ 处连续的函数 $f(x)$，有 $\\int f(x)\\delta(x-a)dx = f(a)$。由于被积函数 $\\sin^{2}\\left(\\frac{n\\pi x}{L}\\right)$ 处处连续，该积分的计算结果为函数在 $x=a$ 处的值：\n$$\n\\Delta E_{n}^{(1)} = \\frac{2\\lambda}{L} \\sin^{2}\\left(\\frac{n\\pi a}{L}\\right)\n$$\n这是第 $n$ 能级能量的一阶修正。\n\n**第二部分：导数跳变条件**\n\n对于第二部分，我们考虑包含全哈密顿量 $\\hat{H} = \\hat{H}_{0} + V_{1}(x)$ 的精确、非微扰的不含时 Schrödinger 方程：\n$$\n-\\frac{\\hbar^{2}}{2m}\\frac{d^{2}\\psi(x)}{dx^{2}} + \\lambda\\,\\delta(x-a)\\psi(x) = E\\psi(x)\n$$\n其中 $\\psi(x)$ 是具有精确能量 $E$ 的精确本征函数。我们的任务是推导波函数一阶导数 $\\psi'(x) = \\frac{d\\psi}{dx}$ 在杂质位置 $x=a$ 处的不连续性。\n\n首先，我们重新整理 Schrödinger 方程以分离出二阶导数：\n$$\n\\frac{d^{2}\\psi(x)}{dx^{2}} = \\frac{2m}{\\hbar^{2}}\\left[\\lambda\\,\\delta(x-a) - E\\right]\\psi(x)\n$$\n接下来，我们对该方程在一个无穷小区间 $[a-\\varepsilon, a+\\varepsilon]$ 上对 $x$ 进行积分，其中 $\\varepsilon$ 是一个小的正数：\n$$\n\\int_{a-\\varepsilon}^{a+\\varepsilon} \\frac{d^{2}\\psi(x)}{dx^{2}} \\, dx = \\int_{a-\\varepsilon}^{a+\\varepsilon} \\frac{2m}{\\hbar^{2}}\\left[\\lambda\\,\\delta(x-a) - E\\right]\\psi(x) \\, dx\n$$\n根据微积分基本定理，左侧为：\n$$\n\\int_{a-\\varepsilon}^{a+\\varepsilon} \\frac{d}{dx}\\left(\\frac{d\\psi}{dx}\\right) \\, dx = \\left[\\frac{d\\psi}{dx}\\right]_{a-\\varepsilon}^{a+\\varepsilon} = \\psi'(a+\\varepsilon) - \\psi'(a-\\varepsilon)\n$$\n右侧被分为两个积分：\n$$\n\\frac{2m\\lambda}{\\hbar^{2}} \\int_{a-\\varepsilon}^{a+\\varepsilon} \\delta(x-a)\\psi(x) \\, dx - \\frac{2mE}{\\hbar^{2}} \\int_{a-\\varepsilon}^{a+\\varepsilon} \\psi(x) \\, dx\n$$\n现在，我们取极限 $\\varepsilon \\to 0^{+}$。\n对于右侧的第一个积分，我们使用 delta 函数的筛选性质。由于一个物理上可接受的波函数 $\\psi(x)$ 必须是连续的，该积分变为 $\\lambda\\psi(a)$。\n对于第二个积分 $\\int_{a-\\varepsilon}^{a+\\varepsilon} \\psi(x) \\, dx$，我们有一个连续函数 $\\psi(x)$ 在一个长度趋于零的区间上积分。该积分的值约为 $2\\varepsilon \\cdot \\psi(a)$，当 $\\varepsilon \\to 0$ 时趋于 $0$。\n\n对整个方程取极限：\n$$\n\\lim_{\\varepsilon \\to 0^{+}} \\left[ \\psi'(a+\\varepsilon) - \\psi'(a-\\varepsilon) \\right] = \\frac{2m\\lambda}{\\hbar^{2}}\\psi(a) - \\frac{2mE}{\\hbar^{2}} \\cdot 0\n$$\n根据定义，左侧是导数的跳变，即 $J \\equiv \\psi'(a^{+}) - \\psi'(a^{-})$。因此，我们得到了跳变条件：\n$$\nJ = \\frac{2m\\lambda}{\\hbar^{2}}\\psi(a)\n$$\n该表达式给出了任意精确本征函数的一阶导数在 delta 势杂质位置处的不连续性。", "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{2\\lambda}{L} \\sin^{2}\\left(\\frac{n\\pi a}{L}\\right) & \\frac{2m\\lambda}{\\hbar^{2}}\\psi(a) \\end{pmatrix}}\n$$", "id": "2792818"}, {"introduction": "变分原理为估算量子体系的基态能量提供了一种强大且严格的方法，其核心在于任何试探波函数的能量期望值都是基态能量的上限。本练习要求你使用一个包含可调参数的特定试探波函数，运用变分原理来寻找一维箱中粒子基态能量的最佳上限。这个过程将训练你构建变分能量泛函、通过对称性分析和参数优化来确定最佳解的能力。", "problem": "一个质量为 $m$ 的单粒子被限制在区间 $x \\in [0,L]$ 上的一维无限深势阱（箱中粒子）中，其势能为 $V(x)=0$（对于 $0<x<L$）否则 $V(x)=+\\infty$。阱内对应的哈密顿量为 $H=-\\frac{\\hbar^{2}}{2m}\\frac{d^{2}}{dx^{2}}$，并且允许的波函数必须满足狄利克雷边界条件 $\\psi(0)=\\psi(L)=0$。\n\n使用 Rayleigh–Ritz 变分原理，考虑单参数试探函数族\n$$\n\\psi_{\\beta}(x)=x\\,(L-x)\\,\\exp(-\\beta x),\n$$\n其中 $\\beta$ 为实参数，且 $0 \\le x \\le L$。仅从定态薛定谔方程和变分原理出发（不得假定任何其他公式），执行以下操作：\n\n- 推导出变分能量泛函 $E(\\beta)=\\dfrac{\\langle \\psi_{\\beta}|H|\\psi_{\\beta}\\rangle}{\\langle \\psi_{\\beta}|\\psi_{\\beta}\\rangle}$，使其形式仅依赖于在 $[0,L]$ 上的初等函数的积分，并从第一性原理证明所有步骤。\n- 引入无量纲变量，将对 $L$ 和 $\\beta$ 的依赖关系分离到一个单一的无量纲参数中。利用这一点论证哪个 $\\beta$ 值使 $E(\\beta)$ 取极值。\n- 通过从第一性原理分析该点附近 $E(\\beta)$ 的行为（例如，通过对称性论证辅以对相关积分进行到 $t^{2}$ 阶的系统性小参数展开，其中 $t$ 是 $\\beta$ 的一个适当的无量纲形式），确定此极值是否为最小值。\n- 以闭合形式计算相应的优化后的基态能量变分上界。\n\n以 $\\hbar$、$m$ 和 $L$ 的精确解析表达式给出你的最终答案。无需进行数值代入。如果需要进行数值计算，能量应以焦耳为单位表示。不要提供任何中间结果；仅报告优化后的基态能量变分上界作为最终答案。无需四舍五入。", "solution": "该系统是一个在 $x \\in [0,L]$ 上的一维无限深势阱中的粒子，区间内 $V(x)=0$，区间外 $V(x)=+\\infty$，因此允许的波函数必须满足 $\\psi(0)=\\psi(L)=0$。阱内的哈密顿量为 $H=-\\frac{\\hbar^{2}}{2m}\\frac{d^{2}}{dx^{2}}$。Rayleigh–Ritz 变分原理指出，对于任何归一化的允许波函数 $\\psi$，其期望值 $E[\\psi]=\\dfrac{\\langle \\psi|H|\\psi\\rangle}{\\langle \\psi|\\psi\\rangle}$ 满足 $E[\\psi]\\ge E_{0}$，其中 $E_{0}$ 是精确的基态能量。\n\n对于实试探函数 $\\psi_{\\beta}(x)=x(L-x)\\exp(-\\beta x)$，能量泛函为\n$$\nE(\\beta)=\\frac{\\displaystyle \\int_{0}^{L}\\psi_{\\beta}(x)\\left(-\\frac{\\hbar^{2}}{2m}\\frac{d^{2}}{dx^{2}}\\right)\\psi_{\\beta}(x)\\,dx}{\\displaystyle \\int_{0}^{L} \\psi_{\\beta}(x)^{2}\\,dx}.\n$$\n利用 $\\psi_{\\beta}(0)=\\psi_{\\beta}(L)=0$ 进行分部积分可得\n$$\n\\int_{0}^{L}\\psi_{\\beta}(x)\\left(-\\frac{d^{2}}{dx^{2}}\\psi_{\\beta}(x)\\right)\\,dx=\\int_{0}^{L}\\left(\\frac{d\\psi_{\\beta}}{dx}\\right)^{2}\\,dx,\n$$\n因为边界项 $-\\psi_{\\beta}\\,\\psi_{\\beta}'\\big|_{0}^{L}$ 为零。因此，\n$$\nE(\\beta)=\\frac{\\hbar^{2}}{2m}\\,\\frac{\\displaystyle \\int_{0}^{L}\\left(\\frac{d\\psi_{\\beta}}{dx}\\right)^{2} dx}{\\displaystyle \\int_{0}^{L}\\psi_{\\beta}(x)^{2}\\,dx}.\n$$\n这将问题简化为计算初等函数的积分。\n\n为了揭示标度关系并减少参数，定义无量纲坐标 $y=x/L$（因此 $y\\in[0,1]$）和无量纲参数 $t=\\beta L$，并写出 $x=L y$。那么\n$$\n\\psi_{\\beta}(x)=L^{2}\\,y(1-y)\\,\\exp(-t y),\n$$\n并且\n$$\n\\frac{d\\psi_{\\beta}}{dx}=\\frac{1}{L}\\frac{d}{dy}\\left(L^{2}y(1-y)\\exp(-t y)\\right)=L\\,\\frac{d}{dy}\\left(y(1-y)\\exp(-t y)\\right).\n$$\n因此，\n$$\n\\int_{0}^{L}\\psi_{\\beta}(x)^{2}\\,dx=L^{5}\\int_{0}^{1} y^{2}(1-y)^{2}\\,\\exp(-2 t y)\\,dy\\equiv L^{5}\\,I_{0}(t),\n$$\n并且\n$$\n\\int_{0}^{L}\\left(\\frac{d\\psi_{\\beta}}{dx}\\right)^{2}\\,dx=L^{3}\\int_{0}^{1}\\left[\\frac{d}{dy}\\left(y(1-y)\\exp(-t y)\\right)\\right]^{2}dy\\equiv L^{3}\\,I_{1}(t).\n$$\n所以变分能量可以写成\n$$\nE(\\beta)=\\frac{\\hbar^{2}}{2m}\\,\\frac{L^{3} I_{1}(t)}{L^{5} I_{0}(t)}=\\frac{\\hbar^{2}}{2m L^{2}}\\;\\frac{I_{1}(t)}{I_{0}(t)}\\equiv \\frac{\\hbar^{2}}{2m L^{2}}\\,F(t),\n$$\n其中\n$$\nI_{0}(t)=\\int_{0}^{1} y^{2}(1-y)^{2}\\,\\exp(-2 t y)\\,dy,\\qquad I_{1}(t)=\\int_{0}^{1}\\left[\\frac{d}{dy}\\left(y(1-y)\\exp(-t y)\\right)\\right]^{2}dy.\n$$\n$I_{1}(t)$ 内部的导数是\n$$\n\\frac{d}{dy}\\left(y(1-y)\\exp(-t y)\\right)=\\exp(-t y)\\left[(1-2y)-t\\,y(1-y)\\right],\n$$\n所以\n$$\nI_{1}(t)=\\int_{0}^{1}\\exp(-2 t y)\\left[(1-2y)-t\\,y(1-y)\\right]^{2}dy.\n$$\n\n接下来，我们分析关于 $t$（等效地，关于 $\\beta$）的优化问题。考虑反射变换 $y\\mapsto 1-y$（等效地，$x\\mapsto L-x$）。在此映射下，\n$$\n\\psi_{\\beta}(L-x)=(L-x)\\,x\\,\\exp\\!\\left(-\\beta(L-x)\\right)=\\exp(-\\beta L)\\,x(L-x)\\,\\exp(+\\beta x)\\propto \\psi_{-\\beta}(x).\n$$\n因为能量泛函对试探函数的依赖仅通过归一化比率 $\\langle \\psi|H|\\psi\\rangle/\\langle\\psi|\\psi\\rangle$ 体现，所以任何总的常数因子在分子和分母之间都会消去。由于哈密顿量和定义域在 $x\\mapsto L-x$ 变换下是不变的，能量必须满足\n$$\nE(\\beta)=E(-\\beta),\n$$\n即 $F(t)$ 是 $t$ 的偶函数。因此 $t=0$ 是一个驻点。\n\n为证明 $t=0$ 是一个最小值，我们将 $F(t)$ 展开到 $t^{2}$ 阶，并证明二次项系数为正。记\n$$\nA(y)=1-2y,\\qquad B(y)=y(1-y).\n$$\n那么\n$$\nI_{0}(t)=\\int_{0}^{1} B(y)^{2}\\,\\exp(-2 t y)\\,dy,\\qquad I_{1}(t)=\\int_{0}^{1}\\left[A(y)-t B(y)\\right]^{2}\\exp(-2 t y)\\,dy.\n$$\n将 $\\exp(-2 t y)=1-2 t y+2 t^{2} y^{2}+\\mathcal{O}(t^{3})$ 展开并保留到 $t^{2}$ 阶的项，得到\n$$\nI_{0}(t)=\\int_{0}^{1}\\left[B^{2}-2 t\\,y B^{2}+2 t^{2} y^{2} B^{2}\\right]dy+\\mathcal{O}(t^{3}),\n$$\n$$\nI_{1}(t)=\\int_{0}^{1}\\left[A^{2}-2 t A B+t^{2} B^{2}\\right]\\left(1-2 t y+2 t^{2} y^{2}\\right)dy+\\mathcal{O}(t^{3}).\n$$\n使用在 $[0,1]$ 上的初等积分，\n$$\n\\int_{0}^{1}A^{2}dy=\\frac{1}{3},\\quad \\int_{0}^{1}y A^{2}dy=\\frac{1}{6},\\quad \\int_{0}^{1}y^{2}A^{2}dy=\\frac{2}{15},\n$$\n$$\n\\int_{0}^{1}B^{2}dy=\\frac{1}{30},\\quad \\int_{0}^{1}y B^{2}dy=\\frac{1}{60},\\quad \\int_{0}^{1}y^{2} B^{2}dy=\\frac{1}{105},\n$$\n以及 $\\int_{0}^{1}A B\\,dy=0$，$\\int_{0}^{1}y A B\\,dy=-\\frac{1}{60}$，我们得到\n$$\nI_{0}(t)=\\frac{1}{30}-\\frac{1}{30}t+\\frac{2}{105}t^{2}+\\mathcal{O}(t^{3}),\n$$\n$$\nI_{1}(t)=\\frac{1}{3}-\\frac{1}{3}t+\\frac{7}{30}t^{2}+\\mathcal{O}(t^{3}).\n$$\n构造比率，\n$$\nF(t)=\\frac{I_{1}(t)}{I_{0}(t)}=10\\left[1+\\left(\\frac{7}{10}-\\frac{4}{7}\\right)t^{2}+\\mathcal{O}(t^{3})\\right]=10\\left[1+\\frac{9}{70}t^{2}+\\mathcal{O}(t^{3})\\right].\n$$\n$t^{2}$ 的正系数表明 $t=0$ 是一个严格的局部最小值。根据偶函数性质和平滑性，$t=0$ 是这个单参数函数族内的全局最小值点。\n\n因此，最优参数是 $\\beta^{\\star}=0$，在 $t=0$ 时对应的积分为\n$$\nI_{0}(0)=\\int_{0}^{1}y^{2}(1-y)^{2}dy=\\frac{1}{30},\\qquad I_{1}(0)=\\int_{0}^{1}(1-2y)^{2}dy=\\frac{1}{3}.\n$$\n因此\n$$\nF(0)=\\frac{I_{1}(0)}{I_{0}(0)}=\\frac{1/3}{1/30}=10,\n$$\n优化后的基态能量变分上界为\n$$\nE_{\\mathrm{var,min}}=\\frac{\\hbar^{2}}{2m L^{2}}\\times 10=\\frac{5\\,\\hbar^{2}}{m\\,L^{2}}.\n$$\n这是对精确基态能量的一个严格上界。它比无限深势阱的精确值要大，这与变分原理一致，并且在此函数族内对 $\\beta$ 的优化选择了对称的成员 $\\beta=0$，正如从哈密顿量和定义域的反射对称性所预期的那样。", "answer": "$$\\boxed{\\frac{5\\,\\hbar^{2}}{m\\,L^{2}}}$$", "id": "2792826"}, {"introduction": "现实世界中大多数量子化学问题无法精确解析求解，因此数值方法是理论化学家不可或缺的工具。本练习将指导你使用有限差分法，将连续的薛定谔微分方程转化为一个离散的矩阵本征值问题。通过编写程序实现这一过程并与精确解进行比较，你将亲身体验从连续到离散的转化，并理解数值模拟中离散化误差这一基本概念。", "problem": "考虑一个质量为 $m$ 的非相对论性粒子，被限制在一维区间 $(0,L)$ 内，在 $x=0$ 和 $x=L$ 处存在无限深势垒。阱内定态所满足的不含时薛定谔方程是一个齐次二阶线性常微分方程：\n$$\n-\\frac{\\hbar^2}{2m}\\frac{d^2\\psi(x)}{dx^2}=E\\,\\psi(x),\\quad x\\in(0,L),\n$$\n服从狄利克雷边界条件 $\\psi(0)=0$ 和 $\\psi(L)=0$。仅从此微分方程和边界条件出发，在区间 $(0,L)$ 的内部均匀网格上，构建动能算符的二阶精度有限差分（FD）离散化，网格间距为 $h$。你的推导必须使用关于内部网格点的泰勒展开，并需证明局部截断误差的量级为 $\\mathcal{O}(h^2)$。\n\n根据你的离散化，构建一个近似于该连续问题的有限维对称矩阵特征值问题。然后，针对以下给出的每个测试用例，实现一个程序，该程序能够：\n- 在包含 $M$ 个点的内部网格上构建离散动能算符矩阵（$M$ 是内部点的数量；均匀间距为 $h=L/(M+1)$）。\n- 求解得到的对称矩阵特征值问题，并提取第 $n$ 个特征值 $E_{n,h}$（按升序排列）。\n- 根据一维箱中粒子问题的薛定谔方程解析解，为相同的 $n$、$L$ 和 $m$ 计算对应的精确连续谱能量 $E_n$。\n- 返回绝对离散化误差 $|E_{n,h}-E_n|$。\n\n使用的物理常数：\n- 约化普朗克常数 $\\hbar = 1.054571817\\times 10^{-34}\\,\\mathrm{J\\cdot s}$。\n- 基本电荷 $e = 1.602176634\\times 10^{-19}\\,\\mathrm{C}$（精确值），用于将焦耳转换为电子伏特，$1\\,\\mathrm{eV}=e\\,\\mathrm{J}$。\n- 电子质量 $m_{\\mathrm{e}}=9.1093837015\\times 10^{-31}\\,\\mathrm{kg}$。\n\n所有能量和能量误差必须以电子伏特（eV）表示。你的程序必须为每个测试用例计算绝对离散化误差 $|E_{n,h}-E_n|$（单位为 eV），并输出结果，四舍五入到小数点后 10 位。\n\n测试套件（每个用例是一个四元组 $(L\\,[\\mathrm{m}],\\,m\\,[\\mathrm{kg}],\\,n,\\,M)$）：\n1. $(1.0\\times 10^{-9},\\,9.1093837015\\times 10^{-31},\\,1,\\,10)$\n2. $(1.0\\times 10^{-9},\\,9.1093837015\\times 10^{-31},\\,1,\\,20)$\n3. $(1.0\\times 10^{-9},\\,9.1093837015\\times 10^{-31},\\,1,\\,40)$\n4. $(1.0\\times 10^{-9},\\,9.1093837015\\times 10^{-31},\\,3,\\,120)$\n5. $(1.0\\times 10^{-9},\\,9.1093837015\\times 10^{-31},\\,5,\\,200)$\n6. $(0.5\\times 10^{-9},\\,9.1093837015\\times 10^{-31},\\,1,\\,40)$\n7. $(1.0\\times 10^{-9},\\,9.1093837015\\times 10^{-31},\\,8,\\,10)$\n\n最终输出格式要求：\n- 你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，结果的顺序与上述测试用例相同。例如，输出必须如下所示：\n$$\n[\\text{result}_1,\\text{result}_2,\\ldots,\\text{result}_7],\n$$\n其中每个 $\\text{result}_k$ 是一个十进制数，代表以 eV 为单位的 $|E_{n,h}-E_n|$，并四舍五入到小数点后 10 位。", "solution": "问题陈述具有科学依据，提法恰当，客观，并包含推导唯一且有意义解所需的所有必要信息。这是一个计算量子化学中的标准练习，涉及对一个典型模型系统的不含时薛定谔方程进行数值求解。因此，该问题是有效的，我将着手解决它。\n\n该问题要求推导一种数值方法来求解一维箱中粒子的不含时薛定谔方程，并实现该方法以计算几个测试用例的离散化误差。\n\n首先，我们推导动能算符的有限差分近似。薛定谔方程由下式给出：\n$$\n-\\frac{\\hbar^2}{2m}\\frac{d^2\\psi(x)}{dx^2} = E\\psi(x) \\quad \\text{for } x \\in (0, L)\n$$\n其边界条件为 $\\psi(0)=0$ 和 $\\psi(L)=0$。\n\n我们将区间 $(0,L)$ 离散化为 $M+1$ 个等长的线段，长度为 $h = L/(M+1)$。这定义了一个包含 $M+2$ 个点的网格 $x_i = i \\cdot h$，其中 $i=0, 1, \\dots, M+1$。内部点为 $x_1, \\dots, x_M$。在这些网格点 $x_i$ 上的波函数记为 $\\psi_i \\equiv \\psi(x_i)$。边界条件意味着 $\\psi_0 = 0$ 和 $\\psi_{M+1} = 0$。\n\n为了在内部网格点 $x_i$ 近似二阶导数 $\\frac{d^2\\psi}{dx^2}$，我们使用 $\\psi(x)$ 在 $x_i$ 附近的泰勒级数展开：\n$$\n\\psi(x_i + h) = \\psi(x_i) + h \\psi'(x_i) + \\frac{h^2}{2!} \\psi''(x_i) + \\frac{h^3}{3!} \\psi'''(x_i) + \\frac{h^4}{4!} \\psi^{(4)}(x_i) + \\mathcal{O}(h^5)\n$$\n$$\n\\psi(x_i - h) = \\psi(x_i) - h \\psi'(x_i) + \\frac{h^2}{2!} \\psi''(x_i) - \\frac{h^3}{3!} \\psi'''(x_i) + \\frac{h^4}{4!} \\psi^{(4)}(x_i) - \\mathcal{O}(h^5)\n$$\n用网格点表示法，即为：\n$$\n\\psi_{i+1} = \\psi_i + h \\psi'(x_i) + \\frac{h^2}{2} \\psi''(x_i) + \\frac{h^3}{6} \\psi'''(x_i) + \\frac{h^4}{24} \\psi^{(4)}(x_i) + \\mathcal{O}(h^5)\n$$\n$$\n\\psi_{i-1} = \\psi_i - h \\psi'(x_i) + \\frac{h^2}{2} \\psi''(x_i) - \\frac{h^3}{6} \\psi'''(x_i) + \\frac{h^4}{24} \\psi^{(4)}(x_i) - \\mathcal{O}(h^5)\n$$\n将这两个方程相加，可以消去所有 $h$ 的奇次幂项：\n$$\n\\psi_{i+1} + \\psi_{i-1} = 2\\psi_i + h^2 \\psi''(x_i) + \\frac{h^4}{12} \\psi^{(4)}(x_i) + \\mathcal{O}(h^6)\n$$\n重新整理以求解二阶导数 $\\psi''(x_i)$：\n$$\n\\psi''(x_i) = \\frac{\\psi_{i+1} - 2\\psi_i + \\psi_{i-1}}{h^2} - \\frac{h^2}{12} \\psi^{(4)}(x_i) + \\mathcal{O}(h^4)\n$$\n因此，二阶导数的中心有限差分近似为：\n$$\n\\frac{d^2\\psi}{dx^2}\\bigg|_{x=x_i} \\approx \\frac{\\psi_{i+1} - 2\\psi_i + \\psi_{i-1}}{h^2}\n$$\n局部截断误差（LTE）是精确导数与其近似值之间的差：\n$$\n\\text{LTE} = \\psi''(x_i) - \\left( \\frac{\\psi_{i+1} - 2\\psi_i + \\psi_{i-1}}{h^2} \\right) = - \\frac{h^2}{12} \\psi^{(4)}(x_i) + \\mathcal{O}(h^4)\n$$\n首项误差项与 $h^2$ 成正比，因此这是一个二阶精度格式，符合要求。\n\n现在，我们将此近似代入每个内部网格点 $x_i$（$i = 1, \\dots, M$）的薛定谔方程中：\n$$\n-\\frac{\\hbar^2}{2m} \\left( \\frac{\\psi_{i+1} - 2\\psi_i + \\psi_{i-1}}{h^2} \\right) = E_h \\psi_i\n$$\n其中 $E_h$ 是能量特征值的数值近似。整理各项，我们得到：\n$$\n-\\frac{\\hbar^2}{2mh^2} \\psi_{i-1} + \\frac{2\\hbar^2}{2mh^2} \\psi_i - \\frac{\\hbar^2}{2mh^2} \\psi_{i+1} = E_h \\psi_i\n$$\n这代表了一个关于值 $\\psi_1, \\dots, \\psi_M$ 的 $M$ 个耦合线性方程组。\n对于 $i=1$：$-\\frac{\\hbar^2}{2mh^2}\\psi_0 + \\frac{\\hbar^2}{mh^2}\\psi_1 - \\frac{\\hbar^2}{2mh^2}\\psi_2 = E_h \\psi_1$。由于 $\\psi_0=0$，该式变为 $\\frac{\\hbar^2}{mh^2}\\psi_1 - \\frac{\\hbar^2}{2mh^2}\\psi_2 = E_h \\psi_1$。\n对于 $i=M$：$-\\frac{\\hbar^2}{2mh^2}\\psi_{M-1} + \\frac{\\hbar^2}{mh^2}\\psi_M - \\frac{\\hbar^2}{2mh^2}\\psi_{M+1} = E_h \\psi_M$。由于 $\\psi_{M+1}=0$，该式变为 $-\\frac{\\hbar^2}{2mh^2}\\psi_{M-1} + \\frac{\\hbar^2}{mh^2}\\psi_M = E_h \\psi_M$。\n\n该方程组可以写成矩阵特征值问题 $\\mathbf{H}\\vec{\\psi} = E_h \\vec{\\psi}$，其中 $\\vec{\\psi} = [\\psi_1, \\psi_2, \\dots, \\psi_M]^T$ 是内部网格点上波函数值的向量，$\\mathbf{H}$ 是 $M \\times M$ 的离散哈密顿矩阵。$\\mathbf{H}$ 的元素为：\n$$\nH_{ij} = \\begin{cases} \\frac{\\hbar^2}{mh^2} & \\text{if } i=j \\\\ -\\frac{\\hbar^2}{2mh^2} & \\text{if } |i-j|=1 \\\\ 0 & \\text{otherwise} \\end{cases}\n$$\n该矩阵可以表示为：\n$$\n\\mathbf{H} = \\frac{\\hbar^2}{2mh^2}\n\\begin{pmatrix}\n2 & -1 & 0 & \\cdots & 0 \\\\\n-1 & 2 & -1 & \\cdots & 0 \\\\\n0 & -1 & 2 & \\ddots & \\vdots \\\\\n\\vdots & \\vdots & \\ddots & \\ddots & -1 \\\\\n0 & 0 & \\cdots & -1 & 2\n\\end{pmatrix}\n$$\n这是一个实对称三对角矩阵。求解此特征值问题可得到 $M$ 个特征值 $E_{n,h}$ 和相应的特征向量 $\\vec{\\psi}_n$，其中 $n=1, \\dots, M$。这些是连续系统前 $M$ 个能级和波函数的数值近似。\n\n一维箱中粒子问题的连续能量特征值的解析解为：\n$$\nE_n = \\frac{n^2 \\pi^2 \\hbar^2}{2mL^2}, \\quad n=1, 2, 3, \\dots\n$$\n该程序将求解矩阵 $\\mathbf{H}$ 的特征值问题以找到数值特征值 $E_{n,h}$，计算相应的精确特征值 $E_n$，并计算绝对误差 $|E_{n,h} - E_n|$。所有能量都必须通过除以基本电荷 $e$ 从焦耳（Joule）转换为电子伏特（eV）。所需的物理常数为 $\\hbar = 1.054571817 \\times 10^{-34}\\,\\mathrm{J\\cdot s}$，$m_{\\mathrm{e}}=9.1093837015\\times 10^{-31}\\,\\mathrm{kg}$ 和 $e = 1.602176634\\times 10^{-19}\\,\\mathrm{C}$。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import eigh_tridiagonal\n\ndef solve():\n    \"\"\"\n    Solves the particle in a box problem using a finite difference method\n    and computes the absolute error against the exact analytical solution.\n    \"\"\"\n    # Define physical constants as specified.\n    HBAR = 1.054571817e-34  # J*s\n    E_CHARGE = 1.602176634e-19  # C (for J to eV conversion)\n    M_E = 9.1093837015e-31  # kg (electron mass)\n    J_PER_EV = E_CHARGE # Joules per electronvolt\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (L [m], m [kg], n, M)\n        (1.0e-9, M_E, 1, 10),\n        (1.0e-9, M_E, 1, 20),\n        (1.0e-9, M_E, 1, 40),\n        (1.0e-9, M_E, 3, 120),\n        (1.0e-9, M_E, 5, 200),\n        (0.5e-9, M_E, 1, 40),\n        (1.0e-9, M_E, 8, 10),\n    ]\n\n    results = []\n    for L, m, n, M in test_cases:\n        # Calculate the uniform grid spacing h.\n        h = L / (M + 1)\n        \n        # Construct the tridiagonal Hamiltonian matrix H.\n        # The matrix is H = (hbar^2 / (2*m*h^2)) * Tridiag(-1, 2, -1).\n        # We can implement this for eigh_tridiagonal by defining the main\n        # and off-diagonal vectors.\n        \n        # Main diagonal elements: hbar^2 / (m * h^2)\n        main_diag_val = HBAR**2 / (m * h**2)\n        main_diag = np.full(M, main_diag_val)\n        \n        # Off-diagonal elements: -hbar^2 / (2 * m * h^2)\n        off_diag_val = -HBAR**2 / (2 * m * h**2)\n        off_diag = np.full(M - 1, off_diag_val)\n        \n        # Solve the eigenvalue problem for the symmetric tridiagonal matrix.\n        # eigh_tridiagonal is highly efficient and returns eigenvalues sorted in\n        # ascending order. The energies are in Joules.\n        eigenvalues_J, _ = eigh_tridiagonal(main_diag, off_diag)\n        \n        # Select the n-th numerical eigenvalue (using 0-based indexing).\n        # The problem uses 1-based indexing for n (n-th eigenvalue).\n        E_nh_J = eigenvalues_J[n - 1]\n        \n        # Calculate the exact analytical energy for the n-th state.\n        E_n_J = (n**2 * np.pi**2 * HBAR**2) / (2 * m * L**2)\n        \n        # Convert energies from Joules to electronvolts (eV).\n        E_nh_eV = E_nh_J / J_PER_EV\n        E_n_eV = E_n_J / J_PER_EV\n        \n        # Compute the absolute discretization error in eV.\n        absolute_error_eV = abs(E_nh_eV - E_n_eV)\n        \n        # Append the rounded result to the list.\n        results.append(f\"{absolute_error_eV:.10f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "2913789"}]}