{"hands_on_practices": [{"introduction": "理论的基石是能够精确求解的模型。本练习 [@problem_id:2113735] 从量子力学最基本的原理出发，通过求解一个狄拉克 $\\delta$ 函数势垒的透射系数，为您奠定坚实的理论基础。尽管 $\\delta$ 势垒是一种理想化的假设，但解决这个问题的过程将强化您对薛定谔方程、边界连续性条件以及波函数散射特性等核心概念的理解，是掌握更复杂隧穿问题的关键第一步。", "problem": "考虑一个一维量子系统，其中一束非相对论性粒子，每个粒子质量为 $m$，具有确定的动能 $E > 0$，沿着x轴从负无穷向原点运动。在原点处，这些粒子遇到了一个无穷薄的排斥性势垒。该势垒由势能函数 $V(x) = \\alpha \\delta(x)$ 描述，其中 $\\alpha$ 是代表势垒强度的正常数，而 $\\delta(x)$ 是狄拉克delta函数。\n\n你的任务是确定成功穿过该势垒的粒子所占的比例。这个比例被称为透射系数 $T$。\n\n将你的最终答案 $T$ 表示为粒子能量 $E$、其质量 $m$、势垒强度 $\\alpha$ 和约化普朗克常数 $\\hbar$ 的解析函数。", "solution": "我们考虑能量为 $E>0$ 时，带 delta 势垒的一维定态薛定谔方程的稳态散射问题：\n$$\n-\\frac{\\hbar^{2}}{2m}\\frac{d^{2}\\psi}{dx^{2}}+\\alpha \\delta(x)\\psi(x)=E\\psi(x).\n$$\n定义波数 $k$ 为\n$$\nk=\\frac{\\sqrt{2mE}}{\\hbar},\n$$\n这样，在远离 $x=0$ 的区域，该方程简化为具有平面波解的自由粒子形式。对于从左侧入射的粒子束，我们将波函数参数化为\n$$\n\\psi(x)=\\begin{cases}\n\\exp(ikx)+r\\,\\exp(-ikx), & x<0,\\\\\nt\\,\\exp(ikx), & x>0,\n\\end{cases}\n$$\n其中 $r$ 和 $t$ 分别是反射振幅和透射振幅。\n\n在 $x=0$ 处的边界条件是：\n1) 波函数的连续性，这可从 delta 势的薛定谔方程直接得出，\n$$\n\\psi(0^{+})=\\psi(0^{-}).\n$$\n2) 导数的不连续性，通过将薛定谔方程从 $-\\epsilon$ 积分到 $+\\epsilon$ 并取 $\\epsilon\\to 0^{+}$ 极限得到：\n$$\n-\\frac{\\hbar^{2}}{2m}\\left[\\psi'(0^{+})-\\psi'(0^{-})\\right]+\\alpha\\int_{-\\epsilon}^{\\epsilon}\\delta(x)\\psi(x)\\,dx=E\\int_{-\\epsilon}^{\\epsilon}\\psi(x)\\,dx.\n$$\n由于当 $\\epsilon\\to 0^{+}$ 时，$\\int_{-\\epsilon}^{\\epsilon}\\delta(x)\\psi(x)\\,dx=\\psi(0)$ 且 $\\int_{-\\epsilon}^{\\epsilon}\\psi(x)\\,dx\\to 0$，我们得到\n$$\n\\psi'(0^{+})-\\psi'(0^{-})=\\frac{2m\\alpha}{\\hbar^{2}}\\psi(0).\n$$\n\n将这些条件应用于平面波拟设：\n- 在 $x=0$ 处的连续性条件给出\n$$\n1+r=t.\n$$\n- 导数不连续性条件用到 $\\psi'(x<0)=ik\\exp(ikx)-ik\\,r\\,\\exp(-ikx)$ 和 $\\psi'(x>0)=ik\\,t\\,\\exp(ikx)$，因此在 $x=0$ 处，\n$$\n\\psi'(0^{+})-\\psi'(0^{-})=ik\\,t-ik(1-r)=ik\\left(t-1+r\\right)=\\frac{2m\\alpha}{\\hbar^{2}}\\psi(0).\n$$\n根据 $\\psi(0)=t$（由连续性可知），上式变为\n$$\nik\\left(t-1+r\\right)=\\frac{2m\\alpha}{\\hbar^{2}}\\,t.\n$$\n将 $t=1+r$ 代入左边，得到\n$$\nik(2r)=\\frac{2m\\alpha}{\\hbar^{2}}\\,t.\n$$\n因此，\n$$\nr=\\frac{m\\alpha}{\\hbar^{2}k}\\,\\frac{t}{i}=-i\\,\\frac{m\\alpha}{\\hbar^{2}k}\\,t.\n$$\n代入 $t=1+r$ 得到\n$$\nt=1-i\\,\\frac{m\\alpha}{\\hbar^{2}k}\\,t\n\\quad\\Longrightarrow\\quad\nt\\left(1+i\\,\\frac{m\\alpha}{\\hbar^{2}k}\\right)=1\n\\quad\\Longrightarrow\\quad\nt=\\frac{1}{1+i\\,\\frac{m\\alpha}{\\hbar^{2}k}}.\n$$\n\n透射系数 $T$ 是透射概率流与入射概率流之比。对于平面波 $A\\exp(ikx)$，概率流为 $j=\\frac{\\hbar k}{m}|A|^{2}$。由于两边的渐近波数相等，所以 $T=|t|^{2}$。因此，\n$$\nT=\\left|\\frac{1}{1+i\\,\\frac{m\\alpha}{\\hbar^{2}k}}\\right|^{2}\n=\\frac{1}{1+\\left(\\frac{m\\alpha}{\\hbar^{2}k}\\right)^{2}}.\n$$\n使用 $k=\\frac{\\sqrt{2mE}}{\\hbar}$，我们简化\n$$\n\\left(\\frac{m\\alpha}{\\hbar^{2}k}\\right)^{2}\n=\\frac{m^{2}\\alpha^{2}}{\\hbar^{4}}\\cdot\\frac{\\hbar^{2}}{2mE}\n=\\frac{m\\alpha^{2}}{2\\hbar^{2}E}.\n$$\n所以，透射系数作为 $E,m,\\alpha,\\hbar$ 的函数是\n$$\nT=\\frac{1}{1+\\frac{m\\alpha^{2}}{2\\hbar^{2}E}}.\n$$\n此表达式在题设的 $\\alpha>0$（排斥性）和 $E>0$ 条件下有效，并且与已知的 delta 势垒的普遍结果相符。", "answer": "$$\\boxed{\\frac{1}{1+\\frac{m\\alpha^{2}}{2\\hbar^{2}E}}}$$", "id": "2113735"}, {"introduction": "在化学反应中，真实的势能面往往非常复杂，无法精确求解。本练习 [@problem_id:2798785] 引入了强大的半经典方法——Wentzel–Kramers–Brillouin (WKB) 近似，这是连接量子理论与化学动力学实验的桥梁。通过推导粒子质量变化对隧穿速率的影响，您不仅能掌握 WKB 近似的应用技巧，更能从根本上理解动力学同位素效应 (Kinetic Isotope Effect) 这一重要的物理化学现象。", "problem": "考虑一个质量为 $m$ 的单个粒子，在具有单个势垒的 Born–Oppenheimer 势能面 $V(x)$ 上沿一维反应坐标 $x$ 运动。设粒子的总能量为 $E$，存在经典转折点 $x_{a}$ 和 $x_{b}$，满足 $V(x_{a}) = E$，$V(x_{b}) = E$，且对于 $x \\in (x_{a}, x_{b})$ 有 $V(x) > E$。从不含时 Schrödinger 方程出发，并使用半经典的 Wentzel–Kramers–Brillouin (WKB) 近似，完成以下任务：\n\n- 推导至半经典近似的主导阶，求出隧穿透射概率 $T$ 的表达式，该表达式应为经典禁区 $(x_{a}, x_{b})$ 上的一个积分，并用 $m$、$V(x)$、$E$ 和约化普朗克常数 $\\hbar$ 表示。\n- 考虑一种同位素取代，它将质量从 $m$ 变为 $\\alpha m$（其中 $\\alpha > 0$），而不改变势能 $V(x)$ 或总能量 $E$。在相同的主导阶半经典近似下，说明在质量从 $m$ 变为 $\\alpha m$ 时，控制透射概率的指数如何变化。\n- 在一个无非绝热效应的绝热反应坐标的深隧穿区域中，假设反应速率常数 $k$ 主要由势垒透射决定，且指前因子对质量取代不敏感，请将质量变化对速率的影响表示为比率 $k(\\alpha)/k(1)$ 的封闭形式表达式，并用势垒区域上的积分来表达。\n\n将最终答案表示为 $k(\\alpha)/k(1)$ 的单个解析表达式，用 $m$、$\\alpha$、$V(x)$、$E$、$x_{a}$、$x_{b}$ 和 $\\hbar$ 表示。无需计算任何积分。最终表达式中不应包含任何单位。无需进行数值舍入。", "solution": "所提出的问题是半经典量子力学中的一个标准练习，具体涉及将 Wentzel–Kramers–Brillouin (WKB) 近似应用于势垒隧穿。该问题具有科学依据、提法严谨，且求解所需的所有必要参数和假设均已提供。因此，该问题被视为有效，可以进行形式推导。\n\n出发点是描述质量为 $m$、能量为 $E$ 的粒子在势能 $V(x)$ 中运动的一维不含时 Schrödinger 方程：\n$$\n-\\frac{\\hbar^2}{2m} \\frac{d^2\\psi(x)}{dx^2} + V(x)\\psi(x) = E\\psi(x)\n$$\n这可以重写为：\n$$\n\\frac{d^2\\psi(x)}{dx^2} = \\frac{2m}{\\hbar^2} (V(x) - E) \\psi(x)\n$$\n在由区间 $(x_{a}, x_{b})$ 定义的经典禁区内（其中 $V(x) > E$），$(V(x) - E)$ 项是正的。我们定义一个实值的、依赖于位置的波数 $\\kappa(x)$ 如下：\n$$\n\\kappa(x) = \\sqrt{\\frac{2m}{\\hbar^2}(V(x) - E)}\n$$\n因此，该区域内的 Schrödinger 方程变为：\n$$\n\\frac{d^2\\psi(x)}{dx^2} = \\kappa(x)^2 \\psi(x)\n$$\n在 WKB 近似中，该方程的解由指数增长和指数衰减的函数给出，其中局部振幅受 $\\kappa(x)$ 的平方根倒数调制：\n$$\n\\psi(x) \\approx \\frac{C_{1}}{\\sqrt{\\kappa(x)}} \\exp\\left(\\int^{x} \\kappa(x') dx'\\right) + \\frac{C_{2}}{\\sqrt{\\kappa(x)}} \\exp\\left(-\\int^{x} \\kappa(x') dx'\\right)\n$$\n穿过势垒的透射概率 $T$ 表示透射波通量与入射波通量之比。在针对高和/或宽势垒（即“深隧穿”区域）的主导阶 WKB 近似中，该概率主要由波函数在穿越从 $x_{a}$到$x_{b}$ 的非经典区域时其振幅的指数衰减所决定。通过将允许区域中的振荡解与势垒内的渐逝解相连接，可以求得透射系数。该过程得出透射概率 $T$ 为：\n$$\nT \\approx \\exp\\left(-2 \\int_{x_{a}}^{x_{b}} \\kappa(x) dx\\right)\n$$\n代入 $\\kappa(x)$ 的定义，我们得到第一个要求的结果：主导阶半经典近似下的隧穿透射概率 $T$。\n$$\nT \\approx \\exp\\left(-2 \\int_{x_{a}}^{x_{b}} \\sqrt{\\frac{2m}{\\hbar^2}(V(x) - E)} dx\\right) = \\exp\\left(-\\frac{2}{\\hbar} \\int_{x_{a}}^{x_{b}} \\sqrt{2m(V(x) - E)} dx\\right)\n$$\n指数的宗量（我们将其记为 $-\\sigma(m)$）控制着隧穿概率的大小。隧穿指数 $\\sigma(m)$ 为：\n$$\n\\sigma(m) = \\frac{2}{\\hbar} \\int_{x_{a}}^{x_{b}} \\sqrt{2m(V(x) - E)} dx\n$$\n\n接下来，我们考虑同位素取代的效应，即将质量从 $m$ 变为 $\\alpha m$，其中 $\\alpha > 0$。势能 $V(x)$ 和能量 $E$ 保持不变，同样，仅依赖于 $V(x)$ 和 $E$ 的经典转折点 $x_{a}$ 和 $x_{b}$ 也保持不变。题目要求我们找出隧穿指数 $\\sigma$ 如何变化。设新的隧穿指数为 $\\sigma(\\alpha m)$。我们在其定义中用 $\\alpha m$ 替换 $m$：\n$$\n\\sigma(\\alpha m) = \\frac{2}{\\hbar} \\int_{x_{a}}^{x_{b}} \\sqrt{2(\\alpha m)(V(x) - E)} dx\n$$\n由于 $\\alpha$ 是一个常数，我们可以将因子 $\\sqrt{\\alpha}$ 从积分中提出：\n$$\n\\sigma(\\alpha m) = \\sqrt{\\alpha} \\left(\\frac{2}{\\hbar} \\int_{x_{a}}^{x_{b}} \\sqrt{2m(V(x) - E)} dx\\right)\n$$\n这显示了新旧隧穿指数之间的直接关系：\n$$\n\\sigma(\\alpha m) = \\sqrt{\\alpha} \\sigma(m)\n$$\n该隧穿指数与质量比 $\\alpha$ 的平方根成正比。这是隧穿背景下动力学同位素效应的一个基本结果。\n\n最后，在给定的假设下，我们要求解反应速率常数之比 $k(\\alpha)/k(1)$。问题指出，反应速率常数 $k$ 主要由势垒透射决定，且任何指前因子都对质量取代不敏感。这意味着速率常数与透射概率成正比：\n$$\nk \\propto T\n$$\n设 $k(1)$ 为质量 $m$（对应 $\\alpha=1$）时的速率常数，$k(\\alpha)$ 为质量 $\\alpha m$ 时的速率常数。它们的比值可以表示为各自透射概率 $T(\\alpha)$ 和 $T(1)$ 的比值：\n$$\n\\frac{k(\\alpha)}{k(1)} = \\frac{T(\\alpha)}{T(1)}\n$$\n使用 $T$ 的 WKB 表达式：\n$$\n\\frac{k(\\alpha)}{k(1)} = \\frac{\\exp(-\\sigma(\\alpha m))}{\\exp(-\\sigma(m))} = \\exp(-\\sigma(\\alpha m) + \\sigma(m))\n$$\n将关系式 $\\sigma(\\alpha m) = \\sqrt{\\alpha} \\sigma(m)$ 代入此表达式中：\n$$\n\\frac{k(\\alpha)}{k(1)} = \\exp(-\\sqrt{\\alpha}\\sigma(m) + \\sigma(m)) = \\exp((1 - \\sqrt{\\alpha})\\sigma(m))\n$$\n现在，我们将 $\\sigma(m)$ 的完整积分表达式代入，以获得用基本参数表示的速率常数比值的最终封闭形式表达式：\n$$\n\\frac{k(\\alpha)}{k(1)} = \\exp\\left( \\left( 1 - \\sqrt{\\alpha} \\right) \\frac{2}{\\hbar} \\int_{x_{a}}^{x_{b}} \\sqrt{2m(V(x) - E)} dx \\right)\n$$\n该表达式在半经典近似的框架内量化了由隧穿引起的动力学同位素效应。", "answer": "$$\n\\boxed{\\exp\\left( \\left( 1 - \\sqrt{\\alpha} \\right) \\frac{2}{\\hbar} \\int_{x_{a}}^{x_{b}} \\sqrt{2m(V(x) - E)} dx \\right)}\n$$", "id": "2798785"}, {"introduction": "理论的深度最终需要通过计算能力来展现其强大的预测和解释能力。本练习 [@problem_id:2461151] 旨在引导您从第一性原理出发，编写一个数值程序来求解任意一维势垒的透射系数。通过实现传递矩阵法，您将构建一个通用的计算工具，能够处理解析方法难以企及的复杂势垒，并能 firsthand 观察到诸如共振隧穿等精妙的量子现象，这是理论化学家必备的核心技能之一。", "problem": "要求您实现一个完整、可运行的程序，通过对任意势垒进行阶梯常数近似，数值求解不含时薛定谔方程，以计算稳态散射下的一维量子隧穿透射系数。科学基础必须从第一性原理出发。使用一维不含时薛定谔方程 (TISE)，\n$$\n\\frac{d^2 \\psi(x)}{dx^2} + \\frac{2 m}{\\hbar^2} \\left(E - V(x)\\right)\\psi(x) = 0,\n$$\n结合波函数及其一阶导数在材料界面处的连续性，以及稳态的概率流密度定义，将透射系数定义为通量之比。请勿使用任何预先给出的透射公式；相反，您需要在自己的算法步骤中从这些基础原理推导出您所实现的内容。\n\n您必须在原子单位 (a.u.) 制下工作，其中电子质量 $m = 1$ 且 $\\hbar = 1$，因此能量单位是 Hartree，长度单位是 Bohr。透射系数是无量纲的。\n\n您的实现要求是：\n- 将有限域 $[x_L,x_R]$ 离散化为 $N$ 个宽度为 $\\Delta x = (x_R - x_L)/N$ 的均匀切片。\n- 用分段常数函数来近似 $V(x)$，在切片 $j$ 上其值取为该切片中点的势 $V_j$。\n- 在每个切片内，求解局域形式的 TISE，并利用连续性条件关联跨越每个切片和每个界面的波幅。\n- 使用这些关系从左侧导线传播到右侧导线，并计算透射系数 $T$，其为透射概率流与入射概率流的比值，表示为一个在 $[0,1]$ 区间内的实数。\n\n测试套件：\n实现四个测试用例，以检验不同的物理情景。在所有情况下，均使用 $x_L = -10$ (Bohr)、$x_R = 10$ (Bohr) 和 $N = 4000$。\n\n- 情况 A（单有限矩形势垒，低于势垒能量）：\n  - 势：$V(x) = V_0$ 当 $|x| \\le a/2$，否则 $V(x) = 0$。\n  - 参数：$V_0 = 0.5$ (Hartree)，$a = 2.0$ (Bohr)，$E = 0.2$ (Hartree)。\n  - 预期定性行为：由于隧穿效应，$T$ 值很小但不为零。\n\n- 情况 B（单有限矩形势垒，高能量）：\n  - 势和几何结构与情况 A 相同。\n  - 参数：$V_0 = 0.5$ (Hartree)，$a = 2.0$ (Bohr)，$E = 2.0$ (Hartree)。\n  - 预期定性行为：$T$ 接近于 $1$。\n\n- 情况 C（无势垒，自由传播）：\n  - 势：对于所有 $x$，$V(x) = 0$。\n  - 参数：$E = 0.3$ (Hartree)。\n  - 预期定性行为：$T = 1$。\n\n- 情况 D（带有谐振阱的双势垒）：\n  - 势：两个相同的高为 $V_0$、宽为 $b$ 的矩形势垒，由一个宽度为 $L_w$ 的势阱隔开。明确地说，$V(x) = V_0$ 在 $[-L_w/2 - b, -L_w/2] \\cup [L_w/2, L_w/2 + b]$ 区间上，其他地方 $V(x) = 0$。\n  - 参数：$V_0 = 0.6$ (Hartree)，$b = 0.5$ (Bohr)，$L_w = 4.0$ (Bohr)，$E = 0.31$ (Hartree)。\n  - 预期定性行为：$T$ 表现出谐振增强，在谐振点附近可以接近 $1$。\n\n角度单位不适用。透射系数是无量纲的。您的程序必须生成单行输出，其中包含一个 Python 风格的列表，该列表包含与四个案例相对应的四个数值透射值，顺序为 A、B、C、D，每个值四舍五入到 $6$ 位小数。确切的输出格式要求是：\n\"[t_A,t_B,t_C,t_D]\"\n不带空格。\n\n您的程序不得读取任何输入。它必须计算这四个值并打印出所要求的单行。最终答案必须是浮点数。推导和算法必须仅基于 TISE、界面处的连续性条件以及概率流密度定义。请确保您在选择和计算中保证数值稳定性和科学合理性。", "solution": "该问题是有效的。它在科学上基于量子力学原理，问题定义明确、客观，并包含获得唯一解所需的所有必要信息。我们将进行完整的推导和实现。\n\n这个问题的基础是一维不含时薛定谔方程 (TISE)。在原子单位制中，电子质量 $m=1$ 且约化普朗克常数 $\\hbar=1$，对于能量为 $E$、在势 $V(x)$ 中运动的粒子，TISE 为：\n$$\n\\frac{d^2 \\psi(x)}{dx^2} + 2 \\left(E - V(x)\\right)\\psi(x) = 0\n$$\n我们的任务是为散射态求解此方程，其中一个粒子从左侧入射到一个势垒上。势 $V(x)$ 被近似为一个分段常数函数。感兴趣的区域 $[x_L, x_R]$ 被离散化为 $N$ 个均匀的切片，每个切片的宽度为 $\\Delta x = (x_R - x_L)/N$。在每个跨越区间 $[x_{j-1}, x_j]$ 的切片 $j$ 内（其中 $x_j = x_L + j\\Delta x$），势保持恒定，为 $V_j = V(x_{j-1} + \\Delta x/2)$。\n\n在切片 $j$ 中，TISE 呈现为简谐振子方程的形式：\n$$\n\\frac{d^2 \\psi_j(x)}{dx^2} + k_j^2 \\psi_j(x) = 0\n$$\n其中 $k_j^2 = 2(E - V_j)$ 是局域波数的平方。解的性质取决于 $k_j^2$ 的符号：\n1.  如果 $E > V_j$，$k_j = \\sqrt{2(E - V_j)}$ 是实数。解是振荡的，代表传播波：$\\psi_j(x) = A_j e^{i k_j x} + B_j e^{-i k_j x}$。\n2.  如果 $E < V_j$，$k_j = i\\sqrt{2(V_j - E)} \\equiv i\\kappa_j$ 是纯虚数，其中 $\\kappa_j$ 是实数。解是指数形式的，代表倏逝（非传播）波：$\\psi_j(x) = A_j e^{-\\kappa_j x} + B_j e^{\\kappa_j x}$。\n\n为了在整个区域上求解该系统，我们采用传输矩阵方法。我们不跟踪可能数值不稳定的系数 $(A_j, B_j)$，而是传播状态向量 $\\mathbf{S}(x) = \\begin{pmatrix} \\psi(x) \\\\ \\psi'(x) \\end{pmatrix}$，其中 $\\psi'(x) = d\\psi/dx$。$\\psi(x)$ 和 $\\psi'(x)$ 在切片间界面处的连续性通过这种方法得以自然保持。\n\n在切片 $j$ 内，我们需要一个矩阵 $\\mathbf{P}_j$ 来关联切片末端的状态 $\\mathbf{S}(x_j)$ 与切片起始端的状态 $\\mathbf{S}(x_{j-1})$：$\\mathbf{S}(x_j) = \\mathbf{P}_j \\mathbf{S}(x_{j-1})$。\n切片 $j$ 内的通解可以写为 $\\psi(x) = C \\cos(k_j(x-x_{j-1})) + D \\sin(k_j(x-x_{j-1}))$。在 $x=x_{j-1}$ 处，我们有 $\\psi(x_{j-1}) = C$ 和 $\\psi'(x_{j-1}) = D k_j$，这使我们能够用初始状态向量表示 $C$ 和 $D$。在 $x=x_j=x_{j-1}+\\Delta x$ 处计算 $\\psi(x)$ 和 $\\psi'(x)$，可以得到传播矩阵 $\\mathbf{P}_j$。\n\n情况 1：$E > V_j$（$k_j$ 为实数且非零）\n解是振荡的。传播矩阵为：\n$$\n\\mathbf{P}_j = \\begin{pmatrix} \\cos(k_j \\Delta x) & \\frac{1}{k_j}\\sin(k_j \\Delta x) \\\\ -k_j \\sin(k_j \\Delta x) & \\cos(k_j \\Delta x) \\end{pmatrix}\n$$\n情况 2：$E < V_j$（$\\kappa_j$ 为实数且非零）\n解是指数形式的。使用 $\\cos(iy) = \\cosh(y)$ 和 $\\sin(iy) = i\\sinh(y)$，传播矩阵变为：\n$$\n\\mathbf{P}_j = \\begin{pmatrix} \\cosh(\\kappa_j \\Delta x) & \\frac{1}{\\kappa_j}\\sinh(\\kappa_j \\Delta x) \\\\ \\kappa_j \\sinh(\\kappa_j \\Delta x) & \\cosh(\\kappa_j \\Delta x) \\end{pmatrix}\n$$\n情况 3：$E = V_j$（$k_j=0$）\nTISE 简化为 $\\psi''(x)=0$，解为 $\\psi(x) = Ax+B$。传播矩阵是情况 1 中 $k_j \\to 0$ 的极限：\n$$\n\\mathbf{P}_j = \\begin{pmatrix} 1 & \\Delta x \\\\ 0 & 1 \\end{pmatrix}\n$$\n右边界 $x_R=x_N$ 处的状态与左边界 $x_L=x_0$ 处的状态通过所有切片传播矩阵的乘积相关联：\n$$\n\\mathbf{S}(x_R) = (\\mathbf{P}_N \\mathbf{P}_{N-1} \\cdots \\mathbf{P}_1) \\mathbf{S}(x_L) \\equiv \\mathbf{P}_{total} \\mathbf{S}(x_L)\n$$\n问题指定了散射边界条件。我们假设在区域 $[x_L, x_R]$ 之外势为零。\n-   在左侧导线 ($x \\leq x_L$) 中，波函数是单位振幅的入射波和反射波的叠加：$\\psi_L(x) = e^{ik_0 x} + r e^{-ik_0 x}$，其中 $k_0 = \\sqrt{2E}$。\n-   在右侧导线 ($x \\geq x_R$) 中，只有透射波：$\\psi_R(x) = t e^{ik_0 x}$。\n\n从这些形式中，我们确定边界处的状态向量：\n$$\n\\mathbf{S}(x_L) = \\begin{pmatrix} e^{ik_0 x_L} + r e^{-ik_0 x_L} \\\\ ik_0(e^{ik_0 x_L} - r e^{-ik_0 x_L}) \\end{pmatrix} \\quad , \\quad \\mathbf{S}(x_R) = t \\begin{pmatrix} e^{ik_0 x_R} \\\\ ik_0 e^{ik_0 x_R} \\end{pmatrix}\n$$\n将这些代入关系式 $\\mathbf{S}(x_R) = \\mathbf{P}_{total} \\mathbf{S}(x_L)$，得到一个关于未知复振幅 $r$ 和 $t$ 的二元线性方程组。设 $\\mathbf{P}_{total} = \\begin{pmatrix} P_{11} & P_{12} \\\\ P_{21} & P_{22} \\end{pmatrix}$。求解该方程组得到透射振幅 $t$：\n$$\nt = \\frac{-2ik_0 e^{-ik_0(x_R-x_L)}}{ (P_{21} - k_0^2 P_{12}) - i k_0 (P_{11} + P_{22}) }\n$$\n透射系数 $T$ 定义为透射概率流与入射概率流的比值。稳态的概率流为 $j(x) = \\frac{1}{2i}(\\psi^* \\psi' - \\psi \\psi'^*)$。\n-   入射流：$j_{inc} = k_0$（对于入射波 $e^{ik_0 x}$）。\n-   透射流：$j_{trans} = |t|^2 k_0$（对于透射波 $t e^{ik_0 x}$）。\n因此，透射系数为 $T = j_{trans}/j_{inc} = |t|^2$。\n使用 $t$ 的表达式，并注意到传播矩阵 $\\mathbf{P}_j$ 是实矩阵，我们发现：\n$$\nT = |t|^2 = \\frac{4k_0^2}{|(P_{21} - k_0^2 P_{12}) - i k_0 (P_{11} + P_{22})|^2} = \\frac{4k_0^2}{(P_{21} - k_0^2 P_{12})^2 + k_0^2(P_{11} + P_{22})^2}\n$$\n这个公式可以直接计算透射系数。\n\n算法如下：\n1.  对于每个测试用例，定义能量 $E$ 和势函数 $V(x)$。\n2.  建立空间网格并为 $N$ 个切片中的每一个计算恒定势 $V_j$。\n3.  计算自由空间波数 $k_0 = \\sqrt{2E}$。\n4.  将总传播矩阵 $\\mathbf{P}_{total}$ 初始化为 $2 \\times 2$ 的单位矩阵。\n5.  遍历每个切片 $j=1, \\ldots, N$。在每次迭代中，根据 $2(E-V_j)$ 的符号计算切片矩阵 $\\mathbf{P}_j$，并通过左乘更新总矩阵：$\\mathbf{P}_{total} \\leftarrow \\mathbf{P}_j \\, \\mathbf{P}_{total}$。\n6.  遍历所有切片后，提取最终 $\\mathbf{P}_{total}$ 的四个元素。\n7.  使用推导出的 $T$ 的公式来计算透射系数。\n将对所有四个测试用例实施此过程。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to solve the four test cases for quantum tunneling.\n    \"\"\"\n\n    def calculate_transmission(params):\n        \"\"\"\n        Calculates the transmission coefficient for a single set of parameters.\n        The method uses the transfer matrix approach for the state vector (psi, psi').\n        \"\"\"\n        x_L, x_R, N, E, V_func = params\n        dx = (x_R - x_L) / N\n\n        if E <= 0:\n            return 0.0\n        \n        k0 = np.sqrt(2 * E)\n\n        # Initialize the total propagation matrix\n        P_total = np.identity(2, dtype=np.float64)\n\n        # Define grid midpoints for potential evaluation\n        x_mids = x_L + dx / 2.0 + np.arange(N) * dx\n        \n        # Create an array of potential values for each slice\n        V_slices = V_func(x_mids)\n\n        # The total propagation matrix is P_N * P_{N-1} * ... * P_1\n        # Loop computes P_1, then P_2*P_1, then P_3*P_2*P_1, etc.\n        for i in range(N):\n            V = V_slices[i]\n            k_squared = 2 * (E - V)\n            \n            # This is the matrix for the i-th slice (P_{i+1} in formula)\n            P_slice = np.empty((2, 2), dtype=np.float64)\n\n            # E > V: Propagating region\n            if k_squared > 0:\n                k = np.sqrt(k_squared)\n                # Handle k -> 0 case for numerical stability\n                if np.abs(k * dx) < 1e-9:\n                    P_slice[0, 0] = 1.0\n                    P_slice[0, 1] = dx\n                    P_slice[1, 0] = 0.0\n                    P_slice[1, 1] = 1.0\n                else:\n                    c = np.cos(k * dx)\n                    s = np.sin(k * dx)\n                    P_slice[0, 0] = c\n                    P_slice[0, 1] = s / k\n                    P_slice[1, 0] = -k * s\n                    P_slice[1, 1] = c\n            # E < V: Evanescent region\n            else:\n                kappa = np.sqrt(-k_squared)\n                # Handle kappa -> 0 case (same as k -> 0)\n                if np.abs(kappa * dx) < 1e-9:\n                    P_slice[0, 0] = 1.0\n                    P_slice[0, 1] = dx\n                    P_slice[1, 0] = 0.0\n                    P_slice[1, 1] = 1.0\n                else:\n                    ch = np.cosh(kappa * dx)\n                    sh = np.sinh(kappa * dx)\n                    P_slice[0, 0] = ch\n                    P_slice[0, 1] = sh / kappa\n                    P_slice[1, 0] = kappa * sh\n                    P_slice[1, 1] = ch\n            \n            # Left-multiply to build P_i * P_{i-1} * ...\n            P_total = P_slice @ P_total\n\n        # Extract elements of the total propagation matrix\n        P11, P12, P21, P22 = P_total.flatten()\n        \n        # Calculate transmission coefficient T using the derived formula\n        denominator = (P21 - k0**2 * P12)**2 + (k0 * (P11 + P22))**2\n        \n        if denominator == 0:\n            # Should not happen for k0 > 0, but as a safeguard\n            return 1.0  # Physical limit for resonance\n\n        T = 4 * k0**2 / denominator\n        return T\n\n    # Common parameters for all test cases\n    x_L = -10.0\n    x_R = 10.0\n    N = 4000\n\n    # Test Case A: Single rectangular barrier, sub-barrier energy\n    V0_A = 0.5\n    a_A = 2.0\n    E_A = 0.2\n    V_func_A = lambda x: np.where(np.abs(x) <= a_A / 2.0, V0_A, 0.0)\n    case_A = (x_L, x_R, N, E_A, V_func_A)\n\n    # Test Case B: Single rectangular barrier, high energy\n    V0_B = 0.5\n    a_B = 2.0\n    E_B = 2.0\n    V_func_B = lambda x: np.where(np.abs(x) <= a_B / 2.0, V0_B, 0.0)\n    case_B = (x_L, x_R, N, E_B, V_func_B)\n\n    # Test Case C: No barrier, free propagation\n    E_C = 0.3\n    V_func_C = lambda x: np.zeros_like(x)\n    case_C = (x_L, x_R, N, E_C, V_func_C)\n\n    # Test Case D: Double barrier with a resonant well\n    V0_D = 0.6\n    b_D = 0.5\n    Lw_D = 4.0\n    E_D = 0.31\n    def V_func_D(x):\n        abs_x = np.abs(x)\n        return np.where((abs_x >= Lw_D / 2.0) & (abs_x <= Lw_D / 2.0 + b_D), V0_D, 0.0)\n    case_D = (x_L, x_R, N, E_D, V_func_D)\n\n    test_cases = [case_A, case_B, case_C, case_D]\n\n    results = []\n    for case in test_cases:\n        result = calculate_transmission(case)\n        results.append(result)\n\n    # Format the final output string as required\n    formatted_results = [f\"{r:.6f}\" for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2461151"}]}