{"hands_on_practices": [{"introduction": "量子谐振子是量子力学中的一个基石模型。本练习将引导你运用算符代数方法，从基本的对易关系出发，构造升降算符来求解其本征值方程。通过这种优雅的代数技巧，你不仅能够推导出能谱，还能计算位置算符的期望值，从而深入理解量子系统的内在结构，并熟练掌握处理量子算符的核心技能。[@problem_id:2769966]", "id": "2769966", "problem": "一个双原子分子的一维（1D）单振动简正模式被建模为一个量子谐振子（QHO），其哈密顿量为 $H = \\frac{p^{2}}{2m} + \\frac{1}{2} m \\omega^{2} x^{2}$，其中 $x$ 是位移坐标，$p$ 是其共轭动量，$m$ 是折合质量，$\\omega$ 是角频率。仅从正则对易关系 $[x,p] = i \\hbar$ 和哈密顿量 $H$ 出发，完成以下任务。\n\n1. 构造算符 $a$ 和 $a^{\\dagger}$，它们是 $x$ 和 $p$ 的线性组合且无量纲，使得 $[a, a^{\\dagger}]$ 是一个 c-数。通过施加要求 $[a, a^{\\dagger}] = 1$ 以及 $H$ 是 $a^{\\dagger} a$ 的线性函数加上一个常数来确定系数。然后用 $a$ 和 $a^{\\dagger}$ 表示 $H$。\n\n2. 仅使用由 $[a, a^{\\dagger}] = 1$ 所蕴含的代数，定义数算符 $N = a^{\\dagger} a$ 并证明存在一个完备的定态集 $\\{|n\\rangle\\}_{n=0}^{\\infty}$，使得 $N |n\\rangle = n |n\\rangle$，其中 $n \\in \\mathbb{N}_{0}$。由此推导出量子谐振子本征值方程中出现的能量本征值 $E_{n}$。\n\n3. 对于任意定态 $|n\\rangle$，使用与 $a$ 和 $a^{\\dagger}$ 的代数一致的算符方法，计算期望值 $\\langle x \\rangle$ 和 $\\langle x^{2} \\rangle$。\n\n将最终能量 $E_{n}$ 以焦耳为单位，$\\langle x \\rangle$ 以米为单位，$\\langle x^{2} \\rangle$ 以平方米为单位表示，所有单位均使用国际单位制（SI）。结果用 $m$、$\\omega$、$\\hbar$ 和 $n$ 的符号形式表示。将你的最终答案以单行矩阵 $\\begin{pmatrix} E_{n} & \\langle x \\rangle & \\langle x^{2} \\rangle \\end{pmatrix}$ 的形式报告。不需要进行数值计算。", "solution": "我们从正则对易关系 $[x, p] = i \\hbar$ 和谐振子哈密顿量 $H = \\frac{p^{2}}{2m} + \\frac{1}{2} m \\omega^{2} x^{2}$ 开始。我们的目标是构造作为阶梯算符的 $x$ 和 $p$ 的线性组合，推导数算符代数，并获得能谱和所要求的期望值。\n\n步骤 1：构造阶梯算符和哈密顿量的正规序形式。我们寻求算符 $a$ 和 $a^{\\dagger}$，它们是 $x$ 和 $p$ 的线性组合、无量纲，并满足一个简单的对易子。考虑最一般的线性无量纲形式\n$$\na = \\alpha x + i \\beta p, \\quad a^{\\dagger} = \\alpha x - i \\beta p,\n$$\n其中取 $\\alpha$ 和 $\\beta$ 为实数，以确保 $a^{\\dagger}$ 是 $a$ 的厄米共轭。$x$ 和 $p$ 的量纲分别为 $[x] = \\mathrm{L}$ 和 $[p] = \\mathrm{M\\,L\\,T^{-1}}$，因此要求 $a$ 是无量纲的，意味着 $[\\alpha] = \\mathrm{L^{-1}}$ 和 $[\\beta] = \\mathrm{T\\,M^{-1}\\,L^{-1}}$。我们计算对易子：\n$$\n[a, a^{\\dagger}] = [\\alpha x + i \\beta p, \\alpha x - i \\beta p] = \\alpha^{2}[x,x] - i \\alpha \\beta [x,p] + i \\alpha \\beta [p,x] + \\beta^{2}[p,p].\n$$\n使用 $[x,x]=[p,p]=0$ 和 $[x,p]=i \\hbar$，我们得到\n$$\n[a, a^{\\dagger}] = - i \\alpha \\beta (i \\hbar) + i \\alpha \\beta (- i \\hbar) = 2 \\alpha \\beta \\hbar.\n$$\n施加正则阶梯代数 $[a, a^{\\dagger}] = 1$，得到\n$$\n2 \\alpha \\beta \\hbar = 1 \\quad \\Rightarrow \\quad \\alpha \\beta = \\frac{1}{2 \\hbar}.\n$$\n接下来，我们用 $a$ 和 $a^{\\dagger}$ 来表示 $H$。求解 $x$ 和 $p$：\n$$\nx = \\frac{1}{2 \\alpha}(a + a^{\\dagger}), \\quad p = \\frac{1}{2 i \\beta}(a - a^{\\dagger}).\n$$\n代入 $H$：\n$$\nH = \\frac{1}{2m} \\left( \\frac{1}{2 i \\beta} \\right)^{2} (a - a^{\\dagger})^{2} + \\frac{1}{2} m \\omega^{2} \\left( \\frac{1}{2 \\alpha} \\right)^{2} (a + a^{\\dagger})^{2}.\n$$\n使用 $[a, a^{\\dagger}] = 1$ 进行展开和重新排序。如果我们选择 $\\alpha$ 和 $\\beta$ 使其系数大小相等、符号相反，则交叉项 $aa$ 和 $a^{\\dagger} a^{\\dagger}$ 会相互抵消，即\n$$\n\\frac{1}{8 m \\beta^{2}} = \\frac{1}{8} m \\omega^{2} \\frac{1}{\\alpha^{2}} \\quad \\Rightarrow \\quad \\frac{1}{m \\beta^{2}} = m \\omega^{2} \\frac{1}{\\alpha^{2}} \\quad \\Rightarrow \\quad \\alpha^{2} = m^{2} \\omega^{2} \\beta^{2}.\n$$\n结合 $\\alpha \\beta = \\frac{1}{2 \\hbar}$，我们解出 $\\alpha$ 和 $\\beta$：\n$$\n\\alpha = \\sqrt{\\frac{m \\omega}{2 \\hbar}}, \\quad \\beta = \\sqrt{\\frac{1}{2 m \\hbar \\omega}}.\n$$\n因此阶梯算符为\n$$\na = \\sqrt{\\frac{m \\omega}{2 \\hbar}}\\, x + i \\sqrt{\\frac{1}{2 m \\hbar \\omega}}\\, p, \\quad a^{\\dagger} = \\sqrt{\\frac{m \\omega}{2 \\hbar}}\\, x - i \\sqrt{\\frac{1}{2 m \\hbar \\omega}}\\, p,\n$$\n它们确实满足 $[a, a^{\\dagger}] = 1$。通过这些选择，哈密顿量简化为正规序形式\n$$\nH = \\hbar \\omega \\left( a^{\\dagger} a + \\frac{1}{2} \\right).\n$$\n\n步骤 2：数算符代数和能谱。定义数算符 $N = a^{\\dagger} a$。由 $[a, a^{\\dagger}] = 1$ 可推导出\n$$\n[N, a] = -a, \\quad [N, a^{\\dagger}] = a^{\\dagger}.\n$$\n假设存在一个归一化态 $|0\\rangle$，使得 $a |0\\rangle = 0$（基态）。然后通过重复施加 $a^{\\dagger}$ 来构造激发态：\n$$\n|n\\rangle = \\frac{(a^{\\dagger})^{n}}{\\sqrt{n!}} |0\\rangle, \\quad n \\in \\mathbb{N}_{0}.\n$$\n它们满足\n$$\nN |n\\rangle = n |n\\rangle, \\quad a |n\\rangle = \\sqrt{n} \\, |n-1\\rangle, \\quad a^{\\dagger} |n\\rangle = \\sqrt{n+1} \\, |n+1\\rangle.\n$$\n使用 $H = \\hbar \\omega (N + \\frac{1}{2})$，定态 $|n\\rangle$ 满足本征值方程\n$$\nH |n\\rangle = \\hbar \\omega \\left( n + \\frac{1}{2} \\right) |n\\rangle,\n$$\n所以能量本征值为\n$$\nE_{n} = \\hbar \\omega \\left( n + \\frac{1}{2} \\right).\n$$\n\n步骤 3：在 $|n\\rangle$ 中的期望值 $\\langle x \\rangle$ 和 $\\langle x^{2} \\rangle$。使用上面确定的系数，用 $a$ 和 $a^{\\dagger}$ 表示 $x$：\n$$\nx = \\sqrt{\\frac{\\hbar}{2 m \\omega}} \\, (a + a^{\\dagger}).\n$$\n首先，计算 $\\langle x \\rangle_{n} \\equiv \\langle n | x | n \\rangle$：\n$$\n\\langle x \\rangle_{n} = \\sqrt{\\frac{\\hbar}{2 m \\omega}} \\, \\langle n | (a + a^{\\dagger}) | n \\rangle = \\sqrt{\\frac{\\hbar}{2 m \\omega}} \\, \\left( \\sqrt{n} \\, \\langle n | n-1 \\rangle + \\sqrt{n+1} \\, \\langle n | n+1 \\rangle \\right) = 0,\n$$\n因为福克态是正交归一的，$\\langle n | n \\pm 1 \\rangle = 0$。\n\n接下来，计算 $\\langle x^{2} \\rangle_{n} \\equiv \\langle n | x^{2} | n \\rangle$：\n$$\nx^{2} = \\frac{\\hbar}{2 m \\omega} \\, (a + a^{\\dagger})^{2} = \\frac{\\hbar}{2 m \\omega} \\, \\left( a^{2} + a a^{\\dagger} + a^{\\dagger} a + (a^{\\dagger})^{2} \\right).\n$$\n在 $|n\\rangle$ 中取期望值，并注意到根据正交性 $\\langle n | a^{2} | n \\rangle = 0$ 和 $\\langle n | (a^{\\dagger})^{2} | n \\rangle = 0$，我们得到\n$$\n\\langle x^{2} \\rangle_{n} = \\frac{\\hbar}{2 m \\omega} \\left( \\langle n | a a^{\\dagger} | n \\rangle + \\langle n | a^{\\dagger} a | n \\rangle \\right).\n$$\n使用 $a a^{\\dagger} = a^{\\dagger} a + 1$ 和 $a^{\\dagger} a = N$，我们有\n$$\n\\langle n | a a^{\\dagger} | n \\rangle = \\langle n | N + 1 | n \\rangle = n + 1, \\quad \\langle n | a^{\\dagger} a | n \\rangle = \\langle n | N | n \\rangle = n.\n$$\n因此，\n$$\n\\langle x^{2} \\rangle_{n} = \\frac{\\hbar}{2 m \\omega} \\left( (n + 1) + n \\right) = \\frac{\\hbar}{2 m \\omega} (2 n + 1) = \\frac{\\hbar}{m \\omega} \\left( n + \\frac{1}{2} \\right).\n$$\n\n综合结果，在国际单位制（SI）中，能量本征值为 $E_{n} = \\hbar \\omega \\left( n + \\frac{1}{2} \\right)$（焦耳），位置期望值为 $\\langle x \\rangle = 0$（米），均方位移为 $\\langle x^{2} \\rangle = \\frac{\\hbar}{m \\omega} \\left( n + \\frac{1}{2} \\right)$（平方米）。最终答案要求以单行矩阵的形式报告。", "answer": "$$\\boxed{\\begin{pmatrix}\\hbar \\omega \\left(n + \\frac{1}{2}\\right) & 0 & \\frac{\\hbar}{m \\omega} \\left(n + \\frac{1}{2}\\right)\\end{pmatrix}}$$"}, {"introduction": "变分原理是量子化学中求解复杂体系薛定谔方程的最重要近似方法之一。在本练习中，你将应用变分原理，通过一个含可调参数的高斯试探波函数，来估算谐振子的基态能量。这个实践不仅能让你掌握变分法的计算流程，还能通过与上一练习中得到的精确解进行比较，深刻理解试探函数选择对结果精度的影响。[@problem_id:2769997]", "id": "2769997", "problem": "考虑一个质量为 $m$ 的非相对论性粒子，在一维空间中于角频率为 $\\omega$ 的谐振子势中运动。其哈密顿算符为 $\\hat{H} = \\frac{\\hat{p}^{2}}{2 m} + \\frac{1}{2} m \\omega^{2} \\hat{x}^{2}$，其中 $\\hat{p} = - \\mathrm{i} \\hbar \\frac{\\mathrm{d}}{\\mathrm{d} x}$。使用 Rayleigh–Ritz 变分原理，取高斯函数作为归一化试探函数\n$$\n\\psi_{\\beta}(x) = \\left(\\frac{2 \\beta}{\\pi}\\right)^{1/4} \\exp\\!\\left(- \\beta x^{2}\\right),\n$$\n其中变分参数 $\\beta > 0$。从期望值的定义 $\\langle \\hat{A} \\rangle_{\\psi} = \\int_{-\\infty}^{\\infty} \\psi^{*}(x) \\, \\hat{A} \\, \\psi(x) \\, \\mathrm{d} x$ 出发，计算期望值 $E(\\beta) = \\langle \\hat{H} \\rangle_{\\psi_{\\beta}}$ 作为 $\\beta$ 的函数，并确定使 $E(\\beta)$ 最小的 $\\beta$ 值。接下来，使用基于正则对易关系 $[\\hat{x}, \\hat{p}] = \\mathrm{i} \\hbar$ 的第一性原理算符方法，求解该系统的本征值方程 $\\hat{H} \\psi = E \\psi$ 以获得精确的基态能量。最后，通过计算比值 $R = \\frac{E_{\\mathrm{var}}^{\\mathrm{min}}}{E_{0}^{\\mathrm{exact}}}$，比较优化后的变分估计值与精确基态能量。将 $R$ 报告为一个无单位的精确实数。无需四舍五入，最终报告值中不应包含单位。", "solution": "所述问题提法明确，具有科学依据，并包含了严谨求解所需的所有信息。我们将着手进行分析。\n\n该问题需要进行三部分计算：首先，应用 Rayleigh–Ritz 变分原理估计量子谐振子的基态能量；其次，使用算符方法推导精确的基态能量；第三，比较这两个结果。\n\n第一部分：变分法\n\n我们必须计算的是给定归一化试探波函数 $\\psi_{\\beta}(x)$ 下哈密顿算符 $\\hat{H}$ 的期望值。能量泛函为 $E(\\beta) = \\langle \\hat{H} \\rangle_{\\psi_{\\beta}}$。\n哈密顿算符为 $\\hat{H} = \\hat{T} + \\hat{V}$，其中动能算符是 $\\hat{T} = \\frac{\\hat{p}^{2}}{2 m} = -\\frac{\\hbar^{2}}{2m} \\frac{\\mathrm{d}^{2}}{\\mathrm{d} x^{2}}$，势能算符是 $\\hat{V} = \\frac{1}{2} m \\omega^{2} \\hat{x}^{2}$。\n能量的期望值是动能期望值和势能期望值的和：\n$$\nE(\\beta) = \\langle \\hat{T} \\rangle + \\langle \\hat{V} \\rangle = \\int_{-\\infty}^{\\infty} \\psi_{\\beta}^{*}(x) \\left(-\\frac{\\hbar^{2}}{2m} \\frac{\\mathrm{d}^{2}}{\\mathrm{d} x^{2}}\\right) \\psi_{\\beta}(x) \\, \\mathrm{d} x + \\int_{-\\infty}^{\\infty} \\psi_{\\beta}^{*}(x) \\left(\\frac{1}{2} m \\omega^{2} x^{2}\\right) \\psi_{\\beta}(x) \\, \\mathrm{d} x\n$$\n试探波函数为 $\\psi_{\\beta}(x) = \\left(\\frac{2 \\beta}{\\pi}\\right)^{1/4} \\exp(-\\beta x^{2})$。由于该函数是实函数，因此 $\\psi_{\\beta}^{*}(x) = \\psi_{\\beta}(x)$。\n\n首先，我们计算势能的期望值 $\\langle V \\rangle$：\n$$\n\\langle V \\rangle = \\frac{1}{2} m \\omega^{2} \\int_{-\\infty}^{\\infty} x^{2} |\\psi_{\\beta}(x)|^{2} \\, \\mathrm{d} x = \\frac{1}{2} m \\omega^{2} \\left(\\frac{2 \\beta}{\\pi}\\right)^{1/2} \\int_{-\\infty}^{\\infty} x^{2} \\exp(-2 \\beta x^{2}) \\, \\mathrm{d} x\n$$\n我们使用高斯函数的标准定积分公式：$\\int_{-\\infty}^{\\infty} x^{2n} \\exp(-ax^{2}) \\, \\mathrm{d} x = \\frac{(2n-1)!!}{2^{n} a^{n}} \\sqrt{\\frac{\\pi}{a}}$。在我们的例子中，$n=1$ 且 $a=2\\beta$。\n该积分为 $\\int_{-\\infty}^{\\infty} x^{2} \\exp(-2 \\beta x^{2}) \\, \\mathrm{d} x = \\frac{1}{2(2\\beta)} \\sqrt{\\frac{\\pi}{2\\beta}} = \\frac{1}{4\\beta} \\sqrt{\\frac{\\pi}{2\\beta}}$。\n将此结果代回 $\\langle V \\rangle$ 的表达式中：\n$$\n\\langle V \\rangle = \\frac{1}{2} m \\omega^{2} \\left(\\frac{2 \\beta}{\\pi}\\right)^{1/2} \\left( \\frac{1}{4\\beta} \\sqrt{\\frac{\\pi}{2\\beta}} \\right) = \\frac{m \\omega^{2}}{8\\beta} \\left(\\frac{2 \\beta}{\\pi}\\right)^{1/2} \\left(\\frac{\\pi}{2\\beta}\\right)^{1/2} = \\frac{m \\omega^{2}}{8\\beta}\n$$\n接下来，我们计算动能的期望值 $\\langle T \\rangle$。更直接的方法是先计算 $\\langle \\hat{p}^2 \\rangle$，然后除以 $2m$。对于实波函数 $\\psi$，使用分部积分法，$\\hat{p}^2 = -\\hbar^2 \\frac{\\mathrm{d}^2}{\\mathrm{d}x^2}$ 的期望值由 $\\langle \\hat{p}^2 \\rangle = \\hbar^2 \\int_{-\\infty}^{\\infty} \\left(\\frac{\\mathrm{d}\\psi}{\\mathrm{d}x}\\right)^2 \\mathrm{d}x$ 给出。\n我们的试探函数的导数是：\n$$\n\\frac{\\mathrm{d}\\psi_{\\beta}}{\\mathrm{d}x} = \\left(\\frac{2 \\beta}{\\pi}\\right)^{1/4} (-2 \\beta x) \\exp(-\\beta x^{2})\n$$\n将其平方得到：\n$$\n\\left(\\frac{\\mathrm{d}\\psi_{\\beta}}{\\mathrm{d}x}\\right)^{2} = \\left(\\frac{2 \\beta}{\\pi}\\right)^{1/2} (4 \\beta^{2} x^{2}) \\exp(-2 \\beta x^{2})\n$$\n所以，$\\hat{p}^2$ 的期望值变为：\n$$\n\\langle \\hat{p}^2 \\rangle = \\hbar^{2} \\left(\\frac{2 \\beta}{\\pi}\\right)^{1/2} (4 \\beta^{2}) \\int_{-\\infty}^{\\infty} x^{2} \\exp(-2 \\beta x^{2}) \\, \\mathrm{d} x\n$$\n使用与之前相同的积分结果：\n$$\n\\langle \\hat{p}^2 \\rangle = \\hbar^{2} \\left(\\frac{2 \\beta}{\\pi}\\right)^{1/2} (4 \\beta^{2}) \\left( \\frac{1}{4\\beta} \\sqrt{\\frac{\\pi}{2\\beta}} \\right) = \\hbar^{2} \\beta\n$$\n因此，动能的期望值为：\n$$\n\\langle T \\rangle = \\frac{\\langle \\hat{p}^2 \\rangle}{2m} = \\frac{\\hbar^{2} \\beta}{2m}\n$$\n结合动能和势能的期望值，我们得到能量泛函 $E(\\beta)$：\n$$\nE(\\beta) = \\frac{\\hbar^{2} \\beta}{2m} + \\frac{m \\omega^{2}}{8\\beta}\n$$\n为找到使该能量最小化的 $\\beta$ 值，我们必须对 $E(\\beta)$ 关于 $\\beta$ 求导，并令结果为零：\n$$\n\\frac{\\mathrm{d}E}{\\mathrm{d}\\beta} = \\frac{\\hbar^{2}}{2m} - \\frac{m \\omega^{2}}{8\\beta^{2}} = 0\n$$\n求解 $\\beta$，我们将其记为 $\\beta_{\\mathrm{min}}$：\n$$\n\\frac{\\hbar^{2}}{2m} = \\frac{m \\omega^{2}}{8\\beta_{\\mathrm{min}}^{2}} \\quad \\implies \\quad \\beta_{\\mathrm{min}}^{2} = \\frac{m^{2} \\omega^{2}}{4 \\hbar^{2}}\n$$\n由于要求 $\\beta > 0$，我们取正平方根：\n$$\n\\beta_{\\mathrm{min}} = \\frac{m \\omega}{2 \\hbar}\n$$\n将这个最优的 $\\beta$ 值代回 $E(\\beta)$，得到最小变分能量 $E_{\\mathrm{var}}^{\\mathrm{min}}$：\n$$\nE_{\\mathrm{var}}^{\\mathrm{min}} = E(\\beta_{\\mathrm{min}}) = \\frac{\\hbar^{2}}{2m} \\left(\\frac{m \\omega}{2 \\hbar}\\right) + \\frac{m \\omega^{2}}{8} \\left(\\frac{2 \\hbar}{m \\omega}\\right) = \\frac{\\hbar \\omega}{4} + \\frac{\\hbar \\omega}{4} = \\frac{1}{2} \\hbar \\omega\n$$\n这就是基态能量的变分估计值。\n\n第二部分：算符法精确解\n\n我们定义湮灭算符 $\\hat{a}$ 和产生算符 $\\hat{a}^{\\dagger}$：\n$$\n\\hat{a} = \\sqrt{\\frac{m\\omega}{2\\hbar}} \\left(\\hat{x} + \\frac{i}{m\\omega} \\hat{p}\\right) \\quad, \\quad \\hat{a}^{\\dagger} = \\sqrt{\\frac{m\\omega}{2\\hbar}} \\left(\\hat{x} - \\frac{i}{m\\omega} \\hat{p}\\right)\n$$\n这些算符满足正则对易关系 $[\\hat{a}, \\hat{a}^{\\dagger}] = 1$。哈密顿算符可以用这些算符来表示。反演这些关系以表示 $\\hat{x}$ 和 $\\hat{p}$：\n$$\n\\hat{x} = \\sqrt{\\frac{\\hbar}{2m\\omega}} (\\hat{a} + \\hat{a}^{\\dagger}) \\quad, \\quad \\hat{p} = i \\sqrt{\\frac{\\hbar m \\omega}{2}} (\\hat{a}^{\\dagger} - \\hat{a})\n$$\n将这些代入哈密顿算符 $\\hat{H} = \\frac{\\hat{p}^{2}}{2 m} + \\frac{1}{2} m \\omega^{2} \\hat{x}^{2}$：\n$$\n\\hat{H} = \\frac{1}{2m} \\left(i \\sqrt{\\frac{\\hbar m \\omega}{2}} (\\hat{a}^{\\dagger} - \\hat{a})\\right)^{2} + \\frac{1}{2} m \\omega^{2} \\left(\\sqrt{\\frac{\\hbar}{2m\\omega}} (\\hat{a} + \\hat{a}^{\\dagger})\\right)^{2}\n$$\n$$\n\\hat{H} = \\frac{-\\hbar m \\omega}{4m} (\\hat{a}^{\\dagger} - \\hat{a})^{2} + \\frac{m \\omega^{2} \\hbar}{4m\\omega} (\\hat{a} + \\hat{a}^{\\dagger})^{2}\n$$\n$$\n\\hat{H} = \\frac{\\hbar \\omega}{4} \\left[-(\\hat{a}^{\\dagger 2} - \\hat{a}^{\\dagger}\\hat{a} - \\hat{a}\\hat{a}^{\\dagger} + \\hat{a}^{2}) + (\\hat{a}^{2} + \\hat{a}\\hat{a}^{\\dagger} + \\hat{a}^{\\dagger}\\hat{a} + \\hat{a}^{\\dagger 2})\\right]\n$$\n$$\n\\hat{H} = \\frac{\\hbar \\omega}{4} \\left[2\\hat{a}\\hat{a}^{\\dagger} + 2\\hat{a}^{\\dagger}\\hat{a}\\right] = \\frac{\\hbar \\omega}{2} (\\hat{a}\\hat{a}^{\\dagger} + \\hat{a}^{\\dagger}\\hat{a})\n$$\n使用对易关系 $\\hat{a}\\hat{a}^{\\dagger} = \\hat{a}^{\\dagger}\\hat{a} + 1$，我们化简哈密顿算符：\n$$\n\\hat{H} = \\frac{\\hbar\\omega}{2} ((\\hat{a}^{\\dagger}\\hat{a} + 1) + \\hat{a}^{\\dagger}\\hat{a}) = \\frac{\\hbar\\omega}{2} (2\\hat{a}^{\\dagger}\\hat{a} + 1) = \\hbar\\omega \\left(\\hat{a}^{\\dagger}\\hat{a} + \\frac{1}{2}\\right)\n$$\n算符 $\\hat{N} = \\hat{a}^{\\dagger}\\hat{a}$ 是数算符，其本征值为非负整数 $n = 0, 1, 2, \\dots$。因此，能量本征值为 $E_{n} = \\hbar\\omega(n + \\frac{1}{2})$。精确的基态能量 $E_{0}^{\\mathrm{exact}}$ 对应于 $n=0$：\n$$\nE_{0}^{\\mathrm{exact}} = \\hbar\\omega \\left(0 + \\frac{1}{2}\\right) = \\frac{1}{2} \\hbar \\omega\n$$\n第三部分：能量比较\n\n题目要求我们计算比值 $R = \\frac{E_{\\mathrm{var}}^{\\mathrm{min}}}{E_{0}^{\\mathrm{exact}}}$。\n$$\nR = \\frac{\\frac{1}{2} \\hbar \\omega}{\\frac{1}{2} \\hbar \\omega} = 1\n$$\n这个结果并非巧合。变分原理保证 $E_{\\mathrm{var}}^{\\mathrm{min}} \\geq E_{0}^{\\mathrm{exact}}$。等号成立的充分必要条件是试探波函数与真实的基态本征函数完全相同。谐振子的基态本征函数确实是 $\\exp(-ax^2)$ 形式的高斯函数。我们选择的试探函数族 $\\psi_{\\beta}(x)$ 中包含了精确的基态本征函数，而关于 $\\beta$ 的最小化过程通过找到 $\\beta_{\\mathrm{min}} = \\frac{m\\omega}{2\\hbar}$ 成功地确定了它。这使得变分法得出了精确的基态能量。", "answer": "$$\\boxed{1}$$"}, {"introduction": "对于大多数真实化学体系，其势能函数复杂，无法获得薛定谔方程的解析解，此时数值方法便显得至关重要。本练习将指导你从头开始，使用有限差分法将一维双势阱中的微分哈密顿算符离散化为一个矩阵。通过编程实现这一过程并求解其本征值与本征函数，你将掌握连接理论与计算的桥梁，为解决更复杂的量子化学问题打下坚实的计算基础。[@problem_id:2769903]", "id": "2769903", "problem": "实现一个完整的程序，该程序使用二阶中心有限差分法对二阶导数进行离散化，为一个在有限区间上的双阱势中、质量为 $m$ 的粒子构建一维哈密顿算符。哈密顿算符由不含时 Schrödinger 方程 (Time-Independent Schrödinger Equation, TISE) $ \\hat{H} \\psi(x) = E \\psi(x)$ 定义，其中 $ \\hat{H} = -\\dfrac{\\hbar^2}{2m}\\dfrac{d^2}{dx^2} + V(x)$。势函数为一个带有可选线性倾斜项的四次双阱势，$ V(x) = a \\left(x^2 - b^2\\right)^2 + c\\,x$。在区间边界处使用 Dirichlet 边界条件。在原子单位制下进行计算，因此 $ \\hbar = 1 $ 且 $ m = 1$，能量单位为 Hartree，长度单位为 bohr。\n\n从第一性原理出发，请遵循以下步骤，除了基本定义外，不使用任何预封装的黑箱公式：\n- 从动能算符的定义出发，在均匀网格上对二阶导数应用二阶中心有限差分近似，以获得一个对称三对角动能矩阵。\n- 通过加上对角势能矩阵来构建哈密顿矩阵。\n- 通过只表示两个边界之间的内部网格点来施加 Dirichlet 边界条件。\n- 计算哈密顿矩阵的两个最低本征值及其对应的本征向量。\n- 在计算期望值之前，将在连续内积的离散近似下将每个本征向量归一化，即确保 $ \\sum_i |\\psi_i|^2 \\,\\Delta x = 1$。\n- 对于两个最低的本征态，分别使用其在网格上的离散 Riemann 和近似来计算期望值 $ \\langle x \\rangle = \\int \\psi^*(x)\\,x\\,\\psi(x)\\,dx $ 和 $ \\langle x^2 \\rangle = \\int \\psi^*(x)\\,x^2\\,\\psi(x)\\,dx $。\n\n网格规格与离散化：\n- 在区间 $[-L, L]$ 上使用一个包含 $N$ 个内部点的均匀网格，点间距为 $ \\Delta x = \\dfrac{2L}{N+1}$。内部点的坐标为 $ x_i = -L + (i+1)\\,\\Delta x $，其中 $ i = 0,1,\\dots,N-1$。\n- 作用在离散向量 $ \\psi$ 上的二阶导数在内部点 $i$ 处近似为 $ \\dfrac{\\psi_{i+1} - 2 \\psi_i + \\psi_{i-1}}{\\Delta x^2}$。这使得动能矩阵的主对角线元素为 $ 2\\,\\dfrac{\\hbar^2}{2m\\,\\Delta x^2}$，次对角线元素为 $ -\\dfrac{\\hbar^2}{2m\\,\\Delta x^2}$。\n- 势能以一个对角矩阵的形式包含进来，其元素为 $ V(x_i)$。\n\n您必须实现以上内容，然后评估以下测试套件。所有计算均在原子单位制下进行，其中 $ \\hbar = 1$ 且 $ m = 1$。对于每个测试用例，请报告按能量递增排序的两个最低本征态的以下信息：两个最低本征值 $E_0$ 和 $E_1$，每个态的期望值 $ \\langle x \\rangle$，以及每个态的期望值 $ \\langle x^2 \\rangle$。将报告的每个浮点数四舍五入到恰好 $8$ 位小数。能量以 Hartree 表示，$x$ 和 $x^2$ 的期望值分别以 bohr 和 bohr$^2$ 表示。\n\n测试套件（每个用例为 $ (N, L, a, b, c)$）:\n- 用例 1：$ (400, 6.0, 0.5, 1.5, 0.0)$\n- 用例 2：$ (600, 8.0, 1.0, 2.0, 0.0)$\n- 用例 3：$ (500, 6.0, 0.5, 1.5, 0.05)$\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含所有用例的结果，形式为一个用方括号括起来的、以逗号分隔的列表。每个测试用例必须贡献一个包含恰好六个浮点数的子列表，顺序为 $[E_0, E_1, \\langle x \\rangle_0, \\langle x \\rangle_1, \\langle x^2 \\rangle_0, \\langle x^2 \\rangle_1]$，因此最终输出是一个包含三个子列表的单一顶层列表，不含多余的空白字符，例如 $[[\\dots],[\\dots],[\\dots]]$。", "solution": "问题陈述具有科学依据、提法得当且客观。它呈现的是计算量子化学中的一个标准练习，没有矛盾或含糊之处。我将开始提供解答。\n\n任务是求解一维不含时 Schrödinger 方程 (TISE)，该方程描述一个质量为 $m$ 的粒子在双阱势中的行为。TISE 由下式给出：\n$$\n\\hat{H} \\psi(x) = E \\psi(x)\n$$\n其中哈密顿算符 $\\hat{H}$ 是动能算符 $\\hat{T}$ 和势能算符 $\\hat{V}$ 的和。具体来说，$\\hat{H} = -\\dfrac{\\hbar^2}{2m}\\dfrac{d^2}{dx^2} + V(x)$，势函数为 $V(x) = a \\left(x^2 - b^2\\right)^2 + c\\,x$。该问题需要使用有限差分法在均匀网格上进行数值求解。我们必须在原子单位制下进行计算，其中约化普朗克常数 $\\hbar = 1$，粒子质量 $m = 1$。\n\n求解方法分为几个不同的步骤。\n\n首先，我们离散化空间域。粒子被限制在区间 $[-L, L]$ 内。我们建立一个包含 $N$ 个内部点的均匀网格。包含两个边界点，网格点总数为 $N+2$。相邻点之间的间距，即网格步长 $\\Delta x$，由 $\\Delta x = \\dfrac{L - (-L)}{N+1} = \\dfrac{2L}{N+1}$ 给出。用于计算波函数的内部网格点的坐标为 $x_i = -L + (i+1)\\Delta x$，其中索引 $i$ 的范围是从 $0$ 到 $N-1$。因此，连续波函数 $\\psi(x)$ 由一个离散向量 $\\vec{\\psi}$ 表示，其分量是波函数在这些内部点的值，即 $\\psi_i = \\psi(x_i)$。\n\n问题指定了 Dirichlet 边界条件，这要求波函数在区间边界处为零：$\\psi(-L) = 0$ 和 $\\psi(L) = 0$。在我们的离散表示法中，这对应于设置 $\\psi_{-1} = 0$ 和 $\\psi_N = 0$，其中这些索引指的是与我们内部点集相邻的边界点。\n\n接下来，我们构建哈密顿算符的矩阵表示。我们从动能算符 $\\hat{T} = -\\dfrac{\\hbar^2}{2m}\\dfrac{d^2}{dx^2}$ 开始。二阶导数使用二阶中心差分公式进行近似：\n$$\n\\dfrac{d^2\\psi}{dx^2}\\bigg|_{x=x_i} \\approx \\dfrac{\\psi(x_i - \\Delta x) - 2\\psi(x_i) + \\psi(x_i + \\Delta x)}{\\Delta x^2} = \\dfrac{\\psi_{i-1} - 2\\psi_i + \\psi_{i+1}}{\\Delta x^2}\n$$\n因此，动能算符作用在网格点 $x_i$ 处的波函数上近似为：\n$$\n(\\hat{T}\\psi)_i = -\\dfrac{\\hbar^2}{2m} \\left( \\dfrac{\\psi_{i-1} - 2\\psi_i + \\psi_{i+1}}{\\Delta x^2} \\right)\n$$\n这个表达式将微分算符 $\\hat{T}$ 转换为一个 $N \\times N$ 矩阵 $\\mathbf{T}$。通过检查 $(\\hat{T}\\psi)_i$ 表达式中 $\\psi_j$ 的系数，我们可以确定矩阵元素 $T_{ij}$。对于一个普通的内部点，离散化的动能算符将点 $\\psi_i$ 与其近邻点 $\\psi_{i-1}$ 和 $\\psi_{i+1}$ 耦合起来。当我们引入 Dirichlet 边界条件（$\\psi_{-1}=0, \\psi_{N}=0$）时，得到的矩阵 $\\mathbf{T}$ 成为一个对称三对角矩阵。在原子单位制中（$\\hbar=1, m=1$），其非零元素为：\n$$\nT_{ij} = \\begin{cases}\n\\dfrac{1}{\\Delta x^2} & \\text{若 } i=j \\\\\n-\\dfrac{1}{2\\Delta x^2} & \\text{若 } |i-j|=1 \\\\\n0 & \\text{其他情况}\n\\end{cases}\n$$\n势能算符 $\\hat{V} = V(x)$ 是一个局域算符，意味着它在 $x_i$ 处的作​​用仅取决于 $\\psi(x_i)$。在离散基下，该算符成为一个对角矩阵 $\\mathbf{V}$，其元素为 $V_{ij} = V(x_i) \\delta_{ij}$，其中 $\\delta_{ij}$ 是 Kronecker delta。\n\n完整的哈密顿矩阵 $\\mathbf{H}$ 是动能矩阵和势能矩阵的和：$\\mathbf{H} = \\mathbf{T} + \\mathbf{V}$。TISE 因此被转化为一个标准的矩阵本征值问题：\n$$\n\\mathbf{H}\\vec{\\psi} = E\\vec{\\psi}\n$$\n矩阵 $\\mathbf{H}$ 的本征值 $E$ 代表了系统的量子化能级，相应的本征向量 $\\vec{\\psi}$ 是定态波函数的离散表示。由于 $\\mathbf{H}$ 是一个实对称矩阵，其本征值保证为实数，其本征向量保证相互正交。我们将采用一个为对称矩阵优化的数值线性代数程序来计算两个最低的本征值 $E_0$ 和 $E_1$ 及其相关的本征向量 $\\vec{\\phi}_0$ 和 $\\vec{\\phi}_1$。\n\n标准数值库返回的本征向量通常根据欧几里得向量范数进行归一化，即 $\\sum_i |\\phi_i|^2 = 1$。量子力学波函数的物理归一化条件要求在空间中某处找到粒子的总概率为 1：$\\int |\\psi(x)|^2 dx = 1$。该积分的离散表示是一个 Riemann 和：\n$$\n\\int_{-\\infty}^{\\infty} |\\psi(x)|^2 dx \\approx \\sum_{i=0}^{N-1} |\\psi(x_i)|^2 \\Delta x = 1\n$$\n为了将库归一化的本征向量 $\\vec{\\phi}$ 转换为物理归一化的本征向量 $\\vec{\\psi}$，我们必须找到一个缩放常数 $C$ 使得 $\\vec{\\psi} = C\\vec{\\phi}$。将此代入物理归一化条件可得：\n$$\n\\sum_{i=0}^{N-1} |C\\phi_i|^2 \\Delta x = |C|^2 \\Delta x \\sum_{i=0}^{N-1} |\\phi_i|^2 = |C|^2 \\Delta x \\cdot 1 = 1\n$$\n由此，我们得到 $|C|^2 = 1/\\Delta x$。我们选择实数正根，$C = 1/\\sqrt{\\Delta x}$。因此，对于每个态 $k$，物理归一化的本征向量为 $\\vec{\\psi}_k = \\vec{\\phi}_k / \\sqrt{\\Delta x}$。\n\n最后，我们计算两个最低能量态（$k=0, 1$）的位置期望值 $\\langle x \\rangle$ 和位置平方期望值 $\\langle x^2 \\rangle$。算符 $\\hat{A}$ 的期望值定义为 $\\langle \\hat{A} \\rangle = \\int \\psi^*(x) \\hat{A} \\psi(x) dx$。对于像 $x$ 和 $x^2$ 这样的局域乘法算符，离散近似同样是一个 Riemann 和：\n$$\n\\langle x \\rangle_k = \\sum_{i=0}^{N-1} \\psi_{k,i}^* x_i \\psi_{k,i} \\Delta x = \\sum_{i=0}^{N-1} |\\psi_{k,i}|^2 x_i \\Delta x\n$$\n$$\n\\langle x^2 \\rangle_k = \\sum_{i=0}^{N-1} \\psi_{k,i}^* x_i^2 \\psi_{k,i} \\Delta x = \\sum_{i=0}^{N-1} |\\psi_{k,i}|^2 x_i^2 \\Delta x\n$$\n由于哈密顿矩阵是实数，其本征向量可以选择为实数，因此 $\\psi_{k,i}^* = \\psi_{k,i}$。该实现将为每个测试用例系统地执行这些步骤。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import eigh\n\ndef calculate_observables(N, L, a, b, c):\n    \"\"\"\n    Constructs the Hamiltonian and computes eigenvalues and expectation values\n    for a single set of parameters.\n    \"\"\"\n    # Use floating point numbers for all parameters to ensure float arithmetic\n    N, L, a, b, c = int(N), float(L), float(a), float(b), float(c)\n    \n    # Set physical constants to 1 (atomic units)\n    hbar = 1.0\n    m = 1.0\n\n    # Step 1: Define the one-dimensional grid\n    # Grid spacing for N interior points on [-L, L]\n    dx = 2.0 * L / (N + 1)\n    # Coordinates of the N interior points\n    x = np.linspace(-L + dx, L - dx, N)\n\n    # Step 2: Construct the kinetic energy matrix T\n    # The matrix is tridiagonal\n    # Main diagonal elements\n    diag_val = hbar**2 / (m * dx**2)\n    # Off-diagonal elements\n    off_diag_val = -hbar**2 / (2 * m * dx**2)\n    \n    T = np.diag(np.full(N, diag_val)) + \\\n        np.diag(np.full(N - 1, off_diag_val), k=1) + \\\n        np.diag(np.full(N - 1, off_diag_val), k=-1)\n    \n    # Step 3: Construct the potential energy matrix V\n    # Potential function V(x) = a*(x^2 - b^2)^2 + c*x\n    potential_values = a * (x**2 - b**2)**2 + c * x\n    V = np.diag(potential_values)\n\n    # Step 4: Form the Hamiltonian matrix H\n    H = T + V\n\n    # Step 5: Solve the eigenvalue problem for the 2 lowest states\n    # eigh is used for symmetric/Hermitian matrices and is efficient.\n    # It returns eigenvalues in ascending order.\n    # We request the first two (indices 0 and 1).\n    eigenvalues, eigenvectors = eigh(H, subset_by_index=[0, 1])\n    \n    E0, E1 = eigenvalues\n    \n    # The eigenvectors are columns of the returned matrix\n    phi0_unnormalized = eigenvectors[:, 0]\n    phi1_unnormalized = eigenvectors[:, 1]\n\n    # Step 6: Normalize eigenvectors to the physical inner product\n    # The library normalizes to sum(|psi|^2) = 1.\n    # We need sum(|psi|^2 * dx) = 1.\n    # The normalization constant is 1/sqrt(dx).\n    norm_const = 1.0 / np.sqrt(dx)\n    psi0 = phi0_unnormalized * norm_const\n    psi1 = phi1_unnormalized * norm_const\n    \n    # Step 7: Compute expectation values\n    # The wavefunctions are real, so psi* is just psi.\n    psi0_sq = psi0**2\n    psi1_sq = psi1**2\n\n    # For the ground state (k=0)\n    exp_x_0 = np.sum(psi0_sq * x * dx)\n    exp_x2_0 = np.sum(psi0_sq * x**2 * dx)\n\n    # For the first excited state (k=1)\n    exp_x_1 = np.sum(psi1_sq * x * dx)\n    exp_x2_1 = np.sum(psi1_sq * x**2 * dx)\n    \n    # The problem requires rounding to 8 decimal places\n    results = [E0, E1, exp_x_0, exp_x_1, exp_x2_0, exp_x2_1]\n    rounded_results = [round(val, 8) for val in results]\n    \n    return rounded_results\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (N, L, a, b, c)\n        (400, 6.0, 0.5, 1.5, 0.0),\n        (600, 8.0, 1.0, 2.0, 0.0),\n        (500, 6.0, 0.5, 1.5, 0.05)\n    ]\n\n    all_results = []\n    for case in test_cases:\n        result = calculate_observables(*case)\n        all_results.append(result)\n\n    # Final print statement in the exact required format: [[...],[...],[...]]\n    # This construction ensures no extra whitespace is included.\n    case_strings = []\n    for res_list in all_results:\n        # Convert each list of floats to a string like \"[f1,f2,...]\"\n        res_str = \"[\" + \",\".join(map(str, res_list)) + \"]\"\n        case_strings.append(res_str)\n    \n    # Join the individual case strings into the final format\n    final_output = \"[\" + \",\".join(case_strings) + \"]\"\n    print(final_output)\n\nsolve()\n```"}]}