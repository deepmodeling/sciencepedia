{"hands_on_practices": [{"introduction": "本节的第一个练习将线性变分法分解为其最基本的核心，通过研究最简单的非平凡情况：一个由非正交基函数描述的双能级系统。通过解析求解此问题，您将从第一性原理的层面，深刻理解交叠矩阵 $\\mathbf{S}$ 如何修正标准本征值问题，并引出广义久期方程。这个练习对于掌握该方法的数学结构以及基组交叠的物理含义至关重要。[@problem_id:2902363]", "problem": "在求解不含时电子薛定谔方程的线性变分法中，我们需要对张成一个有限非正交基 $\\{\\chi_{1},\\chi_{2}\\}$ 的非零系数矢量 $\\mathbf{c}$，最小化瑞利商 $E[\\mathbf{c}]=\\dfrac{\\mathbf{c}^{\\mathsf{T}}\\,\\mathbf{H}\\,\\mathbf{c}}{\\mathbf{c}^{\\mathsf{T}}\\,\\mathbf{S}\\,\\mathbf{c}}$。考虑一个 $2\\times 2$ 的哈密顿矩阵 $\\mathbf{H}=\\begin{pmatrix} h_{11} & h_{12} \\\\ h_{12} & h_{22}\\end{pmatrix}$ 和一个对称重叠矩阵 $\\mathbf{S}=\\begin{pmatrix} 1 & s \\\\ s & 1 \\end{pmatrix}$，其中 $|s|<1$ 以确保 $\\mathbf{S}$ 是正定的。假设 $h_{11},h_{22},h_{12}\\in\\mathbb{R}$，且 $\\mathbf{H}$ 是对称的。\n\n从瑞利-里兹变分原理出发（不进行预先正交化），推导确定广义本征值的定态条件和相关的久期方程。解析地求解两个广义本征值，将其表示为 $h_{11}$、$h_{22}$、$h_{12}$ 和 $s$ 的函数。接着分析 $s\\to 0$ 和 $s\\to 1^{-}$ 的极限情况，解释每种情况下在物理上和数学上发生了什么，并提取当 $s\\to 1^{-}$ 时保持有限的那个本征值的有限极限（如果它在一般情况下存在）。\n\n将你的最终答案以一个单行矩阵的形式给出，按顺序包含：\n- 较大根分支 $E_{+}(s)$，\n- 较小根分支 $E_{-}(s)$，\n- 极限 $\\lim_{s\\to 0}E_{+}(s)$ 和 $\\lim_{s\\to 0}E_{-}(s)$，\n- 以及有限极限 $\\lim_{s\\to 1^{-}}E_{\\mathrm{finite}}(s)$。\n\n无需进行数值计算；请给出精确的闭式表达式。不需要单位。最终答案中不要包含任何额外的评注。", "solution": "出发点是瑞利-里兹变分原理，该原理指出，在有限基中，近似的定态能量是瑞利商 $E[\\mathbf{c}]=\\dfrac{\\mathbf{c}^{\\mathsf{T}}\\,\\mathbf{H}\\,\\mathbf{c}}{\\mathbf{c}^{\\mathsf{T}}\\,\\mathbf{S}\\,\\mathbf{c}}$ 在系数矢量 $\\mathbf{c}\\neq \\mathbf{0}$ 变分下的平稳值。对 $\\delta \\mathbf{c}$ 取平稳条件，在约束条件 $\\mathbf{c}^{\\mathsf{T}}\\mathbf{S}\\mathbf{c}=1$ 下（或等价地，通过引入一个拉格朗日乘子），可得到广义本征值方程\n$$\n\\mathbf{H}\\,\\mathbf{c}=E\\,\\mathbf{S}\\,\\mathbf{c}.\n$$\n只有当系数矩阵的行列式为零时，才存在非平庸的系数 $\\mathbf{c}$，这导出了久期方程\n$$\n\\det(\\mathbf{H}-E\\,\\mathbf{S})=0.\n$$\n对于给定的 $2\\times 2$ 矩阵\n$$\n\\mathbf{H}-E\\,\\mathbf{S}=\\begin{pmatrix}\nh_{11}-E  h_{12}-E s \\\\\nh_{12}-E s  h_{22}-E\n\\end{pmatrix}.\n$$\n其行列式为\n$$\n\\det(\\mathbf{H}-E\\,\\mathbf{S})=(h_{11}-E)(h_{22}-E)-(h_{12}-E s)^{2}=0.\n$$\n展开并合并 $E$ 的各次幂，得到一个二次方程\n$$\n(1-s^{2})\\,E^{2}+\\bigl(2 s\\,h_{12}-(h_{11}+h_{22})\\bigr)\\,E+\\bigl(h_{11}\\,h_{22}-h_{12}^{2}\\bigr)=0.\n$$\n定义系数\n$$\na=1-s^{2},\\qquad b=2 s\\,h_{12}-(h_{11}+h_{22}),\\qquad c=h_{11}\\,h_{22}-h_{12}^{2}.\n$$\n因为 $|s|1$，我们有 $a0$。广义本征值便由二次方程求根公式给出\n$$\nE_{\\pm}(s)=\\frac{-b\\pm\\sqrt{b^{2}-4 a c}}{2 a}.\n$$\n将 $a,b,c$ 显式代入可得\n$$\nE_{\\pm}(s)=\\frac{(h_{11}+h_{22}-2 s\\,h_{12})\\pm\\sqrt{\\bigl(h_{11}+h_{22}-2 s\\,h_{12}\\bigr)^{2}-4(1-s^{2})\\bigl(h_{11}\\,h_{22}-h_{12}^{2}\\bigr)}}{2(1-s^{2})}.\n$$\n这就给出了两个广义本征值的精确解析表达式。因为当 $|s|1$ 时，$\\mathbf{H}$ 是对称的，且 $\\mathbf{S}$ 是对称正定的，所以这些广义本征值是实数。\n\n现在分析极限情况：\n\n1) $s\\to 0$ 的极限。在这种情况下，$\\mathbf{S}\\to \\mathbf{I}$，基矢成为标准正交的。将 $s=0$ 直接代入二次方程求根公式可得\n$$\nE_{\\pm}(0)=\\frac{(h_{11}+h_{22})\\pm\\sqrt{(h_{11}-h_{22})^{2}+4 h_{12}^{2}}}{2},\n$$\n这正是对称 $2\\times 2$ 矩阵 $\\mathbf{H}$ 在标准正交基下的常规本征值。\n\n2) $s\\to 1^{-}$ 的极限。当 $s\\to 1^{-}$ 时，重叠矩阵 $\\mathbf{S}$ 的一个本征值趋于零，这反映了两个基矢变得线性相关。久期方程的系数表现为 $a=1-s^{2}\\to 0^{+}$，$b\\to 2 h_{12}-(h_{11}+h_{22})$，而 $c$ 保持不变。可以预见，一个根的量值会发散，而另一个根可以保持有限。这可以从二次方程的韦达定理看出：\n$$\nE_{+}(s)+E_{-}(s)=\\frac{h_{11}+h_{22}-2 s\\,h_{12}}{1-s^{2}},\\qquad E_{+}(s)\\,E_{-}(s)=\\frac{h_{11}\\,h_{22}-h_{12}^{2}}{1-s^{2}}.\n$$\n如果用 $E_{\\mathrm{fin}}(s)$ 表示当 $s\\to 1^{-}$ 时保持有限的那个分支，那么\n$$\nE_{\\mathrm{fin}}(s)=\\frac{E_{+}(s)\\,E_{-}(s)}{E_{+}(s)+E_{-}(s)}=\\frac{h_{11}\\,h_{22}-h_{12}^{2}}{h_{11}+h_{22}-2 s\\,h_{12}}.\n$$\n取 $s\\to 1^{-}$ 的极限，得到有限极限\n$$\n\\lim_{s\\to 1^{-}}E_{\\mathrm{fin}}(s)=\\frac{h_{11}\\,h_{22}-h_{12}^{2}}{h_{11}+h_{22}-2 h_{12}},\n$$\n条件是 $h_{11}+h_{22}-2 h_{12}\\neq 0$（一般情况）。在 $h_{11}+h_{22}-2 h_{12}=0$ 的特殊情况下，有限极限将不存在，除非同时有 $h_{11}\\,h_{22}-h_{12}^{2}=0$，此时问题会进一步简并。另一个根的量值按\n$$\nE_{\\mathrm{div}}(s)\\sim \\frac{h_{11}+h_{22}-2 s\\,h_{12}}{1-s^{2}},\n$$\n发散，这反映了当两个基矢变得线性相关时，变分空间坍缩成一个一维子空间。\n\n汇总所要求的结果，我们以闭式形式给出 $E_{+}(s)$、$E_{-}(s)$、$\\lim_{s\\to 0}E_{+}(s)$、$\\lim_{s\\to 0}E_{-}(s)$ 和 $\\lim_{s\\to 1^{-}}E_{\\mathrm{fin}}(s)$。", "answer": "$$\\boxed{\\begin{pmatrix}\n\\dfrac{(h_{11}+h_{22}-2 s\\,h_{12})+\\sqrt{\\bigl(h_{11}+h_{22}-2 s\\,h_{12}\\bigr)^{2}-4(1-s^{2})\\bigl(h_{11}\\,h_{22}-h_{12}^{2}\\bigr)}}{2(1-s^{2})} \n\\dfrac{(h_{11}+h_{22}-2 s\\,h_{12})-\\sqrt{\\bigl(h_{11}+h_{22}-2 s\\,h_{12}\\bigr)^{2}-4(1-s^{2})\\bigl(h_{11}\\,h_{22}-h_{12}^{2}\\bigr)}}{2(1-s^{2})} \n\\dfrac{(h_{11}+h_{22})+\\sqrt{(h_{11}-h_{22})^{2}+4 h_{12}^{2}}}{2} \n\\dfrac{(h_{11}+h_{22})-\\sqrt{(h_{11}-h_{22})^{2}+4 h_{12}^{2}}}{2} \n\\dfrac{h_{11}\\,h_{22}-h_{12}^{2}}{h_{11}+h_{22}-2 h_{12}}\n\\end{pmatrix}}$$", "id": "2902363"}, {"introduction": "在之前的基础问题之上，本练习引入了强大的对称性概念来简化变分计算。对于任何具有对称性的系统（例如原子或对称分子），基函数可以根据其对称性进行分类。这个练习具体地证明了不同对称性的基函数不会相互作用，从而使得哈密顿矩阵呈现块对角化形式，这极大地简化了久期方程的求解。[@problem_id:2816674]", "problem": "考虑一个约化质量为 $\\mu$ 的单粒子在三维球对称势中运动。为使计算具体化同时保持完全的球对称性，设哈密顿量为各向同性量子谐振子的哈密顿量，$\\hat{H} = -\\frac{\\hbar^{2}}{2\\mu}\\nabla^{2} + \\frac{1}{2}\\mu \\omega^{2} r^{2}$，其中 $r = |\\mathbf{r}|$，$ \\omega$ 为角频率。使用线性变分法（也称为 Rayleigh–Ritz 方法），在由以下两个函数张成的单电子基组中近似求解基态：\n- 一个 $s$ 型高斯函数，$\\chi_{s}(\\mathbf{r};\\alpha) = \\mathcal{N}_{s}(\\alpha)\\,\\exp(-\\alpha r^{2})$，\n- 一个沿 $z$ 轴取向的 $p$ 型高斯函数，$\\chi_{p}(\\mathbf{r};\\beta) = \\mathcal{N}_{p}(\\beta)\\,z\\,\\exp(-\\beta r^{2})$，\n其中 $\\alpha0$ 和 $\\beta0$ 是独立的正常数指数，归一化常数 $\\mathcal{N}_{s}(\\alpha)$ 和 $\\mathcal{N}_{p}(\\beta)$ 的选择需满足 $\\langle \\chi_{s}|\\chi_{s}\\rangle = 1$ 和 $\\langle \\chi_{p}|\\chi_{p}\\rangle = 1$。\n\n从线性变分法的第一性原理和高斯积分的标准性质出发，在不使用任何预先制表的分子积分公式的情况下，完成以下任务：\n- 在此基组下构建重叠矩阵和哈密顿矩阵，并利用对称性确定所有非对角元。\n- 求出 Rayleigh–Ritz 能量 $E_{s}(\\alpha) = \\langle \\chi_{s}|\\hat{H}|\\chi_{s}\\rangle$ 和 $E_{p}(\\beta) = \\langle \\chi_{p}|\\hat{H}|\\chi_{p}\\rangle$ 的解析表达式。\n- 分别对 $\\alpha$ 和 $\\beta$ 最小化 $E_{s}(\\alpha)$ 和 $E_{p}(\\beta)$。\n- 使用线性变分法，确定在 $\\{\\chi_{s},\\chi_{p}\\}$ 基组中的变分基态能量，并定性解释对于球对称哈密顿量，包含 $p$ 型函数为什么会（或不会）改变变分基态能量。\n\n你的最终答案必须是只含 $\\hbar$ 和 $\\omega$ 的单一闭式解析表达式。不需要进行数值计算，也不需要四舍五入。在最终答案框中不要标明单位；不要包含角度或百分比。", "solution": "线性变分法（Rayleigh–Ritz 方法）指出，在有限基组 $\\{\\varphi_{i}\\}$ 中，通过最小化 Rayleigh 商 $E = \\frac{\\mathbf{c}^{\\top}\\mathbf{H}\\mathbf{c}}{\\mathbf{c}^{\\top}\\mathbf{S}\\mathbf{c}}$ 可以得到近似能量，其中 $H_{ij} = \\langle \\varphi_{i}|\\hat{H}|\\varphi_{j}\\rangle$ 且 $S_{ij} = \\langle \\varphi_{i}|\\varphi_{j}\\rangle$。平稳性条件导向广义本征值问题 $\\mathbf{H}\\mathbf{c} = E\\,\\mathbf{S}\\mathbf{c}$。\n\n此处的基组是 $\\{\\chi_{s}(\\mathbf{r};\\alpha), \\chi_{p}(\\mathbf{r};\\beta)\\}$，具有独立的指数 $\\alpha$ 和 $\\beta$。我们首先对每个函数进行归一化，然后计算重叠矩阵元和哈密顿矩阵元。\n\n$s$ 型高斯函数的归一化。定义 $I_{0}(\\alpha) = \\int \\exp(-2\\alpha r^{2})\\,\\mathrm{d}^{3}\\mathbf{r}$。使用标准高斯积分，得 $I_{0}(\\alpha) = \\pi^{3/2}(2\\alpha)^{-3/2}$。归一化条件 $\\mathcal{N}_{s}^{2}(\\alpha)\\,I_{0}(\\alpha) = 1$ 给出\n$$\n\\mathcal{N}_{s}^{2}(\\alpha) = \\left(\\frac{2\\alpha}{\\pi}\\right)^{3/2}, \\quad \\mathcal{N}_{s}(\\alpha) = \\left(\\frac{2\\alpha}{\\pi}\\right)^{3/4}.\n$$\n\n$p$ 型高斯函数的归一化。定义 $J_{0}(\\beta) = \\int z^{2}\\exp(-2\\beta r^{2})\\,\\mathrm{d}^{3}\\mathbf{r}$。根据各向同性，$\\int z^{2}\\exp(-q r^{2})\\,\\mathrm{d}^{3}\\mathbf{r} = \\frac{1}{3}\\int r^{2}\\exp(-q r^{2})\\,\\mathrm{d}^{3}\\mathbf{r}$，并且 $\\int r^{2}\\exp(-q r^{2})\\,\\mathrm{d}^{3}\\mathbf{r} = \\frac{3}{2}\\pi^{3/2}q^{-5/2}$。令 $q=2\\beta$，\n$$\nJ_{0}(\\beta) = \\frac{1}{3}\\cdot \\frac{3}{2}\\pi^{3/2}(2\\beta)^{-5/2} = \\frac{1}{2}\\pi^{3/2}(2\\beta)^{-5/2}.\n$$\n因此 $\\mathcal{N}_{p}^{2}(\\beta)\\,J_{0}(\\beta) = 1$ 意味着\n$$\n\\mathcal{N}_{p}^{2}(\\beta) = \\frac{2(2\\beta)^{5/2}}{\\pi^{3/2}}, \\quad \\mathcal{N}_{p}(\\beta) = \\frac{2^{7/4}\\,\\beta^{5/4}}{\\pi^{3/4}}.\n$$\n\n重叠矩阵。根据构造，对角重叠元为 1，即 $S_{ss} = 1$，$S_{pp} = 1$。非对角重叠元为\n$$\nS_{sp} = \\langle \\chi_{s}|\\chi_{p}\\rangle = \\mathcal{N}_{s}(\\alpha)\\mathcal{N}_{p}(\\beta)\\int z\\,\\exp\\big(-( \\alpha + \\beta) r^{2}\\big)\\,\\mathrm{d}^{3}\\mathbf{r} = 0,\n$$\n因为被积函数在对称域上对于反演 $z \\mapsto -z$ 是奇函数。因此，$\\mathbf{S}$ 是对角矩阵。\n\n哈密顿矩阵的非对角元。对于一个球对称哈密顿量 $\\hat{H} = \\hat{T} + \\hat{V}(r)$，势能算符 $\\hat{V}(r)$ 在空间反演下是偶的，动能算符 $\\hat{T} = -\\frac{\\hbar^{2}}{2\\mu}\\nabla^{2}$ 也是偶的。因此，对于在空间反演下为偶函数的 $\\chi_{s}$ 和为奇函数的 $\\chi_{p}$，矩阵元\n$$\nH_{sp} = \\langle \\chi_{s}|\\hat{H}|\\chi_{p}\\rangle = \\langle \\chi_{s}|\\hat{T}|\\chi_{p}\\rangle + \\langle \\chi_{s}|\\hat{V}(r)|\\chi_{p}\\rangle = 0,\n$$\n因为每个积分的被积函数都具有整体奇宇称，因此积分为零。等价地，根据旋转对称性，$\\hat{H}$ 在总角动量表象中是对角的，而 $s$ 型和 $p$ 型函数携带不同的角动量，因而不会耦合。因此，广义本征值问题解耦为两个独立的一维问题，一个在 $s$ 子空间，另一个在 $p$ 子空间。在 $\\{\\chi_{s},\\chi_{p}\\}$ 基组中的变分基态能量是两个独立最小化的子空间能量中较低的那个。\n\n我们现在计算 $E_{s}(\\alpha)$ 和 $E_{p}(\\beta)$，并分别对它们的指数进行最小化。\n\n$s$ 型函数的期望值。使用分部积分法，对于归一化的实波函数 $\\psi$，动能期望值可以写作 $\\langle \\hat{T}\\rangle = \\frac{\\hbar^{2}}{2\\mu}\\int |\\nabla \\psi|^{2}\\,\\mathrm{d}^{3}\\mathbf{r}$。对于 $\\chi_{s}(\\mathbf{r};\\alpha) = \\mathcal{N}_{s}\\exp(-\\alpha r^{2})$，\n$$\n\\nabla \\chi_{s} = -2\\alpha\\,\\mathcal{N}_{s}\\,\\mathbf{r}\\,\\exp(-\\alpha r^{2}), \\quad |\\nabla \\chi_{s}|^{2} = 4\\alpha^{2}\\mathcal{N}_{s}^{2} r^{2}\\exp(-2\\alpha r^{2}).\n$$\n因此\n$$\n\\langle \\hat{T}\\rangle_{s} = \\frac{\\hbar^{2}}{2\\mu}\\cdot 4\\alpha^{2}\\mathcal{N}_{s}^{2}\\int r^{2}\\exp(-2\\alpha r^{2})\\,\\mathrm{d}^{3}\\mathbf{r}.\n$$\n使用 $\\int r^{2}\\exp(-q r^{2})\\,\\mathrm{d}^{3}\\mathbf{r} = \\frac{3}{2}\\pi^{3/2}q^{-5/2}$，其中 $q=2\\alpha$ 且 $\\mathcal{N}_{s}^{2} = (2\\alpha/\\pi)^{3/2}$，\n$$\n\\langle \\hat{T}\\rangle_{s} = \\frac{\\hbar^{2}}{2\\mu}\\cdot 4\\alpha^{2}\\left(\\frac{2\\alpha}{\\pi}\\right)^{3/2}\\cdot \\frac{3}{2}\\pi^{3/2}(2\\alpha)^{-5/2} = \\frac{3\\hbar^{2}\\alpha}{2\\mu}.\n$$\n势能期望值为\n$$\n\\langle \\hat{V}\\rangle_{s} = \\frac{1}{2}\\mu \\omega^{2}\\int r^{2}|\\chi_{s}|^{2}\\,\\mathrm{d}^{3}\\mathbf{r} = \\frac{1}{2}\\mu \\omega^{2}\\,\\mathcal{N}_{s}^{2}\\int r^{2}\\exp(-2\\alpha r^{2})\\,\\mathrm{d}^{3}\\mathbf{r} = \\frac{3\\mu \\omega^{2}}{8\\alpha}.\n$$\n因此，\n$$\nE_{s}(\\alpha) = \\langle \\hat{H}\\rangle_{s} = \\frac{3\\hbar^{2}\\alpha}{2\\mu} + \\frac{3\\mu \\omega^{2}}{8\\alpha}.\n$$\n通过设置 $\\frac{\\mathrm{d}E_{s}}{\\mathrm{d}\\alpha} = \\frac{3\\hbar^{2}}{2\\mu} - \\frac{3\\mu \\omega^{2}}{8\\alpha^{2}} = 0$ 对 $\\alpha$进行最小化，得到\n$$\n\\alpha_{\\star} = \\frac{\\mu \\omega}{2\\hbar}, \\quad E_{s}^{\\min} = E_{s}(\\alpha_{\\star}) = \\frac{3}{2}\\hbar \\omega.\n$$\n\n$p$ 型函数的期望值。令 $\\phi(\\mathbf{r}) = \\chi_{p}(\\mathbf{r};\\beta) = \\mathcal{N}_{p}\\,z\\,\\exp(-\\beta r^{2})$。计算其梯度\n$$\n\\nabla \\phi = \\mathcal{N}_{p}\\,\\exp(-\\beta r^{2})\\left(\\hat{\\mathbf{z}} - 2\\beta z\\,\\mathbf{r}\\right),\n$$\n于是\n$$\n|\\nabla \\phi|^{2} = \\mathcal{N}_{p}^{2}\\,\\exp(-2\\beta r^{2})\\left(1 + 4\\beta^{2}z^{2}r^{2} - 4\\beta z^{2}\\right).\n$$\n定义高斯积分，其中 $q=2\\beta$：\n$$\nI_{1} = \\int \\exp(-q r^{2})\\,\\mathrm{d}^{3}\\mathbf{r} = \\pi^{3/2}q^{-3/2}, \\quad I_{2} = \\int z^{2}\\exp(-q r^{2})\\,\\mathrm{d}^{3}\\mathbf{r} = \\frac{1}{2}\\pi^{3/2}q^{-5/2},\n$$\n$$\nI_{3} = \\int z^{2}r^{2}\\exp(-q r^{2})\\,\\mathrm{d}^{3}\\mathbf{r} = \\pi^{3/2}\\frac{5}{4}q^{-7/2},\n$$\n其中 $I_3$ 可通过偶数矩分解得到：$\\int z^{2}r^{2} = \\int (z^{4} + z^{2}x^{2} + z^{2}y^{2})$，其中 $\\int z^{4} = \\frac{3}{4}\\pi^{3/2}q^{-7/2}$ 且 $\\int z^{2}x^{2} = \\int z^{2}y^{2} = \\frac{1}{4}\\pi^{3/2}q^{-7/2}$。使用 $\\mathcal{N}_{p}^{2} = \\frac{2(2\\beta)^{5/2}}{\\pi^{3/2}}$，\n$$\n\\int |\\nabla \\phi|^{2}\\,\\mathrm{d}^{3}\\mathbf{r} = \\mathcal{N}_{p}^{2}\\left(I_{1} - 4\\beta I_{2} + 4\\beta^{2} I_{3}\\right) = 4\\beta - 4\\beta + 5\\beta = 5\\beta.\n$$\n因此动能期望值为\n$$\n\\langle \\hat{T}\\rangle_{p} = \\frac{\\hbar^{2}}{2\\mu}\\int |\\nabla \\phi|^{2}\\,\\mathrm{d}^{3}\\mathbf{r} = \\frac{5\\hbar^{2}\\beta}{2\\mu}.\n$$\n势能期望值为\n$$\n\\langle \\hat{V}\\rangle_{p} = \\frac{1}{2}\\mu \\omega^{2}\\int r^{2}|\\phi|^{2}\\,\\mathrm{d}^{3}\\mathbf{r} = \\frac{1}{2}\\mu \\omega^{2}\\,\\mathcal{N}_{p}^{2}\\,I_{3} = \\frac{5\\mu \\omega^{2}}{8\\beta}.\n$$\n因此，\n$$\nE_{p}(\\beta) = \\langle \\hat{H}\\rangle_{p} = \\frac{5\\hbar^{2}\\beta}{2\\mu} + \\frac{5\\mu \\omega^{2}}{8\\beta}.\n$$\n通过 $\\frac{\\mathrm{d}E_{p}}{\\mathrm{d}\\beta} = \\frac{5\\hbar^{2}}{2\\mu} - \\frac{5\\mu \\omega^{2}}{8\\beta^{2}} = 0$ 对 $\\beta$进行最小化，可得\n$$\n\\beta_{\\star} = \\frac{\\mu \\omega}{2\\hbar}, \\quad E_{p}^{\\min} = E_{p}(\\beta_{\\star}) = \\frac{5}{2}\\hbar \\omega.\n$$\n\n$\\{\\chi_{s},\\chi_{p}\\}$ 基组中的变分基态能量。因为 $S_{sp} = 0$ 且 $H_{sp} = 0$，广义本征值问题是块对角的，该基组下的能谱是独立的 $s$ 和 $p$ 子空间能谱的并集。因此，基态能量是独立优化的子空间能量中的最小值：\n$$\nE_{0}^{(\\mathrm{var};\\,\\{\\chi_{s},\\chi_{p}\\})} = \\min\\left\\{E_{s}^{\\min}, E_{p}^{\\min}\\right\\} = \\min\\left\\{\\frac{3}{2}\\hbar \\omega, \\frac{5}{2}\\hbar \\omega\\right\\} = \\frac{3}{2}\\hbar \\omega.\n$$\n\n对于球对称哈密顿量，为何 $p$ 型函数不降低变分基态能量。包含 $\\chi_{p}$ 并未改变基态变分能量，因为 $\\hat{H}$ 与总角动量算符对易，并且在空间反演下是不变的。$s$ 型和 $p$ 型基函数携带不同的角动量量子数且具有相反的宇称，因此它们在哈密顿量 $\\hat{H}$ 的作用下是正交且无相互作用的。线性变分法只能通过混合经由哈密顿量耦合的基函数来降低能量；在此处，耦合因对称性而消失，所以 $p$ 型函数只改善了对激发 $p$ 类态的描述，而使 $s$ 类的基态保持不变。在谐振子的情况下，$s$ 型高斯基函数在最优指数下已经包含了精确的基态，从而得到精确的基态能量 $\\frac{3}{2}\\hbar \\omega$。", "answer": "$$\\boxed{\\frac{3}{2}\\hbar \\omega}$$", "id": "2816674"}, {"introduction": "这个总结性的练习旨在弥合抽象理论与计算实践之间的鸿沟。您将从零开始实现线性变分法，使用一组非正交的多项式基函数来求解著名的一维箱中粒子问题。这项动手编程任务将巩固您对整个工作流程的理解，从构建哈密顿矩阵和交叠矩阵，到求解广义本征值问题，再到评估结果的收敛性。[@problem_id:2816688]", "problem": "考虑区间 $[0,L]$ 上的一维箱中粒子问题，该区间外存在无限势垒，因此波函数满足 Dirichlet 边界条件 $\\psi(0)=\\psi(L)=0$。在箱内，自由粒子的定态薛定谔方程为\n$$\n-\\frac{\\hbar^2}{2m}\\,\\frac{d^2\\psi}{dx^2}=E\\,\\psi \\quad \\text{其中 } x\\in(0,L),\n$$\n其中 $\\psi(0)=\\psi(L)=0$。在无量纲单位下进行计算，设 $\\hbar^2/(2m)=1$，此时能量和长度的测量单位使得精确能谱为\n$$\nE_n^{\\mathrm{exact}}=\\left(\\frac{n\\pi}{L}\\right)^2,\\quad n\\in\\mathbb{N}.\n$$\n使用线性变分法，并采用一个满足边界条件的非正交多项式基。具体来说，对于选定的基大小 $N\\in\\mathbb{N}$，使用基函数\n$$\n\\phi_k(x)=x\\,(L-x)\\left(\\frac{x}{L}\\right)^k,\\quad k=0,1,\\dots,N-1,\n$$\n这些是多项式，它们在 $x=0$ 和 $x=L$ 处为零，并且在 $[0,L]$ 上的标准 $L^2$ 内积下通常是非正交的。定义重叠矩阵 $S\\in\\mathbb{R}^{N\\times N}$ 和哈密顿（动能）矩阵 $H\\in\\mathbb{R}^{N\\times N}$ 如下\n$$\nS_{ij}=\\int_0^L \\phi_i(x)\\,\\phi_j(x)\\,dx,\\qquad H_{ij}=\\int_0^L \\frac{d\\phi_i}{dx}(x)\\,\\frac{d\\phi_j}{dx}(x)\\,dx,\n$$\n这样，广义本征值问题\n$$\nH\\,\\mathbf{c} = E\\,S\\,\\mathbf{c}\n$$\n就能得出精确能量本征值的 Ritz 近似值 $E$。你必须通过多项式代数（即，构造相关的乘積多项式并使用其原函数进行解析积分）来精确计算定义 $H$ 和 $S$ 的积分，而不是通过数值积分，以确保内部一致性和可复现性。\n\n编写一个完整的程序，该程序：\n- 为给定的 $L$ 和 $N$ 构建如上所述的基多项式 $\\phi_k$。\n- 按照规定，通过对多项式进行精确积分来构建矩阵 $H$ 和 $S$。\n- 求解广义对称本征值问题 $H\\,\\mathbf{c}=E\\,S\\,\\mathbf{c}$ 以获得 $N$ 个近似能量值，并按升序排序。\n- 对于指定的比较计数 $M\\in\\mathbb{N}$（其中 $1\\le M\\le N$），计算最低的 $M$ 个近似能量与精确能量 $\\{E_n^{\\mathrm{exact}}\\}_{n=1}^M$ 之间的均方根（RMS）相对误差：\n$$\n\\varepsilon_{\\mathrm{RMS}}=\\sqrt{\\frac{1}{M}\\sum_{n=1}^{M}\\left(\\frac{E_n^{\\mathrm{approx}}-E_n^{\\mathrm{exact}}}{E_n^{\\mathrm{exact}}}\\right)^2}.\n$$\n在所选单位中，所有能量都是无量纲的，因此不需要单位转换。角度不出现。不得使用百分比；均方根相对误差必须以小数形式返回。\n\n测试套件：\n- 情况 1：$L=1.0$, $N=1$, $M=1$。\n- 情况 2：$L=1.0$, $N=3$, $M=3$。\n- 情况 3：$L=\\pi$, $N=5$, $M=4$。\n- 情况 4：$L=2.5$, $N=6$, $M=4$。\n\n程序输出规范：\n- 对于每个测试用例，计算如上定义的 $\\varepsilon_{\\mathrm{RMS}}$。\n- 将每个 $\\varepsilon_{\\mathrm{RMS}}$ 四舍五入到 $8$ 位小数。\n- 你的程序应生成单行输出，其中包含用方括号括起来的逗号分隔的结果列表，顺序与测试用例相同（例如，$[r_1,r_2,r_3,r_4]$）。", "solution": "我们从区间 $[0,L]$ 上一维无限深势阱中自由粒子的定态薛定谔方程开始：\n$$\n-\\frac{\\hbar^2}{2m}\\,\\frac{d^2\\psi}{dx^2}=E\\,\\psi,\\quad \\psi(0)=\\psi(L)=0.\n$$\n采用 $\\hbar^2/(2m)=1$ 的单位制，方程左侧的算符简化为 $-\\frac{d^2}{dx^2}$。精确本征函数为 $\\psi_n(x)=\\sqrt{\\frac{2}{L}}\\sin\\left(\\frac{n\\pi x}{L}\\right)$，精确能量为 $E_n^{\\mathrm{exact}}=\\left(\\frac{n\\pi}{L}\\right)^2$。\n\n线性变分法（Rayleigh–Ritz 方法）通过选取基函数 $\\{\\phi_k\\}_{k=0}^{N-1}$ 的线性组合来构造近似解空间，因此试探波函数为 $\\psi(x)=\\sum_{k=0}^{N-1} c_k\\,\\phi_k(x)$。变分原理指出，Rayleigh 商\n$$\n\\mathcal{R}[\\psi]=\\frac{\\langle \\psi| \\hat{H}|\\psi\\rangle}{\\langle \\psi|\\psi\\rangle}\n$$\n在精确本征态处是驻定的，并且当基函数满足边界条件时，它为精确本征值提供了上界。在此，所采用单位制中的哈密顿算符为 $\\hat{H}=-\\frac{d^2}{dx^2}$，$L^2([0,L])$ 上的内积为 $\\langle f|g\\rangle=\\int_0^L f(x)\\,g(x)\\,dx$。\n\n将薛定谔方程投影到由 $\\{\\phi_k\\}$ 张成的子空间上，得到广义矩阵本征值问题\n$$\n\\sum_{j=0}^{N-1} H_{ij}\\,c_j = E \\sum_{j=0}^{N-1} S_{ij}\\,c_j,\\quad i=0,\\dots,N-1,\n$$\n其中重叠矩阵和哈密顿矩阵的矩阵元为\n$$\nS_{ij}=\\int_0^L \\phi_i(x)\\,\\phi_j(x)\\,dx,\\qquad H_{ij}=\\int_0^L \\phi_i(x)\\left(-\\frac{d^2}{dx^2}\\right)\\phi_j(x)\\,dx.\n$$\n由于基函数被构造成满足 $\\phi_k(0)=\\phi_k(L)=0$，通过分部积分法，哈密顿矩阵可变换为一个没有边界项的对称正定形式：\n$$\nH_{ij}=\\int_0^L \\frac{d\\phi_i}{dx}(x)\\,\\frac{d\\phi_j}{dx}(x)\\,dx.\n$$\n这可从下式推导\n$$\n\\int_0^L \\phi_i(x)\\left(-\\frac{d^2\\phi_j}{dx^2}(x)\\right)\\,dx\n=\\left.-\\phi_i(x)\\frac{d\\phi_j}{dx}(x)\\right|_0^L + \\int_0^L \\frac{d\\phi_i}{dx}(x)\\,\\frac{d\\phi_j}{dx}(x)\\,dx,\n$$\n并且由于 $\\phi_i(0)=\\phi_i(L)=0$，边界项为零。\n\n我们选择一个满足边界条件的非正交多项式基：\n$$\n\\phi_k(x)=x\\,(L-x)\\left(\\frac{x}{L}\\right)^k,\\quad k=0,1,\\dots,N-1.\n$$\n每个 $\\phi_k$ 都是一个关于 $x$ 的多项式乘以 $x(L-x)$，因此它在 $x=0$ 和 $x=L$ 处为零。该基函数集合对于内积 $\\langle \\cdot|\\cdot\\rangle$ 通常是非正交的，因此重叠矩阵 $S$ 不是单位矩阵。\n\n通过多项式代数的算法构造：\n- 使用显式系数将 $\\phi_k(x)$ 表示为关于 $x$ 的多项式。引入多项式 $X(x)=x$ 和边界因子 $B(x)=x(L-x)=-x^2+Lx$。那么\n$$\n\\phi_k(x)=B(x)\\left(\\frac{X(x)}{L}\\right)^k.\n$$\n因此，$\\phi_k$ 可通过多项式乘法和缩放构成。其导数 $\\frac{d\\phi_k}{dx}$ 通过多项式微分获得。\n- 为精确计算 $S_{ij}$ 和 $H_{ij}$，注意到乘积 $\\phi_i(x)\\,\\phi_j(x)$ 和 $\\frac{d\\phi_i}{dx}(x)\\,\\frac{d\\phi_j}{dx}(x)$ 都是多项式。它们在 $[0,L]$ 上的积分可通过求原函数（将幂次加一并除以新的幂次）并在 $x=L$ 和 $x=0$ 处求值来进行解析计算。这避免了数值积分，并能得到 $L$ 及其幂次的精确有理数组合的浮点数表示。\n- 组装对称矩阵 $S$ 和 $H$，然后使用一个用于求解厄米广义问题的例程（例如，一个求解 $A\\mathbf{v}=\\lambda B\\mathbf{v}$ 的函数，其中 $A$ 和 $B$ 是对称的且 $B$ 是正定的）来求解广义对称本征值问题\n$$\nH\\,\\mathbf{c}=E\\,S\\,\\mathbf{c}\n$$\n。得到的本征值 $\\{E_n^{\\mathrm{approx}}\\}$ 按升序排序。\n- 对于给定的 $M\\le N$，计算均方根相对误差\n$$\n\\varepsilon_{\\mathrm{RMS}}=\\sqrt{\\frac{1}{M}\\sum_{n=1}^{M}\\left(\\frac{E_n^{\\mathrm{approx}}-E_n^{\\mathrm{exact}}}{E_n^{\\mathrm{exact}}}\\right)^2},\n$$\n其中 $E_n^{\\mathrm{exact}}=\\left(\\frac{n\\pi}{L}\\right)^2$。\n\n测试用例与预期：\n- 情况 1（$L=1.0$, $N=1$, $M=1$）使用单个基函数；它产生基态能量的一个变分上界，因此相对误差为正且数值不大。\n- 情况 2（$L=1.0$, $N=3$, $M=3$）考察三个非正交多项式如何捕捉前三个状态；由于子空间扩大，均方根误差应比情况 1 减小。\n- 情况 3（$L=\\pi$, $N=5$, $M=4$）改变了长度尺度；在所选单位中，精确能量变为 $E_n^{\\mathrm{exact}}=n^2$，用于测试构造的标度不变性。\n- 情况 4（$L=2.5$, $N=6$, $M=4$）探讨了不同的 $L$ 和更大的基，进一步测试收敛性和条件数。\n\n实现细节：\n- 使用 $X(x)=x$ 和 $B(x)=-x^2+Lx$ 的系数数组构建多项式，然后形成 $\\phi_k$ 及其导数。\n- 通过对系数数组进行解析积分来计算矩阵元。\n- 使用适用于 $H$ 和 $S$ 的厄米求解器求解广义本征值问题。\n- 对于每个测试用例，计算 $\\varepsilon_{\\mathrm{RMS}}$，四舍五入到 $8$ 位小数，并在单行方括号内输出这四个舍入后值的列表。\n\n该方法将变分原理与对矩阵元进行显式、精确的多项式处理相结合，确保了任何观察到的收敛行为都可归因于基的选择，而非数值积分带来的误差。", "answer": "```python\nimport numpy as np\nfrom scipy.linalg import eigh\n\ndef make_phi_polynomials(L, N):\n    \"\"\"\n    Construct basis polynomials phi_k(x) = x (L - x) (x/L)^k as numpy.poly1d objects in x.\n    Returns a list of poly1d objects [phi_0, ..., phi_{N-1}].\n    \"\"\"\n    x = np.poly1d([1.0, 0.0])        # x\n    B = -x**2 + L * x                # x(L - x)\n    phis = []\n    for k in range(N):\n        scale = (1.0 / L) ** k\n        phi_k = B * (scale * x**k)\n        phis.append(phi_k)\n    return phis\n\ndef integrate_poly_over_interval(p, a, b):\n    \"\"\"\n    Analytically integrate polynomial p over [a, b] using antiderivative.\n    p is numpy.poly1d.\n    \"\"\"\n    P = p.integ()\n    return float(P(b) - P(a))\n\ndef build_matrices(L, N):\n    \"\"\"\n    Build overlap matrix S and Hamiltonian matrix H for the polynomial basis.\n    \"\"\"\n    phis = make_phi_polynomials(L, N)\n    dphis = [phi.deriv() for phi in phis]\n    S = np.zeros((N, N), dtype=float)\n    H = np.zeros((N, N), dtype=float)\n    for i in range(N):\n        for j in range(i, N):\n            # Overlap\n            sij = integrate_poly_over_interval(phis[i] * phis[j], 0.0, L)\n            # Kinetic/Hamiltonian via gradients\n            hij = integrate_poly_over_interval(dphis[i] * dphis[j], 0.0, L)\n            S[i, j] = S[j, i] = sij\n            H[i, j] = H[j, i] = hij\n    return H, S\n\ndef approximate_energies(L, N):\n    \"\"\"\n    Compute approximate energies by solving the generalized eigenvalue problem H c = E S c.\n    Returns sorted eigenvalues (ascending).\n    \"\"\"\n    H, S = build_matrices(L, N)\n    # Solve generalized symmetric eigenproblem\n    w = eigh(H, S, eigvals_only=True)\n    # Ensure real and sorted\n    w = np.real_if_close(w)\n    w.sort()\n    return w\n\ndef exact_energies(L, M):\n    \"\"\"\n    Exact energies E_n = (n*pi/L)^2 for n=1..M in units with hbar^2/(2m)=1.\n    \"\"\"\n    n = np.arange(1, M + 1, dtype=float)\n    return (np.pi * n / L) ** 2\n\ndef rms_relative_error(approx_vals, exact_vals):\n    \"\"\"\n    Compute RMS relative error between arrays approx_vals and exact_vals.\n    \"\"\"\n    rel = (approx_vals - exact_vals) / exact_vals\n    return float(np.sqrt(np.mean(rel**2)))\n\ndef solve():\n    # Define the test cases from the problem statement: (L, N, M)\n    test_cases = [\n        (1.0, 1, 1),\n        (1.0, 3, 3),\n        (np.pi, 5, 4),\n        (2.5, 6, 4),\n    ]\n\n    results = []\n    for L, N, M in test_cases:\n        approx = approximate_energies(L, N)[:M]\n        exact = exact_energies(L, M)\n        err = rms_relative_error(approx, exact)\n        results.append(f\"{err:.8f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "2816688"}]}