{"hands_on_practices": [{"introduction": "我们从一个统计力学中的经典模型——双态顺磁体——开始我们的实践。这个练习的目标是，从第一性原理出发，推导给定总磁化强度 $M$ 的宏观态所对应的微观态数目，即统计权重 $\\Omega(N,M)$。通过这个过程，你将掌握如何将宏观约束（如固定的 $N$ 和 $M$）转化为一个组合计数问题，这是计算任何系统统计权重的基本技能 [@problem_id:2785026]。", "problem": "一个宏观样本由$N$个无相互作用、可分辨的自旋为$\\tfrac{1}{2}$的顺磁体组成，每个顺磁体具有大小为$\\mu$的磁偶极矩。样本被置于均匀磁场中，因此每个自旋沿磁场方向只有两种允许的投影：$+\\mu$（自旋向上）或$-\\mu$（自旋向下）。样本的宏观态由总磁化强度$M$指定，$M$定义为所有单个自旋投影的总和。\n\n仅从微观态和宏观态的定义，以及$M$与自旋向上和自旋向下粒子数之间的关系出发，推导与给定$M$相容的统计权重（微观态数目）$\\Omega(N,M)$的闭式表达式。\n\n假设$(N + M/\\mu)$为偶数，且$0 \\leq (N + M/\\mu)/2 \\leq N$，以使该宏观态是物理上可实现的。将你的最终答案表示为仅含$N$、$M$和$\\mu$的单个闭式符号表达式。$\\Omega$是无量纲的。最终答案中不要包含中间步骤。", "solution": "系统的微观态是对$N$个可分辨粒子中每一个粒子状态的完整描述。由于每个粒子可以处于两种状态之一（自旋向上或自旋向下），一个微观态就是一个长度为$N$的有序序列，指定了每个自旋的方向。例如，对于$N=3$，一个可能的微观态是（上，下，上）。\n\n宏观态由一组较少的宏观参数指定，在本例中即为总磁化强度$M$。统计权重$\\Omega(N, M)$是与给定宏观态相对应的不同微观态的数量。\n\n设$N_+$为自旋投影为$+\\mu$（自旋向上）的粒子数，设$N_-$为自旋投影为$-\\mu$（自旋向下）的粒子数。由于粒子是可分辨的，且每个粒子只有两种可能的状态，粒子总数由以下和式给出：\n$$N = N_+ + N_-$$\n\n总磁化强度$M$定义为各单个磁矩投影之和。这可以表示为$N_+$和$N_-$的函数：\n$$M = N_+ (\\mu) + N_- (-\\mu) = \\mu(N_+ - N_-)$$\n\n我们现在得到一个关于变量$N_+$和$N_-$的二元线性方程组：\n1. $N_+ + N_- = N$\n2. $N_+ - N_- = \\frac{M}{\\mu}$\n\n为了求解$N_+$，我们将两个方程相加：\n$$(N_+ + N_-) + (N_+ - N_-) = N + \\frac{M}{\\mu}$$\n$$2N_+ = N + \\frac{M}{\\mu}$$\n$$N_+ = \\frac{1}{2}\\left(N + \\frac{M}{\\mu}\\right)$$\n\n为了求解$N_-$，我们将$N_+$的表达式代入第一个方程：\n$$N_- = N - N_+ = N - \\frac{1}{2}\\left(N + \\frac{M}{\\mu}\\right) = \\frac{2N - N - \\frac{M}{\\mu}}{2}$$\n$$N_- = \\frac{1}{2}\\left(N - \\frac{M}{\\mu}\\right)$$\n\n问题陈述中给出了$(N + M/\\mu)$为偶数的条件。这保证了$N_+$是一个整数。这也意味着$(N - M/\\mu)$也是一个偶数，因为$N - M/\\mu = (N + M/\\mu) - 2(M/\\mu)$，而两个整数之差必为整数。因此，$N_-$也是一个整数。所给的约束条件确保了$0 \\leq N_+ \\leq N$。\n\n现在的任务简化为一个组合问题。我们必须找出在$N$个可分辨的位置上排列$N_+$个自旋向上的粒子和$N_-$个自旋向下的粒子的方法数。这等价于询问从$N$个可分辨的粒子中选择哪些处于自旋向上状态的方法数。剩下的$N - N_+ = N_-$个粒子则必须处于自旋向下状态。\n\n从$N$个可分辨的物品中选择$N_+$个的方法数由二项式系数$\\binom{N}{N_+}$给出。\n$$\\Omega(N, M) = \\binom{N}{N_+} = \\frac{N!}{N_+! (N - N_+)!}$$\n注意到$N - N_+ = N_-$，上式可以写作：\n$$\\Omega(N, M) = \\frac{N!}{N_+! N_-!}$$\n\n最后，我们将$N_+$和$N_-$的表达式用宏观变量$N$、$M$和$\\mu$代入：\n$$N_+ = \\frac{N}{2} + \\frac{M}{2\\mu}$$\n$$N_- = \\frac{N}{2} - \\frac{M}{2\\mu}$$\n因此，统计权重$\\Omega(N,M)$为：\n$$\\Omega(N, M) = \\frac{N!}{\\left[ \\frac{1}{2}\\left(N + \\frac{M}{\\mu}\\right) \\right]! \\left[ \\frac{1}{2}\\left(N - \\frac{M}{\\mu}\\right) \\right]!}$$\n这就是与由$N$和$M$定义的宏观态相容的微观态数目的闭式表达式。", "answer": "$$\\boxed{\\frac{N!}{\\left[ \\frac{1}{2}\\left(N + \\frac{M}{\\mu}\\right) \\right]! \\left[ \\frac{1}{2}\\left(N - \\frac{M}{\\mu}\\right) \\right]!}}$$", "id": "2785026"}, {"introduction": "在掌握了基础的计数方法之后，我们来处理一个更复杂也更贴近真实物理系统的情形。这个练习要求你计算一个由可分辨粒子组成的孤立系统的总统计权重，这些粒子分布在具有不同简并度的能级上，同时满足粒子总数 $N$ 和总能量 $U$ 恒定的双重约束 [@problem_id:1214843]。这个实践将深化你对简并度如何影响统计权重以及如何在多重约束下确定所有可能粒子分布的理解。", "problem": "在统计力学中，某个特定宏观态的统计权重（或称热力学概率），记为 $W$，是指对应于该宏观态的微观态总数。对于一个由 $N$ 个可分辨粒子组成的系统，这些粒子分布在一系列能级上，其中能量为 $E_i$ 的第 $i$ 个能级具有简并度 $g_i$ 且被 $n_i$ 个粒子占据（使得 $\\sum_i n_i = N$），其统计权重由以下公式给出：\n$$\nW(\\{n_i\\}) = N! \\prod_i \\frac{g_i^{n_i}}{n_i!}\n$$\n考虑一个由 $N$ 个可分辨的、无相互作用的粒子组成的孤立系统。这些粒子可以占据三个可用的单粒子能级之一：\n- 能量为 $E_1 = 0$、简并度为 $g_1$ 的基态。\n- 能量为 $E_2 = \\epsilon$、简并度为 $g_2$ 的第一激发态。\n- 能量为 $E_3 = 2\\epsilon$、简并度为 $g_3$ 的第二激发态。\n\n该系统的宏观态由固定的总粒子数 $N=6$ 和固定的总内能 $U=4\\epsilon$ 定义。各能级的简并度分别为 $g_1=1$，$g_2=3$ 和 $g_3=5$。\n\n求解该宏观态的总统计权重 $W_{\\text{total}}$。该值是满足给定约束条件的所有不同粒子分布（即所有占据数集合 $\\{n_1, n_2, n_3\\}$）的权重之和。", "solution": "我们施加约束条件\n1. 粒子数：\n$$n_1 + n_2 + n_3 = 6$$\n2. 能量：\n$$n_2 \\epsilon + 2 n_3 \\epsilon = 4 \\epsilon \\;\\Longrightarrow\\; n_2 + 2 n_3 = 4$$\n整数解为\n$$(n_1,n_2,n_3)\\in\\{(2,4,0),\\,(3,2,1),\\,(4,0,2)\\}\\,. $$\n某种分布的统计权重为\n$$\nW(n_1,n_2,n_3)=N!\\,\\frac{g_1^{n_1}}{n_1!}\\,\\frac{g_2^{n_2}}{n_2!}\\,\\frac{g_3^{n_3}}{n_3!},\n\\quad N!=720,\\;g_1=1,\\;g_2=3,\\;g_3=5.\n$$\n\n情况 $(2,4,0)$：\n$$\nW_1 = 720 \\cdot \\frac{1^2}{2!} \\frac{3^4}{4!} \\frac{5^0}{0!} = 720 \\cdot \\frac{1}{2} \\cdot \\frac{81}{24} = 1215.\n$$\n\n情况 $(3,2,1)$：\n$$\nW_2 = 720 \\cdot \\frac{1^3}{3!} \\frac{3^2}{2!} \\frac{5^1}{1!} = 720 \\cdot \\frac{1}{6} \\cdot \\frac{9}{2} \\cdot 5 = 2700.\n$$\n\n情况 $(4,0,2)$：\n$$\nW_3 = 720 \\cdot \\frac{1^4}{4!} \\frac{3^0}{0!} \\frac{5^2}{2!} = 720 \\cdot \\frac{1}{24} \\cdot \\frac{25}{2} = 375.\n$$\n\n将所有贡献相加：\n$$\nW_{\\text{total}} = W_1 + W_2 + W_3 = 1215 + 2700 + 375 = 4290.\n$$", "answer": "$$\\boxed{4290}$$", "id": "1214843"}, {"introduction": "统计权重的计算中一个至关重要的概念是粒子的不可分辨性，它直接导致了著名的吉布斯佯谬。本练习将通过计算理想气体混合熵的三种不同情况，让你直面这一佯谬：(1) 可分辨气体，(2) 正确处理的不可分辨气体，以及 (3) 错误处理的不可分辨气体 [@problem_id:2785073]。通过推导这些结果，你将从根本上理解为何必须引入 $1/N!$ 修正因子，以及它如何确保统计力学与宏观热力学的一致性。", "problem": "两种单原子理想气体，组分 $A$ 和 $B$，被限制在由一个刚性、不可渗透的隔板隔开的两个隔间中，具有共同的温度 $T$ 和压力 $P$。左隔间在体积 $V_A$ 中包含 $N_A$ 个 $A$ 气体粒子，右隔间在体积 $V_B$ 中包含 $N_B$ 个 $B$ 气体粒子。隔板被准瞬时地移除，同时体系与一个温度为 $T$ 的大热源保持接触，因此最终状态是在相同温度 $T$ 下占据总体积 $V \\equiv V_A + V_B$ 的平衡理想混合物。\n\n仅从 Boltzmann 原理 $S = k_B \\ln \\Omega$ 以及以下理想气体事实出发：(i) 平动微观状态数与可及的组态空间体积的粒子数次方成正比，以及 (ii) 在固定的 $T$ 和 $P$ 下，理想气体关系式 $P V = N k_B T$ 成立，计算在以下三种情况下的混合熵 $\\Delta S_{\\mathrm{mix}} \\equiv S_{\\text{after}} - S_{\\text{before}}$：\n\n1. $A$ 和 $B$ 是不同的化学物种（可分辨的），并且在适用之处，每个物种内部的不可分辨性都得到了恰当的考虑。\n\n2. $A$ 和 $B$ 事实上是相同的化学物种（不可分辨的），其初始宏观状态由两个隔间中的粒子数 $N_A$ 和 $N_B$ 以及两边相同的 $T$ 和 $P$ 指定。在适用之处，不可分辨性得到了恰当的考虑。\n\n3. 与情况2相同，但你忽略了所有的不可分辨性校正（在计数中任何地方都没有阶乘除法）。\n\n仅在需要时于最终简化阶段使用 Stirling 近似 $\\ln n! \\approx n \\ln n - n$，并通过论证在固定 $T$ 下动量贡献在差值计算中会相互抵消，将注意力限制在 $\\Delta S_{\\mathrm{mix}}$ 中依赖于体积的（组态的）贡献上。将你的最终结果以 $k_B$ 为单位，表示为 $N_A$、$N_B$、$V_A$、$V_B$ 和 $V \\equiv V_A + V_B$ 的函数，并使用两边初始压力 $P$ 相等的条件尽可能地简化它们。\n\n将你的最终答案报告为一个单行矩阵，其中包含按情况(1)、(2)和(3)顺序排列的三个结果，并以 $k_B$ 为单位表示答案（不要在你最终的方框答案中包含单位）。不需要进行数值舍入。", "solution": "理想气体系统的总统计权重 $\\Omega$ 可以分解为动量微观状态的贡献和组态（位置）微观状态的贡献，即 $\\Omega = \\Omega_{\\text{mom}} \\Omega_{\\text{config}}$。因此熵为 $S = k_B \\ln(\\Omega_{\\text{mom}}) + k_B \\ln(\\Omega_{\\text{config}})$。粒子动量的分布以及因此的 $\\Omega_{\\text{mom}}$ 取决于系统的温度 $T$。由于在混合过程前后温度都恒定为 $T$，动量对熵变的贡献为零：$\\Delta S_{\\text{mom}} = S_{\\text{mom,after}} - S_{\\text{mom,before}} = 0$。因此，我们只考虑组态熵变是合理的，即 $\\Delta S_{\\text{mix}} = \\Delta S_{\\text{config}}$。\n\n问题指出，体积 $V$ 中 $N$ 个粒子的组态统计权重与 $V^N$ 成正比。对于可分辨粒子，这是 $\\Omega_{\\text{config}} = C V^N$，其中 $C$ 是一个比例常数。对于 $N$ 个不可分辨粒子，我们必须通过除以粒子的排列数 $N!$ 来校正过计数。所以，$\\Omega_{\\text{config}} = C \\frac{V^N}{N!}$。我们可以将常数 $C$ 吸收到一个依赖于温度但与体积和粒子数无关的项 $\\phi$ 中，得到 $\\Omega_{\\text{config}} = \\frac{(\\phi V)^N}{N!}$。因为 $\\phi$ 只依赖于恒定的温度 $T$，所以它的贡献在熵差计算中将被抵消。\n\n两种气体初始温度 $T$ 和压力 $P$ 相等的条件意味着 $\\frac{P}{k_B T} = \\frac{N_A}{V_A} = \\frac{N_B}{V_B}$。混合后，总粒子数为 $N = N_A+N_B$，总体积为 $V = V_A+V_B$。粒子数密度为 $\\frac{N}{V} = \\frac{N_A+N_B}{V_A+V_B} = \\frac{(P/k_B T)V_A + (P/k_B T)V_B}{V_A+V_B} = \\frac{P}{k_B T}$。因此，粒子数密度保持不变：$\\frac{N_A}{V_A} = \\frac{N_B}{V_B} = \\frac{N}{V}$。这个关系意味着 $\\frac{V}{V_A} = \\frac{N}{N_A}$ 和 $\\frac{V}{V_B} = \\frac{N}{N_B}$。\n\n情况1：$A$ 和 $B$ 是可分辨的物种。\n$A$ 物种的粒子彼此不可分辨，$B$ 物种的粒子也一样。混合前，两种气体处于独立的隔间中。总统计权重是各自权重的乘积：\n$$ \\Omega_{\\text{before}} = \\Omega_A \\times \\Omega_B = \\left( \\frac{\\phi_A^{N_A} V_A^{N_A}}{N_A!} \\right) \\left( \\frac{\\phi_B^{N_B} V_B^{N_B}}{N_B!} \\right) $$\n混合后，$A$ 气体占据体积 $V$，$B$ 气体也占据体积 $V$。由于它们是可分辨的物种，总统计权重再次是乘积：\n$$ \\Omega_{\\text{after}} = \\left( \\frac{\\phi_A^{N_A} V^{N_A}}{N_A!} \\right) \\left( \\frac{\\phi_B^{N_B} V^{N_B}}{N_B!} \\right) $$\n熵变为 $\\Delta S_{\\text{mix}} = k_B \\ln(\\Omega_{\\text{after}} / \\Omega_{\\text{before}})$。\n$$ \\Delta S_{\\text{mix}} = k_B \\ln \\left( \\frac{(\\phi_A^{N_A} V^{N_A}/N_A!)(\\phi_B^{N_B} V^{N_B}/N_B!)}{(\\phi_A^{N_A} V_A^{N_A}/N_A!)(\\phi_B^{N_B} V_B^{N_B}/N_B!)} \\right) = k_B \\ln \\left( \\frac{V^{N_A} V^{N_B}}{V_A^{N_A} V_B^{N_B}} \\right) $$\n$$ \\Delta S_{\\text{mix}} = k_B \\left( N_A \\ln V + N_B \\ln V - N_A \\ln V_A - N_B \\ln V_B \\right) $$\n$$ \\Delta S_{\\text{mix}} = k_B \\left( N_A \\ln \\frac{V}{V_A} + N_B \\ln \\frac{V}{V_B} \\right) $$\n以 $k_B$ 为单位，结果是 $N_A \\ln(V/V_A) + N_B \\ln(V/V_B)$。由于 $V > V_A$ 和 $V > V_B$，这个熵变是正的。\n\n情况2：$A$ 和 $B$ 是相同物种（不可分辨的）。\n混合前，我们有两个独立的系统。总粒子数为 $N = N_A+N_B$。系统是物理上分离的，所以总统计权重是每个隔间权重的乘积，其中每个隔间内的粒子是不可分辨的。常数 $\\phi$ 对两者是相同的。\n$$ \\Omega_{\\text{before}} = \\left( \\frac{\\phi^{N_A} V_A^{N_A}}{N_A!} \\right) \\left( \\frac{\\phi^{N_B} V_B^{N_B}}{N_B!} \\right) = \\frac{\\phi^{N_A+N_B} V_A^{N_A} V_B^{N_B}}{N_A! N_B!} $$\n混合后，我们有一个包含 $N = N_A+N_B$ 个全同、不可分辨粒子的单个系统，处于总体积 $V = V_A+V_B$ 中。\n$$ \\Omega_{\\text{after}} = \\frac{\\phi^{N_A+N_B} V^{N_A+N_B}}{(N_A+N_B)!} $$\n熵变为 $\\Delta S_{\\text{mix}} = k_B \\ln(\\Omega_{\\text{after}} / \\Omega_{\\text{before}})$。\n$$ \\Delta S_{\\text{mix}} = k_B \\ln \\left( \\frac{\\phi^{N} V^{N} / N!}{\\phi^{N} V_A^{N_A} V_B^{N_B} / (N_A! N_B!)} \\right) = k_B \\ln \\left( \\frac{V^{N}}{V_A^{N_A} V_B^{N_B}} \\frac{N_A! N_B!}{N!} \\right) $$\n其中 $N = N_A+N_B$。我们展开对数，并对大数 $N_A$、$N_B$ 和 $N$ 使用 Stirling 近似 $\\ln n! \\approx n \\ln n - n$。\n$$ \\frac{\\Delta S_{\\text{mix}}}{k_B} = N \\ln V - N_A \\ln V_A - N_B \\ln V_B + \\ln(N_A!) + \\ln(N_B!) - \\ln(N!) $$\n$$ \\approx (N_A+N_B)\\ln V - N_A\\ln V_A - N_B\\ln V_B + (N_A\\ln N_A - N_A) + (N_B\\ln N_B - N_B) - ((N_A+N_B)\\ln(N_A+N_B) - (N_A+N_B)) $$\n$N$ 的线性项抵消：$-N_A - N_B + (N_A+N_B) = 0$。将余项分组：\n$$ \\frac{\\Delta S_{\\text{mix}}}{k_B} \\approx N_A(\\ln V - \\ln V_A + \\ln N_A) + N_B(\\ln V - \\ln V_B + \\ln N_B) - N\\ln N $$\n$$ = N_A \\ln\\left(\\frac{V N_A}{V_A}\\right) + N_B \\ln\\left(\\frac{V N_B}{V_B}\\right) - (N_A+N_B)\\ln N $$\n$$ = N_A \\ln\\left(\\frac{V N_A}{V_A N}\\right) + N_B \\ln\\left(\\frac{V N_B}{V_B N}\\right) $$\n使用恒定粒子数密度的条件 $\\frac{N_A}{V_A} = \\frac{N_B}{V_B} = \\frac{N}{V}$，我们发现每个对数的自变量都是1：\n$$ \\frac{V N_A}{V_A N} = \\frac{N}{N_A} \\frac{N_A}{N} = 1 \\quad \\text{和} \\quad \\frac{V N_B}{V_B N} = \\frac{N}{N_B} \\frac{N_B}{N} = 1 $$\n因此，\n$$ \\frac{\\Delta S_{\\text{mix}}}{k_B} \\approx N_A \\ln(1) + N_B \\ln(1) = 0 $$\n对于在相同温度和压力下的相同气体，混合熵为零，正如预期。\n\n情况3：与情况2相同，但没有不可分辨性校正。\n在这个假设的情况下，我们将所有 $N_A+N_B$ 个粒子都视为可分辨的个体，即使它们属于同一物种。我们不除以任何阶乘项。\n混合前，我们有 $N_A$ 个可分辨粒子在 $V_A$ 中，以及 $N_B$ 个可分辨粒子在 $V_B$ 中。\n$$ \\Omega_{\\text{before}} = (\\phi^{N_A} V_A^{N_A}) (\\phi^{N_B} V_B^{N_B}) = \\phi^{N_A+N_B} V_A^{N_A} V_B^{N_B} $$\n混合后，我们在体积 $V$ 中有 $N = N_A+N_B$ 个可分辨粒子。\n$$ \\Omega_{\\text{after}} = \\phi^{N_A+N_B} V^{N_A+N_B} $$\n熵变为：\n$$ \\Delta S_{\\text{mix}} = k_B \\ln \\left( \\frac{\\Omega_{\\text{after}}}{\\Omega_{\\text{before}}} \\right) = k_B \\ln \\left( \\frac{\\phi^{N_A+N_B} V^{N_A+N_B}}{\\phi^{N_A+N_B} V_A^{N_A} V_B^{N_B}} \\right) = k_B \\ln \\left( \\frac{V^{N_A+N_B}}{V_A^{N_A} V_B^{N_B}} \\right) $$\n$$ \\Delta S_{\\text{mix}} = k_B \\left( N_A \\ln \\frac{V}{V_A} + N_B \\ln \\frac{V}{V_B} \\right) $$\n这个结果与情况1相同。它展示了 Gibbs 佯谬：如果将全同粒子错误地处理为可分辨的，混合熵将为非零，这会在两种气体变得无限相似时，在 $\\Delta S_{\\text{mix}}$ 的值上产生一个物理上不正确的间断。\n\n以 $k_B$ 为单位的三个结果是：\n1. $N_A \\ln(V/V_A) + N_B \\ln(V/V_B)$\n2. $0$\n3. $N_A \\ln(V/V_A) + N_B \\ln(V/V_B)$", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\nN_A \\ln \\left( \\frac{V}{V_A} \\right) + N_B \\ln \\left( \\frac{V}{V_B} \\right) & 0 & N_A \\ln \\left( \\frac{V}{V_A} \\right) + N_B \\ln \\left( \\frac{V}{V_B} \\right)\n\\end{pmatrix}\n}\n$$", "id": "2785073"}]}