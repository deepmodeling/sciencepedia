{"hands_on_practices": [{"introduction": "我们从一个基础但极具启发性的模型开始，这个模型常用于描述生物大分子（如蛋白质或DNA）的折叠与解折叠等构象变化。通过这个简化的双态系统，你将练习应用正则系综的基本定义，从微观能级出发，计算系统的宏观平均能量。这项实践旨在为你打下坚实的基础，让你掌握如何利用配分函数这一核心工具，将微观世界与可观测的热力学性质联系起来[@problem_id:1996069]。", "problem": "一个简化的玩具模型被用来描述单个生物大分子的构象变化。该分子只可以存在于两种不同的状态：一种是紧凑的折叠态，另一种是伸展的展开态。折叠态被视作基态，其能量为零。展开态的形成需要能量输入，因此其能量为 $\\epsilon$，其中 $\\epsilon > 0$。该大分子浸在一个保持恒定绝对温度 $T$ 的大热浴中。\n\n基于此模型，推导单个此类大分子的平均能量 $\\langle E \\rangle$ 的表达式。你的最终答案应为一个关于能量差 $\\epsilon$、温度 $T$ 和玻尔兹曼常数 $k_B$ 的闭式解析表达式。", "solution": "该大分子有两个能级：能量为 $E_0=0$ 的折叠态和能量为 $E_1=\\epsilon$ 的展开态，其中 $\\epsilon>0$。在与绝对温度为 $T$ 的热浴接触时，适用的系综是正则系综。定义 $\\beta=1/(k_B T)$。能量为 $E_i$ 的状态的玻尔兹曼权重为 $\\exp(-\\beta E_i)$，配分函数是所有状态的这些权重之和：\n$$\nZ=\\sum_{i}\\exp(-\\beta E_{i})=\\exp(-\\beta\\cdot 0)+\\exp(-\\beta\\epsilon)=1+\\exp(-\\beta\\epsilon).\n$$\n处于状态 $i$ 的概率为 $p_i=\\frac{\\exp(-\\beta E_i)}{Z}$。因此，平均能量为\n$$\n\\langle E \\rangle = \\sum_i E_i p_i = 0\\cdot\\frac{\\exp(0)}{Z}+\\epsilon\\cdot\\frac{\\exp(-\\beta\\epsilon)}{Z}=\\epsilon\\,\\frac{\\exp(-\\beta\\epsilon)}{1+\\exp(-\\beta\\epsilon)}.\n$$\n为简化，将分子和分母同乘以 $\\exp(\\beta\\epsilon)$：\n$$\n\\langle E\\rangle=\\epsilon\\,\\frac{1}{\\exp(\\beta\\epsilon)+1}.\n$$\n代入 $\\beta=1/(k_B T)$，得到关于 $\\epsilon$、$T$ 和 $k_B$ 的闭式表达式：\n$$\n\\langle E\\rangle=\\frac{\\epsilon}{1+\\exp\\left(\\frac{\\epsilon}{k_B T}\\right)}.\n$$\n这一结果与 $T\\to 0$ 时给出 $\\langle E\\rangle\\to 0$ 和 $T\\to\\infty$ 时给出 $\\langle E\\rangle\\to \\frac{\\epsilon}{2}$ 的极限情况相符。", "answer": "$$\\boxed{\\frac{\\epsilon}{1+\\exp\\left(\\frac{\\epsilon}{k_{B}T}\\right)}}$$", "id": "1996069"}, {"introduction": "在掌握了基础系统的计算后，我们转向一个更复杂的场景：一个由 $N$ 个原子组成的体系，其激发态具有简并，并在外场作用下发生能级分裂。你的任务是推导该体系在高温极限下的定容热容 $C_V$。这个练习不仅能让你处理包含简并度的多粒子体系，更重要的是，它将引导你学习并应用高温展开这一重要近似方法，这对于解析复杂体系在特定物理条件下的主导行为至关重要[@problem_id:118084]。", "problem": "一个固体包含 $N$ 个可分辨的、无相互作用的原子。每个原子的能级可按如下方式建模。存在一个能量为 $E_0=0$ 的非简并基态。还有一个激发态集合，在没有任何外场的情况下，它们是 $g$ 重简并的，能量为 $\\epsilon > 0$。我们假设 $g$ 是一个奇数，因此可以写成 $g=2m+1$，其中 $m$ 为某个非负整数。\n\n一个外场施加到该固体上，部分地解除了激发态的简并。这 $g$ 个激发能级现在围绕原始能量 $\\epsilon$ 对称地分裂，新的能量由下式给出\n$$ E_j = \\epsilon + j\\delta $$\n其中 $j = -m, -m+1, \\dots, m$。参数 $\\delta$ 是一个由场强决定的、小的正能量分裂常数。\n\n系统与温度为 $T$ 的热浴处于热平衡状态。在高温极限下 ($k_B T \\gg \\epsilon, k_B T \\gg g\\delta$)，求此 $N$ 原子系统的定容热容 $C_V$。你的答案应该是高温展开中的领头非零项。请用 $N$、$g$、$\\epsilon$、$\\delta$、温度 $T$ 以及玻尔兹曼常数 $k_B$ 以单个闭合形式表达式表示你的结果。", "solution": "系统由 $N$ 个可分辨的、无相互作用的原子组成。单原子配分函数 $z$ 由下式给出：\n\n$$\nz = 1 + \\sum_{j=-m}^{m} e^{-E_j / (k_B T)},\n$$\n\n其中 $E_j = \\epsilon + j\\delta$，$j = -m, -m+1, \\dots, m$，且 $g = 2m+1$ 是未分裂激发态的简并度。因此，\n\n$$\nz = 1 + e^{-\\epsilon / (k_B T)} \\sum_{j=-m}^{m} e^{-j\\delta / (k_B T)}.\n$$\n\n定义 $\\beta = 1/(k_B T)$。求和 $S = \\sum_{j=-m}^{m} e^{-\\beta j \\delta}$ 关于 $j$ 是对称的。在高温极限下，$\\beta \\epsilon \\ll 1$ 且 $\\beta g \\delta \\ll 1$，因此将 $S$ 对 $\\beta$ 展开到二阶：\n\n$$\nS \\approx \\sum_{j=-m}^{m} \\left(1 - \\beta j \\delta + \\frac{1}{2} (\\beta j \\delta)^2\\right).\n$$\n\n由于对称性，线性项为零，剩下：\n\n$$\nS \\approx \\sum_{j=-m}^{m} \\left(1 + \\frac{1}{2} \\beta^2 j^2 \\delta^2\\right) = g + \\frac{1}{2} \\beta^2 \\delta^2 \\sum_{j=-m}^{m} j^2.\n$$\n\n求和 $\\sum_{j=-m}^{m} j^2 = \\frac{g(g^2 - 1)}{12}$，所以：\n\n$$\nS \\approx g + \\frac{\\beta^2 \\delta^2 g (g^2 - 1)}{24}.\n$$\n\n现在，$z$ 变为：\n\n$$\nz = 1 + e^{-\\beta \\epsilon} \\left( g + \\frac{\\beta^2 \\delta^2 g (g^2 - 1)}{24} \\right).\n$$\n\n展开 $e^{-\\beta \\epsilon} \\approx 1 - \\beta \\epsilon + \\frac{1}{2} \\beta^2 \\epsilon^2$：\n\n$$\nz \\approx 1 + \\left(1 - \\beta \\epsilon + \\frac{1}{2} \\beta^2 \\epsilon^2\\right) \\left( g + \\frac{\\beta^2 \\delta^2 g (g^2 - 1)}{24} \\right).\n$$\n\n相乘并保留至 $\\beta^2$ 的项：\n\n$$\nz \\approx 1 + g - g \\beta \\epsilon + \\frac{g}{2} \\beta^2 \\epsilon^2 + \\frac{\\beta^2 \\delta^2 g (g^2 - 1)}{24}.\n$$\n\n令 $A = 1 + g$，$B = -g \\epsilon$，$C = \\frac{g}{2} \\epsilon^2 + \\frac{\\delta^2 g (g^2 - 1)}{24}$，所以：\n\n$$\nz \\approx A + B \\beta + C \\beta^2.\n$$\n\n$z$ 的对数为：\n\n$$\n\\ln z = \\ln A + \\ln\\left(1 + \\frac{B}{A} \\beta + \\frac{C}{A} \\beta^2\\right) \\approx \\ln A + \\frac{B}{A} \\beta + \\left( \\frac{C}{A} - \\frac{1}{2} \\left( \\frac{B}{A} \\right)^2 \\right) \\beta^2.\n$$\n\n单个原子的内能为 $U_1 = -\\frac{\\partial \\ln z}{\\partial \\beta}$：\n\n$$\nU_1 \\approx -\\left[ \\frac{B}{A} + 2 \\left( \\frac{C}{A} - \\frac{1}{2} \\left( \\frac{B}{A} \\right)^2 \\right) \\beta \\right].\n$$\n\n对于 $N$ 个原子，$U = N U_1$。热容为 $C_V = \\left( \\frac{\\partial U}{\\partial T} \\right)_V$。由于 $\\frac{d\\beta}{dT} = -\\frac{1}{k_B T^2}$：\n\n$$\nC_V = -\\frac{N}{k_B T^2} \\frac{\\partial U_1}{\\partial \\beta}.\n$$\n\n代入 $U_1$：\n\n$$\n\\frac{\\partial U_1}{\\partial \\beta} \\approx -2 \\left( \\frac{C}{A} - \\frac{1}{2} \\left( \\frac{B}{A} \\right)^2 \\right),\n$$\n\n所以：\n\n$$\nC_V \\approx \\frac{N}{k_B T^2} \\cdot 2 \\left( \\frac{C}{A} - \\frac{1}{2} \\left( \\frac{B}{A} \\right)^2 \\right) = \\frac{2N}{k_B T^2} \\left( \\frac{C}{A} - \\frac{1}{2} \\left( \\frac{B}{A} \\right)^2 \\right).\n$$\n\n现在代入 $A = 1 + g$，$B = -g \\epsilon$，$C = \\frac{g}{2} \\epsilon^2 + \\frac{\\delta^2 g (g^2 - 1)}{24}$：\n\n$$\n\\frac{C}{A} = \\frac{ \\frac{g}{2} \\epsilon^2 + \\frac{\\delta^2 g (g^2 - 1)}{24} }{1 + g}, \\quad \\left( \\frac{B}{A} \\right)^2 = \\left( \\frac{-g \\epsilon}{1 + g} \\right)^2 = \\frac{g^2 \\epsilon^2}{(1 + g)^2}.\n$$\n\n因此：\n\n$$\n\\frac{C}{A} - \\frac{1}{2} \\left( \\frac{B}{A} \\right)^2 = \\frac{ \\frac{g}{2} \\epsilon^2 + \\frac{\\delta^2 g (g^2 - 1)}{24} }{1 + g} - \\frac{1}{2} \\frac{g^2 \\epsilon^2}{(1 + g)^2}.\n$$\n\n使用公分母 $(1 + g)^2$ 合并项：\n\n$$\n= \\frac{ (1 + g) \\left( \\frac{g}{2} \\epsilon^2 + \\frac{\\delta^2 g (g^2 - 1)}{24} \\right) - \\frac{1}{2} g^2 \\epsilon^2 }{(1 + g)^2}.\n$$\n\n分子为：\n\n$$\n(1 + g) \\frac{g}{2} \\epsilon^2 + (1 + g) \\frac{\\delta^2 g (g^2 - 1)}{24} - \\frac{1}{2} g^2 \\epsilon^2 = \\frac{g}{2} \\epsilon^2 (1 + g - g) + \\frac{\\delta^2 g (g^2 - 1) (1 + g)}{24} = \\frac{g \\epsilon^2}{2} + \\frac{\\delta^2 g (g^2 - 1) (1 + g)}{24}.\n$$\n\n所以：\n\n$$\n\\frac{C}{A} - \\frac{1}{2} \\left( \\frac{B}{A} \\right)^2 = \\frac{ \\frac{g \\epsilon^2}{2} + \\frac{\\delta^2 g (g^2 - 1) (1 + g)}{24} }{(1 + g)^2} = \\frac{g \\epsilon^2}{2 (1 + g)^2} + \\frac{\\delta^2 g (g^2 - 1)}{24 (1 + g)}.\n$$\n\n现在：\n\n$$\n2 \\left( \\frac{C}{A} - \\frac{1}{2} \\left( \\frac{B}{A} \\right)^2 \\right) = 2 \\cdot \\frac{g \\epsilon^2}{2 (1 + g)^2} + 2 \\cdot \\frac{\\delta^2 g (g^2 - 1)}{24 (1 + g)} = \\frac{g \\epsilon^2}{(1 + g)^2} + \\frac{\\delta^2 g (g^2 - 1)}{12 (1 + g)}.\n$$\n\n由于 $g^2 - 1 = (g - 1)(g + 1)$：\n\n$$\n\\frac{\\delta^2 g (g^2 - 1)}{12 (1 + g)} = \\frac{\\delta^2 g (g - 1) (g + 1)}{12 (g + 1)} = \\frac{\\delta^2 g (g - 1)}{12}.\n$$\n\n因此：\n\n$$\nC_V = \\frac{N}{k_B T^2} \\left( \\frac{g \\epsilon^2}{(1 + g)^2} + \\frac{g (g - 1) \\delta^2}{12} \\right).\n$$\n\n这就是高温展开中的领头非零项。", "answer": "$$ \\boxed{ \\frac{N}{k_B T^2} \\left( \\frac{g \\epsilon^2}{(g+1)^2} + \\frac{g(g-1)\\delta^2}{12} \\right) } $$", "id": "118084"}, {"introduction": "理论的最终目的是指导实践。最后一个练习将带你从解析推导走向计算模拟的世界，这是现代理论化学研究不可或缺的一环。你将扮演一位计算化学家，为一个经典的二元混合物体系设计一种蒙特卡洛（Monte Carlo）移动算法，即粒子身份交换，并确保该算法满足细致平衡条件，从而能正确地在正则系综 ($NVT$) 下进行抽样。这项实践将理论与实际算法设计紧密结合，让你深刻理解统计力学的基本原理如何在计算机模拟中得到贯彻和应用[@problem_id:2463730]。", "problem": "考虑一个处于正则 (NVT) 系综中的经典二元混合物，即组分数量固定的数-容-温 (NVT) 系综：在体积为 $V$、温度为 $T$ 的容器中，有 $N_A$ 个 A 组分粒子和 $N_B$ 个 B 组分粒子，因此总粒子数为 $N=N_A+N_B$。构型态可以表示为 $(\\mathbf{r}, \\sigma)$，其中 $\\mathbf{r}=(\\mathbf{r}_1, \\ldots, \\mathbf{r}_N)$ 是粒子位置，$\\sigma=(\\sigma_1, \\ldots, \\sigma_N)$ 是组分标签，满足 $\\sigma_i \\in \\{A, B\\}$，且恰好有 $N_A$ 个标签为 A， $N_B$ 个标签为 B。势能为 $U(\\mathbf{r}, \\sigma)$，它通过相互作用参数依赖于组分，但在下述移动中没有坐标变换。正则构型概率密度正比于 $\\exp(-\\beta U)$，其中 $\\beta=1/(k_B T)$，$k_B$ 是玻尔兹曼常数。\n\n你希望为一个标准的蒙特卡洛采样器增加一种身份交换移动，该移动交换一个 A 类型粒子和一个 B 类型粒子的组分标签，同时保持位置 $\\mathbf{r}$ 不变，从而使组分 $(N_A, N_B)$ 保持固定。以下哪种设计能确保相对于正则分布满足细致平衡条件？\n\nA. 每次尝试时，从 $N_A$ 个 A 类型粒子中均匀随机选择一个，并从 $N_B$ 个 B 类型粒子中均匀随机选择一个；交换它们的组分标签，计算势能变化 $\\Delta U = U(\\mathbf{r}, \\sigma') - U(\\mathbf{r}, \\sigma)$，并以概率 $\\min\\{1, \\exp(-\\beta \\Delta U)\\}$ 接受。\n\nB. 每次尝试时，均匀随机选择一个 A 和一个 B；交换它们的组分标签，并以概率 $\\min\\{1, \\exp[-\\beta(\\Delta U - \\Delta\\mu)]\\}$ 接受，其中 $\\Delta\\mu = \\mu_A - \\mu_B$ 是 A 和 B 之间的化学势差。\n\nC. 每次尝试时，均匀随机选择一个 A 和一个 B；交换它们的组分标签，并以概率 $\\min\\{1, \\exp(-\\beta \\Delta U) (N_A/N_B)\\}$ 接受，以校正选择 A 和 B 的数目差异。\n\nD. 每次尝试时，均匀随机选择一个 A 和一个 B；交换它们的组分标签，当且仅当 $\\Delta U \\le 0$ 时接受，否则拒绝，因为能量增加的移动会在正则系综中违反能量守恒。", "solution": "### 解答推导\n细致平衡条件，或称微观可逆性，是马尔可夫链具有目标分布作为其平稳分布的充分条件。对于任意两个状态 $x$ 和 $x'$，细致平衡方程为：\n$$\np(x) T(x \\to x') = p(x') T(x' \\to x)\n$$\n其中 $p(x)$ 是状态 $x$ 的平衡概率，而 $T(x \\to x')$ 是从状态 $x$ 到 $x'$ 的总转移概率。转移概率是提议概率 $g(x \\to x')$ 和接受概率 $A(x \\to x')$ 的乘积。因此，\n$$\np(x) g(x \\to x') A(x \\to x') = p(x') g(x' \\to x) A(x' \\to x)\n$$\n这可以重新排列以表示接受概率的比率：\n$$\n\\frac{A(x \\to x')}{A(x' \\to x)} = \\frac{p(x')}{p(x)} \\frac{g(x' \\to x)}{g(x \\to x')}\n$$\n接受概率的标准 Metropolis-Hastings 选择是：\n$$\nA(x \\to x') = \\min\\left(1, \\frac{p(x')}{p(x)} \\frac{g(x' \\to x)}{g(x \\to x')}\\right)\n$$\n\n现在我们必须将这个形式体系应用于当前问题。\n一个状态 $x$ 由组分标签 $\\sigma = (\\sigma_1, \\ldots, \\sigma_N)$ 定义，因为在移动过程中位置 $\\mathbf{r}$ 保持不变。一次移动包括通过交换粒子 $i$（初始为 A 类型）和粒子 $j$（初始为 B 类型）的标签，从状态 $\\sigma$ 变为新状态 $\\sigma'$。\n\n目标概率分布是正则分布：\n$$\np(\\sigma) \\propto \\exp[-\\beta U(\\sigma)]\n$$\n两个状态 $\\sigma$ 和 $\\sigma'$ 的概率比为：\n$$\n\\frac{p(\\sigma')}{p(\\sigma)} = \\frac{\\exp[-\\beta U(\\sigma')]}{\\exp[-\\beta U(\\sigma)]} = \\exp[-\\beta (U(\\sigma') - U(\\sigma))] = \\exp(-\\beta \\Delta U)\n$$\n\n接下来，我们必须确定提议概率。提议方案是：“从 $N_A$ 个 A 类型粒子中均匀随机选择一个，并从 $N_B$ 个 B 类型粒子中均匀随机选择一个”。\n提议交换一个特定的 A 类型粒子 $i$ 和一个特定的 B 类型粒子 $j$ 的概率是：\n$$\ng(\\sigma \\to \\sigma') = \\left(\\frac{1}{N_A}\\right) \\left(\\frac{1}{N_B}\\right) = \\frac{1}{N_A N_B}\n$$\n现在考虑从 $\\sigma'$ 到 $\\sigma$ 的逆向移动。在状态 $\\sigma'$ 中，粒子 $i$ 现在是 B 类型，粒子 $j$ 是 A 类型。每种类型的粒子总数仍然是 $N_A$ 和 $N_B$。要逆转这一移动，我们必须选择粒子 $j$（现在是 A 类型）和粒子 $i$（现在是 B 类型）并交换它们的标签。为逆向交换选择这一特定粒子对的概率是：\n$$\ng(\\sigma' \\to \\sigma) = \\left(\\frac{1}{N_A}\\right) \\left(\\frac{1}{N_B}\\right) = \\frac{1}{N_A N_B}\n$$\n提议概率是对称的：$g(\\sigma \\to \\sigma') = g(\\sigma' \\to \\sigma)$。因此，提议概率的比值为 1：\n$$\n\\frac{g(\\sigma' \\to \\sigma)}{g(\\sigma \\to \\sigma')} = 1\n$$\n将这些结果代入 Metropolis-Hastings 接受概率公式，得到：\n$$\nA(\\sigma \\to \\sigma') = \\min\\left(1, \\frac{p(\\sigma')}{p(\\sigma)} \\times 1\\right) = \\min\\left(1, \\exp(-\\beta \\Delta U)\\right)\n$$\n此推导确定了接受概率的正确形式。我们现在来评估每个选项。\n\n### 逐项分析\n\n**A. 每次尝试时，从 $N_A$ 个 A 类型粒子中均匀随机选择一个，并从 $N_B$ 个 B 类型粒子中均匀随机选择一个；交换它们的组分标签，计算势能变化 $\\Delta U = U(\\mathbf{r}, \\sigma') - U(\\mathbf{r}, \\sigma)$，并以概率 $\\min\\{1, \\exp(-\\beta \\Delta U)\\}$ 接受。**\n这里描述的提议方案正是上面分析的方案，它导致了对称的提议概率 $g(\\sigma \\to \\sigma') = g(\\sigma' \\to \\sigma)$。对于这种对称提议，正确的 Metropolis 接受法则是 $A = \\min\\{1, \\exp(-\\beta \\Delta U)\\}$。该选项正确地将对称提议方案与适当的简化 Metropolis 接受法则结合起来。\n结论：**正确**。\n\n**B. 每次尝试时，均匀随机选择一个 A 和一个 B；交换它们的组分标签，并以概率 $\\min\\{1, \\exp[-\\beta(\\Delta U - \\Delta\\mu)]\\}$ 接受，其中 $\\Delta\\mu = \\mu_A - \\mu_B$ 是 A 和 B 之间的化学势差。**\n对于正则 (NVT) 系综，这个接受概率是不正确的。涉及化学势差 $\\Delta\\mu$ 的项用于粒子数可以波动并由化学势控制的系综中的模拟，例如巨正则系综或半巨正则系综。问题明确指定了正则系综，其中粒子数 $N_A$ 和 $N_B$ 是严格固定的。在此系综中，化学势是衍生性质，而不是模拟动力学的输入参数。\n结论：**不正确**。\n\n**C. 每次尝试时，均匀随机选择一个 A 和一个 B；交换它们的组分标签，并以概率 $\\min\\{1, \\exp(-\\beta \\Delta U) (N_A/N_B)\\}$ 接受，以校正选择 A 和 B 的数目差异。**\n这个接受法则包含一个校正因子 $N_A/N_B$。当提议概率不对称时，即 $g(\\sigma \\to \\sigma') \\neq g(\\sigma' \\to \\sigma)$，这类因子会出现在 Metropolis-Hastings 公式中。然而，如推导所示，从 $N_A$ 个粒子中选择一个和从 $N_B$ 个粒子中选择一个的指定方法导致了对称的提议概率。因此，比率 $g(\\sigma' \\to \\sigma)/g(\\sigma \\to \\sigma')$ 为 1，因子 $N_A/N_B$ 既不必要也不正确。它会违反细致平衡。\n结论：**不正确**。\n\n**D. 每次尝试时，均匀随机选择一个 A 和一个 B；交换它们的组分标签，当且仅当 $\\Delta U \\le 0$ 时接受，否则拒绝，因为能量增加的移动会在正则系综中违反能量守恒。**\n这个选项存在两个基本错误。首先，对于 $\\Delta U \\le 0$ 时 $A=1$ 和对于 $\\Delta U > 0$ 时 $A=0$ 的接受法则不会对正则分布进行采样。这是一种贪心算法，只接受降低能量或能量中性的移动，这会导致系统陷入局部能量最小值，而不是根据玻尔兹曼分布探索整个状态空间。其次，其理由是基于对正则系综的深刻误解。NVT 系综描述的是一个与热浴处于热平衡的系统，允许能量交换。系统的能量 $U$ 并不守恒，而是会涨落。能量守恒是微正则 (NVE) 系综的定义特征，而不是正则系综。能量增加的移动（$\\Delta U > 0$）对于正确采样正则系综特有的热涨落至关重要。\n结论：**不正确**。", "answer": "$$\\boxed{A}$$", "id": "2463730"}]}