{"hands_on_practices": [{"introduction": "在理论化学中，一个核心任务是从分子的微观量子结构预测其宏观热力学性质。此练习将理论与实践相结合，要求您基于谐振子模型推导多原子分子的振动熵。通过处理像苯这样的多分量体系 ([@problem_id:2023555])，您将练习如何将分子的总振动配分函数分解为各个独立振动模式的乘积，并最终得到一个可直接用于计算化学数据的关键热力学量。", "problem": "在计算化学中，分子的热力学性质可以通过其量子力学结构来预测。该计算的一个关键组成部分是振动贡献，通常通过将每个振动简正模处理为独立的量子谐振子来建模。\n\n考虑苯分子，$C_6H_6$。作为一个包含12个原子的非线性分子，它有30个振动模式。一项计算分析已经确定了这些模式的频率。由于分子的对称性，许多模式共享相同的频率（即，它们是简并的）。不同的振动波数 $\\tilde{\\nu}_i$ 及其对应的简并度 $g_i$ 如下所示：\n- $g_1$ 个模式，波数为 $\\tilde{\\nu}_1$\n- $g_2$ 个模式，波数为 $\\tilde{\\nu}_2$\n- $g_3$ 个模式，波数为 $\\tilde{\\nu}_3$\n- ...以此类推，涵盖所有不同模式。\n\n假设每个振动模式都是一个独立的量子谐振子，请推导一个苯分子在给定绝对温度 $T$ 下的总振动熵 $S_v$ 的符号表达式。\n\n你的最终答案应该是一个单一的、闭合形式的解析表达式，表示为对代表不同振动模式的索引 $i$ 的求和。该表达式必须用温度 $T$、简并度 $\\{g_i\\}$、波数 $\\{\\tilde{\\nu}_i\\}$、光速 $c$、Planck 常数 $h$ 和 Boltzmann 常数 $k_B$ 来表示。", "solution": "我们将每个振动简正模视为一个独立的量子谐振子。对于频率为 $\\nu$ 的单个量子谐振子，其能级为 $E_{n} = h \\nu \\left(n + \\frac{1}{2}\\right)$，其中 $n \\in \\{0,1,2,\\ldots\\}$。在温度 $T$ 下，令 $\\beta \\equiv \\frac{1}{k_{B} T}$，则正则配分函数为\n$$\nZ = \\sum_{n=0}^{\\infty} \\exp\\!\\left(-\\beta h \\nu \\left(n + \\frac{1}{2}\\right)\\right)\n= \\exp\\!\\left(-\\frac{1}{2}\\beta h \\nu\\right) \\sum_{n=0}^{\\infty} \\left(\\exp(-\\beta h \\nu)\\right)^{n}\n= \\frac{\\exp\\!\\left(-\\frac{1}{2}\\beta h \\nu\\right)}{1 - \\exp(-\\beta h \\nu)}.\n$$\nHelmholtz 自由能是\n$$\nF = -k_{B} T \\ln Z = -k_{B} T \\left[-\\frac{1}{2}\\beta h \\nu - \\ln\\!\\left(1 - \\exp(-\\beta h \\nu)\\right)\\right]\n= \\frac{1}{2}h \\nu + k_{B} T \\ln\\!\\left(1 - \\exp(-\\beta h \\nu)\\right).\n$$\n该模式的振动熵为 $S = - \\left(\\frac{\\partial F}{\\partial T}\\right)$（在恒定体积下）。对 $F$ 的表达式关于 $T$ 求导，并使用 $x \\equiv \\beta h \\nu = \\frac{h \\nu}{k_{B} T}$，我们得到\n$$\nS = - \\left[ k_{B} \\ln\\!\\left(1 - \\exp(-x)\\right) + k_{B} T \\frac{\\partial}{\\partial T} \\ln\\!\\left(1 - \\exp(-x)\\right) \\right].\n$$\n由于 $x = \\frac{h \\nu}{k_{B} T}$，我们有 $\\frac{d x}{d T} = -\\frac{x}{T}$ 并且\n$$\n\\frac{\\partial}{\\partial T} \\ln\\!\\left(1 - \\exp(-x)\\right)\n= \\frac{\\exp(-x)}{1 - \\exp(-x)} \\frac{d x}{d T}\n= -\\frac{x}{T} \\frac{1}{\\exp(x) - 1}.\n$$\n代入此导数可得\n$$\nS = - k_{B} \\ln\\!\\left(1 - \\exp(-x)\\right) + k_{B} \\frac{x}{\\exp(x) - 1}.\n$$\n对于由波数 $\\tilde{\\nu}$ 指定的振动模式，其频率为 $\\nu = c \\tilde{\\nu}$，因此 $x = \\frac{h c \\tilde{\\nu}}{k_{B} T}$。所以，一个波数为 $\\tilde{\\nu}$ 的模式的振动熵贡献是\n$$\nS(\\tilde{\\nu}, T) = k_{B} \\left[ \\frac{\\frac{h c \\tilde{\\nu}}{k_{B} T}}{\\exp\\!\\left(\\frac{h c \\tilde{\\nu}}{k_{B} T}\\right) - 1} - \\ln\\!\\left(1 - \\exp\\!\\left(-\\frac{h c \\tilde{\\nu}}{k_{B} T}\\right)\\right) \\right].\n$$\n对于苯，不同的振动波数为 $\\{\\tilde{\\nu}_{i}\\}$，其简并度为 $\\{g_{i}\\}$，并且这些模式是独立的。对于处于相同温度下的独立子系统，熵是可加的，因此单个分子的总振动熵是所有不同模式按其简并度加权后的总和：\n$$\nS_{v}(T) = \\sum_{i} g_{i} \\, S(\\tilde{\\nu}_{i}, T)\n= k_{B} \\sum_{i} g_{i} \\left[ \\frac{\\frac{h c \\tilde{\\nu}_{i}}{k_{B} T}}{\\exp\\!\\left(\\frac{h c \\tilde{\\nu}_{i}}{k_{B} T}\\right) - 1} - \\ln\\!\\left(1 - \\exp\\!\\left(-\\frac{h c \\tilde{\\nu}_{i}}{k_{B} T}\\right)\\right) \\right].\n$$\n该表达式仅依赖于 $T$, $\\{g_{i}\\}$, $\\{\\tilde{\\nu}_{i}\\}$, $c$, $h$ 和 $k_{B}$，符合要求。从推导中可以看出，零点能 $\\frac{1}{2} h c \\tilde{\\nu}_{i}$ 在熵的计算中被抵消。", "answer": "$$\\boxed{k_{B} \\sum_{i} g_{i} \\left[ \\frac{\\frac{h c \\tilde{\\nu}_{i}}{k_{B} T}}{\\exp\\!\\left(\\frac{h c \\tilde{\\nu}_{i}}{k_{B} T}\\right) - 1} - \\ln\\!\\left(1 - \\exp\\!\\left(-\\frac{h c \\tilde{\\nu}_{i}}{k_{B} T}\\right)\\right) \\right]}$$", "id": "2023555"}, {"introduction": "尽管谐振子模型是理解分子振动的基石，但真实的分子势能并非完美的二次型。此练习引入了非谐性——一个对势能的小修正，它能引发重要的物理效应。您将运用经典统计力学和微扰理论，计算一个在一维非谐势中运动的粒子的平均位置 ([@problem_id:2015523])，这个看似简单的结果直接揭示了热膨胀等现象的微观起源。", "problem": "一个质量为 $m$ 的经典粒子在一维空间中运动，其所受势为 $V(x) = \\frac{1}{2} k x^2 + \\alpha x^3$。参数 $k$ 是势的谐振部分的劲度系数，$\\alpha$ 是一个代表弱非谐性的小常数。该粒子与一恒定绝对温度为 $T$ 的热浴处于热平衡状态。\n\n计算该粒子的热平均位置 $\\langle x \\rangle$。你的计算应对非谐性参数 $\\alpha$ 精确到一阶。\n\n将你的答案表示为以 $k$、$\\alpha$、$T$ 和玻尔兹曼常数 $k_B$ 表示的解析表达式。", "solution": "令 $\\beta \\equiv \\frac{1}{k_{B}T}$。在经典正则系综中，计算位置平均值时，动量自由度可以因子化并消去，因此位置的热平均值仅由势决定：\n$$\n\\langle x \\rangle=\\frac{\\int_{-\\infty}^{\\infty} x \\exp\\!\\big(-\\beta V(x)\\big)\\,dx}{\\int_{-\\infty}^{\\infty} \\exp\\!\\big(-\\beta V(x)\\big)\\,dx},\n\\qquad\nV(x)=\\frac{1}{2}k x^{2}+\\alpha x^{3}.\n$$\n将 $\\alpha$ 视为小参数并展开到一阶，\n$$\n\\exp\\!\\big(-\\beta V(x)\\big)=\\exp\\!\\left(-\\beta \\frac{k}{2}x^{2}\\right)\\exp\\!\\left(-\\beta \\alpha x^{3}\\right)\n\\approx \\exp\\!\\left(-\\beta \\frac{k}{2}x^{2}\\right)\\left(1-\\beta \\alpha x^{3}\\right).\n$$\n因此，\n$$\n\\langle x \\rangle \\approx \\frac{\\int x \\exp\\!\\left(-\\beta \\frac{k}{2}x^{2}\\right)\\left(1-\\beta \\alpha x^{3}\\right)\\,dx}{\\int \\exp\\!\\left(-\\beta \\frac{k}{2}x^{2}\\right)\\left(1-\\beta \\alpha x^{3}\\right)\\,dx}.\n$$\n定义 $a\\equiv \\frac{\\beta k}{2}$。利用被积函数的奇偶性，\n$$\n\\int_{-\\infty}^{\\infty} x \\exp(-a x^{2})\\,dx=0,\\qquad \\int_{-\\infty}^{\\infty} x^{3} \\exp(-a x^{2})\\,dx=0,\n$$\n所以对 $\\alpha$ 精确到一阶时，分母不变，分子简化为\n$$\n-\\beta \\alpha \\int_{-\\infty}^{\\infty} x^{4} \\exp(-a x^{2})\\,dx.\n$$\n因此，\n$$\n\\langle x \\rangle \\approx -\\beta \\alpha \\frac{\\int_{-\\infty}^{\\infty} x^{4} \\exp(-a x^{2})\\,dx}{\\int_{-\\infty}^{\\infty} \\exp(-a x^{2})\\,dx}.\n$$\n所需的高斯积分为\n$$\n\\int_{-\\infty}^{\\infty} \\exp(-a x^{2})\\,dx=\\frac{\\sqrt{\\pi}}{\\sqrt{a}},\\qquad\n\\int_{-\\infty}^{\\infty} x^{4} \\exp(-a x^{2})\\,dx=\\frac{3\\sqrt{\\pi}}{4 a^{5/2}},\n$$\n所以它们的比值为\n$$\n\\frac{\\int x^{4} \\exp(-a x^{2})\\,dx}{\\int \\exp(-a x^{2})\\,dx}=\\frac{3}{4 a^{2}}.\n$$\n代入 $a=\\frac{\\beta k}{2}$ 得到\n$$\n\\langle x \\rangle \\approx -\\beta \\alpha \\cdot \\frac{3}{4}\\cdot \\frac{4}{\\beta^{2} k^{2}}=-\\frac{3\\alpha}{\\beta k^{2}}=-\\frac{3 \\alpha k_{B} T}{k^{2}},\n$$\n该结果对 $\\alpha$ 精确到一阶。", "answer": "$$\\boxed{-\\frac{3 \\alpha k_{B} T}{k^{2}}}$$", "id": "2015523"}, {"introduction": "当分子内运动（如甲基的扭转）的势垒与热能相当时，简谐振子近似便会失效。此项高级实践要求您进入现代计算化学的核心领域，通过数值方法直接求解受阻转子的量子哈密顿量 ([@problem_id:2824222])。通过将精确的数值计算结果与简谐近似进行比较，您不仅能掌握一种强大的计算技巧，还能深刻理解近似模型的适用边界及其失效的原因。", "problem": "要求您实现一个数值比较，比较对象是室温下的量子力学受阻内转子与其谐振模式近似。内坐标是一个用角度 $\\theta$（单位为弧度，满足 $0 \\le \\theta &lt; 2\\pi$）描述的角扭转。该系统具有周期性势和一个刚性转动惯量。您的任务是从第一性原理出发，计算受阻转子的无量纲正则配分函数，并将其与通过在势能极小值点附近进行二次展开所得到的谐振模式配分函数进行比较。\n\n使用的基本原理：\n- 对于具有离散量子能级 $\\{E_j\\}$ 的系统，其正则配分函数为 $q = \\sum_{j=0}^{\\infty} \\exp(-\\beta E_j)$，其中 $\\beta = 1/(k_\\mathrm{B} T)$，$k_\\mathrm{B}$ 是 Boltzmann 常数，$T$ 是绝对温度。\n- 对于一个在势 $V(\\theta)$ 中运动、转动惯量为 $I$ 的刚性转子，其在角坐标 $\\theta$ 下的一维量子哈密顿算符为 $\\hat{H} = - \\dfrac{\\hbar^2}{2 I} \\dfrac{d^2}{d\\theta^2} + V(\\theta)$，并受制于 $\\theta$ 的 $2\\pi$ 周期性边界条件。\n- 谐振模式近似是通过将势在极小值点附近展开至二阶，并将运动模拟为频率为 $\\omega$ 的一维量子谐振子而得到的。对于角频率为 $\\omega$ 的谐振子，其能级为 $E_n = \\hbar \\omega \\left(n + \\dfrac{1}{2}\\right)$，$n \\in \\mathbb{N}_0$，这意味着其配分函数为 $q_\\mathrm{harm} = \\dfrac{\\exp(-\\beta \\hbar \\omega/2)}{1 - \\exp(-\\beta \\hbar \\omega)}$。\n\n系统定义：\n- 考虑 $n$ 重周期性余弦势\n$$\nV(\\theta) = \\frac{V_0}{2}\\left[1 - \\cos(n \\theta)\\right],\n$$\n其周期为 $2\\pi$，极小值点位于 $\\theta = \\dfrac{2\\pi k}{n}$（$k$ 为整数）。相邻极小值点之间的势垒高度为 $V_0$。\n- 极小值点附近的谐振角频率由曲率 $k_\\theta = \\left.\\dfrac{d^2 V}{d\\theta^2}\\right|_{\\theta_\\text{min}}$ 和动能项 $\\dfrac{1}{2} I \\dot{\\theta}^2$ 定义为\n$$\n\\omega = \\sqrt{\\frac{k_\\theta}{I}} = \\sqrt{\\frac{n^2 V_0}{2 I}}.\n$$\n- 当势垒相对于 $k_\\mathrm{B} T$ 很大时，为了用谐振势阱近似完整的扭转模式，需将单势阱的谐振配分函数乘以等效极小值的数量 $n$，得到 $q_{\\mathrm{harm,\\,total}} = n \\, q_\\mathrm{harm}$。\n\n受阻转子的数值方法：\n- 在 $[0, 2\\pi)$ 上将 $\\theta$ 离散化为一个包含 $N_\\theta$ 个点的均匀网格，并采用 $2\\pi$ 周期性边界条件。使用 $N_\\theta = 256$。\n- 使用标准的二阶中心有限差分法（带周期性环绕）来近似二阶导数。如果网格间距为 $h = \\dfrac{2\\pi}{N_\\theta}$，则 $\\dfrac{d^2}{d\\theta^2}$ 的离散算符由一个循环矩阵表示，其对角线元素为 $-2/h^2$，最近的非对角线元素为 $1/h^2$，角上元素为 $1/h^2$ 以强制实现周期性。\n- 构建哈密顿矩阵 $H = - \\dfrac{\\hbar^2}{2 I} D^{(2)} + \\mathrm{diag}(V(\\theta_i))$，对其进行对角化以获得本征值 $\\{E_j\\}$，然后计算\n$$\nq_\\mathrm{HR} = \\sum_{j=0}^{N_\\theta - 1} \\exp(-\\beta E_j),\n$$\n作为在温度 $T$ 下对精确 $q$ 的一个精确近似。\n\n常数和单位：\n- 使用 $T = 298\\,\\mathrm{K}$。\n- 使用 $k_\\mathrm{B} = 1.380\\,649 \\times 10^{-23}\\,\\mathrm{J\\,K^{-1}}$ 和 $\\hbar = 1.054\\,571\\,817 \\times 10^{-34}\\,\\mathrm{J\\,s}$。\n- 所有能量，包括 $V_0$ 和本征值 $E_j$，单位必须是 $\\mathrm{J}$/分子。转动惯量 $I$ 的单位必须是 $\\mathrm{kg\\,m^2}$。角度 $\\theta$ 的单位必须是弧度。\n\n计算和比较内容：\n- 对于每个测试用例，按所述方法数值计算受阻转子配分函数 $q_\\mathrm{HR}$。\n- 计算谐振模式配分函数 $q_{\\mathrm{harm,\\,total}} = n \\, \\dfrac{\\exp(-\\beta \\hbar \\omega/2)}{1 - \\exp(-\\beta \\hbar \\omega)}$，其中 $\\omega = \\sqrt{ \\dfrac{n^2 V_0}{2 I} }$。\n- 对于每个测试用例，输出比率\n$$\nR = \\frac{q_\\mathrm{HR}}{q_{\\mathrm{harm,\\,total}}}.\n$$\n\n测试套件：\n- 使用以下四个测试用例，每个用例指定为 $(V_0, I, n)$：\n  - 用例 1：$V_0 = 1.0 \\times 10^{-22}\\,\\mathrm{J}$，$I = 5.0 \\times 10^{-47}\\,\\mathrm{kg\\,m^2}$，$n = 3$。\n  - 用例 2：$V_0 = 4.0 \\times 10^{-21}\\,\\mathrm{J}$，$I = 5.0 \\times 10^{-47}\\,\\mathrm{kg\\,m^2}$，$n = 3$。\n  - 用例 3：$V_0 = 2.0 \\times 10^{-20}\\,\\mathrm{J}$，$I = 5.0 \\times 10^{-47}\\,\\mathrm{kg\\,m^2}$，$n = 3$。\n  - 用例 4：$V_0 = 2.0 \\times 10^{-20}\\,\\mathrm{J}$，$I = 5.0 \\times 10^{-47}\\,\\mathrm{kg\\,m^2}$，$n = 1$。\n\n要求的最终输出格式：\n- 您的程序应生成单行输出，其中包含测试套件的四个比率，以逗号分隔列表的形式置于方括号内，每个比率四舍五入到小数点后恰好六位。例如，输出格式应如下所示\n$$\n[\\text{r}_1,\\text{r}_2,\\text{r}_3,\\text{r}_4],\n$$\n其中每个 $\\text{r}_i$ 是一个小数点后有六位的浮点数，且该行中没有任何空格。", "solution": "所提出的问题是量子统计力学中的一个标准练习，要求对分子内旋转的两种模型进行数值比较：完整的量子受阻转子模型及其简化的谐振模式近似。该问题在科学上是合理的，提法是明确的，并且包含了解决它所需的所有必要信息。因此，我们将着手提供一个完整的解决方案。\n\n目标是为几个测试用例计算比率 $R = q_\\mathrm{HR} / q_{\\mathrm{harm,\\,total}}$，其中 $q_\\mathrm{HR}$ 是一维受阻转子的正则配分函数，$q_{\\mathrm{harm,\\,total}}$ 是其谐振子近似的配分函数。\n\n首先，我们定义热能因子 $\\beta = (k_\\mathrm{B} T)^{-1}$，其中 $k_\\mathrm{B}$ 是 Boltzmann 常数，$T$ 是绝对温度。对于给定的温度 $T = 298\\,\\mathrm{K}$，并使用提供的常数 $k_\\mathrm{B} = 1.380\\,649 \\times 10^{-23}\\,\\mathrm{J\\,K^{-1}}$，我们得到 $\\beta \\approx 2.431\\,66 \\times 10^{20}\\,\\mathrm{J}^{-1}$。\n\n**1. 受阻转子配分函数 ($q_\\mathrm{HR}$)**\n\n内转子的量子力学运动由一维 Schrödinger 方程 $\\hat{H}\\psi(\\theta) = E\\psi(\\theta)$ 控制，其哈密顿算符为：\n$$\n\\hat{H} = - \\frac{\\hbar^2}{2I} \\frac{d^2}{d\\theta^2} + V(\\theta)\n$$\n此处，$\\hbar$ 是约化 Planck 常数，$I$ 是转动惯量，$\\theta$ 是扭转角，$V(\\theta)$ 是由下式给出的周期性势：\n$$\nV(\\theta) = \\frac{V_0}{2}\\left[1 - \\cos(n \\theta)\\right]\n$$\n其中 $V_0$ 是势垒高度，$n$ 是周期数。波函数 $\\psi(\\theta)$ 必须满足 $2\\pi$ 周期性边界条件，即 $\\psi(\\theta) = \\psi(\\theta + 2\\pi)$。\n\n为了求解能量本征值 $\\{E_j\\}$，我们采用数值有限差分法。角坐标 $\\theta \\in [0, 2\\pi)$ 被离散化为一个包含 $N_\\theta = 256$ 个点的均匀网格：$\\theta_i = i \\cdot h$，其中 $i=0, 1, \\dots, N_\\theta-1$，网格间距为 $h = 2\\pi/N_\\theta$。\n\n二阶导数算符 $\\frac{d^2}{d\\theta^2}$ 由一个矩阵 $\\mathbf{D}^{(2)}$ 近似。使用带有周期性边界条件的二阶中心差分公式，这个 $N_\\theta \\times N_\\theta$ 矩阵的元素为：\n$$\n(\\mathbf{D}^{(2)})_{ij} = \\frac{1}{h^2} \\begin{cases} -2 & \\text{if } i=j \\\\ 1 & \\text{if } |i-j|=1 \\\\ 1 & \\text{if } \\{i,j\\} = \\{0, N_\\theta-1\\} \\\\ 0 & \\text{otherwise} \\end{cases}\n$$\n这是一个对称循环矩阵。动能算符变为矩阵 $\\mathbf{T} = -\\frac{\\hbar^2}{2I}\\mathbf{D}^{(2)}$。势能算符变为一个对角矩阵 $\\mathbf{V}$，其元素为 $(\\mathbf{V})_{ii} = V(\\theta_i)$。总哈密顿量由矩阵表示为：\n$$\n\\mathbf{H} = \\mathbf{T} + \\mathbf{V} = -\\frac{\\hbar^2}{2I}\\mathbf{D}^{(2)} + \\mathrm{diag}(V(\\theta_0), V(\\theta_1), \\dots, V(\\theta_{N_\\theta-1}))\n$$\n通过对实对称矩阵 $\\mathbf{H}$ 进行数值对角化，可以找到能量本征值 $\\{E_j\\}$。然后通过对这 $N_\\theta$ 个近似本征值求和来计算受阻转子配分函数：\n$$\nq_\\mathrm{HR} = \\sum_{j=0}^{N_\\theta-1} \\exp(-\\beta E_j)\n$$\n\n**2. 谐振模式配分函数 ($q_{\\mathrm{harm,\\,total}}$)**\n\n谐振近似将系统在每个势阱中的行为建模为量子谐振子。势在 $\\cos(n\\theta) = 1$ 处有极小值，即在 $\\theta_\\text{min} = 2\\pi k/n$（$k$ 为整数）处。我们将 $V(\\theta)$ 在一个极小值点（例如 $\\theta_\\text{min} = 0$）附近展开为 Taylor 级数：\n$$\nV(\\theta) \\approx V(0) + V'(0)(\\theta-0) + \\frac{1}{2}V''(0)(\\theta-0)^2\n$$\n我们得到 $V(0) = 0$，$V'(\\theta) = \\frac{nV_0}{2}\\sin(n\\theta) \\implies V'(0) = 0$，力常数（曲率）为 $k_\\theta = V''(\\theta) = \\frac{n^2 V_0}{2}\\cos(n\\theta) \\implies k_\\theta = V''(0) = \\frac{n^2 V_0}{2}$。势被近似为 $V(\\theta) \\approx \\frac{1}{2}k_\\theta \\theta^2$。\n\n这对应于一个角频率为 $\\omega = \\sqrt{k_\\theta/I}$ 的谐振子。代入 $k_\\theta$ 的表达式：\n$$\n\\omega = \\sqrt{\\frac{n^2 V_0}{2I}}\n$$\n量子谐振子的能级为 $E_m = \\hbar\\omega(m + 1/2)$，$m=0, 1, 2, \\dots$。单个此类谐振子的配分函数是一个几何级数：\n$$\nq_\\mathrm{harm} = \\sum_{m=0}^{\\infty} \\exp\\left[-\\beta\\hbar\\omega\\left(m + \\frac{1}{2}\\right)\\right] = \\exp(-\\beta\\hbar\\omega/2) \\sum_{m=0}^{\\infty} (\\exp(-\\beta\\hbar\\omega))^m = \\frac{\\exp(-\\beta\\hbar\\omega/2)}{1 - \\exp(-\\beta\\hbar\\omega)}\n$$\n由于势 $V(\\theta)$ 在区间 $[0, 2\\pi)$ 内有 $n$ 个等效极小值，我们将单势阱的配分函数乘以 $n$ 以获得总谐振模式配分函数，这里假设势垒 $V_0$ 足够大，可以认为势阱是相互独立的：\n$$\nq_{\\mathrm{harm,\\,total}} = n \\cdot q_\\mathrm{harm}\n$$\n\n**3. 比率**\n\n对于每个由 $(V_0, I, n)$ 指定的测试用例，我们使用上述方法和常数计算 $q_\\mathrm{HR}$ 和 $q_{\\mathrm{harm,\\,total}}$。最终结果是它们的比率：\n$$\nR = \\frac{q_\\mathrm{HR}}{q_{\\mathrm{harm,\\,total}}}\n$$\n该比率量化了真实量子系统与其谐振近似之间的偏差。比率 $R \\approx 1$ 表示谐振近似是准确的，这在势垒很高（$V_0 \\gg k_\\mathrm{B}T$）的情况下是符合预期的。对于低势垒（$V_0 \\ll k_\\mathrm{B}T$），系统接近自由转子，而基于局域势阱的谐振近似预计会失效，导致比率显著偏离1。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the ratio of the hindered rotor and harmonic oscillator\n    partition functions for several test cases.\n    \"\"\"\n    # Define physical constants and temperature\n    K_B = 1.380649e-23  # Boltzmann constant in J/K\n    HBAR = 1.054571817e-34 # Reduced Planck constant in J.s\n    T = 298.0  # Temperature in K\n    BETA = 1.0 / (K_B * T)  # Inverse thermal energy in 1/J\n\n    # Numerical grid parameters\n    N_THETA = 256\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (V0 in J, I in kg.m^2, n)\n        (1.0e-22, 5.0e-47, 3), # Case 1\n        (4.0e-21, 5.0e-47, 3), # Case 2\n        (2.0e-20, 5.0e-47, 3), # Case 3\n        (2.0e-20, 5.0e-47, 1), # Case 4\n    ]\n\n    results = []\n    for V0, I, n in test_cases:\n        # --- 1. Hindered Rotor Partition Function (q_HR) Computation ---\n\n        # Discretize the angular coordinate\n        h_theta = 2.0 * np.pi / N_THETA\n        theta_grid = np.linspace(0, 2.0 * np.pi, N_THETA, endpoint=False)\n\n        # Construct the potential energy matrix (diagonal)\n        potential_vector = 0.5 * V0 * (1.0 - np.cos(n * theta_grid))\n        V_matrix = np.diag(potential_vector)\n\n        # Construct the kinetic energy matrix (second derivative)\n        D2 = np.zeros((N_THETA, N_THETA))\n        diag_val = -2.0 / h_theta**2\n        offdiag_val = 1.0 / h_theta**2\n        \n        # Fill diagonal and off-diagonals\n        np.fill_diagonal(D2, diag_val)\n        D2 += np.diag(np.full(N_THETA - 1, offdiag_val), k=1)\n        D2 += np.diag(np.full(N_THETA - 1, offdiag_val), k=-1)\n        \n        # Periodic boundary conditions (corner elements)\n        D2[0, N_THETA - 1] = offdiag_val\n        D2[N_THETA - 1, 0] = offdiag_val\n\n        # Kinetic energy matrix\n        T_matrix = - (HBAR**2 / (2.0 * I)) * D2\n\n        # Construct the full Hamiltonian matrix\n        H_matrix = T_matrix + V_matrix\n\n        # Diagonalize the Hamiltonian to find energy eigenvalues\n        # np.linalg.eigh is used as the matrix is real and symmetric\n        eigenvalues = np.linalg.eigh(H_matrix)[0]\n\n        # Compute the partition function from eigenvalues\n        q_hr = np.sum(np.exp(-BETA * eigenvalues))\n\n        # --- 2. Harmonic-Mode Partition Function (q_harm_total) Computation ---\n\n        # If V0 is zero, the harmonic approximation is ill-defined.\n        # This problem has V0 > 0, so no special handling is needed.\n        # Calculate harmonic angular frequency omega\n        omega = np.sqrt((n**2 * V0) / (2.0 * I))\n\n        # Calculate the single-well harmonic partition function\n        x = BETA * HBAR * omega\n        q_harm = np.exp(-x / 2.0) / (1.0 - np.exp(-x))\n\n        # Total partition function is n times the single-well function\n        q_harm_total = n * q_harm\n\n        # --- 3. Compute and store the ratio ---\n        ratio = q_hr / q_harm_total\n        results.append(f\"{ratio:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "2824222"}]}