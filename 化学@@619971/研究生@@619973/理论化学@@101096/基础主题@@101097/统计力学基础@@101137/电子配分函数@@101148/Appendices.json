{"hands_on_practices": [{"introduction": "电子配分函数 $q_e$ 本质上是所有可及电子态的求和。然而，在低温极限下，热能不足以布居激发态，这使得配分函数收敛到一个简单而关键的值：基态的简并度 $g_0$。本练习 [@problem_id:2010232] 提供了从第一性原理确定该值的必要实践，要求您应用洪德定则来寻找一个多电子离子的基态光谱项。掌握这项技能可以巩固原子结构的量子力学模型与其热力学推论之间的联系。", "problem": "考虑一个处于热平衡状态的气态钒(III)离子 (V$^{3+}$) 系统。一个 V$^{3+}$ 离子的电子构型是 [Ar]3d$^2$。在天体物理学和等离子体诊断学的许多应用中，理解电子能态的布居情况至关重要，而这由电子配分函数所描述。在低温极限下，电子配分函数主要由电子基态的简并度决定。\n\n在此低温极限下，单个 V$^{3+}$ 离子的电子配分函数的值是多少？\n\nA. 3\n\nB. 5\n\nC. 7\n\nD. 9\n\nE. 21", "solution": "该问题要求计算在低温极限下，一个气态 V$^{3+}$ 离子的电子配分函数 $q_E$。电子配分函数通常定义为对所有电子能级 $i$ 的求和：\n$$q_E = \\sum_{i} g_i \\exp\\left(-\\frac{\\epsilon_i}{k_B T}\\right)$$\n其中 $g_i$ 是能级 $i$ 的简并度，$\\epsilon_i$ 是其能量，$k_B$ 是玻尔兹曼常数，$T$ 是温度。\n\n在低温极限下 ($T \\to 0$)，对于任何能量 $\\epsilon_i$ 高于基态能量 $\\epsilon_0$ 的能级，指数项 $\\exp(-\\epsilon_i / k_B T)$ 都趋近于零。因此，只有基态项 ($i=0$) 对求和有贡献。按照惯例，我们将基态能量设为零，即 $\\epsilon_0 = 0$。配分函数简化为：\n$$q_E(T \\to 0) \\approx g_0 \\exp\\left(-\\frac{\\epsilon_0}{k_B T}\\right) = g_0 \\exp(0) = g_0$$\n因此，我们需要求出电子基态的简并度 $g_0$。该简并度由基态的总角动量量子数 $J$ 决定，其关系式为 $g_J = 2J+1$。我们可以通过洪特规则 (Hund's rules) 确定给定电子构型 [Ar]3d$^2$ 的基态光谱支项符号，从而找到基态及其 $J$ 值。\n\n价电子是 3d 亚层中的两个电子。对于 d 轨道，轨道角动量量子数为 $l=2$。五个 d 轨道对应于磁量子数 $m_l = -2, -1, 0, +1, +2$。\n\n**第一步：应用洪特第一规则 (Hund's First Rule) 使总自旋 S 最大化。**\n为使 S 最大化，两个电子必须以平行自旋的方式占据不同的轨道。\n$$S = s_1 + s_2 = \\frac{1}{2} + \\frac{1}{2} = 1$$\n自旋多重度为 $2S+1 = 2(1)+1 = 3$。\n\n**第二步：应用洪特第二规则 (Hund's Second Rule)，在给定 S 的情况下，使总轨道角动量 L 最大化。**\n为使 $L = \\sum m_l$ 最大化，我们将两个电子置于具有最大可能 $m_l$ 值的轨道中。\n$$L = m_{l1} + m_{l2} = (+2) + (+1) = 3$$\n$L=3$ 这个值对应的光谱支项符号字母代码是 'F' (其中 $L=0, 1, 2, 3, ...$ 分别对应于 S, P, D, F, ...)。将此与自旋多重度结合，我们得到基态光谱项为 $^3F$。\n\n**第三步：应用洪特第三规则 (Hund's Third Rule) 求总角动量 J。**\nJ 的可能值由 Clebsch-Gordan 级数给出：$J = |L-S|, |L-S|+1, \\ldots, L+S$。\n当 $L=3$ 且 $S=1$ 时，J 的可能值为：\n$$J = |3-1|, |3-1|+1, \\ldots, 3+1 \\implies J = 2, 3, 4$$\n这些 $J$ 值对应于 $^3F$ 光谱项的精细结构能级。对于未充满一半的亚层（3d 亚层有 2 个电子，少于半满容量 5），基能级是 J 值最小的那个能级。在本例中，最小的 $J$ 值为 2。\n因此，包含 J 能级的基态光谱支项符号是 $^3F_2$。\n\n**第四步：计算基态的简并度。**\n基态的简по度 $g_0$ 由 $2J+1$ 给出，其中 J 是基能级的总角动量量子数。\n对于 $^3F_2$ 能级，$J=2$。\n$$g_0 = 2J+1 = 2(2)+1 = 5$$\n\n**第五步：确定低温配分函数。**\n如前所述，$q_E(T \\to 0) = g_0$。\n$$q_E = 5$$\n其他选项对应于一些常见的误解：\n- A. 3 是自旋多重度 $2S+1$。\n- C. 7 是轨道简并度 $2L+1$。\n- D. 9 是最高 J 能级 ($J=4$) 的简并度，$2(4)+1=9$。\n- E. 21 是整个 $^3F$ 光谱项的总简并度，$(2S+1)(2L+1) = 3 \\times 7 = 21$。\n\n正确答案是 5。", "answer": "$$\\boxed{B}$$", "id": "2010232"}, {"introduction": "配分函数的真正威力在于它扮演着从量子态的微观世界到可测量热力学性质的宏观世界的桥梁角色。虽然计算 $q_e$ 本身是关键一步，但最终目标通常是推导如内能、熵或热容等物理量。本练习 [@problem_id:492175] 聚焦于这一核心应用，引导您为一个具有精细结构分裂的系统计算电子对摩尔内能的贡献。这个二级系统作为一个清晰且基础的例子，展示了统计力学如何将态能量和简并度转化为可观测的热力学数据。", "problem": "考虑一种由氟 (F) 原子组成的理想单原子气体，在温度 $T$ 下处于热平衡状态。一个氟原子的电子基态构型 ($1s^2 2s^2 2p^5$) 因自旋-轨道相互作用而分裂成两个精细结构能级。基态能级由光谱项符号 $^2P_{3/2}$ 表征，而第一电子激发能级由光谱项符号 $^2P_{1/2}$ 表征。这两个能级之间的能量差为 $\\Delta E$。对于所考虑的温度 $T$，可以做一个有效的近似，即假设所有更高的电子能级都未被占据。\n\n你的任务是计算该气体摩尔内能的电子贡献 $U_{m,el}$。将你的答案表示为一个关于能量差 $\\Delta E$、温度 $T$、Avogadro 数 $N_A$ 和 Boltzmann 常数 $k_B$ 的闭合形式的解析表达式。", "solution": "1. 相关方程\n   对于一个能量为 $E_0=0$，$E_1=\\Delta E$，简并度为 $g_0, g_1$ 的双能级系统，其单个原子的配分函数为\n   $$\n   Z \\;=\\; g_0 + g_1 e^{-\\beta\\Delta E},\n   \\quad \\beta = \\frac1{k_B T}.\n   $$  \n   单个原子的平均电子能量为\n   $$\n   \\langle E_{\\rm el}\\rangle \n   = \\frac{1}{Z}\\sum_i g_i E_i e^{-\\beta E_i}\n   = \\frac{g_1\\,\\Delta E\\,e^{-\\beta\\Delta E}}{g_0 + g_1\\,e^{-\\beta\\Delta E}}.\n   $$  \n   摩尔电子内能为 $U_{m,el}=N_A\\langle E_{\\rm el}\\rangle$。\n\n2. 应用于氟的精并结构能级：\n   $g_0=2J_0+1=2\\cdot\\frac32+1=4$,  \n   $g_1=2J_1+1=2\\cdot\\frac12+1=2$.  \n   因此\n   $$\n   Z = 4 + 2 e^{-\\beta\\Delta E},\n   \\qquad\n   \\langle E_{\\rm el}\\rangle\n   = \\frac{2\\,\\Delta E\\,e^{-\\beta\\Delta E}}{4 + 2\\,e^{-\\beta\\Delta E}}\n   = \\Delta E\\;\\frac{e^{-\\beta\\Delta E}}{2 + e^{-\\beta\\Delta E}}.\n   $$\n\n3. 乘以 Avogadro 数：\n   $$\n   U_{m,el} = N_A\\,\\Delta E\\;\\frac{e^{-\\Delta E/(k_B T)}}{2 + e^{-\\Delta E/(k_B T)}}.\n   $$", "answer": "$$\\boxed{N_A\\,\\Delta E\\,\\frac{e^{-\\Delta E/(k_B T)}}{2 + e^{-\\Delta E/(k_B T)}}}$$", "id": "492175"}, {"introduction": "在现代理论化学中，概念必须被转化为稳健的计算工作流程。用于构建配分函数的能级通常来自 *ab initio* 计算，这些计算本身就带有统计不确定性。这个高级练习 [@problem_id:2812910] 模拟了一个真实世界的研究任务：实现一个计算电子配分函数的程序，并关键地，将输入能级的不确定性传播到 $q_e$ 的最终值。这种实践不仅巩固了统计力学的原理，还培养了计算科学中不确定性量化的重要技能。", "problem": "一名开发者被要求实现一个完全可复现的计算工作流，用于从一小组绝热电子能级构建分子的电子配分函数，并将能级能量的不确定度传播到配分函数中。此任务必须从统计力学的第一性原理出发解决，不使用任何预先构建的用于不确定度传播的符号代数工具。\n\n从正则系综和离散态的玻尔兹曼分布的定义出发，将电子态集合视为具有简并度的离散谱。报告的能量是相对于最低能量态的绝热电子能量，带有从头计算得出的统计不确定度。您必须：\n\n1) 从玻尔兹曼分布和正则配分函数作为态概率归一化因子的定义出发，推导出一个关于电子配分函数 $q_{e}(T)$ 的表达式。该表达式适用于一组由 $i$ 标记的离散态，每个态具有简并度 $g_{i}$ 和能量 $E_{i}$。推导过程必须清楚地说明简并度如何引入，以及对微观态的求和如何简化为对电子态的不同能级的求和。\n\n2) 假设报告的能量以波数 $\\tilde{\\nu}_{i}$ 给出，单位为 $\\mathrm{cm}^{-1}$，并且这些能量通过 $E_{i}=\\left(h\\,c\\right)\\left(100\\right)\\tilde{\\nu}_{i}$ 与能量相关联，其中 $h$ 是普朗克常数，$c$ 是真空光速。使用玻尔兹曼常数 $k_{\\mathrm{B}}$ 和绝对温度 $T$（单位为开尔文）。定义转换常数 $\\alpha=\\dfrac{h\\,c}{k_{\\mathrm{B}}}\\times 100$，使得 $E_{i}/\\left(k_{\\mathrm{B}}T\\right)=\\alpha\\,\\tilde{\\nu}_{i}/T$。在本练习中，所有常数都必须视为精确值，使用其国际单位制（SI）的值：$h=6.62607015\\times 10^{-34}\\,\\mathrm{J\\,s}$，$c=299792458\\,\\mathrm{m\\,s^{-1}}$，$k_{\\mathrm{B}}=1.380649\\times 10^{-23}\\,\\mathrm{J\\,K^{-1}}$。\n\n3) 使用基于偏导数的线性（一阶）不确定度传播方法，传播波数 $\\sigma_{\\tilde{\\nu}_{i}}$ 中独立的、高斯的、一倍标准差的不确定度，以获得 $q_{e}(T)$ 的一倍标准差不确定度 $\\sigma_{q}$。将简并度 $g_{i}$ 视为没有不确定度的精确整数。使用链式法则表示对 $\\tilde{\\nu}_{i}$ 的导数，并用 $\\alpha$, $T$, $\\tilde{\\nu}_{i}$, $g_{i}$ 和 $\\sigma_{\\tilde{\\nu}_{i}}$ 完全表示最终公式。\n\n4) 实现一个程序，该程序：\n- 从提供的数据计算 $q_{e}(T)$ 及其传播的一倍标准差不确定度 $\\sigma_{q}$，\n- 仅使用上述常数进行单位转换，\n- 生成四舍五入到 $6$ 位小数的数值结果。\n\n单位：配分函数 $q_{e}(T)$ 及其不确定度 $\\sigma_{q}$ 是无量纲的。确保所有中间计算都遵循上述单位转换。\n\n角度单位：不涉及。\n\n百分比：不涉及。\n\n测试套件：您的程序必须为以下三种情况计算 $q_{e}(T)$ 和 $\\sigma_{q}$。在每种情况下，状态列表是一个由三元组 $(\\tilde{\\nu}_{i},g_{i},\\sigma_{\\tilde{\\nu}_{i}})$ 组成的序列，其中 $\\tilde{\\nu}_{i}$ 的单位是 $\\mathrm{cm}^{-1}$，$g_{i}$ 是无量纲的，$\\sigma_{\\tilde{\\nu}_{i}}$ 的单位是 $\\mathrm{cm}^{-1}$。\n\n- 情况 A（低温，基态主导）：$T=50\\,\\mathrm{K}$，状态为\n  $[(0,2,0.5),(1200,1,30),(5000,3,100)]$。\n- 情况 B（中温，多个低位激发态相关）：$T=1000\\,\\mathrm{K}$，状态为\n  $[(0,1,1),(400,2,10),(1200,3,30),(10000,1,200)]$。\n- 情况 C（高温，近简并和高位能态）：$T=5000\\,\\mathrm{K}$，状态为\n  $[(0,1,2),(100,1,5),(110,2,4),(9000,4,50),(15000,2,200)]$。\n\n最终输出规范：您的程序应生成单行输出，包含一个用方括号括起来的逗号分隔列表形式的结果，其中每个元素本身是一个双元素列表 $[q_{e},\\sigma_{q}]$，用于一个测试用例，两者都四舍五入到 $6$ 位小数。例如，输出格式必须是\n$[[q_{A},\\sigma_{A}],[q_{B},\\sigma_{B}],[q_{C},\\sigma_{C}]]$\n不含任何额外的字符或行。", "solution": "首先对用户提供的问题进行严格的验证过程。\n\n步骤 1：提取已知条件\n- 系统由正则系综和一组离散电子态的玻尔兹曼分布描述。\n- 每个态 $i$ 由一个简并度 $g_{i}$ 和一个相对于最低能量态的能量 $E_{i}$ 表征。\n- 能量以波数 $\\tilde{\\nu}_{i}$ 的形式提供，单位为 $\\mathrm{cm}^{-1}$。\n- 能量与波数的关系为 $E_{i}=\\left(h\\,c\\right)\\left(100\\right)\\tilde{\\nu}_{i}$。\n- 常数被视为精确值：$h=6.62607015\\times 10^{-34}\\,\\mathrm{J\\,s}$，$c=299792458\\,\\mathrm{m\\,s^{-1}}$，$k_{\\mathrm{B}}=1.380649\\times 10^{-23}\\,\\mathrm{J\\,K^{-1}}$。\n- 定义了一个转换常数 $\\alpha=\\dfrac{h\\,c}{k_{\\mathrm{B}}}\\times 100$。\n- 玻尔兹曼因子中的指数为 $E_{i}/\\left(k_{\\mathrm{B}}T\\right)=\\alpha\\,\\tilde{\\nu}_{i}/T$，其中 $T$ 是绝对温度（单位：开尔文）。\n- 波数 $\\tilde{\\nu}_{i}$ 具有独立的、高斯的、一倍标准差的不确定度 $\\sigma_{\\tilde{\\nu}_{i}}$。\n- 简并度 $g_{i}$ 是精确整数。\n- 电子配分函数的不确定度 $\\sigma_{q}$ 必须使用一阶不确定度传播方法确定。\n- 测试用例 A：$T=50\\,\\mathrm{K}$，状态为 $[(0,2,0.5),(1200,1,30),(5000,3,100)]$。\n- 测试用例 B：$T=1000\\,\\mathrm{K}$，状态为 $[(0,1,1),(400,2,10),(1200,3,30),(10000,1,200)]$。\n- 测试用例 C：$T=5000\\,\\mathrm{K}$，状态为 $[(0,1,2),(100,1,5),(110,2,4),(9000,4,50),(15000,2,200)]$。\n\n步骤 2：使用提取的已知条件进行验证\n- **科学基础扎实：** 该问题牢固地植根于统计力学原理，特别是正则系综。配分函数和玻尔兹曼统计的定义都是标准的。不确定度传播方法也是一种标准的数学技术。所有前提在事实上和科学上都是合理的。\n- **提法恰当：** 该问题提供了推导所需表达式和计算数值答案所需的所有必要数据、常数和函数关系。它指定了要使用的方法（一阶不确定度传播）和期望的输出格式，从而导出一个唯一且有意义的解。\n- **客观性：** 问题陈述使用精确、定量和明确的语言。没有主观或基于意见的成分。\n\n步骤 3：结论与行动\n该问题被认定为有效。它是自洽的、科学合理的且提法恰当。将提供一个完整的解决方案。\n\n**推导和求解方法**\n\n**1. 电子配分函数 $q_{e}(T)$ 的推导**\n在正则系综中，系统处于能量为 $\\epsilon_{j}$ 的特定量子微观态 $j$ 的概率 $P_{j}$ 由玻尔兹曼分布给出：\n$$\nP_{j} = \\frac{\\exp(-\\beta \\epsilon_{j})}{Q}\n$$\n其中 $\\beta = 1/(k_{\\mathrm{B}}T)$，$Q$ 是正则配分函数，作为归一化常数，确保所有概率之和为一：$\\sum_{j} P_{j} = 1$。求和遍及系统的所有可及微观态。\n因此，配分函数定义为：\n$$\nQ = \\sum_{\\text{微观态 } j} \\exp(-\\beta \\epsilon_{j})\n$$\n对于一个分子，总能量可以划分为来自不同自由度（电子、振动、转动、平动）的贡献。在这里，我们只关心电子贡献，其配分函数表示为 $q_{e}$。能量是一组离散的电子能级，由索引 $i$ 标记。一个给定的能级 $E_{i}$ 可能是简并的，意味着有 $g_{i}$ 个不同的量子态（微观态）共享此相同能量。\n为了将对所有微观态的求和转换​​为对不同能级的求和，我们将对应于相同能量 $E_{i}$ 的所有项组合在一起。对于每个能级 $i$，有 $g_{i}$ 个这样的项，每一项都等于 $\\exp(-\\beta E_{i})$。因此，求和变为：\n$$\nq_{e}(T) = \\sum_{\\text{能级 } i} g_{i} \\exp(-\\beta E_{i})\n$$\n这是电子配分函数以能级 $E_{i}$ 及其简并度 $g_{i}$ 表示的所需表达式。\n\n**2. 以波数 $\\tilde{\\nu}_{i}$ 表示的表达式**\n问题以波数 $\\tilde{\\nu}_{i}$（单位 $\\mathrm{cm}^{-1}$）的形式给出能量，$E_{i} = (h c)(100)\\tilde{\\nu}_{i}$。因子 $100$ 将 $\\mathrm{cm}^{-1}$ 转换为国际单位制（SI）的 $\\mathrm{m}^{-1}$。指数的参数 $-\\beta E_{i}$ 可以重写为：\n$$\n-\\beta E_{i} = -\\frac{E_{i}}{k_{\\mathrm{B}}T} = -\\frac{(h c)(100)\\tilde{\\nu}_{i}}{k_{\\mathrm{B}}T}\n$$\n问题定义了一个转换常数 $\\alpha = \\frac{hc}{k_{\\mathrm{B}}} \\times 100$。使用给定的基本常数值：\n$$\nh = 6.62607015 \\times 10^{-34}\\,\\mathrm{J\\,s} \\\\\nc = 299792458\\,\\mathrm{m\\,s^{-1}} \\\\\nk_{\\mathrm{B}} = 1.380649 \\times 10^{-23}\\,\\mathrm{J\\,K^{-1}}\n$$\n$\\alpha$ 的值为：\n$$\n\\alpha = \\frac{(6.62607015 \\times 10^{-34}\\,\\mathrm{J\\,s}) \\times (299792458\\,\\mathrm{m\\,s^{-1}})}{1.380649 \\times 10^{-23}\\,\\mathrm{J\\,K^{-1}}} \\times 100\\,\\mathrm{m^{-1}/cm^{-1}} \\approx 1.438776877\\,\\mathrm{K\\,cm}\n$$\n$\\alpha$ 的单位使得 $\\alpha \\tilde{\\nu}_{i}$ 的单位为温度（开尔文），因此比率 $\\alpha \\tilde{\\nu}_{i} / T$ 是无量纲的，符合指数的要求。使用此常数，指数的参数简化为 $-\\alpha \\tilde{\\nu}_{i} / T$。\n配分函数则表示为：\n$$\nq_{e}(T, \\{\\tilde{\\nu}_{i}\\}) = \\sum_{i} g_{i} \\exp\\left(-\\frac{\\alpha \\tilde{\\nu}_{i}}{T}\\right)\n$$\n\n**3. 不确定度传播**\n问题要求找到由于测量波数 $\\tilde{\\nu}_{i}$ 中的不确定度 $\\sigma_{\\tilde{\\nu}_{i}}$ 导致的 $q_{e}$ 的一倍标准差不确定度 $\\sigma_{q}$。对于一个函数 $f(x_{1}, x_{2}, \\dots, x_{N})$，独立不确定度的线性传播通用公式为：\n$$\n\\sigma_{f}^{2} = \\sum_{i=1}^{N} \\left(\\frac{\\partial f}{\\partial x_{i}}\\right)^{2} \\sigma_{x_{i}}^{2}\n$$\n在我们的情况下，函数是 $q_{e}$，具有不确定度的变量是波数集合 $\\{\\tilde{\\nu}_{i}\\}$。温度 $T$ 和简并度 $g_{i}$ 被视为精确值。因此，不确定度的平方 $\\sigma_{q}^{2}$ 为：\n$$\n\\sigma_{q}^{2} = \\sum_{i} \\left(\\frac{\\partial q_{e}}{\\partial \\tilde{\\nu}_{i}}\\right)^{2} \\sigma_{\\tilde{\\nu}_{i}}^{2}\n$$\n我们必须计算 $q_{e}$ 对单个波数 $\\tilde{\\nu}_{i}$ 的偏导数。由于 $q_{e}$ 求和中的各项相对于不同的 $\\tilde{\\nu}_{j}$ 是独立的，因此对 $\\tilde{\\nu}_{i}$ 的导数只影响第 $i$ 项：\n$$\n\\frac{\\partial q_{e}}{\\partial \\tilde{\\nu}_{i}} = \\frac{\\partial}{\\partial \\tilde{\\nu}_{i}} \\left[ g_{i} \\exp\\left(-\\frac{\\alpha \\tilde{\\nu}_{i}}{T}\\right) \\right]\n$$\n使用链式法则，此导数为：\n$$\n\\frac{\\partial q_{e}}{\\partial \\tilde{\\nu}_{i}} = g_{i} \\exp\\left(-\\frac{\\alpha \\tilde{\\nu}_{i}}{T}\\right) \\cdot \\frac{\\partial}{\\partial \\tilde{\\nu}_{i}}\\left(-\\frac{\\alpha \\tilde{\\nu}_{i}}{T}\\right) = g_{i} \\exp\\left(-\\frac{\\alpha \\tilde{\\nu}_{i}}{T}\\right) \\cdot \\left(-\\frac{\\alpha}{T}\\right)\n$$\n将此代回 $\\sigma_{q}^{2}$ 的表达式中：\n$$\n\\sigma_{q}^{2} = \\sum_{i} \\left[ g_{i} \\left(-\\frac{\\alpha}{T}\\right) \\exp\\left(-\\frac{\\alpha \\tilde{\\nu}_{i}}{T}\\right) \\right]^{2} \\sigma_{\\tilde{\\nu}_{i}}^{2}\n$$\n简化平方项得到：\n$$\n\\sigma_{q}^{2} = \\sum_{i} g_{i}^{2} \\left(\\frac{\\alpha}{T}\\right)^{2} \\exp\\left(-2\\frac{\\alpha \\tilde{\\nu}_{i}}{T}\\right) \\sigma_{\\tilde{\\nu}_{i}}^{2}\n$$\n我们可以提出公因子 $(\\alpha/T)^{2}$：\n$$\n\\sigma_{q}^{2} = \\left(\\frac{\\alpha}{T}\\right)^{2} \\sum_{i} g_{i}^{2} \\sigma_{\\tilde{\\nu}_{i}}^{2} \\exp\\left(-2\\frac{\\alpha \\tilde{\\nu}_{i}}{T}\\right)\n$$\n一倍标准差不确定度 $\\sigma_{q}$ 的最终表达式是此数量的平方根：\n$$\n\\sigma_{q} = \\frac{\\alpha}{T} \\sqrt{ \\sum_{i} g_{i}^{2} \\sigma_{\\tilde{\\nu}_{i}}^{2} \\exp\\left(-2\\frac{\\alpha \\tilde{\\nu}_{i}}{T}\\right) }\n$$\n此公式完全按照要求，用指定的参数 $\\alpha$, $T$, $\\tilde{\\nu}_{i}$, $g_{i}$ 和 $\\sigma_{\\tilde{\\nu}_{i}}$ 表示了 $\\sigma_q$。\n\n**4. 实现**\n推导出的公式将在一个 Python 程序中实现，以计算给定测试用例的 $q_{e}(T)$ 和 $\\sigma_{q}$。该程序将使用提供的物理常数的精确值来计算 $\\alpha$，然后将 $q_e$ 和 $\\sigma_q$ 的表达式应用于每个测试用例。结果将四舍五入到 $6$ 位小数。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\n# from scipy import ...\n\ndef solve():\n    \"\"\"\n    Computes the electronic partition function and its uncertainty for given molecular states.\n    \"\"\"\n    # Define physical constants as exact values per the problem statement.\n    H_PLANCK = 6.62607015e-34  # J s\n    C_LIGHT = 299792458.0      # m/s\n    K_BOLTZMANN = 1.380649e-23   # J/K\n\n    # Calculate the conversion constant alpha. The factor of 100 converts cm^-1 to m^-1.\n    # alpha has units of K*cm.\n    ALPHA = (H_PLANCK * C_LIGHT / K_BOLTZMANN) * 100.0\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (Temperature in K, list of states).\n    # Each state is a tuple: (wavenumber in cm^-1, degeneracy, uncertainty in cm^-1).\n    test_cases = [\n        (50.0, [(0.0, 2, 0.5), (1200.0, 1, 30.0), (5000.0, 3, 100.0)]),\n        (1000.0, [(0.0, 1, 1.0), (400.0, 2, 10.0), (1200.0, 3, 30.0), (10000.0, 1, 200.0)]),\n        (5000.0, [(0.0, 1, 2.0), (100.0, 1, 5.0), (110.0, 2, 4.0), (9000.0, 4, 50.0), (15000.0, 2, 200.0)])\n    ]\n\n    results = []\n    \n    # Process each test case.\n    for T, states in test_cases:\n        # Initialize partition function and the sum for its squared uncertainty.\n        q_e = 0.0\n        sigma_q_squared_sum = 0.0\n\n        # Sum over all electronic states for the given case.\n        for nu_i, g_i, sigma_nu_i in states:\n            # Argument for the exponential function.\n            exponent_arg = -ALPHA * nu_i / T\n            \n            # exponential term common to both calculations\n            boltzmann_factor = np.exp(exponent_arg)\n\n            # Calculate contribution to the partition function q_e.\n            # q_e = sum(g_i * exp(-alpha * nu_i / T))\n            q_e += g_i * boltzmann_factor\n\n            # Calculate contribution to the uncertainty sum.\n            # sigma_q^2 = (alpha/T)^2 * sum(g_i^2 * sigma_nu_i^2 * exp(-2 * alpha * nu_i / T))\n            # The exponential term exp(-2*arg) is simply (exp(-arg))^2.\n            sigma_q_squared_sum += (g_i * sigma_nu_i)**2 * boltzmann_factor**2\n\n        # Finalize the uncertainty calculation.\n        sigma_q = (ALPHA / T) * np.sqrt(sigma_q_squared_sum)\n\n        # Round results to 6 decimal places as specified.\n        q_e_rounded = round(q_e, 6)\n        sigma_q_rounded = round(sigma_q, 6)\n        \n        results.append([q_e_rounded, sigma_q_rounded])\n\n    # Format the output string exactly as specified in the problem.\n    # The requirement is to produce a list of lists, which is the default\n    # string representation of a list of lists in Python.\n    output_str = str(results).replace(\" \", \"\")\n    \n    # Final print statement in the exact required format.\n    print(output_str)\n\nsolve()\n```", "id": "2812910"}]}