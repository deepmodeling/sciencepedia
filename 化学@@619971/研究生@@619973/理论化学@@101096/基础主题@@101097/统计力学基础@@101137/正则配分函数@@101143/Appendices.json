{"hands_on_practices": [{"introduction": "第一个练习旨在巩固构建正则配分函数的基本原则。通过分析一个由可分辨、无相互作用的粒子组成的系统，你将练习应用单粒子配分函数的核心定义 $z = \\sum_i g_i e^{-\\beta E_i}$，并考虑能级的简并度。这个问题 [@problem_id:1996263] 是关键的第一步，它展示了对于此类系统，总配分函数 $Z$ 如何方便地分解为乘积形式，这是统计力学中的一个基石概念。", "problem": "考虑一个描述晶格缺陷的简化模型。该系统由$N$个相同的、无相互作用的缺陷组成，这些缺陷固定在晶格中的特定位置上，因此是可分辨的。每个缺陷可以处于两个能级之一。基态的能量定义为$0$。还有一个能量为 $\\epsilon > 0$ 的激发态。量子力学分析表明，基态是非简并的，而激发态是双重简并的，这意味着存在两个不同的量子态共享相同的能量$\\epsilon$。整个晶体与一个恒定绝对温度为$T$的热库保持热平衡。\n\n你的任务是求出这个由$N$个缺陷组成的整个系统的正则配分函数$Z$。将答案表示为一个以$N$、$\\epsilon$、$T$和玻尔兹曼常数$k_B$表示的闭合形式解析表达式。", "solution": "我们使用正则系综来分析该系统。对于一个由可分辨、无相互作用的组分构成的系统，其正则配分函数可以因子分解为单个组分配分函数的乘积。因此，如果$z$表示单个缺陷的配分函数，那么$N$个可分辨、无相互作用的缺陷的总配分函数由下式给出\n$$\nZ = z^{N}.\n$$\n对于一个具有分立能级及相应简并度的单个缺陷，其正则配分函数由对所有微观状态的求和给出，\n$$\nz = \\sum_{i} g_{i} \\exp\\left(-\\frac{E_{i}}{k_{B} T}\\right),\n$$\n其中$g_{i}$是能量为$E_{i}$的能级的简并度。在这个问题中，有两个能级：一个能量为$E_{0}=0$且简并度为$g_{0}=1$的非简并基态，以及一个能量为$E_{1}=\\epsilon$且简并度为$g_{1}=2$的双重简并激发态。将这些值代入$z$的表达式，得到\n$$\nz = 1 \\cdot \\exp\\left(-\\frac{0}{k_{B} T}\\right) + 2 \\cdot \\exp\\left(-\\frac{\\epsilon}{k_{B} T}\\right) = 1 + 2 \\exp\\left(-\\frac{\\epsilon}{k_{B} T}\\right).\n$$\n利用$N$个可分辨、无相互作用缺陷的因子分解性质，总正则配分函数为\n$$\nZ = \\left(1 + 2 \\exp\\left(-\\frac{\\epsilon}{k_{B} T}\\right)\\right)^{N}.\n$$\n这就是所要求的以$N$、$\\epsilon$、$T$和$k_B$表示的闭合形式解析表达式。", "answer": "$$\\boxed{\\left(1 + 2 \\exp\\left(-\\frac{\\epsilon}{k_{B} T}\\right)\\right)^{N}}$$", "id": "1996263"}, {"introduction": "超越简单的无相互作用模型，本实践将探索配分函数如何包含深刻的量子力学效应。我们将研究处于双阱势中的粒子，这是一个理解化学异构化反应的经典模型。这个问题 [@problem_id:2812016] 挑战你思考量子隧穿如何解除能级简并、重塑系统的低温行为，并引入对于高等化学物理至关重要的非微扰概念。", "problem": "考虑一个对称的一维双势阱势 $V(x)$，其极小值点位于 $x=\\pm a$。每个极小值点附近的曲率相同，由质量 $m$ 和小振幅频率 $\\omega_0$ 表征。设势垒顶点位于 $x=0$ 处，高度为 $V_b > 0$。量子哈密顿量为 $\\hat H=\\hat p^2/(2m)+V(\\hat x)$，正则配分函数定义为 $Q(\\beta)=\\mathrm{Tr}\\, e^{-\\beta \\hat H}$，其中 $\\beta=(k_{\\mathrm B} T)^{-1}$，$k_{\\mathrm B}$ 是玻尔兹曼常数，$\\hbar$ 是约化普朗克常数。假设系统处于低温区域 $\\beta \\hbar \\omega_0 \\gg 1$，且势垒高而宽，使得阱间隧穿被指数抑制但非零。\n\n在关于两个极小值点的纯谐振子近似下（忽略隧穿），该系统被视为两个具有相同能谱的解耦谐振子势阱，这在足够低的温度下导致对 $Q(\\beta)$ 的最低能量贡献出现二重准简并。实际上，穿过势垒的量子隧穿会混合准简并的定域态并解除简并，从而在谐振子近似之外修正了 $Q(\\beta)$ 的低温行为。\n\n从正则配分函数作为对能量本征态求迹的定义出发，并等价地，从其作为周期为 $\\beta \\hbar$ 的周期性路径 $x(\\tau)$ 之和的虚时路径积分表示出发，推断连接两个势阱的隧穿事件如何相对于谐振子极限改变对 $Q(\\beta)$ 的贡献结构。您的分析应考虑虚时周期性边界条件所施加的要求、虚时隧穿轨迹的平移零模的存在，以及低温下间隔很远的隧穿事件的稀疏特性。基于这些原理，选择正确描述谐振子近似之外 $Q(\\beta)$ 的主要低温形式以及半经典瞬子方法如何编码它的选项。\n\n选择一个选项：\n\nA. 在低温下，隧穿将准简并解除为一个能量为 $E_0 \\pm \\Delta/2$ 的二重态，因此 $Q(\\beta)$ 的形式变为 $Q(\\beta) \\approx 2\\, e^{-\\beta E_0}\\cosh\\!\\big(\\beta \\Delta/2\\big)$，其中劈裂 $\\Delta$ 是非微扰的，其标度关系为 $\\Delta \\sim \\mathcal{A}\\, e^{-S_0/\\hbar}$，$S_0$是最小作用量隧穿轨迹（瞬子）的欧几里得作用量，$\\mathcal{A}$ 是由局域曲率决定的涨落前因子。\n\nB. 由于周期性边界条件允许单个瞬子存在，主要的隧穿修正在 $\\beta$ 上是线性的，给出 $Q(\\beta) \\approx 2\\, e^{-\\beta E_0}\\big[1+\\beta \\,\\mathcal{A}\\, e^{-S_0/\\hbar}\\big]$，其中 $\\mathcal{A}$ 与势垒形状无关。\n\nC. 隧穿通过一个有效激活因子 $e^{-\\beta \\Delta}$ 抑制了相对于谐振子结果的配分函数，即 $Q(\\beta) \\approx 2\\, e^{-\\beta E_0} e^{-\\beta \\Delta}$，其中 $\\Delta \\sim \\mathcal{A}\\, e^{-S_0/\\hbar}$。\n\nD. 低温下的瞬子理论预测了一个与势垒无关的普适幂律修正，$Q(\\beta) \\approx 2\\, e^{-\\beta E_0}\\big[1+c\\,(\\beta \\hbar \\omega_0)^{-1}\\big]$，其中 $c$ 是一个数量级为1的常数。\n\nE. 在低温下，隧穿将粒子定域在单个势阱中，因此二重准简并被消除，且 $Q(\\beta) \\approx e^{-\\beta E_0}$，没有额外的非微扰因子。", "solution": "在尝试给出任何解答之前，将首先对问题陈述进行严格的验证程序。\n\n### 第一步：提取已知条件\n- **系统**：对称一维双势阱势 $V(x)$。\n- **极小值点**：位于 $x=\\pm a$。\n- **极小值点处的曲率**：由质量 $m$ 和小振幅频率 $\\omega_0$ 描述。\n- **势垒**：最大值位于 $x=0$，高度为 $V_b > 0$。\n- **哈密顿量**：$\\hat H = \\hat p^2/(2m) + V(\\hat x)$。\n- **配分函数**：$Q(\\beta) = \\mathrm{Tr}\\, e^{-\\beta \\hat H}$，其中 $\\beta = (k_{\\mathrm B} T)^{-1}$。\n- **常数**：$k_{\\mathrm B}$ (玻尔兹曼常数)，$\\hbar$ (约化普朗克常数)。\n- **物理区域**：低温，定义为 $\\beta \\hbar \\omega_0 \\gg 1$。\n- **势垒条件**：高而宽，使得隧穿被指数抑制但非零。\n- **问题背景**：在谐振子近似之外分析正则配分函数 $Q(\\beta)$，使用迹定义和虚时路径积分形式主义考虑隧穿效应。关键考虑因素包括周期性边界条件、隧穿轨迹的平移零模以及隧穿事件的稀疏特性。\n\n### 第二步：使用提取的已知条件进行验证\n1.  **科学依据**：该问题描述了双势阱中粒子的量子统计力学。这是量子力学、固态物理和理论化学中的一个典范模型系统，用于理解诸如氨反转和量子隧穿等现象。所提出的概念——配分函数、能量本征态、隧穿、简并解除和瞬子——都是现代物理学基本且公认的原理。此问题在科学上是合理的。\n2.  **良态问题**：该问题要求在特定、明确定义的条件下（低温、高势垒）给出配分函数的主要低温形式。它提供了一个清晰的理论框架（半经典分析、瞬子理论）和足够的信息来推导答案的函数形式。在此框架内存在一个唯一且有意义的解。此问题是良态的。\n3.  **客观性**：问题以精确、技术性的语言陈述，没有歧义或主观论断。所用术语在理论物理和化学中是标准的。\n4.  **完整性和一致性**：问题既是自洽的又是一致的。它定义了所有相关量，并提供了必要的物理背景。对谐振子极限和隧穿效应的描述与标准教科书的处理方法一致。\n5.  **其他缺陷**：该问题不是琐碎的、比喻性的或不可验证的。它提出了一个高等量子统计力学中的标准、非平凡问题。\n\n### 第三步：结论与行动\n问题陈述是有效的。这是一个在量子统计力学中表述良好、科学合理的问题。现在将推导解答。\n\n### 推导与选项分析\n\n问题要求给出对称双势阱势的正则配分函数 $Q(\\beta) = \\mathrm{Tr}\\, e^{-\\beta \\hat H} = \\sum_n e^{-\\beta E_n}$ 的低温行为。分析将从能量本征态的角度进行，这是计算配分函数最直接的方法。\n\n在指定的低温区域 $\\beta \\hbar \\omega_0 \\gg 1$ 中，配分函数由最低的几个能量本征态主导。\n\n1.  **谐振子近似（无隧穿）**：如果忽略隧穿，系统等效于两个独立的、相同的谐振子，一个中心在 $x=-a$，另一个在 $x=+a$。每个谐振子的基态能量为 $E_{HO} = \\hbar \\omega_0/2$。让我们将定域态的基态能量定义为 $E_0$，在此近似下 $E_0 \\approx \\hbar \\omega_0/2$。由于粒子可以处于左阱或右阱的基态，因此在能量 $E_0$ 处存在二重准简并。与此对应的态是定域态 $|L\\rangle$ 和 $|R\\rangle$。在低温下，来自谐振子激发态（能量为 $E_0 + \\hbar \\omega_0$、$E_0 + 2\\hbar \\omega_0$等）的贡献被 $e^{-\\beta \\hbar \\omega_0}$、$e^{-2\\beta \\hbar \\omega_0}$ 等因子指数抑制。因此，在这个粗略近似下，$Q(\\beta) \\approx 2 e^{-\\beta E_0}$。\n\n2.  **包含隧穿**：两个势阱之间的量子隧穿作为一种微扰，耦合了准简并态 $|L\\rangle$ 和 $|R\\rangle$。局限在这个二维子空间中的哈密顿量可以写成一个 $2 \\times 2$ 矩阵。根据对称性，对角元相等：$\\langle L|\\hat H|L\\rangle = \\langle R|\\hat H|R\\rangle = E_0$。代表隧穿的非对角元也相等：$\\langle L|\\hat H|R\\rangle = \\langle R|\\hat H|L\\rangle$。让我们将这个隧穿矩阵元记为 $-\\Delta/2$，其中 $\\Delta$ 是一个实的正数。符号是一种约定；对于对称势，真正的基态是对称的，能量更低。\n    哈密顿矩阵是：\n    $$\n    \\mathbf{H} = \\begin{pmatrix} E_0 & -\\Delta/2 \\\\ -\\Delta/2 & E_0 \\end{pmatrix}\n    $$\n    该矩阵的本征值是最低两个态的真实能级。解特征方程 $\\det(\\mathbf{H} - E\\mathbf{I}) = 0$ 得到 $(E_0-E)^2 - (-\\Delta/2)^2 = 0$，从而得出 $E = E_0 \\pm \\Delta/2$。\n\n    因此，隧穿解除了简并，将 $E_0$ 处的单个能级劈裂成一个二重态的两个能级：一个能量为 $E_s = E_0 - \\Delta/2$ 的对称基态和一个能量为 $E_a = E_0 + \\Delta/2$ 的反对称第一激发态。它们之间的能量劈裂为 $\\Delta$。\n\n3.  **考虑隧穿劈裂的配分函数**：由这两个最低能级主导的配分函数为：\n    $$\n    Q(\\beta) = e^{-\\beta E_s} + e^{-\\beta E_a} = e^{-\\beta(E_0 - \\Delta/2)} + e^{-\\beta(E_0 + \\Delta/2)}\n    $$\n    提出因子 $e^{-\\beta E_0}$：\n    $$\n    Q(\\beta) = e^{-\\beta E_0} \\left( e^{\\beta \\Delta/2} + e^{-\\beta \\Delta/2} \\right)\n    $$\n    使用双曲余弦的定义 $\\cosh(z) = (e^z + e^{-z})/2$，这变为：\n    $$\n    Q(\\beta) = 2 e^{-\\beta E_0} \\cosh(\\beta \\Delta/2)\n    $$\n\n4.  **劈裂 $\\Delta$ 的半经典（瞬子）描述**：能量劈裂 $\\Delta$ 是一个非微扰效应。其大小不能用标准微扰理论以某个小耦合常数的幂次来计算。需要使用半经典方法，特别是瞬子理论。在这个框架中，$\\Delta$ 与穿过势垒的隧穿概率有关。其主要贡献由连接两个势阱极小值点的最小作用量虚时经典路径决定。这个轨迹被称为瞬子。该路径的欧几里得作用量为 $S_0 = \\int d\\tau \\, (\\frac{1}{2}m\\dot{x}^2 + V(x))$。劈裂 $\\Delta$ 被发现正比于 $e^{-S_0/\\hbar}$：\n    $$\n    \\Delta \\sim \\mathcal{A} \\, e^{-S_0/\\hbar}\n    $$\n    这里，$\\mathcal{A}$ 是一个指数前因子，依赖于围绕瞬子路径的量子涨落。它由涨落算符的行列式之比决定，并显式地依赖于势的性质，例如极小值点处的曲率 ($\\omega_0$) 和势垒的形状。它不是一个普适常数。\n\n这个完整的描述与选项A中的陈述完全匹配。我们现在逐个评估每个选项。\n\n- **选项 A**：陈述隧穿将准简并解除为一个能量为 $E_0 \\pm \\Delta/2$ 的二重态。这是正确的。它给出的配分函数为 $Q(\\beta) \\approx 2\\, e^{-\\beta E_0}\\cosh\\!\\big(\\beta \\Delta/2\\big)$，这是上面推导出的正确结果。它正确地将劈裂 $\\Delta$ 识别为一个非微扰效应，其标度关系为 $\\Delta \\sim \\mathcal{A}\\, e^{-S_0/\\hbar}$，$S_0$是瞬子作用量，$\\mathcal{A}$ 是涨落前因子。这个陈述与双势阱隧穿的标准理论完全一致。\n  **结论：正确。**\n\n- **选项 B**：提出一个 $\\beta$ 的线性修正：$Q(\\beta) \\approx 2\\, e^{-\\beta E_0}\\big[1+\\beta \\,\\mathcal{A}\\, e^{-S_0/\\hbar}\\big]$。正确结果 $2 e^{-\\beta E_0} \\cosh(\\beta\\Delta/2)$ 对于小的 $\\beta\\Delta$ 的泰勒展开是 $2 e^{-\\beta E_0}[1 + (\\beta\\Delta)^2/8 + \\mathcal{O}((\\beta\\Delta)^4)]$. 主要修正是 $\\beta$ 的二次方，不是线性的。此外，“由于周期性边界条件允许单个瞬子存在”的推理是有缺陷的；连接两个不同极小值点的单个瞬子路径不是周期性的。最后，声称 $\\mathcal{A}$ 与势垒形状无关是错误的。\n  **结论：错误。**\n\n- **选项 C**：提出隧穿通过一个因子 $e^{-\\beta \\Delta}$ 抑制配分函数，给出 $Q(\\beta) \\approx 2\\, e^{-\\beta E_0} e^{-\\beta \\Delta} = 2 e^{-\\beta(E_0 + \\Delta)}$。这意味着两个能级都向上移动了 $\\Delta$，这与简并解除为二重态 $E_0 \\pm \\Delta/2$ 的结果相矛盾。隧穿将基态能量降低到 $E_0 - \\Delta/2$，这相对于一个在 $E_0$ 处具有简并基态的模型，在低温下实际上*增加*了配分函数。\n  **结论：错误。**\n\n- **选项 D**：声称存在一个与势垒无关的普适幂律修正，形式为 $(\\beta \\hbar \\omega_0)^{-1}$。隧穿是一种非微扰现象，其特征是对势垒性质 ($S_0$) 的指数依赖，而不是微扰性的幂律修正。这种幂律修正通常源于单个势阱内的非谐效应，而不是阱间隧穿。关于普适性和与势垒无关的说法是根本错误的。\n  **结论：错误。**\n\n- **选项 E**：声称隧穿将粒子定域在单个势阱中，导致 $Q(\\beta) \\approx e^{-\\beta E_0}$。这与真实效应相反。隧穿耦合了两个势阱，并导致离域的本征态（定域态的对称和反对称组合）。第二个势阱的存在和隧穿从根本上改变了低能能谱，不能被忽略。来自系统二重性的因子 2 是至关重要的。\n  **结论：错误。**\n\n基于此分析，只有选项 A 提供了对该系统的正确和完整的物理与数学描述。", "answer": "$$\\boxed{A}$$", "id": "2812016"}, {"introduction": "统计力学的终极力量在于其能够将微观相互作用与宏观可测性质联系起来。这最后一个实践提供了一个从理论到计算的完整体验，指导你计算第二维里系数 $B_2(T)$，它量化了对理想气体行为的首次偏离。通过从 Lennard-Jones 势出发并实现数值求解 [@problem_id:2812036]，你将在分子模拟和液体理论的核心技术方面获得动手实践经验。", "problem": "考虑一个由相同粒子组成的经典三维流体，粒子间通过球对称双体势相互作用。在温度 $T$、体积 $V$ 中 $N$ 个粒子的正则配分函数 $Q_N$ 可以写成一个构型积分与一个理想气体动量因子的乘积。从 $Q_N$ 的这一基本表示以及物态方程的维里展开出发，基于第一性原理，推导第二维里系数 $B_2(T)$ 的表达式，该表达式应为一个关于由双体势构造的迈耶函数的一维积分。然后，将该表达式具体应用于 Lennard-Jones (LJ) 双体势\n$$\nu(r) = 4 \\varepsilon \\left[\\left(\\frac{\\sigma}{r}\\right)^{12} - \\left(\\frac{\\sigma}{r}\\right)^6\\right],\n$$\n并将您的表达式简化为一个无量纲积分，用约化温度 $T^\\ast = k_{\\mathrm{B}} T / \\varepsilon$ 和约化距离 $x = r/\\sigma$ 表示，其中 $k_{\\mathrm{B}}$ 是玻尔兹曼常数。解释为何所得积分是绝对收敛的，并指明在小 $x$ 和大 $x$ 处控制其数值收敛性的贡献项。\n\n设计并实现一个稳健的数值积分方法，用以计算 Lennard-Jones 势的约化第二维里系数 $B_2^\\ast(T^\\ast) = B_2(T)/\\sigma^3$。您的设计必须能处理排斥核附近、深吸引阱以及长程尾部的行为。为明确评估尾部收敛性，除了在 $x \\in [0, R_c]$ 上进行直接的有限区间积分外，还需根据您从渐近分析中推导出的 $u(r)$ 在大 $r$ 时的主要行为，引入一个解析尾部修正项。在整个计算过程中使用约化单位 $k_{\\mathrm{B}} = \\varepsilon = \\sigma = 1$，因此 $T^\\ast = T$，所求量为 $B_2^\\ast(T) = B_2(T)$，单位为 $\\sigma^3$。\n\n您的程序必须：\n- 实现一个稳定的针对约化积分的一维数值积分方法，积分区间为 $x \\in [0, R_c]$，使用两个截断值 $R_c = 6$ 和 $R_c = 12$（均以 $\\sigma$ 为单位表示）。\n- 实现从大 $x$ 时迈耶被积函数的主导阶渐近行为中获得的解析尾部修正。\n- 对于每个测试用例，返回四个浮点数值：$R_c = 6$ 时的直接有限截断估计值、$R_c = 12$ 时的直接有限截断估计值、$R_c = 6$ 时的尾部修正估计值以及 $R_c = 12$ 时的尾部修正估计值。\n\n物理和数值单位：\n- 报告的 $B_2^\\ast$ 以 $\\sigma^3$ 为单位（在约化单位下是无量纲的），并精确到小数点后 $8$ 位。\n\n测试套件：\n- 温度（约化）：$T^\\ast \\in \\{0.6, 1.0, 5.0, 20.0\\}$。这些用例旨在探究一个低温区（吸引阱占主导且收敛缓慢）、一个中温区、一个中等高温区和一个极高温区（$B_2^\\ast$ 趋近于 $0$）。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个外层列表，其长度等于测试温度的数量，每个内层列表包含该温度下的四个浮点数，顺序如上所述。浮点数必须精确打印到小数点后 $8$ 位。列表必须用逗号分隔，且输出中不得有任何空格。例如，输出结构必须是如下形式\nouter_list = [inner_list_for_$T^\\ast_1$, inner_list_for_$T^\\ast_2$, ...]\n其中每个内层列表的形式为\n[$B_{2,\\mathrm{direct}}^\\ast(R_c{=}6)$, $B_{2,\\mathrm{direct}}^\\ast(R_c{=}12)$, $B_{2,\\mathrm{tail}}^\\ast(R_c{=}6)$, $B_{2,\\mathrm{tail}}^\\ast(R_c{=}12)$]\n所有四个条目均以保留 $8$ 位小数的十进制浮点数形式给出。程序不得打印任何其他内容。", "solution": "所提出的问题是平衡统计力学中的一个标准练习，特别是在非理想气体理论方面。它要求推导并随后对第二维里系数 $B_2(T)$ 进行数值计算，该系数适用于其构成粒子通过 Lennard-Jones 势相互作用的流体。该问题具有科学依据，提法明确，并包含了获得唯一解所需的所有信息。我们将从第一性原理出发进行推导。\n\n首先，我们从正则配分函数 $Q_N$ 出发，推导第二维里系数 $B_2(T)$ 的普适表达式。一个包含 $N$ 个粒子、体积为 $V$、温度为 $T$ 的系统的压力 $P$ 由基本热力学关系给出：\n$$ P = k_{\\mathrm{B}} T \\left( \\frac{\\partial \\ln Q_N}{\\partial V} \\right)_{T,N} $$\n其中 $k_{\\mathrm{B}}$ 是玻尔兹曼常数，$Q_N$ 是正则配分函数。对于一个由相同的、无结构粒子组成的经典系统，$Q_N$ 由下式给出：\n$$ Q_N = \\frac{1}{N! \\Lambda^{3N}} Z_N $$\n此处，$\\Lambda = h / \\sqrt{2\\pi m k_{\\mathrm{B}} T}$ 是热德布罗意波长，它源于对动量的积分，并且与体积无关。$Z_N$ 是构型积分：\n$$ Z_N = \\int_V \\dots \\int_V \\exp\\left(-\\beta U(\\mathbf{r}_1, \\dots, \\mathbf{r}_N)\\right) d^3r_1 \\dots d^3r_N $$\n其中 $\\beta = 1/(k_{\\mathrm{B}}T)$，$U$ 是总势能。对于一个只存在双体相互作用的系统，$U = \\sum_{1 \\le i < j \\le N} u(r_{ij})$。因此，压力由 $Z_N$ 对体积的依赖关系决定：\n$$ P = k_{\\mathrm{B}} T \\left( \\frac{\\partial \\ln Z_N}{\\partial V} \\right)_{T,N} $$\n维里物态方程将压缩因子 $PV/(Nk_{\\mathrm{B}}T)$ 表示为数密度 $\\rho = N/V$ 的幂级数：\n$$ \\frac{P V}{N k_{\\mathrm{B}} T} = 1 + B_2(T)\\rho + B_3(T)\\rho^2 + \\dots $$\n为求得 $B_2(T)$，我们必须将 $Z_N$ 计算到密度的一阶。这等效于考虑由双体相互作用引起的对理想气体行为的偏离。我们使用集团展开方法，引入迈耶函数 $f_{ij} = e^{-\\beta u(r_{ij})} - 1$。构型积分变为：\n$$ Z_N = \\int_V \\dots \\int_V \\prod_{1 \\le i < j \\le N} (1 + f_{ij}) d^3r_1 \\dots d^3r_N $$\n展开乘积并保留对应于零个或一个相互作用的项（这对于 $B_2$ 项占主导的低密度极限是足够的）：\n$$ Z_N \\approx \\int_V \\dots \\int_V \\left(1 + \\sum_{1 \\le i < j \\le N} f_{ij}\\right) d^3r_1 \\dots d^3r_N $$\n第一项给出 $V^N$。求和中有 $N(N-1)/2$ 个相同的项。\n$$ Z_N \\approx V^N + \\frac{N(N-1)}{2} V^{N-2} \\iint_V f_{12} \\, d^3r_1 d^3r_2 $$\n对坐标 $\\mathbf{r}_3, \\dots, \\mathbf{r}_N$ 的积分各自产生一个因子 $V$。\n$$ Z_N \\approx V^N + \\frac{N(N-1)}{2} V^{N-1} \\int f(r) d^3r = V^N \\left(1 + \\frac{N(N-1)}{2V} \\int f(r) d^3r \\right) $$\n取对数并对小 $x$ 使用 $\\ln(1+x) \\approx x$：\n$$ \\ln Z_N \\approx N \\ln V + \\frac{N^2}{2V} \\int f(r) d^3r \\quad (\\text{for large } N) $$\n于是压力为：\n$$ P = k_{\\mathrm{B}} T \\left( \\frac{N}{V} + \\frac{\\partial}{\\partial V}\\left(\\frac{N^2}{2V}\\right) \\int f(r) d^3r \\right) = k_{\\mathrm{B}} T \\left( \\rho - \\frac{\\rho^2}{2} \\int f(r) d^3r \\right) $$\n其中 $\\rho = N/V$。将其与维里展开 $P = k_{\\mathrm{B}}T(\\rho + B_2 \\rho^2 + \\dots)$ 进行比较，我们确定第二维里系数为：\n$$ B_2(T) = -\\frac{1}{2} \\int f(r) d^3r = -\\frac{1}{2} \\int_0^\\infty (e^{-\\beta u(r)} - 1) 4\\pi r^2 dr = -2\\pi \\int_0^\\infty (e^{-\\beta u(r)} - 1) r^2 dr $$\n这就是所要求的表达式。\n\n接下来，我们将其应用于 Lennard-Jones (LJ) 势 $u(r) = 4\\varepsilon [(\\sigma/r)^{12} - (\\sigma/r)^6]$ 并引入约化单位。令 $x=r/\\sigma$ 和 $T^\\ast = k_{\\mathrm{B}}T/\\varepsilon$。约化形式的势为 $u^\\ast(x) = u(r)/\\varepsilon = 4(x^{-12} - x^{-6})$。指数的宗量变为 $\\beta u(r) = u^\\ast(x)/T^\\ast$。将这些代入 $B_2(T)$ 的积分中：\n$$ B_2(T) = -2\\pi \\int_0^\\infty \\left( \\exp\\left[-\\frac{u^\\ast(x)}{T^\\ast}\\right] - 1 \\right) (x\\sigma)^2 d(x\\sigma) = -2\\pi\\sigma^3 \\int_0^\\infty \\left( \\exp\\left[-\\frac{u^\\ast(x)}{T^\\ast}\\right] - 1 \\right) x^2 dx $$\n约化第二维里系数为 $B_2^\\ast(T^\\ast) = B_2(T)/\\sigma^3$：\n$$ B_2^\\ast(T^\\ast) = -2\\pi \\int_0^\\infty \\left( \\exp\\left[-\\frac{4}{T^\\ast}(x^{-12} - x^{-6})\\right] - 1 \\right) x^2 dx $$\n为进行收敛性分析，我们考察被积函数 $I(x) = (e^{-u^\\ast(x)/T^\\ast} - 1)x^2$。\n当 $x \\to 0$ 时，排斥项 $4x^{-12}$ 占主导，$u^\\ast(x) \\to +\\infty$，且 $e^{-u^\\ast(x)/T^\\ast} \\to 0$。因此，迈耶函数趋近于 $-1$，被积函数的行为如同 $I(x) \\approx -x^2$。这在 $x=0$ 处是可积的。\n当 $x \\to \\infty$ 时，势 $u^\\ast(x) \\to 0$。对小量 $z = -u^\\ast(x)/T^\\ast$ 使用泰勒展开 $e^z-1 \\approx z$，迈耶函数变为 $e^{-u^\\ast/T^\\ast}-1 \\approx -u^\\ast/T^\\ast = -\\frac{4}{T^\\ast}(x^{-12} - x^{-6})$。被积函数的行为如同 $I(x) \\approx -\\frac{4}{T^\\ast}(x^{-10} - x^{-4})$。对于大 $x$，主导项与 $x^{-4}$ 成正比。由于 $\\int^\\infty x^{-4} dx$ 收敛，因此 $B_2^\\ast(T^\\ast)$ 的积分是绝对收敛的。数值收敛性受势阱最小值附近的急剧变化和尾部缓慢的 $x^{-4}$ 衰减控制。\n\n对于数值实现，我们被要求使用约化单位，其中 $k_{\\mathrm{B}}=\\varepsilon=\\sigma=1$，因此 $T^\\ast=T$ 且 $B_2^\\ast=B_2$。积分在一个截断值 $R_c$ 处被分割。\n直接有限截断估计值为：\n$$ B_{2,\\mathrm{direct}}^\\ast(T, R_c) = -2\\pi \\int_0^{R_c} \\left( \\exp\\left[-\\frac{4}{T}(x^{-12} - x^{-6})\\right] - 1 \\right) x^2 dx $$\n尾部修正是通过将被积函数的大 $x$ 近似从 $R_c$ 积分到 $\\infty$ 来计算的：\n$$ \\Delta B_2^\\ast(T, R_c) = -2\\pi \\int_{R_c}^{\\infty} \\left(-\\frac{u^\\ast(x)}{T}\\right) x^2 dx = \\frac{2\\pi}{T} \\int_{R_c}^{\\infty} 4(x^{-12} - x^{-6})x^2 dx $$\n$$ \\Delta B_2^\\ast(T, R_c) = \\frac{8\\pi}{T} \\int_{R_c}^{\\infty} (x^{-10} - x^{-4}) dx = \\frac{8\\pi}{T} \\left[\\frac{x^{-9}}{-9} - \\frac{x^{-3}}{-3}\\right]_{R_c}^{\\infty} $$\n$$ \\Delta B_2^\\ast(T, R_c) = \\frac{8\\pi}{T} \\left( \\frac{1}{9}R_c^{-9} - \\frac{1}{3}R_c^{-3} \\right) $$\n尾部修正估计值是数值积分与此解析修正之和：$B_{2,\\mathrm{tail}}^\\ast(T, R_c) = B_{2,\\mathrm{direct}}^\\ast(T, R_c) + \\Delta B_2^\\ast(T, R_c)$。数值部分将使用自适应积分程序 `scipy.integrate.quad` 来执行，该程序对于这类行为良好但变化多样的被积函数是稳健的。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import quad\n\ndef solve():\n    \"\"\"\n    Calculates the reduced second virial coefficient for the Lennard-Jones potential\n    at various temperatures and cutoffs, with and without tail corrections.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_temperatures = [0.6, 1.0, 5.0, 20.0]\n    cutoffs = [6.0, 12.0]\n\n    def integrand(x, T):\n        \"\"\"\n        The integrand for the reduced second virial coefficient B2_star.\n        The function is (exp(-u*(x)/T) - 1) * x^2.\n        Reduced units are used: epsilon = sigma = 1.\n        \"\"\"\n        # The x^2 term ensures the integrand is 0 at x=0.\n        if x == 0.0:\n            return 0.0\n        \n        # Calculate reduced LJ potential u*(x) = 4 * (x^-12 - x^-6)\n        # Use a stable way to compute powers to avoid re-calculation\n        x_inv6 = x**-6\n        x_inv12 = x_inv6**2\n        u_star = 4.0 * (x_inv12 - x_inv6)\n        \n        # Use np.expm1(y) for exp(y) - 1 to maintain precision for small y.\n        # This occurs at large x where u_star/T is close to zero.\n        mayer_f_term = np.expm1(-u_star / T)\n        \n        return mayer_f_term * x**2\n\n    def analytical_tail_correction(Rc, T):\n        \"\"\"\n        Calculates the leading-order analytical tail correction for the B2_star integral\n        for x > Rc.\n        Formula: (8*pi/T) * ( (1/9)*Rc^-9 - (1/3)*Rc^-3 )\n        \"\"\"\n        Rc_inv3 = Rc**-3\n        Rc_inv9 = Rc_inv3**3\n        \n        correction = (8.0 * np.pi / T) * ((1.0 / 9.0) * Rc_inv9 - (1.0 / 3.0) * Rc_inv3)\n        return correction\n\n    all_results = []\n    \n    for T_star in test_temperatures:\n        \n        results_for_T = []\n        \n        # Calculate direct and corrected values for each cutoff\n        b2_direct_6, err_6 = quad(integrand, 0, cutoffs[0], args=(T_star,))\n        b2_direct_6 *= -2.0 * np.pi\n        \n        b2_direct_12, err_12 = quad(integrand, 0, cutoffs[1], args=(T_star,))\n        b2_direct_12 *= -2.0 * np.pi\n        \n        tail_corr_6 = analytical_tail_correction(cutoffs[0], T_star)\n        tail_corr_12 = analytical_tail_correction(cutoffs[1], T_star)\n        \n        b2_tail_corrected_6 = b2_direct_6 + tail_corr_6\n        b2_tail_corrected_12 = b2_direct_12 + tail_corr_12\n        \n        # Assemble the results in the required order:\n        # [direct_Rc=6, direct_Rc=12, tail_corrected_Rc=6, tail_corrected_Rc=12]\n        results_for_T.append(b2_direct_6)\n        results_for_T.append(b2_direct_12)\n        results_for_T.append(b2_tail_corrected_6)\n        results_for_T.append(b2_tail_corrected_12)\n        \n        all_results.append(results_for_T)\n\n    # Format the final output string exactly as specified:\n    # A list of lists, with numbers formatted to 8 decimal places,\n    # and no spaces.\n    inner_strings = []\n    for res_list in all_results:\n        formatted_vals = [f\"{val:.8f}\" for val in res_list]\n        inner_strings.append(f\"[{','.join(formatted_vals)}]\")\n    \n    final_output = f\"[{','.join(inner_strings)}]\"\n\n    # Final print statement in the exact required format.\n    print(final_output)\n\nsolve()\n```", "id": "2812036"}]}