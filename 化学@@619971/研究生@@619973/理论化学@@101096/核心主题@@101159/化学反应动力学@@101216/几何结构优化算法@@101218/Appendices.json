{"hands_on_practices": [{"introduction": "所有基于梯度的优化算法都始于一个核心思想：利用势能面（PES）的局部二次模型来预测能量最低点。这个模型依赖于梯度（$\\mathbf{g}$）和Hessian矩阵（$\\mathbf{H}$）。本练习将带你直接实践计算“纯”牛顿步，这是构建更复杂方法的基础。通过掌握这一基本计算 [@problem_id:2894209]，你将能更深刻地理解二阶优化方法的核心。", "problem": "在一次使用标度化无量纲内坐标进行的量子化学几何优化中，当前结构 $\\mathbf{q}_{0}$ 邻域内的电子能量 $E(\\mathbf{q})$ 可由以下二阶泰勒模型近似：\n$$\nm(\\mathbf{s}) \\equiv E(\\mathbf{q}_{0}) + \\mathbf{g}^{\\top}\\mathbf{s} + \\tfrac{1}{2}\\mathbf{s}^{\\top}\\mathbf{H}\\mathbf{s},\n$$\n其中 $\\mathbf{s} = \\mathbf{q} - \\mathbf{q}_{0}$ 是位移，$\\mathbf{g} = \\nabla E(\\mathbf{q}_{0})$ 是梯度，$\\mathbf{H} = \\nabla^{2} E(\\mathbf{q}_{0})$ 是Hessian矩阵。由于坐标根据构造是无量纲的，$\\mathbf{g}$ 和 $\\mathbf{H}$ 的单位都是能量。牛顿步定义为使该二次模型最小化的位移。\n\n在 $\\mathbf{q}_{0}$ 处，假设梯度和Hessian矩阵为\n$$\n\\mathbf{g} =\n\\begin{pmatrix}\n0.06 \\\\\n-0.08\n\\end{pmatrix}\n\\ \\text{Hartree}, \n\\qquad\n\\mathbf{H} =\n\\begin{pmatrix}\n1.2 & 0.3 \\\\\n0.3 & 0.9\n\\end{pmatrix}\n\\ \\text{Hartree}.\n$$\n从二阶泰勒模型和极小值点的定义出发，推导用 $\\mathbf{g}$ 和 $\\mathbf{H}$ 表示的牛顿步 $\\mathbf{s}_{N}$ 的表达式，利用上述数据显式计算 $\\mathbf{s}_{N}$，然后评估预测的二次能量变化\n$$\n\\Delta E_{\\text{pred}} \\equiv m(\\mathbf{s}_{N}) - m(\\mathbf{0}).\n$$\n以Hartree为单位表示最终的能量变化，并将您的答案四舍五入到五位有效数字。最终答案必须是一个实数。", "solution": "所述问题在科学上是合理的、良定的，并包含得出唯一解所需的所有信息。Hessian矩阵是正定的，这保证了二次模型有唯一的极小值。因此，我将继续进行求解。\n\n目标是找到使电子能量的二次模型最小化的位移 $\\mathbf{s}$：\n$$\nm(\\mathbf{s}) = E(\\mathbf{q}_{0}) + \\mathbf{g}^{\\top}\\mathbf{s} + \\frac{1}{2}\\mathbf{s}^{\\top}\\mathbf{H}\\mathbf{s}\n$$\n对于一个可微函数，其取极小值的必要条件是梯度为零。我们必须计算 $m(\\mathbf{s})$ 相对于位移向量 $\\mathbf{s}$ 的梯度，并将其设为零向量。\n梯度由下式给出：\n$$\n\\nabla_{\\mathbf{s}} m(\\mathbf{s}) = \\nabla_{\\mathbf{s}} \\left( E(\\mathbf{q}_{0}) + \\mathbf{g}^{\\top}\\mathbf{s} + \\frac{1}{2}\\mathbf{s}^{\\top}\\mathbf{H}\\mathbf{s} \\right)\n$$\n项 $E(\\mathbf{q}_{0})$ 相对于 $\\mathbf{s}$ 是一个常数，因此其导数为零。线性项和二次项的导数是向量微积分中的标准结果：\n$$\n\\nabla_{\\mathbf{s}} (\\mathbf{g}^{\\top}\\mathbf{s}) = \\mathbf{g}\n$$\n$$\n\\nabla_{\\mathbf{s}} \\left(\\frac{1}{2}\\mathbf{s}^{\\top}\\mathbf{H}\\mathbf{s}\\right) = \\mathbf{H}\\mathbf{s}\n$$\n其中第二个结果假设Hessian矩阵 $\\mathbf{H}$ 是对称的，这对于二阶导数矩阵是成立的。综合这些，模型的梯度为：\n$$\n\\nabla_{\\mathbf{s}} m(\\mathbf{s}) = \\mathbf{g} + \\mathbf{H}\\mathbf{s}\n$$\n牛顿步，记为 $\\mathbf{s}_{N}$，是使 $m(\\mathbf{s})$ 最小化的特定位移。为了求得它，我们将梯度设为零向量：\n$$\n\\mathbf{g} + \\mathbf{H}\\mathbf{s}_{N} = \\mathbf{0}\n$$\n对 $\\mathbf{s}_{N}$ 求解，得到牛顿步的表达式：\n$$\n\\mathbf{H}\\mathbf{s}_{N} = -\\mathbf{g}\n$$\n$$\n\\mathbf{s}_{N} = -\\mathbf{H}^{-1}\\mathbf{g}\n$$\n这要求Hessian矩阵 $\\mathbf{H}$ 是可逆的。给定Hessian矩阵的行列式为 $\\det(\\mathbf{H}) = (1.2)(0.9) - (0.3)(0.3) = 1.08 - 0.09 = 0.99$。由于 $\\det(\\mathbf{H}) \\neq 0$，逆矩阵存在且牛顿步是良定义的。\n\n现在，我们使用所提供的数据计算 $\\mathbf{s}_{N}$：\n$$\n\\mathbf{g} =\n\\begin{pmatrix}\n0.06 \\\\\n-0.08\n\\end{pmatrix}\n, \\qquad\n\\mathbf{H} =\n\\begin{pmatrix}\n1.2 & 0.3 \\\\\n0.3 & 0.9\n\\end{pmatrix}\n$$\n我们求解线性方程组 $\\mathbf{H}\\mathbf{s}_{N} = -\\mathbf{g}$：\n$$\n\\begin{pmatrix}\n1.2 & 0.3 \\\\\n0.3 & 0.9\n\\end{pmatrix}\n\\begin{pmatrix}\ns_1 \\\\\ns_2\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n-0.06 \\\\\n0.08\n\\end{pmatrix}\n$$\n这对应于以下方程组：\n1. $1.2s_1 + 0.3s_2 = -0.06$\n2. $0.3s_1 + 0.9s_2 = 0.08$\n\n将第一个方程乘以 $3$ 得到 $3.6s_1 + 0.9s_2 = -0.18$。从此结果中减去第二个方程可以消去 $s_2$：\n$$\n(3.6s_1 - 0.3s_1) = -0.18 - 0.08\n$$\n$$\n3.3s_1 = -0.26 \\implies s_1 = -\\frac{0.26}{3.3} = -\\frac{26}{330} = -\\frac{13}{165}\n$$\n将 $s_1$ 代回第二个方程：\n$$\n0.3\\left(-\\frac{13}{165}\\right) + 0.9s_2 = 0.08\n$$\n$$\n-\\frac{3.9}{165} + 0.9s_2 = 0.08 \\implies -\\frac{13}{550} + 0.9s_2 = \\frac{8}{100} = \\frac{2}{25}\n$$\n$$\n0.9s_2 = \\frac{2}{25} + \\frac{13}{550} = \\frac{44}{550} + \\frac{13}{550} = \\frac{57}{550}\n$$\n$$\ns_2 = \\frac{57}{550 \\times 0.9} = \\frac{57}{495} = \\frac{19}{165}\n$$\n所以，牛顿步为 $\\mathbf{s}_{N} = \\begin{pmatrix} -13/165 \\\\ 19/165 \\end{pmatrix}$。\n\n接下来，我们计算预测的二次能量变化 $\\Delta E_{\\text{pred}}$：\n$$\n\\Delta E_{\\text{pred}} = m(\\mathbf{s}_{N}) - m(\\mathbf{0})\n$$\n代入 $m(\\mathbf{s})$ 的定义：\n$$\nm(\\mathbf{s}_{N}) = E(\\mathbf{q}_{0}) + \\mathbf{g}^{\\top}\\mathbf{s}_{N} + \\frac{1}{2}\\mathbf{s}_{N}^{\\top}\\mathbf{H}\\mathbf{s}_{N}\n$$\n$$\nm(\\mathbf{0}) = E(\\mathbf{q}_{0})\n$$\n所以，\n$$\n\\Delta E_{\\text{pred}} = \\mathbf{g}^{\\top}\\mathbf{s}_{N} + \\frac{1}{2}\\mathbf{s}_{N}^{\\top}\\mathbf{H}\\mathbf{s}_{N}\n$$\n我们可以简化这个表达式。从牛顿步的推导中，我们有 $\\mathbf{H}\\mathbf{s}_{N} = -\\mathbf{g}$。将此代入二次项：\n$$\n\\mathbf{s}_{N}^{\\top}\\mathbf{H}\\mathbf{s}_{N} = \\mathbf{s}_{N}^{\\top}(-\\mathbf{g}) = - \\mathbf{s}_{N}^{\\top}\\mathbf{g}\n$$\n由于 $\\mathbf{s}_{N}^{\\top}\\mathbf{g}$ 是一个标量，它等于其自身的转置，即 $(\\mathbf{s}_{N}^{\\top}\\mathbf{g})^{\\top} = \\mathbf{g}^{\\top}\\mathbf{s}_{N}$。因此，$\\mathbf{s}_{N}^{\\top}\\mathbf{H}\\mathbf{s}_{N} = -\\mathbf{g}^{\\top}\\mathbf{s}_{N}$。\n能量变化变为：\n$$\n\\Delta E_{\\text{pred}} = \\mathbf{g}^{\\top}\\mathbf{s}_{N} + \\frac{1}{2}(-\\mathbf{g}^{\\top}\\mathbf{s}_{N}) = \\frac{1}{2}\\mathbf{g}^{\\top}\\mathbf{s}_{N}\n$$\n现在，我们计算这个值：\n$$\n\\Delta E_{\\text{pred}} = \\frac{1}{2}\n\\begin{pmatrix}\n0.06 & -0.08\n\\end{pmatrix}\n\\begin{pmatrix}\n-13/165 \\\\\n19/165\n\\end{pmatrix}\n$$\n$$\n\\Delta E_{\\text{pred}} = \\frac{1}{2} \\left[ (0.06)\\left(-\\frac{13}{165}\\right) + (-0.08)\\left(\\frac{19}{165}\\right) \\right]\n$$\n$$\n\\Delta E_{\\text{pred}} = \\frac{1}{2 \\times 165} \\left[ (0.06)(-13) + (-0.08)(19) \\right]\n$$\n$$\n\\Delta E_{\\text{pred}} = \\frac{1}{330} \\left[ -0.78 - 1.52 \\right] = \\frac{-2.3}{330} = -\\frac{23}{3300}\n$$\n进行除法运算：\n$$\n\\Delta E_{\\text{pred}} = -\\frac{23}{3300} \\approx -0.00696969... \\ \\text{Hartree}\n$$\n问题要求将此值四舍五入到五位有效数字。第一个非零数字是千分位上的 $6$。前五位有效数字是 $6$、$9$、$6$、$9$、$6$。第六位有效数字是 $9$，大于或等于 $5$，所以我们将第五位有效数字向上取整。\n$$\n-0.0069696 \\underline{9}... \\implies -0.0069697\n$$", "answer": "$$\\boxed{-0.0069697}$$", "id": "2894209"}, {"introduction": "虽然牛顿法在理论上很强大，但在每次迭代中计算和存储完整的Hessian矩阵在计算上非常昂贵。因此，我们需要更高效的拟牛顿法，例如L-BFGS算法，它通过存储有限的历史梯度和位移信息来近似Hessian的逆。本练习将揭开著名的L-BFGS“双循环递归”算法的神秘面纱 [@problem_id:164314]。通过手动执行一次迭代，你将具体理解这一主流算法如何巧妙地构造搜索方向，这对于任何计算化学家来说都是一项至关重要的技能。", "problem": "在计算量子化学中，几何优化算法对于寻找稳定的分子结构至关重要，这些结构对应于势能面（PES）上的极小值点。准牛顿法是完成此任务的一类常用算法。它们通过使用能量的梯度 $g$ 来近似包含势能面曲率信息的逆 Hessian 矩阵 $H$，从而迭代地逼近极小值点。\n\n在第 $k$ 步的搜索方向 $p_k$ 由 $p_k = -H_k g_k$ 确定，其中 $g_k$ 是当前几何构型 $x_k$ 处的梯度。限制内存的 Broyden–Fletcher–Goldfarb–Shanno (L-BFGS) 算法是一种广泛使用的准牛顿法，它避免了显式构造和存储稠密的逆 Hessian 矩阵。相反，它只存储少量（$m$ 个）最近的位移向量 $s_i = x_{i+1} - x_i$ 和梯度差向量 $y_i = g_{i+1} - g_i$。\n\n乘积 $H_k g_k$ 可通过 L-BFGS 双循环递归高效计算。给定当前梯度 $g_k$ 和之前的 $m$ 对 $(s_i, y_i)$，其过程如下：\n\n1.  初始化 $q \\leftarrow g_k$。\n2.  **第一个循环：** 对于 $i$ 从 $k-1$ 向下到 $k-m$：\n    -   计算 $\\rho_i = \\frac{1}{y_i^T s_i}$。\n    -   计算 $\\alpha_i = \\rho_i s_i^T q$。\n    -   更新 $q \\leftarrow q - \\alpha_i y_i$。\n3.  选择一个初始的逆 Hessian 近似 $H_k^{(0)}$。一个标准的选择是 $H_k^{(0)} = \\gamma_k I$，其中 $I$ 是单位矩阵，且 $\\gamma_k = \\frac{s_{k-1}^T y_{k-1}}{y_{k-1}^T y_{k-1}}$。\n4.  计算结果向量的初始版本：$z \\leftarrow H_k^{(0)} q$。\n5.  **第二个循环：** 对于 $i$ 从 $k-m$ 向上到 $k-1$：\n    -   计算 $\\beta_i = \\rho_i y_i^T z$。\n    -   更新 $z \\leftarrow z + s_i (\\alpha_i - \\beta_i)$。\n6.  最终结果为 $H_k g_k = z$。搜索方向为 $p_k = -z$。\n\n**问题：**\n考虑一个二维系统在第 $k$ 步的几何优化。使用 L-BFGS 算法，内存为 $m=2$。当前的梯度以及两个最近的位移和梯度差向量如下：\n-   当前梯度：$g_k = \\begin{pmatrix} -1 \\\\ 2 \\end{pmatrix}$\n-   最近的更新向量（索引 $k-1$）：$s_{k-1} = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$, $y_{k-1} = \\begin{pmatrix} 2 \\\\ 1 \\end{pmatrix}$\n-   第二近的更新向量（索引 $k-2$）：$s_{k-2} = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}$, $y_{k-2} = \\begin{pmatrix} -1 \\\\ 2 \\end{pmatrix}$\n\n计算当前第 $k$ 步的搜索方向向量 $p_k$。", "solution": "我们应用 $m=2$ 的 L–BFGS 双循环递归。设索引 $i=k-1,k-2$。\n\n1.  第一个循环。初始化\n$$q^{(0)}=g_k=\\begin{pmatrix}-1\\\\2\\end{pmatrix}。$$\n对每个 $i=k-1,k-2$，计算\n$$\\rho_i=\\frac1{y_i^T s_i},\\quad \n\\alpha_i=\\rho_i\\,s_i^T q^{(\\cdot)},\\quad\nq^{(\\text{new})}=q^{(\\text{old})}-\\alpha_i\\,y_i。$$\n\ni)  $i=k-1$: \n$$y_{k-1}^T s_{k-1}=(2,1)\\cdot(1,0)=2\\;\\Rightarrow\\;\n\\rho_{k-1}=\\tfrac12,$$\n$$\\alpha_{k-1}=\\tfrac12\\,(1,0)\\!\\cdot\\!(-1,2)=-\\tfrac12,$$\n$$q^{(1)}=(-1,2)-\\bigl(-\\tfrac12\\bigr)(2,1)\n=( -1,2 )+(1,\\tfrac12)\n=(0,\\tfrac52)。$$\n\nii) $i=k-2$: \n$$y_{k-2}^T s_{k-2}=(-1,2)\\cdot(0,1)=2\\;\\Rightarrow\\;\n\\rho_{k-2}=\\tfrac12,$$\n$$\\alpha_{k-2}=\\tfrac12\\,(0,1)\\!\\cdot\\!(0,\\tfrac52)\n=\\tfrac54,$$\n$$q^{(2)}=(0,\\tfrac52)-\\tfrac54\\,(-1,2)\n=(0,\\tfrac52)-(-\\tfrac54,\\tfrac52)\n=(\\tfrac54,0)。$$\n\n因此，第一个循环后 $q=(5/4,0)^T$。\n\n2.  构造初始的 Hessian 矩阵与向量的乘积。选择\n$$\\gamma_k=\\frac{s_{k-1}^Ty_{k-1}}{y_{k-1}^Ty_{k-1}}\n=\\frac{2}{2^2+1^2}=\\tfrac25,\\quad\nH^{(0)}_k=\\gamma_kI,$$\n$$z^{(0)}=H^{(0)}_k\\,q=\\tfrac25\\,(5/4,0)=(\\tfrac12,0)。$$\n\n3.  第二个循环。对 $i=k-2,k-1$，计算\n$$\\beta_i=\\rho_i\\,y_i^T z^{(\\cdot)},\\quad\nz^{(\\rm new)}=z^{(\\rm old)}+s_i(\\alpha_i-\\beta_i)。$$\n\ni)  $i=k-2$:\n$$\\beta_{k-2}=\\tfrac12\\;(-1,2)\\!\\cdot\\!(\\tfrac12,0)=-\\tfrac14,$$\n$$z^{(1)}=(\\tfrac12,0)+(0,1)\\bigl(\\tfrac54-(-\\tfrac14)\\bigr)\n=(\\tfrac12,0)+(0,\\tfrac32)\n=(\\tfrac12,\\tfrac32)。$$\n\nii) $i=k-1$:\n$$\\beta_{k-1}=\\tfrac12\\;(2,1)\\!\\cdot\\!(\\tfrac12,\\tfrac32)\n=\\tfrac12\\,(1+\\tfrac32)=\\tfrac54,$$\n$$z^{(2)}=(\\tfrac12,\\tfrac32)+(1,0)\\bigl(-\\tfrac12-\\tfrac54\\bigr)\n=(\\tfrac12,\\tfrac32)+(-\\tfrac74,0)\n=(-\\tfrac54,\\tfrac32)。$$\n\n因此 $H_k g_k=z=(-5/4,3/2)^T$，且搜索方向为\n$$p_k=-z=\\begin{pmatrix}5/4\\\\-3/2\\end{pmatrix}。$$", "answer": "$$\\boxed{\\begin{pmatrix}\\tfrac{5}{4}\\\\-\\tfrac{3}{2}\\end{pmatrix}}$$", "id": "164314"}, {"introduction": "我们已经学习了如何计算优化步长，但这些计算在面对不可避免的数值噪声时有多可靠？求解线性方程组 $\\mathbf{H}\\mathbf{p} = -\\mathbf{g}$ 的数值稳定性由Hessian矩阵的条件数决定。本练习将抽象的数值分析概念与计算化学实践紧密联系起来 [@problem_id:2894238]。你将亲手计算谱条件数（spectral condition number），并理解它如何量化牛顿步对Hessian矩阵中微小误差的敏感性，从而深入了解优化算法的稳健性。", "problem": "考虑在几何优化中，当前几何构型附近，电子能量面的一个基于质量加权笛卡尔坐标的局域二次模型。设 Hessian 矩阵为对称矩阵\n$$\n\\mathbf{H} \\;=\\;\n\\begin{pmatrix}\n4 & 1 & 0 \\\\\n1 & 3 & 0 \\\\\n0 & 0 & \\tfrac{1}{2}\n\\end{pmatrix},\n$$\n梯度为\n$$\n\\mathbf{g} \\;=\\;\n\\begin{pmatrix}\n0.10 \\\\\n-0.20 \\\\\n0.05\n\\end{pmatrix}.\n$$\n牛顿步长 $\\mathbf{p}$ 由线性系统 $\\mathbf{H}\\,\\mathbf{p} \\;=\\; -\\,\\mathbf{g}$ 隐式定义。在实践中，量子化学代码中使用的 Hessian 矩阵常常会因为数值微分或收敛不完全而受到微小误差的扰动，因此实际计算出的步长 $\\tilde{\\mathbf{p}}$ 满足 $(\\mathbf{H} + \\Delta \\mathbf{H})\\,\\tilde{\\mathbf{p}} \\;=\\; -\\,\\mathbf{g}$，其中 $\\Delta \\mathbf{H}$ 是一个微小的扰动。使用谱范数，通过谱条件数将 $\\mathbf{p}$ 的相对变化与 $\\Delta \\mathbf{H}$ 的相对大小联系起来，从而分析 $\\mathbf{p}$ 相对于 $\\Delta \\mathbf{H}$ 的一阶敏感度。您的分析应从牛顿步长和矩阵逆的线性代数定义出发，通过一阶微扰推理进行，不应假定任何预先给定的扰动界。\n\n计算与 $\\mathbf{H}$ 相关的谱条件数 $\\kappa_{2}(\\mathbf{H})$，并用它来讨论此问题中牛顿步长的数值稳定性，即 $\\tilde{\\mathbf{p}}$ 中的相对误差如何随 $\\mathbf{H}$ 中的相对扰动而变化。请以最简闭合形式给出 $\\kappa_{2}(\\mathbf{H})$ 的精确值，不进行四舍五入，不带单位。", "solution": "该问题要求通过将解对 Hessian 矩阵扰动的敏感性联系起来，来分析几何优化过程中牛顿步长的数值稳定性。这种关系由 Hessian 矩阵的谱条件数来量化。我们将首先推导一般的一阶微扰结果，然后将其应用于给定的特定矩阵。\n\n设精确的牛顿步长 $\\mathbf{p}$ 是以下线性系统的解：\n$$\n\\mathbf{H}\\mathbf{p} = -\\mathbf{g}\n$$\n其中 $\\mathbf{H}$ 是精确的 Hessian 矩阵，$\\mathbf{g}$ 是梯度。在实际计算中，由于数值误差，我们使用一个受扰动的 Hessian 矩阵 $\\mathbf{H} + \\Delta\\mathbf{H}$，并求解一个受扰动的步长 $\\tilde{\\mathbf{p}}$：\n$$\n(\\mathbf{H} + \\Delta\\mathbf{H})\\tilde{\\mathbf{p}} = -\\mathbf{g}\n$$\n令牛顿步长的误差为 $\\Delta\\mathbf{p} = \\tilde{\\mathbf{p}} - \\mathbf{p}$，这意味着 $\\tilde{\\mathbf{p}} = \\mathbf{p} + \\Delta\\mathbf{p}$。将此代入受扰动的方程中，得到：\n$$\n(\\mathbf{H} + \\Delta\\mathbf{H})(\\mathbf{p} + \\Delta\\mathbf{p}) = -\\mathbf{g}\n$$\n展开左侧可得：\n$$\n\\mathbf{H}\\mathbf{p} + \\mathbf{H}\\Delta\\mathbf{p} + \\Delta\\mathbf{H}\\mathbf{p} + \\Delta\\mathbf{H}\\Delta\\mathbf{p} = -\\mathbf{g}\n$$\n由于 $\\mathbf{H}\\mathbf{p} = -\\mathbf{g}$，上式可简化为：\n$$\n\\mathbf{H}\\Delta\\mathbf{p} + \\Delta\\mathbf{H}\\mathbf{p} + \\Delta\\mathbf{H}\\Delta\\mathbf{p} = \\mathbf{0}\n$$\n对于一阶分析，我们假设扰动很小，即 $\\|\\Delta\\mathbf{H}\\|$ 及因此产生的 $\\|\\Delta\\mathbf{p}\\|$ 也很小。因此，$\\Delta\\mathbf{H}\\Delta\\mathbf{p}$ 这一项是关于小量的二阶项，可以忽略不计。这导出了一阶近似：\n$$\n\\mathbf{H}\\Delta\\mathbf{p} \\approx -\\Delta\\mathbf{H}\\mathbf{p}\n$$\n假设 Hessian 矩阵 $\\mathbf{H}$ 是可逆的，我们可以解出误差 $\\Delta\\mathbf{p}$：\n$$\n\\Delta\\mathbf{p} \\approx -\\mathbf{H}^{-1}\\Delta\\mathbf{H}\\mathbf{p}\n$$\n为分析此误差的大小，我们对两边取谱范数（用下标 $2$ 表示）。利用矩阵范数的次乘性质（$\\|\\mathbf{A}\\mathbf{B}\\| \\le \\|\\mathbf{A}\\|\\|\\mathbf{B}\\|$ 和 $\\|\\mathbf{A}\\mathbf{x}\\| \\le \\|\\mathbf{A}\\|\\|\\mathbf{x}\\|$），我们得到误差范数的一个上界：\n$$\n\\|\\Delta\\mathbf{p}\\|_2 \\le \\|\\mathbf{H}^{-1}\\|_2 \\|\\Delta\\mathbf{H}\\|_2 \\|\\mathbf{p}\\|_2\n$$\n为了用相对误差来表示，我们将两边除以 $\\|\\mathbf{p}\\|_2$ （假设 $\\mathbf{p} \\neq \\mathbf{0}$，如果 $\\mathbf{g} \\neq \\mathbf{0}$，则该假设成立）：\n$$\n\\frac{\\|\\Delta\\mathbf{p}\\|_2}{\\|\\mathbf{p}\\|_2} \\le \\|\\mathbf{H}^{-1}\\|_2 \\|\\Delta\\mathbf{H}\\|_2\n$$\n为将其与 Hessian 矩阵的相对扰动 $\\frac{\\|\\Delta\\mathbf{H}\\|_2}{\\|\\mathbf{H}\\|_2}$ 联系起来，我们将右侧同乘以和同除以 $\\|\\mathbf{H}\\|_2$：\n$$\n\\frac{\\|\\Delta\\mathbf{p}\\|_2}{\\|\\mathbf{p}\\|_2} \\le \\left(\\|\\mathbf{H}\\|_2 \\|\\mathbf{H}^{-1}\\|_2\\right) \\frac{\\|\\Delta\\mathbf{H}\\|_2}{\\|\\mathbf{H}\\|_2}\n$$\n括号中的量是矩阵 $\\mathbf{H}$ 的谱条件数的定义，记为 $\\kappa_2(\\mathbf{H})$。因此，我们得到了以下基本结果：\n$$\n\\frac{\\|\\Delta\\mathbf{p}\\|_2}{\\|\\mathbf{p}\\|_2} \\le \\kappa_2(\\mathbf{H}) \\frac{\\|\\Delta\\mathbf{H}\\|_2}{\\|\\mathbf{H}\\|_2}\n$$\n这个不等式表明，条件数 $\\kappa_2(\\mathbf{H})$ 作为一个放大因子，将 Hessian 矩阵中的相对误差与计算出的牛顿步长中可能的最大相对误差联系起来。\n\n我们现在的任务是计算给定矩阵 $\\mathbf{H}$ 的 $\\kappa_2(\\mathbf{H})$：\n$$\n\\mathbf{H} = \\begin{pmatrix} 4 & 1 & 0 \\\\ 1 & 3 & 0 \\\\ 0 & 0 & \\tfrac{1}{2} \\end{pmatrix}\n$$\n对称矩阵的谱范数等于其谱半径，即其特征值绝对值的最大值，$\\|\\mathbf{H}\\|_2 = \\max_i |\\lambda_i|$。因此，对于一个可逆的对称矩阵，其条件数是最大绝对值特征值与最小绝对值特征值之比：\n$$\n\\kappa_2(\\mathbf{H}) = \\frac{\\max_i |\\lambda_i|}{\\min_i |\\lambda_i|}\n$$\n矩阵 $\\mathbf{H}$ 是块对角矩阵。$\\mathbf{H}$ 的特征值是其对角块特征值的并集。一个块是标量矩阵 $[\\frac{1}{2}]$，所以一个特征值立即可得 $\\lambda_1 = \\frac{1}{2}$。另一个块是 $2 \\times 2$ 子矩阵：\n$$\n\\mathbf{A} = \\begin{pmatrix} 4 & 1 \\\\ 1 & 3 \\end{pmatrix}\n$$\n$\\mathbf{A}$ 的特征值可通过其特征方程 $\\det(\\mathbf{A} - \\lambda\\mathbf{I}) = 0$ 求得：\n$$\n\\det \\begin{pmatrix} 4-\\lambda & 1 \\\\ 1 & 3-\\lambda \\end{pmatrix} = (4-\\lambda)(3-\\lambda) - 1 = 0\n$$\n$$\n\\lambda^2 - 7\\lambda + 12 - 1 = 0\n$$\n$$\n\\lambda^2 - 7\\lambda + 11 = 0\n$$\n使用二次公式，该子矩阵的特征值为：\n$$\n\\lambda = \\frac{-(-7) \\pm \\sqrt{(-7)^2 - 4(1)(11)}}{2} = \\frac{7 \\pm \\sqrt{49-44}}{2} = \\frac{7 \\pm \\sqrt{5}}{2}\n$$\n所以，$\\mathbf{H}$ 的三个特征值是 $\\lambda_1 = \\frac{1}{2}$，$\\lambda_2 = \\frac{7 - \\sqrt{5}}{2}$ 和 $\\lambda_3 = \\frac{7 + \\sqrt{5}}{2}$。所有特征值均为正，表明 $\\mathbf{H}$ 是正定的，这符合处于局域极小点附近的 Hessian 矩阵的预期。\n\n我们必须确定最大和最小特征值。\n$$\n\\lambda_1 = \\frac{1}{2} = 0.5\n$$\n由于 $2 < \\sqrt{5} < 3$，我们可以估计 $\\lambda_2$：\n$$\n\\frac{7 - 3}{2} < \\frac{7 - \\sqrt{5}}{2} < \\frac{7 - 2}{2} \\implies 2 < \\lambda_2 < 2.5\n$$\n因此，$\\lambda_2 > \\lambda_1$。最大特征值显然是 $\\lambda_{\\max} = \\lambda_3 = \\frac{7 + \\sqrt{5}}{2}$。最小特征值是 $\\lambda_{\\min} = \\lambda_1 = \\frac{1}{2}$。\n\n因此，谱条件数为：\n$$\n\\kappa_2(\\mathbf{H}) = \\frac{\\lambda_{\\max}}{\\lambda_{\\min}} = \\frac{\\frac{7 + \\sqrt{5}}{2}}{\\frac{1}{2}} = 7 + \\sqrt{5}\n$$\n这个值，约等于 $7 + 2.236 = 9.236$，是数值敏感度的一个度量。由于这个数不是特别大，从这个 Hessian 矩阵计算牛顿步长的问题被认为是良态的。$\\mathbf{H}$ 中的微小相对误差不会在最终的步长 $\\mathbf{p}$ 中被灾难性地放大。", "answer": "$$\n\\boxed{7 + \\sqrt{5}}\n$$", "id": "2894238"}]}