{"hands_on_practices": [{"introduction": "自相互作用误差（self-interaction error, SIE）是大多数近似密度泛函的一个基本缺陷。对于像氢原子这样的单电子体系，其自身电子云不应产生相互作用，因此精确的理论必须无自相互作用。本练习将通过解析计算，具体展示为何精确交换泛函能够完全消除自相互作用，并量化如局域密度近似（LDA）和广义梯度近似（GGA）等常用近似中的残余误差，从而将一个抽象的概念变得具体可触。[@problem_id:2901403]", "problem": "考虑一个在 Kohn–Sham 密度泛函理论 (KS-DFT) 框架下的单电子氢原子，该原子处于其非相对论性基态。其空间轨道是归一化的类氢 $1s$ 函数，且电子是完全自旋极化的。在 Hartree 原子单位制下进行计算，因此玻尔半径满足 $a_0 = 1$，电子密度呈球对称，等于\n\n$$\nn(r) \\;=\\; \\frac{1}{\\pi}\\,\\exp(-2 r),\n$$\n\n且该系统恰好含有一个电子。\n\n从第一性原理和标准定义出发，完成以下任务：\n\n- 使用经典 Hartree 静电能的定义，\n\n$$\nE_{\\mathrm{H}}[n] \\;=\\; \\frac{1}{2}\\int \\!\\! \\int \\frac{n(\\mathbf{r})\\,n(\\mathbf{r}')}{|\\mathbf{r}-\\mathbf{r}'|}\\,d\\mathbf{r}\\,d\\mathbf{r}',\n$$\n\n以及 Slater 行列式的 Hartree–Fock 交换能，\n\n$$\nE_{x}^{\\mathrm{HF}}[\\{\\varphi_i\\}] \\;=\\; -\\frac{1}{2}\\sum_{i,j}\\int \\!\\! \\int \\frac{\\varphi_i(\\mathbf{r})\\,\\varphi_j^{*}(\\mathbf{r})\\,\\varphi_j(\\mathbf{r}')\\,\\varphi_i^{*}(\\mathbf{r}')}{|\\mathbf{r}-\\mathbf{r}'|}\\,d\\mathbf{r}\\,d\\mathbf{r}',\n$$\n\n从这些定义出发，验证对于单电子系统，$E_{\\mathrm{H}} + E_{x}^{\\mathrm{exact}} = 0$ 成立，其中 $E_{x}^{\\mathrm{exact}}$ 表示在给定密度下计算的精确交换能泛函。\n\n- 接下来，对两种近似交换泛函，量化定义为 $E_{\\mathrm{H}} + E_{x}^{\\mathrm{approx}}$ 的残余自相互作用误差：\n  1. 自旋密度泛函理论的局域密度近似 (LDA) 交换能，\n  \n$$\n  E_{x}^{\\mathrm{LDA}}[n_{\\uparrow},n_{\\downarrow}] \\;=\\; -\\frac{3}{4}\\left(\\frac{3}{\\pi}\\right)^{1/3}\\int \\left(n_{\\uparrow}^{4/3} + n_{\\downarrow}^{4/3}\\right)\\,d\\mathbf{r},\n  $$\n\n  在完全自旋极化的氢原子密度 $n_{\\uparrow} = n$, $n_{\\downarrow} = 0$ 下进行计算。\n  2. 用于交换能的二阶梯度展开（一种广义梯度近似 (GGA) 的原型），\n  \n$$\n  E_{x}^{\\mathrm{GEA2}}[n] \\;=\\; -C_{x}\\int n(\\mathbf{r})^{4/3}\\left[1 + \\mu\\,s(\\mathbf{r})^{2}\\right]\\,d\\mathbf{r},\n  $$\n\n  其中 $C_{x} = \\frac{3}{4}\\left(\\frac{3}{\\pi}\\right)^{1/3}$，$\\mu = \\frac{10}{81}$，约化梯度为 $s(\\mathbf{r}) = \\frac{|\\nabla n(\\mathbf{r})|}{2 k_{F}(\\mathbf{r})\\,n(\\mathbf{r})}$，局域费米波矢为 $k_{F}(\\mathbf{r}) = \\left(3\\pi^{2} n(\\mathbf{r})\\right)^{1/3}$。\n\n推导两种残余自相互作用误差的解析闭式表达式，\n\n$$\n\\Delta_{\\mathrm{LDA}} \\;=\\; E_{\\mathrm{H}}[n] + E_{x}^{\\mathrm{LDA}}[n_{\\uparrow}=n,n_{\\downarrow}=0], \n\\quad\n\\Delta_{\\mathrm{GEA2}} \\;=\\; E_{\\mathrm{H}}[n] + E_{x}^{\\mathrm{GEA2}}[n],\n$$\n\n用有理数以及 $\\pi$ 和 $3$ 的幂来表示。将最终答案表示为行矩阵 $\\bigl[\\Delta_{\\mathrm{LDA}}\\;\\;\\Delta_{\\mathrm{GEA2}}\\bigr]$ 的形式，并使用 Hartree ($\\mathrm{E_h}$) 作为能量单位。不需要进行数值取整；请给出精确表达式。", "solution": "该问题陈述具有科学依据、提法恰当且客观。所有给出的定义、常数和物理量均为密度泛函理论框架内的标准量，或为本问题之目的而明确定义。该任务是一项严谨且可验证的计算。因此，该问题被视为有效，并将提供完整解答。\n\n该问题要求对单电子系统（特别是基态氢原子）中的自相互作用进行两部分分析。所有计算均在 Hartree 原子单位制（$e=m_e=\\hbar=1$, $a_0=1$）下进行。\n\n第一部分：精确自相互作用抵消的验证\n\n对于任何单电子系统，基态电子密度$n(\\mathbf{r})$由单个占据轨道$\\varphi_1(\\mathbf{r})$的平方给出，即$n(\\mathbf{r}) = |\\varphi_1(\\mathbf{r})|^2$。由于氢原子的$1s$轨道是实函数，我们有$n(\\mathbf{r}) = \\varphi_1(\\mathbf{r})^2$。\n\nHartree 能量定义为：\n$$\nE_{\\mathrm{H}}[n] = \\frac{1}{2}\\int \\!\\! \\int \\frac{n(\\mathbf{r})\\,n(\\mathbf{r}')}{|\\mathbf{r}-\\mathbf{r}'|}\\,d\\mathbf{r}\\,d\\mathbf{r}'\n$$\n代入$n(\\mathbf{r}) = \\varphi_1(\\mathbf{r})^2$，我们得到：\n$$\nE_{\\mathrm{H}}[n] = \\frac{1}{2}\\int \\!\\! \\int \\frac{\\varphi_1(\\mathbf{r})^2\\,\\varphi_1(\\mathbf{r}')^2}{|\\mathbf{r}-\\mathbf{r}'|}\\,d\\mathbf{r}\\,d\\mathbf{r}'\n$$\n精确交换能$E_{x}^{\\mathrm{exact}}$由在精确 Kohn-Sham 轨道上计算的 Hartree-Fock 交换表达式给出。对于单电子系统，只有一个轨道$\\varphi_1$。在$E_{x}^{\\mathrm{HF}}$的定义中，对$i$和$j$的求和各自只有一项，即$i=j=1$。\n$$\nE_{x}^{\\mathrm{exact}} = E_{x}^{\\mathrm{HF}}[\\{\\varphi_1\\}] = -\\frac{1}{2}\\int \\!\\! \\int \\frac{\\varphi_1(\\mathbf{r})\\,\\varphi_1^{*}(\\mathbf{r})\\,\\varphi_1(\\mathbf{r}')\\,\\varphi_1^{*}(\\mathbf{r}')}{|\\mathbf{r}-\\mathbf{r}'|}\\,d\\mathbf{r}\\,d\\mathbf{r}'\n$$\n由于$\\varphi_1$是实函数，$\\varphi_1^* = \\varphi_1$。表达式简化为：\n$$\nE_{x}^{\\mathrm{exact}} = -\\frac{1}{2}\\int \\!\\! \\int \\frac{\\varphi_1(\\mathbf{r})^2\\,\\varphi_1(\\mathbf{r}')^2}{|\\mathbf{r}-\\mathbf{r}'|}\\,d\\mathbf{r}\\,d\\mathbf{r}'\n$$\n将此与 Hartree 能量的表达式进行比较，我们发现：\n$$\nE_{x}^{\\mathrm{exact}} = -E_{\\mathrm{H}}[n]\n$$\n因此，对于任何单电子系统，Hartree 能量与精确交换能之和恒为零：\n$$\nE_{\\mathrm{H}}[n] + E_{x}^{\\mathrm{exact}} = 0\n$$\n这证明了在精确理论中自相互作用被完全抵消。然而，近似泛函通常不满足此条件，从而导致残余的自相互作用误差。\n\n第二部分：残余自相互作用误差的计算\n\n我们必须计算 $\\Delta_{\\mathrm{LDA}} = E_{\\mathrm{H}}[n] + E_{x}^{\\mathrm{LDA}}[n]$ 和 $\\Delta_{\\mathrm{GEA2}} = E_{\\mathrm{H}}[n] + E_{x}^{\\mathrm{GEA2}}[n]$。第一步是计算给定密度 $n(r) = \\frac{1}{\\pi}\\exp(-2r)$ 的 Hartree 能量 $E_{\\mathrm{H}}$。\n\nHartree 能量 $E_{\\mathrm{H}}$ 的计算\nHartree 能量是电荷分布 $n(\\mathbf{r})$ 的静电自能。它可以表示为 $E_{\\mathrm{H}} = \\frac{1}{2}\\int n(\\mathbf{r}) V_{\\mathrm{H}}(\\mathbf{r}) \\,d\\mathbf{r}$，其中 $V_{\\mathrm{H}}(\\mathbf{r})$ 是由 $n(\\mathbf{r})$ 产生的静电势。对于球对称密度，其势为：\n$$\nV_{\\mathrm{H}}(r) = \\frac{1}{r} \\int_0^r n(r') 4\\pi r'^2 dr' + \\int_r^\\infty \\frac{n(r') 4\\pi r'^2}{r'} dr'\n$$\n使用 $n(r) = \\frac{1}{\\pi}\\exp(-2r)$，积分得出 $V_{\\mathrm{H}}(r) = \\frac{1}{r} - \\left(\\frac{1}{r}+1\\right)\\exp(-2r)$。\n现在我们计算 $E_{\\mathrm{H}}$：\n$$\nE_{\\mathrm{H}} = \\frac{1}{2} \\int_0^\\infty V_{\\mathrm{H}}(r) n(r) 4\\pi r^2 dr = \\frac{1}{2} \\int_0^\\infty \\left[\\frac{1}{r} - \\left(\\frac{1}{r}+1\\right)\\exp(-2r)\\right] \\left(\\frac{1}{\\pi}\\exp(-2r)\\right) 4\\pi r^2 dr\n$$\n$$\nE_{\\mathrm{H}} = 2 \\int_0^\\infty \\left[ r\\exp(-2r) - (r+r^2)\\exp(-4r) \\right] dr\n$$\n我们使用标准积分 $\\int_0^\\infty x^k \\exp(-ax) dx = k!/a^{k+1}$：\n- $\\int_0^\\infty r\\exp(-2r) dr = 1!/2^2 = \\frac{1}{4}$\n- $\\int_0^\\infty r^2\\exp(-4r) dr = 2!/4^3 = \\frac{2}{64} = \\frac{1}{32}$\n- $\\int_0^\\infty r\\exp(-4r) dr = 1!/4^2 = \\frac{1}{16}$\n代入这些结果：\n$$\nE_{\\mathrm{H}} = 2 \\left[ \\frac{1}{4} - \\left(\\frac{1}{16} + \\frac{1}{32}\\right) \\right] = 2 \\left[ \\frac{8}{32} - \\frac{2}{32} - \\frac{1}{32} \\right] = 2 \\left( \\frac{5}{32} \\right) = \\frac{5}{16}\n$$\n\nLDA 自相互作用误差 $\\Delta_{\\mathrm{LDA}}$ 的计算\n问题给出了自旋极化系统（$n_{\\uparrow}=n, n_{\\downarrow}=0$）的 LDA 交换能泛函为：\n$$\nE_{x}^{\\mathrm{LDA}}[n] = -\\frac{3}{4}\\left(\\frac{3}{\\pi}\\right)^{1/3}\\int n(\\mathbf{r})^{4/3}\\,d\\mathbf{r}\n$$\n我们计算积分 $\\int n(\\mathbf{r})^{4/3}\\,d\\mathbf{r}$：\n$$\n\\int n(r)^{4/3} 4\\pi r^2 dr = \\int_0^\\infty \\left(\\frac{1}{\\pi}\\exp(-2r)\\right)^{4/3} 4\\pi r^2 dr = 4\\pi \\pi^{-4/3} \\int_0^\\infty r^2 \\exp\\left(-\\frac{8}{3}r\\right) dr\n$$\n$$\n= 4\\pi^{-1/3} \\left( \\frac{2!}{(8/3)^3} \\right) = 4\\pi^{-1/3} \\left( \\frac{2}{512/27} \\right) = 4\\pi^{-1/3} \\left( \\frac{54}{512} \\right) = \\frac{27}{64}\\pi^{-1/3}\n$$\n现在我们将此代入 $E_{x}^{\\mathrm{LDA}}$ 的表达式中：\n$$\nE_{x}^{\\mathrm{LDA}} = -\\frac{3}{4}\\left(\\frac{3}{\\pi}\\right)^{1/3} \\left(\\frac{27}{64}\\pi^{-1/3}\\right) = -\\frac{3}{4} \\frac{3^{1/3}}{\\pi^{1/3}} \\frac{27}{64\\pi^{1/3}} = -\\frac{81 \\cdot 3^{1/3}}{256 \\pi^{2/3}} = -\\frac{3^{4} \\cdot 3^{1/3}}{256 \\pi^{2/3}} = -\\frac{3^{13/3}}{256 \\pi^{2/3}}\n$$\nLDA 的残余自相互作用误差为：\n$$\n\\Delta_{\\mathrm{LDA}} = E_{\\mathrm{H}} + E_{x}^{\\mathrm{LDA}} = \\frac{5}{16} - \\frac{3^{13/3}}{256 \\pi^{2/3}}\n$$\n\nGEA2 自相互作用误差 $\\Delta_{\\mathrm{GEA2}}$ 的计算\nGEA2 交换能由下式给出：\n$$\nE_{x}^{\\mathrm{GEA2}}[n] = -C_{x}\\int n^{4/3}\\left[1 + \\mu\\,s^{2}\\right]\\,d\\mathbf{r} = E_{x}^{\\mathrm{LDA}} - C_x \\mu \\int n^{4/3}s^2\\,d\\mathbf{r}\n$$\n我们需要计算梯度修正项。首先，我们求出约化梯度 $s$：\n$s = \\frac{|\\nabla n|}{2 k_F n}$，其中 $k_F = (3\\pi^2 n)^{1/3}$。\n对于给定的密度，$\\nabla n = \\frac{dn}{dr}\\hat{\\mathbf{r}} = -2 \\frac{1}{\\pi}\\exp(-2r) \\hat{\\mathbf{r}} = -2n\\hat{\\mathbf{r}}$，所以 $|\\nabla n| = 2n$。\n$$\ns = \\frac{2n}{2 (3\\pi^2 n)^{1/3} n} = \\frac{1}{(3\\pi^2 n)^{1/3}} \\implies s^2 = \\frac{1}{(3\\pi^2 n)^{2/3}} = \\frac{1}{3^{2/3}\\pi^{4/3}n^{2/3}}\n$$\n修正项的被积函数是 $n^{4/3}s^2$：\n$$\nn^{4/3}s^2 = n^{4/3} \\frac{1}{3^{2/3}\\pi^{4/3}n^{2/3}} = \\frac{n^{2/3}}{3^{2/3}\\pi^{4/3}}\n$$\n梯度修正能为：\n$$\n\\Delta E_{x}^{\\mathrm{GEA2}} = -C_x \\mu \\int \\frac{n^{2/3}}{3^{2/3}\\pi^{4/3}}\\,d\\mathbf{r} = -\\frac{C_x \\mu}{3^{2/3}\\pi^{4/3}} \\int n^{2/3}\\,d\\mathbf{r}\n$$\n我们计算积分 $\\int n^{2/3}\\,d\\mathbf{r}$：\n$$\n\\int n(r)^{2/3} 4\\pi r^2 dr = \\int_0^\\infty \\left(\\frac{1}{\\pi}\\exp(-2r)\\right)^{2/3} 4\\pi r^2 dr = 4\\pi \\pi^{-2/3} \\int_0^\\infty r^2 \\exp\\left(-\\frac{4}{3}r\\right) dr\n$$\n$$\n= 4\\pi^{1/3} \\left( \\frac{2!}{(4/3)^3} \\right) = 4\\pi^{1/3} \\left( \\frac{2}{64/27} \\right) = 4\\pi^{1/3} \\left( \\frac{54}{64} \\right) = \\frac{27}{8}\\pi^{1/3}\n$$\n将其连同 $C_x = \\frac{3}{4}\\left(\\frac{3}{\\pi}\\right)^{1/3}$ 和 $\\mu = \\frac{10}{81}$ 一起代回：\n$$\n\\Delta E_{x}^{\\mathrm{GEA2}} = -\\left(\\frac{3}{4}\\frac{3^{1/3}}{\\pi^{1/3}}\\right) \\left(\\frac{10}{81}\\right) \\frac{1}{3^{2/3}\\pi^{4/3}} \\left(\\frac{27}{8}\\pi^{1/3}\\right)\n$$\n$$\n= -\\frac{3 \\cdot 10 \\cdot 27}{4 \\cdot 81 \\cdot 8} \\frac{3^{1/3}}{3^{2/3}} \\frac{\\pi^{1/3}}{\\pi^{1/3}\\pi^{4/3}} = -\\frac{810}{2592} \\cdot 3^{-1/3} \\pi^{-4/3} = -\\frac{5 \\cdot 162}{16 \\cdot 162} \\cdot 3^{-1/3} \\pi^{-4/3} = -\\frac{5}{16} 3^{-1/3} \\pi^{-4/3}\n$$\n总的 GEA2 交换能为 $E_{x}^{\\mathrm{GEA2}} = E_{x}^{\\mathrm{LDA}} + \\Delta E_{x}^{\\mathrm{GEA2}}$。残余自相互作用误差为：\n$$\n\\Delta_{\\mathrm{GEA2}} = E_{\\mathrm{H}} + E_{x}^{\\mathrm{GEA2}} = \\frac{5}{16} - \\frac{3^{13/3}}{256 \\pi^{2/3}} - \\frac{5}{16} 3^{-1/3} \\pi^{-4/3}\n$$\n最终结果是 $\\Delta_{\\mathrm{LDA}}$ 和 $\\Delta_{\\mathrm{GEA2}}$ 的表达式。", "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{5}{16} - \\frac{3^{13/3}}{256 \\pi^{2/3}} & \\frac{5}{16} - \\frac{3^{13/3}}{256 \\pi^{2/3}} - \\frac{5 \\cdot 3^{-1/3}}{16 \\pi^{4/3}} \\end{pmatrix}}\n$$", "id": "2901403"}, {"introduction": "除了简单的单电子情况，近似泛函中的误差在描述化学过程时可能导致定性上的错误预测。氢分子（$H_{2}$）的解离过程便是诠释所谓静态或强关联误差的经典案例。通过分析为何限制性Kohn-Sham（RKS）方法在这个看似简单的体系中会失效，您将对单参考方法的局限性以及静态关联的本质获得深刻的物理直觉。[@problem_id:1407868]", "problem": "在计算量子化学领域，密度泛函理论 (DFT) 是一种广泛使用的方法。考虑使用限制性 Kohn-Sham (RKS) 形式对氢分子 H₂ 进行计算。在 RKS 方法中，对于像 H₂ 这样的单重态基态，两个电子都被约束在同一个空间 Kohn-Sham 轨道中。这种方法在分子接近其平衡键长时，能够对其进行合理的描述。然而，当核间距 $R$ 增大至解离（$R \\to \\infty$）时，RKS 计算得到的总能量在性质上是不正确的，其收敛值远高于两个分离的中性氢原子的真实能量。这一失败是静态（或强）相关误差的一个典型例子。\n\n下列哪项陈述为 RKS 方法在 H₂ 大核间距下的这一根本性失败提供了最准确的物理解释？\n\nA. 随着键的拉伸，单重态的 RKS 波函数被三重态特征严重污染，导致不正确的自旋态和人为的高能量。\n\nB. 该误差是由于使用了有限原子轨道基组。当原子分开时，不同中心上基函数之间的重叠消失，最小基组变得无法描述解离的碎片。\n\nC. 限制性形式迫使两个电子进入同一个空间分子轨道。在大间距下，该轨道是两个中心上原子轨道的等量组合，导致了非物理的 50% 离子态（H⁺H⁻）贡献，而离子态的能量远高于两个中性 H 原子的正确解离态。\n\nD. 该误差源于 Born-Oppenheimer 近似（假设原子核是静止的）在大核间距时失效，电子与核运动之间的耦合成为主要的能量贡献。\n\nE. 该失败完全是由于大多数近似交换相关泛函中存在的自相互作用误差所致。此误差导致每个电子非物理地排斥其自身的电荷密度，并且随着分子的解离，这种虚假的排斥会变得灾难性地大。", "solution": "我们分析在键被拉伸时，限制性 Kohn-Sham (RKS) 对 H₂ 单重态的描述。在针对闭壳层单重态的 RKS 形式中，两个电子占据同一个空间 Kohn-Sham 轨道 $\\varphi$，而自旋部分是单重态。总波函数的空间部分则为 $\\varphi(1)\\varphi(2)$，总的多电子态由单个双占据的 Slater 行列式乘以单重态自旋函数构成。\n\n在平衡位置附近，成键 Kohn-Sham 分子轨道可以用最小图像（在重叠趋于零的极限下变为精确）写为两个氢中心 A 和 B 上原子 $1s$ 轨道的 gerade 组合：\n$$\n\\varphi_{g}=\\frac{\\phi_{A}+\\phi_{B}}{\\sqrt{2(1+S_{AB})}},\n$$\n其中 $S_{AB}=\\int \\phi_{A}(\\mathbf{r})\\phi_{B}(\\mathbf{r})\\,d\\mathbf{r}$ 是重叠积分。当 $R\\to\\infty$ 时，$S_{AB}\\to 0$，因此\n$$\n\\varphi_{g}\\xrightarrow[R\\to\\infty]{}\\frac{\\phi_{A}+\\phi_{B}}{\\sqrt{2}}.\n$$\n在限制性双占据下，RKS 波函数的空间部分为\n$$\n\\varphi_{g}(1)\\varphi_{g}(2)=\\frac{1}{2}\\left(\\phi_{A}(1)+\\phi_{B}(1)\\right)\\left(\\phi_{A}(2)+\\phi_{B}(2)\\right),\n$$\n展开后为\n$$\n\\varphi_{g}(1)\\varphi_{g}(2)=\\frac{1}{2}\\Big[\\underbrace{\\phi_{A}(1)\\phi_{B}(2)+\\phi_{B}(1)\\phi_{A}(2)}_{\\text{covalent terms}}+\\underbrace{\\phi_{A}(1)\\phi_{A}(2)+\\phi_{B}(1)\\phi_{B}(2)}_{\\text{ionic terms}}\\Big].\n$$\n因此，在大 $R$ 极限下，RKS 空间波函数具有固定的 50%-50% 的共价和离子组分混合。单重态的正确解离极限是具有纯共价特征的 Heitler-London 形式，\n$$\n\\Psi_{\\text{HL}}=\\frac{1}{\\sqrt{2}}\\left[\\phi_{A}(1)\\phi_{B}(2)+\\phi_{B}(1)\\phi_{A}(2)\\right]\\chi_{\\text{singlet}},\n$$\n其中不包含离子项 $\\phi_{A}(1)\\phi_{A}(2)$ 或 $\\phi_{B}(1)\\phi_{B}(2)$。RKS 波函数中的离子组分对应于非物理的电荷分离构型 $\\text{H}^{+}\\text{H}^{-}$ 和 $\\text{H}^{-}\\text{H}^{+}$，其能量远高于大 $R$ 时两个中性、无相互作用的氢原子的能量。由于限制性形式强制双占据单个空间轨道，它无法在 $R\\to\\infty$ 时消除这些离子组分，因此能量仍然过高，表现出典型的静态相关误差。\n\n我们现在评估各个选项：\n\n- 选项 A 不正确：RKS 强制产生一个纯单重态（$\\hat{S}^{2}$ 的本征函数）。根据其构造，不存在三重态污染；自旋对称性破缺（以及任何相关的自旋污染）只会出现在非限制性处理中。\n- 选项 B 不正确：即使使用完备基组，限制性双占据也会强制产生上述的离子性混合；该失败并非由基组不完备性引起。\n- 选项 C 正确：限制性约束迫使两个电子进入同一个离域的成键轨道，导致在大 $R$ 时不可避免地产生 50% 的离子性贡献，这对于解离极限是非物理的，并将能量提升到远高于精确的双原子极限。\n- 选项 D 不正确：Born-Oppenheimer 近似并不会以能解释 H₂ 电子解离曲线上这种误差的方式失效；这里的主要问题是电子的静态相关。\n- 选项 E 的陈述不正确：虽然近似泛函中的自相互作用误差对 DFT 中的解离问题有贡献，但所述的根本性失败甚至在没有单电子自相互作用的限制性 Hartree-Fock 方法中也会发生。因此，这并非完全由自相互作用误差引起。\n\n因此，在给定选项中，最准确的物理解释是，强制的双占据导致在大间距下产生非物理的离子性混合。", "answer": "$$\\boxed{C}$$", "id": "1407868"}, {"introduction": "对泛函误差的理解和诊断催生了一种现代视角，其核心在于考察泛函在处理分数电子数或分数自旋时的行为。本练习利用一个简化的双中心模型来模拟分子的解离行为，并量化离域误差（与分数电荷相关）和分数自旋误差，这两种误差都是多电子自相互作用误差的具体表现。这个高级的计算实践将向您介绍“平直平面条件”，并提供一个强大的框架，用于分析和理解不同密度泛函在处理化学键拉伸等挑战性情况时的性能。[@problem_id:2815502]", "problem": "考虑一个用于拉伸双原子分子的双格点、每格点单轨道的解离极限模型，旨在捕捉 Kohn-Sham 密度泛函理论（Kohn-Sham DFT）中关键的自相互作用和离域特征。您将通过比较一个简化的精确参考（与系综密度泛函理论一致）和一个违反精确平面条件的玩具近似泛函，来为多电子自相互作用误差建立一个定量诊断方法。在原子单位（Hartree）下进行计算，因此所有能量都必须以 Hartree 为单位报告。\n\n基本和建模假设：\n- Hohenberg-Kohn 定理和系综密度泛函理论表明，基态能量相对于总电子数具有精确的分段线性，并且对于简并自旋态的系综，能量是恒定的。在此解离极限模型中，每个格点最多容纳一个电子。\n- 对于带单个电子的孤立格点，精确的格点能量与占据数呈线性关系：如果格点上的总占据数为 $n \\in [0,1]$，则精确的格点能量贡献为 $-I \\, n$，其中 $I$ 是相应原子的第一电离能。对于原子单位下的氢， $I \\approx 0.5$。\n- 格点不对称性通过能量偏置 $\\Delta$（以 Hartree 为单位）进行建模，使得格点 $A$ 上的单电子能量为 $-I_{A} = -(I + \\Delta/2)$，格点 $B$ 上的单电子能量为 $-I_{B} = -(I - \\Delta/2)$。正的 $\\Delta$ 使格点 $A$ 的能量更有利。\n- 典型的近似密度泛函的多电子自相互作用和离域误差由两个标量误差系数建模：\n  1. 电荷曲率系数 $c$（以 Hartree 为单位），每格点乘以 $n(1-n)$，该项在整数占据数时为零，在 $n = 1/2$ 时达到最大值。负的 $c$ 会在整数点之间的直线下方引入凸性偏差，从而偏好离域的分数电荷。\n  2. 自旋曲率系数 $s$（以 Hartree 为单位），每格点乘以 $n_{\\uparrow} n_{\\downarrow}$，该项对于纯自旋密度为零，在等量自旋混合时达到最大值。正的 $s$ 会惩罚分数自旋系综，在半对半自旋混合处产生一个错误的能量最大值。\n- 在解离极限下，对于局域轨道，无相互作用动能贡献可忽略不计，而在精确参考中，对于每格点一个电子的情况，Hartree 加精确交换项会精确抵消自相互作用。因此我们忽略上述模型修正之外的动能项和显式的电子-电子项。\n\n定义和任务：\n- 令格点上的自旋占据数为 $n_{A\\uparrow}$、$n_{A\\downarrow}$ 和 $n_{B\\uparrow}$、$n_{B\\downarrow}$。对于每个格点 $i \\in \\{A,B\\}$，总占据数为 $n_i = n_{i\\uparrow} + n_{i\\downarrow}$，在解离极限下 $0 \\le n_i \\le 1$。\n- 精确的格点能量模型为 $E_{\\text{exact},i} = -I_i \\, n_i$，总精确能量为 $E_{\\text{exact}} = \\sum_i E_{\\text{exact},i}$。\n- 玩具近似格点能量为 $E_{\\text{approx},i} = -I_i \\, n_i + c \\, n_i (1 - n_i) + s \\, n_{i\\uparrow} n_{i\\downarrow}$，总近似能量为 $E_{\\text{approx}} = \\sum_i E_{\\text{approx},i}$。\n\n您的程序必须为测试套件中提供的每组参数 $(I, c, s, \\Delta)$ 计算两种诊断值（以 Hartree 为单位）：\n1. 拉伸的 $H_2^+$（总共一个电子）的分数电荷离域误差：\n   - 使用总占据数 $n_A + n_B = 1$ 对单电子系统进行建模。为分离分数电荷效应，假设每个格点上的密度为纯自旋密度，因此对于两个 $i \\in \\{A,B\\}$，均有 $n_{i\\downarrow} = 0$ 和 $n_{i\\uparrow} = n_i$。\n   - 令 $\\alpha \\in [0,1]$ 表示格点 $A$ 上的电子分数，因此 $n_A = \\alpha$ 且 $n_B = 1 - \\alpha$。\n   - 精确的最小能量是整数局域化时两个格点线性能量中较低的一个。近似的最小能量通过在 $\\alpha \\in [0,1]$ 区间内最小化总近似能量得到。\n   - 将离域误差定义为 $\\Delta E_{\\text{charge}} = E_{\\text{approx}}^{\\min} - E_{\\text{exact}}^{\\min}$（以 Hartree 为单位）。负的 $\\Delta E_{\\text{charge}}$ 表示虚假的能量降低（离域误差）。\n2. 拉伸的 $H_2$（总共两个电子）的分数自旋误差：\n   - 强制在解离极限下每格点有一个电子，即 $n_A = n_B = 1$。\n   - 考虑在每个格点上进行半对半自旋混合，但具有相反的局域极化以产生总 $S_z = 0$ 的系综：在格点 $A$ 上，取 $n_{A\\uparrow} = 1/2$ 和 $n_{A\\downarrow} = 1/2$；在格点 $B$ 上，取 $n_{B\\uparrow} = 1/2$ 和 $n_{B\\downarrow} = 1/2$。\n   - 精确能量与分数自旋无关，等于 $n_A = n_B = 1$ 时线性格点能量的总和。近似能量则包含自旋曲率项。\n   - 将分数自旋误差定义为 $\\Delta E_{\\text{spin}} = E_{\\text{approx}}(\\text{半对半自旋}) - E_{\\text{exact}}$（以 Hartree 为单位）。正的 $\\Delta E_{\\text{spin}}$ 表示在分数自旋处存在错误的能量升高。\n\n不涉及角度单位。所有输出均为以 Hartree 为单位的能量。将每个报告的浮点数四舍五入到六位小数。\n\n测试套件：\n- 情况 1（对称，具有明显的离域和自旋误差）：$I = 0.5$, $c = -0.20$, $s = 0.30$, $\\Delta = 0.0$。\n- 情况 2（轻度不对称）：$I = 0.5$, $c = -0.10$, $s = 0.20$, $\\Delta = 0.15$。\n- 情况 3（无电荷曲率）：$I = 0.5$, $c = 0.0$, $s = 0.25$, $\\Delta = 0.0$。\n- 情况 4（强电荷曲率，强不对称性，无自旋曲率）：$I = 0.5$, $c = -0.50$, $s = 0.0$, $\\Delta = 0.60$。\n\n要求的最终输出格式：\n- 您的程序应生成单行输出，其中包含测试用例的结果，形式为一个用方括号括起来的逗号分隔列表。此列表中的每个元素对应一个测试用例，并且其本身必须是按 $[\\Delta E_{\\text{charge}}, \\Delta E_{\\text{spin}}]$ 顺序排列的双元素列表。例如，打印的行必须如下所示：[[x1,y1],[x2,y2],[x3,y3],[x4,y4]]，其中每个 $x_i$ 和 $y_i$ 都是以 Hartree 为单位、四舍五入到六位小数的浮点数。", "solution": "问题陈述在科学上是适定的、完整的，并且不包含任何矛盾。它描述了一个在理论化学中用于分析和理解密度泛函理论中自相互作用误差的有效且常见的玩具模型。因此，我们将继续推导所要求的两种误差诊断。\n\n首先，我们分析单电子系统（作为拉伸 $H_2^+$ 的模型）的分数电荷离域误差 $\\Delta E_{\\text{charge}}$。总电子数为 $1$。电子的分布由参数 $\\alpha$ 描述，其中格点 $A$ 的占据数为 $n_A = \\alpha$，格点 $B$ 的占据数为 $n_B = 1-\\alpha$，且 $\\alpha \\in [0,1]$。格点电离能定义为 $I_A = I + \\Delta/2$ 和 $I_B = I - \\Delta/2$。\n\n总精确能量是 $\\alpha$ 的线性函数：\n$E_{\\text{exact}}(\\alpha) = -I_A n_A - I_B n_B = -(I + \\Delta/2)\\alpha - (I - \\Delta/2)(1-\\alpha) = -I - \\Delta\\alpha + \\Delta/2$\n线性函数在闭区间 $[0,1]$ 上的最小值必然出现在端点。因此，最小精确能量为：\n$E_{\\text{exact}}^{\\min} = \\min(E_{\\text{exact}}(0), E_{\\text{exact}}(1)) = \\min(-I_B, -I_A) = \\min(-(I-\\Delta/2), -(I+\\Delta/2)) = -(I + |\\Delta|/2)$\n\n对于此单电子系统，问题指定了纯自旋密度 ($n_{i\\downarrow}=0$)，因此格点 $i$ 上的近似能量为 $E_{\\text{approx},i} = -I_i n_i + c \\, n_i(1-n_i)$，因为自旋曲率项 $s \\, n_{i\\uparrow}n_{i\\downarrow}$ 为零。总近似能量是两个格点的能量之和：\n$$E_{\\text{approx}}(\\alpha) = \\left[-I_A \\alpha + c\\alpha(1-\\alpha)\\right] + \\left[-I_B(1-\\alpha) + c(1-\\alpha)\\alpha\\right]$$\n$$E_{\\text{approx}}(\\alpha) = E_{\\text{exact}}(\\alpha) + 2c\\alpha(1-\\alpha) = -2c\\alpha^2 + (2c-\\Delta)\\alpha - I + \\Delta/2$$\n这是 $\\alpha$ 的二次函数。为求其在区间 $\\alpha \\in [0,1]$ 上的最小值 $E_{\\text{approx}}^{\\min}$，我们分析其对 $\\alpha$ 的导数：\n$$\\frac{dE_{\\text{approx}}}{d\\alpha} = -4c\\alpha + 2c - \\Delta$$\n令导数为零可得极值点 $\\alpha_{ext} = \\frac{2c-\\Delta}{4c} = \\frac{1}{2} - \\frac{\\Delta}{4c}$（对于 $c \\neq 0$）。该极值的性质取决于二阶导数 $\\frac{d^2E_{\\text{approx}}}{d\\alpha^2} = -4c$。\n\n- 如果 $c \\geq 0$，函数是凹函数或线性函数。在 $[0,1]$ 上的最小值必然在端点 $\\alpha=0$ 或 $\\alpha=1$ 处。在这些整数占据数下，$c \\cdot n_i(1-n_i)$ 项为零，因此 $E_{\\text{approx}}^{\\min} = E_{\\text{exact}}^{\\min}$。所以，对于 $c \\geq 0$，离域误差 $\\Delta E_{\\text{charge}} = 0$。\n- 如果 $c < 0$，函数是凸函数，$\\alpha_{ext}$ 对应于一个最小值。区间 $[0,1]$ 上的最小值是通过在 $\\alpha^* = \\max(0, \\min(1, \\alpha_{ext}))$ 处计算 $E_{\\text{approx}}(\\alpha)$ 得到的。令此最小值为 $E_{\\text{approx}}^{\\min}$。\n\n然后，离域误差计算为 $\\Delta E_{\\text{charge}} = E_{\\text{approx}}^{\\min} - E_{\\text{exact}}^{\\min}$。\n\n其次，我们分析双电子系统（$H_2$ 模型）的分数自旋误差 $\\Delta E_{\\text{spin}}$。问题指定每个格点的总占据数为一个电子，即 $n_A = 1$ 和 $n_B = 1$。所考虑的状态是一个非极化的自旋系综，由局域占据数 $n_{A\\uparrow}=n_{A\\downarrow}=1/2$ 和 $n_{B\\uparrow}=n_{B\\downarrow}=1/2$ 定义。\n\n对于固定的整数占据数，精确能量与自旋分布无关。它由线性格点能量的总和给出：\n$$E_{\\text{exact}} = -I_A n_A - I_B n_B = -I_A(1) - I_B(1) = -(I + \\Delta/2) - (I - \\Delta/2) = -2I$$\n\n近似能量使用完整的格点能量表达式计算：$E_{\\text{approx},i} = -I_i n_i + c \\, n_i(1-n_i) + s \\, n_{i\\uparrow}n_{i\\downarrow}$。\n对于每个格点 $i \\in \\{A, B\\}$，由于 $n_i=1$，电荷曲率项 $c \\, n_i(1-n_i)$ 为零。每个格点的自旋曲率项为 $s \\, n_{i\\uparrow}n_{i\\downarrow} = s(1/2)(1/2) = s/4$。\n总近似能量为：\n$$E_{\\text{approx}} = \\sum_{i \\in \\{A,B\\}} \\left(-I_i(1) + c(1)(0) + s/4 \\right) = (-I_A + s/4) + (-I_B + s/4) = -2I + s/2$$\n\n分数自旋误差是此状态下近似能量与精确能量之差：\n$$\\Delta E_{\\text{spin}} = E_{\\text{approx}} - E_{\\text{exact}} = (-2I + s/2) - (-2I) = s/2$$\n此误差完全由自旋曲率参数 $s$ 决定，这正是该模型的设计初衷。\n\n下面实现了这些推导出的公式，用于计算每个测试用例的诊断值。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates delocalization and fractional-spin errors for a two-site model\n    of a diatomic molecule in the dissociation limit, based on concepts from\n    Kohn-Sham DFT.\n    \"\"\"\n    test_cases = [\n        # (I, c, s, Delta)\n        # Case 1: symmetric, clear delocalization and spin errors\n        (0.5, -0.20, 0.30, 0.0),\n        # Case 2: mild asymmetry\n        (0.5, -0.10, 0.20, 0.15),\n        # Case 3: no charge curvature\n        (0.5, 0.0, 0.25, 0.0),\n        # Case 4: strong charge curvature, strong asymmetry, no spin curvature\n        (0.5, -0.50, 0.0, 0.60),\n    ]\n\n    all_results = []\n    \n    for I, c, s, delta in test_cases:\n        # --- Part 1: Fractional-charge delocalization error (Delta E_charge) ---\n\n        # The exact minimum energy for the one-electron system is determined by\n        # the electron localizing on the more favorable site.\n        E_exact_min = -(I + abs(delta) / 2.0)\n        \n        delta_E_charge = 0.0\n        if c  0:\n            # For c  0, the approximate energy function is convex and may have a\n            # minimum at a fractional charge distribution.\n            # The vertex of the quadratic E_approx(alpha) is at:\n            alpha_ext = 0.5 - delta / (4.0 * c)\n            \n            # The minimum on the interval [0, 1] is at alpha_ext if it falls\n            # within the interval, otherwise it's at the boundary.\n            alpha_star = np.clip(alpha_ext, 0.0, 1.0)\n            \n            # The total approximate energy is E_approx = E_exact + correction.\n            # E_exact(alpha) = -I - delta*alpha + delta/2\n            E_exact_at_alpha_star = -I - delta * alpha_star + delta / 2.0\n            correction_term = 2.0 * c * alpha_star * (1.0 - alpha_star)\n            E_approx_min = E_exact_at_alpha_star + correction_term\n            \n            delta_E_charge = E_approx_min - E_exact_min\n        \n        # --- Part 2: Fractional-spin error (Delta E_spin) ---\n        \n        # This error is calculated for a two-electron system (one per site)\n        # with a half-and-half spin mixture on each site.\n        # The error evaluates to s/2.\n        delta_E_spin = s / 2.0\n        \n        all_results.append([delta_E_charge, delta_E_spin])\n\n    # --- Final Output Formatting ---\n    # The output must be a single line, formatted as a list of lists of floats,\n    # with each float rounded to six decimal places.\n    # Ex: [[x1,y1],[x2,y2],[x3,y3],[x4,y4]]\n    \n    formatted_pairs = []\n    for res_pair in all_results:\n        # The :.6f format specifier handles both rounding and padding with zeros.\n        formatted_pairs.append(f\"[{res_pair[0]:.6f},{res_pair[1]:.6f}]\")\n    \n    final_output = f\"[{','.join(formatted_pairs)}]\"\n    print(final_output)\n\nsolve()\n```", "id": "2815502"}]}