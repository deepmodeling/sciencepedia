{"hands_on_practices": [{"introduction": "第一 Hohenberg-Kohn 定理指出，基态电子密度$n(\\mathbf{r})$可以唯一地确定系统的外势$v(\\mathbf{r})$。然而，“唯一”这个词的精确含义是什么？本练习[@problem_id:2994356]通过一个基础但至关重要的推导，探讨了当外势加上一个任意常数时系统会发生什么变化。通过这个实践，你将澄清密度到势的映射关系，并理解为何势是在相差一个常数的意义下才是唯一的。", "problem": "考虑一个在密度泛函理论 (DFT) 框架下的，包含 $N$ 个相互作用电子的非相对论体系，该体系处于一个外部标量势 $v(\\mathbf{r})$ 中。多电子哈密顿量为\n$$\n\\hat{H}[v] \\equiv \\hat{T} + \\hat{W} + \\sum_{i=1}^{N} v(\\hat{\\mathbf{r}}_{i}),\n$$\n其中 $\\hat{T}$ 是总动能算符，$\\hat{W}$ 是电子-电子相互作用算符，$\\hat{\\mathbf{r}}_{i}$ 是第 $i$ 个电子的位置算符。基态能量通过变分法定义为\n$$\nE_{0}[v] \\equiv \\inf_{\\substack{\\Psi \\in \\mathcal{H}_{N} \\\\ \\|\\Psi\\|=1}} \\langle \\Psi | \\hat{H}[v] | \\Psi \\rangle,\n$$\n其中 $\\mathcal{H}_{N}$ 是 $N$ 电子反对称希尔伯特空间。与归一化 $N$ 电子波函数 $\\Psi$ 相关联的基态密度为\n$$\nn_{\\Psi}(\\mathbf{r}) \\equiv N \\int |\\Psi(\\mathbf{r},\\mathbf{r}_{2},\\dots,\\mathbf{r}_{N})|^{2} \\, d\\mathbf{r}_{2}\\cdots d\\mathbf{r}_{N}.\n$$\n设 $C$ 为一个实常数（具有能量的量纲），定义一个平移后的势 $v'(\\mathbf{r}) \\equiv v(\\mathbf{r}) + C$，其对应的哈密顿量为 $\\hat{H}[v']$，基态能量为 $E_{0}[v']$。\n\n仅使用上述定义、Rayleigh-Ritz 变分原理和基本的算符性质，回答以下问题：\n\n1) 推导基态能量平移 $E_{0}[v'] - E_{0}[v]$ 的精确表达式，用 $C$ 和 $N$ 表示。假设 $C$ 的单位是哈特里 (Hartree)，请用哈特里 (Hartree) 表示你的最终答案。\n\n2) 证明存在一个 $\\hat{H}[v']$ 的基态波函数，其基态密度与 $\\hat{H}[v]$ 的基态密度相同。讨论非简并和简并基态两种情况。\n\n3) 说明您的结果对于第一 Hohenberg-Kohn 定理（Hohenberg-Kohn 第一定理）的精确含义，该定理涉及从基态密度 $n(\\mathbf{r})$ 到外部势 $v(\\mathbf{r})$ 映射的唯一性。\n\n只有第 1) 问有数值解或封闭形式的答案。为便于评分，请提供第 1) 问的单一封闭形式表达式作为最终答案。无需四舍五入。", "solution": "该问题在科学上是合理的、提法得当且客观的。这是密度泛函理论中一个标准的、基础性的练习，涉及外部势发生常数平移所带来的后果。\n\n### 第一部分：基态能量平移的推导\n\n分析始于两个哈密顿量 $\\hat{H}[v]$ 和 $\\hat{H}[v']$ 的定义，它们分别对应于外部势 $v(\\mathbf{r})$ 和 $v'(\\mathbf{r})$。两个势之间的关系为 $v'(\\mathbf{r}) = v(\\mathbf{r}) + C$，其中 $C$ 是一个常数。\n\n对于平移后的势，其哈密顿量 $\\hat{H}[v']$ 可以用原始哈密顿量 $\\hat{H}[v]$ 来表示。\n$$\n\\hat{H}[v'] = \\hat{T} + \\hat{W} + \\sum_{i=1}^{N} v'(\\hat{\\mathbf{r}}_{i})\n$$\n代入 $v'(\\mathbf{r})$ 的表达式：\n$$\n\\hat{H}[v'] = \\hat{T} + \\hat{W} + \\sum_{i=1}^{N} \\left(v(\\hat{\\mathbf{r}}_{i}) + C\\right)\n$$\n通过分配求和，我们可以将各项分开：\n$$\n\\hat{H}[v'] = \\left(\\hat{T} + \\hat{W} + \\sum_{i=1}^{N} v(\\hat{\\mathbf{r}}_{i})\\right) + \\sum_{i=1}^{N} C\n$$\n括号中的表达式即为原始哈密顿量 $\\hat{H}[v]$。第二项是一个常数对 $N$ 个电子的求和。\n$$\n\\sum_{i=1}^{N} C = NC\n$$\n此项是一个标量算符，等价于 $NC\\hat{I}$，其中 $\\hat{I}$ 是单位算符。因此，两个哈密顿量之间的关系是：\n$$\n\\hat{H}[v'] = \\hat{H}[v] + NC\n$$\n平移后势的基态能量 $E_0[v']$ 由 Rayleigh-Ritz 变分原理定义：\n$$\nE_{0}[v'] = \\inf_{\\substack{\\Psi \\in \\mathcal{H}_{N} \\\\ \\|\\Psi\\|=1}} \\langle \\Psi | \\hat{H}[v'] | \\Psi \\rangle\n$$\n代入 $\\hat{H}[v']$ 的表达式：\n$$\nE_{0}[v'] = \\inf_{\\substack{\\Psi \\in \\mathcal{H}_{N} \\\\ \\|\\Psi\\|=1}} \\langle \\Psi | \\left( \\hat{H}[v] + NC \\right) | \\Psi \\rangle\n$$\n利用内积的线性性，我们可以将期望值拆分：\n$$\nE_{0}[v'] = \\inf_{\\substack{\\Psi \\in \\mathcal{H}_{N} \\\\ \\|\\Psi\\|=1}} \\left( \\langle \\Psi | \\hat{H}[v] | \\Psi \\rangle + \\langle \\Psi | NC | \\Psi \\rangle \\right)\n$$\n因为 $NC$ 是一个标量，它可以从内积中提取出来：\n$$\n\\langle \\Psi | NC | \\Psi \\rangle = NC \\langle \\Psi | \\Psi \\rangle\n$$\n最小化是在所有归一化的波函数上进行的，对于这些波函数，$\\langle \\Psi | \\Psi \\rangle = 1$。因此：\n$$\n\\langle \\Psi | NC | \\Psi \\rangle = NC\n$$\n基态能量的表达式变为：\n$$\nE_{0}[v'] = \\inf_{\\substack{\\Psi \\in \\mathcal{H}_{N} \\\\ \\|\\Psi\\|=1}} \\left( \\langle \\Psi | \\hat{H}[v] | \\Psi \\rangle + NC \\right)\n$$\n常数项 $NC$ 不依赖于波函数 $\\Psi$，因此可以移到下确界运算的外面：\n$$\nE_{0}[v'] = \\left( \\inf_{\\substack{\\Psi \\in \\mathcal{H}_{N} \\\\ \\|\\Psi\\|=1}} \\langle \\Psi | \\hat{H}[v] | \\Psi \\rangle \\right) + NC\n$$\n根据定义，括号中的项是原始体系的基态能量 $E_0[v]$。\n$$\nE_{0}[v'] = E_{0}[v] + NC\n$$\n因此，基态能量平移为：\n$$\nE_{0}[v'] - E_{0}[v] = NC\n$$\n此表达式已按要求用 $C$ 和 $N$ 表示。如果 $C$ 的单位是哈特里 (Hartree)，那么 $NC$ 的单位也是哈特里 (Hartree)。\n\n### 第二部分：相同基态密度的证明\n\n我们需要证明存在一个 $\\hat{H}[v']$ 的基态波函数，它产生的基态密度与 $\\hat{H}[v]$ 的一个基态波函数所产生的基态密度相同。设 $\\Psi_{0}$ 为 $\\hat{H}[v]$ 的一个基态波函数。根据定义，它是 $\\hat{H}[v]$ 的一个本征函数，具有最低的本征值 $E_{0}[v]$：\n$$\n\\hat{H}[v] |\\Psi_{0}\\rangle = E_{0}[v] |\\Psi_{0}\\rangle\n$$\n现在，让我们将新的哈密顿量 $\\hat{H}[v']$ 作用于这同一个波函数 $\\Psi_{0}$：\n$$\n\\hat{H}[v'] |\\Psi_{0}\\rangle = (\\hat{H}[v] + NC) |\\Psi_{0}\\rangle\n$$\n利用算符的分配律以及 $\\hat{H}[v]$ 的本征值方程：\n$$\n\\hat{H}[v'] |\\Psi_{0}\\rangle = \\hat{H}[v]|\\Psi_{0}\\rangle + NC|\\Psi_{0}\\rangle = E_{0}[v]|\\Psi_{0}\\rangle + NC|\\Psi_{0}\\rangle\n$$\n$$\n\\hat{H}[v'] |\\Psi_{0}\\rangle = (E_{0}[v] + NC)|\\Psi_{0}\\rangle\n$$\n根据第一部分的结果，我们知道 $E_{0}[v'] = E_{0}[v] + NC$。将此代入上式，得到：\n$$\n\\hat{H}[v'] |\\Psi_{0}\\rangle = E_{0}[v'] |\\Psi_{0}\\rangle\n$$\n这个结果表明，$\\Psi_{0}$ 是 $\\hat{H}[v']$ 的一个本征函数，其本征值为 $E_{0}[v']$。由于 $E_{0}[v']$ 是势为 $v'(\\mathbf{r})$ 的体系的基态能量，因此 $\\Psi_{0}$ 是 $\\hat{H}[v']$ 的一个基态波函数。\n\n此结论与简并性无关：\n- **非简并情况：**如果 $\\hat{H}[v]$ 的基态是非简并的，其波函数 $\\Psi_{0}$ 是唯一的（在相差一个相位因子的意义上）。我们已经证明，这同一个波函数 $\\Psi_{0}$ 也是 $\\hat{H}[v']$ 的基态波函数。由于基态波函数完全相同，它们对应的基态密度 $n_{\\Psi_{0}}(\\mathbf{r})$ 也必然相同。\n- **简并情况：**如果 $\\hat{H}[v]$ 的基态是简并的，则基态是希尔伯特空间的一个子空间 $\\mathcal{E}_{0}[v]$。任何波函数 $\\Psi_{0} \\in \\mathcal{E}_{0}[v]$ 都是一个基态波函数。我们的证明表明，任何这样的 $\\Psi_{0}$ 也是 $\\hat{H}[v']$ 的本征函数，且具有基态本征值 $E_{0}[v']$。这意味着 $\\hat{H}[v']$ 的基态子空间 $\\mathcal{E}_{0}[v']$ 与 $\\hat{H}[v]$ 的基态子空间 $\\mathcal{E}_{0}[v]$ 完全相同：$\\mathcal{E}_{0}[v'] = \\mathcal{E}_{0}[v]$。因此，$\\hat{H}[v]$ 的任何一个基态波函数也都是 $\\hat{H}[v']$ 的一个基态波函数，所以它们共享同一组可能的基态密度。\n\n在两种情况下，我们都证明了存在一个（实际上是所有的）$\\hat{H}[v']$ 的基态波函数与 $\\hat{H}[v]$ 的一个基态波函数相同，因此产生相同的基态密度。\n\n### 第三部分：对第一 Hohenberg-Kohn 定理的启示\n\n第一 Hohenberg-Kohn (HK) 定理在 DFT 中建立了一个基本映射。它指出，一个相互作用电子体系的基态电子密度 $n(\\mathbf{r})$ 唯一地确定了外部势 $v(\\mathbf{r})$。\n\n第一和第二部分的结果揭示了该定理中的一个关键的微妙之处。我们已经证明，两个不同的外部势 $v(\\mathbf{r})$ 和 $v'(\\mathbf{r}) = v(\\mathbf{r}) + C$ (对于任何 $C \\ne 0$)，可以产生完全相同的基态波函数集合。其直接结果是，它们共享相同的基态密度或基态密度集合。\n\n这构成了对第一 HK 定理的简单化解释（即从密度 $n(\\mathbf{r})$ 到势 $v(\\mathbf{r})$ 的映射是严格一对一的）的一个直接反例。我们有两个不同的势 $v(\\mathbf{r})$ 和 $v'(\\mathbf{r})$，它们映射到同一个基态密度 $n(\\mathbf{r})$。\n\n因此，这个结果的精确含义是，第一 Hohenberg-Kohn 定理必须加以限定：**基态密度 $n(\\mathbf{r})$ 确定外部势 $v(\\mathbf{r})$ 的唯一性，仅在相差一个任意加性常数的意义上成立。** 第一 HK 定理的标准归谬法证明，隐含地依赖于一个假设，即所比较的两个势并非仅相差一个常数，因为这正是导致证明的核心矛盾无法成立的确切情况。该映射是在一个基态密度和一个势的等价类 $\\{v(\\mathbf{r}) + C | C \\in \\mathbb{R}\\}$ 之间的一一对应关系。", "answer": "$$\n\\boxed{NC}\n$$", "id": "2994356"}, {"introduction": "基于第一HK定理，既然密度能够确定势，那么原则上我们应该能从一个已知的基态密度反推出产生该密度的势，这个过程被称为“逆向问题”。本练习[@problem_id:209541]为你提供了一个亲手实践这个逆向过程的机会，你将为一个经典的高斯型密度函数找到其对应的外势。这个实践不仅展示了第一HK定理的构造性力量，也揭示了密度与势之间的深刻联系，即熟知的量子谐振子与其高斯型基态波函数之间的关系。", "problem": "根据密度泛函理论的第一 Hohenberg-Kohn 定理，一个多电子体系的基态电子密度 $n_0(\\mathbf{r})$ 除一个任意加性常数外，唯一地确定了外势 $v(\\mathbf{r})$。这条原理使得寻找能够产生已知基态密度的势这一“反”问题成为可能。\n\n考虑一个简单的一维系统，其中包含一个质量为 $m$ 的粒子，在一个未知的外势 $v(x)$ 中运动。该粒子是非相对论性的，并处于其基态。描述基态波函数 $\\psi_0(x)$ 和能量 $E_0$ 的不含时薛定谔方程为：\n$$\n-\\frac{\\hbar^2}{2m} \\frac{d^2 \\psi_0(x)}{dx^2} + v(x) \\psi_0(x) = E_0 \\psi_0(x)\n$$\n基态密度由 $n_0(x) = |\\psi_0(x)|^2$ 给出。\n\n假设该系统的基态密度已被确定为归一化高斯函数：\n$$\nn_0(x) = \\left(\\frac{\\alpha}{\\pi}\\right)^{1/2} e^{-\\alpha x^2}\n$$\n其中 $\\alpha$ 是一个正实数常量，其量纲为长度平方的倒数。\n\n你的任务是找出能产生该基态密度的外势 $v(x)$。为确保解的唯一性，势的定义应使其最小值为零。请用 $m$、$\\hbar$、$\\alpha$ 和 $x$ 来表示你的答案。", "solution": "1. 不含时薛定谔方程为\n$$\n-\\frac{\\hbar^2}{2m}\\frac{d^2\\psi_0(x)}{dx^2}+v(x)\\,\\psi_0(x)=E_0\\,\\psi_0(x)\\,.\n$$\n2. 基态密度为 $n_0(x)=|\\psi_0(x)|^2$，因此我们可将波函数选为实的、为正的形式\n$$\n\\psi_0(x)=\\biggl(\\frac{\\alpha}{\\pi}\\biggr)^{1/4}e^{-\\frac{\\alpha x^2}{2}}.\n$$\n3. 计算导数：\n$$\n\\frac{d\\psi_0}{dx}=-\\alpha x\\,\\psi_0,\\qquad\n\\frac{d^2\\psi_0}{dx^2}=(\\alpha^2x^2-\\alpha)\\,\\psi_0,\n$$\n因此\n$$\n\\frac{\\psi_0''(x)}{\\psi_0(x)}=\\alpha^2x^2-\\alpha.\n$$\n4. 代入薛定谔方程，并两边同除以 $\\psi_0$：\n$$\n-\\frac{\\hbar^2}{2m}(\\alpha^2x^2-\\alpha)+v(x)=E_0\n\\;\\Longrightarrow\\;\nv(x)=E_0+\\frac{\\hbar^2}{2m}(\\alpha^2x^2-\\alpha).\n$$\n5. 施加条件 $\\min_x v(x)=0$。最小值出现在 $x=0$ 处，所以\n$$\n0=v(0)=E_0-\\frac{\\hbar^2\\alpha}{2m}\n\\;\\Longrightarrow\\;\nE_0=\\frac{\\hbar^2\\alpha}{2m}.\n$$\n6. 将 $E_0$ 代回 $v(x)$ 的表达式中：\n$$\nv(x)=\\frac{\\hbar^2\\alpha}{2m}+\\frac{\\hbar^2}{2m}(\\alpha^2x^2-\\alpha)\n=\\frac{\\hbar^2\\alpha^2}{2m}x^2.\n$$", "answer": "$$\\boxed{\\frac{\\hbar^2\\alpha^2}{2m}x^2}$$", "id": "209541"}, {"introduction": "第二 Hohenberg-Kohn 定理建立了密度泛函理论中的能量变分原理，即任何试探密度得到的能量都不会低于真实的基态能量。然而，这一强大的原理有一个至关重要的前提。本练习[@problem_id:1407256]设计了一个思想实验，其中一个看似合理的计算得出了一个低于基态能量的矛盾结果。通过分析这个悖论，你将被迫直面变分原理的核心要求：试探密度必须是物理上有效的，即“N-可表示的”，从而深刻理解HK泛函的定义域及其变分性质。", "problem": "一位本科生正在探索密度泛函理论（DFT）的基础。他们决定在最简单的系统上——单个非相对论性的氢原子——测试 Hohenberg-Kohn（HK）变分原理。\n\n在原子单位下，氢原子的外势由 $v_{\\text{ext}}(\\mathbf{r}) = -1/r$ 给出。已知的精确基态能量为 $E_0 = -0.5$ 哈特里 (Hartree)。对于单电子系统，总能量可以表示为电子密度 $n(\\mathbf{r})$ 的一个精确泛函：\n$$E[n] = T_s[n] + \\int v_{\\text{ext}}(\\mathbf{r}) n(\\mathbf{r}) d^3\\mathbf{r}$$\n其中 $T_s[n]$ 是密度为 $n(\\mathbf{r})$ 的单个无相互作用电子的动能泛函。\n\n该学生使用两种不同的试探电子密度 $n_A(\\mathbf{r})$ 和 $n_B(\\mathbf{r})$ 进行了两次计算。\n1.  使用试探密度 $n_A(\\mathbf{r})$，计算出的能量为 $E[n_A] = -0.46$ 哈特里。\n2.  使用试探密度 $n_B(\\mathbf{r})$，计算出的能量为 $E[n_B] = -0.53$ 哈特里。\n\n第二个结果 $E[n_B] < E_0$ 似乎直接违反了第二 Hohenberg-Kohn 定理（即变分原理），该原理指出，任何有效的试探密度所产生的能量必须大于或等于真实的基态能量。假设动能泛函 $T_s[n]$ 被精确求值，并且所有数值积分都没有误差，那么造成这个悖论性结果的最根本的理论原因是什么？\n\nA. Hohenberg-Kohn 定理是为多电子系统推导的，并且已知在像氢原子这样的单电子系统的特殊情况下会失效。\nB. DFT 中的变分原理本身只是一个近似，并不能保证能量的下界。\nC. 这个结果必定是由于使用了近似的动能泛函 $T_s[n]$，因为即使对于单电子，该泛函的精确形式也是未知的。\nD. 试探密度 $n_B(\\mathbf{r})$ 对于单电子系统不是一个物理上有效的密度（即，它不是“N-可表示的”），因此违反了变分原理应用的一个关键先决条件。\nE. 计算 B 发现了一个比之前已知的更稳定的氢原子电子态，这表明 $E_0 = -0.5$ 哈特里 (Hartree) 并非真实的基态。", "solution": "我们从 Levy-Lieb 约束搜索形式的精确 Hohenberg-Kohn 变分表述开始。对于给定的外势 $v(\\mathbf{r})$ 和粒子数 $N$，定义普适泛函\n$$\nF[n] = \\min_{\\Psi \\to n} \\langle \\Psi | \\hat T + \\hat V_{ee} | \\Psi \\rangle,\n$$\n其中最小化是针对所有能产生密度 $n(\\mathbf{r})$ 的反对称 N-电子波函数 $\\Psi$。对于任何 N-可表示（即，来自至少一个这样的 $\\Psi$）的密度 $n$，DFT 能量泛函为\n$$\nE_{v}[n] = F[n] + \\int v(\\mathbf{r}) \\, n(\\mathbf{r}) \\, d^{3}\\mathbf{r}.\n$$\n设 $\\Psi_{n}$ 是一个在 $F[n]$ 的定义中达到（或任意接近）最小值的波函数。那么\n$$\nE_{v}[n] = \\langle \\Psi_{n} | \\hat T + \\hat V_{ee} | \\Psi_{n} \\rangle + \\int v \\, n\n= \\langle \\Psi_{n} | \\hat T + \\hat V_{ee} + \\hat V | \\Psi_{n} \\rangle \\ge E_{0},\n$$\n其中 $E_{0}$ 是精确的基态能量，不等式遵循 Rayleigh-Ritz 原理。因此，对于每一个 N-可表示的密度 $n$，我们有\n$$\nE_{v}[n] \\ge E_{0}.\n$$\n\n对于单电子系统，有 $\\hat V_{ee} = 0$ 并且\n$$\nF[n] = T_{s}[n] = \\min_{\\psi \\to n} \\langle \\psi | \\hat T | \\psi \\rangle = T_{W}[n],\n$$\n其中 Weizsäcker 泛函的精确形式为\n$$\nT_{W}[n] = \\frac{1}{8} \\int \\frac{|\\nabla n(\\mathbf{r})|^{2}}{n(\\mathbf{r})} \\, d^{3}\\mathbf{r},\n$$\n前提是 $n$ 是 N-可表示的并且足够正则，以至于 $\\sqrt{n} \\in H^{1}(\\mathbb{R}^{3})$（确保动能有限）。因此，对于任何物理上有效的单电子密度 $n$，\n$$\nE[n] = T_{s}[n] + \\int v_{\\text{ext}}(\\mathbf{r}) \\, n(\\mathbf{r}) \\, d^{3}\\mathbf{r} \\ge E_{0}.\n$$\n\n在该问题中，得到 $E[n_{B}] < E_{0}$ 的前提是假设 $T_{s}[n]$ 被精确求值且积分是精确的。上面的不等式表明，对于任何 N-可表示的单电子密度，这样的结果是不可能发生的。因此，唯一剩下的逻辑可能性是 $n_{B}$ 不是一个物理上可接受的单电子密度（不满足 N-可表示性，或者等价地说，对于通过约束搜索得到的 HK 变分界，它位于 $F[n]$ 的定义域之外）。典型的违规情况包括非负性缺失、未正确归一化到 $N=1$，或正则性不足，以至于不存在动能有限且满足 $|\\psi|^{2} = n_{B}$ 的波函数 $\\psi$。\n\n评估各个选项：\n- A 是错误的：HK 定理适用于任何 $N$，并且对于 $N=1$，泛函是精确已知的。\n- B 是错误的：对于其定义域内的约束搜索泛函，DFT 变分原理是严格成立的。\n- C 是错误的：对于 $N=1$，$T_{s}[n]$ 精确等于 $T_{W}[n]$。\n- D 是正确的：该悖论的产生是因为 $n_{B}$ 不是 N-可表示的，从而使得变分界无效。\n- E 是错误的：氢的 $E_{0}$ 是精确已知的，不可能被一个物理上有效的密度所突破。\n\n因此，最根本的理论原因是试探密度 $n_{B}$ 不是 N-可表示的。", "answer": "$$\\boxed{D}$$", "id": "1407256"}]}