{"hands_on_practices": [{"introduction": "均匀电子气 (Uniform Electron Gas, UEG) 是固态物理学和密度泛函理论中的一个基石模型。尽管它是一个理想化的假设系统，但推导其精确性质为构建局域密度近似 (Local Density Approximation, LDA) 提供了理论基础，而LDA是历史上最重要也是最简单的交换相关泛函。[@problem_id:2453886] 这项练习将引导你从第一性原理出发，推导非相互作用动能 $T_s$ 和交换能 $E_x$ 这两个关键能量项如何随电子密度 $\\rho$ 变化，从而让你亲身体验构建LDA泛函的核心思想。", "problem": "考虑一个三维均匀电子气（通常称为胶状模型）：在热力学极限下，大量自旋非极化的电子以恒定的数密度 $\\rho_{0}$ 占据一个体积为 $V$、具有周期性边界条件的立方盒子。使用哈特里原子单位制，即 $\\hbar=m_{e}=e=4\\pi\\varepsilon_{0}=1$。在科恩-沈密度泛函理论（DFT）中，无相互作用动能泛函 $T_{s}[\\rho]$ 定义为能够再现密度 $\\rho(\\mathbf{r})$ 的无相互作用参考系统的基态动能，而交换能泛函 $E_{x}[\\rho]$ 定义为该参考系统的福克交换能。\n\n对于均匀密度 $\\rho(\\mathbf{r})=\\rho_{0}$，假设自旋简并度为 $g_{s}=2$，确定 $T_{s}[\\rho_{0}]$ 和 $E_{x}[\\rho_{0}]$ 对 $\\rho_{0}$ 和 $V$ 的精确依赖关系。将您的最终答案表示为一个包含两个元素的行矩阵，按顺序为 $T_{s}[\\rho_{0}]$ 和 $E_{x}[\\rho_{0}]$，单位为哈特里原子单位。无需四舍五入。", "solution": "所述问题是有效的。这是一个源于固态物理学和密度泛函理论的典型问题，涉及均匀电子气，也称为胶状模型。问题的前提在科学上是合理的、提法是明确的，并且所有必要信息都已提供。我们将开始求解。\n\n问题要求解出在体积 $V$ 中密度恒为 $\\rho_0$ 的均匀电子气的无相互作用动能泛函 $T_s[\\rho_0]$ 和交换能泛函 $E_x[\\rho_0]$。我们在哈特里原子单位制下进行计算，其中 $\\hbar = m_e = e = 4\\pi\\varepsilon_0 = 1$。给定的自旋简并度为 $g_s=2$。\n\n首先，我们确定无相互作用动能 $T_s[\\rho_0]$。根据定义，这是一个具有基态密度 $\\rho_0$ 的无相互作用电子系统的动能。对于均匀气体，无相互作用参考系统就是一个无相互作用的费米子气体。基态是通过填充单粒子能级直至费米能来构建的。\n\n在体积为 $V=L^3$、具有周期性边界条件的立方盒子中，电子的单粒子波函数是平面波：\n$$\n\\psi_{\\mathbf{k}}(\\mathbf{r}) = \\frac{1}{\\sqrt{V}} \\exp(i\\mathbf{k} \\cdot \\mathbf{r})\n$$\n相应的动能为：\n$$\n\\epsilon_{\\mathbf{k}} = \\frac{\\hbar^2 |\\mathbf{k}|^2}{2m_e} = \\frac{|\\mathbf{k}|^2}{2}\n$$\n在基态中，所有波矢幅度 $|\\mathbf{k}|$ 小于或等于费米波矢 $k_F$ 的态都将被占据。电子总数 $N$ 与密度 $\\rho_0$ 的关系为 $N = \\rho_0 V$。在热力学极限下，对离散 $\\mathbf{k}$ 态的求和可以用在 $\\mathbf{k}$ 空间中的积分来代替：\n$$\n\\sum_{\\mathbf{k}} \\to V \\int \\frac{d^3\\mathbf{k}}{(2\\pi)^3}\n$$\n通过对 $\\mathbf{k}$ 空间中费米球的体积进行积分，并乘以自旋简并度 $g_s=2$，可以得到电子总数：\n$$\nN = g_s V \\int_{|\\mathbf{k}| \\le k_F} \\frac{d^3\\mathbf{k}}{(2\\pi)^3} = 2V \\left( \\frac{4\\pi k_F^3}{3(2\\pi)^3} \\right) = V \\frac{k_F^3}{3\\pi^2}\n$$\n由此，我们建立了密度 $\\rho_0 = N/V$ 和费米波矢 $k_F$ 之间的关系：\n$$\n\\rho_0 = \\frac{k_F^3}{3\\pi^2} \\implies k_F = (3\\pi^2 \\rho_0)^{1/3}\n$$\n总的无相互作用动能 $T_s[\\rho_0]$ 是所有被占据态的能量之和：\n$$\nT_s[\\rho_0] = g_s \\sum_{|\\mathbf{k}| \\le k_F} \\epsilon_{\\mathbf{k}} = g_s V \\int_{|\\mathbf{k}| \\le k_F} \\frac{|\\mathbf{k}|^2}{2} \\frac{d^3\\mathbf{k}}{(2\\pi)^3}\n$$\n代入 $g_s=2$ 并转换到 $\\mathbf{k}$ 空间中的球坐标（$d^3\\mathbf{k} = 4\\pi |\\mathbf{k}|^2 d|\\mathbf{k}|$），积分变为：\n$$\nT_s[\\rho_0] = 2 V \\frac{4\\pi}{(2\\pi)^3} \\int_0^{k_F} \\frac{k^2}{2} k^2 dk = \\frac{V}{\\pi^2} \\int_0^{k_F} \\frac{k^4}{2} dk = \\frac{V}{2\\pi^2} \\left[ \\frac{k^5}{5} \\right]_0^{k_F} = \\frac{V k_F^5}{10\\pi^2}\n$$\n最后，我们将 $k_F$ 的表达式用 $\\rho_0$ 代入：\n$$\nT_s[\\rho_0] = \\frac{V}{10\\pi^2} \\left[ (3\\pi^2 \\rho_0)^{1/3} \\right]^5 = \\frac{V}{10\\pi^2} (3\\pi^2)^{5/3} \\rho_0^{5/3} = \\frac{3^{5/3}\\pi^{10/3}}{10\\pi^2} V \\rho_0^{5/3} = \\frac{3}{10}(3\\pi^2)^{2/3} V \\rho_0^{5/3}\n$$\n这就是对均匀密度求值的著名的 Thomas-Fermi 动能泛函。\n\n接下来，我们确定交换能 $E_x[\\rho_0]$。对于均匀电子气，由局域密度近似（LDA）给出的交换能是精确的。LDA 交换能泛函由下式给出：\n$$\nE_x^{\\text{LDA}}[\\rho] = \\int e_x^{\\text{unif}}(\\rho(\\mathbf{r})) d^3\\mathbf{r}\n$$\n其中 $e_x^{\\text{unif}}(\\rho)$ 是密度为 $\\rho$ 的均匀、自旋非极化电子气的单位体积交换能。该量的标准表达式为：\n$$\ne_x^{\\text{unif}}(\\rho) = - C_x \\rho^{4/3}\n$$\n其中常数 $C_x$ 由下式给出：\n$$\nC_x = \\frac{3}{4} \\left(\\frac{3}{\\pi}\\right)^{1/3}\n$$\n对于所讨论的系统，密度是恒定的，$\\rho(\\mathbf{r}) = \\rho_0$。因此，交换能为：\n$$\nE_x[\\rho_0] = \\int -C_x \\rho_0^{4/3} d^3\\mathbf{r} = -C_x \\rho_0^{4/3} \\int d^3\\mathbf{r} = -C_x V \\rho_0^{4/3}\n$$\n代入 $C_x$ 的表达式：\n$$\nE_x[\\rho_0] = -\\frac{3}{4} \\left(\\frac{3}{\\pi}\\right)^{1/3} V \\rho_0^{4/3}\n$$\n这就是均匀电子气的精确交换能。\n\n我们按照要求将两个结果合并成一个行矩阵。\n第一个元素是 $T_s[\\rho_0] = \\frac{3}{10}(3\\pi^2)^{2/3} V \\rho_0^{5/3}$。\n第二个元素是 $E_x[\\rho_0] = -\\frac{3}{4}(\\frac{3}{\\pi})^{1/3} V \\rho_0^{4/3}$。", "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{3}{10}(3\\pi^{2})^{2/3} V \\rho_{0}^{5/3} & - \\frac{3}{4} \\left(\\frac{3}{\\pi}\\right)^{1/3} V \\rho_{0}^{4/3} \\end{pmatrix}}\n$$", "id": "2453886"}, {"introduction": "在基于均匀电子气建立起近似泛函的基础后，理解这些局域近似在何处失效至关重要。本实践将探讨任何有限体系都具有的一个基本且非局域的性质：精确交换相关势 $v_{\\mathrm{xc}}$ 的远程衰减行为。[@problem_id:2768010] 通过推导精确的 $-1/r$ 行为，并将其与半局域泛函（如LDA和GGA）预测的错误指数衰减进行对比，你将对泛函发展的挑战以及DFT计算中常见误差的来源有更深刻的认识。", "problem": "考虑一个孤立、有限、电中性的 $N$ 电子体系，其点状原子核位于位置 $\\{\\mathbf{R}_{A}\\}$ 且带有电荷 $\\{Z_{A}\\}$，该体系在 Kohn–Sham 密度泛函理论（Kohn–Sham DFT）的框架内进行描述。Kohn–Sham 有效势为 $v_{s}(\\mathbf{r}) = v_{\\mathrm{ext}}(\\mathbf{r}) + v_{H}(\\mathbf{r}) + v_{\\mathrm{xc}}(\\mathbf{r})$，其中 $v_{\\mathrm{ext}}(\\mathbf{r}) = -\\sum_{A} \\frac{Z_{A}}{|\\mathbf{r} - \\mathbf{R}_{A}|}$ 是由原子核产生的外部势，$v_{H}(\\mathbf{r})$ 是电子密度 $n(\\mathbf{r})$ 的 Hartree（经典库仑）势，而 $v_{\\mathrm{xc}}(\\mathbf{r})$ 是交换相关（xc）势。假设该体系是有限且电中性的，即 $\\sum_{A} Z_{A} = N$，并且密度 $n(\\mathbf{r})$ 是局域的。\n\n仅使用以下基本事实与定义作为出发点：\n\n1) 存在一个交换相关能的精确表示，它通过耦合常数平均的交换相关空穴 $\\bar{n}_{\\mathrm{xc}}(\\mathbf{r}',\\mathbf{r})$ 给出：\n$$\nE_{\\mathrm{xc}}[n] \\;=\\; \\frac{1}{2} \\int d\\mathbf{r} \\int d\\mathbf{r}' \\, \\frac{n(\\mathbf{r})\\, \\bar{n}_{\\mathrm{xc}}(\\mathbf{r}',\\mathbf{r})}{|\\mathbf{r} - \\mathbf{r}'|},\n$$\n其中，对于每个固定的 $\\mathbf{r}$，该空穴遵循求和规则和局域化性质：\n$$\n\\int d\\mathbf{r}' \\, \\bar{n}_{\\mathrm{xc}}(\\mathbf{r}',\\mathbf{r}) \\;=\\; -1, \\qquad \\text{以及} \\qquad \\text{对于有限体系，} \\bar{n}_{\\mathrm{xc}}(\\mathbf{r}',\\mathbf{r}) \\text{ 在 } \\mathbf{r}' \\text{ 中是局域的。}\n$$\n\n2) 均匀电子气的局域密度近似（LDA）交换能密度为\n$$\n\\varepsilon_{x}(n) \\;=\\; -\\frac{3}{4} \\left( \\frac{3}{\\pi} \\right)^{1/3} n^{4/3},\n$$\n且相应的 LDA 交换势为\n$$\nv_{x}^{\\mathrm{LDA}}(n) \\;=\\; \\frac{d}{dn}\\!\\left[ n\\, \\varepsilon_{x}(n) \\right] \\;=\\; -\\left( \\frac{3}{\\pi} \\right)^{1/3} n^{1/3}.\n$$\n\n3) 一个第一电离能为 $I$ 的有限体系，其精确的基态密度具有如下渐近形式：\n$$\nn(r) \\;\\sim\\; A\\, r^{\\beta} \\exp\\!\\big( -2 \\sqrt{2 I}\\, r \\big) \\quad \\text{当 } r \\to \\infty \\text{ 时},\n$$\n其中常数 $A$ 和 $\\beta$ 由最高占据 Kohn–Sham 轨道决定。\n\n任务：\n\n(a) 从第 1 条和针对局域电荷分布的基本静电学（多极展开）出发，推导在一个中性、有限体系中，当 $r \\to \\infty$ 时，精确交换相关势 $v_{\\mathrm{xc}}(r)$ 的前导阶渐近行为。\n\n(b) 使用第 2 和第 3 条，确定当 $r \\to \\infty$ 时，LDA 交换势 $v_{x}^{\\mathrm{LDA}}(r)$ 的前导渐近行为，并解释为何任何半局域地依赖于 $n(\\mathbf{r})$ 及其有限阶导数的广义梯度近似（GGA）也无法复现你在 (a) 部分得到的前导项。\n\n仅报告你在 (a) 部分中得到的 $v_{\\mathrm{xc}}(r)$ 的前导渐近表达式，作为一个单一的闭式解析表达式。不包含单位。", "solution": "该题目陈述已经过评估并被确定为有效。它在密度泛函理论中有坚实的科学基础，内容自洽且提法恰当。其先验陈述和定义在此理论化学领域是标准且正确的。我们开始解答。\n\n(a) 精确交换相关势 $v_{\\mathrm{xc}}(r)$ 的渐近行为的推导。\n\n本任务旨在推导一个有限、中性体系中，当距离 $r = |\\mathbf{r}|$ 很大时，精确交换相关势 $v_{\\mathrm{xc}}(\\mathbf{r})$ 的前导阶行为。出发点是题目提供的用耦合常数平均的交换相关空穴 $\\bar{n}_{\\mathrm{xc}}(\\mathbf{r}',\\mathbf{r})$ 表示的交换相关能 $E_{\\mathrm{xc}}[n]$ 的表达式。虽然 $v_{\\mathrm{xc}}(\\mathbf{r})$ 的形式化定义是泛函导数 $\\frac{\\delta E_{\\mathrm{xc}}[n]}{\\delta n(\\mathbf{r})}$，但通过题目陈述强烈暗示的静电类比，可以为渐近区域得到一个直接且物理上清晰的推导。\n\n量 $\\bar{n}_{\\mathrm{xc}}(\\mathbf{r}',\\mathbf{r})$ 代表了围绕一个位于位置 $\\mathbf{r}$ 的电子的交换相关空穴的电荷分布。该空穴的总电荷由第 1 条中的求和规则给出：\n$$\n\\int d\\mathbf{r}' \\, \\bar{n}_{\\mathrm{xc}}(\\mathbf{r}',\\mathbf{r}) = -1\n$$\n这意味着该空穴对应于 -1 个元电荷的净电荷。对于一个有限体系，电子密度 $n(\\mathbf{r})$ 局域在原子核周围（我们将其置于原点 $\\mathbf{r}=0$ 附近）。当参考电子位于远离体系的位置 $\\mathbf{r}$（$r \\to \\infty$）时，它在电子密度中诱导出的空穴也必须局域在密度所在的区域，即原点附近。因此，对于大的 $|\\mathbf{r}|$，空穴分布 $\\bar{n}_{\\mathrm{xc}}(\\mathbf{r}',\\mathbf{r})$ 在积分变量 $\\mathbf{r}'$ 中是局域在原点附近的。\n\n交换相关势 $v_{\\mathrm{xc}}(\\mathbf{r})$ 可以恰当地理解为单位电荷对抗交换相关空穴场做的功，这对应于由交换相关空穴电荷分布产生的静电势。\n$$\nv_{\\mathrm{xc}}(\\mathbf{r}) = \\int d\\mathbf{r}' \\frac{\\bar{n}_{\\mathrm{xc}}(\\mathbf{r}',\\mathbf{r})}{|\\mathbf{r} - \\mathbf{r}'|}\n$$\n要找到该势在 $r \\to \\infty$ 时的渐近行为，我们可以对库仑核 $|\\mathbf{r} - \\mathbf{r}'|^{-1}$ 进行多极展开，因为 $|\\mathbf{r}|$ 很大，而 $|\\mathbf{r}'|$ 被限制在原点附近的一个有限区域内。展开式为：\n$$\n\\frac{1}{|\\mathbf{r} - \\mathbf{r}'|} = \\frac{1}{r} + \\frac{\\mathbf{r} \\cdot \\mathbf{r}'}{r^3} + \\dots = \\frac{1}{r} + O\\left(\\frac{1}{r^2}\\right)\n$$\n将此展开式的前导项代入 $v_{\\mathrm{xc}}(\\mathbf{r})$ 的积分中，得到：\n$$\nv_{\\mathrm{xc}}(\\mathbf{r}) = \\int d\\mathbf{r}' \\left( \\frac{1}{r} + O\\left(\\frac{1}{r^2}\\right) \\right) \\bar{n}_{\\mathrm{xc}}(\\mathbf{r}',\\mathbf{r}) = \\frac{1}{r} \\int d\\mathbf{r}' \\bar{n}_{\\mathrm{xc}}(\\mathbf{r}',\\mathbf{r}) + \\int d\\mathbf{r}' O\\left(\\frac{1}{r^2}\\right) \\bar{n}_{\\mathrm{xc}}(\\mathbf{r}',\\mathbf{r})\n$$\n第一项是单极矩贡献。使用空穴求和规则 $\\int d\\mathbf{r}' \\, \\bar{n}_{\\mathrm{xc}}(\\mathbf{r}',\\mathbf{r}) = -1$，此项变为 $-\\frac{1}{r}$。更高阶的项，如偶极矩项，衰减得更快（以 $1/r^2$ 或更快的速率）。因此，精确交换相关势的前导阶渐近行为是：\n$$\nv_{\\mathrm{xc}}(r) \\to -\\frac{1}{r} \\quad \\text{当 } r \\to \\infty \\text{ 时}\n$$\n这个结果与以下物理图像是一致的：一个远离中性 $N$ 电子体系的电子，必然会感受到剩余的 $(N-1)$ 电子阳离子的库仑势，该阳离子带有 $+1$ 的净电荷。总的 Kohn-Sham 势 $v_s(\\mathbf{r})$ 必须复现这个物理势。对于一个中性体系，外部核势 $v_{\\mathrm{ext}}(r) \\to -N/r$ 和 Hartree 势 $v_H(r) \\to N/r$ 的和会导致 $1/r$ 项的抵消，余项 $v_{\\mathrm{ext}}(r) + v_H(r)$ 以 $O(1/r^2)$ 或更快的速率衰减。因此， $v_s(r)$ 正确的 $-1/r$ 渐近行为必须完全来自于 $v_{\\mathrm{xc}}(r)$。\n\n(b) LDA 和 GGA 势的渐近行为。\n\n交换势的局域密度近似（LDA）在第 2 条中被给出为电子密度 $n(\\mathbf{r})$ 的一个纯局域函数：\n$$\nv_{x}^{\\mathrm{LDA}}(r) = v_{x}^{\\mathrm{LDA}}(n(r)) = -\\left( \\frac{3}{\\pi} \\right)^{1/3} [n(r)]^{1/3}\n$$\n精确基态密度的渐近形式在第 3 条中给出：\n$$\nn(r) \\sim A r^{\\beta} \\exp(-2 \\sqrt{2 I} r) \\quad \\text{当 } r \\to \\infty \\text{ 时}\n$$\n将该密度代入 LDA 势的表达式中，得到：\n$$\nv_{x}^{\\mathrm{LDA}}(r) \\sim -\\left( \\frac{3}{\\pi} \\right)^{1/3} \\left[ A r^{\\beta} \\exp(-2 \\sqrt{2 I} r) \\right]^{1/3} = -C r^{\\beta/3} \\exp\\left(-\\frac{2}{3} \\sqrt{2 I} r\\right)\n$$\n其中 $C$ 是一个常数。该势指数衰减至零。这种指数衰减与精确势 $v_{\\mathrm{xc}}(r) \\to -1/r$ 的缓慢幂律衰减有着本质的不同。LDA 势在渐近区域消失得过快。\n\n这个缺陷不局限于 LDA。任何广义梯度近似（GGA）都将交换相关能定义为一个函数的积分，该函数半局域地依赖于密度 $n(\\mathbf{r})$ 及其有限阶导数，例如 $E_{\\mathrm{xc}}^{\\mathrm{GGA}} = \\int f(n(\\mathbf{r}), \\nabla n(\\mathbf{r}), \\nabla^2 n(\\mathbf{r}), \\dots) d\\mathbf{r}$。相应的势 $v_{\\mathrm{xc}}^{\\mathrm{GGA}}(\\mathbf{r})$ 也将是 $n(\\mathbf{r})$ 及其导数的一个半局域函数。\n\n鉴于 $n(r)$ 随着 $r \\to \\infty$ 指数衰减，它的所有导数也将以相同的指数速率衰减，例如 $|\\nabla n(r)| \\sim \\exp(-2 \\sqrt{2 I} r)$， $|\\nabla^2 n(r)| \\sim \\exp(-2 \\sqrt{2 I} r)$，依此类推。任何由这些指数衰减的量构建的势本身也将呈指数衰减。\n$$\nv_{\\mathrm{xc}}^{\\mathrm{GGA}}(r) \\sim \\exp(-\\delta r) \\quad (\\text{对于某个 } \\delta > 0)\n$$\n因此，所有标准的 GGA 泛函也无法复现交换相关势正确的 $-1/r$ 尾部行为。这是半局域近似的一个普遍缺陷，它们从其构造上就是“短视的”，无法捕捉到编码在交换相关空穴求和规则中、决定了势的长程行为的非局域信息。", "answer": "$$\n\\boxed{-\\frac{1}{r}}\n$$", "id": "2768010"}, {"introduction": "从理论走向实践，求解 Kohn-Sham 方程需要一个迭代的自洽场 (Self-Consistent Field, SCF) 过程，但这个过程常常难以收敛。本练习将深入探讨最广泛使用的收敛加速技术——迭代子空间直接求逆 (Direct Inversion in the Iterative Subspace, DIIS) 方法。[@problem_id:2768007] 你将首先从最小化残差的原理出发，推导出 DIIS 的核心方程，然后将其应用于一个具体的数值算例，从而在抽象的优化理论与实用的计算化学实践之间架起一座桥梁。", "problem": "考虑关于基态电子密度的科恩-尚密度泛函理论不动点问题，其表述为寻找一个密度 $n(\\mathbf{r})$ 使得 $n(\\mathbf{r}) = \\mathcal{F}[n](\\mathbf{r})$ 成立，其中 $\\mathcal{F}$ 是科恩-尚映射，它将输入密度映射到通过求解在该输入密度产生的有效势下的单粒子科恩-尚方程所得到的输出密度。设与某一试验密度 $n$ 相关联的残差为 $r[n](\\mathbf{r}) = \\mathcal{F}[n](\\mathbf{r}) - n(\\mathbf{r})$。在离散化表示中，将残差写成向量 $r \\in \\mathbb{R}^{N}$，并假设一个对称正定预条件子 $M \\in \\mathbb{R}^{N \\times N}$ 定义了加权内积 $\\langle x, y \\rangle_{M} = x^{\\mathsf{T}} M y$ 和诱导范数 $\\|x\\|_{M} = \\sqrt{x^{\\mathsf{T}} M x}$。\n\n给定一组过去的试验密度 $\\{n_{i}\\}_{i=1}^{k}$ 及其相关联的残差 $\\{r_{i}\\}_{i=1}^{k}$，我们希望构造一个外推密度 $n^{\\ast} = \\sum_{i=1}^{k} c_{i} n_{i}$，其系数满足仿射约束 $\\sum_{i=1}^{k} c_{i} = 1$。假设残差在该子空间上是局部仿射的，因此有 $r[n^{\\ast}] \\approx \\sum_{i=1}^{k} c_{i} r_{i}$。\n\n任务：\n- 从基本层面简要解释，预处理（通过 $M$ 起作用）和 Pulay/迭代子空间直接求逆（DIIS）加速方法如何在不借助任何黑箱公式的情况下，改善自洽场（SCF）的收敛性。\n- 仅从不动点表述、残差的定义以及上述 $M$-加权范数出发，建立并推导使 $\\| \\sum_{i=1}^{k} c_{i} r_{i} \\|_{M}^{2}$ 最小化（在约束条件 $\\sum_{i=1}^{k} c_{i} = 1$ 下）的系数向量 $c = (c_{1},\\dots,c_{k})^{\\mathsf{T}}$ 的一阶最优性条件。你的推导应得出用 $\\{r_{i}\\}$ 和 $M$ 表示 $c$ 的闭式表达式。\n\n现在，将问题特殊化到 $k=2$ 的二维离散情况，其中\n$$\nr_{1} = \\begin{pmatrix} 1 \\\\ 2 \\end{pmatrix}, \\quad\nr_{2} = \\begin{pmatrix} -1 \\\\ 1 \\end{pmatrix}, \\quad\nM = \\begin{pmatrix} 2 & 0 \\\\ 0 & 1 \\end{pmatrix}.\n$$\n计算在仿射约束下使外推残差的 $M$-范数最小的 DIIS 系数 $c_{1}$ 和 $c_{2}$。请将你的最终答案以精确形式表示为单个行向量 $(c_{1}\\; c_{2})$。不要四舍五入。", "solution": "所提出的问题是适定的，具有科学依据，并包含了完整求解所需的所有信息。我们将着手进行分析。\n\n自洽场（SCF）程序旨在求解一个非线性不动点问题，在科恩-尚密度泛函理论的背景下，该问题为 $n(\\mathbf{r}) = \\mathcal{F}[n](\\mathbf{r})$。简单的迭代替换，即简单混合法，通常无法收敛。这种失败通常是由于所谓的电荷振荡，即电子密度在迭代过程中在系统的不同区域之间不稳定地振荡。在数学上，这对应于映射 $\\mathcal{F}$ 的雅可比矩阵存在模大于1的特征值，从而导致误差分量被放大。\n\n迭代子空间直接求逆（DIIS）方法，也称为 Pulay 混合法，提供了一种稳健的补救措施。它是一种外推技术，而非简单的混合方案。DIIS 方法不只使用上一次的迭代结果，而是考虑了包含 $k$ 个先前试验密度 $\\{n_i\\}$ 及其相应残差 $\\{r_i\\}$ 的历史记录。其核心假设是残差映射在这些迭代向量所张成的子空间上是近似仿射的。然后，DIIS 通过寻找一组系数 $\\{c_i\\}$ 来构造一个新的试验密度 $n^{\\ast} = \\sum_{i=1}^{k} c_{i} n_{i}$，这组系数在满足归一化约束 $\\sum_{i=1}^{k} c_i = 1$ 的条件下，使得相应的外推残差 $\\sum_{i=1}^{k} c_{i} r_{i}$ 的范数最小。该过程旨在密度仿射子空间中寻找一个点，该点最接近满足不动点条件 $r[n]=\\mathcal{F}[n]-n=0$。通过从历史记录中构建这个“最佳”猜测，DIIS 能有效地识别并抑制困扰简单方法的振荡误差模式，从而带来显著改善的收敛性，通常是超线性收敛。\n\n预处理解决了残差向量的并非所有分量对收敛都同等重要这一问题。标准的欧几里得范数同等对待所有分量，这在物理上是幼稚的。在许多系统中，特别是大型或非均匀系统中，存在着收敛非常缓慢的电荷涨落“软模式”（例如长波长变化）。预条件子 $M$ 是一个对称正定矩阵，用于定义加权范数 $\\|r\\|_M^2 = r^{\\mathsf{T}} M r$。一个精心选择的预条件子能够近似系统静态介电矩阵的逆或残差映射雅可比矩阵的逆。通过最小化残差的 $M$-加权范数，DIIS 过程会更侧重于抑制物理上最软、最棘手的误差模式，从而加速误差中最顽固分量的收敛。\n\n我们现在推导最优系数 $c_i$ 的表达式。问题是在约束条件 $\\sum_{i=1}^{k} c_{i} = 1$ 下，最小化目标函数 $f(c) = \\| \\sum_{i=1}^{k} c_{i} r_{i} \\|_{M}^{2}$。设 $c$ 为系数列向量 $(c_1, \\dots, c_k)^{\\mathsf{T}}$，设 $R$ 是一个 $N \\times k$ 矩阵，其列为残差向量 $\\{r_i\\}_{i=1}^k$。残差的线性组合可以写为 $Rc$。\n\n目标函数为\n$$f(c) = (Rc)^{\\mathsf{T}} M (Rc) = c^{\\mathsf{T}} (R^{\\mathsf{T}} M R) c$$\n我们定义 $k \\times k$ 矩阵 $B = R^{\\mathsf{T}} M R$。该矩阵的元素由 $B_{ij} = r_i^{\\mathsf{T}} M r_j = \\langle r_i, r_j \\rangle_M$ 给出。约束条件可以写成 $\\mathbf{1}^{\\mathsf{T}} c = 1$，其中 $\\mathbf{1}$ 是一个元素全为 1 的 $k \\times 1$ 列向量。\n\n我们使用拉格朗日乘子法来求解这个约束优化问题。拉格朗日量为：\n$$\\mathcal{L}(c, \\lambda) = c^{\\mathsf{T}} B c - \\lambda (\\mathbf{1}^{\\mathsf{T}} c - 1)$$\n通过将关于 $c$ 和 $\\lambda$ 的梯度设为零，可以找到一阶最优性条件。\n关于向量 $c$ 的梯度是：\n$$\\nabla_c \\mathcal{L} = 2Bc - \\lambda\\mathbf{1} = 0$$\n这得到 $2Bc = \\lambda\\mathbf{1}$。因为 $M$ 是正定的，并且我们假设向量 $\\{r_i\\}$ 是线性无关的，所以矩阵 $B$ 也是正定的，因而是可逆的。因此，我们可以写出：\n$$c = \\frac{\\lambda}{2} B^{-1} \\mathbf{1}$$\n对 $\\lambda$ 求导可以简单地恢复约束条件：\n$$\\frac{\\partial \\mathcal{L}}{\\partial \\lambda} = -(\\mathbf{1}^{\\mathsf{T}} c - 1) = 0 \\implies \\mathbf{1}^{\\mathsf{T}} c = 1$$\n将 $c$ 的表达式代入约束方程，可以求出拉格朗日乘子：\n$$\\mathbf{1}^{\\mathsf{T}} \\left( \\frac{\\lambda}{2} B^{-1} \\mathbf{1} \\right) = 1$$\n$$\\frac{\\lambda}{2} (\\mathbf{1}^{\\mathsf{T}} B^{-1} \\mathbf{1}) = 1 \\implies \\frac{\\lambda}{2} = \\frac{1}{\\mathbf{1}^{\\mathsf{T}} B^{-1} \\mathbf{1}}$$\n最后，我们将 $\\frac{\\lambda}{2}$ 的这个表达式代回 $c$ 的方程中：\n$$c = \\frac{B^{-1} \\mathbf{1}}{\\mathbf{1}^{\\mathsf{T}} B^{-1} \\mathbf{1}}$$\n这就是最优 DIIS 系数的闭式表达式。\n\n现在，我们具体分析给定的 $k=2$ 的情况：\n$$\nr_{1} = \\begin{pmatrix} 1 \\\\ 2 \\end{pmatrix}, \\quad\nr_{2} = \\begin{pmatrix} -1 \\\\ 1 \\end{pmatrix}, \\quad\nM = \\begin{pmatrix} 2 & 0 \\\\ 0 & 1 \\end{pmatrix}\n$$\n首先，我们计算 $2 \\times 2$ 矩阵 $B$ 的元素：\n$$B_{11} = r_1^{\\mathsf{T}} M r_1 = \\begin{pmatrix} 1 & 2 \\end{pmatrix} \\begin{pmatrix} 2 & 0 \\\\ 0 & 1 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 2 \\end{pmatrix} = \\begin{pmatrix} 2 & 2 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 2 \\end{pmatrix} = (2)(1) + (2)(2) = 6$$\n$$B_{12} = r_1^{\\mathsf{T}} M r_2 = \\begin{pmatrix} 1 & 2 \\end{pmatrix} \\begin{pmatrix} 2 & 0 \\\\ 0 & 1 \\end{pmatrix} \\begin{pmatrix} -1 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 2 & 2 \\end{pmatrix} \\begin{pmatrix} -1 \\\\ 1 \\end{pmatrix} = (2)(-1) + (2)(1) = 0$$\n$$B_{21} = r_2^{\\mathsf{T}} M r_1 = B_{12} = 0 \\text{ (由对称性)}$$\n$$B_{22} = r_2^{\\mathsf{T}} M r_2 = \\begin{pmatrix} -1 & 1 \\end{pmatrix} \\begin{pmatrix} 2 & 0 \\\\ 0 & 1 \\end{pmatrix} \\begin{pmatrix} -1 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} -2 & 1 \\end{pmatrix} \\begin{pmatrix} -1 \\\\ 1 \\end{pmatrix} = (-2)(-1) + (1)(1) = 3$$\n矩阵 $B$ 为：\n$$B = \\begin{pmatrix} 6 & 0 \\\\ 0 & 3 \\end{pmatrix}$$\n其逆矩阵很容易计算：\n$$B^{-1} = \\begin{pmatrix} \\frac{1}{6} & 0 \\\\ 0 & \\frac{1}{3} \\end{pmatrix}$$\n现在，我们应用推导出的公式来计算 $c = (c_1, c_2)^{\\mathsf{T}}$，其中 $\\mathbf{1} = (1, 1)^{\\mathsf{T}}$。\n首先，计算分子 $B^{-1} \\mathbf{1}$：\n$$B^{-1} \\mathbf{1} = \\begin{pmatrix} \\frac{1}{6} & 0 \\\\ 0 & \\frac{1}{3} \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{6} \\\\ \\frac{1}{3} \\end{pmatrix}$$\n接下来，计算分母 $\\mathbf{1}^{\\mathsf{T}} B^{-1} \\mathbf{1}$：\n$$\\mathbf{1}^{\\mathsf{T}} B^{-1} \\mathbf{1} = \\begin{pmatrix} 1 & 1 \\end{pmatrix} \\begin{pmatrix} \\frac{1}{6} \\\\ \\frac{1}{3} \\end{pmatrix} = \\frac{1}{6} + \\frac{1}{3} = \\frac{1}{6} + \\frac{2}{6} = \\frac{3}{6} = \\frac{1}{2}$$\n那么系数向量 $c$ 为：\n$$c = \\frac{\\begin{pmatrix} \\frac{1}{6} \\\\ \\frac{1}{3} \\end{pmatrix}}{\\frac{1}{2}} = 2 \\begin{pmatrix} \\frac{1}{6} \\\\ \\frac{1}{3} \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{3} \\\\ \\frac{2}{3} \\end{pmatrix}$$\n因此，最优系数为 $c_1 = \\frac{1}{3}$ 和 $c_2 = \\frac{2}{3}$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{1}{3} & \\frac{2}{3}\n\\end{pmatrix}\n}\n$$", "id": "2768007"}]}