{"hands_on_practices": [{"introduction": "溶质与溶剂连续介质之间的静电相互作用是隐式溶剂化模型的核心。本练习将引导你完成Born模型的基础推导，这是描述离子溶剂化最简洁的理论形式[@problem_id:2778777]。通过这个过程，你将巩固电介质静电学的核心概念，并亲眼见证它们如何构建出溶剂化理论的基石方程，即计算溶剂极化对离子稳定化作用的能量。", "problem": "在一个原本均匀、各向同性、相对介电常数（介电常数）为 $\\epsilon$ 的线性电介质连续体中，刻出一个半径为 $R$ 的单球形空腔。一个电荷为 $q$ 的点离子被放置在空腔的中心。假设空腔内部是类真空的，其相对介电常数为 $\\epsilon_{\\mathrm{in}} = 1$，而外部介质的相对介电常数为 $\\epsilon_{\\mathrm{out}} = \\epsilon$。在（厘米-克-秒制的一种）高斯静电单位制下进行计算，在该单位制中，库仑定律为 $F = q_{1} q_{2} / r^{2}$，电位移场满足 $\\nabla \\cdot \\mathbf{D} = 4 \\pi \\rho_{\\mathrm{free}}$，线性电介质的能量密度为 $u = \\mathbf{E} \\cdot \\mathbf{D} / (8 \\pi)$。\n\n仅从这些静电学定律和应用于球形表面的标准平面界面边界条件（在没有自由表面电荷的情况下，电场的切向分量连续和电位移场的法向分量连续）出发，推导在电介质环境中将离子从 $0$ 充电到 $q$ 的可逆功减去在真空中相应的可逆功。将所得结果解释为隐式溶剂化模型中的溶剂化（极化）自由能。\n\n您的推导必须：\n- 使用高斯定律和在 $r=R$ 处的边界条件，求解空腔内外的球对称电场。\n- 通过对相应的能量密度进行全空间积分，计算电介质系统和真空参考的总静电能，并以一种在 $r=0$ 处不引入任何特设截断而能得到有限结果的方式，求出它们的差值。\n- 用高斯静电单位制，将最终的溶剂化自由能 $\\Delta G_{\\mathrm{solv}}$ 表示为以 $q$、$\\epsilon$ 和 $R$ 表示的闭合形式解析表达式。\n\n最后，根据您的推导，简要解释在隐式溶剂化模型的背景下，出现在您表达式中的参数 $R$ 的物理诠释。\n\n将您的最终答案报告为 $\\Delta G_{\\mathrm{solv}}$ 的单个闭合形式解析表达式。最终答案框中不要包含任何单位。", "solution": "该系统是径向对称的，原点处有一个点电荷 $q$，一个相对介电常数为 $\\epsilon_{\\mathrm{in}} = 1$ 的内部区域 $0 < r < R$，以及一个相对介电常数为 $\\epsilon_{\\mathrm{out}} = \\epsilon$ 的外部区域 $r > R$。在高斯静电单位制中，基本关系式为 $\\nabla \\cdot \\mathbf{D} = 4 \\pi \\rho_{\\mathrm{free}}$，对于相对介电常数为 $\\epsilon$ 的线性、各向同性电介质，有 $\\mathbf{D} = \\epsilon \\mathbf{E}$，能量密度为 $u = \\mathbf{E} \\cdot \\mathbf{D} / (8 \\pi)$。在 $r = R$ 处的边界条件（没有自由表面电荷的情况下）是 $\\mathbf{E}$ 的切向分量连续和 $\\mathbf{D}$ 的法向分量连续。对于球对称场，这简化为标量势的连续性和在 $r=R$ 处满足条件 $\\epsilon_{\\mathrm{in}} E_{\\mathrm{in}}^{\\perp} = \\epsilon_{\\mathrm{out}} E_{\\mathrm{out}}^{\\perp}$。\n\n首先，确定每个区域的电场。根据对称性，电场是纯径向的，$\\mathbf{E}(r) = E(r) \\,\\hat{\\mathbf{r}}$，对以原点为中心、半径为 $r$ 的球面应用高斯定律，可得\n$$\n\\oint_{S_{r}} \\mathbf{D} \\cdot d\\mathbf{A} \\;=\\; 4 \\pi q \\quad \\Longrightarrow \\quad D(r) \\, 4 \\pi r^{2} \\;=\\; 4 \\pi q \\quad \\Longrightarrow \\quad D(r) \\;=\\; \\frac{q}{r^{2}} \\, .\n$$\n在空腔内部，$\\epsilon_{\\mathrm{in}}=1$，因此 $D_{\\mathrm{in}}(r) = E_{\\mathrm{in}}(r)$，所以\n$$\nE_{\\mathrm{in}}(r) \\;=\\; \\frac{q}{r^{2}} \\quad \\text{for } 0< r < R \\, .\n$$\n在空腔外部，$D_{\\mathrm{out}}(r) = \\epsilon E_{\\mathrm{out}}(r)$，因此\n$$\nE_{\\mathrm{out}}(r) \\;=\\; \\frac{D_{\\mathrm{out}}(r)}{\\epsilon} \\;=\\; \\frac{1}{\\epsilon} \\,\\frac{q}{r^{2}} \\quad \\text{for } r > R \\, .\n$$\n这些电场自动满足了在 $r=R$ 处 $\\mathbf{D}$ 的法向分量的边界条件，因为 $D(r)$ 除了在点电荷位置外处处连续且等于 $q/r^{2}$。\n\n接下来，通过对能量密度进行积分来计算静电能。对于线性电介质，能量密度为 $u = \\mathbf{E} \\cdot \\mathbf{D} / (8 \\pi)$。因此，对于电介质系统，\n$$\nU(\\epsilon) \\;=\\; \\int_{0}^{\\infty} \\frac{\\mathbf{E} \\cdot \\mathbf{D}}{8 \\pi} \\, dV \\;=\\; \\int_{0}^{R} \\frac{E_{\\mathrm{in}}^{2}}{8 \\pi} \\, dV \\;+\\; \\int_{R}^{\\infty} \\frac{\\epsilon E_{\\mathrm{out}}^{2}}{8 \\pi} \\, dV \\, .\n$$\n对于真空参考（即任何地方都没有电介质），对于所有 $r>0$，电场为 $E_{0}(r) = q/r^{2}$，能量为\n$$\nU(1) \\;=\\; \\int_{0}^{\\infty} \\frac{E_{0}^{2}}{8 \\pi} \\, dV \\;=\\; \\int_{0}^{\\infty} \\frac{1}{8 \\pi} \\left( \\frac{q}{r^{2}} \\right)^{2} dV \\, .\n$$\n$U(\\epsilon)$ 和 $U(1)$ 在 $r \\to 0$ 时都发散，因为点电荷的自能不是有限的；然而，溶剂化自由能 $\\Delta G_{\\mathrm{solv}}$ 是在电介质中充电和在真空中充电的可逆功之差，即\n$$\n\\Delta G_{\\mathrm{solv}} \\;=\\; U(\\epsilon) \\;-\\; U(1) \\, .\n$$\n这个差值是有限的，因为在空腔内部 $0<r<R$，电介质系统和真空参考中的电场是相同的，因此它们在 $0<r<R$ 上的能量贡献完全抵消。所以，差值完全来自于区域 $r>R$：\n$$\n\\Delta G_{\\mathrm{solv}} \\;=\\; \\int_{R}^{\\infty} \\left[ \\frac{\\epsilon E_{\\mathrm{out}}^{2}}{8 \\pi} \\;-\\; \\frac{E_{0}^{2}}{8 \\pi} \\right] dV \\, .\n$$\n代入 $E_{\\mathrm{out}}(r) = q/(\\epsilon r^{2})$ 和 $E_{0}(r) = q/r^{2}$，并使用 $dV = 4 \\pi r^{2} dr$：\n$$\n\\Delta G_{\\mathrm{solv}} \\;=\\; \\int_{R}^{\\infty} \\left[ \\frac{\\epsilon}{8 \\pi} \\left( \\frac{q}{\\epsilon r^{2}} \\right)^{2} \\;-\\; \\frac{1}{8 \\pi} \\left( \\frac{q}{r^{2}} \\right)^{2} \\right] 4 \\pi r^{2} \\, dr \\, .\n$$\n逐项简化被积函数。对于电介质项，\n$$\n\\frac{\\epsilon}{8 \\pi} \\left( \\frac{q}{\\epsilon r^{2}} \\right)^{2} 4 \\pi r^{2}\n\\;=\\;\n\\frac{\\epsilon}{8 \\pi} \\cdot \\frac{q^{2}}{\\epsilon^{2} r^{4}} \\cdot 4 \\pi r^{2}\n\\;=\\;\n\\frac{q^{2}}{2 \\epsilon} \\cdot \\frac{1}{r^{2}} \\, .\n$$\n对于真空项，\n$$\n\\frac{1}{8 \\pi} \\left( \\frac{q}{r^{2}} \\right)^{2} 4 \\pi r^{2}\n\\;=\\;\n\\frac{q^{2}}{2} \\cdot \\frac{1}{r^{2}} \\, .\n$$\n因此，\n$$\n\\Delta G_{\\mathrm{solv}} \\;=\\; \\int_{R}^{\\infty} \\left( \\frac{q^{2}}{2 \\epsilon} \\cdot \\frac{1}{r^{2}} \\;-\\; \\frac{q^{2}}{2} \\cdot \\frac{1}{r^{2}} \\right) dr\n\\;=\\;\n\\frac{q^{2}}{2} \\left( \\frac{1}{\\epsilon} - 1 \\right) \\int_{R}^{\\infty} \\frac{dr}{r^{2}} \\, .\n$$\n计算积分，\n$$\n\\int_{R}^{\\infty} \\frac{dr}{r^{2}} \\;=\\; \\left[ - \\frac{1}{r} \\right]_{R}^{\\infty} \\;=\\; \\frac{1}{R} \\, ,\n$$\n得出\n$$\n\\Delta G_{\\mathrm{solv}} \\;=\\; \\frac{q^{2}}{2} \\left( \\frac{1}{\\epsilon} - 1 \\right) \\frac{1}{R}\n\\;=\\;\n- \\frac{1}{2} \\left( 1 - \\epsilon^{-1} \\right) \\frac{q^{2}}{R} \\, .\n$$\n这就是高斯静电单位制下的玻恩溶剂化自由能。对于 $\\epsilon > 1$，该值为负，表明相对于真空，电介质介质稳定了带电状态。\n\n$R$ 的物理诠释：在连续介质图像中，微观离子及其紧邻的分子环境被表示为一个介电响应缺失（$\\epsilon_{\\mathrm{in}} = 1$）的内部区域，而体溶剂则被表示为一个从 $r=R$ 开始、介电常数为 $\\epsilon$ 的均匀电介质。因此，参数 $R$ 是一个有效的空腔半径，通常称为玻恩半径，它界定了连续电介质开始作用的位置。它编码了溶剂的长波极化所“感知”到的溶质的大小和形状，在实践中，它可能不同于简单的范德华半径，因为它隐含地考虑了连续介质模型未明确模拟的第一溶剂化层的短程结构和电子效应。", "answer": "$$\\boxed{-\\frac{1}{2}\\left(1-\\epsilon^{-1}\\right)\\frac{q^{2}}{R}}$$", "id": "2778777"}, {"introduction": "溶剂化过程并不仅仅是静电效应；在溶剂中为溶质分子“开辟”一个空腔也需要付出能量代价，这通常被称为空腔形成能。本练习将宏观热力学概念（如表面张力和压力-体积功）与溶质的微观几何形状联系起来[@problem_id:2778704]。通过处理一个由融合球体构成的非平凡空腔，你将实践如何为溶剂化自由能计算非静电贡献部分，这是构建一个完整溶剂化模型的关键一步。", "problem": "在可极化连续介质模型 (PCM) 类型的连续介质隐式溶剂化模型中，溶剂化自由能的非静电部分通常根据在溶剂中“雕刻”出的溶质空腔的几何形状来建模。考虑一个溶质空腔，它由嵌入在恒温液体中的多个不可穿透球体的并集构成。假设该液体具有恒定的宏观表面张力，并受到均匀的外部压力作用。\n\n仅从可逆机械功和可逆界面功的基本定义出发，并将表面张力和压力视为空腔创建过程中的常数，推导非静电溶剂化自由能对空腔几何形状的主导项依赖关系。您的推导必须确定该自由能所依赖的几何量以及相应的物理系数，而不援引任何预先给定的目标公式。\n\n然后，将您的结果应用于一个由两个半径为 $R$、球心距为 $d$（其中 $0<d<2R$）的相同球体构成的融合球体空腔。使用几何推理和成熟的球冠公式，用闭合形式表示该融合球体空腔的总表面积 $S(R,d)$ 和总体积 $V(R,d)$，并根据以下参数计算非静电溶剂化自由能：\n- 球体半径 $R = 2.0\\,\\text{\\AA}$，\n- 球心距 $d = 3.0\\,\\text{\\AA}$，\n- 经验表面功系数 $\\gamma_{\\mathrm{ne}} = 0.0220\\,\\text{kJ}\\,\\text{mol}^{-1}\\,\\text{\\AA}^{-2}$，\n- 经验压力功系数 $p_{\\mathrm{ne}} = 6.022\\times 10^{-5}\\,\\text{kJ}\\,\\text{mol}^{-1}\\,\\text{\\AA}^{-3}$。\n\n将最终能量以 $\\text{kJ}\\,\\text{mol}^{-1}$ 为单位表示，并四舍五入到四位有效数字。", "solution": "在隐式溶剂模型中，溶剂化自由能的非静电部分 $\\Delta G_{\\mathrm{ne}}$ 对应于在恒定温度和压力下，在溶剂连续介质中创建一个溶质形状空腔所需的可逆功。该功用于克服两个主要阻力：溶剂的表面张力和外部压力。\n\n首先，考虑创建空腔表面积 $S$所需的可逆界面功 $W_{\\mathrm{surface}}$。在溶质空腔和溶剂连续介质之间创建一个新界面，必须克服溶剂的内聚力，这些内聚力在宏观上表现为表面张力。对于一个恒定的表面张力 $\\gamma$，所做的功与创建的面积成正比。因此，对自由能的贡献为：\n$$W_{\\mathrm{surface}} = \\gamma S$$\n\n其次，考虑为排开体积为 $V$ 的溶剂而克服均匀外部压力 $p$ 所做的可逆机械功 $W_{\\mathrm{volume}}$。这是标准的压力-体积功项。对于恒定的压力，该功为：\n$$W_{\\mathrm{volume}} = pV$$\n\n在恒温恒压下，吉布斯自由能的变化量等于对系统所做的非体积膨胀可逆功。空腔的创建就是这样一个过程。因此，总的非静电自由能是这两个功分量的和。在此背景下，系数 $\\gamma$ 和 $p$ 被视为有效的经验参数，我们分别将其表示为 $\\gamma_{\\mathrm{ne}}$ 和 $p_{\\mathrm{ne}}$，以反映它们在模拟非静电相互作用中的作用。\n\n由此得到的非静电溶剂化自由能的表达式为：\n$$\\Delta G_{\\mathrm{ne}} = \\gamma_{\\mathrm{ne}} S + p_{\\mathrm{ne}} V$$\n该方程确立了非静电自由能对空腔几何性质（其表面积 $S$ 和体积 $V$）的主导项依赖关系。相应的物理系数是经验表面功系数 $\\gamma_{\\mathrm{ne}}$ 和经验压力功系数 $p_{\\mathrm{ne}}$。\n\n接下来，我们将此结果应用于由两个半径为 $R$、球心距为 $d$（其中 $0 < d < 2R$）的相同球体构成的融合球体空腔的特定几何形状。\n\n该融合球体空腔的总表面积 $S(R,d)$ 是两个暴露的球冠面积之和。对于其中一个球体，相交平面距其球心的距离为 $d/2$。被移除（位于另一个球体内部）的较小球冠的高度为 $h_{\\mathrm{removed}} = R - d/2$。这个被移除球冠的表面积为 $2\\pi R h_{\\mathrm{removed}}$。一个球体的暴露面积是其总面积减去被移除球冠的面积：$4\\pi R^2 - 2\\pi R(R - d/2) = 2\\pi R^2 + \\pi R d$。因为有两个这样相同的暴露球冠，所以总表面积为：\n$$S(R,d) = 2 \\times (2\\pi R^2 + \\pi R d) = 2\\pi R(2R+d)$$\n\n总体积 $V(R,d)$ 是两个球体的体积之和减去它们相交部分的体积。相交部分是一个由两个相同球冠（每个高度为 $h = R - d/2$）组成的透镜体。单个球冠的体积由 $V_{\\mathrm{cap}} = \\frac{1}{3}\\pi h^2 (3R - h)$ 给出。并集的总体积是两个完整球体的体积减去透镜体的体积（在求和中被计算了两次）。一个更直接的方法是计算构成该融合体的两个较大球节的体积之和。一个球节的体积是一个球体的体积减去被切掉的小球冠的体积：\n$$V_{\\mathrm{segment}} = \\frac{4}{3}\\pi R^3 - V_{\\mathrm{cap}} = \\frac{4}{3}\\pi R^3 - \\frac{1}{3}\\pi (R-d/2)^2 (3R - (R-d/2))$$\n$$V_{\\mathrm{segment}} = \\frac{4}{3}\\pi R^3 - \\frac{1}{3}\\pi (R-d/2)^2 (2R+d/2)$$\n展开此式可得：\n$$V_{\\mathrm{segment}} = \\frac{\\pi}{3} \\left( 4R^3 - \\left( R^2 - Rd + \\frac{d^2}{4} \\right) \\left( 2R + \\frac{d}{2} \\right) \\right) = \\frac{\\pi}{3} \\left( 2R^3 + \\frac{3}{2}R^2d - \\frac{d^3}{8} \\right)$$\n总体积是单个球节体积的两倍：\n$$V(R,d) = 2 V_{\\mathrm{segment}} = \\frac{2\\pi}{3} \\left( 2R^3 + \\frac{3}{2}R^2d - \\frac{d^3}{8} \\right) = \\pi \\left( \\frac{4}{3}R^3 + R^2d - \\frac{d^3}{12} \\right)$$\n\n现在，我们代入给定的数值参数：\n$R = 2.0\\,\\text{\\AA}$\n$d = 3.0\\,\\text{\\AA}$\n$\\gamma_{\\mathrm{ne}} = 0.0220\\,\\text{kJ}\\,\\text{mol}^{-1}\\,\\text{\\AA}^{-2}$\n$p_{\\mathrm{ne}} = 6.022\\times 10^{-5}\\,\\text{kJ}\\,\\text{mol}^{-1}\\,\\text{\\AA}^{-3}$\n\n首先，我们计算表面积 $S$ 和体积 $V$：\n$$S = 2\\pi R(2R+d) = 2\\pi(2.0)(2 \\times 2.0 + 3.0) = 4\\pi(4.0 + 3.0) = 28\\pi\\,\\text{\\AA}^2$$\n$$V = \\pi \\left( \\frac{4}{3}R^3 + R^2d - \\frac{d^3}{12} \\right) = \\pi \\left( \\frac{4}{3}(2.0)^3 + (2.0)^2(3.0) - \\frac{(3.0)^3}{12} \\right)$$\n$$V = \\pi \\left( \\frac{4}{3}(8.0) + (4.0)(3.0) - \\frac{27.0}{12} \\right) = \\pi \\left( \\frac{32.0}{3} + 12.0 - \\frac{9.0}{4} \\right)$$\n使用公分母 $12$：\n$$V = \\pi \\left( \\frac{32.0 \\times 4}{12} + \\frac{12.0 \\times 12}{12} - \\frac{9.0 \\times 3}{12} \\right) = \\pi \\left( \\frac{128.0 + 144.0 - 27.0}{12} \\right) = \\frac{245\\pi}{12}\\,\\text{\\AA}^3$$\n\n最后，我们计算非静电溶剂化自由能：\n$$\\Delta G_{\\mathrm{ne}} = \\gamma_{\\mathrm{ne}} S + p_{\\mathrm{ne}} V$$\n$$\\Delta G_{\\mathrm{ne}} = (0.0220) \\times (28\\pi) + (6.022\\times 10^{-5}) \\times \\left(\\frac{245\\pi}{12}\\right)$$\n$$\\Delta G_{\\mathrm{ne}} = 0.616\\pi + \\frac{1475.39\\pi}{12} \\times 10^{-5}$$\n$$\\Delta G_{\\mathrm{ne}} = \\pi \\left( 0.616 + 122.94916... \\times 10^{-5} \\right)$$\n$$\\Delta G_{\\mathrm{ne}} = \\pi \\left( 0.616 + 0.0012294916... \\right)$$\n$$\\Delta G_{\\mathrm{ne}} = \\pi \\left( 0.6172294916... \\right)$$\n$$\\Delta G_{\\mathrm{ne}} \\approx 1.93906\\,\\text{kJ}\\,\\text{mol}^{-1}$$\n\n四舍五入到四位有效数字，最终结果为 $1.939\\,\\text{kJ}\\,\\text{mol}^{-1}$。", "answer": "$$\n\\boxed{1.939}\n$$", "id": "2778704"}, {"introduction": "理论模型的真正威力在于其预测现实世界现象的准确性。最后一个练习将我们从理想化的理论推导带入实际应用，展示如何利用实验数据来参数化一个简化的隐式溶剂化模型[@problem_id:2778738]。通过运用贝叶斯推断这一强大的统计框架，你将学习如何量化模型参数（如有效表面张力系数 $\\theta_2$）的不确定性并做出稳健的预测，这正是现代计算化学研究中的一项核心技能。", "problem": "给定一个从线性响应近似下的可极化连续介质模型（PCM; Polarizable Continuum Model）导出的简化正向模型。溶剂化自由能的静电贡献被认为与介电响应因子 $f(\\varepsilon)$ 成比例，其中 $\\varepsilon$ 是溶剂的静态介电常数，对于球形空腔替代模型，$f(\\varepsilon)$ 定义为 $f(\\varepsilon) = \\dfrac{\\varepsilon - 1}{\\varepsilon + 2}$。非静电贡献被认为与溶质空腔表面积 $S$ 成正比。总溶剂化自由能 $\\Delta G$（单位为 $\\mathrm{kJ/mol}$）被建模为 $f(\\varepsilon)$ 和 $S$ 的带截距的线性函数：\n$$\ny_i \\equiv \\Delta G_i = \\theta_0 + \\theta_1 f(\\varepsilon_i) + \\theta_2 S_i + \\varepsilon_i^{(\\text{noise})},\n$$\n其中 $\\varepsilon_i^{(\\text{noise})} \\sim \\mathcal{N}(0,\\sigma^2)$ 是已知方差为 $\\sigma^2$ 的独立同分布高斯误差，$\\boldsymbol{\\theta} = (\\theta_0,\\theta_1,\\theta_2)^\\top$ 是未知参数。\n\n对 $\\boldsymbol{\\theta}$ 采用高斯先验，\n$$\n\\boldsymbol{\\theta} \\sim \\mathcal{N}(\\boldsymbol{\\mu}_0,\\boldsymbol{\\Sigma}_0),\n$$\n其中 $\\boldsymbol{\\mu}_0 = (0,0,0)^\\top$ 且 $\\boldsymbol{\\Sigma}_0 = \\mathrm{diag}(\\tau^2,\\tau^2,\\tau^2)$，$\\tau^2 = 1000$。\n\n训练数据由 $N=8$ 组独立测量值 $(\\varepsilon_i, S_i, y_i)$ 组成，其中 $\\sigma = 1.5$（单位为 $\\mathrm{kJ/mol}$），$S_i$ 的单位为 $\\text{\\AA}^2$，$y_i$ 的单位为 $\\mathrm{kJ/mol}$。数据如下：\n- $i=1$: $\\varepsilon_1 = 78.4$, $S_1 = 120$, $y_1 = -24.0806$,\n- $i=2$: $\\varepsilon_2 = 78.4$, $S_2 = 150$, $y_2 = -24.5806$,\n- $i=3$: $\\varepsilon_3 = 78.4$, $S_3 = 180$, $y_3 = -21.3806$,\n- $i=4$: $\\varepsilon_4 = 78.4$, $S_4 = 210$, $y_4 = -20.7806$,\n- $i=5$: $\\varepsilon_5 = 2.38$, $S_5 = 120$, $y_5 = -4.3521$,\n- $i=6$: $\\varepsilon_6 = 2.38$, $S_6 = 150$, $y_6 = -4.9521$,\n- $i=7$: $\\varepsilon_7 = 2.38$, $S_7 = 180$, $y_7 = -2.2521$,\n- $i=8$: $\\varepsilon_8 = 2.38$, $S_8 = 210$, $y_8 = -1.6521$.\n\n任务：\n1. 从 Bayes 法则和上述定义出发，推导具有高斯先验的线性高斯模型的后验分布 $p(\\boldsymbol{\\theta}\\mid \\mathbf{y}, \\mathbf{X}, \\sigma^2)$，其中 $\\mathbf{X}$ 是设计矩阵，其行向量为 $\\mathbf{x}_i^\\top = (1, f(\\varepsilon_i), S_i)$，$\\mathbf{y} = (y_1,\\dots,y_8)^\\top$。\n2. 实现一个程序，计算 $\\boldsymbol{\\theta}$ 的后验均值向量 $\\boldsymbol{\\mu}_N$ 和后验协方差矩阵 $\\boldsymbol{\\Sigma}_N$。\n3. 对于以下三种预测情况，使用模型所蕴含的后验预测分布，计算新溶剂化自由能 $y_\\star$ 的贝叶斯 95% 预测区间：\n   - 情况 A：$\\varepsilon_\\star = 10.0$, $S_\\star = 160$,\n   - 情况 B：$\\varepsilon_\\star = 78.4$, $S_\\star = 140$,\n   - 情况 C：$\\varepsilon_\\star = 2.0$, $S_\\star = 220$.\n   对于每种情况，构建 $\\mathbf{x}_\\star^\\top = (1, f(\\varepsilon_\\star), S_\\star)$ 并使用预测分布来获得区间的下端点和上端点。将每个区间端点以 $\\mathrm{kJ/mol}$ 为单位表示，并四舍五入到三位小数。\n\n规格和约束：\n- 所有能量必须以 $\\mathrm{kJ/mol}$ 表示，所有表面积以 $\\text{\\AA}^2$ 表示。不使用角度。报告所有最终数值输出时，应为对应于指定单位的无量纲数。\n- 您的程序必须实现贝叶斯推断和预测区间计算，无需用户输入。\n- 测试套件需覆盖不同方面：\n  - 中等介电常数和中等表面积的典型情况：情况 A，$\\varepsilon_\\star = 10.0$, $S_\\star = 160$。\n  - 高介电常数、较小表面积：情况 B，$\\varepsilon_\\star = 78.4$, $S_\\star = 140$。\n  - 低介电常数、较大表面积：情况 C，$\\varepsilon_\\star = 2.0$, $S_\\star = 220$。\n- 最终输出格式：您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，顺序如下\n$$\n[\\ell_A, u_A, \\ell_B, u_B, \\ell_C, u_C],\n$$\n其中 $\\ell$ 和 $u$ 分别表示预测区间的下端点和上端点，每个值四舍五入到三位小数，不含额外的空格或文本。", "solution": "该问题要求在贝叶斯框架内确定线性模型参数的后验分布，然后计算新观测值的预测区间。\n\n步骤 1：后验分布的推导\n\n任务是推导后验分布 $p(\\boldsymbol{\\theta} \\mid \\mathbf{y}, \\mathbf{X}, \\sigma^2)$。根据 Bayes 法则，后验与似然和先验的乘积成正比：\n$$\np(\\boldsymbol{\\theta} \\mid \\mathbf{y}, \\mathbf{X}, \\sigma^2) \\propto p(\\mathbf{y} \\mid \\mathbf{X}, \\boldsymbol{\\theta}, \\sigma^2) p(\\boldsymbol{\\theta})\n$$\n对于线性模型 $\\mathbf{y} = \\mathbf{X}\\boldsymbol{\\theta} + \\boldsymbol{\\varepsilon}^{(\\text{noise})}$，当噪声 $\\varepsilon_i^{(\\text{noise})} \\sim \\mathcal{N}(0, \\sigma^2)$ 为独立同分布高斯噪声时，其似然是一个多元高斯分布：\n$$\np(\\mathbf{y} \\mid \\mathbf{X}, \\boldsymbol{\\theta}, \\sigma^2) = \\mathcal{N}(\\mathbf{y} \\mid \\mathbf{X}\\boldsymbol{\\theta}, \\sigma^2\\mathbf{I}) \\propto \\exp\\left(-\\frac{1}{2\\sigma^2}(\\mathbf{y} - \\mathbf{X}\\boldsymbol{\\theta})^\\top(\\mathbf{y} - \\mathbf{X}\\boldsymbol{\\theta})\\right)\n$$\n$\\boldsymbol{\\theta}$ 的先验分布也是高斯的：\n$$\np(\\boldsymbol{\\theta}) = \\mathcal{N}(\\boldsymbol{\\theta} \\mid \\boldsymbol{\\mu}_0, \\boldsymbol{\\Sigma}_0) \\propto \\exp\\left(-\\frac{1}{2}(\\boldsymbol{\\theta} - \\boldsymbol{\\mu}_0)^\\top\\boldsymbol{\\Sigma}_0^{-1}(\\boldsymbol{\\theta} - \\boldsymbol{\\mu}_0)\\right)\n$$\n对数后验与对数似然和对数先验之和成正比，忽略常数项：\n$$\n\\log p(\\boldsymbol{\\theta} \\mid \\mathbf{y}, \\dots) \\propto -\\frac{1}{2\\sigma^2}(\\mathbf{y} - \\mathbf{X}\\boldsymbol{\\theta})^\\top(\\mathbf{y} - \\mathbf{X}\\boldsymbol{\\theta}) - \\frac{1}{2}(\\boldsymbol{\\theta} - \\boldsymbol{\\mu}_0)^\\top\\boldsymbol{\\Sigma}_0^{-1}(\\boldsymbol{\\theta} - \\boldsymbol{\\mu}_0)\n$$\n展开二次型：\n$$\n\\log p(\\boldsymbol{\\theta} \\mid \\dots) \\propto -\\frac{1}{2}\\left[\\frac{1}{\\sigma^2}(\\mathbf{y}^\\top\\mathbf{y} - 2\\mathbf{y}^\\top\\mathbf{X}\\boldsymbol{\\theta} + \\boldsymbol{\\theta}^\\top\\mathbf{X}^\\top\\mathbf{X}\\boldsymbol{\\theta}) + (\\boldsymbol{\\theta}^\\top\\boldsymbol{\\Sigma}_0^{-1}\\boldsymbol{\\theta} - 2\\boldsymbol{\\theta}^\\top\\boldsymbol{\\Sigma}_0^{-1}\\boldsymbol{\\mu}_0 + \\boldsymbol{\\mu}_0^\\top\\boldsymbol{\\Sigma}_0^{-1}\\boldsymbol{\\mu}_0)\\right]\n$$\n我们根据 $\\boldsymbol{\\theta}$ 对各项进行分组：\n$$\n\\log p(\\boldsymbol{\\theta} \\mid \\dots) \\propto -\\frac{1}{2}\\left[\\boldsymbol{\\theta}^\\top\\left(\\boldsymbol{\\Sigma}_0^{-1} + \\frac{1}{\\sigma^2}\\mathbf{X}^\\top\\mathbf{X}\\right)\\boldsymbol{\\theta} - 2\\boldsymbol{\\theta}^\\top\\left(\\boldsymbol{\\Sigma}_0^{-1}\\boldsymbol{\\mu}_0 + \\frac{1}{\\sigma^2}\\mathbf{X}^\\top\\mathbf{y}\\right)\\right]\n$$\n这是一个多元高斯分布的指数部分。通过配方法，我们可以确定其参数。对于后验分布 $p(\\boldsymbol{\\theta} \\mid \\dots) = \\mathcal{N}(\\boldsymbol{\\theta} \\mid \\boldsymbol{\\mu}_N, \\boldsymbol{\\Sigma}_N)$，其对数密度形式为 $-\\frac{1}{2}(\\boldsymbol{\\theta} - \\boldsymbol{\\mu}_N)^\\top\\boldsymbol{\\Sigma}_N^{-1}(\\boldsymbol{\\theta} - \\boldsymbol{\\mu}_N)$，展开后为 $-\\frac{1}{2}(\\boldsymbol{\\theta}^\\top\\boldsymbol{\\Sigma}_N^{-1}\\boldsymbol{\\theta} - 2\\boldsymbol{\\theta}^\\top\\boldsymbol{\\Sigma}_N^{-1}\\boldsymbol{\\mu}_N + \\dots)$。\n\n通过比较系数，我们可以确定逆后验协方差 $\\boldsymbol{\\Sigma}_N^{-1}$ 和项 $\\boldsymbol{\\Sigma}_N^{-1}\\boldsymbol{\\mu}_N$：\n$$\n\\boldsymbol{\\Sigma}_N^{-1} = \\boldsymbol{\\Sigma}_0^{-1} + \\frac{1}{\\sigma^2}\\mathbf{X}^\\top\\mathbf{X}\n$$\n$$\n\\boldsymbol{\\Sigma}_N^{-1}\\boldsymbol{\\mu}_N = \\boldsymbol{\\Sigma}_0^{-1}\\boldsymbol{\\mu}_0 + \\frac{1}{\\sigma^2}\\mathbf{X}^\\top\\mathbf{y}\n$$\n由此，我们推导出后验协方差矩阵 $\\boldsymbol{\\Sigma}_N$ 和后验均值向量 $\\boldsymbol{\\mu}_N$：\n$$\n\\boldsymbol{\\Sigma}_N = \\left(\\boldsymbol{\\Sigma}_0^{-1} + \\frac{1}{\\sigma^2}\\mathbf{X}^\\top\\mathbf{X}\\right)^{-1}\n$$\n$$\n\\boldsymbol{\\mu}_N = \\boldsymbol{\\Sigma}_N \\left(\\boldsymbol{\\Sigma}_0^{-1}\\boldsymbol{\\mu}_0 + \\frac{1}{\\sigma^2}\\mathbf{X}^\\top\\mathbf{y}\\right)\n$$\n推导至此完成。后验分布为 $p(\\boldsymbol{\\theta} \\mid \\mathbf{y}, \\mathbf{X}, \\sigma^2) = \\mathcal{N}(\\boldsymbol{\\theta} \\mid \\boldsymbol{\\mu}_N, \\boldsymbol{\\Sigma}_N)$。\n\n步骤 2：后验预测分布的推导\n\n对于一个新的数据点 $\\mathbf{x}_{\\star}$，$y_{\\star}$ 的预测分布通过对 $\\boldsymbol{\\theta}$ 的后验进行边缘化得到：\n$$\np(y_{\\star} \\mid \\mathbf{x}_{\\star}, \\mathbf{y}, \\mathbf{X}, \\sigma^2) = \\int p(y_{\\star} \\mid \\mathbf{x}_{\\star}, \\boldsymbol{\\theta}, \\sigma^2) p(\\boldsymbol{\\theta} \\mid \\mathbf{y}, \\mathbf{X}, \\sigma^2) d\\boldsymbol{\\theta}\n$$\n其中 $p(y_{\\star} \\mid \\mathbf{x}_{\\star}, \\boldsymbol{\\theta}, \\sigma^2) = \\mathcal{N}(y_{\\star} \\mid \\mathbf{x}_{\\star}^\\top\\boldsymbol{\\theta}, \\sigma^2)$。这是两个高斯分布乘积的积分，结果仍为高斯分布。预测分布的均值为：\n$$\n\\mathbb{E}[y_{\\star}] = \\mathbb{E}[\\mathbf{x}_{\\star}^\\top\\boldsymbol{\\theta}] = \\mathbf{x}_{\\star}^\\top\\mathbb{E}[\\boldsymbol{\\theta}] = \\mathbf{x}_{\\star}^\\top\\boldsymbol{\\mu}_N\n$$\n方差为：\n$$\n\\mathrm{Var}(y_{\\star}) = \\mathrm{Var}(\\mathbf{x}_{\\star}^\\top\\boldsymbol{\\theta} + \\varepsilon_{\\star}) = \\mathrm{Var}(\\mathbf{x}_{\\star}^\\top\\boldsymbol{\\theta}) + \\mathrm{Var}(\\varepsilon_{\\star})\n$$\n第一项是由参数不确定性传播而来的方差：$\\mathrm{Var}(\\mathbf{x}_{\\star}^\\top\\boldsymbol{\\theta}) = \\mathbf{x}_{\\star}^\\top\\mathrm{Var}(\\boldsymbol{\\theta})\\mathbf{x}_{\\star} = \\mathbf{x}_{\\star}^\\top\\boldsymbol{\\Sigma}_N\\mathbf{x}_{\\star}$。第二项是新测量中固有的噪声：$\\mathrm{Var}(\\varepsilon_{\\star}) = \\sigma^2$。\n因此，后验预测分布是高斯的：\n$$\ny_{\\star} \\mid \\mathbf{x}_{\\star}, \\mathbf{y}, \\mathbf{X} \\sim \\mathcal{N}(\\mu_{\\text{pred}}, \\sigma^2_{\\text{pred}})\n$$\n其均值为 $\\mu_{\\text{pred}} = \\mathbf{x}_{\\star}^\\top\\boldsymbol{\\mu}_N$，方差为 $\\sigma^2_{\\text{pred}} = \\sigma^2 + \\mathbf{x}_{\\star}^\\top\\boldsymbol{\\Sigma}_N\\mathbf{x}_{\\star}$。\n\n一个 95% 预测区间由 $\\mu_{\\text{pred}} \\pm z \\cdot \\sigma_{\\text{pred}}$ 给出，其中 $z$ 是标准正态分布的第 97.5 百分位数，即 $z \\approx 1.96$。\n\n步骤 3：实现\n\n程序将执行以下步骤：\n1.  定义所有常数：$\\sigma = 1.5$, $\\tau^2 = 1000$。\n2.  构建先验参数：$\\boldsymbol{\\mu}_0 = (0,0,0)^\\top$ 和 $\\boldsymbol{\\Sigma}_0^{-1} = \\mathrm{diag}(1/\\tau^2, 1/\\tau^2, 1/\\tau^2)$。\n3.  处理 $N=8$ 个训练数据点 $(\\varepsilon_i, S_i, y_i)$，以组装设计矩阵 $\\mathbf{X}$（其行向量为 $(1, f(\\varepsilon_i), S_i)$）和观测向量 $\\mathbf{y}$。\n4.  使用推导出的公式计算后验均值 $\\boldsymbol{\\mu}_N$ 和协方差 $\\boldsymbol{\\Sigma}_N$。\n5.  对于三种预测情况（A, B, C）中的每一种：\n    a. 构建新的特征向量 $\\mathbf{x}_{\\star} = (1, f(\\varepsilon_{\\star}), S_{\\star})^\\top$。\n    b. 计算预测均值 $\\mu_{\\text{pred}} = \\mathbf{x}_{\\star}^\\top\\boldsymbol{\\mu}_N$ 和预测方差 $\\sigma^2_{\\text{pred}} = \\sigma^2 + \\mathbf{x}_{\\star}^\\top\\boldsymbol{\\Sigma}_N\\mathbf{x}_{\\star}$。\n    c. 确定 95% 预测区间 $[\\ell, u]$，其中 $\\ell = \\mu_{\\text{pred}} - z\\sqrt{\\sigma^2_{\\text{pred}}}$ 和 $u = \\mu_{\\text{pred}} + z\\sqrt{\\sigma^2_{\\text{pred}}}$，使用 $z \\approx 1.95996$。\n    d. 将区间端点四舍五入到三位小数。\n6.  按照指定顺序将最终结果格式化为单个逗号分隔的列表。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.stats import norm\n\ndef solve():\n    # --- Step 1: Define constants and data from the problem statement ---\n\n    # Model parameters\n    sigma = 1.5\n    sigma_sq = sigma**2\n    tau_sq = 1000.0\n\n    # Prior distribution parameters for theta = [theta_0, theta_1, theta_2]^T\n    mu_0 = np.zeros(3)\n    # Sigma_0 is diagonal, so its inverse is also diagonal\n    Sigma0_inv = np.diag([1.0/tau_sq, 1.0/tau_sq, 1.0/tau_sq])\n\n    # Training data (N=8)\n    training_data = [\n        (78.4, 120, -24.0806),\n        (78.4, 150, -24.5806),\n        (78.4, 180, -21.3806),\n        (78.4, 210, -20.7806),\n        (2.38, 120, -4.3521 ),\n        (2.38, 150, -4.9521 ),\n        (2.38, 180, -2.2521 ),\n        (2.38, 210, -1.6521 ),\n    ]\n\n    # Predictive test cases\n    test_cases = [\n        (10.0, 160), # Case A\n        (78.4, 140), # Case B\n        (2.0,  220), # Case C\n    ]\n\n    # --- Step 2: Prepare the design matrix X and response vector y ---\n    \n    # Dielectric response factor function\n    def f_eps(eps):\n        return (eps - 1.0) / (eps + 2.0)\n\n    N = len(training_data)\n    y = np.array([d[2] for d in training_data])\n    \n    # Design matrix X has rows [1, f(eps_i), S_i]\n    X = np.zeros((N, 3))\n    for i, (eps_i, S_i, _) in enumerate(training_data):\n        X[i, 0] = 1.0\n        X[i, 1] = f_eps(eps_i)\n        X[i, 2] = S_i\n\n    # --- Step 3: Compute the posterior distribution parameters ---\n    \n    # Posterior covariance: Sigma_N = (Sigma_0^-1 + (1/sigma^2) * X^T * X)^-1\n    # Matrix multiplications use the @ operator\n    XTX = X.T @ X\n    SigmaN_inv = Sigma0_inv + (1.0/sigma_sq) * XTX\n    Sigma_N = np.linalg.inv(SigmaN_inv)\n\n    # Posterior mean: mu_N = Sigma_N * (Sigma_0^-1 * mu_0 + (1/sigma^2) * X^T * y)\n    # Since mu_0 is the zero vector, this simplifies\n    XTy = X.T @ y\n    mu_N = Sigma_N @ ((1.0/sigma_sq) * XTy)\n\n    # --- Step 4: Compute the predictive intervals for test cases ---\n\n    # Z-score for a 95% confidence/predictive interval\n    z_score = norm.ppf(0.975)\n\n    results = []\n    for eps_star, S_star in test_cases:\n        # Construct the feature vector for the new data point\n        x_star = np.array([1.0, f_eps(eps_star), S_star])\n\n        # Predictive mean\n        mu_pred = x_star.T @ mu_N\n\n        # Predictive variance: noise variance + parameter uncertainty variance\n        pred_var = sigma_sq + x_star.T @ Sigma_N @ x_star\n        pred_std = np.sqrt(pred_var)\n\n        # Calculate lower and upper bounds of the 95% predictive interval\n        lower_bound = mu_pred - z_score * pred_std\n        upper_bound = mu_pred + z_score * pred_std\n        \n        results.extend([lower_bound, upper_bound])\n\n    # --- Step 5: Format and print the final output ---\n    \n    # The output must be a single line, with each number rounded to three decimal places.\n    formatted_results = [f\"{r:.3f}\" for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nif __name__ == '__main__':\n    solve()\n```", "id": "2778738"}]}