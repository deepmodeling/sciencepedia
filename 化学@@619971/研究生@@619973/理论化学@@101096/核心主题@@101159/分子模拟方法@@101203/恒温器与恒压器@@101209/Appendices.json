{"hands_on_practices": [{"introduction": "在实现任何恒温器之前，理解其旨在生成的系综的统计特性至关重要。本练习提供了一个基础性的计算，推导了在正则系综中瞬时动能温度的预期涨落。掌握这个练习 [@problem_id:2825163] 有助于为验证任何恒温器的性能建立一个理论基准。", "problem": "考虑一个由$N$个粒子组成的经典系统，在恒温器作用下演化，其动量从热力学温度为$T$的正则系综中采样。假设在移除所有完整约束和总体守恒量后，该系统具有$f$个有效动能自由度（DOF）。在分子动力学（MD）恒温器中常用的瞬时动能温度估计量定义为\n$$\n\\hat{T} \\equiv \\frac{2 K}{f k_{\\mathrm{B}}},\n$$\n其中$K$是瞬时动能，$k_{\\mathrm{B}}$是玻尔兹曼常数。在正则系综中，联合动量分布可因子分解，并服从Maxwell–Boltzmann形式，因此\n$$\nP(\\{p_{i}\\}\\,|\\,T) \\propto \\exp\\!\\left(-\\beta \\sum_{i=1}^{f} \\frac{p_{i}^{2}}{2 m_{i}}\\right), \\quad \\beta \\equiv \\frac{1}{k_{\\mathrm{B}} T},\n$$\n其中$m_{i} > 0$是与$f$个二次动能模式相关联的有效质量。\n\n从这些正则系综的事实和独立高斯变量的基本性质出发，推导无量纲相对方差\n$$\n\\frac{\\operatorname{Var}(\\hat{T})}{T^{2}}\n$$\n的闭式表达式，该表达式仅用$f$表示。将最终答案表示为关于$f$的单个解析表达式。该比值为无量纲，不需要单位，也不需要进行数值取整。", "solution": "所述问题具有科学依据、内容自洽且定义明确。这是统计力学中的一个标准推导。我们将开始求解。\n\n目标是推导瞬时动能温度估计量$\\hat{T}$的无量纲相对方差的表达式，其定义为\n$$\n\\hat{T} \\equiv \\frac{2 K}{f k_{\\mathrm{B}}}\n$$\n其中$K$是总瞬时动能，$f$是有效动能自由度的数量，$k_{\\mathrm{B}}$是玻尔兹曼常数。需要推导的量是$\\frac{\\operatorname{Var}(\\hat{T})}{T^2}$。\n\n方差定义为$\\operatorname{Var}(\\hat{T}) = \\langle \\hat{T}^2 \\rangle - \\langle \\hat{T} \\rangle^2$。尖括号$\\langle \\dots \\rangle$表示在热力学温度为$T$的正则系综上的系综平均。因此，所要求的比值为\n$$\n\\frac{\\operatorname{Var}(\\hat{T})}{T^2} = \\frac{\\langle \\hat{T}^2 \\rangle - \\langle \\hat{T} \\rangle^2}{T^2}\n$$\n总动能$K$是$f$个独立模式的动能之和：\n$$\nK = \\sum_{i=1}^{f} K_i = \\sum_{i=1}^{f} \\frac{p_i^2}{2 m_i}\n$$\n其中$p_i$和$m_i$分别是第$i$个自由度的动量和有效质量。\n\n首先，我们计算期望值$\\langle \\hat{T} \\rangle$。\n$$\n\\langle \\hat{T} \\rangle = \\left\\langle \\frac{2 K}{f k_{\\mathrm{B}}} \\right\\rangle = \\frac{2}{f k_{\\mathrm{B}}} \\langle K \\rangle = \\frac{2}{f k_{\\mathrm{B}}} \\left\\langle \\sum_{i=1}^{f} K_i \\right\\rangle = \\frac{2}{f k_{\\mathrm{B}}} \\sum_{i=1}^{f} \\langle K_i \\rangle\n$$\n每个动量$p_i$都遵循Maxwell-Boltzmann分布，对于单个模式而言，这是一个高斯分布。在正则系综中，单个二次自由度的能量期望值是能量均分定理的直接推论，该定理指出$\\langle K_i \\rangle = \\frac{1}{2} k_{\\mathrm{B}} T$。\n\n因此，平均总动能为：\n$$\n\\langle K \\rangle = \\sum_{i=1}^{f} \\frac{1}{2} k_{\\mathrm{B}} T = \\frac{f}{2} k_{\\mathrm{B}} T\n$$\n将此结果代入$\\langle \\hat{T} \\rangle$的表达式中：\n$$\n\\langle \\hat{T} \\rangle = \\frac{2}{f k_{\\mathrm{B}}} \\left( \\frac{f}{2} k_{\\mathrm{B}} T \\right) = T\n$$\n这表明$\\hat{T}$是热力学温度$T$的一个无偏估计量。\n\n接下来，我们计算二阶矩$\\langle \\hat{T}^2 \\rangle$：\n$$\n\\langle \\hat{T}^2 \\rangle = \\left\\langle \\left( \\frac{2 K}{f k_{\\mathrm{B}}} \\right)^2 \\right\\rangle = \\frac{4}{(f k_{\\mathrm{B}})^2} \\langle K^2 \\rangle\n$$\n我们需要计算$\\langle K^2 \\rangle$：\n$$\n\\langle K^2 \\rangle = \\left\\langle \\left( \\sum_{i=1}^{f} K_i \\right)^2 \\right\\rangle = \\left\\langle \\sum_{i=1}^{f} K_i^2 + \\sum_{i \\neq j} K_i K_j \\right\\rangle = \\sum_{i=1}^{f} \\langle K_i^2 \\rangle + \\sum_{i \\neq j} \\langle K_i K_j \\rangle\n$$\n联合动量分布是可因子分解的，这意味着动量变量$p_i$是统计独立的。因此，动能项$K_i = \\frac{p_i^2}{2m_i}$也是统计独立的。对于$i \\neq j$，我们有：\n$$\n\\langle K_i K_j \\rangle = \\langle K_i \\rangle \\langle K_j \\rangle = \\left( \\frac{1}{2} k_{\\mathrm{B}} T \\right) \\left( \\frac{1}{2} k_{\\mathrm{B}} T \\right) = \\frac{1}{4} (k_{\\mathrm{B}} T)^2\n$$\n现在我们必须计算$\\langle K_i^2 \\rangle$。这需要动量的四阶矩$\\langle p_i^4 \\rangle$。对于一个均值为$0$、方差为$\\sigma^2$的一维高斯变量$x$，其各阶矩为$\\langle x^2 \\rangle = \\sigma^2$和$\\langle x^4 \\rangle = 3 \\sigma^4$。根据分布$P(p_i) \\propto \\exp(-\\frac{\\beta p_i^2}{2m_i})$，我们确定$p_i$的方差为$\\sigma_{p_i}^2 = m_i k_{\\mathrm{B}} T$。\n因此，$p_i$的各阶矩为：\n$$\n\\langle p_i^2 \\rangle = m_i k_{\\mathrm{B}} T\n$$\n$$\n\\langle p_i^4 \\rangle = 3 (m_i k_{\\mathrm{B}} T)^2\n$$\n现在我们可以求出$\\langle K_i^2 \\rangle$：\n$$\n\\langle K_i^2 \\rangle = \\left\\langle \\left( \\frac{p_i^2}{2m_i} \\right)^2 \\right\\rangle = \\frac{1}{4m_i^2} \\langle p_i^4 \\rangle = \\frac{1}{4m_i^2} \\left[ 3 (m_i k_{\\mathrm{B}} T)^2 \\right] = \\frac{3}{4} (k_{\\mathrm{B}} T)^2\n$$\n现在我们组合$\\langle K^2 \\rangle$的各项。求和$\\sum_{i=1}^{f} \\langle K_i^2 \\rangle$有$f$个相同项，而求和$\\sum_{i \\neq j} \\langle K_i K_j \\rangle$有$f(f-1)$个相同项。\n$$\n\\langle K^2 \\rangle = f \\left[ \\frac{3}{4} (k_{\\mathrm{B}} T)^2 \\right] + f(f-1) \\left[ \\frac{1}{4} (k_{\\mathrm{B}} T)^2 \\right]\n$$\n$$\n\\langle K^2 \\rangle = \\frac{(k_{\\mathrm{B}} T)^2}{4} [3f + f(f-1)] = \\frac{(k_{\\mathrm{B}} T)^2}{4} [3f + f^2 - f] = \\frac{(k_{\\mathrm{B}} T)^2}{4} (f^2 + 2f)\n$$\n将此结果代回$\\langle \\hat{T}^2 \\rangle$的表达式：\n$$\n\\langle \\hat{T}^2 \\rangle = \\frac{4}{(f k_{\\mathrm{B}})^2} \\langle K^2 \\rangle = \\frac{4}{f^2 k_{\\mathrm{B}}^2} \\left[ \\frac{(k_{\\mathrm{B}} T)^2}{4} (f^2 + 2f) \\right] = \\frac{f^2 + 2f}{f^2} T^2 = \\left( 1 + \\frac{2}{f} \\right) T^2\n$$\n现在我们可以计算$\\hat{T}$的方差：\n$$\n\\operatorname{Var}(\\hat{T}) = \\langle \\hat{T}^2 \\rangle - \\langle \\hat{T} \\rangle^2 = \\left( 1 + \\frac{2}{f} \\right) T^2 - T^2 = \\frac{2}{f} T^2\n$$\n最后，所求的无量纲相对方差为：\n$$\n\\frac{\\operatorname{Var}(\\hat{T})}{T^2} = \\frac{\\frac{2}{f} T^2}{T^2} = \\frac{2}{f}\n$$\n这个结果表明，动能温度估计量的相对涨落与自由度数成反比，这是有限系统统计力学中的一个基本结果。", "answer": "$$\\boxed{\\frac{2}{f}}$$", "id": "2825163"}, {"introduction": "现代模拟依赖于像 Nosé-Hoover 链这样复杂的恒温器来确保准确性和效率。正确地参数化这些恒温器并非易事，但对于稳定和遍历的采样至关重要。本练习 [@problem_id:2825162] 将指导您完成设置恒温器“质量”$Q_i$ 的过程，以便在所需频率范围内控制系统动力学。", "problem": "要求你为在温度$T$下的分子动力学(MD)模拟参数化一个Nosé–Hoover链(NHC)恒温器。该链的长度为$M$，其恒温器变量由$i \\in \\{1,\\dots,M\\}$索引，每个变量都对应一个恒温器质量$Q_i$。令$k_{\\mathrm{B}}$表示玻尔兹曼常数。第一个恒温器耦合到具有$g_1$个有效自由度的物理系统，而链中更深层的恒温器作用于前一个恒温器变量，可以认为其耦合了单个自由度，即对于$i>1$，有$g_i = 1$。\n\n仅从以下基本原理出发：\n- 能量均分原理：在温度$T$的热平衡状态下，每个独立的二次型自由度携带的平均能量为$\\tfrac{1}{2}k_{\\mathrm{B}}T$。\n- 小振动（谐振）近似：在平衡点附近，一个具有惯量$m$和刚度$k$的二次型模式以角频率$\\omega = \\sqrt{k/m}$振荡，其特征时间为$ \\tau = 1/\\omega$。\n\n利用这些原理构建一个选择恒温器质量$Q_i$的方法，使得恒温器链的特征时间$\\tau_i$在对数轴上形成相等的时间尺度间隔，即形成一个公比为$r>1$的等比数列。然后，展示由此得到的恒温器角频率$\\omega_i$在整个链上的分布。\n\n选择所有能够正确且自洽地描述此方法，并正确说明其对恒温器频率分布影响的选项。每个选项都涉及一个从$i=1$开始索引的链，该链具有一个给定的基础时间尺度$\\tau_1$和公比$r>1$。\n\nA. 选择$\\tau_i = \\tau_1 r^{\\,i-1}$并设置$Q_i = g_i\\,k_{\\mathrm{B}}T\\,\\tau_i^2 = g_i\\,k_{\\mathrm{B}}T\\,\\tau_1^2\\,r^{\\,2(i-1)}$。那么$\\omega_i = 1/\\tau_i = \\omega_1\\,r^{-(i-1)}$，其中$\\omega_1 = 1/\\tau_1$，因此频率在对数尺度上是等间距的。\n\nB. 选择$\\tau_i = \\tau_1 r^{\\,i-1}$但设置$Q_i = g_i\\,k_{\\mathrm{B}}T\\,\\tau_1^2\\,r^{-(i-1)}$。那么$\\omega_i \\propto \\sqrt{Q_i}$，得到$\\omega_i = \\omega_1\\,r^{-\\tfrac{1}{2}(i-1)}$，这会产生恒温器频率的相等对数间隔。\n\nC. 对所有$i$选择一个恒定的$Q_i = Q$，这样所有的恒温器时间尺度都相同。这种“平坦”的选择通过将恒温器置于相同频率，在整个频谱上产生均匀的阻尼，这对于宽带控制是理想的。\n\nD. 选择$Q_i = g_i\\,k_{\\mathrm{B}}T\\,\\tau_1^2\\,r^{\\,i-1}$以便$\\omega_i = \\omega_1\\,r^{-\\tfrac{1}{2}(i-1)}$。这实现了相等的时间尺度间隔，因为质量与比率$r$呈线性关系。\n\nE. 在一个包含$M$个恒温器的链中，取$g_1 = g_{\\mathrm{phys}}$（耦合到第一个恒温器的物理自由度数）和$g_i=1$（对于$i>1$），并选择$\\tau_i = \\tau_1 r^{\\,i-1}$，其中$Q_i = g_i\\,k_{\\mathrm{B}}T\\,\\tau_i^2$，即$Q_1 = g_{\\mathrm{phys}}\\,k_{\\mathrm{B}}T\\,\\tau_1^2$以及$Q_{i>1} = k_{\\mathrm{B}}T\\,\\tau_1^2\\,r^{\\,2(i-1)}$。这在整个链上保持了$\\omega_i = \\omega_1 r^{-(i-1)}$的几何频率分布。\n\n选择所有适用项。", "solution": "我们从给定的基本原理出发，推导恒温器质量与时间尺度之间的映射关系。\n\n根据小振动近似，一个具有惯量$m$和刚度$k$的二次型模式具有角频率$\\omega = \\sqrt{k/m}$和特征时间$\\tau = 1/\\omega = \\sqrt{m/k}$。在Nosé–Hoover链(NHC)中，第$i$层的恒温器变量是一个惯量为$Q_i$的二次型模式。控制其在平衡点附近涨落的“刚度”由其所调控的自由度的热尺度决定。根据能量均分原理，每个二次型自由度贡献的平均能量为$\\tfrac{1}{2}k_{\\mathrm{B}}T$。对于第一个恒温器，它调控着$g_1$个有效自由度的动能，其相关的热尺度与$g_1 k_{\\mathrm{B}}T$成正比。对于调控单个前序恒温器变量的更深层恒温器，按照惯例且为了保持一致性，取$g_i = 1$（对于$i>1$）。\n\n这些考虑导致了以下被广泛使用且量纲一致的映射关系（这是MD实践中一个标准且经过充分检验的选择）\n$$\n\\tau_i^2 \\;=\\; \\frac{Q_i}{g_i\\,k_{\\mathrm{B}}T}, \\qquad \\text{等价地} \\qquad Q_i \\;=\\; g_i\\,k_{\\mathrm{B}}T\\,\\tau_i^2,\n$$\n从而恒温器的固有频率为\n$$\n\\omega_i \\;=\\; \\frac{1}{\\tau_i} \\;=\\; \\sqrt{\\frac{g_i\\,k_{\\mathrm{B}}T}{Q_i}}.\n$$\n\n现在通过选择以下方式在对数轴上施加相等的时间尺度间隔：\n$$\n\\tau_i \\;=\\; \\tau_1\\, r^{\\,i-1}, \\qquad r>1.\n$$\n将其代入映射关系，得到恒温器质量为\n$$\nQ_i \\;=\\; g_i\\,k_{\\mathrm{B}}T\\,\\tau_i^2 \\;=\\; g_i\\,k_{\\mathrm{B}}T\\,\\tau_1^2\\, r^{\\,2(i-1)}.\n$$\n对应的频率为\n$$\n\\omega_i \\;=\\; \\frac{1}{\\tau_i} \\;=\\; \\frac{1}{\\tau_1}\\, r^{-(i-1)} \\;=\\; \\omega_1\\, r^{-(i-1)},\n$$\n因此$\\{\\omega_i\\}$是以$1/r$为公比的等比数列，即在对数频率轴上等间距分布。\n\n我们现在来评估每个选项：\n\nA. 该选项指定$\\tau_i = \\tau_1 r^{\\,i-1}$并设置$Q_i = g_i\\,k_{\\mathrm{B}}T\\,\\tau_i^2 = g_i\\,k_{\\mathrm{B}}T\\,\\tau_1^2\\, r^{\\,2(i-1)}$，然后推导出$\\omega_i = \\omega_1 r^{-(i-1)}$。这与上面的推导相符，并正确地陈述了对数频率间隔。结论——正确。\n\nB. 该选项给定$Q_i = g_i\\,k_{\\mathrm{B}}T\\,\\tau_1^2\\, r^{-(i-1)}$，这对于$\\tau_i = \\tau_1 r^{\\,i-1}$来说与$Q_i \\propto \\tau_i^2$相矛盾；$r$的次幂是错误的，并且符号也不对。它还断言$\\omega_i \\propto \\sqrt{Q_i}$，而从$\\omega_i = 1/\\tau_i$和$\\tau_i^2 = Q_i/(g_i k_{\\mathrm{B}}T)$我们得到$\\omega_i \\propto 1/\\sqrt{Q_i}$，而不是$\\sqrt{Q_i}$。结论——不正确。\n\nC. 选择一个恒定的$Q_i = Q$只在$g_i$也为常数时才会得到相同的$\\tau_i = \\sqrt{Q/(g_i k_{\\mathrm{B}}T)}$；即便如此，所有恒温器也将共享相同的特征频率$\\omega_i$，这无法提供跨频带的覆盖，也无法实现相等的时间尺度间隔。所声称的“在整个频谱上的均匀阻尼”并不能从相同的频率推导出来。结论——不正确。\n\nD. 该选项使用$Q_i \\propto r^{\\,i-1}$，这意味着$\\tau_i \\propto r^{\\tfrac{1}{2}(i-1)}$和$\\omega_i \\propto r^{-\\tfrac{1}{2}(i-1)}$，而不是目标$\\tau_i \\propto r^{\\,i-1}$。因此，它没有实现以$r$为公比的$\\tau_i$等比数列形式的相等时间尺度间隔；它将间隔压缩了一个平方根因子。结论——不正确。\n\nE. 该选项包含了常规且一致的选择$g_1 = g_{\\mathrm{phys}}$和$g_i=1$（对于$i>1$），应用了$\\tau_i = \\tau_1 r^{\\,i-1}$，并设置了$Q_i = g_i\\,k_{\\mathrm{B}}T\\,\\tau_i^2$，明确给出了$Q_1 = g_{\\mathrm{phys}}\\,k_{\\mathrm{B}}T\\,\\tau_1^2$和$Q_{i>1} = k_{\\mathrm{B}}T\\,\\tau_1^2\\, r^{\\,2(i-1)}$。得到的$\\omega_i = \\omega_1 r^{-(i-1)}$与几何频率分布相符。这是一个正确且常用的实现细节，与推导出的过程保持一致。结论——正确。\n\n因此，正确的选项是A和E。", "answer": "$$\\boxed{AE}$$", "id": "2825162"}, {"introduction": "并非所有恒温器都能正确地对目标统计系综进行采样，使用近似方法可能会在模拟结果中引入微妙但显著的偏差。本练习 [@problem_id:2825168] 挑战您设计一个严谨的统计方案来检测此类人为效应。成功完成本练习将使您具备批判性思维能力，以验证模拟方法并确保研究结果的可靠性。", "problem": "一个由 $N$ 个相互作用的粒子组成的液体系统，在固定的粒子数、温度和压力下进行模拟（等温等压系综，通常表示为 $\\mathrm{NPT}$）。在相同的状态点 $\\left(N,T,P\\right)$ 下，生成了两条长的分子动力学 (MD) 轨迹：一条使用严格遍历的恒温器-恒压器对，另一条使用 Berendsen 类型的速度和体积重标度方案。现只给出每条轨迹的瞬时动能 $K(t)$ 和瞬时体积 $V(t)$ 的时间序列，并要求您判断 Berendsen 轨迹在其平衡分布中是否表现出统计上显著的偏差。您的决策必须仅基于 $K$ 和 $V$ 的直方图统计量，并利用统计力学的第一性原理来确定适当的参考分布。该检验应将族系 I 类错误率控制在预设水平 $\\alpha$（其中 $\\alpha = 0.05$）内，并且必须考虑 MD 模拟所固有的时间相关性。\n\n下列哪个方案是对此类检验的有效设计？\n\nA. 通过计算 $K(t)$ 和 $V(t)$ 的积分自相关时间来估计有效去相关区间，并对每个序列进行稀疏化处理以获得近似独立的样本。对于 $K$，构建一个拟合优度检验，在经过正则系综无量纲化后，使用 Anderson–Darling (AD) 统计量，在 $\\alpha/2$ 的水平上，将稀疏化后的直方图与具有 $f$ 个动能自由度的相应卡方参考定律进行比较。对于 $V$，在大型系统中 $V$ 涨落的正态近似下，使用单样本卡方方差检验，在 $\\alpha/2$ 的水平上，将稀疏化后的样本方差与从独立的状态方程获得的等温压缩率所隐含的方差进行比较。如果任一检验拒绝原假设，则拒绝该平衡采样器是无偏的这一原假设（Bonferroni 控制）。\n\nB. 从原始、未稀疏化的序列中计算样本均值 $\\langle K\\rangle$ 和 $\\langle V\\rangle$，并使用两个 $z$ 检验，在 $\\alpha$ 的水平上，将它们与其热力学目标均值进行比较。如果两个均值在统计误差范围内匹配，则断定 Berendsen 轨迹在其平衡分布中是无偏的。\n\nC. 使用双样本 Kolmogorov–Smirnov (KS) 检验，在 $\\alpha$ 的水平上，比较两条轨迹的原始、未稀疏化的 $K$ 和 $V$ 的直方图。如果任一 KS 检验拒绝原假设，则宣布 Berendsen 轨迹是有偏的。\n\nD. 对 Berendsen 轨迹和参考轨迹的原始 $K$ 和 $V$ 直方图进行高斯分布拟合，并使用 $F$ 检验，在 $\\alpha$ 的水平上，比较每个可观测量拟合出的方差。如果 Berendsen 轨迹对于 $K$ 和 $V$ 都显示出更小的方差，则断定它是有偏的；否则，断定它是无偏的。", "solution": "必须首先验证问题陈述的科学合理性、清晰性和完整性。\n\n**步骤 1：提取已知条件**\n- 系统：一个由 $N$ 个相互作用的粒子组成的液体。\n- 系综：在固定状态点 $(N, T, P)$ 的等温等压 ($\\mathrm{NPT}$) 系综。\n- 轨迹：有两条长的分子动力学 (MD) 轨迹。\n    1. 一条参考轨迹，由一个严格遍历的恒温器-恒压器对生成，假定其能正确采样 $\\mathrm{NPT}$ 系综。\n    2. 一条测试轨迹，由一个 Berendsen 类型的速度和体积重标度方案生成。\n- 数据：每条轨迹的瞬时动能 $K(t)$ 和瞬时体积 $V(t)$ 的时间序列。\n- 目标：确定 Berendsen 轨迹是否在其平衡概率分布中表现出统计上显著的偏差。\n- 约束条件：\n    - 决策必须基于 $K$ 和 $V$ 的直方图统计量。\n    - 参考分布必须根据统计力学的第一性原理确定。\n    - 该检验必须将族系 I 类错误率控制在预设水平 $\\alpha = 0.05$ 内。\n    - 该检验必须考虑 MD 模拟所固有的时间相关性。\n\n**步骤 2：使用已知条件进行验证**\n该问题具有科学依据。它涉及计算统计力学中一个标准且重要的任务：对照目标统计系综（$\\mathrm{NPT}$）的已知性质，验证一个近似模拟算法（Berendsen 方案）的输出。众所周知，Berendsen 恒温器和恒压器产生的构型并不严格遵循正则或等温等压分布，特别是通过抑制自然涨落。如何检验这种偏差的问题是明确且相关的。\n\n该问题是适定的。它要求在明确的约束条件下（使用 $K(t)$ 和 $V(t)$、控制 I 类错误、考虑相关性）设计一个统计方案。语言精确、客观。设计此类检验所需的所有概念性信息都已提供。这个问题不简单；它需要综合运用统计力学、时间序列分析和假设检验的知识。\n\n**步骤 3：结论与行动**\n问题陈述是有效的。它科学合理、适定，且不包含任何歧义或矛盾。将推导出一个解决方案。\n\n**推导有效的检验方案**\n\n一个有效的统计检验必须解决问题陈述所规定的三个关键方面：（1）可观测量 $K$ 和 $V$ 的正确理论参考分布；（2）MD 时间序列中的时间相关性问题；（3）对多重检验的族系错误率的控制。\n\n1.  **来自第一性原理的参考分布：**\n    - **动能 ($K$)**：在任何温度 $T$ 固定的系综（正则系综、等温等压系综）中，动量坐标与位置坐标解耦，并遵循麦克斯韦-玻尔兹曼分布。总动能 $K$ 是 $f$ 个平方高斯随机变量（动量分量）之和，其中 $f$ 是动能自由度的数量。通常，对于一个在 3 维空间中移除了质心运动的 $N$ 粒子系统，$f = 3N-3$。变量 $2\\beta K$（其中 $\\beta = (k_\\mathrm{B} T)^{-1}$）遵循具有 $f$ 个自由度的卡方分布，即 $\\chi^2_f$。因此，对 $K$ 的正确检验是将其经验分布与理论伽马分布（或等效地，缩放变量的 $\\chi^2$ 分布）进行拟合优度检验。Berendsen 恒温器的一个已知偏差是它会产生一个人为变窄的 $K$ 分布，这可以被一个足够强大的拟合优度检验检测出来。\n\n    - **体积 ($V$)**：在 $\\mathrm{NPT}$ 系综中，体积 $V$ 的概率分布没有一个简单的普适形式。然而，对于一个大系统，宏观变量的涨落预计在其均值附近呈近似高斯分布。该分布的一个关键性质是其方差，它通过涨落-耗散定理与一个宏观热力学响应函数相关联：\n    $$ \\sigma_V^2 = \\langle (V - \\langle V \\rangle)^2 \\rangle = k_\\mathrm{B} T \\langle V \\rangle \\kappa_T $$\n    其中 $\\kappa_T$ 是等温压缩率，$\\kappa_T = -\\frac{1}{V} \\left( \\frac{\\partial V}{\\partial P} \\right)_{N,T}$。众所周知，Berendsen 恒压器会人为地抑制这些体积涨落，导致样本方差系统性地小于理论值。因此，一个有效的检验可以将模拟得到的 $V$ 的样本方差与使用独立确定的 $\\kappa_T$ 值（例如，从物质的可靠状态方程获得）计算出的理论方差进行比较。假设体积涨落近似正态，单样本卡方方差检验是合适的统计工具。\n\n2.  **处理时间相关性：**\n    MD 模拟生成的时间序列中，连续的数据点高度相关。如果将假设样本独立同分布 (i.i.d.) 的标准统计检验直接应用于此类“原始”数据，则这些检验是无效的。这样做会严重低估样本估计量的真实方差，导致 I 类错误率不受控制地膨胀（虚假拒绝）。为了获得近似独立的样本，必须首先为每个时间序列（$K(t)$ 和 $V(t)$）估计统计效率低下因子 $g$ 或积分自相关时间 $\\tau$。有效独立样本的数量是 $N_{eff} = N_{total}/g$，其中 $g = 2\\tau+1$。解决此问题的一个实用方法是通过选取间隔至少为 $g$（或 $2\\tau$）的样本来“稀疏化”数据，从而创建一个几乎不相关的样本新数据集，在此数据集上可以有效地执行统计检验。任何有效的方案都**必须**解决这个问题。\n\n3.  **族系错误率 (FWER) 控制：**\n    该问题要求执行两个独立的统计检验（一个用于 $K$，一个用于 $V$）。如果每个检验都在显著性水平 $\\alpha$ 下进行，那么在这一族检验中犯至少一次错误拒绝（I 类错误）的概率将大于 $\\alpha$。为了将 FWER 控制在指定的水平 $\\alpha=0.05$，必须进行多重比较校正。Bonferroni 校正是一种简单而通用的方法。对于 $M=2$ 个检验，它要求每个独立检验都在 $\\alpha/M = 0.05/2 = 0.025$ 的显著性水平下进行。\n\n**有效方案总结：**\n一个正确的方案将包括：（i）基于积分自相关时间对 $K(t)$ 和 $V(t)$ 序列进行稀疏化处理；（ii）在 $\\alpha/2$ 的水平上，对稀疏化后的 $K$ 数据与理论 $\\chi^2$ 分布进行拟合优度检验；（iii）在 $\\alpha/2$ 的水平上，对稀疏化后的 $V$ 数据的方差与从压缩率得出的理论方差进行方差检验；（iv）如果任一检验拒绝原假设，则拒绝原假设（即 Berendsen 是无偏的）。\n\n**逐项分析选项**\n\n**A. 通过计算 $K(t)$ 和 $V(t)$ 的积分自相关时间来估计有效去相关区间，并对每个序列进行稀疏化处理以获得近似独立的样本。对于 $K$，构建一个拟合优度检验，在经过正则系综无量纲化后，使用 Anderson–Darling (AD) 统计量，在 $\\alpha/2$ 的水平上，将稀疏化后的直方图与具有 $f$ 个动能自由度的相应卡方参考定律进行比较。对于 $V$，在大型系统中 $V$ 涨落的正态近似下，使用单样本卡方方差检验，在 $\\alpha/2$ 的水平上，将稀疏化后的样本方差与从独立的状态方程获得的等温压缩率所隐含的方差进行比较。如果任一检验拒绝原假设，则拒绝该平衡采样器是无偏的这一原假设（Bonferroni 控制）。**\n\n该选项正确地解决了推导中确定的所有三个关键组成部分。\n- 它通过估计自相关时间和稀疏化数据来正确处理时间相关性。\n- 它正确地将动能的理论参考分布确定为卡方定律，并提出了一个强大的拟合优度检验（Anderson-Darling）。\n- 它正确地确定了体积方差的涨落-耗散关系，并提出了一个合适的统计检验（单样本卡方方差检验）。\n- 它通过在 $\\alpha/2$ 的水平上进行检验，正确地应用了 Bonferroni 校正来控制族系错误率。\n该方案在统计上是严谨的，在物理上是合理的。\n**结论：正确**\n\n**B. 从原始、未稀疏化的序列中计算样本均值 $\\langle K\\rangle$ 和 $\\langle V\\rangle$，并使用两个 $z$ 检验，在 $\\alpha$ 的水平上，将它们与其热力学目标均值进行比较。如果两个均值在统计误差范围内匹配，则断定 Berendsen 轨迹在其平衡分布中是无偏的。**\n\n该选项因多种原因存在严重缺陷。\n- 它使用“原始、未稀疏化的序列”进行统计检验。这是一个致命错误，因为它忽略了时间相关性，这使得 $z$ 检验所依据的标准误差计算无效，并导致不受控制的 I 类错误。\n- 它只检验了分布的均值。Berendsen 恒温器/恒压器的明确设计就是将平均动能和平均压力（并因此包括体积）驱动到目标值。因此，均值预计是匹配的。Berendsen 方案的已知偏差在于*涨落*（即分布的方差和形状），而不是均值。因此，这个检验对其本应检测的效应不敏感。\n- 它未能控制 FWER，因为它建议在 $\\alpha$ 水平上进行两个检验。\n**结论：不正确**\n\n**C. 使用双样本 Kolmogorov–Smirnov (KS) 检验，在 $\\alpha$ 的水平上，比较两条轨迹的原始、未稀疏化的 $K$ 和 $V$ 的直方图。如果任一 KS 检验拒绝原假设，则宣布 Berendsen 轨迹是有偏的。**\n\n这个选项同样存在致命缺陷。\n- 它使用“原始、未稀疏化的直方图”。Kolmogorov-Smirnov 检验假设样本是独立同分布的。将其应用于来自 MD 模拟的相关时间序列数据在统计上是无效的。生成的 p 值将毫无意义。\n- 虽然使用遍历轨迹作为参考是合理的，但问题陈述倾向于与第一性原理分布进行比较，这是一个更根本的检验。\n- 它未能恰当地在 $\\alpha$ 水平上控制 FWER。\n- 主要的、致命的缺陷是使用了未稀疏化的数据。\n**结论：不正确**\n\n**D. 对 Berendsen 轨迹和参考轨迹的原始 $K$ 和 $V$ 直方图进行高斯分布拟合，并使用 $F$ 检验，在 $\\alpha$ 的水平上，比较每个可观测量拟合出的方差。如果 Berendsen 轨迹对于 $K$ 和 $V$ 都显示出更小的方差，则断定它是有偏的；否则，断定它是无偏的。**\n\n这个选项包含许多严重错误。\n- 它假设动能 $K$ 服从高斯分布。这在物理上是不正确的。$K$ 的分布是伽马分布。用于检验方差的 $F$ 检验对偏离正态性的情况高度敏感，仅凭这一点，将其应用于 $K$ 数据就是无效的。\n- 它使用“原始直方图”，从而忽略了时间相关性，并使所执行的任何统计检验无效。\n- 其决策逻辑（“如果......对于两者都显示出更小的方差，则断定......有偏；否则，断定......无偏”）在统计上是幼稚的。假设检验需要基于 p 值和显著性水平定义一个拒绝域。我们不能仅仅因为没有观察到特定的方向性差异就断定“无偏”。\n- 它未能控制 FWER。\n**结论：不正确**", "answer": "$$\\boxed{A}$$", "id": "2825168"}]}