{"hands_on_practices": [{"introduction": "为了构建稳健的可极化力场，理解简单点偶极子模型的内在局限性至关重要。这个练习将引导你通过第一性原理推导一个双中心系统的互感应能，并揭示在近距离时出现的“极化灾变”—— 一种非物理的发散行为。通过这个推导，你将深刻理解为何在力场中引入短程阻尼或筛选是必不可少的 [@problem_id:2795532]。", "problem": "两个固定的可极化位点位于 $z$ 轴上，中心距为 $r$。位点 $i \\in \\{1,2\\}$ 具有各向同性的线性极化率 $\\alpha_i$ 并带有一个固定的永久点偶极矩 $\\mu_i$，该偶极矩被约束为与 $z$ 轴共线。不存在外部电场。唯一的相互作用是永久偶极矩和感应偶极矩之间的经典静电相互作用，且感应偶极矩根据 $p_i = \\alpha_i E_i^{\\mathrm{loc}}$ 对局部电场作出线性响应。假设在国际单位制（SI）中，真空中点偶极矩轴线上电场的标准表达式，即偶极矩 $\\mu$ 在其轴线上距离 $r$ 处产生的电场为 $E_{\\parallel} = \\left(1/(4\\pi \\varepsilon_0)\\right)\\left(2 \\mu / r^3\\right)$，其符号根据其方向被吸收到带符号的标量 $\\mu$ 中。忽略所有短程阻尼或屏蔽效应。\n\n仅使用这些要素和对感应偶极矩的自洽场（SCF）处理方法，推导共线构型下二聚体的总相互感应（极化）能 $U_{\\mathrm{pol}}$ 的闭合形式解析表达式，该表达式是 $\\alpha_1$、$\\alpha_2$、$\\mu_1$、$\\mu_2$、$r$ 和 $\\varepsilon_0$ 的函数。此外，确定在无阻尼的情况下，SCF 解在何种关于 $r$、$\\alpha_1$ 和 $\\alpha_2$ 的条件下会发散（即发生极化灾变），并从物理上解释这个条件。用国际单位制（SI）符号表达你最终的能量表达式。不要进行任何数值代入。最终答案必须是关于 $U_{\\mathrm{pol}}$ 的单个闭合形式表达式。", "solution": "该问题陈述科学严谨、内容自洽、提法得当，是经典静电学及其在分子相互作用中应用的一个标准习题。所有提供的信息均与基本原理一致。下面将进行推导。\n\n设两个位点标记为 $1$ 和 $2$。它们位于 $z$ 轴上，相距为 $r$。位点 $i$ 具有永久偶极矩 $\\mu_i$ 和各向同性极化率 $\\alpha_i$。偶极矩与 $z$ 轴共线，因此可将它们视为带符号的标量。位点 $i$ 的总偶极矩是永久偶极矩和感应偶极矩之和：$m_i = \\mu_i + p_i$。\n\n位点 $i$ 处的感应偶极矩 $p_i$ 与该位点的局部电场 $E_i^{\\mathrm{loc}}$ 成线性正比关系，遵循 $p_i = \\alpha_i E_i^{\\mathrm{loc}}$。一个位点上的局部电场由另一个位点的总偶极矩产生。\n\n由偶极矩 $m$ 在其轴线上距离 $r$ 处产生的电场由 $E = T m$ 给出，其中，对于这种共线构型，相互作用张量 $T$ 简化为一个标量：\n$$T = \\frac{2}{4\\pi \\varepsilon_0 r^3}$$\n因此，位点 $1$ 和 $2$ 处的局部电场为：\n$$E_1^{\\mathrm{loc}} = T m_2 = T(\\mu_2 + p_2)$$\n$$E_2^{\\mathrm{loc}} = T m_1 = T(\\mu_1 + p_1)$$\n\n使用线性响应关系，我们为感应偶极矩 $p_1$ 和 $p_2$ 建立一个自洽场（SCF）方程组：\n$$p_1 = \\alpha_1 E_1^{\\mathrm{loc}} = \\alpha_1 T (\\mu_2 + p_2)$$\n$$p_2 = \\alpha_2 E_2^{\\mathrm{loc}} = \\alpha_2 T (\\mu_1 + p_1)$$\n这是一个关于两个未知数 $p_1$ 和 $p_2$ 的二元线性方程组。可将其写成矩阵形式：\n$$\n\\begin{pmatrix} 1 & -\\alpha_1 T \\\\ -\\alpha_2 T & 1 \\end{pmatrix}\n\\begin{pmatrix} p_1 \\\\ p_2 \\end{pmatrix}\n=\nT \\begin{pmatrix} \\alpha_1 \\mu_2 \\\\ \\alpha_2 \\mu_1 \\end{pmatrix}\n$$\n通过代入法或矩阵求逆法求解该方程组，可得到感应偶极矩的表达式：\n$$p_1 = \\frac{\\alpha_1 T \\mu_2 + \\alpha_1 \\alpha_2 T^2 \\mu_1}{1 - \\alpha_1 \\alpha_2 T^2}$$\n$$p_2 = \\frac{\\alpha_2 T \\mu_1 + \\alpha_1 \\alpha_2 T^2 \\mu_2}{1 - \\alpha_1 \\alpha_2 T^2}$$\n分母 $D = 1 - \\alpha_1 \\alpha_2 T^2$ 对解的稳定性至关重要。\n\n总极化（或感应）能 $U_{\\mathrm{pol}}$ 是引入极化率后系统能量的变化。它可以从系统的总能量泛函中推导出来，该泛函包括偶极-偶极相互作用能和产生感应偶极矩所需的自能：\n$$U(p_1, p_2) = -T(\\mu_1 + p_1)(\\mu_2 + p_2) + \\frac{p_1^2}{2\\alpha_1} + \\frac{p_2^2}{2\\alpha_2}$$\n物理上的感应偶极矩是使该泛函最小化的值，这能正确地恢复 SCF 方程。极化能即为 $U_{\\mathrm{pol}} = U(p_1, p_2) - U(0, 0)$。\n$$U_{\\mathrm{pol}} = \\left( -T(\\mu_1+p_1)(\\mu_2+p_2) + \\frac{p_1^2}{2\\alpha_1} + \\frac{p_2^2}{2\\alpha_2} \\right) - (-T\\mu_1\\mu_2)$$\n$$U_{\\mathrm{pol}} = -T(\\mu_1 p_2 + \\mu_2 p_1 + p_1 p_2) + \\frac{p_1^2}{2\\alpha_1} + \\frac{p_2^2}{2\\alpha_2}$$\n使用 SCF 关系 $p_1/\\alpha_1 = T(\\mu_2+p_2)$ 和 $p_2/\\alpha_2 = T(\\mu_1+p_1)$，自能项可以改写为：\n$$\\frac{p_1^2}{2\\alpha_1} = \\frac{1}{2}p_1 T(\\mu_2+p_2) \\quad \\text{和} \\quad \\frac{p_2^2}{2\\alpha_2} = \\frac{1}{2}p_2 T(\\mu_1+p_1)$$\n将这些代入 $U_{\\mathrm{pol}}$ 的表达式并化简，得到一个紧凑的形式：\n$$U_{\\mathrm{pol}} = -T(\\mu_1 p_2 + \\mu_2 p_1 + p_1 p_2) + \\frac{1}{2}T(p_1\\mu_2 + p_1p_2) + \\frac{1}{2}T(p_2\\mu_1 + p_1p_2)$$\n$$U_{\\mathrm{pol}} = -\\frac{1}{2} T (\\mu_1 p_2 + \\mu_2 p_1)$$\n这个结果对应于著名的公式 $U_{\\mathrm{pol}} = -\\frac{1}{2} \\sum_i \\mathbf{p}_i \\cdot \\mathbf{E}_{i}^{\\mathrm{perm}}$，其中 $\\mathbf{E}_{i}^{\\mathrm{perm}}$ 是由永久偶极矩在位点 $i$ 产生的电场。\n\n现在我们将已解出的 $p_1$ 和 $p_2$ 的表达式代入此能量公式：\n$$U_{\\mathrm{pol}} = -\\frac{T}{2} \\left[ \\mu_2 \\left( \\frac{\\alpha_1 T \\mu_2 + \\alpha_1 \\alpha_2 T^2 \\mu_1}{1 - \\alpha_1 \\alpha_2 T^2} \\right) + \\mu_1 \\left( \\frac{\\alpha_2 T \\mu_1 + \\alpha_1 \\alpha_2 T^2 \\mu_2}{1 - \\alpha_1 \\alpha_2 T^2} \\right) \\right]$$\n将各项合并到共同分母上，得到：\n$$U_{\\mathrm{pol}} = -\\frac{T}{2(1 - \\alpha_1 \\alpha_2 T^2)} \\left[ \\alpha_1 T \\mu_2^2 + \\alpha_1 \\alpha_2 T^2 \\mu_1 \\mu_2 + \\alpha_2 T \\mu_1^2 + \\alpha_1 \\alpha_2 T^2 \\mu_1 \\mu_2 \\right]$$\n$$U_{\\mathrm{pol}} = -\\frac{T^2}{2(1 - \\alpha_1 \\alpha_2 T^2)} \\left[ \\alpha_2 \\mu_1^2 + \\alpha_1 \\mu_2^2 + 2\\alpha_1 \\alpha_2 T \\mu_1 \\mu_2 \\right]$$\n为得到最终表达式，我们代入 $T = \\frac{2}{4\\pi\\varepsilon_0 r^3}$：\n$$T^2 = \\frac{4}{(4\\pi\\varepsilon_0)^2 r^6}$$\n$$U_{\\mathrm{pol}} = -\\frac{4 / (2(4\\pi\\varepsilon_0)^2 r^6)}{1 - 4\\alpha_1\\alpha_2 / ((4\\pi\\varepsilon_0)^2 r^6)} \\left[ \\alpha_2 \\mu_1^2 + \\alpha_1 \\mu_2^2 + \\frac{4\\alpha_1 \\alpha_2 \\mu_1 \\mu_2}{4\\pi\\varepsilon_0 r^3} \\right]$$\n$$U_{\\mathrm{pol}} = -\\frac{2/((4\\pi\\varepsilon_0)^2 r^6)}{((4\\pi\\varepsilon_0)^2 r^6 - 4\\alpha_1\\alpha_2) / ((4\\pi\\varepsilon_0)^2 r^6)} \\left[ \\dots \\right]$$\n$$U_{\\mathrm{pol}} = -\\frac{2}{(4\\pi\\varepsilon_0)^2 r^6 - 4\\alpha_1\\alpha_2} \\left[ \\alpha_2 \\mu_1^2 + \\alpha_1 \\mu_2^2 + \\frac{4\\alpha_1\\alpha_2 \\mu_1 \\mu_2}{4\\pi\\varepsilon_0 r^3} \\right]$$\n\n当分母 $1 - \\alpha_1\\alpha_2 T^2$ 等于零时，感应偶极矩的 SCF 解以及由此得到的极化能会发散。这就是**极化灾变**。这种发散的条件是：\n$$1 - \\alpha_1 \\alpha_2 T^2 = 0 \\implies 1 = \\alpha_1 \\alpha_2 \\left(\\frac{2}{4\\pi\\varepsilon_0 r^3}\\right)^2 \\implies (4\\pi\\varepsilon_0)^2 r^6 = 4\\alpha_1 \\alpha_2$$\n灾变发生在临界距离 $r_c = (4\\alpha_1\\alpha_2 / (4\\pi\\varepsilon_0)^2)^{1/6}$ 处。\n\n**物理诠释**：项 $\\alpha_1 \\alpha_2 T^2$ 充当了相互极化的“环路增益”。位点 $1$ 处的感应偶极矩增强了位点 $2$ 处的电场，这反过来又增强了位点 $1$ 处的感应偶极矩。这构成了一个正反馈回路。当环路增益达到 1 时，系统对任何扰动的响应都变得无穷大。物理上，这表示一种不稳定性，系统会自发地极化到无穷大程度以降低其能量。这是线性点偶极矩模型的产物；在现实中，非线性效应（超极化率）和短程排斥相互作用（电荷重叠和穿透）会使该行为正规化，并防止真正的发散。", "answer": "$$\n\\boxed{-\\frac{2 \\left( \\alpha_2 \\mu_1^2 + \\alpha_1 \\mu_2^2 + \\frac{4\\alpha_1\\alpha_2 \\mu_1 \\mu_2}{4\\pi\\varepsilon_0 r^3} \\right)}{(4\\pi\\varepsilon_0)^2 r^6 - 4\\alpha_1\\alpha_2}}\n$$", "id": "2795532"}, {"introduction": "为了解决点偶极子模型在短距离处的极化灾变问题，研究者们发展了多种筛选函数，其中 Thole 阻尼模型是最著名和广泛使用的一种。这个练习提供了一个具体的计算机会，让你在一个双中心系统上直接应用 Thole 阻尼，并量化其对诱导偶极子的影响。通过对比有阻尼和无阻尼的结果，你将获得关于筛选函数如何修正相互作用以及其效应大小的直观感受 [@problem_id:2795524]。", "problem": "考虑两个相同的各向同性可极化位点，位于 $z$ 轴上 $z=\\pm r/2$ 的位置，其标量极化率为 $\\alpha$。一个大小为 $E_0$ 的均匀外电场 $\\mathbf{E}_0$ 沿 $+\\hat{\\mathbf{z}}$ 方向施加。在原子单位制下进行计算，因此 $4\\pi\\varepsilon_0=1$。假设由于对称性，感应偶极子被限制在 $z$ 轴上，并且两个位点相同，因此 $\\mu_1=\\mu_2=\\mu$。\n\n使用的基本原理：\n- 线性响应（各向同性极化率的定义）：$\\boldsymbol{\\mu}^{\\text{ind}}=\\alpha\\,\\mathbf{E}_{\\text{loc}}$。\n- 点偶极子在其轴线上的电场（原子单位制）：$E_{\\text{axis}}=2\\mu/r^3$，方向沿偶极矩方向。\n- 对于两个位点，每个位点处的局域场是外场与另一个位点的感应偶极子产生的场（如果存在阻尼，则会被修正）之和。\n\n您将比较两种分子间偶极-偶极耦合张量的模型：\n1. 无阻尼点偶极子：使用轴向耦合 $T_{zz}=2/r^3$。\n2. Thole 阻尼偶极子：将 $T_{zz}$ 替换为 $T_{zz}^{\\text{damp}}=f_3(u)\\,(2/r^3)$，其中用于偶极-偶极相互作用的 Thole 屏蔽函数为\n$$\nf_3(u)=1-\\exp\\!\\big(-a\\,u^3\\big)\\sum_{n=0}^{2}\\frac{\\big(a\\,u^3\\big)^n}{n!},\n$$\n其中对于相同的各向同性位点，$u=r/\\left(\\alpha^{1/3}\\right)$，$a$ 是一个无量纲的阻尼参数。\n\n参数：\n- 间距 $r=3.000\\,a_0$。\n- 极化率 $\\alpha=10.00\\,a_0^3$。\n- 外场大小 $E_0=0.0100$（原子单位制电场）。\n- Thole 参数 $a=0.390$。\n\n任务：\n- 从第一性原理出发，建立并求解耦合线性响应方程，以获得在无阻尼和有 Thole 阻尼情况下每个位点的感应偶极矩大小 $\\mu$。\n- 将由 Thole 阻尼引起的感应偶极矩大小的分数减少量定义为\n$$\n\\mathcal{R}=1-\\frac{|\\mu|_{\\text{Thole}}}{|\\mu|_{\\text{undamped}}}.\n$$\n计算给定参数下的 $\\mathcal{R}$。\n\n答案规格：\n- 仅报告 $\\mathcal{R}$ 的值，形式为小数（无单位）。\n- 将最终答案四舍五入到四位有效数字。", "solution": "审阅后，此问题陈述被认为是有效的。它在科学上基于经典静电学和线性响应理论在可极化分子建模中的应用原理。该问题提法明确，为获得唯一解提供了所有必要的数据和定义。其语言客观而精确。因此，我将开始求解。\n\n该系统由两个相同的各向同性可极化位点组成，标记为 $1$ 和 $2$，分别位于 $z = -r/2$ 和 $z = +r/2$。施加了一个均匀外电场 $\\mathbf{E}_0 = E_0 \\hat{\\mathbf{z}}$。每个位点的标量极化率为 $\\alpha$。由于系统的对称性，两个位点的感应偶极矩必须相同，即 $\\boldsymbol{\\mu}_1 = \\boldsymbol{\\mu}_2 = \\boldsymbol{\\mu}$。此外，由于外场沿 $z$ 轴方向，感应偶极子也被限制在 $z$ 轴上，因此 $\\boldsymbol{\\mu} = \\mu\\hat{\\mathbf{z}}$。\n\n控制该系统的基本原理是线性响应方程，该方程指出位点 $i$ 的感应偶极矩与该位点处的局域电场 $\\mathbf{E}_{\\text{loc}, i}$ 成正比：\n$$\n\\boldsymbol{\\mu}_i = \\alpha \\mathbf{E}_{\\text{loc}, i}\n$$\n位点 $i$ 的局域场是外场 $\\mathbf{E}_0$ 和由另一个偶极矩产生的场 $\\mathbf{E}_{j \\to i}$ 的矢量和。对于位点 $2$：\n$$\n\\mathbf{E}_{\\text{loc}, 2} = \\mathbf{E}_0 + \\mathbf{E}_{1 \\to 2}\n$$\n偶极子 $\\boldsymbol{\\mu}_1$ 在位点 $2$ 处产生的场由 $\\mathbf{E}_{1 \\to 2} = \\mathbf{T}_{21} \\boldsymbol{\\mu}_1$ 给出，其中 $\\mathbf{T}_{21}$ 是偶极相互作用张量。对于沿 $z$ 轴相距为 $r$ 的两个偶极子，且偶极子本身也沿 $z$ 轴取向，相互作用张量的相关分量是 $T_{zz}$。问题中给出，轴向偶极子产生的场为 $2\\mu/r^3$，方向沿偶极子方向。两个偶极子都指向 $+\\hat{\\mathbf{z}}$ 方向，因此 $\\boldsymbol{\\mu}_1$ 在位点 $2$ 处产生的场为 $\\mathbf{E}_{1\\to2} = (T_{zz} \\mu_1) \\hat{\\mathbf{z}}$。\n因此，位点 $2$ 处的感应偶极子的 $z$ 分量的标量方程为：\n$$\n\\mu_2 = \\alpha (E_0 + T_{zz} \\mu_1)\n$$\n考虑到对称性 $\\mu_1 = \\mu_2 = \\mu$，这简化为关于大小 $\\mu$ 的单个方程：\n$$\n\\mu = \\alpha (E_0 + T_{zz} \\mu)\n$$\n求解 $\\mu$：\n$$\n\\mu - \\alpha T_{zz} \\mu = \\alpha E_0\n$$\n$$\n\\mu(1 - \\alpha T_{zz}) = \\alpha E_0\n$$\n$$\n\\mu = \\frac{\\alpha E_0}{1 - \\alpha T_{zz}}\n$$\n通过代入 $T_{zz}$ 的适当形式，这个通用表达式可用于无阻尼和 Thole 阻尼模型。\n\n情况1：无阻尼点偶极子。\n相互作用张量分量为 $T_{zz}^{\\text{undamped}} = 2/r^3$。感应偶极矩的大小为：\n$$\n\\mu_{\\text{undamped}} = \\frac{\\alpha E_0}{1 - \\alpha (2/r^3)} = \\frac{\\alpha E_0}{1 - 2\\alpha/r^3}\n$$\n\n情况2：Thole 阻尼偶极子。\n相互作用被屏蔽，张量分量为 $T_{zz}^{\\text{damp}} = f_3(u) (2/r^3)$。感应偶极矩的大小为：\n$$\n\\mu_{\\text{Thole}} = \\frac{\\alpha E_0}{1 - \\alpha f_3(u) (2/r^3)} = \\frac{\\alpha E_0}{1 - (2\\alpha/r^3)f_3(u)}\n$$\nThole 屏蔽函数 $f_3(u)$ 由下式给出：\n$$\nf_3(u) = 1 - \\exp(-a u^3) \\sum_{n=0}^{2} \\frac{(a u^3)^n}{n!}\n$$\n其中 $u = r/\\alpha^{1/3}$。\n\n感应偶极矩大小的分数减少量定义为：\n$$\n\\mathcal{R} = 1 - \\frac{|\\mu|_{\\text{Thole}}}{|\\mu|_{\\text{undamped}}}\n$$\n由于 $E_0 > 0$ 且分母 $(1-\\alpha T_{zz})$ 为正（避免极化灾变），$\\mu$ 为正，因此 $|\\mu|=\\mu$。\n$$\n\\mathcal{R} = 1 - \\frac{\\mu_{\\text{Thole}}}{\\mu_{\\text{undamped}}} = 1 - \\frac{\\frac{\\alpha E_0}{1 - (2\\alpha/r^3)f_3(u)}}{\\frac{\\alpha E_0}{1 - 2\\alpha/r^3}} = 1 - \\frac{1 - 2\\alpha/r^3}{1 - (2\\alpha/r^3)f_3(u)}\n$$\n现在，我们代入给定的参数：$r = 3.000\\,a_0$，$\\alpha = 10.00\\,a_0^3$，以及 $a = 0.390$。\n\n首先，我们计算 Thole 函数的自变量。无量纲距离的立方是：\n$$\nu^3 = \\left(\\frac{r}{\\alpha^{1/3}}\\right)^3 = \\frac{r^3}{\\alpha} = \\frac{(3.000)^3}{10.00} = \\frac{27.00}{10.00} = 2.700\n$$\n屏蔽函数中的指数参数是 $X = a u^3$：\n$$\nX = a u^3 = 0.390 \\times 2.700 = 1.053\n$$\n接下来，我们计算 Thole 函数 $f_3(u)$：\n$$\nf_3(u) = 1 - \\exp(-X) \\left(\\frac{X^0}{0!} + \\frac{X^1}{1!} + \\frac{X^2}{2!}\\right) = 1 - \\exp(-X) \\left(1 + X + \\frac{X^2}{2}\\right)\n$$\n代入 $X=1.053$：\n$$\n1 + X + \\frac{X^2}{2} = 1 + 1.053 + \\frac{(1.053)^2}{2} = 1 + 1.053 + \\frac{1.108809}{2} = 1 + 1.053 + 0.5544045 = 2.6074045\n$$\n$$\n\\exp(-1.053) \\approx 0.34889006\n$$\n$$\nf_3(u) \\approx 1 - (0.34889006) \\times (2.6074045) \\approx 1 - 0.90977614 = 0.09022386\n$$\n现在我们计算 $2\\alpha/r^3$ 这一项：\n$$\n\\frac{2\\alpha}{r^3} = \\frac{2 \\times 10.00}{(3.000)^3} = \\frac{20.00}{27.00} = \\frac{20}{27}\n$$\n最后，我们计算 $\\mathcal{R}$：\n$$\n\\mathcal{R} = 1 - \\frac{1 - 20/27}{1 - (20/27) \\times f_3(u)} = 1 - \\frac{7/27}{1 - (20/27) \\times 0.09022386}\n$$\n$$\n\\mathcal{R} \\approx 1 - \\frac{0.25925926}{1 - 0.74074074 \\times 0.09022386} \\approx 1 - \\frac{0.25925926}{1 - 0.06683249}\n$$\n$$\n\\mathcal{R} \\approx 1 - \\frac{0.25925926}{0.93316751} \\approx 1 - 0.27782149\n$$\n$$\n\\mathcal{R} \\approx 0.72217851\n$$\n四舍五入到四位有效数字，分数减少量为 $0.7222$。", "answer": "$$\\boxed{0.7222}$$", "id": "2795524"}, {"introduction": "在包含大量可极化位点的实际分子模拟中，求解诱导偶极子涉及一个大型线性方程组 $ \\mathbf{A}\\boldsymbol{\\mu} = \\mathbf{b} $ 的求解。直接求逆在计算上是不可行的，因此迭代方法成为标准解决方案。这个练习将指导你实现共轭梯度（CG）算法——一种在分子模拟中广泛使用的迭代求解器——来求解一个三位点系统的诱导偶极子，并验证极化能 $ U_{\\text{pol}} $ 在迭代过程中的变分性质 [@problem_id:2795523]。", "problem": "考虑一个具有三个位点的经典可极化点偶极子模型，使用简化的无量纲单位。每个位点具有各向同性的极化率，并带有一个感应偶极矩，该偶极矩对外场和其他位点产生的偶极场均有响应。总极化能是感应偶极子的二次泛函，并在自洽时达到最小值。\n\n从以下基本原理出发：\n- 在位点 $j$（$j \\neq i$）的偶极子 $\\boldsymbol{\\mu}_j$ 在位点 $i$ 处产生的感应场，由偶极场张量作用于 $\\boldsymbol{\\mu}_j$ 给出，其中偶极-偶极相互作用张量为\n$$\n\\mathbf{T}(\\mathbf{r}) \\;=\\; \\frac{3\\,\\hat{\\mathbf{r}}\\hat{\\mathbf{r}}^{\\mathsf{T}} - \\mathbf{I}}{r^3}\n\\quad\\text{with}\\quad\n\\mathbf{r} \\;=\\; \\mathbf{r}_i - \\mathbf{r}_j,\\;\\; r \\;=\\; \\|\\mathbf{r}\\|,\\;\\; \\hat{\\mathbf{r}} \\;=\\; \\mathbf{r}/r,\n$$\n其中 $\\mathbf{I}$ 是 $3\\times 3$ 单位矩阵。\n- 对于各向同性极化率 $\\alpha_i$，二次极化能泛函（不计一个与感应偶极子无关的加性常数）为\n$$\nU_{\\text{pol}}(\\boldsymbol{\\mu}) \\;=\\; \\frac{1}{2}\\,\\boldsymbol{\\mu}^{\\mathsf{T}} \\mathbf{A}\\,\\boldsymbol{\\mu} \\;-\\; \\boldsymbol{\\mu}^{\\mathsf{T}}\\mathbf{b},\n$$\n其中 $\\boldsymbol{\\mu}$ 是堆叠所有位点偶极子的 $3N$ 维向量，$\\mathbf{b}$ 堆叠了所有位点的外场，对称块状矩阵为\n$$\n\\mathbf{A} \\;=\\; \\operatorname{diag}\\!\\left(\\alpha_1^{-1}\\mathbf{I},\\alpha_2^{-1}\\mathbf{I},\\alpha_3^{-1}\\mathbf{I}\\right) \\;-\\; \\mathbf{T},\n$$\n其中 $\\mathbf{T}$ 包含非对角 $3\\times 3$ 块 $\\mathbf{T}_{ij}=\\mathbf{T}(\\mathbf{r}_i-\\mathbf{r}_j)$（$i\\neq j$）以及零对角块。平稳性条件 $\\nabla U_{\\text{pol}}= \\mathbf{0}$ 导出一个线性系统\n$$\n\\mathbf{A}\\,\\boldsymbol{\\mu} \\;=\\; \\mathbf{b}。\n$$\n\n任务：\n1. 实现共轭梯度（CG）方法，从零向量 $\\boldsymbol{\\mu}^{(0)}=\\mathbf{0}$ 开始，求解对称正定线性系统 $\\mathbf{A}\\,\\boldsymbol{\\mu}=\\mathbf{b}$ 以获得感应偶极子。\n2. 在每次 CG 迭代 $k$ 之后，计算极化能 $U_{\\text{pol}}(\\boldsymbol{\\mu}^{(k)})$。验证序列 $U_{\\text{pol}}(\\boldsymbol{\\mu}^{(0)}), U_{\\text{pol}}(\\boldsymbol{\\mu}^{(1)}), \\dots$ 的非增变分性质。通过设置容差来处理数值舍入误差：当满足 $U_{\\text{pol}}(\\boldsymbol{\\mu}^{(k+1)}) \\le U_{\\text{pol}}(\\boldsymbol{\\mu}^{(k)}) + \\varepsilon_k$ 且 $\\varepsilon_k = 10^{-12}\\,\\max\\{1, |U_{\\text{pol}}(\\boldsymbol{\\mu}^{(k)})|\\}$ 时，接受结果。\n3. 使用以下三位点测试套件。所有量均为无量纲的简化单位。每个测试用例都指定了各位点的位置 $\\mathbf{r}_i$、极化率 $\\alpha_i$ 和外场 $\\mathbf{E}_i^{(0)}$，您应相应地构建 $\\mathbf{A}$ 和 $\\mathbf{b}$，其中 $\\mathbf{b}$ 是堆叠的外场。\n\n测试套件：\n- 用例 A（共线，中等耦合）：\n  - 位置：$\\mathbf{r}_1=(0,0,0)$, $\\mathbf{r}_2=(0,0,2.5)$, $\\mathbf{r}_3=(0,0,5.0)$。\n  - 极化率：$\\alpha_1=0.20$, $\\alpha_2=0.25$, $\\alpha_3=0.22$。\n  - 外场：$\\mathbf{E}_1^{(0)}=(0,0,0.5)$, $\\mathbf{E}_2^{(0)}=(0,0,0.5)$, $\\mathbf{E}_3^{(0)}=(0,0,0.5)$。\n- 用例 B（平面三角形，非均匀驱动）：\n  - 位置：$\\mathbf{r}_1=(0,0,0)$, $\\mathbfr_2=(2.0,0,0)$, $\\mathbfr_3=(0,2.0,0)$。\n  - 极化率：$\\alpha_1=0.15$, $\\alpha_2=0.18$, $\\alpha_3=0.16$。\n  - 外场：$\\mathbf{E}_1^{(0)}=(0.1,0,0.2)$, $\\mathbf{E}_2^{(0)}=(0,0.2,0)$, $\\mathbf{E}_3^{(0)}=(0.1,0.1,0.1)$。\n- 用例 C（共线，近零驱动；边缘情况）：\n  - 位置：$\\mathbf{r}_1=(0,0,0)$, $\\mathbf{r}_2=(0,0,1.5)$, $\\mathbf{r}_3=(0,0,3.0)$。\n  - 极化率：$\\alpha_1=0.40$, $\\alpha_2=0.35$, $\\alpha_3=0.38$。\n  - 外场：$\\mathbf{E}_1^{(0)}=(0,0,0)$, $\\mathbf{E}_2^{(0)}=(0,0,0)$, $\\mathbf{E}_3^{(0)}=(0,0,0)$。\n\n算法和数值要求：\n- 使用上述公式为每个用例组装 $9\\times 9$ 矩阵 $\\mathbf{A}$ 和 $9\\times 1$ 向量 $\\mathbf{b}$。\n- 实现具有标准三项递推的共轭梯度（CG）方法，从 $\\boldsymbol{\\mu}^{(0)}=\\mathbf{0}$ 开始，当相对残差范数 $\\|\\mathbf{r}^{(k)}\\|_2/\\|\\mathbf{b}\\|_2 \\le 10^{-12}$ 或最多 1000 次迭代后停止。如果 $\\|\\mathbf{b}\\|_2=0$，则立即停止。\n- 在每次迭代中，计算 $U_{\\text{pol}}(\\boldsymbol{\\mu}^{(k)})=\\frac{1}{2}(\\boldsymbol{\\mu}^{(k)})^{\\mathsf{T}}\\mathbf{A}\\,\\boldsymbol{\\mu}^{(k)}-(\\boldsymbol{\\mu}^{(k)})^{\\mathsf{T}}\\mathbf{b}$。\n\n输出规范：\n- 对每个用例，报告两个量：\n  1. 一个布尔值，表示在给定容差范围内，$U_{\\text{pol}}$ 在每次迭代中是否非递增。\n  2. 最终的最小化极化能 $U_{\\text{pol}}(\\boldsymbol{\\mu}^{(*)})$，以浮点数形式表示。\n- 您的程序应生成单行输出，其中包含按顺序排列的结果，格式为方括号内的逗号分隔列表\n$$\n[\\text{flag}_A,\\;U_A,\\;\\text{flag}_B,\\;U_B,\\;\\text{flag}_C,\\;U_C]。\n$$\n不需要单位，因为所有输入都是简化的无量纲单位。未使用角度。", "solution": "所提出的问题是计算物理学领域中一个有效且适定的练习，特别是在可极化力场范畴内。它要求对一个相互作用的感应偶极子系统，通过能量最小化原理推导出的线性系统进行数值求解。该问题具有科学依据，内容自洽，并且为完整求解提供了所有数据和参数。我们将着手解决它。\n\n核心任务是确定一个三位点系统的感应偶极矩集合 $\\boldsymbol{\\mu}$，使得极化能 $U_{\\text{pol}}$ 最小化。向量 $\\boldsymbol{\\mu}$ 是一个 9 维向量，由三个 3 维偶极子向量堆叠而成，即 $\\boldsymbol{\\mu} = (\\boldsymbol{\\mu}_1^{\\mathsf{T}}, \\boldsymbol{\\mu}_2^{\\mathsf{T}}, \\boldsymbol{\\mu}_3^{\\mathsf{T}})^{\\mathsf{T}}$。能量泛函如下：\n$$\nU_{\\text{pol}}(\\boldsymbol{\\mu}) = \\frac{1}{2}\\,\\boldsymbol{\\mu}^{\\mathsf{T}} \\mathbf{A}\\,\\boldsymbol{\\mu} - \\boldsymbol{\\mu}^{\\mathsf{T}}\\mathbf{b}\n$$\n当此二次型的梯度相对于 $\\boldsymbol{\\mu}$ 为零，即 $\\nabla_{\\boldsymbol{\\mu}}U_{\\text{pol}} = \\mathbf{A}\\boldsymbol{\\mu} - \\mathbf{b} = \\mathbf{0}$ 时，该二次型达到最小值。这导出了对称正定线性系统 $\\mathbf{A}\\boldsymbol{\\mu} = \\mathbf{b}$，我们将使用共轭梯度（CG）方法来求解它。\n\n步骤 1：构建系统矩阵 $\\mathbf{A}$ 和向量 $\\mathbf{b}$\n\n对于一个 $N=3$ 的位点系统，矩阵 $\\mathbf{A}$ 是一个 $9 \\times 9$ 的块状矩阵，向量 $\\mathbf{b}$ 是一个 $9 \\times 1$ 的向量。\n\n向量 $\\mathbf{b}$ 表示在每个位点处堆叠起来的外部电场：\n$$\n\\mathbf{b} = \\begin{pmatrix} \\mathbf{E}_1^{(0)} \\\\ \\mathbf{E}_2^{(0)} \\\\ \\mathbf{E}_3^{(0)} \\end{pmatrix}\n$$\n其中每个 $\\mathbf{E}_i^{(0)}$ 是测试数据中提供的 $3 \\times 1$ 向量。\n\n矩阵 $\\mathbf{A}$ 定义为：\n$$\n\\mathbf{A} = \\operatorname{diag}\\!\\left(\\alpha_1^{-1}\\mathbf{I},\\alpha_2^{-1}\\mathbf{I},\\alpha_3^{-1}\\mathbf{I}\\right) - \\mathbf{T}\n$$\n这个结构可以展开为 $3 \\times 3$ 的块：\n$$\n\\mathbf{A} = \\begin{pmatrix}\n\\alpha_1^{-1}\\mathbf{I} & -\\mathbf{T}_{12} & -\\mathbf{T}_{13} \\\\\n-\\mathbf{T}_{21} & \\alpha_2^{-1}\\mathbf{I} & -\\mathbf{T}_{23} \\\\\n-\\mathbf{T}_{31} & -\\mathbf{T}_{32} & \\alpha_3^{-1}\\mathbf{I}\n\\end{pmatrix}\n$$\n对角块是 $3 \\times 3$ 单位矩阵 $\\mathbf{I}$ 的倍数，标量因子是各向同性极化率 $\\alpha_i$ 的倒数。对于 $i \\neq j$ 的非对角块 $\\mathbf{A}_{ij}$ 由 $-\\mathbf{T}_{ij}$ 给出，其中 $\\mathbf{T}_{ij} = \\mathbf{T}(\\mathbf{r}_i - \\mathbf{r}_j)$ 是偶极-偶极相互作用张量。注意 $\\mathbf{T}_{ij} = \\mathbf{T}_{ji}$，这使得 $\\mathbf{A}$ 是对称的。张量 $\\mathbf{T}(\\mathbf{r})$ 计算如下：\n$$\n\\mathbf{T}(\\mathbf{r}) = \\frac{3\\,\\mathbf{r}\\mathbf{r}^{\\mathsf{T}} - \\|\\mathbf{r}\\|^2\\mathbf{I}}{\\|\\mathbf{r}\\|^5}\n$$\n其中 $\\mathbf{r} = \\mathbf{r}_i - \\mathbf{r}_j$ 是位点 $i$ 和 $j$ 之间的位移向量，$\\mathbf{r}\\mathbf{r}^{\\mathsf{T}}$ 表示外积。该公式被用于计算每对不同位点 $(i, j)$，以填充 $\\mathbf{A}$ 的非对角块。\n\n步骤 2：通过共轭梯度（CG）方法求解\n\nCG 算法是一种迭代方法，非常适合求解大型、稀疏、对称正定（SPD）的线性系统。问题陈述断言 $\\mathbf{A}$ 是 SPD 的，在此条件下，CG 保证收敛到唯一解。\n\n算法以初始猜测值 $\\boldsymbol{\\mu}^{(0)} = \\mathbf{0}$ 开始，按以下步骤进行：\n\n1.  初始化：\n    -   解：$\\boldsymbol{\\mu}^{(0)} = \\mathbf{0}$\n    -   残差：$\\mathbf{r}^{(0)} = \\mathbf{b} - \\mathbf{A}\\boldsymbol{\\mu}^{(0)} = \\mathbf{b}$\n    -   搜索方向：$\\mathbf{p}^{(0)} = \\mathbf{r}^{(0)}$\n    -   残差范数的平方：$\\delta_0 = (\\mathbf{r}^{(0)})^{\\mathsf{T}}\\mathbf{r}^{(0)}$\n\n2.  对 $k = 0, 1, 2, \\ldots$ 进行迭代：\n    a. 计算矩阵-向量乘积：$\\mathbf{q}^{(k)} = \\mathbf{A}\\mathbf{p}^{(k)}$\n    b. 计算步长：$\\gamma_k = \\frac{\\delta_k}{(\\mathbf{p}^{(k)})^{\\mathsf{T}}\\mathbf{q}^{(k)}}$\n    c. 更新解：$\\boldsymbol{\\mu}^{(k+1)} = \\boldsymbol{\\mu}^{(k)} + \\gamma_k \\mathbf{p}^{(k)}$\n    d. 更新残差：$\\mathbf{r}^{(k+1)} = \\mathbf{r}^{(k)} - \\gamma_k \\mathbf{q}^{(k)}$\n    e. 计算新的残差范数平方：$\\delta_{k+1} = (\\mathbf{r}^{(k+1)})^{\\mathsf{T}}\\mathbf{r}^{(k+1)}$\n    f. 检查收敛性：如果 $\\sqrt{\\delta_{k+1}} / \\|\\mathbf{b}\\|_2 \\le 10^{-12}$ 或 $k$ 达到 999，则停止。最大迭代次数为 1000。\n    g. 更新搜索方向：$\\mathbf{p}^{(k+1)} = \\mathbf{r}^{(k+1)} + \\frac{\\delta_{k+1}}{\\delta_k} \\mathbf{p}^{(k)}$\n    h. 更新用于下一次迭代的残差范数平方：$\\delta_k \\leftarrow \\delta_{k+1}$\n\n当 $\\mathbf{b} = \\mathbf{0}$ 时（如测试用例 C 所示），会出现一个特殊情况。在这种情况下，初始残差 $\\mathbf{r}^{(0)}$ 为零。解显然是 $\\boldsymbol{\\mu}=\\mathbf{0}$，算法立即终止。极化能为 0。\n\n步骤 3：能量计算和变分性质验证\n\n在每次迭代 $k$（包括初始状态 $k=0$）中，我们计算极化能：\n$$\nU_{\\text{pol}}(\\boldsymbol{\\mu}^{(k)}) = \\frac{1}{2}(\\boldsymbol{\\mu}^{(k)})^{\\mathsf{T}}(\\mathbf{A}\\,\\boldsymbol{\\mu}^{(k)}) - (\\boldsymbol{\\mu}^{(k)})^{\\mathsf{T}}\\mathbf{b}\n$$\n当应用 CG 方法最小化二次泛函时，一个基本性质是目标函数值在每一步都必须非递增。我们通过检查以下条件来验证此性质：\n$$\nU_{\\text{pol}}(\\boldsymbol{\\mu}^{(k+1)}) \\le U_{\\text{pol}}(\\boldsymbol{\\mu}^{(k)}) + \\varepsilon_k\n$$\n对于所有 $k \\ge 0$，其中容差 $\\varepsilon_k = 10^{-12}\\,\\max\\{1, |U_{\\text{pol}}(\\boldsymbol{\\mu}^{(k)})|\\}$ 用于处理有限精度算术。一个布尔标志会跟踪在每个测试用例的整个迭代过程中此条件是否成立。\n\n最终报告的能量是在最后一次计算的迭代中得到的 $U_{\\text{pol}}$ 值，这是对真实最小能量 $U_{\\text{pol}}(\\boldsymbol{\\mu}^{(*)})$ 的最佳近似。\n\n现在将根据这些原则进行实现。", "answer": "[True,-0.0886616053358999,True,-0.0093863484210636,True,0.0]", "id": "2795523"}]}