{"hands_on_practices": [{"introduction": "真实的分子并非简单的各向同性球体。它们对电场的响应是各向异性的，需要用一个极化率张量来描述。本次实践提供了一个基础练习，旨在推导一个更真实的各向异性情况下的诱导能，这是超越教科书中各向同性模型的关键一步。通过这个练习，你将巩固对静电诱导作用以及张量代数在分子物理中应用的理解。[@problem_id:2781319]", "problem": "一个电荷为 $q$ 的离子被固定在一个电中性、刚性、各向异性的分子质心 $R$ 远处。该分子的电子极化率张量在其主轴坐标系中是对角化的，$\\boldsymbol{\\alpha} = \\mathrm{diag}(\\alpha_{x}, \\alpha_{y}, \\alpha_{z})$。分子相对于离子的取向是固定的，从分子指向离子的单位矢量 $\\hat{\\mathbf{R}}$ 相对于分子主轴的方向余弦为 $(\\ell, m, n)$，其中 $\\ell^{2} + m^{2} + n^{2} = 1$。假设相互作用发生在真空中，真空介电常数为 $\\varepsilon_{0}$，并忽略所有永久多极矩和高阶响应项。\n\n从以下基本原理出发：\n- 真空中点电荷电场的库仑定律。\n- 诱导偶极矩的线性响应定义 $\\boldsymbol{\\mu}_{\\mathrm{ind}} = \\boldsymbol{\\alpha} \\cdot \\mathbf{E}$。\n- 相互作用能的定义，即把分子从零场极化到最终场所需做的可逆功。\n\n在指定的取向和距离下，推导离子和分子之间相互作用能中诱导能贡献的闭合形式表达式。将您的最终结果以焦耳为单位，表示为 $q$、$R$、$\\varepsilon_{0}$、$\\alpha_{x}$、$\\alpha_{y}$、$\\alpha_{z}$ 和 $(\\ell, m, n)$ 的函数。无需进行数值计算。最终答案必须是单一的解析表达式。", "solution": "所述问题具有科学依据、提法恰当，并包含获得唯一解所需的全部信息。我们将依据经典静电学原理进行形式推导。\n\n设电中性分子的质心为笛卡尔坐标系的原点。该坐标系的坐标轴，记为 $(x, y, z)$，选为分子的主轴。在此坐标系中，极化率张量 $\\boldsymbol{\\alpha}$ 是一个对角矩阵：\n$$\n\\boldsymbol{\\alpha} = \\begin{pmatrix} \\alpha_{x} & 0 & 0 \\\\ 0 & \\alpha_{y} & 0 \\\\ 0 & 0 & \\alpha_{z} \\end{pmatrix}\n$$\n电荷为 $q$ 的离子位于相对于原点的位置矢量 $\\mathbf{R}$ 处，该矢量的模为 $|\\mathbf{R}| = R$。离子相对于分子的取向由单位矢量 $\\hat{\\mathbf{R}} = \\mathbf{R}/R$ 给出，其在分子坐标系中的方向余弦为 $(\\ell, m, n)$。因此，其分量形式为：\n$$\n\\hat{\\mathbf{R}} = \\ell \\hat{\\mathbf{x}} + m \\hat{\\mathbf{y}} + n \\hat{\\mathbf{z}}\n$$\n\n推导过程遵循问题陈述中提供的基本原理，分三步进行。\n\n首先，我们确定点电荷 $q$ 在分子位置（原点）处产生的电场 $\\mathbf{E}$。根据库仑定律，位于位置 $\\mathbf{R}$ 处的电荷 $q$ 在原点产生的电场为：\n$$\n\\mathbf{E} = \\frac{1}{4\\pi\\varepsilon_{0}} \\frac{q}{|\\mathbf{0} - \\mathbf{R}|^3} (\\mathbf{0} - \\mathbf{R}) = -\\frac{q}{4\\pi\\varepsilon_{0}} \\frac{\\mathbf{R}}{R^3} = -\\frac{q}{4\\pi\\varepsilon_{0}R^2} \\hat{\\mathbf{R}}\n$$\n代入 $\\hat{\\mathbf{R}}$ 在分子坐标系中的分量，我们得到：\n$$\n\\mathbf{E} = -\\frac{q}{4\\pi\\varepsilon_{0}R^2} (\\ell \\hat{\\mathbf{x}} + m \\hat{\\mathbf{y}} + n \\hat{\\mathbf{z}})\n$$\n\n其次，我们确定该电场在分子中诱导出的偶极矩 $\\boldsymbol{\\mu}_{\\mathrm{ind}}$。使用线性响应定义 $\\boldsymbol{\\mu}_{\\mathrm{ind}} = \\boldsymbol{\\alpha} \\cdot \\mathbf{E}$：\n$$\n\\boldsymbol{\\mu}_{\\mathrm{ind}} = \\begin{pmatrix} \\alpha_{x} & 0 & 0 \\\\ 0 & \\alpha_{y} & 0 \\\\ 0 & 0 & \\alpha_{z} \\end{pmatrix} \\left( -\\frac{q}{4\\pi\\varepsilon_{0}R^2} \\begin{pmatrix} \\ell \\\\ m \\\\ n \\end{pmatrix} \\right) = -\\frac{q}{4\\pi\\varepsilon_{0}R^2} \\begin{pmatrix} \\alpha_{x}\\ell \\\\ \\alpha_{y}m \\\\ \\alpha_{z}n \\end{pmatrix}\n$$\n该矢量表示在分子坐标系中的诱导偶极矩。\n\n第三，我们推导相互作用能中的诱导能贡献 $U_{ind}$。问题指定使用“极化分子所需的可逆功”。该量对应于极化时储存在分子中的能量，我们称之为 $U_{pol}$。为计算此能量，我们设想通过一个充电参数 $\\lambda \\in [0,1]$ 将外场从 $0$ 逐渐增加到最终值 $\\mathbf{E}$，使得中间场为 $\\mathbf{E}' = \\lambda\\mathbf{E}$。相应的诱导偶极为 $\\boldsymbol{\\mu}'_{ind} = \\boldsymbol{\\alpha} \\cdot (\\lambda\\mathbf{E}) = \\lambda\\boldsymbol{\\mu}_{ind}$。对分子做的微元功为 $dW_{pol} = \\mathbf{E}' \\cdot d\\boldsymbol{\\mu}'_{ind}$。由于 $d\\boldsymbol{\\mu}'_{ind} = (\\boldsymbol{\\alpha} \\cdot \\mathbf{E}) d\\lambda$，我们有：\n$$\nU_{pol} = \\int_{0}^{1} (\\lambda\\mathbf{E}) \\cdot (\\boldsymbol{\\alpha} \\cdot \\mathbf{E}) d\\lambda = (\\mathbf{E} \\cdot \\boldsymbol{\\alpha} \\cdot \\mathbf{E}) \\int_{0}^{1} \\lambda d\\lambda = \\frac{1}{2} \\mathbf{E} \\cdot (\\boldsymbol{\\alpha} \\cdot \\mathbf{E}) = \\frac{1}{2} \\mathbf{E} \\cdot \\boldsymbol{\\mu}_{ind}\n$$\n然而，总诱导能 $U_{ind}$ 还必须考虑该诱导偶极在外场中的势能，其表达式为 $U_{int} = -\\boldsymbol{\\mu}_{ind} \\cdot \\mathbf{E}$。总诱导能是储存在分子中的能量与其和场源的相互作用能之和：\n$$\nU_{ind} = U_{pol} + U_{int} = \\frac{1}{2} \\boldsymbol{\\mu}_{ind} \\cdot \\mathbf{E} - \\boldsymbol{\\mu}_{ind} \\cdot \\mathbf{E} = -\\frac{1}{2} \\boldsymbol{\\mu}_{ind} \\cdot \\mathbf{E}\n$$\n这是诱导能的标准表达式，它总是负值，对应于吸引相互作用。\n\n现在我们将 $\\mathbf{E}$ 和 $\\boldsymbol{\\mu}_{\\mathrm{ind}}$ 的表达式代入 $U_{ind}$ 的公式中：\n$$\nU_{ind} = -\\frac{1}{2} \\left( -\\frac{q}{4\\pi\\varepsilon_{0}R^2} (\\ell \\hat{\\mathbf{x}} + m \\hat{\\mathbf{y}} + n \\hat{\\mathbf{z}}) \\right) \\cdot \\left( -\\frac{q}{4\\pi\\varepsilon_{0}R^2} (\\alpha_{x}\\ell \\hat{\\mathbf{x}} + \\alpha_{y}m \\hat{\\mathbf{y}} + \\alpha_{z}n \\hat{\\mathbf{z}}) \\right)\n$$\n进行标量积运算并简化即可得到诱导能的最终结果：\n$$\nU_{ind} = -\\frac{q^2}{32\\pi^2\\varepsilon_{0}^2 R^4} (\\alpha_{x}\\ell^2 + \\alpha_{y}m^2 + \\alpha_{z}n^2)\n$$\n这就是以焦耳为单位的诱导能，表示为给定参数的函数。", "answer": "$$\n\\boxed{-\\frac{q^{2}}{32\\pi^{2}\\varepsilon_{0}^{2}R^{4}}(\\alpha_{x}\\ell^{2} + \\alpha_{y}m^{2} + \\alpha_{z}n^{2})}\n$$", "id": "2781319"}, {"introduction": "在掌握了诱导能之后，我们将注意力转向静电能。在长程范围内，无重叠的电荷分布之间的静电相互作用可以通过多极展开进行系统性的描述。本次实践聚焦于应用这一强大的理论工具，计算一个特定场景下的主导相互作用项，旨在训练你识别主要作用项以及处理球谐多极矩的能力。[@problem_id:2899200]", "problem": "一个刚性的轴对称单体 A 位于原点，呈电中性（其净电荷为零）。在其与对称轴对齐的体固定坐标系中，其直到八极矩的非零球多极矩强度由集合 $\\{M_{1}, M_{2}, M_{3}\\}$ 指定，其中在原子单位制下，$M_{l}$ 的单位为 $e a_{0}^{l}$，其值为 $M_{1} = 2.00$，$M_{2} = 5.00$ 和 $M_{3} = -8.00$。该单体的对称轴与从单体 A 指向第二个单体 B 的分子间向量 $\\mathbf{R}$ 形成一个夹角 $\\theta = 60.0$ 度。第二个单体 B 是一个无结构的带电荷 $+e$ 的点阳离子，位于沿 $\\mathbf{R}$ 方向，与 A 的中心距为 $R = 15.0\\,a_{0}$ 处。忽略所有感应、交换和色散效应；只考虑 A 的永久静电与 B 的电荷之间的相互作用。\n\n使用局域电荷分布的静电势的长程多极展开，并根据相互作用能是 B 的电荷乘以 A 在 B 位置产生的电势的定义，确定在给定取向和分离距离下，A 和 B 之间的主导（在 $1/R$ 中渐近占优）静电相互作用能。推导过程使用原子单位制（因此 $4\\pi\\epsilon_{0} = 1$ 且 $e = 1$），然后使用 $1$ Hartree $= 2625.50\\,\\mathrm{kJ\\,mol^{-1}}$ 将最终结果转换为 $\\mathrm{kJ\\,mol^{-1}}$。以 $\\mathrm{kJ\\,mol^{-1}}$ 为单位表示最终答案，并四舍五入到四位有效数字。角度 $\\theta$ 以度为单位指定。", "solution": "局域电荷分布外部的静电势可以通过求解拉普拉斯方程并用正则固体谐波展开得到。对于轴对称源，其电势 $V(\\mathbf{R}) \\equiv V(R,\\theta)$ 可进行勒让德展开，\n$$\nV(R,\\theta) \\;=\\; \\sum_{l=0}^{\\infty} \\frac{A_{l}}{R^{l+1}}\\,P_{l}(\\cos\\theta),\n$$\n其中 $P_{l}$ 是勒让德多项式，$A_{l}$ 是由源的多极矩内容决定的系数。当采用与对称轴对齐的球多极矩强度时，系数在国际单位制中可写为 $A_{l} = \\frac{1}{4\\pi\\epsilon_{0}}\\,M_{l}$。在原子单位制中，$4\\pi\\epsilon_{0}=1$，因此这简化为 $A_{l} = M_{l}$。单体 A 是电中性的，所以 $M_{0}=0$，而指定的直到八极矩的非零多极矩是 $M_{1}$、$M_{2}$ 和 $M_{3}$。\n\n一个置于源的 $(R,\\theta)$ 位置的点电荷 $q_{B}$ 的静电相互作用能是\n$$\nU(R,\\theta) \\;=\\; q_{B}\\,V(R,\\theta) \\;=\\; q_{B}\\sum_{l=0}^{\\infty} \\frac{M_{l}}{R^{l+1}}\\,P_{l}(\\cos\\theta),\n$$\n在原子单位制下。在大 $R$ 处，主导（渐近占优）的贡献由使得 $M_{l}\\neq 0$ 的最小 $l$ 给出。单体 A 是电中性的，所以 $M_{0}=0$。我们已知 $M_{1}\\neq 0$，因此主导项是 $l=1$（偶极）项。因此，\n$$\nU_{\\text{lead}}(R,\\theta) \\;=\\; q_{B}\\,\\frac{M_{1}}{R^{2}}\\,P_{1}(\\cos\\theta).\n$$\n使用 $q_{B}=+1$（原子单位制）和 $P_{1}(x)=x$，我们得到\n$$\nU_{\\text{lead}}(R,\\theta) \\;=\\; \\frac{M_{1}}{R^{2}}\\,\\cos\\theta.\n$$\n\n现在代入给定数据。角度为 $\\theta=60.0$ 度，所以\n$$\n\\cos\\theta \\;=\\; \\cos(60.0^\\circ) \\;=\\; \\frac{1}{2}.\n$$\n分离距离为 $R=15.0\\,a_{0}$，因此 $R^{2} = 225$。又 $M_{1}=2.00$，我们有\n$$\nU_{\\text{lead}} \\;=\\; \\frac{2.00}{225}\\,\\frac{1}{2} \\;=\\; \\frac{1.00}{225} \\;=\\; 0.004444\\overline{4}\\ \\text{Hartree}.\n$$\n\n使用 $1$ Hartree $= 2625.50\\,\\mathrm{kJ\\,mol^{-1}}$ 将此能量转换为 $\\mathrm{kJ\\,mol^{-1}}$：\n$$\nU_{\\text{lead}} \\;=\\; 0.004444\\overline{4}\\times 2625.50\\ \\mathrm{kJ\\,mol^{-1}} \\;=\\; \\frac{2625.50}{225}\\ \\mathrm{kJ\\,mol^{-1}} \\;=\\; 11.668\\overline{8}\\ \\mathrm{kJ\\,mol^{-1}}.\n$$\n四舍五入到四位有效数字得到\n$$\nU_{\\text{lead}} \\;=\\; 11.67\\ \\mathrm{kJ\\,mol^{-1}}.\n$$\n\n我们注意到，更高阶的多极矩以 $l=2$ 和 $l=3$ 项的形式贡献，它们分别按 $R^{-3}$ 和 $R^{-4}$ 比例缩放，因此在大 $R$ 处是次导项。因为 $\\cos(60^\\circ)\\neq 0$，偶极项没有角度上的抵消，所以 $l=1$ 项确实主导了长程相互作用。", "answer": "$$\\boxed{11.67}$$", "id": "2899200"}, {"introduction": "为了获得对分子间相互作用的完整图像，我们必须同时考虑其所有物理组分：静电、交换-排斥、诱导和色散。对称匹配微扰理论（SAPT）正是为此提供了一个严格的理论框架。这项高级实践将指导你实现一个简化的SAPT模型，让你对如何从第一性原理计算和分析总相互作用能获得宝贵的洞察力，同时也将探索密度拟合等常见计算近似方法带来的影响。[@problem_id:2781338]", "problem": "您需要为一个共线的、头尾相接的二聚体建模，并采用一种类对称匹配微扰理论 (SAPT) 的分解方法，将其分解为四个具有物理动机的组分：静电、交换-排斥、诱导和色散。您将实现两种计算这些项的距离依赖性的方法：一种是基于第一性原理和经过充分检验的公式的精确模型，另一种是近似模型，该模型通过将距离核函数投影到一个由高斯函数构成的有限辅助基组上（类似密度拟合的方法）来替换它们。您的程序必须计算在指定分离距离下，辅助基组为每个 SAPT 组分引入的绝对误差。\n\n需要使用的基本出发点和定义：\n- 永久偶极子及其相互作用的经典静电学。两个永久点偶极子在距离为 $R$ 且沿分子间轴共线排列时，其相互作用能可由库仑定律和多极展开推导得出。\n- 用于诱导作用的线性响应理论：诱导偶极子由各向同性极化率乘以局部电场给出。诱导能等于负二分之一乘以极化率再乘以产生该偶极子的电场的平方。\n- 用于各向同性单体间色散作用的 London 单振子模型，该模型给出了 $C_6$ 系数的一个闭式表达式，以静态极化率和特征激发能表示。\n- 短程交换-排斥由玻恩–迈尔指数模型描述，这是一种与重叠驱动的泡利排斥相关的、经过经验充分检验的函数形式。\n\n模型细节与符号：\n- 全部计算使用原子单位。距离 $R$ 的单位为玻尔（bohr），能量单位为哈特里（hartree）。\n- 该二聚体由单体 $\\mathrm{A}$ 和单体 $\\mathrm{B}$ 组成，其永久偶极矩大小分别为 $\\mu_{\\mathrm{A}}$ 和 $\\mu_{\\mathrm{B}}$，沿分子间轴共线且头尾相接排列。单体的各向同性偶极极化率分别为 $\\alpha_{\\mathrm{A}}$ 和 $\\alpha_{\\mathrm{B}}$。单振子特征能量（例如，有效电离能）分别为 $I_{\\mathrm{A}}$ 和 $I_{\\mathrm{B}}$。短程排斥参数为 $A_{\\mathrm{rep}}$（单位为哈特里）和 $b$（单位为 玻尔$^{-1}$）。\n- 定义以下距离核函数：\n  - 静电偶极-偶极核函数 $K_3(R) = R^{-3}$。\n  - 诱导和色散核函数 $K_6(R) = R^{-6}$。\n  - 交换-排斥核函数 $K_{\\mathrm{rep}}(R) = \\exp(-b R)$。\n- 精确的类 SAPT 组分由上述原理推导得出：\n  - 两个共线、头尾相接的永久偶极子的静电能 $E_{\\mathrm{elst}}(R)$。\n  - 由给定的 $A_{\\mathrm{rep}}$ 和 $b$ 参数构成的玻恩–迈尔指数模型描述的交换-排斥能 $E_{\\mathrm{exch}}(R)$。\n  - 由两个相互诱导的永久偶极子通过线性响应产生的诱导能 $E_{\\mathrm{ind}}(R)$。\n  - 由 London 单振子模型产生的色散能 $E_{\\mathrm{disp}}(R)$。\n- 定义一个辅助基组 $\\{\\phi_j(R)\\}_{j=1}^{K}$，其中 $\\phi_j(R) = \\exp(-\\gamma_j R^2)$，指数 $\\gamma_j$ 按等比数列生成 $\\gamma_j = \\gamma_{\\min}\\, r^{\\,j-1}$。此处，$K$ 是辅助函数的数量，$\\gamma_{\\min} > 0$ 是最小的指数，$r > 1$ 是公比参数。\n- 对于每个核函数 $K_x(R)$，其中 $x \\in \\{3,6,\\mathrm{rep}\\}$，定义其类似密度拟合的近似 $K_x^{\\mathrm{DF}}(R) = \\sum_{j=1}^{K} c_j^{(x)} \\phi_j(R)$。其中的系数 $\\mathbf{c}^{(x)}$ 是通过在拟合区间 $[R_{\\min}^{\\mathrm{fit}}, R_{\\max}^{\\mathrm{fit}}]$ 上的 $N_{\\mathrm{fit}}$ 个均匀网格点 $R_i$ 上进行最小二乘投影获得的。即，相对于系数最小化 $\\sum_{i=1}^{N_{\\mathrm{fit}}} \\left(K_x(R_i) - \\sum_{j=1}^{K} c_j^{(x)} \\phi_j(R_i)\\right)^2$。对所有网格点使用单位权重。\n- 通过在静电表达式中用 $K_3^{\\mathrm{DF}}(R)$ 替换 $K_3(R)$，在诱导和色散表达式中用 $K_6^{\\mathrm{DF}}(R)$ 替换 $K_6(R)$，以及在交换-排斥表达式中用 $K_{\\mathrm{rep}}^{\\mathrm{DF}}(R)$ 替换 $K_{\\mathrm{rep}}(R)$，来构建近似的类 SAPT 组分。\n- 对于每个测试用例，计算每个组分的绝对误差（单位为哈特里），其公式为 $\\left|E_{\\mathrm{component}}^{\\mathrm{exact}}(R) - E_{\\mathrm{component}}^{\\mathrm{DF}}(R)\\right|$。\n\n您必须：\n- 根据所述原理推导各组分公式，并实现精确能量和辅助基组近似能量的计算。\n- 使用指定的辅助基组和网格，实现核函数的最小二乘拟合。\n- 按静电、交换-排斥、诱导、色散的顺序返回各组分的误差。\n- 所有能量以哈特里表示，并将每个误差四舍五入到 $8$ 位小数。\n\n在所有测试用例中使用以下固定的单体和拟合参数：\n- 单体参数：$\\mu_{\\mathrm{A}} = 1.0000$, $\\mu_{\\mathrm{B}} = 0.8000$, $\\alpha_{\\mathrm{A}} = 10.0000$, $\\alpha_{\\mathrm{B}} = 12.0000$, $I_{\\mathrm{A}} = 0.5000$, $I_{\\mathrm{B}} = 0.6000$, $A_{\\mathrm{rep}} = 10000.0000$, $b = 1.8000$。\n- 拟合网格参数：$R_{\\min}^{\\mathrm{fit}} = 2.0000$, $R_{\\max}^{\\mathrm{fit}} = 8.0000$, $N_{\\mathrm{fit}} = 400$（均匀间隔的点，包括端点）。\n\n测试套件：\n- 用例 1：$R = 3.5000$, $K = 5$, $\\gamma_{\\min} = 0.0500$, $r = 4.0000$。\n- 用例 2：$R = 2.2000$, $K = 3$, $\\gamma_{\\min} = 0.1000$, $r = 5.0000$。\n- 用例 3：$R = 8.0000$, $K = 7$, $\\gamma_{\\min} = 0.0200$, $r = 3.0000$。\n- 用例 4：$R = 3.0000$, $K = 1$, $\\gamma_{\\min} = 0.5000$, $r = 1.0000$。\n\n最终输出格式要求：\n- 您的程序应生成单行输出，其中包含一个列表的列表，每个子列表包含每个测试用例的四个四舍五入后的误差，顺序如上所述。四个用例也按给定顺序排列。该行必须严格遵循以下格式：\n  \"[[e11,e12,e13,e14],[e21,e22,e23,e24],[e31,e32,e33,e34],[e41,e42,e43,e44]]\"\n其中 $eij$ 是以哈特里为单位、四舍五入到 $8$ 位小数的十进制浮点数，字符串中任何地方都没有空格。", "solution": "该问题要求将一个计算模型得到的分子间相互作用能与一个基于第一性原理的精确模型进行验证。总相互作用能被分解为四个组分：静电能 ($E_{\\mathrm{elst}}$)、交换-排斥能 ($E_{\\mathrm{exch}}$)、诱导能 ($E_{\\mathrm{ind}}$) 和色散能 ($E_{\\mathrm{disp}}$)。我们将首先基于所提供的物理原理，为一个共线的、头尾相接的二聚体推导这些“精确”组分的解析表达式。随后，我们将构建近似模型，该模型将这些相互作用中依赖于距离的核函数投影到一个由高斯函数构成的有限辅助基组上。此近似方法的核心是线性最小二乘拟合过程。最后，我们将计算在指定的分子间分离距离下，该近似方法为每个组分引入的绝对误差。所有计算均在原子单位下进行。\n\n首先，我们推导精确能量组分作为分子间分离距离 $R$ 的函数。该二聚体由单体 $\\mathrm{A}$ 和单体 $\\mathrm{B}$ 组成，它们的永久偶极矩分别为 $\\mu_{\\mathrm{A}}$ 和 $\\mu_{\\mathrm{B}}$，极化率分别为 $\\alpha_{\\mathrm{A}}$ 和 $\\alpha_{\\mathrm{B}}$，特征能量分别为 $I_{\\mathrm{A}}$ 和 $I_{\\mathrm{B}}$。\n\n两个点偶极子的静电相互作用能 $E_{\\mathrm{elst}}$ 由 $E = (\\vec{\\mu}_{\\mathrm{A}} \\cdot \\vec{\\mu}_{\\mathrm{B}} - 3(\\vec{\\mu}_{\\mathrm{A}} \\cdot \\hat{R})(\\vec{\\mu}_{\\mathrm{B}} \\cdot \\hat{R}))/R^3$ 给出。对于沿分子间轴 $\\hat{R}$ 的共线、头尾相接构型，我们有 $\\vec{\\mu}_{\\mathrm{A}} = \\mu_{\\mathrm{A}}\\hat{R}$ 和 $\\vec{\\mu}_{\\mathrm{B}} = \\mu_{\\mathrm{B}}\\hat{R}$。能量表达式简化为 $E_{\\mathrm{elst}}(R) = (\\mu_{\\mathrm{A}}\\mu_{\\mathrm{B}} - 3(\\mu_{\\mathrm{A}})(\\mu_{\\mathrm{B}}))/R^3 = -2\\mu_{\\mathrm{A}}\\mu_{\\mathrm{B}}R^{-3}$。这可以写成 $E_{\\mathrm{elst}}(R) = C_{\\mathrm{elst}} K_3(R)$ 的形式，其中常数前置因子为 $C_{\\mathrm{elst}} = -2\\mu_{\\mathrm{A}}\\mu_{\\mathrm{B}}$，核函数为 $K_3(R) = R^{-3}$。\n\n交换-排斥能 $E_{\\mathrm{exch}}$ 由玻恩–迈尔模型给出：$E_{\\mathrm{exch}}(R) = A_{\\mathrm{rep}}\\exp(-bR)$。这可以写成 $E_{\\mathrm{exch}}(R) = C_{\\mathrm{exch}} K_{\\mathrm{rep}}(R)$，其中 $C_{\\mathrm{exch}} = A_{\\mathrm{rep}}$，核函数为 $K_{\\mathrm{rep}}(R) = \\exp(-bR)$。参数 $A_{\\mathrm{rep}}$ 和 $b$ 已给出。\n\n诱导能 $E_{\\mathrm{ind}}$ 源于一个单体被另一个单体的电场所极化。一个点偶极子 $\\vec{\\mu}$ 在其轴线上距离 $R$ 处产生的电场为 $\\vec{F} = 2\\vec{\\mu}/R^3$。一个极化率为 $\\alpha$ 的单体在外部电场 $F$ 中的诱导能为 $-\\frac{1}{2}\\alpha F^2$。总诱导能是单体 $\\mathrm{A}$ 在 $\\mathrm{B}$ 的电场中的能量与单体 $\\mathrm{B}$ 在 $\\mathrm{A}$ 的电场中的能量之和：\n$$E_{\\mathrm{ind}}(R) = -\\frac{1}{2}\\alpha_{\\mathrm{A}} \\left(\\frac{2\\mu_{\\mathrm{B}}}{R^3}\\right)^2 - \\frac{1}{2}\\alpha_{\\mathrm{B}} \\left(\\frac{2\\mu_{\\mathrm{A}}}{R^3}\\right)^2 = -2(\\alpha_{\\mathrm{A}}\\mu_{\\mathrm{B}}^2 + \\alpha_{\\mathrm{B}}\\mu_{\\mathrm{A}}^2)R^{-6}$$\n这是 $E_{\\mathrm{ind}}(R) = C_{\\mathrm{ind}} K_6(R)$ 的形式，其中 $C_{\\mathrm{ind}} = -2(\\alpha_{\\mathrm{A}}\\mu_{\\mathrm{B}}^2 + \\alpha_{\\mathrm{B}}\\mu_{\\mathrm{A}}^2)$，核函数为 $K_6(R) = R^{-6}$。\n\n色散能 $E_{\\mathrm{disp}}$ 使用 London 单振子模型确定，该模型给出的相互作用为 $E_{\\mathrm{disp}}(R) = -C_6 R^{-6}$。$C_6$ 系数的 London 公式为：\n$$C_6 = \\frac{3}{2}\\frac{I_{\\mathrm{A}}I_{\\mathrm{B}}}{I_{\\mathrm{A}}+I_{\\mathrm{B}}}\\alpha_{\\mathrm{A}}\\alpha_{\\mathrm{B}}$$\n因此，色散能可以写成 $E_{\\mathrm{disp}}(R) = C_{\\mathrm{disp}} K_6(R)$，其中 $C_{\\mathrm{disp}} = -C_6$，核函数同样为 $K_6(R) = R^{-6}$。\n\n接下来，我们构建近似模型。对于 $x \\in \\{3, 6, \\mathrm{rep}\\}$，距离核函数 $K_x(R)$ 被近似为 $K$ 个高斯基函数 $\\phi_j(R) = \\exp(-\\gamma_j R^2)$ 的线性组合：\n$$K_x^{\\mathrm{DF}}(R) = \\sum_{j=1}^{K} c_j^{(x)} \\phi_j(R)$$\n指数按等比数列生成：$\\gamma_j = \\gamma_{\\min} r^{j-1}$。系数 $c_j^{(x)}$ 通过最小化精确核函数 $K_x(R)$ 与其近似 $K_x^{\\mathrm{DF}}(R)$ 在区间 $[R_{\\min}^{\\mathrm{fit}}, R_{\\max}^{\\mathrm{fit}}]$ 上 $N_{\\mathrm{fit}}$ 个均匀网格点 $\\{R_i\\}$ 上的残差平方和来确定。这是一个线性最小二乘问题。设 $\\mathbf{y}^{(x)}$ 是一个列向量，其元素为 $y_i^{(x)} = K_x(R_i)$；$\\mathbf{c}^{(x)}$ 是未知系数 $c_j^{(x)}$ 的列向量；$\\mathbf{A}$ 是 $N_{\\mathrm{fit}} \\times K$ 的设计矩阵，其元素为 $A_{ij} = \\phi_j(R_i)$。目标是最小化 $\\|\\mathbf{y}^{(x)} - \\mathbf{A}\\mathbf{c}^{(x)}\\|^2$。系数的解由正规方程给出：\n$$\\mathbf{c}^{(x)} = (\\mathbf{A}^T \\mathbf{A})^{-1} \\mathbf{A}^T \\mathbf{y}^{(x)}$$\n对三个核函数中的每一个，我们都数值求解该系统，从而得到系数向量 $\\mathbf{c}^{(3)}$、$\\mathbf{c}^{(6)}$ 和 $\\mathbf{c}^{(\\mathrm{rep})}$。\n\n然后，通过将近似核函数代入能量表达式来计算近似能量组分 $E_{\\mathrm{component}}^{\\mathrm{DF}}(R)$：\n$E_{\\mathrm{elst}}^{\\mathrm{DF}}(R) = C_{\\mathrm{elst}} K_3^{\\mathrm{DF}}(R)$,\n$E_{\\mathrm{exch}}^{\\mathrm{DF}}(R) = C_{\\mathrm{exch}} K_{\\mathrm{rep}}^{\\mathrm{DF}}(R)$,\n$E_{\\mathrm{ind}}^{\\mathrm{DF}}(R) = C_{\\mathrm{ind}} K_6^{\\mathrm{DF}}(R)$,\n$E_{\\mathrm{disp}}^{\\mathrm{DF}}(R) = C_{\\mathrm{disp}} K_6^{\\mathrm{DF}}(R)$。\n\n对于每个测试用例，最后一步是在指定距离 $R$ 处计算每个组分的绝对误差：\n$$\\text{误差} = |E_{\\mathrm{component}}^{\\mathrm{exact}}(R) - E_{\\mathrm{component}}^{\\mathrm{DF}}(R)|$$\n算法流程如下：\n1.  根据固定的单体参数，预先计算常数前置因子 $C_{\\mathrm{elst}}$、$C_{\\mathrm{exch}}$、$C_{\\mathrm{ind}}$ 和 $C_{\\mathrm{disp}}$。\n2.  对于由 $R$、$K$、$\\gamma_{\\min}$ 和 $r$ 指定的每个测试用例：\n    a. 生成辅助基组的指数 $\\gamma_j$。\n    b. 构建包含从 $R_{\\min}^{\\mathrm{fit}}=2.0$到 $R_{\\max}^{\\mathrm{fit}}=8.0$ 的 $N_{\\mathrm{fit}}=400$ 个点的拟合网格 $\\{R_i\\}$。\n    c. 通过在网格 $\\{R_i\\}$ 上计算基函数 $\\phi_j$ 来构建设计矩阵 $\\mathbf{A}$。\n    d. 对于每个核函数 $K_3$、$K_6$ 和 $K_{\\mathrm{rep}}$，通过在网格上计算核函数来创建目标向量 $\\mathbf{y}$。\n    e. 求解最小二乘问题，以获得系数向量 $\\mathbf{c}^{(3)}$、$\\mathbf{c}^{(6)}$ 和 $\\mathbf{c}^{(\\mathrm{rep})}$。\n    f. 在测试距离 $R$ 处，计算精确核函数及其高斯拟合近似值。\n    g. 计算四个精确能量组分和四个近似能量组分。\n    h. 计算绝对误差，将其四舍五入到 8 位小数，并存储结果。\n3.  将收集到的结果格式化为指定的列表的列表字符串格式。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem of calculating the error in a SAPT-like energy decomposition\n    when using a Gaussian basis approximation for the interaction kernels.\n    \"\"\"\n\n    # --- Fixed Monomer and Fitting Parameters ---\n    # All values are in atomic units.\n    mu_A = 1.0000\n    mu_B = 0.8000\n    alpha_A = 10.0000\n    alpha_B = 12.0000\n    I_A = 0.5000\n    I_B = 0.6000\n    A_rep = 10000.0000\n    b = 1.8000\n\n    R_min_fit = 2.0000\n    R_max_fit = 8.0000\n    N_fit = 400\n\n    # --- Pre-compute constant energy prefactors ---\n    C_elst = -2.0 * mu_A * mu_B\n    C_exch = A_rep\n    C_ind = -2.0 * (alpha_A * mu_B**2 + alpha_B * mu_A**2)\n    C_disp = -1.5 * (I_A * I_B) / (I_A + I_B) * alpha_A * alpha_B\n\n    # --- Define exact kernels ---\n    def K3(R):\n        return R**-3\n    \n    def K6(R):\n        return R**-6\n\n    def K_rep(R):\n        return np.exp(-b * R)\n\n    # --- Fitting grid ---\n    R_grid = np.linspace(R_min_fit, R_max_fit, N_fit)\n\n    # --- Test suite ---\n    test_cases = [\n        # (R_eval, K, gamma_min, r)\n        (3.5000, 5, 0.0500, 4.0000),\n        (2.2000, 3, 0.1000, 5.0000),\n        (8.0000, 7, 0.0200, 3.0000),\n        (3.0000, 1, 0.5000, 1.0000),\n    ]\n\n    all_results = []\n\n    for R_eval, K, gamma_min, r in test_cases:\n        # --- 1. Generate auxiliary basis and design matrix A ---\n        j = np.arange(K)\n        gammas = gamma_min * (r**j)\n        \n        # Design matrix A (shape: N_fit x K)\n        # A_ij = phi_j(R_i) = exp(-gamma_j * R_i^2)\n        A = np.exp(-gammas[np.newaxis, :] * R_grid[:, np.newaxis]**2)\n\n        # --- 2. Least-squares fitting for each kernel ---\n        # Target vectors y\n        y3 = K3(R_grid)\n        y6 = K6(R_grid)\n        y_rep = K_rep(R_grid)\n\n        # Solve for coefficients c using numpy's least-squares solver\n        c3 = np.linalg.lstsq(A, y3, rcond=None)[0]\n        c6 = np.linalg.lstsq(A, y6, rcond=None)[0]\n        c_rep = np.linalg.lstsq(A, y_rep, rcond=None)[0]\n\n        # --- 3. Evaluate exact and approximate energies at R_eval ---\n        # Exact energies\n        E_elst_exact = C_elst * K3(R_eval)\n        E_exch_exact = C_exch * K_rep(R_eval)\n        E_ind_exact = C_ind * K6(R_eval)\n        E_disp_exact = C_disp * K6(R_eval)\n\n        # Approximate energies\n        # First, evaluate the basis functions and approximate kernels at R_eval\n        phi_at_R = np.exp(-gammas * R_eval**2)\n        \n        K3_df = np.dot(c3, phi_at_R)\n        K6_df = np.dot(c6, phi_at_R)\n        K_rep_df = np.dot(c_rep, phi_at_R)\n        \n        E_elst_df = C_elst * K3_df\n        E_exch_df = C_exch * K_rep_df\n        E_ind_df = C_ind * K6_df\n        E_disp_df = C_disp * K6_df\n\n        # --- 4. Compute absolute errors and round ---\n        err_elst = round(abs(E_elst_exact - E_elst_df), 8)\n        err_exch = round(abs(E_exch_exact - E_exch_df), 8)\n        err_ind = round(abs(E_ind_exact - E_ind_df), 8)\n        err_disp = round(abs(E_disp_exact - E_disp_df), 8)\n        \n        all_results.append([err_elst, err_exch, err_ind, err_disp])\n\n    # --- 5. Format output string ---\n    final_rows = []\n    for row in all_results:\n        str_row = [f\"{val:.8f}\" for val in row]\n        final_rows.append(f\"[{','.join(str_row)}]\")\n\n    final_output = f\"[{','.join(final_rows)}]\"\n    \n    print(final_output)\n\nsolve()\n```", "id": "2781338"}]}