{"hands_on_practices": [{"introduction": "这第一个实践练习旨在巩固您对真实空间结构（由径向分布函数 $g(r)$ 描述）与其倒易空间对应物（静态结构因子 $S(k)$）之间基本数学关系的理解。通过一个既有物理动机又能在数学上求解的解析模型，您将亲手实践连接液体理论中这两个关键函数的傅里叶变换。这项技能对于解释理论模型和实验散射数据至关重要。[@problem_id:2784007]", "problem": "考虑一个数密度为 $\\,\\rho\\,$ 的三维、均匀、各向同性的单组分液体。其径向分布函数 $\\,g(r)\\,$ 可用一个带屏蔽接触尾的硬核排斥模型来描述，具体形式为\n$$\ng(r)=\\begin{cases}\n0, & 0 \\le r < \\sigma, \\\\\n1+\\dfrac{A\\exp\\big(-\\alpha(r-\\sigma)\\big)}{r}, & r \\ge \\sigma,\n\\end{cases}\n$$\n其中 $\\,\\sigma>0\\,$ 是一个有效排除体积直径，$\\,A\\,$ 是一个有限振幅，$\\,\\alpha>0\\,$ 是一个屏蔽参数。令 $\\,h(r)=g(r)-1\\,$ 为总关联函数。从静态结构因子 $\\,S(k)\\,$ 是总关联函数的傅里叶变换这一定义出发，\n$$\nS(\\mathbf{k}) \\equiv 1+\\rho \\int_{\\mathbb{R}^3} h(\\mathbf{r})\\exp\\big(i\\mathbf{k}\\cdot\\mathbf{r}\\big)\\,d^3\\mathbf{r},\n$$\n推导各向同性静态结构因子 $\\,S(k)\\,$ 的闭式解析表达式。该表达式是波矢大小 $\\,k=|\\mathbf{k}|\\,$ 的函数，并对所有实数 $\\,k \\ge 0\\,$ 均有效。推导中只能使用各向同性条件和三维傅里叶变换的标准性质。将最终答案表示为含 $\\,k\\,$, $\\,\\rho\\,$, $\\,\\sigma\\,$, $\\,A\\,$ 和 $\\,\\alpha\\,$ 的单个解析表达式。无需进行数值计算或四舍五入，且最终表达式中不应包含任何单位。", "solution": "在尝试任何解答之前，首先对问题陈述进行验证。\n\n**第1步：提取已知条件**\n- 系统描述：三维、均匀、各向同性的单组分液体。\n- 数密度：$\\rho$。\n- 径向分布函数，$g(r)$：\n$$g(r)=\\begin{cases}\n0, & 0 \\le r < \\sigma, \\\\\n1+\\dfrac{A\\exp(-\\alpha(r-\\sigma))}{r}, & r \\ge \\sigma.\n\\end{cases}$$\n- 参数：$\\sigma > 0$ (排除体积直径)，$A$ (振幅)，$\\alpha > 0$ (屏蔽参数)。\n- 总关联函数，$h(r)$：$h(r) = g(r) - 1$。\n- 静态结构因子 $S(\\mathbf{k})$ 的定义：\n$$S(\\mathbf{k}) \\equiv 1+\\rho \\int_{\\mathbb{R}^3} h(\\mathbf{r})\\exp(i\\mathbf{k}\\cdot\\mathbf{r})\\,d^3\\mathbf{r}$$\n- 目标：推导各向同性静态结构因子 $S(k)$ 的闭式解析表达式，其中 $k=|\\mathbf{k}|$。\n\n**第2步：使用提取的已知条件进行验证**\n该问题具有科学依据，是液体统计力学中的一个标准练习。它涉及径向分布函数 $g(r)$、总关联函数 $h(r)$ 和静态结构因子 $S(k)$ 之间的基本关系。所给出的 $g(r)$ 模型具有物理动机，代表了硬核排斥和一个被屏蔽的、类汤川形式的关联尾。该问题是适定的、客观的且自洽的，为唯一的数学推导提供了所有必要信息。参数 $\\sigma > 0$ 和 $\\alpha > 0$ 确保了模型的物理合理性。不存在矛盾、模糊不清或违反科学原理的地方。\n\n**第3步：结论与行动**\n判定问题有效。将进行推导求解。\n\n推导过程如下。静态结构因子 $S(\\mathbf{k})$ 定义为总关联函数 $h(\\mathbf{r})$ 的傅里叶变换，再加一个常数。\n$$S(\\mathbf{k}) = 1 + \\rho \\int_{\\mathbb{R}^3} h(\\mathbf{r})\\exp(i\\mathbf{k}\\cdot\\mathbf{r})\\,d^3\\mathbf{r}$$\n对于一个均匀且各向同性的系统，总关联函数仅依赖于径向距离 $r = |\\mathbf{r}|$，因此 $h(\\mathbf{r}) = h(r)$。因此，结构因子将仅依赖于波矢的大小 $k = |\\mathbf{k}|$，所以 $S(\\mathbf{k}) = S(k)$。通过对积分变量 $\\mathbf{r}$ 使用球坐标，可以简化三维傅里叶变换积分。将坐标系的z轴与矢量 $\\mathbf{k}$ 对齐，我们有 $\\mathbf{k} \\cdot \\mathbf{r} = kr\\cos\\theta$，以及 $d^3\\mathbf{r} = r^2 \\sin\\theta \\, dr \\, d\\theta \\, d\\phi$。积分变为：\n$$\\int_{\\mathbb{R}^3} h(r)\\exp(i\\mathbf{k}\\cdot\\mathbf{r})\\,d^3\\mathbf{r} = \\int_0^{2\\pi} d\\phi \\int_0^\\pi d\\theta \\int_0^\\infty dr \\, r^2 \\sin\\theta \\, h(r) \\exp(ikr\\cos\\theta)$$\n对 $\\phi$ 的积分得出 $2\\pi$。对 $\\theta$ 的积分可以通过代换 $u = \\cos\\theta$，$du = -\\sin\\theta d\\theta$ 来完成：\n$$\\int_0^\\pi \\exp(ikr\\cos\\theta) \\sin\\theta \\, d\\theta = \\int_1^{-1} \\exp(ikru) (-du) = \\int_{-1}^1 \\exp(ikru) \\, du = \\left[\\frac{\\exp(ikru)}{ikr}\\right]_{-1}^1 = \\frac{\\exp(ikr)-\\exp(-ikr)}{ikr} = \\frac{2\\sin(kr)}{kr}$$\n综合这些结果，得到球对称函数傅里叶变换的著名公式：\n$$\\tilde{h}(k) = \\int_{\\mathbb{R}^3} h(r)\\exp(i\\mathbf{k}\\cdot\\mathbf{r})\\,d^3\\mathbf{r} = 4\\pi \\int_0^\\infty r^2 h(r) \\frac{\\sin(kr)}{kr} dr = \\frac{4\\pi}{k} \\int_0^\\infty r h(r) \\sin(kr) dr$$\n因此，$S(k)$ 的表达式为：\n$$S(k) = 1 + \\frac{4\\pi\\rho}{k} \\int_0^\\infty r h(r) \\sin(kr) dr$$\n根据所给的 $g(r)$，总关联函数 $h(r) = g(r) - 1$ 为：\n$$h(r) = \\begin{cases}\n-1, & 0 \\le r < \\sigma, \\\\\n\\dfrac{A\\exp(-\\alpha(r-\\sigma))}{r}, & r \\ge \\sigma.\n\\end{cases}$$\n我们必须将 $S(k)$ 的积分分成两部分，对应于 $h(r)$ 定义的两个区域：\n$$S(k) = 1 + \\frac{4\\pi\\rho}{k} \\left[ \\int_0^\\sigma r(-1)\\sin(kr) dr + \\int_\\sigma^\\infty r\\left(\\frac{A\\exp(-\\alpha(r-\\sigma))}{r}\\right)\\sin(kr) dr \\right]$$\n让我们分别计算每个积分。\n\n第一个积分 $I_1$ 对应于硬核排斥区域：\n$$I_1 = \\int_0^\\sigma -r\\sin(kr)dr$$\n使用分部积分法 $\\int u\\,dv = uv - \\int v\\,du$，令 $u = r$ 和 $dv = -\\sin(kr)dr$，我们得到 $du=dr$ 和 $v = \\frac{\\cos(kr)}{k}$：\n$$I_1 = \\left[r\\frac{\\cos(kr)}{k}\\right]_0^\\sigma - \\int_0^\\sigma \\frac{\\cos(kr)}{k}dr = \\frac{\\sigma\\cos(k\\sigma)}{k} - \\left[\\frac{\\sin(kr)}{k^2}\\right]_0^\\sigma = \\frac{\\sigma\\cos(k\\sigma)}{k} - \\frac{\\sin(k\\sigma)}{k^2}$$\n这可以改写为：\n$$I_1 = \\frac{k\\sigma\\cos(k\\sigma) - \\sin(k\\sigma)}{k^2}$$\n\n第二个积分 $I_2$ 对应于关联尾：\n$$I_2 = \\int_\\sigma^\\infty A\\exp(-\\alpha(r-\\sigma))\\sin(kr)dr = A\\exp(\\alpha\\sigma)\\int_\\sigma^\\infty \\exp(-\\alpha r)\\sin(kr)dr$$\n这是一个形如 $\\int \\exp(ax)\\sin(bx)dx$ 的标准积分。该定积分为：\n$$\\int_\\sigma^\\infty \\exp(-\\alpha r)\\sin(kr)dr = \\left[ \\frac{\\exp(-\\alpha r)}{(-\\alpha)^2+k^2}(-\\alpha\\sin(kr) - k\\cos(kr)) \\right]_\\sigma^\\infty$$\n由于 $\\alpha > 0$，当 $r \\to \\infty$ 时，项 $\\exp(-\\alpha r)$ 趋近于 $0$。减去在下限处的值：\n$$\\int_\\sigma^\\infty \\exp(-\\alpha r)\\sin(kr)dr = 0 - \\frac{\\exp(-\\alpha\\sigma)}{\\alpha^2+k^2}(-\\alpha\\sin(k\\sigma) - k\\cos(k\\sigma)) = \\frac{\\exp(-\\alpha\\sigma)}{\\alpha^2+k^2}(\\alpha\\sin(k\\sigma) + k\\cos(k\\sigma))$$\n将此结果代回 $I_2$ 的表达式：\n$$I_2 = A\\exp(\\alpha\\sigma) \\left[\\frac{\\exp(-\\alpha\\sigma)}{\\alpha^2+k^2}(\\alpha\\sin(k\\sigma) + k\\cos(k\\sigma))\\right] = \\frac{A(\\alpha\\sin(k\\sigma) + k\\cos(k\\sigma))}{\\alpha^2+k^2}$$\n\n现在，我们将这些结果结合起来，得到 $S(k)$ 的最终表达式：\n$$S(k) = 1 + \\frac{4\\pi\\rho}{k} [I_1 + I_2]$$\n$$S(k) = 1 + \\frac{4\\pi\\rho}{k} \\left[ \\frac{k\\sigma\\cos(k\\sigma) - \\sin(k\\sigma)}{k^2} + \\frac{A(\\alpha\\sin(k\\sigma) + k\\cos(k\\sigma))}{\\alpha^2+k^2} \\right]$$\n将因子 $1/k$ 分配进去，得到另一种形式：\n$$S(k) = 1 + 4\\pi\\rho \\left[ \\frac{k\\sigma\\cos(k\\sigma) - \\sin(k\\sigma)}{k^3} + \\frac{A(\\alpha\\sin(k\\sigma) + k\\cos(k\\sigma))}{k(\\alpha^2+k^2)} \\right]$$\n这就是静态结构因子 $S(k)$ 的最终闭式解析表达式。", "answer": "$$\n\\boxed{1 + 4\\pi\\rho \\left[ \\frac{k\\sigma\\cos(k\\sigma) - \\sin(k\\sigma)}{k^3} + \\frac{A(\\alpha\\sin(k\\sigma) + k\\cos(k\\sigma))}{k(\\alpha^2+k^2)} \\right]}\n$$", "id": "2784007"}, {"introduction": "虽然 $g(r)$ 和 $S(k)$ 之间的关系是精确的，但将它们与底层的分子间势能 $u(r)$ 联系起来则需要理论近似。本练习将深入探讨著名的 Percus-Yevick (PY) 和超网链 (HNC) 闭合关系，并展示它们在弱势能极限下如何收敛于随机相近似 (RPA)。掌握这一概念是理解统计力学如何从微观相互作用构建到宏观可测量的结构性质的关键。[@problem_id:358709]", "problem": "简单液体的结构和性质可以用径向分布函数 $g(r)$ 来描述，或者等价地，用总相关函数 $h(r) = g(r) - 1$ 来描述。Ornstein-Zernike (OZ) 方程给出了 $h(r)$ 与直接相关函数 $c(r)$ 之間的一个基本关系：\n$$h(\\mathbf{r}) = c(\\mathbf{r}) + \\rho \\int c(\\mathbf{r}-\\mathbf{r'}) h(\\mathbf{r'}) d^3r'$$\n其中 $\\rho$ 是液体的数密度。在傅里叶空间中，该方程呈现出更简单的代数形式 $\\hat{h}(k) = \\hat{c}(k) + \\rho \\hat{c}(k) \\hat{h}(k)$。\n\nOZ 方程必须辅以一个闭合关系，该关系将 $h(r)$ 和 $c(r)$ 与分子间对势 $u(r)$ 联系起来。两个最常见的闭合是 Percus-Yevick (PY) 近似和超网链 (HNC) 近似：\n- **PY 闭合：** $c(r) = [h(r) + 1](1 - e^{\\beta u(r)})$\n- **HNC 闭合：** $c(r) = h(r) - \\ln[h(r) + 1] - \\beta u(r)$\n\n此处，$\\beta = 1/(k_{\\mathrm{B}} T)$ 是逆热能。静态结构因子是一个可通过实验测量的量，它通过 $S(k) = 1 + \\rho \\hat{h}(k)$ 与总相关函数相关联。\n\n考虑这样一种液体，其粒子间的相互作用由如下给出的弱吸引 Yukawa 势描述\n$$u(r) = -u_0 \\frac{e^{-\\alpha r}}{r}$$\n其中 $u_0 > 0$ 和 $\\alpha > 0$ 分别是表征势的强度和范围的常数。该势在 $|\\beta u(r)| \\ll 1$ 的意义上被认为是“弱”的。在此极限下，PY 和 HNC 闭合对于直接相关函数都简化为相同的形式，这被称为随机相近似 (RPA)。\n\n推导该系统的静态结构因子 $S(k)$。为此，首先证明在弱势极限下，PY 和 HNC 闭合对于 $c(r)$ 都简化为相同的简单表达式。然后，使用此 RPA 结果来计算 $S(k)$。给定势的径向部分的三维傅里叶变换：\n$$\\mathcal{F}\\left[\\frac{e^{-\\alpha r}}{r}\\right](k) = \\frac{4\\pi}{k^2 + \\alpha^2}$$\n你的最终答案应为一个 $S(k)$ 的表达式，用波矢 $k$、数密度 $\\rho$、逆温度 $\\beta$ 以及势参数 $u_0$ 和 $\\alpha$ 来表示。", "solution": "1. 在弱势极限 $|\\beta u(r)|\\ll1$ 下闭合的简化。\n   PY 闭合：\n   $$c(r)=(h(r)+1)\\bigl[1-e^{\\beta u(r)}\\bigr]\\approx (h+1)\\bigl[-\\beta u(r)\\bigr]\\sim -\\beta u(r)\\,. $$\n   HNC 闭合：\n   $$c(r)=h(r)-\\ln\\bigl[1+h(r)\\bigr]-\\beta u(r)\\approx h-\\bigl[h-\\tfrac12h^2+\\cdots\\bigr]-\\beta u(r)\\sim -\\beta u(r)\\,. $$\n   因此在 RPA 中\n   $$c(r)\\approx -\\beta\\,u(r)=\\beta\\,u_0\\,\\frac{e^{-\\alpha r}}{r}\\,. $$\n\n2. $c(r)$ 的傅里叶变换：\n   $$\\hat c(k)=\\beta\\,u_0\\;\\mathcal F\\Bigl[\\frac{e^{-\\alpha r}}{r}\\Bigr](k)\n     =\\beta\\,u_0\\;\\frac{4\\pi}{k^2+\\alpha^2}\\,. $$\n\n3. 通过傅里叶空间中的 OZ 方程得到静态结构因子，$S(k)=1/(1-\\rho\\hat c(k))$：\n   $$S(k)=\\frac{1}{1-\\rho\\,\\frac{4\\pi\\beta\\,u_0}{k^2+\\alpha^2}}$$", "answer": "$$\\boxed{\\frac{1}{1-\\displaystyle\\frac{4\\pi\\beta u_0\\rho}{k^2+\\alpha^2}}}$$", "id": "358709"}, {"introduction": "从解析理论迈向计算实践是任何现代理论科学家的关键一步。此问题要求您在倒易空间中应用 Ornstein-Zernike (OZ) 方程，从给定的结构因子 $S(k)$ 中提取直接关联函数 $\\tilde{c}(k)$，然后执行数值傅里叶逆变换以获得其实空间形式 $c(r)$。本练习不仅强调了 OZ 方程的核心作用，还培养了您在数值积分方面的实践技能，这对于分析来自模拟和散射实验的数据是必不可少的。[@problem_id:2784020]", "problem": "您的任务是提取波矢空间中的直接相关函数，并将其数值反演到实空间，该函数适用于以约化（无量纲）单位表示的均匀各向同性液体。请从液体理论的基本陈述开始：Ornstein–Zernike 方程，静态结构因子作为总相关函数傅里叶变换的定义，以及用球贝塞尔函数表示的三维各向同性傅里叶变换对。不假设任何额外的闭合关系。\n\n您的程序必须实现以下步骤：\n\n1. 利用波矢空间中的 Ornstein–Zernike 方程连接总相关函数 $\\tilde{h}(k)$ 和直接相关函数 $\\tilde{c}(k)$，以及静态结构因子 $S(k)$ 通过一个基本定义与 $\\tilde{h}(k)$ 相关联这一事实。\n2. 基于这些基础，推导出一个用 $S(k)$ 和数密度 $\\rho$ 表示 $\\tilde{c}(k)$ 的显式表达式。\n3. 通过数值计算三维各向同性逆傅里叶变换，从 $\\tilde{c}(k)$ 计算实空间直接相关函数 $c(r)$\n$$\nc(r) = \\frac{1}{2\\pi^2}\\int_{0}^{\\infty} k^2 \\tilde{c}(k)\\,\\frac{\\sin(kr)}{kr}\\,dk\n$$\n请使用稳健的复合辛普森求积法在 $k$ 的均匀网格上进行计算。\n\n所有量均为无量纲的约化单位，因此不需要进行物理单位转换。\n\n数值要求：\n\n- $k$ 域积分的范围必须是 $0 \\le k \\le k_{\\max}$，其中 $k_{\\max} = 300.0$。\n- 积分必须使用一个包含 $N_k = 200001$ 个点的均匀网格，这对应于 $N_k - 1$ 个偶数数量的区间，适用于复合辛普森法则。设 $\\Delta k = k_{\\max}/(N_k-1)$。\n- 在 $k=0$ 处，将核函数 $\\sin(kr)/(kr)$ 按其极限值 $1$ 处理，并注意由于 $k^2$ 前置因子，整个被积函数的极限为 $0$；请谨慎实现以避免除以零。\n- 为保证数值稳定性和覆盖范围，在整个网格上使用复合辛普森权重 $[1,4,2,\\dots,4,1]$。\n- 将报告的每个 $c(r)$ 值四舍五入到小数点后 4 位。\n\n测试套件：\n\n对于每个测试用例 $i \\in \\{1,2,3\\}$，给定数密度 $\\rho$ 和一个为所有 $k \\ge 0$ 定义的模型静态结构因子：\n$$\nS_i(k) = \\frac{k^2 + \\alpha_i^2}{k^2 + \\alpha_i^2 + 4\\pi \\rho_i A_i}.\n$$\n这些模型在科学上是合理的，并能确保当 $k \\to \\infty$ 时 $S_i(k) \\to 1$。参数集如下：\n\n- 用例 1：$\\rho_1 = 0.6$, $A_1 = 0.5$, $\\alpha_1 = 2.0$。\n- 用例 2：$\\rho_2 = 0.2$, $A_2 = 1.0$, $\\alpha_2 = 4.0$。\n- 用例 3 (边界条件)：$\\rho_3 = 0.7$, $A_3 = 0.0$, $\\alpha_3 = 1.5$。\n\n对于每个用例，计算在半径 $r \\in \\{0.5, 1.0, 3.0\\}$ 处的 $c(r)$。这些半径均以相同的约化无量纲单位给出。\n\n最终输出规格：\n\n- 您的程序应生成一行输出，其中包含 9 个结果，形式为方括号内的逗号分隔列表，顺序如下：用例 1 的 $r=0.5$、用例 1 的 $r=1.0$、用例 1 的 $r=3.0$，然后是用例 2 的 $r=0.5$、用例 2 的 $r=1.0$、用例 2 的 $r=3.0$，接着是用例 3 的 $r=0.5$、用例 3 的 $r=1.0$、用例 3 的 $r=3.0$。每个值必须四舍五入到小数点后 4 位。例如，输出格式必须与\n`[x_1,x_2,x_3,x_4,x_5,x_6,x_7,x_8,x_9]`\n完全一样，其中每个 $x_j$ 是一个打印到小数点后 4 位的浮点数。", "solution": "该问题是适定的且科学上严谨的，它基于液体理论的基本原理。我们的任务是根据给定的静态结构因子模型 $S(k)$，计算实空间直接相关函数 $c(r)$。求解过程需要两个主要步骤：首先，推导直接相关函数的傅里叶变换 $\\tilde{c}(k)$ 关于 $S(k)$ 的代数表达式；其次，数值计算逆傅里叶变换以获得 $c(r)$。\n\n推导始于均匀各向同性液体的 Ornstein-Zernike (OZ) 方程。在傅里叶空间中，OZ 方程具有简单的代数形式：\n$$\n\\tilde{h}(k) = \\tilde{c}(k) + \\rho \\tilde{c}(k) \\tilde{h}(k)\n$$\n其中 $\\tilde{h}(k)$ 是总相关函数 $h(r) = g(r) - 1$ 的傅里叶变换，$\\tilde{c}(k)$ 是直接相关函数 $c(r)$ 的傅里叶变换，$\\rho$ 是数密度。该方程可整理为：\n$$\n\\tilde{h}(k) = \\tilde{c}(k) \\left[ 1 + \\rho \\tilde{h}(k) \\right]\n$$\n静态结构因子 $S(k)$ 通过以下定义与 $\\tilde{h}(k)$ 有基本关联：\n$$\nS(k) = 1 + \\rho \\tilde{h}(k)\n$$\n将此定义代入整理后的 OZ 方程可得：\n$$\n\\tilde{h}(k) = \\tilde{c}(k) S(k)\n$$\n为找到一个仅用 $S(k)$ 和 $\\rho$ 表示 $\\tilde{c}(k)$ 的表达式，我们首先整理 $S(k)$ 的定义以表达 $\\tilde{h}(k)$：\n$$\n\\tilde{h}(k) = \\frac{S(k) - 1}{\\rho}\n$$\n将此代入关系式 $\\tilde{h}(k) = \\tilde{c}(k) S(k)$ 中得到：\n$$\n\\frac{S(k) - 1}{\\rho} = \\tilde{c}(k) S(k)\n$$\n解出 $\\tilde{c}(k)$，我们得到所需的表达式：\n$$\n\\tilde{c}(k) = \\frac{S(k) - 1}{\\rho S(k)} = \\frac{1}{\\rho}\\left(1 - \\frac{1}{S(k)}\\right)\n$$\n在确定 $\\tilde{c}(k)$ 后，我们通过问题陈述中指定的三维各向同性逆傅里叶变换来计算 $c(r)$：\n$$\nc(r) = \\frac{1}{2\\pi^2}\\int_{0}^{\\infty} k^2 \\tilde{c}(k)\\,\\frac{\\sin(kr)}{kr}\\,dk\n$$\n该积分必须进行数值计算。我们通过在域 $[0, k_{\\max}]$（其中 $k_{\\max}=300.0$）上的定积分来近似该无穷积分。选择 $k_{\\max}$ 是合理的，因为所提供的 $S(k)$ 模型意味着 $\\tilde{c}(k)$ 对于大的 $k$ 会足够快地衰减，使得来自 $k > k_{\\max}$ 的贡献可以忽略。\n\n数值积分使用复合辛普森法则在一个包含 $k$ 域中 $N_k = 200001$ 个点的均匀网格上执行。点的数量为奇数，提供了偶数个区间 $N_k - 1$，这符合该方法的要求。网格点为 $k_i = i \\cdot \\Delta k$（对于 $i \\in \\{0, 1, \\dots, N_k-1\\}$），步长为 $\\Delta k = k_{\\max}/(N_k-1)$。\n\n被积函数为 $I(k, r) = k^2 \\tilde{c}(k) j_0(kr)$，其中 $j_0(x) = \\sin(x)/x$ 是零阶球贝塞尔函数。在 $k=0$ 处需要特别处理。当 $k \\to 0$ 时，$j_0(kr)$ 的极限为 $1$。然而，$k^2$ 前置因子确保了在 $k=0$ 时整个被积函数 $I(k, r)$ 为零，因为对于给定模型 $\\tilde{c}(0)$ 是有限的。在实现中已正确处理此问题以避免任何除以零的错误。\n\n每个测试用例的算法如下：\n1.  建立从 $0$ 到 $k_{\\max}$ 的 $k$ 的数值网格以及相应的辛普森法则权重。\n2.  对于一组给定的参数 ($\\rho_i, A_i, \\alpha_i$)，使用公式 $S_i(k) = (k^2 + \\alpha_i^2) / (k^2 + \\alpha_i^2 + 4\\pi \\rho_i A_i)$ 在网格上计算 $S_i(k)$。\n3.  使用推导出的关系式 $\\tilde{c}_i(k) = (1/\\rho_i)(1 - 1/S_i(k))$ 在网格上计算 $\\tilde{c}_i(k)$。\n4.  对于每个指定的 $r$ 值，计算整个网格上的被积函数值 $I_i(k, r)$。\n5.  使用复合辛普森法则评估 $I_i(k,r)$ 的积分。\n6.  将积分结果乘以预因子 $1/(2\\pi^2)$ 以获得 $c_i(r)$。\n7.  按要求将 $c_i(r)$ 的最终值四舍五入到小数点后 4 位。\n\n此过程是确定性的，并为所提出的问题提供了稳健的数值解。当 $A_3=0.0$ 的特殊情况下，正确地得出 $S_3(k)=1$，这对应于理想气体。在此情况下，对于所有 $k$，$\\tilde{c}_3(k)=0$，因此 $c_3(r)=0$，这可作为计算的有效物理基准。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the direct correlation function c(r) from the static structure\n    factor S(k) using the Ornstein-Zernike equation and numerical Fourier inversion.\n    \"\"\"\n    # Numerical integration parameters\n    k_max = 300.0\n    N_k = 200001\n\n    # Radial distances for evaluation\n    r_values = [0.5, 1.0, 3.0]\n\n    # Test case parameters: (rho, A, alpha)\n    test_cases = [\n        (0.6, 0.5, 2.0),  # Case 1\n        (0.2, 1.0, 4.0),  # Case 2\n        (0.7, 0.0, 1.5),  # Case 3\n    ]\n\n    # Set up the k-space grid\n    k = np.linspace(0, k_max, N_k)\n    dk = k[1] - k[0]\n\n    # Pre-compute Simpson's rule weights for the grid\n    # Weights are [1, 4, 2, 4, ..., 2, 4, 1]\n    weights = np.full(N_k, 2.0)\n    weights[1::2] = 4.0\n    weights[0] = 1.0\n    weights[-1] = 1.0\n\n    results = []\n\n    for rho, A, alpha in test_cases:\n        # Calculate the static structure factor S(k)\n        # S_i(k) = (k^2 + alpha_i^2) / (k^2 + alpha_i^2 + 4*pi*rho_i*A_i)\n        k_sq = k**2\n        alpha_sq = alpha**2\n        s_k_denominator = k_sq + alpha_sq + 4.0 * np.pi * rho * A\n        \n        # We can safely divide as the denominator is always positive for the given parameters.\n        s_k = (k_sq + alpha_sq) / s_k_denominator\n\n        # Calculate the direct correlation function in k-space, tilde_c(k)\n        # tilde_c(k) = (1/rho) * (1 - 1/S(k))\n        # Handle the case where rho might be zero, although not in the test suite.\n        if rho == 0.0:\n            c_tilde_k = np.zeros_like(k)\n        else:\n            # S(k) is always positive for the given model, so 1/S(k) is safe.\n            c_tilde_k = (1.0 / rho) * (1.0 - 1.0 / s_k)\n\n        for r in r_values:\n            # Compute the integrand for the inverse Fourier transform\n            # Integrand I(k,r) = k^2 * tilde_c(k) * sin(kr)/(kr)\n            \n            # The term sin(kr)/(kr) is the spherical Bessel function j_0(kr).\n            # Its limit is 1 as the argument approaches 0.\n            # We can use np.sinc for a numerically stable calculation: sin(pi*x)/(pi*x).\n            # To compute sin(y)/y, we use np.sinc(y/pi).\n            kr_div_pi = k * r / np.pi\n            j0_kr = np.sinc(kr_div_pi)\n\n            integrand = k_sq * c_tilde_k * j0_kr\n            \n            # Perform numerical integration using composite Simpson's rule\n            integral_val = (dk / 3.0) * np.sum(integrand * weights)\n            \n            # Calculate the real-space direct correlation function c(r)\n            c_r = (1.0 / (2.0 * np.pi**2)) * integral_val\n            \n            # Round the result to 4 decimal places as per the requirement\n            results.append(round(c_r, 4))\n\n    # Format the final output string as specified\n    output_str = \"[\" + \",\".join([f\"{res:.4f}\" for res in results]) + \"]\"\n    print(output_str)\n\nsolve()\n```", "id": "2784020"}]}