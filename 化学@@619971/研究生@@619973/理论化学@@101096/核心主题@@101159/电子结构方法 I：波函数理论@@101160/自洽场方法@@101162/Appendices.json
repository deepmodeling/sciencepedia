{"hands_on_practices": [{"introduction": "Hartree-Fock-Roothaan方程的形式为广义特征值问题 $FC=SCE$，这是由于原子轨道基组的非正交性所致。为了利用标准数值算法求解，我们必须将其转换为标准特征值问题 $F'C'=C'E$。这个练习让你亲手实践对称正交化这一关键步骤，通过计算变换矩阵 $S^{-1/2}$，将抽象的理论与具体的矩阵运算联系起来，从而揭示SCF程序如何处理非正交基组的核心技术。[@problem_id:215564]", "problem": "在Hartree-Fock-Roothaan自洽场（SCF）方法中，电子结构问题被表述为一个广义本征值问题：\n$$ \\mathbf{F}\\mathbf{C} = \\mathbf{S}\\mathbf{C}\\mathbf{E} $$\n在这里，$\\mathbf{F}$是Fock矩阵，$\\mathbf{C}$是分子轨道系数矩阵，$\\mathbf{S}$是非正交原子轨道基函数的重叠矩阵，而$\\mathbf{E}$是轨道能量的对角矩阵。\n\n为了使用标准的本征值问题数值算法求解此方程，必须首先将其转换为$\\mathbf{F}'\\mathbf{C}' = \\mathbf{C}'\\mathbf{E}$形式的标准本征值问题。实现这一转换的常用方法是对称正交化，也称为Löwdin正交化。此方法引入一个变换矩阵$\\mathbf{X} = \\mathbf{S}^{-1/2}$，用于变换基函数和Fock矩阵。\n\n考虑一个线性、对称的三原子分子A-B-A的简单模型，该模型由一个最小基组描述，该基组包含每个原子上的一个s型原子轨道，分别表示为$\\phi_1$、$\\phi_2$和$\\phi_3$。在此基组中，重叠矩阵$\\mathbf{S}$由下式给出：\n$$ \\mathbf{S} = \\begin{pmatrix} 1 & s & 0 \\\\ s & 1 & s \\\\ 0 & s & 1 \\end{pmatrix} $$\n其中$s$是相邻原子轨道之间的重叠积分，并且假定末端原子之间的重叠为零。参数$s$是一个满足$0 < s < 1/\\sqrt{2}$的实数，以确保重叠矩阵是正定的。\n\n您的任务是计算对称正交化矩阵$\\mathbf{X} = \\mathbf{S}^{-1/2}$的非对角矩阵元$X_{12}$。", "solution": "我们希望计算以下矩阵的非对角元$X_{12}$\n\n$$\n\\mathbf X = \\mathbf S^{-1/2},\n\\qquad\n\\mathbf S = \\begin{pmatrix}1 & s & 0\\\\s & 1 & s\\\\0 & s & 1\\end{pmatrix}.\n$$\n\n1. 用一个标准正交矩阵$U$对$\\mathbf S$进行对角化：\n\n$$\n\\mathbf S = U\\,\\Lambda\\,U^T,\n\\qquad\n\\Lambda = \\operatorname{diag}(\\lambda_1,\\lambda_2,\\lambda_3).\n$$\n\n对于由三个轨道组成的线性链，其本征值为\n\n$$\n\\lambda_k=1+2s\\cos\\frac{k\\pi}{4},\n\\quad k=1,2,3,\n$$\n\n所以\n\n$$\n\\lambda_1=1+\\sqrt2\\,s,\\quad\n\\lambda_2=1,\\quad\n\\lambda_3=1-\\sqrt2\\,s.\n$$\n\n\n2. （未归一化的）本征向量的分量为\n\n$$\nu_{j k}=\\sin(jk\\pi/4),\n\\quad j=1,2,3,\n$$\n\n并且通过$\\sum_{j=1}^3\\sin^2(jk\\pi/4)=2$进行归一化。因此\n\n$$\nU_{jk}=\\frac{\\sin(jk\\pi/4)}{\\sqrt2}.\n$$\n\n\n3. 对称正交化矩阵为\n\n$$\n\\mathbf X=\\mathbf S^{-1/2}\n=U\\,\\Lambda^{-1/2}\\,U^T,\n$$\n\n所以每个矩阵元为\n\n$$\nX_{12}\n=\\sum_{k=1}^3U_{1k}\\,U_{2k}\\,\\frac1{\\sqrt{\\lambda_k}}.\n$$\n\n由于$U_{12}U_{22}=0$，只有$k=1,3$项有贡献。我们有\n\n$$\nU_{11}U_{21}\n=\\frac{\\sin(\\pi/4)\\sin(2\\pi/4)}{2}\n=\\frac{1}{2\\sqrt2},\n\\quad\nU_{13}U_{23}\n=\\frac{\\sin(3\\pi/4)\\sin(6\\pi/4)}{2}\n=-\\frac{1}{2\\sqrt2}.\n$$\n\n因此\n\n$$\nX_{12}\n=\\frac{1}{2\\sqrt2}\\Bigl(\\frac1{\\sqrt{1+\\sqrt2\\,s}}\n-\\frac1{\\sqrt{1-\\sqrt2\\,s}}\\Bigr).\n$$", "answer": "$$\\boxed{\\frac{1}{2\\sqrt{2}}\\Bigl(\\frac{1}{\\sqrt{1+\\sqrt{2}\\,s}}-\\frac{1}{\\sqrt{1-\\sqrt{2}\\,s}}\\Bigr)}$$", "id": "215564"}, {"introduction": "在SCF迭代过程中，我们根据分子轨道系数构建密度矩阵 $P$。一个物理上一致的密度矩阵必须是幂等的，即满足 $P^2=P$。这个练习将带你了解 McWeeny 纯化方案，这是一种确保密度矩阵满足此基本属性的强大算法，尤其在现代线性标度方法中至关重要。通过这个计算，你将体会到如何通过数值方法来强制执行解的物理约束。[@problem_id:215598]", "problem": "在量子化学的自洽场 (SCF) 方法中，特别是在线性标度方法中，单粒子密度矩阵 $D$ 起着核心作用。对于由单行列式波函数描述的闭壳层体系，精确的密度矩阵必须是幂等的，即满足条件 $D^2 = D$。此外，其迹必须等于占据轨道的数量，$Tr(D) = N_{occ}$。\n\n在迭代的 SCF 过程中，一个试探密度矩阵 $D_n$ 可能不是完全幂等的。McWeeny 纯化方案是一种恢复幂等性的方法。最常见的纯化算法之一是根据以下公式更新密度矩阵：\n$$\nD_{n+1} = f(D_n) = 3D_n^2 - 2D_n^3\n$$\n该变换具有这样的性质：如果 $D_n$ 的本征值在区间 $[0, 1]$ 内，则 $D_{n+1}$ 的本征值会被推向 0 或 1，从而使矩阵在每次迭代中都更接近幂等。\n\n考虑一个简单的双轨道、双电子模型体系（例如，H$_2$ 的最小基组表示）。密度矩阵是一个 $2 \\times 2$ 的矩阵，对于该体系，$N_{occ} = 1$。一个非幂等的试探密度矩阵 $D$ 由下式给出：\n$$\nD = \\begin{pmatrix} \\frac{3}{4} & \\frac{1}{4} \\\\ \\frac{1}{4} & \\frac{1}{4} \\end{pmatrix}\n$$\n该矩阵是对称的，并且具有正确的迹，$Tr(D) = 1$。\n\n你的任务是对该试探密度矩阵应用一次 McWeeny 纯化算法，得到纯化后的矩阵 $D'$。计算这个新矩阵的行列式 $\\det(D')$。", "solution": "1. McWeeny 纯化公式：\n$$\nD' = 3D^2 - 2D^3.\n$$\n\n2. 给定\n$$\nD=\\begin{pmatrix}\\tfrac34\\tfrac14\\\\[6pt]\\tfrac14\\tfrac14\\end{pmatrix},\n$$\n计算\n$$\nD^2=\\begin{pmatrix}\n\\tfrac34^2+\\tfrac14^2  \\tfrac34\\cdot\\tfrac14+\\tfrac14\\cdot\\tfrac14\\\\[4pt]\n\\tfrac34\\cdot\\tfrac14+\\tfrac14\\cdot\\tfrac14  \\tfrac14^2+\\tfrac14^2\n\\end{pmatrix}\n=\\begin{pmatrix}\\tfrac{10}{16}\\tfrac{4}{16}\\\\[4pt]\\tfrac{4}{16}\\tfrac{2}{16}\\end{pmatrix}\n=\\begin{pmatrix}\\tfrac58\\tfrac14\\\\[4pt]\\tfrac14\\tfrac18\\end{pmatrix}.\n$$\n\n3. 接着，\n$$\nD^3 = D^2D\n=\\begin{pmatrix}pq\\\\[3pt]qr\\end{pmatrix}\n\\begin{pmatrix}ab\\\\[3pt]bc\\end{pmatrix}\n\\quad\\text{其中 }a=\\tfrac34,\\;b=\\tfrac14,\\;c=\\tfrac14,\\;\np=\\tfrac58,\\;q=\\tfrac14,\\;r=\\tfrac18,\n$$\n得到\n$$\nD^3\n=\\begin{pmatrix}\n\\tfrac{17}{32}\\tfrac{7}{32}\\\\[4pt]\n\\tfrac{7}{32}\\tfrac{3}{32}\n\\end{pmatrix}.\n$$\n\n4. 构成纯化矩阵：\n$$\nD' =3D^2-2D^3\n=\\begin{pmatrix}\n3\\cdot\\tfrac58 -2\\cdot\\tfrac{17}{32}3\\cdot\\tfrac14 -2\\cdot\\tfrac{7}{32}\\\\[4pt]\n3\\cdot\\tfrac14 -2\\cdot\\tfrac{7}{32}3\\cdot\\tfrac18 -2\\cdot\\tfrac{3}{32}\n\\end{pmatrix}\n=\\begin{pmatrix}\n\\tfrac{13}{16}\\tfrac{5}{16}\\\\[4pt]\n\\tfrac{5}{16}\\tfrac{3}{16}\n\\end{pmatrix}.\n$$\n\n5. $D'$ 的行列式：\n$$\n\\det(D')\n=\\frac{13}{16}\\cdot\\frac{3}{16}-\\Bigl(\\frac{5}{16}\\Bigr)^2\n=\\frac{39}{256}-\\frac{25}{256}\n=\\frac{14}{256}\n=\\frac{7}{128}.\n$$", "answer": "$$\\boxed{7/128}$$", "id": "215598"}, {"introduction": "SCF迭代何时收敛？仅凭能量变化判断有时会产生误导。真正的收敛不仅要求能量稳定，还要求密度矩阵平稳，即Fock矩阵与密度矩阵的对易子 $[F,P]$ 趋于零。本练习通过一个“假收敛”的巧妙例子，让你深刻理解为何必须监测能量梯度（以对易子范数体现）而非仅仅能量变化，这是确保获得物理意义上可靠解的关键实践智慧。[@problem_id:2804024]", "problem": "考虑一个基于标准正交原子轨道基 $\\{|1\\rangle, |2\\rangle\\}$ 的单电子、双能级玩具自洽场 (SCF) 模型。在第 $n$ 次 SCF 迭代时，Fock算符由厄米矩阵表示\n$$\nF^{(n)} = \\begin{pmatrix} \\alpha  0 \\\\ 0  \\beta \\end{pmatrix},\n$$\n其中 $\\alpha = 0$ （单位为 Hartree），$\\beta = \\Delta$，且 $\\Delta = 2.0 \\times 10^{-2}$ （单位为 Hartree）。在第 $n$ 次迭代时，单电子密度矩阵是到占据自旋轨道上的投影算符 $P^{(n)} = |c\\rangle \\langle c|$\n$$\n|c\\rangle = \\begin{pmatrix} \\cos\\theta \\\\ \\sin\\theta \\end{pmatrix}, \\quad \\text{with } \\theta = \\frac{\\pi}{4} \\text{ (radians)}.\n$$\n假设在第 $n+1$ 次迭代时，算法施加了一个微小的均匀对角位移，得到\n$$\nF^{(n+1)} = \\begin{pmatrix} \\alpha + \\delta  0 \\\\ 0  \\beta + \\delta \\end{pmatrix},\n$$\n其中 $\\delta = 1.0 \\times 10^{-10}$ （单位为 Hartree），而由于阻尼，密度矩阵保持不变，$P^{(n+1)} = P^{(n)}$。\n\n使用期望值作为此单电子玩具模型的能量泛函\n$$\nE^{(k)} = \\operatorname{Tr}(F^{(k)} P^{(k)}),\n$$\n并回想一下，在标准正交基中，自洽平稳性条件要求对易子 $[F^{(n)}, P^{(n)}] = F^{(n)} P^{(n)} - P^{(n)} F^{(n)}$ 在收敛时为零。残差范数取为 Frobenius 范数 $\\|X\\|_{\\mathrm{F}} = \\sqrt{\\operatorname{Tr}(X^{\\dagger} X)}$。目标收敛阈值为：能量变化阈值 $\\tau_{E} = 1.0 \\times 10^{-8}$ （单位为 Hartree）和残差阈值 $\\tau_{R} = 1.0 \\times 10^{-3}$ （单位为 Hartree）。\n\n任务：\n1) 计算 $E^{(n)}$ 和 $E^{(n+1)}$，并验证是否满足 $|E^{(n+1)} - E^{(n)}|  \\tau_{E}$。\n2) 计算 Frobenius 范数 $\\|[F^{(n)}, P^{(n)}]\\|_{\\mathrm{F}}$ 并将其与 $\\tau_{R}$ 比较，以评估残差是否表明未收斂。\n\n以 Hartree 为单位表示 Frobenius 范数的最终数值，并将您的答案四舍五入到四位有效数字。您的最终答案必须是单个数字。", "solution": "所述问题具有科学依据，提法明确且客观。它展示了一个在自洽场 (SCF) 理论背景下，使用简化的双能级量子系统的标准教学练习。所有必要的数据和定义都已给出，且任务明确。因此，该问题是有效的，并将提供解答。\n\n第一步是根据给定的占据自旋轨道 $|c\\rangle$ 构建单电子密度矩阵 $P^{(n)}$。该自旋轨道在标准正交基 $\\{|1\\rangle, |2\\rangle\\}$ 中定义如下：\n$$\n|c\\rangle = \\begin{pmatrix} \\cos\\theta \\\\ \\sin\\theta \\end{pmatrix}, \\quad \\text{with } \\theta = \\frac{\\pi}{4}\n$$\n代入 $\\theta$ 的值，我们得到 $\\cos(\\frac{\\pi}{4}) = \\frac{1}{\\sqrt{2}}$ 和 $\\sin(\\frac{\\pi}{4}) = \\frac{1}{\\sqrt{2}}$。因此，该轨道为：\n$$\n|c\\rangle = \\frac{1}{\\sqrt{2}}\\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}\n$$\n相应的伴随向量为 $\\langle c| = \\frac{1}{\\sqrt{2}}\\begin{pmatrix} 1  1 \\end{pmatrix}$。密度矩阵 $P^{(n)}$ 是投影算符 $|c\\rangle \\langle c|$：\n$$\nP^{(n)} = |c\\rangle \\langle c| = \\frac{1}{\\sqrt{2}}\\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} \\frac{1}{\\sqrt{2}}\\begin{pmatrix} 1  1 \\end{pmatrix} = \\frac{1}{2}\\begin{pmatrix} 1  1 \\\\ 1  1 \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{2}  \\frac{1}{2} \\\\ \\frac{1}{2}  \\frac{1}{2} \\end{pmatrix}\n$$\n问题指出，由于阻尼，密度矩阵在下一次迭代中保持不变，因此 $P^{(n+1)} = P^{(n)}$。\n\n**任务1：能量计算与收敛性判断**\n\n我们使用泛函 $E^{(k)} = \\operatorname{Tr}(F^{(k)} P^{(k)})$ 来計算第 $k$ 次迭代的能量 $E^{(k)}$。\n\n在第 $n$ 次迭代时，Fock矩阵为 $F^{(n)} = \\begin{pmatrix} \\alpha  0 \\\\ 0  \\beta \\end{pmatrix}$，其中 $\\alpha = 0$ 且 $\\beta = \\Delta = 2.0 \\times 10^{-2}$。\n$$\nF^{(n)} = \\begin{pmatrix} 0  0 \\\\ 0  \\Delta \\end{pmatrix}\n$$\n乘积 $F^{(n)} P^{(n)}$ 为：\n$$\nF^{(n)} P^{(n)} = \\begin{pmatrix} 0  0 \\\\ 0  \\Delta \\end{pmatrix} \\begin{pmatrix} \\frac{1}{2}  \\frac{1}{2} \\\\ \\frac{1}{2}  \\frac{1}{2} \\end{pmatrix} = \\begin{pmatrix} 0  0 \\\\ \\frac{\\Delta}{2}  \\frac{\\Delta}{2} \\end{pmatrix}\n$$\n能量 $E^{(n)}$ 是该矩阵的迹：\n$$\nE^{(n)} = \\operatorname{Tr}(F^{(n)} P^{(n)}) = 0 + \\frac{\\Delta}{2} = \\frac{\\Delta}{2}\n$$\n在第 $n+1$ 次迭代时，Fock矩阵为 $F^{(n+1)} = \\begin{pmatrix} \\alpha + \\delta  0 \\\\ 0  \\beta + \\delta \\end{pmatrix}$，其中 $\\delta = 1.0 \\times 10^{-10}$。\n$$\nF^{(n+1)} = \\begin{pmatrix} \\delta  0 \\\\ 0  \\Delta + \\delta \\end{pmatrix}\n$$\n使用 $P^{(n+1)} = P^{(n)}$，乘积 $F^{(n+1)} P^{(n+1)}$ 为：\n$$\nF^{(n+1)} P^{(n+1)} = \\begin{pmatrix} \\delta  0 \\\\ 0  \\Delta + \\delta \\end{pmatrix} \\begin{pmatrix} \\frac{1}{2}  \\frac{1}{2} \\\\ \\frac{1}{2}  \\frac{1}{2} \\end{pmatrix} = \\begin{pmatrix} \\frac{\\delta}{2}  \\frac{\\delta}{2} \\\\ \\frac{\\Delta + \\delta}{2}  \\frac{\\Delta + \\delta}{2} \\end{pmatrix}\n$$\n能量 $E^{(n+1)}$ 是该矩阵的迹：\n$$\nE^{(n+1)} = \\operatorname{Tr}(F^{(n+1)} P^{(n+1)}) = \\frac{\\delta}{2} + \\frac{\\Delta + \\delta}{2} = \\frac{\\Delta + 2\\delta}{2} = \\frac{\\Delta}{2} + \\delta\n$$\n能量的变化量为：\n$$\n|E^{(n+1)} - E^{(n)}| = \\left|\\left(\\frac{\\Delta}{2} + \\delta\\right) - \\frac{\\Delta}{2}\\right| = |\\delta| = 1.0 \\times 10^{-10} \\, \\mathrm{Hartree}\n$$\n我们将其与能量变化阈值 $\\tau_{E} = 1.0 \\times 10^{-8} \\, \\mathrm{Hartree}$ 进行比较。由于 $1.0 \\times 10^{-10}  1.0 \\times 10^{-8}$，能量收敛判据 $|E^{(n+1)} - E^{(n)}|  \\tau_{E}$ 得到满足。\n\n**任务2：残差范数计算与收敛性判断**\n\n自洽平稳性条件是对易子 $[F^{(n)}, P^{(n)}]$ 为零。我们计算这个对易子。首先，我们需要计算乘积 $P^{(n)} F^{(n)}$：\n$$\nP^{(n)} F^{(n)} = \\begin{pmatrix} \\frac{1}{2}  \\frac{1}{2} \\\\ \\frac{1}{2}  \\frac{1}{2} \\end{pmatrix} \\begin{pmatrix} 0  0 \\\\ 0  \\Delta \\end{pmatrix} = \\begin{pmatrix} 0  \\frac{\\Delta}{2} \\\\ 0  \\frac{\\Delta}{2} \\end{pmatrix}\n$$\n该对易子，我们记为 $C^{(n)}$，是：\n$$\nC^{(n)} = [F^{(n)}, P^{(n)}] = F^{(n)} P^{(n)} - P^{(n)} F^{(n)} = \\begin{pmatrix} 0  0 \\\\ \\frac{\\Delta}{2}  \\frac{\\Delta}{2} \\end{pmatrix} - \\begin{pmatrix} 0  \\frac{\\Delta}{2} \\\\ 0  \\frac{\\Delta}{2} \\end{pmatrix} = \\begin{pmatrix} 0  -\\frac{\\Delta}{2} \\\\ \\frac{\\Delta}{2}  0 \\end{pmatrix}\n$$\n残差范数是该对易子的 Frobenius 范数，$\\|C^{(n)}\\|_{\\mathrm{F}} = \\sqrt{\\operatorname{Tr}((C^{(n)})^{\\dagger} C^{(n)})}$。$C^{(n)}$的伴随矩阵为：\n$$\n(C^{(n)})^{\\dagger} = \\begin{pmatrix} 0  \\frac{\\Delta}{2} \\\\ -\\frac{\\Delta}{2}  0 \\end{pmatrix}\n$$\n乘积 $(C^{(n)})^{\\dagger} C^{(n)}$ 为：\n$$\n(C^{(n)})^{\\dagger} C^{(n)} = \\begin{pmatrix} 0  \\frac{\\Delta}{2} \\\\ -\\frac{\\Delta}{2}  0 \\end{pmatrix} \\begin{pmatrix} 0  -\\frac{\\Delta}{2} \\\\ \\frac{\\Delta}{2}  0 \\end{pmatrix} = \\begin{pmatrix} \\frac{\\Delta^2}{4}  0 \\\\ 0  \\frac{\\Delta^2}{4} \\end{pmatrix}\n$$\n该矩阵的迹为：\n$$\n\\operatorname{Tr}((C^{(n)})^{\\dagger} C^{(n)}) = \\frac{\\Delta^2}{4} + \\frac{\\Delta^2}{4} = \\frac{\\Delta^2}{2}\n$$\nFrobenius 范数是该值的平方根：\n$$\n\\|[F^{(n)}, P^{(n)}]\\|_{\\mathrm{F}} = \\sqrt{\\frac{\\Delta^2}{2}} = \\frac{|\\Delta|}{\\sqrt{2}}\n$$\n给定 $\\Delta = 2.0 \\times 10^{-2} \\, \\mathrm{Hartree}$，该范数为：\n$$\n\\|[F^{(n)}, P^{(n)}]\\|_{\\mathrm{F}} = \\frac{2.0 \\times 10^{-2}}{\\sqrt{2}} = \\sqrt{2} \\times 10^{-2} \\, \\mathrm{Hartree}\n$$\n数值上，$\\sqrt{2} \\approx 1.41421356$。因此，范数约为 $1.41421356 \\times 10^{-2} \\, \\mathrm{Hartree}$。\n我们将其与残差阈值 $\\tau_{R} = 1.0 \\times 10^{-3} \\, \\mathrm{Hartree}$ 进行比较。\n$$\n1.414... \\times 10^{-2} > 1.0 \\times 10^{-3}\n$$\n因此，残差范数大于阈值，表明 SCF 过程在第 $n$ 次迭代时并未收敛，尽管能量变化非常小。这说明了能量变化小是 SCF 收敛的必要条件，但不是充分条件。能量相对于轨道旋转的梯度（在此由对易子范数表示）也必须很小。\n\n问题要求提供 Frobenius 范数的数值，并四舍五入到四位有效数字。\n$$\n\\sqrt{2} \\times 10^{-2} \\approx 1.414 \\times 10^{-2}\n$$\n这就是最终的数值结果。", "answer": "$$\\boxed{1.414 \\times 10^{-2}}$$", "id": "2804024"}]}