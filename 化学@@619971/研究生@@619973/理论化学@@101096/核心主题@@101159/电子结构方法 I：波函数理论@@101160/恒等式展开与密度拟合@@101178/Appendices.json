{"hands_on_practices": [{"introduction": "恒等式分辨 (RI) 近似的核心在于用一个辅助基组来拟合乘积密度。本练习将带您回到第一性原理，要求您推导由最小二乘法最小化所产生的拟合系数方程。通过一个包含重叠度规和库仑度规的具体例子，您将亲身体会到度规的选择如何从根本上改变数学形式和最终的近似结果 [@problem_id:2802051]。", "problem": "考虑在辅助基 $\\{\\chi_{P}(\\mathbf{r})\\}_{P=1}^{2}$ 中对乘积密度 $\\,\\rho(\\mathbf{r}) = \\varphi_{1}(\\mathbf{r})\\,\\varphi_{2}(\\mathbf{r})\\,$ 进行单位分解 (RI) 密度拟合 (DF) 近似。设近似式为 $\\tilde{\\rho}(\\mathbf{r}) = \\sum_{P=1}^{2} c_{P}\\,\\chi_{P}(\\mathbf{r})$，其中系数 $\\{c_{P}\\}$ 是通过最小化残差相对于一个定义了函数内积的正定双线性形式 $(\\cdot|\\cdot)_{M}$ 的平方范数来确定的。考虑两种度规：\n\n1. 重叠度规，其形式为 $(f|g)_{S} = \\int f(\\mathbf{r})\\,g(\\mathbf{r})\\,\\mathrm{d}\\mathbf{r}$。\n2. 库仑度规，其形式为 $(f|g)_{J} = \\int\\int f(\\mathbf{r})\\,|\\mathbf{r}-\\mathbf{r}'|^{-1}\\,g(\\mathbf{r}')\\,\\mathrm{d}\\mathbf{r}\\,\\mathrm{d}\\mathbf{r}'$。\n\n设辅助基中的度规矩阵、$\\rho$ 在辅助基上的投影向量以及 $\\rho$ 的自内积由下式给出：\n$$\n\\mathbf{S} \\equiv \\big[(\\chi_{P}|\\chi_{Q})_{S}\\big] =\n\\begin{pmatrix}\n1 & \\tfrac{1}{5} \\\\\n\\tfrac{1}{5} & \\tfrac{4}{5}\n\\end{pmatrix},\\qquad\n\\mathbf{J} \\equiv \\big[(\\chi_{P}|\\chi_{Q})_{J}\\big] =\n\\begin{pmatrix}\n\\tfrac{3}{2} & \\tfrac{3}{10} \\\\\n\\tfrac{3}{10} & \\tfrac{6}{5}\n\\end{pmatrix},\n$$\n$$\n\\mathbf{d}_{S} \\equiv \\big[(\\chi_{P}|\\rho)_{S}\\big] =\n\\begin{pmatrix}\n\\tfrac{1}{2} \\\\ \\tfrac{1}{10}\n\\end{pmatrix},\\qquad\n\\mathbf{d}_{J} \\equiv \\big[(\\chi_{P}|\\rho)_{J}\\big] =\n\\begin{pmatrix}\n\\tfrac{3}{5} \\\\ \\tfrac{1}{20}\n\\end{pmatrix},\n$$\n$$\nt_{S} \\equiv (\\rho|\\rho)_{S} = \\tfrac{2}{5},\\qquad\nt_{J} \\equiv (\\rho|\\rho)_{J} = \\tfrac{11}{20}.\n$$\n\n从内积空间中最小二乘最小化的定义出发，推导每种度规下最优 DF 系数的正规方程，并求出相应的最优系数 $\\mathbf{c}_{S}$ 和 $\\mathbf{c}_{J}$。仅使用变分最小化和内积的第一性原理，推导每种度规下最小化平方误差的表达式，并利用上述数据计算这些值。最后，计算比值\n$$\nR \\equiv \\frac{\\|\\rho - \\tilde{\\rho}_{S}\\|_{S}}{\\|\\rho - \\tilde{\\rho}_{J}\\|_{J}},\n$$\n其中 $\\|\\cdot\\|_{M}$ 是由 $(\\cdot|\\cdot)_{M}$ 诱导的范数，而 $\\tilde{\\rho}_{S}$ 和 $\\tilde{\\rho}_{J}$ 分别是重叠度规和库仑度规下的最优 DF 近似。将 $R$ 的最终答案表示为一个精确的代数表达式（不要小数化，也不要包含单位）。", "solution": "我们在一个由正定双线性形式 $(\\cdot|\\cdot)_{M}$ 诱导的希尔伯特空间框架下进行计算，该双线性形式定义了一个内积和相应的范数 $\\|f\\|_{M} \\equiv \\sqrt{(f|f)_{M}}$。给定辅助基 $\\{\\chi_{P}\\}_{P=1}^{2}$ 和一个近似 $\\tilde{\\rho} = \\sum_{P} c_{P}\\chi_{P}$，在度规 M 下的平方误差为\n$$\nE_{M}^{2}(\\mathbf{c}) \\equiv \\|\\rho - \\tilde{\\rho}\\|_{M}^{2}\n= (\\rho - \\chi \\mathbf{c} \\,|\\, \\rho - \\chi \\mathbf{c})_{M},\n$$\n其中 $\\chi$ 是从系数向量到函数的线性映射，$\\chi \\mathbf{c} \\equiv \\sum_{P} c_{P}\\chi_{P}$。利用双线性性和对称性展开该二次型，得到\n$$\nE_{M}^{2}(\\mathbf{c}) = (\\rho|\\rho)_{M} - 2\\,\\mathbf{c}^{\\mathsf{T}}\\mathbf{d}_{M} + \\mathbf{c}^{\\mathsf{T}}\\mathbf{M}\\,\\mathbf{c},\n$$\n其中 $\\mathbf{M}$ 是度规矩阵，其元素为 $M_{PQ} = (\\chi_{P}|\\chi_{Q})_{M}$；$\\mathbf{d}_{M}$ 是投影向量，其分量为 $d_{M,P} = (\\chi_{P}|\\rho)_{M}$。通过令关于 $\\mathbf{c}$ 的梯度为零，可以获得最小二乘最小化子的平稳条件：\n$$\n\\frac{\\partial E_{M}^{2}}{\\partial \\mathbf{c}} = -2\\,\\mathbf{d}_{M} + 2\\,\\mathbf{M}\\,\\mathbf{c} = \\mathbf{0}\n\\quad\\Longrightarrow\\quad\n\\mathbf{M}\\,\\mathbf{c} = \\mathbf{d}_{M}.\n$$\n这就是正规方程。由于 $\\mathbf{M}$ 是对称正定的，唯一的最小化子是\n$$\n\\mathbf{c}_{M} = \\mathbf{M}^{-1}\\mathbf{d}_{M}.\n$$\n在最小化子处，将 $\\mathbf{c}_{M}$ 代回二次型，即可得到最小化平方误差：\n$$\nE_{M,\\min}^{2} = (\\rho|\\rho)_{M} - \\mathbf{d}_{M}^{\\mathsf{T}}\\mathbf{c}_{M}\n= t_{M} - \\mathbf{d}_{M}^{\\mathsf{T}}\\,\\mathbf{M}^{-1}\\mathbf{d}_{M}.\n$$\n\n我们现在将这些一般性结果应用于每种度规。\n\n重叠度规。 此处 $\\mathbf{M}=\\mathbf{S}$，$\\mathbf{d}_{M}=\\mathbf{d}_{S}$，且 $t_{M}=t_{S}$。首先计算 $\\mathbf{S}^{-1}$。对于\n$$\n\\mathbf{S} =\n\\begin{pmatrix}\n1 & \\tfrac{1}{5} \\\\\n\\tfrac{1}{5} & \\tfrac{4}{5}\n\\end{pmatrix},\n\\quad\n\\det(\\mathbf{S}) = 1\\cdot\\tfrac{4}{5} - \\tfrac{1}{5}\\cdot\\tfrac{1}{5} = \\tfrac{19}{25},\n$$\n其逆矩阵为\n$$\n\\mathbf{S}^{-1} = \\frac{1}{\\det(\\mathbf{S})}\n\\begin{pmatrix}\n\\tfrac{4}{5} & -\\tfrac{1}{5} \\\\\n-\\tfrac{1}{5} & 1\n\\end{pmatrix}\n= \\frac{25}{19}\n\\begin{pmatrix}\n\\tfrac{4}{5} & -\\tfrac{1}{5} \\\\\n-\\tfrac{1}{5} & 1\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n\\tfrac{20}{19} & -\\tfrac{5}{19} \\\\\n-\\tfrac{5}{19} & \\tfrac{25}{19}\n\\end{pmatrix}.\n$$\n因此\n$$\n\\mathbf{c}_{S} = \\mathbf{S}^{-1}\\mathbf{d}_{S}\n=\n\\begin{pmatrix}\n\\tfrac{20}{19} & -\\tfrac{5}{19} \\\\\n-\\tfrac{5}{19} & \\tfrac{25}{19}\n\\end{pmatrix}\n\\begin{pmatrix}\n\\tfrac{1}{2} \\\\ \\tfrac{1}{10}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n\\tfrac{19}{38} \\\\ 0\n\\end{pmatrix}.\n$$\n最小化平方误差为\n$$\nE_{S,\\min}^{2} = t_{S} - \\mathbf{d}_{S}^{\\mathsf{T}}\\,\\mathbf{c}_{S}\n= \\tfrac{2}{5} - \\left(\\tfrac{1}{2}\\cdot\\tfrac{19}{38} + \\tfrac{1}{10}\\cdot 0\\right)\n= \\tfrac{2}{5} - \\tfrac{19}{76}.\n$$\n通分后，\n$$\n\\tfrac{2}{5} = \\tfrac{152}{380},\\quad \\tfrac{19}{76} = \\tfrac{95}{380}\n\\;\\Longrightarrow\\;\nE_{S,\\min}^{2} = \\tfrac{152}{380} - \\tfrac{95}{380} = \\tfrac{57}{380} = \\tfrac{3}{20}.\n$$\n\n库仑度规。 此处 $\\mathbf{M}=\\mathbf{J}$，$\\mathbf{d}_{M}=\\mathbf{d}_{J}$，且 $t_{M}=t_{J}$。计算 $\\mathbf{J}^{-1}$。对于\n$$\n\\mathbf{J} =\n\\begin{pmatrix}\n\\tfrac{3}{2} & \\tfrac{3}{10} \\\\\n\\tfrac{3}{10} & \\tfrac{6}{5}\n\\end{pmatrix},\n\\quad\n\\det(\\mathbf{J}) = \\tfrac{3}{2}\\cdot\\tfrac{6}{5} - \\left(\\tfrac{3}{10}\\right)^{2}\n= \\tfrac{18}{10} - \\tfrac{9}{100} = \\tfrac{171}{100},\n$$\n其逆矩阵为\n$$\n\\mathbf{J}^{-1} = \\frac{1}{\\det(\\mathbf{J})}\n\\begin{pmatrix}\n\\tfrac{6}{5} & -\\tfrac{3}{10} \\\\\n-\\tfrac{3}{10} & \\tfrac{3}{2}\n\\end{pmatrix}\n= \\frac{100}{171}\n\\begin{pmatrix}\n\\tfrac{6}{5} & -\\tfrac{3}{10} \\\\\n-\\tfrac{3}{10} & \\tfrac{3}{2}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n\\tfrac{40}{57} & -\\tfrac{10}{57} \\\\\n-\\tfrac{10}{57} & \\tfrac{50}{57}\n\\end{pmatrix}.\n$$\n因此\n$$\n\\mathbf{c}_{J} = \\mathbf{J}^{-1}\\mathbf{d}_{J}\n=\n\\begin{pmatrix}\n\\tfrac{40}{57} & -\\tfrac{10}{57} \\\\\n-\\tfrac{10}{57} & \\tfrac{50}{57}\n\\end{pmatrix}\n\\begin{pmatrix}\n\\tfrac{3}{5} \\\\ \\tfrac{1}{20}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n\\tfrac{47}{114} \\\\ -\\tfrac{7}{114}\n\\end{pmatrix}.\n$$\n最小化平方误差为\n$$\nE_{J,\\min}^{2} = t_{J} - \\mathbf{d}_{J}^{\\mathsf{T}}\\,\\mathbf{c}_{J}\n= \\tfrac{11}{20} - \\left(\\tfrac{3}{5}\\cdot\\tfrac{47}{114} + \\tfrac{1}{20}\\cdot\\left(-\\tfrac{7}{114}\\right)\\right).\n$$\n计算点积：\n$$\n\\tfrac{3}{5}\\cdot\\tfrac{47}{114} = \\tfrac{141}{570} = \\tfrac{47}{190},\\qquad\n\\tfrac{1}{20}\\cdot\\left(-\\tfrac{7}{114}\\right) = -\\tfrac{7}{2280},\n$$\n所以\n$$\n\\mathbf{d}_{J}^{\\mathsf{T}}\\,\\mathbf{c}_{J} = \\tfrac{47}{190} - \\tfrac{7}{2280}\n= \\frac{47\\cdot 12}{2280} - \\frac{7}{2280} = \\frac{564 - 7}{2280} = \\frac{557}{2280}.\n$$\n因此，\n$$\nE_{J,\\min}^{2} = \\tfrac{11}{20} - \\tfrac{557}{2280}\n= \\frac{11\\cdot 114}{2280} - \\frac{557}{2280}\n= \\frac{1254 - 557}{2280} = \\frac{697}{2280}.\n$$\n\n所求的误差范数比值为\n$$\nR \\equiv \\frac{\\|\\rho - \\tilde{\\rho}_{S}\\|_{S}}{\\|\\rho - \\tilde{\\rho}_{J}\\|_{J}}\n= \\sqrt{\\frac{E_{S,\\min}^{2}}{E_{J,\\min}^{2}}}\n= \\sqrt{\\frac{\\tfrac{3}{20}}{\\tfrac{697}{2280}}}\n= \\sqrt{\\frac{3}{20}\\cdot\\frac{2280}{697}}\n= \\sqrt{\\frac{6840}{13940}}\n= \\sqrt{\\frac{342}{697}}.\n$$\n这已经是精确的简化代数形式。", "answer": "$$\\boxed{\\sqrt{\\frac{342}{697}}}$$", "id": "2802051"}, {"introduction": "重叠度规和库仑度规之间的选择不仅仅是数学上的偏好；它对计算出的能量有着深远的影响。虽然库仑度规保证了近似的哈特里能量 $J$ 是精确值的上界，但计算上更简单的重叠度规却并非如此。本实践挑战您构建一个明确的数值反例，以巩固您对这一关键理论要点及其在方法开发中实际意义的理解 [@problem_id:2802034]。", "problem": "在电子结构理论中，对于库仑（哈特里）能量的恒等分辨（RI）和密度拟合（DF）近似，可以选择重叠度规或库仑度规来在辅助基组中拟合密度。考虑两个真实的、正交归一的且在空间上良好分离的分子轨道，记为 $\\chi_{a}(\\mathbf{r})$ 和 $\\chi_{b}(\\mathbf{r})$，每个轨道被一个电子占据。目标电子密度为 $\\rho(\\mathbf{r}) = \\chi_{a}(\\mathbf{r})^{2} + \\chi_{b}(\\mathbf{r})^{2}$。哈特里能量由第一性原理定义为\n$$\nJ[\\rho] = \\frac{1}{2} \\iint \\frac{\\rho(\\mathbf{r})\\,\\rho(\\mathbf{r}')}{|\\mathbf{r}-\\mathbf{r}'|}\\, d\\mathbf{r}\\, d\\mathbf{r}'.\n$$\n给定以下预先计算好的、物理上合理的积分：\n- 密度的重叠内积（$L^{2}$ 度规）：$\\int \\chi_{a}(\\mathbf{r})^{4}\\, d\\mathbf{r} = 0.80$，$\\int \\chi_{b}(\\mathbf{r})^{4}\\, d\\mathbf{r} = 0.70$，以及交叉项 $\\int \\chi_{a}(\\mathbf{r})^{2}\\,\\chi_{b}(\\mathbf{r})^{2}\\, d\\mathbf{r} = 0.05$。\n- 库仑内积（库仑度规）：$(aa|aa) = \\iint \\frac{\\chi_{a}(\\mathbf{r})^{2}\\,\\chi_{a}(\\mathbf{r}')^{2}}{|\\mathbf{r}-\\mathbf{r}'|}\\, d\\mathbf{r}\\, d\\mathbf{r}' = 1.20$，$(bb|bb) = 0.80$，以及 $(aa|bb) = \\iint \\frac{\\chi_{a}(\\mathbf{r})^{2}\\,\\chi_{b}(\\mathbf{r}')^{2}}{|\\mathbf{r}-\\mathbf{r}'|}\\, d\\mathbf{r}\\, d\\mathbf{r}' = 0.05$。所有库仑积分均以哈特里单位 $(E_{h})$ 给出。\n\n假设用于密度拟合的辅助基组仅包含一个函数 $b_{1}(\\mathbf{r}) = \\chi_{a}(\\mathbf{r})^{2}$。在重叠度规的密度拟合中，拟合密度为 $\\rho_{\\text{fit}}(\\mathbf{r}) = c\\, b_{1}(\\mathbf{r})$，其中选择系数 $c$ 以最小化重叠度规中的平方误差，即最小化 $\\int \\left(\\rho(\\mathbf{r}) - c\\,b_{1}(\\mathbf{r})\\right)^{2}\\, d\\mathbf{r}$。然后通过将 $\\rho_{\\text{fit}}$ 代入哈特里泛函来计算密度拟合的哈特里能量：\n$$\nJ_{\\text{DF}} = \\frac{1}{2} \\iint \\frac{\\rho_{\\text{fit}}(\\mathbf{r})\\,\\rho_{\\text{fit}}(\\mathbf{r}')}{|\\mathbf{r}-\\mathbf{r}'|}\\, d\\mathbf{r}\\, d\\mathbf{r}'.\n$$\n\n仅使用给定数据和第一性原理定义，构建这个明确的反例，以表明重叠度规的密度拟合低估了哈特里能量，并量化其差异\n$$\n\\Delta J \\equiv J_{\\text{DF}} - J_{\\text{exact}},\n$$\n其中 $J_{\\text{exact}} \\equiv J[\\rho]$。将 $\\Delta J$ 以单个实数形式给出。将最终数值答案四舍五入至四位有效数字。能量以哈特里单位 $(E_{h})$ 表示。", "solution": "任务是计算差异 $\\Delta J = J_{\\text{DF}} - J_{\\text{exact}}$。这需要分别计算精确的哈特里能量 $J_{\\text{exact}}$ 和密度拟合的哈特里能量 $J_{\\text{DF}}$。\n\n首先，我们计算精确的哈特里能量 $J_{\\text{exact}}$。\n精确密度为 $\\rho(\\mathbf{r}) = \\chi_{a}(\\mathbf{r})^{2} + \\chi_{b}(\\mathbf{r})^{2}$。将其代入哈特里能量泛函中：\n$$\nJ_{\\text{exact}} = \\frac{1}{2} \\iint \\frac{\\left(\\chi_{a}(\\mathbf{r})^{2} + \\chi_{b}(\\mathbf{r})^{2}\\right)\\left(\\chi_{a}(\\mathbf{r}')^{2} + \\chi_{b}(\\mathbf{r}')^{2}\\right)}{|\\mathbf{r}-\\mathbf{r}'|}\\, d\\mathbf{r}\\, d\\mathbf{r}'\n$$\n展开分子中的乘积得到四项：\n$$\nJ_{\\text{exact}} = \\frac{1}{2} \\left[ \\iint \\frac{\\chi_{a}(\\mathbf{r})^{2}\\chi_{a}(\\mathbf{r}')^{2}}{|\\mathbf{r}-\\mathbf{r}'|}\\, d\\mathbf{r}d\\mathbf{r}' + \\iint \\frac{\\chi_{a}(\\mathbf{r})^{2}\\chi_{b}(\\mathbf{r}')^{2}}{|\\mathbf{r}-\\mathbf{r}'|}\\, d\\mathbf{r}d\\mathbf{r}' + \\iint \\frac{\\chi_{b}(\\mathbf{r})^{2}\\chi_{a}(\\mathbf{r}')^{2}}{|\\mathbf{r}-\\mathbf{r}'|}\\, d\\mathbf{r}d\\mathbf{r}' + \\iint \\frac{\\chi_{b}(\\mathbf{r})^{2}\\chi_{b}(\\mathbf{r}')^{2}}{|\\mathbf{r}-\\mathbf{r}'|}\\, d\\mathbf{r}d\\mathbf{r}' \\right]\n$$\n这些积分对应于所提供的库仑积分。使用标准符号 $(ij|kl) = \\iint \\frac{\\chi_i(\\mathbf{r})\\chi_j(\\mathbf{r})\\chi_k(\\mathbf{r}')\\chi_l(\\mathbf{r}')}{|\\mathbf{r}-\\mathbf{r}'|}\\, d\\mathbf{r}d\\mathbf{r}'$，$J_{\\text{exact}}$ 的表达式变为：\n$$\nJ_{\\text{exact}} = \\frac{1}{2} \\left[ (aa|aa) + (aa|bb) + (bb|aa) + (bb|bb) \\right]\n$$\n由于轨道是实函数，积分对于交换竖线前后的指标是对称的，即 $(bb|aa) = (aa|bb)$。因此：\n$$\nJ_{\\text{exact}} = \\frac{1}{2} \\left[ (aa|aa) + 2(aa|bb) + (bb|bb) \\right]\n$$\n代入给定的数值：\n$$\nJ_{\\text{exact}} = \\frac{1}{2} \\left[ 1.20 + 2(0.05) + 0.80 \\right] = \\frac{1}{2} \\left[ 1.20 + 0.10 + 0.80 \\right] = \\frac{1}{2} (2.10) = 1.05 \\, E_h\n$$\n接下来，我们确定密度拟合的能量 $J_{\\text{DF}}$。这首先需要找到拟合密度 $\\rho_{\\text{fit}}(\\mathbf{r}) = c\\,b_{1}(\\mathbf{r})$ 的系数 $c$。系数 $c$ 通过最小化重叠度规中的平方误差来确定：\n$$\nE[c] = \\int \\left(\\rho(\\mathbf{r}) - \\rho_{\\text{fit}}(\\mathbf{r})\\right)^{2}\\, d\\mathbf{r} = \\int \\left(\\rho(\\mathbf{r}) - c\\,b_{1}(\\mathbf{r})\\right)^{2}\\, d\\mathbf{r}\n$$\n为了找到最小值，我们将关于 $c$ 的导数设为零：\n$$\n\\frac{dE}{dc} = \\int 2\\left(\\rho(\\mathbf{r}) - c\\,b_{1}(\\mathbf{r})\\right)(-b_{1}(\\mathbf{r}))\\, d\\mathbf{r} = 0\n$$\n$$\n-2 \\int \\rho(\\mathbf{r})\\,b_{1}(\\mathbf{r})\\, d\\mathbf{r} + 2c \\int b_{1}(\\mathbf{r})^{2}\\, d\\mathbf{r} = 0\n$$\n解出 $c$ 得到标准的最小二乘解：\n$$\nc = \\frac{\\int \\rho(\\mathbf{r})\\,b_{1}(\\mathbf{r})\\, d\\mathbf{r}}{\\int b_{1}(\\mathbf{r})^{2}\\, d\\mathbf{r}}\n$$\n我们分别计算分子和分母。辅助函数是 $b_{1}(\\mathbf{r}) = \\chi_{a}(\\mathbf{r})^{2}$。\n分母是：\n$$\n\\int b_{1}(\\mathbf{r})^{2}\\, d\\mathbf{r} = \\int \\left(\\chi_{a}(\\mathbf{r})^{2}\\right)^{2}\\, d\\mathbf{r} = \\int \\chi_{a}(\\mathbf{r})^{4}\\, d\\mathbf{r} = 0.80\n$$\n分子是，代入 $\\rho(\\mathbf{r}) = \\chi_{a}(\\mathbf{r})^{2} + \\chi_{b}(\\mathbf{r})^{2}$：\n$$\n\\int \\rho(\\mathbf{r})\\,b_{1}(\\mathbf{r})\\, d\\mathbf{r} = \\int \\left(\\chi_{a}(\\mathbf{r})^{2} + \\chi_{b}(\\mathbf{r})^{2}\\right)\\chi_{a}(\\mathbf{r})^{2}\\, d\\mathbf{r} = \\int \\chi_{a}(\\mathbf{r})^{4}\\, d\\mathbf{r} + \\int \\chi_{a}(\\mathbf{r})^{2}\\chi_{b}(\\mathbf{r})^{2}\\, d\\mathbf{r}\n$$\n使用所提供的重叠积分：\n$$\n\\int \\rho(\\mathbf{r})\\,b_{1}(\\mathbf{r})\\, d\\mathbf{r} = 0.80 + 0.05 = 0.85\n$$\n现在我们计算系数 $c$：\n$$\nc = \\frac{0.85}{0.80} = \\frac{17}{16} = 1.0625\n$$\n拟合密度为 $\\rho_{\\text{fit}}(\\mathbf{r}) = 1.0625\\, \\chi_{a}(\\mathbf{r})^{2}$。我们现在使用这个拟合密度来计算 $J_{\\text{DF}}$：\n$$\nJ_{\\text{DF}} = \\frac{1}{2} \\iint \\frac{\\rho_{\\text{fit}}(\\mathbf{r})\\,\\rho_{\\text{fit}}(\\mathbf{r}')}{|\\mathbf{r}-\\mathbf{r}'|}\\, d\\mathbf{r}\\, d\\mathbf{r}' = \\frac{1}{2} \\iint \\frac{\\left(c\\,\\chi_{a}(\\mathbf{r})^{2}\\right)\\left(c\\,\\chi_{a}(\\mathbf{r}')^{2}\\right)}{|\\mathbf{r}-\\mathbf{r}'|}\\, d\\mathbf{r}\\, d\\mathbf{r}'\n$$\n$$\nJ_{\\text{DF}} = \\frac{c^{2}}{2} \\iint \\frac{\\chi_{a}(\\mathbf{r})^{2}\\chi_{a}(\\mathbf{r}')^{2}}{|\\mathbf{r}-\\mathbf{r}'|}\\, d\\mathbf{r}\\, d\\mathbf{r}' = \\frac{c^{2}}{2} (aa|aa)\n$$\n代入 $c$ 和 $(aa|aa)$ 的值：\n$$\nJ_{\\text{DF}} = \\frac{(1.0625)^{2}}{2} (1.20) = (1.0625)^{2} (0.60)\n$$\n$$\nJ_{\\text{DF}} = (1.12890625) \\times (0.60) = 0.67734375 \\, E_h\n$$\n最后，我们计算差异 $\\Delta J$：\n$$\n\\Delta J = J_{\\text{DF}} - J_{\\text{exact}} = 0.67734375 - 1.05 = -0.37265625 \\, E_h\n$$\n问题要求答案四舍五入到四位有效数字。\n$$\n\\Delta J \\approx -0.3727 \\, E_h\n$$\n负号证实了在这个构造的例子中，重叠度规的密度拟合低估了真实的哈特里能量。", "answer": "$$\n\\boxed{-0.3727}\n$$", "id": "2802034"}, {"introduction": "一个稳健的计算方法不仅需要坚实的理论基础，还需要严格的验证。为密度拟合开发新的辅助基组是量子化学中的一项常见任务，而评估其准确性至关重要。本练习从计算转向方法论，要求您设计一个全面系统的验证方案，该方案能够公正、准确地衡量新基组的性能，并将拟合误差与其他潜在的误差来源分离开来 [@problem_id:2802066]。", "problem": "您已经优化了一套旨在用于恒等式分解 (RI)（也称为密度拟合, DF）的辅助基组，以在 Hartree–Fock (HF) 和 Kohn–Sham 计算中近似库仑部分的双电子排斥积分 (ERIs)。您需要一个验证方案，通过比较 DF 和精确的库仑能量，并量化在化学多样化的分子测试集中 ERIs 的均方根 (RMS) 误差，来评估 DF 的准确性，同时将拟合误差与其他差异来源隔离开来。\n\n作为基本出发点，回想一下，在使用原子轨道 (AO) 基组时，一个用化学家标记法表示的双电子排斥积分是\n$$(\\mu \\nu | \\lambda \\sigma) = \\iint \\phi_{\\mu}(\\mathbf{r}_1)\\,\\phi_{\\nu}(\\mathbf{r}_1)\\,\\frac{1}{r_{12}}\\,\\phi_{\\lambda}(\\mathbf{r}_2)\\,\\phi_{\\sigma}(\\mathbf{r}_2)\\,d\\mathbf{r}_1\\,d\\mathbf{r}_2,$$\n对于给定的 AO 密度矩阵 $P$，其库仑能量泛函为\n$$E_J[P] = \\frac{1}{2} \\sum_{\\mu \\nu \\lambda \\sigma} P_{\\mu \\nu}\\,P_{\\lambda \\sigma}\\,(\\mu \\nu | \\lambda \\sigma).$$\nDF 近似将 $(\\mu \\nu | \\lambda \\sigma)$ 替换为一个近似的 $(\\mu \\nu | \\lambda \\sigma)_{\\mathrm{DF}}$，该近似积分由库仑度规下的辅助基组构建。\n\n所有计算都应为精确处理和 DF 处理采用相同的 AO 基组。假设您可以计算“精确”的四指数 ERIs 至严格的数值阈值，并且您可以使用相同的 AO 基组和选定的辅助基组计算 DF 积分。该方案应明确规定要计算什么、如何计算，以及如何总结测试集的准确性，同时避免来自密度弛豫或与 DF 无关的数值设置的污染。\n\n哪个选项最能描述一个严谨且科学合理的验证方案，该方案直接针对库仑能量和 ERIs 中的 DF 准确性？\n\nA. 选择一个化学多样化的测试集，分子大小涵盖从小到中等，包括中性分子、阳离子、阴离子和在多个质心间距 $R$（例如 $R \\in [2,10]$，单位一致）下的非共价二聚体。对于每个 AO 基组和分子，使用精确的 ERIs 进行一次自洽的 HF 计算，以获得参考 AO 密度矩阵 $P^{\\mathrm{ref}}$。保持 $P^{\\mathrm{ref}}$ 固定，使用精确积分和 DF 积分评估非自洽的库仑能量，\n$$E_J^{\\mathrm{exact}}[P^{\\mathrm{ref}}] \\quad \\text{和} \\quad E_J^{\\mathrm{DF}}[P^{\\mathrm{ref}}],$$\n并记录 $\\Delta E_J = E_J^{\\mathrm{DF}}[P^{\\mathrm{ref}}] - E_J^{\\mathrm{exact}}[P^{\\mathrm{ref}}]$。总结整个测试集的平均绝对误差 (MAE)、最大绝对误差以及每个电子或每个原子的误差。此外，计算唯一的 AO 四重态集合（具有正确的置换对称性）上的 ERI RMS 误差，在精确和 DF 评估中使用相同的筛选和阈值，例如\n$$\\mathrm{RMS} = \\sqrt{\\frac{1}{N_u}\\sum_{\\text{unique } \\mu \\nu \\lambda \\sigma}\\left[(\\mu \\nu | \\lambda \\sigma) - (\\mu \\nu | \\lambda \\sigma)_{\\mathrm{DF}}\\right]^2},$$\n也可选择通过 Frobenius 范数比率报告相对 RMS。对精确和 DF 计算都使用严格且相同的数值阈值（例如，积分截断值 $\\leq 10^{-12}$），并报告跨越不同分子和间距的统计数据（MAE、中位数、最大值）。在多个 AO/辅助基组对上重复此过程。\n\nB. 选择一个单一的小分子（例如，水），并进行两次独立的自洽 HF 计算，一次使用精确的 ERIs，另一次使用 DF。比较最终收敛的总能量（包括交换能和任何其他贡献），并比较自洽的库仑能量和最终的偶极矩。对于 ERIs，计算三指数 DF 张量的 RMS，而不是四指数 ERIs 的 RMS，并使用标准积分阈值（例如，$\\approx 10^{-8}$），允许 DF 和精确计算采用各自的默认筛选方式。\n\nC. 在一小组每个都具有单一几何构型的中性分子上，分别运行自洽的 DF 和精确 HF 计算。仅比较从各自收敛的密度中得到的库仑能量，并总结平均有符号差异。对于积分准确性，仅比较 DF 和精确计算的 Fock 矩阵元素 $J_{\\mu \\nu}$，并计算 $J_{\\mu \\nu}$ 的 RMS；不直接考察四指数 ERIs。为 DF 采用比精确 ERIs 更宽松的数值阈值，以使 DF 运行更快，并避免长程二聚体以减少计算成本。\n\nD. 在一个异构的测试集上，计算精确和 DF ERIs，但在 DF 运行中应用一种激进的筛选，丢弃所有幅度低于 $10^{-6}$ 的积分，而为精确运行保留更严格的阈值。仅量化任何保留积分中的最大绝对误差，不计算能量。为避免与密度相关的复杂性，完全不计算或报告库仑能量；而是报告最大积分误差和低于相对误差容限（例如，$\\leq 1\\%$）的积分比例，并在 DF 和精确计算中使用不同的 AO 收缩方案以最小化内存。\n\n选择最佳选项。", "solution": "我们从双电子排斥积分和库仑能量泛函的定义开始。对于一个固定的 AO 密度矩阵 $P$，库仑能量为\n$$E_J[P] = \\frac{1}{2}\\sum_{\\mu \\nu \\lambda \\sigma} P_{\\mu \\nu}\\,P_{\\lambda \\sigma}\\,(\\mu \\nu | \\lambda \\sigma).$$\nDF 近似将 $(\\mu \\nu | \\lambda \\sigma)$ 替换为 $(\\mu \\nu | \\lambda \\sigma)_{\\mathrm{DF}} = (\\mu \\nu | \\lambda \\sigma) + \\delta_{\\mu \\nu \\lambda \\sigma}$，其中 $\\delta_{\\mu \\nu \\lambda \\sigma}$ 是 DF 拟合误差。\n\n为了将库仑能量中的 DF 误差与其他来源分开，我们分析当密度和积分都可能改变时的能量差异。设 $P^{\\mathrm{ref}}$ 为一个参考密度（来自精确 ERIs 的自洽解），并设 DF 计算产生一个可能不同的密度 $P^{\\mathrm{DF}} = P^{\\mathrm{ref}} + \\Delta P$。在各自密度下评估的精确和 DF 库仑能量为\n$$E_J^{\\mathrm{exact}}[P^{\\mathrm{ref}}] = \\frac{1}{2} P^{\\mathrm{ref}} P^{\\mathrm{ref}}\\,(\\mu \\nu | \\lambda \\sigma), \\quad E_J^{\\mathrm{DF}}[P^{\\mathrm{DF}}] = \\frac{1}{2} (P^{\\mathrm{ref}}+\\Delta P)(P^{\\mathrm{ref}}+\\Delta P)\\,\\big[(\\mu \\nu | \\lambda \\sigma)+\\delta\\big],$$\n这里我们使用了缩写标记法并对 AO 指数求和。展开至小量的一阶可得\n$$E_J^{\\mathrm{DF}}[P^{\\mathrm{DF}}] - E_J^{\\mathrm{exact}}[P^{\\mathrm{ref}}] \\approx \\underbrace{\\frac{1}{2} P^{\\mathrm{ref}} P^{\\mathrm{ref}}\\,\\delta}_{\\text{固定 } P^{\\mathrm{ref}} \\text{ 下的纯 DF 拟合误差}} + \\underbrace{P^{\\mathrm{ref}} \\Delta P\\,(\\mu \\nu | \\lambda \\sigma)}_{\\text{密度弛豫贡献}} + \\text{高阶项}.$$\n因此，除非我们保持 $P$ 固定，否则观察到的能量差异会将 DF 拟合误差与密度弛豫误差混淆。因此，一个用于评估 DF 准确性的严谨方案必须在相同的 $P$（理想情况下为从精确 ERIs自洽计算获得的 $P^{\\mathrm{ref}}$）下评估精确和 DF 库仑能量：\n$$\\Delta E_J \\equiv E_J^{\\mathrm{DF}}[P^{\\mathrm{ref}}] - E_J^{\\mathrm{exact}}[P^{\\mathrm{ref}}] = \\frac{1}{2}\\sum_{\\mu \\nu \\lambda \\sigma} P^{\\mathrm{ref}}_{\\mu \\nu}\\,P^{\\mathrm{ref}}_{\\lambda \\sigma}\\,\\delta_{\\mu \\nu \\lambda \\sigma},$$\n这清晰地度量了通过物理权重 $P^{\\mathrm{ref}}_{\\mu \\nu} P^{\\mathrm{ref}}_{\\lambda \\sigma}$ 映射的 DF 误差。\n\n对于积分准确性，一个反映四指数张量质量的标量度量是误差张量的 Frobenius 范数，通常报告为唯一四重态的均方根 (RMS)：\n$$\\mathrm{RMS} = \\sqrt{\\frac{1}{N_u}\\sum_{\\text{unique } \\mu \\nu \\lambda \\sigma}\\left[ (\\mu \\nu | \\lambda \\sigma) - (\\mu \\nu | \\lambda \\sigma)_{\\mathrm{DF}} \\right]^2}.$$\n此度量要求在 DF 和精确评估中使用相同的 AO 基组、相同的收缩方案和相同的筛选阈值以避免数值偏差。或者，相对 RMS $\\|\\Delta \\mathbf{( \\mu \\nu | \\lambda \\sigma)}\\|_F/\\|\\mathbf{( \\mu \\nu | \\lambda \\sigma)}\\|_F$ 可以为绝对 RMS 提供上下文。\n\n一个全面的方案还必须确保：\n- 测试集的多样性（化学组成、大小、电荷状态），以检验稳健性。\n- 包含多个间距的非共价二聚体，以探测长程库仑行为，这与支撑 DF 的库仑度规直接相关。\n- 在精确和 DF 运行中使用一致且严格的数值阈值（例如，积分截断值 $\\leq 10^{-12}$）和相同的 AO 基组，以防止混淆因素。\n- 总结统计数据，如平均绝对误差 (MAE)、中位数和最大误差，用于 $\\Delta E_J$ 和 RMS 积分，最好按每个电子或每个原子进行归一化以实现尺寸密集性，并在多个 AO/辅助基组对上重复。\n\n基于这些原则，我们分析各个选项：\n\n选项 A：\n- 在精确和 DF 计算中固定 AO 基组。\n- 使用来自精确 ERIs SCF 的参考密度 $P^{\\mathrm{ref}}$，并在相同的 $P^{\\mathrm{ref}}$ 下非自洽地评估精确和 DF 库仑能量，从而分离出 $E_J$ 中的 DF 拟合误差。\n- 直接计算唯一四重态上的四指数 ERIs 的 RMS 误差，使用相同且严格的筛选和阈值，避免了偏差。\n- 采用化学多样化的测试集，并包含多个间距的二聚体，以探测近程和长程行为。\n- 总结整个测试集的 MAE、最大值以及可选的相对统计数据。\n这与原则性推导相符，并且在科学上是合理的。结论：正确。\n\n选项 B：\n- 比较精确和 DF 之间的完全自洽结果，从而将 DF 拟合误差与密度弛豫效应混合；$\\Delta P$ 项污染了 $\\Delta E_J$。\n- 将测试限制在单个小分子上，未能评估稳健性。\n- 使用三指数 DF 张量的 RMS 而不是目标四指数 ERIs 的 RMS，这不能直接量化进入 $E_J$ 的量。\n- 允许使用不同的默认阈值，引入了与 DF 质量无关的数值偏差。\n结论：不正确。\n\n选项 C：\n- 比较来自独立收敛的密度的库仑能量，再次将 DF 拟合误差与 $\\Delta P$ 混淆。\n- 避免四指数 ERIs，而是比较 $J_{\\mu \\nu}$ 矩阵，这些是密度加权的组合；这掩盖了原始 DF 积分的准确性，并取决于特定的 $P$。\n- 使用有限的测试集，并省略了长程二聚体，降低了对库仑度规行为的诊断能力。\n- 使用比精确计算更宽松的 DF 阈值，引入了偏差。\n结论：不正确。\n\n选项 D：\n- 应用不对称的筛选阈值，甚至不同的 AO 收缩方案，使得 DF 与精确的比较成为“苹果对橘子”式的比较。\n- 完全舍弃能量比较，尽管 $E_J$ 是库仑拟合中受 DF 影响的核心属性。\n- 仅报告最大误差和在相对误差下的通过-失败比例，这忽略了整体误差分布和通过 $P$ 的能量权重。\n结论：不正确。\n\n因此，选项 A是唯一一个能够分离库仑能量中的 DF 拟合误差，在公平和严格的数值条件下直接测量四指数 ERI RMS 误差，并在精心选择的测试集和基组组合中评估稳健性的方案。", "answer": "$$\\boxed{A}$$", "id": "2802066"}]}