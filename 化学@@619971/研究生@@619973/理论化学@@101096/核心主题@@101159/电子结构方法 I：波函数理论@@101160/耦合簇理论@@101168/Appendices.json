{"hands_on_practices": [{"introduction": "耦合簇 (Coupled-Cluster, CC) 的振幅方程本质上是复杂的非线性代数方程组。为了深入理解其结构，一个有效的方法是考察其在弱关联极限下的形式，这恰好与微扰理论建立了联系。该练习将引导您从耦合簇振幅方程出发，通过最低阶近似推导出著名的二阶 Møller-Plesset 微扰理论 (MP2) 的双激发振幅表达式 [@problem_id:2766799]。完成这一推导将加深您对这两种重要电子结构方法之间内在关系的理解。", "problem": "考虑一个由正则自旋轨道构成的闭壳层 Hartree-Fock (HF) 参考行列式 $\\lvert \\Phi_{0} \\rangle$，其 Fock 矩阵是对角的，因此单电子 Fock 算符满足 $f \\lvert \\phi_{p} \\rangle = \\epsilon_{p} \\lvert \\phi_{p} \\rangle$，其中 $\\epsilon_{p}$ 为轨道能。使用 Møller–Plesset 划分将电子哈密顿量 $\\hat{H}$ 分解为一个零阶 Fock 部分和一个微扰势，并将相对于 $\\lvert \\Phi_{0} \\rangle$ 的正规排序哈密顿量写作 $\\hat{H}_{N} = \\hat{F}_{N} + \\hat{V}_{N}$。在使用簇算符 $\\hat{T}$ 的耦合簇 (CC) 理论中，振幅方程是通过将相似变换后的哈密顿量 $\\bar{H} = \\exp(-\\hat{T}) \\hat{H}_{N} \\exp(\\hat{T})$ 投影到激发行列式上得到的。关注耦合簇双激发 (CCD) 或耦合簇单双激发 (CCSD) 中的双激发部分，并假设使用正则 HF 轨道，根据 Brillouin 定理，单激发在最低非零阶上没有贡献。\n\n从投影的双激发振幅方程 $0 = \\langle \\Phi_{ij}^{ab} \\rvert \\bar{H} \\lvert \\Phi_{0} \\rangle$ 出发，其中指标 $i,j$ 表示占据轨道，$a,b$ 表示虚轨道，推导双激发振幅 $t_{ij}^{ab}$ 关于反对称化双电子积分和轨道能的最低阶（在微扰势中）解析表达式。清楚地说明你所使用的 Baker–Campbell–Hausdorff 展开的任何截断，并通过微扰理论阶数分析来证明其合理性。将反对称化双电子积分定义为 $\\bar{v}_{ij}^{ab} = \\langle ij \\Vert ab \\rangle$，并以 $\\bar{v}_{ij}^{ab}$ 和集合 $\\{\\epsilon_{p}\\}$ 的形式，为 $t_{ij}^{ab}$ 提供一个单一的闭式解析表达式。\n\n你的最终答案必须是单个闭式解析表达式。不包括单位。无需进行数值计算或四舍五入。", "solution": "本题要求从投影的耦合簇方程出发，推导耦合簇双激发振幅 $t_{ij}^{ab}$ 的最低阶表达式。分析过程将通过采用哈密顿量的 Møller-Plesset (MP) 划分和应用微扰理论阶数分析来进行。\n\n电子哈密顿量 $\\hat{H}$ 被划分为一个零阶 Fock 算符 $\\hat{F}_0$ 和一个一阶微扰势 $\\hat{V}$。在相对于 Hartree-Fock 参考行列式 $|\\Phi_0\\rangle$ 的正规排序形式中，哈密顿量为 $\\hat{H}_N = \\hat{F}_N + \\hat{V}_N$。在这里，$\\hat{F}_N$ 是零阶的，而 $\\hat{V}_N$ 在微扰中是一阶的。耦合簇 (CC) 波函数由 $|\\Psi_{CC}\\rangle = \\exp(\\hat{T})|\\Phi_0\\rangle$ 给出，其中簇算符为 $\\hat{T} = \\hat{T}_1 + \\hat{T}_2 + \\dots$。对于本问题，我们考虑耦合簇双激发 (CCD) 或单双激发 (CCSD)，因此 $\\hat{T} \\approx \\hat{T}_1 + \\hat{T}_2$。\n\n簇算符 $\\hat{T}_2 = \\frac{1}{4} \\sum_{ijab} t_{ij}^{ab} a^\\dagger_a a^\\dagger_b a_j a_i$ 双激发部分的振幅，是通过将相似变换后的薛定谔方程投影到双激发行列式 $|\\Phi_{ij}^{ab}\\rangle = a^\\dagger_a a^\\dagger_b a_j a_i |\\Phi_0\\rangle$ 的空间上确定的。这得到振幅方程：\n$$\n0 = \\langle \\Phi_{ij}^{ab} | \\bar{H} | \\Phi_0 \\rangle\n$$\n其中 $\\bar{H} = \\exp(-\\hat{T}) \\hat{H}_N \\exp(\\hat{T})$。\n\n为了找到 $t_{ij}^{ab}$ 的最低阶表达式，我们使用 Baker–Campbell–Hausdorff (BCH) 公式展开 $\\bar{H}$：\n$$\n\\bar{H} = \\hat{H}_N + [\\hat{H}_N, \\hat{T}] + \\frac{1}{2}[[\\hat{H}_N, \\hat{T}], \\hat{T}] + \\dots\n$$\n将此代入振幅方程得到：\n$$\n0 = \\langle \\Phi_{ij}^{ab} | \\hat{H}_N + [\\hat{H}_N, \\hat{T}] + \\frac{1}{2}[[\\hat{H}_N, \\hat{T}], \\hat{T}] + \\dots | \\Phi_0 \\rangle\n$$\n我们现在基于 MP 划分进行阶数分析。算符和振幅在微扰势中被赋予一个阶数：\n- 正规排序 Fock 算符 $\\hat{F}_N$ 是零阶的，$O(0)$。\n- 正规排序微扰势 $\\hat{V}_N$ 是一阶的，$O(1)$。\n- 因此，$\\hat{H}_N = \\hat{F}_N^{(0)} + \\hat{V}_N^{(1)}$。\n- 簇振幅进行微扰展开：$\\hat{T} = \\hat{T}^{(1)} + \\hat{T}^{(2)} + \\dots$。\n\n对于正则 Hartree-Fock 轨道，Brillouin 定理指出，完整哈密顿量在 HF 行列式和单激发行列式之间的矩阵元为零。这意味着一阶单激发振幅 $t_i^{a(1)}$ 为零。因此，$\\hat{T}_1$ 仅在二阶及更高阶有贡献，$\\hat{T}_1 \\sim O(2)$。然而，双激发振幅具有一阶贡献，因此 $\\hat{T}_2 = \\hat{T}_2^{(1)} + \\hat{T}_2^{(2)} + \\dots$，其中 $\\hat{T}_2^{(1)} \\sim O(1)$。\n\n为了找到 $t_{ij}^{ab}$ 的最低阶（一阶）表达式，我们需要收集展开的振幅方程中所有一阶项。\n\n1.  **第1项：$\\langle \\Phi_{ij}^{ab} | \\hat{H}_N | \\Phi_0 \\rangle$**\n    由于 $\\hat{H}_N = \\hat{F}_N^{(0)} + \\hat{V}_N^{(1)}$，我们有 $\\langle \\Phi_{ij}^{ab} | \\hat{F}_N^{(0)} | \\Phi_0 \\rangle + \\langle \\Phi_{ij}^{ab} | \\hat{V}_N^{(1)} | \\Phi_0 \\rangle$。算符 $\\hat{F}_N$ 是一个单体算符，不能将参考态 $|\\Phi_0\\rangle$ 连接到双激发行列式 $|\\Phi_{ij}^{ab}\\rangle$。因此，$\\langle \\Phi_{ij}^{ab} | \\hat{F}_N | \\Phi_0 \\rangle = 0$。项 $\\langle \\Phi_{ij}^{ab} | \\hat{V}_N | \\Phi_0 \\rangle$ 涉及双体微扰势，它可以将参考态直接耦合到双激发态。根据定义，此矩阵元是反对称化双电子积分 $\\bar{v}_{ij}^{ab} = \\langle ij \\Vert ab \\rangle$。此项是一阶的。\n    $$\n    \\langle \\Phi_{ij}^{ab} | \\hat{H}_N | \\Phi_0 \\rangle = \\bar{v}_{ij}^{ab}\n    $$\n\n2.  **第2项：$\\langle \\Phi_{ij}^{ab} | [\\hat{H}_N, \\hat{T}] | \\Phi_0 \\rangle$**\n    我们将其展开为 $\\langle \\Phi_{ij}^{ab} | [\\hat{F}_N^{(0)} + \\hat{V}_N^{(1)}, \\hat{T}_1 + \\hat{T}_2] | \\Phi_0 \\rangle$。为了获得一阶贡献，我们必须将 $\\hat{H}_N$ 的零阶部分与 $\\hat{T}$ 的一阶部分结合起来。如前所述，$\\hat{T}_1^{(1)}=0$，因此我们只考虑 $\\hat{T}_2^{(1)}$。相关项是 $\\langle \\Phi_{ij}^{ab} | [\\hat{F}_N^{(0)}, \\hat{T}_2^{(1)}] | \\Phi_0 \\rangle$。\n    对易子对参考态的作用是：\n    $$\n    [\\hat{F}_N, \\hat{T}_2]|\\Phi_0\\rangle = \\hat{F}_N \\hat{T}_2 |\\Phi_0\\rangle - \\hat{T}_2 \\hat{F}_N |\\Phi_0\\rangle\n    $$\n    正规排序 Fock 算符湮灭参考真空态，$\\hat{F}_N |\\Phi_0\\rangle = 0$。所以第二项为零。\n    第一项是 $\\hat{F}_N \\hat{T}_2 |\\Phi_0\\rangle$。算符 $\\hat{T}_2$ 作用于参考态，产生双激发行列式的线性组合：$\\hat{T}_2|\\Phi_0\\rangle = \\frac{1}{4} \\sum_{klcd} t_{kl}^{cd} |\\Phi_{kl}^{cd}\\rangle$。\n    对于正则轨道，激发行列式是 $\\hat{F}_N$ 的本征态：\n    $$\n    \\hat{F}_N |\\Phi_{kl}^{cd}\\rangle = (\\epsilon_c + \\epsilon_d - \\epsilon_k - \\epsilon_l) |\\Phi_{kl}^{cd}\\rangle\n    $$\n    因此，矩阵元变为：\n    $$\n    \\langle \\Phi_{ij}^{ab} | \\hat{F}_N \\hat{T}_2 | \\Phi_0 \\rangle = \\frac{1}{4} \\sum_{klcd} t_{kl}^{cd} (\\epsilon_c + \\epsilon_d - \\epsilon_k - \\epsilon_l) \\langle \\Phi_{ij}^{ab} | \\Phi_{kl}^{cd} \\rangle\n    $$\n    由于行列式的正交性，求和中唯一保留下来的项是当 $(k,l)$ 是 $(i,j)$ 的一个排列且 $(c,d)$ 是 $(a,b)$ 的一个排列时。在考虑到振幅和行列式的反对称性后，此表达式简化为：\n    $$\n    \\langle \\Phi_{ij}^{ab} | [\\hat{F}_N, \\hat{T}_2^{(1)}] | \\Phi_0 \\rangle = t_{ij}^{ab(1)} (\\epsilon_a + \\epsilon_b - \\epsilon_i - \\epsilon_j)\n    $$\n    此项是一阶的 ($O(0) \\times O(1)$)。\n\n3.  **高阶项**\n    BCH 展开中的所有其他项都是二阶或更高阶的。例如：\n    - $\\langle \\Phi_{ij}^{ab} | [\\hat{V}_N^{(1)}, \\hat{T}^{(1)}] | \\Phi_0 \\rangle$ 是二阶的。\n    - $\\langle \\Phi_{ij}^{ab} | [[\\hat{F}_N^{(0)}, \\hat{T}^{(1)}], \\hat{T}^{(1)}] | \\Phi_0 \\rangle$ 是二阶的。\n    在最低阶推导中，这些项可以被合理地忽略。因此，对于一阶微扰分析，将 BCH 展开在第一项对易子（加上裸哈密顿量）之后截断是合理的。\n\n**组合最低阶方程**\n收集所有一阶项，双激发振幅方程变为：\n$$\n0 = \\bar{v}_{ij}^{ab} + t_{ij}^{ab(1)} (\\epsilon_a + \\epsilon_b - \\epsilon_i - \\epsilon_j)\n$$\n求解一阶双激发振幅 $t_{ij}^{ab(1)}$ 得到：\n$$\nt_{ij}^{ab(1)} (\\epsilon_i + \\epsilon_j - \\epsilon_a - \\epsilon_b) = \\bar{v}_{ij}^{ab}\n$$\n$$\nt_{ij}^{ab(1)} = \\frac{\\bar{v}_{ij}^{ab}}{\\epsilon_i + \\epsilon_j - \\epsilon_a - \\epsilon_b}\n$$\n该表达式是双激发振幅 $t_{ij}^{ab}$ 的最低阶近似，并且与二阶 Møller-Plesset 微扰理论 (MP2) 中的双激发振幅表达式相同。", "answer": "$$\n\\boxed{\\frac{\\bar{v}_{ij}^{ab}}{\\epsilon_{i} + \\epsilon_{j} - \\epsilon_{a} - \\epsilon_{b}}}\n$$", "id": "2766799"}, {"introduction": "在了解了微扰极限后，我们现在将探索非线性耦合簇 ansatz 的全部威力。本练习采用一个极简的双电子、双轨道系统，这个模型足够简单，可以完全手动求解 [@problem_id:2766789]。在此类系统中，指数 ansatz 可以被完整展开，振幅方程也能得到解析解，从而证明耦合簇单双激发 (CCSD) 方法是精确的，即等价于完全组态相互作用 (FCI)。这个动手推导能让您深刻体会到为何耦合簇理论如此精确——因为它正确地处理了特定类型的电子关联至无穷阶，同时这也是一个在具体场景下处理 Baker–Campbell–Hausdorff 展开的绝佳练习。", "problem": "考虑一个在正则限制性 Hartree-Fock (RHF) 自旋轨道基中描述的闭壳层双电子体系，该体系恰好有一个双占据空间轨道 $i$ 和一个虚空间轨道 $a$。令 $|\\Phi_{0}\\rangle$ 表示 RHF 参考行列式（两个电子均处于轨道 $i$ 且自旋相反），并令唯一的双激发行列式为 $|\\Phi_{2}\\rangle \\equiv |\\Phi_{i i}^{a a}\\rangle$（两个电子均被提升至轨道 $a$ 且自旋相反）。使用二次量子化形式的电子哈密顿算符 $\\hat{H}$，并定义矩阵元 $H_{00} \\equiv \\langle \\Phi_{0}|\\hat{H}|\\Phi_{0}\\rangle$，$H_{22} \\equiv \\langle \\Phi_{2}|\\hat{H}|\\Phi_{2}\\rangle$ 和 $H_{20} \\equiv \\langle \\Phi_{2}|\\hat{H}|\\Phi_{0}\\rangle = \\langle \\Phi_{0}|\\hat{H}|\\Phi_{2}\\rangle$。\n\n从耦合簇拟设 $|\\Psi\\rangle = \\exp(\\hat{T})|\\Phi_{0}\\rangle$（其中簇算符为 $\\hat{T} = \\hat{T}_{1} + \\hat{T}_{2}$）出发，按以下步骤进行：\n\n- 仅使用耦合簇理论的基本定义（指数拟设、相似性变换哈密顿算符 $\\bar{H} \\equiv \\exp(-\\hat{T}) \\hat{H} \\exp(\\hat{T})$ 和投影方程）以及正则 RHF 性质。从第一性原理出发，推导在该体系中单激发振幅为零，因此 $\\hat{T}_{1} = 0$，并且仅存一个独立的双激发振幅 $t \\equiv t_{i\\alpha\\, i\\beta}^{a\\alpha\\, a\\beta}$。\n\n- 利用此双行列式子空间的有限维结构和 Baker–Campbell–Hausdorff 展开，证明对于此体系，Baker–Campbell–Hausdorff 级数在双对易子处精确截断，并从投影振幅条件 $\\langle \\Phi_{2}| \\bar{H} |\\Phi_{0}\\rangle = 0$ 中得到关于 $t$ 的闭合 Riccati 型方程。\n\n- 根据 $E = \\langle \\Phi_{0}| \\bar{H} |\\Phi_{0}\\rangle$，用 $t$ 和上述定义的哈密顿矩阵元推导出单双激发耦合簇 (CCSD) 的能量。\n\n- 通过与 $\\{|\\Phi_{0}\\rangle, |\\Phi_{2}\\rangle\\}$ 基中的完全组态相互作用 (FCI) 久期问题进行显式比较，证明对于此双电子体系，CCSD 能量与精确的 FCI 基态能量一致。\n\n您的最终答案必须是仅用 $H_{00}$，$H_{22}$ 和 $H_{20}$ 表示的、关于精确相关基态能量 $E$ 的单一闭合形式解析表达式。最终答案不应包含单位，也不应以不等式或方程形式提供；请提供单一表达式。无需进行数值计算。", "solution": "该问题陈述是一个形式良好且具有科学依据的理论化学练习。它要求对一个最小的双电子、双轨道模型体系，从第一性原理出发推导单双激发耦合簇 (CCSD) 的能量，并与精确的完全组态相互作用 (FCI) 结果进行比较。所有提供的信息都是自洽、一致的，并遵循量子力学和多体理论的既定原理。该问题是有效的。\n\n我们首先分析希尔伯特空间的结构以及簇算符 $\\hat{T} = \\hat{T}_1 + \\hat{T}_2$。该体系包含两个电子，处于一个限制性 Hartree-Fock (RHF) 基态行列式 $|\\Phi_0\\rangle = |i\\alpha, i\\beta\\rangle$ 中，其中 $i$ 是唯一的占据空间轨道。唯一可用的虚空间轨道是 $a$。\n\n精确波函数，即 FCI 波函数 $|\\Psi_{\\text{FCI}}\\rangle$，必须是哈密顿算符 $\\hat{H}$ 和总自旋算符 $\\hat{S}^2$ 的本征函数。由于我们从一个闭壳层单重态 RHF 行列式出发，且哈密顿算符是自旋无关的，因此基态必定是单重态。可能的激发行列式包括单激发和双激发。单激发行列式，如 $|\\Phi_{i\\alpha}^{a\\alpha}\\rangle$，必须组合起来形成自旋匹配组态。\n单重态单激发组态为 ${}^1|\\Phi_{i}^{a}\\rangle = \\frac{1}{\\sqrt{2}}(|\\Phi_{i\\alpha}^{a\\alpha}\\rangle + |\\Phi_{i\\beta}^{a\\beta}\\rangle)$。根据 Brillouin 定理，对于正则 RHF 轨道，哈密顿算符不将参考行列式与单激发行列式耦合：$\\langle {}^1\\Phi_{i}^{a} | \\hat{H} | \\Phi_0 \\rangle = 0$。\n唯一可能的双激发行列式是 $|\\Phi_2\\rangle \\equiv |\\Phi_{ii}^{aa}\\rangle = |a\\alpha, a\\beta\\rangle$，它本身已经是单重态。该行列式通过哈密顿算符的双电子部分与参考态耦合，因此通常情况下 $\\langle \\Phi_2 | \\hat{H} | \\Phi_0 \\rangle = H_{20} \\neq 0$。不存在其他可能的激发。因此，FCI 空间仅由 $\\{|\\Phi_0\\rangle, |\\Phi_2\\rangle\\}$ 张成，精确的基态波函数具有形式 $|\\Psi_{\\text{FCI}}\\rangle = c_0 |\\Phi_0\\rangle + c_2 |\\Phi_2\\rangle$。\n\n耦合簇拟设为 $|\\Psi_{\\text{CC}}\\rangle = \\exp(\\hat{T})|\\Phi_0\\rangle$。将其展开可得：\n$$|\\Psi_{\\text{CC}}\\rangle = (1 + \\hat{T}_1 + \\hat{T}_2 + \\frac{1}{2}\\hat{T}_1^2 + \\dots)|\\Phi_0\\rangle = |\\Phi_0\\rangle + \\hat{T}_1|\\Phi_0\\rangle + \\hat{T}_2|\\Phi_0\\rangle + \\dots$$\n算符 $\\hat{T}_1$ 生成单激发行列式的线性组合。由于这些行列式在精确波函数 $|\\Psi_{\\text{FCI}}\\rangle$ 中不存在，因此它们在 $|\\Psi_{\\text{CC}}\\rangle$ 展开式中的系数必须为零。这要求 $\\hat{T}_1|\\Phi_0\\rangle = 0$，意味着所有单激发振幅均为零。因此，$\\hat{T}_1 = 0$。\n算符 $\\hat{T}_2$ 生成双激发行列式。在此体系中，只可能有一种这样的激发，即从轨道对 $(i,i)$ 到 $(a,a)$。我们将其振幅定义为 $t$。相应的算符为 $\\hat{T}_2 = t \\, a_{a\\alpha}^\\dagger a_{a\\beta}^\\dagger a_{i\\beta} a_{i\\alpha}$。根据此定义，$\\hat{T}_2|\\Phi_0\\rangle = t|\\Phi_2\\rangle$。至此，我们证明了要求的第一个要点。\n\n接下来，我们分析相似性变换哈密顿算符 $\\bar{H} = \\exp(-\\hat{T})\\hat{H}\\exp(\\hat{T})$ 的 Baker-Campbell-Hausdorff (BCH) 展开。当 $\\hat{T}=\\hat{T}_2$ 时，表达式为 $\\bar{H} = \\exp(-\\hat{T}_2)\\hat{H}\\exp(\\hat{T}_2)$。对于此体系，关键的洞见在于算符 $\\hat{T}_2$ 的平方为零。算符 $a_{i\\alpha}$ 湮灭自旋轨道 $i\\alpha$ 上的一个电子。如果我们将 $\\hat{T}_2$ 作用两次，第二次作用将涉及产生算符 $a_{a\\alpha}^\\dagger, a_{a\\beta}^\\dagger$ 作用于一个这些轨道已被占据的状态（在 $|\\Phi_2\\rangle$ 中），根据泡利不相容原理，结果为零。更形式化地，$\\hat{T}_2 = t \\hat{A}$，其中 $\\hat{A} = a_{a\\alpha}^\\dagger a_{a\\beta}^\\dagger a_{i\\beta} a_{i\\alpha}$。由于只有一个虚空间轨道 $a$，$(\\hat{A})^2 = 0$。因此，算符 $\\hat{T}_2$ 是 2 次幂零的：$\\hat{T}_2^2 = 0$。\n这会立即截断指数的泰勒级数：$\\exp(\\hat{T}_2) = 1 + \\hat{T}_2$。\nBCH 级数为 $\\bar{H} = \\hat{H} + [\\hat{H}, \\hat{T}_2] + \\frac{1}{2}[[\\hat{H}, \\hat{T}_2], \\hat{T}_2] + \\frac{1}{6}[[[\\hat{H}, \\hat{T}_2], \\hat{T}_2], \\hat{T}_2] + \\dots$。\n我们来计算对易子：\n$[[\\hat{H}, \\hat{T}_2], \\hat{T}_2] = [\\hat{H}\\hat{T}_2 - \\hat{T}_2\\hat{H}, \\hat{T}_2] = \\hat{H}\\hat{T}_2^2 - \\hat{T}_2\\hat{H}\\hat{T}_2 - \\hat{T}_2\\hat{H}\\hat{T}_2 + \\hat{T}_2^2\\hat{H} = -2\\hat{T}_2\\hat{H}\\hat{T}_2$ （因为 $\\hat{T}_2^2=0$）。\n三重对易子是 $[[[\\hat{H}, \\hat{T}_2], \\hat{T}_2], \\hat{T}_2] = [-2\\hat{T}_2\\hat{H}\\hat{T}_2, \\hat{T}_2] = -2(\\hat{T}_2\\hat{H}\\hat{T}_2^2 - \\hat{T}_2^2\\hat{H}\\hat{T}_2) = 0$。\n所有更高阶的对易子也为零。因此，BCH 级数在双对易子处精确截断：\n$\\bar{H} = \\hat{H} + [\\hat{H}, \\hat{T}_2] - \\hat{T}_2\\hat{H}\\hat{T}_2$。\n或者，$\\bar{H} = (1-\\hat{T}_2)\\hat{H}(1+\\hat{T}_2) = \\hat{H} + \\hat{H}\\hat{T}_2 - \\hat{T}_2\\hat{H} - \\hat{T}_2\\hat{H}\\hat{T}_2$。\n\n现在，我们从投影的薛定谔方程 $\\langle \\Phi_2 | \\bar{H} | \\Phi_0 \\rangle = 0$ 推导振幅 $t$ 的方程。\n$$ \\langle \\Phi_2 | (\\hat{H} + \\hat{H}\\hat{T}_2 - \\hat{T}_2\\hat{H} - \\hat{T}_2\\hat{H}\\hat{T}_2) | \\Phi_0 \\rangle = 0 $$\n我们逐项计算：\n1. $\\langle \\Phi_2 | \\hat{H} | \\Phi_0 \\rangle = H_{20}$。\n2. $\\langle \\Phi_2 | \\hat{H}\\hat{T}_2 | \\Phi_0 \\rangle = \\langle \\Phi_2 | \\hat{H} (t|\\Phi_2\\rangle) = t \\langle \\Phi_2 | \\hat{H} | \\Phi_2 \\rangle = t H_{22}$。\n3. $\\langle \\Phi_2 | \\hat{T}_2\\hat{H} | \\Phi_0 \\rangle = ( \\langle \\Phi_0 | \\hat{H}^\\dagger \\hat{T}_2^\\dagger | \\Phi_2 \\rangle )^*$。由于 $\\hat{H}$ 是厄米算符且矩阵元为实数，这变为 $\\langle \\Phi_0 | \\hat{H} \\hat{T}_2^\\dagger | \\Phi_2 \\rangle$。算符 $\\hat{T}_2^\\dagger = t^* a_{i\\alpha}^\\dagger a_{i\\beta}^\\dagger a_{a\\beta} a_{a\\alpha}$。作用于 $|\\Phi_2\\rangle = a_{a\\alpha}^\\dagger a_{a\\beta}^\\dagger |\\text{vac}\\rangle$ 得到 $\\hat{T}_2^\\dagger |\\Phi_2\\rangle = t^* |\\Phi_0\\rangle$。假设 $t$ 为实数，则结果为 $t|\\Phi_0\\rangle$。该项变为 $\\langle \\Phi_0 | \\hat{H} (t|\\Phi_0\\rangle) = t \\langle \\Phi_0 | \\hat{H} | \\Phi_0 \\rangle = t H_{00}$。\n4. $\\langle \\Phi_2 | \\hat{T}_2\\hat{H}\\hat{T}_2 | \\Phi_0 \\rangle = \\langle \\Phi_2 | \\hat{T}_2\\hat{H} (t|\\Phi_2\\rangle) = t ( \\langle \\Phi_2 | \\hat{T}_2\\hat{H} |\\Phi_2\\rangle )$。使用类似的伴随算符方法，$\\langle \\Phi_2 | \\hat{T}_2\\hat{H} |\\Phi_2\\rangle = (\\langle \\Phi_2 | \\hat{H}^\\dagger \\hat{T}_2^\\dagger |\\Phi_2\\rangle)^* = ( \\langle \\Phi_2 | \\hat{H} (t|\\Phi_0\\rangle) )^* = t H_{20}$。完整的项是 $t(t H_{20}) = t^2 H_{20}$。\n\n将这些结果合并，得到 $t$ 的振幅方程：\n$H_{20} + t H_{22} - t H_{00} - t^2 H_{20} = 0$，这是一个 Riccati 型方程：$H_{20}(1 - t^2) + t(H_{22} - H_{00}) = 0$。\n\nCCSD 能量为 $E = \\langle \\Phi_0 | \\bar{H} | \\Phi_0 \\rangle$。\n$$ E = \\langle \\Phi_0 | (\\hat{H} + \\hat{H}\\hat{T}_2 - \\hat{T}_2\\hat{H} - \\hat{T}_2\\hat{H}\\hat{T}_2) | \\Phi_0 \\rangle $$\n我们计算各项对能量的贡献：\n1. $\\langle \\Phi_0 | \\hat{H} | \\Phi_0 \\rangle = H_{00}$。\n2. $\\langle \\Phi_0 | \\hat{H}\\hat{T}_2 | \\Phi_0 \\rangle = \\langle \\Phi_0 | \\hat{H} (t|\\Phi_2\\rangle) = t \\langle \\Phi_0 | \\hat{H} | \\Phi_2 \\rangle = t H_{02} = t H_{20}$。\n3. $\\langle \\Phi_0 | \\hat{T}_2\\hat{H} | \\Phi_0 \\rangle = 0$，因为 $\\langle \\Phi_0 | \\hat{T}_2 = (\\hat{T}_2^\\dagger |\\Phi_0\\rangle)^\\dagger = 0$，原因是 $\\hat{T}_2^\\dagger$ 包含对虚轨道的湮灭算符，而 $|\\Phi_0\\rangle$ 中没有电子占据这些轨道。\n4. $\\langle \\Phi_0 | \\hat{T}_2\\hat{H}\\hat{T}_2 | \\Phi_0 \\rangle = 0$，原因同上。\n因此，CCSD 能量为 $E = H_{00} + t H_{20}$。\n\n为了找到能量的显式形式，我们求解关于 $t$ 的二次方程：$H_{20} t^2 - (H_{22} - H_{00})t - H_{20} = 0$。\n解为 $t = \\frac{(H_{22} - H_{00}) \\pm \\sqrt{(H_{22} - H_{00})^2 + 4H_{20}^2}}{2H_{20}}$。为了使振幅 $t$ 在相互作用 $H_{20}$ 趋于零时也趋于零，我们必须选择负号。\n$$ t = \\frac{H_{22} - H_{00} - \\sqrt{(H_{22} - H_{00})^2 + 4H_{20}^2}}{2H_{20}} $$\n将此代入能量表达式：\n$$ E = H_{00} + \\left( \\frac{H_{22} - H_{00} - \\sqrt{(H_{22} - H_{00})^2 + 4H_{20}^2}}{2H_{20}} \\right) H_{20} $$\n$$ E = H_{00} + \\frac{H_{22} - H_{00} - \\sqrt{(H_{22} - H_{00})^2 + 4H_{20}^2}}{2} $$\n$$ E = \\frac{2H_{00} + H_{22} - H_{00} - \\sqrt{(H_{22} - H_{00})^2 + 4H_{20}^2}}{2} $$\n$$ E = \\frac{H_{00} + H_{22} - \\sqrt{(H_{22} - H_{00})^2 + 4H_{20}^2}}{2} $$\n\n最后，我们将此结果与 FCI 结果进行比较。在 $\\{|\\Phi_0\\rangle, |\\Phi_2\\rangle\\}$ 基中，FCI 哈密顿量是一个 $2 \\times 2$ 矩阵 $\\mathbf{H} = \\begin{pmatrix} H_{00} & H_{20} \\\\ H_{20} & H_{22} \\end{pmatrix}$。其本征值 $\\lambda$ 可通过久期方程 $\\det(\\mathbf{H} - \\lambda\\mathbf{I}) = 0$ 求得，该方程给出 $(H_{00} - \\lambda)(H_{22} - \\lambda) - H_{20}^2 = 0$。基态能量是较小的那个本征值：\n$$ E_{\\text{FCI}} = \\frac{H_{00} + H_{22} - \\sqrt{(H_{00} + H_{22})^2 - 4(H_{00}H_{22} - H_{20}^2)}}{2} $$\n$$ E_{\\text{FCI}} = \\frac{H_{00} + H_{22} - \\sqrt{(H_{22} - H_{00})^2 + 4H_{20}^2}}{2} $$\n这与我们推导出的 CCSD 能量完全相同。这证实了对于任何双电子体系，CCSD (以及 CCD) 都是精确的。最终的表达式即为精确的相关基态能量。", "answer": "$$\n\\boxed{\\frac{H_{00} + H_{22} - \\sqrt{(H_{22} - H_{00})^{2} + 4H_{20}^{2}}}{2}}\n$$", "id": "2766789"}, {"introduction": "在领略了耦合簇理论的理论优美性和潜在准确性之后，我们必须面对一个关键的实际问题：它的计算成本是多少？像 CCSD 这样的高精度方法伴随着随系统规模多项式增长的巨大计算开销，其标度律为 $\\mathcal{O}(N^6)$，其中 $N$ 是系统尺寸的度量。本练习将引导您分析 CCSD 方程中关键张量收缩步骤的计算标度律 [@problem_id:2766796]。通过对比“朴素”和“优化”的计算路径，您将理解 CCSD 计算的根本瓶颈，并体会到诸如使用中间体等算法创新对于使这些方法在实际中可行是多么重要，这是连接抽象理论与真实世界计算化学的关键一步。", "problem": "考虑在正则Hartree-Fock分子轨道基中，一个闭壳层体系的自旋轨道耦合簇单双激发(CCSD)方程。令$N_o$表示占据轨道的数量，$N_v$表示虚拟轨道的数量。指标$i,j,k,l$标记占据轨道（维度为$N_o$），指标$a,b,c,d$标记虚拟轨道（维度为$N_v$）。令$t_{i}^{a}$和$t_{ij}^{ab}$分别表示单激发和双激发振幅，并令$v_{pq}^{rs} \\equiv \\langle pr \\| qs \\rangle$表示反对称化的双电子积分。重点关注双激发振幅的更新，该更新由“双电子积分与振幅缩并”这种通用形式的张量缩并构成。在整个过程中，以指标循环的基数级别计算浮点乘加运算；忽略常数因子和低阶项，并假设除了已编码在代数中的反对称性外，循环范围没有利用其它对称性。\n\n1) 从CCSD双激发残差的基本张量缩并结构出发，分析以下对双激发更新$r_{ij}^{ab}$有代表性的贡献项的朴素计算代价（以$N_o$和$N_v$的大$\\mathcal{O}$标度表示）：\n- 粒子-粒子阶梯型缩并：$r_{ij}^{ab} \\leftarrow \\sum_{cd} v_{ab}^{cd} \\, t_{ij}^{cd}$。\n- 空穴-空穴阶梯型缩并：$r_{ij}^{ab} \\leftarrow \\sum_{kl} v_{kl}^{ij} \\, t_{kl}^{ab}$。\n- 环/粒子-空穴缩并：$r_{ij}^{ab} \\leftarrow \\sum_{kc} v_{kb}^{ic} \\, t_{jk}^{ac}$，及其指标置换的对应项。\n\n对于每一项，通过明确列出外部（自由指标）循环和内部（缩并指标）循环的大小，然后将这些基数相乘，来推导其渐近运算计数。\n\n2) 众所周知，可以通过引入中间体（例如，通过形成粒子-空穴中间体和Fock修饰的对象）来重组双激发更新的直接逐项评估，从而使任何张量缩并的代价都不会超过与粒子-粒子阶梯型缩并或粒子-空穴（环型）缩并相关的渐近代价。在渐近指标循环计数的层面上，展示如何通过组合项和引入中间体来：\n- 将粒子-粒子阶梯型贡献的代价保持在$\\mathcal{O}(N_o^2 N_v^4)$，并且\n- 将任何朴素的$\\mathcal{O}(N_o^4 N_v^2)$贡献项转化为其主要代价为$\\mathcal{O}(N_o^3 N_v^3)$的缩并，\n从而使得优化的CCSD振幅构建的总体主导代价为$\\mathcal{O}(N_o^2 N_v^4)$和$\\mathcal{O}(N_o^3 N_v^3)$。\n\n你的推理必须从基于指标维度和CCSD双激发残差结构的张量缩并代价定义开始；不要在一开始就假设目标标度。\n\n3) 对于一个具有$N_o = 28$和$N_v = 220$的体系，假设朴素的空穴-空穴阶梯型路径和基于中间体的重组路径具有相同的前置常数，计算其比率\n$$\nR \\equiv \\frac{\\text{朴素空穴-空穴阶梯代价}}{\\text{基于中间体的重组代价}} \\, ,\n$$\n即比较$\\mathcal{O}(N_o^4 N_v^2)$与$\\mathcal{O}(N_o^3 N_v^3)$。将你最终的$R$数值四舍五入到四位有效数字。将$R$表示为一个无单位的纯数。", "solution": "对问题陈述进行验证。\n\n步骤1：提取给定信息\n- 体系：闭壳层分子。\n- 基组：正则Hartree-Fock分子轨道。\n- $N_o$：占据轨道的数量。\n- $N_v$：虚拟轨道的数量。\n- 指标$i,j,k,l$：占据轨道，维度$N_o$。\n- 指标$a,b,c,d$：虚拟轨道，维度$N_v$。\n- 振幅：$t_{i}^{a}$（单激发），$t_{ij}^{ab}$（双激发）。\n- 双电子积分：$v_{pq}^{rs} \\equiv \\langle pr \\| qs \\rangle$。\n- 任务1：分析对双激发残差$r_{ij}^{ab}$的三个特定贡献项的朴素计算代价（大$\\mathcal{O}$）。\n  - 粒子-粒子阶梯项：$r_{ij}^{ab} \\leftarrow \\sum_{cd} v_{ab}^{cd} \\, t_{ij}^{cd}$。\n  - 空穴-空穴阶梯项：$r_{ij}^{ab} \\leftarrow \\sum_{kl} v_{kl}^{ij} \\, t_{kl}^{ab}$。\n  - 环/粒子-空穴项：$r_{ij}^{ab} \\leftarrow \\sum_{kc} v_{kb}^{ic} \\, t_{jk}^{ac}$。\n- 任务2：展示如何通过引入中间体来重组双激发更新，以避免代价高于$\\mathcal{O}(N_o^2 N_v^4)$或$\\mathcal{O}(N_o^3 N_v^3)$，特别是将朴素的$\\mathcal{O}(N_o^4 N_v^2)$贡献项的主导代价降低到$\\mathcal{O}(N_o^3 N_v^3)$。\n- 任务3：对于$N_o = 28$和$N_v = 220$，计算朴素空穴-空穴阶梯代价$\\mathcal{O}(N_o^4 N_v^2)$与重组代价$\\mathcal{O}(N_o^3 N_v^3)$的比率$R$，假设前置因子相等。结果保留四位有效数字。\n\n步骤2：使用提取的给定信息进行验证\n- 问题在科学上是成立的。它涉及耦合簇单双激发(CCSD)理论的计算复杂度，这是现代量子化学的基石。所使用的术语、符号和特定的张量缩并都是该领域的标准。\n- 问题是适定的。它提供了所有必要的定义，并要求获得关于算法标度和基于这些标度律的数值计算的具体、可推导的结果。\n- 问题是客观的。语言技术性强且精确，没有任何主观性或模糊性。\n- 问题是完整的、一致的、可验证的。它没有违反任何物理或数学原理。\n\n步骤3：结论与行动\n问题有效。将提供完整的解答。\n\n张量缩并的计算代价由所有涉及的指标维度的乘积决定。对于一个形式为$C_{\\text{free}} = \\sum_{\\text{summed}} A_{\\dots} B_{\\dots}$的运算，总运算计数与自由指标数量和求和指标数量的乘积成比例。我们将相应地分析每个要求的项。\n\n1) 朴素计算代价分析\n\n令$r_{ij}^{ab}$为双激发振幅的残差。指标$i,j$遍历$N_o$个占据轨道，而$a,b$遍历$N_v$个虚拟轨道。因此，对整个$r_{ij}^{ab}$张量的任何更新都必然需要为这$N_o^2 N_v^2$个自由指标的所有组合计算一个表达式。总代价是这个因子乘以每个元素求和的代价。\n\n- 粒子-粒子阶梯型缩并：更新为$r_{ij}^{ab} \\leftarrow \\sum_{cd} v_{ab}^{cd} \\, t_{ij}^{cd}$。\n自由指标是$i, j, a, b$，从根本上给出$N_o^2 N_v^2$次运算。求和是针对指标$c$和$d$，它们是虚拟轨道指标。这些求和的循环次数达到$N_v$。因此，求和的代价为$\\mathcal{O}(N_v^2)$。\n总计算代价是外部（自由指标）循环和内部（缩并指标）循环的基数的乘积：\n$$\n\\text{Cost}_{pp} \\propto (N_o \\times N_o \\times N_v \\times N_v) \\times (N_v \\times N_v) = N_o^2 N_v^4 \\, .\n$$\n渐近标度为$\\mathcal{O}(N_o^2 N_v^4)$。\n\n- 空穴-空穴阶梯型缩并：更新为$r_{ij}^{ab} \\leftarrow \\sum_{kl} v_{kl}^{ij} \\, t_{kl}^{ab}$。\n自由指标同样是$i, j, a, b$，贡献一个因子$N_o^2 N_v^2$。求和是针对指标$k$和$l$，它们是占据轨道指标。这些求和的循环次数达到$N_o$。求和的代价为$\\mathcal{O}(N_o^2)$。\n总计算代价为：\n$$\n\\text{Cost}_{hh} \\propto (N_o \\times N_o \\times N_v \\times N_v) \\times (N_o \\times N_o) = N_o^4 N_v^2 \\, .\n$$\n渐近标度为$\\mathcal{O}(N_o^4 N_v^2)$。\n\n- 环/粒子-空穴缩并：更新为$r_{ij}^{ab} \\leftarrow \\sum_{kc} v_{kb}^{ic} \\, t_{jk}^{ac}$。\n自由指标是$i, j, a, b$，贡献了$N_o^2 N_v^2$。求和是针对一个占据指标$k$和一个虚拟指标$c$。求和的代价为$\\mathcal{O}(N_o N_v)$。\n总计算代价为：\n$$\n\\text{Cost}_{ring} \\propto (N_o \\times N_o \\times N_v \\times N_v) \\times (N_o \\times N_v) = N_o^3 N_v^3 \\, .\n$$\n渐近标度为$\\mathcal{O}(N_o^3 N_v^3)$。该项的其他指标置换，如$\\sum_{kc} v_{ka}^{ic} t_{jk}^{bc}$，具有相同的结构和标度。\n\n2) 使用中间体重组\n\n对CCSD方程进行直接的、逐项的评估会导致计算标度非常高的步骤，例如$\\mathcal{O}(N_o^4 N_v^2)$的空穴-空穴阶梯项和某些可高达$\\mathcal{O}(N_o^4 N_v^4)$的二次项。优化的实现通过组合项和形成中间体来重组计算，以降低最昂贵步骤的标度。\n\n粒子-粒子阶梯项，标度为$\\mathcal{O}(N_o^2 N_v^4)$，是CCSD的计算瓶颈之一，通常无法通过简单的因式分解来降低。其代价标度保持为$\\mathcal{O}(N_o^2 N_v^4)$。\n\n问题在于如何将朴素标度为$\\mathcal{O}(N_o^4 N_v^2)$的贡献项减少为一系列代价更易于管理的步骤，例如$\\mathcal{O}(N_o^3 N_v^3)$。这不是通过孤立地对单个项进行因式分解来实现的，而是通过对整个方程进行全局重构。通过检查一个朴素代价甚至更高（$\\mathcal{O}(N_o^4 N_v^4)$）的不同项并展示其因式分解，可以最清楚地说明这一通用策略。\n\n考虑出现在CCD残差中的一个代表性的二次项：\n$$\nX_{ij}^{ab} = \\sum_{klcd} v_{kl}^{cd} t_{ik}^{ac} t_{jl}^{bd}\n$$\n朴素的评估涉及对8个指标$i, j, a, b, k, l, c, d$的循环，导致一个不可接受的$\\mathcal{O}(N_o^4 N_v^4)$标度。我们可以通过引入一个中间体并分两个连续步骤执行缩并来降低此代价。\n\n让我们将求和重排为：\n$$\nX_{ij}^{ab} = \\sum_{kc} \\left( \\sum_{ld} v_{kl}^{cd} t_{jl}^{bd} \\right) t_{ik}^{ac}\n$$\n括号中的表达式可以定义为一个中间张量$I_{kc}^{ja}$。请注意，为使此定义有用，中间体的指标不能依赖于括号外的指标。这里的指标是$k, c, j, a$。\n$$\nI_{kc}^{ja} = \\sum_{ld} v_{kl}^{cd} t_{jl}^{bd}\n$$\n步骤1：构建中间体$I_{kc}^{ja}$。自由指标是$k, j$（占据，$N_o$）和$c, a$（虚拟，$N_v$）。求和指标是$l$（占据，$N_o$）和$d$（虚拟，$N_v$）。构建这个中间体的代价是所有参与指标维度的乘积：\n$$\n\\text{Cost}(I) \\propto (N_o \\times N_v \\times N_o \\times N_v) \\times (N_o \\times N_v) = N_o^3 N_v^3\n$$\n中间体$I_{kc}^{ja}$是一个大小为$N_o^2 N_v^2$的张量。\n\n步骤2：将中间体与剩余的振幅张量缩并以计算$X_{ij}^{ab}$：\n$$\nX_{ij}^{ab} = \\sum_{kc} I_{kc}^{ja} t_{ik}^{ac}\n$$\n自由指标是$i, j, a, b$（$N_o^2 N_v^2$个元素）。求和指标是$k$（占据，$N_o$）和$c$（虚拟，$N_v$）。这第二步的代价是：\n$$\n\\text{Cost}(X) \\propto (N_o \\times N_o \\times N_v \\times N_v) \\times (N_o \\times N_v) = N_o^3 N_v^3\n$$\n通过将单个$\\mathcal{O}(N_o^4 N_v^4)$的步骤分解为两个连续的$\\mathcal{O}(N_o^3 N_v^3)$步骤，此贡献项的总体计算标度降低到$\\mathcal{O}(N_o^3 N_v^3)$。\n\n这种通过积分和振幅的缩并来形成中间体的确切原理，是用于处理CCSD方程中所有高阶项的通用策略。虽然空穴-空穴阶梯项$\\sum_{kl} v_{kl}^{ij} t_{kl}^{ab}$在振幅上是线性的，其直接因式分解不那么简单，但在完整的算法中，它是作为更大的复合中间体的一部分来评估的。最终结果是，整个CCSD残差可以在一系列步骤中构建，其中最昂贵的步骤是粒子-粒子阶梯项（$\\mathcal{O}(N_o^2 N_v^4)$）和各种环型缩并（标度为$\\mathcal{O}(N_o^3 N_v^3)$）。因此，在优化的算法中避免了朴素的$\\mathcal{O}(N_o^4 N_v^2)$代价。问题陈述指的是，对于这些“重空穴”项，重组路径的有效主导代价是$\\mathcal{O}(N_o^3 N_v^3)$。\n\n3) 比率计算\n\n我们被要求计算朴素空穴-空穴阶梯代价与同类型贡献的重组、基于中间体路径的代价之比$R$。\n朴素代价的标度为$\\mathcal{O}(N_o^4 N_v^2)$。\n如第2部分所确立的，重组路径的主导标度为$\\mathcal{O}(N_o^3 N_v^3)$。\n问题陈述要求假设标度律的前置常数相等。设此常数为$C$。\n$$\n\\text{Cost}_{\\text{naive}} = C \\cdot N_o^4 N_v^2\n$$\n$$\n\\text{Cost}_{\\text{reorganized}} = C \\cdot N_o^3 N_v^3\n$$\n因此，比率$R$为：\n$$\nR = \\frac{\\text{Cost}_{\\text{naive}}}{\\text{Cost}_{\\text{reorganized}}} = \\frac{C \\cdot N_o^4 N_v^2}{C \\cdot N_o^3 N_v^3} = \\frac{N_o}{N_v}\n$$\n给定值$N_o = 28$和$N_v = 220$：\n$$\nR = \\frac{28}{220} = \\frac{7}{55}\n$$\n将此分数转换为小数值并四舍五入到四位有效数字：\n$$\nR \\approx 0.12727272... \\approx 0.1273\n$$\n这表明通过重组计算可以实现显著的计算节省，特别是对于虚拟轨道数$N_v$远超占据轨道数$N_o$的体系，而这正是典型情况。", "answer": "$$\\boxed{0.1273}$$", "id": "2766796"}]}