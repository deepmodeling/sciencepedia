{"hands_on_practices": [{"introduction": "无限制哈特里-福克(UHF)方法的一个关键特征（也是一个潜在的缺陷）是其波函数通常不是纯自旋态。评估这种“自旋污染”的程度对于判断计算结果的可靠性至关重要。本练习将通过直接使用分子轨道系数矩阵 $C^{\\alpha}$ 和 $C^{\\beta}$ 来计算总自旋平方算符的期望值 $\\langle \\hat{S}^2 \\rangle$，让您亲身体验这一基本诊断过程 [@problem_id:2791672]。", "problem": "考虑一个用于开壳层体系的单行列式非限制哈特里-福克 (UHF) 波函数，该体系有 $N_{\\alpha}$ 个自旋向上电子和 $N_{\\beta}$ 个自旋向下电子。设已占据的自旋分子轨道在一个原子轨道 (AO) 基组 $\\{\\chi_{\\mu}\\}$ 中展开，其重叠矩阵为 $S_{\\mu\\nu}=\\langle \\chi_{\\mu}|\\chi_{\\nu}\\rangle$。用 $C^{\\alpha}$ 和 $C^{\\beta}$ 表示已占据自旋的系数矩阵，它们的列分别是已占据 $\\alpha$ 和 $\\beta$ 分子轨道的原子轨道系数。从总自旋算符 $\\hat{S}_{z}$、$\\hat{S}_{+}$ 和 $\\hat{S}_{-}$ 的定义以及斯莱特行列式的标准性质出发，推导 UHF 行列式期望值 $\\langle \\hat{S}^{2}\\rangle$ 关于 $N_{\\alpha}$、$N_{\\beta}$、$C^{\\alpha}$、$C^{\\beta}$ 和 $S$ 的表达式。然后，使用下面的具体数据对其进行求值，并评估相对于目标自旋态的自旋污染。\n\n数据：\n- AO 重叠矩阵是单位矩阵 $S=I_{3}$（一个具有 $3$ 个函数的正交归一 AO 基组）。\n- 已占据 $\\alpha$ 自旋系数矩阵为\n$$\nC^{\\alpha}=\\begin{pmatrix}\n1 & 0\\\\\n0 & 1\\\\\n0 & 0\n\\end{pmatrix},\n$$\n因此 $N_{\\alpha}=2$。\n- 已占据 $\\beta$ 自旋系数矩阵为\n$$\nC^{\\beta}=\\begin{pmatrix}\n0.9\\\\\n0.2\\\\\n\\sqrt{0.15}\n\\end{pmatrix},\n$$\n因此 $N_{\\beta}=1$。\n- 目标纯自旋态是自旋量子数 $S_{0}=\\tfrac{1}{2}$ 的双重态。\n\n计算此 UHF 行列式的 $\\langle \\hat{S}^{2}\\rangle$ 以及自旋污染 $\\Delta=\\langle \\hat{S}^{2}\\rangle - S_{0}(S_{0}+1)$。在最终答案中只报告污染值 $\\Delta$。将报告的 $\\Delta$ 四舍五入到四位有效数字。最终报告的数字是无量纲的，必须不带单位给出。", "solution": "所给出的问题陈述是理论化学中关于非限制哈特里-福克 (UHF) 方法的一个标准练习题。它在科学上是合理的，提法明确，并且包含了完整解答所需的所有信息。因此，该问题被认为是有效的，我将着手进行解答。\n\n核心任务是推导和计算单行列式 UHF 波函数 $|\\Psi_{UHF}\\rangle$ 的总自旋平方算符 $\\hat{S}^2$ 的期望值。我们从总自旋算符的基本定义开始。总自旋算符是单个电子自旋算符的矢量和，$\\hat{\\mathbf{S}} = \\sum_{i=1}^{N} \\hat{\\mathbf{s}}(i)$，其中 $N$ 是电子总数。该算符的平方是 $\\hat{S}^2 = \\hat{\\mathbf{S}} \\cdot \\hat{\\mathbf{S}}$。\n使用自旋升降算符 $\\hat{S}_{+} = \\sum_{i} \\hat{s}_{+}(i)$ 和 $\\hat{S}_{-} = \\sum_{i} \\hat{s}_{-}(i)$，结合总自旋的 $z$ 分量算符 $\\hat{S}_z = \\sum_{i} \\hat{s}_z(i)$ 来表示它最为方便。一个标准的算符恒等式是：\n$$\n\\hat{S}^2 = \\hat{S}_{-} \\hat{S}_{+} + \\hat{S}_z^2 + \\hat{S}_z\n$$\n单个斯莱特行列式，例如 $|\\Psi_{UHF}\\rangle$，是总 $\\hat{S}_z$ 算符的本征函数。相应的本征值 $M_S$ 由 $\\alpha$（自旋向上）电子数 $N_{\\alpha}$ 和 $\\beta$（自旋向下）电子数 $N_{\\beta}$ 之差的一半给出：\n$$\n\\hat{S}_z |\\Psi_{UHF}\\rangle = M_S |\\Psi_{UHF}\\rangle, \\quad \\text{其中 } M_S = \\frac{1}{2}(N_{\\alpha} - N_{\\beta})\n$$\n因此，对于这个态，$\\hat{S}_z$ 和 $\\hat{S}_z^2$ 的期望值分别是 $M_S$ 和 $M_S^2$。$\\hat{S}^2$ 的期望值因此变为：\n$$\n\\langle \\hat{S}^2 \\rangle = \\langle \\Psi_{UHF} | \\hat{S}_{-} \\hat{S}_{+} | \\Psi_{UHF} \\rangle + M_S^2 + M_S\n$$\n剩下的任务是计算算符乘积 $\\hat{S}_{-} \\hat{S}_{+}$ 的期望值。我们展开这个乘积：\n$$\n\\hat{S}_{-} \\hat{S}_{+} = \\left(\\sum_{i=1}^{N} \\hat{s}_{-}(i)\\right) \\left(\\sum_{j=1}^{N} \\hat{s}_{+}(j)\\right) = \\sum_{i=1}^{N} \\hat{s}_{-}(i)\\hat{s}_{+}(i) + \\sum_{i \\neq j} \\hat{s}_{-}(i)\\hat{s}_{+}(j)\n$$\n该算符的期望值是单电子部分和双电子部分期望值的和。\n$1$. 单电子算符和：算符 $\\hat{s}_{-}(i)\\hat{s}_{+}(i)$ 充当 $\\beta$ 自旋态的投影算符。也就是说，如果电子 $i$ 具有 $\\beta$ 自旋，它返回 $1$，如果具有 $\\alpha$ 自旋，则返回 $0$。对其期望值在所有 $N$ 个电子上求和，就等于对具有 $\\beta$ 自旋的电子数进行计数。因此：\n$$\n\\langle \\Psi_{UHF} | \\sum_{i=1}^{N} \\hat{s}_{-}(i)\\hat{s}_{+}(i) | \\Psi_{UHF} \\rangle = N_{\\beta}\n$$\n$2$. 双电子算符和：$\\langle \\sum_{i \\neq j} \\hat{s}_{-}(i)\\hat{s}_{+}(j) \\rangle$ 的计算是使用针对单行列式的斯莱特-康登规则进行的。这个双电子算符实际上试图交换两个不同电子的自旋。只有在 $\\alpha$ 自旋轨道 $\\phi_k^{\\alpha}(\\mathbf{x}_i) = \\psi_k^{\\alpha}(\\mathbf{r}_i)\\alpha(\\omega_i)$ 和 $\\beta$ 自旋轨道 $\\phi_l^{\\beta}(\\mathbf{x}_j) = \\psi_l^{\\beta}(\\mathbf{r}_j)\\beta(\\omega_j)$ 之间的交换项才会产生非零贡献。此分析的结果是：\n$$\n\\langle \\Psi_{UHF} | \\sum_{i \\neq j} \\hat{s}_{-}(i)\\hat{s}_{+}(j) | \\Psi_{UHF} \\rangle = - \\sum_{k=1}^{N_{\\alpha}} \\sum_{l=1}^{N_{\\beta}} |\\langle \\psi_k^{\\alpha} | \\psi_l^{\\beta} \\rangle|^2\n$$\n其中 $|\\psi_k^{\\alpha}\\rangle$ 和 $|\\psi_l^{\\beta}\\rangle$ 是空间分子轨道 (MO)。此项量化了已占据的 $\\alpha$ 轨道集和 $\\beta$ 轨道集之间的空间重叠。\n\n结合这些结果，我们得到单个 UHF 行列式的 $\\hat{S}^2$ 期望值的一般表达式：\n$$\n\\langle \\hat{S}^2 \\rangle = M_S^2 + M_S + N_{\\beta} - \\sum_{k=1}^{N_{\\alpha}} \\sum_{l=1}^{N_{\\beta}} |\\langle \\psi_k^{\\alpha} | \\psi_l^{\\beta} \\rangle|^2\n$$\n这可以更紧凑地写成 $\\langle \\hat{S}^2 \\rangle = M_S(M_S+1) + N_{\\beta} - \\sum_{k,l} |\\langle \\psi_k^{\\alpha} | \\psi_l^{\\beta} \\rangle|^2$。\n空间 MO 在原子轨道 (AO) 基组 $\\{\\chi_{\\mu}\\}$ 中展开：\n$|\\psi_k^{\\sigma}\\rangle = \\sum_{\\mu} C_{\\mu k}^{\\sigma} |\\chi_{\\mu}\\rangle$，其中 $\\sigma \\in \\{\\alpha, \\beta\\}$。\n因此，一个 $\\alpha$ MO 和一个 $\\beta$ MO 之间的重叠积分为：\n$$\n\\langle \\psi_k^{\\alpha} | \\psi_l^{\\beta} \\rangle = \\sum_{\\mu,\\nu} (C_{\\mu k}^{\\alpha})^* S_{\\mu\\nu} C_{\\nu l}^{\\beta}\n$$\n其中 $S_{\\mu\\nu} = \\langle \\chi_{\\mu} | \\chi_{\\nu} \\rangle$ 是 AO 重叠矩阵。在矩阵表示法中，元素为 $O_{kl} = \\langle \\psi_k^{\\alpha} | \\psi_l^{\\beta} \\rangle$ 的 MO 重叠矩阵 $O$ 由 $O = (C^{\\alpha})^{\\dagger} S C^{\\beta}$ 给出。求和项变为该矩阵的弗罗贝尼乌斯范数的平方，即 $\\mathrm{Tr}(O^{\\dagger}O)$。\n\n现在我们根据给定的数据进行计算：\n- $\\alpha$ 电子数：$N_{\\alpha} = 2$。\n- $\\beta$ 电子数：$N_{\\beta} = 1$。\n- AO 重叠矩阵：$S=I_{3}$（一个 $3 \\times 3$ 的单位矩阵）。\n- 已占据 $\\alpha$ 自旋 MO 系数矩阵：$C^{\\alpha}=\\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\\\ 0 & 0 \\end{pmatrix}$。\n- 已占据 $\\beta$ 自旋 MO 系数矩阵：$C^{\\beta}=\\begin{pmatrix} 0.9 \\\\ 0.2 \\\\ \\sqrt{0.15} \\end{pmatrix}$。\n- 目标纯自旋态：双重态，自旋量子数 $S_0 = \\frac{1}{2}$。\n\n首先，我们计算本征值 $M_S$：\n$$\nM_S = \\frac{1}{2}(N_{\\alpha} - N_{\\beta}) = \\frac{1}{2}(2-1) = \\frac{1}{2}\n$$\n目标纯自旋态的期望值 $\\langle \\hat{S}^2 \\rangle$ 是 $S_0(S_0+1)$：\n$$\nS_0(S_0+1) = \\frac{1}{2}\\left(\\frac{1}{2}+1\\right) = \\frac{3}{4} = 0.75\n$$\n这个目标值与我们推导的 $\\langle \\hat{S}^2 \\rangle$ 公式中的 $M_S(M_S+1)$ 项相同。\n\n接下来，我们计算 MO 重叠和。我们计算矩阵 $O = (C^{\\alpha})^T S C^{\\beta}$。由于 $S=I_3$ 且系数是实数，这可以简化为 $O = (C^{\\alpha})^T C^{\\beta}$：\n$$\nO = \\begin{pmatrix} 1 & 0 & 0 \\\\ 0 & 1 & 0 \\end{pmatrix} \\begin{pmatrix} 0.9 \\\\ 0.2 \\\\ \\sqrt{0.15} \\end{pmatrix} = \\begin{pmatrix} (1)(0.9) + (0)(0.2) + (0)(\\sqrt{0.15}) \\\\ (0)(0.9) + (1)(0.2) + (0)(\\sqrt{0.15}) \\end{pmatrix} = \\begin{pmatrix} 0.9 \\\\ 0.2 \\end{pmatrix}\n$$\n重叠的平方和是 $O$ 矩阵各元素平方的和：\n$$\n\\sum_{k=1}^{2} \\sum_{l=1}^{1} |\\langle \\psi_k^{\\alpha} | \\psi_l^{\\beta} \\rangle|^2 = (0.9)^2 + (0.2)^2 = 0.81 + 0.04 = 0.85\n$$\n现在我们计算给定 UHF 行列式的期望值 $\\langle \\hat{S}^2 \\rangle$：\n$$\n\\langle \\hat{S}^2 \\rangle = M_S(M_S+1) + N_{\\beta} - 0.85 = 0.75 + 1 - 0.85 = 0.90\n$$\n自旋污染 $\\Delta$ 是该值与纯自旋态的理想值之间的偏差：\n$$\n\\Delta = \\langle \\hat{S}^2 \\rangle - S_0(S_0+1) = 0.90 - 0.75 = 0.15\n$$\nUHF 波函数被更高多重度的态（在这种情况下是 $S=3/2$ 的四重态）“污染”了，因为 $\\alpha$ 和 $\\beta$ 电子的空间轨道 $\\{\\psi_k^\\alpha\\}$ 和 $\\{\\psi_l^\\beta\\}$ 彼此不正交，从而导致了一个非零的污染项。\n将结果四舍五入到四位有效数字，得到 $0.1500$。", "answer": "$$\n\\boxed{0.1500}\n$$", "id": "2791672"}, {"introduction": "在学会如何诊断UHF波函数的自旋纯度之后，下一个合乎逻辑的步骤是理解其能量是如何构建的。本练习将带您深入UHF理论的核心，通过其基本组成部分——单电子能量、库仑能量和交换能量——来计算总能量。您将直接操作自旋密度矩阵和双电子积分，从而了解它们如何共同构成最终的能量值 [@problem_id:2791707]。", "problem": "考虑一个开壳层体系，在由索引 $1$ 和 $2$ 标记的两个空间函数的标准正交基中，使用非限制性哈特里-福克 (UHF) 理论进行处理。自旋分辨的单粒子密度矩阵为\n$$\nP^{\\alpha}=\\begin{pmatrix}1 & 0 \\\\ 0 & 1\\end{pmatrix},\\qquad\nP^{\\beta}=\\begin{pmatrix}1 & 0 \\\\ 0 & 0\\end{pmatrix}.\n$$\n单电子（核）哈密顿矩阵为\n$$\nh=\\begin{pmatrix}-1.20 & -0.10 \\\\ -0.10 & -0.80\\end{pmatrix}.\n$$\n双电子排斥积分以化学家标记法 $(pq|rs)$ 给出，具有通常的置换对称性 $(pq|rs)=(qp|rs)=(pq|sr)=(qp|sr)=(rs|pq)$。非零的唯一值（以哈特里原子单位计）为\n$$\n(11|11)=0.70,\\quad (22|22)=0.60,\\quad (11|22)=(22|11)=0.30,\\quad (12|12)=(21|21)=0.20.\n$$\n将由密度矩阵 $P$ 生成的库仑矩阵定义为\n$$\nJ_{pq}(P)=\\sum_{r,s}P_{rs}\\,(pq|rs),\n$$\n并将交换矩阵定义为\n$$\nK_{pq}(P)=\\sum_{r,s}P_{rs}\\,(pr|qs).\n$$\n令 $\\mathrm{Tr}[A]=\\sum_{p}A_{pp}$ 表示矩阵的迹。从单个斯莱特行列式的自旋分辨哈特里-福克能量泛函以及上述库仑和交换矩阵的定义出发，推导 UHF 总能量的矩阵迹形式，然后根据给定数据进行计算。用哈特里（原子单位）表示最终数值结果，并将答案四舍五入到四位有效数字。", "solution": "首先验证该问题，发现其科学基础扎实、提法恰当且客观。这是计算量子化学中的一个标准练习。\n\n在非限制性哈特里-福克 (UHF) 近似中，总电子能量是电子哈密顿量对于单个斯莱特行列式波函数的期望值。能量表达式可以写成自旋分辨的单粒子密度矩阵 $P^{\\alpha}$ 和 $P^{\\beta}$、单电子（核）哈密顿矩阵 $h$ 以及双电子排斥积分 $(pq|rs)$ 的形式。\n\n推导从一般 UHF 能量表达式开始。总能量是单电子能量 $E_{1e}$ 和双电子能量 $E_{2e}$ 的和。\n\n单电子能量是所有电子的核哈密顿量期望值的总和。其矩阵形式为：\n$$\nE_{1e} = \\sum_{\\sigma \\in \\{\\alpha, \\beta\\}} \\sum_{p,q} P_{qp}^{\\sigma} h_{pq} = \\sum_{\\sigma \\in \\{\\alpha, \\beta\\}} \\mathrm{Tr}[P^{\\sigma} h]\n$$\n由于迹是线性算符，我们可以合并来自 $\\alpha$ 和 $\\beta$ 自旋的贡献。令总密度矩阵为 $P^{\\text{total}} = P^{\\alpha} + P^{\\beta}$。则单电子能量为：\n$$\nE_{1e} = \\mathrm{Tr}[P^{\\alpha} h] + \\mathrm{Tr}[P^{\\beta} h] = \\mathrm{Tr}[(P^{\\alpha} + P^{\\beta}) h] = \\mathrm{Tr}[P^{\\text{total}} h]\n$$\n\n双电子能量由库仑相互作用和交换相互作用组成。对于 UHF 波函数，总双电子能量由下式给出：\n$$\nE_{2e} = \\frac{1}{2} \\sum_{p,q,r,s} \\left[ (P^{\\alpha}_{pq} + P^{\\beta}_{pq})(P^{\\alpha}_{rs} + P^{\\beta}_{rs})(pq|rs) - (P^{\\alpha}_{pq}P^{\\alpha}_{rs} + P^{\\beta}_{pq}P^{\\beta}_{rs})(pr|qs) \\right]\n$$\n使用总密度矩阵 $P^{\\text{total}}$，库仑部分可写为：\n$$\nE_{J} = \\frac{1}{2} \\sum_{p,q,r,s} P^{\\text{total}}_{pq} P^{\\text{total}}_{rs} (pq|rs)\n$$\n使用库仑矩阵的定义 $J_{pq}(P) = \\sum_{r,s} P_{rs}\\,(pq|rs)$，此项变为：\n$$\nE_{J} = \\frac{1}{2} \\sum_{p,q} P^{\\text{total}}_{pq} J_{pq}(P^{\\text{total}}) = \\frac{1}{2} \\mathrm{Tr}[P^{\\text{total}} J(P^{\\text{total}})]\n$$\n交换部分为：\n$$\nE_{K} = -\\frac{1}{2} \\sum_{p,q,r,s} \\left[ P^{\\alpha}_{pq}P^{\\alpha}_{rs}(pr|qs) + P^{\\beta}_{pq}P^{\\beta}_{rs}(pr|qs) \\right]\n$$\n使用交换矩阵的定义 $K_{pq}(P) = \\sum_{r,s} P_{rs}\\,(pr|qs)$，此项变为：\n$$\nE_{K} = -\\frac{1}{2} \\left[ \\sum_{p,q} P^{\\alpha}_{pq} K_{pq}(P^{\\alpha}) + \\sum_{p,q} P^{\\beta}_{pq} K_{pq}(P^{\\beta}) \\right] = -\\frac{1}{2} \\left( \\mathrm{Tr}[P^{\\alpha} K(P^{\\alpha})] + \\mathrm{Tr}[P^{\\beta} K(P^{\\beta})] \\right)\n$$\n合并所有部分，UHF 总能量的矩阵迹形式为：\n$$\nE_{\\text{UHF}} = \\mathrm{Tr}[P^{\\text{total}} h] + \\frac{1}{2} \\mathrm{Tr}[P^{\\text{total}} J(P^{\\text{total}})] - \\frac{1}{2} \\left( \\mathrm{Tr}[P^{\\alpha} K(P^{\\alpha})] + \\mathrm{Tr}[P^{\\beta} K(P^{\\beta})] \\right)\n$$\n这就是所要求的一般表达式。现在，我们根据给定数据进行计算。\n\n给定的矩阵是：\n$$\nP^{\\alpha}=\\begin{pmatrix}1 & 0 \\\\ 0 & 1\\end{pmatrix},\\quad P^{\\beta}=\\begin{pmatrix}1 & 0 \\\\ 0 & 0\\end{pmatrix},\\quad h=\\begin{pmatrix}-1.20 & -0.10 \\\\ -0.10 & -0.80\\end{pmatrix}\n$$\n总密度矩阵 $P^{\\text{total}}$ 是：\n$$\nP^{\\text{total}} = P^{\\alpha} + P^{\\beta} = \\begin{pmatrix}1 & 0 \\\\ 0 & 1\\end{pmatrix} + \\begin{pmatrix}1 & 0 \\\\ 0 & 0\\end{pmatrix} = \\begin{pmatrix}2 & 0 \\\\ 0 & 1\\end{pmatrix}\n$$\n单电子能量为：\n$$\nE_{1e} = \\mathrm{Tr}[P^{\\text{total}} h] = \\mathrm{Tr}\\left[\\begin{pmatrix}2 & 0 \\\\ 0 & 1\\end{pmatrix} \\begin{pmatrix}-1.20 & -0.10 \\\\ -0.10 & -0.80\\end{pmatrix}\\right] = \\mathrm{Tr}\\begin{pmatrix}-2.40 & -0.20 \\\\ -0.10 & -0.80\\end{pmatrix}\n$$\n$$\nE_{1e} = (-2.40) + (-0.80) = -3.20\n$$\n接下来，我们构建库仑矩阵和交换矩阵。由于所有密度矩阵都是对角的 ($P_{rs} = P_{rr}\\delta_{rs}$)，公式可以简化为：\n$J_{pq}(P) = \\sum_{r} P_{rr} (pq|rr)$\n$K_{pq}(P) = \\sum_{r} P_{rr} (pr|qr)$\n\n库仑矩阵 $J(P^{\\text{total}})$ 的元素为：\n$J_{11}(P^{\\text{total}}) = P^{\\text{total}}_{11}(11|11) + P^{\\text{total}}_{22}(11|22) = 2(0.70) + 1(0.30) = 1.40 + 0.30 = 1.70$\n$J_{22}(P^{\\text{total}}) = P^{\\text{total}}_{11}(22|11) + P^{\\text{total}}_{22}(22|22) = 2(0.30) + 1(0.60) = 0.60 + 0.60 = 1.20$\n$J_{12}(P^{\\text{total}}) = P^{\\text{total}}_{11}(12|11) + P^{\\text{total}}_{22}(12|22) = 0$（积分为零）。\n所以，$J(P^{\\text{total}}) = \\begin{pmatrix}1.70 & 0 \\\\ 0 & 1.20\\end{pmatrix}$。\n\n交换矩阵 $K(P^{\\alpha})$ 的元素为：\n$K_{11}(P^{\\alpha}) = P^{\\alpha}_{11}(11|11) + P^{\\alpha}_{22}(12|12) = 1(0.70) + 1(0.20) = 0.90$\n$K_{22}(P^{\\alpha}) = P^{\\alpha}_{11}(21|21) + P^{\\alpha}_{22}(22|22) = 1(0.20) + 1(0.60) = 0.80$\n$K_{12}(P^{\\alpha}) = P^{\\alpha}_{11}(11|21) + P^{\\alpha}_{22}(12|22) = 0$（积分为零）。\n所以，$K(P^{\\alpha}) = \\begin{pmatrix}0.90 & 0 \\\\ 0 & 0.80\\end{pmatrix}$。\n\n交换矩阵 $K(P^{\\beta})$ 的元素为：\n$K_{11}(P^{\\beta}) = P^{\\beta}_{11}(11|11) + P^{\\beta}_{22}(12|12) = 1(0.70) + 0 = 0.70$\n$K_{22}(P^{\\beta}) = P^{\\beta}_{11}(21|21) + P^{\\beta}_{22}(22|22) = 1(0.20) + 0 = 0.20$\n$K_{12}(P^{\\beta}) = P^{\\beta}_{11}(11|21) + P^{\\beta}_{22}(12|22) = 0$。\n所以，$K(P^{\\beta}) = \\begin{pmatrix}0.70 & 0 \\\\ 0 & 0.20\\end{pmatrix}$。\n\n现在我们计算双电子能量项：\n库仑能量项：\n$$\nE_{J} = \\frac{1}{2} \\mathrm{Tr}[P^{\\text{total}} J(P^{\\text{total}})] = \\frac{1}{2} \\mathrm{Tr}\\left[\\begin{pmatrix}2 & 0 \\\\ 0 & 1\\end{pmatrix} \\begin{pmatrix}1.70 & 0 \\\\ 0 & 1.20\\end{pmatrix}\\right] = \\frac{1}{2} \\mathrm{Tr}\\begin{pmatrix}3.40 & 0 \\\\ 0 & 1.20\\end{pmatrix} = \\frac{1}{2}(3.40 + 1.20) = 2.30\n$$\n$\\alpha$ 自旋的交换能量项：\n$$\n-\\frac{1}{2} \\mathrm{Tr}[P^{\\alpha} K(P^{\\alpha})] = -\\frac{1}{2} \\mathrm{Tr}\\left[\\begin{pmatrix}1 & 0 \\\\ 0 & 1\\end{pmatrix} \\begin{pmatrix}0.90 & 0 \\\\ 0 & 0.80\\end{pmatrix}\\right] = -\\frac{1}{2} \\mathrm{Tr}\\begin{pmatrix}0.90 & 0 \\\\ 0 & 0.80\\end{pmatrix} = -\\frac{1}{2}(0.90 + 0.80) = -0.85\n$$\n$\\beta$ 自旋的交换能量项：\n$$\n-\\frac{1}{2} \\mathrm{Tr}[P^{\\beta} K(P^{\\beta})] = -\\frac{1}{2} \\mathrm{Tr}\\left[\\begin{pmatrix}1 & 0 \\\\ 0 & 0\\end{pmatrix} \\begin{pmatrix}0.70 & 0 \\\\ 0 & 0.20\\end{pmatrix}\\right] = -\\frac{1}{2} \\mathrm{Tr}\\begin{pmatrix}0.70 & 0 \\\\ 0 & 0\\end{pmatrix} = -\\frac{1}{2}(0.70) = -0.35\n$$\n总双电子能量为 $E_{2e} = 2.30 - 0.85 - 0.35 = 1.10$。\n\nUHF 总能量是单电子能量和双电子能量的和：\n$$\nE_{\\text{UHF}} = E_{1e} + E_{2e} = -3.20 + 1.10 = -2.10\n$$\n题目要求答案四舍五入到四位有效数字。这得到 $-2.100$。\n所有数值都以哈特里原子单位计。", "answer": "$$\n\\boxed{-2.100}\n$$", "id": "2791707"}, {"introduction": "在UHF方法之外，本练习将探索限制性更强的开壳层哈特里-福克(ROHF)方法。ROHF理论的一个精妙之处在于如何定义一组唯一的正则轨道及其能量，这需要构建一个特定的有效福克算符（effective Fock operator）。这个高级实践将指导您实现生成这些正则轨道的算法过程，从而架起理论形式与实际计算化学算法之间的桥梁 [@problem_id:2791703]。", "problem": "给定一组来自收敛的限制性开壳层Hartree-Fock (ROHF) 计算的自旋分辨Fock矩阵，这些矩阵在正交归一基下表示。同时，还给出了轨道空间的占据分区，将其分为三个连续的集合：双占据、单占据和虚轨道。目标是构建占据空间中的一个有效单电子算符，该算符对于混合双占据和单占据子空间的幺正旋转是驻定的，并计算一个变换，使得此有效Fock矩阵在双占据和单占据子空间之间呈块对角形式。由此，通过在两个占据块内进一步对角化，可以得到ROHF正则占据轨道。需要关注的量是用于验证块对角化和驻定性的数值范数。\n\n基本依据和定义：\n- 开壳层体系的Hartree-Fock能量泛函依赖于独立的自旋密度矩阵 $P^{\\alpha}$ 和 $P^{\\beta}$ 以及自旋分辨的Fock矩阵 $F^{\\alpha}$ 和 $F^{\\beta}$，其中 $F^{\\sigma}$ 是自旋 $\\sigma \\in \\{\\alpha,\\beta\\}$ 的有效单电子算符，由单电子核心哈密顿量与根据密度构建的平均场电子-电子相互作用之和得到。\n- 在ROHF中，空间轨道为不同自旋所共享，其占据模式包含 $n_{d}$ 个双占据轨道、$n_{s}$ 个单占据轨道和 $n_{v}$ 个虚轨道，其中 $n_{d}+n_{s}+n_{v}=n$ 是空间轨道的总数。占据空间是双占据子空间和单占据子空间的直和。\n- 能量相对于混合不同占据类别轨道的幺正旋转的驻定性，在一个合适的占据空间有效单电子算符上施加了非对角条件。对此类算符，一个常见的对称选择是如下组合自旋分辨的Fock算符：在双占据块中使用对自旋的迹，在单占据块中使用对自旋的平均，而在耦合项中采用跨自旋的对称平均。这种选择产生一个实对称的有效占据Fock矩阵，并导出良定义的ROHF正则轨道。\n\n计算任务：\n- 你将收到三个测试案例，每个案例包含大小为 $n \\times n$ 的实对称矩阵 $F^{\\alpha}$ 和 $F^{\\beta}$，以及指定双占据和单占据块大小的整数 $n_{d}$ 和 $n_{s}$（剩余部分为虚轨道块）。轨道的排序方式是前 $n_{d}$ 个轨道为双占据，接下来 $n_{s}$ 个为单占据，其余为虚轨道。\n- 构建一个实对称有效Fock矩阵 $F_{\\mathrm{eff}}$，其占据-占据块 $F_{\\mathrm{occ}}$ 由以下方式构成：\n  1. $F_{\\mathrm{DD}} = F^{\\alpha}_{\\mathrm{DD}} + F^{\\beta}_{\\mathrm{DD}}$，\n  2. $F_{\\mathrm{SS}} = \\tfrac{1}{2}\\left(F^{\\alpha}_{\\mathrm{SS}} + F^{\\beta}_{\\mathrm{SS}}\\right)$，\n  3. $F_{\\mathrm{DS}} = F_{\\mathrm{SD}}^{\\mathsf{T}} = \\tfrac{1}{2}\\left(F^{\\alpha}_{\\mathrm{DS}} + F^{\\beta}_{\\mathrm{DS}}\\right)$，\n  其中 $\\mathrm{D}$ 表示双占据块，$\\mathrm{S}$ 表示单占据块，两者都限制在占据空间内。此任务无需构建 $F_{\\mathrm{eff}}$ 的虚轨道块。\n- 在占据空间内找到一个实正交变换，由一个 $n_{\\mathrm{occ}}\\times n_{\\mathrm{occ}}$ 的矩阵 $U_{\\mathrm{occ}}$ 表示（其中 $n_{\\mathrm{occ}}=n_{d}+n_{s}$），使得变换后的占据块 $F_{\\mathrm{occ}}^{\\prime} = U_{\\mathrm{occ}}^{\\mathsf{T}} F_{\\mathrm{occ}} U_{\\mathrm{occ}}$ 在 $\\mathrm{D}$ 和 $\\mathrm{S}$ 子空间之间是块对角的。这意味着 $F_{\\mathrm{occ}}^{\\prime}$ 的 $\\mathrm{D}\\text{-}\\mathrm{S}$ 和 $\\mathrm{S}\\text{-}\\mathrm{D}$ 非对角块在指定容差内数值上为零。\n- 在实现 $\\mathrm{D}$ 和 $\\mathrm{S}$ 之间的块对角性后，进一步在 $\\mathrm{D}$ 和 $\\mathrm{S}$ 块内分别应用独立的正交变换以对角化每个块，从而获得ROHF正则占据轨道及其有效轨道能。\n- 对于每个测试案例，计算并报告两个定量诊断指标（均以Hartree为单位）：\n  1. $F_{\\mathrm{occ}}^{\\prime}$ 的非对角 $\\mathrm{D}\\text{-}\\mathrm{S}$ 块的Frobenius范数，\n  2. 对易子 $[P_{\\mathrm{D}},F_{\\mathrm{occ}}^{\\prime}] = P_{\\mathrm{D}} F_{\\mathrm{occ}}^{\\prime} - F_{\\mathrm{occ}}^{\\prime} P_{\\mathrm{D}}$ 的Frobenius范数，其中 $P_{\\mathrm{D}}$ 是在变换后的占据基中到 $\\mathrm{D}$ 块的投影算符。对于完美的块对角性，这两个范数都应在数值上为零。\n- 能量单位：所有范数均以Hartree报告。无需报告角度。\n\n算法约束和严谨性提示：\n- 你的程序必须基于ROHF占据空间中幺正旋转下的驻定性第一性原理以及实对称算符在正交相似变换下的性质。你可以使用任何数值稳定的算法来构建 $U_{\\mathrm{occ}}$；其底层的数学原理必须可靠，并与消除 $F_{\\mathrm{occ}}$ 中 $\\mathrm{D}$ 和 $\\mathrm{S}$ 之间耦合的目标一致。\n\n测试套件：\n- 案例1（一般情况，非平凡耦合）：$n=4$, $n_{d}=2$, $n_{s}=1$。矩阵 $F^{\\alpha}$ 和 $F^{\\beta}$：\n  $$F^{\\alpha} = \\begin{pmatrix}\n  -0.80 & 0.05 & 0.10 & 0.00\\\\\n  0.05 & -0.60 & 0.15 & 0.00\\\\\n  0.10 & 0.15 & -0.30 & 0.02\\\\\n  0.00 & 0.00 & 0.02 & 0.40\n  \\end{pmatrix},\\quad\n  F^{\\beta} = \\begin{pmatrix}\n  -0.82 & 0.04 & 0.02 & 0.00\\\\\n  0.04 & -0.58 & 0.01 & 0.00\\\\\n  0.02 & 0.01 & -0.10 & 0.01\\\\\n  0.00 & 0.00 & 0.01 & 0.42\n  \\end{pmatrix}.$$\n- 案例2（边界情况，初始$\\mathrm{D}\\text{-}\\mathrm{S}$耦合为零）：$n=3$, $n_{d}=1$, $n_{s}=1$。\n  $$F^{\\alpha} = \\begin{pmatrix}\n  -0.70 & 0.00 & 0.00\\\\\n  0.00 & -0.20 & 0.03\\\\\n  0.00 & 0.03 & 0.50\n  \\end{pmatrix},\\quad\n  F^{\\beta} = \\begin{pmatrix}\n  -0.68 & 0.00 & 0.00\\\\\n  0.00 & -0.15 & 0.02\\\\\n  0.00 & 0.02 & 0.52\n  \\end{pmatrix}.$$\n- 案例3（多个单占据，非平凡耦合）：$n=5$, $n_{d}=1$, $n_{s}=2$。\n  $$F^{\\alpha} = \\begin{pmatrix}\n  -0.90 & 0.10 & 0.05 & 0.00 & 0.00\\\\\n  0.10 & -0.40 & 0.02 & 0.01 & 0.00\\\\\n  0.05 & 0.02 & -0.35 & 0.00 & 0.01\\\\\n  0.00 & 0.01 & 0.00 & 0.30 & 0.02\\\\\n  0.00 & 0.00 & 0.01 & 0.02 & 0.33\n  \\end{pmatrix},\\quad\n  F^{\\beta} = \\begin{pmatrix}\n  -0.88 & 0.03 & 0.01 & 0.00 & 0.00\\\\\n  0.03 & -0.12 & 0.01 & 0.00 & 0.01\\\\\n  0.01 & 0.01 & -0.10 & 0.00 & 0.00\\\\\n  0.00 & 0.00 & 0.00 & 0.32 & 0.01\\\\\n  0.00 & 0.01 & 0.00 & 0.01 & 0.34\n  \\end{pmatrix}.$$\n\n所需输出：\n- 你的程序应生成单行输出，包含一个方括号内的逗号分隔列表。每个测试案例的结果必须是一个包含两个Hartree单位浮点数的列表，顺序为 $[\\|F_{\\mathrm{DS}}^{\\prime}\\|_{F}, \\|[P_{\\mathrm{D}},F_{\\mathrm{occ}}^{\\prime}]\\|_{F}]$。因此，总输出形式为\n  $$[\\,[x_{1},y_{1}],\\,[x_{2},y_{2}],\\,[x_{3},y_{3}]\\,],$$\n  其中 $x_{k}$ 和 $y_{k}$ 对应于第$k$个测试案例。打印完整精度的Python浮点数。\n\n你的程序必须是一个完整的、可运行的程序，在没有用户输入和外部文件的情况下执行上述计算，并且必须遵守指定的执行环境。所有报告的量均以Hartree为单位。不涉及角度。不涉及百分比。", "solution": "所提出的问题是计算量子化学领域中一个明确定义的任务，具体涉及在限制性开壳层Hartree-Fock (ROHF) 框架内确定正则轨道。该问题在科学上是合理的、适定的且客观的。它没有矛盾或缺失信息。因此，我将着手提供一个完整的解决方案。\n\nHartree-Fock方法的基本原理是相对于占据轨道集最小化电子能量泛函。这种最小化导出了Hartree-Fock方程，该方程指出有效单电子算符——Fock算符——必须没有耦合占据轨道和虚轨道的矩阵元。对于用ROHF处理的开壳层系统，情况更为复杂。能量表达式依赖于轨道的选择，其值在混合给定占据类别（双占据、单占据或虚轨道）*内部*的轨道的幺正旋转下是驻定的。然而，混合*不同*占据类别之间（例如双占据（D）和单占据（S）子空间之间）的轨道的旋转通常不是能量不变的。\n\nROHF能量相对于D-S混合的驻定性条件要求，一个合适的有效Fock算符的耦合D和S子空间的非对角块为零。问题定义了一个特定的、常用的对称有效Fock算符 $F_{\\mathrm{eff}}$，其占据-占据块 $F_{\\mathrm{occ}}$ 是预先给定的。在最终的正则轨道基中，此算符在D和S子空间之间必须是块对角的。\n\n设初始的非正则基划分为$n_d$个双占据轨道、$n_s$个单占据轨道和$n_v$个虚轨道。占据轨道的总数为$n_{\\mathrm{occ}} = n_d + n_s$。任务仅限于这个占据空间。输入的自旋Fock矩阵$F^{\\alpha}$和$F^{\\beta}$是在此初始基中给出的。\n\n首先，我们按照规定构建$n_{\\mathrm{occ}} \\times n_{\\mathrm{occ}}$的实对称矩阵$F_{\\mathrm{occ}}$。其块定义如下：\n$$\nF_{\\mathrm{DD}} = F^{\\alpha}_{\\mathrm{DD}} + F^{\\beta}_{\\mathrm{DD}} \\quad (\\text{大小为 } n_d \\times n_d)\n$$\n$$\nF_{\\mathrm{SS}} = \\frac{1}{2}\\left(F^{\\alpha}_{\\mathrm{SS}} + F^{\\beta}_{\\mathrm{SS}}\\right) \\quad (\\text{大小为 } n_s \\times n_s)\n$$\n$$\nF_{\\mathrm{DS}} = \\frac{1}{2}\\left(F^{\\alpha}_{\\mathrm{DS}} + F^{\\beta}_{\\mathrm{DS}}\\right) \\quad (\\text{大小为 } n_d \\times n_s)\n$$\n因此，完整的占据-占据有效Fock矩阵是：\n$$\nF_{\\mathrm{occ}} = \\begin{pmatrix} F_{\\mathrm{DD}} & F_{\\mathrm{DS}} \\\\ F_{\\mathrm{DS}}^{\\mathsf{T}} & F_{\\mathrm{SS}} \\end{pmatrix}\n$$\n通常，在任意基中，非对角块$F_{\\mathrm{DS}}$是非零的，这表明能量对于D-S混合不是驻定的。目标是找到一个正交变换$U_{\\mathrm{occ}}$，它定义了一个新的正则轨道基，在此基中这种耦合消失。设变换后的矩阵为$F'_{\\mathrm{occ}}$：\n$$\nF'_{\\mathrm{occ}} = U_{\\mathrm{occ}}^{\\mathsf{T}} F_{\\mathrm{occ}} U_{\\mathrm{occ}}\n$$\n我们要求$F'_{\\mathrm{occ}}$是块对角的，这意味着其新的D-S块$F'_{\\mathrm{DS}}$是一个零矩阵。问题要求“进一步在D和S块内分别应用独立的正交变换以对角化每个块”。整个过程等价于找到一个使$F_{\\mathrm{occ}}$完全对角化的基。实现这一目标最直接且数值最稳健的算法是求解整个$F_{\\mathrm{occ}}$矩阵的本征值问题。\n$$\nF_{\\mathrm{occ}} U_{\\mathrm{occ}} = U_{\\mathrm{occ}} \\Lambda\n$$\n这里，$U_{\\mathrm{occ}}$是其列为$F_{\\mathrm{occ}}$本征向量的正交矩阵，而$\\Lambda$是相应本征值的对角矩阵。这些本征向量构成了新的正则轨道基，而本征值是它们的有效轨道能。\n\n在这个新基（$F_{\\mathrm{occ}}$的本征基）中，变换后的矩阵就是本征值的对角矩阵：\n$$\nF'_{\\mathrm{occ}} = U_{\\mathrm{occ}}^{\\mathsf{T}} F_{\\mathrm{occ}} U_{\\mathrm{occ}} = \\Lambda\n$$\n根据定义，一个对角矩阵对于任何分区也都是块对角的。为了定义新的D和S子空间，我们按升序排列本征值（及其对应的本征向量）。遵循Aufbau原理，具有最低有效能量的$n_d$个正则轨道构成新的D空间，接下来的$n_s$个轨道构成新的S空间。\n\n通过这个程序，变换后的矩阵$F'_{\\mathrm{occ}}$是对角矩阵$\\Lambda$。现在我们可以评估所需的两个诊断量。\n\n1.  $F'_{\\mathrm{occ}}$的非对角D-S块的Frobenius范数，$\\|F'_{\\mathrm{DS}}\\|_{F}$。\n    矩阵$F'_{\\mathrm{occ}} = \\Lambda$是对角的。我们根据新的D和S空间对其进行分区，这分别对应于前$n_d$列/行和接下来的$n_s$列/行。非对角块$F'_{\\mathrm{DS}}$是$\\Lambda$的一个子矩阵，仅包含非对角元素。因此，$F'_{\\mathrm{DS}}$是一个零矩阵。其Frobenius范数，即其元素平方和的平方根，恰好为0。\n    $$ \\|F'_{\\mathrm{DS}}\\|_{F} = 0 $$\n2.  对易子$[P_{\\mathrm{D}},F'_{\\mathrm{occ}}]$的Frobenius范数，其中$P_{\\mathrm{D}}$是到新D空间的投影算符。\n    在正则基中，D空间由前$n_d$个本征向量张成。因此，投影算符$P_{\\mathrm{D}}$是一个对角矩阵，其前$n_d$个对角元为1，其余$n_s$个对角元为0。\n    $$\n    P_{\\mathrm{D}} = \\mathrm{diag}(\\underbrace{1, 1, \\dots, 1}_{n_d}, \\underbrace{0, 0, \\dots, 0}_{n_s})\n    $$\n    我们必须计算对易子$[P_{\\mathrm{D}}, F'_{\\mathrm{occ}}] = P_{\\mathrm{D}} F'_{\\mathrm{occ}} - F'_{\\mathrm{occ}} P_{\\mathrm{D}}$。由于$P_{\\mathrm{D}}$和$F'_{\\mathrm{occ}} = \\Lambda$在同一基中都是对角矩阵，它们是对易的。两个对角矩阵的乘积是可交换的。\n    $$ [P_{\\mathrm{D}}, F'_{\\mathrm{occ}}] = [P_{\\mathrm{D}}, \\Lambda] = P_{\\mathrm{D}} \\Lambda - \\Lambda P_{\\mathrm{D}} = \\mathbf{0} $$\n    对易子是零矩阵，其Frobenius范数也恰好为0。\n\n因此，对于任何有效的输入，应用正确的正则化程序——即对有效Fock算符进行对角化——将导致两个诊断范数均为零，直至浮点精度的极限。这个结果可以作为驻定性条件已被满足的验证。计算任务简化为对每个案例正确地构建$F_{\\mathrm{occ}}$，然后执行本征值分解。\n\n每个测试案例的算法如下：\n1.  从给定的$F^{\\alpha}$和$F^{\\beta}$矩阵中提取维度为$n_{\\mathrm{occ}} \\times n_{\\mathrm{occ}}$的占据块，其中$n_{\\mathrm{occ}} = n_d + n_s$。\n2.  使用提供的公式构建大小为$n_{\\mathrm{occ}} \\times n_{\\mathrm{occ}}$的有效Fock矩阵$F_{\\mathrm{occ}}$。\n3.  计算实对称矩阵$F_{\\mathrm{occ}}$的本征值和本征向量。这可以通过标准的数值库函数完成，例如`numpy.linalg.eigh`。该函数返回按升序排序的本征值。\n4.  变换后的Fock矩阵$F'_{\\mathrm{occ}}$是这些排好序的本征值的对角矩阵。\n5.  构建投影算符$P_{\\mathrm{D}}$，它是一个对角矩阵，对角线上有$n_d$个1和$n_s$个0。\n6.  计算范数$\\|F'_{\\mathrm{DS}}\\|_{F}$和$\\|[P_{\\mathrm{D}},F'_{\\mathrm{occ}}]\\|_{F}$。根据分析，这些值在数值上应为零。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the ROHF canonicalization problem for the given test cases.\n    \"\"\"\n    \n    test_cases = [\n        # Case 1\n        (4, 2, 1, \n         np.array([\n             [-0.80, 0.05, 0.10, 0.00],\n             [0.05, -0.60, 0.15, 0.00],\n             [0.10, 0.15, -0.30, 0.02],\n             [0.00, 0.00, 0.02, 0.40]\n         ]),\n         np.array([\n             [-0.82, 0.04, 0.02, 0.00],\n             [0.04, -0.58, 0.01, 0.00],\n             [0.02, 0.01, -0.10, 0.01],\n             [0.00, 0.00, 0.01, 0.42]\n         ])),\n        # Case 2\n        (3, 1, 1,\n         np.array([\n             [-0.70, 0.00, 0.00],\n             [0.00, -0.20, 0.03],\n             [0.00, 0.03, 0.50]\n         ]),\n         np.array([\n             [-0.68, 0.00, 0.00],\n             [0.00, -0.15, 0.02],\n             [0.00, 0.02, 0.52]\n         ])),\n        # Case 3\n        (5, 1, 2,\n         np.array([\n             [-0.90, 0.10, 0.05, 0.00, 0.00],\n             [0.10, -0.40, 0.02, 0.01, 0.00],\n             [0.05, 0.02, -0.35, 0.00, 0.01],\n             [0.00, 0.01, 0.00, 0.30, 0.02],\n             [0.00, 0.00, 0.01, 0.02, 0.33]\n         ]),\n         np.array([\n             [-0.88, 0.03, 0.01, 0.00, 0.00],\n             [0.03, -0.12, 0.01, 0.00, 0.01],\n             [0.01, 0.01, -0.10, 0.00, 0.00],\n             [0.00, 0.00, 0.00, 0.32, 0.01],\n             [0.00, 0.01, 0.00, 0.01, 0.34]\n         ]))\n    ]\n    \n    results = []\n    \n    for case in test_cases:\n        n, n_d, n_s, F_alpha, F_beta = case\n        n_occ = n_d + n_s\n        \n        # Extract occupied blocks from spin-Fock matrices\n        F_alpha_occ = F_alpha[:n_occ, :n_occ]\n        F_beta_occ = F_beta[:n_occ, :n_occ]\n        \n        # Extract DD, SS, and DS sub-blocks\n        F_alpha_DD = F_alpha_occ[:n_d, :n_d]\n        F_beta_DD = F_beta_occ[:n_d, :n_d]\n        \n        F_alpha_SS = F_alpha_occ[n_d:n_occ, n_d:n_occ]\n        F_beta_SS = F_beta_occ[n_d:n_occ, n_d:n_occ]\n        \n        F_alpha_DS = F_alpha_occ[:n_d, n_d:n_occ]\n        F_beta_DS = F_beta_occ[:n_d, n_d:n_occ]\n\n        # Construct the effective occupied Fock matrix F_occ\n        F_occ = np.zeros((n_occ, n_occ))\n        \n        F_DD = F_alpha_DD + F_beta_DD\n        F_SS = 0.5 * (F_alpha_SS + F_beta_SS)\n        F_DS = 0.5 * (F_alpha_DS + F_beta_DS)\n        \n        F_occ[:n_d, :n_d] = F_DD\n        F_occ[n_d:n_occ, n_d:n_occ] = F_SS\n        F_occ[:n_d, n_d:n_occ] = F_DS\n        F_occ[n_d:n_occ, :n_d] = F_DS.T\n\n        # Diagonalize F_occ to get canonical orbitals and energies\n        # np.linalg.eigh returns eigenvalues in ascending order and corresponding eigenvectors\n        eigenvalues, eigenvectors = np.linalg.eigh(F_occ)\n        \n        # The transformed Fock matrix, F'_occ, is the diagonal matrix of eigenvalues\n        F_prime_occ = np.diag(eigenvalues)\n\n        # 1. Compute the Frobenius norm of the off-diagonal D-S block of F'_occ\n        # In the canonical basis, F'_occ is diagonal, so its off-diagonal blocks are zero.\n        # The new D space corresponds to the first n_d eigenvectors (lowest eigenvalues).\n        F_prime_DS = F_prime_occ[:n_d, n_d:n_occ]\n        norm_F_DS_prime = np.linalg.norm(F_prime_DS, 'fro')\n\n        # 2. Compute the Frobenius norm of the commutator [P_D, F'_occ]\n        # In the canonical basis, P_D is also a diagonal matrix.\n        P_D = np.zeros((n_occ, n_occ))\n        if n_d > 0:\n            P_D[:n_d, :n_d] = np.eye(n_d)\n            \n        # Since both P_D and F'_occ are diagonal, they commute. The commutator is zero.\n        commutator = P_D @ F_prime_occ - F_prime_occ @ P_D\n        norm_commutator = np.linalg.norm(commutator, 'fro')\n        \n        results.append([norm_F_DS_prime, norm_commutator])\n\n    # Final print statement in the exact required format.\n    # The output format [[x1,y1],[x2,y2],[x3,y3]] requires representing each pair as a list,\n    -    # and then the collection of pairs as a list.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2791703"}]}