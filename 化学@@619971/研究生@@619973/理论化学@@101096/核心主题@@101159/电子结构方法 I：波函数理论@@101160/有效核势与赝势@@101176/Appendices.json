{"hands_on_practices": [{"introduction": "有效核势 (ECP) 的核心思想是通过近似替换化学惰性的芯电子来简化计算。这个练习旨在通过一个看似简单却至关重要的问题来巩固这一基本原理：为什么我们从不在氢原子的计算中使用ECP？通过回答这个问题 [@problem_id:1364338]，你将深化对ECP适用范围及其根本目的的理解。", "problem": "在计算量子化学领域，使用有效核势（ECPs），也称为赝势，是降低对含有大量电子的原子进行电子结构计算成本的一种常用策略。ECP通过用一个更弱、更平滑的有效势来取代化学惰性的核心电子和原子核的强库仑势，从而简化了问题。这使得计算可以只关注化学性质活泼的价电子。\n\n考虑到ECP构建和应用背后的基本原理，以下哪个陈述为分子计算中从不对氢原子使用ECP提供了最准确和最根本的原因？\n\nA. 氢原子不拥有任何核心电子；其唯一的电子是价电子，这使得ECP的主要目的变得不适用。\n\nB. 用于表示ECP的数学函数在计算上比求解氢原子单电子的薛定谔方程更昂贵。\n\nC. ECP被设计用于隐式地包含相对论效应，而这些效应对氢原子来说可以忽略不计，如果应用会引入显著误差。\n\nD. 对氢原子使用ECP会违反玻恩-奥本海默近似，而该近似对于定义分子结构至关重要。\n\nE. 氢原子1s基态轨道的完美球对称性阻碍了构建化学键合所需的非平凡、有方向性的赝势。", "solution": "在全电子分子计算中，对于电荷为$Z$的原子核，电子-原子核相互作用由局域库仑势（以原子单位表示）表示\n$$\nV_{ne}(r) = -\\frac{Z}{r}.\n$$\n有效核势（ECP）用一个作用于价空间、更弱、更平滑的有效算符来取代强的原子核库仑势以及核心电子的效应。一个标准的角动量依赖的（半局域）ECP具有以下形式\n$$\nV_{\\text{ECP}} = V_{\\text{loc}}(r) + \\sum_{\\ell} \\left( \\sum_{m=-\\ell}^{\\ell} |\\ell m\\rangle V_{\\ell}(r) \\langle \\ell m| - V_{\\text{loc}}(r) \\right),\n$$\n其构建方式使得在选定的核心半径之外，价电子的散射性质和能量与全电子参考相匹配。ECP的计算优势源于两个基本效应：\n1) 将明确处理的电子数量从$N_{e}$减少到$N_{\\text{val}} = N_{e} - N_{\\text{core}}$，从而将核心电子从电子问题中消除。\n2) 移除了价-核正交性约束以及原子核附近相关的快速径向振荡，从而允许使用更平滑的价基函数和更小的基组。\n\n将这些原理应用于氢原子。氢原子有$Z=1$和$N_{e}=1$。根据定义，其唯一的电子是化学性质活泼的价电子，因此核心电子集为空：\n$$\nN_{\\text{core}} = 0, \\qquad N_{\\text{val}} = 1.\n$$\n因此，没有核心电子可以移除，也没有核心轨道需要强制保持正交性。ECP不能减少$N_{e}$，不能简化价空间的节面结构，并且只会用一个近似的$V_{\\text{ECP}}$来取代精确且已经很简单的$V_{ne}(r) = -1/r$，在没有任何计算益处的情况下引入了近似。这就是不对氢原子使用ECP的根本原因。\n\n对各选项的评估：\n- A是正确的：氢没有核心电子；其唯一的电子是价电子，因此ECP的存在理由（消除核心电子并平滑价轨道在近核区域的行为）不适用。\n- B不是根本原因，且其主旨大体上不正确：ECP的采用与否并非基于单个函数的计算成本，而且对于氢原子来说，从一开始就没有电子数量的减少；关键问题在于不适用性，而不是成本。\n- C是不正确的：虽然许多现代ECP为重元素包含了标量相对论效应，但ECP并非仅为相对论原因而定义，将其应用于氢原子并不会因此“引入显著误差”；它只是没有必要。\n- D是不正确的：使用ECP并不违反玻恩-奥本海默近似；ECP在该框架内被常规使用。\n- E是不正确的：赝势是球对称的（带有非局域角动量投影算符），并且不要求方向各向异性；氢原子$1s$态的球对称性不是一个障碍。\n\n因此，最准确和最根本的原因是，对于氢原子没有核心电子可以替代，这使得ECP不适用。", "answer": "$$\\boxed{A}$$", "id": "1364338"}, {"introduction": "对于重元素体系，有效核势不仅能减少电子数，更关键的是能够高效地引入相对论效应。本练习 [@problem_id:2454645] 提供了一个简化的理论模型，让你亲手量化非相对论ECP、标量相对论ECP和完全相对论ECP对金二聚体 ($Au_2$) 键长的影响。通过将总的相对论校正分解为标量和自旋轨道贡献，你将具体地洞察ECP如何捕捉影响化学键的核心物理效应。", "problem": "您将使用一个最小紧束缚加短程排斥模型来模拟由两个金原子组成的双原子分子的平衡键长，并量化使用非相对论有效核势 (ECP) 与相对论有效核势时预测键长的变化。您需要将总差异分解为标量相对论效应和自旋轨道耦合的贡献。\n\n从 Born–Oppenheimer 图像出发，其中沿核间距的势能面由一个短程排斥项和一个成键稳定项描述。在一个每个原子一个轨道的最小紧束缚模型中，假设排斥作用可以通过指数函数 $B e^{-\\mu r}$（其中 $B \\gt 0$ 且 $\\mu \\gt 0$）很好地近似，而成键稳定作用来源于相距为 $r$ 的两个价轨道之间跃迁项 $t(r)$ 的二阶微扰理论。设 $t(r) = t_0 e^{-\\lambda r}$，其中 $\\lambda \\gt 0$。那么，在 $t(r)$ 的领头阶，一个电子在成键轨道中的成键稳定作用与 $-A e^{-2 \\lambda r}$ 成比例，其中 $A \\propto t_0^2 / \\Delta$，而 $\\Delta \\gt 0$ 是与反键轨道或更高能量轨道的有效能量分离。采用以下显式总能量模型：\n$$\nE(r) = B e^{-\\mu r} - A e^{-2 \\lambda r},\n$$\n其中 $B \\gt 0$、$\\mu \\gt 0$、$A \\gt 0$ 和 $\\lambda \\gt 0$。将 $E(r)$ 对 $r$ 求最小值，即可得到平衡键长 $r_e$。\n\n有效核势 (ECP) 会改变价电子结构参数。考虑三种 ECP 变体：\n- 非相对论 ECP（其参数用下标 $\\mathrm{NR}$ 表示），\n- 仅标量相对论 ECP（用下标 $\\mathrm{SR}$ 表示），\n- 完全相对论 ECP，包括自旋轨道耦合（用下标 $\\mathrm{REL}$ 表示，其包含与 $\\mathrm{SR}$ 中相同的标量相对论效应外加自旋轨道耦合）。\n\n使用以下假设来模拟 ECP 的依赖关系：\n- 轨道衰减常数从 $\\lambda_{\\mathrm{NR}}$ 变为 $\\lambda_{\\mathrm{SR}} = c_{\\mathrm{SR}} \\lambda_{\\mathrm{NR}}$，其中 $c_{\\mathrm{SR}} \\ge 1$。对于完全相对论情况，取 $\\lambda_{\\mathrm{REL}} = \\lambda_{\\mathrm{SR}}$。\n- 跃迁前因子与轨道衰减常数成比例，即 $t_{0,\\mathrm{SR}} = t_{0,\\mathrm{NR}} \\left(\\lambda_{\\mathrm{SR}}/\\lambda_{\\mathrm{NR}}\\right)$，且 $t_{0,\\mathrm{REL}} = t_{0,\\mathrm{SR}}$。\n- 有效能量分离 $\\Delta$ 由于价轨道流形的标量相对论稳定化而从 $\\Delta_{\\mathrm{NR}}$ 变为 $\\Delta_{\\mathrm{SR}}$，而自旋轨道耦合进一步将有效分离增加到 $\\Delta_{\\mathrm{REL}} = \\Delta_{\\mathrm{SR}} (1 + s_{\\mathrm{SO}})$，其中 $s_{\\mathrm{SO}} \\ge 0$。\n- 由于 $A \\propto t_0^2 / \\Delta$，可得\n$$\nA_{\\mathrm{SR}} = A_{\\mathrm{NR}} \\left(\\frac{\\lambda_{\\mathrm{SR}}}{\\lambda_{\\mathrm{NR}}}\\right)^2 \\left(\\frac{\\Delta_{\\mathrm{NR}}}{\\Delta_{\\mathrm{SR}}}\\right), \\quad\nA_{\\mathrm{REL}} = A_{\\mathrm{NR}} \\left(\\frac{\\lambda_{\\mathrm{REL}}}{\\lambda_{\\mathrm{NR}}}\\right)^2 \\left(\\frac{\\Delta_{\\mathrm{NR}}}{\\Delta_{\\mathrm{REL}}}\\right).\n$$\n\n您的任务：\n1. 从 $E(r) = B e^{-\\mu r} - A e^{-2 \\lambda r}$ 出发，推导出以 $B$、$ \\mu$、$A$ 和 $\\lambda$ 表示的 $r_e$，并用此公式为下面的每个测试用例计算 $r_{\\mathrm{NR}}$、$r_{\\mathrm{SR}}$ 和 $r_{\\mathrm{REL}}$。\n2. 对每个测试用例，计算相对于完全相对论情况的总键长误差、标量相对论贡献和自旋轨道耦合贡献，公式如下：\n$$\n\\Delta r_{\\mathrm{total}} = r_{\\mathrm{NR}} - r_{\\mathrm{REL}}, \\quad\n\\Delta r_{\\mathrm{scalar}} = r_{\\mathrm{NR}} - r_{\\mathrm{SR}}, \\quad\n\\Delta r_{\\mathrm{SO}} = r_{\\mathrm{SR}} - r_{\\mathrm{REL}}.\n$$\n3. 对每个测试用例，返回列表 $[\\Delta r_{\\mathrm{total}}, \\Delta r_{\\mathrm{scalar}}, \\Delta r_{\\mathrm{SO}}, \\mathrm{check}]$，其中 $\\mathrm{check}$ 是一个布尔值，如果 $\\left|\\Delta r_{\\mathrm{total}} - (\\Delta r_{\\mathrm{scalar}} + \\Delta r_{\\mathrm{SO}})\\right| \\le 10^{-9}$，则为 true，否则为 false。\n\n科学和数学细节：\n- 所有距离 $r$ 必须以埃（ångström）为单位，所有报告的差异 $\\Delta r$ 也必须以埃为单位。指数衰减常数 $\\mu$ 和 $\\lambda$ 的单位是埃的倒数（inverse ångströms）。能量 $A$、$B$ 和 $\\Delta$ 的单位是电子伏特（electronvolt）。自旋轨道参数 $s_{\\mathrm{SO}}$ 是无量纲的。\n- 假设 $B \\mu \\gt 2 \\lambda A$ 且 $\\mu \\gt 2 \\lambda$，以确保在所提供的所有测试用例中，平衡距离是有限的且对数函数的参数为正。\n\n测试套件：\n每个测试用例被指定为一个元组 $(B, \\mu, \\lambda_{\\mathrm{NR}}, c_{\\mathrm{SR}}, A_{\\mathrm{NR}}, \\Delta_{\\mathrm{NR}}, \\Delta_{\\mathrm{SR}}, s_{\\mathrm{SO}})$，其单位和含义如上文所定义。使用以下四种情况：\n- 情况 1：($50$, $4.0$, $1.30$, $1.05$, $4.0$, $2.2$, $1.4$, $0.20$)。\n- 情况 2：($50$, $4.0$, $1.30$, $1.05$, $4.0$, $2.2$, $1.4$, $0.00$)。\n- 情况 3：($45$, $4.2$, $1.45$, $1.05$, $4.8$, $2.4$, $1.8$, $0.15$)。\n- 情况 4：($60$, $3.6$, $1.25$, $1.01$, $4.2$, $2.3$, $2.0$, $0.10$)。\n\n程序规范：\n- 您的程序必须为每个测试用例计算以埃为单位的 $\\Delta r_{\\mathrm{total}}$、$\\Delta r_{\\mathrm{scalar}}$ 和 $\\Delta r_{\\mathrm{SO}}$ 值，以及如上定义的布尔值 $\\mathrm{check}$。\n- 您的程序应生成一行输出，其中包含一个由列表组成的逗号分隔列表（每个测试用例一个列表）的结果，格式必须完全如下：\n\"[[x11,x12,x13,x14],[x21,x22,x23,x24],[x31,x32,x33,x34],[x41,x42,x43,x44]]\"\n其中 $x_{i1}$、$x_{i2}$ 和 $x_{i3}$ 是浮点数（单位为埃），$x_{i4}$ 是一个布尔值。", "solution": "所提出的问题是计算化学中一个有效的理论练习。它在科学上基于一个简化的紧束缚模型，定义了所有必要的参数和关系，问题陈述清晰，并以客观、正式的语言表述。我们将着手解决。\n\n目标是分析相对论效应（分解为标量和自旋轨道贡献）对双原子分子平衡键长的影响。这是通过一个参数化的势能模型来实现的，其中参数被改变以反映不同层次的相对论理论（非相对论、标量相对论和完全相对论）。\n\n首先，我们推导平衡键长 $r_e$ 的通用表达式。势能 $E(r)$ 如下：\n$$\nE(r) = B e^{-\\mu r} - A e^{-2 \\lambda r}\n$$\n平衡键长对应于此函数的最小值，可通过将其关于核间距 $r$ 的一阶导数设为零来找到。\n$$\n\\frac{dE}{dr} = -B \\mu e^{-\\mu r} - A (-2 \\lambda) e^{-2 \\lambda r} = 0\n$$\n这给出了平衡条件：\n$$\nB \\mu e^{-\\mu r_e} = 2 A \\lambda e^{-2 \\lambda r_e}\n$$\n为了解出 $r_e$，我们重排该方程：\n$$\n\\frac{e^{-\\mu r_e}}{e^{-2 \\lambda r_e}} = \\frac{2 A \\lambda}{B \\mu}\n$$\n$$\ne^{(2\\lambda - \\mu)r_e} = \\frac{2 A \\lambda}{B \\mu}\n$$\n对两边取自然对数：\n$$\n(2\\lambda - \\mu)r_e = \\ln\\left(\\frac{2 A \\lambda}{B \\mu}\\right)\n$$\n假设 $\\mu > 2\\lambda$，为了确保在给定约束（$B\\mu > 2A\\lambda$）下分母和对数的参数均为正，将其写为以下形式更为方便：\n$$\n(\\mu - 2\\lambda)r_e = -\\ln\\left(\\frac{2 A \\lambda}{B \\mu}\\right) = \\ln\\left(\\left(\\frac{2 A \\lambda}{B \\mu}\\right)^{-1}\\right) = \\ln\\left(\\frac{B \\mu}{2 A \\lambda}\\right)\n$$\n因此，平衡键长 $r_e$ 的解析表达式为：\n$$\nr_e(A, \\lambda) = \\frac{1}{\\mu - 2\\lambda} \\ln\\left(\\frac{B \\mu}{2 A \\lambda}\\right)\n$$\n此公式将用于计算每种 ECP 变体的键长。参数 $B$ 和 $\\mu$ 在所有模型中保持不变。参数 $A$ 和 $\\lambda$ 则取决于 ECP 变体。让我们为每种情况定义它们。\n\n每个测试用例的输入是元组 $(B, \\mu, \\lambda_{\\mathrm{NR}}, c_{\\mathrm{SR}}, A_{\\mathrm{NR}}, \\Delta_{\\mathrm{NR}}, \\Delta_{\\mathrm{SR}}, s_{\\mathrm{SO}})$。\n\n1. **非相对论 (NR) 模型：**\n    参数直接从输入中获取。\n    $A_{\\mathrm{NR}}$ 是给定的。\n    $\\lambda_{\\mathrm{NR}}$ 是给定的。\n    键长为 $r_{\\mathrm{NR}} = r_e(A_{\\mathrm{NR}}, \\lambda_{\\mathrm{NR}})$。\n\n2. **标量相对论 (SR) 模型：**\n    参数由 NR 参数和相对论校正因子导出。\n    轨道衰减常数为 $\\lambda_{\\mathrm{SR}} = c_{\\mathrm{SR}} \\lambda_{\\mathrm{NR}}$。\n    成键参数 $A$ 受轨道衰减和能隙变化的双重调制：\n    $$\n    A_{\\mathrm{SR}} = A_{\\mathrm{NR}} \\left(\\frac{\\lambda_{\\mathrm{SR}}}{\\lambda_{\\mathrm{NR}}}\\right)^2 \\left(\\frac{\\Delta_{\\mathrm{NR}}}{\\Delta_{\\mathrm{SR}}}\\right) = A_{\\mathrm{NR}} c_{\\mathrm{SR}}^2 \\frac{\\Delta_{\\mathrm{NR}}}{\\Delta_{\\mathrm{SR}}}\n    $$\n    键长为 $r_{\\mathrm{SR}} = r_e(A_{\\mathrm{SR}}, \\lambda_{\\mathrm{SR}})$。\n\n3. **完全相对论 (REL) 模型：**\n    该模型同时包含标量和自旋轨道效应。\n    轨道衰减常数与 SR 情况相同：$\\lambda_{\\mathrm{REL}} = \\lambda_{\\mathrm{SR}}$。\n    自旋轨道耦合进一步改变能隙：$\\Delta_{\\mathrm{REL}} = \\Delta_{\\mathrm{SR}} (1 + s_{\\mathrm{SO}})$。\n    这导致了新的成键参数 $A_{\\mathrm{REL}}$：\n    $$\n    A_{\\mathrm{REL}} = A_{\\mathrm{NR}} \\left(\\frac{\\lambda_{\\mathrm{REL}}}{\\lambda_{\\mathrm{NR}}}\\right)^2 \\left(\\frac{\\Delta_{\\mathrm{NR}}}{\\Delta_{\\mathrm{REL}}}\\right) = A_{\\mathrm{NR}} c_{\\mathrm{SR}}^2 \\frac{\\Delta_{\\mathrm{NR}}}{\\Delta_{\\mathrm{SR}}(1 + s_{\\mathrm{SO}})} = \\frac{A_{\\mathrm{SR}}}{1 + s_{\\mathrm{SO}}}\n    $$\n    键长为 $r_{\\mathrm{REL}} = r_e(A_{\\mathrm{REL}}, \\lambda_{\\mathrm{REL}})$。\n\n利用这三个键长，我们计算所需的差异：\n总误差：$\\Delta r_{\\mathrm{total}} = r_{\\mathrm{NR}} - r_{\\mathrm{REL}}$\n标量相对论贡献：$\\Delta r_{\\mathrm{scalar}} = r_{\\mathrm{NR}} - r_{\\mathrm{SR}}$\n自旋轨道贡献：$\\Delta r_{\\mathrm{SO}} = r_{\\mathrm{SR}} - r_{\\mathrm{REL}}$\n\n最后，我们进行一致性检查。通过简单的代换，可以清楚地看到：\n$$\n\\Delta r_{\\mathrm{scalar}} + \\Delta r_{\\mathrm{SO}} = (r_{\\mathrm{NR}} - r_{\\mathrm{SR}}) + (r_{\\mathrm{SR}} - r_{\\mathrm{REL}}) = r_{\\mathrm{NR}} - r_{\\mathrm{REL}} = \\Delta r_{\\mathrm{total}}\n$$\n布尔变量 `check` 验证此恒等式在 $10^{-9}$ 的浮点容差内成立：\n$$\n\\mathrm{check} = \\left|\\Delta r_{\\mathrm{total}} - (\\Delta r_{\\mathrm{scalar}} + \\Delta r_{\\mathrm{SO}})\\right| \\le 10^{-9}\n$$\n\n解决方案要求为每个提供的测试用例实现这一系列计算，并按规定格式化输出。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the diatomic molecule bond length problem for a suite of test cases.\n    \"\"\"\n\n    # Test cases as tuples:\n    # (B, mu, lambda_NR, c_SR, A_NR, Delta_NR, Delta_SR, s_SO)\n    test_cases = [\n        (50.0, 4.0, 1.30, 1.05, 4.0, 2.2, 1.4, 0.20),\n        (50.0, 4.0, 1.30, 1.05, 4.0, 2.2, 1.4, 0.00),\n        (45.0, 4.2, 1.45, 1.05, 4.8, 2.4, 1.8, 0.15),\n        (60.0, 3.6, 1.25, 1.01, 4.2, 2.3, 2.0, 0.10),\n    ]\n\n    all_results = []\n\n    def calculate_r_e(B, mu, A, lam):\n        \"\"\"\n        Calculates the equilibrium bond length r_e.\n        r_e = (1 / (mu - 2*lambda)) * ln((B*mu) / (2*A*lambda))\n        \"\"\"\n        # Constraints from the problem statement ensure the arguments are valid.\n        # mu > 2*lambda and B*mu > 2*A*lambda\n        denominator = mu - 2.0 * lam\n        numerator_log = (B * mu) / (2.0 * A * lam)\n        return (1.0 / denominator) * np.log(numerator_log)\n\n    for case in test_cases:\n        B, mu, lambda_NR, c_SR, A_NR, Delta_NR, Delta_SR, s_SO = case\n\n        # Non-relativistic (NR) case\n        A_nr = A_NR\n        lambda_nr = lambda_NR\n        r_NR = calculate_r_e(B, mu, A_nr, lambda_nr)\n\n        # Scalar-relativistic (SR) case\n        lambda_sr = c_SR * lambda_nr\n        A_sr = A_NR * (c_SR ** 2) * (Delta_NR / Delta_SR)\n        r_SR = calculate_r_e(B, mu, A_sr, lambda_sr)\n\n        # Fully relativistic (REL) case\n        lambda_rel = lambda_sr\n        # A_rel can be computed from A_sr\n        A_rel = A_sr / (1.0 + s_SO)\n        r_REL = calculate_r_e(B, mu, A_rel, lambda_rel)\n\n        # Calculate differences\n        delta_r_total = r_NR - r_REL\n        delta_r_scalar = r_NR - r_SR\n        delta_r_so = r_SR - r_REL\n\n        # Consistency check\n        check = abs(delta_r_total - (delta_r_scalar + delta_r_so)) <= 1e-9\n\n        # Store results for this case\n        all_results.append([delta_r_total, delta_r_scalar, delta_r_so, check])\n\n    # Format the final output string as per problem specification.\n    # e.g., \"[[x11,x12,x13,true],[x21,x22,x23,true]]\"\n    outer_list_str = []\n    for res in all_results:\n        # Format boolean as lowercase 'true'/'false'\n        res_str = [f\"{v:.15f}\" for v in res[:3]] + [str(res[3]).lower()]\n        inner_list_str = f\"[{','.join(res_str)}]\"\n        outer_list_str.append(inner_list_str)\n    \n    final_string = f\"[{','.join(outer_list_str)}]\"\n    print(final_string)\n\nsolve()\n```", "id": "2454645"}, {"introduction": "任何近似方法都有其适用边界，理解这些边界是进行可靠科学计算的关键。本练习 [@problem_id:2454650] 通过一个精心设计的数学模型，要求你计算一个依赖于核附近电子密度的物理量，并揭示为何使用ECP会得到无意义的结果。这个实践将让你深刻理解赝势波函数在原子核区域的非物理性，并警示你在未来的研究中避免对ECP的误用。", "problem": "要求您在一个数学上受控的环境中，证明为何尝试使用有效芯势（ECP）计算依赖于芯层电子密度的性质会导致一个无意义的结果。请完全在原子单位下进行计算，其中玻尔半径为 $a_0 = 1$。考虑一个单电子、核电荷为 $Z$ 的类氢原子 $1s$ 态，其归一化的全电子径向波函数为 $\\psi_{1s}(r) = \\left(\\dfrac{Z^3}{\\pi}\\right)^{1/2} e^{-Z r}$，其电子密度为 $\\rho_{\\mathrm{AE}}(r;Z) = \\left|\\psi_{1s}(r)\\right|^2 = \\dfrac{Z^3}{\\pi} e^{-2 Z r}$。定义一个“展宽接触”可观测量（作为费米接触超精细相互作用的替代）为半径为 $r_s$ 的小球内的平均电子密度：\n$$\n\\overline{\\rho}_{\\mathrm{AE}}(Z,r_s) = \\frac{3}{r_s^3} \\int_{0}^{r_s} \\rho_{\\mathrm{AE}}(r;Z)\\, r^2 \\, \\mathrm{d}r.\n$$\n现在采用一个朴素的ECP模型，该模型通过在芯层半径 $r_c$ 内将赝密度设为零来移除芯层电子密度：\n$$\n\\rho_{\\mathrm{ECP}}(r;Z,r_c) = \n\\begin{cases}\n0, & 0 \\le r \\le r_c,\\\\\n\\rho_{\\mathrm{AE}}(r;Z), & r > r_c.\n\\end{cases}\n$$\n定义相应的展宽ECP可观测量\n$$\n\\overline{\\rho}_{\\mathrm{ECP}}(Z,r_c,r_s) = \\frac{3}{r_s^3} \\int_{\\max(0,r_c)}^{r_s} \\rho_{\\mathrm{AE}}(r;Z)\\, r^2 \\, \\mathrm{d}r,\n$$\n并理解为如果 $r_c \\ge r_s$，则积分为零。您的任务是：\n- 从给定的定义和标准积分出发，推导比率的闭式表达式\n$$\nR(Z,r_c,r_s) = \\frac{\\overline{\\rho}_{\\mathrm{ECP}}(Z,r_c,r_s)}{\\overline{\\rho}_{\\mathrm{AE}}(Z,r_s)}.\n$$\n- 实现一个程序，以原子单位计算下面每个测试用例的 $R(Z,r_c,r_s)$。程序不应需要任何外部输入。\n\n测试套件（每个元组为 $(Z,r_c,r_s)$）：\n- $(1, 0.05, 0.2)$\n- $(1, 0.2, 0.2)$\n- $(6, 0.02, 0.2)$\n- $(10, 0.05, 0.2)$\n- $(2, 0.0, 0.2)$\n\n您的程序应生成单行输出，其中包含用方括号括起来的、以逗号分隔的结果列表（例如，$[\\text{result}_1,\\text{result}_2,\\dots]$）。每个结果必须是四舍五入到 $6$ 位小数的浮点数。该可观测量的期望单位是 $a_0^{-3}$，但由于要求您返回比率 $R(Z,r_c,r_s)$，最终报告的数字是无量纲的。在您的解释中，说明为什么当用于近似依赖于芯层电子密度的性质（如原子核处的电场梯度或费米接触项）时，这种基于朴素ECP的可观测量是无意义的。", "solution": "所提出的问题已经过验证，被认为是具有科学依据、提法恰当且客观的。它构成了一个有效的练习，用以展示计算化学中有效芯势（ECP）方法的一个基本局限性。因此，我们接下来进行完整的解析推导和计算实现。\n\n任务是为简化的类氢体系推导并计算比率 $R(Z,r_c,r_s) = \\overline{\\rho}_{\\mathrm{ECP}} / \\overline{\\rho}_{\\mathrm{AE}}$。我们首先推导这两个可观测量的表达式。\n\n首先，我们计算全电子（AE）展宽接触可观测量 $\\overline{\\rho}_{\\mathrm{AE}}(Z,r_s)$。这需要计算在半径为 $r_s$ 的球体内的径向概率密度 $4\\pi r^2 \\rho_{\\mathrm{AE}}(r;Z)$ 的积分。给出的定义是 $\\overline{\\rho}_{\\mathrm{AE}}(Z,r_s) = \\frac{3}{r_s^3} \\int_{0}^{r_s} \\rho_{\\mathrm{AE}}(r;Z)\\, r^2 \\, \\mathrm{d}r$。给定 $\\rho_{\\mathrm{AE}}(r;Z) = \\frac{Z^3}{\\pi} e^{-2 Z r}$，积分部分为：\n$$\nI_{\\mathrm{AE}} = \\int_{0}^{r_s} \\rho_{\\mathrm{AE}}(r;Z)\\, r^2 \\, \\mathrm{d}r = \\frac{Z^3}{\\pi} \\int_{0}^{r_s} r^2 e^{-2 Z r} \\mathrm{d}r\n$$\n为了求解这个积分，我们利用不定积分的标准形式：\n$$\n\\int r^2 e^{ar} \\mathrm{d}r = e^{ar} \\left( \\frac{r^2}{a} - \\frac{2r}{a^2} + \\frac{2}{a^3} \\right)\n$$\n通过代换 $a = -2Z$，我们得到：\n$$\n\\int r^2 e^{-2Zr} \\mathrm{d}r = -e^{-2Zr} \\left( \\frac{r^2}{2Z} + \\frac{2r}{4Z^2} + \\frac{2}{8Z^3} \\right) = -\\frac{e^{-2Zr}}{4Z^3} (2Z^2r^2 + 2Zr + 1)\n$$\n计算从 $0$ 到 $r_s$ 的定积分：\n$$\n\\int_{0}^{r_s} r^2 e^{-2Zr} \\mathrm{d}r = \\left[ -\\frac{e^{-2Zr}}{4Z^3} \\left( 2Z^2r^2 + 2Zr + 1 \\right) \\right]_{0}^{r_s}\n$$\n$$\n= \\left( -\\frac{e^{-2Zr_s}}{4Z^3} \\left( 2Z^2r_s^2 + 2Zr_s + 1 \\right) \\right) - \\left( -\\frac{e^{0}}{4Z^3} (0 + 0 + 1) \\right)\n$$\n$$\n= \\frac{1}{4Z^3} \\left( 1 - e^{-2Zr_s} \\left( 2Z^2r_s^2 + 2Zr_s + 1 \\right) \\right)\n$$\n将此结果代回 $I_{\\mathrm{AE}}$ 的表达式，然后再代入 $\\overline{\\rho}_{\\mathrm{AE}}(Z,r_s)$：\n$$\nI_{\\mathrm{AE}} = \\frac{Z^3}{\\pi} \\frac{1}{4Z^3} \\left( 1 - e^{-2Zr_s} (2Z^2r_s^2 + 2Zr_s + 1) \\right) = \\frac{1}{4\\pi} \\left( 1 - e^{-2Zr_s} (2Z^2r_s^2 + 2Zr_s + 1) \\right)\n$$\n$$\n\\overline{\\rho}_{\\mathrm{AE}}(Z,r_s) = \\frac{3}{r_s^3} I_{\\mathrm{AE}} = \\frac{3}{4\\pi r_s^3} \\left( 1 - e^{-2Zr_s} (2Z^2r_s^2 + 2Zr_s + 1) \\right)\n$$\n接下来，我们计算ECP可观测量 $\\overline{\\rho}_{\\mathrm{ECP}}(Z,r_c,r_s)$。ECP 模型将 $r \\le r_c$ 的密度设为零。因此，积分的下限从 $r_c$ 开始。\n$$\n\\overline{\\rho}_{\\mathrm{ECP}}(Z,r_c,r_s) = \\frac{3}{r_s^3} \\int_{r_c}^{r_s} \\rho_{\\mathrm{AE}}(r;Z)\\, r^2 \\, \\mathrm{d}r\n$$\n这适用于 $0 \\le r_c < r_s$ 的情况。如果 $r_c \\ge r_s$，积分区间为空或长度为零，积分严格为零。对于 $r_c < r_s$，我们使用与之前相同的不定积分，但使用新的积分限：\n$$\nI_{\\mathrm{ECP}} = \\int_{r_c}^{r_s} \\rho_{\\mathrm{AE}}(r;Z)\\, r^2 \\, \\mathrm{d}r = \\frac{Z^3}{\\pi} \\left[ -\\frac{e^{-2Zr}}{4Z^3} \\left( 2Z^2r^2 + 2Zr + 1 \\right) \\right]_{r_c}^{r_s}\n$$\n$$\nI_{\\mathrm{ECP}} = \\frac{1}{4\\pi} \\left[ -e^{-2Zr} \\left( 2Z^2r^2 + 2Zr + 1 \\right) \\right]_{r_c}^{r_s}\n$$\n$$\nI_{\\mathrm{ECP}} = \\frac{1}{4\\pi} \\left( e^{-2Zr_c}(2Z^2r_c^2 + 2Zr_c + 1) - e^{-2Zr_s}(2Z^2r_s^2 + 2Zr_s + 1) \\right)\n$$\n比率 $R(Z,r_c,r_s)$ 是 $\\overline{\\rho}_{\\mathrm{ECP}} / \\overline{\\rho}_{\\mathrm{AE}} = I_{\\mathrm{ECP}} / I_{\\mathrm{AE}}$，因为前置因子 $\\frac{3}{r_s^3}$ 完全抵消了。\n$$\nR(Z,r_c,r_s) = \\frac{e^{-2Zr_c}(2Z^2r_c^2 + 2Zr_c + 1) - e^{-2Zr_s}(2Z^2r_s^2 + 2Zr_s + 1)}{1 - e^{-2Zr_s}(2Z^2r_s^2 + 2Zr_s + 1)} \\quad \\text{对于 } r_c < r_s\n$$\n在 $r_c \\ge r_s$ 的情况下，我们有 $\\overline{\\rho}_{\\mathrm{ECP}} = 0$，这意味着 $R(Z,r_c,r_s) = 0$。\n一个特殊的平凡情况是 $r_c = 0$。此时，分子变为 $e^0(0+0+1) - e^{-2Zr_s}(...)$，与分母相同，得到 $R(Z,0,r_s)=1$。这是正确的，因为芯层半径为零的ECP等同于全电子计算。\n\n我们实现这个关于 $R(Z,r_c,r_s)$ 的闭式表达式来评估指定的测试用例。\n\n物理解释展示了这种朴素ECP方法的失败之处。有效芯势的构建是为了重现价层性质，例如轨道能量和远离原子核的电子密度空间分布。它们通过用一个较弱的赝势替换强库仑势和芯层电子的复杂效应来实现这一点。这个过程产生了无节点的价层赝波函数，这些函数在计算上很方便，但在芯区（$r < r_c$）是物理上不正确的。\n\n诸如费米接触相互作用、原子核处的电场梯度以及穆斯堡尔同质异能位移等性质，关键性地依赖于原子核处或其附近（$r \\to 0$）的电子密度及其梯度。ECP模型根据其设计初衷，移除了芯层电子并在此关键区域将电子密度设为零。正如我们在对案例 $(Z, r_c, r_s) = (1, 0.2, 0.2)$ 的计算中所示，如果采样半径 $r_s$ 小于或等于芯层半径 $r_c$，基于ECP的可观测量恰好为零。这是一个灾难性的失败，与非零的全电子结果相比，产生了无限大的相对误差。\n\n即使当 $r_c < r_s$ 时，ECP的结果也对人为参数 $r_c$ 高度敏感。对于具有较大 $Z$ 的重原子（例如 $Z=10$），芯层密度更集中在原子核附近。即使对于一个小的 $r_c$（例如 $0.05$ a.u.），移除这部分密度也会导致严重不正确的结果，如测试用例 $(10, 0.05, 0.2)$ 所示，其误差超过 $10\\%$。$r_c$ 的值是一个为了计算方便而设的参数，并非一个物理可观测量。任何强烈依赖于 $r_c$ 的计算性质，根据定义，都是一个非物理的人为产物。结论是不可避免的：ECP从根本上不适合用于计算依赖于芯区内电子密度的性质。尝试这样做是对该方法的误用，并会导致无意义的、任意的结果。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem of computing the ratio R(Z, r_c, r_s) for a set of test cases.\n    \"\"\"\n\n    test_cases = [\n        (1, 0.05, 0.2),  # Z, r_c, r_s in atomic units\n        (1, 0.2, 0.2),\n        (6, 0.02, 0.2),\n        (10, 0.05, 0.2),\n        (2, 0.0, 0.2),\n    ]\n\n    def calculate_R(Z, r_c, r_s):\n        \"\"\"\n        Calculates the ratio R for a given set of parameters Z, r_c, and r_s.\n\n        The ratio is defined as:\n        R = [exp(-2*Z*r_c)*P(r_c) - exp(-2*Z*r_s)*P(r_s)] / [1 - exp(-2*Z*r_s)*P(r_s)]\n        where P(r) = (2*Z^2*r^2 + 2*Z*r + 1).\n\n        Args:\n            Z (float): Nuclear charge.\n            r_c (float): Core radius.\n            r_s (float): Smearing radius.\n\n        Returns:\n            float: The calculated ratio R.\n        \"\"\"\n        # If the core radius is greater than or equal to the smearing radius,\n        # the ECP observable integral becomes zero.\n        if r_c >= r_s:\n            return 0.0\n\n        # Define a helper function for the polynomial term P(r) = 2*Z^2*r^2 + 2*Z*r + 1\n        def poly(r, Z_val):\n            term1 = 2 * (Z_val * r)**2\n            term2 = 2 * Z_val * r\n            return term1 + term2 + 1\n\n        # Calculate exponential terms\n        exp_rc = np.exp(-2 * Z * r_c)\n        exp_rs = np.exp(-2 * Z * r_s)\n        \n        # Calculate polynomial terms\n        poly_rc = poly(r_c, Z)\n        poly_rs = poly(r_s, Z)\n\n        # Numerator of the ratio R\n        numerator = exp_rc * poly_rc - exp_rs * poly_rs\n        \n        # Denominator of the ratio R\n        denominator = 1.0 - exp_rs * poly_rs\n\n        # It is a mathematical certainty that for r_s > 0 the denominator is non-zero.\n        # The integrated probability inside the sphere must be less than 1, so\n        # 4*pi*I_AE < 1, which implies 1 - exp(...)*P(...) > 0.\n        if denominator == 0:\n            # This case physically corresponds to r_s -> infinity, where R->1.\n            # For finite r_s, this should not happen. It might indicate a precision issue\n            # if r_s is extremely large, but is safe to handle.\n            # A special case is r_c = 0 where num=den, so R=1.\n            if numerator == denominator:\n                return 1.0\n            else: # Should not be reached with valid inputs.\n                return np.nan\n\n        return numerator / denominator\n\n    results = []\n    for case in test_cases:\n        Z, r_c, r_s = case\n        result = calculate_R(Z, r_c, r_s)\n        results.append(f\"{result:.6f}\")\n\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n\n```", "id": "2454650"}]}