{"hands_on_practices": [{"introduction": "我们从一个基础练习开始。在绘制复杂分子的静电势图之前，我们必须掌握其核心原理：一个量子力学电荷分布如何产生经典的静电场。这个练习将指导你计算最简单的量子体系——氢原子电子云——所产生的电势，从而将量子力学波函数的概念与经典静电学直接联系起来[@problem_id:1834886]。", "problem": "在氢原子的量子力学描述中，电子并非一个点粒子，而是由一个决定其在特定位置被发现的概率的波函数来描述。对于处于基态的氢原子，该波函数是球对称的，由下式给出：\n$$\n\\psi_{100}(r) = \\frac{1}{\\sqrt{\\pi a_0^3}} \\exp\\left(-\\frac{r}{a_0}\\right)\n$$\n其中 $r$ 是距原子核的距离，$a_0$ 是玻尔半径。电子的电荷（值为 $-e$）可以被视为一个连续的电荷分布，或称“电荷云”，其电荷密度由 $\\rho(\\vec{r}) = -e |\\psi_{100}(r)|^2$ 给出。这种电荷分布在整个空间中产生电势。\n\n假设原子核是位于原点（$r=0$）的一个点状质子，请计算由电子电荷云在原子核位置处产生的电势。\n\n请用元电荷 $e$、玻尔半径 $a_0$ 和自由空间介电常数 $\\epsilon_0$ 来表示你的答案，给出一个闭合形式的解析表达式。", "solution": "基态类氢原子波函数是球对称的：\n$$\n\\psi_{100}(r)=\\frac{1}{\\sqrt{\\pi a_{0}^{3}}}\\exp\\left(-\\frac{r}{a_{0}}\\right),\n$$\n因此电子电荷密度为\n$$\n\\rho(\\vec{r})=-e|\\psi_{100}(r)|^{2}=-\\frac{e}{\\pi a_{0}^{3}}\\exp\\left(-\\frac{2r}{a_{0}}\\right).\n$$\n由电荷分布产生的静电势为\n$$\nV(\\vec{r})=\\frac{1}{4\\pi\\epsilon_{0}}\\int \\frac{\\rho(\\vec{r}\\,')}{|\\vec{r}-\\vec{r}\\,'|}\\,d^{3}r'.\n$$\n在原点 $\\vec{r}=\\vec{0}$ 处，该式变为\n$$\nV(0)=\\frac{1}{4\\pi\\epsilon_{0}}\\int \\frac{\\rho(r')}{r'}\\,d^{3}r'=\\frac{1}{4\\pi\\epsilon_{0}}\\int_{0}^{\\infty}\\int \\frac{\\rho(r')}{r'}\\,r'^{2}\\sin\\theta\\,d\\theta\\,d\\phi\\,dr'.\n$$\n利用球对称性，$\\int d\\Omega=4\\pi$，我们得到\n$$\nV(0)=\\frac{1}{4\\pi\\epsilon_{0}}\\cdot 4\\pi \\int_{0}^{\\infty}\\rho(r')\\,r'\\,dr'=\\frac{1}{\\epsilon_{0}}\\int_{0}^{\\infty}\\rho(r)\\,r\\,dr.\n$$\n代入 $\\rho(r)=-\\frac{e}{\\pi a_{0}^{3}}\\exp\\left(-\\frac{2r}{a_{0}}\\right)$，\n$$\nV(0)=-\\frac{e}{\\pi a_{0}^{3}\\epsilon_{0}}\\int_{0}^{\\infty}r\\,\\exp\\left(-\\frac{2r}{a_{0}}\\right)dr.\n$$\n使用标准积分 $\\int_{0}^{\\infty} r \\exp(-br)\\,dr=\\frac{1}{b^{2}}$（对于 $b>0$），并取 $b=\\frac{2}{a_{0}}$，我们得到\n$$\n\\int_{0}^{\\infty} r \\exp\\left(-\\frac{2r}{a_{0}}\\right)dr=\\frac{a_{0}^{2}}{4}.\n$$\n因此，\n$$\nV(0)=-\\frac{e}{\\pi a_{0}^{3}\\epsilon_{0}}\\cdot \\frac{a_{0}^{2}}{4}=-\\frac{e}{4\\pi\\epsilon_{0}a_{0}}.\n$$\n这个值是负的，这与一个球对称的负电荷云在原点处产生的电势的预期相符。", "answer": "$$\\boxed{-\\frac{e}{4 \\pi \\epsilon_{0} a_{0}}}$$", "id": "1834886"}, {"introduction": "我们的第一个练习假设原子核是点状的，但在高精度计算中，这是一种过度简化。这个练习将探讨如何将原子核建模为有限尺寸的电荷分布，这是精确描述原子中心附近静电势的关键一步。你将推导这些更真实的模型如何“正则化”电势，避免点电荷带来的无物理意义的奇点[@problem_id:2771360]。", "problem": "在分子和离子的静电势图绘制中，对静电势的核贡献通常采用超出点电荷近似的模型，以考虑核电荷的有限范围。考虑一个总电荷为 $+Z e$ 的原子核，其具有球对称电荷密度 $\\rho(r)$，并通过 $\\int \\rho(\\mathbf{r})\\, d^3 r = Z e$ 进行归一化。定义 $V(r)$ 为一个电荷为 $-e$ 的电子在距离核中心 $r$ 处的静电势能，因此对于点核模型，$V_{\\mathrm{pt}}(r) = - \\dfrac{Z e^2}{4 \\pi \\varepsilon_0 r}$。\n\n两种标准的有限核模型是：\n- 高斯模型，$\\rho_{G}(r) = Z e \\left(\\dfrac{\\alpha}{\\pi}\\right)^{3/2} \\exp\\!\\left(-\\alpha r^2\\right)$，其中宽度参数 $\\alpha > 0$。\n- 双参数费米(2pF)模型，$\\rho_{F}(r) = \\dfrac{\\rho_0}{1 + \\exp\\!\\left(\\dfrac{r - c}{a}\\right)}$，其中弥散度 $a > 0$，半密度半径 $c > 0$，且 $\\rho_0$ 通过归一化到 $Z e$ 来确定。\n\n仅从静电势 $\\phi$ 的基本静电学关系 $\\nabla^2 \\phi(\\mathbf{r}) = - \\rho(\\mathbf{r})/\\varepsilon_0$ 和关系式 $V(r) = - e\\, \\phi(r)$ 出发，并利用球对称性，完成以下任务：\n\n1) 推导一个用 $\\rho(r)$ 表示的 $V(r)$ 的一般球对称表达式，该表达式能明确说明当 $\\rho(0)$ 有限时，在 $r \\to 0$ 处对 $1/r$ 发散的正则化。从你的表达式中，提取对于一个光滑且 $\\rho(0) < \\infty$ 的 $\\rho(r)$，$V(r)$ 在小 $r$ 处的主导行为。\n\n2) 将你的一般结果应用于高斯模型，获得一个对所有 $r \\ge 0$ 都有效的 $V_{G}(r)$ 的闭合形式表达式。从你的表达式中证明 $V_{G}(0)$ 是有限且非零的。\n\n3) 将你的一般结果应用于双参数费米模型，获得 $V_{F}(r)$ 在小 $r$ 处的主导展开式，直到并包括与 $r^2$ 成正比的项，用 $\\rho_0$、$a$ 和 $c$ 表示。\n\n4) 通过将你找到的小 $r$ 渐近行为与点核行为 $V_{\\mathrm{pt}}(r)$ 进行比较，量化有限尺寸模型和点核模型之间的差异。解释有限尺寸模型在何种数学意义上对 $r = 0$ 处的发散进行正则化，并指出在每个模型中控制正则化的长度标度。\n\n最后，令 $R \\equiv \\sqrt{\\langle r^2 \\rangle}$ 表示从高斯密度计算出的均方根(RMS)半径，即 $\\rho_G(r)/(Z e)$ 的二阶矩的平方根。将你的最终答案表示为无量纲比率\n$$\n\\mathcal{R} \\equiv \\frac{V_{G}(0)}{- \\dfrac{Z e^2}{4 \\pi \\varepsilon_0 R}} \\, .\n$$\n的单个闭合形式解析表达式。\n不需要进行数值计算。将你的最终答案以单个表达式的形式给出。答案是无量纲的；不要包含单位。不要四舍五入。", "solution": "我们从泊松方程 $\\nabla^2 \\phi(\\mathbf{r}) = - \\rho(\\mathbf{r})/\\varepsilon_0$ 和电子静电势能的定义 $V(r) = - e\\, \\phi(r)$ 出发。对于球对称电荷密度 $\\rho(r)$，电场是径向的，根据高斯定律可得\n$$\nE(r) = - \\frac{d \\phi}{d r} = \\frac{1}{4 \\pi \\varepsilon_0} \\frac{Q(r)}{r^2} \\, ,\n$$\n其中包裹的电荷为 $Q(r) = 4 \\pi \\int_{0}^{r} \\rho(r')\\, r'^{2}\\, dr'$。将电场从 $r$ 积分到 $\\infty$ 得到电势\n$$\n\\phi(r) = \\int_{r}^{\\infty} \\frac{Q(r')}{4 \\pi \\varepsilon_0\\, r'^{2}}\\, dr' \\, ,\n$$\n对于局域电荷分布，有 $\\phi(\\infty) = 0$。等价地，通过直接卷积，\n$$\n\\phi(\\mathbf{r}) = \\frac{1}{4 \\pi \\varepsilon_0} \\int \\frac{\\rho(\\mathbf{r}')}{|\\mathbf{r} - \\mathbf{r}'|}\\, d^{3} r' \\, .\n$$\n在原点 $r = 0$ 处求值，利用球对称性可得\n$$\n\\phi(0) = \\frac{1}{4 \\pi \\varepsilon_0} \\int \\frac{\\rho(r')}{r'}\\, d^{3} r' = \\frac{1}{\\varepsilon_0} \\int_{0}^{\\infty} \\rho(r')\\, r'\\, dr' \\, ,\n$$\n只要 $\\rho(r)$ 在 $r=0$ 处是有限的，并且在无穷远处衰减得足够快，该值就是有限的。\n\n第1部分：一般的小 $r$ 行为。将一个光滑的球对称 $\\rho(r)$ 在原点附近展开为 $\\rho(r) = \\rho(0) + \\frac{1}{2} \\rho''(0)\\, r^{2} + \\mathcal{O}(r^{4})$。那么\n$$\nQ(r) = 4 \\pi \\int_{0}^{r} \\left[\\rho(0) + \\frac{1}{2} \\rho''(0)\\, r'^{2} + \\cdots \\right] r'^{2}\\, dr' = \\frac{4 \\pi}{3} \\rho(0)\\, r^{3} + \\frac{4 \\pi}{10} \\rho''(0)\\, r^{5} + \\cdots \\, .\n$$\n因此\n$$\nE(r) = \\frac{1}{4 \\pi \\varepsilon_0} \\frac{Q(r)}{r^{2}} = \\frac{\\rho(0)}{3 \\varepsilon_0}\\, r + \\frac{\\rho''(0)}{10 \\varepsilon_0}\\, r^{3} + \\cdots \\, ,\n$$\n并将 $E(r) = - d \\phi/dr$ 从 $0$ 积分到 $r$ 得到\n$$\n\\phi(r) = \\phi(0) - \\frac{\\rho(0)}{6 \\varepsilon_0}\\, r^{2} - \\frac{\\rho''(0)}{40 \\varepsilon_0}\\, r^{4} + \\cdots \\, .\n$$\n因此，电子势能的行为是\n$$\nV(r) = - e\\, \\phi(r) = V(0) + \\frac{e\\, \\rho(0)}{6 \\varepsilon_0}\\, r^{2} + \\frac{e\\, \\rho''(0)}{40 \\varepsilon_0}\\, r^{4} + \\cdots \\, ,\n$$\n只要 $\\rho(0)$ 是有限的，它在 $r=0$ 处就是有限的。这证明了正则化：点核的 $1/r$ 发散被一个有限的 $V(0)$ 和一个关于 $r$ 的解析偶次幂展开所取代。\n\n第2部分：高斯模型。取 $\\rho_{G}(r) = Z e \\left(\\dfrac{\\alpha}{\\pi}\\right)^{3/2} \\exp(- \\alpha r^{2})$。一个便捷的途径是使用傅里叶变换。库仑核的傅里叶变换满足 $\\phi(\\mathbf{k}) = \\rho(\\mathbf{k})/(\\varepsilon_0 k^{2})$，归一化高斯函数的变换为 $\\rho_{G}(\\mathbf{k}) = Z e\\, \\exp\\!\\left(- \\dfrac{k^{2}}{4 \\alpha}\\right)$。进行逆变换得到一个球对称电势\n$$\n\\phi_{G}(r) = \\frac{Z e}{4 \\pi \\varepsilon_0\\, r}\\, \\operatorname{erf}\\!\\left(\\sqrt{\\alpha}\\, r\\right) \\, ,\n$$\n其中 $\\operatorname{erf}(x)$ 是误差函数。相应的电子势能是\n$$\nV_{G}(r) = - e\\, \\phi_{G}(r) = - \\frac{Z e^{2}}{4 \\pi \\varepsilon_0\\, r}\\, \\operatorname{erf}\\!\\left(\\sqrt{\\alpha}\\, r\\right) \\, .\n$$\n当 $x \\to 0$ 时，使用 $\\operatorname{erf}(x) \\sim \\dfrac{2}{\\sqrt{\\pi}} x + \\mathcal{O}(x^{3})$，我们得到在原点处的有限极限\n$$\nV_{G}(0) = - \\frac{Z e^{2}}{4 \\pi \\varepsilon_0}\\, \\frac{2 \\sqrt{\\alpha}}{\\sqrt{\\pi}} \\, .\n$$\n等价地，可以通过在原点处的卷积计算 $\\phi_{G}(0)$：\n$$\n\\phi_{G}(0) = \\frac{1}{\\varepsilon_0} \\int_{0}^{\\infty} \\rho_{G}(r)\\, r\\, dr = \\frac{Z e}{\\varepsilon_0} \\left(\\frac{\\alpha}{\\pi}\\right)^{3/2} \\int_{0}^{\\infty} r\\, \\exp(- \\alpha r^{2})\\, dr = \\frac{Z e}{4 \\pi \\varepsilon_0}\\, \\frac{2 \\sqrt{\\alpha}}{\\sqrt{\\pi}} \\, ,\n$$\n与上述极限一致。\n\n高斯均方根(RMS)半径 $R \\equiv \\sqrt{\\langle r^{2} \\rangle}$ 可由\n$$\n\\langle r^{2} \\rangle = \\frac{1}{Z e} \\int r^{2}\\, \\rho_{G}(r)\\, d^{3} r = \\frac{3}{2 \\alpha} \\, ,\n$$\n得出，因此 $\\sqrt{\\alpha} = \\sqrt{\\dfrac{3}{2}}\\, \\dfrac{1}{R}$。所以\n$$\nV_{G}(0) = - \\frac{Z e^{2}}{4 \\pi \\varepsilon_0}\\, \\frac{2}{\\sqrt{\\pi}}\\, \\sqrt{\\frac{3}{2}}\\, \\frac{1}{R} = - \\frac{Z e^{2}}{4 \\pi \\varepsilon_0}\\, \\sqrt{\\frac{6}{\\pi}}\\, \\frac{1}{R} \\, .\n$$\n\n第3部分：双参数费米(2pF)模型。取 $\\rho_{F}(r) = \\dfrac{\\rho_{0}}{1 + \\exp\\!\\left(\\dfrac{r - c}{a}\\right)}$。上述一般表达式给出\n$$\n\\phi_{F}(0) = \\frac{1}{\\varepsilon_0} \\int_{0}^{\\infty} \\frac{\\rho_{0}}{1 + \\exp\\!\\left(\\dfrac{r - c}{a}\\right)}\\, r\\, dr \\, , \\quad V_{F}(0) = - e\\, \\phi_{F}(0) \\, .\n$$\n对于小 $r$ 展开，我们只需要 $\\rho_{F}(0)$ 和在原点处的光滑性。因为 $\\rho_{F}(r)$ 在 $r \\ge 0$ 上是有限且解析的，所以第1部分中的一般小 $r$ 级数适用。特别地，\n$$\n\\rho_{F}(0) = \\frac{\\rho_{0}}{1 + \\exp\\!\\left(- \\dfrac{c}{a}\\right)} \\, ,\n$$\n因此\n$$\nV_{F}(r) = V_{F}(0) + \\frac{e}{6 \\varepsilon_0}\\, \\rho_{F}(0)\\, r^{2} + \\mathcal{O}(r^{4}) = V_{F}(0) + \\frac{e\\, \\rho_{0}}{6 \\varepsilon_0 \\left[1 + \\exp\\!\\left(- \\dfrac{c}{a}\\right)\\right]}\\, r^{2} + \\mathcal{O}(r^{4}) \\, .\n$$\n常数 $V_{F}(0)$ 是有限的，可以写成上面展示的收敛积分；当用 $a$ 和 $c$ 表示时，其精确的闭合形式涉及特殊函数，但其有限性和解析偶次幂展开由光滑、有限的 $\\rho_{F}(r)$ 保证。\n\n第4部分：量化与点核的差异。对于点核，$V_{\\mathrm{pt}}(r) = - \\dfrac{Z e^{2}}{4 \\pi \\varepsilon_0 r}$ 在 $r \\to 0$ 时发散。对于任一种有限尺寸模型，我们有\n$$\nV(r) = V(0) + \\mathcal{O}(r^{2}) \\quad \\text{当 } r \\to 0 \\, ,\n$$\n其中 $V(0)$ 是有限的。因此，发散被正则化为一个有限值，该值由中心密度通过曲率项 $\\dfrac{e\\, \\rho(0)}{6 \\varepsilon_0}\\, r^{2} + \\cdots$ 控制。对于高斯模型，特征正则化长度标度是高斯宽度 $1/\\sqrt{\\alpha}$（等价于RMS半径 $R$）；对于双参数费米模型，则是表面弥散度 $a$ 和 $c$（它设定了整体尺度）。在大的 $r$ 处，两种有限尺寸模型都恢复到点核行为，其中高斯修正的衰减方式为\n$$\nV_{G}(r) - V_{\\mathrm{pt}}(r) = - \\frac{Z e^{2}}{4 \\pi \\varepsilon_0 r} \\left[ \\operatorname{erf}\\!\\left(\\sqrt{\\alpha}\\, r\\right) - 1 \\right] \\sim \\frac{Z e^{2}}{4 \\pi \\varepsilon_0}\\, \\frac{2 \\sqrt{\\alpha}}{\\sqrt{\\pi}}\\, \\frac{\\exp(- \\alpha r^{2})}{r} \\quad \\text{当 } r \\to \\infty \\, ,\n$$\n这表明相对于库仑尾，存在快速的高斯抑制。\n\n最终比率。使用以RMS半径 $R$ 表示的高斯 $V_{G}(0)$，\n$$\nV_{G}(0) = - \\frac{Z e^{2}}{4 \\pi \\varepsilon_0}\\, \\sqrt{\\frac{6}{\\pi}}\\, \\frac{1}{R} \\, ,\n$$\n我们将其与参考量级 $-\\dfrac{Z e^{2}}{4 \\pi \\varepsilon_0 R}$ 进行比较，得到无量纲比率\n$$\n\\mathcal{R} \\equiv \\frac{V_{G}(0)}{- \\dfrac{Z e^{2}}{4 \\pi \\varepsilon_0 R}} = \\sqrt{\\frac{6}{\\pi}} \\, .\n$$\n这是一个纯数，它为高斯模型量化了在原点处的有限尺寸正则化值与在RMS半径处评估的点核电势的比较情况。", "answer": "$$\\boxed{\\sqrt{\\frac{6}{\\pi}}}$$", "id": "2771360"}, {"introduction": "理论模型必须通过数值方法实现，而这个过程会引入近似误差。这最后一个练习将让你掌握计算科学中的一项基本技能：如何测试并确保你的计算结果相对于关键数值参数（如网格间距、模拟晶胞大小和倒易空间截断）的收敛性。你将学习从第一性原理出发证明误差模型的合理性，并应用它们将计算结果外推到精确、无误差的极限[@problem_id:2771336]。", "problem": "将一个中性、刚性的极性分子（偶极矩非零，净电荷为零）置于真空中，并在其电子密度最大值附近的一个固定点 $\\mathbf{r}_0$ 处计算其静电势 $V(\\mathbf{r})$。该计算在边长为 $L$ 的立方晶胞中，采用周期性边界条件，通过求解原子单位制下的泊松方程 $\\nabla^2 V(\\mathbf{r}) = -4\\pi \\rho(\\mathbf{r})$ 来进行。求解过程使用：\n- 在间距为 $h$ 的均匀实空间网格上，使用二阶中心差分的有限差分离散化，\n- 使用高斯屏蔽参数 $\\alpha$ 的埃瓦尔德分解，\n- 在 $k_{\\max}$ 处进行倒易空间截断，\n- 以及一个足够大的实空间截断，以至于在明确标明的数据集中，实空间截断误差可以忽略不计。\n\n你需要从泊松方程、傅里叶表示和多极展开的第一性原理出发，对 $V(\\mathbf{r}_0)$ 构建关于 $h$、$L$ 和 $k_{\\max}$ 的收敛性测试，并执行稳健的外推来消除各种来源的误差。\n\n任务：\n1) 从第一性原理出发，证明在给定条件下，$V(\\mathbf{r}_0)$ 的三种误差贡献的领导阶渐近形式，即：\n- 对于光滑的 $V$，当 $h \\to 0$ 时，来自二阶格式的离散化误差与 $C_h h^2$ 成比例，\n- 对于具有非零偶极矩的中性晶胞，当 $L \\to \\infty$ 时，周期性镜像（有限尺寸）误差与 $C_L L^{-3}$ 成比例，\n- 在固定的 $\\alpha$ 下，当 $k_{\\max} \\to \\infty$ 时，倒易空间截断误差与 $C_k \\exp\\!\\big(-k_{\\max}^2/(4\\alpha^2)\\big)$ 成比例。\n\n2) 使用以下三个独立生成的关于 $V(\\mathbf{r}_0)$ 的数据集（以原子单位表示），设计并执行稳健的外推程序，以消除与 $h$、$L$ 和 $k_{\\max}$ 相关的误差。在每个阶段，请明确指出你所使用的回归变量和估计量。假设在所给的设置下，数据集中未作为重点研究的其它误差来源可以忽略不计。\n\n数据集A（固定 $L$ 和 $k_{\\max}$ 下的网格间距收敛性）：\n- 固定参数：$L = 60$ bohr, $\\alpha = 1.0$ bohr$^{-1}$, $k_{\\max} = 8$ bohr$^{-1}$。\n- 数据：$(h, V)$ 分别为\n  - $(0.8,\\, -0.2383419753)$,\n  - $(0.6,\\, -0.2439419753)$,\n  - $(0.4,\\, -0.2479419753)$。\n\n数据集B（在精细 $h$ 和大 $k_{\\max}$ 下的有限尺寸收敛性）：\n- 固定参数：$h = 0.02$ bohr, $\\alpha = 1.0$ bohr$^{-1}$, $k_{\\max} = 8$ bohr$^{-1}$。\n- 数据：$(L, V)$ 分别为\n  - $(40,\\, -0.25091406789)$,\n  - $(50,\\, -0.25106656789)$,\n  - $(60,\\, -0.2511339753)$。\n\n数据集C（在精细 $h$ 和大 $L$ 下的倒易空间截断收敛性）：\n- 固定参数：$h = 0.02$ bohr, $L = 80$ bohr, $\\alpha = 1.0$ bohr$^{-1}$。\n- 数据：$(k_{\\max}, V)$ 分别为\n  - $(4,\\, -0.250821192612226)$,\n  - $(5,\\, -0.251148896307275)$,\n  - $(6,\\, -0.251185037193918)$。\n\n根据这些数据，确定完全外推的无限分辨率、无限晶胞、无限截断势 $V_{\\infty}(\\mathbf{r}_0)$（以原子单位表示）。请用原子单位（哈特里/基本电荷）表达你的最终结果，并四舍五入至七位有效数字。", "solution": "该问题经核实具有科学依据、提法恰当且客观。这是计算科学中的一个标准练习，要求对误差模型进行论证并进行数值外推。我将开始解答。\n\n问题分为两部分。第一部分是证明渐近误差形式，第二部分是进行数值外推以确定完全收敛的势 $V_{\\infty}(\\mathbf{r}_0)$。\n\n### 第一部分：误差缩放形式的证明\n\n1.  **离散化误差**：泊松方程为 $\\nabla^2 V = -4\\pi\\rho$。在间距为 $h$ 的均匀网格上，一维二阶导数的二阶中心差分算子为 $\\frac{\\partial^2 V}{\\partial x^2} \\approx \\frac{V(x+h) - 2V(x) + V(x-h)}{h^2}$。$V(x\\pm h)$ 在 $x$ 点的泰勒级数展开为：\n    $$V(x\\pm h) = V(x) \\pm h \\frac{dV}{dx} + \\frac{h^2}{2} \\frac{d^2V}{dx^2} \\pm \\frac{h^3}{6} \\frac{d^3V}{dx^3} + \\frac{h^4}{24} \\frac{d^4V}{dx^4} + O(h^5)$$\n    将此代入有限差分公式：\n    $$\\frac{V(x+h) - 2V(x) + V(x-h)}{h^2} = \\frac{d^2V}{dx^2} + \\frac{h^2}{12} \\frac{d^4V}{dx^4} + O(h^4)$$\n    由这些一维算子组合成的三维拉普拉斯算子 $\\nabla_h^2$ 因此会有一个与 $h^2$ 成正比的领导阶截断误差：\n    $$\\nabla_h^2 V(\\mathbf{r}) - \\nabla^2 V(\\mathbf{r}) = E(\\mathbf{r}) = O(h^2)$$\n    所求解的有限差分方程是 $\\nabla_h^2 V_h = -4\\pi\\rho$，其中 $V_h$ 是数值解。精确解 $V$ 满足 $\\nabla_h^2 V = -4\\pi\\rho + E$。两者相减，误差 $\\delta V = V_h - V$ 满足 $\\nabla_h^2 (\\delta V) = -E = O(h^2)$。对于像拉普拉斯算子这样的稳定线性算子，解的误差 $\\delta V$ 与源项 $E$ 的误差成正比。因此，对于足够光滑的 $V(\\mathbf{r})$，在任意点 $\\mathbf{r}_0$ 的势的误差 $\\delta V(\\mathbf{r}_0)$ 与 $h^2$ 成比例。因此，计算出的势 $V(h)$ 具有 $V(h) = V_{\\infty} + C_h h^2 + O(h^4)$ 的形式。\n\n2.  **有限尺寸误差**：在周期性计算中，中心晶胞中一点 $\\mathbf{r}$ 的势是中心晶胞（位于 $\\mathbf{R}=\\mathbf{0}$）中的电荷分布 $\\rho(\\mathbf{r}')$ 以及其所有周期性镜像（位于晶格矢量 $\\mathbf{R} \\neq \\mathbf{0}$ 处）的贡献之和。误差即为来自镜像的贡献。\n    $$\\Delta V_L(\\mathbf{r}) = \\sum_{\\mathbf{R} \\neq \\mathbf{0}} \\int_{\\text{cell}} \\frac{\\rho(\\mathbf{r}')}{|\\mathbf{r} - (\\mathbf{r}' + \\mathbf{R})|} d^3\\mathbf{r}'$$\n    对于大的 $|\\mathbf{R}|$，我们可以对每个镜像晶胞的势进行多极展开。由于分子是中性的，晶胞的总电荷（单极矩）为零。领导项是偶极矩 $\\mathbf{p} = \\int \\mathbf{r}' \\rho(\\mathbf{r}') d^3\\mathbf{r}'$。在远距离 $\\mathbf{d}$ 处，来自偶极子 $\\mathbf{p}$ 的势在原子单位制下为 $V_{\\text{dipole}}(\\mathbf{d}) = \\frac{\\mathbf{p} \\cdot \\mathbf{d}}{|\\mathbf{d}|^3}$。误差是所有镜像偶极子势的和：\n    $$\\Delta V_L(\\mathbf{r}) \\approx \\sum_{\\mathbf{R} \\neq \\mathbf{0}} \\frac{\\mathbf{p} \\cdot (\\mathbf{r} - \\mathbf{R})}{|\\mathbf{r} - \\mathbf{R}|^3}$$\n    这个晶格和的条件收敛是一个已知问题。对于在“锡箔”边界条件（埃瓦尔德求和的标准）下边长为 $L$ 的立方晶格，该和可以计算为一个简单的形式。埃瓦尔德求和的长程部分会产生一个修正项，在 $L$ 很大的极限下，给出的势误差为 $\\Delta V_L(\\mathbf{r}) = -\\frac{4\\pi}{3L^3} \\mathbf{p} \\cdot \\mathbf{r}$。这个结果表明，对于具有非零偶极矩的中性系统，在固定点 $\\mathbf{r}_0$ 的势的领导阶有限尺寸误差与 $L^{-3}$ 成比例。总势为 $V(L) = V_{\\infty} + C_L L^{-3} + O(L^{-5})$，其中 $C_L = -\\frac{4\\pi}{3} \\mathbf{p} \\cdot \\mathbf{r}_0$。\n\n3.  **倒易空间截断误差**：埃瓦尔德方法将电荷密度 $\\rho$ 分为在实空间中处理的短程部分和在倒易空间中处理的长程部分。长程部分由宽的高斯补偿电荷组成。高斯函数的傅里叶变换仍然是高斯函数。具体来说，在倒易格矢 $\\mathbf{k}$ 处的电荷密度的傅里叶分量的行为如同 $\\tilde{\\rho}(\\mathbf{k}) \\propto \\exp(-|\\mathbf{k}|^2 / (4\\alpha^2))$。倒易空间中的泊松方程是 $-|\\mathbf{k}|^2 \\tilde{V}(\\mathbf{k}) = -4\\pi \\tilde{\\rho}(\\mathbf{k})$，所以 $\\tilde{V}(\\mathbf{k}) = 4\\pi \\tilde{\\rho}(\\mathbf{k}) / |\\mathbf{k}|^2$。因此，势的分量与以下形式成比例：\n    $$\\tilde{V}(\\mathbf{k}) \\propto \\frac{1}{|\\mathbf{k}|^2} \\exp(-|\\mathbf{k}|^2 / (4\\alpha^2))$$\n    在 $k_{\\max}$ 处截断倒易空间求和所产生的误差是所有被忽略的项（$|\\mathbf{k}| > k_{\\max}$）的总和。该误差的大小主要由截断点之外、指数函数值最大的项决定。误差积分 $\\int_{k_{\\max}}^{\\infty} k^2 \\tilde{V}(k) dk$ 的渐近行为由衰减最快的项（即高斯指数项）主导。因此，误差与截断点处领导项的值成比例，即 $\\exp(-k_{\\max}^2 / (4\\alpha^2))$。更详细的分析表明，误差与 $k_{\\max}^{-1}\\exp(-k_{\\max}^2 / (4\\alpha^2))$ 成正比，但为了拟合目的，指数项是主导的，这证明了将模型 $V(k_{\\max}) = V_{\\infty} + C_k \\exp(-k_{\\max}^2 / (4\\alpha^2))$ 作为领导阶近似是合理的。\n\n### 第二部分：数值外推\n\n我们假设总误差是各项领导阶误差的加和：\n$$V(h, L, k_{\\max}) \\approx V_{\\infty} + C_h h^2 + C_L L^{-3} + C_k \\exp(-k_{\\max}^2 / (4\\alpha^2))$$\n\n**数据集A：网格间距外推 ($h \\to 0$)**\n模型为 $V(h) = V_A^{\\text{extr}} + C_h h^2$，其中 $V_A^{\\text{extr}} = V(h=0, L=60, k_{\\max}=8)$。我们对 $V$ 和 $x_h = h^2$ 进行线性回归。\n数据点 $(h^2, V)$ 分别为 $(0.64, -0.2383419753)$、$(0.36, -0.2439419753)$ 和 $(0.16, -0.2479419753)$。\n斜率 $C_h$ 由 $\\frac{\\Delta V}{\\Delta(h^2)}$ 给出。\n$$C_h = \\frac{-0.2439419753 - (-0.2383419753)}{0.36 - 0.64} = \\frac{-0.0056}{-0.28} = 0.02$$\n数据完全符合此模型。截距（外推势）为：\n$$V_A^{\\text{extr}} = V(h=0.4) - C_h(0.4)^2 = -0.2479419753 - 0.02(0.16) = -0.2511419753$$\n这是在固定 $L=60$ bohr 和 $k_{\\max}=8$ bohr$^{-1}$ 下，$h \\to 0$ 时的势。\n\n**数据集B：有限尺寸外推 ($L \\to \\infty$)**\n模型为 $V(L) = V_B^{\\text{extr}} + C_L L^{-3}$，其中 $V_B^{\\text{extr}} = V(h=0.02, L=\\infty, k_{\\max}=8)$。我们对 $V$ 和 $x_L = L^{-3}$ 进行线性回归。\n数据点 $(L^{-3}, V)$ 分别为 $(40^{-3}, -0.25091406789)$、$(50^{-3}, -0.25106656789)$ 和 $(60^{-3}, -0.2511339753)$。\n$$C_L = \\frac{-0.25106656789 - (-0.25091406789)}{50^{-3} - 40^{-3}} = \\frac{-0.0001525}{0.000008 - 0.000015625} = \\frac{-0.0001525}{-0.000007625} = 20$$\n这个模型对给定的数据也是完全准确的。外推势为：\n$$V_B^{\\text{extr}} = V(L=60) - C_L(60)^{-3} = -0.2511339753 - 20/216000 = -0.25122656789$$\n这是在固定 $h=0.02$ bohr 和 $k_{\\max}=8$ bohr$^{-1}$ 下，$L \\to \\infty$ 时的势。\n\n**数据集C：倒易空间外推 ($k_{\\max} \\to \\infty$)**\n当 $\\alpha=1.0$ bohr$^{-1}$ 时，模型为 $V(k_{\\max}) = V_C^{\\text{extr}} + C_k \\exp(-k_{\\max}^2/4)$，其中 $V_C^{\\text{extr}} = V(h=0.02, L=80, k_{\\max}=\\infty)$。我们对 $V$ 和 $x_k = \\exp(-k_{\\max}^2/4)$ 使用线性回归。\n数据点 $(k_{\\max}, V)$ 分别为 $(4, -0.250821192612226)$、$(5, -0.251148896307275)$ 和 $(6, -0.251185037193918)$。\n$$C_k = \\frac{V(5) - V(4)}{\\exp(-5^2/4) - \\exp(-4^2/4)} = \\frac{-0.000327703695049}{\\exp(-6.25) - \\exp(-4)} \\approx \\frac{-0.0003277037}{-0.01638518} = 0.02$$\n模型是完全准确的。外推势为：\n$$V_C^{\\text{extr}} = V(k_{\\max}=6) - C_k \\exp(-6^2/4) = -0.251185037193918 - 0.02 \\exp(-9) \\approx -0.25118750539$$\n这是在固定 $h=0.02$ bohr 和 $L=80$ bohr 下，$k_{\\max} \\to \\infty$ 时的势。\n\n**$V_{\\infty}$ 的最终外推**\n我们已经确定了系数 $C_h=0.02$、$C_L=20$ 和 $C_k=0.02$。我们现在可以对任一数据点进行所有三种误差的校正。最可靠的程序是校正来自最精确计算集（即在小 $h$ 和大 $L$ 下运行的数据集 C）的结果。\n我们使用外推值 $V_C^{\\text{extr}}$ 并校正由 $h$ 和 $L$ 带来的剩余固定误差。\n$$V_{\\infty} = V_C^{\\text{extr}} - C_h (0.02)^2 - C_L (80)^{-3}$$\n$$V_{\\infty} = -0.25118750539 - (0.02)(0.0004) - (20)/(512000)$$\n$$V_{\\infty} = -0.25118750539 - 0.000008 - 0.0000390625 = -0.25123456789$$\n作为一致性检查，我们可以从其他数据集中推导 $V_{\\infty}$。从数据集A和B，我们可以确定 $V(h=0, L=\\infty, k_{\\max}=8) = -0.25123456789$。然后对 $k_{\\max}$ 误差进行校正：\n$$V_{\\infty} = V(h=0, L=\\infty, k_{\\max}=8) - C_k \\exp(-8^2/4)$$\n$$V_{\\infty} = -0.25123456789 - 0.02 \\exp(-16) \\approx -0.25123456789 - 2.25 \\times 10^{-9} = -0.25123457014$$\n结果之间存在约 $2.25 \\times 10^{-9}$ 的微小差异。这表明在简单的加性误差模型下，所提供的数据集存在轻微的不一致性。然而，问题要求将最终答案四舍五入到七位有效数字。\n值 1: $-0.25123456789 \\to -0.2512346$\n值 2: $-0.25123457014 \\to -0.2512346$\n在要求的精度下，两个值四舍五入后得到相同的结果。问题的人为设计数据导致了这种情况。我们报告唯一的四舍五入值。\n完全外推的势确定为 $V_\\infty = -0.2512346$ a.u.。", "answer": "$$ \\boxed{-0.2512346} $$", "id": "2771336"}]}