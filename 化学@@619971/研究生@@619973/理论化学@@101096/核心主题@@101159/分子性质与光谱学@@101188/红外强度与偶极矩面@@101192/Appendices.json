{"hands_on_practices": [{"introduction": "本练习将指导您从第一性原理出发，推导一个简单双原子分子的红外强度。通过应用谐振子模型和线性偶极矩面，您将建立起偶极矩变化率与可观测光谱强度之间的基本联系，这是振动光谱学中的一个基石概念。[@problem_id:2779261]", "problem": "一个线性双原子分子沿其键轴进行小振幅振动。设振动坐标为偏离平衡位置的标量位移，记为 $Q$，约化质量为 $\\mu$。振动哈密顿量取为谐振子形式，其势能为 $V(Q)=\\frac{1}{2} k Q^{2}$，其中 $k$ 为力常数。沿 $Q$ 的偶极矩面（DMS）是线性的，$\\mu(Q)=\\mu_0+a\\,Q$，其中 $\\mu_0$ 是一个常数，$a$ 是偶极矩面的斜率。考虑从 $v=0$到 $v=1$ 的基频振动跃迁。\n\n从谐振子的定义以及振动谱线强度定义为跃迁偶极矩的平方出发，\n$$\nS_{01}=\\left|\\langle 0|\\mu(Q)|1\\rangle\\right|^{2},\n$$\n推导 $S_{01}$ 仅用 $a$、$ \\mu$、$ k$ 和 $\\hbar$ 表示的闭合形式表达式。将分子视为严格线性的，并忽略转动结构以及给定势能之外的任何非谐性。振动频率取由谐振子哈密顿量和约化质量所隐含的值。\n\n将您的最终答案表示为单个解析表达式。以国际单位制（SI）报告 $S_{01}$，其单位为偶极矩的平方 $\\text{(C m)}^{2}$，但不要在最终的方框表达式中包含单位。最后，根据你的表达式，说明当 $a$ 和 $k$ 保持固定时，$S_{01}$ 对约化质量 $\\mu$ 的幂律依赖关系。最终的方框答案必须仅为 $S_{01}$ 的解析表达式。", "solution": "首先对问题陈述进行验证。\n\n逐字提取的已知条件如下：\n-   系统：一个线性双原子分子。\n-   运动：沿其键轴的小振幅振动。\n-   坐标：振动坐标是偏离平衡位置的标量位移 $Q$。\n-   质量：约化质量为 $\\mu$。\n-   哈密顿量：振动哈密顿量为谐振子，其势能为 $V(Q)=\\frac{1}{2} k Q^{2}$。\n-   力常数：$k$。\n-   偶极矩面（DMS）：$\\mu(Q)=\\mu_0+a\\,Q$，其中 $\\mu_0$ 为常数，$a$ 为斜率。\n-   跃迁：从 $v=0$ 到 $v=1$ 的基频振动跃迁。\n-   谱线强度定义：$S_{01}=\\left|\\langle 0|\\mu(Q)|1\\rangle\\right|^{2}$。\n-   目标：推导 $S_{01}$ 关于 $a$、$ \\mu$、$ k$ 和 $\\hbar$ 的闭合形式表达式。\n-   约束：视为严格线性，忽略转动结构和非谐性。振动频率由谐振子哈密顿量隐含。\n\n验证结论：\n该问题具有科学依据，提法明确，且客观。这是量子力学和分子光谱学中的一个标准问题，基于谐振子和线性偶极矩近似。所有必要信息均已提供，问题内部一致且可形式化。未发现任何缺陷。该问题有效。\n\n我们现在开始推导谱线强度 $S_{01}$。\n\n从基态 $|0\\rangle$到第一激发态 $|1\\rangle$的基频振动跃迁的谱线强度定义为跃迁偶极矩的模的平方：\n$$\nS_{01} = \\left|\\langle 0|\\mu(Q)|1\\rangle\\right|^{2}\n$$\n偶极矩算符 $\\mu(Q)$ 是振动坐标 $Q$ 的线性函数：\n$$\n\\mu(Q) = \\mu_0 + a\\,Q\n$$\n将此表达式代入矩阵元中，得到：\n$$\n\\langle 0|\\mu(Q)|1\\rangle = \\langle 0|\\mu_0 + a\\,Q|1\\rangle = \\mu_0\\langle 0|1\\rangle + a\\langle 0|Q|1\\rangle\n$$\n振动能态 $|v\\rangle$ 是谐振子哈密顿量的本征态。这些态是正交的，意味着它们的内积为 $\\langle v|v'\\rangle = \\delta_{vv'}$，其中 $\\delta_{vv'}$ 是克罗内克（Kronecker）符号。对于从 $v=0$ 到 $v=1$ 的跃迁，正交性条件意味着 $\\langle 0|1\\rangle = 0$。因此，第一项消失：\n$$\n\\mu_0\\langle 0|1\\rangle = 0\n$$\n这是众所周知的选择定则，即对于谐振子，永久偶极矩 $\\mu_0$ 对振动跃迁没有贡献；只有偶极矩随位移的变化（由斜率 $a$ 表示）才能引起跃迁。\n\n谱线强度的表达式简化为：\n$$\nS_{01} = |a\\langle 0|Q|1\\rangle|^{2} = a^{2}|\\langle 0|Q|1\\rangle|^{2}\n$$\n为了计算矩阵元 $\\langle 0|Q|1\\rangle$，我们将位置算符 $Q$ 用量子谐振子的升降算符，即湮灭算符 ($a$) 和产生算符 ($a^{\\dagger}$) 表示。其关系为：\n$$\nQ = \\sqrt{\\frac{\\hbar}{2\\mu\\omega}} (a + a^{\\dagger})\n$$\n其中 $\\omega$ 是振子的角频率。问题指明该频率由谐振子哈密顿量确定，因此 $\\omega = \\sqrt{k/\\mu}$。升降算符对数态 $|v\\rangle$ 的作用如下：\n$$\na|v\\rangle = \\sqrt{v}|v-1\\rangle \\quad (\\text{for } v > 0); \\quad a|0\\rangle = 0\n$$\n$$\na^{\\dagger}|v\\rangle = \\sqrt{v+1}|v+1\\rangle\n$$\n现在我们计算矩阵元 $\\langle 0|Q|1\\rangle$：\n$$\n\\langle 0|Q|1\\rangle = \\left\\langle 0\\left| \\sqrt{\\frac{\\hbar}{2\\mu\\omega}} (a + a^{\\dagger}) \\right|1\\right\\rangle = \\sqrt{\\frac{\\hbar}{2\\mu\\omega}} (\\langle 0|a|1\\rangle + \\langle 0|a^{\\dagger}|1\\rangle)\n$$\n我们分别计算括号中的两项。\n对于第一项，利用湮灭算符对 $|1\\rangle$ 的作用：\n$$\n\\langle 0|a|1\\rangle = \\langle 0|(\\sqrt{1}|0\\rangle) = \\langle 0|0\\rangle = 1\n$$\n对于第二项，利用产生算符对 $|1\\rangle$ 的作用：\n$$\n\\langle 0|a^{\\dagger}|1\\rangle = \\langle 0|(\\sqrt{1+1}|1+1\\rangle) = \\sqrt{2}\\langle 0|2\\rangle = 0\n$$\n此结果是由于态 $|0\\rangle$ 和 $|2\\rangle$ 的正交性。\n综合这些结果， $Q$ 的矩阵元为：\n$$\n\\langle 0|Q|1\\rangle = \\sqrt{\\frac{\\hbar}{2\\mu\\omega}} (1 + 0) = \\sqrt{\\frac{\\hbar}{2\\mu\\omega}}\n$$\n这证明了在谐振子近似和线性偶极矩面下，振动跃迁的选择定则为 $\\Delta v = \\pm 1$。\n\n将此结果代回 $S_{01}$ 的表达式中：\n$$\nS_{01} = a^{2} \\left|\\sqrt{\\frac{\\hbar}{2\\mu\\omega}}\\right|^{2} = a^{2} \\frac{\\hbar}{2\\mu\\omega}\n$$\n问题要求最终表达式用 $a$、$ \\mu$、$ k$ 和 $\\hbar$ 表示。我们用角频率 $\\omega$ 的定义（用力常数 $k$ 和约化质量 $\\mu$ 表示）来替换它：\n$$\n\\omega = \\sqrt{\\frac{k}{\\mu}}\n$$\n将此代入 $S_{01}$ 的表达式中：\n$$\nS_{01} = a^{2} \\frac{\\hbar}{2\\mu\\sqrt{k/\\mu}} = a^{2} \\frac{\\hbar}{2\\sqrt{\\mu^{2}}\\sqrt{k/\\mu}} = a^{2} \\frac{\\hbar}{2\\sqrt{\\mu^{2}(k/\\mu)}} = a^{2} \\frac{\\hbar}{2\\sqrt{\\mu k}}\n$$\n这就是基频振动跃迁谱线强度的最终闭合形式表达式。\n\n最后，题目要求我们说明在假定 $a$ 和 $k$ 为常数时，$S_{01}$ 对约化质量 $\\mu$ 的幂律依赖关系。从推导出的表达式可知：\n$$\nS_{01} = \\frac{a^{2}\\hbar}{2} (\\mu k)^{-1/2}\n$$\n$S_{01}$ 明显与 $\\mu^{-1/2}$ 成正比。因此，基频跃迁的谱线强度随着振子约化质量的增加而减小，其幂律依赖关系为 $-\\frac{1}{2}$。", "answer": "$$\n\\boxed{\\frac{a^{2} \\hbar}{2 \\sqrt{\\mu k}}}\n$$", "id": "2779261"}, {"introduction": "基于双谐波近似的原理，本练习将探讨同位素取代如何影响振动强度。您将预测用氘取代氢时强度的变化，这是一种用于指认振动模式的常用光谱技术。通过此实践，您能体会到简单的理论模型如何对分子行为做出强有力的定量预测。[@problem_id:2779249]", "problem": "考虑一个异核双原子分子 $X\\!H$，其核间距坐标为 $R$。假定如下：\n- 分子可以很好地用 Born–Oppenheimer 近似描述，沿 $R$ 的振动可以在平衡键长 $R_{e}$ 附近用谐振子近似处理，因此 $V(R)$ 在 $R_{e}$ 处被二次展开式所替代。\n- 偶极矩面 (DMS) $\\mu(R)$ 是光滑的，可以在 $R_{e}$ 附近进行泰勒展开，并且只保留 $(R - R_{e})$ 的线性项（双谐波近似）。\n- 同位素取代 $H \\to D$ 只改变核质量，不改变偶极矩面 $\\mu(R)$ 和 Born–Oppenheimer 势 $V(R)$。\n- 初始振动布居完全处于基态 $v=0$，忽略转动，谱线强度定义为零温下 $v=0 \\to v=1$ 基频跃迁的频率积分吸收谱线强度。\n\n令 $m_{X}$、$m_{H}$ 和 $m_{D}$ 分别表示 $X$、$H$ 和 $D$ 的核质量。仅使用上述物理假定和电偶极近似下光与物质相互作用的基本原理，确定当用 $D$ 取代 $H$ 时，基频 $v=0 \\to v=1$ 带的积分吸收强度变化的精确乘法因子，即计算比值的闭合形式表达式：\n$$\n\\frac{I_{D}}{I_{H}},\n$$\n其中 $I_{H}$ 和 $I_{D}$ 分别是 $X\\!H$ 和 $X\\!D$ 的积分谱线强度。最终答案需仅用 $m_{X}$、$m_{H}$ 和 $m_{D}$ 表示成单个解析表达式。不需要进行数值计算或四舍五入，最终答案中不应包含单位。", "solution": "该问题是有效的，因为它具有科学依据、是良定的且客观的。它代表了基于已确立物理近似的理论振动光谱学中的一个标准练习。我们将继续推导解答。\n\n从具有波函数 $\\psi_{v}$ 的初态到具有波函数 $\\psi_{v'}$ 的末态的振动跃迁，其积分吸收强度 $I$ 正比于跃迁频率 $\\nu_{v'v}$ 和跃迁偶极矩大小的平方。对于从基态 $v=0$ 到第一激发态 $v=1$ 的基频跃迁，在零温下只有基态被布居，强度 $I$ 由下式给出：\n$$\nI \\propto \\nu_{10} |\\langle\\psi_{1}|\\hat{\\mu}|\\psi_{0}\\rangle|^2\n$$\n此处，$\\nu_{10}$ 是 $v=0 \\to v=1$ 跃迁的频率，$\\psi_{0}$ 和 $\\psi_{1}$ 分别是 $v=0$ 和 $v=1$ 态的振动波函数，$\\hat{\\mu}$ 是电偶极矩算符，它是核间距坐标 $R$ 的函数。\n\n问题指定使用双谐波近似。首先，偶极矩面 $\\mu(R)$ 在平衡键长 $R_{e}$ 附近用其线性泰勒展开式来近似。令 $x = R - R_{e}$ 为振动位移坐标。则偶极矩算符为：\n$$\n\\hat{\\mu}(x) \\approx \\mu(R_{e}) + \\left(\\frac{d\\mu}{dR}\\right)_{R=R_{e}} x = \\mu_{e} + \\mu' x\n$$\n其中 $\\mu_{e}$ 是平衡位置的永久偶极矩，$\\mu'$ 是偶极矩的一阶导数，在此近似下它是一个常数。\n\n将 $\\hat{\\mu}(x)$ 的这个线性形式代入跃迁偶极矩积分中，得到：\n$$\n\\langle\\psi_{1}|\\hat{\\mu}|\\psi_{0}\\rangle = \\langle\\psi_{1}|\\mu_{e} + \\mu' x|\\psi_{0}\\rangle = \\mu_{e}\\langle\\psi_{1}|\\psi_{0}\\rangle + \\mu'\\langle\\psi_{1}|x|\\psi_{0}\\rangle\n$$\n其次，对势能 $V(R)$ 的谐振子近似意味着振动波函数 $\\psi_{v}$ 是量子谐振子 (QHO) 的本征函数。这些波函数是正交的，这意味着 $\\langle\\psi_{1}|\\psi_{0}\\rangle = 0$。因此，跃迁偶极矩积分简化为：\n$$\n\\langle\\psi_{1}|\\hat{\\mu}|\\psi_{0}\\rangle = \\mu'\\langle\\psi_{1}|x|\\psi_{0}\\rangle\n$$\n这表明只有当 $\\mu' \\neq 0$ 时，跃迁才是允许的，这是谐振子近似下著名的红外吸收选择定则。\n\n对于量子谐振子 (QHO)，矩阵元 $\\langle\\psi_{1}|x|\\psi_{0}\\rangle$ 是一个标准结果。对于一个折合质量为 $\\mu_{red}$、角频率为 $\\omega = \\sqrt{k/\\mu_{red}}$（其中 $k$ 是力常数）的量子谐振子，该矩阵元为：\n$$\n\\langle\\psi_{1}|x|\\psi_{0}\\rangle = \\sqrt{\\frac{\\hbar}{2\\mu_{red}\\omega}}\n$$\n跃迁的频率为 $\\nu_{10} = (E_{1}-E_{0})/h = \\hbar\\omega/h = \\omega/(2\\pi)$，这意味着 $\\nu_{10}$ 与 $\\omega$ 成正比。将这些结果代回强度 $I$ 的表达式中：\n$$\nI \\propto \\omega \\left| \\mu' \\langle\\psi_{1}|x|\\psi_{0}\\rangle \\right|^2 = \\omega (\\mu')^2 \\left( \\sqrt{\\frac{\\hbar}{2\\mu_{red}\\omega}} \\right)^2\n$$\n$$\nI \\propto \\omega (\\mu')^2 \\left( \\frac{\\hbar}{2\\mu_{red}\\omega} \\right)\n$$\n角频率 $\\omega$ 从分子和分母中消去，得到一个简单的正比关系：\n$$\nI \\propto \\frac{(\\mu')^2}{\\mu_{red}}\n$$\n此结果表明，在双谐波近似下，基频振动带的积分强度与分子的折合质量成反比，与平衡构型处偶极矩导数的平方成正比。\n\n现在，我们将这一发现应用于分子 $X\\!H$ 中氢 ($H$) 被氘 ($D$) 同位素取代形成 $X\\!D$ 的情况。根据问题中陈述的 Born–Oppenheimer 近似，势能面 $V(R)$ 和偶极矩面 $\\mu(R)$ 均与核质量无关。因此：\n1. 偶极矩导数 $\\mu' = (d\\mu/dR)_{R_{e}}$ 对 $X\\!H$ 和 $X\\!D$ 都是相同的。\n2. 在我们的强度表达式中，唯一因同位素取代而改变的参数是折合质量 $\\mu_{red}$。\n\n令 $I_{H}$ 和 $I_{D}$ 分别为 $X\\!H$ 和 $X\\!D$ 的强度。令 $\\mu_{red,H}$ 和 $\\mu_{red,D}$ 为它们相应的折合质量。我们可以写出：\n$$\nI_H = C \\frac{(\\mu')^2}{\\mu_{red,H}} \\quad \\text{与} \\quad I_D = C \\frac{(\\mu')^2}{\\mu_{red,D}}\n$$\n其中 $C$ 是一个比例常数，对两种物种都相同。\n\n因此，强度的比值为：\n$$\n\\frac{I_{D}}{I_{H}} = \\frac{C (\\mu')^2 / \\mu_{red,D}}{C (\\mu')^2 / \\mu_{red,H}} = \\frac{\\mu_{red,H}}{\\mu_{red,D}}\n$$\n这两个双原子分子的折合质量由下式给出：\n$$\n\\mu_{red,H} = \\frac{m_{X} m_{H}}{m_{X} + m_{H}}\n$$\n$$\n\\mu_{red,D} = \\frac{m_{X} m_{D}}{m_{X} + m_{D}}\n$$\n其中 $m_{X}$、$m_{H}$ 和 $m_{D}$ 是核质量。\n\n将这些表达式代入比值中，得到：\n$$\n\\frac{I_{D}}{I_{H}} = \\frac{\\frac{m_{X} m_{H}}{m_{X} + m_{H}}}{\\frac{m_{X} m_{D}}{m_{X} + m_{D}}} = \\left(\\frac{m_{X} m_{H}}{m_{X} + m_{H}}\\right) \\left(\\frac{m_{X} + m_{D}}{m_{X} m_{D}}\\right)\n$$\n通过消去公因子 $m_{X}$ 来简化表达式，得到比值的最终闭合形式表达式：\n$$\n\\frac{I_{D}}{I_{H}} = \\frac{m_{H} (m_{X} + m_{D})}{m_{D} (m_{X} + m_{H})}\n$$\n这就是最终答案，按要求仅用给定的质量表示。", "answer": "$$\n\\boxed{\\frac{m_{H} (m_{X} + m_{D})}{m_{D} (m_{X} + m_{H})}}\n$$", "id": "2779249"}, {"introduction": "尽管理想解析模型能提供关键的洞察，但现代理论光谱学依赖于高精度的量子化学计算。本练习模拟了一项真实的计算任务：将计算得到的偶极矩导数外推至完备基组 (CBS) 极限。您将通过一个数据拟合过程，来理解化学家们如何获得预测和解释红外光谱所需的高精度参数。[@problem_id:2779214]", "problem": "在 Born–Oppenheimer (BO) 近似和谐振子振动模型下，考虑一个小型闭壳层分子。沿单一简正坐标 $Q$ 的某一基频振动跃迁的红外 (IR) 强度，与分子偶极矩矢量 $\\boldsymbol{\\mu}$ 在平衡位置上对 $Q$ 的一阶导数的平方成正比。用符号表示，如果 $g \\equiv \\left\\lVert \\partial \\boldsymbol{\\mu} / \\partial Q \\right\\rVert$ 是偶极矩导数的模，则谐振子红外强度与 $g^2$ 成正比。在本问题中，我们全部采用原子单位 (a.u.) 进行计算，并将 $g$ 称作从偶极矩势能面中提取的、我们所关注的性质。我们将计算一个相对红外强度 $I_{\\text{rel}}$，其定义为 $I_{\\text{rel}} = g_{\\infty}^2$，其中 $g_{\\infty}$ 是 $g$ 的完全基组 (CBS) 极限。\n\n在相关一致极化价 $X$-zeta (cc-pVXZ) 基组中，其中基数 $X \\in \\{2,3,4,5,\\dots\\}$，一个经过充分检验且广泛应用的事实是：许多基态性质的基组不完备性误差会以 $X$ 的负幂次渐近收敛，通常以 $X^{-3}$ 项为主，并通过引入 $X^{-5}$ 项得到改善。受此启发，我们采用如下拟设\n$$\ng(X) = g_{\\infty} + \\sum_{j=1}^{M} c_j X^{-\\alpha_j},\n$$\n其中 $g_{\\infty}$ 是以 a.u. 为单位的 CBS 极限，指数 $\\alpha_j$ 是从一个候选集合中选择的正整数，而 $c_j$ 是通过拟合确定的系数。在本练习中，候选指数集为 $\\{3,5\\}$。给定 $N$ 个数据点 $\\{(X_i, g_i, \\sigma_i)\\}_{i=1}^N$，其中 $g_i$ 是 $g(X_i)$ 的值（以 a.u. 为单位），$\\sigma_i$ 是单标准差不确定度（以 a.u. 为单位），任务是执行加权线性拟合来估计 $g_{\\infty}$。适用以下建模规则：\n- 从 $\\{3,5\\}$ 中选择能根据可用数据生成可辨识线性模型的最大指数子集。具体地，当 $N=1$ 时，使用 $\\{\\}$；当 $N=2$ 时，使用 $\\{3\\}$；当 $N \\ge 3$ 时，使用 $\\{3,5\\}$。也就是说，要确保 $1 + M \\le N$，其中未知数是 $g_{\\infty}$ 和 $M$ 个系数 $c_j$。\n- 使用加权最小二乘法，权重为 $w_i = 1/\\sigma_i^2$。如果某些 $\\sigma_i$ 未指定，则对这些条目取 $\\sigma_i = 1$（因此 $w_i = 1$）。\n\n您的程序必须实现此过程，并将其应用于以下测试套件。所有的 $g$ 值和 $\\sigma$ 值都以原子单位 (a.u.) 给出，所有的基数 $X$ 都是整数。对于每种情况，输入是三元组 $(X_i, g_i, \\sigma_i)$ 的列表。\n\n- 测试用例 A（一般情况，三个点，使用 $\\{3,5\\}$）：\n  - $(X, g, \\sigma)$ 等于 $(2, 0.625000000, 0.001000000)$，\n    $(3, 0.541152263, 0.001000000)$，\n    $(4, 0.517968750, 0.001000000)$。\n- 测试用例 B（边界情况，两个点，使用 $\\{3\\}$）：\n  - $(X, g, \\sigma)$ 等于 $(3, 0.716666667, 0.002000000)$，\n    $(5, 0.742800000, 0.002000000)$。\n- 测试用例 C（加权情况，四个点，其中一个离群点被降权，使用 $\\{3,5\\}$）：\n  - $(X, g, \\sigma)$ 等于 $(2, 0.191875000, 0.010000000)$，\n    $(3, 0.119753086, 0.001000000)$，\n    $(4, 0.108105469, 0.001000000)$，\n    $(5, 0.104096000, 0.001000000)$。\n\n您的程序必须执行以下任务：\n- 对于每个测试用例，构建与所选 $\\{\\alpha_j\\}$ 一致的设计矩阵，其列为 $[1, X^{-\\alpha_1}, \\dots, X^{-\\alpha_M}]$，并求解加权最小二乘法正规方程组，以获得 $g_{\\infty}$ 和系数 $\\{c_j\\}$ 的估计值。\n- 计算每个测试用例的 $g_{\\infty}$（以 a.u. 为单位）和相对红外强度 $I_{\\text{rel}} = g_{\\infty}^2$（以 $(\\text{a.u.})^2$ 为单位）。\n\n数值和输出要求：\n- 报告以原子单位 (a.u.) 表示的 $g_{\\infty}$ 和以 $(\\text{a.u.})^2$ 表示的 $I_{\\text{rel}}$。\n- 将每个报告的数值输出四舍五入到 $6$ 位小数。\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。该列表必须按以下顺序包含 $6$ 个浮点数：$[g_{\\infty}^{(A)}, g_{\\infty}^{(B)}, g_{\\infty}^{(C)}, I_{\\text{rel}}^{(A)}, I_{\\text{rel}}^{(B)}, I_{\\text{rel}}^{(C)}]$，其中上标 A、B 和 C 标记了不同的测试用例。\n\n该问题是关于负幂回归量的加权线性回归和模型选择任务，具有普遍适用性。它纯粹是计算性的，除了标准浮点运算和线性代数之外，不要求任何特定的编程语言语义。如上所述，所有物理量都以明确指定的单位表示，不涉及角度或百分比。", "solution": "所呈现的问题是加权线性最小二乘回归的一个直接应用，这是数据分析中的一项基本技术。任务是通过将一个具有物理动机的模型拟合到一组计算出的数据点 $\\{(X_i, g_i, \\sigma_i)\\}_{i=1}^N$ 来估计分子性质 $g(X)$ 的完全基组 (CBS) 极限 $g_{\\infty}$。性质 $g$ 是电偶极矩对简正坐标的导数的模，而 $X$ 是 cc-pVXZ 基组的基数。相对红外强度定义为 $I_{\\text{rel}} = g_{\\infty}^2$。\n\n该回归模型对其参数 $(g_{\\infty}, c_1, \\dots, c_M)$ 是线性的，由以下拟设给出：\n$$ g(X) = g_{\\infty} + \\sum_{j=1}^{M} c_j X^{-\\alpha_j} $$\n对于一组 $N$ 个数据点，这可以表示为矩阵形式 $\\mathbf{A}\\mathbf{p} \\approx \\mathbf{g}$，其中 $\\mathbf{p} = [g_{\\infty}, c_1, \\dots, c_M]^T$ 是参数矢量，$\\mathbf{g} = [g_1, \\dots, g_N]^T$ 是观测值矢量，$\\mathbf{A}$ 是 $N \\times (M+1)$ 的设计矩阵，其元素为 $A_{i,0} = 1$ 且当 $j > 0$ 时 $A_{i,j} = X_i^{-\\alpha_j}$。\n\n参数通过最小化加权残差平方和 $\\chi^2$ 来确定：\n$$ \\chi^2 = \\sum_{i=1}^N w_i (g_i - g(X_i))^2 = (\\mathbf{g} - \\mathbf{A}\\mathbf{p})^T \\mathbf{W} (\\mathbf{g} - \\mathbf{A}\\mathbf{p}) $$\n其中 $\\mathbf{W}$ 是一个由权重 $w_i = 1/\\sigma_i^2$ 构成的对角矩阵。最小化 $\\chi^2$ 的解可以通过求解正规方程组得到：\n$$ (\\mathbf{A}^T \\mathbf{W} \\mathbf{A}) \\mathbf{p} = \\mathbf{A}^T \\mathbf{W} \\mathbf{g} $$\n因此，解矢量为 $\\mathbf{p} = (\\mathbf{A}^T \\mathbf{W} \\mathbf{A})^{-1} \\mathbf{A}^T \\mathbf{W} \\mathbf{g}$。在计算上，使用基于 QR 分解或奇异值分解的方法来求解该系统更为稳定，例如，通过求解变换后系统 $(\\mathbf{W}^{1/2}\\mathbf{A})\\mathbf{p} = (\\mathbf{W}^{1/2}\\mathbf{g})$ 的非加权最小二乘问题。\n\n问题指定了一个模型选择规则：从候选集 $\\{3, 5\\}$ 中选择指数集 $\\{\\alpha_j\\}$，使得参数数量 $M+1$ 不超过数据点数量 $N$。当 $N=1$ 时，我们使用 $M=0$（无指数）。当 $N=2$ 时，我们使用 $M=1$ 且 $\\{\\alpha_1\\} = \\{3\\}$。当 $N \\ge 3$ 时，我们使用 $M=2$ 且 $\\{\\alpha_1, \\alpha_2\\} = \\{3, 5\\}$。现在我们将此过程应用于每个测试用例。\n\n测试用例 A:\n我们有 $N=3$ 个数据点：$(2, 0.625, 0.001)$、$(3, 0.541152263, 0.001)$ 和 $(4, 0.51796875, 0.001)$。根据 $N=3$ 的规则，我们使用指数集 $\\{3, 5\\}$。模型为 $g(X) = g_{\\infty} + c_1 X^{-3} + c_2 X^{-5}$。有 3 个参数和 3 个数据点，因此该系统是恰好确定的。由于不确定度 $\\sigma_i$ 均相等，所以权重 $w_i$ 是均匀的，问题简化为非加权最小二乘法，即求解 $\\mathbf{A}\\mathbf{p} = \\mathbf{g}$。\n线性方程组为：\n$$ \\begin{pmatrix} 1 & 2^{-3} & 2^{-5} \\\\ 1 & 3^{-3} & 3^{-5} \\\\ 1 & 4^{-3} & 4^{-5} \\end{pmatrix} \\begin{pmatrix} g_{\\infty} \\\\ c_1 \\\\ c_2 \\end{pmatrix} = \\begin{pmatrix} 0.625 \\\\ 0.541152263 \\\\ 0.517968750 \\end{pmatrix} $$\n求解该方程组得到参数矢量 $\\mathbf{p} = [0.5, 1.2, -0.8]^T$。\n因此，$g_{\\infty}^{(A)} = 0.5$ a.u.。\n相对强度为 $I_{\\text{rel}}^{(A)} = (g_{\\infty}^{(A)})^2 = (0.5)^2 = 0.25$ $(\\text{a.u.})^2$。\n\n测试用例 B:\n我们有 $N=2$ 个数据点：$(3, 0.716666667, 0.002)$ 和 $(5, 0.7428, 0.002)$。对于 $N=2$，我们使用指数集 $\\{3\\}$。模型为 $g(X) = g_{\\infty} + c_1 X^{-3}$。由于有 2 个参数和 2 个数据点，系统再次成为恰好确定的系统。由于不确定度相等，这是一个非加权问题。\n线性方程组为：\n$$ \\begin{pmatrix} 1 & 3^{-3} \\\\ 1 & 5^{-3} \\end{pmatrix} \\begin{pmatrix} g_{\\infty} \\\\ c_1 \\end{pmatrix} = \\begin{pmatrix} 0.716666667 \\\\ 0.742800000 \\end{pmatrix} $$\n求解该方程组得到参数矢量 $\\mathbf{p} = [0.75, -0.9]^T$。\n因此，$g_{\\infty}^{(B)} = 0.75$ a.u.。\n相对强度为 $I_{\\text{rel}}^{(B)} = (g_{\\infty}^{(B)})^2 = (0.75)^2 = 0.5625$ $(\\text{a.u.})^2$。\n\n测试用例 C:\n我们有 $N=4$ 个数据点：$(2, 0.191875, 0.01)$、$(3, 0.119753086, 0.001)$、$(4, 0.108105469, 0.001)$ 和 $(5, 0.104096, 0.001)$。对于 $N=4$，我们使用指数集 $\\{3, 5\\}$。模型为 $g(X) = g_{\\infty} + c_1 X^{-3} + c_2 X^{-5}$。有 3 个参数和 4 个数据点，因此该系统是超定的，必须使用最小二乘法求解。由于不确定度不均匀，需要进行加权拟合。第一个数据点的不确定度要大得多（$\\sigma_1=0.01$），因此相对于其他三个点（$\\sigma_{2,3,4}=0.001$），其权重被显著降低。\n我们求解加权正规方程组 $(\\mathbf{A}^T \\mathbf{W} \\mathbf{A}) \\mathbf{p} = \\mathbf{A}^T \\mathbf{W} \\mathbf{g}$，其中 $\\mathbf{A}$ 是 $4 \\times 3$ 的设计矩阵，$\\mathbf{W} = \\text{diag}(1/0.01^2, 1/0.001^2, 1/0.001^2, 1/0.001^2)$。\n这个加权最小二乘问题的解是 $\\mathbf{p} \\approx [0.1, 0.5, 0.3]^T$。\n因此，$g_{\\infty}^{(C)} \\approx 0.10000001$ a.u.。\n相对强度为 $I_{\\text{rel}}^{(C)} = (g_{\\infty}^{(C)})^2 \\approx (0.10000001)^2 \\approx 0.010000002$ $(\\text{a.u.})^2$。\n\n最终结果按要求四舍五入到 6 位小数，如下所示：\n$g_{\\infty}^{(A)} = 0.500000$ a.u.\n$g_{\\infty}^{(B)} = 0.750000$ a.u.\n$g_{\\infty}^{(C)} = 0.100000$ a.u.\n$I_{\\text{rel}}^{(A)} = 0.250000$ $(\\text{a.u.})^2$\n$I_{\\text{rel}}^{(B)} = 0.562500$ $(\\text{a.u.})^2$\n$I_{\\text{rel}}^{(C)} = 0.010000$ $(\\text{a.u.})^2$", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the CBS limit of g and the relative IR intensity for a set\n    of test cases using weighted linear least squares.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    # Each case is a list of tuples (X, g, sigma).\n    test_cases = {\n        'A': [\n            (2, 0.625000000, 0.001000000),\n            (3, 0.541152263, 0.001000000),\n            (4, 0.517968750, 0.001000000)\n        ],\n        'B': [\n            (3, 0.716666667, 0.002000000),\n            (5, 0.742800000, 0.002000000)\n        ],\n        'C': [\n            (2, 0.191875000, 0.010000000),\n            (3, 0.119753086, 0.001000000),\n            (4, 0.108105469, 0.001000000),\n            (5, 0.104096000, 0.001000000)\n        ]\n    }\n    \n    results_g_inf = {}\n    results_I_rel = {}\n\n    for case_label, data in test_cases.items():\n        # Unpack data into numpy arrays\n        X, g, sigma = np.array(data).T\n        \n        N = len(data)\n        \n        # Determine the set of exponents based on the number of data points\n        if N == 1:\n            exponents = []\n        elif N == 2:\n            exponents = [3]\n        else: # N >= 3\n            exponents = [3, 5]\n            \n        # Construct the design matrix A\n        num_params = 1 + len(exponents)\n        A = np.zeros((N, num_params))\n        A[:, 0] = 1.0 # Column for g_infinity\n        for i, exp in enumerate(exponents):\n            A[:, i+1] = X**(-exp)\n            \n        # Perform weighted linear least squares.\n        # This is equivalent to unweighted least squares on a transformed system\n        # A' * p = g', where A' = A / sigma and g' = g / sigma.\n        # We need to reshape sigma to use broadcasting for element-wise division.\n        sigma_col = sigma[:, np.newaxis]\n        \n        A_w = A / sigma_col\n        g_w = g / sigma\n        \n        # Solve the linear least squares problem\n        # The first element of the solution vector 'params' is g_infinity\n        params, _, _, _ = np.linalg.lstsq(A_w, g_w, rcond=None)\n        \n        g_inf = params[0]\n        I_rel = g_inf**2\n        \n        results_g_inf[case_label] = g_inf\n        results_I_rel[case_label] = I_rel\n\n    # Prepare the final output string as per requirements\n    final_list = [\n        results_g_inf['A'],\n        results_g_inf['B'],\n        results_g_inf['C'],\n        results_I_rel['A'],\n        results_I_rel['B'],\n        results_I_rel['C']\n    ]\n\n    # Format each number to 6 decimal places and join into a comma-separated string\n    formatted_results = [f\"{val:.6f}\" for val in final_list]\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2779214"}]}