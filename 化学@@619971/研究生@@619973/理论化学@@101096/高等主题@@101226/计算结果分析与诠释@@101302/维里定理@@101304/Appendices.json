{"hands_on_practices": [{"introduction": "我们将从最典型的量子力学体系——氢原子——开始。这个练习将回归第一性原理，作为对维里定理的一个基础性验证。通过使用精确的基态波函数，你将直接计算动能（$\\langle \\hat{T} \\rangle$）和势能（$\\langle \\hat{V} \\rangle$）的期望值，从而亲手验证 $2\\langle \\hat{T} \\rangle = -\\langle \\hat{V} \\rangle$ 这一预期关系，将抽象的定理植根于具体的计算之中。[@problem_id:2824523]", "problem": "考虑一个质量为 $m_{\\mathrm{e}}$ 的非相对论性电子，在电荷为 $+e$ 的点核（氢原子，$Z=1$）的库仑场中运动。其在位置表象中的哈密顿量为\n$$\n\\hat{H} \\;=\\; \\hat{T} + \\hat{V} \\;=\\; -\\frac{\\hbar^2}{2 m_{\\mathrm{e}}}\\nabla^2 \\;-\\; \\frac{e^2}{4\\pi \\varepsilon_0}\\,\\frac{1}{r}\\,,\n$$\n其中 $r = |\\mathbf{r}|$。其精确的归一化基态波函数为\n$$\n\\psi_{100}(\\mathbf{r}) \\;=\\; \\frac{1}{\\sqrt{\\pi a_0^3}}\\,\\exp\\!\\left(-\\frac{r}{a_0}\\right),\n$$\n其中玻尔半径 $a_0$ 由下式给出\n$$\na_0 \\;=\\; \\frac{4\\pi \\varepsilon_0 \\hbar^2}{m_{\\mathrm{e}} e^2}\\,.\n$$\n仅使用基本定义（算符和期望值）和标准积分，从 $\\psi_{100}(\\mathbf{r})$ 出发，显式地计算基态期望值 $\\langle \\hat{T} \\rangle$ 和 $\\langle \\hat{V} \\rangle$。然后，在不援引任何预先陈述的维里关系的情况下，检验您的结果是否与正比于 $1/r$ 的中心势的维里定理相符。\n\n请用哈特里（原子单位能量）表示您的最终值，其中哈特里定义为\n$$\nE_{\\mathrm{h}} \\;=\\; \\frac{e^2}{4\\pi \\varepsilon_0 a_0}\\,.\n$$\n\n答案格式与单位：\n- 以有序对 $\\big(\\langle \\hat{T} \\rangle,\\;\\langle \\hat{V} \\rangle\\big)$ 的形式给出最终答案，单位为哈特里。\n- 给出精确值；无需四舍五入。", "solution": "本题要求从第一性原理出发，计算氢原子基态的动能和势能的期望值，然后评估其与维里定理的一致性。\n\n从期望值的定义开始：\n$$\n\\langle \\hat{T} \\rangle \\;=\\; \\int \\psi^{*}(\\mathbf{r})\\left(-\\frac{\\hbar^2}{2 m_{\\mathrm{e}}}\\nabla^2\\right)\\psi(\\mathbf{r})\\,d^3 r,\\qquad\n\\langle \\hat{V} \\rangle \\;=\\; \\int \\psi^{*}(\\mathbf{r})\\left(-\\frac{e^2}{4\\pi \\varepsilon_0}\\frac{1}{r}\\right)\\psi(\\mathbf{r})\\,d^3 r.\n$$\n对于一个在无穷远处足够快地趋于零的平方可积波函数，通过分部积分可以得到动能的等价正定形式：\n$$\n\\langle \\hat{T} \\rangle \\;=\\; \\frac{\\hbar^2}{2 m_{\\mathrm{e}}}\\int |\\nabla \\psi(\\mathbf{r})|^2\\,d^3 r,\n$$\n因为对于指数形式的基态，当 $r\\to \\infty$ 时，表面项为零。\n\n我们已知氢原子基态波函数为\n$$\n\\psi_{100}(\\mathbf{r}) \\;=\\; \\frac{1}{\\sqrt{\\pi a_0^3}}\\,\\exp\\!\\left(-\\frac{r}{a_0}\\right),\n$$\n该函数仅依赖于 $r$，因此 $\\nabla \\psi(\\mathbf{r}) = \\hat{\\mathbf{r}}\\;\\frac{d\\psi}{dr}$，从而有 $|\\nabla \\psi|^2 = \\left(\\frac{d\\psi}{dr}\\right)^2$。计算其导数：\n$$\n\\frac{d\\psi}{dr} \\;=\\; -\\frac{1}{a_0}\\,\\frac{1}{\\sqrt{\\pi a_0^3}}\\,\\exp\\!\\left(-\\frac{r}{a_0}\\right) \\;=\\; -\\frac{1}{a_0}\\,\\psi(r).\n$$\n因此\n$$\n|\\nabla \\psi|^2 \\;=\\; \\left(\\frac{1}{a_0}\\right)^2 \\left|\\psi(r)\\right|^2 \\;=\\; \\frac{1}{a_0^2}\\,\\frac{1}{\\pi a_0^3}\\,\\exp\\!\\left(-\\frac{2r}{a_0}\\right).\n$$\n在球坐标系下对全空间积分：\n$$\n\\int |\\nabla \\psi|^2\\,d^3 r \\;=\\; 4\\pi\\int_{0}^{\\infty} \\frac{1}{a_0^2}\\,\\frac{1}{\\pi a_0^3}\\,\\exp\\!\\left(-\\frac{2r}{a_0}\\right) r^2\\,dr \\;=\\; \\frac{4}{a_0^5}\\int_{0}^{\\infty} r^2 \\exp\\!\\left(-\\frac{2r}{a_0}\\right) dr.\n$$\n使用标准积分公式 $\\int_{0}^{\\infty} r^2 \\exp(-\\beta r)\\,dr = \\frac{2}{\\beta^3}$（其中 $\\beta0$），这里 $\\beta = \\frac{2}{a_0}$。则\n$$\n\\int_{0}^{\\infty} r^2 \\exp\\!\\left(-\\frac{2r}{a_0}\\right)dr \\;=\\; \\frac{2}{\\left(\\frac{2}{a_0}\\right)^3} \\;=\\; \\frac{a_0^3}{4}.\n$$\n因此，\n$$\n\\int |\\nabla \\psi|^2\\,d^3 r \\;=\\; \\frac{4}{a_0^5}\\cdot \\frac{a_0^3}{4} \\;=\\; \\frac{1}{a_0^2}.\n$$\n代入动能期望值的表达式中：\n$$\n\\langle \\hat{T} \\rangle \\;=\\; \\frac{\\hbar^2}{2 m_{\\mathrm{e}}}\\,\\frac{1}{a_0^2}.\n$$\n现在用哈特里能量表示。回顾 $a_0 = \\frac{4\\pi \\varepsilon_0 \\hbar^2}{m_{\\mathrm{e}} e^2}$，因此\n$$\n\\frac{1}{a_0^2} \\;=\\; \\frac{m_{\\mathrm{e}}^2 e^4}{16 \\pi^2 \\varepsilon_0^2 \\hbar^4}.\n$$\n于是\n$$\n\\langle \\hat{T} \\rangle \\;=\\; \\frac{\\hbar^2}{2 m_{\\mathrm{e}}}\\cdot \\frac{m_{\\mathrm{e}}^2 e^4}{16 \\pi^2 \\varepsilon_0^2 \\hbar^4}\n\\;=\\; \\frac{m_{\\mathrm{e}} e^4}{32 \\pi^2 \\varepsilon_0^2 \\hbar^2}.\n$$\n哈特里能量为\n$$\nE_{\\mathrm{h}} \\;=\\; \\frac{e^2}{4\\pi \\varepsilon_0 a_0} \\;=\\; \\frac{m_{\\mathrm{e}} e^4}{16 \\pi^2 \\varepsilon_0^2 \\hbar^2}.\n$$\n比较可得\n$$\n\\langle \\hat{T} \\rangle \\;=\\; \\frac{1}{2}\\,E_{\\mathrm{h}}.\n$$\n\n接下来计算势能期望值：\n$$\n\\langle \\hat{V} \\rangle \\;=\\; -\\frac{e^2}{4\\pi \\varepsilon_0} \\int \\frac{|\\psi(\\mathbf{r})|^2}{r}\\,d^3 r\n\\;=\\; -\\frac{e^2}{4\\pi \\varepsilon_0}\\,4\\pi \\int_{0}^{\\infty} \\frac{1}{\\pi a_0^3}\\,\\exp\\!\\left(-\\frac{2r}{a_0}\\right)\\,r\\,dr.\n$$\n使用 $\\int_{0}^{\\infty} r \\exp(-\\beta r)\\,dr = \\frac{1}{\\beta^2}$（其中 $\\beta = \\frac{2}{a_0}$）计算径向积分：\n$$\n\\int_{0}^{\\infty} \\exp\\!\\left(-\\frac{2r}{a_0}\\right)\\,r\\,dr \\;=\\; \\frac{1}{\\left(\\frac{2}{a_0}\\right)^2} \\;=\\; \\frac{a_0^2}{4}.\n$$\n于是\n$$\n\\int \\frac{|\\psi|^2}{r}\\,d^3 r \\;=\\; 4\\pi \\cdot \\frac{1}{\\pi a_0^3}\\cdot \\frac{a_0^2}{4} \\;=\\; \\frac{1}{a_0}.\n$$\n因此，\n$$\n\\langle \\hat{V} \\rangle \\;=\\; -\\frac{e^2}{4\\pi \\varepsilon_0}\\cdot \\frac{1}{a_0} \\;=\\; - E_{\\mathrm{h}}.\n$$\n\n以哈特里为单位汇总结果：\n$$\n\\langle \\hat{T} \\rangle \\;=\\; \\frac{1}{2}\\,E_{\\mathrm{h}},\\qquad \\langle \\hat{V} \\rangle \\;=\\; -1\\,E_{\\mathrm{h}}.\n$$\n作为一致性检验，总能量为\n$$\n\\langle \\hat{H} \\rangle \\;=\\; \\langle \\hat{T} \\rangle + \\langle \\hat{V} \\rangle \\;=\\; \\left(\\frac{1}{2}-1\\right)E_{\\mathrm{h}} \\;=\\; -\\frac{1}{2}\\,E_{\\mathrm{h}},\n$$\n这正是氢原子的精确基态能量。\n\n最后，验证与维里定理的一致性。对于形式为 $V(r) \\propto r^{n}$ 的中心势，维里定理预言 $2\\langle \\hat{T} \\rangle = \\langle \\mathbf{r}\\cdot \\nabla V \\rangle = n \\langle \\hat{V} \\rangle$。对于库仑势 $V(r) = -\\frac{e^2}{4\\pi \\varepsilon_0}\\frac{1}{r}$，有 $n=-1$，更直接地，有 $r\\,\\frac{dV}{dr} = -V(r)$。因此维里关系变为 $2\\langle \\hat{T} \\rangle = -\\langle \\hat{V} \\rangle$。使用我们计算出的值，\n$$\n2\\langle \\hat{T} \\rangle + \\langle \\hat{V} \\rangle \\;=\\; 2\\left(\\frac{1}{2}E_{\\mathrm{h}}\\right) + \\left(-E_{\\mathrm{h}}\\right) \\;=\\; 0,\n$$\n这明确地表明了与维里定理的一致性。\n\n因此，以哈特里（原子单位能量）表示，有序对 $\\big(\\langle \\hat{T} \\rangle,\\;\\langle \\hat{V} \\rangle\\big)$ 为 $\\left(\\frac{1}{2},\\,-1\\right)$。", "answer": "$$\\boxed{\\begin{pmatrix}\\frac{1}{2}  -1\\end{pmatrix}}$$", "id": "2824523"}, {"introduction": "在验证了精确解的情况下维里定理的成立之后，我们现在将在近似波函数的背景下探讨其作用，而近似波函数正是计算化学的基石。本练习对氢原子使用一个带有可变指数的斯莱特型轨道 (Slater-type orbital)，采用变分法处理，揭示了维里定理与变分原理之间的深刻联系。你将发现维里比率如何作为一个衡量波函数质量的有力指标，因为精确的维里关系仅在变分参数使总能量最小化时才得以满足。[@problem_id:2824526]", "problem": "考虑在Born–Oppenheimer近似下的非相对论氢原子（核电荷为 $Z = 1$）。全部计算在原子单位（a.u.）下进行，因此电子哈密顿量为 $H = -\\frac{1}{2}\\nabla^{2} - \\frac{1}{r}$，能量以哈特里（Hartree）为单位度量。使用形式为 $\\psi_{\\zeta}(\\mathbf{r}) = N(\\zeta)\\exp\\!\\left(-\\zeta r\\right)$ 的归一化单参数斯莱特型轨道（STO），其中 $\\zeta  0$ 是轨道指数，而 $N(\\zeta)$ 是归一化常数。\n\n仅从量子力学中期望值的定义和标准多变量微积分出发，完成以下任务：\n- 求归一化常数 $N(\\zeta)$。\n- 计算动能期望值 $T(\\zeta) = \\langle \\psi_{\\zeta} | -\\frac{1}{2}\\nabla^{2} | \\psi_{\\zeta} \\rangle$。\n- 计算势能期望值 $V(\\zeta) = \\langle \\psi_{\\zeta} | -\\frac{1}{r} | \\psi_{\\zeta} \\rangle$。\n- 构建维里比 $R(\\zeta) = \\frac{2\\,T(\\zeta)}{-V(\\zeta)}$ 作为 $\\zeta$ 的函数。\n- 求使总能量 $E(\\zeta) = T(\\zeta) + V(\\zeta)$ 最小化的轨道指数 $\\zeta^{\\ast}$。\n\n所有能量均以哈特里（Hartree）表示。将您关于 $T(\\zeta)$、$V(\\zeta)$、$R(\\zeta)$ 和 $\\zeta^{\\ast}$ 的最终结果报告为闭合形式的解析表达式。不要进行任何数值舍入。最终答案必须使用 LaTeX 的 $\\texttt{pmatrix}$ 环境以单行的形式给出，顺序为 $\\bigl(T(\\zeta),\\,V(\\zeta),\\,R(\\zeta),\\,\\zeta^{\\ast}\\bigr)$，矩阵内不含单位。", "solution": "所述问题在科学上是合理的、自洽的且提法恰当。它代表了量子化学中应用变分原理近似求解氢原子基态的一个标准范例。我们将从基本定义出发，系统地进行推导。所有计算均在原子单位下进行。\n\n首先，我们求取试探波函数 $\\psi_{\\zeta}(\\mathbf{r}) = N(\\zeta)\\exp(-\\zeta r)$ 的归一化常数 $N(\\zeta)$。归一化条件为 $\\langle \\psi_{\\zeta} | \\psi_{\\zeta} \\rangle = 1$，这等价于在全空间上的积分等于1。\n$$ \\langle \\psi_{\\zeta} | \\psi_{\\zeta} \\rangle = \\int |\\psi_{\\zeta}(\\mathbf{r})|^2 d\\mathbf{r} = 1 $$\n鉴于波函数的球对称性，我们使用球坐标系，其体积元为 $d\\mathbf{r} = r^2 \\sin\\theta \\, dr \\, d\\theta \\, d\\phi$。\n$$ \\int_0^\\infty \\int_0^\\pi \\int_0^{2\\pi} |N(\\zeta)\\exp(-\\zeta r)|^2 r^2 \\sin\\theta \\, d\\phi \\, d\\theta \\, dr = 1 $$\n我们可以将积分分离。角度部分的积分为：\n$$ \\int_0^\\pi \\sin\\theta \\, d\\theta \\int_0^{2\\pi} d\\phi = [-\\cos\\theta]_0^\\pi \\cdot [\\phi]_0^{2\\pi} = (1 - (-1)) \\cdot (2\\pi) = 4\\pi $$\n选择 $N(\\zeta)$ 为一个实数且为正的常数，我们得到：\n$$ |N(\\zeta)|^2 \\cdot 4\\pi \\int_0^\\infty r^2 \\exp(-2\\zeta r) \\, dr = 1 $$\n径向积分是与伽马函数相关的标准形式：$\\int_0^\\infty x^n \\exp(-ax) dx = \\frac{n!}{a^{n+1}}$。当 $n=2$ 且 $a=2\\zeta$ 时，我们求得：\n$$ \\int_0^\\infty r^2 \\exp(-2\\zeta r) \\, dr = \\frac{2!}{(2\\zeta)^{3}} = \\frac{2}{8\\zeta^3} = \\frac{1}{4\\zeta^3} $$\n将此结果代回归一化方程：\n$$ N(\\zeta)^2 \\cdot 4\\pi \\cdot \\left(\\frac{1}{4\\zeta^3}\\right) = N(\\zeta)^2 \\frac{\\pi}{\\zeta^3} = 1 $$\n这得出归一化常数为：\n$$ N(\\zeta) = \\sqrt{\\frac{\\zeta^3}{\\pi}} $$\n\n接下来，我们计算动能的期望值 $T(\\zeta)$。动能算符为 $\\hat{T} = -\\frac{1}{2}\\nabla^2$。\n$$ T(\\zeta) = \\left\\langle \\psi_{\\zeta} \\left| -\\frac{1}{2}\\nabla^2 \\right| \\psi_{\\zeta} \\right\\rangle $$\n利用动量算符 $\\mathbf{p} = -i\\nabla$ 的厄米性，我们可以将动能期望值写为：\n$$ T(\\zeta) = \\frac{1}{2} \\langle \\nabla \\psi_{\\zeta} | \\nabla \\psi_{\\zeta} \\rangle = \\frac{1}{2} \\int (\\nabla \\psi_{\\zeta}(\\mathbf{r}))^* \\cdot (\\nabla \\psi_{\\zeta}(\\mathbf{r})) \\, d\\mathbf{r} $$\n对于我们的球对称函数，其梯度为 $\\nabla \\psi_{\\zeta} = \\frac{d\\psi_{\\zeta}}{dr}\\hat{\\mathbf{r}}$，其中 $\\hat{\\mathbf{r}}$ 是径向单位矢量。\n$$ \\frac{d\\psi_{\\zeta}}{dr} = \\frac{d}{dr} \\left( N(\\zeta)\\exp(-\\zeta r) \\right) = -\\zeta N(\\zeta)\\exp(-\\zeta r) = -\\zeta \\psi_{\\zeta} $$\n因此，$\\nabla \\psi_{\\zeta} = -\\zeta \\psi_{\\zeta} \\hat{\\mathbf{r}}$。被积函数变为：\n$$ (\\nabla \\psi_{\\zeta})^* \\cdot (\\nabla \\psi_{\\zeta}) = (-\\zeta \\psi_{\\zeta}^* \\hat{\\mathbf{r}}) \\cdot (-\\zeta \\psi_{\\zeta} \\hat{\\mathbf{r}}) = \\zeta^2 |\\psi_{\\zeta}|^2 (\\hat{\\mathbf{r}} \\cdot \\hat{\\mathbf{r}}) = \\zeta^2 |\\psi_{\\zeta}|^2 $$\n$T(\\zeta)$ 的积分显著简化为：\n$$ T(\\zeta) = \\frac{1}{2} \\int \\zeta^2 |\\psi_{\\zeta}|^2 d\\mathbf{r} = \\frac{\\zeta^2}{2} \\int |\\psi_{\\zeta}|^2 d\\mathbf{r} $$\n由于波函数是归一化的，该积分为1。因此，动能为：\n$$ T(\\zeta) = \\frac{\\zeta^2}{2} $$\n\n现在，我们计算势能的期望值 $V(\\zeta)$。对于 $Z=1$ 的类氢原子，其势能算符为 $\\hat{V} = -\\frac{1}{r}$。\n$$ V(\\zeta) = \\left\\langle \\psi_{\\zeta} \\left| -\\frac{1}{r} \\right| \\psi_{\\zeta} \\right\\rangle = - \\int \\frac{|\\psi_{\\zeta}(\\mathbf{r})|^2}{r} d\\mathbf{r} $$\n代入 $\\psi_{\\zeta}$ 的表达式并在球坐标系下积分：\n$$ V(\\zeta) = -|N(\\zeta)|^2 \\int_0^\\infty \\int_0^\\pi \\int_0^{2\\pi} \\frac{\\exp(-2\\zeta r)}{r} r^2 \\sin\\theta \\, d\\phi \\, d\\theta \\, dr $$\n$$ V(\\zeta) = -N(\\zeta)^2 \\cdot 4\\pi \\int_0^\\infty r \\exp(-2\\zeta r) \\, dr $$\n再次使用标准积分形式，其中 $n=1$ 且 $a=2\\zeta$：\n$$ \\int_0^\\infty r \\exp(-2\\zeta r) \\, dr = \\frac{1!}{(2\\zeta)^2} = \\frac{1}{4\\zeta^2} $$\n代入 $N(\\zeta)^2 = \\frac{\\zeta^3}{\\pi}$：\n$$ V(\\zeta) = -\\left(\\frac{\\zeta^3}{\\pi}\\right) \\cdot 4\\pi \\cdot \\left(\\frac{1}{4\\zeta^2}\\right) = -\\frac{4\\pi\\zeta^3}{4\\pi\\zeta^2} = -\\zeta $$\n所以，势能为：\n$$ V(\\zeta) = -\\zeta $$\n\n总能量作为变分参数 $\\zeta$ 的函数是 $E(\\zeta) = T(\\zeta) + V(\\zeta)$。\n$$ E(\\zeta) = \\frac{\\zeta^2}{2} - \\zeta $$\n根据变分原理，基态能量的最佳估计是 $E(\\zeta)$ 的最小值。我们通过将其对 $\\zeta$ 的导数设为零来求得该值：\n$$ \\frac{dE}{d\\zeta} = \\frac{d}{d\\zeta}\\left(\\frac{\\zeta^2}{2} - \\zeta\\right) = \\zeta - 1 $$\n$$ \\frac{dE}{d\\zeta} = 0 \\implies \\zeta - 1 = 0 \\implies \\zeta = 1 $$\n为了确认这是一个最小值，我们检查二阶导数：$\\frac{d^2E}{d\\zeta^2} = 1  0$。因此，能量在 $\\zeta^{\\ast} = 1$ 时达到最小。事实上，试探波函数 $\\psi_1(\\mathbf{r})$ 就是氢原子的精确基态波函数，其对应的能量是 $E(1) = \\frac{1}{2} - 1 = -0.5$ 哈特里。\n\n最后，我们计算维里比，其定义为 $R(\\zeta) = \\frac{2\\,T(\\zeta)}{-V(\\zeta)}$。\n使用我们得到的 $T(\\zeta)$ 和 $V(\\zeta)$ 表达式：\n$$ R(\\zeta) = \\frac{2\\left(\\frac{\\zeta^2}{2}\\right)}{-(-\\zeta)} = \\frac{\\zeta^2}{\\zeta} = \\zeta $$\n对于具有库仑势的体系，维里定理指出，对于精确的本征态，必须满足 $2\\langle T \\rangle = -\\langle V \\rangle$，这意味着比率 $R$ 必须恰好为1。我们的结果表明，只有当 $\\zeta=1$ 时才满足这个条件，而这正是使能量最小化并对应于精确波函数的 $\\zeta^{\\ast}$ 值。对于任何其他 $\\zeta$ 值，此时波函数是近似的，维里定理不成立。\n\n要求的结果是 $T(\\zeta)$、$V(\\zeta)$、$R(\\zeta)$ 的闭合形式表达式以及 $\\zeta^{\\ast}$ 的值。\n- $T(\\zeta) = \\frac{\\zeta^2}{2}$\n- $V(\\zeta) = -\\zeta$\n- $R(\\zeta) = \\zeta$\n- $\\zeta^{\\ast} = 1$\n这些结果需以单行矩阵的形式呈现。", "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{\\zeta^2}{2}  -\\zeta  \\zeta  1 \\end{pmatrix}}\n$$", "id": "2824526"}, {"introduction": "我们最后的实践将带你进入实用的分子量子化学领域，聚焦于氢分子 $\\text{H}_2$。这项高级练习要求你使用一个最小基组，执行一次完整的限制性哈特里-福克 (Restricted Hartree-Fock, RHF) 计算，以确定电子能量随键长的函数关系。通过亲手实现这一过程，你将观察到维里比率在一个多电子分子体系中的行为，并亲身体会到基组不完备性等因素如何导致计算结果偏离理想值——这在真实的科学计算中是一项至关重要的诊断技能。[@problem_id:2465666]", "problem": "在 Born-Oppenheimer 近似下考虑氢分子 $\\mathrm{H}_2$，其中两个原子核是沿 $z$ 轴相距为 $R$、电荷数 $Z=1$ 的固定点电荷。完全采用原子单位制，此时电子哈密顿量为\n$$\n\\hat{H}_\\mathrm{e} = \\hat{T}_\\mathrm{e} + \\hat{V}_\\mathrm{e}, \\quad \\hat{T}_\\mathrm{e} = -\\tfrac{1}{2}\\sum_i \\nabla_i^2, \\quad \\hat{V}_\\mathrm{e} = \\sum_i \\left( -\\frac{Z}{|\\mathbf{r}_i - \\mathbf{R}_A|} - \\frac{Z}{|\\mathbf{r}_i - \\mathbf{R}_B|} \\right) + \\sum_{ij}\\frac{1}{|\\mathbf{r}_i - \\mathbf{r}_j|}.\n$$\n将此电子问题的维里比定义为\n$$\n\\eta(R) \\equiv -\\frac{\\langle \\hat{V}_\\mathrm{e} \\rangle}{2\\langle \\hat{T}_\\mathrm{e} \\rangle},\n$$\n其中 $\\langle \\cdot \\rangle$ 表示在由最小基组构造的变分最优单行列式（限制性闭壳层）电子波函数中的量子力学期望值。\n\n使用由 Slater 型轨道三高斯（STO-3G）收缩 $s$ 型函数组成的最小高斯基组，每个原子核上放置一个收缩函数。每个收缩的 $1s$ 型基函数是三个归一化的源 $s$ 型高斯函数的线性组合，\n$$\n\\phi(\\mathbf{r};\\mathbf{R}) = \\sum_{k=1}^{3} d_k \\, N(\\alpha_k)\\, \\exp\\!\\left(-\\alpha_k \\, |\\mathbf{r}-\\mathbf{R}|^2\\right),\n$$\n其收缩系数 $d_k$ 和源指数 $\\alpha_k$（针对氢原子）由下式给出：\n$$\n\\{d_k\\}_{k=1}^3 = \\{\\,0.1543289673,\\;0.5353281423,\\;0.4446345422\\,\\}, \\\\\n\\{\\alpha_k\\}_{k=1}^3 = \\{\\,3.425250914,\\;0.6239137298,\\;0.1688554040\\,\\},\n$$\n以及 $s$ 型源函数的归一化常数\n$$\nN(\\alpha) = \\left(\\frac{2\\alpha}{\\pi}\\right)^{3/4}.\n$$\n设原子核坐标为 $\\mathbf{R}_A=(0,0,-R/2)$ 和 $\\mathbf{R}_B=(0,0, R/2)$。计算 $\\langle \\hat{V}_\\mathrm{e} \\rangle$ 时不包括核-核排斥能。\n\n任务：对于每个指定的键长 $R$，确定在该基组下的变分最优单行列式波函数，计算该状态的 $\\langle \\hat{T}_\\mathrm{e} \\rangle$ 和 $\\langle \\hat{V}_\\mathrm{e} \\rangle$，并报告维里比 $\\eta(R)$。\n\n物理单位：$R$ 以玻尔（原子单位）表示。维里比是无量纲的。报告每个 $\\eta(R)$ 值，四舍五入到六位小数。\n\n测试用例（键长单位为玻尔）：\n- $R_1 = 0.7$\n- $R_2 = 1.4$\n- $R_3 = 3.0$\n- $R_4 = 8.0$\n\n最终输出格式：您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如，$[\\eta(R_1),\\eta(R_2),\\eta(R_3),\\eta(R_4)]$），每个条目四舍五入到六位小数，并按 $R_1, R_2, R_3, R_4$ 的顺序列出。", "solution": "所提出的问题是计算量子化学中的一个标准练习：在最小基组下对氢分子 $\\mathrm{H}_2$ 进行限制性 Hartree-Fock (RHF) 计算，并计算几个不同核间距下的电子维里比。问题陈述科学合理、定义明确，并为获得唯一解提供了所有必要的数据和定义。我们将着手求解。\n\n**1. 理论框架：Roothaan-Hall 方程组**\n\n在 Born-Oppenheimer 近似中，电子波函数由电子哈密顿量 $\\hat{H}_\\mathrm{e}$ 决定。Hartree-Fock 方法将多电子波函数近似为单个 Slater 行列式。对于像基态 $\\mathrm{H}_2$ 这样的闭壳层体系，两个电子占据自旋相反的同一空间分子轨道 (MO) $\\psi_1$。\n\n分子轨道 (MO) 通过构成基组的原子轨道线性组合 (LCAO) 来构建。在此问题中，我们使用由两个分别以原子核 A 和 B 为中心的 STO-3G 收缩函数 $\\phi_A$ 和 $\\phi_B$ 组成的最小基组。\n$$\n\\psi_i(\\mathbf{r}) = \\sum_{\\mu=1}^{2} C_{\\mu i} \\phi_\\mu(\\mathbf{r}), \\quad \\text{其中 } \\mu \\in \\{A, B\\}\n$$\n基函数 $\\phi_\\mu$ 本身是三个归一化的源高斯函数 (PGF) 的线性组合：\n$$\n\\phi_\\mu(\\mathbf{r}) = \\sum_{k=1}^{3} d_k N(\\alpha_k) \\exp\\left(-\\alpha_k |\\mathbf{r}-\\mathbf{R}_\\mu|^2\\right)\n$$\n其中 $\\{d_k\\}$ 和 $\\{\\alpha_k\\}$ 是给定的收缩系数和指数，而 $N(\\alpha) = (2\\alpha/\\pi)^{3/4}$ 是源 $s$ 型高斯函数的归一化常数。\n\nLCAO 系数 $C_{\\mu i}$ 通过求解 Roothaan-Hall 方程组得到，该方程组是 Hartree-Fock 本征值问题的矩阵表示：\n$$\n\\mathbf{F} \\mathbf{C} = \\mathbf{S} \\mathbf{C} \\boldsymbol{\\epsilon}\n$$\n此处，$\\mathbf{S}$ 是非正交基函数的重叠矩阵，$\\mathbf{F}$ 是 Fock 矩阵，$\\mathbf{C}$ 是 MO 系数 $C_{\\mu i}$ 矩阵，$\\boldsymbol{\\epsilon}$ 是轨道能 $\\epsilon_i$ 的对角矩阵。\n\n**2. 矩阵的构建**\n\n矩阵的元素由基函数 $\\phi_\\mu, \\phi_\\nu \\in \\{\\phi_A, \\phi_B\\}$ 索引。\n\n- **重叠矩阵 $\\mathbf{S}$**：$S_{\\mu\\nu} = \\int \\phi_\\mu(\\mathbf{r})^* \\phi_\\nu(\\mathbf{r}) d\\mathbf{r}$。\n- **核心哈密顿矩阵 $\\mathbf{H}^{\\text{core}}$**：该矩阵表示单个电子在原子核场中的能量。它是动能矩阵 $\\mathbf{T}$ 和核-电子吸引矩阵 $\\mathbf{V}_{\\text{ne}}$ 的和。\n  $$\n  H^{\\text{core}}_{\\mu\\nu} = T_{\\mu\\nu} + (V_{\\text{ne}})_{\\mu\\nu}\n  $$\n  $$\n  T_{\\mu\\nu} = \\int \\phi_\\mu(\\mathbf{r})^* \\left(-\\tfrac{1}{2}\\nabla^2\\right) \\phi_\\nu(\\mathbf{r}) d\\mathbf{r}\n  $$\n  $$\n  (V_{\\text{ne}})_{\\mu\\nu} = \\int \\phi_\\mu(\\mathbf{r})^* \\left( -\\frac{Z}{|\\mathbf{r} - \\mathbf{R}_A|} - \\frac{Z}{|\\mathbf{r} - \\mathbf{R}_B|} \\right) \\phi_\\nu(\\mathbf{r}) d\\mathbf{r}\n  $$\n- **Fock 矩阵 $\\mathbf{F}$**：Fock 矩阵包含核心哈密顿量和双电子项 $\\mathbf{G}$，后者表示来自所有其他电子的平均排斥作用（库仑作用和交换作用）。\n  $$\n  F_{\\mu\\nu} = H^{\\text{core}}_{\\mu\\nu} + G_{\\mu\\nu}\n  $$\n  双电子项 $G_{\\mu\\nu}$ 依赖于密度矩阵 $\\mathbf{P}$：\n  $$\n  G_{\\mu\\nu} = \\sum_{\\lambda,\\sigma} P_{\\lambda\\sigma} \\left[ (\\mu\\nu|\\sigma\\lambda) - \\frac{1}{2}(\\mu\\lambda|\\sigma\\nu) \\right]\n  $$\n  电子排斥积分 (ERIs) 定义为：\n  $$\n  (\\mu\\nu|\\lambda\\sigma) = \\iint \\phi_\\mu(\\mathbf{r}_1)^* \\phi_\\nu(\\mathbf{r}_1) \\frac{1}{|\\mathbf{r}_1 - \\mathbf{r}_2|} \\phi_\\lambda(\\mathbf{r}_2)^* \\phi_\\sigma(\\mathbf{r}_2) d\\mathbf{r}_1 d\\mathbf{r}_2\n  $$\n- **密度矩阵 $\\mathbf{P}$**：对于闭壳层体系，密度矩阵的元素由占据轨道的 MO 系数计算得出。对于 $\\mathrm{H}_2$，只有最低能量的 MO $\\psi_1$ 被两个电子占据。\n  $$\n  P_{\\lambda\\sigma} = 2 C_{\\lambda 1} C_{\\sigma 1}^*\n  $$\n\n**3. 高斯源函数的积分计算**\n\n所有涉及收缩基函数 $\\phi_\\mu$ 的积分都是通过展开为对其组成的 PGFs（源高斯函数）的积分求和来计算的。对于具有指数 $\\alpha_a, \\alpha_b$ 和中心 $\\mathbf{R}_a, \\mathbf{R}_b$ 的 $s$ 型 PGF（例如 $\\chi_a$ 和 $\\chi_b$），其积分的解析公式是众所周知的。对于未归一化的源函数 $g(\\mathbf{r}; \\alpha, \\mathbf{R}) = \\exp(-\\alpha|\\mathbf{r}-\\mathbf{R}|^2)$：\n- **重叠积分**：$\\langle g_a|g_b\\rangle = \\left(\\frac{\\pi}{\\alpha_a+\\alpha_b}\\right)^{3/2} \\exp\\left(-\\frac{\\alpha_a\\alpha_b}{\\alpha_a+\\alpha_b}|\\mathbf{R}_a - \\mathbf{R}_b|^2\\right)$\n- **动能积分**：$\\langle g_a|-\\frac{1}{2}\\nabla^2|g_b\\rangle = \\frac{\\alpha_a\\alpha_b}{\\alpha_a+\\alpha_b}\\left(3 - \\frac{2\\alpha_a\\alpha_b}{\\alpha_a+\\alpha_b}|\\mathbf{R}_a-\\mathbf{R}_b|^2\\right)\\langle g_a|g_b\\rangle$\n- **核吸引积分**：对于位于 $\\mathbf{R}_C$ 的原子核：$\\langle g_a|-\\frac{1}{|\\mathbf{r}-\\mathbf{R}_C|}|g_b\\rangle = -\\frac{2\\pi}{\\alpha_a+\\alpha_b}F_0\\left((\\alpha_a+\\alpha_b)|\\mathbf{R}_P-\\mathbf{R}_C|^2\\right)\\exp\\left(-\\frac{\\alpha_a\\alpha_b}{\\alpha_a+\\alpha_b}|\\mathbf{R}_a-\\mathbf{R}_b|^2\\right)$，其中 $\\mathbf{R}_P = (\\alpha_a\\mathbf{R}_a+\\alpha_b\\mathbf{R}_b)/(\\alpha_a+\\alpha_b)$ 且 $F_0(t) = \\int_0^1 \\exp(-tu^2)du$ 是零阶 Boys 函数。\n- **电子排斥积分**：$(g_a g_b | g_c g_d) = \\frac{2\\pi^{5/2}}{p_{ab}p_{cd}\\sqrt{p_{ab}+p_{cd}}} \\exp(-\\frac{\\alpha_a\\alpha_b}{p_{ab}}|\\mathbf{R}_a - \\mathbf{R}_b|^2-\\frac{\\alpha_c\\alpha_d}{p_{cd}}|\\mathbf{R}_c - \\mathbf{R}_d|^2) F_0\\left(\\frac{p_{ab}p_{cd}}{p_{ab}+p_{cd}}|\\mathbf{R}_P - \\mathbf{R}_Q|^2\\right)$，其中 $p_{ab}=\\alpha_a+\\alpha_b$，$p_{cd}=\\alpha_c+\\alpha_d$，并且 $\\mathbf{R}_Q$ 的定义与 $\\mathbf{R}_P$ 类似。\n\n然后，通过将源积分乘以收缩系数和归一化常数的乘积作为权重进行求和，便可得到收缩函数的积分。\n\n**4. 自洽场 (SCF) 过程**\n\n由于 Fock 矩阵 $\\mathbf{F}$ 依赖于密度矩阵 $\\mathbf{P}$，而密度矩阵 $\\mathbf{P}$ 又依赖于作为本征值问题解的 MO 系数 $\\mathbf{C}$，因此 Roothaan-Hall 方程组必须迭代求解。\n\n1.  **初始化**：对于给定的原子核构型 $R$，计算所有单电子和双电子积分（$S_{\\mu\\nu}, T_{\\mu\\nu}, (V_{\\text{ne}})_{\\mu\\nu}, (\\mu\\nu|\\lambda\\sigma)$）。构建 $\\mathbf{H}^{\\text{core}}$。对密度矩阵 $\\mathbf{P}$ 作出初始猜测（例如，一个零矩阵）。\n2.  **迭代**：\n    a. 使用当前的密度矩阵 $\\mathbf{P}$ 构建双电子矩阵 $\\mathbf{G}$。\n    b. 构建 Fock 矩阵 $\\mathbf{F} = \\mathbf{H}^{\\text{core}} + \\mathbf{G}$。\n    c. 求解广义本征值问题 $\\mathbf{F}\\mathbf{C} = \\mathbf{S}\\mathbf{C}\\boldsymbol{\\epsilon}$。这通常通过使用变换矩阵 $\\mathbf{X} = \\mathbf{S}^{-1/2}$ 变换到标准正交基，求解标准本征值问题 $(\\mathbf{X}^\\dagger\\mathbf{F}\\mathbf{X})\\mathbf{C}' = \\mathbf{C}'\\boldsymbol{\\epsilon}$，然后将本征矢量反变换 $\\mathbf{C} = \\mathbf{X}\\mathbf{C}'$ 来实现。\n    d. 使用占据轨道的系数 $\\mathbf{C}$ 构建新的密度矩阵 $\\mathbf{P}_{\\text{new}}$。\n    e. 检查是否收敛，例如，通过比较两次迭代之间密度矩阵或总能量的变化。如果未收敛，则设置 $\\mathbf{P} = \\mathbf{P}_{\\text{new}}$ 并返回步骤 2a。\n3.  **终止**：当连续迭代之间的变化量低于预定义阈值时，循环终止。\n\n**5. 期望值和维里比的计算**\n\n收敛后，使用最终的自洽密度矩阵 $\\mathbf{P}$ 和 Fock 矩阵 $\\mathbf{F}$ 来计算所需的物理量。\n\n- **电子动能**：动能算符的期望值由下式给出：\n  $$\n  \\langle \\hat{T}_\\mathrm{e} \\rangle = \\sum_{\\mu,\\nu} P_{\\nu\\mu} T_{\\mu\\nu} = \\mathrm{Tr}(\\mathbf{PT})\n  $$\n- **电子势能**：总电子能量为 $E_\\mathrm{e} = \\frac{1}{2}\\mathrm{Tr}(\\mathbf{P}(\\mathbf{H}^{\\text{core}} + \\mathbf{F}))$。势能 $\\langle \\hat{V}_\\mathrm{e} \\rangle$ 是总电子能量与动能之差。\n  $$\n  \\langle \\hat{V}_\\mathrm{e} \\rangle = E_\\mathrm{e} - \\langle \\hat{T}_\\mathrm{e} \\rangle\n  $$\n- **维里比**：然后使用这些期望值计算所要求的比率 $\\eta(R)$：\n  $$\n  \\eta(R) = -\\frac{\\langle \\hat{V}_\\mathrm{e} \\rangle}{2\\langle \\hat{T}_\\mathrm{e} \\rangle}\n  $$\n\n对每个指定的核间距 $R_1, R_2, R_3, R_4$ 都执行这整个过程。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.special import erf\nfrom scipy.linalg import eigh\n\ndef solve():\n    \"\"\"\n    Main function to solve the RHF problem for H2 and compute the virial ratio.\n    \"\"\"\n    \n    # Define STO-3G basis set parameters for Hydrogen\n    # Contraction coefficients\n    d_coeffs = np.array([0.1543289673, 0.5353281423, 0.4446345422])\n    # Primitive exponents\n    alphas = np.array([3.425250914, 0.6239137298, 0.1688554040])\n    # Primitive normalization constants\n    norm_coeffs = (2 * alphas / np.pi)**0.75\n    \n    # Nuclear charge for Hydrogen\n    Z = 1.0\n\n    def boys_function_F0(t):\n        \"\"\"\n        Computes the Boys function F_0(t).\n        Handles the t - 0 limit to avoid division by zero.\n        \"\"\"\n        if t  1e-9:\n            return 1.0 - t / 3.0\n        return 0.5 * np.sqrt(np.pi / t) * erf(np.sqrt(t))\n\n    def calculate_integrals(R, RA, RB):\n        \"\"\"\n        Calculates all one- and two-electron integrals for the given geometry.\n        \"\"\"\n        n_basis = 2\n        n_primitives = 3\n        \n        S = np.zeros((n_basis, n_basis))\n        T = np.zeros((n_basis, n_basis))\n        V_ne = np.zeros((n_basis, n_basis))\n        ERI = np.zeros((n_basis, n_basis, n_basis, n_basis))\n\n        basis_centers = [RA, RB]\n\n        # Loop over basis functions\n        for mu in range(n_basis):\n            for nu in range(n_basis):\n                # Temporary sums for contracted integrals\n                s_mu_nu, t_mu_nu, v_mu_nu_A, v_mu_nu_B = 0.0, 0.0, 0.0, 0.0\n\n                # Loop over primitive Gaussians for one-electron integrals\n                for i in range(n_primitives):\n                    for j in range(n_primitives):\n                        alpha_i, alpha_j = alphas[i], alphas[j]\n                        R_i, R_j = basis_centers[mu], basis_centers[nu]\n                        \n                        p = alpha_i + alpha_j\n                        P_center = (alpha_i * R_i + alpha_j * R_j) / p\n                        R_ij_sq = np.sum((R_i - R_j)**2)\n                        \n                        K_ij = np.exp(-alpha_i * alpha_j * R_ij_sq / p)\n                        \n                        # Overlap of unnormalized primitives\n                        s_prim = (np.pi / p)**1.5 * K_ij\n                        # Kinetic energy of unnormalized primitives\n                        t_prim = alpha_i * alpha_j / p * (3.0 - 2.0 * alpha_i * alpha_j * R_ij_sq / p) * s_prim\n                        # Nuclear attraction of unnormalized primitives to nuclei A and B\n                        v_prim_A = -2.0 * np.pi / p * boys_function_F0(p * np.sum((P_center - RA)**2)) * K_ij\n                        v_prim_B = -2.0 * np.pi / p * boys_function_F0(p * np.sum((P_center - RB)**2)) * K_ij\n                        \n                        coeff_part = d_coeffs[i] * norm_coeffs[i] * d_coeffs[j] * norm_coeffs[j]\n                        \n                        s_mu_nu += coeff_part * s_prim\n                        t_mu_nu += coeff_part * t_prim\n                        v_mu_nu_A += coeff_part * v_prim_A\n                        v_mu_nu_B += coeff_part * v_prim_B\n                \n                S[mu, nu] = s_mu_nu\n                T[mu, nu] = t_mu_nu\n                V_ne[mu, nu] = Z * (v_mu_nu_A + v_mu_nu_B)\n\n        # Loop over basis functions for two-electron integrals\n        for mu in range(n_basis):\n            for nu in range(n_basis):\n                for lam in range(n_basis):\n                    for sig in range(n_basis):\n                        eri_val = 0.0\n                        # Loop over primitive Gaussians\n                        for i in range(n_primitives):\n                            for j in range(n_primitives):\n                                for k in range(n_primitives):\n                                    for l in range(n_primitives):\n                                        a_i, a_j, a_k, a_l = alphas[i], alphas[j], alphas[k], alphas[l]\n                                        R_i, R_j, R_k, R_l = basis_centers[mu], basis_centers[nu], basis_centers[lam], basis_centers[sig]\n\n                                        p_ij = a_i + a_j\n                                        p_kl = a_k + a_l\n                                        P_ij = (a_i * R_i + a_j * R_j) / p_ij\n                                        P_kl = (a_k * R_k + a_l * R_l) / p_kl\n                                        \n                                        R_ij_sq = np.sum((R_i - R_j)**2)\n                                        R_kl_sq = np.sum((R_k - R_l)**2)\n                                        \n                                        K_ij = np.exp(-a_i * a_j * R_ij_sq / p_ij)\n                                        K_kl = np.exp(-a_k * a_l * R_kl_sq / p_kl)\n\n                                        T_arg = p_ij * p_kl / (p_ij + p_kl) * np.sum((P_ij - P_kl)**2)\n                                        \n                                        prefactor = 2.0 * np.pi**2.5 / (p_ij * p_kl * np.sqrt(p_ij + p_kl))\n                                        \n                                        eri_prim = prefactor * K_ij * K_kl * boys_function_F0(T_arg)\n\n                                        coeff_part = (d_coeffs[i] * norm_coeffs[i] * d_coeffs[j] * norm_coeffs[j] *\n                                                      d_coeffs[k] * norm_coeffs[k] * d_coeffs[l] * norm_coeffs[l])\n                                        eri_val += coeff_part * eri_prim\n                        ERI[mu, nu, lam, sig] = eri_val\n        return S, T, V_ne, ERI\n\n    def run_scf(R, conv_thresh=1e-10, max_iter=100):\n        \"\"\"\n        Performs the Self-Consistent Field (SCF) calculation.\n        \"\"\"\n        RA = np.array([0.0, 0.0, -R/2.0])\n        RB = np.array([0.0, 0.0, R/2.0])\n        \n        S, T, V_ne, ERI = calculate_integrals(R, RA, RB)\n        \n        H_core = T + V_ne\n        \n        # Diagonalize S to get the transformation matrix X = S^(-1/2)\n        s_eigvals, s_eigvecs = eigh(S)\n        s_eigvals_inv_sqrt = np.diag(1.0/np.sqrt(s_eigvals))\n        X = s_eigvecs @ s_eigvals_inv_sqrt @ s_eigvecs.T\n        \n        P = np.zeros_like(S) # Initial guess for density matrix\n        \n        for i in range(max_iter):\n            P_old = P.copy()\n            \n            # Build G matrix (two-electron contribution)\n            G = np.einsum('ls,mnsl-mn', P, ERI) - 0.5 * np.einsum('ls,mlsn-mn', P, ERI)\n            \n            F = H_core + G # Fock matrix\n            \n            # Solve generalized eigenvalue problem\n            F_prime = X.T @ F @ X\n            eps, C_prime = eigh(F_prime)\n            C = X @ C_prime\n            \n            # Form new density matrix from the lowest occupied MO\n            C0 = C[:, 0]\n            P = 2.0 * np.outer(C0, C0)\n            \n            if np.linalg.norm(P - P_old)  conv_thresh:\n                break\n        \n        # Calculate final energies after convergence\n        # Total electronic energy\n        E_elec = 0.5 * np.sum(P * (H_core + F))\n        \n        # Expectation value of kinetic energy\n        T_exp = np.sum(P * T)\n        \n        # Expectation value of potential energy\n        V_exp = E_elec - T_exp\n        \n        return T_exp, V_exp\n\n    # Test suite from the problem statement\n    test_cases = [0.7, 1.4, 3.0, 8.0]\n    \n    results = []\n    for R in test_cases:\n        T_exp, V_exp = run_scf(R)\n        eta = -V_exp / (2 * T_exp)\n        results.append(f\"{eta:.6f}\")\n\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "2465666"}]}