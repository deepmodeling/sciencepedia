{"hands_on_practices": [{"introduction": "理论学习之后，最重要的就是将其应用于实践。在路径积分分子动力学（PIMD）模拟中，一个首要的实际问题是如何选择合适的珠子（bead）数量 $P$。这个选择并非随心所欲，它直接关系到模拟能否准确地捕捉系统的量子效应。通过下面这个练习，你将学习如何根据系统的最高振动频率和温度来确定 $P$ 的保守下限，这是确保对零点能等静态性质进行收敛计算的关键一步 [@problem_id:2759518]。", "problem": "一个氢键分子体系在温度 $T = 300\\,\\mathrm{K}$ 时，其最高的相关分子内振动模式为波数是 $\\tilde{\\nu}_{\\max} = 3300\\,\\mathrm{cm}^{-1}$ 的 O–H 伸缩振动。您希望在一个从头算分子动力学 (AIMD) 框架内，使用路径积分分子动力学 (PIMD) 在零点能的水平上包含核量子效应。\n\n从角频率为 $\\omega$ 的谐振子的量子正则配分函数的虚时路径积分表示出发，并使用将其离散化为 $P$ 个时间片的 Trotter 分解，推导出一个关于 Trotter 数 $P$ 的保守条件，以确保环状聚合物表示能够分辨出在 $\\tilde{\\nu}_{\\max}$ 处最快振动模式的零点涨落。用 $P$、$\\beta = 1/(k_{B}T)$ 和 $\\omega_{\\max} = 2\\pi c\\,\\tilde{\\nu}_{\\max}$ 表示您的条件，并确定在给定的 $T$ 和 $\\tilde{\\nu}_{\\max}$ 下满足该条件的最小整数 $P$。使用恒等式 $\\hbar \\omega = h \\nu = h c \\tilde{\\nu}$ 和转换常数 $k_{B}/(h c) = 0.69503476\\,\\mathrm{cm}^{-1}\\,\\mathrm{K}^{-1}$。\n\n在您的推导中，还需提出一个与您的珠子数量一致的从头算分子动力学设置，在 Born–Oppenheimer 分子动力学 (BOMD) 和 Car–Parrinello 分子动力学 (CPMD) 之间做出选择，并根据扩展的 PIMD 动力学中必须分辨的最大频率来估计一个稳定的时间步长。简要说明您为采样量子正则系综所采用的控温策略的理由。最终答案只报告所需的珠子数量 $P$。最终答案不包含单位。最终答案不需要四舍五入到指定数量的有效数字；报告满足您推导出的标准的最小整数 $P$。", "solution": "对问题陈述进行验证。\n\n逐字提取已知条件：\n- 温度：$T = 300\\,\\mathrm{K}$\n- 最高相关分子内振动模式波数：$\\tilde{\\nu}_{\\max} = 3300\\,\\mathrm{cm}^{-1}$\n- 关注的方法：从头算分子动力学 (AIMD) 框架内的路径积分分子动力学 (PIMD)。\n- 核心任务：推导关于 Trotter 数 $P$ 的保守条件。\n- 条件中涉及的变量：$P$、$\\beta = 1/(k_{B}T)$ 和 $\\omega_{\\max} = 2\\pi c\\,\\tilde{\\nu}_{\\max}$。\n- 出发点：谐振子量子正则配分函数的虚时路径积分表示与 Trotter 离散化。\n- 恒等式：$\\hbar \\omega = h \\nu = h c \\tilde{\\nu}$。\n- 常数：$k_{B}/(h c) = 0.69503476\\,\\mathrm{cm}^{-1}\\,\\mathrm{K}^{-1}$。\n- 最终数值结果：在给定的 $T$ 和 $\\tilde{\\nu}_{\\max}$ 下，满足推导条件的最小整数 $P$。\n- 附加任务：提出一个一致的 AIMD 设置 (BOMD vs. CPMD)，估计一个稳定的时间步长，并论证控温策略。\n\n验证结论：\n该问题有效。它在科学上基于量子统计力学和计算化学的既定理论，特别是路径积分分子动力学方法。其前提在事实上是正确的；O–H 伸缩振动的值是标准值，室温是常见的模拟条件。问题陈述清晰，为推导条件和计算所要求的值提供了足够的信息。语言客观而精确。该问题与*从头算分子动力学*主题直接相关。未发现任何缺陷。我们可以继续进行解答。\n\n对于一个哈密顿算符为 $\\hat{H} = \\hat{T} + \\hat{V}$、逆温度为 $\\beta = 1/(k_{B}T)$ 的体系，其量子正则配分函数 $Z$ 为 $Z = \\text{Tr}[\\exp(-\\beta \\hat{H})]$。路径积分表述依赖于玻尔兹曼算符的 Trotter 分解：\n$$\n\\exp(-\\beta \\hat{H}) = \\left[ \\exp\\left(-\\frac{\\beta}{P} \\hat{H}\\right) \\right]^P \\approx \\left[ \\exp\\left(-\\frac{\\beta \\hat{V}}{2P}\\right) \\exp\\left(-\\frac{\\beta \\hat{T}}{P}\\right) \\exp\\left(-\\frac{\\beta \\hat{V}}{2P}\\right) \\right]^P\n$$\n这种分解会引入一个误差，该误差仅在指数的自变量 $(\\beta/P)\\hat{H}$ 在某种意义上“很小”时才可以忽略。体系的能量尺度由其最高频率模式 $\\omega_{\\max}$ 决定。特征能量为 $\\hbar \\omega_{\\max}$。因此，为了使 Trotter 近似有效，无量纲量 $(\\beta/P) \\hbar \\omega_{\\max}$ 必须远小于1。这导出了保守条件：\n$$\n\\frac{\\beta \\hbar \\omega_{\\max}}{P} \\le 1 \\implies P \\ge \\beta \\hbar \\omega_{\\max}\n$$\n这个条件确保了虚时间步长 $\\Delta\\tau = \\hbar\\beta/P$ 小于最快量子振荡的特征时间尺度 $1/\\omega_{\\max}$。满足这一标准对于离散化的环状聚合物表示能否准确捕捉量子力学离域至关重要，而这种离域主要由最高频率模式的零点运动所主导。\n\n现在我们必须计算在给定的系统参数下满足此条件的最小整数 $P$。所需的量是 $\\beta \\hbar \\omega_{\\max}$。我们可以用提供的常数来表示它：\n$$\n\\beta \\hbar \\omega_{\\max} = \\frac{1}{k_B T} \\cdot \\hbar \\cdot (2\\pi c \\tilde{\\nu}_{\\max}) = \\frac{1}{k_B T} \\cdot \\frac{h}{2\\pi} \\cdot (2\\pi c \\tilde{\\nu}_{\\max}) = \\frac{h c \\tilde{\\nu}_{\\max}}{k_B T}\n$$\n这可以计算为：\n$$\n\\beta \\hbar \\omega_{\\max} = \\frac{\\tilde{\\nu}_{\\max}}{T \\cdot (k_B / (hc))}\n$$\n代入给定值：\n$$\n\\beta \\hbar \\omega_{\\max} = \\frac{3300\\,\\mathrm{cm}^{-1}}{300\\,\\mathrm{K} \\cdot 0.69503476\\,\\mathrm{cm}^{-1}\\,\\mathrm{K}^{-1}} = \\frac{3300}{208.510428} \\approx 15.8265\n$$\n因此，对 Trotter 数 $P$ 的条件是 $P \\ge 15.8265$。由于 $P$ 必须是整数，所需的最小珠子数量是 $P=16$。\n\n对于从头算 PIMD 设置，必须在 Born-Oppenheimer MD (BOMD) 和 Car-Parrinello MD (CPMD) 之间进行选择。在 AI-PIMD 中，P个珠子中每个珠子的势都是通过电子结构计算即时（on-the-fly）计算的。基于 BOMD 的方法需要在每个 MD 步长中，对 $P$ 个核构象中的每一个，都将其电子波函数优化到基态。这在计算上要求很高，随 $P$ 线性扩展，但它稳健且概念上直接。基于 CPMD 的方法则需要传播 $P$ 组虚拟电子自由度，这些自由度必须与 $P$ 组核自由度保持绝热分离。这会带来严重的时间步长限制和复杂的稳定性挑战。因此，**Born–Oppenheimer 分子动力学 (BOMD)** 框架是 AI-PIMD 更实用和稳健的选择。\n\n积分时间步长 $\\Delta t$ 必须选择得足够小，以分辨模拟系统中的最高频率运动。在 PIMD 中，动力学行为表现为一个经典的环状聚合物，其中的珠子由谐波弹簧连接。这些弹簧的频率是 $\\omega_P = P/(\\hbar\\beta)$。自由环状聚合物的简正模式频率为 $\\Omega_k = 2\\omega_P \\sin(k\\pi/P)$，其中 $k=1, \\dots, P-1$。这些频率中的最高频率约为 $\\Omega_{\\max} \\approx 2\\omega_P = 2P/(\\hbar\\beta)$。完整体系的频率为 $\\omega_k^{\\text{full}} = \\sqrt{\\omega_{\\text{phys}}^2 + \\Omega_k^2}$。因此，最高频率由环状聚合物的弹簧模式主导：$\\omega_{\\text{PIMD, max}} \\approx \\Omega_{\\max} = 2P/(\\hbar\\beta)$。这个最快运动的周期是 $T_{\\min} = 2\\pi / \\omega_{\\text{PIMD, max}} = \\pi\\hbar\\beta/P$。对于 $P=16$，我们有 $T_{\\min} = \\pi \\hbar\\beta / 16$。使用我们之前的结果，$\\hbar\\beta = (\\beta\\hbar\\omega_{\\max})/\\omega_{\\max} = 15.8265 / (2\\pi c \\tilde{\\nu}_{\\max}) \\approx 2.54 \\times 10^{-14}\\,\\mathrm{s}$，即 $25.4\\,\\mathrm{fs}$。因此，$T_{\\min} \\approx \\pi(25.4\\,\\mathrm{fs})/16 \\approx 5.0\\,\\mathrm{fs}$。稳定的积分要求时间步长 $\\Delta t$ 至少小一个数量级，因此对稳定时间步长的合理估计是 $\\Delta t \\approx 0.1 - 0.2\\,\\mathrm{fs}$。\n\n最后，关于控温策略，已知 PIMD 系统存在严重的非遍历性问题。将单个恒温器应用于所有自由度是失败的，因为物理模式与环状聚合物的刚性高频内部模式之间的能量交换极其缓慢。这导致对正则系综的采样不正确。为确保所有模式得到适当的热平衡，需要一个专门的恒温器。最佳策略是为环状聚合物的每个简正模式应用一个单独的恒温器。**路径积分 Nosé-Hoover 链 (PI-NHC)** 恒温器是用于此目的的标准且稳健的方法。它通过单独热化每个简正模式来保证正确的正则采样，从而克服了遍历性问题。或者，一个配置得当的广义朗之万方程 (GLE) 恒温器也可以非常有效。", "answer": "$$\n\\boxed{16}\n$$", "id": "2759518"}, {"introduction": "我们已经知道，PIMD 对平衡态静态性质的计算是精确的（在 $P \\to \\infty$ 极限下）。然而，当我们转向动力学性质时，情况就变得复杂了。简单地对环状聚合物进行经典演化（如在环状聚合物分子动力学 RPMD 中）是一种近似，它在何处会失效？下面这个思想实验将挑战你对量子相干性的理解，要求你辨别哪种物理情景最能清晰地揭示经典环状聚合物动力学与真实量子动力学之间的质的差异 [@problem_id:2459919]。这个练习对于培养对近似量子动力学方法的批判性思维至关重要。", "problem": "要求您选择一个简单的一维 ($1$D) 模型系统，以最清晰地展示在通过使用经典运动方程传播同构环状聚合物来计算实时相关函数时，路径积分分子动力学（PIMD）同构方法的失效。考虑在逆温度 $\\beta$ 下的精确量子实时位置自相关函数\n$$\nC_{xx}(t)=\\frac{1}{Z}\\,\\mathrm{Tr}\\!\\left[e^{-\\beta \\hat H}\\,\\hat x(0)\\,\\hat x(t)\\right],\\quad \\hat x(t)=e^{\\frac{i}{\\hbar}\\hat H t}\\,\\hat x\\,e^{-\\frac{i}{\\hbar}\\hat H t},\\quad Z=\\mathrm{Tr}\\!\\left[e^{-\\beta \\hat H}\\right],\n$$\n其中 $\\hat H$ 是在一维势 $V(x)$ 中质量为 $m$ 的单个粒子的哈密顿量，$\\hbar$ 是约化普朗克常数。PIMD所基于的虚时路径积分同构对于平衡（静态）量子统计是精确的，但它并未为精确的实时量子动力学提供直接途径。下列哪个单粒子一维势能在精确的 $C_{xx}(t)$ 中最清晰地表现出同构环状聚合物的经典演化无法捕捉的定性特征，从而证明了这种失效？请选择唯一最佳选项。\n\nA. 谐振子：$V(x)=\\tfrac{1}{2} m \\omega^{2} x^{2}$，其中 $\\omega$ 为任意值。\n\nB. 对称双势阱：$V(x)=a\\,(x^{2}-b^{2})^{2}$，其中 $a>0$，$b>0$，且势垒高度 $V_{0}=a\\,b^{4}$ 满足 $V_{0}\\gg k_{\\mathrm{B}}T$（其中 $k_{\\mathrm{B}}$ 是玻尔兹曼常数），因此最低的两个能量本征态因微小的隧穿能 $\\Delta$ 而分裂。\n\nC. 环上的自由粒子：$V(x)=0$，在长度为 $L$ 的区域上具有周期性边界条件。\n\nD. 莫尔斯振子：$V(x)=D_{e}\\,\\big(1-e^{-\\alpha x}\\big)^{2}$，其中 $D_{e}>0$ 且 $\\alpha>0$。", "solution": "该问题要求确定一种一维 ($1$D) 势，在该势中，同构环状聚合物的经典传播（如环状聚合物分子动力学 (RPMD) 等方法中所用）最清晰地无法再现精确量子实时位置自相关函数 $C_{xx}(t)$ 的定性特征。\n\n让我们从基本原理开始。精确的量子实时位置自相关函数由下式给出：\n$$\nC_{xx}(t) = \\frac{1}{Z} \\sum_{n,m} e^{-\\beta E_n} |\\langle n|\\hat{x}|m \\rangle|^2 e^{i(E_n - E_m)t/\\hbar}\n$$\n其中 $\\{|n\\rangle\\}$ 和 $\\{E_n\\}$ 分别是哈密顿量 $\\hat{H}$ 的本征态和本征值。$C_{xx}(t)$ 的时间演化由以玻尔频率 $\\omega_{nm} = (E_n - E_m)/\\hbar$ 进行的振荡的相干叠加所决定。\n\n路径积分分子动力学 (PIMD) 同构将单个量子粒子映射为由 $P$ 个珠子组成的经典环状聚合物。当使用经典运动方程传播时，该环状聚合物的动力学旨在近似量子动力学。然而，这种经典演化从根本上无法捕捉量子相干性，而量子相干性源于相位因子 $e^{i(E_n - E_m)t/\\hbar}$。经典聚合物的动力学由其在经典势能面上的运动所支配。这种运动可以表现出与势的曲率相关的频率的振荡，也可以表现出越过势垒的随机跃迁，但它无法再现其频率由纯粹量子现象（如隧穿）引起的能级差决定的振荡。\n\n我们现在将评估每种势，以确定哪一种为这种失效提供了最明确的例子。\n\nA. 谐振子：$V(x)=\\tfrac{1}{2} m \\omega^{2} x^{2}$。\n其能级是等距的：$E_n = \\hbar\\omega(n+\\frac{1}{2})$。位置算符 $\\hat{x}$ 的选择定则是 $\\Delta n = \\pm 1$。因此，对 $C_{xx}(t)$ 有贡献的唯一非零玻尔频率是 $\\omega_{n, n\\pm 1} = \\mp \\omega$。精确的相关函数是纯粹以单一频率 $\\omega$ 振荡的：$C_{xx}(t) \\propto \\cos(\\omega t)$。\n对于谐振子，已知同构环状聚合物的经典传播 (RPMD) 是精确的。环状聚合物的简正模式解耦，而对应于物理位置的质心模式恰好以频率 $\\omega$ 振荡。因此，谐振子是这种近似方法能得出精确量子结果的特例。所以，它是演示该方法失效的最差选择。\n**结论**：不正确。\n\nB. 对称双势阱：$V(x)=a\\,(x^{2}-b^{2})^{2}$，且具有高势垒 $V_{0}\\gg k_{\\mathrm{B}}T$。\n由于高势垒的存在，低能本征态由局域在每个势阱中的态的对称和反对称组合形成。基态 $|0\\rangle$（对称）和第一激发态 $|1\\rangle$（反对称）之间由一个小的隧穿分裂 $\\Delta = E_1 - E_0$ 隔开。在低温下 ($k_{\\mathrm{B}}T \\ll V_0$)，这些是热综系中的主要态。\n位置算符 $\\hat{x}$ 具有奇宇称，因此它只连接宇称相反的态。在低能量下，最重要的矩阵元是 $\\langle 0|\\hat{x}|1 \\rangle$。相应的玻尔频率是 $\\omega_{10} = \\Delta/\\hbar$。因此，精确的 $C_{xx}(t)$ 将以这个隧穿频率表现出缓慢的相干振荡：$C_{xx}(t) \\propto \\cos((\\Delta/\\hbar) t)$。这种振荡代表了粒子在两个势阱之间来回相干隧穿。\n现在，考虑同构环状聚合物的经典动力学。整个聚合物局域在两个势阱中的一个。要使系统在势阱之间跃迁，整个聚合物必须越过势垒。这是一个经典的热激活过程。其动力学特征将是阱间的非相干、随机跳跃，速率由阿伦尼乌斯定律决定。由此产生的相关函数将呈现指数型衰减，而非相干振荡。经典系统从根本上无法捕捉导致隧穿振荡的左阱态和右阱态的相干叠加。\n这呈现了一个鲜明的定性差异：精确的量子动力学是振荡和相干的，而近似的经典聚合物动力学是随机和非相干的。这是 RPMD 无法描述量子相干性的典型例子。\n**结论**：正确。\n\nC. 环上的自由粒子：$V(x)=0$，在长度为 $L$ 的区域上具有周期性边界条件。\n本征态是平面波，能量为 $E_n = \\frac{\\hbar^2}{2m}(\\frac{2\\pi n}{L})^2$。量子动力学涉及波包的弥散。随着初始局域态在环上散开，$C_{xx}(t)$ 时间相关函数将随时间衰减。\n在 RPMD 描述中，系统是由谐振弹簧连接的自由粒子组成的环状聚合物。该聚合物的质心像经典自由粒子一样运动。聚合物的内部模式发生振荡。RPMD 得到的相关函数也将显示相关性的衰减。虽然衰减的函数形式不精确，但其定性行为——位置相关性随时间衰减——被捕捉到了。这种失效是定量的，而不是像双势阱情况中看到的鲜明的定性矛盾。经典模型中完全不存在像隧穿这样独特的、纯粹的量子振荡特征。\n**结论**：不正确。\n\nD. 莫尔斯振子：$V(x)=D_{e}\\,\\big(1-e^{-\\alpha x}\\big)^{2}$。\n这种势是非谐的，支持有限数量的束缚态。其能级不是等距的：$E_n \\approx \\hbar\\omega_e(n+\\frac{1}{2}) - \\hbar\\omega_e x_e (n+\\frac{1}{2})^2$。与谐振子相比，$\\hat{x}$ 的选择定则放宽了，允许 $\\Delta n = \\pm 1, \\pm 2, \\ldots$ 的跃迁。精确的 $C_{xx}(t)$ 将是许多不同频率的叠加，导致相关函数的退相干和衰减，并可能出现再现（量子拍）。\n莫尔斯振子的 RPMD 模拟涉及一个经典的环状聚合物，其中每个珠子都受到莫尔斯势的作用。由于非谐性，聚合物的简正模式是耦合的。这种耦合导致模式间的能量流动，从而导致位置自相关函数的衰减。因此，RPMD 确实捕捉到了振动退相干和衰减的定性特征，这也存在于精确的量子动力学中。失效主要是定量的，涉及精确的频率和衰减率。它不代表一种完全的定性失效，即错过了一整类物理现象（如相干隧穿）。\n**结论**：不正确。\n\n总结：对称双势阱势为这种失效提供了最明确和定性上最清晰的证明。量子系统表现出相干的隧穿振荡，这一特征在同构环状聚合物的经典、非相干跳跃动力学中是根本不存在的。", "answer": "$$\\boxed{B}$$", "id": "2459919"}, {"introduction": "在前两个练习的基础上，我们将通过一个综合性的编程实践来量化和比较多种基于路径积分的方法。我们将以可精确求解的量子谐振子为模型，从第一性原理出发，推导并计算 PIMD、RPMD、质心分子动力学（CMD）和恒温环状聚合物分子动力学（TRPMD）的关键物理量。通过这个练习，你不仅能实现这些方法的计算，更重要的是能深入理解它们如何处理静态和动态性质，以及它们各自的近似程度和适用范围 [@problem_id:2793590]。这是一个将理论知识转化为可运行代码和深刻物理洞察力的核心实践。", "problem": "构建一个完整、可运行的程序。对于一维量子谐振子，该程序需基于第一性原理，实现对四种基于路径积分的分子动力学近似方法：路径积分分子动力学 (PIMD)、环状聚合物分子动力学 (RPMD)、质心分子动力学 (CMD) 和恒温环状聚合物分子动力学 (TRPMD) 的比较。您的程序必须从路径积分的离散化和环状聚合物的简正模表示出发，计算指定的平衡态和动力学概要量。\n\n您必须遵循以下要求。\n\n- 物理模型。考虑一个质量为 $m$ 的粒子在谐振势 $V(x) = \\tfrac{1}{2} m \\omega^2 x^2$ 中运动，体系逆温度为 $\\beta$。使用约化单位，其中普朗克常数和玻尔兹曼常数分别为 $ \\hbar = 1 $ 和 $ k_B = 1 $。所有量都必须用这些约化单位表示。\n\n- 使用的基本依据。从离散为 $P$ 个时间片的虚时 Feynman 路径积分开始，并将其映射到一个具有 $P$ 个珠子的经典环状聚合物。相应的环状聚合物哈密顿量，在简正模表示下，是 $P$ 个解耦谐振模的总和。设环状聚合物的弹簧频率为 $\\omega_P = \\dfrac{P}{\\beta \\hbar}$，第 $k$ 个简正模频率为\n$$\n\\Omega_k \\equiv \\sqrt{ \\omega^2 + 4 \\omega_P^2 \\sin^2\\!\\left( \\frac{\\pi k}{P} \\right) }, \\quad k = 0,1,\\dots,P-1.\n$$\n您的推导必须依赖于此表示方法以及正则采样下谐振模的高斯统计特性。\n\n- 要计算的量。对于每个参数集，计算以下内容：\n  1. 单个珠子的 PIMD 珠子平均位置方差，记为 $\\langle x^2 \\rangle_{\\text{PIMD}}(P)$，用环状聚合物的简正模表示。该值必须由简正模所蕴含的珠子坐标的平衡协方差得出。\n  2. 谐振子的精确量子力学方差：\n  $$\n  \\langle x^2 \\rangle_{\\text{exact}} = \\frac{\\hbar}{2 m \\omega} \\coth\\!\\left( \\frac{\\beta \\hbar \\omega}{2} \\right),\n  $$\n  用指定的约化单位表示。\n  3. RPMD 的概要频率，其定义为珠子平均位置自相关函数的简正模加权平均振荡频率。该频率需使用出现在 PIMD 方差中的平衡模振幅权重以及未阻尼频率 $\\Omega_k$ 来构建。\n  4. TRPMD 的相应概要频率，其定义方式相同，但内部模式 $(k \\neq 0)$ 会经历朗之万阻尼，其中均匀的摩擦系数 $\\gamma$ 仅施加于内部简正模，而质心模式 $(k=0)$ 则不受阻尼。对于每个内部模式，在加权平均中使用欠阻尼频率 $\\sqrt{\\max(\\Omega_k^2 - \\gamma^2/4,\\,0)}$。\n  5. CMD 的概要频率，通过绝热地消除内部模式得到，因此只有质心模式对动力学有贡献。\n  6. 精确的谐振频率。\n\n- 频率单位。所有频率都必须以弧度/单位时间处理和报告。\n\n- 输出规格。对于每个测试用例，输出一个列表，其中按此确切顺序包含以下七个浮点数：\n  - $\\langle x^2 \\rangle_{\\text{PIMD}}(P)$\n  - $\\langle x^2 \\rangle_{\\text{exact}}$\n  - RPMD 加权平均频率\n  - TRPMD 加权平均频率\n  - CMD 频率\n  - 精确谐振频率\n  - PIMD 方差相对于精确值的相对误差，定义为 $\\left( \\langle x^2 \\rangle_{\\text{PIMD}} - \\langle x^2 \\rangle_{\\text{exact}} \\right) / \\langle x^2 \\rangle_{\\text{exact}}$\n\n- 测试套件。您的程序必须精确评估以下四个参数集，每个参数集以元组 $(m,\\omega,\\beta,\\hbar,P,\\gamma)$ 的形式在约化单位下给出，并内部强制执行 $\\hbar=1$：\n  - 案例 A (边界，单珠子): $(1.0,\\,1.0,\\,5.0,\\,1.0,\\,1,\\,0.8)$\n  - 案例 B (低温，多珠子): $(1.0,\\,1.0,\\,20.0,\\,1.0,\\,64,\\,1.0)$\n  - 案例 C (高频，中等珠子数): $(1.0,\\,3.0,\\,1.0,\\,1.0,\\,16,\\,2.0)$\n  - 案例 D (较大质量，较软模式): $(2.0,\\,0.5,\\,10.0,\\,1.0,\\,32,\\,0.5)$\n\n- 最终输出格式。您的程序应生成单行输出，其中包含一个含四个列表的列表，每个子列表对应一个测试用例，并严格按照 A、B、C、D 的顺序排列。每个内部列表必须包含上述七个浮点数，外部列表必须打印为由方括号括起来的逗号分隔列表。例如：\n\"[[a1,a2,a3,a4,a5,a6,a7],[b1,b2,b3,b4,b5,b6,b7],[c1,c2,c3,c4,c5,c6,c7],[d1,d2,d3,d4,d5,d6,d7]]\"\n\n不允许用户输入；程序必须完全独立，无需修改即可运行。", "solution": "问题陈述经过了严格的验证。\n\n**步骤1：提取给定条件**\n-   **物理系统**：一个一维量子谐振子，质量为 $m$，势能为 $V(x) = \\frac{1}{2} m \\omega^2 x^2$。\n-   **热力学状态**：逆温度 $\\beta = 1/(k_B T)$。\n-   **单位**：约化单位，$\\hbar = 1$ 且 $k_B = 1$。\n-   **路径积分模型**：具有 $P$ 个珠子的环状聚合物。\n-   **环状聚合物弹簧频率**：$\\omega_P = \\frac{P}{\\beta \\hbar}$。\n-   **简正模频率**：$\\Omega_k = \\sqrt{ \\omega^2 + 4 \\omega_P^2 \\sin^2\\!\\left( \\frac{\\pi k}{P} \\right) }$，其中 $k = 0, 1, \\dots, P-1$。\n-   **要计算的量**：\n    1.  PIMD 珠子平均位置方差，$\\langle x^2 \\rangle_{\\text{PIMD}}(P)$。\n    2.  精确量子力学位置方差，$\\langle x^2 \\rangle_{\\text{exact}} = \\frac{\\hbar}{2 m \\omega} \\coth\\!\\left( \\frac{\\beta \\hbar \\omega}{2} \\right)$。\n    3.  RPMD 概要频率, $\\omega_{\\text{RPMD}}$。\n    4.  TRPMD 概要频率, $\\omega_{\\text{TRPMD}}$，内部模式摩擦系数为 $\\gamma$。对于 $k \\neq 0$，阻尼频率为 $\\sqrt{\\max(\\Omega_k^2 - \\gamma^2/4, 0)}$。\n    5.  CMD 概要频率, $\\omega_{\\text{CMD}}$。\n    6.  精确谐振频率, $\\omega$。\n    7.  相对误差：$(\\langle x^2 \\rangle_{\\text{PIMD}} - \\langle x^2 \\rangle_{\\text{exact}}) / \\langle x^2 \\rangle_{\\text{exact}}$。\n-   **测试参数**：提供了四组 $(m, \\omega, \\beta, \\hbar, P, \\gamma)$ 参数集。\n\n**步骤2：使用提取的给定条件进行验证**\n该问题在理论与计算化学的既定框架内具有坚实的科学基础。问题提法明确、客观且自成体系。所提供的公式和概念——环状聚合物同构、简正模分析以及 PIMD、RPMD、CMD 和 TRPMD 的定义——均为该领域的标准内容。谐振子是一个典型的、非平凡的模型体系，其精确解是已知的，这使得进行基于第一性原理的比较成为可能。不存在矛盾、歧义或事实性错误。\n\n**步骤3：结论与行动**\n该问题被判定为有效。我们按要求从第一性原理开始推导所需的量。\n\n我们分析的基础是量子配分函数的经典同构，它将单个量子粒子映射为由 $P$ 个珠子组成的经典环状聚合物。对于谐振势，环状聚合物的势能是珠子坐标 $\\{x_j\\}$ 的二次型。通过变换到简正模坐标 $\\{c_k'\\}$，该二次型可以被对角化。在这些坐标下，势能为：\n$$\nV_{\\text{NM}} = \\frac{1}{2} m \\sum_{k=0}^{P-1} \\Omega_k^2 (c_k')^2\n$$\n其中 $\\Omega_k$ 是给定的简正模频率。每个简正模的行为都像一个独立的经典谐振子。\n\n1.  **PIMD 珠子平均位置方差, $\\langle x^2 \\rangle_{\\text{PIMD}}(P)$**\n    环状聚合物模型是在逆温度 $\\beta$ 下的一个经典体系。根据能量均分定理，储存在每个简正模中的平均势能为 $\\frac{1}{2}k_B T = \\frac{1}{2\\beta}$。\n    $$\n    \\frac{1}{2} m \\Omega_k^2 \\langle (c_k')^2 \\rangle = \\frac{1}{2\\beta} \\implies \\langle (c_k')^2 \\rangle = \\frac{1}{\\beta m \\Omega_k^2}\n    $$\n    从珠子坐标 $\\{x_j\\}$ 到简正模坐标 $\\{c_k'\\}$ 的变换是正交的。因此，根据帕塞瓦尔定理，位置平方和是守恒的：$\\sum_{j=0}^{P-1} x_j^2 = \\sum_{k=0}^{P-1} (c_k')^2$。取热力学平均值：\n    $$\n    \\sum_{j=0}^{P-1} \\langle x_j^2 \\rangle = \\sum_{k=0}^{P-1} \\langle (c_k')^2 \\rangle\n    $$\n    根据对称性，所有珠子都是等价的，因此所有 $j$ 的 $\\langle x_j^2 \\rangle$ 都相同。我们将其记为 $\\langle x^2 \\rangle_{\\text{PIMD}}$。\n    $$\n    P \\langle x^2 \\rangle_{\\text{PIMD}} = \\sum_{k=0}^{P-1} \\frac{1}{\\beta m \\Omega_k^2}\n    $$\n    因此，珠子平均位置方差为：\n    $$\n    \\langle x^2 \\rangle_{\\text{PIMD}}(P) = \\frac{1}{P \\beta m} \\sum_{k=0}^{P-1} \\frac{1}{\\Omega_k^2}\n    $$\n    代入 $\\Omega_k$ 的表达式并设 $\\hbar=1$:\n    $$\n    \\langle x^2 \\rangle_{\\text{PIMD}}(P) = \\frac{1}{P \\beta m} \\sum_{k=0}^{P-1} \\frac{1}{\\omega^2 + 4(P/\\beta)^2 \\sin^2(\\pi k / P)}\n    $$\n\n2.  **精确量子方差, $\\langle x^2 \\rangle_{\\text{exact}}$**\n    这个量是直接给出的。当 $\\hbar=1$ 时：\n    $$\n    \\langle x^2 \\rangle_{\\text{exact}} = \\frac{1}{2 m \\omega} \\coth\\left(\\frac{\\beta \\omega}{2}\\right)\n    $$\n\n3.  **RPMD 概要频率, $\\omega_{\\text{RPMD}}$**\n    问题将其定义为简正模频率 $\\Omega_k$ 的加权平均值。权重与每个模式对位置方差的贡献成正比，而该贡献又与 $\\langle (c_k')^2 \\rangle$ 成正比，因此与 $1/\\Omega_k^2$ 成正比。设权重为 $w_k = C / \\Omega_k^2$，其中 $C$ 是一个归一化常数。加权平均值为：\n    $$\n    \\omega_{\\text{RPMD}} = \\frac{\\sum_{k=0}^{P-1} w_k \\Omega_k}{\\sum_{k=0}^{P-1} w_k} = \\frac{\\sum_{k=0}^{P-1} (1/\\Omega_k^2) \\Omega_k}{\\sum_{k=0}^{P-1} 1/\\Omega_k^2} = \\frac{\\sum_{k=0}^{P-1} 1/\\Omega_k}{\\sum_{k=0}^{P-1} 1/\\Omega_k^2}\n    $$\n\n4.  **TRPMD 概要频率, $\\omega_{\\text{TRPMD}}$**\n    它的构建方式与 $\\omega_{\\text{RPMD}}$ 类似，但内部模式 ($k=1, \\dots, P-1$) 的频率被带有摩擦系数 $\\gamma$ 的朗之万阻尼所修正。质心模式 ($k=0$) 保持无阻尼。质心模式的频率为 $\\Omega_0 = \\omega$。内部模式的频率为 $\\Omega'_k = \\sqrt{\\max(0, \\Omega_k^2 - \\gamma^2/4)}$。加权平均值为：\n    $$\n    \\omega_{\\text{TRPMD}} = \\frac{w_0 \\Omega_0 + \\sum_{k=1}^{P-1} w_k \\Omega'_k}{\\sum_{k=0}^{P-1} w_k} = \\frac{(1/\\Omega_0^2) \\Omega_0 + \\sum_{k=1}^{P-1} (1/\\Omega_k^2) \\Omega'_k}{\\sum_{k=0}^{P-1} 1/\\Omega_k^2}\n    $$\n    代入 $\\Omega_0 = \\omega$ 和 $\\Omega'_k$ 的表达式：\n    $$\n    \\omega_{\\text{TRPMD}} = \\frac{(1/\\omega) + \\sum_{k=1}^{P-1} \\Omega_k^{-2} \\sqrt{\\max(0, \\Omega_k^2 - \\gamma^2/4)}}{\\sum_{k=0}^{P-1} 1/\\Omega_k^2}\n    $$\n\n5.  **CMD 概要频率, $\\omega_{\\text{CMD}}$**\n    质心分子动力学描述了环状聚合物质心 $q_c = \\frac{1}{P} \\sum_j x_j$ 在通过对内部模式积分而产生的平均力势 (PMF) 上的演化。对于量子谐振子，其平均力势是精确谐波的，且频率与原始势相同。这是一个已知的精确结果。因此, CMD 频率与振子的物理频率相同。在动力学上，这对应于质心简正模的频率 $\\Omega_0$。\n    $$\n    \\omega_{\\text{CMD}} = \\Omega_0 = \\sqrt{\\omega^2 + 4 \\omega_P^2 \\sin^2(0)} = \\omega\n    $$\n\n6.  **精确谐振频率, $\\omega_{\\text{exact}}$**\n    这是谐振势的参数 $\\omega$。\n    $$\n    \\omega_{\\text{exact}} = \\omega\n    $$\n\n7.  **PIMD 方差的相对误差**\n    这由问题陈述定义：\n    $$\n    \\text{Error} = \\frac{\\langle x^2 \\rangle_{\\text{PIMD}}(P) - \\langle x^2 \\rangle_{\\text{exact}}}{\\langle x^2 \\rangle_{\\text{exact}}}\n    $$\n\n将为每个提供的参数集计算这七个量。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes equilibrium and dynamical properties for a 1D quantum harmonic oscillator\n    using PIMD, RPMD, CMD, and TRPMD approximations based on the normal-mode representation.\n    \"\"\"\n    # Test cases: (m, omega, beta, hbar, P, gamma)\n    # The problem specifies hbar=1, which is used in the calculations.\n    test_cases = [\n        (1.0, 1.0, 5.0, 1.0, 1, 0.8),    # Case A\n        (1.0, 1.0, 20.0, 1.0, 64, 1.0),   # Case B\n        (1.0, 3.0, 1.0, 1.0, 16, 2.0),   # Case C\n        (2.0, 0.5, 10.0, 1.0, 32, 0.5),  # Case D\n    ]\n\n    all_results = []\n\n    for case in test_cases:\n        m, omega, beta, hbar, P, gamma = case\n\n        # Enforce reduced units\n        hbar = 1.0\n        k_B = 1.0\n\n        # --- Normal Mode Frequencies ---\n        # Ring-polymer spring frequency\n        omega_P = P / (beta * hbar)\n        \n        # Normal mode indices k = 0, 1, ..., P-1\n        k_indices = np.arange(P)\n        \n        # Normal mode frequencies squared, Omega_k^2\n        sin_term = np.sin(np.pi * k_indices / P)\n        Omega_k_sq = omega**2 + 4 * omega_P**2 * sin_term**2\n        Omega_k = np.sqrt(Omega_k_sq)\n\n        # --- 1. PIMD Bead-Averaged Position Variance ---\n        # <x^2>_PIMD = (1 / (P * beta * m)) * sum(1 / Omega_k^2)\n        inv_Omega_k_sq = 1.0 / Omega_k_sq\n        pimd_variance = np.sum(inv_Omega_k_sq) / (P * beta * m)\n\n        # --- 2. Exact Quantum Variance ---\n        # <x^2>_exact = (hbar / (2*m*omega)) * coth(beta*hbar*omega/2)\n        arg = beta * hbar * omega / 2.0\n        # Use 1/tanh(x) for coth(x) for numerical stability.\n        # For x > ~36, tanh(x) is 1.0 in float64, so avoid overflow with exp.\n        if arg > 36:\n            coth_val = 1.0\n        else:\n            coth_val = 1.0 / np.tanh(arg) \n        exact_variance = (hbar / (2.0 * m * omega)) * coth_val\n\n        # --- 3. RPMD Summary Frequency ---\n        # omega_RPMD = sum(1/Omega_k) / sum(1/Omega_k^2)\n        inv_Omega_k = 1.0 / Omega_k\n        rpmd_freq = np.sum(inv_Omega_k) / np.sum(inv_Omega_k_sq)\n\n        # --- 4. TRPMD Summary Frequency ---\n        # omega_TRPMD includes damping on internal modes (k > 0)\n        # Undamped centroid mode (k=0) frequency is omega\n        # Damped internal mode frequencies are sqrt(max(0, Omega_k^2 - gamma^2/4))\n        \n        # Numerator: w_0*Omega_0 + sum_{k>0} w_k*Omega'_k\n        # w_k is proportional to 1/Omega_k^2\n        # Numerator simplifies to (1/Omega_0) + sum_{k>0} Omega'_k/Omega_k^2\n        if P > 1:\n            Omega_k_internal_sq = Omega_k_sq[1:]\n            damped_freq_internal = np.sqrt(np.maximum(0, Omega_k_internal_sq - (gamma**2 / 4.0)))\n            \n            numerator = inv_Omega_k[0] + np.sum(damped_freq_internal / Omega_k_internal_sq)\n        else: # P=1, no internal modes\n            numerator = inv_Omega_k[0]\n\n        # Denominator is sum(1/Omega_k^2), same as for RPMD\n        denominator = np.sum(inv_Omega_k_sq)\n        trpmd_freq = numerator / denominator\n\n        # --- 5. CMD Summary Frequency ---\n        # For a harmonic oscillator, the CMD frequency is exactly omega.\n        cmd_freq = omega\n\n        # --- 6. Exact Harmonic Frequency ---\n        exact_freq = omega\n        \n        # --- 7. Relative Error in PIMD Variance ---\n        rel_error = (pimd_variance - exact_variance) / exact_variance\n\n        case_results = [\n            pimd_variance,\n            exact_variance,\n            rpmd_freq,\n            trpmd_freq,\n            cmd_freq,\n            exact_freq,\n            rel_error\n        ]\n        all_results.append(case_results)\n\n    # Final output formatted as a single line string \"[[],[],[],[]]\" without spaces\n    print(str(all_results).replace(\" \", \"\"))\n\nsolve()\n```", "id": "2793590"}]}