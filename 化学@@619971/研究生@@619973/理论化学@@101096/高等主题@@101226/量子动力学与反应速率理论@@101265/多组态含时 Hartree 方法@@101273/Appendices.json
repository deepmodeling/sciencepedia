{"hands_on_practices": [{"introduction": "多维量子动力学模拟的一个核心挑战是“维度灾难”，即波函数所需的存储空间随系统自由度呈指数增长。MCTDH方法通过将系数张量表示为紧凑的张量网络格式来解决这个问题。本练习将通过具体计算，让您亲身体验和量化张量网络（如张量链，Tensor Train）表示相比于传统稠密张量在存储效率上的巨大优势 [@problem_id:2817991]。", "problem": "考虑一个具有 $f$ 个自由度的系统的多组态时间依赖哈特里 (MCTDH) 波函数，其以时间依赖的单粒子函数的直积基形式写为\n$$\n|\\Psi(t)\\rangle \\;=\\; \\sum_{j_1=1}^{n_1}\\cdots \\sum_{j_f=1}^{n_f} A_{j_1\\cdots j_f}(t)\\,\\bigotimes_{k=1}^{f} |\\varphi^{(k)}_{j_k}(t)\\rangle,\n$$\n其中 $A_{j_1\\cdots j_f}(t)$ 是组态系数张量。假设每个系数存储为一个128位复数（即每个条目16字节）。\n\n已知系统有 $f=8$ 个模式，模式维度为 $n_1=n_2=20$，$n_3=n_4=18$，$n_5=n_6=16$ 和 $n_7=n_8=14$。考虑 $A_{j_1\\cdots j_f}$ 的两种存储策略：\n- 完全稠密张量，它显式地存储所有条目。\n- 张量列 (TT)，也称为矩阵乘积态 (MPS)，其中统一的TT秩为 $r_k=r=30$ ($k=1,\\dots,f-1$)，边界秩为 $r_0=r_f=1$。\n\n仅从上述直积展开和TT表示（作为 $f$ 个大小为 $r_{k-1}\\times n_k\\times r_k$ 的三指标核心的乘积）的定义出发，完成以下任务：\n- 推导稠密表示和TT表示的总参数数量。\n- 使用给定的每个条目的字节大小，将参数数量转换为内存需求。\n- 在你的推导中，使用标度论证简要说明为什么对于高 $f$ 值，张量列及相关格式（如 Tucker 和分层 Tucker (HT)）可以比稠密张量节省大量存储空间。\n\n计算压缩因子 $\\rho$，定义为稠密内存与TT内存之比，\n$$\n\\rho \\;=\\; \\frac{\\text{dense memory (bytes)}}{\\text{TT memory (bytes)}},\n$$\n针对上面给出的特定 $f$、$\\{n_k\\}$ 和 $r$。将你计算的 $\\rho$ 的最终数值结果四舍五入到四位有效数字。将 $\\rho$ 以一个无单位的纯数报告。如果你选择进行任何中间单位转换，请假设 $1\\,\\text{GB} = 1.0\\times 10^{9}\\,\\text{bytes}$ 并在你的推理中明确说明任何此类转换，但最终报告的 $\\rho$ 值必须是无单位的，并按要求四舍五入。", "solution": "对所述问题进行验证。\n\n逐字提取已知条件：\n- 一个具有 $f$ 个自由度的系统的多组态时间依赖哈特里 (MCTDH) 波函数 $|\\Psi(t)\\rangle$ 由以下公式给出：\n$$\n|\\Psi(t)\\rangle \\;=\\; \\sum_{j_1=1}^{n_1}\\cdots \\sum_{j_f=1}^{n_f} A_{j_1\\cdots j_f}(t)\\,\\bigotimes_{k=1}^{f} |\\varphi^{(k)}_{j_k}(t)\\rangle\n$$\n- 组态系数张量为 $A_{j_1\\cdots j_f}(t)$。\n- 每个系数存储为一个128位复数，相当于16字节。\n- 自由度（模式）数量：$f=8$。\n- 模式维度（每个模式的单粒子函数数量）：$n_1=n_2=20$，$n_3=n_4=18$，$n_5=n_6=16$ 和 $n_7=n_8=14$。\n- 考虑两种存储策略：完全稠密张量和张量列 (TT)。\n- 对于TT表示，统一的内部秩为 $r_k=r=30$ ($k=1,\\dots,f-1$)，边界秩为 $r_0=r_f=1$。\n- TT表示被定义为 $f$ 个大小为 $r_{k-1}\\times n_k\\times r_k$ 的三指标核心的乘积。\n- 压缩因子 $\\rho$ 定义为 $\\rho = \\frac{\\text{dense memory (bytes)}}{\\text{TT memory (bytes)}}$。\n- $\\rho$ 的最终结果必须四舍五入到四位有效数字。\n\n对问题进行验证。该问题具有科学依据，因为 MCTDH 和张量列分解是理论化学和物理学中标准的、严谨的方法。该问题是适定的，为得到唯一解提供了所有必要的参数和定义。其语言客观而精确。因此，该问题被认为是有效的，可以构建一个解决方案。\n\n首先，我们推导 $A_{j_1 \\cdots j_f}$ 的稠密张量表示的内存需求。这个张量的阶为 $f=8$。第 $k$ 个维度的大小是 $n_k$。复系数的总数 $N_{\\text{dense}}$ 是所有模式维度的乘积：\n$$\nN_{\\text{dense}} = \\prod_{k=1}^{f} n_k\n$$\n使用给定的值 $f=8$，$n_1=n_2=20$，$n_3=n_4=18$，$n_5=n_6=16$ 和 $n_7=n_8=14$：\n$$\nN_{\\text{dense}} = n_1 \\times n_2 \\times n_3 \\times n_4 \\times n_5 \\times n_6 \\times n_7 \\times n_8\n$$\n$$\nN_{\\text{dense}} = 20^2 \\times 18^2 \\times 16^2 \\times 14^2 = (20 \\times 18 \\times 16 \\times 14)^2\n$$\n$$\nN_{\\text{dense}} = (80640)^2 = 6,502,809,600\n$$\n每个系数是一个复数，需要 16 字节的存储空间。因此，稠密张量的总内存 $M_{\\text{dense}}$ 是：\n$$\nM_{\\text{dense}} = N_{\\text{dense}} \\times 16\\,\\text{bytes} = 6,502,809,600 \\times 16 = 104,044,953,600\\,\\text{bytes}\n$$\n作为参考，使用问题指定的转换关系 $1\\,\\text{GB} = 1.0 \\times 10^9\\,\\text{bytes}$，此内存大约为 $104\\,\\text{GB}$，这是一个相当大的量。\n\n接下来，我们推导张量列 (TT) 表示（也称为矩阵乘积态, MPS）的内存需求。在这种格式中，张量 $A$ 由一系列 $f$ 个核心表示，我们记为 $C^{(k)}$。元素 $A_{j_1 \\cdots j_f}$ 表示为矩阵乘积：\n$$\nA_{j_1\\cdots j_f} = C^{(1)}_{j_1} C^{(2)}_{j_2} \\cdots C^{(f)}_{j_f}\n$$\n其中对于每个物理指标 $j_k$，$C^{(k)}_{j_k}$ 是一个大小为 $r_{k-1} \\times r_k$ 的矩阵。连接核心的指标 $\\alpha_{k-1}$ 和 $\\alpha_k$ 被称为键合或辅助指标，它们的维度 $r_{k-1}$ 和 $r_k$ 是TT秩。每个核心 $C^{(k)}$ 本身是一个大小为 $n_k \\times r_{k-1} \\times r_k$ 的三指标张量。需要存储的总参数数量 $N_{\\text{TT}}$ 是所有核心大小的总和：\n$$\nN_{\\text{TT}} = \\sum_{k=1}^{f} \\text{size}(C^{(k)}) = \\sum_{k=1}^{f} n_k \\times r_{k-1} \\times r_k\n$$\n问题指定了边界秩 $r_0=r_f=1$ 和统一的内部秩 $r_k=r=30$ ($k=1,\\dots,f-1$)。我们可以展开 $f=8$ 的求和式：\n$$\nN_{\\text{TT}} = (n_1 r_0 r_1) + (n_2 r_1 r_2) + (n_3 r_2 r_3) + (n_4 r_3 r_4) + (n_5 r_4 r_5) + (n_6 r_5 r_6) + (n_7 r_6 r_7) + (n_8 r_7 r_8)\n$$\n代入给定的秩（$r_0=1$, $r_8=1$ 和 $r_k=r=30$ 对于 $k=1,\\dots,7$）：\n$$\nN_{\\text{TT}} = (n_1 \\cdot 1 \\cdot r) + (n_2 \\cdot r \\cdot r) + (n_3 \\cdot r \\cdot r) + (n_4 \\cdot r \\cdot r) + (n_5 \\cdot r \\cdot r) + (n_6 \\cdot r \\cdot r) + (n_7 \\cdot r \\cdot r) + (n_8 \\cdot r \\cdot 1)\n$$\n$$\nN_{\\text{TT}} = n_1 r + r^2(n_2+n_3+n_4+n_5+n_6+n_7) + n_8 r\n$$\n我们现在代入模式维度 $\\{n_k\\}$ 和秩 $r=30$ 的数值：\n$$\n\\sum_{k=2}^{7} n_k = n_2+n_3+n_4+n_5+n_6+n_7 = 20 + 18 + 18 + 16 + 16 + 14 = 102\n$$\n$$\nN_{\\text{TT}} = (20 \\times 30) + (30^2 \\times 102) + (14 \\times 30)\n$$\n$$\nN_{\\text{TT}} = 600 + (900 \\times 102) + 420\n$$\n$$\nN_{\\text{TT}} = 600 + 91800 + 420 = 92820\n$$\nTT表示的总内存 $M_{\\text{TT}}$ 是：\n$$\nM_{\\text{TT}} = N_{\\text{TT}} \\times 16\\,\\text{bytes} = 92820 \\times 16 = 1,485,120\\,\\text{bytes}\n$$\n这大约是 $1.49\\,\\text{MB}$。\n\n问题要求简要论证为什么对于高 $f$ 值，张量网络格式能提供巨大的存储节省。一个阶为 $f$、平均模式维度为 $n$ 的稠密张量的存储成本按 $O(n^f)$ 标度增长。这是一种指数增长，即所谓的“维度灾难”现象，使得即使对于中等大小的 $f$，直接存储和操作在计算上也是不可行的。相比之下，张量列 (TT) 的存储成本按 $O(f n r^2)$ 标度增长，其中 $r$ 是最大TT秩。这种标度在维度数 $f$ 上是线性的。对于许多物理系统，远距离子系统之间的纠缠或关联是有限的，这导致所需的秩 $r$ 保持较小或随 $f$ 缓慢增长。从指数标度 $O(n^f)$ 到线性标度 $O(f n r^2)$ 的转变成为了巨大计算节省的来源。其他格式如 Tucker 分解的存储成本为 $O(f n r + r^f)$，其核心张量中仍包含指数项，使其在 $f$ 非常大时效率低于TT。分层 Tucker (HT) 格式也通过递归应用基于树的分解实现了线性标度 $O(f n r + f r^3)$，使得TT和HT对于高维问题都非常有效。\n\n最后，我们计算压缩因子 $\\rho$：\n$$\n\\rho = \\frac{M_{\\text{dense}}}{M_{\\text{TT}}} = \\frac{N_{\\text{dense}} \\times 16}{N_{\\text{TT}} \\times 16} = \\frac{N_{\\text{dense}}}{N_{\\text{TT}}}\n$$\n$$\n\\rho = \\frac{6,502,809,600}{92,820} \\approx 70058.27407886\n$$\n问题要求将此结果四舍五入到四位有效数字。第五位有效数字是 8，所以我们将第四位数字向上取整。\n$$\n\\rho \\approx 70060\n$$\n用科学记数法表示此结果，以明确有效数字的位数：\n$$\n\\rho \\approx 7.006 \\times 10^4\n$$\n这表明，对于这个特定情况，TT 表示比稠密张量紧凑 70,000 倍以上。", "answer": "$$\n\\boxed{7.006 \\times 10^4}\n$$", "id": "2817991"}, {"introduction": "要深刻理解像MCTDH这样复杂的方法，一个有效途径是研究其极限情况。本练习将探讨当每个模态仅使用一个单粒子函数（SPF）时，MCTDH方法与更简单的含时Hartree平均场理论之间的根本联系 [@problem_id:2818034]。通过这种分析，我们可以清晰地看到MCTDH方法的威力在于其能够系统地描述超越平均场近似的量子关联。", "problem": "考虑一个具有 $f$ 个可分辨自由度（模式）的系统，其动力学由含时薛定谔方程 (TDSE) $i\\,\\partial_t \\lvert \\Psi(t)\\rangle = \\hat{H}\\lvert \\Psi(t)\\rangle$ 描述，并使用多组态含时哈特里 (MCTDH) 方法进行近似。在 MCTDH 中，波函数被展开为单粒子函数 (SPF) 的含时哈特里积，其运动方程遵循 Dirac–Frenkel 变分原理 (DFVP) $\\delta \\langle \\delta \\Psi \\lvert i\\,\\partial_t - \\hat{H}\\rvert \\Psi\\rangle = 0$，并受到 SPF 的正交归一性约束。假设对于每个模式 $\\kappa\\in\\{1,\\dots,f\\}$，您恰好选择 $n_\\kappa = 1$ 个 SPF，即每个模式只使用一个 SPF。\n\n仅使用 TDSE、DFVP 以及 MCTDH 拟设的核心定义（即波函数是由含时正交归一的 SPF 构成的组态，通过含时系数张量进行线性组合），从第一性原理出发，推导 $n_\\kappa=1$ 的选择如何约束波函数的结构及其运动方程。基于该推论，选择下面所有在该 $n_\\kappa=1$ 极限下必定成立的陈述，并分析其对关联的影响。\n\nA. 当所有模式的 $n_\\kappa=1$ 时，组态张量简化为一个复标量，该标量可通过规范变换处理为一个物理上无关的全局相位；SPF 的运动方程变为含时哈特里 (TDH) 平均场方程，总波函数是一个单一的含时哈特里积。\n\nB. 即使 $n_\\kappa=1$，MCTDH 拟设通过含时组态系数保留了模式间的关联，因此不同模式间的纠缠可以保持非零。\n\nC. 在 $n_\\kappa=1$ 的极限下，每个模式的单粒子密度矩阵是一个 $1\\times 1$ 的单位矩阵，对应于一个秩为 1 的投影算符；因此，任意模式二分法下的 von Neumann 纠缠熵为 $0$，模式间的任何耦合仅通过 SPF 方程中的平均场势进入。\n\nD. 如果哈密顿量是严格可分离的，形式为 $\\hat{H}=\\sum_{\\kappa=1}^f \\hat{h}^{(\\kappa)}$，且没有模式间耦合，那么 $n_\\kappa=1$ 的极限会得出精确的动力学；对于不可分离的耦合，误差源于忽略了超出平均场范畴的模式间关联。\n\nE. 通过将几个物理坐标组合成一个单一的组合模式，即使在 $n_\\kappa=1$ 的情况下，也可以表示该组合内部的关联，但在该极限下，不同组合之间的关联仍然被排除。\n\n选择所有正确的选项。", "solution": "对问题陈述进行验证。\n\n**步骤 1：提取已知条件**\n- 系统：$f$ 个可分辨的自由度（模式）。\n- 控制定律：含时薛定谔方程 (TDSE)，$i\\,\\partial_t \\lvert \\Psi(t)\\rangle = \\hat{H}\\lvert \\Psi(t)\\rangle$。注意：尽管问题中写的是 $i\\,\\partial_t$，但该领域的惯例是 $i\\hbar\\,\\partial_t$。我们将像理论研究中常见的那样，假设 $\\hbar=1$。\n- 方法：多组态含时哈特里 (MCTDH)。\n- 拟设：波函数 $\\lvert \\Psi(t) \\rangle$ 展开为单粒子函数 (SPF) 的含时哈特里积的线性组合。\n- 运动方程：从 Dirac–Frenkel 变分原理 (DFVP) $\\delta \\langle \\delta \\Psi \\lvert i\\,\\partial_t - \\hat{H}\\rvert \\Psi\\rangle = 0$ 导出。\n- 约束：每个模式的 SPF 集合 $\\{\\lvert \\varphi_{j_\\kappa}^{(\\kappa)}(t) \\rangle\\}_{j_\\kappa=1}^{n_\\kappa}$ 在所有时刻 $t$ 都是正交归一的。\n- 特定条件：对于所有模式 $\\kappa \\in \\{1, \\dots, f\\}$，SPF 的数量恰好为 $n_\\kappa = 1$。\n\n**步骤 2：使用提取的条件进行验证**\n- **科学依据**：该问题植根于量子力学 (TDSE)、变分方法 (DFVP) 和多体理论 (MCTDH) 的既定原理。所指定的极限 $n_\\kappa=1$ 是 MCTDH 形式体系到含时哈特里 (TDH) 平均场理论的一个标准且易于理解的简化。该设定在科学上和事实上都是合理的。\n- **良定性**：该问题是良定的。它提供了一个清晰的理论框架和一个特定的约束 ($n_\\kappa=1$)，并要求对结果进行逻辑推导。问题是明确的，并且基于所提供的理论可以得出一组确定的正确结论。\n- **客观性**：该问题以精确、客观、形式化的科学语言陈述，没有任何主观性或模糊性。\n\n**步骤 3：结论与行动**\n问题陈述有效。它在科学上是合理的、良定的且客观的。不存在矛盾、信息缺失或其他缺陷。我将继续进行详细的推导和求解。\n\n**从第一性原理推导**\n\n对于一个有 $f$ 个可分辨模式的系统，通用的 MCTDH 拟设为：\n$$\n\\lvert \\Psi(t) \\rangle = \\sum_{j_1=1}^{n_1} \\sum_{j_2=1}^{n_2} \\dots \\sum_{j_f=1}^{n_f} A_{j_1 j_2 \\dots j_f}(t) \\prod_{\\kappa=1}^{f} \\lvert \\varphi_{j_\\kappa}^{(\\kappa)}(t) \\rangle\n$$\n此处，$A_{j_1 j_2 \\dots j_f}(t)$ 是含时系数张量，集合 $\\{\\lvert \\varphi_{j_\\kappa}^{(\\kappa)}(t) \\rangle\\}_{j_\\kappa=1}^{n_\\kappa}$ 包含了模式 $\\kappa$ 的 $n_\\kappa$ 个正交归一的含时单粒子函数 (SPF)。\n\n现在，我们施加问题中指定的条件：对所有模式 $\\kappa \\in \\{1, \\dots, f\\}$，$n_\\kappa = 1$。\n在此约束下，拟设中的每个求和都只对一个索引 $j_\\kappa=1$ 进行。因此，求和塌缩为一项。多重索引 $(j_1, j_2, \\dots, j_f)$ 只能取值 $(1, 1, \\dots, 1)$。系数张量 $A$ 简化为一个复标量 $A_{11\\dots1}(t)$。波函数的形式变为：\n$$\n\\lvert \\Psi(t) \\rangle = A_{11\\dots1}(t) \\prod_{\\kappa=1}^{f} \\lvert \\varphi_1^{(\\kappa)}(t) \\rangle\n$$\n总波函数必须归一化为 1：$\\langle \\Psi(t) \\lvert \\Psi(t) \\rangle = 1$。我们来计算这个模：\n$$\n\\langle \\Psi(t) \\lvert \\Psi(t) \\rangle = \\left( A_{11\\dots1}^*(t) \\prod_{\\lambda=1}^{f} \\langle \\varphi_1^{(\\lambda)}(t) \\rvert \\right) \\left( A_{11\\dots1}(t) \\prod_{\\kappa=1}^{f} \\lvert \\varphi_1^{(\\kappa)}(t) \\rangle \\right)\n$$\n$$\n= |A_{11\\dots1}(t)|^2 \\prod_{\\kappa=1}^{f} \\langle \\varphi_1^{(\\kappa)}(t) \\lvert \\varphi_1^{(\\kappa)}(t) \\rangle\n$$\n由于 SPF 的正交归一性约束，对每个模式 $\\kappa$ 都有 $\\langle \\varphi_1^{(\\kappa)}(t) \\lvert \\varphi_1^{(\\kappa)}(t) \\rangle = 1$。因此，归一化条件意味着：\n$$\n|A_{11\\dots1}(t)|^2 = 1\n$$\n这意味着系数 $A_{11\\dots1}(t)$ 是一个纯相位因子，可以写成 $e^{i\\gamma(t)}$ 的形式，其中 $\\gamma(t)$ 是某个实函数。总波函数上的全局相位因子在物理上是不可观测的。它可以被吸收到 SPF 的定义中，或者更简单地，通过选择一个规范使其为 1。通过这种规范选择，波函数拟设简化为单个含时哈特里积：\n$$\n\\lvert \\Psi(t) \\rangle = \\prod_{\\kappa=1}^{f} \\lvert \\varphi_1^{(\\kappa)}(t) \\rangle\n$$\n这恰好是含时哈特里 (TDH) 方法的拟设，它是一种平均场理论。\n\n将 Dirac-Frenkel 变分原理应用于这个乘积拟设，可以得到 SPF $\\lvert \\varphi_1^{(\\kappa)}(t) \\rangle$ 的运动方程。这些就是著名的 TDH 方程，其中每个 SPF 在一个平均场哈密顿量的影响下演化。模式 $\\lambda$ 的平均场哈密顿量，记作 $\\langle \\hat{H} \\rangle^{(\\lambda)}$，是总哈密顿量 $\\hat{H}$ 对所有其他模式的当前状态取平均值：\n$$\n\\langle \\hat{H} \\rangle^{(\\lambda)}(t) = \\left\\langle \\prod_{\\kappa \\neq \\lambda} \\varphi_1^{(\\kappa)}(t) \\middle| \\hat{H} \\middle| \\prod_{\\kappa \\neq \\lambda} \\varphi_1^{(\\kappa)}(t) \\right\\rangle\n$$\n该符号表示对除模式 $\\lambda$ 坐标外的所有坐标进行积分。每个 SPF 的演化则由一个形式为 $i\\,\\partial_t \\lvert \\varphi_1^{(\\lambda)} \\rangle = \\hat{H}_{\\text{eff}}^{(\\lambda)} \\lvert \\varphi_1^{(\\lambda)} \\rangle$ 的方程控制，这些就是 TDH 方程。\n\n现在，我们分析关联的概念。根据定义，一个可以写成不同自由度函数的单一乘积形式的波函数，$\\lvert \\Psi \\rangle = \\lvert \\psi_1 \\rangle \\otimes \\lvert \\psi_2 \\rangle \\otimes \\dots \\otimes \\lvert \\psi_f \\rangle$，是一个乘积态。这种状态是无关联的，意味着它不包含自由度之间的量子纠缠。任何子系统（单个模式或一组模式）的约化密度矩阵都是一个纯态投影算符。例如，对于模式 $\\lambda$，约化密度算符为 $\\hat{\\rho}^{(\\lambda)} = \\text{Tr}_{\\kappa \\neq \\lambda}[\\lvert \\Psi \\rangle \\langle \\Psi \\rvert] = \\lvert \\varphi_1^{(\\lambda)} \\rangle \\langle \\varphi_1^{(\\lambda)} \\rvert$。由于这是一个纯态投影算符，其 von Neumann 熵 $S(\\hat{\\rho}^{(\\lambda)}) = -\\text{Tr}(\\hat{\\rho}^{(\\lambda)} \\ln \\hat{\\rho}^{(\\lambda)})$ 为零。这对系统的任何二分都成立，证实了模式间纠缠完全不存在。\n\n在其自身 SPF 基下，模式 $\\kappa$ 的单粒子密度矩阵定义为 $\\rho_{mn}^{(\\kappa)} = \\text{Tr}'[\\mathbf{A}^\\dagger (\\mathbf{1}^{(\\kappa'<\\kappa)}\\otimes\\mathbf{C}_{nm}^{(\\kappa)}\\otimes\\mathbf{1}^{(\\kappa'>\\kappa)})\\mathbf{A}]$，其中 $\\text{Tr}'$ 是对除 $\\kappa$ 之外的所有模式指标的求迹。在我们的情况下，$m=n=1$，所以 $\\rho_{11}^{(\\kappa)}$ 是对 A 向量模平方的求迹。由于只有一个系数 $A_{1...1}$ 且 $|A_{1...1}|^2=1$，我们得到 $\\rho_{11}^{(\\kappa)}=1$。这是一个 $1 \\times 1$ 的单位矩阵。\n\n在此基础上，我们评估各个选项。\n\n**逐项分析**\n\n**A. 当所有模式的 $n_\\kappa=1$ 时，组态张量简化为一个复标量，该标量可通过规范变换处理为一个物理上无关的全局相位；SPF 的运动方程变为含时哈特里 (TDH) 平均场方程，总波函数是一个单一的含时哈特里积。**\n- 组态张量 $A_{j_1 \\dots j_f}$ 变为单个元素 $A_{1 \\dots 1}$。这是正确的。\n- 归一化要求 $|A_{1 \\dots 1}|^2=1$，使其成为一个可以通过规范变换设置为 1 的相位因子。这是正确的。\n- MCTDH 拟设简化为单一哈特里积 $\\lvert \\Psi \\rangle = \\prod_\\kappa \\lvert \\varphi_1^{(\\kappa)}\\rangle$ 是 TDH 方法的定义性特征。相应的运动方程就是 TDH 方程。这是正确的。\n- 因此，波函数是一个单一的含时哈特里积。这是正确的。\n**结论：正确。**\n\n**B. 即使 $n_\\kappa=1$，MCTDH 拟设通过含时组态系数保留了模式间的关联，因此不同模式间的纠缠可以保持非零。**\n- 如上所述，波函数变为一个单一的哈特里积。根据定义，这种状态的模式间关联或纠缠为零。组态“系数”已塌缩为一个单一的全局相位，无法描述子系统之间的关联。这一陈述与数学结果直接矛盾。\n**结论：不正确。**\n\n**C. 在 $n_\\kappa=1$ 的极限下，每个模式的单粒子密度矩阵是一个 $1\\times 1$ 的单位矩阵，对应于一个秩为 1 的投影算符；因此，任意模式二分法下的 von Neumann 纠缠熵为 $0$，模式间的任何耦合仅通过 SPF 方程中的平均场势进入。**\n- 单粒子密度矩阵 $\\rho_{11}^{(\\kappa)}=1$ 是 $1 \\times 1$ 的单位矩阵。这是正确的。\n- 相应的密度算符 $\\hat{\\rho}^{(\\kappa)} = \\lvert \\varphi_1^{(\\kappa)} \\rangle \\langle \\varphi_1^{(\\kappa)} \\rvert$ 是一个秩为 1 的投影算符。这是正确的。\n- 总状态是一个乘积态。对于任何二分，子系统的约化密度矩阵是纯态。纯态的 von Neumann 熵为零。这是正确的。\n- 从 TDH 方程的推导中可以看出，其他模式对给定模式 $\\lambda$ 的影响完全封装在平均场哈密顿量 $\\langle \\hat{H} \\rangle^{(\\lambda)}$ 中。这是正确的。\n**结论：正确。**\n\n**D. 如果哈密顿量是严格可分离的，形式为 $\\hat{H}=\\sum_{\\kappa=1}^f \\hat{h}^{(\\kappa)}$，且没有模式间耦合，那么 $n_\\kappa=1$ 的极限会得出精确的动力学；对于不可分离的耦合，误差源于忽略了超出平均场范畴的模式间关联。**\n- 对于一个可分离的哈密顿量，如果初始状态是一个乘积态，那么 TDSE 的精确解在任何时候都保持为乘积态：$\\lvert \\Psi(t)\\rangle = \\prod_\\kappa e^{-i\\hat{h}^{(\\kappa)}t} \\lvert \\psi_\\kappa(0)\\rangle$。TDH ($n_\\kappa=1$) 拟设能够表示这种精确解的形式。因此，在这种特定情况下，它提供了精确的动力学。这是正确的。\n- 对于一个不可分离的哈密顿量，耦合项通常会产生纠缠，这意味着真实的波函数不再是一个简单的乘积态。TDH 近似由于其自身结构，被限制为单一的哈特里积，无法表示这种纠缠。因此，误差恰恰是由于忽略了这种关联。这是正确的。\n**结论：正确。**\n\n**E. 通过将几个物理坐标组合成一个单一的组合模式，即使在 $n_\\kappa=1$ 的情况下，也可以表示该组合内部的关联，但在该极限下，不同组合之间的关联仍然被排除。**\n- 这描述了模式组合技术。假设一个逻辑模式 $\\kappa$ 由几个物理坐标 $\\{q_1, q_2, \\dots\\}$ 组成。该模式对应的 SPF $\\lvert \\varphi_1^{(\\kappa)}\\rangle$ 是所有这些坐标的函数，即 $\\varphi_1^{(\\kappa)}(q_1, q_2, \\dots, t)$。这样一个多维函数可以表示这些组合坐标的希尔伯特空间中的任意状态，包括 $q_1, q_2, \\dots$ 之间高度关联（纠缠）的状态。这部分陈述是正确的。\n- 然而，如果总波函数是以所有这些组合模式（组）的 $n_\\kappa=1$ 构建的，它将是每个组的 SPF 的乘积：$\\lvert \\Psi(t) \\rangle = \\lvert \\varphi_1^{(1)}(t) \\rangle \\otimes \\lvert \\varphi_1^{(2)}(t) \\rangle \\otimes \\dots$。这种状态在不同组 *之间* 没有关联。这部分陈述也是正确的。\n**结论：正确。**", "answer": "$$\\boxed{ACDE}$$", "id": "2818034"}, {"introduction": "在进行MCTDH计算时，一个关键的实践问题是如何确定单粒子函数（SPF）基组的大小是否足够，以保证模拟结果的可靠性。本练习引入了“自然布居数”这一关键概念，它为我们提供了一个严格的、后验的诊断工具 [@problem_id:2818016]。通过分析自然布居数，研究人员可以评估基组的完备性，并对截断误差进行量化，从而确保计算的收敛性和准确性。", "problem": "考虑一个 $f$ 模系统的纯态 $|\\Psi(t)\\rangle$，其希尔伯特空间为 $\\mathcal{H}=\\bigotimes_{\\kappa=1}^{f}\\mathcal{H}^{(\\kappa)}$，该纯态在多组态时间依赖哈特里（Multi-Configuration Time-Dependent Hartree, MCTDH）框架内进行演化。在 MCTDH 中，我们将 $|\\Psi(t)\\rangle$ 在一个依赖于时间的乘积基上展开，该基由每个模式 $\\kappa$ 的一组单粒子函数（single-particle functions, SPF）$\\{|\\varphi_{i}^{(\\kappa)}(t)\\rangle\\}_{i=1}^{n_{\\kappa}}$ 和依赖于时间的组态系数构成。运动方程通过 Dirac–Frenkel 时间依赖变分原理（Time-Dependent Variational Principle, TDVP）得到，并且 SPF 的规范被限制在每个模式内部的酉旋转。对于任意模式 $\\kappa$，定义约化密度算符为作用在 $\\mathcal{H}^{(\\kappa)}$ 上的偏迹 $\\hat{\\rho}^{(\\kappa)}(t)=\\operatorname{Tr}_{\\neq \\kappa}\\left(|\\Psi(t)\\rangle\\langle\\Psi(t)|\\right)$。$\\hat{\\rho}^{(\\kappa)}(t)$ 的本征值被称为模式 $\\kappa$ 的自然布居数。\n\n您需要从二分纯态的第一性原理以及约化密度算符的性质出发进行推理，除了归一化和正定性之外，不假设任何特殊结构。基于这些原理，评估以下关于自然布居数及其在 MCTDH 中作为 SPF 截断的后验误差指标的用途的陈述。选择所有正确的陈述。\n\nA. 自然布居数 $\\{n_{\\alpha}^{(\\kappa)}(t)\\}$ 是 $|\\Psi(t)\\rangle$ 对于二分划分 $\\mathcal{H}^{(\\kappa)}\\otimes\\mathcal{H}^{(\\neq \\kappa)}$ 的施密特系数的平方。如果将模式 $\\kappa$ 的 SPF 空间截断到由具有 $m_{\\kappa}$ 个最大布居数的 $\\hat{\\rho}^{(\\kappa)}$ 本征矢量所张成的 $m_{\\kappa}$ 维子空间，那么在所有可能的 $m_{\\kappa}$ 维 SPF 子空间中，此选择可最小化截断误差的 2-范数，并且被舍弃分量的范数平方等于 $\\sum_{\\alpha>m_{\\kappa}} n_{\\alpha}^{(\\kappa)}(t)$。因此，累积的被舍弃布居数为截断误差提供了一个后验上界。这种构造和界限在 SPF 的酉旋转下是不变的。\n\nB. 自然布居数依赖于为模式 $\\kappa$ 的 SPF 选择的特定规范（依赖于时间的酉旋转），因此除非通过外部约定固定规范，否则不能作为一个定义明确的后验指标。\n\nC. 对于一个归一化的 $|\\Psi(t)\\rangle$，$\\hat{\\rho}^{(\\kappa)}(t)$ 的迹等于 $n_{\\kappa}$，即用于模式 $\\kappa$ 的 SPF 数量。因此，增加 $n_{\\kappa}$ 保证了 $\\operatorname{Tr}\\hat{\\rho}^{(\\kappa)}(t)$ 趋近于 $n_{\\kappa}$，可作为直接的收敛性度量。\n\nD. 如果舍弃所有单个自然布居数低于阈值 $\\varepsilon>0$ 的 SPF，那么被舍弃分量的 2-范数总是至多为 $\\varepsilon$，而与被舍弃的 SPF 数量无关。", "solution": "该问题要求在多组态时间依赖哈特里（MCTDH）方法的背景下，评估几个关于自然布居数性质和效用的陈述。评估必须基于量子力学中关于二分纯态的第一性原理。\n\n我们首先建立这些原理。系统由希尔伯特空间 $\\mathcal{H}=\\bigotimes_{\\kappa=1}^{f}\\mathcal{H}^{(\\kappa)}$ 中的一个归一化纯态 $|\\Psi(t)\\rangle$（$\\langle\\Psi(t)|\\Psi(t)\\rangle=1$）来描述。对于任意给定的模式 $\\kappa$，我们可以将希尔伯特空间划分为一个二分结构 $\\mathcal{H} = \\mathcal{H}^{(\\kappa)} \\otimes \\mathcal{H}^{(\\neq \\kappa)}$，其中 $\\mathcal{H}^{(\\neq \\kappa)} = \\bigotimes_{j\\neq \\kappa} \\mathcal{H}^{(j)}$。\n\n根据施密特分解定理，这样一个二分空间中的任意纯态 $|\\Psi(t)\\rangle$ 都可以写成：\n$$ |\\Psi(t)\\rangle = \\sum_{\\alpha=1}^{r} \\sqrt{n_{\\alpha}^{(\\kappa)}(t)} |\\chi_{\\alpha}^{(\\kappa)}(t)\\rangle \\otimes |\\Phi_{\\alpha}^{(\\neq \\kappa)}(t)\\rangle $$\n这里，$\\{|\\chi_{\\alpha}^{(\\kappa)}(t)\\rangle\\}$ 和 $\\{|\\Phi_{\\alpha}^{(\\neq \\kappa)}(t)\\rangle\\}$ 分别是张成 $\\mathcal{H}^{(\\kappa)}$ 和 $\\mathcal{H}^{(\\neq \\kappa)}$ 子空间的两组标准正交向量（施密特向量）。系数 $\\sqrt{n_{\\alpha}^{(\\kappa)}(t)}$ 是施密特系数，它们是实数且非负。对于归一化态，它们满足 $\\sum_{\\alpha=1}^{r} n_{\\alpha}^{(\\kappa)}(t) = 1$。项数 $r$ 是施密特秩。\n\n模式 $\\kappa$ 的约化密度算符定义为 $\\hat{\\rho}^{(\\kappa)}(t) = \\operatorname{Tr}_{\\neq \\kappa}\\left(|\\Psi(t)\\rangle\\langle\\Psi(t)|\\right)$。将施密特分解代入此定义可得：\n$$ \\hat{\\rho}^{(\\kappa)}(t) = \\operatorname{Tr}_{\\neq \\kappa} \\left( \\sum_{\\alpha, \\beta} \\sqrt{n_{\\alpha}^{(\\kappa)} n_{\\beta}^{(\\kappa)}} |\\chi_{\\alpha}^{(\\kappa)}\\rangle\\langle\\chi_{\\beta}^{(\\kappa)}| \\otimes |\\Phi_{\\alpha}^{(\\neq \\kappa)}\\rangle\\langle\\Phi_{\\beta}^{(\\neq \\kappa)}| \\right) $$\n$$ \\hat{\\rho}^{(\\kappa)}(t) = \\sum_{\\alpha, \\beta} \\sqrt{n_{\\alpha}^{(\\kappa)} n_{\\beta}^{(\\kappa)}} |\\chi_{\\alpha}^{(\\kappa)}\\rangle\\langle\\chi_{\\beta}^{(\\kappa)}| \\operatorname{Tr}_{\\neq \\kappa}\\left( |\\Phi_{\\alpha}^{(\\neq \\kappa)}\\rangle\\langle\\Phi_{\\beta}^{(\\neq \\kappa)}| \\right) $$\n由于施密特向量的标准正交性，$\\operatorname{Tr}_{\\neq \\kappa}\\left( |\\Phi_{\\alpha}^{(\\neq \\kappa)}\\rangle\\langle\\Phi_{\\beta}^{(\\neq \\kappa)}| \\right) = \\langle\\Phi_{\\beta}^{(\\neq \\kappa)}|\\Phi_{\\alpha}^{(\\neq \\kappa)}\\rangle = \\delta_{\\alpha\\beta}$。这将约化密度算符的表达式简化为其谱分解形式：\n$$ \\hat{\\rho}^{(\\kappa)}(t) = \\sum_{\\alpha=1}^{r} n_{\\alpha}^{(\\kappa)}(t) |\\chi_{\\alpha}^{(\\kappa)}(t)\\rangle\\langle\\chi_{\\alpha}^{(\\kappa)}(t)| $$\n由此可见，$\\hat{\\rho}^{(\\kappa)}(t)$ 的本征值就是 $\\{n_{\\alpha}^{(\\kappa)}(t)\\}$，这正是问题中定义的自然布居数。相应的本征矢量 $\\{|\\chi_{\\alpha}^{(\\kappa)}(t)\\rangle\\}$ 是模式 $\\kappa$ 的施密特向量，也称为自然轨道或自然 SPF。\n\n用于基截断的一个关键性质是应用于张量的 Eckart-Young-Mirsky 定理的推论。该定理指出，对于 $|\\Psi(t)\\rangle$，通过一个仅使用模式 $\\kappa$ 的 $m_{\\kappa}$ 个基函数来表示的态对其进行最佳近似，是通过将 $|\\Psi(t)\\rangle$ 投影到由对应 $m_{\\kappa}$ 个最大自然布居数的 $m_{\\kappa}$ 个自然轨道 $\\{|\\chi_{\\alpha}^{(\\kappa)}(t)\\rangle\\}$ 所张成的子空间上得到的。设 $P_{m_{\\kappa}}$ 是到 $\\mathcal{H}^{(\\kappa)}$ 这个最优 $m_{\\kappa}$ 维子空间的投影算符。整个态的投影由算符 $\\mathcal{P}_{m_{\\kappa}} = P_{m_{\\kappa}} \\otimes \\mathbf{1}_{\\neq \\kappa}$ 完成。被舍弃的态分量是 $(\\mathbf{1} - \\mathcal{P}_{m_{\\kappa}})|\\Psi(t)\\rangle$。这个被舍弃分量的 2-范数平方为：\n$$ \\|(\\mathbf{1} - \\mathcal{P}_{m_{\\kappa}})|\\Psi(t)\\rangle\\|^2 = \\langle\\Psi(t)|(\\mathbf{1} - \\mathcal{P}_{m_{\\kappa}})|\\Psi(t)\\rangle = 1 - \\langle\\Psi(t)|\\mathcal{P}_{m_{\\kappa}}|\\Psi(t)\\rangle $$\n保留部分为 $\\langle\\Psi(t)|\\mathcal{P}_{m_{\\kappa}}|\\Psi(t)\\rangle = \\operatorname{Tr}(\\mathcal{P}_{m_{\\kappa}}|\\Psi(t)\\rangle\\langle\\Psi(t)|) = \\operatorname{Tr}_{\\kappa}(P_{m_{\\kappa}}\\hat{\\rho}^{(\\kappa)}) = \\sum_{\\alpha=1}^{m_{\\kappa}} n_{\\alpha}^{(\\kappa)}(t)$。\n因此，被舍弃分量的范数平方为 $1 - \\sum_{\\alpha=1}^{m_{\\kappa}} n_{\\alpha}^{(\\kappa)}(t) = \\sum_{\\alpha>m_{\\kappa}} n_{\\alpha}^{(\\kappa)}(t)$，即被忽略的自然布居数之和。\n\n最后，$\\hat{\\rho}^{(\\kappa)}(t)$ 的定义仅依赖于态 $|\\Psi(t)\\rangle$ 和子系统 $\\kappa$ 的选择。它不依赖于任何用于表示 $\\mathcal{H}^{(\\kappa)}$ 中向量的特定基。因此，它的本征值（自然布居数）和本征矢量（自然轨道）在 MCTDH ansatz 中使用的工作 SPF 基 $\\{|\\varphi_{i}^{(\\kappa)}(t)\\rangle\\}$ 的酉变换下是不变的。这种规范不变性是至关重要的。\n\n在建立了这些原理之后，我们来评估各个选项。\n\n**A.** 自然布居数 $\\{n_{\\alpha}^{(\\kappa)}(t)\\}$ 是 $|\\Psi(t)\\rangle$ 对于二分划分 $\\mathcal{H}^{(\\kappa)}\\otimes\\mathcal{H}^{(\\neq \\kappa)}$ 的施密特系数的平方。如果将模式 $\\kappa$ 的 SPF 空间截断到由具有 $m_{\\kappa}$ 个最大布居数的 $\\hat{\\rho}^{(\\kappa)}$ 本征矢量所张成的 $m_{\\kappa}$ 维子空间，那么在所有可能的 $m_{\\kappa}$ 维 SPF 子空间中，此选择可最小化截断误差的 2-范数，并且被舍弃分量的范数平方等于 $\\sum_{\\alpha>m_{\\kappa}} n_{\\alpha}^{(\\kappa)}(t)$。因此，累积的被舍弃布居数为截断误差提供了一个后验上界。这种构造和界限在 SPF 的酉旋转下是不变的。\n\n- 陈述“自然布居数是施密特系数的平方”是正确的，正如我们的推导所示，其中 $n_{\\alpha}^{(\\kappa)}$ 是施密特系数 $\\sqrt{n_{\\alpha}^{(\\kappa)}}$ 的平方。\n- 陈述“截断到对应于最大布居数的自然轨道基上可以最小化误差的 2-范数”是施密特近似定理的精髓，这是正确的。\n- 陈述“被舍弃分量的范数平方等于被舍弃布居数的总和 $\\sum_{\\alpha>m_{\\kappa}} n_{\\alpha}^{(\\kappa)}(t)$”也是正确的，如上所推导。\n- 陈述“该构造在工作 SPF 的酉旋转下是不变的”是正确的。\n- 最后的断言是，累积的被舍弃布居数 $\\delta = \\sum_{\\alpha>m_{\\kappa}} n_{\\alpha}^{(\\kappa)}(t)$ 为“截断误差”提供了一个“上界”。这种措辞并不精确。如果“截断误差”定义为被舍弃向量的 2-范数，其值为 $\\sqrt{\\delta}$。对于 $\\delta \\in (0, 1)$，我们有 $\\sqrt{\\delta} > \\delta$，所以 $\\delta$ 将是一个下界，而不是上界。然而，通常的做法是将“截断误差”解释为一个更广义的概念。例如，仅作用于模式 $\\kappa$ 的可观测量 $\\hat{O}^{(\\kappa)}$ 的期望值误差，其上界为 $\\delta \\cdot \\|\\hat{O}^{(\\kappa)}\\|_{\\infty}$，其中 $\\|\\cdot\\|_{\\infty}$ 是算符范数。如果我们考虑 $\\|\\hat{O}^{(\\kappa)}\\|_{\\infty} \\le 1$ 的可观测量，那么 $\\delta$ 确实是这个物理误差的一个上界。此外，精确态与最佳归一化近似态之间的不忠诚度（infidelity）$1-F$ 也与 $\\delta$ 相关。鉴于陈述的所有其他部分不仅正确，而且代表了使用自然布居数的核心理论依据，并且选项 B, C, D 都有根本性错误，这个陈述是唯一可行的选择。我们在物理上合理的解释下接受它，即“截断误差”指的是像不忠诚度或有界局域可观测量误差这样的量。\n\n结论：**正确**。\n\n**B.** 自然布居数依赖于为模式 $\\kappa$ 的 SPF 选择的特定规范（依赖于时间的酉旋转），因此除非通过外部约定固定规范，否则不能作为一个定义明确的后验指标。\n\n- 正如我们在初步分析中确立的，约化密度算符 $\\hat{\\rho}^{(\\kappa)}(t)$ 是通过对其他自由度求偏迹从态 $|\\Psi(t)\\rangle$ 内在地定义的。因此，它的本征值，即自然布居数，与模式 $\\kappa$ 中 SPF 的任何基选择或规范无关。这种规范不变性恰恰使其成为一个“定义明确”的指标。该陈述断言了相反的观点，因此是错误的。\n\n结论：**错误**。\n\n**C.** 对于一个归一化的 $|\\Psi(t)\\rangle$，$\\hat{\\rho}^{(\\kappa)}(t)$ 的迹等于 $n_{\\kappa}$，即用于模式 $\\kappa$ 的 SPF 数量。因此，增加 $n_{\\kappa}$ 保证了 $\\operatorname{Tr}\\hat{\\rho}^{(\\kappa)}(t)$ 趋近于 $n_{\\kappa}$，可作为直接的收敛性度量。\n\n- 任何密度算符的迹，包括从归一化纯态导出的约化密度算符，都必须等于 1。我们可以直接看出这一点：$\\operatorname{Tr}(\\hat{\\rho}^{(\\kappa)}(t)) = \\sum_{\\alpha} n_{\\alpha}^{(\\kappa)}(t)$。并且从态 $|\\Psi(t)\\rangle$ 的归一化可知，施密特系数的平方和为一，所以 $\\sum_{\\alpha} n_{\\alpha}^{(\\kappa)}(t) = 1$。陈述中说迹等于 $n_{\\kappa}$ 是根本错误的。$n_{\\kappa}$ 维 SPF 空间上的单位算符的迹是 $n_{\\kappa}$，但那不是约化密度算符。\n\n结论：**错误**。\n\n**D.** 如果舍弃所有单个自然布居数低于阈值 $\\varepsilon>0$ 的 SPF，那么被舍弃分量的 2-范数总是至多为 $\\varepsilon$，而与被舍弃的 SPF 数量无关。\n\n- 设 $I_{discard} = \\{\\alpha \\mid n_{\\alpha}^{(\\kappa)}(t) < \\varepsilon \\}$。被舍弃分量的 2-范数平方是相应布居数的总和：$\\delta = \\sum_{\\alpha \\in I_{discard}} n_{\\alpha}^{(\\kappa)}(t)$。该陈述声称 2-范数 $\\sqrt{\\delta}$ 至多为 $\\varepsilon$。这意味着 $\\delta \\le \\varepsilon^2$。\n- 这是错误的。考虑一个阈值为 $\\varepsilon = 0.1$ 的情况。如果有 $N=20$ 个自然轨道，每个的布居数都是 $n_{\\alpha}^{(\\kappa)} = 0.04$，那么它们都低于该阈值。这些被舍弃布居数的总和是 $\\delta = 20 \\times 0.04 = 0.8$。该陈述要求 $\\sqrt{0.8} \\le 0.1$，这是错误的（$0.894... \\not\\le 0.1$）。被舍弃的总布居数可以远大于 $\\varepsilon$ 或 $\\varepsilon^2$；它仅受 1 的限制。\n\n结论：**错误**。", "answer": "$$\\boxed{A}$$", "id": "2818016"}]}