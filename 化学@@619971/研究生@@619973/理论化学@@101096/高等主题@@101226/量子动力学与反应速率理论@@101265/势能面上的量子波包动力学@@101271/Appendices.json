{"hands_on_practices": [{"introduction": "在我们深入研究复杂波包的运动之前，理解最简单的情形至关重要：一个定态的时间演化。这个基础练习 [@problem_id:2799407] 要求您证明，对于一个不含时哈密顿量，其能量本征态的空间概率密度不随时间改变。通过推导其含时相位因子，您将掌握任意波包动力学的基础构建单元，因为任何波包都可看作是这些定态的叠加。", "problem": "在玻恩–奥本海默近似下，对于一个投影到其最小值附近的单个绝热势能面上的双原子分子，沿着核间距坐标 $R$ 的核运动可以建模为一个质量为 $M$ 的量子粒子在谐振子势 $V(R)=\\frac{1}{2}M\\omega^{2}R^{2}$ 中的运动。考虑核波函数 $\\psi(R,t)$ 所满足的含时薛定谔方程 (TDSE)，其哈密顿量为不含时的 $\\hat{H}=-\\frac{\\hbar^{2}}{2M}\\frac{\\partial^{2}}{\\partial R^{2}}+\\frac{1}{2}M\\omega^{2}R^{2}$。在 $t=0$ 时刻，核波包被精确地制备在哈密顿量 $\\hat{H}$ 的谐振子基态上。\n\n仅从含时薛定谔方程以及不含时哈密顿量的能量本征态的定义出发，推导为何波包 $\\psi(R,t)$ 除了一个全局相位之外是定态的。然后，仅使用基本常数和符号，计算该全局相位因子的以 $\\omega$ 和 $t$ 表示的显式闭合形式表达式。你的答案必须是该全局相位因子本身，以单一解析表达式的形式给出。不得包含归一化常数，也不得包含单位。由于最终结果为符号形式，因此不需要进行数值舍入。", "solution": "我们从不含时哈密顿量的含时薛定谔方程 (TDSE) 开始，\n$$\n\\mathrm{i}\\hbar\\,\\frac{\\partial}{\\partial t}\\,\\psi(R,t)=\\hat{H}\\,\\psi(R,t),\n$$\n其中\n$$\n\\hat{H}=-\\frac{\\hbar^{2}}{2M}\\frac{\\partial^{2}}{\\partial R^{2}}+\\frac{1}{2}M\\omega^{2}R^{2}.\n$$\n对于任何不含时的哈密顿量 $\\hat{H}$，其能量本征态 $\\{\\phi_{n}(R)\\}$ 满足不含时薛定谔方程\n$$\n\\hat{H}\\,\\phi_{n}(R)=E_{n}\\,\\phi_{n}(R),\n$$\n其中 $E_{n}$ 为实数本征值。如果初始状态是单个本征态 $\\psi(R,0)=\\phi_{n}(R)$，我们可以寻求含时薛定谔方程的可分离变量形式的解\n$$\n\\psi(R,t)=c_{n}(t)\\,\\phi_{n}(R).\n$$\n将此拟设代入含时薛定谔方程，并使用 $\\hat{H}\\,\\phi_{n}=E_{n}\\phi_{n}$，可得\n$$\n\\mathrm{i}\\hbar\\,\\dot{c}_{n}(t)\\,\\phi_{n}(R)=c_{n}(t)\\,E_{n}\\,\\phi_{n}(R),\n$$\n在消去 $\\phi_{n}(R)$（对于本征函数是非零的）之后，该方程简化为常微分方程\n$$\n\\mathrm{i}\\hbar\\,\\dot{c}_{n}(t)=E_{n}\\,c_{n}(t).\n$$\n该方程可立即积分得到\n$$\nc_{n}(t)=\\exp\\!\\left(-\\frac{\\mathrm{i}E_{n}t}{\\hbar}\\right)c_{n}(0).\n$$\n施加初始条件 $c_{n}(0)=1$ 以匹配 $\\psi(R,0)=\\phi_{n}(R)$，得到\n$$\n\\psi(R,t)=\\phi_{n}(R)\\,\\exp\\!\\left(-\\frac{\\mathrm{i}E_{n}t}{\\hbar}\\right).\n$$\n因此，概率密度 $|\\psi(R,t)|^{2}=|\\phi_{n}(R)|^{2}$ 不随时间变化，该状态除了一个全局相位因子 $\\exp(-\\mathrm{i}E_{n}t/\\hbar)$ 之外是定态的。\n\n剩下需要确定谐振子基态的 $E_{n}$。对于质量为 $M$、频率为 $\\omega$ 的量子谐振子，其能谱是经过充分验证的结果\n$$\nE_{n}=\\hbar\\omega\\left(n+\\frac{1}{2}\\right),\\quad n=0,1,2,\\dots\n$$\n特别地，基态能量为\n$$\nE_{0}=\\frac{1}{2}\\hbar\\omega.\n$$\n因此，对于制备为 $\\psi(R,0)=\\phi_{0}(R)$ 的初态，其时间演化为\n$$\n\\psi(R,t)=\\phi_{0}(R)\\,\\exp\\!\\left(-\\frac{\\mathrm{i}}{\\hbar}\\,\\frac{1}{2}\\hbar\\omega\\,t\\right)\n=\\phi_{0}(R)\\,\\exp\\!\\left(-\\frac{\\mathrm{i}\\omega t}{2}\\right).\n$$\n因此，该波包是定态的，仅相差一个全局相位因子，即：\n$$\n\\exp\\!\\left(-\\frac{\\mathrm{i}\\omega t}{2}\\right).\n$$\n该因子是无量纲的，并且仅依赖于 $\\omega$ 和 $t$。", "answer": "$$\\boxed{\\exp\\!\\left(-\\frac{\\mathrm{i}\\,\\omega\\,t}{2}\\right)}$$", "id": "2799407"}, {"introduction": "大多数真实的分子过程，如光化学反应，都涉及多个电子态的相互作用。这个实践 [@problem_id:2799435] 将引导您完成一个关键的变换：从一个方便但存在耦合的“非绝热”(diabatic) 表象，转换到物理上更直观的“绝热”(adiabatic) 表象，后者给出了我们通常所见的势能面。通过推导这些绝热势能面以及非绝热导数耦合，您将揭示控制锥形交叉点附近跃迁与动力学的数学机制。", "problem": "考虑一个质量为 $M$ 的一维核坐标 $Q$，通过线性振动耦合与两个非绝热电子态耦合。振动-电子哈密顿量为\n$$\n\\hat{H} \\;=\\; \\hat{T}_n \\otimes \\mathbf{1}_2 \\;+\\; \\hat{H}_d(Q),\n$$\n其中核动能算符为 $\\hat{T}_n \\,=\\, -\\dfrac{\\hbar^2}{2M}\\dfrac{\\partial^2}{\\partial Q^2}$，$\\mathbf{1}_2$ 是 $2\\times 2$ 单位矩阵，非绝热电子哈密顿量为\n$$\n\\hat{H}_d(Q) \\;=\\; \\begin{pmatrix}\nV_0 + \\kappa Q & \\lambda \\\\\n\\lambda & V_0 - \\kappa Q\n\\end{pmatrix},\n$$\n其中 $V_0$、$\\kappa$ 和 $\\lambda$ 为实常数。非绝热基矢被视为与 $Q$ 无关且是实的。\n\n仅使用耦合电子-原子核运动的绝热表象的基本原理（例如，固定 $Q$ 时的参数化电子问题以及依赖于 $Q$ 的基旋转对核动能的影响），执行一个依赖于 $Q$ 的实正交变换，在每个 $Q$ 值上对角化电子哈密顿量，以定义绝热电子态 $\\{|\\phi_+(Q)\\rangle, |\\phi_-(Q)\\rangle\\}$ 及其绝热势能面 $E_{\\pm}(Q)$。采用如下的相和排序约定\n$$\n\\begin{pmatrix}\n|\\phi_+(Q)\\rangle \\\\\n|\\phi_-(Q)\\rangle\n\\end{pmatrix}\n\\;=\\;\n\\begin{pmatrix}\n\\cos\\theta(Q) & \\sin\\theta(Q) \\\\\n-\\sin\\theta(Q) & \\cos\\theta(Q)\n\\end{pmatrix}\n\\begin{pmatrix}\n|\\chi_1\\rangle \\\\\n|\\chi_2\\rangle\n\\end{pmatrix},\n$$\n其中 $\\{|\\chi_1\\rangle, |\\chi_2\\rangle\\}$ 是非绝热基。\n\n推导：\n1) 绝热势能面 $E_{\\pm}(Q)$。\n2) 实现对角化的混合角 $\\theta(Q)$。\n3) 绝热态之间的标量非绝热导数耦合，定义为\n$$\n\\tau_{12}(Q) \\;=\\; \\big\\langle \\phi_-(Q) \\big| \\dfrac{\\partial}{\\partial Q} \\big| \\phi_+(Q) \\big\\rangle.\n$$\n\n从以上定义和电子哈密顿量在绝热基中必须是对角化的要求出发，展示所有步骤。作为最终答案，仅用 $\\kappa$、$\\lambda$ 和 $Q$ 报告 $\\tau_{12}(Q)$ 的闭合形式解析表达式。最终答案中不要包含数值或单位。", "solution": "所述问题在科学上是合理的、自洽的且表述清晰。它代表了分子系统中非绝热跃迁理论中的一个标准和基础练习，特别是线性振动耦合模型。所有必要的信息都已提供，目标也已明确定义。因此，我们开始推导。\n\n问题的核心是依赖于 $Q$ 的非绝热电子哈密顿量 $\\hat{H}_d(Q)$ 的对角化。绝热势能面 $E_{\\pm}(Q)$ 是该矩阵的本征值，绝热电子态 $\\{|\\phi_{\\pm}(Q)\\rangle\\}$ 是相应的本征矢量。\n\n非绝热电子哈密顿量由下式给出：\n$$\n\\hat{H}_d(Q) \\;=\\; \\begin{pmatrix}\nV_0 + \\kappa Q & \\lambda \\\\\n\\lambda & V_0 - \\kappa Q\n\\end{pmatrix}\n$$\n\n1) 绝热势能面 $E_{\\pm}(Q)$ 的推导。\n\n通过求解特征方程 $\\det(\\hat{H}_d(Q) - E\\mathbf{1}_2) = 0$ 来求得本征值 $E$。\n$$\n\\det \\begin{pmatrix} V_0 + \\kappa Q - E & \\lambda \\\\ \\lambda & V_0 - \\kappa Q - E \\end{pmatrix} \\;=\\; 0\n$$\n$$\n(V_0 + \\kappa Q - E)(V_0 - \\kappa Q - E) - \\lambda^2 \\;=\\; 0\n$$\n这可以重排为：\n$$\n((V_0 - E) + \\kappa Q)((V_0 - E) - \\kappa Q) - \\lambda^2 \\;=\\; 0\n$$\n$$\n(V_0 - E)^2 - (\\kappa Q)^2 - \\lambda^2 \\;=\\; 0\n$$\n$$\n(V_0 - E)^2 \\;=\\; \\kappa^2 Q^2 + \\lambda^2\n$$\n两边取平方根可得：\n$$\nV_0 - E \\;=\\; \\pm \\sqrt{\\kappa^2 Q^2 + \\lambda^2}\n$$\n求解 $E$ 得到两个本征值，即绝热势能面。根据 $E_+ > E_-$ 的约定，我们确定：\n$$\nE_+(Q) \\;=\\; V_0 + \\sqrt{\\kappa^2 Q^2 + \\lambda^2}\n$$\n$$\nE_-(Q) \\;=\\; V_0 - \\sqrt{\\kappa^2 Q^2 + \\lambda^2}\n$$\n\n2) 混合角 $\\theta(Q)$ 的推导。\n\n绝热态 $\\{|\\phi_+(Q)\\rangle, |\\phi_-(Q)\\rangle\\}$ 通过所提供的实正交变换与非绝热基 $\\{|\\chi_1\\rangle, |\\chi_2\\rangle\\}$ 相关联：\n$$\n\\mathbf{U}(Q) = \\begin{pmatrix} \\cos\\theta(Q) & \\sin\\theta(Q) \\\\ -\\sin\\theta(Q) & \\cos\\theta(Q) \\end{pmatrix}\n$$\n该变换对角化 $\\hat{H}_d(Q)$：\n$$\n\\hat{H}_a(Q) = \\mathbf{U}(Q) \\hat{H}_d(Q) \\mathbf{U}^T(Q) = \\begin{pmatrix} E_+(Q) & 0 \\\\ 0 & E_-(Q) \\end{pmatrix}\n$$\n变换后的哈密顿量 $\\hat{H}_a(Q)$ 的非对角元为零的条件决定了混合角 $\\theta(Q)$。让我们计算 $\\hat{H}_a(Q)$ 的 $(2,1)$ 元，即 $\\langle \\phi_-(Q) | \\hat{H}_d(Q) | \\phi_+(Q) \\rangle$。\n$$\n(\\hat{H}_a)_{21} \\;=\\; \\begin{pmatrix} -\\sin\\theta & \\cos\\theta \\end{pmatrix} \\begin{pmatrix} V_0 + \\kappa Q & \\lambda \\\\ \\lambda & V_0 - \\kappa Q \\end{pmatrix} \\begin{pmatrix} \\cos\\theta \\\\ \\sin\\theta \\end{pmatrix} \\;=\\; 0\n$$\n$$\n\\begin{pmatrix} -\\sin\\theta & \\cos\\theta \\end{pmatrix} \\begin{pmatrix} (V_0 + \\kappa Q)\\cos\\theta + \\lambda\\sin\\theta \\\\ \\lambda\\cos\\theta + (V_0 - \\kappa Q)\\sin\\theta \\end{pmatrix} \\;=\\; 0\n$$\n$$\n-\\sin\\theta((V_0 + \\kappa Q)\\cos\\theta + \\lambda\\sin\\theta) + \\cos\\theta(\\lambda\\cos\\theta + (V_0 - \\kappa Q)\\sin\\theta) \\;=\\; 0\n$$\n展开并合并同类项：\n$$\n(-V_0\\sin\\theta\\cos\\theta - \\kappa Q\\sin\\theta\\cos\\theta - \\lambda\\sin^2\\theta) + (\\lambda\\cos^2\\theta + V_0\\sin\\theta\\cos\\theta - \\kappa Q\\sin\\theta\\cos\\theta) \\;=\\; 0\n$$\n$$\n\\lambda(\\cos^2\\theta - \\sin^2\\theta) - 2\\kappa Q\\sin\\theta\\cos\\theta \\;=\\; 0\n$$\n使用二倍角三角恒等式 $\\cos(2\\theta) = \\cos^2\\theta - \\sin^2\\theta$ 和 $\\sin(2\\theta) = 2\\sin\\theta\\cos\\theta$，我们得到：\n$$\n\\lambda\\cos(2\\theta) - \\kappa Q\\sin(2\\theta) \\;=\\; 0\n$$\n这就给出了混合角的直接关系：\n$$\n\\tan(2\\theta(Q)) \\;=\\; \\frac{\\lambda}{\\kappa Q}\n$$\n由此，混合角明确为：\n$$\n\\theta(Q) \\;=\\; \\frac{1}{2} \\arctan\\left(\\frac{\\lambda}{\\kappa Q}\\right)\n$$\n\n3) 非绝热导数耦合 $\\tau_{12}(Q)$ 的推导。\n\n标量非绝热导数耦合定义为：\n$$\n\\tau_{12}(Q) \\;=\\; \\big\\langle \\phi_-(Q) \\big| \\dfrac{\\partial}{\\partial Q} \\big| \\phi_+(Q) \\big\\rangle\n$$\n我们必须首先计算绝热态 $|\\phi_+(Q)\\rangle$ 对核坐标 $Q$ 的导数。根据给定的变换：\n$$\n|\\phi_+(Q)\\rangle \\;=\\; \\cos\\theta(Q)|\\chi_1\\rangle + \\sin\\theta(Q)|\\chi_2\\rangle\n$$\n由于非绝热基 $\\{|\\chi_i\\rangle\\}$ 与 $Q$ 无关，导数仅作用于系数：\n$$\n\\frac{\\partial}{\\partial Q} |\\phi_+(Q)\\rangle \\;=\\; \\frac{\\partial}{\\partial Q}(\\cos\\theta(Q))|\\chi_1\\rangle + \\frac{\\partial}{\\partial Q}(\\sin\\theta(Q))|\\chi_2\\rangle\n$$\n$$\n\\frac{\\partial}{\\partial Q} |\\phi_+(Q)\\rangle \\;=\\; \\left(-\\sin\\theta(Q) \\frac{d\\theta}{dQ}\\right)|\\chi_1\\rangle + \\left(\\cos\\theta(Q) \\frac{d\\theta}{dQ}\\right)|\\chi_2\\rangle\n$$\n将标量导数 $\\frac{d\\theta}{dQ}$ 因子提出来：\n$$\n\\frac{\\partial}{\\partial Q} |\\phi_+(Q)\\rangle \\;=\\; \\frac{d\\theta}{dQ} \\left(-\\sin\\theta(Q)|\\chi_1\\rangle + \\cos\\theta(Q)|\\chi_2\\rangle\\right)\n$$\n我们认出括号中的表达式是态 $|\\phi_-(Q)\\rangle$ 的定义：\n$$\n|\\phi_-(Q)\\rangle \\;=\\; -\\sin\\theta(Q)|\\chi_1\\rangle + \\cos\\theta(Q)|\\chi_2\\rangle\n$$\n因此，对于该系统和相约定，我们有以下简单而普遍的关系：\n$$\n\\frac{\\partial}{\\partial Q} |\\phi_+(Q)\\rangle \\;=\\; \\frac{d\\theta}{dQ} |\\phi_-(Q)\\rangle\n$$\n将此代入 $\\tau_{12}(Q)$ 的定义中：\n$$\n\\tau_{12}(Q) \\;=\\; \\left\\langle \\phi_-(Q) \\left| \\left(\\frac{d\\theta}{dQ} |\\phi_-(Q)\\rangle\\right) \\right.\\right\\rangle \\;=\\; \\frac{d\\theta}{dQ} \\langle \\phi_-(Q) | \\phi_-(Q) \\rangle\n$$\n由于绝热态是正交归一的，$\\langle \\phi_-(Q) | \\phi_-(Q) \\rangle = 1$。因此，我们发现非绝热耦合与混合角的导数相同：\n$$\n\\tau_{12}(Q) \\;=\\; \\frac{d\\theta}{dQ}\n$$\n现在我们使用 $\\theta(Q)$ 的表达式来计算这个导数：\n$$\n\\tau_{12}(Q) \\;=\\; \\frac{d}{dQ} \\left[ \\frac{1}{2} \\arctan\\left(\\frac{\\lambda}{\\kappa Q}\\right) \\right]\n$$\n使用链式法则以及 $\\frac{d}{dx}(\\arctan(x)) = \\frac{1}{1+x^2}$ 这一事实：\n$$\n\\tau_{12}(Q) \\;=\\; \\frac{1}{2} \\cdot \\frac{1}{1 + \\left(\\frac{\\lambda}{\\kappa Q}\\right)^2} \\cdot \\frac{d}{dQ}\\left(\\frac{\\lambda}{\\kappa Q}\\right)\n$$\n自变量的导数是：\n$$\n\\frac{d}{dQ}\\left(\\frac{\\lambda}{\\kappa Q}\\right) \\;=\\; \\frac{\\lambda}{\\kappa} \\frac{d}{dQ}(Q^{-1}) \\;=\\; \\frac{\\lambda}{\\kappa}(-1)Q^{-2} \\;=\\; -\\frac{\\lambda}{\\kappa Q^2}\n$$\n将其代回：\n$$\n\\tau_{12}(Q) \\;=\\; \\frac{1}{2} \\cdot \\frac{1}{1 + \\frac{\\lambda^2}{\\kappa^2 Q^2}} \\cdot \\left(-\\frac{\\lambda}{\\kappa Q^2}\\right)\n$$\n简化第一个分数：\n$$\n\\tau_{12}(Q) \\;=\\; \\frac{1}{2} \\cdot \\frac{\\kappa^2 Q^2}{\\kappa^2 Q^2 + \\lambda^2} \\cdot \\left(-\\frac{\\lambda}{\\kappa Q^2}\\right)\n$$\n消去项（$\\kappa$ 和 $Q^2$）：\n$$\n\\tau_{12}(Q) \\;=\\; \\frac{1}{2} \\cdot \\frac{\\kappa}{\\kappa^2 Q^2 + \\lambda^2} \\cdot (-\\lambda)\n$$\n这就给出了非绝热导数耦合的最终闭合形式表达式：\n$$\n\\tau_{12}(Q) \\;=\\; -\\frac{\\kappa \\lambda}{2(\\kappa^2 Q^2 + \\lambda^2)}\n$$", "answer": "$$ \\boxed{-\\frac{\\kappa \\lambda}{2(\\kappa^{2} Q^{2} + \\lambda^{2})}} $$", "id": "2799435"}, {"introduction": "最后的这项实践将通过一个完整的数值模拟，把理论赋予生命。您将编写程序，模拟一个二维波包在具有两个振动模式耦合的势能面上演化 [@problem_id:2799404]。这个计算实验将使您能够直接测量并量化重要的物理现象，例如分子内振动能量重布 (intramolecular vibrational energy redistribution, IVR) 和量子纠缠的增长，从而架起从抽象方程到可观测化学动力学之间的桥梁。", "problem": "设计并实现一个完整的、自包含的程序，该程序使用原子单位（其中约化普朗克常数和质量均设为1）模拟两个耦合振动模式在二维势能面上的量子波包动力学。目标是为一组参数化的测试案例，量化在幺正演化过程中的模式间能量流动和纠缠产生。\n\n从含时薛定谔方程出发，其在原子单位下写作 $i \\,\\partial_t \\Psi(x_1,x_2,t) = \\hat{H}\\,\\Psi(x_1,x_2,t)$，哈密顿量为 $\\hat{H} = \\hat{T}_1 + \\hat{T}_2 + \\hat{V}(x_1,x_2)$，其中 $\\hat{T}_j = -\\tfrac{1}{2}\\,\\partial^2/\\partial x_j^2$（对于 $j \\in \\{1,2\\}$），势能面为\n$$\nV(x_1,x_2) = \\tfrac{1}{2}\\,\\omega_1^2\\,x_1^2 + \\tfrac{1}{2}\\,\\omega_2^2\\,x_2^2 + g\\,x_1^2\\,x_2^2,\n$$\n其中 $\\omega_1$ 和 $\\omega_2$ 是谐振频率，g 是非谐耦合常数。使用基于 Trotter 分解的分裂算符方法来近似短时传播子，并使用快速傅里叶变换（FFT）在动量空间中实现动能演化。\n\n初始态。准备一个可分离的初始波包，它是裸谐振部分的位移谐振子基态（类相干态高斯函数）的乘积，并可带有初始动量：\n$$\n\\Psi(x_1,x_2,0) = \\phi_0^{(\\omega_1)}(x_1 - x_{10})\\, e^{i p_{10} x_1} \\;\\times\\; \\phi_0^{(\\omega_2)}(x_2 - x_{20})\\, e^{i p_{20} x_2},\n$$\n其中一维谐振子基态为\n$$\n\\phi_0^{(\\omega)}(x) = \\left(\\tfrac{\\omega}{\\pi}\\right)^{1/4} \\exp\\!\\left(-\\tfrac{\\omega}{2}\\,x^2\\right).\n$$\n将 $\\Psi(x_1,x_2,0)$ 归一化，使得 $\\iint |\\Psi|^2\\,dx_1\\,dx_2 = 1$。\n\n离散化。在每个坐标上使用大小为 $N \\times N$ 的均匀方形网格，其中 $N=64$，定义域为 $x_j \\in [-L,L)$ 且 $L=8$，因此网格间距为 $\\Delta x = 2L/N$。使用由 $p = 2\\pi\\,\\mathrm{fftfreq}(N,\\Delta x)$（以原子单位计）给出的相应共轭动量网格。使用恒定的时间步长 $\\Delta t = 0.005$ 进行时间传播，直至最终时间 $t_{\\mathrm{final}}$，采用二阶分裂算符格式：\n$$\ne^{-i \\hat{H} \\Delta t} \\approx e^{-i \\hat{V}\\, \\Delta t/2}\\, e^{-i (\\hat{T}_1+\\hat{T}_2)\\, \\Delta t}\\, e^{-i \\hat{V}\\, \\Delta t/2}.\n$$\n\n为每个测试案例计算的可观测量：\n1. 模式1裸能量变化。将模式1的裸哈密顿量定义为 $\\hat{H}_1^{\\mathrm{bare}} = \\hat{T}_1 + \\tfrac{1}{2}\\omega_1^2 x_1^2$。计算在 $t=0$ 和在 $t=t_{\\mathrm{final}}$ 时的期望值：\n$$\nE_1^{\\mathrm{bare}}(t) = \\langle \\Psi(t) | \\hat{T}_1 + \\tfrac{1}{2}\\omega_1^2 x_1^2 | \\Psi(t) \\rangle.\n$$\n使用恒等式 $\\langle \\Psi | \\hat{T}_1 | \\Psi \\rangle = \\tfrac{1}{2}\\iint |\\partial \\Psi/\\partial x_1|^2\\,dx_1\\,dx_2$ 通过网格上的有限差分来评估动能贡献，并通过求积法评估势能贡献。以原子单位的实数形式报告变化量 $\\Delta E_1 = E_1^{\\mathrm{bare}}(t_{\\mathrm{final}}) - E_1^{\\mathrm{bare}}(0)$。\n\n2. 最终时刻的二分纠缠熵。将这两个模式视为处于纯态 $\\Psi(t_{\\mathrm{final}})$ 的子系统 A 和 B。计算模式 A（模式1）的约化密度矩阵的 von Neumann 熵，\n$$\nS = -\\mathrm{Tr}\\left[\\rho_A \\log \\rho_A\\right], \\quad \\rho_A = \\mathrm{Tr}_B \\left[|\\Psi\\rangle\\langle\\Psi|\\right],\n$$\n其中迹是针对模式2求的。在离散表示中，构建矩阵 $M$，其元素为 $M_{ij} = \\Psi(x_{1,i}, x_{2,j}; t_{\\mathrm{final}}) \\sqrt{\\Delta x\\,\\Delta x}$，使得 $\\sum_{ij} |M_{ij}|^2 = 1$，并计算其奇异值 $\\{s_k\\}$；$\\rho_A$ 的特征值为 $\\lambda_k = s_k^2$，熵为 $S = -\\sum_k \\lambda_k \\log \\lambda_k$。使用自然对数。以实数（无量纲）形式报告 $S$。\n\n数值细节和要求：\n- 全程使用原子单位（无量纲），在此体系中所有量均为无单位量。\n- 对 $\\partial \\Psi/\\partial x_1$ 使用中心有限差分，FFT网格隐含了周期性索引。\n- 通过在初始化后重新归一化波函数来保持归一性；分裂算符格式应能高精度地保持范数，但您可以在测量可观测量之前在最后重新归一化，以减轻累积的数值误差。\n- 时间积分使用固定的 $\\Delta t = 0.005$，步数为 $N_t = \\lfloor t_{\\mathrm{final}}/\\Delta t \\rfloor$。\n\n测试套件。为以下三种情况运行模拟：\n- 情况1（弱非谐耦合，简并模式）：$(\\omega_1,\\omega_2,g,x_{10},x_{20},p_{10},p_{20},t_{\\mathrm{final}}) = (1.0,\\,1.0,\\,0.02,\\,1.5,\\,0.0,\\,0.0,\\,0.0,\\,3.0)$。\n- 情况2（较强耦合，轻微失谐）：$(\\omega_1,\\omega_2,g,x_{10},x_{20},p_{10},p_{20},t_{\\mathrm{final}}) = (1.0,\\,1.2,\\,0.10,\\,1.5,\\,0.0,\\,0.0,\\,0.0,\\,3.0)$。\n- 情况3（无耦合，对照组）：$(\\omega_1,\\omega_2,g,x_{10},x_{20},p_{10},p_{20},t_{\\mathrm{final}}) = (1.0,\\,1.0,\\,0.00,\\,1.5,\\,0.0,\\,0.0,\\,0.0,\\,3.0)$。\n\n答案规格和输出格式：\n- 对于每种情况，计算两个浮点数：最终时刻 $t_{\\mathrm{final}}$ 的纠缠熵 $S$ 和最终时刻 $t_{\\mathrm{final}}$ 的裸模式1能量变化 $\\Delta E_1$（以原子单位计）。\n- 程序必须输出一行，其中包含一个用方括号括起来的逗号分隔列表，每个值保留六位小数，顺序为 $[S_1,\\Delta E_{1,1},S_2,\\Delta E_{1,2},S_3,\\Delta E_{1,3}]$，分别对应情况1、2和3。", "solution": "所提出的问题是计算量子化学领域，特别是非绝热分子动力学领域中一个适定且标准的练习。它要求使用定义的初始条件和指定的数值算法，来模拟一个由含时薛定谔方程支配的二维量子系统。该问题具有科学依据，没有矛盾，并包含进行唯一且可验证的求解所需的所有信息。因此，我们将着手描述其形式解。\n\n问题的核心是在原子单位下（$\\hbar=1$，质量 $m_1=m_2=1$）求解含时薛定谔方程（TDSE）：\n$$\ni \\frac{\\partial}{\\partial t} \\Psi(x_1, x_2, t) = \\hat{H} \\Psi(x_1, x_2, t)\n$$\n哈密顿算符 $\\hat{H}$ 由动能和势能算符之和给出，$\\hat{H} = \\hat{T} + \\hat{V}$，其中动能部分为 $\\hat{T} = \\hat{T}_1 + \\hat{T}_2 = -\\frac{1}{2}\\frac{\\partial^2}{\\partial x_1^2} - \\frac{1}{2}\\frac{\\partial^2}{\\partial x_2^2}$，势能面为\n$$\nV(x_1, x_2) = \\frac{1}{2}\\omega_1^2 x_1^2 + \\frac{1}{2}\\omega_2^2 x_2^2 + g x_1^2 x_2^2\n$$\nTDSE 的形式解为 $\\Psi(t) = e^{-i\\hat{H}t} \\Psi(0)$。数值任务是为一个小的时步 $\\Delta t$ 近似时间演化算符 $e^{-i\\hat{H}\\Delta t}$ 的作用。\n\n**离散化与状态表示**\n连续波函数 $\\Psi(x_1, x_2, t)$ 在二维均匀网格上表示。空间域定义为 $x_j \\in [-L, L)$（对于 $j \\in \\{1, 2\\}$），其中 $L=8$，离散化为 $N=64$ 个点。因此，网格间距为 $\\Delta x = 2L/N$。网格点为 $x_{j,k} = -L + k\\Delta x$（对于 $k=0, 1, \\dots, N-1$）。波函数表示为一个 $N \\times N$ 的复数矩阵 $\\Psi_{k,l}(t) \\equiv \\Psi(x_{1,k}, x_{2,l}, t)$。\n\n相应的动量空间通过离散傅里叶变换进入。动量网格坐标由 $p_j = 2\\pi k_j$ 给出，其中 $k_j$ 是由 `fftfreq` 函数提供的空间频率：$k_j = \\mathrm{fftfreq}(N, \\Delta x)$。\n\n**初始态制备**\n$t=0$ 时的初始态是两个高斯波包的可分离乘积，每个模式一个：\n$$\n\\Psi(x_1, x_2, 0) = \\phi_0^{(\\omega_1)}(x_1 - x_{10}) e^{i p_{10} x_1} \\times \\phi_0^{(\\omega_2)}(x_2 - x_{20}) e^{i p_{20} x_2}\n$$\n其中 $\\phi_0^{(\\omega)}(x) = (\\frac{\\omega}{\\pi})^{1/4} \\exp(-\\frac{\\omega}{2}x^2)$ 是频率为 $\\omega$ 的谐振子的基态。该初始波函数在离散网格上构建，然后进行数值归一化，使得概率密度积分为1：$\\sum_{k,l} |\\Psi_{k,l}|^2 \\Delta x^2 = 1$。\n\n**时间演化：分裂算符傅里叶方法**\n动能和势能算符 $\\hat{T}$ 和 $\\hat{V}$ 不对易。因此，它们的和的指数使用 Trotter-Suzuki 分解来近似。指定的二阶分裂算符格式是：\n$$\ne^{-i\\hat{H}\\Delta t} \\approx e^{-i\\hat{V}\\frac{\\Delta t}{2}} e^{-i\\hat{T}\\Delta t} e^{-i\\hat{V}\\frac{\\Delta t}{2}}\n$$\n此格式是幺正的，并保持波函数的范数。从时间 $t$ 到 $t+\\Delta t$ 的传播通过以下三个连续步骤实现：\n1.  **半个势能步：** 将波函数与坐标空间中的势能相位因子相乘：$\\Psi'(x_1, x_2) = e^{-iV(x_1, x_2)\\frac{\\Delta t}{2}} \\Psi(x_1, x_2, t)$。\n2.  **一个完整的动能步：** 这一步在动能算符是对角化的动量空间中执行效率最高。\n    a. 使用二维快速傅里叶变换（FFT）将波函数变换到动量空间：$\\tilde{\\Psi}'(p_1, p_2) = \\mathcal{F}[\\Psi'(x_1,x_2)]$。\n    b. 在动量空间中，动能传播是一个简单的相位因子乘法：$\\tilde{\\Psi}''(p_1, p_2) = e^{-iT(p_1, p_2)\\Delta t} \\tilde{\\Psi}'(p_1, p_2)$，其中 $T(p_1, p_2) = \\frac{1}{2}(p_1^2+p_2^2)$。\n    c. 通过二维逆 FFT 将结果变换回坐标空间：$\\Psi''(x_1, x_2) = \\mathcal{F}^{-1}[\\tilde{\\Psi}''(p_1, p_2)]$。\n3.  **半个势能步：** 应用第二个半步的势能传播：$\\Psi(x_1, x_2, t+\\Delta t) = e^{-iV(x_1, x_2)\\frac{\\Delta t}{2}} \\Psi''(x_1, x_2)$。\n整个序列重复 $N_t = \\lfloor t_{\\mathrm{final}}/\\Delta t \\rfloor$ 个时间步，以达到最终时间 $t_{\\mathrm{final}}$。\n\n**可观测量的计算**\n时间演化后，我们从最终态 $\\Psi(t_{\\mathrm{final}})$ 计算所需的可观测量。\n\n1.  **模式1裸能量变化 ($\\Delta E_1$)**：\n    模式1的裸能量是算符 $\\hat{H}_1^{\\mathrm{bare}} = \\hat{T}_1 + \\frac{1}{2}\\omega_1^2 x_1^2$ 的期望值。\n    $$\n    E_1^{\\mathrm{bare}}(t) = \\langle \\Psi(t) | \\hat{H}_1^{\\mathrm{bare}} | \\Psi(t) \\rangle = \\langle \\hat{T}_1 \\rangle_t + \\langle \\frac{1}{2}\\omega_1^2 x_1^2 \\rangle_t\n    $$\n    势能部分通过网格求积法计算：\n    $$\n    \\langle \\frac{1}{2}\\omega_1^2 x_1^2 \\rangle_t \\approx \\sum_{k,l} |\\Psi_{k,l}(t)|^2 \\left(\\frac{1}{2}\\omega_1^2 x_{1,k}^2\\right) \\Delta x^2\n    $$\n    动能部分按照指定，使用恒等式 $\\langle \\hat{T}_1 \\rangle_t = \\frac{1}{2}\\iint |\\partial\\Psi/\\partial x_1|^2 dx_1 dx_2$ 计算。偏导数使用网格上的带有周期性边界条件的二阶中心有限差分格式来近似：\n    $$\n    \\left(\\frac{\\partial\\Psi}{\\partial x_1}\\right)_{k,l} \\approx \\frac{\\Psi_{k+1,l} - \\Psi_{k-1,l}}{2\\Delta x}\n    $$\n    然后通过网格求和计算动能：\n    $$\n    \\langle \\hat{T}_1 \\rangle_t \\approx \\frac{1}{2}\\sum_{k,l} \\left|\\frac{\\Psi_{k+1,l}(t) - \\Psi_{k-1,l}(t)}{2\\Delta x}\\right|^2 \\Delta x^2\n    $$\n    总变化量为 $\\Delta E_1 = E_1^{\\mathrm{bare}}(t_{\\mathrm{final}}) - E_1^{\\mathrm{bare}}(0)$。\n\n2.  **二分纠缠熵 ($S$)**：\n    两个模式之间的纠缠由一个子系统（例如模式1）的约化密度矩阵的 von Neumann 熵来量化。约化密度矩阵 $\\rho_A$ 是通过对模式2的自由度求偏迹获得的：$\\rho_A = \\mathrm{Tr}_B[|\\Psi\\rangle\\langle\\Psi|]$。\n    熵为 $S = -\\mathrm{Tr}[\\rho_A \\log \\rho_A]$。\n    在数值上，这可以通过奇异值分解（SVD）高效计算。归一化的离散波函数 $\\Psi_{k,l}$ 用于构建矩阵 $M_{k,l} = \\Psi_{k,l} \\Delta x$，使得 $\\mathrm{Tr}[M^\\dagger M]=1$。矩阵 $M$ 的奇异值 $\\{s_m\\}$ 是该二分系统的 Schmidt 系数。约化密度矩阵 $\\rho_A$ 的特征值由 $\\lambda_m = s_m^2$ 给出。熵则计算为：\n    $$\n    S = -\\sum_{m} \\lambda_m \\log \\lambda_m\n    $$\n    求和遍及所有非零特征值。对于一个可分离态（如 $g=0$ 的情况），只有一个奇异值非零（等于1），导致熵 $S=0$。对于一个纠缠态，多个奇异值非零，从而得到 $S>0$。\n\n该实现将这些原理结合到一个单独的程序中，该程序遍历所提供的测试案例，为每个案例执行模拟，计算可观测量，并按规定格式化输出。", "answer": "```python\nimport numpy as np\nfrom scipy import linalg\n# Note: Using numpy.fft which is the standard implementation.\n# The problem allows `numpy` and `scipy`.\n# `scipy.fft` is an alternative but `numpy.fft` is sufficient and canonical.\n\ndef solve():\n    \"\"\"\n    Main driver function to run simulations for all test cases and print results.\n    \"\"\"\n\n    # Grid and time-stepping parameters from the problem statement\n    N = 64\n    L = 8.0\n    DT = 0.005\n\n    # Test suite from the problem statement\n    test_cases = [\n        # (w1, w2, g, x10, x20, p10, p20, t_final)\n        (1.0, 1.0, 0.02, 1.5, 0.0, 0.0, 0.0, 3.0),  # Case 1\n        (1.0, 1.2, 0.10, 1.5, 0.0, 0.0, 0.0, 3.0),  # Case 2\n        (1.0, 1.0, 0.00, 1.5, 0.0, 0.0, 0.0, 3.0),  # Case 3\n    ]\n\n    # Set up computational grids\n    dx = 2 * L / N\n    x_coords = np.linspace(-L, L, N, endpoint=False)\n    p_coords = 2 * np.pi * np.fft.fftfreq(N, d=dx)\n\n    x1, x2 = np.meshgrid(x_coords, x_coords, indexing='ij')\n    p1, p2 = np.meshgrid(p_coords, p_coords, indexing='ij')\n\n    kinetic_energy_op_p = 0.5 * (p1**2 + p2**2)\n\n    results = []\n    for case_params in test_cases:\n        s_final, delta_e1 = run_simulation(case_params, N, L, DT, dx, x1, x2, kinetic_energy_op_p)\n        results.extend([s_final, delta_e1])\n    \n    # Format the final output as specified\n    print(f\"[{','.join([f'{val:.6f}' for val in results])}]\")\n\ndef run_simulation(params, N, L, dt, dx, x1, x2, T_op_p):\n    \"\"\"\n    Performs a single quantum dynamics simulation for a given set of parameters.\n    \"\"\"\n    w1, w2, g, x10, x20, p10, p20, t_final = params\n\n    # --- 1. Initial State Preparation ---\n    def phi0(x, omega):\n        return (omega / np.pi)**0.25 * np.exp(-0.5 * omega * x**2)\n\n    psi_x1 = phi0(x1 - x10, w1) * np.exp(1j * p10 * x1)\n    psi_x2 = phi0(x2 - x20, w2) * np.exp(1j * p20 * x2)\n    psi_initial = psi_x1 * psi_x2\n\n    # Normalize the initial wavefunction\n    norm = np.sqrt(np.sum(np.abs(psi_initial)**2) * dx**2)\n    psi_initial /= norm\n\n    # --- 2. Calculate Initial Energy ---\n    e1_initial = calculate_e1_bare(psi_initial, w1, x1, dx)\n\n    # --- 3. Time Evolution (Split-Operator FFT) ---\n    potential_energy_op_x = 0.5 * w1**2 * x1**2 + 0.5 * w2**2 * x2**2 + g * x1**2 * x2**2\n    \n    # Pre-calculate propagators\n    V_prop_half = np.exp(-0.5j * potential_energy_op_x * dt)\n    T_prop_full = np.exp(-1.0j * T_op_p * dt)\n\n    num_steps = int(np.floor(t_final / dt))\n    psi_current = psi_initial.copy()\n\n    for _ in range(num_steps):\n        # First half potential step\n        psi_current *= V_prop_half\n        # Full kinetic step in momentum space\n        psi_p = np.fft.fft2(psi_current)\n        psi_p *= T_prop_full\n        psi_current = np.fft.ifft2(psi_p)\n        # Second half potential step\n        psi_current *= V_prop_half\n\n    psi_final = psi_current\n\n    # --- 4. Calculate Final Observables ---\n    # Optional renormalization to correct for any minor numerical drift\n    final_norm = np.sqrt(np.sum(np.abs(psi_final)**2) * dx**2)\n    psi_final /= final_norm\n    \n    # a. Final Bare Mode-1 Energy and its change\n    e1_final = calculate_e1_bare(psi_final, w1, x1, dx)\n    delta_e1 = e1_final - e1_initial\n\n    # b. Bipartite Entanglement Entropy\n    # Construct the matrix M for SVD, as per problem description\n    M = psi_final * dx  #dx = sqrt(dx*dx)\n    singular_values = linalg.svd(M, compute_uv=False)\n    \n    # Eigenvalues of the reduced density matrix are squares of singular values\n    lambda_k = singular_values**2\n    \n    # Filter out zero eigenvalues to avoid log(0) issues.\n    lambda_k_pos = lambda_k[lambda_k > 1e-15] # Use a small threshold for numerical stability\n    \n    # von Neumann entropy S = -Tr(rho * log(rho))\n    s_final = -np.sum(lambda_k_pos * np.log(lambda_k_pos))\n\n    return s_final, delta_e1\n\ndef calculate_e1_bare(psi, w1, x1_grid, dx):\n    \"\"\"\n    Calculates the expectation value of the bare mode-1 Hamiltonian.\n    \"\"\"\n    # Potential energy part\n    v1_bare_op = 0.5 * w1**2 * x1_grid**2\n    v1_expect = np.sum(np.abs(psi)**2 * v1_bare_op) * dx**2\n\n    # Kinetic energy part using central finite differences with periodic boundaries\n    # Derivative along axis=0, which corresponds to x1\n    dpsi_dx1 = (np.roll(psi, -1, axis=0) - np.roll(psi, 1, axis=0)) / (2 * dx)\n    t1_expect = 0.5 * np.sum(np.abs(dpsi_dx1)**2) * dx**2\n    \n    return v1_expect + t1_expect\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "2799404"}]}