{"hands_on_practices": [{"introduction": "重组能 $\\lambda$ 是马库斯理论的基石，它量化了将分子与溶剂的结构从反应物平衡构型重排至产物平衡构型所需的能量代价。本练习将聚焦于其关键组成部分——源于溶剂的的外层重组能 $\\lambda_{\\text{out}}$。通过从经典的 Born 溶剂化模型出发，您将推导并应用一个著名公式，该公式将 $\\lambda_{\\text{out}}$ 与溶剂的宏观介电性质联系起来，从而在溶剂环境与电子转移动力学之间建立起一个具体的桥梁。[@problem_id:2771066]", "problem": "在马库斯（Marcus）理论的电子转移（ET）介电连续谱模型中，外层重组自由能是指当电子电荷突然变化，且只有快速（电子）极化能够在电子转移瞬间响应时，储存在溶剂的慢（取向）极化中的功。考虑一个单电子氧化还原事件，发生在一个半径为 $a$ 的球形溶质上，该溶质嵌入在静态介电常数为 $\\epsilon_{s}$、光学（高频）介电常数为 $\\epsilon_{\\infty}$ 的极性溶剂中，其中溶剂被视为线性、各向同性的电介质。假设在电子转移过程中，溶质上的电荷变化量为 $\\Delta q$，并且线性响应成立。\n\n从球形离子的玻恩（Born）溶剂化自由能出发，\n$$\n\\Delta G_{\\text{Born}}(q,\\epsilon) \\;=\\; -\\,\\frac{q^{2}}{8\\pi \\epsilon_{0}\\,a}\\left(1 - \\frac{1}{\\epsilon}\\right),\n$$\n并利用以下关系式将溶剂响应分为快速和慢速组分，\n$$\n\\left(1 - \\frac{1}{\\epsilon_{s}}\\right) \\;=\\; \\left(1 - \\frac{1}{\\epsilon_{\\infty}}\\right) \\;+\\; \\left(\\frac{1}{\\epsilon_{\\infty}} - \\frac{1}{\\epsilon_{s}}\\right),\n$$\n推导出外层重组自由能 $\\lambda_{\\text{out}}$ 关于 $a$、$\\epsilon_{s}$、$\\epsilon_{\\infty}$、$\\Delta q$ 和 $\\epsilon_{0}$ 的显式表达式。然后针对以下参数进行数值计算：\n$$\na = 5\\,\\text{\\AA},\\quad \\epsilon_{s}=80,\\quad \\epsilon_{\\infty}=2,\\quad \\Delta q = 1\\,e,\n$$\n使用以下常数：\n$$\n\\epsilon_{0} = 8.8541878128\\times 10^{-12}\\ \\mathrm{F\\,m^{-1}},\\quad e = 1.602176634\\times 10^{-19}\\ \\mathrm{C},\\quad 1\\,\\mathrm{eV} = 1.602176634\\times 10^{-19}\\ \\mathrm{J},\\quad 1\\,\\text{\\AA} = 10^{-10}\\ \\mathrm{m}.\n$$\n将最终能量以电子伏特（electronvolt (eV)）表示，并将答案四舍五入到四位有效数字。", "solution": "所述问题具有科学依据，提法严谨，并包含了获得唯一解所需的所有信息。这是理论物理化学中的一个标准问题。我们将进行推导和计算。\n\n问题要求在马库斯（Marcus）理论的介电连续谱模型下，推导单电子转移过程的外层重组自由能 $\\lambda_{\\text{out}}$。重组能是指，当电子尚未转移时，将溶剂极化的慢（取向）组分从其对应于反应物电荷态的平衡构型改变到对应于产物电荷态的平衡构型所需的自由能。\n\n设溶质的初始电荷为 $q_{i}$，最终电荷为 $q_{f}$。转移的电荷为 $\\Delta q = q_{f} - q_{i}$。溶剂由静态介电常数 $\\epsilon_{s}$ 和光学介电常数 $\\epsilon_{\\infty}$ 表征。\n\n出发点是在介电常数为 $\\epsilon$ 的介质中，一个电荷为 $q$、半径为 $a$ 的球形离子的玻恩（Born）溶剂化自由能：\n$$\n\\Delta G_{\\text{Born}}(q,\\epsilon) = -\\frac{q^{2}}{8\\pi \\epsilon_{0} a}\\left(1 - \\frac{1}{\\epsilon}\\right)\n$$\n问题提供了将总极化响应分为快速（电子）和慢速（取向）组分的恒等式：\n$$\n\\left(1 - \\frac{1}{\\epsilon_{s}}\\right) = \\left(1 - \\frac{1}{\\epsilon_{\\infty}}\\right) + \\left(\\frac{1}{\\epsilon_{\\infty}} - \\frac{1}{\\epsilon_{s}}\\right)\n$$\n使用这种分离方法，我们可以将总溶剂化自由能分为两部分：\n1.  来自快速（电子）溶剂极化的自由能贡献 $\\Delta G_{\\text{fast}}$，它对溶质电荷的变化做出瞬时响应。这与光学介电常数 $\\epsilon_{\\infty}$ 相关。\n$$\n\\Delta G_{\\text{fast}}(q) = -\\frac{q^{2}}{8\\pi \\epsilon_{0} a}\\left(1 - \\frac{1}{\\epsilon_{\\infty}}\\right)\n$$\n2.  来自慢速（取向）溶剂极化的自由能贡献 $\\Delta G_{\\text{slow}}$，它不会瞬时响应。这与静态响应和光学响应之间的差异有关。\n$$\n\\Delta G_{\\text{slow}}(q) = -\\frac{q^{2}}{8\\pi \\epsilon_{0} a}\\left(\\frac{1}{\\epsilon_{\\infty}} - \\frac{1}{\\epsilon_{s}}\\right)\n$$\n电荷为 $q$ 的总平衡溶剂化自由能是二者之和：$\\Delta G_{\\text{solv}}(q) = \\Delta G_{\\text{fast}}(q) + \\Delta G_{\\text{slow}}(q)$。\n\n在线性响应近似下，溶剂在溶质处产生一个反应势 $\\phi_{\\text{solv}}$。溶剂化能为 $\\Delta G_{\\text{solv}}(q) = \\frac{1}{2} q \\phi_{\\text{solv}}(q)$。该势也可以分为快速和慢速组分 $\\phi_{\\text{fast}}(q)$ 和 $\\phi_{\\text{slow}}(q)$，使得：\n$$\n\\phi_{\\text{slow}}(q) = \\frac{2 \\Delta G_{\\text{slow}}(q)}{q} = -\\frac{q}{4\\pi \\epsilon_{0} a}\\left(\\frac{1}{\\epsilon_{\\infty}} - \\frac{1}{\\epsilon_{s}}\\right)\n$$\n重组能 $\\lambda_{\\text{out}}$ 是在溶质电荷保持为 $q_{i}$ 不变的情况下，将慢极化场从对应于电荷 $q_{i}$ 的平衡构型改变为对应于电荷 $q_{f}$ 的平衡构型时，对系统所做的功。\n\n一个非平衡态的总自由能可以写为 $G(q, q')$，其中溶质带有电荷 $q$，但慢极化与另一个电荷 $q'$ 平衡。该自由能包括溶质与快速极化（始终与 $q$ 处于平衡）的相互作用，以及与特定的慢极化场（与 $q'$ 平衡）的相互作用。这种非平衡慢极化态的能量由电荷 $q$ 与慢势 $\\phi_{\\text{slow}}(q')$ 的相互作用能，以及极化场本身的自能 $\\frac{1}{2}(-q' \\phi_{\\text{slow}}(q'))$ 组成。\n$$\nG(q, q') = \\Delta G_{\\text{fast}}(q) + q \\phi_{\\text{slow}}(q') - \\frac{1}{2} q' \\phi_{\\text{slow}}(q')\n$$\n反应物体系的初始平衡态能量为 $G_{R} = G(q_{i}, q_{i})$。\n$$\nG_{R} = G(q_{i}, q_{i}) = \\Delta G_{\\text{fast}}(q_{i}) + q_{i} \\phi_{\\text{slow}}(q_{i}) - \\frac{1}{2} q_{i} \\phi_{\\text{slow}}(q_{i}) = \\Delta G_{\\text{fast}}(q_{i}) + \\frac{1}{2} q_{i} \\phi_{\\text{slow}}(q_{i}) = \\Delta G_{\\text{fast}}(q_{i}) + \\Delta G_{\\text{slow}}(q_{i})\n$$\n重组能 $\\lambda_{\\text{out}}$ 对应于反应物体系（$q=q_{i}$）处于产物（$q'=q_{f}$）的溶剂构型时的能量，相对于其自身平衡能量的差值。\n$$\n\\lambda_{\\text{out}} = G(q_{i}, q_{f}) - G(q_{i}, q_{i})\n$$\n代入 $G(q, q')$ 的表达式：\n$$\n\\lambda_{\\text{out}} = \\left( \\Delta G_{\\text{fast}}(q_{i}) + q_{i} \\phi_{\\text{slow}}(q_{f}) - \\frac{1}{2} q_{f} \\phi_{\\text{slow}}(q_{f}) \\right) - \\left( \\Delta G_{\\text{fast}}(q_{i}) + \\Delta G_{\\text{slow}}(q_{i}) \\right)\n$$\n$\\Delta G_{\\text{fast}}(q_{i})$ 项相互抵消。我们再代入 $\\Delta G_{\\text{slow}}(q) = \\frac{1}{2} q \\phi_{\\text{slow}}(q)$。\n$$\n\\lambda_{\\text{out}} = q_{i} \\phi_{\\text{slow}}(q_{f}) - \\Delta G_{\\text{slow}}(q_{f}) - \\Delta G_{\\text{slow}}(q_{i})\n$$\n现在，代入势和能量的表达式：\n$$\n\\lambda_{\\text{out}} = q_{i} \\left( -\\frac{q_{f}}{4\\pi \\epsilon_{0} a}\\left(\\frac{1}{\\epsilon_{\\infty}} - \\frac{1}{\\epsilon_{s}}\\right) \\right) - \\left( -\\frac{q_{f}^{2}}{8\\pi \\epsilon_{0} a}\\left(\\frac{1}{\\epsilon_{\\infty}} - \\frac{1}{\\epsilon_{s}}\\right) \\right) - \\left( -\\frac{q_{i}^{2}}{8\\pi \\epsilon_{0} a}\\left(\\frac{1}{\\epsilon_{\\infty}} - \\frac{1}{\\epsilon_{s}}\\right) \\right)\n$$\n提出公因式 $\\frac{1}{8\\pi \\epsilon_{0} a}\\left(\\frac{1}{\\epsilon_{\\infty}} - \\frac{1}{\\epsilon_{s}}\\right)$：\n$$\n\\lambda_{\\text{out}} = \\frac{1}{8\\pi \\epsilon_{0} a}\\left(\\frac{1}{\\epsilon_{\\infty}} - \\frac{1}{\\epsilon_{s}}\\right) \\left( -2q_{i}q_{f} + q_{f}^{2} + q_{i}^{2} \\right)\n$$\n最后一个括号中的项是一个完全平方，$(q_{f} - q_{i})^{2} = (\\Delta q)^{2}$。\n因此，外层重组能的最终表达式为：\n$$\n\\lambda_{\\text{out}} = \\frac{(\\Delta q)^{2}}{8\\pi \\epsilon_{0} a}\\left(\\frac{1}{\\epsilon_{\\infty}} - \\frac{1}{\\epsilon_{s}}\\right)\n$$\n推导完成。\n\n我们现在进行数值计算。给定的参数是：\n-   溶质半径 $a = 5\\,\\text{\\AA} = 5 \\times 10^{-10}\\,\\text{m}$\n-   静态介电常数 $\\epsilon_{s} = 80$\n-   光学介电常数 $\\epsilon_{\\infty} = 2$\n-   电荷变化 $\\Delta q = 1\\,e = 1.602176634 \\times 10^{-19}\\,\\text{C}$\n-   真空介电常数 $\\epsilon_{0} = 8.8541878128 \\times 10^{-12}\\,\\text{F}\\,\\text{m}^{-1}$ (或 $\\text{C}^{2}\\,\\text{J}^{-1}\\,\\text{m}^{-1}$)\n\n首先，我们计算介电常数项，在本应用中称为 Pekar 因子：\n$$\n\\left(\\frac{1}{\\epsilon_{\\infty}} - \\frac{1}{\\epsilon_{s}}\\right) = \\left(\\frac{1}{2} - \\frac{1}{80}\\right) = 0.5 - 0.0125 = 0.4875\n$$\n现在，我们将所有值代入 $\\lambda_{\\text{out}}$ 的表达式中，以计算能量（单位：焦耳）：\n$$\n\\lambda_{\\text{out}} = \\frac{(1.602176634 \\times 10^{-19}\\,\\text{C})^{2}}{8\\pi (8.8541878128 \\times 10^{-12}\\,\\text{C}^{2}\\,\\text{J}^{-1}\\,\\text{m}^{-1}) (5 \\times 10^{-10}\\,\\text{m})} \\left(0.4875\\right)\n$$\n$$\n\\lambda_{\\text{out}} = \\frac{2.56696996 \\times 10^{-38}}{1.11265005 \\times 10^{-19}}\\,\\text{J} \\times 0.4875\n$$\n$$\n\\lambda_{\\text{out}} = (2.3070733 \\times 10^{-19}\\,\\text{J}) \\times 0.4875\n$$\n$$\n\\lambda_{\\text{out}} = 1.12469315 \\times 10^{-19}\\,\\text{J}\n$$\n问题要求答案以电子伏特（eV）为单位。我们使用换算因子 $1\\,\\mathrm{eV} = 1.602176634 \\times 10^{-19}\\,\\text{J}$。\n$$\n\\lambda_{\\text{out}} (\\text{eV}) = \\frac{1.12469315 \\times 10^{-19}\\,\\text{J}}{1.602176634 \\times 10^{-19}\\,\\text{J/eV}}\n$$\n$$\n\\lambda_{\\text{out}} (\\text{eV}) = 0.7019800... \\,\\text{eV}\n$$\n四舍五入到四位有效数字，我们得到最终的数值答案。\n$$\n\\lambda_{\\text{out}} \\approx 0.7020\\,\\text{eV}\n$$", "answer": "$$\n\\boxed{0.7020}\n$$", "id": "2771066"}, {"introduction": "在确定了重组能 $\\lambda$ 和反应自由能 $\\Delta G^0$ 后，我们便能释放马库斯理论的核心预测能力：计算活化自由能 $\\Delta G^{\\ddagger}$。本练习将指导您应用著名的抛物线模型来确定这一动力学能垒。此外，您还将探索驱动力与反应速率之间违反直觉的关系，从而区分“正常区”与著名的“倒转区”。[@problem_id:2771030]", "problem": "在温度为 $300$ K 的极性溶剂中，两个配位配合物之间发生的一个非绝热外层电子转移过程，可以用两个沿集体溶剂坐标且曲率相同的谐振自由能面来模拟。反应物和产物能面的最小值分别处于构型 $Q_{R}$ 和 $Q_{P}$，标准反应自由能变为 $\\Delta G^{0}=-0.3$ eV。溶剂重组能为 $\\lambda=0.8$ eV。在双抛物线曲率相同的谐振近似下，从重组能的定义以及两个自由能面的交点出发，推导由 Rudolph A. Marcus 的电子转移理论所预测的活化自由能 $\\Delta G^{\\ddagger}$。然后用给定的参数对其进行数值计算。接下来，根据 $-\\Delta G^{0}-\\lambda$ 的符号判断该体系处于正常区还是倒转区。\n\n答案要求：\n- 以电子伏特 (eV) 表示活化自由能。\n- 将活化自由能四舍五入至四位有效数字。\n- 将最终结果以一个行矩阵的形式报告，该矩阵包含两个条目：第一个是 $\\Delta G^{\\ddagger}$ 的数值（单位为 eV）；第二个用 $1$ 表示正常区，用 $0$ 表示倒转区。矩阵内不要包含单位。", "solution": "该问题陈述是 Marcus 外层电子转移理论的一个标准应用，具有科学依据，论述清晰且客观。它提供了获得唯一解所需的所有参数。因此，该问题是有效的。\n\n此问题的理论框架是 Marcus 电子转移模型，该模型将反应物和产物态的自由能表示为集体溶剂坐标 $Q$ 的函数。问题指明，反应物和产物态的自由能面 $G_R(Q)$ 和 $G_P(Q)$ 分别是具有相同曲率的谐振势（抛物线）。设这些抛物线的力常数为 $k$。\n\n我们可以通过将反应物自由能面的最小值设置在 $Q_R = 0$ 并将其在此最小点的自由能设为零作为参考来定义它。因此，反应物能面的方程为：\n$$G_R(Q) = \\frac{1}{2} k Q^2$$\n产物自由能面的最小值位于一个不同的溶剂坐标 $Q_P$ 处，其在该最小点的自由能是标准反应自由能 $\\Delta G^0$。产物能面的方程为：\n$$G_P(Q) = \\frac{1}{2} k (Q - Q_P)^2 + \\Delta G^0$$\n溶剂重组能 $\\lambda$ 定义为在反应物势能面上，体系从反应物平衡构型 ($Q_R = 0$) 移动到产物平衡构型 ($Q=Q_P$) 所需的能量。在数学上，这是能量差 $G_R(Q_P) - G_R(Q_R)$：\n$$\\lambda = G_R(Q_P) - G_R(0) = \\frac{1}{2} k (Q_P)^2 - 0 = \\frac{1}{2} k Q_P^2$$\n电子转移反应的过渡态对应于两个自由能面的交点。此交点的坐标，记为 $Q^{\\ddagger}$，可通过令 $G_R(Q) = G_P(Q)$ 求得：\n$$\\frac{1}{2} k Q^2 = \\frac{1}{2} k (Q - Q_P)^2 + \\Delta G^0$$\n展开右侧的平方项得到：\n$$\\frac{1}{2} k Q^2 = \\frac{1}{2} k (Q^2 - 2QQ_P + Q_P^2) + \\Delta G^0$$\n通过消去等式两边的 $\\frac{1}{2} k Q^2$ 项来简化表达式：\n$$0 = \\frac{1}{2} k (-2QQ_P + Q_P^2) + \\Delta G^0$$\n$$0 = -kQQ_P + \\frac{1}{2} k Q_P^2 + \\Delta G^0$$\n现在我们可以代入重组能的定义 $\\lambda = \\frac{1}{2} k Q_P^2$：\n$$0 = -kQQ_P + \\lambda + \\Delta G^0$$\n求解交点处的坐标 $Q$，我们将其标记为 $Q^{\\ddagger}$：\n$$kQ^{\\ddagger}Q_P = \\lambda + \\Delta G^0$$\n$$Q^{\\ddagger} = \\frac{\\lambda + \\Delta G^0}{kQ_P}$$\n为了用给定的参数 $\\lambda$ 和 $\\Delta G^0$ 来表示 $Q^{\\ddagger}$，我们可以变换 $\\lambda$ 的表达式。由 $\\lambda = \\frac{1}{2} k Q_P^2$ 可得 $k = \\frac{2\\lambda}{Q_P^2}$。将其代入 $Q^{\\ddagger}$ 的表达式中：\n$$Q^{\\ddagger} = \\frac{\\lambda + \\Delta G^0}{(2\\lambda/Q_P^2)Q_P} = \\frac{\\lambda + \\Delta G^0}{2\\lambda/Q_P} = Q_P \\frac{\\lambda + \\Delta G^0}{2\\lambda}$$\n活化自由能 $\\Delta G^{\\ddagger}$ 是从反应物能面最小值开始测量的能垒，即 $\\Delta G^{\\ddagger} = G_R(Q^{\\ddagger}) - G_R(0) = G_R(Q^{\\ddagger})$。\n$$\\Delta G^{\\ddagger} = \\frac{1}{2} k (Q^{\\ddagger})^2$$\n代入推导出的 $Q^{\\ddagger}$ 表达式：\n$$\\Delta G^{\\ddagger} = \\frac{1}{2} k \\left( Q_P \\frac{\\lambda + \\Delta G^0}{2\\lambda} \\right)^2 = \\frac{1}{2} k Q_P^2 \\left( \\frac{\\lambda + \\Delta G^0}{2\\lambda} \\right)^2$$\n再次注意到 $\\lambda = \\frac{1}{2} k Q_P^2$，我们得到了 Marcus 活化自由能的最终表达式：\n$$\\Delta G^{\\ddagger} = \\lambda \\left( \\frac{(\\lambda + \\Delta G^0)^2}{4\\lambda^2} \\right) = \\frac{(\\lambda + \\Delta G^0)^2}{4\\lambda}$$\n这就是所要求推导的表达式。\n\n现在，我们使用给定的数值 $\\Delta G^0 = -0.3$ eV 和 $\\lambda = 0.8$ eV 对该表达式进行数值计算。温度为 $300$ K 已被注意到，但对于这个经典能垒计算而言并非必要。\n$$\\Delta G^{\\ddagger} = \\frac{(0.8 \\text{ eV} + (-0.3 \\text{ eV}))^2}{4(0.8 \\text{ eV})} = \\frac{(0.5 \\text{ eV})^2}{3.2 \\text{ eV}} = \\frac{0.25 \\text{ eV}^2}{3.2 \\text{ eV}} = 0.078125 \\text{ eV}$$\n四舍五入到四位有效数字，我们得到 $\\Delta G^{\\ddagger} = 0.07813$ eV。\n\n最后，我们判断体系是处于正常区还是倒转区。问题要求基于 $-\\Delta G^0 - \\lambda$ 的符号来判断。\n- 正常区的定义为 $|\\Delta G^0| < \\lambda$。在这种情况下，$\\Delta G^0 > -\\lambda$，对于放能反应（$\\Delta G^0 < 0$）这等价于 $-\\Delta G^0 < \\lambda$，因此 $-\\Delta G^0 - \\lambda < 0$。\n- 倒转区的定义为 $|\\Delta G^0| > \\lambda$（特别是对于放能反应，$\\Delta G^0 < -\\lambda$）。这等价于 $-\\Delta G^0 > \\lambda$，因此 $-\\Delta G^0 - \\lambda > 0$。\n我们来计算表达式 $-\\Delta G^0 - \\lambda$ 的值：\n$$-\\Delta G^0 - \\lambda = -(-0.3 \\text{ eV}) - 0.8 \\text{ eV} = 0.3 \\text{ eV} - 0.8 \\text{ eV} = -0.5 \\text{ eV}$$\n由于结果为负（$-0.5 < 0$），该反应处于正常区。问题要求使用一个数值指标：正常区用 $1$ 表示，倒转区用 $0$ 表示。因此，该指标为 $1$。\n\n最终结果是一个包含 $\\Delta G^{\\ddagger}$ 数值和区域指标的矩阵。", "answer": "$$\\boxed{\\begin{pmatrix} 0.07813 & 1 \\end{pmatrix}}$$", "id": "2771030"}, {"introduction": "尽管简化模型提供了必要的物理洞见，但在复杂分子体系中确定马库斯理论的参数通常需要借助计算模拟。这项高级实践将理论与现代计算化学相结合，展示了如何从分子动力学（MD）轨迹中提取基本参数 $\\lambda$ 和 $\\Delta G^0$。通过在线性响应近似下分析垂直能量差的统计分布，您将学到一项前沿研究中用于将马库斯理论应用于实际问题的强大技术。[@problem_id:2771011]", "problem": "您将执行一个基于 Marcus 理论中电子转移线性响应理论的计算任务。一个分子动力学（MD）模拟产生了垂直能量间隙的样本，该间隙定义为受体和给体电子能量之差。在线性响应近似下，每个绝热表面上的能量间隙分布是高斯分布，且其下层抛物线自由能面具有共同的曲率。\n\n您的任务是编写一个完整的程序，对于每个测试用例，使用在给体和受体表面上采样的能量间隙统计数据，计算重组能和标准反应自由能，并给出有理论依据的不确定性估计。所有能量必须以电子伏特（eV）报告，温度以开尔文（K）报告。\n\n基本原理：\n- 在线性响应和能量间隙的高斯统计假设下，沿着能量间隙坐标的给体和受体自由能面是具有相等曲率的抛物线。\n- 垂直能量间隙定义为受体和给体绝热态势能之差，用随机变量 $X$ 表示。\n- 玻尔兹曼常数为 $k_{\\mathrm{B}} = 8.617333262145 \\times 10^{-5}\\ \\mathrm{eV/K}$。\n- 如果 $X$ 在给体系综和受体系综上是独立采样的，那么来自这两个系综的样本均值和样本方差在统计上是独立的。\n- 对于一个方差为 $\\sigma^{2}$ 的正态分布变量，从 $n$ 个独立样本计算出的无偏样本方差 $S^{2}$ 的抽样方差为 $\\mathrm{Var}(S^{2}) = \\dfrac{2 \\sigma^{4}}{n-1}$。当 $\\sigma^{2}$ 未知时，在此表达式中使用 $S^{2}$ 作为插件估计来进行误差估计是可以接受的。\n\n您的算法所需的推导：\n- 从具有相等曲率的抛物线自由能假设和每个表面上 $X$ 的高斯统计出发，推导将 $X$ 的给体和受体系综统计量与重组能 $\\lambda$ 和标准反应自由能 $\\Delta G^{0}$ 联系起来的表达式。\n- 使用一阶不确定性传播以及给体和受体样本的独立性，根据样本量、样本方差和正态性下样本方差的抽样方差公式，推导这些估计值的标准误。\n\n实现规格：\n- 对于每个测试用例，给定温度 $T$ (单位K)，$X$ 的给体系综样本均值 $\\mu_{\\mathrm{D}}$ (单位eV)，$X$ 的受体系综样本均值 $\\mu_{\\mathrm{A}}$ (单位eV)，$X$ 的无偏给体样本方差 $s_{\\mathrm{D}}^{2}$ (单位$\\mathrm{eV}^{2}$)，$X$ 的无偏受体样本方差 $s_{\\mathrm{A}}^{2}$ (单位$\\mathrm{eV}^{2}$)，以及样本量 $n_{\\mathrm{D}}$ 和 $n_{\\mathrm{A}}$。\n- 在线性响应近似下，根据给体和受体能量间隙的统计数据计算重组能 $\\lambda$ 和标准反应自由能 $\\Delta G^{0}$。利用两个系综的独立性以及样本均值和样本方差的正态抽样方差公式，为 $\\lambda$ 和 $\\Delta G^{0}$ 提供有理论依据的标准误。\n- 此外，通过双标准差准则，比较基于平均间隙的 $\\lambda$ 估计值与来自每个表面的基于方差的估计值，以评估线性响应假设的内部一致性。具体来说，当且仅当两个比较（在不确定性通过平方和求根合并后）都落在两个组合标准差之内时，将一致性标志设为 $1$；否则设为 $0$。\n\n数值和单位说明：\n- 使用上面给出的 $k_{\\mathrm{B}}$，单位为 $\\mathrm{eV/K}$。\n- 以 eV 为单位报告 $\\lambda$、$\\Delta G^{0}$ 及其标准误。\n- 将所有浮点输出四舍五入到六位小数。\n- 温度单位为开尔文；不涉及角度单位。\n\n测试套件：\n为以下三个测试用例提供结果。每个案例由 $(T,\\ \\mu_{\\mathrm{D}},\\ \\mu_{\\mathrm{A}},\\ s_{\\mathrm{D}}^{2},\\ s_{\\mathrm{A}}^{2},\\ n_{\\mathrm{D}},\\ n_{\\mathrm{A}})$ 完全指定：\n\n1. 案例1（平衡采样，曲率近似相等）：$(298.15,\\ 0.600000,\\ -0.200000,\\ 0.0205536,\\ 0.0205536,\\ 200,\\ 200)$\n2. 案例2（样本量不等，曲率轻微不匹配）：$(310.0,\\ -0.100000,\\ -0.900000,\\ 0.0215000,\\ 0.0212000,\\ 100,\\ 80)$\n3. 案例3（小样本情况）：$(250.0,\\ 0.300000,\\ 0.100000,\\ 0.0040000,\\ 0.0046000,\\ 8,\\ 7)$\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含三个测试用例的结果，格式为一个由方括号括起来的、逗号分隔的列表的列表，每个内部列表按以下顺序排列：\n  $[\\lambda,\\ \\Delta G^{0},\\ \\mathrm{SE}(\\lambda),\\ \\mathrm{SE}(\\Delta G^{0}),\\ \\mathrm{flag}]$\n- 所有浮点条目必须四舍五入到六位小数，一致性标志必须为整数 $0$ 或 $1$。\n- 例如，输出必须如下所示：\n  [[lambda1,dG01,se_lambda1,se_dG01,flag1],[lambda2,dG02,se_lambda2,se_dG02,flag2],[lambda3,dG03,se_lambda3,se_dG03,flag3]]", "solution": "我们从 Marcus 理论中电子转移的线性响应框架开始。设受体和给体绝热势能之间的垂直间隙为随机变量 $X = E_{\\mathrm{A}} - E_{\\mathrm{D}}$。当从给体表面采样构型时，$X$ 的分布服从均值为 $\\mu_{\\mathrm{D}} = \\langle X \\rangle_{\\mathrm{D}}$、方差为 $\\sigma_{\\mathrm{D}}^{2}$ 的高斯分布；同样，对于受体表面，其均值为 $\\mu_{\\mathrm{A}} = \\langle X \\rangle_{\\mathrm{A}}$、方差为 $\\sigma_{\\mathrm{A}}^{2}$。在线性响应下，沿 $X$ 坐标的给体和受体表面上的自由能曲线 $G_{\\mathrm{D}}(X)$ 和 $G_{\\mathrm{A}}(X)$ 是具有相等曲率的抛物线。\n\n每个表面上 $X$ 的概率密度通过 $P_{i}(X) \\propto \\exp\\left(-\\beta G_{i}(X)\\right)$ 与自由能相关联，其中 $\\beta = 1/(k_{\\mathrm{B}} T)$ 且 $i \\in \\{\\mathrm{D}, \\mathrm{A}\\}$。如果 $P_{i}(X)$ 是高斯分布，$P_{i}(X) \\propto \\exp\\left( - (X - \\mu_{i})^{2} / (2 \\sigma_{i}^{2}) \\right)$，则相应的自由能面为\n$$\nG_{i}(X) = \\frac{(X - \\mu_{i})^{2}}{2 \\beta \\sigma_{i}^{2}} + C_{i},\n$$\n其中 $C_{i}$ 是一个常数。抛物线的相等曲率意味着 $1 / (\\beta \\sigma_{\\mathrm{D}}^{2}) = 1 / (\\beta \\sigma_{\\mathrm{A}}^{2})$，因此在线性响应近似下 $\\sigma_{\\mathrm{D}}^{2} = \\sigma_{\\mathrm{A}}^{2} \\equiv \\sigma^{2}$。\n\n在 Marcus 理论中，作为 $X$ 函数的抛物线自由能面可以写成曲率为 $1/(4 \\lambda)$ 的形式，\n$$\nG_{\\mathrm{D}}(X) = \\frac{(X - \\mu_{\\mathrm{D}})^{2}}{4 \\lambda} + C_{\\mathrm{D}}, \\qquad\nG_{\\mathrm{A}}(X) = \\frac{(X - \\mu_{\\mathrm{A}})^{2}}{4 \\lambda} + C_{\\mathrm{A}},\n$$\n当 $\\sigma^{2} = 2 k_{\\mathrm{B}} T \\lambda$ 时，这与高斯形式一致。要理解这一点，只需将高斯曲率 $1 / (\\beta \\sigma^{2})$ 与 Marcus 曲率 $1/(4 \\lambda)$ 等同起来：\n$$\n\\frac{1}{\\beta \\sigma^{2}} = \\frac{1}{4 \\lambda} \\quad \\Rightarrow \\quad \\sigma^{2} = 2 k_{\\mathrm{B}} T \\lambda.\n$$\n两个抛物线的极小值点分别出现在 $X = \\mu_{\\mathrm{D}}$ 和 $X = \\mu_{\\mathrm{A}}$。标准反应自由能 $\\Delta G^{0}$ 是这些极小值点之间的自由能差：\n$$\n\\Delta G^{0} = G_{\\mathrm{A}}(\\mu_{\\mathrm{A}}) - G_{\\mathrm{D}}(\\mu_{\\mathrm{D}}) = C_{\\mathrm{A}} - C_{\\mathrm{D}}.\n$$\n由于两个抛物线具有相等的曲率，抛物线的几何性质意味着沿 $X$ 轴的极小值点之间的距离为 $|\\mu_{\\mathrm{D}} - \\mu_{\\mathrm{A}}|$，并且极小值点之间的中点投射到交叉点上，其对称性产生了以下关系\n$$\n\\lambda = \\frac{\\mu_{\\mathrm{D}} - \\mu_{\\mathrm{A}}}{2}, \\qquad \\Delta G^{0} = \\frac{\\mu_{\\mathrm{D}} + \\mu_{\\mathrm{A}}}{2}.\n$$\n这些恒等式可以通过将两个抛物线表示为曲率相等、顶点横坐标为 $\\mu_{\\mathrm{D}}$ 和 $\\mu_{\\mathrm{A}}$ 且垂直偏移相差 $\\Delta G^{0}$ 的二次函数来明确推导；通过强制在交叉点处已知的能量间隙以及关于垂直平分线的对称性，即可得到上述的对称和反对称组合。\n\n因此，我们获得了两种不同但一致的估计重组能的方法：\n1. 基于给体和受体平均值的平均间隙估计量，\n$$\n\\lambda_{\\mathrm{mean}} = \\frac{\\mu_{\\mathrm{D}} - \\mu_{\\mathrm{A}}}{2}.\n$$\n2. 基于等曲率关系 $\\sigma^{2} = 2 k_{\\mathrm{B}} T \\lambda$ 的方差估计量，分别在每个表面上，\n$$\n\\lambda_{\\mathrm{var,D}} = \\frac{s_{\\mathrm{D}}^{2}}{2 k_{\\mathrm{B}} T}, \\qquad\n\\lambda_{\\mathrm{var,A}} = \\frac{s_{\\mathrm{A}}^{2}}{2 k_{\\mathrm{B}} T},\n$$\n其中 $s_{i}^{2}$ 是估计 $\\sigma_{i}^{2}$ 的无偏样本方差。\n\n不确定性估计：\n- 对于独立的给体和受体采样，样本均值的标准误为\n$$\n\\mathrm{SE}(\\mu_{\\mathrm{D}}) = \\sqrt{\\frac{s_{\\mathrm{D}}^{2}}{n_{\\mathrm{D}}}}, \\qquad\n\\mathrm{SE}(\\mu_{\\mathrm{A}}) = \\sqrt{\\frac{s_{\\mathrm{A}}^{2}}{n_{\\mathrm{A}}}}.\n$$\n将它们传播到 $\\lambda_{\\mathrm{mean}}$ 和 $\\Delta G^{0}$ 得出\n$$\n\\mathrm{SE}(\\lambda_{\\mathrm{mean}}) = \\frac{1}{2}\\sqrt{\\mathrm{SE}(\\mu_{\\mathrm{D}})^{2} + \\mathrm{SE}(\\mu_{\\mathrm{A}})^{2}}, \\qquad\n\\mathrm{SE}(\\Delta G^{0}) = \\frac{1}{2}\\sqrt{\\mathrm{SE}(\\mu_{\\mathrm{D}})^{2} + \\mathrm{SE}(\\mu_{\\mathrm{A}})^{2}}.\n$$\n- 对于基于方差的估计，在正态性假设下，无偏样本方差的抽样方差为 $\\mathrm{Var}(s^{2}) = \\dfrac{2 \\sigma^{4}}{n - 1}$。使用 $s^{2}$ 作为 $\\sigma^{2}$ 的插件估计量，基于方差的重组能的标准误为\n$$\n\\mathrm{SE}(\\lambda_{\\mathrm{var,D}}) = \\frac{1}{2 k_{\\mathrm{B}} T}\\sqrt{\\frac{2 s_{\\mathrm{D}}^{4}}{n_{\\mathrm{D}} - 1}}, \\qquad\n\\mathrm{SE}(\\lambda_{\\mathrm{var,A}}) = \\frac{1}{2 k_{\\mathrm{B}} T}\\sqrt{\\frac{2 s_{\\mathrm{A}}^{4}}{n_{\\mathrm{A}} - 1}}.\n$$\n\n一致性评估：\n我们定义一个二元一致性标志，用于检查线性响应等曲率图像是否在两个标准差范围内内部一致。具体来说，我们测试是否\n$$\n|\\lambda_{\\mathrm{mean}} - \\lambda_{\\mathrm{var,D}}| \\le 2 \\sqrt{\\mathrm{SE}(\\lambda_{\\mathrm{mean}})^{2} + \\mathrm{SE}(\\lambda_{\\mathrm{var,D}})^{2}},\n$$\n对受体也进行类似测试，\n$$\n|\\lambda_{\\mathrm{mean}} - \\lambda_{\\mathrm{var,A}}| \\le 2 \\sqrt{\\mathrm{SE}(\\lambda_{\\mathrm{mean}})^{2} + \\mathrm{SE}(\\lambda_{\\mathrm{var,A}})^{2}}.\n$$\n如果两个不等式都成立，我们将标志设为 $1$，否则设为 $0$。\n\n算法设计：\n- 对于每个测试用例，读取 $(T,\\ \\mu_{\\mathrm{D}},\\ \\mu_{\\mathrm{A}},\\ s_{\\mathrm{D}}^{2},\\ s_{\\mathrm{A}}^{2},\\ n_{\\mathrm{D}},\\ n_{\\mathrm{A}})$。\n- 使用提供的 $k_{\\mathrm{B}}$（单位为 $\\mathrm{eV/K}$）计算 $k_{\\mathrm{B}} T$。\n- 从 $(\\mu_{\\mathrm{D}}, \\mu_{\\mathrm{A}})$ 计算 $\\lambda_{\\mathrm{mean}}$ 和 $\\Delta G^{0}$。\n- 从 $(s_{\\mathrm{D}}^{2}, s_{\\mathrm{A}}^{2}, n_{\\mathrm{D}}, n_{\\mathrm{A}})$ 计算 $\\mathrm{SE}(\\lambda_{\\mathrm{mean}})$ 和 $\\mathrm{SE}(\\Delta G^{0})$。\n- 计算 $\\lambda_{\\mathrm{var,D}}$ 和 $\\lambda_{\\mathrm{var,A}}$ 及其标准误。\n- 使用上述双标准差准则计算一致性标志。\n- 将所有浮点输出四舍五入到六位小数，并按规定顺序为每个案例输出最终列表。\n\n将此方法应用于提供的三个测试用例，即可得出所需的输出。最终程序精确地实现了这些步骤，并生成一个单行的列表的列表：\n$[[\\lambda_{1},\\ \\Delta G^{0}_{1},\\ \\mathrm{SE}(\\lambda_{1}),\\ \\mathrm{SE}(\\Delta G^{0}_{1}),\\ \\mathrm{flag}_{1}],\\ [\\lambda_{2},\\ \\Delta G^{0}_{2},\\ \\mathrm{SE}(\\lambda_{2}),\\ \\mathrm{SE}(\\Delta G^{0}_{2}),\\ \\mathrm{flag}_{2}],\\ [\\lambda_{3},\\ \\Delta G^{0}_{3},\\ \\mathrm{SE}(\\lambda_{3}),\\ \\mathrm{SE}(\\Delta G^{0}_{3}),\\ \\mathrm{flag}_{3}]]$.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef compute_case(T, mu_D, mu_A, s2_D, s2_A, n_D, n_A):\n    # Constants\n    kB_eV_per_K = 8.617333262145e-5  # eV/K\n\n    # k_B T in eV\n    kBT = kB_eV_per_K * T\n\n    # Mean-gap estimates\n    lambda_mean = 0.5 * (mu_D - mu_A)\n    dG0 = 0.5 * (mu_D + mu_A)\n\n    # Standard errors for means\n    se_mu_D = np.sqrt(s2_D / n_D)\n    se_mu_A = np.sqrt(s2_A / n_A)\n\n    # Propagate to lambda_mean and dG0\n    se_lambda_mean = 0.5 * np.sqrt(se_mu_D**2 + se_mu_A**2)\n    se_dG0 = 0.5 * np.sqrt(se_mu_D**2 + se_mu_A**2)\n\n    # Variance-based lambda estimates\n    lambda_var_D = s2_D / (2.0 * kBT)\n    lambda_var_A = s2_A / (2.0 * kBT)\n\n    # Standard errors for variance-based lambdas using Var(S^2) = 2 sigma^4/(n-1), plug-in sigma^2 ~ s^2\n    # Guard against n-1 = 0 (though test cases avoid n=1)\n    se_lambda_var_D = (1.0 / (2.0 * kBT)) * np.sqrt(2.0 * (s2_D**2) / (n_D - 1)) if n_D > 1 else np.inf\n    se_lambda_var_A = (1.0 / (2.0 * kBT)) * np.sqrt(2.0 * (s2_A**2) / (n_A - 1)) if n_A > 1 else np.inf\n\n    # Consistency checks: within 2 sigma with uncertainties combined in quadrature\n    diff_D = abs(lambda_mean - lambda_var_D)\n    diff_A = abs(lambda_mean - lambda_var_A)\n    thresh_D = 2.0 * np.sqrt(se_lambda_mean**2 + se_lambda_var_D**2)\n    thresh_A = 2.0 * np.sqrt(se_lambda_mean**2 + se_lambda_var_A**2)\n    consistency_flag = int((diff_D = thresh_D) and (diff_A = thresh_A))\n\n    # Round to six decimals as specified\n    def r6(x): return f\"{x:.6f}\"\n\n    return [r6(lambda_mean), r6(dG0), r6(se_lambda_mean), r6(se_dG0), str(consistency_flag)]\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each case: (T, mu_D, mu_A, s2_D, s2_A, n_D, n_A)\n    test_cases = [\n        (298.15, 0.600000, -0.200000, 0.0205536, 0.0205536, 200, 200),\n        (310.0, -0.100000, -0.900000, 0.0215000, 0.0212000, 100, 80),\n        (250.0, 0.300000, 0.100000, 0.0040000, 0.0046000, 8, 7),\n    ]\n\n    results = []\n    for case in test_cases:\n        T, mu_D, mu_A, s2_D, s2_A, n_D, n_A = case\n        # Guard against n=1 for variance of variance calculation\n        if n_D = 1 or n_A = 1:\n            # Handle this edge case appropriately if it can occur\n            # For this problem, it's safe to assume n > 1 from context\n            pass\n        result = compute_case(T, mu_D, mu_A, s2_D, s2_A, n_D, n_A)\n        results.append(result)\n\n    # Construct the exact required output format: a single line list of lists\n    # Inner lists are comma-separated without quotes around numbers; we already formatted floats as strings.\n    formatted_inner = [f\"[{','.join(items)}]\" for items in results]\n    output_line = f\"[{','.join(formatted_inner)}]\"\n    print(output_line)\n\n# This wrapper is for execution environment. The function `solve()` does the main work.\nsolve()\n```", "id": "2771011"}]}