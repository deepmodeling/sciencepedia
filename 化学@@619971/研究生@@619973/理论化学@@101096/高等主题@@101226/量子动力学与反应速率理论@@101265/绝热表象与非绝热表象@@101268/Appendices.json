{"hands_on_practices": [{"introduction": "理解非绝热过程的第一步是掌握便利的（但非直接可观的）初态基与物理上可观测的绝热基之间的变换。本练习要求您为一个经典的双态模型执行这一变换，推导出绝热能量以及连接两种表象的至关重要的混合角。这项实践将巩固您对势能面如何从初态哈密顿量中产生以及它们之间的关系如何通过一个随核坐标变化的旋转来数学描述的理解。", "problem": "在一个双原子分子的最小避免交叉模型中，非绝热表象下的电子哈密顿量依赖于单个核坐标 $R$ 并由下式给出\n$$\nH(R)=\\begin{pmatrix}\n\\alpha R & V_{12}\\\\\nV_{12} & -\\alpha R\n\\end{pmatrix},\n$$\n其中 $\\alpha>0$ 和 $V_{12}>0$ 是实常数。在玻恩–奥本海默（BO）分离中，绝热势能面是通过在固定 $R$ 值下求解电子哈密顿量的本征值得到的。绝热表象与非绝热表象通过一个实正交变换 $U(\\theta)$ 相关联，该变换在每个 $R$ 值下都将 $H(R)$ 对角化。从不含时电子薛定谔方程和将绝热基定义为 $H(R)$ 的本征基出发，推导绝热能量 $E_{\\pm}(R)$ 并确定一个显式的、连续的绝热混合角 $\\theta(R)$。该混合角由 $U(\\theta)^{\\top}H(R)U(\\theta)$ 为对角矩阵定义，并遵循约定 $0\\le \\theta(R)\\le \\pi/2$ 以及渐近行为 $\\theta(R)\\to 0$（当 $R\\to +\\infty$ 时）和 $\\theta(R)\\to \\pi/2$（当 $R\\to -\\infty$ 时）。用 $\\alpha$、$R$ 和 $V_{12}$ 的符号形式表达所有中间步骤。\n\n作为你的最终答案，报告绝热能隙 $\\Delta E(R)=E_{+}(R)-E_{-}(R)$ 的解析表达式。最终答案必须是单个闭合形式的表达式。不需要进行数值计算或四舍五入。", "solution": "所给出的问题陈述是有效的。这是一个量子化学中标准的、适定的问题，涉及两能级电子哈密顿量的对角化，这是理解避免交叉和非绝热跃迁的基石。该问题是自洽的，其科学基础在于玻恩-奥本海默近似，并且所有参数和条件都已明确定义。我们将开始推导过程。\n\n绝热势能面，记为 $E_{\\pm}(R)$，是电子哈密顿矩阵 $H(R)$ 的本征值。为求得这些本征值，我们必须求解特征方程 $\\det(H(R) - E \\cdot I) = 0$，其中 $I$ 是 $2 \\times 2$ 单位矩阵，$E$ 代表本征值。\n\n该特征方程为：\n$$\n\\det \\begin{pmatrix}\n\\alpha R - E & V_{12} \\\\\nV_{12} & -\\alpha R - E\n\\end{pmatrix} = 0\n$$\n展开行列式得到：\n$$\n(\\alpha R - E)(-\\alpha R - E) - V_{12}^{2} = 0\n$$\n$$\n-(\\alpha R)^{2} - \\alpha R E + \\alpha R E + E^{2} - V_{12}^{2} = 0\n$$\n$$\nE^{2} - (\\alpha R)^{2} - V_{12}^{2} = 0\n$$\n求解 $E^{2}$：\n$$\nE^{2} = (\\alpha R)^{2} + V_{12}^{2}\n$$\n因此，两个本征值，也即绝热能量，是：\n$$\nE_{\\pm}(R) = \\pm \\sqrt{(\\alpha R)^{2} + V_{12}^{2}}\n$$\n按照惯例，$E_{+}(R)$ 是上势能面，$E_{-}(R)$ 是下势能面。\n\n接下来，我们必须确定绝热混合角 $\\theta(R)$。绝热基与非绝热基通过一个实正交变换 $U(\\theta)$ 相关联，对于一个 $2 \\times 2$ 系统，这是一个旋转矩阵：\n$$\nU(\\theta) = \\begin{pmatrix}\n\\cos\\theta & -\\sin\\theta \\\\\n\\sin\\theta & \\cos\\theta\n\\end{pmatrix}\n$$\n这个变换将哈密顿量对角化：\n$$\nU(\\theta)^{\\top}H(R)U(\\theta) = \\begin{pmatrix}\nE_{\\text{diag},1} & 0 \\\\\n0 & E_{\\text{diag},2}\n\\end{pmatrix}\n$$\n变换后矩阵的非对角元必须为零。我们来计算 $U(\\theta)^{\\top}H(R)U(\\theta)$ 的 $(1,2)$ 元：\n$$\n(U^{\\top}HU)_{12} = \\begin{pmatrix} \\cos\\theta & \\sin\\theta \\end{pmatrix} \\begin{pmatrix} \\alpha R & V_{12} \\\\ V_{12} & -\\alpha R \\end{pmatrix} \\begin{pmatrix} -\\sin\\theta \\\\ \\cos\\theta \\end{pmatrix}\n$$\n$$\n(U^{\\top}HU)_{12} = (\\alpha R \\cos\\theta + V_{12} \\sin\\theta)(-\\sin\\theta) + (V_{12} \\cos\\theta - \\alpha R \\sin\\theta)(\\cos\\theta)\n$$\n$$\n(U^{\\top}HU)_{12} = -\\alpha R \\sin\\theta \\cos\\theta - V_{12} \\sin^{2}\\theta + V_{12} \\cos^{2}\\theta - \\alpha R \\sin\\theta \\cos\\theta\n$$\n$$\n(U^{\\top}HU)_{12} = V_{12}(\\cos^{2}\\theta - \\sin^{2}\\theta) - 2\\alpha R \\sin\\theta \\cos\\theta\n$$\n使用二倍角三角恒等式 $\\cos(2\\theta) = \\cos^{2}\\theta - \\sin^{2}\\theta$ 和 $\\sin(2\\theta) = 2\\sin\\theta\\cos\\theta$，我们得到：\n$$\n(U^{\\top}HU)_{12} = V_{12}\\cos(2\\theta) - \\alpha R \\sin(2\\theta)\n$$\n将此元设为零，得到对角化条件：\n$$\nV_{12}\\cos(2\\theta) = \\alpha R \\sin(2\\theta)\n$$\n对于 $\\alpha R \\neq 0$ 和 $\\cos(2\\theta) \\neq 0$，我们可以写出：\n$$\n\\tan(2\\theta) = \\frac{V_{12}}{\\alpha R}\n$$\n为了找到一个满足给定边界条件 $0 \\le \\theta(R) \\le \\pi/2$、$\\theta(R \\to +\\infty) \\to 0$ 和 $\\theta(R \\to -\\infty) \\to \\pi/2$ 的显式连续函数 $\\theta(R)$，我们必须仔细选择反正切函数的分支。标准的 $\\arctan$ 函数的值域为 $(-\\pi/2, \\pi/2)$，这将导致 $\\theta \\in (-\\pi/4, \\pi/4)$，从而不满足条件。一个正确的方法是使用 `arccot` 函数，其标准值域为 $(0, \\pi)$。我们将 $2\\theta(R)$ 定义为：\n$$\n2\\theta(R) = \\text{arccot}\\left(\\frac{\\alpha R}{V_{12}}\\right)\n$$\n这就给出了混合角：\n$$\n\\theta(R) = \\frac{1}{2} \\text{arccot}\\left(\\frac{\\alpha R}{V_{12}}\\right)\n$$\n让我们根据问题的约束条件来验证此解。\n由于 $\\text{arccot}(x)$ 将 $\\mathbb{R}$ 映射到 $(0, \\pi)$，我们关于 $\\theta(R)$ 的表达式将 $\\mathbb{R}$ 映射到 $(0, \\pi/2)$，满足 $0 \\le \\theta(R) \\le \\pi/2$。\n让我们检查其渐近行为：\n当 $R \\to +\\infty$ 时，自变量 $\\frac{\\alpha R}{V_{12}} \\to +\\infty$。此时 $\\text{arccot}(+\\infty) \\to 0$。因此，$\\theta(R) \\to 0$。这是正确的。\n当 $R \\to -\\infty$ 时，自变量 $\\frac{\\alpha R}{V_{12}} \\to -\\infty$。此时 $\\text{arccot}(-\\infty) \\to \\pi$。因此，$\\theta(R) \\to \\pi/2$。这也是正确的。\n该函数对于所有 $R$ 都是连续的。在 $R=0$ 处，$\\theta(0) = \\frac{1}{2}\\text{arccot}(0) = \\frac{1}{2}(\\pi/2) = \\pi/4$。\n这个 $\\theta(R)$ 的表达式是满足所有给定约束的唯一连续函数。\n\n最后，问题要求计算绝热能隙 $\\Delta E(R)$，其定义为上绝热能量与下绝热能量之差：\n$$\n\\Delta E(R) = E_{+}(R) - E_{-}(R)\n$$\n代入推导出的 $E_{\\pm}(R)$ 表达式：\n$$\n\\Delta E(R) = \\left(\\sqrt{(\\alpha R)^{2} + V_{12}^{2}}\\right) - \\left(-\\sqrt{(\\alpha R)^{2} + V_{12}^{2}}\\right)\n$$\n$$\n\\Delta E(R) = 2\\sqrt{(\\alpha R)^{2} + V_{12}^{2}}\n$$\n这就是能隙的最终解析表达式。在 $R=0$ 处，能隙达到其最小值 $\\Delta E(0) = 2V_{12}$，这代表了避免交叉的大小。", "answer": "$$\\boxed{2\\sqrt{(\\alpha R)^{2} + V_{12}^{2}}}$$", "id": "2873401"}, {"introduction": "虽然绝热态是定态，但真实分子可以在它们之间发生跃迁，这一过程由非绝热耦合（non-adiabatic coupling, NAC）项 $f_{ij}(R) = \\left\\langle \\Psi_i(R) \\middle| \\frac{\\partial}{\\partial R} \\middle| \\Psi_j(R) \\right\\rangle$ 控制。本练习深入探讨非绝热动力学的理论核心，要求您根据更方便处理的初态哈密顿量矩阵元，推导出一个非绝热耦合的基本表达式。这个推导将揭示两种表象之间的深层联系，并阐明为什么在初态表象中，核动能算符通常被认为是近似对角的。", "problem": "在分子光化学和反应动力学的研究中，区分绝热电子态和透热电子态对于理解在势能面的避免交叉或锥形交叉处发生的过程至关重要。\n\n考虑一个简单的两态量子体系，它由一个依赖于单一核坐标 $R$ 的实对称透热哈密顿矩阵 $H^d(R)$ 描述。假设透热基态 $|\\phi_1\\rangle$ 和 $|\\phi_2\\rangle$ 不依赖于 $R$。透热哈密顿量由下式给出：\n$$\nH^d(R) = \\begin{pmatrix} H^d_{11}(R) & H^d_{12}(R) \\\\ H^d_{21}(R) & H^d_{22}(R) \\end{pmatrix}\n$$\n其中 $H^d_{12}(R) = H^d_{21}(R)$。\n\n相应的绝热态 $|\\Psi_1(R)\\rangle$ 和 $|\\Psi_2(R)\\rangle$ 是该哈密顿量对于每个 $R$ 值的本征态。它们满足定态薛定谔方程：\n$$\nH^d(R) |\\Psi_k(R)\\rangle = E_k(R) |\\Psi_k(R)\\rangle\n$$\n对于 $k=1,2$。绝热势能面是本征值 $E_1(R)$ 和 $E_2(R)$，通常按 $E_1(R) \\le E_2(R)$ 的顺序排列。\n\n这些绝热态之间的跃迁由非绝热耦合 (NAC) 元控制。非对角 NAC 元定义为：\n$$\nf_{12}(R) = \\left\\langle \\Psi_1(R) \\middle| \\frac{\\partial}{\\partial R} \\middle| \\Psi_2(R) \\right\\rangle\n$$\n\n你的任务是仅用透热哈密顿矩阵的矩阵元 $H^d_{ij}(R)$ 及其关于 $R$ 的一阶导数（记作 $\\frac{d H^d_{ij}}{dR}$）来推导非绝热耦合元 $f_{12}(R)$ 的一个通用的闭合形式解析表达式。", "solution": "因为透热基态不依赖于 $R$，所有的非绝热耦合都源于（实对称的）透热哈密顿量 $H^{d}(R)$ 的绝热本征矢对 $R$ 的依赖性。令绝热本征态满足\n$$\nH^{d}(R)\\,|\\Psi_{k}(R)\\rangle=E_{k}(R)\\,|\\Psi_{k}(R)\\rangle,\\quad k=1,2,\\quad E_{1}(R)\\leq E_{2}(R).\n$$\n将 $k=2$ 的本征值方程对 $R$ 求导，并投影到 $\\langle\\Psi_{1}|$ 上：\n$$\n\\langle\\Psi_{1}|\\frac{dH^{d}}{dR}|\\Psi_{2}\\rangle+\\langle\\Psi_{1}|H^{d}\\frac{\\partial}{\\partial R}|\\Psi_{2}\\rangle=\\frac{dE_{2}}{dR}\\langle\\Psi_{1}|\\Psi_{2}\\rangle+E_{2}\\langle\\Psi_{1}|\\frac{\\partial}{\\partial R}|\\Psi_{2}\\rangle.\n$$\n利用正交归一性 $\\langle\\Psi_{1}|\\Psi_{2}\\rangle=0$ 和左本征值关系 $\\langle\\Psi_{1}|H^{d}=E_{1}\\langle\\Psi_{1}|$，上式可化简为类 Hellmann–Feynman 恒等式\n$$\n\\langle\\Psi_{1}|\\frac{dH^{d}}{dR}|\\Psi_{2}\\rangle=(E_{2}-E_{1})\\,\\left\\langle\\Psi_{1}\\middle|\\frac{\\partial}{\\partial R}\\middle|\\Psi_{2}\\right\\rangle=(E_{2}-E_{1})\\,f_{12}(R).\n$$\n因此，\n$$\nf_{12}(R)=\\frac{\\langle\\Psi_{1}|\\frac{dH^{d}}{dR}|\\Psi_{2}\\rangle}{E_{2}-E_{1}}.\n$$\n\n现在，将实对称透热哈密顿量在透热基矢 $\\{|\\phi_{1}\\rangle,|\\phi_{2}\\rangle\\}$ 中写作\n$$\nH^{d}(R)=\\begin{pmatrix}H^{d}_{11}(R)&H^{d}_{12}(R)\\\\ H^{d}_{12}(R)&H^{d}_{22}(R)\\end{pmatrix},\n$$\n并定义如下便于计算的组合\n$$\n\\Delta(R)\\equiv H^{d}_{11}(R)-H^{d}_{22}(R),\\qquad V(R)\\equiv H^{d}_{12}(R).\n$$\n绝热本征矢通过一个以混合角 $\\theta(R)$ 为特征的正交旋转与透热基矢相关联。选择常规的（实数）参数化形式\n$$\n|\\Psi_{1}\\rangle=\\cos\\theta\\,|\\phi_{1}\\rangle-\\sin\\theta\\,|\\phi_{2}\\rangle,\\qquad\n|\\Psi_{2}\\rangle=\\sin\\theta\\,|\\phi_{1}\\rangle+\\cos\\theta\\,|\\phi_{2}\\rangle,\n$$\n对角化条件意味着\n$$\n\\tan\\bigl(2\\theta\\bigr)=-\\frac{2V}{\\Delta},\\qquad E_{2}-E_{1}=D,\\qquad D\\equiv\\sqrt{\\Delta^{2}+4V^{2}},\n$$\n因此\n$$\n\\sin\\bigl(2\\theta\\bigr)=-\\frac{2V}{D},\\qquad \\cos\\bigl(2\\theta\\bigr)=\\frac{\\Delta}{D}.\n$$\n令 $A\\equiv \\frac{dH^{d}}{dR}$，因此在透热基矢中，$A$ 的矩阵元为 $A_{11}=\\frac{dH^{d}_{11}}{dR}$，$A_{22}=\\frac{dH^{d}_{22}}{dR}$，以及 $A_{12}=A_{21}=\\frac{dH^{d}_{12}}{dR}=\\frac{dV}{dR}$。使用上述本征矢参数化形式，并考虑到透热基矢不依赖于 $R$ 的事实，通过直接的矩阵乘法可以得到\n$$\n\\langle\\Psi_{1}|A|\\Psi_{2}\\rangle=\\sin\\theta\\cos\\theta\\left(A_{11}-A_{22}\\right)+\\left(\\cos^{2}\\theta-\\sin^{2}\\theta\\right)A_{12}\n=\\frac{1}{2}\\frac{d\\Delta}{dR}\\,\\sin(2\\theta)+\\frac{dV}{dR}\\,\\cos(2\\theta).\n$$\n将三角关系式和 $E_{2}-E_{1}=D$ 代入 $f_{12}=\\langle\\Psi_{1}|A|\\Psi_{2}\\rangle/(E_{2}-E_{1})$ 得到\n$$\nf_{12}(R)=\\frac{\\frac{1}{2}\\frac{d\\Delta}{dR}\\left(-\\frac{2V}{D}\\right)+\\frac{dV}{dR}\\left(\\frac{\\Delta}{D}\\right)}{D}\n=\\frac{\\Delta\\,\\frac{dV}{dR}-V\\,\\frac{d\\Delta}{dR}}{\\Delta^{2}+4V^{2}}.\n$$\n将 $\\Delta$ 和 $V$ 用透热矩阵元重新表示，即可得出仅以 $H^{d}_{ij}(R)$ 及其一阶导数表示的所需闭合形式表达式：\n$$\nf_{12}(R)=\\frac{\\left(H^{d}_{11}-H^{d}_{22}\\right)\\frac{d H^{d}_{12}}{dR}-H^{d}_{12}\\left(\\frac{d H^{d}_{11}}{dR}-\\frac{d H^{d}_{22}}{dR}\\right)}{\\left(H^{d}_{11}-H^{d}_{22}\\right)^{2}+4\\left(H^{d}_{12}\\right)^{2}}.\n$$\n所有量均在相同的 $R$ 处取值。", "answer": "$$\\boxed{\\frac{\\left(H^{d}_{11}-H^{d}_{22}\\right)\\,\\frac{d H^{d}_{12}}{dR}-H^{d}_{12}\\left(\\frac{d H^{d}_{11}}{dR}-\\frac{d H^{d}_{22}}{dR}\\right)}{\\left(H^{d}_{11}-H^{d}_{22}\\right)^{2}+4\\left(H^{d}_{12}\\right)^{2}}}$$", "id": "1351773"}, {"introduction": "现在，我们将从解析理论转向计算实践，这是理论化学研究生所必需的技能。标准的量子化学程序计算的是绝热态，但对于动力学模拟，通常更倾向于使用具有平滑变化性质的初态基。这个高级练习将指导您实现 Boys 局域化方法，这是一种通过局域化某个性质（如偶极矩）来构建初态基的强大技术，并用它来计算模型体系中的初态耦合。", "problem": "考虑一个 Born–Oppenheimer 框架下的两态电荷转移系统，其中电子哈密顿量参数化地依赖于一个一维核坐标 $R$（例如，碎片间距）。绝热表象由电子哈密顿量 $\\hat{H}_{\\mathrm{el}}(R)$ 的电子本征态 $\\lvert \\Phi_i(R) \\rangle$ 构成，而透热表象通过一个幺正变换与绝热表象相关联。对于一个两态实值子空间，该变换简化为一个角度为 $\\varphi(R)$ 的正交旋转：\n$$\n\\mathbf{R}(\\varphi) \\;=\\;\n\\begin{pmatrix}\n\\cos\\varphi & \\sin\\varphi \\\\\n-\\sin\\varphi & \\cos\\varphi\n\\end{pmatrix},\n$$\n该旋转应用于该子空间中的任何矩阵表示 $\\mathbf{A}$，形式为 $\\mathbf{A}'=\\mathbf{R}(\\varphi)^{\\mathsf{T}} \\mathbf{A}\\,\\mathbf{R}(\\varphi)$。\n\n在 Boys 透热化方法中，选择旋转角 $\\varphi(R)$ 以最小化旋转后基中电子偶极算符各分量的非对角元的平方和。令 $\\boldsymbol{\\mu}^{(A)}$ 表示当前基中电子偶极算符的第 $A$ 个笛卡尔分量（$A \\in \\{x,y,z\\}$）的矩阵。Boys 泛函为\n$$\nF(\\varphi) \\;=\\; \\sum_{A\\in\\{x,y,z\\}} \\left[ \\mu^{(A)}_{12}(\\varphi) \\right]^2,\\quad\n\\text{其中}\\quad \\mu^{(A)}_{12}(\\varphi) \\;=\\; \\left[ \\mathbf{R}(\\varphi)^{\\mathsf{T}} \\,\\boldsymbol{\\mu}^{(A)}\\, \\mathbf{R}(\\varphi) \\right]_{12}.\n$$\n对于一个在绝热基中元素为 $\\mu^{(A)}_{11}$、$\\mu^{(A)}_{22}$ 和 $\\mu^{(A)}_{12}=\\mu^{(A)}_{21}$ 的 $2\\times 2$ 实对称矩阵 $\\boldsymbol{\\mu}^{(A)}$，可以证明\n$$\n\\mu^{(A)}_{12}(\\varphi) \\;=\\; \\alpha_A \\,\\sin(2\\varphi) \\;+\\; \\beta_A \\,\\cos(2\\varphi),\n$$\n其中\n$$\n\\alpha_A \\;=\\; \\frac{\\mu^{(A)}_{11} - \\mu^{(A)}_{22}}{2},\\qquad \\beta_A \\;=\\; \\mu^{(A)}_{12}.\n$$\n\n你的任务是编写一个程序，给定一个源于底层透热哈密顿量和透热偶极矩的绝热态模型，构建绝热偶极矩矩阵，执行 Boys 透热化以获得最小化 $F(\\varphi)$ 的旋转角 $\\varphi(R)$，并计算所得到的透热耦合（Boys 透热基中电子哈密顿量的非对角元）作为几何构型 $R$ 的函数。\n\n使用以下具有物理动机且自洽的模型：\n\n- 在透热基 $\\{\\lvert D\\rangle,\\lvert A\\rangle\\}$ 中的透热哈密顿量：\n$$\n\\mathbf{H}_{\\mathrm{d}}(R) \\;=\\;\n\\begin{pmatrix}\nE_D(R) & V(R) \\\\\nV(R) & E_A(R)\n\\end{pmatrix},\n$$\n其中\n$$\nE_D(R) \\;=\\; s\\,(R-R_0), \\qquad E_A(R) \\;=\\; -s\\,(R-R_0),\n$$\n$$\nV(R) \\;=\\; V_0\\,\\exp\\!\\big(-\\alpha\\,[\\,R-R_0\\,]\\big).\n$$\n\n- 透热电子偶极矩矩阵（单位为基本电荷乘以埃，记为 $\\mathrm{e}\\,\\AA$）：\n$$\n\\boldsymbol{\\mu}^{(x)}_{\\mathrm{d}}(R) \\;=\\;\n\\begin{pmatrix}\n-\\dfrac{Q\\,R}{2} & 0 \\\\\n0 & +\\dfrac{Q\\,R}{2}\n\\end{pmatrix},\\qquad\n\\boldsymbol{\\mu}^{(y)}_{\\mathrm{d}}(R) \\;=\\;\n\\begin{pmatrix}\n0 & \\mu_{\\mathrm{tr}}\\,\\exp(-\\beta R) \\\\\n\\mu_{\\mathrm{tr}}\\,\\exp(-\\beta R) & 0\n\\end{pmatrix},\\qquad\n\\boldsymbol{\\mu}^{(z)}_{\\mathrm{d}}(R) \\;=\\;\n\\begin{pmatrix}\n0 & 0 \\\\\n0 & 0\n\\end{pmatrix}.\n$$\n\n- 绝热表象通过一个旋转 $\\mathbf{R}(\\theta(R))$ 对角化 $\\mathbf{H}_{\\mathrm{d}}(R)$ 得到，使得\n$$\n\\mathbf{R}(\\theta)^{\\mathsf{T}}\\, \\mathbf{H}_{\\mathrm{d}}(R)\\, \\mathbf{R}(\\theta) \\;=\\; \\mathrm{diag}\\!\\left(E_1(R), E_2(R)\\right),\n$$\n其中\n$$\n\\theta(R) \\;=\\; \\tfrac{1}{2}\\,\\mathrm{atan2}\\!\\left(2\\,V(R),\\,E_D(R)-E_A(R)\\right),\n$$\n绝热偶极矩矩阵为\n$$\n\\boldsymbol{\\mu}^{(A)}_{\\mathrm{a}}(R) \\;=\\; \\mathbf{R}(\\theta(R))^{\\mathsf{T}}\\, \\boldsymbol{\\mu}^{(A)}_{\\mathrm{d}}(R)\\, \\mathbf{R}(\\theta(R)).\n$$\n\n- Boys 透热态是通过用最小化 $F(\\varphi)$（如上定义）的旋转矩阵 $\\mathbf{R}(\\varphi(R))$ 旋转绝热基得到的。将 Boys 透热基中得到的哈密顿量记为\n$$\n\\mathbf{H}_{\\mathrm{B}}(R) \\;=\\; \\mathbf{R}(\\varphi(R))^{\\mathsf{T}}\\, \\mathrm{diag}\\!\\left(E_1(R), E_2(R)\\right)\\, \\mathbf{R}(\\varphi(R)).\n$$\n需要报告的透热耦合是非对角元的大小，\n$$\n\\lvert V_{\\mathrm{B}}(R)\\rvert \\;=\\; \\left\\lvert \\left[ \\mathbf{H}_{\\mathrm{B}}(R) \\right]_{12} \\right\\rvert,\n$$\n以电子伏特（$\\mathrm{eV}$）为单位表示。\n\n实现要求：\n\n- 从第一性原理推导，对于两态体系，最小化 $F(\\varphi)$ 所得的角度满足\n$$\n\\tan\\!\\left(4\\varphi\\right) \\;=\\; \\frac{-\\,2\\,\\sum_A \\alpha_A\\,\\beta_A}{\\sum_A \\left(\\alpha_A^2 - \\beta_A^2\\right)},\n$$\n其中 $\\alpha_A$ 和 $\\beta_A$ 由上述绝热偶极矩矩阵计算得出，并选择在一个周期内使 $F(\\varphi)$ 最小的 $\\varphi$ 分支（您可以通过在候选极值点直接计算 $F$ 的值来验证）。\n\n- 角度必须以弧度处理。\n\n- 使用以下固定参数：\n$$\ns \\;=\\; 1.0\\ \\mathrm{eV}/\\AA,\\quad R_0 \\;=\\; 3.0\\ \\AA,\\quad V_0 \\;=\\; 0.2\\ \\mathrm{eV},\\quad \\alpha \\;=\\; 1.0\\ \\AA^{-1},\\\\\nQ \\;=\\; 1.0\\ \\mathrm{e},\\quad \\beta \\;=\\; 0.5\\ \\AA^{-1}.\n$$\n\n测试集：\n\n为以下 4 个测试用例提供结果，每个用例由 $(R,\\ \\mu_{\\mathrm{tr}})$ 指定，其中 $R$ 的单位为埃，$\\mu_{\\mathrm{tr}}$ 的单位为 $\\mathrm{e}\\,\\AA$：\n\n- 用例 1： $(R,\\ \\mu_{\\mathrm{tr}}) = (2.0,\\ 0.05)$。\n- 用例 2： $(R,\\ \\mu_{\\mathrm{tr}}) = (3.0,\\ 0.05)$。\n- 用例 3： $(R,\\ \\mu_{\\mathrm{tr}}) = (5.0,\\ 0.05)$。\n- 用例 4： $(R,\\ \\mu_{\\mathrm{tr}}) = (3.0,\\ 0.0)$。\n\n你的程序必须为每个用例计算 $\\lvert V_{\\mathrm{B}}(R)\\rvert$（单位为 $\\mathrm{eV}$），并生成单行输出，其中包含 4 个结果，形式为方括号括起来的逗号分隔列表，顺序与上述用例相同，每个值四舍五入到恰好 6 位小数。例如，一个可接受的输出格式是\n$$\n\\left[ v_1,\\ v_2,\\ v_3,\\ v_4 \\right],\n$$\n其中，每个 $v_i$ 是一个四舍五入到 6 位小数的浮点数，代表相应测试用例的 $\\lvert V_{\\mathrm{B}}(R)\\rvert$（单位为 $\\mathrm{eV}$）。", "solution": "问题陈述已经过严格验证，并被确定为是合理的。它在科学上植根于理论化学的原理，特别是关于非绝热耦合和透热化方法。该问题提法明确，所有必要的参数、模型和数学定义都已提供。其语言客观且无歧义。该模型虽然简化，但在物理上是自洽的，代表了分子系统中避免交叉的标准范式。因此，将提供一个完整的解决方案。\n\n任务是为一个模型两态系统计算 Boys 透热表象中的透热耦合。该过程涉及不同电子态表象之间的几次变换：从初始透热基到绝热基，随后再到 Boys 透热基。\n\n首先，我们验证 Boys 角 $\\varphi$ 所需的最小化条件。需要最小化的 Boys 泛函由下式给出：\n$$\nF(\\varphi) = \\sum_{A\\in\\{x,y,z\\}} \\left[ \\mu^{(A)}_{12}(\\varphi) \\right]^2\n$$\n其中 $\\mu^{(A)}_{12}(\\varphi)$ 是从绝热基旋转角度 $\\varphi$ 后的基中第 $A$ 个偶极分量矩阵的非对角元。对于一个元素为 $M_{11}, M_{22}, M_{12}$ 的通用 $2 \\times 2$ 实对称矩阵 $\\mathbf{M}$，经 $\\mathbf{R}(\\varphi)$ 旋转后的非对角元为：\n$$\nM_{12}(\\varphi) = \\left[ \\mathbf{R}(\\varphi)^{\\mathsf{T}} \\mathbf{M} \\mathbf{R}(\\varphi) \\right]_{12} = \\frac{M_{11} - M_{22}}{2} \\sin(2\\varphi) + M_{12} \\cos(2\\varphi)\n$$\n问题基于绝热基中的偶极矩矩阵 $\\boldsymbol{\\mu}^{(A)}_{\\mathrm{a}}$ 定义了系数 $\\alpha_A = \\frac{\\mu^{(A)}_{a,11} - \\mu^{(A)}_{a,22}}{2}$ 和 $\\beta_A = \\mu^{(A)}_{a,12}$。因此，$\\mu^{(A)}_{12}(\\varphi) = \\alpha_A \\sin(2\\varphi) + \\beta_A \\cos(2\\varphi)$。\n\n泛函变为：\n$$\nF(\\varphi) = \\sum_{A} \\left( \\alpha_A \\sin(2\\varphi) + \\beta_A \\cos(2\\varphi) \\right)^2 = \\sum_{A} \\left( \\alpha_A^2 \\sin^2(2\\varphi) + \\beta_A^2 \\cos^2(2\\varphi) + 2\\alpha_A\\beta_A \\sin(2\\varphi)\\cos(2\\varphi) \\right)\n$$\n使用三角恒等式 $\\sin^2(x) = (1-\\cos(2x))/2$, $\\cos^2(x) = (1+\\cos(2x))/2$, 以及 $\\sin(x)\\cos(x) = \\sin(2x)/2$，我们将 $F(\\varphi)$ 重写为 $4\\varphi$ 的函数：\n$$\nF(\\varphi) = \\frac{1}{2} \\sum_A (\\alpha_A^2 + \\beta_A^2) + \\frac{1}{2}\\cos(4\\varphi) \\sum_A (\\beta_A^2 - \\alpha_A^2) + \\sin(4\\varphi) \\sum_A (\\alpha_A \\beta_A)\n$$\n为求最小值，我们将关于 $\\varphi$ 的导数设为零：\n$$\n\\frac{dF}{d\\varphi} = -2\\sin(4\\varphi) \\sum_A (\\beta_A^2 - \\alpha_A^2) + 4\\cos(4\\varphi) \\sum_A (\\alpha_A \\beta_A) = 0\n$$\n$$\n2\\sin(4\\varphi) \\sum_A (\\alpha_A^2 - \\beta_A^2) = -4\\cos(4\\varphi) \\sum_A (\\alpha_A \\beta_A)\n$$\n这就给出了极值点所需的条件：\n$$\n\\tan(4\\varphi) = \\frac{-2 \\sum_A \\alpha_A \\beta_A}{\\sum_A (\\alpha_A^2 - \\beta_A^2)}\n$$\n二阶导数检验证实，从 $\\mathrm{atan2}$ 的主值得到的角 $\\varphi$ 对应一个最小值。具体来说，$\\varphi = \\frac{1}{4} \\mathrm{atan2}(Y, X)$，其中 $Y = -2\\sum_A \\alpha_A \\beta_A$，$X = \\sum_A (\\alpha_A^2 - \\beta_A^2)$。\n\n每个测试用例 $(R, \\mu_{\\mathrm{tr}})$ 的计算步骤如下：\n\n1.  **定义模型参数**：\n    $s = 1.0\\ \\mathrm{eV}/\\AA, R_0 = 3.0\\ \\AA, V_0 = 0.2\\ \\mathrm{eV}, \\alpha = 1.0\\ \\AA^{-1}, Q = 1.0\\ \\mathrm{e}, \\beta = 0.5\\ \\AA^{-1}$。\n\n2.  **构建透热哈密顿量 $\\mathbf{H}_{\\mathrm{d}}(R)$**：\n    其元为 $E_D(R) = s(R-R_0)$，$E_A(R) = -s(R-R_0)$，以及 $V(R) = V_0 \\exp(-\\alpha(R-R_0))$。\n\n3.  **确定绝热表象**：\n    对角化 $\\mathbf{H}_{\\mathrm{d}}(R)$。从透热基变换到绝热基的混合角 $\\theta(R)$ 是：\n    $$\n    \\theta(R) = \\frac{1}{2} \\mathrm{atan2}(2V(R), E_D(R) - E_A(R))\n    $$\n    本征值是绝热能量 $E_1(R)$ 和 $E_2(R)$。我们将其排序以使 $E_1 > E_2$。\n    $$\n    E_{1,2}(R) = \\frac{E_D+E_A}{2} \\pm \\sqrt{\\left(\\frac{E_D-E_A}{2}\\right)^2 + V(R)^2} = \\pm \\sqrt{s^2(R-R_0)^2 + V(R)^2}\n    $$\n    所以，$E_1(R) = \\sqrt{s^2(R-R_0)^2 + V(R)^2}$ 且 $E_2(R) = -E_1(R)$。绝热哈密顿量为 $\\mathbf{H}_{\\mathrm{a}} = \\mathrm{diag}(E_1, E_2)$。\n\n4.  **构建透热偶极矩矩阵 $\\boldsymbol{\\mu}^{(A)}_{\\mathrm{d}}(R)$**：\n    这些由问题陈述给出。注意 $\\boldsymbol{\\mu}^{(z)}_{\\mathrm{d}}$ 是零矩阵。\n\n5.  **将偶极矩矩阵变换到绝热基**：\n    绝热偶极矩矩阵通过以下变换计算：\n    $$\n    \\boldsymbol{\\mu}^{(A)}_{\\mathrm{a}}(R) = \\mathbf{R}(\\theta(R))^{\\mathsf{T}} \\boldsymbol{\\mu}^{(A)}_{\\mathrm{d}}(R) \\mathbf{R}(\\theta(R))\n    $$\n    其中 $\\mathbf{R}(\\theta)$ 是旋转矩阵。\n\n6.  **计算 $\\alpha_A$ 和 $\\beta_A$ 系数**：\n    使用计算出的绝热偶极矩矩阵 $\\boldsymbol{\\mu}^{(A)}_{\\mathrm{a}}$ 的元：\n    $$\n    \\alpha_A = \\frac{\\mu^{(A)}_{a,11} - \\mu^{(A)}_{a,22}}{2}, \\quad \\beta_A = \\mu^{(A)}_{a,12}\n    $$\n    对于 $A \\in \\{x, y\\}$。对于 $A=z$，系数为零。\n\n7.  **确定 Boys 透热化角 $\\varphi(R)$**：\n    计算和 $Y = -2\\sum_A \\alpha_A \\beta_A$ 与 $X = \\sum_A (\\alpha_A^2 - \\beta_A^2)$。使 Boys 泛函最小化的角度为：\n    $$\n    \\varphi(R) = \\frac{1}{4} \\mathrm{atan2}(Y, X)\n    $$\n\n8.  **计算 Boys 透热耦合 $\\lvert V_{\\mathrm{B}}(R)\\rvert$**：\n    Boys 透热基中的哈密顿量是通过旋转绝热哈密顿量得到的，即 $\\mathbf{H}_{\\mathrm{B}}(R) = \\mathbf{R}(\\varphi)^{\\mathsf{T}} \\mathbf{H}_{\\mathrm{a}}(R) \\mathbf{R}(\\varphi)$。$\\mathbf{H}_{\\mathrm{B}}$ 的非对角元是耦合 $V_{\\mathrm{B}}(R)$：\n    $$\n    V_{\\mathrm{B}}(R) = [\\mathbf{H}_{\\mathrm{B}}]_{12} = \\frac{E_1(R) - E_2(R)}{2} \\sin(2\\varphi(R))\n    $$\n    所需的结果是其大小 $\\lvert V_{\\mathrm{B}}(R) \\rvert$。\n    代入 $E_1-E_2$：\n    $$\n    \\lvert V_{\\mathrm{B}}(R) \\rvert = \\left\\lvert \\sqrt{s^2(R-R_0)^2 + V(R)^2} \\sin(2\\varphi(R)) \\right\\rvert\n    $$\n对每个给定的测试用例执行此过程。角度 $\\theta+\\varphi$ 表示从初始透热基到最终 Boys 基的总旋转。当 $R$ 远离 $R_0$ 时，$\\theta \\approx 0$，我们期望 $\\varphi \\approx 0$，因此 Boys 耦合 $V_{\\mathrm{B}}$ 应接近原始的透热耦合 $V(R)$。在 $R=R_0$ 且 $\\mu_{\\mathrm{tr}}=0$ 时，初始透热基是电荷定域基，这正是 Boys 透热化方法所寻求的基。在这种情况下，总旋转角 $\\theta+\\varphi$ 应对应于基态的简单置换（$k\\pi/2$），计算出的耦合 $\\lvert V_B \\rvert$ 必须等于初始耦合 $V(R_0)$。数值计算证实了这一物理推理。", "answer": "[0.543656,0.198948,0.027050,0.200000]", "id": "2760838"}]}