{"hands_on_practices": [{"introduction": "VQE 的核心任务是估算能量，这需要测量分子哈密顿量的期望值。该哈密顿量通常表示为泡利串的线性组合。本练习将具体展示如何高效地完成这项测量任务。通过分析一个简单的双量子比特哈密顿量，您将练习区分朴素的测量方案与更精巧的方案，后者基于对量子比特-wise 可交换的算符进行分组，这是最小化 VQE 实验中所需不同量子电路数量的一项关键技术 [@problem_id:2932509]。", "problem": "在变分量子本征求解器（Variational Quantum Eigensolver, VQE）中，参数化量子态 $\\rho(\\boldsymbol{\\theta})$ 关于分子电子哈密顿量 $H$ 的能量，是通过计算泡利算符张量积的期望值之和来求得的。一个测量设置被定义为对每个量子比特上的局域测量轴的单次选择，由张量积 $\\bigotimes_{i=0}^{n-1} P_i$（其中 $P_i \\in \\{X,Y,Z\\}$）指定，并用于单个实验中以收集样本。如果两个泡利串在一个共同的乘积基下同时对角化（逐量子比特对易），那么它们可以从相同的测量设置中同时被估计，这样一个单一的设置通过对同一批比特串进行适当的后处理，就能得出它们所有的期望值。单位算符贡献一个已知的常数，不需要采样。\n\n考虑以下两量子比特哈密顿量\n$$\nH \\;=\\; c_0\\, I \\;+\\; c_1\\, Z_0 \\;+\\; c_2\\, Z_1 \\;+\\; c_3\\, Z_0 Z_1,\n$$\n其中 $c_0, c_1, c_2, c_3 \\in \\mathbb{R}$，$I$ 是两量子比特上的单位算符，$Z_0 = Z \\otimes I$，$Z_1 = I \\otimes Z$，$Z_0 Z_1 = Z \\otimes Z$。\n\n仅使用以下基本原则：\n- 期望值的线性性，$\\langle A + B \\rangle = \\langle A \\rangle + \\langle B \\rangle$。\n- 如果可观测量是逐量子比特对易的（可通过单量子比特基变换对角化），那么这些对易的可观测量可以在一个乘积基测量设置中同时测量。\n- 对于任何量子态，单位项 $I$ 的期望值恒为 $1$，因此不需要测量。\n\n回答以下两部分：\n1) 不分组：假设每个非单位泡利项的期望值都在一个专门的实验中进行估计，并且一次实验的采样数据不会被重复用于估计任何其他项。需要多少个测量设置？\n2) 在逐量子比特对易（QWC）兼容性下分组：将那些可以通过单量子比特旋转同时对角化的泡利串进行聚类，并计算所需的最小测量设置数量。\n\n将您的最终答案表示为一个行矩阵 $\\begin{pmatrix} N_{\\text{no group}} & N_{\\text{QWC group}} \\end{pmatrix}$。无需四舍五入，也无需单位。", "solution": "在尝试解答之前，对问题陈述进行验证。\n\n**步骤1：提取已知条件**\n- 系统由一个两量子比特哈密顿量描述：$H = c_0\\, I + c_1\\, Z_0 + c_2\\, Z_1 + c_3\\, Z_0 Z_1$，其中 $c_0, c_1, c_2, c_3 \\in \\mathbb{R}$。\n- 泡利算符定义为：$Z_0 = Z \\otimes I$，$Z_1 = I \\otimes Z$，$Z_0 Z_1 = Z \\otimes Z$。\n- 测量设置是一个张量积 $\\bigotimes_{i=0}^{n-1} P_i$，其中 $P_i \\in \\{X,Y,Z\\}$。\n- 提供的基本原则：\n    1. 期望值的线性性：$\\langle A + B \\rangle = \\langle A \\rangle + \\langle B \\rangle$。\n    2. 分组条件：如果泡利串是逐量子比特对易（QWC）的，即它们在一个共同的乘积基下同时对角化，那么它们就可以同时被估计。\n    3. 单位项：$\\langle I \\rangle = 1$ 且无需测量。\n- 任务是找出在两种情况下所需的测量设置数量：\n    1. 第1部分 ($N_{\\text{no group}}$)：每个非单位项都在一个专门的实验中测量。\n    2. 第2部分 ($N_{\\text{QWC group}}$)：如果泡利项是QWC兼容的，则将它们分组。\n\n**步骤2：使用提取的已知条件进行验证**\n- **科学依据充分：** 该问题基于变分量子本征求解器（VQE）算法的标准表述，这是近期量子计算在量子化学领域的基石之一。泡利串、测量设置以及用于测量简化的逐量子比特对易分组等概念，在量子信息论中都是基础且事实正确的。\n- **问题适定：** 哈密顿量定义清晰。问题两个部分计算测量设置的规则都是明确无歧义的。问题结构设计旨在为每个部分得出唯一的数值答案。\n- **客观性：** 问题以精确、技术性的语言陈述，没有主观性或模糊性。\n\n**步骤3：结论与行动**\n该问题科学上可靠，问题适定，客观且内部一致。它没有违反任何无效标准。因此，该问题被视为**有效的**。将提供解答。\n\n**解答**\n\n目标是确定估计哈密顿量 $H = c_0\\, I + c_1\\, Z_0 + c_2\\, Z_1 + c_3\\, Z_0 Z_1$ 期望值所需的最小测量设置数量。其期望值由 $\\langle H \\rangle = c_0 \\langle I \\rangle + c_1 \\langle Z_0 \\rangle + c_2 \\langle Z_1 \\rangle + c_3 \\langle Z_0 Z_1 \\rangle$ 给出。\n\n如问题所述，单位项 $c_0 I$ 对能量的贡献是一个常数值 $c_0$，因为对于任何量子态，$\\langle I \\rangle = 1$。此项无需实验测量。因此，我们只需考虑哈密顿量中的非单位泡利串，它们是：\n- $P^{(1)} = Z_0 = Z \\otimes I$\n- $P^{(2)} = Z_1 = I \\otimes Z$\n- $P^{(3)} = Z_0 Z_1 = Z \\otimes Z$\n\n共有 $3$ 个这样的非单位项。\n\n**第1部分：不分组 ($N_{\\text{no group}}$)**\n在这种情况下，每个非单位泡利项的期望值都在一个专门的实验中进行估计。这意味着一次实验的数据不能被重复用于估计另一项的期望值。\n需要测量的项是 $\\langle Z_0 \\rangle$、$\\langle Z_1 \\rangle$ 和 $\\langle Z_0 Z_1 \\rangle$。\n根据本部分问题的明确规则，我们需要：\n- 一个实验（设置）来测量 $\\langle Z_0 \\rangle$。\n- 一个实验（设置）来测量 $\\langle Z_1 \\rangle$。\n- 一个实验（设置）来测量 $\\langle Z_0 Z_1 \\rangle$。\n\n因此，所需的测量设置总数等于非单位泡利项的数量。\n$$\nN_{\\text{no group}} = 3\n$$\n\n**第2部分：在逐量子比特对易（QWC）兼容性下分组 ($N_{\\text{QWC group}}$)**\n在这种情况下，我们将逐量子比特对易的泡利串分组。两个泡利串 $P = \\bigotimes_{i=0}^{n-1} P_i$ 和 $Q = \\bigotimes_{i=0}^{n-1} Q_i$ 是逐量子比特对易的，如果对于所有量子比特索引 $i$ 都有 $[P_i, Q_i] = 0$，其中 $[A,B]=AB-BA$ 是对易子。对于泡利矩阵，此条件简化为 $P_i$ 和 $Q_i$ 是相同的算符，或者其中一个是单位算符 $I$。\n\n让我们检查非单位泡利串的集合：$\\{P^{(1)}, P^{(2)}, P^{(3)}\\} = \\{Z \\otimes I, I \\otimes Z, Z \\otimes Z\\}$。\n我们通过检查每个量子比特位置上的泡利算符来检验整个集合的逐量子比特对易性。\n\n- 对于量子比特0（第一个量子比特），算符为 $\\{Z, I, Z\\}$。此集合中的泡利算符要么是 $I$ 要么是 $Z$。由于 $[Z, I] = 0$ 和 $[Z, Z] = 0$，此位置上的所有算符都相互对易。\n\n- 对于量子比特1（第二个量子比特），算符为 $\\{I, Z, Z\\}$。同样，此集合中的泡利算符要么是 $I$ 要么是 $Z$。由于 $[I, Z] = 0$ 和 $[Z, Z] = 0$，此位置上的所有算符也相互对易。\n\n由于集合 $\\{P^{(1)}, P^{(2)}, P^{(3)}\\}$ 中所有串对的算符在逐量子比特的基础上都是对易的，因此整个集合是相互逐量子比特对易的。因此，所有三个泡利串都可以在一个单一的测量组中同时测量。\n\n这个单一的组需要一个与所有成员串都兼容的测量设置。为了测量在量子比特 $i$ 上包含非单位算符 $P_i \\in \\{X, Y, Z\\}$ 的泡利串，必须在 $P_i$ 的本征基中测量量子比特 $i$。\n- 为了测量 $P^{(1)} = Z \\otimes I$，我们必须在 $Z$ 基中测量量子比特0。\n- 为了测量 $P^{(2)} = I \\otimes Z$，我们必须在 $Z$ 基中测量量子比特1。\n- 为了测量 $P^{(3)} = Z \\otimes Z$，我们必须在 $Z$ 基中测量量子比特0和量子比特1。\n\n所有这三个要求都可以通过一个单一的测量设置来满足：在 $Z$ 基中同时测量量子比特0和量子比特1。这对应于由算符 $Z \\otimes Z$ 定义的测量设置。通过从这个单一实验中收集统计数据，可以计算出所有三个期望值 $\\langle Z_0 \\rangle$、$\\langle Z_1 \\rangle$ 和 $\\langle Z_0 Z_1 \\rangle$。\n\n因此，当使用QWC分组时，只需要一个测量设置。\n$$\nN_{\\text{QWC group}} = 1\n$$\n\n最终答案应表示为行矩阵 $\\begin{pmatrix} N_{\\text{no group}} & N_{\\text{QWC group}} \\end{pmatrix}$。\n代入导出的值，我们得到 $\\begin{pmatrix} 3 & 1 \\end{pmatrix}$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n3 & 1\n\\end{pmatrix}\n}\n$$", "id": "2932509"}, {"introduction": "将泡利项分组到可同时测量的集合中后，一个新的问题随之出现：我们应如何在我们有限的测量“次数”预算中分配这些测量任务？以最优方式回答这个问题是最小化最终能量估算中统计不确定性的关键。本练习将引导您使用拉格朗日乘子法进行第一性原理推导，以找到最佳的测量次数分配方案，从而揭示分配策略如何依赖于哈密顿量系数和每个泡利项的方差 [@problem_id:2932482]。", "problem": "在变分量子本征求解器（VQE）中，分子电子哈密顿量被分解为张量积形式的泡利算符的加权和，$H=\\sum_{i=1}^{m} c_{i} P_{i}$，其中每个 $P_{i}$ 是一个厄米泡利算符串，其本征值为 $\\pm 1$，且 $c_{i} \\in \\mathbb{R}$。假设您通过对准备好的拟设态分别测量每个 $P_{i}$ 来估计基态能量，使用 $N_{i}$ 次独立的投影测量（shots）来形成 $\\langle P_{i} \\rangle$ 的样本均值 $\\widehat{\\mu}_{i}$，然后构造无偏能量估计量 $\\widehat{E}=\\sum_{i=1}^{m} c_{i} \\widehat{\\mu}_{i}$。假定以下基本事实：\n- 对于一个在所准备的量子态下其方差为 $\\mathrm{Var}(P_{i})$ 的可观测量，其来自 $N_{i}$ 次独立同分布测量的样本均值的方差为 $\\mathrm{Var}(\\widehat{\\mu}_{i})=\\mathrm{Var}(P_{i})/N_{i}$。\n- 用于估计不同 $\\widehat{\\mu}_{i}$ 的测量是独立进行的，因此对于 $i \\neq j$，$\\widehat{\\mu}_{i}$ 和 $\\widehat{\\mu}_{j}$ 之间的协方差为零。\n\n给定一个固定的总测量预算 $N_{\\mathrm{tot}}$，使得 $\\sum_{i=1}^{m} N_{i}=N_{\\mathrm{tot}}$ 且 $N_{i} \\ge 0$。使用拉格朗日乘数法，从第一性原理出发，推导在预算约束下最小化总能量估计量方差 $\\mathrm{Var}(\\widehat{E})$ 的唯一分配方案 $N_{i}^{\\star}$。请将您的最终结果表示为关于 $N_{\\mathrm{tot}}$、$\\{c_{i}\\}$ 和 $\\{\\mathrm{Var}(P_{i})\\}$ 的单一闭式解析表达式。然后，简要解释在 VQE 迭代运行期间，如何在不存储完整历史结果的情况下，从每个 $P_{i}$ 的流式 $\\pm 1$ 测量结果中实时估计 $\\mathrm{Var}(P_{i})$。\n\n您的最终答案必须仅为 $N_{i}^{\\star}$ 的解析表达式。请勿在最终答案框中包含任何讨论或单位。", "solution": "在尝试任何解决方案之前，需对问题陈述进行验证。\n\n**步骤1：提取已知条件**\n- 分子电子哈密顿量由 $H=\\sum_{i=1}^{m} c_{i} P_{i}$ 给出。\n- 每个 $P_{i}$ 是一个厄米泡利算符串，其本征值为 $\\pm 1$。\n- 系数 $c_{i}$ 是实数，$c_{i} \\in \\mathbb{R}$。\n- 基态能量估计量为 $\\widehat{E}=\\sum_{i=1}^{m} c_{i} \\widehat{\\mu}_{i}$，其中 $\\widehat{\\mu}_{i}$ 是通过 $N_{i}$ 次独立测量得到的 $\\langle P_{i} \\rangle$ 的样本均值。\n- 样本均值的方差为 $\\mathrm{Var}(\\widehat{\\mu}_{i})=\\mathrm{Var}(P_{i})/N_{i}$。\n- 对不同泡利项的测量是独立的，因此当 $i \\neq j$ 时，$\\mathrm{Cov}(\\widehat{\\mu}_{i}, \\widehat{\\mu}_{j}) = 0$。\n- 总测量预算是固定的：$\\sum_{i=1}^{m} N_{i}=N_{\\mathrm{tot}}$，且 $N_{i} \\ge 0$。\n\n**步骤2：使用提取的已知条件进行验证**\n- **科学依据**：该问题很好地基于量子力学和统计估计理论的原理，并应用于变分量子本征求解器（VQE）算法。将哈密顿量表示为泡利算符串之和以及估计其期望值的统计方法是量子计算领域的标准做法。\n- **良定性**：该问题是一个经典的约束优化任务。它要求在满足一个线性约束的条件下，最小化一个明确定义的目标函数 $\\mathrm{Var}(\\widehat{E})$。其结构表明可以使用拉格朗日乘数法找到唯一解。\n- **客观性**：语言精确、技术性强，没有主观或含糊的术语。所有术语在量子化学和信息论中都是标准的。\n\n**步骤3：结论与行动**\n该问题在科学上是有效的、良定的和客观的。它不包含矛盾、歧义或事实错误。因此，将推导一个正式的解。\n\n目标是在总测量次数 $N_{\\mathrm{tot}}$ 的约束下，最小化能量估计量的方差 $\\mathrm{Var}(\\widehat{E})$。\n\n首先，我们将目标函数 $\\mathrm{Var}(\\widehat{E})$ 用变量 $N_{i}$ 表示。能量的估计量是 $\\widehat{E} = \\sum_{i=1}^{m} c_{i} \\widehat{\\mu}_{i}$。由于对不同泡利项的测量是独立的，这个和的方差是各项方差的和：\n$$\n\\mathrm{Var}(\\widehat{E}) = \\mathrm{Var}\\left(\\sum_{i=1}^{m} c_{i} \\widehat{\\mu}_{i}\\right) = \\sum_{i=1}^{m} \\mathrm{Var}(c_{i} \\widehat{\\mu}_{i})\n$$\n使用性质 $\\mathrm{Var}(aX) = a^2 \\mathrm{Var}(X)$，其中 $a$ 是常数，我们有：\n$$\n\\mathrm{Var}(\\widehat{E}) = \\sum_{i=1}^{m} c_{i}^2 \\mathrm{Var}(\\widehat{\\mu}_{i})\n$$\n代入给定的关系式 $\\mathrm{Var}(\\widehat{\\mu}_{i}) = \\mathrm{Var}(P_{i})/N_{i}$：\n$$\n\\mathrm{Var}(\\widehat{E}) = \\sum_{i=1}^{m} \\frac{c_{i}^2 \\mathrm{Var}(P_{i})}{N_{i}}\n$$\n这是需要最小化的函数。优化是针对分配 $\\{N_{i}\\}_{i=1}^{m}$ 进行的，我们将其视为连续的正实数变量。约束条件是固定的总测量次数：\n$$\n\\sum_{i=1}^{m} N_{i} = N_{\\mathrm{tot}}\n$$\n我们采用拉格朗日乘数法。构造拉格朗日函数 $\\mathcal{L}$：\n$$\n\\mathcal{L}(\\{N_i\\}, \\lambda) = \\sum_{i=1}^{m} \\frac{c_{i}^2 \\mathrm{Var}(P_{i})}{N_{i}} - \\lambda \\left(\\sum_{i=1}^{m} N_{i} - N_{\\mathrm{tot}}\\right)\n$$\n为了找到驻点，我们将 $\\mathcal{L}$ 对每个 $N_{k}$（其中 $k = 1, \\dots, m$）和 $\\lambda$ 的偏导数设为零。\n$$\n\\frac{\\partial \\mathcal{L}}{\\partial N_{k}} = -\\frac{c_{k}^2 \\mathrm{Var}(P_{k})}{N_{k}^2} - \\lambda = 0\n$$\n$$\n\\frac{\\partial \\mathcal{L}}{\\partial \\lambda} = -\\left(\\sum_{k=1}^{m} N_{k} - N_{\\mathrm{tot}}\\right) = 0\n$$\n从第一个方程，我们解出 $N_k$：\n$$\n\\frac{c_{k}^2 \\mathrm{Var}(P_{k})}{N_{k}^2} = -\\lambda\n$$\n因为 $N_{k}^2 > 0$，$c_k^2 \\ge 0$，且 $\\mathrm{Var}(P_k) \\ge 0$，所以必然有 $\\lambda \\le 0$。我们可以解出 $N_k$（取正根，因为 $N_k$ 代表测量次数）：\n$$\nN_{k} = \\frac{|c_k|\\sqrt{\\mathrm{Var}(P_k)}}{\\sqrt{-\\lambda}}\n$$\n现在，我们使用约束方程来确定拉格朗日乘子 $\\lambda$。\n$$\n\\sum_{k=1}^{m} N_{k} = \\sum_{k=1}^{m} \\frac{|c_k|\\sqrt{\\mathrm{Var}(P_k)}}{\\sqrt{-\\lambda}} = N_{\\mathrm{tot}}\n$$\n将含有 $\\lambda$ 的项因子分解出来：\n$$\n\\frac{1}{\\sqrt{-\\lambda}} \\sum_{k=1}^{m} |c_k|\\sqrt{\\mathrm{Var}(P_k)} = N_{\\mathrm{tot}}\n$$\n解出 $1/\\sqrt{-\\lambda}$：\n$$\n\\frac{1}{\\sqrt{-\\lambda}} = \\frac{N_{\\mathrm{tot}}}{\\sum_{j=1}^{m} |c_j|\\sqrt{\\mathrm{Var}(P_j)}}\n$$\n最后，我们将此表达式代回 $N_k$ 的方程中，以找到最优分配，我们将其表示为 $N_{k}^{\\star}$：\n$$\nN_{k}^{\\star} = |c_k|\\sqrt{\\mathrm{Var}(P_k)} \\cdot \\left( \\frac{N_{\\mathrm{tot}}}{\\sum_{j=1}^{m} |c_j|\\sqrt{\\mathrm{Var}(P_j)}} \\right)\n$$\n按照问题陈述的要求，使用索引 $i$ 重写：\n$$\nN_{i}^{\\star} = N_{\\mathrm{tot}} \\frac{|c_i|\\sqrt{\\mathrm{Var}(P_i)}}{\\sum_{j=1}^{m} |c_j|\\sqrt{\\mathrm{Var}(P_j)}}\n$$\n该表达式为测量每个泡利项 $P_i$ 的最优测量次数 $N_{i}^{\\star}$，以便在总测量次数 $N_{\\mathrm{tot}}$ 固定的情况下，最小化能量估计的总统计误差。\n\n关于问题的第二部分，即如何实时估计 $\\mathrm{Var}(P_i)$：\n对于给定的量子态，可观测量 $P_i$ 的方差定义为 $\\mathrm{Var}(P_i) = \\langle P_i^2 \\rangle - \\langle P_i \\rangle^2$。因为每个 $P_i$ 都是泡利算符串，其组成算符（泡利矩阵）的平方等于单位矩阵。因此，$P_i^2 = I$，即单位算符。这意味着 $\\langle P_i^2 \\rangle = \\langle I \\rangle = 1$。因此，真实方差为 $\\mathrm{Var}(P_i) = 1 - \\langle P_i \\rangle^2$。要估计这个量，我们只需要估计均值 $\\langle P_i \\rangle$。\n\n设 $P_i$ 的 $k$ 次测量结果序列为 $o_1, o_2, \\dots, o_k$，其中每个 $o_j \\in \\{-1, 1\\}$。$k$ 次测量后的样本均值为 $\\widehat{\\mu}_{i,k} = \\frac{1}{k}\\sum_{j=1}^{k} o_j$。当新的结果到来时，可以递归地更新这个样本均值，而无需存储整个历史记录。如果 $\\widehat{\\mu}_{i,k}$ 是 $k$ 个结果后的均值，并且测量到一个新的结果 $o_{k+1}$，则新的均值 $\\widehat{\\mu}_{i,k+1}$ 为：\n$$\n\\widehat{\\mu}_{i,k+1} = \\frac{k\\widehat{\\mu}_{i,k} + o_{k+1}}{k+1} = \\widehat{\\mu}_{i,k} + \\frac{o_{k+1} - \\widehat{\\mu}_{i,k}}{k+1}\n$$\n这个更新规则只需要存储当前的均值 $\\widehat{\\mu}_{i,k}$ 和测量次数 $k$。在 VQE 迭代的每一步，都可以使用此公式更新每个 $P_i$ 的均值估计。然后，方差可以简单地估计为 $\\widehat{\\mathrm{Var}}(P_i) = 1 - (\\widehat{\\mu}_{i,k+1})^2$。这些更新后的方差估计值随后可用于 $N_{i}^{\\star}$ 的公式中，以自适应地为下一次 VQE 迭代重新分配测量预算。", "answer": "$$\\boxed{N_{\\mathrm{tot}} \\frac{|c_i| \\sqrt{\\mathrm{Var}(P_i)}}{\\sum_{j=1}^{m} |c_j| \\sqrt{\\mathrm{Var}(P_j)}}}$$", "id": "2932482"}, {"introduction": "VQE 的“变分”特性涉及一个优化过程，而计算能量相对于拟设参数的梯度对此至关重要。参数偏移法是在量子计算机上解析计算这些梯度的一种巧妙方法，但其适用性并非普遍。本练习挑战您分析 UCCSD 拟设中常见门的生成元，识别标准的两点参数偏移法何时失效，并探索在这些更复杂的情况下获得无偏梯度的先进策略 [@problem_id:2932516]。", "problem": "在用于量子化学的变分量子本征求解器 (VQE) 中，一个常见的拟设是酉耦合簇单双重激发 (UCCSD) 拟设。考虑一个能量函数，其形式为 $E(\\boldsymbol{\\theta}) = \\langle \\psi_{0} | U(\\boldsymbol{\\theta})^{\\dagger} H U(\\boldsymbol{\\theta}) | \\psi_{0} \\rangle$，其中 $U(\\boldsymbol{\\theta})$ 是一系列参数化酉算符的乘积。对于具有厄米生成元 $G_{\\ell}$ 的单个参数化门 $U_{\\ell}(\\theta_{\\ell}) = e^{-i \\theta_{\\ell} G_{\\ell}}$，只有在 $G_{\\ell}$ 满足特定谱条件的情况下，才存在具有 $2$ 个评估点的精确参数平移梯度法则。在实践中，经过诸如 Jordan–Wigner 这样的费米子到量子比特的映射后，UCCSD 层可以通过不同级别的编译或 Trotter 化，以几种等效形式实现。考虑以下代表性的门系列：\n- 单激发交换门，直接实现为 $U_{\\mathrm{ex}}(\\theta) = \\exp\\!\\big[-i \\theta \\, G_{pq}\\big]$，其中 $G_{pq} = \\tfrac{1}{2}\\big(X_{p} X_{q} + Y_{p} Y_{q}\\big)$ 作用于量子比特 $p$ 和 $q$。\n- 未 Trotter 化的双激发门，直接实现为 $U_{\\mathrm{d}}(\\theta) = \\exp\\!\\big[-i \\theta \\, G_{pq}^{rs}\\big]$，其中 $G_{pq}^{rs}$ 是反厄米费米子算符 $(a_{p}^{\\dagger} a_{q}^{\\dagger} a_{s} a_{r} - a_{r}^{\\dagger} a_{s}^{\\dagger} a_{q} a_{p})$ 经量子比特映射后的像；经过 Jordan–Wigner 映射后，$G_{pq}^{rs}$ 是一系列具有实系数的非对易泡利词之和。\n- 对于给定激发，使用固定顺序的一阶 Trotter 积，$U_{\\mathrm{Trot}}(\\theta) = \\prod_{k=1}^{K} \\exp\\!\\big(-i \\theta \\, c_{k} P_{k}\\big)$，其中每个 $P_{k}$ 是一个泡利词，$c_{k} \\in \\mathbb{R}$，且 $K \\in \\mathbb{N}$。\n- 单个泡利旋转，$U_{P}(\\theta) = \\exp\\!\\big(-i \\theta \\, P\\big)$，其中 $P^{2} = I$。\n\n为了在含 UCCSD 的 VQE 中进行无偏梯度估计，以下哪些陈述正确地指出了其生成元不允许精确的 $2$ 点参数平移法则的门系列，并同时提出了基于酉算符线性组合 (LCU) 范式或辅助量子比特辅助干涉的有效策略来获得无偏梯度？\n\nA. 粒子数守恒的交换门 $U_{\\mathrm{ex}}(\\theta)$ 的生成元 $G_{pq}$ 的谱包含超过 $2$ 个不同的本征值，因此精确的 $2$ 点参数平移法则不适用。可以通过使用广义多点参数平移（实现为对有限参数平移集的 LCU）或通过一个辅助量子比特辅助电路来获得无偏梯度，该电路相干地实现平移酉算符的线性组合并通过干涉它们来提取导数。\n\nB. 单个泡利旋转 $U_{P}(\\theta)$ 不允许 $2$ 点参数平移法则，因此需要一种基于辅助量子比特的方法来获得无偏梯度。\n\nC. 未 Trotter 化的双激发门 $U_{\\mathrm{d}}(\\theta)$ 的生成元 $G_{pq}^{rs}$ 是一系列非对易泡利词之和，因此不允许 $2$ 点参数平移法则。无偏梯度可以通过从与 $G_{pq}^{rs}$ 全谱相关的广义参数平移法则导出的 LCU 估计量（实现为对具有平移参数的电路的有限加权和）获得，或者通过辅助量子比特辅助的 Hadamard 测试结构获得，该结构对 $G_{pq}^{rs}$ 进行块编码并测量对易子对能量梯度的贡献。\n\nD. 任何如上定义的一阶 Trotter 积 $U_{\\mathrm{Trot}}(\\theta)$ 都会自动违反 $2$ 点参数平移属性，因此对于此类编译的 UCCSD 电路，精确的参数平移梯度是不可能获得的。\n\nE. 对一个形式为 $U_{\\mathrm{d}}(\\theta)$ 的门添加一个控制辅助量子比特，会普适地使得 $2$ 点参数平移法则适用，而与其生成元的谱无关。\n\n选择所有正确的陈述。", "solution": "问题陈述已被评估并被确定为有效。它具有科学依据、问题良定，并包含足够的信息来对选项中提出的主张进行严格分析。\n\n问题的核心在于期望值梯度 $\\nabla_{\\boldsymbol{\\theta}} E(\\boldsymbol{\\theta})$ 的计算，其中 $E(\\boldsymbol{\\theta}) = \\langle \\psi_{0} | U(\\boldsymbol{\\theta})^{\\dagger} H U(\\boldsymbol{\\theta}) | \\psi_{0} \\rangle$。对于门 $U_{\\ell}(\\theta_{\\ell}) = e^{-i \\theta_{\\ell} G_{\\ell}}$ 中的单个参数 $\\theta_{\\ell}$，其偏导数为：\n$$\n\\frac{\\partial E}{\\partial \\theta_{\\ell}} = i \\langle \\psi(\\boldsymbol{\\theta}) | [G_{\\ell}, H] | \\psi(\\boldsymbol{\\theta}) \\rangle\n$$\n其中 $|\\psi(\\boldsymbol{\\theta})\\rangle = U(\\boldsymbol{\\theta})|\\psi_0\\rangle$。直接测量这个对易子通常是不切实际的。参数平移法则提供了一种替代方法，它将此导数表示为同一可观测量 $H$ 的期望值的线性组合，但参数经过了平移。\n\n具有 $M$ 个不同本征值集合 $\\{\\lambda_j\\}_{j=1}^M$ 的一般生成元 $G$ 具有相应的广义参数平移法则，该法则至少需要 $M$ 个评估点（对于实值函数，通常需要 $2M$ 或更多）。非常理想的**2点参数平移法则**是仅使用两次电路评估即可获得梯度的精确解析表达式。其存在的充分条件是生成元 $G_{\\ell}$ 只有两个唯一的本征值。一种常见的情况是这两个本征值为 $\\pm r$（对于某个 $r > 0$）。在这种情况下，该法则的形式为：\n$$\n\\frac{\\partial E}{\\partial \\theta_{\\ell}} = r \\left( E\\left(\\theta_{\\ell} + \\frac{\\pi}{4r}\\right) - E\\left(\\theta_{\\ell} - \\frac{\\pi}{4r}\\right) \\right)\n$$\n如果不满足此条件，则需要使用替代方法进行无偏梯度估计。这些方法包括：\n1.  **广义参数平移法则**：这适用于任何具有已知、有限本征值谱的生成元。它将梯度表示为多个平移参数期望值的线性组合，即 $\\frac{\\partial E}{\\partial \\theta_{\\ell}} = \\sum_k c_k E(\\theta_{\\ell} + s_k)$。这可以看作是酉算符线性组合 (LCU) 范式的一个实例。\n2.  **辅助量子比特辅助方法**：这些技术，例如 Hadamard 测试，使用一个辅助量子比特来使不同的量子操作发生干涉，从而可以直接测量像 $\\operatorname{Re}\\langle\\psi|A^\\dagger B|\\psi\\rangle$ 或 $\\operatorname{Im}\\langle\\psi|A^\\dagger B|\\psi\\rangle$ 这样的量。通过将梯度表示为这样的量（例如，与对易子相关），可以构建一个基于辅助量子比特的电路来估计它，而无需知道生成元的谱特性。\n\n我们现在将分析问题陈述中描述的每个门系列。\n\n- **单个泡利旋转, $U_{P}(\\theta) = \\exp(-i \\theta P)$**：生成元是泡利词 $P$。根据定义，$P$ 是厄米算符且 $P^2 = I$。因此其本征值被限制在 $\\{-1, +1\\}$。由于正好有两个不同的本征值，2点参数平移法则是适用的。\n\n- **单激发交换门, $U_{\\mathrm{ex}}(\\theta) = \\exp(-i \\theta G_{pq})$**：生成元是 $G_{pq} = \\frac{1}{2}(X_p X_q + Y_p Y_q)$。该算符作用于两个量子比特的希尔伯特空间上。在计算基 $\\{|00\\rangle, |01\\rangle, |10\\rangle, |11\\rangle\\}$ 下，其矩阵表示为：\n$$\nG_{pq} = \\frac{1}{2} \\left[ \\begin{pmatrix} 0 & 0 & 0 & 1 \\\\ 0 & 0 & 1 & 0 \\\\ 0 & 1 & 0 & 0 \\\\ 1 & 0 & 0 & 0 \\end{pmatrix} + \\begin{pmatrix} 0 & 0 & 0 & -1 \\\\ 0 & 0 & 1 & 0 \\\\ 0 & 1 & 0 & 0 \\\\ -1 & 0 & 0 & 0 \\end{pmatrix} \\right] = \\begin{pmatrix} 0 & 0 & 0 & 0 \\\\ 0 & 0 & 1 & 0 \\\\ 0 & 1 & 0 & 0 \\\\ 0 & 0 & 0 & 0 \\end{pmatrix}\n$$\n该矩阵的本征值是特征方程 $\\det(G_{pq} - \\lambda I) = \\lambda^2(\\lambda^2 - 1) = 0$ 的根。因此，本征值为 $\\{0, 0, 1, -1\\}$。不同的本征值集合为 $\\{-1, 0, 1\\}$。因为有三个不同的本征值，所以2点参数平移法则不适用。\n\n- **未 Trotter 化的双激发门, $U_{\\mathrm{d}}(\\theta) = \\exp(-i \\theta G_{pq}^{rs})$**：生成元 $G_{pq}^{rs}$ 是从费米子双激发算符 $a_{p}^{\\dagger} a_{q}^{\\dagger} a_{s} a_{r} - \\text{h.c.}$ 经过诸如 Jordan–Wigner 的费米子到量子比特映射后得到的。单个这样的项会映射为具有实系数的多个非对易泡利词的线性组合。一个非对易算符的通用线性组合通常不具有仅含两个本征值的简单谱。因此，2点参数平移法则通常不适用于这些门。\n\n- **一阶 Trotter 积, $U_{\\mathrm{Trot}}(\\theta) = \\prod_{k=1}^{K} \\exp(-i \\theta c_k P_k)$**：这个酉算符是一系列指数的乘积，其中参数 $\\theta$ 与每个指数相耦合。它不具有单个简单生成元 $G$ 的 $\\exp(-i\\theta G)$ 形式。其导数必须使用乘法法则计算：\n$$\n\\frac{\\partial U_{\\mathrm{Trot}}}{\\partial \\theta} = \\sum_{j=1}^{K} \\left( \\prod_{k=1}^{j-1} e^{-i\\theta c_k P_k} \\right) \\left( -i c_j P_j e^{-i\\theta c_j P_j} \\right) \\left( \\prod_{k=j+1}^{K} e^{-i\\theta c_k P_k} \\right)\n$$\n这导致梯度的形式为 $\\frac{\\partial E}{\\partial \\theta} = \\sum_{k=1}^{K} c_k \\frac{\\partial E}{\\partial \\phi_k}\\big|_{\\phi_k=\\theta c_k}$，其中 $\\phi_k$ 是乘积中第 $k$ 个门的参数。每一项 $\\frac{\\partial E}{\\partial \\phi_k}$ 都对应于一个生成元为 $P_k$ 的门，对此门适用2点参数平移法则。因此，总梯度是精确的，并且可以计算为 $K$ 项之和，每一项都通过2点平移获得。电路评估的总次数将是 $2K$。\n\n我们现在开始评估每个选项。\n\n**选项 A**：\n该陈述声称交换门 $U_{\\mathrm{ex}}(\\theta)$ 的生成元 $G_{pq}$ 具有超过2个不同的本征值，从而使2点参数平移法则无效。我们的分析表明，不同的本征值为 $\\{-1, 0, 1\\}$，这证实了这一说法。该陈述接着提出，可以通过广义多点参数平移法则（一种 LCU 方法）或通过辅助量子比特辅助的干涉电路来获得无偏梯度。当2点法则不适用时，这两种方法都是计算梯度的有效且标准的先进技术。\n**结论：正确**\n\n**选项 B**：\n该陈述声称单个泡利旋转 $U_P(\\theta)$ 不允许2点参数平移法则。这根本上是错误的。其生成元是一个泡利词 $P$，本征值为 $\\{-1, 1\\}$，这是适用2点法则的典型情况。该陈述的前提是错误的。\n**结论：不正确**\n\n**选项 C**：\n该陈述断言，未 Trotter 化的双激发门 $U_{\\mathrm{d}}(\\theta)$ 的生成元 $G_{pq}^{rs}$ 是一系列非对易泡利词之和，因此不允许2点参数平移法则。这是正确的，因为这类生成元通常具有包含两个以上不同本征值的复杂谱。该陈述接着提出了两种获得无偏梯度的有效方法：广义参数平移法则（一种基于生成元谱的 LCU 估计量）和辅助量子比特辅助的 Hadamard 测试结构。后者是测量对易子或实现 LCU 的通用方法，确实是一种有效的策略。两种提议的解决方案都是正确的。\n**结论：正确**\n\n**选项 D**：\n该陈述声称，对于 Trotter 积 $U_{\\mathrm{Trot}}(\\theta)$，2点参数平移属性被违反，并且“精确的参数平移梯度是不可能获得的”。虽然复合门本身不满足单个2点平移法则的条件，但“精确梯度不可能获得”的结论是错误的。正如我们的分析所示，精确的梯度可以通过应用乘法法则并对得到的 $K$ 个项中的每一项使用2点参数平移法则来计算，因为每个分量门都是一个简单的泡利旋转。\n**结论：不正确**\n\n**选项 E**：\n该陈述声称，向门 $U_{\\mathrm{d}}(\\theta)$ 添加一个控制辅助量子比特会使2点参数平移法则适用。这是对辅助量子比特在梯度计算中作用的误解。基于辅助量子比特的方法提供了一种*计算*梯度的替代测量方案，其本质是通过构建一个电路来估计必要的对易子。它们不会改变原始生成元 $G_{pq}^{rs}$ 的谱特性。参数平移法则的适用性是参数化门生成元的内在属性，而不是一个可以由外部测量电路诱导的特征。\n**结论：不正确**\n\n因此，陈述 A 和 C 是对情况的唯二正确描述。", "answer": "$$\\boxed{AC}$$", "id": "2932516"}]}