{"hands_on_practices": [{"introduction": "在多体理论中，自能$\\Sigma(\\omega)$并不仅仅是一个任意的数学函数，它本质上是一个描述系统响应的因果响应函数。这意味着其实部和虚部之间存在着深刻的联系，即由Kramers-Kronig关系所约束。本练习提供了一个动手机会，通过一个简单但重要的电子-玻色子相互作用模型，来亲手验证这一基本物理原理，从而加深对$GW$近似中自能分析性质的理解。[@problem_id:2785422]", "problem": "在格林函数乘以屏蔽库仑相互作用 (GW) 近似中，推迟电子自能$\\Sigma^{R}(\\omega)$是频率$\\omega$的一个因果响应函数，它在复频率平面的上半平面解析，并且当$|\\omega| \\to \\infty$时衰减。考虑一个模型，其中屏蔽库仑相互作用$W$由频率为$\\Omega$、宽度为$\\gamma > 0$的单个阻尼玻色子模式主导，且电子与该模式的耦合强度为一个实常数$g$。与这些特征相符的一个常用的推迟自能有效模型是\n$$\n\\Sigma^{R}(\\omega) \\equiv \\frac{g^{2}}{\\omega - \\Omega + \\mathrm{i}\\,\\gamma},\n$$\n其中参数$g$、$ \\Omega$为实数，$\\gamma > 0$，自变量$\\omega$为实数。仅从因果性（时域中当$t < 0$时为零）、上半平面的解析性以及由这些性质导出的一般色散关系 (Kramers–Kronig) 结构出发，完成以下任务：\n\n1. 根据给定模型，直接计算当$\\omega$为实数时$\\Sigma^{R}(\\omega)$的实部和虚部。\n2. 通过解析地计算所需的 Cauchy 主值积分，独立地验证这些部分满足由因果性所蕴含的 Kramers–Kronig 关系。您必须明确地进行积分计算；不要调用预先制表的 Hilbert 变换。\n3. 对比两项计算结果，以确认与因果性的一致性。\n\n将您的最终答案表示为单个解析表达式，该表达式包含$\\Sigma^{R}(\\omega)$的实部和虚部作为$\\omega$的函数，并且用$g$、$\\Omega$和$\\gamma$表示。将这两个部分表示为一个二元行矩阵$\\big(\\Re\\,\\Sigma^{R}(\\omega),\\, \\Im\\,\\Sigma^{R}(\\omega)\\big)$。无需进行数值计算或四舍五入。", "solution": "所提出的问题是关于将复分析应用于物理学中因果响应函数理论的一个标准的、适定的练习。推迟自能$\\Sigma^{R}(\\omega)$的模型在科学上是合理的，并且是电子-玻色子耦合的一个基本范例。我们将直接进行求解。问题要求进行三部分分析：首先，将给定的自能分解为其​​实部和虚部；其次，独立验证连接这些部分的 Kramers-Kronig 关系；第三，对结果进行核对。\n\n给定的推迟自能是实频率$\\omega$的函数：\n$$\n\\Sigma^{R}(\\omega) = \\frac{g^{2}}{\\omega - \\Omega + \\mathrm{i}\\,\\gamma}\n$$\n其中$g$和$\\Omega$是实参数，$\\gamma > 0$是一个正实参数。该函数是复变函数$\\Sigma^{R}(z) = \\frac{g^{2}}{z - \\Omega + \\mathrm{i}\\,\\gamma}$（其中$z = \\omega + \\mathrm{i}\\eta$）在实轴上的边值。这个复变函数在$z_p = \\Omega - \\mathrm{i}\\gamma$处有一个单一的简单极点。由于$\\gamma > 0$, 该极点位于复平面的下半部分。因此，$\\Sigma^{R}(z)$在上半平面($\\Im z > 0$)是解析的，并且当$|z| \\to \\infty$时趋于零。这些是函数满足 Kramers-Kronig 关系的充分必要条件。\n\n首先，我们计算实数$\\omega$对应的$\\Sigma^{R}(\\omega)$的实部和虚部。我们将分子和分母同乘以分母的复共轭$(\\omega - \\Omega) - \\mathrm{i}\\,\\gamma$：\n$$\n\\Sigma^{R}(\\omega) = \\frac{g^{2}}{(\\omega - \\Omega) + \\mathrm{i}\\,\\gamma} \\times \\frac{(\\omega - \\Omega) - \\mathrm{i}\\,\\gamma}{(\\omega - \\Omega) - \\mathrm{i}\\,\\gamma} = \\frac{g^{2}((\\omega - \\Omega) - \\mathrm{i}\\,\\gamma)}{(\\omega - \\Omega)^{2} - (\\mathrm{i}\\,\\gamma)^{2}} = \\frac{g^{2}(\\omega - \\Omega) - \\mathrm{i}\\,g^{2}\\gamma}{(\\omega - \\Omega)^{2} + \\gamma^{2}}\n$$\n从这个表达式中，我们确定实部$\\Re\\,\\Sigma^{R}(\\omega)$和虚部$\\Im\\,\\Sigma^{R}(\\omega)$：\n$$\n\\Re\\,\\Sigma^{R}(\\omega) = \\frac{g^{2}(\\omega - \\Omega)}{(\\omega - \\Omega)^{2} + \\gamma^{2}}\n$$\n$$\n\\Im\\,\\Sigma^{R}(\\omega) = -\\frac{g^{2}\\gamma}{(\\omega - \\Omega)^{2} + \\gamma^{2}}\n$$\n这就完成了问题的第一部分。\n\n其次，我们验证这些表达式满足 Kramers-Kronig 关系。该关系指出，对于一个因果函数，其实部和虚部互为 Hilbert 变换。我们将通过从虚部计算实部来证明这一点：\n$$\n\\Re\\,\\Sigma^{R}(\\omega) = \\frac{1}{\\pi} \\mathcal{P} \\int_{-\\infty}^{\\infty} \\frac{\\Im\\,\\Sigma^{R}(\\omega')}{\\omega' - \\omega} d\\omega'\n$$\n其中$\\mathcal{P}$表示 Cauchy 主值。代入我们得到的$\\Im\\,\\Sigma^{R}(\\omega')$表达式：\n$$\n\\frac{1}{\\pi} \\mathcal{P} \\int_{-\\infty}^{\\infty} \\frac{1}{\\omega' - \\omega} \\left( -\\frac{g^{2}\\gamma}{(\\omega' - \\Omega)^{2} + \\gamma^{2}} \\right) d\\omega' = -\\frac{g^{2}\\gamma}{\\pi} \\mathcal{P} \\int_{-\\infty}^{\\infty} \\frac{d\\omega'}{(\\omega' - \\omega)((\\omega' - \\Omega)^{2} + \\gamma^{2})}\n$$\n我们使用复平面上的围道积分来计算该主值积分。令$f(z) = \\frac{1}{(z - \\omega)((z - \\Omega)^{2} + \\gamma^{2})}$。该函数在$z_1 = \\omega$ (实轴上) 和$z_2^{\\pm} = \\Omega \\pm \\mathrm{i}\\gamma$处有简单极点。我们使用一个闭合围道，该围道由上半平面中半径为$R$的大半圆($\\Gamma_R$)和实轴组成，并在极点$z = \\omega$处有一个半径为$\\epsilon$的小半圆凹口 ($C_{\\epsilon}$)。此围道内包含的唯一极点是$z_2^{+} = \\Omega + \\mathrm{i}\\gamma$。\n\n根据留数定理，沿闭合围道的积分等于$2\\pi\\mathrm{i}$乘以所围极点的留数之和。\n$$\n\\oint f(z) dz = 2\\pi\\mathrm{i}\\,\\mathrm{Res}(f, z_2^{+})\n$$\n沿整个围道的积分可以写为：\n$$\n\\oint f(z) dz = \\int_{-R}^{\\omega-\\epsilon} f(x) dx + \\int_{\\omega+\\epsilon}^{R} f(x) dx + \\int_{C_{\\epsilon}} f(z) dz + \\int_{\\Gamma_R} f(z) dz\n$$\n在极限$R \\to \\infty$和$\\epsilon \\to 0$下，沿$\\Gamma_R$的积分因为$|f(z)| \\sim O(1/|z|^3)$而消失，沿小半圆的积分给出$-\\mathrm{i}\\pi$乘以在$z_1 = \\omega$处的留数。剩下的两个积分构成了主值。\n$$\n\\mathcal{P} \\int_{-\\infty}^{\\infty} f(x) dx - \\mathrm{i}\\pi\\,\\mathrm{Res}(f, \\omega) = 2\\pi\\mathrm{i}\\,\\mathrm{Res}(f, z_2^{+})\n$$\n留数分别为：\n$$\n\\mathrm{Res}(f, \\omega) = \\lim_{z \\to \\omega} (z - \\omega)f(z) = \\frac{1}{(\\omega - \\Omega)^{2} + \\gamma^{2}}\n$$\n$$\n\\mathrm{Res}(f, z_2^{+}) = \\lim_{z \\to \\Omega+\\mathrm{i}\\gamma} (z - (\\Omega+\\mathrm{i}\\gamma))f(z) = \\lim_{z \\to \\Omega+\\mathrm{i}\\gamma} \\frac{1}{(z - \\omega)(z - (\\Omega-\\mathrm{i}\\gamma))} = \\frac{1}{(\\Omega + \\mathrm{i}\\gamma - \\omega)(2\\mathrm{i}\\gamma)}\n$$\n解出主值积分为：\n$$\n\\mathcal{P} \\int_{-\\infty}^{\\infty} f(x) dx = \\mathrm{i}\\pi\\,\\mathrm{Res}(f, \\omega) + 2\\pi\\mathrm{i}\\,\\mathrm{Res}(f, z_2^{+}) = \\frac{\\mathrm{i}\\pi}{(\\omega - \\Omega)^{2} + \\gamma^{2}} + \\frac{2\\pi\\mathrm{i}}{(\\Omega - \\omega + \\mathrm{i}\\gamma)(2\\mathrm{i}\\gamma)}\n$$\n$$\n= \\frac{\\mathrm{i}\\pi}{(\\omega - \\Omega)^{2} + \\gamma^{2}} + \\frac{\\pi}{\\gamma(\\Omega - \\omega + \\mathrm{i}\\gamma)} = \\frac{\\mathrm{i}\\pi}{(\\omega - \\Omega)^{2} + \\gamma^{2}} + \\frac{\\pi}{\\gamma} \\frac{(\\Omega - \\omega) - \\mathrm{i}\\gamma}{(\\Omega - \\omega)^{2} + \\gamma^{2}}\n$$\n$$\n= \\frac{\\mathrm{i}\\pi}{(\\omega - \\Omega)^{2} + \\gamma^{2}} + \\frac{\\pi(\\Omega - \\omega)}{\\gamma((\\omega - \\Omega)^{2} + \\gamma^{2})} - \\frac{\\mathrm{i}\\pi\\gamma}{\\gamma((\\omega - \\Omega)^{2} + \\gamma^{2})} = \\frac{\\pi(\\Omega - \\omega)}{\\gamma((\\omega - \\Omega)^{2} + \\gamma^{2})}\n$$\n虚部项正好相互抵消。现在我们将这个结果代回到 Kramers-Kronig 表达式中：\n$$\n-\\frac{g^{2}\\gamma}{\\pi} \\left( \\mathcal{P} \\int_{-\\infty}^{\\infty} f(x) dx \\right) = -\\frac{g^{2}\\gamma}{\\pi} \\left( \\frac{\\pi(\\Omega - \\omega)}{\\gamma((\\omega - \\Omega)^{2} + \\gamma^{2})} \\right) = -g^{2} \\frac{\\Omega - \\omega}{(\\omega - \\Omega)^{2} + \\gamma^{2}} = \\frac{g^{2}(\\omega - \\Omega)}{(\\omega - \\Omega)^{2} + \\gamma^{2}}\n$$\n这个结果与第一步中导出的$\\Re\\,\\Sigma^{R}(\\omega)$表达式完全相同。Kramers-Kronig 关系得到满足，这从解析上证实了该自能模型的因果性。\n\n第三，核对过程很简单。对 Kramers-Kronig 积分的显式计算证实了复分析一般定理所保证的结论：任何在上半平面解析且在无穷远处消失的函数，其在实轴上的实部和虚部都将通过 Kramers-Kronig 关系相关联。模型函数$\\Sigma^{R}(z)$满足这些条件，因为其唯一的极点在$z_p = \\Omega - \\mathrm{i}\\gamma$，对于$\\gamma > 0$，该极点位于下半平面。因此，我们的直接计算是对物理学中这一基本因果性原理的具体验证。该模型是内部一致且正确构建的。所需的解析表达式是实部和虚部组成的行矩阵。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{g^{2}(\\omega - \\Omega)}{(\\omega - \\Omega)^{2} + \\gamma^{2}} & -\\frac{g^{2}\\gamma}{(\\omega - \\Omega)^{2} + \\gamma^{2}}\n\\end{pmatrix}\n}\n$$", "id": "2785422"}, {"introduction": "掌握了自能的数学性质后，我们转向其物理后果。多体理论的一大成功之处在于它能解释单粒子理论无法描述的光电子能谱特征，例如卫星峰。本练习使用一个包含电子与集体激发（等离激元）耦合的简化模型，清晰地展示了单个谱峰如何自然地分裂为主准粒子峰和卫星峰，通过这个过程，你将直观地理解这种典型的多体效应是如何产生的。[@problem_id:2785453]", "problem": "考虑一个非简并两能级费米子系统，其单粒子能量为$\\varepsilon_{1}$和$\\varepsilon_{2}$，其中$\\varepsilon_{1} < \\mu < \\varepsilon_{2}$且温度为$T=0$。电子通过能级对角的密度耦合与频率为$\\Omega > 0$的单个无色散玻色子模式 (一个等离激元) 耦合。在格林函数乘以屏蔽相互作用 (GW) 近似下进行计算，其中电子自能由单体格林函数与屏蔽相互作用的卷积给出。假设：\n- 无相互作用推迟格林函数是对角的, $G^{0,R}_{ii}(\\omega) = 1/(\\omega - \\varepsilon_{i} + i 0^{+})$对于$i \\in \\{1,2\\}$。\n- 屏蔽相互作用取仅含关联的单等离激元极点形式，在能级指标上是对角的，且两个能级上的耦合相同：\n$$\nW^{c,R}_{ii}(\\omega) \\equiv W^{R}_{ii}(\\omega) - W^{R}_{ii}(\\omega\\!=\\!0) = \\lambda^{2}\\left[\\frac{1}{\\omega - \\Omega + i 0^{+}} - \\frac{1}{\\omega + \\Omega + i 0^{+}}\\right],\n$$\n其中$\\lambda$是实耦合常数且$\\Omega > 0$。你可以通过完全使用$W^{c,R}$来忽略静态的 Hartree 项和交换项。\n\n从无相互作用谱函数和玻色子谱函数的定义出发，推导出占据能级$i=1$的GW推迟自能$\\Sigma^{R}_{11}(\\omega)$。然后，求解推迟格林函数$G^{R}_{11}(\\omega) = \\left[\\omega - \\varepsilon_{1} - \\Sigma^{R}_{11}(\\omega)\\right]^{-1}$的戴森方程，并确定卫星峰特征如何在谱函数$A_{1}(\\omega) = -\\frac{1}{\\pi}\\Im G^{R}_{11}(\\omega)$中出现。在弱耦合极限$\\lambda/\\Omega \\ll 1$下，计算占据能级的第一个等离激元卫星峰的谱权重与准粒子峰的谱权重之比$r$。请给出$r$的一个闭合形式解析表达式，精确到$\\lambda/\\Omega$的领头非平凡阶。不包含单位。你的最终答案必须是一个单一表达式。", "solution": "所提出的问题是多体微擾理论中的一个标准练习，具体涉及将格林函数乘以屏蔽相互作用($GW$)近似应用于一个模型系统。它具有科学依据，提法恰当，且所有术语都有明确定义。该问题是有效的。\n\n核心任务是计算电子自能$\\Sigma(\\omega)$，用它来求出相互作用格林函数$G(\\omega)$，并分析由此产生的光谱函数$A(\\omega)$。我们需要求出能量为$\\varepsilon_1$的已占据电子能级的自能$\\Sigma^{R}_{11}(\\omega)$。\n\n自能的$G_0W_0$近似对应于无相互作用格林函数$G^0$和屏蔽相互作用$W$的卷积。对于一个具有对角耦合、且单个电子能级$|i\\rangle$耦合到频率为$\\Omega$的无色散玻色子模式的系统，其推迟自能由一个从多体微擾理论推导出的标准公式给出：\n$$\n\\Sigma^{R}_{ii}(\\omega) = \\lambda^{2} \\left[ \\frac{1-n_F(\\varepsilon_i)+n_B(\\Omega)}{\\omega - \\varepsilon_i - \\Omega + i0^{+}} + \\frac{n_F(\\varepsilon_i)+n_B(\\Omega)}{\\omega - \\varepsilon_i + \\Omega + i0^{+}} \\right]\n$$\n其中$n_F(\\varepsilon)$是费米-狄拉克分布函数, $n_B(\\Omega)$是玻色-爱因斯坦分布函数, $\\lambda$是电子-玻色子耦合常数。第一项对应于电子发射一个玻色子并散射到一个虚态的过程，而第二项对应于吸收一个玻色子的过程。\n\n问题指定了条件：温度$T=0$，且能级是占据的，即$\\varepsilon_1 < \\mu$，其中$\\mu$是化学势。在$T=0$时，分布函数变为阶跃函数：\n$n_F(\\varepsilon_1) = 1$, 因为$\\varepsilon_1 < \\mu$。\n$n_B(\\Omega) = 0$, 因為玻色子能量$\\Omega > 0$。\n\n将这些值代入$\\Sigma^{R}_{11}(\\omega)$的通用表达式中：\n$$\n\\Sigma^{R}_{11}(\\omega) = \\lambda^{2} \\left[ \\frac{1-1+0}{\\omega - \\varepsilon_1 - \\Omega + i0^{+}} + \\frac{1+0}{\\omega - \\varepsilon_1 + \\Omega + i0^{+}} \\right]\n$$\n第一项消失，只留下电子(或空穴)与真空相互作用产生一个虚玻色子的过程所带来的贡献。\n$$\n\\Sigma^{R}_{11}(\\omega) = \\frac{\\lambda^{2}}{\\omega - \\varepsilon_1 + \\Omega + i0^{+}}\n$$\n这就是占据能级$i=1$的推迟自能。它在$\\omega = \\varepsilon_1 - \\Omega$处有一个单极点，对应于电子发射了一个等离激元后所处的虚态能量。\n\n接下来，我们求解相互作用推迟格林函数$G^{R}_{11}(\\omega)$的戴森方程：\n$$\nG^{R}_{11}(\\omega) = \\left[ (\\omega - \\varepsilon_1 + i0^{+}) - \\Sigma^{R}_{11}(\\omega) \\right]^{-1}\n$$\n无相互作用格林函数的逆为$G^{0,R}_{11}(\\omega)^{-1} = \\omega - \\varepsilon_1 + i0^{+}$。\n因此，\n$$\nG^{R}_{11}(\\omega) = \\left[ \\omega - \\varepsilon_1 - \\frac{\\lambda^{2}}{\\omega - \\varepsilon_1 + \\Omega} \\right]^{-1}\n$$\n为了简化表达式，我们合并分母中的各项 (暂时忽略无穷小量$i0^{+}$，在解释极点时会将其恢复)：\n$$\nG^{R}_{11}(\\omega) = \\frac{\\omega - \\varepsilon_1 + \\Omega}{(\\omega - \\varepsilon_1)(\\omega - \\varepsilon_1 + \\Omega) - \\lambda^{2}}\n$$\n相互作用格林函数的极点是分母的根。令$x = \\omega - \\varepsilon_1$。极点方程变为：\n$$\nx(x+\\Omega) - \\lambda^{2} = 0 \\implies x^{2} + \\Omega x - \\lambda^{2} = 0\n$$\n这个二次方程的根是：\n$$\nx_{\\pm} = \\frac{-\\Omega \\pm \\sqrt{\\Omega^{2} + 4\\lambda^{2}}}{2}\n$$\n新的准粒子能量 ($G^{R}_{11}$的极点) 为$\\omega_{\\pm} = \\varepsilon_1 + x_{\\pm}$：\n$$\nE_{\\pm} = \\varepsilon_1 - \\frac{\\Omega}{2} \\pm \\frac{1}{2}\\sqrt{\\Omega^{2} + 4\\lambda^{2}}\n$$\n格林函数可以用部分分式分解法表示为其极点的形式：\n$$\nG^{R}_{11}(\\omega) = \\frac{Z_{+}}{\\omega - E_{+} + i0^{+}} + \\frac{Z_{-}}{\\omega - E_{-} + i0^{+}}\n$$\n其中$Z_{\\pm}$是谱权重 (或准粒子留数)。它们的计算方法如下：\n$$\nZ_{\\pm} = \\lim_{\\omega \\to E_{\\pm}} (\\omega - E_{\\pm}) G^{R}_{11}(\\omega) = \\frac{E_{\\pm} - \\varepsilon_1 + \\Omega}{E_{\\pm} - E_{\\mp}}\n$$\n我们来计算差值$E_{+} - E_{-} = \\sqrt{\\Omega^{2} + 4\\lambda^{2}}$。\n分子是：\n$E_{+} - \\varepsilon_1 + \\Omega = x_{+} + \\Omega = \\frac{-\\Omega + \\sqrt{\\Omega^{2} + 4\\lambda^{2}}}{2} + \\Omega = \\frac{\\Omega + \\sqrt{\\Omega^{2} + 4\\lambda^{2}}}{2}$\n$E_{-} - \\varepsilon_1 + \\Omega = x_{-} + \\Omega = \\frac{-\\Omega - \\sqrt{\\Omega^{2} + 4\\lambda^{2}}}{2} + \\Omega = \\frac{\\Omega - \\sqrt{\\Omega^{2} + 4\\lambda^{2}}}{2}$\n权重为：\n$$\nZ_{+} = \\frac{\\frac{1}{2}(\\Omega + \\sqrt{\\Omega^{2} + 4\\lambda^{2}})}{\\sqrt{\\Omega^{2} + 4\\lambda^{2}}} = \\frac{1}{2}\\left(1 + \\frac{\\Omega}{\\sqrt{\\Omega^{2} + 4\\lambda^{2}}}\\right)\n$$\n$$\nZ_{-} = \\frac{\\frac{1}{2}(\\Omega - \\sqrt{\\Omega^{2} + 4\\lambda^{2}})}{-\\sqrt{\\Omega^{2} + 4\\lambda^{2}}} = \\frac{1}{2}\\left(1 - \\frac{\\Omega}{\\sqrt{\\Omega^{2} + 4\\lambda^{2}}}\\right)\n$$\n谱函数$A_{1}(\\omega) = -\\frac{1}{\\pi}\\Im G^{R}_{11}(\\omega)$是两个$\\delta$函数的和: $A_{1}(\\omega) = Z_{+}\\delta(\\omega-E_{+}) + Z_{-}\\delta(\\omega-E_{-})$。原来在$\\varepsilon_1$处的单个峰分裂成了两个：一个准粒子峰和一个卫星峰。\n\n为了区分哪个是哪个，我们考察弱耦合极限$\\lambda/\\Omega \\ll 1$。\n$\\sqrt{\\Omega^{2} + 4\\lambda^{2}} = \\Omega\\sqrt{1 + 4(\\lambda/\\Omega)^{2}} \\approx \\Omega\\left(1 + \\frac{1}{2} \\cdot 4(\\lambda/\\Omega)^{2}\\right) = \\Omega + \\frac{2\\lambda^{2}}{\\Omega}$。\n极点能量变为：\n$E_{+} \\approx \\varepsilon_1 - \\frac{\\Omega}{2} + \\frac{1}{2}\\left(\\Omega + \\frac{2\\lambda^{2}}{\\Omega}\\right) = \\varepsilon_1 + \\frac{\\lambda^{2}}{\\Omega}$。这个极点接近原始能量$\\varepsilon_1$，代表重整化的准粒子峰。\n$E_{-} \\approx \\varepsilon_1 - \\frac{\\Omega}{2} - \\frac{1}{2}\\left(\\Omega + \\frac{2\\lambda^{2}}{\\Omega}\\right) = \\varepsilon_1 - \\Omega - \\frac{\\lambda^{2}}{\\Omega}$。这个极点移动了大约$-\\Omega$，是等离激元卫星峰，对应于伴随着等离激元发射而产生一个空穴的过程。\n\n现在，我们计算弱耦合极限下的权重。\n$\\frac{\\Omega}{\\sqrt{\\Omega^{2} + 4\\lambda^{2}}} = \\left(1 + 4(\\lambda/\\Omega)^{2}\\right)^{-1/2} \\approx 1 - \\frac{1}{2}\\left(4(\\lambda/\\Omega)^{2}\\right) = 1 - 2(\\lambda/\\Omega)^{2}$。\n准粒子权重为：\n$Z_{+} = \\frac{1}{2}(1 + (1 - 2(\\lambda/\\Omega)^{2})) = 1 - (\\lambda/\\Omega)^{2}$。\n卫星峰权重为：\n$Z_{-} = \\frac{1}{2}(1 - (1 - 2(\\lambda/\\Omega)^{2})) = (\\lambda/\\Omega)^{2}$。\n\n问题要求计算第一个等离激元卫星峰的谱权重($Z_{-}$)与准粒子峰的谱权重($Z_{+}$)之比$r$，精确到$\\lambda/\\Omega$的领头非平凡阶。\n$$\nr = \\frac{Z_{-}}{Z_{+}} = \\frac{(\\lambda/\\Omega)^{2}}{1 - (\\lambda/\\Omega)^{2}}\n$$\n对小的$\\lambda/\\Omega$值展开：\n$$\nr = \\left(\\frac{\\lambda}{\\Omega}\\right)^{2} \\left[1 + \\left(\\frac{\\lambda}{\\Omega}\\right)^{2} + O\\left(\\left(\\frac{\\lambda}{\\Omega}\\right)^{4}\\right)\\right] = \\left(\\frac{\\lambda}{\\Omega}\\right)^{2} + O\\left(\\left(\\frac{\\lambda}{\\Omega}\\right)^{4}\\right)\n$$\n领头非平凡阶为$(\\lambda/\\Omega)^{2}$。", "answer": "$$\\boxed{\\left(\\frac{\\lambda}{\\Omega}\\right)^{2}}$$", "id": "2785453"}, {"introduction": "最后，我们将理论模型与真实的计算化学研究实践联系起来。执行一次$GW$计算需要做出多种数值选择（如基组大小、截断能等），并为格林函数提供一个初始猜测（例如，来自DFT或Hartree-Fock理论）。本练习模拟了一项实际的研究任务：系统性地分析计算结果如何依赖于这些参数，并使用外推法来获得收敛值，同时量化重要的“起始点依赖性”问题，这是评估$GW$计算可靠性的关键一步。[@problem_id:2785470]", "problem": "要求您形式化、实现并应用一个协议，以分离在$G W$近似下多体格林函数计算中苯的垂直第一电离能的起始点效应。目标比较涉及$G_{0}W_{0}$@Perdew–Burke–Ernzerhof (PBE)、$G_{0}W_{0}$@Hartree–Fock (HF)和准粒子自洽$G W$(qsGW)。您的程序必须从提供的合成原始数据中，通过数值外推消除收敛误差后，确定收敛的准粒子电离能的最佳估计值以及剩余的起始点依赖性。\n\n使用的基础与假设：\n- 单粒子格林函数$G(1,2)$满足包含自能$\\Sigma(1,2)$的Dyson方程：$G = G_{0} + G_{0}\\,\\Sigma\\,G$，其中$G_{0}$是无相互作用的格林函数。在$G W$近似中，$\\Sigma(1,2) = i\\,G(1,2)\\,W(1^{+},2)$，其中屏蔽库仑相互作用$W$是在随机相位近似(RPA)中，根据从所选起始点（对于PBE是密度泛函理论(DFT)，对于$G_{0}W_{0}$是Hartree–Fock (HF)；对于qsGW是自洽性）构建的独立粒子极化率计算得出。\n- 与最高占据分子轨道(HOMO)相关的准粒子电离能定义为对角准粒子方程的根，并以电子伏特为单位报告。对于此问题，所提供的原始数据可被视为已预先对齐的垂直电离能，因此无需单独进行真空对齐。\n- 主要的数值收敛参数是：包含在响应函数中的未占据（虚）态数量$N_{b}$，以电子伏特为单位的介电平面波截断能$E_{c}$，以及用于计算$W(\\omega)$的频率格点数量$N_{\\omega}$。对于足够大的$N_{b}$、$E_{c}$和$N_{\\omega}$，假设准粒子能量的渐近误差模型是可加的，\n$$\nE_{\\mathrm{obs}}(N_{b},E_{c},N_{\\omega}) \\approx E_{\\infty} + \\frac{A}{N_{b}} + \\frac{B}{E_{c}} + \\frac{C}{N_{\\omega}^{2}},\n$$\n其中$E_{\\infty}$是完全收敛的准粒子电离能（所求的值），而$A$、$B$和$C$是依赖于方法的系数。该模型蕴含的思想是，基组不完备性、介电截断和频率离散化贡献了独立的领头阶误差，这些误差在$N_{b}\\to\\infty$、$E_{c}\\to\\infty$和$N_{\\omega}\\to\\infty$时趋于零。\n\n您的任务：\n- 对于每种方法$m \\in \\{\\text{$G_{0}W_{0}$@PBE}, \\text{$G_{0}W_{0}$@HF}, \\text{qsGW}\\}$以及每个测试用例，通过最小二乘法拟合线性模型\n$$\nE_{\\mathrm{obs}} = \\beta_{0}^{(m)} + \\beta_{1}^{(m)}\\left(\\frac{1}{N_{b}}\\right) + \\beta_{2}^{(m)}\\left(\\frac{1}{E_{c}}\\right) + \\beta_{3}^{(m)}\\left(\\frac{1}{N_{\\omega}^{2}}\\right)\n$$\n并将$\\beta_{0}^{(m)}$作为$E_{\\infty}^{(m)}$以电子伏特为单位报告。然后计算外推后的起始点差异，即$E_{\\infty}^{(\\text{$G_{0}W_{0}$@PBE})} - E_{\\infty}^{(\\text{$G_{0}W_{0}$@HF})}$和$E_{\\infty}^{(\\text{qsGW})} - E_{\\infty}^{(\\text{$G_{0}W_{0}$@HF})}$，这些差异量化了剩余的起始点效应。\n- 所有电离能和差异必须以电子伏特为单位报告，并四舍五入到三位小数。\n\n原始数据（测试套件）：\n- 每个测试用例为每种方法提供一个元组列表$\\left(N_{b},E_{c},N_{\\omega},E_{\\mathrm{obs}}\\right)$，其中$N_{b}$和$N_{\\omega}$是无量纲的，$E_{c}$的单位是电子伏特，$E_{\\mathrm{obs}}$是观测到的原始准粒子电离能，单位为电子伏特。\n\n测试用例 1 (平衡采样)：\n- $G_{0}W_{0}$@PBE:\n  - $\\left(200,15,30,10.035833\\right)$\n  - $\\left(200,25,60,9.713333\\right)$\n  - $\\left(400,15,30,10.029583\\right)$\n  - $\\left(400,25,60,9.707083\\right)$\n  - $\\left(800,25,30,9.706458\\right)$\n  - $\\left(800,40,60,9.523958\\right)$\n- $G_{0}W_{0}$@HF:\n  - $\\left(200,15,30,9.824556\\right)$\n  - $\\left(200,25,60,9.609556\\right)$\n  - $\\left(400,15,30,9.820056\\right)$\n  - $\\left(400,25,60,9.605056\\right)$\n  - $\\left(800,25,30,9.604472\\right)$\n  - $\\left(800,40,60,9.482806\\right)$\n- qsGW:\n  - $\\left(200,15,30,9.656333\\right)$\n  - $\\left(200,25,60,9.495333\\right)$\n  - $\\left(400,15,30,9.653833\\right)$\n  - $\\left(400,25,60,9.492833\\right)$\n  - $\\left(800,25,30,9.492583\\right)$\n  - $\\left(800,40,60,9.401583\\right)$\n\n测试用例 2 (更稀疏、偏斜的采样)：\n- $G_{0}W_{0}$@PBE:\n  - $\\left(150,20,20,9.844167\\right)$\n  - $\\left(300,20,40,9.830208\\right)$\n  - $\\left(600,30,40,9.626042\\right)$\n  - $\\left(600,50,80,9.464635\\right)$\n  - $\\left(1200,50,80,9.462552\\right)$\n  - $\\left(1200,30,20,9.629583\\right)$\n- $G_{0}W_{0}$@HF:\n  - $\\left(150,20,20,9.697000\\right)$\n  - $\\left(300,20,40,9.687250\\right)$\n  - $\\left(600,30,40,9.550917\\right)$\n  - $\\left(600,50,80,9.443312\\right)$\n  - $\\left(1200,50,80,9.441812\\right)$\n  - $\\left(1200,30,20,9.553167\\right)$\n- qsGW:\n  - $\\left(150,20,20,9.559667\\right)$\n  - $\\left(300,20,40,9.554083\\right)$\n  - $\\left(600,30,40,9.452417\\right)$\n  - $\\left(600,50,80,9.371854\\right)$\n  - $\\left(1200,50,80,9.371021\\right)$\n  - $\\left(1200,30,20,9.453833\\right)$\n\n测试用例 3 (包含近收敛点)：\n- $G_{0}W_{0}$@PBE:\n  - $\\left(1600,80,120,9.371771\\right)$\n  - $\\left(1000,80,120,9.372708\\right)$\n  - $\\left(1600,60,60,9.422396\\right)$\n  - $\\left(1000,40,30,9.525833\\right)$\n  - $\\left(500,30,60,9.625833\\right)$\n- $G_{0}W_{0}$@HF:\n  - $\\left(1600,80,120,9.381264\\right)$\n  - $\\left(1000,80,120,9.381939\\right)$\n  - $\\left(1600,60,60,9.415014\\right)$\n  - $\\left(1000,40,30,9.484022\\right)$\n  - $\\left(500,30,60,9.550822\\right)$\n- qsGW:\n  - $\\left(1600,80,120,9.325708\\right)$\n  - $\\left(1000,80,120,9.326083\\right)$\n  - $\\left(1600,60,60,9.350958\\right)$\n  - $\\left(1000,40,30,9.402333\\right)$\n  - $\\left(500,30,60,9.452333\\right)$\n\n您的程序必须执行的计算任务：\n- 对于每个测试用例和每种方法，构建以$\\left[1, 1/N_{b}, 1/E_{c}, 1/N_{\\omega}^{2}\\right]$为列的设计矩阵和以$E_{\\mathrm{obs}}$值为元素的目标向量。计算最小二乘解，并将截距确定为以电子伏特为单位的$E_{\\infty}$。\n- 对于每个测试用例，计算以电子伏特为单位的两两之差$E_{\\infty}^{(\\text{$G_{0}W_{0}$@PBE})} - E_{\\infty}^{(\\text{$G_{0}W_{0}$@HF})}$和$E_{\\infty}^{(\\text{qsGW})} - E_{\\infty}^{(\\text{$G_{0}W_{0}$@HF})}$。\n- 为每个测试用例报告一个包含五个数字的列表：$\\left[E_{\\infty}^{(\\text{$G_{0}W_{0}$@PBE})}, E_{\\infty}^{(\\text{$G_{0}W_{0}$@HF})}, E_{\\infty}^{(\\text{qsGW})}, E_{\\infty}^{(\\text{$G_{0}W_{0}$@PBE})} - E_{\\infty}^{(\\text{$G_{0}W_{0}$@HF})}, E_{\\infty}^{(\\text{qsGW})} - E_{\\infty}^{(\\text{$G_{0}W_{0}$@HF})}\\right]$，所有数值均以电子伏特为单位，并四舍五入到三位小数。\n\n角度单位不适用。百分比不适用。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含三个测试用例的结果，形式为由三个列表组成的逗号分隔列表，每个内部列表均按指定格式化，不含空格，并用方括号括起。例如，一种可接受的格式是$\\left[\\left[x_{1},x_{2},x_{3},x_{4},x_{5}\\right],\\left[\\dots\\right],\\left[\\dots\\right]\\right]$，其中每个$x_{i}$是四舍五入到三位小数的浮点数，并以电子伏特为单位解释。", "solution": "所述问题是在理论化学领域内，一个有效且适定的数据分析练习。它在科学上基于多体微扰理论的原理，特别是用于计算电子准粒子能量的$GW$近似。该问题旨在通过将合成的数值数据外推至无限计算资源的极限，来确定苯的收敛垂直电离能，并量化$GW$计算的起始点依赖性。所有提供的信息都是自洽、一致且足以用于此目的。\n\n问题的核心在于应用一个特定的准粒子电离能$E_{\\mathrm{obs}}$的渐近误差模型。该能量依赖于三个关键的数值参数：未占据态的数量$N_{b}$，介电平面波截断能$E_{c}$，以及频率格点数$N_{\\omega}$。假定的误差函数形式为：\n$$\nE_{\\mathrm{obs}}(N_{b},E_{c},N_{\\omega}) \\approx E_{\\infty} + \\frac{A}{N_{b}} + \\frac{B}{E_{c}} + \\frac{C}{N_{\\omega}^{2}}\n$$\n在此，$E_{\\infty}$代表完全收敛的准粒子能量，这是待确定的主要量。系数$A$、$B$和$C$参数化了相对于每个数值参数的收敛速率。\n\n该模型是关于参数$\\boldsymbol{\\beta} = [E_{\\infty}, A, B, C]^T$的线性方程。为明确起见，我们按照指示为每种方法$m \\in \\{\\text{$G_{0}W_{0}$@PBE}, \\text{$G_{0}W_{0}$@HF}, \\text{qsGW}\\}$重写方程：\n$$\nE_{\\mathrm{obs}} = \\beta_{0}^{(m)} + \\beta_{1}^{(m)}x_1 + \\beta_{2}^{(m)}x_2 + \\beta_{3}^{(m)}x_3\n$$\n其中$\\beta_{0}^{(m)} = E_{\\infty}^{(m)}$，$\\beta_{1}^{(m)} = A^{(m)}$，$\\beta_{2}^{(m)} = B^{(m)}$，以及$\\beta_{3}^{(m)} = C^{(m)}$。自变量或预测变量定义为$x_1 = \\frac{1}{N_{b}}$、$x_2 = \\frac{1}{E_{c}}$和$x_3 = \\frac{1}{N_{\\omega}^{2}}$。因变量是观测能量$y = E_{\\mathrm{obs}}$。\n\n对于每组$k$个数据点$\\left(N_{b,i}, E_{c,i}, N_{\\omega,i}, E_{\\mathrm{obs},i}\\right)$，其中$i = 1, \\dots, k$，我们可以建立一个线性方程组。该系统可以写成矩阵形式：\n$$\n\\mathbf{y} \\approx X\\boldsymbol{\\beta}\n$$\n这里，$\\mathbf{y}$是一个$k \\times 1$的观测能量$E_{\\mathrm{obs},i}$列向量。$\\boldsymbol{\\beta}$是$4 \\times 1$的未知系数$[\\beta_0, \\beta_1, \\beta_2, \\beta_3]^T$列向量。$X$是$k \\times 4$的设计矩阵，其中每一行对应一个数据点，并按如下方式构建：\n$$\nX_i = \\begin{bmatrix} 1 & \\frac{1}{N_{b,i}} & \\frac{1}{E_{c,i}} & \\frac{1}{N_{\\omega,i}^2} \\end{bmatrix}\n$$\n问题是找到向量$\\boldsymbol{\\beta}$，以最小化残差平方和$\\|\\mathbf{y} - X\\boldsymbol{\\beta}\\|^2$。这是一个标准的线性最小二乘问题。解由正规方程给出：\n$$\n\\boldsymbol{\\beta} = (X^T X)^{-1} X^T \\mathbf{y}\n$$\n对于每个测试用例和三种方法中的每一种，我们将从提供的原始数据构建设计矩阵$X$和观测向量$\\mathbf{y}$。然后我们将求解系数向量$\\boldsymbol{\\beta}$。该向量的第一个元素$\\beta_0$是该方法外推得到的电离能$E_{\\infty}$，单位为电子伏特。\n\n在确定外推能量$E_{\\infty}^{(\\text{$G_{0}W_{0}$@PBE})}$, $E_{\\infty}^{(\\text{$G_{0}W_{0}$@HF})}$和$E_{\\infty}^{(\\text{qsGW})}$之后，我们计算相对于Hartree-Fock起始点的剩余起始点依赖性。这些差异是：\n$$\n\\Delta_{1} = E_{\\infty}^{(\\text{$G_{0}W_{0}$@PBE})} - E_{\\infty}^{(\\text{$G_{0}W_{0}$@HF})}\n$$\n$$\n\\Delta_{2} = E_{\\infty}^{(\\text{qsGW})} - E_{\\infty}^{(\\text{$G_{0}W_{0}$@HF})}\n$$\n最后，对每个测试用例，将五个结果值——$E_{\\infty}^{(\\text{$G_{0}W_{0}$@PBE})}$、$E_{\\infty}^{(\\text{$G_{0}W_{0}$@HF})}$、$E_{\\infty}^{(\\text{qsGW})}$、$\\Delta_1$和$\\Delta_2$——收集起来，四舍五入到三位小数，并按指定格式进行格式化。实现将利用`numpy.linalg.lstsq`函数，它为此类最小二乘问题提供了一个鲁棒且高效的求解器。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem of extrapolating GW calculation results and determining starting-point effects.\n    \"\"\"\n    test_cases = {\n        \"Case 1\": {\n            \"G0W0@PBE\": [\n                (200, 15, 30, 10.035833), (200, 25, 60, 9.713333),\n                (400, 15, 30, 10.029583), (400, 25, 60, 9.707083),\n                (800, 25, 30, 9.706458), (800, 40, 60, 9.523958)\n            ],\n            \"G0W0@HF\": [\n                (200, 15, 30, 9.824556), (200, 25, 60, 9.609556),\n                (400, 15, 30, 9.820056), (400, 25, 60, 9.605056),\n                (800, 25, 30, 9.604472), (800, 40, 60, 9.482806)\n            ],\n            \"qsGW\": [\n                (200, 15, 30, 9.656333), (200, 25, 60, 9.495333),\n                (400, 15, 30, 9.653833), (400, 25, 60, 9.492833),\n                (800, 25, 30, 9.492583), (800, 40, 60, 9.401583)\n            ]\n        },\n        \"Case 2\": {\n            \"G0W0@PBE\": [\n                (150, 20, 20, 9.844167), (300, 20, 40, 9.830208),\n                (600, 30, 40, 9.626042), (600, 50, 80, 9.464635),\n                (1200, 50, 80, 9.462552), (1200, 30, 20, 9.629583)\n            ],\n            \"G0W0@HF\": [\n                (150, 20, 20, 9.697000), (300, 20, 40, 9.687250),\n                (600, 30, 40, 9.550917), (600, 50, 80, 9.443312),\n                (1200, 50, 80, 9.441812), (1200, 30, 20, 9.553167)\n            ],\n            \"qsGW\": [\n                (150, 20, 20, 9.559667), (300, 20, 40, 9.554083),\n                (600, 30, 40, 9.452417), (600, 50, 80, 9.371854),\n                (1200, 50, 80, 9.371021), (1200, 30, 20, 9.453833)\n            ]\n        },\n        \"Case 3\": {\n            \"G0W0@PBE\": [\n                (1600, 80, 120, 9.371771), (1000, 80, 120, 9.372708),\n                (1600, 60, 60, 9.422396), (1000, 40, 30, 9.525833),\n                (500, 30, 60, 9.625833)\n            ],\n            \"G0W0@HF\": [\n                (1600, 80, 120, 9.381264), (1000, 80, 120, 9.381939),\n                (1600, 60, 60, 9.415014), (1000, 40, 30, 9.484022),\n                (500, 30, 60, 9.550822)\n            ],\n            \"qsGW\": [\n                (1600, 80, 120, 9.325708), (1000, 80, 120, 9.326083),\n                (1600, 60, 60, 9.350958), (1000, 40, 30, 9.402333),\n                (500, 30, 60, 9.452333)\n            ]\n        }\n    }\n\n    all_results_formatted = []\n    \n    # Sort test cases to ensure consistent order\n    sorted_cases = sorted(test_cases.keys())\n\n    for case_name in sorted_cases:\n        case_data = test_cases[case_name]\n        extrapolated_energies = {}\n        \n        methods = [\"G0W0@PBE\", \"G0W0@HF\", \"qsGW\"]\n        for method in methods:\n            raw_data = case_data[method]\n\n            # Construct the design matrix X and observation vector y\n            # X columns: 1, 1/Nb, 1/Ec, 1/Nw^2\n            # y column: E_obs\n            y = np.array([d[3] for d in raw_data])\n            X = np.array([[1, 1/d[0], 1/d[1], 1/(d[2]**2)] for d in raw_data])\n            \n            # Perform linear least-squares regression\n            coeffs, _, _, _ = np.linalg.lstsq(X, y, rcond=None)\n            \n            # The intercept is the extrapolated energy E_infinity\n            e_inf = coeffs[0]\n            extrapolated_energies[method] = e_inf\n            \n        e_inf_pbe = extrapolated_energies[\"G0W0@PBE\"]\n        e_inf_hf = extrapolated_energies[\"G0W0@HF\"]\n        e_inf_qsgw = extrapolated_energies[\"qsGW\"]\n\n        # Calculate the starting-point differences\n        diff_pbe_hf = e_inf_pbe - e_inf_hf\n        diff_qsgw_hf = e_inf_qsgw - e_inf_hf\n\n        # Assemble the results for the current test case\n        case_results = [\n            e_inf_pbe,\n            e_inf_hf,\n            e_inf_qsgw,\n            diff_pbe_hf,\n            diff_qsgw_hf\n        ]\n\n        # Format the numbers to three decimal places and create the string representation\n        # of the list, e.g. \"[1.234,5.678,...]\"\n        formatted_case_list = [f\"{val:.3f}\" for val in case_results]\n        all_results_formatted.append(f\"[{','.join(formatted_case_list)}]\")\n\n    # Join the formatted strings for each case and enclose in the final brackets\n    final_output_string = f\"[{','.join(all_results_formatted)}]\"\n    print(final_output_string)\n\nsolve()\n```", "id": "2785470"}]}