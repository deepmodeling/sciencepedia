{"hands_on_practices": [{"introduction": "要真正理解显式相关方法，我们必须从它们解决的根本问题入手：传统波函数对电子-电子汇合点的不正确描述。第一个实践练习将引导您对一个简单的双电子体系进行端到端的推导，从薛定谔方程出发，亲自导出Kato尖点条件[@problem_id:2891520]。然后，通过比较一个标准波函数和一个被简单 $r_{12}$ 项增强的波函数，您将直接计算并见证这种“显式相关”是如何开始修正电子能量的。", "problem": "考虑一个核电荷为 $Z=2$ 的类氦双电子原子，在非相对论的 Born–Oppenheimer 近似下进行研究。使用原子单位。其哈密顿量为\n$$\n\\hat{H} = -\\frac{1}{2}\\left(\\nabla_{1}^{2} + \\nabla_{2}^{2}\\right) - Z\\left(\\frac{1}{r_{1}} + \\frac{1}{r_{2}}\\right) + \\frac{1}{r_{12}},\n$$\n其中 $r_{12} = |\\mathbf{r}_{1} - \\mathbf{r}_{2}|$。使用以下两种空间波函数模型，每种都与一个自旋单态配对：\n\n- 不含显式相关：非相关乘积\n$$\n\\Phi_{0}(\\mathbf{r}_{1},\\mathbf{r}_{2}) = \\varphi(\\mathbf{r}_{1})\\,\\varphi(\\mathbf{r}_{2}), \\quad \\varphi(\\mathbf{r}) = \\left(\\frac{\\zeta^{3}}{\\pi}\\right)^{1/2} \\exp(-\\zeta r),\n$$\n其中 $\\zeta$ 是一个正的变分指数。\n\n- 在显式相关 F12 (F12) 精神下包含显式相关：孪函数增强的拟设\n$$\n\\Phi_{F12}(\\mathbf{r}_{1},\\mathbf{r}_{2}) = \\mathcal{N}\\,g(r_{12})\\,\\varphi(\\mathbf{r}_{1})\\,\\varphi(\\mathbf{r}_{2}), \\quad g(r_{12}) = 1 + c\\, r_{12},\n$$\n其中归一化常数 $\\mathcal{N}$ 和标量 $c$ 由电子-电子-尖点条件确定。\n\n任务：\n1. 从相对坐标 $u = r_{12}$ 中的多电子薛定谔方程出发，进行局域并合分析，以推导自旋单态基态的电子-电子 Kato 尖点条件，\n$$\n\\left.\\frac{\\partial \\Psi}{\\partial u}\\right|_{u=0} = \\frac{1}{2}\\,\\Psi\\big|_{u=0}.\n$$\n用此式来确定所选 $g(u)$ 的 $c$ 值。\n\n2. 对于非相关乘积密度 $|\\Phi_{0}|^{2}$，使用 Hylleraas 坐标 $s=r_{1}+r_{2}$、 $t=r_{1}-r_{2}$ 和 $u=r_{12}$，精确计算以下组态空间平均值：\n   - $\\langle u^{-1} \\rangle_{0}$,\n   - $\\langle u \\rangle_{0}$,\n   - $\\langle u^{2} \\rangle_{0}$,\n   其中 $\\langle \\cdot \\rangle_{0}$ 表示使用权重 $|\\Phi_{0}|^{2}$ 的归一化平均值。您必须从 Hylleraas 体积元和指数因子 $\\exp(-2\\zeta s)$ 的第一性原理出发推导这些积分；不要假定任何预先制好的列表值。\n\n3. 使用第2项的结果，推导 F12 增强拟设的电子-电子库仑排斥期望值的闭式表达式，\n$$\nJ(c) = \\frac{\\left\\langle g(u)^{2}\\,u^{-1}\\right\\rangle_{0}}{\\left\\langle g(u)^{2}\\right\\rangle_{0}},\n$$\n使其仅用 $\\zeta$ 和 $c$ 表示。\n\n4. 对于非相关模型，计算变分能量泛函\n$$\nE_{0}(\\zeta) = \\langle \\Phi_{0} | \\hat{H} | \\Phi_{0} \\rangle\n$$\n并关于 $\\zeta$ 将其最小化。仅使用定义和标准的单电子类氢期望值，以获得作为 $Z$ 的函数的闭式极小值点 $\\zeta^{\\star}$。\n\n5. 设 $Z=2$ 且 $\\zeta = \\zeta^{\\star}$。使用第1项中由尖点条件确定的 $c$，计算 F12 模型和非相关模型之间电子-电子库仑排斥能的差值，\n$$\n\\Delta J \\equiv J(c) - \\langle u^{-1} \\rangle_{0}.\n$$\n将最终答案四舍五入到四位有效数字。以 hartree 为单位表示最终的能量差。", "solution": "该问题被验证为具有科学依据、提法恰当且客观。它提出了一个理论量子化学中标准的、尽管计算量大的问题。我们开始求解。所有计算均在原子单位下进行。\n\n**任务1：电子-电子尖点条件**\n\n双电子原子的非相对论薛定谔方程为 $\\hat{H}\\Psi = E\\Psi$，其中哈密顿量由下式给出\n$$\n\\hat{H} = -\\frac{1}{2}\\nabla_{1}^{2} -\\frac{1}{2}\\nabla_{2}^{2} - \\frac{Z}{r_{1}} - \\frac{Z}{r_{2}} + \\frac{1}{r_{12}}.\n$$\n我们分析当两个电子相互靠近时，即电子间距 $u = r_{12} = |\\mathbf{r}_1 - \\mathbf{r}_2| \\to 0$时，波函数 $\\Psi(\\mathbf{r}_1, \\mathbf{r}_2)$ 的行为。在此极限下，电子-电子排斥项 $1/u$ 变为奇异的。为了使总能量 $E$ 保持有限，这个奇点必须被动能算符中相应的奇点所抵消。在小 $u$ 处，薛定谔方程中的主导项是\n$$\n\\left(-\\frac{1}{2}\\nabla_{1}^{2} -\\frac{1}{2}\\nabla_{2}^{2} + \\frac{1}{u}\\right)\\Psi \\approx \\left(E + \\frac{Z}{r_1} + \\frac{Z}{r_2}\\right)\\Psi.\n$$\n当 $u \\to 0$ 时，右侧是有限的（因为 $\\mathbf{r}_1 \\to \\mathbf{r}_2$）。我们变换到质心坐标 $\\mathbf{R} = (\\mathbf{r}_1 + \\mathbf{r}_2)/2$ 和相对坐标 $\\mathbf{u} = \\mathbf{r}_1 - \\mathbf{r}_2$。动能算符变为 $-\\frac{1}{4}\\nabla_R^2 - \\nabla_u^2$。局域薛定谔方程由相对坐标项主导：\n$$\n\\left(-\\nabla_{u}^{2} + \\frac{1}{u}\\right)\\Psi \\approx \\text{有限}.\n$$\n对于自旋单态基态，空间波函数对于电子交换是对称的，并且在相对坐标中由 s 波 ($l=0$) 分量主导。因此，我们可以考虑球面平均波函数 $\\bar{\\Psi}(u) = \\frac{1}{4\\pi}\\int \\Psi d\\Omega_u$，它仅依赖于其大小 $u$。对于 s 波，拉普拉斯算符 $\\nabla_u^2$ 的径向部分是 $\\frac{1}{u^2}\\frac{\\partial}{\\partial u}(u^2 \\frac{\\partial}{\\partial u})$。对于 $\\bar{\\Psi}(u)$ 的局域方程变为\n$$\n-\\frac{1}{u^2}\\frac{d}{d u}\\left(u^2 \\frac{d\\bar{\\Psi}}{d u}\\right) + \\frac{1}{u}\\bar{\\Psi}(u) \\approx \\text{有限}.\n$$\n将此式展开得到 $-\\frac{d^2\\bar{\\Psi}}{du^2} - \\frac{2}{u}\\frac{d\\bar{\\Psi}}{du} + \\frac{1}{u}\\bar{\\Psi}(u) \\approx \\text{有限}$。\n我们假设 $\\bar{\\Psi}(u)$ 在 $u=0$ 附近有一个泰勒级数展开：$\\bar{\\Psi}(u) = a_0 + a_1 u + a_2 u^2 + \\dots$，其中 $a_0 = \\bar{\\Psi}(0)$ 且 $a_1 = \\left.\\frac{d\\bar{\\Psi}}{du}\\right|_{u=0}$。将此代入方程中：\n$$\n-(2a_2 + \\dots) - \\frac{2}{u}(a_1 + 2a_2 u + \\dots) + \\frac{1}{u}(a_0 + a_1 u + \\dots) \\approx \\text{有限}.\n$$\n收集 $u^{-1}$ 阶的项：\n$$\n\\frac{-2a_1 + a_0}{u} = 0 \\implies -2a_1 + a_0 = 0 \\implies a_1 = \\frac{1}{2}a_0.\n$$\n这给出了自旋单态的 Kato 尖点条件：\n$$\n\\left.\\frac{\\partial \\bar{\\Psi}}{\\partial u}\\right|_{u=0} = \\frac{1}{2}\\bar{\\Psi}\\big|_{u=0}.\n$$\n问题要求的是 $\\Psi$ 的这个条件，它对其 s 波分量成立。\n对于 F12 拟设，$\\Phi_{F12} = \\mathcal{N} g(u) \\Phi_0$，其中 $g(u)=1+cu$ 且 $\\Phi_0 = \\varphi(\\mathbf{r}_1)\\varphi(\\mathbf{r}_2)$ 是 1s 轨道的乘积。函数 $\\Phi_0$ 在 $u=0$ 处是光滑的，其球面平均形式 $\\bar{\\Phi}_0(u)$ 的泰勒展开以偶次幂项开始，即 $\\bar{\\Phi}_0(u) = A + B u^2 + \\dots$。因此，$\\left.\\frac{d\\bar{\\Phi}_0}{du}\\right|_{u=0}=0$。\n球面平均的 F12 波函数是 $\\bar{\\Phi}_{F12}(u) \\approx \\mathcal{N}(1+cu)\\bar{\\Phi}_0(u)$。\n应用尖点条件：\n$\\bar{\\Phi}_{F12}(0) = \\mathcal{N}\\bar{\\Phi}_0(0)$。\n$\\left.\\frac{d\\bar{\\Phi}_{F12}}{du}\\right|_{u=0} = \\mathcal{N}\\left[c\\bar{\\Phi}_0(u) + (1+cu)\\frac{d\\bar{\\Phi}_0}{du}\\right]_{u=0} = \\mathcal{N}c\\bar{\\Phi}_0(0)$。\n条件 $\\left.\\frac{d\\bar{\\Phi}_{F12}}{du}\\right|_{u=0} = \\frac{1}{2}\\bar{\\Phi}_{F12}(0)$ 变为 $\\mathcal{N}c\\bar{\\Phi}_0(0) = \\frac{1}{2}\\mathcal{N}\\bar{\\Phi}_0(0)$。\n因为 $\\bar{\\Phi}_0(0) \\neq 0$，我们得到 $c = 1/2$。\n\n**任务2：非相关波函数的期望值**\n\n波函数 $\\Phi_0$ 是归一化的。我们计算形式为 $\\langle u^k \\rangle_0 = \\int u^k |\\Phi_0|^2 d\\tau_1 d\\tau_2$ 的期望值。\n密度是 $|\\Phi_0|^2 = (\\zeta^3/\\pi)^2 \\exp(-2\\zeta(r_1+r_2))$。在 Hylleraas 坐标 ($s=r_1+r_2$, $t=r_1-r_2$, $u=r_{12}$) 中，体积元是 $d\\tau_1 d\\tau_2 = \\pi^2 u(s^2-t^2)ds\\,dt\\,du$。积分极限是 $0 \\le u \\le s$ 和 $-u \\le t \\le u$。\n$|\\Phi_0|^2 = (\\zeta^3/\\pi)^2 \\exp(-2\\zeta s)$。\n$$\n\\langle u^k \\rangle_0 = \\frac{\\zeta^6}{\\pi^2} \\int_0^\\infty ds \\exp(-2\\zeta s) \\int_0^s du \\, u^{k+1} \\int_{-u}^u dt \\, \\pi^2 (s^2-t^2).\n$$\n关于 $t$ 的积分是 $\\int_{-u}^u (s^2-t^2)dt = [s^2 t - t^3/3]_{-u}^u = 2s^2u - 2u^3/3 = 2u(s^2 - u^2/3)$。\n$$\n\\langle u^k \\rangle_0 = 2\\zeta^6 \\int_0^\\infty ds \\exp(-2\\zeta s) \\int_0^s du \\, u^{k+2} (s^2 - u^2/3).\n$$\n关于 $u$ 的积分是 $\\int_0^s (s^2 u^{k+2} - \\frac{1}{3}u^{k+4})du = \\left[ \\frac{s^2 u^{k+3}}{k+3} - \\frac{u^{k+5}}{3(k+5)} \\right]_0^s = s^{k+5}\\left(\\frac{1}{k+3} - \\frac{1}{3(k+5)}\\right) = s^{k+5}\\frac{2k+12}{3(k+3)(k+5)}$。\n$$\n\\langle u^k \\rangle_0 = 2\\zeta^6 \\frac{2(k+6)}{3(k+3)(k+5)} \\int_0^\\infty s^{k+5} \\exp(-2\\zeta s) ds.\n$$\n使用标准积分 $\\int_0^\\infty x^n e^{-ax} dx = n!/a^{n+1}$，我们得到\n$$\n\\langle u^k \\rangle_0 = \\frac{4\\zeta^6(k+6)}{3(k+3)(k+5)} \\frac{(k+5)!}{(2\\zeta)^{k+6}} = \\frac{4\\zeta^6(k+6)(k+5)(k+4)!}{3(k+3)(k+5) 2^{k+6}\\zeta^{k+6}} = \\frac{4(k+6)(k+4)!}{3(k+3)2^{k+6}\\zeta^k}.\n$$\n我们对 $k=-1, 1, 2$ 计算此式：\n对于 $k=-1$: $\\langle u^{-1} \\rangle_0 = \\frac{4(5)(3!)}{3(2)2^5\\zeta^{-1}} = \\frac{120\\zeta}{192} = \\frac{5}{8}\\zeta$.\n对于 $k=1$: $\\langle u \\rangle_0 = \\frac{4(7)(5!)}{3(4)2^7\\zeta} = \\frac{28 \\cdot 120}{12 \\cdot 128\\zeta} = \\frac{3360}{1536\\zeta} = \\frac{35}{16\\zeta}$.\n对于 $k=2$: $\\langle u^2 \\rangle_0 = \\frac{4(8)(6!)}{3(5)2^8\\zeta^2} = \\frac{32 \\cdot 720}{15 \\cdot 256\\zeta^2} = \\frac{23040}{3840\\zeta^2} = \\frac{6}{\\zeta^2}$.\n\n**任务3：F12 拟设的排斥能**\n\n排斥能为 $J(c) = \\frac{\\left\\langle g(u)^{2}\\,u^{-1}\\right\\rangle_{0}}{\\left\\langle g(u)^{2}\\right\\rangle_{0}}$。对于 $g(u) = 1+cu$，我们有 $g(u)^2 = 1 + 2cu + c^2u^2$。\n分子是 $\\langle (1+2cu+c^2u^2)u^{-1} \\rangle_0 = \\langle u^{-1} + 2c + c^2u \\rangle_0 = \\langle u^{-1} \\rangle_0 + 2c\\langle 1 \\rangle_0 + c^2\\langle u \\rangle_0$。\n分母是 $\\langle 1+2cu+c^2u^2 \\rangle_0 = \\langle 1 \\rangle_0 + 2c\\langle u \\rangle_0 + c^2\\langle u^2 \\rangle_0$。\n使用 $\\langle 1 \\rangle_0 = 1$ 和任务2的结果：\n$$\nJ(c) = \\frac{\\frac{5}{8}\\zeta + 2c + c^2\\frac{35}{16\\zeta}}{1 + 2c\\frac{35}{16\\zeta} + c^2\\frac{6}{\\zeta^2}} = \\frac{\\frac{5}{8}\\zeta + 2c + \\frac{35c^2}{16\\zeta}}{1 + \\frac{35c}{8\\zeta} + \\frac{6c^2}{\\zeta^2}}.\n$$\n\n**任务4：非相关模型的能量变分最小化**\n\n$\\Phi_0$ 的变分能量为 $E_0(\\zeta) = \\langle \\Phi_0 | \\hat{H} | \\Phi_0 \\rangle$。\n$E_0(\\zeta) = 2\\langle \\varphi |-\\frac{1}{2}\\nabla^2| \\varphi \\rangle - 2Z\\langle \\varphi |\\frac{1}{r}| \\varphi \\rangle + \\langle \\Phi_0 |\\frac{1}{r_{12}}| \\Phi_0 \\rangle$。\n对于指数为 $\\zeta$ 的类氢 1s 轨道，期望值为 $\\langle T \\rangle = \\frac{\\zeta^2}{2}$ 和 $\\langle 1/r \\rangle = \\zeta$。\n电子排斥项是 $\\langle 1/r_{12} \\rangle_0 = \\langle u^{-1} \\rangle_0 = \\frac{5}{8}\\zeta$。\n因此，能量泛函是\n$$\nE_0(\\zeta) = 2\\left(\\frac{\\zeta^2}{2}\\right) - 2Z(\\zeta) + \\frac{5}{8}\\zeta = \\zeta^2 - \\left(2Z - \\frac{5}{8}\\right)\\zeta.\n$$\n为了找到最优指数 $\\zeta^\\star$，我们对 $E_0(\\zeta)$ 关于 $\\zeta$ 进行最小化：\n$\\frac{dE_0}{d\\zeta} = 2\\zeta - \\left(2Z - \\frac{5}{8}\\right) = 0$。\n这得到极小值点 $\\zeta^\\star = Z - \\frac{5}{16}$。\n\n**任务5：排斥能差的数值计算**\n\n给定 $Z=2$。\n由任务4，最优指数是 $\\zeta = \\zeta^\\star = 2 - \\frac{5}{16} = \\frac{27}{16}$。\n由任务1，尖点条件确定 $c = 1/2$。\n我们需要计算 $\\Delta J = J(c) - \\langle u^{-1} \\rangle_0$。\n首先，非相关排斥能是 $\\langle u^{-1} \\rangle_0 = \\frac{5}{8}\\zeta = \\frac{5}{8} \\cdot \\frac{27}{16} = \\frac{135}{128}$。\n现在我们计算 $c=1/2$ 和 $\\zeta=27/16$ 时的 $J(c)$。\n$J(c)$ 的分子是 $N = \\frac{5}{8}\\zeta + 2c + \\frac{35c^2}{16\\zeta} = \\frac{135}{128} + 1 + \\frac{35(1/4)}{16(27/16)} = \\frac{135+128}{128} + \\frac{35/4}{27} = \\frac{263}{128} + \\frac{35}{108}$。\n$128=2^7$ 和 $108=2^2 \\cdot 3^3$ 的最小公倍数是 $2^7 \\cdot 3^3 = 3456$。\n$N = \\frac{263 \\cdot 27 + 35 \\cdot 32}{3456} = \\frac{7101 + 1120}{3456} = \\frac{8221}{3456}$。\n$J(c)$ 的分母是 $D = 1 + \\frac{35c}{8\\zeta} + \\frac{6c^2}{\\zeta^2} = 1 + \\frac{35(1/2)}{8(27/16)} + \\frac{6(1/4)}{(27/16)^2} = 1 + \\frac{35/2}{27/2} + \\frac{3/2}{729/256} = 1 + \\frac{35}{27} + \\frac{3 \\cdot 128}{729} = 1 + \\frac{35}{27} + \\frac{128}{243}$。\n$27=3^3$ 和 $243=3^5$ 的最小公倍数是 $243$。\n$D = \\frac{243 + 35 \\cdot 9 + 128}{243} = \\frac{243 + 315 + 128}{243} = \\frac{686}{243}$。\n所以，$J(c) = \\frac{N}{D} = \\frac{8221/3456}{686/243} = \\frac{8221}{3456} \\cdot \\frac{243}{686}$。\n因为 $3456 = 128 \\times 27$ 且 $243 = 9 \\times 27$，该项变为 $\\frac{8221 \\cdot 9}{128 \\cdot 686} = \\frac{73989}{87808}$。\n差值为 $\\Delta J = J(c) - \\langle u^{-1} \\rangle_0 = \\frac{73989}{87808} - \\frac{135}{128}$。\n为了进行减法，我们使用公分母 $87808 = 128 \\times 686$。\n$\\Delta J = \\frac{73989 - 135 \\cdot 686}{87808} = \\frac{73989 - 92610}{87808} = -\\frac{18621}{87808}$。\n现在我们计算其数值：\n$\\Delta J \\approx -0.21206927$。\n四舍五入到四位有效数字得到 $-0.2121$。显式相关因子 $g(u)$ 平均而言使电子更靠近，但排斥积分 $J(c)$ 中的 $1/u$ 权重对分布更敏感。$J(c)$ 分母中的归一化解释了整体波函数形状的变化。负号表示这个特定的类 F12 排斥定义导致一个比简单的非相关值更低的值。", "answer": "$$\\boxed{-0.2121}$$", "id": "2891520"}, {"introduction": "满足尖点条件的理论优雅性转化为了强大的实践优势：向完全基组极限的收敛速度大大加快。本练习通过模拟反应能垒的计算——这是计算化学的基石——来量化这一优势[@problem_id:2773778]。您将应用已知的渐进误差公式，亲眼见证CCSD(T)-F12b方法与传统方法相比，能多快地达到化学精度，从而突显该方法对预测热化学的变革性影响。", "problem": "您需要利用关于电子-电子尖点及其导致的基组不完备性误差的第一性原理假设，对包含单、双和微扰三激发的耦合簇理论 (CCSD(T)) 及其显式相关变体 CCSD(T)-F12b（显式相关 F12 方法）中的反应势垒高度的基组收敛性进行建模。请完全在 Born–Oppenheimer 电子能量框架下进行。显式相关 ansatz 将电子间距离引入波函数以满足 Kato 尖点条件，从而加速了相关能相对于单电子基组基数的收敛。\n\n使用的基本依据和假设：\n- 反应的势垒高度是过渡态能量与反应物能量之差，两者均在同一势能面上定义，即势垒高度为 $B = E_{\\mathrm{TS}} - E_{\\mathrm{R}}$。\n- 对于相关一致性基组族，每个电子态的电子相关能中的主导基组不完备性误差随基组基数 $n$（例如，对于二重ζ基组，$n=2$；对于三重ζ基组，$n=3$）呈幂律衰减，其指数依赖于方法，反映了电子-电子尖点被处理得有多好。对于传统的仅含轨道方法，该指数较小；而当包含显式相关 (R12/F12) 项时，该指数较大。由于反应物和过渡态的相关特性不同，其比例常数可能不同。\n\n任务：\n1. 从势垒定义 $B = E_{\\mathrm{TS}} - E_{\\mathrm{R}}$ 和能量差的线性关系出发，推导主导阶势垒高度误差如何依赖于基组基数 $n$、依赖于方法的收敛指数以及特定于状态的比例常数。对常规 CCSD(T) 和 CCSD(T)-F12b 分别进行推导。除了上述假设和势垒高度的定义外，不应调用任何捷径或现成的公式。\n2. 使用您推导出的表达式，编写一个程序，为下面的测试集中的每个反应，计算在 $n=2$（二重ζ）和 $n=3$（三重ζ）下 CCSD(T) 和 CCSD(T)-F12b 的势垒高度误差，然后在整个测试集上汇总以下指标，所有指标均以千焦耳/摩尔表示：\n   - CCSD(T) 在 $n=2$ 时的平均绝对误差 (MAE)。\n   - CCSD(T)-F12b 在 $n=2$ 时的平均绝对误差 (MAE)。\n   - CCSD(T) 在 $n=3$ 时的平均绝对误差 (MAE)。\n   - CCSD(T)-F12b 在 $n=3$ 时的平均绝对误差 (MAE)。\n   - CCSD(T) 在 $n=2$ 时的最大绝对误差。\n   - CCSD(T)-F12b 在 $n=2$ 时的最大绝对误差。\n   - CCSD(T) 在 $n=3$ 时的最大绝对误差。\n   - CCSD(T)-F12b 在 $n=3$ 时的最大绝对误差。\n   - 对于 CCSD(T) 在 $n=2$ 时，绝对误差小于或等于化学精度阈值 $1$ kcal/mol 的反应所占的比例（以小数表示，而非百分比），其中 $1$ kcal/mol $= 4.184$ kJ/mol。\n   - 对于 CCSD(T)-F12b 在 $n=2$ 时，处于相同阈值内的比例（以小数表示）。\n   - 对于 CCSD(T) 在 $n=3$ 时，处于相同阈值内的比例（以小数表示）。\n   - 对于 CCSD(T)-F12b 在 $n=3$ 时，处于相同阈值内的比例（以小数表示）。\n3. 使用以下测试集。对于每个反应 $i$，相对于反应物提供了完备基组 (CBS) 势垒高度 $B^{\\mathrm{CBS}}_i$（单位 kJ/mol），并给出了两种方法下反应物和过渡态的主导阶比例常数。使用常规 CCSD(T) 指数 $p = 3$ 和 CCSD(T)-F12b 指数 $p_{\\mathrm{F12}} = 6$。假设反应物的 CBS 能量为 $0$ kJ/mol（定义能量零点），且过渡态的 CBS 能量等于给定的 CBS 势垒高度 $B^{\\mathrm{CBS}}_i$。\n   - 反应 A：$B^{\\mathrm{CBS}}_1 = 100.0$，CCSD(T) $A_{\\mathrm{R}} = 30.0$, $A_{\\mathrm{TS}} = 50.0$；CCSD(T)-F12b $A^{\\mathrm{F12}}_{\\mathrm{R}} = 3.0$, $A^{\\mathrm{F12}}_{\\mathrm{TS}} = 4.5$。\n   - 反应 B：$B^{\\mathrm{CBS}}_2 = 180.0$，CCSD(T) $A_{\\mathrm{R}} = 60.0$, $A_{\\mathrm{TS}} = 35.0$；CCSD(T)-F12b $A^{\\mathrm{F12}}_{\\mathrm{R}} = 6.0$, $A^{\\mathrm{F12}}_{\\mathrm{TS}} = 3.5$。\n   - 反应 C：$B^{\\mathrm{CBS}}_3 = 15.0$，CCSD(T) $A_{\\mathrm{R}} = 0.0$, $A_{\\mathrm{TS}} = 0.0$；CCSD(T)-F12b $A^{\\mathrm{F12}}_{\\mathrm{R}} = 0.0$, $A^{\\mathrm{F12}}_{\\mathrm{TS}} = 0.0$。\n   - 反应 D：$B^{\\mathrm{CBS}}_4 = 250.0$，CCSD(T) $A_{\\mathrm{R}} = 45.0$, $A_{\\mathrm{TS}} = 120.0$；CCSD(T)-F12b $A^{\\mathrm{F12}}_{\\mathrm{R}} = 4.5$, $A^{\\mathrm{F12}}_{\\mathrm{TS}} = 10.0$。\n4. 角度单位不适用。所有与能量相关的量都必须以 kJ/mol 计算和报告。在计算 $1$ kcal/mol 阈值内的比例时，使用 $4.184$ kJ/mol作为阈值。将比例表示为 $0$ 和 $1$ 之间（含两端）的小数。\n5. 您的程序应生成单行输出，其中包含一个逗号分隔的列表，包含按以下精确顺序排列的 $12$ 个数字：\n   1) CCSD(T) 在 $n=2$ 时的 MAE，2) CCSD(T)-F12b 在 $n=2$ 时的 MAE，3) CCSD(T) 在 $n=3$ 时的 MAE，4) CCSD(T)-F12b 在 $n=3$ 时的 MAE，5) CCSD(T) 在 $n=2$ 时的最大误差，6) CCSD(T)-F12b 在 $n=2$ 时的最大误差，7) CCSD(T) 在 $n=3$ 时的最大误差，8) CCSD(T)-F12b 在 $n=3$ 时的最大误差，9) CCSD(T) 在 $n=2$ 时误差在 $1$ kcal/mol 内的比例，10) CCSD(T)-F12b 在 $n=2$ 时误差在 $1$ kcal/mol 内的比例，11) CCSD(T) 在 $n=3$ 时误差在 $1$ kcal/mol 内的比例，12) CCSD(T)-F12b 在 $n=3$ 时误差在 $1$ kcal/mol 内的比例。将每个数字四舍五入到三位小数。最终输出必须以 `[x1,x2,x3,...,x12]` 的格式打印为单行。\n\n测试集覆盖范围的设计说明：\n- 反应 C 强制执行了主导阶误差在反应物和过渡态之间完全抵消的边界情况。\n- 反应 A 和 D 探究了中等和大幅度的正误差前因子差异。\n- 反应 B 探究了负误差前因子差异，用于在评估绝对误差指标时测试符号处理。", "solution": "问题陈述已经过严格验证，被认为是有效的。它在科学上基于量子化学原理，特别是电子结构理论，并且在数学上是适定的。所有必要的数据和约束都已提供，构成了一个自洽且逻辑严密的问题。因此，我们可以着手进行推导和求解。\n\n该问题需要一个分两部分的解决方案：首先，推导计算出的反应势垒高度的基组误差；其次，通过数值实现来量化常规和显式相关量子化学方法在给定测试集上的这种误差。\n\n我们从推导开始。基本前提是使用基数为 $n$ 的基组计算的电子能量的渐近行为。对于给定的电子态 $S$（可以是反应物 $S = \\mathrm{R}$ 或过渡态 $S = \\mathrm{TS}$），其能量 $E_S(n)$ 逼近完备基组 (CBS) 极限能量 $E_S^{\\mathrm{CBS}}$，其主导阶误差项如下：\n$$E_S(n) \\approx E_S^{\\mathrm{CBS}} + \\frac{A_S}{n^p}$$\n此处，$A_S$ 是一个取决于电子态 $S$ 具体情况的比例常数，而 $p$ 是一个取决于所用理论方法的指数。项 $\\frac{A_S}{n^p}$ 表示基组不完备性误差 (BSIE)，其值为正，因为使用有限基组的变分计算得出的能量高于真实的 CBS 极限。\n\n反应势垒高度 $B$ 定义为过渡态和反应物之间的能量差：\n$$B(n) = E_{\\mathrm{TS}}(n) - E_{\\mathrm{R}}(n)$$\n这是用基数为 $n$ 的基组计算的势垒高度。真实的，即 CBS 势垒高度为：\n$$B^{\\mathrm{CBS}} = E_{\\mathrm{TS}}^{\\mathrm{CBS}} - E_{\\mathrm{R}}^{\\mathrm{CBS}}$$\n为了推导势垒高度的误差，我们将 $E_{\\mathrm{TS}}(n)$ 和 $E_{\\mathrm{R}}(n)$ 的表达式代入 $B(n)$ 的方程中：\n$$B(n) \\approx \\left( E_{\\mathrm{TS}}^{\\mathrm{CBS}} + \\frac{A_{\\mathrm{TS}}}{n^p} \\right) - \\left( E_{\\mathrm{R}}^{\\mathrm{CBS}} + \\frac{A_{\\mathrm{R}}}{n^p} \\right)$$\n根据操作的线性关系，我们可以重新排列各项，将 CBS 分量与误差分量分开：\n$$B(n) \\approx (E_{\\mathrm{TS}}^{\\mathrm{CBS}} - E_{\\mathrm{R}}^{\\mathrm{CBS}}) + \\left( \\frac{A_{\\mathrm{TS}}}{n^p} - \\frac{A_{\\mathrm{R}}}{n^p} \\right)$$\n认识到第一项是 CBS 势垒高度 $B^{\\mathrm{CBS}}$，上式简化为：\n$$B(n) \\approx B^{\\mathrm{CBS}} + \\frac{A_{\\mathrm{TS}} - A_{\\mathrm{R}}}{n^p}$$\n势垒高度的误差 $\\Delta B(n)$ 是计算值 $B(n)$ 与真实值 $B^{\\mathrm{CBS}}$ 之间的差：\n$$\\Delta B(n) = B(n) - B^{\\mathrm{CBS}}$$\n从我们推导出的 $B(n)$ 表达式，我们得到主导阶势垒高度误差的最终公式：\n$$\\Delta B(n) \\approx \\frac{A_{\\mathrm{TS}} - A_{\\mathrm{R}}}{n^p}$$\n这个结果是根本性的。它表明能量差的误差与单个能量的误差遵循相同的幂律收敛，但其大小由比例常数之差 $A_{\\mathrm{TS}} - A_{\\mathrm{R}}$ 决定。这意味着如果反应物和过渡态的基组误差相似（即 $A_{\\mathrm{TS}} \\approx A_{\\mathrm{R}}$），就可能发生误差的偶然抵消，导致势垒高度的误差小于单个能量的误差。\n\n现在我们将此公式应用于问题中给出的具体方法。\n对于常规 CCSD(T)，指数为 $p = 3$：\n$$\\Delta B_{\\mathrm{CCSD(T)}}(n) \\approx \\frac{A_{\\mathrm{TS}} - A_{\\mathrm{R}}}{n^3}$$\n对于显式相关的 CCSD(T)-F12b 方法，该方法旨在更好地模拟电子-电子尖点，因此表现出更快的收敛速度，其指数为 $p_{\\mathrm{F12}} = 6$：\n$$\\Delta B_{\\mathrm{CCSD(T)-F12b}}(n) \\approx \\frac{A^{\\mathrm{F12}}_{\\mathrm{TS}} - A^{\\mathrm{F12}}_{\\mathrm{R}}}{n^6}$$\n\n第二项任务是为所提供的测试集进行数值分析。下面的程序使用这些公式计算每个反应的绝对势垒高度误差 $|\\Delta B(n)|$，其中基数 $n=2$（二重ζ）和 $n=3$（三重ζ）。然后，它计算并汇总指定的十二个统计指标：两种方法在两种基组水平下的平均绝对误差 (MAE) 和最大绝对误差 (MaxAE)，以及绝对误差在化学精度阈值 $1.0 \\, \\text{kcal/mol}$ ($4.184 \\, \\text{kJ/mol}$) 内的反应比例。\n\n计算将定量地展示 CCSD(T)-F12b 方法的巨大优越性。由于 $n^{-6}$ 的误差衰减，我们预期即使使用小的 $n=2$ 基组，F12 方法产生的误差也将显著小于使用更大 $n=3$ 基组的常规 CCSD(T) 方法，后者仅受益于 $n^{-3}$ 的衰减。所提供的程序将证实这一预期。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates basis-set convergence metrics for CCSD(T) and CCSD(T)-F12b\n    reaction barrier heights based on a first-principles error model.\n    \"\"\"\n    \n    # Define model parameters\n    p_conv = 3.0  # Exponent for conventional CCSD(T)\n    p_f12 = 6.0   # Exponent for CCSD(T)-F12b\n    chem_acc_kjmol = 4.184  # 1 kcal/mol in kJ/mol\n\n    # Define the test suite of reactions\n    # Each tuple contains: Reaction Name, B_CBS, A_R(conv), A_TS(conv), A_R(F12), A_TS(F12)\n    test_suite = [\n        ('A', 100.0, 30.0, 50.0, 3.0, 4.5),\n        ('B', 180.0, 60.0, 35.0, 6.0, 3.5),\n        ('C', 15.0, 0.0, 0.0, 0.0, 0.0),\n        ('D', 250.0, 45.0, 120.0, 4.5, 10.0),\n    ]\n\n    num_reactions = len(test_suite)\n    \n    # Lists to store absolute errors for each category\n    abs_errors_conv_n2 = []\n    abs_errors_f12_n2 = []\n    abs_errors_conv_n3 = []\n    abs_errors_f12_n3 = []\n\n    # Calculate errors for each reaction\n    for _, _, ar_conv, ats_conv, ar_f12, ats_f12 in test_suite:\n        # CCSD(T) errors\n        delta_B_conv_n2 = (ats_conv - ar_conv) / (2**p_conv)\n        delta_B_conv_n3 = (ats_conv - ar_conv) / (3**p_conv)\n        \n        # CCSD(T)-F12b errors\n        delta_B_f12_n2 = (ats_f12 - ar_f12) / (2**p_f12)\n        delta_B_f12_n3 = (ats_f12 - ar_f12) / (3**p_f12)\n        \n        # Store absolute errors\n        abs_errors_conv_n2.append(abs(delta_B_conv_n2))\n        abs_errors_conv_n3.append(abs(delta_B_conv_n3))\n        abs_errors_f12_n2.append(abs(delta_B_f12_n2))\n        abs_errors_f12_n3.append(abs(delta_B_f12_n3))\n\n    # Calculate metrics\n    # Mean Absolute Errors\n    mae_conv_n2 = np.mean(abs_errors_conv_n2)\n    mae_f12_n2 = np.mean(abs_errors_f12_n2)\n    mae_conv_n3 = np.mean(abs_errors_conv_n3)\n    mae_f12_n3 = np.mean(abs_errors_f12_n3)\n    \n    # Maximum Absolute Errors\n    max_conv_n2 = np.max(abs_errors_conv_n2)\n    max_f12_n2 = np.max(abs_errors_f12_n2)\n    max_conv_n3 = np.max(abs_errors_conv_n3)\n    max_f12_n3 = np.max(abs_errors_f12_n3)\n\n    # Fractions within chemical accuracy\n    frac_conv_n2 = sum(1 for err in abs_errors_conv_n2 if err <= chem_acc_kjmol) / num_reactions\n    frac_f12_n2 = sum(1 for err in abs_errors_f12_n2 if err <= chem_acc_kjmol) / num_reactions\n    frac_conv_n3 = sum(1 for err in abs_errors_conv_n3 if err <= chem_acc_kjmol) / num_reactions\n    frac_f12_n3 = sum(1 for err in abs_errors_f12_n3 if err <= chem_acc_kjmol) / num_reactions\n\n    results = [\n        mae_conv_n2, mae_f12_n2, mae_conv_n3, mae_f12_n3,\n        max_conv_n2, max_f12_n2, max_conv_n3, max_f12_n3,\n        frac_conv_n2, frac_f12_n2, frac_conv_n3, frac_f12_n3\n    ]\n\n    # Format results to three decimal places and print\n    formatted_results = [f\"{res:.3f}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2773778"}, {"introduction": "除了共价键的断裂与形成，F12方法在精确描述非共价相互作用方面也具有革命性意义。最后一个练习提供了几个分子二聚体的基准数据，让您能够诊断基组收敛的两个关键方面：基组重叠误差（BSSE）和对色散力的描述[@problem_id:2639428]。通过计算这些诊断指标，您不仅能体会到F12方法如何减轻像BSSE这样的巨大误差，还能学会如何以具有物理意义的方式分析微小的残余偏差。", "problem": "给定一个小的非共价二聚体基准数据集，其中包含在完全基组 (CBS) 极限下的参考相互作用能，以及由常规轨道方法和显式相关 (F12) 方法计算的有限基组相互作用能。您的任务是形式化定义并计算相关指标，以量化显式相关方法相对于基准如何影响相互作用能的精度，并诊断残余基组叠加误差 (BSSE) 和色散缺陷。所有能量均以千焦每摩尔为单位，所有答案必须以千焦每摩尔为单位表示，并四舍五入到三位小数。\n\n从以下基本且经过充分检验的定义开始。\n\n- 二聚体的相互作用能定义为 $E_{\\mathrm{int}} = E_{AB} - (E_A + E_B)$，其中 $E_{AB}$ 是二聚体的总能量，$E_A$ 和 $E_B$ 是孤立单体的总能量。符号约定为：稳定化相互作用对应于 $E_{\\mathrm{int}} < 0$。\n- 由 Boys and Bernardi 提出的用于校正基组叠加误差的平衡 (CP) 校正，其定义是通过在存在鬼基函数的情况下计算单体能量。经过 CP 校正的相互作用能为 $E_{\\mathrm{int}}^{\\mathrm{CP}} = E_{AB} - (E_A^{\\mathrm{ghost}} + E_B^{\\mathrm{ghost}})$。未校正的相互作用能为 $E_{\\mathrm{int}}^{\\mathrm{noCP}} = E_{AB} - (E_A + E_B)$。\n- 在给定水平下，BSSE 的大小在此量化为带符号的差值 $B = E_{\\mathrm{int}}^{\\mathrm{noCP}} - E_{\\mathrm{int}}^{\\mathrm{CP}}$。负的 $B$ 值表示由于 BSSE 引起的人为过结合。\n- 任何有限基组相互作用能与 CBS 参考值之间的偏差定义为 $\\Delta = E_{\\mathrm{int}}^{\\mathrm{finite}} - E_{\\mathrm{ref}}$，其中 $E_{\\mathrm{ref}}$ 是 CBS 相互作用能。正的 $\\Delta$ 值表示相对于参考值的欠结合。\n- 为诊断色散缺陷，考虑一个标准的能量分解 $E_{\\mathrm{ref}} = E_{\\mathrm{elec}} + E_{\\mathrm{ind}} + E_{\\mathrm{exch}} + E_{\\mathrm{disp}}$。对于每个案例，都给定一个色散模型估计值 $D_{\\mathrm{model}}$，它在参考水平上从大小和符号上近似于 $E_{\\mathrm{disp}}$。定义色散分数 $f_{\\mathrm{disp}} = \\min\\{1, |D_{\\mathrm{model}}|/|E_{\\mathrm{ref}}|\\}$。给定方法的色散缺陷指数定义为其残余偏差在色散分量上的投影，即 $D = f_{\\mathrm{disp}} \\cdot \\Delta$，它量化了残余误差中可合理解释为由不完美的色散描述所引起的部分。\n\n您必须实现一个程序，为每个测试案例计算以下量：\n- 相对于 CBS 参考值的 CP 校正偏差，用于三种情况：常规 triple-$\\zeta$ 基组、显式相关 double-$\\zeta$ 基组和显式相关 triple-$\\zeta$ 基组，即 $\\Delta_{\\mathrm{conv},\\mathrm{TZ}}$、$\\Delta_{\\mathrm{F12},\\mathrm{DZ}}$ 和 $\\Delta_{\\mathrm{F12},\\mathrm{TZ}}$。\n- 常规方法和 F12 方法在 triple-$\\zeta$ 基组下的残余 BSSE，即 $B_{\\mathrm{conv},\\mathrm{TZ}}$ 和 $B_{\\mathrm{F12},\\mathrm{TZ}}$。\n- F12 triple-$\\zeta$ 水平下的色散缺陷指数，$D_{\\mathrm{F12},\\mathrm{TZ}}$。\n\n您的程序必须使用以下测试套件（四个二聚体），其中每个元组提供标签、$E_{\\mathrm{ref}}$、$D_{\\mathrm{model}}$、$E_{\\mathrm{conv},\\mathrm{TZ}}^{\\mathrm{CP}}$、$E_{\\mathrm{conv},\\mathrm{TZ}}^{\\mathrm{noCP}}$、$E_{\\mathrm{F12},\\mathrm{DZ}}^{\\mathrm{CP}}$、$E_{\\mathrm{F12},\\mathrm{DZ}}^{\\mathrm{noCP}}、$E_{\\mathrm{F12},\\mathrm{TZ}}^{\\mathrm{CP}}、$E_{\\mathrm{F12},\\mathrm{TZ}}^{\\mathrm{noCP}}$；所有能量单位均为 $\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$：\n- 水二聚体：标签 = \"H2O...H2O\"，$E_{\\mathrm{ref}} = -21.0$，$D_{\\mathrm{model}} = -3.0$，$E_{\\mathrm{conv},\\mathrm{TZ}}^{\\mathrm{CP}} = -19.8$，$E_{\\mathrm{conv},\\mathrm{TZ}}^{\\mathrm{noCP}} = -21.0$，$E_{\\mathrm{F12},\\mathrm{DZ}}^{\\mathrm{CP}} = -20.7$，$E_{\\mathrm{F12},\\mathrm{DZ}}^{\\mathrm{noCP}} = -21.5$，$E_{\\mathrm{F12},\\mathrm{TZ}}^{\\mathrm{CP}} = -21.1$，$E_{\\mathrm{F12},\\mathrm{TZ}}^{\\mathrm{noCP}} = -21.4$。\n- 甲烷二聚体：标签 = \"CH4...CH4\"，$E_{\\mathrm{ref}} = -2.5$，$D_{\\mathrm{model}} = -2.5$，$E_{\\mathrm{conv},\\mathrm{TZ}}^{\\mathrm{CP}} = -1.6$，$E_{\\mathrm{conv},\\mathrm{TZ}}^{\\mathrm{noCP}} = -2.0$，$E_{\\mathrm{F12},\\mathrm{DZ}}^{\\mathrm{CP}} = -2.2$，$E_{\\mathrm{F12},\\mathrm{DZ}}^{\\mathrm{noCP}} = -2.4$，$E_{\\mathrm{F12},\\mathrm{TZ}}^{\\mathrm{CP}} = -2.4$，$E_{\\mathrm{F12},\\mathrm{TZ}}^{\\mathrm{noCP}} = -2.6$。\n- 苯二聚体（平行错位）：标签 = \"C6H6...C6H6\"，$E_{\\mathrm{ref}} = -12.0$，$D_{\\mathrm{model}} = -10.0$，$E_{\\mathrm{conv},\\mathrm{TZ}}^{\\mathrm{CP}} = -9.0$，$E_{\\mathrm{conv},\\mathrm{TZ}}^{\\mathrm{noCP}} = -10.5$，$E_{\\mathrm{F12},\\mathrm{DZ}}^{\\mathrm{CP}} = -10.8$，$E_{\\mathrm{F12},\\mathrm{DZ}}^{\\mathrm{noCP}} = -11.4$，$E_{\\mathrm{F12},\\mathrm{TZ}}^{\\mathrm{CP}} = -11.5$，$E_{\\mathrm{F12},\\mathrm{TZ}}^{\\mathrm{noCP}} = -12.0$。\n- 氖二聚体：标签 = \"Ne...Ne\"，$E_{\\mathrm{ref}} = -0.30$，$D_{\\mathrm{model}} = -0.30$，$E_{\\mathrm{conv},\\mathrm{TZ}}^{\\mathrm{CP}} = -0.10$，$E_{\\mathrm{conv},\\mathrm{TZ}}^{\\mathrm{noCP}} = -0.16$，$E_{\\mathrm{F12},\\mathrm{DZ}}^{\\mathrm{CP}} = -0.22$，$E_{\\mathrm{F12},\\mathrm{DZ}}^{\\mathrm{noCP}} = -0.25$，$E_{\\mathrm{F12},\\mathrm{TZ}}^{\\mathrm{CP}} = -0.27$，$E_{\\mathrm{F12},\\mathrm{TZ}}^{\\mathrm{noCP}} = -0.29$。\n\n对于每个测试案例，计算有序结果向量\n$[\\Delta_{\\mathrm{conv},\\mathrm{TZ}}, \\Delta_{\\mathrm{F12},\\mathrm{DZ}}, \\Delta_{\\mathrm{F12},\\mathrm{TZ}}, B_{\\mathrm{conv},\\mathrm{TZ}}, B_{\\mathrm{F12},\\mathrm{TZ}}, D_{\\mathrm{F12},\\mathrm{TZ}}]$，\n其中所有量的单位均为 $\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$ 并四舍五入到三位小数。\n\n最终输出格式规范：\n- 您的程序应生成单行输出，其中包含每个案例的结果向量列表，顺序与上述测试套件相同，形式为用方括号括起来的逗号分隔列表。例如：$[[r_{1,1}, r_{1,2}, \\dots, r_{1,6}], [r_{2,1}, \\dots], \\dots]$。\n- 不应打印任何额外文本。", "solution": "所述问题已经过严格验证。所有提供的定义、数据和约束都被认为是科学上合理、内部一致且足以完成任务的。该问题是计算化学领域一个良构的练习，要求基于既定原则对方法性能进行定量分析。因此，该问题被视为有效，我们将着手解决。\n\n目标是为四个非共价二聚体计算一组六个诊断指标，以量化常规电子结构方法和显式相关 (F12) 方法相对于完全基组 (CBS) 基准的准确性和误差特征。所有能量量的单位均隐含为 $\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$。\n\n需要为每个二聚体计算的量定义如下：\n\n1.  **参考偏差 ($\\Delta$)**：该指标衡量有限基组相互作用能相对于基准 CBS 值 $E_{\\mathrm{ref}}$ 的误差。其定义为 $\\Delta = E_{\\mathrm{int}}^{\\mathrm{finite}} - E_{\\mathrm{ref}}$。正值表示该方法相对于参考值对二聚体的结合预测不足（欠结合）。我们将使用三种方法的平衡 (CP) 校正相互作用能来计算此值：\n    $$ \\Delta_{\\mathrm{conv},\\mathrm{TZ}} = E_{\\mathrm{conv},\\mathrm{TZ}}^{\\mathrm{CP}} - E_{\\mathrm{ref}} $$\n    $$ \\Delta_{\\mathrm{F12},\\mathrm{DZ}} = E_{\\mathrm{F12},\\mathrm{DZ}}^{\\mathrm{CP}} - E_{\\mathrm{ref}} $$\n    $$ \\Delta_{\\mathrm{F12},\\mathrm{TZ}} = E_{\\mathrm{F12},\\mathrm{TZ}}^{\\mathrm{CP}} - E_{\\mathrm{ref}} $$\n\n2.  **基组叠加误差 ($B$)**：该指标量化了由于基组不完备而产生的人为稳定化，其中一个单体“借用”了另一个单体的基函数。它定义为未校正 ($E_{\\mathrm{int}}^{\\mathrm{noCP}}$) 和 CP 校正 ($E_{\\mathrm{int}}^{\\mathrm{CP}}$) 相互作用能之间的差值：$B = E_{\\mathrm{int}}^{\\mathrm{noCP}} - E_{\\mathrm{int}}^{\\mathrm{CP}}$。负值对应于人为的过结合。我们将为常规方法和 F12 方法在 triple-$\\zeta$ 基组下计算此值：\n    $$ B_{\\mathrm{conv},\\mathrm{TZ}} = E_{\\mathrm{conv},\\mathrm{TZ}}^{\\mathrm{noCP}} - E_{\\mathrm{conv},\\mathrm{TZ}}^{\\mathrm{CP}} $$\n    $$ B_{\\mathrm{F12},\\mathrm{TZ}} = E_{\\mathrm{F12},\\mathrm{TZ}}^{\\mathrm{noCP}} - E_{\\mathrm{F12},\\mathrm{TZ}}^{\\mathrm{CP}} $$\n\n3.  **色散缺陷指数 ($D$)**：该指数估计了总误差 ($\\Delta$) 中可归因于对伦敦色散力描述不准确的部分。它是通过将误差投影到相互作用的色散分量上来计算的。首先，确定色散分数 $f_{\\mathrm{disp}}$：\n    $$ f_{\\mathrm{disp}} = \\min\\left\\{1, \\frac{|D_{\\mathrm{model}}|}{|E_{\\mathrm{ref}}|}\\right\\} $$\n    其中 $D_{\\mathrm{model}}$ 是色散能的模型估计值。然后，F12 方法在 triple-$\\zeta$ 基组下的缺陷指数为：\n    $$ D_{\\mathrm{F12},\\mathrm{TZ}} = f_{\\mathrm{disp}} \\cdot \\Delta_{\\mathrm{F12},\\mathrm{TZ}} $$\n\n现在，我们将系统地将这些公式应用于每个测试案例。作为一个说明性示例，我们将详细说明水二聚体的计算过程。\n\n**案例 1：水二聚体 (H2O...H2O)**\n给定数据：$E_{\\mathrm{ref}} = -21.0$, $D_{\\mathrm{model}} = -3.0$, $E_{\\mathrm{conv},\\mathrm{TZ}}^{\\mathrm{CP}} = -19.8$, $E_{\\mathrm{conv},\\mathrm{TZ}}^{\\mathrm{noCP}} = -21.0$, $E_{\\mathrm{F12},\\mathrm{DZ}}^{\\mathrm{CP}} = -20.7$, $E_{\\mathrm{F12},\\mathrm{TZ}}^{\\mathrm{CP}} = -21.1$, $E_{\\mathrm{F12},\\mathrm{TZ}}^{\\mathrm{noCP}} = -21.4$。\n\n1.  $\\Delta_{\\mathrm{conv},\\mathrm{TZ}} = -19.8 - (-21.0) = 1.2$\n2.  $\\Delta_{\\mathrm{F12},\\mathrm{DZ}} = -20.7 - (-21.0) = 0.3$\n3.  $\\Delta_{\\mathrm{F12},\\mathrm{TZ}} = -21.1 - (-21.0) = -0.1$\n4.  $B_{\\mathrm{conv},\\mathrm{TZ}} = -21.0 - (-19.8) = -1.2$\n5.  $B_{\\mathrm{F12},\\mathrm{TZ}} = -21.4 - (-21.1) = -0.3$\n6.  对于 $D_{\\mathrm{F12},\\mathrm{TZ}}$:\n    $f_{\\mathrm{disp}} = \\min\\left\\{1, \\frac{|-3.0|}{|-21.0|}\\right\\} = \\min\\left\\{1, \\frac{3.0}{21.0}\\right\\} \\approx 0.142857$\n    $D_{\\mathrm{F12},\\mathrm{TZ}} = 0.142857 \\times (-0.1) \\approx -0.014$\n\n水二聚体的结果向量是 $[1.200, 0.300, -0.100, -1.200, -0.300, -0.014]$。\n\n对剩下的三个体系重复此过程。计算是初等的，执行如下：\n\n**案例 2：甲烷二聚体 (CH4...CH4)**\n- $E_{\\mathrm{ref}} = -2.5$, $D_{\\mathrm{model}} = -2.5$\n- $\\Delta_{\\mathrm{conv},\\mathrm{TZ}} = -1.6 - (-2.5) = 0.9$\n- $\\Delta_{\\mathrm{F12},\\mathrm{DZ}} = -2.2 - (-2.5) = 0.3$\n- $\\Delta_{\\mathrm{F12},\\mathrm{TZ}} = -2.4 - (-2.5) = 0.1$\n- $B_{\\mathrm{conv},\\mathrm{TZ}} = -2.0 - (-1.6) = -0.4$\n- $B_{\\mathrm{F12},\\mathrm{TZ}} = -2.6 - (-2.4) = -0.2$\n- $f_{\\mathrm{disp}} = \\min\\{1, |-2.5|/|-2.5|\\} = 1.0$。$D_{\\mathrm{F12},\\mathrm{TZ}} = 1.0 \\times 0.1 = 0.1$\n- 结果： $[0.900, 0.300, 0.100, -0.400, -0.200, 0.100]$\n\n**案例 3：苯二聚体 (C6H6...C6H6)**\n- $E_{\\mathrm{ref}} = -12.0$, $D_{\\mathrm{model}} = -10.0$\n- $\\Delta_{\\mathrm{conv},\\mathrm{TZ}} = -9.0 - (-12.0) = 3.0$\n- $\\Delta_{\\mathrm{F12},\\mathrm{DZ}} = -10.8 - (-12.0) = 1.2$\n- $\\Delta_{\\mathrm{F12},\\mathrm{TZ}} = -11.5 - (-12.0) = 0.5$\n- $B_{\\mathrm{conv},\\mathrm{TZ}} = -10.5 - (-9.0) = -1.5$\n- $B_{\\mathrm{F12},\\mathrm{TZ}} = -12.0 - (-11.5) = -0.5$\n- $f_{\\mathrm{disp}} = \\min\\{1, |-10.0|/|-12.0|\\} \\approx 0.833333$。$D_{\\mathrm{F12},\\mathrm{TZ}} = 0.833333 \\times 0.5 \\approx 0.417$\n- 结果： $[3.000, 1.200, 0.500, -1.500, -0.500, 0.417]$\n\n**案例 4：氖二聚体 (Ne...Ne)**\n- $E_{\\mathrm{ref}} = -0.30$, $D_{\\mathrm{model}} = -0.30$\n- $\\Delta_{\\mathrm{conv},\\mathrm{TZ}} = -0.10 - (-0.30) = 0.20$\n- $\\Delta_{\\mathrm{F12},\\mathrm{DZ}} = -0.22 - (-0.30) = 0.08$\n- $\\Delta_{\\mathrm{F12},\\mathrm{TZ}} = -0.27 - (-0.30) = 0.03$\n- $B_{\\mathrm{conv},\\mathrm{TZ}} = -0.16 - (-0.10) = -0.06$\n- $B_{\\mathrm{F12},\\mathrm{TZ}} = -0.29 - (-0.27) = -0.02$\n- $f_{\\mathrm{disp}} = \\min\\{1, |-0.30|/|-0.30|\\} = 1.0$。$D_{\\mathrm{F12},\\mathrm{TZ}} = 1.0 \\times 0.03 = 0.03$\n- 结果： $[0.200, 0.080, 0.030, -0.060, -0.020, 0.030]$\n\n结果证明了 F12 方法的已知优点。与常规方法相比，F12 方法的 CBS 极限偏差 $\\Delta$ 系统地更小，即使 F12 方法使用的是比常规方法 (TZ) 更小的 (DZ) 基组。此外，从常规方法转换为 F12 方法后，TZ 水平上的残余 BSSE ($B$) 显著减小。色散缺陷指数 $D$ 有助于将剩余的微小误差归因于一个物理原因。\n\n实现一个执行这些计算的程序，就是将上述公式直接转换。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes diagnostic metrics for noncovalent interaction energies for a\n    benchmark dataset, comparing conventional and explicitly correlated (F12)\n    quantum chemistry methods.\n    \"\"\"\n    \n    # Test suite data: Each tuple contains:\n    # (label, E_ref, D_model, E_conv_TZ_CP, E_conv_TZ_noCP, E_F12_DZ_CP, \n    # E_F12_DZ_noCP, E_F12_TZ_CP, E_F12_TZ_noCP)\n    # All energies are in kJ/mol.\n    test_cases = [\n        (\"H2O...H2O\", -21.0, -3.0, -19.8, -21.0, -20.7, -21.5, -21.1, -21.4),\n        (\"CH4...CH4\", -2.5, -2.5, -1.6, -2.0, -2.2, -2.4, -2.4, -2.6),\n        (\"C6H6...C6H6\", -12.0, -10.0, -9.0, -10.5, -10.8, -11.4, -11.5, -12.0),\n        (\"Ne...Ne\", -0.30, -0.30, -0.10, -0.16, -0.22, -0.25, -0.27, -0.29),\n    ]\n\n    results = []\n    for case in test_cases:\n        (\n            label,\n            E_ref,\n            D_model,\n            E_conv_TZ_CP,\n            E_conv_TZ_noCP,\n            E_F12_DZ_CP,\n            E_F12_DZ_noCP, # This value is not used in the requested calculations\n            E_F12_TZ_CP,\n            E_F12_TZ_noCP,\n        ) = case\n\n        # 1. Deviations from reference (Delta)\n        # Delta = E_int_finite - E_ref\n        delta_conv_TZ = E_conv_TZ_CP - E_ref\n        delta_F12_DZ = E_F12_DZ_CP - E_ref\n        delta_F12_TZ = E_F12_TZ_CP - E_ref\n\n        # 2. Basis Set Superposition Error (B)\n        # B = E_int_noCP - E_int_CP\n        B_conv_TZ = E_conv_TZ_noCP - E_conv_TZ_CP\n        B_F12_TZ = E_F12_TZ_noCP - E_F12_TZ_CP\n\n        # 3. Dispersion Deficiency Index (D)\n        # f_disp = min(1, |D_model| / |E_ref|)\n        # D_F12_TZ = f_disp * delta_F12_TZ\n        # Handle the case where E_ref is zero to avoid division by zero, though not present in the dataset.\n        if E_ref == 0.0:\n            f_disp = 1.0 # Or handle as an error, but for this problem, assume E_ref is non-zero.\n        else:\n            f_disp = min(1.0, abs(D_model) / abs(E_ref))\n        D_F12_TZ = f_disp * delta_F12_TZ\n\n        # Assemble the result vector for the current case\n        case_result = [\n            delta_conv_TZ,\n            delta_F12_DZ,\n            delta_F12_TZ,\n            B_conv_TZ,\n            B_F12_TZ,\n            D_F12_TZ,\n        ]\n        results.append(case_result)\n\n    # Format the final output string as a list of lists with numbers\n    # rounded to three decimal places.\n    # e.g., [[1.200,0.300,...],[-0.900,0.100,...]]\n    formatted_cases = []\n    for case_res in results:\n        formatted_numbers = [f\"{x:.3f}\" for x in case_res]\n        formatted_cases.append(f\"[{','.join(formatted_numbers)}]\")\n    \n    final_output = f\"[{','.join(formatted_cases)}]\"\n    \n    print(final_output)\n\nsolve()\n```", "id": "2639428"}]}