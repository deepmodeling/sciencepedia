{"hands_on_practices": [{"introduction": "要真正掌握一种理论方法，关键在于理解其不同数学表述之间的内在联系。本练习旨在通过一个简化的、可解析求解的双模系统，将随机相位近似 (RPA) 相关的两种核心观点联系起来：一种是源于绝热连接涨落耗散定理 (ACFDT) 的频率积分“等离激元公式”，另一种是将其视为耦合玻色子零点能变化的物理图像。通过从第一性原理推导并计算相关能，你将加深对RPA数学结构的理解，并为更复杂的应用打下坚实的理论基础 [@problem_id:2820895]。", "problem": "考虑一个小分子的独立粒子参考态，其中性激发谱主要由两个粒子-空穴跃迁主导。在线性响应框架下，于粒子-空穴基中进行研究，该框架可导出随机相位近似 (RPA)。在此基下，RPA 方程用轨道旋转块 $\\mathbf{A}$ 和 $\\mathbf{B}$ 表示，其中 $\\mathbf{A}$ 是独立粒子哈密顿量加上剩余库仑核，而 $\\mathbf{B}$ 是源于同一核的耦合 (湮灭-产生) 块。假设只有两个非耦合跃迁有贡献，并且 $\\mathbf{A}$ 和 $\\mathbf{B}$ 在此子空间中是对角的：\n$$\n\\mathbf{A} = \\mathrm{diag}(\\Delta_{1}, \\Delta_{2}), \\qquad \\mathbf{B} = \\mathrm{diag}(\\kappa_{1}, \\kappa_{2}),\n$$\n其中 $\\Delta_{i} > |\\kappa_{i}| > 0$，因此 RPA 激发频率为实数且为正。\n\n设数值为 $\\Delta_{1} = 0.80$ 哈特里 (Ha)，$\\Delta_{2} = 1.20$ Ha，$\\kappa_{1} = 0.20$ Ha，以及 $\\kappa_{2} = 0.30$ Ha。以用于计算相关能的绝热连接涨落-耗散定理 (ACFDT) 和 RPA 的线性响应结构为基本出发点，执行以下操作：\n\n1. 从粒子-空穴表象中的 RPA 本征值问题出发，求得两个正的 RPA 激发能 $\\omega_{1}$ 和 $\\omega_{2}$，并根据关于这些模式在相互作用极限和独立玻色子极限之间的零点能差的第一性原理，推导在此解耦双模极限下用 $\\{\\omega_{i}\\}$ 和 $\\{\\Delta_{i}\\}$ 表示的 RPA 相关能表达式。对给定参数进行数值计算。\n\n2. 从 ACFDT 表达式及其线性响应 RPA 简化形式出发，证明对于对角矩阵 $\\mathbf{A}$ 和 $\\mathbf{B}$，相关能可以写成一个频率积分，其被积函数为一个迹-对数项，内容是涉及 $(\\mathbf{A}-\\mathbf{B})(\\mathbf{A}+\\mathbf{B})$ 和 $\\mathbf{A}^{2}$ 的二次型之比。将其简化为形式为 $\\int_{0}^{\\infty} d\\omega \\,\\ln\\!\\left((\\omega^{2}+\\alpha^{2})/(\\omega^{2}+\\beta^{2})\\right)$ 的一维积分之和。解析地计算这些积分，并用它们计算给定参数下的 RPA 相关能。\n\n将相关能的共同值（如果推导过程一致，这两个值应该匹配）以哈特里为单位，报告为一个单一数值。将答案四舍五入到六位有效数字，并以哈特里 (Ha) 为单位表示。", "solution": "我们首先对所提供的问题陈述进行强制性验证。\n\n逐字提取给定条件：一个具有两个主导粒子-空穴跃迁的系统在随机相位近似 (RPA) 框架内进行描述。轨道旋转块 $\\mathbf{A}$ 和耦合块 $\\mathbf{B}$ 在这两个跃迁的基中以对角矩阵形式给出：$\\mathbf{A} = \\mathrm{diag}(\\Delta_{1}, \\Delta_{2})$ 和 $\\mathbf{B} = \\mathrm{diag}(\\kappa_{1}, \\kappa_{2})$。条件 $\\Delta_{i} > |\\kappa_{i}| > 0$ 成立。数值为 $\\Delta_{1} = 0.80$ Ha，$\\Delta_{2} = 1.20$ Ha，$\\kappa_{1} = 0.20$ Ha，以及 $\\kappa_{2} = 0.30$ Ha。任务是通过两种不同的、指定的方法计算 RPA 相关能 $E_c$，并报告其共同的数值结果。\n\n该问题具有科学依据，植根于完善的电子结构多体理论，特别是随机相位近似和绝热连接涨落-耗散定理 (ACFDT)。问题提法得当，为获得唯一、稳定的解提供了所有必要的数据和条件。条件 $\\Delta_{i} > |\\kappa_{i}|$ 确保了 RPA 解的稳定性，保证了激发能为实数。语言客观而精确。该问题是理论化学中的一个标准练习（尽管经过简化），旨在检验基本理解，而非一个微不足道或故作高深的问题。因此，该问题被认为是有效的，我们可以着手求解。\n\n按照要求，解答分为两部分呈现，随后是数值计算。\n\n第1部分：从 RPA 本征值问题和零点能推导\n\n非厄米 RPA 本征值问题在粒子-空穴基中由以下矩阵方程给出：\n$$\n\\begin{pmatrix} \\mathbf{A} & \\mathbf{B} \\\\ \\mathbf{B} & \\mathbf{A} \\end{pmatrix} \\begin{pmatrix} \\mathbf{X} \\\\ \\mathbf{Y} \\end{pmatrix} = \\omega \\begin{pmatrix} \\mathbf{1} & \\mathbf{0} \\\\ \\mathbf{0} & -\\mathbf{1} \\end{pmatrix} \\begin{pmatrix} \\mathbf{X} \\\\ \\mathbf{Y} \\end{pmatrix}\n$$\n这对应于振幅 $\\mathbf{X}$ 和 $\\mathbf{Y}$ 的两个耦合方程：\n$$\n\\mathbf{A}\\mathbf{X} + \\mathbf{B}\\mathbf{Y} = \\omega\\mathbf{X} \\quad (1)\n$$\n$$\n\\mathbf{B}\\mathbf{X} + \\mathbf{A}\\mathbf{Y} = -\\omega\\mathbf{Y} \\quad (2)\n$$\n通过将这两个方程相加和相减，我们得到一种更方便的形式：\n$$\n(\\mathbf{A}+\\mathbf{B})(\\mathbf{X}+\\mathbf{Y}) = \\omega(\\mathbf{X}-\\mathbf{Y}) \\quad (3)\n$$\n$$\n(\\mathbf{A}-\\mathbf{B})(\\mathbf{X}-\\mathbf{Y}) = \\omega(\\mathbf{X}+\\mathbf{Y}) \\quad (4)\n$$\n假设 $\\omega \\neq 0$，将方程($3$)中的 $(\\mathbf{X}-\\mathbf{Y})$ 代入方程($4$)，得到：\n$$\n(\\mathbf{A}-\\mathbf{B}) \\frac{1}{\\omega}(\\mathbf{A}+\\mathbf{B})(\\mathbf{X}+\\mathbf{Y}) = \\omega(\\mathbf{X}+\\mathbf{Y})\n$$\n这可以重排成一个关于 $\\omega^2$ 的标准对称本征值问题：\n$$\n(\\mathbf{A}-\\mathbf{B})(\\mathbf{A}+\\mathbf{B})(\\mathbf{X}+\\mathbf{Y}) = \\omega^2(\\mathbf{X}+\\mathbf{Y})\n$$\n在给定的特定情况下，$\\mathbf{A}$ 和 $\\mathbf{B}$ 是对角矩阵。因此，它们可以交换，乘积 $(\\mathbf{A}-\\mathbf{B})(\\mathbf{A}+\\mathbf{B})$ 简化为 $\\mathbf{A}^2 - \\mathbf{B}^2$。本征值方程变为：\n$$\n(\\mathbf{A}^2 - \\mathbf{B}^2)(\\mathbf{X}+\\mathbf{Y}) = \\omega^2(\\mathbf{X}+\\mathbf{Y})\n$$\n由于 $\\mathbf{A}^2 - \\mathbf{B}^2 = \\mathrm{diag}(\\Delta_1^2 - \\kappa_1^2, \\Delta_2^2 - \\kappa_2^2)$，本征值 $\\omega_i^2$ 是对角元素。因此，正的 RPA 激发能为：\n$$\n\\omega_i = \\sqrt{\\Delta_i^2 - \\kappa_i^2}\n$$\n对于 $i=1, 2$。\n\nRPA 相关能 $E_c^{\\text{RPA}}$ 可被解释为相互作用系统（由频率为 $\\omega_i$ 的虚拟玻色子描述）的基态零点能与非相互作用参考系统（其中 $\\mathbf{B}=0$，意味着频率为 $\\Delta_i$）的基态零点能之差。每个模式的贡献为 $\\frac{1}{2}\\hbar\\omega$，在原子单位制中 $\\hbar=1$。因此，相互作用系统的总零点能为 $\\frac{1}{2}\\sum_i \\omega_i$，而参考系统的总零点能为 $\\frac{1}{2}\\sum_i \\Delta_i$。相关能即为二者之差：\n$$\nE_c^{\\text{RPA}} = \\frac{1}{2}\\sum_{i} (\\omega_i - \\Delta_i)\n$$\n对于所考虑的双模系统，这变为：\n$$\nE_c = \\frac{1}{2} \\left[ (\\omega_1 - \\Delta_1) + (\\omega_2 - \\Delta_2) \\right]\n$$\n\n第2部分：从绝热连接涨落-耗散定理推导\n\n我们从 RPA 相关能的迹对数或“等离激元”公式出发，该公式是在 RPA 框架内对 ACFDT 表达式就相互作用强度参数 $\\lambda$ 进行积分的直接结果。在虚频 $iu$ 下，一个常用的等价公式是：\n$$\nE_c = \\frac{1}{2\\pi} \\int_0^\\infty du \\, \\mathrm{Tr}\\left[ \\ln\\left((\\mathbf{A}-\\mathbf{B})(\\mathbf{A}+\\mathbf{B}) + u^2 \\mathbf{1}\\right) - \\ln(\\mathbf{A}^2 + u^2 \\mathbf{1}) \\right]\n$$\n此表达式表示相互作用和非相互作用响应函数的零点涨落之差在所有频率上的积分。由于 $\\mathbf{A}$ 和 $\\mathbf{B}$ 是对角的，矩阵 $\\mathbf{A}^2$ 和 $(\\mathbf{A}-\\mathbf{B})(\\mathbf{A}+\\mathbf{B}) = \\mathbf{A}^2 - \\mathbf{B}^2$ 也是对角的。如第1部分所述，$\\mathbf{A}^2 - \\mathbf{B}^2$ 的本征值为 $\\omega_i^2 = \\Delta_i^2 - \\kappa_i^2$。对角矩阵的对数的迹等于其对角元素对数之和。$E_c$ 的表达式因此可以分解为对非耦合模式的求和：\n$$\nE_c = \\frac{1}{2\\pi} \\sum_{i=1,2} \\int_0^\\infty du \\, \\left[ \\ln(\\omega_i^2 + u^2) - \\ln(\\Delta_i^2 + u^2) \\right]\n$$\n$$\nE_c = \\sum_{i=1,2} \\frac{1}{2\\pi} \\int_0^\\infty du \\, \\ln\\left(\\frac{u^2 + \\omega_i^2}{u^2 + \\Delta_i^2}\\right)\n$$\n我们现在必须计算定积分 $I = \\int_0^\\infty du \\, \\ln\\left(\\frac{u^2 + \\alpha^2}{u^2 + \\beta^2}\\right)$，其中 $\\alpha$ 和 $\\beta$ 为正常数。我们使用分部积分法，令 $f(u) = \\ln\\left(\\frac{u^2 + \\alpha^2}{u^2 + \\beta^2}\\right)$ 且 $g'(u)=1$。\n$$\nI = \\left[u \\ln\\left(\\frac{u^2 + \\alpha^2}{u^2 + \\beta^2}\\right)\\right]_0^\\infty - \\int_0^\\infty u \\left( \\frac{2u}{u^2+\\alpha^2} - \\frac{2u}{u^2+\\beta^2} \\right) du\n$$\n当 $u \\to \\infty$ 时的边界项为 $\\lim_{u\\to\\infty} u \\ln\\left(\\frac{1+\\alpha^2/u^2}{1+\\beta^2/u^2}\\right) = \\lim_{u\\to\\infty} u \\left( (\\alpha^2/u^2 - \\beta^2/u^2) + O(u^{-4}) \\right) = 0$。当 $u=0$ 时的项也为 $0$。积分变为：\n$$\nI = - \\int_0^\\infty 2u^2 \\left( \\frac{1}{u^2+\\alpha^2} - \\frac{1}{u^2+\\beta^2} \\right) du = - \\int_0^\\infty 2u^2 \\frac{\\beta^2 - \\alpha^2}{(u^2+\\alpha^2)(u^2+\\beta^2)} du\n$$\n$$\nI = 2(\\alpha^2 - \\beta^2) \\int_0^\\infty \\frac{u^2}{(u^2+\\alpha^2)(u^2+\\beta^2)} du\n$$\n使用部分分式分解 $\\frac{u^2}{(u^2+\\alpha^2)(u^2+\\beta^2)} = \\frac{1}{\\alpha^2-\\beta^2}\\left(\\frac{-\\beta^2}{u^2+\\beta^2} + \\frac{\\alpha^2}{u^2+\\alpha^2}\\right)$，我们得到：\n$$\nI = 2(\\alpha^2 - \\beta^2) \\frac{1}{\\alpha^2-\\beta^2} \\int_0^\\infty \\left( \\frac{\\alpha^2}{u^2+\\alpha^2} - \\frac{\\beta^2}{u^2+\\beta^2} \\right) du\n$$\n$$\nI = 2 \\left[ \\alpha^2 \\left(\\frac{1}{\\alpha}\\arctan\\frac{u}{\\alpha}\\right)_0^\\infty - \\beta^2 \\left(\\frac{1}{\\beta}\\arctan\\frac{u}{\\beta}\\right)_0^\\infty \\right] = 2 \\left[ \\alpha \\frac{\\pi}{2} - \\beta \\frac{\\pi}{2} \\right] = \\pi(\\alpha - \\beta)\n$$\n将此结果代回 $E_c$ 的表达式，并令 $\\alpha \\to \\omega_i$ 和 $\\beta \\to \\Delta_i$：\n$$\nE_c = \\sum_{i=1,2} \\frac{1}{2\\pi} \\left[ \\pi(\\omega_i - \\Delta_i) \\right] = \\frac{1}{2} \\sum_{i=1,2} (\\omega_i - \\Delta_i)\n$$\n此表达式与第1部分推导出的表达式完全相同，证实了两种方法的一致性。由于 $\\omega_i < \\Delta_i$，相关能总是负的。\n\n数值计算\n\n给定参数如下：\n$\\Delta_1 = 0.80$ Ha\n$\\Delta_2 = 1.20$ Ha\n$\\kappa_1 = 0.20$ Ha\n$\\kappa_2 = 0.30$ Ha\n\n首先，我们计算 RPA 激发能 $\\omega_1$ 和 $\\omega_2$：\n$$\n\\omega_1 = \\sqrt{\\Delta_1^2 - \\kappa_1^2} = \\sqrt{(0.80)^2 - (0.20)^2} = \\sqrt{0.64 - 0.04} = \\sqrt{0.60} \\, \\text{Ha}\n$$\n$$\n\\omega_2 = \\sqrt{\\Delta_2^2 - \\kappa_2^2} = \\sqrt{(1.20)^2 - (0.30)^2} = \\sqrt{1.44 - 0.09} = \\sqrt{1.35} \\, \\text{Ha}\n$$\n数值上，$\\omega_1 \\approx 0.77459667$ Ha 且 $\\omega_2 \\approx 1.16189500$ Ha。\n\n现在，我们计算相关能 $E_c$：\n$$\nE_c = \\frac{1}{2} \\left[ (\\omega_1 - \\Delta_1) + (\\omega_2 - \\Delta_2) \\right]\n$$\n$$\nE_c = \\frac{1}{2} \\left[ (\\sqrt{0.60} - 0.80) + (\\sqrt{1.35} - 1.20) \\right]\n$$\n$$\nE_c \\approx \\frac{1}{2} \\left[ (0.77459667 - 0.80) + (1.16189500 - 1.20) \\right]\n$$\n$$\nE_c \\approx \\frac{1}{2} \\left[ -0.02540333 - 0.03810500 \\right]\n$$\n$$\nE_c \\approx \\frac{1}{2} (-0.06350833) = -0.031754165 \\, \\text{Ha}\n$$\n按照要求将结果四舍五入到六位有效数字，我们得到 $E_c = -0.0317542$ Ha。", "answer": "$$\\boxed{-0.0317542}$$", "id": "2820895"}, {"introduction": "一种高级理论方法的真正价值，往往在其能够解决低阶方法失效的关键问题时才得以彰显。本练习将引导你探究一个对电子结构理论至关重要的场景：小带隙（或准简并）系统。你将通过一个极简的二能带模型，推导并对比二级微扰理论 (MP2) 与 RPA 相关能在带隙 $\\Delta \\to 0$ 时的行为。这个练习将清晰地揭示 MP2 的发散问题以及 RPA 如何通过其固有的无穷阶求和机制来“修正”这一物理缺陷，从而让你深刻体会到 RPA 在描述长程相关和金属体系方面的优越性 [@problem_id:2821013]。", "problem": "考虑一个最小双带绝缘体模型，该模型有一个已占据的价带和一个空的导带，它们之间被一个能量为 $\\Delta>0$ 的能隙分开。假设唯一的具有光学活性的带间跃迁能量为 $\\Delta$，其有效密度响应振子强度由一个正常数 $\\alpha>0$ 概括。那么，根据单一带间跃迁的 Lehmann 表示，零温下虚频轴上的独立粒子密度-密度响应函数由下式给出：\n$$\n\\chi_{0}(i\\omega)\\;=\\;-\\frac{\\alpha\\,\\Delta}{\\omega^{2}+\\Delta^{2}}\\,,\n$$\n其中负号表示电子密度对外势的响应是相反的。设电子-电子相互作用的模型为一个标量耦合 $v>0$，该耦合可分离到这个单一带间通道上，并定义有量纲的有效耦合 $g \\equiv v\\,\\alpha$。\n\n以绝热连接涨落-耗散定理 (ACFDT) 为基本出发点，并在随机相位近似 (RPA) 内使用相互作用响应的 Dyson 方程，你将需要：\n\n1) 通过将 ACFDT 被积函数对 $v$ 展开至二阶，推导出直接 Møller–Plesset 二阶 (MP2) 相关能。\n2) 通过使用 RPA 相互作用响应计算 ACFDT 积分，推导出 RPA 相关能。\n3) 从你得到的闭合形式表达式中，提取当 $\\Delta\\to 0^{+}$ 时的小能隙行为，并明确确定 MP2 相关能如何随 $\\Delta$ 标度变化，以及 RPA 相关能趋于何种有限极限（如果存在）。\n\n假设交换（阶梯）项被忽略，且对于所考虑的耦合，系统保持线性稳定。请用 $g$ 和 $\\Delta$ 表示你的最终结果。你的最终答案必须包含两个条目，并以单行形式呈现：MP2 相关能的小 $\\Delta$ 领头项表达式，以及 RPA 相关能在 $\\Delta\\to 0^{+}$ 时的极限。无需进行数值计算，也无舍入要求。最终答案中不要包含单位。", "solution": "该问题要求使用两种不同的近似方法——Møller–Plesset 二阶微扰理论 (MP2) 和随机相位近似 (RPA)——来推导和分析一个简化双带模型的相关能。两个推导的出发点都是绝热连接涨落-耗散定理 (ACFDT)。\n\n已知条件是：\n- 一个能隙为 $\\Delta > 0$ 的双带绝缘体模型。\n- 虚频轴上的独立粒子密度-密度响应函数：$\\chi_{0}(i\\omega) = -\\frac{\\alpha\\,\\Delta}{\\omega^{2}+\\Delta^{2}}$，其中 $\\alpha > 0$。\n- 一个标量电子-电子相互作用耦合 $v > 0$。\n- 有效耦合强度 $g \\equiv v\\alpha > 0$。\n\nRPA 中（只包含直接环图）相关能 $E_c$ 的 ACFDT 公式由一个对虚频 $\\omega$ 的积分给出：\n$$\nE_c = \\frac{1}{2\\pi} \\int_{0}^{\\infty} d\\omega \\, \\left[ \\ln(1 - v\\chi_0(i\\omega)) + v\\chi_0(i\\omega) \\right]\n$$\n这个公式适用于单一有效通道，正如问题中的标量模型所暗示的。相关能是负的，这一点是确定的，因为对于排斥相互作用 ($v>0$) 和物理响应函数 ($\\chi_0<0$)，乘积 $v\\chi_0$ 是负的。令 $X = v\\chi_0 < 0$。被积函数为 $\\ln(1-X)+X$。泰勒展开 $\\ln(1-X) = -X - \\frac{X^2}{2} - \\frac{X^3}{3} - \\dots$ 表明被积函数为 $-\\frac{X^2}{2} - \\frac{X^3}{3} - \\dots$，对于小的 $X$ 它是负的。对任何 $X<0$，令 $y=-X>0$。函数变为 $\\ln(1+y)-y$，当 $y>0$ 时，该函数恒为负。因此，$E_c$ 正确地为负值。\n\n1) 直接 MP2 相关能的推导。\nMP2 相关能对应于相关能对相互作用 $v$ 的微扰展开中最低阶（二阶）的非平庸项。我们将 ACFDT 公式的被积函数展开至 $v^2$ 阶：\n$$\n\\ln(1 - v\\chi_0(i\\omega)) + v\\chi_0(i\\omega) = \\left( -v\\chi_0(i\\omega) - \\frac{1}{2}(v\\chi_0(i\\omega))^2 - O(v^3) \\right) + v\\chi_0(i\\omega) = -\\frac{1}{2}v^2(\\chi_0(i\\omega))^2 + O(v^3)\n$$\n将此代入 ACFDT 公式，得到 MP2 相关能：\n$$\nE_c^{(\\text{MP2})} = \\frac{1}{2\\pi} \\int_{0}^{\\infty} d\\omega \\left(-\\frac{1}{2}v^2(\\chi_0(i\\omega))^2\\right) = -\\frac{v^2}{4\\pi} \\int_{0}^{\\infty} (\\chi_0(i\\omega))^2 d\\omega\n$$\n现在，我们代入 $\\chi_0(i\\omega)$ 的给定表达式：\n$$\nE_c^{(\\text{MP2})} = -\\frac{v^2}{4\\pi} \\int_{0}^{\\infty} \\left(-\\frac{\\alpha\\,\\Delta}{\\omega^{2}+\\Delta^{2}}\\right)^2 d\\omega = -\\frac{v^2\\alpha^2\\Delta^2}{4\\pi} \\int_{0}^{\\infty} \\frac{1}{(\\omega^2+\\Delta^2)^2} d\\omega\n$$\n该积分可以使用三角换元 $\\omega = \\Delta \\tan\\theta$，$d\\omega = \\Delta \\sec^2\\theta d\\theta$ 来计算：\n$$\n\\int_{0}^{\\infty} \\frac{d\\omega}{(\\omega^2+\\Delta^2)^2} = \\int_{0}^{\\pi/2} \\frac{\\Delta\\sec^2\\theta d\\theta}{(\\Delta^2\\tan^2\\theta+\\Delta^2)^2} = \\int_{0}^{\\pi/2} \\frac{\\Delta\\sec^2\\theta d\\theta}{(\\Delta^2\\sec^2\\theta)^2} = \\frac{1}{\\Delta^3} \\int_{0}^{\\pi/2} \\cos^2\\theta d\\theta\n$$\n$$\n= \\frac{1}{\\Delta^3} \\int_{0}^{\\pi/2} \\frac{1+\\cos(2\\theta)}{2} d\\theta = \\frac{1}{\\Delta^3} \\left[\\frac{\\theta}{2} + \\frac{\\sin(2\\theta)}{4}\\right]_{0}^{\\pi/2} = \\frac{1}{\\Delta^3}\\frac{\\pi}{4}\n$$\n将此结果代回并使用 $g = v\\alpha$：\n$$\nE_c^{(\\text{MP2})} = -\\frac{v^2\\alpha^2\\Delta^2}{4\\pi} \\left(\\frac{\\pi}{4\\Delta^3}\\right) = -\\frac{(v\\alpha)^2}{16\\Delta} = -\\frac{g^2}{16\\Delta}\n$$\n\n2) RPA 相关能的推导。\n对于 RPA 相关能，我们计算完整的 ACFDT 积分，而不作展开。\n$$\nE_c^{(\\text{RPA})} = \\frac{1}{2\\pi} \\int_{0}^{\\infty} d\\omega \\, \\left[ \\ln\\left(1 - v\\left(-\\frac{\\alpha\\,\\Delta}{\\omega^{2}+\\Delta^{2}}\\right)\\right) + v\\left(-\\frac{\\alpha\\,\\Delta}{\\omega^{2}+\\Delta^{2}}\\right) \\right]\n$$\n使用 $g=v\\alpha$，表达式变为：\n$$\nE_c^{(\\text{RPA})} = \\frac{1}{2\\pi} \\int_{0}^{\\infty} d\\omega \\, \\left[ \\ln\\left(1 + \\frac{g\\Delta}{\\omega^2+\\Delta^2}\\right) - \\frac{g\\Delta}{\\omega^2+\\Delta^2} \\right]\n$$\n该积分可分为两部分：\n$$\nE_c^{(\\text{RPA})} = \\frac{1}{2\\pi} \\int_{0}^{\\infty} \\ln\\left(\\frac{\\omega^2+\\Delta^2+g\\Delta}{\\omega^2+\\Delta^2}\\right) d\\omega - \\frac{g\\Delta}{2\\pi} \\int_{0}^{\\infty} \\frac{d\\omega}{\\omega^2+\\Delta^2}\n$$\n第二个积分是标准积分：\n$$\n\\int_{0}^{\\infty} \\frac{d\\omega}{\\omega^2+\\Delta^2} = \\left[\\frac{1}{\\Delta}\\arctan\\left(\\frac{\\omega}{\\Delta}\\right)\\right]_{0}^{\\infty} = \\frac{\\pi}{2\\Delta}\n$$\n第一个积分的形式为 $\\int_0^\\infty \\ln(1 + A/(x^2+B))dx$，其解析解为 $\\pi(\\sqrt{A+B}-\\sqrt{B})$。这里，$A=g\\Delta$ 且 $B=\\Delta^2$。\n$$\n\\int_{0}^{\\infty} \\ln\\left(1 + \\frac{g\\Delta}{\\omega^2+\\Delta^2}\\right) d\\omega = \\pi\\left(\\sqrt{g\\Delta + \\Delta^2} - \\sqrt{\\Delta^2}\\right) = \\pi\\left(\\sqrt{\\Delta^2+g\\Delta} - \\Delta\\right)\n$$\n将这些积分结果代回到 $E_c^{(\\text{RPA})}$ 的表达式中：\n$$\nE_c^{(\\text{RPA})} = \\frac{1}{2\\pi} \\left[ \\pi(\\sqrt{\\Delta^2+g\\Delta} - \\Delta) \\right] - \\frac{g\\Delta}{2\\pi} \\left( \\frac{\\pi}{2\\Delta} \\right)\n$$\n$$\nE_c^{(\\text{RPA})} = \\frac{1}{2}(\\sqrt{\\Delta^2+g\\Delta} - \\Delta) - \\frac{g}{4}\n$$\n这就是 RPA 相关能的闭合形式表达式。作为检验，将其对小 $g$ 展开可得 $E_c^{(\\text{RPA})} = \\frac{1}{2}(\\Delta(1+\\frac{g}{2\\Delta}-\\frac{g^2}{8\\Delta^2}+\\dots)-\\Delta) - \\frac{g}{4} = (\\frac{g}{4}-\\frac{g^2}{16\\Delta}+\\dots) - \\frac{g}{4} \\approx -\\frac{g^2}{16\\Delta}$，这正确地恢复了 MP2 的结果。\n\n3) 小能隙 ($\\Delta\\to 0^{+}$) 行为。\n对于 MP2 相关能，其在 $\\Delta\\to 0^{+}$ 时的行为是显而易见的：\n$$\nE_c^{(\\text{MP2})} = -\\frac{g^2}{16\\Delta}\n$$\n当 $\\Delta \\to 0^{+}$ 时，该表达式发散至 $-\\infty$。其领头行为与 $\\Delta^{-1}$ 成正比。\n\n对于 RPA 相关能，我们必须计算其极限：\n$$\n\\lim_{\\Delta\\to 0^{+}} E_c^{(\\text{RPA})} = \\lim_{\\Delta\\to 0^{+}} \\left[ \\frac{1}{2}(\\sqrt{\\Delta^2+g\\Delta} - \\Delta) - \\frac{g}{4} \\right]\n$$\n我们通过乘以并除以其共轭项来分析第一项：\n$$\n\\lim_{\\Delta\\to 0^{+}} \\frac{\\sqrt{\\Delta^2+g\\Delta} - \\Delta}{2} = \\lim_{\\Delta\\to 0^{+}} \\frac{(\\Delta^2+g\\Delta) - \\Delta^2}{2(\\sqrt{\\Delta^2+g\\Delta} + \\Delta)} = \\lim_{\\Delta\\to 0^{+}} \\frac{g\\Delta}{2(\\sqrt{\\Delta^2+g\\Delta} + \\Delta)}\n$$\n$$\n= \\lim_{\\Delta\\to 0^{+}} \\frac{g\\Delta}{2(\\sqrt{\\Delta}\\sqrt{\\Delta+g} + \\Delta)} = \\lim_{\\Delta\\to 0^{+}} \\frac{g\\sqrt{\\Delta}}{2(\\sqrt{\\Delta+g} + \\sqrt{\\Delta})} = \\frac{g \\cdot 0}{2(\\sqrt{g}+0)} = 0\n$$\n因此，RPA 相关能趋于一个有限极限：\n$$\n\\lim_{\\Delta\\to 0^{+}} E_c^{(\\text{RPA})} = 0 - \\frac{g}{4} = -\\frac{g}{4}\n$$\nRPA 求和正则化了在二阶微扰理论中出现的发散，即使在能隙关闭时也能得到一个有限的相关能。\n\n所要求的最终答案由两部分组成：MP2 能量的小 $\\Delta$ 领头项表达式和 RPA 能量在 $\\Delta\\to 0^{+}$ 时的极限。\nMP2 能量的小 $\\Delta$ 领头项：$-\\frac{g^2}{16\\Delta}$\nRPA 能量在 $\\Delta\\to 0^{+}$ 时的极限：$-\\frac{g}{4}$", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n-\\frac{g^{2}}{16\\Delta} & -\\frac{g}{4}\n\\end{pmatrix}\n}\n$$", "id": "2821013"}, {"introduction": "在计算化学领域，一个理论方法的优雅性必须与其计算可行性相平衡。本练习将你的注意力从物理公式转移到算法分析上，这是连接理论与实践的关键一步。通过对一个“朴素”RPA 实现的计算成本进行分析，你将学习如何识别计算瓶颈，并从根本上理解为什么该方法的计算量会以系统大小的四次方（$O(N^4)$）增长。这一分析不仅揭示了直接实现 RPA 的局限性，也为理解和欣赏现代低标度 RPA 算法的精妙之处提供了必要的背景知识 [@problem_id:2820910]。", "problem": "您正在分析一个基于绝热连接涨落-耗散 (ACFD) 公式的随机相位近似 (RPA) 相关能的朴素实现，该实现是在原子轨道 (AO) 基下针对闭壳层体系的。设原子数为 $N$，并假设在理论化学中典型的固定基组、固定密度条件下，以下具有物理动机的标度关系成立：\n- AO 基函数的数量为 $M = \\alpha N$，其中 $\\alpha$ 是一个与 $N$ 无关的正常数。\n- 已占据分子轨道 (MO) 的数量为 $N_{\\mathrm{o}} = \\beta N$，虚拟 MO 的数量为 $N_{\\mathrm{v}} = \\gamma N$，其中 $\\beta$ 和 $\\gamma$ 是与 $N$ 无关的正常数。\n- 虚频轴上的求积点数量为 $N_{\\omega} = \\delta$，其中 $\\delta$ 是一个与 $N$ 无关的正常数。\n\n在虚频 $\\mathrm{i}\\omega$ 处的独立粒子密度-密度响应函数（也称为独立粒子极化率）在 AO 基 $\\{\\phi_{\\mu}\\}_{\\mu=1}^{M}$ 中表示为矩阵，其元素为\n$$\n\\chi_{0}(\\mathrm{i}\\omega)_{\\mu\\nu}\n=\n\\sum_{i=1}^{N_{\\mathrm{o}}}\\sum_{a=1}^{N_{\\mathrm{v}}}\n\\phi_{i\\mu}\\,\\phi_{i\\nu}\\,\\phi_{a\\mu}\\,\\phi_{a\\nu}\\,f_{ia}(\\mathrm{i}\\omega),\n$$\n其中 $\\phi_{p\\mu}$ 表示 MO $p$ 在 AO $\\mu$ 上的系数，$f_{ia}(\\mathrm{i}\\omega)$ 是一个关于轨道能级差和频率的标量函数（本问题不需要其具体形式）。AO 基中的库仑核定义了一个 $M \\times M$ 矩阵 $v$，并且 ACFD RPA 相关能的计算要求在每个求积点上进行稠密矩阵运算，例如构建乘积 $v\\,\\chi_{0}(\\mathrm{i}\\omega)$ 和对一个 $M \\times M$ 矩阵进行矩阵函数（例如，矩阵对数或特征值分解）运算，然后求迹。\n\n假设一个朴素实现，它\n- 对于 $N_{\\omega}$ 个求积点中的每一个，通过对每个 AO 指数对 $(\\mu,\\nu)$ 上的已占据-虚拟轨道对 $(i,a)$ 进行直接求和来显式地构建 $\\chi_{0}(\\mathrm{i}\\omega)$，而不使用单位分解、密度拟合、虚时分解或低秩压缩技术，并且\n- 在每个求积点上，使用标准的立方标度方法来评估求迹所需的稠密线性代数运算。\n\n仅从这些定义和假设出发，通过识别主导的张量缩并和矩阵运算及其作为 $M$、$N_{\\mathrm{o}}$ 和 $N_{\\mathrm{v}}$ 的函数的计算代价，推导此朴素 RPA 实现的整体主导阶计算标度与 $N$ 的关系。将您的最终结果表示为关于 $N$ 的单个符号表达式，忽略乘法常数和低阶项。不要包含单位。最终答案必须是单个闭合形式表达式。", "solution": "我们从以原子轨道 (AO) 基表示的独立粒子极化率 $\\chi_{0}(\\mathrm{i}\\omega)$ 开始。对于每个虚频 $\\mathrm{i}\\omega$，其 AO 矩阵元素为\n$$\n\\chi_{0}(\\mathrm{i}\\omega)_{\\mu\\nu}\n=\n\\sum_{i=1}^{N_{\\mathrm{o}}}\\sum_{a=1}^{N_{\\mathrm{v}}}\n\\phi_{i\\mu}\\,\\phi_{i\\nu}\\,\\phi_{a\\mu}\\,\\phi_{a\\nu}\\,f_{ia}(\\mathrm{i}\\omega),\n$$\n其中 $\\mu,\\nu \\in \\{1,\\dots,M\\}$ 是 AO 指数，$i \\in \\{1,\\dots,N_{\\mathrm{o}}\\}$ 遍历已占据分子轨道 (MOs)，$a \\in \\{1,\\dots,N_{\\mathrm{v}}\\}$ 遍历虚拟 MO，$\\phi_{p\\mu}$ 是 AO 基中的 MO 系数，$f_{ia}(\\mathrm{i}\\omega)$ 是一个依赖于轨道能量和频率 $\\omega$ 的标量。\n\n我们识别朴素实现中涉及的主导运算。\n\n1. 对单个频率构建 $\\chi_{0}(\\mathrm{i}\\omega)$：\n   - 目标是 AO 基中的一个 $M \\times M$ 矩阵，因此需要计算 $M^{2}$ 个矩阵元素 $\\chi_{0}(\\mathrm{i}\\omega)_{\\mu\\nu}$。\n   - 对于每个固定的指数对 $(\\mu,\\nu)$，该公式需要在 $N_{\\mathrm{o}} N_{\\mathrm{v}}$ 个已占据-虚拟轨道对 $(i,a)$ 上进行双重求和。由于 $\\phi_{i\\mu}$、$\\phi_{i\\nu}$、$\\phi_{a\\mu}$、$\\phi_{a\\nu}$ 和 $f_{ia}(\\mathrm{i}\\omega)$ 都是标量，循环体对每个 $(i,a)$ 包含常数次标量运算（乘法和加法）。\n   - 因此，构建 $\\chi_{0}(\\mathrm{i}\\omega)$ 的计算代价标度为\n     $$\n     \\mathcal{O}\\!\\left(M^{2}\\,N_{\\mathrm{o}}\\,N_{\\mathrm{v}}\\right).\n     $$\n\n2. 在每个频率上为评估 ACFD 迹而进行的稠密线性代数运算：\n   - ACFD 随机相位近似 (RPA) 相关能的计算需要对一个由 $v$ 和 $\\chi_{0}(\\mathrm{i}\\omega)$ 构建的 $M \\times M$ 矩阵的矩阵函数求迹（例如，构建 $A(\\mathrm{i}\\omega)=\\mathbf{1}-v\\,\\chi_{0}(\\mathrm{i}\\omega)$，然后计算矩阵对数或进行特征值分解）。\n   - 使用标准的稠密矩阵-矩阵乘法，构建乘积 $v\\,\\chi_{0}(\\mathrm{i}\\omega)$ 的代价为 $\\mathcal{O}(M^{3})$。\n   - 通过对角化或舒尔分解来计算矩阵函数的代价也为 $\\mathcal{O}(M^{3})$。\n   - 因此，每个频率上的稠密线性代数运算代价为\n     $$\n     \\mathcal{O}\\!\\left(M^{3}\\right).\n     $$\n\n3. 在整个频率格点上的总代价：\n   - 虚频轴上有 $N_{\\omega}$ 个求积点，其中 $N_{\\omega}=\\delta$ 是一个与 $N$ 无关的常数。因此，总代价是每个频率的代价乘以一个常数因子，这不会改变随 $N$ 变化的标度关系。\n   - 每个频率的代价是步骤 1 和 2 的代价之和：\n     $$\n     \\mathcal{O}\\!\\left(M^{2}\\,N_{\\mathrm{o}}\\,N_{\\mathrm{v}}\\right)\\;+\\;\\mathcal{O}\\!\\left(M^{3}\\right).\n     $$\n\n4. 代入体系尺寸标度关系：\n   - 根据假设，$M=\\alpha N$，$N_{\\mathrm{o}}=\\beta N$，$N_{\\mathrm{v}}=\\gamma N$，其中 $\\alpha$、$\\beta$ 和 $\\gamma$ 是与 $N$ 无关的正常数。\n   - 代入到两个代价项中：\n     $$\n     \\mathcal{O}\\!\\left(M^{2}\\,N_{\\mathrm{o}}\\,N_{\\mathrm{v}}\\right)\n     = \\mathcal{O}\\!\\left((\\alpha N)^{2}\\,(\\beta N)\\,(\\gamma N)\\right)\n     = \\mathcal{O}\\!\\left(\\alpha^{2}\\beta\\gamma\\,N^{4}\\right)\n     = \\mathcal{O}\\!\\left(N^{4}\\right),\n     $$\n     $$\n     \\mathcal{O}\\!\\left(M^{3}\\right) = \\mathcal{O}\\!\\left((\\alpha N)^{3}\\right) = \\mathcal{O}\\!\\left(\\alpha^{3} N^{3}\\right) = \\mathcal{O}\\!\\left(N^{3}\\right).\n     $$\n   - 比较 $\\mathcal{O}\\!\\left(N^{4}\\right)$ 和 $\\mathcal{O}\\!\\left(N^{3}\\right)$，对于大的 $N$，主导项是 $\\mathcal{O}\\!\\left(N^{4}\\right)$。\n\n5. 识别主导的张量缩并：\n   - 主导代价来自构建 $\\chi_{0}(\\mathrm{i}\\omega)$ 的四指数张量缩并，即对每个 AO 指数对 $(\\mu,\\nu)$ 上的已占据-虚拟轨道对 $(i,a)$ 进行求和，也就是 $(\\mu\\nu)\\leftarrow(ia)$ 缩并，其代价为 $\\mathcal{O}\\!\\left(M^{2}\\,N_{\\mathrm{o}}\\,N_{\\mathrm{v}}\\right)$。\n   - 所有后续在 $M \\times M$ 矩阵上的稠密矩阵运算，例如构建 $v\\,\\chi_{0}$ 和评估矩阵对数或进行特征值分解，贡献了次主导的 $\\mathcal{O}\\!\\left(M^{3}\\right)=\\mathcal{O}\\!\\left(N^{3}\\right)$ 代价。\n\n因此，在所述假设下，并且在不使用辅助基技术或压缩的朴素实现中，整体主导阶计算标度与体系尺寸 $N$ 的关系由构建 $\\chi_{0}(\\mathrm{i}\\omega)$ 产生的 $\\mathcal{O}\\!\\left(N^{4}\\right)$ 项决定。\n\n忽略乘法常数和低阶项，主导阶代价作为关于 $N$ 的符号表达式为\n$$\nN^{4}.\n$$", "answer": "$$\\boxed{N^{4}}$$", "id": "2820910"}]}