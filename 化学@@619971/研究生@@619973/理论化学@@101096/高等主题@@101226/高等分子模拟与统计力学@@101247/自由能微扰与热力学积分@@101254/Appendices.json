{"hands_on_practices": [{"introduction": "将计算方法与简单的、可精确求解的模型进行对比验证，是理论科学研究的基石。本练习提供了一个动手实践的机会，将热力学积分（TI）和自由能微扰（FEP）应用于基本模型系统——谐振子 [@problem_id:2642319]。通过推导并确认这两种方法都能得到正确的解析结果，你将对这些强大的技术建立起坚实的信心。", "problem": "考虑一个经典的一维谐振子，其势能为 $U(x;k)=\\tfrac{1}{2}k x^{2}$，其中 $k>0$ 是力常数，$x$ 是笛卡尔坐标。在正则系综中，于恒定温度 $T$ 下进行研究。假设只考虑构型贡献（动能项与 $k$ 无关，在不同 $k$ 值的状态之间的自由能差计算中会被抵消）。令 $k_{B}$ 表示玻尔兹曼常数，且 $\\beta \\equiv 1/(k_{B}T)$。\n\na) 从正则构型配分函数的定义 $Z_{\\mathrm{conf}}(k,T)=\\int_{-\\infty}^{\\infty}\\exp\\!\\left(-\\beta U(x;k)\\right)\\,\\mathrm{d}x$ 出发，推导精确的构型亥姆霍兹自由能 $A_{\\mathrm{conf}}(k,T)$。\n\nb) 考虑在恒定温度 $T$ 下将力常数从 $k_{0}>0$ 变为 $k_{1}>0$。引入一个耦合参数 $\\lambda\\in[0,1]$，它定义了一个插值哈密顿量 $U_{\\lambda}(x)=\\tfrac{1}{2}k(\\lambda)x^{2}$，其中 $k(\\lambda)=(1-\\lambda)k_{0}+\\lambda k_{1}$。从基本系综定义出发，使用热力学积分 (TI, Thermodynamic Integration) 方法推导自由能差 $\\Delta A \\equiv A_{\\mathrm{conf}}(k_{1},T)-A_{\\mathrm{conf}}(k_{0},T)$ 的表达式。\n\nc) 从正则配分函数之比出发，针对同一变换，推导并精确计算自由能微扰 (FEP, Free Energy Perturbation) 估算量。也即，将 $\\Delta A$ 表示为在 $k_{0}$ 参考系综上的一个平均值，并解析地计算该平均值。\n\n你的最终答案应为用 $k_{0}$、$k_{1}$、$k_{B}$ 和 $T$ 表示的 $\\Delta A$ 的单一闭合形式解析表达式。不需要进行数值计算。将最终结果表示为单一解析表达式。最终方框内的答案不应包含单位。", "solution": "该问题陈述经核实具有科学依据、是良定的且客观的。它基于经典统计力学的标准原理，并提出了一个可用既有方法轻易求解的典型问题。不存在逻辑矛盾、信息缺失或事实不准确之处。该问题是有效的。我们开始进行解答。\n\n该问题要求计算当一个一维经典谐振子的力常数在恒定温度 $T$ 下从 $k_{0}$ 变为 $k_{1}$ 时的亥姆霍兹自由能差 $\\Delta A$。我们将按要求通过三种不同的方法推导这个量。\n\n(a) 精确的构型亥姆霍兹自由能 $A_{\\mathrm{conf}}(k,T)$\n\n在温度 $T$ 下，一个势能为 $U(x;k)$ 的系统的构型配分函数 $Z_{\\mathrm{conf}}$ 由下式给出：\n$$\nZ_{\\mathrm{conf}}(k,T) = \\int_{-\\infty}^{\\infty} \\exp(-\\beta U(x;k)) \\, \\mathrm{d}x\n$$\n其中 $\\beta = 1/(k_{B}T)$。对于谐振子，其势能为 $U(x;k) = \\frac{1}{2}kx^{2}$。将此代入配分函数的定义，得到：\n$$\nZ_{\\mathrm{conf}}(k,T) = \\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{1}{2}\\beta k x^{2}\\right) \\, \\mathrm{d}x\n$$\n这是一个形式为 $\\int_{-\\infty}^{\\infty} \\exp(-ax^{2}) \\, \\mathrm{d}x = \\sqrt{\\frac{\\pi}{a}}$ 的标准高斯积分。在我们的情况中，常数 $a$ 是 $\\frac{\\beta k}{2}$。因此，该积分的计算结果为：\n$$\nZ_{\\mathrm{conf}}(k,T) = \\sqrt{\\frac{\\pi}{\\frac{\\beta k}{2}}} = \\sqrt{\\frac{2\\pi}{\\beta k}}\n$$\n亥姆霍兹自由能 $A$ 通过基本方程 $A = -k_{B}T \\ln Z = -\\frac{1}{\\beta} \\ln Z$ 与配分函数 $Z$ 相关。因此，对亥姆霍兹自由能的构型贡献为：\n$$\nA_{\\mathrm{conf}}(k,T) = -\\frac{1}{\\beta} \\ln Z_{\\mathrm{conf}}(k,T) = -\\frac{1}{\\beta} \\ln\\left(\\sqrt{\\frac{2\\pi}{\\beta k}}\\right)\n$$\n使用对数性质 $\\ln(\\sqrt{y}) = \\frac{1}{2}\\ln(y)$，我们得到：\n$$\nA_{\\mathrm{conf}}(k,T) = -\\frac{1}{2\\beta} \\ln\\left(\\frac{2\\pi}{\\beta k}\\right) = \\frac{1}{2\\beta} \\ln\\left(\\frac{\\beta k}{2\\pi}\\right)\n$$\n这就是一维谐振子构型亥姆霍兹自由能的精确表达式。\n\n(b) 通过热力学积分 (TI) 计算自由能差\n\n热力学积分 (TI) 提供了一种计算两个状态之间自由能差的方法，该方法通过对哈密顿量关于耦合参数 $\\lambda$ 的导数的系综平均值进行积分来实现。自由能差由下式给出：\n$$\n\\Delta A = \\int_{0}^{1} \\left\\langle \\frac{\\partial U_{\\lambda}(x)}{\\partial \\lambda} \\right\\rangle_{\\lambda} \\, \\mathrm{d}\\lambda\n$$\n其中 $U_{\\lambda}(x)$ 是在状态 0 ($\\lambda=0$) 和状态 1 ($\\lambda=1$) 之间插值的系统势能，而 $\\langle \\dots \\rangle_{\\lambda}$ 表示在势能为 $U_{\\lambda}(x)$ 的系统上的系综平均。\n\n插值势能由 $U_{\\lambda}(x) = \\frac{1}{2}k(\\lambda)x^{2}$ 给出，其中 $k(\\lambda) = (1-\\lambda)k_{0} + \\lambda k_{1}$。首先，我们计算 $U_{\\lambda}(x)$ 关于 $\\lambda$ 的偏导数：\n$$\n\\frac{\\partial U_{\\lambda}(x)}{\\partial \\lambda} = \\frac{1}{2} \\frac{\\mathrm{d}k(\\lambda)}{\\mathrm{d}\\lambda} x^{2} = \\frac{1}{2} (k_{1} - k_{0}) x^{2}\n$$\n接下来，我们必须在由势能 $U_{\\lambda}(x)$ 定义的正则系综中计算该量的系综平均值 $\\langle \\frac{\\partial U_{\\lambda}(x)}{\\partial \\lambda} \\rangle_{\\lambda}$：\n$$\n\\left\\langle \\frac{\\partial U_{\\lambda}(x)}{\\partial \\lambda} \\right\\rangle_{\\lambda} = \\left\\langle \\frac{1}{2} (k_{1} - k_{0}) x^{2} \\right\\rangle_{\\lambda} = \\frac{1}{2} (k_{1} - k_{0}) \\langle x^{2} \\rangle_{\\lambda}\n$$\n量 $\\langle x^{2} \\rangle_{\\lambda}$ 是力常数为 $k(\\lambda)$ 的谐振子的均方位移。对于经典一维谐振子，能量均分定理指出其平均势能为 $\\langle \\frac{1}{2}k(\\lambda)x^{2} \\rangle_{\\lambda} = \\frac{1}{2}k_{B}T$。由此，我们直接求得均方位移：\n$$\n\\langle x^{2} \\rangle_{\\lambda} = \\frac{k_{B}T}{k(\\lambda)} = \\frac{1}{\\beta k(\\lambda)}\n$$\n将此结果代入系综平均导数的表达式中，得到：\n$$\n\\left\\langle \\frac{\\partial U_{\\lambda}(x)}{\\partial \\lambda} \\right\\rangle_{\\lambda} = \\frac{1}{2} (k_{1} - k_{0}) \\frac{1}{\\beta k(\\lambda)} = \\frac{k_{1} - k_{0}}{2\\beta((1-\\lambda)k_{0} + \\lambda k_{1})}\n$$\n现在我们可以对 $\\lambda$ 从 0 到 1 进行积分：\n$$\n\\Delta A = \\int_{0}^{1} \\frac{k_{1} - k_{0}}{2\\beta((1-\\lambda)k_{0} + \\lambda k_{1})} \\, \\mathrm{d}\\lambda\n$$\n令分母为 $f(\\lambda) = (1-\\lambda)k_{0} + \\lambda k_{1} = k_{0} + \\lambda(k_{1}-k_{0})$。其导数为 $f'(\\lambda) = k_{1} - k_{0}$。该积分为 $\\int \\frac{f'(\\lambda)}{f(\\lambda)}\\mathrm{d}\\lambda = \\ln(f(\\lambda))$ 的形式。\n$$\n\\Delta A = \\frac{1}{2\\beta} \\left[ \\ln\\left((1-\\lambda)k_{0} + \\lambda k_{1}\\right) \\right]_{0}^{1} = \\frac{1}{2\\beta} (\\ln(k_{1}) - \\ln(k_{0})) = \\frac{1}{2\\beta} \\ln\\left(\\frac{k_{1}}{k_{0}}\\right)\n$$\n\n(c) 通过自由能微扰 (FEP) 计算自由能差\n\n自由能微扰 (FEP) 公式，也称为 Zwanzig 方程，将自由能差表示为在参考态上计算的势能差的系综平均。选择力常数为 $k_{0}$ 的初始态作为参考态，该公式为：\n$$\n\\Delta A = A_{1} - A_{0} = -\\frac{1}{\\beta} \\ln \\left\\langle \\exp\\left(-\\beta (U_{1}(x) - U_{0}(x))\\right) \\right\\rangle_{0}\n$$\n此处，$U_{0}(x) = \\frac{1}{2}k_{0}x^{2}$，$U_{1}(x) = \\frac{1}{2}k_{1}x^{2}$，且 $\\langle \\dots \\rangle_{0}$ 表示在参考态 0 上的系综平均。势能差为 $\\Delta U(x) = U_{1}(x) - U_{0}(x) = \\frac{1}{2}(k_{1}-k_{0})x^{2}$。\n\n该系综平均计算如下：\n$$\n\\left\\langle \\exp(-\\beta \\Delta U(x)) \\right\\rangle_{0} = \\frac{\\int_{-\\infty}^{\\infty} \\exp(-\\beta \\Delta U(x)) \\exp(-\\beta U_{0}(x)) \\, \\mathrm{d}x}{\\int_{-\\infty}^{\\infty} \\exp(-\\beta U_{0}(x)) \\, \\mathrm{d}x}\n$$\n分子被积函数中指数函数的自变量为：\n$$\n-\\beta \\Delta U(x) - \\beta U_{0}(x) = -\\beta \\left(\\frac{1}{2}(k_{1}-k_{0})x^{2} + \\frac{1}{2}k_{0}x^{2}\\right) = -\\frac{1}{2}\\beta k_{1}x^{2} = -\\beta U_1(x)\n$$\n因此，该系综平均是两个配分函数之比：\n$$\n\\left\\langle \\exp(-\\beta \\Delta U(x)) \\right\\rangle_{0} = \\frac{\\int_{-\\infty}^{\\infty} \\exp(-\\beta U_{1}(x)) \\, \\mathrm{d}x}{\\int_{-\\infty}^{\\infty} \\exp(-\\beta U_{0}(x)) \\, \\mathrm{d}x} = \\frac{Z_{\\mathrm{conf}}(k_1, T)}{Z_{\\mathrm{conf}}(k_0, T)}\n$$\n使用 (a) 部分中关于 $Z_{\\mathrm{conf}}$ 的结果 $Z_{\\mathrm{conf}}(k,T) = \\sqrt{\\frac{2\\pi}{\\beta k}}$，我们有：\n$$\n\\frac{Z_{\\mathrm{conf}}(k_1, T)}{Z_{\\mathrm{conf}}(k_0, T)} = \\frac{\\sqrt{\\frac{2\\pi}{\\beta k_{1}}}}{\\sqrt{\\frac{2\\pi}{\\beta k_{0}}}} = \\sqrt{\\frac{k_{0}}{k_{1}}}\n$$\n将此结果代回 $\\Delta A$ 的 FEP 公式中：\n$$\n\\Delta A = -\\frac{1}{\\beta} \\ln\\left(\\sqrt{\\frac{k_{0}}{k_{1}}}\\right) = -\\frac{1}{2\\beta} \\ln\\left(\\frac{k_{0}}{k_{1}}}\\right) = \\frac{1}{2\\beta} \\ln\\left(\\frac{k_{1}}{k_{0}}}\\right)\n$$\n三种方法——从 $A$ 的定义直接计算、热力学积分以及自由能微扰——均得出相同的结果，这符合一致性的要求。将 $\\beta = 1/(k_{B}T)$ 代入，即可推导出亥姆霍兹自由能变化的最终表达式：\n$$\n\\Delta A = \\frac{1}{2}k_{B}T \\ln\\left(\\frac{k_{1}}{k_{0}}\\right)\n$$\n这就是所要求的 $\\Delta A$ 的单一闭合形式解析表达式。", "answer": "$$\n\\boxed{\\frac{1}{2} k_{B} T \\ln\\left(\\frac{k_{1}}{k_{0}}\\right)}\n$$", "id": "2642319"}, {"introduction": "尽管自由能微扰（FEP）的 Zwanzig 方程是精确的，但其在实践中的应用可能面临采样效率的挑战。本练习探索了一种在两个态之间的能量差 $\\Delta U$ 呈高斯分布时出现的强大近似方法 [@problem_id:2642298]。通过推导此时自由能差 $\\Delta A$ 的简化表达式，你将深入理解作为一种广泛应用的近似方法的二阶累积量展开，并学会判断其适用范围。", "problem": "考虑在绝对温度 $T$ 下，由 $0$ 和 $1$ 标记的两个经典多粒子态，其势能函数分别为 $U_{0}(\\mathbf{x})$ 和 $U_{1}(\\mathbf{x})$。设亥姆霍兹自由能差定义为 $\\Delta A \\equiv A_{1}-A_{0}$，其中 $A_{i}=-k_{B}T \\ln Z_{i}$，$Z_{i}=\\int \\exp(-\\beta U_{i}(\\mathbf{x}))\\,d\\mathbf{x}$ 为正则配分函数，$\\beta \\equiv 1/(k_{B}T)$，$k_{B}$ 为玻尔兹曼常数。定义状态 $0$ 的平衡概率密度为 $\\pi_{0}(\\mathbf{x})=Z_{0}^{-1}\\exp(-\\beta U_{0}(\\mathbf{x}))$，势能差为 $\\Delta U(\\mathbf{x}) \\equiv U_{1}(\\mathbf{x})-U_{0}(\\mathbf{x})$。假设在 $\\pi_{0}$ 下，随机变量 $\\Delta U$ 服从均值为 $\\mu$、方差为 $\\sigma^{2}$ 的高斯分布，即相对于 $\\pi_{0}$ 有 $\\Delta U \\sim \\mathcal{N}(\\mu,\\sigma^{2})$。\n\n仅使用上述正则定义和关于 $\\Delta U$ 的高斯假设，推导自由能差 $\\Delta A$ 关于 $\\mu$、$\\sigma$、$k_{B}$ 和 $T$ 的闭式表达式。然后，基于统计力学的第一性原理和高斯矩生成函数的性质，解释您所得表达式的有效范围（包括形式上的和实际的），涵盖对分布形状和采样可靠性的假设。\n\n将最终答案表示为关于 $\\mu$、$\\sigma$、$k_{B}$ 和 $T$ 的单一解析表达式。不要代入数值，最终的方框结果中不要包含单位。无需四舍五入。", "solution": "该问题要求在势能差 $\\Delta U$ 从状态 $0$ 的平衡系综中采样时服从高斯分布这一特定假设下，推导两个状态 $0$ 和 $1$ 之间的亥姆霍兹自由能差 $\\Delta A$ 的闭式表达式。此外，还要求解释此表达式的有效范围。\n\n推导从所提供的基本定义开始。状态 $i$ 的亥姆霍兹自由能由 $A_{i} = -k_{B}T \\ln Z_{i}$ 给出，其中 $k_{B}$ 是玻尔兹曼常数，$T$ 是绝对温度，$Z_{i}$ 是状态 $i$ 的正则配分函数。因此，自由能差为：\n$$\n\\Delta A = A_{1} - A_{0} = (-k_{B}T \\ln Z_{1}) - (-k_{B}T \\ln Z_{0}) = -k_{B}T \\ln\\left(\\frac{Z_{1}}{Z_{0}}\\right)\n$$\n配分函数由对系统所有微观态 $\\mathbf{x}$ 的积分定义：\n$$\nZ_{i} = \\int \\exp(-\\beta U_{i}(\\mathbf{x}))\\,d\\mathbf{x}\n$$\n其中 $\\beta = 1/(k_{B}T)$ 且 $U_{i}(\\mathbf{x})$ 是状态 $i$ 的势能函数。\n\n为计算配分函数的比值，我们执行一个在自由能微扰理论中至关重要的标准操作。我们将比值 $Z_{1}/Z_{0}$ 表示如下：\n$$\n\\frac{Z_{1}}{Z_{0}} = \\frac{\\int \\exp(-\\beta U_{1}(\\mathbf{x}))\\,d\\mathbf{x}}{Z_{0}}\n$$\n我们在被积函数上乘以并除以 $\\exp(-\\beta U_{0}(\\mathbf{x}))$，这是一个非零量：\n$$\n\\frac{Z_{1}}{Z_{0}} = \\int \\frac{\\exp(-\\beta U_{1}(\\mathbf{x}))}{\\exp(-\\beta U_{0}(\\mathbf{x}))} \\frac{\\exp(-\\beta U_{0}(\\mathbf{x}))}{Z_{0}} \\,d\\mathbf{x}\n$$\n这可以利用势能差 $\\Delta U(\\mathbf{x}) = U_{1}(\\mathbf{x}) - U_{0}(\\mathbf{x})$ 和状态 $0$ 的平衡概率密度 $\\pi_{0}(\\mathbf{x}) = Z_{0}^{-1}\\exp(-\\beta U_{0}(\\mathbf{x}))$ 的定义重写为：\n$$\n\\frac{Z_{1}}{Z_{0}} = \\int \\exp(-\\beta \\Delta U(\\mathbf{x})) \\pi_{0}(\\mathbf{x}) \\,d\\mathbf{x}\n$$\n根据定义，该积分是量 $\\exp(-\\beta \\Delta U)$ 在状态 $0$ 的系综下的期望值。我们将此期望值表示为 $\\langle \\exp(-\\beta \\Delta U) \\rangle_{0}$。\n$$\n\\frac{Z_{1}}{Z_{0}} = \\langle \\exp(-\\beta \\Delta U) \\rangle_{0}\n$$\n将此结果代回 $\\Delta A$ 的表达式，得到 Zwanzig 方程：\n$$\n\\Delta A = -k_{B}T \\ln\\langle \\exp(-\\beta \\Delta U) \\rangle_{0}\n$$\n现在，我们必须应用问题的核心假设：当根据概率密度 $\\pi_{0}(\\mathbf{x})$ 采样时，随机变量 $\\Delta U$ 服从均值为 $\\mu$、方差为 $\\sigma^{2}$ 的高斯分布 $\\mathcal{N}(\\mu, \\sigma^{2})$。\n\n期望值 $\\langle \\exp(-\\beta \\Delta U) \\rangle_{0}$ 等价于随机变量 $\\Delta U$ 的矩生成函数（MGF），记为 $M_{\\Delta U}(t)$，在 $t = -\\beta$ 处的值。随机变量 $X$ 的MGF定义为 $M_{X}(t) = \\langle \\exp(tX) \\rangle$。对于服从高斯分布的随机变量 $X \\sim \\mathcal{N}(\\mu, \\sigma^{2})$，其MGF是概率论中的一个标准结果：\n$$\nM_{X}(t) = \\exp\\left(\\mu t + \\frac{1}{2}\\sigma^{2}t^{2}\\right)\n$$\n将此应用于我们的变量 $\\Delta U$ 并在 $t = -\\beta$ 处求值：\n$$\n\\langle \\exp(-\\beta \\Delta U) \\rangle_{0} = M_{\\Delta U}(-\\beta) = \\exp\\left(\\mu(-\\beta) + \\frac{1}{2}\\sigma^{2}(-\\beta)^{2}\\right) = \\exp\\left(-\\beta\\mu + \\frac{1}{2}\\beta^{2}\\sigma^{2}\\right)\n$$\n现在我们将此代回 $\\Delta A$ 的表达式中：\n$$\n\\Delta A = -k_{B}T \\ln\\left[\\exp\\left(-\\beta\\mu + \\frac{1}{2}\\beta^{2}\\sigma^{2}\\right)\\right]\n$$\n对数和指数是互为反函数，这可将表达式简化为：\n$$\n\\Delta A = -k_{B}T \\left(-\\beta\\mu + \\frac{1}{2}\\beta^{2}\\sigma^{2}\\right)\n$$\n最后，代入 $\\beta = 1/(k_{B}T)$:\n$$\n\\Delta A = -k_{B}T \\left(-\\frac{\\mu}{k_{B}T} + \\frac{1}{2}\\frac{\\sigma^{2}}{(k_{B}T)^{2}}\\right) = \\mu - \\frac{\\sigma^{2}}{2k_{B}T}\n$$\n这是在给定高斯假设下自由能差的闭式表达式。\n\n此表达式的有效范围必须从两个角度来考虑：形式上的和实际的。\n\n形式上，推导 $\\Delta A = \\mu - \\frac{\\sigma^{2}}{2k_{B}T}$ 是一个完全取决于 $\\Delta U$ 在 $\\pi_{0}$ 下的分布是完美高斯分布这一前提的精确恒等式。这是因为自由能差可以表示为一个累积量展开：\n$$\n\\Delta A = \\sum_{n=1}^{\\infty} \\frac{(-\\beta)^{n-1}}{n!} C_{n} = C_{1} - \\frac{\\beta}{2}C_{2} + \\frac{\\beta^{2}}{6}C_{3} - \\dots\n$$\n其中 $C_{n}$ 是 $\\Delta U$ 分布的第 $n$ 阶累积量。对于任何分布，$C_{1} = \\mu$ 且 $C_{2} = \\sigma^{2}$。高斯分布的一个定义性属性是所有阶数 $n > 2$ 的累积量恒为零（$C_{3}=C_{4}=\\dots=0$）。因此，对于一个完美的高斯分布，累积量级数在第二项后精确截断，从而得到我们推导出的结果。\n\n实际上，真实物理系统中 $\\Delta U$ 的分布很少（如果曾经有过的话）是完美高斯分布的。该表达式作为近似的有效性取决于几个因素：\n$1$. 分布形状：仅当 $\\Delta U$ 的真实分布接近高斯分布时，该近似才准确。这种情况更可能出现在大型复杂系统中，其中总能量差 $\\Delta U$ 来自许多微弱相关的贡献之和，从而引发一种类似中心极限定理的行为。如果 $\\Delta U$ 由少数几个强的、特定的相互作用主导（例如，单个共价键或关键氢键的形成或断裂），这可能导致高度偏斜甚至双峰的分布，那么该近似将失败。用累积量来说，这意味着当高阶累积量（如偏度（$C_{3}$）和超额峰度（$C_{4}$））与 $\\mu$ 和 $\\sigma^{2}$ 相比可以忽略不计时，该近似有效。\n$2$. 态重叠：方差 $\\sigma^{2}$ 可作为衡量状态 $0$ 和状态 $1$ 势能面之间“距离”或缺乏重叠的指标。小方差（例如 $\\sigma \\lesssim k_{B}T$）意味着良好的重叠，即状态 $1$ 的重要构型在状态 $0$ 的系综中得到了合理的采样。在这种情况下，$\\Delta U$ 分布是窄的，更可能是对称且行为良好的，使得高斯近似更为稳健。相反，大方差（$\\sigma \\gg k_{B}T$）表示重叠差，此时 $\\Delta U$ 分布很宽。在这种情况下，分布更容易出现非高斯特性（例如重尾），二阶近似会失效。\n$3$. 采样可靠性：虽然 $\\mu = \\langle \\Delta U \\rangle_{0}$ 和 $\\sigma^{2} = \\langle (\\Delta U - \\mu)^{2} \\rangle_{0}$ 的计算通常比直接计算 $\\langle \\exp(-\\beta \\Delta U) \\rangle_{0}$（它对尾部的罕见事件高度敏感）在统计上要稳定得多，但最终结果的准确性仍然取决于获得这两个矩的收敛估计。任何实际计算（如分子动力学模拟）都必须足够长，以充分采样状态 $0$ 的相空间，确保计算出的 $\\mu$ 和 $\\sigma^{2}$ 能代表真实的平衡值。采样不足将导致有偏的矩和不准确的 $\\Delta A$。\n\n总之，该表达式对于高斯能量差分布是形式上精确的。在实践中，当状态足够相似（$\\sigma^{2}$ 小）、系统足够复杂以至于中心极限定理近似成立、并且计算采样足以使能量差的均值和方差收敛时，它是一个有用的近似。", "answer": "$$\\boxed{\\mu - \\frac{\\sigma^{2}}{2k_{B}T}}$$", "id": "2642298"}, {"introduction": "从理论走向实践，关键一步在于处理来自模拟的离散数据，并对各种误差来源进行量化。本练习模拟了一个真实世界的研究场景，你需要根据一组热力学积分（TI）计算得到的、各自带有统计不确定性的数据点来计算自由能差 [@problem_id:2774300]。你将学习如何运用数值积分方法，传递采样误差，并估算截断误差，最终报告一个包含稳健计算的置信区间的最终结果。", "problem": "一个标量耦合参数 $\\lambda \\in [0,1]$ 在两个末端状态之间对分子哈密顿量进行线性插值。在恒定温度下，这两个状态之间的亥姆霍兹自由能差 $\\Delta F$ 由系综平均广义力沿 $\\lambda$ 的路径积分给出。现提供在等间距（间距为 $h$）的离散格点 $\\lambda_i$ 上系综平均 $\\langle \\partial U/\\partial \\lambda \\rangle_{\\lambda}$ 的独立估计值，以及它们的一倍标准差的标准误差。假设在每个窗口内采样是遍历的，并且窗口之间是统计独立的。\n\n数据（所有能量单位均为 $\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$）：\n- 格点：$\\lambda_i = 0.0, 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1.0$，均匀间距 $h = 0.1$。\n- 平均值：在 $\\lambda=0.0$ 时：$4.000$；在 $\\lambda=0.1$ 时：$4.472$；在 $\\lambda=0.2$ 时：$4.896$；在 $\\lambda=0.3$ 时：$5.284$；在 $\\lambda=0.4$ 时：$5.648$；在 $\\lambda=0.5$ 时：$6.000$；在 $\\lambda=0.6$ 时：$6.352$；在 $\\lambda=0.7$ 时：$6.716$；在 $\\lambda=0.8$ 时：$7.104$；在 $\\lambda=0.9$ 时：$7.528$；在 $\\lambda=1.0$ 时：$8.000$。\n- 标准误差（一倍标准差）：在 $\\lambda=0.0$ 时：$0.080$；在 $\\lambda=0.1$ 时：$0.090$；在 $\\lambda=0.2$ 时：$0.080$；在 $\\lambda=0.3$ 时：$0.070$；在 $\\lambda=0.4$ 时：$0.060$；在 $\\lambda=0.5$ 时：$0.050$；在 $\\lambda=0.6$ 时：$0.060$；在 $\\lambda=0.7$ 时：$0.070$；在 $\\lambda=0.8$ 时：$0.080$；在 $\\lambda=0.9$ 时：$0.090$；在 $\\lambda=1.0$ 时：$0.100$。\n\n对被积函数的平滑度分析表明，其四阶导数在该区间上的一个保守界限为：$\\max_{\\lambda \\in [0,1]} \\left| \\frac{\\mathrm{d}^4}{\\mathrm{d}\\lambda^4} \\langle \\partial U/\\partial \\lambda \\rangle_{\\lambda} \\right| \\leq 1200~\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$。\n\n任务：\n- 从热力学积分自由能的定义出发，使用此格点上的一种一致的数值求积方案来估计 $\\Delta F$。\n- 在 $\\lambda$ 窗口间相互独立的假设下，通过求积估计量传播采样不确定度。\n- 使用给定的平滑度界限估计数值积分的截断不确定度。将此截断不确定度视为一个矩形（均匀）分布，其半宽等于求积误差界，从而得到一个标准不确定度。\n- 将采样和截断的标准不确定度进行正交合并，以获得 $\\Delta F$ 的单一合成标准不确定度。\n\n将最终自由能以 $\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$ 为单位表示，并将中心值四舍五入至四位有效数字。对于不确定度，在中间计算中至少保留两位有效数字，并用文字说明你的合并过程。评分将以 $\\Delta F$ 的中心值作为最终数值答案，但你的解答必须包括完整的不确定度分析。", "solution": "该问题经检验具有科学依据、问题适定且客观。这是数值分析应用于热力学积分的一个标准练习，而热力学积分是计算化学中的一项核心技术。我们可以开始解答。\n\n热力学积分中，亥姆霍兹自由能差 $\\Delta F$ 的基本关系由系综平均广义力对耦合参数 $\\lambda$ 的积分给出：\n$$ \\Delta F = \\int_{0}^{1} \\left\\langle \\frac{\\partial U}{\\partial \\lambda} \\right\\rangle_{\\lambda} \\mathrm{d}\\lambda $$\n我们已知被积函数（记为 $f(\\lambda) = \\langle \\partial U/\\partial \\lambda \\rangle_{\\lambda}$）在 $N+1 = 11$ 个等间距点 $\\lambda_i = i \\cdot h$（其中 $i \\in \\{0, 1, \\dots, 10\\}$，间距 $h = 0.1$）上的离散值。我们必须对这个积分进行数值估计。\n\n首先，我们选择一个一致的数值求积方案。数据是在一个包含 $10$ 个区间的均匀网格上提供的，这是一个偶数。这一点，再加上所提供的被积函数四阶导数的界，强烈建议使用复合辛普森法则。该方法是四阶的，其误差项与此导数有关。对于 $N$ 个区间（其中 $N$ 为偶数），复合辛普森法则的公式为：\n$$ I_S = \\frac{h}{3} \\left[ f_0 + 4\\sum_{i=1, i \\text{ odd}}^{N-1} f_i + 2\\sum_{i=2, i \\text{ even}}^{N-2} f_i + f_N \\right] $$\n这里，$N=10$，$h=0.1$，$f_i$ 是在 $\\lambda_i$ 处给定的被积函数的平均值。\n其值为 $f_0 = 4.000$, $f_1 = 4.472$, $f_2 = 4.896$, $f_3 = 5.284$, $f_4 = 5.648$, $f_5 = 6.000$, $f_6 = 6.352$, $f_7 = 6.716$, $f_8 = 7.104$, $f_9 = 7.528$, 以及 $f_{10} = 8.000$，单位均为 $\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$。\n\n我们计算加权和：\n奇数索引项之和：$f_1 + f_3 + f_5 + f_7 + f_9 = 4.472 + 5.284 + 6.000 + 6.716 + 7.528 = 30.000$。\n偶数索引项之和（不含端点）：$f_2 + f_4 + f_6 + f_8 = 4.896 + 5.648 + 6.352 + 7.104 = 24.000$。\n括号内的总表达式为：\n$$ [f_0 + f_{10} + 4(30.000) + 2(24.000)] = [4.000 + 8.000 + 120.000 + 48.000] = 180.000 $$\n因此，自由能差的估计值为：\n$$ \\Delta F \\approx \\frac{0.1}{3} (180.000) = 6.000~\\mathrm{kJ}\\,\\mathrm{mol}^{-1} $$\n值得注意的是，所提供的数据点完全符合三次多项式 $f(\\lambda) = 2(\\lambda-0.5)^3 + 3.5(\\lambda-0.5) + 6$。由于辛普森法则对最高三次的多项式是精确的，我们的数值估计 $\\Delta F = 6.000~\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$ 事实上就是这个底层函数的精确积分。\n\n接下来，我们评估此估计的不确定度。总不确定度来自两个独立的来源：每个 $\\lambda_i$ 处模拟的统计采样不确定度，以及数值求积法则的系统截断不确定度。\n\n1.  **采样不确定度 ($\\sigma_{\\text{samp}}$)**\n    $\\Delta F$ 的估计值是测得的平均值 $f_i$ 的线性组合，即 $\\Delta F = \\sum_{i=0}^{10} w_i f_i$，其中 $w_i$ 是辛普森法则的权重。由于不同 $\\lambda_i$ 处的估计值是统计上独立的，$\\Delta F$ 的方差是各个方差 $\\sigma_i^2$ 的加权和。\n    $$ \\sigma_{\\text{samp}}^2 = \\sum_{i=0}^{10} w_i^2 \\sigma_i^2 = \\left(\\frac{h}{3}\\right)^2 \\left[ 1^2\\sigma_0^2 + 4^2\\sigma_1^2 + 2^2\\sigma_2^2 + \\dots + 4^2\\sigma_9^2 + 1^2\\sigma_{10}^2 \\right] $$\n    标准误差 $\\sigma_i$ 分别为：$\\sigma_0=0.080$, $\\sigma_1=0.090$, $\\sigma_2=0.080$, $\\sigma_3=0.070$, $\\sigma_4=0.060$, $\\sigma_5=0.050$, $\\sigma_6=0.060$, $\\sigma_7=0.070$, $\\sigma_8=0.080$, $\\sigma_9=0.090$ 和 $\\sigma_{10}=0.100$。\n    方差的加权和为：\n    $$ \\sum w_i^2 \\sigma_i^2 / (h/3)^2 = 1^2(0.080)^2 + 16(0.090)^2 + 4(0.080)^2 + 16(0.070)^2 + 4(0.060)^2 + 16(0.050)^2 + 4(0.060)^2 + 16(0.070)^2 + 4(0.080)^2 + 16(0.090)^2 + 1^2(0.100)^2 $$\n    $$ = 0.0064 + 0.1296 + 0.0256 + 0.0784 + 0.0144 + 0.0400 + 0.0144 + 0.0784 + 0.0256 + 0.1296 + 0.0100 = 0.5524 $$\n    采样引起的方差为：\n    $$ \\sigma_{\\text{samp}}^2 = \\left(\\frac{0.1}{3}\\right)^2 (0.5524) = \\frac{0.01}{9} \\times 0.5524 \\approx 0.00061378 $$\n    采样引起的标准不确定度为：\n    $$ \\sigma_{\\text{samp}} = \\sqrt{0.00061378} \\approx 0.02477~\\mathrm{kJ}\\,\\mathrm{mol}^{-1} $$\n\n2.  **截断不确定度 ($u_{\\text{trunc}}$)**\n    复合辛普森法则的截断误差 $E_S$ 的界限为：\n    $$ |E_S| \\le \\frac{b-a}{180} h^4 \\max_{\\lambda \\in [a,b]} |f^{(4)}(\\lambda)| $$\n    给定 $a=0$, $b=1$, $h=0.1$ 以及界 $\\max |f^{(4)}(\\lambda)| \\leq M_4 = 1200~\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$，最大绝对误差为：\n    $$ |E_S|_{\\max} = \\frac{1-0}{180} (0.1)^4 (1200) = \\frac{0.0001 \\times 1200}{180} = \\frac{0.12}{180} = \\frac{1}{1500} \\approx 0.000667~\\mathrm{kJ}\\,\\mathrm{mol}^{-1} $$\n    题目指示将此误差建模为区间 $[-|E_S|_{\\max}, +|E_S|_{\\max}]$ 上的一个矩形（均匀）分布。$[-c, c]$ 上均匀分布的标准差为 $c/\\sqrt{3}$。因此，截断引起的标准不确定度为：\n    $$ u_{\\text{trunc}} = \\frac{|E_S|_{\\max}}{\\sqrt{3}} = \\frac{1}{1500\\sqrt{3}} \\approx 0.000385~\\mathrm{kJ}\\,\\mathrm{mol}^{-1} $$\n    尽管解析函数是三次的（意味着截断误差为零），但这个不确定度是基于所提供的保守界限的估计。我们遵循题目要求。\n\n3.  **合成标准不确定度 ($u_c$)**\n    假设采样误差和截断误差是独立的，它们的标准不确定度进行正交合并：\n    $$ u_c^2 = \\sigma_{\\text{samp}}^2 + u_{\\text{trunc}}^2 = 0.00061378 + \\left(\\frac{1}{1500\\sqrt{3}}\\right)^2 \\approx 0.00061378 + 0.000000148 = 0.00061393 $$\n    $$ u_c = \\sqrt{0.00061393} \\approx 0.02478~\\mathrm{kJ}\\,\\mathrm{mol}^{-1} $$\n    与采样不确定度相比，截断不确定度的贡献可以忽略不计。将最终不确定度保留两位有效数字，得到 $u_c \\approx 0.025~\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$。\n    最终自由能差为 $\\Delta F = 6.000 \\pm 0.025~\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$。中心值四舍五入至四位有效数字为 $6.000$。", "answer": "$$\n\\boxed{6.000}\n$$", "id": "2774300"}]}