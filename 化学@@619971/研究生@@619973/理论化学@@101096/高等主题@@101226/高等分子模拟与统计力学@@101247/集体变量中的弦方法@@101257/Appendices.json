{"hands_on_practices": [{"introduction": "黎曼度规张量 $G_{\\alpha\\beta}$ 是弦方法的核​​心，因为它定义了集体变量空间内的距离和几何概念。本次入门实践将提供必要的动手经验，引导您为一个由距离和角度（两种最常见的集体变量）定义的简单分子系统，明确推导出度规张量。掌握这一计算过程，是在抽象形式理论与具体应用之间架起了一座桥梁。[@problem_id:2822334]", "problem": "考虑一个三维欧几里得空间中的三原子系统，其笛卡尔坐标为 $\\mathbf{x}_1, \\mathbf{x}_2, \\mathbf{x}_3 \\in \\mathbb{R}^3$，原子质量为 $m_1, m_2, m_3$。定义两个集体变量 (CVs)：原子间距 $\\xi_1 = r = \\|\\mathbf{x}_1 - \\mathbf{x}_2\\|$ 和以原子2为顶点的角 $\\xi_2 = \\theta$，该角由向量 $\\mathbf{u} = \\mathbf{x}_1 - \\mathbf{x}_2$ 和 $\\mathbf{v} = \\mathbf{x}_3 - \\mathbf{x}_2$ 构成，即 $\\theta$ 满足 $\\cos \\theta = \\dfrac{\\mathbf{u} \\cdot \\mathbf{v}}{\\|\\mathbf{u}\\| \\, \\|\\mathbf{v}\\|}$。在集体变量中的弦方法框架下进行计算，其中CV空间中的黎曼度规张量由质量加权的内积定义\n$$\nG_{\\alpha\\beta}(\\xi) = \\sum_{k=1}^{3} \\frac{1}{m_k} \\, \\nabla_{\\mathbf{x}_k} \\xi_\\alpha \\cdot \\nabla_{\\mathbf{x}_k} \\xi_\\beta, \\quad \\alpha,\\beta \\in \\{1,2\\},\n$$\n其中 $\\xi_1 = r$ 且 $\\xi_2 = \\theta$。\n\n任务：\n- 从 $r$ 和 $\\theta$ 的定义出发，仅使用标准多元微积分（乘法法则、链式法则以及反余弦函数的导数），推导出笛卡尔梯度 $\\nabla_{\\mathbf{x}_k} r$ 和 $\\nabla_{\\mathbf{x}_k} \\theta$（其中 $k \\in \\{1,2,3\\}$）关于 $\\mathbf{u}$、$\\mathbf{v}$ 及其范数的显式表达式。\n- 考虑以下特定构型\n$$\n\\mathbf{x}_1 = (2,0,0)\\, \\text{\\AA}, \\quad \\mathbf{x}_2 = (1,0,0)\\, \\text{\\AA}, \\quad \\mathbf{x}_3 = \\bigl(1 + 2 \\cos(\\pi/3), \\, 2 \\sin(\\pi/3), \\, 0\\bigr)\\, \\text{\\AA},\n$$\n以及质量 $m_1 = 12\\, \\text{amu}$，$m_2 = 16\\, \\text{amu}$，$m_3 = 14\\, \\text{amu}$。在此构型下计算您的梯度公式，并计算度规 $G(\\xi)$ 及其逆 $G^{-1}(\\xi)$。\n- 最后，计算此构型下的行列式 $\\det G(\\xi)$，并报告其数值，保留四位有效数字。以 $(\\text{amu})^{-2}\\,\\text{\\AA}^{-2}$ 为单位表示最终结果。按最后一步的指示，仅用数值（不带单位）作答。", "solution": "该问题陈述具有科学依据、提法明确、客观且信息完整。它展示了理论化学领域中一个关于集体变量中弦方法的标准的、非平凡的计算。所有数据和定义均已提供，不存在矛盾或歧义。因此，该问题是有效的，并将提供解答。\n\n该系统由三个原子位置向量 $\\mathbf{x}_1, \\mathbf{x}_2, \\mathbf{x}_3 \\in \\mathbb{R}^3$ 描述。定义了两个集体变量 (CVs)：距离 $\\xi_1 = r$ 和角度 $\\xi_2 = \\theta$。我们定义辅助向量 $\\mathbf{u} = \\mathbf{x}_1 - \\mathbf{x}_2$ 和 $\\mathbf{v} = \\mathbf{x}_3 - \\mathbf{x}_2$。CVs 随之表示为\n$$\nr = \\|\\mathbf{u}\\|, \\quad \\theta = \\arccos\\left(\\frac{\\mathbf{u} \\cdot \\mathbf{v}}{\\|\\mathbf{u}\\|\\|\\mathbf{v}\\|}\\right).\n$$\n我们引入记号 $s = \\|\\mathbf{v}\\|$，$\\hat{\\mathbf{u}} = \\mathbf{u}/r$ 和 $\\hat{\\mathbf{v}} = \\mathbf{v}/s$。\n\n**第一部分：笛卡尔梯度的推导**\n\n我们计算 CVs 相对于原子位置的梯度，$\\nabla_k \\equiv \\nabla_{\\mathbf{x}_k}$。\n\n对于 $\\xi_1 = r = \\sqrt{\\mathbf{u} \\cdot \\mathbf{u}} = \\sqrt{(\\mathbf{x}_1 - \\mathbf{x}_2) \\cdot (\\mathbf{x}_1 - \\mathbf{x}_2)}$，梯度为：\n$$\n\\nabla_1 r = \\frac{\\partial r}{\\partial \\mathbf{x}_1} = \\frac{1}{2r} (2(\\mathbf{x}_1 - \\mathbf{x}_2)) = \\frac{\\mathbf{u}}{r} = \\hat{\\mathbf{u}}\n$$\n$$\n\\nabla_2 r = \\frac{\\partial r}{\\partial \\mathbf{x}_2} = \\frac{1}{2r} (-2(\\mathbf{x}_1 - \\mathbf{x}_2)) = -\\frac{\\mathbf{u}}{r} = -\\hat{\\mathbf{u}}\n$$\n$$\n\\nabla_3 r = \\frac{\\partial r}{\\partial \\mathbf{x}_3} = \\mathbf{0}\n$$\n\n对于 $\\xi_2 = \\theta = \\arccos(\\hat{\\mathbf{u}} \\cdot \\hat{\\mathbf{v}})$，我们应用链式法则。令 $C = \\cos\\theta = \\hat{\\mathbf{u}} \\cdot \\hat{\\mathbf{v}}$。\n$$\n\\nabla_k \\theta = \\frac{d\\theta}{dC} \\nabla_k C = -\\frac{1}{\\sqrt{1-C^2}} \\nabla_k C = -\\frac{1}{\\sin\\theta} \\nabla_k C\n$$\n该式在 $\\theta \\in (0, \\pi)$ 时成立，此时 $\\sin\\theta > 0$。梯度 $\\nabla_k C$ 通过向量函数的链式法则求得：$\\nabla_k C = (\\mathbf{J}_{\\mathbf{u},k})^T \\nabla_{\\mathbf{u}} C + (\\mathbf{J}_{\\mathbf{v},k})^T \\nabla_{\\mathbf{v}} C$，其中 $\\mathbf{J}_{\\mathbf{w},k} = \\frac{\\partial \\mathbf{w}}{\\partial \\mathbf{x}_k}$ 是雅可比矩阵。\nC 相对于 $\\mathbf{u}$ 和 $\\mathbf{v}$ 的梯度是：\n$$\n\\nabla_{\\mathbf{u}} C = \\nabla_{\\mathbf{u}} \\left(\\frac{\\mathbf{u} \\cdot \\mathbf{v}}{r s}\\right) = \\frac{\\mathbf{v}}{rs} - \\frac{\\mathbf{u} \\cdot \\mathbf{v}}{s} \\frac{\\nabla_{\\mathbf{u}} r}{r^2} = \\frac{\\hat{\\mathbf{v}}}{r} - \\frac{r \\cos\\theta}{s} \\frac{\\hat{\\mathbf{u}}}{r^2} = \\frac{1}{r}(\\hat{\\mathbf{v}} - \\cos\\theta \\hat{\\mathbf{u}})\n$$\n$$\n\\nabla_{\\mathbf{v}} C = \\nabla_{\\mathbf{v}} \\left(\\frac{\\mathbf{u} \\cdot \\mathbf{v}}{r s}\\right) = \\frac{\\mathbf{u}}{rs} - \\frac{\\mathbf{u} \\cdot \\mathbf{v}}{r} \\frac{\\nabla_{\\mathbf{v}} s}{s^2} = \\frac{\\hat{\\mathbf{u}}}{s} - \\frac{s \\cos\\theta}{r} \\frac{\\hat{\\mathbf{v}}}{s^2} = \\frac{1}{s}(\\hat{\\mathbf{u}} - \\cos\\theta \\hat{\\mathbf{v}})\n$$\n雅可比矩阵是单位矩阵 $\\mathbf{I}$ 的简单倍数：$\\mathbf{J}_{\\mathbf{u},1} = \\mathbf{I}$，$\\mathbf{J}_{\\mathbf{u},2} = -\\mathbf{I}$，$\\mathbf{J}_{\\mathbf{u},3} = \\mathbf{0}$；以及 $\\mathbf{J}_{\\mathbf{v},1} = \\mathbf{0}$，$\\mathbf{J}_{\\mathbf{v},2} = -\\mathbf{I}$，$\\mathbf{J}_{\\mathbf{v},3} = \\mathbf{I}$。\n因此，梯度 $\\nabla_k C$ 为：\n$$\n\\nabla_1 C = \\nabla_{\\mathbf{u}} C = \\frac{1}{r}(\\hat{\\mathbf{v}} - \\cos\\theta \\hat{\\mathbf{u}})\n$$\n$$\n\\nabla_3 C = \\nabla_{\\mathbf{v}} C = \\frac{1}{s}(\\hat{\\mathbf{u}} - \\cos\\theta \\hat{\\mathbf{v}})\n$$\n$$\n\\nabla_2 C = -(\\nabla_{\\mathbf{u}} C + \\nabla_{\\mathbf{v}} C) = -(\\nabla_1 C + \\nabla_3 C)\n$$\n最后，将这些代入 $\\nabla_k \\theta$ 的表达式中：\n$$\n\\nabla_1 \\theta = -\\frac{1}{\\sin\\theta} \\left( \\frac{1}{r}(\\hat{\\mathbf{v}} - \\cos\\theta \\hat{\\mathbf{u}}) \\right) = \\frac{\\cos\\theta \\hat{\\mathbf{u}} - \\hat{\\mathbf{v}}}{r\\sin\\theta}\n$$\n$$\n\\nabla_3 \\theta = -\\frac{1}{\\sin\\theta} \\left( \\frac{1}{s}(\\hat{\\mathbf{u}} - \\cos\\theta \\hat{\\mathbf{v}}) \\right) = \\frac{\\cos\\theta \\hat{\\mathbf{v}} - \\hat{\\mathbf{u}}}{s\\sin\\theta}\n$$\n$$\n\\nabla_2 \\theta = -(\\nabla_1 \\theta + \\nabla_3 \\theta)\n$$\n\n**第二部分：在特定构型下的计算**\n\n给定的构型和质量是：\n$\\mathbf{x}_1 = (2,0,0)\\,\\text{\\AA}$，$\\mathbf{x}_2 = (1,0,0)\\,\\text{\\AA}$，$\\mathbf{x}_3 = (2, \\sqrt{3}, 0)\\,\\text{\\AA}$。\n$m_1 = 12\\,\\text{amu}$，$m_2 = 16\\,\\text{amu}$，$m_3 = 14\\,\\text{amu}$。\n\n根据这些坐标，我们计算出：\n$\\mathbf{u} = \\mathbf{x}_1 - \\mathbf{x}_2 = (1,0,0)$，所以 $r = \\|\\mathbf{u}\\| = 1\\,\\text{\\AA}$。\n$\\mathbf{v} = \\mathbf{x}_3 - \\mathbf{x}_2 = (1, \\sqrt{3}, 0)$，所以 $s = \\|\\mathbf{v}\\| = \\sqrt{1^2 + (\\sqrt{3})^2} = 2\\,\\text{\\AA}$。\n$\\hat{\\mathbf{u}} = (1,0,0)$，$\\hat{\\mathbf{v}} = (1/2, \\sqrt{3}/2, 0)$。\n$\\cos\\theta = \\hat{\\mathbf{u}} \\cdot \\hat{\\mathbf{v}} = 1/2$，因此 $\\theta = \\pi/3$ 且 $\\sin\\theta = \\sqrt{3}/2$。\n\n在此构型下计算梯度：\n$\\nabla_1 r = \\hat{\\mathbf{u}} = (1,0,0)$。\n$\\nabla_2 r = -\\hat{\\mathbf{u}} = (-1,0,0)$。\n$\\nabla_3 r = \\mathbf{0}$。\n\n$\\nabla_1 \\theta = \\frac{(1/2)(1,0,0) - (1/2, \\sqrt{3}/2, 0)}{1 \\cdot (\\sqrt{3}/2)} = (0, -1, 0)\\,\\text{\\AA}^{-1}$。\n$\\nabla_3 \\theta = \\frac{(1/2)(1/2, \\sqrt{3}/2, 0) - (1,0,0)}{2 \\cdot (\\sqrt{3}/2)} = \\frac{(-3/4, \\sqrt{3}/4, 0)}{\\sqrt{3}} = (-\\frac{\\sqrt{3}}{4}, \\frac{1}{4}, 0)\\,\\text{\\AA}^{-1}$。\n$\\nabla_2 \\theta = -((0, -1, 0) + (-\\frac{\\sqrt{3}}{4}, \\frac{1}{4}, 0)) = (\\frac{\\sqrt{3}}{4}, \\frac{3}{4}, 0)\\,\\text{\\AA}^{-1}$。\n\n度规张量 $G_{\\alpha\\beta} = \\sum_{k=1}^3 \\frac{1}{m_k} \\nabla_k \\xi_\\alpha \\cdot \\nabla_k \\xi_\\beta$：\n$G_{11} = \\frac{1}{m_1} \\|\\nabla_1 r\\|^2 + \\frac{1}{m_2} \\|\\nabla_2 r\\|^2 = \\frac{1}{12}(1)^2 + \\frac{1}{16}(-1)^2 = \\frac{1}{12} + \\frac{1}{16} = \\frac{7}{48}\\,\\text{amu}^{-1}$。\n$G_{12} = G_{21} = \\frac{1}{m_1}(\\nabla_1 r \\cdot \\nabla_1 \\theta) + \\frac{1}{m_2}(\\nabla_2 r \\cdot \\nabla_2 \\theta) = \\frac{1}{12}(0) + \\frac{1}{16}(-\\frac{\\sqrt{3}}{4}) = -\\frac{\\sqrt{3}}{64}\\,\\text{amu}^{-1}\\text{\\AA}^{-1}$。\n$G_{22} = \\frac{1}{m_1}\\|\\nabla_1 \\theta\\|^2 + \\frac{1}{m_2}\\|\\nabla_2 \\theta\\|^2 + \\frac{1}{m_3}\\|\\nabla_3 \\theta\\|^2 = \\frac{1}{12}(1) + \\frac{1}{16}(\\frac{3}{4}) + \\frac{1}{14}(\\frac{1}{4}) = \\frac{1}{12} + \\frac{3}{64} + \\frac{1}{56} = \\frac{112+63+24}{1344} = \\frac{199}{1344}\\,\\text{amu}^{-1}\\text{\\AA}^{-2}$。\n\n度规张量为：\n$$\nG(\\xi) = \\begin{pmatrix} \\frac{7}{48} & -\\frac{\\sqrt{3}}{64} \\\\ -\\frac{\\sqrt{3}}{64} & \\frac{199}{1344} \\end{pmatrix}\n$$\n逆度规张量为 $G^{-1}(\\xi) = \\frac{1}{\\det G} \\begin{pmatrix} G_{22} & -G_{12} \\\\ -G_{12} & G_{11} \\end{pmatrix}$。我们在计算行列式之后再计算它。\n\n**第三部分：度规的行列式**\n\n度规张量的行列式为：\n$$\n\\det G = G_{11}G_{22} - G_{12}^2 = \\left(\\frac{7}{48}\\right)\\left(\\frac{199}{1344}\\right) - \\left(-\\frac{\\sqrt{3}}{64}\\right)^2 = \\frac{1393}{64512} - \\frac{3}{4096}\n$$\n为了进行分数相减，我们找到一个公分母。分母分别是 $48 \\cdot 1344 = 64512$ 和 $64^2 = 4096$。我们注意到 $64512 = 15.75 \\times 4096$。一个公分母是 $64512 \\times 4 = 258048$。\n$$\n\\det G = \\frac{1393 \\times 4}{64512 \\times 4} - \\frac{3 \\times (4096 \\times 15.75/4)}{258048} = \\frac{5572 - 189}{258048} = \\frac{5383}{258048} \\, (\\text{amu})^{-2}\\text{\\AA}^{-2}\n$$\n现在，我们计算逆度规张量：\n$$\nG^{-1}(\\xi) = \\frac{258048}{5383} \\begin{pmatrix} \\frac{199}{1344} & \\frac{\\sqrt{3}}{64} \\\\ \\frac{\\sqrt{3}}{64} & \\frac{7}{48} \\end{pmatrix} = \\frac{1}{5383} \\begin{pmatrix} 38208 & 4032\\sqrt{3} \\\\ 4032\\sqrt{3} & 37632 \\end{pmatrix}\n$$\n需要的是行列式的数值。\n$$\n\\det G = \\frac{5383}{258048} \\approx 0.02086030...\n$$\n四舍五入到四位有效数字，我们得到 $0.02086$。", "answer": "$$\\boxed{0.02086}$$", "id": "2822334"}, {"introduction": "在我们深入理解弦方法的数值算法之前，必须首先深刻领会它所要寻找的目标：最小自由能路径（MFEP）。本练习要求您为一个经典的双阱势能面解析地确定其 MFEP。通过验证您的解满足自由能梯度与路径平行的条件，您将对 MFEP 的基本定义获得一个清晰、第一性的理解。[@problem_id:2822338]", "problem": "考虑一个由下式给出的集体变量（CVs）中的二维自由能：$F(\\xi_1,\\xi_2)=\\xi_1^4-2\\xi_1^2+\\lambda \\,\\xi_2^2$，其中 $\\lambda>0$ 是一个常数，且CV空间中的黎曼度规是单位矩阵 $G=I$（欧几里得度规）。在集体变量中的弦方法框架内，最低自由能路径（MFEP）被定义为连接 $(\\xi_1,\\xi_2)$ 中两个对称相关的极小值点的连续曲线，使得在曲线上的每一点，热力学力 $-\\nabla F$ 垂直于曲线的分量为零。\n\n从第一性原理出发，完成以下任务：\n1) 确定 $F$ 的两个极小值点和连接它们的鞍点的位置。\n2) 仅使用对称性、可分离性和在CV空间中相对于正交方向的约束最小化等基本考虑，以及度规的欧几里得性质，解析地确定 MFEP。\n3) 沿着你的候选路径验证弦条件是否满足，即当 $G=I$ 时，在路径的每一点上，$\\nabla F$ 在路径法向子空间上的正交投影为零。\n\n将你的最终答案表示为关于 MFEP 的单一显式关系 $\\xi_2(\\xi_1)$。不需要数值近似，也不涉及单位。最终答案必须是单一的闭合形式解析表达式。", "solution": "首先将对问题的科学合理性、自洽性和清晰度进行验证。只有在成功验证后，才会尝试求解。\n\n### 问题验证\n\n步骤1：提取已知条件\n\n从问题陈述中逐字提取已知条件：\n-   一个集体变量 $(\\xi_1, \\xi_2)$ 中的二维自由能函数：$F(\\xi_1, \\xi_2) = \\xi_1^4 - 2\\xi_1^2 + \\lambda \\xi_2^2$。\n-   一个常数参数：$\\lambda > 0$。\n-   集体变量空间中的黎曼度规是单位矩阵 $G=I$，这对应于标准的欧几里得度规。\n-   最低自由能路径（MFEP）的定义：一条连接两个对称相关的极小值点的连续曲线，在该曲线上，热力学力 $-\\nabla F$ 垂直于曲线的分量为零。这等同于陈述梯度 $\\nabla F$ 在每一点上都与曲线的法向量正交。\n-   任务是：\n    1.  确定两个极小值点和连接它们的鞍点的位置。\n    2.  利用基本原理分析确定 MFEP。\n    3.  沿着确定的路径验证弦条件是否满足。\n-   最终答案要求的格式是单一的显式关系 $\\xi_2(\\xi_1)$。\n\n步骤2：使用提取的已知条件进行验证\n\n根据验证标准对问题进行评估。\n-   **有科学依据**：该问题在理论和计算化学领域有坚实的基础。集体变量中的弦方法是寻找转变（如化学反应或构象变化）的最低能量或自由能路径的标准且广泛使用的算法。自由能函数 $F(\\xi_1, \\xi_2)$ 是一个典型的一维双阱势与另一维谐振势的耦合，是研究此类转变的标准模型。这些概念完全是标准的，并且在数学上是合理的。\n-   **适定的**：问题是适定的。函数 $F(\\xi_1, \\xi_2)$ 是解析的。MFEP 的条件是精确的。要求找到连接两个特定极小值点的路径提供了清晰的边界条件。由于势的简单、对称性，预期会有一个唯一解。\n-   **客观的**：问题以精确、客观的数学语言陈述。它不包含任何主观或基于意见的陈述。\n-   **完整性和一致性**：问题是自洽的。所有必要信息（函数 $F$、度规 $G$、常数的符号 $\\lambda > 0$ 以及 MFEP 的定义）都已提供。没有内部矛盾。\n-   **其他缺陷**：问题并非微不足道，因为它需要系统地应用微积分和对弦方法基本物理原理的理解。它不过于隐喻，也不依赖任何伪科学。\n\n步骤3：结论与行动\n\n该问题被认定为**有效的**。这是一个理论化学中的标准、适定问题，可以得到严格的解析解。我现在将开始推导这个解。\n\n### 解答\n\n解答将根据问题陈述的要求分为三部分进行推导。\n\n1) 确定驻点\n\n自由能面 $F(\\xi_1, \\xi_2)$ 的驻点是梯度为零的点，即 $\\nabla F = \\vec{0}$。其梯度由下式给出：\n$$\n\\nabla F(\\xi_1, \\xi_2) = \\left( \\frac{\\partial F}{\\partial \\xi_1}, \\frac{\\partial F}{\\partial \\xi_2} \\right) = (4\\xi_1^3 - 4\\xi_1, 2\\lambda\\xi_2)\n$$\n令各分量为零，得到一个方程组：\n$$\n\\begin{cases}\n4\\xi_1^3 - 4\\xi_1 = 4\\xi_1(\\xi_1^2 - 1) = 0 \\\\\n2\\lambda\\xi_2 = 0\n\\end{cases}\n$$\n从第一个方程，我们得到 $\\xi_1 = 0$ 或 $\\xi_1 = \\pm 1$。从第二个方程，因为 $\\lambda > 0$，我们必须有 $\\xi_2 = 0$。\n因此，有三个驻点：$(-1, 0)$、$(1, 0)$ 和 $(0, 0)$。\n\n为了对这些点进行分类，我们计算二阶导数的黑塞矩阵 $H$：\n$$\nH(\\xi_1, \\xi_2) = \\begin{pmatrix} \\frac{\\partial^2 F}{\\partial \\xi_1^2} & \\frac{\\partial^2 F}{\\partial \\xi_1 \\partial \\xi_2} \\\\ \\frac{\\partial^2 F}{\\partial \\xi_2 \\partial \\xi_1} & \\frac{\\partial^2 F}{\\partial \\xi_2^2} \\end{pmatrix} = \\begin{pmatrix} 12\\xi_1^2 - 4 & 0 \\\\ 0 & 2\\lambda \\end{pmatrix}\n$$\n现在，我们在每个驻点上计算黑塞矩阵的值：\n-   在点 $(\\pm 1, 0)$：\n    $$\n    H(\\pm 1, 0) = \\begin{pmatrix} 12(1)^2 - 4 & 0 \\\\ 0 & 2\\lambda \\end{pmatrix} = \\begin{pmatrix} 8 & 0 \\\\ 0 & 2\\lambda \\end{pmatrix}\n    $$\n    特征值为 $8$ 和 $2\\lambda$。因为 $\\lambda > 0$，两个特征值都为正。黑塞矩阵是正定的，所以点 $(-1, 0)$ 和 $(1, 0)$ 是两个对称相关的局部极小值点。\n\n-   在点 $(0, 0)$：\n    $$\n    H(0, 0) = \\begin{pmatrix} 12(0)^2 - 4 & 0 \\\\ 0 & 2\\lambda \\end{pmatrix} = \\begin{pmatrix} -4 & 0 \\\\ 0 & 2\\lambda \\end{pmatrix}\n    $$\n    特征值为 $-4$ 和 $2\\lambda$。由于一个特征值为负，一个为正，所以该点是一个指数为1的鞍点。这个鞍点连接了两个极小值点。\n\n2) 确定 MFEP\n\nMFEP 是一条曲线 $\\vec{\\alpha}(t) = (\\xi_1(t), \\xi_2(t))$，在该曲线上，梯度 $\\nabla F$ 始终与切向量 $\\vec{\\tau}(t) = \\frac{d\\vec{\\alpha}}{dt}$ 平行。度规 $G=I$ 是欧几里得度规，因此正交性由标准点积定义。条件是梯度向量没有垂直于路径的分量。\n\n设该路径表示为函数 $\\xi_2 = f(\\xi_1)$。在任意点 $(\\xi_1, \\xi_2)$，该曲线的切向量与 $(1, f'(\\xi_1))$ 成比例，其中 $f'(\\xi_1) = \\frac{d\\xi_2}{d\\xi_1}$。因此，一个法向量与 $(-f'(\\xi_1), 1)$ 成比例。\n\n弦条件要求梯度和法向量的点积为零：\n$$\n\\nabla F \\cdot \\vec{n} = (4\\xi_1^3 - 4\\xi_1, 2\\lambda\\xi_2) \\cdot (-f'(\\xi_1), 1) = 0\n$$\n这给出了方程：\n$$\n-(4\\xi_1^3 - 4\\xi_1)f'(\\xi_1) + 2\\lambda\\xi_2 = 0\n$$\n将 $f'(\\xi_1) = \\frac{d\\xi_2}{d\\xi_1}$ 和 $\\xi_2 = f(\\xi_1)$ 代入，我们得到路径的常微分方程：\n$$\n(4\\xi_1^3 - 4\\xi_1) \\frac{d\\xi_2}{d\\xi_1} = 2\\lambda\\xi_2\n$$\n这个常微分方程必须在路径连接两个极小值点 $(-1, 0)$ 和 $(1, 0)$ 的条件下求解。\n\n一个直接而有效的方法是利用问题的对称性。自由能函数 $F(\\xi_1, \\xi_2) = \\xi_1^4 - 2\\xi_1^2 + \\lambda\\xi_2^2$ 是关于 $\\xi_2$ 的偶函数，意味着 $F(\\xi_1, \\xi_2) = F(\\xi_1, -\\xi_2)$。$\\xi_1$ 轴（其中 $\\xi_2=0$）是势能的对称轴。两个极小值点和鞍点都位于这条轴上。\n\n让我们检验这样一个假设：MFEP 是沿着这条对称轴的直线段，由 $\\xi_2(\\xi_1) = 0$ 给出，其中 $\\xi_1 \\in [-1, 1]$。\n如果我们将 $\\xi_2 = 0$ 代入微分方程，我们得到：\n$$\n(4\\xi_1^3 - 4\\xi_1) \\frac{d}{d\\xi_1}(0) = 2\\lambda (0) \\implies 0 = 0\n$$\n方程对于所有系数 $(4\\xi_1^3 - 4\\xi_1)$ 不为零的 $\\xi_1$（即远离驻点）都成立。路径 $\\xi_2=0$ 穿过点 $(-1, 0)$ 和 $(1, 0)$，因此满足边界条件。这是一个有效的解。由于势能的简单性，这是连接指定极小值点的唯一 MFEP。\n\n这一结论也得到了问题中提到的“约束最小化”原理的支持。对于所提议路径上的任何点 $(\\xi_1, 0)$，正交方向是 $\\xi_2$ 轴。对于固定的 $\\xi_1$，沿着此方向的自由能为 $F_{\\xi_1}(\\xi_2) = C + \\lambda \\xi_2^2$，其中 $C = \\xi_1^4-2\\xi_1^2$ 是常数。沿此方向的力为 $-\\frac{\\partial F}{\\partial \\xi_2} = -2\\lambda\\xi_2$。这个力在 $\\xi_2=0$ 处为零。此外，$\\frac{\\partial^2 F}{\\partial \\xi_2^2} = 2\\lambda > 0$，因此 $\\xi_2=0$ 代表了在与路径正交的超平面中的能量极小值。\n\n3) 弦条件的验证\n\n我们为候选路径 $\\xi_2(\\xi_1) = 0$ 显式地验证弦条件。\n该路径可以参数化为 $\\vec{\\alpha}(\\xi_1) = (\\xi_1, 0)$，其中 $\\xi_1 \\in [-1, 1]$。\n切线方向由向量 $\\vec{\\tau} = (1, 0)$ 给出。\n法线方向（因为 $G=I$）由向量 $\\vec{n} = (0, 1)$ 给出。\n自由能的梯度是 $\\nabla F = (4\\xi_1^3 - 4\\xi_1, 2\\lambda\\xi_2)$。\n我们在路径上的一个通用点 $(\\xi_1, 0)$ 处计算梯度：\n$$\n\\nabla F(\\xi_1, 0) = (4\\xi_1^3 - 4\\xi_1, 2\\lambda(0)) = (4\\xi_1^3 - 4\\xi_1, 0)\n$$\n弦条件要求梯度垂直于路径的分量为零。该分量由 $\\nabla F$ 在法向量 $\\vec{n}$ 上的投影给出。我们计算点积：\n$$\n\\nabla F(\\xi_1, 0) \\cdot \\vec{n} = (4\\xi_1^3 - 4\\xi_1, 0) \\cdot (0, 1) = (4\\xi_1^3 - 4\\xi_1)(0) + (0)(1) = 0\n$$\n由于该乘积对于路径上所有的 $\\xi_1$ 都为零，因此弦条件得到满足。在每一点上，梯度向量都纯粹是路径的切向向量。\n\n因此，连接极小值点 $(-1, 0)$ 和 $(1, 0)$ 的最低自由能路径是 $\\xi_1$ 轴上的直线段。其显式关系为 $\\xi_2(\\xi_1) = 0$。", "answer": "$$\n\\boxed{\\xi_2(\\xi_1) = 0}\n$$", "id": "2822338"}, {"introduction": "在实际应用中，集体变量（CVs）的不当选择可能会破坏弦方法理论上的优雅性。本练习是一个诊断此类问题的关键案例研究。通过分析一组看似合理但实则函数相关的集体变量，您将发现它们如何导致一个奇异且数值上病态的度规张量——这是导致算法失败的根源。[@problem_id:2822361] 这一实践将磨练您在为模拟选择一组稳健的集体变量这一关键任务上的批判性思维能力。", "problem": "一个三维欧几里得空间中的双粒子体系由无量纲的粒子间矢量 $\\mathbf{y} \\in \\mathbb{R}^{3}$ 及其模 $r = \\|\\mathbf{y}\\|$ 来描述。假设我们希望应用集体变量中的弦方法 (SMCV)，其中集体变量 (CVs) 是底层微观坐标的函数，而沿着弦的距离是使用由 $\\mathbf{y}$ 的欧几里得几何导出的度规来测量的。\n\n使用以下基本要素：\n- CV 映射为 $\\boldsymbol{\\theta}(\\mathbf{y}) = \\big(\\theta_{1}(\\mathbf{y}), \\theta_{2}(\\mathbf{y})\\big)$，其中 $\\theta_{1}(\\mathbf{y}) = r$ 且 $\\theta_{2}(\\mathbf{y}) = 1/r$。\n- CV 空间上的导出度规（欧几里得度规的回拉）由 $2 \\times 2$ 张量 $g_{ij}(\\mathbf{y}) = \\nabla_{\\mathbf{y}} \\theta_{i}(\\mathbf{y}) \\cdot \\nabla_{\\mathbf{y}} \\theta_{j}(\\mathbf{y})$ 定义，其中 $\\nabla_{\\mathbf{y}}$ 表示关于 $\\mathbf{y}$ 的梯度，$\\cdot$ 是欧几里得点积。\n\n任务：\n1. 将 $g_{ij}$ 显式地推导为 $r$ 的函数。\n2. 计算 $2 \\times 2$ 矩阵 $g(r)$ 的特征值，并描述其在 $r \\to 0^{+}$ 时的条件数特性，解释任何病态条件的来源。\n3. 提出一组性态更好的备选 CV，以避免已发现的数值问题，同时保持对 SMCV 的适用性，并根据梯度的结构证明你的选择是合理的。\n4. 作为最终答案，报告 $g(r)$ 的非零特征值 $\\lambda(r)$ 关于 $r$ 的精确解析表达式。\n\n将最终答案表示为解析表达式。无需四舍五入。根据构造，所有量都是无量纲的。", "solution": "问题陈述是连贯的、有科学依据且适定的。它展示了理论化学中的一个标准情景，用以说明为弦方法等方法选择合适的集体变量 (CV) 的至关重要性。我们将逐步进行求解。\n\n该体系由粒子间矢量 $\\mathbf{y} \\in \\mathbb{R}^{3}$ 及其模 $r = \\|\\mathbf{y}\\|$ 描述。集体变量由映射 $\\boldsymbol{\\theta}(\\mathbf{y}) = (\\theta_{1}(\\mathbf{y}), \\theta_{2}(\\mathbf{y}))$ 给出，其中 $\\theta_{1}(\\mathbf{y}) = r$ 且 $\\theta_{2}(\\mathbf{y}) = 1/r$。CV 空间上的导出度规由张量 $g_{ij}(\\mathbf{y}) = \\nabla_{\\mathbf{y}} \\theta_{i}(\\mathbf{y}) \\cdot \\nabla_{\\mathbf{y}} \\theta_{j}(\\mathbf{y})$ 给出。\n\n首先，我们必须计算 CV 关于微观坐标 $\\mathbf{y}$ 的梯度。\n第一个 CV 是 $\\theta_{1} = r = (\\mathbf{y} \\cdot \\mathbf{y})^{1/2}$。其梯度为：\n$$\n\\nabla_{\\mathbf{y}} \\theta_{1} = \\nabla_{\\mathbf{y}} r = \\frac{\\mathbf{y}}{\\|\\mathbf{y}\\|} = \\frac{\\mathbf{y}}{r}\n$$\n这是一个沿 $\\mathbf{y}$ 方向的单位矢量，我们可以记作 $\\hat{\\mathbf{y}}$。因此，$\\nabla_{\\mathbf{y}} \\theta_{1} = \\hat{\\mathbf{y}}$。\n\n第二个 CV 是 $\\theta_{2} = 1/r$。我们使用链式法则计算其梯度：\n$$\n\\nabla_{\\mathbf{y}} \\theta_{2} = \\frac{d(1/r)}{dr} \\nabla_{\\mathbf{y}} r = \\left(-\\frac{1}{r^{2}}\\right) \\hat{\\mathbf{y}}\n$$\n\n现在我们可以计算 $2 \\times 2$ 度规张量 $g(r)$ 的分量：\n$$\ng_{11} = (\\nabla_{\\mathbf{y}} \\theta_{1}) \\cdot (\\nabla_{\\mathbf{y}} \\theta_{1}) = \\hat{\\mathbf{y}} \\cdot \\hat{\\mathbf{y}} = 1\n$$\n$$\ng_{12} = g_{21} = (\\nabla_{\\mathbf{y}} \\theta_{1}) \\cdot (\\nabla_{\\mathbf{y}} \\theta_{2}) = \\hat{\\mathbf{y}} \\cdot \\left(-\\frac{1}{r^{2}} \\hat{\\mathbf{y}}\\right) = -\\frac{1}{r^{2}} (\\hat{\\mathbf{y}} \\cdot \\hat{\\mathbf{y}}) = -\\frac{1}{r^{2}}\n$$\n$$\ng_{22} = (\\nabla_{\\mathbf{y}} \\theta_{2}) \\cdot (\\nabla_{\\mathbf{y}} \\theta_{2}) = \\left(-\\frac{1}{r^{2}} \\hat{\\mathbf{y}}\\right) \\cdot \\left(-\\frac{1}{r^{2}} \\hat{\\mathbf{y}}\\right) = \\frac{1}{r^{4}} (\\hat{\\mathbf{y}} \\cdot \\hat{\\mathbf{y}}) = \\frac{1}{r^{4}}\n$$\n因此，作为 $r$ 的函数的度规张量为：\n$$\ng(r) = \\begin{pmatrix} 1 & -\\frac{1}{r^{2}} \\\\ -\\frac{1}{r^{2}} & \\frac{1}{r^{4}} \\end{pmatrix}\n$$\n\n接下来，我们通过求解特征方程 $\\det(g - \\lambda I) = 0$ 来计算 $g(r)$ 的特征值，其中 $I$ 是单位矩阵。\n$$\n\\det \\begin{pmatrix} 1 - \\lambda & -\\frac{1}{r^{2}} \\\\ -\\frac{1}{r^{2}} & \\frac{1}{r^{4}} - \\lambda \\end{pmatrix} = 0\n$$\n$$\n(1 - \\lambda)\\left(\\frac{1}{r^{4}} - \\lambda\\right) - \\left(-\\frac{1}{r^{2}}\\right)\\left(-\\frac{1}{r^{2}}\\right) = 0\n$$\n$$\n\\frac{1}{r^{4}} - \\lambda - \\frac{\\lambda}{r^{4}} + \\lambda^{2} - \\frac{1}{r^{4}} = 0\n$$\n$$\n\\lambda^{2} - \\lambda\\left(1 + \\frac{1}{r^{4}}\\right) = 0\n$$\n$$\n\\lambda \\left( \\lambda - \\left(1 + \\frac{1}{r^{4}}\\right) \\right) = 0\n$$\n特征值为 $\\lambda_{1} = 0$ 和 $\\lambda_{2} = 1 + \\frac{1}{r^{4}}$。\n\n度规张量的条件数特性通过其条件数 $\\kappa(g) = |\\lambda_{\\text{max}}| / |\\lambda_{\\text{min}}|$ 来分析。由于对于所有 $r > 0$，其中一个特征值是 $\\lambda_{\\text{min}} = 0$，因此矩阵 $g(r)$ 是奇异的，其条件数形式上是无穷大。这就是病态系统的定义。这种奇异性的根源在于 CV 之间的函数依赖关系：$\\theta_{2} = 1/\\theta_{1}$。这意味着这两个 CV 并不张成一个二维空间，而是被限制在一条一维曲线上。因此，它们的梯度是线性相关的（实际上是共线的）：$\\nabla_{\\mathbf{y}} \\theta_{2} = -(1/r^{2}) \\nabla_{\\mathbf{y}} \\theta_{1}$。这种冗余导致了秩亏的度规张量。\n\n当 $r \\to 0^{+}$ 时，非零特征值 $\\lambda_{2}(r) = 1 + 1/r^{4}$ 发散到无穷大。这种行为表明存在严重的病态问题。这种发散源于 $\\theta_{2}$ 的梯度，其模 $\\|\\nabla_{\\mathbf{y}} \\theta_{2}\\| = 1/r^{2}$ 在 $r$ 趋近于零时会爆炸性增长。这意味着在原点附近微观坐标 $\\mathbf{y}$ 的一个无穷小位移对应于 CV 空间中一个爆炸性的大距离，这使得弦方法中的弧长参数化等数值计算变得不稳定或不可能。\n\n为了提出一组性态更好的 CV，我们必须解决两个已发现的缺陷：函数依赖性（共线梯度）和发散的梯度模。一组性态良好的 CV 应具有线性无关（理想情况下是正交）的梯度，并且其模在感兴趣的区域内不发散。\n\n一个简单而鲁棒的选择是使用 $\\mathbf{y}$ 本身的笛卡尔分量的一个子集。例如，令新的 CV 为：\n$$\n\\theta'_{1}(\\mathbf{y}) = y_{1}, \\quad \\theta'_{2}(\\mathbf{y}) = y_{2}\n$$\n这些 CV 的梯度是常标准基矢量：\n$$\n\\nabla_{\\mathbf{y}} \\theta'_{1} = \\hat{\\mathbf{e}}_{1} = (1, 0, 0)\n$$\n$$\n\\nabla_{\\mathbf{y}} \\theta'_{2} = \\hat{\\mathbf{e}}_{2} = (0, 1, 0)\n$$\n这些梯度是正交的（$\\hat{\\mathbf{e}}_{1} \\cdot \\hat{\\mathbf{e}}_{2} = 0$）并且具有恒定的单位模。由此产生的度规张量是单位矩阵：\n$$\ng' = \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix}\n$$\n该度规是完美条件的，其两个特征值均等于 $1$，条件数处处为 $1$。它没有奇异点，也不会引入数值不稳定性。唯一的理论上的妥协是丧失了旋转不变性，因为 CV 现在依赖于坐标系的方向。在许多物理问题中，为了数值稳定性，这是一个可接受的权衡。如果旋转不变性至关重要，则必须认识到，对于一个孤立的双粒子体系，只能定义一个这样的独立 CV（例如 $r$），而试图强加第二个 CV 会产生我们刚刚分析过的确切问题。\n\n最后，问题要求给出原始度规 $g(r)$ 的非零特征值 $\\lambda(r)$ 的解析表达式。正如所推导的，这就是 $\\lambda_{2}$。", "answer": "$$\\boxed{1 + \\frac{1}{r^{4}}}$$", "id": "2822361"}]}