{"hands_on_practices": [{"introduction": "为了建立对动力学蒙特卡洛（KMC）模拟的信心，理解其与底层解析理论之间的联系至关重要。本练习将挑战你从主方程出发，为简单的两态系统推导时间自相关函数。通过这个过程，你将看到在KMC模拟中测量的宏观可观测量是如何从基本跃迁速率中产生的 [@problem_id:2782393]。", "problem": "催化表面的单个吸附位点可通过一个双态连续时间马尔可夫链来建模，该链是动力学蒙特卡洛（KMC）轨迹的基础。状态 $\\mathsf{1}$ 表示该位点被占据，状态 $\\mathsf{2}$ 表示该位点为空。$\\mathsf{1} \\to \\mathsf{2}$ 的跃迁速率为 $k_{12}$，$\\mathsf{2} \\to \\mathsf{1}$ 的跃迁速率为 $k_{21}$，且 $k_{12} > 0$，$k_{21} > 0$。系统在制备后于其稳态下进行观测。定义状态指示函数 $I(t)$：若系统在时间 $t$ 处于状态 $\\mathsf{1}$，则 $I(t) = 1$；若处于状态 $\\mathsf{2}$，则 $I(t) = 0$。令 $\\langle \\cdot \\rangle$ 表示稳态系综平均，并定义零均值涨落 $\\delta I(t) \\equiv I(t) - \\langle I \\rangle$。\n\n仅从该双态过程的连续时间主方程和稳态连续时间马尔可夫链的标准性质出发，推导稳态时间自相关函数\n$$\nC_I(t) \\equiv \\langle \\delta I(0)\\,\\delta I(t)\\rangle\n$$\n对于 $t \\ge 0$，将其表示为含 $k_{12}$、$k_{21}$ 和 $t$ 的闭式表达式。你的推导应从基本原理出发，通过求解必要的条件概率或条件期望来进行，而不是直接套用已知的相关函数公式。然后，通过分析该过程的生成元或你所推导的表达式，找出 $C_I(t)$ 的指数衰减常数，并用 $k_{12}$ 和 $k_{21}$ 表示。\n\n请给出 $C_I(t)$ 的最终结果，该结果应为仅含 $k_{12}$、$k_{21}$ 和 $t$ 的单个解析表达式。无需进行数值计算。最终答案无需单位。", "solution": "所述问题具有科学依据，论述严谨，客观且内部一致。这是一个随机过程理论应用于理论化学领域的标准问题。所有必要信息均已提供，不存在任何矛盾。该问题是有效的，将提供解答。\n\n该系统是一个双态连续时间马尔可夫链，具有状态 $\\mathsf{1}$（占据）和状态 $\\mathsf{2}$（空）。从 $\\mathsf{1} \\to \\mathsf{2}$ 的跃迁速率为 $k_{12}$，从 $\\mathsf{2} \\to \\mathsf{1}$ 的跃迁速率为 $k_{21}$。令 $P_1(t)$ 和 $P_2(t)$ 分别为系统在时间 $t$ 处于状态 $\\mathsf{1}$ 和状态 $\\mathsf{2}$ 的概率。这些概率的演化由连续时间主方程决定：\n$$\n\\frac{d}{dt} \\begin{pmatrix} P_1(t) \\\\ P_2(t) \\end{pmatrix} = \\begin{pmatrix} -k_{12}  k_{21} \\\\ k_{12}  -k_{21} \\end{pmatrix} \\begin{pmatrix} P_1(t) \\\\ P_2(t) \\end{pmatrix}\n$$\n问题要求计算 $t \\ge 0$ 时的稳态时间自相关函数 $C_I(t) = \\langle \\delta I(0)\\,\\delta I(t)\\rangle$。状态指示函数为：对于状态 $\\mathsf{1}$，$I(t)=1$；对于状态 $\\mathsf{2}$，$I(t)=0$。涨落为 $\\delta I(t) = I(t) - \\langle I \\rangle$。\n\n首先，展开 $C_I(t)$ 的定义：\n$$\nC_I(t) = \\langle (I(0) - \\langle I \\rangle)(I(t) - \\langle I \\rangle) \\rangle = \\langle I(0)I(t) \\rangle - \\langle I(0)\\rangle\\langle I(t)\\rangle - \\langle I(t)\\rangle\\langle I(0)\\rangle + \\langle I\\rangle^2\n$$\n由于系统处于稳态，系综平均值不随时间变化：$\\langle I(t) \\rangle = \\langle I(0) \\rangle = \\langle I \\rangle$。表达式简化为：\n$$\nC_I(t) = \\langle I(0)I(t) \\rangle - \\langle I \\rangle^2\n$$\n我们的推导分三步进行：\n$1$. 计算稳态平均值 $\\langle I \\rangle$。\n$2$. 计算双时相关函数 $\\langle I(0)I(t) \\rangle$。\n$3$. 结合结果求出 $C_I(t)$。\n\n_第 1 步：稳态平均值 $\\langle I \\rangle$_\n\n在稳态下，概率是恒定的，因此 $\\frac{dP_1}{dt} = \\frac{dP_2}{dt} = 0$。令稳态概率为 $P_1^{ss}$ 和 $P_2^{ss}$。主方程给出细致平衡条件：\n$$\nk_{12} P_1^{ss} = k_{21} P_2^{ss}\n$$\n结合归一化条件 $P_1^{ss} + P_2^{ss} = 1$，我们可以解出稳态概率。代入 $P_2^{ss} = 1 - P_1^{ss}$：\n$$\nk_{12} P_1^{ss} = k_{21} (1 - P_1^{ss}) \\implies (k_{12} + k_{21}) P_1^{ss} = k_{21} \\implies P_1^{ss} = \\frac{k_{21}}{k_{12} + k_{21}}\n$$\n因此，$P_2^{ss} = 1 - P_1^{ss} = \\frac{k_{12}}{k_{12} + k_{21}}$。\n\n状态指示函数 $I(t)$ 的平均值由期望给出：\n$$\n\\langle I \\rangle = (1) \\cdot P_1^{ss} + (0) \\cdot P_2^{ss} = P_1^{ss} = \\frac{k_{21}}{k_{12} + k_{21}}\n$$\n\n_第 2 步：双时相关函数 $\\langle I(0)I(t) \\rangle$_\n\n双时相关函数通过对所有可能的初态和末态求平均来计算：\n$$\n\\langle I(0)I(t) \\rangle = \\sum_{i,j \\in \\{1,2\\}} I_i I_j P(X(0)=j, X(t)=i)\n$$\n其中 $X(t)$ 是系统在时间 $t$ 的状态，$I_j$ 是状态 $j$ 下指示函数的值。由于 $I_2=0$，求和中唯一的非零项是 $i=1, j=1$：\n$$\n\\langle I(0)I(t) \\rangle = I_1 \\cdot I_1 \\cdot P(X(0)=1, X(t)=1) = P(X(0)=1, X(t)=1)\n$$\n根据条件概率的定义以及系统处于稳态的事实：\n$$\nP(X(0)=1, X(t)=1) = P(X(t)=1 | X(0)=1) \\cdot P(X(0)=1) = P_{11}(t) \\cdot P_1^{ss}\n$$\n此处，$P_{11}(t) \\equiv P(X(t)=1 | X(0)=1)$ 是指在 $t=0$ 时系统处于状态 $\\mathsf{1}$ 的条件下，在时间 $t$ 处于状态 $\\mathsf{1}$ 的条件概率。为了求得 $P_{11}(t)$，我们在初始条件 $P_1(0)=1$ 和 $P_2(0)=0$ 下求解主方程。\n$P_1(t)$ 的方程为 $\\frac{dP_1}{dt} = k_{21} P_2 - k_{12} P_1$。利用 $P_1(t)+P_2(t)=1$ 可得 $P_2(t)=1-P_1(t)$。将其代入，得到关于 $P_1(t) \\equiv P_{11}(t)$ 的一阶线性常微分方程：\n$$\n\\frac{dP_1}{dt} = k_{21} (1 - P_1) - k_{12} P_1 = k_{21} - (k_{12} + k_{21}) P_1\n$$\n令 $\\lambda = k_{12} + k_{21}$。方程为 $\\frac{dP_1}{dt} + \\lambda P_1 = k_{21}$。通解是齐次解 $A\\exp(-\\lambda t)$ 和一个特解之和。一个特解是稳态值 $P_1^{ss} = k_{21}/\\lambda$。因此：\n$$\nP_1(t) = A\\exp(-\\lambda t) + \\frac{k_{21}}{\\lambda}\n$$\n应用初始条件 $P_1(0)=1$：\n$$\n1 = A\\exp(0) + \\frac{k_{21}}{\\lambda} \\implies A = 1 - \\frac{k_{21}}{\\lambda} = \\frac{\\lambda - k_{21}}{\\lambda} = \\frac{k_{12}}{\\lambda}\n$$\n所以，条件概率为：\n$$\nP_{11}(t) = \\frac{k_{12}}{k_{12} + k_{21}} \\exp(-(k_{12} + k_{21})t) + \\frac{k_{21}}{k_{12} + k_{21}}\n$$\n现在我们可以计算 $\\langle I(0)I(t) \\rangle = P_{11}(t) \\cdot P_1^{ss}$：\n$$\n\\langle I(0)I(t) \\rangle = \\left( \\frac{k_{12}}{k_{12} + k_{21}} \\exp(-(k_{12} + k_{21})t) + \\frac{k_{21}}{k_{12} + k_{21}} \\right) \\left( \\frac{k_{21}}{k_{12} + k_{21}} \\right)\n$$\n\n_第 3 步：最终组合 $C_I(t)$_\n\n现在我们从 $\\langle I(0)I(t) \\rangle$ 的表达式中减去 $\\langle I \\rangle^2 = (P_1^{ss})^2$：\n$$\nC_I(t) = \\left( \\frac{k_{12}}{k_{12} + k_{21}} \\exp(-(k_{12} + k_{21})t) + P_1^{ss} \\right) P_1^{ss} - (P_1^{ss})^2\n$$\n$$\nC_I(t) = \\frac{k_{12}}{k_{12} + k_{21}} \\exp(-(k_{12} + k_{21})t) \\cdot P_1^{ss} + (P_1^{ss})^2 - (P_1^{ss})^2\n$$\n代入 $P_1^{ss} = \\frac{k_{21}}{k_{12} + k_{21}}$：\n$$\nC_I(t) = \\frac{k_{12}}{k_{12} + k_{21}} \\left( \\frac{k_{21}}{k_{12} + k_{21}} \\right) \\exp(-(k_{12} + k_{21})t)\n$$\n这简化为自相关函数的最终表达式：\n$$\nC_I(t) = \\frac{k_{12}k_{21}}{(k_{12} + k_{21})^2} \\exp(-(k_{12} + k_{21})t)\n$$\n该表达式对 $t \\ge 0$ 有效。指数前因子为 $C_I(0) = \\frac{k_{12}k_{21}}{(k_{12}+k_{21})^2} = P_1^{ss} P_2^{ss}$，这正如预期的，是伯努利随机变量 $I$ 的方差。\n\n最后，我们确定指数衰减常数。该函数的形式为 $A\\exp(-\\gamma t)$，其中 $\\gamma$ 是衰减常数。通过直接观察推导出的表达式，指数衰减常数是正向和反向速率之和：\n$$\n\\gamma = k_{12} + k_{21}\n$$\n该速率是马尔可夫过程的转移速率矩阵（生成元）的非零特征值的绝对值，它决定了系统弛豫到其稳态的速率。", "answer": "$$\n\\boxed{\\frac{k_{12}k_{21}}{(k_{12} + k_{21})^2} \\exp(-(k_{12} + k_{21})t)}\n$$", "id": "2782393"}, {"introduction": "一个用于模拟热平衡系统的正确KMC实现必须满足细致平衡条件，但我们如何从有限的模拟数据中验证这一点呢？本练习让你扮演一位严谨的研究者，测试一个KMC代码。你将评估不同的统计方案，以确定观察到的动力学是否与预期的理论速率比一致，这是模拟验证中的关键一步 [@problem_id:2782332]。", "problem": "使用双态动力学蒙特卡洛 (KMC) 模拟来为一个系统建模，该系统具有状态 $A$ 和 $B$，其能量分别为 $E_A$ 和 $E_B = E_A + \\Delta E$。温度是固定的，使得 $\\beta \\Delta E = 2.0$，其中 $\\beta = 1/(k_B T)$，$k_B$ 是玻尔兹曼常数。该 KMC 实现应满足相对于正则 (玻尔兹曼) 平衡分布的细致平衡条件。在舍弃一段平衡期后，记录了一条单一的长生产轨迹。在生产运行期间，测得每个状态的总驻留时间为 $\\tau_A = 8810$ 和 $\\tau_B = 1190$，观察到的跃迁次数为 $n_{A\\to B} = 1220$ 和 $n_{B\\to A} = 1165$。假设该轨迹是平稳的，并且，以实现的驻留时间为条件，每个状态的跃迁计数源于强度等于相应跃迁速率的独立泊松过程。\n\n要求您在 $\\alpha = 0.05$ 的显著性水平上，通过检验经验速率比是否与 $\\exp(-\\beta \\Delta E)$ 在统计上一致，来验证该实现是否满足细致平衡。对于此目的，以下哪种检验方案在统计上是合理的，并且能根据给定数据得出正确结论？\n\nA. 通过 $k_{A\\to B} = n_{A\\to B}/\\tau_A$ 和 $k_{B\\to A} = n_{B\\to A}/\\tau_B$ 估计 $k_{A\\to B}$ 和 $k_{B\\to A}$。使用条件二项式表述来检验原假设 $H_0:\\ \\rho = k_{A\\to B}/k_{B\\to A} = \\rho_0 \\equiv \\exp(-\\beta \\Delta E)$：给定 $n = n_{A\\to B} + n_{B\\to A}$，$X = n_{A\\to B} \\sim \\mathrm{Binomial}(n, p_0)$，其中 $p_0 = (\\rho_0 \\tau_A)/(\\rho_0 \\tau_A + \\tau_B)$。在 $\\alpha = 0.05$ 水平上使用双边检验（或等价地，通过映射 $\\rho = (p\\, \\tau_B)/((1-p)\\, \\tau_A)$ 反转得到 $\\rho$ 的 $95\\%$ 置信区间）。结论是，对于给定的数据，$H_0$ 不被拒绝。\n\nB. 将原始计数比 $n_{A\\to B}/n_{B\\to A}$ 直接与 $\\exp(-\\beta \\Delta E)$ 比较。由于 $1220/1165 \\gg \\exp(-2)$，在 $\\alpha = 0.05$ 水平上拒绝细致平衡。\n\nC. 仅通过检查占据比 $\\tau_B/\\tau_A$ 是否与 $\\exp(-\\beta \\Delta E)$ 匹配来验证细致平衡。由于 $1190/8810 \\approx \\exp(-2)$，在不分析跃迁计数的情况下，接受细致平衡成立。\n\nD. 构建对数速率比估计量 $\\widehat{\\ell} = \\ln(n_{A\\to B}) - \\ln(\\tau_A) - \\ln(n_{B\\to A}) + \\ln(\\tau_B)$，并将其抽样分布近似为方差为 $\\operatorname{Var}(\\widehat{\\ell}) \\approx 1/n_{A\\to B} + 1/n_{B\\to A}$ 的正态分布（将驻留时间视为固定值）。为 $\\ell = \\ln \\rho$ 构建一个双边 $95\\%$ 置信区间，并检查 $-\\beta \\Delta E$ 是否位于其中。结论是，对于给定的数据，$H_0$ 不被拒绝。\n\n选择所有适用的选项。", "solution": "对问题陈述进行验证。\n\n### 步骤 1：提取给定信息\n- 系统状态：$A$ 和 $B$。\n- 状态能量：$E_A$，$E_B = E_A + \\Delta E$。\n- 热能参数：$\\beta \\Delta E = 2.0$，其中 $\\beta = 1/(k_B T)$。\n- KMC 实现的必要属性：满足相对于正则分布的细致平衡。\n- 来自单一、长、平稳的生产轨迹的模拟数据：\n  - 状态 $A$ 的总驻留时间：$\\tau_A = 8810$。\n  - 状态 $B$ 的总驻留时间：$\\tau_B = 1190$。\n  - 从 $A$ 到 $B$ 的跃迁次数：$n_{A\\to B} = 1220$。\n  - 从 $B$ 到 $A$ 的跃迁次数：$n_{B\\to A} = 1165$。\n- 统计假设：\n  - 轨迹是平稳的。\n  - 以 $\\tau_A$ 和 $\\tau_B$ 为条件，$n_{A\\to B}$ 和 $n_{B\\to A}$ 源于独立的泊松过程。\n- 任务：在 $\\alpha = 0.05$ 的显著性水平上，通过统计检验经验速率比是否与 $\\exp(-\\beta \\Delta E)$ 一致来验证细致平衡。\n\n### 步骤 2：使用提取的给定信息进行验证\n该问题具有科学依据。它提出了计算统计力学中的一个标准情景，涉及一个双态系统的动力学蒙特卡洛 (KMC) 模拟。细致平衡、玻尔兹曼分布以及将跃迁事件建模为泊松过程等概念都是基础性的，并且应用正确。微观可逆性的细致平衡条件规定，在平衡状态下，任意两个状态 $i$ 和 $j$ 之间的通量在两个方向上必须相等：$p_i^{eq} k_{i\\to j} = p_j^{eq} k_{j\\to i}$，其中 $p_i^{eq}$ 是平衡概率，$k_{i\\to j}$ 是跃迁速率。对于正则系综，$p_i^{eq} \\propto \\exp(-\\beta E_i)$。这导致了速率比条件 $k_{A\\to B}/k_{B\\to A} = p_B^{eq}/p_A^{eq} = \\exp(-\\beta(E_B-E_A)) = \\exp(-\\beta \\Delta E)$。问题在于使用模拟数据来检验这一理论关系。\n\n该问题是适定的。它提供了足够的数据和明确的统计假设来进行假设检验。语言精确客观。没有矛盾，没有信息缺失，也没有依赖伪科学。数据值在物理上是合理的。该问题是统计推断在模拟数据上的一个非平凡应用，这是该领域的常见任务。\n\n### 步骤 3：判定与行动\n问题陈述有效。将推导解答。\n\n### 推导与选项分析\n待检验的原假设是 $H_0: \\rho = \\rho_0$，其中 $\\rho = k_{A\\to B}/k_{B\\to A}$ 是潜在跃迁速率的真实比率，而 $\\rho_0 = \\exp(-\\beta \\Delta E) = \\exp(-2.0)$ 是细致平衡所要求的理论比率。给定数据为 $\\tau_A = 8810$，$\\tau_B = 1190$，$n_{A\\to B} = 1220$ 和 $n_{B\\to A} = 1165$。显著性水平为 $\\alpha = 0.05$。\n\n跃迁计数来自独立泊松过程的假设意味着 $n_{A\\to B} \\sim \\mathrm{Poisson}(k_{A\\to B}\\tau_A)$ 并且 $n_{B\\to A} \\sim \\mathrm{Poisson}(k_{B\\to A}\\tau_B)$。\n\n**选项 A 评估**\n\n该选项提出了一个条件二项检验。给定两个独立的泊松变量，$X_1 \\sim \\mathrm{Poisson}(\\lambda_1)$ 和 $X_2 \\sim \\mathrm{Poisson}(\\lambda_2)$，在它们的和 $N = X_1+X_2$ 的条件下，$X_1$ 的分布是二项分布：$X_1 | (X_1+X_2=N) \\sim \\mathrm{Binomial}(N, p)$，其中 $p = \\lambda_1/(\\lambda_1+\\lambda_2)$。在我们的例子中，$X_1 = n_{A\\to B}$ 并且 $X_2 = n_{B\\to A}$。强度为 $\\lambda_1 = k_{A\\to B}\\tau_A$ 和 $\\lambda_2 = k_{B\\to A}\\tau_B$。概率参数 $p$ 可以用速率比 $\\rho$ 来表示：\n$$p = \\frac{k_{A\\to B}\\tau_A}{k_{A\\to B}\\tau_A + k_{B\\to A}\\tau_B} = \\frac{\\rho \\tau_A}{\\rho \\tau_A + \\tau_B}$$\n在原假设 $H_0: \\rho = \\rho_0$ 下，这个概率变为 $p_0 = (\\rho_0 \\tau_A)/(\\rho_0 \\tau_A + \\tau_B)$。我们检验观察到的计数 $n_{A\\to B}$ 是否是来自 $\\mathrm{Binomial}(n, p_0)$ 分布的一个合理结果，其中 $n = n_{A\\to B} + n_{B\\to A}$。\n\n这是一个统计上精确且合理的方法，它正确地使用条件分布来消除滋扰参数（即单个速率）。\n让我们执行检验。\n- $\\rho_0 = \\exp(-2.0) \\approx 0.135335$。\n- 总跃迁次数 $n = 1220 + 1165 = 2385$。\n- 原假设概率 $p_0 = \\frac{0.135335 \\cdot 8810}{0.135335 \\cdot 8810 + 1190} = \\frac{1192.3}{1192.3 + 1190} \\approx 0.50047$。\n- 我们检验 $n_{A\\to B} = 1220$ 是否与从 $\\mathrm{Binomial}(2385, 0.50047)$ 分布中抽样一致。\n- 使用二项分布的正态近似（对大的 $n$ 有效）：\n  - 均值：$\\mu = n p_0 = 2385 \\cdot 0.50047 \\approx 1193.62$。\n  - 标准差：$\\sigma = \\sqrt{n p_0 (1-p_0)} = \\sqrt{2385 \\cdot 0.50047 \\cdot 0.49953} \\approx \\sqrt{596.25} \\approx 24.42$。\n- 检验统计量为 $Z = (n_{A\\to B} - \\mu) / \\sigma = (1220 - 1193.62) / 24.42 \\approx 1.08$。\n- 在 $\\alpha = 0.05$ 水平上的双边检验的临界值为 $Z_{crit} \\approx 1.96$。由于 $|Z| = 1.08  1.96$，我们不拒绝原假设 $H_0$。选项中陈述的结论是正确的。该方案在统计上是合理的。\n\n对 A 的判定：**正确**。\n\n**选项 B 评估**\n\n该选项将跃迁的原始计数比 $n_{A\\to B}/n_{B\\to A}$ 与 $\\exp(-\\beta \\Delta E)$ 进行比较。这在根本上是错误的。计数比是泊松强度比的估计量，而不是速率比的估计量：\n$$ E\\left[\\frac{n_{A\\to B}}{n_{B\\to A}}\\right] \\approx \\frac{E[n_{A\\to B}]}{E[n_{B\\to A}]} = \\frac{k_{A\\to B}\\tau_A}{k_{B\\to A}\\tau_B} = \\rho \\frac{\\tau_A}{\\tau_B} $$\n为了估计速率比 $\\rho$，必须考虑驻留时间。$\\rho$ 的正确估计量是 $\\widehat{\\rho} = (n_{A\\to B}/\\tau_A) / (n_{B\\to A}/\\tau_B)$。将 $n_{A\\to B}/n_{B\\to A}$ 直接与 $\\rho_0$ 比较是一个严重的方法论错误。\n从数值上看，$n_{A\\to B}/n_{B\\to A} = 1220/1165 \\approx 1.047$，而 $\\rho_0 = \\exp(-2.0) \\approx 0.135$。即使细致平衡成立，所提出的程序也是在比较两个不应相等的量。\n\n对 B 的判定：**不正确**。\n\n**选项 C 评估**\n\n该选项建议仅通过检查驻留时间比 $\\tau_B/\\tau_A$ 是否与平衡概率比 $p_B^{eq}/p_A^{eq} = \\exp(-\\beta \\Delta E)$ 一致来验证细致平衡。\n在平稳马尔可夫过程的长时间极限下，驻留时间比估计了稳态概率比：$\\tau_B/\\tau_A \\approx \\pi_B/\\pi_A$。对于一个双态系统，稳态分布满足 $\\pi_A k_{A\\to B} = \\pi_B k_{B\\to A}$，这意味着 $\\pi_B/\\pi_A = k_{A\\to B}/k_{B\\to A}$。如果细致平衡成立，那么 $k_{A\\to B}/k_{B\\to A} = p_B^{eq}/p_A^{eq}$，因此 $\\pi_B/\\pi_A = p_B^{eq}/p_A^{eq}$。所以在这个简单的双态案例中，检查布居数等同于检查速率。\n从数值上看，$\\tau_B/\\tau_A = 1190/8810 \\approx 0.13507$，这确实非常接近 $\\exp(-2.0) \\approx 0.13534$。\n然而，该方案被描述为“*仅*检查占据比...是否匹配...*而不分析跃迁计数*”。这在方法论上是有缺陷的。问题明确提供了跃迁计数数据，并要求检验潜在*速率*的比率。忽略关于跃迁的直接数据（计数），而偏好一个积分量（驻留时间），构成了一个不完整且不够直接的检验。对一个基于速率的模型的恰当验证必须仔细审查跃迁本身的统计数据。该方案未能使用所有相关信息，并且没有按要求直接计算经验速率比。\n\n对 C 的判定：**不正确**。\n\n**选项 D 评估**\n\n该选项提出了一种基于速率比估计量的对数的检验，$\\widehat{\\ell} = \\ln(\\widehat{\\rho})$，其中 $\\widehat{\\rho} = \\frac{n_{A\\to B}/\\tau_A}{n_{B\\to A}/\\tau_B}$。因此，$\\widehat{\\ell} = \\ln(n_{A\\to B}) - \\ln(\\tau_A) - \\ln(n_{B\\to A}) + \\ln(\\tau_B)$。这是正确的。\n该方法使用德尔塔方法来近似方差，将驻留时间视为固定值（作为条件）。函数 $f(X_1, X_2)$ 的方差约等于 $\\sum (\\partial f / \\partial X_i)^2 \\operatorname{Var}(X_i)$。这里，随机变量是 $n_{A\\to B}$ 和 $n_{B\\to A}$，它们服从泊松分布。对于大的 $n$，我们可以近似 $\\operatorname{Var}(n) \\approx n$。\n对于 $\\widehat{\\ell}$，偏导数为 $\\partial\\widehat{\\ell}/\\partial n_{A\\to B} = 1/n_{A\\to B}$ 和 $\\partial\\widehat{\\ell}/\\partial n_{B\\to A} = -1/n_{B\\to A}$。\n那么方差为 $\\operatorname{Var}(\\widehat{\\ell}) \\approx (1/n_{A\\to B})^2 \\operatorname{Var}(n_{A\\to B}) + (-1/n_{B\\to A})^2 \\operatorname{Var}(n_{B\\to A}) \\approx (1/n_{A\\to B})^2 n_{A\\to B} + (1/n_{B\\to A})^2 n_{B\\to A} = 1/n_{A\\to B} + 1/n_{B\\to A}$。在所述近似下，这个方差公式是正确的。对于大的计数值，$\\widehat{\\ell}$ 的分布可以很好地用正态分布来近似。整个方案是一个标准的、统计上合理的大样本方法。\n让我们执行检验。\n- 对数比的估计值为 $\\widehat{\\ell} = \\ln\\left( \\frac{1220/8810}{1165/1190} \\right) \\approx \\ln\\left( \\frac{0.13848}{0.97899} \\right) \\approx \\ln(0.14145) \\approx -1.9558$。\n- 原假设值为 $\\ell_0 = \\ln(\\rho_0) = -2.0$。\n- 估计的标准误为 $SE(\\widehat{\\ell}) = \\sqrt{1/1220 + 1/1165} \\approx \\sqrt{0.0008197 + 0.0008584} = \\sqrt{0.0016781} \\approx 0.04096$。\n- $\\ell$ 的一个 $95\\%$ 置信区间为 $\\widehat{\\ell} \\pm 1.96 \\cdot SE(\\widehat{\\ell}) = -1.9558 \\pm 1.96 \\cdot 0.04096 = -1.9558 \\pm 0.0803$。\n- 该区间为 $[-2.0361, -1.8755]$。\n- 原假设值 $\\ell_0 = -2.0$ 位于此置信区间内。因此，我们不拒绝 $H_0$。结论是正确的。该方案在统计上是合理的。\n\n对 D 的判定：**正确**。", "answer": "$$\\boxed{AD}$$", "id": "2782332"}, {"introduction": "除了验证之外，许多KMC模拟的最终目标是计算物理量，例如有效反应速率。最后一个练习聚焦于数据分析这一关键任务，引导你完成从一系列模拟的首次穿越时间中估计速率常数的过程。你将应用最大似然原理，并探索估计器偏差和方差等重要的统计概念，以确保你的科学结论是稳健的 [@problem_id:2782405]。", "problem": "一个化学吸附物种在催化表面的亚稳态盆 $\\mathcal{A}$ 中探索，并最终到达产物盆 $\\mathcal{B}$。您对底层的连续时间马尔可夫链 (CTMC) 动力学进行动力学蒙特卡洛 (KMC) 模拟，从 $\\mathcal{A}$ 内的准稳态系综中启动独立的轨迹，并在每个轨迹首次到达 $\\mathcal{B}$ 时将其停止。在准稳态假设下，从 $\\mathcal{A}$ 的逃逸是一个朝向 $\\mathcal{B}$ 的、具有恒定风险率（无记忆性）的更新过程；因此，从 $\\mathcal{A}$ 到 $\\mathcal{B}$ 的首次穿越时间服从指数分布，其速率常数 $k \\equiv k_{\\mathcal{A}\\to\\mathcal{B}}$ 未知。\n\n您收集了 $n$ 个独立同分布的首次穿越时间 $\\{T_{i}\\}_{i=1}^{n}$，其中 $T_{i} \\sim \\text{Exponential}(k)$，并且您希望利用“恒定风险率意味着速率是平均首次穿越时间 (MFPT) 的倒数”这一定义来估计 $k$。假设 $n \\ge 3$。\n\n任务：\n1. 从 $n$ 样本 $\\{T_{i}\\}$ 在指数定律下的似然出发，且不引入任何额外的建模假设，推导 $k$ 的最大似然估计量 $\\hat{k}$，并用样本均值 $\\bar{T} \\equiv \\frac{1}{n}\\sum_{i=1}^{n} T_{i}$ 表示。\n2. 仅使用样本的独立性和所述的更新/无记忆性属性，精确计算 $\\mathbb{E}[\\hat{k}]$，识别其偏差，并构造一个无偏估计量 $\\tilde{k}$ 作为 $\\hat{k}$ 的线性重缩放。\n3. 推导 $\\mathrm{Var}(\\tilde{k})$ 的精确闭式方差，用 $n$ 和真实值 $k$ 表示。\n\n答案规格：\n- 仅用 $n$ 和 $k$ 给出 $\\mathrm{Var}(\\tilde{k})$ 的精确解析表达式作为最终答案。\n- 无需数值取整。", "solution": "我们从连续时间马尔可夫链 (CTMC) 的基本性质出发：在恒定风险率下的指数等待时间（无记忆性），以及重复、独立初始化的轨迹之间的独立性。在盆 $\\mathcal{A}$ 中的准稳态假设下，到 $\\mathcal{B}$ 的首次穿越时间服从指数分布，其未知速率为 $k0$。因此，$n$ 个观测到的首次穿越时间是独立同分布 (i.i.d.) 的，满足 $T_{i} \\sim \\text{Exponential}(k)$，因此作为 $k$ 的函数的联合似然是\n$$\nL(k; T_{1},\\dots,T_{n}) \\;=\\; \\prod_{i=1}^{n} \\left( k \\exp(-k T_{i}) \\right) \\;=\\; k^{n} \\exp\\!\\left(-k \\sum_{i=1}^{n} T_{i}\\right).\n$$\n取对数得到对数似然\n$$\n\\ell(k) \\;=\\; n \\ln k \\;-\\; k \\sum_{i=1}^{n} T_{i}.\n$$\n对 $k$ 求导并令结果为零，得到似然方程\n$$\n\\frac{\\partial \\ell}{\\partial k} \\;=\\; \\frac{n}{k} \\;-\\; \\sum_{i=1}^{n} T_{i} \\;=\\; 0.\n$$\n解出 $k$，得到最大似然估计量\n$$\n\\hat{k} \\;=\\; \\frac{n}{\\sum_{i=1}^{n} T_{i}} \\;=\\; \\frac{1}{\\bar{T}}, \\qquad \\text{where} \\quad \\bar{T} \\equiv \\frac{1}{n} \\sum_{i=1}^{n} T_{i}.\n$$\n\n接下来，我们精确计算 $\\mathbb{E}[\\hat{k}]$ 并识别其偏差。令 $S \\equiv \\sum_{i=1}^{n} T_{i}$。由于 $T_{i}$ 是速率为 $k$ 的独立同分布指数变量，其和 $S$ 服从形状参数为 $n$、速率参数为 $k$ 的伽马分布，其密度为\n$$\nf_{S}(s) \\;=\\; \\frac{k^{n}}{\\Gamma(n)} \\, s^{n-1} \\exp(-k s), \\qquad s0.\n$$\n因为 $\\bar{T} = S/n$，通过变量替换可知 $\\bar{T}$ 服从形状参数为 $n$、速率参数为 $k n$ 的伽马分布：\n$$\nf_{\\bar{T}}(t) \\;=\\; \\frac{(k n)^{n}}{\\Gamma(n)} \\, t^{n-1} \\exp(-k n\\, t), \\qquad t0.\n$$\n我们需要计算 $\\mathbb{E}[1/\\bar{T}]$。使用 $\\bar{T}$ 的密度和期望的定义，\n$$\n\\mathbb{E}\\!\\left[\\frac{1}{\\bar{T}}\\right] \\;=\\; \\int_{0}^{\\infty} \\frac{1}{t} \\, f_{\\bar{T}}(t) \\, dt \\;=\\; \\frac{(k n)^{n}}{\\Gamma(n)} \\int_{0}^{\\infty} t^{n-2} \\exp(-k n\\, t) \\, dt.\n$$\n该积分为一个标准的伽马函数积分：\n$$\n\\int_{0}^{\\infty} t^{n-2} \\exp(-k n\\, t) \\, dt \\;=\\; \\frac{\\Gamma(n-1)}{(k n)^{\\,n-1}}, \\qquad \\text{valid for } n1.\n$$\n因此，\n$$\n\\mathbb{E}\\!\\left[\\frac{1}{\\bar{T}}\\right] \\;=\\; \\frac{(k n)^{n}}{\\Gamma(n)} \\cdot \\frac{\\Gamma(n-1)}{(k n)^{\\,n-1}} \\;=\\; \\frac{k n}{n-1}.\n$$\n从而\n$$\n\\mathbb{E}[\\hat{k}] \\;=\\; \\mathbb{E}\\!\\left[\\frac{1}{\\bar{T}}\\right] \\;=\\; \\frac{k n}{n-1},\n$$\n这表明 $\\hat{k}$ 是向上有偏的，其偏差为\n$$\n\\mathbb{E}[\\hat{k}] - k \\;=\\; \\frac{k}{n-1}.\n$$\n通过线性重缩放可以消除此偏差。定义无偏估计量\n$$\n\\tilde{k} \\;\\equiv\\; \\frac{n-1}{n} \\, \\hat{k} \\;=\\; \\frac{n-1}{n} \\cdot \\frac{1}{\\bar{T}}.\n$$\n那么\n$$\n\\mathbb{E}[\\tilde{k}] \\;=\\; \\frac{n-1}{n} \\, \\mathbb{E}\\!\\left[\\frac{1}{\\bar{T}}\\right] \\;=\\; \\frac{n-1}{n} \\cdot \\frac{k n}{n-1} \\;=\\; k,\n$$\n正如所愿。\n\n我们现在计算精确方差 $\\mathrm{Var}(\\tilde{k})$。这只需找到 $\\mathrm{Var}(\\hat{k})$ 并进行重缩放即可。我们首先计算 $\\mathbb{E}[\\hat{k}^{2}] = \\mathbb{E}[1/\\bar{T}^{2}]$：\n$$\n\\mathbb{E}\\!\\left[\\frac{1}{\\bar{T}^{2}}\\right] \\;=\\; \\int_{0}^{\\infty} \\frac{1}{t^{2}} \\, f_{\\bar{T}}(t) \\, dt \\;=\\; \\frac{(k n)^{n}}{\\Gamma(n)} \\int_{0}^{\\infty} t^{n-3} \\exp(-k n\\, t) \\, dt.\n$$\n再次使用伽马积分，\n$$\n\\int_{0}^{\\infty} t^{n-3} \\exp(-k n\\, t) \\, dt \\;=\\; \\frac{\\Gamma(n-2)}{(k n)^{\\,n-2}}, \\qquad \\text{valid for } n2,\n$$\n所以\n$$\n\\mathbb{E}\\!\\left[\\frac{1}{\\bar{T}^{2}}\\right] \\;=\\; \\frac{(k n)^{2}}{(n-1)(n-2)}.\n$$\n因此，\n$$\n\\mathrm{Var}(\\hat{k}) \\;=\\; \\mathbb{E}[\\hat{k}^{2}] - \\big(\\mathbb{E}[\\hat{k}]\\big)^{2} \\;=\\; \\frac{(k n)^{2}}{(n-1)(n-2)} \\;-\\; \\left(\\frac{k n}{n-1}\\right)^{2} \\;=\\; \\frac{(k n)^{2}}{(n-1)^{2}(n-2)}.\n$$\n最后，由于 $\\tilde{k} = \\frac{n-1}{n}\\hat{k}$，\n$$\n\\mathrm{Var}(\\tilde{k}) \\;=\\; \\left(\\frac{n-1}{n}\\right)^{2} \\mathrm{Var}(\\hat{k}) \\;=\\; \\left(\\frac{n-1}{n}\\right)^{2} \\cdot \\frac{(k n)^{2}}{(n-1)^{2}(n-2)} \\;=\\; \\frac{k^{2}}{n-2}.\n$$\n这个精确的闭式方差在 $n \\ge 3$ 时成立。", "answer": "$$\\boxed{\\frac{k^{2}}{n-2}}$$", "id": "2782405"}]}