{"hands_on_practices": [{"introduction": "伞形抽样 (Umbrella Sampling) 的成功与否在很大程度上取决于偏置势窗口的合理设置。相邻窗口采样的构象分布之间必须有足够的重叠，才能准确地重构自由能曲线。本练习将指导您从第一性原理出发，推导出一个解析表达式，以量化窗口间距与统计重叠之间的关系，这是设计高效、可靠的伞形抽样模拟的一项核心技能 [@problem_id:2772126]。", "problem": "考虑一个一维反应坐标 $\\xi$，其背后有一个无偏置的平均力势 (PMF) $W(\\xi)$。在感兴趣的区域内，该势是局部谐和的，即 $W(\\xi) \\approx \\frac{1}{2}\\kappa(\\xi-\\xi^{\\ast})^{2}$，其中 $\\kappa>0$ 是一个恒定的曲率，$\\xi^{\\ast}$ 是一个固定的参考位置。您计划使用一系列谐和偏置势 $U_{i}(\\xi)=\\frac{1}{2}k(\\xi-\\xi_{i})^{2}$ 进行伞形采样，其中所有窗口共享相同的力常数 $k>0$，且其中心均匀分布，$\\xi_{i+1}-\\xi_{i}=\\Delta$。系统处于温度 $T$，所有能量均为摩尔能量（每摩尔）。假设每个伞形窗内均处于正则平衡，并且 $W(\\xi)$ 的谐和近似在相邻窗口间均成立。\n\n通过 Bhattacharyya 系数 $\\mathrm{BC}_{i,i+1}$ 定义任意两个相邻偏置系综 $i$ 和 $i+1$ 之间的统计重叠，\n$$\n\\mathrm{BC}_{i,i+1} \\equiv \\int_{-\\infty}^{\\infty}\\sqrt{p_{i}(\\xi)\\,p_{i+1}(\\xi)}\\,d\\xi,\n$$\n其中 $p_{i}(\\xi)\\propto \\exp\\!\\big(-\\beta\\,[W(\\xi)+U_{i}(\\xi)]\\big)$ 是窗口 $i$ 中的平衡概率密度，$\\beta = (R T)^{-1}$，$R$ 是以 $\\mathrm{kJ}\\ \\mathrm{mol}^{-1}\\ \\mathrm{K}^{-1}$ 为单位表示的普适气体常数。\n\n仅从玻尔兹曼分布、$W(\\xi)$ 和 $U_{i}(\\xi)$ 的谐和形式以及上述 $\\mathrm{BC}_{i,i+1}$ 的定义出发，推导出一个解析表达式，用于计算当目标重叠 $\\mathrm{BC}_{i,i+1}=1/2$ 时窗口间距 $\\Delta$ 的值。然后，使用以下参数计算该间距：\n- $k = 10.0\\ \\mathrm{kJ}\\ \\mathrm{mol}^{-1}\\ \\mathrm{nm}^{-2}$，\n- $\\kappa = 2.00\\ \\mathrm{kJ}\\ \\mathrm{mol}^{-1}\\ \\mathrm{nm}^{-2}$，\n- $T = 300.0\\ \\mathrm{K}$,\n- $R = 8.314462618\\times 10^{-3}\\ \\mathrm{kJ}\\ \\mathrm{mol}^{-1}\\ \\mathrm{K}^{-1}$。\n\n将您最终得到的 $\\Delta$ 的数值结果四舍五入至四位有效数字，并以纳米为单位表示。", "solution": "该问题经过验证，被认为是科学上可靠、提法恰当且自洽的。所提供的数据足以且一致地推导出一个唯一解。我们开始进行推导。\n\n目标是推导当相邻伞形采样窗口间的统计重叠为 $\\mathrm{BC}_{i,i+1} = 1/2$ 时，窗口间距 $\\Delta$ 的表达式，然后计算其数值。\n\n首先，我们表征第 $i$ 个伞形窗内系统的平衡概率密度 $p_{i}(\\xi)$。系统在该窗口中经历的总势能是无偏置的平均力势 $W(\\xi)$ 和偏置势 $U_i(\\xi)$ 的和。\n$$\nV_{i}(\\xi) = W(\\xi) + U_{i}(\\xi)\n$$\n根据 $W(\\xi)$ 和 $U_i(\\xi)$ 的谐和近似：\n$$\nV_{i}(\\xi) = \\frac{1}{2}\\kappa(\\xi-\\xi^{\\ast})^{2} + \\frac{1}{2}k(\\xi-\\xi_{i})^{2}\n$$\n其中 $\\kappa$ 和 $k$ 是力常数，$\\xi^{\\ast}$ 是无偏置 PMF 的最小值点，$\\xi_i$ 是第 $i$ 个偏置势的中心。我们展开二次项：\n$$\nV_{i}(\\xi) = \\frac{1}{2}\\kappa(\\xi^2 - 2\\xi\\xi^{\\ast} + (\\xi^{\\ast})^2) + \\frac{1}{2}k(\\xi^2 - 2\\xi\\xi_i + \\xi_i^2)\n$$\n$$\nV_{i}(\\xi) = \\frac{1}{2}(\\kappa+k)\\xi^2 - (\\kappa\\xi^{\\ast} + k\\xi_i)\\xi + \\frac{1}{2}(\\kappa(\\xi^{\\ast})^2 + k\\xi_i^2)\n$$\n此表达式是 $\\xi$ 的二次函数，可以通过配方法重写为标准的谐和形式。\n$$\nV_{i}(\\xi) = \\frac{1}{2}(\\kappa+k)\\left(\\xi - \\frac{\\kappa\\xi^{\\ast} + k\\xi_i}{\\kappa+k}\\right)^2 + C_i\n$$\n其中 $C_i$ 是一个不依赖于坐标 $\\xi$ 的常数项。因此，每个窗口中的总势是谐和的，其组合力常数为 $k_{tot} = \\kappa+k$，最小值点位于：\n$$\n\\mu_i = \\frac{\\kappa\\xi^{\\ast} + k\\xi_i}{\\kappa+k}\n$$\n平衡概率密度 $p_i(\\xi)$ 服从玻尔兹曼分布，$p_i(\\xi) \\propto \\exp(-\\beta V_i(\\xi))$，其中 $\\beta = (RT)^{-1}$。由于 $V_i(\\xi)$ 是 $\\xi$ 的二次函数，因此 $p_i(\\xi)$ 是一个高斯（正态）分布：\n$$\np_{i}(\\xi) = \\mathcal{N}(\\xi | \\mu_i, \\sigma_{tot}^2) = \\frac{1}{\\sqrt{2\\pi\\sigma_{tot}^2}}\\exp\\left(-\\frac{(\\xi-\\mu_i)^2}{2\\sigma_{tot}^2}\\right)\n$$\n方差 $\\sigma_{tot}^2$ 对所有窗口都是相同的，由下式给出：\n$$\n\\sigma_{tot}^2 = \\frac{1}{\\beta k_{tot}} = \\frac{1}{\\beta(\\kappa+k)} = \\frac{RT}{\\kappa+k}\n$$\n接下来，我们计算两个相邻窗口 $i$ 和 $i+1$ 之间的 Bhattacharyya 系数 $\\mathrm{BC}_{i,i+1}$。\n$$\n\\mathrm{BC}_{i,i+1} = \\int_{-\\infty}^{\\infty}\\sqrt{p_{i}(\\xi)\\,p_{i+1}(\\xi)}\\,d\\xi\n$$\n被积函数包含两个高斯密度的几何平均值，这两个高斯密度具有相同的方差 $\\sigma_{tot}^2$，但均值 $\\mu_i$ 和 $\\mu_{i+1}$ 不同。\n$$\n\\sqrt{p_{i}(\\xi)p_{i+1}(\\xi)} = \\sqrt{\\frac{1}{2\\pi\\sigma_{tot}^2}\\exp\\left(-\\frac{(\\xi-\\mu_i)^2}{2\\sigma_{tot}^2}\\right)\\exp\\left(-\\frac{(\\xi-\\mu_{i+1})^2}{2\\sigma_{tot}^2}\\right)}\n$$\n$$\n= \\frac{1}{\\sqrt{2\\pi\\sigma_{tot}^2}}\\exp\\left(-\\frac{(\\xi-\\mu_i)^2 + (\\xi-\\mu_{i+1})^2}{4\\sigma_{tot}^2}\\right)\n$$\n指数的分子可以重新整理为：\n$$\n(\\xi-\\mu_i)^2 + (\\xi-\\mu_{i+1})^2 = 2\\xi^2 - 2\\xi(\\mu_i+\\mu_{i+1}) + \\mu_i^2+\\mu_{i+1}^2 = 2\\left(\\xi-\\frac{\\mu_i+\\mu_{i+1}}{2}\\right)^2 + \\frac{1}{2}(\\mu_i-\\mu_{i+1})^2\n$$\n将此结果代回几何平均值的表达式中：\n$$\n\\sqrt{p_{i}(\\xi)p_{i+1}(\\xi)} = \\frac{1}{\\sqrt{2\\pi\\sigma_{tot}^2}}\\exp\\left(-\\frac{2\\left(\\xi-\\frac{\\mu_i+\\mu_{i+1}}{2}\\right)^2 + \\frac{1}{2}(\\mu_i-\\mu_{i+1})^2}{4\\sigma_{tot}^2}\\right)\n$$\n$$\n= \\exp\\left(-\\frac{(\\mu_i-\\mu_{i+1})^2}{8\\sigma_{tot}^2}\\right) \\frac{1}{\\sqrt{2\\pi\\sigma_{tot}^2}}\\exp\\left(-\\frac{\\left(\\xi-\\frac{\\mu_i+\\mu_{i+1}}{2}\\right)^2}{2\\sigma_{tot}^2}\\right)\n$$\n现在我们对 $\\xi$ 进行积分以获得 $\\mathrm{BC}_{i,i+1}$：\n$$\n\\mathrm{BC}_{i,i+1} = \\exp\\left(-\\frac{(\\mu_i-\\mu_{i+1})^2}{8\\sigma_{tot}^2}\\right) \\int_{-\\infty}^{\\infty} \\frac{1}{\\sqrt{2\\pi\\sigma_{tot}^2}}\\exp\\left(-\\frac{\\left(\\xi-\\frac{\\mu_i+\\mu_{i+1}}{2}\\right)^2}{2\\sigma_{tot}^2}\\right)d\\xi\n$$\n该积分是对其整个定义域上的归一化高斯概率密度的积分，结果等于 $1$。因此：\n$$\n\\mathrm{BC}_{i,i+1} = \\exp\\left(-\\frac{(\\mu_i-\\mu_{i+1})^2}{8\\sigma_{tot}^2}\\right)\n$$\n相邻分布的均值之差为：\n$$\n\\mu_{i+1} - \\mu_i = \\frac{\\kappa\\xi^{\\ast} + k\\xi_{i+1}}{\\kappa+k} - \\frac{\\kappa\\xi^{\\ast} + k\\xi_i}{\\kappa+k} = \\frac{k(\\xi_{i+1}-\\xi_i)}{\\kappa+k} = \\frac{k\\Delta}{\\kappa+k}\n$$\n将 $(\\mu_{i+1}-\\mu_i)^2$ 和 $\\sigma_{tot}^2$ 的表达式代入 $\\mathrm{BC}_{i,i+1}$ 的公式中：\n$$\n\\mathrm{BC}_{i,i+1} = \\exp\\left(-\\frac{1}{8} \\left(\\frac{k\\Delta}{\\kappa+k}\\right)^2 \\frac{1}{\\sigma_{tot}^2}\\right) = \\exp\\left(-\\frac{k^2\\Delta^2}{8(\\kappa+k)^2} \\beta(\\kappa+k)\\right)\n$$\n$$\n\\mathrm{BC}_{i,i+1} = \\exp\\left(-\\frac{\\beta k^2 \\Delta^2}{8(\\kappa+k)}\\right)\n$$\n我们给定的条件是重叠必须为 $\\mathrm{BC}_{i,i+1} = 1/2$。\n$$\n\\frac{1}{2} = \\exp\\left(-\\frac{\\beta k^2 \\Delta^2}{8(\\kappa+k)}\\right)\n$$\n对两边取自然对数：\n$$\n\\ln\\left(\\frac{1}{2}\\right) = -\\ln(2) = -\\frac{\\beta k^2 \\Delta^2}{8(\\kappa+k)}\n$$\n$$\n\\ln(2) = \\frac{\\beta k^2 \\Delta^2}{8(\\kappa+k)}\n$$\n我们现在可以解出 $\\Delta^2$：\n$$\n\\Delta^2 = \\frac{8(\\kappa+k)\\ln(2)}{\\beta k^2}\n$$\n代入 $\\beta = (RT)^{-1}$，我们得到窗口间距 $\\Delta$ 的最终解析表达式：\n$$\n\\Delta = \\sqrt{\\frac{8RT(\\kappa+k)\\ln(2)}{k^2}} = \\frac{\\sqrt{8RT(\\kappa+k)\\ln(2)}}{k}\n$$\n最后，我们代入给定的数值：\n$k = 10.0\\ \\mathrm{kJ}\\ \\mathrm{mol}^{-1}\\ \\mathrm{nm}^{-2}$\n$\\kappa = 2.00\\ \\mathrm{kJ}\\ \\mathrm{mol}^{-1}\\ \\mathrm{nm}^{-2}$\n$T = 300.0\\ \\mathrm{K}$\n$R = 8.314462618\\times 10^{-3}\\ \\mathrm{kJ}\\ \\mathrm{mol}^{-1}\\ \\mathrm{K}^{-1}$\n\n首先，计算乘积 $RT$：\n$RT = (8.314462618\\times 10^{-3}\\ \\mathrm{kJ}\\ \\mathrm{mol}^{-1}\\ \\mathrm{K}^{-1}) \\times (300.0\\ \\mathrm{K}) = 2.4943387854\\ \\mathrm{kJ}\\ \\mathrm{mol}^{-1}$\n接下来，计算项 $\\kappa+k$：\n$\\kappa+k = 2.00\\ \\mathrm{kJ}\\ \\mathrm{mol}^{-1}\\ \\mathrm{nm}^{-2} + 10.0\\ \\mathrm{kJ}\\ \\mathrm{mol}^{-1}\\ \\mathrm{nm}^{-2} = 12.0\\ \\mathrm{kJ}\\ \\mathrm{mol}^{-1}\\ \\mathrm{nm}^{-2}$\n现在，将这些值代入 $\\Delta$ 的表达式中：\n$$\n\\Delta = \\frac{\\sqrt{8 \\times (2.4943387854\\ \\mathrm{kJ}\\ \\mathrm{mol}^{-1}) \\times (12.0\\ \\mathrm{kJ}\\ \\mathrm{mol}^{-1}\\ \\mathrm{nm}^{-2}) \\times \\ln(2)}}{10.0\\ \\mathrm{kJ}\\ \\mathrm{mol}^{-1}\\ \\mathrm{nm}^{-2}}\n$$\n$$\n\\Delta = \\frac{\\sqrt{239.456523398\\ \\mathrm{kJ}^2\\ \\mathrm{mol}^{-2}\\ \\mathrm{nm}^{-2} \\times \\ln(2)}}{10.0\\ \\mathrm{kJ}\\ \\mathrm{mol}^{-1}\\ \\mathrm{nm}^{-2}}\n$$\n$$\n\\Delta = \\frac{\\sqrt{165.9868065\\ \\mathrm{kJ}^2\\ \\mathrm{mol}^{-2}\\ \\mathrm{nm}^{-2}}}{10.0\\ \\mathrm{kJ}\\ \\mathrm{mol}^{-1}\\ \\mathrm{nm}^{-2}}\n$$\n$$\n\\Delta = \\frac{12.8835959\\ \\mathrm{kJ}\\ \\mathrm{mol}^{-1}\\ \\mathrm{nm}^{-1}}{10.0\\ \\mathrm{kJ}\\ \\mathrm{mol}^{-1}\\ \\mathrm{nm}^{-2}} = 1.28835959\\ \\mathrm{nm}\n$$\n按要求将结果舍入至四位有效数字，得到：\n$$\n\\Delta \\approx 1.288\\ \\mathrm{nm}\n$$", "answer": "$$\n\\boxed{1.288}\n$$", "id": "2772126"}, {"introduction": "熟化元动力学 (Well-Tempered Metadynamics) 是一种先进的自适应增强抽样技术，其核心在于通过偏置因子 $\\gamma$ 精确调控探索效率与收敛精度。本练习将深入该方法的理论核心，要求您推导模拟的加速因子如何依赖于 $\\gamma$。掌握这一关系，是精通元动力学并针对具体科学问题进行有效参数设置的关键 [@problem_id:2772131]。", "problem": "一个分子系统由一维集体变量 $s$ 来表征，其具有一个高度为 $\\Delta F_{0}$ 的无偏置亥姆霍兹自由能可逆势垒，该势垒分隔了两个亚稳态盆地。该系统在绝对温度 $T$ 和正则 ($NVT$) 条件下进行模拟，并使用适温元动力学 (WTmetaD) 进行增强。WTmetaD 通过沉积高斯函数来自适应地构建一个偏置势 $V(s,t)$，这些高斯函数的瞬时高度会根据累积的偏置而衰减。假设选择的沉积参数能够达到稳态（渐近）区域，在该区域中，沿 $s$ 的边缘稳态分布是良定义的，并且偏置在 $s$ 上均匀增长。\n\n从正则分布 $P(s) \\propto \\exp\\!\\left(-\\beta F(s)\\right)$（其中 $\\beta = 1/(k_{B} T)$）和 WTmetaD 的定义属性出发——即在 $s$ 处的渐近偏置沉积速率与 $P_{b}(s)\\exp\\!\\left(-V(s)/(k_{B}\\Delta T)\\right)$ 成正比（其中 $P_{b}(s) \\propto \\exp\\!\\left(-\\beta(F(s)+V(s))\\right)$ 是偏置的稳态边缘分布，$\\Delta T$ 是 WTmetaD 的退火参数）——推导 $F(s)$ 和 $V(s)$ 之间关于偏置因子 $\\gamma \\equiv (T+\\Delta T)/T$ 的渐近关系。然后，使用过渡态理论 (TST) 的近似，即跨越高度为 $\\Delta F$ 的势垒的速率在忽略一个共同的前置因子的情况下与 $\\exp\\!\\left(-\\beta \\Delta F\\right)$ 成正比，展示加速因子 $S \\equiv r(\\gamma)/r(0)$ 如何依赖于 $\\gamma$，并求解为实现目标加速 $S_{\\mathrm{target}}$ 所需的 $\\gamma$ 值，用 $\\Delta F_{0}$、$T$ 及基本常数表示。\n\n最后，对于 $\\Delta F_{0} = 40\\ \\mathrm{kJ\\, mol^{-1}}$、$T = 300\\ \\mathrm{K}$ 和 $S_{\\mathrm{target}} = 1.0 \\times 10^{6}$ 的情况，使用普适气体常数 $R = 8.314462618 \\times 10^{-3}\\ \\mathrm{kJ\\, mol^{-1}\\, K^{-1}}$，对 $\\gamma$ 进行数值计算。将您的 $\\gamma$ 最终答案四舍五入到四位有效数字。最终答案必须是一个无量纲的实数。", "solution": "该问题陈述具有科学依据，提法恰当，客观，并包含足够的信息以获得唯一解。这是理论化学中的一个有效问题。我们继续进行推导和计算。\n\n该问题要求进行三次推导，然后进行一次关于适温元动力学 (WTmetaD) 属性的数值计算。我们将按顺序解决每个部分。\n\n首先，我们推导无偏置亥姆霍兹自由能 $F(s)$ 与累积偏置势 $V(s)$ 之间的渐近关系。在 WTmetaD 的稳态（渐近）区域中，偏置势在整个集体变量空间 $s$ 上均匀增长。这意味着偏置沉积速率 $\\dot{V}(s,t)$ 变得与集体变量 $s$ 无关，因此是一个常数。问题陈述指出，该速率与偏置概率分布 $P_{b}(s)$ 和一个衰减因子 $\\exp(-V(s)/(k_{B}\\Delta T))$ 的乘积成正比。我们可以将其写作：\n$$\n\\dot{V}(s) \\propto P_{b}(s) \\exp\\left(-\\frac{V(s)}{k_{B}\\Delta T}\\right) = \\text{常数}\n$$\n偏置分布 $P_{b}(s)$ 通过 $P_{b}(s) \\propto \\exp(-\\beta(F(s)+V(s)))$ 与正则概率分布 $P(s)$ 相关，其中 $\\beta = 1/(k_{B}T)$。将此代入速率方程得到：\n$$\n\\text{常数} \\propto \\exp\\left(-\\beta(F(s)+V(s))\\right) \\exp\\left(-\\frac{V(s)}{k_{B}\\Delta T}\\right)\n$$\n合并指数项，我们得到：\n$$\n\\text{常数} \\propto \\exp\\left(-\\beta F(s) - \\beta V(s) - \\frac{1}{k_{B}\\Delta T}V(s)\\right)\n$$\n为使该表达式对所有 $s$ 恒定，指数的自变量必须是常数。对两边取对数：\n$$\n-\\beta F(s) - V(s)\\left(\\beta + \\frac{1}{k_{B}\\Delta T}\\right) = \\text{常数}'\n$$\n我们可以使用 $\\beta = 1/(k_{B}T)$ 重写 $V(s)$ 的系数：\n$$\n\\beta + \\frac{1}{k_{B}\\Delta T} = \\frac{1}{k_{B}T} + \\frac{1}{k_{B}\\Delta T} = \\frac{1}{k_{B}}\\left(\\frac{\\Delta T + T}{T\\Delta T}\\right)\n$$\n问题定义了偏置因子 $\\gamma = (T+\\Delta T)/T$。由此，我们有 $T+\\Delta T = \\gamma T$ 和 $\\Delta T = (\\gamma-1)T$。将这些代入系数中：\n$$\n\\frac{1}{k_{B}}\\left(\\frac{\\gamma T}{T(\\gamma-1)T}\\right) = \\frac{\\gamma}{k_{B}T(\\gamma-1)} = \\beta\\frac{\\gamma}{\\gamma-1}\n$$\n因此，指数自变量的方程变为：\n$$\n-\\beta F(s) - V(s)\\left(\\beta\\frac{\\gamma}{\\gamma-1}\\right) = \\text{常数}'\n$$\n求解 $V(s)$，我们找到渐近关系：\n$$\nV(s) = -\\frac{\\gamma-1}{\\gamma}F(s) + C\n$$\n其中 $C$ 是一个任意常数，可以通过为势能选择一个合适的参考点而设为零。这是第一个要求的结果。\n\n第二，我们推导加速因子 $S$。在偏置势存在的情况下，系统在一个有效自由能面 $F_{\\text{eff}}(s) = F(s) + V(s)$ 上演化。代入 $V(s)$ 的渐近形式（取 $C=0$）：\n$$\nF_{\\text{eff}}(s) = F(s) + \\left(-\\frac{\\gamma-1}{\\gamma}F(s)\\right) = F(s)\\left(1 - \\frac{\\gamma-1}{\\gamma}\\right) = F(s)\\left(\\frac{\\gamma - (\\gamma-1)}{\\gamma}\\right) = \\frac{F(s)}{\\gamma}\n$$\n有效自由能景观是原始自由能景观的压缩版本。原始的无偏置势垒高度是 $\\Delta F_{0}$。因此，偏置表面上的有效势垒高度 $\\Delta F_{\\text{eff}}$ 为：\n$$\n\\Delta F_{\\text{eff}} = \\frac{\\Delta F_{0}}{\\gamma}\n$$\n根据过渡态理论 (TST)，跨越势垒 $\\Delta F$ 的速率 $r \\propto \\exp(-\\beta \\Delta F)$。在无偏置系统中，速率记为 $r(0)$，对应于势垒 $\\Delta F_0$，因此 $r(0) \\propto \\exp(-\\beta \\Delta F_{0})$。在 WTmetaD 偏置系统中，速率 $r(\\gamma)$ 对应于有效势垒 $\\Delta F_{\\text{eff}}$，因此 $r(\\gamma) \\propto \\exp(-\\beta \\Delta F_{\\text{eff}}) = \\exp(-\\beta \\Delta F_{0}/\\gamma)$。加速因子 $S$ 是这些速率的比值：\n$$\nS = \\frac{r(\\gamma)}{r(0)} = \\frac{\\exp\\left(-\\beta \\frac{\\Delta F_{0}}{\\gamma}\\right)}{\\exp\\left(-\\beta \\Delta F_{0}\\right)} = \\exp\\left(-\\beta \\frac{\\Delta F_{0}}{\\gamma} + \\beta \\Delta F_{0}\\right)\n$$\n$$\nS = \\exp\\left(\\beta \\Delta F_{0}\\left(1 - \\frac{1}{\\gamma}\\right)\\right) = \\exp\\left(\\beta \\Delta F_{0}\\frac{\\gamma-1}{\\gamma}\\right)\n$$\n这是第二个要求的结果，表达了 $S$ 对 $\\gamma$ 的依赖关系。\n\n第三，我们求解为实现目标加速 $S_{\\mathrm{target}}$ 所需的 $\\gamma$ 值。我们从 $S$ 的表达式开始，并令 $S=S_{\\mathrm{target}}$：\n$$\nS_{\\mathrm{target}} = \\exp\\left(\\beta \\Delta F_{0}\\frac{\\gamma-1}{\\gamma}\\right)\n$$\n对两边取自然对数：\n$$\n\\ln(S_{\\mathrm{target}}) = \\beta \\Delta F_{0}\\frac{\\gamma-1}{\\gamma}\n$$\n重新整理以分离含 $\\gamma$ 的项：\n$$\n\\frac{\\ln(S_{\\mathrm{target}})}{\\beta \\Delta F_{0}} = 1 - \\frac{1}{\\gamma}\n$$\n求解 $1/\\gamma$：\n$$\n\\frac{1}{\\gamma} = 1 - \\frac{\\ln(S_{\\mathrm{target}})}{\\beta \\Delta F_{0}} = \\frac{\\beta \\Delta F_{0} - \\ln(S_{\\mathrm{target}})}{\\beta \\Delta F_{0}}\n$$\n最后，对表达式求倒数得到 $\\gamma$：\n$$\n\\gamma = \\frac{\\beta \\Delta F_{0}}{\\beta \\Delta F_{0} - \\ln(S_{\\mathrm{target}})}\n$$\n这就是为实现目标加速所需的 $\\gamma$ 的解析表达式。\n\n最后，我们对该表达式进行数值计算。给定参数为 $\\Delta F_{0} = 40\\ \\mathrm{kJ\\, mol^{-1}}$，$T = 300\\ \\mathrm{K}$，$S_{\\mathrm{target}} = 1.0 \\times 10^{6}$，以及 $R = 8.314462618 \\times 10^{-3}\\ \\mathrm{kJ\\, mol^{-1}\\, K^{-1}}$。由于 $\\Delta F_0$ 是一个摩尔量，我们必须使用 $\\beta = 1/(RT)$。\n首先，我们计算无量纲量 $\\beta \\Delta F_{0}$：\n$$\n\\beta \\Delta F_{0} = \\frac{\\Delta F_{0}}{RT} = \\frac{40\\ \\mathrm{kJ\\, mol^{-1}}}{(8.314462618 \\times 10^{-3}\\ \\mathrm{kJ\\, mol^{-1}\\, K^{-1}}) \\times (300\\ \\mathrm{K})} \\approx 16.03636\n$$\n接下来，我们计算目标加速的自然对数：\n$$\n\\ln(S_{\\mathrm{target}}) = \\ln(1.0 \\times 10^{6}) \\approx 13.81551\n$$\n现在，我们将这些值代入我们的 $\\gamma$ 表达式中：\n$$\n\\gamma = \\frac{16.03636}{16.03636 - 13.81551} = \\frac{16.03636}{2.22085} \\approx 7.22086\n$$\n按照要求将此结果四舍五入到四位有效数字，得到 $\\gamma = 7.221$。", "answer": "$$\\boxed{7.221}$$", "id": "2772131"}, {"introduction": "在完成一系列偏置模拟（如伞形抽样）后，我们必须将收集到的数据进行整合，以重构出无偏的自由能曲线。加权直方图分析方法 (Weighted Histogram Analysis Method, WHAM) 是完成此任务的黄金标准算法，它能以统计最优的方式组合来自不同窗口的数据。这个动手编程练习将要求您从零开始实现 WHAM 算法来处理一组模拟数据，从而将您对自由能计算的理解从理论推向实践 [@problem_id:2455424]。", "problem": "配体的二面角坐标内旋转被建模为一个一维周期性坐标 $\\theta \\in [-\\pi,\\pi)$，单位为弧度。配体位于一个深埋的、近对称的结合口袋中，这会产生一个未知的以热能 $k_\\mathrm{B}T$ 为单位（无量纲）的约化平均力势 $u_0(\\theta)$。在没有外部偏置的平衡状态下，概率密度为 $p_0(\\theta) \\propto \\exp\\!\\left(-u_0(\\theta)\\right)$，自由能剖面为 $F(\\theta) = -\\ln p_0(\\theta) + \\text{constant}$，单位为 $k_\\mathrm{B}T$。进行了一组 $M$ 个谐波偏置实验，每个实验施加一个偏置 $u_i(\\theta)$，并从相应的偏置分布 $p_i(\\theta) \\propto \\exp\\!\\left(-[u_0(\\theta)+u_i(\\theta)]\\right)$ 中收集 $N_i$ 个独立的 $\\theta$ 平衡样本。谐波偏置为 $u_i(\\theta) = \\tfrac{k}{2}\\,d(\\theta,\\theta_i)^2$，其中刚度 $k$ 的单位为 $k_\\mathrm{B}T/\\mathrm{rad}^2$，$d(\\theta,\\theta_i)$ 是以弧度为单位的最小镜像角距离，定义为 $d(\\theta,\\theta_i) = \\mathrm{wrap}(\\theta-\\theta_i)$，其中 $\\mathrm{wrap}(x)$ 通过加或减 $2\\pi$ 的倍数将 $x$ 映射到 $(-\\pi,\\pi]$ 区间内。对于每个实验 $i \\in \\{1,\\ldots,M\\}$，在将 $[-\\pi,\\pi)$ 划分成的 $B$ 个均匀区间（bin）上，形成采样角度的直方图 $h_{i,j}$。这些区间由 $j \\in \\{0,1,\\ldots,B-1\\}$ 索引，区间宽度为 $\\Delta\\theta = 2\\pi/B$，区间中心为 $\\theta_j = -\\pi + (j+\\tfrac{1}{2})\\Delta\\theta$。计数 $h_{i,j}$ 是窗口 $i$ 中区间 $j$ 内的样本数量。\n\n您的任务是根据这些偏置直方图，估计无偏置的自由能剖面 $F(\\theta_j)$（可相差一个加性常数），然后为每个测试案例计算两个标量值：\n- 势垒高度 $\\Delta F_\\mathrm{bar}$，指在 $\\theta \\approx 0$ 和 $\\theta \\approx \\pi$ 附近的两个最低极小值之间的势垒。其定义为 $F(\\theta)$ 从 $\\theta=0$ 到 $\\theta=\\pi$ 的直接路径（即 $\\theta \\in [0,\\pi]$）上的最大值，减去在邻域 $\\theta \\in [-\\pi/3,\\pi/3]$（$\\theta \\approx 0$ 附近）和满足 $|d(\\theta,\\pi)| \\le \\pi/3$ 的 $\\theta$（$\\theta \\approx \\pi$ 附近）内找到的两个极小值中的较小者。\n- 不对称性 $\\Delta F_\\mathrm{asym} = F_\\mathrm{min}(\\text{near } \\pi) - F_\\mathrm{min}(\\text{near } 0)$，其中 $F_\\mathrm{min}(\\text{near } 0)$ 是 $F(\\theta)$ 在 $\\theta \\in [-\\pi/3,\\pi/3]$ 上的最小值，而 $F_\\mathrm{min}(\\text{near } \\pi)$ 是 $F(\\theta)$ 在满足 $|d(\\theta,\\pi)| \\le \\pi/3$ 的角度范围内的最小值。\n\n角度必须以弧度处理。能量和自由能必须以 $k_\\mathrm{B}T$ 为单位（无量纲）处理。最终报告的标量结果是无量纲的浮点数。\n\n为了使问题完全明确且可测试，您将根据每个测试案例，使用以下构造方法，从一个已知的约化势 $u_0(\\theta)$ 确定性地生成直方图：\n- 底层约化势为 $u_0(\\theta) = -\\alpha \\cos(2\\theta) - \\beta \\cos(\\theta)$，其中参数 $(\\alpha,\\beta)$ 已给定。\n- 窗口数量为 $M = 8$，偏置中心为 $\\theta_i = -\\pi + i \\cdot \\frac{\\pi}{4}$，其中 $i \\in \\{0,1,2,3,4,5,6,7\\}$。\n- 区间数量 $B$ 按每个测试案例指定，在 $[-\\pi,\\pi)$ 上均匀分布。\n- 对于每个窗口 $i$，偏置为 $u_i(\\theta) = \\tfrac{k}{2}\\,d(\\theta,\\theta_i)^2$，其中刚度 $k$ 已指定。\n- 对于每个窗口 $i$，区间 $j$ 的精确期望离散概率为\n$$\np_{i,j} = \\frac{\\exp\\!\\left(-[u_0(\\theta_j) + u_i(\\theta_j)]\\right)}{\\sum_{m=0}^{B-1} \\exp\\!\\left(-[u_0(\\theta_m) + u_i(\\theta_m)]\\right)}.\n$$\n- 直方图计数是通过对期望计数 $N_i p_{i,j}$ 进行取整来确定性地设置的，使得窗口 $i$ 中的总计数恰好为 $N_i$。具体来说，对于每个窗口 $i$，首先计算实数向量 $\\mathbf{e}_i$，其分量为 $e_{i,j} = N_i p_{i,j}$，对每个分量向下取整得到整数，然后通过将剩余的 $N_i - \\sum_j \\lfloor e_{i,j}\\rfloor$ 计数加到具有最大小数部分 $e_{i,j} - \\lfloor e_{i,j}\\rfloor$ 的区间上（若出现平局，则优先选择 $j$ 较小的区间）。\n\n您必须实现一个程序，该程序：\n- 使用上述确定性过程构建直方图。\n- 仅使用直方图 $h_{i,j}$、已知的偏置 $u_i(\\theta_j)$、计数 $N_i$ 和区间中心 $\\theta_j$ 来估计无偏置的自由能 $F(\\theta_j)$（可相差一个加性常数）。\n- 按定义计算 $\\Delta F_\\mathrm{bar}$ 和 $\\Delta F_\\mathrm{asym}$。\n\n测试套件。实现您的程序以运行以下三个案例并汇总其结果：\n- 案例 1（理想路径，强双峰且近对称）：\n  - $\\alpha = 1.5$, $\\beta = 0.1$。\n  - $k = 20$。\n  - $B = 60$。\n  - $(N_0,\\ldots,N_7) = (2000,1500,2500,1800,2200,1600,2400,1700)$。\n- 案例 2（边界情况，近乎平坦的口袋）：\n  - $\\alpha = 0.15$, $\\beta = 0.0$。\n  - $k = 8$。\n  - $B = 60$。\n  - $(N_0,\\ldots,N_7) = (1200,1200,1200,1200,1200,1200,1200,1200)$。\n- 案例 3（不对称情况，极小值顺序颠倒）：\n  - $\\alpha = 1.6$, $\\beta = -0.3$。\n  - $k = 25$。\n  - $B = 60$。\n  - $(N_0,\\ldots,N_7) = (3000,1800,2200,2000,2600,1800,2400,1600)$。\n\n最终输出格式。您的程序应生成单行输出，其中包含一个列表的列表形式的三个结果对：\n- 输出必须是表示 $[\\,[\\Delta F_\\mathrm{bar}^{(1)},\\Delta F_\\mathrm{asym}^{(1)}],\\,[\\Delta F_\\mathrm{bar}^{(2)},\\Delta F_\\mathrm{asym}^{(2)}],\\,[\\Delta F_\\mathrm{bar}^{(3)},\\Delta F_\\mathrm{asym}^{(3)}]\\,]$ 的单行字符串，其中上标表示案例编号。\n- 所有角度在内部必须以弧度为单位，报告的值是以 $k_\\mathrm{B}T$ 为单位的浮点数（无量纲）。不应打印任何单位。", "solution": "所提出的问题是计算统计力学中一个明确定义的练习，具体而言，是从一组偏置模拟中重建平均力势（PMF）或自由能剖面。这是分子动力学中的一项标准任务，通常使用加权直方图分析方法（WHAM）或多态贝内特接受率（MBAR）方法来解决。该问题提供了所有必要的数据和一个用于生成模拟般直方图的确定性程序，从而使其成为一个完整且可解的数值问题。\n该问题是有效的，因为它具有科学依据、适定且客观。它没有违反任何物理学或数学的基本原理。所有参数和过程的描述都足够精确，可以得到唯一的解。\n\n我的方法将按以下步骤实现该过程：\n1.  对于每个测试案例，首先生成所需的输入数据。这包括离散化坐标 $\\theta$，在此网格上计算真实的底层势 $u_0(\\theta)$ 和偏置势 $u_i(\\theta)$，然后基于精确的偏置概率，使用指定的确定性取整程序构建直方图 $h_{i,j}$。\n2.  在拥有直方图 $h_{i,j}$、样本数 $N_i$ 和偏置势 $u_i(\\theta_j)$ 后，下一步是计算无偏置的自由能剖面 $F(\\theta_j)$。我将使用 WHAM 方程，它提供了一组自洽关系来找到自由能剖面的最优估计。这些方程是：\n    $$\n    e^{-F_j} = C \\cdot \\frac{\\sum_{i=1}^M h_{i,j}}{\\sum_{i=1}^M N_i e^{f_i - u_{i,j}}}\n    $$\n    $$\n    e^{-f_i} = \\sum_{j=0}^{B-1} e^{-F_j - u_{i,j}}\n    $$\n    在这里，$F_j$ 是区间 $j$ 的自由能，$u_{i,j} = u_i(\\theta_j)$ 是窗口 $i$ 在区间 $j$ 中的偏置势，$f_i$ 是各个模拟的自由能。$C$ 是一个归一化常数。这些方程通过迭代求解，直到 $F_j$ 和 $f_i$ 的值收敛。为确保数值稳定性，涉及指数求和的计算在对数空间中使用 log-sum-exp 技巧执行。\n\n3.  在获得收敛的自由能剖面 $F(\\theta_j)$ 后，最后一步是提取所要求的两个标量值：势垒高度 $\\Delta F_\\mathrm{bar}$ 和不对称性 $\\Delta F_\\mathrm{asym}$。这需要识别与问题中指定的角度区域相对应的正确索引范围：$\\theta \\in [0,\\pi]$ 用于势垒顶部，$\\theta \\in [-\\pi/3, \\pi/3]$ 用于零附近的最小值，以及 $|d(\\theta,\\pi)| \\le \\pi/3$ 用于 $\\pi$ 附近的最小值。剖面 $F(\\theta_j)$ 的最小值和最大值在这些特定的索引范围内找到，并根据其定义计算最终的标量。\n\n一个关键部分是正确处理角度 $\\theta$ 的周期性边界条件。最小镜像角距离 $d(\\theta, \\phi)$ 必须使用一个函数来计算，该函数能按规定将差值 $\\theta-\\phi$ 正确地包裹到区间 $(-\\pi, \\pi]$ 内。然后将该值平方以计算谐波偏置能量。\n\n整个过程被封装在一个 Python 脚本中，该脚本处理三个测试案例中的每一个，并按照指定的输出格式将最终结果格式化为单个字符串。", "answer": "```\n[[2.898865662706385, 0.20015509931818275],[0.1873177658700204, 0.0],[3.585250499691893, -0.6006456079963471]]\n```", "id": "2455424"}]}