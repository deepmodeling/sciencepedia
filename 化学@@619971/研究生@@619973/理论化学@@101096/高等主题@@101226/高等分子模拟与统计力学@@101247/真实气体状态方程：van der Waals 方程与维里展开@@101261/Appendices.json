{"hands_on_practices": [{"introduction": "我们从最简洁的非理想气体模型——硬球模型——开始我们的实践。该模型虽然简单，却精准地捕捉了分子间排斥力的核心效应，即“排除体积”的概念。通过从统计力学的第一性原理出发，推导其第二维里系数，你将掌握维里展开的基本数学形式，并深刻理解范德华方程中协体积参数 $b$ 的微观来源。[@problem_id:2800866]", "problem": "一个由 $N$ 个相同粒子组成的经典单原子气体，在三维空间中占据体积 $V$，温度为 $T$。其对相互作用势是球对称且对可加的，记为 $u(r_{ij})$，压强可以按数密度 $\\rho = N/V$ 进行维里展开，形式为 $P/(k_{B}T) = \\rho + B_{2}(T)\\rho^{2} + B_{3}(T)\\rho^{3} + \\cdots$，其中 $k_{B}$ 是玻尔兹曼常数，$B_{n}(T)$ 是维里系数。考虑直径为 $\\sigma$ 的硬球这一特殊情况，其对势 $u(r)$ 由 $u(r) = +\\infty$（当 $r  \\sigma$）和 $u(r) = 0$（当 $r \\ge \\sigma$）给出。\n\n从经典正则系综和维里展开的第一性原理出发，推导该硬球气体的第二维里系数 $B_{2}(T)$ 的显式闭合表达式。你的推导应从构型积分和 Mayer $f$-函数 $f(r) = \\exp(-\\beta u(r)) - 1$（其中 $\\beta = 1/(k_{B}T)$）的定义开始，系统地进行，以获得一个可精确计算的三维积分。然后，根据排除体积效应解释你的结果，并说明所得到的 $B_{2}(T)$ 如何与范德华状态方程中单位摩尔的协体积参数 $b$ 相关联。\n\n最终答案仅用 $\\sigma$ 以闭合解析表达式表示。不需要数值计算，最终方框内的答案也无需提供单位。", "solution": "所述问题具有科学依据，提法恰当，并包含了进行严格推导所需的所有信息。这是统计热力学中的一个标准问题，我将着手解答。\n\n一个由 $N$ 个粒子组成的经典气体，在体积 $V$ 和温度 $T$ 下，其压强 $P$ 可通过维里展开按数密度 $\\rho = N/V$ 表示：\n$$ \\frac{P}{k_{B}T} = \\rho + B_{2}(T)\\rho^{2} + B_{3}(T)\\rho^{3} + \\cdots $$\n其中 $k_{B}$ 是玻尔兹曼常数，$B_{n}(T)$ 是依赖于温度的维里系数。第二维里系数 $B_{2}(T)$ 描述了由粒子间对相互作用引起的对理想气体行为的主导阶修正。根据正则系综中的集团展开理论，$B_{2}(T)$ 由对 Mayer $f$-函数的积分给出，该函数定义为 $f(r) = \\exp(-\\beta u(r)) - 1$，其中 $\\beta = 1/(k_{B}T)$，$u(r)$ 是对势。\n\n第二维里系数的一般表达式为：\n$$ B_{2}(T) = -\\frac{1}{2} \\int f(\\mathbf{r}) \\, d^{3}r $$\n此处，积分是对一对粒子的相对位置矢量 $\\mathbf{r}$ 进行的。对于球对称势 $u(r)$，其中 $r = |\\mathbf{r}|$，Mayer 函数 $f$ 也仅依赖于其大小 $r$。\n\n问题指定了硬球势，其形式如下：\n$$ u(r) = \\begin{cases} +\\infty  \\text{for } r  \\sigma \\\\ 0  \\text{for } r \\ge \\sigma \\end{cases} $$\n其中 $\\sigma$ 是硬球的直径。我们必须首先确定此势对应的 Mayer 函数 $f(r)$ 的形式。\n\n当 $r  \\sigma$ 时，势 $u(r) = +\\infty$。指数的自变量为 $-\\beta u(r) = -\\infty$。因此：\n$$ f(r) = \\exp(-\\infty) - 1 = 0 - 1 = -1 \\quad (\\text{for } r  \\sigma) $$\n当 $r \\ge \\sigma$ 时，势 $u(r) = 0$。指数的自变量为 $-\\beta u(r) = 0$。因此：\n$$ f(r) = \\exp(0) - 1 = 1 - 1 = 0 \\quad (\\text{for } r \\ge \\sigma) $$\n综合这两种情况，硬球气体的 Mayer 函数是一个简单的阶跃函数：\n$$ f(r) = \\begin{cases} -1  \\text{for } r  \\sigma \\\\ 0  \\text{for } r \\ge \\sigma \\end{cases} $$\n一个重要的结论是，硬球模型的 $f(r)$ 不依赖于温度 $T$，这意味着 $B_{2}$ 也将不依赖于温度。\n\n现在我们可以计算 $B_{2}(T)$ 的积分。我们将使用球坐标系下的体积元 $d^{3}r = r^{2}\\sin\\theta \\, dr \\, d\\theta \\, d\\phi$。\n$$ B_{2}(T) = -\\frac{1}{2} \\int_{0}^{2\\pi} d\\phi \\int_{0}^{\\pi} \\sin\\theta \\, d\\theta \\int_{0}^{\\infty} r^{2} f(r) \\, dr $$\n对角度 $\\phi$ 和 $\\theta$ 的积分分别得到 $2\\pi$ 和 $2$，总因子为 $4\\pi$。\n$$ B_{2}(T) = -\\frac{1}{2} (4\\pi) \\int_{0}^{\\infty} r^{2} f(r) \\, dr = -2\\pi \\int_{0}^{\\infty} r^{2} f(r) \\, dr $$\n接下来，我们代入 $f(r)$ 的分段定义：\n$$ \\int_{0}^{\\infty} r^{2} f(r) \\, dr = \\int_{0}^{\\sigma} r^{2} (-1) \\, dr + \\int_{\\sigma}^{\\infty} r^{2} (0) \\, dr $$\n第二个积分为零。第一个积分得出：\n$$ \\int_{0}^{\\sigma} -r^{2} \\, dr = -\\left[ \\frac{r^{3}}{3} \\right]_{0}^{\\sigma} = -\\left( \\frac{\\sigma^{3}}{3} - 0 \\right) = -\\frac{\\sigma^{3}}{3} $$\n将此结果代回 $B_{2}(T)$ 的表达式中：\n$$ B_{2}(T) = -2\\pi \\left( -\\frac{\\sigma^{3}}{3} \\right) = \\frac{2}{3}\\pi\\sigma^{3} $$\n这就是硬球气体第二维里系数的显式闭合表达式。正如所料，它是一个不依赖于温度的常数。\n\n至于物理解释，我们分析此结果的物理意义。$B_{2}$ 的正号表明相互作用的净效应是排斥性的，导致在相同密度和温度下，压强高于理想气体。这对于只经历排斥作用的硬球是符合预期的。量 $\\frac{4}{3}\\pi\\sigma^{3}$ 代表半径为 $\\sigma$ 的球的体积。这是由于另一个硬球的存在，对一个硬球中心所造成的“排除体积”。任何一个球的中心都不能进入以任何其他球为中心、半径为 $\\sigma$ 的球体内。\n系数 $B_{2}$ 等于一对粒子的这个排除体积的一半：\n$$ B_{2} = \\frac{1}{2} \\times \\left( \\text{Volume of sphere of radius } \\sigma \\right) = \\frac{1}{2} \\left(\\frac{4}{3}\\pi\\sigma^{3}\\right) $$\n因子 $1/2$ 源于 $B_{2}$ 的定义，该定义涉及对相互作用并避免了重复计数。\n将 $B_{2}$ 与单个粒子的体积 $v_{\\text{particle}} = \\frac{4}{3}\\pi (\\sigma/2)^{3} = \\frac{1}{6}\\pi\\sigma^{3}$ 联系起来也很有启发性。\n$$ B_{2} = \\frac{2}{3}\\pi\\sigma^{3} = 4 \\left( \\frac{1}{6}\\pi\\sigma^{3} \\right) = 4 v_{\\text{particle}} $$\n因此，硬球的第二维里系数是单个粒子体积的四倍。\n\n最后，我们将此结果与范德华状态方程联系起来，其单位摩尔形式为 $(P + a/V_{m}^{2})(V_{m}-b) = RT$。通过将此方程按摩尔体积的倒数 $1/V_{m}$（等效于密度）的幂次展开，可以发现范德华气体的第二维里系数为 $B_{2}^{\\text{vdW}}(T) = b - a/(RT)$。参数 $a$ 解释了吸引力，参数 $b$ 解释了粒子的有限尺寸，即“协体积”。硬球模型没有吸引力，这对应于设 $a=0$。因此，对于用范德华方程处理的硬球气体，我们应有 $B_{2} = b$。\n通过将我们的第一性原理结果与范德华模型进行比较，我们确定摩尔协体积参数 $b$ 为：\n$$ b = N_{A} B_{2} = N_{A} \\left( \\frac{2}{3}\\pi\\sigma^{3} \\right) = 4 \\left( N_{A} \\frac{1}{6}\\pi\\sigma^{3} \\right) $$\n其中 $N_{A}$ 是阿伏伽德罗常数。这表明范德华参数 $b$ 对应于一摩尔粒子总物理体积的四倍，这是统计力学的一个经典结果，并由本推导严格证实。", "answer": "$$ \\boxed{\\frac{2}{3}\\pi\\sigma^{3}} $$", "id": "2800866"}, {"introduction": "在掌握了纯排斥作用后，下一步是引入分子间的吸引力，这是真实气体行为的关键。方阱势模型通过在硬核外增加一个恒定深度的吸引势阱，为我们提供了一个可解析的框架来研究吸引与排斥的竞争。完成此练习将使你能够推导出与温度相关的第二维里系数 $B_2(T)$，并确定一个重要的物理量——玻意耳温度 $T_B$，在该温度下，气体宏观上的吸引与排斥效应相互抵消。[@problem_id:2800840]", "problem": "一种单原子流体由一个球对称对势建模，该势具有直径为 $\\sigma$ 的硬核和一个深度为 $\\epsilon$ 的吸引方势阱，势阱范围从 $r=\\sigma$ 到 $r=\\lambda \\sigma$，其中 $\\lambda1$ 且 $\\epsilon0$。从球对称对势的第二维里系数以 Mayer $f$-函数表示的定义出发，推导该方势阱流体依赖于温度的第二维里系数 $B_{2}(T)$ 的解析闭合形式表达式。然后，利用你的结果，用 $\\sigma$、$\\lambda$、$\\epsilon$ 和玻尔兹曼常数 $k_{B}$ 来确定玻意耳温度 $T_{B}$（即 $B_{2}(T)=0$ 时的温度），并说明当温度 $T$ 高于和低于 $T_{B}$ 时 $B_{2}(T)$ 的符号。\n\n将您的最终结果表示为 $B_{2}(T)$ 关于 $\\sigma$、$\\lambda$、$\\epsilon$、$k_{B}$ 和 $T$ 的单一闭合形式解析表达式。无需数值计算，也无需舍入。", "solution": "问题陈述经过验证。\n\n步骤1：提取已知条件。\n- 流体类型：单原子。\n- 对势 $u(r)$：球对称。\n- 硬核直径：$\\sigma$。\n- 势阱：方势阱形状，深度 $\\epsilon  0$。\n- 势阱范围：$r=\\sigma$ 到 $r=\\lambda \\sigma$，其中 $\\lambda  1$。\n- 任务1：推导第二维里系数 $B_{2}(T)$ 的解析闭合形式表达式。\n- 出发点：$B_2(T)$ 的 Mayer $f$-函数定义。\n- 任务2：确定玻意耳温度 $T_{B}$，定义为 $B_{2}(T_B)=0$。\n- 任务3：说明当温度高于和低于 $T_{B}$ 时 $B_{2}(T)$ 的符号。\n- 要求输出：$B_{2}(T)$ 的单一闭合形式解析表达式。\n\n步骤2：使用提取的已知条件进行验证。\n- **科学依据**：该问题植根于统计力学的既定原理，特别是真实气体状态方程的维里展开。方势阱势是理论化学和物理学中使用的、具有物理动机的标准模型势。所有概念——维里系数、Mayer 函数、玻意耳温度——都是基本且定义明确的。该问题在科学上是合理的。\n- **适定性**：势是分段明确定义的。任务是进行一次标准推导，该推导存在唯一的解析解。约束条件 $\\epsilon  0$ 和 $\\lambda  1$ 在物理上是必要的，并确保了有意义的结果。该问题是适定的。\n- **客观性**：该问题以精确、客观、技术性的语言陈述，没有任何主观性或含糊之处。\n\n步骤3：结论与行动。\n该问题是有效的，因为它在科学上合理、适定、客观且完整。将推导其解答。\n\n根据问题陈述，球对称方势阱势 $u(r)$ 定义为：\n$$\nu(r) = \\begin{cases}\n\\infty  \\text{for } r  \\sigma \\\\\n-\\epsilon  \\text{for } \\sigma \\le r \\le \\lambda\\sigma \\\\\n0  \\text{for } r  \\lambda\\sigma\n\\end{cases}\n$$\n对于球对称势，第二维里系数 $B_{2}(T)$ 由 Mayer $f$-函数 $f(r)$ 的积分给出：\n$$B_{2}(T) = -\\frac{1}{2} \\int_{0}^{\\infty} 4\\pi r^2 f(r) \\, dr$$\nMayer $f$-函数定义为：\n$$f(r) = \\exp\\left(-\\frac{u(r)}{k_{B}T}\\right) - 1$$\n其中 $k_{B}$ 是玻尔兹曼常数，$T$ 是绝对温度。\n\n我们必须计算势的三个区域中 $f(r)$ 的值：\n1.  对于 $r  \\sigma$，$u(r) = \\infty$。因此，$f(r) = \\exp\\left(-\\frac{\\infty}{k_{B}T}\\right) - 1 = 0 - 1 = -1$。\n2.  对于 $\\sigma \\le r \\le \\lambda\\sigma$，$u(r) = -\\epsilon$。因此，$f(r) = \\exp\\left(-\\frac{-\\epsilon}{k_{B}T}\\right) - 1 = \\exp\\left(\\frac{\\epsilon}{k_{B}T}\\right) - 1$。\n3.  对于 $r  \\lambda\\sigma$，$u(r) = 0$。因此，$f(r) = \\exp\\left(-\\frac{0}{k_{B}T}\\right) - 1 = 1 - 1 = 0$。\n\n现在，我们将 $f(r)$ 的这些分段表达式代入 $B_{2}(T)$ 的积分中。该积分被分成三个对应的区间：\n$$B_{2}(T) = -2\\pi \\left[ \\int_{0}^{\\sigma} r^2 f(r) \\, dr + \\int_{\\sigma}^{\\lambda\\sigma} r^2 f(r) \\, dr + \\int_{\\lambda\\sigma}^{\\infty} r^2 f(r) \\, dr \\right]$$\n第三个积分为零，因为对于 $r  \\lambda\\sigma$，$f(r)=0$。我们计算前两个积分：\n$$ \\int_{0}^{\\sigma} r^2 (-1) \\, dr = -\\left[\\frac{r^3}{3}\\right]_{0}^{\\sigma} = -\\frac{\\sigma^3}{3} $$\n$$ \\int_{\\sigma}^{\\lambda\\sigma} r^2 \\left(\\exp\\left(\\frac{\\epsilon}{k_{B}T}\\right) - 1\\right) \\, dr = \\left(\\exp\\left(\\frac{\\epsilon}{k_{B}T}\\right) - 1\\right) \\int_{\\sigma}^{\\lambda\\sigma} r^2 \\, dr $$\n$$ = \\left(\\exp\\left(\\frac{\\epsilon}{k_{B}T}\\right) - 1\\right) \\left[\\frac{r^3}{3}\\right]_{\\sigma}^{\\lambda\\sigma} = \\left(\\exp\\left(\\frac{\\epsilon}{k_{B}T}\\right) - 1\\right) \\left(\\frac{(\\lambda\\sigma)^3}{3} - \\frac{\\sigma^3}{3}\\right) $$\n$$ = \\left(\\exp\\left(\\frac{\\epsilon}{k_{B}T}\\right) - 1\\right) \\frac{\\sigma^3}{3} (\\lambda^3 - 1) $$\n结合这些结果：\n$$B_{2}(T) = -2\\pi \\left[ -\\frac{\\sigma^3}{3} + \\frac{\\sigma^3}{3}(\\lambda^3 - 1)\\left(\\exp\\left(\\frac{\\epsilon}{k_{B}T}\\right) - 1\\right) \\right]$$\n提出公因子 $\\frac{\\sigma^3}{3}$：\n$$B_{2}(T) = -\\frac{2\\pi\\sigma^3}{3} \\left[ -1 + (\\lambda^3 - 1)\\left(\\exp\\left(\\frac{\\epsilon}{k_{B}T}\\right) - 1\\right) \\right]$$\n$$B_{2}(T) = \\frac{2\\pi\\sigma^3}{3} \\left[ 1 - (\\lambda^3 - 1)\\left(\\exp\\left(\\frac{\\epsilon}{k_{B}T}\\right) - 1\\right) \\right]$$\n这就是第二维里系数 $B_{2}(T)$ 的最终闭合形式表达式。令 $b_{0} = \\frac{2\\pi\\sigma^3}{3}$ 为硬球气体的第二维里系数。则表达式为 $B_{2}(T) = b_{0} \\left[ 1 - (\\lambda^3-1)(\\exp(\\frac{\\epsilon}{k_{B}T})-1) \\right]$。\n\n接下来，我们求玻意耳温度 $T_{B}$，即 $B_{2}(T) = 0$ 时的温度。\n$$B_{2}(T_B) = \\frac{2\\pi\\sigma^3}{3} \\left[ 1 - (\\lambda^3 - 1)\\left(\\exp\\left(\\frac{\\epsilon}{k_{B}T_B}\\right) - 1\\right) \\right] = 0$$\n由于 $\\frac{2\\pi\\sigma^3}{3} \\neq 0$，方括号中的项必须为零：\n$$1 - (\\lambda^3 - 1)\\left(\\exp\\left(\\frac{\\epsilon}{k_{B}T_B}\\right) - 1\\right) = 0$$\n$$1 = (\\lambda^3 - 1)\\left(\\exp\\left(\\frac{\\epsilon}{k_{B}T_B}\\right) - 1\\right)$$\n$$\\frac{1}{\\lambda^3 - 1} = \\exp\\left(\\frac{\\epsilon}{k_{B}T_B}\\right) - 1$$\n$$\\exp\\left(\\frac{\\epsilon}{k_{B}T_B}\\right) = 1 + \\frac{1}{\\lambda^3 - 1} = \\frac{\\lambda^3 - 1 + 1}{\\lambda^3 - 1} = \\frac{\\lambda^3}{\\lambda^3 - 1}$$\n对两边取自然对数：\n$$\\frac{\\epsilon}{k_{B}T_B} = \\ln\\left(\\frac{\\lambda^3}{\\lambda^3 - 1}\\right)$$\n解出 $T_{B}$：\n$$T_{B} = \\frac{\\epsilon}{k_{B} \\ln\\left(\\frac{\\lambda^3}{\\lambda^3 - 1}\\right)}$$\n\n最后，我们确定 $B_{2}(T)$ 相对于 $T_{B}$ 的符号。函数 $B_{2}(T)$ 在 $T=T_B$ 時为零。为了找到它在其他地方的符号，我们考察它关于 $T$ 的导数。令 $g(T) = 1 - (\\lambda^3 - 1)\\left(\\exp\\left(\\frac{\\epsilon}{k_{B}T}\\right) - 1\\right)$。则 $B_2(T) = b_0 g(T)$。\n导数为：\n$$ \\frac{dg}{dT} = -(\\lambda^3 - 1) \\frac{d}{dT}\\exp\\left(\\frac{\\epsilon}{k_{B}T}\\right) = -(\\lambda^3 - 1) \\exp\\left(\\frac{\\epsilon}{k_{B}T}\\right) \\left(-\\frac{\\epsilon}{k_{B}T^2}\\right) = (\\lambda^3 - 1) \\frac{\\epsilon}{k_{B}T^2} \\exp\\left(\\frac{\\epsilon}{k_{B}T}\\right) $$\n已知 $\\lambda  1$，$\\epsilon  0$ 且 $k_{B}  0$，$\\frac{dg}{dT}$ 表达式中的每一项都为正。因此，对于所有 $T0$，$\\frac{dg}{dT}  0$。这意味着 $g(T)$是 $T$ 的单调递增函数。由于 $b_0  0$，$B_2(T)$ 也是 $T$ 的单调递增函数。\n由此，我们得出结论：\n-   对于 $T  T_{B}$，可得 $g(T)  g(T_B) = 0$，所以 $B_{2}(T)  0$。在高温下，排斥相互作用占主导地位。\n-   对于 $T  T_{B}$，可得 $g(T)  g(T_B) = 0$，所以 $B_{2}(T)  0$。在低温下，吸引相互作用占主导地位。\n这完成了问题的所有部分。所要求的最终答案是 $B_{2}(T)$ 的表达式。", "answer": "$$\n\\boxed{\\frac{2\\pi\\sigma^3}{3} \\left[ 1 - (\\lambda^3 - 1)\\left(\\exp\\left(\\frac{\\epsilon}{k_{B}T}\\right) - 1\\right) \\right]}\n$$", "id": "2800840"}, {"introduction": "前面的练习处理的是理想化的模型势，而 Lennard-Jones 势则为模拟真实非极性流体提供了一个更为精确的描述。然而，这种真实性也带来了挑战：其第二维里系数的积分无法解析求解，必须依赖数值方法。这项综合性练习不仅要求你推导出 $B_2^*(T^*)$ 的积分表达式，更关键的是要设计并实现一个稳健的数值积分算法，从而将理论分析与现代计算化学的实践技能紧密结合起来。[@problem_id:2800846]", "problem": "考虑一个经典单原子流体，其粒子在三维空间中通过各向同性对势相互作用。从稀薄气体的经典统计力学中第二维里系数 $B_2(T)$ 的定义出发，该定义以对构型积分的对贡献和 Mayer $f$-函数形式给出。对于 Lennard-Jones $12$–$6$ 势 $u(r)=4\\epsilon\\left[(\\sigma/r)^{12}-(\\sigma/r)^6\\right]$，完成以下任务：\n\n1) 在约化变量下，推导专门针对 Lennard-Jones $12$–$6$ 势的第二维里系数 $B_2(T)$ 的显式一维积分表达式。你的推导必须从基于 Mayer $f$-函数的维里展开的基本定义开始（不允许其他起点），并最终得到一个仅对径向坐标积分的表达式。然后，通过引入约化温度 $T^\\ast = k_{\\mathrm{B}}T/\\epsilon$ 和约化距离 $x=r/\\sigma$ 对积分进行无量綱化，并定义约化第二维里系数 $B_2^\\ast(T^\\ast) \\equiv B_2(T)/\\sigma^3$，以使最终积分为无量綱。\n\n2) 提出一种鲁棒且系统精确的数值求积策略来计算推导出的 $B_2^\\ast(T^\\ast)$ 积分。你的策略必须：\n- 证明对 $x$ 的半无限域选择积分限的合理性。\n- 处理被积函数在 $x\\to 0$ 和 $x\\to \\infty$ 时的行为。\n- 包含至少一种可靠性增强措施，如区间分割、特殊点插入、变量变换、渐近尾部修正或严格误差控制。\n- 给出一个可以使用标准科学计算库在软件中直接实现的具体算法。\n\n3) 将你提出的算法实现为一个完整的可运行程序，用于计算以下约化温度测试组的 $B_2^\\ast(T^\\ast)$：\n- $T^\\ast = 0.5$（强吸引效应），\n- $T^\\ast = 1.0$（中等温度），\n- $T^\\ast = 2.0$（较暖气体），\n- $T^\\ast = 3.417$（接近 Lennard-Jones $12$–$6$ 模型的玻意耳温度），\n- $T^\\ast = 10.0$（高温），\n- $T^\\ast = 100.0$（渐近高温）。\n\n你必须计算并报告每个 $T^\\ast$ 值对应的约化第二维里系数 $B_2^\\ast(T^\\ast)$。由于该量是约化量，它是无量綱的；因此不需要物理单位。你的程序应將每个数值结果四舍五入到 $8$ 位小数。\n\n最终输出格式：你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表的结果（例如，“[result1,result2,result3,result4,result5,result6]”），顺序与上述测试组相同。每个结果都必须是四舍五入到 $8$ 位小数的浮点数。", "solution": "所述问题已经过验证，被认为是科学上可靠、定义明确且客观的。它代表了统计力学和数值分析领域一个标准的、非平凡的练习。所有必要的物理模型、定义和参数都已提供，并且没有内部矛盾或违反基本原则的情况。因此，该问题被判定为 **有效**，下面提供了完整的解答。\n\n任务是推导并数值计算由 Lennard-Jones $12$–$6$ 势控制的流体的约化第二维里系数 $B_2^*(T^*)$。这将按要求分三部分进行：推导、数值策略的制定和实现。\n\n**第一部分：$B_2^*(T^*)$ 积分的推导**\n\n对于具有成对相加势 $u(r)$ 的经典单原子流体，物态方程维里展开式 $P/(Nk_B T) = 1 + B_2(T)/V + ...$ 中的第二维里系数 $B_2(T)$ 由涉及两个粒子的构型积分给出。在 Mayer 簇理论的框架下，这表示为 Mayer $f$-函数 $f_{12} = f(r_{12})$ 的形式，其中 $r_{12}$ 是粒子 $1$ 和 $2$ 之间的距离。\n\n$B_2(T)$ 的定义是：\n$$\nB_2(T) = -\\frac{1}{2} \\int f(\\mathbf{r}) d\\mathbf{r}\n$$\n其中积分是对两个粒子的相对位置矢量 $\\mathbf{r}$ 在整个空间上进行的。Mayer 函数定义为：\n$$\nf(r) = e^{-\\beta u(r)} - 1\n$$\n这里，$\\beta = (k_B T)^{-1}$，其中 $k_B$ 是 Boltzmann 常数，$T$ 是绝对温度。由于势 $u(r)$ 被指定为各向同性，Mayer 函数 $f(r)$ 也是各向同性的。这允许通过转换为球极坐标来简化三维积分。体积元为 $d\\mathbf{r} = 4\\pi r^2 dr$。\n\n将球体积元代入 $B_2(T)$ 的表达式中，得到：\n$$\nB_2(T) = -\\frac{1}{2} \\int_0^\\infty f(r) (4\\pi r^2) dr = -2\\pi \\int_0^\\infty r^2 \\left[ e^{-\\beta u(r)} - 1 \\right] dr\n$$\n这是适用于任何各向同性对势的第二维里系数的一般一维积分。\n\n我们现在将其特化为 Lennard-Jones $12$–$6$ 势：\n$$\nu(r) = 4\\epsilon \\left[ \\left(\\frac{\\sigma}{r}\\right)^{12} - \\left(\\frac{\\sigma}{r}\\right)^6 \\right]\n$$\n其中 $\\epsilon$ 是势阱的深度，$\\sigma$ 是粒子间势为零时的有限距离。\n\n为了对表达式进行无量綱化，我们引入指定的约化变量：\n- 约化距离: $x = r/\\sigma \\implies r = x\\sigma$ 且 $dr = \\sigma dx$。\n- 约化温度: $T^* = k_B T / \\epsilon \\implies \\beta = (k_B T)^{-1} = (\\epsilon T^*)^{-1}$。\n\n指数的宗量 $\\beta u(r)$ 变为：\n$$\n\\beta u(r) = \\frac{1}{\\epsilon T^*} \\cdot 4\\epsilon \\left[ \\left(\\frac{\\sigma}{x\\sigma}\\right)^{12} - \\left(\\frac{\\sigma}{x\\sigma}\\right)^6 \\right] = \\frac{4}{T^*} \\left( x^{-12} - x^{-6} \\right)\n$$\n将这些约化量代入 $B_2(T)$ 的积分中：\n$$\nB_2(T) = -2\\pi \\int_0^\\infty (x\\sigma)^2 \\left[ \\exp\\left(-\\frac{4}{T^*}(x^{-12} - x^{-6})\\right) - 1 \\right] (\\sigma dx)\n$$\n$$\nB_2(T) = -2\\pi\\sigma^3 \\int_0^\\infty x^2 \\left[ \\exp\\left(-\\frac{4}{T^*}(x^{-12} - x^{-6})\\right) - 1 \\right] dx\n$$\n问题将约化第二维里系数定义为 $B_2^*(T^*) = B_2(T)/\\sigma^3$。两边同除以 $\\sigma^3$，我们得到最终的无量纲积分表达式：\n$$\nB_2^*(T^*) = -2\\pi \\int_0^\\infty x^2 \\left[ \\exp\\left(-\\frac{4}{T^*}(x^{-12} - x^{-6})\\right) - 1 \\right] dx\n$$\n至此完成了所要求的推导。\n\n**第二部分：数值求积策略**\n\n$B_2^*(T^*)$ 的积分必须进行数值计算。一个鲁棒的策略需要仔细分析被积函数，我们将其定义为 $I(x; T^*) = x^2 \\left[ \\exp\\left(-\\frac{4}{T^*}(x^{-12} - x^{-6})\\right) - 1 \\right]$。\n\n1.  **被积函数分析：**\n    -   当 $x \\to 0$ 时，$x^{-12}$ 项在势中占主导，因此 $u(x) \\to +\\infty$。指数的宗量 $-\\beta u(x)$ 趨向于 $-\\infty$，导致 $\\exp(-\\beta u(x)) \\to 0$。因此被积函数的行为如同 $I(x; T^*) \\to x^2(0 - 1) = -x^2$。这是一个在原点附近表现良好的二次函数，对标准求积程序不构成困难。\n    -   当 $x \\to \\infty$ 时，势 $u(x) \\to 0$。指数的宗量变小。对于小的 $z = -\\beta u(x)$，我们可以使用泰勒级数展开 $e^z - 1 \\approx z + z^2/2$。对于大的 $x$，$z = \\frac{4}{T^*}(x^{-6} - x^{-12}) \\approx \\frac{4}{T^*}x^{-6}$。被积函数有一个按幂律衰减的长程尾部，这使得直接截断积分域效率低下。\n\n2.  **求积方法与可靠性增强：**\n    -   积分域是半无限的 $[0, \\infty)$。直接的数值方法需要将其截断为 $[0, X_{max}]$。由于被积函数衰减缓慢（如同 $x^{-4}$），简单的截断会导致显著的误差。\n    -   一个更优的策略是在一个有限的截断点 $X_{max}$ 处分割积分：\n        $$\n        \\int_0^\\infty I(x; T^*) dx = \\int_0^{X_{max}} I(x; T^*) dx + \\int_{X_{max}}^\\infty I(x; T^*) dx\n        $$\n    -   第一部分，从 $0$ 到 $X_{max}$，使用高质量的自适应求积算法计算，例如 `scipy.integrate.quad` 中实现的算法。\n    -   第二部分，即“尾部”，通过使用大 $x$ 下被积函数的渐近展开来解析计算。\n        设 $z(x) = \\frac{4}{T^*}(x^{-6} - x^{-12})$。对于大 $x$，$z(x)$ 很小。\n        $$\n        e^{z(x)} - 1 = z(x) + \\frac{z(x)^2}{2} + O(z(x)^3)\n        $$\n        $z(x)^2 = \\left(\\frac{4}{T^*}\\right)^2(x^{-6} - x^{-12})^2 = \\left(\\frac{4}{T^*}\\right)^2(x^{-12} - 2x^{-18} + x^{-24})$。\n        保留与 $x^2$ 相乘后会得到 $x^{-10}$ 或更高次幂的项：\n        $$\n        I(x; T^*) \\approx x^2 \\left[ \\frac{4}{T^*}(x^{-6} - x^{-12}) + \\frac{1}{2}\\left(\\frac{4}{T^*}\\right)^2 x^{-12} \\right] = \\frac{4}{T^*}x^{-4} + \\left(\\frac{8}{(T^*)^2} - \\frac{4}{T^*}\\right)x^{-10}\n        $$\n        尾部的解析积分是：\n        $$\n        \\int_{X_{max}}^\\infty I(x; T^*) dx \\approx \\int_{X_{max}}^\\infty \\left[ \\frac{4}{T^*}x^{-4} + \\left(\\frac{8}{(T^*)^2} - \\frac{4}{T^*}\\right)x^{-10} \\right] dx\n        $$\n        $$\n        = \\left[ \\frac{4}{T^*} \\frac{x^{-3}}{-3} + \\left(\\frac{8}{(T^*)^2} - \\frac{4}{T^*}\\right) \\frac{x^{-9}}{-9} \\right]_{X_{max}}^\\infty = \\frac{4}{3T^*}X_{max}^{-3} + \\frac{1}{9}\\left(\\frac{8}{(T^*)^2} - \\frac{4}{T^*}\\right)X_{max}^{-9}\n        $$\n        这种渐近尾部修正极大地提高了准确性，允许使用一个适中的 $X_{max}$ 值。选择 $X_{max} = 20.0$ 足以确保被忽略的高阶项（以 $x^{-16}$ 衰减）远低于 $10^{-8}$ 的目标精度。\n\n3.  **具体算法：**\n    对于每个给定的约化温度 $T^*$：\n    a.  定义被积函数 $I(x;T^*) = x^2 \\left[ \\exp\\left(-\\frac{4}{T^*}(x^{-12} - x^{-6})\\right) - 1 \\right]$。在数值上，使用像 `numpy.expm1(y)` 这样能精确计算 $e^y-1$ 的库函数是有利的。\n    b.  设置积分截断点 $X_{max} = 20.0$。\n    c.  使用可靠的求积程序（`scipy.integrate.quad`）计算積分的数值部分 $J_{num} = \\int_0^{X_{max}} I(x; T^*) dx$。\n    d.  计算解析尾部修正 $J_{tail} = \\frac{4}{3T^*}X_{max}^{-3} + \\frac{1}{9}\\left(\\frac{8}{(T^*)^2} - \\frac{4}{T^*}\\right)X_{max}^{-9}$。\n    e.  总积分为 $J_{total} = J_{num} + J_{tail}$。\n    f.  约化第二维里系数为 $B_2^*(T^*) = -2\\pi J_{total}$。\n    g.  按要求将最终结果四舍五入到 8 位小数。\n\n该算法鲁棒、系统精确，并且可以使用标准科学计算库直接实现。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import quad\n\ndef solve():\n    \"\"\"\n    Calculates the reduced second virial coefficient B2*(T*) for the \n    Lennard-Jones 12-6 potential for a given set of reduced temperatures T*.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        0.5,      # strong attractive effects\n        1.0,      # moderate temperature\n        2.0,      # warmer gas\n        3.417,    # near the Boyle temperature\n        10.0,     # high temperature\n        100.0     # asymptotically high temperature\n    ]\n\n    results = []\n    \n    # Set the cutoff for the numerical part of the integration.\n    # A value of 20.0 is sufficient for the required precision when using\n    # the analytical tail correction.\n    X_max = 20.0\n\n    for T_star in test_cases:\n        # Define the integrand for B2*. The formula is derived from:\n        # B2* = -2*pi * Integral[x^2 * (exp(-u*(x)/T*) - 1), {x, 0, inf}]\n        # where u*(x) = 4 * (x**-12 - x**-6).\n        # We use np.expm1(y) for stable computation of exp(y) - 1.\n        def integrand(x, T_s):\n            # Argument for the exponential function\n            # The potential is u(x) = 4*eps*( (sig/r)^12 - (sig/r)^6 )\n            # The reduced argument is -u(x)/(k_B*T) = - (4/T*) * (x^-12 - x^-6)\n            u_star_over_T_star_arg = (4.0 / T_s) * (x**-12 - x**-6)\n            return x**2 * np.expm1(-u_star_over_T_star_arg)\n\n        # 1. Compute the integral numerically from 0 to X_max.\n        #    scipy.integrate.quad is a robust adaptive quadrature routine.\n        numerical_integral, _ = quad(integrand, 0, X_max, args=(T_star,))\n\n        # 2. Compute the analytical tail correction for the integral from X_max to infinity.\n        #    The formula is derived from a Taylor expansion of the integrand for large x.\n        #    Tail Integral approx. Integral[ (4/T*)x^-4 + (8/T*^2 - 4/T*)x^-10, {x, X_max, inf}]\n        inv_X_max_3 = X_max**-3.0\n        inv_X_max_9 = X_max**-9.0\n        \n        # Term arising from the x^-4 part of the asymptotic integrand\n        tail_term1 = (4.0 / (3.0 * T_star)) * inv_X_max_3\n        # Term arising from the x^-10 part of the asymptotic integrand\n        tail_term2 = (1.0 / 9.0) * (8.0 / (T_star**2.0) - 4.0 / T_star) * inv_X_max_9\n        \n        analytical_tail = tail_term1 + tail_term2\n\n        # 3. Sum the numerical integral and the analytical tail.\n        total_integral = numerical_integral + analytical_tail\n\n        # 4. Calculate the reduced second virial coefficient.\n        b2_star = -2.0 * np.pi * total_integral\n        \n        # Append the rounded result to the list.\n        results.append(round(b2_star, 8))\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2800846"}]}