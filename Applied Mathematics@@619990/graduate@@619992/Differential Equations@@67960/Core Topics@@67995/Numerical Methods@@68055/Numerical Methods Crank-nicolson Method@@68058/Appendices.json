{"hands_on_practices": [{"introduction": "A crucial property of physical processes like heat diffusion is the maximum principle, which states that extreme temperatures occur only at the initial time or at the boundaries of the domain. It is highly desirable for a numerical method to preserve a discrete version of this principle, ensuring that the simulation does not generate unphysical oscillations. This practice guides you through deriving a condition on the mesh Fourier number, $r$, that guarantees the Crank-Nicolson scheme produces a non-oscillatory solution, providing a fundamental guideline for stable simulations. [@problem_id:1126299]", "problem": "The one-dimensional heat equation is given by $u_t = \\alpha u_{xx}$, where $u(x, t)$ is the temperature at position $x$ and time $t$, and $\\alpha > 0$ is the thermal diffusivity. A common numerical scheme for solving this equation is the Crank-Nicolson method. Using a uniform spatial grid with spacing $\\Delta x$ and a time step $\\Delta t$, we denote the numerical approximation of the solution as $u_j^n \\approx u(x_j, t_n)$, where $x_j = j \\Delta x$ and $t_n = n \\Delta t$.\n\nThe Crank-Nicolson discretization is given by:\n$$\n\\frac{u_j^{n+1} - u_j^n}{\\Delta t} = \\frac{\\alpha}{2} \\left( \\frac{u_{j+1}^{n+1} - 2u_j^{n+1} + u_{j-1}^{n+1}}{\\Delta x^2} + \\frac{u_{j+1}^n - 2u_j^n + u_{j-1}^n}{\\Delta x^2} \\right)\n$$\n\nThe continuous heat equation satisfies a maximum principle, which states that the maximum temperature in a given space-time domain is found on its boundaries (either at the initial time or at the spatial boundaries). A desirable property for a numerical scheme is to satisfy a discrete version of this principle. A sufficient condition for the discrete maximum principle is that the solution at a new time step, $u_j^{n+1}$, can be expressed as a linear combination of the solutions at the previous time step, $\\{u_k^n\\}$, with all non-negative coefficients.\n\nLet the mesh Fourier number be defined as $r = \\frac{\\alpha \\Delta t}{\\Delta x^2}$. Derive the maximum value of $r$ for which the Crank-Nicolson scheme satisfies this sufficient condition for the discrete maximum principle, ensuring non-oscillatory solutions.", "solution": "We write the Crank-Nicolson update in operator form. Let $L$ be the second-difference operator\n$$ (Lu)_j = u_{j-1}-2u_j+u_{j+1},$$\nand set $r=\\alpha\\Delta t/\\Delta x^2$. Then the discretization\n$$\\frac{u^{n+1}-u^n}{\\Delta t}\n=\\frac{\\alpha}{2\\Delta x^2}\\bigl(Lu^{n+1}+Lu^n\\bigr)$$\nbecomes\n$$\\Bigl(I-\\frac{r}{2}L\\Bigr)u^{n+1}\n=\\Bigl(I+\\frac{r}{2}L\\Bigr)u^n\\,. $$\nDefine the tridiagonal matrix\n$$A=I-\\frac{r}{2}L\n=\\mathrm{tridiag}\\bigl(-\\tfrac r2,\\;1+r,\\;-\\tfrac r2\\bigr)\\,,\\qquad\nB=I+\\frac{r}{2}L\\,. $$\nOn the right-hand side,\n$Bu^n$ has entries\n$$(Bu^n)_j\n=u_j^n+\\frac r2\\,(u_{j-1}^n-2u_j^n+u_{j+1}^n)\n=(1-r)\\,u_j^n+\\frac r2\\,\\bigl(u_{j-1}^n+u_{j+1}^n\\bigr)\\,. $$\nPositivity of these coefficients requires $1-r \\ge 0$, which implies $r \\le 1$.\nMeanwhile $A$ is strictly diagonally dominant,\n$$1+r > r\\,, $$\nhence an $M$-matrix with $A^{-1}\\ge0$. Thus for $r\\le1$,\n$$u^{n+1}=A^{-1}B\\,u^n$$\nis a nonnegative combination of the $u^n$ and the discrete maximum principle holds.\nThe largest admissible $r$ is\n$$r=1\\,. $$", "answer": "$$\\boxed{1}$$", "id": "1126299"}, {"introduction": "The Crank-Nicolson method is an \"implicit\" scheme, meaning that calculating the solution at the next time step involves solving a system of linear equations. This exercise demystifies this process by reducing the problem to its simplest non-trivial form: a 1D grid with just two interior points. By explicitly constructing and inverting the $2 \\times 2$ matrix for this system, you will gain a concrete understanding of how the implicit formulation couples the unknown future values together. [@problem_id:1126497]", "problem": "Consider the one-dimensional heat equation,\n$$\n\\frac{\\partial u}{\\partial t} = \\alpha \\frac{\\partial^2 u}{\\partial x^2}\n$$\nfor a function $u(x,t)$ on the domain $x \\in [0, L]$ and $t \\ge 0$. The constant $\\alpha$ is the thermal diffusivity. The domain is subjected to homogeneous Dirichlet boundary conditions, $u(0,t)=0$ and $u(L,t)=0$.\n\nThe spatial domain is discretized into three equal segments, creating grid points $x_j = j \\Delta x$ for $j=0, 1, 2, 3$, where $\\Delta x = L/3$. This setup results in two interior grid points at $j=1$ and $j=2$. The time domain is discretized with a uniform time step $\\Delta t$. We denote the numerical approximation of $u(x_j, t_n)$ as $u_j^n$.\n\nThe Crank-Nicolson method is used to discretize the heat equation. This scheme approximates the time derivative with a forward difference and the spatial derivative with the average of central differences at time levels $n$ and $n+1$:\n$$\n\\frac{u_j^{n+1} - u_j^n}{\\Delta t} = \\frac{\\alpha}{2} \\left( \\frac{u_{j+1}^{n+1} - 2u_j^{n+1} + u_{j-1}^{n+1}}{(\\Delta x)^2} + \\frac{u_{j+1}^n - 2u_j^n + u_{j-1}^n}{(\\Delta x)^2} \\right)\n$$\nThis leads to a system of linear equations for the unknown temperatures at the next time step, which can be written in the matrix form $A \\mathbf{u}^{n+1} = \\mathbf{d}^n$, where $\\mathbf{u}^{n+1} = [u_{1}^{n+1}, u_{2}^{n+1}]^T$ is the vector of temperatures at the two interior points at time step $n+1$, and $A$ is a $2 \\times 2$ matrix.\n\nLet $r = \\frac{\\alpha \\Delta t}{(\\Delta x)^2}$ be the dimensionless mesh ratio. Derive an expression for the top-left element of the inverse matrix, $(A^{-1})_{11}$, as a function of $r$.", "solution": "We apply the Crank-Nicolson scheme at the two interior nodes $j=1, 2$ with $u_0=u_3=0$ and $r=\\frac{\\alpha \\Delta t}{(\\Delta x)^2}$.\n\nFor $j=1$:\n$$\n\\frac{u_1^{n+1}-u_1^n}{\\Delta t}\n=\\frac{\\alpha}{2(\\Delta x)^2}\\Bigl[(u_2^{n+1}-2u_1^{n+1}+u_0^{n+1})+(u_2^n-2u_1^n+u_0^n)\\Bigr],\n$$\nwhich simplifies to\n$$\n(1+r)u_1^{n+1}-\\tfrac r2\\,u_2^{n+1}\n=(1-r)u_1^n+\\tfrac r2\\,u_2^n.\n$$\n\nFor $j=2$ similarly,\n$$\n-\\tfrac r2\\,u_1^{n+1}+(1+r)u_2^{n+1}\n=\\tfrac r2\\,u_1^n+(1-r)u_2^n.\n$$\n\nThus the matrix system is\n$$\nA=\\begin{pmatrix}1+r&-\\tfrac r2\\\\-\\tfrac r2&1+r\\end{pmatrix},\n\\quad\n\\Delta=\\det A=(1+r)^2-\\tfrac{r^2}{4}=1+2r+\\tfrac{3r^2}{4}.\n$$\n\nThe inverse is\n$$\nA^{-1}=\\frac1\\Delta\\begin{pmatrix}1+r&\\tfrac r2\\\\\\tfrac r2&1+r\\end{pmatrix},\n$$\n\nso the $(1,1)$ entry is\n$$\n(A^{-1})_{11}=\\frac{1+r}{1+2r+\\tfrac{3r^2}{4}}.\n$$", "answer": "$$\\boxed{\\frac{1+r}{1+2r+\\tfrac{3r^2}{4}}}$$", "id": "1126497"}, {"introduction": "While fixed-value (Dirichlet) boundary conditions are common, many physical systems involve specifying a flux, such as the rate of heat flow, which corresponds to a Neumann boundary condition. This exercise demonstrates how to accurately incorporate such a condition into the Crank-Nicolson framework. You will use the \"ghost point\" technique, a standard and powerful method for preserving the scheme's accuracy at the boundary, and derive the terms that contribute to the known right-hand side of the linear system. [@problem_id:1126336]", "problem": "Consider the one-dimensional heat equation for a function $u(x,t)$, given by:\n$$\n\\frac{\\partial u}{\\partial t} = \\alpha \\frac{\\partial^2 u}{\\partial x^2}\n$$\nThe equation is defined on the spatial domain $x \\in [0, L]$ and for time $t \\ge 0$. The boundary conditions are a Dirichlet condition at $x=0$, $u(0,t) = 0$, and a time-dependent Neumann condition at $x=L$:\n$$\n\\frac{\\partial u}{\\partial x}(L,t) = g(t)\n$$\nwhere $g(t)$ is a known function.\n\nWe wish to solve this problem numerically using the Crank-Nicolson method. The domain is discretized with uniform spacing $\\Delta x$ in space and $\\Delta t$ in time, such that $x_j = j\\Delta x$ for $j=0, 1, \\dots, N$ (with $N\\Delta x = L$) and $t_n = n\\Delta t$. Let $u_j^n$ denote the numerical approximation of $u(x_j, t_n)$.\n\nThe Crank-Nicolson scheme for an interior point is given by:\n$$\n\\frac{u_j^{n+1} - u_j^n}{\\Delta t} = \\frac{\\alpha}{2} \\left( \\frac{u_{j+1}^n - 2u_j^n + u_{j-1}^n}{(\\Delta x)^2} + \\frac{u_{j+1}^{n+1} - 2u_j^{n+1} + u_{j-1}^{n+1}}{(\\Delta x)^2} \\right)\n$$\nTo handle the Neumann boundary condition at $j=N$, a second-order accurate central difference approximation is used. This requires introducing a \"ghost point\" $u_{N+1}$ at $x_{N+1} = L+\\Delta x$. The discrete form of the Neumann condition is evaluated at the average time $(t_n + t_{n+1})/2$, which corresponds to the Crank-Nicolson scheme's time-centering. However, for simplicity in setting up the linear system, we will apply the central difference at both time levels $n$ and $n+1$ separately and use these to eliminate the ghost point from the main scheme.\n\nThe resulting system of linear equations for the unknown values $\\mathbf{u}^{n+1} = (u_1^{n+1}, \\dots, u_N^{n+1})^T$ is written in the matrix form $A\\mathbf{u}^{n+1} = \\mathbf{d}$, where the vector $\\mathbf{d}$ contains all terms evaluated at the known time level $n$, as well as source terms from the boundary conditions.\n\nYour task is to derive the complete right-hand side of the discrete equation for the boundary node $j=N$. This corresponds to the last entry in the vector $\\mathbf{d}$. Express your answer in terms of $u_N^n$, $u_{N-1}^n$, $\\Delta x$, $g^n = g(t_n)$, $g^{n+1} = g(t_{n+1})$, and the dimensionless parameter $r = \\frac{\\alpha \\Delta t}{(\\Delta x)^2}$.", "solution": "1. Discrete Crank-Nicolson at $j=N$:\n\n$$\n\\frac{u_N^{n+1}-u_N^n}{\\Delta t}\n=\\frac{\\alpha}{2(\\Delta x)^2}\\Bigl[(u_{N+1}^n-2u_N^n+u_{N-1}^n)+(u_{N+1}^{n+1}-2u_N^{n+1}+u_{N-1}^{n+1})\\Bigr].\n$$\n\n2. Multiply by $\\Delta t$ and use $r=\\frac{\\alpha\\,\\Delta t}{(\\Delta x)^2}$:\n\n$$\nu_N^{n+1}-u_N^n\n=\\frac{r}{2}\\bigl[(u_{N+1}^n-2u_N^n+u_{N-1}^n)+(u_{N+1}^{n+1}-2u_N^{n+1}+u_{N-1}^{n+1})\\bigr].\n$$\n\n3. Ghost-point via Neumann BC:\n\n$$\nu_{N+1}^n=u_{N-1}^n+2\\Delta x\\,g^n,\\quad\nu_{N+1}^{n+1}=u_{N-1}^{n+1}+2\\Delta x\\,g^{n+1}.\n$$\n\n4. Substitute into the scheme:\n\n$$\n\\begin{aligned}\nu_N^{n+1}-u_N^n\n&=\\tfrac{r}{2}\\bigl[2(u_{N-1}^n-u_N^n+\\Delta x\\,g^n)\n+2(u_{N-1}^{n+1}-u_N^{n+1}+\\Delta x\\,g^{n+1})\\bigr]\\\\\n&=r\\bigl[u_{N-1}^n-u_N^n+u_{N-1}^{n+1}-u_N^{n+1}+\\Delta x\\,(g^n+g^{n+1})\\bigr].\n\\end{aligned}\n$$\n\n5. Collect unknowns $u^{n+1}$ on the left:\n\n$$\nu_N^{n+1}+r\\,u_N^{n+1}-r\\,u_{N-1}^{n+1}\n=(1-r)u_N^n+r\\,u_{N-1}^n +r\\,\\Delta x\\,(g^n+g^{n+1}).\n$$\n\n6. In matrix form $A\\,\\mathbf u^{n+1}=\\mathbf d$, the last entry of $\\mathbf d$ is the right-hand side of the equation above:\n\n$$\nd_N=(1-r)\\,u_N^n + r\\,u_{N-1}^n + r\\,\\Delta x\\bigl(g^n+g^{n+1}\\bigr).\n$$", "answer": "$$\\boxed{(1-r)\\,u_N^n + r\\,u_{N-1}^n + r\\,\\Delta x\\,(g^n + g^{n+1})}$$", "id": "1126336"}]}