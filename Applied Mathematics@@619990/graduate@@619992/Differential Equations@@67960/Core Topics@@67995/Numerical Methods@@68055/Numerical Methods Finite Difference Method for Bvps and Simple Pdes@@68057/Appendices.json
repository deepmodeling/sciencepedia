{"hands_on_practices": [{"introduction": "The one-dimensional wave equation is a fundamental hyperbolic partial differential equation that describes phenomena from vibrating strings to propagating light waves. This exercise provides hands-on practice with the explicit central-difference method, a common approach for simulating such time-dependent problems. By manually calculating the solution's evolution over the first few time steps, you will gain a concrete understanding of how initial conditions are incorporated and how the numerical scheme propagates information across the grid [@problem_id:1127264].", "problem": "Consider the one-dimensional linear wave equation for a function $u(x,t)$, given by:\n$$\n\\frac{\\partial^2 u}{\\partial t^2} = c^2 \\frac{\\partial^2 u}{\\partial x^2}\n$$\nThe system is defined on a spatial domain $x \\in [0, L]$ for time $t \\ge 0$. The wave speed is a constant $c$.\n\nThe boundary conditions are homogeneous Dirichlet conditions:\n$$\nu(0, t) = 0 \\quad \\text{and} \\quad u(L, t) = 0 \\quad \\text{for all } t \\ge 0\n$$\n\nThe initial conditions at $t=0$ are given by:\n1.  Initial displacement: $u(x, 0) = A \\sin\\left(\\frac{\\pi x}{L}\\right)$\n2.  Initial velocity: $\\frac{\\partial u}{\\partial t}(x, 0) = B \\sin\\left(\\frac{2\\pi x}{L}\\right)$\n\nHere, $A$ and $B$ are constants representing the initial amplitude and velocity scaling, respectively.\n\nTo solve this problem numerically, the spatial domain is discretized into $N_x=4$ equal intervals, with grid spacing $\\Delta x = L/N_x$. The time domain is discretized with a constant time step $\\Delta t$. The numerical approximation of $u(x_j, t_n)$ is denoted by $u_j^n$, where $x_j = j \\Delta x$ and $t_n = n \\Delta t$.\n\nThe standard explicit finite difference method is employed. This method uses a second-order accurate central difference approximation for both the spatial and temporal second derivatives.\n$$\n\\frac{u_j^{n+1} - 2u_j^n + u_j^{n-1}}{(\\Delta t)^2} = c^2 \\frac{u_{j+1}^n - 2u_j^n + u_{j-1}^n}{(\\Delta x)^2}\n$$\nThe initial velocity condition is also approximated using a second-order accurate central difference, which involves a fictitious point at $t = -\\Delta t$.\n\nThe Courant number, $\\sigma = \\frac{c \\Delta t}{\\Delta x}$, is a key parameter of the simulation.\n\n**Task:**\nDetermine the numerical approximation of the displacement at the spatial midpoint of the domain, $x = L/2$, after two full time steps, i.e., at $t = 2\\Delta t$. Express your answer in terms of the initial amplitude $A$ and the Courant number $\\sigma$.", "solution": "1. Initial data at midpoint j=2:\n   u₂⁰ = A sin(π·2/4)=A, g₂=B sin(2π·2/4)=0.\n2. First time level:\n   $$u₂¹ = u₂⁰ + \\frac{\\sigma^2}{2}\\bigl(u₃⁰ -2u₂⁰ +u₁⁰\\bigr)\n          = A + \\frac{\\sigma^2}{2}A(\\sqrt2 -2).$$\n3. General update:\n   $$u_j^{n+1}=2u_j^n -u_j^{n-1}+\\sigma^2(u_{j+1}^n -2u_j^n +u_{j-1}^n).$$\n4. At j=2,n=1:\n   $$u₂²=2u₂¹ -u₂⁰ +\\sigma^2\\bigl(u₃¹ -2u₂¹ +u₁¹\\bigr).$$\n5. By symmetry u₁¹+u₃¹ yields no B-term, and one finds\n   $$u₂² = A +2\\sigma^2 A(\\sqrt2 -2) +\\sigma^4 A(3-2\\sqrt2).$$", "answer": "$$\\boxed{A\\bigl[1+(2\\sqrt2-4)\\sigma^2+(3-2\\sqrt2)\\sigma^4\\bigr]}$$", "id": "1127264"}, {"introduction": "Moving from time-dependent to steady-state problems, we encounter the advection-diffusion equation, which is crucial in modeling transport phenomena in fluids and heat transfer. This problem highlights a key challenge in numerical methods: ensuring stability when one physical process, like advection, dominates another, like diffusion. You will apply a first-order upwind scheme for the advection term, a robust technique essential for obtaining physically realistic solutions in such scenarios, and combine it with a central difference scheme for the diffusion term [@problem_id:1127421].", "problem": "Consider the one-dimensional steady-state advection-diffusion equation on the domain $x \\in [0, L]$:\n$$\nu \\frac{d\\phi}{dx} - \\Gamma \\frac{d^2\\phi}{dx^2} = S_0\n$$\nHere, $u > 0$ is a constant velocity, $\\Gamma > 0$ is a constant diffusivity, and $S_0$ is a constant source term. The boundary conditions are given by $\\phi(0) = \\phi_A$ and $\\phi(L) = \\phi_B$.\n\nThe domain is discretized using a uniform grid with $N=4$ intervals, resulting in grid points $x_i = i\\Delta x$ for $i=0, 1, 2, 3, 4$, where $\\Delta x = L/N$. Let $\\phi_i$ denote the numerical approximation of $\\phi(x_i)$.\n\nA finite difference method is used to solve for the values of $\\phi_i$ at the interior nodes ($i=1, 2, 3$). The diffusion term is approximated using a second-order central difference scheme. Due to the advection-dominated nature of the problem, the advection term is approximated using a first-order upwind scheme (or \"upwind differencing scheme\", UDS). Given that $u>0$, the flow is from left to right.\n\nUsing this numerical scheme, determine the value of the solution at the midpoint of the domain, $\\phi_2 = \\phi(x_2 = L/2)$. Express your answer as a single symbolic expression in terms of the given parameters $u, \\Gamma, S_0, L, \\phi_A$, and $\\phi_B$.", "solution": "The problem asks for the numerical solution $\\phi_2$ at the grid point $x_2=L/2$ for the given advection-diffusion equation. The domain is discretized into $N=4$ intervals, so the grid spacing is $\\Delta x = L/4$. The grid points are $x_0=0, x_1=L/4, x_2=L/2, x_3=3L/4, x_4=L$. The unknowns are the values at the interior nodes: $\\phi_1, \\phi_2, \\phi_3$. The boundary values are known: $\\phi_0 = \\phi_A$ and $\\phi_4 = \\phi_B$.\n\nThe steady-state advection-diffusion equation is:\n$$u \\frac{d\\phi}{dx} - \\Gamma \\frac{d^2\\phi}{dx^2} = S_0$$\n\nWe discretize this equation at an interior grid point $x_i$.\nThe diffusion term is discretized using a second-order central difference scheme:\n$$ \\left.\\frac{d^2\\phi}{dx^2}\\right|_{x_i} \\approx \\frac{\\phi_{i+1} - 2\\phi_i + \\phi_{i-1}}{(\\Delta x)^2} $$\nThe advection term is discretized using a first-order upwind scheme. Since $u > 0$, the flow is from left to right, so we use the value from \"upwind\" (i.e., from the left):\n$$ \\left.\\frac{d\\phi}{dx}\\right|_{x_i} \\approx \\frac{\\phi_i - \\phi_{i-1}}{\\Delta x} $$\n\nSubstituting these approximations into the PDE, we get the discretized equation for an interior node $i$:\n$$ u \\left(\\frac{\\phi_i - \\phi_{i-1}}{\\Delta x}\\right) - \\Gamma \\left(\\frac{\\phi_{i+1} - 2\\phi_i + \\phi_{i-1}}{(\\Delta x)^2}\\right) = S_0 $$\nThis equation is valid for $i=1, 2, 3$.\n\nTo simplify, let's multiply the entire equation by $(\\Delta x)^2$:\n$$ u \\Delta x (\\phi_i - \\phi_{i-1}) - \\Gamma (\\phi_{i+1} - 2\\phi_i + \\phi_{i-1}) = S_0 (\\Delta x)^2 $$\nNow, we group the terms by $\\phi_{i-1}$, $\\phi_i$, and $\\phi_{i+1}$:\n$$ (-u \\Delta x - \\Gamma) \\phi_{i-1} + (u \\Delta x + 2\\Gamma) \\phi_i - \\Gamma \\phi_{i+1} = S_0 (\\Delta x)^2 $$\nThis equation can be written as a tridiagonal system. Let's write it down for each interior node ($i=1, 2, 3$):\n\nFor $i=1$:\n$$ (-u \\Delta x - \\Gamma) \\phi_0 + (u \\Delta x + 2\\Gamma) \\phi_1 - \\Gamma \\phi_2 = S_0 (\\Delta x)^2 $$\nSince $\\phi_0 = \\phi_A$, we have:\n$$ (u \\Delta x + 2\\Gamma) \\phi_1 - \\Gamma \\phi_2 = S_0 (\\Delta x)^2 + (u \\Delta x + \\Gamma) \\phi_A \\quad (1) $$\n\nFor $i=2$:\n$$ (-u \\Delta x - \\Gamma) \\phi_1 + (u \\Delta x + 2\\Gamma) \\phi_2 - \\Gamma \\phi_3 = S_0 (\\Delta x)^2 \\quad (2) $$\n\nFor $i=3$:\n$$ (-u \\Delta x - \\Gamma) \\phi_2 + (u \\Delta x + 2\\Gamma) \\phi_3 - \\Gamma \\phi_4 = S_0 (\\Delta x)^2 $$\nSince $\\phi_4 = \\phi_B$, we have:\n$$ (-u \\Delta x - \\Gamma) \\phi_2 + (u \\Delta x + 2\\Gamma) \\phi_3 = S_0 (\\Delta x)^2 + \\Gamma \\phi_B \\quad (3) $$\n\nWe have a system of three linear equations for the three unknowns $\\phi_1, \\phi_2, \\phi_3$. We need to solve for $\\phi_2$. It is convenient to use substitution. Let's isolate $\\phi_1$ from (1) and $\\phi_3$ from (3):\n\nFrom (1):\n$$ \\phi_1 = \\frac{S_0 (\\Delta x)^2 + (u \\Delta x + \\Gamma) \\phi_A + \\Gamma \\phi_2}{u \\Delta x + 2\\Gamma} $$\n\nFrom (3):\n$$ \\phi_3 = \\frac{S_0 (\\Delta x)^2 + \\Gamma \\phi_B + (u \\Delta x + \\Gamma) \\phi_2}{u \\Delta x + 2\\Gamma} $$\n\nNow, substitute these expressions for $\\phi_1$ and $\\phi_3$ into equation (2):\n$$ -(u \\Delta x + \\Gamma) \\left( \\frac{S_0 (\\Delta x)^2 + (u \\Delta x + \\Gamma) \\phi_A + \\Gamma \\phi_2}{u \\Delta x + 2\\Gamma} \\right) + (u \\Delta x + 2\\Gamma) \\phi_2 - \\Gamma \\left( \\frac{S_0 (\\Delta x)^2 + \\Gamma \\phi_B + (u \\Delta x + \\Gamma) \\phi_2}{u \\Delta x + 2\\Gamma} \\right) = S_0 (\\Delta x)^2 $$\n\nMultiply the entire equation by $(u \\Delta x + 2\\Gamma)$ to clear the denominators:\n$$ -(u \\Delta x + \\Gamma) \\left[ S_0 (\\Delta x)^2 + (u \\Delta x + \\Gamma) \\phi_A + \\Gamma \\phi_2 \\right] + (u \\Delta x + 2\\Gamma)^2 \\phi_2 - \\Gamma \\left[ S_0 (\\Delta x)^2 + \\Gamma \\phi_B + (u \\Delta x + \\Gamma) \\phi_2 \\right] = S_0 (\\Delta x)^2 (u \\Delta x + 2\\Gamma) $$\n\nNow, collect all terms with $\\phi_2$ on the left-hand side and all other terms on the right-hand side:\n$$ \\phi_2 \\left[ -(u \\Delta x + \\Gamma)\\Gamma + (u \\Delta x + 2\\Gamma)^2 - \\Gamma(u \\Delta x + \\Gamma) \\right] = S_0 (\\Delta x)^2 (u \\Delta x + 2\\Gamma) + (u \\Delta x + \\Gamma)(S_0 (\\Delta x)^2 + (u \\Delta x + \\Gamma)\\phi_A) + \\Gamma(S_0 (\\Delta x)^2 + \\Gamma\\phi_B) $$\n\nSimplify the coefficient of $\\phi_2$:\n$$ \\text{Coeff}(\\phi_2) = (u \\Delta x + 2\\Gamma)^2 - 2\\Gamma(u \\Delta x + \\Gamma) $$\n$$ = (u^2(\\Delta x)^2 + 4u\\Delta x\\Gamma + 4\\Gamma^2) - (2u\\Delta x\\Gamma + 2\\Gamma^2) $$\n$$ = u^2(\\Delta x)^2 + 2u\\Delta x\\Gamma + 2\\Gamma^2 $$\n\nSimplify the right-hand side (RHS):\n$$ \\text{RHS} = S_0 (\\Delta x)^2 (u \\Delta x + 2\\Gamma) + S_0 (\\Delta x)^2(u \\Delta x + \\Gamma) + (u \\Delta x + \\Gamma)^2 \\phi_A + S_0 (\\Delta x)^2 \\Gamma + \\Gamma^2 \\phi_B $$\n$$ = S_0 (\\Delta x)^2 (u \\Delta x + 2\\Gamma + u \\Delta x + \\Gamma + \\Gamma) + (u \\Delta x + \\Gamma)^2 \\phi_A + \\Gamma^2 \\phi_B $$\n$$ = S_0 (\\Delta x)^2 (2u \\Delta x + 4\\Gamma) + (u \\Delta x + \\Gamma)^2 \\phi_A + \\Gamma^2 \\phi_B $$\n$$ = 2S_0 (\\Delta x)^2 (u \\Delta x + 2\\Gamma) + (u \\Delta x + \\Gamma)^2 \\phi_A + \\Gamma^2 \\phi_B $$\n\nNow, solve for $\\phi_2$:\n$$ \\phi_2 = \\frac{2S_0 (\\Delta x)^2 (u \\Delta x + 2\\Gamma) + (u \\Delta x + \\Gamma)^2 \\phi_A + \\Gamma^2 \\phi_B}{u^2(\\Delta x)^2 + 2u\\Delta x\\Gamma + 2\\Gamma^2} $$\n\nFinally, we substitute $\\Delta x = L/4$:\n$u \\Delta x = uL/4$ and $(\\Delta x)^2 = L^2/16$.\n\nNumerator:\n$$ \\text{Num} = 2S_0 \\frac{L^2}{16} \\left(\\frac{uL}{4} + 2\\Gamma\\right) + \\left(\\frac{uL}{4} + \\Gamma\\right)^2 \\phi_A + \\Gamma^2 \\phi_B $$\n$$ = \\frac{S_0 L^2}{8} \\left(\\frac{uL+8\\Gamma}{4}\\right) + \\left(\\frac{uL+4\\Gamma}{4}\\right)^2 \\phi_A + \\Gamma^2 \\phi_B $$\n$$ = \\frac{S_0 L^2(uL+8\\Gamma)}{32} + \\frac{(uL+4\\Gamma)^2}{16} \\phi_A + \\Gamma^2 \\phi_B $$\nTo combine terms, use a common denominator of 32:\n$$ = \\frac{1}{32} \\left[ S_0 L^2(uL+8\\Gamma) + 2(uL+4\\Gamma)^2 \\phi_A + 32\\Gamma^2 \\phi_B \\right] $$\n\nDenominator:\n$$ \\text{Denom} = u^2 \\left(\\frac{L^2}{16}\\right) + 2u\\left(\\frac{L}{4}\\right)\\Gamma + 2\\Gamma^2 $$\n$$ = \\frac{u^2 L^2}{16} + \\frac{uL\\Gamma}{2} + 2\\Gamma^2 $$\nUse a common denominator of 16:\n$$ = \\frac{1}{16} \\left[ u^2 L^2 + 8uL\\Gamma + 32\\Gamma^2 \\right] $$\n\nNow, compute the fraction $\\phi_2 = \\text{Num}/\\text{Denom}$:\n$$ \\phi_2 = \\frac{\\frac{1}{32} \\left[ S_0 L^2(uL+8\\Gamma) + 2(uL+4\\Gamma)^2 \\phi_A + 32\\Gamma^2 \\phi_B \\right]}{\\frac{1}{16} \\left[ u^2 L^2 + 8uL\\Gamma + 32\\Gamma^2 \\right]} $$\n$$ \\phi_2 = \\frac{16}{32} \\frac{S_0 L^2(uL+8\\Gamma) + 2(uL+4\\Gamma)^2 \\phi_A + 32\\Gamma^2 \\phi_B}{u^2 L^2 + 8uL\\Gamma + 32\\Gamma^2} $$\n$$ \\phi_2 = \\frac{S_0 L^2(uL+8\\Gamma) + 2(uL+4\\Gamma)^2 \\phi_A + 32\\Gamma^2 \\phi_B}{2(u^2 L^2 + 8uL\\Gamma + 32\\Gamma^2)} $$\nThis is the final expression for $\\phi_2$.", "answer": "$$ \\boxed{\\frac{S_0 L^2(uL+8\\Gamma) + 2(uL+4\\Gamma)^2 \\phi_A + 32\\Gamma^2 \\phi_B}{2(u^2 L^2 + 8uL\\Gamma + 32\\Gamma^2)}} $$", "id": "1127421"}, {"introduction": "Expanding our scope to multiple dimensions, this practice tackles the 2D Laplace equation, a cornerstone elliptic PDE governing steady-state potential fields in electrostatics, gravity, and heat conduction. Discretizing in two dimensions often results in a very large system of linear equations, making iterative solvers more practical than direct methods. This exercise walks you through one iteration of the Successive Over-Relaxation (SOR) method, demonstrating how to systematically update grid values to converge towards a solution and providing insight into a powerful computational technique [@problem_id:1127327].", "problem": "Consider the two-dimensional Laplace equation $\\nabla^2 u(x,y) = 0$ for a scalar potential field $u$ on a square domain. The domain is discretized using a uniform $5 \\times 5$ grid of points, indexed by $(i,j)$ where $i,j \\in \\{0, 1, 2, 3, 4\\}$. The grid points with $i,j \\in \\{1, 2, 3\\}$ are treated as interior nodes where the potential is unknown, while the points on the edges are boundary nodes. Let $u_{i,j}$ denote the potential at grid point $(i,j)$.\n\nThe boundary conditions are specified as follows:\n-   Bottom edge: $u_{i,0} = 0$ for $i \\in \\{0, \\dots, 4\\}$\n-   Top edge: $u_{i,4} = V$ for $i \\in \\{0, \\dots, 4\\}$\n-   Left edge: $u_{0,j} = V$ for $j \\in \\{1, \\dots, 3\\}$\n-   Right edge: $u_{4,j} = 0$ for $j \\in \\{1, \\dots, 3\\}$\n\nHere, $V$ is a given constant potential. The initial guess for the potential at all interior nodes is $u_{i,j}^{(0)} = 0$ for $i,j \\in \\{1, 2, 3\\}$.\n\nThe system of linear equations resulting from the finite-difference approximation of the Laplace equation is to be solved using the Successive Over-Relaxation (SOR) method. The SOR update equation for a node $(i,j)$ at iteration $(k+1)$ is given by:\n$$u_{i,j}^{(k+1)} = (1-\\omega) u_{i,j}^{(k)} + \\frac{\\omega}{4}\\left( u_{i-1,j}^{\\text{new}} + u_{i+1,j}^{\\text{old}} + u_{i,j-1}^{\\text{new}} + u_{i,j+1}^{\\text{old}} \\right)$$\nwhere $\\omega$ is the over-relaxation parameter. The updates are performed using a lexicographic ordering, which processes nodes row by row from bottom to top (i.e., for $j=1, 2, 3$), and in each row, from left to right (i.e., for $i=1, 2, 3$). In the formula, 'new' values (e.g., $u_{i-1,j}^{\\text{new}}$, $u_{i,j-1}^{\\text{new}}$) refer to values already computed in the current iteration $(k+1)$, while 'old' values (e.g., $u_{i+1,j}^{\\text{old}}$, $u_{i,j+1}^{\\text{old}}$) refer to values from the previous iteration $(k)$.\n\nDerive an expression for the potential at the central interior node, $u_{2,2}$, after one complete SOR iteration, denoted as $u_{2,2}^{(1)}$. Express your answer in terms of $V$ and $\\omega$.", "solution": "We use the SOR update formula for an interior node $(i,j)$,\n$$\nu_{i,j}^{(k+1)} =(1-\\omega)\\,u_{i,j}^{(k)} \n+\\frac{\\omega}{4}\\bigl(u_{i-1,j}^{\\rm new}+u_{i+1,j}^{\\rm old}\n+u_{i,j-1}^{\\rm new}+u_{i,j+1}^{\\rm old}\\bigr).\n$$\nWith the initial interior guess $u^{(0)}=0$ and lexicographic ordering (rows $j=1,2,3$, columns $i=1,2,3$), we compute row by row.\n\n1. Row $j=1$:\n- $(i,j)=(1,1)$: neighbors $u_{0,1}=V$, $u_{2,1}^{(0)}=0$, $u_{1,0}=0$, $u_{1,2}^{(0)}=0$,\n$$\nu_{1,1}^{(1)}=\\frac{\\omega}{4}V.\n$$\n- $(i,j)=(2,1)$: neighbors $u_{1,1}^{(1)}=\\frac{\\omega V}{4}$, $u_{3,1}^{(0)}=0$, $u_{2,0}=0$, $u_{2,2}^{(0)}=0$,\n$$\nu_{2,1}^{(1)}=\\frac{\\omega}{4}\\Bigl(\\frac{\\omega V}{4}\\Bigr)\n=\\frac{\\omega^2V}{16}.\n$$\n- $(i,j)=(3,1)$ (not used later): yields $u_{3,1}^{(1)}=\\omega^3V/64$.\n\n2. Row $j=2$:\n- $(i,j)=(1,2)$: neighbors $u_{0,2}=V$, $u_{2,2}^{(0)}=0$, $u_{1,1}^{(1)}=\\omega V/4$, $u_{1,3}^{(0)}=0$,\n$$\nu_{1,2}^{(1)}\n=\\frac{\\omega}{4}\\Bigl(V+\\frac{\\omega V}{4}\\Bigr)\n=\\frac{\\omega V(4+\\omega)}{16}.\n$$\n\n- $(i,j)=(2,2)$: neighbors $u_{1,2}^{(1)}=\\frac{\\omega V(4+\\omega)}{16}$, $u_{3,2}^{(0)}=0$, $u_{2,1}^{(1)}=\\frac{\\omega^2V}{16}$, $u_{2,3}^{(0)}=0$,\n$$\nu_{2,2}^{(1)}\n=\\frac{\\omega}{4}\\Bigl(\\frac{\\omega V(4+\\omega)}{16}+\\frac{\\omega^2V}{16}\\Bigr)\n=\\frac{\\omega}{4}\\cdot\\frac{V(4\\omega+2\\omega^2)}{16}\n=\\frac{V\\,\\omega^2(\\omega+2)}{32}.\n$$", "answer": "$$\\boxed{\\frac{V\\,\\omega^2(\\omega+2)}{32}}$$", "id": "1127327"}]}