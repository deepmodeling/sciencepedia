{"hands_on_practices": [{"introduction": "Our first exercise explores one of the most versatile families of schemes for time-dependent problems: the $\\theta$-method. By analyzing the 1D advection equation, we use von Neumann analysis to see how a single parameter, $\\theta$, allows us to smoothly transition between an explicit, conditionally stable scheme and an implicit, unconditionally stable one. This practice is fundamental to understanding the trade-offs between computational cost and stability in numerical methods [@problem_id:1128167].", "problem": "Consider the one-dimensional linear advection equation, which describes the transport of a scalar quantity $u(x,t)$ with a constant positive velocity $c > 0$:\n$$\n\\frac{\\partial u}{\\partial t} + c \\frac{\\partial u}{\\partial x} = 0\n$$\n\nThis partial differential equation can be discretized and solved numerically. A common family of finite difference methods is the $\\theta$-method. We will use a first-order upwind scheme (specifically, a backward difference) for the spatial derivative, as $c > 0$. The resulting finite difference equation for $u_j^n \\approx u(j\\Delta x, n\\Delta t)$ is:\n$$\n\\frac{u_j^{n+1} - u_j^n}{\\Delta t} + c \\left[ (1-\\theta) \\left( \\frac{u_j^n - u_{j-1}^n}{\\Delta x} \\right) + \\theta \\left( \\frac{u_j^{n+1} - u_{j-1}^{n+1}}{\\Delta x} \\right) \\right] = 0\n$$\nwhere $\\Delta t$ is the time step, $\\Delta x$ is the grid spacing, and $\\theta \\in [0, 1]$ is a parameter that blends an explicit time-stepping scheme ($\\theta=0$, Forward Euler) with an implicit one ($\\theta=1$, Backward Euler).\n\nThe stability of this numerical scheme can be investigated using von Neumann stability analysis. We seek solutions of the form $u_j^n = g^n e^{i k j \\Delta x}$, where $k$ is the wavenumber and $g = g(k)$ is the amplification factor. The scheme is stable if and only if $|g| \\le 1$ for all possible wavenumbers $k$.\n\nIt is a known result that for $\\theta \\in [1/2, 1]$, this scheme is unconditionally stable for any positive Courant number $\\sigma = \\frac{c \\Delta t}{\\Delta x}$. However, for $\\theta \\in [0, 1/2)$, the scheme is only conditionally stable.\n\nYour task is to derive the expression for the maximum allowable Courant number, $\\sigma_{\\text{max}}$, as a function of the parameter $\\theta$, that ensures the stability of the scheme for the range $\\theta \\in [0, 1/2)$.", "solution": "We apply von Neumann analysis to the $\\theta$-method upwind scheme. With $\\sigma=c\\Delta t/\\Delta x$ and a trial solution $u_j^n=g^n e^{i\\xi j}$, the scheme yields the amplification factor $g$. The stability condition is $|g|^2 \\le 1$.\nLet's define the terms from the discretized equation:\n$A=1-\\sigma(1-\\theta)$, $B=\\sigma(1-\\theta)$, $C=1+\\sigma\\theta$, and $D=-\\sigma\\theta$.\nThe amplification factor can be written as $g=\\frac{A+Be^{-i\\xi}}{C+De^{-i\\xi}}$.\nThe stability condition $|g|^2 \\le 1$ is thus:\n$$\\frac{A^2+B^2+2AB\\cos \\xi}{C^2+D^2+2CD\\cos \\xi} \\le 1$$\nThis must hold for all $\\xi$. The worst-case scenario (which is most likely to violate the condition) occurs at $\\cos \\xi=-1$. The inequality becomes $(A-B)^2 \\le (C-D)^2$. After substituting the expressions for A, B, C, and D and performing algebraic simplification, this condition becomes:\n$$4\\sigma\\bigl(\\sigma(1-2\\theta)-1\\bigr)\\le0$$\nSince $\\sigma>0$ and for the given range $1-2\\theta > 0$, this simplifies to $\\sigma(1-2\\theta) - 1 \\le 0$, or $\\sigma \\le \\frac{1}{1-2\\theta}$.\nHence for $\\theta\\in[0,1/2)$ the stability limit is\n$$\\displaystyle \\sigma_{\\max}=\\frac{1}{1-2\\theta}.$$", "answer": "$$\\boxed{\\frac{1}{1-2\\theta}}$$", "id": "1128167"}, {"introduction": "Real-world phenomena are rarely one-dimensional. This next practice extends our stability analysis to the two-dimensional linear advection equation, a model for transport processes in fields like fluid dynamics and meteorology. By applying von Neumann analysis to a 2D upwind scheme, you will derive the famous Courant-Friedrichs-Lewy (CFL) condition for multiple dimensions and discover how stability constraints combine from each spatial direction [@problem_id:1128038].", "problem": "Consider the two-dimensional linear advection equation for a scalar field $u(x, y, t)$:\n$$\n\\frac{\\partial u}{\\partial t} + c_x \\frac{\\partial u}{\\partial x} + c_y \\frac{\\partial u}{\\partial y} = 0\n$$\nwhere $c_x$ and $c_y$ are constant, positive advection velocities in the $x$ and $y$ directions, respectively.\n\nThis equation is discretized on a uniform square grid with spatial step size $h$ in both directions ($\\Delta x = \\Delta y = h$) and a time step $\\Delta t$. The numerical approximation at grid point $(x_i, y_j)$ and time $t^n$ is denoted by $u_{i,j}^n$. The scheme uses a forward Euler method for the time derivative and a first-order upwind scheme for the spatial derivatives. Given that $c_x > 0$ and $c_y > 0$, this upwind scheme is given by:\n$$\n\\frac{\\partial u}{\\partial x}\\bigg|_{i,j,n} \\approx \\frac{u_{i,j}^n - u_{i-1,j}^n}{h} \\quad \\text{and} \\quad \\frac{\\partial u}{\\partial y}\\bigg|_{i,j,n} \\approx \\frac{u_{i,j}^n - u_{i,j-1}^n}{h}\n$$\nThe stability of this numerical scheme is governed by the Courant-Friedrichs-Lewy (CFL) condition, which places an upper bound on the Courant numbers $\\lambda_x = \\frac{c_x \\Delta t}{h}$ and $\\lambda_y = \\frac{c_y \\Delta t}{h}$. Specifically, for the scheme to be stable for all possible initial conditions, the sum of the Courant numbers, $S = \\lambda_x + \\lambda_y$, must satisfy the inequality $S \\le S_{max}$ for some constant $S_{max}$.\n\nUsing Von Neumann stability analysis, derive the value of the maximum allowable sum of Courant numbers, $S_{max}$.", "solution": "1. Relevant equations: the update for the upwind scheme is\n$$\nu_{i,j}^{n+1}\n= u_{i,j}^n - \\lambda_x\\bigl(u_{i,j}^n - u_{i-1,j}^n\\bigr)\n            - \\lambda_y\\bigl(u_{i,j}^n - u_{i,j-1}^n\\bigr),\n$$\nwith $\\lambda_x = \\frac{c_x\\Delta t}{h}$, $\\lambda_y = \\frac{c_y\\Delta t}{h}$ and $S=\\lambda_x+\\lambda_y$.\nVon Neumann assumes a Fourier mode $u_{i,j}^n = G^n e^{i(k_x x_i + k_y y_j)}$.\n\n2. Substitution gives the amplification factor\n$$\nG = 1 - \\lambda_x\\bigl(1 - e^{-i\\theta_x}\\bigr)\n      - \\lambda_y\\bigl(1 - e^{-i\\theta_y}\\bigr),\n\\quad \\theta_x = k_x h,\\ \\theta_y = k_y h.\n$$\n\n3. For stability we require $|G|\\le1$ for all $\\theta_x, \\theta_y$. The extremal case for magnitude occurs at $\\theta_x=\\theta_y=\\pi$, where $e^{-i\\pi}=-1$. For this case, the amplification factor is real:\n$$\nG = 1 - \\lambda_x(1-(-1)) - \\lambda_y(1-(-1))\n= 1 - 2\\lambda_x - 2\\lambda_y = 1 - 2S.\n$$\nThe stability condition $|G|\\le1$ becomes:\n$$\n|1 - 2S|\\le1\n\\quad\\Longrightarrow\\quad\n-1 \\le 1-2S \\le 1\n\\quad\\Longrightarrow\\quad\n0 \\le S \\le 1.\n$$\nThus the maximum allowable sum of Courant numbers is\n$$\nS_{\\max} = 1.\n$$", "answer": "$$\\boxed{1}$$", "id": "1128038"}, {"introduction": "While von Neumann analysis is powerful, its typical application assumes periodic boundary conditions, which is not always the case in physical problems. For schemes on finite domains, the matrix method provides a more rigorous approach. This exercise challenges you to analyze the Forward-Time, Centered-Space (FTCS) scheme for the wave equation, a classic example of an unconditionally unstable method. By calculating the spectral radius, $\\rho(M)$, of the system's amplification matrix, you will prove mathematically why this seemingly straightforward scheme will always fail, a crucial lesson in numerical scheme design [@problem_id:1128196].", "problem": "The one-dimensional wave equation is given by\n$$\n\\frac{\\partial^2 u}{\\partial t^2} = c^2 \\frac{\\partial^2 u}{\\partial x^2}\n$$\nfor a function $u(x,t)$ on the spatial domain $x \\in [0, L]$ and time $t \\ge 0$. The parameter $c$ is the constant wave speed. The equation is subject to Dirichlet boundary conditions, $u(0,t) = u(L,t) = 0$.\n\nTo solve this equation numerically, it is first converted into a system of two first-order partial differential equations by introducing an auxiliary function $v(x,t) = \\frac{\\partial u}{\\partial t}$:\n$$\n\\frac{\\partial u}{\\partial t} = v \\\\\n\\frac{\\partial v}{\\partial t} = c^2 \\frac{\\partial^2 u}{\\partial x^2}\n$$\nA numerical scheme is constructed by discretizing the spatial domain into $N$ intervals of equal width $\\Delta x = L/N$, with grid points $x_j = j\\Delta x$ for $j=0, 1, \\dots, N$. Let $u_j^n \\approx u(x_j, n\\Delta t)$ and $v_j^n \\approx v(x_j, n\\Delta t)$, where $\\Delta t$ is the time step.\n\nThe \"Forward-Time, Centered-Space\" (FTCS) scheme is applied to this system: a forward difference in time for both equations, and a second-order centered difference for the spatial derivative.\n$$\n\\frac{u_j^{n+1}-u_j^n}{\\Delta t} = v_j^n \\\\\n\\frac{v_j^{n+1}-v_j^n}{\\Delta t} = c^2 \\frac{u_{j+1}^n - 2u_j^n + u_{j-1}^n}{(\\Delta x)^2}\n$$\nThis scheme is known to be unconditionally unstable. Your task is to quantify this instability. By considering the evolution of the vector of interior grid points, $\\mathbf{W}^n = [\\mathbf{U}^n, \\mathbf{V}^n]^T$, where $\\mathbf{U}^n = [u_1^n, \\dots, u_{N-1}^n]^T$ and $\\mathbf{V}^n = [v_1^n, \\dots, v_{N-1}^n]^T$, the scheme can be written in the matrix form $\\mathbf{W}^{n+1} = M \\mathbf{W}^n$.\n\nUsing the matrix method of stability analysis, derive an expression for the spectral radius, $\\rho(M)$, of the amplification matrix $M$. Express your final answer in terms of the Courant number $\\lambda = \\frac{c\\Delta t}{\\Delta x}$ and the number of spatial intervals $N$.", "solution": "The given numerical scheme is:\n$$\nu_j^{n+1} = u_j^n + \\Delta t \\, v_j^n\n$$\n$$\nv_j^{n+1} = v_j^n + c^2 \\frac{\\Delta t}{(\\Delta x)^2} (u_{j+1}^n - 2u_j^n + u_{j-1}^n)\n$$\nWe analyze the scheme on the interior grid points $j=1, 2, \\dots, N-1$, using the Dirichlet boundary conditions $u_0^n = u_N^n = 0$.\n\nLet $\\mathbf{U}^n = [u_1^n, u_2^n, \\dots, u_{N-1}^n]^T$ and $\\mathbf{V}^n = [v_1^n, v_2^n, \\dots, v_{N-1}^n]^T$. The system of equations can be written in matrix form. The spatial second derivative is represented by the $(N-1) \\times (N-1)$ tridiagonal matrix $A$:\n$$\nA = \\begin{pmatrix}\n-2  1  0  \\cdots  0 \\\\\n1  -2  1  \\cdots  0 \\\\\n0  \\ddots  \\ddots  \\ddots  0 \\\\\n\\vdots   1  -2  1 \\\\\n0  \\cdots  0  1  -2\n\\end{pmatrix}\n$$\nLet the Courant number be $\\lambda = \\frac{c\\Delta t}{\\Delta x}$. The term in the second difference equation can be rewritten using the Courant number: $\\frac{c^2 \\Delta t}{(\\Delta x)^2} = \\frac{c^2 (\\Delta t)^2}{(\\Delta x)^2} \\frac{1}{\\Delta t} = \\frac{\\lambda^2}{\\Delta t}$.\nSo the system of difference equations becomes:\n$$\n\\mathbf{U}^{n+1} = I \\mathbf{U}^n + (\\Delta t) I \\mathbf{V}^n\n$$\n$$\n\\mathbf{V}^{n+1} = \\frac{\\lambda^2}{\\Delta t} A \\mathbf{U}^n + I \\mathbf{V}^n\n$$\nwhere $I$ is the $(N-1) \\times (N-1)$ identity matrix.\n\nWe form a state vector $\\mathbf{W}^n = \\begin{pmatrix} \\mathbf{U}^n \\\\ \\mathbf{V}^n \\end{pmatrix}$. The scheme is then $\\mathbf{W}^{n+1} = M \\mathbf{W}^n$, where the amplification matrix $M$ is a $2(N-1) \\times 2(N-1)$ block matrix:\n$$\nM = \\begin{pmatrix}\nI  (\\Delta t) I \\\\\n\\frac{\\lambda^2}{\\Delta t} A  I\n\\end{pmatrix}\n$$\nTo find the spectral radius $\\rho(M)$, we need the eigenvalues of $M$. Let $\\mu$ be an eigenvalue of $M$ and $\\mathbf{w} = \\begin{pmatrix} \\mathbf{w}_1 \\\\ \\mathbf{w}_2 \\end{pmatrix}$ be the corresponding eigenvector. The eigenvalue problem $M\\mathbf{w} = \\mu\\mathbf{w}$ leads to the system:\n$$\n\\mathbf{w}_1 + (\\Delta t) \\mathbf{w}_2 = \\mu \\mathbf{w}_1\n$$\n$$\n\\frac{\\lambda^2}{\\Delta t} A \\mathbf{w}_1 + \\mathbf{w}_2 = \\mu \\mathbf{w}_2\n$$\nAssuming a non-trivial solution where $\\mathbf{w}_1$ is proportional to an eigenvector of $A$ with eigenvalue $\\alpha_k$, we can solve for $\\mu$. The characteristic equation for $\\mu$ is:\n$$\n(1-\\mu)^2 - (\\Delta t) \\left( \\frac{\\lambda^2}{\\Delta t} \\alpha_k \\right) = 0\n$$\n$$\n(1-\\mu)^2 = \\lambda^2 \\alpha_k\n$$\nThe eigenvalues of the matrix $A$ are well-known:\n$$\n\\alpha_k = -4 \\sin^2\\left(\\frac{k\\pi}{2N}\\right), \\quad k=1, 2, \\dots, N-1\n$$\nSubstituting $\\alpha_k$ into the equation for $\\mu$:\n$$\n(1-\\mu)^2 = -4\\lambda^2 \\sin^2\\left(\\frac{k\\pi}{2N}\\right)\n$$\nTaking the square root of both sides:\n$$\n1-\\mu = \\pm \\sqrt{-4\\lambda^2 \\sin^2\\left(\\frac{k\\pi}{2N}\\right)} = \\pm 2i\\lambda \\sin\\left(\\frac{k\\pi}{2N}\\right)\n$$\nThe eigenvalues $\\mu_k$ of the amplification matrix $M$ are therefore:\n$$\n\\mu_k = 1 \\mp 2i\\lambda \\sin\\left(\\frac{k\\pi}{2N}\\right)\n$$\nThe magnitude of these complex eigenvalues is:\n$$\n|\\mu_k| = \\sqrt{1^2 + \\left( \\pm 2\\lambda \\sin\\left(\\frac{k\\pi}{2N}\\right) \\right)^2} = \\sqrt{1 + 4\\lambda^2 \\sin^2\\left(\\frac{k\\pi}{2N}\\right)}\n$$\nThe spectral radius $\\rho(M)$ is the maximum of these magnitudes over all possible values of $k$:\n$$\n\\rho(M) = \\max_{k=1, \\dots, N-1} |\\mu_k| = \\max_{k=1, \\dots, N-1} \\sqrt{1 + 4\\lambda^2 \\sin^2\\left(\\frac{k\\pi}{2N}\\right)}\n$$\nTo find the maximum, we need to maximize $\\sin^2\\left(\\frac{k\\pi}{2N}\\right)$. Since $\\frac{k\\pi}{2N}$ is in $(0, \\pi/2)$, the sine function is maximized for the largest value of $k$, which is $k=N-1$.\nThe maximum value of the sine term is $\\sin\\left(\\frac{(N-1)\\pi}{2N}\\right) = \\sin\\left(\\frac{\\pi}{2} - \\frac{\\pi}{2N}\\right) = \\cos\\left(\\frac{\\pi}{2N}\\right)$.\nSubstituting this into the expression for the spectral radius:\n$$\n\\rho(M) = \\sqrt{1 + 4\\lambda^2 \\cos^2\\left(\\frac{\\pi}{2N}\\right)}\n$$\nFor any $\\lambda  0$ and any finite $N \\ge 2$, $\\cos(\\frac{\\pi}{2N})  0$, hence $\\rho(M)  1$. This confirms that the scheme is unconditionally unstable, as the magnitude of at least one eigenvalue is always greater than 1, regardless of the choice of $\\Delta t$ and $\\Delta x$.", "answer": "$$\n\\boxed{\\sqrt{1 + 4\\lambda^2 \\cos^2\\left(\\frac{\\pi}{2N}\\right)}}\n$$", "id": "1128196"}]}