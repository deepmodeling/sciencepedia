{"hands_on_practices": [{"introduction": "This first practice provides a foundational exercise in applying the Walsh-Hadamard transform. We will explore the characteristic function of weight-one vectors, a fundamental building block in the analysis of Boolean functions, and compute its transform. By calculating the inner product between the function and its transform [@problem_id:829988], you will gain direct experience with the transform's mechanics and see how it reveals underlying structural properties.", "problem": "Consider the abelian group $V_n = (\\{0,1\\}^n, \\oplus)$, where vectors are binary strings of length $n$ and the group operation $\\oplus$ is component-wise addition modulo 2 (the XOR operation). The size of this group is $|V_n| = 2^n$. The Hamming weight of a vector $x \\in V_n$, denoted $w(x)$, is the number of its non-zero components.\n\nWe consider the vector space of real-valued functions on this group, $f: V_n \\to \\mathbb{R}$. The Walsh-Hadamard transform of a function $f$ is a new function $\\hat{f}: V_n \\to \\mathbb{R}$ defined by:\n$$ \\hat{f}(s) = \\sum_{x \\in V_n} f(x) (-1)^{s \\cdot x} $$\nwhere $s \\cdot x = \\sum_{i=1}^n s_i x_i \\pmod{2}$ is the dot product over the finite field $\\mathbb{F}_2$.\n\nThe standard Euclidean inner product for two functions $f, g: V_n \\to \\mathbb{R}$ is given by:\n$$ \\langle f, g \\rangle = \\sum_{x \\in V_n} f(x) g(x) $$\n\nLet $f_1$ be the characteristic function for the set of all weight-one vectors, $W_1 = \\{x \\in V_n \\mid w(x)=1\\}$. This means $f_1(x) = 1$ if $w(x)=1$ and $f_1(x) = 0$ otherwise.\n\nDerive a closed-form expression for the inner product $C = \\langle f_1, \\hat{f}_1 \\rangle$ as a function of the dimension $n$.", "solution": "1. Definitions:\n   The function $f_1$ and its transform $\\hat{f}_1$ are given by:\n   $$\n   f_1(x)=\\begin{cases}\n   1,& w(x)=1,\\\\\n   0,& \\text{otherwise},\n   \\end{cases}\n   \\quad\n   \\hat{f}_1(s)=\\sum_{x\\in V_n}f_1(x)(-1)^{s\\cdot x}.\n   $$\n2. Compute $\\hat{f}_1(s)$:\n   The sum is only over vectors $x$ with $w(x)=1$. These are the standard basis vectors $e_i$.\n   $$\n   \\hat{f}_1(s)\n   =\\sum_{w(x)=1}(-1)^{s\\cdot x}\n   =\\sum_{i=1}^n(-1)^{s\\cdot e_i}\n   =\\sum_{i=1}^n(-1)^{s_i}\n   $$\n   Since $s_i \\in \\{0, 1\\}$, we can write $(-1)^{s_i} = 1 - 2s_i$.\n   $$\n   \\hat{f}_1(s) = \\sum_{i=1}^n(1-2s_i) = n - 2\\sum_{i=1}^n s_i = n-2w(s).\n   $$\n3. Inner product:\n   The inner product $C=\\langle f_1, \\hat{f}_1 \\rangle$ is the sum of $f_1(x)\\hat{f}_1(x)$ over all $x$. Since $f_1(x)$ is non-zero only for vectors of weight one, we only need to sum over those vectors.\n   $$\n   C=\\sum_{x\\in V_n}f_1(x)\\,\\hat{f}_1(x)\n   =\\sum_{w(x)=1}\\hat{f}_1(x)\n   $$\n   For any vector $x$ with $w(x)=1$, its transform value is $\\hat{f}_1(x) = n-2w(x) = n-2$. There are $n$ such vectors.\n   $$\n   C = \\sum_{i=1}^n (n-2) = n(n-2).\n   $$", "answer": "$$\\boxed{n(n-2)}$$", "id": "829988"}, {"introduction": "Building on direct computation, this exercise introduces one of the cornerstone results of Fourier analysis: Parseval's identity. This theorem relates the total energy of a function to the sum of its squared spectral coefficients. You will apply this principle to determine the power distribution of the characteristic function for a coordinate subspace [@problem_id:829886], connecting the abstract transform to the tangible concept of signal energy and the group's geometric structure.", "problem": "Consider the abelian group $G = (\\mathbb{Z}_2)^n$, which consists of all binary strings of length $n$, with the group operation being component-wise addition modulo 2 (XOR). The elements of $G$ are vectors $x = (x_1, \\dots, x_n)$ with $x_i \\in \\{0, 1\\}$.\n\nThe characters of this group are the Walsh functions, indexed by frequency vectors $s \\in G$. For a given $s$, the Walsh function $\\chi_s: G \\to \\{-1, 1\\}$ is defined as:\n$$\n\\chi_s(x) = (-1)^{s \\cdot x}\n$$\nwhere $s \\cdot x = \\sum_{i=1}^n s_i x_i \\pmod 2$ is the dot product.\n\nThe Walsh-Hadamard transform of a real-valued function $f: G \\to \\mathbb{R}$ is a function $\\hat{f}: G \\to \\mathbb{R}$ given by:\n$$\n\\hat{f}(s) = \\sum_{x \\in G} f(x) \\chi_s(x)\n$$\nThis transform decomposes the function $f$ into its frequency components, represented by the coefficients $\\hat{f}(s)$.\n\nLet $V_k$ be the $k$-dimensional coordinate subspace of $G$ comprising all vectors whose last $n-k$ components are zero. That is, $V_k = \\{x \\in G \\mid x_i = 0 \\text{ for all } i > k \\}$. We assume $1 \\le k < n$.\n\nConsider the characteristic function of this subspace, $f_{V_k}: G \\to \\mathbb{R}$, defined as:\n$$\nf_{V_k}(x) =\n\\begin{cases}\n1 & \\text{if } x \\in V_k \\\\\n0 & \\text{if } x \\notin V_k\n\\end{cases}\n$$\nThe quantity $|\\hat{f}_{V_k}(s)|^2$ can be interpreted as the power of the function at frequency $s$.\n\nDerive an expression for the total power contained in all non-zero frequencies, which is given by the sum $P_{nz} = \\sum_{s \\in G, s \\neq \\mathbf{0}} |\\hat{f}_{V_k}(s)|^2$. Your final answer should be a closed-form expression in terms of $n$ and $k$.", "solution": "1. Compute the Walsh-Hadamard transform of $f_{V_k}$:\n   The transform is given by $\\hat{f}_{V_k}(s) = \\sum_{x \\in G} f_{V_k}(x) (-1)^{s \\cdot x}$. Since $f_{V_k}(x)$ is non-zero only for $x \\in V_k$, this simplifies to:\n   $$\n   \\hat{f}_{V_k}(s) = \\sum_{x \\in V_k} (-1)^{s \\cdot x}\n   $$\n2. Analyze the character sum:\n   The sum $\\sum_{x \\in V_k} (-1)^{s \\cdot x}$ is a character sum over the subgroup $V_k$. This sum is equal to the size of the subgroup, $|V_k|=2^k$, if the character $\\chi_s(x)$ is trivial on $V_k$. Otherwise, the sum is 0.\n   The character is trivial on $V_k$ if and only if $s \\cdot x = 0$ for all $x \\in V_k$. Since $V_k$ is spanned by the first $k$ standard basis vectors $\\{e_1, \\dots, e_k\\}$, this condition is equivalent to $s \\cdot e_i = s_i = 0$ for all $i=1, \\dots, k$.\n   Therefore, the transform is:\n   $$\n   \\hat{f}_{V_k}(s) = \\begin{cases} 2^k & \\text{if } s_1=\\dots=s_k=0 \\\\ 0 & \\text{otherwise} \\end{cases}\n   $$\n   The set of such vectors $s$ is the dual subspace $V_k^\\perp$, which has dimension $n-k$.\n\n3. Calculate the total power at non-zero frequencies:\n   The quantity we want to compute is $P_{nz} = \\sum_{s \\neq \\mathbf{0}} |\\hat{f}_{V_k}(s)|^2$.\n   The coefficients are non-zero only for $s \\in V_k^\\perp$. For each such $s$, the power is $|\\hat{f}_{V_k}(s)|^2 = (2^k)^2 = 2^{2k}$.\n   We need to sum this power over all non-zero vectors in $V_k^\\perp$.\n   The number of vectors in $V_k^\\perp$ is $2^{n-k}$. Excluding the zero vector, there are $2^{n-k}-1$ such vectors.\n\n4. Final Result:\n   The total power at non-zero frequencies is the number of non-zero frequencies with non-zero power, multiplied by the power at each of these frequencies.\n   $$\n   P_{nz} = (2^{n-k}-1) \\cdot 2^{2k} = 2^{n+k} - 2^{2k}\n   $$", "answer": "$$\\boxed{2^{n+k} - 2^{2k}}$$", "id": "829886"}, {"introduction": "Our final practice explores another powerful property of the Walsh-Hadamard transform: its elegant interaction with the convolution operation. The convolution theorem simplifies complex convolutions into simple multiplications in the frequency domain, a technique with vast applications in signal processing and algorithm design. By analyzing the spectral support of a function constructed via convolution [@problem_id:829942], you will see firsthand how this transform turns a difficult problem into a straightforward application of linear algebra.", "problem": "Let $G = (\\mathbb{Z}/2\\mathbb{Z})^n$ be the group of binary vectors of length $n$ with component-wise addition modulo 2 (the XOR operation). The elements of $G$ are of the form $x = (x_1, \\dots, x_n)$ with $x_i \\in \\{0, 1\\}$. The dot product of two vectors $s, x \\in G$ is defined over the field $\\mathbb{F}_2$ as $s \\cdot x = \\sum_{i=1}^n s_i x_i \\pmod 2$.\n\nThe Walsh-Hadamard transform of a function $g: G \\to \\mathbb{C}$ is a function $\\hat{g}: G \\to \\mathbb{C}$ defined by:\n$$ \\hat{g}(s) = \\sum_{x \\in G} g(x) (-1)^{s \\cdot x} $$\n\nThe Dirac delta function centered at a point $a \\in G$ is defined as $\\delta_a(x) = 1$ if $x=a$ and $\\delta_a(x) = 0$ if $x \\neq a$. The convolution of two functions $g_1, g_2: G \\to \\mathbb{C}$ is given by $(g_1 * g_2)(x) = \\sum_{y \\in G} g_1(y) g_2(x+y)$, where vector addition is performed component-wise modulo 2.\n\nConsider four distinct, non-zero vectors $a, b, c, d \\in G$. Let a function $f: G \\to \\mathbb{C}$ be defined as the convolution $f = (\\delta_a - \\delta_b) * (\\delta_c - \\delta_d)$.\n\nDerive the size of the spectral support of $f$, which is the number of elements $s \\in G$ for which $\\hat{f}(s) \\neq 0$. It is given that the vectors $u = a+b$ and $v = c+d$ are linearly independent over the field $\\mathbb{F}_2$. Express your answer in terms of $n$.", "solution": "1. Apply the Convolution Theorem:\n   The Convolution Theorem states that $\\widehat{g_1 * g_2}(s) = \\hat{g}_1(s) \\hat{g}_2(s)$. We apply this to $f = (\\delta_a - \\delta_b) * (\\delta_c - \\delta_d)$.\n   $$\n   \\hat{f}(s) = \\widehat{(\\delta_a - \\delta_b)}(s) \\cdot \\widehat{(\\delta_c - \\delta_d)}(s)\n   $$\n\n2. Compute the transform of the components:\n   The transform of a Dirac delta function $\\delta_p(x)$ is:\n   $$\n   \\hat{\\delta}_p(s) = \\sum_{x \\in G} \\delta_p(x) (-1)^{s \\cdot x} = (-1)^{s \\cdot p}\n   $$\n   Using the linearity of the transform, we get:\n   $$\n   \\widehat{(\\delta_a - \\delta_b)}(s) = \\hat{\\delta}_a(s) - \\hat{\\delta}_b(s) = (-1)^{s \\cdot a} - (-1)^{s \\cdot b}\n   $$\n   $$\n   \\widehat{(\\delta_c - \\delta_d)}(s) = \\hat{\\delta}_c(s) - \\hat{\\delta}_d(s) = (-1)^{s \\cdot c} - (-1)^{s \\cdot d}\n   $$\n   \n3. Combine the terms:\n   $$\n   \\hat{f}(s) = \\bigl((-1)^{s \\cdot a} - (-1)^{s \\cdot b}\\bigr) \\bigl((-1)^{s \\cdot c} - (-1)^{s \\cdot d}\\bigr)\n   $$\n\n4. Determine the condition for $\\hat{f}(s) \\neq 0$:\n   The transform $\\hat{f}(s)$ is non-zero if and only if both factors are non-zero.\n   The first factor is zero if $(-1)^{s \\cdot a} = (-1)^{s \\cdot b}$, which is equivalent to $s \\cdot a = s \\cdot b \\pmod 2$, or $s \\cdot (a+b) = 0$. Let $u = a+b$. The factor is non-zero if and only if $s \\cdot u = 1$.\n   Similarly, let $v = c+d$. The second factor is non-zero if and only if $s \\cdot v = 1$.\n   Therefore, the spectral support of $f$ is the set of all $s \\in G$ such that:\n   $$\n   s \\cdot u = 1 \\quad \\text{and} \\quad s \\cdot v = 1\n   $$\n\n5. Count the number of solutions:\n   This is a system of two linear equations for the vector $s$. Since we are given that $u$ and $v$ are linearly independent over $\\mathbb{F}_2$, these two equations are independent. Such a system defines an affine subspace of codimension 2. The number of solutions (the size of this affine subspace) is $2^{n-2}$.\n\n   Therefore, the size of the spectral support is $2^{n-2}$.", "answer": "$$\\boxed{2^{n-2}}$$", "id": "829942"}]}