{"hands_on_practices": [{"introduction": "The Lévy-Itô decomposition and the corresponding Lévy-Khintchine representation are not uniquely defined; they depend on the choice of a truncation function. This practice explores the interplay between the drift term $b$ and the truncation function $h(x)$, demonstrating that a change in truncation can be perfectly compensated by an adjustment to the drift, leaving the law of the process unchanged. By working through this calculation [@problem_id:3002105], you will gain a hands-on understanding of why different but equivalent forms of the Lévy-Khintchine formula exist and how the components of a Lévy triplet are linked to the chosen representation.", "problem": "Consider a one-dimensional Lévy process with no Gaussian component, constructed via the Lévy-Itô decomposition, where the Lévy measure is supported on positive jumps with density\n$$\n\\nu(\\mathrm{d}x) \\;=\\; \\lambda\\,\\eta\\,\\exp(-\\eta x)\\,\\mathbf{1}_{\\{x>0\\}}\\,\\mathrm{d}x,\n$$\nfor fixed parameters $\\lambda>0$ and $\\eta>0$. Let $h:\\mathbb{R}\\to\\mathbb{R}$ denote a truncation function, and let $b\\in\\mathbb{R}$ denote the drift parameter appearing in the associated Lévy-Itô decomposition. The characteristic exponent $\\psi(u)$ of the process is defined through the characteristic function at time $t$ by $\\mathbb{E}\\!\\left[\\exp\\!\\left(\\mathrm{i} u X_t\\right)\\right]=\\exp\\!\\left(t\\,\\psi(u)\\right)$ for $u\\in\\mathbb{R}$.\n\nYou are given two choices of truncation functions and drifts, both using the same Lévy measure $\\nu$ above and both with zero Gaussian part:\n\n- Model $\\mathsf{M}_1$: truncation function $h_1(x)=0$ and drift $b_1=0$.\n- Model $\\mathsf{M}_2$: truncation function $h_2(x)=x\\,\\mathbf{1}_{\\{0<x\\le 1\\}}$ and drift $b_2$ to be determined.\n\nUsing only foundational definitions and the Lévy-Khintchine representation as the starting point, do the following:\n\n- Compute the characteristic exponent $\\psi_1(u)$ for $\\mathsf{M}_1$.\n- Compute the characteristic exponent $\\psi_2(u)$ for $\\mathsf{M}_2$ in terms of $b_2$.\n- Determine the unique choice of $b_2$ such that the laws of $\\mathsf{M}_1$ and $\\mathsf{M}_2$ coincide, by verifying that the characteristic exponents then agree for all $u\\in\\mathbb{R}$.\n- With that choice of $b_2$ in place, simplify the common characteristic exponent to a closed-form analytic expression in $u$, $\\lambda$, and $\\eta$.\n\nYour final answer must be the single closed-form analytic expression for the common characteristic exponent $\\psi(u)$. Do not provide any intermediate equations in your final answer.", "solution": "We recall the structural characterization of a Lévy process through its Lévy-Itô decomposition and Lévy-Khintchine representation. A Lévy process is characterized by a triplet $(b,A,\\nu)$ together with a choice of truncation function $h$, where $b\\in\\mathbb{R}$ is the drift, $A\\ge 0$ is the Gaussian variance (here $A=0$), and $\\nu$ is a Lévy measure satisfying\n$$\n\\int_{\\mathbb{R}} (1\\wedge x^2)\\,\\nu(\\mathrm{d}x) \\;<\\; \\infty.\n$$\nFor the given $\\nu(\\mathrm{d}x)=\\lambda\\,\\eta\\,\\exp(-\\eta x)\\,\\mathbf{1}_{\\{x>0\\}}\\,\\mathrm{d}x$, we verify $\\nu$ is a Lévy measure. Indeed,\n$$\n\\int_{\\mathbb{R}} (1\\wedge x^2)\\,\\nu(\\mathrm{d}x)\n\\;=\\;\n\\lambda \\eta \\int_{0}^{1} x^2 \\exp(-\\eta x)\\,\\mathrm{d}x\n\\;+\\;\n\\lambda \\eta \\int_{1}^{\\infty} \\exp(-\\eta x)\\,\\mathrm{d}x,\n$$\nwhich is finite because both integrals converge by comparison with $\\int_{0}^{1} x^2\\,\\mathrm{d}x$ and $\\int_{1}^{\\infty} \\exp(-\\eta x)\\,\\mathrm{d}x$.\n\nThe characteristic exponent $\\psi(u)$, defined by $\\mathbb{E}[\\exp(\\mathrm{i} u X_t)]=\\exp(t\\,\\psi(u))$, is given in terms of the triplet $(b,0,\\nu)$ and truncation $h$ by\n$$\n\\psi(u)\n\\;=\\;\n\\mathrm{i} u\\, b\n\\;+\\;\n\\int_{\\mathbb{R}}\n\\Big(\n\\exp(\\mathrm{i} u x)-1-\\mathrm{i} u\\, h(x)\n\\Big)\\,\\nu(\\mathrm{d}x),\n$$\nfor all $u\\in\\mathbb{R}$.\n\nStep $1$: Compute $\\psi_1(u)$ for $\\mathsf{M}_1$ with $h_1(x)=0$ and $b_1=0$. We have\n$$\n\\psi_1(u)\n\\;=\\;\n\\int_{0}^{\\infty}\n\\Big(\n\\exp(\\mathrm{i} u x)-1\n\\Big)\\,\\lambda \\eta \\exp(-\\eta x)\\,\\mathrm{d}x.\n$$\nSplit the integral:\n$$\n\\int_{0}^{\\infty} \\exp(\\mathrm{i} u x)\\,\\lambda \\eta \\exp(-\\eta x)\\,\\mathrm{d}x\n\\;=\\;\n\\lambda \\eta \\int_{0}^{\\infty} \\exp\\big((\\mathrm{i} u-\\eta)x\\big)\\,\\mathrm{d}x\n\\;=\\;\n\\lambda \\eta\\,\\frac{1}{\\eta-\\mathrm{i} u},\n$$\nand\n$$\n\\int_{0}^{\\infty} 1 \\cdot \\lambda \\eta \\exp(-\\eta x)\\,\\mathrm{d}x\n\\;=\\;\n\\lambda \\eta \\cdot \\frac{1}{\\eta}\n\\;=\\;\n\\lambda.\n$$\nTherefore,\n$$\n\\psi_1(u)\n\\;=\\;\n\\lambda \\eta\\,\\frac{1}{\\eta-\\mathrm{i} u} \\;-\\; \\lambda\n\\;=\\;\n\\lambda\\left(\\frac{\\eta}{\\eta-\\mathrm{i} u}-1\\right).\n$$\n\nStep $2$: Compute $\\psi_2(u)$ for $\\mathsf{M}_2$ with $h_2(x)=x\\,\\mathbf{1}_{\\{0<x\\le 1\\}}$ and drift $b_2$. We have\n$$\n\\psi_2(u)\n\\;=\\;\n\\mathrm{i} u\\, b_2\n\\;+\\;\n\\int_{0}^{\\infty}\n\\Big(\n\\exp(\\mathrm{i} u x)-1-\\mathrm{i} u\\, x\\,\\mathbf{1}_{\\{0<x\\le 1\\}}\n\\Big)\\,\\lambda \\eta \\exp(-\\eta x)\\,\\mathrm{d}x.\n$$\nSplit the integral into the part already computed for $\\psi_1(u)$ and the correction from the truncation:\n$$\n\\psi_2(u)\n\\;=\\;\n\\mathrm{i} u\\, b_2\n\\;+\\;\n\\left[\n\\int_{0}^{\\infty}\n\\Big(\n\\exp(\\mathrm{i} u x)-1\n\\Big)\\,\\lambda \\eta \\exp(-\\eta x)\\,\\mathrm{d}x\n\\right]\n\\;-\\;\n\\mathrm{i} u\\,\\lambda \\eta \\int_{0}^{1} x\\, \\exp(-\\eta x)\\,\\mathrm{d}x.\n$$\nUsing the result from Step $1$, the bracketed term equals $\\psi_1(u)$. It remains to evaluate\n$$\nJ\n\\;:=\\;\n\\int_{0}^{1} x\\, \\exp(-\\eta x)\\,\\mathrm{d}x.\n$$\nIntegrate by parts or use an antiderivative. An antiderivative is\n$$\n\\int x\\,\\exp(-\\eta x)\\,\\mathrm{d}x\n\\;=\\;\n-\\frac{x}{\\eta}\\,\\exp(-\\eta x) \\;-\\; \\frac{1}{\\eta^2}\\,\\exp(-\\eta x),\n$$\nso\n$$\nJ\n\\;=\\;\n\\left[\n-\\frac{x}{\\eta}\\,\\exp(-\\eta x) \\;-\\; \\frac{1}{\\eta^2}\\,\\exp(-\\eta x)\n\\right]_{x=0}^{x=1}\n\\;=\\;\n-\\frac{1}{\\eta}\\,\\exp(-\\eta) \\;-\\; \\frac{1}{\\eta^2}\\,\\exp(-\\eta) \\;+\\; \\frac{1}{\\eta^2}.\n$$\nEquivalently,\n$$\nJ\n\\;=\\;\n\\frac{1 - \\exp(-\\eta)\\,(1+\\eta)}{\\eta^2}.\n$$\nTherefore,\n$$\n\\psi_2(u)\n\\;=\\;\n\\psi_1(u)\n\\;+\\;\n\\mathrm{i} u\\,\\Big(\nb_2 \\;-\\; \\lambda \\eta\\, J\n\\Big).\n$$\n\nStep $3$: Determine $b_2$ so that $\\psi_2(u)=\\psi_1(u)$ for all $u\\in\\mathbb{R}$. This requires\n$$\n\\mathrm{i} u\\,\\Big(\nb_2 \\;-\\; \\lambda \\eta\\, J\n\\Big)\n\\;=\\;\n0\n\\quad\\text{for all }u,\n$$\nhence\n$$\nb_2\n\\;=\\;\n\\lambda \\eta\\, J\n\\;=\\;\n\\lambda \\eta \\cdot \\frac{1 - \\exp(-\\eta)\\,(1+\\eta)}{\\eta^2}\n\\;=\\;\n\\lambda \\,\\frac{1 - \\exp(-\\eta)\\,(1+\\eta)}{\\eta}.\n$$\nWith this choice of $b_2$, the characteristic exponents coincide.\n\nStep $4$: Provide the common closed-form characteristic exponent. From Step $1$, the common exponent is\n$$\n\\psi(u)\n\\;=\\;\n\\lambda\\left(\\frac{\\eta}{\\eta-\\mathrm{i} u}-1\\right).\n$$\nThis completes the verification that, although the truncation function and drift parameters differ, the induced characteristic exponent (and thus the law of the Lévy process) is the same when $b_2$ is chosen as above. The final requested expression is the common $\\psi(u)$.", "answer": "$$\\boxed{\\lambda\\left(\\frac{\\eta}{\\eta-\\mathrm{i}u}-1\\right)}$$", "id": "3002105"}, {"introduction": "The qualitative behavior of a Lévy process, such as the regularity of its sample paths, is entirely encoded within its characteristic triplet. This exercise [@problem_id:3002114] focuses on a process with high jump activity near the origin, challenging you to connect the properties of the Lévy measure $\\nu$ to the properties of the process itself. You will investigate how the integrability of $|x|$ versus $|x|^2$ against $\\nu$ determines whether the process has finite variation and whether its jump martingale component is square-integrable, solidifying your ability to diagnose process behavior from its measure.", "problem": "Let $X=\\{X_{t}\\}_{t\\ge 0}$ be a real-valued Lévy process with characteristic triplet $(b,\\sigma,\\nu)$, where $b=0$, $\\sigma=0$, and the Lévy measure $\\nu$ is supported on the unit ball and has density\n$$\n\\nu(dx)=c\\,|x|^{-1-\\beta}\\,\\mathbf{1}_{\\{|x|\\le 1\\}}\\,dx,\n$$\nwith fixed parameters $c>0$ and $\\beta\\in(1,2)$. Recall that a Lévy measure $\\nu$ on $\\mathbb{R}$ is any Borel measure satisfying $\\nu(\\{0\\})=0$ and $\\int_{\\mathbb{R}} (1\\wedge x^{2})\\,\\nu(dx)<\\infty$. The Lévy-Itô decomposition expresses $X$ as the sum of a drift, a Brownian motion (both zero here), a compensated small-jump stochastic integral, and a finite-activity big-jump process. Let $N(dt,dx)$ denote the Poisson Random Measure (PRM) of jumps of $X$, and $\\tilde{N}(dt,dx)=N(dt,dx)-\\nu(dx)\\,dt$ its compensated version. Define the small-jump martingale\n$$\nM_{t}=\\int_{0}^{t}\\int_{|x|\\le 1} x\\,\\tilde{N}(ds,dx).\n$$\n\nStarting from the fundamental definitions above, do the following:\n\n1. Establish whether $\\int_{|x|\\le 1} |x|\\,\\nu(dx)$ and $\\int_{|x|\\le 1} |x|^{2}\\,\\nu(dx)$ are finite or infinite for the given $\\nu$, and explain how these integrability properties determine, via the Lévy-Itô decomposition, whether the small-jump component has finite variation on compact time intervals and whether the compensated small-jump component $M$ is square-integrable.\n\n2. Using first principles of stochastic integration with respect to compensated Poisson Random Measures, determine the predictable quadratic variation (PQV) $\\langle M\\rangle_{t}$ of $M$ as a function of $t$, $c$, and $\\beta$.\n\nYour final answer must be the closed-form expression for $\\langle M\\rangle_{t}$ in terms of $t$, $c$, and $\\beta$. No numerical substitution is required, and no rounding is needed. Express the final answer as a single analytic expression.", "solution": "The problem is validated as scientifically grounded, well-posed, and objective. It is based on standard, correct definitions within the theory of Lévy processes and stochastic calculus. The given Lévy measure $\\nu(dx)=c\\,|x|^{-1-\\beta}\\,\\mathbf{1}_{\\{|x|\\le 1\\}}\\,dx$ is valid for the specified parameter range $\\beta\\in(1,2)$, as the condition $\\int_{\\mathbb{R}} (1\\wedge x^{2})\\,\\nu(dx)<\\infty$ simplifies to $\\int_{|x|\\le 1} x^{2}\\,\\nu(dx) < \\infty$, which holds for $\\beta < 2$. All necessary information is provided, and the questions are specific and formalizable. We may proceed with the solution.\n\nThe problem asks for two main tasks: first, to analyze the integrability of $|x|$ and $|x|^2$ with respect to the given Lévy measure and relate it to properties of the process; second, to compute the predictable quadratic variation of the martingale $M_t$.\n\nFirst, we analyze the integrability properties. The Lévy measure is given by the density $\\nu(dx)=c\\,|x|^{-1-\\beta}\\,\\mathbf{1}_{\\{|x|\\le 1\\}}\\,dx$ with $c>0$ and $\\beta\\in(1,2)$.\n\nLet's evaluate the integral $\\int_{|x|\\le 1} |x|\\,\\nu(dx)$:\n$$\n\\int_{|x|\\le 1} |x|\\,\\nu(dx) = \\int_{-1}^{1} |x| \\cdot c\\,|x|^{-1-\\beta}\\,dx = c \\int_{-1}^{1} |x|^{-\\beta}\\,dx\n$$\nSince the integrand $|x|^{-\\beta}$ is an even function, we can write this as:\n$$\nc \\int_{-1}^{1} |x|^{-\\beta}\\,dx = 2c \\int_{0}^{1} x^{-\\beta}\\,dx\n$$\nThis is a standard p-integral of the form $\\int_{0}^{1} x^p\\,dx$ with $p = -\\beta$. This integral converges if and only if $p > -1$, which translates to $-\\beta > -1$, or $\\beta < 1$. However, the problem specifies that $\\beta \\in (1,2)$. Since $\\beta > 1$, the integral $\\int_{0}^{1} x^{-\\beta}\\,dx$ diverges.\nTherefore, $\\int_{|x|\\le 1} |x|\\,\\nu(dx)$ is infinite.\n\nNext, let's evaluate the integral $\\int_{|x|\\le 1} |x|^2\\,\\nu(dx)$:\n$$\n\\int_{|x|\\le 1} |x|^2\\,\\nu(dx) = \\int_{-1}^{1} |x|^2 \\cdot c\\,|x|^{-1-\\beta}\\,dx = c \\int_{-1}^{1} |x|^{1-\\beta}\\,dx\n$$\nAgain, due to the symmetry of the integrand $|x|^{1-\\beta}$:\n$$\nc \\int_{-1}^{1} |x|^{1-\\beta}\\,dx = 2c \\int_{0}^{1} x^{1-\\beta}\\,dx\n$$\nThis is a p-integral with $p = 1-\\beta$. This integral converges if and only if $p > -1$, which means $1-\\beta > -1$, or $\\beta < 2$. The problem specifies that $\\beta \\in (1,2)$, so this condition is satisfied. The integral is finite. We can calculate its value:\n$$\n2c \\int_{0}^{1} x^{1-\\beta}\\,dx = 2c \\left[ \\frac{x^{2-\\beta}}{2-\\beta} \\right]_{0}^{1} = 2c \\left( \\frac{1^{2-\\beta}}{2-\\beta} - \\lim_{x\\to 0^+} \\frac{x^{2-\\beta}}{2-\\beta} \\right)\n$$\nSince $\\beta < 2$, the exponent $2-\\beta$ is positive, so $\\lim_{x\\to 0^+} x^{2-\\beta} = 0$. The integral evaluates to:\n$$\n\\int_{|x|\\le 1} |x|^2\\,\\nu(dx) = \\frac{2c}{2-\\beta}\n$$\n\nNow we explain the consequences of these integrability properties.\nAccording to the theory of Lévy processes, a Lévy process has sample paths of finite variation on compact time intervals if and only if its Gaussian component is zero ($\\sigma=0$) and $\\int_{\\mathbb{R}} (1 \\wedge |x|)\\,\\nu(dx) < \\infty$. In our case, the support of $\\nu$ is on $\\{|x|\\le 1\\}$, so the condition becomes $\\int_{|x|\\le 1} |x|\\,\\nu(dx) < \\infty$. We have shown this integral to be infinite. The process $X_t$ is defined without a Gaussian part ($\\sigma=0$) and is composed solely of its jump components. Since the characteristic triplet specifies $b=0$, $\\sigma=0$ and the support of $\\nu$ is on $|x| \\le 1$, the process is exactly the small-jump martingale, $X_t = M_t$. The fact that $\\int_{|x|\\le 1} |x|\\,\\nu(dx) = \\infty$ implies that the process has paths of infinite variation. Such processes are sometimes called \"processes of finite activity with infinite variation,\" but \"finite activity\" usually refers to $\\nu(\\mathbb{R}) < \\infty$. Here $\\nu(\\mathbb{R}) = \\int_{|x|\\le 1} c|x|^{-1-\\beta}dx = \\infty$ since $\\beta>0$. So it is an infinite activity process. The divergence of this integral means that the jumps are frequent enough and large enough that their sum over any time interval, without compensation, diverges.\n\nThe martingale $M_t = \\int_{0}^{t}\\int_{|x|\\le 1} x\\,\\tilde{N}(ds,dx)$ is a local martingale. It is a true martingale if $\\mathbb{E}[|M_t|] < \\infty$, and it is a square-integrable martingale if $\\mathbb{E}[M_t^2] < \\infty$. A sufficient condition for $M_t$ to be a square-integrable martingale is that its predictable quadratic variation $\\langle M \\rangle_t$ has a finite expectation. The general theory of stochastic integration with respect to a compensated Poisson random measure states that for a predictable integrand $H(s,x)$, the predictable quadratic variation of the integral $\\int_0^t \\int_E H(s,x) \\tilde{N}(ds,dx)$ is given by $\\int_0^t \\int_E H(s,x)^2 \\nu(dx) ds$. For $M_t$, the integrand is $H(s,x) = x$. The predictable quadratic variation is $\\langle M \\rangle_t = \\int_0^t \\int_{|x|\\le 1} x^2 \\nu(dx) ds$. The martingale $M_t$ is square-integrable if this quantity is finite for all $t \\ge 0$. This is equivalent to the condition $\\int_{|x|\\le 1} x^2\\,\\nu(dx) < \\infty$. As we have demonstrated, this integral is finite for $\\beta \\in (1,2)$. Therefore, $M_t$ is a square-integrable martingale.\n\nNow we proceed to the second part of the problem: to determine the predictable quadratic variation (PQV) $\\langle M\\rangle_{t}$.\nAs established above, the formula for the PQV of $M_t$ is:\n$$\n\\langle M \\rangle_t = \\int_{0}^{t} \\left( \\int_{|x|\\le 1} x^2\\,\\nu(dx) \\right) ds\n$$\nWe have already computed the inner integral:\n$$\n\\int_{|x|\\le 1} x^2\\,\\nu(dx) = \\frac{2c}{2-\\beta}\n$$\nThis value is a constant with respect to the time variable $s$. Substituting this back into the expression for $\\langle M \\rangle_t$:\n$$\n\\langle M \\rangle_t = \\int_{0}^{t} \\frac{2c}{2-\\beta}\\,ds\n$$\nThe integrand is constant, so the integral is straightforward to compute:\n$$\n\\langle M \\rangle_t = \\frac{2c}{2-\\beta} \\int_{0}^{t} ds = \\frac{2c}{2-\\beta} [s]_0^t = \\frac{2ct}{2-\\beta}\n$$\nThis is the closed-form expression for the predictable quadratic variation of $M_t$. It is a linear function of time $t$, with a positive coefficient since $c>0$ and $\\beta<2$.", "answer": "$$\\boxed{\\frac{2ct}{2-\\beta}}$$", "id": "3002114"}, {"introduction": "While the Lévy-Itô decomposition provides a perfect theoretical blueprint, simulating a general Lévy process requires practical approximations, especially for processes with infinite jump activity. This problem [@problem_id:2980752] guides you through a common simulation strategy: separating tractable \"large\" jumps from \"small\" ones, which are then handled differently. This practice bridges theory and computation by asking you to derive and calculate the mean-square error bound for such a truncation, demonstrating how the decomposition informs algorithm design and error control.", "problem": "Consider a scalar Lévy process with Lévy triplet $(b,c,\\nu)$, where $b \\in \\mathbb{R}$ is the drift, $c \\ge 0$ is the diffusion coefficient of the Brownian part, and $\\nu$ is a Lévy measure on $\\mathbb{R} \\setminus \\{0\\}$. The Lévy-Khintchine formula implies that $X$ has independent and stationary increments with characteristic exponent \n$$\n\\Psi(u) = i u b - \\frac{1}{2} c u^2 + \\int_{\\mathbb{R} \\setminus \\{0\\}} \\left(e^{i u z} - 1 - i u z \\mathbf{1}_{\\{|z| \\le 1\\}}\\right) \\nu(dz).\n$$\nIn numerical simulation, a common strategy is to decompose $X$ into a Brownian part and a jump part, and to truncate small jumps below a threshold $\\varepsilon > 0$ to obtain a compound Poisson approximation for the jump part. The resulting increment over a time step $\\Delta t > 0$ is simulated as\n$$\n\\Delta X \\approx b \\Delta t + \\sqrt{c \\Delta t}\\, \\mathcal{N} + \\sum_{k=1}^{N_{\\Delta t}^{(\\varepsilon)}} J_k^{(\\varepsilon)},\n$$\nwhere $\\mathcal{N}$ is a standard normal random variable, $N_{\\Delta t}^{(\\varepsilon)}$ is a Poisson random variable with intensity $\\lambda^{(\\varepsilon)}$ equal to the truncated jump intensity $\\int_{\\{|z|>\\varepsilon\\}} \\nu(dz)$, and $(J_k^{(\\varepsilon)})$ are independent jump sizes sampled from the normalized restriction of $\\nu$ to $\\{|z|>\\varepsilon\\}$ with symmetric signs when $\\nu$ is symmetric. The small jumps $(|z| \\le \\varepsilon)$ are omitted in the truncated simulation.\n\nFor a symmetric tempered stable Lévy measure with parameters $C > 0$, $\\alpha \\in (0,2)$, and $\\lambda > 0$, defined by\n$$\n\\nu(dz) = C \\, e^{-\\lambda |z|} |z|^{-1-\\alpha} \\, dz,\n$$\nthe mean-square error from this truncation is dominated by the variance of the omitted small-jump process. For a symmetric measure, the variance over a time step $\\Delta t$ is exactly given by the integral $\\Delta t \\int_{|z|\\le \\varepsilon} |z|^2 \\, \\nu(dz)$.\n\nYour tasks are:\n- Starting from the Lévy-Khintchine framework and the definition of the Lévy measure, describe a simulation scheme that decomposes the process into a Brownian part and a jump part, with small jumps truncated at a threshold $\\varepsilon$, including a principled method to sample the large jump magnitudes and signs.\n- Derive an explicit, computable expression for the integral \n$$\n\\int_{|z|\\le \\varepsilon} |z|^2 \\, \\nu(dz)\n$$ \nin terms of $C$, $\\alpha$, $\\lambda$, and $\\varepsilon$ for the symmetric tempered stable Lévy measure above, using standard special functions that are widely available in scientific computing libraries. Use this to obtain the corresponding one-step mean-square truncation error bound over time $\\Delta t$.\n- Implement a program that, for each parameter set in the test suite below, computes the mean-square truncation error bound $\\Delta t \\int_{|z|\\le \\varepsilon} |z|^2 \\, \\nu(dz)$ and outputs the results.\n\nUse the following test suite of parameter values $(\\Delta t, C, \\alpha, \\lambda, \\varepsilon)$:\n- Case $1$: $(0.1, 0.5, 1.5, 4.0, 0.05)$.\n- Case $2$: $(0.1, 0.5, 1.5, 4.0, 0.001)$.\n- Case $3$: $(0.2, 0.3, 0.7, 2.0, 0.1)$.\n- Case $4$: $(0.05, 0.4, 1.9, 3.0, 0.2)$.\n\nNo physical units are involved, and angles do not appear. The final outputs are real numbers. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[r_1,r_2,r_3,r_4]$), where each $r_i$ is the mean-square truncation error bound for the corresponding case, expressed as a Python float.", "solution": "The problem statement is scientifically sound, self-contained, and well-posed within the established mathematical theory of stochastic processes. All parameters and objectives are clearly defined, permitting a rigorous and unambiguous solution.\n\nA complete solution requires addressing two main parts: first, a description of the simulation methodology, and second, the analytical derivation of the specified error bound.\n\n### Simulation Scheme for a Truncated Lévy Process\n\nThe foundation for simulating a Lévy process $X_t$ with Lévy triplet $(b, c, \\nu)$ is the Lévy–Itô decomposition. This decomposition expresses the process as the sum of a linear drift, a Brownian motion, and a pure jump process:\n$$\nX_t = b t + \\sqrt{c} W_t + J_t\n$$\nwhere $b \\in \\mathbb{R}$ is the drift coefficient, $c \\geq 0$ is the diffusion coefficient, $W_t$ is a standard Wiener process (Brownian motion), and $J_t$ is a pure jump process whose jumps are governed by the Lévy measure $\\nu$.\n\nFor numerical implementation, we consider increments of the process, $\\Delta X$, over a small time step $\\Delta t$. A common and practical approximation method involves truncating the jump component. The Lévy measure $\\nu$ is partitioned based on a small jump-size threshold $\\varepsilon > 0$ into a measure for large jumps, $\\nu_{> \\varepsilon}(dz) = \\nu(dz) \\mathbf{1}_{\\{|z| > \\varepsilon\\}}$, and a measure for small jumps, $\\nu_{\\le \\varepsilon}(dz) = \\nu(dz) \\mathbf{1}_{\\{0 < |z| \\le \\varepsilon\\}}$.\n\nThe process of large jumps, $J_t^{(>\\varepsilon)}$, is a compound Poisson process. The rate of arrival of these jumps is given by the total mass of the truncated measure, $\\lambda^{(\\varepsilon)} = \\int_{|z| > \\varepsilon} \\nu(dz)$. The sizes of these jumps are independent and identically distributed random variables, drawn from the normalized probability measure $\\frac{1}{\\lambda^{(\\varepsilon)}} \\nu_{> \\varepsilon}(dz)$.\n\nThe simulation scheme described in the problem statement approximates the full increment by retaining the drift, the Brownian part, and the large-jump compound Poisson process, while entirely omitting the contribution from small jumps. This leads to the approximation formula for an increment over $\\Delta t$:\n$$\n\\Delta X \\approx b \\Delta t + \\sqrt{c \\Delta t}\\, \\mathcal{N} + \\sum_{k=1}^{N_{\\Delta t}^{(\\varepsilon)}} J_k^{(\\varepsilon)}\n$$\nIn this expression, $\\mathcal{N}$ is a standard normal random variable, $N_{\\Delta t}^{(\\varepsilon)}$ is a Poisson-distributed random variable representing the number of large jumps in the interval, with mean $\\lambda^{(\\varepsilon)} \\Delta t$, and $\\{J_k^{(\\varepsilon)}\\}$ are the i.i.d. random jump sizes.\n\nA principled method to simulate the jump term $\\sum_{k=1}^{N} J_k^{(\\varepsilon)}$ for the specified symmetric tempered stable Lévy measure proceeds as follows. First, the number of jumps $N$ is drawn from a Poisson distribution with parameter $\\lambda^{(\\varepsilon)} \\Delta t$. Second, for each of the $N$ jumps, a jump size $J_k^{(\\varepsilon)}$ is sampled. Since the measure $\\nu(dz) = C e^{-\\lambda |z|} |z|^{-1-\\alpha} dz$ is symmetric, this sampling can be efficiently performed in two steps:\n$1$. Sample the jump magnitude $|J_k|$ from the conditional distribution on $\\{|z|>\\varepsilon\\}$. This requires drawing from a probability density proportional to $e^{-\\lambda y} y^{-1-\\alpha}$ for $y > \\varepsilon$, which can be accomplished using standard algorithms like inverse transform sampling or acceptance-rejection.\n$2$. Assign a random sign to the magnitude. The jump size is then $J_k = S_k |J_k|$, where $S_k$ is a Rademacher random variable, i.e., $P(S_k = 1) = P(S_k = -1) = 1/2$.\n\n### Derivation of the Mean-Square Truncation Error Bound\n\nThe omission of small jumps introduces a truncation error. A key metric for quantifying this error is the one-step mean-square error bound, which is given by $\\Delta t \\int_{|z| \\le \\varepsilon} |z|^2 \\nu(dz)$. We will now derive an explicit computable expression for this integral, which we denote by $I$.\n$$\nI = \\int_{|z| \\le \\varepsilon} |z|^2 \\nu(dz)\n$$\nSubstituting the expression for the symmetric tempered stable Lévy measure, $\\nu(dz) = C \\, e^{-\\lambda |z|} |z|^{-1-\\alpha} \\, dz$:\n$$\nI = \\int_{-\\varepsilon}^{\\varepsilon} z^2 \\left( C e^{-\\lambda |z|} |z|^{-1-\\alpha} \\right) dz\n$$\nThe integrand is an even function of $z$, so the integral over the symmetric domain $[-\\varepsilon, \\varepsilon] \\setminus \\{0\\}$ is equal to $2$ times the integral over the positive domain $(0, \\varepsilon]$:\n$$\nI = 2 \\int_0^{\\varepsilon} z^2 \\left( C e^{-\\lambda z} z^{-1-\\alpha} \\right) dz\n$$\nSimplifying the expression by combining the powers of $z$:\n$$\nI = 2C \\int_0^{\\varepsilon} e^{-\\lambda z} z^{1-\\alpha} dz\n$$\nThis integral is an instance of the lower incomplete gamma function, which is defined as $\\gamma(s, x) = \\int_0^x t^{s-1} e^{-t} dt$. To cast our integral into this standard form, we apply the substitution $t = \\lambda z$, which implies $z = t/\\lambda$ and $dz = dt/\\lambda$. The integration limits transform accordingly: from $z=0$ to $t=0$, and from $z=\\varepsilon$ to $t=\\lambda\\varepsilon$. Substituting these into the integral for $I$:\n$$\nI = 2C \\int_0^{\\lambda\\varepsilon} e^{-t} \\left(\\frac{t}{\\lambda}\\right)^{1-\\alpha} \\frac{dt}{\\lambda}\n$$\nFactoring out the constants involving $\\lambda$:\n$$\nI = 2C \\lambda^{-(1-\\alpha)} \\lambda^{-1} \\int_0^{\\lambda\\varepsilon} t^{1-\\alpha} e^{-t} dt = 2C \\lambda^{\\alpha-2} \\int_0^{\\lambda\\varepsilon} t^{(2-\\alpha)-1} e^{-t} dt\n$$\nThe remaining integral is precisely the lower incomplete gamma function $\\gamma(s, x)$ with parameters $s = 2-\\alpha$ and $x = \\lambda\\varepsilon$. The problem specifies that $\\alpha \\in (0,2)$, which ensures that the shape parameter $s = 2-\\alpha$ is in the interval $(0,2)$, guaranteeing that the integral is well-defined and convergent.\n\nThe final explicit expression for the integral is:\n$$\nI = 2C \\lambda^{\\alpha-2} \\gamma(2-\\alpha, \\lambda\\varepsilon)\n$$\nConsequently, the one-step mean-square truncation error bound is:\n$$\n\\text{Error Bound} = \\Delta t \\cdot I = \\Delta t \\cdot 2C \\lambda^{\\alpha-2} \\gamma(2-\\alpha, \\lambda\\varepsilon)\n$$\nFor numerical implementation, it is useful to express this result in terms of the regularized lower incomplete gamma function, $P(s, x) = \\gamma(s, x) / \\Gamma(s)$, where $\\Gamma(s)$ is the complete gamma function. Both $\\Gamma(s)$ and $P(s,x)$ are readily available in scientific computing libraries. The final expression for computation is:\n$$\n\\text{Error Bound} = \\Delta t \\cdot 2C \\lambda^{\\alpha-2} \\Gamma(2-\\alpha) P(2-\\alpha, \\lambda\\varepsilon)\n$$\nThis formula is used in the accompanying program to calculate the required values.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import special as sp\n\ndef solve():\n    \"\"\"\n    Calculates the mean-square truncation error bound for a truncated Lévy process\n    simulation for a given set of parameters.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (delta_t, C, alpha, lambda, epsilon)\n    test_cases = [\n        (0.1, 0.5, 1.5, 4.0, 0.05),\n        (0.1, 0.5, 1.5, 4.0, 0.001),\n        (0.2, 0.3, 0.7, 2.0, 0.1),\n        (0.05, 0.4, 1.9, 3.0, 0.2),\n    ]\n\n    results = []\n    for case in test_cases:\n        delta_t, C, alpha, lam, epsilon = case\n\n        # The derived formula for the mean-square truncation error bound is:\n        # Error = delta_t * 2 * C * lambda^(alpha - 2) * gamma(2 - alpha, lambda * epsilon)\n        # where gamma(s, x) is the lower incomplete gamma function.\n        #\n        # Most scientific libraries, including SciPy, provide the regularized\n        # lower incomplete gamma function P(s, x) = gammainc(s, x) and the\n        # complete gamma function Gamma(s) = gamma(s).\n        # The relationship is gamma(s, x) = Gamma(s) * P(s, x).\n\n        # The shape parameter 's' for the gamma function\n        s = 2.0 - alpha\n        \n        # The upper integration limit 'x' for the incomplete gamma function\n        x = lam * epsilon\n\n        # Calculate the lower incomplete gamma function value\n        # using sp.gamma for Gamma(s) and sp.gammainc for P(s, x)\n        lower_incomplete_gamma = sp.gamma(s) * sp.gammainc(s, x)\n        \n        # Calculate the integral I = integral from |z|<=eps of |z|^2 * nu(dz)\n        integral_I = 2.0 * C * (lam**(alpha - 2.0)) * lower_incomplete_gamma\n        \n        # The final mean-square truncation error bound is delta_t * I\n        error_bound = delta_t * integral_I\n        \n        results.append(error_bound)\n\n    # Final print statement in the exact required format.\n    # Output a comma-separated list of float results enclosed in square brackets.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2980752"}]}