{"hands_on_practices": [{"introduction": "Our first practice grounds the abstract concept of manifold SDEs in the intuitive setting of an embedded surface. We will begin by formally defining the tangent space to the sphere $S^{n-1}$ within its ambient Euclidean space $\\mathbb{R}^n$. By constructing a stochastic process through the projection of Brownian motion onto this tangent space, this exercise [@problem_id:2995674] reveals a crucial geometric effect: the emergence of an inward-pointing Itô drift term that is necessary to constrain the process to the manifold.", "problem": "Let $M \\subset \\mathbb{R}^{n}$ be a smooth embedded submanifold defined as the zero level set of a smooth map $F : \\mathbb{R}^{n} \\to \\mathbb{R}^{m}$, where $0 \\in \\mathbb{R}^{m}$ is a regular value and $\\operatorname{rank} D F(x) = m$ for all $x \\in M$. Use the fundamental characterization of tangent vectors via differentiable curves to construct the tangent space $T_{x} M$ at a point $x \\in M$ as the kernel of the differential $D F(x)$. Then, verify this construction explicitly for the unit sphere $S^{n-1} = \\{ x \\in \\mathbb{R}^{n} : \\| x \\| = 1 \\}$, viewed as $F^{-1}(0)$ with $F(x) = \\| x \\|^{2} - 1$.\n\nNow consider a stochastic differential equation (SDE), in the sense of a Stratonovich SDE, on the Riemannian manifold $S^{n-1}$ obtained by orthogonally projecting standard $\\mathbb{R}^{n}$-valued Brownian motion onto the tangent bundle. Let $W_{t}$ be standard Brownian motion in $\\mathbb{R}^{n}$ and define the Stratonovich SDE\n$$\nd X_{t} = P(X_{t}) \\circ d W_{t}, \\quad X_{t} \\in S^{n-1},\n$$\nwhere $P(x)$ is the orthogonal projection in $\\mathbb{R}^{n}$ onto $T_{x} S^{n-1}$. Using only the characterization of $T_{x} S^{n-1}$ as the kernel of $D F(x)$ and fundamental properties of Stratonovich-to-Itô conversion for state-dependent diffusion coefficients, determine the explicit Itô drift vector field $b(x)$ in the equivalent Itô form\n$$\nd X_{t} = b(X_{t}) \\, dt + P(X_{t}) \\, d W_{t}.\n$$\nYour final answer must be a single closed-form analytic expression for $b(x)$, presented without units. No numerical rounding is required.", "solution": "The problem is presented in two main parts. The first part requires the construction and verification of the tangent space to a submanifold defined as a level set. The second part asks for the derivation of the Itô drift for a specific Stratonovich SDE on the unit sphere. We will address these sequentially.\n\n### Part 1: Characterization of the Tangent Space\n\nLet $M \\subset \\mathbb{R}^{n}$ be a smooth submanifold defined by $M = F^{-1}(0)$, where $F: \\mathbb{R}^{n} \\to \\mathbb{R}^{m}$ is a smooth map and $0$ is a regular value. The tangent space $T_x M$ at a point $x \\in M$ is the set of velocity vectors of all smooth curves in $M$ passing through $x$.\n\nLet $\\gamma: (-\\epsilon, \\epsilon) \\to M$ be a smooth curve such that $\\gamma(0) = x$. A vector $v \\in \\mathbb{R}^{n}$ is in $T_x M$ if and only if there exists such a curve $\\gamma$ with $\\gamma'(0) = v$.\nSince the curve lies entirely within $M$, we have $F(\\gamma(t)) = 0$ for all $t$ in the domain of $\\gamma$. We can differentiate this expression with respect to $t$ using the chain rule:\n$$\n\\frac{d}{dt} F(\\gamma(t)) = D F(\\gamma(t)) \\cdot \\gamma'(t) = 0\n$$\nwhere $DF$ is the differential (Jacobian matrix) of $F$. Evaluating this at $t=0$, we have $\\gamma(0)=x$ and $\\gamma'(0)=v$. This gives:\n$$\nD F(x) \\cdot v = 0\n$$\nThis equation shows that any tangent vector $v \\in T_x M$ must belong to the kernel of the linear map $D F(x): \\mathbb{R}^{n} \\to \\mathbb{R}^{m}$. Therefore, we have the inclusion $T_x M \\subseteq \\ker(D F(x))$.\n\nTo show equality, we compare the dimensions of these two vector spaces. Since $0$ is a regular value of $F$, the level set $M = F^{-1}(0)$ is a smooth submanifold of $\\mathbb{R}^{n}$ of dimension $\\dim(M) = n-m$. The tangent space $T_x M$ is a vector space with the same dimension, so $\\dim(T_x M) = n-m$.\nThe differential $D F(x)$ is a linear map from $\\mathbb{R}^{n}$ to $\\mathbb{R}^{m}$. The condition that $0$ is a regular value means that for all $x \\in M$, the rank of $D F(x)$ is maximal, i.e., $\\operatorname{rank}(D F(x)) = m$. By the rank-nullity theorem, the dimension of the kernel of $D F(x)$ is:\n$$\n\\dim(\\ker(D F(x))) = \\dim(\\mathbb{R}^{n}) - \\operatorname{rank}(D F(x)) = n - m\n$$\nWe have established that $T_x M$ is a subspace of $\\ker(D F(x))$, and that both spaces have the same dimension $n-m$. This implies that the spaces must be identical:\n$$\nT_x M = \\ker(D F(x))\n$$\n\n### Part 2: Verification for the Unit Sphere $S^{n-1}$\n\nWe now verify this construction for the unit sphere $S^{n-1} = \\{ x \\in \\mathbb{R}^{n} : \\| x \\| = 1 \\}$. We can define the sphere as the zero level set of the function $F: \\mathbb{R}^{n} \\to \\mathbb{R}$ given by $F(x) = \\|x\\|^2 - 1$. Here, $m=1$.\nThe components of $x$ are $(x_1, \\dots, x_n)$, and $F(x) = \\sum_{i=1}^n x_i^2 - 1$.\nThe differential $D F(x)$ is represented by the gradient of $F$ as a $1 \\times n$ matrix (a row vector). The partial derivatives are $\\frac{\\partial F}{\\partial x_i} = 2x_i$. Thus, the gradient is $\\nabla F(x) = 2x$. The differential acts on a vector $v$ as $D F(x)(v) = \\nabla F(x) \\cdot v = 2x \\cdot v$.\nFor any point $x \\in S^{n-1}$, we have $\\|x\\|=1$, which implies $x \\neq 0$. Therefore, $\\nabla F(x) = 2x$ is a non-zero vector, and the rank of the $1 \\times n$ matrix $D F(x)$ is $1$. So, $\\operatorname{rank}(D F(x)) = 1 = m$, which confirms that $0$ is a regular value.\n\nUsing the result from Part 1, the tangent space at $x \\in S^{n-1}$ is:\n$$\nT_x S^{n-1} = \\ker(D F(x)) = \\{ v \\in \\mathbb{R}^{n} : D F(x)(v) = 0 \\}\n$$\nThis condition is $2x \\cdot v = 0$, which simplifies to $x \\cdot v = 0$.\nSo, we have explicitly constructed the tangent space as:\n$$\nT_x S^{n-1} = \\{ v \\in \\mathbb{R}^{n} : x \\cdot v = 0 \\}\n$$\nThis is the set of all vectors in $\\mathbb{R}^{n}$ that are orthogonal to the position vector $x$, which is the standard geometric description of the tangent space to a sphere at point $x$.\n\n### Part 3: Itô Drift Calculation\n\nWe are given the Stratonovich SDE on $S^{n-1}$:\n$$\nd X_{t} = P(X_{t}) \\circ d W_{t}\n$$\nwhere $P(x)$ is the orthogonal projection onto the tangent space $T_x S^{n-1}$. The corresponding Itô SDE is\n$$\nd X_{t} = b(X_{t}) \\, dt + P(X_{t}) \\, d W_{t}\n$$\nThe diffusion coefficient is the matrix-valued function $\\sigma(x) = P(x)$. The space $T_x S^{n-1}$ is the orthogonal complement of the space spanned by the normal vector. For $x \\in S^{n-1}$, the unit normal vector is $x$ itself. The projection onto the normal space is given by the matrix $xx^T$. The projection onto the tangent space is thus $P(x) = I - xx^T$, where $I$ is the $n \\times n$ identity matrix.\nSo, $\\sigma(x) = I - xx^T$. The components of this matrix are $\\sigma_{ij}(x) = \\delta_{ij} - x_i x_j$.\n\nThe components $b^i(x)$ of the Itô drift vector field $b(x)$ are given by the Stratonovich-to-Itô conversion formula:\n$$\nb^i(x) = \\frac{1}{2} \\sum_{j=1}^{n} \\sum_{k=1}^{n} \\frac{\\partial \\sigma_{ij}}{\\partial x_k}(x) \\sigma_{kj}(x)\n$$\nFirst, we compute the partial derivative of $\\sigma_{ij}$:\n$$\n\\frac{\\partial \\sigma_{ij}}{\\partial x_k} = \\frac{\\partial}{\\partial x_k}(\\delta_{ij} - x_i x_j) = - \\left( \\frac{\\partial x_i}{\\partial x_k} x_j + x_i \\frac{\\partial x_j}{\\partial x_k} \\right) = - (\\delta_{ik} x_j + x_i \\delta_{jk})\n$$\nNext, we substitute this and $\\sigma_{kj}(x) = \\delta_{kj} - x_k x_j$ into the formula for $b^i(x)$:\n$$\nb^i(x) = \\frac{1}{2} \\sum_{j,k=1}^{n} \\left( - (\\delta_{ik} x_j + x_i \\delta_{jk}) \\right) (\\delta_{kj} - x_k x_j)\n$$\nWe expand the product inside the summation:\n$$\n- (\\delta_{ik} x_j \\delta_{kj} - \\delta_{ik} x_j x_k x_j + x_i \\delta_{jk} \\delta_{kj} - x_i \\delta_{jk} x_k x_j)\n$$\nNow, we perform the summations over $j$ and $k$ for each of the four terms.\n1. Term 1: $\\sum_{j,k} (-\\delta_{ik} x_j \\delta_{kj}) = -\\sum_j (\\sum_k \\delta_{ik} \\delta_{kj}) x_j = -\\sum_j \\delta_{ij} x_j = -x_i$.\n2. Term 2: $\\sum_{j,k} (\\delta_{ik} x_j x_k x_j) = \\sum_{j} (\\sum_k \\delta_{ik} x_k) x_j^2 = \\sum_{j} x_i x_j^2 = x_i \\sum_{j} x_j^2 = x_i \\|x\\|^2$.\n3. Term 3: $\\sum_{j,k} (-x_i \\delta_{jk} \\delta_{kj}) = -x_i \\sum_j (\\sum_k \\delta_{jk} \\delta_{kj}) = -x_i \\sum_j \\delta_{jj} = -x_i \\sum_j 1 = -n x_i$.\n4. Term 4: $\\sum_{j,k} (x_i \\delta_{jk} x_k x_j) = x_i \\sum_j (\\sum_k \\delta_{jk} x_k) x_j = x_i \\sum_j x_j x_j = x_i \\sum_j x_j^2 = x_i \\|x\\|^2$.\n\nThe process $X_t$ evolves on $S^{n-1}$, so we evaluate for $x$ such that $\\|x\\|^2=1$. Summing the four terms gives:\n$$\n2 b^i(x) = -x_i + x_i - n x_i + x_i = (1 - n) x_i\n$$\nTherefore, the $i$-th component of the drift vector is $b^i(x) = \\frac{1-n}{2} x_i$. In vector form, the drift field is:\n$$\nb(x) = \\frac{1-n}{2} x = -\\frac{n-1}{2} x\n$$\nThis drift is a vector field pointing radially inward, which is necessary to counteract the tendency of the projected Brownian motion to move \"off\" the sphere, thus ensuring the process remains on the manifold. This is often referred to as the Itô correction term or spurious drift.\n\nWe can verify this result by applying Itô's lemma to the function $f(x) = \\|x\\|^2$. For the process $X_t$ to remain on the sphere, we must have $d(\\|X_t\\|^2)=0$.\n$d(\\|X_t\\|^2) = 2X_t \\cdot dX_t + [dX, dX]_t$. More precisely, $d f(X_t) = \\nabla f(X_t) \\cdot dX_t + \\frac{1}{2} \\operatorname{Tr}(\\nabla^2 f(X_t) (d X_t)(d X_t)^T)$.\nThe quadratic covariation tensor is $(dX_t)(dX_t)^T = \\sigma(X_t) \\sigma(X_t)^T dt = P(X_t) P(X_t)^T dt$. Since $P(x)$ is a symmetric projection matrix, $P(x)^T=P(x)$ and $P(x)^2=P(x)$. Thus, the quadratic covariation is $P(X_t) dt = (I-X_t X_t^T)dt$.\n$d(\\|X_t\\|^2) = 2X_t \\cdot (b(X_t)dt + P(X_t)dW_t) + \\frac{1}{2} \\operatorname{Tr}(2I \\cdot P(X_t)) dt$.\nSince $X_t$ is orthogonal to any vector in $T_{X_t}S^{n-1}$, $X_t \\cdot P(X_t)dW_t = 0$.\n$d(\\|X_t\\|^2) = (2X_t \\cdot b(X_t) + \\operatorname{Tr}(P(X_t))) dt$.\n$\\operatorname{Tr}(P(x)) = \\operatorname{Tr}(I - xx^T) = \\operatorname{Tr}(I) - \\operatorname{Tr}(xx^T) = n - \\|x\\|^2$. For $x \\in S^{n-1}$, this is $n-1$.\nSo, $d(\\|X_t\\|^2) = (2X_t \\cdot b(X_t) + n-1) dt$. Setting this to $0$ requires $2X_t \\cdot b(X_t) = -(n-1)$.\nOur calculated drift is $b(x) = -\\frac{n-1}{2} x$. Let's check:\n$2x \\cdot (-\\frac{n-1}{2} x) = -(n-1) (x \\cdot x) = -(n-1)\\|x\\|^2 = -(n-1)$.\nThe condition is satisfied, confirming our result.", "answer": "$$\\boxed{-\\frac{n-1}{2} x}$$", "id": "2995674"}, {"introduction": "Moving from the embedded view to an intrinsic description using coordinate charts, this exercise [@problem_id:2970362] tackles a common conceptual pitfall. We demonstrate that simply writing a standard Itô SDE in local coordinates fails to define a coordinate-invariant, and thus geometrically meaningful, process. By comparing this naive model with the true Brownian motion, whose generator is the Laplace-Beltrami operator, you will derive the required 'manifold drift' term that correctly accounts for the curvature of the space.", "problem": "Let $S^{2} \\subset \\mathbb{R}^{3}$ be the unit two-sphere equipped with its standard round Riemannian metric. In the spherical chart with colatitude $\\theta \\in (0,\\pi)$ and longitude $\\phi \\in (0,2\\pi)$, the metric is $g = d\\theta^{2} + \\sin^{2}(\\theta)\\, d\\phi^{2}$. Consider the following two stochastic models for a diffusion on $S^{2}$, written in this chart:\n\n1. A naive Itô-model in the chart that postulates independent, unscaled noise in the coordinates,\n$$\nd\\theta_{t} = dW^{1}_{t}, \\qquad d\\phi_{t} = dW^{2}_{t},\n$$\nwhere $W^{1}$ and $W^{2}$ are independent standard one-dimensional Brownian motions.\n\n2. A Stratonovich-model defined by a local orthonormal frame $\\{e_{1}, e_{2}\\}$ for the Riemannian metric, with\n$$\ne_{1} = \\partial_{\\theta}, \\qquad e_{2} = \\frac{1}{\\sin(\\theta)}\\, \\partial_{\\phi},\n$$\nand the Stratonovich stochastic differential equation (SDE)\n$$\ndX_{t} = e_{1}(X_{t}) \\circ dW^{1}_{t} + e_{2}(X_{t}) \\circ dW^{2}_{t}.\n$$\n\nUsing the following foundational principles:\n- Brownian motion on a Riemannian manifold is the diffusion whose generator is one-half of the Laplace–Beltrami operator.\n- In local coordinates, the generator of an Itô SDE $dY_{t} = b(Y_{t})\\, dt + \\sigma(Y_{t})\\, dW_{t}$ is $L f = b \\cdot \\nabla f + \\tfrac{1}{2} \\sum_{i,j} a^{ij} \\partial_{i}\\partial_{j} f$, with $a = \\sigma \\sigma^{\\top}$.\n- Stratonovich calculus is coordinate invariant under smooth changes of charts on the manifold.\n\nTasks:\n(a) Compute the generator $L_{\\text{naive}}$ of the naive Itô-model in this chart and compare it to one-half the Laplace–Beltrami operator on $S^{2}$. Explain why this naive Itô-model fails to be coordinate invariant.\n\n(b) Starting from the Stratonovich-model $dX_{t} = e_{1}(X_{t}) \\circ dW^{1}_{t} + e_{2}(X_{t}) \\circ dW^{2}_{t}$, convert it to an equivalent Itô SDE in the chart $(\\theta,\\phi)$ and determine the drift vector components $b^{\\theta}(\\theta)$ and $b^{\\phi}(\\theta)$ that must appear so that the Itô generator equals one-half of the Laplace–Beltrami operator. Express your final answer as the row matrix $\\pmatrix{b^{\\theta}(\\theta) & b^{\\phi}(\\theta)}$.\n\nYour final answer must be a single closed-form analytic expression. No rounding is required.", "solution": "The problem asks for an analysis of two different stochastic models on the unit two-sphere $S^2$ and their relationship to the geometric notion of Brownian motion, which is characterized by having a generator equal to one-half of the Laplace-Beltrami operator, $\\frac{1}{2}\\Delta_g$.\n\n(a) Analysis of the Naive Itô-Model\n\nFirst, we analyze the naive Itô-model given in the spherical chart $(\\theta, \\phi)$ by the SDEs:\n$$\nd\\theta_{t} = dW^{1}_{t}, \\qquad d\\phi_{t} = dW^{2}_{t}\n$$\nThis can be written in vector form $dY_t = b(Y_t) dt + \\sigma(Y_t) dW_t$ with $Y_t = (\\theta_t, \\phi_t)^{\\top}$.\nThe drift vector is $b = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}$.\nThe diffusion matrix is $\\sigma = \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix}$, the identity matrix $I$.\nThe matrix $a = \\sigma\\sigma^{\\top}$ is therefore also the identity matrix, $a=I$, so its components are $a^{11}=1$, $a^{22}=1$, and $a^{12}=a^{21}=0$.\n\nThe generator of this Itô SDE is given by the formula $L f = b \\cdot \\nabla f + \\frac{1}{2} \\sum_{i,j} a^{ij} \\partial_{i}\\partial_{j} f$.\nSubstituting the components of $b$ and $a$, we find the generator for the naive model, $L_{\\text{naive}}$:\n$$\nL_{\\text{naive}}f = (0 \\cdot \\partial_{\\theta}f + 0 \\cdot \\partial_{\\phi}f) + \\frac{1}{2} (1 \\cdot \\partial_{\\theta}^2 f + 0 \\cdot \\partial_\\theta\\partial_\\phi f + 0 \\cdot \\partial_\\phi\\partial_\\theta f + 1 \\cdot \\partial_{\\phi}^2 f)\n$$\n$$\nL_{\\text{naive}}f = \\frac{1}{2}(\\partial_{\\theta}^2 f + \\partial_{\\phi}^2 f)\n$$\nThis operator is the standard Euclidean Laplacian in polar coordinates, treating $\\theta$ and $\\phi$ as Cartesian coordinates.\n\nNext, we compute the Laplace-Beltrami operator $\\Delta_g$ for the given metric $g = d\\theta^2 + \\sin^2(\\theta) d\\phi^2$. The metric tensor and its inverse are:\n$$\ng_{ij} = \\begin{pmatrix} 1 & 0 \\\\ 0 & \\sin^2(\\theta) \\end{pmatrix}, \\qquad g^{ij} = \\begin{pmatrix} 1 & 0 \\\\ 0 & \\frac{1}{\\sin^2(\\theta)} \\end{pmatrix}\n$$\nThe determinant is $\\det(g) = \\sin^2(\\theta)$, so $\\sqrt{\\det(g)} = \\sin(\\theta)$ for $\\theta \\in (0, \\pi)$.\nThe general formula for the Laplace-Beltrami operator in local coordinates is $\\Delta_g f = \\frac{1}{\\sqrt{\\det(g)}} \\sum_{i,j} \\partial_i (\\sqrt{\\det(g)} g^{ij} \\partial_j f)$.\nFor our two-dimensional case $(x^1, x^2) = (\\theta, \\phi)$, this becomes:\n$$\n\\Delta_g f = \\frac{1}{\\sin(\\theta)} \\left[ \\partial_{\\theta}(\\sin(\\theta) g^{11} \\partial_{\\theta}f) + \\partial_{\\phi}(\\sin(\\theta) g^{22} \\partial_{\\phi}f) \\right]\n$$\n$$\n\\Delta_g f = \\frac{1}{\\sin(\\theta)} \\left[ \\partial_{\\theta}(\\sin(\\theta) \\cdot 1 \\cdot \\partial_{\\theta}f) + \\partial_{\\phi}\\left(\\sin(\\theta) \\cdot \\frac{1}{\\sin^2(\\theta)} \\cdot \\partial_{\\phi}f\\right) \\right]\n$$\n$$\n\\Delta_g f = \\frac{1}{\\sin(\\theta)} \\left[ \\partial_{\\theta}(\\sin(\\theta) \\partial_{\\theta}f) + \\partial_{\\phi}\\left(\\frac{1}{\\sin(\\theta)} \\partial_{\\phi}f\\right) \\right]\n$$\nApplying the product rule and noting that $\\sin(\\theta)$ is independent of $\\phi$:\n$$\n\\Delta_g f = \\frac{1}{\\sin(\\theta)} \\left[ \\cos(\\theta)\\partial_{\\theta}f + \\sin(\\theta)\\partial_{\\theta}^2 f + \\frac{1}{\\sin(\\theta)}\\partial_{\\phi}^2 f \\right]\n$$\n$$\n\\Delta_g f = \\cot(\\theta)\\partial_{\\theta}f + \\partial_{\\theta}^2 f + \\frac{1}{\\sin^2(\\theta)}\\partial_{\\phi}^2 f\n$$\nThe generator for Brownian motion on $S^2$ is one-half of this operator:\n$$\n\\frac{1}{2}\\Delta_g f = \\frac{1}{2}\\left( \\partial_{\\theta}^2 f + \\cot(\\theta)\\partial_{\\theta}f + \\frac{1}{\\sin^2(\\theta)}\\partial_{\\phi}^2 f \\right)\n$$\nComparing $L_{\\text{naive}}$ with $\\frac{1}{2}\\Delta_g$, it is evident that they are not equal. The naive Itô-model does not describe Brownian motion on the sphere.\n\nThis model fails to be coordinate invariant because Itô calculus does not obey the classical chain rule. Under a change of coordinates, the Itô SDE transforms in a way that involves second derivatives of the transformation map (Itô's lemma). An SDE with zero drift and identity diffusion in one chart will not, in general, retain this simple form in another chart. A geometrically meaningful diffusion must be described by objects that transform tensorially. The naive model simply treats the manifold chart as a flat Euclidean space, ignoring the curvature encoded in the metric, and is therefore intrinsically chart-dependent.\n\n(b) Analysis of the Stratonovich-Model and Determination of the Itô Drift\n\nThe problem provides a Stratonovich model and asks for the determination of an Itô drift $b(\\theta, \\phi) = (b^{\\theta}, b^{\\phi})$ such that the resulting Itô SDE's generator is $\\frac{1}{2}\\Delta_g$. The Stratonovich model is given by the orthonormal frame $\\{e_1, e_2\\}$:\n$$\ne_1 = \\partial_{\\theta} = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}, \\qquad e_2 = \\frac{1}{\\sin(\\theta)}\\partial_{\\phi} = \\begin{pmatrix} 0 \\\\ \\frac{1}{\\sin(\\theta)} \\end{pmatrix}\n$$\nThe Itô SDE in question has the form $dX_t = b(X_t) dt + \\sigma(X_t) dW_t$. The diffusion matrix $\\sigma$ is specified by the vector fields of the Stratonovich model, where the columns of $\\sigma$ are the components of $e_k$ in the coordinate basis:\n$$\n\\sigma = \\begin{pmatrix} 1 & 0 \\\\ 0 & \\frac{1}{\\sin(\\theta)} \\end{pmatrix}\n$$\nThe matrix $a = \\sigma\\sigma^{\\top}$ required for the Itô generator is then:\n$$\na = \\sigma\\sigma^{\\top} = \\begin{pmatrix} 1 & 0 \\\\ 0 & \\frac{1}{\\sin(\\theta)} \\end{pmatrix} \\begin{pmatrix} 1 & 0 \\\\ 0 & \\frac{1}{\\sin(\\theta)} \\end{pmatrix}^{\\top} = \\begin{pmatrix} 1 & 0 \\\\ 0 & \\frac{1}{\\sin^2(\\theta)} \\end{pmatrix}\n$$\nWe observe that $a^{ij} = g^{ij}$, which is the condition on the diffusion matrix for it to represent an isotropic diffusion with respect to the metric $g$.\n\nThe generator of this Itô process is:\n$$\nL_{\\text{Itô}} f = b^{\\theta}(\\theta,\\phi)\\partial_{\\theta}f + b^{\\phi}(\\theta,\\phi)\\partial_{\\phi}f + \\frac{1}{2}(a^{\\theta\\theta}\\partial_{\\theta}^2 f + 2a^{\\theta\\phi}\\partial_{\\theta}\\partial_{\\phi}f + a^{\\phi\\phi}\\partial_{\\phi}^2 f)\n$$\n$$\nL_{\\text{Itô}} f = b^{\\theta}(\\theta)\\partial_{\\theta}f + b^{\\phi}(\\theta)\\partial_{\\phi}f + \\frac{1}{2}\\left( \\partial_{\\theta}^2 f + \\frac{1}{\\sin^2(\\theta)}\\partial_{\\phi}^2 f \\right)\n$$\n(We assume the drift components depend only on $\\theta$ by symmetry, which will be confirmed by the calculation).\n\nWe equate this generator $L_{\\text{Itô}}$ with the required generator for Brownian motion, $\\frac{1}{2}\\Delta_g$, which was calculated in part (a):\n$$\nb^{\\theta}\\partial_{\\theta}f + b^{\\phi}\\partial_{\\phi}f + \\frac{1}{2}\\left( \\partial_{\\theta}^2 f + \\frac{1}{\\sin^2(\\theta)}\\partial_{\\phi}^2 f \\right) = \\frac{1}{2}\\left( \\partial_{\\theta}^2 f + \\cot(\\theta)\\partial_{\\theta}f + \\frac{1}{\\sin^2(\\theta)}\\partial_{\\phi}^2 f \\right)\n$$\nThe second-order derivative terms cancel on both sides, leaving an equation for the first-order terms:\n$$\nb^{\\theta}\\partial_{\\theta}f + b^{\\phi}\\partial_{\\phi}f = \\frac{1}{2} \\cot(\\theta)\\partial_{\\theta}f\n$$\nThis equality must hold for any arbitrary smooth function $f(\\theta, \\phi)$. By choosing test functions, we can determine the components of the drift vector.\nLet $f(\\theta, \\phi) = \\theta$. Then $\\partial_{\\theta}f = 1$ and $\\partial_{\\phi}f = 0$. The equation becomes:\n$$\nb^{\\theta} \\cdot 1 + b^{\\phi} \\cdot 0 = \\frac{1}{2} \\cot(\\theta) \\cdot 1 \\implies b^{\\theta}(\\theta) = \\frac{1}{2}\\cot(\\theta)\n$$\nLet $f(\\theta, \\phi) = \\phi$. Then $\\partial_{\\theta}f = 0$ and $\\partial_{\\phi}f = 1$. The equation becomes:\n$$\nb^{\\theta} \\cdot 0 + b^{\\phi} \\cdot 1 = \\frac{1}{2} \\cot(\\theta) \\cdot 0 \\implies b^{\\phi}(\\theta) = 0\n$$\nThus, the required Itô drift vector components are $b^{\\theta}(\\theta) = \\frac{1}{2}\\cot(\\theta)$ and $b^{\\phi}(\\theta) = 0$. This drift term is often referred to as the Itô correction term or manifold drift, which arises from the geometry of the manifold and ensures the process is a true Brownian motion.\nThe final answer is presented as a row matrix.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{1}{2}\\cot(\\theta) & 0\n\\end{pmatrix}\n}\n$$", "id": "2970362"}, {"introduction": "This final practice elevates our understanding from specific examples to general theory, unifying the insights gained from the previous exercises [@problem_id:2995674] [@problem_id:2970362]. The 'correction terms' we've encountered are not ad-hoc adjustments but are manifestations of the manifold's connection structure. In this problem [@problem_id:2997136], you will derive the universal conversion formula between a geometric Itô SDE and its Stratonovich counterpart, expressing the difference explicitly in terms of the Christoffel symbols, which encode the derivatives of the metric.", "problem": "Let $\\left(M,g\\right)$ be a smooth $n$-dimensional Riemannian manifold with Levi-Civita connection $\\nabla$, and let $\\Gamma^{k}_{\\alpha m}\\left(x\\right)$ denote the Christoffel symbols of $\\nabla$ in a local chart $\\left(U;x^{1},\\dots,x^{n}\\right)$. Consider an $\\mathbb{R}^{d}$-driven Itô stochastic differential equation (stochastic differential equation (SDE)) in local coordinates for a semimartingale $X_{t}\\in U\\subset M$,\n$$\ndX_{t}^{k} \\;=\\; \\sum_{i=1}^{d} V_{i}^{k}\\!\\left(X_{t}\\right)\\,dW_{t}^{i} \\;+\\; V_{0}^{k}\\!\\left(X_{t}\\right)\\,dt, \\quad k=1,\\dots,n,\n$$\nwhere $W^{1},\\dots,W^{d}$ are independent one-dimensional standard Brownian motions, and $V_{i}=\\sum_{k=1}^{n}V_{i}^{k}\\partial_{k}$, $i=0,1,\\dots,d$, are smooth vector fields on $U$. Interpreting the noise geometrically via stochastic development on $\\left(M,g\\right)$ and parallel transport along $\\nabla$, write the equivalent Stratonovich SDE\n$$\ndX_{t}^{k} \\;=\\; \\sum_{i=1}^{d} V_{i}^{k}\\!\\left(X_{t}\\right)\\,\\circ dW_{t}^{i} \\;+\\; \\tilde{V}_{0}^{k}\\!\\left(X_{t}\\right)\\,dt,\n$$\nand determine the Stratonovich drift $\\tilde{V}_{0}=\\sum_{k=1}^{n}\\tilde{V}_{0}^{k}\\partial_{k}$ in terms of the covariant derivatives and the Christoffel symbols $\\Gamma^{k}_{\\alpha m}$. Your final answer must be a single closed-form analytic expression for $\\tilde{V}_{0}^{k}$ in coordinates $\\left(x^{1},\\dots,x^{n}\\right)$, expressed only through $V_{0}^{k}$, $V_{i}^{\\alpha}$, $\\partial_{\\alpha}V_{i}^{k}$, and $\\Gamma^{k}_{\\alpha m}$, with all summations explicitly indicated. No numerical evaluation is required.", "solution": "The core of the problem lies in relating the two different representations of the same underlying geometric stochastic process. The most rigorous way to do this is by equating the infinitesimal generators of the process derived from both the Itô and Stratonovich representations.\n\nLet $X_{t}$ be the stochastic process on the manifold $M$. Let $f: M \\to \\mathbb{R}$ be an arbitrary smooth function (a test function). The time evolution of the expectation of $f(X_t)$ is governed by the infinitesimal generator $\\mathcal{L}$ of the process, such that $\\frac{d}{dt}\\mathbb{E}[f(X_t)] = \\mathbb{E}[(\\mathcal{L}f)(X_t)]$.\n\nFirst, consider the Stratonovich SDE:\n$$ dX_{t}^{k} = \\sum_{i=1}^{d} V_{i}^{k}(X_{t})\\,\\circ dW_{t}^{i} + \\tilde{V}_{0}^{k}(X_{t})\\,dt $$\nThis is a coordinate representation of the geometric SDE $dX_{t} = \\sum_{i=1}^{d} V_{i}(X_t) \\circ dW_t^i + \\tilde{V}_0(X_t) dt$. A key property of the Stratonovich integral is that it obeys the ordinary chain rule. Therefore, for a smooth function $f$, we have:\n$$ df(X_t) = \\sum_{k=1}^n \\frac{\\partial f}{\\partial x^k} dX_t^k = \\sum_{k=1}^n \\frac{\\partial f}{\\partial x^k} \\left( \\sum_{i=1}^{d} V_{i}^{k} \\circ dW_{t}^{i} + \\tilde{V}_{0}^{k} dt \\right) = \\sum_{i=1}^{d} (V_i f) \\circ dW_t^i + (\\tilde{V}_0 f) dt $$\nwhere $V_i f = \\sum_{k=1}^n V_i^k \\frac{\\partial f}{\\partial x^k}$ is the action of the vector field $V_i$ on $f$.\nThe generator for a process defined by a Stratonovich SDE is given by $\\mathcal{L} = \\tilde{V}_0 + \\frac{1}{2}\\sum_{i=1}^d V_i^2$, where $V_i^2 f = V_i(V_i f)$. Let us write this out in local coordinates.\n$$ (\\mathcal{L}f)(x) = (\\tilde{V}_0 f)(x) + \\frac{1}{2} \\sum_{i=1}^{d} V_i(V_i f)(x) $$\n$$ (\\mathcal{L}f)(x) = \\sum_{k=1}^{n} \\tilde{V}_{0}^{k} \\frac{\\partial f}{\\partial x^{k}} + \\frac{1}{2} \\sum_{i=1}^{d} \\left( \\sum_{\\alpha=1}^{n} V_{i}^{\\alpha} \\frac{\\partial}{\\partial x^{\\alpha}} \\right) \\left( \\sum_{m=1}^{n} V_{i}^{m} \\frac{\\partial f}{\\partial x^{m}} \\right) $$\nApplying the product rule for differentiation:\n$$ (\\mathcal{L}f)(x) = \\sum_{k=1}^{n} \\tilde{V}_{0}^{k} \\frac{\\partial f}{\\partial x^{k}} + \\frac{1}{2} \\sum_{i=1}^{d} \\sum_{\\alpha=1}^{n} \\sum_{m=1}^{n} V_{i}^{\\alpha} \\left( \\frac{\\partial V_{i}^{m}}{\\partial x^{\\alpha}} \\frac{\\partial f}{\\partial x^{m}} + V_{i}^{m} \\frac{\\partial^{2} f}{\\partial x^{\\alpha} \\partial x^{m}} \\right) $$\nGrouping terms by the order of derivatives of $f$:\n$$ (\\mathcal{L}f)(x) = \\sum_{k=1}^{n} \\left( \\tilde{V}_{0}^{k} + \\frac{1}{2} \\sum_{i=1}^{d} \\sum_{\\alpha=1}^{n} V_{i}^{\\alpha} \\frac{\\partial V_{i}^{k}}{\\partial x^{\\alpha}} \\right) \\frac{\\partial f}{\\partial x^{k}} + \\frac{1}{2} \\sum_{i=1}^{d} \\sum_{\\alpha=1}^{n} \\sum_{m=1}^{n} V_{i}^{\\alpha} V_{i}^{m} \\frac{\\partial^{2} f}{\\partial x^{\\alpha} \\partial x^{m}} \\quad (*)$$\n\nNext, we consider the Itô SDE given in the problem statement. The phrase \"interpreting the noise geometrically\" implies this SDE is the coordinate representation of a stochastic development on the manifold. The generator of such a process is given by the application of Itô's formula for manifolds to the function $f(X_t)$. For the Itô SDE\n$$ dX_{t}^{k} = \\sum_{i=1}^{d} V_{i}^{k}(X_{t})\\,dW_{t}^{i} + V_{0}^{k}(X_{t})\\,dt $$\nthe generator $\\mathcal{L}$ acting on $f$ is:\n$$ (\\mathcal{L}f)(x) = \\sum_{k=1}^{n} V_0^k \\frac{\\partial f}{\\partial x^k} + \\frac{1}{2} \\sum_{k=1}^{n} \\sum_{m=1}^{n} \\left( \\sum_{i=1}^{d} V_i^k V_i^m \\right) (\\nabla^2 f)_{km} $$\nwhere $(\\nabla^2 f)_{km}$ is the component of the Riemannian Hessian of $f$. In local coordinates, the Hessian is expressed using Christoffel symbols:\n$$ (\\nabla^2 f)_{km} = \\frac{\\partial^2 f}{\\partial x^k \\partial x^m} - \\sum_{j=1}^{n} \\Gamma_{km}^{j} \\frac{\\partial f}{\\partial x^j} $$\nSubstituting this into the expression for the generator:\n$$ (\\mathcal{L}f)(x) = \\sum_{k=1}^{n} V_0^k \\frac{\\partial f}{\\partial x^k} + \\frac{1}{2} \\sum_{k=1}^{n} \\sum_{m=1}^{n} \\left( \\sum_{i=1}^{d} V_i^k V_i^m \\right) \\left( \\frac{\\partial^2 f}{\\partial x^k \\partial x^m} - \\sum_{j=1}^{n} \\Gamma_{km}^{j} \\frac{\\partial f}{\\partial x^j} \\right) $$\nRearranging and grouping terms by the order of derivatives of $f$:\n$$ (\\mathcal{L}f)(x) = \\sum_{j=1}^{n} \\left( V_0^j - \\frac{1}{2} \\sum_{i=1}^{d} \\sum_{k=1}^{n} \\sum_{m=1}^{n} V_i^k V_i^m \\Gamma_{km}^{j} \\right) \\frac{\\partial f}{\\partial x^j} + \\frac{1}{2} \\sum_{i=1}^{d} \\sum_{k=1}^{n} \\sum_{m=1}^{n} V_i^k V_i^m \\frac{\\partial^2 f}{\\partial x^k \\partial x^m} \\quad (**) $$\n\nSince both generators $(*)$ and $(**)$ describe the same process, they must be identical for any smooth function $f$. We can therefore equate the coefficients of the partial derivatives of $f$. The coefficients of the second-order derivatives $\\frac{\\partial^2 f}{\\partial x^\\alpha \\partial x^m}$ are clearly identical in both expressions. Equating the coefficients of the first-order derivatives $\\frac{\\partial f}{\\partial x^k}$ (using $k$ as the free index), we get:\n$$ \\tilde{V}_{0}^{k} + \\frac{1}{2} \\sum_{i=1}^{d} \\sum_{\\alpha=1}^{n} V_{i}^{\\alpha} \\frac{\\partial V_{i}^{k}}{\\partial x^{\\alpha}} = V_0^k - \\frac{1}{2} \\sum_{i=1}^{d} \\sum_{\\alpha=1}^{n} \\sum_{m=1}^{n} V_i^\\alpha V_i^m \\Gamma_{\\alpha m}^{k} $$\nHere, we have relabeled the dummy summation indices in the second term on the right-hand side from $(k,m)$ to $(\\alpha,m)$ for clarity.\n\nFinally, we solve for the Stratonovich drift component $\\tilde{V}_{0}^{k}$:\n$$ \\tilde{V}_{0}^{k} = V_0^k - \\frac{1}{2} \\sum_{i=1}^{d} \\sum_{\\alpha=1}^{n} V_{i}^{\\alpha} \\frac{\\partial V_{i}^{k}}{\\partial x^{\\alpha}} - \\frac{1}{2} \\sum_{i=1}^{d} \\sum_{\\alpha=1}^{n} \\sum_{m=1}^{n} \\Gamma_{\\alpha m}^{k} V_i^\\alpha V_i^m $$\nThis can be written more compactly as:\n$$ \\tilde{V}_{0}^{k} = V_{0}^{k} - \\frac{1}{2} \\sum_{i=1}^{d} \\left( \\sum_{\\alpha=1}^{n} V_{i}^{\\alpha} \\frac{\\partial V_{i}^{k}}{\\partial x^{\\alpha}} + \\sum_{\\alpha=1}^{n} \\sum_{m=1}^{n} \\Gamma^{k}_{\\alpha m} V_{i}^{\\alpha} V_{i}^{m} \\right) $$\nThe term in the parenthesis is the $k$-th component of the covariant derivative of the vector field $V_i$ in its own direction, $\\nabla_{V_i} V_i$. Thus, the coordinate-free relationship is $\\tilde{V}_0 = V_0 - \\frac{1}{2}\\sum_{i=1}^d \\nabla_{V_i}V_i$. The expression derived above is its explicit representation in local coordinates, as requested by the problem. The term $\\frac{\\partial V_{i}^{k}}{\\partial x^{\\alpha}}$ is what the problem denotes as $\\partial_{\\alpha}V_{i}^{k}$.", "answer": "$$\n\\boxed{\nV_{0}^{k} - \\frac{1}{2} \\sum_{i=1}^{d} \\left( \\sum_{\\alpha=1}^{n} V_{i}^{\\alpha} \\frac{\\partial V_{i}^{k}}{\\partial x^{\\alpha}} + \\sum_{\\alpha=1}^{n} \\sum_{m=1}^{n} \\Gamma^{k}_{\\alpha m} V_{i}^{\\alpha} V_{i}^{m} \\right)\n}\n$$", "id": "2997136"}]}