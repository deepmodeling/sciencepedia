{"hands_on_practices": [{"introduction": "A core challenge in stochastic analysis on manifolds is defining a process that is geometrically meaningful and independent of the chosen coordinate system. This exercise [@problem_id:2970362] tackles this issue head-on by demonstrating why a naive application of Itô calculus in a local chart fails to produce the true Brownian motion on the sphere. By working through the conversion from a geometrically-defined Stratonovich SDE, you will derive the crucial Itô correction term, gaining a deep, practical understanding of how manifold curvature manifests as a drift term in local coordinates.", "problem": "Let $S^{2} \\subset \\mathbb{R}^{3}$ be the unit two-sphere equipped with its standard round Riemannian metric. In the spherical chart with colatitude $\\theta \\in (0,\\pi)$ and longitude $\\phi \\in (0,2\\pi)$, the metric is $g = d\\theta^{2} + \\sin^{2}(\\theta)\\, d\\phi^{2}$. Consider the following two stochastic models for a diffusion on $S^{2}$, written in this chart:\n\n1. A naive Itô-model in the chart that postulates independent, unscaled noise in the coordinates,\n$$\nd\\theta_{t} = dW^{1}_{t}, \\qquad d\\phi_{t} = dW^{2}_{t},\n$$\nwhere $W^{1}$ and $W^{2}$ are independent standard one-dimensional Brownian motions.\n\n2. A Stratonovich-model defined by a local orthonormal frame $\\{e_{1}, e_{2}\\}$ for the Riemannian metric, with\n$$\ne_{1} = \\partial_{\\theta}, \\qquad e_{2} = \\frac{1}{\\sin(\\theta)}\\, \\partial_{\\phi},\n$$\nand the Stratonovich stochastic differential equation (SDE)\n$$\ndX_{t} = e_{1}(X_{t}) \\circ dW^{1}_{t} + e_{2}(X_{t}) \\circ dW^{2}_{t}.\n$$\n\nUsing the following foundational principles:\n- Brownian motion on a Riemannian manifold is the diffusion whose generator is one-half of the Laplace–Beltrami operator.\n- In local coordinates, the generator of an Itô SDE $dY_{t} = b(Y_{t})\\, dt + \\sigma(Y_{t})\\, dW_{t}$ is $L f = b \\cdot \\nabla f + \\tfrac{1}{2} \\sum_{i,j} a^{ij} \\partial_{i}\\partial_{j} f$, with $a = \\sigma \\sigma^{\\top}$.\n- Stratonovich calculus is coordinate invariant under smooth changes of charts on the manifold.\n\nTasks:\n(a) Compute the generator $L_{\\text{naive}}$ of the naive Itô-model in this chart and compare it to one-half the Laplace–Beltrami operator on $S^{2}$. Explain why this naive Itô-model fails to be coordinate invariant.\n\n(b) Starting from the Stratonovich-model $dX_{t} = e_{1}(X_{t}) \\circ dW^{1}_{t} + e_{2}(X_{t}) \\circ dW^{2}_{t}$, convert it to an equivalent Itô SDE in the chart $(\\theta,\\phi)$ and determine the drift vector components $b^{\\theta}(\\theta)$ and $b^{\\phi}(\\theta)$ that must appear so that the Itô generator equals one-half of the Laplace–Beltrami operator. Express your final answer as the row matrix $\\begin{pmatrix} b^{\\theta}(\\theta) & b^{\\phi}(\\theta) \\end{pmatrix}$.\n\nYour final answer must be a single closed-form analytic expression. No rounding is required.", "solution": "The problem statement has been validated and is deemed a well-posed and scientifically grounded exercise in stochastic differential geometry.\n\nThe problem asks for an analysis of two different stochastic models on the unit two-sphere $S^2$ and their relationship to the geometric notion of Brownian motion, which is characterized by having a generator equal to one-half of the Laplace-Beltrami operator, $\\frac{1}{2}\\Delta_g$.\n\n(a) Analysis of the Naive Itô-Model\n\nFirst, we analyze the naive Itô-model given in the spherical chart $(\\theta, \\phi)$ by the SDEs:\n$$\nd\\theta_{t} = dW^{1}_{t}, \\qquad d\\phi_{t} = dW^{2}_{t}\n$$\nThis can be written in vector form $dY_t = b(Y_t) dt + \\sigma(Y_t) dW_t$ with $Y_t = (\\theta_t, \\phi_t)^{\\top}$.\nThe drift vector is $b = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}$.\nThe diffusion matrix is $\\sigma = \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix}$, the identity matrix $I$.\nThe matrix $a = \\sigma\\sigma^{\\top}$ is therefore also the identity matrix, $a=I$, so its components are $a^{11}=1$, $a^{22}=1$, and $a^{12}=a^{21}=0$.\n\nThe generator of this Itô SDE is given by the formula $L f = b \\cdot \\nabla f + \\frac{1}{2} \\sum_{i,j} a^{ij} \\partial_{i}\\partial_{j} f$.\nSubstituting the components of $b$ and $a$, we find the generator for the naive model, $L_{\\text{naive}}$:\n$$\nL_{\\text{naive}}f = (0 \\cdot \\partial_{\\theta}f + 0 \\cdot \\partial_{\\phi}f) + \\frac{1}{2} (1 \\cdot \\partial_{\\theta}^2 f + 0 \\cdot \\partial_\\theta\\partial_\\phi f + 0 \\cdot \\partial_\\phi\\partial_\\theta f + 1 \\cdot \\partial_{\\phi}^2 f)\n$$\n$$\nL_{\\text{naive}}f = \\frac{1}{2}(\\partial_{\\theta}^2 f + \\partial_{\\phi}^2 f)\n$$\nThis operator is the standard Euclidean Laplacian in polar coordinates, treating $\\theta$ and $\\phi$ as Cartesian coordinates.\n\nNext, we compute the Laplace-Beltrami operator $\\Delta_g$ for the given metric $g = d\\theta^2 + \\sin^2(\\theta) d\\phi^2$. The metric tensor and its inverse are:\n$$\ng_{ij} = \\begin{pmatrix} 1 & 0 \\\\ 0 & \\sin^2(\\theta) \\end{pmatrix}, \\qquad g^{ij} = \\begin{pmatrix} 1 & 0 \\\\ 0 & \\frac{1}{\\sin^2(\\theta)} \\end{pmatrix}\n$$\nThe determinant is $\\det(g) = \\sin^2(\\theta)$, so $\\sqrt{\\det(g)} = \\sin(\\theta)$ for $\\theta \\in (0, \\pi)$.\nThe general formula for the Laplace-Beltrami operator in local coordinates is $\\Delta_g f = \\frac{1}{\\sqrt{\\det(g)}} \\sum_{i,j} \\partial_i (\\sqrt{\\det(g)} g^{ij} \\partial_j f)$.\nFor our two-dimensional case $(x^1, x^2) = (\\theta, \\phi)$, this becomes:\n$$\n\\Delta_g f = \\frac{1}{\\sin(\\theta)} \\left[ \\partial_{\\theta}(\\sin(\\theta) g^{11} \\partial_{\\theta}f) + \\partial_{\\phi}(\\sin(\\theta) g^{22} \\partial_{\\phi}f) \\right]\n$$\n$$\n\\Delta_g f = \\frac{1}{\\sin(\\theta)} \\left[ \\partial_{\\theta}(\\sin(\\theta) \\cdot 1 \\cdot \\partial_{\\theta}f) + \\partial_{\\phi}\\left(\\sin(\\theta) \\cdot \\frac{1}{\\sin^2(\\theta)} \\cdot \\partial_{\\phi}f\\right) \\right]\n$$\n$$\n\\Delta_g f = \\frac{1}{\\sin(\\theta)} \\left[ \\partial_{\\theta}(\\sin(\\theta) \\partial_{\\theta}f) + \\partial_{\\phi}\\left(\\frac{1}{\\sin(\\theta)} \\partial_{\\phi}f\\right) \\right]\n$$\nApplying the product rule and noting that $\\sin(\\theta)$ is independent of $\\phi$:\n$$\n\\Delta_g f = \\frac{1}{\\sin(\\theta)} \\left[ \\cos(\\theta)\\partial_{\\theta}f + \\sin(\\theta)\\partial_{\\theta}^2 f + \\frac{1}{\\sin(\\theta)}\\partial_{\\phi}^2 f \\right]\n$$\n$$\n\\Delta_g f = \\cot(\\theta)\\partial_{\\theta}f + \\partial_{\\theta}^2 f + \\frac{1}{\\sin^2(\\theta)}\\partial_{\\phi}^2 f\n$$\nThe generator for Brownian motion on $S^2$ is one-half of this operator:\n$$\n\\frac{1}{2}\\Delta_g f = \\frac{1}{2}\\left( \\partial_{\\theta}^2 f + \\cot(\\theta)\\partial_{\\theta}f + \\frac{1}{\\sin^2(\\theta)}\\partial_{\\phi}^2 f \\right)\n$$\nComparing $L_{\\text{naive}}$ with $\\frac{1}{2}\\Delta_g$, it is evident that they are not equal. The naive Itô-model does not describe Brownian motion on the sphere.\n\nThis model fails to be coordinate invariant because Itô calculus does not obey the classical chain rule. Under a change of coordinates, the Itô SDE transforms in a way that involves second derivatives of the transformation map (Itô's lemma). An SDE with zero drift and identity diffusion in one chart will not, in general, retain this simple form in another chart. A geometrically meaningful diffusion must be described by objects that transform tensorially. The naive model simply treats the manifold chart as a flat Euclidean space, ignoring the curvature encoded in the metric, and is therefore intrinsically chart-dependent.\n\n(b) Analysis of the Stratonovich-Model and Determination of the Itô Drift\n\nThe problem provides a Stratonovich model and asks for the determination of an Itô drift $b(\\theta, \\phi) = (b^{\\theta}, b^{\\phi})$ such that the resulting Itô SDE's generator is $\\frac{1}{2}\\Delta_g$. The Stratonovich model is given by the orthonormal frame $\\{e_1, e_2\\}$:\n$$\ne_1 = \\partial_{\\theta} = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}, \\qquad e_2 = \\frac{1}{\\sin(\\theta)}\\partial_{\\phi} = \\begin{pmatrix} 0 \\\\ \\frac{1}{\\sin(\\theta)} \\end{pmatrix}\n$$\nThe Itô SDE in question has the form $dX_t = b(X_t) dt + \\sigma(X_t) dW_t$. The diffusion matrix $\\sigma$ is specified by the vector fields of the Stratonovich model, where the columns of $\\sigma$ are the components of $e_k$ in the coordinate basis:\n$$\n\\sigma = \\begin{pmatrix} 1 & 0 \\\\ 0 & \\frac{1}{\\sin(\\theta)} \\end{pmatrix}\n$$\nThe matrix $a = \\sigma\\sigma^{\\top}$ required for the Itô generator is then:\n$$\na = \\sigma\\sigma^{\\top} = \\begin{pmatrix} 1 & 0 \\\\ 0 & \\frac{1}{\\sin(\\theta)} \\end{pmatrix} \\begin{pmatrix} 1 & 0 \\\\ 0 & \\frac{1}{\\sin(\\theta)} \\end{pmatrix}^{\\top} = \\begin{pmatrix} 1 & 0 \\\\ 0 & \\frac{1}{\\sin^2(\\theta)} \\end{pmatrix}\n$$\nWe observe that $a^{ij} = g^{ij}$, which is the condition on the diffusion matrix for it to represent an isotropic diffusion with respect to the metric $g$.\n\nThe generator of this Itô process is:\n$$\nL_{\\text{Itô}} f = b^{\\theta}(\\theta,\\phi)\\partial_{\\theta}f + b^{\\phi}(\\theta,\\phi)\\partial_{\\phi}f + \\frac{1}{2}(a^{\\theta\\theta}\\partial_{\\theta}^2 f + 2a^{\\theta\\phi}\\partial_{\\theta}\\partial_{\\phi}f + a^{\\phi\\phi}\\partial_{\\phi}^2 f)\n$$\n$$\nL_{\\text{Itô}} f = b^{\\theta}(\\theta)\\partial_{\\theta}f + b^{\\phi}(\\theta)\\partial_{\\phi}f + \\frac{1}{2}\\left( \\partial_{\\theta}^2 f + \\frac{1}{\\sin^2(\\theta)}\\partial_{\\phi}^2 f \\right)\n$$\n(We assume the drift components depend only on $\\theta$ by symmetry, which will be confirmed by the calculation).\n\nWe equate this generator $L_{\\text{Itô}}$ with the required generator for Brownian motion, $\\frac{1}{2}\\Delta_g$, which was calculated in part (a):\n$$\nb^{\\theta}\\partial_{\\theta}f + b^{\\phi}\\partial_{\\phi}f + \\frac{1}{2}\\left( \\partial_{\\theta}^2 f + \\frac{1}{\\sin^2(\\theta)}\\partial_{\\phi}^2 f \\right) = \\frac{1}{2}\\left( \\partial_{\\theta}^2 f + \\cot(\\theta)\\partial_{\\theta}f + \\frac{1}{\\sin^2(\\theta)}\\partial_{\\phi}^2 f \\right)\n$$\nThe second-order derivative terms cancel on both sides, leaving an equation for the first-order terms:\n$$\nb^{\\theta}\\partial_{\\theta}f + b^{\\phi}\\partial_{\\phi}f = \\frac{1}{2} \\cot(\\theta)\\partial_{\\theta}f\n$$\nThis equality must hold for any arbitrary smooth function $f(\\theta, \\phi)$. By choosing test functions, we can determine the components of the drift vector.\nLet $f(\\theta, \\phi) = \\theta$. Then $\\partial_{\\theta}f = 1$ and $\\partial_{\\phi}f = 0$. The equation becomes:\n$$\nb^{\\theta} \\cdot 1 + b^{\\phi} \\cdot 0 = \\frac{1}{2} \\cot(\\theta) \\cdot 1 \\implies b^{\\theta}(\\theta) = \\frac{1}{2}\\cot(\\theta)\n$$\nLet $f(\\theta, \\phi) = \\phi$. Then $\\partial_{\\theta}f = 0$ and $\\partial_{\\phi}f = 1$. The equation becomes:\n$$\nb^{\\theta} \\cdot 0 + b^{\\phi} \\cdot 1 = \\frac{1}{2} \\cot(\\theta) \\cdot 0 \\implies b^{\\phi}(\\theta) = 0\n$$\nThus, the required Itô drift vector components are $b^{\\theta}(\\theta) = \\frac{1}{2}\\cot(\\theta)$ and $b^{\\phi}(\\theta) = 0$. This drift term is often referred to as the Itô correction term or manifold drift, which arises from the geometry of the manifold and ensures the process is a true Brownian motion.\nThe final answer is presented as a row matrix.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{1}{2}\\cot(\\theta) & 0\n\\end{pmatrix}\n}\n$$", "id": "2970362"}, {"introduction": "The principles of geometric diffusion extend beyond Riemannian manifolds to more exotic structures like sub-Riemannian manifolds, where motion is restricted to a \"horizontal\" subbundle of the tangent space. This practice [@problem_id:2970353] introduces the Heisenberg group as a canonical example, guiding you through the construction of its horizontal Brownian motion and the derivation of its generator, the sub-Laplacian. You will then use the group's natural dilation structure to uncover the scaling behavior of its heat kernel, a powerful technique for analyzing diffusions on spaces with non-standard scaling.", "problem": "Consider the Heisenberg group $\\mathbb{H}^{n}$ modeled as $\\mathbb{R}^{2n+1}$ with coordinates $(x,y,z)$ where $x=(x_{1},\\dots,x_{n})\\in\\mathbb{R}^{n}$, $y=(y_{1},\\dots,y_{n})\\in\\mathbb{R}^{n}$, and $z\\in\\mathbb{R}$. The group law is defined by\n$$\n(x,y,z)\\cdot(x',y',z') \\;=\\; \\left(x+x',\\,y+y',\\,z+z' + \\tfrac{1}{2}\\big(x\\cdot y' - y\\cdot x'\\big)\\right),\n$$\nand the standard left-invariant horizontal vector fields are\n$$\nX_{j} \\;=\\; \\frac{\\partial}{\\partial x_{j}} \\;-\\; \\frac{1}{2} y_{j} \\frac{\\partial}{\\partial z},\n\\qquad\nY_{j} \\;=\\; \\frac{\\partial}{\\partial y_{j}} \\;+\\; \\frac{1}{2} x_{j} \\frac{\\partial}{\\partial z},\n\\qquad j=1,\\dots,n,\n$$\nwith the vertical field $T=\\frac{\\partial}{\\partial z}$ and bracket relations $[X_{j},Y_{j}]=T$ and all other brackets vanishing. Equip the horizontal distribution $\\mathrm{span}\\{X_{1},\\dots,X_{n},Y_{1},\\dots,Y_{n}\\}$ with the inner product making $\\{X_{1},\\dots,X_{n},Y_{1},\\dots,Y_{n}\\}$ orthonormal.\n\nDefine the horizontal Brownian motion on $\\mathbb{H}^{n}$ as the solution of the Stratonovich Stochastic Differential Equation (SDE)\n$$\ndX_{t} \\;=\\; \\sum_{j=1}^{n} X_{j}(X_{t}) \\circ dW_{t}^{j} \\;+\\; \\sum_{j=1}^{n} Y_{j}(X_{t}) \\circ dW_{t}^{n+j},\n$$\nwhere $(W_{t}^{1},\\dots,W_{t}^{2n})$ is a standard $2n$-dimensional Brownian motion and $\\circ$ denotes Stratonovich integration. Starting from the fundamental definitions of left-invariant vector fields on a Lie group, the generator of a Stratonovich SDE, and the dilation automorphisms of $\\mathbb{H}^{n}$,\n$$\n\\delta_{r}(x,y,z) \\;=\\; (r x,\\, r y,\\, r^{2} z),\n$$\nderive the coordinate form of the SDE for $(x_{t},y_{t},z_{t})$ and explain why the infinitesimal generator of this diffusion is the sub-Laplacian $\\Delta_{\\mathbb{H}^{n}}=\\sum_{j=1}^{n}\\big(X_{j}^{2}+Y_{j}^{2}\\big)$ up to the normalization coming from Brownian scaling. Then, by analyzing how $\\Delta_{\\mathbb{H}^{n}}$ and Haar measure scale under $\\delta_{r}$, deduce the time-scaling of the heat kernel $p_{t}(g)$ in terms of the homogeneous dimension $Q$ of $\\mathbb{H}^{n}$.\n\nYour final answer must be a single closed-form analytic expression giving the scaling factor of $p_{t}$ as a function of $t$ and $Q$. No rounding is required, and no units apply.", "solution": "The user wants me to solve a problem regarding Brownian motion on the Heisenberg group $\\mathbb{H}^n$.\n\n### Step 1: Problem Validation\n\nThe problem is a well-defined exercise in stochastic differential equations on Lie groups, a standard topic in geometric analysis. All definitions, including the Heisenberg group law, its left-invariant vector fields, the sub-Laplacian, the associated Stratonovich SDE, and the dilation structure, are standard and correctly stated. The questions posed are sequential, logical, and lead to a specific, unique result. The problem is scientifically grounded, well-posed, and objective. It contains no flaws. Therefore, it is a valid problem.\n\n### Step 2: Solution\n\nThe problem asks for several steps: deriving the coordinate form of the SDE, identifying the infinitesimal generator, and using scaling arguments to find the time-scaling of the heat kernel.\n\n#### 1. Coordinate Form of the SDE\n\nThe horizontal Brownian motion is described by the Stratonovich SDE:\n$$\ndX_{t} \\;=\\; \\sum_{j=1}^{n} X_{j}(X_{t}) \\circ dW_{t}^{j} \\;+\\; \\sum_{j=1}^{n} Y_{j}(X_{t}) \\circ dW_{t}^{n+j}\n$$\nwhere $X_t = (x_t, y_t, z_t)$ is the process on $\\mathbb{H}^n \\cong \\mathbb{R}^{2n+1}$. The vector fields are given in Euclidean coordinates as:\n$$\nX_{j} \\;=\\; \\frac{\\partial}{\\partial x_{j}} \\;-\\; \\frac{1}{2} y_{j} \\frac{\\partial}{\\partial z}\n\\qquad\nY_{j} \\;=\\; \\frac{\\partial}{\\partial y_{j}} \\;+\\; \\frac{1}{2} x_{j} \\frac{\\partial}{\\partial z}\n$$\nThe SDE $dX_t$ is a statement about tangent vectors. In the coordinates $(x_1, \\dots, x_n, y_1, \\dots, y_n, z)$, the vector $X_j$ has components $(0, \\dots, 1, \\dots, 0, \\dots, -\\frac{1}{2}y_j)$, where the $1$ is in the $j$-th position. Similarly, the vector $Y_j$ has components $(0, \\dots, 0, \\dots, 1, \\dots, 0, \\frac{1}{2}x_j)$, where the $1$ is in the $(n+j)$-th position.\n\nThe SDE for each coordinate is obtained by projecting the vector equation onto the coordinate axes.\nFor the $x_k$ coordinates ($k=1, \\dots, n$):\n$$\ndx_{k,t} = \\sum_{j=1}^{n} (X_j)_{x_k} \\circ dW_t^j + \\sum_{j=1}^{n} (Y_j)_{x_k} \\circ dW_t^{n+j}\n$$\nThe $x_k$ component of $X_j$ is $\\delta_{jk}$ and the $x_k$ component of $Y_j$ is $0$.\n$$\ndx_{k,t} = \\sum_{j=1}^{n} \\delta_{jk} \\circ dW_t^j = dW_t^k\n$$\nFor the $y_k$ coordinates ($k=1, \\dots, n$):\n$$\ndy_{k,t} = \\sum_{j=1}^{n} (X_j)_{y_k} \\circ dW_t^j + \\sum_{j=1}^{n} (Y_j)_{y_k} \\circ dW_t^{n+j}\n$$\nThe $y_k$ component of $X_j$ is $0$ and the $y_k$ component of $Y_j$ is $\\delta_{jk}$.\n$$\ndy_{k,t} = \\sum_{j=1}^{n} \\delta_{jk} \\circ dW_t^{n+j} = dW_t^{n+k}\n$$\nFor the $z$ coordinate:\n$$\ndz_t = \\sum_{j=1}^{n} (X_j)_z \\circ dW_t^j + \\sum_{j=1}^{n} (Y_j)_z \\circ dW_t^{n+j}\n$$\nThe $z$ component of $X_j$ is $-\\frac{1}{2}y_j$ and the $z$ component of $Y_j$ is $\\frac{1}{2}x_j$.\n$$\ndz_t = \\sum_{j=1}^{n} \\left(-\\frac{1}{2}y_{j,t}\\right) \\circ dW_t^j + \\sum_{j=1}^{n} \\left(\\frac{1}{2}x_{j,t}\\right) \\circ dW_t^{n+j} = \\frac{1}{2} \\sum_{j=1}^{n} \\left(x_{j,t} \\circ dW_t^{n+j} - y_{j,t} \\circ dW_t^j\\right)\n$$\nSo the coordinate form of the SDE system is:\n$$\n\\begin{cases}\ndx_{j,t} = dW_t^j, & j=1, \\dots, n \\\\\ndy_{j,t} = dW_t^{n+j}, & j=1, \\dots, n \\\\\ndz_t = \\frac{1}{2} \\sum_{j=1}^{n} (x_{j,t} \\circ dW_t^{n+j} - y_{j,t} \\circ dW_t^j)\n\\end{cases}\n$$\n\n#### 2. The Infinitesimal Generator\n\nA fundamental result in stochastic calculus states that the infinitesimal generator of a process defined by a Stratonovich SDE $dX_t = \\sum_k V_k(X_t) \\circ dW_t^k$ (with no drift term) is the second-order differential operator $\\mathcal{L} = \\frac{1}{2}\\sum_k V_k^2$.\n\nTo see why, let $f$ be a smooth function on the manifold. By the chain rule for Stratonovich calculus (which is the same as the ordinary chain rule), the process $f(X_t)$ evolves as $df(X_t) = \\sum_k V_k(f)(X_t) \\circ dW_t^k$. Converting this to an Itô integral:\n$$\ndf(X_t) = \\sum_k V_k(f)(X_t)dW_t^k + \\frac{1}{2} \\sum_k d[V_k(f)(X), W^k]_t\n$$\nThe quadratic covariation term is $d[V_k(f)(X), W^k]_t = V_k(V_k(f))(X_t) dt = V_k^2(f)(X_t) dt$.\nThus,\n$$\nf(X_t) - f(X_0) = \\int_0^t \\sum_k V_k(f)(X_s) dW_s^k + \\frac{1}{2} \\int_0^t \\sum_k V_k^2(f)(X_s) ds\n$$\nTaking the expectation $\\mathbb{E}[\\cdot]$ and noting that the Itô integral term is a martingale starting at $0$, its expectation is zero. Let $u(t,x_0) = \\mathbb{E}[f(X_t^{x_0})]$.\n$$\nu(t, x_0) - u(0, x_0) = \\frac{1}{2} \\int_0^t \\mathbb{E}\\left[\\left(\\sum_k V_k^2 f\\right)(X_s^{x_0})\\right] ds\n$$\nDifferentiating with respect to $t$ at $t=0$ gives $(\\partial_t u)|_{t=0} = \\frac{1}{2}(\\sum_k V_k^2 f)(x_0)$. This shows the generator is $\\mathcal{L} = \\frac{1}{2}\\sum_k V_k^2$.\n\nIn our problem, the vector fields are $\\{X_1, \\dots, X_n, Y_1, \\dots, Y_n\\}$. The generator is therefore:\n$$\n\\mathcal{L} = \\frac{1}{2} \\left(\\sum_{j=1}^n X_j^2 + \\sum_{j=1}^n Y_j^2\\right) = \\frac{1}{2} \\Delta_{\\mathbb{H}^n}\n$$\nThis is precisely half the sub-Laplacian $\\Delta_{\\mathbb{H}^n}$. The factor of $\\frac{1}{2}$ is the standard normalization in the context of Brownian motion, relating the generator to the heat equation $\\partial_t u = \\mathcal{L} u$.\n\n#### 3. Scaling of the Sub-Laplacian and Haar Measure\n\nThe dilations on $\\mathbb{H}^n$ are given by $\\delta_r(x,y,z) = (rx, ry, r^2z)$.\nFirst, we analyze how the vector fields transform under these dilations. The pushforward of a vector field $V$ is given by $((\\delta_r)_* V)_p(f) = V(f \\circ \\delta_r)_{\\delta_r^{-1}(p)}$. Let's compute this at a point $g'=\\delta_r(g)$.\n$$\n((\\delta_r)_* X_j)_{g'}(f) = X_j(f \\circ \\delta_r)_g = \\left(\\frac{\\partial}{\\partial x_j} - \\frac{1}{2}y_j\\frac{\\partial}{\\partial z}\\right) f(rx,ry,r^2z)\n$$\nUsing the chain rule, this becomes:\n$$\n= r\\frac{\\partial f}{\\partial x'_j} - \\frac{1}{2}y_j (r^2 \\frac{\\partial f}{\\partial z'}) = r \\left(\\frac{\\partial f}{\\partial x'_j} - \\frac{1}{2}(ry_j) \\frac{\\partial f}{\\partial z'}\\right) = r \\left(\\frac{\\partial f}{\\partial x'_j} - \\frac{1}{2}y'_j \\frac{\\partial f}{\\partial z'}\\right) = r(X_j f)(g')\n$$\nThus, $(\\delta_r)_* X_j = rX_j$. A similar calculation yields $(\\delta_r)_* Y_j = rY_j$. The horizontal vector fields are homogeneous of degree $1$.\n\nNow consider the sub-Laplacian. For a function $f$, let $f_r = f \\circ \\delta_r$.\n$$\n\\Delta_{\\mathbb{H}^n}(f_r) = \\sum_j (X_j^2 (f_r) + Y_j^2 (f_r))\n$$\nWe have $X_j(f_r) = X_j(f \\circ \\delta_r) = r (X_j(f)) \\circ \\delta_r$. Applying $X_j$ again:\n$$\nX_j^2(f_r) = X_j(r (X_j f) \\circ \\delta_r) = r X_j((X_j f) \\circ \\delta_r) = r (r (X_j^2 f) \\circ \\delta_r) = r^2 (X_j^2 f) \\circ \\delta_r\n$$\nThe same applies to $Y_j^2$. Therefore,\n$$\n\\Delta_{\\mathbb{H}^n}(f \\circ \\delta_r) = r^2 (\\Delta_{\\mathbb{H}^n} f) \\circ \\delta_r\n$$\nThe sub-Laplacian is homogeneous of degree $2$.\n\nThe Haar measure on $\\mathbb{H}^n$ is the standard Lebesgue measure $dg = dx\\,dy\\,dz$ on $\\mathbb{R}^{2n+1}$. Under the dilation $\\delta_r$, the coordinates transform as $(x,y,z) \\to (x',y',z') = (rx,ry,r^2z)$. The Jacobian determinant of this transformation is $r^{2n} \\cdot r^2 = r^{2n+2}$. Thus, the measure scales as:\n$$\nd(\\delta_r g) = r^{2n+2} dg\n$$\nThe exponent is the homogeneous dimension of the group, $Q = 2n+2$.\n\n#### 4. Time-scaling of the Heat Kernel\n\nThe heat kernel $p_t(g)$ is the fundamental solution to the heat equation $\\partial_t u = \\mathcal{L}u = \\frac{1}{2}\\Delta_{\\mathbb{H}^n} u$. It must satisfy the normalization $\\int_{\\mathbb{H}^n} p_t(g) dg = 1$ for all $t>0$.\n\nThe scaling properties of the operator and the measure imply a scaling property for the heat kernel. The Brownian motion on $\\mathbb{H}^n$ has the scaling property $X_{r^2 t} \\sim \\delta_r(X_t)$. This means the probability distributions must be related. For the probability density $p_t(g)dg$, this implies invariance:\n$$\np_{r^2 t}(\\delta_r g) d(\\delta_r g) = p_t(g) dg\n$$\nSubstituting the scaling of the Haar measure, $d(\\delta_r g) = r^Q dg$:\n$$\np_{r^2 t}(\\delta_r g) r^Q dg = p_t(g) dg\n$$\nThis gives the scaling relation for the heat kernel:\n$$\np_t(g) = r^Q p_{r^2 t}(\\delta_r g)\n$$\nTo isolate the time dependence, we can choose a specific value for $r$. Let $r^2 t = 1$, which implies $r = t^{-1/2}$. Substituting this into the scaling relation:\n$$\np_t(g) = (t^{-1/2})^Q p_1(\\delta_{t^{-1/2}} g) = t^{-Q/2} p_1(\\delta_{t^{-1/2}} g)\n$$\nThis equation shows that the overall magnitude of the heat kernel at time $t$ is determined by the factor $t^{-Q/2}$, while its spatial profile is a re-scaling of the profile at time $t=1$. The time-scaling factor of the heat kernel $p_t$ is therefore $t^{-Q/2}$.", "answer": "$$\\boxed{t^{-Q/2}}$$", "id": "2970353"}, {"introduction": "An alternative and powerful approach to studying Brownian motion, especially on highly symmetric spaces like compact Lie groups, is through spectral analysis. This problem [@problem_id:2970358] leverages the rich structure of $\\mathrm{SU}(2)$ and the Peter-Weyl theorem to construct the heat kernel explicitly as an infinite series over its irreducible characters. This hands-on experience with representation theory provides a global perspective on diffusion and reveals the heat kernel as a weighted sum of the group's fundamental vibrational modes, offering a profound link between geometry, analysis, and probability.", "problem": "Consider the Special Unitary Group $\\mathrm{SU}(2)$ equipped with its bi-invariant Riemannian metric induced by the negative Killing form scaled so that the resulting metric identifies $\\mathrm{SU}(2)$ isometrically with the round $3$-sphere $S^{3}$ of radius $1$. Let $\\Delta$ denote the Laplace–Beltrami operator on $\\mathrm{SU}(2)$ with respect to this metric, and consider the heat semigroup $(P_{t})_{t \\geq 0}$ generated by $\\frac{1}{2}\\Delta$, so that for suitable initial data $f$ one has the Partial Differential Equation (PDE) $\\partial_{t} u(t,g) = \\frac{1}{2}\\Delta u(t,g)$ with $u(0,g) = f(g)$ and $u(t,\\cdot) = P_{t}f$. The heat kernel $K_{t}(g)$ is defined as the integral kernel of $P_{t}$ with respect to Haar probability measure on $\\mathrm{SU}(2)$, that is, $P_{t}f(g) = \\int_{\\mathrm{SU}(2)} K_{t}(g^{-1}h)f(h)\\,\\mathrm{d}h$.\n\nUsing only the following foundational facts:\n- The Peter–Weyl theorem on compact Lie groups, which states that the matrix coefficients of irreducible unitary representations form a complete orthonormal set in $L^{2}(\\mathrm{SU}(2))$, and that the characters are an orthonormal basis of the $L^{2}$-space of class functions.\n- The Laplace–Beltrami operator on a compact Lie group with bi-invariant metric coincides (up to a fixed scale factor determined by the chosen metric) with minus the quadratic Casimir, so it acts by a scalar on each irreducible representation.\n- With the above metric identification $\\mathrm{SU}(2) \\cong S^{3}$ of radius $1$, the Laplace–Beltrami operator has eigenvalues $-\\ell(\\ell+2)$ on the degree $\\ell$ spherical harmonics, with multiplicity $(\\ell+1)^{2}$.\n- The irreducible character of dimension $n+1$ is given by $\\chi_{n}(\\theta) = \\frac{\\sin\\!\\big((n+1)\\theta\\big)}{\\sin\\theta}$, where elements of $\\mathrm{SU}(2)$ are conjugate to diagonal matrices with eigenvalues $\\exp(i\\theta)$ and $\\exp(-i\\theta)$ for a conjugacy class angle $\\theta \\in [0,\\pi]$.\n\nDerive the character expansion of the heat kernel on $\\mathrm{SU}(2)$ and express it explicitly as a function of the conjugacy class angle $\\theta$. Then give the probabilistic interpretation: identify the law of Brownian motion at time $t$ started at the identity as a distribution on $\\mathrm{SU}(2)$ with density with respect to Haar probability measure.\n\nYour final answer must be a single closed-form analytic expression for $K_{t}(\\theta)$, the class function heat kernel at time $t$ as a function of the conjugacy class angle $\\theta$. No numerical evaluation is required.", "solution": "The user wants to find the expression for the heat kernel on the Special Unitary Group $\\mathrm{SU}(2)$.\n\n### Step 1: Problem Validation\n\nFirst, I will validate the problem statement.\n\n#### Step 1.1: Extract Givens\n- **Manifold:** The Special Unitary Group $\\mathrm{SU}(2)$.\n- **Metric:** A bi-invariant Riemannian metric that identifies $\\mathrm{SU}(2)$ isometrically with the round $3$-sphere $S^3$ of radius $1$. This metric is induced by a scaled negative Killing form.\n- **Operator:** $\\Delta$ is the Laplace–Beltrami operator corresponding to this metric.\n- **Heat Equation:** The evolution is governed by the heat semigroup $(P_t)_{t \\ge 0}$ generated by $\\frac{1}{2}\\Delta$. The associated PDE is $\\partial_t u = \\frac{1}{2}\\Delta u$.\n- **Heat Kernel:** $K_t(g)$ is the integral kernel for $P_t$ with respect to the Haar probability measure $\\mathrm{d}h$ on $\\mathrm{SU}(2)$, such that $P_t f(g) = \\int_{\\mathrm{SU}(2)} K_t(g^{-1}h) f(h) \\, \\mathrm{d}h$.\n\n#### Foundational Facts Provided:\n1.  **Peter–Weyl Theorem:** The matrix coefficients of irreducible unitary representations (irreps) form a complete orthonormal set in $L^2(\\mathrm{SU}(2))$. The characters of irreps form an orthonormal basis for the space of $L^2$ class functions.\n2.  **Laplacian and Casimir:** The Laplace-Beltrami operator $\\Delta$ on a compact Lie group with a bi-invariant metric is proportional to the negative of the quadratic Casimir operator. It acts by a scalar on each irrep.\n3.  **Eigenvalues of $\\Delta$:** With the specified metric ($\\mathrm{SU}(2) \\cong S^3(1)$), the eigenvalues of $\\Delta$ are $-\\ell(\\ell+2)$ for $\\ell=0, 1, 2, \\dots$. The multiplicity of the eigenvalue $-\\ell(\\ell+2)$ is $(\\ell+1)^2$.\n4.  **Conjugacy Classes of $\\mathrm{SU}(2)$:** An element $g \\in \\mathrm{SU}(2)$ is conjugate to a diagonal matrix with eigenvalues $\\exp(i\\theta)$ and $\\exp(-i\\theta)$ for a unique angle $\\theta \\in [0, \\pi]$.\n5.  **Character Formula:** The character of the $(n+1)$-dimensional irrep of $\\mathrm{SU}(2)$ is given by $\\chi_n(\\theta) = \\frac{\\sin((n+1)\\theta)}{\\sin\\theta}$.\n\n#### Step 1.2: Validate Givens\n- **Scientific Grounding:** The problem is firmly rooted in the standard theories of Lie groups, Riemannian geometry, and stochastic analysis. The identification $\\mathrm{SU}(2) \\cong S^3$, the properties of the Laplace-Beltrami operator, the Peter-Weyl theorem, and the character theory of $\\mathrm{SU}(2)$ are all standard and correct results.\n- **Well-Posedness:** The problem asks for the derivation of a well-defined mathematical object (the heat kernel). The provided assumptions are sufficient to determine a unique solution.\n- **Objectivity:** The problem is stated using precise mathematical language, free from any subjectivity.\n- **Consistency:** The provided facts are consistent with each other. The dimension of the $(n+1)$-dimensional irrep of $\\mathrm{SU}(2)$ is $n+1$. The space of its matrix coefficients has dimension $(n+1)^2$. This space corresponds to an eigenspace of the Laplacian. The problem states that the multiplicity of the eigenvalue indexed by $\\ell$ is $(\\ell+1)^2$. This establishes a consistent correspondence between the irrep index $n$ and the eigenvalue index $\\ell$, namely $n=\\ell$. The character formula is also standard for the irrep of spin $j = n/2$ (dimension $2j+1=n+1$).\n\nThe problem is valid.\n\n### Step 2: Derivation of the Heat Kernel\n\nThe heat kernel $K_t(g)$ is the fundamental solution of the heat equation $\\partial_t u = \\frac{1}{2} \\Delta u$, corresponding to an initial condition $u(0,g) = \\delta_e(g)$, where $\\delta_e$ is the Dirac delta distribution at the identity element $e \\in \\mathrm{SU}(2)$.\n\nSince the Laplacian $\\Delta$ is bi-invariant, the heat kernel $K_t(g)$ is a class function, meaning $K_t(hgh^{-1}) = K_t(g)$ for all $g,h \\in \\mathrm{SU}(2)$. As a class function, it depends only on the conjugacy class of $g$, which is parametrized by the angle $\\theta \\in [0, \\pi]$. We can thus write $K_t(g) = K_t(\\theta)$.\n\nThe Peter-Weyl theorem implies that the set of irreducible characters $\\{\\chi_n\\}_{n=0}^\\infty$ forms a complete orthonormal basis for the space of square-integrable class functions on $\\mathrm{SU}(2)$ with respect to the Haar probability measure.\n\nThe Dirac delta $\\delta_e(g)$ on a compact Lie group $G$ has the character expansion\n$$\n\\delta_e(g) = \\sum_{\\pi \\in \\hat{G}} (\\dim \\pi) \\chi_\\pi(g)\n$$\nwhere the sum is over all equivalence classes of irreps $\\pi \\in \\hat{G}$, $\\dim\\pi$ is the dimension of the representation $\\pi$, and $\\chi_\\pi$ is its character. For $\\mathrm{SU}(2)$, the irreps are indexed by a non-negative integer $n \\geq 0$, and the dimension of the $n$-th irrep is $n+1$. So,\n$$\n\\delta_e(g) = \\sum_{n=0}^{\\infty} (n+1) \\chi_n(g)\n$$\nThe heat kernel $K_t(g)$ is obtained by applying the heat semigroup operator $P_t = \\exp(\\frac{t}{2}\\Delta)$ to the initial condition $\\delta_e(g)$:\n$$\nK_t(g) = P_t \\delta_e(g) = \\exp\\left(\\frac{t}{2}\\Delta\\right) \\left( \\sum_{n=0}^{\\infty} (n+1) \\chi_n(g) \\right)\n$$\nSince the character $\\chi_n$ is a sum of matrix coefficients belonging to the $n$-th irrep, it is an eigenfunction of the Laplacian $\\Delta$. As established during validation, the eigenvalue of $\\Delta$ on the space of functions associated with the $n$-th irrep is $\\lambda_n = -n(n+2)$.\nThus, we can apply the operator term-by-term:\n$$\n\\Delta \\chi_n(g) = -n(n+2) \\chi_n(g)\n$$\n$$\n\\exp\\left(\\frac{t}{2}\\Delta\\right) \\chi_n(g) = \\exp\\left(\\frac{t}{2}(-n(n+2))\\right) \\chi_n(g) = \\exp\\left(-\\frac{n(n+2)t}{2}\\right) \\chi_n(g)\n$$\nSubstituting this into the expansion for $K_t(g)$:\n$$\nK_t(g) = \\sum_{n=0}^{\\infty} (n+1) \\exp\\left(-\\frac{n(n+2)t}{2}\\right) \\chi_n(g)\n$$\nThis is the character expansion of the heat kernel. To express it as a function of the conjugacy class angle $\\theta$, we use the given formula for the character: $\\chi_n(\\theta) = \\frac{\\sin((n+1)\\theta)}{\\sin\\theta}$.\nSubstituting this into the expression for $K_t(g)$ gives the heat kernel as a function of $\\theta$:\n$$\nK_t(\\theta) = \\sum_{n=0}^{\\infty} (n+1) \\exp\\left(-\\frac{n(n+2)t}{2}\\right) \\frac{\\sin\\big((n+1)\\theta\\big)}{\\sin\\theta}\n$$\nThis infinite series is the explicit analytic expression for the heat kernel.\n\n### Step 3: Probabilistic Interpretation\n\nThe heat kernel $K_t(g)$ provides the probability density of the position of a Brownian motion on the manifold at time $t$. Let $(B_t)_{t \\ge 0}$ be a Brownian motion on $\\mathrm{SU}(2)$ starting at the identity element $e$. The law of the random variable $B_t$ is a probability measure $\\mu_t$ on $\\mathrm{SU}(2)$. The heat kernel $K_t(g)$ is the probability density function of this measure with respect to the Haar probability measure $\\mathrm{d}g$. That is, the probability of finding the process in a measurable set $A \\subset \\mathrm{SU}(2)$ at time $t$ is given by\n$$\n\\mathbb{P}(B_t \\in A) = \\int_A K_t(g) \\, \\mathrm{d}g\n$$\nSince $K_t(g)$ is a class function, $K_t(g) = K_t(\\theta)$, the probability distribution of $B_t$ is central (invariant under conjugation). The expression $K_t(\\theta)$ is the density of this law expressed as a function of the class angle $\\theta$.", "answer": "$$\n\\boxed{\\sum_{n=0}^{\\infty} (n+1) \\exp\\left(-\\frac{n(n+2)t}{2}\\right) \\frac{\\sin\\big((n+1)\\theta\\big)}{\\sin\\theta}}\n$$", "id": "2970358"}]}