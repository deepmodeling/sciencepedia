{"hands_on_practices": [{"introduction": "To truly master Wiener chaos expansions, we begin with a foundational exercise. This practice challenges you to derive the chaos decomposition for a common Brownian functional, $\\int_{0}^{1} W(t)^{2} \\, dt$, starting directly from first principles. By manually constructing the expansion and using the Itō isometry, you will calculate its variance, gaining a deep, practical understanding of the core mechanics of white noise analysis [@problem_id:3006136].", "problem": "Let $\\{W(t)\\}_{t \\in [0,1]}$ be a standard one-dimensional Brownian motion on a complete probability space $(\\Omega,\\mathcal{F},\\mathbb{P})$ with its canonical filtration. In white noise analysis, Brownian motion admits a representation via multiple Wiener-Itō integrals, and every square-integrable functional of $W$ decomposes uniquely into orthogonal components known as Wiener chaos. Consider the square-integrable Brownian functional\n$$\nF \\equiv \\int_{0}^{1} W(t)^{2} \\, dt.\n$$\nStarting from the fundamental definitions of the Itō integral and the Wiener chaos decomposition (without invoking any pre-packaged shortcut formulas), use first principles to determine the exact value of the variance of $F$ by identifying its second-chaos component and employing the orthogonality and isometry properties of multiple Wiener-Itō integrals. Express your final answer in exact form (no rounding).", "solution": "The problem is valid as it is scientifically grounded, well-posed, and objective. It presents a standard problem in stochastic analysis that can be solved using the specified method of Wiener chaos decomposition from first principles.\n\nLet $\\{W(t)\\}_{t \\in [0,1]}$ be a standard one-dimensional Brownian motion. We are asked to compute the variance of the random variable $F = \\int_{0}^{1} W(t)^{2} \\, dt$. The variance is defined as $\\text{Var}(F) = \\mathbb{E}[F^2] - (\\mathbb{E}[F])^2$. We will employ the Wiener chaos expansion of $F$ to determine this value.\n\nAny square-integrable functional $F$ of the Brownian motion admits a unique orthogonal decomposition, known as the Wiener chaos expansion:\n$$\nF = \\sum_{n=0}^{\\infty} I_n(f_n)\n$$\nwhere $I_n(f_n)$ is the $n$-th multiple Wiener-Itō integral of a symmetric, deterministic kernel $f_n \\in L^2([0,1]^n)$, the space of square-integrable functions on $[0,1]^n$. The term $I_n(f_n)$ is called the $n$-th chaos component of $F$.\n\nThe key properties of this expansion are:\n1.  The zeroth chaos component is the expectation of $F$: $I_0(f_0) = \\mathbb{E}[F]$.\n2.  The chaos components are orthogonal in $L^2(\\Omega)$, i.e., $\\mathbb{E}[I_n(f_n) I_m(g_m)] = 0$ for $n \\neq m$.\n3.  The Itō isometry relates the norm in $L^2(\\Omega)$ to the norm in $L^2([0,1]^n)$:\n    $$\n    \\mathbb{E}[I_n(f_n)^2] = n! \\|f_n\\|_{L^2([0,1]^n)}^2 = n! \\int_{[0,1]^n} f_n(t_1, \\dots, t_n)^2 \\, dt_1 \\dots dt_n.\n    $$\n\nFrom these properties, the variance of $F$ can be expressed as:\n$$\n\\text{Var}(F) = \\mathbb{E}[(F - \\mathbb{E}[F])^2] = \\mathbb{E}\\left[\\left(\\sum_{n=1}^{\\infty} I_n(f_n)\\right)^2\\right] = \\sum_{n=1}^{\\infty} \\mathbb{E}[I_n(f_n)^2] = \\sum_{n=1}^{\\infty} n! \\|f_n\\|_{L^2([0,1]^n)}^2.\n$$\n\nOur strategy is to find the kernels $f_n$ for the specific functional $F = \\int_{0}^{1} W(t)^{2} \\, dt$.\n\nFirst, we represent the Brownian motion $W(t)$ itself as a first-order Wiener-Itō integral. For a fixed $t \\in [0,1]$, $W(t)$ is given by:\n$$\nW(t) = \\int_{0}^{t} 1 \\, dW(s) = \\int_{0}^{1} \\mathbf{1}_{[0,t]}(s) \\, dW(s)\n$$\nwhere $\\mathbf{1}_{[0,t]}(s)$ is the indicator function, which is $1$ if $s \\in [0,t]$ and $0$ otherwise. This shows that for each $t$, $W(t)$ is in the first Wiener chaos, $W(t) = I_1(g_t)$, with kernel $g_t(s) = \\mathbf{1}_{[0,t]}(s)$.\n\nNext, we find the chaos expansion for $W(t)^2$. The product of two first-order Wiener integrals $I_1(g)$ and $I_1(h)$ is given by the product formula: $I_1(g)I_1(h) = I_2(g \\otimes h) + \\langle g, h \\rangle_{L^2([0,1])}$. For $g=h=g_t$, we have:\n$$\nW(t)^2 = I_1(g_t)^2 = I_2(g_t \\otimes g_t) + \\langle g_t, g_t \\rangle_{L^2([0,1])}\n$$\nThe inner product term is:\n$$\n\\langle g_t, g_t \\rangle_{L^2([0,1])} = \\int_{0}^{1} (\\mathbf{1}_{[0,t]}(s))^2 \\, ds = \\int_{0}^{t} 1 \\, ds = t.\n$$\nThe kernel for the second-order integral is $(g_t \\otimes g_t)(s_1, s_2) = g_t(s_1)g_t(s_2) = \\mathbf{1}_{[0,t]}(s_1)\\mathbf{1}_{[0,t]}(s_2)$. This kernel is already symmetric in $s_1$ and $s_2$. Thus, we have the chaos decomposition for $W(t)^2$:\n$$\nW(t)^2 = t + I_2(\\mathbf{1}_{[0,t]} \\otimes \\mathbf{1}_{[0,t]}).\n$$\nThe term $t$ is the zeroth chaos component (the expectation $\\mathbb{E}[W(t)^2]=t$), and $I_2(\\mathbf{1}_{[0,t]} \\otimes \\mathbf{1}_{[0,t]})$ is the second chaos component.\n\nNow, we can find the decomposition for $F$ by integrating the expression for $W(t)^2$ with respect to $t$ from $0$ to $1$:\n$$\nF = \\int_{0}^{1} W(t)^2 \\, dt = \\int_{0}^{1} \\left( t + I_2(\\mathbf{1}_{[0,t]} \\otimes \\mathbf{1}_{[0,t]}) \\right) \\, dt = \\int_{0}^{1} t \\, dt + \\int_{0}^{1} I_2(\\mathbf{1}_{[0,t]} \\otimes \\mathbf{1}_{[0,t]}) \\, dt.\n$$\nThe first term is a deterministic constant:\n$$\n\\int_{0}^{1} t \\, dt = \\left[\\frac{t^2}{2}\\right]_{0}^{1} = \\frac{1}{2}.\n$$\nThis is the zeroth chaos component of $F$, so $I_0(f_0) = \\frac{1}{2}$, which means $\\mathbb{E}[F] = \\frac{1}{2}$.\n\nFor the second term, we can interchange the time integral and the stochastic integral (by the stochastic Fubini theorem):\n$$\n\\int_{0}^{1} I_2(\\mathbf{1}_{[0,t]} \\otimes \\mathbf{1}_{[0,t]}) \\, dt = I_2\\left(\\int_{0}^{1} (\\mathbf{1}_{[0,t]} \\otimes \\mathbf{1}_{[0,t]}) \\, dt\\right).\n$$\nThis gives us the second chaos component of $F$, which we denote as $F_2 = I_2(f_2)$. The kernel $f_2$ is:\n$$\nf_2(s_1, s_2) = \\int_{0}^{1} (\\mathbf{1}_{[0,t]} \\otimes \\mathbf{1}_{[0,t]})(s_1, s_2) \\, dt = \\int_{0}^{1} \\mathbf{1}_{[0,t]}(s_1) \\mathbf{1}_{[0,t]}(s_2) \\, dt.\n$$\nThe product of indicators $\\mathbf{1}_{[0,t]}(s_1) \\mathbf{1}_{[0,t]}(s_2)$ is $1$ if and only if $s_1 \\le t$ and $s_2 \\le t$, which is equivalent to $\\max(s_1, s_2) \\le t$. Therefore, the kernel is:\n$$\nf_2(s_1, s_2) = \\int_{0}^{1} \\mathbf{1}_{[\\max(s_1, s_2), 1]}(t) \\, dt = \\int_{\\max(s_1, s_2)}^{1} 1 \\, dt = 1 - \\max(s_1, s_2).\n$$\nThis kernel is well-defined for $(s_1, s_2) \\in [0,1]^2$ and is symmetric.\n\nThe complete chaos expansion of $F$ is thus:\n$$\nF = \\frac{1}{2} + I_2(1 - \\max(s_1, s_2)).\n$$\nThis shows that $F$ has components only in the zeroth and second chaos. The first-chaos component, and all higher components ($n \\geq 3$), are zero. The second-chaos component of $F$ is $F_2 = I_2(1 - \\max(s_1, s_2))$.\n\nThe variance of $F$ is the sum of the variances of its chaos components for $n \\ge 1$. Since only the second component is non-zero, the variance is simply the variance of this component:\n$$\n\\text{Var}(F) = \\text{Var}(F_2) = \\mathbb{E}[(I_2(f_2))^2].\n$$\nUsing the Itō isometry, we have:\n$$\n\\text{Var}(F) = 2! \\|f_2\\|_{L^2([0,1]^2)}^2 = 2 \\int_{0}^{1}\\int_{0}^{1} (f_2(s_1, s_2))^2 \\, ds_1 ds_2.\n$$\nWe must now compute this integral:\n$$\n\\|f_2\\|^2 = \\int_{0}^{1}\\int_{0}^{1} (1 - \\max(s_1, s_2))^2 \\, ds_1 ds_2.\n$$\nDue to the symmetry of the integrand, we can split the domain $[0,1]^2$ into two triangles where $s_1 \\le s_2$ and $s_2 \\le s_1$ and compute the integral over one of them, then multiply by $2$.\n$$\n\\|f_2\\|^2 = 2 \\int_{0}^{1} \\left( \\int_{0}^{s_2} (1 - \\max(s_1, s_2))^2 \\, ds_1 \\right) ds_2.\n$$\nIn the region of integration $0 \\le s_1 \\le s_2 \\le 1$, we have $\\max(s_1, s_2) = s_2$. The integral becomes:\n$$\n\\|f_2\\|^2 = 2 \\int_{0}^{1} \\left( \\int_{0}^{s_2} (1 - s_2)^2 \\, ds_1 \\right) ds_2.\n$$\nThe inner integral is:\n$$\n\\int_{0}^{s_2} (1 - s_2)^2 \\, ds_1 = (1 - s_2)^2 \\int_{0}^{s_2} 1 \\, ds_1 = s_2(1 - s_2)^2.\n$$\nSubstituting this into the outer integral:\n$$\n\\|f_2\\|^2 = 2 \\int_{0}^{1} s_2(1 - s_2)^2 \\, ds_2 = 2 \\int_{0}^{1} s_2(1 - 2s_2 + s_2^2) \\, ds_2 = 2 \\int_{0}^{1} (s_2 - 2s_2^2 + s_2^3) \\, ds_2.\n$$\nEvaluating the integral:\n$$\n\\|f_2\\|^2 = 2 \\left[ \\frac{s_2^2}{2} - \\frac{2s_2^3}{3} + \\frac{s_2^4}{4} \\right]_{0}^{1} = 2 \\left( \\frac{1}{2} - \\frac{2}{3} + \\frac{1}{4} \\right) = 2 \\left( \\frac{6 - 8 + 3}{12} \\right) = 2 \\left( \\frac{1}{12} \\right) = \\frac{1}{6}.\n$$\nFinally, we compute the variance of $F$:\n$$\n\\text{Var}(F) = 2! \\|f_2\\|^2 = 2 \\times \\frac{1}{6} = \\frac{1}{3}.\n$$\nThe variance of the functional $F = \\int_{0}^{1} W(t)^{2} \\, dt$ is $\\frac{1}{3}$.", "answer": "$$\\boxed{\\frac{1}{3}}$$", "id": "3006136"}, {"introduction": "Building on foundational skills, we now move to more powerful machinery for manipulating chaos expansions. This problem introduces the product formula for multiple Wiener–Itô integrals, a key combinatorial tool that simplifies the analysis of nonlinear functionals. You will apply this formula to determine the chaos expansion of the product of two random variables, focusing on calculating the expectation via kernel contractions [@problem_id:3006137].", "problem": "Consider a standard Brownian motion $\\{B_{t}\\}_{t \\geq 0}$ on a complete probability space and the associated isonormal Gaussian process $W$ over $L^{2}(\\mathbb{R}_{+})$ given by $W(h) = \\int_{0}^{\\infty} h(t) \\,\\mathrm{d}B_{t}$ for $h \\in L^{2}(\\mathbb{R}_{+})$. For a symmetric kernel $f \\in L^{2}(\\mathbb{R}_{+}^{n})$, define the multiple Wiener–Itô integral $I_{n}(f)$ as the $n$-th homogeneous chaos element satisfying the isometry $\\mathbb{E}[I_{n}(f) I_{m}(g)] = \\delta_{n,m} \\, n! \\, \\langle f, g \\rangle_{L^{2}(\\mathbb{R}_{+}^{n})}$ with $g \\in L^{2}(\\mathbb{R}_{+}^{m})$. In white noise analysis (WNA), the product of multiple integrals admits a Wiener chaos expansion (WCE) formulated using kernel contractions. Let the contraction of order $r$ between $f \\in L^{2}(\\mathbb{R}_{+}^{p})$ and $g \\in L^{2}(\\mathbb{R}_{+}^{q})$ be the map $f \\otimes_{r} g \\in L^{2}(\\mathbb{R}_{+}^{p+q-2r})$ obtained by integrating $r$ coordinates against each other, and let $\\widetilde{\\otimes}$ denote symmetrization.\n\nFix parameters $\\alpha > 0$ and $\\beta > 0$ and define $h(t) = \\exp(-\\alpha t)$ and $k(t) = \\exp(-\\beta t)$ for $t \\geq 0$. Consider the second-order chaos random variables $X = I_{2}(h^{\\otimes 2})$ and $Y = I_{2}(k^{\\otimes 2})$. Starting from the core definitions above and the combinatorial structure of contractions, derive the Wiener chaos expansion of the product $XY$ (expressed as a sum of multiple Wiener–Itô integrals of orders $4$, $2$, and $0$ whose kernels are constructed from $h$ and $k$ via contractions). Then determine the deterministic coefficient (the order-zero chaos term) explicitly as a function of $\\alpha$ and $\\beta$.\n\nYour final answer must be a single closed-form analytic expression in $\\alpha$ and $\\beta$ for the constant term of the Wiener chaos expansion of $XY$. No rounding is required.", "solution": "The problem asks for the deterministic coefficient, which is the order-zero term, in the Wiener chaos expansion of the product of two second-order chaos random variables, $X = I_{2}(h^{\\otimes 2})$ and $Y = I_{2}(k^{\\otimes 2})$.\n\nThe cornerstone for solving this problem is the product formula for multiple Wiener–Itô integrals. Let $f \\in L^2(\\mathbb{R}_{+}^p)$ and $g \\in L^2(\\mathbb{R}_{+}^q)$ be symmetric kernels. The product of the corresponding multiple integrals $I_p(f)$ and $I_q(g)$ can be expressed as a sum of multiple integrals of lower orders:\n$$ I_p(f) I_q(g) = \\sum_{r=0}^{\\min(p,q)} r! \\binom{p}{r} \\binom{q}{r} I_{p+q-2r}(f \\widetilde{\\otimes}_r g) $$\nwhere $f \\widetilde{\\otimes}_r g$ denotes the symmetrization of the $r$-th order contraction of the kernels $f$ and $g$. The contraction $f \\otimes_r g$ is a function in $L^2(\\mathbb{R}_{+}^{p+q-2r})$ obtained by integrating over $r$ shared variables.\n\nIn our specific problem, we have the random variables $X = I_{2}(f)$ and $Y = I_{2}(g)$, where the kernels are of order $p=2$ and $q=2$, respectively. The kernels are given by the tensor products of functions $h(t) = \\exp(-\\alpha t)$ and $k(t) = \\exp(-\\beta t)$:\n$$ f(t_1, t_2) = h(t_1)h(t_2) = \\exp(-\\alpha t_1 - \\alpha t_2) $$\n$$ g(s_1, s_2) = k(s_1)k(s_2) = \\exp(-\\beta s_1 - \\beta s_2) $$\nThese kernels are elements of $L^2(\\mathbb{R}_{+}^2)$ since $\\alpha > 0$ and $\\beta > 0$, ensuring that $h, k \\in L^2(\\mathbb{R}_{+})$. They are also symmetric by construction.\n\nApplying the product formula with $p=2$ and $q=2$, we have $\\min(p,q)=2$. The expansion for $XY$ is:\n$$ XY = \\sum_{r=0}^{2} r! \\binom{2}{r} \\binom{2}{r} I_{4-2r}(f \\widetilde{\\otimes}_r g) $$\nLet us expand the sum term by term:\nFor $r=0$: $0! \\binom{2}{0} \\binom{2}{0} I_4(f \\widetilde{\\otimes}_0 g) = I_4(f \\widetilde{\\otimes} g)$. This is the fourth-order chaos component.\nFor $r=1$: $1! \\binom{2}{1} \\binom{2}{1} I_2(f \\widetilde{\\otimes}_1 g) = 4 I_2(f \\widetilde{\\otimes}_1 g)$. This is the second-order chaos component.\nFor $r=2$: $2! \\binom{2}{2} \\binom{2}{2} I_0(f \\widetilde{\\otimes}_2 g) = 2 I_0(f \\otimes_2 g)$. This is the zeroth-order chaos component. Since the result of the contraction $f \\otimes_2 g$ is a scalar, its symmetrization is itself.\n\nThe problem requires us to find the deterministic coefficient, which is precisely the zeroth-order chaos term. A random variable in the $0$-th chaos, $I_0(c)$, is simply the constant $c \\in \\mathbb{R}$ itself. This term also corresponds to the expectation of the random variable, $\\mathbb{E}[XY]$.\n\nThe required coefficient is therefore $2 (f \\otimes_2 g)$. We must calculate the second-order contraction $f \\otimes_2 g$. For two kernels $f, g \\in L^2(\\mathbb{R}_{+}^2)$, this contraction is defined as their inner product in $L^2(\\mathbb{R}_{+}^2)$:\n$$ f \\otimes_2 g = \\langle f, g \\rangle_{L^2(\\mathbb{R}_{+}^2)} = \\int_{\\mathbb{R}_{+}^2} f(t_1, t_2) g(t_1, t_2) \\,\\mathrm{d}t_1 \\,\\mathrm{d}t_2 $$\nSubstituting the explicit forms of $f$ and $g$:\n$$ f \\otimes_2 g = \\int_{0}^{\\infty} \\int_{0}^{\\infty} \\left( \\exp(-\\alpha t_1 - \\alpha t_2) \\right) \\left( \\exp(-\\beta t_1 - \\beta t_2) \\right) \\,\\mathrm{d}t_1 \\,\\mathrm{d}t_2 $$\nWe can combine the exponents:\n$$ f \\otimes_2 g = \\int_{0}^{\\infty} \\int_{0}^{\\infty} \\exp(-(\\alpha+\\beta)t_1 - (\\alpha+\\beta)t_2) \\,\\mathrm{d}t_1 \\,\\mathrm{d}t_2 $$\nThe integral is separable into a product of two identical integrals:\n$$ f \\otimes_2 g = \\left( \\int_{0}^{\\infty} \\exp(-(\\alpha+\\beta)t) \\,\\mathrm{d}t \\right) \\left( \\int_{0}^{\\infty} \\exp(-(\\alpha+\\beta)t) \\,\\mathrm{d}t \\right) $$\nLet's evaluate the single integral. Since the parameters $\\alpha$ and $\\beta$ are strictly positive, their sum $\\alpha+\\beta$ is also strictly positive, which ensures the convergence of the improper integral:\n$$ \\int_{0}^{\\infty} \\exp(-(\\alpha+\\beta)t) \\,\\mathrm{d}t = \\left[ -\\frac{1}{\\alpha+\\beta} \\exp(-(\\alpha+\\beta)t) \\right]_{t=0}^{t \\to \\infty} $$\n$$ = \\lim_{T \\to \\infty} \\left( -\\frac{1}{\\alpha+\\beta} \\exp(-(\\alpha+\\beta)T) \\right) - \\left( -\\frac{1}{\\alpha+\\beta} \\exp(0) \\right) $$\n$$ = 0 - \\left( -\\frac{1}{\\alpha+\\beta} \\right) = \\frac{1}{\\alpha+\\beta} $$\nSubstituting this result back into the expression for the contraction:\n$$ f \\otimes_2 g = \\left( \\frac{1}{\\alpha+\\beta} \\right) \\left( \\frac{1}{\\alpha+\\beta} \\right) = \\frac{1}{(\\alpha+\\beta)^2} $$\nFinally, the order-zero chaos term is $2 (f \\otimes_2 g)$.\n$$ \\text{Order-zero term} = 2 \\times \\frac{1}{(\\alpha+\\beta)^2} = \\frac{2}{(\\alpha+\\beta)^2} $$\nThis result can be verified by directly computing the expectation $\\mathbb{E}[XY]$ using the Wiener–Itô isometry:\n$$ \\mathbb{E}[XY] = \\mathbb{E}[I_2(f) I_2(g)] = 2! \\langle f, g \\rangle_{L^2(\\mathbb{R}_{+}^2)} = 2 \\langle f, g \\rangle_{L^2(\\mathbb{R}_{+}^2)} $$\nThis confirms our calculation, as $\\mathbb{E}[XY]$ is the zeroth-order term in the Wiener chaos expansion of $XY$. The calculated value is $\\frac{2}{(\\alpha+\\beta)^2}$.", "answer": "$$\\boxed{\\frac{2}{(\\alpha+\\beta)^2}}$$", "id": "3006137"}, {"introduction": "The theoretical elegance of Wiener chaos expansions finds its power in practical applications, particularly in approximation and computation. This exercise bridges theory and practice by asking you to analyze the truncation error of the chaos expansion for the Wick exponential, a cornerstone of stochastic analysis. By implementing a numerical scheme to quantify the accuracy of finite-term approximations, you will develop essential skills for applying these concepts to real-world modeling and simulation problems [@problem_id:3006134].", "problem": "Consider a real-valued standard Brownian motion $W = \\{W_t\\}_{t \\ge 0}$ on a filtered probability space, with white noise analysis interpreting its formal derivative as Gaussian white noise. For a fixed time $t > 0$ and parameter $\\lambda \\in \\mathbb{R}$, define the random variable $X_t$ by $X_t = \\exp\\left(\\lambda W_t - \\tfrac{1}{2}\\lambda^2 t\\right)$. This random variable is the Wick exponential of $\\lambda W_t$ and admits a Wiener chaos expansion in terms of probabilists' Hermite polynomials. The Wiener chaos expansion is based on the orthogonal decomposition of $L^2(\\Omega)$ into homogeneous chaoses, where the $n$-th chaos is spanned by $n$-fold multiple Wiener integrals, and equivalently by $H_n(Z)$ with $Z$ standard normal and $H_n$ the probabilists' Hermite polynomials. The probabilists' Hermite polynomials satisfy orthogonality under the standard normal law and characterize the Wiener chaos expansions. Using these foundational definitions from white noise analysis and Wiener chaos expansions, derive the truncation properties of the order-$N$ partial sum approximation to $X_t$ and compute the induced errors.\n\nYour program must implement the following computation for each given test case $(t,\\lambda,N)$:\n\n1. Compute the second moment of the order-$N$ truncated Wiener chaos approximation to $X_t$, denoted $S_N(t,\\lambda)$. This quantity is the sum of squared chaos coefficients multiplied by the corresponding chaos norms induced by orthogonality, and is to be determined from first principles using the Wiener chaos basis and the probabilists' Hermite polynomial properties.\n\n2. Compute the mean-square truncation error (the $L^2(\\Omega)$ error squared) $R_N(t,\\lambda)$ of the order-$N$ partial sum approximation to $X_t$. This is the sum of the squared omitted chaos coefficients times chaos norms and should be derived from orthogonality.\n\n3. Compute the exact second moment $\\mathbb{E}[X_t^2]$ using the Gaussian moment generating function and the definition of $X_t$.\n\nYour program must produce these three quantities in the order $[S_N(t,\\lambda), R_N(t,\\lambda), \\mathbb{E}[X_t^2]]$ for each test case. No physical units enter the computation.\n\nTest Suite:\n- Case A: $(t,\\lambda,N) = (1.0, 0.5, 5)$\n- Case B: $(t,\\lambda,N) = (0.0, 1.234, 3)$\n- Case C: $(t,\\lambda,N) = (2.0, 0.0, 10)$\n- Case D: $(t,\\lambda,N) = (1.5, 1.2, 0)$\n- Case E: $(t,\\lambda,N) = (3.0, 0.8, 20)$\n\nDesign for coverage:\n- Case B tests the boundary $t = 0$, where $X_t$ becomes deterministic and truncation is exact.\n- Case C tests the boundary $\\lambda = 0$, where $X_t$ becomes deterministic and truncation is exact.\n- Case D tests the edge $N = 0$, capturing only the zeroth chaos.\n- Cases A and E test general nontrivial regimes with moderate and larger truncation orders.\n\nFinal Output Format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each test case contributes a sub-list of three floats in the order $[S_N, R_N, \\mathbb{E}[X_t^2]]$. For example, the output should be of the form $[[S_N^{(A)}, R_N^{(A)}, E^{(A)}],[S_N^{(B)}, R_N^{(B)}, E^{(B)}],\\dots]$ with no additional text.", "solution": "We start from the foundational definitions of Brownian motion, white noise analysis, and Wiener chaos expansions. Let $W = \\{W_t\\}_{t \\ge 0}$ be a standard Brownian motion and consider $X_t = \\exp\\left(\\lambda W_t - \\tfrac{1}{2}\\lambda^2 t\\right)$ for fixed $t > 0$ and $\\lambda \\in \\mathbb{R}$. Define $Z = W_t / \\sqrt{t}$, which is standard normal. The probabilists' Hermite polynomials $H_n$ provide an orthogonal basis for $L^2$ functionals of $Z$ and generate the Wiener chaos decomposition. Two key well-tested facts underlie the derivation:\n\n1. The probabilists' Hermite polynomials satisfy the orthogonality relation $\\mathbb{E}[H_n(Z)H_m(Z)] = n! \\,\\delta_{nm}$, where $\\delta_{nm}$ is the Kronecker delta.\n\n2. The Gaussian generating function identity holds: for $\\theta \\in \\mathbb{R}$ and standard normal $Z$, $\\exp\\left(\\theta Z - \\tfrac{1}{2}\\theta^2\\right) = \\sum_{n=0}^{\\infty} \\frac{\\theta^n}{n!} H_n(Z)$. This identity follows from the moment generating function of the Gaussian distribution and the definition of $H_n$ via Rodrigues' formula. It is a standard, well-tested formula used to obtain Hermite expansions of normalized Gaussian exponentials.\n\nApplying this with $\\theta = \\lambda \\sqrt{t}$ and $Z = W_t/\\sqrt{t}$, we obtain the Wiener chaos expansion\n$$\nX_t = \\sum_{n=0}^{\\infty} a_n(t,\\lambda) \\, H_n(Z), \\quad a_n(t,\\lambda) = \\frac{(\\lambda \\sqrt{t})^n}{n!}.\n$$\nThis follows directly by substituting $\\theta = \\lambda \\sqrt{t}$ into the generating function.\n\nLet the order-$N$ truncated Wiener chaos approximation be\n$$\nX_t^{(N)} = \\sum_{n=0}^{N} a_n(t,\\lambda) \\, H_n(Z).\n$$\nUsing orthogonality, the $L^2(\\Omega)$ norm squared of $X_t^{(N)}$ equals\n$$\n\\mathbb{E}\\left[(X_t^{(N)})^2\\right] = \\sum_{n=0}^{N} a_n(t,\\lambda)^2 \\, \\mathbb{E}[H_n(Z)^2] = \\sum_{n=0}^{N} \\left(\\frac{(\\lambda \\sqrt{t})^n}{n!}\\right)^2 n! = \\sum_{n=0}^{N} \\frac{(\\lambda^2 t)^n}{n!}.\n$$\nDefine $S_N(t,\\lambda) := \\mathbb{E}\\left[(X_t^{(N)})^2\\right]$; then\n$$\nS_N(t,\\lambda) = \\sum_{n=0}^{N} \\frac{(\\lambda^2 t)^n}{n!}.\n$$\n\nThe mean-square truncation error (the $L^2(\\Omega)$ error squared) between $X_t$ and $X_t^{(N)}$ is given by the squared norm of the tail:\n$$\nR_N(t,\\lambda) := \\mathbb{E}\\left[\\left(X_t - X_t^{(N)}\\right)^2\\right] = \\sum_{n=N+1}^{\\infty} a_n(t,\\lambda)^2 \\, \\mathbb{E}[H_n(Z)^2] = \\sum_{n=N+1}^{\\infty} \\frac{(\\lambda^2 t)^n}{n!}.\n$$\nThis uses orthogonality to eliminate cross terms and the fact that the chaos components are orthogonal in $L^2(\\Omega)$.\n\nTo determine the exact second moment of $X_t$, note that for any $p \\in \\mathbb{R}$,\n$$\nX_t^p = \\exp\\left(p \\lambda W_t - \\tfrac{1}{2} p \\lambda^2 t\\right).\n$$\nUsing the Gaussian moment generating function $\\mathbb{E}[\\exp(\\theta W_t)] = \\exp\\left(\\tfrac{1}{2}\\theta^2 t\\right)$ with $\\theta = p \\lambda$, we obtain\n$$\n\\mathbb{E}[X_t^p] = \\exp\\left(\\tfrac{1}{2} (p \\lambda)^2 t - \\tfrac{1}{2} p \\lambda^2 t\\right) = \\exp\\left(\\tfrac{1}{2}\\lambda^2 t (p^2 - p)\\right).\n$$\nSetting $p = 2$ yields\n$$\n\\mathbb{E}[X_t^2] = \\exp\\left(\\lambda^2 t\\right).\n$$\nCombining the expressions for $S_N(t,\\lambda)$ and $R_N(t,\\lambda)$ with $\\mathbb{E}[X_t^2]$, note that $\\mathbb{E}[X_t^2] = S_N(t,\\lambda) + R_N(t,\\lambda)$, so\n$$\nR_N(t,\\lambda) = \\exp\\left(\\lambda^2 t\\right) - \\sum_{n=0}^{N} \\frac{(\\lambda^2 t)^n}{n!}.\n$$\n\nAlgorithmic design:\n- For each test case compute $\\beta := \\lambda^2 t$.\n- Evaluate $S_N(t,\\lambda)$ via an iterative summation of the series $\\sum_{n=0}^N \\beta^n / n!$ using the recurrence for terms $T_0 = 1$ and $T_{n} = T_{n-1} \\cdot \\beta / n$ to ensure numerical stability and efficiency.\n- Compute the exact second moment $E_{\\text{exact}} = \\exp(\\beta)$.\n- Compute the truncation error $R_N(t,\\lambda) = E_{\\text{exact}} - S_N(t,\\lambda)$.\n- Aggregate the three values $[S_N, R_N, E_{\\text{exact}}]$ for each test case.\n\nEdge cases and correctness:\n- If $t = 0$, then $\\beta = 0$ and $X_t = 1$ almost surely. Consequently, $S_N = 1$, $E_{\\text{exact}} = 1$, and $R_N = 0$.\n- If $\\lambda = 0$, then $\\beta = 0$ and $X_t = 1$ almost surely. The same values as above hold.\n- If $N = 0$, then $S_0 = 1$, $R_0 = \\exp(\\beta) - 1$, matching the contribution of the zeroth chaos only.\n- For general $t > 0$ and $\\lambda \\ne 0$, $S_N$ is the $N$-th partial sum of the exponential series evaluated at $\\beta$, and $R_N$ is the corresponding tail; numerical evaluation via the stable recurrence ensures accurate computation for the provided cases.\n\nThe final program computes these quantities for the specified test suite and prints a single line containing a list of the per-case results in the exact format requested.", "answer": "```python\nimport numpy as np\n\ndef partial_sum_exp_series(beta: float, N: int) -> float:\n    \"\"\"\n    Compute S_N = sum_{n=0}^N beta^n / n! using a stable recurrence.\n    \"\"\"\n    term = 1.0  # beta^0 / 0! = 1\n    s = term\n    for n in range(1, N + 1):\n        term *= beta / n\n        s += term\n    return s\n\ndef compute_case(t: float, lam: float, N: int):\n    \"\"\"\n    For given (t, lam, N), compute:\n    - S_N: second moment of the truncated chaos approximation\n    - R_N: mean-square truncation error\n    - E_exact: exact second moment E[X_t^2]\n    \"\"\"\n    beta = (lam ** 2) * t\n    S_N = partial_sum_exp_series(beta, N)\n    E_exact = float(np.exp(beta))\n    R_N = E_exact - S_N\n    return [S_N, R_N, E_exact]\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (1.0, 0.5, 5),   # Case A\n        (0.0, 1.234, 3), # Case B: t=0 boundary\n        (2.0, 0.0, 10),  # Case C: lambda=0 boundary\n        (1.5, 1.2, 0),   # Case D: N=0 edge\n        (3.0, 0.8, 20),  # Case E\n    ]\n\n    results = []\n    for case in test_cases:\n        t, lam, N = case\n        result = compute_case(t, lam, N)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    # Single line output: list of per-case lists.\n    print(f\"[{','.join(str(r) for r in results)}]\")\n\nsolve()\n```", "id": "3006134"}]}