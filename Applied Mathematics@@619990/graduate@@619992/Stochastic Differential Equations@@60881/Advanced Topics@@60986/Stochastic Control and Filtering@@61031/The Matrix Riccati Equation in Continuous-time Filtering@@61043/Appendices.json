{"hands_on_practices": [{"introduction": "Understanding the solution structure of the Matrix Riccati Differential Equation (MRDE) is key to grasping how estimation error evolves. This exercise bridges the gap between the differential and integral formulations of the problem [@problem_id:1134791]. By transforming the MRDE into a nonlinear Volterra integral equation, you will gain a deeper appreciation for how the error covariance at a given time $t$ explicitly depends on both the initial condition and the entire integrated history of the system's nonlinear dynamics.", "problem": "The matrix Riccati differential equation (MRDE) is a fundamental equation in optimal control theory, filtering, and estimation. It is a first-order, nonlinear ordinary differential equation for a matrix-valued function. Consider the following continuous-time MRDE for the $n \\times n$ matrix function $X(t)$:\n$$\n\\frac{dX(t)}{dt} = F^T X(t) + X(t)F - X(t)GX(t) + H\n$$\nThis equation is defined for $t \\ge t_0$, with a given initial condition $X(t_0) = X_0$. The matrices $F, G, H$ are constant $n \\times n$ matrices, and $X_0$ is the constant initial state matrix.\n\nThe matrix exponential is defined by its Taylor series expansion as $\\Phi_A(t) = e^{At} = \\sum_{k=0}^{\\infty} \\frac{(At)^k}{k!}$, where $A$ is a constant $n \\times n$ matrix. It satisfies the property $\\frac{d}{dt} e^{At} = A e^{At} = e^{At} A$. Also, note that $(e^{At})^T = e^{A^T t}$.\n\nYour task is to transform this initial value problem for the MRDE into an equivalent nonlinear matrix Volterra integral equation of the second kind. Derive the expression for $X(t)$ that represents this integral equation.", "solution": "We start from the MRDE for $X(t)$ with $X(t_0)=X_0$:\n$$\n\\frac{dX}{dt}\n=F^T X + X F - X G X + H.\n$$\nIntroduce the change of variable\n$$\nY(t)=e^{-F^T t}\\,X(t)\\,e^{-F t}.\n$$\nThen using $\\frac{d}{dt}e^{-F^T t}=-F^T e^{-F^T t}$ and similarly on the right,\n$$\n\\frac{dY}{dt}\n=e^{-F^T t}\\Bigl(\\frac{dX}{dt}-F^T X -X F\\Bigr)e^{-F t}\n=e^{-F^T t}\\bigl(-XGX+H\\bigr)e^{-F t}.\n$$\nIntegrating from $t_0$ to $t$ gives\n$$\nY(t)-Y(t_0)\n=\\int_{t_0}^{t}e^{-F^T s}\\bigl(-X(s)G X(s)+H\\bigr)e^{-F s}\\,ds.\n$$\nSince $Y(t_0)=e^{-F^T t_0}X_0e^{-F t_0}$, we have\n$$\ne^{-F^T t}X(t)e^{-F t}\n=e^{-F^T t_0}X_0e^{-F t_0}\n+\\int_{t_0}^{t}e^{-F^T s}\\bigl(-X(s)G X(s)+H\\bigr)e^{-F s}\\,ds.\n$$\nMultiplying on the left by $e^{F^T t}$ and on the right by $e^{F t}$ yields the Volterra integral equation:\n$$\nX(t)\n=e^{F^T(t-t_0)}X_0e^{F(t-t_0)}\n+\\int_{t_0}^{t}e^{F^T(t-s)}\\bigl[H - X(s)G X(s)\\bigr]e^{F(t-s)}\\,ds.\n$$", "answer": "$$\\boxed{X(t)=e^{F^T(t-t_0)}X_0e^{F(t-t_0)}+\\int_{t_0}^{t}e^{F^T(t-s)}\\bigl[H - X(s)\\,G\\,X(s)\\bigr]e^{F(t-s)}\\,ds}$$", "id": "1134791"}, {"introduction": "Finding the steady-state error covariance is a cornerstone of filter design, and the Algebraic Riccati Equation (ARE) is the central tool for this task. This practice challenges you to solve the ARE for a concrete system using two sophisticated techniques: analyzing the associated Hamiltonian matrix and exploiting the deep-seated duality with the Linear-Quadratic Regulator (LQR) problem [@problem_id:2913246]. Completing this exercise will not only sharpen your computational skills but also illuminate the rich theoretical connections that underpin modern control and estimation.", "problem": "Consider the continuous-time, linear time-invariant stochastic system driven by white process and measurement noises\n$$\n\\dot{x}(t) \\,=\\, A\\,x(t) \\,+\\, G\\,w(t), \\qquad y(t) \\,=\\, C\\,x(t) \\,+\\, v(t),\n$$\nwhere $x(t) \\in \\mathbb{R}^{2}$, $y(t) \\in \\mathbb{R}$, $w(t)$ and $v(t)$ are mutually independent zero-mean Gaussian white noises with power spectral density matrices $Q_{c}$ and $R$, respectively. Suppose\n$$\nA \\,=\\, \\begin{pmatrix} 0 & 1 \\\\ -2 & -3 \\end{pmatrix}, \\quad\nG \\,=\\, \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}, \\quad\nC \\,=\\, \\begin{pmatrix} 1 & 0 \\end{pmatrix}, \\quad\nQ_{c} \\,=\\, 2, \\quad R \\,=\\, 1.\n$$\nStarting only from the defining properties of the Kalman–Bucy filter for continuous-time systems and the steady-state assumption, derive the steady-state error covariance condition and then compute the stabilizing steady-state error covariance using a Hamiltonian Schur decomposition of the associated Hamiltonian matrix. In parallel, use the duality between continuous-time filtering and the Linear Quadratic Regulator (LQR) to obtain the same steady-state solution by solving the dual LQR Algebraic Riccati Equation (ARE). Let the resulting steady-state error covariance be\n$$\nP \\,=\\, \\begin{pmatrix} p_{11} & p_{12} \\\\ p_{12} & p_{22} \\end{pmatrix}.\n$$\nReport the value of $p_{11}$ as a single real number. Round your answer to four significant figures. No units are required.", "solution": "The problem statement is subjected to validation prior to any attempt at a solution.\n\n**Step 1: Extract Givens**\nThe continuous-time linear time-invariant system is described by the state-space equations:\n$$\n\\dot{x}(t) \\,=\\, A\\,x(t) \\,+\\, G\\,w(t)\n$$\n$$\ny(t) \\,=\\, C\\,x(t) \\,+\\, v(t)\n$$\nThe provided matrices and parameters are:\n$$\nA \\,=\\, \\begin{pmatrix} 0 & 1 \\\\ -2 & -3 \\end{pmatrix}, \\quad\nG \\,=\\, \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}, \\quad\nC \\,=\\, \\begin{pmatrix} 1 & 0 \\end{pmatrix}\n$$\nThe process noise $w(t)$ and measurement noise $v(t)$ are zero-mean, mutually independent, Gaussian white noises with power spectral density matrices $Q_{c} \\,=\\, 2$ and $R \\,=\\, 1$, respectively.\nThe goal is to find the steady-state error covariance matrix $P$, defined as\n$$\nP \\,=\\, \\begin{pmatrix} p_{11} & p_{12} \\\\ p_{12} & p_{22} \\end{pmatrix}\n$$\nand report the value of $p_{11}$.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is scientifically grounded, being a standard exercise in optimal state estimation using the Kalman–Bucy filter. The language is objective and precise. The problem is well-posed. A unique, positive definite steady-state solution for the error covariance $P$ is guaranteed to exist if the pair $(A, G\\sqrt{Q_c})$ is stabilizable and the pair $(C, A)$ is detectable.\nThe stabilizability of $(A, G\\sqrt{Q_c})$ is checked: $G\\sqrt{Q_c} = \\begin{pmatrix} 0 \\\\ \\sqrt{2} \\end{pmatrix}$. The controllability matrix is $\\begin{pmatrix} G\\sqrt{Q_c} & AG\\sqrt{Q_c} \\end{pmatrix} = \\begin{pmatrix} 0 & \\sqrt{2} \\\\ \\sqrt{2} & -3\\sqrt{2} \\end{pmatrix}$. Its determinant is $-2$, which is non-zero, so the pair is controllable and thus stabilizable.\nThe detectability of $(C, A)$ is checked: The observability matrix is $\\begin{pmatrix} C \\\\ CA \\end{pmatrix} = \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix}$. It has full rank, so the pair is observable and thus detectable.\nAll conditions for the existence of a unique, stabilizing, positive definite solution $P$ are met. The problem is self-contained and free of contradictions or ambiguities.\n\n**Step 3: Verdict and Action**\nThe problem is valid. A solution will be provided.\n\n**Derivation of the Steady-State Error Covariance Condition**\n\nThe dynamics of the estimation error, $e(t) = x(t) - \\hat{x}(t)$, for a continuous-time Kalman–Bucy filter are given by $\\dot{e}(t) = (A-K(t)C)e(t) + Gw(t) - K(t)v(t)$, where $K(t)$ is the Kalman gain. The error covariance matrix $P(t) = E[e(t)e^T(t)]$ propagates according to the differential Riccati equation:\n$$\n\\dot{P}(t) = A P(t) + P(t) A^T - K(t)C P(t) - P(t) C^T K^T(t) + G Q_c G^T + K(t) R K^T(t)\n$$\nThe optimal Kalman gain that minimizes the trace of $P(t)$ is $K(t) = P(t) C^T R^{-1}$. Substituting this into the differential Riccati equation yields:\n$$\n\\dot{P}(t) = A P(t) + P(t) A^T - P(t) C^T R^{-1} C P(t) + G Q_c G^T\n$$\nAt steady-state, $\\dot{P}(t) = 0$, leading to the continuous-time Algebraic Riccati Equation (ARE) for the filter:\n$$\n0 = AP + PA^T - PC^T R^{-1} CP + GQ_cG^T\n$$\nThis is the required steady-state error covariance condition.\n\n**Solution via Hamiltonian Matrix Properties**\n\nThe solution to the filter ARE is related to the stable invariant subspace of the associated Hamiltonian matrix $H_f$:\n$$\nH_f = \\begin{pmatrix} A^T & -C^T R^{-1} C \\\\ -G Q_c G^T & -A \\end{pmatrix}\n$$\nFirst, we compute the component matrices:\n$$\nA^T = \\begin{pmatrix} 0 & -2 \\\\ 1 & -3 \\end{pmatrix}, \\quad -A = \\begin{pmatrix} 0 & -1 \\\\ 2 & 3 \\end{pmatrix}\n$$\n$$\n-C^T R^{-1} C = -\\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} (1)^{-1} \\begin{pmatrix} 1 & 0 \\end{pmatrix} = \\begin{pmatrix} -1 & 0 \\\\ 0 & 0 \\end{pmatrix}\n$$\n$$\n-G Q_c G^T = -\\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} (2) \\begin{pmatrix} 0 & 1 \\end{pmatrix} = \\begin{pmatrix} 0 & 0 \\\\ 0 & -2 \\end{pmatrix}\n$$\nThe Hamiltonian matrix is:\n$$\nH_f = \\begin{pmatrix} 0 & -2 & -1 & 0 \\\\ 1 & -3 & 0 & 0 \\\\ 0 & 0 & 0 & -1 \\\\ 0 & -2 & 2 & 3 \\end{pmatrix}\n$$\nThe characteristic polynomial of $H_f$ is $\\det(\\lambda I - H_f) = \\lambda^4 - 5\\lambda^2 + 6 = 0$. Letting $y = \\lambda^2$, we have $y^2 - 5y + 6 = (y-2)(y-3) = 0$. The eigenvalues are therefore $\\lambda = \\pm\\sqrt{2}$ and $\\lambda = \\pm\\sqrt{3}$.\nThe stable eigenvalues of $H_f$ are those with negative real parts: $-\\sqrt{2}$ and $-\\sqrt{3}$. A fundamental property of the ARE is that the eigenvalues of the closed-loop dynamics matrix for the optimal filter, $A_{cl} = A - KC$, must be equal to the stable eigenvalues of the Hamiltonian matrix. The steady-state Kalman gain is $K = PC^TR^{-1}$.\n$$\nK = \\begin{pmatrix} p_{11} & p_{12} \\\\ p_{12} & p_{22} \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} (1)^{-1} = \\begin{pmatrix} p_{11} \\\\ p_{12} \\end{pmatrix}\n$$\nThe closed-loop matrix is:\n$$\nA_{cl} = A - KC = \\begin{pmatrix} 0 & 1 \\\\ -2 & -3 \\end{pmatrix} - \\begin{pmatrix} p_{11} \\\\ p_{12} \\end{pmatrix} \\begin{pmatrix} 1 & 0 \\end{pmatrix} = \\begin{pmatrix} -p_{11} & 1 \\\\ -2-p_{12} & -3 \\end{pmatrix}\n$$\nThe characteristic polynomial of $A_{cl}$ is:\n$$\n\\det(\\lambda I - A_{cl}) = \\det\\begin{pmatrix} \\lambda+p_{11} & -1 \\\\ 2+p_{12} & \\lambda+3 \\end{pmatrix} = (\\lambda+p_{11})(\\lambda+3) + (2+p_{12}) = \\lambda^2 + (3+p_{11})\\lambda + (3p_{11} + p_{12} + 2)\n$$\nThe desired characteristic polynomial with eigenvalues $-\\sqrt{2}$ and $-\\sqrt{3}$ is:\n$$\n(\\lambda + \\sqrt{2})(\\lambda + \\sqrt{3}) = \\lambda^2 + (\\sqrt{2}+\\sqrt{3})\\lambda + \\sqrt{6}\n$$\nBy comparing the coefficients of the two polynomials, we obtain a system of equations:\n1) $3+p_{11} = \\sqrt{2}+\\sqrt{3}$\n2) $3p_{11} + p_{12} + 2 = \\sqrt{6}$\n\nFrom equation (1), we solve for $p_{11}$:\n$$\np_{11} = \\sqrt{2} + \\sqrt{3} - 3\n$$\n\n**Solution via Duality with LQR**\n\nThe continuous-time ARE for the filter is dual to the ARE for a Linear Quadratic Regulator (LQR) problem. The standard LQR problem seeks to find a control law $u=-K_c x$ that minimizes $\\int_0^\\infty (x^T Q_{lqr} x + u^T R_{lqr} u) dt$ for a system $\\dot{x}=A_{lqr}x+B_{lqr}u$. The corresponding ARE for the controller gain matrix $S$ is $A_{lqr}^T S + S A_{lqr} - S B_{lqr} R_{lqr}^{-1} B_{lqr}^T S + Q_{lqr} = 0$.\nThe duality mapping is: $A_{lqr} \\leftrightarrow A^T$, $B_{lqr} \\leftrightarrow C^T$, $Q_{lqr} \\leftrightarrow G Q_c G^T$, and $R_{lqr} \\leftrightarrow R$. The solution $S$ of the LQR ARE is the solution $P$ of the filter ARE.\nApplying this mapping to the LQR ARE:\n$$\n(A^T)^T P + P(A^T) - P(C^T)(R)^{-1}(C^T)^T P + GQ_cG^T = 0\n$$\n$$\nAP + PA^T - PC^TR^{-1}CP + GQ_cG^T = 0\n$$\nThis is precisely the filter ARE, confirming that solving the dual LQR problem for the specified matrices yields the same matrix $P$. To find the solution, we can solve the system of scalar equations derived from the matrix ARE.\nFrom the matrix ARE, we obtain three scalar equations for the elements of $P$:\ni) $(1,1) \\text{ element: } 2p_{12} - p_{11}^2 = 0 \\implies 2p_{12} = p_{11}^2$\nii) $(1,2) \\text{ element: } p_{22} - 2p_{11} - 3p_{12} - p_{11}p_{12} = 0$\niii) $(2,2) \\text{ element: } -4p_{12} - 6p_{22} + 2 - p_{12}^2 = 0$\nThe results from the Hamiltonian pole-placement method must satisfy this system. From equation (2) of the pole-placement method, $p_{12} = \\sqrt{6} - 2 - 3p_{11}$. Substituting $p_{11} = \\sqrt{2}+\\sqrt{3}-3$:\n$$\np_{12} = \\sqrt{6} - 2 - 3(\\sqrt{2}+\\sqrt{3}-3) = 7 + \\sqrt{6} - 3\\sqrt{2} - 3\\sqrt{3}\n$$\nWe can verify that these values satisfy equation (i):\n$$\np_{11}^2 = (\\sqrt{2}+\\sqrt{3}-3)^2 = (\\sqrt{2})^2 + (\\sqrt{3})^2 + (-3)^2 + 2\\sqrt{2}\\sqrt{3} - 6\\sqrt{2} - 6\\sqrt{3} = 14 + 2\\sqrt{6} - 6\\sqrt{2} - 6\\sqrt{3}\n$$\n$$\n2p_{12} = 2(7 + \\sqrt{6} - 3\\sqrt{2} - 3\\sqrt{3}) = 14 + 2\\sqrt{6} - 6\\sqrt{2} - 6\\sqrt{3}\n$$\nThe equation $p_{11}^2 = 2p_{12}$ is satisfied, confirming the consistency of the methods.\n\n**Final Calculation**\n\nThe value of $p_{11}$ is given by $p_{11} = \\sqrt{2} + \\sqrt{3} - 3$.\nUsing the numerical values $\\sqrt{2} \\approx 1.41421356$ and $\\sqrt{3} \\approx 1.73205081$:\n$$\np_{11} \\approx 1.41421356 + 1.73205081 - 3 = 3.14626437 - 3 = 0.14626437\n$$\nRounding to four significant figures, we get $p_{11} \\approx 0.1463$.", "answer": "$$\n\\boxed{0.1463}\n$$", "id": "2913246"}, {"introduction": "Real-world systems often contain dynamics that operate on vastly different time scales, and full-order models can be computationally prohibitive. This exercise introduces a powerful model reduction technique, singular perturbation theory, to derive an approximate, lower-order Kalman filter for a two-time-scale system [@problem_id:2996509]. You will first analytically derive the simplified filter based on a quasi-steady-state assumption and then computationally implement both the exact and approximate solutions to quantify the approximation error, providing invaluable hands-on experience in the practical art of designing efficient state estimators.", "problem": "Consider a continuous-time, two-time-scale, linear Gaussian state-space model governed by the Stochastic Differential Equation (SDE)\n$$\n\\begin{aligned}\nd x_t &= \\big(a\\, x_t + b\\, y_t\\big)\\,dt + \\sqrt{q_x}\\,dW_t^{(1)}, \\\\\nd y_t &= \\frac{\\gamma\\, x_t - \\lambda\\, y_t}{\\epsilon}\\,dt + 0\\cdot dW_t^{(2)}, \\\\\nd z_t &= c\\, x_t\\,dt + \\sqrt{r}\\,dV_t,\n\\end{aligned}\n$$\nwhere $x_t \\in \\mathbb{R}$ is the slow state, $y_t \\in \\mathbb{R}$ is the fast state, $z_t \\in \\mathbb{R}$ is the observation process, $a, b, \\gamma, \\lambda, c \\in \\mathbb{R}$ with $\\lambda > 0$ and $c \\neq 0$, $q_x > 0$ is the process noise intensity on $x_t$, $r > 0$ is the observation noise intensity, and $\\epsilon > 0$ is a small time-scale parameter. The Wiener processes $W_t^{(1)}$ and $V_t$ are independent standard Brownian motions. The fast process has no direct process noise in this setup, i.e., the intensity on $y_t$ is zero, and the coupling produces two time scales due to the factor $1/\\epsilon$.\n\nLet the system be written in compact form with the state vector $s_t = \\begin{bmatrix} x_t \\\\ y_t \\end{bmatrix}$ and matrices\n$$\nA(\\epsilon) = \\begin{bmatrix} a & b \\\\ \\dfrac{\\gamma}{\\epsilon} & -\\dfrac{\\lambda}{\\epsilon} \\end{bmatrix},\\quad\nQ(\\epsilon) = \\begin{bmatrix} q_x & 0 \\\\ 0 & 0 \\end{bmatrix},\\quad\nC = \\begin{bmatrix} c & 0 \\end{bmatrix},\\quad\nR = \\begin{bmatrix} r \\end{bmatrix}.\n$$\nThe exact, steady-state Kalman-Bucy gain $K^\\star(\\epsilon) \\in \\mathbb{R}^{2 \\times 1}$ for the full two-dimensional system is defined through the steady-state error covariance $P(\\epsilon) \\in \\mathbb{R}^{2 \\times 2}$ that satisfies the continuous-time Algebraic Riccati Equation (ARE)\n$$\nA(\\epsilon)\\,P(\\epsilon) + P(\\epsilon)\\,A(\\epsilon)^\\top + Q(\\epsilon) - P(\\epsilon)\\,C^\\top R^{-1}\\,C\\,P(\\epsilon) = 0,\n$$\nwith\n$$\nK^\\star(\\epsilon) = P(\\epsilon)\\,C^\\top R^{-1}.\n$$\n\nWhen the time-scale parameter $\\epsilon$ is small, a singular perturbation argument suggests the fast state $y_t$ rapidly approaches a quasi-steady algebraic relation with respect to the slow state $x_t$. Using this, form an approximate scalar slow subsystem and derive an approximate steady-state Kalman-Bucy gain $K^{\\text{approx}}(\\epsilon) \\in \\mathbb{R}^{2 \\times 1}$ that leverages the reduced slow dynamics and a quasi-static relation to reconstruct the fast-state gain component.\n\nYour tasks are:\n1. Starting from the fundamental definitions of linear Gaussian state-space models, the Kalman-Bucy filter, and singular perturbation for two-time-scale systems, derive the approximate slow-subsystem dynamics and the corresponding steady-state scalar Algebraic Riccati Equation for the slow error covariance. Use that result to obtain an approximation $K^{\\text{approx}}(\\epsilon)$ of the full gain $K^\\star(\\epsilon)$.\n2. Implement a program that, for each test case provided below, computes:\n   - The exact steady-state gain $K^\\star(\\epsilon)$ by numerically solving the steady-state Kalman-Bucy ARE for the full two-dimensional system.\n   - The approximate gain $K^{\\text{approx}}(\\epsilon)$ from the reduced slow-subsystem and the quasi-static reconstruction of the fast component.\n   - The relative error\n     $$\n     \\mathrm{RelErr}(\\epsilon) = \\frac{\\left\\|K^\\star(\\epsilon) - K^{\\text{approx}}(\\epsilon)\\right\\|_2}{\\left\\|K^\\star(\\epsilon)\\right\\|_2},\n     $$\n     where $\\|\\cdot\\|_2$ denotes the Euclidean norm in $\\mathbb{R}^2$.\n\nThe program must produce a single line of output containing the results for all test cases as a comma-separated list enclosed in square brackets. Each entry in the list must be a floating-point number corresponding to the relative error for the associated test case.\n\nUse the following test suite of parameter values to ensure coverage of a typical case, improved scale separation, weak observation, and a coupling boundary condition:\n- Common parameters unless explicitly modified: $a = -0.8$, $b = 1.2$, $\\gamma = 0.5$, $\\lambda = 3.0$, $c = 1.0$, $r = 0.4$, $q_x = 0.75$.\n- Test cases:\n  1. $\\epsilon = 10^{-1}$.\n  2. $\\epsilon = 10^{-2}$.\n  3. $\\epsilon = 10^{-3}$.\n  4. $\\epsilon = 10^{-2}$ with $b = 0.0$.\n  5. $\\epsilon = 5\\times 10^{-3}$ with $c = 0.2$.\n  6. $\\epsilon = 2\\times 10^{-2}$ with $\\lambda = 8.0$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[result1,result2,result3,result4,result5,result6]\"). No physical units are involved in this problem; all quantities are dimensionless.", "solution": "We begin with the continuous-time linear Gaussian state-space model and the Kalman-Bucy filter. The state satisfies the Stochastic Differential Equation (SDE)\n$$\nd s_t = A(\\epsilon)\\,s_t\\,dt + G(\\epsilon)\\,dW_t,\n$$\nand the observation satisfies\n$$\nd z_t = C\\,s_t\\,dt + \\sqrt{R}\\,dV_t,\n$$\nwhere $s_t \\in \\mathbb{R}^2$, $A(\\epsilon) \\in \\mathbb{R}^{2\\times 2}$, $G(\\epsilon) \\in \\mathbb{R}^{2\\times 2}$ encodes the process noise channels, $C \\in \\mathbb{R}^{1\\times 2}$, and $R \\in \\mathbb{R}^{1\\times 1}$ is the observation noise intensity. In our setup,\n$$\nA(\\epsilon) = \\begin{bmatrix} a & b \\\\ \\dfrac{\\gamma}{\\epsilon} & -\\dfrac{\\lambda}{\\epsilon} \\end{bmatrix},\\qquad\nQ(\\epsilon) = G(\\epsilon)\\,G(\\epsilon)^\\top = \\begin{bmatrix} q_x & 0 \\\\ 0 & 0 \\end{bmatrix},\\qquad\nC = \\begin{bmatrix} c & 0 \\end{bmatrix},\\qquad R = \\begin{bmatrix} r \\end{bmatrix}.\n$$\nThe Kalman-Bucy filter produces an estimate $\\hat{s}_t$ whose error covariance $P(\\epsilon,t) \\in \\mathbb{R}^{2\\times 2}$ satisfies the Riccati differential equation\n$$\n\\dot{P}(\\epsilon,t) = A(\\epsilon)\\,P(\\epsilon,t) + P(\\epsilon,t)\\,A(\\epsilon)^\\top + Q(\\epsilon) - P(\\epsilon,t)\\,C^\\top R^{-1}\\,C\\,P(\\epsilon,t).\n$$\nUnder standard detectability and stabilizability conditions, the steady-state error covariance $P(\\epsilon)$ solves the continuous-time Algebraic Riccati Equation (ARE)\n$$\nA(\\epsilon)\\,P(\\epsilon) + P(\\epsilon)\\,A(\\epsilon)^\\top + Q(\\epsilon) - P(\\epsilon)\\,C^\\top R^{-1}\\,C\\,P(\\epsilon) = 0,\n$$\nand the steady-state Kalman gain is\n$$\nK^\\star(\\epsilon) = P(\\epsilon)\\,C^\\top R^{-1}.\n$$\n\nWe now use singular perturbation to form an approximation appropriate for small $\\epsilon$. The fast dynamics are\n$$\n\\frac{d y_t}{dt} = \\frac{\\gamma\\,x_t - \\lambda\\,y_t}{\\epsilon},\n$$\nwith $\\lambda > 0$, making $y_t$ evolve on the fast time scale $O(\\epsilon)$. For small $\\epsilon$, and on the slow time scale of $x_t$, the fast state rapidly relaxes to an algebraic quasi-steady relation obtained by setting the fast drift approximately to zero:\n$$\n0 \\approx \\gamma\\,x_t - \\lambda\\,y_t \\quad \\Rightarrow \\quad y_t \\approx \\frac{\\gamma}{\\lambda}\\,x_t.\n$$\nSubstituting this into the slow dynamics yields the reduced slow-subsystem\n$$\n\\frac{d x_t}{dt} \\approx \\left(a + b\\,\\frac{\\gamma}{\\lambda}\\right) x_t + \\sqrt{q_x}\\,dW_t^{(1)},\n$$\nwhich is a scalar linear Gaussian system. The observation is\n$$\nd z_t = c\\,x_t\\,dt + \\sqrt{r}\\,dV_t,\n$$\nso the effective observation depends only on $x_t$. Therefore, the scalar steady-state Riccati equation for the slow error covariance $p \\in \\mathbb{R}$ is the continuous-time Kalman-Bucy Algebraic Riccati Equation for a one-dimensional system:\n$$\n2\\,a_{\\mathrm{eff}}\\,p + q_x - \\frac{c^2}{r}\\,p^2 = 0,\\qquad a_{\\mathrm{eff}} := a + b\\,\\frac{\\gamma}{\\lambda}.\n$$\nThis is a quadratic equation in $p$ with discriminant\n$$\n\\Delta = 4\\,a_{\\mathrm{eff}}^2 + 4\\,\\frac{c^2}{r}\\,q_x.\n$$\nThe stabilizing steady-state solution with $p > 0$ is\n$$\np = \\frac{a_{\\mathrm{eff}} + \\sqrt{a_{\\mathrm{eff}}^2 + \\frac{c^2}{r}\\,q_x}}{\\frac{c^2}{r}}.\n$$\nThe corresponding slow-state Kalman gain is the scalar\n$$\nK_x^{\\text{approx}} = \\frac{p\\,c}{r}.\n$$\nTo reconstruct the fast-state component consistent with the quasi-steady relation $y_t \\approx (\\gamma/\\lambda)\\,x_t$, we use the same proportionality in the estimator update so that\n$$\nK_y^{\\text{approx}} = \\frac{\\gamma}{\\lambda}\\,K_x^{\\text{approx}}.\n$$\nHence, the approximate full gain is\n$$\nK^{\\text{approx}}(\\epsilon) = \\begin{bmatrix} K_x^{\\text{approx} } \\\\ K_y^{\\text{approx}} \\end{bmatrix} = \\begin{bmatrix} \\dfrac{p\\,c}{r} \\\\ \\dfrac{\\gamma}{\\lambda}\\,\\dfrac{p\\,c}{r} \\end{bmatrix}.\n$$\n\nFor the exact gain, we solve the steady-state continuous-time Algebraic Riccati Equation for the full two-dimensional system. A numerically convenient way to compute $P(\\epsilon)$ is to use the standard Linear Quadratic Regulator (LQR) solver for the continuous-time ARE by transposition: the LQR ARE\n$$\nA^\\top X + X A - X B R^{-1} B^\\top X + Q = 0\n$$\nmatches the Kalman-Bucy ARE if we set $A \\leftarrow A(\\epsilon)^\\top$, $B \\leftarrow C^\\top$, $Q \\leftarrow Q(\\epsilon)$, and $R \\leftarrow R$. Solving for $X$ gives $P(\\epsilon)$, and the exact gain is $K^\\star(\\epsilon) = P(\\epsilon)\\,C^\\top R^{-1}$.\n\nAlgorithmic steps for each test case:\n1. Construct $A(\\epsilon)$, $Q(\\epsilon)$, $C$, and $R$ using the specified parameters.\n2. Compute $P(\\epsilon)$ by solving the ARE with the transposed method described above, then compute $K^\\star(\\epsilon) = P(\\epsilon)\\,C^\\top R^{-1}$.\n3. Compute $a_{\\mathrm{eff}}$, solve the scalar quadratic for $p$, compute $K^{\\text{approx}}(\\epsilon)$ as above.\n4. Compute the relative error\n   $$\n   \\mathrm{RelErr}(\\epsilon) = \\frac{\\left\\|K^\\star(\\epsilon) - K^{\\text{approx}}(\\epsilon)\\right\\|_2}{\\left\\|K^\\star(\\epsilon)\\right\\|_2}.\n   $$\n5. Aggregate the relative errors over all test cases and output them in the required single-line format.\n\nCoverage discussion:\n- For $\\epsilon = 10^{-1}$, the scale separation is modest, testing the approximation in a less ideal regime.\n- For $\\epsilon = 10^{-2}$ and $\\epsilon = 10^{-3}$, the scale separation improves, and the approximation should become more accurate.\n- Setting $b = 0$ removes the dependence of the slow dynamics on the fast state while the fast state still depends on the slow state, testing the reconstruction of the fast component in the absence of slow-to-fast feedback.\n- Setting $c = 0.2$ weakens the observation, reducing the Kalman gain magnitude and testing numerical stability.\n- Increasing $\\lambda$ to $8.0$ strengthens the contraction of the fast dynamics, improving the quasi-static approximation.\n\nThe final program solves the exact Kalman-Bucy steady-state gain using the Algebraic Riccati Equation and the approximate gain via singular perturbation, then reports the relative errors for the specified test suite.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import solve_continuous_are\n\ndef exact_kalman_gain(a, b, gamma, lam, c, r, qx, eps):\n    \"\"\"\n    Compute the exact steady-state Kalman-Bucy gain for the two-dimensional system.\n    Uses the continuous-time Algebraic Riccati Equation (ARE) via the LQR solver trick.\n    \"\"\"\n    # System matrices\n    A = np.array([[a, b],\n                  [gamma/eps, -lam/eps]], dtype=float)\n    Q = np.diag([qx, 0.0])\n    C = np.array([[c, 0.0]], dtype=float)  # 1x2\n    R = np.array([[r]], dtype=float)       # 1x1\n\n    # Solve ARE: A^T X + X A - X B R^{-1} B^T X + Q = 0 with B = C^T\n    P = solve_continuous_are(A.T, C.T, Q, R)\n\n    # Kalman gain K = P C^T R^{-1}; since R is scalar, we can divide by r\n    K = (P @ C.T) / r  # shape (2,1)\n    return K.reshape(2)\n\ndef approx_kalman_gain(a, b, gamma, lam, c, r, qx):\n    \"\"\"\n    Compute the approximate steady-state Kalman-Bucy gain via singular perturbation\n    for small epsilon: reduce to scalar slow subsystem and reconstruct fast component.\n    \"\"\"\n    a_eff = a + b * (gamma / lam)\n    # Solve scalar continuous-time Kalman-Bucy ARE: 2 a_eff p + qx - (c^2/r) p^2 = 0\n    # Stabilizing positive solution:\n    denom = (c**2) / r\n    # Numerical safety: denom > 0 since r > 0 and c != 0\n    p = (a_eff + np.sqrt(a_eff**2 + denom * qx)) / denom\n    Kx = (p * c) / r\n    Ky = (gamma / lam) * Kx\n    return np.array([Kx, Ky], dtype=float)\n\ndef relative_error(K_exact, K_approx):\n    \"\"\"\n    Relative 2-norm error between exact and approximate Kalman gain vectors.\n    \"\"\"\n    num = np.linalg.norm(K_exact - K_approx, 2)\n    den = np.linalg.norm(K_exact, 2)\n    # Guard against zero denominator (unlikely with c != 0 and qx > 0)\n    if den == 0.0:\n        return float('nan')\n    return num / den\n\ndef solve():\n    # Common parameters\n    base = {\n        \"a\": -0.8,\n        \"b\": 1.2,\n        \"gamma\": 0.5,\n        \"lam\": 3.0,\n        \"c\": 1.0,\n        \"r\": 0.4,\n        \"qx\": 0.75\n    }\n\n    # Test cases: list of dictionaries overriding base where needed\n    test_cases = [\n        # 1. epsilon = 1e-1\n        {\"eps\": 1e-1},\n        # 2. epsilon = 1e-2\n        {\"eps\": 1e-2},\n        # 3. epsilon = 1e-3\n        {\"eps\": 1e-3},\n        # 4. epsilon = 1e-2 with b = 0\n        {\"eps\": 1e-2, \"b\": 0.0},\n        # 5. epsilon = 5e-3 with c = 0.2 (weak observation)\n        {\"eps\": 5e-3, \"c\": 0.2},\n        # 6. epsilon = 2e-2 with lambda = 8.0 (strong fast contraction)\n        {\"eps\": 2e-2, \"lam\": 8.0},\n    ]\n\n    results = []\n    for tc in test_cases:\n        # Merge base with overrides\n        params = base.copy()\n        params.update(tc)\n        a = params[\"a\"]\n        b = params[\"b\"]\n        gamma = params[\"gamma\"]\n        lam = params[\"lam\"]\n        c = params[\"c\"]\n        r = params[\"r\"]\n        qx = params[\"qx\"]\n        eps = params[\"eps\"]\n\n        K_exact = exact_kalman_gain(a, b, gamma, lam, c, r, qx, eps)\n        K_approx = approx_kalman_gain(a, b, gamma, lam, c, r, qx)\n        err = relative_error(K_exact, K_approx)\n        results.append(err)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2996509"}]}