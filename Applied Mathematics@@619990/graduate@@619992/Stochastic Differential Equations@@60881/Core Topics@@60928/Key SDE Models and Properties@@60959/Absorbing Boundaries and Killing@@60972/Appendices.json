{"hands_on_practices": [{"introduction": "Let's begin with one of the most fundamental questions for a process in a confined domain: where will it exit? This exercise asks you to compute the probability that a Brownian motion hits one side of an interval before the other. This problem bridges probability with potential theory by showing that this \"exit probability\" is a harmonic function satisfying $Lu=0$, a core principle in the study of stochastic processes [@problem_id:2968268].", "problem": "Consider a one-dimensional standard Brownian motion $B_t$ on $\\mathbb{R}$, started at $B_0 = x$ with $x \\in (0,a)$ for a fixed $a0$. Let $\\tau_0 = \\inf\\{t \\geq 0 : B_t = 0\\}$ and $\\tau_a = \\inf\\{t \\geq 0 : B_t = a\\}$ be the first hitting times of the boundary points $0$ and $a$, respectively. The process is killed upon hitting the boundary of the interval $(0,a)$, meaning the evolution stops at time $\\tau = \\tau_0 \\wedge \\tau_a$. Using only foundational properties of Brownian motion—its martingale structure and generator—as well as the connection between killing at the boundary and Dirichlet boundary value problems, compute the probability $\\mathbb{P}_x(\\tau_0  \\tau_a)$ as a closed-form analytic expression in terms of $x$ and $a$. Then interpret this quantity as the harmonic measure at the boundary point $0$ for absorption of the killed process, explaining why it equals the value at $x$ of the unique harmonic function on $(0,a)$ with boundary data $1$ at $0$ and $0$ at $a$. The final answer must be a single analytic expression. No rounding is required and no units are involved.", "solution": "The problem asks for the probability that a standard one-dimensional Brownian motion $B_t$ starting at $x \\in (0, a)$ hits the boundary at $0$ before it hits the boundary at $a$. Let this probability be denoted by $p(x) = \\mathbb{P}_x(\\tau_0  \\tau_a)$, where the subscript in $\\mathbb{P}_x$ indicates the starting position $B_0=x$. This quantity can be computed in two primary ways.\n\n**Method 1: Using the Martingale Property of Brownian Motion**\n\nA standard one-dimensional Brownian motion $B_t$ is a martingale. For a bounded domain like $(0,a)$, the first exit time $\\tau = \\tau_0 \\wedge \\tau_a$ is almost surely finite. The stopped process $B_{t \\wedge \\tau}$ is a bounded martingale. By the Optional Stopping Theorem, we can state that the expectation of the process at the stopping time is equal to its initial value:\n$$\n\\mathbb{E}_x[B_\\tau] = B_0 = x\n$$\nAt the stopping time $\\tau$, the process must be at one of the boundaries. It is at $0$ with probability $p(x) = \\mathbb{P}_x(\\tau_0  \\tau_a)$, and it is at $a$ with probability $1 - p(x)$. Therefore, we can expand the expectation:\n$$\n\\mathbb{E}_x[B_\\tau] = 0 \\cdot \\mathbb{P}_x(B_\\tau = 0) + a \\cdot \\mathbb{P}_x(B_\\tau = a) = 0 \\cdot p(x) + a \\cdot (1 - p(x)) = a(1 - p(x))\n$$\nEquating the two expressions for the expectation gives the equation:\n$$\nx = a(1 - p(x))\n$$\nSolving for $p(x)$ yields the result:\n$$\np(x) = 1 - \\frac{x}{a} = \\frac{a-x}{a}\n$$\n\n**Method 2: Using the Generator and Connection to Dirichlet Problems**\n\nA fundamental result connects the exit probabilities of a diffusion process to a boundary value problem involving its generator. The generator of a standard one-dimensional Brownian motion is $\\mathcal{L} = \\frac{1}{2} \\frac{d^2}{dx^2}$. The exit probability $u(x) = \\mathbb{P}_x(\\tau_0  \\tau_a)$ is a harmonic function for this generator, meaning it solves $\\mathcal{L}u(x) = 0$ inside the domain $(0,a)$.\n$$\n\\frac{1}{2} u''(x) = 0 \\implies u''(x) = 0\n$$\nThe boundary conditions are determined by the event of interest. If the process starts at $x=0$, it has already hit the boundary at $0$, so the probability is $1$. If it starts at $x=a$, the probability of hitting $0$ first is $0$.\n$$\nu(0) = 1, \\quad u(a) = 0\n$$\nIntegrating the differential equation $u''(x)=0$ twice gives the general solution $u(x) = c_1 x + c_2$. Applying the boundary conditions:\n- $u(0)=1 \\implies c_1(0) + c_2 = 1 \\implies c_2 = 1$.\n- $u(a)=0 \\implies c_1 a + c_2 = 0 \\implies c_1 a + 1 = 0 \\implies c_1 = -1/a$.\n\nSubstituting the constants gives the unique solution:\n$$\nu(x) = -\\frac{1}{a} x + 1 = \\frac{a-x}{a}\n$$\nBoth methods yield the same result.\n\n**Interpretation as Harmonic Measure**\n\nThe quantity $u(x) = \\mathbb{P}_x(\\tau_0  \\tau_a)$ is the harmonic measure of the boundary set $\\{0\\}$ as seen from the interior point $x$. In general, for a domain $D$, the harmonic measure $\\omega_x(A)$ of a boundary subset $A \\subseteq \\partial D$ is the probability that the process started at $x$ first exits $D$ through $A$. This measure is found by solving the Dirichlet problem $\\mathcal{L}u=0$ in $D$ with boundary data $u=1$ on $A$ and $u=0$ on $\\partial D \\setminus A$. Our calculation confirms this principle for the 1D interval.", "answer": "$$\\boxed{\\frac{a-x}{a}}$$", "id": "2968268"}, {"introduction": "After determining where the process is likely to exit, a natural next question is how long we expect it to take. This practice guides you to calculate the mean first exit time from an interval for a Brownian motion. You will see how this quantity is elegantly governed by a Poisson equation, $Lu=-1$, providing a powerful link between the process generator and the expectation of stopping times [@problem_id:2968231].", "problem": "Let $\\{X_t\\}_{t \\geq 0}$ be a one-dimensional standard Brownian motion with infinitesimal generator $L = \\frac{1}{2}\\frac{d^{2}}{dx^{2}}$, started at $X_0 = x \\in (0,a)$ for a fixed $a  0$. Consider the open interval $D = (0,a)$ with absorbing boundary (killing) at $\\partial D = \\{0,a\\}$, and define the first exit time $\\tau_{\\partial D} = \\inf\\{t \\geq 0 : X_t \\notin D\\}$. \n\nUsing only foundational principles of stochastic differential equations—namely, the generator of the process, the strong Markov property, and the relationship between killing at the boundary and Dirichlet boundary conditions—derive the boundary value problem satisfied by the function $u(x) = \\mathbb{E}_x[\\tau_{\\partial D}]$ and solve it to obtain a closed-form expression for $u(x)$. Additionally, explain the mathematical meaning of boundary absorption in this setting and how it is encoded in the boundary conditions for $u(x)$.\n\nYour final answer must be an analytic expression for $u(x)$ depending on $x$ and $a$. No numerical rounding is required and no physical units apply.", "solution": "The process $\\{X_t\\}_{t \\geq 0}$ is a one-dimensional standard Brownian motion, so its infinitesimal generator is $L = \\frac{1}{2}\\frac{d^{2}}{dx^{2}}$. The interval $D = (0,a)$ is equipped with absorbing boundaries at $\\partial D = \\{0,a\\}$; killing means that the process is stopped upon first hitting the boundary and sent to a cemetery state, with no further evolution past the exit time $\\tau_{\\partial D}$. \n\nWe aim to compute $u(x) = \\mathbb{E}_x[\\tau_{\\partial D}]$. The foundational derivation uses the connection between expected functionals of stopping times and the generator via Dynkin's formula (which follows from Itô's formula and the strong Markov property). For a sufficiently smooth function $u$ and a stopping time $\\tau$ such that the stopped process is integrable, Dynkin's formula states\n$$\n\\mathbb{E}_x\\left[u\\left(X_{t \\wedge \\tau}\\right)\\right] = u(x) + \\mathbb{E}_x\\left[\\int_{0}^{t \\wedge \\tau} L u\\left(X_s\\right)\\, ds\\right].\n$$\nIf the process is killed at $\\tau = \\tau_{\\partial D}$, then the boundary absorption implies the Dirichlet boundary condition\n$$\nu(y) = 0 \\quad \\text{for} \\quad y \\in \\partial D,\n$$\nbecause if the process starts at the boundary, it is immediately killed and the exit time is $0$, and after hitting the boundary, the remaining expected time until killing is $0$. \n\nTo identify the partial differential equation for $u$, we choose $u$ so that the time integral of $L u$ reproduces the elapsed time until killing. Specifically, if $u$ satisfies\n$$\nL u(x) = -1 \\quad \\text{for} \\quad x \\in D,\n$$\nthen substituting into Dynkin's formula and letting $t \\to \\infty$ (so that $t \\wedge \\tau_{\\partial D} \\to \\tau_{\\partial D}$ almost surely) yields\n$$\n\\mathbb{E}_x\\left[u\\left(X_{\\tau_{\\partial D}}\\right)\\right] = u(x) + \\mathbb{E}_x\\left[\\int_{0}^{\\tau_{\\partial D}} (-1)\\, ds\\right] = u(x) - \\mathbb{E}_x\\left[\\tau_{\\partial D}\\right].\n$$\nBy boundary absorption, $u\\left(X_{\\tau_{\\partial D}}\\right) = 0$, so $\\mathbb{E}_x\\left[u\\left(X_{\\tau_{\\partial D}}\\right)\\right] = 0$. Therefore,\n$$\n0 = u(x) - \\mathbb{E}_x\\left[\\tau_{\\partial D}\\right] \\quad \\Rightarrow \\quad u(x) = \\mathbb{E}_x\\left[\\tau_{\\partial D}\\right].\n$$\nHence $u$ is determined as the solution to the Dirichlet problem\n$$\n\\frac{1}{2} u''(x) = -1 \\quad \\text{for} \\quad x \\in (0,a), \\qquad u(0) = 0, \\quad u(a) = 0.\n$$\n\nWe now solve this ordinary differential equation. The equation $\\frac{1}{2} u''(x) = -1$ is equivalent to\n$$\nu''(x) = -2.\n$$\nIntegrating twice in $x$ gives\n$$\nu'(x) = -2x + C_1, \\qquad u(x) = -x^{2} + C_1 x + C_2,\n$$\nfor constants $C_1$ and $C_2$ determined by the boundary conditions. Imposing $u(0) = 0$ yields $C_2 = 0$. Imposing $u(a) = 0$ yields\n$$\n0 = -a^{2} + C_1 a \\quad \\Rightarrow \\quad C_1 = a.\n$$\nTherefore,\n$$\nu(x) = -x^{2} + a x = x(a - x).\n$$\nThis is the closed-form expression for the expected time to absorption (killing) at the boundary $\\partial D$ starting from $x \\in (0,a)$.\n\nInterpretation of boundary absorption: The killing at the boundary means that once the process $\\{X_t\\}_{t \\geq 0}$ hits either $0$ or $a$, it is terminated and no further time is accumulated. This is encoded mathematically by the Dirichlet boundary condition $u=0$ on $\\partial D$, reflecting that if the process starts on the boundary, the exit time is $0$, and if it reaches the boundary during evolution, future contributions to the expectation cease. The strong Markov property guarantees that the evaluation of expectations up to the stopping time is consistent, and the generator equation $L u = -1$ captures the rate at which expected time accrues in the interior of the domain under the diffusion dynamics.", "answer": "$$\\boxed{x(a - x)}$$", "id": "2968231"}, {"introduction": "Moving beyond static probabilities and expectations, we can ask for a full dynamic picture of the process. This advanced problem challenges you to derive the survival probability, i.e., the probability that the particle has not yet been absorbed by time $t$. By solving the time-dependent heat equation using an eigenfunction expansion, you will uncover the entire distribution of the exit time, a significantly more detailed result than its mere expectation [@problem_id:2968272].", "problem": "Let $\\{B_{t}\\}_{t\\geq 0}$ be a one-dimensional standard Brownian motion started at $x\\in (0,a)$ with $a0$, and define the stopped process $X_{t}=B_{t}$ killed upon hitting the boundary of the interval $(0,a)$. Denote the first hitting times by $\\tau_{0}=\\inf\\{t\\geq 0: X_{t}=0\\}$ and $\\tau_{a}=\\inf\\{t\\geq 0: X_{t}=a\\}$, and let $\\tau=\\tau_{0}\\wedge \\tau_{a}$. Consider the survival probability\n$$\nu(t,x)=\\mathbb{P}_{x}(t\\tau),\n$$\nthat is, the probability that the Brownian particle has not been absorbed at either boundary by time $t$.\n\nStarting from first principles appropriate to stochastic differential equations—namely, the infinitesimal generator of Brownian motion and the Dirichlet boundary killing—derive the partial differential equation and boundary/initial conditions satisfied by $u(t,x)$, and then solve it by an eigenfunction expansion of the Dirichlet Laplacian on $(0,a)$. Your derivation should begin from the definition of the killed semigroup and the generator characterization. Express your final result as a closed-form analytic series in terms of $a$, $x$, and $t$.\n\nProvide your final answer as a single analytic expression. No numerical approximation is required or allowed. Do not include any units. The answer must be a single expression and not an inequality or an equation.", "solution": "The user wants to find the survival probability $u(t,x)=\\mathbb{P}_{x}(t\\tau)$ for a one-dimensional standard Brownian motion $\\{B_t\\}_{t \\geq 0}$ starting at $x \\in (0,a)$ and killed upon hitting the boundary of the interval $(0,a)$. The stopping time $\\tau$ is the first time the process hits either $0$ or $a$.\n\n### Step 1: Derivation of the Partial Differential Equation and Conditions\n\nThe survival probability is $u(t,x) = \\mathbb{P}_{x}(\\tau  t)$. This is the probability that the particle, starting at position $x$, has not left the interval $(0,a)$ by time $t$.\n\nThe evolution of such probabilities related to Brownian motion is governed by the Kolmogorov equations. Specifically, for a function $f(y)$, the quantity $v(t,x) = \\mathbb{E}_x[f(B_t^{\\tau})]$, where $B_t^{\\tau}$ is the stopped process, satisfies the backward Kolmogorov equation. In our problem, we are interested in $\\mathbb{P}_x(\\tau  t)$, which can be expressed as $\\mathbb{E}_x[I_{\\{\\tau  t\\}}]$, where $I$ is the indicator function.\n\nLet $P_t^D$ be the semigroup of the Brownian motion killed at the boundary of the domain $D=(0,a)$. It is defined for a suitable function $f$ as $P_t^D f(x) = \\mathbb{E}_x[f(B_t) I_{\\{\\tau  t\\}}]$. The survival probability corresponds to choosing $f(y)=1$ for all $y \\in D$. Thus, $u(t,x) = P_t^D 1(x)$.\n\nThe semigroup evolves according to the equation $\\frac{d}{dt} P_t^D f = P_t^D \\mathcal{L} f = \\mathcal{L} P_t^D f$, where $\\mathcal{L}$ is the infinitesimal generator of the process. For a standard one-dimensional Brownian motion, the generator is $\\mathcal{L} = \\frac{1}{2} \\frac{d^2}{dx^2}$. The domain of the generator for the killed process consists of functions that vanish at the boundary, which imposes Dirichlet boundary conditions.\n\nTherefore, the function $u(t,x)$ must satisfy the partial differential equation:\n$$\n\\frac{\\partial u}{\\partial t} = \\mathcal{L}u = \\frac{1}{2} \\frac{\\partial^2 u}{\\partial x^2}, \\quad \\text{for } x \\in (0,a) \\text{ and } t  0.\n$$\n\nWe now establish the boundary and initial conditions.\n\n**Boundary Conditions:**\nFor the process to be killed at the boundary, the survival probability must be zero if the process starts at the boundary. If the starting position $x$ approaches either $0$ or $a$, the hitting time $\\tau$ approaches $0$. The probability of surviving for any positive time $t  0$ must then be zero. This gives the Dirichlet boundary conditions:\n$$\nu(t,0) = 0 \\quad \\text{and} \\quad u(t,a) = 0, \\quad \\text{for } t  0.\n$$\n\n**Initial Condition:**\nAt time $t=0$, the process starts at $x \\in (0,a)$. Since it has not had any time to move, it has not hit the boundary. Therefore, the survival time $\\tau$ is guaranteed to be greater than $0$. The survival probability at $t=0$ is thus $1$:\n$$\nu(0,x) = 1, \\quad \\text{for } x \\in (0,a).\n$$\n\n### Step 2: Solving the PDE via Eigenfunction Expansion\n\nWe solve the initial-boundary value problem using the method of separation of variables. We look for solutions of the form $u(t,x) = T(t)X(x)$. Substituting this into the PDE gives:\n$$\nT'(t)X(x) = \\frac{1}{2}T(t)X''(x)\n$$\nSeparating variables, we get:\n$$\n\\frac{2T'(t)}{T(t)} = \\frac{X''(x)}{X(x)} = -\\lambda\n$$\nwhere $\\lambda$ is a separation constant. This results in two ordinary differential equations:\n1. Temporal equation: $T'(t) + \\frac{\\lambda}{2}T(t) = 0$\n2. Spatial equation: $X''(x) + \\lambda X(x) = 0$, with boundary conditions $X(0)=0$ and $X(a)=0$.\n\nThe spatial problem is a Sturm-Liouville eigenvalue problem for the one-dimensional Dirichlet Laplacian. We seek non-trivial solutions for $X(x)$.\n- If $\\lambda \\le 0$, the only solution satisfying the boundary conditions is the trivial solution $X(x)=0$.\n- If $\\lambda  0$, we set $\\lambda = k^2$ for some $k0$. The general solution is $X(x) = C_1 \\cos(kx) + C_2 \\sin(kx)$. The condition $X(0)=0$ implies $C_1=0$. The condition $X(a)=0$ implies $C_2 \\sin(ka)=0$. For a non-trivial solution, we need $\\sin(ka)=0$, which holds if $ka = n\\pi$ for $n \\in \\{1, 2, 3, \\dots\\}$.\n\nThe eigenvalues are $\\lambda_n = k_n^2 = \\left(\\frac{n\\pi}{a}\\right)^2$, and the corresponding eigenfunctions are $X_n(x) = \\sin\\left(\\frac{n\\pi x}{a}\\right)$ for $n=1, 2, 3, \\ldots$.\n\nFor each eigenvalue $\\lambda_n$, the temporal equation is $T_n'(t) = -\\frac{\\lambda_n}{2} T_n(t)$, which has the solution $T_n(t) = C_n \\exp\\left(-\\frac{\\lambda_n t}{2}\\right) = C_n \\exp\\left(-\\frac{n^2\\pi^2 t}{2a^2}\\right)$.\n\nThe general solution for $u(t,x)$ is a superposition of these product solutions:\n$$\nu(t,x) = \\sum_{n=1}^{\\infty} C_n X_n(x) T_n(t) = \\sum_{n=1}^{\\infty} C_n \\exp\\left(-\\frac{n^2\\pi^2 t}{2a^2}\\right) \\sin\\left(\\frac{n\\pi x}{a}\\right).\n$$\n\nTo determine the coefficients $C_n$, we apply the initial condition $u(0,x) = 1$:\n$$\n1 = u(0,x) = \\sum_{n=1}^{\\infty} C_n \\sin\\left(\\frac{n\\pi x}{a}\\right).\n$$\nThis is the Fourier sine series expansion of the constant function $f(x)=1$ on the interval $(0,a)$. The coefficients $C_n$ are given by:\n$$\nC_n = \\frac{2}{a} \\int_0^a 1 \\cdot \\sin\\left(\\frac{n\\pi x}{a}\\right) dx.\n$$\nWe evaluate the integral:\n$$\n\\int_0^a \\sin\\left(\\frac{n\\pi x}{a}\\right) dx = \\left[-\\frac{a}{n\\pi}\\cos\\left(\\frac{n\\pi x}{a}\\right)\\right]_0^a = -\\frac{a}{n\\pi}\\left(\\cos(n\\pi) - \\cos(0)\\right) = -\\frac{a}{n\\pi}((-1)^n-1).\n$$\nSubstituting this back into the formula for $C_n$:\n$$\nC_n = \\frac{2}{a} \\left(-\\frac{a}{n\\pi}((-1)^n-1)\\right) = -\\frac{2}{n\\pi}((-1)^n-1).\n$$\nThe value of $C_n$ depends on the parity of $n$:\n- If $n$ is even, $n=2k$, then $(-1)^{2k}-1 = 1-1=0$, so $C_{2k}=0$.\n- If $n$ is odd, $n=2k-1$ (for $k \\ge 1$), then $(-1)^{2k-1}-1 = -1-1=-2$. Thus, $C_{2k-1} = -\\frac{2}{(2k-1)\\pi}(-2) = \\frac{4}{(2k-1)\\pi}$.\n\nThe series solution contains only terms with odd $n$. We can re-index the sum by letting $n=2k+1$ for $k=0, 1, 2, \\ldots$.\n$$\nC_{2k+1} = \\frac{4}{(2k+1)\\pi}.\n$$\nSubstituting these coefficients into the general solution gives the final expression for the survival probability:\n$$\nu(t,x) = \\sum_{k=0}^{\\infty} \\frac{4}{(2k+1)\\pi} \\exp\\left(-\\frac{(2k+1)^2 \\pi^2 t}{2a^2}\\right) \\sin\\left(\\frac{(2k+1)\\pi x}{a}\\right).\n$$\nThis can be written as:\n$$\nu(t,x) = \\frac{4}{\\pi} \\sum_{k=0}^{\\infty} \\frac{1}{2k+1} \\exp\\left(-\\frac{(2k+1)^2 \\pi^2 t}{2a^2}\\right) \\sin\\left(\\frac{(2k+1)\\pi x}{a}\\right).\n$$\nThis is the required closed-form analytic series.", "answer": "$$\\boxed{\\frac{4}{\\pi} \\sum_{k=0}^{\\infty} \\frac{1}{2k+1} \\exp\\left(-\\frac{(2k+1)^2 \\pi^2 t}{2a^2}\\right) \\sin\\left(\\frac{(2k+1)\\pi x}{a}\\right)}$$", "id": "2968272"}]}