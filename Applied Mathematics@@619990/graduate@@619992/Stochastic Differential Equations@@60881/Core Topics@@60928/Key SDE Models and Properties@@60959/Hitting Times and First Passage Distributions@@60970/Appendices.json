{"hands_on_practices": [{"introduction": "Understanding first passage times is crucial in many applications, from finance to biology. This first practice introduces a cornerstone technique for analyzing these problems: formulating and solving a boundary value problem involving the process's infinitesimal generator. We will apply this powerful method to a Geometric Brownian Motion—a fundamental process in financial modeling—to derive the Laplace transform of the time it takes for an asset price to reach a predefined barrier [@problem_id:2978871]. This exercise is essential for mastering the connection between stochastic processes and differential equations.", "problem": "Consider a strictly positive asset price process $\\{S_t\\}_{t \\geq 0}$ evolving as a Geometric Brownian Motion with stochastic differential equation $dS_t = \\mu S_t \\, dt + \\sigma S_t \\, dW_t$, where $\\mu \\in \\mathbb{R}$, $\\sigma > 0$, and $\\{W_t\\}_{t \\geq 0}$ is a standard Brownian motion (Wiener process). Fix an upper barrier level $H > 0$ and an initial level $S_0 \\in (0,H)$. Define the first hitting time of the barrier by $\\tau_H = \\inf\\{ t \\geq 0 : S_t = H \\}$, with the convention that $\\inf \\emptyset = +\\infty$. For a given Laplace parameter $\\lambda \\geq 0$, define $L(\\lambda) = \\mathbb{E}\\!\\left[ \\exp(-\\lambda \\tau_H) \\right]$, where the expectation is with respect to the law of $\\{S_t\\}_{t \\geq 0}$ started at $S_0$.\n\nStarting from first principles for diffusions, including Itô’s lemma, the infinitesimal generator for a diffusion process, and boundary value problems for Laplace transforms of hitting times, derive a closed-form expression for $L(\\lambda)$ in terms of $S_0$, $H$, $\\mu$, $\\sigma$, and $\\lambda$. Your derivation must explicitly identify the appropriate boundary conditions and justify them based on the classification of the boundary at $S=0$ under the logarithmic transformation. Provide your final answer as a single analytic expression. No numerical approximation is required, and no rounding instructions apply. The final answer must be a single expression without units.", "solution": "The problem asks for the Laplace transform of the first hitting time of a Geometric Brownian Motion (GBM) to an upper barrier $H$. Let the asset price process be $\\{S_t\\}_{t \\geq 0}$, starting at $S_0 \\in (0, H)$, governed by the stochastic differential equation (SDE):\n$$ dS_t = \\mu S_t \\, dt + \\sigma S_t \\, dW_t $$\nwhere $\\mu \\in \\mathbb{R}$, $\\sigma > 0$, and $\\{W_t\\}_{t \\geq 0}$ is a standard Wiener process. The first hitting time to the barrier $H$ is $\\tau_H = \\inf\\{ t \\geq 0 : S_t = H \\}$. We seek to find the function $L(\\lambda) = \\mathbb{E}[\\exp(-\\lambda \\tau_H)]$ for a Laplace parameter $\\lambda \\geq 0$.\n\nLet us define a function $u(s)$ representing the desired expectation, conditional on the process starting at $S_0 = s$:\n$$ u(s) = \\mathbb{E}_s[\\exp(-\\lambda \\tau_H)] $$\nwhere $\\mathbb{E}_s[\\cdot] = \\mathbb{E}[\\cdot | S_0=s]$. Our goal is to determine $u(S_0)$.\n\nIt is a standard result in the theory of diffusion processes that the function $u(s)$ satisfies a second-order ordinary differential equation (ODE). For a general one-dimensional Itô diffusion $dX_t = a(X_t) dt + b(X_t) dW_t$, the function $u(x) = \\mathbb{E}_x[\\exp(-\\lambda \\tau_b)]$ for hitting a boundary $b$ satisfies the equation $(\\mathcal{A} - \\lambda)u(x) = 0$ on the domain of interest, where $\\mathcal{A}$ is the infinitesimal generator of the process.\n\nThe infinitesimal generator $\\mathcal{A}$ acting on a twice-differentiable function $f(x)$ is given by:\n$$ \\mathcal{A}f(x) = a(x)f'(x) + \\frac{1}{2}b(x)^2 f''(x) $$\nFor the GBM process $S_t$, the drift and diffusion coefficients are $a(s) = \\mu s$ and $b(s) = \\sigma s$, respectively. The generator $\\mathcal{A}$ is therefore:\n$$ \\mathcal{A}f(s) = \\mu s f'(s) + \\frac{1}{2}(\\sigma s)^2 f''(s) = \\mu s f'(s) + \\frac{1}{2}\\sigma^2 s^2 f''(s) $$\nThe function $u(s)$ must solve the ODE $(\\mathcal{A} - \\lambda)u(s) = 0$ for $s \\in (0, H)$. Substituting the generator, we obtain:\n$$ \\frac{1}{2}\\sigma^2 s^2 u''(s) + \\mu s u'(s) - \\lambda u(s) = 0 $$\nThis is a second-order linear homogeneous ODE of the Euler-Cauchy type. We seek a solution of the form $u(s) = s^k$. Substituting this into the ODE yields the characteristic equation for the exponent $k$:\n$$ \\frac{1}{2}\\sigma^2 k(k-1)s^k + \\mu k s^k - \\lambda s^k = 0 $$\n$$ s^k \\left( \\frac{1}{2}\\sigma^2 k^2 - \\frac{1}{2}\\sigma^2 k + \\mu k - \\lambda \\right) = 0 $$\nFor this to hold for all $s \\in (0,H)$, the polynomial in $k$ must be zero:\n$$ \\frac{1}{2}\\sigma^2 k^2 + \\left(\\mu - \\frac{1}{2}\\sigma^2\\right) k - \\lambda = 0 $$\nThis is a quadratic equation for $k$. The roots are given by the quadratic formula:\n$$ k = \\frac{-\\left(\\mu - \\frac{1}{2}\\sigma^2\\right) \\pm \\sqrt{\\left(\\mu - \\frac{1}{2}\\sigma^2\\right)^2 - 4\\left(\\frac{1}{2}\\sigma^2\\right)(-\\lambda)}}{2\\left(\\frac{1}{2}\\sigma^2\\right)} $$\n$$ k = \\frac{-\\left(\\mu - \\frac{1}{2}\\sigma^2\\right) \\pm \\sqrt{\\left(\\mu - \\frac{1}{2}\\sigma^2\\right)^2 + 2\\lambda\\sigma^2}}{\\sigma^2} $$\nLet us denote the two roots by $k_+$ and $k_-$:\n$$ k_+ = \\frac{-\\left(\\mu - \\frac{1}{2}\\sigma^2\\right) + \\sqrt{\\left(\\mu - \\frac{1}{2}\\sigma^2\\right)^2 + 2\\lambda\\sigma^2}}{\\sigma^2} $$\n$$ k_- = \\frac{-\\left(\\mu - \\frac{1}{2}\\sigma^2\\right) - \\sqrt{\\left(\\mu - \\frac{1}{2}\\sigma^2\\right)^2 + 2\\lambda\\sigma^2}}{\\sigma^2} $$\nFor $\\lambda > 0$, the discriminant is strictly positive, so the roots are real and distinct. Furthermore, since $\\sqrt{\\left(\\mu - \\frac{1}{2}\\sigma^2\\right)^2 + 2\\lambda\\sigma^2} > \\left|\\mu - \\frac{1}{2}\\sigma^2\\right|$, it is clear that $k_+ > 0$ and $k_- < 0$. The general solution to the ODE is a linear combination of the two fundamental solutions:\n$$ u(s) = C_1 s^{k_+} + C_2 s^{k_-} $$\nTo determine the constants $C_1$ and $C_2$, we must specify two boundary conditions.\n\nThe first boundary condition is at the target level $s=H$. If the process starts at $S_0=H$, the hitting time is $\\tau_H=0$. Therefore, $u(H) = \\mathbb{E}_H[\\exp(-\\lambda \\cdot 0)] = \\exp(0) = 1$.\n$$ C_1 H^{k_+} + C_2 H^{k_-} = 1 $$\n\nThe second boundary condition comes from the behavior of the process near $s=0$. The problem statement requires us to justify this condition by classifying the boundary at $s=0$. To do this, we can analyze the transformed process $X_t = \\ln(S_t)$. Using Itô's lemma for $f(s) = \\ln(s)$, we find the SDE for $X_t$:\n$$ dX_t = \\left(\\mu - \\frac{1}{2}\\sigma^2\\right)dt + \\sigma dW_t $$\nThis is an arithmetic Brownian motion with constant drift $\\nu = \\mu - \\frac{1}{2}\\sigma^2$ and constant volatility $\\sigma$. The boundary $s=0$ for $S_t$ corresponds to the boundary $x \\to -\\infty$ for $X_t$. A standard classification of boundaries for one-dimensional diffusions shows that the boundary at $s=0$ is inaccessible from the interior of the state space $(0, \\infty)$ in finite time. This means that for any starting point $s > 0$, the probability of the process reaching $s=0$ in finite time is zero. This boundary is classified as either 'exit' (if $\\nu > 0$) or 'natural' (if $\\nu \\le 0$). In either case, it is not an absorbing or reflecting boundary where a specific condition (like $u(0)=0$ or $u'(0)=0$) would be imposed.\n\nInstead, the solution $u(s)$ is constrained by a general regularity condition: as $u(s)$ represents an expectation of $\\exp(-\\lambda \\tau_H)$, which is a random variable bounded between $0$ and $1$, the function $u(s)$ must be bounded for all $s \\in (0, H]$. That is, we require $\\lim_{s \\to 0^+} |u(s)| < \\infty$.\nLet's examine the behavior of the general solution $u(s) = C_1 s^{k_+} + C_2 s^{k_-}$ as $s \\to 0^+$.\nSince $k_+ > 0$, the term $s^{k_+}$ approaches $0$.\nSince $k_- < 0$, the term $s^{k_-}$ approaches $+\\infty$.\nIn order for $u(s)$ to remain bounded as $s \\to 0^+$, the coefficient of the unbounded term must be zero. This forces the condition $C_2 = 0$.\n\nWith $C_2=0$, the solution simplifies to:\n$$ u(s) = C_1 s^{k_+} $$\nNow we apply the first boundary condition, $u(H)=1$:\n$$ C_1 H^{k_+} = 1 \\implies C_1 = H^{-k_+} $$\nSubstituting the value of $C_1$ back, we find the unique bounded solution:\n$$ u(s) = (H^{-k_+}) s^{k_+} = \\left(\\frac{s}{H}\\right)^{k_+} $$\nFinally, we evaluate this function at the initial state $S_0$:\n$$ L(\\lambda) = u(S_0) = \\left(\\frac{S_0}{H}\\right)^{k_+} $$\nSubstituting the full expression for $k_+$, we obtain the closed-form solution:\n$$ L(\\lambda) = \\left(\\frac{S_0}{H}\\right)^{\\frac{-\\left(\\mu - \\frac{1}{2}\\sigma^2\\right) + \\sqrt{\\left(\\mu - \\frac{1}{2}\\sigma^2\\right)^2 + 2\\lambda\\sigma^2}}{\\sigma^2}} $$\nThis expression is the Laplace transform of the first hitting time $\\tau_H$ for the given parameters.", "answer": "$$\\boxed{\\left(\\frac{S_0}{H}\\right)^{\\frac{-\\left(\\mu - \\frac{1}{2}\\sigma^2\\right) + \\sqrt{\\left(\\mu - \\frac{1}{2}\\sigma^2\\right)^2 + 2\\lambda\\sigma^2}}{\\sigma^2}}}$$", "id": "2978871"}, {"introduction": "While many introductory problems focus on static boundaries, real-world systems often involve dynamic thresholds. This practice tackles the more complex and realistic scenario of a process hitting a moving linear boundary [@problem_id:2978878]. You will learn a powerful strategy that simplifies the problem: transforming the state space to convert the moving boundary into a fixed one. We will then employ an elegant martingale-based method, using an exponential martingale and the Optional Stopping Theorem, to find the solution. This exercise showcases a versatile alternative to the generator-based PDE approach and highlights the power of clever problem transformations.", "problem": "Consider the one-dimensional Itô process defined by the stochastic differential equation (SDE)\n$$\ndX_t \\;=\\; \\mu\\,dt \\;+\\; \\sigma\\,dW_t,\\qquad X_0 \\;=\\; 0,\n$$\nwhere $W_t$ is a standard Brownian motion, and $\\mu\\in\\mathbb{R}$, $\\sigma>0$ are constants. Let the moving boundary be the linear function\n$$\nb(t)\\;=\\; a \\;+\\; c\\,t,\n$$\nwith parameters $a>0$ and $c\\in\\mathbb{R}$. Define the first passage time\n$$\n\\tau \\;=\\; \\inf\\{\\, t\\ge 0 \\,:\\, X_t \\;=\\; b(t)\\,\\}.\n$$\nFor a fixed parameter $\\lambda\\ge 0$, derive from first principles an explicit, fully simplified analytic expression for the Laplace transform of the defective first passage time,\n$$\n\\Phi(\\lambda) \\;=\\; \\mathbb{E}\\!\\left[\\,\\exp(-\\lambda\\,\\tau)\\,\\mathbf{1}_{\\{\\tau<\\infty\\}}\\,\\right],\n$$\nexpressed solely in terms of the parameters $a$, $c$, $\\mu$, $\\sigma$, and $\\lambda$. Your final answer must be a single closed-form expression. No numerical rounding is required.", "solution": "The problem asks for the Laplace transform of the first passage time of a drifted Brownian motion to a moving linear boundary. Let the stochastic process be defined by the Itô stochastic differential equation (SDE):\n$$\ndX_t = \\mu\\,dt + \\sigma\\,dW_t, \\quad X_0 = 0\n$$\nwhere $\\mu \\in \\mathbb{R}$, $\\sigma > 0$ are constants and $W_t$ is a standard Wiener process. The moving boundary is given by $b(t) = a + ct$, with $a > 0$ and $c \\in \\mathbb{R}$. The first passage time $\\tau$ is defined as:\n$$\n\\tau = \\inf\\{ t \\ge 0 : X_t = b(t) \\}\n$$\nWe seek to find $\\Phi(\\lambda) = \\mathbb{E}[\\exp(-\\lambda\\,\\tau)\\,\\mathbf{1}_{\\{\\tau<\\infty\\}}]$ for $\\lambda \\ge 0$.\n\nThe problem of a process hitting a moving boundary can be simplified by transforming it into a problem of a related process hitting a constant boundary. Let us define a new process $Y_t$ as the difference between the original process $X_t$ and the boundary $b(t)$:\n$$\nY_t = X_t - b(t) = X_t - (a + ct)\n$$\nThe initial condition for this new process is $Y_0 = X_0 - b(0) = 0 - a = -a$.\nThe first passage event $X_t = b(t)$ is equivalent to $Y_t = 0$. Thus, the first passage time can be redefined in terms of $Y_t$:\n$$\n\\tau = \\inf\\{ t \\ge 0 : Y_t = 0 \\}\n$$\nWe derive the SDE for $Y_t$ using Itô's lemma. Since $b(t)$ is a deterministic function of time with a continuous first derivative, we can write its differential as $db(t) = c\\,dt$. Therefore, the differential for $Y_t$ is:\n$$\ndY_t = dX_t - d(a+ct) = (\\mu\\,dt + \\sigma\\,dW_t) - c\\,dt = (\\mu-c)\\,dt + \\sigma\\,dW_t\n$$\nThis shows that $Y_t$ is also a Brownian motion with a constant drift $\\mu' = \\mu-c$ and the same diffusion coefficient $\\sigma$. The problem is now reduced to finding the Laplace transform of the first time the process $Y_t$, starting at $Y_0 = -a < 0$, hits the level $0$.\n\nWe will solve this using a martingale approach. Let's construct a process $M_t$ of the form $M_t = \\exp(\\theta Y_t - f(t))$ for some constant $\\theta$ and a deterministic function $f(t)$ to be determined. For $M_t$ to be a martingale, its drift term must be zero. Let $g(y,t) = \\exp(\\theta y - f(t))$. We apply Itô's lemma to $g(Y_t, t)$:\n$$\ndg(Y_t, t) = \\frac{\\partial g}{\\partial t}dt + \\frac{\\partial g}{\\partial y}dY_t + \\frac{1}{2}\\frac{\\partial^2 g}{\\partial y^2}(dY_t)^2\n$$\nThe partial derivatives are:\n$$\n\\frac{\\partial g}{\\partial t} = -f'(t)g(y,t), \\quad \\frac{\\partial g}{\\partial y} = \\theta g(y,t), \\quad \\frac{\\partial^2 g}{\\partial y^2} = \\theta^2 g(y,t)\n$$\nThe quadratic variation of $Y_t$ is $(dY_t)^2 = ((\\mu-c)dt + \\sigma dW_t)^2 = \\sigma^2 dt$. Substituting these into the Itô formula, we get:\n$$\ndM_t = \\left(-f'(t) + (\\mu-c)\\theta + \\frac{1}{2}\\sigma^2\\theta^2\\right)M_t\\,dt + \\theta\\sigma M_t\\,dW_t\n$$\nFor $M_t$ to be a martingale, the drift term (the $dt$ term) must be zero.\n$$\n-f'(t) + (\\mu-c)\\theta + \\frac{1}{2}\\sigma^2\\theta^2 = 0 \\implies f'(t) = (\\mu-c)\\theta + \\frac{1}{2}\\sigma^2\\theta^2\n$$\nWe want to find the Laplace transform, which involves $\\exp(-\\lambda \\tau)$. This suggests choosing $f(t)$ such that we obtain this term. Let's set $f(t) = \\lambda t$. Then $f'(t) = \\lambda$. This imposes a condition on the parameter $\\theta$:\n$$\n\\lambda = (\\mu-c)\\theta + \\frac{1}{2}\\sigma^2\\theta^2\n$$\nThis is a quadratic equation for $\\theta$:\n$$\n\\frac{1}{2}\\sigma^2\\theta^2 + (\\mu-c)\\theta - \\lambda = 0\n$$\nSolving for $\\theta$ using the quadratic formula:\n$$\n\\theta = \\frac{-(\\mu-c) \\pm \\sqrt{(\\mu-c)^2 - 4(\\frac{1}{2}\\sigma^2)(-\\lambda)}}{\\sigma^2} = \\frac{-(\\mu-c) \\pm \\sqrt{(\\mu-c)^2 + 2\\sigma^2\\lambda}}{\\sigma^2}\n$$\nLet's denote the two roots as $\\theta_1$ and $\\theta_2$.\nSince $\\lambda \\ge 0$ and $\\sigma > 0$, we have $\\sqrt{(\\mu-c)^2 + 2\\sigma^2\\lambda} \\ge \\sqrt{(\\mu-c)^2} = |\\mu-c|$.\nThis implies that one root is positive and one is negative (or one is zero if $\\lambda=0$ and $\\mu-c \\ge 0$). Let us choose the positive root, which we denote by $\\theta_+$:\n$$\n\\theta_+ = \\frac{-(\\mu-c) + \\sqrt{(\\mu-c)^2 + 2\\sigma^2\\lambda}}{\\sigma^2} \\ge 0\n$$\nWith this choice of $\\theta = \\theta_+$, the process $M_t = \\exp(\\theta_+ Y_t - \\lambda t)$ is a martingale.\n\nWe can now apply the Optional Stopping Theorem (OST). The theorem states that for a stopping time $\\tau$ and a martingale $M_t$, under certain conditions, $\\mathbb{E}[M_{\\tau}] = M_0$. A sufficient condition for our purpose is that the stopped process $M_{t \\wedge \\tau}$ is bounded.\nIn our case, for any $t < \\tau$, the process $Y_t$ is below the boundary $0$, so $Y_t < 0$. Since we chose $\\theta_+ \\ge 0$, the term $\\theta_+ Y_t \\le 0$. Also, since $\\lambda \\ge 0$, the term $-\\lambda t \\le 0$.\nThe value of our stopped martingale is $M_{t \\wedge \\tau} = \\exp(\\theta_+ Y_{t \\wedge \\tau} - \\lambda(t \\wedge \\tau))$.\nSince $Y_{t \\wedge \\tau} \\le 0$ and $\\lambda(t \\wedge \\tau) \\ge 0$, we have $\\exp(\\theta_+ Y_{t \\wedge \\tau}) \\le 1$ and $\\exp(-\\lambda(t \\wedge \\tau)) \\le 1$. Therefore, $0 < M_{t \\wedge \\tau} \\le 1$. The stopped martingale is bounded.\nBy the Dominated Convergence Theorem (as a consequence of the boundedness), we can apply OST to get:\n$$\n\\mathbb{E}[M_\\tau] = M_0\n$$\nThe initial value is $M_0 = \\exp(\\theta_+ Y_0 - \\lambda \\cdot 0) = \\exp(\\theta_+ (-a)) = \\exp(-a\\theta_+)$.\nThe value at the stopping time $\\tau$ needs to be considered on the sets $\\{\\tau < \\infty\\}$ and $\\{\\tau = \\infty\\}$.\nOn the set $\\{\\tau < \\infty\\}$, we have $Y_\\tau = 0$, so $M_\\tau = \\exp(\\theta_+ \\cdot 0 - \\lambda \\tau) = \\exp(-\\lambda \\tau)$.\nOn the set $\\{\\tau = \\infty\\}$, the process $Y_t$ never reaches $0$. In this case, $Y_t < 0$ for all $t$. The limit of the martingale is $M_\\infty = \\lim_{t\\to\\infty} \\exp(\\theta_+ Y_t - \\lambda t)$.\nIf $\\lambda > 0$, the term $\\exp(-\\lambda t) \\to 0$. Since $\\exp(\\theta_+ Y_t) \\le 1$, the limit $M_\\infty = 0$.\nIf $\\lambda = 0$, the situation is more complex. However, the boundedness of $M_{t \\wedge \\tau}$ allows us to use a version of OST that leads to $\\mathbb{E}[M_\\tau \\mathbf{1}_{\\{\\tau < \\infty\\}}] = M_0 - \\mathbb{E}[M_\\infty \\mathbf{1}_{\\{\\tau = \\infty\\}}]$. As $M_\\infty=0$ almost surely on $\\{\\tau=\\infty\\}$ (either because $\\lambda>0$ or because $Y_t \\to -\\infty$ when the drift is non-positive), this term vanishes.\nSo we have:\n$$\n\\mathbb{E}[M_\\tau \\mathbf{1}_{\\{\\tau < \\infty\\}}] = \\mathbb{E}[\\exp(-\\lambda \\tau) \\mathbf{1}_{\\{\\tau < \\infty\\}}] = \\Phi(\\lambda)\n$$\nEquating the expectations:\n$$\n\\Phi(\\lambda) = M_0 = \\exp(-a\\theta_+)\n$$\nSubstituting the expression for $\\theta_+$:\n$$\n\\Phi(\\lambda) = \\exp\\left(-a \\left(\\frac{-(\\mu-c) + \\sqrt{(\\mu-c)^2 + 2\\sigma^2\\lambda}}{\\sigma^2}\\right)\\right)\n$$\nThis can be simplified to:\n$$\n\\Phi(\\lambda) = \\exp\\left(\\frac{a(\\mu-c)}{\\sigma^2} - \\frac{a\\sqrt{(\\mu-c)^2 + 2\\sigma^2\\lambda}}{\\sigma^2}\\right)\n$$\nThis is the desired explicit, fully simplified analytic expression for the Laplace transform of the first passage time.\nThe final expression can be written as:\n$$\n\\Phi(\\lambda) = \\exp\\left( \\frac{a}{\\sigma^2} \\left( \\mu-c - \\sqrt{(\\mu-c)^2 + 2\\sigma^2\\lambda} \\right) \\right)\n$$", "answer": "$$\\boxed{\\exp\\left( \\frac{a}{\\sigma^2} \\left( \\mu-c - \\sqrt{(\\mu-c)^2 + 2\\sigma^2\\lambda} \\right) \\right)}$$", "id": "2978878"}, {"introduction": "The concept of first passage is not confined to one-dimensional processes. This final practice elevates our analysis to a multi-dimensional setting, investigating the time it takes for a standard Brownian motion to first reach the surface of a $d$-dimensional sphere [@problem_id:2978840]. By exploiting the problem's spherical symmetry, you will learn to reduce the governing partial differential equation to a radial ordinary differential equation. Solving this equation introduces modified Bessel functions, a class of special functions that frequently appear in higher-dimensional stochastic problems. This exercise demonstrates the scalability of the generator method and equips you with the tools to tackle problems beyond the number line.", "problem": "Consider a $d$-dimensional standard Brownian motion $B_{t}$ on $\\mathbb{R}^{d}$, with $d \\geq 2$, started at a point $x \\in \\mathbb{R}^{d}$ such that $|x| = r$ with $0 < r < R$. Let $\\tau_{R} = \\inf\\{ t \\geq 0 : |B_{t}| = R \\}$ denote the first hitting time of the sphere of radius $R$ centered at the origin. For a fixed $\\lambda > 0$, define the Laplace transform of the hitting time by\n$$\n\\phi_{\\lambda}(x) = \\mathbb{E}_{x}\\big[\\exp(-\\lambda \\tau_{R})\\big].\n$$\nUsing only foundational principles appropriate for stochastic differential equations—namely the Markov property of Brownian motion, the generator characterization that the infinitesimal generator of $B_{t}$ is $(1/2)\\Delta$, and the Feynman–Kac representation or Dynkin’s formula—derive an explicit closed-form expression for $\\phi_{\\lambda}(x)$ in terms of $r$, $R$, $d$, and $\\lambda$. Your derivation must begin from these principles, establish the appropriate boundary value problem, reduce it via spherical symmetry to a radial ordinary differential equation, and solve it exactly using standard special functions. Express your final answer as a single analytic expression. No numerical approximation is required.", "solution": "Let $B_t$ be a $d$-dimensional standard Brownian motion starting at $B_0 = x$, where $|x| = r$ and $0 < r < R$. We are asked to find the function $\\phi_{\\lambda}(x) = \\mathbb{E}_{x}[\\exp(-\\lambda \\tau_{R})]$, where $\\tau_{R} = \\inf\\{ t \\geq 0 : |B_{t}| = R \\}$ is the first time the process hits the sphere of radius $R > 0$ centered at the origin, and $\\lambda > 0$ is a constant.\n\nThe derivation is based on the Feynman–Kac representation. For a stochastic process governed by an infinitesimal generator $\\mathcal{A}$, the function $u(x) = \\mathbb{E}_{x}[\\exp(-\\lambda \\tau_D) g(B_{\\tau_D})]$, where $\\tau_D$ is the first exit time from a domain $D$, satisfies the partial differential equation (PDE)\n$$\n(\\mathcal{A} - \\lambda)u(x) = 0 \\quad \\text{for } x \\in D\n$$\nwith the boundary condition $u(x) = g(x)$ for $x \\in \\partial D$.\n\nIn this problem, the process is a standard Brownian motion $B_t$, for which the infinitesimal generator is $\\mathcal{A} = \\frac{1}{2}\\Delta$, where $\\Delta$ is the Laplacian operator. The domain is the open ball $D = \\{y \\in \\mathbb{R}^d : |y| < R\\}$. The exit time $\\tau_D$ is precisely our hitting time $\\tau_R$. We are calculating an expectation of the form $\\mathbb{E}_{x}[\\exp(-\\lambda \\tau_R)]$, which corresponds to setting the boundary function $g(y) = 1$ for all $y$ on the boundary $\\partial D = \\{y \\in \\mathbb{R}^d : |y| = R\\}$.\nTherefore, the function $\\phi_{\\lambda}(x)$ must satisfy the following boundary value problem:\n$$\n\\frac{1}{2}\\Delta\\phi_{\\lambda}(x) - \\lambda\\phi_{\\lambda}(x) = 0, \\quad \\text{for } |x| < R\n$$\n$$\n\\phi_{\\lambda}(x) = 1, \\quad \\text{for } |x| = R\n$$\n\nThe domain, the operator $\\Delta$, and the boundary condition are all spherically symmetric. This implies that the solution $\\phi_{\\lambda}(x)$ must also be spherically symmetric. That is, $\\phi_{\\lambda}(x)$ depends only on the radial distance $s = |x|$. Let us denote this radial function by $f(s)$, so $\\phi_{\\lambda}(x) = f(|x|)$. The Laplacian of a radial function $f(s)$ in $d$ dimensions is given by\n$$\n\\Delta f(s) = f''(s) + \\frac{d-1}{s}f'(s)\n$$\nSubstituting this into our PDE, we obtain an ordinary differential equation (ODE) for $f(s)$ for $s \\in (0, R)$:\n$$\n\\frac{1}{2}\\left(f''(s) + \\frac{d-1}{s}f'(s)\\right) - \\lambda f(s) = 0\n$$\nMultiplying by $2s^2$, we rearrange this into a more standard form:\n$$\ns^2 f''(s) + (d-1)s f'(s) - 2\\lambda s^2 f(s) = 0\n$$\nThis is a form of the modified Bessel's differential equation. Its general solution can be expressed in terms of modified Bessel functions. Let us set the order of the Bessel functions to be $\\nu = \\frac{d}{2} - 1$. Since $d \\geq 2$, we have $\\nu \\geq 0$. The general solution to this ODE is of the form:\n$$\nf(s) = s^{1 - d/2} \\left( C_1 I_{\\nu}(\\sqrt{2\\lambda} s) + C_2 K_{\\nu}(\\sqrt{2\\lambda} s) \\right)\n$$\nwhere $I_{\\nu}$ and $K_{\\nu}$ are the modified Bessel functions of the first and second kind, respectively, of order $\\nu = \\frac{d-2}{2}$, and $C_1, C_2$ are constants to be determined by the boundary conditions.\n\nWe have two boundary conditions. First, the boundary condition at the sphere of radius $R$ is $f(R)=1$. The second condition is implicit: the solution must be regular (bounded) within the entire domain, including at the origin $s=0$. We must analyze the behavior of the solution as $s \\to 0^{+}$.\nThe asymptotic behaviors of the Bessel functions for small argument $z \\to 0$ are:\n- For $\\nu > 0$: $I_\\nu(z) \\sim \\frac{1}{\\Gamma(\\nu+1)}\\left(\\frac{z}{2}\\right)^\\nu$ and $K_\\nu(z) \\sim \\frac{\\Gamma(\\nu)}{2}\\left(\\frac{2}{z}\\right)^\\nu$.\n- For $\\nu = 0$ (i.e., $d=2$): $I_0(z) \\to 1$ and $K_0(z) \\sim -\\ln(z)$.\n\nLet's analyze the two terms in our general solution for $f(s)$ as $s \\to 0^{+}$:\nThe first term behaves as:\n$$\ns^{1-d/2} I_{\\frac{d-2}{2}}(\\sqrt{2\\lambda} s) = s^{-\\nu} I_{\\nu}(\\sqrt{2\\lambda} s) \\sim s^{-\\nu} \\cdot \\frac{1}{\\Gamma(\\nu+1)}\\left(\\frac{\\sqrt{2\\lambda}s}{2}\\right)^\\nu \\propto s^{-\\nu} s^\\nu = s^0\n$$\nThis term approaches a finite constant as $s \\to 0^{+}$.\nThe second term behaves as:\n$$\ns^{1-d/2} K_{\\frac{d-2}{2}}(\\sqrt{2\\lambda} s) = s^{-\\nu} K_{\\nu}(\\sqrt{2\\lambda} s)\n$$\nIf $d>2$ (so $\\nu>0$), this term behaves as $s^{-\\nu} \\cdot \\left(\\frac{1}{s}\\right)^\\nu \\propto s^{-2\\nu} = s^{-(d-2)} = s^{2-d}$. Since $d>2$, the exponent $2-d$ is negative, so this term diverges as $s \\to 0^{+}$.\nIf $d=2$ (so $\\nu=0$), this term is $K_0(\\sqrt{2\\lambda}s)$, which diverges logarithmically as $s \\to 0^{+}$.\nIn all cases for $d \\geq 2$, the term involving $K_{\\nu}$ is singular at the origin. For $\\phi_{\\lambda}(x)$ to be a valid physical quantity (an expectation value, which must be finite), the solution must be bounded everywhere. Therefore, we must set $C_2 = 0$.\n\nThe solution must take the form:\n$$\nf(s) = C_1 s^{1-d/2} I_{\\frac{d-2}{2}}(\\sqrt{2\\lambda} s)\n$$\nNow we apply the explicit boundary condition at $s=R$: $f(R)=1$.\n$$\n1 = C_1 R^{1-d/2} I_{\\frac{d-2}{2}}(\\sqrt{2\\lambda} R)\n$$\nSolving for $C_1$:\n$$\nC_1 = \\frac{R^{d/2-1}}{I_{\\frac{d-2}{2}}(\\sqrt{2\\lambda} R)}\n$$\nSubstituting this back into the expression for $f(s)$, we obtain the complete solution:\n$$\nf(s) = \\frac{R^{d/2-1}}{I_{\\frac{d-2}{2}}(\\sqrt{2\\lambda} R)} s^{1-d/2} I_{\\frac{d-2}{2}}(\\sqrt{2\\lambda} s)\n$$\nThis can be rewritten as:\n$$\nf(s) = \\left(\\frac{s}{R}\\right)^{1-d/2} \\frac{I_{\\frac{d-2}{2}}(\\sqrt{2\\lambda} s)}{I_{\\frac{d-2}{2}}(\\sqrt{2\\lambda} R)}\n$$\nThe problem asks for $\\phi_{\\lambda}(x)$ for a starting point $x$ with $|x|=r$. This corresponds to evaluating our solution $f(s)$ at $s=r$.\n$$\n\\phi_{\\lambda}(x) = f(r) =  \\left(\\frac{r}{R}\\right)^{\\frac{2-d}{2}} \\frac{I_{\\frac{d-2}{2}}(r\\sqrt{2\\lambda})}{I_{\\frac{d-2}{2}}(R\\sqrt{2\\lambda})}\n$$\nThis provides the explicit closed-form expression for the Laplace transform of the hitting time, as required.", "answer": "$$\n\\boxed{\\left(\\frac{r}{R}\\right)^{\\frac{2-d}{2}} \\frac{I_{\\frac{d-2}{2}}(r\\sqrt{2\\lambda})}{I_{\\frac{d-2}{2}}(R\\sqrt{2\\lambda})}}\n$$", "id": "2978840"}]}