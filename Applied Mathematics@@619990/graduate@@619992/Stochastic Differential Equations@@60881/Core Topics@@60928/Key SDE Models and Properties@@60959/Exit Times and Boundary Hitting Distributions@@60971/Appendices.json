{"hands_on_practices": [{"introduction": "Our exploration begins with a cornerstone problem: analyzing the behavior of a one-dimensional Brownian motion with a constant drift. This exercise provides a concrete application of the fundamental link between stochastic differential equations and partial differential equations, showing how probabilistic questions about exit events translate into solvable boundary value problems. By calculating the hitting probability and expected exit time, you will practice using the infinitesimal generator to derive and solve the governing ordinary differential equations, leveraging the powerful concepts of the scale function and speed measure. [@problem_id:2974721]", "problem": "Let $\\{W_t\\}_{t \\ge 0}$ be a standard one-dimensional Brownian motion and let $\\{X_t\\}_{t \\ge 0}$ solve the stochastic differential equation $dX_t = \\mu \\, dt + dW_t$ with constant drift parameter $\\mu \\in \\mathbb{R}$. Fix real numbers $a  x  b$ and define the first hitting times $\\tau_a := \\inf\\{t \\ge 0 : X_t = a\\}$, $\\tau_b := \\inf\\{t \\ge 0 : X_t = b\\}$, and the first exit time from the open interval $(a,b)$ by $\\tau_{(a,b)} := \\inf\\{t \\ge 0 : X_t \\notin (a,b)\\}$. Denote by $\\mathbb{P}_x$ and $\\mathbb{E}_x$ the probability and expectation for the process started at $X_0 = x$.\n\nStarting from the generator of the diffusion and Dynkin's formula, derive the boundary value problems that characterize the boundary hitting probability $h(x) := \\mathbb{P}_x(\\tau_b  \\tau_a)$ and the expected exit time $u(x) := \\mathbb{E}_x[\\tau_{(a,b)}]$, and solve them explicitly subject to the appropriate boundary conditions. In your derivation, use the scale function $s(x) = \\int^{x} \\exp(-2 \\mu y) \\, dy$ and the speed measure $m(dx) = 2 \\exp(2 \\mu x) \\, dx$ associated with this diffusion to connect to the Green’s function representation for one-dimensional diffusions. Express your final answers in closed form as functions of $\\mu$, $a$, $b$, and $x$.\n\nYour final answer must be a single closed-form analytic expression; do not provide inequalities or equations. No rounding is required and no physical units are involved.", "solution": "The problem is valid as it is a standard, well-posed problem in the theory of stochastic differential equations, based on established mathematical principles. All necessary information is provided, and the terminology is precise and unambiguous.\n\nLet $\\{X_t\\}_{t \\ge 0}$ be the stochastic process defined by the SDE $dX_t = \\mu \\, dt + dW_t$ with $X_0 = x$, where $a  x  b$. This is a one-dimensional diffusion process with constant drift $\\mu(x) = \\mu$ and constant diffusion coefficient $\\sigma(x)=1$.\n\nThe infinitesimal generator $\\mathcal{L}$ of this diffusion process, applied to a twice-differentiable function $f(x)$, is given by:\n$$\n\\mathcal{L}f(x) = \\mu(x) \\frac{df}{dx} + \\frac{1}{2}\\sigma(x)^2 \\frac{d^2f}{dx^2} = \\mu f'(x) + \\frac{1}{2}f''(x)\n$$\nThe problem asks to connect the solution to the scale function $s(x)$ and speed measure $m(dx)$. The scale function $s(x)$ is defined by the property $\\mathcal{L}s(x)=0$. For this process, a choice for the derivative of the scale function is $s'(x) = \\exp\\left(-\\int \\frac{2\\mu}{\\sigma^2} dy\\right) = \\exp(-2\\mu x)$, which matches the problem statement up to a multiplicative constant. The speed measure density is given by $m(x) = \\frac{2}{\\sigma(x)^2 s'(x)} = \\frac{2}{1^2 \\cdot \\exp(-2\\mu x)} = 2\\exp(2\\mu x)$, which also matches the problem statement. In terms of $s(x)$ and $m(x)$, the generator can be written as:\n$$\n\\mathcal{L}f(x) = \\frac{1}{m(x)}\\frac{d}{dx}\\left(\\frac{f'(x)}{s'(x)}\\right)\n$$\nWe will use this form to derive the solutions.\n\n**1. Derivation of the Hitting Probability $h(x) = \\mathbb{P}_x(\\tau_b  \\tau_a)$**\n\nThe hitting probability $h(x)$ is the solution to the boundary value problem (BVP) defined by $\\mathcal{L}h(x) = 0$ for $x \\in (a,b)$, with boundary conditions $h(a)=0$ and $h(b)=1$. The boundary conditions arise because if the process starts at $x=a$, it has already hit $a$, so the probability of hitting $b$ first is $0$. If it starts at $x=b$, it has already hit $b$, so the probability of hitting $b$ first is $1$.\n\nUsing the generator in terms of the scale function, the ODE is:\n$$\n\\frac{1}{m(x)}\\frac{d}{dx}\\left(\\frac{h'(x)}{s'(x)}\\right) = 0 \\implies \\frac{d}{dx}\\left(\\frac{h'(x)}{s'(x)}\\right) = 0\n$$\nIntegrating once with respect to $x$ gives:\n$$\n\\frac{h'(x)}{s'(x)} = C_1 \\implies h'(x) = C_1 s'(x)\n$$\nwhere $C_1$ is a constant of integration. Integrating a second time gives:\n$$\nh(x) = C_1 s(x) + C_2\n$$\nWe apply the boundary conditions to find $C_1$ and $C_2$:\n1. $h(a) = C_1 s(a) + C_2 = 0$\n2. $h(b) = C_1 s(b) + C_2 = 1$\n\nSubtracting the first equation from the second gives $C_1(s(b)-s(a)) = 1$, so $C_1 = \\frac{1}{s(b)-s(a)}$.\nFrom the first equation, $C_2 = -C_1 s(a) = -\\frac{s(a)}{s(b)-s(a)}$.\nSubstituting the constants back into the solution for $h(x)$:\n$$\nh(x) = \\frac{s(x)}{s(b)-s(a)} - \\frac{s(a)}{s(b)-s(a)} = \\frac{s(x)-s(a)}{s(b)-s(a)}\n$$\nNow, we find an explicit form for $s(x)$ from its derivative $s'(x) = \\exp(-2\\mu x)$:\n- If $\\mu \\neq 0$, $s(x) = \\int \\exp(-2\\mu x) dx = -\\frac{1}{2\\mu}\\exp(-2\\mu x)$. We can ignore the constant of integration as it cancels in the formula for $h(x)$.\n  $$\n  h(x) = \\frac{-\\frac{1}{2\\mu}\\exp(-2\\mu x) - (-\\frac{1}{2\\mu}\\exp(-2\\mu a))}{-\\frac{1}{2\\mu}\\exp(-2\\mu b) - (-\\frac{1}{2\\mu}\\exp(-2\\mu a))} = \\frac{\\exp(-2\\mu x) - \\exp(-2\\mu a)}{\\exp(-2\\mu b) - \\exp(-2\\mu a)}\n  $$\n- If $\\mu = 0$, $s'(x) = 1$, so $s(x) = x$.\n  $$\n  h(x) = \\frac{x-a}{b-a}\n  $$\nThe expression for $\\mu \\neq 0$ converges to the expression for $\\mu=0$ as $\\mu \\to 0$ via L'Hôpital's rule.\n\n**2. Derivation of the Expected Exit Time $u(x) = \\mathbb{E}_x[\\tau_{(a,b)}]$**\n\nThe expected exit time $u(x)$ is the solution to the Poisson-type BVP defined by $\\mathcal{L}u(x) = -1$ for $x \\in (a,b)$, with boundary conditions $u(a)=0$ and $u(b)=0$. The boundary conditions arise because if the process starts at a boundary point, the exit time is $0$.\n\nUsing the generator in terms of the scale and speed measures, the ODE is:\n$$\n\\frac{1}{m(x)}\\frac{d}{dx}\\left(\\frac{u'(x)}{s'(x)}\\right) = -1 \\implies \\frac{d}{dx}\\left(\\frac{u'(x)}{s'(x)}\\right) = -m(x)\n$$\nSubstituting $m(x) = 2\\exp(2\\mu x)$ and integrating with respect to $x$ gives:\n- If $\\mu \\neq 0$:\n  $$\n  \\frac{u'(x)}{s'(x)} = \\int -2\\exp(2\\mu y) dy = -\\frac{1}{\\mu}\\exp(2\\mu x) + C_1\n  $$\n  $u'(x) = s'(x) \\left(-\\frac{1}{\\mu}\\exp(2\\mu x) + C_1\\right) = \\exp(-2\\mu x) \\left(-\\frac{1}{\\mu}\\exp(2\\mu x) + C_1\\right) = -\\frac{1}{\\mu} + C_1\\exp(-2\\mu x)$.\n  Integrating again:\n  $$\n  u(x) = \\int \\left(-\\frac{1}{\\mu} + C_1\\exp(-2\\mu x)\\right) dx = -\\frac{x}{\\mu} - \\frac{C_1}{2\\mu}\\exp(-2\\mu x) + C_2\n  $$\n  Let $K_1 = -\\frac{C_1}{2\\mu}$ and $K_2=C_2$. The general solution is $u(x) = -\\frac{x}{\\mu} + K_1\\exp(-2\\mu x) + K_2$.\n  We apply the boundary conditions $u(a)=0$ and $u(b)=0$:\n  1. $-\\frac{a}{\\mu} + K_1\\exp(-2\\mu a) + K_2 = 0 \\implies K_1\\exp(-2\\mu a) + K_2 = \\frac{a}{\\mu}$\n  2. $-\\frac{b}{\\mu} + K_1\\exp(-2\\mu b) + K_2 = 0 \\implies K_1\\exp(-2\\mu b) + K_2 = \\frac{b}{\\mu}$\n  Subtracting gives $K_1(\\exp(-2\\mu a) - \\exp(-2\\mu b)) = \\frac{a-b}{\\mu}$, so $K_1 = \\frac{a-b}{\\mu(\\exp(-2\\mu a) - \\exp(-2\\mu b))}$.\n  $K_2 = \\frac{a}{\\mu} - K_1\\exp(-2\\mu a) = \\frac{a}{\\mu} - \\frac{(a-b)\\exp(-2\\mu a)}{\\mu(\\exp(-2\\mu a) - \\exp(-2\\mu b))} = \\frac{b\\exp(-2\\mu a) - a\\exp(-2\\mu b)}{\\mu(\\exp(-2\\mu a) - \\exp(-2\\mu b))}$.\n  Substituting back, we obtain a complex expression. A more structured form is:\n  $$\n  u(x) = \\frac{1}{\\mu}\\left( a-x + (b-a)h(x) \\right) = \\frac{1}{\\mu}\\left( a-x + (b-a)\\frac{\\exp(-2\\mu x) - \\exp(-2\\mu a)}{\\exp(-2\\mu b) - \\exp(-2\\mu a)}\\right)\n  $$\n- If $\\mu = 0$, the ODE is $\\frac{1}{2}u''(x) = -1$, or $u''(x) = -2$.\n  Integrating twice gives $u(x) = -x^2 + C_1 x + C_2$.\n  Applying boundary conditions $u(a)=0, u(b)=0$:\n  1. $-a^2 + C_1 a + C_2 = 0$\n  2. $-b^2 + C_1 b + C_2 = 0$\n  Solving this system yields $C_1 = a+b$ and $C_2 = -ab$.\n  The solution is $u(x) = -x^2 + (a+b)x - ab = (x-a)(b-x)$.\nAgain, the expression for $\\mu \\neq 0$ converges to the expression for $\\mu=0$ as $\\mu \\to 0$. We provide the general expressions valid for $\\mu \\neq 0$, with the understanding that the case $\\mu = 0$ is obtained by taking the limit.\n\nFinal expressions:\nFor the hitting probability $h(x) = \\mathbb{P}_x(\\tau_b  \\tau_a)$:\n$$\nh(x) = \\frac{\\exp(-2\\mu x) - \\exp(-2\\mu a)}{\\exp(-2\\mu b) - \\exp(-2\\mu a)}\n$$\nFor the expected exit time $u(x) = \\mathbb{E}_x[\\tau_{(a,b)}]$:\n$$\nu(x) = \\frac{1}{\\mu}\\left( a-x + (b-a)\\frac{\\exp(-2\\mu x) - \\exp(-2\\mu a)}{\\exp(-2\\mu b) - \\exp(-2\\mu a)}\\right)\n$$", "answer": "$$ \\boxed{ \\begin{pmatrix} \\frac{\\exp(-2\\mu x) - \\exp(-2\\mu a)}{\\exp(-2\\mu b) - \\exp(-2\\mu a)}  \\frac{1}{\\mu}\\left( a-x + (b-a)\\frac{\\exp(-2\\mu x) - \\exp(-2\\mu a)}{\\exp(-2\\mu b) - \\exp(-2\\mu a)}\\right) \\end{pmatrix} } $$", "id": "2974721"}, {"introduction": "Having mastered the one-dimensional case, we now extend our analysis to higher dimensions by considering a standard Brownian motion in a $d$-dimensional annulus. This problem demonstrates a crucial problem-solving technique: leveraging symmetry to simplify a seemingly complex multi-dimensional problem into a manageable one-dimensional one. By reducing the governing Laplace equation to a radial ordinary differential equation, you will discover how the probability of hitting the inner boundary critically depends on the dimension $d$, revealing a distinct behavior for the planar case ($d=2$). [@problem_id:2974725]", "problem": "Consider standard $d$-dimensional Brownian motion $B_t$ on $\\mathbb{R}^d$ with $d \\ge 2$, started at a point $x \\in \\mathbb{R}^d$ with $r = \\|x\\| \\in (r_1, r_2)$, where $0  r_1  r_2$. Let $A = \\{ x \\in \\mathbb{R}^d : r_1  \\|x\\|  r_2 \\}$ denote the annulus, and let $\\tau = \\inf\\{ t \\ge 0 : B_t \\notin A \\}$ be the first exit time from $A$. Define the event $H_{\\text{in}} = \\{ \\|B_\\tau\\| = r_1 \\}$ that the process first hits the inner sphere and $H_{\\text{out}} = \\{ \\|B_\\tau\\| = r_2 \\}$ that it first hits the outer sphere, so that $H_{\\text{in}} \\cup H_{\\text{out}}$ occurs almost surely and $H_{\\text{in}} \\cap H_{\\text{out}} = \\varnothing$.\n\nStarting solely from the generator characterization of Brownian motion (the infinitesimal generator is $(1/2)\\Delta$ with $\\Delta$ the Laplacian) together with the strong Markov property and boundary data posed on $\\partial A$, derive from first principles the boundary value problem for the function $u(x) = \\mathbb{P}_x(H_{\\text{in}})$, reduce it by symmetry to a radial ordinary differential equation in the radial coordinate $r = \\|x\\|$, and solve it subject to appropriate boundary conditions at $r = r_1$ and $r = r_2$. Your derivation must make clear why the resulting function is harmonic inside $A$ and how the boundary conditions encode the event $H_{\\text{in}}$.\n\nExpress the inner-hit probability $u(r) = \\mathbb{P}(\\|B_\\tau\\| = r_1 \\mid \\|B_0\\| = r)$ explicitly as a closed-form function of $r$, $r_1$, $r_2$, and $d$, displaying the dependence on $d$ and showing the distinct forms for $d \\ne 2$ (in terms of powers of radii) and for $d = 2$ (in terms of logarithms of radii). You may assume sufficient smoothness and regularity to justify the steps of your derivation. The outer-hit probability is given by $1 - u(r)$ and does not need to be reported.\n\nProvide your final answer as a single closed-form expression for $u(r)$, valid for all $d \\ge 2$, written piecewise in the cases $d \\ne 2$ and $d = 2$. No numerical evaluation is required, and no units are involved.", "solution": "Let $B_t$ be a standard $d$-dimensional Brownian motion, where $d \\ge 2$. The starting position is $x \\in \\mathbb{R}^d$ such that its norm $r = \\|x\\|$ satisfies $r_1  r  r_2$ for some $0  r_1  r_2$. The process evolves in the annulus $A = \\{ y \\in \\mathbb{R}^d : r_1  \\|y\\|  r_2 \\}$. The first exit time from this annulus is $\\tau = \\inf\\{ t \\ge 0 : B_t \\notin A \\}$. We are interested in the probability of the event $H_{\\text{in}} = \\{ \\|B_\\tau\\| = r_1 \\}$, which is that the process first hits the inner sphere $\\partial A_{\\text{in}} = \\{ y \\in \\mathbb{R}^d : \\|y\\| = r_1 \\}$.\n\nLet $u(x) = \\mathbb{P}_x(H_{\\text{in}}) = \\mathbb{P}(H_{\\text{in}} \\mid B_0 = x)$. We are tasked to find $u(x)$.\n\nThe infinitesimal generator of a standard $d$-dimensional Brownian motion is the operator $\\mathcal{L} = \\frac{1}{2}\\Delta$, where $\\Delta = \\sum_{i=1}^d \\frac{\\partial^2}{\\partial x_i^2}$ is the Laplacian operator.\n\nA fundamental result in the theory of stochastic differential equations, known as Dynkin's formula, connects the process to its generator. For a function $f$ of sufficient regularity and a stopping time $T$, the process $M_t = f(B_{t \\wedge T}) - \\int_0^{t \\wedge T} \\mathcal{L}f(B_s) ds$ is a martingale. A key property is that the hitting probability function $u(x)$ satisfies $\\mathcal{L}u(x) = 0$ for all $x$ in the interior of the domain. In our case, this means $\\frac{1}{2}\\Delta u(x) = 0$ for all $x \\in A$. This implies that $u(x)$ is a harmonic function in the annulus $A$.\n\nTo see this more formally, consider the process $U_t = u(B_{t \\wedge \\tau})$. By the strong Markov property, for any stopping time $S  \\tau$,\n$$ u(B_S) = \\mathbb{P}_{B_S}(H_{\\text{in}}) = \\mathbb{E}[ \\mathbf{1}_{H_{\\text{in}}} \\mid \\mathcal{F}_S ] $$\nwhere $\\mathbf{1}_{H_{\\text{in}}}$ is the indicator function for the event. The process $U_t$ is a bounded martingale. From Itô's formula, for $u$ being $C^2$, the martingale property of $U_t$ for $t  \\tau$ requires the drift term to be zero. The drift term is $\\mathcal{L}u(B_t) = \\frac{1}{2}\\Delta u(B_t)$. Thus, we must have $\\Delta u(x) = 0$ for all $x \\in A$.\n\nNext, we establish the boundary conditions for $u(x)$ on $\\partial A = \\partial A_{\\text{in}} \\cup \\partial A_{\\text{out}}$.\nIf the process starts at a point $x$ on the inner sphere, so $\\|x\\|=r_1$, then its starting point is already on the boundary. The first exit time is $\\tau=0$, and $B_\\tau = B_0 = x$. Therefore, $\\|B_\\tau\\| = r_1$, which means the event $H_{\\text{in}}$ occurs with probability $1$. Thus, the boundary condition is $u(x) = 1$ for $\\|x\\| = r_1$.\n\nIf the process starts at a point $x$ on the outer sphere, so $\\|x\\|=r_2$, the first exit time is again $\\tau=0$, and $B_\\tau=x$. Therefore, $\\|B_\\tau\\| = r_2$. The event $H_{\\text{in}}$ cannot occur, so its probability is $0$. Thus, the boundary condition is $u(x) = 0$ for $\\|x\\| = r_2$.\n\nWe have now formulated a Dirichlet problem for the function $u(x)$:\n$$\n\\begin{cases}\n\\Delta u(x) = 0  \\text{for } x \\in A = \\{x \\in \\mathbb{R}^d : r_1  \\|x\\|  r_2\\} \\\\\nu(x) = 1  \\text{for } \\|x\\| = r_1 \\\\\nu(x) = 0  \\text{for } \\|x\\| = r_2\n\\end{cases}\n$$\n\nThe Laplacian operator $\\Delta$, the domain $A$, and the boundary conditions are all invariant under rotations of $\\mathbb{R}^d$ about the origin. This spherical symmetry implies that the unique solution $u(x)$ must depend only on the radial distance $r = \\|x\\|$ from the origin. We can therefore write $u(x) = v(r)$ for some function $v$.\n\nTo solve the problem, we express the Laplacian in $d$-dimensional spherical coordinates. For a function $v(r)$ that depends only on the radius $r$, the Laplacian is given by:\n$$ \\Delta v(r) = \\frac{d^2 v}{dr^2} + \\frac{d-1}{r} \\frac{dv}{dr} $$\nThe PDE $\\Delta u = 0$ reduces to the ordinary differential equation (ODE):\n$$ v''(r) + \\frac{d-1}{r} v'(r) = 0 $$\nThe boundary conditions become $v(r_1) = 1$ and $v(r_2) = 0$.\n\nThis is a second-order linear ODE which can be solved by first reducing the order. Let $w(r) = v'(r)$. The equation for $w$ is:\n$$ w'(r) + \\frac{d-1}{r} w(r) = 0 $$\nThis is a separable first-order ODE:\n$$ \\frac{w'(r)}{w(r)} = -\\frac{d-1}{r} $$\nIntegrating with respect to $r$ yields $\\ln(w(r)) = -(d-1)\\ln(r) + C_0$, which gives $w(r) = C_1 r^{-(d-1)} = C_1 r^{1-d}$ for some constant $C_1$.\nNow we have $v'(r) = C_1 r^{1-d}$. To find $v(r)$, we integrate $v'(r)$. We must consider two separate cases based on the exponent $1-d$.\n\nCase 1: $d \\ne 2$.\nIn this case, $1-d \\ne -1$. The integral is:\n$$ v(r) = \\int C_1 r^{1-d} dr = C_1 \\frac{r^{2-d}}{2-d} + C_2 $$\nThe general solution has the form $v(r) = A r^{2-d} + B$, where $A$ and $B$ are constants. We apply the boundary conditions to determine them:\n$$ v(r_1) = A r_1^{2-d} + B = 1 $$\n$$ v(r_2) = A r_2^{2-d} + B = 0 $$\nFrom the second equation, we find $B = -A r_2^{2-d}$. Substituting this into the first equation:\n$$ A r_1^{2-d} - A r_2^{2-d} = 1 \\implies A(r_1^{2-d} - r_2^{2-d}) = 1 $$\n$$ A = \\frac{1}{r_1^{2-d} - r_2^{2-d}} $$\nThen, $B$ is given by:\n$$ B = - \\frac{r_2^{2-d}}{r_1^{2-d} - r_2^{2-d}} $$\nSubstituting $A$ and $B$ back into the solution for $v(r)$:\n$$ v(r) = \\frac{r^{2-d}}{r_1^{2-d} - r_2^{2-d}} - \\frac{r_2^{2-d}}{r_1^{2-d} - r_2^{2-d}} = \\frac{r^{2-d} - r_2^{2-d}}{r_1^{2-d} - r_2^{2-d}} $$\n\nCase 2: $d=2$.\nIn this case, the exponent is $1-d = -1$.\n$$ v'(r) = C_1 r^{-1} = \\frac{C_1}{r} $$\nIntegrating with respect to $r$ gives:\n$$ v(r) = \\int \\frac{C_1}{r} dr = C_1 \\ln(r) + C_2 $$\nThe general solution has the form $v(r) = A \\ln(r) + B$. Applying the boundary conditions:\n$$ v(r_1) = A \\ln(r_1) + B = 1 $$\n$$ v(r_2) = A \\ln(r_2) + B = 0 $$\nFrom the second equation, $B = -A \\ln(r_2)$. Substituting this into the first equation:\n$$ A \\ln(r_1) - A \\ln(r_2) = 1 \\implies A(\\ln(r_1) - \\ln(r_2)) = 1 $$\n$$ A = \\frac{1}{\\ln(r_1) - \\ln(r_2)} = \\frac{1}{\\ln(r_1/r_2)} $$\nThen, $B$ is given by:\n$$ B = - \\frac{\\ln(r_2)}{\\ln(r_1) - \\ln(r_2)} $$\nSubstituting $A$ and $B$ back into the solution for $v(r)$:\n$$ v(r) = \\frac{\\ln(r)}{\\ln(r_1) - \\ln(r_2)} - \\frac{\\ln(r_2)}{\\ln(r_1) - \\ln(r_2)} = \\frac{\\ln(r) - \\ln(r_2)}{\\ln(r_1) - \\ln(r_2)} $$\nThis can also be written as $v(r) = \\frac{\\ln(r/r_2)}{\\ln(r_1/r_2)}$ or $v(r) = \\frac{\\ln(r_2/r)}{\\ln(r_2/r_1)}$.\n\nCombining these results, the probability $u(r) = \\mathbb{P}(\\|B_\\tau\\| = r_1 \\mid \\|B_0\\|=r)$ is given by the following piecewise function of $r$, $r_1$, $r_2$, and the dimension $d$.", "answer": "$$\n\\boxed{\nu(r) = \\begin{cases} \\frac{r^{2-d} - r_2^{2-d}}{r_1^{2-d} - r_2^{2-d}}  \\text{if } d \\neq 2 \\\\ \\frac{\\ln(r) - \\ln(r_2)}{\\ln(r_1) - \\ln(r_2)}  \\text{if } d = 2 \\end{cases}\n}\n$$", "id": "2974725"}, {"introduction": "Our final practice delves into the subtle behavior of stochastic processes near the boundaries of their state space, using the important example of the Bessel process. This exercise introduces Feller's boundary classification, a rigorous framework for determining whether a boundary point is accessible to the process. You will first use this powerful qualitative tool to predict the nature of the exit time from an interval $(0,R)$ and then perform an explicit calculation for a specific regime, solidifying your understanding of how local coefficient behavior in an SDE dictates the global path properties. [@problem_id:2974762]", "problem": "Consider the Bessel diffusion of dimension $\\delta0$, denoted $\\operatorname{BES}(\\delta)$, on the state space $(0,\\infty)$, started at $X_{0}=x\\in(0,\\infty)$, defined as the unique strong solution to the stochastic differential equation\n$$\ndX_{t} \\;=\\; dB_{t} \\;+\\; \\frac{\\delta-1}{2\\,X_{t}}\\,dt,\n$$\nwhere $B_{t}$ is a standard one-dimensional Brownian motion. Fix a radius $R0$ and define the first exit time from the bounded interval $(0,R)$ by\n$$\n\\tau_{(0,R)} \\;=\\; \\inf\\{ t\\ge 0 : X_{t}\\notin(0,R)\\}.\n$$\nUse Feller’s boundary classification in terms of the scale function and speed measure to analyze the endpoint $0$ for the three parameter regimes $\\delta2$, $\\delta=2$, and $\\delta\\in(0,2)$. For each regime, predict qualitatively whether the mean exit time $\\mathbb{E}_{x}[\\tau_{(0,R)}]$ is finite, infinite, or zero when $x\\in(0,R)$, under the convention that the boundary condition at $R$ is absorbing and the boundary behavior at $0$ is the one dictated by the classification. Then, for the specific regime $\\delta2$, derive from first principles the exact expression of $\\mathbb{E}_{x}[\\tau_{(0,R)}]$ as a function of $x$, $R$, and $\\delta$, using only foundational tools: the infinitesimal generator, Dynkin’s formula, and the scale-speed characterization of boundary types. Your final answer must be a single closed-form expression in $x$, $R$, and $\\delta$. No rounding is required and no physical units are involved.", "solution": "The problem asks for an analysis of the exit time of a Bessel process from the interval $(0,R)$. The process $X_t$ is defined by the stochastic differential equation (SDE):\n$$\ndX_{t} \\;=\\; dB_{t} \\;+\\; \\frac{\\delta-1}{2\\,X_{t}}\\,dt\n$$\nwhere $\\delta  0$ is the dimension, $X_0 = x \\in (0,R)$, and $B_t$ is a standard one-dimensional Brownian motion.\n\nThe solution proceeds in three parts. First, we classify the boundary at $0$ using Feller's boundary classification. Second, we use this classification to qualitatively determine if the mean exit time $\\mathbb{E}_{x}[\\tau_{(0,R)}]$ is finite or infinite. Third, we derive the exact expression for this mean exit time for the regime $\\delta2$.\n\nThe SDE is of the form $dX_t = \\mu(X_t)dt + \\sigma(X_t)dB_t$ with drift coefficient $\\mu(x) = \\frac{\\delta-1}{2x}$ and diffusion coefficient $\\sigma(x)=1$.\n\n**Part 1: Feller's Boundary Classification**\n\nFeller's classification of a boundary point depends on the integrability of the scale and speed measure densities near that point.\nThe scale function density, $s(x)$, is given by:\n$$\ns(x) = \\exp\\left(-\\int \\frac{2\\mu(y)}{\\sigma^2(y)} dy\\right) = \\exp\\left(-\\int \\frac{2(\\delta-1)/(2y)}{1^2} dy\\right) = \\exp\\left(-(\\delta-1)\\ln x\\right) = x^{1-\\delta}\n$$\nThe speed measure density, $m(x)$, is given by:\n$$\nm(x) = \\frac{2}{\\sigma^2(x)s(x)} = \\frac{2}{1 \\cdot x^{1-\\delta}} = 2x^{\\delta-1}\n$$\nTo classify the boundary at $0$, we examine the convergence of the integrals of $s(x)$ and $m(x)$ on an interval $(0,c]$ for some $c0$. Let's use $c=1$.\n\nThe integral of the scale density is:\n$$\n\\int_0^1 s(x)\\,dx = \\int_0^1 x^{1-\\delta}\\,dx\n$$\nThis integral converges if the exponent $1-\\delta$ is greater than $-1$, i.e., if $\\delta  2$. It diverges if $\\delta \\ge 2$.\n\nThe integral of the speed measure density is:\n$$\n\\int_0^1 m(x)\\,dx = \\int_0^1 2x^{\\delta-1}\\,dx\n$$\nThis integral converges if the exponent $\\delta-1$ is greater than $-1$, i.e., if $\\delta  0$. Since the problem states $\\delta0$, this integral is always convergent.\n\nUsing the standard classification scheme (e.g., that of Karatzas and Shreve), a boundary is classified as follows based on the convergence of the integrals of $s(x)$ (denoted $I_s$) and $m(x)$ (denoted $I_m$):\n- Regular: $I_s  \\infty$ and $I_m  \\infty$.\n- Entrance: $I_s = \\infty$ and $I_m  \\infty$.\n- Exit: $I_s  \\infty$ and $I_m = \\infty$.\n- Natural: $I_s = \\infty$ and $I_m = \\infty$.\n\nApplying this to the boundary at $0$ for the Bessel process:\n1.  **Regime $\\delta \\in (0, 2)$**: $I_s = \\int_0^1 x^{1-\\delta}\\,dx  \\infty$ and $I_m = \\int_0^1 2x^{\\delta-1}\\,dx  \\infty$. The boundary at $0$ is **regular**. A regular boundary is accessible, meaning the process can reach it in finite time with positive probability.\n2.  **Regime $\\delta = 2$**: $I_s = \\int_0^1 x^{-1}\\,dx = \\infty$ and $I_m = \\int_0^1 2x\\,dx  \\infty$. The boundary at $0$ is **entrance**.\n3.  **Regime $\\delta  2$**: $I_s = \\int_0^1 x^{1-\\delta}\\,dx = \\infty$ and $I_m = \\int_0^1 2x^{\\delta-1}\\,dx  \\infty$. The boundary at $0$ is **entrance**.\n\nAn entrance boundary is inaccessible from the interior of the state space. This means that for $\\delta \\ge 2$, the process $X_t$ started at $x0$ will almost surely never hit $0$.\n\n**Part 2: Qualitative Prediction for Mean Exit Time**\n\nLet $u(x) = \\mathbb{E}_{x}[\\tau_{(0,R)}]$, where $\\tau_{(0,R)} = \\inf\\{ t\\ge 0 : X_{t}\\notin(0,R)\\}$. The boundary at $R$ is absorbing. The behavior at $0$ is \"dictated by the classification\".\n- For $\\delta \\in (0, 2)$, the boundary at $0$ is regular and thus accessible. The exit from $(0,R)$ implies that the process stops if it hits $0$ or $R$. This corresponds to imposing absorbing boundary conditions at both ends. For a diffusion on a finite interval with two accessible, absorbing boundaries, the mean exit time is finite.\n- For $\\delta \\ge 2$, the boundary at $0$ is an entrance boundary and thus inaccessible. The process can never exit at $0$. Therefore, exiting the interval $(0,R)$ is equivalent to reaching the boundary $R$. So, $\\tau_{(0,R)} = \\tau_R = \\inf\\{t \\ge 0 : X_t=R\\}$.\n    - For $\\delta  2$, the drift $\\mu(x) = (\\delta-1)/(2x)$ is positive and pushes the process away from $0$ towards $R$.\n    - For $\\delta = 2$, the drift $\\mu(x)=1/(2x)$ is also positive and pushes the process away from $0$.\nIn both sub-regimes for $\\delta \\ge 2$, the process is pushed towards the exit at $R$ and cannot get stuck at the inaccessible boundary $0$. This suggests the mean time to hit $R$ is finite.\n\nTherefore, for all three regimes, the qualitative prediction is that the mean exit time $\\mathbb{E}_{x}[\\tau_{(0,R)}]$ is **finite**. The value $0$ is impossible since $x \\in (0,R)$, and our analysis indicates \"infinite\" is not expected.\n\n**Part 3: Derivation for $\\delta  2$**\n\nFor the regime $\\delta  2$, we seek the exact expression for $u(x) = \\mathbb{E}_{x}[\\tau_{(0,R)}]$. As established, the boundary at $0$ is inaccessible, so $\\tau_{(0,R)} = \\tau_R$. The function $u(x)$ satisfies the ordinary differential equation given by Dynkin's formula:\n$$\n\\mathcal{L}u(x) = -1\n$$\nwhere $\\mathcal{L}$ is the infinitesimal generator of the process:\n$$\n\\mathcal{L} = \\mu(x)\\frac{d}{dx} + \\frac{1}{2}\\sigma^2(x)\\frac{d^2}{dx^2} = \\frac{\\delta-1}{2x}\\frac{d}{dx} + \\frac{1}{2}\\frac{d^2}{dx^2}\n$$\nSo the ODE is:\n$$\n\\frac{1}{2}u''(x) + \\frac{\\delta-1}{2x}u'(x) = -1\n$$\nThe boundary conditions are:\n1.  Absorbing boundary at $R$: $u(R) = 0$.\n2.  Inaccessible boundary at $0$: The solution $u(x)$ must be regular (e.g., bounded) as $x \\to 0^{+}$.\n\nLet's solve the ODE. Let $v(x) = u'(x)$. The equation becomes a first-order linear ODE for $v(x)$:\n$$\nv'(x) + \\frac{\\delta-1}{x}v(x) = -2\n$$\nThe integrating factor is $I(x) = \\exp\\left(\\int \\frac{\\delta-1}{x} dx\\right) = \\exp((\\delta-1)\\ln x) = x^{\\delta-1}$. Multiplying the ODE by $I(x)$:\n$$\n\\left(x^{\\delta-1}v(x)\\right)' = -2x^{\\delta-1}\n$$\nIntegrating with respect to $x$:\n$$\nx^{\\delta-1}v(x) = \\int -2x^{\\delta-1} dx = -2\\frac{x^\\delta}{\\delta} + C_1\n$$\nwhere $C_1$ is an integration constant. Solving for $v(x) = u'(x)$:\n$$\nu'(x) = -\\frac{2x}{\\delta} + C_1 x^{1-\\delta}\n$$\nIntegrating again to find $u(x)$:\n$$\nu(x) = \\int\\left(-\\frac{2x}{\\delta} + C_1 x^{1-\\delta}\\right) dx\n$$\nSince $\\delta  2$, we have $\\delta \\ne 2$, so we can integrate the second term:\n$$\nu(x) = -\\frac{x^2}{\\delta} + C_1 \\frac{x^{2-\\delta}}{2-\\delta} + C_2\n$$\nwhere $C_2$ is another integration constant. Now we apply the boundary conditions.\nFirst, consider the regularity condition at $x=0$. Since $\\delta  2$, the exponent $2-\\delta$ is negative. As $x \\to 0^{+}$, the term $x^{2-\\delta}$ diverges to infinity. For $u(x)$ to remain bounded as required by the regularity at the inaccessible boundary, the coefficient of this divergent term must be zero. Therefore, we must have $C_1=0$.\n\nWith $C_1=0$, the solution simplifies to:\n$$\nu(x) = -\\frac{x^2}{\\delta} + C_2\n$$\nNow, we apply the absorbing boundary condition at $x=R$:\n$$\nu(R) = 0 \\implies -\\frac{R^2}{\\delta} + C_2 = 0 \\implies C_2 = \\frac{R^2}{\\delta}\n$$\nSubstituting $C_2$ back into the solution for $u(x)$ gives the final expression for the mean exit time:\n$$\nu(x) = \\frac{R^2}{\\delta} - \\frac{x^2}{\\delta} = \\frac{R^2 - x^2}{\\delta}\n$$\nThis function is positive and finite for all $x \\in (0,R)$, which is consistent with our qualitative prediction.", "answer": "$$\n\\boxed{\\frac{R^2 - x^2}{\\delta}}\n$$", "id": "2974762"}]}