{"hands_on_practices": [{"introduction": "A deep understanding of any stochastic process begins with its transition density, which governs its evolution through time. This exercise guides you through the foundational derivation of the transition probability density for the Cox-Ingersoll-Ross (CIR) process [@problem_id:2969020]. By connecting the CIR model to the family of squared Bessel processes, you will uncover its elegant mathematical structure and see how it gives rise to a scaled noncentral chi-square distribution, ultimately expressing the density using modified Bessel functions.", "problem": "Consider the Cox–Ingersoll–Ross (CIR) diffusion $X_t$ defined by the stochastic differential equation\n$$\n\\mathrm{d}X_t \\;=\\; \\kappa\\left(\\theta - X_t\\right)\\mathrm{d}t \\;+\\; \\sigma\\sqrt{X_t}\\,\\mathrm{d}W_t,\\qquad X_0=x>0,\n$$\nwhere $\\kappa>0$, $\\theta>0$, and $\\sigma>0$ are constants, and $W_t$ is a standard Brownian motion. Assume the Feller condition $2\\kappa\\theta>\\sigma^2$ so that the origin is inaccessible and the state space is $(0,\\infty)$.\n\nStarting from first principles in the theory of affine diffusions and squared Bessel processes, use a transformation and time-change argument to identify the law of $X_t$ as a scaled noncentral chi-square random variable. Then, from the known probability density function (PDF) of the noncentral chi-square law, perform the appropriate change of variables to obtain the transition density $p(t,x,y)$ of $X_t$ conditional on $X_0=x$, for $t>0$ and $y>0$. Express your final answer in closed form in terms of the modified Bessel function of the first kind $I_{\\alpha}$, and write it as a single analytic expression in the parameters $\\kappa$, $\\theta$, $\\sigma$, $t$, $x$, and $y$.\n\nNo intermediate formulas for the target density are to be assumed; derive the representation from the foundational characterization of the squared Bessel process. Your final answer must be a single closed-form analytic expression. Do not round or approximate.", "solution": "The problem of deriving the transition density of the Cox-Ingersoll-Ross (CIR) process is valid. The problem is scientifically grounded in the theory of stochastic differential equations, well-posed, and objective. All necessary parameters and conditions are provided, and the task is a standard, albeit advanced, derivation in the field.\n\nThe CIR process $X_t$ is described by the stochastic differential equation (SDE):\n$$\n\\mathrm{d}X_t = \\kappa(\\theta - X_t)\\mathrm{d}t + \\sigma\\sqrt{X_t}\\,\\mathrm{d}W_t, \\qquad X_0=x>0\n$$\nwhere $\\kappa$, $\\theta$, and $\\sigma$ are positive constants, and $W_t$ is a standard one-dimensional Brownian motion. The Feller condition $2\\kappa\\theta > \\sigma^2$ is assumed to hold, which ensures that $X_t > 0$ for all $t>0$. Our goal is to derive the transition probability density function $p(t,x,y) = \\mathbb{P}(X_t \\in \\mathrm{d}y | X_0=x) / \\mathrm{d}y$ for $t>0$ and $y>0$.\n\nThe derivation proceeds in four main steps, as guided by the problem statement:\n1.  Establish a connection between the CIR process and the squared norm of a multi-dimensional Ornstein-Uhlenbeck (OU) process.\n2.  Determine the probability distribution of this squared norm process by analyzing the distribution of the underlying OU process.\n3.  Identify this distribution as a scaled noncentral chi-square distribution.\n4.  Perform a change of variables on the known probability density function (PDF) of the noncentral chi-square distribution to obtain the desired transition density $p(t,x,y)$.\n\n**Step 1: Connection between CIR and Squared OU Processes**\n\nLet $V_t$ be a $d$-dimensional vector OU process satisfying the SDE:\n$$\n\\mathrm{d}V_t = -\\frac{\\kappa}{2}V_t\\,\\mathrm{d}t + \\frac{\\sigma}{2}\\mathrm{d}W_t\n$$\nwhere $W_t$ is a $d$-dimensional standard Brownian motion with independent components $W_t^i$. Let the initial condition be $V_0 = v_0$.\n\nWe define a new process $Z_t = |V_t|^2 = \\sum_{i=1}^d (V_t^i)^2$. To find the SDE for $Z_t$, we first apply Itô's lemma to a single component squared, $(V_t^i)^2$:\n$$\n\\mathrm{d}(V_t^i)^2 = 2V_t^i\\,\\mathrm{d}V_t^i + \\mathrm{d}\\langle V^i, V^i \\rangle_t\n$$\n$$\n\\mathrm{d}(V_t^i)^2 = 2V_t^i\\left(-\\frac{\\kappa}{2}V_t^i\\,\\mathrm{d}t + \\frac{\\sigma}{2}\\mathrm{d}W_t^i\\right) + \\left(\\frac{\\sigma}{2}\\right)^2\\mathrm{d}t\n$$\n$$\n\\mathrm{d}(V_t^i)^2 = \\left(-\\kappa(V_t^i)^2 + \\frac{\\sigma^2}{4}\\right)\\mathrm{d}t + \\sigma V_t^i\\,\\mathrm{d}W_t^i\n$$\nSumming over all $d$ components:\n$$\n\\mathrm{d}Z_t = \\sum_{i=1}^d \\mathrm{d}(V_t^i)^2 = \\sum_{i=1}^d \\left(-\\kappa(V_t^i)^2 + \\frac{\\sigma^2}{4}\\right)\\mathrm{d}t + \\sigma\\sum_{i=1}^d V_t^i\\,\\mathrm{d}W_t^i\n$$\n$$\n\\mathrm{d}Z_t = \\left(-\\kappa \\sum_{i=1}^d (V_t^i)^2 + d\\frac{\\sigma^2}{4}\\right)\\mathrm{d}t + \\sigma\\sum_{i=1}^d V_t^i\\,\\mathrm{d}W_t^i\n$$\n$$\n\\mathrm{d}Z_t = \\left(d\\frac{\\sigma^2}{4} - \\kappa Z_t\\right)\\mathrm{d}t + \\sigma\\sum_{i=1}^d V_t^i\\,\\mathrm{d}W_t^i\n$$\nThe quadratic variation of the martingale term is:\n$$\n\\left\\langle \\sigma\\sum_{i=1}^d V_t^i\\,\\mathrm{d}W_t^i \\right\\rangle_t = \\sigma^2 \\sum_{i,j=1}^d V_t^i V_t^j \\mathrm{d}\\langle W^i, W^j \\rangle_t = \\sigma^2 \\sum_{i=1}^d (V_t^i)^2\\,\\mathrm{d}t = \\sigma^2 Z_t\\,\\mathrm{d}t\n$$\nBy Lévy's characterization theorem for Brownian motion, the term $\\sigma\\sum_{i=1}^d V_t^i\\,\\mathrm{d}W_t^i$ can be represented as $\\sigma\\sqrt{Z_t}\\,\\mathrm{d}\\tilde{W}_t$ for some new one-dimensional standard Brownian motion $\\tilde{W}_t$.\nThus, the SDE for $Z_t$ is:\n$$\n\\mathrm{d}Z_t = \\left(d\\frac{\\sigma^2}{4} - \\kappa Z_t\\right)\\mathrm{d}t + \\sigma\\sqrt{Z_t}\\,\\mathrm{d}\\tilde{W}_t\n$$\nThis SDE matches the form of the CIR SDE $\\mathrm{d}X_t = \\kappa(\\theta - X_t)\\mathrm{d}t + \\sigma\\sqrt{X_t}\\,\\mathrm{d}W_t$ if we equate the drift coefficients:\n$$\nd\\frac{\\sigma^2}{4} = \\kappa\\theta \\implies d = \\frac{4\\kappa\\theta}{\\sigma^2}\n$$\nThis establishes that the CIR process $X_t$ has the same law as the squared norm of a $d$-dimensional OU process, where the dimension $d$ is determined by the CIR parameters. The initial condition $X_0=x$ corresponds to $Z_0=x$, so we set $|v_0|^2 = x$. Note that $d$ is not restricted to be an integer. The Feller condition $2\\kappa\\theta > \\sigma^2$ is equivalent to $d>2$.\n\n**Step 2: Distribution of the OU Process**\n\nThe solution to the $d$-dimensional OU process SDE is:\n$$\nV_t = V_0 \\exp\\left(-\\frac{\\kappa}{2}t\\right) + \\frac{\\sigma}{2}\\int_0^t \\exp\\left(-\\frac{\\kappa}{2}(t-s)\\right)\\mathrm{d}W_s\n$$\nSince $V_0=v_0$ is deterministic and the integral is a linear transformation of a Gaussian process, $V_t$ is a multivariate normally distributed random vector.\nThe mean vector is:\n$$\n\\mathbb{E}[V_t] = v_0 \\exp\\left(-\\frac{\\kappa}{2}t\\right)\n$$\nThe covariance matrix is $C_t = \\mathbb{E}[(V_t - \\mathbb{E}[V_t])(V_t - \\mathbb{E}[V_t])^T]$. Its components are:\n$$\n(C_t)_{ij} = \\mathbb{E}\\left[\\left(\\frac{\\sigma}{2}\\int_0^t \\exp\\left(-\\frac{\\kappa}{2}(t-s)\\right)\\mathrm{d}W_s^i\\right)\\left(\\frac{\\sigma}{2}\\int_0^t \\exp\\left(-\\frac{\\kappa}{2}(t-u)\\right)\\mathrm{d}W_u^j\\right)\\right]\n$$\nBy the Itô isometry, this is non-zero only for $i=j$:\n$$\n(C_t)_{ii} = \\frac{\\sigma^2}{4}\\int_0^t \\exp(-\\kappa(t-s))\\,\\mathrm{d}s = \\frac{\\sigma^2}{4}\\left[\\frac{\\exp(-\\kappa(t-s))}{\\kappa}\\right]_0^t = \\frac{\\sigma^2}{4\\kappa}(1 - \\exp(-\\kappa t))\n$$\nSo, the covariance matrix is $C_t = \\Sigma^2(t) I_d$, where $I_d$ is the $d \\times d$ identity matrix and the variance of each component is $\\Sigma^2(t) = \\frac{\\sigma^2}{4\\kappa}(1 - \\exp(-\\kappa t))$.\nTherefore, $V_t \\sim \\mathcal{N}\\left(v_0 \\exp(-\\frac{\\kappa}{2}t), \\Sigma^2(t)I_d\\right)$.\n\n**Step 3: Identification with a Scaled Noncentral Chi-Square Distribution**\n\nA noncentral chi-square random variable with $d$ degrees of freedom and non-centrality parameter $\\lambda$, denoted $\\chi'^2(d, \\lambda)$, is defined as the sum of squares of $d$ independent normal random variables, each with variance $1$ and with means $\\mu_i$ such that $\\sum_{i=1}^d \\mu_i^2 = \\lambda$.\n\nConsider the standardized random vector $Z_t = V_t/\\Sigma(t)$. It is normally distributed with mean $\\mathbb{E}[Z_t] = \\frac{v_0}{\\Sigma(t)}\\exp(-\\frac{\\kappa}{2} t)$ and covariance matrix $I_d$.\nThe sum of squares $|Z_t|^2 = |V_t|^2/\\Sigma^2(t) = X_t/\\Sigma^2(t)$ follows a noncentral chi-square distribution with:\n-   Degrees of freedom: $d = \\frac{4\\kappa\\theta}{\\sigma^2}$.\n-   Non-centrality parameter $\\lambda_t$:\n    $$\n    \\lambda_t = |\\mathbb{E}[Z_t]|^2 = \\frac{|v_0|^2}{\\Sigma^2(t)}\\exp(-\\kappa t) = \\frac{x \\exp(-\\kappa t)}{\\frac{\\sigma^2}{4\\kappa}(1-\\exp(-\\kappa t))} = \\frac{4\\kappa x \\exp(-\\kappa t)}{\\sigma^2(1-\\exp(-\\kappa t))}\n    $$\nThus, the random variable $X_t$ is distributed as a scaling factor times a noncentral chi-square variable:\n$$\nX_t \\sim \\Sigma^2(t) \\cdot \\chi'^2(d, \\lambda_t) = \\frac{\\sigma^2(1-\\exp(-\\kappa t))}{4\\kappa} \\cdot \\chi'^2\\left(\\frac{4\\kappa\\theta}{\\sigma^2}, \\frac{4\\kappa x \\exp(-\\kappa t)}{\\sigma^2(1-\\exp(-\\kappa t))}\\right)\n$$\n\n**Step 4: Derivation of the Transition Density**\n\nLet $Y \\sim \\chi'^2(d, \\lambda)$. Its PDF is given by:\n$$\nf_Y(y; d, \\lambda) = \\frac{1}{2}\\exp\\left(-\\frac{y+\\lambda}{2}\\right)\\left(\\frac{y}{\\lambda}\\right)^{\\frac{d-2}{4}} I_{\\frac{d}{2}-1}(\\sqrt{\\lambda y})\n$$\nwhere $I_\\alpha$ is the modified Bessel function of the first kind of order $\\alpha$.\n\nWe have the relationship $X_t = \\Sigma^2(t) Y$, so $Y = X_t / \\Sigma^2(t)$. Let $p(t,x,y_{val})$ denote the PDF of $X_t$ at value $y_{val}$. By the change of variables formula for PDFs:\n$$\np(t,x,y_{val}) = f_Y\\left(\\frac{y_{val}}{\\Sigma^2(t)}; d, \\lambda_t\\right) \\cdot \\left|\\frac{\\mathrm{d}Y}{\\mathrm{d}X_t}\\right| = f_Y\\left(\\frac{y_{val}}{\\Sigma^2(t)}; d, \\lambda_t\\right) \\cdot \\frac{1}{\\Sigma^2(t)}\n$$\nLet us define the following quantities for convenience:\n$$\nc_t = \\frac{4\\kappa}{\\sigma^2(1-\\exp(-\\kappa t))} = \\frac{1}{\\Sigma^2(t)}\n$$\n$$\nq = \\frac{d}{2}-1 = \\frac{2\\kappa\\theta}{\\sigma^2}-1\n$$\nNote that $\\lambda_t = c_t x \\exp(-\\kappa t)$.\nSubstituting into the formula for $p(t,x,y)$ (using $y$ for $y_{val}$):\n$$\np(t,x,y) = c_t \\cdot \\frac{1}{2}\\exp\\left(-\\frac{c_t y + \\lambda_t}{2}\\right)\\left(\\frac{c_t y}{\\lambda_t}\\right)^{\\frac{q}{2}} I_q\\left(\\sqrt{\\lambda_t c_t y}\\right)\n$$\nSubstitute $\\lambda_t = c_t x \\exp(-\\kappa t)$:\n$$\np(t,x,y) = \\frac{c_t}{2}\\exp\\left(-\\frac{c_t(y + x\\exp(-\\kappa t))}{2}\\right)\\left(\\frac{c_t y}{c_t x\\exp(-\\kappa t)}\\right)^{\\frac{q}{2}} I_q\\left(\\sqrt{c_t x\\exp(-\\kappa t) \\cdot c_t y}\\right)\n$$\nSimplifying the terms:\n-   Exponent: $-\\frac{c_t}{2}(y + x\\exp(-\\kappa t))$\n-   Ratio term: $\\left(\\frac{y}{x\\exp(-\\kappa t)}\\right)^{q/2}$\n-   Bessel function argument: $c_t \\sqrt{xy\\exp(-\\kappa t)}$\n\nSubstituting the full expressions for $c_t$ and $q$ gives the final transition density:\n$p(t,x,y) = \\frac{2\\kappa}{\\sigma^2(1-\\exp(-\\kappa t))} \\exp\\left(-\\frac{2\\kappa(y+x\\exp(-\\kappa t))}{\\sigma^2(1-\\exp(-\\kappa t))}\\right) \\left(\\frac{y}{x\\exp(-\\kappa t)}\\right)^{\\frac{1}{2}(\\frac{2\\kappa\\theta}{\\sigma^2}-1)} I_{\\frac{2\\kappa\\theta}{\\sigma^2}-1}\\left(\\frac{4\\kappa\\sqrt{xy\\exp(-\\kappa t)}}{\\sigma^2(1-\\exp(-\\kappa t))}\\right)$\n\nThis expression is the transition density of the CIR process.", "answer": "$$\n\\boxed{\\frac{2\\kappa}{\\sigma^2(1-\\exp(-\\kappa t))} \\exp\\left(-\\frac{2\\kappa(y+x\\exp(-\\kappa t))}{\\sigma^2(1-\\exp(-\\kappa t))}\\right) \\left(\\frac{y}{x\\exp(-\\kappa t)}\\right)^{\\frac{1}{2}\\left(\\frac{2\\kappa\\theta}{\\sigma^2}-1\\right)} I_{\\frac{2\\kappa\\theta}{\\sigma^2}-1}\\left(\\frac{4\\kappa\\sqrt{xy\\exp(-\\kappa t)}}{\\sigma^2(1-\\exp(-\\kappa t))}\\right)}\n$$", "id": "2969020"}, {"introduction": "While the exact transition law of the CIR process is known, practitioners often rely on numerical schemes for their ease of implementation. However, these approximations can have subtle but critical flaws, particularly near the non-negativity boundary of the CIR model [@problem_id:2969007]. This practice will challenge you to analyze the popular Euler-Maruyama scheme, quantify its probability of producing a logically impossible negative interest rate, and understand why more sophisticated techniques like truncation or exact sampling are essential for robust simulations.", "problem": "Consider the Cox–Ingersoll–Ross (CIR) stochastic differential equation (SDE)\n$$\ndX_t \\;=\\; \\kappa\\big(\\theta - X_t\\big)\\,dt \\;+\\; \\sigma \\sqrt{X_t}\\,dW_t,\n$$\nwith parameters $\\,\\kappa>0\\,$, $\\,\\theta\\ge 0\\,$, and $\\,\\sigma>0\\,$, and standard Brownian motion $\\,W_t\\,$. Recall that under the Feller condition $\\,2\\kappa\\theta \\ge \\sigma^2\\,$ the exact solution is strictly positive almost surely for strictly positive initial data. Consider the explicit Euler–Maruyama time discretization with step size $\\,\\Delta>0\\,$:\n$$\nX_{n+1} \\;=\\; X_n \\;+\\; \\kappa\\big(\\theta - X_n\\big)\\Delta \\;+\\; \\sigma \\sqrt{X_n}\\,\\Delta W_n,\n$$\nwhere $\\,\\Delta W_n := W_{t_{n+1}} - W_{t_n} \\sim \\mathcal N(0,\\Delta)\\,$ are independent increments. Although the exact process is nonnegative, the discrete update above can produce negative values.\n\nWork from first principles to analyze the one–step behavior of the Euler–Maruyama scheme near the boundary and to assess positivity-preserving modifications. In particular:\n\n- Condition on $\\,X_n = x \\ge 0\\,$ and express the conditional probability that the next Euler–Maruyama step is negative, $\\,\\mathbb P\\!\\left[X_{n+1}<0 \\,\\middle|\\, X_n = x\\right]\\,$, in terms of the standard normal cumulative distribution function $\\,\\Phi\\,$.\n- Analyze the small–step behavior in two regimes: (i) $\\,x>0\\,$ fixed as $\\,\\Delta\\to 0\\,$, and (ii) $\\,x = c\\,\\Delta\\,$ with fixed $\\,c>0\\,$ as $\\,\\Delta\\to 0\\,$. Explain why regime (ii) is the relevant regime for boundary behavior.\n- Evaluate the following statements and select all that are correct:\n\nA. For any $\\,x>0\\,$,\n$$\n\\mathbb P\\!\\left[X_{n+1}<0 \\,\\middle|\\, X_n = x\\right] \\;=\\; \\Phi\\!\\left(\\,-\\,\\frac{x + \\kappa(\\theta - x)\\,\\Delta}{\\sigma\\sqrt{x\\,\\Delta}}\\,\\right).\n$$\n\nB. For fixed $\\,x>0\\,$, as $\\,\\Delta\\to 0\\,$, one has $\\,\\mathbb P\\!\\left[X_{n+1}<0 \\,\\middle|\\, X_n = x\\right] = \\mathcal O(\\sqrt{\\Delta})\\,$.\n\nC. If $\\,x = c\\,\\Delta\\,$ with fixed $\\,c>0\\,$, then as $\\,\\Delta\\to 0\\,$,\n$$\n\\mathbb P\\!\\left[X_{n+1}<0 \\,\\middle|\\, X_n = x\\right] \\;\\longrightarrow\\; \\Phi\\!\\left(\\,-\\,\\frac{c + \\kappa\\theta}{\\sigma\\sqrt{c}}\\,\\right).\n$$\n\nD. The absorption–full–truncation Euler variant\n$$\nX_{n+1} \\;:=\\; \\max\\!\\Big(x \\;+\\; \\kappa\\big(\\theta - x^+\\big)\\Delta \\;+\\; \\sigma \\sqrt{x^+}\\,\\Delta W_n,\\; 0\\Big), \n\\quad x^+ := \\max(x,0),\n$$\nenforces nonnegativity. Moreover, for $\\,x\\,$ bounded away from $\\,0\\,$, it preserves the first–order drift to leading order in $\\,\\Delta\\,$ in the sense that\n$$\n\\mathbb E\\!\\left[X_{n+1} - x \\,\\middle|\\, X_n = x\\right] \\;=\\; \\kappa(\\theta - x)\\,\\Delta \\;+\\; o(\\Delta)\n\\quad\\text{as } \\Delta\\to 0.\n$$\n\nE. There is an exact simulation scheme for the CIR transition over one step $\\,\\Delta\\,$: conditional on $\\,X_n=x\\,$, draw\n$$\nY \\sim \\chi^{\\prime 2}_{d}(\\lambda),\n\\quad d = \\frac{4\\kappa\\theta}{\\sigma^2}, \n\\quad \\lambda = \\frac{4\\kappa e^{-\\kappa \\Delta}}{\\sigma^2\\big(1 - e^{-\\kappa \\Delta}\\big)}\\,x,\n$$\nand set\n$$\nX_{n+1} \\;=\\; \\frac{\\sigma^2\\big(1 - e^{-\\kappa \\Delta}\\big)}{4\\kappa}\\,Y,\n$$\nwhich yields the exact law of $\\,X_{t_{n+1}}\\,$ and guarantees nonnegativity.\n\nSelect all correct options.", "solution": "The problem statement is a standard exercise in the analysis of numerical schemes for stochastic differential equations, specifically the Cox-Ingersoll-Ross (CIR) model. All definitions and parameters are standard and self-consistent. The problem is scientifically grounded, well-posed, objective, and contains all necessary information for a rigorous analysis. Therefore, the problem is valid, and we may proceed to the solution.\n\nThe core of the problem is to analyze the one-step behavior of the Euler-Maruyama (EM) discretization of the CIR process. The SDE is given by:\n$$\ndX_t = \\kappa(\\theta - X_t)\\,dt + \\sigma \\sqrt{X_t}\\,dW_t\n$$\nThe EM scheme with step size $\\Delta > 0$ is:\n$$\nX_{n+1} = X_n + \\kappa(\\theta - X_n)\\Delta + \\sigma \\sqrt{X_n}\\,\\Delta W_n\n$$\nwhere $\\Delta W_n \\sim \\mathcal{N}(0, \\Delta)$ are independent Brownian increments.\n\n### Analysis of the Probability of Negativity\nFirst, we derive the conditional probability $\\mathbb{P}[X_{n+1} < 0 \\mid X_n = x]$. Let $X_n = x$, where we assume $x \\ge 0$.\nIf $x=0$, the EM update equation becomes $X_{n+1} = 0 + \\kappa(\\theta - 0)\\Delta + \\sigma\\sqrt{0}\\,\\Delta W_n = \\kappa\\theta\\Delta$. Since $\\kappa > 0$, $\\theta \\ge 0$, and $\\Delta > 0$, we have $X_{n+1} \\ge 0$. Thus, $\\mathbb{P}[X_{n+1} < 0 \\mid X_n = 0] = 0$.\n\nFor $x > 0$, the condition $X_{n+1} < 0$ is equivalent to:\n$$\nx + \\kappa(\\theta - x)\\Delta + \\sigma \\sqrt{x}\\,\\Delta W_n < 0\n$$\nWe can write $\\Delta W_n = \\sqrt{\\Delta}Z$, where $Z \\sim \\mathcal{N}(0, 1)$ is a standard normal random variable. Substituting this in gives:\n$$\nx + \\kappa(\\theta - x)\\Delta + \\sigma \\sqrt{x\\Delta}\\,Z < 0\n$$\nIsolating the term with the random variable $Z$:\n$$\n\\sigma \\sqrt{x\\Delta}\\,Z < - \\left(x + \\kappa(\\theta - x)\\Delta\\right)\n$$\nSince $\\sigma>0$, $x>0$, and $\\Delta>0$, the term $\\sigma\\sqrt{x\\Delta}$ is positive, and we can divide by it without changing the inequality direction:\n$$\nZ < - \\frac{x + \\kappa(\\theta - x)\\Delta}{\\sigma\\sqrt{x\\Delta}}\n$$\nThe probability of this event is given by the cumulative distribution function (CDF) of the standard normal distribution, $\\Phi(\\cdot)$:\n$$\n\\mathbb{P}[X_{n+1} < 0 \\mid X_n = x] = \\Phi\\left(- \\frac{x + \\kappa(\\theta - x)\\Delta}{\\sigma\\sqrt{x\\Delta}}\\right)\n$$\n\n### Analysis of Small-Step Behavior\nThe problem asks to analyze two regimes as $\\Delta \\to 0$.\n\n**Regime (i): Fixed $x > 0$**\nWe examine the argument of $\\Phi$ as $\\Delta \\to 0$:\n$$\nA(\\Delta) = - \\frac{x + \\kappa(\\theta - x)\\Delta}{\\sigma\\sqrt{x\\Delta}} = - \\frac{\\sqrt{x}}{\\sigma\\sqrt{\\Delta}} - \\frac{\\kappa(\\theta-x)\\sqrt{\\Delta}}{\\sigma\\sqrt{x}}\n$$\nAs $\\Delta \\to 0$, the first term $-\\frac{\\sqrt{x}}{\\sigma\\sqrt{\\Delta}}$ dominates and $A(\\Delta) \\to -\\infty$. Consequently, $\\mathbb{P}[X_{n+1} < 0 \\mid X_n = x] = \\Phi(A(\\Delta)) \\to 0$.\n\n**Regime (ii): $x = c\\Delta$ for fixed $c > 0$**\nThis regime models the behavior of the process when it is close to the boundary at $0$, with the distance to the boundary being proportional to the step size. Substituting $x = c\\Delta$ into our probability expression:\n$$\n\\mathbb{P}[X_{n+1} < 0 \\mid X_n = c\\Delta] = \\Phi\\left(- \\frac{c\\Delta + \\kappa(\\theta - c\\Delta)\\Delta}{\\sigma\\sqrt{(c\\Delta)\\Delta}}\\right) = \\Phi\\left(- \\frac{c\\Delta + \\kappa\\theta\\Delta - \\kappa c\\Delta^2}{\\sigma\\sqrt{c}\\Delta}\\right)\n$$\nDividing the numerator and denominator of the argument by $\\Delta$:\n$$\n- \\frac{c + \\kappa\\theta - \\kappa c\\Delta}{\\sigma\\sqrt{c}}\n$$\nTaking the limit as $\\Delta \\to 0$:\n$$\n\\lim_{\\Delta\\to 0} \\left(- \\frac{c + \\kappa\\theta - \\kappa c\\Delta}{\\sigma\\sqrt{c}}\\right) = - \\frac{c + \\kappa\\theta}{\\sigma\\sqrt{c}}\n$$\nSince $\\Phi$ is a continuous function, the limit of the probability is:\n$$\n\\lim_{\\Delta\\to 0} \\mathbb{P}[X_{n+1} < 0 \\mid X_n = c\\Delta] = \\Phi\\left(- \\frac{c + \\kappa\\theta}{\\sigma\\sqrt{c}}\\right)\n$$\nThis limit is a positive constant (since $c>0, \\kappa>0, \\sigma>0$). This shows that if the process is at a distance of order $\\mathcal{O}(\\Delta)$ from the boundary, there is a non-vanishing probability that the standard EM scheme will produce a negative value, no matter how small $\\Delta$ is. This is why regime (ii) is the relevant one for characterizing the failure of the scheme at the boundary.\n\nNow, we evaluate each statement.\n\n**A. For any $\\,x>0\\,$, $\\mathbb P\\!\\left[X_{n+1}<0 \\,\\middle|\\, X_n = x\\right] \\;=\\; \\Phi\\!\\left(\\,-\\,\\frac{x + \\kappa(\\theta - x)\\,\\Delta}{\\sigma\\sqrt{x\\,\\Delta}}\\,\\right)$.**\nOur derivation above confirms this formula exactly for any $x>0$.\n**Verdict: Correct.**\n\n**B. For fixed $\\,x>0\\,$, as $\\,\\Delta\\to 0\\,$, one has $\\,\\mathbb P\\!\\left[X_{n+1}<0 \\,\\middle|\\, X_n = x\\right] = \\mathcal O(\\sqrt{\\Delta})\\,$.**\nFrom our analysis of regime (i), the argument of $\\Phi$ is $A(\\Delta) \\approx -\\frac{\\sqrt{x}}{\\sigma\\sqrt{\\Delta}}$ for small $\\Delta$. For large negative arguments $z$, the CDF has the asymptotic behavior $\\Phi(z) \\sim \\frac{1}{|z|\\sqrt{2\\pi}} e^{-z^2/2}$.\nLet $z=A(\\Delta)$. Then $|z| \\sim \\frac{\\sqrt{x}}{\\sigma\\sqrt{\\Delta}}$ and $z^2 \\sim \\frac{x}{\\sigma^2\\Delta}$.\nThe probability is thus\n$$\n\\mathbb{P}[X_{n+1}<0 \\mid X_n = x] \\sim \\frac{\\sigma\\sqrt{\\Delta}}{\\sqrt{x}\\sqrt{2\\pi}} \\exp\\left(-\\frac{x}{2\\sigma^2\\Delta}\\right)\n$$\nThe exponential term $\\exp(-K/\\Delta)$ with $K = x/(2\\sigma^2) > 0$ goes to zero faster than any power of $\\Delta$. That is, the probability is $o(\\Delta^k)$ for any $k>0$.\nA function that is $o(\\Delta)$ is technically also $\\mathcal{O}(\\sqrt{\\Delta})$, since $\\lim_{\\Delta \\to 0} \\frac{o(\\Delta)}{\\sqrt{\\Delta}} = 0$, which implies the ratio is bounded. However, in the context of asymptotic analysis, stating that a super-polynomially decaying function is $\\mathcal{O}(\\sqrt{\\Delta})$ is a profoundly uninformative and misleading statement about its rate of convergence. The actual rate is not polynomial. Such a statement mischaracterizes the behavior and is likely intended to be identified as an incorrect description of the asymptotic rate.\n**Verdict: Incorrect.**\n\n**C. If $\\,x = c\\,\\Delta\\,$ with fixed $\\,c>0\\,$, then as $\\,\\Delta\\to 0\\,$, $\\mathbb P\\!\\left[X_{n+1}<0 \\,\\middle|\\, X_n = x\\right] \\;\\longrightarrow\\; \\Phi\\!\\left(\\,-\\,\\frac{c + \\kappa\\theta}{\\sigma\\sqrt{c}}\\,\\right)$.**\nOur analysis of regime (ii) derived this exact limit.\n**Verdict: Correct.**\n\n**D. The absorption–full–truncation Euler variant ... enforces nonnegativity. Moreover, for $\\,x\\,$ bounded away from $\\,0\\,$, it preserves the first–order drift...**\nThe scheme is $X_{n+1} := \\max(Y, 0)$, where $Y = x + \\kappa(\\theta - x^+)\\Delta + \\sigma \\sqrt{x^+}\\,\\Delta W_n$ and $x^+=\\max(x,0)$.\nFirst, by taking the maximum with $0$, the resulting $X_{n+1}$ is guaranteed to be non-negative. This part is correct.\nSecond, we must analyze the conditional expectation for $x>0$ (bounded away from zero), so $x^+=x$.\nLet $Y_n = x + \\kappa(\\theta - x)\\Delta + \\sigma\\sqrt{x}\\,\\Delta W_n$. $Y_n$ is normally distributed with mean $\\mu = x + \\kappa(\\theta - x)\\Delta$ and variance $s^2 = \\sigma^2 x \\Delta$.\nThe drift of the modified scheme is $\\mathbb{E}[X_{n+1} - x \\mid X_n=x] = \\mathbb{E}[\\max(Y_n, 0)] - x$.\nWe know $\\mathbb{E}[Y_n] = \\mu$. We can write $\\max(Y_n, 0) = Y_n - Y_n^-$, where $Y_n^- = \\min(Y_n, 0)$. So $\\mathbb{E}[\\max(Y_n, 0)] = \\mu - \\mathbb{E}[Y_n^-]$. The error term is $\\mathbb{E}[Y_n^-] = \\int_{-\\infty}^0 y f_{Y_n}(y) dy$. The absolute value of this error term is bounded by $\\int_{-\\infty}^0 |y| f_{Y_n}(y) dy$.\nAs established in the analysis of option B, for fixed $x>0$, the probability of $Y_n$ being negative, $\\mathbb{P}(Y_n < 0)$, decays super-polynomially as $\\Delta \\to 0$. The integral $\\int_{-\\infty}^0 y f_{Y_n}(y) dy$ also decays super-polynomially. Therefore, $\\mathbb{E}[\\max(Y_n, 0)] = \\mu - o(\\Delta^k) = \\mu + o(\\Delta)$ for any $k>0$.\nThe drift is then:\n$$\n\\mathbb{E}[X_{n+1} - x] = \\mathbb{E}[\\max(Y_n, 0)] - x = \\left(x + \\kappa(\\theta - x)\\Delta + o(\\Delta)\\right) - x = \\kappa(\\theta - x)\\Delta + o(\\Delta)\n$$\nThis matches the expression given in the option. Thus, both claims in statement D are correct.\n**Verdict: Correct.**\n\n**E. There is an exact simulation scheme for the CIR transition over one step ...**\nThis statement describes the well-known exact simulation method for the CIR process. Conditional on $X_t=x$, the exact distribution of $X_{t+\\Delta}$ is that of a scaled non-central chi-squared random variable, $X_{t+\\Delta} \\sim c \\cdot \\chi'^2_d(\\lambda)$. The parameters provided in the option are:\n- Scaling factor: $c = \\frac{\\sigma^2\\big(1 - e^{-\\kappa \\Delta}\\big)}{4\\kappa}$\n- Degrees of freedom: $d = \\frac{4\\kappa\\theta}{\\sigma^2}$\n- Non-centrality parameter: $\\lambda = \\frac{4\\kappa e^{-\\kappa \\Delta}}{\\sigma^2\\big(1 - e^{-\\kappa \\Delta}\\big)}\\,x$\nThese are the standard, correct parameters as found in the literature on mathematical finance and stochastic processes. A non-central chi-squared variable is a sum of squares of normal variables, so it is almost surely non-negative. A positive scaling constant $c$ preserves this property. Thus, this scheme guarantees non-negativity and perfectly reproduces the transition law of the CIR process.\n**Verdict: Correct.**", "answer": "$$\\boxed{ACDE}$$", "id": "2969007"}, {"introduction": "The ultimate test of a financial model is its ability to align with observed market data. This exercise presents a crucial thought experiment that pits the theoretical structure of the CIR model against the modern reality of negative interest rates [@problem_id:2370035]. By analyzing a calibration attempt to a yield curve with negative values, you will explore the fundamental limitations of the model and develop a deeper intuition for model risk and the importance of matching a model's core assumptions with the economic environment it aims to describe.", "problem": "Consider calibrating a one-factor Cox–Ingersoll–Ross (CIR) model for the short rate under the risk-neutral measure to a cross-section of zero-coupon yields that includes negative observations. Under the risk-neutral measure $\\mathbb{Q}$, the short rate $r_t$ follows\n$$\ndr_t \\;=\\; \\kappa\\,(\\theta - r_t)\\,dt \\;+\\; \\sigma\\,\\sqrt{r_t}\\,dW_t,\n$$\nwith parameters $\\kappa>0$, $\\sigma>0$, and $\\theta$ not constrained a priori by the optimizer. The price of a zero-coupon bond with maturity $T$ is given by the fundamental no-arbitrage pricing relation\n$$\nP(0,T) \\;=\\; \\mathbb{E}^{\\mathbb{Q}}\\!\\left[\\exp\\!\\left(-\\int_{0}^{T} r_s\\,ds\\right)\\right],\n$$\nand the continuously compounded model yield is $y^{\\text{model}}(0,T) \\equiv -\\frac{1}{T}\\ln P(0,T)$. You observe market yields $\\{y^{\\text{mkt}}(0,T_i)\\}_{i=1}^n$ with some $y^{\\text{mkt}}(0,T_j) < 0$ for certain maturities $T_j$, and you estimate parameters by minimizing a weighted least-squares objective\n$$\n\\min_{\\kappa,\\theta,\\sigma,r_0}\\;\\; \\sum_{i=1}^n w_i\\,\\big(y^{\\text{model}}(0,T_i) - y^{\\text{mkt}}(0,T_i)\\big)^2,\n$$\nwith given positive weights $w_i>0$. During calibration you do not impose the Feller condition $2\\kappa\\theta \\ge \\sigma^2$.\n\nWhich statement best characterizes the expected behavior of this calibration and the role of the Feller condition in this setting?\n\nA. By choosing $\\theta<0$, the calibration can make $r_t$ negative with positive probability when $2\\kappa\\theta<\\sigma^2$, enabling exact matching of negative market yields and driving the objective to $0$.\n\nB. If the optimizer is unconstrained with respect to the Feller condition, it may select parameters with $2\\kappa\\theta<\\sigma^2$ to gain flexibility in curve shape, yet the model still cannot produce negative risk-neutral yields; consequently, residuals for negative-yield maturities remain systematically positive and the least-squares objective cannot reach $0$.\n\nC. Enforcing the Feller condition guarantees the ability to match negative market yields because it ensures strictly positive bond prices, which in turn allows negative logarithmic yields.\n\nD. The least-squares objective is convex in the CIR parameters due to affine pricing, so even with negative market yields the optimizer attains a unique global minimum with zero error unless the Feller condition is enforced, in which case nonconvexity appears and fitting worsens.\n\nE. Violating the Feller condition makes the transition density undefined and bond prices ill-posed, so the calibration necessarily fails numerically whenever the market curve contains negative yields.", "solution": "The problem statement must first be subjected to rigorous validation before any attempt at a solution is made.\n\n### Step 1: Extract Givens\nThe problem provides the following information:\n- The short rate process $r_t$ under the risk-neutral measure $\\mathbb{Q}$ is modeled by the Cox–Ingersoll–Ross (CIR) stochastic differential equation:\n$$dr_t = \\kappa(\\theta - r_t)\\,dt + \\sigma\\sqrt{r_t}\\,dW_t$$\n- Parameter constraints specified initially: $\\kappa > 0$, $\\sigma > 0$. The parameter $\\theta$ is not constrained a priori.\n- The price of a zero-coupon bond is given by the risk-neutral expectation:\n$$P(0,T) = \\mathbb{E}^{\\mathbb{Q}}\\!\\left[\\exp\\!\\left(-\\int_{0}^{T} r_s\\,ds\\right)\\right]$$\n- The continuously compounded model yield is defined as:\n$$y^{\\text{model}}(0,T) \\equiv -\\frac{1}{T}\\ln P(0,T)$$\n- Market data consists of a set of observed yields $\\{y^{\\text{mkt}}(0,T_i)\\}_{i=1}^n$, where for at least one maturity $T_j$, the yield is negative: $y^{\\text{mkt}}(0,T_j) < 0$.\n- The calibration procedure is to minimize a weighted sum of squared errors:\n$$\\min_{\\kappa,\\theta,\\sigma,r_0}\\;\\; \\sum_{i=1}^n w_i\\,\\big(y^{\\text{model}}(0,T_i) - y^{\\text{mkt}}(0,T_i)\\big)^2$$\n- The weights are positive: $w_i > 0$.\n- The Feller condition, $2\\kappa\\theta \\ge \\sigma^2$, is explicitly not enforced during the optimization.\n\n### Step 2: Validate Using Extracted Givens\nThe problem statement is analyzed for validity.\n1.  **Scientifically Grounded**: The CIR model is a canonical model in financial mathematics for interest rate dynamics. The bond pricing formula is the fundamental theorem of asset pricing. The concept of calibrating a model to market data, including the challenge posed by negative interest rates, is a standard and important problem in quantitative finance. The Feller condition and its implications are well-established theoretical results. The problem is firmly grounded in established financial theory.\n2.  **Well-Posed**: The problem asks to characterize the behavior of a defined optimization procedure under specific conditions. It is a conceptual question about the properties of the CIR model and its limitations when faced with certain market data. The question is structured to have a a discernible answer based on the mathematical properties of the model.\n3.  **Objective**: The language is technical, precise, and free of subjective or ambiguous terminology.\n4.  **Consistency and Completeness**: The problem provides all necessary definitions (SDE, pricing, yield) and specifies the data characteristics (negative yields) and the setup of the calibration (objective function, unconstrained Feller condition). There are no internal contradictions.\n\n### Step 3: Verdict and Action\nThe problem statement is valid. It is a well-formulated question in computational finance regarding the properties and practical limitations of the CIR model. A solution can be derived.\n\n### Derivation and Analysis\n\nThe core of the problem lies in the fundamental properties of the short-rate process $r_t$ as defined by the CIR model. The stochastic differential equation is $dr_t = \\kappa(\\theta - r_t)\\,dt + \\sigma\\sqrt{r_t}\\,dW_t$. A critical feature of this process, which follows from the square-root term $\\sqrt{r_t}$, is the behavior at the boundary $r_t = 0$.\n\nFor any initial state $r_0 \\ge 0$, the CIR process $r_t$ remains non-negative for all $t > 0$ almost surely. That is, $r_t \\ge 0$ for all $t \\ge 0$. The $\\sqrt{r_t}$ term is only defined for non-negative $r_t$ in the domain of real numbers, and the dynamics of the process prevent it from becoming negative. The Feller condition, $2\\kappa\\theta \\ge \\sigma^2$, determines whether the process can reach the zero boundary. If $2\\kappa\\theta \\ge \\sigma^2$, the process is strictly positive, $r_t > 0$, for all $t > 0$ (assuming $r_0 > 0$). If $2\\kappa\\theta < \\sigma^2$, the process can reach $r_t=0$ with positive probability, but it does not cross into negative territory.\n\nGiven that the short rate $r_s$ is always non-negative for $s \\in [0, T]$, the integrated short rate must also be non-negative:\n$$ \\int_{0}^{T} r_s\\,ds \\ge 0 $$\nConsequently, its negated exponential is bounded:\n$$ 0 < \\exp\\left(-\\int_{0}^{T} r_s\\,ds\\right) \\le 1 $$\nThe price of the zero-coupon bond, being the expectation of this quantity, must also lie within this range (or a sub-interval of it):\n$$ P(0,T) = \\mathbb{E}^{\\mathbb{Q}}\\!\\left[\\exp\\!\\left(-\\int_{0}^{T} r_s\\,ds\\right)\\right] \\in (0, 1] $$\nA bond price of $P(0,T) > 1$ is impossible within the standard CIR framework, as it would imply the possibility of negative interest rates.\n\nThe model yield is given by $y^{\\text{model}}(0,T) = -\\frac{1}{T}\\ln P(0,T)$. Since $0 < P(0,T) \\le 1$, the natural logarithm $\\ln P(0,T)$ must be less than or equal to zero. Therefore, the model yield must be non-negative:\n$$ y^{\\text{model}}(0,T) = -\\frac{1}{T}\\ln P(0,T) \\ge 0 $$\nThis is a fundamental limitation of the CIR model: it cannot generate negative yields.\n\nThe calibration problem attempts to minimize the sum of squared errors between model yields and market yields. The market data is stated to include negative yields, $y^{\\text{mkt}}(0,T_j) < 0$ for some $j$. For these maturities, we have:\n- Model yield: $y^{\\text{model}}(0,T_j) \\ge 0$\n- Market yield: $y^{\\text{mkt}}(0,T_j) < 0$\nThe residual (error) for such a maturity is $y^{\\text{model}}(0,T_j) - y^{\\text{mkt}}(0,T_j)$, which is the difference between a non-negative number and a negative number. This difference is strictly positive. The squared error, $w_j(y^{\\text{model}}(0,T_j) - y^{\\text{mkt}}(0,T_j))^2$, is therefore strictly positive. Since at least one term in the sum-of-squares objective function is strictly positive, the total objective function value can never be zero. The optimization will find a minimum with a non-zero error.\n\nThe role of the Feller condition: The problem states the optimizer does not enforce $2\\kappa\\theta \\ge \\sigma^2$. This means the optimizer is free to choose parameters such that $2\\kappa\\theta < \\sigma^2$. This condition gives the process $r_t$ a higher propensity to be near zero. Permitting the rate to touch zero allows for more curvature and flexibility in the shape of the yield curve, particularly at the short end. An unconstrained optimizer, seeking to minimize the error, might select parameters that violate the Feller condition if doing so allows the model yields to get closer to the very low (or in this case, negative) market yields, thereby reducing the overall objective function value. However, this flexibility does not overcome the fundamental barrier: the model yields remain non-negative.\n\nNow we evaluate the given options.\n\n**A. By choosing $\\theta<0$, the calibration can make $r_t$ negative with positive probability when $2\\kappa\\theta<\\sigma^2$, enabling exact matching of negative market yields and driving the objective to $0$.**\nThis statement is fundamentally incorrect. The CIR process $r_t$ is constructed to be non-negative. Even if $\\theta < 0$, which makes the long-term mean negative and creates a downward drift, the process is contained in $[0, \\infty)$. The square-root diffusion term ensures this. Therefore, $r_t$ cannot become negative, model yields cannot be negative, and the objective function cannot be driven to $0$. **Incorrect**.\n\n**B. If the optimizer is unconstrained with respect to the Feller condition, it may select parameters with $2\\kappa\\theta<\\sigma^2$ to gain flexibility in curve shape, yet the model still cannot produce negative risk-neutral yields; consequently, residuals for negative-yield maturities remain systematically positive and the least-squares objective cannot reach $0$.**\nThis statement aligns perfectly with the derivation above.\n1. The optimizer may choose parameters violating the Feller condition ($2\\kappa\\theta<\\sigma^2$) to achieve a better fit, which is a known behavior in CIR calibration. This provides more flexibility.\n2. The model fundamentally cannot produce negative yields ($y^{\\text{model}} \\ge 0$).\n3. When $y^{\\text{mkt}} < 0$, the residual $y^{\\text{model}} - y^{\\text{mkt}}$ is systematically positive.\n4. The presence of at least one such maturity ensures the sum-of-squares objective is strictly positive at its minimum.\nThis statement is a precise and complete description of the situation. **Correct**.\n\n**C. Enforcing the Feller condition guarantees the ability to match negative market yields because it ensures strictly positive bond prices, which in turn allows negative logarithmic yields.**\nThis statement is internally contradictory and factually wrong. Ensuring strictly positive bond prices, $P(0,T) > 0$, is a property of the model regardless of the Feller condition. A negative yield, $y^{\\text{model}}(0,T) < 0$, requires $\\ln P(0,T) > 0$, which means $P(0,T) > 1$. The model, with or without the Feller condition, ensures $P(0,T) \\le 1$. The reasoning presented is illogical. **Incorrect**.\n\n**D. The least-squares objective is convex in the CIR parameters due to affine pricing, so even with negative market yields the optimizer attains a unique global minimum with zero error unless the Feller condition is enforced, in which case nonconvexity appears and fitting worsens.**\nThis statement contains multiple falsehoods.\n1. The objective function is highly non-convex with respect to the CIR parameters $(\\kappa, \\theta, \\sigma)$. Although the yield is affine in the state $r_0$, the coefficients of this affine function are complex non-linear functions of the parameters, which induces non-convexity in the calibration problem.\n2. We have established that the error cannot be zero if there are negative market yields.\n3. The non-convexity is inherent to the problem and is not \"introduced\" by the Feller condition constraint.\nThis statement demonstrates a grave misunderstanding of both optimization theory and affine models. **Incorrect**.\n\n**E. Violating the Feller condition makes the transition density undefined and bond prices ill-posed, so the calibration necessarily fails numerically whenever the market curve contains negative yields.**\nThis statement is incorrect. The mathematical theory of the CIR process is well-defined even when the Feller condition is violated. The transition density is known (it is related to a non-central chi-squared distribution), and bond pricing formulas remain valid and well-posed. The calibration does not \"fail numerically\" in the sense of a mathematical breakdown; it succeeds in finding a best-fit, albeit an imperfect one, because of the model's structural inability to generate negative yields. The problem is one of model misfit, not ill-posedness. **Incorrect**.", "answer": "$$\\boxed{B}$$", "id": "2370035"}]}