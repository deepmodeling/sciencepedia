{"hands_on_practices": [{"introduction": "This first practice is a foundational exercise in applying the multivariate Itô's formula to a common and important class of functions: time-dependent quadratic forms. Mastering this calculation is crucial for analyzing the dynamics of systems described by linear SDEs, which are central to models in finance and control theory. This problem reinforces the interplay between stochastic calculus and matrix calculus, particularly the handling of gradient, Hessian, and trace terms. [@problem_id:2981911]", "problem": "Let $(\\Omega,\\mathcal{F},(\\mathcal{F}_{t})_{t \\ge 0},\\mathbb{P})$ be a filtered probability space supporting a standard $m$-dimensional Brownian motion (BM) $W_{t}$. Consider the $n$-dimensional Itô process $X_{t}$ defined as the unique strong solution to the linear stochastic differential equation (SDE)\n$$\n\\mathrm{d}X_{t} \\;=\\; M(t)\\,X_{t}\\,\\mathrm{d}t \\;+\\; \\Sigma(t)\\,\\mathrm{d}W_{t}, \\quad X_{0} \\in \\mathbb{R}^{n},\n$$\nwhere $M:[0,\\infty)\\to\\mathbb{R}^{n\\times n}$ and $\\Sigma:[0,\\infty)\\to\\mathbb{R}^{n\\times m}$ are continuous matrix-valued functions. Let $A:[0,\\infty)\\to\\mathbb{R}^{n\\times n}$ be continuously differentiable with $A(t)$ symmetric for each $t$, and let $b:[0,\\infty)\\to\\mathbb{R}^{n}$ and $c:[0,\\infty)\\to\\mathbb{R}$ be continuously differentiable. Define the time-dependent quadratic-bilinear functional $f:[0,\\infty)\\times\\mathbb{R}^{n}\\to\\mathbb{R}$ by\n$$\nf(t,x) \\;=\\; x^{\\top}A(t)\\,x \\;+\\; 2\\,b(t)^{\\top}x \\;+\\; c(t).\n$$\nUsing only foundational principles for stochastic calculus and matrix calculus, determine the instantaneous drift rate of the scalar process $f(t,X_{t})$, namely the coefficient of $\\mathrm{d}t$ in the Itô differential $\\mathrm{d}\\big(f(t,X_{t})\\big)$, expressed as a function of the current time $t$ and a generic state $x\\in\\mathbb{R}^{n}$. Your final answer must be a single closed-form analytic expression in terms of $t$, $x$, $A(t)$, $A'(t)$, $b(t)$, $b'(t)$, $c'(t)$, $M(t)$, and $\\Sigma(t)$. Do not provide any intermediate steps or equalities in the final answer.", "solution": "The problem is valid as it represents a standard, well-posed application of stochastic calculus, specifically Itô's lemma for a time-dependent function of a multivariate Itô process. All terms are clearly defined, and the required conditions for the application of the lemma are satisfied.\n\nThe objective is to find the drift term of the process $Y_{t} = f(t, X_{t})$, where $f(t,x) = x^{\\top}A(t)\\,x + 2\\,b(t)^{\\top}x + c(t)$ and $X_t$ is an Itô process governed by the stochastic differential equation (SDE) $\\mathrm{d}X_{t} = M(t)\\,X_{t}\\,\\mathrm{d}t + \\Sigma(t)\\,\\mathrm{d}W_{t}$.\n\nThe fundamental tool for this derivation is the multivariate Itô's lemma for a function $f(t,x): [0, \\infty) \\times \\mathbb{R}^n \\to \\mathbb{R}$ that is once continuously differentiable in time $t$ and twice continuously differentiable in the state variable $x$. For a process $X_t$ with drift $\\mu(t, X_t)$ and diffusion $\\sigma(t, X_t)$, the differential of $f(t, X_t)$ is given by:\n$$\n\\mathrm{d}f(t, X_{t}) = \\frac{\\partial f}{\\partial t}\\mathrm{d}t + (\\nabla_{x}f)^{\\top}\\mathrm{d}X_{t} + \\frac{1}{2}\\operatorname{Tr}\\left(\\sigma(t, X_t)\\sigma(t, X_t)^{\\top} H_{x}f\\right)\\mathrm{d}t\n$$\nwhere $\\nabla_{x}f$ is the gradient vector of $f$ with respect to $x$, and $H_{x}f$ is the Hessian matrix of $f$ with respect to $x$.\n\nThe drift rate of the process $f(t, X_{t})$ is the collection of all terms proportional to $\\mathrm{d}t$. By substituting $\\mathrm{d}X_{t} = \\mu(t, X_{t})\\,\\mathrm{d}t + \\sigma(t, X_{t})\\,\\mathrm{d}W_{t}$ into the lemma, we can identify the drift component:\n$$\n\\text{Drift Term} = \\frac{\\partial f}{\\partial t} + (\\nabla_{x}f)^{\\top}\\mu(t, X_t) + \\frac{1}{2}\\operatorname{Tr}\\left(\\sigma(t, X_t)\\sigma(t, X_t)^{\\top} H_{x}f\\right)\n$$\nThe problem asks for this expression as a function of time $t$ and a generic state $x \\in \\mathbb{R}^n$.\n\nFirst, we identify the components from the problem statement:\n- The drift of $X_t$ is $\\mu(t, x) = M(t)x$.\n- The diffusion of $X_t$ is $\\sigma(t, x) = \\Sigma(t)$.\n- The function is $f(t,x) = x^{\\top}A(t)\\,x + 2\\,b(t)^{\\top}x + c(t)$.\n\nNext, we compute the required partial derivatives of $f(t,x)$:\n1.  **Partial derivative with respect to time $t$**:\n    Using the product rule for differentiation on each term, we obtain:\n    $$\n    \\frac{\\partial f}{\\partial t}(t,x) = x^{\\top}A'(t)x + 2b'(t)^{\\top}x + c'(t)\n    $$\n    where $A'(t) = \\frac{\\mathrm{d}A}{\\mathrm{d}t}$, $b'(t) = \\frac{\\mathrm{d}b}{\\mathrm{d}t}$, and $c'(t) = \\frac{\\mathrm{d}c}{\\mathrm{d}t}$.\n\n2.  **Gradient with respect to state $x$**:\n    We use standard matrix calculus identities $\\nabla_x(x^{\\top}Qx) = (Q+Q^{\\top})x$ and $\\nabla_x(v^{\\top}x) = v$. Since $A(t)$ is given as symmetric ($A(t) = A(t)^{\\top}$), the gradient is:\n    $$\n    \\nabla_{x}f(t,x) = \\nabla_{x}(x^{\\top}A(t)x) + \\nabla_{x}(2b(t)^{\\top}x) + \\nabla_{x}(c(t)) = 2A(t)x + 2b(t) + 0 = 2(A(t)x + b(t))\n    $$\n\n3.  **Hessian matrix with respect to state $x$**:\n    The Hessian matrix is the matrix of second partial derivatives, $H_x f = \\nabla_x ((\\nabla_x f)^{\\top})$. Differentiating the gradient with respect to $x^{\\top}$ yields:\n    $$\n    H_{x}f(t,x) = \\nabla_{x}\\left( (2A(t)x + 2b(t))^{\\top} \\right) = 2A(t)\n    $$\n    The Hessian is simply $2A(t)$, which is constant with respect to $x$.\n\nNow, we substitute these derivatives and the process coefficients into the drift formula:\n$$\n\\text{Drift}(t,x) = \\left(x^{\\top}A'(t)x + 2b'(t)^{\\top}x + c'(t)\\right) + \\left(2(A(t)x + b(t))\\right)^{\\top}(M(t)x) + \\frac{1}{2}\\operatorname{Tr}\\left(\\Sigma(t)\\Sigma(t)^{\\top}(2A(t))\\right)\n$$\nLet's expand and simplify each component of this expression:\n- The first term is the time derivative: $x^{\\top}A'(t)x + 2b'(t)^{\\top}x + c'(t)$.\n- The second term involves the gradient and the drift of $X_t$:\n$$\n(2(A(t)x + b(t)))^{\\top}(M(t)x) = 2(x^{\\top}A(t)^{\\top} + b(t)^{\\top})(M(t)x)\n$$\nSince $A(t)$ is symmetric, $A(t)^{\\top}=A(t)$. Distributing $M(t)x$ gives:\n$$\n2(x^{\\top}A(t) + b(t)^{\\top})(M(t)x) = 2x^{\\top}A(t)M(t)x + 2b(t)^{\\top}M(t)x\n$$\n- The third term is the Itô correction term:\n$$\n\\frac{1}{2}\\operatorname{Tr}\\left(\\Sigma(t)\\Sigma(t)^{\\top}(2A(t))\\right) = \\operatorname{Tr}\\left(\\Sigma(t)\\Sigma(t)^{\\top}A(t)\\right)\n$$\nSumming these three components gives the total drift rate:\n$$\n\\text{Drift}(t,x) = x^{\\top}A'(t)x + 2b'(t)^{\\top}x + c'(t) + 2x^{\\top}A(t)M(t)x + 2b(t)^{\\top}M(t)x + \\operatorname{Tr}\\left(\\Sigma(t)\\Sigma(t)^{\\top}A(t)\\right)\n$$\nTo present this in a more structured form, we can group the terms that are quadratic in $x$, linear in $x$, and constant with respect to $x$.\n- **Quadratic term**: $x^{\\top}A'(t)x + 2x^{\\top}A(t)M(t)x$. A quadratic form $v^{\\top}Qv$ can always be written with a symmetric matrix by using $v^{\\top}(\\frac{Q+Q^{\\top}}{2})v$. Thus, $2x^{\\top}A(t)M(t)x = x^{\\top}(A(t)M(t) + (A(t)M(t))^{\\top})x = x^{\\top}(A(t)M(t) + M(t)^{\\top}A(t)^{\\top})x$. Since $A(t)$ is symmetric, this becomes $x^{\\top}(A(t)M(t) + M(t)^{\\top}A(t))x$. The total quadratic part is $x^{\\top}\\left(A'(t) + A(t)M(t) + M(t)^{\\top}A(t)\\right)x$.\n- **Linear term**: $2b'(t)^{\\top}x + 2b(t)^{\\top}M(t)x$. This can be written as $2(b'(t)^{\\top} + b(t)^{\\top}M(t))x = 2(b'(t) + M(t)^{\\top}b(t))^{\\top}x$.\n- **Constant term**: $c'(t) + \\operatorname{Tr}\\left(\\Sigma(t)\\Sigma(t)^{\\top}A(t)\\right)$. Using the cyclic property of the trace, this is also $\\operatorname{Tr}\\left(A(t)\\Sigma(t)\\Sigma(t)^{\\top}\\right)$.\n\nCombining these grouped terms yields the final expression for the instantaneous drift rate.", "answer": "$$\n\\boxed{x^{\\top}\\left(A'(t) + A(t)M(t) + M(t)^{\\top}A(t)\\right)x + 2\\left(b'(t) + M(t)^{\\top}b(t)\\right)^{\\top}x + c'(t) + \\operatorname{Tr}\\left(A(t)\\Sigma(t)\\Sigma(t)^{\\top}\\right)}\n$$", "id": "2981911"}, {"introduction": "Moving beyond direct computation, this exercise demonstrates a powerful conceptual use of Itô's formula: connecting stochastic processes to partial differential equations (PDEs). You will construct a specific martingale to find the Laplace transform of a stopping time, a fundamental quantity in risk theory and option pricing. This practice is key to understanding the Feynman-Kac theorem and the role of martingales in solving boundary value problems. [@problem_id:2981913]", "problem": "Consider a complete filtered probability space $(\\Omega,\\mathcal{F},(\\mathcal{F}_t)_{t \\ge 0},\\mathbb{P})$ supporting a one-dimensional standard Brownian motion $W=(W_t)_{t \\ge 0}$, and fix real numbers $a<b$ and an initial point $x \\in (a,b)$. Define the diffusion $X=(X_t)_{t \\ge 0}$ by $X_t = x + W_t$, and the first exit time (a stopping time with respect to $(\\mathcal{F}_t)_{t \\ge 0}$) by\n$$\n\\tau := \\inf\\{t \\ge 0 : X_t \\notin (a,b)\\}.\n$$\nLet $\\lambda>0$ be fixed. Relying only on foundational definitions and properties of Brownian motion, and without invoking any pre-stated transformation formulas, construct a time-dependent function whose composition with $X$ yields a martingale up to the stopping time $\\tau$. Carefully justify the boundary behavior of $X$ at $\\tau$ and the conditions required to apply the Optional Stopping Theorem (OST). Use these ingredients to derive a boundary value problem and solve it to obtain a closed-form analytic expression for the Laplace transform of the stopping time,\n$$\nL(x) := \\mathbb{E}_x\\!\\left[\\exp(-\\lambda \\tau)\\right],\n$$\nexpressed explicitly in terms of $a$, $b$, $x$, and $\\lambda$. Your final answer must be a single closed-form expression. No numerical rounding is required.", "solution": "The problem statement is a well-posed and standard problem in the theory of stochastic differential equations. It is scientifically grounded, self-contained, and all terms are formally defined. We may therefore proceed with the solution.\n\nOur objective is to find a closed-form expression for the Laplace transform of the first exit time $\\tau$ of the process $X_t = x + W_t$ from the interval $(a,b)$. This quantity is defined as $L(x) := \\mathbb{E}_x[\\exp(-\\lambda \\tau)]$, where $\\mathbb{E}_x$ denotes expectation conditional on $X_0 = x$. The problem requires us to derive this by first constructing a specific martingale and then applying the Optional Stopping Theorem (OST).\n\nLet us propose a time-dependent function of the form $f(t,z) = \\exp(-\\lambda t)g(z)$ for some yet-to-be-determined twice-differentiable function $g(z)$. We want to find the condition on $g$ such that the process $M_t := f(t, X_t) = \\exp(-\\lambda t)g(X_t)$ is a martingale with respect to the filtration $(\\mathcal{F}_t)_{t \\ge 0}$.\n\nThe process $X_t$ has dynamics $dX_t = dW_t$. To find the dynamics of $M_t$, we apply Itô's formula for a time-dependent function $f(t,z)$. The differential $df(t, X_t)$ is given by:\n$$\ndf(t,X_t) = \\frac{\\partial f}{\\partial t}(t,X_t) dt + \\frac{\\partial f}{\\partial z}(t,X_t) dX_t + \\frac{1}{2}\\frac{\\partial^2 f}{\\partial z^2}(t,X_t) (dX_t)^2\n$$\nThe partial derivatives of $f(t,z) = \\exp(-\\lambda t)g(z)$ are:\n$$\n\\frac{\\partial f}{\\partial t}(t,z) = -\\lambda \\exp(-\\lambda t)g(z)\n$$\n$$\n\\frac{\\partial f}{\\partial z}(t,z) = \\exp(-\\lambda t)g'(z)\n$$\n$$\n\\frac{\\partial^2 f}{\\partial z^2}(t,z) = \\exp(-\\lambda t)g''(z)\n$$\nUsing the Itô calculus rule $(dX_t)^2 = (dW_t)^2 = dt$, we substitute these into the formula for the differential:\n$$\ndM_t = \\left(-\\lambda \\exp(-\\lambda t)g(X_t)\\right)dt + \\left(\\exp(-\\lambda t)g'(X_t)\\right)dW_t + \\frac{1}{2}\\left(\\exp(-\\lambda t)g''(X_t)\\right)dt\n$$\nGrouping the $dt$ and $dW_t$ terms, we get the stochastic differential equation for $M_t$:\n$$\ndM_t = \\exp(-\\lambda t) \\left( \\frac{1}{2}g''(X_t) - \\lambda g(X_t) \\right) dt + \\exp(-\\lambda t)g'(X_t) dW_t\n$$\nFor $M_t$ to be a (local) martingale, its drift term (the part multiplying $dt$) must be zero. Since this must hold for all $t \\ge 0$ and all possible values of $X_t$, this imposes the following condition on the function $g(z)$:\n$$\n\\frac{1}{2}g''(z) - \\lambda g(z) = 0 \\quad \\text{for } z \\in (a,b)\n$$\nThis simplifies to the second-order ordinary differential equation (ODE):\n$$\ng''(z) - 2\\lambda g(z) = 0\n$$\nNow, let $L(x)$ be the function we aim to determine. We will show that $L(x)$ satisfies this ODE along with specific boundary conditions. Let us choose the function $g$ to be $L$ itself, and we will impose boundary conditions on $g$ that will facilitate the calculation of $L(x)$. Specifically, let us seek a solution $g(z)$ to the ODE above on $(a,b)$ subject to the boundary conditions $g(a) = 1$ and $g(b) = 1$.\n\nLet $g(z)$ be the unique solution to this boundary value problem. The process $M_t = \\exp(-\\lambda t)g(X_t)$ is a martingale. We now apply the Optional Stopping Theorem to the stopped martingale $M_{t \\land \\tau}$. The OST states that $\\mathbb{E}_x[M_\\tau] = \\mathbb{E}_x[M_0]$ if certain conditions are met. Let's verify them:\n1.  $\\tau$ must be an almost surely finite stopping time. For a one-dimensional standard Brownian motion starting at $x \\in (a,b)$, the time to exit the finite interval $(a,b)$ is almost surely finite.\n2.  The stopped process must be uniformly integrable, or we can use simpler conditions. For instance, if $|M_{t \\land \\tau}|$ is bounded by an integrable random variable, OST applies. At the stopping time $\\tau$, by the continuity of Brownian paths, $X_\\tau$ must lie on the boundary, i.e., $X_\\tau \\in \\{a,b\\}$ almost surely. Our choice of $g$ has $g(a)=1$ and $g(b)=1$, so $g(X_\\tau)=1$ almost surely. The function $g$ is continuous on the compact interval $[a,b]$ and therefore bounded. Let $K = \\sup_{z\\in[a,b]} |g(z)|$. Then for any $t \\ge 0$, $|M_{t \\land \\tau}| = |\\exp(-\\lambda(t \\land \\tau)) g(X_{t \\land \\tau})| \\le K$ since $\\lambda > 0$ and $t \\land \\tau \\ge 0$. Since $M_{t \\land \\tau}$ is uniformly bounded, it is uniformly integrable, and the OST applies.\n\nApplying the OST, we have:\n$$\n\\mathbb{E}_x[M_\\tau] = \\mathbb{E}_x[M_0]\n$$\nThe value at time $t=0$ is $M_0 = \\exp(-\\lambda \\cdot 0)g(X_0) = g(x)$.\nThe value at the stopping time $\\tau$ is $M_\\tau = \\exp(-\\lambda \\tau)g(X_\\tau)$.\nTherefore, the OST gives:\n$$\ng(x) = \\mathbb{E}_x[\\exp(-\\lambda \\tau)g(X_\\tau)]\n$$\nAs established, the continuity of paths implies $X_\\tau \\in \\{a,b\\}$ a.s. By our construction of $g$, we have $g(a)=1$ and $g(b)=1$, which means $g(X_\\tau)=1$ a.s. Substituting this into the equation gives:\n$$\ng(x) = \\mathbb{E}_x[\\exp(-\\lambda \\tau) \\cdot 1] = \\mathbb{E}_x[\\exp(-\\lambda \\tau)]\n$$\nThis is precisely the definition of $L(x)$. Thus, the function we seek, $L(x)$, is the solution to the boundary value problem:\n$$\n\\begin{cases}\nL''(x) - 2\\lambda L(x) = 0, & x \\in (a,b) \\\\\nL(a) = 1 \\\\\nL(b) = 1\n\\end{cases}\n$$\nWe now solve this BVP. The characteristic equation of the ODE is $r^2 - 2\\lambda = 0$, which has roots $r = \\pm\\sqrt{2\\lambda}$. Let $\\alpha = \\sqrt{2\\lambda}$. The general solution of the ODE is $L(x) = C_1 \\exp(\\alpha x) + C_2 \\exp(-\\alpha x)$. An equivalent and more convenient basis for the solution space is given by hyperbolic sine functions centered at the boundaries: $L(x) = A \\sinh(\\alpha(b-x)) + B \\sinh(\\alpha(x-a))$. This form is a linear combination of solutions and thus also a solution.\n\nWe apply the boundary conditions to find the constants $A$ and $B$:\nAt $x=a$:\n$$\nL(a) = A \\sinh(\\alpha(b-a)) + B \\sinh(\\alpha(a-a)) = A \\sinh(\\alpha(b-a)) + B \\sinh(0) = 1\n$$\nThis gives $A \\sinh(\\alpha(b-a)) = 1$, so $A = \\frac{1}{\\sinh(\\alpha(b-a))}$.\nAt $x=b$:\n$$\nL(b) = A \\sinh(\\alpha(b-b)) + B \\sinh(\\alpha(b-a)) = A \\sinh(0) + B \\sinh(\\alpha(b-a)) = 1\n$$\nThis gives $B \\sinh(\\alpha(b-a)) = 1$, so $B = \\frac{1}{\\sinh(\\alpha(b-a))}$.\nThus, we find $A=B$. Substituting these constants back into the solution form:\n$$\nL(x) = \\frac{1}{\\sinh(\\alpha(b-a))} \\sinh(\\alpha(b-x)) + \\frac{1}{\\sinh(\\alpha(b-a))} \\sinh(\\alpha(x-a))\n$$\n$$\nL(x) = \\frac{\\sinh(\\alpha(b-x)) + \\sinh(\\alpha(x-a))}{\\sinh(\\alpha(b-a))}\n$$\nFinally, we substitute $\\alpha = \\sqrt{2\\lambda}$ back to obtain the expression in terms of the given parameters:\n$$\nL(x) = \\frac{\\sinh(\\sqrt{2\\lambda}(b-x)) + \\sinh(\\sqrt{2\\lambda}(x-a))}{\\sinh(\\sqrt{2\\lambda}(b-a))}\n$$\nThis is the closed-form analytic expression for the Laplace transform of the stopping time $\\tau$.", "answer": "$$\\boxed{\\frac{\\sinh(\\sqrt{2\\lambda}(b-x)) + \\sinh(\\sqrt{2\\lambda}(x-a))}{\\sinh(\\sqrt{2\\lambda}(b-a))}}$$", "id": "2981913"}, {"introduction": "This final practice bridges the gap between the abstract theory of Itô calculus and its practical application in numerical simulations. By deriving a key term in an Itô-Taylor expansion, you will see how Itô's formula is the engine behind numerical schemes for solving SDEs, such as the Milstein method. This exercise illuminates the origin of higher-order correction terms that are essential for accurate computational modeling. [@problem_id:2981909]", "problem": "Consider the scalar stochastic differential equation (SDE)\n$$\n\\mathrm{d}X_{t} \\;=\\; a(t,X_{t})\\,\\mathrm{d}t \\;+\\; b(t,X_{t})\\,\\mathrm{d}W_{t},\n$$\ndriven by a standard one-dimensional Brownian motion $W_{t}$, where the drift and diffusion coefficients are\n$$\na(t,x) \\;=\\; \\sin(t)\\,x^{3} \\;+\\; t^{2}, \n\\qquad \nb(t,x) \\;=\\; \\exp(t)\\,\\cos(x).\n$$\nLet $\\Delta>0$ be small, and fix a time $t$ with state $X_{t}=x$. Using only the Itô formula for time-dependent functions $f(t,X_{t})$ (with $f\\in C^{1,2}$) as the fundamental starting point, perform an Itô–Taylor expansion of $X_{t+\\Delta}$ about $(t,x)$ up to terms whose mean-square order does not exceed $\\Delta$. In this expansion, an iterated stochastic integral of the form\n$$\n\\int_{t}^{t+\\Delta}\\!\\int_{t}^{s} \\mathrm{d}W_{r}\\,\\mathrm{d}W_{s}\n$$\nappears. Determine the analytic expression for the coefficient multiplying this iterated stochastic integral in terms of $t$ and $x$. Give your final answer as a single simplified closed-form expression in $t$ and $x$ (no numerical approximation is required).", "solution": "The solution begins by representing the increment $X_{t+\\Delta} - X_t$ in its integral form:\n$$\nX_{t+\\Delta} - X_{t} = \\int_{t}^{t+\\Delta} a(s, X_s)\\,\\mathrm{d}s + \\int_{t}^{t+\\Delta} b(s, X_s)\\,\\mathrm{d}W_s\n$$\nTo obtain the Itô-Taylor expansion, we must expand the integrands $a(s, X_s)$ and $b(s, X_s)$ around the point $(t, x)$, where $x = X_t$. The problem mandates that this expansion be derived using Itô's formula for a time-dependent function. Let us focus on the stochastic integral term, as it is the source of the iterated stochastic integral in question.\n\nWe expand the integrand $b(s, X_s)$ for $s \\in [t, t+\\Delta]$ around its value at time $t$, which is $b(t, X_t) = b(t,x)$. Applying Itô's formula to the function $f(s, y) = b(s, y)$, we obtain the differential $\\mathrm{d}b(s,X_s)$:\n$$\n\\mathrm{d}b(s,X_s) = \\left(\\frac{\\partial b}{\\partial s} + a(s,X_s)\\frac{\\partial b}{\\partial y} + \\frac{1}{2}b(s,X_s)^2\\frac{\\partial^2 b}{\\partial y^2}\\right)\\bigg|_{(s,X_s)}\\mathrm{d}s + \\left(b(s,X_s)\\frac{\\partial b}{\\partial y}\\right)\\bigg|_{(s,X_s)}\\mathrm{d}W_s\n$$\nLet us define the generator operator $\\mathcal{L}$ associated with the process $X_t$ as\n$$\n\\mathcal{L} = \\frac{\\partial}{\\partial t} + a(t,x)\\frac{\\partial}{\\partial x} + \\frac{1}{2}b(t,x)^2\\frac{\\partial^2}{\\partial x^2}\n$$\nThen, $\\mathrm{d}b(s,X_s) = (\\mathcal{L}b)(s,X_s)\\,\\mathrm{d}s + (b\\frac{\\partial b}{\\partial x})(s,X_s)\\,\\mathrm{d}W_s$.\n\nIntegrating this differential from $t$ to $s$ gives the expansion for $b(s, X_s)$:\n$$\nb(s, X_s) = b(t, x) + \\int_{t}^{s} (\\mathcal{L}b)(r,X_r)\\,\\mathrm{d}r + \\int_{t}^{s} \\left(b\\frac{\\partial b}{\\partial x}\\right)(r,X_r)\\,\\mathrm{d}W_r\n$$\nNow, we substitute this expansion back into the stochastic integral for $X_{t+\\Delta}$:\n$$\n\\int_{t}^{t+\\Delta} b(s, X_s)\\,\\mathrm{d}W_s = \\int_{t}^{t+\\Delta} \\left[ b(t, x) + \\int_{t}^{s} (\\mathcal{L}b)(r,X_r)\\,\\mathrm{d}r + \\int_{t}^{s} \\left(b\\frac{\\partial b}{\\partial x}\\right)(r,X_r)\\,\\mathrm{d}W_r \\right] \\mathrm{d}W_s\n$$\nDistributing the outer integral, we get three terms:\n$$\nb(t, x) \\int_{t}^{t+\\Delta} \\mathrm{d}W_s + \\int_{t}^{t+\\Delta}\\left(\\int_{t}^{s} (\\mathcal{L}b)(r,X_r)\\,\\mathrm{d}r\\right)\\mathrm{d}W_s + \\int_{t}^{t+\\Delta}\\left(\\int_{t}^{s} \\left(b\\frac{\\partial b}{\\partial x}\\right)(r,X_r)\\,\\mathrm{d}W_r\\right)\\mathrm{d}W_s\n$$\nThe Itô–Taylor expansion is constructed by approximating the integrands in the iterated integrals by their values at the starting point $(t, x)$. The third term is the one of interest:\n$$\n\\int_{t}^{t+\\Delta}\\int_{t}^{s} \\left(b\\frac{\\partial b}{\\partial x}\\right)(r,X_r)\\,\\mathrm{d}W_r\\,\\mathrm{d}W_s\n$$\nTo find the coefficient of the integral $\\int_{t}^{t+\\Delta}\\!\\int_{t}^{s} \\mathrm{d}W_{r}\\,\\mathrm{d}W_{s}$ in the expansion, we approximate the integrand function $(b\\frac{\\partial b}{\\partial x})(r,X_r)$ by its value at the point $(t,x)$:\n$$\n\\left(b\\frac{\\partial b}{\\partial x}\\right)(r,X_r) \\approx \\left(b\\frac{\\partial b}{\\partial x}\\right)(t,x)\n$$\nThis is the lowest-order, non-zero approximation. The term then becomes:\n$$\n\\left(b(t,x)\\frac{\\partial b}{\\partial x}(t,x)\\right) \\int_{t}^{t+\\Delta}\\!\\int_{t}^{s} \\mathrm{d}W_r\\,\\mathrm{d}W_s\n$$\nThus, the coefficient multiplying the specified iterated stochastic integral is $b(t,x)\\frac{\\partial b}{\\partial x}(t,x)$.\n\nWe are given the diffusion coefficient:\n$$\nb(t,x) = \\exp(t)\\,\\cos(x)\n$$\nFirst, we compute its partial derivative with respect to $x$:\n$$\n\\frac{\\partial b}{\\partial x}(t,x) = \\frac{\\partial}{\\partial x} \\left[ \\exp(t)\\,\\cos(x) \\right] = \\exp(t) [-\\sin(x)] = -\\exp(t)\\,\\sin(x)\n$$\nNow, we compute the product $b(t,x)\\frac{\\partial b}{\\partial x}(t,x)$:\n$$\n\\text{Coefficient} = \\left( \\exp(t)\\,\\cos(x) \\right) \\left( -\\exp(t)\\,\\sin(x) \\right)\n$$\n$$\n= -\\exp(t)\\exp(t)\\sin(x)\\cos(x) = -\\exp(2t)\\sin(x)\\cos(x)\n$$\nUsing the trigonometric double angle identity $\\sin(2\\theta) = 2\\sin(\\theta)\\cos(\\theta)$, which implies $\\sin(\\theta)\\cos(\\theta) = \\frac{1}{2}\\sin(2\\theta)$, we can simplify the expression:\n$$\n\\text{Coefficient} = -\\exp(2t) \\left(\\frac{1}{2}\\sin(2x)\\right) = -\\frac{1}{2}\\exp(2t)\\sin(2x)\n$$\nThis is the final analytical expression for the desired coefficient.", "answer": "$$\n\\boxed{-\\frac{1}{2}\\exp(2t)\\sin(2x)}\n$$", "id": "2981909"}]}