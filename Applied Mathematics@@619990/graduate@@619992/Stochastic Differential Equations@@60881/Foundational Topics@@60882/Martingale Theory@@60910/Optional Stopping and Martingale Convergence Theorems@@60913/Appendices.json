{"hands_on_practices": [{"introduction": "We begin with a classic problem, often called the \"Gambler's Ruin\" for Brownian motion. This exercise will guide you through calculating the probability that a standard Brownian motion exits a symmetric interval $(-a, a)$ at the upper boundary $a$. By applying the Optional Stopping Theorem to the fundamental martingale $M_t = B_t$, you will practice the core technique of stopping the process and using a martingale convergence argument to find a precise solution [@problem_id:2989358]. This practice establishes a foundational workflow for tackling a wide range of first-passage time problems.", "problem": "Let $\\{B_{t}\\}_{t \\ge 0}$ be a standard one-dimensional Brownian motion started at $B_{0}=0$ on a filtered probability space satisfying the usual conditions. For a fixed parameter $a>0$, define the first exit time from the symmetric interval $(-a,a)$ by\n$$\n\\tau_{-a,a} \\equiv \\inf\\{t \\ge 0 : |B_{t}| = a\\}.\n$$\nConsider the stopped process $M_{t} = B_{t \\wedge \\tau_{-a,a}}$.\n\nStarting from the definitions of Brownian motion, the martingale property of $B_{t}$, and the Optional Stopping Theorem (OST), together with a martingale convergence theorem (for instance, the uniform integrability criterion implying convergence in $L^{1}$), derive an exact closed-form expression for the probability\n$$\n\\mathbb{P}\\big(B_{\\tau_{-a,a}} = a\\big).\n$$\nYour derivation must:\n- Establish the relevant conditions under which OST applies to $\\{M_{t}\\}_{t \\ge 0}$.\n- Use a valid convergence argument for $\\{M_{t}\\}_{t \\ge 0}$ as $t \\to \\infty$ to relate $\\mathbb{E}[B_{\\tau_{-a,a}}]$ to $\\mathbb{E}[B_{0}]$.\n- Express $\\mathbb{E}[B_{\\tau_{-a,a}}]$ in terms of $\\mathbb{P}\\big(B_{\\tau_{-a,a}}=a\\big)$ and $\\mathbb{P}\\big(B_{\\tau_{-a,a}}=-a\\big)$ and solve for $\\mathbb{P}\\big(B_{\\tau_{-a,a}}=a\\big)$.\n- Verify that the result is consistent with the symmetry of standard Brownian motion.\n\nProvide your final answer as an exact number. No rounding is required.", "solution": "The problem asks for the probability $\\mathbb{P}(B_{\\tau_{-a,a}} = a)$, where $\\{B_t\\}_{t \\ge 0}$ is a standard one-dimensional Brownian motion starting at $B_0=0$, and $\\tau_{-a,a} = \\inf\\{t \\ge 0 : |B_t| = a\\}$ is the first exit time from the interval $(-a, a)$ for a constant $a>0$.\n\nThe derivation will proceed by applying the Optional Stopping Theorem (OST) and martingale convergence principles.\n\nFirst, we identify the core martingale. A standard Brownian motion $\\{B_t\\}_{t \\ge 0}$ initiated at $B_0=0$ is a martingale with respect to its natural filtration $(\\mathcal{F}_t)_{t \\ge 0}$, which is assumed to satisfy the usual conditions. The stopping time $\\tau_{-a,a}$ is an $\\mathcal{F}_t$-stopping time. For a one-dimensional standard Brownian motion, it is a known property that it will eventually exit any finite interval, meaning $\\tau_{-a,a}$ is an almost surely finite stopping time: $\\mathbb{P}(\\tau_{-a,a} < \\infty) = 1$.\n\nWe are instructed to consider the stopped process $M_t = B_{t \\wedge \\tau_{-a,a}}$. By Doob's Optional Stopping Theorem, if $\\{X_t\\}$ is a martingale and $\\tau$ is any stopping time, the stopped process $\\{X_{t \\wedge \\tau}\\}$ is also a martingale. Therefore, $\\{M_t\\}_{t \\ge 0}$ is a martingale with respect to the filtration $(\\mathcal{F}_t)_{t \\ge 0}$.\n\nThe next step is to analyze the convergence of this martingale as $t \\to \\infty$. By the definition of $\\tau_{-a,a}$, for any time $s \\in [0, t \\wedge \\tau_{-a,a}]$, the process $B_s$ lies within the closed interval $[-a, a]$. This implies that the stopped process $M_t$ is bounded for all $t \\ge 0$:\n$$\n|M_t| = |B_{t \\wedge \\tau_{-a,a}}| \\le a.\n$$\nA martingale that is bounded is uniformly integrable. The condition for uniform integrability is $\\lim_{K \\to \\infty} \\sup_{t \\ge 0} \\mathbb{E}[|M_t| \\mathbf{1}_{\\{|M_t|>K\\}}] = 0$. Since $|M_t| \\le a$ almost surely for all $t$, we can choose any constant $K > a$. For such a $K$, the event $\\{|M_t|>K\\}$ is a null set, and thus the expectation $\\mathbb{E}[|M_t| \\mathbf{1}_{\\{|M_t|>K\\}}]$ is $0$. The condition for uniform integrability is therefore satisfied.\n\nAs $t \\to \\infty$, the random time $t \\wedge \\tau_{-a,a}$ converges to $\\tau_{-a,a}$ almost surely, because $\\tau_{-a,a}$ is almost surely finite. Since the sample paths of a Brownian motion are almost surely continuous, we have the almost sure convergence of the process:\n$$\n\\lim_{t \\to \\infty} M_t = \\lim_{t \\to \\infty} B_{t \\wedge \\tau_{-a,a}} = B_{\\tau_{-a,a}} \\quad \\text{a.s.}\n$$\nThe Martingale Convergence Theorem states that a uniformly integrable martingale converges both almost surely and in $L^1$ to a limiting random variable. As $\\{M_t\\}$ is a uniformly integrable martingale, it converges in $L^1$ to its almost sure limit $B_{\\tau_{-a,a}}$. The convergence in $L^1$ implies the convergence of expectations:\n$$\n\\lim_{t \\to \\infty} \\mathbb{E}[M_t] = \\mathbb{E}\\left[\\lim_{t \\to \\infty} M_t\\right] = \\mathbb{E}[B_{\\tau_{-a,a}}].\n$$\nBecause $\\{M_t\\}$ is a martingale, its expectation is constant for all time: $\\mathbb{E}[M_t] = \\mathbb{E}[M_0]$ for all $t \\ge 0$. We evaluate this at time $t=0$:\n$$\nM_0 = B_{0 \\wedge \\tau_{-a,a}} = B_0 = 0.\n$$\nThus, $\\mathbb{E}[M_0] = 0$, which implies $\\mathbb{E}[M_t] = 0$ for all $t \\ge 0$. Combining these results, we find:\n$$\n\\mathbb{E}[B_{\\tau_{-a,a}}] = \\lim_{t \\to \\infty} \\mathbb{E}[M_t] = 0.\n$$\nNow, we express this expectation in terms of the desired probability. Let $p = \\mathbb{P}(B_{\\tau_{-a,a}} = a)$. Due to the path continuity of Brownian motion, the process cannot jump over the boundaries. Thus, at the stopping time $\\tau_{-a,a}$, the process must be at one of the two boundaries: $B_{\\tau_{-a,a}} \\in \\{a, -a\\}$. Since these are the only two outcomes and they are mutually exclusive, we must have $\\mathbb{P}(B_{\\tau_{-a,a}} = -a) = 1 - p$.\n\nThe expectation of the discrete random variable $B_{\\tau_{-a,a}}$ is given by:\n$$\n\\mathbb{E}[B_{\\tau_{-a,a}}] = a \\cdot \\mathbb{P}(B_{\\tau_{-a,a}} = a) + (-a) \\cdot \\mathbb{P}(B_{\\tau_{-a,a}} = -a).\n$$\nSubstituting $p$ and our result from the martingale argument:\n$$\n0 = a \\cdot p + (-a) \\cdot (1 - p).\n$$\nSince we are given $a>0$, we can divide the equation by $a$:\n$$\n0 = p - (1-p)\n$$\n$$\n0 = 2p - 1\n$$\n$$\n2p = 1\n$$\n$$\np = \\frac{1}{2}.\n$$\nTherefore, $\\mathbb{P}(B_{\\tau_{-a,a}} = a) = \\frac{1}{2}$.\n\nFinally, we confirm this result is consistent with the symmetry of a standard Brownian motion. The process $\\{X_t\\}_{t \\ge 0}$ defined by $X_t = -B_t$ is also a standard Brownian motion starting at $X_0 = -B_0 = 0$. The event that $\\{B_t\\}$ hits $a$ before $-a$ is $\\{B_{\\tau_{-a,a}} = a\\}$. Due to the symmetry of the distribution of Brownian paths, this event must have the same probability as $\\{B_t\\}$ hitting $-a$ before $a$, which is $\\{B_{\\tau_{-a,a}} = -a\\}$. This can be seen by noting that the probability of $\\{B_t\\}$ hitting $a$ before $-a$ is identical to the probability of $\\{X_t\\}$ hitting $a$ before $-a$, which is the event that $\\{-B_t\\}$ hits $a$ before $-a$, which in turn is the event that $\\{B_t\\}$ hits $-a$ before $a$. So, $\\mathbb{P}(B_{\\tau_{-a,a}} = a) = \\mathbb{P}(B_{\\tau_{-a,a}} = -a)$. As these probabilities sum to $1$, each must be equal to $\\frac{1}{2}$. This confirms the result of our derivation.", "answer": "$$\\boxed{\\frac{1}{2}}$$", "id": "2989358"}, {"introduction": "Having determined the probability of where the process exits, a natural next question is: how long does it take? This practice explores the expected first exit time, $\\mathbb{E}[\\tau_{-a,a}]$, from the interval $(-a, a)$. We will leverage a different, powerful martingale, $M_t = B_t^2 - t$, which is intrinsically linked to the quadratic variation of Brownian motion [@problem_id:2989359]. This exercise demonstrates the crucial principle that the choice of martingale determines which properties of the process we can calculate and introduces the careful use of limit theorems to justify the application of optional stopping.", "problem": "Let $\\{B_{t}\\}_{t \\ge 0}$ be a one-dimensional standard Brownian motion (BM) on a filtered probability space $(\\Omega,\\mathcal{F},\\{\\mathcal{F}_{t}\\}_{t \\ge 0},\\mathbb{P})$ satisfying the usual conditions, with $B_{0}=0$. Define the first exit time from the open interval $(-a,a)$, for a fixed constant $a>0$, by\n$$\n\\tau_{-a,a} \\coloneqq \\inf\\{t \\ge 0 : B_{t} \\notin (-a,a)\\}.\n$$\nUsing only fundamental properties of Brownian motion including Itô’s formula and the quadratic variation $[B]_{t}=t$, proceed as follows:\n- Prove that the process $M_{t} \\coloneqq B_{t}^{2}-t$ is an $\\{\\mathcal{F}_{t}\\}$-martingale.\n- Prove that $\\mathbb{P}(\\tau_{-a,a}<\\infty)=1$.\n- Carefully justify the integrability of $\\tau_{-a,a}$ and compute the expectation $\\mathbb{E}[\\tau_{-a,a}]$ by applying the optional stopping theorem (OST) at the bounded stopping times $\\tau_{-a,a}\\wedge n$ for $n\\in\\mathbb{N}$, and then letting $n \\to \\infty$ with all limiting steps justified.\n\nExpress your final answer as a closed-form analytic expression in terms of $a$. No numerical approximation is required.", "solution": "We will address the three tasks in the order presented. Let $\\tau = \\tau_{-a,a}$.\n\n**1. Proof that $M_{t} \\coloneqq B_{t}^{2}-t$ is a martingale**\n\nTo prove that $M_t$ is a martingale with respect to the filtration $\\{\\mathcal{F}_t\\}_{t \\ge 0}$, we must show three properties:\ni. $M_t$ is adapted to $\\{\\mathcal{F}_t\\}$.\nii. $M_t$ is integrable, i.e., $\\mathbb{E}[|M_t|] < \\infty$ for all $t \\ge 0$.\niii. For all $s < t$, $\\mathbb{E}[M_t | \\mathcal{F}_s] = M_s$.\n\ni. Adaptivity: Since $\\{B_t\\}_{t \\ge 0}$ is an $\\{\\mathcal{F}_t\\}$-adapted process, $B_t^2$ is also $\\mathcal{F}_t$-adapted for each $t \\ge 0$. The function $g(t)=t$ is deterministic and thus adapted. Therefore, their difference $M_t = B_t^2 - t$ is $\\mathcal{F}_t$-adapted.\n\nii. Integrability: For any $t \\ge 0$, we have $\\mathbb{E}[|M_t|] = \\mathbb{E}[|B_t^2 - t|] \\le \\mathbb{E}[B_t^2] + |t|$. Since $B_t$ is a standard Brownian motion, $B_t \\sim N(0, t)$, so its second moment is $\\mathbb{E}[B_t^2] = \\text{Var}(B_t) + (\\mathbb{E}[B_t])^2 = t + 0^2 = t$. Thus, $\\mathbb{E}[|M_t|] \\le t + t = 2t$. For any finite $t$, $2t < \\infty$, so $M_t$ is integrable.\n\niii. Martingale property: We use Itô's formula for the function $f(x) = x^2$ applied to the process $B_t$. We have $f'(x) = 2x$ and $f''(x) = 2$. Itô's formula states:\n$$\nf(B_t) - f(B_0) = \\int_0^t f'(B_s) dB_s + \\frac{1}{2} \\int_0^t f''(B_s) d[B]_s\n$$\nSubstituting $f(x)=x^2$ and its derivatives, and using the given conditions $B_0=0$ and $[B]_t=t$:\n$$\nB_t^2 - B_0^2 = \\int_0^t 2B_s dB_s + \\frac{1}{2} \\int_0^t 2 \\, d[B]_s\n$$\n$$\nB_t^2 - 0 = \\int_0^t 2B_s dB_s + \\int_0^t ds\n$$\n$$\nB_t^2 = 2\\int_0^t B_s dB_s + t\n$$\nRearranging the terms, we get an expression for $M_t$:\n$$\nM_t = B_t^2 - t = 2\\int_0^t B_s dB_s\n$$\nThe right-hand side is an Itô integral. A process $X_t = \\int_0^t H_s dB_s$ is a martingale if the integrand $H_s$ is an adapted process satisfying $\\mathbb{E}[\\int_0^t H_s^2 ds] < \\infty$. Here, the integrand is $H_s = 2B_s$, which is adapted. We check the square-integrability condition:\n$$\n\\mathbb{E}\\left[\\int_0^t (2B_s)^2 ds\\right] = 4 \\int_0^t \\mathbb{E}[B_s^2] ds = 4 \\int_0^t s \\, ds = 4 \\left[\\frac{s^2}{2}\\right]_0^t = 2t^2\n$$\nSince $2t^2 < \\infty$ for all finite $t$, the process $M_t = 2\\int_0^t B_s dB_s$ is a true martingale, not just a local one. This completes the proof that $M_t = B_t^2-t$ is a martingale.\n\n**2. Proof that $\\mathbb{P}(\\tau < \\infty) = 1$**\n\nThe event $\\{\\tau > t\\}$ is the event that the Brownian motion has stayed within the interval $(-a,a)$ for the entire time interval $[0,t]$. This implies that at time $t$, its position must be within $(-a,a)$. Formally:\n$$\n\\{\\tau > t\\} = \\{\\sup_{0 \\le s \\le t} |B_s| < a\\} \\implies \\{|B_t| < a\\}\n$$\nTherefore, the probability of the first event is less than or equal to the probability of the second:\n$$\n\\mathbb{P}(\\tau > t) \\le \\mathbb{P}(|B_t| < a)\n$$\nFor a standard Brownian motion, $B_t \\sim N(0, t)$, so $B_t/\\sqrt{t}$ is a standard normal random variable, $Z \\sim N(0,1)$.\n$$\n\\mathbb{P}(|B_t| < a) = \\mathbb{P}(-a < B_t < a) = \\mathbb{P}\\left(-\\frac{a}{\\sqrt{t}} < \\frac{B_t}{\\sqrt{t}} < \\frac{a}{\\sqrt{t}}\\right) = \\mathbb{P}\\left(|Z| < \\frac{a}{\\sqrt{t}}\\right)\n$$\nAs $t \\to \\infty$, $a/\\sqrt{t} \\to 0$. Since the cumulative distribution function of a standard normal variable is continuous, the probability that $Z$ is in an interval that shrinks to a point is zero:\n$$\n\\lim_{t \\to \\infty} \\mathbb{P}\\left(|Z| < \\frac{a}{\\sqrt{t}}\\right) = \\mathbb{P}(|Z| < 0) = 0\n$$\nBy the Squeeze Theorem, since $0 \\le \\mathbb{P}(\\tau > t) \\le \\mathbb{P}(|B_t| < a)$, we have:\n$$\n\\lim_{t \\to \\infty} \\mathbb{P}(\\tau > t) = 0\n$$\nThe event that the process never exits is $\\{\\tau = \\infty\\}$. This can be written as the intersection of a decreasing sequence of events: $\\{\\tau = \\infty\\} = \\bigcap_{n=1}^\\infty \\{\\tau > n\\}$. By the continuity of probability measure for decreasing events:\n$$\n\\mathbb{P}(\\tau = \\infty) = \\mathbb{P}\\left(\\bigcap_{n=1}^\\infty \\{\\tau > n\\}\\right) = \\lim_{n\\to\\infty} \\mathbb{P}(\\tau > n) = 0\n$$\nTherefore, the probability that the process exits in finite time is $\\mathbb{P}(\\tau < \\infty) = 1 - \\mathbb{P}(\\tau = \\infty) = 1$.\n\n**3. Justification and computation of $\\mathbb{E}[\\tau]$**\n\nWe follow the prescribed method of using the sequence of stopped processes at times $\\tau_n \\coloneqq \\tau \\wedge n$ for $n \\in \\mathbb{N}$.\n\nFor any $n \\in \\mathbb{N}$, the stopping time $\\tau_n$ is bounded above by $n$. We can apply the Optional Stopping Theorem to the martingale $M_t = B_t^2 - t$ and the bounded stopping time $\\tau_n$. This gives:\n$$\n\\mathbb{E}[M_{\\tau_n}] = \\mathbb{E}[M_0]\n$$\nSince $B_0=0$, we have $M_0 = B_0^2 - 0 = 0$. So, $\\mathbb{E}[M_{\\tau_n}] = 0$.\nSubstituting the definition of $M_t$, we get $\\mathbb{E}[B_{\\tau_n}^2 - \\tau_n] = 0$. By linearity of expectation, this yields:\n$$\n\\mathbb{E}[\\tau_n] = \\mathbb{E}[B_{\\tau_n}^2]\n$$\nThis equality holds for all $n \\in \\mathbb{N}$. We now take the limit as $n \\to \\infty$.\n\nConsider the left-hand side, $\\mathbb{E}[\\tau_n]$. The sequence of random variables $\\{\\tau_n\\}_{n\\in\\mathbb{N}}$ is non-negative and non-decreasing since $\\tau_n = \\min(\\tau, n) \\le \\min(\\tau, n+1) = \\tau_{n+1}$. As shown in part 2, $\\tau < \\infty$ almost surely, so $\\lim_{n\\to\\infty} \\tau_n = \\tau$ almost surely. By the Monotone Convergence Theorem, we can interchange the limit and expectation:\n$$\n\\lim_{n\\to\\infty} \\mathbb{E}[\\tau_n] = \\mathbb{E}[\\lim_{n\\to\\infty} \\tau_n] = \\mathbb{E}[\\tau]\n$$\nThis step also implies that if the limit of the right-hand side is finite, then $\\mathbb{E}[\\tau]$ is finite, which establishes the integrability of $\\tau$.\n\nConsider the right-hand side, $\\mathbb{E}[B_{\\tau_n}^2]$. We analyze the random variables $B_{\\tau_n}^2$.\nBy definition of $\\tau$, we have $|B_s| < a$ for all $s < \\tau$.\n- If a path exits before time $n$ (i.e., $\\tau \\le n$), then $\\tau_n = \\tau$. By continuity of Brownian paths, $|B_{\\tau_n}| = |B_\\tau| = a$.\n- If a path has not exited by time $n$ (i.e., $\\tau > n$), then $\\tau_n = n$, and $|B_{\\tau_n}| = |B_n| < a$.\nIn both cases, we have $|B_{\\tau_n}| \\le a$. This means the sequence of random variables $\\{B_{\\tau_n}^2\\}_{n\\in\\mathbb{N}}$ is uniformly bounded by $a^2$.\n\nAs $n \\to \\infty$, we have $\\tau_n \\to \\tau$ almost surely. Since Brownian motion paths are continuous almost surely, this implies $B_{\\tau_n} \\to B_\\tau$ almost surely. Consequently, $B_{\\tau_n}^2 \\to B_\\tau^2$ almost surely. By the continuity property at the stopping time, $|B_\\tau| = a$ almost surely (since $\\mathbb{P}(\\tau < \\infty)=1$), so $B_\\tau^2 = a^2$ almost surely.\n\nWe have a sequence of random variables $\\{B_{\\tau_n}^2\\}$ that converges almost surely to the constant $a^2$ and is dominated by the integrable random variable $a^2$ (since $\\mathbb{E}[a^2] = a^2 < \\infty$). By the Dominated Convergence Theorem (or, more specifically, the Bounded Convergence Theorem), we can interchange the limit and expectation:\n$$\n\\lim_{n\\to\\infty} \\mathbb{E}[B_{\\tau_n}^2] = \\mathbb{E}[\\lim_{n\\to\\infty} B_{\\tau_n}^2] = \\mathbb{E}[a^2] = a^2\n$$\nEquating the limits of the left and right sides of $\\mathbb{E}[\\tau_n] = \\mathbb{E}[B_{\\tau_n}^2]$:\n$$\n\\mathbb{E}[\\tau] = a^2\n$$\nSince $a^2$ is a finite value, the expectation of $\\tau$ is finite, and thus $\\tau$ is an integrable random variable. The final expression for the expectation is $a^2$.", "answer": "$$\n\\boxed{a^{2}}\n$$", "id": "2989359"}, {"introduction": "This final practice elevates our analysis from the specific case of Brownian motion to the general setting of one-dimensional diffusions. Here, we tackle the exit probability problem for a process $X_t$ governed by a general stochastic differential equation with drift $\\mu(x)$ and volatility $\\sigma(x)$. The key is to use a \"scale function\" $s(x)$, a special function that transforms the diffusion $X_t$ into a local martingale, $s(X_t)$ [@problem_id:2989355]. By applying the Optional Stopping Theorem to this generalized martingale, we can derive a universal formula for exit probabilities, showcasing the profound power and elegance of martingale methods in the broader theory of stochastic processes.", "problem": "Consider a one-dimensional, time-homogeneous regular diffusion $X=(X_{t})_{t \\geq 0}$ on an open interval $I=(\\ell,r)$ with $\\ell<r$, defined on a filtered probability space $(\\Omega,\\mathcal{F},(\\mathcal{F}_{t})_{t \\geq 0},\\mathbb{P})$ satisfying the usual conditions, and driven by a standard Brownian motion $W=(W_{t})_{t \\geq 0}$. Assume $X$ solves the stochastic differential equation (SDE)\n$$\ndX_{t} \\;=\\; \\mu(X_{t})\\,dt \\;+\\; \\sigma(X_{t})\\,dW_{t},\n$$\nwhere $\\mu,\\sigma:I \\to \\mathbb{R}$ are continuous functions, $\\sigma(x)>0$ for all $x \\in I$, and the diffusion is non-explosive and pathwise continuous. Let $\\mathcal{L}$ denote the infinitesimal generator of $X$, acting on twice continuously differentiable functions $f \\in C^{2}(I)$ by\n$$\n\\mathcal{L} f(x) \\;=\\; \\mu(x) f'(x) \\;+\\; \\tfrac{1}{2}\\sigma(x)^{2} f''(x).\n$$\n\nFix points $a,b \\in I$ with $\\ell<a<b<r$, and an initial condition $x \\in (a,b)$. Define the hitting times\n$$\n\\tau_{a} \\;=\\; \\inf\\{t \\geq 0 : X_{t} = a\\}, \\qquad \\tau_{b} \\;=\\; \\inf\\{t \\geq 0 : X_{t} = b\\},\n$$\nand the stopped time $\\tau \\;=\\; \\tau_{a} \\wedge \\tau_{b}$. Assume $X$ has the strong Markov property, and let $s:I \\to \\mathbb{R}$ be a strictly increasing $C^{2}$ scale function, that is, a non-constant solution to $\\mathcal{L}s=0$ on $I$. You may assume $s$ is finite on $[a,b]$.\n\nUsing only core definitions, the strong Markov property, and the optional stopping theorem (no prepackaged formulas), derive the exact expression for the probability\n$$\n\\mathbb{P}_{x}\\big(\\tau_{a} < \\tau_{b}\\big)\n$$\nin terms of the values of the scale function $s$ at $a$, $x$, and $b$. Your final answer must be a single closed-form analytic expression (no inequalities or equations). Do not normalize $s$; express the answer in terms of $s(a)$, $s(x)$, and $s(b)$ as they are.", "solution": "The objective is to derive an expression for the probability $\\mathbb{P}_{x}(\\tau_{a} < \\tau_{b})$ for a one-dimensional diffusion $X_t$ starting at $X_0 = x \\in (a, b)$, where $\\tau_a$ and $\\tau_b$ are the first hitting times of the boundaries $a$ and $b$ respectively. The derivation will rely on the optional stopping theorem applied to a specific martingale constructed from the given scale function $s$.\n\nLet $X = (X_t)_{t \\ge 0}$ be the diffusion process solving the stochastic differential equation (SDE)\n$$\ndX_{t} = \\mu(X_{t})\\,dt + \\sigma(X_{t})\\,dW_{t}\n$$\nwith initial condition $X_0 = x \\in (a, b)$. We are given a function $s \\in C^2(I)$ which is a scale function for $X_t$. This means $s$ is a non-constant solution to the equation $\\mathcal{L}s(y) = 0$ for all $y \\in I$, where $\\mathcal{L}$ is the infinitesimal generator of $X_t$:\n$$\n\\mathcal{L}f(y) = \\mu(y)f'(y) + \\frac{1}{2}\\sigma(y)^2 f''(y).\n$$\nWe are also given that $s$ is strictly increasing.\n\nLet us define a new process $M_t$ by applying the scale function $s$ to the diffusion $X_t$, i.e., $M_t = s(X_t)$. To understand the dynamics of $M_t$, we apply Itô's formula to $s(X_t)$. For a function $f \\in C^2$, Itô's formula states:\n$$\ndf(X_t) = f'(X_t)dX_t + \\frac{1}{2}f''(X_t)(dX_t)^2.\n$$\nSubstituting $dX_t = \\mu(X_t)dt + \\sigma(X_t)dW_t$ and using the Itô multiplication rule $(dW_t)^2=dt$, we get $(dX_t)^2 = \\sigma(X_t)^2 dt$. Plugging these into the formula for $f=s$:\n$$\nds(X_t) = s'(X_t)\\left(\\mu(X_t)dt + \\sigma(X_t)dW_t\\right) + \\frac{1}{2}s''(X_t)\\sigma(X_t)^2 dt.\n$$\nRearranging the terms based on $dt$ and $dW_t$:\n$$\nds(X_t) = \\left(\\mu(X_t)s'(X_t) + \\frac{1}{2}\\sigma(X_t)^2 s''(X_t)\\right)dt + s'(X_t)\\sigma(X_t)dW_t.\n$$\nThe term in the parenthesis is precisely the generator $\\mathcal{L}$ applied to the function $s$, evaluated at $X_t$. By the definition of the scale function $s$, we have $\\mathcal{L}s(y) = 0$ for all $y \\in I$. Therefore, $\\mathcal{L}s(X_t) = 0$. The dynamics of $M_t = s(X_t)$ simplify to:\n$$\ndM_t = s'(X_t)\\sigma(X_t)dW_t.\n$$\nSince the $dt$ term (the drift) is zero, the process $M_t$ is a continuous local martingale with respect to the filtration $(\\mathcal{F}_t)_{t \\ge 0}$.\n\nThe problem requires us to analyze the process until it exits the interval $(a, b)$. Let $\\tau = \\tau_a \\wedge \\tau_b = \\inf\\{t \\ge 0: X_t \\notin (a,b)\\}$. This is a stopping time. We will apply the optional stopping theorem to the local martingale $M_t$ at the stopping time $\\tau$.\n\nA version of the optional stopping theorem states that if $M_t$ is a continuous local martingale and $\\tau$ is a stopping time such that the stopped process $M_{t \\wedge \\tau}$ is bounded, then $\\mathbb{E}[M_{\\tau}] = \\mathbb{E}[M_0]$.\nLet's verify the boundedness condition. For any time $t \\ge 0$, the value of the stopped process $X_{t \\wedge \\tau}$ lies within the closed interval $[a, b]$. Since the scale function $s$ is given to be continuous on $I$, it is continuous on the compact interval $[a, b]$. A continuous function on a compact set is bounded. Thus, there exists a constant $K$ such that $|s(y)| \\le K$ for all $y \\in [a, b]$.\nThis implies that the stopped process $M_{t \\wedge \\tau} = s(X_{t \\wedge \\tau})$ is uniformly bounded: $|M_{t \\wedge \\tau}| \\le K$ for all $t \\ge 0$.\nThe conditions for the optional stopping theorem are therefore satisfied. Applying the theorem under the measure $\\mathbb{P}_x$, which assumes $X_0 = x$, we obtain:\n$$\n\\mathbb{E}_x[M_{\\tau}] = \\mathbb{E}_x[M_0].\n$$\nSubstituting $M_t=s(X_t)$ and $M_0=s(X_0)=s(x)$, this becomes:\n$$\n\\mathbb{E}_x[s(X_{\\tau})] = s(x).\n$$\nNow, we must evaluate the expectation on the left-hand side. The stopping time $\\tau$ is the first time the process $X_t$ hits either $a$ or $b$. By the path continuity of $X_t$, at time $\\tau$, the process must be at one of these two points, i.e., $X_{\\tau} \\in \\{a, b\\}$. The event $\\{X_{\\tau} = a\\}$ is equivalent to the event $\\{\\tau_a \\le \\tau_b\\}$. For a diffusion process, the probability of hitting two distinct points at the same time is zero, so this is equivalent to $\\{\\tau_a < \\tau_b\\}$. Similarly, $\\{X_{\\tau} = b\\}$ is equivalent to $\\{\\tau_b < \\tau_a\\}$.\nSince the diffusion is regular and non-explosive, it is guaranteed to exit any finite interval $(a, b)$ in finite time, meaning $\\mathbb{P}_x(\\tau < \\infty) = 1$. Therefore, the process must hit either $a$ or $b$. This gives the partition of unity:\n$$\n\\mathbb{P}_x(\\tau_a < \\tau_b) + \\mathbb{P}_x(\\tau_b < \\tau_a) = 1.\n$$\nLet $p_a = \\mathbb{P}_x(\\tau_a < \\tau_b)$. Then $\\mathbb{P}_x(\\tau_b < \\tau_a) = 1 - p_a$.\n\nWe can now compute the expectation $\\mathbb{E}_x[s(X_{\\tau})]$ using the law of total expectation, by conditioning on the two possible values of $X_{\\tau}$:\n$$\n\\mathbb{E}_x[s(X_{\\tau})] = s(a) \\cdot \\mathbb{P}_x(X_{\\tau} = a) + s(b) \\cdot \\mathbb{P}_x(X_{\\tau} = b)\n$$\n$$\n\\mathbb{E}_x[s(X_{\\tau})] = s(a) \\cdot \\mathbb{P}_x(\\tau_a < \\tau_b) + s(b) \\cdot \\mathbb{P}_x(\\tau_b < \\tau_a)\n$$\n$$\n\\mathbb{E}_x[s(X_{\\tau})] = s(a) \\cdot p_a + s(b) \\cdot (1 - p_a).\n$$\nEquating this with our result from the optional stopping theorem:\n$$\ns(x) = s(a) \\cdot p_a + s(b) \\cdot (1 - p_a).\n$$\nWe now solve this linear equation for $p_a$, which is the desired probability $\\mathbb{P}_{x}(\\tau_{a} < \\tau_{b})$:\n$$\ns(x) = s(a) p_a + s(b) - s(b) p_a\n$$\n$$\ns(x) - s(b) = p_a (s(a) - s(b))\n$$\n$$\np_a = \\frac{s(x) - s(b)}{s(a) - s(b)}.\n$$\nSince $s$ is strictly increasing and $a<b$, we have $s(a) < s(b)$, so the denominator $s(a) - s(b)$ is non-zero. We can write the expression in a more conventional form by multiplying the numerator and denominator by $-1$:\n$$\np_a = \\frac{-(s(b) - s(x))}{-(s(b) - s(a))} = \\frac{s(b) - s(x)}{s(b) - s(a)}.\n$$\nThis is the final expression for the probability that the process hits $a$ before $b$, starting from $x \\in (a, b)$.", "answer": "$$\n\\boxed{\\frac{s(b) - s(x)}{s(b) - s(a)}}\n$$", "id": "2989355"}]}