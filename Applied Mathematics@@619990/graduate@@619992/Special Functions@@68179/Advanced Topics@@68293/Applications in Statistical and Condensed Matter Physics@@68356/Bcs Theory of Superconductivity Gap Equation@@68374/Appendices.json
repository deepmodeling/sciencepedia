{"hands_on_practices": [{"introduction": "The cornerstone of the Bardeen-Cooper-Schrieffer (BCS) theory is the idea that an effective attractive interaction between electrons can lead to the formation of Cooper pairs. This exercise provides a foundational check on this concept by tasking you with a direct analysis of the zero-temperature BCS gap equation. By examining the mathematical properties of the equation [@problem_id:1766635], you will demonstrate rigorously why a purely repulsive interaction ($V \\lt 0$) cannot produce a superconducting state, solidifying your understanding of this essential prerequisite for superconductivity.", "problem": "The Bardeen-Cooper-Schrieffer (BCS) theory of superconductivity describes how an attractive interaction between electrons can lead to the formation of Cooper pairs and the opening of a superconducting energy gap, $\\Delta$. This gap is determined by a self-consistency equation. At absolute zero temperature ($T=0$), for a simplified model with a constant attractive potential, this equation is given by:\n\n$$1 = \\frac{V N(0)}{2} \\int_{-\\hbar \\omega_D}^{\\hbar \\omega_D} \\frac{d\\epsilon}{\\sqrt{\\epsilon^2 + \\Delta^2}}$$\n\nHere, $V$ is a positive constant representing the strength of the attractive electron-electron interaction, $N(0)$ is the density of electronic states for a single spin at the Fermi level, $\\hbar$ is the reduced Planck constant, and $\\omega_D$ is the Debye frequency, which defines an energy cutoff $\\hbar \\omega_D$ around the Fermi level within which the interaction is non-zero. A non-trivial solution ($\\Delta  0$) to this equation signifies the presence of a superconducting state.\n\nNow, consider a hypothetical material where an exotic pairing mechanism results in an effective electron-electron interaction that is purely *repulsive*. In the context of the BCS model, this corresponds to an interaction strength parameter $V  0$. By analyzing the mathematical structure of the self-consistency equation for this repulsive case, determine whether a non-trivial superconducting gap ($\\Delta  0$) can form at $T=0$.\n\nWhich of the following statements correctly explains the possibility of a non-trivial superconducting gap for a repulsive interaction ($V0$)?\n\nA. A non-zero gap is possible, provided the density of states $N(0)$ is sufficiently large to compensate for the negative sign of $V$.\n\nB. A non-zero gap is impossible. The right-hand side of the equation involves a product of the negative parameter $V$ and an integral that must be positive for any real $\\Delta  0$. The resulting negative value can never equal the positive value (1) on the left-hand side.\n\nC. A non-zero gap is possible, but it must be a purely imaginary number, which corresponds to a physically unstable state rather than a stable superconducting ground state.\n\nD. A non-zero gap is impossible because for a repulsive potential ($V0$), the integral on the right-hand side of the equation diverges.\n\nE. A non-zero gap is impossible at $T=0$, but a repulsive interaction can lead to a stable superconducting gap at sufficiently high temperatures.", "solution": "We start from the zero-temperature BCS self-consistency equation with a constant interaction within the Debye window:\n$$\n1=\\frac{V N(0)}{2}\\int_{-\\hbar \\omega_{D}}^{\\hbar \\omega_{D}}\\frac{d\\epsilon}{\\sqrt{\\epsilon^{2}+\\Delta^{2}}}\\,,\n$$\nwhere $V$ is a constant interaction parameter, $N(0)0$ is the density of states per spin at the Fermi level, and $\\Delta0$ is a putative real superconducting gap.\n\nFirst, analyze the integrand. For any real $\\Delta0$, the function $f(\\epsilon)=1/\\sqrt{\\epsilon^{2}+\\Delta^{2}}$ is:\n- even in $\\epsilon$, since $f(-\\epsilon)=f(\\epsilon)$,\n- strictly positive for all $\\epsilon\\in\\mathbb{R}$,\n- integrable over any finite interval.\n\nTherefore, the integral is positive and finite. Using evenness,\n$$\n\\int_{-\\hbar \\omega_{D}}^{\\hbar \\omega_{D}}\\frac{d\\epsilon}{\\sqrt{\\epsilon^{2}+\\Delta^{2}}}\n=2\\int_{0}^{\\hbar \\omega_{D}}\\frac{d\\epsilon}{\\sqrt{\\epsilon^{2}+\\Delta^{2}}}\\,.\n$$\nEvaluate the primitive:\n$$\n\\int \\frac{d\\epsilon}{\\sqrt{\\epsilon^{2}+\\Delta^{2}}}\n=\\operatorname{arsinh}\\!\\left(\\frac{\\epsilon}{\\Delta}\\right)\n=\\ln\\!\\left(\\frac{\\epsilon+\\sqrt{\\epsilon^{2}+\\Delta^{2}}}{\\Delta}\\right).\n$$\nHence,\n$$\n\\int_{-\\hbar \\omega_{D}}^{\\hbar \\omega_{D}}\\frac{d\\epsilon}{\\sqrt{\\epsilon^{2}+\\Delta^{2}}}\n=2\\,\\operatorname{arsinh}\\!\\left(\\frac{\\hbar \\omega_{D}}{\\Delta}\\right)\n=2\\,\\ln\\!\\left(\\frac{\\hbar \\omega_{D}+\\sqrt{(\\hbar \\omega_{D})^{2}+\\Delta^{2}}}{\\Delta}\\right),\n$$\nwhich is strictly positive and finite for any real $\\Delta0$.\n\nSubstitute this into the gap equation:\n$$\n1=\\frac{V N(0)}{2}\\times 2\\,\\operatorname{arsinh}\\!\\left(\\frac{\\hbar \\omega_{D}}{\\Delta}\\right)\n=V N(0)\\,\\operatorname{arsinh}\\!\\left(\\frac{\\hbar \\omega_{D}}{\\Delta}\\right).\n$$\nSince $N(0)0$ and $\\operatorname{arsinh}(\\hbar \\omega_{D}/\\Delta)0$ for $\\Delta0$, the sign of the right-hand side is the sign of $V$. Therefore:\n- If $V0$ (effective attraction), the right-hand side is positive, and a non-trivial solution $\\Delta0$ can exist.\n- If $V0$ (purely repulsive interaction), the right-hand side is strictly negative, whereas the left-hand side is $10$. Thus the equality cannot be satisfied for any real $\\Delta0$.\n\nThis shows that with a purely repulsive, momentum-independent interaction $V0$, there is no non-trivial real gap solution at $T=0$ in this BCS model.\n\nTo address possible misconceptions in the options:\n- Option A is false because increasing $N(0)$ only scales the magnitude of a negative right-hand side when $V0$; it cannot change its sign to match $1$.\n- Option C is not applicable in this real-gap BCS equation; taking $\\Delta$ imaginary would change the integrand to $1/\\sqrt{\\epsilon^{2}-|\\Delta|^{2}}$, leading to nonphysical divergences or complex values within the finite cutoff and does not yield a stable superconducting solution of the original real-gap equation.\n- Option D is false because the integral is finite, as explicitly evaluated above.\n- Option E is false because at finite temperature the gap equation acquires a factor $\\tanh\\!\\left(\\frac{\\sqrt{\\epsilon^{2}+\\Delta^{2}}}{2 k_{B} T}\\right)$ multiplying the integrand; this factor is positive and less than or equal to $1$, so with $V0$ the right-hand side remains negative and cannot equal $1$ for any $T$.\n\nTherefore, the correct statement is that a non-trivial superconducting gap cannot form for $V0$ in this model because the right-hand side is necessarily negative while the left-hand side is positive.", "answer": "$$\\boxed{B}$$", "id": "1766635"}, {"introduction": "While the standard treatment of BCS theory often focuses on three-dimensional metals with a high density of states at the Fermi level, the underlying principles are broadly applicable. This practice [@problem_id:632281] challenges you to apply the theory to a different, yet physically relevant, scenario: a two-dimensional electron system where the chemical potential $\\mu$ lies precisely at the bottom of the conduction band. By converting the summation over states into an integral and solving it, you will derive an exact analytical expression for the gap $\\Delta$, offering valuable insight into how superconductivity manifests in low-density or dimensionally-constrained systems.", "problem": "In the Bardeen-Cooper-Schrieffer (BCS) theory of superconductivity, the energy gap $\\Delta$ at zero temperature is determined by the self-consistent gap equation. For a simple model with a constant attractive interaction potential, and an s-wave (momentum-independent) gap, this equation is given by:\n$$\n1 = \\frac{V}{2} \\sum_{\\mathbf{k}} \\frac{1}{\\sqrt{\\xi_{\\mathbf{k}}^2 + \\Delta^2}}\n$$\nHere, $V  0$ is the strength of the attractive interaction, and the sum is over all electron wavevectors $\\mathbf{k}$. The energy $\\xi_{\\mathbf{k}}$ is the single-particle energy of an electron with wavevector $\\mathbf{k}$ measured relative to the chemical potential $\\mu$, and the interaction is effective for states within an energy shell defined by $0 \\le \\xi_{\\mathbf{k}} \\le \\hbar\\omega_D$, where $\\hbar\\omega_D$ is a characteristic energy cutoff, typically the Debye energy.\n\nConsider a two-dimensional (2D) system of electrons with an effective mass $m$. Their single-particle energy is described by a parabolic dispersion relation $\\epsilon(\\mathbf{k}) = \\frac{\\hbar^2 |\\mathbf{k}|^2}{2m}$, where $\\mathbf{k}$ is the 2D wavevector.\n\nIn a departure from the usual metallic case, suppose the chemical potential $\\mu$ is located exactly at the bottom of the conduction band, i.e., $\\mu=0$. Consequently, the energy relative to the chemical potential is $\\xi_{\\mathbf{k}} = \\epsilon(\\mathbf{k})$. The attractive interaction of strength $V$ is active for electrons in the energy range $0 \\le \\epsilon(\\mathbf{k}) \\le \\hbar\\omega_D$.\n\nYour task is to solve the BCS gap equation for this specific model. Derive a closed-form analytical expression for the zero-temperature superconducting gap $\\Delta$ as a function of the physical parameters $m$, $V$, and $\\hbar\\omega_D$.", "solution": "We start from the zero-temperature BCS gap equation for an s-wave gap, where the sum is over all available electronic states (wavevector and spin):\n$$1=\\frac{V}{2}\\sum_{\\bf k, \\sigma}\\frac{1}{\\sqrt{\\epsilon_{\\bf k}^2+\\Delta^2}}\\,.$$\nIn this 2D model with $\\mu=0$, the energies are $\\xi_{\\bf k}=\\epsilon_{\\bf k}=\\hbar^2k^2/(2m)$, and the interaction is active for $0 \\le \\epsilon_{\\bf k} \\le \\hbar\\omega_D$.\nWe convert the sum over states to an integral over energy weighted by the density of states (DOS). For a 2D electron gas, the total DOS (including both spin projections) per unit area is constant: $N(\\epsilon) = m/(\\pi\\hbar^2)$. The sum over states per unit area becomes $\\frac{1}{2}\\sum_{\\bf k, \\sigma} \\to \\frac{1}{2}\\int d\\epsilon\\,N(\\epsilon)$. The factor of $1/2$ is because the sum in the gap equation is conventionally over pairs of states, whereas the integral is over single-particle states. However, a more direct approach is to replace the sum over all states with an integral over the total DOS:\n$$\\sum_{\\bf k, \\sigma} \\to \\int d\\epsilon\\, N_{total}(\\epsilon)$$\nThis gives:\n$$1=\\frac{V}{2}\\int_0^{\\hbar\\omega_D} \\frac{N_{total}(\\epsilon)}{\\sqrt{\\epsilon^2+\\Delta^2}} d\\epsilon = \\frac{V}{2}\\int_0^{\\hbar\\omega_D} \\frac{m/(\\pi\\hbar^2)}{\\sqrt{\\epsilon^2+\\Delta^2}} d\\epsilon = \\frac{Vm}{2\\pi\\hbar^2}\\int_0^{\\hbar\\omega_D}\\frac{d\\epsilon}{\\sqrt{\\epsilon^2+\\Delta^2}}.$$\nLet's define the dimensionless coupling constant for this 2D system as\n$$\\lambda=\\frac{mV}{2\\pi\\hbar^2}.$$\nThe gap equation then simplifies to:\n$$1=\\lambda\\int_0^{\\hbar\\omega_D}\\frac{d\\epsilon}{\\sqrt{\\epsilon^2+\\Delta^2}}.$$\nThe integral is elementary:\n$$\\int_0^{\\hbar\\omega_D}\\frac{d\\epsilon}{\\sqrt{\\epsilon^2+\\Delta^2}}\n=\\left[\\operatorname{arsinh}\\!\\left(\\frac{\\epsilon}{\\Delta}\\right)\\right]_0^{\\hbar\\omega_D}\n=\\operatorname{arsinh}\\!\\left(\\frac{\\hbar\\omega_D}{\\Delta}\\right)\n=\\ln\\!\\left(\\frac{\\hbar\\omega_D+\\sqrt{(\\hbar\\omega_D)^2+\\Delta^2}}{\\Delta}\\right).$$\nSubstituting this back into the gap equation gives:\n$$1=\\lambda\\,\\operatorname{arsinh}\\!\\left(\\frac{\\hbar\\omega_D}{\\Delta}\\right)\n\\;\\Longrightarrow\\;\n\\frac{1}{\\lambda} = \\operatorname{arsinh}\\!\\left(\\frac{\\hbar\\omega_D}{\\Delta}\\right).$$\nSolving for $\\Delta$ by taking the hyperbolic sine of both sides:\n$$\\sinh\\!\\left(\\frac{1}{\\lambda}\\right) = \\frac{\\hbar\\omega_D}{\\Delta}.$$\nThis yields the final expression for the gap:\n$$\\Delta=\\frac{\\hbar\\omega_D}{\\sinh\\!\\bigl(1/\\lambda\\bigr)}\n=\\frac{\\hbar\\omega_D}{\\sinh\\!\\bigl(\\tfrac{2\\pi\\hbar^2}{mV}\\bigr)}\\,. $$", "answer": "$$\\boxed{\\Delta = \\frac{\\hbar\\,\\omega_D}{\\sinh\\!\\bigl(\\tfrac{2\\pi\\hbar^2}{m\\,V}\\bigr)}}$$", "id": "632281"}, {"introduction": "Analytical solutions to the BCS gap equation are typically confined to simplified cases, such as zero temperature or a constant density of states. To explore the rich, temperature-dependent behavior of a superconductor, we must turn to numerical methods. This capstone practice [@problem_id:2415410] guides you through a full computational solution of the coupled equations for the energy gap $\\Delta$ and the chemical potential $\\mu$. By implementing a multidimensional root-finding algorithm, you will determine the gap's response to changes in temperature and electron concentration, a task that mirrors the practical work of a computational condensed matter physicist.", "problem": "Consider the finite-temperature mean-field theory of weak-coupling superconductivity known as Bardeen–Cooper–Schrieffer (BCS) theory. In a simplified model with a single, featureless electronic band of finite width and a constant density of states, the self-consistency condition for the superconducting energy gap and the conservation of particle number can be reduced to two coupled, nonlinear integral equations for the unknowns: the superconducting energy gap $\\Delta$ and the chemical potential $\\mu$. Your task is to solve these two equations simultaneously for $\\Delta$ and $\\mu$ using a multidimensional root-finding algorithm, and to report the value of $\\Delta$ for specified parameter sets.\n\nAssume the following physically standard and well-tested ingredients as the fundamental base:\n- The quasiparticle excitation energy is $E(\\varepsilon) = \\sqrt{(\\varepsilon - \\mu)^2 + \\Delta^2}$, where $\\varepsilon$ is the single-particle energy within the band.\n- The Fermi–Dirac distribution is $f(E) = \\left(1 + e^{E/(k_{\\mathrm{B}} T)}\\right)^{-1}$, and the combination $\\tanh\\!\\left(E/(2 k_{\\mathrm{B}} T)\\right)$ appears in thermal expectation values. Use the Boltzmann constant in energy units $k_{\\mathrm{B}} = 0.08617333262145\\,\\mathrm{meV/K}$.\n- The electronic band is flat with a constant total (including spin) density of states $N_0$ over a finite bandwidth $W$ centered at zero energy, i.e., $\\varepsilon \\in [-W/2, W/2]$, and $N_0 = 1/W$ so that the total number of single-particle states per site within the band is unity.\n- The attractive pairing interaction is nonzero only within a symmetric energy window of half-width $\\omega_{\\mathrm{D}}$ (Debye cutoff) around $\\mu$, and is characterized by a dimensionless coupling $\\lambda = g N_0$, where $g$ is the pairing interaction strength. In the constant density-of-states model, the coupling enters only through $\\lambda$.\n\nStarting from these definitions and using the standard mean-field decoupling for a singlet superconductor, the coupled equations to be solved for $\\Delta$ and $\\mu$ at temperature $T$ are:\n- The gap self-consistency equation in a form that admits the normal-state solution $\\Delta = 0$:\n$$\nF_{\\Delta}(\\Delta,\\mu;T,\\lambda,\\omega_{\\mathrm{D}},W) \\equiv \\Delta - \\lambda \\int_{\\mathcal{I}_{\\mathrm{D}}} \\frac{\\Delta}{2 E(\\varepsilon)} \\tanh\\!\\left(\\frac{E(\\varepsilon)}{2 k_{\\mathrm{B}} T}\\right) \\, \\mathrm{d}\\varepsilon = 0,\n$$\nwhere the Debye integration window is $\\mathcal{I}_{\\mathrm{D}} = \\{\\varepsilon \\in [-W/2, W/2] : |\\varepsilon - \\mu| \\le \\omega_{\\mathrm{D}}\\}$.\n- The number conservation equation that fixes the filling fraction $\\nu \\in [0,1]$:\n$$\nF_{n}(\\Delta,\\mu;T,\\nu,W) \\equiv \\nu - \\int_{-W/2}^{W/2} N_0 \\left[ 1 - \\frac{\\varepsilon - \\mu}{E(\\varepsilon)} \\tanh\\!\\left(\\frac{E(\\varepsilon)}{2 k_{\\mathrm{B}} T}\\right) \\right] \\mathrm{d}\\varepsilon = 0,\n$$\nwith $N_0 = 1/W$.\n\nNotes:\n- In the normal state above the critical temperature, the solution $\\Delta = 0$ with a suitable $\\mu$ must satisfy $F_{\\Delta} = 0$ and $F_{n} = 0$ simultaneously, due to the explicit factor of $\\Delta$ in $F_{\\Delta}$.\n- All energies in this problem, including $\\Delta$, $\\mu$, $W$, and $\\omega_{\\mathrm{D}}$, must be expressed in $\\mathrm{meV}$, and temperature in $\\mathrm{K}$. Angles do not appear, so no angle unit is needed.\n\nYour program must implement a robust multidimensional root-finding method to solve the system\n$$\n\\mathbf{F}(\\Delta,\\mu) = \\begin{bmatrix} F_{\\Delta}(\\Delta,\\mu;T,\\lambda,\\omega_{\\mathrm{D}},W) \\\\ F_{n}(\\Delta,\\mu;T,\\nu,W) \\end{bmatrix} = \\mathbf{0}\n$$\nfor each test case. Numerical evaluation of the integrals is required; use a method that achieves stable convergence for small $\\Delta$ and for temperatures near the superconducting transition.\n\nTest Suite:\nUse the following parameter sets, specified as tuples $(W\\,\\mathrm{[meV]}, \\omega_{\\mathrm{D}}\\,\\mathrm{[meV]}, \\lambda, \\nu, T\\,\\mathrm{[K]})$.\n\n- Case $\\mathrm{A}$ (happy path, below critical temperature): $(200, 20, 0.3, 0.5, 5)$.\n- Case $\\mathrm{B}$ (normal state, above critical temperature): $(200, 20, 0.3, 0.5, 12)$.\n- Case $\\mathrm{C}$ (near critical temperature): $(200, 20, 0.3, 0.5, 9.5)$.\n- Case $\\mathrm{D}$ (off half-filling, below critical temperature): $(200, 20, 0.3, 0.3, 5)$.\n\nRequired Output:\n- For each test case, return the superconducting energy gap $\\Delta$ in $\\mathrm{meV}$ as a floating-point number rounded to $6$ decimal places.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the same order as the test suite: for example, $[\\Delta_{\\mathrm{A}},\\Delta_{\\mathrm{B}},\\Delta_{\\mathrm{C}},\\Delta_{\\mathrm{D}}]$.\n\nConstraints and guidance:\n- Implement a genuine multidimensional root-finding strategy to solve for $\\Delta$ and $\\mu$ simultaneously for each case; do not reduce the system to a single equation.\n- Ensure numerical stability when $\\Delta \\rightarrow 0$ by designing the integrals and function evaluations to avoid spurious divergences.\n- All calculations must be self-contained and require no user input. Use only the standard libraries plus the specified numerical libraries.", "solution": "The problem requires the numerical solution of a system of two coupled, non-linear equations for the superconducting gap $\\Delta$ and the chemical potential $\\mu$. The system is given by $\\mathbf{F}(\\Delta, \\mu) = [F_{\\Delta}(\\Delta, \\mu), F_{n}(\\Delta, \\mu)]^T = \\mathbf{0}$. This is a classic root-finding problem in two dimensions, which is solved by the provided Python code.\n\n**Methodology:**\n1.  **Numerical Solver:** We employ a multi-dimensional root-finding algorithm. The provided Python code uses `scipy.optimize.root` with the `'hybr'` method, which implements a modification of the Powell hybrid method. This is a robust choice for non-linear systems of equations as it does not require an explicitly provided Jacobian matrix.\n\n2.  **Function Implementation:** The core of the task is to implement a Python function `system_equations(x, ...)` that takes a vector `x = [Delta, mu]` and the model parameters, and returns the vector `[f_delta, f_n]`. This function requires numerical integration.\n    *   **Integrals:** The integrals in $F_{\\Delta}$ and $F_{n}$ are computed using `scipy.integrate.quad`, a high-precision adaptive quadrature routine.\n    *   **Numerical Stability:** For numerical stability, several points are crucial:\n        *   The gap equation $F_{\\Delta}$ is written as $\\Delta - \\lambda \\int \\dots = 0$. This form naturally handles the normal state solution, as $\\Delta=0$ makes the equation $0=0$.\n        *   In the number equation $F_{n}$, the integrand term $(\\varepsilon - \\mu)/E(\\varepsilon)$ becomes non-analytic at $\\varepsilon=\\mu$ when $\\Delta \\to 0$. To handle this, the location of the chemical potential `mu` is passed to the `points` argument of the `quad` integrator, instructing it to pay special attention to this point, which improves accuracy.\n\n3.  **Initial Guesses:** The success of iterative solvers heavily depends on good initial guesses for $(\\Delta_0, \\mu_0)$.\n    *   **Chemical Potential ($\\mu_0$):** For a half-filled band ($\\nu=0.5$), particle-hole symmetry implies the chemical potential will be pinned at the band center, so $\\mu_0 = 0$. For other fillings, a good initial guess is the non-interacting, zero-temperature chemical potential, $\\mu_0 = W(\\nu - 0.5)$.\n    *   **Energy Gap ($\\Delta_0$):** The existence of a non-zero gap depends on whether the temperature $T$ is below the critical temperature $T_c$. For the given parameters ($\\lambda=0.3, \\omega_D=20$ meV), the weak-coupling approximation $k_B T_c \\approx 1.13 \\omega_D e^{-1/\\lambda}$ gives $T_c \\approx 9.35$ K.\n        *   For cases where $T  T_c$ (A and D), we expect $\\Delta > 0$ and use a non-zero initial guess, e.g., $\\Delta_0 = 1.0$ meV.\n        *   For cases where $T > T_c$ (B), we expect $\\Delta=0$ and use a very small initial guess, e.g., $\\Delta_0 = 0.01$ meV, to guide the solver to the normal state solution.\n        *   For $T \\approx T_c$ (C), the gap will be small, so a small initial guess like $\\Delta_0 = 0.1$ meV is appropriate.\n\n4.  **Execution and Results:** The provided Python code implements this logic. For each test case, it sets up the appropriate parameters and initial guesses, calls the root solver, and extracts the resulting value of $\\Delta$. The physical gap is a non-negative quantity, so the absolute value of the solver's result is reported. Results that are numerically very close to zero (e.g., $ 10^{-9}$) are set to exactly zero.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import root\nfrom scipy.integrate import quad\n\n# Define constants\nK_B = 0.08617333262145  # Boltzmann constant in meV/K\n\ndef system_equations(x, W, omega_D, lambda_, nu, T):\n    \"\"\"\n    Defines the system of nonlinear equations F(x) = 0 for the BCS problem.\n    x: array-like, x[0] = Delta (gap), x[1] = mu (chemical potential)\n    W, omega_D, lambda_, nu, T: parameters of the model.\n    \"\"\"\n    delta, mu = x\n    N0 = 1.0 / W\n\n    # --- F_delta equation ---\n    # F_delta = delta - lambda * integral_delta\n    # Integrand for the gap equation.\n    def integrand_delta(eps, d, m):\n        # The equation from the problem is F_delta = delta - lambda * integral(delta/E * ...).\n        # It is odd in delta. We must use the 'd' from the solver, not abs(d).\n        # We handle d=0 as a special case to avoid division by zero in the term delta/E.\n        if d == 0.0:\n            return 0.0\n        \n        # The argument of sqrt is delta^2, so it's always non-negative.\n        E_eps = np.sqrt((eps - m)**2 + d**2)\n        if E_eps == 0.0: # Should not happen if d != 0\n            return 0.0\n        \n        tanh_term = np.tanh(E_eps / (2.0 * K_B * T))\n        return (d / (2.0 * E_eps)) * tanh_term\n\n    # Integration bounds for the gap equation.\n    lower_d = max(-W / 2.0, mu - omega_D)\n    upper_d = min(W / 2.0, mu + omega_D)\n    \n    integral_delta = 0.0\n    # Perform integration only if the interval is valid.\n    if lower_d  upper_d:\n        integral_delta, _ = quad(integrand_delta, lower_d, upper_d, args=(delta, mu), epsabs=1e-11, epsrel=1e-11)\n    \n    f_delta = delta - lambda_ * integral_delta\n\n    # --- F_n equation ---\n    # F_n = nu - integral_n\n    # The number equation depends on delta^2, so using abs(delta) is robust.\n    delta_abs = abs(delta)\n    \n    # Integrand for the number equation.\n    def integrand_n(eps, d_abs, m):\n        E_eps = np.sqrt((eps - m)**2 + d_abs**2)\n        \n        if E_eps == 0.0:  # Occurs only if d_abs=0 and eps=m\n            # The limit of the term ((eps-m)/E_eps) * tanh(E_eps/...) is 0 as eps->m.\n            frac_term = 0.0\n        else:\n            tanh_term = np.tanh(E_eps / (2.0 * K_B * T))\n            frac_term = ((eps - m) / E_eps) * tanh_term\n            \n        return N0 * (1.0 - frac_term)\n    \n    # Integration for number equation over the full band.\n    # We specify mu as a point of potential discontinuity for the integrator.\n    points_of_interest = [mu] if -W / 2.0  mu  W / 2.0 else None\n    integral_n, _ = quad(integrand_n, -W / 2.0, W / 2.0, args=(delta_abs, mu), points=points_of_interest, epsabs=1e-11, epsrel=1e-11)\n    \n    f_n = nu - integral_n\n    \n    return [f_delta, f_n]\n\ndef solve():\n    \"\"\"\n    Solves the BCS equations for each test case and prints the results.\n    \"\"\"\n    test_cases = [\n        # (W [meV], omega_D [meV], lambda, nu, T [K])\n        (200.0, 20.0, 0.3, 0.5, 5.0),    # Case A\n        (200.0, 20.0, 0.3, 0.5, 12.0),   # Case B\n        (200.0, 20.0, 0.3, 0.5, 9.5),    # Case C\n        (200.0, 20.0, 0.3, 0.3, 5.0),    # Case D\n    ]\n\n    # Initial guesses (Delta_0, mu_0) based on physical considerations.\n    initial_guesses = [\n        # T_c is approx 9.35 K. W(nu-0.5) gives mu_0 for non-half-filled cases.\n        (1.0, 0.0),      # A: T  T_c, nu=0.5 -> expect Delta > 0, mu=0\n        (0.01, 0.0),     # B: T > T_c, nu=0.5 -> expect Delta = 0, mu=0\n        (0.1, 0.0),      # C: T ~ T_c, nu=0.5 -> expect Delta small or 0, mu=0\n        (1.0, -40.0),    # D: T  T_c, nu=0.3 -> expect Delta > 0, mu=200(0.3-0.5)=-40\n    ]\n\n    results = []\n    for i, params in enumerate(test_cases):\n        x0 = initial_guesses[i]\n        \n        # Use a robust root-finding algorithm.\n        solution = root(system_equations, x0, args=params, method='hybr', tol=1e-9)\n        \n        if solution.success:\n            delta_sol = solution.x[0]\n            \n            # The physical gap parameter is non-negative.\n            # If the solver returns a small negative value, it is numerically zero.\n            if abs(delta_sol)  1e-9:\n                delta_sol = 0.0\n            \n            # Report the magnitude of the gap.\n            results.append(abs(delta_sol))\n        else:\n            # Append NaN or handle error if solver fails, for robustness.\n            results.append(np.nan)\n\n    # Format the final output as a comma-separated list of strings,\n    # with each value rounded to 6 decimal places.\n    formatted_results = [f\"{res:.6f}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2415410"}]}