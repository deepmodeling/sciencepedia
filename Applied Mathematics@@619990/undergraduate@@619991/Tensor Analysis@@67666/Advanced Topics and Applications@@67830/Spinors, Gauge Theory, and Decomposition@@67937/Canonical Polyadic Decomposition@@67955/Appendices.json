{"hands_on_practices": [{"introduction": "The Canonical Polyadic (CP) decomposition expresses a complex, multi-dimensional tensor as a sum of simpler, rank-one components. This first exercise focuses on the forward process: constructing a tensor from its known factors. Mastering this fundamental calculation [@problem_id:1491540] is the first step toward understanding how CP decomposition represents underlying patterns within data by building a tensor from the ground up.", "problem": "In tensor analysis, a third-order tensor $\\mathcal{T} \\in \\mathbb{R}^{I \\times J \\times K}$ can be expressed using a Canonical Polyadic (CP) decomposition, also known as Parallel Factor Analysis (PARAFAC), as a sum of rank-1 tensors. A rank-1 tensor is formed by the outer product of three vectors, denoted as $\\mathbf{a} \\circ \\mathbf{b} \\circ \\mathbf{c}$, where $\\mathbf{a} \\in \\mathbb{R}^{I}$, $\\mathbf{b} \\in \\mathbb{R}^{J}$, and $\\mathbf{c} \\in \\mathbb{R}^{K}$.\n\nConsider a tensor $\\mathcal{T}$ of size $2 \\times 2 \\times 2$ which is constructed by summing three distinct rank-1 tensors. The rank of this tensor is thus 3. These three rank-1 tensors are defined by the outer products of the following sets of vectors:\n\nSet 1: $\\mathbf{a}^{(1)} = \\begin{pmatrix} 1 \\\\ 2 \\end{pmatrix}$, $\\mathbf{b}^{(1)} = \\begin{pmatrix} 3 \\\\ 0 \\end{pmatrix}$, $\\mathbf{c}^{(1)} = \\begin{pmatrix} -1 \\\\ 1 \\end{pmatrix}$\n\nSet 2: $\\mathbf{a}^{(2)} = \\begin{pmatrix} 0 \\\\ -2 \\end{pmatrix}$, $\\mathbf{b}^{(2)} = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$, $\\mathbf{c}^{(2)} = \\begin{pmatrix} 2 \\\\ 1 \\end{pmatrix}$\n\nSet 3: $\\mathbf{a}^{(3)} = \\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix}$, $\\mathbf{b}^{(3)} = \\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix}$, $\\mathbf{c}^{(3)} = \\begin{pmatrix} 0 \\\\ 2 \\end{pmatrix}$\n\nThe elements of the resulting tensor $\\mathcal{T}$ are denoted by $\\mathcal{T}_{ijk}$, where the indices $i, j, k$ range from 1 to 2. Calculate the value of the element $\\mathcal{T}_{212}$.", "solution": "A third-order tensor with a CP decomposition $\\mathcal{T}=\\sum_{r=1}^{R}\\mathbf{a}^{(r)}\\circ\\mathbf{b}^{(r)}\\circ\\mathbf{c}^{(r)}$ has entries given by\n$$\n\\mathcal{T}_{ijk}=\\sum_{r=1}^{R}a_{i}^{(r)}b_{j}^{(r)}c_{k}^{(r)}.\n$$\nHere $R=3$. For the requested entry with indices $(i,j,k)=(2,1,2)$,\n$$\n\\mathcal{T}_{212}=\\sum_{r=1}^{3}a_{2}^{(r)}b_{1}^{(r)}c_{2}^{(r)}.\n$$\nCompute each term:\n- For $r=1$: $a_{2}^{(1)}=2$, $b_{1}^{(1)}=3$, $c_{2}^{(1)}=1$, so the product is $2\\cdot 3\\cdot 1=6$.\n- For $r=2$: $a_{2}^{(2)}=-2$, $b_{1}^{(2)}=1$, $c_{2}^{(2)}=1$, so the product is $-2\\cdot 1\\cdot 1=-2$.\n- For $r=3$: $a_{2}^{(3)}=-1$, $b_{1}^{(3)}=1$, $c_{2}^{(3)}=2$, so the product is $-1\\cdot 1\\cdot 2=-2$.\n\nSumming these contributions,\n$$\n\\mathcal{T}_{212}=6+(-2)+(-2)=2.\n$$", "answer": "$$\\boxed{2}$$", "id": "1491540"}, {"introduction": "While constructing a tensor from its factors is straightforward, the real power of CP decomposition lies in the inverse problem: uncovering the hidden factors from observed data. This practice problem [@problem_id:1491551] provides a simple, rank-one tensor and asks you to reverse the process. This exercise highlights how the structure of a tensor's elements reveals its constituent vectors and introduces the important concept of normalization, which is necessary to resolve scaling ambiguities in the solution.", "problem": "A third-order tensor $\\mathcal{T} \\in \\mathbb{R}^{I \\times J \\times K}$ is of rank one if it can be expressed as the outer product of three vectors: $\\mathbf{a} \\in \\mathbb{R}^{I}$, $\\mathbf{b} \\in \\mathbb{R}^{J}$, and $\\mathbf{c} \\in \\mathbb{R}^{K}$. This decomposition, known as the Canonical Polyadic (CP) decomposition, is written as $\\mathcal{T} = \\mathbf{a} \\circ \\mathbf{b} \\circ \\mathbf{c}$, which corresponds to the element-wise equation $T_{ijk} = a_i b_j c_k$ for all valid indices $i, j, k$.\n\nConsider a rank-one tensor $\\mathcal{T} \\in \\mathbb{R}^{2 \\times 2 \\times 2}$, whose elements are specified by its two frontal slices, $T_{::1}$ (for $k=1$) and $T_{::2}$ (for $k=2$):\n$$\nT_{::1} = \\begin{pmatrix} T_{111} & T_{121} \\\\ T_{211} & T_{221} \\end{pmatrix} = \\begin{pmatrix} 2 & 8 \\\\ -6 & -24 \\end{pmatrix}\n$$\n$$\nT_{::2} = \\begin{pmatrix} T_{112} & T_{122} \\\\ T_{212} & T_{222} \\end{pmatrix} = \\begin{pmatrix} -5 & -20 \\\\ 15 & 60 \\end{pmatrix}\n$$\n\nThe factor vectors $\\mathbf{a} = \\begin{pmatrix} a_1 \\\\ a_2 \\end{pmatrix}$, $\\mathbf{b} = \\begin{pmatrix} b_1 \\\\ b_2 \\end{pmatrix}$, and $\\mathbf{c} = \\begin{pmatrix} c_1 \\\\ c_2 \\end{pmatrix}$ are not unique due to scaling freedom. To obtain a unique solution, the decomposition is normalized by the convention that the first element of vectors $\\mathbf{a}$ and $\\mathbf{b}$ is 1, i.e., $a_1 = 1$ and $b_1 = 1$.\n\nGiven this information, determine the value of the second element of vector $\\mathbf{b}$, denoted as $b_2$.", "solution": "The problem asks for the value of $b_2$ in the rank-one Canonical Polyadic (CP) decomposition of a given third-order tensor $\\mathcal{T} \\in \\mathbb{R}^{2 \\times 2 \\times 2}$.\n\nThe defining relationship for the rank-one CP decomposition is given by the element-wise equation:\n$$\nT_{ijk} = a_i b_j c_k\n$$\nwhere $\\mathbf{a} = \\begin{pmatrix} a_1 \\\\ a_2 \\end{pmatrix}$, $\\mathbf{b} = \\begin{pmatrix} b_1 \\\\ b_2 \\end{pmatrix}$, and $\\mathbf{c} = \\begin{pmatrix} c_1 \\\\ c_2 \\end{pmatrix}$ are the factor vectors.\n\nThe problem provides a normalization constraint to ensure a unique solution for the factor vectors:\n$$\na_1 = 1\n$$\n$$\nb_1 = 1\n$$\n\nWe are given the elements of the tensor $\\mathcal{T}$ as two frontal slices. Let's write out the equations for a few elements of the tensor using the decomposition formula and the normalization constraints.\n\nConsider the elements from the first frontal slice ($k=1$):\nThe element $T_{111}$ is given by:\n$$\nT_{111} = a_1 b_1 c_1\n$$\nSubstituting the known values $T_{111} = 2$, $a_1 = 1$, and $b_1 = 1$:\n$$\n2 = (1)(1)c_1 \\implies c_1 = 2\n$$\n\nNow, consider the element $T_{121}$, which also belongs to the first frontal slice ($k=1$):\n$$\nT_{121} = a_1 b_2 c_1\n$$\nWe are given $T_{121} = 8$. We also have $a_1 = 1$ and we just found that $c_1 = 2$. Substituting these values into the equation for $T_{121}$:\n$$\n8 = (1) b_2 (2)\n$$\n$$\n8 = 2 b_2\n$$\nSolving for $b_2$, which is the quantity we want to find:\n$$\nb_2 = \\frac{8}{2} = 4\n$$\n\nThe value of the second element of vector $\\mathbf{b}$ is 4.\n\nFor completeness, we can find all other components and verify that they are consistent with the full tensor.\nFrom $T_{211} = a_2 b_1 c_1$:\n$$\n-6 = a_2 (1) (2) \\implies a_2 = -3\n$$\nFrom $T_{112} = a_1 b_1 c_2$:\n$$\n-5 = (1) (1) c_2 \\implies c_2 = -5\n$$\n\nSo, the factor vectors are:\n$$\n\\mathbf{a} = \\begin{pmatrix} 1 \\\\ -3 \\end{pmatrix}, \\quad \\mathbf{b} = \\begin{pmatrix} 1 \\\\ 4 \\end{pmatrix}, \\quad \\mathbf{c} = \\begin{pmatrix} 2 \\\\ -5 \\end{pmatrix}\n$$\n\nLet's check if these vectors correctly reconstruct the entire tensor $\\mathcal{T}$.\n$T_{221} = a_2 b_2 c_1 = (-3)(4)(2) = -24$. This matches the given tensor.\n$T_{122} = a_1 b_2 c_2 = (1)(4)(-5) = -20$. This matches the given tensor.\n$T_{212} = a_2 b_1 c_2 = (-3)(1)(-5) = 15$. This matches the given tensor.\n$T_{222} = a_2 b_2 c_2 = (-3)(4)(-5) = 60$. This matches the given tensor.\n\nAll elements match, confirming our calculations are correct. The value we were asked to find is $b_2$.", "answer": "$$\\boxed{4}$$", "id": "1491551"}, {"introduction": "In practice, CP decompositions are presented in a standardized or \"normalized\" form to ensure uniqueness and aid in interpretation. This usually involves scaling the factor vectors to have a unit norm and absorbing the scaling factors into a separate weight, $\\lambda_r$. This problem [@problem_id:1491573] provides a hands-on opportunity to work with this convention by converting a rank-one tensor defined by arbitrary vectors into its normalized form, thereby clarifying the distinct roles of the factor vectors and their associated weights.", "problem": "The Canonical Polyadic (CP) decomposition, also known as PARAFAC or CANDECOMP, is a method to express a tensor as a sum of rank-one tensors. For a third-order tensor $\\mathcal{T}$, a common convention for its CP decomposition is:\n$$ \\mathcal{T} = \\sum_{r=1}^{R} \\lambda_r (\\mathbf{a}_r \\circ \\mathbf{b}_r \\circ \\mathbf{c}_r) $$\nwhere $R$ is the tensor's rank, $\\lambda_r > 0$ are scalar weights, and the vectors $\\mathbf{a}_r, \\mathbf{b}_r, \\mathbf{c}_r$ are required to have a unit Euclidean norm (i.e., for any vector $\\mathbf{v}$, its norm is $\\|\\mathbf{v}\\|_2 = 1$). The outer product of three vectors is defined element-wise as $(\\mathbf{a} \\circ \\mathbf{b} \\circ \\mathbf{c})_{ijk} = a_i b_j c_k$.\n\nConsider a third-order tensor $\\mathcal{A} \\in \\mathbb{R}^{2 \\times 2 \\times 2}$ that is known to be of rank one ($R=1$). It is constructed from the outer product of three vectors $\\mathbf{u}, \\mathbf{v}, \\mathbf{w} \\in \\mathbb{R}^2$ as $\\mathcal{A} = \\mathbf{u} \\circ \\mathbf{v} \\circ \\mathbf{w}$. The vectors are given by:\n$$ \\mathbf{u} = \\begin{pmatrix} 3 \\\\ 4 \\end{pmatrix}, \\quad \\mathbf{v} = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}, \\quad \\mathbf{w} = \\begin{pmatrix} 5 \\\\ 12 \\end{pmatrix} $$\nDetermine the CP decomposition of the tensor $\\mathcal{A}$ in the normalized form described above. As the final answer, provide the numerical value of the weight $\\lambda_1$.", "solution": "For a rank-one third-order tensor, the normalized CP form is\n$$\n\\mathcal{A}=\\lambda_{1}\\left(\\mathbf{a}_{1}\\circ\\mathbf{b}_{1}\\circ\\mathbf{c}_{1}\\right),\n$$\nwith $\\|\\mathbf{a}_{1}\\|_{2}=\\|\\mathbf{b}_{1}\\|_{2}=\\|\\mathbf{c}_{1}\\|_{2}=1$ and $\\lambda_{1}>0$. Given $\\mathcal{A}=\\mathbf{u}\\circ\\mathbf{v}\\circ\\mathbf{w}$, write each vector as its norm times a unit vector:\n$$\n\\mathbf{u}=\\|\\mathbf{u}\\|_{2}\\,\\mathbf{a}_{1},\\quad \\mathbf{v}=\\|\\mathbf{v}\\|_{2}\\,\\mathbf{b}_{1},\\quad \\mathbf{w}=\\|\\mathbf{w}\\|_{2}\\,\\mathbf{c}_{1},\n$$\nwhere $\\mathbf{a}_{1}=\\mathbf{u}/\\|\\mathbf{u}\\|_{2}$, $\\mathbf{b}_{1}=\\mathbf{v}/\\|\\mathbf{v}\\|_{2}$, and $\\mathbf{c}_{1}=\\mathbf{w}/\\|\\mathbf{w}\\|_{2}$ are unit vectors by construction. Using the scalar associativity with the outer product,\n$$\n(\\alpha\\mathbf{a})\\circ(\\beta\\mathbf{b})\\circ(\\gamma\\mathbf{c})=(\\alpha\\beta\\gamma)\\,(\\mathbf{a}\\circ\\mathbf{b}\\circ\\mathbf{c}),\n$$\nwe obtain\n$$\n\\mathcal{A}=(\\|\\mathbf{u}\\|_{2}\\,\\|\\mathbf{v}\\|_{2}\\,\\|\\mathbf{w}\\|_{2})\\,(\\mathbf{a}_{1}\\circ\\mathbf{b}_{1}\\circ\\mathbf{c}_{1}),\n$$\nso the weight is\n$$\n\\lambda_{1}=\\|\\mathbf{u}\\|_{2}\\,\\|\\mathbf{v}\\|_{2}\\,\\|\\mathbf{w}\\|_{2}.\n$$\nCompute the norms using $\\|\\mathbf{x}\\|_{2}=\\sqrt{\\sum_{i} x_{i}^{2}}$:\n$$\n\\|\\mathbf{u}\\|_{2}=\\sqrt{3^{2}+4^{2}}=5,\\quad \\|\\mathbf{v}\\|_{2}=\\sqrt{1^{2}+0^{2}}=1,\\quad \\|\\mathbf{w}\\|_{2}=\\sqrt{5^{2}+12^{2}}=13.\n$$\nTherefore,\n$$\n\\lambda_{1}=5\\cdot 1\\cdot 13=65.\n$$\nThis yields the normalized factor vectors $\\mathbf{a}_{1}=\\begin{pmatrix}\\frac{3}{5} \\\\ \\frac{4}{5}\\end{pmatrix}$, $\\mathbf{b}_{1}=\\begin{pmatrix}1 \\\\ 0\\end{pmatrix}$, $\\mathbf{c}_{1}=\\begin{pmatrix}\\frac{5}{13} \\\\ \\frac{12}{13}\\end{pmatrix}$, all of which have unit norm, and $\\lambda_{1}>0$ as required.", "answer": "$$\\boxed{65}$$", "id": "1491573"}]}