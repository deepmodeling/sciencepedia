{"hands_on_practices": [{"introduction": "Before diving into complex manipulations, it's essential to have a way to quantify the overall \"size\" or magnitude of a tensor. The Frobenius norm provides a straightforward and intuitive method, extending the familiar Pythagorean concept of length to multi-dimensional arrays. This practice provides a foundational exercise in handling tensor elements and computing a fundamental metric used throughout numerical tensor analysis [@problem_id:1527710].", "problem": "Consider a rank-3 tensor $T$ with components $T_{ijk}$, where the indices $i$, $j$, and $k$ can take the values $i \\in \\{1, 2\\}$, $j \\in \\{1, 2\\}$, and $k \\in \\{1, 2, 3\\}$. The tensor can be represented by three $2 \\times 2$ matrices (or \"slices\") corresponding to each value of $k$.\n\nFor $k=1$, the slice is:\n$$\n(T_{ij1}) = \\begin{pmatrix} T_{111} & T_{121} \\\\ T_{211} & T_{221} \\end{pmatrix} = \\begin{pmatrix} 1 & -2 \\\\ 3 & 0 \\end{pmatrix}\n$$\n\nFor $k=2$, the slice is:\n$$\n(T_{ij2}) = \\begin{pmatrix} T_{112} & T_{122} \\\\ T_{212} & T_{222} \\end{pmatrix} = \\begin{pmatrix} 4 & -1 \\\\ 2 & 5 \\end{pmatrix}\n$$\n\nFor $k=3$, the slice is:\n$$\n(T_{ij3}) = \\begin{pmatrix} T_{113} & T_{123} \\\\ T_{213} & T_{223} \\end{pmatrix} = \\begin{pmatrix} -3 & 1 \\\\ 0 & -2 \\end{pmatrix}\n$$\n\nThe Frobenius norm of a rank-3 tensor $T$ is defined as the square root of the sum of the squares of all its components, given by the formula:\n$$\n\\|T\\|_F = \\sqrt{\\sum_{i=1}^{2} \\sum_{j=1}^{2} \\sum_{k=1}^{3} (T_{ijk})^2}\n$$\n\nCalculate the value of the Frobenius norm $\\|T\\|_F$ for the given tensor $T$. Round your final answer to four significant figures.", "solution": "The Frobenius norm of a rank-3 tensor $T$ with components $T_{ijk}$ is defined by\n$$\n\\|T\\|_{F}=\\sqrt{\\sum_{i=1}^{2}\\sum_{j=1}^{2}\\sum_{k=1}^{3} T_{ijk}^{2}}=\\sqrt{\\sum_{k=1}^{3}\\sum_{i=1}^{2}\\sum_{j=1}^{2} T_{ijk}^{2}}.\n$$\nCompute the sum of squares slice by slice.\n\nFor $k=1$:\n$$\n1^{2}+(-2)^{2}+3^{2}+0^{2}=1+4+9+0=14.\n$$\nFor $k=2$:\n$$\n4^{2}+(-1)^{2}+2^{2}+5^{2}=16+1+4+25=46.\n$$\nFor $k=3$:\n$$\n(-3)^{2}+1^{2}+0^{2}+(-2)^{2}=9+1+0+4=14.\n$$\nTherefore, the total sum of squares is\n$$\n14+46+14=74,\n$$\nand the Frobenius norm is\n$$\n\\|T\\|_{F}=\\sqrt{74}\\approx 8.602325267\\ldots\n$$\nRounded to four significant figures, this is $8.602$.", "answer": "$$\\boxed{8.602}$$", "id": "1527710"}, {"introduction": "Tensors in real-world applications can be massive, making them difficult to store and analyze. Tensor decompositions, such as the CANDECOMP/PARAFAC (CP) decomposition, address this by approximating a large tensor as a sum of simple, rank-one components, which is invaluable for data compression and feature extraction. This exercise reverses the process, allowing you to reconstruct a tensor from its constituent factors, thereby building a concrete understanding of how these powerful decompositions work [@problem_id:1527694].", "problem": "In multidimensional data science, the Canonical Polyadic Decomposition (CPD), also known as CANDECOMP/PARAFAC, is a fundamental tool for tensor factorization. It decomposes a tensor into a sum of rank-one tensors. This method is widely used in fields like chemometrics, signal processing, and social network analysis.\n\nConsider a 3rd-order tensor $\\mathcal{X}$ of size $2 \\times 3 \\times 2$. A CPD with a rank of $R=2$ is applied to this tensor, yielding three factor matrices: $\\mathbf{A} \\in \\mathbb{R}^{2 \\times 2}$, $\\mathbf{B} \\in \\mathbb{R}^{3 \\times 2}$, and $\\mathbf{C} \\in \\mathbb{R}^{2 \\times 2}$. The columns of these matrices, denoted $\\mathbf{a}_r, \\mathbf{b}_r, \\mathbf{c}_r$ for $r=1, \\dots, R$, represent the components of the decomposition.\n\nThe given factor matrices are:\n$$\n\\mathbf{A} = \\begin{pmatrix} 1 & -2 \\\\ 3 & 4 \\end{pmatrix}, \\quad \\mathbf{B} = \\begin{pmatrix} 1 & 0 \\\\ 2 & -1 \\\\ 5 & 2 \\end{pmatrix}, \\quad \\mathbf{C} = \\begin{pmatrix} 1 & 2 \\\\ 3 & 1 \\end{pmatrix}\n$$\nBased on this decomposition, calculate the value of the entry at position $(1, 2, 1)$ of the reconstructed tensor. This entry is denoted by $\\mathcal{X}_{121}$.", "solution": "In a canonical polyadic decomposition of a 3rd-order tensor with rank $R$, the reconstructed entry at position $(i,j,k)$ is given by the sum over components:\n$$\n\\mathcal{X}_{i j k}=\\sum_{r=1}^{R} a_{i r}\\, b_{j r}\\, c_{k r}.\n$$\nHere, $R=2$ and we need $\\mathcal{X}_{121}$, so\n$$\n\\mathcal{X}_{121}=\\sum_{r=1}^{2} a_{1 r}\\, b_{2 r}\\, c_{1 r}.\n$$\nFrom the given factor matrices,\n$$\n\\mathbf{A}=\\begin{pmatrix}1 & -2 \\\\ 3 & 4\\end{pmatrix},\\quad\n\\mathbf{B}=\\begin{pmatrix}1 & 0 \\\\ 2 & -1 \\\\ 5 & 2\\end{pmatrix},\\quad\n\\mathbf{C}=\\begin{pmatrix}1 & 2 \\\\ 3 & 1\\end{pmatrix},\n$$\nwe read off:\n$$\na_{11}=1,\\quad a_{12}=-2;\\quad b_{21}=2,\\quad b_{22}=-1;\\quad c_{11}=1,\\quad c_{12}=2.\n$$\nCompute each term:\n$$\n\\text{for } r=1:\\quad a_{11} b_{21} c_{11} = 1 \\cdot 2 \\cdot 1 = 2,\n$$\n$$\n\\text{for } r=2:\\quad a_{12} b_{22} c_{12} = (-2) \\cdot (-1) \\cdot 2 = 4.\n$$\nSumming gives\n$$\n\\mathcal{X}_{121} = 2 + 4 = 6.\n$$", "answer": "$$\\boxed{6}$$", "id": "1527694"}, {"introduction": "In many advanced scientific and engineering models, the final answer is obtained by contracting a network of interconnected tensors. The order in which these contractions are performed has a drastic impact on the total computational cost, with an inefficient choice making the calculation intractable. This practice challenges you to think like a computational scientist by finding the optimal contraction path to minimize floating-point operations, a critical skill for developing efficient tensor-based algorithms [@problem_id:1527713].", "problem": "Consider a network of four interconnected tensors, denoted $T_1, T_2, T_3, T_4$. The structure of the network is defined by shared indices, and the final computation involves summing over all indices to produce a single scalar value. The expression for this scalar is:\n$$ S = \\sum_{a,b,c,d,e} T_1(a,b) T_2(b,c,d) T_3(c,e) T_4(d,e,a) $$\nThe dimensions of the indices are given as: $\\dim(a) = 2$, $\\dim(b) = 3$, $\\dim(c) = 4$, $\\dim(d) = 5$, and $\\dim(e) = 6$.\n\nThe computation of the scalar $S$ is performed by a sequence of pairwise tensor contractions. The computational cost of contracting two tensors is measured in Floating-Point Operations (FLOPs), defined as the product of the dimensions of all unique indices present in the two tensors being contracted. The total cost is the sum of the costs of each pairwise contraction in the sequence.\n\nDifferent sequences of contractions result in different total costs. Your task is to find the most efficient sequence of contractions.\n\nCalculate the minimum possible total number of FLOPs required to compute the scalar $S$.", "solution": "Let the index-dimensions be $d(a)=2$, $d(b)=3$, $d(c)=4$, $d(d)=5$, $d(e)=6$. The FLOP cost to contract two tensors with index sets $I$ and $J$ is $\\prod_{i\\in I\\cup J} d(i)$. The resulting tensor carries indices $(I\\cup J)\\setminus(I\\cap J)$. We enumerate all possible first contractions and, for each, choose the best subsequent contractions.\n\n1) First contract $T_{1}(a,b)$ with $T_{2}(b,c,d)$ over $b$:\n- Cost $= d(a)d(b)d(c)d(d)=2\\cdot 3\\cdot 4\\cdot 5=120$. Result $X_{12}(a,c,d)$.\n  a) Then $X_{12}(a,c,d)$ with $T_{3}(c,e)$ over $c$:\n  - Cost $= d(a)d(c)d(d)d(e)=2\\cdot 4\\cdot 5\\cdot 6=240$. Result $X_{123}(a,d,e)$.\n  - Final $X_{123}(a,d,e)$ with $T_{4}(d,e,a)$ over $a,d,e$:\n  - Cost $= d(a)d(d)d(e)=2\\cdot 5\\cdot 6=60$.\n  - Total $=120+240+60=420$.\n  b) Then $X_{12}(a,c,d)$ with $T_{4}(d,e,a)$ over $a,d$:\n  - Cost $= d(a)d(c)d(d)d(e)=2\\cdot 4\\cdot 5\\cdot 6=240$. Result $X_{124}(c,e)$.\n  - Final $X_{124}(c,e)$ with $T_{3}(c,e)$ over $c,e$:\n  - Cost $= d(c)d(e)=4\\cdot 6=24$.\n  - Total $=120+240+24=384$.\n  c) Or $T_{3}(c,e)$ with $T_{4}(d,e,a)$ over $e$:\n  - Cost $= d(a)d(c)d(d)d(e)=2\\cdot 4\\cdot 5\\cdot 6=240$. Result $X_{34}(a,c,d)$.\n  - Final $X_{12}(a,c,d)$ with $X_{34}(a,c,d)$ over $a,c,d$:\n  - Cost $= d(a)d(c)d(d)=2\\cdot 4\\cdot 5=40$.\n  - Total $=120+240+40=400$.\n- Best from this start: $384$.\n\n2) First contract $T_{3}(c,e)$ with $T_{4}(d,e,a)$ over $e$:\n- Cost $= d(a)d(c)d(d)d(e)=2\\cdot 4\\cdot 5\\cdot 6=240$. Result $X_{34}(a,c,d)$.\n  a) Then $T_{1}(a,b)$ with $T_{2}(b,c,d)$ over $b$:\n  - Cost $= d(a)d(b)d(c)d(d)=2\\cdot 3\\cdot 4\\cdot 5=120$. Result $X_{12}(a,c,d)$.\n  - Final $X_{12}(a,c,d)$ with $X_{34}(a,c,d)$ over $a,c,d$:\n  - Cost $= d(a)d(c)d(d)=2\\cdot 4\\cdot 5=40$.\n  - Total $=240+120+40=400$.\n  b) Then $T_{1}(a,b)$ with $X_{34}(a,c,d)$ over $a$:\n  - Cost $= d(a)d(b)d(c)d(d)=2\\cdot 3\\cdot 4\\cdot 5=120$. Result $(b,c,d)$.\n  - Final with $T_{2}(b,c,d)$ over $b,c,d$:\n  - Cost $= d(b)d(c)d(d)=3\\cdot 4\\cdot 5=60$.\n  - Total $=240+120+60=420$.\n  c) Then $T_{2}(b,c,d)$ with $X_{34}(a,c,d)$ over $c,d$:\n  - Cost $= d(a)d(b)d(c)d(d)=2\\cdot 3\\cdot 4\\cdot 5=120$. Result $(a,b)$.\n  - Final with $T_{1}(a,b)$ over $a,b$:\n  - Cost $= d(a)d(b)=2\\cdot 3=6$.\n  - Total $=240+120+6=366$.\n- Best from this start: $366$.\n\n3) First contract $T_{1}(a,b)$ with $T_{4}(d,e,a)$ over $a$:\n- Cost $= d(a)d(b)d(d)d(e)=2\\cdot 3\\cdot 5\\cdot 6=180$. Result $X_{14}(b,d,e)$.\n  a) Then $X_{14}(b,d,e)$ with $T_{2}(b,c,d)$ over $b,d$:\n  - Cost $= d(b)d(c)d(d)d(e)=3\\cdot 4\\cdot 5\\cdot 6=360$. Result $(c,e)$.\n  - Final with $T_{3}(c,e)$ over $c,e$:\n  - Cost $= d(c)d(e)=4\\cdot 6=24$.\n  - Total $=180+360+24=564$.\n  b) Then $X_{14}(b,d,e)$ with $T_{3}(c,e)$ over $e$:\n  - Cost $= d(b)d(c)d(d)d(e)=3\\cdot 4\\cdot 5\\cdot 6=360$. Result $(b,c,d)$.\n  - Final with $T_{2}(b,c,d)$ over $b,c,d$:\n  - Cost $= d(b)d(c)d(d)=3\\cdot 4\\cdot 5=60$.\n  - Total $=180+360+60=600$.\n  c) Or $T_{2}(b,c,d)$ with $T_{3}(c,e)$ over $c$:\n  - Cost $= d(b)d(c)d(d)d(e)=3\\cdot 4\\cdot 5\\cdot 6=360$. Result $(b,d,e)$.\n  - Final with $X_{14}(b,d,e)$ over $b,d,e$:\n  - Cost $= d(b)d(d)d(e)=3\\cdot 5\\cdot 6=90$.\n  - Total $=180+360+90=630$.\n- Best from this start: $564$.\n\n4) First contract $T_{2}(b,c,d)$ with $T_{3}(c,e)$ over $c$:\n- Cost $= d(b)d(c)d(d)d(e)=3\\cdot 4\\cdot 5\\cdot 6=360$. Result $X_{23}(b,d,e)$.\n  a) Then $X_{23}(b,d,e)$ with $T_{1}(a,b)$ over $b$:\n  - Cost $= d(a)d(b)d(d)d(e)=2\\cdot 3\\cdot 5\\cdot 6=180$. Result $(a,d,e)$.\n  - Final with $T_{4}(d,e,a)$ over $a,d,e$:\n  - Cost $= d(a)d(d)d(e)=2\\cdot 5\\cdot 6=60$.\n  - Total $=360+180+60=600$.\n  b) Then $X_{23}(b,d,e)$ with $T_{4}(d,e,a)$ over $d,e$:\n  - Cost $= d(a)d(b)d(d)d(e)=2\\cdot 3\\cdot 5\\cdot 6=180$. Result $(a,b)$.\n  - Final with $T_{1}(a,b)$ over $a,b$:\n  - Cost $= d(a)d(b)=2\\cdot 3=6$.\n  - Total $=360+180+6=546$.\n  c) Or $T_{1}(a,b)$ with $T_{4}(d,e,a)$ over $a$:\n  - Cost $= d(a)d(b)d(d)d(e)=2\\cdot 3\\cdot 5\\cdot 6=180$. Result $(b,d,e)$.\n  - Final with $X_{23}(b,d,e)$ over $b,d,e$:\n  - Cost $= d(b)d(d)d(e)=3\\cdot 5\\cdot 6=90$.\n  - Total $=360+180+90=630$.\n- Best from this start: $546$.\n\n5) First contract $T_{2}(b,c,d)$ with $T_{4}(d,e,a)$ over $d$:\n- Cost $= d(a)d(b)d(c)d(d)d(e)=2\\cdot 3\\cdot 4\\cdot 5\\cdot 6=720$. Best continuation yields totals at least $720+144+6=870$ (for example, contracting the result with $T_{3}$ over $c,e$ to $(a,b)$ and then with $T_{1}$).\n- Best from this start: $870$.\n\n6) First contract $T_{1}(a,b)$ with $T_{3}(c,e)$ (outer product, no shared index):\n- Cost $= d(a)d(b)d(c)d(e)=2\\cdot 3\\cdot 4\\cdot 6=144$. Best continuation (e.g., contracting with $T_{2}$ over $b,c$ to $(a,d,e)$, then with $T_{4}$) gives total $144+720+60=924$.\n- Best from this start: $924$.\n\nAmong all sequences, the minimum total FLOPs is attained by:\n- First: $T_{3}(c,e)$ with $T_{4}(d,e,a)$ over $e$ (cost $240$), result $X_{34}(a,c,d)$.\n- Second: $T_{2}(b,c,d)$ with $X_{34}(a,c,d)$ over $c,d$ (cost $120$), result $(a,b)$.\n- Third: $(a,b)$ with $T_{1}(a,b)$ over $a,b$ (cost $6$).\n\nThus the minimum total number of FLOPs is $240+120+6=366$.", "answer": "$$\\boxed{366}$$", "id": "1527713"}]}