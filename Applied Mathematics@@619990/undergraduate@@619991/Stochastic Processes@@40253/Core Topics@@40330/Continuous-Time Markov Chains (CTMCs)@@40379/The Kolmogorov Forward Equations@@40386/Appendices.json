{"hands_on_practices": [{"introduction": "The Kolmogorov forward equations form the differential heart of continuous-time Markov chains, linking the instantaneous transition rates in the generator matrix $Q$ to the evolution of state probabilities over time. Before attempting to solve these equations, it is essential to understand how to verify a potential solution. This foundational exercise [@problem_id:1340356] challenges you to act as a reviewer of a hypothetical scientific model, using the core relationship $P'(t)=P(t)Q$ to test the validity of a proposed transition matrix $P(t)$ for a simple two-state system. This practice grounds the theory in a concrete verification task, a crucial skill in mathematical modeling.", "problem": "A simplified model for a single ion channel in a nerve cell membrane considers two states: State 1 (Open) and State 2 (Closed). Transitions between these states are modeled as a continuous-time Markov chain. The rate of transition from the Open state to the Closed state is $\\lambda > 0$, and the rate of transition from the Closed state to the Open state is $\\mu > 0$. The dynamics of this system can be described by the generator matrix $Q$, where the element $Q_{ij}$ for $i \\neq j$ is the transition rate from state $i$ to state $j$.\n\nThe generator matrix for this two-state system is given by:\n$$\nQ = \\begin{pmatrix} -\\lambda & \\lambda \\\\ \\mu & -\\mu \\end{pmatrix}\n$$\n\nA researcher proposes a model for the transition probability matrix $P(t) = (P_{ij}(t))$, where $P_{ij}(t)$ is the probability that the channel is in state $j$ at time $t$, given it was in state $i$ at time $0$. The proposed matrix is:\n$$\nP(t) = \\begin{pmatrix} \\exp(-\\lambda t) & 1 - \\exp(-\\lambda t) \\\\ 1 - \\exp(-\\mu t) & \\exp(-\\mu t) \\end{pmatrix}\n$$\n\nAn essential property of a valid transition matrix for a system with generator $Q$ is that its time derivative, $P'(t)$, must satisfy the matrix differential equation $P'(t) = P(t)Q$. Based on this information, which of the following statements about the proposed $P(t)$ is correct?\n\nA. The proposed matrix $P(t)$ is a valid transition matrix for the system.\n\nB. The proposed matrix $P(t)$ is invalid because its row sums are not equal to 1.\n\nC. The proposed matrix $P(t)$ is invalid because it does not satisfy the initial condition $P(0) = I$, where $I$ is the identity matrix.\n\nD. The proposed matrix $P(t)$ is invalid because it does not satisfy the differential equation $P'(t) = P(t)Q$.", "solution": "We have a two-state continuous-time Markov chain (CTMC) with generator\n$$\nQ=\\begin{pmatrix}\n-\\lambda & \\lambda\\\\\n\\mu & -\\mu\n\\end{pmatrix},\n$$\nwhere $\\lambda>0$ is the rate from Open to Closed and $\\mu>0$ is the rate from Closed to Open. For a valid transition probability matrix $P(t)$, three key properties must hold:\n- Row-stochasticity: each row sums to $1$ for all $t\\geq 0$.\n- Initial condition: $P(0)=I$.\n- Kolmogorov forward equation: $P'(t)=P(t)Q$ for all $t\\geq 0$.\n\nThe proposed matrix is\n$$\nP(t)=\\begin{pmatrix}\n\\exp(-\\lambda t) & 1-\\exp(-\\lambda t)\\\\\n1-\\exp(-\\mu t) & \\exp(-\\mu t)\n\\end{pmatrix}.\n$$\n\nFirst, check row sums. For the first row,\n$$\n\\exp(-\\lambda t)+\\bigl(1-\\exp(-\\lambda t)\\bigr)=1.\n$$\nFor the second row,\n$$\n\\bigl(1-\\exp(-\\mu t)\\bigr)+\\exp(-\\mu t)=1.\n$$\nThus each row sums to $1$, so the matrix is row-stochastic and option B is false.\n\nSecond, check the initial condition:\n$$\nP(0)=\\begin{pmatrix}\n\\exp(0) & 1-\\exp(0)\\\\\n1-\\exp(0) & \\exp(0)\n\\end{pmatrix}\n=\\begin{pmatrix}\n1 & 0\\\\\n0 & 1\n\\end{pmatrix}=I.\n$$\nTherefore, option C is false.\n\nThird, check the Kolmogorov forward equation $P'(t)=P(t)Q$. Compute $P'(t)$ by differentiating entrywise:\n$$\nP'(t)=\\begin{pmatrix}\n-\\lambda\\,\\exp(-\\lambda t) & \\lambda\\,\\exp(-\\lambda t)\\\\\n\\mu\\,\\exp(-\\mu t) & -\\mu\\,\\exp(-\\mu t)\n\\end{pmatrix}.\n$$\nNow compute the product $P(t)Q$:\n- The $(1,1)$ entry:\n$$\n\\exp(-\\lambda t)\\cdot(-\\lambda)+\\bigl(1-\\exp(-\\lambda t)\\bigr)\\cdot\\mu\n= -\\lambda\\,\\exp(-\\lambda t)+\\mu-\\mu\\,\\exp(-\\lambda t)\n= \\mu-(\\lambda+\\mu)\\exp(-\\lambda t).\n$$\n- The $(1,2)$ entry:\n$$\n\\exp(-\\lambda t)\\cdot\\lambda+\\bigl(1-\\exp(-\\lambda t)\\bigr)\\cdot(-\\mu)\n= \\lambda\\,\\exp(-\\lambda t)-\\mu+\\mu\\,\\exp(-\\lambda t)\n= -\\mu+(\\lambda+\\mu)\\exp(-\\lambda t).\n$$\n- The $(2,1)$ entry:\n$$\n\\bigl(1-\\exp(-\\mu t)\\bigr)\\cdot(-\\lambda)+\\exp(-\\mu t)\\cdot\\mu\n= -\\lambda+\\lambda\\,\\exp(-\\mu t)+\\mu\\,\\exp(-\\mu t)\n= -\\lambda+(\\lambda+\\mu)\\exp(-\\mu t).\n$$\n- The $(2,2)$ entry:\n$$\n\\bigl(1-\\exp(-\\mu t)\\bigr)\\cdot\\lambda+\\exp(-\\mu t)\\cdot(-\\mu)\n= \\lambda-\\lambda\\,\\exp(-\\mu t)-\\mu\\,\\exp(-\\mu t)\n= \\lambda-(\\lambda+\\mu)\\exp(-\\mu t).\n$$\nThus\n$$\nP(t)Q=\\begin{pmatrix}\n\\mu-(\\lambda+\\mu)\\exp(-\\lambda t) & -\\mu+(\\lambda+\\mu)\\exp(-\\lambda t)\\\\\n-\\lambda+(\\lambda+\\mu)\\exp(-\\mu t) & \\lambda-(\\lambda+\\mu)\\exp(-\\mu t)\n\\end{pmatrix}.\n$$\nCompare $P'(t)$ with $P(t)Q$. For the $(1,1)$ entry,\n$$\nP'_{11}(t)=-\\lambda\\,\\exp(-\\lambda t),\\quad \\bigl(P(t)Q\\bigr)_{11}=\\mu-(\\lambda+\\mu)\\exp(-\\lambda t).\n$$\nThese are equal for all $t$ only if $\\mu=0$, which contradicts $\\mu>0$. More explicitly,\n$$\nP'_{11}(t)-\\bigl(P(t)Q\\bigr)_{11}=\\mu\\bigl(\\exp(-\\lambda t)-1\\bigr)\\neq 0\n$$\nfor $t>0$. Hence $P'(t)\\neq P(t)Q$ for $t>0$, so the proposed $P(t)$ violates the Kolmogorov forward equation. Therefore, option D is correct.\n\nFor completeness, note that $P'(0)=Q$ does hold:\n$$\nP'(0)=\\begin{pmatrix}\n-\\lambda & \\lambda\\\\\n\\mu & -\\mu\n\\end{pmatrix}=Q,\n$$\nbut this is not sufficient; the equality must hold for all $t\\geq 0$, which it does not.\n\nTherefore, the proposed $P(t)$ is invalid because it does not satisfy $P'(t)=P(t)Q$.", "answer": "$$\\boxed{D}$$", "id": "1340356"}, {"introduction": "While the Kolmogorov forward equations provide a complete description of a system's dynamics, solving the infinite system of differential equations for the state probabilities $p_n(t)$ is often infeasible. This practice introduces a powerful analytical shortcut: using the system of equations to derive a single, simple differential equation for a macroscopic quantity of interest, in this case, the expected population size $M(t)$. By manipulating the forward equations for a linear birth-death process [@problem_id:1340377], you will uncover how the mean behavior of the system evolves, a technique that is fundamental to analyzing complex stochastic systems without needing to know a particle's every move.", "problem": "A new decentralized social network is launched. The number of active users, $N(t)$, at any time $t$ after launch is modeled as a continuous-time stochastic process. The dynamics of user engagement are described by a linear birth-death process.\n\nThe \"birth\" of a new user corresponds to an individual joining the network. The rate at which new users join is assumed to be proportional to the current number of active users, $n$, with a constant per-capita joining rate of $\\lambda$. Thus, the total rate of transitions from state $n$ to state $n+1$ is $\\lambda n$.\n\nThe \"death\" of a user corresponds to an individual leaving the network. The rate at which users leave is also proportional to the current number of active users, with a constant per-capita departure rate of $\\mu$. Thus, the total rate of transitions from state $n$ to state $n-1$ is $\\mu n$. For a state with zero users ($n=0$), the departure rate is zero.\n\nLet $p_n(t)$ be the probability that there are exactly $n$ users on the network at time $t$. The expected number of active users is given by $M(t) = \\sum_{n=0}^{\\infty} n p_n(t)$. The time evolution of this expectation can be described by a first-order ordinary differential equation of the form $\\frac{dM(t)}{dt} = f(M(t))$.\n\nDetermine the function $f(M(t))$ that governs the rate of change of the expected number of users. Your answer should be an expression in terms of $M(t)$, $\\lambda$, and $\\mu$.", "solution": "Let $N(t)$ be a linear birth-death process with transition rates $\\lambda n$ from $n$ to $n+1$ and $\\mu n$ from $n$ to $n-1$. Let $p_{n}(t)$ denote $\\Pr(N(t)=n)$ and $M(t)=\\sum_{n=0}^{\\infty} n p_{n}(t)$.\n\nThe Kolmogorov forward equations are, for $n\\geq 1$,\n$$\n\\frac{d p_{n}(t)}{dt}=\\lambda (n-1) p_{n-1}(t)+\\mu (n+1) p_{n+1}(t)-(\\lambda n+\\mu n) p_{n}(t),\n$$\nand for $n=0$,\n$$\n\\frac{d p_{0}(t)}{dt}=\\mu p_{1}(t).\n$$\nDifferentiate $M(t)$ and interchange sum and derivative:\n$$\n\\frac{dM(t)}{dt}=\\sum_{n=0}^{\\infty} n \\frac{d p_{n}(t)}{dt}=\\sum_{n=1}^{\\infty} n \\frac{d p_{n}(t)}{dt}.\n$$\nSubstitute the forward equation for $n\\geq 1$:\n$$\n\\frac{dM(t)}{dt}=\\sum_{n=1}^{\\infty} n\\left[\\lambda (n-1) p_{n-1}(t)+\\mu (n+1) p_{n+1}(t)-(\\lambda+\\mu) n p_{n}(t)\\right].\n$$\nHandle each sum by index shifts. For the birth inflow term, set $m=n-1$:\n$$\n\\sum_{n=1}^{\\infty} n \\lambda (n-1) p_{n-1}(t)=\\lambda \\sum_{m=0}^{\\infty} (m+1) m\\, p_{m}(t)=\\lambda \\left(\\sum_{m=0}^{\\infty} m^{2} p_{m}(t)+\\sum_{m=0}^{\\infty} m p_{m}(t)\\right).\n$$\nFor the death inflow term, set $k=n+1$:\n$$\n\\sum_{n=1}^{\\infty} n \\mu (n+1) p_{n+1}(t)=\\mu \\sum_{k=2}^{\\infty} (k-1) k\\, p_{k}(t)=\\mu \\left(\\sum_{k=0}^{\\infty} k^{2} p_{k}(t)-\\sum_{k=0}^{\\infty} k p_{k}(t)\\right).\n$$\nFor the outflow term,\n$$\n\\sum_{n=1}^{\\infty} n (\\lambda+\\mu) n p_{n}(t)=(\\lambda+\\mu)\\sum_{n=0}^{\\infty} n^{2} p_{n}(t).\n$$\nIntroduce $E[N(t)]=M(t)$ and $E[N(t)^{2}]=\\sum_{n=0}^{\\infty} n^{2} p_{n}(t)$ to combine terms:\n$$\n\\frac{dM(t)}{dt}=\\lambda \\left(E[N(t)^{2}]+M(t)\\right)+\\mu \\left(E[N(t)^{2}]-M(t)\\right)-(\\lambda+\\mu) E[N(t)^{2}].\n$$\nThe $E[N(t)^{2}]$ terms cancel, giving\n$$\n\\frac{dM(t)}{dt}=(\\lambda-\\mu) M(t).\n$$\nThus the function governing the rate of change of the expected number of users is\n$$\nf(M(t))=(\\lambda-\\mu) M(t).\n$$\nEquivalently, by the generator $\\mathcal{L}$ of the process acting on $f(n)=n$, $\\mathcal{L}f(n)=\\lambda n[(n+1)-n]+\\mu n[(n-1)-n]=(\\lambda-\\mu) n$, and taking expectations yields the same result.", "answer": "$$\\boxed{(\\lambda-\\mu) M(t)}$$", "id": "1340377"}, {"introduction": "Many real-world processes, from radioactive decay to system failure, eventually end in an absorbing state. Analyzing the time spent in transient states before this absorption is a key problem in survival and reliability analysis. This exercise [@problem_id:1340402] extends the use of the forward equations to this important class of problems. You will work with the sub-generator matrix for transient states, $Q_T$, to derive a compact and elegant matrix expression for the expected total time the system spends in each transient state before absorption. This reveals a deep connection between the generator matrix and the long-term fate of the system.", "problem": "Consider a simplified model for the electronic behavior of a quantum dot. The dot has a single ground state, which we label as state 0, and a set of $N$ distinct metastable excited energy levels, labeled as states $1, 2, \\dots, N$. An electron within this system can transition between these states. The dynamics are modeled as a Continuous-Time Markov Chain (CTMC) on the state space $S = \\{0, 1, 2, \\dots, N\\}$.\n\nThe ground state (state 0) is an absorbing state; once the electron enters this state, it remains there. The excited levels (states $1, 2, \\dots, N$) are transient states. The constant transition rate from any state $i \\in S$ to another state $j \\in S$ ($j \\ne i$) is denoted by $q_{ij} \\ge 0$. As state 0 is absorbing, $q_{0j} = 0$ for all $j \\in S$. The system is guaranteed to eventually enter the absorbing state from any transient state.\n\nThe generator matrix of the CTMC is an $(N+1) \\times (N+1)$ matrix $Q$ where the off-diagonal entries are $Q_{ij} = q_{ij}$ and the diagonal entries are $Q_{ii} = -\\sum_{j \\ne i} q_{ij}$. Let $Q_T$ be the $N \\times N$ sub-generator matrix corresponding to transitions among the transient states $\\{1, 2, \\dots, N\\}$. That is, the entry of $Q_T$ at row $i$ and column $j$ (for $i,j \\in \\{1, \\dots, N\\}$) is the transition rate $q_{ij}$ if $i \\ne j$, and $q_{ii}$ if $i=j$. You may assume that $Q_T$ is an invertible matrix.\n\nSuppose the electron is initially in the excited state $i \\in \\{1, 2, \\dots, N\\}$ at time $t=0$. Let $m_{ij}$ be the expected total time the electron spends in the excited state $j \\in \\{1, 2, \\dots, N\\}$ before it is absorbed into the ground state 0. Let $M_T$ be the $N \\times N$ matrix where the entry at row $i$ and column $j$ is $m_{ij}$.\n\nUsing the Kolmogorov forward equations, derive a compact matrix expression for $M_T$ in terms of the sub-generator matrix $Q_T$.", "solution": "Let $X_{t}$ be the CTMC with generator $Q$ and transient sub-generator $Q_{T}$ on states $\\{1,\\dots,N\\}$. Fix an initial excited state $i \\in \\{1,\\dots,N\\}$. Let $p^{(i)}(t)$ denote the row vector of transient-state probabilities at time $t$, with components $p^{(i)}_{j}(t) = \\mathbb{P}(X_{t}=j \\mid X_{0}=i)$ for $j \\in \\{1,\\dots,N\\}$. By the Kolmogorov forward equation restricted to the transient class,\n$$\n\\frac{d}{dt} p^{(i)}(t) = p^{(i)}(t) Q_{T}, \\qquad p^{(i)}(0) = e_{i}^{\\top},\n$$\nwhere $e_{i}$ is the $i$-th standard basis vector in $\\mathbb{R}^{N}$. The solution is\n$$\np^{(i)}(t) = e_{i}^{\\top} \\exp(Q_{T} t).\n$$\nThe expected total time spent in transient state $j$ before absorption, starting from $i$, is\n$$\nm_{ij} = \\int_{0}^{\\infty} p^{(i)}_{j}(t)\\, dt = \\int_{0}^{\\infty} \\left(e_{i}^{\\top} \\exp(Q_{T} t)\\right)_{j} \\, dt.\n$$\nStacking these expectations for all $i$ as rows gives the matrix\n$$\nM_{T} = \\int_{0}^{\\infty} \\exp(Q_{T} t)\\, dt.\n$$\nBecause all transient states are guaranteed to be absorbed and $Q_{T}$ is invertible, the spectrum of $Q_{T}$ lies in the open left half-plane, so the integral converges. Using matrix calculus,\n$$\nQ_{T} \\int_{0}^{\\infty} \\exp(Q_{T} t)\\, dt = \\left[\\exp(Q_{T} t)\\right]_{0}^{\\infty} = 0 - I,\n$$\nwhich implies\n$$\n\\int_{0}^{\\infty} \\exp(Q_{T} t)\\, dt = - Q_{T}^{-1}.\n$$\nTherefore,\n$$\nM_{T} = - Q_{T}^{-1}.\n$$", "answer": "$$\\boxed{-Q_{T}^{-1}}$$", "id": "1340402"}]}