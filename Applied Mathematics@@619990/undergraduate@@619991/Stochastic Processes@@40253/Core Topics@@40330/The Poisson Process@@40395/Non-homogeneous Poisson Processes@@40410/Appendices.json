{"hands_on_practices": [{"introduction": "A core feature of a non-homogeneous Poisson process (NHPP) is its time-varying intensity function, $\\lambda(t)$. This first practice focuses on the fundamental skill of calculating the expected number of events over a specific time window. In this exercise [@problem_id:1321730], you will work with a piecewise intensity function, which is common in models where conditions change abruptly, such as a call center's traffic shifting after an initial morning rush. Mastering this calculation is the first step toward analyzing any NHPP model.", "problem": "A customer service center tracks the arrival of incoming support calls. The arrivals can be modeled as a non-homogeneous Poisson process, where the rate of calls varies depending on the time of day. Let $t$ be the time in minutes measured from the center's opening at 9:00 AM. In the first 30 minutes of operation, the call center is very busy, and calls arrive with an intensity of $\\lambda(t) = 2.0$ calls per minute. After this initial rush, for $t > 30$ minutes, the intensity drops to $\\lambda(t) = 0.5$ calls per minute.\n\nAn analyst is interested in the activity during the time window from 9:28 AM to 9:33 AM. Calculate the probability that the service center receives at least two calls during this specific time interval.\n\nRound your final answer to four significant figures.", "solution": "Let $t$ denote minutes since 9:00 AM. The interval of interest is from $t=28$ to $t=33$. For a non-homogeneous Poisson process with intensity $\\lambda(t)$, the number of arrivals $N$ in $[a,b]$ is Poisson with mean\n$$\n\\Lambda(a,b)=\\int_{a}^{b}\\lambda(t)\\,dt.\n$$\nHere, $\\lambda(t)=2.0$ for $0\\le t\\le 30$ and $\\lambda(t)=0.5$ for $t>30$, so\n$$\n\\Lambda(28,33)=\\int_{28}^{30}2.0\\,dt+\\int_{30}^{33}0.5\\,dt=2.0\\cdot(30-28)+0.5\\cdot(33-30)=4+1.5=5.5.\n$$\nThus $N\\sim\\mathrm{Poisson}(5.5)$. The probability of receiving at least two calls is\n$$\n\\mathbb{P}(N\\ge 2)=1-\\mathbb{P}(N=0)-\\mathbb{P}(N=1)=1-\\exp(-5.5)-5.5\\,\\exp(-5.5)=1-\\exp(-5.5)\\left(1+5.5\\right).\n$$\nNumerically,\n$$\n\\exp(-5.5)\\approx 0.0040867714,\\quad \\exp(-5.5)\\left(1+5.5\\right)\\approx 0.0265640141,\n$$\nso\n$$\n\\mathbb{P}(N\\ge 2)\\approx 0.9734359859\\approx 0.9734 \\text{ (to four significant figures)}.\n$$", "answer": "$$\\boxed{0.9734}$$", "id": "1321730"}, {"introduction": "Beyond simply counting events, it's often crucial to understand when they are most likely to occur. This exercise [@problem_id:1321697] delves into the conditional probability of an event's timing. You will determine the likelihood that a goal in a soccer match occurred early in the game, given that exactly one goal was scored in the entire first half. This problem illuminates a key property of NHPPs: the probability of an event occurring in a sub-interval depends on the integrated intensity $\\Lambda(t)$, not just the duration of the interval.", "problem": "In a statistical analysis of professional soccer matches, the rate of goal scoring is found to be non-constant over time, often increasing as players become fatigued. This phenomenon is modeled using a time-dependent rate function $\\lambda(t)$, where $t$ is the time in minutes from the start of the match. For a particular game, this rate is described by the function $\\lambda(t) = A + Bt$, with given constants $A = 0.01 \\text{ min}^{-1}$ and $B = 0.001 \\text{ min}^{-2}$.\n\nSuppose it is known that exactly one goal was scored during the first half of this game, which lasts for 45 minutes. What is the probability that this single goal was scored within the first 15 minutes of the game?\n\nProvide your answer as a decimal rounded to four significant figures.", "solution": "Model the goals as a nonhomogeneous Poisson process with rate $\\lambda(t)=A+Bt$. Its cumulative intensity is\n$$\n\\Lambda(t)=\\int_{0}^{t}\\lambda(u)\\,du=\\int_{0}^{t}\\left(A+Bu\\right)\\,du=At+\\frac{B}{2}t^{2}.\n$$\nLet $T=45$ and $s=15$. Using independent increments of the nonhomogeneous Poisson process, $N(s)\\sim \\text{Poisson}(\\Lambda(s))$ and $N(T)-N(s)\\sim \\text{Poisson}(\\Lambda(T)-\\Lambda(s))$, independent. Therefore\n$$\n\\mathbb{P}(N(s)=1,\\,N(T)-N(s)=0)=\\exp(-\\Lambda(T))\\,\\Lambda(s),\n$$\nand\n$$\n\\mathbb{P}(N(T)=1)=\\exp(-\\Lambda(T))\\,\\Lambda(T).\n$$\nHence the desired conditional probability is\n$$\n\\mathbb{P}(\\text{the single goal occurs by }s \\mid N(T)=1)=\\frac{\\Lambda(s)}{\\Lambda(T)}.\n$$\nWith $A=0.01$ and $B=0.001$,\n$$\n\\Lambda(15)=A\\cdot 15+\\frac{B}{2}\\cdot 15^{2}=0.15+0.1125=0.2625,\n$$\n$$\n\\Lambda(45)=A\\cdot 45+\\frac{B}{2}\\cdot 45^{2}=0.45+1.0125=1.4625.\n$$\nThus\n$$\n\\frac{\\Lambda(15)}{\\Lambda(45)}=\\frac{0.2625}{1.4625}=\\frac{21/80}{117/80}=\\frac{21}{117}=\\frac{7}{39}\\approx 0.179487\\ldots\n$$\nRounded to four significant figures, this is $0.1795$.", "answer": "$$\\boxed{0.1795}$$", "id": "1321697"}, {"introduction": "While analytical calculations are foundational, simulating a process is a powerful tool for understanding its behavior and making predictions. This final practice [@problem_id:1332048] moves from theory to application by guiding you through the \"thinning method,\" a standard algorithm for simulating an NHPP. By generating candidate event times from a simpler, constant-rate process and then deciding whether to accept or reject them based on the true intensity $\\lambda(t)$, you will gain a concrete, hands-on understanding of how a time-varying rate dynamically shapes the sequence of events.", "problem": "An e-commerce company is analyzing server request patterns during a 10-minute \"flash sale\" event. The rate of incoming requests, $\\lambda(t)$, is not constant. It is modeled as a time-dependent intensity function, where $t$ is the time in minutes from the start of the sale at $t=0$. The intensity function is triangular: it increases linearly from 0 at $t=0$ to a peak value of $\\lambda_{max} = 20$ requests per minute at time $t_{peak} = 4$ minutes, and then decreases linearly back to 0 at the end of the sale, $T = 10$ minutes.\n\nTo simulate this non-homogeneous Poisson process, the thinning method (also known as the acceptance-rejection method) is used. The method first generates candidate event times from a homogeneous Poisson process with a constant rate $\\lambda^*$ that envelops the true intensity function, i.e., $\\lambda^* \\geq \\lambda(t)$ for all $t$ in $[0, T]$. The optimal choice $\\lambda^* = \\max_{t \\in [0,T]} \\lambda(t)$ is used.\n\nSuppose a set of five candidate request times, $S_i$, have been generated from this majorant homogeneous process. For each candidate time $S_i$, a corresponding random number $U_i$ is drawn from a uniform distribution on $[0, 1]$ to decide whether to \"thin\" (reject) or keep (accept) the candidate time.\n\nThe generated data are as follows:\n- Candidate times (in minutes): $S_1 = 1.20, S_2 = 3.50, S_3 = 4.80, S_4 = 6.50, S_5 = 9.20$\n- Uniform random numbers: $U_1 = 0.25, U_2 = 0.90, U_3 = 0.85, U_4 = 0.51, U_5 = 0.15$\n\nUsing the thinning method, determine which candidate requests are accepted. Calculate the sum of the times of these accepted requests. Express your final answer in minutes, rounded to three significant figures.", "solution": "The thinning method accepts a candidate time $S$ with probability $p(S) = \\lambda(S)/\\lambda^{*}$, where $\\lambda^{*} = \\max_{t \\in [0,T]} \\lambda(t)$. For the given triangular intensity over $[0,10]$ minutes:\n- For $0 \\leq t \\leq 4$, the intensity increases linearly from $0$ to $20$, so $\\lambda(t) = 5 t$.\n- For $4 \\leq t \\leq 10$, the intensity decreases linearly from $20$ to $0$, so $\\lambda(t) = 20 - \\frac{10}{3}(t-4) = \\frac{100}{3} - \\frac{10}{3} t$.\nHence $\\lambda^{*} = 20$, and the acceptance probability is\n$$\np(t) = \\frac{\\lambda(t)}{20} =\n\\begin{cases}\n\\frac{t}{4}, & 0 \\leq t \\leq 4 \\\\\n\\frac{10 - t}{6}, & 4 \\leq t \\leq 10\n\\end{cases}\n$$\nAccept if $U_{i} \\leq p(S_{i})$, otherwise reject.\n\nEvaluate each candidate:\n1) $S_{1} = 1.20 \\in [0,4]$: $p(S_{1}) = \\frac{1.20}{4} = 0.30 = \\frac{3}{10}$. Since $U_{1} = 0.25 \\leq 0.30$, accept $S_{1}$.\n\n2) $S_{2} = 3.50 \\in [0,4]$: $p(S_{2}) = \\frac{3.50}{4} = 0.875 = \\frac{7}{8}$. Since $U_{2} = 0.90 > 0.875$, reject $S_{2}$.\n\n3) $S_{3} = 4.80 \\in [4,10]$: $p(S_{3}) = \\frac{10 - 4.80}{6} = \\frac{5.20}{6} = \\frac{13}{15} \\approx 0.8667$. Since $U_{3} = 0.85 \\leq \\frac{13}{15}$, accept $S_{3}$.\n\n4) $S_{4} = 6.50 \\in [4,10]$: $p(S_{4}) = \\frac{10 - 6.50}{6} = \\frac{3.50}{6} = \\frac{7}{12} \\approx 0.5833$. Since $U_{4} = 0.51 \\leq \\frac{7}{12}$, accept $S_{4}$.\n\n5) $S_{5} = 9.20 \\in [4,10]$: $p(S_{5}) = \\frac{10 - 9.20}{6} = \\frac{0.80}{6} = \\frac{2}{15} \\approx 0.1333$. Since $U_{5} = 0.15 > \\frac{2}{15}$, reject $S_{5}$.\n\nAccepted candidate times are $S_{1} = 1.20$, $S_{3} = 4.80$, and $S_{4} = 6.50$. The sum of accepted times is\n$$\n1.20 + 4.80 + 6.50 = 12.50 \\text{ minutes}.\n$$\nRounded to three significant figures, the result is $12.5$ minutes.", "answer": "$$\\boxed{12.5}$$", "id": "1332048"}]}