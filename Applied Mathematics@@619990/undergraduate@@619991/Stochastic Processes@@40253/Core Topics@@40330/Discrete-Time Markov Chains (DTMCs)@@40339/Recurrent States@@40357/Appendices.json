{"hands_on_practices": [{"introduction": "This first practice problem provides a gentle introduction to the core concepts of recurrence in a tangible setting. We'll analyze a hypothetical digital system that can be modeled as a simple two-state Markov chain and determine if its states are recurrent [@problem_id:1329896]. This exercise is fundamental for learning how to identify an irreducible, finite chain and for mastering the cornerstone technique of calculating the mean recurrence time from the stationary distribution.", "problem": "A simplified model for an adaptive digital system involves a counter whose parity (even or odd) determines the system's operational mode. The system's state is tracked by an internal counter, which starts at 0. At each time step, a random integer is generated by a specific pseudo-random number generator (PRNG) and added to the counter. The choice of PRNG mode depends on the current parity of the counter.\n\n- If the counter's current value is even, the system uses PRNG Mode E. In this mode, the probability of generating an odd integer is $q_E = 1/3$.\n- If the counter's current value is odd, the system uses PRNG Mode O. In this mode, the probability of generating an odd integer is $q_O = 3/4$.\n\nThe system is considered to be in state 'E' if the counter's value is even, and in state 'O' if the counter's value is odd. Which of the following statements is correct regarding state 'E' and its mean recurrence time, which is the expected number of steps for the system, starting in state 'E', to return to state 'E' for the first time?\n\nA. The state 'E' is a transient state.\n\nB. The state 'E' is recurrent, and the expected number of steps to return is $13/9$.\n\nC. The state 'E' is recurrent, and the expected number of steps to return is $13/4$.\n\nD. The state 'E' is recurrent, and the expected number of steps to return is $9/13$.\n\nE. The state 'E' is recurrent, and the expected number of steps to return is $2$.", "solution": "Interpret the parity of the counter as a two-state time-homogeneous Markov chain with states $E$ (even) and $O$ (odd). Adding an odd integer flips the parity; adding an even integer keeps the parity.\n\nFrom the problem:\n- In state $E$, the probability of generating an odd integer is $q_{E} = \\frac{1}{3}$, hence\n$$\nP(E \\to O) = \\frac{1}{3}, \\quad P(E \\to E) = 1 - \\frac{1}{3} = \\frac{2}{3}.\n$$\n- In state $O$, the probability of generating an odd integer is $q_{O} = \\frac{3}{4}$, hence\n$$\nP(O \\to E) = \\frac{3}{4}, \\quad P(O \\to O) = 1 - \\frac{3}{4} = \\frac{1}{4}.\n$$\n\nAll transition probabilities are strictly positive between the two states, so the chain is irreducible. Since $P(E \\to E) = \\frac{2}{3} > 0$ and $P(O \\to O) = \\frac{1}{4} > 0$, the chain is aperiodic. Any irreducible finite Markov chain is positive recurrent; thus state $E$ is recurrent.\n\nLet the stationary distribution be $(\\pi_{E}, \\pi_{O})$ with $\\pi_{E} + \\pi_{O} = 1$ and $\\pi = \\pi P$. Using the $E$-component of $\\pi = \\pi P$,\n$$\n\\pi_{E} = \\pi_{E}\\left(\\frac{2}{3}\\right) + \\pi_{O}\\left(\\frac{3}{4}\\right).\n$$\nRearrange to get\n$$\n\\pi_{E} - \\frac{2}{3}\\pi_{E} = \\frac{3}{4}\\pi_{O} \\quad \\Longrightarrow \\quad \\frac{1}{3}\\pi_{E} = \\frac{3}{4}\\pi_{O}.\n$$\nMultiply both sides by $12$ to clear denominators:\n$$\n4\\pi_{E} = 9\\pi_{O}.\n$$\nUsing $\\pi_{E} + \\pi_{O} = 1$, substitute $\\pi_{O} = 1 - \\pi_{E}$:\n$$\n4\\pi_{E} = 9(1 - \\pi_{E}) \\quad \\Longrightarrow \\quad 4\\pi_{E} = 9 - 9\\pi_{E} \\quad \\Longrightarrow \\quad 13\\pi_{E} = 9,\n$$\nhence\n$$\n\\pi_{E} = \\frac{9}{13}.\n$$\n\nFor an irreducible positive recurrent Markov chain, the mean recurrence time to state $E$ equals $1/\\pi_{E}$. Therefore,\n$$\n\\text{Mean recurrence time to } E = \\frac{1}{\\pi_{E}} = \\frac{13}{9}.\n$$\nThus, $E$ is recurrent and its expected return time is $\\frac{13}{9}$, which corresponds to option B.", "answer": "$$\\boxed{B}$$", "id": "1329896"}, {"introduction": "A deep understanding of recurrence often comes from studying its opposite: transience. This exercise explores a process that, by its very definition, cannot return to certain states once they are left, providing a clear example of transient behavior [@problem_id:1329889]. By analyzing this hypothetical quality control model, you will practice identifying transient states and calculating the expected number of times the process will occupy such a state before moving on permanently.", "problem": "A quality control system for a manufacturing process relies on a sensor that produces integer readings from 1 to 6, inclusive. Each reading is independent, and each integer value is equally likely to be observed. A stochastic process, denoted by $\\{S_n\\}_{n \\ge 1}$, is defined to track the reliability of the process, where $S_n$ is the minimum sensor reading observed over the first $n$ measurements. That is, if $X_k$ is the sensor reading at time step $k$, then $S_n = \\min\\{X_1, X_2, \\dots, X_n\\}$.\n\nSuppose the system is initialized and the first sensor reading is $X_1 = 5$, which sets the initial state of the process to $S_1 = 5$.\n\nCalculate the expected total number of time steps $n$ (for $n \\ge 1$) for which the state of the process will be $S_n = 5$. Express your answer as an exact fraction in simplest form.", "solution": "Let $\\{X_{k}\\}_{k \\ge 1}$ be i.i.d. with uniform distribution on $\\{1,2,3,4,5,6\\}$, and let $S_{n}=\\min\\{X_{1},\\dots,X_{n}\\}$. Given $X_{1}=5$, we have $S_{1}=5$.\n\nThe state $S_{n}$ remains equal to $5$ for as long as no observation less than $5$ appears. A reading of $6$ leaves the minimum unchanged at $5$, while any reading in $\\{1,2,3,4\\}$ lowers the minimum below $5$ and ends the run of times with $S_{n}=5$.\n\nDefine the stopping time\n$$\nT=\\min\\{t \\ge 2 : X_{t} \\in \\{1,2,3,4\\}\\}.\n$$\nThen the total number of time steps with $S_{n}=5$ is\n$$\nN=\\#\\{n \\ge 1 : S_{n}=5\\}=T-1,\n$$\nsince these are exactly the times $n=1,2,\\dots,T-1$ before the first occurrence of a reading less than $5$.\n\nFor $t \\ge 2$, the events $\\{X_{t} \\in \\{1,2,3,4\\}\\}$ are independent with probability\n$$\np=\\mathbb{P}(X_{t} \\in \\{1,2,3,4\\})=\\frac{4}{6}=\\frac{2}{3},\n$$\nand $\\mathbb{P}(X_{t} \\in \\{5,6\\})=q=\\frac{2}{6}=\\frac{1}{3}$.\n\nFrom time $2$ onward, $T$ is the index of the first success in a sequence of independent Bernoulli trials with success probability $p$. If $Y$ denotes the number of trials from time $2$ until the first success (counting the success), then $Y$ is geometric with parameter $p$, so\n$$\n\\mathbb{E}[Y]=\\frac{1}{p}.\n$$\nSince $T=1+Y$, it follows that\n$$\nN=T-1=Y \\quad \\Rightarrow \\quad \\mathbb{E}[N]=\\mathbb{E}[Y]=\\frac{1}{p}=\\frac{1}{\\frac{2}{3}}=\\frac{3}{2}.\n$$\n\nEquivalently, using the tail-sum formula for nonnegative integer-valued $N$,\n$$\n\\mathbb{E}[N]=\\sum_{n=1}^{\\infty} \\mathbb{P}(N \\ge n)=\\sum_{n=1}^{\\infty} \\mathbb{P}(X_{2},\\dots,X_{n} \\in \\{5,6\\})=\\sum_{n=1}^{\\infty} q^{\\,n-1}=\\frac{1}{1-q}=\\frac{1}{1-\\frac{1}{3}}=\\frac{3}{2},\n$$\nwhich confirms the result.", "answer": "$$\\boxed{\\frac{3}{2}}$$", "id": "1329889"}, {"introduction": "Let's now scale up our analysis to a system with many more states, yet one that possesses an elegant underlying symmetry. This problem models a memory bank subject to random errors, which can be described as a birth-death process on a finite state space with $L+1$ states [@problem_id:1329929]. This practice offers a powerful illustration of how to use the principle of detailed balance to find the stationary distribution and apply Kac's lemma to determine the mean recurrence time in a more complex, but highly structured, scenario.", "problem": "A simplified model for the reliability of a digital memory bank considers it as a string of $L$ bits. Due to environmental factors, the memory is subject to random bit-flip errors. At each discrete time step, one bit is selected uniformly at random from the $L$ available positions, and its value is flipped (a 0 becomes a 1, and a 1 becomes a 0).\n\nLet the system be initialized in the \"all-ones\" state, which is the bit string consisting of $L$ ones. This process can be described by a Markov chain whose states are characterized by the number of '1's in the bit string. For any finite $L$, every state in this chain is recurrent, meaning that if the system starts in a particular state, it is certain to eventually return to it.\n\nYour task is to calculate the mean (expected) number of time steps required for the system, starting from the \"all-ones\" state, to return to this \"all-ones\" state for the first time. Express your answer as a closed-form analytic expression in terms of $L$.", "solution": "Model the chain by the number of ones, $k\\in\\{0,1,\\ldots,L\\}$. From state $k$, one of the $L$ bits is flipped uniformly at random, so the transition probabilities are\n$$\nP(k\\to k+1)=\\frac{L-k}{L}\\quad\\text{for }k<L,\\qquad P(k\\to k-1)=\\frac{k}{L}\\quad\\text{for }k>0,\n$$\nwith no other moves possible. This is a finite, irreducible birthâ€“death chain and thus positive recurrent.\n\nWe first find its stationary distribution $\\pi=\\{\\pi_{k}\\}_{k=0}^{L}$ using detailed balance. Reversibility requires\n$$\n\\pi_{k}\\,P(k\\to k+1)=\\pi_{k+1}\\,P(k+1\\to k)\\quad\\text{for }k=0,1,\\ldots,L-1,\n$$\nthat is,\n$$\n\\pi_{k}\\cdot\\frac{L-k}{L}=\\pi_{k+1}\\cdot\\frac{k+1}{L}.\n$$\nThis simplifies to the recurrence\n$$\n\\frac{\\pi_{k+1}}{\\pi_{k}}=\\frac{L-k}{k+1}.\n$$\nIterating from $k=0$ yields\n$$\n\\pi_{k}=\\pi_{0}\\prod_{j=0}^{k-1}\\frac{L-j}{j+1}=\\pi_{0}\\binom{L}{k}.\n$$\nNormalization $\\sum_{k=0}^{L}\\pi_{k}=1$ gives\n$$\n1=\\pi_{0}\\sum_{k=0}^{L}\\binom{L}{k}=\\pi_{0}\\,2^{L}\\quad\\Longrightarrow\\quad \\pi_{0}=2^{-L},\n$$\nhence\n$$\n\\pi_{k}=2^{-L}\\binom{L}{k}\\quad\\text{for all }k.\n$$\n\nThe all-ones bitstring corresponds uniquely to $k=L$. For an irreducible positive recurrent Markov chain with stationary distribution $\\pi$, Kacâ€™s lemma states that the mean recurrence time to a state equals the reciprocal of its stationary probability. Therefore, the mean time to return to $k=L$ is\n$$\n\\mathbb{E}[\\text{first return time to }k=L]=\\frac{1}{\\pi_{L}}=\\frac{1}{2^{-L}\\binom{L}{L}}=2^{L}.\n$$\nAlthough the chain is periodic with period $2$, Kacâ€™s formula for the mean recurrence time still holds, so the result is valid.\n\nThus, starting from the all-ones state, the expected number of steps to return to it for the first time is $2^{L}$.", "answer": "$$\\boxed{2^{L}}$$", "id": "1329929"}]}