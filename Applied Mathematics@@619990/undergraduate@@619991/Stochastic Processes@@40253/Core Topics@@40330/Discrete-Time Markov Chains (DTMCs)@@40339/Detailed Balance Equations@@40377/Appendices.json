{"hands_on_practices": [{"introduction": "Solving for the stationary distribution of a Markov chain often involves a system of linear equations, which can be cumbersome. However, for a special class of chains known as reversible chains, the principle of detailed balance provides a much simpler path. This first exercise, involving a hypothetical robotic cleaner, models a lazy random walk on a simple graph, a common scenario where detailed balance holds and can be used to efficiently find the long-term probability of finding the robot in each room [@problem_id:1296904].", "problem": "A robotic cleaning device operates in a small office suite consisting of four rooms arranged in a straight line: Room 1, Room 2, Room 3, and Room 4. Room 1 is connected only to Room 2. Room 2 is connected to Room 1 and Room 3. Room 3 is connected to Room 2 and Room 4. Room 4 is connected only to Room 3.\n\nThe robot's movement is modeled as a discrete-time Markov chain, where the state is the room the robot currently occupies. At each time step, the robot's control system executes the following algorithm:\n- With a probability of $1/2$, the robot remains in its current room to perform intensive cleaning.\n- With the remaining probability, the robot attempts to move to an adjacent room. If the current room has more than one adjacent room, the robot chooses one of them with equal probability.\n\nAfter a very long time, the robot's location follows a stationary probability distribution. Let $\\pi = (\\pi_1, \\pi_2, \\pi_3, \\pi_4)$ be this stationary distribution, where $\\pi_i$ is the probability of finding the robot in Room $i$.\n\nDetermine the stationary distribution $\\pi$. Express your answer as a row vector of four fractions in simplest form, representing the probabilities $(\\pi_1, \\pi_2, \\pi_3, \\pi_4)$.", "solution": "Model the chain with states indexed by rooms. From the rules:\n- In Rooms 1 and 4 (endpoints with one neighbor), the robot stays with probability $\\frac{1}{2}$ and moves to the unique neighbor with probability $\\frac{1}{2}$.\n- In Rooms 2 and 3 (interior rooms with two neighbors), the robot stays with probability $\\frac{1}{2}$ and moves to each neighbor with probability $\\frac{1}{4}$.\n\nThus the nonzero one-step transition probabilities are\n$$\nP_{11}=\\frac{1}{2},\\quad P_{12}=\\frac{1}{2},\\quad\nP_{21}=\\frac{1}{4},\\quad P_{22}=\\frac{1}{2},\\quad P_{23}=\\frac{1}{4},\n$$\n$$\nP_{32}=\\frac{1}{4},\\quad P_{33}=\\frac{1}{2},\\quad P_{34}=\\frac{1}{4},\\quad\nP_{43}=\\frac{1}{2},\\quad P_{44}=\\frac{1}{2}.\n$$\n\nLet $\\pi=(\\pi_{1},\\pi_{2},\\pi_{3},\\pi_{4})$ be a stationary distribution, so $\\pi=\\pi P$ and $\\sum_{i=1}^{4}\\pi_{i}=1$. The balance equations $\\pi_{j}=\\sum_{i}\\pi_{i}P_{ij}$ are\n$$\n\\pi_{1}=\\frac{1}{2}\\pi_{1}+\\frac{1}{4}\\pi_{2},\\qquad\n\\pi_{2}=\\frac{1}{2}\\pi_{2}+\\frac{1}{2}\\pi_{1}+\\frac{1}{4}\\pi_{3},\n$$\n$$\n\\pi_{3}=\\frac{1}{2}\\pi_{3}+\\frac{1}{4}\\pi_{2}+\\frac{1}{2}\\pi_{4},\\qquad\n\\pi_{4}=\\frac{1}{2}\\pi_{4}+\\frac{1}{4}\\pi_{3},\n$$\ntogether with\n$$\n\\pi_{1}+\\pi_{2}+\\pi_{3}+\\pi_{4}=1.\n$$\n\nFrom the first and last of the balance equations,\n$$\n\\pi_{1}-\\frac{1}{2}\\pi_{1}=\\frac{1}{4}\\pi_{2}\\;\\Rightarrow\\;\\pi_{1}=\\frac{1}{2}\\pi_{2},\\qquad\n\\pi_{4}-\\frac{1}{2}\\pi_{4}=\\frac{1}{4}\\pi_{3}\\;\\Rightarrow\\;\\pi_{4}=\\frac{1}{2}\\pi_{3}.\n$$\nUse the second balance equation, subtracting $\\frac{1}{2}\\pi_{2}$ from both sides:\n$$\n\\frac{1}{2}\\pi_{2}=\\frac{1}{2}\\pi_{1}+\\frac{1}{4}\\pi_{3}\\;\\Rightarrow\\;\\pi_{2}=\\pi_{1}+\\frac{1}{2}\\pi_{3}.\n$$\nSubstitute $\\pi_{2}=2\\pi_{1}$ from $\\pi_{1}=\\frac{1}{2}\\pi_{2}$ to get\n$$\n2\\pi_{1}=\\pi_{1}+\\frac{1}{2}\\pi_{3}\\;\\Rightarrow\\;\\pi_{1}=\\frac{1}{2}\\pi_{3}\\;\\Rightarrow\\;\\pi_{3}=2\\pi_{1}.\n$$\nThen $\\pi_{4}=\\frac{1}{2}\\pi_{3}=\\pi_{1}$ and $\\pi_{2}=2\\pi_{1}$. Enforce normalization:\n$$\n\\pi_{1}+\\pi_{2}+\\pi_{3}+\\pi_{4}=\\pi_{1}+2\\pi_{1}+2\\pi_{1}+\\pi_{1}=6\\pi_{1}=1\\;\\Rightarrow\\;\\pi_{1}=\\frac{1}{6}.\n$$\nTherefore,\n$$\n\\pi_{2}=2\\pi_{1}=\\frac{1}{3},\\quad \\pi_{3}=2\\pi_{1}=\\frac{1}{3},\\quad \\pi_{4}=\\pi_{1}=\\frac{1}{6}.\n$$\n\nHence the stationary distribution is\n$$\n\\left(\\frac{1}{6},\\frac{1}{3},\\frac{1}{3},\\frac{1}{6}\\right).\n$$", "answer": "$$\\boxed{\\begin{pmatrix}\\frac{1}{6} & \\frac{1}{3} & \\frac{1}{3} & \\frac{1}{6}\\end{pmatrix}}$$", "id": "1296904"}, {"introduction": "The concept of detailed balance extends directly from discrete-time to continuous-time Markov chains, where it connects stationary probabilities to transition rates. In many scientific models, particularly in physics and chemistry, reversibility is assumed based on underlying principles of time-reversal symmetry. This practice problem explores such a hypothetical biophysical system, demonstrating how the detailed balance condition, $\\pi_i r_{ij} = \\pi_j r_{ji}$, can be used to uncover quantitative relationships between state probabilities even with incomplete information about the system's parameters [@problem_id:1296903].", "problem": "A biophysical system involving a single molecule can be simplified and modeled as a particle performing a random walk among three distinct energy states, labeled 1, 2, and 3. The process is a continuous-time Markov chain. The transition rates between these states are given in terms of a positive constant $\\alpha$, which has units of inverse time:\n\n- The transition rate from state 1 to state 2 is $r_{12} = 2\\alpha$.\n- The transition rate from state 2 to state 1 is $r_{21} = 5\\alpha$.\n- The transition rate from state 2 to state 3 is $r_{23} = 3\\alpha$.\n- The transition rate from state 3 to state 2 is $r_{32} = 4\\alpha$.\n- The transition rate from state 3 to state 1 is $r_{31} = 10\\alpha$.\n- The transition rate from state 1 to state 3 is $r_{13}$, which is a certain constant rate that ensures the process is reversible.\n\nThe system is known to reach a stationary distribution, denoted by $\\{\\pi_1, \\pi_2, \\pi_3\\}$, where $\\pi_i$ is the steady-state probability of finding the molecule in state $i$. Given that the process is reversible, determine the value of the dimensionless ratio of stationary probabilities, $\\pi_2 / \\pi_3$.", "solution": "For a reversible continuous-time Markov chain with stationary distribution $\\{\\pi_{1},\\pi_{2},\\pi_{3}\\}$ and transition rates $r_{ij}$, the detailed balance equations must hold for every bidirectional edge:\n$$\n\\pi_{i} r_{ij} = \\pi_{j} r_{ji}.\n$$\nApplying detailed balance to the pair of states $2$ and $3$ gives\n$$\n\\pi_{2} r_{23} = \\pi_{3} r_{32}.\n$$\nSolving for the desired ratio yields\n$$\n\\frac{\\pi_{2}}{\\pi_{3}} = \\frac{r_{32}}{r_{23}}.\n$$\nSubstituting the given rates $r_{23} = 3\\alpha$ and $r_{32} = 4\\alpha$,\n$$\n\\frac{\\pi_{2}}{\\pi_{3}} = \\frac{4\\alpha}{3\\alpha} = \\frac{4}{3}.\n$$\nThis ratio is independent of $\\alpha$ because it cancels. As a consistency check using the other edges, detailed balance on $(1,2)$ gives $\\pi_{2}/\\pi_{1} = \\frac{2\\alpha}{5\\alpha} = \\frac{2}{5}$, so $\\pi_{3}/\\pi_{1} = \\frac{3}{10}$, and then detailed balance on $(1,3)$ requires $r_{13} = \\frac{\\pi_{3}}{\\pi_{1}} r_{31} = \\frac{3}{10} \\cdot 10\\alpha = 3\\alpha$, which is consistent with reversibility. The requested ratio is therefore $\\frac{4}{3}$.", "answer": "$$\\boxed{\\frac{4}{3}}$$", "id": "1296903"}, {"introduction": "While many processes are reversible, those with a net \"flow\" or circulation are not. This final exercise delves into the fundamental condition that transition rates must satisfy for a chain to be reversible, a condition known as Kolmogorov's criterion. By analyzing a hypothetical traffic light system that primarily cycles in one direction, you will see how the detailed balance equations, when applied around a loop, constrain the product of rates in one direction to equal the product of rates in the opposite direction. This practice provides a deeper understanding of the mathematical structure required for time-reversibility in a stochastic process [@problem_id:1296945].", "problem": "A simplified model for a traffic signal controller is described by a continuous-time Markov chain with three states: Green ($S_1$), Yellow ($S_2$), and Red ($S_3$). The system primarily cycles in the direction $S_1 \\to S_2 \\to S_3 \\to S_1$. However, due to certain override protocols or system faults, transitions against this cycle are also possible. The transition rates between the states are defined as follows:\n\n-   $r_{12}$: rate from Green to Yellow\n-   $r_{23}$: rate from Yellow to Red\n-   $r_{31}$: rate from Red to Green\n\nAnd for the reverse transitions:\n\n-   $r_{21}$: rate from Yellow to Green\n-   $r_{32}$: rate from Red to Yellow\n-   $r_{13}$: rate from Green to Red\n\nThe system has been engineered such that the resulting Markov chain is reversible. This property is crucial for ensuring that the long-term statistical behavior of the system is time-symmetric. Given the following measured transition rates:\n\n-   $r_{12} = 0.500$ transitions/minute\n-   $r_{23} = 2.00$ transitions/minute\n-   $r_{31} = 0.250$ transitions/minute\n-   $r_{21} = 0.100$ transitions/minute\n-   $r_{32} = 0.0500$ transitions/minute\n\nDetermine the required value for the transition rate $r_{13}$ that ensures the system is reversible. Express your answer in transitions/minute, rounded to three significant figures.", "solution": "The problem states that the continuous-time Markov chain describing the traffic light system is reversible. A Markov chain is reversible if and only if it satisfies the detailed balance equations. Let the stationary probability of being in state $S_i$ be $\\pi_i$. The detailed balance equations state that for any pair of states $i$ and $j$, the rate of flow from $i$ to $j$ in the stationary distribution is equal to the rate of flow from $j$ to $i$. Mathematically, this is expressed as:\n$$ \\pi_i r_{ij} = \\pi_j r_{ji} $$\nfor all pairs of states $i, j$.\n\nWe can apply this condition to the three pairs of connected states in our system: ($S_1$, $S_2$), ($S_2$, $S_3$), and ($S_3$, $S_1$).\n\nFor the pair ($S_1$, $S_2$):\n$$ \\pi_1 r_{12} = \\pi_2 r_{21} $$\n\nFor the pair ($S_2$, $S_3$):\n$$ \\pi_2 r_{23} = \\pi_3 r_{32} $$\n\nFor the pair ($S_3$, $S_1$):\n$$ \\pi_3 r_{31} = \\pi_1 r_{13} $$\n\nOur goal is to find a condition on the rates $r_{ij}$ that does not involve the unknown stationary probabilities $\\pi_1, \\pi_2, \\pi_3$. We can achieve this by rearranging each equation to express the ratio of the stationary probabilities and then multiplying them.\n\nFrom the first equation, we get:\n$$ \\frac{\\pi_2}{\\pi_1} = \\frac{r_{12}}{r_{21}} $$\n\nFrom the second equation, we get:\n$$ \\frac{\\pi_3}{\\pi_2} = \\frac{r_{23}}{r_{32}} $$\n\nFrom the third equation, we get:\n$$ \\frac{\\pi_1}{\\pi_3} = \\frac{r_{31}}{r_{13}} $$\n\nNow, we multiply the left-hand sides and the right-hand sides of these three equations:\n$$ \\left(\\frac{\\pi_2}{\\pi_1}\\right) \\left(\\frac{\\pi_3}{\\pi_2}\\right) \\left(\\frac{\\pi_1}{\\pi_3}\\right) = \\left(\\frac{r_{12}}{r_{21}}\\right) \\left(\\frac{r_{23}}{r_{32}}\\right) \\left(\\frac{r_{31}}{r_{13}}\\right) $$\n\nThe left-hand side simplifies to 1:\n$$ \\frac{\\pi_2 \\pi_3 \\pi_1}{\\pi_1 \\pi_2 \\pi_3} = 1 $$\n\nTherefore, the condition for reversibility (also known as Kolmogorov's criterion for cycles) is:\n$$ 1 = \\frac{r_{12} r_{23} r_{31}}{r_{21} r_{32} r_{13}} $$\nThis can be rewritten as:\n$$ r_{12} r_{23} r_{31} = r_{21} r_{32} r_{13} $$\nThis shows that for a three-state cycle to be reversible, the product of the transition rates in the clockwise direction must equal the product of the transition rates in the counter-clockwise direction.\n\nWe are asked to find the value of $r_{13}$. We can solve for it from the equation above:\n$$ r_{13} = \\frac{r_{12} r_{23} r_{31}}{r_{21} r_{32}} $$\n\nNow we substitute the given numerical values:\n-   $r_{12} = 0.500$ transitions/minute\n-   $r_{23} = 2.00$ transitions/minute\n-   $r_{31} = 0.250$ transitions/minute\n-   $r_{21} = 0.100$ transitions/minute\n-   $r_{32} = 0.0500$ transitions/minute\n\n$$ r_{13} = \\frac{(0.500) \\times (2.00) \\times (0.250)}{(0.100) \\times (0.0500)} $$\n\nFirst, calculate the numerator:\n$$ 0.500 \\times 2.00 \\times 0.250 = 1.00 \\times 0.250 = 0.250 $$\n\nNext, calculate the denominator:\n$$ 0.100 \\times 0.0500 = 0.00500 $$\n\nFinally, perform the division:\n$$ r_{13} = \\frac{0.250}{0.00500} = 50.0 $$\n\nThe required value for the transition rate $r_{13}$ is 50.0 transitions/minute. The problem asks for the answer to be rounded to three significant figures, which 50.0 already is.", "answer": "$$\\boxed{50.0}$$", "id": "1296945"}]}