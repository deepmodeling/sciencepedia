{"hands_on_practices": [{"introduction": "Understanding periodicity begins with the ability to calculate it. This practice [@problem_id:1281619] provides a foundational exercise in determining the period of a state for a random walk on an infinite lattice. You will explore how the set of possible displacements constrains the number of steps required for a particle to return to its starting point, a key skill in analyzing any Markov chain.", "problem": "A particle is part of a simplified one-dimensional crystal lattice model, where its position is represented by an integer on the number line, $\\mathbb{Z}$. At each discrete time step, the particle undergoes a displacement. The possible displacements from any state $i$ are to $i-2$ or $i+4$. The probabilities of these jumps, which are homogeneous for all states, are denoted by $p_{-2} = P(X_{n+1}=i-2 | X_n=i)$ and $p_{4} = P(X_{n+1}=i+4 | X_n=i)$. Both probabilities are strictly positive, and they sum to one, i.e., $p_{-2} + p_{4} = 1$.\n\nThis random walk process forms a Markov chain on the set of integers. Determine the period of an arbitrary state $j$ in this chain.", "solution": "Let $\\{X_{n}\\}_{n \\ge 0}$ be the Markov chain on $\\mathbb{Z}$ with transitions $X_{n+1}=X_{n}-2$ with probability $p_{-2}>0$ and $X_{n+1}=X_{n}+4$ with probability $p_{4}>0$, where $p_{-2}+p_{4}=1$. The period of a state $j$ is defined by\n$$\nd(j)=\\gcd\\{n \\ge 1 : P^{n}(j,j) > 0\\}.\n$$\n\nFirst, observe that every step changes the position by an even integer, so parity is preserved. Thus the chain decomposes into two closed communicating classes: the even integers and the odd integers. For any fixed $j$, all states in its parity class communicate with $j$, and the period is the same for all states in that class. Hence it suffices to compute $d(j)$ by determining the set of $n$ such that a return to $j$ in $n$ steps has positive probability.\n\nAny $n$-step path consists of $a$ steps of size $-2$ and $b$ steps of size $+4$, with $a,b \\in \\mathbb{Z}_{\\ge 0}$ and $a+b=n$. The net displacement after $n$ steps is\n$$\n\\Delta = (-2)a + (4)b = -2a + 4b.\n$$\nA return to $j$ requires $\\Delta=0$, hence\n$$\n-2a + 4b = 0 \\quad \\Longleftrightarrow \\quad a = 2b.\n$$\nSubstituting into $n=a+b$ gives\n$$\nn = a + b = 2b + b = 3b.\n$$\nTherefore, a necessary condition for a return in $n$ steps is that $n$ is a positive multiple of $3$. Conversely, for any $b \\in \\mathbb{Z}_{>0}$, choosing $a=2b$ yields $n=3b$, and there exists at least one $n$-step path with exactly $a$ steps of size $-2$ and $b$ steps of size $+4$ whose net displacement is zero. Since $p_{-2}, p_{4} > 0$, every such path has positive probability, so $P^{n}(j,j)>0$ for every $n$ that is a positive multiple of $3$.\n\nHence the set $\\{n \\ge 1 : P^{n}(j,j) > 0\\}$ is exactly $\\{3,6,9,\\ldots\\}$, and the period is\n$$\nd(j) = \\gcd\\{3,6,9,\\ldots\\} = 3.\n$$\n\nThis holds for any state $j$ (even or odd), so every state has period $3$.", "answer": "$$\\boxed{3}$$", "id": "1281619"}, {"introduction": "While some chains are inherently periodic, we often need to ensure a system is aperiodic to guarantee stable long-term behavior. This exercise [@problem_id:1281689] investigates a simple and powerful technique to induce aperiodicity: the \"lazy\" random walk. By incorporating a non-zero probability of a state transitioning to itself, you will see how this guarantees a period of $1$, a crucial condition for the existence of a meaningful stationary distribution.", "problem": "A communications network is modeled by a set of nodes (vertices) and links (edges). The set of five nodes is partitioned into two disjoint subsets, a server hub $U = \\{u_1, u_2\\}$ and a client group $V = \\{v_1, v_2, v_3\\}$. A link exists between every node in the server hub and every node in the client group. No links exist between nodes within the same subset.\n\nA data packet performs a random walk on this network. At each discrete time step, the packet is located at one of the five nodes. From its current node, the packet has a probability $p$ of remaining at that same node for the next time step. With a probability of $1-p$, the packet is transmitted to an adjacent node. If a transmission occurs, the destination node is chosen uniformly at random from all connected (adjacent) nodes. The constant $p$ satisfies $0 < p < 1$.\n\nAssuming the process runs for a very long time, what is the long-run proportion of time that the packet is located at any single, specific node within the client group $V$ (for instance, at node $v_1$)? Express your answer as a single closed-form analytic expression.", "solution": "We model the network as the undirected graph $K_{2,3}$ with bipartition $U=\\{u_{1},u_{2}\\}$ and $V=\\{v_{1},v_{2},v_{3}\\}$. The random walk is lazy: from a node $i$, it stays at $i$ with probability $p$ and moves to a uniformly chosen neighbor with probability $1-p$.\n\nDefine the transition probabilities for nodes $i$ and $j$:\n$$\nP_{ii}=p,\\quad\nP_{ij}=\\begin{cases}\n\\frac{1-p}{\\deg(i)}, & \\text{if $i$ and $j$ are adjacent},\\\\\n0, & \\text{otherwise}.\n\\end{cases}\n$$\nBecause $0<p<1$ and the graph is connected, the chain is irreducible and aperiodic, so it has a unique stationary distribution $\\pi$, and long-run proportions equal $\\pi$.\n\nFor a lazy random walk on an undirected graph, the stationary distribution is proportional to node degrees. We verify reversibility with respect to $\\pi_{i}\\propto\\deg(i)$. Let $S=\\sum_{k}\\deg(k)$. Propose\n$$\n\\pi_{i}=\\frac{\\deg(i)}{S}.\n$$\nFor any adjacent $i$ and $j$, detailed balance holds:\n$$\n\\pi_{i}P_{ij}=\\frac{\\deg(i)}{S}\\cdot\\frac{1-p}{\\deg(i)}=\\frac{1-p}{S}=\\frac{\\deg(j)}{S}\\cdot\\frac{1-p}{\\deg(j)}=\\pi_{j}P_{ji}.\n$$\nFor non-adjacent pairs, both sides are zero, and self-loops do not affect reversibility. Hence $\\pi$ is stationary and unique.\n\nCompute the degrees in $K_{2,3}$:\n$$\n\\deg(u_{1})=\\deg(u_{2})=3,\\quad \\deg(v_{1})=\\deg(v_{2})=\\deg(v_{3})=2.\n$$\nThus\n$$\nS=\\sum_{k}\\deg(k)=2\\cdot 3+3\\cdot 2=12.\n$$\nTherefore, for any specific client node $v\\in V$,\n$$\n\\pi_{v}=\\frac{\\deg(v)}{S}=\\frac{2}{12}=\\frac{1}{6}.\n$$\nThis value is independent of $p$.\n\nHence, the long-run proportion of time that the packet is at a given client node (e.g., $v_{1}$) is $\\frac{1}{6}$.", "answer": "$$\\boxed{\\frac{1}{6}}$$", "id": "1281689"}, {"introduction": "Beyond simple path counting, the periodicity of a Markov chain is deeply connected to the algebraic structure of its transitions. This advanced practice [@problem_id:1281646] challenges you to analyze a chain on a more abstract state space of permutations. By treating the transitions as elements of a mathematical group, you will learn to determine aperiodicity by examining the properties of the available operations, a perspective that is essential for analyzing more complex systems.", "problem": "Consider a discrete-time Markov chain where the state of the system is given by one of the possible permutations of three distinct items, labeled $I_1, I_2, I_3$. There are $3! = 6$ states in total. At each time step, a transition between states occurs based on one of the following two types of operations, which are applied to the current permutation $(x_1, x_2, x_3)$:\n\n1.  **Swap Operation**: With probability $p$, the first two items in the sequence are swapped. The new state becomes $(x_2, x_1, x_3)$.\n2.  **Cyclic Shift Operation**: With probability $1-p$, a cyclic shift is performed on all three items.\n    *   This shift is a **left cyclic shift** to $(x_2, x_3, x_1)$ with probability $q$.\n    *   This shift is a **right cyclic shift** to $(x_3, x_1, x_2)$ with probability $1-q$.\n\nThe parameters $p$ and $q$ are constants within the range $[0, 1]$. A state in a Markov chain is defined as aperiodic if its period is 1. The period of a state is the greatest common divisor of the lengths of all possible paths that start and end at that state. If a Markov chain is irreducible, all its states share the same period. If a chain is reducible, this property holds for all states within any given communicating class.\n\nFor which of the following pairs of parameters $(p, q)$ are all states of the Markov chain aperiodic? Select all that apply.\n\nA. $(p, q) = (1, 0.5)$\n\nB. $(p, q) = (0, 1)$\n\nC. $(p, q) = (0.5, 0)$\n\nD. $(p, q) = (0, 0.5)$\n\nE. $(p, q) = (0, 0)$\n\nF. $(p, q) = (0.5, 1)$", "solution": "Let the state space be the six permutations of three items. Define the three operations (applied to positions) as permutations in the symmetric group on three symbols:\n- Swap of the first two positions: $s=(1\\ 2)$.\n- Left cyclic shift: $r=(1\\ 2\\ 3)$.\n- Right cyclic shift: $r^{-1}=(1\\ 3\\ 2)$.\n\nAt each step, the chain multiplies the current state on the right by one of $s$, $r$, or $r^{-1}$ with probabilities $p$, $(1-p)q$, and $(1-p)(1-q)$, respectively. For any state $x$, $P^{n}(x,x) > 0$ if and only if there exists a length-$n$ word in the available generators whose product equals the identity $e$, with positive probability under the given $(p,q)$. The period of $x$ is therefore\n$$\n\\gcd\\{\\,n \\geq 1 : \\exists \\text{ word of length } n \\text{ in allowed generators with product } e\\,\\}.\n$$\nIf the chain is irreducible, all states share the same period. If reducible, the period is common within each communicating class.\n\nWe use the relations\n$$\ns^{2}=e,\\quad r^{3}=e,\\quad r^{-1}=r^{2},\\quad rr^{-1}=r^{-1}r=e,\\quad srs=r^{-1}.\n$$\n\nCase analysis for the given pairs:\n\nA. $(p,q)=(1,0.5)$. Only $s$ is used (since $p=1$). Then possible products returning to $e$ are exactly even powers of $s$, giving return lengths $n \\in \\{2,4,6,\\dots\\}$. Hence the period is $\\gcd\\{2,4,6,\\dots\\}=2$, so states are not aperiodic.\n\nB. $(p,q)=(0,1)$. Only $r$ is used. Then $r^{n}=e$ if and only if $n$ is a multiple of $3$, so return lengths are $\\{3,6,9,\\dots\\}$ and the period is $3$. The chain is reducible into two classes of size $3$, and within each class the period is $3$, so states are not aperiodic.\n\nC. $(p,q)=(0.5,0)$. Both $s$ and $r^{-1}$ are available with positive probability. Then:\n- $s^{2}=e$ gives a return in $2$ steps with positive probability $p^2 > 0$.\n- $(r^{-1})^{3}=e$ gives a return in $3$ steps with positive probability $(1-p)^3(1-q)^3 > 0$.\nThus $2$ and $3$ are both return lengths, and the period is $\\gcd(2,3)=1$. The chain is irreducible and all states are aperiodic.\n\nD. $(p,q)=(0,0.5)$. Only $r$ and $r^{-1}$ are available, both with positive probability. The chain reduces to two communicating classes of size $3$ (cosets of $\\{e,r,r^{2}\\}$). Within each class:\n- $rr^{-1}=e$ yields a return in $2$ steps with positive probability $q(1-q)>0$.\n- $r^{3}=e$ (or $(r^{-1})^{3}=e$) yields a return in $3$ steps with positive probability $q^3>0$ (or $(1-q)^3>0$).\nHence the period within each class is $\\gcd(2,3)=1$, so every state is aperiodic.\n\nE. $(p,q)=(0,0)$. Only $r^{-1}$ is used. As in case B (with $r^{-1}$ in place of $r$), returns occur only at multiples of $3$, so the period is $3$. States are not aperiodic.\n\nF. $(p,q)=(0.5,1)$. Both $s$ and $r$ are available with positive probability. Then:\n- $s^{2}=e$ gives a return in $2$ steps with probability $p^2>0$.\n- $r^{3}=e$ gives a return in $3$ steps with probability $(1-p)^3q^3>0$.\nTherefore the period is $\\gcd(2,3)=1$, and the chain is irreducible with all states aperiodic.\n\nCollecting the aperiodic cases, the correct choices are C, D, and F.", "answer": "$$\\boxed{CDF}$$", "id": "1281646"}]}