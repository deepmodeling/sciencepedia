{"hands_on_practices": [{"introduction": "The most intuitive way to understand communicating classes is by visualizing the state space as a graph. In this exercise [@problem_id:1329629], we explore a random walk on a simple graph composed of two disconnected components. This problem demonstrates the fundamental principle that the communicating classes of a Markov chain directly correspond to the connected components of its underlying state transition graph.", "problem": "Consider a discrete-time Markov chain defined by a random walk on a finite, undirected graph $G$. The graph $G$ has a set of six vertices, labeled $V = \\{1, 2, 3, 4, 5, 6\\}$. The edges of the graph are such that they form two completely separate 3-vertex cycles (triangles). The first triangle connects vertices $\\{1, 2, 3\\}$, and the second triangle connects vertices $\\{4, 5, 6\\}$. There are no other edges in the graph.\n\nThe process starts at some vertex in $V$. At each time step, if the walk is at a given vertex, it moves to one of its adjacent neighbors. Each neighbor is chosen with equal probability. The state space of the Markov chain is the set of vertices $V$.\n\nWhich of the following options correctly describes the partition of the state space $V$ into communicating classes?\n\nA. $\\{\\{1, 2, 3, 4, 5, 6\\}\\}$\n\nB. $\\{\\{1, 2\\}, \\{3, 4\\}, \\{5, 6\\}\\}$\n\nC. $\\{\\{1, 2, 3\\}, \\{4, 5, 6\\}\\}$\n\nD. $\\{\\{1\\}, \\{2\\}, \\{3\\}, \\{4\\}, \\{5\\}, \\{6\\}\\}$\n\nE. $\\{\\{1, 4\\}, \\{2, 5\\}, \\{3, 6\\}\\}$", "solution": "The problem asks us to identify the communicating classes of a Markov chain defined on a graph. The state space of the chain is the set of vertices $S = V = \\{1, 2, 3, 4, 5, 6\\}$.\n\nFirst, let's recall the definitions related to communicating classes.\nTwo states $i$ and $j$ in a Markov chain are said to communicate, denoted $i \\leftrightarrow j$, if it is possible to go from state $i$ to state $j$ in a finite number of steps, and it is also possible to go from state $j$ to state $i$ in a finite number of steps.\nMathematically, $i \\leftrightarrow j$ if and only if state $j$ is accessible from state $i$ ($i \\to j$) and state $i$ is accessible from state $j$ ($j \\to i$).\nA state $j$ is accessible from $i$ if the probability of reaching $j$ starting from $i$ in some number of steps $n \\ge 0$ is greater than zero. For a random walk on an unweighted graph, this is equivalent to the existence of a path of vertices and edges from vertex $i$ to vertex $j$.\n\nCommunication is an equivalence relation, which means it is reflexive ($i \\leftrightarrow i$), symmetric ($i \\leftrightarrow j \\implies j \\leftrightarrow i$), and transitive ($i \\leftrightarrow j \\text{ and } j \\leftrightarrow k \\implies i \\leftrightarrow k$). This relation partitions the state space into disjoint equivalence classes, which are called communicating classes.\n\nLet's analyze the structure of the graph $G$. It consists of two disconnected components.\nComponent 1: A triangle with vertices $\\{1, 2, 3\\}$. The edges are $(1, 2)$, $(2, 3)$, and $(3, 1)$.\nComponent 2: A triangle with vertices $\\{4, 5, 6\\}$. The edges are $(4, 5)$, $(5, 6)$, and $(6, 4)$.\nThere are no edges connecting any vertex from $\\{1, 2, 3\\}$ to any vertex in $\\{4, 5, 6\\}$.\n\nA random walk can only move between adjacent vertices. Therefore, for state $j$ to be accessible from state $i$, there must be a path connecting vertex $i$ and vertex $j$ in the graph.\n\nLet's consider the first component, vertices $\\{1, 2, 3\\}$.\n- Is state 2 accessible from state 1 ($1 \\to 2$)? Yes, there is an edge from 1 to 2. The transition probability $p_{12} > 0$.\n- Is state 1 accessible from state 2 ($2 \\to 1$)? Yes, there is an edge from 2 to 1. The transition probability $p_{21} > 0$.\nSince $1 \\to 2$ and $2 \\to 1$, we have $1 \\leftrightarrow 2$.\n- Similarly, for states 2 and 3, there is an edge $(2, 3)$, so $2 \\to 3$ and $3 \\to 2$. Thus, $2 \\leftrightarrow 3$.\n- For states 1 and 3, there is an edge $(1, 3)$, so $1 \\to 3$ and $3 \\to 1$. Thus, $1 \\leftrightarrow 3$.\nBy the transitivity of the communication relation (since $1 \\leftrightarrow 2$ and $2 \\leftrightarrow 3$, then $1 \\leftrightarrow 3$), all vertices in the set $\\{1, 2, 3\\}$ communicate with each other. Therefore, $\\{1, 2, 3\\}$ forms a single communicating class.\n\nNow, let's consider the second component, vertices $\\{4, 5, 6\\}$.\n- Using the same logic as above, the existence of edges $(4, 5)$, $(5, 6)$, and $(6, 4)$ means that all vertices within this set are mutually accessible.\n- $4 \\leftrightarrow 5$, $5 \\leftrightarrow 6$, and $6 \\leftrightarrow 4$.\n- Therefore, all vertices in the set $\\{4, 5, 6\\}$ communicate with each other, forming another single communicating class.\n\nFinally, let's consider a state from the first component and a state from the second component, for example, state 1 and state 4.\n- Is state 4 accessible from state 1 ($1 \\to 4$)? For the walk to go from vertex 1 to vertex 4, there must be a path of edges in the graph connecting them. By the problem description, the two triangles are disjoint, meaning there are no edges between the set $\\{1, 2, 3\\}$ and the set $\\{4, 5, 6\\}$.\n- Therefore, there is no path from 1 to 4. The probability of ever reaching state 4 starting from state 1 is zero. So, $1 \\not\\to 4$.\n- Since accessibility is not bidirectional, states 1 and 4 do not communicate. The same logic applies to any pair of vertices $(i, j)$ where $i \\in \\{1, 2, 3\\}$ and $j \\in \\{4, 5, 6\\}$.\n\nIn conclusion, the state space $S = \\{1, 2, 3, 4, 5, 6\\}$ is partitioned into two communicating classes: $C_1 = \\{1, 2, 3\\}$ and $C_2 = \\{4, 5, 6\\}$. The set of all communicating classes is $\\{\\{1, 2, 3\\}, \\{4, 5, 6\\}\\}$.\n\nComparing this result with the given options:\nA. $\\{\\{1, 2, 3, 4, 5, 6\\}\\}$ - Incorrect. This would imply the graph is connected.\nB. $\\{\\{1, 2\\}, \\{3, 4\\}, \\{5, 6\\}\\}$ - Incorrect.\nC. $\\{\\{1, 2, 3\\}, \\{4, 5, 6\\}\\}$ - Correct.\nD. $\\{\\{1\\}, \\{2\\}, \\{3\\}, \\{4\\}, \\{5\\}, \\{6\\}\\}$ - Incorrect. This would imply no state communicates with any other state, which is false.\nE. $\\{\\{1, 4\\}, \\{2, 5\\}, \\{3, 6\\}\\}$ - Incorrect. This mixes vertices from the two disconnected components.", "answer": "$$\\boxed{C}$$", "id": "1329629"}, {"introduction": "Moving beyond visually disconnected graphs, we often find partitions in a state space that are defined by more subtle properties. This problem [@problem_id:714681] presents a system of interconnected components where the transition rule appears to connect all states. Your task is to discover an invariant property—a quantity that remains unchanged by the transitions—which elegantly divides the vast state space into distinct, non-communicating classes.", "problem": "Consider a system of $N$ interconnected two-state components, where $N \\ge 2$ is an integer. The state of the system is described by a binary vector $s = (s_1, s_2, \\dots, s_N) \\in \\{0, 1\\}^N$, where $s_i$ is the state of the $i$-th component. The system evolves in discrete time steps according to a stochastic process.\n\nAt each time step, a pair of distinct components $\\{i, j\\}$ with $1 \\le i  j \\le N$ is chosen uniformly at random from all possible pairs. The states of these two chosen components, $s_i$ and $s_j$, are then flipped (i.e., $s_i \\to 1-s_i$ and $s_j \\to 1-s_j$). This process defines a time-homogeneous Markov chain on the state space $S = \\{0, 1\\}^N$.\n\nA communicating class of a Markov chain is a maximal set of states such that for any two states $u, v$ in the set, $v$ is reachable from $u$ and $u$ is reachable from $v$.\n\nDetermine the total number of communicating classes for this Markov chain.", "solution": "1. The Markov chain transitions by flipping exactly two bits, so any transition from state $s$ to $s'$ satisfies\n$$d_H(s,s')=2,$$\nwhere $d_H$ is the Hamming distance.\n\n2. Flipping two bits changes the total number of ones by an even integer. Thus the parity\n$$\\sum_{i=1}^N s_i\\pmod{2}$$\nis invariant under all transitions.\n\n3. Hence the state space $\\{0,1\\}^N$ splits into two disjoint subsets:\n   - Even parity: states with $\\sum_i s_i\\equiv 0\\pmod{2}$,\n   - Odd parity: states with $\\sum_i s_i\\equiv 1\\pmod{2}$.\n\n4. Each subset is connected under pairwise bit-flips:\n   - From any even-parity state one can successively flip pairs of 1’s to reach the all-zero state.\n   - From any odd-parity state one can reduce to weight-1 by flipping pairs of 1’s, then move among weight-1 states by flipping the unique 1 and a 0.\n\n5. Therefore there are exactly two communicating classes.", "answer": "$$\\boxed{2}$$", "id": "714681"}, {"introduction": "To truly master the concept of communicating classes, we must see how they emerge from the algebraic structure of the state space and its transitions. This advanced exercise [@problem_id:712313] models a Markov chain on the set of integers modulo $N$, $\\mathbb{Z}_N$, connecting its structure to fundamental concepts in number theory. By analyzing the generators of movement, you will derive a general formula for the number of classes, revealing a deep link between probability and abstract algebra.", "problem": "Consider a Markov chain defined on the state space $S = \\{0, 1, \\dots, N-1\\}$, where $N$ is a positive integer. The states can be identified with the elements of the group of integers modulo $N$, denoted by $\\mathbb{Z}_N$.\n\nThe transitions of the Markov chain are governed by two positive integers, $a$ and $b$, and a probability $p \\in (0, 1)$. From any state $i \\in S$, the chain transitions to state $(i+a) \\pmod N$ with probability $p$ and to state $(i+b) \\pmod N$ with probability $1-p$. All other transitions have zero probability.\n\nTwo states $i$ and $j$ are said to communicate, denoted $i \\leftrightarrow j$, if state $j$ is reachable from state $i$ and state $i$ is reachable from state $j$. A communicating class is a maximal set of states where every pair of states in the set communicates. The state space $S$ can be partitioned into a collection of disjoint communicating classes.\n\nDerive a general closed-form expression for the number of communicating classes of this Markov chain in terms of the parameters $N$, $a$, and $b$.", "solution": "We model states as elements of the additive group $\\mathbb{Z}_N$. From any state $i \\in \\mathbb{Z}_N$ the one-step moves are to $(i+a) \\pmod N$ and $(i+b) \\pmod N$.\nThus the set of differences reachable from $0$ is the subgroup $H = \\{ (xa+yb) \\pmod N : x,y \\in \\mathbb{Z} \\}$.\nTwo states $i,j$ communicate iff $j-i \\in H$ and $i-j \\in H$, so the communicating classes are the cosets of $H$. Hence the number of classes is the index\n$$[\\mathbb{Z}_N: H]=\\frac{|\\mathbb{Z}_N|}{|H|}.$$\nSince $H$ is cyclic generated by\n$g=\\gcd(a,b,N)$,\nwe have $|H|=N/g$, and thus\n$[\\mathbb{Z}_N: H]=g$.\nTherefore the number of communicating classes is \n$\\gcd(a,b,N)$.", "answer": "$$\\boxed{\\gcd(a,b,N)}$$", "id": "712313"}]}