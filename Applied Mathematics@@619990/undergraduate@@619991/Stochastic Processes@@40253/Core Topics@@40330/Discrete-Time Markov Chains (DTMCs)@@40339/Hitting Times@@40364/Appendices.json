{"hands_on_practices": [{"introduction": "This first exercise provides a foundational look at calculating the mean hitting time for a discrete-time Markov chain. By employing the powerful technique of first-step analysis, you will set up and solve a system of linear equations to find the expected number of steps for a process to reach one of several absorbing states. This problem is an excellent entry point for understanding how to model and analyze the duration of stochastic processes before they terminate [@problem_id:1318122].", "id": "1318122", "problem": "Consider a simplified model for a software bug where a Program Counter (PC) location becomes unstable. The PC state is modeled as its position among four adjacent memory addresses, labeled 0, 1, 2, and 3. The process starts with the PC at address 1.\n\nAt each step, if the PC is at an intermediate address $i \\in \\{1, 2\\}$, it will jump to the next higher address $i+1$ with a probability $p = 2/3$, or to the next lower address $i-1$ with a probability $1-p = 1/3$. The memory addresses 0 and 3 are considered terminal states. If the PC jumps to either address 0 or 3, the process halts immediately.\n\nCalculate the expected number of jumps required for the PC to reach a terminal state, starting from address 1. Round your final answer to three significant figures.\n\n", "solution": "Let the states of the system be the memory addresses {0, 1, 2, 3}. Let $E_i$ be the expected number of jumps to reach a terminal state, given that the Program Counter (PC) starts at address $i$. The terminal states are 0 and 3. By definition, if the process starts in a terminal state, it has already halted, so the number of jumps required is 0.\n$$E_0 = 0$$\n$$E_3 = 0$$\n\nWe are asked to find $E_1$. To find $E_1$, we can set up a system of linear equations for the expected values from the non-terminal (transient) states, $E_1$ and $E_2$. We use the principle of first-step analysis, which conditions on the outcome of the first jump. The expected number of total jumps from a state is 1 (for the first jump) plus the expected number of future jumps from the new state.\n\nFor a PC starting at address 1:\nIt takes one jump. With probability $p=2/3$, it moves to address 2. The expected number of *additional* jumps from there is $E_2$. With probability $1-p=1/3$, it moves to address 0. The expected number of *additional* jumps from there is $E_0$.\nSo, we can write the equation for $E_1$:\n$$E_1 = 1 + p \\cdot E_2 + (1-p) \\cdot E_0$$\nSubstituting the given value $p=2/3$ and the boundary condition $E_0=0$:\n$$E_1 = 1 + \\left(\\frac{2}{3}\\right)E_2 + \\left(\\frac{1}{3}\\right)(0)$$\n$$E_1 = 1 + \\frac{2}{3}E_2 \\quad (1)$$\n\nFor a PC starting at address 2:\nIt takes one jump. With probability $p=2/3$, it moves to address 3. The expected number of *additional* jumps from there is $E_3$. With probability $1-p=1/3$, it moves to address 1. The expected number of *additional* jumps from there is $E_1$.\nSo, we can write the equation for $E_2$:\n$$E_2 = 1 + p \\cdot E_3 + (1-p) \\cdot E_1$$\nSubstituting the given value $p=2/3$ and the boundary condition $E_3=0$:\n$$E_2 = 1 + \\left(\\frac{2}{3}\\right)(0) + \\left(\\frac{1}{3}\\right)E_1$$\n$$E_2 = 1 + \\frac{1}{3}E_1 \\quad (2)$$\n\nNow we have a system of two linear equations with two unknowns, $E_1$ and $E_2$:\n1.  $E_1 = 1 + \\frac{2}{3}E_2$\n2.  $E_2 = 1 + \\frac{1}{3}E_1$\n\nWe can solve this system by substitution. Substitute equation (2) into equation (1):\n$$E_1 = 1 + \\frac{2}{3}\\left(1 + \\frac{1}{3}E_1\\right)$$\n$$E_1 = 1 + \\frac{2}{3} + \\frac{2}{9}E_1$$\nNow, we solve for $E_1$. First, group the terms involving $E_1$ on one side:\n$$E_1 - \\frac{2}{9}E_1 = 1 + \\frac{2}{3}$$\n$$\\frac{7}{9}E_1 = \\frac{3}{3} + \\frac{2}{3}$$\n$$\\frac{7}{9}E_1 = \\frac{5}{3}$$\nIsolate $E_1$:\n$$E_1 = \\frac{5}{3} \\cdot \\frac{9}{7}$$\n$$E_1 = \\frac{45}{21} = \\frac{15}{7}$$\n\nThe problem requires the answer to be rounded to three significant figures. We first convert the fraction to a decimal:\n$$E_1 = \\frac{15}{7} \\approx 2.142857...$$\nRounding to three significant figures gives 2.14.", "answer": "$$\\boxed{2.14}$$"}, {"introduction": "Building on the concept of first-step analysis, this problem introduces a random walk with mixed boundary conditions: one absorbing state and one reflecting state. You will discover how different boundary types alter the setup of the expectation equations, a crucial skill for accurately modeling real-world systems with physical constraints. This exercise [@problem_id:1306539] will deepen your understanding of how to translate a system's physical rules into the mathematical framework of hitting times.", "id": "1306539", "problem": "A character in a video game is trapped in a narrow, one-dimensional corridor. The corridor is represented by a series of discrete locations labeled by the integers $i=0, 1, 2, \\dots, N$. The exit is at location $i=0$. The character starts at location $k$.\n\nAt each time step, if the character is at a location $i$ such that $0 < i < N$, they move to location $i-1$ with probability $1/2$ or to location $i+1$ with probability $1/2$. The movement rules at the ends of the corridor are as follows:\n-   Location $i=0$ is the exit. Once the character reaches this location, they have escaped, and the process stops.\n-   Location $i=N$ is a dead end with a perfectly reflecting wall. If the character attempts to move from location $i=N-1$ towards $N$, they land on $N$. However, in the subsequent time step, they are always forced back to location $i=N-1$. This implies that a transition from state $N$ always leads to state $N-1$ after one time step.\n\nGiven that the corridor is defined by $N=10$ and the character starts at the initial location $k=7$, calculate the expected number of time steps required for the character to reach the exit at location $0$.\n\n", "solution": "Let $T_{i}$ denote the expected number of time steps to reach the absorbing state at $0$ starting from location $i$. By the law of total expectation and the Markov property, for interior states $1 \\leq i \\leq N-1$ the expectation satisfies\n$$\nT_{i} = 1 + \\frac{1}{2} T_{i-1} + \\frac{1}{2} T_{i+1}.\n$$\nRearranging gives the second-difference equation\n$$\nT_{i+1} - 2 T_{i} + T_{i-1} = -2 \\quad \\text{for } 1 \\leq i \\leq N-1.\n$$\nThe boundary conditions are:\n- Absorbing at $0$: $T_{0} = 0$.\n- Perfect reflection at $N$: from $N$ the process deterministically moves to $N-1$ in one step, hence\n$$\nT_{N} = 1 + T_{N-1}.\n$$\n\nTo solve the inhomogeneous second-difference equation, use the quadratic ansatz $T_{i} = a i^{2} + b i + c$. Its second difference is $2a$, so matching $2a = -2$ gives $a = -1$. Thus\n$$\nT_{i} = - i^{2} + b i + c.\n$$\nApply $T_{0} = 0$ to obtain $c = 0$, hence\n$$\nT_{i} = - i^{2} + b i.\n$$\nUse the reflecting boundary condition $T_{N} = 1 + T_{N-1}$:\n$$\n- N^{2} + b N = 1 + \\left[-(N-1)^{2} + b (N-1)\\right].\n$$\nSimplifying,\n$$\n- N^{2} + b N = 1 - (N^{2} - 2N + 1) + bN - b = -2N + bN - b,\n$$\nwhich yields\n$$\nb - 2N = 0 \\quad \\Longrightarrow \\quad b = 2N.\n$$\nTherefore, for all $i$,\n$$\nT_{i} = - i^{2} + 2N i = i(2N - i).\n$$\n\nWith $N = 10$ and starting position $k = 7$,\n$$\nT_{7} = 7(2 \\cdot 10 - 7) = 7 \\cdot 13 = 91.\n$$\nThus, the expected number of time steps to reach the exit is $91$.", "answer": "$$\\boxed{91}$$"}, {"introduction": "This final practice illustrates the broad applicability of hitting time concepts by shifting from a spatial random walk to the abstract problem of detecting a pattern in a sequence of random outcomes. You will learn to define a state space based on the progress toward completing a target sequence and calculate the expected time to its first appearance. This powerful approach is fundamental to fields such as bioinformatics for gene sequencing and information theory for signal processing [@problem_id:1306556].", "id": "1306556", "problem": "A game consists of repeatedly rolling a standard, fair six-sided die until a specific sequence of three consecutive outcomes appears. The faces of the die are numbered from 1 to 6, and for each roll, any of these numbers is an outcome with an equal probability of $\\frac{1}{6}$. Calculate the expected number of rolls required to observe the sequence 1-2-3 for the first time.\n\n", "solution": "Let the target pattern be the length-3 sequence 1-2-3. Model the process by the longest suffix of recent rolls that is also a prefix of the target. Define states:\n- State $S_{0}$: no current match (expected additional rolls $E_{0}$).\n- State $S_{1}$: last roll is $1$ (matches prefix of length $1$; expectation $E_{1}$).\n- State $S_{2}$: last two rolls are $1,2$ (matches prefix of length $2$; expectation $E_{2}$).\n- State $S_{3}$: absorbing (pattern 1-2-3 seen; expectation $0$).\n\nAt each step, a roll occurs and then the state updates. We write first-step equations using total expectation.\n\nFrom $S_{0}$: With probability $\\frac{1}{6}$ the roll is $1$ and we move to $S_{1}$; with probability $\\frac{5}{6}$ the roll is not $1$ and we remain in $S_{0}$. Thus\n$$\nE_{0}=1+\\frac{1}{6}E_{1}+\\frac{5}{6}E_{0}.\n$$\nFrom $S_{1}$: A roll of $2$ (probability $\\frac{1}{6}$) moves to $S_{2}$. A roll of $1$ (probability $\\frac{1}{6}$) keeps the longest matching suffix as $1$, so we remain in $S_{1}$. Any of $3,4,5,6$ (probability $\\frac{4}{6}$) breaks the match and moves to $S_{0}$. Hence\n$$\nE_{1}=1+\\frac{1}{6}E_{2}+\\frac{1}{6}E_{1}+\\frac{4}{6}E_{0}.\n$$\nFrom $S_{2}$: A roll of $3$ (probability $\\frac{1}{6}$) completes the pattern and moves to $S_{3}$ (contributing $0$ thereafter). A roll of $1$ (probability $\\frac{1}{6}$) makes the longest matching suffix equal to $1$, so moves to $S_{1}$. Any of $2,4,5,6$ (probability $\\frac{4}{6}$) moves to $S_{0}$. Therefore\n$$\nE_{2}=1+\\frac{1}{6}E_{1}+\\frac{4}{6}E_{0}.\n$$\n\nSolve the linear system. From the first equation,\n$$\nE_{0}-\\frac{5}{6}E_{0}=1+\\frac{1}{6}E_{1}\\quad\\Rightarrow\\quad E_{0}=6+E_{1}.\n$$\nFrom the second equation,\n$$\nE_{1}-\\frac{1}{6}E_{1}=1+\\frac{1}{6}E_{2}+\\frac{4}{6}E_{0}\\quad\\Rightarrow\\quad 5E_{1}=6+E_{2}+4E_{0}.\n$$\nFrom the third equation,\n$$\n6E_{2}=6+E_{1}+4E_{0}.\n$$\nUse $E_{1}=E_{0}-6$ in the third to get $6E_{2}=5E_{0}$, so $E_{2}=\\frac{5}{6}E_{0}$. Substitute $E_{1}=E_{0}-6$ and $E_{2}=\\frac{5}{6}E_{0}$ into $5E_{1}=6+E_{2}+4E_{0}$:\n$$\n5(E_{0}-6)=6+\\frac{5}{6}E_{0}+4E_{0}\n\\;\\Rightarrow\\;\n5E_{0}-30=6+\\frac{29}{6}E_{0}\n\\;\\Rightarrow\\;\n30E_{0}-180=36+29E_{0}\n\\;\\Rightarrow\\;\nE_{0}=216.\n$$\n\nThus, the expected number of rolls required to observe 1-2-3 for the first time is $216$.", "answer": "$$\\boxed{216}$$"}]}