{"hands_on_practices": [{"introduction": "Let's begin with a practical scenario involving a remote sensor's battery. This exercise is an excellent first step in learning to construct a one-step transition probability matrix. By breaking down the daily changes into simple, independent events—energy consumption and solar charging—you will see how to calculate the probability of moving from one battery state to another and assemble these into a complete matrix, the cornerstone of any Markov chain model. [@problem_id:1322224]", "problem": "A remote environmental sensor is powered by a rechargeable battery. Its battery level at the start of each day is categorized into one of three states: 1 (High), 2 (Medium), or 3 (Low). The state transitions are observed on a day-to-day basis and are influenced by two independent daily phenomena: energy consumption and solar charging.\n\nFor any given day:\n- The energy consumption can be either 'high' or 'low'. A 'high-consumption' day occurs with a probability $p_c = 0.45$.\n- The solar charging can be either 'effective' or 'ineffective'. An 'effective' charging day occurs with a probability $p_s = 0.60$.\n\nThe battery state for the next day, $X_{t+1}$, is determined by the state at the start of the current day, $X_t$, and the day's conditions, according to the following rules:\n\n- If the battery is in **State 1 (High)**: It will drop to State 2 (Medium) only if the day has high consumption AND ineffective charging. Otherwise, it remains in State 1.\n- If the battery is in **State 2 (Medium)**: It will rise to State 1 (High) if the day has low consumption AND effective charging. It will drop to State 3 (Low) if the day has high consumption AND ineffective charging. Otherwise, it remains in State 2.\n- If the battery is in **State 3 (Low)**: It will rise to State 2 (Medium) if the day has low consumption AND effective charging. It cannot rise to State 1 in a single step. Otherwise, it remains in State 3.\n\nAssuming this system can be modeled as a discrete-time Markov chain, determine the one-step transition probability matrix $P$. The entry $P_{ij}$ of this matrix represents the probability of transitioning from state $i$ to state $j$ in one day. The states are ordered as (1: High, 2: Medium, 3: Low).", "solution": "Let $p_{c}$ denote the probability of a high-consumption day and $p_{s}$ denote the probability of an effective charging day. Given $p_{c}=0.45$ and $p_{s}=0.60$, and independence of consumption and charging, the joint daily condition probabilities are:\n$$\\mathbb{P}(\\text{high consumption and ineffective charging})=p_{c}(1-p_{s}),$$\n$$\\mathbb{P}(\\text{low consumption and effective charging})=(1-p_{c})p_{s},$$\n$$\\mathbb{P}(\\text{high consumption and effective charging})=p_{c}p_{s},$$\n$$\\mathbb{P}(\\text{low consumption and ineffective charging})=(1-p_{c})(1-p_{s}).$$\n\nBy the transition rules:\n- From state $1$ (High): it drops to state $2$ if and only if high consumption and ineffective charging occur; otherwise it stays in state $1$. Hence\n$$P_{12}=p_{c}(1-p_{s}),\\quad P_{11}=1-p_{c}(1-p_{s}),\\quad P_{13}=0.$$\n- From state $2$ (Medium): it rises to state $1$ if low consumption and effective charging occur, drops to state $3$ if high consumption and ineffective charging occur, and otherwise remains in state $2$. Hence\n$$P_{21}=(1-p_{c})p_{s},\\quad P_{23}=p_{c}(1-p_{s}),$$\n$$P_{22}=1-\\big[(1-p_{c})p_{s}+p_{c}(1-p_{s})\\big]=p_{c}p_{s}+(1-p_{c})(1-p_{s}).$$\n- From state $3$ (Low): it rises to state $2$ if low consumption and effective charging occur; it cannot rise to state $1$ in one step; otherwise it remains in state $3$. Hence\n$$P_{32}=(1-p_{c})p_{s},\\quad P_{31}=0,\\quad P_{33}=1-(1-p_{c})p_{s}.$$\n\nSubstituting $p_{c}=0.45$ and $p_{s}=0.60$ gives\n$$p_{c}(1-p_{s})=0.45\\times 0.40=0.18,\\quad (1-p_{c})p_{s}=0.55\\times 0.60=0.33,$$\n$$p_{c}p_{s}=0.45\\times 0.60=0.27,\\quad (1-p_{c})(1-p_{s})=0.55\\times 0.40=0.22.$$\nTherefore,\n- From state $1$: $P_{11}=1-0.18=0.82$, $P_{12}=0.18$, $P_{13}=0$.\n- From state $2$: $P_{21}=0.33$, $P_{23}=0.18$, $P_{22}=0.27+0.22=0.49$.\n- From state $3$: $P_{31}=0$, $P_{32}=0.33$, $P_{33}=1-0.33=0.67$.\n\nThus the one-step transition matrix $P$ (states ordered as $1,2,3$) is\n$$P=\\begin{pmatrix}\n0.82 & 0.18 & 0 \\\\\n0.33 & 0.49 & 0.18 \\\\\n0 & 0.33 & 0.67\n\\end{pmatrix}.$$\nEach row sums to $1$, as required for a stochastic matrix.", "answer": "$$\\boxed{\\begin{pmatrix}0.82 & 0.18 & 0 \\\\ 0.33 & 0.49 & 0.18 \\\\ 0 & 0.33 & 0.67\\end{pmatrix}}$$", "id": "1322224"}, {"introduction": "Now, let's explore a more intricate model of a self-healing material. This problem challenges you to calculate a single transition probability where the outcome depends on the combined effect of two separate random processes: the healing of existing cracks and the formation of new ones. This practice is crucial for developing the skill of modeling state changes that result from multiple, interacting stochastic events, a common feature in many real-world systems. [@problem_id:1322226]", "problem": "A simplified stochastic model is proposed to describe the structural integrity of a self-healing material over discrete time intervals. The state of the material at any time step is defined by the number of active micro-cracks, denoted by an integer from 0 to a maximum of $N$. Let $X_n$ be the number of cracks at time step $n$.\n\nThe evolution of the number of cracks from time step $n$ to $n+1$ is governed by two independent processes: crack healing and new crack formation.\n1.  **Crack Healing:** Each of the existing cracks at time step $n$ has an independent probability $p_h$ of being healed during the interval.\n2.  **New Crack Formation:** The material has a total of $N$ potential sites for micro-cracks. If there are $i$ existing cracks, then there are $N-i$ remaining sites where new cracks can form. Each of these $N-i$ sites has an independent probability $p_f$ of developing a new crack during the interval.\n\nConsider a material with a maximum capacity of $N=4$ micro-cracks. Suppose that at time step $n$, the material is observed to have $X_n = 2$ cracks. Determine the one-step transition probability $P(X_{n+1}=1 | X_n=2)$, expressed as an analytic function of the probabilities $p_f$ and $p_h$.", "solution": "We condition on the current number of cracks being $X_{n}=2$ with a maximum capacity $N=4$. Two disjoint sets of sites exist at time step $n$: the $2$ existing cracked sites and the $N-2=2$ empty sites. The two processes act independently on these disjoint sets.\n\nDefine $Y$ as the number of pre-existing cracks that remain after healing. Each existing crack survives (is not healed) with probability $1-p_{h}$ independently, so\n$$\nY \\sim \\text{Binomial}\\left(2,\\,1-p_{h}\\right), \\quad \\text{with} \\quad P(Y=k)=\\binom{2}{k}(1-p_{h})^{k}p_{h}^{2-k},\\; k=0,1,2.\n$$\nDefine $Z$ as the number of new cracks formed on the $2$ empty sites. Each empty site forms a new crack with probability $p_{f}$ independently, so\n$$\nZ \\sim \\text{Binomial}\\left(2,\\,p_{f}\\right), \\quad \\text{with} \\quad P(Z=\\ell)=\\binom{2}{\\ell}p_{f}^{\\ell}(1-p_{f})^{2-\\ell},\\; \\ell=0,1,2.\n$$\nSince healing and new formation occur on disjoint sets of sites and are independent processes, $Y$ and $Z$ are independent, and the total number of cracks at the next step is\n$$\nX_{n+1}=Y+Z.\n$$\nWe need $P(X_{n+1}=1 \\mid X_{n}=2)=P(Y+Z=1)=P(Y=0)P(Z=1)+P(Y=1)P(Z=0)$, which evaluates to\n$$\nP(X_{n+1}=1 \\mid X_{n}=2)=\\left(p_{h}^{2}\\right)\\left(2p_{f}(1-p_{f})\\right)+\\left(2p_{h}(1-p_{h})\\right)\\left((1-p_{f})^{2}\\right).\n$$\nThis can be written equivalently in a factored form as\n$$\nP(X_{n+1}=1 \\mid X_{n}=2)=2p_{h}(1-p_{f})\\left(1-p_{h}-p_{f}+2p_{h}p_{f}\\right).\n$$", "answer": "$$\\boxed{2p_{h}^{2}p_{f}(1-p_{f})+2p_{h}(1-p_{h})(1-p_{f})^{2}}$$", "id": "1322226"}, {"introduction": "Finally, we'll examine a more abstract process: an algorithm that refines data clusters. This advanced exercise introduces the concept of state-dependent transition probabilities, where the rules for moving between states change depending on the current state. You will work with a system that has deterministic behavior at its boundaries and probabilistic behavior in between, a structure typical of birth-death processes used to model populations, queues, and other dynamic systems. [@problem_id:1322235]", "problem": "An automated data analysis algorithm iteratively refines the number of clusters in a dataset. Let $K_n$ denote the number of clusters at iteration $n$. This process is modeled as a discrete-time stochastic process where the state at any time is the integer number of clusters. The state space is defined as the set of integers $\\{2, 3, \\dots, M\\}$, where $M > 2$ is a predefined maximum number of clusters.\n\nThe algorithm's behavior at each iteration depends on the current number of clusters, $k$:\n\n1.  For an intermediate number of clusters, where $2 < k < M$, the algorithm makes a probabilistic choice between two actions:\n    *   **Split**: It increases the number of clusters to $k+1$. This action is chosen with a probability $p_s(k)$.\n    *   **Merge**: It decreases the number of clusters to $k-1$. This action is chosen with the complementary probability, $1 - p_s(k)$.\n    The probability of choosing a split is governed by the logistic function $p_s(k) = \\frac{1}{1 + \\exp(\\alpha(k - k_0))}$, where $\\alpha$ and $k_0$ are positive real-valued parameters of the algorithm.\n\n2.  At the boundaries of the state space, the algorithm's action is deterministic:\n    *   If there are $k=2$ clusters, the algorithm always performs a split action.\n    *   If there are $k=M$ clusters, the algorithm always performs a merge action.\n\nBased on this model, determine the general expression for the one-step transition probability $P_{i,j} = P(K_{n+1}=j | K_n=i)$ for any two states $i, j \\in \\{2, 3, \\dots, M\\}$. Express your answer as a function of $i, j, \\alpha, k_0$, and $M$.", "solution": "We model $\\{K_{n}\\}$ as a time-homogeneous Markov chain on the finite state space $\\{2,3,\\dots,M\\}$. By the problem statement, from any interior state $i$ with $2<i<M$, the next state must be either $i+1$ (a split) or $i-1$ (a merge). The split at state $i$ occurs with probability $p_{s}(i)$ and the merge with probability $1-p_{s}(i)$, where the logistic form is\n$$\np_{s}(i)=\\frac{1}{1+\\exp\\!\\big(\\alpha(i-k_{0})\\big)}.\n$$\nThus, for $2<i<M$, we have\n$$\nP_{i,i+1}=p_{s}(i)=\\frac{1}{1+\\exp\\!\\big(\\alpha(i-k_{0})\\big)},\\qquad\nP_{i,i-1}=1-p_{s}(i)=\\frac{\\exp\\!\\big(\\alpha(i-k_{0})\\big)}{1+\\exp\\!\\big(\\alpha(i-k_{0})\\big)},\n$$\nand $P_{i,j}=0$ for all other $j$.\n\nAt the lower boundary $i=2$, the algorithm always splits, so\n$$\nP_{2,3}=1,\\qquad P_{2,j}=0\\ \\text{for}\\ j\\neq 3.\n$$\nAt the upper boundary $i=M$, the algorithm always merges, so\n$$\nP_{M,M-1}=1,\\qquad P_{M,j}=0\\ \\text{for}\\ j\\neq M-1.\n$$\n\nCombining these cases yields the general one-step transition probability for any $i,j\\in\\{2,3,\\dots,M\\}$:\n$$\nP_{i,j}=\\begin{cases}\n1, & i=2,\\ j=3,\\\\[4pt]\n1, & i=M,\\ j=M-1,\\\\[4pt]\n\\dfrac{1}{1+\\exp\\!\\big(\\alpha(i-k_{0})\\big)}, & 2<i<M,\\ j=i+1,\\\\[10pt]\n\\dfrac{\\exp\\!\\big(\\alpha(i-k_{0})\\big)}{1+\\exp\\!\\big(\\alpha(i-k_{0})\\big)}, & 2<i<M,\\ j=i-1,\\\\[10pt]\n0, & \\text{otherwise.}\n\\end{cases}\n$$\nThis expresses $P_{i,j}$ entirely in terms of $i$, $j$, $\\alpha$, $k_{0}$, and $M$.", "answer": "$$\\boxed{P_{i,j}=\\begin{cases}\n1, & i=2,\\ j=3,\\\\[4pt]\n1, & i=M,\\ j=M-1,\\\\[4pt]\n\\dfrac{1}{1+\\exp\\!\\big(\\alpha(i-k_{0})\\big)}, & 2<i<M,\\ j=i+1,\\\\[10pt]\n\\dfrac{\\exp\\!\\big(\\alpha(i-k_{0})\\big)}{1+\\exp\\!\\big(\\alpha(i-k_{0})\\big)}, & 2<i<M,\\ j=i-1,\\\\[10pt]\n0, & \\text{otherwise.}\n\\end{cases}}$$", "id": "1322235"}]}