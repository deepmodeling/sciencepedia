{"hands_on_practices": [{"introduction": "Understanding the long-term behavior of dynamic systems is a central theme in science and engineering. This problem provides a practical and intuitive scenario: modeling a user's browsing behavior on a small network of websites. By translating the user's navigation rules into a Markov chain, you will practice the fundamental skill of calculating the stationary distribution, which, according to the Ergodic Theorem, directly corresponds to the long-run proportion of time spent on each website [@problem_id:1360466].", "problem": "A computer scientist is modeling a user's browsing behavior on a small, isolated network of four websites, labeled W1, W2, W3, and W4. The user starts at an arbitrary site and navigates by clicking on a link at each time step.\n\nThe network's link structure and the user's navigational preferences are as follows:\n- From site W1, there are links to W2 and W3. The user is twice as likely to click the link to W2 as the link to W3.\n- From site W2, there are links to W1 and W4. The user chooses between these two links with equal probability.\n- From site W3, there are links to W1 and W4. The user chooses between these two links with equal probability.\n- From site W4, there is only a single link, which leads back to W1.\n\nOver a very long period, the user's browsing history will show that they have spent a certain proportion of their time on each of the four websites.\n\nCalculate the ratio of the long-term proportion of time the user spends on site W1 to the long-term proportion of time the user spends on site W2. Express your answer as a single fraction in simplest form.", "solution": "The user's browsing behavior can be modeled as a discrete-time Markov chain on the state space $S = \\{1, 2, 3, 4\\}$, where each state corresponds to one of the websites W1, W2, W3, and W4. The long-term proportion of time spent in each state is given by the stationary distribution of this Markov chain.\n\nLet $P_{ij}$ be the transition probability from state $i$ to state $j$. We first determine these probabilities from the problem description.\n\nFor state 1 (W1): There are links to W2 and W3. The user is twice as likely to choose W2 as W3. Let $p_2$ be the probability of going to W2 and $p_3$ be the probability of going to W3. We have $p_2 = 2p_3$ and $p_2 + p_3 = 1$. Substituting the first into the second gives $2p_3 + p_3 = 1$, so $3p_3 = 1$, which means $p_3 = 1/3$. Then $p_2 = 2/3$. Thus, $P_{11}=0, P_{12}=2/3, P_{13}=1/3, P_{14}=0$.\n\nFor state 2 (W2): There are links to W1 and W4, chosen with equal probability. Thus, $P_{21}=1/2, P_{22}=0, P_{23}=0, P_{24}=1/2$.\n\nFor state 3 (W3): There are links to W1 and W4, chosen with equal probability. Thus, $P_{31}=1/2, P_{32}=0, P_{33}=0, P_{34}=1/2$.\n\nFor state 4 (W4): There is a single link to W1. Thus, $P_{41}=1, P_{42}=0, P_{43}=0, P_{44}=0$.\n\nThe transition matrix $P$ is:\n$$\nP = \\begin{pmatrix}\n0 & 2/3 & 1/3 & 0 \\\\\n1/2 & 0 & 0 & 1/2 \\\\\n1/2 & 0 & 0 & 1/2 \\\\\n1 & 0 & 0 & 0\n\\end{pmatrix}\n$$\n\nLet $\\pi = (\\pi_1, \\pi_2, \\pi_3, \\pi_4)$ be the stationary distribution. It must satisfy the equation $\\pi P = \\pi$, which expands to a system of linear equations, along with the normalization condition $\\sum_{i=1}^{4} \\pi_i = 1$.\n\nThe system of equations from $\\pi P = \\pi$ is:\n1. $0 \\cdot \\pi_1 + \\frac{1}{2}\\pi_2 + \\frac{1}{2}\\pi_3 + 1 \\cdot \\pi_4 = \\pi_1$\n2. $\\frac{2}{3}\\pi_1 + 0 \\cdot \\pi_2 + 0 \\cdot \\pi_3 + 0 \\cdot \\pi_4 = \\pi_2$\n3. $\\frac{1}{3}\\pi_1 + 0 \\cdot \\pi_2 + 0 \\cdot \\pi_3 + 0 \\cdot \\pi_4 = \\pi_3$\n4. $0 \\cdot \\pi_1 + \\frac{1}{2}\\pi_2 + \\frac{1}{2}\\pi_3 + 0 \\cdot \\pi_4 = \\pi_4$\n\nFrom equation (2), we have $\\pi_2 = \\frac{2}{3}\\pi_1$.\nFrom equation (3), we have $\\pi_3 = \\frac{1}{3}\\pi_1$.\n\nNow we can substitute these into equation (4) to express $\\pi_4$ in terms of $\\pi_1$:\n$$\n\\pi_4 = \\frac{1}{2}\\pi_2 + \\frac{1}{2}\\pi_3 = \\frac{1}{2}\\left(\\frac{2}{3}\\pi_1\\right) + \\frac{1}{2}\\left(\\frac{1}{3}\\pi_1\\right) = \\frac{1}{3}\\pi_1 + \\frac{1}{6}\\pi_1 = \\left(\\frac{2}{6} + \\frac{1}{6}\\right)\\pi_1 = \\frac{3}{6}\\pi_1 = \\frac{1}{2}\\pi_1\n$$\n(Equation (1) is linearly dependent on the others and can be used as a check, but is not needed to find the relationships between the $\\pi_i$).\n\nNow we use the normalization condition:\n$$\n\\pi_1 + \\pi_2 + \\pi_3 + \\pi_4 = 1\n$$\nSubstitute the expressions for $\\pi_2, \\pi_3, \\pi_4$ in terms of $\\pi_1$:\n$$\n\\pi_1 + \\frac{2}{3}\\pi_1 + \\frac{1}{3}\\pi_1 + \\frac{1}{2}\\pi_1 = 1\n$$\nFactor out $\\pi_1$:\n$$\n\\pi_1\\left(1 + \\frac{2}{3} + \\frac{1}{3} + \\frac{1}{2}\\right) = 1\n$$\nSimplify the terms in the parenthesis:\n$$\n\\pi_1\\left(1 + 1 + \\frac{1}{2}\\right) = 1\n$$\n$$\n\\pi_1\\left(\\frac{5}{2}\\right) = 1\n$$\nSolving for $\\pi_1$, we get:\n$$\n\\pi_1 = \\frac{2}{5}\n$$\nNow we find $\\pi_2$:\n$$\n\\pi_2 = \\frac{2}{3}\\pi_1 = \\frac{2}{3}\\left(\\frac{2}{5}\\right) = \\frac{4}{15}\n$$\nThe problem asks for the ratio of the long-term proportion of time spent on site W1 to the proportion of time spent on site W2. This is the ratio $\\frac{\\pi_1}{\\pi_2}$.\n$$\n\\frac{\\pi_1}{\\pi_2} = \\frac{2/5}{4/15} = \\frac{2}{5} \\times \\frac{15}{4} = \\frac{30}{20} = \\frac{3}{2}\n$$\nThe ratio, as a fraction in simplest form, is $\\frac{3}{2}$.", "answer": "$$\\boxed{\\frac{3}{2}}$$", "id": "1360466"}, {"introduction": "Many real-world processes can be modeled as birth-death processes, a special class of Markov chains where the state only changes to its immediate neighbors. This exercise explores such a system through the classic example of a gambler's fortune, constrained by reflecting boundaries. The challenge here is not just to find the stationary probabilities but to use them to calculate a long-term average — the gambler's expected fortune — which showcases a powerful application of the Ergodic Theorem in predicting average system properties over time [@problem_id:1337731].", "problem": "A cautious gambler plays a game where her fortune, an integer amount in dollars, can change at each step. Her total capital is limited, such that her fortune $X_n$ at step $n$ must be in the set $\\{0, 1, 2, 3, 4\\}$. The maximum possible fortune is thus $M=4$ dollars.\n\nAt each step, she makes a bet. She wins $1 with probability $p = 2/3$ and loses $1 with probability $1-p = 1/3$. However, her cautious strategy involves special rules at the boundaries of her fortune:\n- If her current fortune is $X_n = 0$, she cannot lose any more. A \"losing\" outcome (with probability $1/3$) results in her fortune remaining at $0$. A \"winning\" outcome (with probability $2/3$) increases her fortune to $1$.\n- If her current fortune is $X_n = 4$, she cannot hold more money. A \"winning\" outcome (with probability $2/3$) results in her fortune remaining at $4$. A \"losing\" outcome (with probability $1/3$) decreases her fortune to $3$.\n- For any other fortune $X_n = i$ where $i \\in \\{1, 2, 3\\}$, a win increases her fortune to $i+1$ and a loss decreases it to $i-1$.\n\nAssuming the game runs for a very long time, what is the long-term average fortune of the gambler? Express your answer as a number rounded to four significant figures.", "solution": "We model the fortune as a discrete-time Markov chain on the state space $\\{0,1,2,3,4\\}$ with transition probabilities:\n- For interior states $i \\in \\{1,2,3\\}$: $P(i \\to i+1)=p$ and $P(i \\to i-1)=q$, where $q=1-p$.\n- At the boundaries: $P(0 \\to 1)=p$, $P(0 \\to 0)=q$; and $P(4 \\to 3)=q$, $P(4 \\to 4)=p$.\n\nThis is a birth-death chain with reflecting boundaries (self-loops at $0$ and $4$). The chain is finite, irreducible, and aperiodic, so it has a unique stationary distribution $\\pi$ and the long-term time average equals the stationary expectation.\n\nFor a birth-death chain, the stationary distribution satisfies detailed balance on edges:\n$$\n\\pi_{i} p_{i}=\\pi_{i+1} q_{i+1},\n$$\nwhere $p_{i}=P(i \\to i+1)$ and $q_{i+1}=P(i+1 \\to i)$. Here, for $i=0,1,2,3$, we have $p_{i}=p$, and for $i=1,2,3,4$, we have $q_{i}=q$. Thus for each adjacent pair $(i,i+1)$ with $i=0,1,2,3$,\n$$\n\\frac{\\pi_{i+1}}{\\pi_{i}}=\\frac{p_{i}}{q_{i+1}}=\\frac{p}{q}.\n$$\nLet $r=\\frac{p}{q}$. Then\n$$\n\\pi_{i}=\\pi_{0} r^{i}, \\quad i=0,1,2,3,4.\n$$\nNormalization $\\sum_{i=0}^{4}\\pi_{i}=1$ gives\n$$\n\\pi_{0}\\sum_{i=0}^{4}r^{i}=1 \\quad \\Rightarrow \\quad \\pi_{0}=\\left(\\sum_{i=0}^{4}r^{i}\\right)^{-1}.\n$$\nTherefore\n$$\n\\pi_{i}=\\frac{r^{i}}{\\sum_{k=0}^{4}r^{k}}.\n$$\nThe long-term average fortune is the stationary expectation\n$$\n\\mathbb{E}[X]=\\sum_{i=0}^{4}i \\pi_{i}=\\frac{\\sum_{i=0}^{4}i r^{i}}{\\sum_{k=0}^{4}r^{k}}.\n$$\nWith $p=\\frac{2}{3}$ and $q=\\frac{1}{3}$, we have $r=\\frac{p}{q}=2$. Then\n$$\n\\sum_{k=0}^{4}r^{k}=1+2+4+8+16=31,\n$$\nand\n$$\n\\sum_{i=0}^{4}i r^{i}=0\\cdot 1+1\\cdot 2+2\\cdot 4+3\\cdot 8+4\\cdot 16=2+8+24+64=98.\n$$\nHence\n$$\n\\mathbb{E}[X]=\\frac{98}{31}\\approx 3.161290\\ldots\n$$\nRounded to four significant figures, the long-term average fortune is $3.161$.", "answer": "$$\\boxed{3.161}$$", "id": "1337731"}, {"introduction": "This problem elevates our understanding by revealing an elegant connection between ergodic theory and the structure of graphs. We examine a simple random walk, specifically a king's movement on a chessboard, which is a process on an underlying graph where squares are vertices. For such walks, the stationary distribution is beautifully related to the 'connectivity' or degree of each vertex. This exercise guides you to use this profound insight to compute the long-run average degree of the occupied square, demonstrating how the Ergodic Theorem can leverage the system's geometric properties to make powerful predictions [@problem_id:741494].", "problem": "Consider a simple random walk of a chess king on a standard $8 \\times 8$ chessboard. The state space $S$ of this process is the set of the 64 squares of the board. From any given square, the king moves to one of its adjacent squares (horizontally, vertically, or diagonally) with equal probability, provided the move is on the board. The number of legal moves from a square $s \\in S$ is called the degree of the square, denoted by $d(s)$.\n\nThis process can be modeled as a finite-state, irreducible, and aperiodic Markov chain. The Ergodic Theorem for such chains states that for any function $f$ mapping the states to real numbers, the long-run time average of $f(X_t)$ is equal to the expectation of $f(X)$ with respect to the unique stationary distribution $\\pi$. Specifically,\n$$ \\lim_{T \\to \\infty} \\frac{1}{T} \\sum_{t=0}^{T-1} f(X_t) = \\mathbb{E}_{\\pi}[f(X)] = \\sum_{s \\in S} f(s) \\pi(s) $$\nwhere $X_t$ is the state (square) at time $t$.\n\nFor a simple random walk on a finite, connected, undirected graph, the stationary probability $\\pi(s)$ of being at a vertex (square) $s$ is proportional to its degree $d(s)$:\n$$ \\pi(s) = \\frac{d(s)}{\\sum_{v \\in S} d(v)} $$\n\nUsing these theoretical results, derive the value of the long-run average degree of the square occupied by the king.", "solution": "We seek the long-run average of the degree $d(s)$ under the stationary distribution $\\pi(s)$. By the Ergodic Theorem,\n$$\\lim_{T\\to\\infty}\\frac1T\\sum_{t=0}^{T-1}d(X_t)\n=\\mathbb{E}_{\\pi}[d(X)]\n=\\sum_{s\\in S}d(s)\\,\\pi(s).$$\nFor the simple random walk on an undirected graph,\n$$\\pi(s)=\\frac{d(s)}{\\sum_{v\\in S}d(v)},$$\nso\n$$\\mathbb{E}_{\\pi}[d(X)]\n=\\sum_{s\\in S}d(s)\\,\\frac{d(s)}{\\sum_{v}d(v)}\n=\\frac{\\sum_{s}d(s)^2}{\\sum_{v}d(v)}.$$\nOn the $8\\times8$ board we have\n- Corners: $4$ squares with $d=3$,\n- Edges (non-corner): $24$ squares with $d=5$,\n- Interior: $36$ squares with $d=8$.\nHence\n$$\\sum_{s}d(s)=4\\cdot3+24\\cdot5+36\\cdot8=420,$$\n$$\\sum_{s}d(s)^2=4\\cdot3^2+24\\cdot5^2+36\\cdot8^2=2940.$$\nTherefore the long-run average degree is\n$$\\frac{2940}{420}=7.$$", "answer": "$$\\boxed{7}$$", "id": "741494"}]}