{"hands_on_practices": [{"introduction": "This first practice problem provides a concrete and intuitive scenario to apply the core concepts of stationary distributions. You will model the movement of an elevator in a small building as a Markov chain. By constructing the transition matrix from a simple set of rules, you will be able to calculate the long-run fraction of time the elevator spends on each floor, demonstrating how these theoretical tools predict the steady-state behavior of real-world systems. [@problem_id:1293460]", "problem": "An elevator operates in a small office building with three floors: the Ground floor (Floor 1), the First floor (Floor 2), and the Second floor (Floor 3). The elevator's movement pattern between stops can be described by a set of simple probabilistic rules. Let the current location of the elevator be its location after completing a stop.\n\n- If the elevator is currently on the Ground floor (Floor 1), its next stop is always the First floor (Floor 2).\n- If the elevator is currently on the Second floor (Floor 3), its next stop is also always the First floor (Floor 2).\n- If the elevator is currently on the First floor (Floor 2), there is a probability of $\\frac{1}{2}$ that its next stop will be the Ground floor, a probability of $\\frac{1}{4}$ that it will remain on the First floor, and a probability of $\\frac{1}{4}$ that its next stop will be the Second floor.\n\nAssuming this movement pattern persists indefinitely, what is the long-run fraction of stops the elevator makes on the Ground floor? Express your answer as a single fraction.", "solution": "Let the state of the elevator be its current floor, so the state space is $S = \\{1, 2, 3\\}$. The problem describes a discrete-time Markov chain. We can summarize the given probabilistic rules in a transition matrix $P$, where the element $P_{ij}$ is the probability of moving from floor $i$ to floor $j$.\n\nThe rows of the transition matrix are as follows:\n- From Floor 1 (Ground): The elevator always goes to Floor 2. So, $P_{11}=0$, $P_{12}=1$, $P_{13}=0$.\n- From Floor 2 (First): The probability of going to Floor 1 is $\\frac{1}{2}$, staying at Floor 2 is $\\frac{1}{4}$, and going to Floor 3 is $\\frac{1}{4}$. So, $P_{21}=\\frac{1}{2}$, $P_{22}=\\frac{1}{4}$, $P_{23}=\\frac{1}{4}$.\n- From Floor 3 (Second): The elevator always goes to Floor 2. So, $P_{31}=0$, $P_{32}=1$, $P_{33}=0$.\n\nThe complete transition matrix $P$ is:\n$$\nP = \\begin{pmatrix}\n0 & 1 & 0 \\\\\n\\frac{1}{2} & \\frac{1}{4} & \\frac{1}{4} \\\\\n0 & 1 & 0\n\\end{pmatrix}\n$$\nThe long-run fraction of time the elevator spends on each floor is given by the stationary distribution vector $\\pi = (\\pi_1, \\pi_2, \\pi_3)$. This vector is the unique solution to the system of linear equations defined by $\\pi P = \\pi$, subject to the constraint that the probabilities sum to one, $\\pi_1 + \\pi_2 + \\pi_3 = 1$.\n\nThe matrix equation $\\pi P = \\pi$ can be written as:\n$$\n(\\pi_1, \\pi_2, \\pi_3)\n\\begin{pmatrix}\n0 & 1 & 0 \\\\\n\\frac{1}{2} & \\frac{1}{4} & \\frac{1}{4} \\\\\n0 & 1 & 0\n\\end{pmatrix}\n= (\\pi_1, \\pi_2, \\pi_3)\n$$\nThis gives us a system of three linear equations:\n1.  For the first component (column 1): $\\pi_1(0) + \\pi_2\\left(\\frac{1}{2}\\right) + \\pi_3(0) = \\pi_1 \\implies \\frac{1}{2}\\pi_2 = \\pi_1$\n2.  For the second component (column 2): $\\pi_1(1) + \\pi_2\\left(\\frac{1}{4}\\right) + \\pi_3(1) = \\pi_2 \\implies \\pi_1 + \\pi_3 = \\frac{3}{4}\\pi_2$\n3.  For the third component (column 3): $\\pi_1(0) + \\pi_2\\left(\\frac{1}{4}\\right) + \\pi_3(0) = \\pi_3 \\implies \\frac{1}{4}\\pi_2 = \\pi_3$\n\nWe now have expressions for $\\pi_1$ and $\\pi_3$ in terms of $\\pi_2$:\n- $\\pi_1 = \\frac{1}{2}\\pi_2$\n- $\\pi_3 = \\frac{1}{4}\\pi_2$\n\n(Note: Substituting these into the second equation, $\\frac{1}{2}\\pi_2 + \\frac{1}{4}\\pi_2 = \\frac{3}{4}\\pi_2$, confirms consistency but does not help solve for the values, as one equation in this system is always redundant.)\n\nWe use the normalization condition $\\pi_1 + \\pi_2 + \\pi_3 = 1$ to find the unique solution. Substitute the expressions for $\\pi_1$ and $\\pi_3$:\n$$\n\\left(\\frac{1}{2}\\pi_2\\right) + \\pi_2 + \\left(\\frac{1}{4}\\pi_2\\right) = 1\n$$\nTo solve for $\\pi_2$, we find a common denominator:\n$$\n\\left(\\frac{2}{4}\\pi_2\\right) + \\left(\\frac{4}{4}\\pi_2\\right) + \\left(\\frac{1}{4}\\pi_2\\right) = 1\n$$\n$$\n\\frac{7}{4}\\pi_2 = 1\n$$\n$$\n\\pi_2 = \\frac{4}{7}\n$$\nNow we can find the values of $\\pi_1$ and $\\pi_3$:\n$$\n\\pi_1 = \\frac{1}{2}\\pi_2 = \\frac{1}{2} \\left(\\frac{4}{7}\\right) = \\frac{2}{7}\n$$\n$$\n\\pi_3 = \\frac{1}{4}\\pi_2 = \\frac{1}{4} \\left(\\frac{4}{7}\\right) = \\frac{1}{7}\n$$\nThe stationary distribution is $\\pi = \\left(\\frac{2}{7}, \\frac{4}{7}, \\frac{1}{7}\\right)$.\nThe question asks for the long-run fraction of stops the elevator makes on the Ground floor, which corresponds to the component $\\pi_1$.\n\nThus, the long-run fraction of stops on the Ground floor is $\\frac{2}{7}$.", "answer": "$$\\boxed{\\frac{2}{7}}$$", "id": "1293460"}, {"introduction": "Moving from a numerical to a symbolic context, this problem challenges you to analyze the reliability of a computer system. You will model its operational, crashing, and rebooting cycle as a three-state Markov chain where transition probabilities are given as variables. This practice is essential for learning how to derive general formulas for system performance metrics, such as the long-run probability of being in a crashed state, which is a vital skill in engineering and system design. [@problem_id:1293445]", "problem": "A legacy computer system runs a critical process in a continuous loop. The process consists of executing two functions, `FUNC_A` and `FUNC_B`, in strict alternation. The system's behavior can be modeled in discrete time steps, where each step corresponds to the completion of one function call.\n\nThe sequence of operations is as follows:\n- After successfully completing `FUNC_A`, the system immediately attempts to execute `FUNC_B`.\n- After successfully completing `FUNC_B`, the system immediately attempts to execute `FUNC_A`.\n\nHowever, due to unstable hardware, the system is prone to crashing.\n- After each execution of `FUNC_A`, there is a fixed probability $p_A$ that the system crashes instead of proceeding to `FUNC_B`.\n- Similarly, after each execution of `FUNC_B`, there is a fixed probability $p_B$ that the system crashes instead of proceeding to `FUNC_A`.\n\nAn automated monitoring service is in place to handle crashes. At each time step, if the system is in a crashed state, the service attempts a reboot. The reboot is successful with a probability $r$, in which case the system immediately starts its process loop again by executing `FUNC_A`. If the reboot attempt fails (with probability $1-r$), the system remains in the crashed state for that time step.\n\nAssume the system has been running for a very long time and has reached a steady state. Find an expression for the long-run probability that the system is in the crashed state. Your answer should be a symbolic expression in terms of $p_A$, $p_B$, and $r$.", "solution": "Model the system as a discrete-time Markov chain with three states representing what happens at the next time step:\n- $A$: the system executes `FUNC_A`,\n- $B$: the system executes `FUNC_B`,\n- $C$: the system is crashed (a reboot attempt occurs).\n\nFrom the description, the one-step transition probabilities are:\n- From $A$: to $C$ with probability $p_{A}$ (crash after $A$), to $B$ with probability $1 - p_{A}$.\n- From $B$: to $C$ with probability $p_{B}$ (crash after $B$), to $A$ with probability $1 - p_{B}$.\n- From $C$: to $A$ with probability $r$ (successful reboot), to $C$ with probability $1 - r$ (failed reboot).\n\nLet the stationary probabilities be $\\pi_{A}$, $\\pi_{B}$, and $\\pi_{C}$ for states $A$, $B$, and $C$, respectively. In steady state, they satisfy the balance equations and normalization:\n$$\n\\pi_{A} = \\pi_{B} (1 - p_{B}) + \\pi_{C} r,\n$$\n$$\n\\pi_{B} = \\pi_{A} (1 - p_{A}),\n$$\n$$\n\\pi_{C} = \\pi_{A} p_{A} + \\pi_{B} p_{B} + \\pi_{C} (1 - r),\n$$\n$$\n\\pi_{A} + \\pi_{B} + \\pi_{C} = 1.\n$$\nFrom $\\pi_{B} = \\pi_{A} (1 - p_{A})$, substitute into the $\\pi_{C}$ balance:\n$$\n\\pi_{C} r = \\pi_{A} p_{A} + \\pi_{B} p_{B} = \\pi_{A} p_{A} + \\pi_{A} (1 - p_{A}) p_{B} = \\pi_{A} \\left(p_{A} + p_{B} - p_{A} p_{B}\\right).\n$$\nHence\n$$\n\\pi_{A} = \\frac{\\pi_{C} r}{p_{A} + p_{B} - p_{A} p_{B}},\n\\quad\n\\pi_{B} = (1 - p_{A}) \\pi_{A} = (1 - p_{A}) \\frac{\\pi_{C} r}{p_{A} + p_{B} - p_{A} p_{B}}.\n$$\nUse normalization to solve for $\\pi_{C}$:\n$$\n1 = \\pi_{A} + \\pi_{B} + \\pi_{C}\n= \\frac{\\pi_{C} r}{p_{A} + p_{B} - p_{A} p_{B}} \\left[1 + (1 - p_{A})\\right] + \\pi_{C}\n= \\frac{\\pi_{C} r (2 - p_{A})}{p_{A} + p_{B} - p_{A} p_{B}} + \\pi_{C}.\n$$\nTherefore,\n$$\n\\pi_{C} \\left[1 + \\frac{r (2 - p_{A})}{p_{A} + p_{B} - p_{A} p_{B}}\\right] = 1,\n$$\nwhich yields\n$$\n\\pi_{C} = \\frac{p_{A} + p_{B} - p_{A} p_{B}}{p_{A} + p_{B} - p_{A} p_{B} + r (2 - p_{A})}.\n$$\nThis $\\pi_{C}$ is the long-run probability that the system is in the crashed state.", "answer": "$$\\boxed{\\frac{p_{A} + p_{B} - p_{A} p_{B}}{p_{A} + p_{B} - p_{A} p_{B} + r (2 - p_{A})}}$$", "id": "1293445"}, {"introduction": "This final problem elevates the complexity by introducing a model from quantitative finance with a large, structured state space. You will analyze a firm's capital, which follows a random walk but is constrained by risk management protocols that create special boundary conditionsâ€”a reflecting upper barrier and a resetting lower threshold. This exercise will teach you how to analyze the stationary behavior of such systems, which often requires solving linear difference equations, a powerful technique for chains with regular structure. [@problem_id:1293455]", "problem": "A quantitative trading firm models its daily capital using a stochastic process. The firm's capital, denoted by $X_t$ on day $t$, can be represented by an integer. Each day, the capital changes by a fixed amount: it increases by 1 unit with probability $p$ or decreases by 1 unit with probability $q=1-p$, where $p \\neq q$.\n\nThe firm has two strict risk management protocols:\n1.  An upper capital limit is set at $M$. If the capital is $M$ and a profit occurs that would increase it, the excess is skimmed off, so the capital remains at $M$.\n2.  A lower capital threshold is set at $L$. If, at the end of any day, the capital is found to be at or below $L$, the firm's backers immediately inject funds to reset the capital to a predetermined level $S$ for the beginning of the next day. The parameters satisfy $0  L  S  M$.\n\nThe state of the system is observed at the beginning of each day, after any potential reset. Therefore, the possible capital levels form the set of integers $\\{L+1, L+2, \\dots, M\\}$. After a very long time, the system reaches a stationary distribution, where $\\pi_k$ is the probability of having capital $k$.\n\nFind the stationary probability, $\\pi_S$, that the firm's capital is at the reset level $S$. Express your answer as a closed-form analytic expression in terms of $L, S, M$, and the ratio $\\rho = p/q$.", "solution": "Let the states be the integers $k \\in \\{L+1,L+2,\\dots,M\\}$. The one-step transitions are:\n- For $L+1kM$: $P_{k,k+1}=p$ and $P_{k,k-1}=q$.\n- For $k=M$: $P_{M,M}=p$ and $P_{M,M-1}=q$ (reflection at $M$).\n- For $k=L+1$: $P_{L+1,L+2}=p$ and $P_{L+1,S}=q$ (reset to $S$ upon a downward move).\nLet $\\rho=p/q$ with $p \\neq q$.\n\nIn stationarity, for any $k$ with $k \\notin \\{L+1,S,M\\}$ the balance equation is\n$$\n\\pi_{k}=p\\pi_{k-1}+q\\pi_{k+1}.\n$$\nThe general solution of the homogeneous recurrence $q\\pi_{k+1}-\\pi_{k}+p\\pi_{k-1}=0$ is $\\pi_{k}=A+B\\rho^{k}$ on any contiguous segment where no inhomogeneous term appears.\n\nSplit the line at $S$:\n- Upper segment $k \\in \\{S+1,\\dots,M\\}$: write $\\pi_{k}=A_{u}+B_{u}\\rho^{k}$. Stationarity at $M$ gives $\\pi_{M}=p(\\pi_{M-1}+\\pi_{M})$, i.e., $\\pi_{M-1}p=\\pi_{M}q$, which forces zero current and hence $A_{u}=0$. Thus\n$$\n\\pi_{k}=C\\,\\rho^{k},\\quad k=S+1,\\dots,M,\n$$\nfor some constant $C$.\n- Lower segment $k \\in \\{L+1,\\dots,S-1\\}$: write $\\pi_{k}=A_{\\ell}+B_{\\ell}\\rho^{k}$. The boundary balance at $L+1$ is $\\pi_{L+1}=q\\pi_{L+2}$. Substituting gives\n$$\nA_{\\ell}+B_{\\ell}\\rho^{L+1}=q\\bigl(A_{\\ell}+B_{\\ell}\\rho^{L+2}\\bigr)\\;\\Rightarrow\\;pA_{\\ell}+qB_{\\ell}\\rho^{L+1}=0,\n$$\nso $A_{\\ell}=-B_{\\ell}\\rho^{L}$. Therefore, for $L+1 \\le k \\le S-1$,\n$$\n\\pi_{k}=B_{\\ell}\\bigl(\\rho^{k}-\\rho^{L}\\bigr).\n$$\n\nAt the special state $S$, stationarity includes the reset inflow:\n$$\n\\pi_{S}=p\\pi_{S-1}+q\\pi_{S+1}+q\\pi_{L+1}.\n$$\nWith $\\pi_{S-1}=B_{\\ell}(\\rho^{S-1}-\\rho^{L})$, $\\pi_{S+1}=C\\rho^{S+1}$, $\\pi_{L+1}=B_{\\ell}(\\rho^{L+1}-\\rho^{L})$, and using $q\\rho=p$, this simplifies to\n$$\n\\pi_{S}=q\\Bigl[B_{\\ell}\\bigl(\\rho^{S}-\\rho^{L}\\bigr)+C\\rho^{S+1}\\Bigr].\n$$\n\nNext, use stationarity at $S+1$:\n$$\n\\pi_{S+1}=p\\pi_{S}+q\\pi_{S+2}.\n$$\nWith $\\pi_{S+1}=C\\rho^{S+1}$ and $\\pi_{S+2}=C\\rho^{S+2}$, one gets\n$$\nC\\rho^{S+1}=p\\pi_{S}+qC\\rho^{S+2}=p\\pi_{S}+pC\\rho^{S+1},\n$$\nhence $C\\rho^{S+1}=\\rho\\,\\pi_{S}$ and thus $C=\\pi_{S}\\rho^{-S}$. Therefore, for $k \\ge S+1$,\n$$\n\\pi_{k}=\\pi_{S}\\rho^{k-S}.\n$$\n\nSubstitute $C\\rho^{S+1}=\\rho\\pi_{S}$ back into the $S$-equation to get\n$$\n\\pi_{S}=q\\Bigl[B_{\\ell}\\bigl(\\rho^{S}-\\rho^{L}\\bigr)+\\rho\\,\\pi_{S}\\Bigr]\\;\\Rightarrow\\;q\\pi_{S}=qB_{\\ell}\\bigl(\\rho^{S}-\\rho^{L}\\bigr),\n$$\nso\n$$\nB_{\\ell}=\\frac{\\pi_{S}}{\\rho^{S}-\\rho^{L}}.\n$$\nThus, for $L+1 \\le k \\le S-1$,\n$$\n\\pi_{k}=\\pi_{S}\\,\\frac{\\rho^{k}-\\rho^{L}}{\\rho^{S}-\\rho^{L}}.\n$$\n\nNow impose normalization:\n$$\n\\sum_{k=L+1}^{M}\\pi_{k}=1=\\sum_{k=L+1}^{S-1}\\pi_{k}+\\pi_{S}+\\sum_{k=S+1}^{M}\\pi_{k}.\n$$\nCompute the sums:\n$$\n\\sum_{k=S+1}^{M}\\pi_{k}=\\pi_{S}\\sum_{j=1}^{M-S}\\rho^{j}=\\pi_{S}\\,\\rho\\,\\frac{1-\\rho^{M-S}}{1-\\rho},\n$$\nand\n$$\n\\sum_{k=L+1}^{S-1}\\pi_{k}=\\pi_{S}\\,\\frac{1}{\\rho^{S}-\\rho^{L}}\\sum_{k=L+1}^{S-1}\\bigl(\\rho^{k}-\\rho^{L}\\bigr)\n=\\pi_{S}\\,\\frac{\\rho\\bigl(1-\\rho^{S-L-1}\\bigr)/(1-\\rho)-(S-L-1)}{\\rho^{S-L}-1}.\n$$\nLet $a=S-L$ and $b=M-S$. Then\n$$\n1=\\pi_{S}\\left[1+\\frac{\\rho\\bigl(1-\\rho^{b}\\bigr)}{1-\\rho}+\\frac{\\rho\\bigl(1-\\rho^{a-1}\\bigr)/(1-\\rho)-(a-1)}{\\rho^{a}-1}\\right].\n$$\nSolving for $\\pi_{S}$ and simplifying the bracket algebraically yields\n$$\n\\pi_{S}=\\frac{(1-\\rho)\\bigl(\\rho^{a}-1\\bigr)}{a(\\rho-1)+\\rho^{b+1}-\\rho^{a+b+1}}.\n$$\nEquivalently,\n$$\n\\pi_{S}=\\frac{(\\rho-1)\\bigl(\\rho^{a}-1\\bigr)}{\\rho^{b+1}\\bigl(\\rho^{a}-1\\bigr)-(\\rho-1)a}.\n$$\nSubstituting back $a=S-L$ and $b=M-S$ gives the required closed form:\n$$\n\\pi_{S}=\\frac{(\\rho-1)\\bigl(\\rho^{\\,S-L}-1\\bigr)}{\\rho^{\\,M-S+1}\\bigl(\\rho^{\\,S-L}-1\\bigr)-(\\rho-1)(S-L)}.\n$$\nThis holds for $\\rho \\neq 1$ (i.e., $p \\neq q$), as specified.", "answer": "$$\\boxed{\\frac{(\\rho-1)\\bigl(\\rho^{\\,S-L}-1\\bigr)}{\\rho^{\\,M-S+1}\\bigl(\\rho^{\\,S-L}-1\\bigr)-(\\rho-1)(S-L)}}$$", "id": "1293455"}]}