{"hands_on_practices": [{"introduction": "The first step in any particle filter is prediction, where we use a model of the system's dynamics to project our current state hypotheses forward in time. This exercise [@problem_id:1322969] grounds this abstract idea in a tangible physical scenario: tracking a falling probe. By calculating the new states of several particles, you will gain hands-on experience with how the filter explores the state space, accounting for both deterministic motion (gravity) and random perturbations (process noise).", "problem": "An aerospace engineering team is developing a state estimation algorithm for a small sensor probe designed to be dropped from a high-altitude balloon. They use a simulation technique involving multiple computational 'particles', where each particle represents a hypothesis for the probe's true state. The state of the probe is defined by its vertical position, $y$ (positive upwards), and its vertical velocity, $v_y$.\n\nAt time $t=0$, the system is initialized with a set of three particles. Their initial states $(y_0, v_{y,0})$ are given as:\n- Particle 1: $(100.0 \\, \\text{m}, 0.5 \\, \\text{m/s})$\n- Particle 2: $(100.5 \\, \\text{m}, -0.2 \\, \\text{m/s})$\n- Particle 3: $(99.8 \\, \\text{m}, 0.1 \\, \\text{m/s})$\n\nThe state of each particle is propagated forward in time using a discrete model that accounts for gravity and small, random perturbations. For a time step of $\\Delta t$, the state $(y_k, v_{y,k})$ at time step $k$ evolves to the state $(y_{k+1}, v_{y,k+1})$ at time step $k+1$ according to the following equations:\n$$y_{k+1} = y_k + v_{y,k} \\Delta t - \\frac{1}{2} g (\\Delta t)^2 + w_y$$\n$$v_{y,k+1} = v_{y,k} - g \\Delta t + w_v$$\nwhere $g$ is the acceleration due to gravity, and $w_y$ and $w_v$ are the random perturbations for that time step.\n\nFor the first time step from $t=0$ to $t=\\Delta t=0.1 \\, \\text{s}$, the team uses the constant $g = 9.81 \\, \\text{m/s}^2$. The specific perturbation values sampled for each particle during this step are:\n- For Particle 1: $(w_y, w_v) = (0.02 \\, \\text{m}, 0.05 \\, \\text{m/s})$\n- For Particle 2: $(w_y, w_v) = (-0.01 \\, \\text{m}, -0.03 \\, \\text{m/s})$\n- For Particle 3: $(w_y, w_v) = (0.03 \\, \\text{m}, 0.01 \\, \\text{m/s})$\n\nThe overall estimate of the probe's position at a given time is taken as the arithmetic mean of the positions of all particles. Calculate this mean vertical position at time $t = \\Delta t$. Express your final answer in meters, rounded to four significant figures.", "solution": "We propagate each particle’s vertical position over the interval $\\Delta t$ using\n$$\ny_{k+1}=y_{k}+v_{y,k}\\,\\Delta t-\\frac{1}{2}g\\,(\\Delta t)^{2}+w_{y}.\n$$\nFor this step, $\\Delta t=0.1\\,\\text{s}$ and $g=9.81\\,\\text{m/s}^{2}$. The gravitational displacement term common to all particles is\n$$\n\\frac{1}{2}g(\\Delta t)^{2}=\\frac{1}{2}\\cdot 9.81\\cdot (0.1)^{2}=0.04905\\,\\text{m}.\n$$\nThus, for each particle $j$, the update becomes\n$$\ny_{1}^{(j)}=y_{0}^{(j)}+v_{y,0}^{(j)}\\,(0.1)-0.04905+w_{y}^{(j)}.\n$$\nCompute each:\n$$\n\\begin{aligned}\n\\text{Particle 1:}\\quad y_{1}^{(1)}&=100.0+0.5\\cdot 0.1-0.04905+0.02=100.02095\\,\\text{m},\\\\\n\\text{Particle 2:}\\quad y_{1}^{(2)}&=100.5+(-0.2)\\cdot 0.1-0.04905-0.01=100.42095\\,\\text{m},\\\\\n\\text{Particle 3:}\\quad y_{1}^{(3)}&=99.8+0.1\\cdot 0.1-0.04905+0.03=99.79095\\,\\text{m}.\n\\end{aligned}\n$$\nThe arithmetic mean of the positions at $t=\\Delta t$ is\n$$\n\\bar{y}_{1}=\\frac{y_{1}^{(1)}+y_{1}^{(2)}+y_{1}^{(3)}}{3}=\\frac{100.02095+100.42095+99.79095}{3}=\\frac{300.23285}{3}=100.077616\\ldots\\,\\text{m}.\n$$\nRounding to four significant figures gives $100.1\\,\\text{m}$.", "answer": "$$\\boxed{100.1}$$", "id": "1322969"}, {"introduction": "A key strength of particle filters is their ability to handle complex, non-standard sensor measurements. This practice [@problem_id:1322990] moves beyond simple prediction to demonstrate the full one-step cycle, including the crucial measurement update. You will work with a scenario where the sensor provides only quantized zone information, forcing you to implement a non-Gaussian likelihood model to weigh the importance of each particle and compute a final state estimate.", "problem": "A self-driving cart moves along a 1D track that spans from $x=0$ to $x=12$ meters. Its position is monitored using a set of five computational particles, which represent hypotheses about the cart's true position. The state of the cart is its 1D position, $x$.\n\nThe cart's motion is modeled by a simple random walk. The predicted position of a particle at time $t$ is given by its position at time $t-1$ plus a random displacement: $x_t^{(\\text{pred})} = x_{t-1} + v_t$. The initial positions of the five particles at time $t=0$ are:\n$x_0^{(1)} = 1.5$ m, $x_0^{(2)} = 3.5$ m, $x_0^{(3)} = 5.0$ m, $x_0^{(4)} = 7.5$ m, $x_0^{(5)} = 10.0$ m.\n\nFor the time step from $t=0$ to $t=1$, the specific random displacements experienced by each particle are given as:\n$v_0^{(1)} = +2.0$ m, $v_0^{(2)} = +1.2$ m, $v_0^{(3)} = -1.8$ m, $v_0^{(4)} = -2.5$ m, $v_0^{(5)} = -3.1$ m.\n\nThe track is equipped with a low-resolution zone sensor that reports which of four zones the cart occupies. The zones are defined as:\n- Zone 1: $0 \\text{ m} \\le x < 3.0 \\text{ m}$\n- Zone 2: $3.0 \\text{ m} \\le x < 6.0 \\text{ m}$\n- Zone 3: $6.0 \\text{ m} \\le x < 9.0 \\text{ m}$\n- Zone 4: $9.0 \\text{ m} \\le x \\le 12.0 \\text{ m}$\n\nAt time $t=1$, the sensor makes a measurement and reports that the cart is in Zone 2.\n\nThe estimation algorithm updates the importance of each particle based on this measurement. A \"survival score\" is assigned to each predicted particle position $x_1^{(\\text{pred})}$. The score is 1 if the particle's position is consistent with the measurement (i.e., falls within the measured zone), and 0 otherwise. The final estimate of the cart's position, $\\hat{x}_1$, is the arithmetic mean of the positions of only those particles that received a non-zero survival score.\n\nCalculate the estimated position $\\hat{x}_1$ of the cart at time $t=1$. Express your answer in meters, rounded to three significant figures.", "solution": "The motion model is a random walk with prediction equation $x_{t}^{(\\text{pred})} = x_{t-1} + v_{t}$. For $t=1$, compute each particle’s predicted position:\n$$\n\\begin{aligned}\nx_{1}^{(\\text{pred},1)} &= x_{0}^{(1)} + v_{0}^{(1)} = 1.5 + 2.0 = 3.5,\\\\\nx_{1}^{(\\text{pred},2)} &= x_{0}^{(2)} + v_{0}^{(2)} = 3.5 + 1.2 = 4.7,\\\\\nx_{1}^{(\\text{pred},3)} &= x_{0}^{(3)} + v_{0}^{(3)} = 5.0 - 1.8 = 3.2,\\\\\nx_{1}^{(\\text{pred},4)} &= x_{0}^{(4)} + v_{0}^{(4)} = 7.5 - 2.5 = 5.0,\\\\\nx_{1}^{(\\text{pred},5)} &= x_{0}^{(5)} + v_{0}^{(5)} = 10.0 - 3.1 = 6.9.\n\\end{aligned}\n$$\nThe measurement indicates Zone 2, defined by $3.0 \\le x < 6.0$. The particles consistent with this are those with $x_{1}^{(\\text{pred})} \\in [3.0, 6.0)$, namely $3.5$, $4.7$, $3.2$, and $5.0$. The survival scores are therefore $1$ for these four and $0$ for $6.9$.\n\nThe estimate is the arithmetic mean of the surviving predicted positions:\n$$\n\\hat{x}_{1} = \\frac{3.5 + 4.7 + 3.2 + 5.0}{4} = \\frac{16.4}{4} = 4.1.\n$$\nRounding to three significant figures gives $4.10$ meters.", "answer": "$$\\boxed{4.10}$$", "id": "1322990"}, {"introduction": "While powerful, the basic particle filter algorithm has inherent challenges, the most famous being particle impoverishment or degeneracy. This thought experiment [@problem_id:1322989] invites you to analyze the filter's long-term behavior in a special case—a stationary target with no process noise—to understand why the particle diversity can collapse over time. Correctly diagnosing this behavior is a critical skill for designing robust real-world filters, as it reveals the essential role of process noise and resampling.", "problem": "Consider a one-dimensional tracking problem where the goal is to estimate the constant position, $x$, of a stationary object.\n\nThe state of the object at a discrete time step $k$ is its position $x_k$. The state evolution is governed by the process model $x_k = x_{k-1}$. This model indicates that the object does not move and there is zero process noise.\n\nNoisy measurements, $z_k$, of the object's position are obtained at each time step. The measurement model is given by a Gaussian probability density function:\n$$p(z_k | x_k) = \\frac{1}{\\sqrt{2\\pi\\sigma_z^2}} \\exp\\left(-\\frac{(z_k - x_k)^2}{2\\sigma_z^2}\\right)$$\nwhere $x_{true}$ is the true, unknown, constant position of the object, $z_k$ is a random variable drawn from this distribution, and $\\sigma_z^2$ is the known, constant measurement variance.\n\nA particle filter is used to estimate the object's position. The filter employs a set of $N$ particles. At time $k=0$, the particles' initial states, $\\{x_i^{(0)}\\}_{i=1}^N$, are initialized by drawing samples from some prior probability distribution. It is not assumed that any of the initial particle states $x_i^{(0)}$ are equal to the true position $x_{true}$.\n\nThe filter operates using the standard Sequential Importance Resampling (SIR) algorithm. At each time step $k > 0$, the filter sequentially performs a prediction step, a weight update step, and a resampling step.\n\nGiven this setup, which of the following statements best describes the most likely long-term behavior of the set of all particle states $\\{x_i^{(k)}\\}_{i=1 \\dots N}$ as the number of time steps $k$ tends to infinity?\n\nA. The particles will converge to the true position of the object, $x_{true}$.\n\nB. The particles will form a stable cloud of points centered around the true position $x_{true}$, with a non-zero variance that depends on the measurement variance $\\sigma_z^2$.\n\nC. All particles will collapse to a single position, which corresponds to one of the specific positions from the initial set of particles $\\{x_i^{(0)}\\}_{i=1}^N$.\n\nD. The particles will diverge, with their positions spreading out over an ever-increasing range as time progresses.\n\nE. The particles will become uniformly distributed over the entire state space.", "solution": "We have a static state model with zero process noise:\n$$\nx_{k} = x_{k-1},\n$$\nand a Gaussian measurement model\n$$\np(z_{k}\\mid x_{k}) = \\frac{1}{\\sqrt{2\\pi \\sigma_{z}^{2}}}\\exp\\!\\left(-\\frac{(z_{k}-x_{k})^{2}}{2\\sigma_{z}^{2}}\\right),\n$$\nwith observations generated by $Z_{k}\\sim \\mathcal{N}(x_{true},\\sigma_{z}^{2})$ independently over $k$.\n\nIn the SIR particle filter with zero process noise, the prediction step leaves particle locations unchanged:\n$$\nx_{i}^{(k\\mid k-1)}=x_{i}^{(k-1)}=x_{i}^{(0)}\\quad \\text{for all }k.\n$$\nLet $w_{i}^{(k)}$ denote the normalized weight of particle $i$ at time $k$. The unnormalized weight update is\n$$\n\\tilde{w}_{i}^{(k)}=\\tilde{w}_{i}^{(k-1)}\\,p(z_{k}\\mid x_{i}^{(k\\mid k-1)})=\\tilde{w}_{i}^{(k-1)}\\,p(z_{k}\\mid x_{i}^{(0)}),\n$$\nhence by recursion,\n$$\n\\tilde{w}_{i}^{(k)} \\propto \\prod_{t=1}^{k} p(z_{t}\\mid x_{i}^{(0)}).\n$$\nEquivalently, in log form,\n$$\n\\ln \\tilde{w}_{i}^{(k)} = \\sum_{t=1}^{k} \\ln p(z_{t}\\mid x_{i}^{(0)}) + \\text{constant independent of }i.\n$$\nDefine the average log-likelihood\n$$\nL_{i}^{(k)} \\equiv \\frac{1}{k}\\sum_{t=1}^{k} \\ln p(z_{t}\\mid x_{i}^{(0)}).\n$$\nBy the strong law of large numbers, since $Z_{t}$ are i.i.d. from $p(\\cdot \\mid x_{true})$,\n$$\nL_{i}^{(k)} \\xrightarrow[k\\to\\infty]{\\text{a.s.}} \\mathbb{E}\\big[\\ln p(Z\\mid x_{i}^{(0)})\\big], \\quad Z\\sim \\mathcal{N}(x_{true},\\sigma_{z}^{2}).\n$$\nFor the Gaussian likelihood,\n$$\n\\ln p(Z\\mid x_{i}^{(0)}) = -\\frac{1}{2}\\ln(2\\pi \\sigma_{z}^{2}) - \\frac{(Z - x_{i}^{(0)})^{2}}{2\\sigma_{z}^{2}},\n$$\nso\n$$\n\\mathbb{E}\\big[\\ln p(Z\\mid x_{i}^{(0)})\\big] = -\\frac{1}{2}\\ln(2\\pi \\sigma_{z}^{2}) - \\frac{\\mathbb{E}[(Z - x_{i}^{(0)})^{2}]}{2\\sigma_{z}^{2}}.\n$$\nBecause $Z\\sim \\mathcal{N}(x_{true},\\sigma_{z}^{2})$,\n$$\n\\mathbb{E}[(Z - x_{i}^{(0)})^{2}] = \\sigma_{z}^{2} + (x_{true} - x_{i}^{(0)})^{2},\n$$\nhence\n$$\n\\mathbb{E}\\big[\\ln p(Z\\mid x_{i}^{(0)})\\big] = \\text{constant} - \\frac{(x_{true} - x_{i}^{(0)})^{2}}{2\\sigma_{z}^{2}}.\n$$\nTherefore, among the fixed discrete set $\\{x_{i}^{(0)}\\}_{i=1}^{N}$, the expected log-likelihood is uniquely maximized (except for zero-probability ties) by the index\n$$\ni^{\\star}\\in \\arg\\min_{i} \\big|x_{i}^{(0)} - x_{true}\\big|.\n$$\nConsequently, as $k\\to\\infty$, the normalized weights concentrate almost surely on $i^{\\star}$:\n$$\nw_{i^{\\star}}^{(k)} \\to 1,\\quad w_{i}^{(k)} \\to 0 \\text{ for } i\\neq i^{\\star}.\n$$\nUnder SIR with resampling at each step and zero process noise, resampling will replicate particles according to these weights while particle locations cannot move. Hence, after sufficiently many steps, all $N$ particles become copies of $x_{i^{\\star}}^{(0)}$, and they remain there forever. This position is necessarily one of the initial particle states and in general is not exactly $x_{true}$ unless an initial particle equals $x_{true}$.\n\nTherefore:\n- A is not generally true because particles cannot move to new positions not in the initial set; convergence to $x_{true}$ occurs only if some $x_{i}^{(0)}=x_{true}$.\n- B is false because, without process noise or rejuvenation, resampling leads to collapse, not a stable cloud of nonzero variance.\n- C is true: the set collapses to a single initial particle location maximizing the likelihood over the data.\n- D and E are impossible since particle locations are fixed by the initial set and resampling does not create new positions or spread them.\n\nThus the most likely long-term behavior is collapse to one initial particle location.", "answer": "$$\\boxed{C}$$", "id": "1322989"}]}