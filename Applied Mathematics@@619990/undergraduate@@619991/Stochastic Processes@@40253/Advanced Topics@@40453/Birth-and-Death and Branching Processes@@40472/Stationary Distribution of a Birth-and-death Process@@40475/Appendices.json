{"hands_on_practices": [{"introduction": "We begin with a foundational model applicable to diverse scenarios, from customers in a large service center to units of wealth for an individual. This exercise [@problem_id:1333907] explores a system where \"births\" occur at a constant rate, $\\lambda_n = \\lambda$, and \"deaths\" occur at a rate proportional to the current population, $\\mu_n = n\\mu$. Solving this problem will demonstrate how the principles of stationary distribution lead directly to the Poisson distribution, a familiar and fundamental result in probability theory.", "problem": "Consider a simplified model for the personal wealth of a gig economy worker. The worker's wealth is measured in discrete monetary units. New units are acquired randomly over time, with the arrivals following a Poisson process at a constant average rate of $\\lambda$ units per hour. The worker also spends their money, and we model this as a loss process. The probability of spending one unit of money in a small time interval is proportional to the number of units, $n$, the worker currently possesses. Specifically, if the worker has $n$ units, the instantaneous rate of losing one unit is given by $\\mu_n = n \\mu$, where $\\mu$ is a constant loss-rate parameter with units of inverse hours. Assume that the processes of acquiring and losing money are independent.\n\nLet $N(t)$ be the number of monetary units the worker possesses at time $t$. After a very long time, the system is expected to reach a statistical equilibrium. What is the long-run probability, $P(N=n)$, that the worker possesses exactly $n$ units of money, for $n = 0, 1, 2, \\dots$? Express your answer as a function of $n$, $\\lambda$, and $\\mu$.", "solution": "We model $N(t)$ as a continuous-time birth-death process on the nonnegative integers, with:\n- Births (acquisitions) occurring at constant rate $\\lambda$, so the transition $n \\to n+1$ occurs at rate $\\lambda$ for all $n \\geq 0$.\n- Deaths (spending) occurring at rate $\\mu_{n} = n \\mu$, so the transition $n \\to n-1$ occurs at rate $n \\mu$ for all $n \\geq 1$.\n\nIn statistical equilibrium, let $\\pi_{n} = P(N=n)$ denote the stationary probability of being in state $n$. For a birth-death process in equilibrium, the local (detailed) balance equations between neighboring states hold:\n$$\n\\pi_{n} \\cdot \\lambda = \\pi_{n+1} \\cdot \\mu (n+1), \\quad \\text{for all } n \\geq 0.\n$$\nSolving this recursion gives\n$$\n\\pi_{n+1} = \\frac{\\lambda}{\\mu (n+1)} \\pi_{n} \\quad \\Longrightarrow \\quad \\pi_{n} = \\pi_{0} \\prod_{k=0}^{n-1} \\frac{\\lambda}{\\mu (k+1)} = \\pi_{0} \\frac{(\\lambda/\\mu)^{n}}{n!}, \\quad \\text{for } n \\geq 1,\n$$\nwith $\\pi_{0}$ to be determined by normalization. Enforcing $\\sum_{n=0}^{\\infty} \\pi_{n} = 1$ yields\n$$\n\\sum_{n=0}^{\\infty} \\pi_{n} = \\pi_{0} \\sum_{n=0}^{\\infty} \\frac{(\\lambda/\\mu)^{n}}{n!} = \\pi_{0} \\exp\\!\\left(\\frac{\\lambda}{\\mu}\\right) = 1,\n$$\nhence\n$$\n\\pi_{0} = \\exp\\!\\left(-\\frac{\\lambda}{\\mu}\\right).\n$$\nTherefore,\n$$\nP(N=n) = \\pi_{n} = \\exp\\!\\left(-\\frac{\\lambda}{\\mu}\\right) \\frac{\\left(\\frac{\\lambda}{\\mu}\\right)^{n}}{n!}, \\quad n = 0, 1, 2, \\dots,\n$$\nwhich is a Poisson distribution with mean $\\lambda/\\mu$.", "answer": "$$\\boxed{\\exp\\!\\left(-\\frac{\\lambda}{\\mu}\\right)\\,\\frac{\\left(\\frac{\\lambda}{\\mu}\\right)^{n}}{n!}}$$", "id": "1333907"}, {"introduction": "Real-world systems often exhibit behavior that changes depending on their current state. This practice [@problem_id:1333904] models such a scenario, where the arrival rate of jobs into a queue alternates between two different values based on system occupancy, while the service rate remains constant. By working through this problem, you will gain experience in handling more complex state-dependent rates and see how to use series summation to find key performance metrics, such as the probability of the system being idle.", "problem": "Consider a single-server queueing system model for a specialized data processing center. New processing jobs arrive according to a Poisson process, but the arrival rate depends on the number of jobs already in the system, $n$. Specifically, when the number of jobs $n$ is even (including zero), the arrival rate is $\\lambda_n = a$. When the number of jobs $n$ is odd, the arrival rate is $\\lambda_n = b$. The service time for each job is exponentially distributed, leading to a constant service rate of $\\mu_n = \\mu$ for $n \\ge 1$. This means jobs are processed and leave the system at a rate $\\mu$ as long as the system is not empty.\n\nAssume the system reaches a steady state and that the condition for stability is met, ensuring a stationary distribution exists. Your task is to find the probability that the system is empty, denoted as $\\pi_0$. Express your answer as a closed-form analytic expression in terms of the parameters $a$, $b$, and $\\mu$.", "solution": "Model the system as a birth-death process with birth rates $\\lambda_{n}$ and death rates $\\mu_{n}$. In steady state, local balance holds for all $n \\ge 0$:\n$$\n\\pi_{n} \\lambda_{n} = \\pi_{n+1} \\mu_{n+1},\n$$\nwhere $\\pi_{n} = P(N=n)$ and $\\mu_{n}=\\mu$ for $n \\ge 1$. Hence, for $n \\ge 0$,\n$$\n\\pi_{n+1} = \\pi_{n} \\frac{\\lambda_{n}}{\\mu}.\n$$\nUsing the alternating birth rates $\\lambda_{n}=a$ for $n$ even and $\\lambda_{n}=b$ for $n$ odd, iterating the recursion yields\n$$\n\\pi_{1} = \\pi_{0} \\frac{a}{\\mu}, \\quad\n\\pi_{2} = \\pi_{0} \\frac{ab}{\\mu^{2}}, \\quad\n\\pi_{3} = \\pi_{0} \\frac{a^{2} b}{\\mu^{3}}, \\quad\n\\pi_{4} = \\pi_{0} \\frac{a^{2} b^{2}}{\\mu^{4}}, \\ \\ldots\n$$\nDefine $r = \\frac{ab}{\\mu^{2}}$. Then for $m \\ge 0$,\n$$\n\\pi_{2m} = \\pi_{0} r^{m}, \n\\qquad\n\\pi_{2m+1} = \\pi_{0} \\frac{a}{\\mu} r^{m}.\n$$\nNormalization $\\sum_{n=0}^{\\infty} \\pi_{n} = 1$ gives\n$$\n1 = \\sum_{m=0}^{\\infty} \\pi_{2m} + \\sum_{m=0}^{\\infty} \\pi_{2m+1}\n= \\pi_{0} \\sum_{m=0}^{\\infty} r^{m} + \\pi_{0} \\frac{a}{\\mu} \\sum_{m=0}^{\\infty} r^{m}\n= \\pi_{0} \\left(1 + \\frac{a}{\\mu}\\right) \\sum_{m=0}^{\\infty} r^{m}.\n$$\nUnder the stability condition $ab < \\mu^{2}$, the geometric series sums to\n$$\n\\sum_{m=0}^{\\infty} r^{m} = \\frac{1}{1 - r}.\n$$\nTherefore,\n$$\n\\pi_{0} = \\frac{1 - r}{1 + \\frac{a}{\\mu}} = \\frac{1 - \\frac{ab}{\\mu^{2}}}{1 + \\frac{a}{\\mu}} = \\frac{\\mu^{2} - ab}{\\mu^{2} + a \\mu}.\n$$", "answer": "$$\\boxed{\\frac{\\mu^{2} - ab}{\\mu^{2} + a \\mu}}$$", "id": "1333904"}, {"introduction": "We conclude with a challenging application from the field of chemical kinetics, demonstrating the power of birth-death processes to model molecular interactions. This exercise [@problem_id:1333917] features a non-linear \"death\" rate, $\\mu_n = \\beta n(n-1)$, corresponding to a reaction that consumes pairs of molecules. Successfully analyzing this system requires not only applying the detailed balance equations but also identifying transient states and utilizing special mathematical functions to find the stationary expectation.", "problem": "Consider a simplified model for a chemical reaction in a well-mixed solution. A species of molecule, let's call it $X$, is synthesized at a constant rate $\\alpha > 0$. Simultaneously, molecules of $X$ are consumed through a reaction that requires a pair of molecules to interact. The event of a single molecule of $X$ being consumed occurs at a rate proportional to the number of available pairs of $X$ molecules.\n\nLet $N(t)$ be the number of molecules of $X$ at time $t$. We model this system as a continuous-time Markov chain on the set of non-negative integers $\\{0, 1, 2, \\dots\\}$. The birth rates, corresponding to the creation of a new molecule (transition from state $n$ to $n+1$), are given by $\\lambda_n = \\alpha$ for all $n \\ge 0$. The death rates, corresponding to the consumption of a single molecule (transition from state $n$ to $n-1$), are given by $\\mu_n = \\beta n(n-1)$ for all $n \\ge 0$, where $\\beta > 0$ is a rate constant. Note that this definition implies $\\mu_0 = 0$ and $\\mu_1 = 0$.\n\nAssume that the system reaches a stationary (or steady-state) distribution as $t \\to \\infty$. Calculate the expected number of molecules, $E[N]$, in the system at steady state. Express your answer in terms of the ratio $\\rho = \\alpha/\\beta$ and the modified Bessel functions of the first kind, $I_0(z)$ and $I_1(z)$.", "solution": "The problem describes a birth-and-death process where the state $n$ represents the number of molecules. The birth rates are $\\lambda_n = \\alpha$ for $n \\ge 0$, and the death rates are $\\mu_n = \\beta n(n-1)$ for $n \\ge 0$.\n\nFirst, we analyze the state space of the process in the stationary regime. The death rate from state $n=1$ is $\\mu_1 = \\beta(1)(1-1) = 0$. This means that if the system is in state 1, it cannot transition to state 0. A birth can occur, moving the system to state 2, from which deaths are possible ($\\mu_2 = 2\\beta > 0$). Consequently, once the process reaches any state $n \\ge 1$, it can never return to state 0. Therefore, state 0 is a transient state, and the stationary distribution will be concentrated on the set of positive integers $S = \\{1, 2, 3, \\dots\\}$. Let $\\pi_n$ be the stationary probability of having $n$ molecules, for $n \\in S$.\n\nThe stationary distribution is found by solving the detailed balance equations:\n$$ \\pi_n \\lambda_n = \\pi_{n+1} \\mu_{n+1} \\quad \\text{for } n \\ge 1 $$\nSubstituting the given rates:\n$$ \\pi_n \\alpha = \\pi_{n+1} \\beta(n+1)(n+1-1) = \\pi_{n+1} \\beta n(n+1) \\quad \\text{for } n \\ge 1 $$\nWe can express $\\pi_{n+1}$ in terms of $\\pi_n$:\n$$ \\pi_{n+1} = \\pi_n \\frac{\\alpha}{\\beta n(n+1)} $$\nWe can solve this recurrence relation to express all $\\pi_n$ in terms of $\\pi_1$.\nFor $n=2$:\n$$ \\pi_2 = \\pi_1 \\frac{\\alpha}{\\beta \\cdot 1 \\cdot 2} = \\pi_1 \\frac{\\rho}{2 \\cdot 1} $$\nwhere we have defined $\\rho = \\alpha/\\beta$.\nFor $n=3$:\n$$ \\pi_3 = \\pi_2 \\frac{\\alpha}{\\beta \\cdot 2 \\cdot 3} = \\left(\\pi_1 \\frac{\\rho}{2 \\cdot 1}\\right) \\frac{\\rho}{3 \\cdot 2} = \\pi_1 \\frac{\\rho^2}{(3 \\cdot 2 \\cdot 1)(2 \\cdot 1)} = \\pi_1 \\frac{\\rho^2}{3! 2!} $$\nBy induction, for $n \\ge 2$, the general form is:\n$$ \\pi_n = \\pi_1 \\prod_{k=1}^{n-1} \\frac{\\alpha}{\\beta k(k+1)} = \\pi_1 \\frac{\\rho^{n-1}}{\\prod_{k=1}^{n-1} k(k+1)} = \\pi_1 \\frac{\\rho^{n-1}}{(\\prod_{k=1}^{n-1} k)(\\prod_{k=1}^{n-1} (k+1))} $$\n$$ \\pi_n = \\pi_1 \\frac{\\rho^{n-1}}{(n-1)! n!} $$\nThis formula is valid for $n \\ge 2$. For $n=1$, we just have $\\pi_1$.\n\nTo find $\\pi_1$, we use the normalization condition $\\sum_{n=1}^{\\infty} \\pi_n = 1$:\n$$ 1 = \\pi_1 + \\sum_{n=2}^{\\infty} \\pi_n = \\pi_1 + \\sum_{n=2}^{\\infty} \\pi_1 \\frac{\\rho^{n-1}}{n!(n-1)!} = \\pi_1 \\left(1 + \\sum_{n=2}^{\\infty} \\frac{\\rho^{n-1}}{n!(n-1)!}\\right) $$\nLet's analyze the sum. Let $j = n-1$. The sum becomes $\\sum_{j=1}^{\\infty} \\frac{\\rho^j}{(j+1)!j!}$.\nThe modified Bessel function of the first kind of order $\\nu$ is defined as $I_\\nu(z) = \\sum_{k=0}^{\\infty} \\frac{1}{k! \\Gamma(k+\\nu+1)} (\\frac{z}{2})^{2k+\\nu}$.\nFor $\\nu=1$, we have $I_1(z) = \\sum_{k=0}^{\\infty} \\frac{1}{k! (k+1)!} (\\frac{z}{2})^{2k+1}$.\nLet $z=2\\sqrt{\\rho}$. Then $z/2 = \\sqrt{\\rho}$, and we have\n$I_1(2\\sqrt{\\rho}) = \\sum_{k=0}^{\\infty} \\frac{1}{k!(k+1)!} (\\sqrt{\\rho})^{2k+1} = \\sqrt{\\rho} \\sum_{k=0}^{\\infty} \\frac{\\rho^k}{k!(k+1)!}$.\nDividing by $\\sqrt{\\rho}$ gives:\n$$ \\frac{I_1(2\\sqrt{\\rho})}{\\sqrt{\\rho}} = \\sum_{k=0}^{\\infty} \\frac{\\rho^k}{k!(k+1)!} = \\frac{\\rho^0}{0!1!} + \\sum_{k=1}^{\\infty} \\frac{\\rho^k}{k!(k+1)!} = 1 + \\sum_{j=1}^{\\infty} \\frac{\\rho^j}{j!(j+1)!} $$\nThe sum in our normalization equation is exactly this series, so $\\sum_{n=2}^{\\infty} \\frac{\\rho^{n-1}}{n!(n-1)!} = \\frac{I_1(2\\sqrt{\\rho})}{\\sqrt{\\rho}} - 1$.\nSubstituting this back into the normalization equation:\n$$ 1 = \\pi_1 \\left(1 + \\left(\\frac{I_1(2\\sqrt{\\rho})}{\\sqrt{\\rho}} - 1\\right)\\right) = \\pi_1 \\frac{I_1(2\\sqrt{\\rho})}{\\sqrt{\\rho}} $$\nSolving for $\\pi_1$:\n$$ \\pi_1 = \\frac{\\sqrt{\\rho}}{I_1(2\\sqrt{\\rho})} $$\nNow we can calculate the expected number of molecules, $E[N]$:\n$$ E[N] = \\sum_{n=1}^{\\infty} n \\pi_n = 1 \\cdot \\pi_1 + \\sum_{n=2}^{\\infty} n \\pi_n = \\pi_1 + \\sum_{n=2}^{\\infty} n \\left(\\pi_1 \\frac{\\rho^{n-1}}{n!(n-1)!}\\right) $$\n$$ E[N] = \\pi_1 \\left(1 + \\sum_{n=2}^{\\infty} \\frac{n \\rho^{n-1}}{n!(n-1)!}\\right) = \\pi_1 \\left(1 + \\sum_{n=2}^{\\infty} \\frac{\\rho^{n-1}}{(n-1)!(n-1)!}\\right) $$\nLet's analyze this second sum. Let $j = n-1$. The sum becomes $\\sum_{j=1}^{\\infty} \\frac{\\rho^j}{(j!)^2}$.\nThe modified Bessel function of the first kind of order $\\nu=0$ is $I_0(z) = \\sum_{k=0}^{\\infty} \\frac{1}{(k!)^2} (\\frac{z}{2})^{2k}$.\nLet $z=2\\sqrt{\\rho}$. Then we have:\n$$ I_0(2\\sqrt{\\rho}) = \\sum_{k=0}^{\\infty} \\frac{\\rho^k}{(k!)^2} = \\frac{\\rho^0}{(0!)^2} + \\sum_{k=1}^{\\infty} \\frac{\\rho^k}{(k!)^2} = 1 + \\sum_{j=1}^{\\infty} \\frac{\\rho^j}{(j!)^2} $$\nSo the sum in the expression for $E[N]$ is $I_0(2\\sqrt{\\rho}) - 1$.\nSubstituting this into the expression for $E[N]$:\n$$ E[N] = \\pi_1 \\left(1 + (I_0(2\\sqrt{\\rho}) - 1)\\right) = \\pi_1 I_0(2\\sqrt{\\rho}) $$\nFinally, we substitute the expression we found for $\\pi_1$:\n$$ E[N] = \\frac{\\sqrt{\\rho}}{I_1(2\\sqrt{\\rho})} I_0(2\\sqrt{\\rho}) = \\sqrt{\\rho} \\frac{I_0(2\\sqrt{\\rho})}{I_1(2\\sqrt{\\rho})} $$\nThis is the final expression for the expected number of molecules in the steady state.", "answer": "$$\\boxed{\\sqrt{\\rho} \\frac{I_0(2\\sqrt{\\rho})}{I_1(2\\sqrt{\\rho})}}$$", "id": "1333917"}]}