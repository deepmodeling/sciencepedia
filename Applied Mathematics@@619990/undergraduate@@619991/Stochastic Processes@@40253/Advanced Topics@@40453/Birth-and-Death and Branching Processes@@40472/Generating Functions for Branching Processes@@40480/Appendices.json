{"hands_on_practices": [{"introduction": "The most fundamental question in the study of branching processes is whether a lineage will survive or die out. This practice provides a concrete entry point, using the relatable scenario of a viral meme to illustrate the core method for calculating extinction probability. You will translate a given offspring distribution into its probability generating function, $G(s)$, and solve for the key value that determines the population's ultimate fate [@problem_id:1304392].", "problem": "A simplified model for the spread of a viral meme on a social network is described by a discrete-time branching process. The process begins at generation 0 with a single user who posts the meme. Each user who has the meme in generation $n$ will independently share it with a certain number of new users, who then form generation $n+1$. The number of new users an individual shares the meme with is a random variable. Specifically, any given user will share the meme with:\n- 0 new users with probability $p_0 = 0.2$.\n- 1 new user with probability $p_1 = 0.5$.\n- 2 new users with probability $p_2 = 0.3$.\n- It is impossible for a user to share the meme with more than 2 new users.\n\nThe process is considered extinct if there is a generation with zero users. Assuming the process starts with a single initial user, calculate the long-term probability that the meme's spread eventually stops.", "solution": "Let $Z_{n}$ be the number of users in generation $n$ in a Galton–Watson branching process with offspring distribution supported on $\\{0,1,2\\}$, where a user shares with $0,1,2$ new users with probabilities $p_{0}=\\frac{1}{5}$, $p_{1}=\\frac{1}{2}$, $p_{2}=\\frac{3}{10}$, respectively. The extinction probability $q$ (starting from one initial user) is the smallest solution in $[0,1]$ of the fixed-point equation $q=f(q)$, where the offspring generating function is\n$$\nf(s)=\\sum_{k=0}^{2}p_{k}s^{k}=\\frac{1}{5}+\\frac{1}{2}s+\\frac{3}{10}s^{2}.\n$$\nFirst, check the mean number of new users:\n$$\nm=f'(1)=\\frac{1}{2}+2\\cdot\\frac{3}{10}=\\frac{1}{2}+\\frac{3}{5}=\\frac{11}{10}>1,\n$$\nso the process is supercritical and the extinction probability satisfies $q<1$. Solve $q=f(q)$:\n$$\ns=\\frac{1}{5}+\\frac{1}{2}s+\\frac{3}{10}s^{2}\n\\;\\Longleftrightarrow\\;\n\\frac{3}{10}s^{2}-\\frac{1}{2}s+\\frac{1}{5}=0\n\\;\\Longleftrightarrow\\;\n3s^{2}-5s+2=0.\n$$\nBy the quadratic formula,\n$$\ns=\\frac{5\\pm\\sqrt{25-24}}{6}=\\frac{5\\pm 1}{6}\\in\\left\\{1,\\;\\frac{2}{3}\\right\\}.\n$$\nThe extinction probability is the smaller root in $[0,1]$, hence $q=\\frac{2}{3}$.", "answer": "$$\\boxed{\\frac{2}{3}}$$", "id": "1304392"}, {"introduction": "After mastering the calculation of unconditional extinction, we can ask more subtle questions that are crucial for advanced analysis. This practice explores conditional probability: what is the chance of extinction if we know the process has survived the first generation? You will derive a general formula that links the abstract PGF, $G(s)$, to this tangible conditional outcome, highlighting the recursive structure of branching processes [@problem_id:1304391].", "problem": "Consider a Galton-Watson branching process $\\{Z_n\\}_{n \\ge 0}$, where $Z_n$ is the population size at generation $n$. The process starts with a single ancestor, so $Z_0 = 1$. Each individual in the population independently produces a random number of offspring according to a fixed probability distribution.\n\nLet the Probability Generating Function (PGF) of this offspring distribution be $G(s) = \\sum_{k=0}^{\\infty} p_k s^k$, where $p_k$ is the probability that an individual has $k$ offspring. Assume that the mean number of offspring is greater than one, i.e., $G'(1) > 1$. Let $E$ be the event of ultimate extinction, meaning the population eventually dies out.\n\nFind an expression for the conditional probability $P(E | Z_1 > 0)$. Your final answer should be an analytic expression in terms of the PGF $G(s)$ and the unconditional probability of extinction, which we will denote by $q$.", "solution": "Let $q$ denote the unconditional extinction probability starting from a single ancestor. By the branching property, conditional on $Z_{1}=k$, the process thereafter is the sum of $k$ independent copies of the original process, so the probability of ultimate extinction given $Z_{1}=k$ is\n$$\nP(E \\mid Z_{1}=k)=q^{k}.\n$$\nTherefore,\n$$\nP(E \\mid Z_{1}>0)=\\sum_{k=1}^{\\infty}P(E \\mid Z_{1}=k)\\,P(Z_{1}=k \\mid Z_{1}>0)=\\sum_{k=1}^{\\infty}q^{k}\\,\\frac{p_{k}}{1-p_{0}}=\\frac{\\sum_{k=1}^{\\infty}p_{k}q^{k}}{1-p_{0}}.\n$$\nUsing the PGF $G(s)=\\sum_{k=0}^{\\infty}p_{k}s^{k}$, we identify $\\sum_{k=1}^{\\infty}p_{k}q^{k}=G(q)-p_{0}$ and $p_{0}=G(0)$. Hence,\n$$\nP(E \\mid Z_{1}>0)=\\frac{G(q)-G(0)}{1-G(0)}.\n$$\nSince $q$ is the minimal fixed point of $G$ in $[0,1]$, we have $G(q)=q$, so an equivalent form is\n$$\nP(E \\mid Z_{1}>0)=\\frac{q-G(0)}{1-G(0)}.\n$$\nBoth expressions are analytic in terms of $G$ and $q$.", "answer": "$$\\boxed{\\frac{q - G(0)}{1 - G(0)}}$$", "id": "1304391"}, {"introduction": "Beyond the question of survival, we are often interested in the cumulative size of a population over its entire lifetime. This exercise introduces the random variable known as the 'total progeny' and its corresponding probability generating function, $H(s)$. You will apply a fundamental functional equation, $H(s) = sG(H(s))$, that connects the offspring PGF to the total progeny PGF, thereby learning a powerful technique to characterize the distribution of the total population size that ever exists [@problem_id:1304403].", "problem": "A Galton-Watson branching process is a stochastic model for population growth that evolves in discrete generations. The process begins at generation $n=0$ with a single ancestor. This ancestor produces a random number of offspring, which constitute generation $n=1$. Each individual in generation $n$ then independently gives rise to a random number of offspring, according to the same probability distribution, forming generation $n+1$.\n\nConsider a specific branching process where the number of offspring, $X$, for any given individual is a random variable an with integer values $k \\geq 0$. The probability mass function for $X$ is given by\n$$\nP(X=k) = \\left(\\frac{1}{2}\\right)^{k+1}, \\quad \\text{for } k = 0, 1, 2, \\ldots\n$$\nThe Probability Generating Function (PGF) of a discrete random variable $X$ is defined as $G(s) = E[s^X]$.\n\nLet $Y$ be the random variable representing the total progeny of the process, defined as the total number of individuals that ever exist, including the initial ancestor. Find the closed-form expression for $H(s) = E[s^Y]$, the probability generating function for the total progeny $Y$.", "solution": "We begin by computing the offspring probability generating function. For the given offspring distribution,\n$$\nG(s) \\equiv \\mathbb{E}[s^{X}] = \\sum_{k=0}^{\\infty} s^{k} \\left(\\frac{1}{2}\\right)^{k+1} = \\frac{1}{2} \\sum_{k=0}^{\\infty} \\left(\\frac{s}{2}\\right)^{k}.\n$$\nUsing the geometric series identity $\\sum_{k=0}^{\\infty} r^{k} = \\frac{1}{1-r}$ for $|r|<1$, we obtain\n$$\nG(s) = \\frac{1}{2} \\cdot \\frac{1}{1 - \\frac{s}{2}} = \\frac{1}{2 - s}.\n$$\n\nLet $Y$ denote the total progeny (including the ancestor). In a Galton–Watson process starting from a single ancestor, $Y$ satisfies the decomposition\n$$\nY = 1 + \\sum_{i=1}^{X} Y_{i},\n$$\nwhere, conditional on $X$, the $Y_{i}$ are independent copies of $Y$, independent of $X$. Taking probability generating functions and using independence,\n$$\nH(s) \\equiv \\mathbb{E}[s^{Y}] = \\mathbb{E}\\!\\left[s^{1 + \\sum_{i=1}^{X} Y_{i}}\\right] = s\\, \\mathbb{E}\\!\\left[\\prod_{i=1}^{X} s^{Y_{i}}\\right] = s\\, \\mathbb{E}\\!\\left[\\mathbb{E}\\!\\left[\\prod_{i=1}^{X} s^{Y_{i}} \\,\\bigg|\\, X\\right]\\right].\n$$\nGiven $X=k$, we have $\\prod_{i=1}^{k} s^{Y_{i}} = \\left(\\mathbb{E}[s^{Y}]\\right)^{k} = \\left(H(s)\\right)^{k}$. Therefore,\n$$\nH(s) = s\\, \\mathbb{E}\\!\\left[(H(s))^{X}\\right] = s\\, G\\!\\left(H(s)\\right).\n$$\nSubstituting $G(u) = \\frac{1}{2 - u}$ with $u = H(s)$ yields the functional equation\n$$\nH(s) = \\frac{s}{2 - H(s)}.\n$$\nRearranging gives a quadratic equation for $H(s)$:\n$$\nH(s)\\left(2 - H(s)\\right) = s \\quad \\Longleftrightarrow \\quad H(s)^{2} - 2 H(s) + s = 0.\n$$\nSolving this quadratic,\n$$\nH(s) = 1 \\pm \\sqrt{1 - s}.\n$$\nTo select the correct branch, we use the PGF boundary condition $H(0) = \\mathbb{E}[0^{Y}] = 0$ since $Y \\geq 1$. Evaluating at $s=0$ gives $H(0) = 1 \\pm 1$, so the valid choice is\n$$\nH(s) = 1 - \\sqrt{1 - s}.\n$$\nThis also satisfies $H(1) = 1$, as required for a PGF.", "answer": "$$\\boxed{1 - \\sqrt{1 - s}}$$", "id": "1304403"}]}