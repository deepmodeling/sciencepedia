{"hands_on_practices": [{"introduction": "This exercise provides a classic scenario of a multi-server queue with Poisson arrivals. It is a perfect opportunity to see the PASTA (Poisson Arrivals See Time Averages) property in action, simplifying the question of what an arriving customer observes into a more straightforward calculation of the system's long-run average state. Understanding this direct application is the foundational step to mastering the concept [@problem_id:1323294].", "problem": "A small-scale cloud service hosts an application on a cluster containing two identical, parallel servers. User requests are directed to this cluster, and the arrival of these requests can be modeled as a Poisson process with an average rate of $\\lambda = 120$ requests per hour. An incoming request is immediately assigned to an idle server if one is available. If both servers are busy, the request joins a single queue and waits for the next available server. The service time for a single request on any server is exponentially distributed with a mean service time of $1/\\mu$, where $\\mu = 75$ requests per hour. The system has been operating long enough to reach a steady state.\n\nWhat is the probability that an incoming request finds both servers idle? Express your answer as a decimal rounded to three significant figures.", "solution": "Model the system as an $M/M/2$ queue with arrival rate $\\lambda$ and service rate per server $\\mu$. By PASTA (Poisson Arrivals See Time Averages), the probability that an arriving request finds both servers idle equals the steady-state probability that there are zero requests in the system, denoted $p_{0}$.\n\nFor an $M/M/c$ system with $c=2$, define the offered load $a=\\lambda/\\mu$ and the utilization per server $\\rho=\\lambda/(c\\mu)=a/c$. The steady-state empty-system probability is\n$$\np_{0}=\\left[\\sum_{n=0}^{c-1}\\frac{a^{n}}{n!}+\\frac{a^{c}}{c!\\,(1-\\rho)}\\right]^{-1}.\n$$\nWith $c=2$, this becomes\n$$\np_{0}=\\left[1+a+\\frac{a^{2}}{2\\,(1-\\rho)}\\right]^{-1}.\n$$\nInsert $\\lambda=120$ and $\\mu=75$, so $a=\\lambda/\\mu=120/75=1.6$ and $\\rho=a/2=0.8$. Then $1-\\rho=0.2$, and\n$$\np_{0}=\\left[1+1.6+\\frac{(1.6)^{2}}{2\\cdot 0.2}\\right]^{-1}\n=\\left[1+1.6+\\frac{2.56}{0.4}\\right]^{-1}\n=\\left[1+1.6+6.4\\right]^{-1}\n=\\frac{1}{9}.\n$$\nAs a decimal rounded to three significant figures, this is $0.111$.", "answer": "$$\\boxed{0.111}$$", "id": "1323294"}, {"introduction": "The PASTA property is powerful, but it is not universal. This problem explores a 'machine repairman' model, a classic finite-source queue where the arrival rate depends on the system's state, meaning the overall arrival process is not Poisson. By calculating and comparing the time-average system state ($L$) with the state seen by an arrival ($L_a$), you will gain a deeper appreciation for the strict conditions under which PASTA holds and quantify the difference when those conditions are violated [@problem_id:1323275].", "problem": "A robotics company operates a fleet of $N=4$ identical, autonomous delivery rovers for a logistics warehouse. The rovers operate independently. When a rover is operational, the time until it breaks down is exponentially distributed with a rate of $\\lambda = 0.1$ breakdowns per day. The company employs a single, highly-skilled technician who can repair any broken rover. The time it takes the technician to complete a repair is also exponentially distributed, with a rate of $\\mu = 0.5$ repairs per day. If the technician is busy when a rover breaks down, the rover joins a queue and waits for its turn to be repaired.\n\nWe are interested in two key performance metrics for this system.\n1.  Let $L$ be the long-run time-average number of rovers that are non-operational (this includes rovers actively being repaired and those waiting in the queue for repair).\n2.  Let $L_a$ be the long-run average number of *other* rovers that are already non-operational, as observed by a rover at the precise instant that it breaks down.\n\nCalculate the difference, $\\Delta L = L - L_a$. Round your final answer to three significant figures.", "solution": "This system can be modeled as a continuous-time Markov chain, specifically a birth-death process, where the state of the system, $k$, is the number of non-operational rovers. The state space is $\\{0, 1, 2, 3, 4\\}$.\n\nThe birth rate (rate of rovers breaking down) depends on the number of operational rovers. If there are $k$ non-operational rovers, then there are $N-k$ operational rovers, each of which can break down with rate $\\lambda$. Thus, the total birth rate from state $k$ to $k+1$ is $\\lambda_k = (N-k)\\lambda$ for $k \\in \\{0, 1, 2, 3\\}$. The birth rate from state $4$ is $\\lambda_4 = 0$, as there are no operational rovers left to break down.\n\nThe death rate (rate of repairs) is constant as long as there is at least one rover to be repaired, since there is only one technician. The death rate from state $k$ to $k-1$ is $\\mu_k = \\mu$ for $k \\in \\{1, 2, 3, 4\\}$. The death rate from state $0$ is $\\mu_0 = 0$.\n\nLet $\\pi_k$ be the steady-state probability that the system is in state $k$. For a birth-death process, the steady-state probabilities satisfy the detailed balance equations, which lead to the following relationship:\n$$ \\pi_k = \\pi_0 \\prod_{i=0}^{k-1} \\frac{\\lambda_i}{\\mu_{i+1}} $$\nSubstituting the rates for this model:\n$$ \\pi_k = \\pi_0 \\prod_{i=0}^{k-1} \\frac{(N-i)\\lambda}{\\mu} = \\pi_0 \\left(\\frac{\\lambda}{\\mu}\\right)^k \\prod_{i=0}^{k-1} (N-i) = \\pi_0 \\frac{N!}{(N-k)!} \\left(\\frac{\\lambda}{\\mu}\\right)^k $$\nLet $\\rho = \\lambda/\\mu = 0.1/0.5 = 0.2$. With $N=4$, we can express each $\\pi_k$ in terms of $\\pi_0$. Let's define $c_k = \\frac{N!}{(N-k)!} \\rho^k$, so that $\\pi_k = \\pi_0 c_k$.\n$c_0 = \\frac{4!}{4!} (0.2)^0 = 1$\n$c_1 = \\frac{4!}{3!} (0.2)^1 = 4 \\times 0.2 = 0.8$\n$c_2 = \\frac{4!}{2!} (0.2)^2 = 12 \\times 0.04 = 0.48$\n$c_3 = \\frac{4!}{1!} (0.2)^3 = 24 \\times 0.008 = 0.192$\n$c_4 = \\frac{4!}{0!} (0.2)^4 = 24 \\times 0.0016 = 0.0384$\n\nThe sum of these coefficients is $S = \\sum_{k=0}^{4} c_k = 1 + 0.8 + 0.48 + 0.192 + 0.0384 = 2.5104$.\nFrom the normalization condition $\\sum_{k=0}^{4} \\pi_k = 1$, we have $\\pi_0 S = 1$, so $\\pi_0 = 1/S = 1/2.5104$. The steady-state probabilities are $\\pi_k = c_k / S$.\n$\\pi_0 = 1 / 2.5104 \\approx 0.398343$\n$\\pi_1 = 0.8 / 2.5104 \\approx 0.318674$\n$\\pi_2 = 0.48 / 2.5104 \\approx 0.191205$\n$\\pi_3 = 0.192 / 2.5104 \\approx 0.076482$\n$\\pi_4 = 0.0384 / 2.5104 \\approx 0.015296$\n\nThe time-average number of non-operational rovers, $L$, is the expected value of the number of rovers in the system in steady state:\n$$ L = E[K] = \\sum_{k=0}^{N} k \\pi_k = \\frac{1}{S} \\sum_{k=0}^{4} k c_k $$\n$$ L = \\frac{1}{2.5104} [ (0)(1) + (1)(0.8) + (2)(0.48) + (3)(0.192) + (4)(0.0384) ] $$\n$$ L = \\frac{1}{2.5104} [ 0.8 + 0.96 + 0.576 + 0.1536 ] = \\frac{2.4896}{2.5104} \\approx 0.991714 $$\n\nNext, we calculate $L_a$. The arrival process of broken rovers is not Poisson, as the rate of breakdowns $\\lambda_k = (N-k)\\lambda$ depends on the current state $k$. Therefore, the probability that an arriving rover finds the system in state $k$, denoted by $a_k$, is not equal to $\\pi_k$. The property that arrival-time probabilities are equal to time-average probabilities, known as PASTA (Poisson Arrivals See Time Averages), does not apply here.\nThe arrival-time probabilities $a_k$ are given by the ratio of the rate of arrivals to state $k$ to the total average arrival rate $\\bar{\\lambda}$:\n$$ a_k = \\frac{\\text{flow rate into state } k+1 \\text{ from } k}{\\text{total flow rate of arrivals}} = \\frac{\\pi_k \\lambda_k}{\\bar{\\lambda}} $$\nThe total average arrival rate is $\\bar{\\lambda} = \\sum_{j=0}^{N-1} \\pi_j \\lambda_j = \\sum_{j=0}^{3} \\pi_j (N-j)\\lambda$.\n$$ \\bar{\\lambda} = \\frac{\\lambda}{S} \\sum_{j=0}^{3} c_j (N-j) = \\frac{0.1}{2.5104} [ (1)(4) + (0.8)(3) + (0.48)(2) + (0.192)(1) ] $$\n$$ \\bar{\\lambda} = \\frac{0.1}{2.5104} [ 4 + 2.4 + 0.96 + 0.192 ] = \\frac{0.1 \\times 7.552}{2.5104} = \\frac{0.7552}{2.5104} \\approx 0.300829 $$\nNow we can find $a_k$ for $k=0,1,2,3$. Note that an arrival can only occur if $k<4$.\n$a_0 = \\frac{\\pi_0 \\lambda_0}{\\bar{\\lambda}} = \\frac{(1/S)(4\\lambda)}{\\bar{\\lambda}} = \\frac{4\\lambda/S}{7.552\\lambda/S} = \\frac{4}{7.552} \\approx 0.529661$\n$a_1 = \\frac{\\pi_1 \\lambda_1}{\\bar{\\lambda}} = \\frac{(0.8/S)(3\\lambda)}{\\bar{\\lambda}} = \\frac{2.4\\lambda/S}{7.552\\lambda/S} = \\frac{2.4}{7.552} \\approx 0.317797$\n$a_2 = \\frac{\\pi_2 \\lambda_2}{\\bar{\\lambda}} = \\frac{(0.48/S)(2\\lambda)}{\\bar{\\lambda}} = \\frac{0.96\\lambda/S}{7.552\\lambda/S} = \\frac{0.96}{7.552} \\approx 0.127119$\n$a_3 = \\frac{\\pi_3 \\lambda_3}{\\bar{\\lambda}} = \\frac{(0.192/S)(1\\lambda)}{\\bar{\\lambda}} = \\frac{0.192\\lambda/S}{7.552\\lambda/S} = \\frac{0.192}{7.552} \\approx 0.025424$\n\nThe quantity $L_a$ is the average number of *other* rovers that are non-operational when a rover breaks down. If an arriving rover finds the system in state $k$, it sees $k$ other rovers already non-operational.\n$$ L_a = \\sum_{k=0}^{N-1} k \\cdot a_k = (0)a_0 + (1)a_1 + (2)a_2 + (3)a_3 $$\n$$ L_a = 0 + \\frac{2.4}{7.552} + 2\\left(\\frac{0.96}{7.552}\\right) + 3\\left(\\frac{0.192}{7.552}\\right) = \\frac{2.4 + 1.92 + 0.576}{7.552} $$\n$$ L_a = \\frac{4.896}{7.552} \\approx 0.648239 $$\n\nFinally, we calculate the difference $\\Delta L = L - L_a$:\n$$ \\Delta L = 0.991714 - 0.648239 = 0.343475 $$\nRounding to three significant figures, we get $0.343$.", "answer": "$$\\boxed{0.343}$$", "id": "1323275"}, {"introduction": "This advanced exercise introduces batch arrivals, adding a fascinating layer of complexity to our analysis. While batches may arrive according to a Poisson process, the experience of an arbitrary individual *within* a batch is different. This problem [@problem_id:1323268] challenges you to parse the arrival process, apply PASTA to the batch arrivals, and then use further reasoning to find the perspective of an individual customer, revealing a subtle but important phenomenon related to the inspection paradox.", "problem": "Consider a single-server queueing system, denoted as an $M^{[X]}/G/1$ queue. Batches of customers arrive according to a Poisson process with rate $\\lambda$. The number of customers in an arriving batch, $X$, is a positive integer-valued random variable, i.e., $P(X \\ge 1) = 1$. Let the first and second moments of the batch size be $m_1 = E[X]$ and $m_2 = E[X^2]$, respectively. The service times for individual customers are independent and identically distributed according to a general distribution with a finite mean, and are independent of the arrival process and batch sizes. The traffic intensity is assumed to be less than 1, ensuring the system is stable. Upon arrival, customers from the same batch are assigned a service order randomly, with each permutation of the customers in the batch being equally likely.\n\nWe are interested in comparing the system state from two different perspectives:\n\n1.  The perspective of an arriving *batch*. Let $A$ be the long-run average number of customers already present in the system (queued or in service) at the instant a new batch arrives.\n2.  The perspective of an arbitrary individual *customer*. Let $B$ be the long-run average number of customers that this customer finds ahead of them. This count includes both the customers who were already in the system when their batch arrived, and any other customers from their own batch who are scheduled to be served first.\n\nDetermine the value of the difference $B-A$. Express your answer as a closed-form expression in terms of $m_1$ and $m_2$.", "solution": "Let $N^{-}$ denote the number of customers in the system immediately before a batch arrival. By definition, the batch-average seen-at-arrival quantity is $A=E[N^{-}]$ under the Palm measure of batch arrivals.\n\nConsider an arbitrary customer sampled uniformly from the long-run flow of customers. Let $X$ be the size of that customerâ€™s batch. The number of customers this customer finds ahead is the sum of two independent components:\n(i) the pre-existing customers $N^{-}$ already in the system at the instant their batch arrived, and\n(ii) the number of their own batch-mates scheduled before them due to the random permutation within the batch.\n\nBecause batch sizes are i.i.d. and independent of the arrival epochs and the service process, the mark $X$ of the arriving batch is independent of $N^{-}$. Under customer sampling, the arrival epochs are weighted by batch size. Hence the expectation of the pre-existing component under the customer perspective is\n$$\nE[N^{-}]_{\\text{customer}}=\\frac{E[X N^{-}]}{E[X]}=\\frac{E[X]\\,E[N^{-}]}{E[X]}=E[N^{-}]=A.\n$$\n\nFor the within-batch contribution, condition on the batch size $k$. Under a uniformly random permutation of $k$ customers, the position of the tagged customer is uniform on $\\{1,\\dots,k\\}$, so the expected number of batch-mates ahead equals\n$$\nE[\\text{batch-mates ahead}\\mid X=k]=\\frac{k-1}{2}.\n$$\nUnder the customer perspective, the batch size is size-biased: $P(X^{\\star}=k)=\\frac{k P(X=k)}{m_{1}}$, so $E[X^{\\star}]=\\frac{m_{2}}{m_{1}}$. Therefore the expected within-batch contribution is\n$$\nE\\left[\\frac{X^{\\star}-1}{2}\\right]=\\frac{E[X^{\\star}]-1}{2}=\\frac{\\frac{m_{2}}{m_{1}}-1}{2}.\n$$\n\nCombining the two components, the customer-average number ahead is\n$$\nB=A+\\frac{\\frac{m_{2}}{m_{1}}-1}{2}.\n$$\nThus,\n$$\nB-A=\\frac{\\frac{m_{2}}{m_{1}}-1}{2}.\n$$", "answer": "$$\\boxed{\\frac{1}{2}\\left(\\frac{m_{2}}{m_{1}}-1\\right)}$$", "id": "1323268"}]}