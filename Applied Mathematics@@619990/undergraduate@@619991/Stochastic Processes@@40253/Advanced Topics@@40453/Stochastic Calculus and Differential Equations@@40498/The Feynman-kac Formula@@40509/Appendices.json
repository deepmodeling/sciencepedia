{"hands_on_practices": [{"introduction": "This exercise explores one of the most elegant applications of the Feynman-Kac framework: calculating hitting probabilities. We will determine the likelihood that a particle undergoing Brownian motion reaches one boundary before another, a classic problem with applications from statistical physics to finance. The key insight you'll practice is translating this probabilistic question into a boundary value problem for Laplace's equation, which can then be solved using standard calculus techniques [@problem_id:1338001].", "id": "1338001", "problem": "A single gold adatom diffuses on a perfectly flat silver surface. Using advanced manipulation techniques, two concentric circular barriers are constructed, creating an annular region where the adatom is temporarily confined. The inner barrier has a radius $R_1$ and the outer barrier has a radius $R_2$, with $R_1 < R_2$. The adatom's motion on the surface is well-described by a standard two-dimensional Brownian motion.\n\nThe barriers are not perfect; they can be crossed. The process stops as soon as the adatom's path intersects either the inner or the outer circular barrier. Suppose the adatom is initially placed at a location with a radial distance $r_0$ from the center of the circles, such that $R_1 < r_0 < R_2$. Due to the symmetry of the problem, the probability of interest will not depend on the specific angular position, only on the initial radial distance $r_0$.\n\nDetermine the probability, let's call it $P(r_0)$, that the adatom will cross the outer barrier at radius $R_2$ before it crosses the inner barrier at radius $R_1$. Your final answer should be a closed-form analytic expression in terms of $r_0$, $R_1$, and $R_2$.\n\n", "solution": "Let $X_{t}$ be a standard two-dimensional Brownian motion on the plane, started at a point with radial coordinate $r_{0}$ such that $R_{1}<r_{0}<R_{2}$. Define the annulus $A=\\{x\\in\\mathbb{R}^{2}:R_{1}<|x|<R_{2}\\}$. Let $P(x)$ denote the probability that, starting from $x\\in A$, the process hits the outer circle $\\{|x|=R_{2}\\}$ before the inner circle $\\{|x|=R_{1}\\}$. By rotational symmetry, $P(x)$ depends only on the radius $r=|x|$, so we write $P(r)$.\n\nFor Brownian motion, the hitting probability of a portion of the boundary solves the Dirichlet problem for the Laplace operator. Thus $P(r)$ is harmonic in the annulus and satisfies the boundary conditions corresponding to absorbing barriers:\n$$\n\\Delta P=0\\quad\\text{in }A,\\qquad P(R_{1})=0,\\qquad P(R_{2})=1.\n$$\nIn polar coordinates, for a radially symmetric function $P(r)$, the Laplacian reduces to\n$$\n\\Delta P=P_{rr}+\\frac{1}{r}P_{r}.\n$$\nTherefore $P(r)$ solves the ordinary differential equation\n$$\nP''(r)+\\frac{1}{r}P'(r)=0,\\quad R_{1}<r<R_{2},\n$$\nwith boundary conditions\n$$\nP(R_{1})=0,\\qquad P(R_{2})=1.\n$$\nTo solve the ODE, set $v(r)=P'(r)$, giving\n$$\nv'(r)+\\frac{1}{r}v(r)=0.\n$$\nThis is a first-order linear equation. Multiplying by $r$ yields\n$$\n\\frac{d}{dr}\\big(r\\,v(r)\\big)=0\\quad\\Rightarrow\\quad r\\,v(r)=C_{1}\\quad\\Rightarrow\\quad P'(r)=\\frac{C_{1}}{r}.\n$$\nIntegrating,\n$$\nP(r)=C_{1}\\ln r+C_{2}.\n$$\nImposing the boundary conditions:\n$$\nP(R_{1})=C_{1}\\ln R_{1}+C_{2}=0,\\qquad P(R_{2})=C_{1}\\ln R_{2}+C_{2}=1.\n$$\nSubtracting the first from the second,\n$$\nC_{1}\\big(\\ln R_{2}-\\ln R_{1}\\big)=1\\quad\\Rightarrow\\quad C_{1}=\\frac{1}{\\ln\\!\\big(\\frac{R_{2}}{R_{1}}\\big)}.\n$$\nThen\n$$\nC_{2}=-C_{1}\\ln R_{1}=-\\frac{\\ln R_{1}}{\\ln\\!\\big(\\frac{R_{2}}{R_{1}}\\big)}.\n$$\nHence, for any $R_{1}<r<R_{2}$,\n$$\nP(r)=\\frac{\\ln r-\\ln R_{1}}{\\ln R_{2}-\\ln R_{1}}=\\frac{\\ln\\!\\big(\\frac{r}{R_{1}}\\big)}{\\ln\\!\\big(\\frac{R_{2}}{R_{1}}\\big)}.\n$$\nEvaluated at the initial radius $r_{0}$, the desired probability is\n$$\nP(r_{0})=\\frac{\\ln\\!\\big(\\frac{r_{0}}{R_{1}}\\big)}{\\ln\\!\\big(\\frac{R_{2}}{R_{1}}\\big)}.\n$$", "answer": "$$\\boxed{\\frac{\\ln\\!\\left(\\frac{r_{0}}{R_{1}}\\right)}{\\ln\\!\\left(\\frac{R_{2}}{R_{1}}\\right)}}$$"}, {"introduction": "Having explored the probability of hitting a boundary, we now turn to the question of time. This problem asks for the expected time it will take for a process to reach a certain target level, a quantity known as the expected first-passage time. You will use a variant of the Feynman-Kac formula to show that this expected time satisfies a Poisson equation and see how different boundary conditions, such as reflection, are incorporated into the PDE framework [@problem_id:1338002].", "id": "1338002", "problem": "A simplified model for the state of a financial asset is given by a one-dimensional reflected Brownian motion, $X_t$, which starts at an initial positive value $X_0 = x$. The process $X_t$ evolves as a standard Brownian motion, but it is instantaneously reflected whenever it attempts to cross the origin, ensuring its value remains non-negative.\n\nA company holds this asset and incurs a constant operational cost at a rate of $c$ per unit time for as long as it holds the asset. The company has a pre-determined strategy to liquidate the asset as soon as its value reaches a target level $a$. The initial value $x$ is strictly between 0 and $a$, that is, $0 < x < a$.\n\nAssuming the parameters $x$, $a$, and $c$ are all positive real constants, find a closed-form analytic expression for the total expected operational cost the company will incur until the asset is liquidated.\n\n", "solution": "Let $T_{a}=\\inf\\{t\\geq 0: X_{t}=a\\}$ be the liquidation time. The total operational cost accumulated until liquidation is $\\int_{0}^{T_{a}} c\\,dt$, so by linearity of expectation the expected total cost is $c\\,\\mathbb{E}_{x}[T_{a}]$. Thus it suffices to compute $u(x)=\\mathbb{E}_{x}[T_{a}]$ for reflected Brownian motion on $[0,\\infty)$ starting at $x\\in(0,a)$, with reflection at $0$ and absorption at $a$.\n\nThe generator of a standard reflected Brownian motion on $[0,\\infty)$ is $L=\\frac{1}{2}\\frac{d^{2}}{dx^{2}}$ on $(0,a)$, with Neumann boundary condition at $0$ (reflection) and Dirichlet boundary condition at $a$ (absorption). By Dynkin’s formula, $u$ solves the Poisson problem\n$$\n\\frac{1}{2}u''(x)=-1,\\quad x\\in(0,a),\n$$\nwith boundary conditions\n$$\nu'(0)=0,\\qquad u(a)=0.\n$$\nSolving, we integrate $u''(x)=-2$ to get $u'(x)=-2x+C_{1}$. The Neumann condition $u'(0)=0$ implies $C_{1}=0$, hence $u'(x)=-2x$. Integrating again yields $u(x)=-x^{2}+C_{2}$. The Dirichlet condition $u(a)=0$ gives $C_{2}=a^{2}$, hence\n$$\nu(x)=a^{2}-x^{2}.\n$$\nTherefore, the expected total operational cost is\n$$\nc\\,u(x)=c\\left(a^{2}-x^{2}\\right).\n$$", "answer": "$$\\boxed{c\\left(a^{2}-x^{2}\\right)}$$"}, {"introduction": "The previous practices demonstrated how to solve a problem once the governing Partial Differential Equation (PDE) is known. This final exercise takes you to the heart of the matter: deriving the PDE from the underlying stochastic dynamics. You will work with a multi-dimensional process and use the principles of Itô calculus to find the backward Kolmogorov equation, which is the general PDE provided by the Feynman-Kac theorem for this system [@problem_id:1337980]. This skill is fundamental for applying the formula to novel problems in science and engineering.", "id": "1337980", "problem": "In a model of an integrated stochastic signal, the state of a system is described by a two-dimensional process $(X_t, Y_t)$. The quantity $X_t$ represents a signal whose value undergoes a random walk, and $Y_t$ represents the time-integrated value of this signal. The dynamics are governed by the following system of coupled Stochastic Differential Equations (SDEs) for $t \\ge 0$:\n$$ dX_t = \\sigma dW_t $$\n$$ dY_t = X_t dt $$\nHere, $W_t$ is a standard one-dimensional Wiener process, and $\\sigma$ is a positive constant representing the volatility of the signal.\n\nLet $u(t, x, y)$ be the expected value of a cost function $g(X_T, Y_T)$ evaluated at a future terminal time $T > t$, given the state of the system at time $t$ is $(X_t, Y_t) = (x, y)$. That is,\n$$ u(t, x, y) = \\mathbb{E}\\left[g(X_T, Y_T) | X_t = x, Y_t = y\\right] $$\nwhere $g$ is a sufficiently smooth function.\n\nThe function $u(t, x, y)$ satisfies a backward parabolic Partial Differential Equation (PDE) for $t < T$ of the general form:\n$$ A \\frac{\\partial u}{\\partial t} + B \\frac{\\partial u}{\\partial x} + C \\frac{\\partial u}{\\partial y} + D \\frac{\\partial^2 u}{\\partial x^2} + E \\frac{\\partial^2 u}{\\partial y^2} + F \\frac{\\partial^2 u}{\\partial x \\partial y} = 0 $$\nThe coefficients $A, B, C, D, E, F$ can be constants or functions of the state variables $x$ and $y$.\n\nDetermine the six coefficients in the PDE. Present your answer as a single row matrix of the coefficients in the order $(A, B, C, D, E, F)$.\n\n", "solution": "We model the two-dimensional Markov process $(X_{t}, Y_{t})$ by the SDEs $dX_{t}=\\sigma dW_{t}$ and $dY_{t}=X_{t} dt$. Let $u(t,x,y)=\\mathbb{E}\\left[g(X_{T},Y_{T}) \\mid X_{t}=x, Y_{t}=y\\right]$ for a smooth terminal function $g$. By the backward Kolmogorov equation, $u$ satisfies $\\partial_{t}u + \\mathcal{L}u=0$ for $t<T$, where $\\mathcal{L}$ is the infinitesimal generator of $(X_{t},Y_{t})$ acting on smooth test functions $f$.\n\nTo compute $\\mathcal{L}$, note the drift and diffusion structure:\n- For $X_{t}$: drift $0$ and diffusion coefficient $\\sigma$, so $(dX_{t})^{2}=\\sigma^{2} dt$.\n- For $Y_{t}$: drift $X_{t}$ and no diffusion term, so $(dY_{t})^{2}=0$ and $dX_{t}\\,dY_{t}=0$ in It\\^o calculus because $dY_{t}$ is of order $dt$.\n\nApplying It\\^o's formula to $u(t,X_{t},Y_{t})$ gives\n$$\ndu = u_{t}\\,dt + u_{x}\\,dX_{t} + u_{y}\\,dY_{t} + \\frac{1}{2}u_{xx}\\,(dX_{t})^{2} + \\frac{1}{2}u_{yy}\\,(dY_{t})^{2} + u_{xy}\\,dX_{t}\\,dY_{t}.\n$$\nSubstituting $dX_{t}=\\sigma dW_{t}$ and $dY_{t}=X_{t} dt$ yields\n$$\ndu = \\left(u_{t} + X_{t} u_{y} + \\frac{1}{2}\\sigma^{2} u_{xx}\\right) dt + \\sigma u_{x}\\,dW_{t},\n$$\nsince $(dY_{t})^{2}=0$ and $dX_{t}\\,dY_{t}=0$. Because $u(t,X_{t},Y_{t})$ is a martingale under the conditional expectation representation, the drift term must vanish, which gives the backward PDE\n$$\nu_{t} + x\\,u_{y} + \\frac{1}{2}\\sigma^{2} u_{xx} = 0,\n$$\nwith terminal condition $u(T,x,y)=g(x,y)$. Matching this with the given general form\n$$\nA\\,u_{t} + B\\,u_{x} + C\\,u_{y} + D\\,u_{xx} + E\\,u_{yy} + F\\,u_{xy} = 0,\n$$\nwe identify the coefficients as\n$$\nA=1,\\quad B=0,\\quad C=x,\\quad D=\\frac{1}{2}\\sigma^{2},\\quad E=0,\\quad F=0.\n$$", "answer": "$$\\boxed{\\begin{pmatrix}1 & 0 & x & \\frac{1}{2}\\sigma^{2} & 0 & 0\\end{pmatrix}}$$"}]}