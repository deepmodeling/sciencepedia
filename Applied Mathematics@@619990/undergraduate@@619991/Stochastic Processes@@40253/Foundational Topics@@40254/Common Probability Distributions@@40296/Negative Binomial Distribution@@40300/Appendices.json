{"hands_on_practices": [{"introduction": "We begin our hands-on practice by exploring the fundamental relationship between the parameters of a negative binomial distribution. This first exercise [@problem_id:12870] focuses on the expected value, or the average number of trials needed to achieve a set number of successes. By working backward from a known expectation, you will develop a foundational skill in determining the underlying success probability $p$ of the process.", "problem": "Consider a sequence of independent Bernoulli trials where the outcome of each trial can be classified as either a \"success\" or a \"failure\". Let the probability of success on any given trial be $p$, where $0 < p \\leq 1$.\n\nA random variable $X$ is said to follow a negative binomial distribution if it represents the total number of trials required to achieve a fixed number of successes, denoted by $r$. The expected value (or mean) of this random variable $X$, which signifies the average number of trials one would expect to perform to see exactly $r$ successes, is given by the formula:\n$$\nE[X] = \\frac{r}{p}\n$$\nSuppose an experiment is designed to run until $r=3$ successes are observed. Through theoretical analysis or prior observation, it is determined that the expected number of trials to complete this experiment is $15$.\n\nUsing the given formula for the expected value, derive the success probability $p$ of a single trial.", "solution": "The objective is to determine the probability of success, $p$, given the expected number of trials and the required number of successes.\n\n**1. Identify the given information:**\nThe problem provides the following values:\n- The required number of successes, $r = 3$.\n- The expected number of trials to achieve these successes, $E[X] = 15$.\n\n**2. State the relevant formula:**\nThe relationship between the expected number of trials $E[X]$, the number of successes $r$, and the probability of success $p$ is given by the formula for the mean of the negative binomial distribution:\n$$\nE[X] = \\frac{r}{p}\n$$\n\n**3. Substitute the known values into the formula:**\nWe substitute $E[X] = 15$ and $r = 3$ into the equation:\n$$\n15 = \\frac{3}{p}\n$$\n\n**4. Solve for the unknown variable $p$:**\nTo isolate $p$, we can first multiply both sides of the equation by $p$:\n$$\n15 \\cdot p = 3\n$$\nNext, we divide both sides by $15$ to solve for $p$:\n$$\np = \\frac{3}{15}\n$$\n\n**5. Simplify the expression:**\nThe fraction can be simplified by dividing both the numerator and the denominator by their greatest common divisor, which is 3:\n$$\np = \\frac{3 \\div 3}{15 \\div 3} = \\frac{1}{5}\n$$\nThus, the probability of success for a single trial is $\\frac{1}{5}$.", "answer": "$$\\boxed{\\frac{1}{5}}$$", "id": "12870"}, {"introduction": "Building on the concept of expected value, this practice [@problem_id:1939495] introduces variance to provide a more complete picture of the distribution. In many real-world scenarios, we use sample statistics to infer the parameters of the process we are modeling. This problem challenges you to use both the mean and variance to solve for the two key parameters of the negative binomial distribution, $r$ and $p$, honing your skills in parameter estimation.", "problem": "A team of data scientists is modeling user engagement on a new social media platform. They are interested in the number of posts a user makes until they achieve a certain number of \"successful\" posts, defined as posts that receive a high level of community interaction.\n\nThe team models this process using a negative binomial distribution. Let the random variable $X$ represent the number of \"unsuccessful\" posts a user creates before achieving a target of $r$ successful posts. The probability of any given post being successful is $p$, and each post is an independent trial.\n\nFrom a large dataset of user histories, the team has calculated the sample mean and variance for the number of unsuccessful posts. The estimated mean is $E[X] = 10$ and the estimated variance is $Var(X) = 20$.\n\nBased on these empirical estimates, determine the parameters of the negative binomial distribution that models this process: the target number of successful posts, $r$, and the probability of success for a single post, $p$. Your answer should be the ordered pair $(r, p)$.", "solution": "Let $X$ denote the number of failures before achieving $r$ successes in independent Bernoulli trials with success probability $p$. In this parameterization of the negative binomial distribution, $X$ can be written as the sum of $r$ independent geometric random variables (each counting failures before one success), each with mean $(1-p)/p$ and variance $(1-p)/p^{2}$. Therefore,\n$$\nE[X]=r\\frac{1-p}{p},\\qquad \\operatorname{Var}(X)=r\\frac{1-p}{p^{2}}.\n$$\nLet $\\mu=E[X]$ and $\\sigma^{2}=\\operatorname{Var}(X)$. Then\n$$\n\\frac{\\sigma^{2}}{\\mu}=\\frac{r(1-p)/p^{2}}{r(1-p)/p}=\\frac{1}{p}\\quad\\Longrightarrow\\quad p=\\frac{\\mu}{\\sigma^{2}}.\n$$\nNext, solve for $r$ from the mean:\n$$\n\\mu=r\\frac{1-p}{p}\\quad\\Longrightarrow\\quad r=\\frac{\\mu p}{1-p}.\n$$\nSubstitute $p=\\mu/\\sigma^{2}$:\n$$\nr=\\frac{\\mu\\left(\\frac{\\mu}{\\sigma^{2}}\\right)}{1-\\frac{\\mu}{\\sigma^{2}}}\n=\\frac{\\mu^{2}}{\\sigma^{2}-\\mu}.\n$$\nWith the empirical estimates $\\mu=10$ and $\\sigma^{2}=20$, we obtain\n$$\np=\\frac{10}{20}=\\frac{1}{2},\\qquad r=\\frac{10^{2}}{20-10}=\\frac{100}{10}=10.\n$$\nThus, the parameters are $(r,p)=(10,\\frac{1}{2})$.", "answer": "$$\\boxed{\\begin{pmatrix}10 & \\frac{1}{2}\\end{pmatrix}}$$", "id": "1939495"}, {"introduction": "Our final practice delves into the dynamic nature of the negative binomial process by incorporating conditional probability. Understanding how new information—such as the outcome of an early trial—affects the likelihood of future events is a critical skill in stochastic modeling. This exercise [@problem_id:12881] will guide you through calculating a conditional probability, reinforcing your understanding of the sequence of successes and failures that defines the distribution.", "problem": "Consider a sequence of independent Bernoulli trials where the probability of success on any given trial is denoted by $p$. A process is defined to be complete when a total of $r$ successes have been observed. Let the random variable $X$ denote the trial number on which the process is completed.\n\nYour task is to calculate the conditional probability that the process completes on trial $k$, given that the first trial resulted in a success.\n\nSymbolically, you must derive the value of $P(X=k | \\text{first trial is a success})$.\n\nProvide the final numerical value for the case where the process requires $r=4$ successes, the probability of success is $p=\\frac{1}{2}$, and we want to find the probability of the process completing on the $k=5$-th trial.", "solution": "Let $A$ be the event that the process completes on the $k=5$-th trial, which means the 4th success occurs on the 5th trial. Let $B$ be the event that the first trial is a success. We are asked to compute the conditional probability $P(A|B)$.\n\nThe formula for conditional probability is:\n$$\nP(A|B) = \\frac{P(A \\cap B)}{P(B)}\n$$\n\nFirst, we calculate the probability of the conditioning event, $B$. The probability of success on any single trial is given as $p$. Therefore, the probability that the first trial is a success is:\n$$\nP(B) = p\n$$\nFor the specific values given, $p=1/2$, so $P(B) = 1/2$.\n\nNext, we analyze the event $A \\cap B$. This is the event that \"the 4th success occurs on the 5th trial AND the first trial is a success\". For this composite event to be true, the following conditions must be met:\n1.  The 1st trial must be a success.\n2.  The 5th trial must be a success (as it is the 4th and final required success).\n3.  The remaining $r-2 = 4-2=2$ successes must occur within the trials from 2 to 4 (i.e., in the set of trials $\\{2, 3, 4\\}$).\n\nThe number of trials between the first and the last is $(k-1)-1 = k-2$. In our case, this is $5-2=3$ trials. We need to place $r-2=2$ successes in these 3 trials. The number of ways to choose which of these 3 trials are successes is given by the binomial coefficient $\\binom{k-2}{r-2}$.\n$$\n\\text{Number of arrangements} = \\binom{5-2}{4-2} = \\binom{3}{2} = \\frac{3!}{2!(3-2)!} = 3\n$$\nThe specific sequences are (S for Success, F for Failure):\n- (S, S, S, F, S)\n- (S, S, F, S, S)\n- (S, F, S, S, S)\n\nEach of these sequences contains $r=4$ successes and $k-r = 5-4=1$ failure. The probability of any one such specific sequence occurring is $p^r (1-p)^{k-r}$.\n$$\nP(\\text{single sequence}) = p^4 (1-p)^{5-4} = p^4(1-p)^1\n$$\n\nThe total probability of the event $A \\cap B$ is the number of such arrangements multiplied by the probability of a single arrangement.\n$$\nP(A \\cap B) = \\binom{k-2}{r-2} p^r (1-p)^{k-r}\n$$\n\nNow, we substitute the specific values $r=4$, $k=5$, and $p=1/2$:\n$$\nP(A \\cap B) = \\binom{3}{2} \\left(\\frac{1}{2}\\right)^4 \\left(1-\\frac{1}{2}\\right)^1 = 3 \\left(\\frac{1}{16}\\right) \\left(\\frac{1}{2}\\right) = \\frac{3}{32}\n$$\n\nFinally, we can calculate the conditional probability $P(A|B)$:\n$$\nP(A|B) = \\frac{P(A \\cap B)}{P(B)} = \\frac{3/32}{1/2}\n$$\n$$\nP(A|B) = \\frac{3}{32} \\cdot 2 = \\frac{6}{32} = \\frac{3}{16}\n$$", "answer": "$$\\boxed{\\frac{3}{16}}$$", "id": "12881"}]}