{"hands_on_practices": [{"introduction": "The security of the RSA cryptosystem hinges on the precise mathematical relationships established during key generation. This exercise explores a common conceptual hurdle by presenting a scenario where a seemingly arbitrary choice for the public exponent prevents the creation of a valid key pair [@problem_id:1349562]. By diagnosing the failure, you will reinforce your understanding of the critical requirement that the public exponent $e$ and Euler's totient function $\\phi(n)$ must be coprime.", "problem": "An undergraduate student is learning about the Rivest-Shamir-Adleman (RSA) public-key cryptosystem. For a hands-on exercise, they choose two small prime numbers, $p=5$ and $q=11$. They correctly calculate the modulus $n = pq$ and Euler's totient function $\\phi(n) = (p-1)(q-1)$.\n\nFollowing the RSA key generation procedure, the student must select a public exponent $e$. They choose $e=20$. However, when they attempt to compute the corresponding private exponent $d$ (which should be the multiplicative inverse of $e$ modulo $\\phi(n)$), they discover that no such integer $d$ exists.\n\nWhich of the following statements correctly identifies the fundamental mathematical reason for this failure?\n\nA. The chosen prime number $q=11$ is not large enough to ensure a valid key pair can be generated.\n\nB. The public exponent $e$ must be a prime number, but the chosen value $e=20$ is composite.\n\nC. The public exponent $e$ and $\\phi(n)$ must be coprime, but they share a common divisor greater than 1.\n\nD. The public exponent $e$ must be smaller than the modulus $n$.\n\nE. One of the initial numbers, $p=5$, is too small, causing $\\phi(n)$ to be an even number.", "solution": "Given primes $p=5$ and $q=11$, the RSA modulus and Euler totient are\n$$n=pq=5\\cdot 11=55,$$\n$$\\phi(n)=(p-1)(q-1)=(5-1)(11-1)=4\\cdot 10=40.$$\nIn RSA, the private exponent $d$ is defined to satisfy the congruence\n$$ed\\equiv 1 \\pmod{\\phi(n)}.$$\nA fundamental number-theoretic fact is that an integer $a$ has a multiplicative inverse modulo $m$ if and only if $\\gcd(a,m)=1$. Therefore, a necessary and sufficient condition for $d$ to exist is\n$$\\gcd(e,\\phi(n))=1.$$\nWith the chosen $e=20$ and $\\phi(n)=40$, we compute\n$$\\gcd(20,40)=20>1.$$\nEquivalently, $20$ divides $40$, so $20$ is not invertible modulo $40$. Hence, there is no integer $d$ satisfying $20d\\equiv 1 \\pmod{40}$, which explains the failure.\n\nAssessing the options:\n- A is false: the size of $q$ does not determine invertibility; only $\\gcd(e,\\phi(n))$ matters.\n- B is false: $e$ need not be prime; it only needs to be coprime to $\\phi(n)$ (for example, $e=9$ would be valid when $\\gcd(9,40)=1$).\n- C is true: here $e$ and $\\phi(n)$ share a common divisor $20$, so no inverse exists.\n- D is false in this context: $e<n$ holds ($20<55$), and the critical condition is coprimality with $\\phi(n)$.\n- E is false: for odd primes $p$ and $q$, $\\phi(n)$ is always even; this is not itself a problem—the issue is the shared factor between $e$ and $\\phi(n)$.\n\nTherefore, the correct statement is C.", "answer": "$$\\boxed{C}$$", "id": "1349562"}, {"introduction": "This problem provides hands-on practice with the ElGamal cryptosystem, a procedure that relies on the presumed difficulty of computing discrete logarithms [@problem_id:1349529]. You will apply several core number theory techniques—including modular exponentiation and finding modular inverses—to successfully recover a plaintext message from its ciphertext, seeing firsthand how the system's security hinges on the difficulty of the discrete logarithm problem.", "problem": "In a simplified ElGamal public-key cryptosystem, the public parameters are a prime modulus $p=29$ and a generator $g=2$ of the multiplicative group of integers modulo 29, denoted $\\mathbb{Z}_{29}^*$.\n\nAlice wishes to send a secret message to Bob. Bob has selected a private key and has published his corresponding public key, which is $h=3$.\n\nAlice encrypts her plaintext message, $m$, and sends the resulting ciphertext, which is an ordered pair of integers $(c_1, c_2)$. An eavesdropper intercepts the communication and finds that the ciphertext is $(c_1, c_2) = (16, 27)$.\n\nAssuming the plaintext message $m$ is an integer such that $1 \\le m < 29$, determine the value of $m$.", "solution": "In ElGamal, with public parameters $p$ and $g$, Bob’s public key is $h \\equiv g^{x} \\pmod{p}$ for private key $x$. Encryption of $m$ uses a random $k$ to form\n$$\nc_{1} \\equiv g^{k} \\pmod{p}, \\qquad c_{2} \\equiv m \\cdot h^{k} \\pmod{p}.\n$$\nGiven $p=29$, $g=2$, $h=3$, and ciphertext $(c_{1},c_{2})=(16,27)$, first determine $k$ from $c_{1}$:\n$$\nc_{1} \\equiv g^{k} \\pmod{29} \\;\\Longrightarrow\\; 16 \\equiv 2^{k} \\pmod{29}.\n$$\nCompute small powers of $2$ modulo $29$:\n$$\n2^{1}=2,\\; 2^{2}=4,\\; 2^{3}=8,\\; 2^{4}=16 \\pmod{29},\n$$\nso $k=4$. Then\n$$\nc_{2} \\equiv m \\cdot h^{k} \\pmod{29} \\;\\Longrightarrow\\; m \\equiv c_{2} \\cdot \\left(h^{k}\\right)^{-1} \\pmod{29}.\n$$\nCompute $h^{k} \\equiv 3^{4} \\pmod{29}$. Using $3^{2}=9$ and $3^{4}=(3^{2})^{2}=9^{2}=81$,\n$$\n3^{4} \\equiv 81 \\equiv 81 - 58 = 23 \\pmod{29}.\n$$\nThus\n$$\nm \\equiv 27 \\cdot 23^{-1} \\pmod{29}.\n$$\nFind $23^{-1} \\pmod{29}$ via the extended Euclidean algorithm:\n$$\n29 = 23 \\cdot 1 + 6,\\quad 23 = 6 \\cdot 3 + 5,\\quad 6 = 5 \\cdot 1 + 1,\\quad 5 = 1 \\cdot 5 + 0.\n$$\nBack-substitute to express $1$ as a combination of $29$ and $23$:\n$$\n1 = 6 - 5,\\quad 5 = 23 - 6 \\cdot 3 \\;\\Rightarrow\\; 1 = 6 - (23 - 6 \\cdot 3) = 4 \\cdot 6 - 23,\n$$\nand with $6 = 29 - 23$,\n$$\n1 = 4(29 - 23) - 23 = 4 \\cdot 29 - 5 \\cdot 23.\n$$\nHence $-5 \\cdot 23 \\equiv 1 \\pmod{29}$, so $23^{-1} \\equiv 24 \\pmod{29}$. Therefore,\n$$\nm \\equiv 27 \\cdot 24 \\pmod{29}.\n$$\nCompute $27 \\cdot 24 = 648$ and note $29 \\cdot 22 = 638$, so\n$$\n648 \\equiv 648 - 638 = 10 \\pmod{29}.\n$$\nThus $m=10$ with $1 \\le m < 29$ as required.", "answer": "$$\\boxed{10}$$", "id": "1349529"}, {"introduction": "Understanding a cryptosystem's strengths requires understanding its weaknesses. This final practice delves into cryptanalysis by exploring Pollard's $p-1$ algorithm, a clever method for factoring integers that can undermine RSA's security if its prime numbers are not chosen with care [@problem_id:1349546]. This exercise illuminates the deep connection between the security of a cryptosystem and the specific number-theoretic properties of its keys, demonstrating why robust cryptographic design must anticipate such attacks.", "problem": "In a simplified model of a cryptographic attack, an adversary attempts to find a non-trivial factor of a composite number $n$. The method proceeds as follows: an integer base $a > 1$ is chosen, and for successive positive integers $k=1, 2, 3, \\dots$, a value $g_k = \\gcd(a^{k!} - 1, n)$ is computed. The first value of $k$ for which $g_k$ is greater than 1 and less than $n$ reveals a non-trivial factor of $n$.\n\nConsider the composite number $n = 1333$ and the base $a = 2$.\n\nFind the smallest positive integer $k$ for which this method successfully finds a non-trivial factor. Also, state the non-trivial factor found for this value of $k$.\n\nProvide your answer as a pair of integers, with the smallest successful value of $k$ first, followed by the corresponding non-trivial factor.", "solution": "We are given $n=1333$ and $a=2$, and $g_{k}=\\gcd(2^{k!}-1,n)$. Factoring $n$ gives\n$$1333=31\\cdot 43,$$\nso any non-trivial value of $g_{k}$ must be in $\\{31,43\\}$, while $g_{k}=1333$ would mean both primes divide $2^{k!}-1$.\n\nFor a prime $p$ with $\\gcd(2,p)=1$, let $\\operatorname{ord}_{p}(2)$ denote the multiplicative order of $2$ modulo $p$. Then\n$$2^{m}\\equiv 1 \\pmod{p}\\quad \\Longleftrightarrow\\quad \\operatorname{ord}_{p}(2)\\mid m.$$\n\nCompute the orders for the prime factors:\n- Modulo $31$: since $2^{5}=32\\equiv 1 \\pmod{31}$ and $2\\not\\equiv 1 \\pmod{31}$, we have $\\operatorname{ord}_{31}(2)=5$.\n- Modulo $43$: compute $2^{5}=32$, $2^{6}=64\\equiv 21 \\pmod{43}$, hence $2^{7}\\equiv 2\\cdot 21=42\\equiv -1 \\pmod{43}$, so $2^{14}\\equiv 1 \\pmod{43}$ and $\\operatorname{ord}_{43}(2)=14$ (since $2^{1}\\not\\equiv 1$ and $2^{7}\\not\\equiv 1$).\n\nTherefore,\n- $31\\mid 2^{k!}-1$ iff $5\\mid k!$,\n- $43\\mid 2^{k!}-1$ iff $14\\mid k!$.\n\nCheck $k=1,2,3,4$:\n$$1!=1,\\quad 2!=2,\\quad 3!=6,\\quad 4!=24,$$\nnone of which is divisible by $5$ or $14$, so $g_{k}=1$ for $k\\in\\{1,2,3,4\\}$.\n\nFor $k=5$, we have $5!=120$. Then $5\\mid 120$ but $14\\nmid 120$. Hence $31\\mid 2^{120}-1$ while $43\\nmid 2^{120}-1$, so\n$$g_{5}=\\gcd(2^{120}-1,1333)=31,$$\nwhich is a non-trivial factor and is the first such success.\n\nThus, the smallest successful $k$ is $5$, and the factor found is $31$.", "answer": "$$\\boxed{\\begin{pmatrix} 5 & 31 \\end{pmatrix}}$$", "id": "1349546"}]}