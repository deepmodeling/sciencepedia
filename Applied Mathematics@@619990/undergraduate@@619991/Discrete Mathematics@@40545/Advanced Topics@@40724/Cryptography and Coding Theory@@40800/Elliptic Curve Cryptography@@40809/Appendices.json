{"hands_on_practices": [{"introduction": "The security of elliptic curve cryptography rests upon the group structure formed by points on a curve. This first practice is a hands-on walkthrough of the fundamental arithmetic—point addition and doubling—that defines this group. By calculating successive multiples of a point $G$, you will find its order, which is a core concept for understanding the cyclic nature of these cryptographic groups [@problem_id:1366834].", "problem": "In the study of elliptic curves over finite fields, a fundamental concept is the \"order\" of a point. The order of a point $P$ is the smallest positive integer $n$ such that the sum of $P$ with itself $n$ times equals the point at infinity, denoted as $\\mathcal{O}$. This sum is written as $nP = \\mathcal{O}$.\n\nThe rules for point addition on an elliptic curve of the form $y^2 \\equiv x^3 + ax + b \\pmod{p}$, where $p > 3$ is a prime, are as follows. Let $P_1 = (x_1, y_1)$ and $P_2 = (x_2, y_2)$ be two points on the curve. The point at infinity $\\mathcal{O}$ acts as the identity element.\n\n1.  **Identity:** $P + \\mathcal{O} = P$ for any point $P$.\n2.  **Negation:** The negative of a point $P=(x,y)$ is $-P=(x, -y \\pmod p)$. If a point $P_1$ is the negative of $P_2$, their sum is $P_1 + P_2 = \\mathcal{O}$. This occurs when $x_1=x_2$ and $y_1 = -y_2 \\pmod p$.\n3.  **Point Addition ($P_1 \\neq P_2$):** The sum $P_3 = P_1 + P_2 = (x_3, y_3)$ is calculated as:\n    - $\\lambda = (y_2 - y_1) (x_2 - x_1)^{-1} \\pmod{p}$\n    - $x_3 = (\\lambda^2 - x_1 - x_2) \\pmod{p}$\n    - $y_3 = (\\lambda(x_1 - x_3) - y_1) \\pmod{p}$\n    This rule does not apply if $x_1=x_2$. In that case, see rule 2.\n4.  **Point Doubling ($P_1 = P_2$):** If $y_1 \\neq 0$, the sum $P_3 = 2P_1 = (x_3, y_3)$ is calculated as:\n    - $\\lambda = (3x_1^2 + a) (2y_1)^{-1} \\pmod{p}$\n    - $x_3 = (\\lambda^2 - 2x_1) \\pmod{p}$\n    - $y_3 = (\\lambda(x_1 - x_3) - y_1) \\pmod{p}$\n    If $y_1 = 0$, then $2P_1 = \\mathcal{O}$.\n\nConsider the elliptic curve defined by the equation $y^2 \\equiv x^3 + 4 \\pmod 5$. Let $G$ be the point $(0, 2)$ on this curve.\n\nDetermine the order of the point $G$. Your final answer should be a single integer.", "solution": "We are working over the finite field modulo the prime $p=5$ on the curve $y^{2} \\equiv x^{3} + 4 \\pmod{5}$ with $a=0$. First, verify that $G=(0,2)$ lies on the curve:\n$$\ny^{2} \\equiv 2^{2} \\equiv 4 \\pmod{5}, \\quad x^{3} + 4 \\equiv 0^{3} + 4 \\equiv 4 \\pmod{5},\n$$\nso $4 \\equiv 4 \\pmod{5}$, and $G$ is on the curve.\n\nCompute $2G$ using the point doubling rule (since $y_{1}=2 \\not\\equiv 0 \\pmod{5}$). Let $P_{1}=G=(x_{1},y_{1})=(0,2)$. Then\n$$\n\\lambda \\equiv (3x_{1}^{2}+a)(2y_{1})^{-1} \\equiv (3\\cdot 0^{2}+0)\\,(2\\cdot 2)^{-1} \\equiv 0 \\cdot 4^{-1} \\pmod{5}.\n$$\nWe find $(4)^{-1} \\equiv 4 \\pmod{5}$ because $4\\cdot 4 \\equiv 16 \\equiv 1 \\pmod{5}$. Hence\n$$\n\\lambda \\equiv 0 \\cdot 4 \\equiv 0 \\pmod{5}.\n$$\nNow compute the coordinates:\n$$\nx_{3} \\equiv \\lambda^{2} - 2x_{1} \\equiv 0^{2} - 2\\cdot 0 \\equiv 0 \\pmod{5},\n$$\n$$\ny_{3} \\equiv \\lambda(x_{1} - x_{3}) - y_{1} \\equiv 0\\cdot (0 - 0) - 2 \\equiv -2 \\equiv 3 \\pmod{5}.\n$$\nTherefore,\n$$\n2G = (0,3).\n$$\n\nUse the negation rule to compute $3G = 2G + G$. The negative of $G=(0,2)$ is $-G=(0,-2) \\equiv (0,3) \\pmod{5}$. Since $2G=(0,3)=-G$ and $x$-coordinates agree with $y$-coordinates being negatives modulo $5$, the addition rule gives\n$$\n3G = 2G + G = (-G) + G = \\mathcal{O}.\n$$\nMoreover, $2G \\neq \\mathcal{O}$, so the smallest positive integer $n$ with $nG=\\mathcal{O}$ is $n=3$.\n\nThus, the order of $G$ is $3$.", "answer": "$$\\boxed{3}$$", "id": "1366834"}, {"introduction": "Having mastered point addition, we can now explore its most critical application: scalar multiplication. This operation, where a point $P$ is added to itself $k$ times to compute $kP$, is the bedrock of ECC's security and is used to generate public keys. In this exercise, you will simulate this process by taking a private key $k$ and a base point $P$ to calculate the corresponding public key $Q$, solidifying your understanding of how ECC keys are created [@problem_id:1366844].", "problem": "In elliptic curve cryptography, a public key is generated by performing scalar multiplication of a base point $P$ on a given elliptic curve. This operation, denoted as $kP$, involves adding the point $P$ to itself $k-1$ times, where $k$ is an integer secret key. The addition of points on an elliptic curve follows specific algebraic rules.\n\nConsider an elliptic curve defined over a finite field $\\mathbb{F}_p$ by the equation $y^2 \\equiv x^3 + ax + b \\pmod{p}$, where $p$ is a prime number.\n\nThe rule for adding two distinct points $P=(x_1, y_1)$ and $Q=(x_2, y_2)$ to get $R=P+Q=(x_3, y_3)$ is:\n$$ \\lambda = (y_2 - y_1)(x_2-x_1)^{-1} \\pmod{p} $$\n$$ x_3 = \\lambda^2 - x_1 - x_2 \\pmod{p} $$\n$$ y_3 = \\lambda(x_1 - x_3) - y_1 \\pmod{p} $$\nHere, $(x_2-x_1)^{-1}$ denotes the modular multiplicative inverse of $(x_2-x_1)$ modulo $p$.\n\nThe rule for doubling a point $P=(x_1, y_1)$ to get $R=2P=(x_3, y_3)$ is:\n$$ \\lambda = (3x_1^2 + a)(2y_1)^{-1} \\pmod{p} $$\n$$ x_3 = \\lambda^2 - 2x_1 \\pmod{p} $$\n$$ y_3 = \\lambda(x_1 - x_3) - y_1 \\pmod{p} $$\nHere, $(2y_1)^{-1}$ denotes the modular multiplicative inverse of $(2y_1)$ modulo $p$.\n\nGiven the elliptic curve $y^2 \\equiv x^3 + x + 1 \\pmod{5}$ and a base point $P = (0, 1)$ on this curve. A user chooses the secret key $k=4$.\n\nCalculate the coordinates of the resulting point $Q = 4P$. Express your answer as a row matrix $\\begin{pmatrix} x & y \\end{pmatrix}$ where $x$ and $y$ are the coordinates of the resulting point, with values in the set $\\{0, 1, 2, 3, 4\\}$.", "solution": "We work over the finite field $\\mathbb{F}_{5}$ on the curve $y^{2} \\equiv x^{3} + x + 1 \\pmod{5}$ with $a=1$. The base point is $P=(0,1)$, and we seek $Q=4P$.\n\nFirst, verify $P$ lies on the curve:\n$$\ny^{2} \\equiv 1^{2} \\equiv 1,\\quad x^{3}+x+1 \\equiv 0^{3}+0+1 \\equiv 1 \\pmod{5}.\n$$\nThus $P$ is on the curve.\n\nCompute $2P$ using the doubling rule with $x_{1}=0$, $y_{1}=1$:\n$$\n\\lambda = (3x_{1}^{2}+a)(2y_{1})^{-1} \\equiv (0+1)\\cdot(2)^{-1} \\equiv 1\\cdot 3 \\equiv 3 \\pmod{5},\n$$\nsince $2^{-1} \\equiv 3 \\pmod{5}$.\nThen\n$$\nx_{3} \\equiv \\lambda^{2} - 2x_{1} \\equiv 3^{2} - 0 \\equiv 9 \\equiv 4 \\pmod{5},\n$$\n$$\ny_{3} \\equiv \\lambda(x_{1}-x_{3}) - y_{1} \\equiv 3(0-4) - 1 \\equiv 3\\cdot 1 - 1 \\equiv 2 \\pmod{5},\n$$\nusing $0-4 \\equiv 1 \\pmod{5}$. Hence $2P=(4,2)$.\n\nCompute $3P = 2P + P$ using the addition rule with $(x_{1},y_{1})=(4,2)$ and $(x_{2},y_{2})=(0,1)$:\n$$\n\\lambda = (y_{2}-y_{1})(x_{2}-x_{1})^{-1} \\equiv (1-2)(0-4)^{-1} \\equiv (-1)(-4)^{-1} \\equiv 4\\cdot 1 \\equiv 4 \\pmod{5},\n$$\nsince $-1 \\equiv 4$ and $-4 \\equiv 1$ so $(0-4)^{-1} \\equiv 1^{-1} \\equiv 1$. Then\n$$\nx_{3} \\equiv \\lambda^{2} - x_{1} - x_{2} \\equiv 4^{2} - 4 - 0 \\equiv 16 - 4 \\equiv 12 \\equiv 2 \\pmod{5},\n$$\n$$\ny_{3} \\equiv \\lambda(x_{1}-x_{3}) - y_{1} \\equiv 4(4-2) - 2 \\equiv 4\\cdot 2 - 2 \\equiv 8 - 2 \\equiv 6 \\equiv 1 \\pmod{5}.\n$$\nThus $3P=(2,1)$.\n\nCompute $4P = 3P + P$ with $(x_{1},y_{1})=(2,1)$ and $(x_{2},y_{2})=(0,1)$:\n$$\n\\lambda = (y_{2}-y_{1})(x_{2}-x_{1})^{-1} \\equiv (1-1)(0-2)^{-1} \\equiv 0\\cdot(-2)^{-1} \\equiv 0 \\pmod{5},\n$$\nsince $(0-2) \\equiv -2 \\equiv 3$ and $3^{-1} \\equiv 2$, but $0\\cdot 2 \\equiv 0$. Then\n$$\nx_{3} \\equiv \\lambda^{2} - x_{1} - x_{2} \\equiv 0 - 2 - 0 \\equiv -2 \\equiv 3 \\pmod{5},\n$$\n$$\ny_{3} \\equiv \\lambda(x_{1}-x_{3}) - y_{1} \\equiv 0\\cdot(2-3) - 1 \\equiv -1 \\equiv 4 \\pmod{5}.\n$$\nTherefore $4P=(3,4)$.\n\nAs a check, $(3,4)$ satisfies the curve equation modulo $5$:\n$$\ny^{2} \\equiv 4^{2} \\equiv 16 \\equiv 1,\\quad x^{3}+x+1 \\equiv 27+3+1 \\equiv 31 \\equiv 1 \\pmod{5}.\n$$\nHence the result is correct.", "answer": "$$\\boxed{\\begin{pmatrix} 3 & 4 \\end{pmatrix}}$$", "id": "1366844"}, {"introduction": "Beyond the behavior of individual points, the collective properties of all points on a curve define its group structure. This exercise introduces the concept of a torsion subgroup, a special collection of points whose order divides a specific integer. Your task is to first enumerate all points on the given curve and then identify the complete 3-torsion subgroup, which provides a deeper look into the intricate algebraic structure that underpins advanced ECC applications [@problem_id:1366842].", "problem": "Consider an elliptic curve $E$ defined over the finite field of integers modulo 7, $\\mathbb{F}_7$, by the equation:\n$$y^2 \\equiv x^3 + 2 \\pmod{7}$$\nThe set of points $(x,y)$ on this curve, along with a special point called the \"point at infinity\" denoted by $O$, form an abelian group under a specific point addition operation. The point $O$ serves as the identity element for this group.\n\nThe group addition rules are as follows, with all arithmetic performed in $\\mathbb{F}_7$:\n1.  For any point $P$, $P + O = P$.\n2.  For any non-identity point $P=(x,y)$, its inverse is $-P=(x, -y)$, and $P + (-P) = O$.\n3.  To add two distinct points $P_1 = (x_1, y_1)$ and $P_2 = (x_2, y_2)$ where $x_1 \\neq x_2$, their sum $P_3 = (x_3, y_3)$ is given by:\n    $$\\lambda = (y_2 - y_1)(x_2 - x_1)^{-1}$$\n    $$x_3 = \\lambda^2 - x_1 - x_2$$\n    $$y_3 = \\lambda(x_1 - x_3) - y_1$$\n4.  To double a point $P_1 = (x_1, y_1)$ where $y_1 \\neq 0$ (i.e., to compute $2P_1 = P_1 + P_1$), the sum $P_3 = (x_3, y_3)$ is given by:\n    $$\\lambda = (3x_1^2)(2y_1)^{-1}$$\n    $$x_3 = \\lambda^2 - 2x_1$$\n    $$y_3 = \\lambda(x_1 - x_3) - y_1$$\n\nThe 3-torsion subgroup of $E$, denoted $E[3]$, is the set of all points $P$ on the curve (including $O$) such that $3P = P+P+P = O$.\n\nWhich of the following sets represents the complete 3-torsion subgroup $E[3]$ for the given curve?\n\nA. $\\{O\\}$\n\nB. $\\{O, (0, 3), (0, 4)\\}$\n\nC. $\\{O, (0, 3), (0, 4), (3, 1), (3, 6), (5, 1), (5, 6), (6, 1), (6, 6)\\}$\n\nD. $\\{(0, 3), (0, 4), (3, 1), (3, 6), (5, 1), (5, 6), (6, 1), (6, 6)\\}$\n\nE. $\\{O, (3, 1), (3, 6), (5, 1), (5, 6)\\}$\n\nF. The set is empty as no points satisfy the condition.", "solution": "We work over $\\mathbb{F}_{7}$ on the curve $E: y^{2} \\equiv x^{3} + 2 \\pmod{7}$. First enumerate $E(\\mathbb{F}_{7})$.\n\nCompute cubes modulo $7$: for $x \\in \\{0,1,2,3,4,5,6\\}$,\n$0^{3} \\equiv 0$, $1^{3} \\equiv 1$, $2^{3} \\equiv 1$, $3^{3} \\equiv 6$, $4^{3} \\equiv 1$, $5^{3} \\equiv 6$, $6^{3} \\equiv 6$.\nThus $x^{3} \\in \\{0,1,6\\}$. Hence $x^{3} + 2 \\in \\{2,3,1\\}$, specifically:\n- $x=0$: $x^{3} + 2 \\equiv 2$,\n- $x=1,2,4$: $x^{3} + 2 \\equiv 3$,\n- $x=3,5,6$: $x^{3} + 2 \\equiv 1$.\n\nQuadratic residues modulo $7$ are $0,1,2,4$ with square roots:\n- $1$ has roots $y \\equiv 1,6$,\n- $2$ has roots $y \\equiv 3,4$,\n- $4$ has roots $y \\equiv 2,5$,\nand $3,5,6$ are nonresidues.\n\nTherefore the affine points are:\n- For $x=0$: $y^{2} \\equiv 2 \\Rightarrow y \\equiv 3,4$, giving $(0,3),(0,4)$.\n- For $x=1,2,4$: $y^{2} \\equiv 3$ has no solutions.\n- For $x=3,5,6$: $y^{2} \\equiv 1 \\Rightarrow y \\equiv 1,6$, giving $(3,1),(3,6),(5,1),(5,6),(6,1),(6,6)$.\nIncluding $O$, we have $9$ points total: $|E(\\mathbb{F}_{7})|=9$.\n\nNow determine $E[3] = \\{P \\in E(\\mathbb{F}_{7}) : 3P = O\\}$. Since $|E(\\mathbb{F}_{7})| = 9 = 3^{2}$, every point has order a power of $3$. Thus $E[3]$ is either the whole group (all $9$ points) or the unique subgroup of order $3$. We decide which by computing $3P$ for representative points using the given addition formulas.\n\nTake $P=(0,3)$. Since $y_{1} \\neq 0$, the doubling formula applies:\n$$\\lambda = (3x_{1}^{2})(2y_{1})^{-1} = (3\\cdot 0^{2})(2\\cdot 3)^{-1} \\equiv 0 \\cdot 6^{-1} \\equiv 0 \\pmod{7}.$$\nThen\n$$x_{3} = \\lambda^{2} - 2x_{1} \\equiv 0 - 0 \\equiv 0,\\quad y_{3} = \\lambda(x_{1} - x_{3}) - y_{1} \\equiv 0 - 3 \\equiv 4,$$\nso $2P = (0,4) = -P$. Hence $3P = 2P + P = -P + P = O$.\n\nNext take $Q=(3,1)$. Compute\n$$\\lambda = (3x_{1}^{2})(2y_{1})^{-1} = (3\\cdot 3^{2})(2\\cdot 1)^{-1} \\equiv (3\\cdot 2)\\cdot 2^{-1} \\equiv 6 \\cdot 4 \\equiv 24 \\equiv 3 \\pmod{7}.$$\nThen\n$$x_{3} \\equiv \\lambda^{2} - 2x_{1} \\equiv 3^{2} - 6 \\equiv 2 - 6 \\equiv 3,\\quad y_{3} \\equiv \\lambda(x_{1} - x_{3}) - y_{1} \\equiv 3\\cdot 0 - 1 \\equiv 6,$$\nso $2Q = (3,6) = -Q$, hence $3Q=O$.\n\nSimilarly for $R=(5,1)$,\n$$\\lambda \\equiv (3\\cdot 5^{2})\\cdot (2\\cdot 1)^{-1} \\equiv (3\\cdot 4)\\cdot 4 \\equiv 12\\cdot 4 \\equiv 5\\cdot 4 \\equiv 6,$$\n$$x_{3} \\equiv 6^{2} - 10 \\equiv 1 - 3 \\equiv 5,\\quad y_{3} \\equiv 6\\cdot 0 - 1 \\equiv 6,$$\nso $2R=(5,6)=-R$, and $3R=O$.\n\nFor $S=(6,1)$,\n$$\\lambda \\equiv (3\\cdot 6^{2})\\cdot (2\\cdot 1)^{-1} \\equiv (3\\cdot 1)\\cdot 4 \\equiv 3\\cdot 4 \\equiv 5,$$\n$$x_{3} \\equiv 5^{2} - 12 \\equiv 4 - 5 \\equiv 6,\\quad y_{3} \\equiv 5\\cdot 0 - 1 \\equiv 6,$$\nso $2S=(6,6)=-S$, and $3S=O$.\n\nFor the negatives $-P$ of these points, the group law gives $2(-P) = -(2P)$, so if $2P=-P$ then $2(-P)=P$, and hence $3(-P)=O$ as well. Therefore, for every affine point found, $3P=O$. Trivially, $3O=O$.\n\nConsequently, every point of $E(\\mathbb{F}_{7})$ is $3$-torsion, so $E[3]=E(\\mathbb{F}_{7})$ consists of all $9$ points: $O$, $(0,3)$, $(0,4)$, $(3,1)$, $(3,6)$, $(5,1)$, $(5,6)$, $(6,1)$, $(6,6)$. This matches option C.", "answer": "$$\\boxed{C}$$", "id": "1366842"}]}