{"hands_on_practices": [{"introduction": "Modular exponentiation is not just about calculation; it's about efficient calculation. Fermat's Little Theorem provides a powerful shortcut for simplifying expressions with large exponents, a principle that is foundational to modern cryptography. This first practice problem [@problem_id:1385421] demonstrates how a seemingly daunting computation can be reduced to a few simple steps by applying this elegant theorem.", "problem": "In a simplified model of a cryptographic handshake protocol, two parties agree on a public prime number $p$. One party, Alice, chooses a secret integer $a$, and the other party, Bob, chooses a secret integer $b$. They use these numbers to compute a shared verification key.\n\nLet the public prime be $p = 131$. Alice's secret integer is $a = 400$, and Bob's secret integer is $b = 517$. The shared verification key, $K$, is computed according to the formula:\n$$K = (4a^{p-1} - 9b^{p-1}) \\pmod{p}$$\nCalculate the value of the shared verification key $K$. Your answer must be a non-negative integer.", "solution": "We are given a prime modulus $p=131$, and integers $a=400$ and $b=517$. The shared verification key is defined by\n$$K = \\left(4a^{p-1} - 9b^{p-1}\\right) \\bmod p.$$\nSince $p$ is prime, by Fermat's little theorem, for any integer $x$ with $p \\nmid x$, we have\n$$x^{p-1} \\equiv 1 \\pmod{p}.$$\nWe verify that $p \\nmid a$ and $p \\nmid b$ by reducing $a$ and $b$ modulo $p$:\n$$a \\equiv 400 \\equiv 400 - 3\\cdot 131 = 400 - 393 = 7 \\not\\equiv 0 \\pmod{131},$$\n$$b \\equiv 517 \\equiv 517 - 3\\cdot 131 = 517 - 393 = 124 \\not\\equiv 0 \\pmod{131}.$$\nTherefore,\n$$a^{p-1} \\equiv a^{130} \\equiv 1 \\pmod{131}, \\quad b^{p-1} \\equiv b^{130} \\equiv 1 \\pmod{131}.$$\nSubstituting into the expression for $K$ gives\n$$K \\equiv 4\\cdot 1 - 9\\cdot 1 \\equiv -5 \\pmod{131}.$$\nTo express this as a non-negative integer in the range $0$ to $p-1$, we add $131$:\n$$-5 \\equiv 131 - 5 = 126 \\pmod{131}.$$\nHence the shared verification key is $126$.", "answer": "$$\\boxed{126}$$", "id": "1385421"}, {"introduction": "Understanding a powerful tool also means understanding its limitations. While it's tempting to think that all properties of equality apply to modular congruences, this is not the case, especially with exponents. This exercise [@problem_id:1385390] challenges you to find a counterexample to a common misconception, reinforcing the critical rule that exponents in modular arithmetic require their own special handling, typically involving Euler's totient theorem or Fermat's Little Theorem.", "problem": "In modular arithmetic, a common misconception arises from extending the property $a \\equiv b \\pmod{m} \\implies a+c \\equiv b+c \\pmod{m}$ to exponentiation. Consider the following proposition:\n\n\"For any integers $a, b, c$ with $c>0$ and any integer $m > 1$, if $a \\equiv b \\pmod{m}$, then $c^a \\equiv c^b \\pmod{m}$.\"\n\nThis proposition is, in fact, false. Your task is to identify a set of values for the tuple $(a, b, c, m)$ that serves as a counterexample, invalidating the proposition. Which of the following options correctly demonstrates this?\n\nA. $(a, b, c, m) = (2, 5, 1, 3)$\n\nB. $(a, b, c, m) = (1, 43, 2, 7)$\n\nC. $(a, b, c, m) = (2, 6, 3, 5)$\n\nD. $(a, b, c, m) = (1, 5, 2, 4)$", "solution": "To find a counterexample for the logical implication $P \\implies Q$, we must find an instance where the premise $P$ is true, but the conclusion $Q$ is false. In this problem, the premise $P$ is the statement \"$a \\equiv b \\pmod{m}$\", and the conclusion $Q$ is the statement \"$c^a \\equiv c^b \\pmod{m}$\". We will analyze each option to see if it meets this criterion.\n\n**Option A: $(a, b, c, m) = (2, 5, 1, 3)$**\nFirst, we check the premise $P: a \\equiv b \\pmod{m}$.\nIs $2 \\equiv 5 \\pmod{3}$? We check if $5 - 2$ is divisible by $3$. Since $5 - 2 = 3$, which is divisible by $3$, the premise is TRUE.\nNext, we check the conclusion $Q: c^a \\equiv c^b \\pmod{m}$.\nIs $1^2 \\equiv 1^5 \\pmod{3}$? We calculate the values: $1^2 = 1$ and $1^5 = 1$. The congruence becomes $1 \\equiv 1 \\pmod{3}$, which is TRUE.\nSince both the premise and the conclusion are true, this is not a counterexample.\n\n**Option B: $(a, b, c, m) = (1, 43, 2, 7)$**\nFirst, we check the premise $P: a \\equiv b \\pmod{m}$.\nIs $1 \\equiv 43 \\pmod{7}$? We check if $43 - 1$ is divisible by $7$. Since $43 - 1 = 42$, and $42 = 6 \\times 7$, the premise is TRUE.\nNext, we check the conclusion $Q: c^a \\equiv c^b \\pmod{m}$.\nIs $2^1 \\equiv 2^{43} \\pmod{7}$?\nThe left side is $2^1 = 2$. So, $2^1 \\equiv 2 \\pmod{7}$.\nFor the right side, we can use Fermat's Little Theorem, which states that if $p$ is a prime number, then for any integer $c$ not divisible by $p$, we have $c^{p-1} \\equiv 1 \\pmod{p}$. Here, $p=7$ is prime and $c=2$ is not divisible by 7. So, $2^{7-1} = 2^6 \\equiv 1 \\pmod{7}$.\nWe can rewrite the exponent $43$ as $43 = 6 \\times 7 + 1$.\nSo, $2^{43} = 2^{6 \\times 7 + 1} = (2^6)^7 \\cdot 2^1$.\nTaking this modulo 7: $2^{43} \\equiv (1)^7 \\cdot 2 \\equiv 1 \\cdot 2 \\equiv 2 \\pmod{7}$.\nThe congruence $2^1 \\equiv 2^{43} \\pmod{7}$ becomes $2 \\equiv 2 \\pmod{7}$, which is TRUE.\nSince both the premise and the conclusion are true, this is not a counterexample.\n\n**Option C: $(a, b, c, m) = (2, 6, 3, 5)$**\nFirst, we check the premise $P: a \\equiv b \\pmod{m}$.\nIs $2 \\equiv 6 \\pmod{5}$? We check if $6 - 2$ is divisible by $5$. Since $6 - 2 = 4$, which is not divisible by $5$, the premise is FALSE.\nFor an instance to be a counterexample to an implication, its premise must be true. Since the premise is false, this case does not challenge the validity of the proposition, and thus is not a counterexample.\n\n**Option D: $(a, b, c, m) = (1, 5, 2, 4)$**\nFirst, we check the premise $P: a \\equiv b \\pmod{m}$.\nIs $1 \\equiv 5 \\pmod{4}$? We check if $5 - 1$ is divisible by $4$. Since $5 - 1 = 4$, which is divisible by $4$, the premise is TRUE.\nNext, we check the conclusion $Q: c^a \\equiv c^b \\pmod{m}$.\nIs $2^1 \\equiv 2^5 \\pmod{4}$?\nThe left side is $2^1 = 2$. So, $2^1 \\equiv 2 \\pmod{4}$.\nThe right side is $2^5 = 32$. To find $32 \\pmod{4}$, we note that $32 = 8 \\times 4$. Thus, $32 \\equiv 0 \\pmod{4}$.\nThe assertion $c^a \\equiv c^b \\pmod{m}$ becomes $2 \\equiv 0 \\pmod{4}$, which is FALSE.\nIn this case, the premise is TRUE and the conclusion is FALSE. This is the definition of a counterexample to the proposition $P \\implies Q$. Therefore, this option correctly invalidates the given proposition.", "answer": "$$\\boxed{D}$$", "id": "1385390"}, {"introduction": "Our exploration so far has focused on prime moduli, but many applications involve composite numbers. This problem [@problem_id:1385437] delves into the intriguing behavior of composite numbers that mimic primes, known as Fermat pseudoprimes. Solving it requires synthesizing multiple techniques—including the Chinese Remainder Theorem, modular inverses, and Fermat's Little Theorem on prime factors—showcasing how fundamental concepts combine to solve more complex problems.", "problem": "In number theory, a primary method for primality testing is based on Fermat's Little Theorem. This theorem states that if $p$ is a prime number, then for any integer $a$ not divisible by $p$, the congruence $a^{p-1} \\equiv 1 \\pmod p$ is true. The converse of this theorem, however, is not always true. There exist composite numbers $n$ that satisfy the congruence $a^{n-1} \\equiv 1 \\pmod n$ for some integer base $a$. Such numbers are referred to as Fermat pseudoprimes to base $a$.\n\nConsider the composite number $n = 91$. Your task is to perform a calculation related to this number's properties.\n\nCalculate the value of $3^{89} \\pmod{91}$. Express your answer as an integer in the range $[0, 90]$.", "solution": "Our goal is to compute the value of $3^{89} \\pmod{91}$. A direct calculation of $3^{89}$ is computationally intensive. A more efficient approach involves using the properties of modular arithmetic.\n\nFirst, we observe the modulus $n=91$. We can factor it into its prime components: $91 = 7 \\times 13$. This allows us to use the Chinese Remainder Theorem by analyzing the congruence modulo 7 and modulo 13 separately.\n\nInstead of directly computing $3^{89} \\pmod{91}$, let's first compute $3^{90} \\pmod{91}$. This will simplify the problem, as the exponent $90 = n-1$ relates to Fermat's Little Theorem.\n\nLet's compute $3^{90}$ modulo 7:\nAccording to Fermat's Little Theorem, for a prime $p$ and an integer $a$ not divisible by $p$, we have $a^{p-1} \\equiv 1 \\pmod{p}$.\nFor the prime $p=7$, we have $3^{7-1} \\equiv 3^6 \\equiv 1 \\pmod{7}$.\nThe exponent 90 can be written as $90 = 6 \\times 15$.\nSo, $3^{90} = (3^6)^{15} \\equiv 1^{15} \\equiv 1 \\pmod{7}$.\n\nNext, let's compute $3^{90}$ modulo 13:\nFor the prime $p=13$, we have $3^{13-1} \\equiv 3^{12} \\equiv 1 \\pmod{13}$.\nThe exponent 90 can be written as $90 = 12 \\times 7 + 6$.\nSo, $3^{90} = (3^{12})^7 \\times 3^6 \\equiv 1^7 \\times 3^6 \\equiv 3^6 \\pmod{13}$.\nNow we compute $3^6 \\pmod{13}$:\n$3^1 \\equiv 3 \\pmod{13}$\n$3^2 \\equiv 9 \\pmod{13}$\n$3^3 = 27 \\equiv 1 \\pmod{13}$\nTherefore, $3^6 = (3^3)^2 \\equiv 1^2 \\equiv 1 \\pmod{13}$.\n\nWe have found two congruences:\n1. $3^{90} \\equiv 1 \\pmod{7}$\n2. $3^{90} \\equiv 1 \\pmod{13}$\n\nSince 7 and 13 are coprime, the Chinese Remainder Theorem implies that these two congruences can be combined into a single congruence modulo their product, $7 \\times 13 = 91$.\nThis gives us $3^{90} \\equiv 1 \\pmod{91}$. This demonstrates that 91 is a Fermat pseudoprime to base 3.\n\nNow we can return to the original problem of finding $3^{89} \\pmod{91}$.\nWe use the result we just derived:\n$3^{90} \\equiv 1 \\pmod{91}$\nWe can rewrite the left side as:\n$3 \\times 3^{89} \\equiv 1 \\pmod{91}$\n\nTo solve for $3^{89}$, we need to find the multiplicative inverse of 3 modulo 91. Let's call this inverse $x$. We are looking for an integer $x$ such that $3x \\equiv 1 \\pmod{91}$. We can find this using the Extended Euclidean Algorithm.\nWe want to find integers $x$ and $y$ such that $3x + 91y = \\gcd(3, 91)$.\nFirst, we apply the Euclidean Algorithm:\n$91 = 30 \\times 3 + 1$\nThe algorithm terminates as the remainder is 1, so $\\gcd(3, 91) = 1$.\nNow we rearrange the equation to express 1 in terms of 91 and 3:\n$1 = 91 - 30 \\times 3$\nThis can be written as:\n$1 = 1 \\times 91 + (-30) \\times 3$\nTaking this equation modulo 91, we get:\n$1 \\equiv (-30) \\times 3 \\pmod{91}$\nSo, the multiplicative inverse of 3 modulo 91 is $-30$. To express this in the range $[0, 90]$, we calculate:\n$-30 \\pmod{91} \\equiv -30 + 91 \\pmod{91} \\equiv 61 \\pmod{91}$.\nThus, $3^{-1} \\equiv 61 \\pmod{91}$.\n\nFinally, we go back to the congruence $3 \\times 3^{89} \\equiv 1 \\pmod{91}$. We multiply both sides by the inverse of 3, which is 61:\n$61 \\times (3 \\times 3^{89}) \\equiv 61 \\times 1 \\pmod{91}$\n$(61 \\times 3) \\times 3^{89} \\equiv 61 \\pmod{91}$\nSince $61 \\times 3 = 183 \\equiv 1 \\pmod{91}$, we have:\n$1 \\times 3^{89} \\equiv 61 \\pmod{91}$\n$3^{89} \\equiv 61 \\pmod{91}$\n\nThe value of $3^{89} \\pmod{91}$ is 61.", "answer": "$$\\boxed{61}$$", "id": "1385437"}]}