{"hands_on_practices": [{"introduction": "To truly understand the Diffie-Hellman key exchange, there is no substitute for performing the calculations yourself. This first exercise [@problem_id:1363105] places you in the role of a participant in the exchange, tasking you with determining a secret integer and then deriving the final shared secret. By working through the essential steps of modular exponentiation, you will build a foundational, practical grasp of the protocol's mechanics.", "problem": "Two autonomous data centers, named Alice and Bob, need to establish a shared secret key for secure communication. They decide to use the Diffie-Hellman key exchange protocol. They publicly agree on a prime modulus $p=23$ and a primitive root (generator) $g=5$.\n\nAlice chooses a secret integer $a$ and computes her public key $A = g^a \\pmod{p}$.\nBob chooses a secret integer $b$ and computes his public key $B = g^b \\pmod{p}$.\n\nThey exchange their public keys over an insecure channel. An eavesdropper, Eve, intercepts these public keys and learns that Alice's public key is $A=17$ and Bob's public key is $B=11$. However, Eve cannot determine their secret integers $a$ and $b$ easily.\n\nAlice computes the shared secret key as $s = B^a \\pmod{p}$. Bob computes it as $s = A^b \\pmod{p}$. By protocol design, their results will be identical.\n\nYour task is to act as Alice. First, determine your secret integer $a$ by testing integer values. Then, using your secret integer $a$, calculate the final shared secret key $s$. The secret integers $a$ and $b$ are known to be positive integers. What is the value of the shared secret key $s$?", "solution": "Given the Diffie-Hellman setup with modulus $p=23$, generator $g=5$, Alice’s public key $A=17$, and Bob’s public key $B=11$, we must find Alice’s secret integer $a$ such that $A \\equiv g^{a} \\pmod{p}$, and then compute the shared secret $s \\equiv B^{a} \\pmod{p}$.\n\nTo determine $a$, solve $5^{a} \\equiv 17 \\pmod{23}$ by testing successive exponents:\n$$\n\\begin{aligned}\n5^{1} &\\equiv 5 \\pmod{23},\\\\\n5^{2} &\\equiv 25 \\equiv 2 \\pmod{23},\\\\\n5^{3} &\\equiv 2\\cdot 5=10 \\pmod{23},\\\\\n5^{4} &\\equiv 10\\cdot 5=50 \\equiv 4 \\pmod{23},\\\\\n5^{5} &\\equiv 4\\cdot 5=20 \\pmod{23},\\\\\n5^{6} &\\equiv 20\\cdot 5=100 \\equiv 8 \\pmod{23},\\\\\n5^{7} &\\equiv 8\\cdot 5=40 \\equiv 17 \\pmod{23}.\n\\end{aligned}\n$$\nThus $a=7$.\n\nCompute the shared secret $s \\equiv B^{a} \\equiv 11^{7} \\pmod{23}$ using exponentiation by squaring:\n$$\n11^{2} \\equiv 121 \\equiv 6 \\pmod{23},\\quad\n11^{4} \\equiv 6^{2}=36 \\equiv 13 \\pmod{23},\n$$\nand\n$$\n11^{7}=11^{4}\\cdot 11^{2}\\cdot 11 \\equiv 13\\cdot 6\\cdot 11 \\pmod{23}.\n$$\nEvaluate the product modulo $23$:\n$$\n13\\cdot 6=78 \\equiv 9 \\pmod{23},\\quad 9\\cdot 11=99 \\equiv 7 \\pmod{23}.\n$$\nTherefore, $s \\equiv 7 \\pmod{23}$, so the shared secret key is $s=7$.\n\n(Optional verification via the group structure: since $5$ is a primitive root modulo $23$, there exists $b$ with $5^{b}\\equiv 11$. Continuing the table shows $b=9$, so $s\\equiv 5^{ab}=5^{63}\\equiv 5^{19}\\equiv 7 \\pmod{23}$, matching the result.)", "answer": "$$\\boxed{7}$$", "id": "1363105"}, {"introduction": "The security of cryptographic protocols hinges on precise mathematical operations. A common conceptual error when first learning Diffie-Hellman is to confuse the correct formula for the shared secret, $s \\equiv B^a \\pmod{p}$, with a simpler but incorrect operation like modular multiplication, $s \\equiv a \\cdot B \\pmod{p}$. This exercise [@problem_id:1363053] presents a flawed calculation using the latter and asks you to pinpoint the mistake, reinforcing the critical role that exponentiation plays in the protocol.", "problem": "Two students, Alice and Bob, are using the Diffie-Hellman key exchange protocol to establish a shared secret key. They publicly agree on a prime modulus $p = 23$ and a generator $g = 5$.\n\nAlice chooses a secret private key $a = 4$.\nBob chooses a secret private key $b = 7$.\n\nA third student, Charlie, observes the public information and tries to follow the protocol steps to determine the final shared secret from Alice's perspective. Charlie documents the process as follows:\n\n**Step 1:** Alice computes her public key $A$ using the formula $A \\equiv g^a \\pmod p$.\nCalculation: $A \\equiv 5^4 \\pmod{23}$. Since $5^4 = 625$ and $625 = 27 \\times 23 + 4$, Alice's public key is $A=4$.\n\n**Step 2:** Bob computes his public key $B$ using the formula $B \\equiv g^b \\pmod p$.\nCalculation: $B \\equiv 5^7 \\pmod{23}$. Since $5^7 = 78125$ and $78125 = 3396 \\times 23 + 17$, Bob's public key is $B=17$.\n\n**Step 3:** Alice and Bob exchange their public keys. Alice now knows $B=17$, and Bob knows $A=4$.\n\n**Step 4:** To compute the shared secret $s$, Alice uses her private key $a$ and Bob's public key $B$. Charlie assumes the formula for this combination is $s \\equiv a \\cdot B \\pmod p$.\n\n**Step 5:** Charlie performs the calculation based on the formula from Step 4.\nCalculation: $s \\equiv 4 \\cdot 17 \\pmod{23}$. Since $4 \\cdot 17 = 68$ and $68 = 2 \\times 23 + 22$, the shared secret is $s=22$.\n\nIn which step does the first conceptual error in the application of the Diffie-Hellman protocol occur?\n\nA. Step 1: The calculation of Alice's public key $A$.\n\nB. Step 2: The calculation of Bob's public key $B$.\n\nC. Step 3: The exchange of public keys.\n\nD. Step 4: The formula used to compute the shared secret $s$.\n\nE. Step 5: The numerical evaluation of the shared secret $s$.", "solution": "In the Diffie-Hellman key exchange, the public parameters are a prime modulus $p$ and a generator $g$ of a multiplicative subgroup modulo $p$. Each party selects a private key (Alice: $a$, Bob: $b$), computes a public key using exponentiation modulo $p$, exchanges public keys, and then computes the shared secret by exponentiating the received public key with their own private exponent modulo $p$:\n$$\nA \\equiv g^{a} \\pmod{p}, \\quad B \\equiv g^{b} \\pmod{p}, \\quad s \\equiv B^{a} \\pmod{p} \\equiv A^{b} \\pmod{p}.\n$$\n\nVerify Step 1:\nAlice computes $A \\equiv g^{a} \\pmod{p}$ with $g=5$, $a=4$, $p=23$.\nCompute $5^{4} \\pmod{23}$. Note $5^{2}=25 \\equiv 2 \\pmod{23}$, hence $5^{4} \\equiv (5^{2})^{2} \\equiv 2^{2} \\equiv 4 \\pmod{23}$. Thus $A=4$, so Step 1 is correct.\n\nVerify Step 2:\nBob computes $B \\equiv g^{b} \\pmod{p}$ with $g=5$, $b=7$, $p=23$.\nCompute $5^{7} \\pmod{23}$. Write $5^{7}=5^{4}\\cdot 5^{3}$. From above, $5^{4} \\equiv 4 \\pmod{23}$ and $5^{3}=125 \\equiv 125-5\\cdot 23 \\equiv 10 \\pmod{23}$. Therefore $5^{7} \\equiv 4 \\cdot 10 \\equiv 40 \\equiv 17 \\pmod{23}$. Thus $B=17$, so Step 2 is correct.\n\nVerify Step 3:\nExchanging public keys is a correct procedural step; there is no conceptual error in exchanging $A$ and $B$.\n\nExamine Step 4:\nThe correct Diffie-Hellman shared secret computation is $s \\equiv B^{a} \\pmod{p}$ from Alice’s perspective (or equivalently $s \\equiv A^{b} \\pmod{p}$ from Bob’s perspective). The formula $s \\equiv a \\cdot B \\pmod{p}$ replaces modular exponentiation with modular multiplication and is not the Diffie-Hellman operation. Therefore, the first conceptual error is the formula used in Step 4.\n\nFor completeness, the correct shared secret would be $s \\equiv 17^{4} \\pmod{23}$. Since $17 \\equiv -6 \\pmod{23}$, $17^{2} \\equiv 36 \\equiv 13 \\pmod{23}$ and $17^{4} \\equiv 13^{2} \\equiv 169 \\equiv 8 \\pmod{23}$. This confirms that the multiplication in Step 5 is based on the incorrect Step 4, but the first error occurs at Step 4.", "answer": "$$\\boxed{D}$$", "id": "1363053"}, {"introduction": "The strength of the Diffie-Hellman exchange depends critically on the careful selection of its public parameters, the prime $p$ and the generator $g$. This problem [@problem_id:1363093] explores a catastrophic failure that occurs when a poor generator is chosen. By analyzing the outcome when $g=1$, you will see firsthand why the generator must be chosen to produce a large group of numbers, a key principle that underpins the protocol's security.", "problem": "Alice and Bob decide to establish a secure communication channel using the Diffie-Hellman key exchange protocol. They publicly agree on a large prime number $p > 100$ and a generator $g$. Following the protocol, Alice chooses a secret integer $a$ where $1 < a < p-1$, and Bob chooses a secret integer $b$ where $1 < b < p-1$.\n\nAlice computes her public key $A$ using the formula $A = g^a \\pmod{p}$.\nBob computes his public key $B$ using the formula $B = g^b \\pmod{p}$.\n\nAfter exchanging their public keys, Alice computes the shared secret key $s$ as $s = B^a \\pmod{p}$, and Bob computes it as $s = A^b \\pmod{p}$.\n\nIn their setup, they make a fundamental error by choosing the generator $g=1$. Assuming their private keys $a$ and $b$ are different from each other and from 1, which of the following statements correctly describes the outcome of their key exchange?\n\nA. Both public keys, $A$ and $B$, will be equal to 1, and the shared secret $s$ will also be equal to 1.\n\nB. The public keys $A$ and $B$ will be different from 1 and will depend on the private keys $a$ and $b$ respectively, but the shared secret $s$ will be 1.\n\nC. Both public keys, $A$ and $B$, will be equal to 1, but the shared secret $s$ will depend on the product of the private keys, $ab$.\n\nD. Both the public keys and the shared secret will be equal to $p-1$.\n\nE. The protocol will fail, and it will be impossible for Alice and Bob to compute a shared secret because the generator is invalid.", "solution": "We work in the multiplicative group of units modulo the prime $p$, commonly denoted $(\\mathbb{Z}/p\\mathbb{Z})^{\\times}$. In Diffie-Hellman, a generator $g$ of this cyclic group is chosen so that exponentiation covers the whole group. Here, the fundamental error is choosing $g=1$, which is the identity element and has order $1$, hence it generates only the trivial subgroup $\\{1\\}$.\n\nBy definition of the public keys:\n$$\nA \\equiv g^{a} \\pmod{p}, \\quad B \\equiv g^{b} \\pmod{p}.\n$$\nWith $g=1$, for any integers $a$ and $b$,\n$$\nA \\equiv 1^{a} \\equiv 1 \\pmod{p}, \\quad B \\equiv 1^{b} \\equiv 1 \\pmod{p}.\n$$\n\nAfter exchanging public keys, the shared secret computed by Alice is\n$$\ns \\equiv B^{a} \\equiv 1^{a} \\equiv 1 \\pmod{p},\n$$\nand by Bob is\n$$\ns \\equiv A^{b} \\equiv 1^{b} \\equiv 1 \\pmod{p}.\n$$\nThese are equal and independent of $a$ and $b$.\n\nTherefore, both public keys are $1$, and the shared secret is also $1$. This matches option A.", "answer": "$$\\boxed{A}$$", "id": "1363093"}]}