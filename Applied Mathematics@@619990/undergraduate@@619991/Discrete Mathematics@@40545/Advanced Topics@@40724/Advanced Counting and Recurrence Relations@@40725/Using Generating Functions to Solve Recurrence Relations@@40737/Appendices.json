{"hands_on_practices": [{"introduction": "Let's begin with a foundational example that illustrates the core mechanics of using generating functions. This practice involves a first-order linear recurrence relation, a common structure found when modeling phenomena like population dynamics or financial growth. By translating this recurrence into an algebraic equation for its generating function, $A(x)$, we will demonstrate the standard workflow: solve for $A(x)$ and then use partial fraction decomposition to retrieve the explicit formula for the sequence's terms [@problem_id:1413569].", "problem": "In a biotechnology lab, a team is studying the population dynamics of a newly engineered bacterial strain. The mass of the bacterial culture, denoted by $a_n$ in milligrams (mg), is measured at the end of each day, $n$. The experiment starts on day $n=0$ with an initial mass of $a_0 = 2$ mg. The culture undergoes a daily growth cycle. Each day, the mass of the bacteria first increases, becoming five times the mass recorded at the end of the previous day. After this growth, the scientists harvest a constant amount of 6 mg for analysis. This process defines the mass for the current day.\n\nDetermine a closed-form expression for $a_n$, the mass of the bacterial culture at the end of day $n$, for any integer $n \\ge 0$.", "solution": "The problem describes the recurrence relation $a_n = 5a_{n-1} - 6$ for $n \\ge 1$, with the initial condition $a_0 = 2$.\n\nLet $A(x) = \\sum_{n=0}^{\\infty} a_n x^n$ be the ordinary generating function for the sequence $\\{a_n\\}$. We multiply the recurrence by $x^n$ and sum over all valid values of $n$, which is $n \\ge 1$:\n$$ \\sum_{n=1}^{\\infty} a_n x^n = \\sum_{n=1}^{\\infty} (5a_{n-1} - 6) x^n = 5\\sum_{n=1}^{\\infty} a_{n-1} x^n - 6\\sum_{n=1}^{\\infty} x^n $$\nNow we express each sum in terms of $A(x)$.\nThe left side is $\\sum_{n=1}^{\\infty} a_n x^n = (\\sum_{n=0}^{\\infty} a_n x^n) - a_0 = A(x) - 2$.\nThe first term on the right side is $5x \\sum_{n=1}^{\\infty} a_{n-1} x^{n-1} = 5x \\sum_{k=0}^{\\infty} a_k x^k = 5x A(x)$.\nThe second term on the right is a geometric series: $-6 \\sum_{n=1}^{\\infty} x^n = -6 \\left( \\frac{1}{1-x} - 1 \\right) = -6 \\left( \\frac{1 - (1-x)}{1-x} \\right) = \\frac{-6x}{1-x}$.\n\nSubstituting these expressions back into the equation gives:\n$$ A(x) - 2 = 5x A(x) - \\frac{6x}{1-x} $$\nNow, we solve for $A(x)$:\n$$ A(x) - 5x A(x) = 2 - \\frac{6x}{1-x} $$\n$$ A(x)(1 - 5x) = \\frac{2(1-x) - 6x}{1-x} = \\frac{2 - 2x - 6x}{1-x} = \\frac{2 - 8x}{1-x} $$\n$$ A(x) = \\frac{2 - 8x}{(1 - 5x)(1 - x)} $$\nTo find $a_n$, we use partial fraction decomposition:\n$$ \\frac{2 - 8x}{(1 - 5x)(1 - x)} = \\frac{C_1}{1 - 5x} + \\frac{C_2}{1 - x} $$\nUsing the cover-up method:\nFor $C_1$, set $x = 1/5$: $C_1 = \\frac{2 - 8/5}{1 - 1/5} = \\frac{2/5}{4/5} = \\frac{1}{2}$.\nFor $C_2$, set $x = 1$: $C_2 = \\frac{2 - 8}{1 - 5} = \\frac{-6}{-4} = \\frac{3}{2}$.\n\nSo, we have:\n$$ A(x) = \\frac{1/2}{1 - 5x} + \\frac{3/2}{1 - x} $$\nWe expand each term as a geometric series:\n$$ A(x) = \\frac{1}{2} \\sum_{n=0}^{\\infty} (5x)^n + \\frac{3}{2} \\sum_{n=0}^{\\infty} x^n = \\sum_{n=0}^{\\infty} \\left(\\frac{1}{2} \\cdot 5^n + \\frac{3}{2}\\right) x^n $$\nThe coefficient of $x^n$ is $a_n$. Therefore, the closed-form expression is:\n$$ a_n = \\frac{1}{2} \\cdot 5^n + \\frac{3}{2} = \\frac{1}{2}(5^n + 3) $$", "answer": "$$\\boxed{\\frac{1}{2}\\left(5^{n}+3\\right)}$$", "id": "1413569"}, {"introduction": "Recurrence relations can sometimes be more complex, involving summaries over all previous terms, which appear in models of cumulative effects where a system is influenced by its entire history. This practice demonstrates the unique power of generating functions, showing how a summation term, which represents a convolution of sequences, elegantly transforms into a simple product of their respective generating functions [@problem_id:1413554]. This technique often simplifies problems that would be cumbersome to solve using other methods.", "problem": "In a simulation of digital life, a new type of self-replicating organism is studied. Let $a_n$ denote the number of distinct variants of this organism at generation $n$. At the beginning of the simulation (generation $n=0$), there is a single progenitor variant, so we have $a_0 = 1$.\n\nFor any subsequent generation $n \\ge 1$, new variants are formed through two distinct processes:\n1.  Each variant from the immediately preceding generation, $n-1$, gives rise to a single new, unique variant.\n2.  Each variant that has ever existed up to generation $n-1$ (inclusive), from generation $k=0$ to $k=n-1$, contributes to the creation of one additional new, unique variant.\n\nThe total number of variants at generation $n$, denoted by $a_n$, is the sum of the variants created by these two processes. Find a closed-form expression for $a_n$ for $n \\ge 1$ in terms of $n$.", "solution": "The process described in the problem yields the following recurrence relation. The number of variants $a_n$ at generation $n \\ge 1$ is the sum of variants from process 1 ($a_{n-1}$) and process 2 ($\\sum_{k=0}^{n-1} a_k$).\nThus, we have the recurrence relation:\n$$a_n = a_{n-1} + \\sum_{k=0}^{n-1} a_k, \\quad \\text{for } n \\ge 1$$\nwith the initial condition $a_0 = 1$.\n\nWe will solve this recurrence relation using generating functions. Let $A(x)$ be the ordinary generating function for the sequence $\\{a_n\\}$, defined as:\n$$A(x) = \\sum_{n=0}^{\\infty} a_n x^n = a_0 + a_1 x + a_2 x^2 + \\dots$$\n\nOur goal is to find an algebraic expression for $A(x)$ and then extract the coefficient $a_n$. We multiply the recurrence relation by $x^n$ and sum over all valid values of $n$, which is $n \\ge 1$.\n$$ \\sum_{n=1}^{\\infty} a_n x^n = \\sum_{n=1}^{\\infty} a_{n-1} x^n + \\sum_{n=1}^{\\infty} \\left( \\sum_{k=0}^{n-1} a_k \\right) x^n $$\n\nLet's analyze each term in this equation.\nThe left-hand side is $\\sum_{n=1}^{\\infty} a_n x^n = A(x) - a_0 = A(x) - 1$.\n\nThe first term on the right-hand side is $\\sum_{n=1}^{\\infty} a_{n-1} x^n$. By factoring out $x$, we get $x \\sum_{n=1}^{\\infty} a_{n-1} x^{n-1}$. Letting $m = n-1$, this becomes $x \\sum_{m=0}^{\\infty} a_m x^m = x A(x)$.\n\nThe second term on the right-hand side is $\\sum_{n=1}^{\\infty} \\left( \\sum_{k=0}^{n-1} a_k \\right) x^n$. Let $s_m = \\sum_{k=0}^{m} a_k$. The term is $\\sum_{n=1}^{\\infty} s_{n-1} x^n = x \\sum_{n=1}^{\\infty} s_{n-1} x^{n-1} = x \\sum_{m=0}^{\\infty} s_m x^m$.\nThe sequence $\\{s_m\\}$ is the sequence of partial sums of $\\{a_n\\}$. The generating function for $\\{s_m\\}$, let's call it $S(x)$, is related to $A(x)$. The sequence $\\{s_m\\}$ is the convolution of the sequence $\\{a_n\\}$ and the constant sequence $\\{1, 1, 1, \\dots\\}$. The generating function for the constant sequence is $\\frac{1}{1-x}$. Therefore, $S(x) = A(x) \\cdot \\frac{1}{1-x}$.\nSo, the second term on the right-hand side becomes $x S(x) = \\frac{x A(x)}{1-x}$.\n\nSubstituting these expressions back into the main equation:\n$$ A(x) - 1 = x A(x) + \\frac{x A(x)}{1-x} $$\n\nNow, we solve for $A(x)$.\n$$ A(x) - 1 = A(x) \\left( x + \\frac{x}{1-x} \\right) $$\n$$ A(x) - 1 = A(x) \\left( \\frac{x(1-x)+x}{1-x} \\right) = A(x) \\left( \\frac{x-x^2+x}{1-x} \\right) = A(x) \\left( \\frac{2x-x^2}{1-x} \\right) $$\n$$ A(x) \\left( 1 - \\frac{2x-x^2}{1-x} \\right) = 1 $$\n$$ A(x) \\left( \\frac{1-x - (2x-x^2)}{1-x} \\right) = 1 $$\n$$ A(x) \\left( \\frac{1-3x+x^2}{1-x} \\right) = 1 $$\n$$ A(x) = \\frac{1-x}{1-3x+x^2} $$\n\nTo find $a_n$, we expand $A(x)$ into a power series. The roots of the denominator's reciprocal polynomial $t^2 - 3t + 1 = 0$ are $t = \\frac{3 \\pm \\sqrt{9-4}}{2} = \\frac{3 \\pm \\sqrt{5}}{2}$.\nLet us define the golden ratio $\\phi = \\frac{1+\\sqrt{5}}{2}$ and its conjugate $\\psi = \\frac{1-\\sqrt{5}}{2}$. Let the roots of $t^2-3t+1=0$ be $r_1 = \\frac{3+\\sqrt{5}}{2}$ and $r_2 = \\frac{3-\\sqrt{5}}{2}$. Notice that $r_1 = \\phi^2$ and $r_2 = \\psi^2$.\nSo, the denominator can be factored as $1-3x+x^2 = (1-r_1 x)(1-r_2 x)$.\nWe want to decompose $A(x)$:\n$$ \\frac{1-x}{(1-r_1 x)(1-r_2 x)} = \\frac{C_1}{1-r_1 x} + \\frac{C_2}{1-r_2 x} $$\nUsing the cover-up method:\n$$ C_1 = \\left. \\frac{1-x}{1-r_2 x} \\right|_{x=1/r_1} = \\frac{1 - 1/r_1}{1 - r_2/r_1} = \\frac{(r_1-1)/r_1}{(r_1-r_2)/r_1} = \\frac{r_1-1}{r_1-r_2} $$\nWe have $r_1 - 1 = \\frac{3+\\sqrt{5}}{2} - 1 = \\frac{1+\\sqrt{5}}{2} = \\phi$, and $r_1 - r_2 = \\sqrt{5}$.\nSo, $C_1 = \\frac{\\phi}{\\sqrt{5}}$.\n$$ C_2 = \\left. \\frac{1-x}{1-r_1 x} \\right|_{x=1/r_2} = \\frac{1 - 1/r_2}{1 - r_1/r_2} = \\frac{(r_2-1)/r_2}{(r_2-r_1)/r_2} = \\frac{r_2-1}{r_2-r_1} $$\nWe have $r_2 - 1 = \\frac{3-\\sqrt{5}}{2} - 1 = \\frac{1-\\sqrt{5}}{2} = \\psi$, and $r_2 - r_1 = -\\sqrt{5}$.\nSo, $C_2 = \\frac{\\psi}{-\\sqrt{5}}$.\n\nTherefore, the generating function is:\n$$ A(x) = \\frac{\\phi/\\sqrt{5}}{1-r_1 x} - \\frac{\\psi/\\sqrt{5}}{1-r_2 x} $$\nWe expand each term using the geometric series formula $\\frac{1}{1-u} = \\sum_{n=0}^{\\infty} u^n$:\n$$ A(x) = \\frac{\\phi}{\\sqrt{5}} \\sum_{n=0}^{\\infty} (r_1 x)^n - \\frac{\\psi}{\\sqrt{5}} \\sum_{n=0}^{\\infty} (r_2 x)^n = \\sum_{n=0}^{\\infty} \\frac{1}{\\sqrt{5}} (\\phi r_1^n - \\psi r_2^n) x^n $$\nThe coefficient of $x^n$ is $a_n$:\n$$ a_n = \\frac{1}{\\sqrt{5}} (\\phi r_1^n - \\psi r_2^n) $$\nSubstituting $r_1 = \\phi^2$ and $r_2 = \\psi^2$:\n$$ a_n = \\frac{1}{\\sqrt{5}} (\\phi (\\phi^2)^n - \\psi (\\psi^2)^n) = \\frac{1}{\\sqrt{5}} (\\phi^{2n+1} - \\psi^{2n+1}) $$\nThis formula is known as Binet's formula for the Fibonacci numbers, specifically for the term $F_{2n+1}$.\nSubstituting the values of $\\phi$ and $\\psi$:\n$$ a_n = \\frac{1}{\\sqrt{5}} \\left[ \\left(\\frac{1+\\sqrt{5}}{2}\\right)^{2n+1} - \\left(\\frac{1-\\sqrt{5}}{2}\\right)^{2n+1} \\right] $$\nThis closed-form expression is valid for all $n \\ge 0$, and therefore for $n \\ge 1$ as requested.", "answer": "$$\\boxed{\\frac{1}{\\sqrt{5}} \\left[ \\left(\\frac{1+\\sqrt{5}}{2}\\right)^{2n+1} - \\left(\\frac{1-\\sqrt{5}}{2}\\right)^{2n+1} \\right]}$$", "id": "1413554"}, {"introduction": "Our final practice ventures into more advanced territory, tackling recurrences that involve variable coefficients like $n$ and systems of coupled equations. For such problems, the standard ordinary generating function is often insufficient, leading us to its powerful sibling, the Exponential Generating Function (EGF). In this exercise, you will see how EGFs transform a system of mutual recurrences into a system of linear differential equations, which can then be solved to find the closed-form solutions for the sequences [@problem_id:1413591].", "problem": "Consider two sequences of numbers, $\\{a_n\\}_{n \\ge 0}$ and $\\{b_n\\}_{n \\ge 0}$, that are coupled through a system of recurrence relations. The sequences are defined by the initial values $a_0 = 1$ and $b_0 = 1$. For all integers $n \\ge 1$, the terms of the sequences are generated by the following mutual recurrences:\n$$a_n = a_{n-1} + n b_{n-1}$$\n$$b_n = n a_{n-1} + b_{n-1}$$\nFind a closed-form expression for the general term $a_n$ as a function of $n$.", "solution": "To solve this system of recurrence relations, we use the method of exponential generating functions (EGFs). Let the EGFs for the sequences $\\{a_n\\}$ and $\\{b_n\\}$ be $A(x)$ and $B(x)$ respectively, defined as:\n$$A(x) = \\sum_{n=0}^{\\infty} a_n \\frac{x^n}{n!}$$\n$$B(x) = \\sum_{n=0}^{\\infty} b_n \\frac{x^n}{n!}$$\nOur goal is to transform the recurrences into equations involving $A(x)$ and $B(x)$. We re-index the recurrences to be in terms of $a_{n+1}$ and $b_{n+1}$ for $n \\ge 0$:\n$$a_{n+1} = a_n + (n+1)b_n$$\n$$b_{n+1} = (n+1)a_n + b_n$$\nNow, we translate this system into the language of EGFs. The EGF for $\\{f_{n+1}\\}$ is $F'(x)$, the EGF for $\\{f_n\\}$ is $F(x)$, and the EGF for $\\{(n+1)f_n\\}$ is $(x F(x))' = F(x) + x F'(x)$.\nApplying these rules, we get a system of ordinary differential equations:\n1) $A'(x) = A(x) + (B(x) + xB'(x))$\n2) $B'(x) = (A(x) + xA'(x)) + B(x)$\n\nLet's subtract the two equations:\n$A'(x) - B'(x) = (A(x) - B(x)) + (xB'(x) - xA'(x))$\n$(A'(x) - B'(x)) = (A(x) - B(x)) - x (A'(x) - B'(x))$\n$(1+x)(A'(x) - B'(x)) = (A(x) - B(x))$\nLet $S(x) = A(x) - B(x)$. The equation becomes $(1+x)S'(x) = S(x)$.\nThis is a separable differential equation: $\\frac{S'(x)}{S(x)} = \\frac{1}{1+x}$.\nIntegrating both sides, we get $\\ln|S(x)| = \\ln|1+x| + C$, which implies $S(x) = K(1+x)$.\nTo find the constant $K$, we use the initial conditions: $a_0 = 1$ and $b_0 = 1$.\n$A(0) = a_0 = 1$ and $B(0) = b_0 = 1$.\nSo, $S(0) = A(0) - B(0) = 1 - 1 = 0$.\nSubstituting this into our solution for $S(x)$: $S(0) = K(1+0) \\implies 0 = K$.\nTherefore, $K=0$, which means $S(x) = 0$ for all $x$. This implies $A(x) = B(x)$.\n\nNow that we know the two generating functions are identical, we can substitute $B(x) = A(x)$ and $B'(x) = A'(x)$ into either of the differential equations. Let's use equation (1):\n$A'(x) = A(x) + A(x) + x A'(x)$\n$A'(x) = 2A(x) + x A'(x)$\n$A'(x) (1-x) = 2A(x)$\nThis is another separable ODE:\n$$\\frac{A'(x)}{A(x)} = \\frac{2}{1-x}$$\nIntegrating both sides with respect to $x$:\n$$\\int \\frac{dA}{A} = \\int \\frac{2}{1-x} dx$$\n$$\\ln|A(x)| = -2 \\ln|1-x| + C_0$$\n$$A(x) = e^{C_0} (1-x)^{-2} = C_1 (1-x)^{-2}$$\nTo find the constant $C_1$, we use the initial condition $A(0) = a_0 = 1$.\n$$A(0) = C_1 (1-0)^{-2} \\implies 1 = C_1$$\nSo, the exponential generating function for $\\{a_n\\}$ is:\n$$A(x) = \\frac{1}{(1-x)^2}$$\nOur final step is to extract the coefficient $a_n$ from this function. We can find the Taylor series expansion of $A(x)$ around $x=0$. Using the generalized binomial theorem:\n$$A(x) = (1-x)^{-2} = \\sum_{n=0}^{\\infty} \\binom{-2}{n} (-x)^n$$\nThe binomial coefficient can be simplified:\n$$\\binom{-2}{n} = \\frac{(-2)(-3)\\dots(-2-n+1)}{n!} = \\frac{(-1)^n (2)(3)\\dots(n+1)}{n!} = (-1)^n \\frac{(n+1)!}{n!} = (-1)^n (n+1)$$\nSubstituting this back into the series expansion:\n$$A(x) = \\sum_{n=0}^{\\infty} (-1)^n (n+1) (-x)^n = \\sum_{n=0}^{\\infty} (n+1) x^n$$\nWe have now found the power series for $A(x)$. By definition, $A(x)$ is an exponential generating function, so we must equate the coefficients of the power series with the terms of the EGF definition:\n$$A(x) = \\sum_{n=0}^{\\infty} a_n \\frac{x^n}{n!} = \\sum_{n=0}^{\\infty} (n+1) x^n$$\nBy comparing the coefficients of $x^n$ on both sides, we get:\n$$\\frac{a_n}{n!} = n+1$$\nSolving for $a_n$ gives the desired closed-form expression:\n$$a_n = (n+1) \\cdot n!$$\nThis simplifies to:\n$$a_n = (n+1)!$$\nSince we found $A(x)=B(x)$, the same formula holds for $b_n$, i.e., $b_n = (n+1)!$.", "answer": "$$\\boxed{(n+1)!}$$", "id": "1413591"}]}