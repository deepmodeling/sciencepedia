{"hands_on_practices": [{"introduction": "The Ornstein-Uhlenbeck (OU) process is a cornerstone of stochastic modeling, describing phenomena from the velocity of a particle in a fluid to fluctuating financial interest rates. This first practice provides a complete workout of its equilibrium properties. By explicitly solving the SDE to find its transition probability density and invariant measure, you will verify the principle of detailed balance from the ground up, solidifying your understanding of what it means for a process to be reversible [@problem_id:3072636].", "problem": "Consider the one-dimensional Ornstein–Uhlenbeck (OU) process, defined as the unique strong solution to the linear stochastic differential equation (SDE)\n$$\n\\mathrm{d}X_t = -\\gamma X_t \\,\\mathrm{d}t + \\sigma \\,\\mathrm{d}W_t, \\qquad X_0 = x \\in \\mathbb{R},\n$$\nwhere $\\gamma>0$ and $\\sigma>0$ are constants, and $(W_t)_{t\\ge 0}$ is a standard one-dimensional Brownian motion. Starting from core principles of stochastic calculus and the properties of linear SDEs, do the following:\n\n1. Derive an explicit expression for the Markov semigroup $(P_t)_{t\\ge 0}$ acting on bounded measurable test functions $f:\\mathbb{R}\\to\\mathbb{R}$ via\n$$\n(P_t f)(x) = \\mathbb{E}_x[f(X_t)],\n$$\nby obtaining the transition density kernel $p_t(x,y)$ such that\n$$\n(P_t f)(x) = \\int_{\\mathbb{R}} f(y)\\, p_t(x,y)\\,\\mathrm{d}y.\n$$\n\n2. Identify the invariant probability density $\\pi(y)$ for this process and, using the transition density you derived, verify the detailed balance condition by checking the symmetry relation\n$$\n\\pi(x)\\, p_t(x,y) = \\pi(y)\\, p_t(y,x) \\quad \\text{for all } x,y \\in \\mathbb{R}, \\; t>0.\n$$\n\nYour final answer must be a single closed-form analytic expression for the transition density $p_t(x,y)$ of the OU process. No numerical rounding is required.", "solution": "The problem statement has been validated and is deemed sound. It is a well-posed problem in the theory of stochastic differential equations, specifically concerning the Ornstein–Uhlenbeck process, its transition dynamics, and its equilibrium properties. The problem is scientifically grounded, self-contained, and objective. We may now proceed with a formal derivation.\n\nThe problem centers on the one-dimensional Ornstein–Uhlenbeck (OU) process, which is the solution to the linear stochastic differential equation (SDE):\n$$\n\\mathrm{d}X_t = -\\gamma X_t \\,\\mathrm{d}t + \\sigma \\,\\mathrm{d}W_t, \\qquad X_0 = x\n$$\nwhere $\\gamma > 0$ and $\\sigma > 0$ are positive constants.\n\n**1. Derivation of the Transition Density $p_t(x,y)$**\n\nTo find the transition density, we first solve the SDE for $X_t$. This is a linear SDE and can be solved using an integrating factor. Let's define an integrating factor $I_t = \\exp(\\gamma t)$. We consider the process $Y_t = I_t X_t = \\exp(\\gamma t) X_t$. Using Itô's product rule for the differential $\\mathrm{d}Y_t = \\mathrm{d}(\\exp(\\gamma t) X_t)$:\n$$\n\\mathrm{d}Y_t = (\\mathrm{d}\\exp(\\gamma t))X_t + \\exp(\\gamma t)\\mathrm{d}X_t\n$$\nSince $\\exp(\\gamma t)$ is a deterministic function of time, its differential is $\\mathrm{d}\\exp(\\gamma t) = \\gamma \\exp(\\gamma t)\\,\\mathrm{d}t$. Substituting this and the SDE for $\\mathrm{d}X_t$:\n$$\n\\mathrm{d}Y_t = (\\gamma \\exp(\\gamma t) X_t) \\,\\mathrm{d}t + \\exp(\\gamma t) (-\\gamma X_t \\,\\mathrm{d}t + \\sigma \\,\\mathrm{d}W_t)\n$$\nThe terms involving $X_t \\,\\mathrm{d}t$ cancel out:\n$$\n\\mathrm{d}Y_t = \\gamma \\exp(\\gamma t) X_t \\,\\mathrm{d}t - \\gamma \\exp(\\gamma t) X_t \\,\\mathrm{d}t + \\sigma \\exp(\\gamma t) \\,\\mathrm{d}W_t = \\sigma \\exp(\\gamma t) \\,\\mathrm{d}W_t\n$$\nIntegrating from $s=0$ to $s=t$:\n$$\nY_t - Y_0 = \\int_0^t \\sigma \\exp(\\gamma s) \\,\\mathrm{d}W_s\n$$\nSubstituting back $Y_t = \\exp(\\gamma t) X_t$ and $Y_0 = \\exp(0) X_0 = x$:\n$$\n\\exp(\\gamma t) X_t - x = \\sigma \\int_0^t \\exp(\\gamma s) \\,\\mathrm{d}W_s\n$$\nSolving for $X_t$ gives the explicit solution:\n$$\nX_t = x \\exp(-\\gamma t) + \\sigma \\exp(-\\gamma t) \\int_0^t \\exp(\\gamma s) \\,\\mathrm{d}W_s\n$$\nThis can be rewritten by changing the integration variable in the stochastic integral:\n$$\nX_t = x \\exp(-\\gamma t) + \\sigma \\int_0^t \\exp(-\\gamma(t-s)) \\,\\mathrm{d}W_s\n$$\nFrom this expression, we can determine the distribution of $X_t$ conditional on $X_0 = x$. The first term, $x \\exp(-\\gamma t)$, is deterministic. The second term is an Itô integral with a deterministic integrand. A key property of the Itô integral is that for a square-integrable deterministic function $g(s)$, the random variable $I = \\int_0^t g(s) \\,\\mathrm{d}W_s$ is a Gaussian random variable with mean $0$ and variance $\\int_0^t g(s)^2 \\,\\mathrm{d}s$.\n\nTherefore, $X_t$ is a Gaussian random variable, as it is the sum of a constant and a Gaussian random variable. Its conditional mean is:\n$$\n\\mathbb{E}[X_t | X_0 = x] = \\mathbb{E}[x \\exp(-\\gamma t)] + \\mathbb{E}\\left[\\sigma \\int_0^t \\exp(-\\gamma(t-s)) \\,\\mathrm{d}W_s\\right] = x \\exp(-\\gamma t) + 0 = x \\exp(-\\gamma t)\n$$\nIts conditional variance is:\n$$\n\\mathrm{Var}(X_t | X_0 = x) = \\mathrm{Var}\\left(x \\exp(-\\gamma t) + \\sigma \\int_0^t \\exp(-\\gamma(t-s)) \\,\\mathrm{d}W_s\\right)\n$$\n$$\n= \\mathrm{Var}\\left(\\sigma \\int_0^t \\exp(-\\gamma(t-s)) \\,\\mathrm{d}W_s\\right) = \\sigma^2 \\int_0^t (\\exp(-\\gamma(t-s)))^2 \\,\\mathrm{d}s\n$$\n$$\n= \\sigma^2 \\int_0^t \\exp(-2\\gamma(t-s)) \\,\\mathrm{d}s = \\sigma^2 \\exp(-2\\gamma t) \\int_0^t \\exp(2\\gamma s) \\,\\mathrm{d}s\n$$\n$$\n= \\sigma^2 \\exp(-2\\gamma t) \\left[\\frac{\\exp(2\\gamma s)}{2\\gamma}\\right]_0^t = \\sigma^2 \\exp(-2\\gamma t) \\left(\\frac{\\exp(2\\gamma t) - 1}{2\\gamma}\\right)\n$$\n$$\n= \\frac{\\sigma^2}{2\\gamma} (1 - \\exp(-2\\gamma t))\n$$\nSo, the conditional distribution of $X_t$ given $X_0=x$ is a normal distribution:\n$$\nX_t | X_0=x \\sim \\mathcal{N}\\left(x \\exp(-\\gamma t), \\frac{\\sigma^2}{2\\gamma}(1 - \\exp(-2\\gamma t))\\right)\n$$\nThe transition probability density $p_t(x,y)$ is the probability density function (PDF) of this normal distribution, evaluated at $y$. The general form for a normal PDF $\\mathcal{N}(\\mu, V)$ is $\\frac{1}{\\sqrt{2\\pi V}} \\exp\\left(-\\frac{(z-\\mu)^2}{2V}\\right)$. Substituting our mean and variance:\n$$\np_t(x,y) = \\frac{1}{\\sqrt{2\\pi \\frac{\\sigma^2}{2\\gamma}(1 - \\exp(-2\\gamma t))}} \\exp\\left(-\\frac{(y - x\\exp(-\\gamma t))^2}{2 \\frac{\\sigma^2}{2\\gamma}(1 - \\exp(-2\\gamma t))}\\right)\n$$\nSimplifying the expression gives:\n$$\np_t(x,y) = \\sqrt{\\frac{\\gamma}{\\pi\\sigma^2(1 - \\exp(-2\\gamma t))}} \\exp\\left(-\\frac{\\gamma(y - x\\exp(-\\gamma t))^2}{\\sigma^2(1 - \\exp(-2\\gamma t))}\\right)\n$$\nThis is the explicit expression for the transition density of the OU process.\n\n**2. Invariant Density and Verification of Detailed Balance**\n\nThe invariant probability density $\\pi(y)$ is the stationary distribution of the process, which can be found by taking the limit of the distribution of $X_t$ as $t \\to \\infty$. As $t \\to \\infty$:\n$$\n\\lim_{t \\to \\infty} \\mathbb{E}[X_t | X_0 = x] = \\lim_{t \\to \\infty} x \\exp(-\\gamma t) = 0\n$$\n$$\n\\lim_{t \\to \\infty} \\mathrm{Var}(X_t | X_0 = x) = \\lim_{t \\to \\infty} \\frac{\\sigma^2}{2\\gamma}(1 - \\exp(-2\\gamma t)) = \\frac{\\sigma^2}{2\\gamma}\n$$\nThus, the invariant distribution is a normal distribution with mean $0$ and variance $\\frac{\\sigma^2}{2\\gamma}$, i.e., $\\mathcal{N}(0, \\frac{\\sigma^2}{2\\gamma})$. Its probability density function $\\pi(y)$ is:\n$$\n\\pi(y) = \\frac{1}{\\sqrt{2\\pi \\frac{\\sigma^2}{2\\gamma}}} \\exp\\left(-\\frac{y^2}{2 \\frac{\\sigma^2}{2\\gamma}}\\right) = \\sqrt{\\frac{\\gamma}{\\pi\\sigma^2}} \\exp\\left(-\\frac{\\gamma y^2}{\\sigma^2}\\right)\n$$\nNow, we verify the detailed balance condition: $\\pi(x) p_t(x,y) = \\pi(y) p_t(y,x)$.\nLet's analyze the product $\\pi(x) p_t(x,y)$. For convenience, let $V_s = \\frac{\\sigma^2}{2\\gamma}$ be the stationary variance and $V_t = \\frac{\\sigma^2}{2\\gamma}(1 - \\exp(-2\\gamma t))$ be the time-dependent variance.\n$$\n\\pi(x) = \\frac{1}{\\sqrt{2\\pi V_s}} \\exp\\left(-\\frac{x^2}{2V_s}\\right)\n$$\n$$\np_t(x,y) = \\frac{1}{\\sqrt{2\\pi V_t}} \\exp\\left(-\\frac{(y-x\\exp(-\\gamma t))^2}{2V_t}\\right)\n$$\nThe product is:\n$$\n\\pi(x) p_t(x,y) = \\frac{1}{2\\pi \\sqrt{V_s V_t}} \\exp\\left(-\\frac{x^2}{2V_s} - \\frac{(y-x\\exp(-\\gamma t))^2}{2V_t}\\right)\n$$\nThe term $\\pi(y) p_t(y,x)$ is obtained by swapping $x$ and $y$:\n$$\n\\pi(y) p_t(y,x) = \\frac{1}{2\\pi \\sqrt{V_s V_t}} \\exp\\left(-\\frac{y^2}{2V_s} - \\frac{(x-y\\exp(-\\gamma t))^2}{2V_t}\\right)\n$$\nEquality requires the exponents to be equal. Let's examine the exponent from $\\pi(x) p_t(x,y)$ multiplied by $-2V_s V_t$:\n$$\nE_{xy} = V_t x^2 + V_s(y-x\\exp(-\\gamma t))^2 = V_t x^2 + V_s(y^2 - 2xy\\exp(-\\gamma t) + x^2\\exp(-2\\gamma t))\n$$\nAnd the exponent from $\\pi(y) p_t(y,x)$ multiplied by $-2V_s V_t$:\n$$\nE_{yx} = V_t y^2 + V_s(x-y\\exp(-\\gamma t))^2 = V_t y^2 + V_s(x^2 - 2xy\\exp(-\\gamma t) + y^2\\exp(-2\\gamma t))\n$$\nThe cross-term $-2V_s xy\\exp(-\\gamma t)$ is present in both expressions. We must show that the remaining terms are equal:\n$$\nV_t x^2 + V_s y^2 + V_s x^2 \\exp(-2\\gamma t) \\stackrel{?}{=} V_t y^2 + V_s x^2 + V_s y^2 \\exp(-2\\gamma t)\n$$\nSubstitute the definition $V_t = V_s(1 - \\exp(-2\\gamma t))$:\n$$\nV_s(1 - \\exp(-2\\gamma t)) x^2 + V_s y^2 + V_s x^2 \\exp(-2\\gamma t) \\stackrel{?}{=} V_s(1 - \\exp(-2\\gamma t)) y^2 + V_s x^2 + V_s y^2 \\exp(-2\\gamma t)\n$$\nExpanding the left side:\n$$\nV_s x^2 - V_s x^2 \\exp(-2\\gamma t) + V_s y^2 + V_s x^2 \\exp(-2\\gamma t) = V_s x^2 + V_s y^2\n$$\nExpanding the right side:\n$$\nV_s y^2 - V_s y^2 \\exp(-2\\gamma t) + V_s x^2 + V_s y^2 \\exp(-2\\gamma t) = V_s y^2 + V_s x^2\n$$\nSince $V_s x^2 + V_s y^2 = V_s y^2 + V_s x^2$, the equality holds. This verifies the detailed balance condition, confirming that the OU process is reversible with respect to its invariant measure $\\pi$.", "answer": "$$\n\\boxed{\\sqrt{\\frac{\\gamma}{\\pi\\sigma^2(1 - \\exp(-2\\gamma t))}} \\exp\\left(- \\frac{\\gamma(y - x \\exp(-\\gamma t))^2}{\\sigma^2(1 - \\exp(-2\\gamma t))}\\right)}\n$$", "id": "3072636"}, {"introduction": "When the noise in a system depends on its state—a common scenario in realistic physical models—ensuring reversibility requires a subtle correction to the drift term. This exercise serves as an important conceptual check by asking you to explore what happens when this \"noise-induced\" term is omitted [@problem_id:3072633]. Calculating the resulting non-zero probability current will give you a clear, hands-on understanding of why this term is indispensable for maintaining detailed balance and achieving a true equilibrium state.", "problem": "Consider a one-dimensional stochastic differential equation (SDE) in Itô form,\n$$\n\\mathrm{d}X_{t} = b(X_{t})\\,\\mathrm{d}t + \\sigma(X_{t})\\,\\mathrm{d}W_{t},\n$$\nwhere $W_{t}$ is standard Brownian motion, $a(x) = \\sigma(x)^{2}$ is the state-dependent diffusion coefficient, and $b(x)$ is the drift. Let the target stationary density be\n$$\n\\pi(x) = \\frac{1}{\\sqrt{2\\pi}}\\,\\exp\\!\\left(-\\frac{x^{2}}{2}\\right),\n$$\nand take the nonconstant diffusion coefficient\n$$\na(x) = 1 + x^{2}.\n$$\nSuppose one attempts to enforce reversibility (detailed balance) by choosing the drift as\n$$\nb(x) = \\frac{1}{2}\\,a(x)\\,\\frac{\\mathrm{d}}{\\mathrm{d}x}\\log \\pi(x),\n$$\nthat is, by omitting the divergence term $ \\tfrac{1}{2}\\,\\frac{\\mathrm{d}}{\\mathrm{d}x}a(x)$. Starting from the continuity equation for probability and the Fokker–Planck equation (FPE), derive the stationary probability current $j(x)$ under this choice of $b(x)$, and determine its closed-form expression as a function of $x$. Your final answer must be a single simplified analytic expression for $j(x)$. No rounding is required.", "solution": "The problem asks for the stationary probability current $j(x)$ for a one-dimensional stochastic process described by the Itô equation\n$$\n\\mathrm{d}X_{t} = b(X_{t})\\,\\mathrm{d}t + \\sigma(X_{t})\\,\\mathrm{d}W_{t}.\n$$\nThe time evolution of the probability density function $p(x,t)$ for this process is governed by the Fokker-Planck equation (FPE), which can be written as a continuity equation:\n$$\n\\frac{\\partial p(x,t)}{\\partial t} = -\\frac{\\partial}{\\partial x}j(x,t),\n$$\nwhere $j(x,t)$ is the probability current. The general expression for the probability current is\n$$\nj(x,t) = b(x) p(x,t) - \\frac{1}{2} \\frac{\\partial}{\\partial x} [a(x) p(x,t)],\n$$\nwith $a(x) = \\sigma(x)^{2}$ being the diffusion coefficient.\n\nA stationary state is one where the probability density does not change in time, i.e., $\\frac{\\partial p}{\\partial t} = 0$. In this case, the FPE implies that the stationary current $j_s(x)$ must satisfy $\\frac{\\mathrm{d}j_s(x)}{\\mathrm{d}x} = 0$, meaning $j_s(x)$ is a constant. For a process on an infinite domain with natural boundary conditions (i.e., the probability density and current vanish at $x \\to \\pm\\infty$), this constant must be zero. A process is reversible, or satisfies detailed balance, with respect to a stationary density $\\pi(x)$ if its stationary current is identically zero, $j_s(x) = 0$.\n\nThe condition for detailed balance is thus\n$$\nb(x)\\pi(x) - \\frac{1}{2}\\frac{\\mathrm{d}}{\\mathrm{d}x}[a(x)\\pi(x)] = 0.\n$$\nSolving for the drift $b(x)$ gives the required form for reversibility:\n$$\nb_{rev}(x) = \\frac{1}{2\\pi(x)}\\frac{\\mathrm{d}}{\\mathrm{d}x}[a(x)\\pi(x)] = \\frac{1}{2}\\frac{\\mathrm{d}a(x)}{\\mathrm{d}x} + \\frac{1}{2}a(x)\\frac{1}{\\pi(x)}\\frac{\\mathrm{d}\\pi(x)}{\\mathrm{d}x} = \\frac{1}{2}\\frac{\\mathrm{d}a(x)}{\\mathrm{d}x} + \\frac{1}{2}a(x)\\frac{\\mathrm{d}}{\\mathrm{d}x}\\log\\pi(x).\n$$\nThe problem specifies a drift $b(x)$ that omits the first term, the so-called divergence or noise-induced term:\n$$\nb(x) = \\frac{1}{2}a(x)\\frac{\\mathrm{d}}{\\mathrm{d}x}\\log\\pi(x).\n$$\nThe task is to find the \"stationary probability current $j(x)$\" under this choice of drift. This is interpreted as calculating the current field that arises when we substitute the given dynamics and the target density $\\pi(x)$ into the general expression for the current. This quantity measures the extent to which detailed balance with respect to $\\pi(x)$ is broken.\n\nWe evaluate the current expression $j(x) = b(x)\\pi(x) - \\frac{1}{2}\\frac{\\mathrm{d}}{\\mathrm{d}x}[a(x)\\pi(x)]$ using the provided functions. Let's first expand the derivative term:\n$$\n\\frac{1}{2}\\frac{\\mathrm{d}}{\\mathrm{d}x}[a(x)\\pi(x)] = \\frac{1}{2}\\frac{\\mathrm{d}a(x)}{\\mathrm{d}x}\\pi(x) + \\frac{1}{2}a(x)\\frac{\\mathrm{d}\\pi(x)}{\\mathrm{d}x}.\n$$\nUsing the relation $\\frac{\\mathrm{d}\\pi(x)}{\\mathrm{d}x} = \\pi(x)\\frac{\\mathrm{d}}{\\mathrm{d}x}\\log\\pi(x)$, this becomes\n$$\n\\frac{1}{2}\\frac{\\mathrm{d}}{\\mathrm{d}x}[a(x)\\pi(x)] = \\frac{1}{2}\\frac{\\mathrm{d}a(x)}{\\mathrm{d}x}\\pi(x) + \\frac{1}{2}a(x)\\pi(x)\\frac{\\mathrm{d}}{\\mathrm{d}x}\\log\\pi(x).\n$$\nNow we assemble the full expression for the current $j(x)$:\n$$\nj(x) = b(x)\\pi(x) - \\left( \\frac{1}{2}\\frac{\\mathrm{d}a(x)}{\\mathrm{d}x}\\pi(x) + \\frac{1}{2}a(x)\\pi(x)\\frac{\\mathrm{d}}{\\mathrm{d}x}\\log\\pi(x) \\right).\n$$\nSubstituting the given drift $b(x) = \\frac{1}{2}a(x)\\frac{\\mathrm{d}}{\\mathrm{d}x}\\log\\pi(x)$:\n$$\nj(x) = \\left(\\frac{1}{2}a(x)\\frac{\\mathrm{d}}{\\mathrm{d}x}\\log\\pi(x)\\right)\\pi(x) - \\frac{1}{2}\\frac{\\mathrm{d}a(x)}{\\mathrm{d}x}\\pi(x) - \\frac{1}{2}a(x)\\pi(x)\\frac{\\mathrm{d}}{\\mathrm{d}x}\\log\\pi(x).\n$$\nThe first and the third terms cancel each other out, leaving a remarkably simple expression for the current:\n$$\nj(x) = -\\frac{1}{2}\\frac{\\mathrm{d}a(x)}{\\mathrm{d}x}\\pi(x).\n$$\nThis result shows that the non-zero current is directly proportional to the gradient of the diffusion coefficient, which is precisely the term omitted from the reversible drift.\n\nWe now insert the specific functions provided in the problem statement:\nThe target stationary density is a standard normal distribution:\n$$\n\\pi(x) = \\frac{1}{\\sqrt{2\\pi}}\\exp\\left(-\\frac{x^{2}}{2}\\right).\n$$\nThe diffusion coefficient is given as:\n$$\na(x) = 1 + x^{2}.\n$$\nWe compute its derivative with respect to $x$:\n$$\n\\frac{\\mathrm{d}a(x)}{\\mathrm{d}x} = \\frac{\\mathrm{d}}{\\mathrm{d}x}(1 + x^{2}) = 2x.\n$$\nSubstituting these into our simplified expression for $j(x)$:\n$$\nj(x) = -\\frac{1}{2}(2x)\\pi(x) = -x\\pi(x).\n$$\nFinally, we write the full expression for $j(x)$:\n$$\nj(x) = -x \\frac{1}{\\sqrt{2\\pi}}\\exp\\left(-\\frac{x^{2}}{2}\\right).\n$$\nThis is the closed-form expression for the stationary probability current under the specified conditions. Since $\\frac{\\mathrm{d}j}{\\mathrm{d}x} \\neq 0$, the density $\\pi(x)$ is not the true stationary density of the process with the given drift, and the system is not in equilibrium. The calculated $j(x)$ represents the non-equilibrium current field.", "answer": "$$\n\\boxed{-x \\frac{1}{\\sqrt{2\\pi}}\\exp\\left(-\\frac{x^{2}}{2}\\right)}\n$$", "id": "3072633"}, {"introduction": "The principles of detailed balance are not just for analyzing existing systems; they are a powerful toolkit for designing new ones. This final practice moves from analysis to synthesis, challenging you to engineer a custom stochastic process for a specific purpose [@problem_id:3072619]. By constructing a reversible diffusion with a state-dependent diffusion coefficient designed to accelerate sampling, you will see how these theoretical concepts are applied to solve practical challenges in modern computational science.", "problem": "Consider a one-dimensional Itô stochastic differential equation (SDE) of the form $dX_t = b(X_t)\\,dt + \\sqrt{2\\,a(X_t)}\\,dW_t$, where $a(x)$ is a smooth strictly positive function and $W_t$ is a standard Wiener process. The target stationary density is multimodal and given by $\\pi(x) \\propto \\exp(-U(x))$ with potential $U(x) = \\tfrac{1}{2}(x^2 - 1)^2$, which has two wells near $x=\\pm 1$ separated by a barrier near $x=0$. To precondition the geometry for improved barrier crossing while preserving reversibility, choose a position-dependent diffusion $a(x) = 1 + \\gamma\\,\\exp(-\\kappa x^2)$ with parameters $\\gamma>0$ and $\\kappa>0$, which increases diffusivity near the barrier at $x=0$.\n\nUsing only the forward Kolmogorov (Fokker–Planck) equation and the definition of detailed balance (reversibility) as the vanishing of probability current at stationarity, derive the drift $b(x)$ that makes the diffusion reversible with respect to the given $\\pi(x)$. Express your final answer as a single simplified analytic expression for $b(x)$ in terms of $x$, $\\gamma$, and $\\kappa$. No numerical approximation is required.", "solution": "The process begins with the general one-dimensional Itô stochastic differential equation (SDE) provided:\n$$dX_t = b(X_t)\\,dt + \\sqrt{2\\,a(X_t)}\\,dW_t$$\nwhere $b(x)$ is the drift, $a(x)$ is the position-dependent diffusion function, and $W_t$ is a standard Wiener process.\n\nThe evolution of the probability density function $p(x,t)$ of the process $X_t$ is described by the forward Kolmogorov equation, also known as the Fokker–Planck equation. For the given SDE, the Fokker–Planck equation is:\n$$\\frac{\\partial p(x,t)}{\\partial t} = -\\frac{\\partial}{\\partial x} \\left( b(x)p(x,t) \\right) + \\frac{\\partial^2}{\\partial x^2} \\left( a(x)p(x,t) \\right)$$\nThis equation can be expressed as a continuity equation $\\frac{\\partial p}{\\partial t} = -\\frac{\\partial J}{\\partial x}$, where $J(x,t)$ is the probability current. By integrating the Fokker-Planck equation once with respect to $x$, we identify the current as:\n$$J(x,t) = b(x)p(x,t) - \\frac{\\partial}{\\partial x}\\left(a(x)p(x,t)\\right)$$\nAt stationarity, the probability density becomes time-independent, $p(x,t) = \\pi(x)$, and its time derivative is zero, $\\frac{\\partial \\pi}{\\partial t} = 0$. This implies that the stationary probability current, $J_{st}(x)$, must be constant with respect to $x$.\n$$J_{st}(x) = b(x)\\pi(x) - \\frac{d}{dx}\\left(a(x)\\pi(x)\\right) = \\text{constant}$$\nThe condition for the process to be reversible is stricter than stationarity. It requires that detailed balance holds, which in the context of a continuous one-dimensional process, translates to the condition that the stationary probability current must vanish everywhere, i.e., $J_{st}(x) = 0$ for all $x$.\n\nSetting the stationary current to zero provides the equation that links the drift $b(x)$ to the stationary density $\\pi(x)$ and the diffusion function $a(x)$:\n$$b(x)\\pi(x) - \\frac{d}{dx}\\left(a(x)\\pi(x)\\right) = 0$$\nAssuming $\\pi(x)>0$, we can solve for the drift $b(x)$:\n$$b(x) = \\frac{1}{\\pi(x)} \\frac{d}{dx}\\left(a(x)\\pi(x)\\right)$$\nUsing the product rule for differentiation on the term $\\frac{d}{dx}(a(x)\\pi(x))$, we get:\n$$b(x) = \\frac{1}{\\pi(x)} \\left( a'(x)\\pi(x) + a(x)\\pi'(x) \\right) = a'(x) + a(x)\\frac{\\pi'(x)}{\\pi(x)}$$\nwhere $a'(x)$ and $\\pi'(x)$ are the derivatives of $a(x)$ and $\\pi(x)$ with respect to $x$.\n\nThe problem states that the target stationary density is given by $\\pi(x) \\propto \\exp(-U(x))$. We can write this as $\\pi(x) = C \\exp(-U(x))$, where $C$ is a normalization constant. The term $\\frac{\\pi'(x)}{\\pi(x)}$ can be calculated as the derivative of $\\ln(\\pi(x))$:\n$$\\frac{\\pi'(x)}{\\pi(x)} = \\frac{d}{dx}\\ln(\\pi(x)) = \\frac{d}{dx}\\left(\\ln(C) - U(x)\\right) = -U'(x)$$\nSubstituting this result into the expression for $b(x)$ yields the general formula for the drift of a reversible diffusion:\n$$b(x) = a'(x) - a(x)U'(x)$$\nNow, we use the specific functions provided in the problem statement. The potential is $U(x) = \\frac{1}{2}(x^2 - 1)^2$. Its derivative is:\n$$U'(x) = \\frac{d}{dx}\\left(\\frac{1}{2}(x^4 - 2x^2 + 1)\\right) = \\frac{1}{2}(4x^3 - 4x) = 2x^3 - 2x = 2x(x^2 - 1)$$\nThe diffusion function is $a(x) = 1 + \\gamma\\,\\exp(-\\kappa x^2)$. Its derivative is:\n$$a'(x) = \\frac{d}{dx}\\left(1 + \\gamma\\,\\exp(-\\kappa x^2)\\right) = \\gamma\\,\\exp(-\\kappa x^2)(-2\\kappa x) = -2\\kappa \\gamma x \\exp(-\\kappa x^2)$$\nWe substitute these derivatives, along with the function $a(x)$, into the formula for $b(x)$:\n$$b(x) = \\left(-2\\kappa \\gamma x \\exp(-\\kappa x^2)\\right) - \\left(1 + \\gamma\\,\\exp(-\\kappa x^2)\\right)\\left(2x(x^2 - 1)\\right)$$\nTo simplify, we expand the second term:\n$$b(x) = -2\\kappa \\gamma x \\exp(-\\kappa x^2) - 2x(x^2 - 1) - 2\\gamma x(x^2 - 1)\\exp(-\\kappa x^2)$$\nNext, we group the terms containing the factor $\\exp(-\\kappa x^2)$:\n$$b(x) = -2x(x^2 - 1) - \\left(2\\kappa \\gamma x + 2\\gamma x(x^2 - 1)\\right)\\exp(-\\kappa x^2)$$\nFactoring out the common term $2\\gamma x$ from the expression in the parenthesis gives:\n$$b(x) = -2x(x^2 - 1) - 2\\gamma x\\left(\\kappa + (x^2 - 1)\\right)\\exp(-\\kappa x^2)$$\nFurther simplification of the term in parentheses yields:\n$$b(x) = -2x(x^2 - 1) - 2\\gamma x(x^2 + \\kappa - 1)\\exp(-\\kappa x^2)$$\nFinally, we can factor out the common term $-2x$ to obtain the final simplified expression for the drift $b(x)$:\n$$b(x) = -2x\\left[ (x^2 - 1) + \\gamma(x^2 + \\kappa - 1)\\exp(-\\kappa x^2) \\right]$$\nThis is the drift function that ensures the SDE is reversible with respect to the stationary distribution $\\pi(x) \\propto \\exp(-U(x))$.", "answer": "$$\n\\boxed{-2x\\left[ (x^2 - 1) + \\gamma(x^2 + \\kappa - 1)\\exp(-\\kappa x^2) \\right]}\n$$", "id": "3072619"}]}