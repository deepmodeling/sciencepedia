{"hands_on_practices": [{"introduction": "Applying Itô's formula is a fundamental skill for any student of stochastic calculus. This first exercise [@problem_id:3073698] provides essential practice by asking you to compute the second moment of a one-dimensional reflected Brownian motion. You will see how the defining property of the reflection term $L_t$—that it only increases when the process is at the boundary—leads to a crucial simplification in the calculation, yielding an elegant and insightful result.", "problem": "Consider reflected Brownian motion on the nonnegative half-line. Let $X_t$ be the unique strong solution to the Skorokhod problem on $[0,\\infty)$ with initial condition $X_0 = x \\ge 0$, that is, $X_t$ satisfies the stochastic differential equation (SDE)\n$$\n\\mathrm{d}X_t = \\mathrm{d}B_t + \\mathrm{d}L_t,\n$$\nwhere $B_t$ is standard Brownian motion (BM), and $L_t$ is a continuous, nondecreasing process with $L_0=0$ such that $X_t \\ge 0$ for all $t \\ge 0$ and $L_t$ increases only on the set $\\{s \\in [0,t]: X_s = 0\\}$.\n\nStarting from fundamental properties of Itô calculus and the defining properties of the reflection term $L_t$, apply Itô’s formula to the function $f(x) = x^2$ for the process $X_t$. Carefully justify each step using only the stated properties and well-tested facts from stochastic calculus. Then compute the expectation $\\mathbb{E}[X_t^2]$ and express your final answer as a closed-form analytic expression involving $x$, $t$, and $\\mathbb{E}[L_t]$.\n\nNo rounding is required. Express the final answer without units.", "solution": "The problem asks for the computation of the expectation $\\mathbb{E}[X_t^2]$, where $X_t$ is a reflected Brownian motion on $[0, \\infty)$ starting at $X_0 = x \\ge 0$. The process $X_t$ is governed by the stochastic differential equation (SDE):\n$$\n\\mathrm{d}X_t = \\mathrm{d}B_t + \\mathrm{d}L_t\n$$\nHere, $B_t$ is a standard one-dimensional Brownian motion, and $L_t$ is the reflection term, which is a continuous, non-decreasing process with $L_0=0$ that increases only when $X_t=0$.\n\nWe are instructed to apply Itô's formula to the function $f(x) = x^2$. For a continuous semimartingale like $X_t$, Itô's formula states:\n$$\n\\mathrm{d}f(X_t) = f'(X_t)\\mathrm{d}X_t + \\frac{1}{2}f''(X_t)\\mathrm{d}\\langle X \\rangle_t\n$$\nwhere $f'(x)$ and $f''(x)$ are the first and second derivatives of $f(x)$, and $\\langle X \\rangle_t$ is the quadratic variation process of $X_t$.\n\nFor $f(x) = x^2$, the derivatives are $f'(x) = 2x$ and $f''(x) = 2$. Substituting these into Itô's formula gives:\n$$\n\\mathrm{d}(X_t^2) = 2X_t \\mathrm{d}X_t + \\frac{1}{2}(2)\\mathrm{d}\\langle X \\rangle_t = 2X_t \\mathrm{d}X_t + \\mathrm{d}\\langle X \\rangle_t\n$$\nNext, we substitute the SDE for $X_t$:\n$$\n\\mathrm{d}(X_t^2) = 2X_t(\\mathrm{d}B_t + \\mathrm{d}L_t) + \\mathrm{d}\\langle X \\rangle_t = 2X_t\\mathrm{d}B_t + 2X_t\\mathrm{d}L_t + \\mathrm{d}\\langle X \\rangle_t\n$$\nWe must now determine the quadratic variation $\\langle X \\rangle_t$. The process $X_t$ is the sum of $B_t$ and $L_t$. Using the properties of quadratic variation:\n$$\n\\langle X \\rangle_t = \\langle B + L \\rangle_t = \\langle B \\rangle_t + 2\\langle B, L \\rangle_t + \\langle L \\rangle_t\n$$\nThe quadratic variation of a standard Brownian motion is $\\langle B \\rangle_t = t$. The process $L_t$ is a continuous process of finite variation, and the quadratic variation of any such process is zero. Thus, $\\langle L \\rangle_t = 0$. The cross-variation $\\langle B, L \\rangle_t$ between a continuous local martingale (like $B_t$) and a continuous process of finite variation (like $L_t$) is also zero. Therefore, the quadratic variation of $X_t$ is:\n$$\n\\langle X \\rangle_t = t\n$$\nSubstituting this back into the SDE for $X_t^2$:\n$$\n\\mathrm{d}(X_t^2) = 2X_t\\mathrm{d}B_t + 2X_t\\mathrm{d}L_t + \\mathrm{d}t\n$$\nTo find $X_t^2$, we integrate this SDE from $0$ to $t$:\n$$\nX_t^2 - X_0^2 = \\int_0^t 2X_s \\mathrm{d}B_s + \\int_0^t 2X_s \\mathrm{d}L_s + \\int_0^t \\mathrm{d}s\n$$\nThe problem specifies that $L_t$ increases only on the set $\\{s \\in [0,t]: X_s = 0\\}$. This is the Skorokhod condition, which can be stated formally as $\\int_0^t \\mathbb{1}_{\\{X_s > 0\\}} \\mathrm{d}L_s = 0$. Since $X_s \\ge 0$ and $L_t$ is non-decreasing, the support of the measure $\\mathrm{d}L_s$ is a subset of the times $s$ where $X_s = 0$. Consequently, the integrand $X_s$ is zero whenever $\\mathrm{d}L_s$ is non-zero. Therefore, the Stieltjes integral $\\int_0^t X_s \\mathrm{d}L_s$ is identically zero:\n$$\n\\int_0^t X_s \\mathrm{d}L_s = 0\n$$\nWith this simplification and substituting $X_0 = x$ and $\\int_0^t \\mathrm{d}s = t$, the equation for $X_t^2$ becomes:\n$$\nX_t^2 = x^2 + 2\\int_0^t X_s \\mathrm{d}B_s + t\n$$\nNow, we compute the expectation $\\mathbb{E}[X_t^2]$. Taking the expectation of both sides and using the linearity of expectation:\n$$\n\\mathbb{E}[X_t^2] = \\mathbb{E}[x^2] + \\mathbb{E}\\left[2\\int_0^t X_s \\mathrm{d}B_s\\right] + \\mathbb{E}[t]\n$$\nThe terms $\\mathbb{E}[x^2] = x^2$ and $\\mathbb{E}[t] = t$ as $x$ and $t$ are deterministic. The remaining term is the expectation of an Itô integral:\n$$\n\\mathbb{E}\\left[\\int_0^t X_s \\mathrm{d}B_s\\right]\n$$\nThe process $M_t = \\int_0^t X_s \\mathrm{d}B_s$ is a continuous local martingale, as $X_s$ is an adapted process satisfying the necessary integrability conditions (e.g., $\\mathbb{E}[\\int_0^t X_s^2 \\mathrm{d}s] < \\infty$). For any such local martingale starting at zero, its expectation is zero. Thus:\n$$\n\\mathbb{E}\\left[\\int_0^t X_s \\mathrm{d}B_s\\right] = 0\n$$\nSubstituting this result into the equation for $\\mathbb{E}[X_t^2]$ yields:\n$$\n\\mathbb{E}[X_t^2] = x^2 + 2(0) + t = x^2 + t\n$$\nThe problem asks for the result to be expressed in terms of $x$, $t$, and $\\mathbb{E}[L_t]$. Our derivation, following the specified steps, shows that $\\mathbb{E}[X_t^2]$ does not depend on $\\mathbb{E}[L_t]$. The relationship $\\mathbb{E}[X_t] = x + \\mathbb{E}[L_t]$ exists, but it does not enter into the calculation of the second moment via this application of Itô's formula. The final result is correctly and completely expressed as a function of $x$ and $t$. To formally comply with the phrasing, one could write the answer as $x^2 + t + 0 \\cdot \\mathbb{E}[L_t]$, but the most accurate and parsimonious result is simply $x^2+t$.", "answer": "$$\\boxed{x^2+t}$$", "id": "3073698"}, {"introduction": "The local time process, $L_t$, is the mathematical engine that enforces reflection. This practice [@problem_id:3073657] bridges the gap between its abstract definition and its tangible interpretation as a measure of time spent at the boundary. You will develop a practical estimator for $L_t$ from discrete data and then validate its accuracy by calculating its theoretical expected value, a classic result related to the work of Paul Lévy.", "problem": "Consider a one-dimensional reflected Brownian motion on the nonnegative real line, denoted by the process $X_t$ taking values in $[0,\\infty)$ and starting at $X_0=0$. The process is modeled by the Skorokhod problem with decomposition\n$$\nX_t \\;=\\; W_t \\;+\\; L_t,\\qquad t\\geq 0,\n$$\nwhere $W_t$ is a standard Brownian motion and $L_t$ is a continuous, nondecreasing process that increases only on the set $\\{t\\geq 0: X_t=0\\}$. The process $L_t$ is called the boundary local time at $0$ for the reflected process.\n\nYou observe a single discrete path of $X_t$ at times $t_k=k\\,\\Delta$ for $k=0,1,\\dots,n$ with $\\Delta=t/n$. Using only these discrete observations, construct from first principles a practical estimator for $L_t$ based on the time the process spends near the reflecting boundary $0$. Your construction should begin from fundamental definitions for continuous semimartingales, including the characterization of local time via occupation density and the convex-function version of Itô’s formula (Tanaka’s formula), and it should identify the correct normalization so that the estimator is asymptotically unbiased as the spatial threshold and time step vanish.\n\nThen, justify rigorously the limiting value of the expectation of your estimator as the spatial threshold $\\varepsilon\\downarrow 0$ and the mesh $\\Delta\\downarrow 0$ (with $n\\Delta=t$ fixed). As part of your validation, compute the theoretical value of $\\mathbb{E}[L_t]$ for the reflected Brownian motion started at $0$ and verify that your estimator’s expectation converges to this value.\n\nReport as your final answer the exact closed-form expression for the limit of the expectation of your estimator as a function of $t$ (no numerical approximation or rounding).", "solution": "To construct an estimator for the local time $L_t$, we start from the occupation time formula. For a continuous semimartingale like a reflected Brownian motion $X_t$, the symmetric local time at the boundary $a=0$ is related to the time the process spends in a small neighborhood of the boundary:\n$$L_t^0(X) = \\lim_{\\varepsilon\\downarrow 0} \\frac{1}{2\\varepsilon} \\int_0^t \\mathbf{1}_{[0, \\varepsilon)}(X_s) ds$$\nFor a reflected Brownian motion, the Skorokhod local time $L_t$ is equal to this symmetric local time, $L_t = L_t^0(X)$. This provides the principle for our estimator. We can approximate the integral using the discrete observations $X_{k\\Delta}$ over a time step $\\Delta$:\n$$\\int_0^t \\mathbf{1}_{[0, \\varepsilon)}(X_s) ds \\approx \\sum_{k=0}^{n-1} \\mathbf{1}_{\\{X_{k\\Delta} \\in [0, \\varepsilon)\\}} \\Delta$$\nThis leads to the practical estimator $\\hat{L}_{t,n,\\varepsilon}$:\n$$\\hat{L}_{t,n,\\varepsilon} = \\frac{1}{2\\varepsilon} \\sum_{k=0}^{n-1} \\mathbf{1}_{\\{X_{k\\Delta} \\in [0, \\varepsilon)\\}} \\Delta$$\nTo find the limiting expectation of this estimator, we first take the expectation and then the limit as the time step $\\Delta \\to 0$ (with $t=n\\Delta$ fixed), which turns the sum into an integral:\n$$\\lim_{\\Delta \\to 0} \\mathbb{E}[\\hat{L}_{t,n,\\varepsilon}] = \\frac{1}{2\\varepsilon} \\int_0^t \\mathbb{P}(X_s \\in [0, \\varepsilon)) ds$$\nNext, we take the limit as the spatial threshold $\\varepsilon \\to 0$. Let $p_s(x)$ be the probability density function (PDF) of $X_s$. Then $\\lim_{\\varepsilon \\to 0} \\frac{1}{\\varepsilon}\\mathbb{P}(X_s \\in [0, \\varepsilon)) = \\lim_{\\varepsilon \\to 0} \\frac{1}{\\varepsilon}\\int_0^\\varepsilon p_s(x)dx = p_s(0)$. This gives:\n$$\\lim_{\\varepsilon \\downarrow 0, \\Delta \\to 0} \\mathbb{E}[\\hat{L}_{t,n,\\varepsilon}] = \\frac{1}{2} \\int_0^t p_s(0) ds$$\nThe process $X_t$ starting at $X_0=0$ has the same distribution as $|W_t|$, where $W_t$ is standard Brownian motion. The PDF of $X_s$ is $p_s(x) = \\sqrt{\\frac{2}{\\pi s}} \\exp\\left(-\\frac{x^2}{2s}\\right)$ for $x \\ge 0$. At the boundary $x=0$, this density is $p_s(0) = \\sqrt{\\frac{2}{\\pi s}}$. Plugging this into the integral yields:\n$$\\lim_{\\varepsilon \\downarrow 0, \\Delta \\to 0} \\mathbb{E}[\\hat{L}_{t,n,\\varepsilon}] = \\frac{1}{2} \\int_0^t \\sqrt{\\frac{2}{\\pi s}} ds = \\frac{1}{2} \\sqrt{\\frac{2}{\\pi}} \\left[2s^{1/2}\\right]_0^t = \\sqrt{\\frac{2t}{\\pi}}$$\nWe can verify this result using the theoretical value of $\\mathbb{E}[L_t]$. By a theorem of Paul Lévy, the local time process $L_t$ for a reflected Brownian motion starting at 0 has the same distribution as $|W_t|$. Thus, their expectations are equal:\n$$\\mathbb{E}[L_t] = \\mathbb{E}[|W_t|] = \\mathbb{E}[|\\sqrt{t}Z|] = \\sqrt{t} \\mathbb{E}[|Z|]$$\nwhere $Z \\sim \\mathcal{N}(0, 1)$. The expectation of the absolute value of a standard normal random variable is $\\mathbb{E}[|Z|] = \\sqrt{2/\\pi}$. Therefore:\n$$\\mathbb{E}[L_t] = \\sqrt{t} \\cdot \\sqrt{\\frac{2}{\\pi}} = \\sqrt{\\frac{2t}{\\pi}}$$\nThe limiting expectation of our estimator matches the theoretical expectation, confirming its asymptotic unbiasedness.", "answer": "$$ \\boxed{\\sqrt{\\frac{2t}{\\pi}}} $$", "id": "3073657"}, {"introduction": "A reflecting boundary is just one way a diffusion process can interact with the edge of its state space. This final problem [@problem_id:3073693] provides a conceptual map, contrasting reflecting boundaries with absorbing and \"sticky\" ones. By examining the domain of the infinitesimal generator for each case, you will discover how simple analytical conditions, such as a Neumann condition ($f'(0)=0$) for reflection, give rise to rich and distinct probabilistic behaviors.", "problem": "Consider a one-dimensional diffusion confined to the half-line $[0,\\infty)$ whose dynamics in the interior $(0,\\infty)$ are those of standard Brownian motion, that is, the infinitesimal generator acting on a twice continuously differentiable test function $f$ is $L f(x) = \\tfrac{1}{2} f''(x)$ for $x \\in (0,\\infty)$. At the boundary $x=0$, three different mechanisms are possible: absorbing, reflecting, and sticky. The infinitesimal generator and its domain at $x=0$ must be specified so that the martingale problem for $L$ is well posed and the probabilistic behavior at $x=0$ matches the intended mechanism.\n\nFrom first principles, recall:\n- The infinitesimal generator $L$ of a Markov process with continuous sample paths is defined by the limit $L f(x) = \\lim_{t \\downarrow 0} \\tfrac{\\mathbb{E}_x[f(X_t)] - f(x)}{t}$ on a domain $\\mathcal{D}(L)$ of functions $f$ for which this limit exists and is continuous.\n- For a process absorbed at $x=0$, the state $x=0$ is terminal and the process is moved to a cemetery state upon first hitting $x=0$.\n- For a process reflected at $x=0$, the Skorokhod decomposition shows that if $X_t$ solves $dX_t = dW_t + dL_t^0(X)$ with $X_t \\in [0,\\infty)$ and $L_t^0(X)$ the boundary local time, then for $f$ sufficiently smooth, Itô’s formula with boundary local time yields a finite variation term proportional to $f'(0)$.\n- For a sticky boundary at $x=0$ with stickiness parameter $\\theta > 0$, one can construct the process as a time change of reflecting Brownian motion by adding time proportional to boundary local time; this modifies the finite variation terms in Itô’s formula so that consistency of the martingale problem enforces a Wentzell-type boundary condition that linearly relates $f'(0)$ and $L f(0)$.\n\nWhich option correctly identifies the generator domain condition at $x=0$ for each mechanism and gives the correct probabilistic interpretation?\n\nA. Absorbing: $\\mathcal{D}(L)$ consists of functions $f$ with $f \\in C^2((0,\\infty)) \\cap C([0,\\infty))$ and $f(0)=0$. Reflecting: $\\mathcal{D}(L)$ consists of functions $f$ with $f \\in C^2((0,\\infty)) \\cap C^1([0,\\infty))$ and $f'(0)=0$. Sticky (with parameter $\\theta>0$): $\\mathcal{D}(L)$ consists of functions $f$ with $f \\in C^2((0,\\infty)) \\cap C^1([0,\\infty))$ satisfying the Wentzell condition $f'(0)=\\theta\\, Lf(0)=\\tfrac{\\theta}{2} f''(0)$. Probabilistic interpretation: absorbing means the process is killed on hitting $x=0$; reflecting means instantaneous reflection with zero Lebesgue time spent at $x=0$; sticky means the process spends positive Lebesgue time at $x=0$ in proportion to boundary local time, with stickiness increasing in $\\theta$.\n\nB. Absorbing: $\\mathcal{D}(L)$ has $f'(0)=0$. Reflecting: $\\mathcal{D}(L)$ has $f(0)=0$. Sticky (with parameter $\\theta>0$): $\\mathcal{D}(L)$ has Robin condition $f'(0)=\\theta f(0)$. Probabilistic interpretation: absorbing and reflecting are interchanged relative to their usual meanings, and sticky corresponds to partial absorption.\n\nC. Absorbing: $\\mathcal{D}(L)$ has $f(0)=0$. Reflecting: $\\mathcal{D}(L)$ has $f''(0)=0$. Sticky (with parameter $\\theta>0$): $\\mathcal{D}(L)$ has Wentzell condition $f'(0)=\\theta f(0)$. Probabilistic interpretation: reflecting forbids curvature at $x=0$, and sticky imposes a linear relation between flux and value but does not change time spent at the boundary.\n\nD. Absorbing: $\\mathcal{D}(L)$ has $f(0)=0$. Reflecting: $\\mathcal{D}(L)$ has $f'(0)=0$. Sticky (with parameter $\\theta>0$): $\\mathcal{D}(L)$ has $f''(0)=\\theta f(0)$. Probabilistic interpretation: sticky means the process reflects instantly but with altered variance near $x=0$, so no time is spent at $x=0$.\n\nAssume suitable growth or boundary conditions at $x=\\infty$ so that all functions and expectations are well defined. Select the single correct option.", "solution": "The connection between a diffusion process $X_t$ and its infinitesimal generator $L$ is established by the martingale problem: for any function $f$ in the generator's domain $\\mathcal{D}(L)$, the process $M_t^f = f(X_t) - f(X_0) - \\int_0^t Lf(X_s) ds$ must be a local martingale. We use this principle to find the correct boundary conditions for the domain $\\mathcal{D}(L)$ at $x=0$ for each of the three mechanisms.\n\n1.  **Reflecting Boundary:** A reflecting Brownian motion on $[0, \\infty)$ is governed by the Skorokhod equation $dX_t = dW_t + dL_t^0$, where $L_t^0$ is the boundary local time at $x=0$. Applying Itô's formula to a function $f \\in C^2([0, \\infty))$ yields a term of bounded variation, $f'(0) L_t^0$. For the martingale problem to hold, this bounded variation term must be zero. Since $L_t^0$ is generally non-zero, the function $f$ must satisfy the **Neumann boundary condition**:\n    $$f'(0) = 0$$\n\n2.  **Absorbing Boundary:** For an absorbing boundary at $x=0$, the process is stopped and moved to a cemetery state upon hitting the boundary. For the associated semigroup to be well-defined on the space of continuous functions, the functions in the generator's domain must vanish at the absorbing boundary. This imposes the **Dirichlet boundary condition**:\n    $$f(0) = 0$$\n\n3.  **Sticky Boundary:** A sticky boundary at $x=0$ is one where the process can spend a positive amount of Lebesgue time. This behavior is modeled by a Wentzell boundary condition, which relates the function's value, its derivative, and the generator's action at the boundary. For a sticky boundary with parameter $\\theta > 0$, this condition takes the form $f'(0) = \\theta Lf(0)$. Since the generator in the interior is $Lf(x) = \\frac{1}{2}f''(x)$, we can define $Lf(0)$ by taking the limit, resulting in the condition:\n    $$f'(0) = \\theta \\left(\\frac{1}{2} f''(0)\\right) = \\frac{\\theta}{2}f''(0)$$\n\nBased on this analysis:\n- The absorbing condition is $f(0)=0$.\n- The reflecting condition is $f'(0)=0$.\n- The sticky condition is the Wentzell condition $f'(0)=\\theta Lf(0)=\\frac{\\theta}{2}f''(0)$.\n- The probabilistic interpretations are: absorbing means the process is killed, reflecting means it's instantaneously bounced back (spending zero Lebesgue time at the boundary), and sticky means it spends a positive amount of Lebesgue time at the boundary.\n\nComparing these results with the given options, only option A correctly identifies all three boundary conditions and their corresponding probabilistic interpretations.", "answer": "$$\\boxed{A}$$", "id": "3073693"}]}