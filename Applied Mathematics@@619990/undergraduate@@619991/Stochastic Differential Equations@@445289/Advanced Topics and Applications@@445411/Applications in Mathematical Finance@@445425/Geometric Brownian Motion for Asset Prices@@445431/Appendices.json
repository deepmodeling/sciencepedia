{"hands_on_practices": [{"introduction": "To truly understand the behavior of an asset following Geometric Brownian Motion, it is crucial to distinguish between its expected value and its typical, or median, path. This practice [@problem_id:3057152] guides you through a comparison of the time it takes for the mean and the median of the asset price to reach a specific target. By solving this, you will gain a deep, intuitive understanding of how volatility, represented by $\\sigma$, creates a right-skewed distribution where the mean outpaces the median.", "problem": "An asset price process $\\{S_t\\}_{t \\ge 0}$ follows the geometric Brownian motion dynamics given by the stochastic differential equation (SDE)\n$$\n\\mathrm{d}S_t = \\mu S_t \\,\\mathrm{d}t + \\sigma S_t \\,\\mathrm{d}W_t, \\quad S_00,\n$$\nwhere $\\mu$ and $\\sigma$ are real constants with $\\sigma0$, and $\\{W_t\\}_{t\\ge 0}$ is a standard Brownian motion. Let $L$ be a fixed level with $LS_0$. Assume $\\mu0$ and $\\mu\\sigma^2/2$ so that both the mean and the median of $S_t$ eventually exceed $L$.\n\nStarting from the SDE definition and first principles of stochastic calculus, determine the exact expressions for the following two times:\n- The time $t_E^{\\ast}$ at which the expectation $\\mathbb{E}[S_t]$ first reaches the level $L$, that is, the unique $t0$ satisfying $\\mathbb{E}[S_t] = L$.\n- The time $t_M^{\\ast}$ at which the median of $S_t$ first reaches the level $L$, that is, the unique $t0$ such that the median of the distribution of $S_t$ at time $t$ equals $L$.\n\nProvide your answers as closed-form analytic expressions in terms of $S_0$, $L$, $\\mu$, and $\\sigma$. Then, compare $t_E^{\\ast}$ and $t_M^{\\ast}$ under the stated assumptions. The final answer must be the pair $\\big(t_E^{\\ast},\\,t_M^{\\ast}\\big)$ written as a row matrix. No numerical evaluation or rounding is required.", "solution": "The first step is to find the explicit solution for the asset price $S_t$ by solving the given stochastic differential equation. We apply Itô's lemma to the function $f(S_t) = \\ln(S_t)$. The derivatives of $f(S)$ are $\\frac{\\partial f}{\\partial S} = \\frac{1}{S_t}$ and $\\frac{\\partial^2 f}{\\partial S^2} = -\\frac{1}{S_t^2}$.\n\nAccording to Itô's lemma, the differential of $f(S_t)$ is:\n$$\n\\mathrm{d}(\\ln S_t) = \\frac{\\partial f}{\\partial S} \\mathrm{d}S_t + \\frac{1}{2} \\frac{\\partial^2 f}{\\partial S^2} (\\mathrm{d}S_t)^2\n$$\nSubstituting the derivatives and the SDE for $S_t$:\n$$\n\\mathrm{d}(\\ln S_t) = \\frac{1}{S_t} (\\mu S_t \\,\\mathrm{d}t + \\sigma S_t \\,\\mathrm{d}W_t) + \\frac{1}{2} \\left(-\\frac{1}{S_t^2}\\right) (\\sigma S_t \\,\\mathrm{d}W_t)^2\n$$\nUsing the quadratic variation property of Brownian motion, $(\\mathrm{d}W_t)^2 = \\mathrm{d}t$, we simplify the last term:\n$$\n(\\sigma S_t \\,\\mathrm{d}W_t)^2 = \\sigma^2 S_t^2 (\\mathrm{d}W_t)^2 = \\sigma^2 S_t^2 \\mathrm{d}t\n$$\nSubstituting this back into the expression for $\\mathrm{d}(\\ln S_t)$:\n$$\n\\mathrm{d}(\\ln S_t) = (\\mu\\,\\mathrm{d}t + \\sigma\\,\\mathrm{d}W_t) - \\frac{1}{2} \\frac{1}{S_t^2} (\\sigma^2 S_t^2 \\mathrm{d}t) = (\\mu - \\frac{1}{2}\\sigma^2)\\,\\mathrm{d}t + \\sigma\\,\\mathrm{d}W_t\n$$\nThis is an arithmetic Brownian motion for $\\ln(S_t)$. We can integrate this from $0$ to $t$:\n$$\n\\int_0^t \\mathrm{d}(\\ln S_u) = \\int_0^t (\\mu - \\frac{1}{2}\\sigma^2)\\,\\mathrm{d}u + \\int_0^t \\sigma\\,\\mathrm{d}W_u\n$$\n$$\n\\ln(S_t) - \\ln(S_0) = (\\mu - \\frac{1}{2}\\sigma^2)t + \\sigma(W_t - W_0)\n$$\nGiven that $W_0=0$, we have:\n$$\n\\ln(S_t) = \\ln(S_0) + (\\mu - \\frac{1}{2}\\sigma^2)t + \\sigma W_t\n$$\nExponentiating both sides yields the explicit solution for $S_t$:\n$$\nS_t = S_0 \\exp\\left( \\left(\\mu - \\frac{1}{2}\\sigma^2\\right)t + \\sigma W_t \\right)\n$$\nThis solution shows that $S_t$ follows a log-normal distribution, as $\\ln(S_t)$ is normally distributed with mean $\\ln(S_0) + (\\mu - \\frac{1}{2}\\sigma^2)t$ and variance $\\sigma^2 t$. That is, $\\ln(S_t) \\sim \\mathcal{N}\\left(\\ln(S_0) + (\\mu - \\frac{1}{2}\\sigma^2)t, \\sigma^2 t\\right)$.\n\n**Determination of $t_E^{\\ast}$**\n\nWe first compute the expectation $\\mathbb{E}[S_t]$:\n$$\n\\mathbb{E}[S_t] = \\mathbb{E}\\left[ S_0 \\exp\\left( \\left(\\mu - \\frac{1}{2}\\sigma^2\\right)t + \\sigma W_t \\right) \\right] = S_0 \\exp\\left( \\left(\\mu - \\frac{1}{2}\\sigma^2\\right)t \\right) \\mathbb{E}\\left[\\exp(\\sigma W_t)\\right]\n$$\nThe term $\\mathbb{E}[\\exp(\\sigma W_t)]$ is the moment-generating function of the normal random variable $W_t \\sim \\mathcal{N}(0, t)$, evaluated at $\\sigma$. For a general normal random variable $X \\sim \\mathcal{N}(\\nu, \\tau^2)$, its moment-generating function is $\\mathbb{E}[\\exp(k X)] = \\exp(k\\nu + \\frac{1}{2}k^2\\tau^2)$. For $W_t$, we have $\\nu=0$, $\\tau^2=t$, and we evaluate at $k=\\sigma$.\n$$\n\\mathbb{E}[\\exp(\\sigma W_t)] = \\exp\\left(\\sigma \\cdot 0 + \\frac{1}{2}\\sigma^2 t\\right) = \\exp\\left(\\frac{1}{2}\\sigma^2 t\\right)\n$$\nSubstituting this back into the expectation of $S_t$:\n$$\n\\mathbb{E}[S_t] = S_0 \\exp\\left( \\left(\\mu - \\frac{1}{2}\\sigma^2\\right)t \\right) \\exp\\left(\\frac{1}{2}\\sigma^2 t\\right) = S_0 \\exp\\left( \\mu t - \\frac{1}{2}\\sigma^2 t + \\frac{1}{2}\\sigma^2 t \\right) = S_0 \\exp(\\mu t)\n$$\nNow, we find $t_E^{\\ast}$ by setting $\\mathbb{E}[S_t] = L$:\n$$\nS_0 \\exp(\\mu t_E^{\\ast}) = L \\implies \\exp(\\mu t_E^{\\ast}) = \\frac{L}{S_0}\n$$\nTaking the natural logarithm of both sides:\n$$\n\\mu t_E^{\\ast} = \\ln\\left(\\frac{L}{S_0}\\right) \\implies t_E^{\\ast} = \\frac{1}{\\mu} \\ln\\left(\\frac{L}{S_0}\\right)\n$$\nThe conditions $LS_0$ and $\\mu0$ ensure that $t_E^{\\ast}$ is positive and well-defined.\n\n**Determination of $t_M^{\\ast}$**\n\nThe median of $S_t$, let us denote it by $m_t$, is the value such that $\\mathbb{P}(S_t \\le m_t) = \\frac{1}{2}$. Since the natural logarithm is a strictly increasing function, this is equivalent to:\n$$\n\\mathbb{P}(\\ln(S_t) \\le \\ln(m_t)) = \\frac{1}{2}\n$$\nThis statement implies that $\\ln(m_t)$ is the median of the normally distributed random variable $\\ln(S_t)$. For any normal distribution, the median is equal to its mean. The mean of $\\ln(S_t)$ is:\n$$\n\\mathbb{E}[\\ln(S_t)] = \\ln(S_0) + (\\mu - \\frac{1}{2}\\sigma^2)t\n$$\nTherefore, we have:\n$$\n\\ln(m_t) = \\ln(S_0) + \\left(\\mu - \\frac{1}{2}\\sigma^2\\right)t\n$$\nExponentiating both sides gives the median of $S_t$:\n$$\nm_t = S_0 \\exp\\left( \\left(\\mu - \\frac{1}{2}\\sigma^2\\right)t \\right)\n$$\nWe find $t_M^{\\ast}$ by setting the median at time $t$ to be equal to $L$:\n$$\nS_0 \\exp\\left( \\left(\\mu - \\frac{1}{2}\\sigma^2\\right)t_M^{\\ast} \\right) = L \\implies \\exp\\left( \\left(\\mu - \\frac{1}{2}\\sigma^2\\right)t_M^{\\ast} \\right) = \\frac{L}{S_0}\n$$\nTaking the natural logarithm of both sides:\n$$\n\\left(\\mu - \\frac{1}{2}\\sigma^2\\right)t_M^{\\ast} = \\ln\\left(\\frac{L}{S_0}\\right) \\implies t_M^{\\ast} = \\frac{1}{\\mu - \\frac{1}{2}\\sigma^2} \\ln\\left(\\frac{L}{S_0}\\right)\n$$\nThe conditions $LS_0$ and $\\mu  \\sigma^2/2$ ensure that $t_M^{\\ast}$ is positive and well-defined.\n\n**Comparison of $t_E^{\\ast}$ and $t_M^{\\ast}$**\n\nWe have the two expressions:\n$$\nt_E^{\\ast} = \\frac{\\ln(L/S_0)}{\\mu} \\quad \\text{and} \\quad t_M^{\\ast} = \\frac{\\ln(L/S_0)}{\\mu - \\frac{1}{2}\\sigma^2}\n$$\nSince $L  S_0$, the term $\\ln(L/S_0)$ is positive. The comparison depends on the denominators. We are given $\\sigma0$, which implies $\\frac{1}{2}\\sigma^2  0$. It follows that:\n$$\n\\mu  \\mu - \\frac{1}{2}\\sigma^2\n$$\nThe problem states that $\\mu0$ and $\\mu  \\sigma^2/2$, so both denominators are positive. Taking the reciprocal of a positive inequality reverses its direction:\n$$\n\\frac{1}{\\mu}  \\frac{1}{\\mu - \\frac{1}{2}\\sigma^2}\n$$\nMultiplying by the positive quantity $\\ln(L/S_0)$ preserves the inequality:\n$$\n\\frac{\\ln(L/S_0)}{\\mu}  \\frac{\\ln(L/S_0)}{\\mu - \\frac{1}{2}\\sigma^2} \\implies t_E^{\\ast}  t_M^{\\ast}\n$$\nThis result is consistent with the properties of the log-normal distribution, which is right-skewed. The mean is pulled to the right of the median by the long tail of low-probability, high-value outcomes. Consequently, the mean grows at a faster effective rate ($\\mu$) than the median (rate $\\mu-\\sigma^2/2$), and thus reaches the level $L$ at an earlier time.\n\nThe final answer requires the pair $\\big(t_E^{\\ast},\\,t_M^{\\ast}\\big)$.\nThe expressions are:\n$t_E^{\\ast} = \\frac{\\ln(L/S_0)}{\\mu}$\n$t_M^{\\ast} = \\frac{\\ln(L/S_0)}{\\mu - \\frac{1}{2}\\sigma^2}$", "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{\\ln\\left(\\frac{L}{S_0}\\right)}{\\mu}  \\frac{\\ln\\left(\\frac{L}{S_0}\\right)}{\\mu - \\frac{1}{2}\\sigma^2} \\end{pmatrix}}\n$$", "id": "3057152"}, {"introduction": "Having explored the mean (the first moment), we can now develop a more comprehensive tool to describe the entire probability distribution of the asset price at any future time. In this exercise [@problem_id:3057173], you will derive a general closed-form expression for the $n$-th moment of the asset price, $\\mathbb{E}[S_t^n]$. This powerful formula is a cornerstone of stochastic calculus and is fundamental for pricing derivatives and quantifying financial risk.", "problem": "Consider an asset price process $S_t$ defined on a filtered probability space carrying a standard Brownian motion (Wiener process) $W_t$. Assume $S_t$ follows the geometric Brownian motion specified by the stochastic differential equation (SDE)\n$$\n\\mathrm{d}S_t=\\mu S_t\\,\\mathrm{d}t+\\sigma S_t\\,\\mathrm{d}W_t,\\qquad S_00,\n$$\nwhere $\\mu\\in\\mathbb{R}$ and $\\sigma0$ are constants. Using only core definitions and well-tested results such as Itô's lemma and the moment generating function of a normal distribution, derive a closed-form expression for the moment $\\mathbb{E}\\!\\left[S_t^n\\right]$ for any real $n$ for which the moment exists. Express your final answer as a single analytic expression in terms of $S_0$, $\\mu$, $\\sigma$, $t$, and $n$.", "solution": "The asset price process $S_t$ is governed by the SDE:\n$$\n\\mathrm{d}S_t = \\mu S_t \\mathrm{d}t + \\sigma S_t \\mathrm{d}W_t\n$$\nwith an initial value $S_0  0$. The parameters $\\mu$ (drift) and $\\sigma  0$ (volatility) are constants, and $W_t$ is a standard Wiener process. Our objective is to find a closed-form expression for $\\mathbb{E}[S_t^n]$.\n\nA standard technique to solve this SDE is to transform the variable $S_t$ to a new variable whose SDE is simpler. Let us define a new process $X_t$ by the transformation $X_t = f(S_t) = \\ln(S_t)$. We apply Itô's lemma to find the SDE for $X_t$.\n\nThe required partial derivatives of $f(S_t) = \\ln(S_t)$ are:\n$$\n\\frac{\\partial f}{\\partial S_t} = \\frac{1}{S_t}\n$$\n$$\n\\frac{\\partial^2 f}{\\partial S_t^2} = -\\frac{1}{S_t^2}\n$$\nSubstituting these into the Itô's lemma formula, we get the differential for $X_t = \\ln(S_t)$:\n$$\n\\mathrm{d}X_t = \\mathrm{d}(\\ln S_t) = \\left( (\\mu S_t)\\left(\\frac{1}{S_t}\\right) + \\frac{1}{2}(\\sigma S_t)^2\\left(-\\frac{1}{S_t^2}\\right) \\right) \\mathrm{d}t + (\\sigma S_t)\\left(\\frac{1}{S_t}\\right) \\mathrm{d}W_t\n$$\nSimplifying the terms within the parentheses gives:\n$$\n\\mathrm{d}(\\ln S_t) = \\left( \\mu - \\frac{1}{2}\\sigma^2 \\right) \\mathrm{d}t + \\sigma \\mathrm{d}W_t\n$$\nThis is an arithmetic Brownian motion with constant drift $\\left(\\mu - \\frac{1}{2}\\sigma^2\\right)$ and constant volatility $\\sigma$. We can solve this SDE by direct integration from time $0$ to $t$:\n$$\n\\int_0^t \\mathrm{d}(\\ln S_u) = \\int_0^t \\left( \\mu - \\frac{1}{2}\\sigma^2 \\right) \\mathrm{d}u + \\int_0^t \\sigma \\mathrm{d}W_u\n$$\n$$\n\\ln(S_t) - \\ln(S_0) = \\left( \\mu - \\frac{1}{2}\\sigma^2 \\right)t + \\sigma (W_t - W_0)\n$$\nBy definition, a standard Wiener process starts at zero, so $W_0=0$. Thus, we have:\n$$\n\\ln(S_t) = \\ln(S_0) + \\left( \\mu - \\frac{1}{2}\\sigma^2 \\right)t + \\sigma W_t\n$$\nTo find the explicit solution for $S_t$, we exponentiate both sides of the equation:\n$$\nS_t = \\exp\\left( \\ln(S_0) + \\left( \\mu - \\frac{1}{2}\\sigma^2 \\right)t + \\sigma W_t \\right)\n$$\n$$\nS_t = S_0 \\exp\\left( \\left( \\mu - \\frac{1}{2}\\sigma^2 \\right)t + \\sigma W_t \\right)\n$$\nThis is the closed-form solution for the geometric Brownian motion process $S_t$.\n\nNow, we can compute the desired moment, $\\mathbb{E}[S_t^n]$, for any real number $n$.\n$$\n\\mathbb{E}[S_t^n] = \\mathbb{E}\\left[ \\left( S_0 \\exp\\left( \\left( \\mu - \\frac{1}{2}\\sigma^2 \\right)t + \\sigma W_t \\right) \\right)^n \\right]\n$$\nUsing the properties of exponents, we have:\n$$\n\\mathbb{E}[S_t^n] = \\mathbb{E}\\left[ S_0^n \\exp\\left( n\\left( \\mu - \\frac{1}{2}\\sigma^2 \\right)t + n\\sigma W_t \\right) \\right]\n$$\nSince $S_0$ is a given constant (non-random) and the term involving $t$ is also deterministic, we can pull them out of the expectation:\n$$\n\\mathbb{E}[S_t^n] = S_0^n \\exp\\left( n\\left( \\mu - \\frac{1}{2}\\sigma^2 \\right)t \\right) \\mathbb{E}\\left[ \\exp(n\\sigma W_t) \\right]\n$$\nThe remaining expectation term, $\\mathbb{E}[\\exp(n\\sigma W_t)]$, involves the random variable $W_t$. For a fixed time $t$, $W_t$ is a normally distributed random variable with mean $0$ and variance $t$, i.e., $W_t \\sim \\mathcal{N}(0, t)$.\n\nThe expectation $\\mathbb{E}[\\exp(kZ)]$ is the moment generating function (MGF) of a random variable $Z$, evaluated at $k$. For a normally distributed random variable $Z \\sim \\mathcal{N}(\\mu_Z, \\sigma_Z^2)$, its MGF is given by $M_Z(k) = \\exp(k\\mu_Z + \\frac{1}{2}k^2\\sigma_Z^2)$.\nIn our case, the random variable is $W_t$, with mean $\\mu_{W_t}=0$ and variance $\\sigma_{W_t}^2=t$. The constant multiplying $W_t$ in the exponent is $k = n\\sigma$.\nApplying the MGF formula, we find:\n$$\n\\mathbb{E}[\\exp(n\\sigma W_t)] = \\exp\\left( (n\\sigma)(0) + \\frac{1}{2}(n\\sigma)^2(t) \\right) = \\exp\\left( \\frac{1}{2}n^2\\sigma^2 t \\right)\n$$\nThis MGF exists for all real $n$, so the moment $\\mathbb{E}[S_t^n]$ exists for all $n \\in \\mathbb{R}$.\n\nFinally, we substitute this result back into our expression for $\\mathbb{E}[S_t^n]$:\n$$\n\\mathbb{E}[S_t^n] = S_0^n \\exp\\left( n\\left( \\mu - \\frac{1}{2}\\sigma^2 \\right)t \\right) \\exp\\left( \\frac{1}{2}n^2\\sigma^2 t \\right)\n$$\nCombining the exponents, we obtain the final closed-form expression:\n$$\n\\mathbb{E}[S_t^n] = S_0^n \\exp\\left( n\\mu t - \\frac{1}{2}n\\sigma^2 t + \\frac{1}{2}n^2\\sigma^2 t \\right)\n$$\n$$\n\\mathbb{E}[S_t^n] = S_0^n \\exp\\left( n\\mu t + \\frac{1}{2}(n^2 - n)\\sigma^2 t \\right)\n$$\nThis can be written more compactly by factoring out $t$ in the exponent:\n$$\n\\mathbb{E}[S_t^n] = S_0^n \\exp\\left( \\left( n\\mu + \\frac{n(n-1)}{2}\\sigma^2 \\right) t \\right)\n$$", "answer": "$$ \\boxed{S_0^n \\exp\\left( \\left( n\\mu + \\frac{n(n-1)}{2}\\sigma^2 \\right) t \\right)} $$", "id": "3057173"}, {"introduction": "Theoretical models come to life when we can simulate their behavior. This final practice [@problem_id:3057144] bridges the gap between the continuous-time stochastic differential equation and its practical implementation by deriving the exact simulation formula for a GBM process. Mastering this technique allows you to generate realistic asset price paths for Monte Carlo analysis, providing a powerful tool for option pricing and risk management.", "problem": "An asset price process $\\{S_t\\}_{t \\ge 0}$ is modeled as a geometric Brownian motion (GBM), governed by the stochastic differential equation (SDE)\n$$\n\\mathrm{d}S_t = \\mu S_t \\,\\mathrm{d}t + \\sigma S_t \\,\\mathrm{d}W_t,\n$$\nwhere $\\mu \\in \\mathbb{R}$ and $\\sigma  0$ are constants and $\\{W_t\\}_{t \\ge 0}$ is a standard Brownian motion. Consider an equidistant time grid $\\{t_k\\}_{k=0}^{n}$ with $t_k = k\\,\\Delta t$ for $k \\in \\{0,1,\\dots,n\\}$ and fixed $\\Delta t  0$.\n\nStarting only from fundamental definitions and well-tested facts, namely Itô's formula, the chain rule for logarithms, and the independent, stationary, Gaussian increment property of Brownian motion, derive an exact one-step simulation formula that expresses $S_{t_{k+1}}$ solely in terms of $S_{t_k}$, the parameters $\\mu$, $\\sigma$, the step size $\\Delta t$, and a standard normal random variable $Z_k \\sim \\mathcal{N}(0,1)$.\n\nYour final answer must be a single explicit expression for $S_{t_{k+1}}$ as a function of $S_{t_k}$, $\\mu$, $\\sigma$, $\\Delta t$, and $Z_k$. Do not make any approximations. No rounding is required.", "solution": "The problem requires the derivation of an exact one-step simulation formula for a geometric Brownian motion (GBM) process $\\{S_t\\}_{t \\ge 0}$. The process is governed by the stochastic differential equation (SDE):\n$$\n\\mathrm{d}S_t = \\mu S_t \\,\\mathrm{d}t + \\sigma S_t \\,\\mathrm{d}W_t\n$$\nwhere $\\mu$ is the drift, $\\sigma$ is the volatility, and $\\{W_t\\}_{t \\ge 0}$ is a standard Brownian motion. The objective is to express $S_{t_{k+1}}$ in terms of $S_{t_k}$ over a time step $\\Delta t = t_{k+1} - t_k$.\n\nTo solve this SDE, we introduce a transformation of the process $S_t$. The multiplicative nature of the noise term suggests a logarithmic transformation. Let us define a new process $X_t = f(S_t) = \\ln(S_t)$. We can find the dynamics of $X_t$ by applying Itô's formula.\n\nFor a process $X_t = f(t, Y_t)$ where the dynamics of $Y_t$ are given by $\\mathrm{d}Y_t = a(t, Y_t)\\mathrm{d}t + b(t, Y_t)\\mathrm{d}W_t$, Itô's formula states:\n$$\n\\mathrm{d}X_t = \\left( \\frac{\\partial f}{\\partial t} + a \\frac{\\partial f}{\\partial Y_t} + \\frac{1}{2} b^2 \\frac{\\partial^2 f}{\\partial Y_t^2} \\right) \\mathrm{d}t + b \\frac{\\partial f}{\\partial Y_t} \\mathrm{d}W_t\n$$\nIn our case, $Y_t = S_t$ and the function is $f(S_t) = \\ln(S_t)$, which does not explicitly depend on $t$. The coefficients of the SDE for $S_t$ are $a(t, S_t) = \\mu S_t$ and $b(t, S_t) = \\sigma S_t$.\n\nWe first compute the required partial derivatives of $f(S_t) = \\ln(S_t)$ with respect to $S_t$:\n- The first partial derivative: $\\frac{\\partial f}{\\partial S_t} = \\frac{1}{S_t}$\n- The second partial derivative: $\\frac{\\partial^2 f}{\\partial S_t^2} = -\\frac{1}{S_t^2}$\n- The partial derivative with respect to time is $\\frac{\\partial f}{\\partial t} = 0$.\n\nNow, we substitute these derivatives and the coefficients $a$ and $b$ into Itô's formula to find the SDE for $X_t = \\ln(S_t)$:\n$$\n\\mathrm{d}(\\ln S_t) = \\left( 0 + (\\mu S_t) \\left( \\frac{1}{S_t} \\right) + \\frac{1}{2} (\\sigma S_t)^2 \\left( -\\frac{1}{S_t^2} \\right) \\right) \\mathrm{d}t + (\\sigma S_t) \\left( \\frac{1}{S_t} \\right) \\mathrm{d}W_t\n$$\nSimplifying the terms within the parentheses gives:\n$$\n\\mathrm{d}(\\ln S_t) = \\left( \\mu - \\frac{1}{2} \\sigma^2 S_t^2 \\frac{1}{S_t^2} \\right) \\mathrm{d}t + \\sigma \\mathrm{d}W_t\n$$\nThis simplifies to a linear SDE with constant coefficients, representing an arithmetic Brownian motion with drift $(\\mu - \\frac{1}{2}\\sigma^2)$ and volatility $\\sigma$:\n$$\n\\mathrm{d}(\\ln S_t) = \\left(\\mu - \\frac{1}{2}\\sigma^2\\right) \\mathrm{d}t + \\sigma \\mathrm{d}W_t\n$$\nTo find the one-step simulation formula, we integrate this SDE over the time interval $[t_k, t_{k+1}]$:\n$$\n\\int_{t_k}^{t_{k+1}} \\mathrm{d}(\\ln S_t) = \\int_{t_k}^{t_{k+1}} \\left(\\mu - \\frac{1}{2}\\sigma^2\\right) \\mathrm{d}t + \\int_{t_k}^{t_{k+1}} \\sigma \\mathrm{d}W_t\n$$\nEvaluating the integrals yields:\n$$\n\\ln(S_{t_{k+1}}) - \\ln(S_{t_k}) = \\left(\\mu - \\frac{1}{2}\\sigma^2\\right) (t_{k+1} - t_k) + \\sigma (W_{t_{k+1}} - W_{t_k})\n$$\nLet $\\Delta t = t_{k+1} - t_k$. The equation becomes:\n$$\n\\ln(S_{t_{k+1}}) - \\ln(S_{t_k}) = \\left(\\mu - \\frac{1}{2}\\sigma^2\\right) \\Delta t + \\sigma (W_{t_{k+1}} - W_{t_k})\n$$\nThe problem statement requires using the property that increments of a standard Brownian motion are independent and normally distributed. For any $t > s$, the increment $W_t - W_s$ follows a normal distribution with mean $0$ and variance $t-s$. Thus, for our time interval $\\Delta t$:\n$$\nW_{t_{k+1}} - W_{t_k} \\sim \\mathcal{N}(0, \\Delta t)\n$$\nA random variable drawn from $\\mathcal{N}(0, \\Delta t)$ can be expressed as the product of $\\sqrt{\\Delta t}$ and a standard normal random variable $Z \\sim \\mathcal{N}(0, 1)$. For each independent time step $k$, we can write:\n$$\nW_{t_{k+1}} - W_{t_k} = \\sqrt{\\Delta t} \\, Z_k\n$$\nwhere $\\{Z_k\\}$ is a sequence of independent and identically distributed standard normal random variables.\n\nSubstituting this into our integrated equation gives:\n$$\n\\ln(S_{t_{k+1}}) - \\ln(S_{t_k}) = \\left(\\mu - \\frac{1}{2}\\sigma^2\\right) \\Delta t + \\sigma \\sqrt{\\Delta t} \\, Z_k\n$$\nTo find the explicit formula for $S_{t_{k+1}}$, we first isolate $\\ln(S_{t_{k+1}})$:\n$$\n\\ln(S_{t_{k+1}}) = \\ln(S_{t_k}) + \\left(\\mu - \\frac{1}{2}\\sigma^2\\right) \\Delta t + \\sigma \\sqrt{\\Delta t} \\, Z_k\n$$\nFinally, we exponentiate both sides to solve for $S_{t_{k+1}}$:\n$$\nS_{t_{k+1}} = \\exp\\left( \\ln(S_{t_k}) + \\left(\\mu - \\frac{1}{2}\\sigma^2\\right) \\Delta t + \\sigma \\sqrt{\\Delta t} \\, Z_k \\right)\n$$\nUsing the property $\\exp(a+b) = \\exp(a)\\exp(b)$, we can separate the $S_{t_k}$ term:\n$$\nS_{t_{k+1}} = \\exp(\\ln(S_{t_k})) \\exp\\left( \\left(\\mu - \\frac{1}{2}\\sigma^2\\right) \\Delta t + \\sigma \\sqrt{\\Delta t} \\, Z_k \\right)\n$$\nSince $\\exp(\\ln(x))=x$, we arrive at the exact one-step simulation formula for geometric Brownian motion:\n$$\nS_{t_{k+1}} = S_{t_k} \\exp\\left( \\left(\\mu - \\frac{1}{2}\\sigma^2\\right) \\Delta t + \\sigma \\sqrt{\\Delta t} \\, Z_k \\right)\n$$\nThis formula expresses $S_{t_{k+1}}$ solely in terms of $S_{t_k}$ and the given parameters, as required.", "answer": "$$\n\\boxed{S_{t_k} \\exp\\left( \\left(\\mu - \\frac{1}{2}\\sigma^2\\right) \\Delta t + \\sigma \\sqrt{\\Delta t} Z_k \\right)}\n$$", "id": "3057144"}]}