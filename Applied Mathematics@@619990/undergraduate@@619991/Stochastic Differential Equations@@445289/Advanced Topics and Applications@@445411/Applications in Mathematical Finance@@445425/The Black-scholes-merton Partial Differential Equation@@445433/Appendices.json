{"hands_on_practices": [{"introduction": "The Black-Scholes-Merton (BSM) framework is fundamentally built on the assumption that stock prices follow a specific random process known as Geometric Brownian Motion. This first practice takes you back to that foundation by asking you to solve the stochastic differential equation (SDE) that governs this process [@problem_id:3079825]. By applying Itô's lemma, a cornerstone of stochastic calculus, you will derive the explicit formula for the stock price, solidifying your understanding of the lognormal property that underpins the entire BSM model.", "problem": "Consider the Black-Scholes-Merton (BSM) framework for a non-dividend-paying stock price process modeled by the stochastic differential equation (SDE) $dS_t=\\mu S_t\\,dt+\\sigma S_t\\,dW_t$ for $t\\geq 0$, where $S_0>0$, $\\mu\\in\\mathbb{R}$ and $\\sigma>0$ are constants, and $(W_t)_{t\\geq 0}$ is a standard Brownian motion on a filtered probability space satisfying the usual conditions. This stock dynamics underlies the derivation of the Black-Scholes-Merton partial differential equation (PDE) for derivative prices. Using only the definitions and properties of Itô processes and Itô’s lemma, and assuming $S_t>0$ so that the logarithm is well-defined, derive the explicit solution of the SDE by transforming with $Y_t=\\ln S_t$, identifying the drift and diffusion of $Y_t$, integrating over time, and inverting the transformation to obtain $S_t$ in closed form. Provide your final expression for $S_t$ as a function of $S_0$, $t$, $W_t$, $\\mu$, and $\\sigma$. Your final answer must be a single closed-form analytic expression with no expectations or limits.", "solution": "We start from the given stochastic differential equation (SDE) for the stock price process in the Black-Scholes-Merton (BSM) model:\n$$\ndS_t=\\mu S_t\\,dt+\\sigma S_t\\,dW_t,\\quad S_0>0,\n$$\nwhere $(W_t)_{t\\geq 0}$ is a standard Brownian motion, and $\\mu\\in\\mathbb{R}$, $\\sigma>0$ are constants. We are to derive an explicit solution using Itô’s lemma by considering the logarithmic transformation $Y_t=\\ln S_t$. The key foundational tool is Itô’s lemma for a twice continuously differentiable function $f:\\mathbb{R}_{+}\\to\\mathbb{R}$ applied to an Itô process $X_t$ satisfying $dX_t=a_t\\,dt+b_t\\,dW_t$, which states:\n$$\ndf(X_t)=f^{\\prime}(X_t)\\,dX_t+\\frac{1}{2}f^{\\prime\\prime}(X_t)\\,b_t^{2}\\,dt.\n$$\n\nHere, we take $X_t=S_t$ and $f(x)=\\ln x$. We compute the derivatives:\n$$\nf^{\\prime}(x)=\\frac{1}{x},\\qquad f^{\\prime\\prime}(x)=-\\frac{1}{x^{2}}.\n$$\nSince $dS_t=\\mu S_t\\,dt+\\sigma S_t\\,dW_t$, we have $a_t=\\mu S_t$ and $b_t=\\sigma S_t$. Applying Itô’s lemma to $Y_t=\\ln S_t$ yields\n$$\ndY_t=f^{\\prime}(S_t)\\,dS_t+\\frac{1}{2}f^{\\prime\\prime}(S_t)\\,b_t^{2}\\,dt\n=\\frac{1}{S_t}\\left(\\mu S_t\\,dt+\\sigma S_t\\,dW_t\\right)+\\frac{1}{2}\\left(-\\frac{1}{S_t^{2}}\\right)\\left(\\sigma^{2}S_t^{2}\\right)dt.\n$$\nSimplifying the expression gives\n$$\ndY_t=\\mu\\,dt+\\sigma\\,dW_t-\\frac{1}{2}\\sigma^{2}\\,dt=(\\mu-\\tfrac{1}{2}\\sigma^{2})\\,dt+\\sigma\\,dW_t.\n$$\n\nWe now integrate both sides from $0$ to $t$. Using $Y_0=\\ln S_0$ and the fact that $W_0=0$, we obtain\n$$\nY_t-Y_0=\\int_{0}^{t}\\left(\\mu-\\tfrac{1}{2}\\sigma^{2}\\right)\\,ds+\\int_{0}^{t}\\sigma\\,dW_s.\n$$\nThe first integral is deterministic and equals $(\\mu-\\tfrac{1}{2}\\sigma^{2})t$. The second integral is a stochastic integral with respect to Brownian motion and equals $\\sigma W_t$ because $\\int_{0}^{t}dW_s=W_t-W_0=W_t$. Therefore,\n$$\n\\ln S_t-\\ln S_0=(\\mu-\\tfrac{1}{2}\\sigma^{2})t+\\sigma W_t.\n$$\nExponentiating both sides gives the explicit solution:\n$$\nS_t=S_0\\exp\\!\\left((\\mu-\\tfrac{1}{2}\\sigma^{2})t+\\sigma W_t\\right).\n$$\n\nThis closed-form expression shows that $S_t$ is strictly positive given $S_0>0$, and that $\\ln S_t$ is normally distributed with mean $\\ln S_0+(\\mu-\\tfrac{1}{2}\\sigma^{2})t$ and variance $\\sigma^{2}t$. In the Black-Scholes-Merton framework under the risk-neutral measure where $\\mu$ is replaced by the risk-free rate $r$, this explicit solution underpins the derivation of the Black-Scholes-Merton partial differential equation (PDE) by ensuring the lognormal dynamics consistent with no-arbitrage pricing. The required final expression for $S_t$ is as derived above.", "answer": "$$\\boxed{S_0\\,\\exp\\!\\left((\\mu-\\tfrac{1}{2}\\sigma^{2})\\,t+\\sigma\\,W_t\\right)}$$", "id": "3079825"}, {"introduction": "While the BSM partial differential equation (PDE) describes how an option's price should evolve to prevent arbitrage, the celebrated BSM formula gives us an explicit price. This exercise challenges you to connect these two cornerstones by directly verifying that the formula is, in fact, a solution to the PDE [@problem_id:3079802]. This is a rigorous test of your calculus skills, requiring you to compute the partial derivatives of the option price (the \"Greeks\") and demonstrate how they perfectly balance out, satisfying the no-arbitrage condition.", "problem": "Consider an underlying asset price process $\\{S_t\\}_{t \\ge 0}$ modeled under the risk-neutral measure by the stochastic differential equation (SDE) $dS_t = (r - q) S_t \\, dt + \\sigma S_t \\, dW_t$, where $r > 0$ is the constant risk-free interest rate, $q \\ge 0$ is the constant continuous dividend yield, $\\sigma > 0$ is the constant volatility, and $\\{W_t\\}_{t \\ge 0}$ is a standard Brownian motion. Let $K > 0$ be the strike and $T > 0$ the maturity. Define the time-to-maturity $\\tau = T - t$ and the standard Black–Scholes–Merton (BSM) call price\n$$\nC(S,t) = S \\exp(-q \\tau) \\, \\Phi(d_1) - K \\exp(-r \\tau) \\, \\Phi(d_2),\n$$\nwhere\n$$\nd_1 = \\frac{\\ln\\!\\left(\\frac{S}{K}\\right) + \\left(r - q + \\frac{1}{2} \\sigma^2\\right) \\tau}{\\sigma \\sqrt{\\tau}}, \n\\qquad\nd_2 = d_1 - \\sigma \\sqrt{\\tau},\n$$\nand where $\\Phi(x)$ is the cumulative distribution function of the standard normal distribution and $\\varphi(x) = \\frac{1}{\\sqrt{2 \\pi}} \\exp\\!\\left(-\\frac{x^2}{2}\\right)$ is its probability density function. The Black–Scholes–Merton partial differential equation (BSM PDE) operator applied to a price function $C(S,t)$ is\n$$\n\\mathcal{L}[C] := C_t + \\frac{1}{2} \\sigma^2 S^2 C_{SS} + (r - q) S C_S - r C,\n$$\nwhere subscripts denote partial derivatives.\n\nStarting from the definitions above and using only standard calculus (product rule, chain rule) and properties of $\\Phi$ and $\\varphi$, compute and simplify the residual\n$R(S,t) := \\mathcal{L}[C]$\nobtained by substituting the given $C(S,t)$ into the BSM PDE operator. Express your final answer as a single closed-form analytic expression. No numerical approximation is required.", "solution": "The objective is to compute the residual $R(S,t) = \\mathcal{L}[C]$ by substituting the Black-Scholes-Merton (BSM) call option price formula $C(S,t)$ into the BSM partial differential equation (PDE) operator:\n$$\n\\mathcal{L}[C] = C_t + \\frac{1}{2} \\sigma^2 S^2 C_{SS} + (r - q) S C_S - r C\n$$\nwhere subscripts denote partial derivatives. The calculation requires computing the partial derivatives $C_S$, $C_{SS}$, and $C_t$. Let $\\tau = T-t$, so that $\\frac{\\partial \\tau}{\\partial t} = -1$.\n\nFirst, we calculate the partial derivatives of $d_1$ and $d_2$ with respect to $S$ and $t$.\n$$\nd_1 = \\frac{\\ln(S) - \\ln(K) + (r - q + \\frac{1}{2} \\sigma^2) \\tau}{\\sigma \\sqrt{\\tau}}\n$$\n$$\nd_2 = d_1 - \\sigma \\sqrt{\\tau} = \\frac{\\ln(S) - \\ln(K) + (r - q - \\frac{1}{2} \\sigma^2) \\tau}{\\sigma \\sqrt{\\tau}}\n$$\nThe derivatives with respect to $S$ are:\n$$\n\\frac{\\partial d_1}{\\partial S} = \\frac{1}{S \\sigma \\sqrt{\\tau}}, \\qquad \\frac{\\partial d_2}{\\partial S} = \\frac{1}{S \\sigma \\sqrt{\\tau}}\n$$\nThe derivatives with respect to $t$ are found using the chain rule: $\\frac{\\partial}{\\partial t} = \\frac{\\partial \\tau}{\\partial t} \\frac{\\partial}{\\partial \\tau} = - \\frac{\\partial}{\\partial \\tau}$.\n$$\n\\frac{\\partial d_1}{\\partial \\tau} = \\frac{\\partial}{\\partial \\tau} \\left( \\frac{\\ln(S/K)}{\\sigma} \\tau^{-1/2} + \\frac{r-q+\\frac{1}{2}\\sigma^2}{\\sigma} \\tau^{1/2} \\right) = \\frac{\\ln(S/K)}{\\sigma} \\left(-\\frac{1}{2}\\tau^{-3/2}\\right) + \\frac{r-q+\\frac{1}{2}\\sigma^2}{\\sigma} \\left(\\frac{1}{2}\\tau^{-1/2}\\right)\n$$\n$$\n\\frac{\\partial d_1}{\\partial t} = - \\frac{\\partial d_1}{\\partial \\tau} = \\frac{\\ln(S/K)}{2\\sigma\\tau^{3/2}} - \\frac{r-q+\\frac{1}{2}\\sigma^2}{2\\sigma\\sqrt{\\tau}}\n$$\nFor $d_2$:\n$$\n\\frac{\\partial d_2}{\\partial t} = \\frac{\\partial d_1}{\\partial t} - \\sigma \\frac{\\partial \\sqrt{\\tau}}{\\partial t} = \\frac{\\partial d_1}{\\partial t} - \\sigma \\left(\\frac{1}{2\\sqrt{\\tau}}\\right)(-1) = \\frac{\\partial d_1}{\\partial t} + \\frac{\\sigma}{2\\sqrt{\\tau}}\n$$\nThis implies a key relationship:\n$$\n\\frac{\\partial d_1}{\\partial t} - \\frac{\\partial d_2}{\\partial t} = -\\frac{\\sigma}{2\\sqrt{\\tau}}\n$$\nNext, we establish a crucial identity relating $\\varphi(d_1)$ and $\\varphi(d_2)$.\n$$\nd_2 = d_1 - \\sigma\\sqrt{\\tau} \\implies d_2^2 = d_1^2 - 2d_1\\sigma\\sqrt{\\tau} + \\sigma^2\\tau\n$$\nSubstituting for $d_1\\sigma\\sqrt{\\tau}$:\n$$\nd_1\\sigma\\sqrt{\\tau} = \\ln(S/K) + (r-q)\\tau + \\frac{1}{2}\\sigma^2\\tau\n$$\nThen,\n$$\n-\\frac{d_2^2}{2} = -\\frac{d_1^2}{2} + d_1\\sigma\\sqrt{\\tau} - \\frac{1}{2}\\sigma^2\\tau = -\\frac{d_1^2}{2} + \\ln(S/K) + (r-q)\\tau\n$$\nExponentiating this gives the relationship between the PDFs:\n$$\n\\varphi(d_2) = \\frac{1}{\\sqrt{2\\pi}} \\exp\\left(-\\frac{d_2^2}{2}\\right) = \\frac{1}{\\sqrt{2\\pi}} \\exp\\left(-\\frac{d_1^2}{2}\\right) \\exp(\\ln(S/K) + (r-q)\\tau) = \\varphi(d_1) \\frac{S}{K} \\exp((r-q)\\tau)\n$$\nRearranging this yields the identity:\n$$\nK \\exp(-r\\tau) \\varphi(d_2) = K \\exp(-r\\tau) \\left( \\varphi(d_1) \\frac{S}{K} \\exp(r\\tau)\\exp(-q\\tau) \\right) = S \\exp(-q\\tau) \\varphi(d_1)\n$$\nThis identity is central to the following derivations.\n\nLet's compute the partial derivatives of $C(S,t)$.\n\n1.  **Delta ($C_S$):**\n    $$\n    C_S = \\frac{\\partial}{\\partial S} \\left( S \\exp(-q \\tau) \\Phi(d_1) - K \\exp(-r \\tau) \\Phi(d_2) \\right)\n    $$\n    Using the product rule and chain rule, with $\\frac{\\partial \\Phi(x)}{\\partial S} = \\varphi(x) \\frac{\\partial x}{\\partial S}$:\n    $$\n    C_S = \\exp(-q \\tau) \\Phi(d_1) + S \\exp(-q \\tau) \\varphi(d_1) \\frac{\\partial d_1}{\\partial S} - K \\exp(-r \\tau) \\varphi(d_2) \\frac{\\partial d_2}{\\partial S}\n    $$\n    $$\n    C_S = \\exp(-q \\tau) \\Phi(d_1) + S \\exp(-q \\tau) \\varphi(d_1) \\frac{1}{S \\sigma \\sqrt{\\tau}} - K \\exp(-r \\tau) \\varphi(d_2) \\frac{1}{S \\sigma \\sqrt{\\tau}}\n    $$\n    $$\n    C_S = \\exp(-q \\tau) \\Phi(d_1) + \\frac{1}{S \\sigma \\sqrt{\\tau}} \\left( S \\exp(-q \\tau) \\varphi(d_1) - K \\exp(-r \\tau) \\varphi(d_2) \\right)\n    $$\n    The term in the parenthesis is zero due to our derived identity. Thus, the option's Delta is:\n    $$\n    C_S = \\exp(-q \\tau) \\Phi(d_1)\n    $$\n\n2.  **Gamma ($C_{SS}$):**\n    We differentiate $C_S$ with respect to $S$:\n    $$\n    C_{SS} = \\frac{\\partial C_S}{\\partial S} = \\frac{\\partial}{\\partial S} \\left( \\exp(-q \\tau) \\Phi(d_1) \\right) = \\exp(-q \\tau) \\varphi(d_1) \\frac{\\partial d_1}{\\partial S}\n    $$\n    $$\n    C_{SS} = \\exp(-q \\tau) \\varphi(d_1) \\frac{1}{S \\sigma \\sqrt{\\tau}} = \\frac{\\exp(-q \\tau) \\varphi(d_1)}{S \\sigma \\sqrt{\\tau}}\n    $$\n    \n3.  **Theta ($C_t$):**\n    We differentiate $C(S,t)$ with respect to $t$:\n    $$\n    C_t = \\frac{\\partial}{\\partial t} \\left( S \\exp(-q \\tau) \\Phi(d_1) - K \\exp(-r \\tau) \\Phi(d_2) \\right)\n    $$\n    Let's differentiate term by term. For the first term:\n    $$\n    \\frac{\\partial}{\\partial t} (S \\exp(-q\\tau) \\Phi(d_1)) = S \\left( \\exp(-q\\tau)(-q)(-1)\\Phi(d_1) + \\exp(-q\\tau)\\varphi(d_1)\\frac{\\partial d_1}{\\partial t} \\right)\n    $$\n    $$\n    = q S \\exp(-q\\tau) \\Phi(d_1) + S \\exp(-q\\tau) \\varphi(d_1) \\frac{\\partial d_1}{\\partial t}\n    $$\n    For the second term:\n    $$\n    \\frac{\\partial}{\\partial t} (K \\exp(-r\\tau) \\Phi(d_2)) = K \\left( \\exp(-r\\tau)(-r)(-1)\\Phi(d_2) + \\exp(-r\\tau)\\varphi(d_2)\\frac{\\partial d_2}{\\partial t} \\right)\n    $$\n    $$\n    = r K \\exp(-r\\tau) \\Phi(d_2) + K \\exp(-r\\tau) \\varphi(d_2) \\frac{\\partial d_2}{\\partial t}\n    $$\n    Combining them gives $C_t$:\n    $$\n    C_t = q S \\exp(-q\\tau) \\Phi(d_1) - r K \\exp(-r\\tau) \\Phi(d_2) + S \\exp(-q\\tau) \\varphi(d_1) \\frac{\\partial d_1}{\\partial t} - K \\exp(-r\\tau) \\varphi(d_2) \\frac{\\partial d_2}{\\partial t}\n    $$\n    Using the identity $S \\exp(-q\\tau) \\varphi(d_1) = K \\exp(-r\\tau) \\varphi(d_2)$, we can factor the last two terms:\n    $$\n    C_t = q S \\exp(-q\\tau) \\Phi(d_1) - r K \\exp(-r\\tau) \\Phi(d_2) + S \\exp(-q\\tau) \\varphi(d_1) \\left( \\frac{\\partial d_1}{\\partial t} - \\frac{\\partial d_2}{\\partial t} \\right)\n    $$\n    Substituting $\\frac{\\partial d_1}{\\partial t} - \\frac{\\partial d_2}{\\partial t} = -\\frac{\\sigma}{2\\sqrt{\\tau}}$:\n    $$\n    C_t = q S \\exp(-q\\tau) \\Phi(d_1) - r K \\exp(-r\\tau) \\Phi(d_2) - \\frac{S \\sigma \\exp(-q\\tau) \\varphi(d_1)}{2\\sqrt{\\tau}}\n    $$\n\nFinally, we substitute these derivatives into the BSM PDE operator $\\mathcal{L}[C]$.\n$$\n\\mathcal{L}[C] = C_t + \\frac{1}{2} \\sigma^2 S^2 C_{SS} + (r - q) S C_S - r C\n$$\nLet's assemble the terms:\n- $C_t = q S e^{-q\\tau} \\Phi(d_1) - r K e^{-r\\tau} \\Phi(d_2) - \\frac{S \\sigma e^{-q\\tau} \\varphi(d_1)}{2\\sqrt{\\tau}}$\n- $\\frac{1}{2} \\sigma^2 S^2 C_{SS} = \\frac{1}{2} \\sigma^2 S^2 \\left(\\frac{e^{-q \\tau} \\varphi(d_1)}{S \\sigma \\sqrt{\\tau}}\\right) = \\frac{S \\sigma e^{-q \\tau} \\varphi(d_1)}{2\\sqrt{\\tau}}$\n- $(r - q) S C_S = (r - q) S \\left(e^{-q\\tau} \\Phi(d_1)\\right) = r S e^{-q\\tau} \\Phi(d_1) - q S e^{-q\\tau} \\Phi(d_1)$\n- $-r C = -r \\left(S e^{-q\\tau} \\Phi(d_1) - K e^{-r\\tau} \\Phi(d_2)\\right) = -r S e^{-q\\tau} \\Phi(d_1) + r K e^{-r\\tau} \\Phi(d_2)$\n\nSumming all components:\n$$\n\\mathcal{L}[C] = \\left( q S e^{-q\\tau} \\Phi(d_1) - r K e^{-r\\tau} \\Phi(d_2) - \\frac{S \\sigma e^{-q\\tau} \\varphi(d_1)}{2\\sqrt{\\tau}} \\right)\n+ \\left( \\frac{S \\sigma e^{-q \\tau} \\varphi(d_1)}{2\\sqrt{\\tau}} \\right)\n$$\n$$\n+ \\left( r S e^{-q\\tau} \\Phi(d_1) - q S e^{-q\\tau} \\Phi(d_1) \\right)\n+ \\left( -r S e^{-q\\tau} \\Phi(d_1) + r K e^{-r\\tau} \\Phi(d_2) \\right)\n$$\nWe group terms by their functional components:\n- Terms involving $\\varphi(d_1)$:\n  $$\n  -\\frac{S \\sigma e^{-q\\tau} \\varphi(d_1)}{2\\sqrt{\\tau}} + \\frac{S \\sigma e^{-q \\tau} \\varphi(d_1)}{2\\sqrt{\\tau}} = 0\n  $$\n- Terms involving $\\Phi(d_1)$:\n  $$\n  (q S e^{-q\\tau}) \\Phi(d_1) + (r S e^{-q\\tau}) \\Phi(d_1) - (q S e^{-q\\tau}) \\Phi(d_1) - (r S e^{-q\\tau}) \\Phi(d_1) = (q+r-q-r) S e^{-q\\tau} \\Phi(d_1) = 0\n  $$\n- Terms involving $\\Phi(d_2)$:\n  $$\n  (-r K e^{-r\\tau}) \\Phi(d_2) + (r K e^{-r\\tau}) \\Phi(d_2) = 0\n  $$\nAll terms cancel out.\nTherefore, the residual is zero.\n$$\nR(S,t) = \\mathcal{L}[C] = 0 + 0 + 0 = 0\n$$\nThis demonstrates that the BSM formula for a European call option price is indeed a solution to the BSM partial differential equation.", "answer": "$$\n\\boxed{0}\n$$", "id": "3079802"}, {"introduction": "For many complex derivatives, analytical solutions like the BSM formula are not available, forcing us to turn to numerical methods. This final practice provides a window into the world of computational finance by exploring a finite difference scheme for solving the BSM PDE [@problem_id:3079816]. You will transform the BSM equation into the simpler heat equation and analyze the stability of an explicit numerical method, deriving the famous Courant–Friedrichs–Lewy (CFL) condition which is essential for ensuring that a numerical simulation produces meaningful, non-divergent results.", "problem": "Consider a non-dividend-paying stock whose price process $\\{S_{t}\\}_{t \\ge 0}$ follows the risk-neutral geometric Brownian motion\n$\n\\mathrm{d}S_{t} = r\\,S_{t}\\,\\mathrm{d}t + \\sigma\\,S_{t}\\,\\mathrm{d}W_{t},\n$\nwhere $r>0$ is the constant risk-free rate, $\\sigma>0$ is the constant volatility, and $\\{W_{t}\\}_{t \\ge 0}$ is a standard Brownian motion. Let $V(S,t)$ denote the no-arbitrage price of a European contingent claim with maturity $T$. Starting from the above stochastic differential equation and the self-financing replication argument, proceed as follows:\n\n1. Derive the governing partial differential equation for $V(S,t)$ under the risk-neutral measure. Introduce the log-price variable $x=\\ln S$ and the time-to-maturity variable $\\tau=T-t$, and define $U(x,\\tau)=V(S,t)$ with $S=\\exp(x)$. Derive the transformed equation for $U(x,\\tau)$.\n\n2. Remove the zeroth-order term by discounting, defining $u(x,\\tau)=\\exp(r\\tau)\\,U(x,\\tau)$, and then eliminate the first-order spatial derivative by a change of variables of the form $w(x,\\tau)=u(x+c\\,\\tau,\\tau)$ for an appropriate constant $c\\in\\mathbb{R}$. Determine $c$ so that $w(x,\\tau)$ satisfies a constant-coefficient heat equation of the form\n$\nw_{\\tau} = a\\,w_{xx},\n$\nand identify $a$ in terms of $\\sigma$.\n\n3. On a uniform grid $x_{j}=x_{0}+j\\,\\Delta x$ and $\\tau_{n}=n\\,\\Delta t$, discretize this heat equation using the forward-time, central-space explicit scheme:\n$$\nw_{j}^{n+1} \\;=\\; w_{j}^{n} \\;+\\; \\mu\\left(w_{j+1}^{n} - 2\\,w_{j}^{n} + w_{j-1}^{n}\\right),\n\\qquad \\text{with} \\quad \\mu \\equiv \\frac{a\\,\\Delta t}{(\\Delta x)^{2}}.\n$$\n\n4. Using a von Neumann Fourier-mode analysis, derive the stability condition on $\\mu$ and hence obtain a Courant–Friedrichs–Lewy (CFL)-type restriction on the time step $\\Delta t$ relative to the spatial step $\\Delta x$ for this transformed explicit scheme.\n\nYour final task: express the largest constant $C$ (in closed form, as a function of $\\sigma$ only) such that the stability restriction can be written in the form\n$\n\\Delta t \\le C\\,(\\Delta x)^{2}.\n$\nReport only this constant $C$ as your final answer. No numerical approximation or rounding is required.", "solution": "The problem asks for the derivation of a stability condition for a finite difference scheme applied to a transformed Black-Scholes-Merton (BSM) partial differential equation (PDE), and to identify a specific constant $C$ from this condition. We proceed through the steps outlined in the problem statement.\n\n**Step 1: Derivation of the BSM PDE and its transformation**\n\nWe begin with the risk-neutral stochastic differential equation (SDE) for the stock price $S_{t}$:\n$ \\mathrm{d}S_{t} = r S_{t} \\mathrm{d}t + \\sigma S_{t} \\mathrm{d}W_{t} $\nLet $V(S,t)$ be the no-arbitrage price of a European contingent claim. According to arbitrage theory under the risk-neutral measure, the discounted price process, $\\exp(-rt)V(S_t, t)$, must be a martingale. To find the PDE that $V$ must satisfy, we apply Itô's lemma to $V(S,t)$:\n$$ \\mathrm{d}V = \\frac{\\partial V}{\\partial t}\\mathrm{d}t + \\frac{\\partial V}{\\partial S}\\mathrm{d}S + \\frac{1}{2}\\frac{\\partial^2 V}{\\partial S^2}(\\mathrm{d}S)^2 $$\nThe quadratic variation term is $(\\mathrm{d}S)^2 = (\\sigma S \\mathrm{d}W_t)^2 = \\sigma^2 S^2 \\mathrm{d}t$. Substituting the SDE for $\\mathrm{d}S$ gives:\n$$ \\mathrm{d}V = \\left( \\frac{\\partial V}{\\partial t} + rS\\frac{\\partial V}{\\partial S} + \\frac{1}{2}\\sigma^2 S^2 \\frac{\\partial^2 V}{\\partial S^2} \\right)\\mathrm{d}t + \\sigma S \\frac{\\partial V}{\\partial S} \\mathrm{d}W_t $$\nFor the discounted process $\\exp(-rt)V(S_t,t)$ to be a martingale, its drift must be zero. The drift of $\\mathrm{d}(\\exp(-rt)V)$ is $\\exp(-rt)(\\mathrm{d}V - rV\\mathrm{d}t)$. Setting the total drift coefficient to zero yields the BSM PDE:\n$$ \\frac{\\partial V}{\\partial t} + rS\\frac{\\partial V}{\\partial S} + \\frac{1}{2}\\sigma^2 S^2 \\frac{\\partial^2 V}{\\partial S^2} - rV = 0 $$\nNext, we perform the change of variables $x=\\ln S$ and $\\tau=T-t$, and define $U(x,\\tau) = V(S,t)$. We compute the partial derivatives of $V$ in terms of $U$:\n- $\\frac{\\partial V}{\\partial t} = \\frac{\\partial U}{\\partial \\tau} \\frac{\\partial \\tau}{\\partial t} = -\\frac{\\partial U}{\\partial \\tau}$\n- $\\frac{\\partial V}{\\partial S} = \\frac{\\partial U}{\\partial x} \\frac{\\partial x}{\\partial S} = \\frac{1}{S} \\frac{\\partial U}{\\partial x}$\n- $\\frac{\\partial^2 V}{\\partial S^2} = \\frac{\\partial}{\\partial S}\\left( \\frac{1}{S} \\frac{\\partial U}{\\partial x} \\right) = -\\frac{1}{S^2}\\frac{\\partial U}{\\partial x} + \\frac{1}{S}\\frac{\\partial}{\\partial S}\\left(\\frac{\\partial U}{\\partial x}\\right) = -\\frac{1}{S^2}\\frac{\\partial U}{\\partial x} + \\frac{1}{S}\\left(\\frac{\\partial^2 U}{\\partial x^2}\\frac{\\partial x}{\\partial S}\\right) = \\frac{1}{S^2}\\left(\\frac{\\partial^2 U}{\\partial x^2} - \\frac{\\partial U}{\\partial x}\\right)$\nSubstituting these into the BSM PDE:\n$$ -\\frac{\\partial U}{\\partial \\tau} + rS\\left(\\frac{1}{S}\\frac{\\partial U}{\\partial x}\\right) + \\frac{1}{2}\\sigma^2 S^2 \\left(\\frac{1}{S^2}\\left(\\frac{\\partial^2 U}{\\partial x^2} - \\frac{\\partial U}{\\partial x}\\right)\\right) - rU = 0 $$\nSimplifying and rearranging the terms gives the PDE for $U(x, \\tau)$:\n$$ \\frac{\\partial U}{\\partial \\tau} = \\frac{1}{2}\\sigma^2 \\frac{\\partial^2 U}{\\partial x^2} + \\left(r - \\frac{1}{2}\\sigma^2\\right)\\frac{\\partial U}{\\partial x} - rU $$\n\n**Step 2: Reduction to the constant-coefficient heat equation**\n\nFirst, we remove the zeroth-order term $-rU$ by the discounting transformation $u(x, \\tau) = \\exp(r\\tau)U(x, \\tau)$, which implies $U(x, \\tau) = \\exp(-r\\tau)u(x, \\tau)$. The partial derivatives of $U$ are:\n- $\\frac{\\partial U}{\\partial \\tau} = -r\\exp(-r\\tau)u + \\exp(-r\\tau)\\frac{\\partial u}{\\partial \\tau}$\n- $\\frac{\\partial U}{\\partial x} = \\exp(-r\\tau)\\frac{\\partial u}{\\partial x}$\n- $\\frac{\\partial^2 U}{\\partial x^2} = \\exp(-r\\tau)\\frac{\\partial^2 u}{\\partial x^2}$\nSubstituting these into the PDE for $U$ and multiplying the entire equation by $\\exp(r\\tau)$:\n$$ -ru + \\frac{\\partial u}{\\partial \\tau} = \\frac{1}{2}\\sigma^2 \\frac{\\partial^2 u}{\\partial x^2} + \\left(r - \\frac{1}{2}\\sigma^2\\right)\\frac{\\partial u}{\\partial x} - ru $$\nThe $-ru$ terms cancel, leaving a PDE with no zeroth-order term:\n$$ \\frac{\\partial u}{\\partial \\tau} = \\frac{1}{2}\\sigma^2 \\frac{\\partial^2 u}{\\partial x^2} + \\left(r - \\frac{1}{2}\\sigma^2\\right)\\frac{\\partial u}{\\partial x} $$\nNext, we eliminate the first-order spatial derivative using the transformation $w(x,\\tau) = u(x+c\\tau, \\tau)$. Using the chain rule, we find the derivatives of $w$ in terms of the derivatives of $u$ (evaluated at $(x+c\\tau, \\tau)$):\n- $\\frac{\\partial w}{\\partial \\tau} = c \\frac{\\partial u}{\\partial x} + \\frac{\\partial u}{\\partial \\tau}$\n- $\\frac{\\partial w}{\\partial x} = \\frac{\\partial u}{\\partial x}$\n- $\\frac{\\partial^2 w}{\\partial x^2} = \\frac{\\partial^2 u}{\\partial x^2}$\nWe express $\\frac{\\partial u}{\\partial \\tau}$ from the first relation and substitute it into the PDE for $u$:\n$$ \\frac{\\partial w}{\\partial \\tau} - c \\frac{\\partial u}{\\partial x} = \\frac{1}{2}\\sigma^2 \\frac{\\partial^2 u}{\\partial x^2} + \\left(r - \\frac{1}{2}\\sigma^2\\right)\\frac{\\partial u}{\\partial x} $$\nReplacing the derivatives of $u$ with derivatives of $w$:\n$$ \\frac{\\partial w}{\\partial \\tau} = \\frac{1}{2}\\sigma^2 \\frac{\\partial^2 w}{\\partial x^2} + \\left(c + r - \\frac{1}{2}\\sigma^2\\right)\\frac{\\partial w}{\\partial x} $$\nTo eliminate the first-order term, we set its coefficient to zero:\n$$ c + r - \\frac{1}{2}\\sigma^2 = 0 \\implies c = \\frac{1}{2}\\sigma^2 - r $$\nWith this choice for the constant $c$, the PDE for $w(x,\\tau)$ simplifies to the heat equation:\n$$ \\frac{\\partial w}{\\partial \\tau} = \\frac{1}{2}\\sigma^2 \\frac{\\partial^2 w}{\\partial x^2} $$\nComparing this to the desired form $w_{\\tau} = a w_{xx}$, we identify the constant $a$ as:\n$$ a = \\frac{1}{2}\\sigma^2 $$\n\n**Steps 3 and 4: Discretization and Stability Analysis**\n\nThe problem provides the forward-time, central-space (FTCS) explicit scheme for the heat equation $w_{\\tau} = a w_{xx}$:\n$$ w_{j}^{n+1} = w_{j}^{n} + \\mu\\left(w_{j+1}^{n} - 2w_{j}^{n} + w_{j-1}^{n}\\right), \\quad \\text{with} \\quad \\mu \\equiv \\frac{a \\Delta t}{(\\Delta x)^{2}} $$\nTo analyze the stability of this scheme, we use the von Neumann method. We consider a single Fourier mode for the solution at time step $n$:\n$$ w_j^n = G(k)^n e^{i k x_j} $$\nwhere $G(k)$ is the amplification factor for a single time step $\\Delta t$ and $k$ is the wavenumber. Substituting this into the difference equation:\n$$ G^{n+1} e^{i k x_j} = G^n e^{i k x_j} + \\mu \\left( G^n e^{i k x_{j+1}} - 2G^n e^{i k x_j} + G^n e^{i k x_{j-1}} \\right) $$\nDividing by $G^n e^{i k x_j}$ and noting that $x_{j\\pm 1} = x_j \\pm \\Delta x$:\n$$ G = 1 + \\mu \\left( e^{i k \\Delta x} - 2 + e^{-i k \\Delta x} \\right) $$\nUsing Euler's identity $e^{i\\theta} + e^{-i\\theta} = 2\\cos\\theta$, we get:\n$$ G = 1 + \\mu (2\\cos(k\\Delta x) - 2) = 1 - 2\\mu(1-\\cos(k\\Delta x)) $$\nUsing the half-angle identity $1 - \\cos\\theta = 2\\sin^2(\\theta/2)$:\n$$ G = 1 - 4\\mu \\sin^2\\left(\\frac{k\\Delta x}{2}\\right) $$\nFor numerical stability, the magnitude of the amplification factor must be no greater than $1$ for all wavenumbers $k$: $|G| \\le 1$, which is equivalent to $-1 \\le G \\le 1$.\nThe condition $G \\le 1$ implies $1 - 4\\mu \\sin^2(\\frac{k\\Delta x}{2}) \\le 1$, which simplifies to $-4\\mu \\sin^2(\\frac{k\\Delta x}{2}) \\le 0$. Since $\\mu = \\frac{a \\Delta t}{(\\Delta x)^2}$ is non-negative ($a>0$, $\\Delta t>0$), this condition is always satisfied.\nThe critical condition is $G \\ge -1$:\n$$ 1 - 4\\mu \\sin^2\\left(\\frac{k\\Delta x}{2}\\right) \\ge -1 $$\n$$ 2 \\ge 4\\mu \\sin^2\\left(\\frac{k\\Delta x}{2}\\right) $$\nThis inequality must hold for all $k$. The most restrictive case occurs when $\\sin^2(\\frac{k\\Delta x}{2})$ reaches its maximum value of $1$:\n$$ 2 \\ge 4\\mu \\implies \\mu \\le \\frac{1}{2} $$\nThis is the stability condition for the FTCS scheme. Now, we substitute the expressions for $\\mu$ and $a$:\n$$ \\mu = \\frac{a \\Delta t}{(\\Delta x)^2} = \\frac{(\\frac{1}{2}\\sigma^2) \\Delta t}{(\\Delta x)^2} \\le \\frac{1}{2} $$\nSolving for the time step $\\Delta t$:\n$$ \\frac{\\sigma^2 \\Delta t}{(\\Delta x)^2} \\le 1 $$\n$$ \\Delta t \\le \\frac{1}{\\sigma^2} (\\Delta x)^2 $$\nThis is the Courant-Friedrichs-Lewy (CFL) stability restriction for the scheme. The problem asks for this restriction in the form $\\Delta t \\le C (\\Delta x)^2$. By comparing the two expressions, we identify the constant $C$.\n$$ C = \\frac{1}{\\sigma^2} $$", "answer": "$$\n\\boxed{\\frac{1}{\\sigma^2}}\n$$", "id": "3079816"}]}