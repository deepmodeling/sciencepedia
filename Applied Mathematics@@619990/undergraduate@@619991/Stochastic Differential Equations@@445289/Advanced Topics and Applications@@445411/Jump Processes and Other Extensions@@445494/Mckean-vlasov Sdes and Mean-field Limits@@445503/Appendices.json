{"hands_on_practices": [{"introduction": "To begin our practical exploration, we will tackle a foundational skill: deriving the dynamics of a system's statistical moments. This exercise [@problem_id:3065754] will guide you through calculating the evolution of the mean and variance for a canonical McKean-Vlasov model. By applying Itô's calculus, you will see how the complex, law-dependent stochastic differential equation (SDE) can be reduced to a more manageable system of ordinary differential equations (ODEs) for its key statistical properties.", "problem": "Consider a McKean–Vlasov stochastic differential equation (SDE), where the drift depends on the current law of the state. Let the drift be given by $b(x,\\mu)=-x+\\int y\\,\\mu(dy)$, and let the diffusion coefficient be a constant $\\sigma > 0$. Let $\\{W_t\\}_{t\\geq 0}$ be a standard Brownian motion, and let the initial condition $X_0$ have a law $\\mu_0$ with finite second moment, mean $m_0=\\int y\\,\\mu_0(dy)$, and variance $v_0=\\int (y-m_0)^2\\,\\mu_0(dy)$.\n\nStarting from the definition of a McKean–Vlasov SDE and the foundational properties of expectation, Brownian motion, and Itô calculus, do the following:\n- Write the resulting SDE explicitly in terms of $X_t$ and $\\mathbb{E}[X_t]$.\n- Derive the evolution equation for the mean $m_t=\\mathbb{E}[X_t]$.\n- Derive the evolution equation for the variance $v_t=\\mathrm{Var}(X_t)$ by considering the centered process and applying Itô’s formula to the squared centered process.\n\nUsing these derivations, determine the long-time limit $\\lim_{t\\to\\infty}\\mathrm{Var}(X_t)$ as a closed-form symbolic expression in terms of $\\sigma$ only. Express your final answer as a single analytic expression. No rounding is required.", "solution": "The problem describes a McKean-Vlasov stochastic differential equation (SDE), which is generically written as $dX_t = b(X_t, \\mu_t)dt + \\sigma(X_t, \\mu_t)dW_t$, where $\\mu_t$ is the probability distribution (law) of the state $X_t$ at time $t$.\n\nThe given drift coefficient is $b(x,\\mu)=-x+\\int y\\,\\mu(dy)$. For the process $X_t$ with law $\\mu_t$, the integral term $\\int y\\,\\mu_t(dy)$ is the definition of the expectation of $X_t$. Let us denote this time-dependent mean as $m_t = \\mathbb{E}[X_t]$.\nThe diffusion coefficient is given as a constant, $\\sigma > 0$.\n\nFirst, we write the SDE explicitly in terms of $X_t$ and its expectation $\\mathbb{E}[X_t]$. Substituting $m_t$ into the expression for the drift, we get:\n$b(X_t, \\mu_t) = -X_t + \\mathbb{E}[X_t] = -X_t + m_t$.\nThe resulting SDE is:\n$$dX_t = (-X_t + m_t) dt + \\sigma dW_t$$\n\nNext, we derive the evolution equation for the mean $m_t = \\mathbb{E}[X_t]$. We take the expectation of both sides of the SDE. Assuming we can interchange expectation and the differential operator (which is justified under standard assumptions for SDEs), we have $d\\mathbb{E}[X_t] = \\mathbb{E}[dX_t]$.\n$$dm_t = \\mathbb{E}[(-X_t + m_t) dt + \\sigma dW_t]$$\nBy the linearity of expectation:\n$$dm_t = \\mathbb{E}[-X_t + m_t] dt + \\mathbb{E}[\\sigma dW_t]$$\nFor a fixed time $t$, $m_t$ is a deterministic value. Thus, $\\mathbb{E}[-X_t + m_t] = -\\mathbb{E}[X_t] + \\mathbb{E}[m_t] = -m_t + m_t = 0$. The expectation of the stochastic differential $\\mathbb{E}[\\sigma dW_t]$ is also $0$.\nThis simplifies the equation for $m_t$ to:\n$$dm_t = 0 \\cdot dt + 0$$\n$$\\frac{dm_t}{dt} = 0$$\nThis is an ordinary differential equation whose solution is that $m_t$ is a constant. Therefore, $m_t = m_0$ for all $t \\ge 0$, where $m_0 = \\mathbb{E}[X_0]$ is the initial mean.\n\nNow, we derive the evolution equation for the variance $v_t = \\mathrm{Var}(X_t)$. The variance is defined as $v_t = \\mathbb{E}[(X_t - m_t)^2]$. Since we found that $m_t = m_0$ is constant, the variance is $v_t = \\mathbb{E}[(X_t - m_0)^2]$.\nLet us define a centered process $Y_t = X_t - m_0$. Since $m_0$ is a constant, the differential of $Y_t$ is $dY_t = dX_t - d(m_0) = dX_t$.\nThe SDE for $X_t$ can be written as $dX_t = (-X_t + m_0) dt + \\sigma dW_t$. We substitute $X_t = Y_t + m_0$ into this equation to find the SDE for $Y_t$:\n$$dY_t = (-(Y_t + m_0) + m_0) dt + \\sigma dW_t$$\n$$dY_t = -Y_t dt + \\sigma dW_t$$\nThe process $Y_t$ is a standard Ornstein-Uhlenbeck process. The variance of $X_t$ is $v_t = \\mathbb{E}[(X_t - m_0)^2] = \\mathbb{E}[Y_t^2]$.\nTo find the evolution of $v_t$, we apply Itô's formula to the function $f(y) = y^2$. The derivatives are $f'(y) = 2y$ and $f''(y) = 2$.\nItô's formula gives:\n$$d(Y_t^2) = f'(Y_t)dY_t + \\frac{1}{2}f''(Y_t)d\\langle Y, Y \\rangle_t$$\nThe quadratic variation of $Y_t$ is $d\\langle Y, Y \\rangle_t = (\\sigma)^2 dt = \\sigma^2 dt$. Substituting the terms:\n$$d(Y_t^2) = 2Y_t(-Y_t dt + \\sigma dW_t) + \\frac{1}{2}(2)(\\sigma^2 dt)$$\n$$d(Y_t^2) = (-2Y_t^2 + \\sigma^2)dt + 2\\sigma Y_t dW_t$$\nTo find the evolution equation for $v_t = \\mathbb{E}[Y_t^2]$, we take the expectation of this expression:\n$$d v_t = d\\mathbb{E}[Y_t^2] = \\mathbb{E}[d(Y_t^2)]$$\n$$d v_t = \\mathbb{E}[(-2Y_t^2 + \\sigma^2)dt + 2\\sigma Y_t dW_t]$$\n$$d v_t = (-2\\mathbb{E}[Y_t^2] + \\sigma^2)dt + \\mathbb{E}[2\\sigma Y_t dW_t]$$\nRecognizing that $\\mathbb{E}[Y_t^2] = v_t$ and that the expectation of the Itô integral term is zero ($\\mathbb{E}[\\int_0^t 2\\sigma Y_s dW_s] = 0$), we arrive at the ordinary differential equation for the variance:\n$$\\frac{dv_t}{dt} = -2v_t + \\sigma^2$$\n\nFinally, we determine the long-time limit of the variance, $\\lim_{t\\to\\infty} v_t$. This limit, if it exists, corresponds to a steady-state solution of the ODE, where the variance is constant, i.e., $\\frac{dv_t}{dt} = 0$. Let $v_\\infty = \\lim_{t\\to\\infty} v_t$. Setting the time derivative to zero in the evolution equation gives:\n$$0 = -2v_\\infty + \\sigma^2$$\nSolving for $v_\\infty$ yields:\n$$2v_\\infty = \\sigma^2$$\n$$v_\\infty = \\frac{\\sigma^2}{2}$$\nThis is the long-time limit of the variance, which depends only on the diffusion coefficient $\\sigma$. The solution to the ODE, $v_t = \\frac{\\sigma^2}{2} + (v_0 - \\frac{\\sigma^2}{2})\\exp(-2t)$, confirms that as $t \\to \\infty$, $v_t$ converges to this value irrespective of the initial variance $v_0$.", "answer": "$$\\boxed{\\frac{\\sigma^2}{2}}$$", "id": "3065754"}, {"introduction": "Moving beyond simple moments, this practice explores one of the most fascinating aspects of mean-field systems: the emergence of collective behavior and phase transitions. You will analyze the famous Kuramoto model for synchronization, a quintessential example of a McKean-Vlasov SDE on a circle [@problem_id:3065766]. The core task involves deriving a self-consistency equation for the system's order parameter, a powerful method for identifying equilibrium states and determining the critical conditions under which spontaneous order emerges from disorder.", "problem": "Consider a McKean–Vlasov stochastic differential equation (SDE) on the unit circle for identical particles with state $\\theta_t \\in [0,2\\pi)$:\n$$\n\\mathrm{d}\\theta_t \\;=\\; - K\\, r_t \\,\\sin\\!\\big(\\theta_t - \\psi_t\\big)\\,\\mathrm{d}t \\;+\\; \\sqrt{2D}\\,\\mathrm{d}W_t,\n$$\nwhere $K>0$ is a coupling strength, $D>0$ is a diffusion coefficient, $W_t$ is a standard Wiener process, and the mean-field order parameter is defined by\n$$\nr_t\\,e^{\\mathrm{i}\\psi_t} \\;=\\; \\mathbb{E}\\!\\left[e^{\\mathrm{i}\\theta_t}\\right],\\quad r_t \\in [0,1],\\;\\psi_t \\in [0,2\\pi).\n$$\nAssume time-independent equilibria with stationary density $f(\\theta)$ under the associated Fokker–Planck equation and the mean-field law. Starting from the definitions of the McKean–Vlasov SDE and the stationary Fokker–Planck balance for gradient drifts, derive the self-consistency condition for the equilibrium order parameter $r$ and analyze the fixed points and their stability in terms of the dimensionless parameter $\\alpha = K/D$. Based on that analysis, choose all correct statements below.\n\nA. There is a critical value $\\alpha_{\\mathrm{c}} = 2$ such that for $\\alpha < 2$ no nonzero fixed point exists, and for $\\alpha > 2$ a nonzero fixed point $r^\\star > 0$ appears.\n\nB. For $\\alpha < 2$, the fixed point $r=0$ is linearly stable, while for $\\alpha > 2$, the fixed point $r=0$ is linearly unstable under the mean-field dynamics.\n\nC. For $\\alpha > 2$, there exists a nonzero fixed point $r^\\star > 0$ which is linearly stable (up to the rotational symmetry in the phase $\\psi$).\n\nD. The phase transition at $\\alpha = 2$ is discontinuous (first-order): the order parameter $r$ exhibits a jump to a positive value at $\\alpha=2$.\n\nE. For $\\alpha > 2$, there are infinitely many distinct positive magnitudes $r^\\star$ solving the self-consistency equation.\n\nF. As $\\alpha \\downarrow 2^+$, the nonzero solution satisfies $r^\\star \\sim C\\,\\sqrt{\\alpha - 2}$ for some constant $C>0$, indicating a continuous (second-order) transition.", "solution": "The user wants me to analyze the equilibrium properties of a McKean-Vlasov SDE, known as the noisy Kuramoto model.\n\n### Step 1: Validation of the Problem Statement\nThe problem provides a McKean-Vlasov stochastic differential equation (SDE) for a system of interacting particles on a circle, defines the associated mean-field order parameter, and asks for the derivation of the self-consistency equation for the equilibrium order parameter and analysis of its solutions.\n\n**Extracted Givens:**\n- The SDE for a particle's angle $\\theta_t \\in [0, 2\\pi)$ is:\n$$\n\\mathrm{d}\\theta_t = - K\\, r_t \\,\\sin(\\theta_t - \\psi_t)\\,\\mathrm{d}t + \\sqrt{2D}\\,\\mathrm{d}W_t\n$$\n- $K > 0$ is the coupling strength.\n- $D > 0$ is the diffusion coefficient.\n- $W_t$ is a standard Wiener process.\n- The mean-field order parameter is defined by the complex number $r_t\\,e^{\\mathrm{i}\\psi_t} = \\mathbb{E}[e^{\\mathrm{i}\\theta_t}]$, where $r_t \\in [0,1]$ is the magnitude and $\\psi_t \\in [0,2\\pi)$ is the mean phase.\n- The analysis is to be performed for time-independent equilibria, characterized by a stationary density $f(\\theta)$.\n- The dimensionless parameter for analysis is $\\alpha = K/D$.\n\n**Validation:**\n1.  **Scientifically Grounded:** The presented model is a standard formulation of the Kuramoto model with intrinsic noise, a cornerstone in the study of synchronization phenomena in physics, biology, and engineering. The concepts of McKean-Vlasov SDEs, Fokker-Planck equations, and self-consistency analysis are fundamental and rigorously defined within statistical mechanics and probability theory. The problem is scientifically sound.\n2.  **Well-Posed & Objective:** The problem is mathematically well-defined, asking for a standard stability analysis of a well-known system. All terms are standard and unambiguous. The problem setup is self-contained and free of contradictions or subjective elements.\n3.  **No other flaws:** The problem is complete, conceptually sound, and directly pertinent to the specified topic.\n\n**Verdict:**\nThe problem statement is valid. I will proceed with the derivation and analysis.\n\n### Step 2: Derivation and Analysis\n\n**Derivation of the Stationary Distribution**\nThe given SDE is of the form $\\mathrm{d}\\theta_t = b(\\theta_t, \\mu_t)\\,\\mathrm{d}t + \\sigma\\,\\mathrm{d}W_t$, where $\\mu_t$ is the law of $\\theta_t$, the drift is $b(\\theta, \\mu_t) = -K r_t \\sin(\\theta - \\psi_t)$, and the noise strength is $\\sigma = \\sqrt{2D}$. The associated Fokker-Planck equation for the probability density $p(\\theta, t)$ is:\n$$\n\\frac{\\partial p}{\\partial t} = -\\frac{\\partial}{\\partial\\theta} \\Big( b(\\theta, \\mu_t) p \\Big) + \\frac{\\sigma^2}{2} \\frac{\\partial^2 p}{\\partial\\theta^2}\n$$\nSubstituting the expressions for $b$ and $\\sigma$, we get:\n$$\n\\frac{\\partial p}{\\partial t} = \\frac{\\partial}{\\partial\\theta} \\Big( K r_t \\sin(\\theta - \\psi_t) p \\Big) + D \\frac{\\partial^2 p}{\\partial\\theta^2}\n$$\nAt a stationary equilibrium, the density $p(\\theta, t)$ becomes time-independent, $p(\\theta, t) \\to f(\\theta)$, and the order parameter becomes constant, $(r_t, \\psi_t) \\to (r, \\psi)$. The Fokker-Planck equation simplifies to:\n$$\n0 = \\frac{\\mathrm{d}}{\\mathrm{d}\\theta} \\Big( K r \\sin(\\theta - \\psi) f(\\theta) \\Big) + D \\frac{\\mathrm{d}^2 f(\\theta)}{\\mathrm{d}\\theta^2}\n$$\nThis equation implies that the probability current $J(\\theta)$ is constant, where $J(\\theta) = - K r \\sin(\\theta - \\psi) f(\\theta) - D \\frac{\\mathrm{d}f(\\theta)}{\\mathrm{d}\\theta}$. For a stationary state on a periodic domain with a potential-based drift, the net current must be zero, so $J(\\theta)=0$.\n$$\nD \\frac{\\mathrm{d}f}{\\mathrm{d}\\theta} = - K r \\sin(\\theta - \\psi) f(\\theta)\n$$\nSeparating variables and integrating, using the parameter $\\alpha = K/D$:\n$$\n\\int \\frac{\\mathrm{d}f}{f} = -\\int \\frac{K}{D} r \\sin(\\theta - \\psi) \\mathrm{d}\\theta = -\\alpha r \\int \\sin(\\theta - \\psi) \\mathrm{d}\\theta\n$$\n$$\n\\ln f(\\theta) = \\alpha r \\cos(\\theta - \\psi) + \\text{const}\n$$\nThe stationary distribution is therefore $f(\\theta) = C_0 \\exp(\\alpha r \\cos(\\theta - \\psi))$. The normalization constant $C_0$ is determined by the condition $\\int_0^{2\\pi} f(\\theta) \\mathrm{d}\\theta = 1$. This integral is related to the modified Bessel function of the first kind of order zero, $I_0(x) = \\frac{1}{2\\pi} \\int_0^{2\\pi} e^{x \\cos\\phi} \\mathrm{d}\\phi$.\n$$\n\\int_0^{2\\pi} C_0 e^{\\alpha r \\cos(\\theta-\\psi)} \\mathrm{d}\\theta = C_0 \\cdot 2\\pi I_0(\\alpha r) = 1 \\implies C_0 = \\frac{1}{2\\pi I_0(\\alpha r)}\n$$\nSo, the stationary distribution is a von Mises distribution:\n$$\nf(\\theta) = \\frac{\\exp(\\alpha r \\cos(\\theta - \\psi))}{2\\pi I_0(\\alpha r)}\n$$\n\n**Derivation of the Self-Consistency Equation**\nThe order parameter $r$ must satisfy its own definition, calculated with respect to the stationary distribution $f(\\theta)$:\n$$\nr e^{\\mathrm{i}\\psi} = \\mathbb{E}[e^{\\mathrm{i}\\theta}] = \\int_0^{2\\pi} e^{\\mathrm{i}\\theta} f(\\theta) \\mathrm{d}\\theta\n$$\n$$\nr e^{\\mathrm{i}\\psi} = \\int_0^{2\\pi} e^{\\mathrm{i}\\theta} \\frac{\\exp(\\alpha r \\cos(\\theta - \\psi))}{2\\pi I_0(\\alpha r)} \\mathrm{d}\\theta\n$$\nDue to rotational symmetry, we can set $\\psi = 0$ without loss of generality.\n$$\nr = \\int_0^{2\\pi} e^{\\mathrm{i}\\theta} \\frac{\\exp(\\alpha r \\cos\\theta)}{2\\pi I_0(\\alpha r)} \\mathrm{d}\\theta = \\frac{1}{2\\pi I_0(\\alpha r)} \\int_0^{2\\pi} (\\cos\\theta + i\\sin\\theta) \\exp(\\alpha r \\cos\\theta) \\mathrm{d}\\theta\n$$\nThe imaginary part of the integral, $\\int_0^{2\\pi} \\sin\\theta \\exp(\\alpha r \\cos\\theta) \\mathrm{d}\\theta$, is zero due to the odd symmetry of the integrand over a symmetric interval like $[-\\pi, \\pi]$.\nThe real part gives:\n$$\nr = \\frac{1}{2\\pi I_0(\\alpha r)} \\int_0^{2\\pi} \\cos\\theta \\exp(\\alpha r \\cos\\theta) \\mathrm{d}\\theta\n$$\nThis integral is, by definition, $2\\pi I_1(\\alpha r)$, where $I_1(x)$ is the modified Bessel function of the first kind of order one. This yields the self-consistency equation for the equilibrium order parameter magnitude $r$:\n$$\nr = \\frac{I_1(\\alpha r)}{I_0(\\alpha r)}\n$$\n\n**Analysis of Fixed Points and Stability**\nWe analyze the solutions to the equation $r = F(r)$, where $F(r) = \\frac{I_1(\\alpha r)}{I_0(\\alpha r)}$.\n\n1.  **Trivial Solution:** $r=0$ is always a solution, as $F(0) = \\frac{I_1(0)}{I_0(0)} = \\frac{0}{1} = 0$. This corresponds to the incoherent state.\n\n2.  **Non-trivial Solutions:** To find other solutions, we analyze the behavior of $F(r)$ near $r=0$. Using the series expansions for small $x$: $I_0(x) \\approx 1 + \\frac{x^2}{4}$ and $I_1(x) \\approx \\frac{x}{2} + \\frac{x^3}{16}$. Let $x=\\alpha r$.\n    $$\n    F(r) \\approx \\frac{\\frac{\\alpha r}{2} + \\frac{(\\alpha r)^3}{16}}{1 + \\frac{(\\alpha r)^2}{4}} \\approx \\left(\\frac{\\alpha r}{2} + \\frac{\\alpha^3 r^3}{16}\\right)\\left(1 - \\frac{\\alpha^2 r^2}{4}\\right) \\approx \\frac{\\alpha r}{2} - \\frac{\\alpha^3 r^3}{16}\n    $$\n    The fixed point equation $r=F(r)$ becomes $r \\approx \\frac{\\alpha r}{2} - \\frac{\\alpha^3 r^3}{16}$. For $r > 0$, we can divide by $r$:\n    $$\n    1 \\approx \\frac{\\alpha}{2} - \\frac{\\alpha^3 r^2}{16} \\implies r^2 \\approx \\frac{16}{\\alpha^3}\\left(\\frac{\\alpha}{2} - 1\\right) = \\frac{8(\\alpha - 2)}{\\alpha^3}\n    $$\n    A real, non-zero solution for $r$ exists only if $\\alpha-2 > 0$, i.e., $\\alpha > 2$. This indicates a bifurcation occurs at a critical value $\\alpha_{\\mathrm{c}} = 2$.\n\n3.  **Stability of Fixed Points:**\n    The stability of a fixed point $r^*$ is determined by the derivative $F'(r^*)$. The fixed point is linearly stable if $|F'(r^*)|<1$ and unstable if $|F'(r^*)|>1$.\n    *   **Stability of $r=0$:** The slope at the origin is $F'(0)$. From the expansion $F(r) \\approx \\frac{\\alpha r}{2}$, we find $F'(0) = \\frac{\\alpha}{2}$.\n        -   If $\\alpha < 2$, then $F'(0) < 1$, so the fixed point $r=0$ is stable.\n        -   If $\\alpha > 2$, then $F'(0) > 1$, so the fixed point $r=0$ is unstable.\n    *   **Stability of $r^\\star > 0$ (for $\\alpha > 2$):** The function $F(r)$ is monotonically increasing, concave for $r>0$, starts at $F(0)=0$, and approaches $\\lim_{r\\to\\infty} F(r) = 1$. For $\\alpha > 2$, the curve $y=F(r)$ starts with a slope greater than $1$ and must cross the line $y=r$ from above to reach its asymptote. At the unique intersection point $r^\\star > 0$, the slope must be less than $1$, i.e., $0 \\le F'(r^\\star) < 1$. Thus, the non-zero fixed point $r^\\star$ is stable.\n\n### Step 3: Evaluation of Options\n\n**A. There is a critical value $\\alpha_{\\mathrm{c}} = 2$ such that for $\\alpha < 2$ no nonzero fixed point exists, and for $\\alpha > 2$ a nonzero fixed point $r^\\star > 0$ appears.**\nOur analysis revealed that a non-trivial solution $r > 0$ emerges precisely when $\\alpha > 2$. The critical value is $\\alpha_{\\mathrm{c}} = 2$. This statement is **Correct**.\n\n**B. For $\\alpha < 2$, the fixed point $r=0$ is linearly stable, while for $\\alpha > 2$, the fixed point $r=0$ is linearly unstable under the mean-field dynamics.**\nOur stability analysis of the $r=0$ solution showed it is stable for $F'(0) = \\alpha/2 < 1$ (i.e., $\\alpha < 2$) and unstable for $F'(0) = \\alpha/2 > 1$ (i.e., $\\alpha > 2$). This statement is **Correct**.\n\n**C. For $\\alpha > 2$, there exists a nonzero fixed point $r^\\star > 0$ which is linearly stable (up to the rotational symmetry in the phase $\\psi$).**\nAs shown, for $\\alpha > 2$, a unique non-zero solution $r^\\star$ exists and is stable because $F'(r^\\star)<1$. The parenthetical note correctly addresses the neutral stability of the phase $\\psi$ due to the system's rotational symmetry. This statement is **Correct**.\n\n**D. The phase transition at $\\alpha = 2$ is discontinuous (first-order): the order parameter $r$ exhibits a jump to a positive value at $\\alpha=2$.**\nOur analysis showed that for $\\alpha$ just above $2$, $r^\\star$ grows continuously from $0$ (scaling as $\\sqrt{\\alpha-2}$). It does not jump. Therefore, the transition is continuous (second-order). This statement is **Incorrect**.\n\n**E. For $\\alpha > 2$, there are infinitely many distinct positive magnitudes $r^\\star$ solving the self-consistency equation.**\nThe function $F(r)$ is strictly concave for $r>0$. A concave function can intersect a straight line ($y=r$) at most twice. Since one intersection is at $r=0$, there can be at most one other intersection for $r>0$. Our analysis showed that for $\\alpha>2$, there is exactly one positive solution. This statement is **Incorrect**.\n\n**F. As $\\alpha \\downarrow 2^+$, the nonzero solution satisfies $r^\\star \\sim C\\,\\sqrt{\\alpha - 2}$ for some constant $C>0$, indicating a continuous (second-order) transition.**\nOur expansion gave $r^2 \\approx \\frac{8(\\alpha-2)}{\\alpha^3}$. As $\\alpha \\to 2^+$, we have $\\alpha^3 \\to 8$, so $r^2 \\approx \\alpha-2$. This means $r \\approx \\sqrt{\\alpha-2}$. This matches the form $r \\sim C\\sqrt{\\alpha-2}$ with $C=1$. This square-root scaling is the hallmark of a continuous, second-order phase transition. This statement is **Correct**.", "answer": "$$\\boxed{ABCF}$$", "id": "3065766"}, {"introduction": "While analytical derivations provide deep insight, many real-world problems require numerical simulation. This final practice bridges the gap between theory and computation by tasking you with implementing the Euler–Maruyama scheme for the interacting particle system that approximates a McKean-Vlasov SDE [@problem_id:3065755]. By simulating various models and comparing your numerical results against their known analytical solutions, you will gain tangible intuition for the concept of 'propagation of chaos' and validate both the theory and your implementation.", "problem": "Consider a one-dimensional McKean–Vlasov stochastic differential equation (SDE) for a process $X_t$ driven by a standard Brownian motion $W_t$,\n$$\ndX_t = b\\big(X_t,\\mu_t\\big)\\,dt + \\sigma\\big(X_t,\\mu_t\\big)\\,dW_t,\n$$\nwhere $\\mu_t$ denotes the law of $X_t$, and $b$ and $\\sigma$ are measurable functions. The mean-field particle approximation with $N$ particles replaces $\\mu_t$ by the empirical measure $\\mu_t^N = \\frac{1}{N}\\sum_{i=1}^N \\delta_{X_t^{i,N}}$ and evolves the particle system $\\{X_t^{i,N}\\}_{i=1}^N$ according to\n$$\ndX_t^{i,N} = b\\big(X_t^{i,N},\\mu_t^N\\big)\\,dt + \\sigma\\big(X_t^{i,N},\\mu_t^N\\big)\\,dW_t^i,\n$$\nwhere $\\{W_t^i\\}_{i=1}^N$ are independent standard Brownian motions. Using the Euler–Maruyama scheme, the discrete-time approximation $\\{X_k^{i,N}\\}_{k=0}^{K}$ on a uniform grid with time step $\\Delta t$ and $K = \\lfloor T/\\Delta t \\rfloor$ is defined by independent normal increments $\\Delta W_k^i \\sim \\mathcal{N}(0,\\Delta t)$ and the update\n$$\nX_{k+1}^{i,N} = X_k^{i,N} + b\\big(X_k^{i,N},\\mu_k^N\\big)\\,\\Delta t + \\sigma\\big(X_k^{i,N},\\mu_k^N\\big)\\,\\Delta W_k^i,\n$$\nwhere $\\mu_k^N = \\frac{1}{N}\\sum_{j=1}^N \\delta_{X_k^{j,N}}$.\n\nYour task is to implement this Euler–Maruyama scheme for the following three model classes, each specified by functions $b$ and $\\sigma$, and to compare empirical mean and variance at time $T$ with analytically derived predictions:\n\n1. Centered Ornstein–Uhlenbeck mean-field model:\n   - Drift: $b(x,\\mu) = -\\alpha\\,(x - m)$ with $m = \\int y\\,\\mu(dy)$.\n   - Diffusion: $\\sigma(x,\\mu) = \\beta$, a constant.\n   - Analytic predictions: For $m_0 = \\mathbb{E}[X_0]$ and $s_0^2 = \\mathrm{Var}(X_0)$, the mean remains $m_T = m_0$. Defining $Y_t = X_t - m_t$, $Y_t$ satisfies an Ornstein–Uhlenbeck dynamics, yielding\n     $$\n     \\mathrm{Var}(X_T) =\n     \\begin{cases}\n     s_0^2\\,e^{-2\\alpha T} + \\dfrac{\\beta^2}{2\\alpha}\\big(1 - e^{-2\\alpha T}\\big), & \\alpha > 0,\\\\\n     s_0^2 + \\beta^2 T, & \\alpha = 0.\n     \\end{cases}\n     $$\n\n2. Deterministic consensus (no diffusion):\n   - Drift: $b(x,\\mu) = -\\alpha\\,(x - m)$ with $m = \\int y\\,\\mu(dy)$.\n   - Diffusion: $\\sigma(x,\\mu) = 0$.\n   - Analytic predictions: $m_T = m_0$ and $\\mathrm{Var}(X_T) = s_0^2\\,e^{-2\\alpha T}$.\n\n3. Affine mean-driven model:\n   - Drift: $b(x,\\mu) = -\\alpha\\,x + \\gamma\\,m$ with $m = \\int y\\,\\mu(dy)$.\n   - Diffusion: $\\sigma(x,\\mu) = \\beta$, a constant.\n   - Analytic predictions: The mean solves $dm_t = (\\gamma - \\alpha)\\,m_t\\,dt$, so $m_T = m_0\\,e^{(\\gamma - \\alpha)T}$. For $Y_t = X_t - m_t$, one has $dY_t = -\\alpha\\,Y_t\\,dt + \\beta\\,dW_t$, hence\n     $$\n     \\mathrm{Var}(X_T) =\n     \\begin{cases}\n     s_0^2\\,e^{-2\\alpha T} + \\dfrac{\\beta^2}{2\\alpha}\\big(1 - e^{-2\\alpha T}\\big), & \\alpha > 0,\\\\\n     s_0^2 + \\beta^2 T, & \\alpha = 0.\n     \\end{cases}\n     $$\n\nUse the following test suite. In all tests, initialize $X_0^{i,N}$ independently from a normal distribution $\\mathcal{N}(m_0,s_0^2)$ and use independent normal increments $\\Delta W_k^i \\sim \\mathcal{N}(0,\\Delta t)$. The integer $K$ must be $K = \\lfloor T/\\Delta t \\rfloor$, and the simulation should proceed for $K$ steps, so the simulated final time is $K\\,\\Delta t$.\n\n- Test case A (centered Ornstein–Uhlenbeck, happy path):\n  - $N=2000$, $T=1.0$, $\\Delta t=0.001$, $\\alpha=3.0$, $\\beta=0.8$, $m_0=1.25$, $s_0=2.0$, random seed $12345$.\n\n- Test case B (deterministic consensus, boundary with zero diffusion):\n  - $N=2000$, $T=0.8$, $\\Delta t=0.001$, $\\alpha=2.0$, $\\beta=0.0$, $m_0=-0.5$, $s_0=1.0$, random seed $34567$.\n\n- Test case C (affine mean-driven, nontrivial mean growth/decay):\n  - $N=2000$, $T=1.2$, $\\Delta t=0.001$, $\\alpha=1.0$, $\\beta=0.7$, $\\gamma=0.4$, $m_0=0.75$, $s_0=0.5$, random seed $98765$.\n\n- Test case D (centered Ornstein–Uhlenbeck, boundary with $\\alpha=0$):\n  - $N=2000$, $T=0.7$, $\\Delta t=0.001$, $\\alpha=0.0$, $\\beta=0.65$, $m_0=0.0$, $s_0=0.9$, random seed $24680$.\n\nImplement the Euler–Maruyama particle simulation for each test case, compute the empirical mean $\\widehat{m}_T^N$ and empirical variance $\\widehat{v}_T^N$ at the final time $K\\,\\Delta t$, and compare them with the analytic predictions described above by reporting absolute errors:\n$$\n\\varepsilon_{\\mathrm{mean}} = \\big|\\widehat{m}_T^N - m_T\\big|,\\qquad\n\\varepsilon_{\\mathrm{var}} = \\big|\\widehat{v}_T^N - \\mathrm{Var}(X_T)\\big|.\n$$\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order\n$$\n\\big[\\varepsilon_{\\mathrm{mean}}^{\\mathrm{A}},\\,\\varepsilon_{\\mathrm{var}}^{\\mathrm{A}},\\,\\varepsilon_{\\mathrm{mean}}^{\\mathrm{B}},\\,\\varepsilon_{\\mathrm{var}}^{\\mathrm{B}},\\,\\varepsilon_{\\mathrm{mean}}^{\\mathrm{C}},\\,\\varepsilon_{\\mathrm{var}}^{\\mathrm{C}},\\,\\varepsilon_{\\mathrm{mean}}^{\\mathrm{D}},\\,\\varepsilon_{\\mathrm{var}}^{\\mathrm{D}}\\big],\n$$\nwith each entry printed as a floating-point number. No physical units are involved in this problem. The program must be complete and runnable without any external input and must use the specified random seeds for reproducibility.", "solution": "The problem is subjected to validation against the established criteria.\n\n### Step 1: Extract Givens\n- **McKean-Vlasov SDE:** $dX_t = b(X_t,\\mu_t)\\,dt + \\sigma(X_t,\\mu_t)\\,dW_t$, where $\\mu_t$ is the law of $X_t$.\n- **N-particle approximation:** $dX_t^{i,N} = b(X_t^{i,N},\\mu_t^N)\\,dt + \\sigma(X_t^{i,N},\\mu_t^N)\\,dW_t^i$, with $\\mu_t^N = \\frac{1}{N}\\sum_{i=1}^N \\delta_{X_t^{i,N}}$ and independent $W_t^i$.\n- **Euler-Maruyama scheme:** $X_{k+1}^{i,N} = X_k^{i,N} + b(X_k^{i,N},\\mu_k^N)\\,\\Delta t + \\sigma(X_k^{i,N},\\mu_k^N)\\,\\Delta W_k^i$, with $\\mu_k^N = \\frac{1}{N}\\sum_{j=1}^N \\delta_{X_k^{j,N}}$, $\\Delta W_k^i \\sim \\mathcal{N}(0,\\Delta t)$, and $K = \\lfloor T/\\Delta t \\rfloor$.\n- **Initial condition:** $X_0^{i,N} \\sim \\mathcal{N}(m_0,s_0^2)$, independently.\n- **Model 1: Centered Ornstein–Uhlenbeck:**\n  - $b(x,\\mu) = -\\alpha(x - m)$, $m = \\int y\\,\\mu(dy)$.\n  - $\\sigma(x,\\mu) = \\beta$.\n  - Analytics: $m_T = m_0$. $\\mathrm{Var}(X_T) = s_0^2\\,e^{-2\\alpha T} + \\frac{\\beta^2}{2\\alpha}(1 - e^{-2\\alpha T})$ for $\\alpha > 0$; $\\mathrm{Var}(X_T) = s_0^2 + \\beta^2 T$ for $\\alpha = 0$.\n- **Model 2: Deterministic consensus:**\n  - $b(x,\\mu) = -\\alpha(x - m)$.\n  - $\\sigma(x,\\mu) = 0$.\n  - Analytics: $m_T = m_0$, $\\mathrm{Var}(X_T) = s_0^2\\,e^{-2\\alpha T}$.\n- **Model 3: Affine mean-driven:**\n  - $b(x,\\mu) = -\\alpha\\,x + \\gamma\\,m$.\n  - $\\sigma(x,\\mu) = \\beta$.\n  - Analytics: $m_T = m_0\\,e^{(\\gamma - \\alpha)T}$. $\\mathrm{Var}(X_T)$ same as Model 1.\n- **Test Cases:**\n  - A: $N=2000$, $T=1.0$, $\\Delta t=0.001$, $\\alpha=3.0$, $\\beta=0.8$, $m_0=1.25$, $s_0=2.0$, seed $12345$.\n  - B: $N=2000$, $T=0.8$, $\\Delta t=0.001$, $\\alpha=2.0$, $\\beta=0.0$, $m_0=-0.5$, $s_0=1.0$, seed $34567$.\n  - C: $N=2000$, $T=1.2$, $\\Delta t=0.001$, $\\alpha=1.0$, $\\beta=0.7$, $\\gamma=0.4$, $m_0=0.75$, $s_0=0.5$, seed $98765$.\n  - D: $N=2000$, $T=0.7$, $\\Delta t=0.001$, $\\alpha=0.0$, $\\beta=0.65$, $m_0=0.0$, $s_0=0.9$, seed $24680$.\n- **Task:** Compute errors $\\varepsilon_{\\mathrm{mean}} = |\\widehat{m}_T^N - m_T|$ and $\\varepsilon_{\\mathrm{var}} = |\\widehat{v}_T^N - \\mathrm{Var}(X_T)|$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is well-defined and scientifically sound.\n1.  **Scientific and Factual Soundness**: The problem is based on the standard theory of McKean-Vlasov SDEs and their numerical approximation via interacting particle systems, a core topic in stochastic analysis and computational mathematics. The models presented (Ornstein-Uhlenbeck, consensus, affine) are canonical examples. The provided analytical formulas for the mean and variance of the limiting process are correct and can be derived using standard techniques for linear SDEs.\n2.  **Completeness and Consistency**: All necessary parameters ($N, T, \\Delta t, \\alpha, \\beta, \\gamma$), initial conditions ($m_0, s_0$), model specifications, and random seeds are provided for each test case. The instructions are unambiguous. The simulation time $K \\Delta t$ is well-defined since $T/\\Delta t$ is an integer in all cases.\n3.  **Well-Posedness**: The coefficients of the SDEs are globally Lipschitz (in both state and measure), ensuring the existence and uniqueness of strong solutions. The numerical task is clearly specified and repeatable, leading to a single, verifiable set of results.\n\n### Step 3: Verdict and Action\nThe problem is valid. A reasoned solution will be provided.\n\n### Solution\nThe problem requires the implementation of an Euler-Maruyama simulation for an $N$-particle system governed by a mean-field interaction, with the goal of approximating a one-dimensional McKean-Vlasov SDE. For each test case, the empirical mean and variance of the particles at the final time are compared to the analytically derived mean and variance of the limiting SDE.\n\n**Methodology**\n\nThe core of the solution is the numerical integration of the $N$-particle system:\n$$\ndX_t^{i,N} = b\\big(X_t^{i,N},\\mu_t^N\\big)\\,dt + \\sigma\\big(X_t^{i,N},\\mu_t^N\\big)\\,dW_t^i, \\quad i=1,\\dots,N\n$$\nThe procedure for each test case is as follows:\n\n1.  **Initialization**: A system of $N$ particles is initialized at time $t=0$. The initial positions $\\{X_0^{i,N}\\}_{i=1}^N$ are drawn as independent and identically distributed random variables from a normal distribution $\\mathcal{N}(m_0, s_0^2)$. This is achieved by sampling from a normal distribution with mean $m_0$ and standard deviation $s_0$. The specified random seed is used to ensure reproducibility.\n\n2.  **Time Discretization**: The time interval $[0, T]$ is discretized into $K = \\lfloor T/\\Delta t \\rfloor$ steps of size $\\Delta t$. For all test cases provided, $T/\\Delta t$ is an integer, so $K = T/\\Delta t$. The simulation proceeds for $K$ steps, reaching a final time of $T_{final} = K \\Delta t = T$.\n\n3.  **Euler-Maruyama Iteration**: The particle positions are evolved iteratively from time step $k$ to $k+1$. For each particle $i \\in \\{1, \\dots, N\\}$, the update is:\n    $$\n    X_{k+1}^{i,N} = X_k^{i,N} + b\\big(X_k^{i,N},\\mu_k^N\\big)\\,\\Delta t + \\sigma\\big(X_k^{i,N},\\mu_k^N\\big)\\,\\Delta W_k^i\n    $$\n    - The dependence on the law $\\mu_k^N$ is handled by replacing integrals with respect to the empirical measure $\\mu_k^N = \\frac{1}{N}\\sum_{j=1}^N \\delta_{X_k^{j,N}}$ with sample averages. Specifically, the mean $m = \\int y\\,\\mu_k^N(dy)$ is computed as the empirical mean of the particles at step $k$: $m_k^N = \\frac{1}{N}\\sum_{j=1}^N X_k^{j,N}$.\n    - The terms $\\Delta W_k^i$ represent the increments of independent Wiener processes. They are generated as independent random variables from a normal distribution $\\mathcal{N}(0, \\Delta t)$, equivalent to $\\sqrt{\\Delta t} \\cdot Z_k^i$ where $Z_k^i \\sim \\mathcal{N}(0, 1)$.\n\n4.  **Model-Specific Dynamics**: The drift $b$ and diffusion $\\sigma$ functions are implemented for each model:\n    - **Centered OU / Consensus**: $b(x, \\mu_k^N) = -\\alpha(x - m_k^N)$ and $\\sigma(x, \\mu_k^N) = \\beta$. The consensus model is a special case with $\\beta=0$.\n    - **Affine mean-driven**: $b(x, \\mu_k^N) = -\\alpha x + \\gamma m_k^N$ and $\\sigma(x, \\mu_k^N) = \\beta$.\n\n5.  **Final Statistics and Error Calculation**: After $K$ iterations, the simulation ends. The final particle positions are $\\{X_K^{i,N}\\}_{i=1}^N$.\n    - The **empirical mean** is calculated as $\\widehat{m}_T^N = \\frac{1}{N} \\sum_{i=1}^N X_K^{i,N}$.\n    - The **empirical variance** is calculated as $\\widehat{v}_T^N = \\frac{1}{N} \\sum_{i=1}^N (X_K^{i,N} - \\widehat{m}_T^N)^2$.\n    - The **analytical mean** $m_T$ and **analytical variance** $\\mathrm{Var}(X_T)$ are computed using the exact formulas provided in the problem description, taking care to distinguish between the cases $\\alpha > 0$ and $\\alpha=0$.\n    - Finally, the absolute errors are computed:\n      $$\n      \\varepsilon_{\\mathrm{mean}} = \\big|\\widehat{m}_T^N - m_T\\big|\n      $$\n      $$\n      \\varepsilon_{\\mathrm{var}} = \\big|\\widehat{v}_T^N - \\mathrm{Var}(X_T)\\big|\n      $$\n\nThis procedure is applied to each of the four test cases, and the eight resulting error values are collected and formatted as specified. The implementation is done in Python using the `numpy` library for efficient vectorized operations.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef calculate_analytic_solution(model_type, T, params, m0, s0):\n    \"\"\"\n    Calculates the analytical mean and variance at time T.\n    \"\"\"\n    alpha = params.get('alpha', 0.0)\n    beta = params.get('beta', 0.0)\n    s0_sq = s0**2\n\n    if model_type == 'OU':\n        # This covers Centered-OU and Deterministic Consensus (beta=0)\n        m_T = m0\n        if alpha == 0.0:\n            var_T = s0_sq + beta**2 * T\n        else: # alpha > 0\n            exp_term = np.exp(-2 * alpha * T)\n            var_T = s0_sq * exp_term + (beta**2 / (2 * alpha)) * (1 - exp_term)\n            \n    elif model_type == 'Affine':\n        gamma = params['gamma']\n        m_T = m0 * np.exp((gamma - alpha) * T)\n        if alpha == 0.0:\n            var_T = s0_sq + beta**2 * T\n        else: # alpha > 0\n            exp_term = np.exp(-2 * alpha * T)\n            var_T = s0_sq * exp_term + (beta**2 / (2 * alpha)) * (1 - exp_term)\n    else:\n        raise ValueError(f\"Unknown model type: {model_type}\")\n    \n    return m_T, var_T\n\n\ndef run_simulation_case(model_type, N, T, dt, params, m0, s0, seed):\n    \"\"\"\n    Runs the Euler-Maruyama simulation for a single test case.\n    \"\"\"\n    # 1. Initialization\n    rng = np.random.default_rng(seed)\n    # Initial particle positions from N(m0, s0^2)\n    X = rng.normal(loc=m0, scale=s0, size=N)\n\n    # 2. Time Discretization\n    K = int(T / dt)\n    sqrt_dt = np.sqrt(dt)\n\n    # 3. Euler-Maruyama Iteration\n    for _ in range(K):\n        # Compute empirical mean for interaction term\n        m_k_N = np.mean(X)\n        \n        # Generate Wiener increments\n        dW = rng.normal(loc=0.0, scale=sqrt_dt, size=N)\n        \n        # 4. Model-Specific Dynamics\n        if model_type == 'OU':\n            alpha = params['alpha']\n            beta = params['beta']\n            drift = -alpha * (X - m_k_N)\n            diffusion = beta\n            \n        elif model_type == 'Affine':\n            alpha = params['alpha']\n            beta = params['beta']\n            gamma = params['gamma']\n            drift = -alpha * X + gamma * m_k_N\n            diffusion = beta\n        else:\n             raise ValueError(f\"Unknown model type: {model_type}\")\n\n        # Update particle positions\n        X = X + drift * dt + diffusion * dW\n\n    # 5. Final Statistics and Error Calculation\n    # Empirical stats at final time T = K * dt\n    m_hat_T = np.mean(X)\n    v_hat_T = np.var(X) # ddof=0 is default, corresponding to 1/N\n\n    # Analytical stats\n    T_final = K * dt\n    m_T, var_T = calculate_analytic_solution(model_type, T_final, params, m0, s0)\n    \n    # Absolute errors\n    err_mean = np.abs(m_hat_T - m_T)\n    err_var = np.abs(v_hat_T - var_T)\n\n    return err_mean, err_var\n\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Test case A (centered Ornstein–Uhlenbeck)\n        { 'model_type': 'OU', 'N': 2000, 'T': 1.0, 'dt': 0.001,\n          'params': {'alpha': 3.0, 'beta': 0.8}, 'm0': 1.25, 's0': 2.0, 'seed': 12345 },\n        \n        # Test case B (deterministic consensus, handled as OU with beta=0)\n        { 'model_type': 'OU', 'N': 2000, 'T': 0.8, 'dt': 0.001,\n          'params': {'alpha': 2.0, 'beta': 0.0}, 'm0': -0.5, 's0': 1.0, 'seed': 34567 },\n        \n        # Test case C (affine mean-driven)\n        { 'model_type': 'Affine', 'N': 2000, 'T': 1.2, 'dt': 0.001,\n          'params': {'alpha': 1.0, 'beta': 0.7, 'gamma': 0.4}, 'm0': 0.75, 's0': 0.5, 'seed': 98765 },\n\n        # Test case D (centered Ornstein–Uhlenbeck, alpha=0)\n        { 'model_type': 'OU', 'N': 2000, 'T': 0.7, 'dt': 0.001,\n          'params': {'alpha': 0.0, 'beta': 0.65}, 'm0': 0.0, 's0': 0.9, 'seed': 24680 }\n    ]\n\n    results = []\n    for case in test_cases:\n        err_mean, err_var = run_simulation_case(**case)\n        results.extend([err_mean, err_var])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.10f}' for r in results)}]\")\n\nsolve()\n```", "id": "3065755"}]}