{"hands_on_practices": [{"introduction": "A cornerstone application of the Feynman-Kac formula is in financial mathematics for valuing assets that generate random cash flows. This exercise provides a fundamental case study: calculating the present value of a continuous stream of payments where the payment rate depends on the price of an asset modeled by Brownian motion [@problem_id:1337995]. By working through this problem, you will see how to translate an expected discounted functional of a stochastic process into a solvable ordinary differential equation, a central technique in quantitative finance.", "problem": "An asset's price, denoted by $X_s$ at time $s$, is modeled as a standard one-dimensional Brownian motion. Its evolution is described by the stochastic differential equation $dX_s = dW_s$, where $W_s$ is a standard Wiener process. The asset starts at an initial price $X_0 = x$.\n\nThis asset generates a continuous stream of payments. At any time $s \\ge 0$, the instantaneous rate of payment is given by the square of the asset's price, i.e., the payment rate is $f(X_s) = X_s^2$.\n\nAn investor wishes to calculate the total present value of all future payments from this asset over an infinite time horizon. The future payments are discounted continuously at a constant risk-free interest rate $r > 0$.\n\nDetermine the expected total discounted value of this infinite stream of payments as a function of the initial price $x$ and the discount rate $r$.", "solution": "Let $X_s$ be a standard Brownian motion starting from $X_0=x$, so $dX_s=dW_s$ and $X_s=x+W_s$. The total discounted value of the running payoff $f(X_s)=X_s^2$ is\n$$\nV(x)=\\mathbb{E}_{x}\\left[\\int_{0}^{\\infty} e^{-r s}\\,X_{s}^{2}\\,ds\\right], \\quad r>0.\n$$\nSince $X_s^2\\ge 0$, Tonelli’s theorem justifies interchanging expectation and integration:\n$$\nV(x)=\\int_{0}^{\\infty} e^{-r s}\\,\\mathbb{E}_{x}[X_{s}^{2}]\\,ds.\n$$\nBecause $X_s=x+W_s$ with $\\mathbb{E}[W_s]=0$ and $\\mathrm{Var}(W_s)=s$, we have\n$$\n\\mathbb{E}_{x}[X_{s}^{2}]=\\mathrm{Var}(X_{s})+\\left(\\mathbb{E}_{x}[X_{s}]\\right)^{2}=s+x^{2}.\n$$\nHence\n$$\nV(x)=\\int_{0}^{\\infty} e^{-r s}\\,(x^{2}+s)\\,ds\n= x^{2}\\int_{0}^{\\infty} e^{-r s}\\,ds + \\int_{0}^{\\infty} s\\,e^{-r s}\\,ds.\n$$\nFor $r>0$,\n$$\n\\int_{0}^{\\infty} e^{-r s}\\,ds=\\frac{1}{r}.\n$$\nFor the second integral, integrate by parts with $u=s$ and $dv=e^{-r s}\\,ds$, so $du=ds$ and $v=-(1/r)e^{-r s}$:\n$$\n\\int_{0}^{\\infty} s\\,e^{-r s}\\,ds=\\left.-\\frac{s}{r}e^{-r s}\\right|_{0}^{\\infty}+\\frac{1}{r}\\int_{0}^{\\infty}e^{-r s}\\,ds\n=0+\\frac{1}{r}\\cdot\\frac{1}{r}=\\frac{1}{r^{2}}.\n$$\nTherefore,\n$$\nV(x)=\\frac{x^{2}}{r}+\\frac{1}{r^{2}}.\n$$\nAs a consistency check via the Feynman–Kac formula, $v(x)=V(x)$ solves the ODE $(r-\\mathcal{L})v=x^{2}$ with generator $\\mathcal{L}=\\frac{1}{2}\\frac{d^{2}}{dx^{2}}$, that is,\n$$\nr v(x)-\\frac{1}{2}v''(x)=x^{2}.\n$$\nA particular solution $v_p(x)=a x^{2}+b$ yields $v_p''(x)=2a$ and\n$$\nr(ax^2+b)-\\frac{1}{2}(2a)=x^{2},\n$$\ngiving $a=1/r$ and $b=1/r^2$. The homogeneous solutions $\\exp(\\pm\\sqrt{2r}\\,x)$ are excluded by the requirement of at most polynomial growth, confirming $v(x)=\\frac{x^{2}}{r}+\\frac{1}{r^{2}}$.", "answer": "$$\\boxed{\\frac{x^{2}}{r}+\\frac{1}{r^{2}}}$$", "id": "1337995"}, {"introduction": "While many models operate over an infinite time horizon, practical applications often involve processes that terminate upon hitting a certain boundary. This problem introduces the concept of a stopping time, specifically the first exit time of a Brownian motion from a given interval [@problem_id:3080617]. You will derive the governing partial differential equation and its boundary conditions to find the expected total amount accumulated before the process stops. This practice is crucial for understanding how absorbing barriers in a stochastic process correspond to Dirichlet boundary conditions in the associated PDE.", "problem": "Consider a one-dimensional standard Brownian motion $X_t$ started at $X_0 = x \\in (0,L)$, where $L > 0$, and let the state space be the open interval $D = (0,L)$ with absorbing boundaries at $0$ and $L$. Define the first exit time $\\tau = \\inf\\{t \\geq 0 : X_t \\notin D\\}$. Let the running accumulation rate be the constant function $f \\equiv c$ with $c > 0$. Define the functional\n$$\nu(x) = \\mathbb{E}_x\\left[\\int_{0}^{\\tau} c \\, dt\\right],\n$$\nwhich represents the expected accumulated amount until exit.\n\nUsing only first principles from stochastic calculus (in particular, Itô’s formula for time-homogeneous functions of Brownian motion and the characterization of the infinitesimal generator of Brownian motion), derive the boundary value problem that $u$ must satisfy and solve it explicitly to obtain $u(x)$ as a closed-form analytic expression in terms of $c$, $L$, and $x$.\n\nYour final answer must be a single closed-form expression. No rounding is required and no units are involved.", "solution": "The problem asks for the explicit closed-form expression for the functional $u(x) = \\mathbb{E}_x\\left[\\int_{0}^{\\tau} c \\, dt\\right]$, where $X_t$ is a one-dimensional standard Brownian motion starting at $X_0=x \\in (0,L)$, $\\tau$ is the first exit time from the open interval $D=(0,L)$, and $c$ is a positive constant. The derivation must use first principles from stochastic calculus.\n\nFirst, we can simplify the expression for $u(x)$. Since $c$ is a constant, we can take it out of the integral and the expectation:\n$$\nu(x) = \\mathbb{E}_x\\left[c \\int_{0}^{\\tau} 1 \\, dt\\right] = c \\, \\mathbb{E}_x\\left[\\tau\\right]\n$$\nThis shows that $u(x)$ is proportional to the expected exit time from the interval $(0,L)$. We aim to find a differential equation that $u(x)$ must satisfy.\n\nThe core principle we will use is the construction of a martingale. Let $u(x)$ be a function in $C^2((0,L))$, the space of twice continuously differentiable functions on $(0,L)$. The process $X_t$ is a standard Brownian motion, so its stochastic differential equation is $dX_t = dB_t$, where $B_t$ is a standard Wiener process. The quadratic variation of $X_t$ is $d[X]_t = dt$.\n\nLet us define a new process $M_t = u(X_t) + \\int_0^t c \\, ds = u(X_t) + ct$. We will find the function $u(x)$ such that the stopped process $M_{t \\wedge \\tau}$ is a martingale. A process is a martingale if its drift term is zero. To find the drift, we apply Itô's formula to $u(X_t)$. For a time-homogeneous function $u(x)$, Itô's formula states:\n$$\ndu(X_t) = u'(X_t) dX_t + \\frac{1}{2} u''(X_t) d[X]_t\n$$\nSubstituting $dX_t = dB_t$ and $d[X]_t = dt$, we get:\n$$\ndu(X_t) = u'(X_t) dB_t + \\frac{1}{2} u''(X_t) dt\n$$\nNow, let's find the differential of the process $M_t$:\n$$\ndM_t = du(X_t) + d(ct) = \\left(u'(X_t) dB_t + \\frac{1}{2} u''(X_t) dt\\right) + c \\, dt\n$$\n$$\ndM_t = u'(X_t) dB_t + \\left(\\frac{1}{2} u''(X_t) + c\\right) dt\n$$\nFor $M_t$ to be a local martingale, its drift term (the coefficient of $dt$) must be zero for all $x \\in (0,L)$. The term $\\frac{1}{2}u''(x)$ is the action of the infinitesimal generator of the standard Brownian motion, $\\mathcal{A} = \\frac{1}{2}\\frac{d^2}{dx^2}$, on the function $u(x)$. The condition that the drift is zero, $\\mathcal{A}u(x) + c = 0$, gives us the following second-order ordinary differential equation (ODE):\n$$\n\\frac{1}{2} u''(x) + c = 0\n$$\nwhich simplifies to:\n$$\nu''(x) = -2c\n$$\nThis ODE must hold for all $x \\in D = (0,L)$.\n\nNext, we must determine the boundary conditions for this ODE. The functional $u(x)$ is defined in terms of the first exit time $\\tau = \\inf\\{t \\geq 0 : X_t \\notin (0,L)\\}$. If the process starts at one of the boundaries, i.e., $x=0$ or $x=L$, it is already not in the open interval $D=(0,L)$. Therefore, the first exit time is $\\tau=0$.\nFor $x=0$:\n$$\nu(0) = \\mathbb{E}_0\\left[\\int_{0}^{0} c \\, dt\\right] = \\mathbb{E}_0[0] = 0\n$$\nFor $x=L$:\n$$\nu(L) = \\mathbb{E}_L\\left[\\int_{0}^{0} c \\, dt\\right] = \\mathbb{E}_L[0] = 0\n$$\nSo, we have a boundary value problem (BVP) consisting of the ODE and two boundary conditions:\n$$\n\\begin{cases}\nu''(x) = -2c, & x \\in (0,L) \\\\\nu(0) = 0 \\\\\nu(L) = 0\n\\end{cases}\n$$\nWe solve this BVP by integrating the ODE twice with respect to $x$.\nFirst integration yields the derivative $u'(x)$:\n$$\nu'(x) = \\int -2c \\, dx = -2cx + A\n$$\nwhere $A$ is a constant of integration.\nSecond integration yields $u(x)$:\n$$\nu(x) = \\int (-2cx + A) \\, dx = -c x^2 + Ax + B\n$$\nwhere $B$ is a second constant of integration.\n\nNow, we apply the boundary conditions to determine the constants $A$ and $B$.\nUsing $u(0) = 0$:\n$$\n-c(0)^2 + A(0) + B = 0 \\implies B=0\n$$\nThe solution simplifies to $u(x) = -cx^2 + Ax$.\nUsing $u(L) = 0$:\n$$\n-cL^2 + A L = 0\n$$\nSince $L > 0$ as given in the problem, we can divide by $L$:\n$$\n-cL + A = 0 \\implies A = cL\n$$\nSubstituting the determined values of $A=cL$ and $B=0$ back into the general solution for $u(x)$, we obtain the explicit closed-form expression:\n$$\nu(x) = -cx^2 + (cL)x\n$$\nWe can factor this expression to write it more compactly:\n$$\nu(x) = cx(L-x)\n$$\nThis function represents the expected accumulated amount $c$ until the Brownian motion exits the interval $(0,L)$, starting from position $x$.", "answer": "$$\\boxed{cx(L-x)}$$", "id": "3080617"}, {"introduction": "The principles of the Feynman-Kac formula extend beyond one-dimensional financial models into higher-dimensional physical and geometric problems. This exercise explores the motion of a particle in a two-dimensional annular region, a classic problem in statistical physics [@problem_id:1338001]. Your task is to calculate the probability that the particle hits the outer boundary before the inner one, which is equivalent to solving a Dirichlet problem for the Laplace operator. This problem enhances your geometric intuition and demonstrates how symmetry can be a powerful tool for simplifying the analysis of multi-dimensional stochastic processes.", "problem": "A single gold adatom diffuses on a perfectly flat silver surface. Using advanced manipulation techniques, two concentric circular barriers are constructed, creating an annular region where the adatom is temporarily confined. The inner barrier has a radius $R_1$ and the outer barrier has a radius $R_2$, with $R_1 < R_2$. The adatom's motion on the surface is well-described by a standard two-dimensional Brownian motion.\n\nThe barriers are not perfect; they can be crossed. The process stops as soon as the adatom's path intersects either the inner or the outer circular barrier. Suppose the adatom is initially placed at a location with a radial distance $r_0$ from the center of the circles, such that $R_1 < r_0 < R_2$. Due to the symmetry of the problem, the probability of interest will not depend on the specific angular position, only on the initial radial distance $r_0$.\n\nDetermine the probability, let's call it $P(r_0)$, that the adatom will cross the outer barrier at radius $R_2$ before it crosses the inner barrier at radius $R_1$. Your final answer should be a closed-form analytic expression in terms of $r_0$, $R_1$, and $R_2$.", "solution": "Let $X_t$ be a standard two-dimensional Brownian motion on the plane, started at a point with radial coordinate $r_0$ such that $R_1<r_0<R_2$. Define the annulus $A=\\{x\\in\\mathbb{R}^{2}:R_1<|x|<R_2\\}$. Let $P(x)$ denote the probability that, starting from $x\\in A$, the process hits the outer circle $\\{|x|=R_2\\}$ before the inner circle $\\{|x|=R_1\\}$. By rotational symmetry, $P(x)$ depends only on the radius $r=|x|$, so we write $P(r)$.\n\nFor Brownian motion, the hitting probability of a portion of the boundary solves the Dirichlet problem for the Laplace operator. Thus $P(r)$ is harmonic in the annulus and satisfies the boundary conditions corresponding to absorbing barriers:\n$$\n\\Delta P=0\\quad\\text{in }A,\\qquad P(R_1)=0,\\qquad P(R_2)=1.\n$$\nIn polar coordinates, for a radially symmetric function $P(r)$, the Laplacian reduces to\n$$\n\\Delta P=P''(r)+\\frac{1}{r}P'(r).\n$$\nTherefore $P(r)$ solves the ordinary differential equation\n$$\nP''(r)+\\frac{1}{r}P'(r)=0,\\quad R_1<r<R_2,\n$$\nwith boundary conditions\n$$\nP(R_1)=0,\\qquad P(R_2)=1.\n$$\nTo solve the ODE, set $v(r)=P'(r)$, giving\n$$\nv'(r)+\\frac{1}{r}v(r)=0.\n$$\nThis is a first-order linear equation. Multiplying by $r$ yields\n$$\n\\frac{d}{dr}\\big(r\\,v(r)\\big)=0\\quad\\Rightarrow\\quad r\\,v(r)=C_1\\quad\\Rightarrow\\quad P'(r)=\\frac{C_1}{r}.\n$$\nIntegrating,\n$$\nP(r)=C_1\\ln r+C_2.\n$$\nImposing the boundary conditions:\n$$\nP(R_1)=C_1\\ln R_1+C_2=0,\\qquad P(R_2)=C_1\\ln R_2+C_2=1.\n$$\nSubtracting the first from the second,\n$$\nC_1\\big(\\ln R_2-\\ln R_1\\big)=1\\quad\\Rightarrow\\quad C_1=\\frac{1}{\\ln\\left(\\frac{R_2}{R_1}\\right)}.\n$$\nThen\n$$\nC_2=-C_1\\ln R_1=-\\frac{\\ln R_1}{\\ln\\left(\\frac{R_2}{R_1}\\right)}.\n$$\nHence, for any $R_1<r<R_2$,\n$$\nP(r)=\\frac{\\ln r-\\ln R_1}{\\ln R_2-\\ln R_1}=\\frac{\\ln\\left(\\frac{r}{R_1}\\right)}{\\ln\\left(\\frac{R_2}{R_1}\\right)}.\n$$\nEvaluated at the initial radius $r_0$, the desired probability is\n$$\nP(r_0)=\\frac{\\ln\\left(\\frac{r_0}{R_1}\\right)}{\\ln\\left(\\frac{R_2}{R_1}\\right)}.\n$$", "answer": "$$\\boxed{\\frac{\\ln\\left(\\frac{r_0}{R_1}\\right)}{\\ln\\left(\\frac{R_2}{R_1}\\right)}}$$", "id": "1338001"}]}