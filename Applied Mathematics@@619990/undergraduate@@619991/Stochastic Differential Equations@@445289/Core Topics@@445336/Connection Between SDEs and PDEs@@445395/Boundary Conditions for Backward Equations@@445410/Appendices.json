{"hands_on_practices": [{"introduction": "Let's begin with a cornerstone application of backward equations: calculating a hitting probability. This exercise will guide you through translating a probabilistic question—the chance that a particle drifting and diffusing in an interval hits one end before the other—into a concrete boundary value problem. By solving the associated ordinary differential equation with Dirichlet boundary conditions, you will directly see how the abstract machinery of infinitesimal generators provides tangible answers [@problem_id:3041824].", "problem": "Let $\\{X_{t}\\}_{t \\ge 0}$ solve the one-dimensional Stochastic Differential Equation (SDE) $\\,\\mathrm{d}X_{t}=\\mu\\,\\mathrm{d}t+\\sigma\\,\\mathrm{d}W_{t}\\,$ with constant drift $\\mu \\in \\mathbb{R}\\setminus\\{0\\}$ and constant volatility $\\sigma>0$, where $\\{W_{t}\\}_{t \\ge 0}$ is a standard Brownian motion (BM). Consider the open interval (domain) $D=(0,1)$ and the boundary subset $\\Gamma=\\{1\\}\\subset\\partial D=\\{0,1\\}$. For an initial point $x\\in(0,1)$, define the first exit time $\\tau=\\inf\\{t\\ge 0: X_{t}\\notin(0,1)\\}$ and the hitting event $A=\\{X_{\\tau}=1\\}$.\n \nStarting from the infinitesimal generator of $\\{X_{t}\\}_{t \\ge 0}$ and fundamental results such as Dynkin’s formula (or the martingale characterization of harmonic functions for the generator), derive the appropriate backward boundary value problem for the function $u(x)=\\mathbb{P}_{x}(A)$ on $(0,1)$ with boundary conditions on $\\partial D$, and then solve it to obtain $u(x)$ explicitly. Finally, evaluate the probability at the specific initial condition $x=\\tfrac{1}{3}$.\n \nProvide your final answer as a single closed-form analytic expression in terms of $\\mu$ and $\\sigma$ only. Do not approximate or round your answer; no numerical evaluation is required.", "solution": "The problem statement is deemed valid as it is scientifically grounded, well-posed, and objective. It is a standard problem in the theory of stochastic differential equations (SDEs) concerning hitting probabilities for a one-dimensional Itô process. All required data and conditions are provided, and there are no internal contradictions or ambiguities.\n\nThe stochastic process $\\{X_{t}\\}_{t \\ge 0}$ is governed by the one-dimensional SDE representing an Arithmetic Brownian Motion:\n$$\n\\mathrm{d}X_{t} = \\mu\\,\\mathrm{d}t + \\sigma\\,\\mathrm{d}W_{t}\n$$\nwhere $\\mu \\in \\mathbb{R}\\setminus\\{0\\}$ and $\\sigma > 0$ are constants, and $\\{W_{t}\\}_{t \\ge 0}$ is a standard Brownian motion. We are tasked with finding the probability $u(x) = \\mathbb{P}_{x}(A)$ of the event $A = \\{X_{\\tau}=1\\}$, where $\\tau$ is the first exit time from the domain $D=(0,1)$, starting from $X_0=x \\in (0,1)$.\n\nTo solve for $u(x)$, we will formulate and solve the appropriate backward Kolmogorov boundary value problem. According to the theory of SDEs, the hitting probability $u(x)$ is a harmonic function for the infinitesimal generator $\\mathcal{L}$ of the process $\\{X_{t}\\}_{t \\ge 0}$, meaning $\\mathcal{L}u(x)=0$ on the domain $D$. This can be formally established using Dynkin's formula.\n\nFor a general Itô process $\\mathrm{d}X_t = b(X_t)\\,\\mathrm{d}t + s(X_t)\\,\\mathrm{d}W_t$, the infinitesimal generator $\\mathcal{L}$ acting on a twice continuously differentiable function $f(x)$ is defined as:\n$$\n\\mathcal{L}f(x) = b(x) \\frac{\\mathrm{d}f}{\\mathrm{d}x} + \\frac{1}{2} s(x)^2 \\frac{\\mathrm{d}^2f}{\\mathrm{d}x^2}\n$$\nFor the given SDE, the drift coefficient is $b(x)=\\mu$ and the diffusion coefficient is $s(x)=\\sigma$. The generator is therefore:\n$$\n\\mathcal{L} = \\mu \\frac{\\mathrm{d}}{\\mathrm{d}x} + \\frac{1}{2}\\sigma^2 \\frac{\\mathrm{d}^2}{\\mathrm{d}x^2}\n$$\nThe condition $\\mathcal{L}u(x) = 0$ provides the governing ordinary differential equation (ODE) for $u(x)$:\n$$\n\\frac{1}{2}\\sigma^2 u''(x) + \\mu u'(x) = 0, \\quad \\text{for } x \\in (0,1)\n$$\nThe boundary conditions are determined by the definition of $u(x)$ on the boundary $\\partial D = \\{0,1\\}$.\n1. If the process starts at $x=1$, it has already exited at the right boundary. The exit time is $\\tau=0$ and the position is $X_{\\tau}=X_0=1$. Thus, the event $A$ occurs with probability $1$. This gives the boundary condition $u(1)=1$.\n2. If the process starts at $x=0$, it has exited at the left boundary. The exit time is $\\tau=0$ and the position is $X_{\\tau}=X_0=0$. The event $A$ cannot occur. This gives the boundary condition $u(0)=0$.\n\nThe complete boundary value problem is:\n$$\n\\begin{cases}\n\\frac{1}{2}\\sigma^2 u''(x) + \\mu u'(x) = 0, & x \\in (0,1) \\\\\nu(0) = 0 \\\\\nu(1) = 1\n\\end{cases}\n$$\nThis is a second-order, linear, homogeneous ODE with constant coefficients. We assume a solution of the form $u(x) = \\exp(rx)$, which leads to the characteristic equation:\n$$\n\\frac{1}{2}\\sigma^2 r^{2} + \\mu r = 0 \\implies r\\left(\\frac{1}{2}\\sigma^2 r + \\mu\\right) = 0\n$$\nSince the problem states $\\mu \\neq 0$ and $\\sigma > 0$, the characteristic roots are distinct:\n$$\nr_1 = 0 \\quad \\text{and} \\quad r_2 = -\\frac{2\\mu}{\\sigma^2}\n$$\nThe general solution of the ODE is a linear combination of the fundamental solutions $\\exp(r_1 x)$ and $\\exp(r_2 x)$:\n$$\nu(x) = C_1 \\exp(r_1 x) + C_2 \\exp(r_2 x) = C_1 + C_2 \\exp\\left(-\\frac{2\\mu}{\\sigma^2}x\\right)\n$$\nWe determine the constants $C_1$ and $C_2$ by applying the boundary conditions.\nFrom $u(0)=0$:\n$$\n0 = C_1 + C_2 \\exp(0) \\implies C_1 + C_2 = 0 \\implies C_1 = -C_2\n$$\nFrom $u(1)=1$:\n$$\n1 = C_1 + C_2 \\exp\\left(-\\frac{2\\mu}{\\sigma^2}\\right)\n$$\nSubstituting $C_1 = -C_2$ into the second equation:\n$$\n1 = -C_2 + C_2 \\exp\\left(-\\frac{2\\mu}{\\sigma^2}\\right) = C_2 \\left(\\exp\\left(-\\frac{2\\mu}{\\sigma^2}\\right) - 1\\right)\n$$\nSolving for $C_2$:\n$$\nC_2 = \\frac{1}{\\exp\\left(-\\frac{2\\mu}{\\sigma^2}\\right) - 1}\n$$\nThen $C_1 = -C_2$:\n$$\nC_1 = \\frac{1}{1 - \\exp\\left(-\\frac{2\\mu}{\\sigma^2}\\right)}\n$$\nSubstituting these constants back into the general solution gives the explicit form of $u(x)$:\n$$\nu(x) = \\frac{1}{1 - \\exp\\left(-\\frac{2\\mu}{\\sigma^2}\\right)} + \\frac{1}{\\exp\\left(-\\frac{2\\mu}{\\sigma^2}\\right) - 1}\\exp\\left(-\\frac{2\\mu}{\\sigma^2}x\\right)\n$$\n$$\nu(x) = \\frac{1}{1 - \\exp\\left(-\\frac{2\\mu}{\\sigma^2}\\right)} - \\frac{1}{1 - \\exp\\left(-\\frac{2\\mu}{\\sigma^2}\\right)}\\exp\\left(-\\frac{2\\mu}{\\sigma^2}x\\right)\n$$\n$$\nu(x) = \\frac{1 - \\exp\\left(-\\frac{2\\mu}{\\sigma^2}x\\right)}{1 - \\exp\\left(-\\frac{2\\mu}{\\sigma^2}\\right)}\n$$\nFinally, we evaluate this probability at the specified initial condition $x=\\frac{1}{3}$:\n$$\nu\\left(\\frac{1}{3}\\right) = \\frac{1 - \\exp\\left(-\\frac{2\\mu}{\\sigma^2} \\cdot \\frac{1}{3}\\right)}{1 - \\exp\\left(-\\frac{2\\mu}{\\sigma^2}\\right)} = \\frac{1 - \\exp\\left(-\\frac{2\\mu}{3\\sigma^2}\\right)}{1 - \\exp\\left(-\\frac{2\\mu}{\\sigma^2}\\right)}\n$$\nThis is the final expression for the probability in terms of the parameters $\\mu$ and $\\sigma$.", "answer": "$$\n\\boxed{\\frac{1 - \\exp\\left(-\\frac{2\\mu}{3\\sigma^{2}}\\right)}{1 - \\exp\\left(-\\frac{2\\mu}{\\sigma^{2}}\\right)}}\n$$", "id": "3041824"}, {"introduction": "The interaction of a process with a boundary is not always simple absorption. A boundary can be reflecting, like a sealed container preventing escape, or something in between. This practice explores the rich behavior arising from different boundary interactions, where you will compare the absorbing (Dirichlet), reflecting (Neumann), and partially reflecting (Robin) conditions. This hands-on comparison is key to developing a deeper intuition for how mathematical conditions model distinct physical phenomena at the edge of a domain [@problem_id:3041839].", "problem": "Consider a one-dimensional Itō diffusion process governed by the stochastic differential equation $dX_t = \\mu\\,dt + \\sigma\\,dW_t$ on the closed interval $[0,L]$, where $\\mu \\in \\mathbb{R}$ is the constant drift, $\\sigma > 0$ is the constant diffusion coefficient, $L > 0$ is the domain length, and $W_t$ is a standard Wiener process. Let $u(x)$ denote the probability that the process starting at $X_0 = x$ reaches the right endpoint $L$ before the left endpoint $0$, where the interaction at the left endpoint depends on the boundary type.\n\nFrom the backward Kolmogorov equation, this hitting probability $u(x)$ solves the linear second-order ordinary differential equation (a special case of a Partial Differential Equation (PDE) in one dimension)\n$$\n\\frac{\\sigma^2}{2}\\,u''(x) + \\mu\\,u'(x) = 0, \\quad x \\in (0,L),\n$$\nsubject to a boundary condition at $x=0$ that depends on the boundary type and the target boundary condition $u(L) = 1$ at $x=L$. Specifically, consider and compare the following three boundary types at $x=0$:\n\n- Dirichlet boundary at $x=0$: $u(0) = 0$ (fully absorbing at the left boundary).\n- Neumann boundary at $x=0$: $u'(0) = 0$ (perfectly reflecting at the left boundary).\n- Robin boundary at $x=0$: $u'(0) - \\kappa\\,u(0) = 0$ with $\\kappa > 0$ (interpolating between Neumann as $\\kappa \\to 0$ and Dirichlet as $\\kappa \\to \\infty$).\n\nYour task is to implement a program that, for given parameter sets $(\\mu,\\sigma,L,\\kappa,x)$ and the boundary type at $x=0$, computes the corresponding value of $u(x)$ by solving the backward boundary value problem. The program must use correct formulas derived from the above differential equation and boundary conditions. No physical units are required for the output.\n\nUse the following test suite of parameter values to exercise and compare the effect of boundary type on $u(x)$, including representative cases, boundary values, and edge cases:\n\n- Test case $1$: Dirichlet at $x=0$, with $(\\mu,\\sigma,L,x) = (0.5,\\,1.0,\\,1.0,\\,0.3)$.\n- Test case $2$: Dirichlet at $x=0$, with $(\\mu,\\sigma,L,x) = (-0.5,\\,1.0,\\,1.0,\\,0.7)$.\n- Test case $3$: Dirichlet at $x=0$, boundary start, with $(\\mu,\\sigma,L,x) = (0.2,\\,1.0,\\,1.0,\\,0.0)$.\n- Test case $4$: Dirichlet at $x=0$, target boundary, with $(\\mu,\\sigma,L,x) = (0.2,\\,1.0,\\,1.0,\\,1.0)$.\n- Test case $5$: Neumann at $x=0$, with $(\\mu,\\sigma,L,x) = (0.0,\\,1.0,\\,1.0,\\,0.6)$.\n- Test case $6$: Neumann at $x=0$, with $(\\mu,\\sigma,L,x) = (-0.5,\\,1.0,\\,1.0,\\,0.2)$.\n- Test case $7$: Robin at $x=0$ with $\\kappa = 5.0$, and $(\\mu,\\sigma,L,x) = (0.5,\\,1.0,\\,1.0,\\,0.3)$.\n- Test case $8$: Robin at $x=0$ with $\\kappa = 0.1$, and $(\\mu,\\sigma,L,x) = (0.5,\\,1.0,\\,1.0,\\,0.7)$.\n- Test case $9$: Robin at $x=0$ with $\\kappa = 2.0$ and zero drift, $(\\mu,\\sigma,L,x) = (0.0,\\,1.0,\\,1.0,\\,0.4)$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (for example, $[r_1,r_2,\\dots,r_9]$), where each $r_i$ is the computed value of $u(x)$ for the corresponding test case. Each output must be a floating-point number. No user input is required, and the program must be self-contained and runnable as-is.", "solution": "The problem is valid as it is scientifically grounded in the theory of stochastic differential equations, mathematically well-posed, and presented with objective, unambiguous specifications. We proceed to derive the analytical solutions for the hitting probability $u(x)$.\n\nThe hitting probability $u(x)$ is the solution to the backward Kolmogorov equation, which for a one-dimensional Itō process with constant drift $\\mu$ and diffusion $\\sigma$ on the domain $x \\in (0,L)$ is the following second-order linear ordinary differential equation (ODE):\n$$\n\\frac{\\sigma^2}{2}\\,u''(x) + \\mu\\,u'(x) = 0\n$$\nTo find the general solution, we can let $v(x) = u'(x)$, which transforms the equation into a first-order ODE for $v(x)$:\n$$\n\\frac{\\sigma^2}{2}\\,v'(x) + \\mu\\,v(x) = 0 \\implies v'(x) = -\\frac{2\\mu}{\\sigma^2}v(x)\n$$\nThis is a separable equation with the solution $v(x) = C_1 e^{-\\frac{2\\mu}{\\sigma^2}x}$. Integrating $v(x)$ with respect to $x$ gives $u(x)$. The form of the solution depends on whether $\\mu$ is zero or non-zero.\n\n**Case 1: Non-zero drift ($\\mu \\neq 0$)**\n\nWe define the constant $\\gamma = \\frac{2\\mu}{\\sigma^2}$. The solution for $u'(x)$ is $u'(x) = C_1 e^{-\\gamma x}$. Integrating this with respect to $x$ yields the general solution for $u(x)$:\n$$\nu(x) = \\int C_1 e^{-\\gamma x} dx = -\\frac{C_1}{\\gamma} e^{-\\gamma x} + C_2\n$$\nFor notational simplicity, we express this as:\n$$\nu(x) = A e^{-\\gamma x} + B\n$$\nwhere $A$ and $B$ are constants to be determined by the boundary conditions.\n\n**Case 2: Zero drift ($\\mu = 0$)**\n\nWhen $\\mu=0$, the ODE simplifies to $\\frac{\\sigma^2}{2}u''(x) = 0$. Since $\\sigma > 0$, this requires $u''(x) = 0$. Integrating twice with respect to $x$ gives the general solution:\n$$\nu(x) = C_1 x + C_2\n$$\nwhere $C_1$ and $C_2$ are constants determined by the boundary conditions.\n\nWe now derive the specific solution for each boundary type specified in the problem.\n\n**Analysis of Boundary Types**\n\n**I. Dirichlet Boundary at $x=0$**\nThe boundary conditions are $u(0)=0$ (absorbing) and $u(L)=1$ (target).\n\nIf $\\mu \\neq 0$, we use $u(x) = A e^{-\\gamma x} + B$:\n1. $u(0)=0 \\implies A e^0 + B = 0 \\implies A + B = 0 \\implies B = -A$.\n2. $u(L)=1 \\implies A e^{-\\gamma L} + B = 1$.\nSubstituting $B=-A$ into the second equation gives $A(e^{-\\gamma L} - 1) = 1$, so $A = \\frac{1}{e^{-\\gamma L} - 1}$.\nThis implies $B = -\\frac{1}{e^{-\\gamma L} - 1}$. The solution is:\n$$\nu(x) = \\frac{e^{-\\gamma x} - 1}{e^{-\\gamma L} - 1}\n$$\nIf $\\mu=0$, we use $u(x) = C_1 x + C_2$:\n1. $u(0)=0 \\implies C_1(0) + C_2 = 0 \\implies C_2=0$.\n2. $u(L)=1 \\implies C_1 L + C_2 = 1 \\implies C_1 L = 1 \\implies C_1 = \\frac{1}{L}$.\nThe solution is:\n$$\nu(x) = \\frac{x}{L}\n$$\n\n**II. Neumann Boundary at $x=0$**\nThe boundary conditions are $u'(0)=0$ (reflecting) and $u(L)=1$ (target). A reflecting boundary at $x=0$ means the process cannot terminate there. Since the domain is finite, the process must eventually reach the other boundary at $x=L$. Therefore, the probability of reaching $L$ is $1$, i.e., $u(x)=1$ for all $x \\in [0,L]$.\nWe can verify this formally.\n\nIf $\\mu \\neq 0$, we have $u(x) = A e^{-\\gamma x} + B$ and $u'(x) = -A\\gamma e^{-\\gamma x}$.\n1. $u'(0)=0 \\implies -A\\gamma e^0 = 0$. Since $\\mu \\neq 0$ implies $\\gamma \\neq 0$, we must have $A=0$.\n2. $u(L)=1 \\implies u(x) = B$ (since $A=0$), so $B=1$.\nThe solution is $u(x)=1$.\n\nIf $\\mu = 0$, we have $u(x) = C_1 x + C_2$ and $u'(x) = C_1$.\n1. $u'(0)=0 \\implies C_1=0$.\n2. $u(L)=1 \\implies u(x) = C_2$ (since $C_1=0$), so $C_2=1$.\nThe solution is again $u(x)=1$.\n\n**III. Robin Boundary at $x=0$**\nThe boundary conditions are $u'(0) - \\kappa u(0) = 0$ (partially absorbing/reflecting, with $\\kappa > 0$) and $u(L)=1$.\n\nIf $\\mu \\neq 0$, we use $u(x) = A e^{-\\gamma x} + B$.\n1. $u(L)=1 \\implies A e^{-\\gamma L} + B = 1 \\implies B = 1 - A e^{-\\gamma L}$.\n2. $u'(0) - \\kappa u(0) = 0 \\implies (-A\\gamma) - \\kappa(A+B) = 0$.\nSubstituting $B$ into the second condition:\n$-A\\gamma - \\kappa(A + 1 - A e^{-\\gamma L}) = 0$\n$A(-\\gamma - \\kappa + \\kappa e^{-\\gamma L}) = \\kappa \\implies A = \\frac{\\kappa}{\\kappa e^{-\\gamma L} - \\gamma - \\kappa}$.\nAfter solving for $B$, the final solution is:\n$$\nu(x) = \\frac{\\kappa e^{-\\gamma x} - \\gamma - \\kappa}{\\kappa e^{-\\gamma L} - \\gamma - \\kappa}\n$$\nThis formula correctly recovers the Neumann solution $u(x)=1$ as $\\kappa \\to 0$ and the Dirichlet solution as $\\kappa \\to \\infty$.\n\nIf $\\mu=0$, we use $u(x) = C_1 x + C_2$.\n1. $u(L)=1 \\implies C_1 L + C_2 = 1 \\implies C_2 = 1 - C_1 L$.\n2. $u'(0) - \\kappa u(0) = 0 \\implies C_1 - \\kappa C_2 = 0 \\implies C_1 = \\kappa C_2$.\nSubstituting $C_2 = C_1/\\kappa$ into the first condition:\n$C_1 L + C_1/\\kappa = 1 \\implies C_1(L+1/\\kappa) = 1 \\implies C_1 = \\frac{\\kappa}{1+\\kappa L}$.\nThis gives $C_2 = C_1/\\kappa = \\frac{1}{1+\\kappa L}$.\nThe solution is:\n$$\nu(x) = \\frac{\\kappa x + 1}{1+\\kappa L}\n$$\nThis is also consistent with the $\\mu \\to 0$ limit of the Robin solution for $\\mu \\neq 0$.\n\nThese derived analytical formulas are implemented to compute the results for the given test cases.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the hitting probability u(x) for a 1D Itō diffusion process\n    on [0, L] for various boundary conditions at x=0.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {'type': 'Dirichlet', 'mu': 0.5, 'sigma': 1.0, 'L': 1.0, 'kappa': None, 'x': 0.3},\n        {'type': 'Dirichlet', 'mu': -0.5, 'sigma': 1.0, 'L': 1.0, 'kappa': None, 'x': 0.7},\n        {'type': 'Dirichlet', 'mu': 0.2, 'sigma': 1.0, 'L': 1.0, 'kappa': None, 'x': 0.0},\n        {'type': 'Dirichlet', 'mu': 0.2, 'sigma': 1.0, 'L': 1.0, 'kappa': None, 'x': 1.0},\n        {'type': 'Neumann', 'mu': 0.0, 'sigma': 1.0, 'L': 1.0, 'kappa': None, 'x': 0.6},\n        {'type': 'Neumann', 'mu': -0.5, 'sigma': 1.0, 'L': 1.0, 'kappa': None, 'x': 0.2},\n        {'type': 'Robin', 'mu': 0.5, 'sigma': 1.0, 'L': 1.0, 'kappa': 5.0, 'x': 0.3},\n        {'type': 'Robin', 'mu': 0.5, 'sigma': 1.0, 'L': 1.0, 'kappa': 0.1, 'x': 0.7},\n        {'type': 'Robin', 'mu': 0.0, 'sigma': 1.0, 'L': 1.0, 'kappa': 2.0, 'x': 0.4},\n    ]\n\n    results = []\n    \n    # Epsilon for floating point comparison with zero\n    TOLERANCE = 1e-12\n\n    for case in test_cases:\n        mu = case['mu']\n        sigma = case['sigma']\n        L = case['L']\n        x = case['x']\n        \n        result = 0.0\n\n        if case['type'] == 'Dirichlet':\n            if abs(mu)  TOLERANCE:\n                # Solution for mu = 0\n                if L > TOLERANCE:\n                    result = x / L\n                else: # To handle potential division by zero, though L>0 is given\n                    result = 1.0 if x >= L else 0.0\n            else:\n                # Solution for mu != 0\n                gamma = 2.0 * mu / (sigma**2)\n                numerator = np.exp(-gamma * x) - 1.0\n                denominator = np.exp(-gamma * L) - 1.0\n                if abs(denominator)  TOLERANCE: # Fallback, should not happen for L>0, mu!=0\n                    result = x / L\n                else: \n                    result = numerator / denominator\n\n        elif case['type'] == 'Neumann':\n            # For a reflecting boundary at x=0 and absorbing at x=L on a finite domain,\n            # the particle must eventually hit L.\n            result = 1.0\n\n        elif case['type'] == 'Robin':\n            kappa = case['kappa']\n            if abs(mu)  TOLERANCE:\n                # Solution for mu = 0\n                numerator = kappa * x + 1.0\n                denominator = 1.0 + kappa * L\n                result = numerator / denominator\n            else:\n                # Solution for mu != 0\n                gamma = 2.0 * mu / (sigma**2)\n                numerator = kappa * np.exp(-gamma * x) - gamma - kappa\n                denominator = kappa * np.exp(-gamma * L) - gamma - kappa\n                if abs(denominator)  TOLERANCE: # Unlikely edge case\n                    # This implies kappa(exp(-gamma*L) - 1) = gamma\n                    # We will assume test cases avoid this singularity.\n                    result = np.nan\n                else:\n                    result = numerator / denominator\n        \n        results.append(result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.8f}' for r in results)}]\")\n\nsolve()\n```", "id": "3041839"}, {"introduction": "Besides asking *whether* a particle will hit a boundary, we often care about *when*. This problem shifts our focus from hitting probabilities to expected exit times, a quantity of great importance in fields ranging from finance to cell biology. You will derive and solve the fundamental inhomogeneous equation $\\mathcal{L}v(x) = -1$, often called Dynkin's equation, which governs this expected time. This exercise demonstrates the power and flexibility of the backward equation framework to answer a different, but related, class of questions [@problem_id:3041857].", "problem": "Consider a time-homogeneous diffusion process $X=(X_t)_{t \\geq 0}$ in $\\mathbb{R}^{n}$ with infinitesimal generator $\\mathcal{L}$ acting on twice continuously differentiable functions $f \\in C^{2}(\\mathbb{R}^{n})$ by the standard definition $\\mathcal{L} f(x) = \\lim_{t \\downarrow 0} \\frac{\\mathbb{E}_{x}[f(X_{t})] - f(x)}{t}$, where $\\mathbb{E}_{x}[\\cdot]$ denotes expectation conditioned on $X_{0} = x$. Let $D \\subset \\mathbb{R}^{n}$ be a bounded, open domain with sufficiently regular boundary $\\partial D$. Define the first exit time from $D$ by $\\tau_{D} = \\inf\\{t \\geq 0 : X_{t} \\notin D\\}$. Consider the expected exit time function $v(x) = \\mathbb{E}_{x}[\\tau_{D}]$ for $x \\in D$.\n\nStarting from fundamental principles—namely, the strong Markov property, the definition of the infinitesimal generator, and Itô's formula—derive the boundary value problem satisfied by $v$ in $D$. In particular, establish that $v$ is the unique solution to the backward equation $\\mathcal{L} v(x) = -1$ in $D$ with the Dirichlet boundary condition $v|_{\\partial D} = 0$.\n\nThen specialize to one dimension and let $X$ be a standard Brownian motion (BM) satisfying the stochastic differential equation (SDE) $dX_{t} = dW_{t}$ on the interval $(0,a)$ for a fixed $a > 0$. Use the corresponding generator for BM to compute an explicit closed-form expression for $v(x)$ for $x \\in (0,a)$, under the boundary condition $v(0) = v(a) = 0$.\n\nYour final answer must be a single closed-form analytic expression for $v(x)$ in terms of $x$ and $a$. No numerical approximation is required.", "solution": "### Derivation of the Boundary Value Problem\n\nWe are asked to derive the boundary value problem satisfied by the expected exit time $v(x) = \\mathbb{E}_{x}[\\tau_{D}]$. This involves establishing both the governing partial differential equation (PDE) within the domain $D$ and the condition on its boundary $\\partial D$.\n\n**1. The Boundary Condition**\n\nLet $x \\in \\partial D$. The first exit time $\\tau_D$ is defined as $\\tau_{D} = \\inf\\{t \\geq 0 : X_{t} \\notin D\\}$. Since $D$ is an open set, its boundary $\\partial D$ is not part of $D$. Therefore, if the process starts at $X_0 = x \\in \\partial D$, it is already outside of $D$ at time $t=0$. The infimum is thus $0$.\nSo, for any $x \\in \\partial D$, we have $\\tau_D = 0$. The expected value is then $v(x) = \\mathbb{E}_{x}[0] = 0$. This gives the Dirichlet boundary condition:\n$$v(x) = 0 \\quad \\text{for } x \\in \\partial D$$\n\n**2. The Differential Equation**\n\nTo derive the equation inside the domain $D$, we assume that $v(x)$ is sufficiently smooth, specifically that $v \\in C^2(D)$, so that it lies in the domain of the generator $\\mathcal{L}$. We use the strong Markov property of the diffusion process $X_t$.\n\nFor a small time increment $h > 0$, we can express the total exit time $\\tau_D$ by conditioning on the process up to time $h$.\n$$v(x) = \\mathbb{E}_{x}[\\tau_D]$$\nBy the tower property of conditional expectation and the strong Markov property at the stopping time $h \\wedge \\tau_D$, we can write:\n$$v(x) = \\mathbb{E}_{x}[h \\wedge \\tau_D + (\\tau_D - h)^+ ] = \\mathbb{E}_{x}[h \\wedge \\tau_D] + \\mathbb{E}_{x}[(\\tau_D - h)\\mathbf{1}_{\\{h  \\tau_D\\}}] $$\nwhere $\\mathbf{1}_{\\{\\cdot\\}}$ is the indicator function. The second term, by the strong Markov property at time $h$, can be rewritten as:\n$$ \\mathbb{E}_{x}[(\\tau_D - h)\\mathbf{1}_{\\{h  \\tau_D\\}}] = \\mathbb{E}_{x}[\\mathbf{1}_{\\{h  \\tau_D\\}} \\mathbb{E}_{X_h}[\\tau_D]] = \\mathbb{E}_{x}[\\mathbf{1}_{\\{h  \\tau_D\\}} v(X_h)] $$\nSo, we have:\n$$ v(x) = \\mathbb{E}_{x}[h \\wedge \\tau_D] + \\mathbb{E}_{x}[v(X_h) \\mathbf{1}_{\\{h  \\tau_D\\}}] $$\nFor a small time $h$, the probability of exiting the domain, $P_x(\\tau_D \\le h)$, is of order smaller than $h$ (i.e., $o(h)$), for $x$ not on the boundary. Thus, we can make the following approximations for $h \\downarrow 0$:\n$$ \\mathbb{E}_{x}[h \\wedge \\tau_D] = h \\cdot P_x(\\tau_D > h) + \\mathbb{E}_{x}[\\tau_D | \\tau_D \\le h] P_x(\\tau_D \\le h) = h(1 - o(1)) + O(h)o(h) = h + o(h) $$\n$$ \\mathbb{E}_{x}[v(X_h) \\mathbf{1}_{\\{h  \\tau_D\\}}] = \\mathbb{E}_{x}[v(X_h)] - \\mathbb{E}_{x}[v(X_h)\\mathbf{1}_{\\{h \\geq \\tau_D\\}}] = \\mathbb{E}_{x}[v(X_h)] + o(h) $$\nSubstituting these approximations into our equation for $v(x)$:\n$$ v(x) = h + \\mathbb{E}_{x}[v(X_h)] + o(h) $$\nRearranging the terms, we get:\n$$ \\mathbb{E}_{x}[v(X_h)] - v(x) = -h + o(h) $$\nDividing by $h$ and taking the limit as $h \\downarrow 0$:\n$$ \\lim_{h \\downarrow 0} \\frac{\\mathbb{E}_{x}[v(X_h)] - v(x)}{h} = -1 $$\nThe left-hand side is precisely the definition of the infinitesimal generator $\\mathcal{L}$ applied to the function $v$ at point $x$. Therefore, we arrive at the PDE:\n$$ \\mathcal{L}v(x) = -1 \\quad \\text{for } x \\in D $$\nThe uniqueness of the solution to this elliptic BVP is a standard result from PDE theory, which we take as given. Thus, $v(x) = \\mathbb{E}_x[\\tau_D]$ is the unique solution to the BVP.\n\n### Specialization to 1D Standard Brownian Motion\n\nNow, we specialize to the case where $X_t$ is a one-dimensional standard Brownian motion, satisfying the SDE $dX_t = dW_t$. The domain is the interval $D = (0,a)$ for some $a>0$.\n\n**1. The Generator for Brownian Motion**\n\nThe general infinitesimal generator for a 1D diffusion $dX_t = b(X_t)dt + \\sigma(X_t)dW_t$ is given by:\n$$ \\mathcal{L}f(x) = b(x) \\frac{df}{dx}(x) + \\frac{1}{2}\\sigma(x)^2 \\frac{d^2f}{dx^2}(x) $$\nFor standard BM, the drift coefficient is $b(x) = 0$ and the diffusion coefficient is $\\sigma(x)=1$. Substituting these into the generator gives:\n$$ \\mathcal{L}f(x) = (0) \\frac{df}{dx}(x) + \\frac{1}{2}(1)^2 \\frac{d^2f}{dx^2}(x) = \\frac{1}{2} \\frac{d^2f}{dx^2}(x) $$\nSo, the generator is $\\mathcal{L} = \\frac{1}{2}\\frac{d^2}{dx^2}$.\n\n**2. Solving the Boundary Value Problem**\n\nThe BVP we must solve is $\\mathcal{L}v(x) = -1$ in $(0,a)$ with boundary conditions $v(0)=0$ and $v(a)=0$.\nSubstituting the specific generator, we obtain the ordinary differential equation:\n$$ \\frac{1}{2} v''(x) = -1 $$\n$$ v''(x) = -2 $$\nWe solve this ODE by integrating twice. Integrating with respect to $x$ gives the first derivative:\n$$ v'(x) = \\int -2 \\, dx = -2x + C_1 $$\nwhere $C_1$ is a constant of integration. Integrating a second time gives the general solution for $v(x)$:\n$$ v(x) = \\int (-2x + C_1) \\, dx = -x^2 + C_1 x + C_2 $$\nwhere $C_2$ is a second constant of integration. We determine the constants $C_1$ and $C_2$ using the boundary conditions.\n\nThe first boundary condition is $v(0)=0$:\n$$ v(0) = -(0)^2 + C_1(0) + C_2 = 0 \\implies C_2 = 0 $$\nThis simplifies the solution to $v(x) = -x^2 + C_1 x$.\n\nThe second boundary condition is $v(a)=0$:\n$$ v(a) = -a^2 + C_1 a = 0 $$\nSince $a>0$, we can divide the equation by $a$:\n$$ -a + C_1 = 0 \\implies C_1 = a $$\nSubstituting the values of $C_1=a$ and $C_2=0$ back into the general solution, we obtain the explicit closed-form expression for the expected exit time:\n$$ v(x) = -x^2 + ax $$\nThis can also be written as $v(x) = x(a-x)$. This represents a parabola opening downwards, with roots at $x=0$ and $x=a$, and is positive for $x \\in (0,a)$, as expected for a time duration.", "answer": "$$\\boxed{ax - x^2}$$", "id": "3041857"}]}