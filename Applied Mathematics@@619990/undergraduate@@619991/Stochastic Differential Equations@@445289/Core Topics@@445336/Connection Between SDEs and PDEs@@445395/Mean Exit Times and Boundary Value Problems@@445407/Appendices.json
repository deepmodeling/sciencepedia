{"hands_on_practices": [{"introduction": "This first practice serves as the cornerstone for our study of mean exit times. We will analyze the most fundamental continuous stochastic process—standard Brownian motion—and translate the probabilistic question of \"how long, on average, does a particle take to leave an interval?\" into a simple, solvable boundary value problem. By solving this problem, you will derive an elegant and intuitive formula that connects the starting position directly to the expected time of exit. [@problem_id:3065879]", "problem": "Consider one-dimensional Brownian motion $X_t$ satisfying the stochastic differential equation (SDE) $dX_t = dW_t$, where $W_t$ is standard Brownian motion, and assume $X_0 = x \\in (a,b)$ with $a < b$. Let the first exit time from the open interval $D = (a,b)$ be $\\tau_{(a,b)} = \\inf\\{t \\ge 0 : X_t \\notin (a,b)\\}$. Define the mean exit time $u(x) = \\mathbb{E}_x[\\tau_{(a,b)}]$. Starting from the generator of Brownian motion and fundamental principles such as Dynkin’s formula, derive the appropriate boundary value problem that $u(x)$ must satisfy and solve it to obtain a closed-form expression for $u(x)$. Your final answer must be a single closed-form analytic expression in terms of $a$, $b$, and $x$. No numerical approximation or rounding is required.", "solution": "The problem asks for the mean exit time, $u(x) = \\mathbb{E}_x[\\tau_{(a,b)}]$, for a one-dimensional standard Brownian motion $X_t$ starting at $X_0 = x$ from the open interval $D = (a,b)$. The process is described by the stochastic differential equation (SDE) $dX_t = dW_t$.\n\nFirst, we validate the problem statement.\nThe givens are:\n1.  The SDE for the process $X_t$: $dX_t = dW_t$.\n2.  The initial state: $X_0 = x \\in (a, b)$.\n3.  The domain: $D = (a,b)$, where $a < b$ are real constants.\n4.  The first exit time: $\\tau_{(a,b)} = \\inf\\{t \\ge 0 : X_t \\notin (a,b)\\}$.\n5.  The function to be determined: The mean exit time $u(x) = \\mathbb{E}_x[\\tau_{(a,b)}]$.\n\nThe problem is scientifically grounded, well-posed, and objective. It is a canonical problem in the theory of stochastic differential equations. All necessary information is provided, and there are no contradictions or ambiguities. The problem is valid.\n\nWe proceed to derive the boundary value problem (BVP) for $u(x)$. The infinitesimal generator, denoted by $L$, of a diffusion process described by the SDE $dX_t = \\mu(X_t) dt + \\sigma(X_t) dW_t$ is the differential operator $L = \\mu(x)\\frac{d}{dx} + \\frac{1}{2}\\sigma^2(x)\\frac{d^2}{dx^2}$.\nFor the given process $dX_t = dW_t$, the drift coefficient is $\\mu(x) = 0$ and the diffusion coefficient is $\\sigma(x) = 1$.\nThus, the generator for one-dimensional standard Brownian motion is:\n$$\nL = \\frac{1}{2} \\frac{d^2}{dx^2}\n$$\nA fundamental result, derivable from Dynkin's formula or Itô's lemma, states that the mean first exit time $u(x)$ from a domain $D$ for a diffusion process $X_t$ satisfies the following Poisson equation within the domain:\n$$\nLu(x) = -1, \\quad \\text{for } x \\in D\n$$\nThe boundary condition is determined by the nature of the exit. If the process starts at the boundary $x \\in \\partial D$, the exit is instantaneous, so the exit time is $0$. This implies a Dirichlet boundary condition:\n$$\nu(x) = 0, \\quad \\text{for } x \\in \\partial D\n$$\nFor the specific interval $D = (a,b)$, the boundary is the set $\\{a, b\\}$. This translates our problem into solving the following second-order ordinary differential equation with boundary conditions:\n1.  Differential Equation: $\\frac{1}{2} \\frac{d^2u}{dx^2} = -1$ for $x \\in (a,b)$, which simplifies to $\\frac{d^2u}{dx^2} = -2$.\n2.  Boundary Conditions: $u(a) = 0$ and $u(b) = 0$.\n\nWe solve the differential equation by direct integration. Integrating $\\frac{d^2u}{dx^2} = -2$ with respect to $x$ once gives:\n$$\n\\frac{du}{dx} = -2x + C_1\n$$\nwhere $C_1$ is a constant of integration. Integrating a second time yields the general solution for $u(x)$:\n$$\nu(x) = -x^2 + C_1 x + C_2\n$$\nwhere $C_2$ is a second constant of integration.\n\nNext, we apply the boundary conditions to determine the constants $C_1$ and $C_2$.\nUsing $u(a) = 0$:\n$$\n-a^2 + C_1 a + C_2 = 0 \\quad (1)\n$$\nUsing $u(b) = 0$:\n$$\n-b^2 + C_1 b + C_2 = 0 \\quad (2)\n$$\nThis is a system of two linear equations for $C_1$ and $C_2$. To find $C_1$, we subtract equation $(1)$ from equation $(2)$:\n$$\n(-b^2 - (-a^2)) + (C_1 b - C_1 a) = 0\n$$\n$$\na^2 - b^2 + C_1(b - a) = 0\n$$\nFactoring the difference of squares, $(a-b)(a+b) - C_1(a-b) = 0$.\nSince $a < b$, we know $a - b \\neq 0$, so we can divide by $(a-b)$:\n$$\na+b - C_1 = 0\n$$\nwhich gives $C_1 = a+b$.\n\nNow we substitute $C_1 = a+b$ back into equation $(1)$ to find $C_2$:\n$$\n-a^2 + (a+b)a + C_2 = 0\n$$\n$$\n-a^2 + a^2 + ab + C_2 = 0\n$$\n$$\nab + C_2 = 0\n$$\nwhich gives $C_2 = -ab$.\n\nHaving found the constants $C_1 = a+b$ and $C_2 = -ab$, we substitute them into the general solution for $u(x)$:\n$$\nu(x) = -x^2 + (a+b)x - ab\n$$\nThis expression is the solution. It can be written in a more insightful factored form. By rearranging the terms:\n$$\nu(x) = -(x^2 - (a+b)x + ab)\n$$\nThe quadratic expression in the parenthesis has roots at $x=a$ and $x=b$, so it can be factored as $(x-a)(x-b)$. Therefore:\n$$\nu(x) = -(x-a)(x-b)\n$$\nThis can be rewritten to make both factors positive for $x \\in (a,b)$:\n$$\nu(x) = (x-a)(b-x)\n$$\nThis is the closed-form expression for the mean exit time of a standard Brownian motion from the interval $(a,b)$, starting at $x$. The solution is physically intuitive: it is an inverted parabola with its maximum at the midpoint of the interval, $x = \\frac{a+b}{2}$, and is zero at the boundaries $x=a$ and $x=b$.", "answer": "$$\n\\boxed{(x-a)(b-x)}\n$$", "id": "3065879"}, {"introduction": "Building upon the foundation of pure diffusion, we now introduce a directional bias, or drift, to our particle's motion. This exercise explores how a constant drift term $\\mu$ changes the underlying dynamics and, consequently, the boundary value problem for the mean exit time. You will see how the governing equation acquires a first-order derivative term and learn to solve it using the powerful framework of scale functions and speed measures, revealing how drift systematically influences how long a process stays within a domain. [@problem_id:3065849]", "problem": "Consider the one-dimensional Itô diffusion defined on the open interval $(a,b)$ by the stochastic differential equation $dX_{t}=\\mu\\,dt+\\sigma\\,dW_{t}$, where $\\mu\\in\\mathbb{R}$ with $\\mu\\neq 0$, $\\sigma>0$, and $(W_{t})_{t\\geq 0}$ is a standard Wiener process. Let the first exit time from $(a,b)$ be $\\tau_{(a,b)}=\\inf\\{t\\geq 0: X_{t}\\notin(a,b)\\}$, and assume the initial position $X_{0}=x\\in(a,b)$.\n\nStarting from first principles, use the characterization of the mean exit time as the solution to a boundary value problem for the infinitesimal generator, together with the scale–speed framework for one-dimensional Itô diffusions (define the scale function and speed measure from their foundational definitions), to derive a closed-form expression $u(x)=\\mathbb{E}_{x}[\\tau_{(a,b)}]$ in terms of $a$, $b$, $\\mu$, $\\sigma$, and $x$. Your derivation should begin with the generator of the diffusion and the boundary conditions coming from absorption at $a$ and $b$, and it should make explicit how the scale function and speed measure arise from their definitions for this diffusion.\n\nExpress your final result as a single analytic expression in $a$, $b$, $\\mu$, $\\sigma$, and $x$ (no numerical evaluation or rounding). Do not include units.", "solution": "The problem is to find the mean first exit time $u(x) = \\mathbb{E}_{x}[\\tau_{(a,b)}]$ for the one-dimensional Itô diffusion $dX_{t}=\\mu\\,dt+\\sigma\\,dW_{t}$ from the interval $(a,b)$, starting at $X_0 = x \\in (a,b)$.\n\nThe mean exit time $u(x)$ satisfies Dynkin's equation, which for this context is the second-order ordinary differential equation (ODE):\n$$ \\mathcal{G}u(x) = -1, \\quad x \\in (a,b) $$\nwhere $\\mathcal{G}$ is the infinitesimal generator of the diffusion process $X_t$. The process is absorbed at the boundaries of the interval, which translates to the Dirichlet boundary conditions:\n$$ u(a) = 0, \\quad u(b) = 0 $$\nFor the given stochastic differential equation, the drift coefficient is the constant $\\mu$ and the diffusion coefficient is the constant $\\sigma$. The infinitesimal generator $\\mathcal{G}$ acting on a twice-differentiable function $f(x)$ is given by:\n$$ \\mathcal{G}f(x) = \\mu \\frac{df}{dx} + \\frac{1}{2}\\sigma^2 \\frac{d^2f}{dx^2} $$\nTherefore, the boundary value problem for $u(x)$ is:\n$$ \\frac{1}{2}\\sigma^2 u''(x) + \\mu u'(x) = -1, \\quad \\text{for } x \\in (a,b) $$\n$$ u(a) = 0, \\quad u(b) = 0 $$\nAs stipulated, we will solve this using the framework of the scale function and speed measure. For a general one-dimensional diffusion with generator $\\mathcal{G} = \\mu(x)\\frac{d}{dx} + \\frac{1}{2}\\sigma^2(x)\\frac{d^2}{dx^2}$, the scale density function $s(x)$ and the speed measure density $m(x)$ are defined.\n\nThe scale density $s(x)$ is defined (up to a multiplicative constant) by the property that $\\mathcal{G}S(x)=0$ where $S(x)$ is a scale function with $S'(x)=s(x)$. More directly, it is given by:\n$$ s(x) = \\exp\\left(-\\int \\frac{2\\mu(x)}{\\sigma^2(x)} dx\\right) $$\nFor our problem, with $\\mu(x)=\\mu$ and $\\sigma(x)=\\sigma$, we have:\n$$ s(x) = \\exp\\left(-\\int \\frac{2\\mu}{\\sigma^2} dx\\right) = \\exp\\left(-\\frac{2\\mu}{\\sigma^2}x\\right) $$\nWe can set the constant of integration to zero without loss of generality.\n\nThe speed measure density $m(x)$ is defined as:\n$$ m(x) = \\frac{2}{\\sigma^2(x) s(x)} $$\nFor our problem, this becomes:\n$$ m(x) = \\frac{2}{\\sigma^2 \\exp\\left(-\\frac{2\\mu}{\\sigma^2}x\\right)} = \\frac{2}{\\sigma^2} \\exp\\left(\\frac{2\\mu}{\\sigma^2}x\\right) $$\nUsing these definitions, the operator $\\mathcal{G}$ can be written in a self-adjoint form with respect to the speed measure. The equation $\\mathcal{G}u(x)=-1$ is equivalent to:\n$$ \\frac{1}{m(x)} \\frac{d}{dx}\\left(\\frac{1}{s(x)}\\frac{du}{dx}\\right) = \\mathcal{G}u(x) $$\nThus, the boundary value problem can be written as:\n$$ \\frac{d}{dx}\\left(\\frac{1}{s(x)}\\frac{du}{dx}\\right) = -m(x) $$\nWe solve this ODE by two successive integrations. Integrating once with respect to $x$ gives:\n$$ \\frac{1}{s(x)}\\frac{du}{dx} = -\\int m(x) dx + C_1 $$\nwhere $C_1$ is a constant of integration. Let's compute the integral:\n$$ \\int m(x) dx = \\int \\frac{2}{\\sigma^2} \\exp\\left(\\frac{2\\mu}{\\sigma^2}x\\right) dx = \\frac{2}{\\sigma^2} \\left(\\frac{\\sigma^2}{2\\mu}\\right) \\exp\\left(\\frac{2\\mu}{\\sigma^2}x\\right) = \\frac{1}{\\mu} \\exp\\left(\\frac{2\\mu}{\\sigma^2}x\\right) $$\nNote that $\\mu \\neq 0$ is essential here. Substituting this back:\n$$ \\exp\\left(\\frac{2\\mu}{\\sigma^2}x\\right)u'(x) = -\\frac{1}{\\mu}\\exp\\left(\\frac{2\\mu}{\\sigma^2}x\\right) + C_1 $$\nSolving for $u'(x)$:\n$$ u'(x) = -\\frac{1}{\\mu} + C_1 \\exp\\left(-\\frac{2\\mu}{\\sigma^2}x\\right) $$\nIntegrating a second time with respect to $x$ to find $u(x)$:\n$$ u(x) = \\int \\left(-\\frac{1}{\\mu} + C_1 \\exp\\left(-\\frac{2\\mu}{\\sigma^2}x\\right)\\right) dx = -\\frac{x}{\\mu} + C_1 \\left(-\\frac{\\sigma^2}{2\\mu}\\right) \\exp\\left(-\\frac{2\\mu}{\\sigma^2}x\\right) + C_2 $$\nFor simplicity, we define a new constant $C'_1 = -C_1 \\frac{\\sigma^2}{2\\mu}$. The general solution is:\n$$ u(x) = -\\frac{x}{\\mu} + C'_1 \\exp\\left(-\\frac{2\\mu}{\\sigma^2}x\\right) + C_2 $$\nNow, we apply the boundary conditions $u(a)=0$ and $u(b)=0$ to determine the constants $C'_1$ and $C_2$.\n$$ u(a) = 0 \\implies -\\frac{a}{\\mu} + C'_1 \\exp\\left(-\\frac{2\\mu}{\\sigma^2}a\\right) + C_2 = 0 \\quad (1) $$\n$$ u(b) = 0 \\implies -\\frac{b}{\\mu} + C'_1 \\exp\\left(-\\frac{2\\mu}{\\sigma^2}b\\right) + C_2 = 0 \\quad (2) $$\nSubtracting equation (1) from equation (2):\n$$ \\left(-\\frac{b}{\\mu}+\\frac{a}{\\mu}\\right) + C'_1 \\left(\\exp\\left(-\\frac{2\\mu}{\\sigma^2}b\\right) - \\exp\\left(-\\frac{2\\mu}{\\sigma^2}a\\right)\\right) = 0 $$\n$$ \\frac{a-b}{\\mu} = -C'_1 \\left(\\exp\\left(-\\frac{2\\mu}{\\sigma^2}b\\right) - \\exp\\left(-\\frac{2\\mu}{\\sigma^2}a\\right)\\right) $$\nSolving for $C'_1$:\n$$ C'_1 = \\frac{b-a}{\\mu} \\frac{1}{\\exp\\left(-\\frac{2\\mu}{\\sigma^2}a\\right) - \\exp\\left(-\\frac{2\\mu}{\\sigma^2}b\\right)} $$\nFrom equation (1), we can express $C_2$ as:\n$$ C_2 = \\frac{a}{\\mu} - C'_1 \\exp\\left(-\\frac{2\\mu}{\\sigma^2}a\\right) $$\nSubstitute $C'_1$ and $C_2$ back into the general solution for $u(x)$:\n$$ u(x) = -\\frac{x}{\\mu} + C'_1 \\exp\\left(-\\frac{2\\mu}{\\sigma^2}x\\right) + \\frac{a}{\\mu} - C'_1 \\exp\\left(-\\frac{2\\mu}{\\sigma^2}a\\right) $$\n$$ u(x) = \\frac{a-x}{\\mu} + C'_1 \\left(\\exp\\left(-\\frac{2\\mu}{\\sigma^2}x\\right) - \\exp\\left(-\\frac{2\\mu}{\\sigma^2}a\\right)\\right) $$\nFinally, substitute the expression for $C'_1$:\n$$ u(x) = \\frac{a-x}{\\mu} + \\left(\\frac{b-a}{\\mu} \\frac{1}{\\exp\\left(-\\frac{2\\mu}{\\sigma^2}a\\right) - \\exp\\left(-\\frac{2\\mu}{\\sigma^2}b\\right)}\\right) \\left(\\exp\\left(-\\frac{2\\mu}{\\sigma^2}x\\right) - \\exp\\left(-\\frac{2\\mu}{\\sigma^2}a\\right)\\right) $$\nThis expression can be rearranged to a more standard form:\n$$ u(x) = \\frac{a-x}{\\mu} + \\frac{b-a}{\\mu} \\left(\\frac{\\exp\\left(-\\frac{2\\mu}{\\sigma^2}x\\right) - \\exp\\left(-\\frac{2\\mu}{\\sigma^2}a\\right)}{\\exp\\left(-\\frac{2\\mu}{\\sigma^2}b\\right) - \\exp\\left(-\\frac{2\\mu}{\\sigma^2}a\\right)}\\right) $$\nThe fraction in this expression is precisely the probability $p_b(x) = \\mathbb{P}_x(X_{\\tau_{(a,b)}} = b)$ that the process exits at $b$ before exiting at $a$. The result expresses the mean exit time in terms of the given parameters $a$, $b$, $\\mu$, $\\sigma$, and the starting position $x$.", "answer": "$$ \\boxed{\\frac{a-x}{\\mu} + \\frac{b-a}{\\mu} \\left(\\frac{\\exp\\left(-\\frac{2\\mu}{\\sigma^2}x\\right) - \\exp\\left(-\\frac{2\\mu}{\\sigma^2}a\\right)}{\\exp\\left(-\\frac{2\\mu}{\\sigma^2}b\\right) - \\exp\\left(-\\frac{2\\mu}{\\sigma^2}a\\right)}\\right)} $$", "id": "3065849"}, {"introduction": "In real-world systems, boundaries don't always absorb particles; sometimes they reflect them. This practice explores this crucial distinction by modeling a process on an interval with a reflecting barrier at one end and an absorbing one at the other. You will learn how to formulate and apply different boundary conditions—a Dirichlet condition for absorption and a Neumann condition for reflection—to correctly capture these distinct physical behaviors in the mathematical model. [@problem_id:3065956]", "problem": "Consider a one-dimensional stochastic process on the interval $\\left[0,L\\right]$, where $L>0$ is fixed. Let $\\left(X_{t}\\right)_{t\\geq 0}$ be a reflected Brownian motion at $0$ that is absorbed upon hitting $L$. The reflected Brownian motion can be understood as a solution to a Skorokhod-type problem with instantaneous reflection at $0$ such that $X_{t}\\in\\left[0,L\\right]$ for all $t$ until absorption at $L$. Let $\\tau$ be the first hitting time of $L$, defined by\n$$\n\\tau \\equiv \\inf\\left\\{t\\geq 0 : X_{t} = L\\right\\}.\n$$\nFor a starting position $x\\in\\left[0,L\\right]$, define the mean exit time\n$$\nu(x) \\equiv \\mathbb{E}_{x}\\left[\\tau\\right],\n$$\nwhere $\\mathbb{E}_{x}\\left[\\cdot\\right]$ denotes expectation with $X_{0}=x$. Using only first principles appropriate to this setting—namely the generator for Brownian motion in the interior, the strong Markov property, and Dynkin’s formula—derive the appropriate boundary value problem satisfied by $u(x)$ that accounts for reflection at $0$ and absorption at $L$. Then solve that boundary value problem explicitly to obtain a closed-form analytic expression for $u(x)$ in terms of $L$ and $x$. Your final answer must be a single analytic expression. No rounding is required.", "solution": "The solution is derived from first principles, starting with the generator for the process and applying the appropriate boundary conditions.\n\nThe mean exit time, $u(x) = \\mathbb{E}_{x}\\left[\\tau\\right]$, is governed by the differential equation $\\mathcal{L}u = -1$ in the interior of the domain, where $\\mathcal{L}$ is the generator of the process. This fundamental relationship stems from Dynkin's formula.\n\n**1. Determine the differential equation:**\nThe stochastic process $X_t$ is a standard Brownian motion in the interior of the interval $\\left(0,L\\right)$. The generator for one-dimensional Brownian motion is:\n$$\n\\mathcal{L} = \\frac{1}{2}\\frac{d^2}{dx^2}\n$$\nThe equation for the mean exit time $u(x)$ is thus:\n$$\n\\mathcal{L}u(x) = \\frac{1}{2}u''(x) = -1\n$$\nwhich simplifies to $u''(x) = -2$ for $x \\in (0, L)$.\n\n**2. Determine the boundary conditions:**\n- **Boundary at $x=L$ (Absorption):** The process is absorbed upon hitting $L$. If the process starts at $x=L$, the time to hit $L$ is $\\tau=0$. Therefore, the mean exit time is zero, giving the Dirichlet boundary condition:\n$$\nu(L) = 0\n$$\n- **Boundary at $x=0$ (Reflection):** The process is reflected at $x=0$. For the mean exit time problem, a reflecting boundary implies a zero-derivative condition. This gives the Neumann boundary condition:\n$$\nu'(0) = 0\n$$\n\n**3. Solve the Boundary Value Problem:**\nWe solve the complete boundary value problem:\n$$\n\\begin{cases}\nu''(x) = -2, & x \\in (0, L) \\\\\nu'(0) = 0 \\\\\nu(L) = 0\n\\end{cases}\n$$\nIntegrating the differential equation twice:\nFirst, integrating $u''(x) = -2$ with respect to $x$ gives:\n$$\nu'(x) = -2x + C_1\n$$\nApplying the boundary condition at $x=0$:\n$$\nu'(0) = -2(0) + C_1 = 0 \\implies C_1 = 0\n$$\nThis gives the first derivative: $u'(x) = -2x$.\n\nSecond, integrating $u'(x) = -2x$ with respect to $x$ gives:\n$$\nu(x) = -x^2 + C_2\n$$\nApplying the boundary condition at $x=L$:\n$$\nu(L) = -L^2 + C_2 = 0 \\implies C_2 = L^2\n$$\nSubstituting the value of $C_2$ back, we obtain the final solution for the mean exit time:\n$$\nu(x) = L^2 - x^2\n$$\nThis is the closed-form analytic expression for the mean exit time as a function of the starting position $x$ and the length of the interval $L$.", "answer": "$$\\boxed{L^2 - x^2}$$", "id": "3065956"}]}