{"hands_on_practices": [{"introduction": "Understanding the relationship between Itô and Stratonovich integrals is fundamental, and the key lies in the drift correction term. This first exercise [@problem_id:3062252] guides you through the analytical derivation of this conversion term for a versatile class of diffusion coefficients of the form $\\sigma(x) = \\alpha x^p$. Mastering this calculation provides a solid foundation for correctly interpreting and manipulating stochastic differential equations regardless of the convention used.", "problem": "Consider a scalar Itô stochastic differential equation (SDE) driven by a standard Brownian motion $W_{t}$,\n$$\ndX_{t} = b(X_{t})\\,dt + \\sigma(X_{t})\\,dW_{t},\n$$\nwhere $b$ and $\\sigma$ are sufficiently smooth functions and $X_{t}$ takes values in $(0,\\infty)$. Assume $\\sigma(x) = \\alpha x^{p}$ with $\\alpha \\in \\mathbb{R}$ and $p \\in \\mathbb{R}$ constants. The Stratonovich stochastic integral is defined by midpoint Riemann sums and obeys the classical chain rule, while the Itô stochastic integral is defined by left-point Riemann sums and obeys Itô’s lemma with a second-order term arising from quadratic variation.\n\nStarting from these foundational definitions and facts, derive the drift correction that relates the Itô and Stratonovich formulations for this SDE, and then, for the specific diffusion coefficient $\\sigma(x) = \\alpha x^{p}$, compute the conversion term and express the Stratonovich drift $a(x)$ purely in terms of $b(x)$, $\\alpha$, and $p$.\n\nProvide your final result as exact symbolic expressions. Do not approximate or round. Your final answer must list, in order, the conversion term and the Stratonovich drift as a single row vector.", "solution": "The problem requires the derivation of the relationship between an Itô stochastic differential equation (SDE) and its corresponding Stratonovich form, and the calculation of the specific conversion term for a given diffusion coefficient.\n\nLet the Itô SDE be given by:\n$$\ndX_{t} = b(X_{t})\\,dt + \\sigma(X_{t})\\,dW_{t}\n$$\nHere, $b(X_t)$ is the Itô drift, $\\sigma(X_t)$ is the diffusion coefficient, and $dW_t$ represents the differential of a standard Wiener process (Brownian motion).\n\nThe corresponding Stratonovich SDE is written as:\n$$\ndX_{t} = a(X_{t})\\,dt + \\sigma(X_{t})\\circ dW_{t}\n$$\nIn this form, $a(X_t)$ is the Stratonovich drift, and the circle symbol $\\circ$ indicates the Stratonovich differential.\n\nThe fundamental relationship between the Itô stochastic integral and the Stratonovich stochastic integral for a process $\\sigma(X_t)$ is a foundational result in stochastic calculus. This relationship stems from the different conventions used for the evaluation point in the Riemann sums that define these integrals. The Itô integral uses the left endpoint, whereas the Stratonovich integral uses the midpoint. This difference leads to a correction term related to the quadratic covariation of the processes.\n\nThe conversion formula in differential form is:\n$$\n\\sigma(X_t) \\circ dW_t = \\sigma(X_t) \\, dW_t + \\frac{1}{2} [d\\sigma(X_t), dW_t]\n$$\nwhere $[d\\sigma(X_t), dW_t]$ is a shorthand for the quadratic covariation differential $d\\langle \\sigma(X), W \\rangle_t$. To evaluate this term, we first find the differential $d\\sigma(X_t)$ using Itô's lemma on the function $\\sigma(x)$ applied to the process $X_t$:\n$$\nd\\sigma(X_t) = \\sigma'(X_t) dX_t + \\frac{1}{2} \\sigma''(X_t) (dX_t)^2\n$$\nSubstituting $dX_t = b(X_t)\\,dt + \\sigma(X_t)\\,dW_t$ and using the multiplication rules $(dt)^2=0$, $dt \\cdot dW_t=0$, and $(dW_t)^2=dt$, we get:\n$$\nd\\sigma(X_t) = \\sigma'(X_t) (b(X_t)\\,dt + \\sigma(X_t)\\,dW_t) + \\frac{1}{2} \\sigma''(X_t) (\\sigma(X_t))^2 dt\n$$\nThe quadratic covariation $[d\\sigma(X_t), dW_t]$ is obtained by multiplying the $dW_t$ parts of the respective differentials and replacing $(dW_t)^2$ with $dt$:\n$$\n[d\\sigma(X_t), dW_t] = (\\sigma'(X_t) \\sigma(X_t) dW_t) \\cdot dW_t = \\sigma'(X_t) \\sigma(X_t) dt\n$$\nSubstituting this back into the conversion formula gives:\n$$\n\\sigma(X_t) \\circ dW_t = \\sigma(X_t) \\, dW_t + \\frac{1}{2} \\sigma'(X_t) \\sigma(X_t) dt\n$$\nThis is the precise relationship between the Itô and Stratonovich differentials.\n\nNow, we can express the Stratonovich SDE in terms of Itô differentials:\n$$\ndX_t = a(X_t) dt + \\left( \\sigma(X_t) dW_t + \\frac{1}{2} \\sigma'(X_t) \\sigma(X_t) dt \\right)\n$$\nCollecting the $dt$ terms, we get:\n$$\ndX_t = \\left( a(X_t) + \\frac{1}{2} \\sigma'(X_t) \\sigma(X_t) \\right) dt + \\sigma(X_t) dW_t\n$$\nThis is an Itô SDE. For this to be identical to the given Itô SDE, $dX_{t} = b(X_{t})\\,dt + \\sigma(X_{t})\\,dW_{t}$, the drift terms must be equal:\n$$\nb(X_t) = a(X_t) + \\frac{1}{2} \\sigma'(X_t) \\sigma(X_t)\n$$\nThe term $\\frac{1}{2} \\sigma'(X_t) \\sigma(X_t)$ is the drift correction, or conversion term, that is added to the Stratonovich drift to obtain the Itô drift.\n\nThe problem asks for this conversion term and the Stratonovich drift $a(x)$ for the specific case where $\\sigma(x) = \\alpha x^p$. We first compute the derivative of $\\sigma(x)$:\n$$\n\\sigma'(x) = \\frac{d}{dx}(\\alpha x^p) = \\alpha p x^{p-1}\n$$\nThe existence and continuity of this derivative is guaranteed for $x \\in (0, \\infty)$, which is the domain of $X_t$.\n\nNext, we compute the conversion term using this derivative:\n$$\n\\frac{1}{2} \\sigma'(x) \\sigma(x) = \\frac{1}{2} (\\alpha p x^{p-1}) (\\alpha x^p) = \\frac{1}{2} \\alpha^2 p x^{p-1+p} = \\frac{1}{2} \\alpha^2 p x^{2p-1}\n$$\nThis is the first required result.\n\nTo find the Stratonovich drift $a(x)$, we rearrange the relationship between the drift terms:\n$$\na(x) = b(x) - \\frac{1}{2} \\sigma'(x) \\sigma(x)\n$$\nSubstituting the calculated conversion term, we obtain the expression for $a(x)$:\n$$\na(x) = b(x) - \\frac{1}{2} \\alpha^2 p x^{2p-1}\n$$\nThis is the second required result.\n\nThe problem asks for the final answer to be a row vector containing the conversion term and the Stratonovich drift $a(x)$, in that order.\n\nThe conversion term is: $\\frac{1}{2} \\alpha^2 p x^{2p-1}$.\nThe Stratonovich drift is: $a(x) = b(x) - \\frac{1}{2} \\alpha^2 p x^{2p-1}$.", "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{1}{2} \\alpha^2 p x^{2p-1} & b(x) - \\frac{1}{2} \\alpha^2 p x^{2p-1} \\end{pmatrix}}\n$$", "id": "3062252"}, {"introduction": "The Itô-Stratonovich correction term might seem like a purely mathematical artifact, but it has a concrete origin in how we approximate stochastic processes. This practice [@problem_id:3062235] delves into the numerical perspective, asking you to compare the one-step behavior of an Itô-consistent scheme (Euler-Maruyama) and a Stratonovich-consistent scheme (Heun). By analyzing the expected difference, you will discover that the correction drift emerges naturally from the schemes' structures, offering a powerful intuition for this crucial concept.", "problem": "Consider the stochastic differential equation in the Itô sense,\n$$\n\\mathrm{d}X_{t} = \\mu(X_{t})\\,\\mathrm{d}t + \\sigma(X_{t})\\,\\mathrm{d}W_{t},\n$$\nwhere $W_{t}$ is a standard Wiener process and $\\sigma(x) = \\alpha x$ with $\\alpha \\in \\mathbb{R}$. Let a single time step of size $\\Delta t > 0$ be taken from a current state $x$ at time $t$, and let $\\Delta W$ denote the corresponding Wiener increment with $\\Delta W \\sim \\mathcal{N}(0,\\Delta t)$.\n\nDefine the Euler–Maruyama update\n$$\nX^{\\mathrm{EM}} = x + \\mu(x)\\,\\Delta t + \\sigma(x)\\,\\Delta W,\n$$\nand the stochastic Heun predictor–corrector update\n$$\nY = x + \\mu(x)\\,\\Delta t + \\sigma(x)\\,\\Delta W,\\quad\nX^{\\mathrm{Heun}} = x + \\frac{1}{2}\\big(\\mu(x) + \\mu(Y)\\big)\\,\\Delta t + \\frac{1}{2}\\big(\\sigma(x) + \\sigma(Y)\\big)\\,\\Delta W.\n$$\n\nStarting from the above definitions and the properties of Wiener increments $E[\\Delta W]=0$ and $E[(\\Delta W)^{2}] = \\Delta t$, derive the leading-order expression (in $\\Delta t$) for the conditional expectation\n$$\nE\\big[X^{\\mathrm{Heun}} - X^{\\mathrm{EM}} \\,\\big|\\, X_{t}=x\\big]\n$$\nas an analytic function of $x$, $\\alpha$, and $\\Delta t$. Express your final answer as a single closed-form expression. Then, interpret this leading-order difference in terms of the drift that arises when converting between the Itô and Stratonovich forms. No numerical evaluation is required, and no rounding is needed. Your final answer must be a single analytic expression.", "solution": "The problem asks for the leading-order expression for the conditional expectation $E\\big[X^{\\mathrm{Heun}} - X^{\\mathrm{EM}} \\,\\big|\\, X_{t}=x\\big]$. We are given the definitions of the Euler–Maruyama update, $X^{\\mathrm{EM}}$, and the stochastic Heun predictor-corrector update, $X^{\\mathrm{Heun}}$.\n\nFirst, we express the difference between the two updates.\nThe Euler–Maruyama update is given by:\n$$\nX^{\\mathrm{EM}} = x + \\mu(x)\\,\\Delta t + \\sigma(x)\\,\\Delta W\n$$\nThe stochastic Heun update is given by:\n$$\nX^{\\mathrm{Heun}} = x + \\frac{1}{2}\\big(\\mu(x) + \\mu(Y)\\big)\\,\\Delta t + \\frac{1}{2}\\big(\\sigma(x) + \\sigma(Y)\\big)\\,\\Delta W\n$$\nwhere the predictor $Y$ is defined as:\n$$\nY = x + \\mu(x)\\,\\Delta t + \\sigma(x)\\,\\Delta W\n$$\nThe difference $X^{\\mathrm{Heun}} - X^{\\mathrm{EM}}$ is:\n$$\nX^{\\mathrm{Heun}} - X^{\\mathrm{EM}} = \\left( x + \\frac{1}{2}\\mu(x)\\Delta t + \\frac{1}{2}\\mu(Y)\\Delta t + \\frac{1}{2}\\sigma(x)\\Delta W + \\frac{1}{2}\\sigma(Y)\\Delta W \\right) - \\left( x + \\mu(x)\\Delta t + \\sigma(x)\\Delta W \\right)\n$$\nSimplifying this expression, we obtain:\n$$\nX^{\\mathrm{Heun}} - X^{\\mathrm{EM}} = \\frac{1}{2}\\left( \\mu(Y) - \\mu(x) \\right)\\Delta t + \\frac{1}{2}\\left( \\sigma(Y) - \\sigma(x) \\right)\\Delta W\n$$\nNext, we take the conditional expectation of this difference, denoted as $E[\\cdot]$ for $E[\\cdot \\,|\\, X_{t}=x]$. Using the linearity of expectation:\n$$\nE\\left[X^{\\mathrm{Heun}} - X^{\\mathrm{EM}}\\right] = \\frac{1}{2} E\\left[\\mu(Y) - \\mu(x)\\right]\\Delta t + \\frac{1}{2} E\\left[\\left( \\sigma(Y) - \\sigma(x) \\right)\\Delta W\\right]\n$$\nTo evaluate the expectations, we perform a Taylor series expansion of the functions $\\mu(Y)$ and $\\sigma(Y)$ around the point $x$. Let's define the increment $\\delta Y = Y - x = \\mu(x)\\Delta t + \\sigma(x)\\Delta W$. The functions $\\mu$ and $\\sigma$ are assumed to be sufficiently smooth.\n\nThe Taylor expansion of $\\sigma(Y)$ around $x$ is:\n$$\n\\sigma(Y) = \\sigma(x + \\delta Y) = \\sigma(x) + \\sigma'(x)\\delta Y + \\frac{1}{2}\\sigma''(x)(\\delta Y)^2 + O\\left((\\delta Y)^3\\right)\n$$\nwhere $\\sigma'(x)$ and $\\sigma''(x)$ denote the first and second derivatives of $\\sigma$ with respect to its argument, evaluated at $x$.\n\nLet's analyze the second term of the expectation expression, $E\\left[\\left( \\sigma(Y) - \\sigma(x) \\right)\\Delta W\\right]$:\n$$\nE\\left[\\left( \\sigma(Y) - \\sigma(x) \\right)\\Delta W\\right] = E\\left[\\left(\\sigma'(x)\\delta Y + \\frac{1}{2}\\sigma''(x)(\\delta Y)^2 + \\dots\\right)\\Delta W\\right]\n$$\nSubstitute $\\delta Y = \\mu(x)\\Delta t + \\sigma(x)\\Delta W$:\n$$\nE\\left[\\left(\\sigma'(x)(\\mu(x)\\Delta t + \\sigma(x)\\Delta W) + \\frac{1}{2}\\sigma''(x)(\\mu(x)\\Delta t + \\sigma(x)\\Delta W)^2 + \\dots\\right)\\Delta W\\right]\n$$\nWe expand this and take the expectation of each term. The properties of the Wiener increment $\\Delta W$ are $E[\\Delta W]=0$, $E[(\\Delta W)^2]=\\Delta t$, and $E[(\\Delta W)^3]=0$.\nThe expectation of the first part of the expansion is:\n$$\nE\\left[\\sigma'(x)(\\mu(x)\\Delta t + \\sigma(x)\\Delta W)\\Delta W\\right] = E\\left[\\sigma'(x)\\mu(x)\\Delta t \\Delta W + \\sigma'(x)\\sigma(x)(\\Delta W)^2\\right]\n$$\n$$\n= \\sigma'(x)\\mu(x)\\Delta t E[\\Delta W] + \\sigma'(x)\\sigma(x)E[(\\Delta W)^2] = 0 + \\sigma'(x)\\sigma(x)\\Delta t = \\sigma(x)\\sigma'(x)\\Delta t\n$$\nThis term is of order $O(\\Delta t)$. Now consider the next term in the expansion:\n$$\nE\\left[\\frac{1}{2}\\sigma''(x)(\\mu(x)\\Delta t + \\sigma(x)\\Delta W)^2\\Delta W\\right] = \\frac{1}{2}\\sigma''(x)E\\left[\\left((\\mu(x))^2 (\\Delta t)^2 + 2\\mu(x)\\sigma(x)\\Delta t\\Delta W + (\\sigma(x))^2 (\\Delta W)^2\\right)\\Delta W\\right]\n$$\n$$\n= \\frac{1}{2}\\sigma''(x)\\left((\\mu(x))^2 (\\Delta t)^2 E[\\Delta W] + 2\\mu(x)\\sigma(x)\\Delta t E[(\\Delta W)^2] + (\\sigma(x))^2 E[(\\Delta W)^3]\\right)\n$$\n$$\n= \\frac{1}{2}\\sigma''(x)\\left(0 + 2\\mu(x)\\sigma(x)\\Delta t (\\Delta t) + 0\\right) = \\mu(x)\\sigma(x)\\sigma''(x)(\\Delta t)^2\n$$\nThis term is of order $O((\\Delta t)^2)$. All higher-order terms in the expansion will also contribute powers of $\\Delta t$ greater than or equal to $2$.\nThus, the leading-order contribution to $E\\left[(\\sigma(Y) - \\sigma(x))\\Delta W\\right]$ is $\\sigma(x)\\sigma'(x)\\Delta t$.\n\nNow, let's analyze the first term of the main expectation expression, $\\frac{1}{2} E\\left[\\mu(Y) - \\mu(x)\\right]\\Delta t$.\n$$\nE[\\mu(Y)-\\mu(x)] = E\\left[\\mu'(x)\\delta Y + \\frac{1}{2}\\mu''(x)(\\delta Y)^2 + \\dots\\right]\n$$\n$$\n= \\mu'(x)E[\\delta Y] + \\frac{1}{2}\\mu''(x)E[(\\delta Y)^2] + \\dots\n$$\nWe evaluate the expectations of $\\delta Y$ and $(\\delta Y)^2$:\n$$\nE[\\delta Y] = E[\\mu(x)\\Delta t + \\sigma(x)\\Delta W] = \\mu(x)\\Delta t\n$$\n$$\nE[(\\delta Y)^2] = E[(\\mu(x)\\Delta t + \\sigma(x)\\Delta W)^2] = E[(\\mu(x))^2(\\Delta t)^2 + 2\\mu(x)\\sigma(x)\\Delta t\\Delta W + (\\sigma(x))^2(\\Delta W)^2]\n$$\n$$\n= (\\mu(x))^2(\\Delta t)^2 + 0 + (\\sigma(x))^2\\Delta t = (\\sigma(x))^2\\Delta t + O((\\Delta t)^2)\n$$\nSubstituting these back, the leading-order term in $E[\\mu(Y)-\\mu(x)]$ is of order $O(\\Delta t)$.\nTherefore, the term $\\frac{1}{2} E\\left[\\mu(Y) - \\mu(x)\\right]\\Delta t$ is of order $O((\\Delta t)^2)$.\n\nCombining the analysis of both terms, the leading-order contribution to $E\\left[X^{\\mathrm{Heun}} - X^{\\mathrm{EM}}\\right]$ comes from $\\frac{1}{2}E\\left[(\\sigma(Y) - \\sigma(x))\\Delta W\\right]$.\n$$\nE\\left[X^{\\mathrm{Heun}} - X^{\\mathrm{EM}}\\right] = \\frac{1}{2} \\left(\\sigma(x)\\sigma'(x)\\Delta t\\right) + O((\\Delta t)^2)\n$$\nThe leading-order expression is $\\frac{1}{2}\\sigma(x)\\sigma'(x)\\Delta t$.\n\nThe problem specifies that $\\sigma(x) = \\alpha x$. The derivative is $\\sigma'(x) = \\alpha$. Substituting these into the leading-order expression gives:\n$$\n\\frac{1}{2}(\\alpha x)(\\alpha)\\Delta t = \\frac{1}{2}\\alpha^2 x \\Delta t\n$$\nThis is the required analytical expression.\n\nFor the interpretation, we relate this result to the conversion between Itô and Stratonovich SDEs. An Itô SDE\n$$\n\\mathrm{d}X_{t} = \\mu(X_{t})\\,\\mathrm{d}t + \\sigma(X_{t})\\,\\mathrm{d}W_{t}\n$$\nis equivalent to a Stratonovich SDE\n$$\n\\mathrm{d}X_{t} = \\left(\\mu(X_{t}) - \\frac{1}{2}\\sigma(X_{t})\\sigma'(X_{t})\\right)\\mathrm{d}t + \\sigma(X_{t}) \\circ \\mathrm{d}W_{t}\n$$\nThe term $\\frac{1}{2}\\sigma(X_t)\\sigma'(X_t)$ is the Itô-Stratonovich correction drift.\nThe Euler-Maruyama scheme is a numerical method for the Itô SDE. The expected one-step drift is $E[X^{\\mathrm{EM}}-x]=\\mu(x)\\Delta t$.\nThe stochastic Heun scheme is known to be a numerical method for the Stratonovich SDE. If the SDE is specified in Itô form (as it is here), the Heun method effectively solves the equivalent Stratonovich equation. This means it implicitly includes the correction drift. The expected one-step drift for the Heun scheme, from an Itô perspective, is $E[X^{\\mathrm{Heun}}-x] = (\\mu(x) + \\frac{1}{2}\\sigma(x)\\sigma'(x))\\Delta t + O((\\Delta t)^2)$.\nThe difference in the conditional expectations is therefore:\n$$\nE[X^{\\mathrm{Heun}} - X^{\\mathrm{EM}}] = E[X^{\\mathrm{Heun}}-x] - E[X^{\\mathrm{EM}}-x] + O((\\Delta t)^2) = \\frac{1}{2}\\sigma(x)\\sigma'(x)\\Delta t + O((\\Delta t)^2)\n$$\nThis confirms that the leading-order difference we calculated, $\\frac{1}{2}\\alpha^2 x\\Delta t$, is precisely the Itô-Stratonovich correction drift, $\\frac{1}{2}\\sigma(x)\\sigma'(x) = \\frac{1}{2}(\\alpha x)(\\alpha) = \\frac{1}{2}\\alpha^2 x$, multiplied by the time step $\\Delta t$.", "answer": "$$\n\\boxed{\\frac{1}{2}\\alpha^{2}x\\Delta t}\n$$", "id": "3062235"}, {"introduction": "After deriving the conversion formula and analyzing its roots in numerical methods, the final step is to witness the phenomenon empirically. This hands-on coding practice [@problem_id:3062203] challenges you to build simulators for both Itô and Stratonovich processes and directly measure the difference in their effective drift. By running simulations and analyzing the statistical results, you will provide computational evidence for the theoretical correction term, solidifying your understanding by connecting abstract theory with tangible data.", "problem": "Consider a one-dimensional stochastic differential equation driven by standard Brownian motion with scalar diffusion coefficient. Let $W_t$ denote a standard Brownian motion, and let $\\sigma(x)$ be a smooth scalar function. Two canonical interpretations of the stochastic integral with respect to $W_t$ are used in the literature: the Itô interpretation and the Stratonovich interpretation. The Itô integral is defined as the $L^2$-limit of left-point Riemann sums, while the Stratonovich integral is defined as a limit of symmetric Riemann sums (e.g., midpoint evaluations). In discrete-time approximations over a time grid $t_n = n \\Delta t$ with independent Gaussian increments $\\Delta W_n \\sim \\mathcal{N}(0,\\Delta t)$, these interpretations correspond to distinct update rules.\n\nStarting from the definitions:\n- The Itô integral $\\int_0^T \\sigma(X_t)\\,\\mathrm{d}W_t$ is the mean-square limit of left-point sums, i.e., sums of the form $\\sum_n \\sigma(X_{t_n}) \\Delta W_n$.\n- The Stratonovich integral $\\int_0^T \\sigma(X_t) \\circ \\mathrm{d}W_t$ is the mean-square limit of symmetric sums, e.g., midpoint approximations $\\sum_n \\sigma\\!\\left(\\frac{X_{t_n} + X_{t_{n+1}}}{2}\\right) \\Delta W_n$.\n\nYour task is to empirically verify the scalar Itô–Stratonovich conversion by simulation, without using any pre-stated conversion formula. Specifically, for the driftless stochastic differential equation\n$$\n\\mathrm{d}X_t = \\sigma(X_t)\\,\\mathrm{d}W_t,\n$$\nperform the following steps:\n- Implement the Itô Euler–Maruyama update on the grid $t_n$:\n$$\nX_{n+1}^{\\mathrm{Ito}} = X_n^{\\mathrm{Ito}} + \\sigma\\!\\left(X_n^{\\mathrm{Ito}}\\right)\\,\\Delta W_n.\n$$\n- Implement a Stratonovich-consistent midpoint (Heun) update on the same grid:\n$$\nX_{n+1}^{\\mathrm{Strat}} = X_n^{\\mathrm{Strat}} + \\frac{1}{2}\\left[\\sigma\\!\\left(X_n^{\\mathrm{Strat}}\\right) + \\sigma\\!\\left(X_n^{\\mathrm{Strat}} + \\sigma\\!\\left(X_n^{\\mathrm{Strat}}\\right)\\,\\Delta W_n\\right)\\right]\\Delta W_n.\n$$\n- For each scheme, define the empirical per-time-step drift as the average increment divided by $\\Delta t$ over all paths and all steps:\n$$\n\\hat{\\mu}_{\\mathrm{Ito}} = \\frac{1}{N_{\\text{paths}}\\,N_{\\text{steps}}\\,\\Delta t}\\sum_{p=1}^{N_{\\text{paths}}}\\sum_{n=0}^{N_{\\text{steps}}-1}\\left(X_{n+1}^{\\mathrm{Ito},(p)} - X_n^{\\mathrm{Ito},(p)}\\right),\n$$\n$$\n\\hat{\\mu}_{\\mathrm{Strat}} = \\frac{1}{N_{\\text{paths}}\\,N_{\\text{steps}}\\,\\Delta t}\\sum_{p=1}^{N_{\\text{paths}}}\\sum_{n=0}^{N_{\\text{steps}}-1}\\left(X_{n+1}^{\\mathrm{Strat},(p)} - X_n^{\\mathrm{Strat},(p)}\\right).\n$$\n- Estimate the empirical drift difference\n$$\nD_{\\mathrm{emp}} = \\hat{\\mu}_{\\mathrm{Strat}} - \\hat{\\mu}_{\\mathrm{Ito}}.\n$$\n\nUse the same Brownian increments $\\Delta W_n$ for both schemes per path to reduce variance. Set the drift $a(x)$ to be identically zero so that any nonzero empirical drift arises solely from the interpretation of the stochastic integral. Use a fixed random number generator seed for reproducibility.\n\nImplement the simulation in a vectorized manner wherever possible. For each test case below, simulate $N_{\\text{paths}}$ independent paths, each evolved over $N_{\\text{steps}}$ time steps with $\\Delta W_n \\sim \\mathcal{N}(0,\\Delta t)$.\n\nTest suite:\n- Case $1$ (happy path, linear diffusion):\n    - $\\sigma(x) = \\lambda x$, with $\\lambda = 0.7$.\n    - Initial state $X_0 = 1.0$.\n    - Total time $T = 1.0$.\n    - Time step $\\Delta t = 0.001$.\n    - Number of paths $N_{\\text{paths}} = 4096$.\n    - Seed $= 12346$.\n\n- Case $2$ (boundary case, constant diffusion):\n    - $\\sigma(x) = c$, with $c = 1.5$.\n    - Initial state $X_0 = 0.5$.\n    - Total time $T = 1.0$.\n    - Time step $\\Delta t = 0.001$.\n    - Number of paths $N_{\\text{paths}} = 4096$.\n    - Seed $= 12347$.\n\n- Case $3$ (nonlinear diffusion):\n    - $\\sigma(x) = \\gamma + \\beta \\sin(x)$, with $\\gamma = 0.5$, $\\beta = 0.6$.\n    - Initial state $X_0 = 0.3$.\n    - Total time $T = 1.0$.\n    - Time step $\\Delta t = 0.001$.\n    - Number of paths $N_{\\text{paths}} = 4096$.\n    - Seed $= 12348$.\n\nProgram requirements:\n- Implement both discrete schemes exactly as above.\n- Use the specified seeds for the random number generator.\n- Use the same $\\Delta W_n$ increments for the Itô and Stratonovich updates within each path and time step.\n- For each test case, compute $D_{\\mathrm{emp}}$ and round it to $6$ decimal places.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. For the three test cases, output\n$$\n\\left[D_{\\mathrm{emp}}^{(1)},D_{\\mathrm{emp}}^{(2)},D_{\\mathrm{emp}}^{(3)}\\right],\n$$\nrounded to $6$ decimal places, e.g., $\\left[0.123456,0.000000,0.012345\\right]$.", "solution": "The problem requires an empirical verification of the Itô–Stratonovich conversion formula for a scalar stochastic differential equation (SDE). This involves simulating the same SDE using two different numerical schemes, one consistent with the Itô integral and the other with the Stratonovich integral, and then comparing the average behaviors of the resulting paths.\n\nA general one-dimensional Itô SDE is written as:\n$$\n\\mathrm{d}X_t = a(X_t)\\,\\mathrm{d}t + \\sigma(X_t)\\,\\mathrm{d}W_t\n$$\nwhere $a(X_t)$ is the drift coefficient, $\\sigma(X_t)$ is the diffusion coefficient, and $\\mathrm{d}W_t$ represents the increment of a standard Wiener process. The stochastic integral $\\int \\sigma(X_t)\\,\\mathrm{d}W_t$ is interpreted in the Itô sense.\n\nThe same physical process can be described using the Stratonovich interpretation, written with the symbol $\\circ$:\n$$\n\\mathrm{d}X_t = \\alpha(X_t)\\,\\mathrm{d}t + \\sigma(X_t) \\circ \\mathrm{d}W_t\n$$\nThe Stratonovich integral behaves more like a standard Riemann–Stieltjes integral and follows the ordinary rules of calculus (e.g., the chain rule has no extra terms). However, for a process with the same diffusion coefficient $\\sigma(X_t)$, the Itô and Stratonovich SDEs are not equivalent unless they have different drift terms. The relationship between them is given by the Itô–Stratonovich conversion formula. A Stratonovich SDE with diffusion $\\sigma(X_t)$ is equivalent to an Itô SDE with an additional drift term, often called the correction or spurious drift:\n$$\n\\sigma(X_t) \\circ \\mathrm{d}W_t = \\frac{1}{2}\\sigma(X_t)\\sigma'(X_t)\\,\\mathrm{d}t + \\sigma(X_t)\\,\\mathrm{d}W_t\n$$\nwhere $\\sigma'(x) = \\frac{\\mathrm{d}\\sigma}{\\mathrm{d}x}$.\n\nIn this problem, we start with a driftless Itô SDE:\n$$\n\\mathrm{d}X_t = \\sigma(X_t)\\,\\mathrm{d}W_t\n$$\nThe Euler–Maruyama scheme is the most direct numerical discretization of an Itô SDE:\n$$\nX_{n+1}^{\\mathrm{Ito}} = X_n^{\\mathrm{Ito}} + \\sigma(X_n^{\\mathrm{Ito}})\\,\\Delta W_n\n$$\nAs a proper Itô integrator, its increments have an expected drift of zero, conditioned on the current state: $\\mathbb{E}[X_{n+1}^{\\mathrm{Ito}} - X_n^{\\mathrm{Ito}} | X_n^{\\mathrm{Ito}}] = \\mathbb{E}[\\sigma(X_n^{\\mathrm{Ito}})\\,\\Delta W_n] = \\sigma(X_n^{\\mathrm{Ito}})\\mathbb{E}[\\Delta W_n] = 0$. We therefore expect the empirical drift $\\hat{\\mu}_{\\mathrm{Ito}}$ to be close to $0$.\n\nThe problem provides a midpoint-like scheme for the Stratonovich interpretation:\n$$\nX_{n+1}^{\\mathrm{Strat}} = X_n^{\\mathrm{Strat}} + \\frac{1}{2}\\left[\\sigma(X_n^{\\mathrm{Strat}}) + \\sigma\\left(X_n^{\\mathrm{Strat}} + \\sigma(X_n^{\\mathrm{Strat}})\\,\\Delta W_n\\right)\\right]\\Delta W_n\n$$\nThis scheme is designed to be consistent with the Stratonovich SDE $\\mathrm{d}X_t = \\sigma(X_t) \\circ \\mathrm{d}W_t$. Consequently, its dynamics are equivalent to the Itô SDE $\\mathrm{d}X_t = \\frac{1}{2}\\sigma(X_t)\\sigma'(X_t)\\,\\mathrm{d}t + \\sigma(X_t)\\,\\mathrm{d}W_t$. The conditional expectation of its increment correctly captures the correction drift: $\\mathbb{E}[X_{n+1}^{\\mathrm{Strat}} - X_n^{\\mathrm{Strat}} | X_n^{\\mathrm{Strat}}] \\approx \\frac{1}{2}\\sigma(X_n^{\\mathrm{Strat}})\\sigma'(X_n^{\\mathrm{Strat}})\\,\\Delta t$. Thus, its empirical drift $\\hat{\\mu}_{\\mathrm{Strat}}$ should provide an estimate of the average value of this correction drift over the simulated paths.\n\nThe task is to compute the empirical drift difference $D_{\\mathrm{emp}} = \\hat{\\mu}_{\\mathrm{Strat}} - \\hat{\\mu}_{\\mathrm{Ito}}$. Based on the reasoning above, this quantity serves as a numerical estimate of the average correction drift:\n$$\nD_{\\mathrm{emp}} \\approx \\mathbb{E}\\left[\\frac{1}{2}\\sigma(X_t)\\sigma'(X_t)\\right]\n$$\nThe empirical drift $\\hat{\\mu}$ for a given scheme is defined as:\n$$\n\\hat{\\mu} = \\frac{1}{N_{\\text{paths}}\\,N_{\\text{steps}}\\,\\Delta t}\\sum_{p=1}^{N_{\\text{paths}}}\\sum_{n=0}^{N_{\\text{steps}}-1}\\left(X_{n+1}^{(p)} - X_n^{(p)}\\right)\n$$\nThe inner sum is a telescoping series, $\\sum_{n=0}^{N_{\\text{steps}}-1}(X_{n+1}^{(p)} - X_n^{(p)}) = X_{N_{\\text{steps}}}^{(p)} - X_0^{(p)}$. Since the total time $T = N_{\\text{steps}}\\,\\Delta t$, the formula simplifies to:\n$$\n\\hat{\\mu} = \\frac{1}{N_{\\text{paths}}\\,T}\\sum_{p=1}^{N_{\\text{paths}}}\\left(X_T^{(p)} - X_0\\right)\n$$\nThe difference $D_{\\mathrm{emp}}$ can then be calculated efficiently from the final states of the simulations:\n$$\nD_{\\mathrm{emp}} = \\hat{\\mu}_{\\mathrm{Strat}} - \\hat{\\mu}_{\\mathrm{Ito}} = \\frac{1}{N_{\\text{paths}}\\,T}\\sum_{p=1}^{N_{\\text{paths}}}\\left(X_T^{\\mathrm{Strat},(p)} - X_T^{\\mathrm{Ito},(p)}\\right) = \\frac{1}{T}\\mathbb{E}_{\\text{paths}}[X_T^{\\mathrm{Strat}} - X_T^{\\mathrm{Ito}}]\n$$\nThe solution algorithm is as follows:\n1.  For each test case, define the parameters ($X_0, T, \\Delta t, N_{\\text{paths}}$, seed) and the diffusion function $\\sigma(x)$.\n2.  Set the random number generator seed for reproducibility.\n3.  Pre-generate all necessary Wiener increments $\\Delta W_n \\sim \\mathcal{N}(0,\\Delta t)$ for all paths and time steps in a vectorized manner. The shape of this array will be $(N_{\\text{paths}}, N_{\\text{steps}})$, where $N_{\\text{steps}} = T/\\Delta t$.\n4.  Initialize two state vectors, $X^{\\mathrm{Ito}}$ and $X^{\\mathrm{Strat}}$, both of size $N_{\\text{paths}}$, with the initial value $X_0$.\n5.  Iterate through the time steps from $n=0$ to $N_{\\text{steps}}-1$. In each step:\n    a. Use the same Wiener increments $\\Delta W_n$ for all paths and for both update schemes.\n    b. Update the $X^{\\mathrm{Ito}}$ vector according to the Euler–Maruyama rule.\n    c. Update the $X^{\\mathrm{Strat}}$ vector according to the Stratonovich midpoint rule.\n6.  After the loop completes, calculate the mean difference between the final states of the two schemes: $\\mathbb{E}_{\\text{paths}}[X_T^{\\mathrm{Strat}} - X_T^{\\mathrm{Ito}}]$.\n7.  Divide this mean difference by the total time $T$ to obtain $D_{\\mathrm{emp}}$.\n8.  Round the result to $6$ decimal places as required.\n\nThis procedure is applied to each of the three test cases specified. For Case 2, where $\\sigma(x)=c$ is a constant, $\\sigma'(x)=0$. The correction drift is zero, and the Itô and Stratonovich integrators become identical. Therefore, we expect $D_{\\mathrm{emp}}$ to be exactly $0$. For the other cases, a non-zero value is expected.", "answer": "```python\nimport numpy as np\n\ndef _run_simulation(x0, T, dt, N_paths, seed, sigma_func):\n    \"\"\"\n    Runs a parallel simulation for Itô and Stratonovich schemes.\n\n    Args:\n        x0 (float): Initial state.\n        T (float): Total simulation time.\n        dt (float): Time step.\n        N_paths (int): Number of parallel paths to simulate.\n        seed (int): Seed for the random number generator.\n        sigma_func (callable): The diffusion function sigma(x).\n\n    Returns:\n        float: The empirical drift difference D_emp.\n    \"\"\"\n    N_steps = int(T / dt)\n    rng = np.random.default_rng(seed)\n\n    # Generate all Brownian increments at once for vectorization\n    # Shape: (N_paths, N_steps)\n    dW = rng.normal(loc=0.0, scale=np.sqrt(dt), size=(N_paths, N_steps))\n\n    # Initialize state vectors for both schemes\n    x_ito = np.full(N_paths, x0, dtype=float)\n    x_strat = np.full(N_paths, x0, dtype=float)\n\n    # Main time-stepping loop, vectorized over all paths\n    for n in range(N_steps):\n        dw_n = dW[:, n]\n\n        # Itô Euler–Maruyama update\n        sigma_val_ito = sigma_func(x_ito)\n        x_ito += sigma_val_ito * dw_n\n\n        # Stratonovich midpoint (Heun) update\n        sigma_val_strat = sigma_func(x_strat)\n        x_predictor = x_strat + sigma_val_strat * dw_n\n        sigma_val_predictor = sigma_func(x_predictor)\n        x_strat += 0.5 * (sigma_val_strat + sigma_val_predictor) * dw_n\n    \n    # Calculate D_emp using the simplified formula derived from the definition.\n    # D_emp = E[X_T_strat - X_T_ito] / T\n    d_emp = np.mean(x_strat - x_ito) / T\n    \n    return d_emp\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for the given test cases.\n    \"\"\"\n    test_cases = [\n        # Case 1 (linear diffusion)\n        {\n            \"sigma\": lambda p: (lambda x: p[\"lambda_\"] * x),\n            \"params\": {\"lambda_\": 0.7},\n            \"config\": {\"x0\": 1.0, \"T\": 1.0, \"dt\": 0.001, \"N_paths\": 4096, \"seed\": 12346}\n        },\n        # Case 2 (constant diffusion)\n        {\n            \"sigma\": lambda p: (lambda x: np.full_like(x, p[\"c\"])),\n            \"params\": {\"c\": 1.5},\n            \"config\": {\"x0\": 0.5, \"T\": 1.0, \"dt\": 0.001, \"N_paths\": 4096, \"seed\": 12347}\n        },\n        # Case 3 (nonlinear diffusion)\n        {\n            \"sigma\": lambda p: (lambda x: p[\"gamma\"] + p[\"beta\"] * np.sin(x)),\n            \"params\": {\"gamma\": 0.5, \"beta\": 0.6},\n            \"config\": {\"x0\": 0.3, \"T\": 1.0, \"dt\": 0.001, \"N_paths\": 4096, \"seed\": 12348}\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        config = case[\"config\"]\n        params = case[\"params\"]\n        \n        # Create the sigma function with its parameters bound\n        sigma_func = case[\"sigma\"](params)\n        \n        d_emp = _run_simulation(\n            x0=config[\"x0\"],\n            T=config[\"T\"],\n            dt=config[\"dt\"],\n            N_paths=config[\"N_paths\"],\n            seed=config[\"seed\"],\n            sigma_func=sigma_func\n        )\n        \n        results.append(round(d_emp, 6))\n\n    # Format the final output as a comma-separated list in brackets.\n    # The format specifier ensures that the rounding is preserved in the output string.\n    print(f\"[{','.join(f'{r:.6f}' for r in results)}]\")\n\nsolve()\n```", "id": "3062203"}]}