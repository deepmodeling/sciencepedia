{"hands_on_practices": [{"introduction": "A key feature of asset prices modeled by Geometric Brownian Motion is their log-normal distribution, which is skewed to the right. This means the average price (mean) is typically higher than the median price, the level at which the asset has a 50% chance of being above or below. This exercise guides you through calculating the median, providing a more robust measure of central tendency for risk assessment than the mean alone. [@problem_id:1304952]", "problem": "A financial analyst is modeling the price evolution of a stock using a standard model from quantitative finance. The model, known as Geometric Brownian Motion (GBM), describes the stock price $S_t$ at any time $t \\ge 0$. The price at a future time $T$ is given by the formula:\n$$S_T = S_0 \\exp\\left( \\left(\\mu - \\frac{\\sigma^2}{2}\\right)T + \\sigma W_T \\right)$$\nHere, $S_0$ is the known initial price of the stock at time $t=0$. The parameters $\\mu$ and $\\sigma$ are positive constants representing the stock's expected annual rate of return (drift) and its annual volatility, respectively. The term $W_T$ represents a random variable drawn from a normal distribution with a mean of 0 and a variance of $T$.\n\nThe analyst is interested in risk management and wants to determine the *median* price of the stock at time $T$. The median is the price level for which the stock has an equal probability of being above or below it.\n\nFind a closed-form analytic expression for the median of the stock price $S_T$ in terms of $S_0$, $\\mu$, $\\sigma$, and $T$.", "solution": "We are given the GBM solution for the stock price at time $T$:\n$$S_{T} = S_{0}\\exp\\left(\\left(\\mu - \\frac{\\sigma^{2}}{2}\\right)T + \\sigma W_{T}\\right),$$\nwhere $W_{T}$ is normally distributed with mean $0$ and variance $T$. Define $Y = \\ln S_{T}$. Then\n$$Y = \\ln S_{0} + \\left(\\mu - \\frac{\\sigma^{2}}{2}\\right)T + \\sigma W_{T}.$$\nSince $W_{T} \\sim \\mathcal{N}(0,T)$, we may write $W_{T} = \\sqrt{T}\\,Z$ with $Z \\sim \\mathcal{N}(0,1)$. Hence $Y$ is normally distributed with mean and variance\n$$m = \\ln S_{0} + \\left(\\mu - \\frac{\\sigma^{2}}{2}\\right)T, \\qquad v = \\sigma^{2}T.$$\nThe median $m_{S}$ of $S_{T}$ is defined by $\\mathbb{P}(S_{T} \\le m_{S}) = \\frac{1}{2}$. This is equivalent to\n$$\\mathbb{P}(Y \\le \\ln m_{S}) = \\frac{1}{2}.$$\nStandardizing $Y$ gives\n$$\\mathbb{P}\\!\\left(\\frac{Y - m}{\\sigma\\sqrt{T}} \\le \\frac{\\ln m_{S} - m}{\\sigma\\sqrt{T}}\\right) = \\frac{1}{2}.$$\nSince $\\frac{Y - m}{\\sigma\\sqrt{T}} \\sim \\mathcal{N}(0,1)$, its cumulative distribution function at $0$ equals $\\frac{1}{2}$. Therefore, the unique value achieving the median is when the standardized threshold equals $0$, i.e.,\n$$\\frac{\\ln m_{S} - m}{\\sigma\\sqrt{T}} = 0 \\quad \\Rightarrow \\quad \\ln m_{S} = m.$$\nExponentiating both sides yields\n$$m_{S} = \\exp(m) = \\exp\\!\\left(\\ln S_{0} + \\left(\\mu - \\frac{\\sigma^{2}}{2}\\right)T\\right) = S_{0}\\exp\\!\\left(\\left(\\mu - \\frac{\\sigma^{2}}{2}\\right)T\\right).$$\nThus, the closed-form expression for the median of $S_{T}$ is $S_{0}\\exp\\!\\left(\\left(\\mu - \\frac{\\sigma^{2}}{2}\\right)T\\right)$.", "answer": "$$\\boxed{S_{0}\\exp\\left(\\left(\\mu - \\frac{\\sigma^{2}}{2}\\right)T\\right)}$$", "id": "1304952"}, {"introduction": "One of the most powerful tools in stochastic calculus is Itô's lemma, which allows us to find the dynamics of a function of a stochastic process. In this practice, you will apply Itô's lemma to a process $Y_t = (S_t)^k$, where $S_t$ follows a Geometric Brownian Motion. This exercise is fundamental for understanding how new stochastic processes are derived and for appreciating the closure property that makes GBM so versatile in modeling. [@problem_id:1304922]", "problem": "In financial mathematics, a common model for the price $S_t$ of a non-dividend-paying stock is the Geometric Brownian Motion (GBM), whose dynamics are described by the stochastic differential equation (SDE):\n$$dS_t = \\mu S_t dt + \\sigma S_t dW_t$$\nHere, $\\mu$ is the constant expected rate of return (drift), $\\sigma$ is the constant volatility, and $W_t$ is a standard Wiener process.\n\nConsider a derivative security whose value at time $t$ is given by the process $Y_t = (S_t)^k$, where $k$ is a non-zero real constant. This represents a leveraged position or a fractional claim on the underlying asset. It can be shown that the process $Y_t$ also follows a Geometric Brownian Motion, with an SDE of the form:\n$$dY_t = \\mu_Y Y_t dt + \\sigma_Y Y_t dW_t$$\nYour task is to determine the new drift coefficient $\\mu_Y$ and the new volatility coefficient $\\sigma_Y$ for the process $Y_t$.\n\nExpress your answer as a row matrix containing the expressions for $\\mu_Y$ and $\\sigma_Y$ in that order, in terms of $\\mu$, $\\sigma$, and $k$.", "solution": "We are given that $S_{t}$ follows the stochastic differential equation of a Geometric Brownian Motion:\n$$\ndS_{t}=\\mu S_{t}\\,dt+\\sigma S_{t}\\,dW_{t}.\n$$\nDefine $Y_{t}=f(S_{t})$ with $f(s)=s^{k}$ where $k\\neq 0$. By It\\^o's lemma for a twice continuously differentiable function $f$,\n$$\ndY_{t}=f'(S_{t})\\,dS_{t}+\\frac{1}{2}f''(S_{t})\\,(dS_{t})^{2},\n$$\nusing the stochastic calculus identities $(dW_{t})^{2}=dt$, $dt\\,dW_{t}=0$, and $(dt)^{2}=0$.\n\nCompute the derivatives:\n$$\nf'(s)=k s^{k-1},\\qquad f''(s)=k(k-1)s^{k-2}.\n$$\nCompute $(dS_{t})^{2}$ from the given SDE:\n$$\n(dS_{t})^{2}=(\\mu S_{t}\\,dt+\\sigma S_{t}\\,dW_{t})^{2}=(\\sigma S_{t}\\,dW_{t})^{2}=\\sigma^{2}S_{t}^{2}\\,dt.\n$$\nSubstitute into It\\^o's formula:\n\\begin{align*}\ndY_{t}\n=k S_{t}^{k-1}(\\mu S_{t}\\,dt+\\sigma S_{t}\\,dW_{t})+\\frac{1}{2}k(k-1)S_{t}^{k-2}\\left(\\sigma^{2}S_{t}^{2}\\,dt\\right)\\\\\n=k\\mu S_{t}^{k}\\,dt+k\\sigma S_{t}^{k}\\,dW_{t}+\\frac{1}{2}k(k-1)\\sigma^{2}S_{t}^{k}\\,dt\\\\\n=\\left(k\\mu+\\frac{1}{2}k(k-1)\\sigma^{2}\\right)S_{t}^{k}\\,dt+k\\sigma S_{t}^{k}\\,dW_{t}.\n\\end{align*}\nSince $Y_{t}=S_{t}^{k}$, we can write\n$$\ndY_{t}=\\mu_{Y}Y_{t}\\,dt+\\sigma_{Y}Y_{t}\\,dW_{t},\n$$\nwith the coefficients identified as\n$$\n\\mu_{Y}=k\\mu+\\frac{1}{2}k(k-1)\\sigma^{2},\\qquad \\sigma_{Y}=k\\sigma.\n$$\nThus, expressed as a row matrix in the order $(\\mu_{Y},\\sigma_{Y})$, the result is\n$$\n\\begin{pmatrix}\nk\\mu+\\frac{1}{2}k(k-1)\\sigma^{2}  k\\sigma\n\\end{pmatrix}.\n$$", "answer": "$$\\boxed{\\begin{pmatrix}k\\mu+\\frac{1}{2}k(k-1)\\sigma^{2}  k\\sigma\\end{pmatrix}}$$", "id": "1304922"}, {"introduction": "Theoretical models come to life through simulation, a cornerstone of quantitative finance for pricing derivatives and assessing risk. This capstone exercise bridges the gap between the abstract stochastic differential equation and a concrete numerical algorithm. You will derive the exact simulation scheme for GBM, calculate its key statistical moments, and then implement and validate your findings through code, solidifying your understanding from theory to practice. [@problem_id:3056767]", "problem": "Consider a standard Brownian motion $W_t$ and a geometric Brownian motion $S_t$ defined as the unique strong solution to the stochastic differential equation (SDE) $dS_t = \\mu S_t \\, dt + \\sigma S_t \\, dW_t$, where $\\mu \\in \\mathbb{R}$ and $\\sigma \\ge 0$ are constants. Starting from core definitions and the Itô formula, derive an exact one-step simulation scheme that produces $S_{t+\\Delta}$ from a given $S_t$ for a fixed step size $\\Delta  0$. Your derivation must transform the SDE into a form amenable to integration, justify the distributional form of the increment, and prove that the resulting scheme preserves strict positivity of $S_{t+\\Delta}$ whenever $S_t  0$. Using the same derivation, obtain the analytic expressions for the first two moments $E[S_{t+\\Delta} \\mid S_t]$ and $\\operatorname{Var}(S_{t+\\Delta} \\mid S_t)$, expressed explicitly in terms of $S_t$, $\\mu$, $\\sigma$, and $\\Delta$.\n\nThen, write a complete, runnable program that implements the exact one-step simulation scheme you derived and empirically validates its correctness on a test suite. For each test case, generate $M$ independent samples of $S_{t+\\Delta}$ conditional on $S_t$, compute the sample mean and sample variance, and compare them to the analytic mean and variance from your derivation. Also verify that all simulated values satisfy strict positivity. Use a fixed random seed $42$ for reproducibility and set the number of samples to $M = 200000$.\n\nFor the comparison, use the following tolerances:\n- For the sample mean, require the relative error to be at most $10^{-3}$.\n- For the sample variance, require the relative error to be at most $2 \\times 10^{-2}$.\n- In any case where the analytic variance equals $0$, require the absolute error of the sample variance to be at most $10^{-10}$.\n\nYour program should produce a single line of output containing a list of Boolean values, one per test case, where each Boolean is $true$ if and only if: (i) the mean comparison passes within tolerance, (ii) the variance comparison passes within tolerance, and (iii) all simulated values are strictly positive. The final output must be a single line in the exact format specified at the end of this problem.\n\nTest suite parameter values:\n- Case $1$: $S_t = 100$, $\\mu = 0.05$, $\\sigma = 0.2$, $\\Delta = 0.25$.\n- Case $2$: $S_t = 100$, $\\mu = 0.0$, $\\sigma = 0.2$, $\\Delta = 0.0$.\n- Case $3$: $S_t = 80$, $\\mu = 0.03$, $\\sigma = 0.0$, $\\Delta = 2.0$.\n- Case $4$: $S_t = 120$, $\\mu = -0.1$, $\\sigma = 0.3$, $\\Delta = 0.5$.\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, for example $[result_1, result_2, result_3, result_4]$, where each $result_i$ is a Boolean value corresponding to Case $i$ in the order listed above.", "solution": "The problem requires the derivation of an exact one-step simulation scheme for a geometric Brownian motion (GBM), a proof of its positivity property, and the derivation of its first two conditional moments. Subsequently, an implementation must be provided to validate these theoretical results against an empirical simulation.\n\nThe stochastic differential equation (SDE) for a geometric Brownian motion $S_t$ is given as:\n$$ dS_t = \\mu S_t \\, dt + \\sigma S_t \\, dW_t $$\nwhere $\\mu \\in \\mathbb{R}$ is the constant drift, $\\sigma \\ge 0$ is the constant volatility, and $W_t$ is a standard Brownian motion.\n\nTo derive the exact simulation scheme, we first transform the process $S_t$ to simplify the SDE. Let's define a new process $X_t = f(S_t)$, where $f(x) = \\ln(x)$. The goal is to find an SDE for $X_t$ using Itô's formula. The partial derivatives of $f(x)$ with respect to its arguments (time $t$ and state $x$) are:\n$$ \\frac{\\partial f}{\\partial t} = 0, \\quad \\frac{\\partial f}{\\partial x} = \\frac{1}{x}, \\quad \\frac{\\partial^2 f}{\\partial x^2} = -\\frac{1}{x^2} $$\nItô's formula for $dX_t = df(t, S_t)$ is:\n$$ dX_t = \\frac{\\partial f}{\\partial t} dt + \\frac{\\partial f}{\\partial S_t} dS_t + \\frac{1}{2} \\frac{\\partial^2 f}{\\partial S_t^2} (dS_t)^2 $$\nThe quadratic variation term $(dS_t)^2$ is computed using Itô's multiplication rules, where $(dW_t)^2 = dt$, $dt \\, dW_t = 0$, and $(dt)^2 = 0$:\n$$ (dS_t)^2 = (\\mu S_t \\, dt + \\sigma S_t \\, dW_t)^2 = (\\sigma S_t)^2 (dW_t)^2 = \\sigma^2 S_t^2 \\, dt $$\nSubstituting the derivatives and $(dS_t)^2$ into the formula for $dX_t$:\n$$ dX_t = (0) \\cdot dt + \\frac{1}{S_t} (\\mu S_t \\, dt + \\sigma S_t \\, dW_t) + \\frac{1}{2} \\left(-\\frac{1}{S_t^2}\\right) (\\sigma^2 S_t^2 \\, dt) $$\nSimplifying the terms, we get:\n$$ dX_t = (\\mu \\, dt + \\sigma \\, dW_t) - \\frac{1}{2} \\sigma^2 \\, dt $$\n$$ dX_t = \\left(\\mu - \\frac{\\sigma^2}{2}\\right) dt + \\sigma \\, dW_t $$\nThis SDE for $X_t$ is a generalized Wiener process with constant drift and diffusion coefficients, which can be integrated directly. Integrating from time $t$ to $t+\\Delta$:\n$$ \\int_t^{t+\\Delta} dX_s = \\int_t^{t+\\Delta} \\left(\\mu - \\frac{\\sigma^2}{2}\\right) ds + \\int_t^{t+\\Delta} \\sigma \\, dW_s $$\n$$ X_{t+\\Delta} - X_t = \\left(\\mu - \\frac{\\sigma^2}{2}\\right) \\Delta + \\sigma (W_{t+\\Delta} - W_t) $$\nThe increment of a standard Brownian motion, $W_{t+\\Delta} - W_t$, is a normally distributed random variable with mean $0$ and variance $\\Delta$. We can write this increment as $\\sqrt{\\Delta}Z$, where $Z \\sim \\mathcal{N}(0, 1)$ is a standard normal random variable.\nSubstituting $X_t = \\ln(S_t)$ back into the equation:\n$$ \\ln(S_{t+\\Delta}) - \\ln(S_t) = \\left(\\mu - \\frac{\\sigma^2}{2}\\right) \\Delta + \\sigma \\sqrt{\\Delta} Z $$\n$$ \\ln(S_{t+\\Delta}) = \\ln(S_t) + \\left(\\mu - \\frac{\\sigma^2}{2}\\right) \\Delta + \\sigma \\sqrt{\\Delta} Z $$\nExponentiating both sides yields the exact one-step simulation scheme for $S_t$:\n$$ S_{t+\\Delta} = S_t \\exp\\left( \\left(\\mu - \\frac{\\sigma^2}{2}\\right) \\Delta + \\sigma \\sqrt{\\Delta} Z \\right) $$\n\nTo prove the strict positivity of $S_{t+\\Delta}$ given $S_t  0$, we observe that the argument of the exponential function, $\\left(\\mu - \\frac{\\sigma^2}{2}\\right) \\Delta + \\sigma \\sqrt{\\Delta} Z$, is a real-valued random variable. The exponential function $\\exp(x)$ is strictly positive for any real argument $x$. Therefore, the term $\\exp(\\dots)$ is always greater than $0$. Since $S_t  0$ by assumption, the product $S_{t+\\Delta} = S_t \\cdot (\\text{a positive quantity})$ must also be strictly positive.\n\nNext, we derive the analytic expressions for the first two conditional moments, $E[S_{t+\\Delta} \\mid S_t]$ and $\\operatorname{Var}(S_{t+\\Delta} \\mid S_t)$.\nFrom the solution, $S_{t+\\Delta}$ is the product of $S_t$ (which is known at time $t$) and a log-normal random variable. Let the random variable in the exponent be $Y = \\left(\\mu - \\frac{\\sigma^2}{2}\\right) \\Delta + \\sigma \\sqrt{\\Delta} Z$. Since $Z \\sim \\mathcal{N}(0, 1)$, $Y$ is normally distributed. Its conditional mean and variance are:\n$$ m \\equiv E[Y \\mid \\mathcal{F}_t] = \\left(\\mu - \\frac{\\sigma^2}{2}\\right) \\Delta + \\sigma \\sqrt{\\Delta} E[Z] = \\left(\\mu - \\frac{\\sigma^2}{2}\\right) \\Delta $$\n$$ s^2 \\equiv \\operatorname{Var}(Y \\mid \\mathcal{F}_t) = \\operatorname{Var}\\left(\\sigma \\sqrt{\\Delta} Z\\right) = (\\sigma \\sqrt{\\Delta})^2 \\operatorname{Var}(Z) = \\sigma^2 \\Delta $$\nSo, $Y \\sim \\mathcal{N}(m, s^2)$. We have $S_{t+\\Delta} = S_t e^Y$. We use the moment generating function property for a normal variable: if $Y \\sim \\mathcal{N}(m, s^2)$, then $E[e^{kY}] = \\exp(km + \\frac{1}{2}k^2s^2)$.\n\nThe conditional mean of $S_{t+\\Delta}$ is:\n$$ E[S_{t+\\Delta} \\mid S_t] = E[S_t e^Y \\mid S_t] = S_t E[e^Y] $$\nUsing the property with $k=1$:\n$$ E[e^Y] = \\exp\\left(m + \\frac{s^2}{2}\\right) = \\exp\\left( \\left(\\mu - \\frac{\\sigma^2}{2}\\right) \\Delta + \\frac{\\sigma^2 \\Delta}{2} \\right) = \\exp(\\mu\\Delta) $$\nThus, the conditional mean is:\n$$ E[S_{t+\\Delta} \\mid S_t] = S_t e^{\\mu \\Delta} $$\n\nThe conditional variance of $S_{t+\\Delta}$ is $\\operatorname{Var}(S_{t+\\Delta} \\mid S_t) = E[S_{t+\\Delta}^2 \\mid S_t] - (E[S_{t+\\Delta} \\mid S_t])^2$.\nFirst, let's find the second moment $E[S_{t+\\Delta}^2 \\mid S_t]$:\n$$ E[S_{t+\\Delta}^2 \\mid S_t] = E[(S_t e^Y)^2 \\mid S_t] = S_t^2 E[e^{2Y}] $$\nUsing the property with $k=2$:\n$$ E[e^{2Y}] = \\exp\\left(2m + \\frac{1}{2}(2^2)s^2\\right) = \\exp(2m + 2s^2) $$\n$$ E[e^{2Y}] = \\exp\\left( 2\\left(\\mu - \\frac{\\sigma^2}{2}\\right)\\Delta + 2\\sigma^2\\Delta \\right) = \\exp(2\\mu\\Delta - \\sigma^2\\Delta + 2\\sigma^2\\Delta) = \\exp(2\\mu\\Delta + \\sigma^2\\Delta) $$\nSo, $E[S_{t+\\Delta}^2 \\mid S_t] = S_t^2 e^{2mu\\Delta + \\sigma^2\\Delta}$.\nNow, we compute the variance:\n$$ \\operatorname{Var}(S_{t+\\Delta} \\mid S_t) = S_t^2 e^{2\\mu\\Delta + \\sigma^2\\Delta} - (S_t e^{\\mu\\Delta})^2 $$\n$$ \\operatorname{Var}(S_{t+\\Delta} \\mid S_t) = S_t^2 e^{2\\mu\\Delta} e^{\\sigma^2\\Delta} - S_t^2 e^{2\\mu\\Delta} = S_t^2 e^{2\\mu\\Delta} (e^{\\sigma^2\\Delta} - 1) $$\nThis completes the required derivations. The implementation will use these formulae to perform the validation.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Implements the exact one-step simulation of Geometric Brownian Motion,\n    and validates sample moments against analytic moments for given test cases.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (S_t, mu, sigma, delta)\n        (100, 0.05, 0.2, 0.25),\n        (100, 0.0, 0.2, 0.0),\n        (80, 0.03, 0.0, 2.0),\n        (120, -0.1, 0.3, 0.5),\n    ]\n\n    # Simulation parameters\n    M = 200000\n    SEED = 42\n    \n    # Validation tolerances\n    MEAN_REL_TOL = 1e-3\n    VAR_REL_TOL = 2e-2\n    VAR_ABS_TOL = 1e-10\n\n    # Initialize a random number generator for reproducibility\n    rng = np.random.default_rng(seed=SEED)\n\n    results = []\n    for case in test_cases:\n        S_t, mu, sigma, delta = case\n\n        # 1. Calculate analytic moments\n        # E[S_{t+d}] = S_t * exp(mu*d)\n        analytic_mean = S_t * np.exp(mu * delta)\n        # Var(S_{t+d}) = S_t^2 * exp(2*mu*d) * (exp(sigma^2*d) - 1)\n        analytic_var = S_t**2 * np.exp(2 * mu * delta) * (np.exp(sigma**2 * delta) - 1)\n\n        # 2. Perform the exact simulation\n        # Generate M standard normal random variables\n        Z = rng.standard_normal(size=M)\n        \n        # Apply the exact one-step simulation formula:\n        # S_{t+d} = S_t * exp( (mu - 0.5*sigma^2)*d + sigma*sqrt(d)*Z )\n        # Using np.sqrt with a non-negative scalar `delta` is safe.\n        exponent = (mu - 0.5 * sigma**2) * delta + sigma * np.sqrt(delta) * Z\n        S_tp_delta_samples = S_t * np.exp(exponent)\n\n        # 3. Validate the simulation results\n        # (i) Positivity check\n        positivity_check = np.all(S_tp_delta_samples > 0)\n        \n        # Calculate sample moments\n        sample_mean = np.mean(S_tp_delta_samples)\n        # Use ddof=1 for unbiased sample variance estimator\n        sample_var = np.var(S_tp_delta_samples, ddof=1) if M > 1 else 0\n\n        # (ii) Mean comparison\n        # Since S_t > 0 and exp() > 0, analytic_mean is always positive.\n        mean_rel_error = np.abs(sample_mean - analytic_mean) / np.abs(analytic_mean)\n        mean_check = mean_rel_error = MEAN_REL_TOL\n        \n        # (iii) Variance comparison\n        if np.isclose(analytic_var, 0):\n            # Use absolute error for cases where variance is theoretically zero\n            # This happens if sigma = 0 or delta = 0\n            var_abs_error = np.abs(sample_var - analytic_var)\n            var_check = var_abs_error = VAR_ABS_TOL\n        else:\n            # Use relative error for non-zero variance\n            var_rel_error = np.abs(sample_var - analytic_var) / analytic_var\n            var_check = var_rel_error = VAR_REL_TOL\n\n        # Combine all checks to get the final boolean result for the case\n        case_is_valid = positivity_check and mean_check and var_check\n        results.append(case_is_valid)\n\n    # Final print statement in the exact required format (lowercase booleans)\n    formatted_results = [str(res).lower() for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "3056767"}]}