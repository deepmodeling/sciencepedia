{"hands_on_practices": [{"introduction": "A fundamental aspect of understanding any stochastic process is characterizing its long-term behavior. For the Cox-Ingersoll-Ross (CIR) process, this equilibrium state is described by a stationary probability distribution, which is a cornerstone of its application in finance as a model for interest rates. This practice challenges you to derive this distribution from first principles by applying the condition of detailed balance to the Fokker-Planck equation, revealing the process's tendency to revert to a stable statistical profile over time [@problem_id:3047712].", "problem": "Consider the Cox–Ingersoll–Ross (CIR) stochastic differential equation (SDE)\n$$\n\\mathrm{d}X_{t} \\;=\\; \\kappa\\bigl(\\theta - X_{t}\\bigr)\\,\\mathrm{d}t \\;+\\; \\sigma\\,\\sqrt{X_{t}}\\,\\mathrm{d}W_{t},\n$$\nwhere $X_{t} \\in (0,\\infty)$, $\\kappa0$, $\\theta0$, $\\sigma0$, and $W_{t}$ is a standard Wiener process. Assume the Feller condition $2\\,\\kappa\\,\\theta\\sigma^{2}$ so that the boundary at $x=0$ is nonattainable and the process remains strictly positive.\n\nStarting from the Kolmogorov forward (Fokker–Planck) equation for the time-dependent probability density $p(x,t)$ and invoking detailed balance (vanishing stationary probability current), derive the stationary density $p^{\\ast}(x)$ on $(0,\\infty)$. Identify this density as a Gamma distribution by determining its shape and rate parameters explicitly in terms of $\\kappa$, $\\theta$, and $\\sigma$. Provide your final answer as a single closed-form analytic expression for $p^{\\ast}(x)$ on $x0$.", "solution": "The problem statement is deemed valid as it is scientifically grounded, well-posed, and objective. It represents a standard problem in the theory of stochastic processes.\n\nThe Cox–Ingersoll–Ross (CIR) process is described by the stochastic differential equation (SDE):\n$$\n\\mathrm{d}X_{t} \\;=\\; \\kappa(\\theta - X_{t})\\,\\mathrm{d}t \\;+\\; \\sigma\\sqrt{X_{t}}\\,\\mathrm{d}W_{t}\n$$\nThis is a one-dimensional Itô process of the general form $\\mathrm{d}X_t = A(X_t)\\,\\mathrm{d}t + B(X_t)\\,\\mathrm{d}W_t$. By comparison, we identify the drift coefficient $A(x)$ and the diffusion coefficient $B(x)$:\n$$\nA(x) = \\kappa(\\theta - x)\n$$\n$$\nB(x) = \\sigma\\sqrt{x}\n$$\nThe evolution of the probability density function $p(x,t)$ of the process $X_t$ is governed by the Kolmogorov forward equation, also known as the Fokker–Planck equation:\n$$\n\\frac{\\partial p(x,t)}{\\partial t} = -\\frac{\\partial}{\\partial x} \\left[ A(x) p(x,t) \\right] + \\frac{1}{2}\\frac{\\partial^2}{\\partial x^2} \\left[ B(x)^2 p(x,t) \\right]\n$$\nSubstituting the specific forms of $A(x)$ and $B(x)^2 = \\sigma^2 x$ for the CIR process, we get:\n$$\n\\frac{\\partial p(x,t)}{\\partial t} = -\\frac{\\partial}{\\partial x} \\left[ \\kappa(\\theta - x) p(x,t) \\right] + \\frac{1}{2}\\frac{\\partial^2}{\\partial x^2} \\left[ \\sigma^2 x p(x,t) \\right]\n$$\nThis equation can be expressed as a continuity equation, $\\frac{\\partial p}{\\partial t} = -\\frac{\\partial J}{\\partial x}$, where $J(x,t)$ is the probability current:\n$$\nJ(x,t) = A(x) p(x,t) - \\frac{1}{2}\\frac{\\partial}{\\partial x} \\left[B(x)^2 p(x,t)\\right] = \\kappa(\\theta - x) p(x,t) - \\frac{\\sigma^2}{2}\\frac{\\partial}{\\partial x} \\left[x p(x,t)\\right]\n$$\nTo find the stationary density $p^*(x)$, we set the time derivative to zero, $\\frac{\\partial p}{\\partial t} = 0$. This implies that the stationary probability current, $J^*(x)$, must be constant with respect to $x$. The problem specifies to invoke detailed balance, which corresponds to the condition that the stationary probability current vanishes everywhere, i.e., $J^*(x) = 0$. This condition is appropriate for a process on $(0, \\infty)$ with a nonattainable (reflecting) boundary at $x=0$, as ensured by the Feller condition $2\\kappa\\theta  \\sigma^2$. Setting the stationary current to zero gives the following ordinary differential equation for $p^*(x)$:\n$$\n\\kappa(\\theta - x) p^*(x) - \\frac{\\sigma^2}{2}\\frac{\\mathrm{d}}{\\mathrm{d}x} \\left[x p^*(x)\\right] = 0\n$$\nWe can rearrange this equation to solve for $p^*(x)$:\n$$\n\\frac{\\sigma^2}{2}\\frac{\\mathrm{d}}{\\mathrm{d}x} \\left[x p^*(x)\\right] = \\kappa(\\theta - x) p^*(x)\n$$\nApplying the product rule to the left-hand side:\n$$\n\\frac{\\sigma^2}{2}\\left(p^*(x) + x\\frac{\\mathrm{d}p^*(x)}{\\mathrm{d}x}\\right) = \\kappa(\\theta - x)p^*(x)\n$$\nWe can separate variables to solve this first-order linear ODE. Rearranging terms to isolate $\\frac{\\mathrm{d}p^*(x)}{\\mathrm{d}x}$:\n$$\n\\frac{\\sigma^2}{2} x \\frac{\\mathrm{d}p^*(x)}{\\mathrm{d}x} = \\left(\\kappa(\\theta - x) - \\frac{\\sigma^2}{2}\\right)p^*(x) = \\left(\\kappa\\theta - \\frac{\\sigma^2}{2} - \\kappa x\\right)p^*(x)\n$$\n$$\n\\frac{1}{p^*(x)}\\frac{\\mathrm{d}p^*(x)}{\\mathrm{d}x} = \\frac{1}{x} \\frac{2}{\\sigma^2} \\left(\\kappa\\theta - \\frac{\\sigma^2}{2} - \\kappa x\\right) = \\frac{2\\kappa\\theta - \\sigma^2}{\\sigma^2 x} - \\frac{2\\kappa}{\\sigma^2}\n$$\nIntegrating both sides with respect to $x$:\n$$\n\\int \\frac{\\mathrm{d}p^*(x)}{p^*(x)} = \\int \\left(\\frac{2\\kappa\\theta/\\sigma^2 - 1}{x} - \\frac{2\\kappa}{\\sigma^2}\\right)\\mathrm{d}x\n$$\n$$\n\\ln(p^*(x)) = \\left(\\frac{2\\kappa\\theta}{\\sigma^2} - 1\\right)\\ln(x) - \\frac{2\\kappa}{\\sigma^2}x + C'\n$$\nwhere $C'$ is the constant of integration. Exponentiating both sides gives the unnormalized density:\n$$\np^*(x) = \\exp(C') \\exp\\left(\\left(\\frac{2\\kappa\\theta}{\\sigma^2} - 1\\right)\\ln(x)\\right) \\exp\\left(-\\frac{2\\kappa}{\\sigma^2}x\\right)\n$$\n$$\np^*(x) = C x^{\\frac{2\\kappa\\theta}{\\sigma^2} - 1} \\exp\\left(-\\frac{2\\kappa}{\\sigma^2}x\\right)\n$$\nwhere $C = \\exp(C')$ is a normalization constant. This functional form is that of a Gamma distribution. The probability density function of a Gamma distribution with shape parameter $\\alpha$ and rate parameter $\\beta$ is given by:\n$$\nf(x; \\alpha, \\beta) = \\frac{\\beta^\\alpha}{\\Gamma(\\alpha)} x^{\\alpha-1} \\exp(-\\beta x)\n$$\nBy comparing our expression for $p^*(x)$ with the canonical form of the Gamma PDF, we can identify the shape and rate parameters:\nShape parameter:\n$$\n\\alpha - 1 = \\frac{2\\kappa\\theta}{\\sigma^2} - 1 \\quad \\implies \\quad \\alpha = \\frac{2\\kappa\\theta}{\\sigma^2}\n$$\nRate parameter:\n$$\n\\beta = \\frac{2\\kappa}{\\sigma^2}\n$$\nThe parameters $\\kappa$, $\\theta$, and $\\sigma$ are all positive, ensuring that $\\alpha  0$ and $\\beta  0$. The given Feller condition $2\\kappa\\theta  \\sigma^2$ ensures that $\\alpha  1$.\nThe normalization constant $C$ is therefore:\n$$\nC = \\frac{\\beta^\\alpha}{\\Gamma(\\alpha)} = \\frac{\\left(\\frac{2\\kappa}{\\sigma^2}\\right)^{\\frac{2\\kappa\\theta}{\\sigma^2}}}{\\Gamma\\left(\\frac{2\\kappa\\theta}{\\sigma^2}\\right)}\n$$\nSubstituting this constant back into our expression for $p^*(x)$, we obtain the final normalized stationary probability density:\n$$\np^*(x) = \\frac{\\left(\\frac{2\\kappa}{\\sigma^2}\\right)^{\\frac{2\\kappa\\theta}{\\sigma^2}}}{\\Gamma\\left(\\frac{2\\kappa\\theta}{\\sigma^2}\\right)} x^{\\frac{2\\kappa\\theta}{\\sigma^2} - 1} \\exp\\left(-\\frac{2\\kappa}{\\sigma^2}x\\right)\n$$\nThis is the stationary density for the CIR process on the domain $x \\in (0, \\infty)$.", "answer": "$$\n\\boxed{\\frac{\\left(\\frac{2\\kappa}{\\sigma^2}\\right)^{\\frac{2\\kappa\\theta}{\\sigma^2}}}{\\Gamma\\left(\\frac{2\\kappa\\theta}{\\sigma^2}\\right)} x^{\\frac{2\\kappa\\theta}{\\sigma^2} - 1} \\exp\\left(-\\frac{2\\kappa}{\\sigma^2}x\\right)}\n$$", "id": "3047712"}, {"introduction": "While the theoretical CIR process is guaranteed to be non-negative, simulating its path on a computer introduces new challenges. The widely-used Euler-Maruyama discretization method can produce non-physical negative values, which would crash a simulation that relies on taking the square root of the process value. This hands-on exercise requires you to derive the probability of such a failure in a single step and implement a check, providing a crucial lesson on the limitations of naive numerical approximations [@problem_id:3047714].", "problem": "Consider the Cox–Ingersoll–Ross (CIR) stochastic differential equation (SDE) given by $dX_t = \\kappa(\\theta - X_t)\\,dt + \\sigma \\sqrt{X_t}\\,dW_t$ with initial value $X_0 \\ge 0$, where $\\kappa  0$, $\\theta  0$, $\\sigma \\ge 0$, and $W_t$ is a standard Brownian motion. The exact solution of this SDE is known to be strictly positive under the Feller condition $2\\kappa\\theta \\ge \\sigma^2$ when $X_0  0$. However, numerical time discretizations such as the Euler–Maruyama method do not inherit this positivity in general.\n\nTask: Starting from the definition of the Euler–Maruyama scheme applied to an Itô SDE and the fact that Brownian increments over a time step of length $h$ are normally distributed with mean $0$ and variance $h$, derive from first principles an expression for the probability that a single Euler–Maruyama update of the CIR SDE starting from a given nonnegative state $x \\ge 0$ yields a negative next value. Your derivation must express this probability in terms of $\\kappa$, $\\theta$, $\\sigma$, $x$, and $h$, using only standard properties of the normal distribution. Then, implement a program that, for each parameter set in the test suite below, computes this one-step negativity probability and returns it as a floating-point number rounded to six decimal places.\n\nYou must treat any degenerate cases correctly. In particular, if the diffusion coefficient at the current state is zero so that the noise term disappears in the Euler–Maruyama update (for example, when $\\sigma = 0$ or $x = 0$), then the one-step update is deterministic; in this situation, the probability should be either $0$ or $1$ depending on the sign of the deterministic update.\n\nUse the following test suite. Each test case is a tuple $(\\kappa,\\theta,\\sigma,x,h)$:\n- Test case $1$: $(4.0, 0.04, 0.5, 0.04, 0.25)$.\n- Test case $2$: $(1.2, 0.05, 0.3, 0.0, 0.1)$.\n- Test case $3$: $(0.3, 0.02, 0.4, 0.02, 0.5)$.\n- Test case $4$: $(10.0, 0.01, 0.0, 0.03, 0.2)$.\n\nDesign for coverage:\n- Test case $1$ satisfies the Feller condition $2\\kappa\\theta \\ge \\sigma^2$ with $x  0$, illustrating that even then the Euler–Maruyama method can assign a positive probability to a negative next step.\n- Test case $2$ starts at $x = 0$, where the diffusion term vanishes and the one-step scheme is deterministic in the first step.\n- Test case $3$ violates the Feller condition and has $x  0$ with a relatively large time step $h$, illustrating a larger probability of crossing below zero.\n- Test case $4$ has $\\sigma = 0$ and a large time step $h$ chosen so that the deterministic Euler step becomes negative, yielding probability $1$ of negativity despite $x \\ge 0$.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the same order as the test suite and with each probability rounded to six decimal places (for example, $[0.123456,0.000000,0.654321,1.000000]$).", "solution": "The problem requires the derivation of the one-step negativity probability for the Euler–Maruyama discretization of the Cox-Ingersoll-Ross (CIR) process.\n\nThe CIR process is described by the stochastic differential equation (SDE):\n$$\ndX_t = \\kappa(\\theta - X_t)\\,dt + \\sigma \\sqrt{X_t}\\,dW_t\n$$\nwhere $X_t$ is the state of the process at time $t$, $W_t$ is a standard Brownian motion, and the parameters $\\kappa$, $\\theta$, and $\\sigma$ are constants satisfying $\\kappa  0$, $\\theta  0$, and $\\sigma \\ge 0$. The process starts from a non-negative initial value $X_0 \\ge 0$.\n\nThe Euler-Maruyama numerical scheme is used to approximate the solution of an SDE by discretizing time into steps of length $h$. For a general Itô SDE $dY_t = a(Y_t, t)\\,dt + b(Y_t, t)\\,dW_t$, the scheme is given by:\n$$\nY_{n+1} = Y_n + a(Y_n, t_n)h + b(Y_n, t_n)\\Delta W_n\n$$\nwhere $Y_n = Y_{t_n}$, $t_{n+1} = t_n + h$, and $\\Delta W_n = W_{t_{n+1}} - W_{t_n}$ is the increment of the Brownian motion over the time step. A fundamental property of Brownian motion is that its increments are normally distributed, specifically $\\Delta W_n \\sim N(0, h)$.\n\nFor the CIR process, the drift and diffusion coefficients are $a(x) = \\kappa(\\theta - x)$ and $b(x) = \\sigma \\sqrt{x}$, respectively. Let the current state of the process be $X_n = x$, where $x \\ge 0$. Applying the Euler-Maruyama scheme, the next state $X_{n+1}$ is:\n$$\nX_{n+1} = x + \\kappa(\\theta - x)h + \\sigma \\sqrt{x} \\Delta W_n\n$$\nWe need to find the probability that this next state is negative, i.e., $P(X_{n+1}  0)$.\n\nThe Brownian increment $\\Delta W_n$ can be expressed as $\\sqrt{h}Z$, where $Z$ is a standard normal random variable, $Z \\sim N(0, 1)$. Substituting this into the equation for $X_{n+1}$ gives:\n$$\nX_{n+1} = x + \\kappa(\\theta - x)h + \\sigma \\sqrt{x} \\sqrt{h} Z\n$$\nWe want to calculate the probability $P(X_{n+1}  0)$, which translates to:\n$$\nP(x + \\kappa(\\theta - x)h + \\sigma \\sqrt{x} \\sqrt{h} Z  0)\n$$\nTo solve this, we must analyze two distinct cases based on the value of the diffusion term's coefficient.\n\n**Case 1: Non-degenerate diffusion ($\\sigma  0$ and $x  0$)**\nIn this case, the coefficient of the random variable $Z$, which is $\\sigma \\sqrt{x} \\sqrt{h}$, is strictly positive. We can rearrange the inequality to isolate $Z$:\n$$\n\\sigma \\sqrt{x} \\sqrt{h} Z  - (x + \\kappa(\\theta - x)h)\n$$\n$$\nZ  - \\frac{x + \\kappa(\\theta - x)h}{\\sigma \\sqrt{x} \\sqrt{h}}\n$$\nSince $Z$ is a standard normal random variable, the probability $P(Z  c)$ for some constant $c$ is given by the cumulative distribution function (CDF) of the standard normal distribution, denoted by $\\Phi(c)$. Therefore, the probability of $X_{n+1}$ being negative is:\n$$\nP(X_{n+1}  0) = \\Phi\\left(- \\frac{x + \\kappa(\\theta - x)h}{\\sigma \\sqrt{x} \\sqrt{h}}\\right)\n$$\nThis expression gives the probability in terms of the model parameters, the current state, and the time step, using a standard property of the normal distribution as required.\n\n**Case 2: Degenerate diffusion ($\\sigma = 0$ or $x = 0$)**\nIn this situation, the stochastic term $\\sigma \\sqrt{x} \\sqrt{h}Z$ vanishes, and the update becomes deterministic.\n$$\nX_{n+1} = x + \\kappa(\\theta - x)h\n$$\nThe value of $X_{n+1}$ is fixed, so the probability of it being negative is either $0$ or $1$.\n\nSubcase 2a: $x = 0$.\nThe update equation simplifies to:\n$$\nX_{n+1} = 0 + \\kappa(\\theta - 0)h = \\kappa\\theta h\n$$\nGiven the constraints $\\kappa  0$, $\\theta  0$, and the nature of a time step $h  0$, the result $\\kappa\\theta h$ is strictly positive. Thus, $X_{n+1}  0$. The probability of the next state being negative is zero.\n$$\nP(X_{n+1}  0 \\mid x=0) = 0\n$$\n\nSubcase 2b: $\\sigma = 0$ (and $x \\ge 0$).\nThe SDE becomes an ordinary differential equation, $dX_t = \\kappa(\\theta - X_t)dt$, and the Euler update is:\n$$\nX_{n+1} = x + \\kappa(\\theta - x)h\n$$\nThe probability of a negative step depends on the sign of this deterministic value:\n$$\nP(X_{n+1}  0 \\mid \\sigma=0) = \\begin{cases} 1  \\text{if } x + \\kappa(\\theta - x)h  0 \\\\ 0  \\text{if } x + \\kappa(\\theta - x)h \\ge 0 \\end{cases}\n$$\n\nIn summary, the probability $P_{neg} = P(X_{n+1}  0 \\mid X_n = x)$ is calculated as follows:\n1.  If $\\sigma = 0$ or $x = 0$:\n    - The update is deterministic: $X_{next} = x + \\kappa(\\theta - x)h$.\n    - $P_{neg} = 1$ if $X_{next}  0$.\n    - $P_{neg} = 0$ if $X_{next} \\ge 0$. (Note: as shown, if $x=0$, $X_{next}  0$, so $P_{neg}=0$)\n2.  If $\\sigma  0$ and $x  0$:\n    - The probability is given by the CDF of the standard normal distribution:\n    $$\n    P_{neg} = \\Phi\\left(- \\frac{x + \\kappa(\\theta - x)h}{\\sigma \\sqrt{x} \\sqrt{h}}\\right)\n    $$\nThis formulation provides a complete method for calculating the one-step negativity probability for any valid set of parameters.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.stats import norm\n\ndef solve():\n    \"\"\"\n    Calculates the one-step negativity probability for the Euler-Maruyama\n    discretization of the Cox-Ingersoll-Ross (CIR) process for several\n    test cases.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (kappa, theta, sigma, x, h)\n    test_cases = [\n        (4.0, 0.04, 0.5, 0.04, 0.25),  # Feller condition satisfied\n        (1.2, 0.05, 0.3, 0.0, 0.1),   # Starts at x=0 (degenerate case)\n        (0.3, 0.02, 0.4, 0.02, 0.5),   # Feller condition violated\n        (10.0, 0.01, 0.0, 0.03, 0.2),  # sigma=0 (degenerate case)\n    ]\n\n    string_results = []\n    for case in test_cases:\n        kappa, theta, sigma, x, h = case\n        \n        prob = 0.0\n\n        # Case 1: Degenerate diffusion term (sigma=0 or x=0)\n        # The update is deterministic.\n        if sigma == 0.0 or x == 0.0:\n            # Deterministic update: X_{n+1} = x + kappa * (theta - x) * h\n            next_val = x + kappa * (theta - x) * h\n            if next_val  0:\n                prob = 1.0\n            else:\n                prob = 0.0\n        \n        # Case 2: Non-degenerate diffusion term (sigma  0 and x  0)\n        # The update is stochastic.\n        else:\n            # Argument for the standard normal CDF\n            # C = - (x + kappa*(theta - x)*h) / (sigma * sqrt(x*h))\n            numerator = x + kappa * (theta - x) * h\n            denominator = sigma * np.sqrt(x * h)\n            \n            # The problem of division by zero in the denominator is already\n            # handled by the check for x=0.\n            cdf_arg = -numerator / denominator\n            \n            # The probability is the CDF of the standard normal distribution.\n            prob = norm.cdf(cdf_arg)\n            \n        string_results.append(f\"{prob:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(string_results)}]\")\n\nsolve()\n```", "id": "3047714"}, {"introduction": "Having established that simple numerical schemes can fail to preserve the non-negativity of the CIR process, we now turn to a practical solution. The Full Truncation Euler method is an explicit scheme designed specifically to prevent the process from taking negative values during simulation by projecting the updated value onto the non-negative domain. This exercise asks you to identify the correct formulation of this scheme and understand the mechanism by which it guarantees a non-negative path, a critical skill for implementing reliable financial or scientific models [@problem_id:3047718].", "problem": "Consider the Cox-Ingersoll-Ross process, defined as the solution to the Stochastic Differential Equation (SDE)\n$$\ndX_t = \\kappa\\big(\\theta - X_t\\big)\\,dt + \\sigma \\sqrt{X_t}\\,dW_t,\\qquad X_0\\ge 0,\n$$\nwhere $\\kappa0$, $\\theta\\ge 0$, and $\\sigma0$ are constants, and $(W_t)_{t\\ge 0}$ is a standard Brownian motion. It is known that the exact solution is nonnegative, and under the Feller condition $2\\kappa\\theta\\ge \\sigma^2$ it is strictly positive. In explicit numerical simulation, however, naive approximations can take negative values, which is problematic because the diffusion coefficient uses $\\sqrt{X_t}$. \n\nYou are asked to identify the correct description of the Full Truncation Euler (FTE) discretization used to approximate the Cox-Ingersoll-Ross process on a uniform grid $t_n = n\\,\\Delta t$, with independent Gaussian increments $\\Delta W_n = W_{t_{n+1}} - W_{t_n}\\sim\\mathcal{N}(0,\\Delta t)$. In particular, select the statement that both correctly specifies the scheme and correctly explains in what sense nonnegativity is preserved by the numerical approximation.\n\nWhich option is correct?\n\nA. Define $x^+ = \\max(x,0)$. The scheme is: compute a provisional update\n$$\n\\widetilde{X}_{n+1} = X_n + \\kappa\\big(\\theta - X_n^+\\big)\\,\\Delta t + \\sigma \\sqrt{X_n^+}\\,\\Delta W_n,\n$$\nand then project onto the nonnegative axis by setting\n$$\nX_{n+1} = \\max\\big(\\widetilde{X}_{n+1},\\,0\\big).\n$$\nThis preserves nonnegativity of the numerical approximation because the projection ensures $X_{n+1}\\ge 0$ for all $n$, and the use of $X_n^+$ in the coefficients guarantees the square root is always evaluated at a nonnegative value.\n\nB. The scheme uses truncation only in the diffusion: \n$$\nX_{n+1} = X_n + \\kappa\\big(\\theta - X_n\\big)\\,\\Delta t + \\sigma \\sqrt{X_n^+}\\,\\Delta W_n.\n$$\nThis preserves nonnegativity whenever $2\\kappa\\theta\\ge \\sigma^2$, because the Feller condition ensures positivity of the exact process and therefore of the discrete approximation for any time step $\\Delta t0$.\n\nC. The scheme is implicit:\n$$\nX_{n+1} = X_n + \\kappa\\big(\\theta - X_{n+1}\\big)\\,\\Delta t + \\sigma \\sqrt{X_{n+1}}\\,\\Delta W_n,\n$$\nand “full truncation” means solving this nonlinear equation exactly at each step. Nonnegativity is preserved because the square root is evaluated at $X_{n+1}$, forcing $X_{n+1}\\ge 0$.\n\nD. The scheme reflects negative values by absolute value:\n$$\nX_{n+1} = \\big|\\,X_n + \\kappa(\\theta - X_n)\\,\\Delta t + \\sigma \\sqrt{X_n}\\,\\Delta W_n\\,\\big|.\n$$\nThis preserves nonnegativity because any negative update is flipped to positive, and the square root is thus well-defined thereafter.", "solution": "The Full Truncation Euler (FTE) scheme is an explicit numerical method designed to ensure the non-negativity of the simulated path for processes like CIR. Let's analyze each option:\n\n**A. Correct.** This option correctly describes the standard FTE scheme, also known as a projected Euler scheme. It involves two key steps:\n1.  **Robust Coefficient Evaluation:** The coefficients for the update step are calculated using the positive part of the current value, $X_n^+ = \\max(X_n, 0)$. This ensures that the square root is always well-defined, as the scheme guarantees $X_n \\ge 0$ from the previous step.\n2.  **Projection:** A provisional value $\\widetilde{X}_{n+1}$ is computed, which can be negative. This value is then projected onto the non-negative axis via $X_{n+1} = \\max(\\widetilde{X}_{n+1}, 0)$. This final projection step explicitly enforces non-negativity for the next state, $X_{n+1}$.\nThe definition and the explanation of the mechanism are both accurate.\n\n**B. Incorrect.** This describes the *partial truncation* or *absorption* scheme, not the full truncation scheme. It only modifies the diffusion term, and the resulting value $X_{n+1}$ can still become negative. The explanation is also flawed; the Feller condition applies to the continuous-time process, not its discrete approximations, which can violate positivity for a finite time step $\\Delta t > 0$.\n\n**C. Incorrect.** This describes an *implicit* Euler scheme. The FTE scheme is an explicit method. Implicit schemes are computationally more intensive and have different properties.\n\n**D. Incorrect.** This describes the *reflecting* Euler scheme. It uses the absolute value to enforce non-negativity, which has different path properties near the zero boundary compared to truncation (which sets the value to zero). This is a different method from the FTE scheme.", "answer": "$$\\boxed{A}$$", "id": "3047718"}]}