{"hands_on_practices": [{"introduction": "This first exercise provides a clear and direct application of the Lyapunov function method. We will analyze an SDE where a strong, stabilizing drift term tames a diffusion coefficient that grows with the state, a common feature in many physical and financial models. By calculating the action of the infinitesimal generator on a simple quadratic Lyapunov function, you will see firsthand how a negative drift condition ensures the solution remains bounded, thus proving non-explosion [@problem_id:3068503].", "problem": "Let $\\{W_{t}\\}_{t \\geq 0}$ be a one-dimensional standard Brownian motion and consider the one-dimensional stochastic differential equation (SDE) with deterministic initial condition $X_{0} = x_{0} \\in \\mathbb{R}$,\n$$\n\\mathrm{d}X_{t} = b(X_{t})\\,\\mathrm{d}t + \\sigma(X_{t})\\,\\mathrm{d}W_{t}, \\quad \\text{where } b(x) = -x^{3} \\text{ and } \\sigma(x) = x^{2}.\n$$\nDefine the explosion time $\\tau_{\\infty} = \\lim_{R \\to \\infty} \\tau_{R}$, where $\\tau_{R} = \\inf\\{t \\geq 0 : |X_{t}| \\geq R\\}$ is the exit time from the interval $(-R, R)$. Starting from the definitions of Itô diffusion, the infinitesimal generator constructed via Itô's formula, and the notion of a coercive $C^{2}$ Lyapunov function, derive a non-explosion criterion for the SDE above by bounding the generator applied to a suitable Lyapunov function. In particular, for the choice $V(x) = 1 + x^{2}$, determine the smallest nonnegative constant $c$ such that the inequality\n$$\nL V(x) \\leq c\\big(1 + V(x)\\big) \\quad \\text{for all } x \\in \\mathbb{R}\n$$\nholds, where $L$ denotes the infinitesimal generator associated with the SDE. Use this bound to explain why $\\tau_{\\infty} = +\\infty$ almost surely, but report only the value of the smallest such $c$ as your final answer. Your final answer must be a single real number with no units. No rounding is required.", "solution": "The problem requires us to determine the smallest non-negative constant $c$ that satisfies a specific inequality involving the infinitesimal generator of a given stochastic differential equation (SDE), and to use this result to conclude that the solution does not explode.\n\nThe SDE is given by\n$$\n\\mathrm{d}X_{t} = b(X_{t})\\,\\mathrm{d}t + \\sigma(X_{t})\\,\\mathrm{d}W_{t}\n$$\nwith initial condition $X_{0} = x_{0} \\in \\mathbb{R}$, where $\\{W_{t}\\}_{t \\geq 0}$ is a one-dimensional standard Brownian motion. The drift and diffusion coefficients are $b(x) = -x^{3}$ and $\\sigma(x) = x^{2}$, respectively.\n\nFor a one-dimensional Itô diffusion and a function $f \\in C^{2}(\\mathbb{R})$, the infinitesimal generator $L$ is defined as:\n$$\nL f(x) = b(x) \\frac{\\mathrm{d}f}{\\mathrm{d}x}(x) + \\frac{1}{2} \\sigma(x)^{2} \\frac{\\mathrm{d}^{2}f}{\\mathrm{d}x^{2}}(x)\n$$\nSubstituting the given coefficients, the generator for this SDE is:\n$$\nL f(x) = (-x^{3}) \\frac{\\mathrm{d}f}{\\mathrm{d}x}(x) + \\frac{1}{2} (x^{2})^{2} \\frac{\\mathrm{d}^{2}f}{\\mathrm{d}x^{2}}(x) = -x^{3} f'(x) + \\frac{1}{2} x^{4} f''(x)\n$$\n\nWe are given the specific Lyapunov function $V(x) = 1 + x^{2}$. This function is of class $C^{2}(\\mathbb{R})$. We compute its first and second derivatives:\n$$\nV'(x) = \\frac{\\mathrm{d}}{\\mathrm{d}x}(1 + x^{2}) = 2x\n$$\n$$\nV''(x) = \\frac{\\mathrm{d}^{2}}{\\mathrm{d}x^{2}}(1 + x^{2}) = 2\n$$\nNow, we apply the generator $L$ to $V(x)$:\n$$\nL V(x) = -x^{3} V'(x) + \\frac{1}{2} x^{4} V''(x) = -x^{3}(2x) + \\frac{1}{2} x^{4}(2)\n$$\n$$\nL V(x) = -2x^{4} + x^{4} = -x^{4}\n$$\nThe problem asks for the smallest non-negative constant $c$ such that the following inequality holds for all $x \\in \\mathbb{R}$:\n$$\nL V(x) \\leq c\\big(1 + V(x)\\big)\n$$\nSubstituting the expressions for $L V(x)$ and $V(x)$:\n$$\n-x^{4} \\leq c\\big(1 + (1 + x^{2})\\big)\n$$\n$$\n-x^{4} \\leq c(2 + x^{2})\n$$\nSince $2 + x^{2}$ is strictly positive for all $x \\in \\mathbb{R}$, we can divide by it without altering the direction of the inequality:\n$$\n\\frac{-x^{4}}{2 + x^{2}} \\leq c\n$$\nThis inequality must hold for all $x \\in \\mathbb{R}$. Therefore, $c$ must be greater than or equal to the supremum of the function $g(x) = \\frac{-x^{4}}{2 + x^{2}}$ over $\\mathbb{R}$.\n$$\nc \\geq \\sup_{x \\in \\mathbb{R}} \\left( \\frac{-x^{4}}{2 + x^{2}} \\right)\n$$\nLet us analyze the function $g(x)$. The numerator $-x^{4}$ is non-positive for all $x$, and the denominator $2+x^{2}$ is strictly positive. Thus, $g(x) \\leq 0$ for all $x \\in \\mathbb{R}$. The maximum value is attained at $x=0$, where $g(0) = 0$. For any $x \\neq 0$, $g(x)$ is strictly negative.\nTherefore, the supremum is:\n$$\n\\sup_{x \\in \\mathbb{R}} g(x) = 0\n$$\nThe condition on $c$ becomes $c \\geq 0$. The problem asks for the smallest *non-negative* constant $c$ that satisfies this. The set of valid constants is $[0, \\infty)$. The smallest value in this set is $c=0$.\n\nTo explain why this implies the solution does not explode (i.e., $\\tau_{\\infty} = +\\infty$ almost surely), we use a standard argument based on this Lyapunov function. With $c=0$, the inequality is $LV(x) \\leq 0$. The function $V(x) = 1+x^2$ is a coercive function, meaning $V(x) \\to \\infty$ as $|x| \\to \\infty$.\n\nBy Itô's formula, for any stopping time $\\tau$:\n$$\n\\mathbb{E}[V(X_{t \\wedge \\tau})] = V(x_{0}) + \\mathbb{E}\\left[\\int_{0}^{t \\wedge \\tau} L V(X_{s}) \\, \\mathrm{d}s\\right]\n$$\nThe expectation of the stochastic integral term is zero under suitable conditions, which hold here for the stopped process.\nSince $L V(x) = -x^{4} \\leq 0$, the integral term is non-positive. Thus,\n$$\n\\mathbb{E}[V(X_{t \\wedge \\tau})] \\leq V(x_{0})\n$$\nLet $\\tau = \\tau_{R} = \\inf\\{t \\geq 0 : |X_{t}| \\geq R\\}$.\nOn the event $\\{\\tau_{R} \\leq t\\}$, we have $|X_{\\tau_R}| = R$, so $V(X_{\\tau_R}) = 1+R^2$. By the non-negativity of $V$, we can write:\n$$\n\\mathbb{E}[V(X_{t \\wedge \\tau_{R}})] \\geq \\mathbb{E}[V(X_{t \\wedge \\tau_{R}}) \\cdot \\mathbf{1}_{\\{\\tau_{R} \\leq t\\}}] = \\mathbb{E}[V(X_{\\tau_{R}}) \\cdot \\mathbf{1}_{\\{\\tau_{R} \\leq t\\}}] = (1+R^{2})\\mathbb{P}(\\tau_{R} \\leq t)\n$$\nCombining the inequalities:\n$$\n(1+R^{2})\\mathbb{P}(\\tau_{R} \\leq t) \\leq \\mathbb{E}[V(X_{t \\wedge \\tau_{R}})] \\leq V(x_{0}) = 1+x_{0}^{2}\n$$\nThis gives a bound on the probability of exiting the interval $(-R, R)$ by time $t$:\n$$\n\\mathbb{P}(\\tau_{R} \\leq t) \\leq \\frac{1+x_{0}^{2}}{1+R^{2}}\n$$\nTaking the limit as $R \\to \\infty$:\n$$\n\\lim_{R \\to \\infty} \\mathbb{P}(\\tau_{R} \\leq t) = 0\n$$\nThe explosion time is $\\tau_{\\infty} = \\lim_{R \\to \\infty} \\tau_{R}$. The event that explosion occurs by time $t$ is $\\{\\tau_{\\infty} \\leq t\\} = \\bigcap_{n \\in \\mathbb{N}} \\{\\tau_{n} \\leq t\\}$. By continuity of probability on this nested sequence of events:\n$$\n\\mathbb{P}(\\tau_{\\infty} \\leq t) = \\lim_{R \\to \\infty} \\mathbb{P}(\\tau_{R} \\leq t) = 0\n$$\nThis holds for any finite $t  0$. The probability of explosion in finite time is $\\mathbb{P}(\\tau_{\\infty}  \\infty) = \\mathbb{P}\\left(\\bigcup_{n=1}^{\\infty} \\{\\tau_{\\infty} \\leq n\\}\\right) \\leq \\sum_{n=1}^{\\infty} \\mathbb{P}(\\tau_{\\infty} \\leq n) = \\sum_{n=1}^{\\infty} 0 = 0$.\nTherefore, $\\mathbb{P}(\\tau_{\\infty} = \\infty) = 1$, and the solution does not explode, almost surely. The smallest non-negative constant required to establish this is $c=0$.", "answer": "$$\n\\boxed{0}\n$$", "id": "3068503"}, {"introduction": "We now advance to a more challenging scenario where the coefficients of the SDE do not satisfy the standard linear growth conditions for non-explosion. This practice requires you to move beyond simply verifying a given Lyapunov function to actively constructing one that is tailored to the problem. By strategically choosing the form of the function, you will learn how to cancel out the dominant super-linear terms in the generator, a powerful technique for proving stability in complex systems [@problem_id:3068512].", "problem": "Consider the one-dimensional stochastic differential equation (SDE) \n$$\n\\mathrm{d}X_{t}=\\big(X_{t}-X_{t}^{3}\\big)\\,\\mathrm{d}t+\\big(1+X_{t}^{2}\\big)\\,\\mathrm{d}W_{t},\\qquad X_{0}=x\\in\\mathbb{R},\n$$\ndriven by a standard one-dimensional Brownian motion (BM) $\\{W_{t}\\}_{t\\geq 0}$. For $n\\in\\mathbb{N}$, define the exit time from the ball of radius $n$ by\n$$\n\\tau_{n}=\\inf\\{t\\geq 0:\\,|X_{t}|\\geq n\\},\\qquad \\tau_{\\infty}=\\lim_{n\\to\\infty}\\tau_{n}.\n$$\nStarting from the definitions of strong solutions up to explosion time, Itô’s formula, and properties of stopping times, derive from first principles a Lyapunov-type estimate that rules out explosion in finite time. Then deduce the value of the probability\n$$\n\\mathbb{P}_{x}\\big(\\tau_{\\infty}=\\infty\\big),\n$$\nwhere $\\mathbb{P}_{x}$ denotes the law of the process started from $X_{0}=x$. Your final answer must be this probability as a single number. No intermediate inequalities or equations will be accepted as the final answer. If you choose to compute a numerical value, give it exactly; no rounding is necessary.", "solution": "The problem asks for the probability that the solution to a given stochastic differential equation (SDE) does not explode in finite time. The SDE is\n$$\n\\mathrm{d}X_{t}=\\big(X_{t}-X_{t}^{3}\\big)\\,\\mathrm{d}t+\\big(1+X_{t}^{2}\\big)\\,\\mathrm{d}W_{t},\n$$\nwith initial condition $X_{0}=x\\in\\mathbb{R}$. The drift coefficient is $b(x)=x-x^3$ and the diffusion coefficient is $\\sigma(x)=1+x^2$. A strong solution exists and is unique up to the explosion time $\\tau_{\\infty} = \\lim_{n\\to\\infty} \\tau_n$, where $\\tau_n = \\inf\\{t \\ge 0 : |X_t| \\ge n\\}$. We want to determine the value of $\\mathbb{P}_x(\\tau_\\infty = \\infty)$.\n\nThe standard conditions for non-explosion require linear growth on the coefficients, i.e., $|b(x)| + |\\sigma(x)| \\leq C(1+|x|)$ for some constant $C0$. Here, $|b(x)| \\sim |x|^3$ and $|\\sigma(x)| \\sim |x|^2$ for large $|x|$, so these conditions are not satisfied. We must therefore use a more refined method, such as a Lyapunov function.\n\nA sufficient condition for non-explosion is the existence of a twice continuously differentiable function $V: \\mathbb{R} \\to [0, \\infty)$, called a Lyapunov function, such that $V(x) \\to \\infty$ as $|x| \\to \\infty$, and for which the action of the generator $L$ of the SDE on $V$ is controlled. The generator $L$ is given by\n$$\nL = b(x) \\frac{\\mathrm{d}}{\\mathrm{d}x} + \\frac{1}{2} \\sigma(x)^2 \\frac{\\mathrm{d}^2}{\\mathrm{d}x^2}.\n$$\nSpecifically, if there exists such a $V$ and a constant $K \\ge 0$ such that $LV(x) \\le K V(x)$ for all $x \\in \\mathbb{R}$, then the solution is non-explosive.\n\nFor our SDE, the generator is\n$$\nL = (x-x^3) \\frac{\\mathrm{d}}{\\mathrm{d}x} + \\frac{1}{2} (1+x^2)^2 \\frac{\\mathrm{d}^2}{\\mathrm{d}x^2}.\n$$\nWe seek a suitable Lyapunov function $V(x)$. Let us try a function of the form $V(x) = (1+x^2)^\\alpha$ for some $\\alpha  0$. This function satisfies $V(x) \\to \\infty$ as $|x| \\to \\infty$. We compute its derivatives:\n$$\nV'(x) = \\frac{\\mathrm{d}V}{\\mathrm{d}x} = 2\\alpha x (1+x^2)^{\\alpha-1}\n$$\n$$\nV''(x) = \\frac{\\mathrm{d}^2V}{\\mathrm{d}x^2} = 2\\alpha(1+x^2)^{\\alpha-1} + 2\\alpha x (\\alpha-1)(1+x^2)^{\\alpha-2}(2x) = 2\\alpha(1+x^2)^{\\alpha-2}\\big( (1+x^2) + 2(\\alpha-1)x^2 \\big) = 2\\alpha(1+x^2)^{\\alpha-2}\\big( 1 + (2\\alpha-1)x^2 \\big).\n$$\nNow we apply the generator $L$ to $V(x)$:\n$$\nLV(x) = (x-x^3) \\big(2\\alpha x (1+x^2)^{\\alpha-1}\\big) + \\frac{1}{2} (1+x^2)^2 \\big(2\\alpha(1+x^2)^{\\alpha-2}(1 + (2\\alpha-1)x^2)\\big)\n$$\n$$\nLV(x) = 2\\alpha x^2(1-x^2)(1+x^2)^{\\alpha-1} + \\alpha(1+x^2)^{\\alpha}\\big(1+(2\\alpha-1)x^2\\big)\n$$\nFactoring out $\\alpha(1+x^2)^{\\alpha-1}$:\n$$\nLV(x) = \\alpha(1+x^2)^{\\alpha-1} \\left[ 2x^2(1-x^2) + (1+x^2)\\big(1+(2\\alpha-1)x^2\\big) \\right]\n$$\nExpanding the terms inside the square brackets:\n$$\n[\\dots] = (2x^2-2x^4) + (1 + (2\\alpha-1)x^2+x^2+(2\\alpha-1)x^4)\n$$\n$$\n[\\dots] = 1 + (2+2\\alpha-1+1)x^2 + (-2+2\\alpha-1)x^4 = 1 + (2+2\\alpha)x^2 + (2\\alpha-3)x^4.\n$$\nSo, we have:\n$$\nLV(x) = \\alpha(1+x^2)^{\\alpha-1} \\big( 1 + 2(1+\\alpha)x^2 + (2\\alpha-3)x^4 \\big).\n$$\nFor large $|x|$, the term $(2\\alpha-3)x^4$ dominates. If $2\\alpha-3  0$, then $LV(x)$ grows faster than $V(x)$ (which grows like $(x^2)^\\alpha = x^{2\\alpha}$, while $LV(x)$ grows like $(x^2)^{\\alpha-1} x^4 = x^{2\\alpha+2}$). To control the growth, we choose $\\alpha$ such that the highest power of $x$ is eliminated. We set the coefficient of $x^4$ to zero:\n$$\n2\\alpha-3=0 \\implies \\alpha = \\frac{3}{2}.\n$$\nLet's choose $V(x) = (1+x^2)^{3/2}$. For this particular $V(x)$, the expression for $LV(x)$ simplifies significantly:\n$$\nLV(x) = \\frac{3}{2}(1+x^2)^{1/2} \\left( 1 + 2(1+\\frac{3}{2})x^2 \\right) = \\frac{3}{2}(1+x^2)^{1/2} (1+5x^2).\n$$\nWe now check if $LV(x) \\le K V(x)$ for some constant $K$.\n$$\n\\frac{LV(x)}{V(x)} = \\frac{\\frac{3}{2}(1+x^2)^{1/2} (1+5x^2)}{(1+x^2)^{3/2}} = \\frac{\\frac{3}{2}(1+5x^2)}{1+x^2}.\n$$\nLet $y=x^2 \\ge 0$. We consider the function $f(y) = \\frac{1+5y}{1+y} = \\frac{5(1+y)-4}{1+y} = 5 - \\frac{4}{1+y}$. For $y \\ge 0$, this function is increasing from $f(0)=1$ to $\\lim_{y\\to\\infty} f(y) = 5$. Thus, its values are bounded on $[1, 5)$.\nThis means\n$$\n\\frac{LV(x)}{V(x)} = \\frac{3}{2} f(x^2) \\le \\frac{3}{2} \\cdot 5 = \\frac{15}{2}.\n$$\nTherefore, we have found a Lyapunov function $V(x)=(1+x^2)^{3/2}$ satisfying $LV(x) \\le K V(x)$ with $K = \\frac{15}{2}$.\n\nNow we use this result to prove non-explosion. Let $t0$ be any fixed time. Consider the process stopped at time $\\tau_n$, $X_{s \\wedge \\tau_n}$. By Itô's formula applied to $V(X_t)$:\n$$\nV(X_{t \\wedge \\tau_n}) - V(X_0) = \\int_0^{t \\wedge \\tau_n} LV(X_s)\\,\\mathrm{d}s + \\int_0^{t \\wedge \\tau_n} V'(X_s)\\sigma(X_s)\\,\\mathrm{d}W_s.\n$$\nThe stochastic integral term is a local martingale. For the stopped process, the integrand $V'(X_s)\\sigma(X_s)$ is bounded for $s \\in [0, t \\wedge \\tau_n]$ because $|X_s|n$. This ensures the stochastic integral is a true martingale with zero expectation. Taking the expectation of both sides:\n$$\n\\mathbb{E}_x[V(X_{t \\wedge \\tau_n})] - V(x) = \\mathbb{E}_x\\left[\\int_0^{t \\wedge \\tau_n} LV(X_s)\\,\\mathrm{d}s\\right].\n$$\nUsing the inequality $LV(x) \\le K V(x)$:\n$$\n\\mathbb{E}_x[V(X_{t \\wedge \\tau_n})] \\le V(x) + \\mathbb{E}_x\\left[\\int_0^{t \\wedge \\tau_n} K V(X_s)\\,\\mathrm{d}s\\right] = V(x) + K \\int_0^t \\mathbb{E}_x[V(X_{s \\wedge \\tau_n})]\\,\\mathrm{d}s.\n$$\nLet $f(t) = \\mathbb{E}_x[V(X_{t \\wedge \\tau_n})]$. The inequality becomes $f(t) \\le f(0) + K\\int_0^t f(s)\\,\\mathrm{d}s$, where $f(0)=V(x)$. By Gronwall's inequality, this implies:\n$$\n\\mathbb{E}_x[V(X_{t \\wedge \\tau_n})] \\le V(x) \\exp(Kt).\n$$\nThis gives an upper bound on the expected value of $V$ for the stopped process. Now we derive a lower bound. By definition of $\\tau_n$, on the event $\\{\\tau_n \\le t\\}$, we have $|X_{\\tau_n}| \\ge n$. Since the process is continuous, $|X_{\\tau_n}|=n$. Thus, on this event:\n$$\nV(X_{t \\wedge \\tau_n}) = V(X_{\\tau_n}) = (1+X_{\\tau_n}^2)^{3/2} = (1+n^2)^{3/2}.\n$$\nUsing Markov's inequality (or direct estimation):\n$$\n\\mathbb{E}_x[V(X_{t \\wedge \\tau_n})] \\ge \\mathbb{E}_x[V(X_{t \\wedge \\tau_n}) \\mathbb{I}_{\\{\\tau_n \\le t\\}}] = \\mathbb{E}_x[(1+n^2)^{3/2} \\mathbb{I}_{\\{\\tau_n \\le t\\}}] = (1+n^2)^{3/2} \\mathbb{P}_x(\\tau_n \\le t).\n$$\nCombining the upper and lower bounds:\n$$\n(1+n^2)^{3/2} \\mathbb{P}_x(\\tau_n \\le t) \\le \\mathbb{E}_x[V(X_{t \\wedge \\tau_n})] \\le V(x) \\exp(Kt).\n$$\nThis gives an estimate for the probability of exiting the ball of radius $n$ before time $t$:\n$$\n\\mathbb{P}_x(\\tau_n \\le t) \\le \\frac{V(x) \\exp(Kt)}{(1+n^2)^{3/2}}.\n$$\nThe explosion time is $\\tau_\\infty = \\lim_{n\\to\\infty} \\tau_n$. The event of explosion before time $t$ is $\\{\\tau_\\infty \\le t\\}$. Since $\\{\\tau_n \\le t\\}$ is an increasing sequence of events with respect to $n$ whose union is $\\{\\tau_\\infty \\le t\\}$, we have $\\mathbb{P}_x(\\tau_\\infty \\le t) = \\lim_{n\\to\\infty} \\mathbb{P}_x(\\tau_n \\le t)$. Taking the limit as $n \\to \\infty$ in our inequality:\n$$\n\\mathbb{P}_x(\\tau_\\infty \\le t) = \\lim_{n\\to\\infty} \\mathbb{P}_x(\\tau_n \\le t) \\le \\lim_{n\\to\\infty} \\frac{V(x) \\exp(Kt)}{(1+n^2)^{3/2}} = 0.\n$$\nThis holds for any arbitrary finite time $t  0$. The event of explosion in finite time is $\\Omega_{expl} = \\{\\tau_\\infty  \\infty\\} = \\bigcup_{m=1}^{\\infty} \\{\\tau_\\infty \\le m\\}$.\nBy the union bound (or continuity of probability measures):\n$$\n\\mathbb{P}_x(\\tau_\\infty  \\infty) = \\mathbb{P}_x\\left(\\bigcup_{m=1}^{\\infty} \\{\\tau_\\infty \\le m\\}\\right) = \\lim_{m\\to\\infty} \\mathbb{P}_x(\\tau_\\infty \\le m).\n$$\nSince $\\mathbb{P}_x(\\tau_\\infty \\le m) = 0$ for every $m \\in \\mathbb{N}$, the limit is $0$. Therefore, the probability of explosion in finite time is zero.\n$$\n\\mathbb{P}_x(\\tau_\\infty  \\infty) = 0.\n$$\nThe probability of non-explosion is the complement:\n$$\n\\mathbb{P}_x(\\tau_\\infty = \\infty) = 1 - \\mathbb{P}_x(\\tau_\\infty  \\infty) = 1 - 0 = 1.\n$$\nThus, the solution exists for all time, almost surely, for any starting point $x \\in \\mathbb{R}$.", "answer": "$$\\boxed{1}$$", "id": "3068512"}, {"introduction": "To complement our analytical work, this final practice takes a computational approach to understanding solution explosion. You will implement the Euler-Maruyama method to simulate paths from different SDEs and empirically measure their tendency to \"explode\" by hitting a large numerical boundary. This hands-on coding exercise provides valuable intuition by visualizing the stark difference in behavior between systems that satisfy theoretical non-explosion criteria and those that do not [@problem_id:3068502].", "problem": "Consider the one-dimensional stochastic differential equation (SDE) defined on the time interval $[0,T]$,\n$$\n\\mathrm{d}X_t = b(X_t)\\,\\mathrm{d}t + \\sigma(X_t)\\,\\mathrm{d}W_t,\\quad X_0 = x_0,\n$$\nwhere $W_t$ denotes a Brownian motion (also called a Wiener process), $b:\\mathbb{R}\\to\\mathbb{R}$ is the drift coefficient, and $\\sigma:\\mathbb{R}\\to\\mathbb{R}$ is the diffusion coefficient. A solution is said to explode if it becomes unbounded in finite time; more precisely, the explosion time is\n$$\n\\tau_e := \\inf\\{t\\ge 0:\\,|X_t|=+\\infty\\}.\n$$\nNon-explosion of solutions is a fundamental property studied via growth and regularity assumptions on $b$ and $\\sigma$. A classical sufficient condition for non-explosion is that $b$ and $\\sigma$ are locally Lipschitz and satisfy a linear growth bound of the form\n$$\n|b(x)| + |\\sigma(x)| \\le K(1+|x|)\n$$\nfor some constant $K0$ and all $x\\in\\mathbb{R}$. Under such conditions, strong solutions exist globally and do not explode.\n\nYour task is to implement a numerical sanity check using the Euler–Maruyama discretization to gain insight into non-explosion. For a given $b$ and $\\sigma$, simulate sample paths and compute the empirical probability that a path hits a large threshold before the terminal time. Hitting a large finite threshold is not the same as mathematical explosion, but numerically it provides a useful indicator of extreme growth. For each test case, do the following.\n\n1. Use the Euler–Maruyama scheme:\n$$\nX_{n+1} = X_n + b(X_n)\\,\\Delta t + \\sigma(X_n)\\,\\Delta W_n,\n$$\nwhere $\\Delta W_n \\sim \\mathcal{N}(0,\\Delta t)$ are independent normally distributed increments, $\\Delta t$ is the time step, and $n$ indexes discrete time with $t_n=n\\,\\Delta t$.\n\n2. Define a large finite threshold $M0$. For each simulated path, declare a numerical threshold hit as soon as $|X_n|\\ge M$, and record whether this occurs before time $T$.\n\n3. Repeat across $N$ independent paths and compute the empirical hitting probability as a decimal (not a percentage), that is,\n$$\np := \\frac{\\text{number of paths that hit the threshold by time }T}{N}.\n$$\n\n4. Independently of simulation, evaluate whether the linear growth condition holds for the given parametric forms of $b$ and $\\sigma$. In this problem, the coefficients will be polynomials of the form\n$$\nb(x) = a\\,x^p,\\quad \\sigma(x) = c\\,x^q,\n$$\nwith real parameters $a$, $c$ and nonnegative exponents $p$, $q$. For these polynomial forms, a sufficient check for linear growth is that $p\\le 1$ and $q\\le 1$. Declare the boolean flag $\\text{LG}$ to be $1$ (True) if $p\\le 1$ and $q\\le 1$, and $0$ (False) otherwise. Note that polynomial coefficients are smooth, hence locally Lipschitz on $\\mathbb{R}$, so the linear growth check suffices to indicate the standard condition.\n\nImplement the program to run the following test suite of parameter values. Each test case is a tuple $(a,p,c,q,x_0,T,\\Delta t,M,N)$:\n\n- Test $1$ (stable Ornstein–Uhlenbeck-type coefficients): $(a,p,c,q,x_0,T,\\Delta t,M,N) = (-1,1,1,0,0,2,0.005,100,2000)$. Here $b(x)=-1\\cdot x$, $\\sigma(x)=1$, $x_0=0$, $T=2$, $\\Delta t=0.005$, threshold $M=100$, and $N=2000$ paths.\n- Test $2$ (strong outward linear drift with small diffusion): $(a,p,c,q,x_0,T,\\Delta t,M,N) = (3,1,0.1,0,1,2,0.005,100,2000)$.\n- Test $3$ (deterministic superlinear drift, zero diffusion; a known finite-time blow-up in the corresponding ordinary differential equation): $(a,p,c,q,x_0,T,\\Delta t,M,N) = (1,2,0,0,1,2,0.005,100,2000)$.\n\nFor each test case, output the pair $[p,\\text{LG}]$ where $p$ is the empirical hitting probability rounded to three decimal places and $\\text{LG}$ is the boolean flag as specified above. The final output must be a single line containing the results for all test cases as a comma-separated list enclosed in square brackets, for example, $[[p_1,\\text{LG}_1],[p_2,\\text{LG}_2],[p_3,\\text{LG}_3]]$.\n\nNo physical units are involved in this problem. Angles are not used. Probabilities must be expressed as decimals.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[[p_1,\\text{LG}_1],[p_2,\\text{LG}_2],[p_3,\\text{LG}_3]]$).", "solution": "The problem requires us to analyze the behavior of solutions to a one-dimensional stochastic differential equation (SDE) with polynomial coefficients. We will perform two main tasks for each given test case: first, determine if the coefficients satisfy a theoretical sufficient condition for non-explosion (the linear growth condition), and second, perform a numerical simulation using the Euler-Maruyama method to estimate the probability of the solution path reaching a large magnitude.\n\nThe SDE under consideration is\n$$\n\\mathrm{d}X_t = b(X_t)\\,\\mathrm{d}t + \\sigma(X_t)\\,\\mathrm{d}W_t, \\quad X_0 = x_0\n$$\nwhere $b(x)$ is the drift coefficient and $\\sigma(x)$ is the diffusion coefficient. The coefficients are given in polynomial form:\n$$\nb(x) = a\\,x^p, \\quad \\sigma(x) = c\\,x^q\n$$\nwith parameters $a, c \\in \\mathbb{R}$ and non-negative exponents $p, q$.\n\n### Part 1: Linear Growth Condition ($\\text{LG}$ Flag)\n\nA standard sufficient condition for the existence of a unique, non-explosive global solution to the SDE requires the coefficients $b(x)$ and $\\sigma(x)$ to be locally Lipschitz and to satisfy the linear growth condition. The linear growth condition states that there exists a constant $K  0$ such that for all $x \\in \\mathbb{R}$:\n$$\n|b(x)| + |\\sigma(x)| \\le K(1 + |x|)\n$$\nFor the given polynomial forms, $b(x) = a\\,x^p$ and $\\sigma(x) = c\\,x^q$, this condition must be checked. The term $|x|$ on the right-hand side has a growth of order $1$. The terms on the left-hand side have growths of order $p$ and $q$, respectively. For the inequality to hold for all $x$, especially for large $|x|$, the growth on the left-hand side cannot be faster than the growth on the right-hand side. This implies that the exponents $p$ and $q$ must not be greater than $1$.\nTherefore, the linear growth condition is satisfied if and only if $p \\le 1$ and $q \\le 1$.\nThe problem specifies a boolean flag, $\\text{LG}$, which is set to $1$ (True) if this condition holds, and $0$ (False) otherwise.\n\nFor each test case, we evaluate $\\text{LG}$ as follows:\n- **Test 1**: $(a,p,c,q) = (-1,1,1,0)$. Here, $p=1$ and $q=0$. Since $p \\le 1$ and $q \\le 1$, the condition holds. Thus, $\\text{LG}=1$.\n- **Test 2**: $(a,p,c,q) = (3,1,0.1,0)$. Here, $p=1$ and $q=0$. Since $p \\le 1$ and $q \\le 1$, the condition holds. Thus, $\\text{LG}=1$.\n- **Test 3**: $(a,p,c,q) = (1,2,0,0)$. Here, $p=2$ and $q=0$. Since $p  1$, the condition is violated. Thus, $\\text{LG}=0$.\n\n### Part 2: Numerical Simulation (Empirical Hitting Probability $p$)\n\nWe use the Euler-Maruyama scheme to generate approximate sample paths of the SDE. The discretization is given by:\n$$\nX_{n+1} = X_n + b(X_n)\\,\\Delta t + \\sigma(X_n)\\,\\Delta W_n\n$$\nwhere $X_n$ is the state at time $t_n = n\\,\\Delta t$. The term $\\Delta W_n$ represents a Wiener process increment over the interval $[t_n, t_{n+1}]$, which is a normally distributed random variable with mean $0$ and variance $\\Delta t$. We can write $\\Delta W_n = Z_n \\sqrt{\\Delta t}$, where $Z_n \\sim \\mathcal{N}(0,1)$ are independent standard normal random variables. The update rule is then:\n$$\nX_{n+1} = X_n + (a X_n^p)\\,\\Delta t + (c X_n^q)\\sqrt{\\Delta t}\\,Z_n\n$$\nFor each test case, we simulate $N$ independent paths from $t=0$ to $t=T$. The number of time steps for each path is $N_{\\text{steps}} = \\text{int}(T/\\Delta t)$. For each path, we monitor if its magnitude $|X_n|$ ever meets or exceeds a large threshold $M$. If a path hits the threshold at any time $t_n \\le T$, we count it as a \"hit\". The simulation for that specific path is then stopped, as its fate regarding the threshold is determined.\n\nThe algorithm for a single test case is:\n1. Initialize parameters: $a, p, c, q, x_0, T, \\Delta t, M, N$.\n2. Initialize `hit_counter` to $0$.\n3. Loop $N$ times (for each path from $1$ to $N$):\n    a. Set the initial state $X = x_0$.\n    b. Loop $N_{\\text{steps}}$ times (for each time step):\n        i. Generate $Z \\sim \\mathcal{N}(0,1)$.\n        ii. Update the state: $X \\leftarrow X + (a X^p)\\Delta t + (c X^q)\\sqrt{\\Delta t}Z$.\n        iii. Check for threshold hit: If $|X| \\ge M$, increment `hit_counter` by $1$ and break the inner loop (proceed to the next path).\n4. After simulating all $N$ paths, calculate the empirical hitting probability: $p = \\frac{\\text{hit\\_counter}}{N}$.\n5. Round the result $p$ to three decimal places.\n\nThis procedure is applied to each of the three test cases.\n\n- **Test 1**: $b(x)=-x$, $\\sigma(x)=1$. This describes an Ornstein-Uhlenbeck process, which is mean-reverting towards $0$. Starting from $x_0=0$, the process is expected to remain bounded in a small neighborhood of $0$. A threshold of $M=100$ is exceptionally large for this process, so we expect the hitting probability $p$ to be very close to $0$.\n\n- **Test 2**: $b(x)=3x$, $\\sigma(x)=0.1$. The drift term is strongly positive and linear, pushing the solution away from the origin. The corresponding ODE $dx/dt = 3x$ has an exponentially growing solution $x(t) = x_0 e^{3t}$. With $x_0=1$, this deterministic part alone would reach $e^{3 \\times 2} = e^6 \\approx 403.4$ at $t=2$, far exceeding the threshold $M=100$. The small diffusion term adds noise but is unlikely to counteract this explosive trend. We expect a high hitting probability, $p \\approx 1$.\n\n- **Test 3**: $b(x)=x^2$, $\\sigma(x)=0$. This is a deterministic ODE, $\\mathrm{d}X_t/ \\mathrm{d}t = X_t^2$. With $x_0=1$, the analytical solution is $X_t = 1/(1-t)$, which has a finite-time blow-up at $t=1$. Since the simulation runs until $T=2$, it is certain that the trajectory will surpass any finite threshold $M$. The numerical scheme should capture this behavior, yielding a hitting probability of $p=1.0$.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem by iterating through test cases, calculating the linear\n    growth flag and simulating SDE paths to find the empirical hitting probability.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (a, p, c, q, x0, T, dt, M, N)\n    test_cases = [\n        (-1, 1, 1, 0, 0, 2, 0.005, 100, 2000),\n        (3, 1, 0.1, 0, 1, 2, 0.005, 100, 2000),\n        (1, 2, 0, 0, 1, 2, 0.005, 100, 2000),\n    ]\n\n    results = []\n    # Initialize a random number generator for reproducibility.\n    rng = np.random.default_rng(seed=42)\n\n    for case in test_cases:\n        a, p, c, q, x0, T, dt, M, N = case\n\n        # Part 1: Evaluate the linear growth (LG) condition\n        # The condition holds if p = 1 and q = 1.\n        lg_flag = 1 if p = 1 and q = 1 else 0\n\n        # Part 2: Run the Euler-Maruyama simulation\n        num_steps = int(T / dt)\n        sqrt_dt = np.sqrt(dt)\n        hit_count = 0\n\n        for _ in range(N):\n            X = float(x0)\n            has_hit = False\n\n            for _ in range(num_steps):\n                # Standard normal random variable for the Wiener increment\n                Z = rng.normal(0, 1)\n\n                # Calculate drift and diffusion terms\n                # Note: x**p is well-defined for all real x since p is an integer in all test cases.\n                b_X = a * (X**p)\n                sigma_X = c * (X**q)\n\n                # Update the state using the Euler-Maruyama step\n                X += b_X * dt + sigma_X * sqrt_dt * Z\n\n                # Check if the path has hit the threshold\n                if abs(X) = M:\n                    hit_count += 1\n                    has_hit = True\n                    break  # Stop simulating this path as it has already hit\n\n            # The code could be written to not increment 'hit_count' if has_hit is already True,\n            # but the 'break' statement makes this check redundant.\n\n        # Calculate and round the empirical hitting probability\n        hit_prob = hit_count / N\n        p_rounded = round(hit_prob, 3)\n\n        results.append([p_rounded, lg_flag])\n\n    # Format the final output string as specified: [[p1,LG1],[p2,LG2],...]\n    # without spaces inside the inner brackets.\n    str_results = []\n    for res in results:\n        p_val, lg_val = res\n        # Format the numbers to avoid trailing zeros for integers like 0.0 - 0 and 1.0 - 1 if possible.\n        # str() handles this nicely.\n        str_results.append(f\"[{str(p_val)},{lg_val}]\")\n    \n    final_output_string = f\"[{','.join(str_results)}]\"\n    \n    # Final print statement in the exact required format.\n    print(final_output_string)\n\nsolve()\n```", "id": "3068502"}]}