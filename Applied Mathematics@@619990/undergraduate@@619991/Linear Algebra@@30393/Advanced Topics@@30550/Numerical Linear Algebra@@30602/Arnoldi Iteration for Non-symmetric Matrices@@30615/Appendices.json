{"hands_on_practices": [{"introduction": "To truly understand an algorithm, we must start with its fundamental operations. This first practice exercise guides you through a single, complete step of the Arnoldi iteration. By manually computing the first few components, you will gain a concrete feel for how an orthonormal basis of the Krylov subspace is constructed and how the upper Hessenberg matrix begins to take shape [@problem_id:1349109].", "problem": "The Arnoldi iteration is an algorithm used to build an orthonormal basis of the Krylov subspace generated by a matrix $A$ and a vector $b$. This process is fundamental in numerical linear algebra, especially for approximating eigenvalues of large, non-symmetric matrices.\n\nConsider the non-symmetric matrix $A$ and the vector $b$ given by:\n$$\nA = \\begin{pmatrix} 1 & 4 \\\\ 2 & 3 \\end{pmatrix}, \\quad b = \\begin{pmatrix} 3 \\\\ 4 \\end{pmatrix}\n$$\nThe first step of the Arnoldi iteration begins with the normalized vector $q_1 = \\frac{b}{\\|b\\|_2}$, where $\\| \\cdot \\|_2$ denotes the Euclidean norm.\n\nYour task is to perform one complete step of the Arnoldi iteration to compute the second Arnoldi vector, $q_2$, and the first column of the associated upper Hessenberg matrix, $H$. The entries of this column are denoted by $h_{11}$ and $h_{21}$.\n\nLet the components of the resulting vector be $q_2 = \\begin{pmatrix} q_{2,1} \\\\ q_{2,2} \\end{pmatrix}$. Provide your answer as a single row matrix containing the four values $[q_{2,1}, q_{2,2}, h_{11}, h_{21}]$ in this exact order. Express all entries as exact fractions in their simplest form.", "solution": "The Arnoldi iteration starts with $q_{1}=\\dfrac{b}{\\|b\\|_{2}}$. For $b=\\begin{pmatrix}3 \\\\ 4\\end{pmatrix}$, the Euclidean norm is $\\|b\\|_{2}=\\sqrt{3^{2}+4^{2}}=5$, hence\n$$\nq_{1}=\\begin{pmatrix}\\dfrac{3}{5} \\\\ \\dfrac{4}{5}\\end{pmatrix}.\n$$\nCompute $v=Aq_{1}$:\n$$\nv=\\begin{pmatrix}1 & 4 \\\\ 2 & 3\\end{pmatrix}\\begin{pmatrix}\\dfrac{3}{5} \\\\ \\dfrac{4}{5}\\end{pmatrix}\n=\\begin{pmatrix}\\dfrac{3}{5}+ \\dfrac{16}{5} \\\\ \\dfrac{6}{5}+ \\dfrac{12}{5}\\end{pmatrix}\n=\\begin{pmatrix}\\dfrac{19}{5} \\\\ \\dfrac{18}{5}\\end{pmatrix}.\n$$\nThe first Hessenberg entry is $h_{11}=q_{1}^{\\top}v$:\n$$\nh_{11}=\\begin{pmatrix}\\dfrac{3}{5} & \\dfrac{4}{5}\\end{pmatrix}\\begin{pmatrix}\\dfrac{19}{5} \\\\ \\dfrac{18}{5}\\end{pmatrix}\n=\\dfrac{57}{25}+\\dfrac{72}{25}\n=\\dfrac{129}{25}.\n$$\nForm the residual $r=v-h_{11}q_{1}$:\n$$\nh_{11}q_{1}=\\dfrac{129}{25}\\begin{pmatrix}\\dfrac{3}{5} \\\\ \\dfrac{4}{5}\\end{pmatrix}\n=\\begin{pmatrix}\\dfrac{387}{125} \\\\ \\dfrac{516}{125}\\end{pmatrix},\\quad\nr=\\begin{pmatrix}\\dfrac{19}{5} \\\\ \\dfrac{18}{5}\\end{pmatrix}-\\begin{pmatrix}\\dfrac{387}{125} \\\\ \\dfrac{516}{125}\\end{pmatrix}\n=\\begin{pmatrix}\\dfrac{88}{125} \\\\ -\\dfrac{66}{125}\\end{pmatrix}.\n$$\nThe subdiagonal Hessenberg entry is $h_{21}=\\|r\\|_{2}$:\n$$\nh_{21}=\\sqrt{\\left(\\dfrac{88}{125}\\right)^{2}+\\left(-\\dfrac{66}{125}\\right)^{2}}\n=\\dfrac{1}{125}\\sqrt{7744+4356}\n=\\dfrac{1}{125}\\sqrt{12100}\n=\\dfrac{110}{125}\n=\\dfrac{22}{25}.\n$$\nNormalize to obtain $q_{2}=r/h_{21}$:\n$$\nq_{2}=\\dfrac{1}{\\frac{22}{25}}\\begin{pmatrix}\\dfrac{88}{125} \\\\ -\\dfrac{66}{125}\\end{pmatrix}\n=\\begin{pmatrix}\\dfrac{88}{125}\\cdot \\dfrac{25}{22} \\\\ -\\dfrac{66}{125}\\cdot \\dfrac{25}{22}\\end{pmatrix}\n=\\begin{pmatrix}\\dfrac{4}{5} \\\\ -\\dfrac{3}{5}\\end{pmatrix}.\n$$\nThus the requested entries are $q_{2,1}=\\dfrac{4}{5}$, $q_{2,2}=-\\dfrac{3}{5}$, $h_{11}=\\dfrac{129}{25}$, and $h_{21}=\\dfrac{22}{25}$.", "answer": "$$\\boxed{\\begin{pmatrix}\\frac{4}{5} & -\\frac{3}{5} & \\frac{129}{25} & \\frac{22}{25}\\end{pmatrix}}$$", "id": "1349109"}, {"introduction": "The Arnoldi iteration generates a basis for an expanding subspace, but what happens if that subspace stops expanding? This scenario, known as a \"lucky breakdown,\" is not a random event but a sign that we have found an invariant subspace. This practice explores the fundamental condition that causes the iteration to terminate early, revealing a direct link between the algorithm's behavior and the eigenvectors of the matrix [@problem_id:1349095].", "problem": "The Arnoldi iteration is an algorithm for building an orthonormal basis $\\{q_1, q_2, \\ldots, q_m\\}$ for a Krylov subspace $\\mathcal{K}_m(A, q_1) = \\text{span}\\{q_1, Aq_1, \\ldots, A^{m-1}q_1\\}$, where $A$ is an $n \\times n$ matrix and $q_1$ is a starting vector with unit norm, i.e., $\\|q_1\\|_2 = 1$.\n\nThe process proceeds as follows. For $k=1, 2, \\ldots$:\n1. Compute a new candidate vector $v = A q_k$.\n2. Orthogonalize $v$ against the previously found basis vectors $\\{q_1, \\ldots, q_k\\}$ to get a vector $w$: \n   $$w = v - \\sum_{j=1}^{k} (q_j^T v) q_j$$\n3. The algorithm terminates at step $k$ if $w$ is the zero vector. Otherwise, the next basis vector is obtained by normalizing $w$: $q_{k+1} = w / \\|w\\|_2$.\n\nConsider the case of a $2 \\times 2$ non-symmetric matrix $A$. The Arnoldi iteration is initiated with a specific vector $q_1$. For which of the following pairs of a matrix $A$ and initial vector $q_1$ will the Arnoldi iteration terminate after exactly one step (i.e., at $k=1$)?\n\nA. $A = \\begin{pmatrix} 0 & -1 \\\\ 1 & 0 \\end{pmatrix}$, $q_1 = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$\n\nB. $A = \\begin{pmatrix} 5 & -3 \\\\ 2 & 0 \\end{pmatrix}$, $q_1 = \\frac{1}{\\sqrt{2}}\\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$\n\nC. $A = \\begin{pmatrix} 1 & 1 \\\\ 0 & 1 \\end{pmatrix}$, $q_1 = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}$\n\nD. $A = \\begin{pmatrix} 1 & 3 \\\\ 1 & -1 \\end{pmatrix}$, $q_1 = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$", "solution": "At step $k=1$ of Arnoldi, with a single basis vector $q_{1}$ of unit norm, we form $v=Aq_{1}$ and orthogonalize against $q_{1}$:\n$$\nw \\;=\\; v - (q_{1}^{T}v)\\,q_{1} \\;=\\; Aq_{1} - \\big(q_{1}^{T}Aq_{1}\\big)\\,q_{1}.\n$$\nThe iteration terminates at $k=1$ if and only if $w=0$, which holds if and only if $Aq_{1}$ lies in the span of $q_{1}$, i.e., there exists a scalar $\\lambda$ such that $Aq_{1}=\\lambda q_{1}$. Equivalently, $q_{1}$ must be an eigenvector of $A$.\n\nWe test each option by computing $Aq_{1}$ and checking colinearity with $q_{1}$.\n\nA. $A=\\begin{pmatrix}0 & -1 \\\\ 1 & 0\\end{pmatrix}$, $q_{1}=\\begin{pmatrix}1 \\\\ 0\\end{pmatrix}$. Then\n$$\nv=Aq_{1}=\\begin{pmatrix}0 \\\\ 1\\end{pmatrix},\\quad q_{1}^{T}v=\\begin{pmatrix}1 & 0\\end{pmatrix}\\begin{pmatrix}0 \\\\ 1\\end{pmatrix}=0,\n$$\nso\n$$\nw=v-(q_{1}^{T}v)q_{1}=\\begin{pmatrix}0 \\\\ 1\\end{pmatrix}\\neq 0.\n$$\nNot terminating.\n\nB. $A=\\begin{pmatrix}5 & -3 \\\\ 2 & 0\\end{pmatrix}$, $q_{1}=\\frac{1}{\\sqrt{2}}\\begin{pmatrix}1 \\\\ 1\\end{pmatrix}$. Then\n$$\nv=Aq_{1}=\\frac{1}{\\sqrt{2}}\\begin{pmatrix}5-3 \\\\ 2+0\\end{pmatrix}=\\frac{1}{\\sqrt{2}}\\begin{pmatrix}2 \\\\ 2\\end{pmatrix}=2\\,\\frac{1}{\\sqrt{2}}\\begin{pmatrix}1 \\\\ 1\\end{pmatrix}=2q_{1},\n$$\nhence\n$$\nq_{1}^{T}v=2\\,q_{1}^{T}q_{1}=2,\\quad w=v-(q_{1}^{T}v)q_{1}=2q_{1}-2q_{1}=0.\n$$\nTerminates at $k=1$.\n\nC. $A=\\begin{pmatrix}1 & 1 \\\\ 0 & 1\\end{pmatrix}$, $q_{1}=\\begin{pmatrix}0 \\\\ 1\\end{pmatrix}$. Then\n$$\nv=Aq_{1}=\\begin{pmatrix}1 \\\\ 1\\end{pmatrix},\\quad q_{1}^{T}v=\\begin{pmatrix}0 & 1\\end{pmatrix}\\begin{pmatrix}1 \\\\ 1\\end{pmatrix}=1,\n$$\nso\n$$\nw=v-(q_{1}^{T}v)q_{1}=\\begin{pmatrix}1 \\\\ 1\\end{pmatrix}-\\begin{pmatrix}0 \\\\ 1\\end{pmatrix}=\\begin{pmatrix}1 \\\\ 0\\end{pmatrix}\\neq 0.\n$$\nNot terminating.\n\nD. $A=\\begin{pmatrix}1 & 3 \\\\ 1 & -1\\end{pmatrix}$, $q_{1}=\\begin{pmatrix}1 \\\\ 0\\end{pmatrix}$. Then\n$$\nv=Aq_{1}=\\begin{pmatrix}1 \\\\ 1\\end{pmatrix},\\quad q_{1}^{T}v=\\begin{pmatrix}1 & 0\\end{pmatrix}\\begin{pmatrix}1 \\\\ 1\\end{pmatrix}=1,\n$$\nso\n$$\nw=v-(q_{1}^{T}v)q_{1}=\\begin{pmatrix}1 \\\\ 1\\end{pmatrix}-\\begin{pmatrix}1 \\\\ 0\\end{pmatrix}=\\begin{pmatrix}0 \\\\ 1\\end{pmatrix}\\neq 0.\n$$\nNot terminating.\n\nTherefore, the Arnoldi iteration terminates after exactly one step only for option B.", "answer": "$$\\boxed{B}$$", "id": "1349095"}, {"introduction": "So far, we have used the Arnoldi iteration to analyze a given matrix $A$. Now, let's reverse the process to solidify our understanding of the underlying matrix decomposition. This exercise provides the output of an Arnoldi run—the orthonormal basis $Q$ and the Hessenberg matrix $H$—and challenges you to reconstruct the original matrix $A$, reinforcing the core relationship $A = QHQ^T$ [@problem_id:1349130].", "problem": "The Arnoldi iteration is an algorithm used in numerical linear algebra to find approximations of eigenvalues of large matrices. For a given $n \\times n$ matrix $A$ and a starting vector $q_1$ with unit norm ($\\|q_1\\|=1$), the iteration builds an orthonormal basis $\\{q_1, q_2, \\dots, q_k\\}$ for the $k$-th Krylov subspace. When the iteration is run for a full cycle of $n$ steps, it results in the Arnoldi decomposition of the matrix $A$, which is given by the equation $A = Q_n H_n Q_n^T$. In this decomposition, $Q_n = [q_1, q_2, \\dots, q_n]$ is an $n \\times n$ orthogonal matrix whose columns are the orthonormal vectors generated, and $H_n$ is an $n \\times n$ upper Hessenberg matrix. By convention in the standard algorithm, the sub-diagonal entries of $H_n$, denoted $h_{j+1, j}$, are constructed to be real and positive, a condition which makes the basis $\\{q_1, ..., q_n\\}$ unique for a given $q_1$.\n\nSuppose this process is applied to a $2 \\times 2$ real, non-symmetric matrix $A$. The iteration begins with the starting vector $q_1 = \\frac{1}{\\sqrt{2}}\\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix}$. After two steps, the process terminates and yields the $2 \\times 2$ upper Hessenberg matrix $H_2 = \\begin{pmatrix} 2 & 5 \\\\ 3 & 4 \\end{pmatrix}$.\n\nDetermine the matrix $A$.", "solution": "In a full Arnoldi cycle for a real matrix of order two, the Arnoldi decomposition reads\n$$\nA = Q_{2} H_{2} Q_{2}^{T},\n$$\nwhere $Q_{2} = [q_{1}, q_{2}]$ is orthogonal and $H_{2}$ is upper Hessenberg. Here\n$$\nq_{1} = \\frac{1}{\\sqrt{2}}\\begin{pmatrix}1 \\\\ -1\\end{pmatrix}, \\qquad\nH_{2} = \\begin{pmatrix}2 & 5 \\\\ 3 & 4\\end{pmatrix}.\n$$\nSince $q_{2}$ must be a unit vector orthogonal to $q_{1}$ and the standard Arnoldi convention enforces $h_{2,1}>0$, in $\\mathbb{R}^{2}$ the only possibilities for a unit vector orthogonal to $q_{1}$ are $\\pm \\frac{1}{\\sqrt{2}}(1,1)^{T}$. The sign is fixed by the Arnoldi convention, so we take\n$$\nq_{2} = \\frac{1}{\\sqrt{2}}\\begin{pmatrix}1 \\\\ 1\\end{pmatrix}.\n$$\nThus\n$$\nQ_{2} = \\frac{1}{\\sqrt{2}}\\begin{pmatrix}1 & 1 \\\\ -1 & 1\\end{pmatrix}, \\qquad\nQ_{2}^{T} = \\frac{1}{\\sqrt{2}}\\begin{pmatrix}1 & -1 \\\\ 1 & 1\\end{pmatrix}.\n$$\nCompute $Q_{2}H_{2}$:\n$$\nQ_{2}H_{2}\n= \\frac{1}{\\sqrt{2}}\n\\begin{pmatrix}\n1 & 1 \\\\ -1 & 1\n\\end{pmatrix}\n\\begin{pmatrix}\n2 & 5 \\\\ 3 & 4\n\\end{pmatrix}\n= \\frac{1}{\\sqrt{2}}\n\\begin{pmatrix}\n1\\cdot 2 + 1\\cdot 3 & 1\\cdot 5 + 1\\cdot 4 \\\\\n-1\\cdot 2 + 1\\cdot 3 & -1\\cdot 5 + 1\\cdot 4\n\\end{pmatrix}\n= \\frac{1}{\\sqrt{2}}\n\\begin{pmatrix}\n5 & 9 \\\\ 1 & -1\n\\end{pmatrix}.\n$$\nThen\n$$\nA = (Q_{2}H_{2})Q_{2}^{T}\n= \\frac{1}{2}\n\\begin{pmatrix}\n5 & 9 \\\\ 1 & -1\n\\end{pmatrix}\n\\begin{pmatrix}\n1 & -1 \\\\ 1 & 1\n\\end{pmatrix}\n= \\frac{1}{2}\n\\begin{pmatrix}\n5\\cdot 1 + 9\\cdot 1 & 5\\cdot (-1) + 9\\cdot 1 \\\\\n1\\cdot 1 + (-1)\\cdot 1 & 1\\cdot (-1) + (-1)\\cdot 1\n\\end{pmatrix}\n= \\frac{1}{2}\n\\begin{pmatrix}\n14 & 4 \\\\ 0 & -2\n\\end{pmatrix}\n= \\begin{pmatrix}\n7 & 2 \\\\ 0 & -1\n\\end{pmatrix}.\n$$\nA direct check shows $Q_{2}^{T}AQ_{2} = H_{2}$, confirming the result.", "answer": "$$\\boxed{\\begin{pmatrix}7 & 2 \\\\ 0 & -1\\end{pmatrix}}$$", "id": "1349130"}]}