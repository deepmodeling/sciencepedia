{"hands_on_practices": [{"introduction": "The Hill cipher provides a classic example of applying linear algebra to cryptography, where matrices act as encryption keys. This exercise explores a special type of key known as an involutory key, where the encryption process is its own inverse. By working through this problem [@problem_id:1348683], you will practice matrix multiplication and solving congruences, which are the fundamental algebraic operations underlying this cipher.", "problem": "In cryptography, the Hill cipher is a polygraphic substitution cipher based on linear algebra. A message is divided into blocks of size $n$, and each block is represented as a column vector $P$. The corresponding ciphertext vector $C$ is obtained by the transformation $C \\equiv KP \\pmod m$, where $K$ is an invertible $n \\times n$ key matrix and $m$ is the size of the alphabet.\n\nA special class of ciphers are \"involutory ciphers,\" where the encryption process is its own inverse. This means that applying the encryption transformation twice to any plaintext vector returns the original plaintext vector.\n\nConsider such an involutory Hill cipher operating on the English alphabet of $m=26$ letters (mapped as $A=0, B=1, \\dots, Z=25$) with a $2 \\times 2$ key matrix $K$. The key matrix is partially known and is given by:\n$$\nK = \\begin{pmatrix} 5 & 3 \\\\ 18 & d \\end{pmatrix}\n$$\nwhere $d$ is an integer.\n\nDetermine the unique value of $d$ in the range $0 \\le d < 26$ that makes this cipher involutory.", "solution": "An involutory Hill cipher satisfies $K^{2} \\equiv I \\pmod{26}$, where $I$ is the $2 \\times 2$ identity. With $K=\\begin{pmatrix} 5 & 3 \\\\ 18 & d \\end{pmatrix}$, compute\n$$\nK^{2}\n=\n\\begin{pmatrix}\n5^{2}+3\\cdot 18 & 5\\cdot 3+3d \\\\\n18\\cdot 5 + d\\cdot 18 & 18\\cdot 3 + d^{2}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n79 & 15+3d \\\\\n90+18d & 54+d^{2}\n\\end{pmatrix}.\n$$\nImposing $K^{2} \\equiv I \\pmod{26}$ yields four congruences:\n$$79 \\equiv 1 \\pmod{26},$$\n$$15+3d \\equiv 0 \\pmod{26},$$\n$$90+18d \\equiv 0 \\pmod{26},$$\n$$54+d^{2} \\equiv 1 \\pmod{26}.$$\nThe first is satisfied because $79-1=78=3\\cdot 26$. For the upper-right entry, $15+3d \\equiv 0 \\pmod{26}$ is equivalent to $3(5+d) \\equiv 0 \\pmod{26}$. Since $\\gcd(3,26)=1$, multiplying by the inverse of $3$ modulo $26$ gives $5+d \\equiv 0 \\pmod{26}$, hence\n$$d \\equiv -5 \\equiv 21 \\pmod{26}.$$\nFor the lower-left entry, $90+18d \\equiv 0 \\pmod{26}$ is $18(5+d) \\equiv 0 \\pmod{26}$. With $d \\equiv 21 \\pmod{26}$, we have $5+d \\equiv 0 \\pmod{26}$, so this holds. Finally, the lower-right entry gives $d^{2} \\equiv 1-54 \\equiv -53 \\equiv 25 \\pmod{26}$, whose solutions modulo $26$ are $d \\equiv 5$ and $d \\equiv 21$. The off-diagonal condition $3(5+d) \\equiv 0 \\pmod{26}$ eliminates $d \\equiv 5$, leaving the unique solution in $0 \\le d < 26$:\n$$d=21.$$\nAs a check, for $d=21$,\n$$K^{2}=\\begin{pmatrix}79 & 78 \\\\ 468 & 495\\end{pmatrix} \\equiv \\begin{pmatrix}1 & 0 \\\\ 0 & 1\\end{pmatrix} \\pmod{26},$$\nand $\\det K = 5\\cdot 21 - 3 \\cdot 18 = 105 - 54 = 51 \\equiv 25 \\pmod{26}$ with $\\gcd(25,26)=1$, so $K$ is invertible modulo $26$ and the cipher is involutory.", "answer": "$$\\boxed{21}$$", "id": "1348683"}, {"introduction": "Beyond designing ciphers, linear algebra is a powerful tool for cryptanalysis. This hypothetical scenario explores the security implications of diagonalization, where an encryption key $K$ is related to a public matrix $D$ via a secret matrix $P$. By analyzing what can be deduced from a leaked set of $K$'s eigenvectors [@problem_id:1348662], you'll gain insight into how fundamental properties of a matrix can expose information about its secret components.", "problem": "In a specialized cryptographic protocol, an encryption key is represented by a 3x3 matrix $K$ with real entries. This key is generated using a secret invertible 3x3 matrix $P$ and a publicly known 3x3 diagonal matrix $D$. The relationship between these matrices is given by the similarity transformation $K = PDP^{-1}$.\n\nThe public matrix $D$ is defined as:\n$$\nD = \\begin{pmatrix} d_1 & 0 & 0 \\\\ 0 & d_2 & 0 \\\\ 0 & 0 & d_3 \\end{pmatrix}\n$$\nwhere $d_1, d_2,$ and $d_3$ are distinct, non-zero real numbers.\n\nA cryptanalyst, seeking to discover the secret matrix $P$, manages to obtain a set of three linearly independent eigenvectors of the key matrix $K$, denoted as vectors $v_1, v_2, v_3$. However, the cryptanalyst does not know the key matrix $K$ itself, nor which eigenvector corresponds to which eigenvalue.\n\nBased solely on the public matrix $D$ and the set of leaked eigenvectors $\\{v_1, v_2, v_3\\}$, what is the most precise conclusion the cryptanalyst can draw about the secret matrix $P$?\n\nA. The cryptanalyst gains no information. The secret matrix $P$ could still be any invertible 3x3 matrix.\n\nB. The cryptanalyst can uniquely determine the secret matrix $P$.\n\nC. The cryptanalyst can determine the secret matrix $P$ up to a permutation of its columns.\n\nD. The cryptanalyst can determine the secret matrix $P$ up to a scaling of each of its columns by an unknown non-zero constant.\n\nE. The cryptanalyst can determine the secret matrix $P$ up to both a permutation of its columns and an independent scaling of each column by an unknown non-zero constant.", "solution": "We are given a diagonalizable matrix $K$ related to a diagonal matrix $D=\\operatorname{diag}(d_{1},d_{2},d_{3})$ with distinct nonzero entries via $K=PDP^{-1}$. Write $P=[p_{1}\\ p_{2}\\ p_{3}]$. Using $K=PDP^{-1}$, multiply on the right by $P$ to obtain\n$$\nK P = P D.\n$$\nEquating columns gives, for each $i\\in\\{1,2,3\\}$,\n$$\nK p_{i} = d_{i} p_{i},\n$$\nso the columns of $P$ are eigenvectors of $K$, with $p_{i}$ an eigenvector corresponding to $d_{i}$. Because $d_{1},d_{2},d_{3}$ are distinct, each eigenspace is one-dimensional, hence each $p_{i}$ is determined only up to scaling by a nonzero scalar.\n\nThe cryptanalyst knows three linearly independent eigenvectors $\\{v_{1},v_{2},v_{3}\\}$ of $K$ but does not know which eigenvector corresponds to which eigenvalue. Therefore, there exists a permutation $\\sigma$ of $\\{1,2,3\\}$ and nonzero scalars $c_{1},c_{2},c_{3}$ such that\n$$\np_{i} = c_{i}\\, v_{\\sigma(i)} \\quad \\text{for } i=1,2,3.\n$$\nThis expresses that the columns of $P$ must be the leaked eigenvectors, up to an unknown ordering (permutation) and an independent nonzero scaling per column.\n\nMoreover, even if $K$ were known, $P$ would not be unique: for any invertible diagonal matrix $S=\\operatorname{diag}(s_{1},s_{2},s_{3})$ with nonzero $s_{i}$, define $P'=P S$. Then\n$$\nP' D (P')^{-1} \\;=\\; (P S) D (S^{-1} P^{-1}) \\;=\\; P (S D S^{-1}) P^{-1} \\;=\\; P D P^{-1} \\;=\\; K,\n$$\nsince $S$ and $D$ are diagonal and commute, implying $S D S^{-1}=D$. Thus scaling the columns of $P$ by arbitrary nonzero factors leaves $K$ unchanged and cannot be resolved from $D$ and the eigenvectors alone. In addition, because the association between each leaked eigenvector and each eigenvalue $d_{i}$ is unknown, the ordering of the columns of $P$ is undetermined up to any permutation.\n\nConsequently:\n- Not A: the cryptanalyst does gain information; the columns of $P$ must lie in the spans of the leaked eigenvectors.\n- Not B: $P$ is not unique due to the ambiguities described.\n- Not C: column scaling freedom remains.\n- Not D: permutation ambiguity remains.\n\nThe sharpest conclusion is that $P$ is determined up to both a permutation of its columns and independent nonzero scalings of each column.\n\nTherefore, the correct choice is E.", "answer": "$$\\boxed{E}$$", "id": "1348662"}, {"introduction": "In real-world applications, cryptographic data is often corrupted by transmission noise, making direct algebraic solutions impossible. This practice moves beyond idealized scenarios to tackle the challenge of key recovery from imperfect data. You will learn to formulate this cryptanalytic task as a linear least-squares problem [@problem_id:1348664], a powerful technique used to find the \"best-fit\" solution when faced with noisy measurements.", "problem": "A cryptanalyst is analyzing a simplified linear encryption scheme. The scheme maps letters of the English alphabet to integers (A=0, B=1, ..., Z=25). A plaintext message is broken into pairs of letters, which are represented as 2-element column vectors $\\vec{p}$. Each plaintext vector is then encrypted into a ciphertext vector $\\vec{c}$ using a secret $2 \\times 2$ matrix $K$ via the matrix-vector product $\\vec{c} = K \\vec{p}$. The resulting vectors are transmitted over a noisy channel.\n\nThe analyst intercepts three plaintext-ciphertext pairs. Due to noise, the received vectors, denoted $\\vec{c'}_i$, are not identical to the original $\\vec{c}_i$. However, it is known that the original key matrix $K$ has integer entries. The intercepted plaintext vectors and the corresponding noisy received ciphertext vectors are as follows:\n\nPlaintext vectors:\n$$ \\vec{p}_1 = \\begin{pmatrix} 7 \\\\ 8 \\end{pmatrix}, \\quad \\vec{p}_2 = \\begin{pmatrix} 0 \\\\ 19 \\end{pmatrix}, \\quad \\vec{p}_3 = \\begin{pmatrix} 14 \\\\ 13 \\end{pmatrix} $$\n\nNoisy received ciphertext vectors:\n$$ \\vec{c'}_1 = \\begin{pmatrix} 61.3 \\\\ 22.8 \\end{pmatrix}, \\quad \\vec{c'}_2 = \\begin{pmatrix} 94.5 \\\\ 38.1 \\end{pmatrix}, \\quad \\vec{c'}_3 = \\begin{pmatrix} 107.1 \\\\ 40.4 \\end{pmatrix} $$\n\nYour task is to determine the most probable encryption matrix $K$. To do this, you first need to find the real-valued $2 \\times 2$ matrix, let's call it $K_{ls}$, that best fits the data in a least-squares sense. This means finding the matrix $K_{ls}$ that minimizes the sum of the squared Euclidean norms of the error vectors, which is given by the expression $\\sum_{i=1}^{3} \\|\\vec{c'}_i - K_{ls} \\vec{p}_i\\|^2$. The desired integer matrix $K$ is then found by rounding each entry of $K_{ls}$ to the nearest integer.\n\nPresent the four entries of the final integer matrix $K = \\begin{pmatrix} k_{11} & k_{12} \\\\ k_{21} & k_{22} \\end{pmatrix}$ as a single row matrix of the form $\\begin{pmatrix} k_{11} & k_{12} & k_{21} & k_{22} \\end{pmatrix}$.", "solution": "We model the data in matrix form. Let $P \\in \\mathbb{R}^{2 \\times 3}$ have columns $\\vec{p}_{1},\\vec{p}_{2},\\vec{p}_{3}$ and let $C' \\in \\mathbb{R}^{2 \\times 3}$ have columns $\\vec{c'}_{1},\\vec{c'}_{2},\\vec{c'}_{3}$. The least-squares estimate $K_{ls}$ minimizes the Frobenius norm $\\|C' - K_{ls}P\\|_{F}^{2}$. The normal equations for this linear least-squares problem are\n$$\nK_{ls}PP^{T} = C'P^{T},\n$$\nso, provided $PP^{T}$ is invertible,\n$$\nK_{ls} = C'P^{T}(PP^{T})^{-1}.\n$$\nForm the matrices\n$$\nP = \\begin{pmatrix} 7 & 0 & 14 \\\\ 8 & 19 & 13 \\end{pmatrix}, \\quad\nC' = \\begin{pmatrix} 61.3 & 94.5 & 107.1 \\\\ 22.8 & 38.1 & 40.4 \\end{pmatrix}.\n$$\nCompute\n$$\nPP^{T} = \\sum_{i=1}^{3} \\vec{p}_{i}\\vec{p}_{i}^{T}\n= \\begin{pmatrix} 245 & 238 \\\\ 238 & 594 \\end{pmatrix},\n$$\nwith determinant\n$$\n\\det(PP^{T}) = 245 \\cdot 594 - 238 \\cdot 238 = 88886 \\neq 0,\n$$\nso\n$$\n(PP^{T})^{-1} = \\frac{1}{88886}\\begin{pmatrix} 594 & -238 \\\\ -238 & 245 \\end{pmatrix}.\n$$\nNext,\n$$\nC'P^{T} = \\sum_{i=1}^{3} \\vec{c'}_{i}\\vec{p}_{i}^{T}\n= \\begin{pmatrix} 1928.5 & 3678.2 \\\\ 725.2 & 1431.5 \\end{pmatrix}.\n$$\nThus\n$$\nK_{ls} = \\left(\\begin{pmatrix} 1928.5 & 3678.2 \\\\ 725.2 & 1431.5 \\end{pmatrix}\n\\begin{pmatrix} 594 & -238 \\\\ -238 & 245 \\end{pmatrix}\\right)\\frac{1}{88886}.\n$$\nCompute the numerator product:\n$$\n\\begin{pmatrix}\n1928.5 \\cdot 594 + 3678.2 \\cdot (-238) & 1928.5 \\cdot (-238) + 3678.2 \\cdot 245 \\\\\n725.2 \\cdot 594 + 1431.5 \\cdot (-238) & 725.2 \\cdot (-238) + 1431.5 \\cdot 245\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n270217.3 & 442176 \\\\\n90071.8 & 178119.9\n\\end{pmatrix}.\n$$\nTherefore\n$$\nK_{ls} = \\frac{1}{88886}\\begin{pmatrix}\n270217.3 & 442176 \\\\\n90071.8 & 178119.9\n\\end{pmatrix}\n\\approx\n\\begin{pmatrix}\n3.0400 & 4.9746 \\\\\n1.0133 & 2.0039\n\\end{pmatrix}.\n$$\nRounding each entry to the nearest integer yields the most probable integer key matrix\n$$\nK = \\begin{pmatrix} 3 & 5 \\\\ 1 & 2 \\end{pmatrix}.\n$$\nAs a quick consistency check, $K\\vec{p}_{1} = \\begin{pmatrix} 61 \\\\ 23 \\end{pmatrix}$, $K\\vec{p}_{2} = \\begin{pmatrix} 95 \\\\ 38 \\end{pmatrix}$, and $K\\vec{p}_{3} = \\begin{pmatrix} 107 \\\\ 40 \\end{pmatrix}$, which are close to the received $\\vec{c'}_{i}$, as expected under small noise.", "answer": "$$\\boxed{\\begin{pmatrix} 3 & 5 & 1 & 2 \\end{pmatrix}}$$", "id": "1348664"}]}