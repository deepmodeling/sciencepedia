{"hands_on_practices": [{"introduction": "The primary motivation for many matrix factorizations, including LU decomposition, is to simplify the process of solving systems of linear equations. Decomposing a matrix $A$ into a lower triangular matrix $L$ and an upper triangular matrix $U$ transforms the single, potentially difficult problem of solving $A\\mathbf{x} = \\mathbf{b}$ into two much simpler steps: solving $L\\mathbf{y} = \\mathbf{b}$ via forward substitution and then $U\\mathbf{x} = \\mathbf{y}$ via back substitution. This first exercise [@problem_id:12944] walks you through this fundamental workflow, providing hands-on practice in both performing the decomposition and using it to find the solution to a concrete linear system.", "problem": "A system of linear equations can be represented in matrix form as $A\\mathbf{x} = \\mathbf{b}$. A powerful method for solving such a system is LU decomposition, where the matrix $A$ is decomposed into the product of a lower triangular matrix $L$ and an upper triangular matrix $U$, such that $A = LU$.\n\nThe original system $A\\mathbf{x} = \\mathbf{b}$ can then be rewritten as $LU\\mathbf{x} = \\mathbf{b}$. This equation can be solved in two steps:\n1.  Define an intermediate vector $\\mathbf{y} = U\\mathbf{x}$.\n2.  First, solve the system $L\\mathbf{y} = \\mathbf{b}$ for $\\mathbf{y}$ using forward substitution.\n3.  Then, solve the system $U\\mathbf{x} = \\mathbf{y}$ for $\\mathbf{x}$ using back substitution.\n\nConsider the following system of linear equations:\n$$\n\\begin{align*}\n2x_1 + x_2 + x_3 &= 5 \\\\\n4x_1 - 6x_2 &= -2 \\\\\n-2x_1 + 7x_2 + 2x_3 &= 9\n\\end{align*}\n$$\nThis system can be written as $A\\mathbf{x} = \\mathbf{b}$ where:\n$$\nA = \\begin{pmatrix} 2 & 1 & 1 \\\\ 4 & -6 & 0 \\\\ -2 & 7 & 2 \\end{pmatrix}, \\quad \\mathbf{x} = \\begin{pmatrix} x_1 \\\\ x_2 \\\\ x_3 \\end{pmatrix}, \\quad \\mathbf{b} = \\begin{pmatrix} 5 \\\\ -2 \\\\ 9 \\end{pmatrix}\n$$\nFirst, find the LU decomposition of matrix $A$, where $L$ is a lower triangular matrix with ones on the diagonal (Doolittle decomposition), and $U$ is an upper triangular matrix. Then, use this decomposition to solve for the vector $\\mathbf{x}$.\n\nYour task is to derive the value of the expression $x_1 + 2x_2 + 3x_3$.", "solution": "We seek $L,U$ with $A=LU$, where \n$$L=\\begin{pmatrix}1&0&0\\\\l_{21}&1&0\\\\l_{31}&l_{32}&1\\end{pmatrix},\\quad\nU=\\begin{pmatrix}u_{11}&u_{12}&u_{13}\\\\0&u_{22}&u_{23}\\\\0&0&u_{33}\\end{pmatrix}.$$\n\nMatch $A=\\begin{pmatrix}2&1&1\\\\4&-6&0\\\\-2&7&2\\end{pmatrix}$:\n\n1. First row of $U$:\n$$u_{11}=2,\\quad u_{12}=1,\\quad u_{13}=1.$$\n\n2. Column-1 of $L$:\n$$l_{21}=\\frac{a_{21}}{u_{11}}=\\frac{4}{2}=2,\\quad\nl_{31}=\\frac{a_{31}}{u_{11}}=\\frac{-2}{2}=-1.$$\n\n3. Second row/column:\n$$u_{22}=a_{22}-l_{21}u_{12}=-6-2\\cdot1=-8,\\quad\nu_{23}=a_{23}-l_{21}u_{13}=0-2\\cdot1=-2.$$\n$$l_{32}=\\frac{a_{32}-l_{31}u_{12}}{u_{22}}=\\frac{7-(-1)\\cdot1}{-8}=\\frac{8}{-8}=-1.$$\n\n4. Last diagonal:\n$$u_{33}=a_{33}-l_{31}u_{13}-l_{32}u_{23}\n=2-(-1)\\cdot1-(-1)\\cdot(-2)=2+1-2=1.$$\n\nThus\n$$L=\\begin{pmatrix}1&0&0\\\\2&1&0\\\\-1&-1&1\\end{pmatrix},\\quad\nU=\\begin{pmatrix}2&1&1\\\\0&-8&-2\\\\0&0&1\\end{pmatrix}.$$\n\nNext solve $L\\mathbf y=\\mathbf b$ with $\\mathbf b=(5,-2,9)^T$ by forward substitution:\n$$y_1=5,\\quad\ny_2=-2-2\\,y_1=-2-10=-12,\\quad\ny_3=9-(-1)\\,y_1-(-1)\\,y_2=9+5-12=2.$$\n\nThen solve $U\\mathbf x=\\mathbf y$ by back substitution:\n$$x_3=2,\\quad\n-8x_2-2x_3=-12\\implies-8x_2-4=-12\\implies x_2=1,$$\n$$2x_1+x_2+x_3=5\\implies2x_1+1+2=5\\implies x_1=1.$$\n\nFinally,\n$$x_1+2x_2+3x_3=1+2\\cdot1+3\\cdot2=9.$$", "answer": "$$\\boxed{9}$$", "id": "12944"}, {"introduction": "The standard LU decomposition algorithm, which is equivalent to Gaussian elimination without row swaps, can fail if a zero appears in a pivot position. To create a more robust and numerically stable algorithm, we introduce partial pivoting, which involves swapping rows to ensure the pivot element has the largest possible magnitude. This procedure is represented by the equation $PA = LU$, where $P$ is a permutation matrix that records the row interchanges. This exercise [@problem_id:2186343] presents a situation where pivoting is not just beneficial but necessary, giving you a clear, simple case for understanding the role of the permutation matrix $P$.", "problem": "Consider the matrix $A$ given by:\n$$A = \\begin{pmatrix} 0 & -3 \\\\ 2 & 6 \\end{pmatrix}$$\nOne of the fundamental matrix factorizations is the Lower-Upper (LU) decomposition with partial pivoting. This procedure finds a permutation matrix $P$, a unit lower triangular matrix $L$ (with ones on its diagonal), and an upper triangular matrix $U$ that satisfy the equation $PA = LU$.\n\nWhich of the following choices correctly provides the triplet of matrices $(P, L, U)$ for the given matrix $A$?\n\nA. $P = \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix}$, $L = \\begin{pmatrix} 1 & 0 \\\\ 1 & 1 \\end{pmatrix}$, $U = \\begin{pmatrix} 2 & 6 \\\\ 0 & -3 \\end{pmatrix}$\n\nB. $P = \\begin{pmatrix} 0 & 1 \\\\ 1 & 0 \\end{pmatrix}$, $L = \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix}$, $U = \\begin{pmatrix} 2 & 6 \\\\ 0 & -3 \\end{pmatrix}$\n\nC. $P = \\begin{pmatrix} 0 & 1 \\\\ 1 & 0 \\end{pmatrix}$, $L = \\begin{pmatrix} 1 & 0 \\\\ 3 & 1 \\end{pmatrix}$, $U = \\begin{pmatrix} 2 & 6 \\\\ 0 & -3 \\end{pmatrix}$\n\nD. $P = \\begin{pmatrix} 0 & 1 \\\\ 1 & 0 \\end{pmatrix}$, $L = \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix}$, $U = \\begin{pmatrix} 2 & 6 \\\\ 0 & 3 \\end{pmatrix}$", "solution": "We perform LU decomposition with partial pivoting on the matrix\n$$\nA=\\begin{pmatrix}0 & -3 \\\\ 2 & 6\\end{pmatrix}.\n$$\nPartial pivoting selects, in the first column, the row with the largest absolute value as the pivot. The entries are $|0|$ and $|2|$, so the pivot is in row $2$. Therefore, we swap rows $1$ and $2$ to form $PA$, with permutation matrix\n$$\nP=\\begin{pmatrix}0 & 1 \\\\ 1 & 0\\end{pmatrix}, \\quad PA = P A = \\begin{pmatrix}2 & 6 \\\\ 0 & -3\\end{pmatrix}.\n$$\nNow factor $PA$ without further pivoting as $LU$, with $L$ unit lower triangular and $U$ upper triangular. For a $2\\times 2$ matrix, the multiplier is\n$$\n\\ell_{21}=\\frac{(PA)_{21}}{(PA)_{11}}=\\frac{0}{2}=0.\n$$\nThus\n$$\nL=\\begin{pmatrix}1 & 0 \\\\ 0 & 1\\end{pmatrix}, \\quad U=\\begin{pmatrix}2 & 6 \\\\ 0 & -3\\end{pmatrix}.\n$$\nThese satisfy $PA=LU$:\n$$\n\\begin{pmatrix}0 & 1 \\\\ 1 & 0\\end{pmatrix}\\begin{pmatrix}0 & -3 \\\\ 2 & 6\\end{pmatrix}\n=\\begin{pmatrix}2 & 6 \\\\ 0 & -3\\end{pmatrix}\n=\\begin{pmatrix}1 & 0 \\\\ 0 & 1\\end{pmatrix}\\begin{pmatrix}2 & 6 \\\\ 0 & -3\\end{pmatrix}.\n$$\nComparing with the choices, this corresponds to option B. Options A and C do not satisfy $PA=LU$ for their listed $P$, $L$, $U$, and option D has an incorrect sign in the $(2,2)$ entry of $U$.", "answer": "$$\\boxed{B}$$", "id": "2186343"}, {"introduction": "Beyond its computational utility, LU factorization also serves as a diagnostic tool, revealing intrinsic properties of the matrix being analyzed. One of the most important properties of a square matrix is whether it is invertible or singular. This exercise [@problem_id:1375043] demonstrates how the LU decomposition process naturally detects singularity. By working through the factorization of a singular matrix, you will observe how this property manifests as a zero on the diagonal of the upper triangular factor $U$, directly connecting the decomposition process to the concept of matrix invertibility and the determinant.", "problem": "A common task in numerical linear algebra is to decompose a square matrix $A$ into the product of a lower triangular matrix $L$ and an upper triangular matrix $U$. This is known as the Lower-Upper (LU) factorization, or $A = LU$. This decomposition is a key step in efficiently solving systems of linear equations and calculating determinants.\n\nConsider the matrix $A$ given by:\n$$A = \\begin{pmatrix} 1 & 2 & 3 \\\\ 2 & 5 & 8 \\\\ 4 & 9 & 14 \\end{pmatrix}$$\nFind the LU factorization of $A$ where $L$ is a unit lower triangular matrix (i.e., it has ones on its main diagonal) and $U$ is an upper triangular matrix.\n\nProvide the matrix $U$ as your answer.", "solution": "We seek $A = LU$ with $L$ unit lower triangular and $U$ upper triangular. Use Doolittleâ€™s method, which corresponds to Gaussian elimination without pivoting, recording the multipliers in $L$.\n\nStart with\n$$\nA=\\begin{pmatrix}\n1 & 2 & 3 \\\\\n2 & 5 & 8 \\\\\n4 & 9 & 14\n\\end{pmatrix}, \\quad U^{(0)}=A, \\quad L=I.\n$$\nPivot at $(1,1)$ is $U^{(0)}_{11}=1\\neq 0$. Eliminate entries below it in column $1$:\n$$\nm_{21}=\\frac{U^{(0)}_{21}}{U^{(0)}_{11}}=\\frac{2}{1}=2,\\quad\nm_{31}=\\frac{U^{(0)}_{31}}{U^{(0)}_{11}}=\\frac{4}{1}=4.\n$$\nUpdate rows:\n$$\n\\text{Row}_{2}\\leftarrow \\text{Row}_{2}-m_{21}\\text{Row}_{1}:\\quad (2,5,8)-2(1,2,3)=(0,1,2),\n$$\n$$\n\\text{Row}_{3}\\leftarrow \\text{Row}_{3}-m_{31}\\text{Row}_{1}:\\quad (4,9,14)-4(1,2,3)=(0,1,2).\n$$\nRecord $L_{21}=m_{21}=2$, $L_{31}=m_{31}=4$. After this step,\n$$\nU^{(1)}=\\begin{pmatrix}\n1 & 2 & 3 \\\\\n0 & 1 & 2 \\\\\n0 & 1 & 2\n\\end{pmatrix}, \\quad\nL=\\begin{pmatrix}\n1 & 0 & 0 \\\\\n2 & 1 & 0 \\\\\n4 & 0 & 1\n\\end{pmatrix}.\n$$\nPivot at $(2,2)$ is $U^{(1)}_{22}=1\\neq 0$. Eliminate entry below it in column $2$:\n$$\nm_{32}=\\frac{U^{(1)}_{32}}{U^{(1)}_{22}}=\\frac{1}{1}=1.\n$$\nUpdate row:\n$$\n\\text{Row}_{3}\\leftarrow \\text{Row}_{3}-m_{32}\\text{Row}_{2}:\\quad (0,1,2)-1(0,1,2)=(0,0,0).\n$$\nRecord $L_{32}=m_{32}=1$. The final factors are\n$$\nU=\\begin{pmatrix}\n1 & 2 & 3 \\\\\n0 & 1 & 2 \\\\\n0 & 0 & 0\n\\end{pmatrix}, \\quad\nL=\\begin{pmatrix}\n1 & 0 & 0 \\\\\n2 & 1 & 0 \\\\\n4 & 1 & 1\n\\end{pmatrix}.\n$$\nA quick check confirms $LU=A$:\n$$\n\\begin{pmatrix}\n1 & 0 & 0 \\\\\n2 & 1 & 0 \\\\\n4 & 1 & 1\n\\end{pmatrix}\n\\begin{pmatrix}\n1 & 2 & 3 \\\\\n0 & 1 & 2 \\\\\n0 & 0 & 0\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n1 & 2 & 3 \\\\\n2 & 5 & 8 \\\\\n4 & 9 & 14\n\\end{pmatrix}=A.\n$$\nTherefore, the requested upper triangular factor is the $U$ above.", "answer": "$$\\boxed{\\begin{pmatrix}1&2&3\\\\0&1&2\\\\0&0&0\\end{pmatrix}}$$", "id": "1375043"}]}