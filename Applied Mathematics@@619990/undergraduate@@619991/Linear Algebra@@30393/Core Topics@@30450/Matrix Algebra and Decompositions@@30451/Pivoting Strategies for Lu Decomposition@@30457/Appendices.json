{"hands_on_practices": [{"introduction": "This first practice highlights why pivoting is a crucial component for achieving a stable and accurate LU decomposition. By working with a hypothetical matrix containing a very small element in the pivot position, you will directly observe how naive Gaussian elimination can introduce large numerical errors, a problem that partial pivoting effectively remedies [@problem_id:1383205].", "problem": "Consider the matrix $A$ defined as:\n$$\nA = \\begin{pmatrix} \\epsilon & 2 \\\\ 1 & 3 \\end{pmatrix}\n$$\nwhere $\\epsilon = 10^{-8}$ is a small positive constant.\n\nWe will perform two types of LU decomposition on matrix $A$.\n\nFirst, find the standard LU decomposition of $A$, such that $A = LU$. In this decomposition, $L$ is a unit lower triangular matrix (with ones on the main diagonal) and $U$ is an upper triangular matrix. Let the entry in the second row and second column of matrix $U$ be denoted by $u_{22}$.\n\nSecond, find the LU decomposition of $A$ using a partial pivoting strategy. This strategy results in a factorization of the form $PA = L'U'$, where $P$ is a permutation matrix chosen to maximize the absolute value of the pivot in each column, $L'$ is a unit lower triangular matrix, and $U'$ is an upper triangular matrix. Let the entry in the second row and second column of matrix $U'$ be denoted by $u'_{22}$.\n\nCalculate the numerical value of the sum $u_{22} + u'_{22}$.", "solution": "We use the Doolittle LU factorization without pivoting and then with partial pivoting.\n\nWithout pivoting, write $A=LU$ with\n$$\nL=\\begin{pmatrix}1&0\\\\ \\ell_{21}&1\\end{pmatrix},\\quad\nU=\\begin{pmatrix}u_{11}&u_{12}\\\\ 0&u_{22}\\end{pmatrix}.\n$$\nMatching $A=\\begin{pmatrix}\\epsilon&2\\\\ 1&3\\end{pmatrix}$ gives the standard relations:\n$$\nu_{11}=a_{11}=\\epsilon,\\quad u_{12}=a_{12}=2,\\quad \\ell_{21}=\\frac{a_{21}}{u_{11}}=\\frac{1}{\\epsilon},\n$$\nand\n$$\nu_{22}=a_{22}-\\ell_{21}u_{12}=3-\\frac{1}{\\epsilon}\\cdot 2=3-\\frac{2}{\\epsilon}.\n$$\n\nWith partial pivoting, we first swap rows because $|1|>|\\,\\epsilon\\,|$, yielding\n$$\nPA=\\begin{pmatrix}1&3\\\\ \\epsilon&2\\end{pmatrix}.\n$$\nFactor $PA=L'U'$ with\n$$\nL'=\\begin{pmatrix}1&0\\\\ \\ell'_{21}&1\\end{pmatrix},\\quad\nU'=\\begin{pmatrix}u'_{11}&u'_{12}\\\\ 0&u'_{22}\\end{pmatrix}.\n$$\nThen\n$$\nu'_{11}=1,\\quad u'_{12}=3,\\quad \\ell'_{21}=\\frac{\\epsilon}{u'_{11}}=\\epsilon,\n$$\nand\n$$\nu'_{22}=2-\\ell'_{21}u'_{12}=2-3\\epsilon.\n$$\n\nTherefore,\n$$\nu_{22}+u'_{22}=\\left(3-\\frac{2}{\\epsilon}\\right)+(2-3\\epsilon)=5-\\frac{2}{\\epsilon}-3\\epsilon.\n$$\nSubstitute $\\epsilon=10^{-8}$:\n$$\n\\frac{2}{\\epsilon}=2\\times 10^{8},\\qquad 3\\epsilon=3\\times 10^{-8},\n$$\nso\n$$\nu_{22}+u'_{22}=5-2\\times 10^{8}-3\\times 10^{-8}=-199999995.00000003.\n$$", "answer": "$$\\boxed{-199999995.00000003}$$", "id": "1383205"}, {"introduction": "Having seen the consequences of small pivots, we now focus on the core decision-making process within the partial pivoting strategy. This exercise asks you to determine the condition that necessitates a row interchange, isolating the fundamental rule of the algorithm. Understanding this decisive step is key to correctly applying pivoting in any context [@problem_id:1383208].", "problem": "In numerical linear algebra, when performing Gaussian elimination to find a matrix's Lower-Upper (LU) decomposition, it is often crucial to employ a pivoting strategy to enhance numerical stability and avoid division by zero. One common method is the partial pivoting strategy. In this strategy, for each column $k$ (starting from $k=1$), we identify the element with the largest absolute value in that column, on or below the diagonal (i.e., in rows $i \\ge k$). If this element is not the diagonal element $a_{kk}$, a row interchange is performed to move the element with the largest absolute value into the pivot position.\n\nConsider the matrix $A$:\n$$\nA = \\begin{pmatrix} x & 5 \\\\ 10 & 2 \\end{pmatrix}\n$$\nwhere $x$ is a real number.\n\nWhich of the following options describes the complete range of values for $x$ that would necessitate a row interchange in the first step of Gaussian elimination when using the partial pivoting strategy?\n\nA. $x > 10$\n\nB. $x < -10$\n\nC. $-10 < x < 10$\n\nD. $x < -10$ or $x > 10$\n\nE. $x = 10$ or $x = -10$", "solution": "In partial pivoting at step $k=1$, the pivot is chosen as the entry in column $1$ having the largest absolute value among rows $i \\geq 1$. For\n$$\nA=\\begin{pmatrix} x & 5 \\\\ 10 & 2 \\end{pmatrix},\n$$\nthe candidates are $|a_{11}|=|x|$ and $|a_{21}|=|10|=10$. A row interchange is required if and only if the largest absolute value occurs in a row different from the current pivot row, i.e., when $|x|<10$. If $|x|>10$, the diagonal entry is already the largest and no swap is needed. If $|x|=10$, there is a tie; since the diagonal entry is one of the maximizers, a swap is not necessitated. Therefore, a row interchange is necessary exactly for $-10<x<10$, which corresponds to option C.", "answer": "$$\\boxed{C}$$", "id": "1383208"}, {"introduction": "This final exercise integrates the concepts from the previous practices into a complete, multi-step procedure. You will trace the partial pivoting algorithm on a $3 \\times 3$ matrix, requiring you to identify the correct pivot and perform row swaps at each stage of elimination. This comprehensive practice will solidify your understanding of how the algorithm functions from start to finish [@problem_id:1383199].", "problem": "In numerical linear algebra, a Lower-Upper (LU) decomposition of a matrix $A$ is often performed using Gaussian elimination. To enhance numerical stability, a pivoting strategy is employed. One common method is partial pivoting.\n\nThe partial pivoting strategy at step $k$ of the elimination process (where the goal is to create zeros in column $k$ below the main diagonal) involves the following procedure:\n1.  Identify the element in column $k$ with the largest absolute value, searching from row $k$ down to the last row.\n2.  If this element is not in the pivot position (row $k$, column $k$), perform a row swap to move the row containing this element to row $k$.\n\nFor a $3 \\times 3$ matrix, this process involves two elimination steps: first, to create zeros below the pivot in column $1$, and second, to create a zero below the pivot in column $2$.\n\nWhich of the following non-singular $3 \\times 3$ matrices requires a row swap at **every** step of elimination (i.e., for both the first and second columns) when performing an LU decomposition using the partial pivoting strategy?\n\nA. $A = \\begin{pmatrix} 4 & 1 & 1 \\\\ 2 & 3 & 1 \\\\ 1 & 1 & 2 \\end{pmatrix}$\n\nB. $B = \\begin{pmatrix} 1 & 1 & 1 \\\\ 2 & 3 & 1 \\\\ 4 & 4 & 1 \\end{pmatrix}$\n\nC. $C = \\begin{pmatrix} 1 & 3 & 1 \\\\ 2 & 2 & 1 \\\\ 4 & 4 & 1 \\end{pmatrix}$\n\nD. $D = \\begin{pmatrix} 4 & 4 & 1 \\\\ 2 & 2 & 1 \\\\ 1 & 3 & 1 \\end{pmatrix}$", "solution": "Under partial pivoting at step $k$, the pivot is chosen as the entry in column $k$ with maximal absolute value among rows $k,\\ldots,n$. If the maximal entry is not already in row $k$, a row swap is performed. For a $3\\times 3$ system, we check steps $k=1$ and $k=2$.\n\nMatrix A: $A=\\begin{pmatrix}4&1&1\\\\2&3&1\\\\1&1&2\\end{pmatrix}$. In column $1$, the absolute values are $|4|,|2|,|1|$ with maximum $4$ already in row $1$, so no swap at step $1$. Hence A does not require a swap at every step.\n\nMatrix B: $B=\\begin{pmatrix}1&1&1\\\\2&3&1\\\\4&4&1\\end{pmatrix}$. Step $1$: column $1$ has $|1|,|2|,|4|$; maximum $4$ is in row $3$, so swap row $1$ and row $3$ to get\n$$\n\\begin{pmatrix}\n4&4&1\\\\\n2&3&1\\\\\n1&1&1\n\\end{pmatrix}.\n$$\nEliminate below the pivot with multipliers $m_{21}=\\frac{2}{4}=\\frac{1}{2}$ and $m_{31}=\\frac{1}{4}$:\n$$\n\\text{Row}_{2}\\leftarrow \\text{Row}_{2}-\\tfrac{1}{2}\\text{Row}_{1}:\\ (0,\\ 1,\\ \\tfrac{1}{2}),\n\\quad\n\\text{Row}_{3}\\leftarrow \\text{Row}_{3}-\\tfrac{1}{4}\\text{Row}_{1}:\\ (0,\\ 0,\\ \\tfrac{3}{4}),\n$$\nso after step $1$ the matrix is\n$$\n\\begin{pmatrix}\n4&4&1\\\\\n0&1&\\tfrac{1}{2}\\\\\n0&0&\\tfrac{3}{4}\n\\end{pmatrix}.\n$$\nStep $2$: in column $2$ (rows $2$ and $3$), the absolute values are $|1|$ and $|0|$, so the maximum is already in row $2$; no swap at step $2$. Hence B does not require a swap at every step.\n\nMatrix C: $C=\\begin{pmatrix}1&3&1\\\\2&2&1\\\\4&4&1\\end{pmatrix}$. Step $1$: column $1$ has $|1|,|2|,|4|$; maximum $4$ in row $3$, so swap row $1$ and row $3$:\n$$\n\\begin{pmatrix}\n4&4&1\\\\\n2&2&1\\\\\n1&3&1\n\\end{pmatrix}.\n$$\nEliminate below with $m_{21}=\\frac{2}{4}=\\frac{1}{2}$ and $m_{31}=\\frac{1}{4}$:\n$$\n\\text{Row}_{2}\\leftarrow \\text{Row}_{2}-\\tfrac{1}{2}\\text{Row}_{1}:\\ (0,\\ 0,\\ \\tfrac{1}{2}),\n\\quad\n\\text{Row}_{3}\\leftarrow \\text{Row}_{3}-\\tfrac{1}{4}\\text{Row}_{1}:\\ (0,\\ 2,\\ \\tfrac{3}{4}),\n$$\nso after step $1$ the matrix is\n$$\n\\begin{pmatrix}\n4&4&1\\\\\n0&0&\\tfrac{1}{2}\\\\\n0&2&\\tfrac{3}{4}\n\\end{pmatrix}.\n$$\nStep $2$: in column $2$ (rows $2$ and $3$), the absolute values are $|0|$ and $|2|$; the maximum is in row $3$, not row $2$, so a swap is required at step $2$. Hence C requires a swap at both steps.\n\nMatrix D: $D=\\begin{pmatrix}4&4&1\\\\2&2&1\\\\1&3&1\\end{pmatrix}$. In column $1$, the absolute values are $|4|,|2|,|1|$ with maximum $4$ already in row $1$, so no swap at step $1$. Hence D does not require a swap at every step.\n\nTherefore, only matrix C requires a row swap at both elimination steps under partial pivoting.", "answer": "$$\\boxed{C}$$", "id": "1383199"}]}