{"hands_on_practices": [{"introduction": "The Gram-Schmidt process provides a fundamental algorithm for constructing the QR factorization of a matrix. This hands-on practice [@problem_id:1385295] will guide you through the concrete computational steps of this method. By systematically orthogonalizing and normalizing the column vectors of a matrix, you will build the matrices $Q$ and $R$ from the ground up, solidifying your understanding of this core procedure in linear algebra.", "problem": "Consider the matrix $A$ given by:\n$$A = \\begin{pmatrix} 1 & 1 \\\\ 2 & 0 \\\\ 2 & -1 \\end{pmatrix}$$\nA QR factorization of $A$ is a decomposition $A = QR$, where $Q$ is a matrix with orthonormal columns and $R$ is an upper triangular matrix. Find the matrix $R$ in the QR factorization of $A$ obtained by applying the Gram-Schmidt process to the columns of $A$, taken in their given order from left to right. The process must be normalized such that the diagonal entries of the matrix $R$ are positive.", "solution": "Let the columns of $A$ be $\\mathbf{a}_{1}$ and $\\mathbf{a}_{2}$ with\n$$\\mathbf{a}_{1}=\\begin{pmatrix}1\\\\2\\\\2\\end{pmatrix}, \\quad \\mathbf{a}_{2}=\\begin{pmatrix}1\\\\0\\\\-1\\end{pmatrix}.$$\nClassical Gram-Schmidt proceeds as follows.\n\nFirst, compute $r_{11}=\\|\\mathbf{a}_{1}\\|$ and $\\mathbf{q}_{1}=\\mathbf{a}_{1}/r_{11}$:\n$$r_{11}=\\|\\mathbf{a}_{1}\\|=\\sqrt{1^{2}+2^{2}+2^{2}}=\\sqrt{9}=3,$$\n$$\\mathbf{q}_{1}=\\frac{1}{3}\\begin{pmatrix}1\\\\2\\\\2\\end{pmatrix}=\\begin{pmatrix}\\frac{1}{3}\\\\\\frac{2}{3}\\\\\\frac{2}{3}\\end{pmatrix}.$$\n\nNext, compute $r_{12}=\\mathbf{q}_{1}^{T}\\mathbf{a}_{2}$:\n$$r_{12}=\\begin{pmatrix}\\frac{1}{3}&\\frac{2}{3}&\\frac{2}{3}\\end{pmatrix}\\begin{pmatrix}1\\\\0\\\\-1\\end{pmatrix}=\\frac{1}{3}-\\frac{2}{3}=-\\frac{1}{3}.$$\n\nForm $\\mathbf{u}_{2}=\\mathbf{a}_{2}-r_{12}\\mathbf{q}_{1}$ and then $r_{22}=\\|\\mathbf{u}_{2}\\|$:\n$$\\mathbf{u}_{2}=\\mathbf{a}_{2}-\\left(-\\frac{1}{3}\\right)\\mathbf{q}_{1}=\\mathbf{a}_{2}+\\frac{1}{3}\\mathbf{q}_{1}=\\begin{pmatrix}1\\\\0\\\\-1\\end{pmatrix}+\\begin{pmatrix}\\frac{1}{9}\\\\\\frac{2}{9}\\\\\\frac{2}{9}\\end{pmatrix}=\\begin{pmatrix}\\frac{10}{9}\\\\\\frac{2}{9}\\\\-\\frac{7}{9}\\end{pmatrix},$$\n$$r_{22}=\\|\\mathbf{u}_{2}\\|=\\sqrt{\\left(\\frac{10}{9}\\right)^{2}+\\left(\\frac{2}{9}\\right)^{2}+\\left(-\\frac{7}{9}\\right)^{2}}=\\sqrt{\\frac{100+4+49}{81}}=\\sqrt{\\frac{153}{81}}=\\frac{\\sqrt{17}}{3}.$$\n\nWith the convention that diagonal entries are positive, we take\n$$r_{11}=3,\\quad r_{12}=-\\frac{1}{3},\\quad r_{22}=\\frac{\\sqrt{17}}{3}.$$\nTherefore, the upper triangular matrix $R$ is\n$$R=\\begin{pmatrix}3 & -\\frac{1}{3}\\\\ 0 & \\frac{\\sqrt{17}}{3}\\end{pmatrix}.$$", "answer": "$$\\boxed{\\begin{pmatrix}3 & -\\frac{1}{3}\\\\ 0 & \\frac{\\sqrt{17}}{3}\\end{pmatrix}}$$", "id": "1385295"}, {"introduction": "Beyond mechanical computation, a deep understanding of QR factorization comes from recognizing its geometric meaning. This exercise [@problem_id:1385311] explores a special, insightful case where the columns of the matrix are already mutually orthogonal. Solving this problem by inspection, rather than by the full Gram-Schmidt algorithm, will reveal the direct and elegant relationship between the column norms and the structure of the resulting diagonal $R$ matrix.", "problem": "Consider the matrix $A$ given by\n$$\nA = \\begin{pmatrix} 3 & 4 & 0 \\\\ 4 & -3 & 0 \\\\ 0 & 0 & 2 \\end{pmatrix}\n$$\nThe columns of this matrix, let's call them $\\mathbf{a}_1, \\mathbf{a}_2, \\mathbf{a}_3$, are mutually orthogonal. Any matrix $A$ with linearly independent columns can be written as a product $A=QR$, where $Q$ is a matrix whose columns form an orthonormal set, and $R$ is an invertible upper triangular matrix with positive diagonal entries. This is known as the QR factorization of $A$.\n\nFind the matrix $R$ for the given matrix $A$.", "solution": "Let the columns of $A$ be $\\mathbf{a}_{1}, \\mathbf{a}_{2}, \\mathbf{a}_{3}$. Since the columns are mutually orthogonal and nonzero, we can form an orthonormal set by normalizing each column:\n$$\n\\mathbf{q}_{i}=\\frac{\\mathbf{a}_{i}}{\\|\\mathbf{a}_{i}\\|} \\quad \\text{for } i=1,2,3.\n$$\nIn the QR factorization $A=QR$ with $Q=[\\mathbf{q}_{1}\\ \\mathbf{q}_{2}\\ \\mathbf{q}_{3}]$ having orthonormal columns and $R$ upper triangular with positive diagonal entries, the entries of $R$ are given by\n$$\nr_{ij}=\\mathbf{q}_{i}^{T}\\mathbf{a}_{j} \\quad \\text{for } i\\leq j.\n$$\nBecause the columns of $A$ are mutually orthogonal, we have $\\mathbf{a}_{i}^{T}\\mathbf{a}_{j}=0$ for $i\\neq j$, hence for $i<j$,\n$$\nr_{ij}=\\mathbf{q}_{i}^{T}\\mathbf{a}_{j}=\\frac{\\mathbf{a}_{i}^{T}\\mathbf{a}_{j}}{\\|\\mathbf{a}_{i}\\|}=0.\n$$\nTherefore $R$ is diagonal with\n$$\nr_{ii}=\\mathbf{q}_{i}^{T}\\mathbf{a}_{i}=\\frac{\\mathbf{a}_{i}^{T}\\mathbf{a}_{i}}{\\|\\mathbf{a}_{i}\\|}=\\|\\mathbf{a}_{i}\\| \\quad \\text{and} \\quad r_{ij}=0 \\text{ for } i\\neq j.\n$$\nCompute the norms:\n$$\n\\|\\mathbf{a}_{1}\\|=\\sqrt{3^{2}+4^{2}+0^{2}}=5,\\quad\n\\|\\mathbf{a}_{2}\\|=\\sqrt{4^{2}+(-3)^{2}+0^{2}}=5,\\quad\n\\|\\mathbf{a}_{3}\\|=\\sqrt{0^{2}+0^{2}+2^{2}}=2.\n$$\nThus\n$$\nR=\\begin{pmatrix}\n5 & 0 & 0 \\\\\n0 & 5 & 0 \\\\\n0 & 0 & 2\n\\end{pmatrix}.\n$$", "answer": "$$\\boxed{\\begin{pmatrix}5 & 0 & 0 \\\\ 0 & 5 & 0 \\\\ 0 & 0 & 2\\end{pmatrix}}$$", "id": "1385311"}, {"introduction": "The true power of QR factorization lies in its applications, particularly in solving real-world computational problems. This practice [@problem_id:1057223] demonstrates how the decomposition can be used to efficiently and stably find the least-squares solution to an overdetermined system of linear equations. By applying QR factorization in this context, you will see how it transforms a complex problem into a much simpler one involving an upper triangular system.", "problem": "Consider the overdetermined linear system $A\\mathbf{x} = \\mathbf{b}$, where  \n$$  \nA = \\begin{bmatrix}  \n\\cos \\theta & -\\sin \\theta \\\\  \n\\sin \\theta & \\cos \\theta \\\\  \n1 & 0  \n\\end{bmatrix}, \\quad \\mathbf{b} = \\begin{bmatrix} 0 \\\\ 0 \\\\ 1 \\end{bmatrix}.  \n$$  \nUsing QR factorization, solve this system in the least squares sense for the specific angle $\\theta = \\frac{\\pi}{2}$. Report the value of the first component, $x_1$, of the solution vector $\\mathbf{x}$.", "solution": "For $\\theta=\\pi/2$ we have  \n$$A=\\begin{bmatrix}0-1\\\\10\\\\10\\end{bmatrix},\\quad \\mathbf{b}=\\begin{bmatrix}0\\\\0\\\\1\\end{bmatrix}.$$  \nDenote the columns of A by $\\mathbf{a}_1=(0,1,1)^T$ and $\\mathbf{a}_2=(-1,0,0)^T$.  \n1. Gramâ€“Schmidt:  \n   $\\mathbf{u}_1=\\mathbf{a}_1,\\quad\\|\\mathbf{u}_1\\|=\\sqrt{2},\\quad \\mathbf{q}_1=\\frac{\\mathbf{u}_1}{\\sqrt{2}}.$  \n   Since $\\mathbf{q}_1^T\\mathbf{a}_2 = 0$, the columns are orthogonal. Thus, $\\mathbf{u}_2=\\mathbf{a}_2-(\\mathbf{q}_1^T\\mathbf{a}_2)\\mathbf{q}_1=\\mathbf{a}_2$.\n   $\\|\\mathbf{u}_2\\|=1$, so $\\mathbf{q}_2=\\mathbf{a}_2.$  \n2. Thus  \n$$Q=\\begin{bmatrix}0-1\\\\1/\\sqrt{2}0\\\\1/\\sqrt{2}0\\end{bmatrix},\\quad\nR=\\begin{pmatrix}\\sqrt{2}0\\\\01\\end{pmatrix}.$$  \n3. Compute $Q^T\\mathbf{b}$:  \n$$Q^T\\mathbf{b}=\\begin{pmatrix}\\mathbf{q}_1^T\\mathbf{b}\\\\\\mathbf{q}_2^T\\mathbf{b}\\end{pmatrix}\n=\\begin{pmatrix}1/\\sqrt{2}\\\\0\\end{pmatrix}.$$  \n4. Solve $R\\mathbf{x}=Q^T\\mathbf{b}$:  \n$$\\sqrt{2}\\,x_1=\\frac{1}{\\sqrt{2}}\\implies x_1=\\frac{1}{2},\\qquad x_2=0.$$", "answer": "$$\\boxed{\\frac{1}{2}}$$", "id": "1057223"}]}