{"hands_on_practices": [{"introduction": "The Tutte matrix offers a remarkable bridge between algebra and graph theory, allowing us to study matchings using linear algebraic tools. By constructing this symbolic matrix and calculating its determinant, we can determine if a graph has a perfect matching. This exercise [@problem_id:1547389] provides hands-on practice in building the Tutte matrix for a wheel graph and exploring the profound connection between the non-zero value of its determinant and the existence of perfect matchings.", "problem": "Consider the wheel graph $W_5$. This graph consists of a set of six vertices $V = \\{v_0, v_1, v_2, v_3, v_4, v_5\\}$. The vertex $v_0$ is a central hub, connected to each of the other five vertices. These five vertices, $\\{v_1, v_2, v_3, v_4, v_5\\}$, form a cycle graph $C_5$ in that order, meaning the edges are $(v_1, v_2), (v_2, v_3), (v_3, v_4), (v_4, v_5)$, and $(v_5, v_1)$.\n\nThe Tutte matrix $T(G)$ of a graph $G$ with vertices ordered $v_0, v_1, \\ldots, v_{n-1}$ is an $n \\times n$ skew-symmetric matrix. Its entries are defined by a set of distinct indeterminates (variables) associated with the edges of the graph. For each edge $(v_i, v_j)$ in the graph with $i < j$, the entry $T_{ij}$ is set to a variable $x_{ij}$, and the entry $T_{ji}$ is set to $-x_{ij}$. All other entries, including the diagonal, are zero.\n\nFor the wheel graph $W_5$ with vertices ordered $v_0, v_1, v_2, v_3, v_4, v_5$, we assign variables to edges as follows:\n- For the \"spoke\" edges connecting the center $v_0$ to the cycle vertices $v_i$, we use the variables $s_i$. That is, for $i \\in \\{1, 2, 3, 4, 5\\}$, the variable for the edge $(v_0, v_i)$ is $x_{0i} = s_i$.\n- For the \"cycle\" edges, we use the variables $c_i$. Specifically, for the edges $(v_1, v_2)$, $(v_2, v_3)$, $(v_3, v_4)$, and $(v_4, v_5)$, the variables are $x_{12} = c_1$, $x_{23} = c_2$, $x_{34} = c_3$, and $x_{45} = c_4$, respectively. For the edge connecting $v_1$ and $v_5$, the corresponding variable is $x_{15} = c_5$.\n\nYour task is to calculate the determinant of the Tutte matrix $T(W_5)$ for this specific graph and variable assignment. Present your answer as a polynomial expression in terms of the variables $s_1, \\ldots, s_5$ and $c_1, \\ldots, c_5$.", "solution": "We use that for any skew-symmetric matrix of even order, the determinant equals the square of its Pfaffian:\n$$\n\\det T(W_{5})=\\operatorname{Pf}(T(W_{5}))^{2}.\n$$\nFor the Tutte matrix, the Pfaffian is a signed sum over all perfect matchings $M$ of the graph:\n$$\n\\operatorname{Pf}(T(W_{5}))=\\sum_{M}\\epsilon(M)\\prod_{(i,j)\\in M,\\ i<j}T_{ij},\n$$\nwhere $\\epsilon(M)$ is the sign of the permutation that maps the ordered list of vertices to the concatenation $(i_{1},j_{1},i_{2},j_{2},i_{3},j_{3})$ formed by the matching pairs $(i_{k},j_{k})$ with $i_{k}<j_{k}$ and $i_{1}<i_{2}<i_{3}$.\n\nIn $W_{5}$, every perfect matching must use exactly one spoke $(v_{0},v_{k})$, and the remaining four cycle vertices are matched by two disjoint cycle edges. There are exactly five perfect matchings, one for each choice $k\\in\\{1,2,3,4,5\\}$:\n- For $k=1$: $(0,1),(2,3),(4,5)$. Ordered pairs: $(0,1),(2,3),(4,5)$, sequence $(0,1,2,3,4,5)$ has even parity, hence sign $+$. Contribution: $s_{1}c_{2}c_{4}$.\n- For $k=2$: $(0,2),(1,5),(3,4)$. Ordered pairs: $(0,2),(1,5),(3,4)$, sequence $(0,2,1,5,3,4)$ has $3$ inversions, odd parity, sign $-$. Contribution: $-s_{2}c_{5}c_{3}$.\n- For $k=3$: $(0,3),(1,2),(4,5)$. Ordered pairs: $(0,3),(1,2),(4,5)$, sequence $(0,3,1,2,4,5)$ has $2$ inversions, even parity, sign $+$. Contribution: $s_{3}c_{1}c_{4}$.\n- For $k=4$: $(0,4),(1,5),(2,3)$. Ordered pairs: $(0,4),(1,5),(2,3)$, sequence $(0,4,1,5,2,3)$ has $5$ inversions, odd parity, sign $-$. Contribution: $-s_{4}c_{2}c_{5}$.\n- For $k=5$: $(0,5),(1,2),(3,4)$. Ordered pairs: $(0,5),(1,2),(3,4)$, sequence $(0,5,1,2,3,4)$ has $4$ inversions, even parity, sign $+$. Contribution: $s_{5}c_{1}c_{3}$.\n\nTherefore,\n$$\n\\operatorname{Pf}(T(W_{5}))=s_{1}c_{2}c_{4}-s_{2}c_{5}c_{3}+s_{3}c_{1}c_{4}-s_{4}c_{2}c_{5}+s_{5}c_{1}c_{3}.\n$$\nSquaring yields the determinant:\n$$\n\\det T(W_{5})=\\left(s_{1}c_{2}c_{4}-s_{2}c_{5}c_{3}+s_{3}c_{1}c_{4}-s_{4}c_{2}c_{5}+s_{5}c_{1}c_{3}\\right)^{2}.\n$$\nThis is a polynomial in $s_{1},\\ldots,s_{5},c_{1},\\ldots,c_{5}$ as required.", "answer": "$$\\boxed{\\left(s_{1}c_{2}c_{4}-s_{2}c_{5}c_{3}+s_{3}c_{1}c_{4}-s_{4}c_{2}c_{5}+s_{5}c_{1}c_{3}\\right)^{2}}$$", "id": "1547389"}, {"introduction": "While the Tutte matrix tells us *if* a perfect matching exists, Tutte's theorem provides a beautiful combinatorial reason *why* one might not. It states that a graph lacks a perfect matching if we can find a set of vertices $S$ whose removal leaves more odd-sized connected components than there are vertices in $S$. This practice problem [@problem_id:1547426] challenges you to identify such a \"Tutte set\" in a specially designed graph, giving you a concrete feel for this fundamental structural obstruction.", "problem": "Consider a graph $G$ constructed according to the following procedure. First, take a cycle graph on 8 vertices, labeled $v_1, v_2, \\ldots, v_8$ in clockwise order. This forms a $C_8$ cycle. To this graph, add a single \"long chord\" edge connecting the diametrically opposite vertices $v_1$ and $v_5$. Finally, introduce two new vertices, named $u$ and $w$. Add an edge connecting $u$ to $v_1$ and another edge connecting $w$ to $v_5$. The resulting graph $G$ has 10 vertices in total.\n\nAccording to a result related to the Tutte-Berge formula, a graph with an even number of vertices does not have a perfect matching if there exists a subset of vertices $S \\subset V(G)$ such that $o(G-S) > |S|$, where $|S|$ is the number of vertices in $S$ and $o(G-S)$ is the number of connected components in the subgraph $G-S$ that have an odd number of vertices.\n\nWhich of the following vertex sets $S$ demonstrates that the described graph $G$ does not possess a perfect matching by satisfying the condition $o(G-S) > |S|$?\n\nA. $S = \\{v_2, v_6\\}$\n\nB. $S = \\{v_1, v_5\\}$\n\nC. $S = \\{u, w\\}$\n\nD. $S = \\{v_3, v_7\\}$\n\nE. $S = \\{v_2, v_4, v_6, v_8\\}$", "solution": "We apply the Tutte-Berge condition: a graph with an even number of vertices has no perfect matching if there exists $S \\subset V(G)$ such that $o(G-S) > |S|$, where $o(G-S)$ is the number of connected components of $G-S$ with an odd number of vertices.\n\nWe evaluate each candidate set $S$.\n\nOption A: $S=\\{v_{2},v_{6}\\}$. Removing $v_{2}$ and $v_{6}$ leaves vertices $\\{v_{1},v_{3},v_{4},v_{5},v_{7},v_{8},u,w\\}$. The remaining edges include the chord $v_{1}v_{5}$, cycle edges $v_{3}v_{4}$, $v_{4}v_{5}$, $v_{7}v_{8}$, $v_{8}v_{1}$, and leaf edges $uv_{1}$, $wv_{5}$. All these vertices lie in a single connected component of size $8$ (even). Hence $o(G-S)=0<|S|=2$, so this does not certify.\n\nOption B: $S=\\{v_{1},v_{5}\\}$. Removing $v_{1}$ and $v_{5}$ leaves vertices $\\{v_{2},v_{3},v_{4},v_{6},v_{7},v_{8},u,w\\}$. The remaining edges are $v_{2}v_{3}$, $v_{3}v_{4}$ and $v_{6}v_{7}$, $v_{7}v_{8}$. Thus the components are the path $\\{v_{2},v_{3},v_{4}\\}$ (size $3$, odd), the path $\\{v_{6},v_{7},v_{8}\\}$ (size $3$, odd), the isolated vertex $\\{u\\}$ (size $1$, odd), and the isolated vertex $\\{w\\}$ (size $1$, odd). Therefore $o(G-S)=4$ and $|S|=2$, so $o(G-S)>|S|$ holds. This certifies that $G$ has no perfect matching.\n\nOption C: $S=\\{u,w\\}$. Removing $u$ and $w$ leaves the $8$-vertex connected graph on $\\{v_{1},\\dots,v_{8}\\}$ with the chord $v_{1}v_{5}$. Hence there is one even component, so $o(G-S)=0<|S|=2$, not a certificate.\n\nOption D: $S=\\{v_{3},v_{7}\\}$. Removing $v_{3}$ and $v_{7}$ leaves vertices $\\{v_{1},v_{2},v_{4},v_{5},v_{6},v_{8},u,w\\}$, which form a single connected component via cycle edges $v_{1}v_{2}$, $v_{4}v_{5}$, $v_{5}v_{6}$, $v_{8}v_{1}$, the chord $v_{1}v_{5}$, and leaves $uv_{1}$, $wv_{5}$. This component has size $8$ (even), so $o(G-S)=0<|S|=2$, not a certificate.\n\nOption E: $S=\\{v_{2},v_{4},v_{6},v_{8}\\}$. Removing these leaves $\\{v_{1},v_{3},v_{5},v_{7},u,w\\}$. The remaining edges are the chord $v_{1}v_{5}$ and leaves $uv_{1}$, $wv_{5}$. Thus there is one component $\\{u,v_{1},v_{5},w\\}$ of size $4$ (even) and two isolated vertices $\\{v_{3}\\}$ and $\\{v_{7}\\}$ (each odd). Hence $o(G-S)=2$ and $|S|=4$, so $o(G-S)\\leq|S|$, not a certificate.\n\nTherefore, only $S=\\{v_{1},v_{5}\\}$ satisfies $o(G-S) > |S|$.", "answer": "$$\\boxed{B}$$", "id": "1547426"}, {"introduction": "The Tutte-Berge formula generalizes Tutte's theorem, providing a powerful tool to calculate the exact size of a maximum matching in any graph, not just to test for perfect matchings. The formula hinges on finding the graph's \"deficiency,\" determined by a vertex subset $S$ that maximizes the quantity $o(G-S) - |S|$. In this problem [@problem_id:1547422], you will apply the full power of the Tutte-Berge formula to a constructed graph to determine the size of its maximum matching, solidifying your understanding of this cornerstone result.", "problem": "A graph $G$ is constructed on 10 vertices. The vertex set $V$ is partitioned into five disjoint sets: $A=\\{a_1\\}$, $B=\\{b_1\\}$, $C=\\{c_1, c_2, c_3\\}$, $D=\\{d_1, d_2, d_3\\}$, and $S=\\{s_1, s_2\\}$. The edges of $G$ are defined as follows:\n1. The subgraph induced on the vertex set $C$ is a complete graph ($K_3$).\n2. The subgraph induced on the vertex set $D$ is a complete graph ($K_3$).\n3. For every vertex $v \\in A \\cup B \\cup C \\cup D$ and every vertex $s \\in S$, the edge $(v,s)$ exists in $G$.\n4. No other edges are present in $G$ apart from those specified by the rules above.\n\nWhat is the size of a maximum matching in the graph $G$?", "solution": "The size of a maximum matching, denoted by $\\nu(G)$, can be determined using the Tutte-Berge formula. For a graph $G$ with vertex set $V$, the formula relates $\\nu(G)$ to the number of vertices $|V|$ and the defect of the graph, $\\text{def}(G)$:\n$$2\\nu(G) = |V| - \\text{def}(G)$$\nThe defect is defined as the maximum value of $o(G-U) - |U|$ over all possible subsets $U$ of the vertex set $V$, where $o(G-U)$ denotes the number of connected components in the graph $G-U$ (the subgraph of $G$ induced by $V \\setminus U$) that have an odd number of vertices.\n$$\\text{def}(G) = \\max_{U \\subseteq V} \\{ o(G-U) - |U| \\}$$\nIn our problem, the total number of vertices is $|V| = |A|+|B|+|C|+|D|+|S| = 1+1+3+3+2 = 10$. We need to find $\\text{def}(G)$ by finding the set $U$ that maximizes $o(G-U) - |U|$.\n\nLet's analyze the expression $o(G-U) - |U|$ for different choices of $U \\subseteq V$. We can partition our analysis into cases based on the intersection of $U$ with the set $S=\\{s_1, s_2\\}$.\n\nCase 1: $U \\cap S = \\emptyset$. (i.e., $s_1 \\notin U$ and $s_2 \\notin U$)\nIn this case, both $s_1$ and $s_2$ are in the graph $G-U$. By construction, every vertex in $(A \\cup B \\cup C \\cup D) \\setminus U$ is connected to both $s_1$ and $s_2$. Therefore, any two vertices in $V \\setminus U$ have a path between them (e.g., through $s_1$), which means the graph $G-U$ is connected. There is only one component. The number of vertices in this component is $10 - |U|$.\nThe number of odd components $o(G-U)$ is 1 if $10 - |U|$ is odd, and 0 otherwise.\n- If $o(G-U) = 1$, then $10 - |U|$ is odd, which implies $|U|$ is odd. The value is $1 - |U|$, which is $\\le 0$ for any non-empty odd-sized $U$. If $U=\\emptyset$, $|U|=0$ is even, $o(G-\\emptyset)=0$. So $o(G-U)-|U| \\le 0$.\n- If $o(G-U) = 0$, the value is $0 - |U| \\le 0$.\nIn this case, the maximum value is 0 (achieved when $U = \\emptyset$).\n\nCase 2: $|U \\cap S| = 1$. (i.e., exactly one of $s_1, s_2$ is in $U$)\nLet's assume $s_1 \\in U$ and $s_2 \\notin U$ (the case $s_2 \\in U, s_1 \\notin U$ is symmetric). Every vertex in $(A \\cup B \\cup C \\cup D) \\setminus U$ is connected to $s_2$. Thus, all vertices in $V \\setminus U$ are in the same connected component. The graph $G-U$ is connected.\nSimilar to Case 1, $o(G-U)$ is either 0 or 1. Since $U$ must contain at least one vertex ($s_1$), $|U| \\ge 1$. The expression $o(G-U) - |U|$ is at most $1 - |U| \\le 1 - 1 = 0$.\n\nCase 3: $S \\subseteq U$. (i.e., $\\{s_1, s_2\\} \\subseteq U$)\nLet $U = S \\cup U'$, where $U' \\subseteq A \\cup B \\cup C \\cup D$. Then $|U| = |S| + |U'| = 2 + |U'|$.\nThe graph $G-U$ is the graph on the vertices $(A \\cup B \\cup C \\cup D) \\setminus U'$. When we remove the set $S$, all edges connecting to $S$ are removed. The remaining graph, $G-S$, has its edges only within $C$ and within $D$.\nThe components of $G-S$ are:\n- An isolated vertex $a_1$ (a $K_1$, which is odd).\n- An isolated vertex $b_1$ (a $K_1$, which is odd).\n- A complete graph on $C=\\{c_1, c_2, c_3\\}$ (a $K_3$, which is odd).\n- A complete graph on $D=\\{d_1, d_2, d_3\\}$ (a $K_3$, which is odd).\nSo, $G-S$ has 4 odd components.\nNow consider removing the additional vertices $U' \\subseteq A \\cup B \\cup C \\cup D$.\nLet's first test the specific choice $U=S$, which corresponds to $U'=\\emptyset$.\nFor $U=S$, $|U|=2$. The graph $G-S$ has 4 odd components, so $o(G-S)=4$.\nThe value of the expression is $o(G-S) - |S| = 4 - 2 = 2$.\n\nNow we need to check if removing more vertices (i.e., $U' \\neq \\emptyset$) could yield a larger value.\nLet $f(U) = o(G-U) - |U| = o((G-S)-U') - (2+|U'|)$.\nLet's analyze the effect of removing vertices from the components of $G-S$. Let $U'_A=U' \\cap A$, $U'_C=U' \\cap C$, etc.\n$o((G-S)-U') = o(\\{a_1\\}\\setminus U'_A) + o(\\{b_1\\}\\setminus U'_B) + o(K_3[C]\\setminus U'_C) + o(K_3[D]\\setminus U'_D)$.\nThe quantity we wish to maximize is $o((G-S)-U') - |U'| - 2$. To maximize this, we should maximize $g(U') = o((G-S)-U')-|U'|$.\nLet's analyze the contribution from each component.\n- For component $\\{a_1\\}$: if we remove $a_1$ ($|U'_A|=1$), we get 0 odd components. The change is $0-1=-1$. If we remove nothing ($|U'_A|=0$), we have 1 odd component. The value $o-k$ is $1-0=1$. So, we should not remove $a_1$.\n- For component $\\{b_1\\}$: Similarly, we should not remove $b_1$.\n- For component $K_3[C]$: Let $k_C = |U'_C|$.\n  - $k_C=0$: $K_3$ remains, $o=1$. Value $o-k_C = 1$.\n  - $k_C=1$: $K_2$ remains, $o=0$. Value $o-k_C = -1$.\n  - $k_C=2$: $K_1$ remains, $o=1$. Value $o-k_C = -1$.\n  - $k_C=3$: empty graph remains, $o=0$. Value $o-k_C = -3$.\n  The maximum contribution is 1, achieved when we remove 0 vertices from $C$.\n- For component $K_3[D]$: Similarly, the maximum contribution is 1, achieved when we remove 0 vertices from $D$.\n\nTo maximize $g(U')$, we should choose $U'$ such that it maximizes the contribution from each component of $G-S$. In all cases, this occurs when $U'$ is empty.\nSo, the maximum is achieved for $U'=\\emptyset$, which means $U=S$.\n\nCombining all cases, the maximum value of $o(G-U) - |U|$ is 2, achieved for $U=S$.\nTherefore, $\\text{def}(G) = 2$.\n\nFinally, we can find the size of the maximum matching $\\nu(G)$:\n$2\\nu(G) = |V| - \\text{def}(G) = 10 - 2 = 8$.\n$\\nu(G) = \\frac{8}{2} = 4$.\n\nThe size of a maximum matching in the graph $G$ is 4.\nTo verify, we can construct a matching of size 4. For instance, the set of edges $M = \\{(c_1, c_2), (d_1, d_2), (a_1, s_1), (b_1, s_2)\\}$ forms a valid matching. The total number of vertices covered is $2 \\times 4 = 8$. The two unmatched vertices are $c_3$ and $d_3$. The number of unmatched vertices, 2, equals the defect we calculated ($10 - 2\\nu(G) = \\text{def}(G) \\implies 10 - 8 = 2$), which confirms our answer.", "answer": "$$\\boxed{4}$$", "id": "1547422"}]}