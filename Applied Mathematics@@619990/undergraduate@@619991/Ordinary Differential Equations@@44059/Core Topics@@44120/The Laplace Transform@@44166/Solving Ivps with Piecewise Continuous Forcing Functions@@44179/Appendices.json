{"hands_on_practices": [{"introduction": "To begin, we'll explore a foundational scenario involving a first-order system subjected to an abrupt change. This problem [@problem_id:2200526] models drug concentration in the bloodstream, where the infusion rate is suddenly increased. By solving the system on two separate time intervals and ensuring the concentration is continuous at the point of change, you will practice the essential \"divide and conquer\" strategy for handling piecewise forcing functions.", "problem": "A patient is being treated with a new medication administered via an intravenous (IV) drip. The concentration of the drug in the patient's bloodstream, $C(t)$, measured in milligrams per liter (mg/L), can be modeled by the first-order linear differential equation:\n$$ \\frac{dC}{dt} + kC = f(t). $$\nHere, $t$ is the time in hours since the start of the infusion, $k$ is the constant elimination rate of the drug from the body (in units of hr$^{-1}$), and $f(t)$ represents the effective rate at which the drug concentration increases due to the infusion. Initially, the patient has none of the medication in their system.\n\nThe infusion is administered at a constant effective rate of $r_0$ (in mg/L/hr) for the first hour. After the first hour, to increase the therapeutic effect, the infusion rate is immediately doubled. Thus, the effective rate function $f(t)$ is a piecewise function defined as:\n$$ f(t) = \\begin{cases} r_0 & 0 \\le t \\le 1 \\\\ 2r_0 & t > 1 \\end{cases} $$\nAssuming the drug concentration $C(t)$ is a continuous function of time, determine the analytical expression for $C(t)$ for all $t \\ge 0$ in terms of $r_0$ and $k$.", "solution": "We are given the first-order linear ODE\n$$\n\\frac{dC}{dt} + k C = f(t),\n$$\nwith initial condition $C(0)=0$, where\n$$\nf(t) = \\begin{cases}\nr_0, & 0 \\le t \\le 1, \\\\\n2 r_0, & t > 1.\n\\end{cases}\n$$\nWe solve on each interval using the integrating factor method. The integrating factor is $\\mu(t)=\\exp\\!\\left(\\int k\\,dt\\right)=\\exp(k t)$, which yields\n$$\n\\frac{d}{dt}\\big(C(t)\\exp(k t)\\big)=f(t)\\exp(k t).\n$$\n\nFor $0 \\le t \\le 1$, we have $f(t)=r_0$. Integrating from $0$ to $t$ and using $C(0)=0$ gives\n$$\nC(t)\\exp(k t)-C(0)=r_0\\int_{0}^{t}\\exp(k s)\\,ds=\\frac{r_0}{k}\\big(\\exp(k t)-1\\big),\n$$\nso\n$$\nC(t)=\\frac{r_0}{k}\\big(1-\\exp(-k t)\\big), \\quad 0 \\le t \\le 1.\n$$\n\nFor $t>1$, we have $f(t)=2 r_0$. Integrate from $1$ to $t$ to enforce continuity at $t=1$:\n$$\nC(t)\\exp(k t)-C(1)\\exp(k\\cdot 1)=2 r_0\\int_{1}^{t}\\exp(k s)\\,ds=\\frac{2 r_0}{k}\\big(\\exp(k t)-\\exp(k)\\big).\n$$\nSolving for $C(t)$ gives\n$$\nC(t)=C(1)\\exp(-k(t-1))+\\frac{2 r_0}{k}\\big(1-\\exp(-k(t-1))\\big), \\quad t > 1.\n$$\nUsing the value from the first interval,\n$$\nC(1)=\\frac{r_0}{k}\\big(1-\\exp(-k)\\big),\n$$\nwe obtain\n$$\nC(t)=\\frac{r_0}{k}\\big(1-\\exp(-k)\\big)\\exp(-k(t-1))+\\frac{2 r_0}{k}\\big(1-\\exp(-k(t-1))\\big), \\quad t > 1.\n$$\nThis expression is continuous at $t=1$ because substituting $t=1$ yields $C(1)=\\frac{r_0}{k}\\big(1-\\exp(-k)\\big)$ from both sides.\n\nTherefore, the piecewise solution for all $t \\ge 0$ is as derived above.", "answer": "$$\\boxed{C(t)=\\begin{cases}\\frac{r_0}{k}\\left(1-\\exp(-k t)\\right), & 0\\le t\\le 1, \\\\ \\frac{r_0}{k}\\left(1-\\exp(-k)\\right)\\exp(-k(t-1))+\\frac{2 r_0}{k}\\left(1-\\exp(-k(t-1))\\right), & t>1.\\end{cases}}$$", "id": "2200526"}, {"introduction": "Building on the previous practice, this exercise introduces a forcing function defined by the minimum of two linear functions, a common way to represent capped or piecewise-linear processes. In the context of an RC circuit [@problem_id:2200506], your first task is to analyze the voltage source $V(t)$ to determine its explicit piecewise form and the point of transition. This problem highlights the importance of fully understanding the input signal before applying the solution method.", "problem": "Consider a simple series circuit consisting of a resistor with resistance $R = 100.0 \\, \\Omega$ and a capacitor with capacitance $C = 10.0 \\, \\text{mF}$. The circuit is driven by a time-varying voltage source $V(t)$. The charge $Q(t)$ on the capacitor is governed by the first-order linear ordinary differential equation:\n$$R\\frac{dQ}{dt} + \\frac{1}{C}Q = V(t)$$\nFor time $t \\ge 0$, the voltage source is defined by the function $V(t) = \\min(4t, 12-2t)$, where $V$ is in volts and $t$ is in seconds. The capacitor is initially uncharged, meaning $Q(0) = 0$.\n\nCalculate the charge on the capacitor at time $t = 3.0$ seconds. Express your answer in coulombs (C), rounded to four significant figures.", "solution": "The governing equation is a first-order linear ODE:\n$$R \\frac{dQ}{dt} + \\frac{1}{C} Q = V(t).$$\nWith $R = 100.0\\,\\Omega$ and $C = 10.0\\,\\text{mF} = 10.0 \\times 10^{-3}\\,\\text{F}$, we have $RC = 1$. Dividing the ODE by $R$ gives\n$$\\frac{dQ}{dt} + \\frac{1}{RC} Q = \\frac{V(t)}{R},$$\nwhich simplifies to\n$$\\frac{dQ}{dt} + Q = \\frac{V(t)}{100}.$$\nFor $t \\ge 0$, $V(t) = \\min(4t,\\,12 - 2t)$. The switch occurs where $4t = 12 - 2t$, i.e., $t = 2$. Thus,\n- For $0 \\le t \\le 2$: $V(t) = 4t$, so $\\frac{V(t)}{100} = \\frac{4t}{100} = 0.04\\,t$.\n- For $t \\ge 2$: $V(t) = 12 - 2t$, so $\\frac{V(t)}{100} = \\frac{12 - 2t}{100} = 0.12 - 0.02\\,t$.\n\nSolve on $[0,2]$ with $Q(0) = 0$. Using the integrating factor $\\mu(t) = \\exp\\!\\left(\\int 1\\,dt\\right) = \\exp(t)$,\n$$(Q \\exp(t))' = 0.04\\,t\\,\\exp(t).$$\nIntegrating from $0$ to $t \\in [0,2]$ and using $Q(0) = 0$,\n$$Q(t) \\exp(t) = \\int_{0}^{t} 0.04\\,s\\,\\exp(s)\\,ds.$$\nUsing $\\int s \\exp(s)\\,ds = (s - 1)\\exp(s)$, we obtain\n$$Q(t) \\exp(t) = 0.04\\left[(t - 1)\\exp(t) + 1\\right],$$\nso\n$$Q(t) = 0.04\\left[(t - 1) + \\exp(-t)\\right], \\quad 0 \\le t \\le 2.$$\nThus,\n$$Q(2) = 0.04\\left[1 + \\exp(-2)\\right].$$\n\nOn $[2,3]$, solve $\\frac{dQ}{dt} + Q = 0.12 - 0.02\\,t$ with initial condition $Q(2)$ as above. Using the same integrating factor,\n$$(Q \\exp(t))' = \\left(0.12 - 0.02\\,t\\right)\\exp(t).$$\nIntegrate from $2$ to $t \\in [2,3]$:\n$$Q(t) \\exp(t) - Q(2)\\exp(2) = \\int_{2}^{t} \\left(0.12 - 0.02\\,s\\right)\\exp(s)\\,ds.$$\nCompute the integral:\n$$\\int \\left(0.12 - 0.02\\,s\\right)\\exp(s)\\,ds = \\exp(s)\\left(0.14 - 0.02\\,s\\right),$$\nhence\n$$\\int_{2}^{t} \\left(0.12 - 0.02\\,s\\right)\\exp(s)\\,ds = \\exp(t)\\left(0.14 - 0.02\\,t\\right) - \\exp(2)\\left(0.10\\right).$$\nTherefore,\n$$Q(t) = \\exp(-t)\\left[Q(2)\\exp(2) - 0.10\\,\\exp(2)\\right] + \\left(0.14 - 0.02\\,t\\right).$$\nSubstitute $Q(2) = 0.04\\left[1 + \\exp(-2)\\right]$:\n$$Q(t) = \\exp(2 - t)\\left[-0.06 + 0.04\\,\\exp(-2)\\right] + \\left(0.14 - 0.02\\,t\\right).$$\nAt $t = 3$,\n$$Q(3) = 0.08 - 0.06\\,\\exp(-1) + 0.04\\,\\exp(-3).$$\nNumerically,\n$$Q(3) \\approx 0.08 - 0.06 \\times 0.3678794412 + 0.04 \\times 0.04978706837 \\approx 0.05991871626.$$\nRounded to four significant figures, the charge is $0.05992$ coulomb.", "answer": "$$\\boxed{0.05992}$$", "id": "2200506"}, {"introduction": "We now advance to second-order systems, which are fundamental to mechanics and engineering, and introduce the concept of a smooth forcing function. This problem [@problem_id:2200500] models a robotic arm driven by a quadratic spline, a type of input that changes continuously and without abrupt jerks. You will extend the piecewise solution technique by enforcing continuity for both the position and velocity, a critical requirement for realistic physical systems.", "problem": "A simplified model for the angular position of a robotic arm's actuator is described by a second-order linear ordinary differential equation. The arm is initially at rest in its equilibrium position, so its initial angle and angular velocity are both zero. The actuator applies a time-varying torque that acts as the forcing function for the system's motion. The torque profile is designed to be smooth, implemented as a quadratic spline function $g(t)$ which is continuous and has a continuous first derivative.\n\nThe equation of motion for the arm's angle $y(t)$ (in radians) is given by the following initial value problem:\n$$y'' + 4y = g(t), \\quad y(0) = 0, \\quad y'(0) = 0$$\nwhere $t$ is the time in seconds. The forcing function $g(t)$ is defined piecewise as:\n$$ g(t) = \\begin{cases} t^2 & \\text{for } 0 \\le t \\le \\pi \\\\ -t^2 + 4\\pi t - 2\\pi^2 & \\text{for } t > \\pi \\end{cases} $$\nCalculate the angle of the arm at time $t = 2\\pi$. Express your final answer as a symbolic expression in terms of $\\pi$.", "solution": "We solve the linear time-invariant second-order ODE with zero initial conditions by convolution with the impulse response. For $y''+4y=g(t)$ and $y(0)=0$, $y'(0)=0$, the solution is\n$$\ny(t)=\\int_{0}^{t} \\frac{\\sin\\!\\left(2(t-\\tau)\\right)}{2}\\,g(\\tau)\\,d\\tau.\n$$\nAt $t=2\\pi$ this becomes\n$$\ny(2\\pi)=\\frac{1}{2}\\int_{0}^{2\\pi}\\sin\\!\\left(2(2\\pi-\\tau)\\right)g(\\tau)\\,d\\tau.\n$$\nUsing $\\sin(4\\pi-2\\tau)=-\\sin(2\\tau)$, we get\n$$\ny(2\\pi)=-\\frac{1}{2}\\int_{0}^{2\\pi}g(\\tau)\\sin(2\\tau)\\,d\\tau.\n$$\nWith the piecewise $g$, split the integral:\n$$\ny(2\\pi)=-\\frac{1}{2}\\left[\\int_{0}^{\\pi}\\tau^{2}\\sin(2\\tau)\\,d\\tau+\\int_{\\pi}^{2\\pi}\\left(-\\tau^{2}+4\\pi\\tau-2\\pi^{2}\\right)\\sin(2\\tau)\\,d\\tau\\right].\n$$\nCompute the required integrals. First, derive an antiderivative for $\\int x^{2}\\sin(2x)\\,dx$ via integration by parts twice. Let $u=x^{2}$, $dv=\\sin(2x)\\,dx$, then $du=2x\\,dx$, $v=-\\cos(2x)/2$, so\n$$\n\\int x^{2}\\sin(2x)\\,dx=-\\frac{1}{2}x^{2}\\cos(2x)+\\int x\\cos(2x)\\,dx.\n$$\nFor $K=\\int x\\cos(2x)\\,dx$, let $u_{1}=x$, $dv_{1}=\\cos(2x)\\,dx$, hence $du_{1}=dx$, $v_{1}=\\sin(2x)/2$, giving\n$$\nK=\\frac{x\\sin(2x)}{2}-\\int\\frac{\\sin(2x)}{2}\\,dx = \\frac{x\\sin(2x)}{2}+\\frac{\\cos(2x)}{4}.\n$$\nTherefore,\n$$\n\\int x^{2}\\sin(2x)\\,dx=-\\frac{1}{2}x^{2}\\cos(2x)+\\frac{1}{2}x\\sin(2x)+\\frac{1}{4}\\cos(2x).\n$$\nHence\n$$\nI_{1}:=\\int_{0}^{\\pi}\\tau^{2}\\sin(2\\tau)\\,d\\tau=\\left[-\\frac{1}{2}\\tau^{2}\\cos(2\\tau)+\\frac{1}{2}\\tau\\sin(2\\tau)+\\frac{1}{4}\\cos(2\\tau)\\right]_{0}^{\\pi}=-\\frac{1}{2}\\pi^{2}.\n$$\nNext,\n$$\nI_{2}:=\\int_{\\pi}^{2\\pi}\\left(-\\tau^{2}+4\\pi\\tau-2\\pi^{2}\\right)\\sin(2\\tau)\\,d\\tau=-A+4\\pi B-2\\pi^{2}C,\n$$\nwhere\n$$\nA=\\int_{\\pi}^{2\\pi}\\tau^{2}\\sin(2\\tau)\\,d\\tau,\\quad B=\\int_{\\pi}^{2\\pi}\\tau\\sin(2\\tau)\\,d\\tau,\\quad C=\\int_{\\pi}^{2\\pi}\\sin(2\\tau)\\,d\\tau.\n$$\nWe already have the antiderivative for $A$:\n$$\nA=\\left[-\\frac{1}{2}\\tau^{2}\\cos(2\\tau)+\\frac{1}{2}\\tau\\sin(2\\tau)+\\frac{1}{4}\\cos(2\\tau)\\right]_{\\pi}^{2\\pi}=-\\frac{3}{2}\\pi^{2}.\n$$\nFor $B$, integrate by parts once:\n$$\n\\int \\tau\\sin(2\\tau)\\,d\\tau=-\\frac{1}{2}\\tau\\cos(2\\tau)+\\frac{1}{4}\\sin(2\\tau),\n$$\nso\n$$\nB=\\left[-\\frac{1}{2}\\tau\\cos(2\\tau)+\\frac{1}{4}\\sin(2\\tau)\\right]_{\\pi}^{2\\pi}=-\\frac{\\pi}{2}.\n$$\nFinally,\n$$\nC=\\int_{\\pi}^{2\\pi}\\sin(2\\tau)\\,d\\tau=\\left[-\\frac{\\cos(2\\tau)}{2}\\right]_{\\pi}^{2\\pi}=0.\n$$\nThus\n$$\nI_{2}=-\\left(-\\frac{3}{2}\\pi^{2}\\right)+4\\pi\\left(-\\frac{\\pi}{2}\\right)-2\\pi^{2}\\cdot 0=\\frac{3}{2}\\pi^{2}-2\\pi^{2}=-\\frac{1}{2}\\pi^{2}.\n$$\nCombine $I_{1}$ and $I_{2}$:\n$$\nI_{1}+I_{2}=-\\frac{1}{2}\\pi^{2}-\\frac{1}{2}\\pi^{2}=-\\pi^{2}.\n$$\nTherefore,\n$$\ny(2\\pi)=-\\frac{1}{2}\\left(I_{1}+I_{2}\\right)=\\frac{\\pi^{2}}{2}.\n$$", "answer": "$$\\boxed{\\frac{\\pi^{2}}{2}}$$", "id": "2200500"}]}