{"hands_on_practices": [{"introduction": "When we cannot find an exact analytical solution to a differential equation, numerical methods provide a powerful way to approximate it. The most fundamental of these are the Euler methods. This first practice exercise [@problem_id:2181217] invites you to compare the forward (explicit) and backward (implicit) Euler methods side-by-side. By applying each to a simple initial value problem for a single step, you will gain a concrete understanding of how their differing approaches—one looking forward, one looking backward—yield distinct approximations from the very first calculation.", "problem": "A simplified model for a certain physical process is described by the first-order ordinary differential equation $\\frac{dy}{dx} = -2y$, with the initial condition $y(0) = 1$. A numerical analysis is performed to approximate the value of $y$ at $x=0.1$. Two different methods are used, each with a single step of size $h=0.1$.\n\nThe first approximation, denoted $y_{F}$, is calculated using the forward (explicit) Euler method.\nThe second approximation, denoted $y_{B}$, is calculated using the backward (implicit) Euler method.\n\nCalculate the absolute difference between these two numerical approximations, $|y_{F} - y_{B}|$. Round your final answer to three significant figures.", "solution": "We are given the initial value problem $y^{\\prime}=-2y$ with $y(0)=1$ and step size $h=0.1$. Define $f(x,y)=-2y$. We seek one-step approximations to $y(0.1)$ by forward and backward Euler and then compute the absolute difference.\n\nBy definition, the forward (explicit) Euler method with one step is\n$$\ny_{1}=y_{0}+h\\,f(x_{0},y_{0}).\n$$\nSubstituting $f(x,y)=-2y$ gives\n$$\ny_{F}=y_{1}=y_{0}+h(-2y_{0})=y_{0}(1-2h).\n$$\nWith $y_{0}=1$ and $h=0.1=\\frac{1}{10}$,\n$$\ny_{F}=1\\cdot\\left(1-2\\cdot\\frac{1}{10}\\right)=1-\\frac{1}{5}=\\frac{4}{5}=0.8.\n$$\n\nBy definition, the backward (implicit) Euler method with one step is\n$$\ny_{1}=y_{0}+h\\,f(x_{1},y_{1}).\n$$\nSubstituting $f(x,y)=-2y$ gives\n$$\ny_{1}=y_{0}-2h\\,y_{1}\\quad\\Rightarrow\\quad (1+2h)y_{1}=y_{0}\\quad\\Rightarrow\\quad y_{B}=y_{1}=\\frac{y_{0}}{1+2h}.\n$$\nWith $y_{0}=1$ and $h=0.1=\\frac{1}{10}$,\n$$\ny_{B}=\\frac{1}{1+2\\cdot\\frac{1}{10}}=\\frac{1}{1+\\frac{1}{5}}=\\frac{1}{\\frac{6}{5}}=\\frac{5}{6}\\approx 0.833\\overline{3}.\n$$\n\nThe absolute difference is\n$$\n|y_{F}-y_{B}|=\\left|\\frac{4}{5}-\\frac{5}{6}\\right|=\\left|\\frac{24-25}{30}\\right|=\\frac{1}{30}=0.0333\\overline{3}.\n$$\nRounding to three significant figures gives $0.0333$.", "answer": "$$\\boxed{0.0333}$$", "id": "2181217"}, {"introduction": "While the Euler methods provide a conceptual foundation, their first-order accuracy often requires very small step sizes to achieve reliable results. To improve efficiency, we turn to higher-order methods. The classical fourth-order Runge-Kutta (RK4) method is a cornerstone of numerical integration, renowned for its accuracy and stability. This exercise [@problem_id:2181234] provides hands-on practice in applying the RK4 algorithm, which cleverly averages multiple slope estimates within a single step to dramatically improve the approximation. You will see firsthand how this popular \"workhorse\" method is implemented for a problem in chemical reaction kinetics.", "problem": "The concentration of a chemical reactant, denoted by $C(t)$, in a batch reactor diminishes over time, $t$. The rate of this decrease is governed by a second-order reaction kinetic model. The process can be described by the differential equation:\n$$\n\\frac{dC}{dt} = -k C^{2}\n$$\nwhere $C$ is the concentration in moles per liter (mol/L) and $t$ is the time in seconds (s). The rate constant for this reaction is given as $k = 0.5 \\, \\text{L} \\cdot \\text{mol}^{-1} \\cdot \\text{s}^{-1}$. At the start of the reaction, at $t = 0$, the initial concentration of the reactant is measured to be $C(0) = 1.0 \\text{ mol/L}$.\n\nYour task is to estimate the concentration of the reactant at a later time using a numerical method. Specifically, apply the classical fourth-order Runge-Kutta (RK4) method to approximate the concentration $C(t)$ after one single time step. Use a time step of size $h = 0.2$ s.\n\nCalculate the approximate concentration $C(0.2)$. Express your answer in mol/L, rounded to four significant figures.", "solution": "We are given the initial value problem\n$$\n\\frac{dC}{dt}=f(t,C)=-k C^{2}, \\quad C(0)=C_{0}, \\quad k=0.5, \\quad C_{0}=1.0,\n$$\nand we are to approximate $C(0.2)$ using one classical Runge-Kutta (RK4) step with step size $h=0.2$.\n\nThe RK4 update is\n$$\nC_{1}=C_{0}+\\frac{h}{6}\\left(K_{1}+2K_{2}+2K_{3}+K_{4}\\right),\n$$\nwhere\n$$\nK_{1}=f(t_{0},C_{0}), \\quad K_{2}=f\\left(t_{0}+\\frac{h}{2},\\,C_{0}+\\frac{h}{2}K_{1}\\right),\n$$\n$$\nK_{3}=f\\left(t_{0}+\\frac{h}{2},\\,C_{0}+\\frac{h}{2}K_{2}\\right), \\quad K_{4}=f\\left(t_{0}+h,\\,C_{0}+h K_{3}\\right).\n$$\n\nWith $f(t,C)=-k C^{2}$ and $t_{0}=0$, $C_{0}=1$, $h=0.2$, $k=0.5$:\n\n1) Compute $K_{1}$:\n$$\nK_{1}=-k C_{0}^{2}=-0.5\\cdot(1)^{2}=-0.5.\n$$\n\n2) Compute $K_{2}$ using $C_{0}+\\frac{h}{2}K_{1}=1+\\frac{0.2}{2}(-0.5)=1-0.05=0.95$:\n$$\nK_{2}=-k\\,(0.95)^{2}=-0.5\\cdot 0.9025=-0.45125.\n$$\n\n3) Compute $K_{3}$ using $C_{0}+\\frac{h}{2}K_{2}=1+\\frac{0.2}{2}(-0.45125)=1-0.045125=0.954875$:\n$$\nK_{3}=-k\\,(0.954875)^{2}=-0.5\\cdot 0.911786265625=-0.4558931328125.\n$$\n\n4) Compute $K_{4}$ using $C_{0}+h K_{3}=1+0.2(-0.4558931328125)=1-0.0911786265625=0.9088213734375$:\n$$\nK_{4}=-k\\,(0.9088213734375)^{2}=-0.5\\cdot 0.8259562888168238=-0.4129781444084119.\n$$\n\nCombine the increments:\n$$\nK_{1}+2K_{2}+2K_{3}+K_{4}=-0.5-0.9025-0.911786265625-0.4129781444084119=-2.727264410033412.\n$$\nWith $\\frac{h}{6}=\\frac{0.2}{6}=\\frac{1}{30}$, the update is\n$$\nC_{1}=1+\\frac{1}{30}\\left(-2.727264410033412\\right)=1-0.0909088136677804=0.9090911863322196.\n$$\n\nRounded to four significant figures, the RK4 approximation is $0.9091$ mol/L.", "answer": "$$\\boxed{0.9091}$$", "id": "2181234"}, {"introduction": "For many physical systems, such as planets in orbit or oscillating springs, conserving energy over long simulations is just as important as local accuracy. Standard numerical methods like the forward Euler can introduce artificial energy drift, causing the simulated system to become non-physical over time. This practice problem [@problem_id:2181225] introduces the concept of a symplectic integrator, a specialized method designed to preserve the geometric structure of Hamiltonian systems. By comparing the long-term energy behavior of a simple harmonic oscillator simulated with both the forward Euler and the symplectic Euler methods, you will discover the profound impact that the choice of integrator has on the physical realism of a simulation.", "problem": "A particle of mass $m=1.0$ kg is attached to an ideal spring with a spring constant $k=1.0$ N/m. The particle is constrained to move in one dimension along the x-axis. This system behaves as a simple harmonic oscillator, and its state at any time $t$ can be described by its position $x(t)$ and velocity $v(t)$. The equations of motion form a system of first-order ordinary differential equations:\n$$\n\\frac{dx}{dt} = v\n$$\n$$\n\\frac{dv}{dt} = -\\frac{k}{m}x\n$$\nWe wish to numerically approximate the trajectory of this particle using a fixed time step $h$. We will compare two different numerical integration schemes: the standard Forward Euler method and the Symplectic Euler (or semi-implicit Euler) method.\n\nLet $(x_n, v_n)$ be the state of the system at time $t_n = n \\cdot h$.\n\nA. **Forward Euler (FE) Method:** The state at the next time step $(x_{n+1}, v_{n+1})$ is calculated as:\n$$\nx_{n+1} = x_n + h v_n\n$$\n$$\nv_{n+1} = v_n - h \\frac{k}{m} x_n\n$$\n\nB. **Symplectic Euler (SE) Method:** The state at the next time step $(x_{n+1}, v_{n+1})$ is calculated sequentially as:\n$$\nv_{n+1} = v_n - h \\frac{k}{m} x_n\n$$\n$$\nx_{n+1} = x_n + h v_{n+1}\n$$\n\nThe total mechanical energy of the system is given by $E = \\frac{1}{2}mv^2 + \\frac{1}{2}kx^2$. For an ideal oscillator, this energy should be conserved.\n\nSuppose the system starts from rest at an initial position $x(0) = 1.0$ m and $v(0) = 0$ m/s. Using a time step of $h=0.1$ s, perform two full integration steps (to find the state at $t_2=0.2$ s) for both the Forward Euler and Symplectic Euler methods.\n\nCalculate the ratio of the final energy to the initial energy, $E_2/E_0$, for both methods. Let these ratios be $R_{FE}$ and $R_{SE}$ respectively. Provide the two values $(R_{FE}, R_{SE})$ in your answer. Round your final answers to four significant figures.", "solution": "First, we identify the given parameters and initial conditions.\nMass of the particle, $m = 1.0$ kg.\nSpring constant, $k = 1.0$ N/m.\nInitial position, $x_0 = 1.0$ m.\nInitial velocity, $v_0 = 0$ m/s.\nTime step, $h = 0.1$ s.\n\nThe angular frequency squared is $\\omega^2 = \\frac{k}{m} = \\frac{1.0}{1.0} = 1.0 \\, \\text{s}^{-2}$.\nThe total energy of the system is $E = \\frac{1}{2}mv^2 + \\frac{1}{2}kx^2$.\n\nWe begin by calculating the initial energy $E_0$ at time $t=0$.\n$$\nE_0 = \\frac{1}{2}m v_0^2 + \\frac{1}{2}k x_0^2 = \\frac{1}{2}(1.0)(0)^2 + \\frac{1}{2}(1.0)(1.0)^2 = 0.5 \\, \\text{J}\n$$\n\nNow, we will perform two integration steps for each method.\n\n**Part 1: Forward Euler (FE) Method**\n\nThe update rules are $x_{n+1} = x_n + h v_n$ and $v_{n+1} = v_n - h \\omega^2 x_n$.\n\n*   **Step 1 (from n=0 to n=1):**\n    We calculate $(x_1, v_1)$ from $(x_0, v_0) = (1.0, 0)$.\n    $$\n    x_1 = x_0 + h v_0 = 1.0 + (0.1)(0) = 1.0 \\, \\text{m}\n    $$\n    $$\n    v_1 = v_0 - h \\omega^2 x_0 = 0 - (0.1)(1.0)(1.0) = -0.1 \\, \\text{m/s}\n    $$\n\n*   **Step 2 (from n=1 to n=2):**\n    We calculate $(x_2, v_2)$ from $(x_1, v_1) = (1.0, -0.1)$.\n    $$\n    x_2 = x_1 + h v_1 = 1.0 + (0.1)(-0.1) = 1.0 - 0.01 = 0.99 \\, \\text{m}\n    $$\n    $$\n    v_2 = v_1 - h \\omega^2 x_1 = -0.1 - (0.1)(1.0)(1.0) = -0.1 - 0.1 = -0.2 \\, \\text{m/s}\n    $$\n\nNow, we calculate the energy $E_{FE, 2}$ at $t_2 = 0.2$ s using the state $(x_2, v_2) = (0.99, -0.2)$.\n$$\nE_{FE, 2} = \\frac{1}{2}m v_2^2 + \\frac{1}{2}k x_2^2 = \\frac{1}{2}(1.0)(-0.2)^2 + \\frac{1}{2}(1.0)(0.99)^2\n$$\n$$\nE_{FE, 2} = \\frac{1}{2}(0.04) + \\frac{1}{2}(0.9801) = 0.02 + 0.49005 = 0.51005 \\, \\text{J}\n$$\nThe ratio for the Forward Euler method is:\n$$\nR_{FE} = \\frac{E_{FE, 2}}{E_0} = \\frac{0.51005}{0.5} = 1.0201\n$$\n\n**Part 2: Symplectic Euler (SE) Method**\n\nThe update rules are $v_{n+1} = v_n - h \\omega^2 x_n$ and $x_{n+1} = x_n + h v_{n+1}$.\n\n*   **Step 1 (from n=0 to n=1):**\n    We calculate $(x_1, v_1)$ from $(x_0, v_0) = (1.0, 0)$.\n    $$\n    v_1 = v_0 - h \\omega^2 x_0 = 0 - (0.1)(1.0)(1.0) = -0.1 \\, \\text{m/s}\n    $$\n    $$\n    x_1 = x_0 + h v_1 = 1.0 + (0.1)(-0.1) = 1.0 - 0.01 = 0.99 \\, \\text{m}\n    $$\n\n*   **Step 2 (from n=1 to n=2):**\n    We calculate $(x_2, v_2)$ from $(x_1, v_1) = (0.99, -0.1)$.\n    $$\n    v_2 = v_1 - h \\omega^2 x_1 = -0.1 - (0.1)(1.0)(0.99) = -0.1 - 0.099 = -0.199 \\, \\text{m/s}\n    $$\n    $$\n    x_2 = x_1 + h v_2 = 0.99 + (0.1)(-0.199) = 0.99 - 0.0199 = 0.9701 \\, \\text{m}\n    $$\n\nNow, we calculate the energy $E_{SE, 2}$ at $t_2 = 0.2$ s using the state $(x_2, v_2) = (0.9701, -0.199)$.\n$$\nE_{SE, 2} = \\frac{1}{2}m v_2^2 + \\frac{1}{2}k x_2^2 = \\frac{1}{2}(1.0)(-0.199)^2 + \\frac{1}{2}(1.0)(0.9701)^2\n$$\n$$\nE_{SE, 2} = \\frac{1}{2}(0.039601) + \\frac{1}{2}(0.94109401) = \\frac{1}{2}(0.039601 + 0.94109401) = \\frac{1}{2}(0.98069501) = 0.490347505 \\, \\text{J}\n$$\nThe ratio for the Symplectic Euler method is:\n$$\nR_{SE} = \\frac{E_{SE, 2}}{E_0} = \\frac{0.490347505}{0.5} = 0.98069501\n$$\n\n**Final Step: Rounding**\n\nThe problem requires rounding the final answers to four significant figures.\n$R_{FE} = 1.0201 \\approx 1.020$\n$R_{SE} = 0.98069501 \\approx 0.9807$\n\nThe final answer is the pair $(R_{FE}, R_{SE})$.", "answer": "$$\n\\boxed{\\begin{pmatrix} 1.020 & 0.9807 \\end{pmatrix}}\n$$", "id": "2181225"}]}