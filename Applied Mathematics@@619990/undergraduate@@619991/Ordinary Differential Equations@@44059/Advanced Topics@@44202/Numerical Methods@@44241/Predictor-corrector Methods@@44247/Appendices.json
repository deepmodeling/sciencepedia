{"hands_on_practices": [{"introduction": "The first step in mastering predictor-corrector methods is understanding the interplay between the initial prediction and the subsequent correction. This exercise demonstrates a single, complete cycle of one of the most common schemes: the Euler predictor combined with the trapezoidal corrector, also known as Heun's method. By working through these two stages—making a rough estimate and then using it to find a more refined one—you will gain a concrete intuition for how these methods improve accuracy over simpler one-step techniques [@problem_id:2194236].", "problem": "Consider the initial value problem defined by the ordinary differential equation:\n$$ y' = x^2 - y^2 $$\nwith the initial condition $y(0) = 1$.\n\nYour task is to approximate the value of $y(0.1)$ by performing a single step of the Euler predictor-trapezoidal corrector method. Use a step size of $h=0.1$.\n\nRound your final answer to four significant figures.", "solution": "We define the differential equation as $y' = f(x,y)$ with $f(x,y) = x^{2} - y^{2}$ and initial condition $y(0) = 1$. Let $h = 0.1$, $x_{0} = 0$, and $x_{1} = x_{0} + h = 0.1$.\n\nThe Euler predictor is given by\n$$\ny_{1}^{(p)} = y_{0} + h\\,f(x_{0},y_{0}).\n$$\nCompute\n$$\nf(x_{0},y_{0}) = f(0,1) = 0^{2} - 1^{2} = -1,\n$$\nso\n$$\ny_{1}^{(p)} = 1 + 0.1(-1) = 0.9.\n$$\n\nThe trapezoidal corrector (one correction using the predictor) is\n$$\ny_{1} = y_{0} + \\frac{h}{2}\\left[f(x_{0},y_{0}) + f(x_{1},y_{1}^{(p)})\\right].\n$$\nEvaluate\n$$\nf(x_{1},y_{1}^{(p)}) = f(0.1,0.9) = (0.1)^{2} - (0.9)^{2} = 0.01 - 0.81 = -0.8.\n$$\nThus\n$$\ny_{1} = 1 + \\frac{0.1}{2}\\left[(-1) + (-0.8)\\right] = 1 + 0.05(-1.8) = 1 - 0.09 = 0.91.\n$$\n\nRounding to four significant figures gives $0.9100$.", "answer": "$$\\boxed{0.9100}$$", "id": "2194236"}, {"introduction": "While predictor-corrector methods are powerful, a crucial aspect of numerical analysis is understanding their limitations. This practice explores the concept of numerical stability when applying an explicit method, like Heun's method, to a \"stiff\" differential equation—an equation whose solution contains components decaying at vastly different rates. Such equations pose a significant challenge for many numerical solvers [@problem_id:2194666]. By analyzing the method's amplification factor, you will discover why the step size $h$ must be severely restricted to avoid unstable, oscillating solutions, highlighting why specialized methods are often required for stiff problems.", "problem": "A common issue in numerical analysis is the solution of stiff differential equations, where the solution contains components that decay at vastly different rates. Explicit numerical methods often struggle with such problems, requiring extremely small step sizes to maintain stability, even when the solution itself is varying slowly.\n\nConsider the following model stiff initial value problem:\n$$y'(t) = -75 y(t), \\quad y(0) = 1$$\n\nWe wish to solve this equation using a simple explicit predictor-corrector method, often known as Heun's Method or the improved Euler method. The method is defined by the following two steps for a general Ordinary Differential Equation (ODE) $y'(t) = f(t, y(t))$ with a step size $h$:\n\n1.  **Predictor Step:** A predicted value $p_{n+1}$ is calculated using the Forward Euler method:\n    $p_{n+1} = y_n + h f(t_n, y_n)$\n2.  **Corrector Step:** The predicted value is used to find the next approximation $y_{n+1}$ using the Trapezoidal Rule:\n    $y_{n+1} = y_n + \\frac{h}{2} [f(t_n, y_n) + f(t_{n+1}, p_{n+1})]$\n\nThe stability of a one-step method when applied to the test equation $y' = \\lambda y$ is governed by its amplification factor, $G(z)$, where $z = h\\lambda$ and the numerical approximations are related by $y_{n+1} = G(z) y_n$. For the numerical solution to be absolutely stable, the magnitude of this factor must not exceed one, i.e., $|G(z)| \\leq 1$.\n\nDetermine the maximum allowable step size, $h_{max}$, for this predictor-corrector method to be absolutely stable when applied to the given stiff ODE. Express your answer as a real number rounded to three significant figures.", "solution": "We apply the method to the linear test equation $y'=\\lambda y$, with $\\lambda=-75$. For Heun’s method (explicit predictor-corrector), the predictor is\n$$\np_{n+1}=y_{n}+h f(t_{n},y_{n})=y_{n}+h\\lambda y_{n}=(1+z)y_{n},\\quad z=h\\lambda.\n$$\nThe corrector then gives\n$$\ny_{n+1}=y_{n}+\\frac{h}{2}\\left[f(t_{n},y_{n})+f(t_{n+1},p_{n+1})\\right]\n=y_{n}+\\frac{h}{2}\\left[\\lambda y_{n}+\\lambda p_{n+1}\\right]\n=y_{n}+\\frac{z}{2}\\left[y_{n}+p_{n+1}\\right].\n$$\nSubstituting $p_{n+1}=(1+z)y_{n}$ yields\n$$\ny_{n+1}=y_{n}+\\frac{z}{2}\\left[1+(1+z)\\right]y_{n}\n=\\left(1+z+\\frac{z^{2}}{2}\\right)y_{n}.\n$$\nThus, the amplification factor is\n$$\nG(z)=1+z+\\frac{z^{2}}{2}.\n$$\nAbsolute stability requires $|G(z)|\\leq 1$. For real $z$, complete the square:\n$$\nG(z)=1+z+\\frac{z^{2}}{2}=\\frac{1}{2}+\\frac{1}{2}(z+1)^{2}\\geq \\frac{1}{2},\n$$\nso $G(z)\\geq 0$ on the real axis, and $|G(z)|\\leq 1$ is equivalent to $G(z)\\leq 1$. Hence,\n$$\n1+z+\\frac{z^{2}}{2}\\leq 1\n\\;\\Longleftrightarrow\\;\nz+\\frac{z^{2}}{2}\\leq 0\n\\;\\Longleftrightarrow\\;\nz\\left(1+\\frac{z}{2}\\right)\\leq 0,\n$$\nwhich holds for $z\\in[-2,0]$. For the given problem, $\\lambda=-75<0$ and $z=h\\lambda=-75h$ is real and nonpositive, so absolute stability requires\n$$\n-2\\leq -75h\\leq 0\n\\;\\Longleftrightarrow\\;\n0\\leq 75h\\leq 2\n\\;\\Longleftrightarrow\\;\n0\\leq h\\leq \\frac{2}{75}.\n$$\nTherefore, the maximum allowable step size is $h_{\\max}=\\frac{2}{75}$, which as a decimal rounded to three significant figures is $0.0267$.", "answer": "$$\\boxed{0.0267}$$", "id": "2194666"}, {"introduction": "A key theoretical property of any numerical method is its order of convergence, which describes how quickly the global error decreases as we reduce the step size $h$. It's a fundamental skill for any computational scientist to be able to verify this property through a numerical experiment. This exercise guides you through this exact process for Heun's method [@problem_id:2194700]. By calculating the solution with different step sizes and analyzing the resulting errors, you will empirically estimate the method's order, bridging the gap between abstract theory and practical validation.", "problem": "A common task in numerical analysis is to verify the theoretical order of convergence for a numerical method by observing how the error changes with the step size. Consider the Initial Value Problem (IVP) given by the ordinary differential equation $y'(t) = -y(t)$, with the initial condition $y(0) = 1$.\n\nYou are tasked with investigating a one-step predictor-corrector method, often known as Heun's method or the improved Euler method. For each time step from $t_i$ to $t_{i+1} = t_i + h$, the method proceeds in two stages, where $f(t,y) = -y$ is the right-hand side of the differential equation:\n1.  **Predictor (Euler's Method)**: An initial estimate, $p_{i+1}$, is calculated using the formula $p_{i+1} = y_i + h f(t_i, y_i)$.\n2.  **Corrector (Trapezoidal Rule)**: The predicted value is used to find the corrected value for the step, $y_{i+1}$, using the formula $y_{i+1} = y_i + \\frac{h}{2} [f(t_i, y_i) + f(t_{i+1}, p_{i+1})]$.\n\nYour goal is to numerically estimate the order of convergence, $p$, of this method. To do this, first compute two approximations for the value of $y(0.5)$: one using a single step of size $h_1 = 0.5$, and another using two steps of size $h_2 = 0.25$. Let these approximations be $y_{approx}(0.5, h_1)$ and $y_{approx}(0.5, h_2)$, respectively.\n\nThe exact solution to this IVP is $y_{exact}(t) = \\exp(-t)$. Use the value $y_{exact}(0.5) \\approx 0.60653$ to calculate the absolute errors $E_1 = |y_{exact}(0.5) - y_{approx}(0.5, h_1)|$ and $E_2 = |y_{exact}(0.5) - y_{approx}(0.5, h_2)|$.\n\nThe order of convergence $p$ can be estimated from the relationship stating that the global error is proportional to the step size raised to the power of the order, i.e., $E_h \\propto h^p$. For two step sizes $h_1$ and $h_2$, this implies the relationship $\\frac{E_1}{E_2} \\approx \\left(\\frac{h_1}{h_2}\\right)^p$. Use this relationship to find the value of $p$.\n\nCalculate the estimated order of convergence $p$. Round your final answer to three significant figures.", "solution": "We solve the IVP $y'(t)=-y(t)$, $y(0)=1$ using the specified predictor-corrector (Heun) method. The right-hand side is $f(t,y)=-y$. The exact solution is $y_{\\text{exact}}(t)=\\exp(-t)$, and we use the given $y_{\\text{exact}}(0.5)\\approx 0.60653$.\n\nFor a single step with $h_{1}=0.5$ from $t_{0}=0$ to $t_{1}=0.5$, start with $y_{0}=1$.\nPredictor:\n$$\np_{1}=y_{0}+h_{1}f(t_{0},y_{0})=1+0.5(-1)=0.5.\n$$\nCorrector:\n$$\ny_{1}=y_{0}+\\frac{h_{1}}{2}\\big[f(t_{0},y_{0})+f(t_{1},p_{1})\\big]\n=1+\\frac{0.5}{2}\\big[(-1)+(-0.5)\\big]\n=1+0.25(-1.5)=0.625.\n$$\nThus $y_{\\text{approx}}(0.5,h_{1})=0.625$, and the absolute error is\n$$\nE_{1}=|0.60653-0.625|=0.01847.\n$$\n\nFor two steps with $h_{2}=0.25$ from $t_{0}=0$ to $t_{2}=0.5$, start with $y_{0}=1$.\n\nFirst step to $t_{1}=0.25$:\nPredictor:\n$$\np_{1}=y_{0}+h_{2}f(t_{0},y_{0})=1+0.25(-1)=0.75.\n$$\nCorrector:\n$$\ny_{1}=y_{0}+\\frac{h_{2}}{2}\\big[f(t_{0},y_{0})+f(t_{1},p_{1})\\big]\n=1+0.125\\big[(-1)+(-0.75)\\big]\n=1+0.125(-1.75)=0.78125.\n$$\n\nSecond step to $t_{2}=0.5$:\nPredictor:\n$$\np_{2}=y_{1}+h_{2}f(t_{1},y_{1})=0.78125+0.25(-0.78125)=0.5859375.\n$$\nCorrector:\n$$\ny_{2}=y_{1}+\\frac{h_{2}}{2}\\big[f(t_{1},y_{1})+f(t_{2},p_{2})\\big]\n=0.78125+0.125\\big[(-0.78125)+(-0.5859375)\\big]\n=0.78125+0.125(-1.3671875)=0.6103515625.\n$$\nThus $y_{\\text{approx}}(0.5,h_{2})=0.6103515625$, and the absolute error is\n$$\nE_{2}=|0.60653-0.6103515625|=0.0038215625.\n$$\n\nAssuming $E_{h}\\propto h^{p}$, we use\n$$\n\\frac{E_{1}}{E_{2}}\\approx \\left(\\frac{h_{1}}{h_{2}}\\right)^{p}\n\\quad\\Longrightarrow\\quad\np\\approx \\frac{\\ln(E_{1}/E_{2})}{\\ln(h_{1}/h_{2})}.\n$$\nWith $h_{1}/h_{2}=2$ and $E_{1}/E_{2}=0.01847/0.0038215625\\approx 4.8331016$, we get\n$$\np\\approx \\frac{\\ln(4.8331016)}{\\ln(2)}\\approx 2.27,\n$$\nrounded to three significant figures.", "answer": "$$\\boxed{2.27}$$", "id": "2194700"}]}