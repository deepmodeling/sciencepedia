{"hands_on_practices": [{"introduction": "The first step in mastering the finite difference method is to walk through the entire process on a manageable scale. This exercise asks you to solve a simple linear Boundary Value Problem (BVP) by hand [@problem_id:2173554]. By discretizing the domain and constructing a small $2 \\times 2$ linear system, you will gain a concrete understanding of how a continuous differential equation is transformed into a solvable set of algebraic equations.", "problem": "Consider the second-order linear Boundary Value Problem (BVP) given by the ordinary differential equation:\n$$ y'' + y = 0 $$\nThis equation is defined on the interval $x \\in [0, 1]$ and is subject to the boundary conditions $y(0) = 0$ and $y(1) = 2$.\n\nYou are tasked with finding a numerical approximation to the solution of this BVP using the finite difference method. For this purpose, the domain $[0, 1]$ is to be discretized with a uniform step size of $h = 1/3$. The second derivative, $y''$, at any interior grid point $x_i$ should be approximated using the second-order central difference formula:\n$$ y''(x_i) \\approx \\frac{y_{i+1} - 2y_i + y_{i-1}}{h^2} $$\nwhere $y_i$ represents the numerical approximation of the true solution $y(x)$ at the grid point $x_i$.\n\nBy applying this method, set up and solve the resulting system of linear algebraic equations for the unknown values of the solution at the interior grid points.\n\nExpress your final answer as the numerical approximations for $y(1/3)$ and $y(2/3)$, in that order. The values must be given as exact fractions.", "solution": "We discretize the interval $[0,1]$ with uniform step size $h=1/3$, giving the grid points $x_{0}=0$, $x_{1}=1/3$, $x_{2}=2/3$, $x_{3}=1$. Denote $y_{i}\\approx y(x_{i})$, with boundary values $y_{0}=0$ and $y_{3}=2$. The interior unknowns are $y_{1}$ and $y_{2}$.\n\nThe differential equation is $y''+y=0$. Using the second-order central difference for $y''$ at an interior point $x_{i}$,\n$$\ny''(x_{i}) \\approx \\frac{y_{i+1}-2y_{i}+y_{i-1}}{h^{2}},\n$$\nwe obtain, for $i=1,2$,\n$$\n\\frac{y_{i+1}-2y_{i}+y_{i-1}}{h^{2}}+y_{i}=0.\n$$\nMultiplying by $h^{2}$ and substituting $h^{2}=1/9$ gives\n$$\ny_{i+1}-2y_{i}+y_{i-1}+\\frac{1}{9}y_{i}=0,\n$$\nwhich simplifies to\n$$\ny_{i-1}-\\frac{17}{9}y_{i}+y_{i+1}=0.\n$$\n\nWriting the equations at $i=1$ and $i=2$ and inserting boundary values:\n- For $i=1$: $y_{0}-\\frac{17}{9}y_{1}+y_{2}=0 \\implies -\\frac{17}{9}y_{1}+y_{2}=0$ since $y_{0}=0$.\n- For $i=2$: $y_{1}-\\frac{17}{9}y_{2}+y_{3}=0 \\implies y_{1}-\\frac{17}{9}y_{2}=-y_{3}=-2$.\n\nThus the linear system for $(y_{1},y_{2})^{T}$ is\n$$\n\\begin{pmatrix}\n-\\frac{17}{9} & 1 \\\\\n1 & -\\frac{17}{9}\n\\end{pmatrix}\n\\begin{pmatrix}\ny_{1} \\\\\ny_{2}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n0 \\\\\n-2\n\\end{pmatrix}.\n$$\nFrom the first equation, $y_{2}=\\frac{17}{9}y_{1}$. Substitute into the second:\n$$\ny_{1}-\\frac{17}{9}\\left(\\frac{17}{9}y_{1}\\right)=-2\n\\;\\;\\Longrightarrow\\;\\;\n\\left(1-\\frac{289}{81}\\right)y_{1}=-2\n\\;\\;\\Longrightarrow\\;\\;\n-\\frac{208}{81}y_{1}=-2.\n$$\nSolving gives\n$$\ny_{1}=\\frac{2\\cdot 81}{208}=\\frac{162}{208}=\\frac{81}{104}.\n$$\nThen\n$$\ny_{2}=\\frac{17}{9}y_{1}=\\frac{17}{9}\\cdot \\frac{81}{104}=\\frac{153}{104}.\n$$\nTherefore, the required approximations are $y(1/3)=\\frac{81}{104}$ and $y(2/3)=\\frac{153}{104}$.", "answer": "$$\\boxed{\\begin{pmatrix} \\frac{81}{104} & \\frac{153}{104} \\end{pmatrix}}$$", "id": "2173554"}, {"introduction": "Real-world problems often involve boundary conditions on derivatives, such as specifying heat flux or an insulation condition. This practice introduces the \"ghost point\" method, a standard and powerful technique for handling such Neumann boundary conditions [@problem_id:2173551]. You will see how to augment the system of equations to incorporate the derivative information while maintaining a second-order accurate central difference scheme at the boundary.", "problem": "Consider the following second-order ordinary differential equation which models a steady-state heat distribution in a rod with an internal heat source and heat loss along its length:\n$$ y''(x) - 2y(x) = 4x $$\nThe rod spans the domain $x \\in [0, 1]$. The temperature at the left end is fixed, while the right end experiences a specified heat flux. These conditions are given by the boundary values:\n$$ y(0) = 1, \\quad y'(1) = -3 $$\nWe wish to find an approximate numerical solution to this boundary value problem using the finite difference method. The domain $[0, 1]$ is discretized into $n=4$ uniform subintervals, creating a set of grid points $x_i = i h$ for $i=0, 1, 2, 3, 4$, where $h$ is the step size. Let $y_i$ denote the approximate value of $y(x_i)$.\n\nUse the following standard central difference approximations:\n- For the second derivative: $y''(x_i) \\approx \\frac{y_{i-1} - 2y_i + y_{i+1}}{h^2}$\n- For the first derivative: $y'(x_i) \\approx \\frac{y_{i+1} - y_{i-1}}{2h}$\n\nTo handle the derivative boundary condition at $x_4 = 1$, a \"ghost point\" at $x_5 = x_4 + h$ is introduced. The value at this point, $y_5$, is then eliminated from the system of equations.\n\nThis process results in a system of linear algebraic equations for the unknown values $y_1, y_2, y_3,$ and $y_4$. Determine the specific linear equation that corresponds to the grid point $x_4 = 1$.\n\nWhich of the following equations correctly represents the finite difference approximation at $x_4 = 1$ after eliminating the ghost point?\n\nA. $16y_3 - 17y_4 = 14$\n\nB. $16y_3 - 17y_4 = 8$\n\nC. $16y_3 - 17y_4 = -10$\n\nD. $16y_3 + 15y_4 = 14$\n\nE. $8y_3 - 8y_4 = 7$", "solution": "We discretize the domain $[0,1]$ with $n=4$ uniform subintervals, so the step size is $h=\\frac{1-0}{4}=\\frac{1}{4}$. The grid points are $x_{i}=ih$, hence $x_{4}=1$.\n\nAt $x_{4}=1$, we discretize the differential equation $y''(x)-2y(x)=4x$ using the central difference for the second derivative:\n$$\n\\frac{y_{3}-2y_{4}+y_{5}}{h^{2}}-2y_{4}=4x_{4}.\n$$\nSince $x_{4}=1$, the right-hand side is $4$:\n$$\n\\frac{y_{3}-2y_{4}+y_{5}}{h^{2}}-2y_{4}=4.\n$$\n\nTo eliminate the ghost point $y_{5}$, we use the Neumann boundary condition at $x_{4}=1$, $y'(1)=-3$, with the central difference approximation for the first derivative:\n$$\n\\frac{y_{5}-y_{3}}{2h}=-3 \\quad \\Longrightarrow \\quad y_{5}=y_{3}-6h.\n$$\nWith $h=\\frac{1}{4}$, we obtain\n$$\ny_{5}=y_{3}-\\frac{3}{2}.\n$$\n\nSubstitute this into the discretized equation at $x_{4}$:\n$$\n\\frac{y_{3}-2y_{4}+\\left(y_{3}-\\frac{3}{2}\\right)}{h^{2}}-2y_{4}=4.\n$$\nSince $h^{2}=\\frac{1}{16}$, we have $\\frac{1}{h^{2}}=16$, so\n$$\n16\\left(2y_{3}-2y_{4}-\\frac{3}{2}\\right)-2y_{4}=4.\n$$\nThis simplifies to\n$$\n32y_{3}-32y_{4}-24-2y_{4}=4 \\quad \\Longrightarrow \\quad 32y_{3}-34y_{4}=28.\n$$\nDividing by $2$ gives\n$$\n16y_{3}-17y_{4}=14,\n$$\nwhich matches option A.", "answer": "$$\\boxed{A}$$", "id": "2173551"}, {"introduction": "Having applied finite difference formulas, it is insightful to understand their origin. This exercise guides you through the derivation of the second-derivative approximation using Taylor series expansions, the fundamental tool of the method [@problem_id:2173539]. By working through the case of a non-uniform grid, you will not only derive the standard formula as a special case but also appreciate the principles needed to create custom approximations for more complex problems.", "problem": "In many scientific and engineering applications, a function $y(x)$ is only known at a set of discrete grid points. To analyze the system, one often needs to approximate the derivatives of the function at these points.\n\nConsider a sufficiently smooth function $y(x)$. We are given the values of this function at three consecutive, but not necessarily equally spaced, grid points: $x_{i-1}$, $x_i$, and $x_{i+1}$. Let us denote the function values at these points as $y_{i-1} = y(x_{i-1})$, $y_i = y(x_i)$, and $y_{i+1} = y(x_{i+1})$. The spacing between the points is defined by two positive step sizes, $h_1 = x_i - x_{i-1}$ and $h_2 = x_{i+1} - x_i$.\n\nUsing this information, derive a finite difference approximation for the second derivative of the function at the central point, $y''(x_i)$. Express your answer as a formula in terms of $y_{i-1}$, $y_i$, $y_{i+1}$, $h_1$, and $h_2$.", "solution": "We expand the function $y(x)$ about $x_{i}$ using Taylor series at the neighboring points $x_{i-1}=x_{i}-h_{1}$ and $x_{i+1}=x_{i}+h_{2}$:\n$$\ny_{i-1}=y(x_{i}-h_{1})=y_{i}-h_{1}y^{\\prime}(x_{i})+\\frac{h_{1}^{2}}{2}y^{\\prime\\prime}(x_{i})-\\frac{h_{1}^{3}}{6}y^{\\prime\\prime\\prime}(x_{i})+\\mathcal{O}(h_{1}^{4}),\n$$\n$$\ny_{i+1}=y(x_{i}+h_{2})=y_{i}+h_{2}y^{\\prime}(x_{i})+\\frac{h_{2}^{2}}{2}y^{\\prime\\prime}(x_{i})+\\frac{h_{2}^{3}}{6}y^{\\prime\\prime\\prime}(x_{i})+\\mathcal{O}(h_{2}^{4}).\n$$\nWe seek constants $a,b,c$ such that\n$$\na\\,y_{i-1}+b\\,y_{i}+c\\,y_{i+1}=y^{\\prime\\prime}(x_{i})+\\text{higher-order terms}.\n$$\nSubstituting the Taylor expansions and matching coefficients to eliminate $y_{i}$ and $y^{\\prime}(x_{i})$, and to normalize the $y^{\\prime\\prime}(x_{i})$ term, yields the system\n$$\na+b+c=0,\\qquad -a h_{1}+c h_{2}=0,\\qquad \\frac{a h_{1}^{2}}{2}+\\frac{c h_{2}^{2}}{2}=1.\n$$\nSolving gives\n$$\na=\\frac{2}{h_{1}(h_{1}+h_{2})},\\qquad c=\\frac{2}{h_{2}(h_{1}+h_{2})},\\qquad b=-\\frac{2}{h_{1}h_{2}}.\n$$\nTherefore, the three-point nonuniform-grid approximation for the second derivative at $x_{i}$ is\n$$\ny^{\\prime\\prime}(x_{i})\\approx \\frac{2}{h_{1}(h_{1}+h_{2})}y_{i-1}-\\frac{2}{h_{1}h_{2}}y_{i}+\\frac{2}{h_{2}(h_{1}+h_{2})}y_{i+1}\n= \\frac{2\\left[h_{2}y_{i-1}-(h_{1}+h_{2})y_{i}+h_{1}y_{i+1}\\right]}{h_{1}h_{2}(h_{1}+h_{2})},\n$$\nwith truncation error of order $\\mathcal{O}(\\max\\{h_{1},h_{2}\\})$ in the general nonuniform case (which improves to $\\mathcal{O}(h^{2})$ when $h_{1}=h_{2}=h$).", "answer": "$$\\boxed{\\frac{2\\left[h_{2}y_{i-1}-(h_{1}+h_{2})y_{i}+h_{1}y_{i+1}\\right]}{h_{1}h_{2}(h_{1}+h_{2})}}$$", "id": "2173539"}]}