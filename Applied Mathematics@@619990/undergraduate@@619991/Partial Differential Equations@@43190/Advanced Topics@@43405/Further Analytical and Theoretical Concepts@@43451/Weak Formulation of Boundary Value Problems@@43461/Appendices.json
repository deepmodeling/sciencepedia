{"hands_on_practices": [{"introduction": "The journey into weak formulations begins with a foundational skill: transforming a classical boundary value problem into its integral equivalent. This process involves multiplying the differential equation by a \"test function\" $v$ and using integration by parts to shift a derivative from the unknown solution $u$, thereby \"weakening\" the smoothness required of the solution. This first exercise [@problem_id:2156992] is designed to build your fluency with this core procedure for a standard one-dimensional problem, a crucial first step toward tackling more complex physical scenarios.", "problem": "Consider the one-dimensional boundary value problem (BVP) defined by the differential equation:\n$$\n-(e^x u'(x))' = \\sin(x)\n$$\non the open interval $x \\in (a, b)$, subject to homogeneous Dirichlet boundary conditions $u(a) = 0$ and $u(b) = 0$.\n\nThe weak (or variational) formulation of this BVP requires finding a solution function $u$ from a suitable function space $V$ such that a certain integral equation is satisfied for all \"test functions\" $v$ from the same space $V$. For this problem, the space $V$ is defined as the set of functions that are continuous, have square-integrable first derivatives over the interval $(a, b)$, and satisfy the boundary conditions $f(a) = 0$ and $f(b) = 0$.\n\nWhich of the following integral equations correctly represents the weak formulation of the given BVP? The task is to find $u \\in V$ such that the chosen equation holds for all $v \\in V$.\n\nA. $\\int_{a}^{b} e^x u'(x) v'(x) \\,dx = \\int_{a}^{b} \\sin(x) v(x) \\,dx$\n\nB. $\\int_{a}^{b} u'(x) v'(x) \\,dx = \\int_{a}^{b} e^{-x}\\sin(x) v(x) \\,dx$\n\nC. $-\\int_{a}^{b} e^x u'(x) v'(x) \\,dx = \\int_{a}^{b} \\sin(x) v(x) \\,dx$\n\nD. $\\int_{a}^{b} e^x u(x) v(x) \\,dx = \\int_{a}^{b} \\sin(x) v(x) \\,dx$\n\nE. $\\int_{a}^{b} e^x u'(x) v(x) \\,dx = -\\int_{a}^{b} \\cos(x) v'(x) \\,dx$\n\nF. $-\\int_{a}^{b} e^x u'(x) v(x) \\,dx = \\int_{a}^{b} \\sin(x) v(x) \\,dx$", "solution": "We start from the strong form of the boundary value problem:\n$$\n-(\\exp(x)\\,u'(x))'=\\sin(x)\\quad\\text{for }x\\in(a,b),\\qquad u(a)=0,\\;u(b)=0.\n$$\nLet $V=\\{v\\in H^{1}(a,b):v(a)=v(b)=0\\}$. To derive the weak form, multiply the differential equation by an arbitrary test function $v\\in V$ and integrate over $(a,b)$:\n$$\n\\int_{a}^{b}-(\\exp(x)\\,u'(x))'\\,v(x)\\,dx=\\int_{a}^{b}\\sin(x)\\,v(x)\\,dx.\n$$\nApply integration by parts to the left-hand side using the identity\n$$\n\\int_{a}^{b}-\\left(p(x)w'(x)\\right)'\\,v(x)\\,dx=\\int_{a}^{b}p(x)\\,w'(x)\\,v'(x)\\,dx-\\left[p(x)\\,w'(x)\\,v(x)\\right]_{x=a}^{x=b},\n$$\nwith $p(x)=\\exp(x)$ and $w(x)=u(x)$. This yields\n$$\n\\int_{a}^{b}\\exp(x)\\,u'(x)\\,v'(x)\\,dx-\\left[\\exp(x)\\,u'(x)\\,v(x)\\right]_{x=a}^{x=b}=\\int_{a}^{b}\\sin(x)\\,v(x)\\,dx.\n$$\nSince $v(a)=v(b)=0$ for all $v\\in V$, the boundary term vanishes, giving the weak (variational) formulation:\n$$\n\\int_{a}^{b}\\exp(x)\\,u'(x)\\,v'(x)\\,dx=\\int_{a}^{b}\\sin(x)\\,v(x)\\,dx\\quad\\text{for all }v\\in V.\n$$\nComparing with the options, this corresponds to option A.", "answer": "$$\\boxed{A}$$", "id": "2156992"}, {"introduction": "Having mastered the basic derivation, we now explore one of the key strengths of the weak formulation: its ability to handle singular sources. Physical models often involve concentrated forces or heat sources, which are mathematically described by distributions like the Dirac delta function. This exercise [@problem_id:2157010] reveals how the integral form elegantly incorporates such a point source, translating it into a simple evaluation of the test function at the source's location and defining the linear functional $L(v)$.", "problem": "Consider the one-dimensional steady-state heat conduction problem on a thin rod of length $L$. The temperature distribution $u(x)$ along the rod, for $x \\in (0, L)$, is governed by the following second-order differential equation:\n$$-\\frac{d}{dx}\\left(p(x) \\frac{du}{dx}\\right) = f(x)$$\nwhere $p(x)$ is the position-dependent thermal conductivity, which is a known positive and continuously differentiable function. The ends of the rod are held at a fixed zero temperature, leading to the boundary conditions $u(0)=0$ and $u(L)=0$.\n\nThe source term $f(x)$ represents a highly concentrated heat source of total power $F_0$ applied at a single point $x_0$, where $0 < x_0 < L$. This is modeled using the Dirac delta function, $\\delta(\\cdot)$, such that $f(x) = F_0 \\delta(x-x_0)$.\n\nThe weak formulation of this boundary value problem seeks a function $u$ from a suitable space of functions $V$ (where functions in $V$ satisfy the boundary conditions) such that the equation $a(u,v) = L(v)$ holds for all \"test functions\" $v$ in $V$. The bilinear form $a(u,v)$ is given by:\n$$a(u,v) = \\int_{0}^{L} p(x) \\frac{du}{dx} \\frac{dv}{dx} \\, dx$$\nDetermine the expression for the corresponding linear functional $L(v)$. Your answer should be a symbolic expression in terms of $F_0$, $x_0$, and the test function $v$.", "solution": "We consider the space $V=H_{0}^{1}(0,L)$ of admissible functions and test functions, which satisfy the homogeneous Dirichlet boundary conditions at $x=0$ and $x=L$. To derive the weak form, multiply the differential equation by an arbitrary $v \\in V$ and integrate over $(0,L)$:\n$$\n\\int_{0}^{L} -\\frac{d}{dx}\\left(p(x)\\frac{du}{dx}\\right) v(x)\\,dx = \\int_{0}^{L} f(x)\\,v(x)\\,dx.\n$$\nApplying integration by parts (Green's identity in one dimension) to the left-hand side yields\n$$\n\\int_{0}^{L} p(x)\\frac{du}{dx}\\frac{dv}{dx}\\,dx - \\left[p(x)\\frac{du}{dx}v(x)\\right]_{x=0}^{x=L} = \\int_{0}^{L} f(x)\\,v(x)\\,dx.\n$$\nBecause $v(0)=v(L)=0$, the boundary term vanishes, and we obtain the weak formulation\n$$\na(u,v) = \\int_{0}^{L} f(x)\\,v(x)\\,dx,\n$$\nwith $a(u,v)=\\int_{0}^{L} p(x)\\,u'(x)\\,v'(x)\\,dx$ as given. Substituting $f(x)=F_{0}\\delta(x-x_{0})$ and using the defining property of the Dirac delta distribution gives\n$$\n\\int_{0}^{L} F_{0}\\delta(x-x_{0})\\,v(x)\\,dx = F_{0}v(x_{0}),\n$$\nwhere the point evaluation $v(x_{0})$ is well-defined for $v \\in H_{0}^{1}(0,L)$ in one dimension. Therefore, the corresponding linear functional is\n$$\nL(v)=F_{0}v(x_{0}).\n$$", "answer": "$$\\boxed{F_{0}\\,v(x_{0})}$$", "id": "2157010"}, {"introduction": "The true power of the weak formulation is fully realized when it serves as the foundation for numerical methods. This final practice extends the concept to eigenvalue problems, which are fundamental to describing phenomena like the vibrational modes of a structure or the energy levels in a quantum system. This exercise [@problem_id:2450442] demonstrates how the weak formulation transforms a differential eigenvalue problem into a generalized matrix eigenvalue problem, $\\mathbf{K}\\mathbf{c} = \\lambda \\mathbf{M}\\mathbf{c}$, the very form that computers can analyze using powerful techniques like the Finite Element Method (FEM).", "problem": "Consider the scalar Partial Differential Equation (PDE) eigenvalue problem: find eigenpairs $\\left(\\lambda, u\\right)$ with $u \\not\\equiv 0$ such that\n$$\n-\\nabla^{2} u = \\lambda\\, u \\quad \\text{in } \\Omega,\n$$\nwith homogeneous Dirichlet boundary condition\n$$\nu = 0 \\quad \\text{on } \\partial \\Omega,\n$$\nwhere $\\Omega \\subset \\mathbb{R}^{d}$ is a bounded domain with Lipschitz boundary $\\partial \\Omega$, and $d \\in \\{1,2,3\\}$. A conforming Galerkin discretization using the Finite Element Method (FEM) seeks $u$ in a finite-dimensional subspace $V_{h} \\subset H^{1}_{0}(\\Omega)$ spanned by basis functions $\\{\\phi_{i}\\}_{i=1}^{N}$.\n\nWhich option correctly states both the weak formulation and the structure of the resulting discrete matrix eigenvalue problem from such a conforming Galerkin FEM?\n\nA. Weak form: find $\\left(\\lambda, u\\right)$ with $u \\in H^{1}_{0}(\\Omega)\\setminus\\{0\\}$ such that\n$$\n\\int_{\\Omega} \\nabla u \\cdot \\nabla v \\, \\mathrm{d}x = \\lambda \\int_{\\Omega} u\\, v \\, \\mathrm{d}x \\quad \\forall v \\in H^{1}_{0}(\\Omega).\n$$\nDiscrete problem: with $u_{h} = \\sum_{i=1}^{N} c_{i} \\phi_{i}$,\n$$\n\\mathbf{K}\\,\\mathbf{c} = \\lambda\\, \\mathbf{M}\\,\\mathbf{c},\n$$\nwhere $\\mathbf{K}_{ij} = \\int_{\\Omega} \\nabla \\phi_{i} \\cdot \\nabla \\phi_{j}\\, \\mathrm{d}x$ and $\\mathbf{M}_{ij} = \\int_{\\Omega} \\phi_{i}\\, \\phi_{j}\\, \\mathrm{d}x$.\n\nB. Weak form: find $\\left(\\lambda, u\\right)$ with $u \\in H^{1}(\\Omega)\\setminus\\{0\\}$ such that\n$$\n\\int_{\\Omega} \\nabla u \\cdot \\nabla v \\, \\mathrm{d}x - \\int_{\\partial \\Omega} \\frac{\\partial u}{\\partial n}\\, v \\, \\mathrm{d}s = \\lambda \\int_{\\Omega} u\\, v \\, \\mathrm{d}x \\quad \\forall v \\in H^{1}(\\Omega).\n$$\nDiscrete problem: with $u_{h} = \\sum_{i=1}^{N} c_{i} \\phi_{i}$ where $\\{\\phi_{i}\\}$ need not vanish on $\\partial \\Omega$,\n$$\n\\mathbf{K}\\,\\mathbf{c} = \\lambda\\, \\mathbf{M}\\,\\mathbf{c},\n$$\nwith the same definitions of $\\mathbf{K}$ and $\\mathbf{M}$ as in option A.\n\nC. Weak form: find $\\left(\\lambda, u\\right)$ with $u \\in H^{2}(\\Omega)\\setminus\\{0\\}$ such that\n$$\n\\int_{\\Omega} (\\nabla^{2} u)\\, v \\, \\mathrm{d}x = \\lambda \\int_{\\Omega} u\\, v \\, \\mathrm{d}x \\quad \\forall v \\in H^{1}_{0}(\\Omega),\n$$\nso that the discrete system is\n$$\n\\tilde{\\mathbf{K}}\\,\\mathbf{c} = \\lambda\\, \\mathbf{M}\\,\\mathbf{c}, \\quad \\tilde{\\mathbf{K}}_{ij} = \\int_{\\Omega} (\\nabla^{2} \\phi_{i})\\, \\phi_{j}\\, \\mathrm{d}x.\n$$\n\nD. Weak form: find $\\left(\\lambda, u\\right)$ with $u \\in H^{1}_{0}(\\Omega)\\setminus\\{0\\}$ such that\n$$\n\\int_{\\Omega} \\nabla u \\cdot \\nabla v \\, \\mathrm{d}x = \\lambda \\int_{\\Omega} u\\, v \\, \\mathrm{d}x \\quad \\forall v \\in H^{1}_{0}(\\Omega).\n$$\nDiscrete problem: after choosing any conforming FEM basis $\\{\\phi_{i}\\}_{i=1}^{N}$, the eigenproblem always reduces to the standard form\n$$\n\\mathbf{K}\\,\\mathbf{c} = \\lambda\\, \\mathbf{c},\n$$\nwith $\\mathbf{K}_{ij} = \\int_{\\Omega} \\nabla \\phi_{i} \\cdot \\nabla \\phi_{j}\\, \\mathrm{d}x$.", "solution": "The governing Partial Differential Equation (PDE) is\n$$\n-\\nabla^{2} u = \\lambda\\, u \\quad \\text{in } \\Omega, \\quad u = 0 \\quad \\text{on } \\partial \\Omega.\n$$\nTo obtain a weak formulation from first principles, multiply the PDE by an admissible test function $v$ and integrate over $\\Omega$:\n$$\n\\int_{\\Omega} \\left(-\\nabla^{2} u\\right) v \\, \\mathrm{d}x = \\lambda \\int_{\\Omega} u\\, v \\, \\mathrm{d}x.\n$$\nApply Green’s identity (integration by parts) to the left-hand side:\n$$\n\\int_{\\Omega} \\left(-\\nabla^{2} u\\right) v \\, \\mathrm{d}x = \\int_{\\Omega} \\nabla u \\cdot \\nabla v \\, \\mathrm{d}x - \\int_{\\partial \\Omega} \\frac{\\partial u}{\\partial n} v \\, \\mathrm{d}s.\n$$\nFor homogeneous Dirichlet boundary conditions, the natural conforming choice of trial and test space is the Sobolev space $H^{1}_{0}(\\Omega)$, defined as the closure of $C^{\\infty}_{c}(\\Omega)$ in the $H^{1}$ norm, so that $v \\in H^{1}_{0}(\\Omega)$ implies $v = 0$ on $\\partial \\Omega$ in the trace sense. Consequently, the boundary integral vanishes because $v = 0$ on $\\partial \\Omega$, yielding the symmetric weak formulation:\n$$\n\\text{Find } \\left(\\lambda, u\\right) \\text{ with } u \\in H^{1}_{0}(\\Omega)\\setminus\\{0\\} \\text{ such that } \\int_{\\Omega} \\nabla u \\cdot \\nabla v \\, \\mathrm{d}x = \\lambda \\int_{\\Omega} u\\, v \\, \\mathrm{d}x \\quad \\forall v \\in H^{1}_{0}(\\Omega).\n$$\nThis formulation only requires first derivatives of $u$ and $v$, so $H^{1}_{0}(\\Omega)$ is sufficient, and the associated bilinear forms are continuous, symmetric, and coercive on $H^{1}_{0}(\\Omega)$ for the left-hand side.\n\nFor a conforming Finite Element Method (FEM) discretization, choose a finite-dimensional subspace $V_{h} \\subset H^{1}_{0}(\\Omega)$ with basis $\\{\\phi_{i}\\}_{i=1}^{N}$. Approximate $u$ by $u_{h} = \\sum_{i=1}^{N} c_{i} \\phi_{i}$ and test with each basis function $\\phi_{j}$, $j \\in \\{1,\\dots,N\\}$. The weak form becomes\n$$\n\\sum_{i=1}^{N} c_{i} \\int_{\\Omega} \\nabla \\phi_{i} \\cdot \\nabla \\phi_{j}\\, \\mathrm{d}x = \\lambda \\sum_{i=1}^{N} c_{i} \\int_{\\Omega} \\phi_{i}\\, \\phi_{j}\\, \\mathrm{d}x \\quad \\text{for each } j.\n$$\nCollecting coefficients gives the generalized matrix eigenvalue problem\n$$\n\\mathbf{K}\\, \\mathbf{c} = \\lambda\\, \\mathbf{M}\\, \\mathbf{c},\n$$\nwith stiffness matrix entries $\\mathbf{K}_{ij} = \\int_{\\Omega} \\nabla \\phi_{i} \\cdot \\nabla \\phi_{j}\\, \\mathrm{d}x$ and mass matrix entries $\\mathbf{M}_{ij} = \\int_{\\Omega} \\phi_{i}\\, \\phi_{j}\\, \\mathrm{d}x$. For standard conforming FEM spaces, $\\mathbf{K}$ and $\\mathbf{M}$ are symmetric, with $\\mathbf{K}$ positive definite on the subspace orthogonal to the nullspace (here the Dirichlet constraint removes the constant nullspace), and $\\mathbf{M}$ symmetric positive definite.\n\nOption-by-option analysis:\n\nA. The weak formulation is stated with trial and test space $H^{1}_{0}(\\Omega)$, which enforces the homogeneous Dirichlet boundary condition strongly. The boundary integral vanishes due to $v = 0$ on $\\partial \\Omega$, giving\n$$\n\\int_{\\Omega} \\nabla u \\cdot \\nabla v \\, \\mathrm{d}x = \\lambda \\int_{\\Omega} u\\, v \\, \\mathrm{d}x \\quad \\forall v \\in H^{1}_{0}(\\Omega).\n$$\nThe discrete Galerkin system is correctly identified as the generalized eigenproblem $\\mathbf{K}\\mathbf{c} = \\lambda \\mathbf{M}\\mathbf{c}$ with the standard stiffness and mass matrices. Verdict — Correct.\n\nB. This option uses $H^{1}(\\Omega)$ for test and trial functions and retains the boundary term. For homogeneous Dirichlet conditions, the appropriate conforming space is $H^{1}_{0}(\\Omega)$ so that the trace vanishes and the boundary integral drops out; using $H^{1}(\\Omega)$ without additional boundary enforcement is not consistent with the essential boundary condition. Therefore, both the space choice and the displayed weak statement are incorrect for the stated boundary condition. Verdict — Incorrect.\n\nC. This option keeps the Laplacian on $u$ inside the domain integral and requires $u \\in H^{2}(\\Omega)$, which is unnecessary and contrary to the purpose of the weak formulation. The standard weak form transfers derivatives onto $v$ to reduce regularity requirements to $H^{1}(\\Omega)$. Moreover, the displayed discrete matrix uses second derivatives of basis functions, which is not the conforming $H^{1}$ FEM approach for this problem. Verdict — Incorrect.\n\nD. The weak form in this option is correct, but the claim that the discrete problem “always reduces” to the standard eigenproblem $\\mathbf{K}\\mathbf{c} = \\lambda \\mathbf{c}$ for “any” conforming basis is false in general. Without additional steps such as explicit $\\mathbf{M}$-orthonormalization of the basis or transforming variables, the Galerkin discretization yields the generalized eigenproblem $\\mathbf{K}\\mathbf{c} = \\lambda \\mathbf{M}\\mathbf{c}$, not a standard eigenproblem. Verdict — Incorrect.", "answer": "$$\\boxed{A}$$", "id": "2450442"}]}