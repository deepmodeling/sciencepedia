{"hands_on_practices": [{"introduction": "Before building solutions, it's crucial to understand what a \"weak solution\" truly is. This first practice provides a direct test of the variational formulation by asking you to verify that a given function satisfies the core integral identity against a specific test function. This exercise demystifies the abstract definition and solidifies your understanding of how the weak form relates the solution, the source term, and the test functions through integration [@problem_id:2154690].", "problem": "The variational or \"weak\" formulation of a differential equation is a cornerstone of modern analysis and numerical methods. Consider the one-dimensional Poisson equation $-u''(x) = f(x)$ on the interval $x \\in (0, 1)$, subject to homogeneous Dirichlet boundary conditions $u(0)=0$ and $u(1)=0$.\n\nA function $u(x)$ that satisfies these boundary conditions is called a weak solution to this problem if the following integral identity holds for all suitable test functions $v(x)$ that also satisfy $v(0)=0$ and $v(1)=0$:\n$$\n\\int_0^1 u'(x) v'(x) dx = \\int_0^1 f(x) v(x) dx\n$$\nwhere $u'(x)$ and $v'(x)$ denote the first derivatives of $u(x)$ and $v(x)$, respectively.\n\nYour task is to test this formulation for a specific case. Let the source term be $f(x)=1$. A proposed solution is the function $u(x) = \\frac{1}{2}x(1-x)$. We will test this candidate against the specific test function $v(x) = x(1-x)$.\n\nTo do this, you must evaluate the two integrals in the weak formulation:\n1.  The left-hand side integral, $I_{LHS} = \\int_0^1 u'(x) v'(x) dx$.\n2.  The right-hand side integral, $I_{RHS} = \\int_0^1 f(x) v(x) dx$.\n\nFor the proposed function $u(x)$ to satisfy the weak formulation for the given test function $v(x)$, the values of these two integrals must be identical. Calculate this value. Express your answer as an exact fraction in simplest form.", "solution": "We are given $f(x)=1$, $u(x)=\\frac{1}{2}x(1-x)$, and $v(x)=x(1-x)$. The weak formulation to test is\n$$\n\\int_{0}^{1} u'(x)v'(x)\\,dx=\\int_{0}^{1} f(x)v(x)\\,dx.\n$$\nFirst compute the derivatives:\n$$\nu'(x)=\\frac{d}{dx}\\left(\\frac{1}{2}x(1-x)\\right)=\\frac{1}{2}(1-2x)=\\frac{1}{2}-x,\\qquad v'(x)=\\frac{d}{dx}\\left(x(1-x)\\right)=1-2x.\n$$\nEvaluate the left-hand side integral:\n$$\nI_{LHS}=\\int_{0}^{1}\\left(\\frac{1}{2}-x\\right)\\left(1-2x\\right)\\,dx.\n$$\nExpand the integrand:\n$$\n\\left(\\frac{1}{2}-x\\right)\\left(1-2x\\right)=\\frac{1}{2}-2x+2x^{2}.\n$$\nIntegrate term by term over $[0,1]$:\n$$\nI_{LHS}=\\int_{0}^{1}\\frac{1}{2}\\,dx+\\int_{0}^{1}(-2x)\\,dx+\\int_{0}^{1}2x^{2}\\,dx=\\frac{1}{2}-1+\\frac{2}{3}=\\frac{1}{6}.\n$$\nEvaluate the right-hand side integral:\n$$\nI_{RHS}=\\int_{0}^{1} f(x)v(x)\\,dx=\\int_{0}^{1}1\\cdot\\left(x-x^{2}\\right)\\,dx=\\left[\\frac{x^{2}}{2}-\\frac{x^{3}}{3}\\right]_{0}^{1}=\\frac{1}{2}-\\frac{1}{3}=\\frac{1}{6}.\n$$\nThus $I_{LHS}=I_{RHS}=\\frac{1}{6}$, so the proposed $u(x)$ satisfies the weak formulation for the given test function $v(x)$, and the common value of the integrals is $\\frac{1}{6}$.", "answer": "$$\\boxed{\\frac{1}{6}}$$", "id": "2154690"}, {"introduction": "The true power of the variational formulation lies in its ability to generate approximate solutions, which is the foundation of the Finite Element Method (FEM). In this problem, you will use the Galerkin method to find an approximate solution to the Poisson equation by projecting it onto a space spanned by a single, piecewise linear \"hat function\" [@problem_id:2154695]. This exercise introduces a core FEM concept and demonstrates how a differential equation can be transformed into a solvable system of linear equations.", "problem": "Consider the one-dimensional boundary value problem given by the differential equation:\n$$-\\frac{d^2u}{dx^2} = f(x) \\quad \\text{for } x \\in (0, 4)$$\nwith homogeneous Dirichlet boundary conditions $u(0)=0$ and $u(4)=0$. The source term $f(x)$ is a piecewise function defined as:\n$$f(x) = \\begin{cases} x & \\text{if } 0 < x \\le 2 \\\\ 0 & \\text{if } 2 < x < 4 \\end{cases}$$\nWe seek an approximate solution $u_h(x)$ using the Galerkin method. The approximation space $V_h$ is a one-dimensional space spanned by a single basis function, $\\phi(x)$. This function is the standard piecewise linear 'hat' function that is equal to 1 at $x=2$ and vanishes at the domain boundaries $x=0$ and $x=4$. The approximate solution is then written as $u_h(x) = c \\phi(x)$. Determine the value of the coefficient $c$.", "solution": "The Galerkin method for the differential equation $-u''(x) = f(x)$ on $[0,4]$ with $u(0)=u(4)=0$ is based on its weak (or variational) formulation. First, we multiply the equation by a test function $v(x)$ that satisfies the same homogeneous boundary conditions, i.e., $v(0)=v(4)=0$, and integrate over the domain:\n$$-\\int_0^4 u''(x) v(x) dx = \\int_0^4 f(x) v(x) dx$$\nWe apply integration by parts to the left-hand side:\n$$-\\left[ u'(x)v(x) \\right]_0^4 + \\int_0^4 u'(x) v'(x) dx = \\int_0^4 f(x) v(x) dx$$\nSince $v(0)=v(4)=0$, the boundary term $[u'(x)v(x)]_0^4$ vanishes. The weak formulation is to find a function $u$ (from a suitable space) such that for all valid test functions $v$:\n$$\\int_0^4 u'(x) v'(x) dx = \\int_0^4 f(x) v(x) dx$$\nThis is often written as $a(u,v) = L(v)$, where $a(u,v)=\\int u'v' dx$ is a bilinear form and $L(v)=\\int f v dx$ is a linear functional.\n\nIn the Galerkin method, we seek an approximate solution $u_h(x)$ in a finite-dimensional subspace $V_h$. Here, $V_h$ is spanned by the single basis function $\\phi(x)$, so $u_h(x) = c \\phi(x)$. We require the weak formulation to hold for all test functions $v_h(x)$ in this same subspace $V_h$. Since $V_h$ is one-dimensional, it is sufficient to test against the basis function $\\phi(x)$ itself.\nSubstituting $u_h(x) = c\\phi(x)$ for $u$ and $\\phi(x)$ for $v$, we get:\n$$\\int_0^4 (c\\phi(x))' \\phi'(x) dx = \\int_0^4 f(x) \\phi(x) dx$$\nSince $c$ is a constant, we can pull it out of the integral:\n$$c \\int_0^4 (\\phi'(x))^2 dx = \\int_0^4 f(x) \\phi(x) dx$$\nThis is a $1 \\times 1$ linear system for the unknown coefficient $c$. To solve for $c$, we must compute the two integrals.\n\nFirst, let's define the basis function $\\phi(x)$ and its derivative. It's a piecewise linear function connecting the points $(0,0)$, $(2,1)$, and $(4,0)$.\nFor $x \\in [0, 2]$, the function is a line from $(0,0)$ to $(2,1)$, so $\\phi(x) = \\frac{x}{2}$.\nFor $x \\in [2, 4]$, the function is a line from $(2,1)$ to $(4,0)$, so $\\phi(x) = \\frac{4-x}{2}$.\nThe derivative, $\\phi'(x)$, is piecewise constant:\n$$\\phi'(x) = \\begin{cases} 1/2 & \\text{if } 0 < x < 2 \\\\ -1/2 & \\text{if } 2 < x < 4 \\end{cases}$$\n\nNow, we compute the left-hand side integral (the coefficient of $c$):\n$$\\int_0^4 (\\phi'(x))^2 dx = \\int_0^2 \\left(\\frac{1}{2}\\right)^2 dx + \\int_2^4 \\left(-\\frac{1}{2}\\right)^2 dx$$\n$$= \\int_0^2 \\frac{1}{4} dx + \\int_2^4 \\frac{1}{4} dx = \\frac{1}{4} [x]_0^2 + \\frac{1}{4} [x]_2^4 = \\frac{1}{4}(2) + \\frac{1}{4}(4-2) = \\frac{1}{2} + \\frac{1}{2} = 1$$\n\nNext, we compute the right-hand side integral, using the given source term $f(x)$:\n$$\\int_0^4 f(x) \\phi(x) dx = \\int_0^2 x \\cdot \\phi(x) dx + \\int_2^4 0 \\cdot \\phi(x) dx$$\n$$= \\int_0^2 x \\left(\\frac{x}{2}\\right) dx = \\int_0^2 \\frac{x^2}{2} dx$$\n$$= \\left[ \\frac{x^3}{6} \\right]_0^2 = \\frac{2^3}{6} - \\frac{0^3}{6} = \\frac{8}{6} = \\frac{4}{3}$$\n\nFinally, we substitute these values back into the linear equation for $c$:\n$$c \\cdot (1) = \\frac{4}{3}$$\nTherefore, the value of the coefficient is $c = \\frac{4}{3}$.", "answer": "$$\\boxed{\\frac{4}{3}}$$", "id": "2154695"}, {"introduction": "Classical methods for solving PDEs can struggle with singular inputs, such as point forces or concentrated heat sources. The variational framework, however, handles these situations with elegance by incorporating them into the linear functional on the right-hand side of the weak form. This practice challenges you to correctly formulate this functional for a Poisson problem driven by a combination of a distributed source and a point source, modeled by a Dirac delta function, highlighting the framework's robustness in physical modeling [@problem_id:2154735].", "problem": "Consider the steady-state temperature distribution, $T(\\mathbf{x})$, in a thin, square conductive plate occupying the two-dimensional domain $\\Omega = (0, L) \\times (0, L)$. The edges of the plate are maintained at a constant zero temperature, so $T(\\mathbf{x})=0$ on the boundary $\\partial\\Omega$. The temperature distribution within the plate is governed by the Poisson equation:\n$$-\\nabla^2 T = \\frac{ S(\\mathbf{x}) }{k} $$\nwhere $k$ is the uniform thermal conductivity of the plate material and $S(\\mathbf{x})$ is the heat source density per unit area.\n\nThe plate is heated by two distinct sources: a smoothly distributed background source with density $S_{bg}(\\mathbf{x})$, and a highly concentrated point-like heat source of total power $Q$ located at an interior point $\\mathbf{x}_0 = (x_0, y_0) \\in \\Omega$. The total source density is modeled as $S(\\mathbf{x}) = S_{bg}(\\mathbf{x}) + Q \\delta(\\mathbf{x} - \\mathbf{x}_0)$, where $\\delta(\\cdot)$ is the two-dimensional Dirac delta function.\n\nThe variational (or weak) formulation of this boundary value problem seeks a function $T(\\mathbf{x})$ from a suitable function space such that the following integral equation holds for every sufficiently smooth \"test function\" $v(\\mathbf{x})$ that also vanishes on the boundary $\\partial\\Omega$:\n$$ \\int_{\\Omega} \\nabla T \\cdot \\nabla v \\, d\\mathbf{x} = \\int_{\\Omega} \\frac{S(\\mathbf{x})}{k} v(\\mathbf{x}) \\, d\\mathbf{x} $$\nThe right-hand side of this equation is a linear functional of the test function $v$, commonly denoted as $L(v)$. Which of the following expressions correctly represents this functional for the given heat source distribution?\n\nA. $L(v) = \\frac{1}{k} \\int_{\\Omega} S_{bg}(\\mathbf{x}) v(\\mathbf{x}) \\, d\\mathbf{x} + \\frac{Q}{k}$\n\nB. $L(v) = \\frac{1}{k} \\int_{\\Omega} S_{bg}(\\mathbf{x}) v(\\mathbf{x}_0) \\, d\\mathbf{x} + \\frac{Q}{k} v(\\mathbf{x}_0)$\n\nC. $L(v) = \\frac{1}{k} S_{bg}(\\mathbf{x}_0) v(\\mathbf{x}_0) + \\frac{Q}{k} v(\\mathbf{x}_0)$\n\nD. $L(v) = \\frac{1}{k} \\int_{\\Omega} S_{bg}(\\mathbf{x}) v(\\mathbf{x}) \\, d\\mathbf{x} + \\frac{Q}{k} v(\\mathbf{x}_0)$\n\nE. $L(v) = \\frac{1}{k} \\left( \\int_{\\Omega} S_{bg}(\\mathbf{x}) \\, d\\mathbf{x} \\right) v(\\mathbf{x}) + \\frac{Q}{k} v(\\mathbf{x}_0)$", "solution": "We start from the weak form stated:\n$$\\int_{\\Omega} \\nabla T \\cdot \\nabla v \\, d\\mathbf{x} = \\int_{\\Omega} \\frac{S(\\mathbf{x})}{k} \\, v(\\mathbf{x}) \\, d\\mathbf{x}.$$\nBy definition, the right-hand side is the linear functional\n$$L(v) = \\int_{\\Omega} \\frac{S(\\mathbf{x})}{k} \\, v(\\mathbf{x}) \\, d\\mathbf{x}.$$\nThe total source is given by\n$$S(\\mathbf{x}) = S_{bg}(\\mathbf{x}) + Q \\, \\delta(\\mathbf{x} - \\mathbf{x}_0).$$\nUsing linearity of the integral and the scaling by constants, we write\n$$L(v) = \\frac{1}{k} \\int_{\\Omega} \\left[ S_{bg}(\\mathbf{x}) + Q \\, \\delta(\\mathbf{x} - \\mathbf{x}_0) \\right] v(\\mathbf{x}) \\, d\\mathbf{x}.$$\nDistribute the integral:\n$$L(v) = \\frac{1}{k} \\int_{\\Omega} S_{bg}(\\mathbf{x}) \\, v(\\mathbf{x}) \\, d\\mathbf{x} + \\frac{Q}{k} \\int_{\\Omega} \\delta(\\mathbf{x} - \\mathbf{x}_0) \\, v(\\mathbf{x}) \\, d\\mathbf{x}.$$\nUse the defining property of the Dirac delta distribution in two dimensions, namely\n$$\\int_{\\Omega} \\delta(\\mathbf{x} - \\mathbf{x}_0) \\, v(\\mathbf{x}) \\, d\\mathbf{x} = v(\\mathbf{x}_0) \\quad \\text{for } \\mathbf{x}_0 \\in \\Omega.$$\nThus,\n$$L(v) = \\frac{1}{k} \\int_{\\Omega} S_{bg}(\\mathbf{x}) \\, v(\\mathbf{x}) \\, d\\mathbf{x} + \\frac{Q}{k} \\, v(\\mathbf{x}_0).$$\nComparing with the listed options, this coincides with option D. The other options are incorrect because:\n- A omits the dependence on $v$ for the point source, yielding a constant term $\\frac{Q}{k}$ rather than $\\frac{Q}{k} v(\\mathbf{x}_0)$.\n- B incorrectly replaces $v(\\mathbf{x})$ by $v(\\mathbfx_0)$ inside the background integral.\n- C collapses the background integral to $S_{bg}(\\mathbf{x}_0) v(\\mathbf{x}_0)$, which is not the correct action of the background source.\n- E factors $v(\\mathbf{x})$ outside the background integral, which is not valid since $v$ depends on $\\mathbf{x}$.\nTherefore the correct expression is option D.", "answer": "$$\\boxed{D}$$", "id": "2154735"}]}