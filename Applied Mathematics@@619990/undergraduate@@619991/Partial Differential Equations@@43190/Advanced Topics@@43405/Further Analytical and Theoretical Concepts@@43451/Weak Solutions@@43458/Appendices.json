{"hands_on_practices": [{"introduction": "Classical derivatives are limited to smooth functions, but the weak derivative extends this concept to functions with \"corners\" or \"jumps.\" This exercise provides foundational practice by asking you to apply the formal definition of a weak derivative to the absolute value function, $f(x) = |x|$. Mastering this process through integration by parts is a key step toward understanding modern analysis and partial differential equations. [@problem_id:2225014]", "id": "2225014", "problem": "In the study of partial differential equations and functional analysis, the concept of a derivative is extended to functions that are not classically differentiable. This leads to the notion of a weak derivative.\n\nLet $\\Omega$ be an open interval on the real line. A function $f$ is in the space $L^1_{\\text{loc}}(\\Omega)$ if it is integrable on every compact subinterval of $\\Omega$. The weak derivative of a function $f \\in L^1_{\\text{loc}}(\\Omega)$ is a function $g \\in L^1_{\\text{loc}}(\\Omega)$ that satisfies the following equation for all test functions $\\phi \\in C_c^{\\infty}(\\Omega)$:\n$$ \\int_{\\Omega} f(x) \\phi'(x) \\,dx = - \\int_{\\Omega} g(x) \\phi(x) \\,dx $$\nHere, $C_c^{\\infty}(\\Omega)$ is the space of all infinitely differentiable functions $\\phi: \\Omega \\to \\mathbb{R}$ that have compact support in $\\Omega$, meaning they are zero outside some closed and bounded interval contained within $\\Omega$.\n\nConsider the function $f(x) = |x|$ on the open interval $\\Omega = (-1, 1)$. Which of the following functions $g(x)$ represents the weak derivative of $f(x)$ on $\\Omega$?\n\nA. $g(x) = 1$ for all $x \\in (-1, 1)$\n\nB. $g(x) = \\begin{cases} -1 & \\text{if } -1 < x < 0 \\\\ 1 & \\text{if } 0 < x < 1 \\end{cases}$\n\nC. $g(x) = \\begin{cases} 1 & \\text{if } -1 < x < 0 \\\\ -1 & \\text{if } 0 < x < 1 \\end{cases}$\n\nD. $g(x) = 0$ for all $x \\in (-1, 1)$\n\nE. The weak derivative of $f(x) = |x|$ does not exist on $\\Omega = (-1, 1)$.\n\n", "solution": "We must find a function $g \\in L^{1}_{\\text{loc}}((-1,1))$ such that for all $\\phi \\in C_{c}^{\\infty}((-1,1))$,\n$$\n\\int_{-1}^{1} |x|\\,\\phi'(x)\\,dx = -\\int_{-1}^{1} g(x)\\,\\phi(x)\\,dx.\n$$\nA natural candidate is the sign function\n$$\ng(x)=\\begin{cases}\n-1 & \\text{if } -1<x<0,\\\\\n1 & \\text{if } 0<x<1,\n\\end{cases}\n$$\nwith any value at $x=0$ (irrelevant since changing $g$ on a set of measure zero does not affect the weak derivative).\n\nTo verify this, let $\\phi \\in C_{c}^{\\infty}((-1,1))$. Since $\\phi$ has compact support in $(-1,1)$, there is no boundary contribution at $x=\\pm 1$. Split the integral at $0$ and use integration by parts on each interval:\n$$\n\\int_{-1}^{1} |x|\\,\\phi'(x)\\,dx\n=\\int_{-1}^{0} (-x)\\,\\phi'(x)\\,dx+\\int_{0}^{1} x\\,\\phi'(x)\\,dx.\n$$\nOn $(-1,0)$,\n$$\n\\int_{-1}^{0} (-x)\\,\\phi'(x)\\,dx = \\left[(-x)\\phi(x)\\right]_{-1}^{0} - \\int_{-1}^{0}(-1)\\,\\phi(x)\\,dx\n= 0 + \\int_{-1}^{0}\\phi(x)\\,dx,\n$$\nbecause $\\phi$ vanishes near $x=-1$ and $(-0)\\phi(0)=0$. On $(0,1)$,\n$$\n\\int_{0}^{1} x\\,\\phi'(x)\\,dx = \\left[x\\phi(x)\\right]_{0}^{1} - \\int_{0}^{1} 1\\cdot \\phi(x)\\,dx\n= 0 - \\int_{0}^{1}\\phi(x)\\,dx,\n$\nsince $\\phi$ vanishes near $x=1$ and $0\\cdot \\phi(0)=0$. Therefore,\n$$\n\\int_{-1}^{1} |x|\\,\\phi'(x)\\,dx\n= \\int_{-1}^{0}\\phi(x)\\,dx - \\int_{0}^{1}\\phi(x)\\,dx\n= -\\int_{-1}^{0}(-1)\\phi(x)\\,dx - \\int_{0}^{1} (1)\\phi(x)\\,dx\n= -\\int_{-1}^{1} g(x)\\,\\phi(x)\\,dx,\n$$\nwith $g$ as defined above. This shows that $g$ is a weak derivative of $|x|$ on $(-1,1)$. Hence the correct choice is the piecewise function with $-1$ on $(-1,0)$ and $1$ on $(0,1)$, which is option B. The value at $x=0$ is immaterial for the weak derivative.", "answer": "$$\\boxed{B}$$"}, {"introduction": "The weak formulation transforms a differential equation into an equivalent integral equation, a crucial step for handling non-smooth solutions. This practice problem offers a direct verification of this principle. By calculating the integrals for a given set of functions, you will confirm that a candidate function is indeed a weak solution, connecting abstract theory to concrete computation. [@problem_id:2225052]", "id": "2225052", "problem": "In the finite element method, a differential equation is often reformulated into an integral form known as the weak or variational formulation. This allows for the consideration of a broader class of solutions than classical (differentiable) solutions.\n\nConsider the one-dimensional boundary value problem (BVP) on the interval $(0, 1)$:\n$$\n-u''(x) = f(x), \\quad \\text{with boundary conditions} \\quad u(0) = 0 \\text{ and } u(1) = 0.\n$$\nThe weak formulation of this BVP states that a function $u(x)$ (which must satisfy the boundary conditions) is a weak solution if the following integral identity holds for every \"test function\" $v(x)$ that also satisfies the homogeneous boundary conditions, i.e., $v(0)=0$ and $v(1)=0$:\n$$\n\\int_{0}^{1} u'(x) v'(x) dx = \\int_{0}^{1} f(x) v(x) dx\n$$\n\nNow, consider the specific case where the source function is $f(x) = 12x^2 - 2$. A candidate for the weak solution is the function $u(x) = x^2(1 - x^2)$. To test this claim, one can select a specific test function and verify that the integral identity holds.\n\nLet the test function be $v(x) = \\sin(\\pi x)$. If the candidate $u(x)$ is indeed a weak solution, then the values of the two integrals in the weak formulation must be equal. Your task is to calculate this common value.\n\nExpress your answer as a single closed-form analytic expression in terms of $\\pi$.\n\n", "solution": "We are given the boundary value problem with $f(x)=12x^{2}-2$, candidate $u(x)=x^{2}(1-x^{2})$, and test function $v(x)=\\sin(\\pi x)$. The weak formulation requires\n$$\n\\int_{0}^{1} u'(x)\\,v'(x)\\,dx=\\int_{0}^{1} f(x)\\,v(x)\\,dx.\n$$\nSince $u''(x)=2-12x^{2}$, we have $-u''(x)=12x^{2}-2=f(x)$ and $u(0)=u(1)=0$, so $u$ is the strong solution and the identity holds for all admissible $v$. We compute the common value using the right-hand side:\n$$\nI=\\int_{0}^{1} \\left(12x^{2}-2\\right)\\sin(\\pi x)\\,dx=12\\int_{0}^{1} x^{2}\\sin(a x)\\,dx-2\\int_{0}^{1}\\sin(a x)\\,dx,\n$$\nwhere we set $a=\\pi$ for clarity.\n\nFirst, compute $S_{0}=\\int_{0}^{1}\\sin(a x)\\,dx$:\n$$\nS_{0}=\\left[-\\frac{\\cos(a x)}{a}\\right]_{0}^{1}=\\frac{1-\\cos a}{a}.\n$$\nNext, compute $S_{2}=\\int_{0}^{1}x^{2}\\sin(a x)\\,dx$ by integration by parts with $u=x^{2}$ and $dv=\\sin(a x)\\,dx$, which gives $du=2x\\,dx$ and $v=-\\cos(a x)/a$:\n$$\nS_{2}=\\left[-\\frac{x^{2}\\cos(a x)}{a}\\right]_{0}^{1}+\\frac{2}{a}\\int_{0}^{1} x\\cos(a x)\\,dx= -\\frac{\\cos a}{a}+\\frac{2}{a}\\int_{0}^{1} x\\cos(a x)\\,dx.\n$$\nFor $C_{1}=\\int_{0}^{1} x\\cos(a x)\\,dx$, integrate by parts with $u=x$, $dv=\\cos(a x)\\,dx$ to get $du=dx$ and $v=\\sin(a x)/a$:\n$$\nC_{1}=\\left[\\frac{x\\sin(a x)}{a}\\right]_{0}^{1}-\\frac{1}{a}\\int_{0}^{1}\\sin(a x)\\,dx=\\frac{\\sin a}{a}-\\frac{S_{0}}{a}=\\frac{\\sin a}{a}+\\frac{\\cos a-1}{a^{2}}.\n$$\nTherefore,\n$$\nS_{2}=-\\frac{\\cos a}{a}+\\frac{2}{a}\\left(\\frac{\\sin a}{a}+\\frac{\\cos a-1}{a^{2}}\\right)= -\\frac{\\cos a}{a}+\\frac{2\\sin a}{a^{2}}+\\frac{2(\\cos a-1)}{a^{3}}.\n$$\nAssembling $I$,\n$$\nI=12S_{2}-2S_{0}=-\\frac{12\\cos a}{a}+\\frac{24\\sin a}{a^{2}}+\\frac{24(\\cos a-1)}{a^{3}}-\\frac{2(1-\\cos a)}{a}.\n$$\nCombine the $1/a$ terms:\n$$\n-\\frac{12\\cos a}{a}-\\frac{2(1-\\cos a)}{a}=\\frac{-10\\cos a-2}{a},\n$$\nso\n$$\nI=\\frac{-10\\cos a-2}{a}+\\frac{24\\sin a}{a^{2}}+\\frac{24(\\cos a-1)}{a^{3}}.\n$$\nNow substitute $a=\\pi$, using $\\cos \\pi=-1$ and $\\sin \\pi=0$:\n$$\nI=\\frac{-10(-1)-2}{\\pi}+\\frac{24\\cdot 0}{\\pi^{2}}+\\frac{24((-1)-1)}{\\pi^{3}}=\\frac{8}{\\pi}-\\frac{48}{\\pi^{3}}.\n$$\nThus, the two integrals in the weak formulation both equal $8/\\pi-48/\\pi^{3}$ for the chosen test function.", "answer": "$$\\boxed{\\frac{8}{\\pi}-\\frac{48}{\\pi^{3}}}$$"}, {"introduction": "Beyond analysis, the weak formulation is a powerful tool for constructing approximate solutions to complex differential equations. This exercise introduces the Galerkin method, where the problem is projected onto a simpler function space to find an approximate solution. By building and solving a small linear system, you will gain hands-on experience with the core idea behind the widely used Finite Element Method. [@problem_id:2157325]", "id": "2157325", "problem": "Consider the one-dimensional Poisson equation $-u''(x) = f(x)$ on the interval $x \\in (0, 1)$, subject to homogeneous Dirichlet boundary conditions $u(0) = 0$ and $u(1) = 0$. The source term is given by the function $f(x) = x$.\n\nWe wish to find an approximate solution to this boundary value problem using the Galerkin method. The approximate solution, denoted $u_h(x)$, is sought within a finite-dimensional space spanned by a set of basis functions that satisfy the boundary conditions. Specifically, we define the approximate solution as a linear combination of two basis functions:\n$$u_h(x) = c_1 \\phi_1(x) + c_2 \\phi_2(x)$$\nwhere the coefficients $c_1$ and $c_2$ are unknown constants to be determined. The chosen basis functions are given by:\n$$ \\phi_1(x) = x(1-x) $$\n$$ \\phi_2(x) = x^2(1-x) $$\nThe Galerkin method transforms the original differential equation into a system of linear equations for the coefficients $c_1$ and $c_2$.\n\nDetermine the value of the sum of these coefficients, $c_1 + c_2$. Express your answer as a fraction in simplest form.\n\n", "solution": "We solve the boundary value problem by the Galerkin method in the space spanned by the given basis functions that satisfy the homogeneous Dirichlet boundary conditions. The weak form of the problem for $-u''=f$ with $u(0)=u(1)=0$ is: find $u \\in V$ such that\n$$\n\\int_{0}^{1} u'(x)\\,v'(x)\\,dx=\\int_{0}^{1} f(x)\\,v(x)\\,dx \\quad \\text{for all } v \\in V,\n$$\nwhere $V$ is the subspace of $H^{1}(0,1)$ with $v(0)=v(1)=0$. In the Galerkin approximation, we set $u_{h}(x)=c_{1}\\phi_{1}(x)+c_{2}\\phi_{2}(x)$ with $\\phi_{1}(x)=x(1-x)$ and $\\phi_{2}(x)=x^{2}(1-x)$, and enforce the weak form for $v=\\phi_{i}$, $i=1,2$. This yields the linear system\n$$\n\\sum_{j=1}^{2} K_{ij} c_{j}=F_{i}, \\quad i=1,2,\n$$\nwith stiffness entries $K_{ij}=\\int_{0}^{1} \\phi_{i}'(x)\\,\\phi_{j}'(x)\\,dx$ and load entries $F_{i}=\\int_{0}^{1} f(x)\\,\\phi_{i}(x)\\,dx$.\n\nCompute the derivatives:\n$$\n\\phi_{1}(x)=x-x^{2}, \\quad \\phi_{1}'(x)=1-2x, \\qquad \\phi_{2}(x)=x^{2}-x^{3}, \\quad \\phi_{2}'(x)=2x-3x^{2}.\n$$\nCompute the stiffness matrix entries:\n$$\nK_{11}=\\int_{0}^{1} (1-2x)^{2}\\,dx=\\int_{0}^{1} (1-4x+4x^{2})\\,dx=\\left[x-2x^{2}+\\frac{4}{3}x^{3}\\right]_{0}^{1}=\\frac{1}{3},\n$$\n$$\nK_{12}=\\int_{0}^{1} (1-2x)(2x-3x^{2})\\,dx=\\int_{0}^{1} (2x-7x^{2}+6x^{3})\\,dx=\\left[x^{2}-\\frac{7}{3}x^{3}+\\frac{3}{2}x^{4}\\right]_{0}^{1}=\\frac{1}{6},\n$$\nby symmetry $K_{21}=K_{12}=\\frac{1}{6}$, and\n$$\nK_{22}=\\int_{0}^{1} (2x-3x^{2})^{2}\\,dx=\\int_{0}^{1} (4x^{2}-12x^{3}+9x^{4})\\,dx=\\left[\\frac{4}{3}x^{3}-3x^{4}+\\frac{9}{5}x^{5}\\right]_{0}^{1}=\\frac{2}{15}.\n$$\nCompute the load vector entries for $f(x)=x$:\n$$\nF_{1}=\\int_{0}^{1} x\\,\\phi_{1}(x)\\,dx=\\int_{0}^{1} (x^{2}-x^{3})\\,dx=\\left[\\frac{x^{3}}{3}-\\frac{x^{4}}{4}\\right]_{0}^{1}=\\frac{1}{12},\n$$\n$$\nF_{2}=\\int_{0}^{1} x\\,\\phi_{2}(x)\\,dx=\\int_{0}^{1} (x^{3}-x^{4})\\,dx=\\left[\\frac{x^{4}}{4}-\\frac{x^{5}}{5}\\right]_{0}^{1}=\\frac{1}{20}.\n$$\nThus the linear system is\n$$\n\\begin{pmatrix}\n\\frac{1}{3} & \\frac{1}{6} \\\\\n\\frac{1}{6} & \\frac{2}{15}\n\\end{pmatrix}\n\\begin{pmatrix}\nc_{1} \\\\ c_{2}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n\\frac{1}{12} \\\\ \\frac{1}{20}\n\\end{pmatrix}.\n$$\nThe determinant of the stiffness matrix is\n$$\n\\det K=\\frac{1}{3}\\cdot \\frac{2}{15}-\\left(\\frac{1}{6}\\right)^{2}=\\frac{2}{45}-\\frac{1}{36}=\\frac{1}{60}.\n$$\nBy Cramer's rule,\n$$\nc_{1}=\\frac{K_{22}F_{1}-K_{12}F_{2}}{\\det K}\n=\\frac{\\frac{2}{15}\\cdot \\frac{1}{12}-\\frac{1}{6}\\cdot \\frac{1}{20}}{\\frac{1}{60}}\n=\\frac{\\frac{1}{90}-\\frac{1}{120}}{\\frac{1}{60}}\n=\\frac{\\frac{1}{360}}{\\frac{1}{60}}\n=\\frac{1}{6},\n$$\n$$\nc_{2}=\\frac{K_{11}F_{2}-K_{21}F_{1}}{\\det K}\n=\\frac{\\frac{1}{3}\\cdot \\frac{1}{20}-\\frac{1}{6}\\cdot \\frac{1}{12}}{\\frac{1}{60}}\n=\\frac{\\frac{1}{60}-\\frac{1}{72}}{\\frac{1}{60}}\n=\\frac{\\frac{1}{360}}{\\frac{1}{60}}\n=\\frac{1}{6}.\n$$\nTherefore,\n$$\nc_{1}+c_{2}=\\frac{1}{6}+\\frac{1}{6}=\\frac{1}{3}.\n$$", "answer": "$$\\boxed{\\frac{1}{3}}$$"}]}