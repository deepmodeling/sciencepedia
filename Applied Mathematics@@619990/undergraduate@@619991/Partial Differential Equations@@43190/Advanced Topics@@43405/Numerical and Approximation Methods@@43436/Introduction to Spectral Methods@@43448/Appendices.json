{"hands_on_practices": [{"introduction": "In spectral methods, a crucial first step is choosing the right set of basis functions to represent our problem. A smart choice can drastically simplify calculations by making many coefficients in the series expansion equal to zero. This exercise [@problem_id:2114628] explores this fundamental principle by asking you to determine the most efficient Fourier series for a function based on its symmetry, a property known as parity.", "problem": "When representing a function on a symmetric interval for applications in fields like partial differential equations, the choice of basis functions can significantly impact the efficiency of the representation. A representation is considered more efficient if a large number of its series coefficients are identically zero.\n\nConsider the function $f(x) = x \\cos(x)$ defined on the interval $[-L, L]$, where $L$ is a positive constant. Which of the following Fourier-type series representations would be the most efficient for this function on the given interval?\n\nA. A Fourier cosine series, of the form $\\sum_{n=0}^{\\infty} a_n \\cos(\\frac{n\\pi x}{L})$.\n\nB. A Fourier sine series, of the form $\\sum_{n=1}^{\\infty} b_n \\sin(\\frac{n\\pi x}{L})$.\n\nC. A full real Fourier series, containing both sine and cosine terms.\n\nD. The function cannot be represented by a standard Fourier series on this interval because it contains a product of a polynomial and a trigonometric function.", "solution": "We analyze the parity of the function on the symmetric interval. Since $\\cos(x)$ is even and $x$ is odd, their product is odd:\n$$\nf(-x)=(-x)\\cos(-x)=-x\\cos(x)=-f(x).\n$$\nTherefore $f$ is odd on $[-L,L]$.\n\nFor a Fourier representation on $[-L,L]$, the cosine basis functions $\\cos\\!\\left(\\frac{n\\pi x}{L}\\right)$ are even and the sine basis functions $\\sin\\!\\left(\\frac{n\\pi x}{L}\\right)$ are odd. In a full real Fourier series,\n$$\nf(x)=\\frac{a_{0}}{2}+\\sum_{n=1}^{\\infty}\\left[a_{n}\\cos\\!\\left(\\frac{n\\pi x}{L}\\right)+b_{n}\\sin\\!\\left(\\frac{n\\pi x}{L}\\right)\\right],\n$$\nthe coefficients are given (up to the conventional normalization) by integrals over $[-L,L]$. Using parity and the orthogonality over a symmetric interval,\n$$\na_{0}\\propto \\int_{-L}^{L} f(x)\\,dx=0 \\quad \\text{since } f \\text{ is odd},\n$$\n$$\na_{n}\\propto \\int_{-L}^{L} f(x)\\cos\\!\\left(\\frac{n\\pi x}{L}\\right)\\,dx=0 \\quad \\text{since odd}\\times\\text{even}=\\text{odd integrates to }0,\n$$\n$$\nb_{n}\\propto \\int_{-L}^{L} f(x)\\sin\\!\\left(\\frac{n\\pi x}{L}\\right)\\,dx \\quad \\text{need not vanish since odd}\\times\\text{odd}=\\text{even}.\n$$\nHence all cosine coefficients (including $a_{0}$) are identically zero, while sine coefficients may be nonzero. Therefore the most efficient representation is the Fourier sine series, which uses only the sine basis adapted to odd functions. The claim that such a function cannot be represented by a standard Fourier series is false, and the full Fourier series is less efficient because it includes identically vanishing cosine terms.", "answer": "$$\\boxed{B}$$", "id": "2114628"}, {"introduction": "Once we have chosen an appropriate basis, the next step is to determine the coefficients that define the series representation for a given function. These coefficients are found by exploiting the orthogonality of the basis functions, a key mathematical property that allows us to isolate each component of the series. This practice [@problem_id:2114651] provides hands-on experience with this core calculation, requiring you to compute a specific coefficient for a Fourier sine series.", "problem": "Consider a function $f(x)=1$ defined over the interval $x \\in [0, \\pi]$. We wish to approximate this function using its Fourier sine series, which is given by the general form:\n$$S(x) = \\sum_{n=1}^{\\infty} b_n \\sin(nx)$$\nThe coefficients $b_n$ are constants determined by the specific function $f(x)$ being approximated.\n\nCalculate the exact analytical value of the coefficient $b_3$ for the Fourier sine series of the function $f(x)=1$ on the specified interval.", "solution": "We expand $f(x)=1$ on $[0,\\pi]$ in a Fourier sine series $S(x)=\\sum_{n=1}^{\\infty} b_{n} \\sin(nx)$. By orthogonality on $[0,\\pi]$, the coefficients are determined by\n$$\nb_{n}=\\frac{2}{\\pi}\\int_{0}^{\\pi} f(x)\\sin(nx)\\,dx,\n$$\nsince $\\int_{0}^{\\pi}\\sin(nx)\\sin(mx)\\,dx=\\frac{\\pi}{2}\\delta_{nm}$.\n\nFor $f(x)=1$,\n$$\nb_{n}=\\frac{2}{\\pi}\\int_{0}^{\\pi}\\sin(nx)\\,dx.\n$$\nCompute the integral:\n$$\n\\int_{0}^{\\pi}\\sin(nx)\\,dx=\\left[-\\frac{1}{n}\\cos(nx)\\right]_{0}^{\\pi}=-\\frac{1}{n}\\cos(n\\pi)+\\frac{1}{n}\\cos(0)=\\frac{1}{n}\\left(1-(-1)^{n}\\right).\n$$\nTherefore,\n$$\nb_{n}=\\frac{2}{\\pi n}\\left(1-(-1)^{n}\\right).\n$$\nFor $n=3$, we have $(-1)^{3}=-1$, hence\n$$\nb_{3}=\\frac{2}{3\\pi}\\left(1-(-1)\\right)=\\frac{2}{3\\pi}\\cdot 2=\\frac{4}{3\\pi}.\n$$", "answer": "$$\\boxed{\\frac{4}{3\\pi}}$$", "id": "2114651"}, {"introduction": "The true power of spectral methods lies in their application to solving complex differential equations, which are fundamental to science and engineering. This capstone problem [@problem_id:2114664] illustrates a modern approach, the Chebyshev collocation method, which extends the ideas of series representation to solve a challenging integro-differential equation. By tackling this, you will see how the foundational concepts of basis functions and collocation points are assembled into a powerful numerical tool.", "problem": "Consider the one-dimensional integro-differential equation on the domain $x \\in [-1, 1]$:\n$$-u_{xx}(x) + \\alpha u(x) = f(x) + \\beta \\int_{-1}^{1} u(y) \\, dy$$\nThe solution $u(x)$ is subject to the boundary conditions:\n$$u(-1) = 0 \\quad \\text{and} \\quad u'(1) = \\gamma u(1)$$\nHere, $\\alpha$, $\\beta$, and $\\gamma$ are real constants.\n\nWe aim to solve this problem numerically using a Chebyshev collocation (pseudospectral) method. The solution $u(x)$ is approximated by a single global polynomial $u_N(x)$ of degree at most $N$. The collocation points are the $N+1$ Chebyshev-Gauss-Lobatto (CGL) nodes, given by $x_j = \\cos\\left(\\frac{j\\pi}{N}\\right)$ for $j=0, 1, \\dots, N$. The values of the polynomial at these nodes, $u_j = u_N(x_j)$, are the unknowns to be determined. The differential equation and boundary conditions are enforced exactly at these nodes.\n\nFor a discretization with $N=3$, a forcing function $f(x) = 2x^2 - 1$, and constants $\\alpha=1$, $\\beta=1$, $\\gamma=1$, find the value of the solution at the node $x_1$, which is denoted by $u_1$.\n\nExpress your answer for $u_1$ as an exact fraction in simplest form.", "solution": "We discretize with $N=3$ Chebyshev-Gauss-Lobatto nodes $x_{j}=\\cos\\left(\\frac{j\\pi}{3}\\right)$ for $j=0,1,2,3$, which are\n$$\nx_{0}=1,\\quad x_{1}=\\frac{1}{2},\\quad x_{2}=-\\frac{1}{2},\\quad x_{3}=-1.\n$$\nLet $u_{j}=u(x_{j})$. The first-derivative Chebyshev differentiation matrix $D$ at these nodes has entries\n$$\nD_{ij}=\\begin{cases}\n\\dfrac{c_{i}}{c_{j}}\\dfrac{(-1)^{i+j}}{x_{i}-x_{j}}, & i\\neq j,\\\\[6pt]\n\\dfrac{2N^{2}+1}{6}, & i=j=0,\\\\[4pt]\n-\\dfrac{2N^{2}+1}{6}, & i=j=N,\\\\[4pt]\n-\\dfrac{x_{j}}{2(1-x_{j}^{2})}, & \\text{otherwise},\n\\end{cases}\n$$\nwith $c_{0}=c_{N}=2$ and $c_{1}=c_{2}=1$, $N=3$. A direct computation gives\n$$\nD=\\begin{pmatrix}\n\\dfrac{19}{6} & -4 & \\dfrac{4}{3} & -\\dfrac{1}{2}\\\\[6pt]\n1 & -\\dfrac{1}{3} & -1 & \\dfrac{1}{3}\\\\[6pt]\n-\\dfrac{1}{3} & 1 & \\dfrac{1}{3} & -1\\\\[6pt]\n\\dfrac{1}{2} & -\\dfrac{4}{3} & 4 & -\\dfrac{19}{6}\n\\end{pmatrix}.\n$$\nThe second-derivative matrix is $D^{(2)}=D^{2}$. Multiplying, the rows needed at the interior nodes $j=1,2$ are\n$$\nD^{(2)}_{1,\\cdot}=\\left(\\dfrac{10}{3},\\,-\\dfrac{16}{3},\\,\\dfrac{8}{3},\\,-\\dfrac{2}{3}\\right),\\qquad\nD^{(2)}_{2,\\cdot}=\\left(-\\dfrac{2}{3},\\,\\dfrac{8}{3},\\,-\\dfrac{16}{3},\\,\\dfrac{10}{3}\\right).\n$$\n\nWe enforce the PDE at the interior nodes and the boundary conditions at the endpoints. With $\\alpha=\\beta=\\gamma=1$ and $f(x)=2x^{2}-1$, the discrete equations at $j=1,2$ are\n$$\n-\\left(D^{(2)}u\\right)_{j}+u_{j}=f_{j}+I,\\quad j=1,2,\n$$\nwhere $I=\\int_{-1}^{1}u(y)\\,dy$ is approximated by exactly integrating the degree-$3$ interpolant $u_{N}$:\n$$\nI=\\sum_{j=0}^{3}w_{j}u_{j},\\quad w_{j}=\\int_{-1}^{1}\\ell_{j}(x)\\,dx.\n$$\nImposing exactness for monomials up to degree $3$ and using symmetry gives $w_{0}=w_{3}=a$, $w_{1}=w_{2}=b$ with\n$$\na+b=1,\\qquad 2a+\\frac{b}{2}=\\frac{2}{3}\\ \\Longrightarrow\\ a=\\frac{1}{9},\\ b=\\frac{8}{9}.\n$$\nHence\n$$\nI=\\frac{1}{9}u_{0}+\\frac{8}{9}u_{1}+\\frac{8}{9}u_{2}+\\frac{1}{9}u_{3}.\n$$\n\nThe boundary conditions are $u(-1)=0\\Rightarrow u_{3}=0$ and $u'(1)=u(1)\\Rightarrow (Du)_{0}=u_{0}$, i.e.\n$$\n\\left(\\frac{19}{6}\\right)u_{0}-4u_{1}+\\left(\\frac{4}{3}\\right)u_{2}-\\left(\\frac{1}{2}\\right)u_{3}=u_{0}\\ \\Longrightarrow\\ 13u_{0}-24u_{1}+8u_{2}=0.\n$$\n\nEvaluate $f$ at the nodes:\n$$\nf_{0}=1,\\quad f_{1}=-\\frac{1}{2},\\quad f_{2}=-\\frac{1}{2},\\quad f_{3}=1.\n$$\nUsing $u_{3}=0$ and $I=\\frac{1}{9}u_{0}+\\frac{8}{9}u_{1}+\\frac{8}{9}u_{2}$, the interior equations become\n$$\n-\\left(\\frac{10}{3}u_{0}-\\frac{16}{3}u_{1}+\\frac{8}{3}u_{2}\\right)+u_{1}=-\\frac{1}{2}+I,\n$$\n$$\n-\\left(-\\frac{2}{3}u_{0}+\\frac{8}{3}u_{1}-\\frac{16}{3}u_{2}\\right)+u_{2}=-\\frac{1}{2}+I.\n$$\nMultiplying both equations by $3$ and substituting $3I=\\frac{1}{3}u_{0}+\\frac{8}{3}u_{1}+\\frac{8}{3}u_{2}$ yields\n$$\n-10u_{0}+19u_{1}-8u_{2}=-\\frac{3}{2}+\\frac{1}{3}u_{0}+\\frac{8}{3}u_{1}+\\frac{8}{3}u_{2},\n$$\n$$\n2u_{0}-8u_{1}+19u_{2}=-\\frac{3}{2}+\\frac{1}{3}u_{0}+\\frac{8}{3}u_{1}+\\frac{8}{3}u_{2}.\n$$\nBringing all terms to the left and clearing denominators (multiply by $6$) gives\n$$\n-62u_{0}+98u_{1}-64u_{2}=-9,\\qquad 10u_{0}-64u_{1}+98u_{2}=-9,\n$$\ntogether with the boundary-condition equation\n$$\n13u_{0}-24u_{1}+8u_{2}=0.\n$$\nFrom $13u_{0}-24u_{1}+8u_{2}=0$ we get $u_{0}=\\frac{24}{13}u_{1}-\\frac{8}{13}u_{2}$. Substituting this into the two interior equations yields the $2\\times 2$ system\n$$\n214u_{1}+336u_{2}=117,\\qquad 592u_{1}-1194u_{2}=117.\n$$\nSolving, one finds\n$$\nu_{1}=\\frac{765}{1942},\\qquad u_{2}=\\frac{189}{1942}.\n$$\nTherefore, the requested value at node $x_{1}$ is the exact fraction $u_{1}=\\frac{765}{1942}$.", "answer": "$$\\boxed{\\frac{765}{1942}}$$", "id": "2114664"}]}