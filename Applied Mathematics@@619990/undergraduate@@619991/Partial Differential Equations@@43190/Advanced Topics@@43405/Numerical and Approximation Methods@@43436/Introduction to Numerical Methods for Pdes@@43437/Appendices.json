{"hands_on_practices": [{"introduction": "The heat equation is a cornerstone of parabolic partial differential equations, and the Forward-Time Central-Space (FTCS) scheme is often the first numerical method learned for solving it. This exercise [@problem_id:2114210] explores the critical link between the scheme's numerical stability condition and the physical behavior of the solution. You will see how satisfying the stability constraint on the mesh ratio, $r = \\frac{\\alpha \\Delta t}{(\\Delta x)^2}$, ensures the numerical solution respects a discrete maximum principle, preventing the generation of unphysical temperature extremes not present in the anitial or boundary data.", "problem": "A one-dimensional metallic rod of length $L=1.0$ m has a thermal diffusivity of $\\alpha = 0.01$ m$^2$/s. The temperature distribution $u(x,t)$ in the rod is governed by the heat equation $u_t = \\alpha u_{xx}$.\n\nWe wish to simulate the temperature evolution using the explicit Forward-Time Central-Space (FTCS) numerical method. The rod is discretized into $J=5$ equal subintervals, leading to a spatial step size of $\\Delta x = L/J$. The simulation uses a time step of $\\Delta t=1.6$ s. The FTCS scheme for an interior spatial node $j$ is given by:\n$$u_j^{n+1} = u_j^n + \\frac{\\alpha \\Delta t}{(\\Delta x)^2} (u_{j+1}^n - 2u_j^n + u_{j-1}^n)$$\nwhere $u_j^n$ is the numerical approximation of the temperature at spatial grid point $x_j = j \\Delta x$ and time $t_n = n \\Delta t$.\n\nThe initial temperature distribution at $t=0$ across the rod is given by the function:\n$$ u(x, 0) = \\begin{cases} 300 + 100x & \\text{for } 0 \\le x \\le 0.6 \\\\ 360 & \\text{for } 0.6 < x \\le 1.0 \\end{cases} $$\nwhere the temperature is in Kelvin and $x$ is in meters.\n\nFor all times $t > 0$, the ends of the rod are held at constant temperatures, imposing the boundary conditions:\n- $u(0, t) = 300$ K\n- $u(1.0, t) = 375$ K\n\nThe numerical solution $u_j^n$ is set to match these initial and boundary conditions at the corresponding grid points. Specifically, $u_j^0$ is determined by $u(x_j, 0)$, and for all time steps $n \\ge 0$, $u_0^n = 300$ K and $u_J^n = 375$ K.\n\nAssuming the simulation runs for a very long time, what is the maximum temperature that will ever be reached at any grid point on the rod? Express your answer in Kelvin, rounded to four significant figures.", "solution": "We discretize the rod of length $L$ into $J=5$ equal subintervals, so the spatial step is\n$$\n\\Delta x = \\frac{L}{J} = \\frac{1.0}{5} = 0.2.\n$$\nWith time step $\\Delta t=1.6$ and thermal diffusivity $\\alpha=0.01$, the FTCS scheme at interior nodes can be written as\n$$\nu_{j}^{n+1}=u_{j}^{n}+\\frac{\\alpha\\Delta t}{(\\Delta x)^{2}}\\left(u_{j+1}^{n}-2u_{j}^{n}+u_{j-1}^{n}\\right)\n=(1-2r)u_{j}^{n}+r\\,u_{j-1}^{n}+r\\,u_{j+1}^{n},\n$$\nwhere\n$$\nr=\\frac{\\alpha\\Delta t}{(\\Delta x)^{2}}=\\frac{0.01\\times 1.6}{(0.2)^{2}}=\\frac{0.016}{0.04}=0.4.\n$$\nSince $r \\le \\frac{1}{2}$, the coefficients $(1-2r), r, r$ are nonnegative and sum to $1$, making $u_{j}^{n+1}$ a convex combination of $u_{j-1}^{n}$, $u_{j}^{n}$, and $u_{j+1}^{n}$. This ensures a discrete maximum principle: no new maxima are created in the interior, and the maximum over all grid points at time $t_{n+1}$ is bounded above by the maximum over all grid points at time $t_{n}$, including boundary values.\n\nThe boundary conditions are imposed for all $n \\ge 0$ as $u_0^n=300$ and $u_J^n=375$. Therefore, for every time level $n$, the global maximum over all grid points is at most $375$ and is in fact attained at the right boundary node $j=J$ because $u_J^n=375$ for all $n$. Consequently, the maximum temperature ever reached at any grid point is $375$.\n\nAs $t\\to\\infty$, the numerical solution converges to the steady-state linear profile solving $u_{xx}=0$ with $u(0)=300$ and $u(1)=375$, which takes values strictly below $375$ in the interior and reaches $375$ only at $x=1$. Hence no interior overshoot above $375$ occurs at any time.\n\nTherefore, the maximum temperature ever reached at any grid point on the rod is $375$ K. Rounded to four significant figures, this is $375.0$.", "answer": "$$\\boxed{375.0}$$", "id": "2114210"}, {"introduction": "Moving from parabolic to hyperbolic PDEs, this problem tackles the wave equation using a fully implicit finite difference scheme. Implicit methods are prized for their superior stability properties, often allowing for much larger time steps than explicit methods. The trade-off is the need to solve a system of linear equations at each time step. This practice exercise [@problem_id:2114199] provides direct experience in deriving this linear system, a fundamental task when implementing and understanding the mechanics of implicit schemes.", "problem": "Consider the one-dimensional wave equation $u_{tt} = c^2 u_{xx}$, which models the displacement $u(x,t)$ of a vibrating string at position $x$ and time $t$. The wave speed is a constant, $c > 0$. The string has a length $L$ and is fixed at both ends, which corresponds to the homogeneous Dirichlet boundary conditions $u(0, t) = 0$ and $u(L, t) = 0$ for all time $t \\ge 0$.\n\nTo solve this equation numerically, the spatio-temporal domain is discretized using a uniform spatial grid with spacing $\\Delta x$ and a uniform time grid with spacing $\\Delta t$. The grid points are denoted by $(x_i, t_n) = (i\\Delta x, n\\Delta t)$, and the numerical approximation to the solution at these points is $u_i^n \\approx u(x_i, t_n)$. The interior spatial points are indexed from $i=1$ to $N_x-1$, where $L = N_x \\Delta x$.\n\nA fully implicit finite difference scheme is constructed to approximate the solution. In this scheme, the second partial derivative with respect to time, $u_{tt}$, is approximated by a second-order accurate central difference centered at time $t_n$. The second partial derivative with respect to space, $u_{xx}$, is approximated by a second-order accurate central difference evaluated entirely at the future time level $t_{n+1}$.\n\nFor each time step, this numerical scheme yields a system of linear equations for the unknown displacements $\\mathbf{u}^{n+1} = [u_1^{n+1}, u_2^{n+1}, \\dots, u_{N_x-1}^{n+1}]^T$. This system can be written in the matrix form $A \\mathbf{u}^{n+1} = \\mathbf{b}$, where $A$ is an $(N_x-1) \\times (N_x-1)$ matrix whose entries depend on the discretization parameters, and $\\mathbf{b}$ is a vector of known values from previous time levels. The resulting matrix $A$ is a constant-coefficient tridiagonal matrix.\n\nLet $\\lambda = \\frac{c \\Delta t}{\\Delta x}$ be the dimensionless parameter that relates the grid spacings and the wave speed. The three non-zero diagonals of matrix $A$ have constant values. Determine these values. The final answer is composed of three expressions corresponding to the sub-diagonal entry ($a$), the main diagonal entry ($d$), and the super-diagonal entry ($c$). Provide these three expressions as a row matrix.", "solution": "We begin with the one-dimensional wave equation $u_{tt}=c^{2}u_{xx}$ on $x \\in [0,L]$ with homogeneous Dirichlet boundary conditions $u(0,t)=0$ and $u(L,t)=0$. On the uniform grid $(x_{i},t_{n})=(i\\Delta x,n\\Delta t)$, we approximate\n$$\nu_{tt}(x_{i},t_{n})\\approx \\frac{u_{i}^{n+1}-2u_{i}^{n}+u_{i}^{n-1}}{\\Delta t^{2}},\n\\qquad\nu_{xx}(x_{i},t_{n+1})\\approx \\frac{u_{i+1}^{n+1}-2u_{i}^{n+1}+u_{i-1}^{n+1}}{\\Delta x^{2}}.\n$$\nThe fully implicit scheme specified is\n$$\n\\frac{u_{i}^{n+1}-2u_{i}^{n}+u_{i}^{n-1}}{\\Delta t^{2}}=c^{2}\\frac{u_{i+1}^{n+1}-2u_{i}^{n+1}+u_{i-1}^{n+1}}{\\Delta x^{2}}.\n$$\nRewriting by collecting the unknowns at time level $n+1$ on the left-hand side yields\n$$\n\\left(\\frac{1}{\\Delta t^{2}}+\\frac{2c^{2}}{\\Delta x^{2}}\\right)u_{i}^{n+1}\n-\\frac{c^{2}}{\\Delta x^{2}}u_{i-1}^{n+1}\n-\\frac{c^{2}}{\\Delta x^{2}}u_{i+1}^{n+1}\n=\\frac{2}{\\Delta t^{2}}u_{i}^{n}-\\frac{1}{\\Delta t^{2}}u_{i}^{n-1}.\n$$\nIntroducing the dimensionless parameter $\\lambda=\\frac{c\\Delta t}{\\Delta x}$ and multiplying both sides by $\\Delta t^{2}$, we obtain\n$$\n(1+2\\lambda^{2})u_{i}^{n+1}-\\lambda^{2}u_{i-1}^{n+1}-\\lambda^{2}u_{i+1}^{n+1}\n=2u_{i}^{n}-u_{i}^{n-1}.\n$$\nThus, the tridiagonal matrix $A$ in $A\\mathbf{u}^{n+1}=\\mathbf{b}$ has constant entries:\n- sub-diagonal entry $a=-\\lambda^{2}$,\n- main diagonal entry $d=1+2\\lambda^{2}$,\n- super-diagonal entry $c=-\\lambda^{2}$.\nBecause the boundary conditions are homogeneous Dirichlet, no additional boundary-dependent contributions appear in these coefficients.", "answer": "$$\\boxed{\\begin{pmatrix}-\\lambda^{2} & 1+2\\lambda^{2} & -\\lambda^{2}\\end{pmatrix}}$$", "id": "2114199"}, {"introduction": "Real-world models often involve complexities beyond standard local PDEs. This problem [@problem_id:2114206] presents a non-local reaction-diffusion equation, where the evolution at a point depends on an integral of the solution over the entire domain. Your task is to adapt an implicit finite difference method to this challenge and analyze the structure of the resulting matrix equation. This exercise illuminates how the underlying physics—the interplay between local diffusion and global interaction—directly shapes the computational structure of the numerical problem, revealing that the system matrix is a rank-one modification of a tridiagonal matrix, an insight crucial for developing efficient solvers.", "problem": "Consider a one-dimensional system whose state $u(x,t)$ evolves according to the non-local diffusion equation:\n$$\n\\frac{\\partial u}{\\partial t} = D \\frac{\\partial^2 u}{\\partial x^2} + \\alpha \\int_0^L u(x,t) \\,dx\n$$\nThe system is defined on the spatial domain $x \\in [0, L]$ for time $t > 0$. The physical parameters $D$, $\\alpha$, and $L$ are positive real constants. The system is subject to homogeneous Dirichlet boundary conditions, $u(0, t) = 0$ and $u(L, t) = 0$ for all $t > 0$, and starts from a given initial state $u(x, 0) = f(x)$.\n\nTo solve this problem numerically, we discretize the domain. We use a uniform spatial grid $x_j = j \\Delta x$ for $j = 0, 1, \\dots, N$, where $N \\Delta x = L$. Time is discretized as $t^n = n \\Delta t$. The numerical approximation of $u(x_j, t^n)$ is denoted by $u_j^n$.\n\nWe employ an implicit finite difference scheme known as the Backward-Time, Centered-Space (BTCS) method. Specifically:\n- The time derivative $\\frac{\\partial u}{\\partial t}$ is approximated at $(x_j, t^{n+1})$ by a first-order backward difference.\n- The spatial derivative $\\frac{\\partial^2 u}{\\partial x^2}$ is approximated at $(x_j, t^{n+1})$ by a second-order centered difference.\n- The integral term $\\int_0^L u(x,t) \\,dx$ is approximated at time $t^{n+1}$ using the trapezoidal rule over all spatial grid points $x_0, x_1, \\dots, x_N$.\n\nThis scheme results in a system of linear equations that must be solved at each time step to find the unknown values at the interior points, represented by the vector $\\mathbf{u}^{n+1} = (u_1^{n+1}, u_2^{n+1}, \\dots, u_{N-1}^{n+1})^T$. This system can be written in the matrix form $A \\mathbf{u}^{n+1} = \\mathbf{b}^n$, where the matrix $A$ is an $(N-1) \\times (N-1)$ matrix and the vector $\\mathbf{b}^n$ depends on the known values from the previous time step, $\\mathbf{u}^n$.\n\nAssuming $\\alpha \\neq 0$, which of the following options best describes the structure of the matrix $A$?\n\nA. A strictly tridiagonal matrix.\n\nB. A dense, non-symmetric matrix.\n\nC. A dense, symmetric matrix that cannot be expressed as a low-rank update to a sparse matrix.\n\nD. A rank-one modification of a tridiagonal matrix.\n\nE. A diagonal matrix.", "solution": "The problem asks for the structure of the matrix $A$ in the linear system $A \\mathbf{u}^{n+1} = \\mathbf{b}^n$ that arises from an implicit finite difference discretization of the given non-local PDE.\n\nThe PDE is:\n$$\n\\frac{\\partial u}{\\partial t} = D \\frac{\\partial^2 u}{\\partial x^2} + \\alpha \\int_0^L u(x,t) \\,dx\n$$\n\nWe apply the specified numerical approximations at a generic interior grid point $(x_j, t^{n+1})$ for $j = 1, 2, \\dots, N-1$.\n\n1.  **Time derivative approximation (Backward Difference):**\n    $$\n    \\frac{\\partial u}{\\partial t} \\bigg|_{(x_j, t^{n+1})} \\approx \\frac{u_j^{n+1} - u_j^n}{\\Delta t}\n    $$\n\n2.  **Spatial derivative approximation (Centered Difference):** Since the scheme is implicit, we evaluate this term at time level $n+1$.\n    $$\n    \\frac{\\partial^2 u}{\\partial x^2} \\bigg|_{(x_j, t^{n+1})} \\approx \\frac{u_{j+1}^{n+1} - 2u_j^{n+1} + u_{j-1}^{n+1}}{(\\Delta x)^2}\n    $$\n\n3.  **Integral term approximation (Trapezoidal Rule):** The integral at time $t^{n+1}$ is approximated as:\n    $$\n    \\int_0^L u(x, t^{n+1}) \\,dx \\approx \\Delta x \\left( \\frac{1}{2}u_0^{n+1} + \\sum_{k=1}^{N-1} u_k^{n+1} + \\frac{1}{2}u_N^{n+1} \\right)\n    $$\n    The problem states homogeneous Dirichlet boundary conditions, $u(0,t)=0$ and $u(L,t)=0$. In our discrete notation, this means $u_0^n = 0$ and $u_N^n = 0$ for all $n$. Therefore, the integral approximation simplifies to:\n    $$\n    \\int_0^L u(x, t^{n+1}) \\,dx \\approx \\Delta x \\sum_{k=1}^{N-1} u_k^{n+1}\n    $$\n\nNow, we substitute these approximations into the original PDE:\n$$\n\\frac{u_j^{n+1} - u_j^n}{\\Delta t} = D \\left( \\frac{u_{j+1}^{n+1} - 2u_j^{n+1} + u_{j-1}^{n+1}}{(\\Delta x)^2} \\right) + \\alpha \\left( \\Delta x \\sum_{k=1}^{N-1} u_k^{n+1} \\right)\n$$\nOur goal is to arrange this into the form $A \\mathbf{u}^{n+1} = \\mathbf{b}^n$. This means we must move all terms involving $u^{n+1}$ to the left-hand side (LHS) and all terms involving $u^n$ to the right-hand side (RHS).\n\nMultiplying the entire equation by $\\Delta t$:\n$$\nu_j^{n+1} - u_j^n = \\frac{D \\Delta t}{(\\Delta x)^2} (u_{j+1}^{n+1} - 2u_j^{n+1} + u_{j-1}^{n+1}) + \\alpha \\Delta t \\Delta x \\sum_{k=1}^{N-1} u_k^{n+1}\n$$\nLet's define the diffusion number $r = \\frac{D \\Delta t}{(\\Delta x)^2}$ and a constant for the integral part $C = \\alpha \\Delta t \\Delta x$. The equation becomes:\n$$\nu_j^{n+1} - u_j^n = r (u_{j+1}^{n+1} - 2u_j^{n+1} + u_{j-1}^{n+1}) + C \\sum_{k=1}^{N-1} u_k^{n+1}\n$$\nRearranging to group the $u^{n+1}$ terms on the LHS:\n$$\n-r u_{j-1}^{n+1} + (1+2r) u_j^{n+1} - r u_{j+1}^{n+1} - C \\sum_{k=1}^{N-1} u_k^{n+1} = u_j^n\n$$\nThis equation holds for each $j = 1, 2, \\dots, N-1$. This is the $j$-th row of our linear system $A \\mathbf{u}^{n+1} = \\mathbf{b}^n$. The vector $\\mathbf{b}^n$ is simply $\\mathbf{u}^n$. We need to determine the elements $A_{jk}$ of the matrix $A$. The element $A_{jk}$ is the coefficient of $u_k^{n+1}$ in the $j$-th equation.\n\nLet's analyze the coefficients:\nThe first three terms, $-r u_{j-1}^{n+1} + (1+2r) u_j^{n+1} - r u_{j+1}^{n+1}$, form a standard tridiagonal structure. Let's call the matrix from this part $T$. Its elements are:\n$T_{j,j-1} = -r$\n$T_{j,j} = 1+2r$\n$T_{j,j+1} = -r$\n$T_{jk} = 0$ for $|j-k|>1$.\n\nThe integral term, $- C \\sum_{k=1}^{N-1} u_k^{n+1}$, contributes to every element in the $j$-th row of the matrix $A$. For the $j$-th equation, the coefficient of any $u_k^{n+1}$ (for $k=1, \\dots, N-1$) is decreased by $C$.\nThis contribution can be represented by a matrix $M$ where every element $M_{jk} = C$.\n\nSo, the total matrix $A$ is the sum of these two parts: $A = T - M$.\nThe elements of $A$ are:\n$A_{jk} = T_{jk} - M_{jk} = T_{jk} - C$.\nExplicitly:\n-   If $k = j-1$: $A_{j, j-1} = -r - C$\n-   If $k = j$: $A_{j,j} = 1+2r - C$\n-   If $k = j+1$: $A_{j, j+1} = -r - C$\n-   If $|j-k| > 1$: $A_{jk} = 0 - C = -C$\n\nSince $\\alpha \\neq 0$ and other constants are positive, $C \\neq 0$. Therefore, the matrix $A$ has non-zero entries everywhere (in general). This means the matrix $A$ is **dense**. This eliminates option A (Tridiagonal) and E (Diagonal).\n\nNow let's examine the structure more closely. The matrix $M$ where all entries are $C$ can be written as an outer product: $M = C (\\mathbf{1} \\cdot \\mathbf{1}^T)$, where $\\mathbf{1}$ is the $(N-1) \\times 1$ column vector of all ones. A matrix that can be expressed as an outer product of two vectors is a rank-one matrix.\nThus, the matrix $A = T - C(\\mathbf{1} \\cdot \\mathbf{1}^T)$ is a **rank-one modification of a tridiagonal matrix** ($T$). This matches option D.\n\nLet's check the other options to confirm D is the best description.\n-   **Symmetry (Option B):** The tridiagonal matrix $T$ is symmetric. The rank-one matrix $M = C(\\mathbf{1} \\cdot \\mathbf{1}^T)$ is also symmetric. The difference of two symmetric matrices is symmetric. Thus, $A$ is a symmetric matrix. This eliminates option B (non-symmetric).\n-   **Rank-one update (Option C):** We have just shown that $A$ *can* be expressed as a rank-one update to a sparse (tridiagonal) matrix. Therefore, option C is incorrect.\n\nComparing the remaining correct statement \"A is a dense, symmetric matrix\" with option D, we see that option D is more specific and structurally informative. It explains *why* the matrix is dense and symmetric. The fact that it is a rank-one update of a well-known sparse matrix is a much more powerful description, as it allows for specialized, efficient linear solvers (like the Sherman-Morrison formula) instead of general dense solvers. Therefore, option D is the best and most precise description of the matrix's structure.", "answer": "$$\\boxed{D}$$", "id": "2114206"}]}