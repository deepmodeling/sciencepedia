{"hands_on_practices": [{"introduction": "The Courant-Friedrichs-Lewy (CFL) condition is a fundamental principle in numerical simulations, linking the physical speed of wave propagation to the grid parameters of the simulation. This first practice provides a direct application of this concept for the linear advection equation, a cornerstone model for transport phenomena. By working through this scenario, you will develop the essential skill of calculating the appropriate time step $\\Delta t$ required to ensure numerical stability, a critical first step in setting up a valid simulation [@problem_id:2139558].", "problem": "A team of computational scientists is simulating the propagation of a signal along a one-dimensional transmission line. The behavior of the signal's voltage, $u(x, t)$, is modeled by the linear advection equation:\n$$ \\frac{\\partial u}{\\partial t} + v \\frac{\\partial u}{\\partial x} = 0 $$\nwhere $v$ is the constant propagation speed of the signal.\n\nThe simulation uses a finite difference scheme on a grid with a uniform spatial step size of $\\Delta x$. The chosen numerical method is known to be stable only if the Courant-Friedrichs-Lewy (CFL) condition is satisfied. The Courant number, $C$, is defined as $C = |v| \\frac{\\Delta t}{\\Delta x}$, where $\\Delta t$ is the time step.\n\nFor this specific simulation, the propagation speed is $v = 2.5 \\times 10^8$ m/s, and the spatial step is $\\Delta x = 1.25$ cm. To ensure high accuracy and avoid numerical oscillations, the team decides to operate at a Courant number of exactly $C = 0.75$.\n\nWhat is the required time step, $\\Delta t$, for this simulation? Express your answer in nanoseconds (ns), rounded to two significant figures.", "solution": "We use the Courant number definition for the linear advection equation discretization:\n$$\nC = \\frac{|v|\\,\\Delta t}{\\Delta x}.\n$$\nSolving for the time step gives\n$$\n\\Delta t = \\frac{C\\,\\Delta x}{|v|}.\n$$\nSubstitute the given values, converting the spatial step to meters: $\\Delta x = 1.25 \\times 10^{-2}\\ \\text{m}$, $|v| = 2.5 \\times 10^{8}\\ \\text{m/s}$, and $C = 0.75$:\n$$\n\\Delta t = \\frac{0.75\\,(1.25 \\times 10^{-2})}{2.5 \\times 10^{8}}\\ \\text{s}.\n$$\nCompute the numerical factor:\n$$\n\\Delta t = \\frac{0.9375 \\times 10^{-2}}{2.5 \\times 10^{8}}\\ \\text{s}\n= \\left(\\frac{0.9375}{2.5}\\right) \\times 10^{-10}\\ \\text{s}\n= 0.375 \\times 10^{-10}\\ \\text{s}\n= 3.75 \\times 10^{-11}\\ \\text{s}.\n$$\nConvert to nanoseconds using $1\\ \\text{ns} = 10^{-9}\\ \\text{s}$:\n$$\n\\Delta t = 3.75 \\times 10^{-11}\\ \\text{s} = 3.75 \\times 10^{-2}\\ \\text{ns} = 0.0375\\ \\text{ns}.\n$$\nRounding to two significant figures yields $0.038\\ \\text{ns}$.", "answer": "$$\\boxed{0.038}$$", "id": "2139558"}, {"introduction": "While the advection equation provides a simple starting point, many physical systems, from vibrating strings to electromagnetic pulses, are governed by the second-order wave equation. This exercise expands our application of the CFL condition to this new context, demonstrating that the stability criterion changes with the underlying partial differential equation. You will determine the maximum stable time step for a standard explicit scheme, reinforcing the idea that the CFL condition is not a single formula but a principle that must be adapted to each specific problem [@problem_id:2139541].", "problem": "An engineer is developing a numerical simulation for voltage pulse propagation along a specialized coaxial cable. In a simplified one-dimensional model, the voltage $u(x, t)$ at position $x$ and time $t$ is governed by the wave equation:\n$$ \\frac{\\partial^2 u}{\\partial t^2} = 16 \\frac{\\partial^2 u}{\\partial x^2} $$\nwhere $x$ is in meters and $t$ is in seconds.\n\nThe engineer decides to use a standard explicit finite difference scheme to solve this equation numerically. The spatial grid for the simulation is set up with a uniform spacing of $\\Delta x = 0.05$ meters. To ensure the stability of the numerical solution, the time step $\\Delta t$ must be chosen carefully.\n\nWhat is the maximum possible time step $\\Delta t$ that can be used while satisfying the Courant-Friedrichs-Lewy (CFL) stability condition for this scheme? Express your answer in seconds, rounded to three significant figures.", "solution": "We start from the one-dimensional wave equation written in the standard form\n$$\n\\frac{\\partial^{2} u}{\\partial t^{2}} = c^{2}\\frac{\\partial^{2} u}{\\partial x^{2}},\n$$\nwhere, by comparison with the given equation $\\frac{\\partial^{2} u}{\\partial t^{2}} = 16\\,\\frac{\\partial^{2} u}{\\partial x^{2}}$, the wave speed is $c = 4$.\n\nA standard explicit second-order finite difference discretization (centered in time and space) on a uniform grid with spacing $\\Delta x$ and time step $\\Delta t$ is\n$$\n\\frac{u_{j}^{n+1}-2u_{j}^{n}+u_{j}^{n-1}}{(\\Delta t)^{2}} = c^{2}\\frac{u_{j+1}^{n}-2u_{j}^{n}+u_{j-1}^{n}}{(\\Delta x)^{2}}.\n$$\nRearranging gives the update formula\n$$\nu_{j}^{n+1} = 2u_{j}^{n}-u_{j}^{n-1}+r^{2}\\left(u_{j+1}^{n}-2u_{j}^{n}+u_{j-1}^{n}\\right),\n$$\nwhere the Courant number is defined by\n$$\nr = \\frac{c\\,\\Delta t}{\\Delta x}.\n$$\n\nTo determine the stability constraint, perform a von Neumann analysis by seeking Fourier mode solutions of the form $u_{j}^{n} = G^{n}\\exp(\\mathrm{i}\\kappa j\\Delta x)$, where $G$ is the amplification factor and $\\kappa$ is the wavenumber. Substituting into the update yields\n$$\nG-2+G^{-1} = r^{2}\\left(e^{\\mathrm{i}\\kappa\\Delta x}-2+e^{-\\mathrm{i}\\kappa\\Delta x}\\right) = -4r^{2}\\sin^{2}\\left(\\frac{\\kappa\\Delta x}{2}\\right).\n$$\nEquivalently,\n$$\nG+G^{-1} = 2\\left[1-2r^{2}\\sin^{2}\\left(\\frac{\\kappa\\Delta x}{2}\\right)\\right].\n$$\nThis implies the dispersion relation\n$$\n\\cos(\\omega\\Delta t) = 1-2r^{2}\\sin^{2}\\left(\\frac{\\kappa\\Delta x}{2}\\right),\n$$\nso that stability, which requires $|G|=1$ for all modes, holds provided the right-hand side lies in the interval $[-1,1]$ for all $\\kappa$. Since $\\sin^{2}(\\cdot) \\in [0,1]$, the minimum of the right-hand side over all $\\kappa$ is $1-2r^{2}$. Requiring $1-2r^{2} \\geq -1$ gives\n$$\nr^{2} \\leq 1 \\quad\\Longleftrightarrow\\quad r \\leq 1.\n$$\nTherefore, the Courant-Friedrichs-Lewy stability condition for this explicit scheme is\n$$\n\\frac{c\\,\\Delta t}{\\Delta x} \\leq 1 \\quad\\Longrightarrow\\quad \\Delta t \\leq \\frac{\\Delta x}{c}.\n$$\n\nFor the given data, $\\Delta x = 0.05$ and $c = 4$, hence the maximum stable time step is\n$$\n\\Delta t_{\\max} = \\frac{0.05}{4} = 0.0125.\n$$\nRounded to three significant figures, this value is $0.0125$ seconds.", "answer": "$$\\boxed{0.0125}$$", "id": "2139541"}, {"introduction": "Numerical stability is not just about choosing small enough step sizes; it is fundamentally about ensuring the numerical scheme respects the physics of the problem. This practice moves beyond calculation to the core concept of 'upwinding', which dictates that the numerical method must draw information from the direction the physical wave is coming from. By analyzing different schemes for a wave moving in the negative direction, you will gain a deeper intuition for how the structure of a finite difference approximation ensures a stable and physically meaningful simulation [@problem_id:2139542].", "problem": "Consider the one-dimensional linear advection equation, $u_t + c u_x = 0$, which describes a wave propagating with constant speed $c$. We wish to solve this equation numerically on a grid with uniform spatial step $\\Delta x$ and time step $\\Delta t$. Let $u_j^n$ denote the numerical approximation of the solution $u(x, t)$ at the grid point $x_j = j \\Delta x$ and time $t_n = n \\Delta t$.\n\nFor a positive wave speed, $c > 0$, a common and stable numerical method is the first-order upwind scheme, which uses a forward difference for the time derivative and a backward difference for the spatial derivative. This scheme is given by:\n$$\n\\frac{u_j^{n+1} - u_j^n}{\\Delta t} + c \\frac{u_j^n - u_{j-1}^n}{\\Delta x} = 0\n$$\nThis scheme is stable provided the Courant-Friedrichs-Lewy (CFL) condition, $0 \\le \\frac{c \\Delta t}{\\Delta x} \\le 1$, is satisfied.\n\nNow, consider the case where the wave speed is a negative constant, $c  0$. The physical wave now propagates from right to left (in the direction of decreasing $x$). To maintain stability, the finite difference scheme must be modified to respect this change in the direction of information flow.\n\nWhich of the following discrete schemes provides a stable approximation for the advection equation with $c  0$, subject to an appropriate CFL condition?\n\nA. $\\frac{u_j^{n+1} - u_j^n}{\\Delta t} + c \\frac{u_j^n - u_{j-1}^n}{\\Delta x} = 0$\n\nB. $\\frac{u_j^{n+1} - u_j^n}{\\Delta t} + c \\frac{u_{j+1}^n - u_j^n}{\\Delta x} = 0$\n\nC. $\\frac{u_j^{n+1} - u_j^n}{\\Delta t} + c \\frac{u_{j+1}^n - u_{j-1}^n}{2\\Delta x} = 0$\n\nD. $\\frac{u_j^{n+1} - u_j^n}{\\Delta t} + c \\frac{u_{j+1}^{n+1} - u_j^{n+1}}{\\Delta x} = 0$\n\nE. $\\frac{u_j^{n+1} - u_j^{n-1}}{2\\Delta t} + c \\frac{u_j^n - u_{j-1}^n}{\\Delta x} = 0$", "solution": "We consider the linear advection equation $u_{t} + c u_{x} = 0$ with constant speed $c$. For $c  0$, characteristics propagate from right to left, so the numerical scheme must use information from the upwind (right) side to remain stable. This leads to choosing a forward spatial difference (increasing $x$) at the current time level $n$.\n\nIntroduce the Courant number $\\nu = \\frac{c \\Delta t}{\\Delta x}$. For a candidate scheme\n$$\n\\frac{u_{j}^{n+1} - u_{j}^{n}}{\\Delta t} + c \\frac{u_{j+1}^{n} - u_{j}^{n}}{\\Delta x} = 0,\n$$\nwhich is option B, we perform a von Neumann analysis. Assume a Fourier mode $u_{j}^{n} = \\hat{u}^{n} \\exp(i \\theta j)$, where $\\theta \\in \\mathbb{R}$. Substituting into the scheme gives\n$$\n\\hat{u}^{n+1} e^{i \\theta j} = \\hat{u}^{n} e^{i \\theta j} - \\nu \\left(\\hat{u}^{n} e^{i \\theta (j+1)} - \\hat{u}^{n} e^{i \\theta j}\\right),\n$$\nso the amplification factor $G$ defined by $\\hat{u}^{n+1} = G \\hat{u}^{n}$ is\n$$\nG = 1 - \\nu \\left(e^{i \\theta} - 1\\right) = (1 + \\nu) - \\nu e^{i \\theta}.\n$$\nThen\n$$\n|G|^{2} = \\left((1+\\nu) - \\nu \\cos \\theta\\right)^{2} + \\left(\\nu \\sin \\theta\\right)^{2}\n= (1+\\nu)^{2} - 2 \\nu (1+\\nu) \\cos \\theta + \\nu^{2}.\n$$\nFor $c  0$ we have $\\nu \\leq 0$. If $-1 \\leq \\nu \\leq 0$, the coefficient $-2 \\nu (1+\\nu) \\geq 0$, hence the maximum of $|G|^{2}$ over $\\theta$ occurs at $\\cos \\theta = -1$, giving\n$$\n\\max_{\\theta} |G|^{2} = (1+\\nu)^{2} + 2 \\nu (1+\\nu) + \\nu^{2} = (1 + 2 \\nu)^{2} \\leq 1,\n$$\nwhich holds precisely for $-1 \\leq \\nu \\leq 0$. Therefore option B is stable under the CFL condition $-1 \\leq \\frac{c \\Delta t}{\\Delta x} \\leq 0$.\n\nTo exclude the other options:\n\n- Option A (backward difference in space): the scheme is\n$$\n\\frac{u_{j}^{n+1} - u_{j}^{n}}{\\Delta t} + c \\frac{u_{j}^{n} - u_{j-1}^{n}}{\\Delta x} = 0.\n$$\nFourier analysis yields $G = (1 - \\nu) + \\nu e^{-i \\theta}$ and\n$$\n|G|^{2} = (1 - \\nu)^{2} - 2 \\nu (1 - \\nu) \\cos \\theta + \\nu^{2}.\n$$\nFor $\\nu  0$, the coefficient $-2 \\nu (1 - \\nu) > 0$, so the maximum is at $\\cos \\theta = -1$, giving\n$$\n\\max_{\\theta} |G|^{2} = (1 - \\nu)^{2} + 2 \\nu (1 - \\nu) + \\nu^{2} = (1 - 2 \\nu)^{2} > 1,\n$$\nhence unstable for $c  0$.\n\n- Option C (FTCS with centered space): the scheme is\n$$\n\\frac{u_{j}^{n+1} - u_{j}^{n}}{\\Delta t} + c \\frac{u_{j+1}^{n} - u_{j-1}^{n}}{2 \\Delta x} = 0,\n$$\ngiving $G = 1 - i \\nu \\sin \\theta$ and\n$$\n|G|^{2} = 1 + \\nu^{2} \\sin^{2} \\theta > 1\n$$\nfor any nonzero $\\nu$ and $\\theta \\notin \\pi \\mathbb{Z}$; thus unconditionally unstable.\n\n- Option D (implicit forward difference at time level $n+1$): the scheme is\n$$\n\\frac{u_{j}^{n+1} - u_{j}^{n}}{\\Delta t} + c \\frac{u_{j+1}^{n+1} - u_{j}^{n+1}}{\\Delta x} = 0,\n$$\nwhich leads to\n$$\nG = \\frac{1}{1 + \\nu \\left(e^{i \\theta} - 1\\right)}.\n$$\nFor $\\nu  0$, one finds\n$$\n\\min_{\\theta} \\left|1 + \\nu \\left(e^{i \\theta} - 1\\right)\\right|^{2} = 1,\n$$\nso $|G| \\leq 1$ without a CFL restriction. While this is stable, it is implicit and does not correspond to the standard explicit upwind choice requested when emphasizing a CFL condition.\n\n- Option E (leapfrog in time with one-sided space): the recurrence becomes\n$$\nu_{j}^{n+1} = u_{j}^{n-1} - 2 \\nu \\left(u_{j}^{n} - u_{j-1}^{n}\\right),\n$$\nwhich yields the amplification polynomial\n$$\nG^{2} + 2 \\nu \\left(1 - e^{-i \\theta}\\right) G - 1 = 0.\n$$\nThe product of roots is $-1$, so the two roots cannot both have magnitude at most $1$ unless in degenerate cases; thus this is unstable.\n\nTherefore, the explicit upwind scheme that is stable for $c  0$ under the appropriate CFL condition is option B.", "answer": "$$\\boxed{B}$$", "id": "2139542"}]}