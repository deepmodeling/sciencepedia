{"hands_on_practices": [{"introduction": "The core principle of the Finite Element Method (FEM) is to approximate a complex, continuous function over a large domain with a collection of simple, piecewise functions defined over small subdomains called elements. This first exercise [@problem_id:2115140] focuses on this fundamental building block. You will practice creating a linear \"interpolant\"—a straight line that approximates a more complex curve by matching its value at the two endpoints (nodes) of a single element.", "problem": "In the Finite Element Method (FEM), a complex function is often approximated over a large domain by a set of simpler, piecewise polynomial functions. Each of these simpler functions is defined over a small, non-overlapping subdomain called a finite element.\n\nConsider a single one-dimensional linear finite element that represents the spatial interval $[0, 2]$. A continuous function $f(x)$ is defined over this interval as:\n$$f(x) = (x+1)\\exp(-x)$$\nYour task is to determine the linear finite element interpolant, which we will denote as $u_h(x)$, for the function $f(x)$ over this single element. The interpolant is the linear function that has the same values as $f(x)$ at the element's endpoints (nodes).\n\nExpress your answer as a function of $x$.", "solution": "We seek the linear finite element interpolant $u_{h}(x)$ over the interval $[0,2]$ that matches $f(x)=(x+1)\\exp(-x)$ at the endpoints. For a single linear element with nodes at $x_{1}=0$ and $x_{2}=2$, the Lagrange shape functions are\n$$\nN_{1}(x)=\\frac{x_{2}-x}{x_{2}-x_{1}}, \\qquad N_{2}(x)=\\frac{x-x_{1}}{x_{2}-x_{1}}.\n$$\nThe interpolant is\n$$\nu_{h}(x)=f(x_{1})\\,N_{1}(x)+f(x_{2})\\,N_{2}(x).\n$$\nCompute the nodal values:\n$$\nf(0)=(0+1)\\exp(0)=1, \\qquad f(2)=(2+1)\\exp(-2)=3\\exp(-2).\n$$\nWith $x_{1}=0$ and $x_{2}=2$, the shape functions become\n$$\nN_{1}(x)=\\frac{2-x}{2}, \\qquad N_{2}(x)=\\frac{x}{2}.\n$$\nThus,\n$$\nu_{h}(x)=1\\cdot\\frac{2-x}{2}+\\left(3\\exp(-2)\\right)\\cdot\\frac{x}{2}\n=\\frac{2-x}{2}+\\frac{3\\exp(-2)\\,x}{2}\n=1+\\frac{x}{2}\\left(3\\exp(-2)-1\\right).\n$$\nThis is the required linear interpolant.", "answer": "$$\\boxed{1+\\frac{x}{2}\\left(3\\exp(-2)-1\\right)}$$", "id": "2115140"}, {"introduction": "After approximating a primary field like temperature, we often need to compute derived physical quantities like heat flux, which involves the field's spatial derivative. This problem [@problem_id:2115129] explores the consequence of our linear approximation: the derivative of the field becomes constant within each element. Mastering this concept is a key step toward understanding how FEM transforms differential equations into algebraic systems that can be solved computationally.", "problem": "In the analysis of steady-state heat conduction in a non-uniform one-dimensional rod using the Finite Element Method (FEM), the rod is partitioned into a mesh of smaller segments called elements. The temperature distribution $T(x)$ is approximated by a function $T_h(x)$ which is piecewise polynomial.\n\nConsider a \"P1\" approximation, where the approximate temperature profile $T_h(x)$ is linear over each element. Let's focus on a single element of the mesh, defined by the spatial interval $[x_j, x_{j+1}]$. The length of this element is denoted by $h_j = x_{j+1} - x_j$. Within this specific element, the thermal conductivity of the material is assumed to be a constant, $k_j$.\n\nA numerical solver has already computed the approximate temperatures at the endpoints of the element, known as nodes. The temperature at the node $x_j$ is $T_j$, and the temperature at the node $x_{j+1}$ is $T_{j+1}$.\n\nThe heat flux, according to Fourier's law of heat conduction, is given by $q(x) = -k(x) \\frac{dT}{dx}$. For our finite element model, the approximate heat flux within the element is calculated as $q_h = -k_j \\frac{dT_h}{dx}$. Since the temperature approximation $T_h(x)$ is linear over the element, its derivative is constant, and therefore the heat flux $q_h$ is also constant within the element.\n\nDetermine the analytical expression for this constant heat flux, $q_h$, within the element $[x_j, x_{j+1}]$. Your expression should be formulated in terms of the parameters $k_j$, $h_j$, $T_j$, and $T_{j+1}$.", "solution": "We use a P1 (linear) finite element approximation on the element $[x_{j},x_{j+1}]$ of length $h_{j}=x_{j+1}-x_{j}$. The linear interpolation of the temperature between nodal values $T_{j}$ and $T_{j+1}$ is\n$$\nT_{h}(x)=T_{j}\\,\\frac{x_{j+1}-x}{h_{j}}+T_{j+1}\\,\\frac{x-x_{j}}{h_{j}}.\n$$\nDifferentiating with respect to $x$ gives a constant gradient within the element:\n$$\n\\frac{dT_{h}}{dx}=-\\frac{T_{j}}{h_{j}}+\\frac{T_{j+1}}{h_{j}}=\\frac{T_{j+1}-T_{j}}{h_{j}}.\n$$\nBy Fourier’s law, the heat flux is $q(x)=-k(x)\\,\\frac{dT}{dx}$. With constant conductivity $k_{j}$ on the element and using the finite element approximation, the elementwise constant flux is\n$$\nq_{h}=-k_{j}\\,\\frac{dT_{h}}{dx}=-k_{j}\\,\\frac{T_{j+1}-T_{j}}{h_{j}}=\\frac{k_{j}}{h_{j}}\\left(T_{j}-T_{j+1}\\right).\n$$\nThus, the analytical expression for the constant heat flux in the element is as stated.", "answer": "$$\\boxed{\\frac{k_{j}}{h_{j}}\\left(T_{j}-T_{j+1}\\right)}$$", "id": "2115129"}, {"introduction": "This practice [@problem_id:2405079] integrates the concepts from the previous exercises into a complete end-to-end analysis of a simple engineering structure. You will walk through the entire FEM procedure for a 1D bar: formulating element stiffness matrices, assembling them into a global system representing the whole structure, applying boundary conditions (loads and supports), and solving for the unknown displacements. This exercise demonstrates the full power and systematic nature of the method in a tangible structural mechanics context.", "problem": "A straight, homogeneous, prismatic bar occupies the interval from $x=0$ to $x=L_1+L_2$ along its axis and undergoes small axial deformations. The bar has constant cross-sectional area $A$ and Young's modulus $E$. The left end at $x=0$ is fixed, and a concentrated axial load $P$ is applied at the right end at $x=L_1+L_2$. The bar is discretized using the Finite Element Method (FEM) into $2$ linear two-node elements of unequal lengths: element $1$ spans $[0,L_1]$ with nodes $1$ and $2$, and element $2$ spans $[L_1,L_1+L_2]$ with nodes $2$ and $3$. No body forces act on the bar.\n\nStarting from first principles of one-dimensional linear elasticity and the variational (weak) form of equilibrium, assemble the global stiffness matrix for this discretization, impose the essential boundary condition at the fixed end, and solve the resulting linear system to determine the axial displacement at node $3$ under the applied load $P$.\n\nProvide your final answer as a single simplified symbolic expression in terms of $P$, $E$, $A$, $L_1$, and $L_2$. Express the displacement in meters. If you perform any intermediate approximations, your final expression must be exact (no rounding).", "solution": "The problem as stated constitutes a valid, well-posed problem in an introduction to the finite element method applied to one-dimensional linear elasticity. All necessary information, including geometry, material properties, boundary conditions, and a specific discretization, is provided. The problem is scientifically grounded and objective. We shall proceed with the solution.\n\nThe governing differential equation for a prismatic bar under axial load with no body forces is the strong form of equilibrium, given by:\n$$\n- \\frac{d}{dx} \\left( EA \\frac{du}{dx} \\right) = 0 \\quad \\text{for } x \\in (0, L_1 + L_2)\n$$\nwhere $u(x)$ is the axial displacement at position $x$, $E$ is Young's modulus, and $A$ is the cross-sectional area. The boundary conditions are an essential (Dirichlet) condition at the fixed end, $u(0) = 0$, and a natural (Neumann) condition at the loaded end, $EA \\frac{du}{dx}|_{x=L_1+L_2} = P$.\n\nTo derive the variational or weak form, we multiply the strong form by a sufficiently smooth test function $v(x)$ that satisfies the homogeneous essential boundary condition, i.e., $v(0) = 0$, and integrate over the domain $\\Omega = [0, L_1+L_2]$:\n$$\n\\int_{0}^{L_1+L_2} v \\left( - \\frac{d}{dx} \\left( EA \\frac{du}{dx} \\right) \\right) dx = 0\n$$\nApplying integration by parts, $\\int w \\, dz = wz - \\int z \\, dw$, with $w=v$ and $dz = - \\frac{d}{dx} (EA \\frac{du}{dx}) dx$, yields:\n$$\n\\int_{0}^{L_1+L_2} EA \\frac{dv}{dx} \\frac{du}{dx} dx - \\left[ v \\left( EA \\frac{du}{dx} \\right) \\right]_{0}^{L_1+L_2} = 0\n$$\nEvaluating the boundary term, we have $v(L_1+L_2) \\left( EA \\frac{du}{dx}|_{x=L_1+L_2} \\right) - v(0) \\left( EA \\frac{du}{dx}|_{x=0} \\right)$. Since $v(0)=0$ and the natural boundary condition is $EA \\frac{du}{dx}|_{x=L_1+L_2} = P$, the weak form becomes: Find $u(x)$ such that $u(0)=0$ and for all admissible test functions $v(x)$:\n$$\n\\int_{0}^{L_1+L_2} EA \\frac{dv}{dx} \\frac{du}{dx} dx = v(L_1+L_2) P\n$$\nIn the finite element method, the domain is discretized into elements. For a generic linear two-node bar element of length $L_e$ connecting nodes $i$ and $j$, the displacement field $u^{(e)}(x)$ is interpolated from the nodal displacements $d_i$ and $d_j$ using linear shape functions $N_i(x)$ and $N_j(x)$: $u^{(e)}(x) = N_i(x) d_i + N_j(x) d_j$. The strain-displacement matrix $\\mathbf{B}^{(e)}$ relates the strain $\\epsilon_x = \\frac{du}{dx}$ to the nodal displacement vector $\\mathbf{d}^{(e)} = \\begin{pmatrix} d_i & d_j \\end{pmatrix}^T$. For a linear element, $\\mathbf{B}^{(e)} = \\begin{pmatrix} \\frac{dN_i}{dx} & \\frac{dN_j}{dx} \\end{pmatrix} = \\frac{1}{L_e} \\begin{pmatrix} -1 & 1 \\end{pmatrix}$.\nThe element stiffness matrix $\\mathbf{k}^{(e)}$ is derived from the left-hand side of the weak form, integrated over the element domain $\\Omega_e$:\n$$\n\\mathbf{k}^{(e)} = \\int_{\\Omega_e} (\\mathbf{B}^{(e)})^T (EA) \\mathbf{B}^{(e)} dx = \\int_{0}^{L_e} \\frac{1}{L_e} \\begin{pmatrix} -1 \\\\ 1 \\end{pmatrix} (EA) \\frac{1}{L_e} \\begin{pmatrix} -1 & 1 \\end{pmatrix} dx\n$$\nSince $E$, $A$, and $L_e$ are constant over the element, this simplifies to:\n$$\n\\mathbf{k}^{(e)} = \\frac{EA}{L_e^2} \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix} \\int_{0}^{L_e} dx = \\frac{EA}{L_e} \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix}\n$$\nFor our specific problem with $2$ elements:\nElement $1$ spans $[0, L_1]$ with nodes $1$ and $2$. Its length is $L_e = L_1$. The stiffness matrix is:\n$$\n\\mathbf{k}^{(1)} = \\frac{EA}{L_1} \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix} \\quad \\text{corresponding to degrees of freedom } d_1, d_2\n$$\nElement $2$ spans $[L_1, L_1+L_2]$ with nodes $2$ and $3$. Its length is $L_e = L_2$. The stiffness matrix is:\n$$\n\\mathbf{k}^{(2)} = \\frac{EA}{L_2} \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix} \\quad \\text{corresponding to degrees of freedom } d_2, d_3\n$$\nThe global stiffness matrix $\\mathbf{K}$ for the $3$-node system is assembled by summing the contributions from each element:\n$$\n\\mathbf{K} = \\begin{pmatrix}\n\\frac{EA}{L_1} & -\\frac{EA}{L_1} & 0 \\\\\n-\\frac{EA}{L_1} & \\frac{EA}{L_1} + \\frac{EA}{L_2} & -\\frac{EA}{L_2} \\\\\n0 & -\\frac{EA}{L_2} & \\frac{EA}{L_2}\n\\end{pmatrix} = EA \\begin{pmatrix}\n\\frac{1}{L_1} & -\\frac{1}{L_1} & 0 \\\\\n-\\frac{1}{L_1} & \\frac{1}{L_1} + \\frac{1}{L_2} & -\\frac{1}{L_2} \\\\\n0 & -\\frac{1}{L_2} & \\frac{1}{L_2}\n\\end{pmatrix}\n$$\nThe global system of linear equations is $\\mathbf{K}\\mathbf{d} = \\mathbf{F}$, where $\\mathbf{d} = \\begin{pmatrix} d_1 & d_2 & d_3 \\end{pmatrix}^T$ is the global displacement vector and $\\mathbf{F} = \\begin{pmatrix} F_1 & F_2 & F_3 \\end{pmatrix}^T$ is the global force vector. Here, $F_1$ is the unknown reaction force at node $1$, $F_2 = 0$ as there is no applied load at node $2$, and $F_3 = P$ is the applied load at node $3$. The system is:\n$$\nEA \\begin{pmatrix}\n\\frac{1}{L_1} & -\\frac{1}{L_1} & 0 \\\\\n-\\frac{1}{L_1} & \\frac{1}{L_1} + \\frac{1}{L_2} & -\\frac{1}{L_2} \\\\\n0 & -\\frac{1}{L_2} & \\frac{1}{L_2}\n\\end{pmatrix}\n\\begin{pmatrix} d_1 \\\\ d_2 \\\\ d_3 \\end{pmatrix} =\n\\begin{pmatrix} F_1 \\\\ 0 \\\\ P \\end{pmatrix}\n$$\nWe impose the essential boundary condition $d_1 = 0$. This allows us to solve for the unknown displacements $d_2$ and $d_3$ using a reduced system. By eliminating the first row and column (as they are associated with the known displacement $d_1$), and setting $d_1=0$ in the remaining equations, we get:\n$$\nEA \\begin{pmatrix}\n\\frac{1}{L_1} + \\frac{1}{L_2} & -\\frac{1}{L_2} \\\\\n-\\frac{1}{L_2} & \\frac{1}{L_2}\n\\end{pmatrix}\n\\begin{pmatrix} d_2 \\\\ d_3 \\end{pmatrix} =\n\\begin{pmatrix} 0 \\\\ P \\end{pmatrix}\n$$\nThis gives two algebraic equations:\n$$\n(1) \\quad EA \\left( \\left(\\frac{1}{L_1} + \\frac{1}{L_2}\\right) d_2 - \\frac{1}{L_2} d_3 \\right) = 0\n$$\n$$\n(2) \\quad EA \\left( -\\frac{1}{L_2} d_2 + \\frac{1}{L_2} d_3 \\right) = P\n$$\nFrom equation $(2)$, we can write:\n$$\n\\frac{EA}{L_2} (d_3 - d_2) = P \\implies d_3 - d_2 = \\frac{PL_2}{EA}\n$$\nThis is physically correct: the elongation of element $2$ is $d_3-d_2$, and it is equal to $\\frac{F_{int} L_2}{EA}$, where the internal force in element $2$ is $P$.\nFrom equation $(1)$, we have:\n$$\n\\left(\\frac{L_1 + L_2}{L_1 L_2}\\right) d_2 = \\frac{1}{L_2} d_3 \\implies d_2 = \\frac{L_1}{L_1+L_2} d_3\n$$\nNow we substitute this expression for $d_2$ into the rearranged equation $(2)$:\n$$\nd_3 - \\left(\\frac{L_1}{L_1+L_2}\\right) d_3 = \\frac{PL_2}{EA}\n$$\n$$\nd_3 \\left( 1 - \\frac{L_1}{L_1+L_2} \\right) = \\frac{PL_2}{EA}\n$$\n$$\nd_3 \\left( \\frac{L_1+L_2-L_1}{L_1+L_2} \\right) = \\frac{PL_2}{EA}\n$$\n$$\nd_3 \\left( \\frac{L_2}{L_1+L_2} \\right) = \\frac{PL_2}{EA}\n$$\nSolving for $d_3$, the displacement at node $3$, we find:\n$$\nd_3 = \\frac{PL_2}{EA} \\left( \\frac{L_1+L_2}{L_2} \\right) = \\frac{P(L_1+L_2)}{EA}\n$$\nThe result is identical to the exact analytical solution for the total elongation of a bar of length $L_1+L_2$, which is expected for this problem since the finite element solution with linear elements is exact for the nodal displacements of a 1D bar under point loads. The units are $\\frac{[N][m]}{[N/m^2][m^2]} = [m]$, which is correct for displacement.", "answer": "$$\n\\boxed{\\frac{P(L_1+L_2)}{EA}}\n$$", "id": "2405079"}]}