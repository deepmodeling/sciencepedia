{"hands_on_practices": [{"introduction": "Applying a numerical method begins with translating the continuous partial differential equation into a discrete algebraic system. This exercise guides you through the fundamental process of setting up the Crank-Nicolson scheme for the 1D heat equation. By constructing the system matrices for a small grid, you will develop a concrete understanding of how the implicit formulation connects the solution from one time step to the next [@problem_id:2139888].", "problem": "Consider the one-dimensional heat equation, $u_t = \\alpha u_{xx}$, for a function $u(x, t)$ defined on the spatial domain $x \\in [0, L]$ and for time $t \\geq 0$. The equation is subject to homogeneous Dirichlet boundary conditions, $u(0, t) = u(L, t) = 0$.\n\nWe wish to solve this equation numerically using the Crank-Nicolson method. The spatial domain is discretized into a uniform grid with spacing $\\Delta x$, such that there are exactly three interior grid points. Let $\\Delta t$ be the time step. The method results in a matrix system of the form $A\\mathbf{u}^{n+1} = B\\mathbf{u}^{n}$, where $\\mathbf{u}^{k}$ is the column vector of the numerical solution at the three interior grid points at time step $k$.\n\nLet the parameter $\\lambda$ be defined as $\\lambda = \\frac{\\alpha \\Delta t}{(\\Delta x)^2}$.\n\nWhich of the following options correctly identifies the $3 \\times 3$ matrices $A$ and $B$?\n\nA. $A = \\begin{pmatrix} 1+\\lambda  -\\frac{\\lambda}{2}  0 \\\\ -\\frac{\\lambda}{2}  1+\\lambda  -\\frac{\\lambda}{2} \\\\ 0  -\\frac{\\lambda}{2}  1+\\lambda \\end{pmatrix}$, $B = \\begin{pmatrix} 1-\\lambda  \\frac{\\lambda}{2}  0 \\\\ \\frac{\\lambda}{2}  1-\\lambda  \\frac{\\lambda}{2} \\\\ 0  \\frac{\\lambda}{2}  1-\\lambda \\end{pmatrix}$\n\nB. $A = \\begin{pmatrix} 1-\\lambda  \\frac{\\lambda}{2}  0 \\\\ \\frac{\\lambda}{2}  1-\\lambda  \\frac{\\lambda}{2} \\\\ 0  \\frac{\\lambda}{2}  1-\\lambda \\end{pmatrix}$, $B = \\begin{pmatrix} 1+\\lambda  -\\frac{\\lambda}{2}  0 \\\\ -\\frac{\\lambda}{2}  1+\\lambda  -\\frac{\\lambda}{2} \\\\ 0  -\\frac{\\lambda}{2}  1+\\lambda \\end{pmatrix}$\n\nC. $A = \\begin{pmatrix} 1  0  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{pmatrix}$, $B = \\begin{pmatrix} 1-2\\lambda  \\lambda  0 \\\\ \\lambda  1-2\\lambda  \\lambda \\\\ 0  \\lambda  1-2\\lambda \\end{pmatrix}$\n\nD. $A = \\begin{pmatrix} 1+2\\lambda  -\\lambda  0 \\\\ -\\lambda  1+2\\lambda  -\\lambda \\\\ 0  -\\lambda  1+2\\lambda \\end{pmatrix}$, $B = \\begin{pmatrix} 1  0  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{pmatrix}$", "solution": "We discretize the spatial interval with uniform spacing $\\Delta x$ and denote interior indices $i=1,2,3$. The homogeneous Dirichlet boundary conditions impose $u_{0}^{n}=0$ and $u_{4}^{n}=0$ for all $n$.\n\nLet $u_{i}^{n}$ approximate $u(x_{i}, t^{n})$. The Crank–Nicolson discretization of $u_{t}=\\alpha u_{xx}$ at interior point $i$ is\n$$\n\\frac{u_{i}^{n+1}-u_{i}^{n}}{\\Delta t}\n=\\frac{\\alpha}{2}\\left(\\frac{u_{i+1}^{n}-2u_{i}^{n}+u_{i-1}^{n}}{(\\Delta x)^{2}}+\\frac{u_{i+1}^{n+1}-2u_{i}^{n+1}+u_{i-1}^{n+1}}{(\\Delta x)^{2}}\\right).\n$$\nWith $\\lambda=\\frac{\\alpha\\Delta t}{(\\Delta x)^{2}}$, multiply both sides by $\\Delta t$ to obtain\n$$\nu_{i}^{n+1}-u_{i}^{n}\n=\\frac{\\lambda}{2}\\left[(u_{i+1}^{n}-2u_{i}^{n}+u_{i-1}^{n})+(u_{i+1}^{n+1}-2u_{i}^{n+1}+u_{i-1}^{n+1})\\right].\n$$\nRearranging to collect the unknown time level $n+1$ on the left and time level $n$ on the right gives\n$$\n\\left(1+\\lambda\\right)u_{i}^{n+1}-\\frac{\\lambda}{2}u_{i+1}^{n+1}-\\frac{\\lambda}{2}u_{i-1}^{n+1}\n=\\left(1-\\lambda\\right)u_{i}^{n}+\\frac{\\lambda}{2}u_{i+1}^{n}+\\frac{\\lambda}{2}u_{i-1}^{n}.\n$$\nBecause the boundary values are zero, no additional boundary terms appear. Writing this system for $i=1,2,3$ in matrix form $A\\mathbf{u}^{n+1}=B\\mathbf{u}^{n}$ with $\\mathbf{u}^{k}=(u_{1}^{k},u_{2}^{k},u_{3}^{k})^{T}$, the matrices are\n$$\nA=\\begin{pmatrix}\n1+\\lambda  -\\frac{\\lambda}{2}  0 \\\\\n-\\frac{\\lambda}{2}  1+\\lambda  -\\frac{\\lambda}{2} \\\\\n0  -\\frac{\\lambda}{2}  1+\\lambda\n\\end{pmatrix},\\quad\nB=\\begin{pmatrix}\n1-\\lambda  \\frac{\\lambda}{2}  0 \\\\\n\\frac{\\lambda}{2}  1-\\lambda  \\frac{\\lambda}{2} \\\\\n0  \\frac{\\lambda}{2}  1-\\lambda\n\\end{pmatrix}.\n$$\nThese match option A.", "answer": "$$\\boxed{A}$$", "id": "2139888"}, {"introduction": "Many physical phenomena involve more than one process occurring simultaneously. This practice extends the basic heat equation to a reaction-diffusion model, which includes a term for heat loss. You will learn how to adapt the Crank-Nicolson method to incorporate this additional physical effect, a crucial skill for modeling more complex real-world systems [@problem_id:2139830]. This exercise demonstrates the flexibility of the finite difference framework.", "problem": "Consider the one-dimensional reaction-diffusion equation given by:\n$$ \\frac{\\partial u}{\\partial t} = D \\frac{\\partial^2 u}{\\partial x^2} - \\beta u $$\nThis equation models a process like heat diffusion in a rod, where $u(x,t)$ is the temperature, $D$ is the thermal diffusivity, and the term $-\\beta u$ (with $\\beta  0$ being a constant) represents heat loss to the surrounding environment, proportional to the local temperature.\n\nWe wish to solve this equation numerically on a spatial domain $x \\in [0, L]$ and for time $t  0$, subject to Dirichlet boundary conditions $u(0, t) = u(L, t) = 0$. The domain is discretized with a uniform spatial step $\\Delta x$, such that there are $M$ interior grid points $x_j = j \\Delta x$ for $j = 1, 2, \\ldots, M$. The time is discretized with a uniform step $\\Delta t$, with $t_n = n \\Delta t$. The numerical approximation of the temperature at grid point $j$ and time step $n$ is denoted by $u_j^n$.\n\nThe Crank-Nicolson method is employed to solve this equation. This implicit time-stepping scheme is formulated by centering the finite difference approximations at the half-time step $t_{n+1/2} = t_n + \\Delta t / 2$. The resulting system of linear equations for the unknown temperatures $\\mathbf{u}^{n+1} = [u_1^{n+1}, u_2^{n+1}, \\ldots, u_M^{n+1}]^T$ at the next time step can be written in the matrix form:\n$$ A \\mathbf{u}^{n+1} = B \\mathbf{u}^{n} $$\nwhere $A$ and $B$ are $M \\times M$ matrices that depend on the discretization parameters.\n\nLet the dimensionless diffusion number be defined as $r = \\frac{D \\Delta t}{(\\Delta x)^2}$. Determine the value of the diagonal element $A_{j,j}$ of the matrix $A$ for an interior grid point $j$ (where $1  j  M$). Express your answer as an analytic expression in terms of $r$ and the product $\\beta \\Delta t$.", "solution": "We start from the reaction-diffusion equation $u_{t} = D u_{xx} - \\beta u$ and apply the Crank-Nicolson method at an interior grid point $j$:\n$$\n\\frac{u_{j}^{n+1} - u_{j}^{n}}{\\Delta t}\n= \\frac{D}{2}\\left(\\frac{u_{j-1}^{n+1} - 2 u_{j}^{n+1} + u_{j+1}^{n+1}}{(\\Delta x)^{2}} + \\frac{u_{j-1}^{n} - 2 u_{j}^{n} + u_{j+1}^{n}}{(\\Delta x)^{2}}\\right) - \\frac{\\beta}{2}\\left(u_{j}^{n+1} + u_{j}^{n}\\right).\n$$\nMultiplying by $\\Delta t$ and introducing $r = \\frac{D \\Delta t}{(\\Delta x)^{2}}$ yields\n$$\nu_{j}^{n+1} - u_{j}^{n}\n= \\frac{r}{2}\\left(u_{j-1}^{n+1} - 2 u_{j}^{n+1} + u_{j+1}^{n+1} + u_{j-1}^{n} - 2 u_{j}^{n} + u_{j+1}^{n}\\right) - \\frac{\\beta \\Delta t}{2}\\left(u_{j}^{n+1} + u_{j}^{n}\\right).\n$$\nCollecting all $n+1$ terms on the left gives\n$$\n\\left[1 + r + \\frac{\\beta \\Delta t}{2}\\right] u_{j}^{n+1} - \\frac{r}{2} u_{j-1}^{n+1} - \\frac{r}{2} u_{j+1}^{n+1}\n= \\frac{r}{2}\\left(u_{j-1}^{n} - 2 u_{j}^{n} + u_{j+1}^{n}\\right) + \\left(1 - \\frac{\\beta \\Delta t}{2}\\right) u_{j}^{n}.\n$$\nIn matrix form $A \\mathbf{u}^{n+1} = B \\mathbf{u}^{n}$, the coefficient $A_{j,j}$ is the coefficient multiplying $u_{j}^{n+1}$ on the left-hand side. Therefore, for an interior point $j$,\n$$\nA_{j,j} = 1 + r + \\frac{\\beta \\Delta t}{2}.\n$$\nThis is expressed solely in terms of $r$ and $\\beta \\Delta t$, as required.", "answer": "$$\\boxed{1 + r + \\frac{\\beta \\Delta t}{2}}$$", "id": "2139830"}, {"introduction": "While the Crank-Nicolson method is prized for its unconditional stability, it can sometimes produce non-physical artifacts. This problem explores one such scenario: the appearance of spurious oscillations when simulating initial conditions with sharp discontinuities. This thought experiment will help you understand the deeper reason for this behavior by examining how the scheme affects different frequency components of the solution, highlighting the critical difference between stability and the qualitative accuracy of a simulation [@problem_id:2211533].", "problem": "An engineering student is simulating one-dimensional heat transfer in a long, insulated bar. The process is governed by the heat equation, $\\frac{\\partial u}{\\partial t} = D \\frac{\\partial^2 u}{\\partial x^2}$, where $u(x,t)$ is the temperature at position $x$ and time $t$, and $D$ is the thermal diffusivity of the material. The bar has a length $L$. The initial temperature distribution is a sharp step function: at $t=0$, the temperature is $u(x,0) = U_0$ for the left half of the bar ($0 \\le x \\le L/2$) and $u(x,0) = 0$ for the right half ($L/2  x \\le L$). The boundaries are held at constant temperatures: $u(0,t) = U_0$ and $u(L,t) = 0$ for all $t  0$.\n\nTo solve the equation numerically, the student employs the widely-used Crank-Nicolson method, discretizing the domain with a spatial step $\\Delta x$ and advancing in time with a step $\\Delta t$. After running the simulation for a few time steps, the student observes that the numerical solution for the temperature profile exhibits non-physical oscillations or \"wiggles\" in the region near the initial discontinuity at $x=L/2$.\n\nWhich of the following statements provides the most accurate and fundamental explanation for why the Crank-Nicolson method produces these spurious oscillations when applied to an initial condition with a sharp discontinuity?\n\nA. The Crank-Nicolson method is only conditionally stable, and the combination of the sharp initial condition and the chosen parameters $\\Delta t$ and $\\Delta x$ violates the Courant-Friedrichs-Lewy (CFL) condition, leading to an unstable, oscillating solution.\n\nB. The oscillations are a direct numerical manifestation of the Gibbs phenomenon. Any numerical method based on a finite grid-point representation will inevitably produce such overshoots when approximating a discontinuous function, regardless of the specific time-stepping scheme used.\n\nC. The implicit nature of the Crank-Nicolson scheme requires the solution of a tridiagonal system of linear equations at each time step. The sharp discontinuity in the initial data vector yields an ill-conditioned matrix, and the numerical errors from the linear solver are the source of the oscillatory behavior.\n\nD. The method suffers from significant numerical dispersion error, meaning that different Fourier components of the numerical solution travel at incorrect, frequency-dependent phase velocities. The high-frequency components, which are essential for representing the discontinuity, spread out and interfere, creating the observed \"wiggles\".\n\nE. Accurately representing a sharp discontinuity requires a wide spectrum of spatial Fourier modes. The amplification factor of the Crank-Nicolson method approaches -1 for the highest-frequency modes supported by the numerical grid. Consequently, these high-frequency components are poorly damped and invert their phase at each time step, causing them to persist as oscillations.", "solution": "We analyze the Crank-Nicolson (CN) scheme for the heat equation $u_{t} = D u_{xx}$ using a von Neumann Fourier-mode analysis to identify the mechanism generating oscillations for discontinuous initial data. Let the spatial grid be $x_{j} = j \\Delta x$ and time levels $t^{n} = n \\Delta t$. The CN discretization at an interior point $j$ is\n$$\n\\frac{u_{j}^{n+1} - u_{j}^{n}}{\\Delta t}\n= \\frac{D}{2} \\left( \\frac{u_{j+1}^{n+1} - 2 u_{j}^{n+1} + u_{j-1}^{n+1}}{(\\Delta x)^{2}}\n+ \\frac{u_{j+1}^{n} - 2 u_{j}^{n} + u_{j-1}^{n}}{(\\Delta x)^{2}} \\right).\n$$\nIntroduce the nondimensional parameter $r = \\frac{D \\Delta t}{(\\Delta x)^{2}}$. Rearranging gives the linear system\n$$\n-\\frac{r}{2} u_{j-1}^{n+1} + (1 + r) u_{j}^{n+1} - \\frac{r}{2} u_{j+1}^{n+1}\n= \\frac{r}{2} u_{j-1}^{n} + (1 - r) u_{j}^{n} + \\frac{r}{2} u_{j+1}^{n}.\n$$\nFor von Neumann analysis, assume a Fourier mode $u_{j}^{n} = G^{n} \\exp(i j \\theta)$ with $\\theta \\in [0,\\pi]$. Substituting $u_{j\\pm 1}^{n} = G^{n} \\exp(i (j \\pm 1)\\theta)$ and similarly for $n+1$, we obtain\n$$\nG \\left( -\\frac{r}{2} \\exp(-i \\theta) + (1 + r) - \\frac{r}{2} \\exp(i \\theta) \\right)\n= \\frac{r}{2} \\exp(-i \\theta) + (1 - r) + \\frac{r}{2} \\exp(i \\theta).\n$$\nUsing $\\exp(i \\theta) + \\exp(-i \\theta) = 2 \\cos \\theta$, this simplifies to\n$$\nG \\left( 1 + r - r \\cos \\theta \\right) = 1 - r + r \\cos \\theta,\n$$\nhence the CN amplification factor is\n$$\nG(\\theta) = \\frac{1 - r + r \\cos \\theta}{1 + r - r \\cos \\theta}.\n$$\nEquivalently, using $1 - \\cos \\theta = 2 \\sin^{2}(\\theta/2)$,\n$$\nG(\\theta) = \\frac{1 - 2 r \\sin^{2}(\\theta/2)}{1 + 2 r \\sin^{2}(\\theta/2)}.\n$$\nThe highest-frequency mode supported on the grid is the Nyquist mode with $\\theta = \\pi$, for which $\\sin^{2}(\\pi/2) = 1$, giving\n$$\nG(\\pi) = \\frac{1 - 2 r}{1 + 2 r}.\n$$\nTwo crucial properties follow:\n- Magnitude: $\\left| G(\\pi) \\right| = \\left| \\frac{1 - 2 r}{1 + 2 r} \\right|  1$, so CN is unconditionally stable (ruling out statement A). However, as $r$ grows, $\\left| G(\\pi) \\right| \\to 1$, meaning the highest-frequency component is very poorly damped (CN is A-stable but not L-stable).\n- Sign: For $r  \\frac{1}{2}$, $G(\\pi)  0$, so the Nyquist component flips sign at each time step, i.e., it undergoes a phase inversion. Even for modes with $\\theta$ near $\\pi$, $G(\\theta)$ is close to $-1$ when $r$ is not very small, so these high-frequency components exhibit weak damping and temporal sign alternation.\n\nPhysically, a sharp discontinuity requires a wide spectrum of high spatial frequencies. The exact heat equation damps these modes strongly with factor $\\exp(-D k^{2} \\Delta t)$ over a time step. By contrast, the CN amplification factor for the discrete highest frequencies approaches $-1$ rather than $0$, so those components are not strongly attenuated and may invert phase between steps. This leads to persistent, non-physical oscillations (spatial “wiggles”) near the discontinuity that decay very slowly.\n\nThis mechanism is not Gibbs phenomenon per se (statement B), which concerns Fourier truncation overshoot independent of time-stepping. It is not due to ill-conditioning of the tridiagonal system (statement C), which remains well-conditioned and diagonally dominant for $r  0$. It is not numerical dispersion (statement D), which pertains to wave propagation with phase velocity errors; the heat equation is diffusive, and the issue here is insufficient damping and sign inversion of high-frequency modes.\n\nTherefore, the most accurate and fundamental explanation is that the CN amplification factor for the highest-frequency modes approaches $-1$, causing poor damping and phase inversion of the crucial high-frequency content required to represent the discontinuity, which produces the observed oscillations. This corresponds to statement E.", "answer": "$$\\boxed{E}$$", "id": "2211533"}]}