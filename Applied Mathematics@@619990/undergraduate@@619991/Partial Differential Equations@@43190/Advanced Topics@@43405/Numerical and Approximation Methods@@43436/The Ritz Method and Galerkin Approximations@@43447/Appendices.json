{"hands_on_practices": [{"introduction": "The Galerkin method provides a powerful framework for finding approximate solutions to differential equations. This first exercise introduces the core procedure using a single \"hat function,\" which is a piecewise linear function. Mastering this approach [@problem_id:2149993] is a crucial first step, as these simple hat functions are the fundamental building blocks of the widely used Finite Element Method (FEM) for solving complex engineering and physics problems.", "problem": "Consider the two-point boundary value problem defined by the differential equation\n$$ -\\frac{d^2u}{dx^2} = 1 $$\non the interval $x \\in [0, 1]$, with the boundary conditions $u(0) = 0$ and $u(1) = 0$.\n\nWe seek an approximate solution to this problem using the Galerkin method. The approximate solution, denoted $u_h(x)$, is assumed to be in the space spanned by a single basis function $\\phi(x)$. This basis function, often called a \"hat function,\" is a piecewise linear function defined as:\n$$\n\\phi(x) = \\begin{cases}\n2x  \\text{for } 0 \\le x \\le 1/2 \\\\\n2(1-x)  \\text{for } 1/2  x \\le 1\n\\end{cases}\n$$\nThe approximate solution is of the form $u_h(x) = c \\cdot \\phi(x)$, where $c$ is a constant coefficient to be determined.\n\nDetermine the approximate solution $u_h(x)$. The answer should be a fully specified, piecewise function of $x$.", "solution": "We solve the boundary value problem by the Galerkin method. The weak form for $-u''=1$ with homogeneous Dirichlet boundary conditions is: find $u \\in V$ with $V=\\{v \\in H_{0}^{1}(0,1)\\}$ such that\n$$\n\\int_{0}^{1} u'(x)\\,v'(x)\\,dx=\\int_{0}^{1} 1\\cdot v(x)\\,dx\n$$\nfor all $v \\in V$. Using the one-dimensional trial space spanned by $\\phi$, we take $u_{h}(x)=c\\,\\phi(x)$ and test with $v=\\phi$. This gives the Galerkin equation\n$$\n\\int_{0}^{1} (c\\,\\phi'(x))\\,\\phi'(x)\\,dx=\\int_{0}^{1} \\phi(x)\\,dx,\n$$\nwhich simplifies to\n$$\nc\\int_{0}^{1} \\left(\\phi'(x)\\right)^{2}\\,dx=\\int_{0}^{1} \\phi(x)\\,dx.\n$$\nThe basis function is\n$$\n\\phi(x)=\\begin{cases}\n2x  0\\le x\\le \\frac{1}{2} \\\\\n2(1-x)  \\frac{1}{2}x\\le 1\n\\end{cases}\n$$\nso its derivative is\n$$\n\\phi'(x)=\\begin{cases}\n2  0x\\frac{1}{2} \\\\\n-2  \\frac{1}{2}x1\n\\end{cases}\n$$\nand hence $\\left(\\phi'(x)\\right)^{2}=4$ almost everywhere on $(0,1)$. Therefore,\n$$\n\\int_{0}^{1} \\left(\\phi'(x)\\right)^{2}\\,dx=\\int_{0}^{1} 4\\,dx=4.\n$$\nNext,\n$$\n\\int_{0}^{1} \\phi(x)\\,dx=\\int_{0}^{\\frac{1}{2}} 2x\\,dx+\\int_{\\frac{1}{2}}^{1} 2(1-x)\\,dx=\\left[x^{2}\\right]_{0}^{\\frac{1}{2}}+\\left[2x-x^{2}\\right]_{\\frac{1}{2}}^{1}=\\frac{1}{4}+\\frac{1}{4}=\\frac{1}{2}.\n$$\nThus $c$ satisfies\n$$\nc\\cdot 4=\\frac{1}{2}\\quad\\Rightarrow\\quad c=\\frac{1}{8}.\n$$\nThe approximate solution is\n$$\nu_{h}(x)=c\\,\\phi(x)=\\frac{1}{8}\\,\\phi(x)=\\begin{cases}\n\\frac{1}{8}\\cdot 2x=\\frac{x}{4}  0\\le x\\le \\frac{1}{2} \\\\\n\\frac{1}{8}\\cdot 2(1-x)=\\frac{1-x}{4}  \\frac{1}{2}x\\le 1.\n\\end{cases}\n$$", "answer": "$$\\boxed{\\begin{cases}\n\\frac{x}{4}  0\\le x\\le \\frac{1}{2} \\\\\n\\frac{1-x}{4}  \\frac{1}{2}x\\le 1\n\\end{cases}}$$", "id": "2149993"}, {"introduction": "While a single basis function can provide a rough estimate, accuracy is often improved by using a richer set of functions. This next practice explores how to enhance an approximation by combining multiple basis functionsâ€”in this case, two trigonometric functions. By doing so, we transform the problem into solving a system of linear equations for the unknown coefficients [@problem_id:2149992], a process that directly illustrates how the Galerkin method scales to handle more complex scenarios and achieve higher precision.", "problem": "Consider the second-order ordinary differential equation\n$$\n-u''(x) + u(x) = x\n$$\non the interval $x \\in (0, 1)$, subject to the homogeneous boundary conditions $u(0) = 0$ and $u(1) = 0$.\n\nWe seek an approximate solution to this boundary value problem of the form\n$$\nu_2(x) = c_1 \\sin(\\pi x) + c_2 \\sin(2\\pi x).\n$$\nThe unknown coefficients $c_1$ and $c_2$ are determined using a weighted residual method. Specifically, we define a residual function $R(x) = -u_2''(x) + u_2(x) - x$, which measures the error of the approximation. The coefficients are found by enforcing the condition that the residual is orthogonal to the basis functions used in the approximation. This leads to the following system of two equations:\n$$\n\\int_0^1 R(x) \\sin(\\pi x) dx = 0\n$$\n$$\n\\int_0^1 R(x) \\sin(2\\pi x) dx = 0\n$$\nDetermine the approximate solution $u_2(x)$ by finding the coefficients $c_1$ and $c_2$. Present your final answer as an analytical expression for $u_2(x)$.", "solution": "We approximate the solution by $u_{2}(x)=c_{1}\\sin(\\pi x)+c_{2}\\sin(2\\pi x)$, which satisfies the homogeneous boundary conditions at $x=0$ and $x=1$. The residual is defined by\n$$\nR(x)=-u_{2}''(x)+u_{2}(x)-x.\n$$\nCompute $u_{2}''(x)$ using $d^{2}/dx^{2}\\sin(k\\pi x)=-(k\\pi)^{2}\\sin(k\\pi x)$, so\n$$\n-u_{2}''(x)+u_{2}(x)=\\left((\\pi^{2}+1)c_{1}\\sin(\\pi x)+((2\\pi)^{2}+1)c_{2}\\sin(2\\pi x)\\right).\n$$\nThus\n$$\nR(x)=(\\pi^{2}+1)c_{1}\\sin(\\pi x)+\\left(4\\pi^{2}+1\\right)c_{2}\\sin(2\\pi x)-x.\n$$\nThe weighted residual conditions with weights $\\sin(\\pi x)$ and $\\sin(2\\pi x)$ give\n$$\n\\int_{0}^{1}R(x)\\sin(\\pi x)\\,dx=0,\\qquad \\int_{0}^{1}R(x)\\sin(2\\pi x)\\,dx=0.\n$$\nUsing orthogonality $\\int_{0}^{1}\\sin(m\\pi x)\\sin(n\\pi x)\\,dx=0$ for $m\\neq n$ and $\\int_{0}^{1}\\sin^{2}(n\\pi x)\\,dx=\\frac{1}{2}$, these reduce to\n$$\n(\\pi^{2}+1)c_{1}\\int_{0}^{1}\\sin^{2}(\\pi x)\\,dx-\\int_{0}^{1}x\\sin(\\pi x)\\,dx=0,\n$$\n$$\n(4\\pi^{2}+1)c_{2}\\int_{0}^{1}\\sin^{2}(2\\pi x)\\,dx-\\int_{0}^{1}x\\sin(2\\pi x)\\,dx=0.\n$$\nHence\n$$\n\\frac{\\pi^{2}+1}{2}\\,c_{1}=I_{1},\\qquad \\frac{4\\pi^{2}+1}{2}\\,c_{2}=I_{2},\n$$\nwhere $I_{n}=\\int_{0}^{1}x\\sin(n\\pi x)\\,dx$. Compute $I_{n}$ by integration by parts: with $u=x$, $dv=\\sin(n\\pi x)\\,dx$ so $du=dx$, $v=-\\cos(n\\pi x)/(n\\pi)$,\n$$\nI_{n}=\\left[-\\frac{x\\cos(n\\pi x)}{n\\pi}\\right]_{0}^{1}+\\int_{0}^{1}\\frac{\\cos(n\\pi x)}{n\\pi}\\,dx\n=-\\frac{\\cos(n\\pi)}{n\\pi}+\\left[\\frac{\\sin(n\\pi x)}{(n\\pi)^{2}}\\right]_{0}^{1}.\n$$\nSince $\\sin(n\\pi)=0$ and $\\cos(n\\pi)=(-1)^{n}$, it follows that\n$$\nI_{n}=-\\frac{(-1)^{n}}{n\\pi}.\n$$\nTherefore,\n$$\nI_{1}=\\frac{1}{\\pi},\\qquad I_{2}=-\\frac{1}{2\\pi}.\n$$\nSolving for $c_{1}$ and $c_{2}$ gives\n$$\nc_{1}=\\frac{2I_{1}}{\\pi^{2}+1}=\\frac{2}{\\pi(\\pi^{2}+1)},\\qquad\nc_{2}=\\frac{2I_{2}}{4\\pi^{2}+1}=-\\frac{1}{\\pi(4\\pi^{2}+1)}.\n$$\nThus the approximate solution is\n$$\nu_{2}(x)=\\frac{2}{\\pi(\\pi^{2}+1)}\\sin(\\pi x)-\\frac{1}{\\pi(4\\pi^{2}+1)}\\sin(2\\pi x).\n$$", "answer": "$$\\boxed{\\frac{2}{\\pi(\\pi^{2}+1)}\\sin(\\pi x)-\\frac{1}{\\pi(4\\pi^{2}+1)}\\sin(2\\pi x)}$$", "id": "2149992"}, {"introduction": "The power of approximation methods extends beyond stationary problems to time-evolving systems described by partial differential equations (PDEs). This exercise demonstrates a crucial technique known as the \"method of lines,\" where a spatial Galerkin approximation is first used to convert a PDE into a system of ordinary differential equations (ODEs) in time. By then applying a numerical scheme like the backward Euler method [@problem_id:2149984], you will learn how to build a fully discrete model capable of simulating dynamic processes like heat diffusion.", "problem": "Consider the one-dimensional heat equation, a Partial Differential Equation (PDE), given by $\\frac{\\partial u}{\\partial t} = \\frac{\\partial^2 u}{\\partial x^2}$ on the spatial domain $x \\in [0, \\pi]$ for time $t  0$. The system is subject to homogeneous Dirichlet boundary conditions: $u(0, t) = u(\\pi, t) = 0$.\n\nWe seek an approximate solution using a one-term Galerkin method of the form $\\tilde{u}(x, t) = c(t) \\phi(x)$, where the time-dependent coefficient is $c(t)$ and the spatial basis function is chosen as $\\phi(x) = \\sin(x)$ to satisfy the boundary conditions.\n\nThis process results in a first-order Ordinary Differential Equation (ODE) for the coefficient $c(t)$. To solve this ODE numerically, the backward Euler method is applied with a uniform time step size $\\Delta t$.\n\nLet $c_n$ represent the value of the coefficient at time $t_n = n \\Delta t$. Derive the fully-discrete algebraic update scheme that expresses the coefficient at the next time step, $c_{n+1}$, in terms of its value at the current time step, $c_n$, and the time step size $\\Delta t$.", "solution": "We approximate the solution as $\\tilde{u}(x,t)=c(t)\\phi(x)$ with $\\phi(x)=\\sin(x)$, which satisfies the homogeneous Dirichlet boundary conditions. Using the weak Galerkin formulation for $u_{t}=u_{xx}$, multiply by the test function $\\phi$ and integrate over $[0,\\pi]$, integrating the diffusion term by parts (and using that boundary terms vanish due to the Dirichlet conditions):\n$$\n\\int_{0}^{\\pi}\\phi(x)\\,\\frac{\\partial \\tilde{u}}{\\partial t}(x,t)\\,dx+\\int_{0}^{\\pi}\\frac{\\partial \\phi}{\\partial x}(x)\\,\\frac{\\partial \\tilde{u}}{\\partial x}(x,t)\\,dx=0.\n$$\nSubstitute $\\tilde{u}(x,t)=c(t)\\phi(x)$ to obtain\n$$\n\\left(\\int_{0}^{\\pi}\\phi^{2}(x)\\,dx\\right)c'(t)+\\left(\\int_{0}^{\\pi}\\left(\\frac{\\partial \\phi}{\\partial x}(x)\\right)^{2}\\,dx\\right)c(t)=0.\n$$\nWith $\\phi(x)=\\sin(x)$, we have $\\frac{\\partial \\phi}{\\partial x}(x)=\\cos(x)$, and thus\n$$\nM\\,c'(t)+S\\,c(t)=0,\\quad\\text{where}\\quad M=\\int_{0}^{\\pi}\\sin^{2}(x)\\,dx,\\quad S=\\int_{0}^{\\pi}\\cos^{2}(x)\\,dx.\n$$\nSince $M=S$ for this choice of $\\phi$, the semi-discrete ODE reduces to\n$$\nc'(t)+c(t)=0.\n$$\nApplying the backward Euler method with uniform time step $\\Delta t$ gives\n$$\n\\frac{c_{n+1}-c_{n}}{\\Delta t}+c_{n+1}=0,\n$$\nwhich rearranges to the fully-discrete update\n$$\n(1+\\Delta t)\\,c_{n+1}=c_{n}\\quad\\Longrightarrow\\quad c_{n+1}=\\frac{c_{n}}{1+\\Delta t}.\n$$", "answer": "$$\\boxed{c_{n+1} = \\frac{c_{n}}{1+\\Delta t}}$$", "id": "2149984"}]}