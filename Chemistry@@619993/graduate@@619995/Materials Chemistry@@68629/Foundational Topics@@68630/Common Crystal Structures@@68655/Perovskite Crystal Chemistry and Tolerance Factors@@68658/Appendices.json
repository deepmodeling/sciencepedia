{"hands_on_practices": [{"introduction": "Before applying predictive tools in materials science, it is crucial to understand their physical and mathematical origins. This foundational exercise guides you through the derivation of the Goldschmidt tolerance factor, $t$, directly from the geometric constraints of an ideal hard-sphere packing in a cubic perovskite structure [@problem_id:2506459]. Mastering this derivation solidifies the connection between ionic radii and the structural stability of this important class of materials.", "problem": "An ideal cubic perovskite of composition $\\text{ABO}_3$ (space group $Pm\\bar{3}m$) can be modeled by hard-sphere ionic packing where cation–anion contacts are satisfied without overlap. In this structure, the B cation is at the body center, the A cation occupies the cube corners, and oxygen occupies the face centers. Using only geometric relations arising from this lattice and the definition of an ionic radius as the distance from the ion center to the point of anion–cation contact, first derive a dimensionless ratio that compares how well the A–O and B–O contact requirements can be simultaneously satisfied by a single cubic lattice parameter. This ratio is known as the Goldschmidt tolerance factor $t$ and is expressed solely in terms of $r_{A}$, $r_{B}$, and $r_{O}$.\n\nThen, for $r_{A}=1.61$ Å, $r_{B}=0.645$ Å, and $r_{O}=1.40$ Å (all radii understood as appropriate Shannon effective ionic radii for the perovskite coordination environments), evaluate $t$. Express $t$ as a pure number and round your answer to four significant figures.\n\nFinally, based on experimentally established trends of perovskite stability as a function of the magnitude of $t$ relative to $1$, provide a brief qualitative assessment of the expected structural distortions relative to the ideal cubic phase. Do not report this qualitative assessment in the final numerical answer; include it only in your reasoning.", "solution": "The problem is first validated. The givens are: an ideal cubic perovskite $\\text{ABO}_3$ with the space group $Pm\\bar{3}m$, where the A cation is at the cube corners, the B cation is at the body center, and the O anions are at the face centers. Ionic radii are given as $r_{A}=1.61$ Å, $r_{B}=0.645$ Å, and $r_{O}=1.40$ Å. The problem is scientifically grounded, well-posed, and objective, with all necessary data provided for a formal solution. No flaws are identified. The problem is deemed valid.\n\nThe solution proceeds in three parts as requested: derivation of the Goldschmidt tolerance factor $t$, numerical calculation of $t$, and a qualitative assessment of structural stability.\n\nFirst, we derive the Goldschmidt tolerance factor, $t$, from the geometric constraints of the ideal cubic perovskite structure, modeled as a hard-sphere packing. Let the lattice parameter of the cubic unit cell be $a$.\n\nThe B cation is located at the body-center position, with coordinates $(\\frac{1}{2}, \\frac{1}{2}, \\frac{1}{2})a$. The O anions are at the face-center positions, such as $(\\frac{1}{2}, \\frac{1}{2}, 0)a$. The distance between the B cation and an adjacent O anion, $d(\\text{B-O})$, is along the line connecting the body center to a face center. This distance is half the lattice parameter.\n$$d(\\text{B-O}) = \\frac{a}{2}$$\nIn the hard-sphere model, this contact distance is the sum of the ionic radii of the B cation and the O anion.\n$$d(\\text{B-O}) = r_{B} + r_{O}$$\nFor perfect contact along the B-O bond, these two expressions must be equal, which defines a lattice parameter $a_{\\text{BO}}$ based on the B-O bond length.\n$$\\frac{a_{\\text{BO}}}{2} = r_{B} + r_{O} \\implies a_{\\text{BO}} = 2(r_{B} + r_{O})$$\n\nNext, we consider the A cation, located at a corner of the cube, for instance, at position $(0, 0, 0)a$. It is coordinated by O anions at adjacent face centers, such as $(\\frac{1}{2}, \\frac{1}{2}, 0)a$. The distance between the A cation and this O anion, $d(\\text{A-O})$, is along the face diagonal of the cube. The length of this distance is calculated using the Pythagorean theorem.\n$$d(\\text{A-O}) = \\sqrt{\\left(\\frac{a}{2}\\right)^{2} + \\left(\\frac{a}{2}\\right)^{2}} = \\sqrt{\\frac{a^{2}}{4} + \\frac{a^{2}}{4}} = \\sqrt{\\frac{2a^{2}}{4}} = \\frac{a\\sqrt{2}}{2} = \\frac{a}{\\sqrt{2}}$$\nIn the hard-sphere model, this contact distance is the sum of the ionic radii of the A cation and the O anion.\n$$d(\\text{A-O}) = r_{A} + r_{O}$$\nFor perfect contact along the A-O bond, these two expressions for $d(\\text{A-O})$ would be equal, defining a lattice parameter $a_{\\text{AO}}$ based on the A-O bond length.\n$$\\frac{a_{\\text{AO}}}{\\sqrt{2}} = r_{A} + r_{O} \\implies a_{\\text{AO}} = \\sqrt{2}(r_{A} + r_{O})$$\n\nFor an ideal cubic perovskite, both contact conditions must be satisfied simultaneously by a single lattice parameter $a$, meaning $a_{\\text{BO}} = a_{\\text{AO}} = a$. The Goldschmidt tolerance factor, $t$, is a dimensionless parameter that quantifies the degree of mismatch between the two ideal bond lengths. It is defined as the ratio of the A-O bond distance to the space available for it within the framework defined by the B-O bonds.\n$$t = \\frac{d(\\text{A-O})_{\\text{ideal}}}{d(\\text{A-O})_{\\text{framework}}}$$\nHere, the ideal A-O distance is $r_{A} + r_{O}$. The space available within the framework, $d(\\text{A-O})_{\\text{framework}}$, is the geometric distance from a corner to a face center, $\\frac{a}{\\sqrt{2}}$, where the lattice parameter $a$ is determined by the more rigid $\\text{BO}_6$ octahedral network. Thus, we substitute $a = a_{\\text{BO}} = 2(r_{B} + r_{O})$.\n$$d(\\text{A-O})_{\\text{framework}} = \\frac{2(r_{B} + r_{O})}{\\sqrt{2}} = \\sqrt{2}(r_{B} + r_{O})$$\nSubstituting these expressions into the definition of $t$ gives the final derived form of the Goldschmidt tolerance factor.\n$$t = \\frac{r_{A} + r_{O}}{\\sqrt{2}(r_{B} + r_{O})}$$\nThis completes the derivation.\n\nSecond, we evaluate $t$ numerically using the provided ionic radii: $r_{A}=1.61$ Å, $r_{B}=0.645$ Å, and $r_{O}=1.40$ Å. The units of angstroms (Å) are present in both the numerator and denominator and will cancel, yielding a dimensionless quantity as required.\n$$t = \\frac{1.61 + 1.40}{\\sqrt{2}(0.645 + 1.40)}$$\n$$t = \\frac{3.01}{\\sqrt{2}(2.045)}$$\n$$t = \\frac{3.01}{2.892015...}$$\n$$t \\approx 1.04080$$\nRounding the result to four significant figures gives:\n$$t = 1.041$$\n\nFinally, we provide a qualitative assessment of the expected structural distortion. The ideal cubic perovskite structure is most stable when $t=1$. The calculated value is $t = 1.041$, which is greater than $1$. When $t > 1$, the A-cation is relatively too large for the cavity defined by the $\\text{BO}_6$ octahedral framework, putting the B-O bonds under tensile strain. To relieve this strain, the crystal structure must distort. However, the cooperative tilting of octahedra seen for $t<1$ is not favorable, as this would shrink the A-site cavity and worsen the strain. Instead, for $t>1$, other distortions are preferred, such as an off-center displacement of the B-cation, which can lead to ferroelectricity. If the size mismatch is too large (typically for $t \\gg 1.05$), the structure may transform into a non-perovskite hexagonal phase. Since $t=1.041$ is only modestly greater than 1, a distortion to a lower-symmetry ferroelectric phase (e.g., tetragonal) is a highly plausible outcome.", "answer": "$$\\boxed{1.041}$$", "id": "2506459"}, {"introduction": "With a solid grasp of the tolerance factor for a single compound, we can now apply it to more complex and technologically relevant materials systems. This problem challenges you to analyze a perovskite solid solution where the average A-site cation size, and thus the tolerance factor, varies continuously [@problem_id:2506456]. By predicting the compositional range of maximum stability and the plausible locations of phase boundaries, you will practice using the tolerance factor as a practical tool in rational materials design.", "problem": "A pseudo-binary oxide perovskite solid solution $\\text{A}^{(1)}_{1-x}\\text{A}^{(2)}_{x}\\text{BO}_3$ is formed by mixing two endmembers, $\\text{A}^{(1)}\\text{BO}_3$ and $\\text{A}^{(2)}\\text{BO}_3$, that share the same B cation and oxygen framework but differ in the effective A-site size. The Goldschmidt tolerance factor $t$ for the endmembers is measured to be $t_1=0.98$ for $\\text{A}^{(1)}\\text{BO}_3$ and $t_2=1.03$ for $\\text{A}^{(2)}\\text{BO}_3$ at ambient conditions. Assume that the effective A-site size varies nearly linearly with $x$ in the solid solution (consistent with Vegard-like behavior for ionic radii), so that $t$ varies approximately linearly between the endmember values as a function of $x$. Consider ambient pressure and equilibrium (slow-cooling) conditions.\n\nBased on the established geometric interpretation of the tolerance factor for corner-sharing $\\text{BO}_6$ networks and the typical structural competitors in oxide systems, which composition range $x$ is expected to maximize the thermodynamic stability of the corner-sharing perovskite framework, and where are phase boundaries to competing hexagonal polytypes or other non-perovskite forms most plausibly encountered?\n\nChoose the best answer.\n\nA. The corner-sharing perovskite structure is most stable across the full range $0 \\le x \\le 1$; no phase boundaries to non-perovskite structures are expected because both $t_1$ and $t_2$ lie close to unity.\n\nB. The corner-sharing perovskite structure is most stable only for $0 \\le x \\le 0.4$, with a phase boundary near $x \\approx 0.4$ (where $t \\approx 1$); for $x>0.4$, hexagonal polytypes become dominant.\n\nC. The corner-sharing perovskite structure is most stable for $0 \\le x \\lesssim 0.6$, centered near $x \\approx 0.4$ (where $t \\approx 1$); beyond $x \\sim 0.6$–$0.8$ a transition to hexagonal polytypes or other non-perovskite structures is likely as $t$ exceeds a modest threshold above unity.\n\nD. The corner-sharing perovskite structure is most stable only near the $\\text{A}^{(2)}$-rich end ($x \\to 1$) where $t$ is largest; for $x < 0.8$, non-perovskite phases are expected to dominate due to excessive octahedral tilting.", "solution": "The problem statement must first be validated for scientific soundness and logical consistency.\n\n**Step 1: Extract Givens**\n- The system is a pseudo-binary oxide perovskite solid solution with the formula $\\text{A}^{(1)}_{1-x}\\text{A}^{(2)}_{x}\\text{BO}_3$.\n- The endmembers are $\\text{A}^{(1)}\\text{BO}_3$ and $\\text{A}^{(2)}\\text{BO}_3$.\n- The Goldschmidt tolerance factor for $\\text{A}^{(1)}\\text{BO}_3$ is $t_1=0.98$.\n- The Goldschmidt tolerance factor for $\\text{A}^{(2)}\\text{BO}_3$ is $t_2=1.03$.\n- It is assumed that the tolerance factor, $t$, varies approximately linearly with the composition $x$.\n- The conditions are ambient pressure and equilibrium (slow-cooling).\n- The question asks to identify the composition range $x$ that maximizes the thermodynamic stability of the corner-sharing perovskite framework and to predict where phase boundaries to competing structures are most plausible.\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientific Grounding**: The problem is well-grounded in the principles of solid-state chemistry and materials science. The Goldschmidt tolerance factor is a fundamental concept used to predict the stability of the perovskite crystal structure. The values $t_1=0.98$ and $t_2=1.03$ are physically realistic and represent common scenarios. The concept of forming a solid solution and the assumption of a Vegard-like linear interpolation for effective ionic radii, and consequently for the tolerance factor, is a standard and reasonable approximation. The competition between corner-sharing perovskites and hexagonal polytypes as a function of tolerance factor is a well-documented phenomenon.\n- **Well-Posedness**: The problem is well-posed. It provides sufficient information to deduce the most likely structural behavior based on established empirical rules. The question asks for the \"most plausible\" outcome, which is appropriate given that the tolerance factor is a geometric guideline, not an absolute law.\n- **Objectivity**: The problem is stated in precise, objective, and technical language, free from ambiguity or subjective content.\n\n**Step 3: Verdict and Action**\nThe problem statement is scientifically sound, self-contained, and well-posed. It is therefore deemed **valid**. I will proceed with the derivation of the solution.\n\n**Derivation**\n\nThe Goldschmidt tolerance factor, $t$, is a dimensionless quantity that provides a geometric criterion for the stability of the perovskite structure, defined as:\n$$t = \\frac{r_A + r_O}{\\sqrt{2}(r_B + r_O)}$$\nwhere $r_A$, $r_B$, and $r_O$ are the ionic radii of the A-site cation, B-site cation, and oxygen anion, respectively.\n\nThe interpretation of the tolerance factor is as follows:\n- $t=1$: This corresponds to the ideal cubic perovskite structure ($Pm\\bar{3}m$ symmetry), where the ionic radii are perfectly matched to form a close-packed arrangement with no intrinsic strain in the bonds. This represents the geometric ideal for maximum stability of the perovskite lattice.\n- $t<1$: The A-site cation is too small for the cavity formed by the corner-sharing $\\text{BO}_6$ octahedra. To relieve the strain and improve the A-O bond lengths, the framework of $\\text{BO}_6$ octahedra will tilt and rotate. This lowers the crystal symmetry (e.g., to rhombohedral or orthorhombic) but preserves the corner-sharing connectivity. This tilting mechanism is a primary way the perovskite structure adapts to ionic size mismatch and is extremely common. The perovskite structure is generally stable for $t$ down to approximately $0.8$.\n- $t>1$: The A-site cation is too large for the cavity. This puts the B-O bonds under tensile strain and the A-O bonds under compressive strain. For values of $t$ slightly greater than $1$, the corner-sharing perovskite structure can still form. However, as $t$ increases further (typically above a threshold around $1.0-1.05$), the corner-sharing network becomes energetically unfavorable. The system can achieve a lower energy state by forming hexagonal polytypes. These structures incorporate layers of face-sharing $\\text{BO}_6$ octahedra, which provides a more suitable coordination environment for large A-site cations.\n\nIn the given problem, the tolerance factor $t$ for the solid solution $\\text{A}^{(1)}_{1-x}\\text{A}^{(2)}_{x}\\text{BO}_3$ varies linearly with $x$ between $t_1=0.98$ at $x=0$ and $t_2=1.03$ at $x=1$. The functional form is:\n$$t(x) = t_1(1-x) + t_2x = 0.98(1-x) + 1.03x = 0.98 - 0.98x + 1.03x$$\n$$t(x) = 0.98 + 0.05x$$\n\nThe maximum thermodynamic stability for the perovskite structure family is expected where $t(x)$ is closest to the ideal value of $1$. We find the composition $x$ where $t(x)=1$:\n$$1 = 0.98 + 0.05x$$\n$$0.02 = 0.05x$$\n$$x = \\frac{0.02}{0.05} = \\frac{2}{5} = 0.4$$\nThus, the perovskite structure is expected to be most stable, and most likely to exhibit the ideal cubic symmetry, around the composition $x=0.4$.\n\nNow, we consider the phase boundaries. At $x=0$, $t=0.98$. This value is very typical for a stable, tilted (non-cubic) perovskite. At $x=1$, $t=1.03$. This value is at the upper end of the stability range for corner-sharing perovskites. In many oxide systems, tolerance factors exceeding unity, even by a small amount, provide a thermodynamic driving force for the formation of hexagonal polytypes, which are the primary structural competitors in this regime. A phase transition from the corner-sharing perovskite to a hexagonal polytype is therefore most plausible as $x$ increases significantly above $0.4$, pushing $t$ further beyond $1$. The exact composition for this transition is system-dependent but is expected to occur at a \"modest threshold\" above $t=1$. A transition beginning in the range of $x$ from approximately $0.6$ ($t=1.01$) to $0.8$ ($t=1.02$) is a very reasonable prediction.\n\n**Option-by-Option Analysis**\n\nA. The corner-sharing perovskite structure is most stable across the full range $0 \\le x \\le 1$; no phase boundaries to non-perovskite structures are expected because both $t_1$ and $t_2$ lie close to unity.\nThis statement is flawed. The stability is not uniform; it is maximized near $t=1$ (i.e., $x=0.4$), not across the \"full range\". Furthermore, to claim that \"no phase boundaries are expected\" is an oversimplification. A tolerance factor of $t=1.03$ is sufficiently large to make the formation of competing hexagonal polytypes plausible, especially under equilibrium conditions.\n**Verdict: Incorrect.**\n\nB. The corner-sharing perovskite structure is most stable only for $0 \\le x \\le 0.4$, with a phase boundary near $x \\approx 0.4$ (where $t \\approx 1$); for $x>0.4$, hexagonal polytypes become dominant.\nThis statement is fundamentally incorrect. The composition $x \\approx 0.4$ where $t \\approx 1$ corresponds to the *maximum* stability of the perovskite structure, not a phase boundary where it becomes unstable. Phase transitions to hexagonal polytypes occur for $t>1$, not at $t=1$.\n**Verdict: Incorrect.**\n\nC. The corner-sharing perovskite structure is most stable for $0 \\le x \\lesssim 0.6$, centered near $x \\approx 0.4$ (where $t \\approx 1$); beyond $x \\sim 0.6$–$0.8$ a transition to hexagonal polytypes or other non-perovskite structures is likely as $t$ exceeds a modest threshold above unity.\nThis statement correctly identifies that the stability is centered near $x \\approx 0.4$ where $t \\approx 1$. It correctly identifies the range of stable perovskite compositions including the region where $t<1$ and $t$ is slightly greater than $1$. It then correctly and plausibly predicts that a phase boundary to hexagonal polytypes is \"likely\" as $t$ increases beyond a threshold, suggesting a transition region starting around $x \\sim 0.6$ ($t=1.01$) to $x \\sim 0.8$ ($t=1.02$). This aligns perfectly with established principles of perovskite crystal chemistry.\n**Verdict: Correct.**\n\nD. The corner-sharing perovskite structure is most stable only near the $\\text{A}^{(2)}$-rich end ($x \\to 1$) where $t$ is largest; for $x < 0.8$, non-perovskite phases are expected to dominate due to excessive octahedral tilting.\nThis statement contains multiple errors. Stability is not greatest at the largest $t$; it is greatest near $t=1$. Furthermore, for $x<0.8$ (which includes all compositions where $t<1.02$), the instability mechanism is misidentified. Octahedral tilting occurs for $t<1$ and *stabilizes* the perovskite structure. It does not cause a transition to a \"non-perovskite phase\" unless $t$ becomes extremely small (e.g., $t<0.8$), which is not the case here, as the minimum value is $t(0)=0.98$.\n**Verdict: Incorrect.**", "answer": "$$\\boxed{C}$$", "id": "2506456"}, {"introduction": "While geometric rules like the tolerance factor are invaluable, real-world materials chemistry is nuanced by complex bonding effects that go beyond simple hard-sphere models. This advanced computational practice tasks you with benchmarking the classic tolerance factor against more sophisticated descriptors, including one based on bond-valence theory [@problem_id:2506478]. By implementing a leave-one-out cross-validation procedure, you will quantitatively assess and compare the predictive power of different models, a core skill in modern, data-driven materials discovery.", "problem": "You are given a binary classification task grounded in crystal chemistry of perovskites. A perovskite of nominal stoichiometry $\\text{ABO}_3$ can often be rationalized using ionic packing arguments and bond-valence constraints. You must implement, from first principles, a benchmarking program that compares three scalar descriptors for their ability to classify a small dataset of $\\text{ABO}_3$ compositions as perovskite-forming or non-perovskite-forming.\n\nStart from the following foundational bases:\n\n- Hard-sphere contact geometry for the ideal cubic perovskite structure $\\text{ABO}_3$ with $A$ cations at the cube corners, $B$ cations at the body center, and oxygen anions at the face centers. In an idealized picture, the B-O sublattice forms corner-sharing octahedra that set the cubic lattice parameter.\n- Ionic radii in angstroms (Å) for cations and anions dependent on coordination number, and formal oxidation states for charge balance.\n- Brown’s bond valence model, where a single A-O bond valence $s$ is given by $s = \\exp\\!\\left((R_0 - R)/b\\right)$ with $R$ the bond length in Å, $R_0$ an empirical parameter in Å characteristic of the cation–anion pair and oxidation state, and $b$ a softening parameter in Å. The bond valence sum at a site is the sum of bond valences to that site.\n\nYour program must, for each composition, compute three descriptors:\n\n- Descriptor $t$: a purely geometric packing measure derived from the ideal cubic perovskite contact conditions using a single anion radius for both A-O and B-O contacts.\n- Descriptor $t'$: a variant of the geometric packing measure that distinguishes anion size by coordination, using a $12$-fold anion radius for A-O and a $6$-fold anion radius for B-O.\n- Descriptor $D_{\\mathrm{BV}}$: a bond-valence mismatch computed by enforcing the B-O distance from the octahedral network and quantifying the deviation of the A-site bond valence sum from its formal oxidation state, using Brown’s exponential relation with a fixed $b$ and cation-specific $R_0$ calibrated at the A-site’s reference coordination.\n\nDerive every formula you use from these bases in your implementation and in your reasoning. Do not use any externally provided “shortcut” formulas beyond these bases.\n\nConstants to use:\n\n- Oxygen anion radii: $r_{\\mathrm{O}}^{(\\mathrm{VI})} = 1.40\\,$Å and $r_{\\mathrm{O}}^{(\\mathrm{XII})} = 1.44\\,$Å.\n- Brown’s softening parameter: $b = 0.37\\,$Å.\n\nCation radii are given below and must be used as provided in Å; subscripts denote coordination number: $r_{\\mathrm{A}}^{(\\mathrm{XII})}$ for A-site and $r_{\\mathrm{B}}^{(\\mathrm{VI})}$ for B-site.\n\nYou must benchmark the three descriptors by classification accuracy using leave-one-out cross-validation (LOOCV) on the dataset provided below. For each fold and for each descriptor independently:\n\n1. Using the training subset (all but the held-out composition), determine an optimal scalar threshold $\\theta$ and a polarity $p \\in \\{\\text{predict perovskite if } x \\le \\theta,\\ \\text{predict perovskite if } x \\ge \\theta\\}$ that maximize training accuracy. To do this, evaluate candidate thresholds taken as midpoints between sorted distinct training descriptor values, and include two sentinel thresholds strictly below the minimum and strictly above the maximum training values. For each candidate threshold, evaluate both polarities and select the combination with the highest training accuracy. If there is a tie in accuracy, break ties by choosing the smaller threshold; if still tied, choose the polarity that yields the larger true positive rate (fraction of perovskites correctly identified among those labeled perovskite in the training set); if still tied, choose the polarity “predict perovskite if $x \\le \\theta$.”\n2. Apply the selected threshold and polarity to the held-out sample to produce a predicted class.\n\nCompute the LOOCV accuracy for each descriptor as the fraction of correctly predicted labels across all folds. Express each accuracy as a decimal number rounded to three decimal places.\n\nDataset (each entry is $(\\text{name}, r_{\\mathrm{A}}^{(\\mathrm{XII})}\\,$Å, $V_{\\mathrm{A}}, r_{\\mathrm{B}}^{(\\mathrm{VI})}\\,$Å, $V_{\\mathrm{B}}, \\text{label})$, where label $= 1$ for perovskite-forming and $= 0$ otherwise):\n\n- $\\left(\\text{SrTiO}_3,\\ 1.44,\\ 2,\\ 0.605,\\ 4,\\ 1\\right)$\n- $\\left(\\text{BaTiO}_3,\\ 1.61,\\ 2,\\ 0.605,\\ 4,\\ 1\\right)$\n- $\\left(\\text{CaTiO}_3,\\ 1.34,\\ 2,\\ 0.605,\\ 4,\\ 1\\right)$\n- $\\left(\\text{LaAlO}_3,\\ 1.36,\\ 3,\\ 0.535,\\ 3,\\ 1\\right)$\n- $\\left(\\text{KNbO}_3,\\ 1.64,\\ 1,\\ 0.64,\\ 5,\\ 1\\right)$\n- $\\left(\\text{NaNbO}_3,\\ 1.39,\\ 1,\\ 0.64,\\ 5,\\ 1\\right)$\n- $\\left(\\text{CaZrO}_3,\\ 1.34,\\ 2,\\ 0.72,\\ 4,\\ 1\\right)$\n- $\\left(\\text{LiNbO}_3,\\ 1.18,\\ 1,\\ 0.64,\\ 5,\\ 0\\right)$\n- $\\left(\\text{LiTaO}_3,\\ 1.18,\\ 1,\\ 0.64,\\ 5,\\ 0\\right)$\n- $\\left(\\text{YMnO}_3,\\ 1.28,\\ 3,\\ 0.645,\\ 3,\\ 0\\right)$\n- $\\left(\\text{ScFeO}_3,\\ 1.16,\\ 3,\\ 0.645,\\ 3,\\ 0\\right)$\n- $\\left(\\text{LuFeO}_3,\\ 1.17,\\ 3,\\ 0.645,\\ 3,\\ 0\\right)$\n\nMathematical and algorithmic requirements and definitions that must be respected:\n\n- Use the hard-sphere ideal cubic perovskite argument to relate the ideal B-O distance to the cubic lattice parameter, and the ideal A-O distance to the same lattice parameter. From these relations, construct descriptor $t$ without inserting any empirical correction beyond the single anion radius $r_{\\mathrm{O}}^{(\\mathrm{VI})}$.\n- Construct descriptor $t'$ identically except that for the A-O contact you must use $r_{\\mathrm{O}}^{(\\mathrm{XII})}$ while maintaining $r_{\\mathrm{O}}^{(\\mathrm{VI})}$ for the B-O contact.\n- For the bond-valence mismatch descriptor $D_{\\mathrm{BV}}$:\n  - Take the ideal octahedral framework to fix the B-O distance $R_{\\mathrm{B}\\text{-}\\mathrm{O}}$ from hard-sphere contact using $r_{\\mathrm{B}}^{(\\mathrm{VI})}$ and $r_{\\mathrm{O}}^{(\\mathrm{VI})}$.\n  - From the ideal geometry, infer the corresponding A-O distance $R_{\\mathrm{A}\\text{-}\\mathrm{O}}$ that is enforced by the B-O network.\n  - Calibrate $R_0$ for the A-O cation–anion pair and oxidation state by taking a $12$-fold reference environment with contact distance $R_{\\mathrm{ref},\\mathrm{A}} = r_{\\mathrm{A}}^{(\\mathrm{XII})} + r_{\\mathrm{O}}^{(\\mathrm{XII})}$ and equal-bond partitioning $s_{\\mathrm{ref},\\mathrm{A}} = V_{\\mathrm{A}}/12$, and set $R_{0,\\mathrm{A}\\text{-}\\mathrm{O}} = R_{\\mathrm{ref},\\mathrm{A}} + b \\ln\\!\\left(s_{\\mathrm{ref},\\mathrm{A}}\\right)$ so that Brown’s formula reproduces $s_{\\mathrm{ref},\\mathrm{A}}$ at $R_{\\mathrm{ref},\\mathrm{A}}$.\n  - Compute the A-site bond valence sum under the enforced $R_{\\mathrm{A}\\text{-}\\mathrm{O}}$ as $S_{\\mathrm{A}} = 12 \\exp\\!\\left((R_{0,\\mathrm{A}\\text{-}\\mathrm{O}} - R_{\\mathrm{A}\\text{-}\\mathrm{O}})/b\\right)$ and define $D_{\\mathrm{BV}} = \\left|S_{\\mathrm{A}} - V_{\\mathrm{A}}\\right|$.\n- All distances must be treated in Å. The final reported accuracies are unitless decimals.\n\nTest suite and output specification:\n\n- Apply leave-one-out cross-validation exactly as specified above on the provided dataset for each of the three descriptors separately.\n- Your program should produce a single line of output containing the three LOOCV accuracies in the order $\\left[t,\\ t',\\ D_{\\mathrm{BV}}\\right]$, rounded to three decimal places, as a comma-separated list enclosed in square brackets, for example $\\left[0.917,0.917,0.833\\right]$ if those were the results.\n\nYour program must be self-contained, require no input, and follow the exact output format.", "solution": "The problem presented is a well-defined task in computational materials chemistry, requiring the implementation and benchmarking of three distinct scalar descriptors for perovskite stability. The problem is scientifically grounded in established principles of crystal chemistry—specifically, the hard-sphere model for ionic packing and the bond valence model for chemical bonding. It is algorithmically rigorous, providing a complete set of data, constants, and a detailed procedure for leave-one-out cross-validation (LOOCV), including unambiguous tie-breaking rules. Therefore, the problem is deemed valid and a full solution shall be provided.\n\nThe solution is structured as follows: First, we derive the mathematical expressions for the three descriptors ($t$, $t'$, and $D_{\\mathrm{BV}}$) from the first principles given. Second, we formalize the LOOCV benchmarking procedure, including the method for determining the optimal classification threshold.\n\n### Derivation of Descriptors\n\nThe geometry of an ideal cubic perovskite $\\text{ABO}_3$ provides the foundation. In a cube with lattice parameter $a$, the B-cation at the body center and O-anions at the face centers form a network of corner-sharing octahedra. The A-cation resides at the cube corners, coordinated by $12$ oxygen anions.\n\nThe bond lengths are geometrically constrained:\n-   The B-O bond length, connecting the body center to a face center, is $R_{\\mathrm{B}\\text{-}\\mathrm{O}} = a/2$.\n-   The A-O bond length, connecting a corner to an adjacent face center, is $R_{\\mathrm{A}\\text{-}\\mathrm{O}} = a/\\sqrt{2}$.\n\nFrom these relationships, we derive the descriptors.\n\n**1. Descriptor $t$ (Goldschmidt-type Tolerance Factor)**\n\nThis descriptor is a geometric packing ratio. We assume hard-sphere contact for both A-O and B-O bonds. The B-O octahedra are assumed to define the lattice parameter $a$.\nIdeal B-O contact implies $R_{\\mathrm{B}\\text{-}\\mathrm{O}} = r_{\\mathrm{B}}^{(\\mathrm{VI})} + r_{\\mathrm{O}}$, where $r_{\\mathrm{B}}^{(\\mathrm{VI})}$ is the ionic radius of the B-cation in $6$-fold coordination and $r_{\\mathrm{O}}$ is the oxygen anion radius.\nFrom this, the lattice parameter is $a = 2 R_{\\mathrm{B}\\text{-}\\mathrm{O}} = 2(r_{\\mathrm{B}}^{(\\mathrm{VI})} + r_{\\mathrm{O}})$.\n\nThe space available for the A-O bond is geometrically fixed at $R_{\\mathrm{A}\\text{-}\\mathrm{O, geom}} = a/\\sqrt{2}$. Substituting the expression for $a$:\n$$R_{\\mathrm{A}\\text{-}\\mathrm{O, geom}} = \\frac{2(r_{\\mathrm{B}}^{(\\mathrm{VI})} + r_{\\mathrm{O}})}{\\sqrt{2}} = \\sqrt{2}(r_{\\mathrm{B}}^{(\\mathrm{VI})} + r_{\\mathrm{O}})$$\n\nThe ideal A-O bond length, assuming hard-sphere contact, is $R_{\\mathrm{A}\\text{-}\\mathrm{O, ideal}} = r_{\\mathrm{A}}^{(\\mathrm{XII})} + r_{\\mathrm{O}}$, where $r_{\\mathrm{A}}^{(\\mathrm{XII})}$ is the radius for the A-cation in $12$-fold coordination.\n\nThe tolerance factor $t$ is the ratio of the ideal A-O length to the geometric space available for it:\n$$t = \\frac{R_{\\mathrm{A}\\text{-}\\mathrm{O, ideal}}}{R_{\\mathrm{A}\\text{-}\\mathrm{O, geom}}} = \\frac{r_{\\mathrm{A}}^{(\\mathrm{XII})} + r_{\\mathrm{O}}}{\\sqrt{2}(r_{\\mathrm{B}}^{(\\mathrm{VI})} + r_{\\mathrm{O}})}$$\nThe problem specifies using a single anion radius, which, given the context, is logically the radius for the coordinating octahedra, $r_{\\mathrm{O}} = r_{\\mathrm{O}}^{(\\mathrm{VI})} = 1.40\\,$Å.\n$$t = \\frac{r_{\\mathrm{A}}^{(\\mathrm{XII})} + r_{\\mathrm{O}}^{(\\mathrm{VI})}}{\\sqrt{2}(r_{\\mathrm{B}}^{(\\mathrm{VI})} + r_{\\mathrm{O}}^{(\\mathrm{VI})})}$$\n\n**2. Descriptor $t'$ (Coordination-Corrected Tolerance Factor)**\n\nThis descriptor is a refinement of $t$ that accounts for the different coordination environments of the anion.\n-   For the B-O bond (B is $6$-coordinate), we use $r_{\\mathrm{O}}^{(\\mathrm{VI})} = 1.40\\,$Å.\n-   For the A-O bond (A is $12$-coordinate), we use $r_{\\mathrm{O}}^{(\\mathrm{XII})} = 1.44\\,$Å.\n\nThe lattice parameter is still set by the B-O framework: $a = 2(r_{\\mathrm{B}}^{(\\mathrm{VI})} + r_{\\mathrm{O}}^{(\\mathrm{VI})})$.\nThe geometric A-O distance remains $R_{\\mathrm{A}\\text{-}\\mathrm{O, geom}} = \\sqrt{2}(r_{\\mathrm{B}}^{(\\mathrm{VI})} + r_{\\mathrm{O}}^{(\\mathrm{VI})})$.\nThe ideal A-O bond length, however, now uses the coordination-specific anion radius: $R_{\\mathrm{A}\\text{-}\\mathrm{O, ideal}}' = r_{\\mathrm{A}}^{(\\mathrm{XII})} + r_{\\mathrm{O}}^{(\\mathrm{XII})}$.\n\nThe descriptor $t'$ is then:\n$$t' = \\frac{R_{\\mathrm{A}\\text{-}\\mathrm{O, ideal}}'}{R_{\\mathrm{A}\\text{-}\\mathrm{O, geom}}} = \\frac{r_{\\mathrm{A}}^{(\\mathrm{XII})} + r_{\\mathrm{O}}^{(\\mathrm{XII})}}{\\sqrt{2}(r_{\\mathrm{B}}^{(\\mathrm{VI})} + r_{\\mathrm{O}}^{(\\mathrm{VI})})}$$\n\n**3. Descriptor $D_{\\mathrm{BV}}$ (Bond-Valence Mismatch)**\n\nThis descriptor quantifies the strain on the A-site cation from a bond-valence perspective.\nFirst, we establish the enforced A-O bond length, $R_{\\mathrm{A}\\text{-}\\mathrm{O}}$, from the rigid octahedral framework assumption.\n$$R_{\\mathrm{B}\\text{-}\\mathrm{O}} = r_{\\mathrm{B}}^{(\\mathrm{VI})} + r_{\\mathrm{O}}^{(\\mathrm{VI})}$$\n$$R_{\\mathrm{A}\\text{-}\\mathrm{O}} = \\sqrt{2}\\,R_{\\mathrm{B}\\text{-}\\mathrm{O}} = \\sqrt{2}(r_{\\mathrm{B}}^{(\\mathrm{VI})} + r_{\\mathrm{O}}^{(\\mathrm{VI})})$$\n\nNext, we use Brown's bond valence model, $s = \\exp((R_0 - R)/b)$, where $s$ is the valence of a bond of length $R$. The parameters $R_0$ and $b$ are empirical. $b$ is given as $0.37\\,$Å. We must calibrate $R_{0,\\mathrm{A}\\text{-}\\mathrm{O}}$ for the A-O pair.\nCalibration is performed in a hypothetical, ideal reference environment for the A-cation: $12$-fold coordination. Here, the bond valence is equally distributed, $s_{\\mathrm{ref},\\mathrm{A}} = V_{\\mathrm{A}}/12$, where $V_{\\mathrm{A}}$ is the formal oxidation state. The reference bond length is the sum of ionic radii, $R_{\\mathrm{ref},\\mathrm{A}} = r_{\\mathrm{A}}^{(\\mathrm{XII})} + r_{\\mathrm{O}}^{(\\mathrm{XII})}$.\nWe require that at this reference length, the formula yields the reference valence:\n$$s_{\\mathrm{ref},\\mathrm{A}} = \\exp\\left(\\frac{R_{0,\\mathrm{A}\\text{-}\\mathrm{O}} - R_{\\mathrm{ref},\\mathrm{A}}}{b}\\right)$$\nSolving for $R_{0,\\mathrm{A}\\text{-}\\mathrm{O}}$:\n$$R_{0,\\mathrm{A}\\text{-}\\mathrm{O}} = R_{\\mathrm{ref},\\mathrm{A}} + b \\ln(s_{\\mathrm{ref},\\mathrm{A}}) = (r_{\\mathrm{A}}^{(\\mathrm{XII})} + r_{\\mathrm{O}}^{(\\mathrm{XII})}) + b \\ln(V_{\\mathrm{A}}/12)$$\n\nWith the calibrated $R_{0,\\mathrm{A}\\text{-}\\mathrm{O}}$ and the enforced distance $R_{\\mathrm{A}\\text{-}\\mathrm{O}}$, we compute the bond valence sum at the A-site. In the ideal cubic cell, all $12$ A-O bonds are equivalent.\n$$S_{\\mathrm{A}} = \\sum_{i=1}^{12} s_i = 12 \\exp\\left(\\frac{R_{0,\\mathrm{A}\\text{-}\\mathrm{O}} - R_{\\mathrm{A}\\text{-}\\mathrm{O}}}{b}\\right)$$\nSubstituting the expressions for $R_{0,\\mathrm{A}\\text{-}\\mathrm{O}}$ and $R_{\\mathrm{A}\\text{-}\\mathrm{O}}$:\n$$S_{\\mathrm{A}} = 12 \\exp\\left( \\frac{ [(r_{\\mathrm{A}}^{(\\mathrm{XII})} + r_{\\mathrm{O}}^{(\\mathrm{XII})}) + b \\ln(V_{\\mathrm{A}}/12)] - [\\sqrt{2}(r_{\\mathrm{B}}^{(\\mathrm{VI})} + r_{\\mathrm{O}}^{(\\mathrm{VI})})] }{b} \\right)$$\n$$S_{\\mathrm{A}} = 12 \\cdot \\exp(\\ln(V_{\\mathrm{A}}/12)) \\cdot \\exp\\left( \\frac{(r_{\\mathrm{A}}^{(\\mathrm{XII})} + r_{\\mathrm{O}}^{(\\mathrm{XII})}) - \\sqrt{2}(r_{\\mathrm{B}}^{(\\mathrm{VI})} + r_{\\mathrm{O}}^{(\\mathrm{VI})})}{b} \\right)$$\n$$S_{\\mathrm{A}} = V_{\\mathrm{A}} \\exp\\left( \\frac{(r_{\\mathrm{A}}^{(\\mathrm{XII})} + r_{\\mathrm{O}}^{(\\mathrm{XII})}) - \\sqrt{2}(r_{\\mathrm{B}}^{(\\mathrm{VI})} + r_{\\mathrm{O}}^{(\\mathrm{VI})})}{b} \\right)$$\n\nThe descriptor $D_{\\mathrm{BV}}$ is the magnitude of the deviation of this sum from the expected formal valence $V_{\\mathrm{A}}$:\n$$D_{\\mathrm{BV}} = |S_{\\mathrm{A}} - V_{\\mathrm{A}}|$$\n\n### Benchmarking via Leave-One-Out Cross-Validation (LOOCV)\n\nThe classification performance of each descriptor is assessed using LOOCV on the provided dataset of $N=12$ compounds. For each of the $N$ folds:\n1.  One compound is held out as the test set; the remaining $N-1$ compounds form the training set.\n2.  For each descriptor ($t$, $t'$, $D_{\\mathrm{BV}}$) independently, an optimal 1D classifier is trained on the training set.\n3.  The classifier consists of a threshold $\\theta$ and a polarity $p$, where $p$ determines whether values below or above $\\theta$ are classified as perovskite (label $1$).\n4.  To find the optimal $(\\theta, p)$, we test a set of candidate thresholds. These are the midpoints between adjacent unique descriptor values in the sorted training set, plus two sentinel thresholds, one below the minimum value and one above the maximum.\n5.  For each candidate $\\theta$, both polarities ($p \\in \\{\\text{predict } 1 \\text{ if } x \\le \\theta, \\text{predict } 1 \\text{ if } x \\ge \\theta\\}$) are evaluated. The combination $(\\theta, p)$ that maximizes classification accuracy on the training set is chosen.\n6.  Ties are broken systematically:\n    a.  Select the candidate(s) with the highest accuracy.\n    b.  From these, select the one(s) with the smallest threshold value $\\theta$.\n    c.  From these, select the one(s) with the largest true positive rate (TPR) on the training set.\n    d.  If a tie persists, the polarity \"predict perovskite if $x \\le \\theta$\" is chosen.\n7.  The optimal classifier $(\\theta, p)$ is then used to predict the class of the held-out test compound.\n8.  The LOOCV accuracy for each descriptor is the total number of correct predictions across all $N$ folds, divided by $N$.\n\nThis procedure ensures a deterministic and reproducible evaluation of each descriptor's predictive power. The following program implements these derivations and the specified validation protocol.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Implements the full validation and benchmarking of three perovskite stability descriptors.\n    \"\"\"\n\n    # --- Constants ---\n    R_O_VI = 1.40  # Oxygen radius in 6-fold coordination (Angstrom)\n    R_O_XII = 1.44 # Oxygen radius in 12-fold coordination (Angstrom)\n    B_BVM = 0.37   # Brown's softening parameter (Angstrom)\n    SQRT2 = np.sqrt(2)\n\n    # --- Dataset ---\n    # (name, r_A(XII), V_A, r_B(VI), V_B, label)\n    # label=1: perovskite, label=0: non-perovskite\n    dataset = [\n        ('SrTiO3', 1.44, 2, 0.605, 4, 1),\n        ('BaTiO3', 1.61, 2, 0.605, 4, 1),\n        ('CaTiO3', 1.34, 2, 0.605, 4, 1),\n        ('LaAlO3', 1.36, 3, 0.535, 3, 1),\n        ('KNbO3', 1.64, 1, 0.64, 5, 1),\n        ('NaNbO3', 1.39, 1, 0.64, 5, 1),\n        ('CaZrO3', 1.34, 2, 0.72, 4, 1),\n        ('LiNbO3', 1.18, 1, 0.64, 5, 0),\n        ('LiTaO3', 1.18, 1, 0.64, 5, 0),\n        ('YMnO3', 1.28, 3, 0.645, 3, 0),\n        ('ScFeO3', 1.16, 3, 0.645, 3, 0),\n        ('LuFeO3', 1.17, 3, 0.645, 3, 0),\n    ]\n\n    # --- Descriptor Calculation Functions ---\n\n    def calculate_t(r_A_XII, V_A, r_B_VI, V_B):\n        # t = (r_A_XII + r_O_VI) / (sqrt(2) * (r_B_VI + r_O_VI))\n        num = r_A_XII + R_O_VI\n        den = SQRT2 * (r_B_VI + R_O_VI)\n        return num / den\n\n    def calculate_t_prime(r_A_XII, V_A, r_B_VI, V_B):\n        # t' = (r_A_XII + r_O_XII) / (sqrt(2) * (r_B_VI + r_O_VI))\n        num = r_A_XII + R_O_XII\n        den = SQRT2 * (r_B_VI + R_O_VI)\n        return num / den\n\n    def calculate_d_bv(r_A_XII, V_A, r_B_VI, V_B):\n        # S_A = V_A * exp(((r_A_XII + r_O_XII) - sqrt(2)*(r_B_VI + r_O_VI)) / b)\n        # D_BV = |S_A - V_A|\n        exponent_num = (r_A_XII + R_O_XII) - SQRT2 * (r_B_VI + R_O_VI)\n        S_A = V_A * np.exp(exponent_num / B_BVM)\n        return np.abs(S_A - V_A)\n    \n    descriptor_funcs = [calculate_t, calculate_t_prime, calculate_d_bv]\n    num_samples = len(dataset)\n    \n    # Pre-calculate all descriptors for the full dataset\n    all_labels = np.array([d[5] for d in dataset])\n    all_descriptors = []\n    for func in descriptor_funcs:\n        values = np.array([func(d[1], d[2], d[3], d[4]) for d in dataset])\n        all_descriptors.append(values)\n\n    loocv_accuracies = []\n\n    # --- Benchmarking Logic ---\n    \n    def train_classifier(train_x, train_y):\n        sorted_unique_x = sorted(list(set(train_x)))\n        \n        # Generate candidate thresholds\n        thresholds = []\n        if len(sorted_unique_x) > 0:\n            thresholds.append(sorted_unique_x[0] - 1.0) # Sentinel min\n            thresholds.append(sorted_unique_x[-1] + 1.0) # Sentinel max\n        if len(sorted_unique_x) > 1:\n            for i in range(len(sorted_unique_x) - 1):\n                thresholds.append((sorted_unique_x[i] + sorted_unique_x[i+1]) / 2.0)\n        \n        num_positives_in_train = np.sum(train_y)\n        \n        candidates = []\n        for theta in thresholds:\n            # Polarity p=0 (predict 1 if x <= theta)\n            preds_p0 = (train_x <= theta).astype(int)\n            acc_p0 = np.mean(preds_p0 == train_y)\n            tp_p0 = np.sum((preds_p0 == 1) & (train_y == 1))\n            tpr_p0 = tp_p0 / num_positives_in_train if num_positives_in_train > 0 else 0\n            candidates.append({'acc': acc_p0, 'theta': theta, 'tpr': tpr_p0, 'pol': 0})\n            \n            # Polarity p=1 (predict 1 if x >= theta)\n            preds_p1 = (train_x >= theta).astype(int)\n            acc_p1 = np.mean(preds_p1 == train_y)\n            tp_p1 = np.sum((preds_p1 == 1) & (train_y == 1))\n            tpr_p1 = tp_p1 / num_positives_in_train if num_positives_in_train > 0 else 0\n            candidates.append({'acc': acc_p1, 'theta': theta, 'tpr': tpr_p1, 'pol': 1})\n\n        # Apply tie-breaking rules by sorting\n        # 1. Higher accuracy (-acc)\n        # 2. Smaller threshold (theta)\n        # 3. Higher TPR (-tpr)\n        # 4. Polarity 'predict if <= theta' (pol=0)\n        best = sorted(candidates, key=lambda c: (-c['acc'], c['theta'], -c['tpr'], c['pol']))[0]\n        \n        return best['theta'], best['pol']\n\n    def predict(x, theta, polarity):\n        if polarity == 0: # predict 1 if x <= theta\n            return 1 if x <= theta else 0\n        else: # polarity == 1, predict 1 if x >= theta\n            return 1 if x >= theta else 0\n\n    # Main LOOCV loop\n    for descriptor_values in all_descriptors:\n        correct_predictions = 0\n        for i in range(num_samples):\n            # Split data for LOOCV\n            train_mask = np.ones(num_samples, dtype=bool)\n            train_mask[i] = False\n            \n            train_x = descriptor_values[train_mask]\n            train_y = all_labels[train_mask]\n            \n            test_x = descriptor_values[i]\n            test_y = all_labels[i]\n            \n            # Train and predict\n            theta, polarity = train_classifier(train_x, train_y)\n            prediction = predict(test_x, theta, polarity)\n            \n            if prediction == test_y:\n                correct_predictions += 1\n        \n        accuracy = correct_predictions / num_samples\n        loocv_accuracies.append(accuracy)\n\n    # Format and print the final result\n    formatted_accuracies = [f\"{acc:.3f}\" for acc in loocv_accuracies]\n    print(f\"[{','.join(formatted_accuracies)}]\")\n\nsolve()\n```", "id": "2506478"}]}