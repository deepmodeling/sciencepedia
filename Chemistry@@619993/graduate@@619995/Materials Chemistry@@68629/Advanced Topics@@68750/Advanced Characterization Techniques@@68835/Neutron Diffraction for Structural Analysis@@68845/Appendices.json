{"hands_on_practices": [{"introduction": "A foundational question in any diffraction experiment is predicting the scattering angles at which constructive interference occurs. This exercise guides you through deriving Bragg's Law from the more fundamental Laue condition, which equates the scattering vector to a reciprocal lattice vector. By applying this to a simple cubic crystal, you will connect the neutron's wavelength, $\\lambda$, and the crystal's lattice parameter, $a$, to the observable positions of Bragg peaks, $2\\theta$, building a solid theoretical basis for interpreting diffraction patterns [@problem_id:2503080].", "problem": "A monochromatic neutron beam of wavelength $\\lambda = 1.5\\,\\mathrm{\\AA}$ is incident on a primitive cubic crystal with lattice parameter $a = 4.00\\,\\mathrm{\\AA}$. Under elastic kinematic scattering, diffraction occurs when the scattering vector equals a reciprocal lattice vector of the crystal. Starting from the wave nature of neutrons, the definition of the wavevector magnitude $k$ in terms of $\\lambda$, the elastic diffraction condition relating the incident and scattered wavevectors to a reciprocal lattice vector, and the definition of interplanar spacings in a cubic lattice, derive the relationship between the scattering angle and the interplanar spacing for a set of Miller indices $(hkl)$. Then use it to compute the diffraction $2\\theta$ positions, in degrees, for the $(110)$ and $(200)$ reflections of this primitive cubic crystal, assuming first-order diffraction and neglecting refraction and multiple scattering. Round each angle to four significant figures. Provide your final result as a single row listing the two $2\\theta$ values in the order $(110)$, $(200)$.", "solution": "The problem statement is subjected to validation before any attempt at a solution.\n\nGivens extracted from the statement:\n- Neutron beam wavelength: $\\lambda = 1.5\\,\\mathrm{\\AA}$.\n- Crystal structure: primitive cubic.\n- Lattice parameter: $a = 4.00\\,\\mathrm{\\AA}$.\n- Scattering condition: elastic kinematic scattering.\n- Diffraction condition: The scattering vector $\\vec{Q}$ equals a reciprocal lattice vector $\\vec{G}_{hkl}$.\n- Definition of wavevector magnitude: $k$ in terms of $\\lambda$.\n- Elastic condition: relation between incident wavevector $\\vec{k}_i$ and scattered wavevector $\\vec{k}_f$.\n- Definition of interplanar spacing $d_{hkl}$ for a cubic lattice.\n- Task: Derive the relationship between scattering angle $2\\theta$ and interplanar spacing $d_{hkl}$.\n- Task: Compute $2\\theta$ for $(110)$ and $(200)$ reflections.\n- Assumption: First-order diffraction ($n=1$).\n- Approximation: Round final angles to four significant figures.\n\nValidation:\nThe problem is scientifically grounded, describing the well-established phenomenon of neutron diffraction by a crystal lattice. The physical quantities provided ($\\lambda=1.5\\,\\mathrm{\\AA}$, $a=4.00\\,\\mathrm{\\AA}$) are realistic for such experiments. The problem is well-posed, providing all necessary information and clear objectives for a unique solution. The language is objective and unambiguous. The problem does not violate any of the criteria for invalidity. It is a standard, solvable problem in solid-state physics.\n\nVerdict: The problem is valid. The solution will now be derived.\n\nThe wave nature of a neutron allows it to be described by a wavevector $\\vec{k}$. The magnitude of the wavevector, $k$, is related to the de Broglie wavelength $\\lambda$ by the relation:\n$$k = \\frac{2\\pi}{\\lambda}$$\nIn elastic scattering, the kinetic energy of the neutron is conserved. Consequently, the magnitude of its momentum, and thus the magnitude of its wavevector, remains unchanged. If $\\vec{k}_i$ is the incident wavevector and $\\vec{k}_f$ is the scattered wavevector, then:\n$$|\\vec{k}_i| = |\\vec{k}_f| = k$$\nDiffraction occurs when the scattering vector, defined as the change in the wavevector $\\vec{Q} = \\vec{k}_f - \\vec{k}_i$, is equal to a vector of the reciprocal lattice, $\\vec{G}_{hkl}$.\n$$\\vec{k}_f - \\vec{k}_i = \\vec{G}_{hkl}$$\nThis is the Laue condition for diffraction. The subscript $hkl$ denotes the Miller indices of the corresponding crystal planes. To derive the relationship involving the scattering angle, we can manipulate this vector equation. Rearranging, we get $\\vec{k}_f = \\vec{k}_i + \\vec{G}_{hkl}$. We take the squared magnitude of both sides:\n$$|\\vec{k}_f|^2 = |\\vec{k}_i + \\vec{G}_{hkl}|^2 = (\\vec{k}_i + \\vec{G}_{hkl}}) \\cdot (\\vec{k}_i + \\vec{G}_{hkl}})$$\n$$|\\vec{k}_f|^2 = |\\vec{k}_i|^2 + |\\vec{G}_{hkl}|^2 + 2\\vec{k}_i \\cdot \\vec{G}_{hkl}$$\nUsing the elastic scattering condition $|\\vec{k}_i|^2 = |\\vec{k}_f|^2$, this simplifies to:\n$$0 = |\\vec{G}_{hkl}|^2 + 2\\vec{k}_i \\cdot \\vec{G}_{hkl}$$\nAn alternative, and more direct, derivation involves squaring the Laue condition itself:\n$$|\\vec{G}_{hkl}|^2 = |\\vec{k}_f - \\vec{k}_i|^2 = (\\vec{k}_f - \\vec{k}_i) \\cdot (\\vec{k}_f - \\vec{k}_i)$$\n$$|\\vec{G}_{hkl}|^2 = |\\vec{k}_f|^2 + |\\vec{k}_i|^2 - 2\\vec{k}_f \\cdot \\vec{k}_i$$\nUsing $|\\vec{k}_i|=|\\vec{k}_f|=k$ and the definition of the dot product $\\vec{k}_f \\cdot \\vec{k}_i = |\\vec{k}_f||\\vec{k}_i|\\cos(2\\theta) = k^2\\cos(2\\theta)$, where $2\\theta$ is the angle between the incident and scattered beams (the total scattering angle):\n$$|\\vec{G}_{hkl}|^2 = k^2 + k^2 - 2k^2\\cos(2\\theta) = 2k^2(1 - \\cos(2\\theta))$$\nApplying the trigonometric identity $1 - \\cos(2\\theta) = 2\\sin^2(\\theta)$:\n$$|\\vec{G}_{hkl}|^2 = 2k^2(2\\sin^2(\\theta)) = 4k^2\\sin^2(\\theta)$$\nTaking the square root of both sides (and noting that $k$ and $\\sin(\\theta)$ are non-negative for physical diffraction) gives:\n$$|\\vec{G}_{hkl}| = 2k\\sin(\\theta)$$\nThis equation relates the magnitudes of the reciprocal lattice vector and the wavevector to the scattering angle $\\theta$.\n\nNow, we introduce the specific properties of the crystal lattice. The magnitude of a reciprocal lattice vector $\\vec{G}_{hkl}$ is related to the interplanar spacing $d_{hkl}$ of the corresponding $(hkl)$ planes by:\n$$|\\vec{G}_{hkl}| = \\frac{2\\pi}{d_{hkl}}$$\nSubstituting this and $k = \\frac{2\\pi}{\\lambda}$ into the derived relation $|\\vec{G}_{hkl}| = 2k\\sin(\\theta)$:\n$$\\frac{2\\pi}{d_{hkl}} = 2\\left(\\frac{2\\pi}{\\lambda}\\right)\\sin(\\theta)$$\nCanceling the common factor of $2\\pi$ and rearranging gives the required relationship, which is Bragg's Law for first-order diffraction:\n$$2d_{hkl}\\sin(\\theta) = \\lambda$$\nFor a cubic crystal system with lattice parameter $a$, the interplanar spacing $d_{hkl}$ for a plane with Miller indices $(hkl)$ is given by:\n$$d_{hkl} = \\frac{a}{\\sqrt{h^2+k^2+l^2}}$$\nSubstituting this into Bragg's Law yields:\n$$2\\left(\\frac{a}{\\sqrt{h^2+k^2+l^2}}\\right)\\sin(\\theta) = \\lambda$$\nWe can solve for the scattering angle $2\\theta$:\n$$\\sin(\\theta) = \\frac{\\lambda\\sqrt{h^2+k^2+l^2}}{2a}$$\n$$2\\theta = 2\\arcsin\\left(\\frac{\\lambda\\sqrt{h^2+k^2+l^2}}{2a}\\right)$$\nWe are given $\\lambda = 1.5\\,\\mathrm{\\AA}$ and $a = 4.00\\,\\mathrm{\\AA}$.\n\nFor the $(110)$ reflection:\n$h=1$, $k=1$, $l=0$. Thus, $\\sqrt{h^2+k^2+l^2} = \\sqrt{1^2+1^2+0^2} = \\sqrt{2}$.\n$$2\\theta_{110} = 2\\arcsin\\left(\\frac{(1.5)\\sqrt{2}}{2(4.00)}\\right) = 2\\arcsin\\left(\\frac{1.5\\sqrt{2}}{8}\\right)$$\n$$2\\theta_{110} \\approx 2\\arcsin(0.265165...) = 2(15.378...^\\circ) \\approx 30.756...^\\circ$$\nRounding to four significant figures, $2\\theta_{110} = 30.76^\\circ$.\n\nFor the $(200)$ reflection:\n$h=2$, $k=0$, $l=0$. Thus, $\\sqrt{h^2+k^2+l^2} = \\sqrt{2^2+0^2+0^2} = \\sqrt{4} = 2$.\n$$2\\theta_{200} = 2\\arcsin\\left(\\frac{(1.5)(2)}{2(4.00)}\\right) = 2\\arcsin\\left(\\frac{3}{8}\\right) = 2\\arcsin(0.375)$$\n$$2\\theta_{200} \\approx 2\\arcsin(0.375) = 2(22.024...^\\circ) \\approx 44.048...^\\circ$$\nRounding to four significant figures, $2\\theta_{200} = 44.05^\\circ$.\n\nThe computed diffraction angles for the $(110)$ and $(200)$ reflections are $30.76^\\circ$ and $44.05^\\circ$, respectively.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n30.76 & 44.05\n\\end{pmatrix}\n}\n$$", "id": "2503080"}, {"introduction": "While Bragg's Law tells us where peaks can appear, the crystal structure itself dictates their intensities. This practice explores the concept of the nuclear structure factor, $F_{N}(h,k,l)$, which sums the scattering contributions from all atoms within the unit cell, accounting for their positions and unique neutron scattering lengths. By deriving a single expression for the rock-salt structure that encodes both systematic absences from the lattice type and intensity modulations from the basis, you will master the key to understanding why some reflections are strong, weak, or forbidden entirely [@problem_id:2503026].", "problem": "A binary ionic solid in the rock-salt structure has a face-centered cubic Bravais lattice with a two-atom basis. Consider sodium chloride (NaCl) with the basis atoms located at fractional coordinates $\\left(0,0,0\\right)$ for $\\text{Na}$ and $\\left(\\tfrac{1}{2},\\tfrac{1}{2},\\tfrac{1}{2}\\right)$ for $\\text{Cl}$ with respect to the conventional cubic cell. Assume coherent nuclear scattering only, no magnetic scattering, negligible Debye–Waller factors (temperature factor equal to $1$), and no isotopic or occupational disorder. The coherent nuclear scattering lengths are $b_{\\text{Na}}=3.63\\,\\text{fm}$ and $b_{\\text{Cl}}=9.577\\,\\text{fm}$.\n\nStarting from the fundamental definition of the coherent nuclear structure factor in neutron diffraction (ND), derive a single, closed-form analytic expression $F_{N}(h,k,l)$ as a function of Miller indices $h,k,l$ that simultaneously:\n- Encodes all systematic absences implied by the face-centered cubic Bravais lattice, and\n- Captures the basis-interference parity dependence on $h+k+l$ arising from the two-atom basis.\n\nYour final expression must be written purely in terms of $h,k,l$, integer parity functions, and the given numerical values $b_{\\text{Na}}$ and $b_{\\text{Cl}}$. Express $F_{N}$ in femtometers. Do not list conditions separately; instead, encode the systematic absences directly within a single algebraic expression of $h,k,l$. The final answer must be a single closed-form expression (no inequalities) and must not include units inside the final boxed result.", "solution": "The problem statement is critically validated and found to be scientifically sound, well-posed, objective, and self-contained. It presents a standard theoretical problem in solid-state physics and crystallography without any factual errors, internal contradictions, or ambiguities. All necessary data are provided. Thus, a solution will be provided.\n\nThe coherent nuclear structure factor, $F_{N}$, for a crystal structure is defined by summing the scattering contributions from all atoms within a unit cell, taking into account their respective scattering lengths and phase factors determined by their positions. For a reflection indexed by Miller indices $(h,k,l)$, the structure factor is given by:\n$$F_{N}(h,k,l) = \\sum_{j} b_j e^{i 2\\pi (h x_j + k y_j + l z_j)}$$\nwhere the sum is over all atoms $j$ in the conventional unit cell, $b_j$ is the coherent nuclear scattering length of atom $j$, and $(x_j, y_j, z_j)$ are its fractional coordinates within the cell.\n\nThe problem specifies a rock-salt structure, which has a face-centered cubic (FCC) Bravais lattice and a two-atom basis. The atomic positions within the entire conventional cell can be generated by taking the four lattice point positions of the FCC cell and adding the basis atom vectors to each. This allows the total structure factor to be expressed as the product of a lattice factor, $S_{\\text{lattice}}$, and a basis structure factor, $F_{\\text{basis}}$:\n$$F_{N}(h,k,l) = S_{\\text{lattice}}(h,k,l) \\times F_{\\text{basis}}(h,k,l)$$\n\nFirst, we derive the basis structure factor, $F_{\\text{basis}}$. The basis consists of a sodium atom (Na) at $\\mathbf{r}_{\\text{Na}} = (0,0,0)$ and a chlorine atom (Cl) at $\\mathbf{r}_{\\text{Cl}} = (\\frac{1}{2},\\frac{1}{2},\\frac{1}{2})$. With their respective scattering lengths $b_{\\text{Na}}$ and $b_{\\text{Cl}}$, the basis structure factor is:\n$$F_{\\text{basis}}(h,k,l) = b_{\\text{Na}} e^{i 2\\pi (h \\cdot 0 + k \\cdot 0 + l \\cdot 0)} + b_{\\text{Cl}} e^{i 2\\pi (h \\cdot \\frac{1}{2} + k \\cdot \\frac{1}{2} + l \\cdot \\frac{1}{2})}$$\n$$F_{\\text{basis}}(h,k,l) = b_{\\text{Na}} + b_{\\text{Cl}} e^{i \\pi (h+k+l)}$$\nSince $h, k, l$ are integers, their sum $(h+k+l)$ is an integer. Using the identity $e^{i\\pi n} = (-1)^{n}$ for integer $n$, we can write:\n$$F_{\\text{basis}}(h,k,l) = b_{\\text{Na}} + b_{\\text{Cl}} (-1)^{h+k+l}$$\nThis expression correctly captures the interference between the Na and Cl sublattices, which depends on the parity of the sum of the Miller indices.\n\nNext, we derive the lattice factor, $S_{\\text{lattice}}$, for the FCC Bravais lattice. The conventional FCC cell contains four lattice points at fractional coordinates $(0,0,0)$, $(\\frac{1}{2},\\frac{1}{2},0)$, $(\\frac{1}{2},0,\\frac{1}{2})$, and $(0,\\frac{1}{2},\\frac{1}{2})$. The lattice factor is the sum of the phase factors for these points:\n$$S_{\\text{lattice}}(h,k,l) = e^{i 2\\pi (0)} + e^{i 2\\pi (\\frac{h}{2}+\\frac{k}{2})} + e^{i 2\\pi (\\frac{h}{2}+\\frac{l}{2})} + e^{i 2\\pi (\\frac{k}{2}+\\frac{l}{2})}$$\nThis simplifies to:\n$$S_{\\text{lattice}}(h,k,l) = 1 + e^{i \\pi (h+k)} + e^{i \\pi (h+l)} + e^{i \\pi (k+l)}$$\nAgain, using $e^{i\\pi n} = (-1)^{n}$, we have:\n$$S_{\\text{lattice}}(h,k,l) = 1 + (-1)^{h+k} + (-1)^{h+l} + (-1)^{k+l}$$\nThis factor encodes the systematic absences for the FCC lattice. It evaluates to $4$ if the indices $h, k, l$ are all even or all odd (unmixed parity), and to $0$ if they have mixed parity. The condition $S_{\\text{lattice}} = 0$ corresponds to a forbidden reflection.\n\nCombining the basis and lattice factors, we obtain the total nuclear structure factor for NaCl:\n$$F_{N}(h,k,l) = \\left( b_{\\text{Na}} + b_{\\text{Cl}} (-1)^{h+k+l} \\right) \\left( 1 + (-1)^{h+k} + (-1)^{h+l} + (-1)^{k+l} \\right)$$\nThis is a single, closed-form expression that fulfills all requirements of the problem. It intrinsically incorporates both the FCC selection rules and the basis interference effects as a function of the Miller indices $(h,k,l)$.\n\nFinally, we substitute the specified numerical values for the coherent nuclear scattering lengths, $b_{\\text{Na}} = 3.63\\,\\text{fm}$ and $b_{\\text{Cl}} = 9.577\\,\\text{fm}$. The resulting expression for $F_{N}$, with its value in femtometers (fm), is:\n$$F_{N}(h,k,l) = \\left( 3.63 + 9.577 (-1)^{h+k+l} \\right) \\left( 1 + (-1)^{h+k} + (-1)^{h+l} + (-1)^{k+l} \\right)$$\nThis is the required final analytical expression.", "answer": "$$\\boxed{\\left( 3.63 + 9.577 (-1)^{h+k+l} \\right) \\left( 1 + (-1)^{h+k} + (-1)^{h+l} + (-1)^{k+l} \\right)}$$", "id": "2503026"}, {"introduction": "Bragg diffraction excels at describing the long-range, average crystal structure, but many materials derive their unique properties from local deviations and nanoscale disorder. This advanced computational practice introduces total scattering and the Pair Distribution Function (PDF), $G(r)$, a powerful technique that uses the entire scattering pattern to probe real-space atomic pair correlations. By fitting a model to synthetic data, you will extract the mean bond length, $\\mu$, and its distribution width, $\\sigma$, gaining hands-on experience in quantifying the local atomic environment beyond the crystallographic average [@problem_id:2503107].", "problem": "Consider neutron total scattering from a binary rock-salt structure (space group $Fm\\bar{3}m$) with two atom types $A$ and $B$ and conventional cubic lattice parameter $a$. The first coordination shell consists of $z$ nearest neighbors of unlike type at a distance that, in the absence of strain, equals $a/2$. The fundamental definition of the pair distribution function is $G(r) = 4 \\pi r \\left[\\rho(r) - \\rho_0\\right]$, where $\\rho(r)$ is the microscopic pair density and $\\rho_0$ is the average number density. In the narrow window around the first-neighbor distance, the contribution to $G(r)$ is dominated by the distribution of $A$-$B$ bond lengths. Under the harmonic (Gaussian) approximation for nanoscale disorder, the $A$-$B$ bond-length distribution can be modeled as a Gaussian with mean $\\mu$ and standard deviation $\\sigma$, which results in a local model for $G(r)$ of the form\n$$\nG_{\\mathrm{model}}(r; S,\\mu,\\sigma,C) \\;=\\; S \\,\\frac{1}{\\sqrt{2\\pi}\\,\\sigma}\\,\\exp\\!\\left(-\\frac{(r-\\mu)^2}{2\\sigma^2}\\right) \\;+\\; C,\n$$\nwhere $S$ is an unknown scale factor (absorbing, e.g., scattering weights and constant pre-factors over the small $r$-window) and $C$ is a local baseline offset. The goal is to compute a model reduced pair distribution function, compare it with an experimental $G(r)$ in the first-shell window, and extract the nanoscale disorder parameters $(\\mu,\\sigma)$, which characterize the $A$-$B$ bond-length distribution. You must perform this extraction by nonlinear least squares over $(S,\\mu,\\sigma,C)$ with constraints $\\sigma > 0$ and with an initial guess for $\\mu$ taken from the known crystal structure as $\\mu_0 = a/2$. Assume additive, zero-mean, homoscedastic Gaussian noise on the measured $G(r)$.\n\nTasks to implement:\n- For each test case, simulate a synthetic experimental reduced pair distribution function $G_{\\mathrm{exp}}(r)$ on a specified $r$-grid by evaluating $G_{\\mathrm{model}}(r; S^\\star,\\mu^\\star,\\sigma^\\star,C^\\star)$ with given ground-truth parameters $(S^\\star,\\mu^\\star,\\sigma^\\star,C^\\star)$ and adding independent and identically distributed zero-mean Gaussian noise with known standard deviation. Use a fixed pseudorandom seed $42$ to ensure reproducibility.\n- Using only the known structure type and lattice parameter $a$ to set the initial bond-length guess $\\mu_0=a/2$, fit the model parameters $(S,\\mu,\\sigma,C)$ by nonlinear least squares in the specified $r$-window for each test case.\n- Report, for each test case, the fitted $\\mu$ and $\\sigma$ as floating-point numbers in units of Angstroms ($\\mathrm{\\AA}$), rounded to three decimal places.\n\nUse the following test suite, which covers a general case, a narrow-distribution boundary case, and a broader-distribution edge case. In all cases, assume $z=6$ nearest unlike neighbors in the rock-salt structure, but treat $S$ as an unknown nuisance parameter to be fitted, thereby decoupling the extraction of $(\\mu,\\sigma)$ from absolute intensity. The neutron coherent scattering lengths are provided for scientific realism but are not directly needed because $S$ absorbs unknown prefactors.\n\n- Test case $1$ (general “happy path”):\n  - Structure: rock-salt $A$-$B$ with $a = 5.640\\,\\mathrm{\\AA}$.\n  - Ground-truth parameters: $\\mu^\\star = 2.820\\,\\mathrm{\\AA}$ (which equals $a/2$), $\\sigma^\\star = 0.070\\,\\mathrm{\\AA}$, $C^\\star = 0.000$.\n  - Scale chosen so that the peak maximum is approximately unity: $S^\\star = \\sqrt{2\\pi}\\,\\sigma^\\star$.\n  - Noise: zero-mean Gaussian with standard deviation $0.002$.\n  - $r$-grid: from $2.000\\,\\mathrm{\\AA}$ to $3.800\\,\\mathrm{\\AA}$ inclusive with step $0.005\\,\\mathrm{\\AA}$.\n  - Scattering lengths (for context): $b_A = 3.63\\,\\mathrm{fm}$, $b_B = 9.58\\,\\mathrm{fm}$.\n\n- Test case $2$ (narrow-distribution boundary condition):\n  - Structure: rock-salt $A$-$B$ with $a = 5.640\\,\\mathrm{\\AA}$.\n  - Ground-truth parameters: $\\mu^\\star = 2.835\\,\\mathrm{\\AA}$ (a slight expansion from $a/2$), $\\sigma^\\star = 0.015\\,\\mathrm{\\AA}$, $C^\\star = 0.000$.\n  - Scale: $S^\\star = \\sqrt{2\\pi}\\,\\sigma^\\star$.\n  - Noise: zero-mean Gaussian with standard deviation $0.002$.\n  - $r$-grid: from $2.600\\,\\mathrm{\\AA}$ to $3.100\\,\\mathrm{\\AA}$ inclusive with step $0.002\\,\\mathrm{\\AA}$.\n  - Scattering lengths (for context): $b_A = 3.63\\,\\mathrm{fm}$, $b_B = 9.58\\,\\mathrm{fm}$.\n\n- Test case $3$ (broader-distribution edge case):\n  - Structure: rock-salt $A$-$B$ with $a = 4.200\\,\\mathrm{\\AA}$.\n  - Ground-truth parameters: $\\mu^\\star = 2.100\\,\\mathrm{\\AA}$ (which equals $a/2$), $\\sigma^\\star = 0.120\\,\\mathrm{\\AA}$, $C^\\star = 0.000$.\n  - Scale: $S^\\star = \\sqrt{2\\pi}\\,\\sigma^\\star$.\n  - Noise: zero-mean Gaussian with standard deviation $0.004$.\n  - $r$-grid: from $1.500\\,\\mathrm{\\AA}$ to $3.500\\,\\mathrm{\\AA}$ inclusive with step $0.005\\,\\mathrm{\\AA}$.\n  - Scattering lengths (for context): $b_A = 5.92\\,\\mathrm{fm}$, $b_B = 5.80\\,\\mathrm{fm}$.\n\nAlgorithmic and numerical requirements:\n- Define the objective for each test case as the sum of squared residuals between $G_{\\mathrm{exp}}(r)$ and $G_{\\mathrm{model}}(r; S,\\mu,\\sigma,C)$ over the given $r$-grid. Use a numerical nonlinear least-squares solver with bound constraints enforcing $\\sigma \\ge 0.005\\,\\mathrm{\\AA}$ and reasonable search intervals for the other parameters. Initialize $\\mu$ at $\\mu_0 = a/2$, $\\sigma$ at $0.050\\,\\mathrm{\\AA}$, $S$ at $\\sqrt{2\\pi}\\times 0.050\\,\\mathrm{\\AA}$, and $C$ at $0.000$.\n- Express the final reported $\\mu$ and $\\sigma$ for each case in $\\mathrm{\\AA}$, rounded to three decimal places.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order $[\\mu_1,\\sigma_1,\\mu_2,\\sigma_2,\\mu_3,\\sigma_3]$, where the subscript denotes the test case index. For example, the output format must be exactly like $[2.820,0.070,2.835,0.015,2.100,0.120]$ but with the values replaced by the fitted and rounded numbers computed by your code under the specified noise realization and fitting protocol.", "solution": "We start from the definition of the Pair Distribution Function (PDF), which in total scattering analysis is given by $G(r) = 4\\pi r \\left[\\rho(r) - \\rho_0\\right]$, where $\\rho(r)$ is the microscopic pair density and $\\rho_0$ is the average number density. For neutron scattering, pair contributions are weighted by coherent scattering lengths, but within a narrow first-shell window of $r$ the overall amplitude variations can be absorbed into an effective scale factor because the slowly varying prefactors and the $1/r$ dependence can be considered approximately constant across a small interval. This motivates a local model for the first-shell region.\n\nIn a rock-salt structure, each atom has $z=6$ nearest unlike neighbors at distance $a/2$ in the absence of strain. Thermal and static disorder broaden the bond lengths; under the harmonic approximation (consistent with the central limit theorem for small independent displacements), the distribution of $A$-$B$ separations is well approximated by a Gaussian probability density with mean $\\mu$ and standard deviation $\\sigma$. The corresponding local contribution to $G(r)$ in a small window around the first-shell peak can thus be represented as\n$$\nG_{\\mathrm{model}}(r; S,\\mu,\\sigma,C) \\;=\\; S \\,\\frac{1}{\\sqrt{2\\pi}\\,\\sigma}\\,\\exp\\!\\left(-\\frac{(r-\\mu)^2}{2\\sigma^2}\\right) \\;+\\; C.\n$$\nHere, $S$ absorbs the effective intensity scale, including factors like the coordination number $z$, average scattering lengths, the approximate $1/r$ factor evaluated near $r\\approx\\mu$, and any instrumental scale; $C$ accounts for a local baseline offset representing finite-$Q$ artifacts or imperfect background subtraction. The unknown parameters to be estimated are $(S,\\mu,\\sigma,C)$, with the nanoscale disorder of interest captured by $(\\mu,\\sigma)$.\n\nTo estimate $(\\mu,\\sigma)$ from a measured $G_{\\mathrm{exp}}(r)$ over a finite $r$-grid $\\{r_k\\}_{k=1}^N$ in the first-shell window, we pose a nonlinear least-squares problem. Let\n$$\n\\varepsilon_k(S,\\mu,\\sigma,C) \\;=\\; G_{\\mathrm{exp}}(r_k) \\;-\\; G_{\\mathrm{model}}(r_k; S,\\mu,\\sigma,C),\n$$\nand consider the objective\n$$\n\\Phi(S,\\mu,\\sigma,C) \\;=\\; \\sum_{k=1}^N \\varepsilon_k(S,\\mu,\\sigma,C)^2.\n$$\nBecause $(\\mu,\\sigma)$ appear nonlinearly in $G_{\\mathrm{model}}$, there is no closed-form solution from normal equations; instead, we use a numerical nonlinear least-squares solver. Physical plausibility imposes $\\sigma > 0$, so we enforce a bound constraint $\\sigma \\ge \\sigma_{\\min}$ with a small positive $\\sigma_{\\min}$, and we use bounded intervals for $S$, $\\mu$, and $C$ to regularize the search. The initial guess for $\\mu$ comes from the known structure as $\\mu_0 = a/2$. Reasonable initial guesses for the remaining parameters are $\\sigma_0 = 0.050\\,\\mathrm{\\AA}$ (a typical thermal/static width for room temperature), $S_0 = \\sqrt{2\\pi}\\,\\sigma_0$ (so that the initial peak maximum is near unity), and $C_0 = 0.000$.\n\nSynthetic experimental data generation for testing follows the same local model with known ground-truth parameters $(S^\\star,\\mu^\\star,\\sigma^\\star,C^\\star)$, onto which we superimpose independent and identically distributed Gaussian noise with zero mean and a specified standard deviation. To ensure reproducibility, we fix the pseudorandom seed to $42$. For each test case, we define an $r$-grid and compute\n$$\nG_{\\mathrm{exp}}(r_k) \\;=\\; S^\\star \\,\\frac{1}{\\sqrt{2\\pi}\\,\\sigma^\\star}\\,\\exp\\!\\left(-\\frac{(r_k-\\mu^\\star)^2}{2(\\sigma^\\star)^2}\\right) \\;+\\; C^\\star \\;+\\; \\eta_k,\n$$\nwith $\\eta_k \\sim \\mathcal{N}(0,\\tau^2)$ where $\\tau$ is the specified noise standard deviation. We choose $S^\\star = \\sqrt{2\\pi}\\,\\sigma^\\star$ so that the noiseless peak maximum is approximately unity at $r=\\mu^\\star$. This normalization isolates the effect of $(\\mu^\\star,\\sigma^\\star)$ from the absolute intensity scale.\n\nWe then fit $(S,\\mu,\\sigma,C)$ by minimizing $\\Phi(S,\\mu,\\sigma,C)$ with bound constraints. Specifically, we enforce $\\sigma \\in [0.005\\,\\mathrm{\\AA},\\,0.500\\,\\mathrm{\\AA}]$ to avoid degeneracies, $\\mu$ within a narrow window around $\\mu_0=a/2$ (e.g., $\\mu \\in [\\mu_0-0.300\\,\\mathrm{\\AA},\\,\\mu_0+0.300\\,\\mathrm{\\AA}]$), $S \\in [0,10]$ to confine the scale, and $C \\in [-0.5,0.5]$. With these constraints and initial guesses, standard trust-region reflective least squares converges reliably for the specified cases.\n\nFinally, we report the fitted $(\\mu,\\sigma)$ for each test case as floats in $\\mathrm{\\AA}$, rounded to three decimal places. The single-line program output concatenates the results as $[\\mu_1,\\sigma_1,\\mu_2,\\sigma_2,\\mu_3,\\sigma_3]$. Because the noise is small relative to the peak height and the initial guesses are close to the ground truth, the fitted values are expected to be close to $(2.820\\,\\mathrm{\\AA},0.070\\,\\mathrm{\\AA})$, $(2.835\\,\\mathrm{\\AA},0.015\\,\\mathrm{\\AA})$, and $(2.100\\,\\mathrm{\\AA},0.120\\,\\mathrm{\\AA})$, respectively, modulo small deviations induced by the specified random noise.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import least_squares\n\ndef gaussian_peak(r, S, mu, sigma, C):\n    # Model: normalized Gaussian peak plus baseline\n    return S * (1.0 / (np.sqrt(2.0 * np.pi) * sigma)) * np.exp(-0.5 * ((r - mu) / sigma) ** 2) + C\n\ndef simulate_experimental(r, mu_true, sigma_true, S_true, C_true, noise_std, rng):\n    y_true = gaussian_peak(r, S_true, mu_true, sigma_true, C_true)\n    noise = rng.normal(loc=0.0, scale=noise_std, size=r.shape)\n    return y_true + noise\n\ndef fit_first_shell(r, y, a):\n    # Initial guesses from structure and generic assumptions\n    mu0 = a / 2.0\n    sigma0 = 0.050\n    S0 = np.sqrt(2.0 * np.pi) * sigma0  # peak max ~ 1\n    C0 = 0.0\n\n    # Parameter vector: [S, mu, sigma, C]\n    p0 = np.array([S0, mu0, sigma0, C0], dtype=float)\n\n    # Bounds: S in [0, 10], mu near mu0 +/- 0.3, sigma in [0.005, 0.5], C in [-0.5, 0.5]\n    lb = np.array([0.0, mu0 - 0.3, 0.005, -0.5], dtype=float)\n    ub = np.array([10.0, mu0 + 0.3, 0.5, 0.5], dtype=float)\n\n    def residuals(p):\n        S, mu, sigma, C = p\n        return y - gaussian_peak(r, S, mu, sigma, C)\n\n    res = least_squares(residuals, p0, bounds=(lb, ub), method='trf', loss='linear')\n    S_fit, mu_fit, sigma_fit, C_fit = res.x\n    return mu_fit, sigma_fit\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each case: dict containing a, mu_true, sigma_true, C_true, noise_std, r_min, r_max, dr.\n    test_cases = [\n        {\n            \"a\": 5.640, \"mu_true\": 2.820, \"sigma_true\": 0.070, \"C_true\": 0.0, \"noise_std\": 0.002,\n            \"r_min\": 2.000, \"r_max\": 3.800, \"dr\": 0.005\n        },\n        {\n            \"a\": 5.640, \"mu_true\": 2.835, \"sigma_true\": 0.015, \"C_true\": 0.0, \"noise_std\": 0.002,\n            \"r_min\": 2.600, \"r_max\": 3.100, \"dr\": 0.002\n        },\n        {\n            \"a\": 4.200, \"mu_true\": 2.100, \"sigma_true\": 0.120, \"C_true\": 0.0, \"noise_std\": 0.004,\n            \"r_min\": 1.500, \"r_max\": 3.500, \"dr\": 0.005\n        },\n    ]\n\n    # Fixed pseudorandom seed for reproducibility\n    rng = np.random.default_rng(42)\n\n    results = []\n    for case in test_cases:\n        a = case[\"a\"]\n        mu_true = case[\"mu_true\"]\n        sigma_true = case[\"sigma_true\"]\n        C_true = case[\"C_true\"]\n        noise_std = case[\"noise_std\"]\n        r_min = case[\"r_min\"]\n        r_max = case[\"r_max\"]\n        dr = case[\"dr\"]\n\n        # r-grid inclusive of r_max within floating point tolerance\n        n_steps = int(np.round((r_max - r_min) / dr)) + 1\n        r = r_min + dr * np.arange(n_steps)\n\n        # Choose S_true so that peak max ~ 1\n        S_true = np.sqrt(2.0 * np.pi) * sigma_true\n\n        # Simulate experimental G(r)\n        y_exp = simulate_experimental(r, mu_true, sigma_true, S_true, C_true, noise_std, rng)\n\n        # Fit first-shell model\n        mu_fit, sigma_fit = fit_first_shell(r, y_exp, a)\n\n        # Append rounded results to three decimals as strings\n        results.append(f\"{mu_fit:.3f}\")\n        results.append(f\"{sigma_fit:.3f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "2503107"}]}