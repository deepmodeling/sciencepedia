{"hands_on_practices": [{"introduction": "A cornerstone of materials thermodynamics is understanding and predicting phase transitions. This exercise provides fundamental practice in modeling an order-disorder transition within the CALPHAD framework. You will use the Compound Energy Formalism (CEF) for a binary alloy on a B2 lattice to connect a microscopic interaction energy parameter, $\\Omega$, to the macroscopic critical ordering temperature, $T_c$. This practice reinforces how the interplay between enthalpic ordering preference and entropic disordering tendency governs phase stability, a core concept in the design of ordered alloys [@problem_id:2471433].", "problem": "A binary substitutional alloy $\\mathrm{A}$–$\\mathrm{B}$ on the body-centered cubic lattice exhibits B2 long-range order described by two interpenetrating sublattices $\\alpha$ and $\\beta$. Within the Compound Energy Formalism used in Calculation of Phase Diagrams (CALPHAD), define the long-range order parameter $\\eta$ at overall equiatomic composition by the sublattice site fractions $y_{\\mathrm{A}}^{\\alpha} = (1+\\eta)/2$, $y_{\\mathrm{B}}^{\\alpha} = (1-\\eta)/2$, $y_{\\mathrm{A}}^{\\beta} = (1-\\eta)/2$, and $y_{\\mathrm{B}}^{\\beta} = (1+\\eta)/2$, with $0 \\le \\eta \\le 1$. Assume:\n- The molar Gibbs energy is $g = h - T s$ with ideal configurational entropy on each sublattice.\n- Only nearest-neighbor $\\alpha$–$\\beta$ interactions contribute to the enthalpy, captured by a temperature-independent regular-solution parameter $\\Omega$ (per mole), where $\\Omega$ is defined in terms of pair energies by $\\Omega = z\\!\\left(w_{\\mathrm{AB}} - \\frac{w_{\\mathrm{AA}} + w_{\\mathrm{BB}}}{2}\\right)$ at the equiatomic composition, with $z$ the number of unlike-sublattice nearest neighbors on the body-centered cubic lattice.\n\nStarting from these definitions and first principles of Gibbs free energy and ideal mixing entropy, derive the ordering driving force at fixed composition,\n$$\\Delta g(\\eta, T) \\equiv g_{\\mathrm{dis}} - g_{\\mathrm{ord}}(\\eta),$$\nto the leading nontrivial order in $\\eta$, and determine the temperature $T$ at which $\\Delta g(\\eta, T)$ vanishes in the limit $\\eta \\to 0^{+}$, thereby locating the critical order-disorder temperature $T_{c}$.\n\nThen, evaluate $T_{c}$ numerically for $\\Omega = -3.20 \\times 10^{4}$ J per mol and the molar gas constant $R = 8.314462618$ J per mol per K. Express the final temperature in K and round your answer to four significant figures.", "solution": "The problem requires the derivation of the ordering driving force for a B2-ordering binary alloy within the Compound Energy Formalism, followed by the determination of the critical order-disorder temperature $T_c$. The solution is derived from first principles as laid out in the problem statement.\n\nFirst, we establish the molar Gibbs energy of the ordered phase, $g_{\\mathrm{ord}}(\\eta)$, as a function of the long-range order parameter $\\eta$ and temperature $T$. The Gibbs energy is given by $g_{\\mathrm{ord}}(\\eta) = h_{\\mathrm{ord}}(\\eta) - T s_{\\mathrm{ord}}(\\eta)$, where $h_{\\mathrm{ord}}(\\eta)$ is the molar enthalpy of mixing and $s_{\\mathrm{ord}}(\\eta)$ is the molar configurational entropy.\n\nThe molar enthalpy of mixing, $h_{\\mathrm{ord}}(\\eta)$, is determined by the nearest-neighbor pair interactions on the body-centered cubic (BCC) lattice. In the B2 structure, each site has $z=8$ nearest neighbors, all of which reside on the other sublattice. Let the molar energies of A-A, B-B, and A-B pairs be $w_{\\mathrm{AA}}$, $w_{\\mathrm{BB}}$, and $w_{\\mathrm{AB}}$, respectively. The total molar enthalpy is the sum of energies of all pairs. The numbers of A-A, B-B, and A-B pairs are determined by the site fractions.\n\nThe number of moles of A-A pairs per mole of atoms is $\\frac{z}{2} y_{\\mathrm{A}}^{\\alpha} y_{\\mathrm{A}}^{\\beta}$. Similarly for B-B and A-B pairs.\nThe site fractions are given as: $y_{\\mathrm{A}}^{\\alpha} = (1+\\eta)/2$, $y_{\\mathrm{B}}^{\\alpha} = (1-\\eta)/2$, $y_{\\mathrm{A}}^{\\beta} = (1-\\eta)/2$, and $y_{\\mathrm{B}}^{\\beta} = (1+\\eta)/2$.\nWe can calculate the products of site fractions:\n$y_{\\mathrm{A}}^{\\alpha} y_{\\mathrm{A}}^{\\beta} = \\frac{1+\\eta}{2} \\frac{1-\\eta}{2} = \\frac{1-\\eta^2}{4}$\n$y_{\\mathrm{B}}^{\\alpha} y_{\\mathrm{B}}^{\\beta} = \\frac{1-\\eta}{2} \\frac{1+\\eta}{2} = \\frac{1-\\eta^2}{4}$\n$y_{\\mathrm{A}}^{\\alpha} y_{\\mathrm{B}}^{\\beta} + y_{\\mathrm{B}}^{\\alpha} y_{\\mathrm{A}}^{\\beta} = \\left(\\frac{1+\\eta}{2}\\right)^2 + \\left(\\frac{1-\\eta}{2}\\right)^2 = \\frac{1+2\\eta+\\eta^2}{4} + \\frac{1-2\\eta+\\eta^2}{4} = \\frac{2+2\\eta^2}{4} = \\frac{1+\\eta^2}{2}$.\n\nThe absolute molar enthalpy is:\n$$h_{\\mathrm{abs}}(\\eta) = \\frac{z}{2} \\left[ (y_{\\mathrm{A}}^{\\alpha} y_{\\mathrm{A}}^{\\beta}) w_{\\mathrm{AA}} + (y_{\\mathrm{B}}^{\\alpha} y_{\\mathrm{B}}^{\\beta}) w_{\\mathrm{BB}} + (y_{\\mathrm{A}}^{\\alpha} y_{\\mathrm{B}}^{\\beta} + y_{\\mathrm{B}}^{\\alpha} y_{\\mathrm{A}}^{\\beta}) w_{\\mathrm{AB}} \\right]$$\n$$h_{\\mathrm{abs}}(\\eta) = \\frac{z}{2} \\left[ \\frac{1-\\eta^2}{4} w_{\\mathrm{AA}} + \\frac{1-\\eta^2}{4} w_{\\mathrm{BB}} + \\frac{1+\\eta^2}{2} w_{\\mathrm{AB}} \\right]$$\nThe enthalpy of mixing, $h_{\\mathrm{ord}}(\\eta)$, is found by subtracting the reference enthalpy of a mechanical mixture of pure components, $h_{\\mathrm{ref}} = x_{\\mathrm{A}} h_{\\mathrm{A}}^{\\circ} + x_{\\mathrm{B}} h_{\\mathrm{B}}^{\\circ}$. For an equiatomic composition ($x_{\\mathrm{A}}=x_{\\mathrm{B}}=0.5$), and with $h_{\\mathrm{A}}^{\\circ} = \\frac{z}{2}w_{\\mathrm{AA}}$ and $h_{\\mathrm{B}}^{\\circ} = \\frac{z}{2}w_{\\mathrm{BB}}$, we have $h_{\\mathrm{ref}} = \\frac{1}{2}(\\frac{z}{2}w_{\\mathrm{AA}}) + \\frac{1}{2}(\\frac{z}{2}w_{\\mathrm{BB}}) = \\frac{z}{4}(w_{\\mathrm{AA}} + w_{\\mathrm{BB}})$.\n$$h_{\\mathrm{ord}}(\\eta) = h_{\\mathrm{abs}}(\\eta) - h_{\\mathrm{ref}} = \\frac{z}{8} \\left[ (1-\\eta^2)(w_{\\mathrm{AA}}+w_{\\mathrm{BB}}) + 2(1+\\eta^2)w_{\\mathrm{AB}} - 2(w_{\\mathrm{AA}}+w_{\\mathrm{BB}}) \\right]$$\n$$h_{\\mathrm{ord}}(\\eta) = \\frac{z}{8} \\left[ (2w_{\\mathrm{AB}} - w_{\\mathrm{AA}} - w_{\\mathrm{BB}}) + \\eta^2(2w_{\\mathrm{AB}} - w_{\\mathrm{AA}} - w_{\\mathrm{BB}}) \\right]$$\nUsing the definition of the regular-solution parameter $\\Omega = z(w_{\\mathrm{AB}} - \\frac{w_{\\mathrm{AA}}+w_{\\mathrm{BB}}}{2})$, this simplifies to:\n$$h_{\\mathrm{ord}}(\\eta) = \\frac{1+\\eta^2}{4} z \\left( w_{\\mathrm{AB}} - \\frac{w_{\\mathrm{AA}}+w_{\\mathrm{BB}}}{2} \\right) = \\frac{\\Omega}{4}(1+\\eta^2)$$\n\nNext, we formulate the molar configurational entropy, $s_{\\mathrm{ord}}(\\eta)$, based on ideal mixing on each sublattice. The total entropy is the sum of contributions from the $\\alpha$ and $\\beta$ sublattices, each containing $0.5$ moles of sites per mole of alloy.\n$$s_{\\mathrm{ord}}(\\eta) = -0.5R \\left( y_{\\mathrm{A}}^{\\alpha} \\ln y_{\\mathrm{A}}^{\\alpha} + y_{\\mathrm{B}}^{\\alpha} \\ln y_{\\mathrm{B}}^{\\alpha} \\right) - 0.5R \\left( y_{\\mathrm{A}}^{\\beta} \\ln y_{\\mathrm{A}}^{\\beta} + y_{\\mathrm{B}}^{\\beta} \\ln y_{\\mathrm{B}}^{\\beta} \\right)$$\nSubstituting the site fractions:\n$$s_{\\mathrm{ord}}(\\eta) = -0.5R \\left( \\frac{1+\\eta}{2}\\ln\\frac{1+\\eta}{2} + \\frac{1-\\eta}{2}\\ln\\frac{1-\\eta}{2} \\right) - 0.5R \\left( \\frac{1-\\eta}{2}\\ln\\frac{1-\\eta}{2} + \\frac{1+\\eta}{2}\\ln\\frac{1+\\eta}{2} \\right)$$\n$$s_{\\mathrm{ord}}(\\eta) = -R \\left[ \\frac{1+\\eta}{2}\\ln\\left(\\frac{1+\\eta}{2}\\right) + \\frac{1-\\eta}{2}\\ln\\left(\\frac{1-\\eta}{2}\\right) \\right]$$\nThis can be rewritten as:\n$$s_{\\mathrm{ord}}(\\eta) = -R \\left[ \\frac{1+\\eta}{2}\\ln(1+\\eta) + \\frac{1-\\eta}{2}\\ln(1-\\eta) - \\ln(2) \\right]$$\n\nThe Gibbs energy of the ordered phase is $g_{\\mathrm{ord}}(\\eta) = h_{\\mathrm{ord}}(\\eta) - T s_{\\mathrm{ord}}(\\eta)$:\n$$g_{\\mathrm{ord}}(\\eta) = \\frac{\\Omega}{4}(1+\\eta^2) + RT \\left[ \\frac{1+\\eta}{2}\\ln(1+\\eta) + \\frac{1-\\eta}{2}\\ln(1-\\eta) - \\ln(2) \\right]$$\n\nThe Gibbs energy of the disordered phase, $g_{\\mathrm{dis}}$, corresponds to the state with $\\eta=0$:\n$$g_{\\mathrm{dis}} = g_{\\mathrm{ord}}(0) = \\frac{\\Omega}{4} - RT\\ln(2)$$\n\nThe ordering driving force is defined as $\\Delta g(\\eta, T) \\equiv g_{\\mathrm{dis}} - g_{\\mathrm{ord}}(\\eta)$:\n$$\\Delta g(\\eta, T) = \\left( \\frac{\\Omega}{4} - RT\\ln(2) \\right) - \\left( \\frac{\\Omega}{4}(1+\\eta^2) + RT \\left[ \\frac{1+\\eta}{2}\\ln(1+\\eta) + \\frac{1-\\eta}{2}\\ln(1-\\eta) - \\ln(2) \\right] \\right)$$\n$$\\Delta g(\\eta, T) = -\\frac{\\Omega}{4}\\eta^2 - RT \\left[ \\frac{1+\\eta}{2}\\ln(1+\\eta) + \\frac{1-\\eta}{2}\\ln(1-\\eta) \\right]$$\n\nTo find the behavior for small $\\eta$, we use the Taylor expansion $\\ln(1+x) = x - x^2/2 + x^3/3 - x^4/4 + O(x^5)$:\n$$\\frac{1+\\eta}{2}\\ln(1+\\eta) = \\frac{1}{2}(1+\\eta)\\left(\\eta - \\frac{\\eta^2}{2} + \\frac{\\eta^3}{3} - \\frac{\\eta^4}{4} + \\dots \\right) = \\frac{1}{2}\\left(\\eta + \\frac{\\eta^2}{2} - \\frac{\\eta^3}{6} + \\frac{\\eta^4}{12} + \\dots \\right)$$\n$$\\frac{1-\\eta}{2}\\ln(1-\\eta) = \\frac{1}{2}(1-\\eta)\\left(-\\eta - \\frac{\\eta^2}{2} - \\frac{\\eta^3}{3} - \\frac{\\eta^4}{4} + \\dots \\right) = \\frac{1}{2}\\left(-\\eta + \\frac{\\eta^2}{2} + \\frac{\\eta^3}{6} + \\frac{\\eta^4}{12} + \\dots \\right)$$\nSumming these gives:\n$$\\frac{1+\\eta}{2}\\ln(1+\\eta) + \\frac{1-\\eta}{2}\\ln(1-\\eta) = \\frac{\\eta^2}{2} + \\frac{\\eta^4}{12} + O(\\eta^6)$$\nSubstituting this expansion into the expression for $\\Delta g(\\eta, T)$:\n$$\\Delta g(\\eta, T) = -\\frac{\\Omega}{4}\\eta^2 - RT \\left( \\frac{\\eta^2}{2} + \\frac{\\eta^4}{12} + O(\\eta^6) \\right) = -\\left(\\frac{\\Omega}{4} + \\frac{RT}{2}\\right)\\eta^2 - \\frac{RT}{12}\\eta^4 - O(\\eta^6)$$\nThe ordering driving force to the leading nontrivial order in $\\eta$ is:\n$$\\Delta g(\\eta, T) \\approx -\\left(\\frac{\\Omega}{4} + \\frac{RT}{2}\\right)\\eta^2$$\n\nThe critical order-disorder temperature, $T_c$, is the temperature at which the stability of the disordered phase ($\\eta=0$) changes. This occurs when the coefficient of the $\\eta^2$ term in the Gibbs energy expansion, $g_{\\mathrm{ord}}(\\eta) - g_{\\mathrm{dis}}$, changes sign from positive to negative as temperature is lowered. The coefficient is $(\\frac{\\Omega}{4} + \\frac{RT}{2})$. The critical temperature is found by setting this coefficient to zero. Note that this is equivalent to finding the temperature where the leading term of $\\Delta g(\\eta, T)$ vanishes.\n$$\\frac{\\Omega}{4} + \\frac{RT_c}{2} = 0$$\nSolving for $T_c$:\n$$T_c = -\\frac{\\Omega}{2R}$$\n\nFinally, we evaluate $T_c$ numerically with the given values $\\Omega = -3.20 \\times 10^{4} \\text{ J/mol}$ and $R = 8.314462618 \\text{ J/(mol}\\cdot\\text{K)}$.\n$$T_c = -\\frac{-3.20 \\times 10^{4} \\text{ J/mol}}{2 \\times 8.314462618 \\text{ J/(mol}\\cdot\\text{K)}} = \\frac{3.20 \\times 10^{4}}{16.628925236} \\text{ K}$$\n$$T_c \\approx 1924.340 \\text{ K}$$\nRounding the result to four significant figures gives $1924 \\text{ K}$.", "answer": "$$\\boxed{1924}$$", "id": "2471433"}, {"introduction": "In many real-world alloy systems, the pathway to equilibrium is just as important as the final state itself. This problem explores the crucial concept of phase competition between a stable phase and a transient metastable phase during precipitation. By comparing the Gibbs energy curves of two phases described by Redlich-Kister expansions, you will determine the conditions under which the metastable phase is thermodynamically preferred. This exercise provides direct insight into how CALPHAD models are used to predict and rationalize complex precipitation sequences, explaining phenomena dictated by Ostwald's rule of stages [@problem_id:2471379].", "problem": "A binary substitutional alloy of components $A$ and $B$ is modeled within the framework of Calculation of Phase Diagrams (CALPHAD). Two competing precipitation phases are possible: a metastable phase $M$ and a thermodynamically stable phase $S$. Each phase is treated as a substitutional solution with a molar Gibbs energy described by a Redlich–Kister expansion up to first order. At fixed temperature $T = 900\\ \\mathrm{K}$ and standard pressure, the molar Gibbs energies (per mole of sites) of the two phases as functions of the mole fraction of $B$, $x \\in (0,1)$, are\n$$\ng_{M}(x,T) \\,=\\, (1-x)\\,g_{A}^{0}(T) \\,+\\, x\\,g_{B}^{0}(T) \\,+\\, R T\\big[x\\ln x + (1-x)\\ln(1-x)\\big] \\,+\\, x(1-x)\\Big(L_{0}^{M} + L_{1}^{M}\\,(1-2x)\\Big),\n$$\n$$\ng_{S}(x,T) \\,=\\, (1-x)\\,g_{A}^{0}(T) \\,+\\, x\\,g_{B}^{0}(T) \\,+\\, \\Delta g^{0} \\,+\\, R T\\big[x\\ln x + (1-x)\\ln(1-x)\\big] \\,+\\, x(1-x)\\Big(L_{0}^{S} + L_{1}^{S}\\,(1-2x)\\Big),\n$$\nwhere $R$ is the universal gas constant, $g_{A}^{0}(T)$ and $g_{B}^{0}(T)$ are the endmember Gibbs energies (identical between $M$ and $S$), and $\\Delta g^{0}$ is a temperature-dependent offset between $M$ and $S$ arising from different lattice stabilities. At $T=900\\ \\mathrm{K}$, the assessed interaction parameters and offset are\n$$\nL_{0}^{M} = -2.0\\times 10^{4}\\ \\mathrm{J\\,mol^{-1}},\\quad L_{1}^{M} = 5.0\\times 10^{3}\\ \\mathrm{J\\,mol^{-1}},\n$$\n$$\nL_{0}^{S} = -3.0\\times 10^{4}\\ \\mathrm{J\\,mol^{-1}},\\quad L_{1}^{S} = -1.0\\times 10^{4}\\ \\mathrm{J\\,mol^{-1}},\n$$\n$$\n\\Delta g^{0} = 3.0\\times 10^{3}\\ \\mathrm{J\\,mol^{-1}}.\n$$\nAssume that the metastable extension of $M$ and the stable $S$ are both meaningfully evaluated across the composition range of interest. Focusing on the $A$-rich regime that controls early precipitation, determine the composition $x \\in (0,0.4)$ at which $g_{M}(x,900\\ \\mathrm{K}) = g_{S}(x,900\\ \\mathrm{K})$. Express your answer as a decimal mole fraction of $B$ and round to four significant figures.\n\nThen, based on first principles of Gibbs energy minimization at fixed $T$ and pressure, briefly explain the implication of the crossing point for precipitation sequences in an $A$-rich alloy quenched into this temperature. Your explanation should be qualitative and justified from the thermodynamic driving forces inherent in the modeled Gibbs energies; do not invoke any kinetic parameters. The explanation does not affect the numerical answer, which must be reported as specified above.", "solution": "To find the composition $x$ at which the Gibbs energies of the two phases are equal, we set $g_{M}(x,T) = g_{S}(x,T)$.\n$$\n(1-x)\\,g_{A}^{0}(T) \\,+\\, x\\,g_{B}^{0}(T) \\,+\\, RT\\big[x\\ln x + (1-x)\\ln(1-x)\\big] \\,+\\, x(1-x)\\Big(L_{0}^{M} + L_{1}^{M}\\,(1-2x)\\Big) \\\\\n= (1-x)\\,g_{A}^{0}(T) \\,+\\, x\\,g_{B}^{0}(T) \\,+\\, \\Delta g^{0} \\,+\\, RT\\big[x\\ln x + (1-x)\\ln(1-x)\\big] \\,+\\, x(1-x)\\Big(L_{0}^{S} + L_{1}^{S}\\,(1-2x)\\Big)\n$$\nThe terms for the Gibbs energies of the pure components, $(1-x)\\,g_{A}^{0}(T) + x\\,g_{B}^{0}(T)$, and the ideal entropy of mixing, $RT\\big[x\\ln x + (1-x)\\ln(1-x)\\big]$, are identical for both phases and thus cancel out. The equation simplifies to an equality between the excess Gibbs energy terms and the offset $\\Delta g^{0}$:\n$$\nx(1-x)\\Big(L_{0}^{M} + L_{1}^{M}\\,(1-2x)\\Big) = \\Delta g^{0} + x(1-x)\\Big(L_{0}^{S} + L_{1}^{S}\\,(1-2x)\\Big)\n$$\nRearranging the terms to solve for $x$:\n$$\nx(1-x)\\Big[\\big(L_{0}^{M} - L_{0}^{S}\\big) + \\big(L_{1}^{M} - L_{1}^{S}\\big)(1-2x)\\Big] - \\Delta g^{0} = 0\n$$\nLet us define $\\Delta L_{0} = L_{0}^{M} - L_{0}^{S}$ and $\\Delta L_{1} = L_{1}^{M} - L_{1}^{S}$. We substitute the given numerical values:\n$$\n\\Delta L_{0} = (-2.0\\times 10^{4}) - (-3.0\\times 10^{4}) = 1.0\\times 10^{4}\\ \\mathrm{J\\,mol^{-1}}\n$$\n$$\n\\Delta L_{1} = (5.0\\times 10^{3}) - (-1.0\\times 10^{4}) = 1.5\\times 10^{4}\\ \\mathrm{J\\,mol^{-1}}\n$$\n$$\n\\Delta g^{0} = 3.0\\times 10^{3}\\ \\mathrm{J\\,mol^{-1}}\n$$\nThe equation becomes:\n$$\nx(1-x)\\Big[1.0\\times 10^{4} + (1.5\\times 10^{4})(1-2x)\\Big] - 3.0\\times 10^{3} = 0\n$$\nExpanding the expression:\n$$\nx(1-x)\\Big[10000 + 15000 - 30000x\\Big] - 3000 = 0\n$$\n$$\n(x-x^2)(25000 - 30000x) - 3000 = 0\n$$\n$$\n25000x - 30000x^2 - 25000x^2 + 30000x^3 - 3000 = 0\n$$\nThis results in a cubic polynomial equation for $x$:\n$$\n30000x^3 - 55000x^2 + 25000x - 3000 = 0\n$$\nDividing by $1000$ for simplification:\n$$\n30x^3 - 55x^2 + 25x - 3 = 0\n$$\nWe must find the root of this cubic polynomial in the interval $x \\in (0, 0.4)$. We can evaluate the polynomial, let's call it $f(x) = 30x^3 - 55x^2 + 25x - 3$, at the boundaries of the search interval and at intermediate points.\n$f(0) = -3$\n$f(0.1) = 30(0.001) - 55(0.01) + 25(0.1) - 3 = 0.03 - 0.55 + 2.5 - 3 = -1.02$\n$f(0.2) = 30(0.008) - 55(0.04) + 25(0.2) - 3 = 0.24 - 2.2 + 5.0 - 3 = 0.04$\nSince $f(0.1) < 0$ and $f(0.2) > 0$, a root exists between $x=0.1$ and $x=0.2$. Numerical methods, such as bisection or Newton-Raphson, can be used to find a more precise value. Solving the equation numerically for the root in this interval yields $x \\approx 0.194133...$. Rounding to four significant figures as requested gives $x_c = 0.1941$.\n\nFor the qualitative explanation, we analyze the condition $g_M = g_S$. The sign of the difference $g_M(x) - g_S(x)$ determines which phase is thermodynamically more stable at a given composition $x$. The difference is given by the polynomial we solved:\n$g_M(x) - g_S(x) = -3000 + 25000x - 55000x^2 + 30000x^3$.\nFor $x \\to 0$, the difference approaches $-3000\\ \\mathrm{J\\,mol^{-1}}$, which means $g_M < g_S$ for very small $x$. Since the function is continuous and crosses zero at $x_c \\approx 0.1941$, it must be that for all $x$ in the interval $[0, x_c)$, we have $g_M(x) < g_S(x)$. Conversely, for $x > x_c$ (within the local domain of this root), $g_M(x) > g_S(x)$.\n\nThe implication for precipitation in an A-rich alloy is governed by the thermodynamic driving force. According to Gibbs energy minimization, a system will evolve by following a path that provides the maximum possible reduction in Gibbs energy. When an A-rich alloy (with a composition $x_0$ significantly less than $x_c$) is quenched, it becomes supersaturated, and precipitation of a new phase will be initiated. The composition of the incipient precipitate nuclei, let's call it $x_p$, will also be in the A-rich domain. Given that the crossing point is $x_c \\approx 0.1941$, it is reasonable to assume that early precipitates will have a composition $x_p < x_c$. In this composition range, the Gibbs energy of the metastable phase $M$ is lower than that of the stable phase $S$, i.e., $g_M(x_p) < g_S(x_p)$. Consequently, the precipitation of phase $M$ offers a larger thermodynamic driving force (a greater reduction in the system's total Gibbs energy) than the precipitation of phase $S$. Therefore, the metastable phase $M$ is expected to precipitate preferentially. This phenomenon, where a system approaches its final equilibrium state via one or more intermediate metastable states, is an illustration of Ostwald's rule of stages. The initial formation of phase $M$ could be followed by a subsequent transformation to phase $S$ over longer aging times, if phase $S$ has a lower Gibbs energy at a different composition that becomes the equilibrium state.", "answer": "$$\\boxed{0.1941}$$", "id": "2471379"}, {"introduction": "While analytical derivations are essential for building intuition, the power of CALPHAD lies in its computational application to complex, multi-component systems. This problem bridges the gap between thermodynamic theory and numerical practice by tasking you with solving for the internal equilibrium of a phase with sublattices. You will set up the constrained equilibrium problem using a Lagrange multiplier and derive the Jacobian matrix required for a Newton-Raphson solver. This hands-on computational exercise demystifies the \"black box\" of thermodynamic software, providing a concrete understanding of the numerical engine that calculates phase equilibria in modern materials design [@problem_id:2471384].", "problem": "You are modeling an ordered binary phase with a two-sublattice formulation, representative of a cesium-chloride (B2) structure in the Calculation of Phase Diagrams (CALPHAD) framework. The phase has two interpenetrating sublattices denoted by $\\alpha$ and $\\beta$, each of which may be occupied by species $\\mathrm{A}$ and $\\mathrm{B}$. Let the site fractions on each sublattice be $\\{y_{\\mathrm{A}}^{(\\alpha)}, y_{\\mathrm{B}}^{(\\alpha)}\\}$ and $\\{y_{\\mathrm{A}}^{(\\beta)}, y_{\\mathrm{B}}^{(\\beta)}\\}$, where the normalization constraints $y_{\\mathrm{A}}^{(\\alpha)} + y_{\\mathrm{B}}^{(\\alpha)} = 1$ and $y_{\\mathrm{A}}^{(\\beta)} + y_{\\mathrm{B}}^{(\\beta)} = 1$ hold. Define $y_{\\mathrm{A}}^{(\\alpha)}$ and $y_{\\mathrm{A}}^{(\\beta)}$ as the independent variables, and use $y_{\\mathrm{B}}^{(\\alpha)} = 1 - y_{\\mathrm{A}}^{(\\alpha)}$ and $y_{\\mathrm{B}}^{(\\beta)} = 1 - y_{\\mathrm{A}}^{(\\beta)}$.\n\nAt fixed temperature $T$ and pressure $P$, the equilibrium state minimizes the molar Gibbs energy of the phase subject to a fixed overall composition of $\\mathrm{A}$. For a B2 phase with endmember energies $G_{\\mathrm{A}:\\mathrm{A}}$, $G_{\\mathrm{A}:\\mathrm{B}}$, $G_{\\mathrm{B}:\\mathrm{A}}$, and $G_{\\mathrm{B}:\\mathrm{B}}$ (all per mole of formula units), the molar Gibbs energy at given $T$ is modeled as the sum of an ideal configurational term on each sublattice and a linear combination of endmember energies:\n$$\nG\\!\\left(y_{\\mathrm{A}}^{(\\alpha)}, y_{\\mathrm{A}}^{(\\beta)}; T\\right) =\ny_{\\mathrm{A}}^{(\\alpha)} y_{\\mathrm{A}}^{(\\beta)} G_{\\mathrm{A}:\\mathrm{A}}\n+ y_{\\mathrm{A}}^{(\\alpha)} \\left(1 - y_{\\mathrm{A}}^{(\\beta)}\\right) G_{\\mathrm{A}:\\mathrm{B}}\n+ \\left(1 - y_{\\mathrm{A}}^{(\\alpha)}\\right) y_{\\mathrm{A}}^{(\\beta)} G_{\\mathrm{B}:\\mathrm{A}}\n+ \\left(1 - y_{\\mathrm{A}}^{(\\alpha)}\\right) \\left(1 - y_{\\mathrm{A}}^{(\\beta)}\\right) G_{\\mathrm{B}:\\mathrm{B}} \\\\\n+ R T \\left[\ny_{\\mathrm{A}}^{(\\alpha)} \\ln y_{\\mathrm{A}}^{(\\alpha)} + \\left(1 - y_{\\mathrm{A}}^{(\\alpha)}\\right) \\ln \\left(1 - y_{\\mathrm{A}}^{(\\alpha)}\\right)\n+ y_{\\mathrm{A}}^{(\\beta)} \\ln y_{\\mathrm{A}}^{(\\beta)} + \\left(1 - y_{\\mathrm{A}}^{(\\beta)}\\right) \\ln \\left(1 - y_{\\mathrm{A}}^{(\\beta)}\\right)\n\\right],\n$$\nwhere $R$ is the universal gas constant.\n\nThe overall composition of $\\mathrm{A}$ in the phase, $x_{\\mathrm{A}}$, is constrained by the stoichiometry of the two-sublattice model with equal sublattice site counts:\n$$\n\\frac{1}{2}\\left(y_{\\mathrm{A}}^{(\\alpha)} + y_{\\mathrm{A}}^{(\\beta)}\\right) = x_{\\mathrm{A}}.\n$$\n\nStarting from fundamental thermodynamics at fixed $T$ and $P$, equilibrium corresponds to the stationary point of the molar Gibbs energy under the composition constraint. Introduce a Lagrange multiplier $\\lambda$ to enforce the composition constraint. Let the vector of unknowns be $\\mathbf{u} = \\left[y_{\\mathrm{A}}^{(\\alpha)}, y_{\\mathrm{A}}^{(\\beta)}, \\lambda\\right]^{\\top}$. Define the system of equilibrium conditions $\\mathbf{f}(\\mathbf{u}) = \\mathbf{0}$ as the stationarity of the Lagrangian with respect to $y_{\\mathrm{A}}^{(\\alpha)}$ and $y_{\\mathrm{A}}^{(\\beta)}$, together with the composition constraint.\n\nYour tasks are:\n- Derive the explicit expressions for the components of $\\mathbf{f}(\\mathbf{u})$ and for the Jacobian matrix $\\mathbf{J}(\\mathbf{u}) = \\partial \\mathbf{f} / \\partial \\mathbf{u}$ based on the given $G$.\n- Implement Newton’s method to solve $\\mathbf{f}(\\mathbf{u}) = \\mathbf{0}$ for $\\mathbf{u}$ at fixed $T$, $P$, and $x_{\\mathrm{A}}$, using a backtracking line search to ensure that the iterates satisfy $y_{\\mathrm{A}}^{(\\alpha)}, y_{\\mathrm{A}}^{(\\beta)} \\in (0,1)$ and to promote convergence.\n- Use the following convergence criteria: stop when the Euclidean norm of the residual satisfies $\\|\\mathbf{f}(\\mathbf{u})\\|_{2} \\leq 10^{-10}$ and the infinity norm of the Newton step satisfies $\\|\\Delta \\mathbf{u}\\|_{\\infty} \\leq 10^{-12}$, or when the maximum number of iterations $100$ is reached.\n- Use the universal gas constant $R = 8.314462618$ in $\\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$.\n- Use initial guesses given by $y_{\\mathrm{A}}^{(\\alpha,0)} = \\min\\{\\max\\{x_{\\mathrm{A}} + 0.1, \\epsilon\\}, 1 - \\epsilon\\}$, $y_{\\mathrm{A}}^{(\\beta,0)} = \\min\\{\\max\\{2 x_{\\mathrm{A}} - y_{\\mathrm{A}}^{(\\alpha,0)}, \\epsilon\\}, 1 - \\epsilon\\}$, and $\\lambda^{(0)} = 0$, with $\\epsilon = 10^{-12}$.\n- Implement safe evaluation of logarithms by internally clamping the site fractions to $[\\epsilon, 1 - \\epsilon]$ when evaluating $G$ and its derivatives.\n\nPhysical units:\n- Temperatures $T$ are given in $\\mathrm{K}$.\n- Energies $G_{\\mathrm{i}:\\mathrm{j}}$ are given in $\\mathrm{J}\\,\\mathrm{mol}^{-1}$.\n- Site fractions $y_{\\mathrm{A}}^{(\\alpha)}$ and $y_{\\mathrm{A}}^{(\\beta)}$ are dimensionless.\n\nAngle units do not apply in this problem. Do not report percentages.\n\nTest suite:\n- Case $1$: $T = 1000\\,\\mathrm{K}$, $x_{\\mathrm{A}} = 0.5$, $\\left(G_{\\mathrm{A}:\\mathrm{A}}, G_{\\mathrm{A}:\\mathrm{B}}, G_{\\mathrm{B}:\\mathrm{A}}, G_{\\mathrm{B}:\\mathrm{B}}\\right) = \\left(2000, 0, 0, 2000\\right)\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}$.\n- Case $2$: $T = 5000\\,\\mathrm{K}$, $x_{\\mathrm{A}} = 0.5$, $\\left(G_{\\mathrm{A}:\\mathrm{A}}, G_{\\mathrm{A}:\\mathrm{B}}, G_{\\mathrm{B}:\\mathrm{A}}, G_{\\mathrm{B}:\\mathrm{B}}\\right) = \\left(2000, 0, 0, 2000\\right)\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}$.\n- Case $3$: $T = 1200\\,\\mathrm{K}$, $x_{\\mathrm{A}} = 0.6$, $\\left(G_{\\mathrm{A}:\\mathrm{A}}, G_{\\mathrm{A}:\\mathrm{B}}, G_{\\mathrm{B}:\\mathrm{A}}, G_{\\mathrm{B}:\\mathrm{B}}\\right) = \\left(2000, 0, 0, 2000\\right)\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}$.\n- Case $4$: $T = 1200\\,\\mathrm{K}$, $x_{\\mathrm{A}} = 0.01$, $\\left(G_{\\mathrm{A}:\\mathrm{A}}, G_{\\mathrm{A}:\\mathrm{B}}, G_{\\mathrm{B}:\\mathrm{A}}, G_{\\mathrm{B}:\\mathrm{B}}\\right) = \\left(2000, 0, 0, 2000\\right)\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}$.\n- Case $5$: $T = 800\\,\\mathrm{K}$, $x_{\\mathrm{A}} = 0.3$, $\\left(G_{\\mathrm{A}:\\mathrm{A}}, G_{\\mathrm{A}:\\mathrm{B}}, G_{\\mathrm{B}:\\mathrm{A}}, G_{\\mathrm{B}:\\mathrm{B}}\\right) = \\left(0, 0, 0, 0\\right)\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}$.\n\nYour program must compute the equilibrium values $\\left(y_{\\mathrm{A}}^{(\\alpha)}, y_{\\mathrm{A}}^{(\\beta)}\\right)$ for each test case, using Newton’s method with the Jacobian derived from first principles as above, and then produce the final output as a single line containing all results in a flat, comma-separated list enclosed in square brackets. The order must be, for each case in the order listed above, first $y_{\\mathrm{A}}^{(\\alpha)}$ and then $y_{\\mathrm{A}}^{(\\beta)}$. Express each site fraction as a decimal rounded to eight digits after the decimal point (dimensionless). For example, the output format must be of the form\n$[\\text{yA\\_alpha\\_case1}, \\text{yA\\_beta\\_case1}, \\text{yA\\_alpha\\_case2}, \\text{yA\\_beta\\_case2}, \\dots]$.", "solution": "The objective is to find the equilibrium site fractions, $y_{\\mathrm{A}}^{(\\alpha)}$ and $y_{\\mathrm{A}}^{(\\beta)}$, that minimize the molar Gibbs energy $G$ at a fixed overall composition $x_{\\mathrm{A}}$. For conciseness, let $y_1 \\equiv y_{\\mathrm{A}}^{(\\alpha)}$ and $y_2 \\equiv y_{\\mathrm{A}}^{(\\beta)}$.\n\nThe molar Gibbs energy is given by:\n$$\nG(y_1, y_2; T) =\ny_1 y_2 G_{\\mathrm{A}:\\mathrm{A}}\n+ y_1 (1 - y_2) G_{\\mathrm{A}:\\mathrm{B}}\n+ (1 - y_1) y_2 G_{\\mathrm{B}:\\mathrm{A}}\n+ (1 - y_1) (1 - y_2) G_{\\mathrm{B}:\\mathrm{B}} \\\\\n+ R T \\left[\ny_1 \\ln y_1 + (1 - y_1) \\ln(1 - y_1)\n+ y_2 \\ln y_2 + (1 - y_2) \\ln(1 - y_2)\n\\right]\n$$\nThis minimization is subject to the constraint on the overall composition:\n$$\nc(y_1, y_2) = \\frac{1}{2}(y_1 + y_2) - x_{\\mathrm{A}} = 0\n$$\n\nTo solve this constrained optimization problem, we introduce a Lagrange multiplier $\\lambda$ and form the Lagrangian function $\\mathcal{L}$:\n$$\n\\mathcal{L}(y_1, y_2, \\lambda) = G(y_1, y_2; T) + \\lambda \\left(\\frac{1}{2}(y_1 + y_2) - x_{\\mathrm{A}}\\right)\n$$\nThe equilibrium state corresponds to a stationary point of the Lagrangian, found by setting its partial derivatives with respect to the variables $y_1$, $y_2$, and $\\lambda$ to zero. This yields a system of three nonlinear equations, $\\mathbf{f}(\\mathbf{u}) = \\mathbf{0}$, where $\\mathbf{u} = [y_1, y_2, \\lambda]^{\\top}$.\n\nThe components of the residual vector $\\mathbf{f}(\\mathbf{u}) = [f_1, f_2, f_3]^{\\top}$ are:\n\n$1$. $f_1 = \\frac{\\partial \\mathcal{L}}{\\partial y_1} = \\frac{\\partial G}{\\partial y_1} + \\frac{\\lambda}{2} = 0$.\nThe partial derivative of $G$ with respect to $y_1$ is:\n$$\n\\frac{\\partial G}{\\partial y_1} = y_2 G_{\\mathrm{A}:\\mathrm{A}} + (1 - y_2) G_{\\mathrm{A}:\\mathrm{B}} - y_2 G_{\\mathrm{B}:\\mathrm{A}} - (1 - y_2) G_{\\mathrm{B}:\\mathrm{B}} + RT \\left(\\ln y_1 - \\ln(1 - y_1)\\right)\n$$\nThus, the first equation is:\n$$\nf_1(y_1, y_2, \\lambda) = y_2(G_{\\mathrm{A}:\\mathrm{A}} - G_{\\mathrm{B}:\\mathrm{A}}) + (1-y_2)(G_{\\mathrm{A}:\\mathrm{B}} - G_{\\mathrm{B}:\\mathrm{B}}) + RT\\ln\\left(\\frac{y_1}{1-y_1}\\right) + \\frac{\\lambda}{2} = 0\n$$\n\n$2$. $f_2 = \\frac{\\partial \\mathcal{L}}{\\partial y_2} = \\frac{\\partial G}{\\partial y_2} + \\frac{\\lambda}{2} = 0$.\nThe partial derivative of $G$ with respect to $y_2$ is:\n$$\n\\frac{\\partial G}{\\partial y_2} = y_1 G_{\\mathrm{A}:\\mathrm{A}} - y_1 G_{\\mathrm{A}:\\mathrm{B}} + (1 - y_1) G_{\\mathrm{B}:\\mathrm{A}} - (1 - y_1) G_{\\mathrm{B}:\\mathrm{B}} + RT \\left(\\ln y_2 - \\ln(1 - y_2)\\right)\n$$\nThus, the second equation is:\n$$\nf_2(y_1, y_2, \\lambda) = y_1(G_{\\mathrm{A}:\\mathrm{A}} - G_{\\mathrm{A}:\\mathrm{B}}) + (1-y_1)(G_{\\mathrm{B}:\\mathrm{A}} - G_{\\mathrm{B}:\\mathrm{B}}) + RT\\ln\\left(\\frac{y_2}{1-y_2}\\right) + \\frac{\\lambda}{2} = 0\n$$\n\n$3$. $f_3 = \\frac{\\partial \\mathcal{L}}{\\partial \\lambda} = \\frac{1}{2}(y_1 + y_2) - x_{\\mathrm{A}} = 0$.\nThis simply recovers the composition constraint.\n\nTo implement Newton's method, we must also derive the Jacobian matrix $\\mathbf{J}(\\mathbf{u}) = \\frac{\\partial \\mathbf{f}}{\\partial \\mathbf{u}}$. The components $J_{ij} = \\frac{\\partial f_i}{\\partial u_j}$ are calculated as follows. For clarity, we define the interaction parameter $L_{\\mathrm{AB}} = G_{\\mathrm{A}:\\mathrm{A}} - G_{\\mathrm{A}:\\mathrm{B}} - G_{\\mathrm{B}:\\mathrm{A}} + G_{\\mathrm{B}:\\mathrm{B}}$.\n\n$J_{11} = \\frac{\\partial f_1}{\\partial y_1} = RT \\frac{\\partial}{\\partial y_1}\\ln\\left(\\frac{y_1}{1-y_1}\\right) = RT\\left(\\frac{1}{y_1} + \\frac{1}{1-y_1}\\right) = \\frac{RT}{y_1(1-y_1)}$\n$J_{12} = \\frac{\\partial f_1}{\\partial y_2} = (G_{\\mathrm{A}:\\mathrm{A}} - G_{\\mathrm{B}:\\mathrm{A}}) - (G_{\\mathrm{A}:\\mathrm{B}} - G_{\\mathrm{B}:\\mathrm{B}}) = G_{\\mathrm{A}:\\mathrm{A}} - G_{\\mathrm{A}:\\mathrm{B}} - G_{\\mathrm{B}:\\mathrm{A}} + G_{\\mathrm{B}:\\mathrm{B}} = L_{\\mathrm{AB}}$\n$J_{13} = \\frac{\\partial f_1}{\\partial \\lambda} = \\frac{1}{2}$\n\n$J_{21} = \\frac{\\partial f_2}{\\partial y_1} = (G_{\\mathrm{A}:\\mathrm{A}} - G_{\\mathrm{A}:\\mathrm{B}}) - (G_{\\mathrm{B}:\\mathrm{A}} - G_{\\mathrm{B}:\\mathrm{B}}) = G_{\\mathrm{A}:\\mathrm{A}} - G_{\\mathrm{A}:\\mathrm{B}} - G_{\\mathrm{B}:\\mathrm{A}} + G_{\\mathrm{B}:\\mathrm{B}} = L_{\\mathrm{AB}}$\n$J_{22} = \\frac{\\partial f_2}{\\partial y_2} = RT \\frac{\\partial}{\\partial y_2}\\ln\\left(\\frac{y_2}{1-y_2}\\right) = RT\\left(\\frac{1}{y_2} + \\frac{1}{1-y_2}\\right) = \\frac{RT}{y_2(1-y_2)}$\n$J_{23} = \\frac{\\partial f_2}{\\partial \\lambda} = \\frac{1}{2}$\n\n$J_{31} = \\frac{\\partial f_3}{\\partial y_1} = \\frac{1}{2}$\n$J_{32} = \\frac{\\partial f_3}{\\partial y_2} = \\frac{1}{2}$\n$J_{33} = \\frac{\\partial f_3}{\\partial \\lambda} = 0$\n\nThe complete Jacobian matrix is:\n$$\n\\mathbf{J}(\\mathbf{u}) = \\begin{pmatrix}\n\\frac{RT}{y_1(1-y_1)} & L_{\\mathrm{AB}} & \\frac{1}{2} \\\\\nL_{\\mathrm{AB}} & \\frac{RT}{y_2(1-y_2)} & \\frac{1}{2} \\\\\n\\frac{1}{2} & \\frac{1}{2} & 0\n\\end{pmatrix}\n$$\nThe symmetry of the upper-left $2 \\times 2$ block ($J_{12} = J_{21}$) is a consequence of Maxwell's relations, as it forms the Hessian of the Gibbs energy function.\n\nThe numerical solution proceeds via Newton's method. Starting from an initial guess $\\mathbf{u}^{(0)}$, each iteration $k$ computes a correction $\\Delta \\mathbf{u}^{(k)}$ by solving the linear system $\\mathbf{J}(\\mathbf{u}^{(k)}) \\Delta \\mathbf{u}^{(k)} = -\\mathbf{f}(\\mathbf{u}^{(k)})$. A new estimate is found via $\\mathbf{u}^{(k+1)} = \\mathbf{u}^{(k)} + \\alpha \\Delta \\mathbf{u}^{(k)}$, where $\\alpha \\in (0, 1]$ is a step size determined by a backtracking line search. The line search reduces $\\alpha$ (e.g., by halving) until the proposed step results in physically meaningful site fractions (i.e., $y_1, y_2 \\in (0, 1)$) and promotes convergence, which is practically achieved by requiring a decrease in the norm of the residual vector $\\|\\mathbf{f}\\|_2$. For numerical stability, site fractions are clamped to a small interval $[\\epsilon, 1-\\epsilon]$ when evaluating logarithmic and denominator terms. The process continues until the specified convergence criteria on the residual norm and step size are met, or a maximum number of iterations is reached.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to solve the equilibrium problem for all test cases.\n    \"\"\"\n\n    # Define test cases as a list of tuples.\n    # Each tuple: (T, xA, (G_AA, G_AB, G_BA, G_BB))\n    test_cases = [\n        (1000.0, 0.5, (2000.0, 0.0, 0.0, 2000.0)),\n        (5000.0, 0.5, (2000.0, 0.0, 0.0, 2000.0)),\n        (1200.0, 0.6, (2000.0, 0.0, 0.0, 2000.0)),\n        (1200.0, 0.01, (2000.0, 0.0, 0.0, 2000.0)),\n        (800.0, 0.3, (0.0, 0.0, 0.0, 0.0)),\n    ]\n\n    results = []\n    for case in test_cases:\n        T, xA, G_params = case\n        yA_alpha, yA_beta = find_equilibrium(T, xA, G_params)\n        results.append(yA_alpha)\n        results.append(yA_beta)\n\n    # Format the final output string according to the problem specification.\n    # Note: Using f-string formatting to ensure exactly 8 decimal places.\n    output_str = \"[\" + \",\".join(f\"{x:.8f}\" for x in results) + \"]\"\n    print(output_str)\n\ndef find_equilibrium(T, xA, G_params):\n    \"\"\"\n    Calculates the equilibrium site fractions for a two-sublattice model\n    using Newton's method with a backtracking line search.\n\n    Args:\n        T (float): Temperature in Kelvin.\n        xA (float): Overall mole fraction of component A.\n        G_params (tuple): Endmember energies (G_AA, G_AB, G_BA, G_BB) in J/mol.\n\n    Returns:\n        tuple: A tuple containing the equilibrium site fractions (yA_alpha, yA_beta).\n    \"\"\"\n\n    # --- Constants and settings ---\n    R = 8.314462618  # Universal gas constant in J/mol/K\n    EPS = 1e-12      # Small number for clamping and bounds\n    RES_TOL = 1e-10  # Convergence tolerance for residual norm\n    STEP_TOL = 1e-12 # Convergence tolerance for step norm\n    MAX_ITER = 100   # Maximum number of Newton iterations\n    \n    G_AA, G_AB, G_BA, G_BB = G_params\n    L_AB = G_AA - G_AB - G_BA + G_BB  # Interaction parameter\n\n    # --- Initial guess ---\n    # Per the problem description\n    y1_0 = np.clip(xA + 0.1, EPS, 1.0 - EPS)\n    y2_0 = np.clip(2.0 * xA - y1_0, EPS, 1.0 - EPS)\n    u = np.array([y1_0, y2_0, 0.0], dtype=np.float64)  # u = [y1, y2, lambda]\n\n    # --- Newton-Raphson iteration loop ---\n    for _ in range(MAX_ITER):\n        y1, y2, lam = u\n\n        # Clamp site fractions for safe evaluation of logarithms and denominators\n        y1_c = np.clip(y1, EPS, 1.0 - EPS)\n        y2_c = np.clip(y2, EPS, 1.0 - EPS)\n\n        # Build the residual vector f(u)\n        f = np.zeros(3, dtype=np.float64)\n        f[0] = y2 * (G_AA - G_BA) + (1.0 - y2) * (G_AB - G_BB) \\\n               + R * T * np.log(y1_c / (1.0 - y1_c)) + lam / 2.0\n        f[1] = y1 * (G_AA - G_AB) + (1.0 - y1) * (G_BA - G_BB) \\\n               + R * T * np.log(y2_c / (1.0 - y2_c)) + lam / 2.0\n        f[2] = 0.5 * (y1 + y2) - xA\n\n        res_norm = np.linalg.norm(f)\n        if res_norm <= RES_TOL:\n            break\n\n        # Build the Jacobian matrix J(u)\n        J = np.zeros((3, 3), dtype=np.float64)\n        J[0, 0] = R * T / (y1_c * (1.0 - y1_c))\n        J[0, 1] = L_AB\n        J[0, 2] = 0.5\n        J[1, 0] = L_AB\n        J[1, 1] = R * T / (y2_c * (1.0 - y2_c))\n        J[1, 2] = 0.5\n        J[2, 0] = 0.5\n        J[2, 1] = 0.5\n        J[2, 2] = 0.0\n\n        # Solve the linear system J * du = -f for the Newton step du\n        try:\n            du = np.linalg.solve(J, -f)\n        except np.linalg.LinAlgError:\n            # Jacobian is singular, cannot proceed.\n            break\n\n        if np.max(np.abs(du)) <= STEP_TOL:\n            break\n        \n        # --- Backtracking line search ---\n        alpha = 1.0\n        u_current = u\n        f_norm_current = res_norm\n        \n        for _ in range(10): # Max 10 backtracking steps\n            u_next = u_current + alpha * du\n            y1_next, y2_next, lam_next = u_next\n            \n            # 1. Check if next site fractions are in the physical domain (0, 1)\n            if EPS < y1_next < 1.0 - EPS and EPS < y2_next < 1.0 - EPS:\n                # 2. Check for sufficient decrease in residual norm to promote convergence\n                y1_next_c = np.clip(y1_next, EPS, 1.0 - EPS)\n                y2_next_c = np.clip(y2_next, EPS, 1.0 - EPS)\n                \n                f_next = np.zeros(3, dtype=np.float64)\n                f_next[0] = y2_next * (G_AA - G_BA) + (1.0 - y2_next) * (G_AB - G_BB) \\\n                            + R * T * np.log(y1_next_c / (1.0 - y1_next_c)) + lam_next / 2.0\n                f_next[1] = y1_next * (G_AA - G_AB) + (1.0 - y1_next) * (G_BA - G_BB) \\\n                            + R * T * np.log(y2_next_c / (1.0 - y2_next_c)) + lam_next / 2.0\n                f_next[2] = 0.5 * (y1_next + y2_next) - xA\n                \n                if np.linalg.norm(f_next) < f_norm_current:\n                    u = u_next\n                    break # Good step found, exit line search\n            \n            alpha /= 2.0\n        else: # If loop finishes without break, line search may have failed\n            # If no valid step was found, we halt the iteration for this case.\n            break\n\n    return u[0], u[1]\n\n# Execute the main function when the script is run.\nif __name__ == \"__main__\":\n    solve()\n\n```", "id": "2471384"}]}