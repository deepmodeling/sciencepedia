{"hands_on_practices": [{"introduction": "The lines on a Pourbaix diagram that separate stability regions are not arbitrary; they are quantitative plots of thermodynamic equilibrium conditions. This first exercise takes you back to first principles, asking you to derive the slope of the most fundamental boundaries in any aqueous system: the stability limits of water itself. Mastering this derivation [@problem_id:2515014] is key to understanding how any proton-coupled redox reaction is represented on an $E$-pH diagram.", "problem": "A water Pourbaix diagram delineates the potential ($E$) and acidity ($\\mathrm{pH}$) ranges where liquid water is thermodynamically stable against reduction to hydrogen gas and oxidation to oxygen gas. The bounding half-reactions in acidic aqueous solution, written as reductions, are\n- $2\\,\\mathrm{H}^{+} + 2\\,e^{-} \\rightleftharpoons \\mathrm{H}_{2}(g)$,\n- $\\mathrm{O}_{2}(g) + 4\\,\\mathrm{H}^{+} + 4\\,e^{-} \\rightleftharpoons 2\\,\\mathrm{H}_{2}\\mathrm{O}(\\ell)$.\n\nAssume ideal behavior for the aqueous protons such that $a_{\\mathrm{H}^{+}} \\approx 10^{-\\mathrm{pH}}$, unit activity for liquid water, and unit fugacity for the gases at their standard state. Let the electrode potential $E$ be referenced to the Standard Hydrogen Electrode (SHE), and let $\\mathrm{pH} = -\\log_{10} a_{\\mathrm{H}^{+}}$. Use as fundamental input the Nernst equation for a general half-reaction and the definitions of chemical activity and $\\mathrm{pH}$. Take the temperature to be $T = 298.15\\,\\mathrm{K}$, the universal gas constant to be $R = 8.314462618\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$, and the Faraday constant to be $F = 96485.33212\\,\\mathrm{C\\,mol^{-1}}$.\n\n(a) Starting from first principles, derive the $\\mathrm{pH}$-dependence of $E$ for each of the two water stability half-reactions above and show that the slope $\\mathrm{d}E/\\mathrm{d}(\\mathrm{pH})$ is the same for both. Your derivation must explicitly connect the stoichiometric coefficient of $\\mathrm{H}^{+}$ and the electron count $n$ in the Nernst equation to the $\\mathrm{pH}$-slope.\n\n(b) Evaluate this common slope numerically at $T = 298.15\\,\\mathrm{K}$. Express your final result as a single real number in volts per $\\mathrm{pH}$ unit. Round your final answer to four significant figures. Do not write units in your final boxed answer; elsewhere, report the units as volts per $\\mathrm{pH}$ unit.", "solution": "The problem presented is a standard exercise in fundamental electrochemistry and is entirely valid. It requires the derivation of the potential-pH relationship for the stability limits of water from the Nernst equation. We will proceed with a rigorous derivation.\n\n(a) Derivation of the $\\mathrm{pH}$-dependence of $E$ and the common slope.\n\nThe analysis begins with the Nernst equation for a general electrochemical half-reaction at a temperature $T$:\n$$ \\mathrm{Ox} + n e^{-} \\rightleftharpoons \\mathrm{Red} $$\nwhere $\\mathrm{Ox}$ represents the oxidized species, $\\mathrm{Red}$ the reduced species, and $n$ is the number of electrons transferred. The electrode potential $E$ relative to the Standard Hydrogen Electrode (SHE) is given by:\n$$ E = E^{\\circ} - \\frac{RT}{nF} \\ln Q $$\nHere, $E^{\\circ}$ is the standard electrode potential, $R$ is the universal gas constant, $F$ is the Faraday constant, and $Q$ is the reaction quotient, defined by the activities ($a_i$) of the participating species, $Q = \\frac{\\prod a_{\\mathrm{Red}}^{|\\nu_{\\mathrm{Red}}|}}{\\prod a_{\\mathrm{Ox}}^{|\\nu_{\\mathrm{Ox}}|}}$.\n\nMany half-reactions, including those defining the stability of water, involve protons, $\\mathrm{H}^{+}$. We consider a general form for such a reaction written as a reduction:\n$$ \\alpha\\,\\mathrm{Ox} + m\\,\\mathrm{H}^{+} + n\\,e^{-} \\rightleftharpoons \\beta\\,\\mathrm{Red} + w\\,\\mathrm{H}_{2}\\mathrm{O} $$\nThe reaction quotient for this general process is:\n$$ Q = \\frac{a_{\\mathrm{Red}}^{\\beta} \\, a_{\\mathrm{H}_{2}\\mathrm{O}}^{w}}{a_{\\mathrm{Ox}}^{\\alpha} \\, a_{\\mathrm{H}^{+}}^{m}} $$\nSubstituting this into the Nernst equation yields:\n$$ E = E^{\\circ} - \\frac{RT}{nF} \\ln \\left( \\frac{a_{\\mathrm{Red}}^{\\beta} \\, a_{\\mathrm{H}_{2}\\mathrm{O}}^{w}}{a_{\\mathrm{Ox}}^{\\alpha} \\, a_{\\mathrm{H}^{+}}^{m}} \\right) $$\nThis expression can be rearranged using the properties of the logarithm:\n$$ E = E^{\\circ} - \\frac{RT}{nF} \\left( \\ln(a_{\\mathrm{Red}}^{\\beta}) + \\ln(a_{\\mathrm{H}_{2}\\mathrm{O}}^{w}) - \\ln(a_{\\mathrm{Ox}}^{\\alpha}) - \\ln(a_{\\mathrm{H}^{+}}^{m}) \\right) $$\n$$ E = E^{\\circ} - \\frac{RT}{nF} \\ln \\left( \\frac{a_{\\mathrm{Red}}^{\\beta} \\, a_{\\mathrm{H}_{2}\\mathrm{O}}^{w}}{a_{\\mathrm{Ox}}^{\\alpha}} \\right) + \\frac{mRT}{nF} \\ln(a_{\\mathrm{H}^{+}}) $$\nThe problem defines $\\mathrm{pH} = -\\log_{10}(a_{\\mathrm{H}^{+}})$. We must convert the natural logarithm to base-$10$: $\\ln(x) = (\\ln 10) \\log_{10}(x)$. Thus, $\\ln(a_{\\mathrm{H}^{+}}) = (\\ln 10) \\log_{10}(a_{\\mathrm{H}^{+}}) = -(\\ln 10)\\,\\mathrm{pH}$. Substituting this gives the potential as a function of $\\mathrm{pH}$:\n$$ E = E^{\\circ} - \\frac{RT}{nF} \\ln \\left( \\frac{a_{\\mathrm{Red}}^{\\beta} \\, a_{\\mathrm{H}_{2}\\mathrm{O}}^{w}}{a_{\\mathrm{Ox}}^{\\alpha}} \\right) - \\frac{m}{n} \\frac{RT\\ln 10}{F} \\mathrm{pH} $$\nFor the stability lines of a Pourbaix diagram, the activities of all species except $\\mathrm{H}^{+}$ are taken to be unity. That is, $a_{\\mathrm{Ox}} = 1$, $a_{\\mathrm{Red}} = 1$, and $a_{\\mathrm{H}_{2}\\mathrm{O}} = 1$. Under these standard conditions, the equation simplifies to:\n$$ E = E^{\\circ} - \\frac{m}{n} \\frac{RT\\ln 10}{F} \\mathrm{pH} $$\nThe slope of the potential with respect to $\\mathrm{pH}$ is the derivative $\\frac{\\mathrm{d}E}{\\mathrm{d}(\\mathrm{pH})}$. From the equation above, it is immediately clear that:\n$$ \\frac{\\mathrm{d}E}{\\mathrm{d}(\\mathrm{pH})} = -\\frac{m}{n} \\frac{RT\\ln 10}{F} $$\nThis result explicitly connects the slope to the stoichiometric coefficient of protons, $m$, and the number of electrons transferred, $n$.\n\nNow, we apply this general formula to the two specific half-reactions provided.\n\n1.  **Reduction of $\\mathrm{H}^{+}$ to $\\mathrm{H}_{2}(g)$:**\n    $$ 2\\,\\mathrm{H}^{+} + 2\\,e^{-} \\rightleftharpoons \\mathrm{H}_{2}(g) $$\n    For this reaction, the stoichiometric coefficient of $\\mathrm{H}^{+}$ is $m=2$, and the number of electrons is $n=2$. The ratio is $\\frac{m}{n} = \\frac{2}{2} = 1$. The standard potential is $E^{\\circ}_{\\mathrm{H}^{+}/\\mathrm{H}_{2}} = 0\\,\\mathrm{V}$ by definition. The potential for this boundary is:\n    $$ E_{\\mathrm{H}_{2}} = 0 - \\frac{2}{2} \\frac{RT\\ln 10}{F} \\mathrm{pH} = - \\frac{RT\\ln 10}{F} \\mathrm{pH} $$\n    The slope is:\n    $$ \\frac{\\mathrm{d}E_{\\mathrm{H}_{2}}}{\\mathrm{d}(\\mathrm{pH})} = -\\frac{RT\\ln 10}{F} $$\n\n2.  **Reduction of $\\mathrm{O}_{2}(g)$ to $\\mathrm{H}_{2}\\mathrm{O}(\\ell)$:**\n    $$ \\mathrm{O}_{2}(g) + 4\\,\\mathrm{H}^{+} + 4\\,e^{-} \\rightleftharpoons 2\\,\\mathrm{H}_{2}\\mathrm{O}(\\ell) $$\n    For this reaction, the stoichiometric coefficient of $\\mathrm{H}^{+}$ is $m=4$, and the number of electrons is $n=4$. The ratio is $\\frac{m}{n} = \\frac{4}{4} = 1$. Let the standard potential be $E^{\\circ}_{\\mathrm{O}_{2}/\\mathrm{H}_{2}\\mathrm{O}}$. The potential for this boundary is:\n    $$ E_{\\mathrm{O}_{2}} = E^{\\circ}_{\\mathrm{O}_{2}/\\mathrm{H}_{2}\\mathrm{O}} - \\frac{4}{4} \\frac{RT\\ln 10}{F} \\mathrm{pH} = E^{\\circ}_{\\mathrm{O}_{2}/\\mathrm{H}_{2}\\mathrm{O}} - \\frac{RT\\ln 10}{F} \\mathrm{pH} $$\n    The slope is:\n    $$ \\frac{\\mathrm{d}E_{\\mathrm{O}_{2}}}{\\mathrm{d}(\\mathrm{pH})} = -\\frac{RT\\ln 10}{F} $$\n\nBoth slopes are identical, as was to be shown. The reason for this identity is that the ratio of protons consumed to electrons transferred, $\\frac{m}{n}$, is unity for both half-reactions that define the stability window of water. This completes the derivation for part (a).\n\n(b) Numerical evaluation of the common slope.\n\nThe common slope is given by the expression $S = -\\frac{RT\\ln 10}{F}$. We substitute the given physical constants:\n$T = 298.15\\,\\mathrm{K}$\n$R = 8.314462618\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$\n$F = 96485.33212\\,\\mathrm{C\\,mol^{-1}}$\n\nThe calculation proceeds as follows:\n$$ S = - \\frac{(8.314462618\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}) \\times (298.15\\,\\mathrm{K}) \\times \\ln(10)}{96485.33212\\,\\mathrm{C\\,mol^{-1}}} $$\nThe term $\\ln(10) \\approx 2.30258509$.\nThe units of the expression are $\\mathrm{J\\,C^{-1}}$, which is a volt ($\\mathrm{V}$). Thus, the slope has units of volts per $\\mathrm{pH}$ unit.\n$$ S = - \\frac{8.314462618 \\times 298.15 \\times 2.30258509}{96485.33212} \\, \\mathrm{V} $$\n$$ S \\approx - \\frac{5706.059}{96485.33212} \\, \\mathrm{V} $$\n$$ S \\approx -0.05915984... \\, \\mathrm{V} $$\nThe problem requires the answer to be rounded to four significant figures.\n$$ S \\approx -0.05916 \\, \\mathrm{V} $$\nThis value is a fundamental constant in room-temperature electrochemistry, often referred to as the Nernstian slope for a one-proton, one-electron process.", "answer": "$$\n\\boxed{-0.05916}\n$$", "id": "2515014"}, {"introduction": "While many boundaries in Pourbaix diagrams are sloped, indicating a dependence on both potential and pH, many important transformations are purely chemical. This practice explores the equilibrium between a dissolved metal ion and its solid hydroxide precipitate, a reaction that does not involve a change in oxidation state. By working through this problem [@problem_id:2515034], you will learn how to derive the vertical lines in a Pourbaix diagram that represent precipitation and dissolution fronts, governed by solubility products ($K_{sp}$) and pH.", "problem": "A trivalent metal $\\mathrm{M}$ in water at temperature $T = 298.15\\ \\mathrm{K}$ exhibits the solid hydroxide phase $\\mathrm{M(OH)_3(s)}$ and the aqueous cation $\\mathrm{M^{3+}}$. At infinite dilution (activity coefficients taken as unity), the dissolution equilibrium of the hydroxide is governed by the solubility product,\n$$K_{\\mathrm{sp}} = a_{\\mathrm{M^{3+}}}\\,a_{\\mathrm{OH^{-}}}^{3}.$$\nWater autoprotolysis satisfies\n$$K_{\\mathrm{w}} = a_{\\mathrm{H^{+}}}\\,a_{\\mathrm{OH^{-}}},$$\nwith $pK_{\\mathrm{w}} = -\\log_{10} K_{\\mathrm{w}} = 14.00$ at $T = 298.15\\ \\mathrm{K}$. The potential scale is referenced to the Standard Hydrogen Electrode (SHE), defined by the half-reaction $\\mathrm{H}^{+} + \\mathrm{e}^{-} \\rightleftharpoons \\tfrac{1}{2}\\mathrm{H}_2$ at $p_{\\mathrm{H}_2}=1\\ \\mathrm{bar}$, with the Nernst relation\n$$E = E^{\\circ}_{\\mathrm{SHE}} - \\frac{R T}{F}\\ln\\!\\left(\\frac{a_{\\mathrm{H^{+}}}}{p_{\\mathrm{H_2}}^{1/2}}\\right),$$\nand $E^{\\circ}_{\\mathrm{SHE}} \\equiv 0\\ \\mathrm{V}$ by convention at $a_{\\mathrm{H}^{+}}=1$ and $p_{\\mathrm{H}_2}=1\\ \\mathrm{bar}$.\n\nUsing only fundamental thermodynamics and the law of mass action for chemical equilibria and the Nernst equation for redox equilibria, derive the expression for the boundary between $\\mathrm{M(OH)_3(s)}$ and $\\mathrm{M^{3+}}$ in the potential–pH plane. Clarify whether the boundary depends on $E$ and obtain a closed-form expression for the characteristic $pH^{\\star}$ at which $\\mathrm{M(OH)_3(s)}$ and $\\mathrm{M^{3+}}$ are in equilibrium for a fixed activity $a_{\\mathrm{M^{3+}}}$. Then evaluate $pH^{\\star}$ numerically for the following data, assuming $a_{\\mathrm{M(OH)_3(s)}}=1$ and $a_{\\mathrm{H_2O}}=1$:\n- $K_{\\mathrm{sp}} = 3.7 \\times 10^{-38.1}$,\n- $K_{\\mathrm{w}} = 1.0 \\times 10^{-14}$,\n- $a_{\\mathrm{M^{3+}}} = 4.0 \\times 10^{-7}$,\n- $p_{\\mathrm{H_2}}=1\\ \\mathrm{bar}$.\n\nExpress $pH^{\\star}$ as a pure number, and round your final result to four significant figures.", "solution": "The problem presented is a standard exercise in aqueous chemical thermodynamics. It is well-posed, scientifically grounded, and contains all necessary information for a unique solution. We shall proceed with the derivation.\n\nThe primary task is to determine the boundary separating the regions of stability for the solid hydroxide $\\mathrm{M(OH)_3(s)}$ and the aqueous trivalent cation $\\mathrm{M^{3+}}$. This boundary represents the locus of points in the potential–pH plane where these two species are in equilibrium.\n\nThe governing chemical reaction for this equilibrium is the dissolution of the solid hydroxide:\n$$ \\mathrm{M(OH)_3(s) \\rightleftharpoons M^{3+}(aq) + 3OH^{-}(aq)} $$\nWe must first ascertain if this equilibrium depends on the electrochemical potential, $E$. The oxidation state of the metal $\\mathrm{M}$ in the solid hydroxide $\\mathrm{M(OH)_3(s)}$ is $+3$. The oxidation state of the metal in the aqueous cation $\\mathrm{M^{3+}}$ is also $+3$. As there is no change in the oxidation state of the metal species across this equilibrium, there is no transfer of electrons. Consequently, the equilibrium condition is independent of the electrochemical potential $E$. The boundary between $\\mathrm{M(OH)_3(s)}$ and $\\mathrm{M^{3+}}$ in a Pourbaix diagram ($E$ versus pH) is a vertical line, meaning its position is defined by a constant pH value, which we shall denote as $pH^{\\star}$. The information regarding the Standard Hydrogen Electrode (SHE) is necessary context for constructing a full Pourbaix diagram but is not required for calculating this specific boundary.\n\nTo find $pH^{\\star}$, we apply the law of mass action to the dissolution equilibrium. The expression for the solubility product, $K_{\\mathrm{sp}}$, is given as:\n$$ K_{\\mathrm{sp}} = a_{\\mathrm{M^{3+}}} a_{\\mathrm{OH^{-}}}^{3} $$\nHere, $a_{\\mathrm{M^{3+}}}$ is the activity of the metal cation and $a_{\\mathrm{OH^{-}}}$ is the activity of the hydroxide ion. The activity of the pure solid, $a_{\\mathrm{M(OH)_3(s)}}$, is taken as unity and is thus correctly omitted from the expression.\n\nThe activity of hydroxide ions, $a_{\\mathrm{OH^{-}}}$, is related to the activity of hydrogen ions, $a_{\\mathrm{H^{+}}}$, through the autoprotolysis equilibrium of water:\n$$ \\mathrm{H_2O(l) \\rightleftharpoons H^{+}(aq) + OH^{-}(aq)} $$\nThe corresponding ion product of water, $K_{\\mathrm{w}}$, is:\n$$ K_{\\mathrm{w}} = a_{\\mathrm{H^{+}}} a_{\\mathrm{OH^{-}}} $$\nFrom this, we can express $a_{\\mathrm{OH^{-}}}$ as:\n$$ a_{\\mathrm{OH^{-}}} = \\frac{K_{\\mathrm{w}}}{a_{\\mathrm{H^{+}}}} $$\nSubstituting this into the expression for $K_{\\mathrm{sp}}$ yields the equilibrium condition in terms of $a_{\\mathrm{H^{+}}}$:\n$$ K_{\\mathrm{sp}} = a_{\\mathrm{M^{3+}}} \\left( \\frac{K_{\\mathrm{w}}}{a_{\\mathrm{H^{+}}}} \\right)^{3} = \\frac{a_{\\mathrm{M^{3+}}} K_{\\mathrm{w}}^{3}}{a_{\\mathrm{H^{+}}}^{3}} $$\nThis equation defines the boundary. We can solve for $a_{\\mathrm{H^{+}}}$:\n$$ a_{\\mathrm{H^{+}}}^{3} = \\frac{a_{\\mathrm{M^{3+}}} K_{\\mathrm{w}}^{3}}{K_{\\mathrm{sp}}} $$\n$$ a_{\\mathrm{H^{+}}} = \\left( \\frac{a_{\\mathrm{M^{3+}}} K_{\\mathrm{w}}^{3}}{K_{\\mathrm{sp}}} \\right)^{1/3} $$\nBy definition, $\\mathrm{pH} = -\\log_{10}(a_{\\mathrm{H^{+}}})$. Taking the negative base-$10$ logarithm of both sides gives the expression for the characteristic pH, $pH^{\\star}$:\n$$ pH^{\\star} = -\\log_{10}\\left[ \\left( \\frac{a_{\\mathrm{M^{3+}}} K_{\\mathrm{w}}^{3}}{K_{\\mathrm{sp}}} \\right)^{1/3} \\right] $$\n$$ pH^{\\star} = -\\frac{1}{3} \\log_{10}\\left( \\frac{a_{\\mathrm{M^{3+}}} K_{\\mathrm{w}}^{3}}{K_{\\mathrm{sp}}} \\right) $$\nUsing the properties of logarithms, this simplifies to:\n$$ pH^{\\star} = -\\frac{1}{3} \\left( \\log_{10}(a_{\\mathrm{M^{3+}}}) + 3\\log_{10}(K_{\\mathrm{w}}) - \\log_{10}(K_{\\mathrm{sp}}) \\right) $$\nRecalling that $pK_{\\mathrm{w}} = -\\log_{10}(K_{\\mathrm{w}})$, we can write a more elegant form:\n$$ pH^{\\star} = \\frac{1}{3}\\log_{10}(K_{\\mathrm{sp}}) - \\frac{1}{3}\\log_{10}(a_{\\mathrm{M^{3+}}}) + pK_{\\mathrm{w}} $$\nThis is the required closed-form expression for $pH^{\\star}$.\n\nWe now proceed with the numerical evaluation using the provided data:\n- $K_{\\mathrm{sp}} = 3.7 \\times 10^{-38.1}$\n- $a_{\\mathrm{M^{3+}}} = 4.0 \\times 10^{-7}$\n- $pK_{\\mathrm{w}} = 14.00$\n\nFirst, we compute the required logarithms:\n$$ \\log_{10}(K_{\\mathrm{sp}}) = \\log_{10}(3.7 \\times 10^{-38.1}) = \\log_{10}(3.7) - 38.1 \\approx 0.56820 - 38.1 = -37.53180 $$\n$$ \\log_{10}(a_{\\mathrm{M^{3+}}}) = \\log_{10}(4.0 \\times 10^{-7}) = \\log_{10}(4.0) - 7 \\approx 0.60206 - 7 = -6.39794 $$\nNow substitute these values into the expression for $pH^{\\star}$:\n$$ pH^{\\star} = \\frac{1}{3}(-37.53180) - \\frac{1}{3}(-6.39794) + 14.00 $$\n$$ pH^{\\star} \\approx -12.51060 + 2.13265 + 14.00 $$\n$$ pH^{\\star} \\approx 3.62205 $$\nThe problem requires the result to be rounded to four significant figures. Therefore, the numerical value for $pH^{\\star}$ is $3.622$.", "answer": "$$\\boxed{3.622}$$", "id": "2515034"}, {"introduction": "Real-world aqueous systems rarely involve a single, simple equilibrium. This advanced computational exercise challenges you to synthesize the concepts of redox potential, hydrolysis, mass balance, and electroneutrality into a unified model. You will design an algorithm to calculate the complete speciation of a metal in solution, accounting for the non-ideal interactions between ions using activity corrections [@problem_id:2515057]. This practice provides a direct, hands-on experience with the powerful iterative methods at the heart of modern geochemical and corrosion modeling software.", "problem": "You are tasked with implementing a computational algorithm to compute aqueous speciation for a redox-active metal across a set of points in electric potential–pH space while enforcing electroneutrality and total mass balance with activity corrections. The system is an aqueous solution at temperature $T=298.15\\ \\mathrm{K}$ containing a trivalent metal undergoing one-electron reduction to a divalent state and stepwise hydrolysis in water. The algorithm must be derived and implemented from the following foundational laws and definitions, without relying on any shortcuts beyond these statements:\n\n- Mass action for chemical equilibria with activities: if the reaction is written with water as solvent and pure liquid, the equilibrium constant $K$ uses only solute activities.\n- The Nernst equation: for the reduction half-reaction $\\mathrm{M}^{3+} + \\mathrm{e}^- \\rightleftharpoons \\mathrm{M}^{2+}$, the potential satisfies $E = E^\\circ - \\dfrac{RT}{F} \\ln Q$ with $Q = \\dfrac{a_{\\mathrm{M}^{2+}}}{a_{\\mathrm{M}^{3+}}}$, where $R$ is the universal gas constant and $F$ is the Faraday constant.\n- Electroneutrality: the sum of charge-weighted molar concentrations of all charged species in solution is zero.\n- Total mass balance on the metal: the sum of molar concentrations of all metal-containing species equals the total analytical metal concentration.\n- Activity–concentration relationship: $a_i = \\gamma_i c_i$, where $a_i$ is activity, $c_i$ is molar concentration, and $\\gamma_i$ is the activity coefficient.\n- Davies equation for activity coefficients at ionic strength $I$: $\\log_{10} \\gamma_i = -A z_i^2\\left(\\dfrac{\\sqrt{I}}{1+\\sqrt{I}} - 0.3 I \\right)$ for ions of charge $z_i$, with $A=0.509$ for water at $T=298.15\\ \\mathrm{K}$; for neutral species, $\\gamma_i=1$.\n- Ionic strength definition: $I = \\dfrac{1}{2}\\sum_i z_i^2 c_i$ over all charged species.\n- Hydrogen ion definition of pH: $\\mathrm{pH} = -\\log_{10} a_{\\mathrm{H}^+}$.\n- Water autoprotolysis in terms of activities: $K_w = a_{\\mathrm{H}^+} a_{\\mathrm{OH}^-}$.\n\nModel system and parameters:\n- Half-reaction and standard potential: $\\mathrm{M}^{3+} + \\mathrm{e}^- \\rightleftharpoons \\mathrm{M}^{2+}$ with $E^\\circ = 0.771\\ \\mathrm{V}$ at $T=298.15\\ \\mathrm{K}$.\n- Hydrolysis equilibria at $T=298.15\\ \\mathrm{K}$ (activities):\n  1. $\\mathrm{M}^{3+} + \\mathrm{H_2O} \\rightleftharpoons \\mathrm{M(OH)}^{2+} + \\mathrm{H}^+$ with $K_1 = 10^{-2.19}$.\n  2. $\\mathrm{M(OH)}^{2+} + \\mathrm{H_2O} \\rightleftharpoons \\mathrm{M(OH)}_2^{+} + \\mathrm{H}^+$ with $K_2 = 10^{-3.50}$.\n  3. $\\mathrm{M(OH)}_2^{+} + \\mathrm{H_2O} \\rightleftharpoons \\mathrm{M(OH)}_3^{0} + \\mathrm{H}^+$ with $K_3 = 10^{-6.00}$.\n- Water ion product: $K_w = 10^{-14}$ (in activities).\n- Constants: $R = 8.314462618\\ \\mathrm{J\\ mol^{-1}\\ K^{-1}}$, $F = 96485.33212\\ \\mathrm{C\\ mol^{-1}}$, $A=0.509$ (Davies constant at $T=298.15\\ \\mathrm{K}$).\n\nUnknown aqueous species to compute at each $(E,\\mathrm{pH})$:\n- $\\mathrm{M}^{3+}$, $\\mathrm{M}^{2+}$, $\\mathrm{M(OH)}^{2+}$, $\\mathrm{M(OH)}_2^{+}$, $\\mathrm{M(OH)}_3^{0}$, $\\mathrm{H}^+$, $\\mathrm{OH}^-$, and a single non-reactive background counter-ion added as needed to enforce electroneutrality, with charge $z_{\\mathrm{bal}} \\in \\{+1,-1\\}$ and concentration $c_{\\mathrm{bal}} \\ge 0$ chosen such that total charge is exactly zero.\n\nAlgorithmic requirements:\n- Treat $\\mathrm{pH}$ as the negative base-$10$ logarithm of the hydrogen ion activity: $a_{\\mathrm{H}^+} = 10^{-\\mathrm{pH}}$.\n- Use the Davies equation to compute ionic activity coefficients $\\gamma_i$ self-consistently with the ionic strength $I$. Because $I$ depends on all charged species concentrations and those depend on $\\gamma_i$, you must perform a fixed-point iteration on $I$ until convergence.\n- At each iteration, enforce total metal mass balance exactly and electroneutrality exactly by adding the single background counter-ion of appropriate sign. The ionic strength must be recomputed including this background ion before the next iteration of the activity coefficients.\n- For the redox couple, enforce the Nernst relation between activities, not concentrations. For hydrolysis, enforce mass action using activities, assuming the activity of water is unity.\n\nDerivation targets to use in your implementation:\n- From the Nernst equation, derive the activity ratio $r = \\dfrac{a_{\\mathrm{M}^{2+}}}{a_{\\mathrm{M}^{3+}}} = \\exp\\!\\left(-\\dfrac{(E - E^\\circ)F}{RT}\\right)$.\n- From hydrolysis step equilibria, derive $a_{\\mathrm{M(OH)}^{2+}} = \\dfrac{K_1 a_{\\mathrm{M}^{3+}}}{a_{\\mathrm{H}^+}}$, $a_{\\mathrm{M(OH)}_2^{+}} = \\dfrac{K_1 K_2 a_{\\mathrm{M}^{3+}}}{a_{\\mathrm{H}^+}^2}$, and $a_{\\mathrm{M(OH)}_3^{0}} = \\dfrac{K_1 K_2 K_3 a_{\\mathrm{M}^{3+}}}{a_{\\mathrm{H}^+}^3}$.\n- Use $a_i = \\gamma_i c_i$ to convert to concentrations and enforce the total metal balance $C_{\\mathrm{M,tot}} = c_{\\mathrm{M}^{3+}} + c_{\\mathrm{M}^{2+}} + c_{\\mathrm{M(OH)}^{2+}} + c_{\\mathrm{M(OH)}_2^{+}} + c_{\\mathrm{M(OH)}_3^{0}}$ to solve for $a_{\\mathrm{M}^{3+}}$ explicitly.\n- Enforce electroneutrality by setting the background ion concentration to be precisely the magnitude of the net charge of all other species with opposite sign at each iteration.\n- Iterate until the ionic strength $I$ converges within a strict tolerance.\n\nTest suite:\nImplement your algorithm for the following input cases, each specified by a tuple $(\\mathrm{pH}, E\\ \\mathrm{(V)}, C_{\\mathrm{M,tot}}\\ \\mathrm{(mol\\ L^{-1})})$ at $T=298.15\\ \\mathrm{K}$:\n- Case A: $(2.0,\\ 0.30,\\ 10^{-6})$\n- Case B: $(6.0,\\ 0.771,\\ 10^{-6})$\n- Case C: $(9.0,\\ 1.00,\\ 10^{-6})$\n- Case D: $(8.0,\\ 0.20,\\ 10^{-4})$\n- Case E: $(7.0,\\ 0.771,\\ 10^{-8})$\n\nFor each case, your program must compute and return the following four quantities in order:\n1) The fraction of total dissolved metal present as $\\mathrm{M}^{2+}$, i.e., $c_{\\mathrm{M}^{2+}}/C_{\\mathrm{M,tot}}$ (dimensionless).\n2) The fraction of total dissolved metal present as the neutral species $\\mathrm{M(OH)}_3^{0}$, i.e., $c_{\\mathrm{M(OH)}_3^{0}}/C_{\\mathrm{M,tot}}$ (dimensionless).\n3) The final converged ionic strength $I$ in $\\mathrm{mol\\ L^{-1}}$.\n4) The absolute electroneutrality residual, i.e., $\\left|\\sum_i z_i c_i\\right|$ in $\\mathrm{mol\\ L^{-1}}$ after adding the background ion.\n\nFinal output format:\nYour program should produce a single line of output containing a comma-separated Python-style list of floating-point results that aggregates all cases in the order A through E, each case contributing its four results in the order above. For example, the output must look like\n\"[v1,v2,v3,v4,v5,v6,v7,v8,v9,v10,v11,v12,v13,v14,v15,v16,v17,v18,v19,v20]\"\nwith exactly $20$ entries corresponding to the five cases times four values per case. All ionic strengths and concentrations must be in $\\mathrm{mol\\ L^{-1}}$; all potentials are in $\\mathrm{V}$ by construction; fractions are dimensionless. Angles do not appear in this problem. Express fractional quantities as decimal numbers, not as percentages.", "solution": "The problem requires the computation of aqueous speciation for a redox-active metal system by solving a set of non-linear equations describing chemical equilibria. The solution is subject to constraints of mass balance and electroneutrality, with non-ideal effects accounted for using the Davies equation for activity coefficients. The specified inputs for each calculation are the potential $E$, the pH, and the total analytical concentration of the metal, $C_{\\mathrm{M,tot}}$. The temperature is fixed at $T = 298.15\\ \\mathrm{K}$.\n\nThe system of equations is highly coupled because the concentrations of species, $c_i$, determine the ionic strength, $I$, which in turn determines the activity coefficients, $\\gamma_i$, that are needed to relate activities, $a_i$, back to concentrations via $a_i = \\gamma_i c_i$ in the equilibrium expressions. This circular dependency mandates an iterative numerical approach. A fixed-point iteration on the ionic strength $I$ is specified.\n\nThe chemical system consists of the following species: $\\mathrm{M}^{3+}$, $\\mathrm{M}^{2+}$, the mononuclear hydrolysis products of $\\mathrm{M}^{3+}$ which are $\\mathrm{M(OH)}^{2+}$, $\\mathrm{M(OH)}_2^{+}$, and $\\mathrm{M(OH)}_3^{0}$, as well as $\\mathrm{H}^+$ and $\\mathrm{OH}^-$. An additional non-reactive background ion with concentration $c_{\\mathrm{bal}}$ and charge $z_{\\mathrm{bal}} \\in \\{+1, -1\\}$ is introduced to enforce perfect electroneutrality.\n\nThe iterative algorithm proceeds as follows:\n1.  Initialize the ionic strength, $I$, with a starting guess, for example $I^{(0)} = 0$.\n2.  In each iteration $k$, use the current ionic strength $I^{(k)}$ to compute the activity coefficient $\\gamma_i^{(k)}$ for each charged species $i$ with charge $z_i$ using the Davies equation:\n    $$ \\log_{10} \\gamma_i = -A z_i^2\\left(\\dfrac{\\sqrt{I}}{1+\\sqrt{I}} - 0.3 I \\right) $$\n    where $A = 0.509$. For neutral species like $\\mathrm{M(OH)}_3^{0}$, the activity coefficient is unity, $\\gamma_i = 1$. The charged species are $\\mathrm{M}^{3+}$ ($z=3$), $\\mathrm{M}^{2+}$ ($z=2$), $\\mathrm{M(OH)}^{2+}$ ($z=2$), $\\mathrm{M(OH)}_2^{+}$ ($z=1$), $\\mathrm{H}^+$ ($z=1$), $\\mathrm{OH}^-$ ($z=-1$), and the background ion ($z=\\pm 1$).\n\n3.  The activities of hydrogen and hydroxide ions are fixed by the input pH:\n    $$ a_{\\mathrm{H}^+} = 10^{-\\mathrm{pH}} $$\n    $$ a_{\\mathrm{OH}^-} = \\frac{K_w}{a_{\\mathrm{H}^+}} = \\frac{10^{-14}}{10^{-\\mathrm{pH}}} $$\n\n4.  All metal species activities are expressed relative to a single master species, $a_{\\mathrm{M}^{3+}}$.\n    The Nernst equation for the reaction $\\mathrm{M}^{3+} + \\mathrm{e}^- \\rightleftharpoons \\mathrm{M}^{2+}$ gives the activity ratio:\n    $$ r = \\frac{a_{\\mathrm{M}^{2+}}}{a_{\\mathrm{M}^{3+}}} = \\exp\\left(-\\frac{(E - E^\\circ)F}{RT}\\right) $$\n    where $E^\\circ = 0.771\\ \\mathrm{V}$, $R = 8.314462618\\ \\mathrm{J\\ mol^{-1}\\ K^{-1}}$, and $F = 96485.33212\\ \\mathrm{C\\ mol^{-1}}$.\n    \n    For the hydrolysis reactions $\\mathrm{M}^{3+} + j\\mathrm{H_2O} \\rightleftharpoons \\mathrm{M(OH)}_j^{(3-j)+} + j\\mathrm{H}^+$, the activities are related via the cumulative equilibrium constants $\\beta_j^*$:\n    - For $j=1$: $\\mathrm{M}^{3+} + \\mathrm{H_2O} \\rightleftharpoons \\mathrm{M(OH)}^{2+} + \\mathrm{H}^+$, $\\beta_1^* = K_1 = 10^{-2.19}$.\n    - For $j=2$: $\\mathrm{M}^{3+} + 2\\mathrm{H_2O} \\rightleftharpoons \\mathrm{M(OH)}_2^{+} + 2\\mathrm{H}^+$, $\\beta_2^* = K_1 K_2 = 10^{-5.69}$.\n    - For $j=3$: $\\mathrm{M}^{3+} + 3\\mathrm{H_2O} \\rightleftharpoons \\mathrm{M(OH)}_3^{0} + 3\\mathrm{H}^+$, $\\beta_3^* = K_1 K_2 K_3 = 10^{-11.69}$.\n    The activities are then:\n    $$ a_{\\mathrm{M(OH)_j^{(3-j)+}}} = \\frac{\\beta_j^* a_{\\mathrm{M}^{3+}}}{(a_{\\mathrm{H}^+})^j} \\quad \\text{for } j \\in \\{1, 2, 3\\} $$\n\n5.  The unknown activity $a_{\\mathrm{M}^{3+}}$ is determined by enforcing the total metal mass balance:\n    $$ C_{\\mathrm{M,tot}} = c_{\\mathrm{M}^{3+}} + c_{\\mathrm{M}^{2+}} + c_{\\mathrm{M(OH)}^{2+}} + c_{\\mathrm{M(OH)}_2^{+}} + c_{\\mathrm{M(OH)}_3^{0}} $$\n    Substituting $c_i = a_i/\\gamma_i$ and the expressions from step 4:\n    $$ C_{\\mathrm{M,tot}} = \\frac{a_{\\mathrm{M}^{3+}}}{\\gamma_{\\mathrm{M}^{3+}}} + \\frac{r \\cdot a_{\\mathrm{M}^{3+}}}{\\gamma_{\\mathrm{M}^{2+}}} + \\sum_{j=1}^{3} \\frac{\\beta_j^* a_{\\mathrm{M}^{3+}}}{(a_{\\mathrm{H}^+})^j \\gamma_{\\mathrm{M(OH)_j^{(3-j)+}}}} $$\n    Solving for $a_{\\mathrm{M}^{3+}}$ gives:\n    $$ a_{\\mathrm{M}^{3+}} = C_{\\mathrm{M,tot}} \\left[ \\frac{1}{\\gamma_{\\mathrm{M}^{3+}}} + \\frac{r}{\\gamma_{\\mathrm{M}^{2+}}} + \\sum_{j=1}^{3} \\frac{\\beta_j^*}{(a_{\\mathrm{H}^+})^j \\gamma_{\\mathrm{M(OH)_j^{(3-j)+}}}} \\right]^{-1} $$\n\n6.  With $a_{\\mathrm{M}^{3+}}$ known, the activities of all other metal species are calculated, and subsequently, the concentrations of all species (metal-containing, $\\mathrm{H}^+$, $\\mathrm{OH}^-$) for the current iteration $(k)$ are found using $c_i^{(k+1)} = a_i / \\gamma_i^{(k)}$.\n\n7.  Electroneutrality is enforced by calculating the net charge from all species except the background ion:\n    $$ C_{\\mathrm{net}} = \\sum_{i \\neq \\mathrm{bal}} z_i c_i = 3c_{\\mathrm{M}^{3+}} + 2c_{\\mathrm{M}^{2+}} + 2c_{\\mathrm{M(OH)}^{2+}} + c_{\\mathrm{M(OH)}_2^{+}} + c_{\\mathrm{H}^+} - c_{\\mathrm{OH}^-} $$\n    The concentration and charge of the background ion are set to perfectly balance this charge:\n    $$ c_{\\mathrm{bal}} = |C_{\\mathrm{net}}| $$\n    $$ z_{\\mathrm{bal}} = -\\mathrm{sign}(C_{\\mathrm{net}}) $$\n\n8.  A new ionic strength $I^{(k+1)}$ is calculated using the updated concentrations, including the background ion:\n    $$ I^{(k+1)} = \\frac{1}{2} \\sum_{\\text{all species}} z_i^2 c_i^{(k+1)} = \\frac{1}{2}\\left( \\sum_{i \\neq \\mathrm{bal}} z_i^2 c_i^{(k+1)} + z_{\\mathrm{bal}}^2 c_{\\mathrm{bal}} \\right) $$\n\n9.  The new value $I^{(k+1)}$ is compared to the previous value $I^{(k)}$. If $|I^{(k+1)} - I^{(k)}|$ is smaller than a specified tolerance (e.g., $10^{-15}$), the iteration has converged. Otherwise, set $I^{(k)} \\leftarrow I^{(k+1)}$ and return to step 2.\n\n10. Once convergence is achieved, the final calculated concentrations are used to compute the required output metrics for each test case: the fractional concentrations $c_{\\mathrm{M}^{2+}}/C_{\\mathrm{M,tot}}$ and $c_{\\mathrm{M(OH)}_3^{0}}/C_{\\mathrm{M,tot}}$, the final converged ionic strength $I$, and the absolute electroneutrality residual $|\\sum_i z_i c_i|$, which serves as a numerical verification and is expected to be nearly zero by construction.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes aqueous speciation for a redox-active metal system using a\n    fixed-point iteration on ionic strength to self-consistently solve for\n    concentrations, activity coefficients, and charge balance.\n    \"\"\"\n    # Define constants\n    R = 8.314462618  # J mol^-1 K^-1\n    F = 96485.33212  # C mol^-1\n    T = 298.15        # K\n    A_davies = 0.509  # Davies constant for water at 298.15 K\n\n    # Electrochemical and equilibrium parameters\n    E_circ = 0.771     # V\n    K1 = 10**(-2.19)\n    K2 = 10**(-3.50)\n    K3 = 10**(-6.00)\n    Kw = 10**(-14.0)\n\n    # Cumulative hydrolysis constants for M(3+)\n    # M(3+) + j*H2O <=> M(OH)j^(3-j)+ + j*H+\n    beta_star_1 = K1\n    beta_star_2 = K1 * K2\n    beta_star_3 = K1 * K2 * K3\n\n    def calculate_speciation(pH, E, C_M_tot):\n        \"\"\"\n        Performs the iterative calculation for a single (pH, E, C_M_tot) point.\n        \"\"\"\n        max_iter = 100\n        tolerance = 1e-15\n        \n        # Fixed activities based on inputs\n        a_H = 10**(-pH)\n        a_OH = Kw / a_H\n\n        # Nernst activity ratio for M2+/M3+ couple\n        RT_F = R * T / F\n        r_act = np.exp(-(E - E_circ) / RT_F)\n\n        # Iteration on Ionic Strength I\n        I = 0.0  # Initial guess (ideal solution)\n        concs = {}\n        for _ in range(max_iter):\n            I_old = I\n            \n            # 1. Calculate activity coefficients (gamma) using current I\n            gammas = {}\n            sqrt_I = np.sqrt(I)\n            # The Davies equation term is non-zero only for I > 0\n            if I > 0:\n                davies_term = (sqrt_I / (1 + sqrt_I)) - 0.3 * I\n            else:\n                davies_term = 0\n\n            # Charges for species involved in Davies calculation\n            z_vals = {'M3+': 3, 'M2+': 2, 'MOH_2p': 2, 'MOH2_p': 1, 'H+': 1, 'OH-': -1}\n            \n            for name, z in z_vals.items():\n                log10_gamma = -A_davies * (z**2) * davies_term\n                gammas[name] = 10**log10_gamma\n            gammas['MOH3_0'] = 1.0  # Neutral species\n\n            # 2. Solve for a_M3+ using total metal mass balance\n            sum_term = (1.0 / gammas['M3+'] +\n                        r_act / gammas['M2+'] +\n                        (beta_star_1 / a_H) / gammas['MOH_2p'] +\n                        (beta_star_2 / a_H**2) / gammas['MOH2_p'] +\n                        (beta_star_3 / a_H**3) / gammas['MOH3_0'])\n\n            a_M3plus = C_M_tot / sum_term if sum_term > 0 else 0.0\n\n            # 3. Calculate concentrations of all species for this iteration\n            # Metal species\n            concs['M3+'] = a_M3plus / gammas['M3+']\n            concs['M2+'] = (a_M3plus * r_act) / gammas['M2+']\n            concs['MOH_2p'] = (a_M3plus * beta_star_1 / a_H) / gammas['MOH_2p']\n            concs['MOH2_p'] = (a_M3plus * beta_star_2 / a_H**2) / gammas['MOH2_p']\n            concs['MOH3_0'] = (a_M3plus * beta_star_3 / a_H**3) / gammas['MOH3_0']\n            # H+ and OH-\n            concs['H+'] = a_H / gammas['H+']\n            concs['OH-'] = a_OH / gammas['OH-']\n\n            # 4. Enforce electroneutrality by adding a background ion\n            net_charge = (3 * concs['M3+'] + 2 * concs['M2+'] + 2 * concs['MOH_2p'] + \n                          1 * concs['MOH2_p'] + 1 * concs['H+'] - 1 * concs['OH-'])\n\n            c_bal = abs(net_charge)\n            z_bal = -np.sign(net_charge) if net_charge != 0 else 0\n            \n            # 5. Update ionic strength including the background ion\n            I = 0.5 * (9 * concs['M3+'] + 4 * concs['M2+'] + 4 * concs['MOH_2p'] + \n                       1 * concs['MOH2_p'] + 1 * concs['H+'] + 1 * concs['OH-'] + \n                       (z_bal**2) * c_bal)\n            \n            # 6. Check for convergence\n            if abs(I - I_old) < tolerance:\n                break\n\n        # After convergence, calculate final required quantities\n        frac_M2plus = concs.get('M2+', 0) / C_M_tot if C_M_tot > 0 else 0\n        frac_MOH3_0 = concs.get('MOH3_0', 0) / C_M_tot if C_M_tot > 0 else 0\n        \n        # Recalculate final charge for residual report\n        final_net_charge = (3*concs['M3+'] + 2*concs['M2+'] + 2*concs['MOH_2p'] + \n                           1*concs['MOH2_p'] + 1*concs['H+'] - 1*concs['OH-'])\n        final_c_bal = abs(final_net_charge)\n        final_z_bal = -np.sign(final_net_charge) if final_net_charge != 0 else 0\n        final_residual = abs(final_net_charge + final_z_bal * final_c_bal)\n\n        return [frac_M2plus, frac_MOH3_0, I, final_residual]\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (pH, E (V), C_M_tot (mol/L))\n        (2.0, 0.30, 1e-6),    # Case A\n        (6.0, 0.771, 1e-6),   # Case B\n        (9.0, 1.00, 1e-6),    # Case C\n        (8.0, 0.20, 1e-4),    # Case D\n        (7.0, 0.771, 1e-8)    # Case E\n    ]\n\n    results = []\n    for case in test_cases:\n        results.extend(calculate_speciation(*case))\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{v:.8e}' for v in results)}]\")\n\nsolve()\n```", "id": "2515057"}]}