{"hands_on_practices": [{"introduction": "Mastering lattice dynamics begins with its most fundamental model: the one-dimensional monatomic chain. This exercise guides you through a first-principles derivation of the phonon dispersion relation, starting from Newton's second law applied to a chain of identical masses connected by springs. By completing this derivation [@problem_id:2508311], you will build a concrete understanding of how collective atomic vibrations give rise to wave-like excitations (phonons) and how their frequency $\\omega$ is intrinsically linked to their wavevector $q$.", "problem": "Consider an infinite one-dimensional monatomic chain of identical atoms of mass $m$, arranged with lattice constant $a$, and coupled only to their nearest neighbors by harmonic springs of force constant $C$. Assume small displacements so that the harmonic approximation is valid, and model the dynamics by Newton’s second law with linear nearest-neighbor restoring forces. Using only these foundations, derive the phonon dispersion relation $\\omega(q)$ as a function of the crystal wavevector $q$ in the first Brillouin zone. Express the final result as a single, simplified analytic function of $q$, $m$, $C$, and $a$. Use radians for arguments of trigonometric functions. The final answer must be a single closed-form expression for $\\omega(q)$.", "solution": "The problem as stated is valid. It is a fundamental, well-posed problem in solid-state physics that is scientifically grounded and objective. It contains all necessary information for a unique solution. We proceed with the derivation.\n\nThe system is an infinite one-dimensional chain of atoms, each of mass $m$, at equilibrium positions $x_n = na$, where $n$ is an integer and $a$ is the lattice constant. Let $u_n(t)$ represent the small longitudinal displacement of the $n$-th atom from its equilibrium position at time $t$.\n\nWithin the harmonic approximation, the force on an atom is linear with respect to the stretching of the bonds connecting it to its neighbors. We consider only nearest-neighbor interactions with a spring constant $C$. The force on the $n$-th atom due to the $(n+1)$-th atom is $C(u_{n+1} - u_n)$. The force on the $n$-th atom due to the $(n-1)$-th atom is $C(u_{n-1} - u_n)$.\n\nThe total force $F_n$ on the $n$-th atom is the sum of these two restoring forces:\n$$F_n = C(u_{n+1} - u_n) + C(u_{n-1} - u_n) = C(u_{n+1} + u_{n-1} - 2u_n)$$\n\nAccording to Newton's second law, $F_n = m \\frac{d^2 u_n}{dt^2}$. This yields the equation of motion for the $n$-th atom:\n$$m \\frac{d^2 u_n}{dt^2} = C(u_{n+1} + u_{n-1} - 2u_n)$$\n\nWe seek collective, wave-like solutions (phonons) for the displacements. We propose a plane wave solution of the form:\n$$u_n(t) = U \\exp[i(q x_n - \\omega t)]$$\nwhere $U$ is the amplitude, $q$ is the wavevector, and $\\omega$ is the angular frequency. Substituting the equilibrium position $x_n = na$, this becomes:\n$$u_n(t) = U \\exp[i(qna - \\omega t)]$$\n\nTo substitute this into the equation of motion, we find the expressions for the displacements of the neighbors, $u_{n+1}$ and $u_{n-1}$, and the acceleration of the $n$-th atom.\n$$u_{n+1}(t) = U \\exp[i(q(n+1)a - \\omega t)] = U \\exp[i(qna - \\omega t)] \\exp(iqa) = u_n(t) \\exp(iqa)$$\n$$u_{n-1}(t) = U \\exp[i(q(n-1)a - \\omega t)] = U \\exp[i(qna - \\omega t)] \\exp(-iqa) = u_n(t) \\exp(-iqa)$$\nThe second time derivative of $u_n(t)$ is:\n$$\\frac{d^2 u_n}{dt^2} = (-i\\omega)^2 U \\exp[i(qna - \\omega t)] = -\\omega^2 u_n(t)$$\n\nSubstituting these expressions into the equation of motion gives:\n$$m(-\\omega^2 u_n) = C(u_n \\exp(iqa) + u_n \\exp(-iqa) - 2u_n)$$\n\nFor a non-trivial solution where displacements exist ($u_n \\neq 0$), we can divide the entire equation by $u_n$:\n$$-m\\omega^2 = C[\\exp(iqa) + \\exp(-iqa) - 2]$$\n\nUsing Euler's identity, $\\exp(i\\theta) + \\exp(-i\\theta) = 2\\cos(\\theta)$, we simplify the term in the brackets:\n$$-m\\omega^2 = C[2\\cos(qa) - 2] = -2C(1 - \\cos(qa))$$\n\nTo further simplify, we use the trigonometric half-angle identity, $1 - \\cos(\\theta) = 2\\sin^2(\\frac{\\theta}{2})$:\n$$-m\\omega^2 = -2C \\left[ 2\\sin^2\\left(\\frac{qa}{2}\\right) \\right] = -4C\\sin^2\\left(\\frac{qa}{2}\\right)$$\n\nSolving for $\\omega^2$, we obtain:\n$$\\omega^2 = \\frac{4C}{m} \\sin^2\\left(\\frac{qa}{2}\\right)$$\n\nThe dispersion relation $\\omega(q)$ is found by taking the square root. Since physical frequencies must be non-negative, we take the positive root, which requires taking the absolute value of the sine function:\n$$\\omega(q) = \\sqrt{\\frac{4C}{m} \\sin^2\\left(\\frac{qa}{2}\\right)} = 2\\sqrt{\\frac{C}{m}} \\left|\\sin\\left(\\frac{qa}{2}\\right)\\right|$$\n\nThis expression gives the angular frequency $\\omega$ as a function of the wavevector $q$, which is the phonon dispersion relation for a one-dimensional monatomic chain. The relation is valid for any $q$, but is uniquely defined within the first Brillouin zone, $q \\in (-\\frac{\\pi}{a}, \\frac{\\pi}{a}]$.", "answer": "$$\\boxed{2\\sqrt{\\frac{C}{m}}\\left|\\sin\\left(\\frac{qa}{2}\\right)\\right|}$$", "id": "2508311"}, {"introduction": "We now advance from a monatomic chain to a diatomic one, the simplest model for crystals with a multi-atom basis, such as ionic compounds. This problem explores how introducing a second, different atom into the unit cell fundamentally alters the vibrational spectrum, leading to the emergence of distinct acoustic and optical phonon branches [@problem_id:2508278]. Solving for the eigenfrequencies and their corresponding polarization vectors will provide a clear physical picture of these modes: the in-phase motion of acoustic phonons versus the out-of-phase, center-of-mass-preserving vibration of optical phonons.", "problem": "Consider a one-dimensional two-atom basis that serves as a minimal lattice-dynamical model for a binary ionic crystal at the Brillouin-zone center. Let the two sublattice atoms have masses $m_{1}$ and $m_{2}$ connected by a single harmonic force constant $K$ within the harmonic approximation. Starting from Newton’s second law for small displacements, and using mass-weighted coordinates so that the eigenvalue problem is cast for the mass-weighted dynamical matrix (whose eigenvalues equal the squared angular frequencies), perform the following tasks:\n\n- Derive the $2\\times 2$ mass-weighted dynamical matrix $\\mathbf{D}$ in terms of $K$, $m_{1}$, and $m_{2}$ for this two-degree-of-freedom system.\n- Solve for the two eigenfrequencies (as angular frequencies $\\omega$) and the corresponding normalized polarization vectors in the mass-weighted coordinate space. Normalize each polarization vector to unit Euclidean norm in the mass-weighted coordinates.\n- Interpret which mode is acoustic and which is optical, and justify your identification based on the structure of the polarization vectors when mapped back to physical displacements.\n\nUse the following parameters for a numerical evaluation: $m_{1} = 3.817\\times 10^{-26}\\,\\mathrm{kg}$, $m_{2} = 5.887\\times 10^{-26}\\,\\mathrm{kg}$, and $K = 100\\,\\mathrm{N\\,m^{-1}}$. Finally, compute the optical-mode frequency $f_{\\mathrm{opt}} = \\omega_{\\mathrm{opt}}/(2\\pi)$ and report it in terahertz (THz). Round your reported numerical answer to four significant figures. Express the final frequency in THz.", "solution": "The problem presented is a standard, well-posed exercise in lattice dynamics. It is scientifically sound and contains all necessary information for a unique solution. We shall proceed with the derivation and calculation.\n\nThe problem describes a simplified model of a one-dimensional diatomic crystal, reduced to a two-degree-of-freedom system representing the dynamics within a single unit cell at the Brillouin-zone center (wavevector $q=0$). Let the masses of the two atoms be $m_{1}$ and $m_{2}$, and their small displacements from equilibrium be $u_{1}$ and $u_{2}$, respectively. The atoms are connected by a harmonic interaction with a force constant $K$.\n\nAccording to Newton's second law, the equations of motion for the two atoms are:\n$$\nm_{1} \\frac{d^{2}u_{1}}{dt^{2}} = F_{1} = K(u_{2} - u_{1})\n$$\n$$\nm_{2} \\frac{d^{2}u_{2}}{dt^{2}} = F_{2} = K(u_{1} - u_{2})\n$$\nWe seek harmonic solutions of the form $u_{j}(t) = U_{j} \\exp(-i\\omega t)$ for $j \\in \\{1, 2\\}$, where $U_{j}$ are the displacement amplitudes and $\\omega$ is the angular frequency. Substituting these into the equations of motion gives:\n$$\n-m_{1}\\omega^{2}U_{1} = K(U_{2} - U_{1})\n$$\n$$\n-m_{2}\\omega^{2}U_{2} = K(U_{1} - U_{2})\n$$\nThese equations can be rearranged into a matrix eigenvalue problem:\n$$\n\\omega^{2}\n\\begin{pmatrix}\nm_{1} & 0 \\\\\n0 & m_{2}\n\\end{pmatrix}\n\\begin{pmatrix}\nU_{1} \\\\\nU_{2}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\nK & -K \\\\\n-K & K\n\\end{pmatrix}\n\\begin{pmatrix}\nU_{1} \\\\\nU_{2}\n\\end{pmatrix}\n$$\nThis is of the form $\\omega^{2}\\mathbf{M}\\mathbf{U} = \\mathbf{C}\\mathbf{U}$, where $\\mathbf{M}$ is the mass matrix and $\\mathbf{C}$ is the force-constant matrix.\n\nTo find the mass-weighted dynamical matrix $\\mathbf{D}$, we introduce mass-weighted coordinates $w_{j} = \\sqrt{m_{j}}U_{j}$. Thus, $U_{j} = w_{j}/\\sqrt{m_{j}}$. The vector of mass-weighted coordinates is $\\mathbf{w} = \\mathbf{M}^{1/2}\\mathbf{U}$. Substituting this into the eigenvalue equation and multiplying from the left by $\\mathbf{M}^{-1/2}$ yields the standard eigenvalue problem for the dynamical matrix:\n$$\n\\omega^{2}(\\mathbf{M}^{-1/2}\\mathbf{M}\\mathbf{M}^{-1/2})\\mathbf{w} = (\\mathbf{M}^{-1/2}\\mathbf{C}\\mathbf{M}^{-1/2})\\mathbf{w}\n$$\n$$\n\\omega^{2}\\mathbf{w} = \\mathbf{D}\\mathbf{w}\n$$\nwhere the mass-weighted dynamical matrix $\\mathbf{D}$ is defined as $\\mathbf{D} = \\mathbf{M}^{-1/2}\\mathbf{C}\\mathbf{M}^{-1/2}$.\nGiven $\\mathbf{M} = \\begin{pmatrix} m_{1} & 0 \\\\ 0 & m_{2} \\end{pmatrix}$ and $\\mathbf{C} = \\begin{pmatrix} K & -K \\\\ -K & K \\end{pmatrix}$, we have $\\mathbf{M}^{-1/2} = \\begin{pmatrix} 1/\\sqrt{m_{1}} & 0 \\\\ 0 & 1/\\sqrt{m_{2}} \\end{pmatrix}$.\nThe calculation is as follows:\n$$\n\\mathbf{D} = \n\\begin{pmatrix}\n1/\\sqrt{m_{1}} & 0 \\\\\n0 & 1/\\sqrt{m_{2}}\n\\end{pmatrix}\n\\begin{pmatrix}\nK & -K \\\\\n-K & K\n\\end{pmatrix}\n\\begin{pmatrix}\n1/\\sqrt{m_{1}} & 0 \\\\\n0 & 1/\\sqrt{m_{2}}\n\\end{pmatrix}\n$$\n$$\n\\mathbf{D} = \n\\begin{pmatrix}\nK/\\sqrt{m_{1}} & -K/\\sqrt{m_{1}} \\\\\n-K/\\sqrt{m_{2}} & K/\\sqrt{m_{2}}\n\\end{pmatrix}\n\\begin{pmatrix}\n1/\\sqrt{m_{1}} & 0 \\\\\n0 & 1/\\sqrt{m_{2}}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\nK/m_{1} & -K/\\sqrt{m_{1}m_{2}} \\\\\n-K/\\sqrt{m_{1}m_{2}} & K/m_{2}\n\\end{pmatrix}\n$$\nThis is the required $2\\times 2$ mass-weighted dynamical matrix.\n\nNext, we solve for the eigenvalues $\\lambda = \\omega^{2}$ and eigenvectors (polarization vectors) $\\mathbf{w}$ of $\\mathbf{D}$. The characteristic equation is $\\det(\\mathbf{D} - \\lambda\\mathbf{I}) = 0$:\n$$\n\\det\n\\begin{pmatrix}\nK/m_{1} - \\lambda & -K/\\sqrt{m_{1}m_{2}} \\\\\n-K/\\sqrt{m_{1}m_{2}} & K/m_{2} - \\lambda\n\\end{pmatrix}\n= 0\n$$\n$$\n\\left(\\frac{K}{m_{1}} - \\lambda\\right)\\left(\\frac{K}{m_{2}} - \\lambda\\right) - \\frac{K^{2}}{m_{1}m_{2}} = 0\n$$\n$$\n\\frac{K^{2}}{m_{1}m_{2}} - \\lambda K\\left(\\frac{1}{m_{1}} + \\frac{1}{m_{2}}\\right) + \\lambda^{2} - \\frac{K^{2}}{m_{1}m_{2}} = 0\n$$\n$$\n\\lambda^{2} - \\lambda K\\left(\\frac{1}{m_{1}} + \\frac{1}{m_{2}}\\right) = 0\n$$\n$$\n\\lambda\\left[\\lambda - K\\left(\\frac{1}{m_{1}} + \\frac{1}{m_{2}}\\right)\\right] = 0\n$$\nThe two eigenvalues are:\n$$\n\\lambda_{1} = 0 \\quad \\text{and} \\quad \\lambda_{2} = K\\left(\\frac{1}{m_{1}} + \\frac{1}{m_2}\\right) = \\frac{K}{\\mu}\n$$\nwhere $\\mu = (m_{1}m_{2})/(m_{1}+m_{2})$ is the reduced mass. The corresponding angular frequencies are $\\omega = \\sqrt{\\lambda}$:\n$$\n\\omega_{1} = 0 \\quad \\text{and} \\quad \\omega_{2} = \\sqrt{K\\left(\\frac{1}{m_{1}} + \\frac{1}{m_{2}}\\right)}\n$$\nFor the eigenvectors $\\mathbf{w} = \\begin{pmatrix} w_{1} \\\\ w_{2} \\end{pmatrix}$:\nFor $\\lambda_{1}=0$: $\\mathbf{D}\\mathbf{w}_{1} = 0$. The first row gives $\\frac{K}{m_{1}}w_{11} - \\frac{K}{\\sqrt{m_{1}m_{2}}}w_{21} = 0$, which implies $w_{11} = \\frac{\\sqrt{m_{1}}}{\\sqrt{m_{2}}}w_{21}$. An unnormalized eigenvector is $\\begin{pmatrix} \\sqrt{m_{1}} \\\\ \\sqrt{m_{2}} \\end{pmatrix}$. Normalizing to unit Euclidean norm ($w_{11}^{2} + w_{21}^{2} = 1$):\n$$\n\\mathbf{w}_{1} = \\frac{1}{\\sqrt{m_{1}+m_{2}}}\n\\begin{pmatrix}\n\\sqrt{m_{1}} \\\\\n\\sqrt{m_{2}}\n\\end{pmatrix}\n$$\nFor $\\lambda_{2}=K(\\frac{1}{m_{1}}+\\frac{1}{m_{2}})$: $(\\mathbf{D}-\\lambda_{2}\\mathbf{I})\\mathbf{w}_{2}=0$. The first row gives $(\\frac{K}{m_{1}} - \\lambda_{2})w_{12} - \\frac{K}{\\sqrt{m_{1}m_{2}}}w_{22} = 0$, which simplifies to $-\\frac{K}{m_{2}}w_{12} - \\frac{K}{\\sqrt{m_{1}m_{2}}}w_{22} = 0$. This implies $w_{12} = -\\frac{\\sqrt{m_{2}}}{\\sqrt{m_{1}}}w_{22}$. An unnormalized eigenvector is $\\begin{pmatrix} \\sqrt{m_{2}} \\\\ -\\sqrt{m_{1}} \\end{pmatrix}$. Normalizing:\n$$\n\\mathbf{w}_{2} = \\frac{1}{\\sqrt{m_{1}+m_{2}}}\n\\begin{pmatrix}\n\\sqrt{m_{2}} \\\\\n-\\sqrt{m_{1}}\n\\end{pmatrix}\n$$\nTo interpret the modes, we convert back to physical displacements $U_{j} = w_{j}/\\sqrt{m_{j}}$.\nFor the mode with $\\omega_{1} = 0$: The physical displacement vector $\\mathbf{U}_{1}$ is proportional to $\\begin{pmatrix} w_{11}/\\sqrt{m_{1}} \\\\ w_{21}/\\sqrt{m_{2}} \\end{pmatrix} \\propto \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$. Here, $U_{1} = U_{2}$. The two atoms move in unison, with the same amplitude and phase. This corresponds to a rigid translation of the unit cell, and thus the entire crystal since $q=0$. Such a motion costs no potential energy, so its frequency is zero. This is the **acoustic mode**.\n\nFor the mode with $\\omega_{2} = \\sqrt{K/\\mu}$: The physical displacement vector $\\mathbf{U}_{2}$ is proportional to $\\begin{pmatrix} w_{12}/\\sqrt{m_{1}} \\\\ w_{22}/\\sqrt{m_{2}} \\end{pmatrix} \\propto \\begin{pmatrix} \\sqrt{m_{2}}/\\sqrt{m_{1}} \\\\ -\\sqrt{m_{1}}/\\sqrt{m_{2}} \\end{pmatrix} = \\frac{1}{\\sqrt{m_{1}m_{2}}}\\begin{pmatrix} m_{2} \\\\ -m_{1} \\end{pmatrix}$. The displacements are out of phase, with amplitudes satisfying $U_{1}/U_{2} = -m_{2}/m_{1}$, or $m_{1}U_{1} + m_{2}U_{2} = 0$. This means the center of mass of the unit cell remains stationary. The atoms vibrate against each other, stretching the bond between them. This is a high-frequency motion. In an ionic crystal, this motion creates an oscillating electric dipole that can couple to electromagnetic radiation (light), hence it is called the **optical mode**. Thus, $\\omega_{\\mathrm{opt}} = \\omega_{2}$.\n\nFinally, we compute the numerical value for the optical-mode frequency $f_{\\mathrm{opt}} = \\omega_{\\mathrm{opt}}/(2\\pi)$.\nThe given parameters are $m_{1} = 3.817\\times 10^{-26}\\,\\mathrm{kg}$, $m_{2} = 5.887\\times 10^{-26}\\,\\mathrm{kg}$, and $K = 100\\,\\mathrm{N\\,m^{-1}}$.\n$$\n\\omega_{\\mathrm{opt}}^{2} = K\\left(\\frac{1}{m_{1}} + \\frac{1}{m_{2}}\\right) = 100\\,\\mathrm{N\\,m^{-1}} \\left(\\frac{1}{3.817\\times 10^{-26}\\,\\mathrm{kg}} + \\frac{1}{5.887\\times 10^{-26}\\,\\mathrm{kg}}\\right)\n$$\n$$\n\\omega_{\\mathrm{opt}}^{2} \\approx 100 \\left(2.61986\\times 10^{25} + 1.69866\\times 10^{25}\\right) \\,\\mathrm{s^{-2}} = 100 \\left(4.31852\\times 10^{25}\\right) \\,\\mathrm{s^{-2}}\n$$\n$$\n\\omega_{\\mathrm{opt}}^{2} \\approx 4.31852\\times 10^{27} \\,\\mathrm{s^{-2}}\n$$\n$$\n\\omega_{\\mathrm{opt}} = \\sqrt{4.31852\\times 10^{27}} \\,\\mathrm{rad\\,s^{-1}} \\approx 6.57155\\times 10^{13} \\,\\mathrm{rad\\,s^{-1}}\n$$\nThe frequency $f_{\\mathrm{opt}}$ is:\n$$\nf_{\\mathrm{opt}} = \\frac{\\omega_{\\mathrm{opt}}}{2\\pi} \\approx \\frac{6.57155\\times 10^{13}}{2\\pi} \\,\\mathrm{Hz} \\approx 1.04589\\times 10^{13} \\,\\mathrm{Hz}\n$$\nIn terahertz ($1\\,\\mathrm{THz} = 10^{12}\\,\\mathrm{Hz}$):\n$$\nf_{\\mathrm{opt}} \\approx 10.4589 \\,\\mathrm{THz}\n$$\nRounding to four significant figures, the result is $10.46\\,\\mathrm{THz}$.", "answer": "$$\\boxed{10.46}$$", "id": "2508278"}, {"introduction": "This final practice bridges the gap between theoretical models and experimental reality, a cornerstone of modern materials science. You will use the dispersion relations for a simple cubic crystal, derived from a microscopic force-constant model, to interpret simulated scattering data [@problem_id:2508301]. This powerful approach demonstrates how to fit a model to measured phonon frequencies to extract the underlying interatomic force constants, which in turn determine macroscopic material properties like the elastic constants $C_{11}$, $C_{12}$, and $C_{44}$.", "problem": "You are given a one-dimensional cut of the acoustic phonon dispersion along a high-symmetry direction, specifically the crystallographic $[100]$ direction, measured by an inelastic scattering technique for a monatomic simple-cubic crystal. Assume a harmonic Born–von Kármán model with central pairwise force constants truncated to first and second neighbors. The crystal has a single atom of mass $M$ per primitive cell of lattice parameter $a$. The nearest-neighbor distance is $a$, with force constant $k_1$; the second-neighbor distance is $\\sqrt{2}a$, with force constant $k_2$. The measured dataset provides the angular frequencies $\\omega_s(\\mathbf{q})$ for the longitudinal acoustic (LA) branch and a degenerate transverse acoustic (TA) branch along $\\mathbf{q} \\parallel [100]$. Use radians for all trigonometric functions and express wavevectors in $\\mathrm{m}^{-1}$ and angular frequencies in $\\mathrm{rad}\\,\\mathrm{s}^{-1}$.\n\nStarting from the harmonic equations of motion and the definition of the dynamical matrix for central forces, derive the dispersion relations along $[100]$ in terms of $k_1$, $k_2$, $M$, $a$, and $\\mathbf{q}$. Use these relations to fit a two-parameter force-constant model ($k_1$, $k_2$) to the measured $\\omega_s(\\mathbf{q})$, and then extract the elastic constants of the corresponding long-wavelength continuum: $C_{11}$, $C_{12}$, and $C_{44}$. Assume a monatomic simple-cubic crystal with density $\\rho = M/a^3$. Use only the following foundational facts as your starting point: (i) Newton’s second law, (ii) the harmonic approximation with central pair forces, (iii) the definition of the dynamical matrix and its relation to $\\omega^2$ as eigenvalues, and (iv) the continuum-elasticity relation between sound velocities and elastic constants at small $|\\mathbf{q}|$. Your derivation should make clear what is being fit, why that fit is justified by the model physics, and how the elastic constants follow from the fitted parameters. You must not rely on any unmotivated formulas.\n\nYour program should implement the fitting and extraction procedure described above and apply it to the following three test cases. For each case, use the provided parameters and wavevector grid to construct the measured datasets. The “measured” datasets are noiseless synthetic data obtained from the same physical model; your fitting procedure should therefore exactly reconstruct the model parameters within numerical precision. For each case, compute and report the elastic constants $C_{11}$, $C_{12}$, and $C_{44}$ in $\\mathrm{Pa}$, each rounded to three significant figures.\n\nTest suite (each case provides $M$ in $\\mathrm{kg}$, $a$ in $\\mathrm{m}$, and the true $k_1$, $k_2$ in $\\mathrm{N}\\,\\mathrm{m}^{-1}$; construct $\\omega_{\\mathrm{LA}}(q_i)$ and $\\omega_{\\mathrm{TA}}(q_i)$ at the listed $q_i$):\n\n- Case 1:\n  - $M = 1.0\\times 10^{-25}\\ \\mathrm{kg}$,\n  - $a = 3.0\\times 10^{-10}\\ \\mathrm{m}$,\n  - $k_1 = 15.0\\ \\mathrm{N}\\,\\mathrm{m}^{-1}$,\n  - $k_2 = 15.0\\ \\mathrm{N}\\,\\mathrm{m}^{-1}$,\n  - $q_i = \\{\\xi_i\\,\\pi/a\\}$ with $\\xi_i \\in \\{0.10, 0.20, 0.35, 0.50, 0.70, 0.90\\}$.\n\n- Case 2:\n  - $M = 6.6\\times 10^{-26}\\ \\mathrm{kg}$,\n  - $a = 2.5\\times 10^{-10}\\ \\mathrm{m}$,\n  - $k_1 = 20.0\\ \\mathrm{N}\\,\\mathrm{m}^{-1}$,\n  - $k_2 = 5.0\\ \\mathrm{N}\\,\\mathrm{m}^{-1}$,\n  - $q_i = \\{\\xi_i\\,\\pi/a\\}$ with $\\xi_i \\in \\{0.08, 0.16, 0.30, 0.45, 0.60, 0.85\\}$.\n\n- Case 3:\n  - $M = 1.8\\times 10^{-25}\\ \\mathrm{kg}$,\n  - $a = 4.0\\times 10^{-10}\\ \\mathrm{m}$,\n  - $k_1 = 16.0\\ \\mathrm{N}\\,\\mathrm{m}^{-1}$,\n  - $k_2 = 12.0\\ \\mathrm{N}\\,\\mathrm{m}^{-1}$,\n  - $q_i = \\{\\xi_i\\,\\pi/a\\}$ with $\\xi_i \\in \\{0.12, 0.24, 0.40, 0.55, 0.72, 0.92\\}$.\n\nFor each case, the “measured” dispersions are to be generated by your program from the model you derive, evaluated at the specified $q_i$. Then, from those synthetic measurements, your program must:\n- Fit the force constants $k_1$ and $k_2$.\n- Compute $C_{11}$, $C_{12}$, and $C_{44}$ in $\\mathrm{Pa}$.\n- Round each elastic constant to three significant figures.\n\nFinal output format: Your program should produce a single line of output containing the results for the three cases as a comma-separated list enclosed in square brackets, where each case is itself a list in the order $[C_{11}, C_{12}, C_{44}]$. For example, the printed line should look like:\n\"[ [C11_case1,C12_case1,C44_case1], [C11_case2,C12_case2,C44_case2], [C11_case3,C12_case3,C44_case3] ]\"\nwith each numeric entry in $\\mathrm{Pa}$ and rounded to three significant figures. Do not print any additional text.", "solution": "The problem statement is a valid exercise in solid-state physics. It is scientifically grounded, well-posed, objective, and complete. It requires the derivation of phonon dispersion relations for a simple cubic crystal, fitting force constants to synthetic data based on these relations, and subsequently calculating elastic constants. This is a standard procedure and all provided parameters are physically reasonable.\n\nThe solution proceeds in three stages:\n1.  Derivation of the dispersion relations $\\omega(\\mathbf{q})$ for a monatomic simple cubic lattice with first and second neighbor central forces.\n2.  Formulation of a linear least-squares fit to determine the force constants $k_1$ and $k_2$ from the dispersion data.\n3.  Derivation of the expressions for the elastic constants $C_{11}$, $C_{12}$, and $C_{44}$ from the force constants in the long-wavelength limit.\n\n**1. Derivation of the Phonon Dispersion Relations**\n\nWe begin with the harmonic equation of motion for an atom at lattice site $\\mathbf{R}_l$. Let $\\mathbf{u}_l$ be its displacement from equilibrium.\n$$M \\ddot{\\mathbf{u}}_l = -\\sum_{l'} \\mathbf{\\Phi}(l, l') \\mathbf{u}_{l'}$$\nwhere $M$ is the atomic mass and $\\mathbf{\\Phi}(l, l')$ is the matrix of force constants.\nAssuming a plane wave solution of the form $\\mathbf{u}_l(t) = \\mathbf{\\epsilon} e^{i(\\mathbf{q} \\cdot \\mathbf{R}_l - \\omega t)}$, where $\\mathbf{\\epsilon}$ is the polarization vector, $\\mathbf{q}$ is the wavevector, and $\\omega$ is the angular frequency, we obtain the eigenvalue equation for the dynamical matrix $\\mathbf{D}(\\mathbf{q})$:\n$$M \\omega^2 \\mathbf{\\epsilon} = \\mathbf{D}(\\mathbf{q}) \\mathbf{\\epsilon}$$\nThe dynamical matrix components are given by:\n$$D_{\\alpha\\beta}(\\mathbf{q}) = \\sum_{h} \\Phi_{\\alpha\\beta}(\\mathbf{R}_h) e^{i\\mathbf{q} \\cdot \\mathbf{R}_h}$$\nwhere the sum is over all lattice vectors $\\mathbf{R}_h$, and $\\Phi_{\\alpha\\beta}(\\mathbf{R}_h)$ is the force constant tensor between an atom at the origin and an atom at $\\mathbf{R}_h$. The self-term is fixed by the condition of zero force under a uniform translation: $\\Phi_{\\alpha\\beta}(\\mathbf{0}) = -\\sum_{h\\neq 0} \\Phi_{\\alpha\\beta}(\\mathbf{R}_h)$. This allows us to write:\n$$D_{\\alpha\\beta}(\\mathbf{q}) = \\sum_{h \\neq 0} \\Phi_{\\alpha\\beta}(\\mathbf{R}_h) (e^{i\\mathbf{q} \\cdot \\mathbf{R}_h} - 1)$$\nFor a central force potential, between the origin and an atom at $\\mathbf{R}_h$, the force constant tensor is $\\Phi_{\\alpha\\beta}(\\mathbf{R}_h) = -K \\frac{R_{h,\\alpha} R_{h,\\beta}}{|\\mathbf{R}_h|^2}$, where $K$ is the stretching force constant.\n\nFor the simple cubic lattice with lattice constant $a$, we consider first neighbors at distance $a$ (force constant $k_1$) and second neighbors at distance $\\sqrt{2}a$ (force constant $k_2$). We evaluate the sums for the matrix components $D_{\\alpha\\beta}(\\mathbf{q})$.\n\nFirst neighbors are at positions like $(\\pm a, 0, 0)$. Second neighbors are at positions like $(\\pm a, \\pm a, 0)$.\nThe diagonal elements are, for example:\n$$D_{xx}(\\mathbf{q}) = 2k_1(1 - \\cos(q_x a)) + 2k_2(2 - \\cos(q_x a)\\cos(q_y a) - \\cos(q_x a)\\cos(q_z a))$$\nThe off-diagonal elements are, for example:\n$$D_{xy}(\\mathbf{q}) = 2k_2 \\sin(q_x a) \\sin(q_y a)$$\nOther components are obtained by cyclic permutation of indices $(x, y, z)$.\n\nWe are interested in the high-symmetry direction $\\mathbf{q} \\parallel [100]$, so we set $\\mathbf{q} = (q, 0, 0)$. The dynamical matrix components simplify significantly:\n$D_{xx}(q,0,0) = 2k_1(1-\\cos(qa)) + 2k_2(2 - \\cos(qa)\\cos(0) - \\cos(qa)\\cos(0)) = (2k_1+4k_2)(1-\\cos(qa))$\n$D_{yy}(q,0,0) = 2k_1(1-\\cos(0)) + 2k_2(2 - \\cos(0)\\cos(qa) - \\cos(0)\\cos(0)) = 2k_2(1-\\cos(qa))$\n$D_{zz}(q,0,0) = D_{yy}(q,0,0) = 2k_2(1-\\cos(qa))$\nAll off-diagonal terms $D_{\\alpha\\beta}$ where $\\alpha \\neq \\beta$ become zero because at least one of $q_y$ or $q_z$ is zero. So, the dynamical matrix is diagonal.\nThe eigenvalues $M\\omega^2$ are the diagonal entries.\nUsing the identity $1 - \\cos(\\theta) = 2\\sin^2(\\theta/2)$:\n\nFor the longitudinal acoustic (LA) branch (polarization along $\\mathbf{q}$):\n$$M\\omega_{\\text{LA}}^2(q) = (2k_1+4k_2)(1-\\cos(qa)) = (4k_1+8k_2)\\sin^2\\left(\\frac{qa}{2}\\right)$$\n$$\\omega_{\\text{LA}}(q) = \\sqrt{\\frac{4k_1+8k_2}{M}} \\left|\\sin\\left(\\frac{qa}{2}\\right)\\right|$$\n\nFor the degenerate transverse acoustic (TA) branches (polarization perpendicular to $\\mathbf{q}$):\n$$M\\omega_{\\text{TA}}^2(q) = 2k_2(1-\\cos(qa)) = 4k_2\\sin^2\\left(\\frac{qa}{2}\\right)$$\n$$\\omega_{\\text{TA}}(q) = \\sqrt{\\frac{4k_2}{M}} \\left|\\sin\\left(\\frac{qa}{2}\\right)\\right|$$\nThese are the desired dispersion relations.\n\n**2. Fitting Procedure for Force Constants**\n\nThe derived relations provide a linear connection between the experimental observables and the model parameters $k_1$ and $k_2$. Let the provided data be pairs of $(\\omega_{\\text{LA}}(q_i), \\omega_{\\text{TA}}(q_i))$ for a set of wavevectors $q_i$. We can rearrange the dispersion equations:\n$$M\\omega_{\\text{LA}}^2(q_i) = k_1 \\left(4\\sin^2\\left(\\frac{q_ia}{2}\\right)\\right) + k_2 \\left(8\\sin^2\\left(\\frac{q_ia}{2}\\right)\\right)$$\n$$M\\omega_{\\text{TA}}^2(q_i) = k_1 \\cdot 0 + k_2 \\left(4\\sin^2\\left(\\frac{q_ia}{2}\\right)\\right)$$\nFor a set of $N$ measurement points $\\{q_i\\}$, we obtain $2N$ linear equations for the two unknowns $k_1$ and $k_2$. This overdetermined system can be written in matrix form $\\mathbf{A} \\mathbf{x} = \\mathbf{y}$, where $\\mathbf{x} = [k_1, k_2]^T$. The vector of observations $\\mathbf{y}$ and the design matrix $\\mathbf{A}$ are constructed from the measured data. A linear least-squares algorithm provides a robust solution for $\\mathbf{x}$, giving the best-fit values for $k_1$ and $k_2$. As the problem uses synthetic noiseless data, this fit will exactly recover the true parameters.\n\n**3. Extraction of Elastic Constants**\n\nThe connection between the microscopic force constants and the macroscopic elastic constants is established in the long-wavelength limit ($q \\to 0$). In this limit, the dispersion relations become linear, $\\omega = v_s q$, where $v_s$ is the sound velocity. We expand the dispersion relations for small $q$ using $\\sin(x) \\approx x$:\n$M\\omega_{\\text{LA}}^2(q) \\approx (4k_1+8k_2)\\left(\\frac{qa}{2}\\right)^2 = (k_1+2k_2)q^2 a^2 \\implies v_{\\text{LA}}^2 = \\frac{(k_1+2k_2)a^2}{M}$\n$M\\omega_{\\text{TA}}^2(q) \\approx 4k_2\\left(\\frac{qa}{2}\\right)^2 = k_2 q^2 a^2 \\implies v_{\\text{TA}}^2 = \\frac{k_2 a^2}{M}$\nFrom continuum elasticity theory, for a cubic crystal, the sound velocities for waves propagating along the $[100]$ direction are given by:\n$$v_{\\text{LA}} = \\sqrt{\\frac{C_{11}}{\\rho}} \\quad \\text{and} \\quad v_{\\text{TA}} = \\sqrt{\\frac{C_{44}}{\\rho}}$$\nwhere $\\rho = M/a^3$ is the density.\nBy equating the microscopic and macroscopic expressions for the squared velocities, we find:\n$\\frac{C_{11}}{\\rho} = \\frac{(k_1+2k_2)a^2}{M} \\implies C_{11} = \\frac{M}{a^3} \\frac{(k_1+2k_2)a^2}{M} = \\frac{k_1+2k_2}{a}$\n$\\frac{C_{44}}{\\rho} = \\frac{k_2 a^2}{M} \\implies C_{44} = \\frac{M}{a^3} \\frac{k_2 a^2}{M} = \\frac{k_2}{a}$\nTo find $C_{12}$, we must consider a general $\\mathbf{q}$ in the long-wavelength limit. Expanding the full dynamical matrix for small $\\mathbf{q}$ and comparing it to the Christoffel equation from continuum elasticity yields the remaining elastic constant.\nWe found $D_{xy}(\\mathbf{q}) \\approx 2k_2 a^2 q_x q_y$. The corresponding term in the Christoffel matrix multiplied by $a$ is $a(C_{12}+C_{44})q_x q_y$. Equating these gives:\n$a(C_{12}+C_{44}) = 2k_2 a^2 \\implies C_{12}+C_{44} = \\frac{2k_2}{a}$.\nSubstituting the expression for $C_{44}$:\n$C_{12} + \\frac{k_2}{a} = \\frac{2k_2}{a} \\implies C_{12} = \\frac{k_2}{a}$.\nThis confirms the Cauchy relation $C_{12}=C_{44}$, which is expected for a crystal with atoms at inversion centers interacting via central forces.\nThe final expressions for the elastic constants are:\n$$C_{11} = \\frac{k_1+2k_2}{a}, \\quad C_{12} = \\frac{k_2}{a}, \\quad C_{44} = \\frac{k_2}{a}$$\nThe program will implement this full sequence: generate synthetic data, fit $k_1$ and $k_2$ using least squares, and compute $C_{11}, C_{12}, C_{44}$ using the derived formulae.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem of fitting force constants and extracting elastic constants\n    for a simple cubic crystal based on phonon dispersion relations.\n    \"\"\"\n    test_cases = [\n        {\n            \"M\": 1.0e-25,  # kg\n            \"a\": 3.0e-10,  # m\n            \"k1_true\": 15.0, # N/m\n            \"k2_true\": 15.0, # N/m\n            \"xi\": [0.10, 0.20, 0.35, 0.50, 0.70, 0.90]\n        },\n        {\n            \"M\": 6.6e-26,\n            \"a\": 2.5e-10,\n            \"k1_true\": 20.0,\n            \"k2_true\": 5.0,\n            \"xi\": [0.08, 0.16, 0.30, 0.45, 0.60, 0.85]\n        },\n        {\n            \"M\": 1.8e-25,\n            \"a\": 4.0e-10,\n            \"k1_true\": 16.0,\n            \"k2_true\": 12.0,\n            \"xi\": [0.12, 0.24, 0.40, 0.55, 0.72, 0.92]\n        }\n    ]\n\n    all_results = []\n    \n    for case in test_cases:\n        M = case[\"M\"]\n        a = case[\"a\"]\n        k1_true = case[\"k1_true\"]\n        k2_true = case[\"k2_true\"]\n        q_grid = [(xi * np.pi / a) for xi in case[\"xi\"]]\n        \n        # 1. Generate synthetic \"measured\" data using the derived dispersion relations\n        omega_la_sq = []\n        omega_ta_sq = []\n        \n        for q in q_grid:\n            sin_sq_term = np.sin(q * a / 2)**2\n            # M * omega_LA^2 = (4*k1 + 8*k2) * sin^2(qa/2)\n            # M * omega_TA^2 = 4*k2 * sin^2(qa/2)\n            m_omega_la_sq = (4 * k1_true + 8 * k2_true) * sin_sq_term\n            m_omega_ta_sq = (4 * k2_true) * sin_sq_term\n            \n            omega_la_sq.append(m_omega_la_sq / M)\n            omega_ta_sq.append(m_omega_ta_sq / M)\n\n        # 2. Set up and solve the linear least-squares problem to fit k1 and k2\n        num_points = len(q_grid)\n        # We have 2N equations for 2 unknowns (k1, k2)\n        A = np.zeros((2 * num_points, 2))\n        y = np.zeros(2 * num_points)\n        \n        for i, q in enumerate(q_grid):\n            # Term common to all equations for a given q\n            common_factor = 4 * np.sin(q * a / 2)**2\n            \n            # Equation for LA branch: M*omega_LA^2 = k1*(4*sin^2) + k2*(8*sin^2)\n            A[2 * i, 0] = common_factor\n            A[2 * i, 1] = 2 * common_factor\n            y[2 * i] = M * omega_la_sq[i]\n\n            # Equation for TA branch: M*omega_TA^2 = k2*(4*sin^2)\n            A[2 * i + 1, 0] = 0\n            A[2 * i + 1, 1] = common_factor\n            y[2 * i + 1] = M * omega_ta_sq[i]\n            \n        # Solve Ax = y for x = [k1, k2]\n        k_fitted, residuals, rank, s = np.linalg.lstsq(A, y, rcond=None)\n        k1_fit, k2_fit = k_fitted\n        \n        # 3. Calculate elastic constants from the fitted force constants\n        # C11 = (k1 + 2*k2) / a\n        # C12 = k2 / a\n        # C44 = k2 / a\n        C11 = (k1_fit + 2 * k2_fit) / a\n        C12 = k2_fit / a\n        C44 = k2_fit / a\n        \n        all_results.append([C11, C12, C44])\n\n    # 4. Format the final output string as specified\n    # The format required is a list of lists, with numbers in scientific notation\n    # rounded to 3 significant figures.\n    # e.g., \"[[C11,C12,C44],[C11,C12,C44]]\"\n    case_strs = []\n    for res in all_results:\n        # Format Cij to 3 significant figures using \"e\" notation with 2 decimal places.\n        res_str = '[' + ','.join([f\"{val:.2e}\" for val in res]) + ']'\n        case_strs.append(res_str)\n    \n    final_output_str = '[' + ','.join(case_strs) + ']'\n    print(final_output_str)\n\nsolve()\n```", "id": "2508301"}]}