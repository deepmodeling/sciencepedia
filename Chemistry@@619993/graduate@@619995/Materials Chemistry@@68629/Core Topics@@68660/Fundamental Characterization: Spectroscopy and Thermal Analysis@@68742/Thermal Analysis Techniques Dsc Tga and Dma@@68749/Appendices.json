{"hands_on_practices": [{"introduction": "This first exercise focuses on a cornerstone of Differential Scanning Calorimetry (DSC): the quantitative analysis of phase transitions. You will work with a hypothetical but realistic dataset to extract the molar enthalpy of a solid-solid transition, a key thermodynamic parameter. This practice reinforces the fundamental link between the measured heat flow signal, the heating rate, and the latent heat of a first-order transition, a crucial skill for interpreting any DSC thermogram [@problem_id:2530418].", "problem": "A crystalline molecular solid exhibits a reversible solid–solid transition detectable by Differential Scanning Calorimetry (DSC). In repeated DSC cycles under a constant heating (or cooling) rate, the instrument reports the baseline-corrected specific heat flow, defined as the excess signal per unit sample mass attributable only to the transition, denoted by $\\phi_{\\mathrm{ex}}(T)$ in $\\mathrm{W}\\,\\mathrm{g}^{-1}$. You may assume that any slowly varying baseline due to the specific heat capacity has been rigorously subtracted. The DSC is operated at constant programmed rate $\\beta = dT/dt$.\n\nTwo heating scans and their corresponding cooling scans are performed on the same sample. The sample mass is $m = 6.20 \\times 10^{-3}\\ \\mathrm{g}$ and the molar mass is $M = 342.30\\ \\mathrm{g}\\,\\mathrm{mol}^{-1}$. The following observations are made:\n\n- On heating at $\\beta_{1} = 10\\ \\mathrm{K}\\,\\mathrm{min}^{-1}$ in both cycles, the excess heat flow $\\phi_{\\mathrm{ex}}(T)$ is well described in the transition region by a Gaussian\n$$\n\\phi_{\\mathrm{ex}}(T) = A_{h,10}\\,\\exp\\!\\left(-\\frac{(T - T_{h})^{2}}{2\\sigma^{2}}\\right),\n$$\nwith $A_{h,10} = 0.800\\ \\mathrm{W}\\,\\mathrm{g}^{-1}$, $\\sigma = 3.00\\ \\mathrm{K}$, and peak temperature $T_{h} = 367.2\\ \\mathrm{K}$.\n- On heating at $\\beta_{2} = 5\\ \\mathrm{K}\\,\\mathrm{min}^{-1}$, the excess heat flow in the transition region is again Gaussian with the same width $\\sigma = 3.00\\ \\mathrm{K}$ and peak temperature within $\\pm 0.2\\ \\mathrm{K}$ of $T_{h}$, but the fitted amplitude is $A_{h,5} = 0.400\\ \\mathrm{W}\\,\\mathrm{g}^{-1}$.\n- On cooling at $\\beta_{1} = 10\\ \\mathrm{K}\\,\\mathrm{min}^{-1}$, an exothermic feature appears that is also Gaussian with width $\\sigma = 3.00\\ \\mathrm{K}$, amplitude $-0.800\\ \\mathrm{W}\\,\\mathrm{g}^{-1}$, and peak temperature $T_{c} = 359.8\\ \\mathrm{K}$. No resolvable step-like change in the baseline specific heat capacity is detected outside the transient Gaussian features.\n- The areas inferred from the Gaussian fits are reproducible within $1\\%$ across repeated heating–cooling cycles, and there is no detectable mass change by concurrent thermogravimetry to within $10^{-4}$ relative mass.\n\nStarting from the fundamental calorimetric relation between heat flow and enthalpy under a constant heating rate, use the data above to:\n\n1. Extract the molar transition enthalpy for the solid–solid transformation from the heating scan at $\\beta_{1} = 10\\ \\mathrm{K}\\,\\mathrm{min}^{-1}$.\n2. Determine, based solely on calorimetric signatures, whether the transition is first-order or second-order, and justify this determination within your derivation.\n\nExpress the final enthalpy in $\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$, and round your answer to four significant figures. Your final reported value should be a single number.", "solution": "The problem is subjected to validation and is found to be scientifically grounded, well-posed, and internally consistent. The provided data are characteristic of a standard Differential Scanning Calorimetry (DSC) experiment on a material undergoing a phase transition. The relationship between the peak amplitude and heating rate is physically correct, confirming the validity of the setup. Therefore, a solution will be provided.\n\nThe fundamental task is to determine the molar enthalpy of transition ($\\Delta H_m$) and to classify the order of the phase transition based on the provided calorimetric data.\n\n1. Determination of Molar Transition Enthalpy ($\\Delta H_m$)\n\nThe excess heat flow per unit mass, $\\phi_{\\mathrm{ex}}(T)$ in units of $\\mathrm{W}\\,\\mathrm{g}^{-1}$ or $\\mathrm{J}\\,\\mathrm{s}^{-1}\\,\\mathrm{g}^{-1}$, is given. The total excess heat flow for the sample of mass $m$ is $\\Phi_{\\mathrm{ex}}(t) = m \\cdot \\phi_{\\mathrm{ex}}(T(t))$, where $T(t)$ is the temperature at time $t$. The total heat absorbed during the transition, $\\Delta Q_{\\mathrm{trans}}$, is the time integral of this heat flow over the duration of the event.\n$$\n\\Delta Q_{\\mathrm{trans}} = \\int_{t_{\\mathrm{start}}}^{t_{\\mathrm{end}}} \\Phi_{\\mathrm{ex}}(t) \\, dt\n$$\nThe DSC is operated at a constant heating rate, $\\beta = dT/dt$. We can therefore change the variable of integration from time $t$ to temperature $T$, using the relation $dt = (1/\\beta) \\, dT$. The total heat absorbed is then given by:\n$$\n\\Delta Q_{\\mathrm{trans}} = \\int_{T_{\\mathrm{start}}}^{T_{\\mathrm{end}}} \\Phi_{\\mathrm{ex}}(T) \\frac{1}{\\beta} \\, dT = \\frac{m}{\\beta} \\int_{T_{\\mathrm{start}}}^{T_{\\mathrm{end}}} \\phi_{\\mathrm{ex}}(T) \\, dT\n$$\nAt constant pressure, the heat absorbed is equal to the enthalpy change of the sample, $\\Delta H_{\\mathrm{trans}}$. So, $\\Delta H_{\\mathrm{trans}} = \\Delta Q_{\\mathrm{trans}}$. The given excess heat flow is a Gaussian function, which is non-zero only in a narrow region around the peak temperature. Thus, we can extend the integration limits to $\\pm\\infty$ without loss of accuracy.\n$$\n\\Delta H_{\\mathrm{trans}} = \\frac{m}{\\beta} \\int_{-\\infty}^{\\infty} \\phi_{\\mathrm{ex}}(T) \\, dT\n$$\nFor the heating scan at $\\beta_1 = 10\\ \\mathrm{K}\\,\\mathrm{min}^{-1}$, the excess heat flow is given by:\n$$\n\\phi_{\\mathrm{ex}}(T) = A_{h,10}\\,\\exp\\!\\left(-\\frac{(T - T_{h})^{2}}{2\\sigma^{2}}\\right)\n$$\nwhere $A_{h,10} = 0.800\\ \\mathrm{W}\\,\\mathrm{g}^{-1}$, $\\sigma = 3.00\\ \\mathrm{K}$, and $T_h = 367.2\\ \\mathrm{K}$.\n\nThe definite integral of this Gaussian function is a standard result:\n$$\n\\int_{-\\infty}^{\\infty} A\\,\\exp\\!\\left(-\\frac{(x - x_0)^{2}}{2\\sigma^{2}}\\right) \\, dx = A \\sqrt{2\\pi\\sigma^2} = A\\sigma\\sqrt{2\\pi}\n$$\nApplying this to our expression for $\\Delta H_{\\mathrm{trans}}$:\n$$\n\\Delta H_{\\mathrm{trans}} = \\frac{m}{\\beta_1} \\left( A_{h,10} \\sigma \\sqrt{2\\pi} \\right)\n$$\nThe problem requests the molar enthalpy of transition, $\\Delta H_m$. This is obtained by dividing the total enthalpy change of the sample by the number of moles, $n = m/M$, where $M$ is the molar mass.\n$$\n\\Delta H_m = \\frac{\\Delta H_{\\mathrm{trans}}}{n} = \\frac{\\Delta H_{\\mathrm{trans}}}{m/M} = \\frac{M}{m} \\Delta H_{\\mathrm{trans}}\n$$\nSubstituting the expression for $\\Delta H_{\\mathrm{trans}}$:\n$$\n\\Delta H_m = \\frac{M}{m} \\left( \\frac{m}{\\beta_1} A_{h,10} \\sigma \\sqrt{2\\pi} \\right) = \\frac{M A_{h,10} \\sigma \\sqrt{2\\pi}}{\\beta_1}\n$$\nBefore calculation, we must ensure all units are consistent. The heat flow amplitude $A_{h,10}$ is in $\\mathrm{W}\\,\\mathrm{g}^{-1} = \\mathrm{J}\\,\\mathrm{s}^{-1}\\,\\mathrm{g}^{-1}$. The heating rate $\\beta_1$ is given in $\\mathrm{K}\\,\\mathrm{min}^{-1}$ and must be converted to $\\mathrm{K}\\,\\mathrm{s}^{-1}$.\n$$\n\\beta_1 = 10\\ \\mathrm{K}\\,\\mathrm{min}^{-1} = \\frac{10\\ \\mathrm{K}}{60\\ \\mathrm{s}} = \\frac{1}{6}\\ \\mathrm{K}\\,\\mathrm{s}^{-1}\n$$\nNow, we substitute the numerical values:\n- Molar mass, $M = 342.30\\ \\mathrm{g}\\,\\mathrm{mol}^{-1}$\n- Amplitude, $A_{h,10} = 0.800\\ \\mathrm{J}\\,\\mathrm{s}^{-1}\\,\\mathrm{g}^{-1}$\n- Gaussian width, $\\sigma = 3.00\\ \\mathrm{K}$\n- Heating rate, $\\beta_1 = 1/6\\ \\mathrm{K}\\,\\mathrm{s}^{-1}$\n$$\n\\Delta H_m = \\frac{(342.30\\ \\mathrm{g}\\,\\mathrm{mol}^{-1}) (0.800\\ \\mathrm{J}\\,\\mathrm{s}^{-1}\\,\\mathrm{g}^{-1}) (3.00\\ \\mathrm{K})}{\\frac{1}{6}\\ \\mathrm{K}\\,\\mathrm{s}^{-1}} \\sqrt{2\\pi}\n$$\n$$\n\\Delta H_m = 6 \\times 342.30 \\times 0.800 \\times 3.00 \\times \\sqrt{2\\pi}\\ \\mathrm{J}\\,\\mathrm{mol}^{-1}\n$$\n$$\n\\Delta H_m = 4929.12 \\times \\sqrt{2\\pi}\\ \\mathrm{J}\\,\\mathrm{mol}^{-1} \\approx 12359.0\\ \\mathrm{J}\\,\\mathrm{mol}^{-1}\n$$\nConverting to $\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$:\n$$\n\\Delta H_m \\approx 12.3590\\ \\mathrm{kJ}\\,\\mathrm{mol}^{-1}\n$$\nRounding to four significant figures as required, the molar transition enthalpy is $12.36\\ \\mathrm{kJ}\\,\\mathrm{mol}^{-1}$.\n\n2. Classification of the Transition Order\n\nAccording to the Ehrenfest classification of phase transitions, the order is determined by the lowest-order derivative of the Gibbs free energy ($G$) that shows a discontinuity at the transition temperature ($T_{tr}$).\n\n- A **first-order transition** is defined by a discontinuity in the first derivatives of $G$, such as entropy $S = -(\\partial G/\\partial T)_P$. This implies a finite latent heat of transition, $\\Delta H = T_{tr} \\Delta S \\neq 0$. In a DSC experiment, this latent heat manifests as a peak in the heat flow signal, the area of which corresponds to $\\Delta H$. The heat capacity, $C_p = T(\\partial S/\\partial T)_P$, is a second derivative of $G$ and theoretically diverges (a delta function) at $T_{tr}$.\n\n- A **second-order transition** is defined by continuous first derivatives of $G$ (hence $\\Delta S = 0$ and $\\Delta H = 0$), but a discontinuity in the second derivatives, such as the heat capacity $C_p$. This manifests in a DSC experiment as a step-like change in the heat capacity baseline at $T_{tr}$, but with no latent heat peak.\n\nThe analysis of the experimental data leads to the following conclusions:\n1.  Our calculation in Part 1 demonstrates that the transition involves a substantial, non-zero latent heat: $\\Delta H_m \\approx 12.36\\ \\mathrm{kJ}\\,\\mathrm{mol}^{-1}$. A non-zero latent heat is the definitive signature of a first-order phase transition.\n2.  The problem statement explicitly mentions that \"No resolvable step-like change in the baseline specific heat capacity is detected outside the transient Gaussian features.\" This observation is consistent with a first-order transition and inconsistent with a second-order transition, which would be defined by such a step.\n3.  The data show thermal hysteresis, with the transition occurring at $T_h = 367.2\\ \\mathrm{K}$ on heating and $T_c = 359.8\\ \\mathrm{K}$ on cooling. This hysteresis ($T_h - T_c = 7.4\\ \\mathrm{K}$) is a kinetic phenomenon commonly observed in first-order transitions, which often require superheating or supercooling to proceed, but is absent in ideal second-order transitions.\n\nBased on the primary evidence of a finite latent heat, supported by the absence of a $C_p$ step and the presence of thermal hysteresis, the solid–solid transformation is unambiguously classified as **first-order**.", "answer": "$$\n\\boxed{12.36}\n$$", "id": "2530418"}, {"introduction": "Our next practice moves into the realm of mechanical properties with Dynamic Mechanical Analysis (DMA). This problem tackles the powerful principle of time-temperature superposition (TTS), a cornerstone of polymer viscoelasticity. You will determine the parameters of the Williams-Landel-Ferry (WLF) model from experimental shift factors and then use this model to predict the material's mechanical response under new conditions, demonstrating how to construct and utilize a master curve for predictive engineering [@problem_id:2530372].", "problem": "A linear amorphous polymer is tested by Dynamic Mechanical Analysis (DMA) in the vicinity of a fixed reference temperature $T_{\\mathrm{ref}}=373\\ \\mathrm{K}$. Assume the material is in a viscoelastic regime where time–temperature superposition holds and the measured horizontal shift factor $a_{T}$ is defined as the frequency multiplier needed to superpose data at temperature $T$ onto the reference master curve, so that the storage modulus at temperature $T$ is obtained from the reference master curve by evaluating at the shifted frequency $\\,\\omega a_{T}\\,$. You are given the following measured frequency–temperature shift factors relative to $T_{\\mathrm{ref}}$:\n- at $T=333\\ \\mathrm{K}$, $a_{T}=3.73\\times 10^{4}$,\n- at $T=353\\ \\mathrm{K}$, $a_{T}=60.0$,\n- at $T=393\\ \\mathrm{K}$, $a_{T}=0.0587$.\n\nNear $T_{\\mathrm{ref}}$, take the shift factor to obey the Williams–Landel–Ferry (WLF) form with two temperature-independent constants. At the reference temperature $T_{\\mathrm{ref}}$, the storage modulus master curve is represented by a generalized Maxwell model with two Maxwell modes and a finite rubbery modulus,\n$$\nE'_{\\mathrm{ref}}(\\omega)=E_{\\infty}+\\sum_{k=1}^{2}\\Delta E_{k}\\,\\frac{\\omega^{2}\\tau_{k}^{2}}{1+\\omega^{2}\\tau_{k}^{2}},\n$$\nwith parameters $E_{\\infty}=5\\ \\mathrm{MPa}$, $\\Delta E_{1}=1500\\ \\mathrm{MPa}$ with $\\tau_{1}=1.0\\ \\mathrm{s}$, and $\\Delta E_{2}=5000\\ \\mathrm{MPa}$ with $\\tau_{2}=1.0\\times 10^{-2}\\ \\mathrm{s}$.\n\nUsing only fundamental definitions of linear viscoelastic response, the time–temperature superposition principle, and the WLF framework justified near the glass transition region, first determine the WLF constants from the measured $a_{T}$ data. Then, using these constants, predict the storage modulus $E'(\\omega)$ at the new temperature $T_{\\mathrm{new}}=383\\ \\mathrm{K}$ and angular frequency $\\omega=10.0\\ \\mathrm{rad}\\,\\mathrm{s}^{-1}$ by horizontally shifting the master curve. Express the final $E'$ in $\\mathrm{MPa}$ and round your answer to three significant figures.", "solution": "The problem as stated is subjected to validation.\n\nGivens are extracted verbatim:\n- Reference temperature: $T_{\\mathrm{ref}}=373\\ \\mathrm{K}$.\n- Time–temperature superposition principle holds, with the storage modulus at temperature $T$ given by $E'(T, \\omega) = E'_{\\mathrm{ref}}(\\omega a_T)$, where $a_T$ is the horizontal shift factor.\n- Measured shift factor data:\n    - At $T=333\\ \\mathrm{K}$, $a_{T}=3.73\\times 10^{4}$.\n    - At $T=353\\ \\mathrm{K}$, $a_{T}=60.0$.\n    - At $T=393\\ \\mathrm{K}$, $a_{T}=0.0587$.\n- The shift factor obeys the Williams–Landel–Ferry (WLF) equation: $\\log_{10}(a_T) = \\frac{-C_1(T-T_{\\mathrm{ref}})}{C_2 + (T-T_{\\mathrm{ref}})}$.\n- The storage modulus master curve at $T_{\\mathrm{ref}}$ is given by a generalized Maxwell model:\n$$\nE'_{\\mathrm{ref}}(\\omega)=E_{\\infty}+\\sum_{k=1}^{2}\\Delta E_{k}\\,\\frac{\\omega^{2}\\tau_{k}^{2}}{1+\\omega^{2}\\tau_{k}^{2}}\n$$\n- Parameters for the master curve: $E_{\\infty}=5\\ \\mathrm{MPa}$, $\\Delta E_{1}=1500\\ \\mathrm{MPa}$ with $\\tau_{1}=1.0\\ \\mathrm{s}$, and $\\Delta E_{2}=5000\\ \\mathrm{MPa}$ with $\\tau_{2}=1.0\\times 10^{-2}\\ \\mathrm{s}$.\n- The objective is to determine the WLF constants $C_1$ and $C_2$, and then calculate the storage modulus $E'$ at $T_{\\mathrm{new}}=383\\ \\mathrm{K}$ and $\\omega=10.0\\ \\mathrm{rad}\\,\\mathrm{s}^{-1}$, rounded to three significant figures.\n\nValidation assessment:\n- The problem is scientifically grounded, employing standard, well-established principles of linear viscoelasticity in polymer science, namely the time-temperature superposition principle, the WLF equation, and the generalized Maxwell model.\n- The problem is well-posed. It provides sufficient data to determine the model parameters and subsequently calculate the required quantity. The presence of three data points for two unknown constants ($C_1$, $C_2$) allows for a robust determination via linear regression.\n- The problem is objective and uses precise, quantitative language.\n- The setup is complete and consistent; all necessary models and data are provided. The values given are physically realistic for an amorphous polymer near its glass transition.\n\nVerdict: The problem is valid. A solution will be constructed.\n\nThe first step is to determine the WLF constants $C_1$ and $C_2$ from the provided experimental data. The WLF equation is given as:\n$$\n\\log_{10}(a_T) = \\frac{-C_1(T-T_{\\mathrm{ref}})}{C_2 + (T-T_{\\mathrm{ref}})}\n$$\nThis equation can be linearized by rearrangement:\n$$\n\\frac{1}{\\log_{10}(a_T)} = \\frac{C_2 + (T-T_{\\mathrm{ref}})}{-C_1(T-T_{\\mathrm{ref}})} = -\\frac{C_2}{C_1} \\frac{1}{(T-T_{\\mathrm{ref}})} - \\frac{1}{C_1}\n$$\nThis is an equation of a straight line $y = mx + c$, where $y = \\frac{1}{\\log_{10}(a_T)}$, $x = \\frac{1}{T-T_{\\mathrm{ref}}}$, the slope is $m = -\\frac{C_2}{C_1}$, and the y-intercept is $c = -\\frac{1}{C_1}$. From these relations, we can find the WLF constants: $C_1 = -1/c$ and $C_2 = -m C_1 = m/c$.\n\nWe transform the given data points $(T, a_T)$ into $(x, y)$ coordinates with $T_{\\mathrm{ref}} = 373\\ \\mathrm{K}$.\n\n1. For $T_1 = 333\\ \\mathrm{K}$:\n   $T_1 - T_{\\mathrm{ref}} = 333 - 373 = -40\\ \\mathrm{K}$.\n   $x_1 = \\frac{1}{-40} = -0.025\\ \\mathrm{K}^{-1}$.\n   $\\log_{10}(a_{T1}) = \\log_{10}(3.73 \\times 10^4) \\approx 4.5717$.\n   $y_1 = \\frac{1}{4.5717} \\approx 0.2187$.\n\n2. For $T_2 = 353\\ \\mathrm{K}$:\n   $T_2 - T_{\\mathrm{ref}} = 353 - 373 = -20\\ \\mathrm{K}$.\n   $x_2 = \\frac{1}{-20} = -0.05\\ \\mathrm{K}^{-1}$.\n   $\\log_{10}(a_{T2}) = \\log_{10}(60.0) \\approx 1.7782$.\n   $y_2 = \\frac{1}{1.7782} \\approx 0.5624$.\n\n3. For $T_3 = 393\\ \\mathrm{K}$:\n   $T_3 - T_{\\mathrm{ref}} = 393 - 373 = 20\\ \\mathrm{K}$.\n   $x_3 = \\frac{1}{20} = 0.05\\ \\mathrm{K}^{-1}$.\n   $\\log_{10}(a_{T3}) = \\log_{10}(0.0587) \\approx -1.2314$.\n   $y_3 = \\frac{1}{-1.2314} \\approx -0.8121$.\n\nWe perform a linear regression on the three points $(x_i, y_i)$: $(-0.025, 0.2187)$, $(-0.05, 0.5624)$, and $(0.05, -0.8121)$. The slope $m$ and intercept $c$ are found using the standard formulas for least-squares fitting.\n$\\sum x_i = -0.025$, $\\sum y_i \\approx -0.031$, $\\sum x_i^2 = 0.005625$, $\\sum x_i y_i \\approx -0.07419$.\n$m = \\frac{N \\sum(x_i y_i) - (\\sum x_i)(\\sum y_i)}{N \\sum(x_i^2) - (\\sum x_i)^2} \\approx \\frac{3(-0.07419) - (-0.025)(-0.031)}{3(0.005625) - (-0.025)^2} \\approx \\frac{-0.22335}{0.01625} \\approx -13.745$.\n$c = \\frac{\\sum y_i - m \\sum x_i}{N} \\approx \\frac{-0.031 - (-13.745)(-0.025)}{3} \\approx \\frac{-0.3746}{3} \\approx -0.1249$.\n\nNow, we calculate $C_1$ and $C_2$:\n$C_1 = -\\frac{1}{c} \\approx -\\frac{1}{-0.1249} \\approx 8.006$. This constant is dimensionless.\n$C_2 = \\frac{m}{c} \\approx \\frac{-13.745}{-0.1249} \\approx 110.05\\ \\mathrm{K}$.\n\nThe second step is to predict the storage modulus $E'$ at $T_{\\mathrm{new}}=383\\ \\mathrm{K}$ and $\\omega=10.0\\ \\mathrm{rad}\\,\\mathrm{s}^{-1}$.\nFirst, calculate the shift factor $a_T$ at $T_{\\mathrm{new}}$ using the derived WLF constants.\nThe temperature difference is $T_{\\mathrm{new}} - T_{\\mathrm{ref}} = 383 - 373 = 10\\ \\mathrm{K}$.\n$$\n\\log_{10}(a_T) = \\frac{-C_1(T_{\\mathrm{new}}-T_{\\mathrm{ref}})}{C_2 + (T_{\\mathrm{new}}-T_{\\mathrm{ref}})} = \\frac{-(8.006)(10)}{110.05 + 10} = \\frac{-80.06}{120.05} \\approx -0.6669\n$$\n$$\na_T = 10^{-0.6669} \\approx 0.2153\n$$\nNext, calculate the shifted frequency, $\\omega_{\\mathrm{shifted}} = \\omega a_T$:\n$$\n\\omega_{\\mathrm{shifted}} = (10.0\\ \\mathrm{rad}\\,\\mathrm{s}^{-1}) \\times (0.2153) = 2.153\\ \\mathrm{rad}\\,\\mathrm{s}^{-1}\n$$\nFinally, calculate the storage modulus $E'(T_{\\mathrm{new}}, \\omega)$ by evaluating the master curve $E'_{\\mathrm{ref}}$ at this shifted frequency:\n$$\nE'(383\\ \\mathrm{K}, 10.0\\ \\mathrm{rad}\\,\\mathrm{s}^{-1}) = E'_{\\mathrm{ref}}(2.153\\ \\mathrm{rad}\\,\\mathrm{s}^{-1})\n$$\nUsing the given generalized Maxwell model expression:\n$$\nE'_{\\mathrm{ref}}(\\omega_{\\mathrm{shifted}}) = E_{\\infty} + \\Delta E_{1}\\,\\frac{(\\omega_{\\mathrm{shifted}}\\tau_{1})^{2}}{1+(\\omega_{\\mathrm{shifted}}\\tau_{1})^{2}} + \\Delta E_{2}\\,\\frac{(\\omega_{\\mathrm{shifted}}\\tau_{2})^{2}}{1+(\\omega_{\\mathrm{shifted}}\\tau_{2})^{2}}\n$$\nSubstitute the parameter values: $E_{\\infty}=5\\ \\mathrm{MPa}$, $\\Delta E_{1}=1500\\ \\mathrm{MPa}$, $\\tau_{1}=1.0\\ \\mathrm{s}$, $\\Delta E_{2}=5000\\ \\mathrm{MPa}$, $\\tau_{2}=1.0\\times 10^{-2}\\ \\mathrm{s}$.\n\nContribution from Mode 1:\n$\\omega_{\\mathrm{shifted}}\\tau_1 = (2.153)(1.0) = 2.153$.\n$(\\omega_{\\mathrm{shifted}}\\tau_1)^2 = (2.153)^2 \\approx 4.635$.\nContribution $= 1500 \\times \\frac{4.635}{1+4.635} = 1500 \\times \\frac{4.635}{5.635} \\approx 1233.8\\ \\mathrm{MPa}$.\n\nContribution from Mode 2:\n$\\omega_{\\mathrm{shifted}}\\tau_2 = (2.153)(1.0\\times 10^{-2}) = 0.02153$.\n$(\\omega_{\\mathrm{shifted}}\\tau_2)^2 = (0.02153)^2 \\approx 4.635 \\times 10^{-4}$.\nContribution $= 5000 \\times \\frac{4.635 \\times 10^{-4}}{1+4.635 \\times 10^{-4}} \\approx 5000 \\times (4.633 \\times 10^{-4}) \\approx 2.317\\ \\mathrm{MPa}$.\n\nTotal storage modulus:\n$E' = E_{\\infty} + (\\text{Mode 1 contribution}) + (\\text{Mode 2 contribution})$\n$E' \\approx 5 + 1233.8 + 2.317 = 1241.117\\ \\mathrm{MPa}$.\n\nThe problem requires rounding to three significant figures.\n$1241.117\\ \\mathrm{MPa} \\approx 1240\\ \\mathrm{MPa}$. To represent this unambiguously with three significant figures, scientific notation is appropriate: $1.24 \\times 10^3\\ \\mathrm{MPa}$.", "answer": "$$\n\\boxed{1.24 \\times 10^3}\n$$", "id": "2530372"}, {"introduction": "In this final practice, we explore the rich data produced by coupled techniques, specifically Thermogravimetric Analysis-Mass Spectrometry (TGA-MS). You will develop a computational workflow to address a common challenge: deconvolving the overlapping signals of multiple gases evolving simultaneously from a material. By solving a non-negative inverse problem, you will reconstruct the individual evolution profiles of each gas, gaining hands-on experience with the powerful data analysis methods essential for modern evolved gas analysis (EGA) [@problem_id:2530370].", "problem": "A materials chemist performs Thermogravimetric Analysis coupled with Mass Spectrometry (TGA-MS) to monitor evolved gases during heating. At each temperature, the measured mass spectrum is a linear superposition of fragment ion intensities from the constituent gas species, subject to the physical constraint that species evolution rates are nonnegative. Assume linearity of response and time-invariant fragmentation patterns. You are given a fixed fragmentation library and synthetic datasets that follow these assumptions.\n\nModel and definitions:\n- Let the monitored mass-to-charge channels be $m/z \\in \\{12, 16, 17, 18, 28, 44\\}$.\n- Let the species set be $\\{\\text{H}_2\\text{O}, \\text{CO}_2, \\text{CO}\\}$, in that fixed order.\n- Let the fragmentation library be the matrix $\\mathbf{S} \\in \\mathbb{R}_{\\ge 0}^{6 \\times 3}$ whose rows correspond (in order) to $m/z \\in \\{12, 16, 17, 18, 28, 44\\}$ and whose columns correspond (in order) to $\\{\\text{H}_2\\text{O}, \\text{CO}_2, \\text{CO}\\}$:\n$$\n\\mathbf{S} =\n\\begin{bmatrix}\n0 & 0 & 0.05 \\\\\n0.03 & 0.05 & 0 \\\\\n0.22 & 0 & 0 \\\\\n1.00 & 0 & 0 \\\\\n0 & 0.11 & 1.00 \\\\\n0 & 1.00 & 0\n\\end{bmatrix}.\n$$\n- Let the temperature grid be $T_k = 300 + 5k$ for $k = 0, 1, \\dots, 120$ (all temperatures in Kelvin), so there are $121$ temperatures from $300\\,\\mathrm{K}$ to $900\\,\\mathrm{K}$ inclusive.\n- Let the instantaneous evolution rate (in arbitrary consistent intensity units per Kelvin) of species $j$ at temperature $T$ be modeled as a Gaussian peak:\n$$\nc_j(T) = A_j \\exp\\!\\left(-\\frac{(T - T_{0,j})^2}{2\\sigma_j^2}\\right),\n$$\nwith amplitude $A_j \\ge 0$, center $T_{0,j}$ (in Kelvin), and width parameter $\\sigma_j$ (in Kelvin).\n- At each temperature $T_k$, the measured intensity vector $\\mathbf{y}(T_k) \\in \\mathbb{R}^6$ is modeled as\n$$\n\\mathbf{y}(T_k) = \\mathbf{S}\\,\\mathbf{x}(T_k) + \\boldsymbol{\\varepsilon}(T_k),\n$$\nwhere $\\mathbf{x}(T_k) = [c_1(T_k), c_2(T_k), c_3(T_k)]^\\top \\in \\mathbb{R}_{\\ge 0}^3$, and $\\boldsymbol{\\varepsilon}(T_k)$ is zero-mean additive Gaussian noise with independent components of standard deviation $\\sigma_n = 5\\times 10^{-3}$ (in the same arbitrary intensity units as $\\mathbf{y}$).\n\nTask:\n- For each test case below, construct $\\mathbf{y}(T_k)$ by the above model using the specified Gaussian parameters and the fixed fragmentation library $\\mathbf{S}$. Use a pseudorandom generator with seed $0$ to realize the noise for all test cases (the same seed reused at the beginning of the program).\n- Reconstruct the nonnegative evolution profiles $\\widehat{\\mathbf{x}}(T_k)$ by solving, independently at each $T_k$, the nonnegative linear inverse problem\n$$\n\\min_{\\mathbf{x} \\in \\mathbb{R}_{\\ge 0}^3} \\, \\left\\| \\mathbf{S}\\,\\mathbf{x} - \\mathbf{y}(T_k) \\right\\|_2.\n$$\n- For each species $j \\in \\{1,2,3\\}$, compute its recovered temperature of maximum evolution\n$$\nT^{\\mathrm{peak}}_j = \\begin{cases}\n\\operatorname*{arg\\,max}_{k} \\, \\widehat{x}_j(T_k), & \\text{if } \\displaystyle \\int_{300}^{900} \\widehat{x}_j(T)\\,dT \\ge \\theta,\\\\\n-1.0, & \\text{otherwise},\n\\end{cases}\n$$\nwhere the integral is evaluated numerically by the composite trapezoidal rule over the grid $\\{T_k\\}$, the threshold is $\\theta = 0.01$ (in intensity–Kelvin units), and $\\operatorname*{arg\\,max}_k$ returns the temperature value $T_k$ at which the discrete maximum occurs (take the smallest $T_k$ in case of a tie). Report each $T^{\\mathrm{peak}}_j$ in Kelvin, rounded to the nearest integer. If $T^{\\mathrm{peak}}_j = -1.0$, leave it as $-1.0$.\n- Compute the overall reconstruction root-mean-square error\n$$\n\\mathrm{RMSE} = \\sqrt{ \\frac{1}{6 \\times 121} \\sum_{k=0}^{120} \\left\\| \\mathbf{y}(T_k) - \\mathbf{S}\\,\\widehat{\\mathbf{x}}(T_k) \\right\\|_2^2 },\n$$\nand report it as a floating-point number rounded to $4$ decimal places (in the same arbitrary intensity units as $\\mathbf{y}$).\n\nTest suite:\n- Case A (well-separated peaks; all species present):\n  - $\\text{H}_2\\text{O}$: $A_1 = 1.0$, $T_{0,1} = 373\\,\\mathrm{K}$, $\\sigma_1 = 20\\,\\mathrm{K}$.\n  - $\\text{CO}_2$: $A_2 = 0.8$, $T_{0,2} = 650\\,\\mathrm{K}$, $\\sigma_2 = 30\\,\\mathrm{K}$.\n  - $\\text{CO}$: $A_3 = 0.5$, $T_{0,3} = 600\\,\\mathrm{K}$, $\\sigma_3 = 25\\,\\mathrm{K}$.\n- Case B (one species absent; broad peak):\n  - $\\text{H}_2\\text{O}$: $A_1 = 0.7$, $T_{0,1} = 380\\,\\mathrm{K}$, $\\sigma_1 = 25\\,\\mathrm{K}$.\n  - $\\text{CO}_2$: $A_2 = 0.9$, $T_{0,2} = 700\\,\\mathrm{K}$, $\\sigma_2 = 35\\,\\mathrm{K}$.\n  - $\\text{CO}$: $A_3 = 0.0$, $T_{0,3} = 600\\,\\mathrm{K}$, $\\sigma_3 = 20\\,\\mathrm{K}$.\n- Case C (strongly overlapping $\\text{CO}$ and $\\text{CO}_2$ peaks):\n  - $\\text{H}_2\\text{O}$: $A_1 = 0.2$, $T_{0,1} = 500\\,\\mathrm{K}$, $\\sigma_1 = 20\\,\\mathrm{K}$.\n  - $\\text{CO}_2$: $A_2 = 0.7$, $T_{0,2} = 600\\,\\mathrm{K}$, $\\sigma_2 = 25\\,\\mathrm{K}$.\n  - $\\text{CO}$: $A_3 = 0.6$, $T_{0,3} = 600\\,\\mathrm{K}$, $\\sigma_3 = 20\\,\\mathrm{K}$.\n\nFinal output specification:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the following order:\n  - Case A: $T^{\\mathrm{peak}}_1$, $T^{\\mathrm{peak}}_2$, $T^{\\mathrm{peak}}_3$, $\\mathrm{RMSE}_A$.\n  - Case B: $T^{\\mathrm{peak}}_1$, $T^{\\mathrm{peak}}_2$, $T^{\\mathrm{peak}}_3$, $\\mathrm{RMSE}_B$.\n  - Case C: $T^{\\mathrm{peak}}_1$, $T^{\\mathrm{peak}}_2$, $T^{\\mathrm{peak}}_3$, $\\mathrm{RMSE}_C$.\n- Report all temperatures in Kelvin (rounded to the nearest integer) and each $\\mathrm{RMSE}$ rounded to $4$ decimal places. For any species deemed absent by the threshold criterion, report $-1.0$ in place of its peak temperature.", "solution": "The problem posed is a well-defined computational exercise in analytical chemistry, specifically concerning the deconvolution of data from Thermogravimetric Analysis coupled with Mass Spectrometry (TGA-MS). The problem is scientifically grounded, mathematically consistent, and all necessary parameters and procedures are provided unambiguously. There are no violations of fundamental principles or logical inconsistencies. The problem is therefore deemed **valid**, and a solution will be provided.\n\nThe core of the problem is to resolve overlapping signals from multiple chemical species. At each temperature point $T_k$, the measured mass spectrum $\\mathbf{y}(T_k)$ is modeled as a linear combination of the fragmentation patterns of the constituent species, plus noise. The model is expressed as a matrix equation:\n$$\n\\mathbf{y}(T_k) = \\mathbf{S}\\,\\mathbf{x}(T_k) + \\boldsymbol{\\varepsilon}(T_k)\n$$\nHere, $\\mathbf{S}$ is the $6 \\times 3$ fragmentation library matrix, where $S_{ij}$ represents the intensity contribution of species $j$ to the mass-to-charge channel $i$. The vector $\\mathbf{x}(T_k) \\in \\mathbb{R}^3$ contains the unknown evolution rates (concentrations) of the three species $\\{\\text{H}_2\\text{O}, \\text{CO}_2, \\text{CO}\\}$ at temperature $T_k$. The vector $\\boldsymbol{\\varepsilon}(T_k)$ represents measurement noise.\n\nThe task is bipartite:\n1.  **Forward Problem (Data Synthesis):** First, we synthesize the \"measured\" data $\\mathbf{y}(T_k)$ for each test case. This involves computing the true species evolution rates $c_j(T)$ using the provided Gaussian model, forming the vector $\\mathbf{x}(T_k)$, multiplying by the matrix $\\mathbf{S}$, and adding pseudo-random Gaussian noise with the specified standard deviation $\\sigma_n = 5 \\times 10^{-3}$.\n\n2.  **Inverse Problem (Data Analysis):** Second, using the synthesized data $\\mathbf{y}(T_k)$, we must reconstruct the species evolution rates, denoted $\\widehat{\\mathbf{x}}(T_k)$. This is achieved by solving an inverse problem. Since evolution rates are physical quantities that cannot be negative, we impose a non-negativity constraint. For each temperature $T_k$, we solve the following Non-Negative Least Squares (NNLS) optimization problem:\n$$\n\\min_{\\mathbf{x} \\in \\mathbb{R}_{\\ge 0}^3} \\, \\left\\| \\mathbf{S}\\,\\mathbf{x} - \\mathbf{y}(T_k) \\right\\|_2\n$$\nThis is a standard convex optimization problem that yields a unique solution for $\\widehat{\\mathbf{x}}(T_k)$. This procedure is performed independently for each of the $121$ temperature points.\n\nAfter reconstructing the evolution profiles $\\widehat{x}_j(T_k)$ for each species $j$, we perform two analyses:\n\n- **Peak Temperature Identification:** For each species, its presence is determined by evaluating its total integrated evolution over the temperature range. The integral is computed numerically using the composite trapezoidal rule. If this integral, $\\int_{300}^{900} \\widehat{x}_j(T)\\,dT$, is below a threshold $\\theta = 0.01$, the species is considered absent, and its peak temperature is reported as $-1.0$. Otherwise, the peak temperature $T^{\\mathrm{peak}}_j$ is the temperature $T_k$ at which the reconstructed profile $\\widehat{x}_j(T_k)$ reaches its maximum value.\n\n- **Error Quantification:** The overall quality of the reconstruction is assessed by the Root-Mean-Square Error (RMSE), which measures the average deviation between the original synthetic data $\\mathbf{y}(T_k)$ and the data predicted from the reconstructed concentrations, $\\mathbf{S}\\widehat{\\mathbf{x}}(T_k)$. The formula is:\n$$\n\\mathrm{RMSE} = \\sqrt{ \\frac{1}{N_m N_T} \\sum_{k=0}^{N_T-1} \\left\\| \\mathbf{y}(T_k) - \\mathbf{S}\\,\\widehat{\\mathbf{x}}(T_k) \\right\\|_2^2 }\n$$\nwhere $N_m=6$ is the number of mass channels and $N_T=121$ is the number of temperature points.\n\nThe implementation will utilize the `numpy` library for efficient array operations and `scipy.optimize.nnls` to solve the NNLS problem at each temperature step. The entire process will be systematically applied to each of the three test cases provided.", "answer": "```python\nimport numpy as np\nfrom scipy.optimize import nnls\n\ndef solve():\n    \"\"\"\n    Solves the TGA-MS deconvolution problem for three test cases.\n    \"\"\"\n\n    # Global constants and definitions from the problem statement\n    S = np.array([\n        [0.00, 0.00, 0.05],  # m/z 12\n        [0.03, 0.05, 0.00],  # m/z 16\n        [0.22, 0.00, 0.00],  # m/z 17\n        [1.00, 0.00, 0.00],  # m/z 18\n        [0.00, 0.11, 1.00],  # m/z 28\n        [0.00, 1.00, 0.00]   # m/z 44\n    ])\n    num_mz_channels, num_species = S.shape\n\n    T = np.linspace(300.0, 900.0, 121)\n    num_temps = len(T)\n    \n    sigma_n = 5e-3\n    theta = 0.01\n    \n    # Initialize a single random number generator for all test cases\n    rng = np.random.default_rng(0)\n\n    # Test suite parameters\n    # Each case: [(A1, T0_1, s1), (A2, T0_2, s2), (A3, T0_3, s3)]\n    test_cases = [\n        # Case A\n        [(1.0, 373.0, 20.0), (0.8, 650.0, 30.0), (0.5, 600.0, 25.0)],\n        # Case B\n        [(0.7, 380.0, 25.0), (0.9, 700.0, 35.0), (0.0, 600.0, 20.0)],\n        # Case C\n        [(0.2, 500.0, 20.0), (0.7, 600.0, 25.0), (0.6, 600.0, 20.0)],\n    ]\n\n    # Function to model species evolution rate\n    def gaussian_peak(T_grid, A, T0, sigma):\n        if A == 0:\n            return np.zeros_like(T_grid)\n        return A * np.exp(-(T_grid - T0)**2 / (2 * sigma**2))\n\n    all_results = []\n\n    for case_params in test_cases:\n        # Step 1: Forward Problem - Synthesize dataset\n        X_true = np.zeros((num_species, num_temps))\n        for j in range(num_species):\n            A_j, T0_j, sigma_j = case_params[j]\n            X_true[j, :] = gaussian_peak(T, A_j, T0_j, sigma_j)\n\n        # Add Gaussian noise\n        noise = rng.normal(0, sigma_n, size=(num_mz_channels, num_temps))\n        Y = S @ X_true + noise\n\n        # Step 2: Inverse Problem - Reconstruct evolution profiles\n        X_hat = np.zeros((num_species, num_temps))\n        for k in range(num_temps):\n            y_k = Y[:, k]\n            # Solve the Non-Negative Least Squares problem\n            x_hat_k, _ = nnls(S, y_k)\n            X_hat[:, k] = x_hat_k\n\n        # Step 3: Compute recovered peak temperatures\n        peak_temps = []\n        for j in range(num_species):\n            profile = X_hat[j, :]\n            \n            # Compute integrated intensity using the trapezoidal rule\n            integral = np.trapz(profile, T)\n            \n            if integral >= theta:\n                # Find temperature of maximum evolution\n                peak_idx = np.argmax(profile)\n                T_peak = T[peak_idx]\n                peak_temps.append(int(np.round(T_peak)))\n            else:\n                # Species is considered absent\n                peak_temps.append(-1.0)\n        \n        # Step 4: Compute overall reconstruction RMSE\n        Y_hat = S @ X_hat\n        rmse = np.sqrt(np.mean((Y - Y_hat)**2))\n        \n        # Store results for the case\n        case_results = peak_temps + [round(rmse, 4)]\n        all_results.extend(case_results)\n\n    # Final print statement in the exact required format\n    print(f\"[{','.join(map(str, all_results))}]\")\n\nsolve()\n```", "id": "2530370"}]}