{"hands_on_practices": [{"introduction": "Understanding the motion of a single active particle is the first step toward deciphering the complexities of active matter. This exercise guides you through a foundational analysis of two canonical models: the Active Brownian Particle (ABP) and the Run-and-Tumble Particle (RTP). By deriving the mean-squared displacement from first principles, you will quantitatively explore the hallmark of active motionâ€”the crossover from ballistic behavior at short times to diffusive behavior at long times [@problem_id:2906697]. This practice provides a solid theoretical basis for interpreting the trajectories of self-propelled entities.", "problem": "Consider a single self-propelled particle in a $d$-dimensional isotropic fluid medium at constant temperature, modeled in two different ways: as an active Brownian particle (ABP) and as a run-and-tumble particle (RTP). In both models, the particle position $\\mathbf{r}(t)$ evolves according to the overdamped kinematics $d\\mathbf{r}/dt = \\mathbf{v}(t) + \\sqrt{2 D_t}\\,\\boldsymbol{\\xi}(t)$, where $\\mathbf{v}(t) = v_0 \\mathbf{n}(t)$ with constant self-propulsion speed $v_0$, $D_t$ is the translational diffusivity, and $\\boldsymbol{\\xi}(t)$ is zero-mean Gaussian white noise with unit variance and uncorrelated with $\\mathbf{n}(t)$. The unit vector $\\mathbf{n}(t)$ is the instantaneous orientation of the self-propulsion. For the ABP, $\\mathbf{n}(t)$ undergoes isotropic rotational diffusion on the unit $(d-1)$-sphere with rotational diffusion coefficient $D_r$. For the RTP, $\\mathbf{n}(t)$ is piecewise constant between instantaneous tumbles that occur as a Poisson process of rate $\\alpha$; each tumble resets $\\mathbf{n}(t)$ to an isotropically distributed direction, independent of its previous value.\n\nUsing only fundamental definitions and first principles (e.g., time integration of velocity, stationarity and isotropy, and the relation between the mean-squared displacement and the velocity autocorrelation), perform the following tasks:\n\n1. Starting from $\\Delta \\mathbf{r}(t) = \\int_0^t \\mathbf{v}(s)\\,ds + \\text{thermal contribution}$, derive an exact expression for the mean-squared displacement $\\langle |\\Delta \\mathbf{r}(t)|^2 \\rangle$ in terms of the orientation autocorrelation function $C_n(t) = \\langle \\mathbf{n}(t)\\cdot \\mathbf{n}(0)\\rangle$.\n2. For the ABP, show that $C_n(t)$ is a single exponential in time with a decorrelation rate that depends on $d$ and $D_r$, and use this result to obtain the active contribution to the long-time diffusivity, denoted $D_a^{\\mathrm{ABP}}$.\n3. For the RTP, compute $C_n(t)$ and the corresponding active contribution to the long-time diffusivity, denoted $D_a^{\\mathrm{RTP}}$.\n4. Define the ballistic-to-diffusive crossover time $t_c$ as the unique positive time at which the leading-order short-time ballistic contribution from self-propulsion, $v_0^2 t^2$, equals twice the leading-order long-time diffusive contribution from self-propulsion alone, that is,\n$$\nv_0^2 t_c^2 = 2 d\\, D_a\\, t_c,\n$$\nwhere $D_a$ is the active contribution to the long-time diffusivity for the model under consideration. Using this operational definition, obtain closed-form expressions for $t_c^{\\mathrm{ABP}}$ and $t_c^{\\mathrm{RTP}}$ in terms of $d$, $D_r$, and $\\alpha$.\n5. Based on your expressions for the mean-squared displacement, compare the scaling with time at intermediate times for the ABP and the RTP, identifying any qualitative similarity or difference in how the crossover occurs.\n\nReturn your final answer as a row matrix containing $t_c^{\\mathrm{ABP}}$ and $t_c^{\\mathrm{RTP}}$ in that order. Work in the International System of Units (SI) and express times in seconds. Do not include units in the final boxed answer. No numerical rounding is required; provide exact symbolic expressions.", "solution": "The problem statement is subjected to validation before a solution is attempted.\n\nFirst, the givens are extracted verbatim from the problem statement:\n- Particle position evolves according to the overdamped kinematics $d\\mathbf{r}/dt = \\mathbf{v}(t) + \\sqrt{2 D_t}\\,\\boldsymbol{\\xi}(t)$.\n- The self-propulsion velocity is $\\mathbf{v}(t) = v_0 \\mathbf{n}(t)$, where $v_0$ is a constant speed.\n- The orientation $\\mathbf{n}(t)$ is a unit vector.\n- The thermal noise $\\boldsymbol{\\xi}(t)$ is zero-mean Gaussian white noise with unit variance, specifically satisfying $\\langle \\xi_i(t) \\xi_j(t') \\rangle = \\delta_{ij} \\delta(t-t')$, and is uncorrelated with $\\mathbf{n}(t)$.\n- The translational diffusivity is $D_t$.\n- For an Active Brownian Particle (ABP), $\\mathbf{n}(t)$ undergoes isotropic rotational diffusion on the unit $(d-1)$-sphere with rotational diffusion coefficient $D_r$.\n- For a Run-and-Tumble Particle (RTP), $\\mathbf{n}(t)$ tumbles with a Poisson rate $\\alpha$, after which it is reset to a new, isotropically random direction.\n- The orientation autocorrelation function is defined as $C_n(t) = \\langle \\mathbf{n}(t)\\cdot \\mathbf{n}(0)\\rangle$.\n- The crossover time $t_c$ is defined by the relation $v_0^2 t_c^2 = 2 d\\, D_a\\, t_c$, where $D_a$ is the active contribution to the long-time diffusivity.\n\nThe problem is now validated against the required criteria.\n- **Scientifically Grounded**: The problem is based on the canonical models of Active Brownian Particles and Run-and-Tumble Particles, which are cornerstones of the physics of active matter. The mathematical framework used is that of stochastic differential equations (Langevin equations), which is standard in statistical mechanics. The problem is free of pseudoscience and factual error.\n- **Well-Posed and Objective**: The problem provides all necessary definitions, constants, and model descriptions. The tasks are clearly stated and lead to a unique, meaningful solution based on established physical principles. The language is precise and objective.\n- **Completeness**: The problem is self-contained and does not suffer from missing or contradictory information.\n\nThe verdict is that the problem is valid. We may proceed to a solution.\n\nThe displacement of the particle over a time interval $t$ is given by integrating the equation of motion:\n$$\n\\Delta \\mathbf{r}(t) = \\mathbf{r}(t) - \\mathbf{r}(0) = \\int_0^t \\left( v_0 \\mathbf{n}(s) + \\sqrt{2 D_t} \\boldsymbol{\\xi}(s) \\right) ds\n$$\nThe mean-squared displacement (MSD) is $\\langle |\\Delta \\mathbf{r}(t)|^2 \\rangle = \\langle \\Delta \\mathbf{r}(t) \\cdot \\Delta \\mathbf{r}(t) \\rangle$. We expand this expression:\n$$\n\\langle |\\Delta \\mathbf{r}(t)|^2 \\rangle = \\left\\langle \\left( \\int_0^t v_0 \\mathbf{n}(s) ds \\right) \\cdot \\left( \\int_0^t v_0 \\mathbf{n}(s') ds' \\right) \\right\\rangle + \\left\\langle \\left( \\int_0^t \\sqrt{2 D_t} \\boldsymbol{\\xi}(s) ds \\right) \\cdot \\left( \\int_0^t \\sqrt{2 D_t} \\boldsymbol{\\xi}(s') ds' \\right) \\right\\rangle + 2 \\left\\langle \\left( \\int_0^t v_0 \\mathbf{n}(s) ds \\right) \\cdot \\left( \\int_0^t \\sqrt{2 D_t} \\boldsymbol{\\xi}(s') ds' \\right) \\right\\rangle\n$$\nThe first term is the active contribution. The second is the thermal contribution. The third is the cross-term. Since the orientation $\\mathbf{n}(s)$ and the thermal noise $\\boldsymbol{\\xi}(s')$ are uncorrelated for all $s$ and $s'$, and $\\boldsymbol{\\xi}$ has zero mean, the cross-term vanishes.\n\nLet us evaluate the thermal contribution:\n$$\n\\langle |\\Delta \\mathbf{r}(t)|_{\\text{thermal}}^2 \\rangle = 2 D_t \\int_0^t ds \\int_0^t ds' \\langle \\boldsymbol{\\xi}(s) \\cdot \\boldsymbol{\\xi}(s') \\rangle = 2 D_t \\int_0^t ds \\int_0^t ds' \\sum_{i=1}^d \\langle \\xi_i(s) \\xi_i(s') \\rangle\n$$\nUsing the property of white noise, $\\langle \\xi_i(s) \\xi_i(s') \\rangle = \\delta(s-s')$, we have:\n$$\n\\langle |\\Delta \\mathbf{r}(t)|_{\\text{thermal}}^2 \\rangle = 2 D_t \\int_0^t ds \\int_0^t ds' \\sum_{i=1}^d \\delta(s-s') = 2 D_t \\int_0^t ds \\cdot d = 2 d D_t t\n$$\nNow, we evaluate the active contribution in terms of $C_n(t)$:\n$$\n\\langle |\\Delta \\mathbf{r}(t)|_{\\text{active}}^2 \\rangle = v_0^2 \\int_0^t ds \\int_0^t ds' \\langle \\mathbf{n}(s) \\cdot \\mathbf{n}(s') \\rangle\n$$\nDue to the stationarity of the underlying stochastic process for the orientation, the correlation function only depends on the time difference: $\\langle \\mathbf{n}(s) \\cdot \\mathbf{n}(s') \\rangle = C_n(|s-s'|)$. The double integral can be transformed using the substitution $\\tau = s-s'$ and $u = s+s'$. More directly, it can be written as:\n$$\n\\int_0^t ds \\int_0^t ds' C_n(|s-s'|) = 2 \\int_0^t d\\tau (t-\\tau) C_n(\\tau)\n$$\nTherefore, the total MSD is:\n$$\n\\langle |\\Delta \\mathbf{r}(t)|^2 \\rangle = 2 d D_t t + 2 v_0^2 \\int_0^t (t-\\tau) C_n(\\tau) d\\tau\n$$\nThis completes Task 1.\n\nFor Task 2 (ABP), we must find $C_n(t)$. The orientation vector $\\mathbf{n}(t)$ undergoes rotational diffusion on a $(d-1)$-sphere. The evolution of its probability distribution is governed by the rotational diffusion equation $\\partial_t P = D_r \\nabla_S^2 P$, where $\\nabla_S^2$ is the Laplace-Beltrami operator on the sphere. The orientation autocorrelation function $C_n(t) = \\langle \\mathbf{n}(t) \\cdot \\mathbf{n}(0) \\rangle$ can be calculated by considering the relaxation of the first spherical harmonic. The eigenvalues of the operator $-\\nabla_S^2$ are $\\lambda_l = l(l+d-2)$ for spherical harmonics of degree $l$. The components of the vector $\\mathbf{n}$ are first-degree ($l=1$) spherical harmonics. The correlation function of any $l=1$ mode decays with the corresponding eigenvalue $\\lambda_1 = 1(1+d-2) = d-1$. Thus, the decorrelation rate is $(d-1)D_r$.\n$$\nC_n(t) = \\langle \\mathbf{n}(0) \\cdot \\mathbf{n}(0) \\rangle \\exp(-(d-1)D_r t) = \\exp(-(d-1)D_r t)\n$$\nThe long-time effective diffusivity $D_{\\text{eff}}$ is found from the long-time limit of the MSD: $D_{\\text{eff}} = \\lim_{t\\to\\infty} \\frac{\\langle |\\Delta \\mathbf{r}(t)|^2 \\rangle}{2dt}$. The total MSD is $\\langle |\\Delta\\mathbf{r}(t)|^2\\rangle = 2dD_t t + 2 v_0^2 \\int_0^t (t-\\tau) C_n(\\tau)d\\tau$. In the limit $t \\to \\infty$, the integral $\\int_0^t (t-\\tau) C_n(\\tau)d\\tau \\approx t \\int_0^\\infty C_n(\\tau)d\\tau$.\nSo, $\\lim_{t\\to\\infty} \\langle |\\Delta \\mathbf{r}(t)|^2 \\rangle \\approx 2 d D_t t + 2 v_0^2 t \\int_0^\\infty C_n(\\tau) d\\tau$.\nThe effective diffusivity is $D_{\\text{eff}} = D_t + D_a$, where the active contribution is:\n$$\nD_a = \\frac{v_0^2}{d} \\int_0^\\infty C_n(\\tau)d\\tau\n$$\nFor the ABP, we compute this integral:\n$$\n\\int_0^\\infty C_n(\\tau)d\\tau = \\int_0^\\infty \\exp(-(d-1)D_r \\tau) d\\tau = \\frac{1}{(d-1)D_r}\n$$\nSo, the active diffusivity for the ABP is:\n$$\nD_a^{\\mathrm{ABP}} = \\frac{v_0^2}{d(d-1)D_r}\n$$\nThis completes Task 2.\n\nFor Task 3 (RTP), we find its orientation autocorrelation $C_n(t)$. A tumble event, occurring at rate $\\alpha$, randomizes the orientation. The probability that no tumble occurs in the interval $[0, t]$ is given by the Poisson distribution, $P_0(t) = \\exp(-\\alpha t)$. If no tumble occurs, $\\mathbf{n}(t) = \\mathbf{n}(0)$. If one or more tumbles occur, the new orientation is uncorrelated with the initial one, so $\\langle \\mathbf{n}(t) \\cdot \\mathbf{n}(0) \\rangle_{\\text{tumbled}} = 0$.\nThe total correlation is the weighted average:\n$$\nC_n(t) = \\langle \\mathbf{n}(t) \\cdot \\mathbf{n}(0) \\rangle = \\langle \\mathbf{n}(0) \\cdot \\mathbf{n}(0) \\rangle \\cdot P_0(t) + \\langle \\mathbf{n}(t) \\cdot \\mathbf{n}(0) \\rangle_{\\text{tumbled}} \\cdot (1-P_0(t))\n$$\n$$\nC_n(t) = 1 \\cdot \\exp(-\\alpha t) + 0 \\cdot (1-\\exp(-\\alpha t)) = \\exp(-\\alpha t)\n$$\nNow we compute the active diffusivity $D_a^{\\mathrm{RTP}}$:\n$$\n\\int_0^\\infty C_n(\\tau)d\\tau = \\int_0^\\infty \\exp(-\\alpha \\tau) d\\tau = \\frac{1}{\\alpha}\n$$\n$$\nD_a^{\\mathrm{RTP}} = \\frac{v_0^2}{d\\alpha}\n$$\nThis completes Task 3.\n\nFor Task 4, we compute the crossover times $t_c$ using the given definition: $v_0^2 t_c^2 = 2 d D_a t_c$. Since we assume $t_c > 0$, we can divide by $v_0^2 t_c$:\n$$\nt_c = \\frac{2d D_a}{v_0^2}\n$$\nFor the ABP:\n$$\nt_c^{\\mathrm{ABP}} = \\frac{2d}{v_0^2} D_a^{\\mathrm{ABP}} = \\frac{2d}{v_0^2} \\frac{v_0^2}{d(d-1)D_r} = \\frac{2}{(d-1)D_r}\n$$\nFor the RTP:\n$$\nt_c^{\\mathrm{RTP}} = \\frac{2d}{v_0^2} D_a^{\\mathrm{RTP}} = \\frac{2d}{v_0^2} \\frac{v_0^2}{d\\alpha} = \\frac{2}{\\alpha}\n$$\nThis completes Task 4.\n\nFor Task 5, we compare the intermediate-time scaling. The active part of the MSD is given by $\\text{MSD}_a(t) = 2 v_0^2 \\int_0^t (t-\\tau) C_n(\\tau) d\\tau$.\nFor the ABP, let $\\tau_p^{\\mathrm{ABP}} = 1/((d-1)D_r)$. Then $C_n(t) = \\exp(-t/\\tau_p^{\\mathrm{ABP}})$.\nFor the RTP, let $\\tau_p^{\\mathrm{RTP}} = 1/\\alpha$. Then $C_n(t) = \\exp(-t/\\tau_p^{\\mathrm{RTP}})$.\nIn both cases, the correlation function is a single exponential, $C_n(t) = \\exp(-t/\\tau_p)$, where $\\tau_p$ is the persistence time of the orientation.\nLet us perform the integration for a generic exponential correlation:\n$$\n\\int_0^t (t-\\tau) \\exp(-\\tau/\\tau_p) d\\tau = \\left[ -(t-\\tau)\\tau_p \\exp(-\\tau/\\tau_p) \\right]_0^t - \\int_0^t (-\\tau_p) \\exp(-\\tau/\\tau_p) (-1) d\\tau\n$$\n$$\n= t\\tau_p - \\tau_p \\int_0^t \\exp(-\\tau/\\tau_p) d\\tau = t\\tau_p - \\tau_p [-\\tau_p \\exp(-\\tau/\\tau_p)]_0^t = t\\tau_p - \\tau_p^2 (1 - \\exp(-t/\\tau_p))\n$$\nThus, for both models, the active contribution to the MSD has the same functional form when expressed in terms of the respective persistence time $\\tau_p$:\n$$\n\\text{MSD}_a(t) = 2 v_0^2 \\tau_p^2 \\left( \\frac{t}{\\tau_p} - 1 + \\exp(-t/\\tau_p) \\right)\n$$\nThe crossover from the short-time ballistic regime ($\\text{MSD}_a(t) \\approx v_0^2 t^2$ for $t \\ll \\tau_p$) to the long-time diffusive regime ($\\text{MSD}_a(t) \\approx (2 v_0^2 \\tau_p) t$ for $t \\gg \\tau_p$) is therefore qualitatively identical for both models. The fundamental difference lies in the physical mechanism that sets the persistence time $\\tau_p$: continuous rotational diffusion for the ABP versus discrete, instantaneous tumbles for the RTP. However, the resulting macroscopic motion, as characterized by the mean-squared displacement, exhibits the same crossover behavior.\n\nThe final answer requires the expressions for $t_c^{\\mathrm{ABP}}$ and $t_c^{\\mathrm{RTP}}$.\n$t_c^{\\mathrm{ABP}} = \\frac{2}{(d-1)D_r}$\n$t_c^{\\mathrm{RTP}} = \\frac{2}{\\alpha}$\nThese are to be presented in a row matrix.", "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{2}{(d-1)D_r} & \\frac{2}{\\alpha} \\end{pmatrix}}\n$$", "id": "2906697"}, {"introduction": "Theoretical models gain their power when they can be connected to real-world measurements. This practice bridges that gap by simulating a common task in experimental active matter: extracting key physical parameters from observed trajectories [@problem_id:2906653]. You will learn how to devise estimators for the self-propulsion speed $v_0$ and rotational diffusivity $D_r$ that are robust against common experimental artifacts like localization noise and finite time-sampling. This exercise hones analytical skills crucial for interpreting data from particle-tracking experiments.", "problem": "A dilute ensemble of two-dimensional Active Brownian Particles (ABPs) is tracked at discrete times $t_{n} = n \\Delta$ over a finite observation window of duration $T = N \\Delta$, where $\\Delta$ is the frame interval and $N \\gg 1$. Each particle obeys the overdamped kinematics\n$$\n\\dot{\\boldsymbol{r}}(t) = v_{0}\\,\\boldsymbol{u}(t) + \\sqrt{2 D_{t}}\\,\\boldsymbol{\\xi}(t),\n\\qquad\n\\dot{\\theta}(t) = \\sqrt{2 D_{r}}\\,\\eta(t),\n$$\nwhere $\\boldsymbol{r}(t)$ is the position, $\\boldsymbol{u}(t) = (\\cos\\theta(t), \\sin\\theta(t))$ is the orientation, $v_{0}$ is the constant self-propulsion speed, $D_{t}$ is the translational diffusivity, $D_{r}$ is the rotational diffusivity, and $\\boldsymbol{\\xi}(t)$ and $\\eta(t)$ are independent Gaussian white noises with zero mean and unit variance. The orientation correlation is stationary with $\\langle \\boldsymbol{u}(t)\\cdot \\boldsymbol{u}(t+\\tau)\\rangle = \\exp(-D_{r}\\tau)$.\n\nPositions are recorded with independent, zero-mean localization noise at each frame, so the measured position is $\\boldsymbol{r}_{\\mathrm{m}}(t_{n}) = \\boldsymbol{r}(t_{n}) + \\boldsymbol{\\eta}_{n}$ with $\\langle \\eta_{n,\\alpha}\\rangle = 0$ and $\\langle \\eta_{n,\\alpha}\\eta_{m,\\beta}\\rangle = \\sigma^{2}\\delta_{nm}\\delta_{\\alpha\\beta}$ for Cartesian components $\\alpha,\\beta \\in \\{x,y\\}$. Define the empirical mean-squared displacement (MSD) at lag $\\tau = k \\Delta$ by\n$$\nM_{\\mathrm{m}}(k\\Delta) = \\left\\langle \\left| \\boldsymbol{r}_{\\mathrm{m}}(t_{n+k}) - \\boldsymbol{r}_{\\mathrm{m}}(t_{n}) \\right|^{2} \\right\\rangle_{n},\n$$\nand the coarse-grained velocity by the forward difference $\\boldsymbol{v}_{\\mathrm{m}}(t_{n}) = \\big(\\boldsymbol{r}_{\\mathrm{m}}(t_{n+1}) - \\boldsymbol{r}_{\\mathrm{m}}(t_{n})\\big)/\\Delta$, with the empirical velocity autocorrelation function (VACF) at lag $\\ell \\Delta$ given by\n$$\nC_{\\mathrm{m}}(\\ell \\Delta) = \\left\\langle \\boldsymbol{v}_{\\mathrm{m}}(t_{n}) \\cdot \\boldsymbol{v}_{\\mathrm{m}}(t_{n+\\ell}) \\right\\rangle_{n}.\n$$\nAssume $1 \\le \\ell \\le \\ell_{\\max} \\ll N$ so that time averages are well defined and edge effects are negligible. You may assume the ergodic limit where empirical averages equal ensemble averages up to statistical error.\n\nStarting strictly from the stated stochastic kinematics, definitions, and the known orientation correlation, derive estimators for the self-propulsion speed $v_{0}$ and rotational diffusivity $D_{r}$ that are robust to localization noise $\\sigma^{2}$ and finite differencing. Specifically:\n\n1) Derive the expected functional form of the MSD, $M_{\\mathrm{m}}(\\tau)$, including the contribution of localization noise. Use this to construct a small-lag combination of three positive lags $\\tau_{s} = \\Delta$, $2\\Delta$, and $3\\Delta$ that cancels both the constant noise offset and the linear-in-time diffusive term, yielding a leading-order estimate of $v_{0}^{2}$ that is asymptotically unbiased as $D_{r} \\Delta \\to 0$.\n\n2) Derive the expected functional form of the coarse-grained VACF, $C_{\\mathrm{m}}(\\ell \\Delta)$, for integer $\\ell \\ge 1$. Show that for $\\ell \\ge 1$ neither translational diffusion nor localization noise contributes, and that the finite differencing over $\\Delta$ produces a multiplicative shape factor depending only on $D_{r}\\Delta$. Use the ratio of $C_{\\mathrm{m}}(\\ell_{1}\\Delta)$ and $C_{\\mathrm{m}}(\\ell_{2}\\Delta)$, with integers $\\ell_{2} > \\ell_{1} \\ge 1$, to eliminate the unknown amplitude and obtain a closed-form estimator of $D_{r}$ that is valid for arbitrary $D_{r}\\Delta$.\n\nProvide your final estimators $\\hat{v}_{0}$ and $\\hat{D}_{r}$ explicitly in terms of the measured $M_{\\mathrm{m}}(\\Delta)$, $M_{\\mathrm{m}}(2\\Delta)$, $M_{\\mathrm{m}}(3\\Delta)$, $C_{\\mathrm{m}}(\\ell_{1}\\Delta)$, $C_{\\mathrm{m}}(\\ell_{2}\\Delta)$, $\\Delta$, $\\ell_{1}$, and $\\ell_{2}$. No numerical values are required. The final answer must be a single analytical expression for the pair $(\\hat{v}_{0}, \\hat{D}_{r})$; do not include any units in the final answer box. If any approximation is used, clearly state the regime of validity in your derivation. Do not round any quantities.", "solution": "The problem as stated is scientifically sound, well-posed, objective, and self-contained within the established framework of active matter physics. It presents a standard, albeit non-trivial, analytical task based on the Active Brownian Particle (ABP) model. The problem is therefore deemed valid and a full derivation is warranted.\n\nThe solution is partitioned into two sub-problems as requested: first, the derivation of an estimator for the self-propulsion speed $v_{0}$, and second, an estimator for the rotational diffusivity $D_{r}$.\n\n**Part 1: Estimator for Self-Propulsion Speed $v_{0}$**\n\nWe begin by deriving the theoretical mean-squared displacement (MSD) for an ABP, including the effects of translational diffusion and measurement noise. The position $\\boldsymbol{r}(t)$ evolves according to the Langevin equation $\\dot{\\boldsymbol{r}}(t) = v_{0}\\,\\boldsymbol{u}(t) + \\sqrt{2 D_{t}}\\,\\boldsymbol{\\xi}(t)$. The displacement over a time interval $\\tau$ is\n$$\n\\Delta\\boldsymbol{r}(\\tau) = \\boldsymbol{r}(t+\\tau) - \\boldsymbol{r}(t) = v_{0} \\int_{t}^{t+\\tau} \\boldsymbol{u}(s)ds + \\sqrt{2 D_{t}} \\int_{t}^{t+\\tau} \\boldsymbol{\\xi}(s)ds.\n$$\nThe true MSD, $M(\\tau) = \\langle |\\Delta\\boldsymbol{r}(\\tau)|^{2} \\rangle$, is computed by taking the ensemble average of the squared magnitude. The self-propulsion and translational noise terms are uncorrelated, so their cross-term vanishes upon averaging. The total MSD is the sum of the contributions from each term.\nThe contribution from translational diffusion is standard: $\\langle |\\sqrt{2 D_{t}} \\int_{t}^{t+\\tau} \\boldsymbol{\\xi}(s)ds|^{2} \\rangle = 4D_{t}\\tau$ for two dimensions.\nThe contribution from active motion is\n$$\nv_{0}^{2} \\left\\langle \\left| \\int_{t}^{t+\\tau} \\boldsymbol{u}(s)ds \\right|^{2} \\right\\rangle = v_{0}^{2} \\int_{t}^{t+\\tau} \\int_{t}^{t+\\tau} \\langle \\boldsymbol{u}(s) \\cdot \\boldsymbol{u}(s') \\rangle ds ds'.\n$$\nUsing the stationary orientation correlation $\\langle \\boldsymbol{u}(s) \\cdot \\boldsymbol{u}(s') \\rangle = \\exp(-D_{r}|s-s'|)$, this double integral evaluates to\n$$\nv_{0}^{2} \\int_{0}^{\\tau} \\int_{0}^{\\tau} \\exp(-D_{r}|s-s'|) ds ds' = \\frac{2v_{0}^{2}}{D_{r}^{2}} \\left( D_{r}\\tau - 1 + \\exp(-D_{r}\\tau) \\right).\n$$\nThus, the true MSD is $M(\\tau) = \\frac{2v_{0}^{2}}{D_{r}^{2}} (D_{r}\\tau - 1 + \\exp(-D_{r}\\tau)) + 4D_{t}\\tau$.\n\nThe measured position is $\\boldsymbol{r}_{\\mathrm{m}}(t_{n}) = \\boldsymbol{r}(t_{n}) + \\boldsymbol{\\eta}_{n}$, where $\\boldsymbol{\\eta}_{n}$ is localization noise with $\\langle \\eta_{n,\\alpha}\\eta_{m,\\beta}\\rangle = \\sigma^{2}\\delta_{nm}\\delta_{\\alpha\\beta}$. The measured MSD at lag $\\tau=k\\Delta$ is\n$$\nM_{\\mathrm{m}}(k\\Delta) = \\left\\langle |\\boldsymbol{r}_{\\mathrm{m}}(t_{n+k}) - \\boldsymbol{r}_{\\mathrm{m}}(t_{n})|^{2} \\right\\rangle = \\left\\langle |(\\boldsymbol{r}_{n+k} - \\boldsymbol{r}_{n}) + (\\boldsymbol{\\eta}_{n+k} - \\boldsymbol{\\eta}_{n})|^{2} \\right\\rangle.\n$$\nSince the localization noise is independent of the particle's trajectory, the cross-term vanishes. For $k \\ge 1$, $\\boldsymbol{\\eta}_{n+k}$ and $\\boldsymbol{\\eta}_{n}$ are uncorrelated. Therefore,\n$$\nM_{\\mathrm{m}}(k\\Delta) = M(k\\Delta) + \\langle|\\boldsymbol{\\eta}_{n+k}|^{2}\\rangle + \\langle|\\boldsymbol{\\eta}_{n}|^{2}\\rangle = M(k\\Delta) + 2\\sigma^{2} + 2\\sigma^{2} = M(k\\Delta) + 4\\sigma^{2}.\n$$\nThe full expression for the measured MSD is\n$$\nM_{\\mathrm{m}}(\\tau) = \\frac{2v_{0}^{2}}{D_{r}^{2}} \\left( D_{r}\\tau - 1 + \\exp(-D_{r}\\tau) \\right) + 4D_{t}\\tau + 4\\sigma^{2}.\n$$\nTo construct an estimator for $v_{0}$ that is robust to $\\sigma^{2}$ and $D_{t}$, we form a linear combination of the measured MSD at lags $\\tau_{s} = \\Delta, 2\\Delta, 3\\Delta$ that cancels the constant term ($4\\sigma^2$) and the term linear in time ($4D_t\\tau$). The discrete second derivative operator, applied to a function $f(k\\Delta)$, is $f((k+1)\\Delta) - 2f(k\\Delta) + f((k-1)\\Delta)$. We apply this structure using the specified lags: $M_{\\mathrm{m}}(3\\Delta) - 2M_{\\mathrm{m}}(2\\Delta) + M_{\\mathrm{m}}(\\Delta)$. This combination annihilates any term of the form $A + B(k\\Delta)$.\nApplying this to the full $M_{\\mathrm{m}}(k\\Delta)$ expression, the terms $4\\sigma^{2}+4D_{t}k\\Delta$ and the linear part of the active term $\\frac{2v_0^2}{D_r}k\\Delta$ are perfectly canceled. What remains is the contribution from the non-linear parts:\n$$\nM_{\\mathrm{m}}(3\\Delta) - 2M_{\\mathrm{m}}(2\\Delta) + M_{\\mathrm{m}}(\\Delta) = \\frac{2v_{0}^{2}}{D_{r}^{2}} \\left[ \\left(\\exp(-3D_{r}\\Delta) - 2\\exp(-2D_{r}\\Delta) + \\exp(-D_{r}\\Delta)\\right) - (1-2+1) \\right].\n$$\nThe constant term part is zero. The remaining expression is proportional to\n$$\n\\exp(-D_{r}\\Delta) - 2\\exp(-2D_{r}\\Delta) + \\exp(-3D_{r}\\Delta) = \\exp(-D_{r}\\Delta)(1 - \\exp(-D_{r}\\Delta))^{2}.\n$$\nSo, $M_{\\mathrm{m}}(3\\Delta) - 2M_{\\mathrm{m}}(2\\Delta) + M_{\\mathrm{m}}(\\Delta) = \\frac{2v_{0}^{2}}{D_{r}^{2}} \\exp(-D_{r}\\Delta) \\left(1 - \\exp(-D_{r}\\Delta)\\right)^{2}$.\nThe problem requires an estimator that is asymptotically unbiased as $D_{r}\\Delta \\to 0$. In this limit, we expand the exponentials:\n$1 - \\exp(-D_{r}\\Delta) = D_{r}\\Delta - \\frac{1}{2}(D_{r}\\Delta)^{2} + O((D_{r}\\Delta)^{3})$.\n$\\exp(-D_{r}\\Delta) = 1 - D_{r}\\Delta + O((D_{r}\\Delta)^{2})$.\nThe combination becomes:\n$$\n\\frac{2v_{0}^{2}}{D_{r}^{2}} (1 - D_{r}\\Delta + \\dots)(D_{r}\\Delta - \\dots)^{2} = \\frac{2v_{0}^{2}}{D_{r}^{2}} (1+\\dots)(D_{r}^{2}\\Delta^{2}+\\dots) = 2v_{0}^{2}\\Delta^{2} + O((D_{r}\\Delta)^{3}).\n$$\nThe leading-order behavior is $2v_{0}^{2}\\Delta^{2}$. From this, we construct the estimator for $v_{0}^{2}$:\n$$\n\\hat{v}_{0}^{2} = \\frac{M_{\\mathrm{m}}(3\\Delta) - 2M_{\\mathrm{m}}(2\\Delta) + M_{\\mathrm{m}}(\\Delta)}{2\\Delta^{2}}.\n$$\nTaking the square root gives the estimator for $v_{0}$.\n\n**Part 2: Estimator for Rotational Diffusivity $D_{r}$**\n\nWe derive the expected functional form of the coarse-grained velocity autocorrelation function (VACF). The measured velocity is $\\boldsymbol{v}_{\\mathrm{m}}(t_{n}) = (\\boldsymbol{r}_{\\mathrm{m}}(t_{n+1}) - \\boldsymbol{r}_{\\mathrm{m}}(t_{n}))/\\Delta$. The VACF at lag $\\ell\\Delta$ is $C_{\\mathrm{m}}(\\ell\\Delta) = \\langle \\boldsymbol{v}_{\\mathrm{m}}(t_{n}) \\cdot \\boldsymbol{v}_{\\mathrm{m}}(t_{n+\\ell}) \\rangle$.\nSubstituting the definition of $\\boldsymbol{v}_{\\mathrm{m}}$, we have\n$$\nC_{\\mathrm{m}}(\\ell\\Delta) = \\frac{1}{\\Delta^{2}} \\left\\langle \\left( \\Delta\\boldsymbol{r}_{n} + \\Delta\\boldsymbol{\\eta}_{n} \\right) \\cdot \\left( \\Delta\\boldsymbol{r}_{n+\\ell} + \\Delta\\boldsymbol{\\eta}_{n+\\ell} \\right) \\right\\rangle,\n$$\nwhere $\\Delta\\boldsymbol{r}_{j} = \\boldsymbol{r}_{j+1}-\\boldsymbol{r}_{j}$ and $\\Delta\\boldsymbol{\\eta}_{j} = \\boldsymbol{\\eta}_{j+1}-\\boldsymbol{\\eta}_{j}$.\nFor $\\ell \\ge 1$, the time indices of the noise terms in the first factor, $n$ and $n+1$, are distinct from those in the second factor, $n+\\ell$ and $n+\\ell+1$. Given $\\langle\\boldsymbol{\\eta}_{i}\\cdot\\boldsymbol{\\eta}_{j}\\rangle \\propto \\delta_{ij}$, the noise term $\\langle \\Delta\\boldsymbol{\\eta}_{n} \\cdot \\Delta\\boldsymbol{\\eta}_{n+\\ell} \\rangle$ is zero. The cross-terms involving $\\Delta\\boldsymbol{r}$ and $\\Delta\\boldsymbol{\\eta}$ are also zero. Thus, for $\\ell \\ge 1$, localization noise does not contribute to the VACF.\n$$\nC_{\\mathrm{m}}(\\ell\\Delta) = C(\\ell\\Delta) = \\frac{1}{\\Delta^{2}} \\langle \\Delta\\boldsymbol{r}_{n} \\cdot \\Delta\\boldsymbol{r}_{n+\\ell} \\rangle.\n$$\nSubstituting the integral form of the displacement $\\Delta\\boldsymbol{r}_{n} = v_0 \\int_{n\\Delta}^{(n+1)\\Delta} \\boldsymbol{u}(t) dt + \\sqrt{2D_t} \\int_{n\\Delta}^{(n+1)\\Delta} \\boldsymbol{\\xi}(t) dt$. For $\\ell \\ge 1$, the integration intervals for $\\Delta\\boldsymbol{r}_n$ and $\\Delta\\boldsymbol{r}_{n+\\ell}$ are disjoint. The increments of the Wiener process are therefore uncorrelated, so the translational diffusion term $\\langle (\\int \\boldsymbol{\\xi} dt) \\cdot (\\int \\boldsymbol{\\xi} dt) \\rangle$ vanishes. We are left with only the active component:\n$$\nC_{\\mathrm{m}}(\\ell\\Delta) = \\frac{v_{0}^{2}}{\\Delta^{2}} \\left\\langle \\left( \\int_{n\\Delta}^{(n+1)\\Delta} \\boldsymbol{u}(t) dt \\right) \\cdot \\left( \\int_{(n+\\ell)\\Delta}^{(n+\\ell+1)\\Delta} \\boldsymbol{u}(t') dt' \\right) \\right\\rangle = \\frac{v_{0}^{2}}{\\Delta^{2}} \\int_{n\\Delta}^{(n+1)\\Delta} dt \\int_{(n+\\ell)\\Delta}^{(n+\\ell+1)\\Delta} dt' \\langle \\boldsymbol{u}(t) \\cdot \\boldsymbol{u}(t') \\rangle.\n$$\nUsing $\\langle \\boldsymbol{u}(t) \\cdot \\boldsymbol{u}(t') \\rangle = \\exp(-D_{r}(t'-t))$ for $t' > t$, the integral becomes separable:\n$$\n\\int_{0}^{\\Delta} ds \\int_{0}^{\\Delta} ds' \\exp(-D_{r}(\\ell\\Delta + s' - s)) = \\exp(-D_{r}\\ell\\Delta) \\left( \\int_{0}^{\\Delta} e^{D_{r}s} ds \\right) \\left( \\int_{0}^{\\Delta} e^{-D_{r}s'} ds' \\right).\n$$\nThe integrals evaluate to: $\\int_{0}^{\\Delta} e^{\\pm D_{r}s} ds = \\frac{1}{\\pm D_{r}}(\\exp(\\pm D_{r}\\Delta) - 1)$. Their product is $\\frac{1}{-D_r^2}(e^{D_r\\Delta}-1)(e^{-D_r\\Delta}-1) = \\frac{1}{D_r^2}(2 - e^{D_r\\Delta} - e^{-D_r\\Delta}) = \\frac{2}{D_r^2}(1-\\cosh(D_r\\Delta)) = \\frac{4}{D_r^2}\\sinh^2(D_r\\Delta/2)$.\nCombining everything, we find the VACF for $\\ell \\ge 1$:\n$$\nC_{\\mathrm{m}}(\\ell\\Delta) = \\frac{v_{0}^{2}}{\\Delta^{2}} \\exp(-D_{r}\\ell\\Delta) \\frac{4\\sinh^{2}(D_{r}\\Delta/2)}{D_{r}^{2}} = v_{0}^{2} \\left( \\frac{2\\sinh(D_{r}\\Delta/2)}{D_{r}\\Delta} \\right)^{2} \\exp(-D_{r}\\ell\\Delta).\n$$\nThe term $\\left( \\frac{2\\sinh(D_{r}\\Delta/2)}{D_{r}\\Delta} \\right)^{2}$ is the multiplicative shape factor resulting from finite differencing. It depends only on the product $D_{r}\\Delta$. The overall form is $C_{\\mathrm{m}}(\\ell\\Delta) = A \\exp(-D_{r}\\ell\\Delta)$, where the amplitude $A$ is independent of $\\ell$.\nTo find $D_{r}$, we take the ratio of the VACF at two different lags, $\\ell_{2} > \\ell_{1} \\ge 1$:\n$$\n\\frac{C_{\\mathrm{m}}(\\ell_{1}\\Delta)}{C_{\\mathrm{m}}(\\ell_{2}\\Delta)} = \\frac{A \\exp(-D_{r}\\ell_{1}\\Delta)}{A \\exp(-D_{r}\\ell_{2}\\Delta)} = \\exp(D_{r}(\\ell_{2}-\\ell_{1})\\Delta).\n$$\nThis ratio is independent of $v_{0}$ and the shape factor. Solving for $D_{r}$ yields a closed-form estimator valid for any value of $D_{r}\\Delta$:\n$$\n\\ln\\left(\\frac{C_{\\mathrm{m}}(\\ell_{1}\\Delta)}{C_{\\mathrm{m}}(\\ell_{2}\\Delta)}\\right) = D_{r}(\\ell_{2}-\\ell_{1})\\Delta \\implies \\hat{D}_{r} = \\frac{1}{(\\ell_{2}-\\ell_{1})\\Delta} \\ln\\left(\\frac{C_{\\mathrm{m}}(\\ell_{1}\\Delta)}{C_{\\mathrm{m}}(\\ell_{2}\\Delta)}\\right).\n$$\nThis completes the derivation of the required estimators.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\sqrt{\\frac{M_{\\mathrm{m}}(3\\Delta) - 2M_{\\mathrm{m}}(2\\Delta) + M_{\\mathrm{m}}(\\Delta)}{2\\Delta^2}} & \\frac{1}{(\\ell_2 - \\ell_1)\\Delta} \\ln\\left(\\frac{C_{\\mathrm{m}}(\\ell_1\\Delta)}{C_{\\mathrm{m}}(\\ell_2\\Delta)}\\right)\n\\end{pmatrix}\n}\n$$", "id": "2906653"}, {"introduction": "Numerical simulation is an indispensable tool for exploring phenomena that are analytically intractable, such as the collective behavior of many active particles or their interaction with complex boundaries. However, the reliability of a simulation hinges on a numerically stable and physically accurate integration scheme. This computational practice guides you through the process of determining the maximum allowable time step $\\Delta t$ to accurately capture a signature effect in active systems: the accumulation of particles at a wall [@problem_id:2906656]. Mastering these constraints is fundamental to developing trustworthy simulations in active matter research.", "problem": "Consider a single non-interacting Active Brownian Particle (ABP) in two spatial dimensions near an infinitely extended, perfectly reflecting, straight wall located at position $x=0$, with the accessible half-space given by $x \\ge 0$. The particle has self-propulsion speed $v_0$ along its instantaneous unit orientation $\\mathbf{p} = (\\cos \\theta, \\sin \\theta)$, translational diffusion with diffusivity $D_t$, and rotational diffusion of the orientation angle $\\theta$ with rotational diffusivity $D_r$. The stochastic dynamics are governed by well-established overdamped Langevin equations\n$$\n\\frac{d x}{d t} = v_0 \\cos \\theta + \\sqrt{2 D_t} \\, \\xi_x(t), \\quad\n\\frac{d y}{d t} = v_0 \\sin \\theta + \\sqrt{2 D_t} \\, \\xi_y(t), \\quad\n\\frac{d \\theta}{d t} = \\sqrt{2 D_r} \\, \\eta(t),\n$$\nwhere $\\xi_x(t)$, $\\xi_y(t)$, and $\\eta(t)$ are independent unit-variance Gaussian white noises. The reflecting boundary at $x=0$ enforces no-flux, which may be implemented by reflecting any attempted step that crosses the wall back into the half-space $x \\ge 0$.\n\nYour task is to specify a discrete-time integration scheme for the orientation and position that preserves the correct rotational diffusion statistics and to quantify a time-step constraint that ensures accurate capture of steady-state wall accumulation (enhanced probability density near the wall due to persistence). You must proceed from the fundamental stochastic equations above and reason to an algorithm that uses a time step $\\Delta t$.\n\nAccuracy criteria to quantify the time-step constraint should be defined in terms of resolving the physics in the near-wall boundary layer. Define a characteristic boundary-layer length scale\n$$\n\\ell_\\star = \\max \\left( \\frac{v_0}{D_r}, \\sqrt{\\frac{D_t}{D_r}} \\right),\n$$\nwhich is the larger of the persistence length and the diffusive-rotational coupling length. Impose all of the following conditions to bound $\\Delta t$:\n- Rotational-resolution bound: require that the time step resolve the rotational relaxation time, that is,\n$$\n\\Delta t \\le \\frac{\\beta}{D_r},\n$$\nwith a fixed constant $\\beta$.\n- Near-wall normal-displacement bound: require that a three-standard-deviation estimate of the one-step root-mean-square normal displacement be a small fraction $c_{\\mathrm{rms}}$ of the boundary-layer length scale. Using the independence of orientation and translational noise in the bulk, take the normal component to have root-mean-square value\n$$\n\\sqrt{\\frac{v_0^2}{2} \\, (\\Delta t)^2 + 2 D_t \\, \\Delta t},\n$$\nand impose\n$$\n3 \\sqrt{\\frac{v_0^2}{2} \\, (\\Delta t)^2 + 2 D_t \\, \\Delta t} \\le c_{\\mathrm{rms}} \\, \\ell_\\star.\n$$\n- Ballistic step bound: require that the deterministic self-propelled step per time step be a small fraction $c_{\\mathrm{bal}}$ of the boundary-layer scale:\n$$\nv_0 \\, \\Delta t \\le c_{\\mathrm{bal}} \\, \\ell_\\star,\n$$\nto avoid geometry under-resolution at small $D_t$.\n\nFor the purely passive limit $v_0 = 0$, there is no steady wall accumulation. In that case, only enforce the rotational-resolution bound.\n\nAdopt the fixed numerical constants $\\beta = 0.05$, $c_{\\mathrm{rms}} = 0.1$, and $c_{\\mathrm{bal}} = 0.1$. Angles must be in radians. All outputs must be expressed in seconds.\n\nYour program must, for each parameter set in the following test suite, compute the maximum allowable time step $\\Delta t_{\\max}$ in seconds as the minimum value implied by the three bounds above (or by the rotational-resolution bound only when $v_0 = 0$). Results must be rounded to $6$ decimal places.\n\nTest suite (with units):\n- Case $1$: $v_0 = 1.0$ micrometer/second, $D_r = 1.0$ per second, $D_t = 0.05$ square micrometer/second.\n- Case $2$: $v_0 = 3.0$ micrometer/second, $D_r = 0.5$ per second, $D_t = 0.01$ square micrometer/second.\n- Case $3$: $v_0 = 0.0$ micrometer/second, $D_r = 1.0$ per second, $D_t = 0.10$ square micrometer/second.\n- Case $4$: $v_0 = 1.0$ micrometer/second, $D_r = 10.0$ per second, $D_t = 0.00$ square micrometer/second.\n\nFinal output format: Your program should produce a single line containing a Python-style list of the four $\\Delta t_{\\max}$ values in seconds, rounded to $6$ decimal places, with entries separated by commas and no spaces, for example, $[0.123456,0.234567,0.345678,0.456789]$.", "solution": "The problem statement has been subjected to rigorous validation and is deemed valid. It is scientifically grounded in the established theory of active matter, specifically the Active Brownian Particle (ABP) model. The problem is well-posed, with all necessary parameters and constraints clearly defined, permitting a unique and meaningful solution. The language is objective and precise. I will now proceed with the solution.\n\nThe task is twofold: first, to specify a discrete-time integration scheme for the given stochastic dynamics, and second, to compute the maximum permissible time step, $\\Delta t_{\\max}$, based on a set of specified accuracy constraints.\n\nAn appropriate numerical integration scheme for the provided set of overdamped Langevin equations is the Euler-Maruyama method. This first-order method is a direct discretization of the stochastic differential equations (SDEs) and is straightforward to implement while preserving the fundamental statistical properties of the noise terms. The integration for a finite time step $\\Delta t$ proceeds in two stages: updating the orientation and then the position.\n\n$1$. **Orientation Update:** The dynamics of the orientation angle, $\\theta$, are governed by a simple rotational diffusion equation:\n$$ \\frac{d \\theta}{d t} = \\sqrt{2 D_r} \\, \\eta(t) $$\nThe Euler-Maruyama discretization of this equation is:\n$$ \\theta_{n+1} = \\theta_n + \\sqrt{2 D_r \\Delta t} \\, Z_{\\theta} $$\nHere, $\\theta_n$ is the angle at time step $n$, and $Z_{\\theta}$ is a random number drawn from a standard normal distribution with mean $0$ and variance $1$. This update rule correctly models the diffusive nature of the angle, as the variance of the angular displacement over one step is $\\langle (\\theta_{n+1} - \\theta_n)^2 \\rangle = 2 D_r \\Delta t$.\n\n$2$. **Position Update:** The position coordinates $(x, y)$ are updated based on the orientation $\\theta_n$ from the beginning of the time step:\n$$ x_{n+1} = x_n + v_0 \\cos(\\theta_n) \\Delta t + \\sqrt{2 D_t \\Delta t} \\, Z_x $$\n$$ y_{n+1} = y_n + v_0 \\sin(\\theta_n) \\Delta t + \\sqrt{2 D_t \\Delta t} \\, Z_y $$\nHere, $Z_x$ and $Z_y$ are two independent random numbers, also drawn from a standard normal distribution, and are independent of $Z_{\\theta}$.\n\n$3$. **Boundary Condition:** The problem specifies a perfectly reflecting wall at $x=0$. After computing the new provisional position $(x_{n+1}, y_{n+1})$, one must enforce this constraint. If the particle attempts to cross the wall, i.e., if $x_{n+1} < 0$, its $x$-coordinate is reflected back into the accessible domain:\n$$ x_{n+1} \\rightarrow -x_{n+1} $$\nThe $y$-coordinate and the orientation $\\theta$ are unaffected by this reflection. This implements the required no-flux boundary condition.\n\nNext, we determine the maximum allowable time step, $\\Delta t_{\\max}$, by analyzing the given constraints. For each parameter set, $\\Delta t_{\\max}$ is the minimum of the upper bounds derived from these conditions. The numerical constants are $\\beta = 0.05$, $c_{\\mathrm{rms}} = 0.1$, and $c_{\\mathrm{bal}} = 0.1$.\n\nThe characteristic boundary-layer length scale is defined as $\\ell_\\star = \\max \\left( \\frac{v_0}{D_r}, \\sqrt{\\frac{D_t}{D_r}} \\right)$.\n\nThe constraints are as follows:\n\n**1. Rotational-resolution bound:**\nThis constraint ensures the rotational motion is adequately resolved.\n$$ \\Delta t \\le \\frac{\\beta}{D_r} $$\nThis yields an upper bound $\\Delta t_{1, \\max} = \\beta / D_r$.\n\n**2. Near-wall normal-displacement bound:**\nThis applies only when $v_0 > 0$. It limits the displacement perpendicular to the wall within one time step.\n$$ 3 \\sqrt{\\frac{v_0^2}{2} (\\Delta t)^2 + 2 D_t \\Delta t} \\le c_{\\mathrm{rms}} \\ell_\\star $$\nSquaring both sides and rearranging gives a quadratic inequality for $\\Delta t$:\n$$ \\left( \\frac{9 v_0^2}{2} \\right) (\\Delta t)^2 + (18 D_t) \\Delta t - c_{\\mathrm{rms}}^2 \\ell_\\star^2 \\le 0 $$\nThis is of the form $A (\\Delta t)^2 + B \\Delta t + C \\le 0$ with $A = 4.5 v_0^2 > 0$, $B = 18 D_t \\ge 0$, and $C = -c_{\\mathrm{rms}}^2 \\ell_\\star^2 \\le 0$. The valid range for $\\Delta t > 0$ is $0 < \\Delta t \\le \\Delta t_{2, \\max}$, where $\\Delta t_{2, \\max}$ is the positive root of the quadratic equation $A (\\Delta t)^2 + B \\Delta t + C = 0$:\n$$ \\Delta t_{2, \\max} = \\frac{-B + \\sqrt{B^2 - 4AC}}{2A} = \\frac{-18 D_t + \\sqrt{(18 D_t)^2 + 18 v_0^2 c_{\\mathrm{rms}}^2 \\ell_\\star^2}}{9 v_0^2} $$\nIn the specific case where $D_t = 0$, the inequality simplifies to $3 v_0 \\Delta t / \\sqrt{2} \\le c_{\\mathrm{rms}} \\ell_\\star$, yielding $\\Delta t_{2, \\max} = \\frac{\\sqrt{2} c_{\\mathrm{rms}} \\ell_\\star}{3 v_0}$.\n\n**3. Ballistic step bound:**\nThis also applies only when $v_0 > 0$ and prevents the particle from stepping over the boundary layer in a single deterministic step.\n$$ v_0 \\Delta t \\le c_{\\mathrm{bal}} \\ell_\\star $$\nThis gives the upper bound $\\Delta t_{3, \\max} = \\frac{c_{\\mathrm{bal}} \\ell_\\star}{v_0}$.\n\nFor any case with $v_0 > 0$, the maximum time step is $\\Delta t_{\\max} = \\min(\\Delta t_{1, \\max}, \\Delta t_{2, \\max}, \\Delta t_{3, \\max})$.\nFor the passive case $v_0 = 0$, the problem explicitly states to only enforce the rotational-resolution bound, so $\\Delta t_{\\max} = \\Delta t_{1, \\max}$.\n\nWe now apply this framework to the test suite:\n\n**Case 1:** $v_0 = 1.0$, $D_r = 1.0$, $D_t = 0.05$.\n- $\\ell_\\star = \\max\\left( \\frac{1.0}{1.0}, \\sqrt{\\frac{0.05}{1.0}} \\right) = \\max(1.0, 0.2236...) = 1.0$.\n- $\\Delta t_{1, \\max} = \\frac{0.05}{1.0} = 0.05$.\n- $\\Delta t_{2, \\max} = \\frac{-18(0.05) + \\sqrt{(18 \\cdot 0.05)^2 + 18(1.0)^2(0.1)^2(1.0)^2}}{9(1.0)^2} = \\frac{-0.9 + \\sqrt{0.81 + 0.18}}{9} = \\frac{-0.9 + \\sqrt{0.99}}{9} \\approx 0.010554$.\n- $\\Delta t_{3, \\max} = \\frac{0.1 \\times 1.0}{1.0} = 0.1$.\n- $\\Delta t_{\\max} = \\min(0.05, 0.010554, 0.1) = 0.010554$.\n\n**Case 2:** $v_0 = 3.0$, $D_r = 0.5$, $D_t = 0.01$.\n- $\\ell_\\star = \\max\\left( \\frac{3.0}{0.5}, \\sqrt{\\frac{0.01}{0.5}} \\right) = \\max(6.0, 0.1414...) = 6.0$.\n- $\\Delta t_{1, \\max} = \\frac{0.05}{0.5} = 0.1$.\n- $\\Delta t_{2, \\max} = \\frac{-18(0.01) + \\sqrt{(18 \\cdot 0.01)^2 + 18(3.0)^2(0.1)^2(6.0)^2}}{9(3.0)^2} = \\frac{-0.18 + \\sqrt{0.0324 + 58.32}}{81} = \\frac{-0.18 + \\sqrt{58.3524}}{81} \\approx 0.092085$.\n- $\\Delta t_{3, \\max} = \\frac{0.1 \\times 6.0}{3.0} = 0.2$.\n- $\\Delta t_{\\max} = \\min(0.1, 0.092085, 0.2) = 0.092085$.\n\n**Case 3:** $v_0 = 0.0$, $D_r = 1.0$, $D_t = 0.10$.\n- This is the passive limit ($v_0 = 0$). As per the problem statement, only the rotational-resolution bound is enforced.\n- $\\Delta t_{\\max} = \\Delta t_{1, \\max} = \\frac{0.05}{1.0} = 0.05$.\n\n**Case 4:** $v_0 = 1.0$, $D_r = 10.0$, $D_t = 0.0$.\n- $\\ell_\\star = \\max\\left( \\frac{1.0}{10.0}, \\sqrt{\\frac{0.0}{10.0}} \\right) = \\max(0.1, 0) = 0.1$.\n- $\\Delta t_{1, \\max} = \\frac{0.05}{10.0} = 0.005$.\n- Since $D_t = 0$, we use the simplified formula for the second bound: $\\Delta t_{2, \\max} = \\frac{\\sqrt{2} \\times 0.1 \\times 0.1}{3 \\times 1.0} = \\frac{0.01\\sqrt{2}}{3} \\approx 0.004714$.\n- $\\Delta t_{3, \\max} = \\frac{0.1 \\times 0.1}{1.0} = 0.01$.\n- $\\Delta t_{\\max} = \\min(0.005, 0.004714, 0.01) = 0.004714$.\n\nThe final results, rounded to $6$ decimal places, are $0.010554$, $0.092085$, $0.050000$, and $0.004714$. These are computed by the program provided in the final answer.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the maximum allowable time step for simulating an Active Brownian\n    Particle near a wall, based on a set of accuracy constraints.\n    \"\"\"\n\n    # Define the fixed numerical constants from the problem statement.\n    BETA = 0.05\n    C_RMS = 0.1\n    C_BAL = 0.1\n\n    # Test suite with parameters (v0, Dr, Dt).\n    # Units: v0 [micrometer/s], Dr [1/s], Dt [micrometer^2/s]\n    test_cases = [\n        (1.0, 1.0, 0.05),   # Case 1\n        (3.0, 0.5, 0.01),   # Case 2\n        (0.0, 1.0, 0.10),   # Case 3\n        (1.0, 10.0, 0.00),  # Case 4\n    ]\n\n    results = []\n    for v0, Dr, Dt in test_cases:\n        # According to the problem, Dr > 0 is implicitly assumed.\n        # Rotational-resolution bound is always applicable.\n        dt_max_1 = BETA / Dr\n\n        # For the passive limit (v0 = 0), only the rotational-resolution bound is enforced.\n        if v0 == 0.0:\n            results.append(dt_max_1)\n            continue\n\n        # For active cases (v0 > 0), calculate the other two bounds.\n        \n        # Calculate characteristic boundary-layer length scale l_star.\n        l_star = np.max([v0 / Dr, np.sqrt(Dt / Dr)])\n\n        # Bound 2: Near-wall normal-displacement bound.\n        # This requires solving a quadratic inequality for dt:\n        # A * (dt)^2 + B * dt + C <= 0\n        # where A = 4.5 * v0^2, B = 18 * Dt, C = -c_rms^2 * l_star^2\n        A = 4.5 * v0**2\n        B = 18 * Dt\n        C = -C_RMS**2 * l_star**2\n        \n        # We need the positive root of A*x^2 + B*x + C = 0.\n        # dt_max_2 = (-B + sqrt(B^2 - 4*A*C)) / (2*A)\n        discriminant = B**2 - 4 * A * C\n        dt_max_2 = (-B + np.sqrt(discriminant)) / (2 * A)\n\n        # Bound 3: Ballistic step bound.\n        dt_max_3 = (C_BAL * l_star) / v0\n\n        # The maximum allowable time step is the minimum of the three bounds.\n        dt_max = np.min([dt_max_1, dt_max_2, dt_max_3])\n        results.append(dt_max)\n\n    # Format the output as a list of strings, rounded to 6 decimal places.\n    formatted_results = [f\"{r:.6f}\" for r in results]\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2906656"}]}