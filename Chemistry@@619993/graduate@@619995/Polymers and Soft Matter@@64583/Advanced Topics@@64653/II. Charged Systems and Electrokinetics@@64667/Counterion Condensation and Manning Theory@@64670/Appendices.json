{"hands_on_practices": [{"introduction": "The behavior of charged polymers in solution is governed by a fundamental tug-of-war between electrostatic forces and the randomizing effects of thermal energy. This practice grounds your understanding by tasking you with defining, deriving, and calculating the Bjerrum length, $l_B$. Mastering this concept is a foundational skill, as $l_B$ provides the essential length scale that determines whether electrostatic attraction or thermal motion dominates in any polyelectrolyte system [@problem_id:2911256].", "problem": "In the context of counterion condensation and the theory of highly charged polyelectrolytes, the Bjerrum length $l_B$ quantifies the separation at which electrostatic interactions between two elementary charges compete with thermal fluctuations. Starting from the fundamental base of electrostatics and statistical mechanics, namely Coulomb’s law in a continuum dielectric medium of permittivity $\\epsilon$ and the thermal energy scale $k_B T$, do the following:\n\n- Provide a precise definition of the Bjerrum length $l_B$ based on an equality between the electrostatic interaction energy of two point charges $\\pm e$ separated by a distance $r$ and the thermal energy scale $k_B T$.\n- From this definition, derive an analytic expression for $l_B$ in terms of $e$, $\\epsilon$, $k_B$, and $T$, stating any physical assumptions you use.\n- Evaluate $l_B$ for liquid water at $T = 298\\ \\mathrm{K}$ with $\\epsilon = 78\\epsilon_0$ using the following constants: $e = 1.602176634 \\times 10^{-19}\\ \\mathrm{C}$, $k_B = 1.380649 \\times 10^{-23}\\ \\mathrm{J/K}$, and $\\epsilon_0 = 8.8541878128 \\times 10^{-12}\\ \\mathrm{F/m}$. Express your final numerical result in nanometers, rounded to three significant figures. Your numerical value must be accurate to within $0.05\\ \\mathrm{nm}$.\n\nReport only the final numerical value of $l_B$ (in $\\mathrm{nm}$) as your answer.", "solution": "The problem as stated will be subjected to rigorous validation before any attempt at a solution is made.\n\nFirst, the givens are extracted verbatim from the problem statement:\n- **Context**: Counterion condensation and the theory of highly charged polyelectrolytes.\n- **Concept**: The Bjerrum length $l_B$ is the separation at which electrostatic interactions between two elementary charges compete with thermal fluctuations.\n- **Definition Condition**: An equality between the electrostatic interaction energy of two point charges $\\pm e$ separated by a distance $r$ and the thermal energy scale $k_B T$.\n- **Task 1**: Provide a precise definition of the Bjerrum length $l_B$.\n- **Task 2**: Derive an analytic expression for $l_B$ in terms of $e$, $\\epsilon$, $k_B$, and $T$.\n- **Task 3**: Evaluate $l_B$ for liquid water at $T = 298\\ \\mathrm{K}$ with $\\epsilon = 78\\epsilon_0$.\n- **Constants**:\n    - $T = 298\\ \\mathrm{K}$\n    - $\\epsilon = 78\\epsilon_0$\n    - $e = 1.602176634 \\times 10^{-19}\\ \\mathrm{C}$\n    - $k_B = 1.380649 \\times 10^{-23}\\ \\mathrm{J/K}$\n    - $\\epsilon_0 = 8.8541878128 \\times 10^{-12}\\ \\mathrm{F/m}$\n- **Output Requirement**: Express final numerical result in nanometers, rounded to three significant figures.\n\nSecond, the problem is validated against the required criteria.\n- **Scientific Grounding**: The problem is fundamentally sound. It is based on Coulomb's law from classical electrostatics and the concept of thermal energy from statistical mechanics, both indisputable cornerstones of physics. The Bjerrum length is a standard, well-established quantity in the physical chemistry of electrolytes and polymers.\n- **Well-Posedness**: The problem is well-posed. It requests a definition, a derivation, and a numerical calculation from a complete and consistent set of givens. A unique, stable solution exists.\n- **Objectivity**: The problem is stated in precise, objective language, free of any subjectivity or ambiguity.\n- **Flaw Analysis**: The problem does not violate any of the specified invalidity conditions. It is scientifically sound, formalizable, complete, realistic, well-posed, and non-trivial.\n\nThe verdict is that the problem is **valid**. A solution will now be provided.\n\nThe problem requires a definition and derivation for the Bjerrum length, $l_B$. This quantity represents a characteristic length scale in an electrolyte solution.\n\nWe start with the electrostatic potential energy, $U_{el}$, between two point charges, $q_1$ and $q_2$, separated by a distance $r$ in a continuous medium with a uniform dielectric permittivity $\\epsilon$. According to Coulomb's law, this energy is given by:\n$$\nU_{el}(r) = \\frac{1}{4 \\pi \\epsilon} \\frac{q_1 q_2}{r}\n$$\nThe problem specifies two elementary charges, which we take to be $+e$ and $-e$. The interaction energy between them is attractive:\n$$\nU_{el}(r) = -\\frac{e^2}{4 \\pi \\epsilon r}\n$$\nThis electrostatic energy must be compared to the characteristic thermal energy scale, $E_{th}$, which is given by the product of the Boltzmann constant $k_B$ and the absolute temperature $T$:\n$$\nE_{th} = k_B T\n$$\nThe Bjerrum length, $l_B$, is defined as the distance at which the magnitude of the electrostatic potential energy between two elementary charges is equal to the thermal energy. This condition marks the crossover between electrostatically dominated behavior (at distances $r \\ll l_B$) and thermally dominated behavior (at distances $r \\gg l_B$).\n\nWe formalize this definition as an equality:\n$$\n|U_{el}(l_B)| = k_B T\n$$\nSubstituting the expression for the magnitude of the electrostatic energy, we have:\n$$\n\\frac{e^2}{4 \\pi \\epsilon l_B} = k_B T\n$$\nThis equation provides the precise physical definition of the Bjerrum length.\n\nFrom this definition, we derive the analytic expression for $l_B$ by rearranging the equation to solve for $l_B$:\n$$\nl_B = \\frac{e^2}{4 \\pi \\epsilon k_B T}\n$$\nThis derivation relies on the primary assumption that the solvent can be treated as a continuum dielectric with a constant permittivity $\\epsilon$, and that the ions are classical point charges.\n\nNext, we evaluate $l_B$ for liquid water at $T = 298\\ \\mathrm{K}$. The permittivity of the medium is given as $\\epsilon = 78\\epsilon_0$, where $78$ is the relative permittivity (dielectric constant) of water and $\\epsilon_0$ is the permittivity of free space. The expression becomes:\n$$\nl_B = \\frac{e^2}{4 \\pi (78\\epsilon_0) k_B T}\n$$\nWe substitute the provided numerical values for the physical constants:\n- $e = 1.602176634 \\times 10^{-19}\\ \\mathrm{C}$\n- $\\epsilon_0 = 8.8541878128 \\times 10^{-12}\\ \\mathrm{F/m}$\n- $k_B = 1.380649 \\times 10^{-23}\\ \\mathrm{J/K}$\n- $T = 298\\ \\mathrm{K}$\nAnd the dimensionless relative permittivity is $78$.\n\nThe calculation proceeds as follows:\n$$\nl_B = \\frac{(1.602176634 \\times 10^{-19}\\ \\mathrm{C})^2}{4 \\pi (78) (8.8541878128 \\times 10^{-12}\\ \\mathrm{F/m}) (1.380649 \\times 10^{-23}\\ \\mathrm{J/K}) (298\\ \\mathrm{K})}\n$$\nThe units are consistent: $(\\mathrm{C}^2) / ((\\mathrm{F/m}) \\cdot (\\mathrm{J/K}) \\cdot \\mathrm{K}) = (\\mathrm{C}^2) / ((\\mathrm{C}^2 / (\\mathrm{J} \\cdot \\mathrm{m})) \\cdot \\mathrm{J}) = \\mathrm{m}$.\n\nLet us compute the numerator and denominator:\nNumerator:\n$$\ne^2 = (1.602176634 \\times 10^{-19})^2 \\approx 2.5669701 \\times 10^{-38}\\ \\mathrm{C}^2\n$$\nDenominator:\n$$\n4 \\pi (78) (8.8541878128 \\times 10^{-12}) (1.380649 \\times 10^{-23}) (298) \\approx 3.57053 \\times 10^{-29}\\ \\mathrm{C}^2 \\cdot \\mathrm{m}^{-1}\n$$\nDividing the numerator by the denominator:\n$$\nl_B = \\frac{2.5669701 \\times 10^{-38}}{3.57053 \\times 10^{-29}}\\ \\mathrm{m} \\approx 0.71893 \\times 10^{-9}\\ \\mathrm{m}\n$$\nThis result is in meters. To express it in nanometers, we multiply by $10^9$:\n$$\nl_B \\approx 0.71893\\ \\mathrm{nm}\n$$\nThe problem requires the result to be rounded to three significant figures.\n$$\nl_B \\approx 0.719\\ \\mathrm{nm}\n$$\nThis value represents the Bjerrum length in water at room temperature.", "answer": "$$\n\\boxed{0.719}\n$$", "id": "2911256"}, {"introduction": "Manning's theory famously posits that counterion condensation occurs abruptly when a polyelectrolyte's linear charge density exceeds a critical threshold. This exercise moves beyond treating this as a mere postulate by connecting it to the spatial distribution of counterions predicted by the more detailed Poisson-Boltzmann theory. By deriving the condensed fraction, $f_c$, from a physical feature of the counterion cloud, you will gain a much deeper appreciation for the physical origins of this powerful theoretical result [@problem_id:2911234].", "problem": "Consider an infinitely long, uniformly charged cylindrical rod of physical radius $a$ and line charge density $\\lambda<0$, immersed in a continuum solvent of dielectric permittivity $\\varepsilon$ at temperature $T$. The solution contains only neutralizing counterions of valence $z$ (salt-free). Assume mean-field electrostatics applies and the ion distribution is described by the Poisson–Boltzmann (PB) theory. Let $\\psi(r)$ be the electrostatic potential, $\\beta \\equiv 1/(k_B T)$, and $n(r)$ the local counterion number density. Define the Bjerrum length $l_B \\equiv e^2/(4 \\pi \\varepsilon k_B T)$ and the Manning parameter $\\xi \\equiv l_B |\\lambda|/e$. Assume $\\xi > 1/z$.\n\nLet $N(r) \\equiv 2 \\pi \\int_a^r n(r') r' \\, dr'$ be the number of counterions per unit length contained within the coaxial cylinder of radius $r$. Define the neutralization fraction $\\theta(r) \\equiv \\dfrac{z e \\, N(r)}{|\\lambda|}$, and the logarithmic radial coordinate $s \\equiv \\ln(r/a)$. Adopt the following operational definition for the condensation radius $r_c$: it is the unique radius $r_c > a$ at which the graph of $\\theta$ as a function of $s$ has an inflection point, i.e., $\\dfrac{d^2 \\theta}{ds^2}\\big|_{r=r_c} = 0$.\n\nStarting only from the PB framework and electrostatic fundamentals (Poisson’s equation, Gauss’ law, and the Boltzmann weight for $n(r)$), derive a parameter-free condition that holds at $r = r_c$ and use it to compute the condensed fraction $f_c \\equiv \\theta(r_c)$ in closed form, expressed solely in terms of $\\xi$ and $z$. Provide your final answer as an analytic expression for $f_c$. No numerical evaluation is required. Units are not needed because $f_c$ is dimensionless.", "solution": "The problem statement is subjected to validation.\n\n**Step 1: Extracted Givens**\n- System: Infinitely long, uniformly charged cylindrical rod.\n- Rod radius: $a$.\n- Line charge density: $\\lambda < 0$.\n- Solvent dielectric permittivity: $\\varepsilon$.\n- Temperature: $T$.\n- Counterions: Valence $z$, salt-free solution.\n- Theoretical framework: Poisson–Boltzmann (PB) theory.\n- Electrostatic potential: $\\psi(r)$.\n- Inverse thermal energy: $\\beta \\equiv 1/(k_B T)$.\n- Counterion number density: $n(r)$.\n- Bjerrum length: $l_B \\equiv e^2/(4 \\pi \\varepsilon k_B T)$.\n- Manning parameter: $\\xi \\equiv l_B |\\lambda|/e$.\n- Constraint: $\\xi > 1/z$.\n- Integrated counterion number per unit length: $N(r) \\equiv 2 \\pi \\int_a^r n(r') r' \\, dr'$.\n- Neutralization fraction: $\\theta(r) \\equiv \\dfrac{z e \\, N(r)}{|\\lambda|}$.\n- Logarithmic radial coordinate: $s \\equiv \\ln(r/a)$.\n- Definition of condensation radius $r_c$: Unique radius where $\\dfrac{d^2 \\theta}{ds^2}\\big|_{r=r_c} = 0$.\n- Quantity to find: The condensed fraction $f_c \\equiv \\theta(r_c)$.\n\n**Step 2: Validation Using Extracted Givens**\nThe problem is scientifically grounded, being a classic setup in the theory of polyelectrolytes based on the Poisson-Boltzmann equation. All terms ($l_B$, $\\xi$) are standard in the field. The setup is well-posed; the definition of the condensation radius via an inflection point is mathematically unambiguous, though not the most common definition. It provides a clear path towards a solution. The problem statement is objective and contains all necessary information for a derivation from first principles. There are no contradictions, factual errors, or infeasible conditions. The constraint $\\xi > 1/z$ is the standard Manning criterion for the onset of counterion condensation, suggesting the problem is self-consistent.\n\n**Step 3: Verdict and Action**\nThe problem is deemed **valid**. A rigorous solution will be derived.\n\nThe derivation begins from fundamental electrostatic principles within the Poisson-Boltzmann framework.\nIn cylindrical coordinates, the radial component of the electric field $E(r)$ is related to the electrostatic potential $\\psi(r)$ by $E(r) = - \\dfrac{d\\psi}{dr}$.\nAccording to Gauss's law, the electric field at a radial distance $r$ from the axis of the cylinder is determined by the total enclosed line charge density. The total charge per unit length within a cylinder of radius $r$ is the sum of the rod's charge and the charge of the counterions in the volume between radius $a$ and $r$.\nThe charge per unit length of the rod is $\\lambda = -|\\lambda|$. The charge per unit length from the counterions is $z e N(r)$.\nThus, Gauss's law states:\n$$ (2 \\pi r) E(r) = \\frac{1}{\\varepsilon} \\left( \\lambda + z e N(r) \\right) $$\nSubstituting the definitions of $E(r)$, $\\lambda$, and the neutralization fraction $\\theta(r) \\equiv \\dfrac{z e N(r)}{|\\lambda|}$:\n$$ -2 \\pi r \\frac{d\\psi}{dr} = \\frac{1}{\\varepsilon} \\left( -|\\lambda| + |\\lambda| \\theta(r) \\right) = -\\frac{|\\lambda|}{\\varepsilon} \\left( 1 - \\theta(r) \\right) $$\nThis yields an expression for the potential gradient:\n$$ \\frac{d\\psi}{dr} = \\frac{|\\lambda|}{2 \\pi \\varepsilon r} \\left( 1 - \\theta(r) \\right) $$\nThe problem is formulated in terms of the logarithmic coordinate $s = \\ln(r/a)$, so we perform a change of variables. The chain rule gives $\\dfrac{d}{dr} = \\dfrac{ds}{dr}\\dfrac{d}{ds} = \\dfrac{1}{r}\\dfrac{d}{ds}$.\nSubstituting this into the expression for the potential gradient:\n$$ \\frac{1}{r}\\frac{d\\psi}{ds} = \\frac{|\\lambda|}{2 \\pi \\varepsilon r} \\left( 1 - \\theta(s) \\right) $$\n$$ \\frac{d\\psi}{ds} = \\frac{|\\lambda|}{2 \\pi \\varepsilon} \\left( 1 - \\theta(s) \\right) $$\nIt is convenient to work with a dimensionless potential $\\phi(s) \\equiv z e \\beta \\psi(s)$, where $\\beta = 1/(k_B T)$. Differentiating $\\phi(s)$ with respect to $s$:\n$$ \\frac{d\\phi}{ds} = z e \\beta \\frac{d\\psi}{ds} = z e \\beta \\frac{|\\lambda|}{2 \\pi \\varepsilon} \\left( 1 - \\theta(s) \\right) $$\nThe prefactor can be simplified using the definitions of the Bjerrum length $l_B = \\dfrac{e^2 \\beta}{4 \\pi \\varepsilon}$ and the Manning parameter $\\xi = \\dfrac{l_B |\\lambda|}{e}$:\n$$ z e \\beta \\frac{|\\lambda|}{2 \\pi \\varepsilon} = 2 z \\frac{e^2 \\beta}{4 \\pi \\varepsilon} \\frac{|\\lambda|}{e} = 2 z l_B \\frac{|\\lambda|}{e} = 2 z \\xi $$\nThis gives a fundamental relation between the dimensionless potential and the neutralization fraction:\n$$ \\frac{d\\phi}{ds} = 2 z \\xi \\left(1 - \\theta(s)\\right) \\quad (1) $$\nNext, we derive a second, independent relation. From the definition of $\\theta(r)$:\n$$ \\theta(r) = \\frac{z e}{|\\lambda|} N(r) = \\frac{z e}{|\\lambda|} 2 \\pi \\int_a^r n(r') r' \\, dr' $$\nDifferentiating with respect to $r$ using the fundamental theorem of calculus:\n$$ \\frac{d\\theta}{dr} = \\frac{2 \\pi z e}{|\\lambda|} r n(r) $$\nChanging variables to $s$:\n$$ \\frac{1}{r}\\frac{d\\theta}{ds} = \\frac{2 \\pi z e}{|\\lambda|} r n(s) \\implies \\frac{d\\theta}{ds} = \\frac{2 \\pi z e}{|\\lambda|} r^2 n(s) $$\nWithin the PB framework, the counterion density follows the Boltzmann distribution, $n(s) = n_0 \\exp(-z e \\beta \\psi(s)) = n_0 \\exp(-\\phi(s))$, where $n_0$ is a normalization constant.\n$$ \\frac{d\\theta}{ds} = \\frac{2 \\pi z e}{|\\lambda|} r^2 n_0 \\exp(-\\phi(s)) $$\nSince $r = a \\exp(s)$, we have $r^2 = a^2 \\exp(2s)$:\n$$ \\frac{d\\theta}{ds} = \\frac{2 \\pi z e n_0 a^2}{|\\lambda|} \\exp(2s) \\exp(-\\phi(s)) \\quad (2) $$\nWe now have two coupled first-order differential equations for $\\theta(s)$ and $\\phi(s)$. To find an equation for $\\theta(s)$ alone, we eliminate $\\phi(s)$. From equation (2), we isolate $\\exp(-\\phi(s))$:\n$$ \\exp(-\\phi(s)) = \\left(\\frac{|\\lambda|}{2 \\pi z e n_0 a^2}\\right) \\exp(-2s) \\frac{d\\theta}{ds} $$\nTaking the natural logarithm of both sides:\n$$ -\\phi(s) = \\ln\\left(\\frac{d\\theta}{ds}\\right) - 2s + C $$\nwhere $C$ is a constant incorporating all constant terms. Differentiating with respect to $s$:\n$$ -\\frac{d\\phi}{ds} = \\frac{d}{ds}\\left(\\ln\\left(\\frac{d\\theta}{ds}\\right)\\right) - 2 = \\frac{d^2\\theta/ds^2}{d\\theta/ds} - 2 $$\nNow, we substitute the expression for $\\dfrac{d\\phi}{ds}$ from equation (1):\n$$ - \\left[ 2 z \\xi \\left(1 - \\theta(s)\\right) \\right] = \\frac{d^2\\theta/ds^2}{d\\theta/ds} - 2 $$\nRearranging gives a second-order ordinary differential equation for $\\theta(s)$:\n$$ \\frac{d^2\\theta}{ds^2} = \\left[ 2 - 2 z \\xi \\left(1 - \\theta(s)\\right) \\right] \\frac{d\\theta}{ds} $$\nThe problem defines the condensation radius $r_c$, corresponding to $s_c = \\ln(r_c/a)$, as the location of the inflection point of the curve $\\theta(s)$. Mathematically, this is the point where the second derivative vanishes:\n$$ \\frac{d^2\\theta}{ds^2}\\bigg|_{s=s_c} = 0 $$\nApplying this condition to our derived equation:\n$$ \\left[ 2 - 2 z \\xi \\left(1 - \\theta(s_c)\\right) \\right] \\frac{d\\theta}{ds}\\bigg|_{s=s_c} = 0 $$\nThis equation holds if at least one of its factors is zero. Let us analyze the factor $\\dfrac{d\\theta}{ds}$. From its definition, $\\dfrac{d\\theta}{dr} = \\dfrac{2 \\pi z e}{|\\lambda|} r n(r)$. Since the ion density $n(r)$ must be positive definite for any finite $r$, and $r > a > 0$, it follows that $\\dfrac{d\\theta}{dr} > 0$. Consequently, $\\dfrac{d\\theta}{ds} = r \\dfrac{d\\theta}{dr} > 0$. The neutralization fraction $\\theta(s)$ is a strictly monotonically increasing function of $s$.\nTherefore, the term $\\dfrac{d\\theta}{ds}\\bigg|_{s=s_c}$ cannot be zero. The condition for the inflection point must be satisfied by the other factor:\n$$ 2 - 2 z \\xi \\left(1 - \\theta(s_c)\\right) = 0 $$\nThe problem defines the condensed fraction as $f_c \\equiv \\theta(s_c)$. Substituting this into the equation:\n$$ 2 - 2 z \\xi \\left(1 - f_c\\right) = 0 $$\nThis is a simple algebraic equation for $f_c$.\n$$ 1 - z \\xi \\left(1 - f_c\\right) = 0 $$\n$$ 1 = z \\xi (1 - f_c) $$\n$$ \\frac{1}{z \\xi} = 1 - f_c $$\nSolving for $f_c$ yields the final expression:\n$$ f_c = 1 - \\frac{1}{z \\xi} $$\nThe problem states that $\\xi > 1/z$, which ensures that $z\\xi > 1$. This implies that $0 < \\dfrac{1}{z\\xi} < 1$, and consequently $0 < f_c < 1$, which is a physically meaningful range for a fraction. This confirms the consistency of the problem's premises.", "answer": "$$\\boxed{1 - \\frac{1}{z \\xi}}$$", "id": "2911234"}, {"introduction": "Analytical models often simplify reality; in polyelectrolyte theory, the discrete charges on a polymer are typically smeared into a continuous line charge. This advanced computational practice challenges you to test the validity of that crucial approximation by building a model with discrete charges from the ground up. By implementing a numerical simulation and comparing its outcomes against the predictions of the continuum theory, you will develop valuable computational skills and gain critical insight into the assumptions and limitations of the models used to describe the molecular world [@problem_id:2911243].", "problem": "Consider a long, uniformly spaced array of monovalent charges of magnitude $e$ arranged along the $z$-axis at positions $z = nb$ for all integers $n$, where $b$ is the spacing between neighboring charges. The array is embedded within a cylindrical domain of solvent (dielectric constant $\\varepsilon$) at temperature $T$, and we define the Bjerrum length $l_B \\equiv e^2/(4 \\pi \\varepsilon k_B T)$, where $k_B$ is the Boltzmann constant. The array is confined inside a coaxial cylindrical simulation domain of inner excluded radius $a$ (hard core of the macromolecule) and outer radius $R$, with $a < R$. The system contains point-like monovalent counterions of charge $+e$ in thermal equilibrium at temperature $T$, interacting electrostatically with the fixed charges. Assume no added salt and no counterion-counterion interaction beyond mean-field, and neglect any axial end effects by assuming periodicity along $z$.\n\nYour objective is to compute and compare two estimates of the condensed fraction of counterions: an operational, discrete-charge lattice estimate based on a nearest-charge Boltzmann weight and a continuum-theory estimate obtained from a normalizability criterion for the counterion distribution around a continuous line charge.\n\nFundamental base to be used:\n- Coulomb’s law in three dimensions for point charges, combined with the Boltzmann distribution for a particle in an external potential.\n- For a continuous line charge, the electrostatic potential depends only on radial distance $r$, and cylindrical coordinates must be used with the correct Jacobian.\n- The definition of the dimensionless line-charge parameter is $\\xi \\equiv l_B/b$.\n\nDiscrete-charge lattice model (operational definition):\n- Let $r$ denote the radial coordinate and $z$ the axial coordinate. Consider a single period $z \\in [0,b]$ with periodic continuation along $z$.\n- Define the minimum axial distance to the nearest discrete charge as $d_z(z) \\equiv \\min(z \\bmod b, b - (z \\bmod b))$.\n- Define the nearest-charge distance $d_{\\min}(r,z) \\equiv \\sqrt{r^2 + d_z(z)^2}$.\n- The single-ion Boltzmann weight relative to the nearest discrete charge is taken as $\\exp(l_B/d_{\\min}(r,z))$, and the spatial measure in cylindrical coordinates is proportional to $r \\, dr \\, dz$.\n- Introduce a physically measurable cutoff $r_c$ with $a < r_c < R$. Operationally, classify a counterion as “condensed” if $d_{\\min}(r,z) \\le r_c$.\n- The operational condensed fraction in the discrete-charge lattice model is then\n$$\nf_{\\mathrm{lat}} \\equiv \\frac{\\displaystyle \\int_{0}^{b} \\int_{a}^{R} \\exp\\!\\left(\\frac{l_B}{d_{\\min}(r,z)}\\right) \\, r \\, \\Theta\\!\\left(r_c - d_{\\min}(r,z)\\right) \\, dr \\, dz}{\\displaystyle \\int_{0}^{b} \\int_{a}^{R} \\exp\\!\\left(\\frac{l_B}{d_{\\min}(r,z)}\\right) \\, r \\, dr \\, dz},\n$$\nwhere $\\Theta$ is the Heaviside step function. You must compute $f_{\\mathrm{lat}}$ numerically using a rectangular lattice discretization in $r$ and $z$ with midpoint sampling.\n\nContinuum line-charge model (theoretical estimate):\n- Replace the discrete charges by a continuous line-charge density of magnitude $\\lambda = -e/b$ restricted to $r \\ge a$. Using the Boltzmann distribution for monovalent counterions in the resulting cylindrically symmetric potential, derive the radial probability weight per unit length proportional to $r \\exp(-\\psi(r))$, where $\\psi(r)$ is the dimensionless electrostatic potential. Use the fact that, for a uniform line-charge, this weight can be written as a power law in $r$ times the cylindrical Jacobian.\n- Establish the normalizability condition of the counterion distribution in the absence of explicit short-distance regularization beyond the hard core at $r=a$, and identify the critical value of the dimensionless line-charge parameter $\\xi \\equiv l_B/b$ at which the distribution is marginally normalizable.\n- Define the continuum-theory condensed fraction $f_c$ as the minimal fraction of neutralization of the line charge necessary to render the counterion distribution marginally normalizable.\n\nAlgorithmic tasks:\n- Starting only from the above fundamental base, derive: \n  1. the radial weight for counterions around a continuous line charge as a function of $\\xi$ and the cylindrical Jacobian, \n  2. the normalizability threshold in terms of $\\xi$, and \n  3. an explicit algorithm to compute $f_c$ from $\\xi$ using the marginal-normalizability criterion.\n- Implement a program that:\n  1. Computes $f_{\\mathrm{lat}}$ via numerical quadrature on a rectangular $(r,z)$ lattice using midpoint sampling and the nearest-charge Boltzmann weight,\n  2. Computes $f_c$ using the algorithm you derived from the normalizability threshold,\n  3. Produces outputs for the test suite below.\n\nNumerical and unit requirements:\n- Use lengths in nanometers (nm). Express all length parameters in nanometers. The final condensed fractions must be reported as decimal numbers (unitless fractions).\n- Use midpoint quadrature with uniform grids in $r$ and $z$. Let the number of radial points be $N_r = 1000$ and the number of axial points be $N_z = 800$. The radial midpoints should span $[a,R]$, and axial midpoints should span $[0,b]$.\n- To ensure numerical stability in evaluating exponentials, you may subtract a constant reference from the exponent (which cancels in the ratio).\n\nTest suite:\n- Use Bjerrum length $l_B = 0.7\\,\\mathrm{nm}$ and inner radius $a = 0.3\\,\\mathrm{nm}$ and outer radius $R = 10.0\\,\\mathrm{nm}$ for all cases. For each case, the line-charge spacing $b$ and the cutoff $r_c$ are given.\n- Four cases designed to probe different regimes of the dimensionless line-charge parameter $\\xi = l_B/b$:\n  1. Case A (subcritical): $b = 0.875\\,\\mathrm{nm}$ (so $\\xi \\approx 0.8$), $r_c = 0.8\\,\\mathrm{nm}$.\n  2. Case B (critical): $b = 0.7\\,\\mathrm{nm}$ (so $\\xi = 1$), $r_c = 0.8\\,\\mathrm{nm}$.\n  3. Case C (supercritical): $b = 0.35\\,\\mathrm{nm}$ (so $\\xi = 2$), $r_c = 0.6\\,\\mathrm{nm}$.\n  4. Case D (strongly supercritical): $b = 0.14\\,\\mathrm{nm}$ (so $\\xi = 5$), $r_c = 0.5\\,\\mathrm{nm}$.\n\nRequired final output format:\n- Your program should produce a single line of output containing the results as a comma-separated list of lists, one per test case, in the order A, B, C, D. Each inner list must contain two decimal numbers: the discrete-charge lattice condensed fraction and the continuum-theory condensed fraction, i.e., $[f_{\\mathrm{lat}}, f_c]$. For example, an acceptable output format is \n  \"[[x1,y1],[x2,y2],[x3,y3],[x4,y4]]\"\nwith no spaces inside or outside the brackets. Roundoff is not prescribed; print your computed floating-point values directly.", "solution": "The problem statement has been rigorously validated. It is scientifically grounded, well-posed, objective, and internally consistent. All necessary physical parameters, mathematical definitions, and numerical specifications are provided to permit a unique and meaningful solution. The problem is a standard exercise in the statistical mechanics of polyelectrolytes, comparing a discrete-charge model to the classic continuum model of Manning. We may therefore proceed with the solution.\n\nThe problem requires the calculation of two distinct estimates for the fraction of condensed counterions, $f_{\\mathrm{lat}}$ from a discrete-charge lattice model and $f_c$ from a continuum line-charge model.\n\nFirst, we derive the expression for the continuum-theory condensed fraction, $f_c$.\nThe system is modeled as an infinite, continuous line of charge with a linear charge density $\\lambda = -e/b$, where $-e$ is the charge of a monomer and $b$ is the spacing. The analysis is performed in cylindrical coordinates $(r, \\theta, z)$. By Gauss's law for a cylinder of radius $r$ and length $L$ coaxial with the line charge, the electric field $\\vec{E}(r)$ is purely radial:\n$$\n\\oint \\vec{E} \\cdot d\\vec{A} = E_r(r) \\cdot (2\\pi r L) = \\frac{Q_{enc}}{\\varepsilon}\n$$\nwhere $\\varepsilon$ is the absolute permittivity of the solvent. The enclosed charge is $Q_{enc} = \\lambda L = (-e/b)L$. Thus, the electric field is:\n$$\nE_r(r) = \\frac{-e}{2 \\pi \\varepsilon b r}\n$$\nThe electrostatic potential $\\phi(r)$ is found by integrating the electric field from the hard-core radius $a$ to a radial distance $r$, setting $\\phi(a) = 0$:\n$$\n\\phi(r) = -\\int_a^r E_r(r') dr' = \\int_a^r \\frac{e}{2 \\pi \\varepsilon b r'} dr' = \\frac{e}{2 \\pi \\varepsilon b} \\ln\\left(\\frac{r}{a}\\right)\n$$\nThe potential energy of a monovalent counterion of charge $+e$ in this potential is $U(r) = e \\phi(r)$. The dimensionless potential energy, $\\psi(r)$, in units of thermal energy $k_B T$, is:\n$$\n\\psi(r) = \\frac{U(r)}{k_B T} = \\frac{e^2}{2 \\pi \\varepsilon k_B T b} \\ln\\left(\\frac{r}{a}\\right)\n$$\nUsing the definitions of the Bjerrum length, $l_B = e^2/(4 \\pi \\varepsilon k_B T)$, and the dimensionless line-charge parameter, $\\xi = l_B/b$, this simplifies to:\n$$\n\\psi(r) = 2 \\left( \\frac{e^2}{4 \\pi \\varepsilon k_B T b} \\right) \\ln\\left(\\frac{r}{a}\\right) = 2 \\frac{l_B}{b} \\ln\\left(\\frac{r}{a}\\right) = 2\\xi \\ln\\left(\\frac{r}{a}\\right)\n$$\nThe probability of finding a counterion in a volume element $dV$ is proportional to the Boltzmann factor, $\\exp(-\\psi(r))$. The volume element in cylindrical coordinates per unit length is $2\\pi r dr$. The radial probability weight per unit length, $w(r)$, is therefore proportional to the product of the Boltzmann factor and the cylindrical Jacobian factor $r$:\n$$\nw(r) \\propto r \\exp(-\\psi(r)) = r \\exp\\left(-2\\xi \\ln\\left(\\frac{r}{a}\\right)\\right) = r \\left(\\frac{r}{a}\\right)^{-2\\xi} = a^{2\\xi} r^{1-2\\xi}\n$$\nFor the counterion distribution to be normalizable over an infinite domain ($R \\to \\infty$), the integral of the probability weight must converge. The integral is:\n$$\n\\int_a^\\infty w(r) dr \\propto \\int_a^\\infty r^{1-2\\xi} dr\n$$\nThis integral converges if and only if the exponent of $r$ is less than $-1$, i.e., $1-2\\xi < -1$, which implies $2 < 2\\xi$, or $\\xi > 1$. If $\\xi \\le 1$, the integral diverges, implying an infinite accumulation of counterions at large distances, a physical paradox known as the \"condensation catastrophe.\"\nThe system resolves this paradox through counterion condensation. If the bare line-charge parameter $\\xi$ is greater than the critical value $\\xi_c = 1$, a fraction $f_c$ of the counterions \"condense\" onto the polymer, effectively neutralizing a portion of its charge. The remaining \"free\" or \"atmospheric\" counterions then experience a reduced effective line-charge density, $\\lambda_{eff} = (1-f_c)\\lambda$. The corresponding effective line-charge parameter is $\\xi_{eff} = (1-f_c)\\xi$. The condensation process proceeds until the system reaches the marginal stability point, where $\\xi_{eff} = 1$.\nTherefore, for $\\xi > 1$, we set:\n$$\n\\xi_{eff} = (1 - f_c)\\xi = 1 \\implies 1 - f_c = \\frac{1}{\\xi} \\implies f_c = 1 - \\frac{1}{\\xi}\n$$\nIf $\\xi \\le 1$, the bare charge density is not high enough to induce this condensation, so $f_c = 0$. The algorithm for $f_c$ is:\n1.  Calculate $\\xi = l_B/b$.\n2.  If $\\xi \\le 1$, $f_c = 0$.\n3.  If $\\xi > 1$, $f_c = 1 - 1/\\xi$.\nThis can be expressed compactly as $f_c = \\max(0, 1 - 1/\\xi)$.\n\nNext, we specify the numerical algorithm for the discrete-charge lattice model fraction, $f_{\\mathrm{lat}}$.\nThe definition is given as a ratio of two integrals:\n$$\nf_{\\mathrm{lat}} = \\frac{N_{cond}}{N_{total}} = \\frac{\\displaystyle \\int_{0}^{b} \\int_{a}^{R} \\exp\\!\\left(\\frac{l_B}{d_{\\min}(r,z)}\\right) \\, r \\, \\Theta\\!\\left(r_c - d_{\\min}(r,z)\\right) \\, dr \\, dz}{\\displaystyle \\int_{0}^{b} \\int_{a}^{R} \\exp\\!\\left(\\frac{l_B}{d_{\\min}(r,z)}\\right) \\, r \\, dr \\, dz}\n$$\nWe compute these integrals using midpoint quadrature on a uniform rectangular grid. The integration domain is $(r,z) \\in [a, R] \\times [0, b]$. We use $N_r = 1000$ radial steps and $N_z = 800$ axial steps.\nThe step sizes are $\\Delta r = (R-a)/N_r$ and $\\Delta z = b/N_z$.\nThe grid midpoints are:\n$r_i = a + (i + 1/2)\\Delta r$ for $i=0, \\dots, N_r-1$.\n$z_j = (j + 1/2)\\Delta z$ for $j=0, \\dots, N_z-1$.\n\nFor each grid point $(r_i, z_j)$, we compute the integrand. The distance to the nearest fixed charge is $d_{\\min}(r_i, z_j) = \\sqrt{r_i^2 + d_z(z_j)^2}$, where $d_z(z_j) = \\min(z_j, b - z_j)$.\nThe term in the exponent is $U_{ij} = l_B / d_{\\min}(r_i, z_j)$.\nTo avoid numerical overflow from the exponential function, we find the maximum value $U_{max} = \\max_{i,j}\\{U_{ij}\\}$ over the grid and compute a stabilized weight $W_{ij} = \\exp(U_{ij} - U_{max})$. This scaling factor cancels in the final ratio.\n\nThe integrals are approximated by summations. The constant factors $\\Delta r \\Delta z$ also cancel.\nThe denominator sum is:\n$$\nD = \\sum_{j=0}^{N_z-1} \\sum_{i=0}^{N_r-1} r_i W_{ij}\n$$\nThe numerator sum, which includes only contributions from \"condensed\" ions where $d_{\\min}(r_i, z_j) \\le r_c$, is:\n$$\nN = \\sum_{j=0}^{N_z-1} \\sum_{i=0}^{N_r-1} r_i W_{ij} \\cdot \\mathbf{1}_{d_{\\min}(r_i, z_j) \\le r_c}\n$$\nwhere $\\mathbf{1}_{(\\cdot)}$ is the indicator function, computationally equivalent to the Heaviside function $\\Theta(\\cdot)$ for this condition.\nThe condensed fraction is then $f_{\\mathrm{lat}} = N/D$. This procedure is implemented for each test case.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the counterion condensation problem for the given test cases.\n    It calculates two estimates for the condensed counterion fraction:\n    1. f_lat: Based on a discrete-charge lattice model with a spatial cutoff.\n    2. f_c: Based on the continuum Manning-Oosawa theory.\n    \"\"\"\n\n    # Global parameters from the problem statement.\n    l_B = 0.7  # Bjerrum length in nm\n    a = 0.3    # Inner excluded radius in nm\n    R = 10.0   # Outer radius of the simulation domain in nm\n    N_r = 1000 # Number of radial grid points\n    N_z = 800  # Number of axial grid points\n\n    # Test suite: each entry is a tuple (b, r_c).\n    # b: spacing between charges in nm\n    # r_c: cutoff distance for 'condensed' definition in nm\n    test_cases = [\n        # Case A (subcritical)\n        (0.875, 0.8),\n        # Case B (critical)\n        (0.7, 0.8),\n        # Case C (supercritical)\n        (0.35, 0.6),\n        # Case D (strongly supercritical)\n        (0.14, 0.5),\n    ]\n\n    results = []\n    for b, r_c in test_cases:\n        # --- Continuum Model Calculation (f_c) ---\n        # The derivation is based on the marginal normalizability of the\n        # counterion distribution.\n\n        # Calculate the dimensionless line-charge parameter xi.\n        xi = l_B / b\n\n        # Calculate the condensed fraction f_c based on Manning theory.\n        # Condensation occurs to reduce the effective xi to 1.\n        # If xi <= 1, no condensation is predicted by this theory.\n        if xi > 1.0:\n            f_c = 1.0 - 1.0 / xi\n        else:\n            f_c = 0.0\n\n        # --- Discrete-Charge Lattice Model Calculation (f_lat) ---\n        # This is a numerical integration over a 2D grid.\n\n        # 1. Set up the numerical grid using midpoint rule.\n        # Radial grid\n        dr = (R - a) / N_r\n        r_points = a + (np.arange(N_r) + 0.5) * dr\n        # Axial grid\n        dz = b / N_z\n        z_points = (np.arange(N_z) + 0.5) * dz\n        \n        # Create 2D meshgrids for vectorized calculations.\n        # R_grid has shape (N_z, N_r), Z_grid has shape (N_z, N_r).\n        R_grid, Z_grid = np.meshgrid(r_points, z_points, indexing='xy')\n\n        # 2. Calculate terms of the integrand at each grid point.\n        # Minimum axial distance to the nearest fixed charge at z=0 or z=b.\n        d_z = np.minimum(Z_grid, b - Z_grid)\n        \n        # Minimum distance to the nearest fixed charge.\n        d_min = np.sqrt(R_grid**2 + d_z**2)\n        \n        # Potential energy term in the exponent (U/kT is dimensionless).\n        potential_term = l_B / d_min\n\n        # 3. Stabilize the Boltzmann factor to prevent numerical overflow.\n        # Find max value of the exponent and subtract it before exponentiating.\n        # This constant factor will cancel out in the final ratio.\n        max_potential = np.max(potential_term)\n        boltzmann_weights = np.exp(potential_term - max_potential)\n\n        # 4. Perform the numerical integration (summation).\n        # The integrand is r * weight. The integration element dr*dz is constant\n        # and cancels in the ratio.\n        integrand = R_grid * boltzmann_weights\n        \n        # Denominator is the integral over the entire domain.\n        denominator_sum = np.sum(integrand)\n\n        # Numerator is the integral over the \"condensed\" region,\n        # defined where d_min <= r_c.\n        # We use a boolean mask to select the condensed region.\n        condensed_mask = (d_min <= r_c)\n        numerator_sum = np.sum(integrand * condensed_mask)\n\n        # 5. Calculate the final fraction.\n        f_lat = numerator_sum / denominator_sum if denominator_sum != 0 else 0.0\n\n        results.append([f_lat, f_c])\n\n    # Format the output string exactly as required, without spaces.\n    inner_parts = [f\"[{res[0]},{res[1]}]\" for res in results]\n    final_output_string = f\"[{','.join(inner_parts)}]\"\n    \n    print(final_output_string)\n\nsolve()\n```", "id": "2911243"}]}