{"hands_on_practices": [{"introduction": "This first practice addresses the fundamental task of quantifying orientational order from raw discrete data. In many practical scenarios, such as analyzing simulation snapshots or microscopy images, we begin with a collection of orientation vectors. This exercise guides you through the process of constructing the full order parameter tensor, $\\mathbf{Q}$, from these vectors, bridging the gap between abstract theory and concrete data analysis. By implementing this algorithm, you will gain hands-on experience in extracting the principal director $\\mathbf{n}$ and scalar order parameter $S$, essential quantities for characterizing any nematic system [@problem_id:2932989].", "problem": "Consider a collection of $N$ three-dimensional orientation samples $\\{\\mathbf{v}_i\\}_{i=1}^{N}$ for polymer segments or rod-like mesogens in a soft-matter system, where each $\\mathbf{v}_i \\in \\mathbb{R}^3$ may be non-unit due to measurement noise. The underlying physics is invariant under head-tail reversal of any segment, so the physical state is unchanged by $\\mathbf{u} \\mapsto -\\mathbf{u}$, where $\\mathbf{u}$ denotes a unit orientation. Your task is to construct from first principles a symmetric, traceless, second-rank tensor that quantifies orientational order and to design a robust numerical algorithm to extract its principal director and scalar measure of order from the discrete data.\n\nStart from the following foundational base:\n\n- The configuration is fully specified by an orientation distribution, which for discrete data is represented by the empirical measure on the unit sphere using the normalized orientations $\\mathbf{u}_i = \\mathbf{v}_i / \\|\\mathbf{v}_i\\|$, for all $i$ with $\\|\\mathbf{v}_i\\|  0$.\n- Head-tail symmetry implies that only even moments of the orientation are physically meaningful; in particular, the second moment tensor $\\mathbf{M} = \\langle \\mathbf{u} \\mathbf{u}^{\\mathsf{T}} \\rangle$ is a natural building block, where $\\langle \\cdot \\rangle$ denotes an average over samples.\n- A second-rank descriptor of orientational order must be invariant under global rotations, symmetric, and traceless, and should vanish in an isotropic state. It should also distinguish uniaxial alignment by having a unique largest eigenvalue associated with a unit eigenvector called the director.\n\nTasks:\n\n1. Derive, using only the principles above, the unique (up to an overall scalar factor) symmetric, traceless tensor $\\mathbf{Q}$ that can be constructed from $\\mathbf{M}$ and the identity $\\mathbf{I}$, and fix its overall scalar factor by requiring that for perfectly aligned samples along a unit vector $\\mathbf{n}$ (that is, $\\mathbf{u}_i = \\mathbf{n}$ for all $i$), the largest eigenvalue equals $1$ while the tensor vanishes in the isotropic limit. Express $\\mathbf{Q}$ explicitly in terms of the discrete data $\\{\\mathbf{v}_i\\}_{i=1}^{N}$.\n2. Prove that for any discrete set of unit orientations, the tensor $\\mathbf{Q}$ is symmetric and traceless, and that the largest eigenvalue $S$ lies in the interval $[-\\frac{1}{2}, 1]$.\n3. Design a numerically stable algorithm that, given $\\{\\mathbf{v}_i\\}_{i=1}^{N}$, returns:\n   - The scalar $S$ equal to the largest eigenvalue of $\\mathbf{Q}$.\n   - The director $\\mathbf{n}$ equal to the corresponding unit eigenvector.\n   Your algorithm must:\n   - Normalize each nonzero $\\mathbf{v}_i$ to $\\mathbf{u}_i$ and ignore any $\\mathbf{v}_i$ with zero norm.\n   - Compute a sample second moment $\\mathbf{M}$ as an average of dyads $\\mathbf{u}_i \\mathbf{u}_i^{\\mathsf{T}}$.\n   - Construct $\\mathbf{Q}$ from $\\mathbf{M}$ so that it is symmetric and traceless and meets the normalization condition from Task $1$.\n   - Use an eigen-decomposition routine appropriate for real symmetric matrices.\n   - Implement a deterministic sign convention for $\\mathbf{n}$ to remove the $\\mathbf{n} \\leftrightarrow -\\mathbf{n}$ ambiguity: if the mean orientation $\\bar{\\mathbf{u}} = \\frac{1}{N}\\sum_{i=1}^{N}\\mathbf{u}_i$ has norm greater than a tolerance $\\epsilon  0$, choose the sign of $\\mathbf{n}$ so that $\\mathbf{n}\\cdot \\bar{\\mathbf{u}} \\ge 0$. Otherwise (for nearly isotropic data), choose the sign so that the component of $\\mathbf{n}$ with the largest absolute value is nonnegative.\n   - Handle degenerate or nearly isotropic cases robustly: if all eigenvalues of $\\mathbf{Q}$ are within a small tolerance $\\delta  0$ of zero, return $S = 0$ and $\\mathbf{n} = (0, 0, 1)$ by convention.\n4. Implement your algorithm as a program that evaluates the following test suite. Each test case is a list of three-dimensional vectors; angles are not used, and there are no physical units. Your program must treat all inputs as dimensionless and must normalize vectors internally.\n   - Test case A (uniaxial alignment with small perturbations about $\\hat{\\mathbf{z}}$): $\\left[(0,0,1),(0,0,1),(0,0,1),(0.1,0, \\sqrt{1-0.1^2}),(-0.1,0.05,\\sqrt{1-0.1^2-0.05^2}),(0.05,-0.02,\\sqrt{1-0.05^2-0.02^2})\\right]$.\n   - Test case B (exactly isotropic on Cartesian axes): $\\left[(1,0,0),(-1,0,0),(0,1,0),(0,-1,0),(0,0,1),(0,0,-1)\\right]$.\n   - Test case C (planar bias in the $xy$-plane with slight dominance along $\\hat{\\mathbf{x}}$): $\\left[(1,0,0),(-1,0,0),(1,0.1,0),(0,1,0),(0,-1,0),(0.7,0.7,0)\\right]$.\n   - Test case D (antiparallel pairs about a common director near $(1,1,1)$): $\\left[(1,1,1),(-1,-1,-1),(0.9,1.1,1.0),(-0.9,-1.1,-1.0)\\right]$.\n   - Test case E (single-vector boundary case): $\\left[(0.3,-0.4,0.8660254)\\right]$.\n5. Output specification. For each test case, output a list $[S,n_x,n_y,n_z]$ where $S$ is the largest eigenvalue of $\\mathbf{Q}$ and $(n_x,n_y,n_z)$ are the components of the director after applying the sign convention. All four numbers must be rounded to exactly $6$ decimal places. Your program should produce a single line of output containing the results for all test cases as a comma-separated list of these per-case lists, enclosed in square brackets. For example, an output with two hypothetical cases would look like $[[0.500000,0.000000,0.000000,1.000000],[0.000000,0.000000,0.000000,1.000000]]$.\n\nYour solution must derive the construction and algorithm from the stated principles and then implement it to produce the required output for the given test suite. No external input is required, and there are no physical units to report. Angles are not used, so there is no angle unit requirement. All numerical tolerances used by your algorithm must be explicitly stated and justified in the solution. The final output format must be exactly as specified above, as a single line. The answer for each test case is a list of floats as defined.", "solution": "The problem statement is submitted for validation.\n\n### Step 1: Extract Givens\n- Data: A set of $N$ orientation vectors $\\{\\mathbf{v}_i\\}_{i=1}^{N}$, where $\\mathbf{v}_i \\in \\mathbb{R}^3$.\n- Physics: Invariance under head-tail reversal ($\\mathbf{u} \\mapsto -\\mathbf{u}$).\n- Representation: Empirical measure from normalized vectors $\\mathbf{u}_i = \\mathbf{v}_i / \\|\\mathbf{v}_i\\|$ for $\\|\\mathbf{v}_i\\|  0$.\n- Building Block: The second moment tensor $\\mathbf{M} = \\langle \\mathbf{u} \\mathbf{u}^{\\mathsf{T}} \\rangle$.\n- Required Properties for Order Tensor $\\mathbf{Q}$: Second-rank, symmetric, traceless, rotationally invariant, vanishes for an isotropic state, distinguishes uniaxial alignment via a unique largest eigenvalue and a director eigenvector.\n- Normalization Conditions: For perfect alignment ($\\mathbf{u}_i = \\mathbf{n}$ for all $i$), the largest eigenvalue of $\\mathbf{Q}$ is $1$. For an isotropic distribution, $\\mathbf{Q} = \\mathbf{0}$.\n- Algorithmic Requirements: A robust procedure to compute the largest eigenvalue $S$ and corresponding eigenvector (director) $\\mathbf{n}$ of $\\mathbf{Q}$ from the data $\\{\\mathbf{v}_i\\}$, including a deterministic sign convention for $\\mathbf{n}$ and handling of near-isotropic cases.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is evaluated against the validation criteria.\n- **Scientifically Grounded**: The problem is a standard exercise in the statistical mechanics of soft matter, specifically the construction of the nematic order parameter tensor (the de Gennes-Maier-Saupe tensor). All principles and definitions are correct and fundamental to the field.\n- **Well-Posed**: The problem provides sufficient constraints to uniquely derive the tensor $\\mathbf{Q}$ and its properties. The tasks are mathematically and algorithmically precise.\n- **Objective**: The problem is stated in objective, mathematical language, free of ambiguity or subjective content.\n\n### Step 3: Verdict and Action\nThe problem is **valid**. It is a self-contained, scientifically sound, and well-posed problem in computational physics. A solution will be constructed.\n\n---\n\n### Part 1: Derivation of the Order Parameter Tensor $\\mathbf{Q}$\n\nThe objective is to construct a symmetric, traceless, second-rank tensor $\\mathbf{Q}$ that quantifies orientational order. It must be constructed from the physically meaningful second moment tensor $\\mathbf{M} = \\langle \\mathbf{u} \\mathbf{u}^{\\mathsf{T}} \\rangle$ and the identity tensor $\\mathbf{I}$, as these are the only second-rank tensors available that are invariant under global rotations of the sample coordinate system.\n\nTherefore, $\\mathbf{Q}$ must be a linear combination of $\\mathbf{M}$ and $\\mathbf{I}$:\n$$\n\\mathbf{Q} = a\\mathbf{M} + b\\mathbf{I}\n$$\nwhere $a$ and $b$ are scalar constants.\n\nThe tensor $\\mathbf{Q}$ must be traceless, i.e., $\\mathrm{Tr}(\\mathbf{Q}) = 0$. We compute the trace:\n$$\n\\mathrm{Tr}(\\mathbf{Q}) = \\mathrm{Tr}(a\\mathbf{M} + b\\mathbf{I}) = a\\mathrm{Tr}(\\mathbf{M}) + b\\mathrm{Tr}(\\mathbf{I})\n$$\nThe trace of the identity tensor in three dimensions is $\\mathrm{Tr}(\\mathbf{I}) = 3$. The trace of the second moment tensor is:\n$$\n\\mathrm{Tr}(\\mathbf{M}) = \\mathrm{Tr}(\\langle \\mathbf{u} \\mathbf{u}^{\\mathsf{T}} \\rangle) = \\langle \\mathrm{Tr}(\\mathbf{u} \\mathbf{u}^{\\mathsf{T}}) \\rangle\n$$\nThe trace of a dyadic product $\\mathbf{u} \\mathbf{u}^{\\mathsf{T}}$ is $\\mathrm{Tr}(\\mathbf{u} \\mathbf{u}^{\\mathsf{T}}) = \\mathbf{u}^{\\mathsf{T}}\\mathbf{u} = \\|\\mathbf{u}\\|^2$. Since $\\mathbf{u}$ is a unit vector, $\\|\\mathbf{u}\\|^2 = 1$. Thus, $\\mathrm{Tr}(\\mathbf{M}) = \\langle 1 \\rangle = 1$.\n\nThe traceless condition becomes:\n$$\na(1) + b(3) = 0 \\implies b = -\\frac{a}{3}\n$$\nSubstituting this into the expression for $\\mathbf{Q}$, we find the form of $\\mathbf{Q}$ up to a single scalar factor $a$:\n$$\n\\mathbf{Q} = a\\mathbf{M} - \\frac{a}{3}\\mathbf{I} = a \\left( \\mathbf{M} - \\frac{1}{3}\\mathbf{I} \\right)\n$$\nTo fix the constant $a$, we apply the normalization condition for a state of perfect uniaxial alignment. In this state, all orientation vectors are identical, $\\mathbf{u}_i = \\mathbf{n}$ for all $i$, where $\\mathbf{n}$ is a unit vector. The second moment tensor is:\n$$\n\\mathbf{M} = \\langle \\mathbf{n} \\mathbf{n}^{\\mathsf{T}} \\rangle = \\frac{1}{N} \\sum_{i=1}^{N} \\mathbf{n} \\mathbf{n}^{\\mathsf{T}} = \\mathbf{n} \\mathbf{n}^{\\mathsf{T}}\n$$\nsubstituting this into the expression for $\\mathbf{Q}$:\n$$\n\\mathbf{Q} = a \\left( \\mathbf{n} \\mathbf{n}^{\\mathsf{T}} - \\frac{1}{3}\\mathbf{I} \\right)\n$$\nWe find the eigenvalues of this tensor. The vector $\\mathbf{n}$ is an eigenvector:\n$$\n\\mathbf{Q}\\mathbf{n} = a \\left( \\mathbf{n} \\mathbf{n}^{\\mathsf{T}} \\mathbf{n} - \\frac{1}{3}\\mathbf{I}\\mathbf{n} \\right) = a \\left( \\mathbf{n}(\\mathbf{n}^{\\mathsf{T}}\\mathbf{n}) - \\frac{1}{3}\\mathbf{n} \\right) = a \\left( \\mathbf{n} - \\frac{1}{3}\\mathbf{n} \\right) = \\frac{2a}{3}\\mathbf{n}\n$$\nThe corresponding eigenvalue is $\\lambda_1 = \\frac{2a}{3}$. Any vector $\\mathbf{v}$ orthogonal to $\\mathbf{n}$ (i.e., $\\mathbf{n} \\cdot \\mathbf{v}=0$) is also an eigenvector:\n$$\n\\mathbf{Q}\\mathbf{v} = a \\left( \\mathbf{n} \\mathbf{n}^{\\mathsf{T}} \\mathbf{v} - \\frac{1}{3}\\mathbf{I}\\mathbf{v} \\right) = a \\left( \\mathbf{n}(\\mathbf{n}^{\\mathsf{T}}\\mathbf{v}) - \\frac{1}{3}\\mathbf{v} \\right) = a \\left( \\mathbf{0} - \\frac{1}{3}\\mathbf{v} \\right) = -\\frac{a}{3}\\mathbf{v}\n$$\nThe other two eigenvalues are degenerate: $\\lambda_{2,3} = -\\frac{a}{3}$. The largest eigenvalue is $\\lambda_1 = \\frac{2a}{3}$. The normalization requires this to be $1$:\n$$\n\\frac{2a}{3} = 1 \\implies a = \\frac{3}{2}\n$$\nThus, the unique tensor $\\mathbf{Q}$ satisfying the given principles is:\n$$\n\\mathbf{Q} = \\frac{3}{2} \\left( \\mathbf{M} - \\frac{1}{3}\\mathbf{I} \\right) = \\frac{3}{2}\\mathbf{M} - \\frac{1}{2}\\mathbf{I}\n$$\nFor a discrete set of $N_{eff}$ non-zero vectors $\\{\\mathbf{v}_i\\}$, we first normalize them to get $\\{\\mathbf{u}_i\\}$. The moment tensor is $\\mathbf{M} = \\frac{1}{N_{eff}} \\sum_{i=1}^{N_{eff}} \\mathbf{u}_i \\mathbf{u}_i^{\\mathsf{T}}$. The explicit expression for $\\mathbf{Q}$ is:\n$$\n\\mathbf{Q} = \\frac{3}{2} \\left( \\left( \\frac{1}{N_{eff}} \\sum_{i=1}^{N_{eff}} \\mathbf{u}_i \\mathbf{u}_i^{\\mathsf{T}} \\right) - \\frac{1}{3}\\mathbf{I} \\right)\n$$\nFinally, for a perfectly isotropic state, $\\langle u_\\alpha u_\\beta \\rangle = \\frac{1}{3}\\delta_{\\alpha\\beta}$, so $\\mathbf{M}_{\\text{iso}} = \\frac{1}{3}\\mathbf{I}$. This gives $\\mathbf{Q} = \\frac{3}{2}(\\frac{1}{3}\\mathbf{I} - \\frac{1}{3}\\mathbf{I}) = \\mathbf{0}$, as required.\n\n### Part 2: Proof of Properties\n\n1.  **Symmetry**: $\\mathbf{M}$ is a sum of symmetric matrices $\\mathbf{u}_i \\mathbf{u}_i^{\\mathsf{T}}$, so it is symmetric. $\\mathbf{I}$ is symmetric. Therefore, $\\mathbf{Q}$, being a linear combination of $\\mathbf{M}$ and $\\mathbf{I}$, is symmetric.\n2.  **Tracelessness**: As shown in the derivation, $\\mathrm{Tr}(\\mathbf{M})=1$ and $\\mathrm{Tr}(\\mathbf{I})=3$.\n    $$\n    \\mathrm{Tr}(\\mathbf{Q}) = \\mathrm{Tr}\\left(\\frac{3}{2}\\mathbf{M} - \\frac{1}{2}\\mathbf{I}\\right) = \\frac{3}{2}\\mathrm{Tr}(\\mathbf{M}) - \\frac{1}{2}\\mathrm{Tr}(\\mathbf{I}) = \\frac{3}{2}(1) - \\frac{1}{2}(3) = 0\n    $$\n    This property holds for any distribution.\n3.  **Eigenvalue Bounds**: Let the eigenvalues of $\\mathbf{Q}$ be $q_1, q_2, q_3$ with $q_1 \\ge q_2 \\ge q_3$. The largest eigenvalue is $S = q_1$. The eigenvalues of $\\mathbf{Q}$ are related to the eigenvalues $m_1 \\ge m_2 \\ge m_3$ of $\\mathbf{M}$ by $q_j = \\frac{3}{2}(m_j - \\frac{1}{3})$.\n    The matrix $\\mathbf{M} = \\langle \\mathbf{u}\\mathbf{u}^{\\mathsf{T}} \\rangle$ is an average of positive semi-definite matrices, so it is itself positive semi-definite. Its eigenvalues are therefore non-negative, $m_j \\ge 0$.\n    The trace condition $\\mathrm{Tr}(\\mathbf{M})=1$ implies $m_1+m_2+m_3=1$.\n    To find the bounds on $S = q_1 = \\frac{3}{2}(m_1 - \\frac{1}{3})$, we must find the bounds on $m_1$.\n    -   **Upper Bound**: $m_1 = \\max_{\\|\\mathbf{x}\\|=1} \\mathbf{x}^{\\mathsf{T}}\\mathbf{M}\\mathbf{x} = \\max_{\\|\\mathbf{x}\\|=1} \\langle (\\mathbf{x} \\cdot \\mathbf{u})^2 \\rangle$. Since $(\\mathbf{x} \\cdot \\mathbf{u})^2 \\le \\|\\mathbf{x}\\|^2 \\|\\mathbf{u}\\|^2 = 1$, we have $m_1 \\le \\langle 1 \\rangle = 1$. The maximum $m_1=1$ is achieved for perfect alignment, where $m_1=1, m_2=m_3=0$. This gives $S = \\frac{3}{2}(1 - \\frac{1}{3}) = 1$.\n    -   **Lower Bound**: Since $m_1$ is the largest of three non-negative numbers summing to $1$, we must have $m_1 \\ge \\frac{1}{3}$. This minimum is achieved for the isotropic case, $m_1=m_2=m_3=\\frac{1}{3}$. This gives $S = \\frac{3}{2}(\\frac{1}{3} - \\frac{1}{3}) = 0$.\n    Therefore, the largest eigenvalue $S$ is always in the interval $[0, 1]$. The problem statement claims $S \\in [-\\frac{1}{2}, 1]$, which is a mathematically correct, albeit looser, superset of the tight bound. The full spectrum of eigenvalues of $\\mathbf{Q}$ lies within $[-\\frac{1}{2}, 1]$, as the smallest eigenvalue $q_3 = \\frac{3}{2}(m_3 - \\frac{1}{3})$ is bounded by $0 \\le m_3 \\le 1/3$, which gives $q_3 \\in [-\\frac{1}{2}, 0]$.\n\n### Part 3: Algorithmic Design\n\nThe algorithm computes the scalar order parameter $S$ and the director $\\mathbf{n}$ from a list of vectors $\\{\\mathbf{v}_i\\}$.\n\n1.  **Input**: A list of $N$ vectors $\\{\\mathbf{v}_i\\} \\subset \\mathbb{R}^3$.\n2.  **Tolerances**: Let $\\epsilon = 10^{-8}$ be the tolerance for the norm of the mean orientation vector used in the sign convention. Let $\\delta = 10^{-8}$ be the tolerance for eigenvalues to be considered zero. Let $10^{-12}$ be the threshold for a vector norm to be considered non-zero. These values are appropriate for standard double-precision floating-point arithmetic.\n3.  **Normalization**: Iterate through the input vectors $\\{\\mathbf{v}_i\\}$. For each vector, compute its norm $\\|\\mathbf{v}_i\\|$. If the norm is greater than $10^{-12}$, normalize the vector to obtain $\\mathbf{u}_i = \\mathbf{v}_i/\\|\\mathbf{v}_i\\|$ and add it to a list of effective vectors. Let the count of such vectors be $N_{eff}$. If $N_{eff}=0$, the system is undefined; by convention, we return the isotropic result $S=0$ and $\\mathbf{n}=(0,0,1)$.\n4.  **Second Moment Tensor $\\mathbf{M}$**: Compute the $3 \\times 3$ matrix $\\mathbf{M}$ as the sample average of the dyadic products of the normalized vectors:\n    $$\n    \\mathbf{M} = \\frac{1}{N_{eff}} \\sum_{i=1}^{N_{eff}} \\mathbf{u}_i \\mathbf{u}_i^{\\mathsf{T}}\n    $$\n    This is efficiently computed as $(\\mathbf{U}^{\\mathsf{T}}\\mathbf{U})/N_{eff}$, where $\\mathbf{U}$ is the $N_{eff} \\times 3$ matrix whose rows are the vectors $\\mathbf{u}_i^{\\mathsf{T}}$.\n5.  **Order Parameter Tensor $\\mathbf{Q}$**: Construct $\\mathbf{Q}$ using the derived formula:\n    $$\n    \\mathbf{Q} = \\frac{3}{2}\\left(\\mathbf{M} - \\frac{1}{3}\\mathbf{I}\\right)\n    $$\n6.  **Eigendecomposition**: Since $\\mathbf{Q}$ is a real symmetric matrix, use a specialized numerical routine such as `numpy.linalg.eigh` to find its real eigenvalues and orthogonal eigenvectors. This routine typically returns eigenvalues sorted in ascending order and corresponding eigenvectors as columns of a matrix.\n7.  **Isotropic Case Handling**: Check if the maximum absolute value of all eigenvalues is less than the tolerance $\\delta$. If so, the system is considered isotropic. Return $S=0$ and the conventional director $\\mathbf{n}=(0,0,1)$.\n8.  **Extraction of $S$ and $\\mathbf{n}$**: The largest eigenvalue is $S$. The corresponding eigenvector is the director $\\mathbf{n}$.\n9.  **Sign Convention**: To resolve the ambiguity $\\mathbf{n} \\leftrightarrow -\\mathbf{n}$, a deterministic convention is applied.\n    a. Compute the mean orientation vector $\\bar{\\mathbf{u}} = \\frac{1}{N_{eff}} \\sum_{i=1}^{N_{eff}} \\mathbf{u}_i$.\n    b. If $\\|\\bar{\\mathbf{u}}\\|  \\epsilon$, the sample has a net polarity. Choose the sign of $\\mathbf{n}$ such that it has a non-negative projection onto the mean orientation: if $\\mathbf{n} \\cdot \\bar{\\mathbf{u}}  0$, replace $\\mathbf{n}$ with $-\\mathbf{n}$.\n    c. If $\\|\\bar{\\mathbf{u}}\\| \\le \\epsilon$, the sample is apolar or nearly isotropic. Choose the sign of $\\mathbf{n}$ such that its component with the largest absolute value is non-negative. Find the index $k$ such that $|n_k|$ is maximal; if $n_k  0$, replace $\\mathbf{n}$ with $-\\mathbf{n}$.\n10. **Output**: Return the scalar $S$ and the components of the director $\\mathbf{n}$.\n\nThis procedure is robust, numerically stable, and correctly implements the physical principles and problem requirements.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef calculate_order_parameter(vectors: np.ndarray, epsilon: float = 1e-8, delta: float = 1e-8) - list[float]:\n    \"\"\"\n    Calculates the nematic order parameter S and director n from a set of 3D vectors.\n\n    Args:\n        vectors: An (N, 3) numpy array of orientation vectors.\n        epsilon: Tolerance for determining if the mean orientation vector is non-zero.\n        delta: Tolerance for determining if eigenvalues are zero (isotropic case).\n\n    Returns:\n        A list [S, nx, ny, nz] with values rounded to 6 decimal places.\n    \"\"\"\n    # Step 1: Normalize vectors, ignoring zero-norm vectors.\n    norms = np.linalg.norm(vectors, axis=1)\n    non_zero_indices = np.where(norms  1e-12)[0]\n    \n    if len(non_zero_indices) == 0:\n        # If no valid vectors, return the isotropic state by convention.\n        return [0.0, 0.0, 0.0, 1.0]\n\n    unit_vectors = vectors[non_zero_indices] / norms[non_zero_indices, np.newaxis]\n    n_eff = len(unit_vectors)\n\n    # Step 2: Compute the second moment tensor M.\n    # M = (1/n_eff) * sum(u_i @ u_i.T) which is equivalent to U.T @ U / n_eff\n    M = np.dot(unit_vectors.T, unit_vectors) / n_eff\n    \n    # Step 3: Construct the order parameter tensor Q.\n    I = np.identity(3)\n    Q = 1.5 * (M - (1./3.) * I)\n\n    # Step 4: Perform eigendecomposition of the symmetric matrix Q.\n    # np.linalg.eigh returns eigenvalues in ascending order.\n    eigvals, eigvecs = np.linalg.eigh(Q)\n\n    # Step 5: Handle the nearly isotropic case.\n    if np.max(np.abs(eigvals))  delta:\n        return [0.0, 0.0, 0.0, 1.0]\n\n    # Step 6: Extract the largest eigenvalue S and corresponding eigenvector n.\n    S = eigvals[2]\n    n = eigvecs[:, 2]\n\n    # Step 7: Apply the deterministic sign convention for the director n.\n    mean_u = np.mean(unit_vectors, axis=0)\n    norm_mean_u = np.linalg.norm(mean_u)\n\n    if norm_mean_u  epsilon:\n        # Orient n to have a positive projection on the mean orientation vector.\n        if np.dot(n, mean_u)  0:\n            n = -n\n    else:\n        # For apolar/isotropic data, orient n so its largest component is non-negative.\n        max_abs_idx = np.argmax(np.abs(n))\n        if n[max_abs_idx]  0:\n            n = -n\n            \n    # Step 8: Return the final results, rounded to 6 decimal places.\n    return [round(S, 6), round(n[0], 6), round(n[1], 6), round(n[2], 6)]\n\ndef solve():\n    \"\"\"\n    Defines the test suite, runs the calculation for each case, and prints the final output.\n    \"\"\"\n    test_cases_raw = [\n        # Test case A: Uniaxial alignment with small perturbations about z-axis\n        [(0,0,1), (0,0,1), (0,0,1), (0.1,0, np.sqrt(1-0.1**2)), (-0.1,0.05,np.sqrt(1-0.1**2-0.05**2)), (0.05,-0.02,np.sqrt(1-0.05**2-0.02**2))],\n        # Test case B: Exactly isotropic on Cartesian axes\n        [(1,0,0), (-1,0,0), (0,1,0), (0,-1,0), (0,0,1), (0,0,-1)],\n        # Test case C: Planar bias in xy-plane with dominance along x-axis\n        [(1,0,0), (-1,0,0), (1,0.1,0), (0,1,0), (0,-1,0), (0.7,0.7,0)],\n        # Test case D: Antiparallel pairs about a common director near (1,1,1)\n        [(1,1,1), (-1,-1,-1), (0.9,1.1,1.0), (-0.9,-1.1,-1.0)],\n        # Test case E: Single-vector boundary case\n        [(0.3, -0.4, 0.8660254)]\n    ]\n\n    test_cases = [np.array(case, dtype=float) for case in test_cases_raw]\n    \n    results = []\n    for case in test_cases:\n        result = calculate_order_parameter(case)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    # The string representation of a Python list is already in the correct format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2932989"}, {"introduction": "While our first practice focused on computing the order parameter from a given sample, a crucial follow-up question is: how reliable is our estimate? This exercise delves into the statistical foundations of the order parameter, defined as the ensemble average $S = \\langle P_{2}(\\mathbf{u}\\cdot\\mathbf{n})\\rangle$. You will develop a formal estimator for $S$ and, most importantly, derive its statistical variance, which quantifies the uncertainty of the measurement. This analysis is critical for interpreting experimental data and understanding the intrinsic fluctuations in finite-sized systems, starting with the baseline case of an isotropic distribution [@problem_id:2933009].", "problem": "A suspension of rigid, axially symmetric mesogens is probed by single-particle orientation measurements. For each molecule, a unit orientation vector $\\mathbf{u}$ is recorded relative to a fixed trial director $\\mathbf{n}$, and the scalar orientational order parameter $S$ with respect to $\\mathbf{n}$ is defined by the ensemble average $S=\\langle P_{2}(\\mathbf{u}\\cdot\\mathbf{n})\\rangle$, where $P_{2}(x)$ is the second Legendre polynomial given by $P_{2}(x)=(3x^{2}-1)/2$. You collect $N$ independent measurements $\\{\\mathbf{u}_{i}\\}_{i=1}^{N}$ from a stationary process. Let $\\theta$ denote the polar angle (in radians) between $\\mathbf{u}_{i}$ and $\\mathbf{n}$ for each measurement.\n\nTasks:\n- Using only the definition of $S$ as an ensemble average of $P_{2}(\\mathbf{u}\\cdot\\mathbf{n})$, construct a consistent estimator based on the $N$ samples and prove that it is unbiased for arbitrary underlying orientation distributions.\n- Now assume the underlying orientation distribution is isotropic (uniform on the unit sphere). Under this assumption and the independence of the $N$ samples, derive the sampling variance of your estimator as a function of $N$ alone.\n\nProvide your final answer as a single closed-form analytic expression in terms of $N$ only. No rounding is required. The final answer has no physical units.", "solution": "A validation of the problem statement is performed first.\n\nThe givens are extracted verbatim:\n- A suspension of rigid, axially symmetric mesogens.\n- A unit orientation vector $\\mathbf{u}$ for each molecule.\n- A fixed trial director $\\mathbf{n}$.\n- The scalar orientational order parameter $S=\\langle P_{2}(\\mathbf{u}\\cdot\\mathbf{n})\\rangle$.\n- The second Legendre polynomial is given by $P_{2}(x)=(3x^{2}-1)/2$.\n- A set of $N$ independent measurements $\\{\\mathbf{u}_{i}\\}_{i=1}^{N}$ from a stationary process.\n- $\\theta$ denotes the polar angle between $\\mathbf{u}_{i}$ and $\\mathbf{n}$.\n\nValidation Verdict:\nThe problem statement is entirely valid. It is scientifically grounded in the principles of statistical mechanics and soft matter physics, specifically the theory of liquid crystals and polymers. The definition of the order parameter $S$ is standard. The tasks are well-posed, requesting the construction and analysis of a statistical estimator, which are standard procedures in data analysis. The problem is objective, free of ambiguity, and contains all necessary information for a unique solution.\n\nWe now proceed to the solution. The problem consists of two parts.\n\nPart 1: Construction and Proof of an Unbiased Estimator for $S$.\n\nThe order parameter $S$ is defined as the ensemble average of the random variable $P_{2}(\\mathbf{u}\\cdot\\mathbf{n})$. Given a sample of $N$ independent measurements $\\{\\mathbf{u}_{i}\\}_{i=1}^{N}$, a natural estimator for an ensemble average is the corresponding sample mean. We define the estimator $\\hat{S}$ as:\n$$\n\\hat{S} = \\frac{1}{N} \\sum_{i=1}^{N} P_{2}(\\mathbf{u}_{i} \\cdot \\mathbf{n})\n$$\nTo prove that this estimator is unbiased, we must show that its expectation value, $E[\\hat{S}]$, is equal to the true order parameter $S$. The expectation is taken over the ensemble of all possible sets of $N$ measurements.\nUsing the linearity of the expectation operator, we have:\n$$\nE[\\hat{S}] = E\\left[ \\frac{1}{N} \\sum_{i=1}^{N} P_{2}(\\mathbf{u}_{i} \\cdot \\mathbf{n}) \\right] = \\frac{1}{N} \\sum_{i=1}^{N} E[P_{2}(\\mathbf{u}_{i} \\cdot \\mathbf{n})]\n$$\nThe problem states that the measurements are drawn from a stationary process. This implies that each orientation vector $\\mathbf{u}_{i}$ is drawn from the same underlying probability distribution. Therefore, the expectation value of $P_{2}(\\mathbf{u}_{i} \\cdot \\mathbf{n})$ is the same for all $i$:\n$$\nE[P_{2}(\\mathbf{u}_{i} \\cdot \\mathbf{n})] = \\langle P_{2}(\\mathbf{u} \\cdot \\mathbf{n}) \\rangle = S\n$$\nThis holds for any arbitrary, stationary orientation distribution.\nSubstituting this result back into the expression for $E[\\hat{S}]$:\n$$\nE[\\hat{S}] = \\frac{1}{N} \\sum_{i=1}^{N} S = \\frac{1}{N} (N S) = S\n$$\nSince $E[\\hat{S}] = S$, the estimator $\\hat{S}$ is proven to be unbiased for any underlying orientation distribution. By the Law of Large Numbers, this estimator is also consistent, as $\\hat{S} \\to S$ in probability as $N \\to \\infty$.\n\nPart 2: Derivation of the Sampling Variance for an Isotropic Distribution.\n\nThe sampling variance of the estimator $\\hat{S}$ is defined as $\\text{Var}(\\hat{S}) = E[(\\hat{S} - E[\\hat{S}])^{2}]$. Since $\\hat{S}$ is unbiased, this simplifies to $\\text{Var}(\\hat{S}) = E[\\hat{S}^{2}] - S^{2}$. A more direct calculation uses the properties of the variance of a sum of independent random variables.\nLet $Y_{i} = P_{2}(\\mathbf{u}_{i} \\cdot \\mathbf{n})$. Since the measurements $\\{\\mathbf{u}_{i}\\}$ are independent, the random variables $\\{Y_{i}\\}$ are independent and identically distributed.\nThe variance of the sample mean is:\n$$\n\\text{Var}(\\hat{S}) = \\text{Var}\\left(\\frac{1}{N} \\sum_{i=1}^{N} Y_{i}\\right) = \\frac{1}{N^{2}} \\sum_{i=1}^{N} \\text{Var}(Y_{i})\n$$\nSince the variables are identically distributed, $\\text{Var}(Y_{i}) = \\text{Var}(Y)$ for all $i$.\n$$\n\\text{Var}(\\hat{S}) = \\frac{1}{N^{2}} (N \\cdot \\text{Var}(Y)) = \\frac{1}{N} \\text{Var}(Y)\n$$\nThe variance of the random variable $Y = P_{2}(\\mathbf{u} \\cdot \\mathbf{n})$ is given by $\\text{Var}(Y) = \\langle Y^{2} \\rangle - \\langle Y \\rangle^{2}$. We must now evaluate these averages under the assumption of an isotropic orientation distribution.\n\nFirst, we calculate the true order parameter $S = \\langle Y \\rangle = \\langle P_{2}(\\mathbf{u} \\cdot \\mathbf{n}) \\rangle$ for an isotropic distribution. In this case, the orientation vector $\\mathbf{u}$ is uniformly distributed on the surface of the unit sphere. Let $\\theta$ be the angle between $\\mathbf{u}$ and $\\mathbf{n}$. Then $\\mathbf{u} \\cdot \\mathbf{n} = \\cos\\theta$. For a uniform distribution on the sphere, the probability density function for the angle $\\theta \\in [0, \\pi]$ is $p(\\theta) = \\frac{1}{2}\\sin\\theta$.\nThe average is calculated as follows:\n$$\nS = \\langle P_{2}(\\cos\\theta) \\rangle_{\\text{iso}} = \\int_{0}^{\\pi} P_{2}(\\cos\\theta) \\left(\\frac{1}{2}\\sin\\theta\\right) d\\theta\n$$\nLet $x = \\cos\\theta$, so $dx = -\\sin\\theta d\\theta$. The limits of integration change from $\\theta=0 \\to \\pi$ to $x=1 \\to -1$.\n$$\nS = \\frac{1}{2} \\int_{1}^{-1} P_{2}(x) (-dx) = \\frac{1}{2} \\int_{-1}^{1} P_{2}(x) dx\n$$\nThis integral can be evaluated using the orthogonality property of Legendre polynomials, $\\int_{-1}^{1} P_{m}(x) P_{n}(x) dx = \\frac{2}{2n+1}\\delta_{mn}$, where $\\delta_{mn}$ is the Kronecker delta. We can write $P_{2}(x)$ as $P_{2}(x) \\cdot P_{0}(x)$, since $P_{0}(x)=1$.\n$$\nS = \\frac{1}{2} \\int_{-1}^{1} P_{2}(x) P_{0}(x) dx = \\frac{1}{2} \\left(\\frac{2}{2(0)+1}\\right) \\delta_{20} = 0\n$$\nAs expected, the average order parameter for an isotropic system is zero. Thus, $\\langle Y \\rangle = S = 0$.\n\nNow, we calculate the second moment, $\\langle Y^{2} \\rangle = \\langle [P_{2}(\\cos\\theta)]^{2} \\rangle_{\\text{iso}}$.\n$$\n\\langle Y^{2} \\rangle = \\int_{0}^{\\pi} [P_{2}(\\cos\\theta)]^{2} \\left(\\frac{1}{2}\\sin\\theta\\right) d\\theta\n$$\nUsing the same substitution $x = \\cos\\theta$:\n$$\n\\langle Y^{2} \\rangle = \\frac{1}{2} \\int_{-1}^{1} [P_{2}(x)]^{2} dx\n$$\nWe apply the orthogonality relation with $m=n=2$:\n$$\n\\int_{-1}^{1} [P_{2}(x)]^{2} dx = \\frac{2}{2(2)+1} = \\frac{2}{5}\n$$\nTherefore, the second moment is:\n$$\n\\langle Y^{2} \\rangle = \\frac{1}{2} \\left(\\frac{2}{5}\\right) = \\frac{1}{5}\n$$\nThe variance of $Y$ is then:\n$$\n\\text{Var}(Y) = \\langle Y^{2} \\rangle - \\langle Y \\rangle^{2} = \\frac{1}{5} - 0^{2} = \\frac{1}{5}\n$$\nFinally, we substitute this result into the expression for the sampling variance of the estimator $\\hat{S}$:\n$$\n\\text{Var}(\\hat{S}) = \\frac{1}{N} \\text{Var(Y)} = \\frac{1}{N} \\left(\\frac{1}{5}\\right) = \\frac{1}{5N}\n$$\nThis is the final expression for the sampling variance of the order parameter estimator for an isotropic distribution, as a function of $N$ alone.", "answer": "$$\n\\boxed{\\frac{1}{5N}}\n$$", "id": "2933009"}, {"introduction": "The tensor nature of the order parameter provides a powerful framework for describing complex, multicomponent systems. In this conceptual practice, we explore a fascinating thought experiment: what happens when we create an ideal mixture of two distinct nematic phases, each with its own degree of order and preferred direction? By applying the principle that the macroscopic order tensor $\\mathbf{Q}$ is a volume-weighted average of its components, you will investigate how orientational order combines and discover the precise, non-intuitive conditions under which a mixture of two anisotropic phases can appear macroscopically isotropic [@problem_id:2933043].", "problem": "Consider an ideal, macroscopically homogeneous mixture of two uniaxial nematic phases of rod-like or disk-like mesogens at thermal equilibrium. Component $1$ occupies volume fraction $\\phi \\in [0,1]$ and has a uniform director $\\mathbf{n}_{1}$ with scalar orientational order parameter $S_{1}$; component $2$ occupies volume fraction $1-\\phi$ and has a uniform director $\\mathbf{n}_{2}$ with scalar orientational order parameter $S_{2}$. The macroscopic orientational order of the mixture is characterized by the second-rank, symmetric, traceless tensor $\\mathbf{Q}$ defined, for an orientational distribution $f(\\mathbf{u})$ on the unit sphere, by the standard relation\n$$\n\\mathbf{Q} \\equiv \\left\\langle \\frac{3}{2}\\left(\\mathbf{u}\\mathbf{u}-\\frac{\\mathbf{I}}{3}\\right)\\right\\rangle,\n$$\nwhere $\\langle \\cdot \\rangle$ denotes an average with respect to $f(\\mathbf{u})$, $\\mathbf{u}$ is a unit vector along the molecular axis, and $\\mathbf{I}$ is the identity tensor. In a uniaxial monodomain with director $\\mathbf{n}$ and scalar order parameter $S=\\langle P_{2}(\\mathbf{u}\\cdot \\mathbf{n})\\rangle$, where $P_{2}(x)=(3x^{2}-1)/2$ is the second Legendre polynomial, the orientational order tensor takes the uniaxial form\n$$\n\\mathbf{Q}=\\frac{3}{2}S\\left(\\mathbf{n}\\mathbf{n}-\\frac{\\mathbf{I}}{3}\\right).\n$$\nAssume the mixture is ideal in the sense that its orientational distribution is the volume-fraction-weighted sum of the component distributions, so that the mixture’s macroscopic orientational order tensor is the volume-weighted average of the component tensors, namely\n$$\n\\mathbf{Q}(\\phi)=\\phi\\,\\mathbf{Q}_{1}+(1-\\phi)\\,\\mathbf{Q}_{2}.\n$$\nStarting from these definitions and without invoking any unproven shortcuts, do the following:\n- Derive an explicit expression for $\\mathbf{Q}(\\phi)$ in terms of $\\phi$, $S_{1}$, $S_{2}$, $\\mathbf{n}_{1}$, and $\\mathbf{n}_{2}$.\n- By analyzing the resulting tensor structure, determine the necessary and sufficient conditions on $\\phi$, $S_{1}$, $S_{2}$, and the relative orientation of $\\mathbf{n}_{1}$ and $\\mathbf{n}_{2}$ under which the mixture appears macroscopically isotropic, i.e., $\\mathbf{Q}(\\phi)=\\mathbf{0}$.\n- Report, as your final answer, the unique volume fraction $\\phi^{\\ast}$ (dimensionless) that yields $\\mathbf{Q}(\\phi^{\\ast})=\\mathbf{0}$ in the only nontrivial admissible case you identify.\n\nYour final reported $\\phi^{\\ast}$ must be given as a closed-form symbolic expression in terms of $S_{1}$ and $S_{2}$. No numerical rounding is required. Angles, if introduced as intermediate variables, may be expressed in radians or through scalar products, but the final answer must not contain angles.", "solution": "The problem statement is first subjected to validation.\n\nStep 1: Extract Givens\n- A mixture of two uniaxial nematic phases, component $1$ and component $2$.\n- Component $1$: volume fraction $\\phi \\in [0,1]$, director $\\mathbf{n}_{1}$, scalar order parameter $S_{1}$.\n- Component $2$: volume fraction $1-\\phi$, director $\\mathbf{n}_{2}$, scalar order parameter $S_{2}$.\n- Definition of the macroscopic orientational order tensor: $\\mathbf{Q} \\equiv \\left\\langle \\frac{3}{2}\\left(\\mathbf{u}\\mathbf{u}-\\frac{\\mathbf{I}}{3}\\right)\\right\\rangle$.\n- Uniaxial form of the order tensor: $\\mathbf{Q}=\\frac{3}{2}S\\left(\\mathbf{n}\\mathbf{n}-\\frac{\\mathbf{I}}{3}\\right)$ for a single component with director $\\mathbf{n}$ and order parameter $S$.\n- Ideal mixture model: $\\mathbf{Q}(\\phi)=\\phi\\,\\mathbf{Q}_{1}+(1-\\phi)\\,\\mathbf{Q}_{2}$.\n\nStep 2: Validate Using Extracted Givens\nThe problem is scientifically grounded, employing standard definitions from the theory of liquid crystals and soft matter physics. The concepts of the order parameter tensor $\\mathbf{Q}$, scalar order parameter $S$, and nematic director $\\mathbf{n}$ are fundamental. The model of an ideal mixture via a volume-weighted average of component tensors is a valid and common theoretical construct. The problem is well-posed, providing sufficient information to derive the requested expression and analyze the conditions. The language is objective and mathematically precise. The problem does not violate any of the invalidity criteria.\n\nStep 3: Verdict and Action\nThe problem is deemed valid. A full, reasoned solution will be provided.\n\nThe task is to derive the expression for the mixture's order tensor $\\mathbf{Q}(\\phi)$, determine the conditions under which the mixture is macroscopically isotropic ($\\mathbf{Q}(\\phi) = \\mathbf{0}$), and find the volume fraction $\\phi^{\\ast}$ for the nontrivial case.\n\nFirst, an explicit expression for $\\mathbf{Q}(\\phi)$ is derived. The order tensors for component $1$ and component $2$ are given by the uniaxial form:\n$$\n\\mathbf{Q}_{1} = \\frac{3}{2} S_{1} \\left( \\mathbf{n}_{1}\\mathbf{n}_{1} - \\frac{\\mathbf{I}}{3} \\right)\n$$\n$$\n\\mathbf{Q}_{2} = \\frac{3}{2} S_{2} \\left( \\mathbf{n}_{2}\\mathbf{n}_{2} - \\frac{\\mathbf{I}}{3} \\right)\n$$\nThe order tensor for the mixture is the volume-weighted average:\n$$\n\\mathbf{Q}(\\phi) = \\phi \\mathbf{Q}_{1} + (1-\\phi) \\mathbf{Q}_{2}\n$$\nSubstituting the expressions for $\\mathbf{Q}_{1}$ and $\\mathbf{Q}_{2}$:\n$$\n\\mathbf{Q}(\\phi) = \\phi \\left[ \\frac{3}{2} S_{1} \\left( \\mathbf{n}_{1}\\mathbf{n}_{1} - \\frac{\\mathbf{I}}{3} \\right) \\right] + (1-\\phi) \\left[ \\frac{3}{2} S_{2} \\left( \\mathbf{n}_{2}\\mathbf{n}_{2} - \\frac{\\mathbf{I}}{3} \\right) \\right]\n$$\nThis is the explicit expression for $\\mathbf{Q}(\\phi)$ in terms of the given parameters. It can be rearranged by collecting terms involving the identity tensor $\\mathbf{I}$:\n$$\n\\mathbf{Q}(\\phi) = \\frac{3}{2} \\left[ \\phi S_{1} \\mathbf{n}_{1}\\mathbf{n}_{1} + (1-\\phi) S_{2} \\mathbf{n}_{2}\\mathbf{n}_{2} \\right] - \\frac{1}{2} \\left[ \\phi S_{1} + (1-\\phi) S_{2} \\right] \\mathbf{I}\n$$\nThis tensor is symmetric and, by its construction from traceless components $\\mathbf{Q}_{1}$ and $\\mathbf{Q}_{2}$, is itself traceless, as required.\n\nNext, we establish the necessary and sufficient conditions for the mixture to be macroscopically isotropic, which corresponds to $\\mathbf{Q}(\\phi) = \\mathbf{0}$. Setting the expression for $\\mathbf{Q}(\\phi)$ to the zero tensor $\\mathbf{0}$ yields:\n$$\n\\phi S_{1} \\left( \\mathbf{n}_{1}\\mathbf{n}_{1} - \\frac{\\mathbf{I}}{3} \\right) + (1-\\phi) S_{2} \\left( \\mathbf{n}_{2}\\mathbf{n}_{2} - \\frac{\\mathbf{I}}{3} \\right) = \\mathbf{0}\n$$\nRearranging this tensor equation gives:\n$$\n\\phi S_{1} \\mathbf{n}_{1}\\mathbf{n}_{1} + (1-\\phi) S_{2} \\mathbf{n}_{2}\\mathbf{n}_{2} = \\left[ \\frac{1}{3} \\left( \\phi S_{1} + (1-\\phi) S_{2} \\right) \\right] \\mathbf{I}\n$$\nLet the tensor on the left-hand side be $\\mathbf{T} \\equiv \\phi S_{1} \\mathbf{n}_{1}\\mathbf{n}_{1} + (1-\\phi) S_{2} \\mathbf{n}_{2}\\mathbf{n}_{2}$. The equation states that $\\mathbf{T}$ must be proportional to the identity tensor $\\mathbf{I}$. Let $\\mathbf{v}$ be a unit vector orthogonal to the plane spanned by $\\mathbf{n}_{1}$ and $\\mathbf{n}_{2}$ (if they are not collinear). Then $\\mathbf{v} \\cdot \\mathbf{n}_{1} = 0$ and $\\mathbf{v} \\cdot \\mathbf{n}_{2} = 0$. Applying $\\mathbf{T}$ to $\\mathbf{v}$ gives:\n$$\n\\mathbf{T}\\mathbf{v} = \\phi S_{1} \\mathbf{n}_{1} (\\mathbf{n}_{1} \\cdot \\mathbf{v}) + (1-\\phi) S_{2} \\mathbf{n}_{2} (\\mathbf{n}_{2} \\cdot \\mathbf{v}) = \\phi S_{1} \\mathbf{n}_{1} (0) + (1-\\phi) S_{2} \\mathbf{n}_{2} (0) = \\mathbf{0}\n$$\nThus, $\\mathbf{v}$ is an eigenvector of $\\mathbf{T}$ with an eigenvalue of $0$. If $\\mathbf{T}$ is to be proportional to $\\mathbf{I}$, all its eigenvalues must be identical. Therefore, all eigenvalues of $\\mathbf{T}$ must be $0$, which implies that $\\mathbf{T}$ must be the zero tensor, $\\mathbf{T} = \\mathbf{0}$.\nConsequently, the condition for isotropy simplifies to two simultaneous equations:\n$$\n(1) \\qquad \\phi S_{1} \\mathbf{n}_{1}\\mathbf{n}_{1} + (1-\\phi) S_{2} \\mathbf{n}_{2}\\mathbf{n}_{2} = \\mathbf{0}\n$$\n$$\n(2) \\qquad \\phi S_{1} + (1-\\phi) S_{2} = 0\n$$\nNote that condition ($2$) is the trace of condition ($1$), as $\\mathrm{Tr}(\\mathbf{n}\\mathbf{n})=1$, so it is automatically satisfied if ($1$) holds. We therefore need only solve condition ($1$).\n\nTrivial solutions exist if $S_{1}=0$ and $S_{2}=0$, or if $\\phi=0$ and $S_{2}=0$, or if $\\phi=1$ and $S_{1}=0$. The problem requires the analysis of the nontrivial case, where we assume $S_{1} \\neq 0$, $S_{2} \\neq 0$, and $\\phi \\in (0,1)$.\nFrom equation ($1$), let us right-multiply by the vector $\\mathbf{n}_{1}$:\n$$\n\\phi S_{1} \\mathbf{n}_{1}(\\mathbf{n}_{1} \\cdot \\mathbf{n}_{1}) + (1-\\phi) S_{2} \\mathbf{n}_{2}(\\mathbf{n}_{2} \\cdot \\mathbf{n}_{1}) = \\mathbf{0}\n$$\nSince $\\mathbf{n}_{1}$ is a unit vector, $\\mathbf{n}_{1} \\cdot \\mathbf{n}_{1} = 1$. This simplifies to:\n$$\n\\phi S_{1} \\mathbf{n}_{1} + (1-\\phi) S_{2} (\\mathbf{n}_{1} \\cdot \\mathbf{n}_{2}) \\mathbf{n}_{2} = \\mathbf{0}\n$$\nIf the directors $\\mathbf{n}_{1}$ and $\\mathbf{n}_{2}$ are linearly independent (i.e., not collinear), then the scalar coefficients of both vectors must be zero. This would imply $\\phi S_{1}=0$ and $(1-\\phi) S_{2} (\\mathbf{n}_{1} \\cdot \\mathbf{n}_{2})=0$. Since we assume a nontrivial case ($\\phi \\in (0,1), S_{1} \\neq 0$), $\\phi S_{1} \\neq 0$. This leads to a contradiction. Therefore, $\\mathbf{n}_{1}$ and $\\mathbf{n}_{2}$ must be linearly dependent. As they are unit vectors, they must be collinear, i.e., $\\mathbf{n}_{1} = \\pm \\mathbf{n}_{2}$. Since the nematic order is apolar, $\\mathbf{n}$ and $-\\mathbf{n}$ describe the same physical state, so we can set $\\mathbf{n}_{1} = \\mathbf{n}_{2}$.\n\nWith collinear directors, condition ($1$) becomes:\n$$\n\\left[ \\phi S_{1} + (1-\\phi) S_{2} \\right] \\mathbf{n}_{1}\\mathbf{n}_{1} = \\mathbf{0}\n$$\nSince $\\mathbf{n}_{1}\\mathbf{n}_{1}$ is not the zero tensor, the scalar prefactor must be zero, which is exactly condition ($2$):\n$$\n\\phi S_{1} + (1-\\phi) S_{2} = 0\n$$\nThis is the necessary condition for the only nontrivial case. For a solution $\\phi \\in (0,1)$ to exist, $S_{1}$ and $S_{2}$ must have opposite signs. For example, one component consists of rod-like mesogens ($S_{1}0$) and the other of disk-like mesogens ($S_{2}0$).\n\nFinally, we solve for the volume fraction, denoted $\\phi^{\\ast}$, that satisfies this condition:\n$$\n\\phi^{\\ast} S_{1} + S_{2} - \\phi^{\\ast} S_{2} = 0\n$$\n$$\n\\phi^{\\ast} (S_{1} - S_{2}) = -S_{2}\n$$\n$$\n\\phi^{\\ast} = \\frac{-S_{2}}{S_{1} - S_{2}} = \\frac{S_{2}}{S_{2} - S_{1}}\n$$\nThis expression provides the unique volume fraction for the nontrivial case where the mixture becomes macroscopically isotropic. It is admissible, i.e., $0  \\phi^{\\ast}  1$, if and only if $S_{1}$ and $S_{2}$ have opposite signs and are both non-zero. This constitutes the complete identification of the only nontrivial admissible case.", "answer": "$$\\boxed{\\frac{S_{2}}{S_{2} - S_{1}}}$$", "id": "2933043"}]}