{"hands_on_practices": [{"introduction": "The scalar nematic order parameter, $S$, is the fundamental quantity in the Maier-Saupe theory, serving as a statistical measure of the collective molecular alignment. Before delving into the complexities of ordered phases, it is crucial to verify that this mathematical construct aligns with our physical intuition for the most basic state: a completely random, isotropic fluid. This foundational exercise reinforces the definition of the order parameter by guiding you through an explicit calculation to show that $S=0$ for an isotropic system. [@problem_id:2920250]", "problem": "In the Maier–Saupe mean-field description of the nematic–isotropic transition, the scalar nematic order parameter is defined as the ensemble average of the second Legendre polynomial of the cosine of the angle between a molecule’s symmetry axis and the macroscopic director. Consider an orientational distribution function on the unit sphere, denoted by $f(\\theta,\\phi)$, normalized according to\n$$\n\\int_{0}^{2\\pi}\\int_{0}^{\\pi} f(\\theta,\\phi)\\,\\sin\\theta\\,\\mathrm{d}\\theta\\,\\mathrm{d}\\phi \\;=\\; 1,\n$$\nwhere $\\theta$ is the polar angle measured in radians and $\\phi$ is the azimuthal angle. The scalar orientational order parameter is defined by\n$$\nS \\;=\\; \\int_{0}^{2\\pi}\\int_{0}^{\\pi} P_{2}(\\cos\\theta)\\, f(\\theta,\\phi)\\,\\sin\\theta\\,\\mathrm{d}\\theta\\,\\mathrm{d}\\phi,\n$$\nwhere $P_{2}(x)$ is the Legendre polynomial of degree $2$.\n\nAssume an isotropic state described by a uniform orientational distribution $f(\\theta,\\phi)=\\frac{1}{4\\pi}$. Starting from the above definitions and the standard spherical surface element, compute $S$ explicitly. The order parameter $S$ is dimensionless; express your final answer as an exact number (no rounding required).", "solution": "The problem is subjected to validation.\n\n**Step 1: Extract Givens**\n- Normalization of the orientational distribution function: $\\int_{0}^{2\\pi}\\int_{0}^{\\pi} f(\\theta,\\phi)\\,\\sin\\theta\\,\\mathrm{d}\\theta\\,\\mathrm{d}\\phi = 1$.\n- Definition of the scalar orientational order parameter: $S = \\int_{0}^{2\\pi}\\int_{0}^{\\pi} P_{2}(\\cos\\theta)\\, f(\\theta,\\phi)\\,\\sin\\theta\\,\\mathrm{d}\\theta\\,\\mathrm{d}\\phi$.\n- Where $P_{2}(x)$ is the Legendre polynomial of degree $2$.\n- The system is in an isotropic state.\n- The orientational distribution for the isotropic state is given as $f(\\theta,\\phi) = \\frac{1}{4\\pi}$.\n- The task is to compute $S$ explicitly for this distribution.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is scientifically grounded, well-posed, and objective. It presents a standard calculation in the statistical mechanics of soft matter, specifically within the context of the Maier-Saupe theory for liquid crystals. The definitions provided for the order parameter $S$ and the normalization condition are correct. The given distribution function $f(\\theta,\\phi) = \\frac{1}{4\\pi}$ is the correct mathematical representation of a perfectly isotropic (randomly oriented) system, and it is properly normalized over the unit sphere. The problem is self-contained and free of contradictions, ambiguity, or factual errors. All required information is present, and the task is to perform a definite integration, which leads to a unique, meaningful result.\n\n**Verdict:** The problem is valid.\n\nWe proceed with the solution. The scalar orientational order parameter $S$ is defined as the ensemble average of the second Legendre polynomial $P_{2}(\\cos\\theta)$. The formula is given by:\n$$\nS \\;=\\; \\int_{0}^{2\\pi}\\int_{0}^{\\pi} P_{2}(\\cos\\theta)\\, f(\\theta,\\phi)\\,\\sin\\theta\\,\\mathrm{d}\\theta\\,\\mathrm{d}\\phi\n$$\nFor the specified isotropic state, the orientational distribution function is uniform:\n$$\nf(\\theta,\\phi) = \\frac{1}{4\\pi}\n$$\nSubstituting this into the definition of $S$, we obtain:\n$$\nS \\;=\\; \\int_{0}^{2\\pi}\\int_{0}^{\\pi} P_{2}(\\cos\\theta)\\, \\left(\\frac{1}{4\\pi}\\right)\\,\\sin\\theta\\,\\mathrm{d}\\theta\\,\\mathrm{d}\\phi\n$$\nThe constant factor $\\frac{1}{4\\pi}$ can be moved outside the integral. The integrand, $P_{2}(\\cos\\theta)\\sin\\theta$, does not depend on the azimuthal angle $\\phi$. Therefore, the double integral can be separated into a product of two single-variable integrals:\n$$\nS \\;=\\; \\frac{1}{4\\pi} \\left( \\int_{0}^{2\\pi} \\mathrm{d}\\phi \\right) \\left( \\int_{0}^{\\pi} P_{2}(\\cos\\theta)\\,\\sin\\theta\\,\\mathrm{d}\\theta \\right)\n$$\nThe integral over $\\phi$ is straightforward:\n$$\n\\int_{0}^{2\\pi} \\mathrm{d}\\phi \\;=\\; [\\phi]_{0}^{2\\pi} \\;=\\; 2\\pi - 0 \\;=\\; 2\\pi\n$$\nSubstituting this result back, the expression for $S$ simplifies to:\n$$\nS \\;=\\; \\frac{2\\pi}{4\\pi} \\int_{0}^{\\pi} P_{2}(\\cos\\theta)\\,\\sin\\theta\\,\\mathrm{d}\\theta \\;=\\; \\frac{1}{2} \\int_{0}^{\\pi} P_{2}(\\cos\\theta)\\,\\sin\\theta\\,\\mathrm{d}\\theta\n$$\nTo evaluate the remaining integral, we must use the explicit form of the Legendre polynomial of degree $2$, which is:\n$$\nP_{2}(x) = \\frac{1}{2}(3x^{2} - 1)\n$$\nThus, for $x = \\cos\\theta$, we have:\n$$\nP_{2}(\\cos\\theta) = \\frac{1}{2}(3\\cos^{2}\\theta - 1)\n$$\nThe integral for $S$ becomes:\n$$\nS \\;=\\; \\frac{1}{2} \\int_{0}^{\\pi} \\frac{1}{2}(3\\cos^{2}\\theta - 1)\\,\\sin\\theta\\,\\mathrm{d}\\theta \\;=\\; \\frac{1}{4} \\int_{0}^{\\pi} (3\\cos^{2}\\theta - 1)\\,\\sin\\theta\\,\\mathrm{d}\\theta\n$$\nWe perform a substitution to solve this integral. Let $u = \\cos\\theta$. The differential is $\\mathrm{d}u = -\\sin\\theta\\,\\mathrm{d}\\theta$. We must also change the limits of integration. When $\\theta = 0$, $u = \\cos(0) = 1$. When $\\theta = \\pi$, $u = \\cos(\\pi) = -1$.\nSubstituting $u$ and $\\mathrm{d}u$ into the integral:\n$$\nS \\;=\\; \\frac{1}{4} \\int_{1}^{-1} (3u^{2} - 1)\\,(-\\mathrm{d}u)\n$$\nUsing the property of definite integrals $\\int_{a}^{b} g(u)\\,\\mathrm{d}u = -\\int_{b}^{a} g(u)\\,\\mathrm{d}u$, we reverse the limits of integration, which cancels the negative sign:\n$$\nS \\;=\\; \\frac{1}{4} \\int_{-1}^{1} (3u^{2} - 1)\\,\\mathrm{d}u\n$$\nNow, we compute the antiderivative of the polynomial $(3u^{2} - 1)$:\n$$\n\\int (3u^{2} - 1)\\,\\mathrm{d}u \\;=\\; 3\\frac{u^{3}}{3} - u \\;=\\; u^{3} - u\n$$\nEvaluating the definite integral from $-1$ to $1$:\n$$\nS \\;=\\; \\frac{1}{4} \\left[ u^{3} - u \\right]_{-1}^{1} \\;=\\; \\frac{1}{4} \\left( (1^{3} - 1) - ((-1)^{3} - (-1)) \\right)\n$$\n$$\nS \\;=\\; \\frac{1}{4} \\left( (1 - 1) - (-1 + 1) \\right) \\;=\\; \\frac{1}{4} (0 - 0) \\;=\\; 0\n$$\nThe result is exactly $0$. This outcome is fundamental: the scalar order parameter $S$ quantifies the degree of collective orientational order. A value of $S=0$ signifies a complete lack of average orientation, which is the definition of an isotropic state.\n\nAlternatively, the result can be obtained more elegantly by invoking the orthogonality property of Legendre polynomials, which states:\n$$\n\\int_{-1}^{1} P_{n}(x)P_{m}(x)\\,\\mathrm{d}x \\;=\\; \\frac{2}{2n+1}\\delta_{nm}\n$$\nwhere $\\delta_{nm}$ is the Kronecker delta. Our integral for $S$ can be written as $S = \\frac{1}{2} \\int_{-1}^{1} P_{2}(u)\\,\\mathrm{d}u$. Recognizing that the constant function $1$ is the zeroth Legendre polynomial, $P_{0}(u)=1$, the integral is:\n$$\nS \\;=\\; \\frac{1}{2}\\int_{-1}^{1} P_{2}(u)P_{0}(u)\\,\\mathrm{d}u\n$$\nHere, $n=2$ and $m=0$. Since $n \\neq m$, the Kronecker delta $\\delta_{20} = 0$, and thus the integral is zero. This confirms our explicit calculation.", "answer": "$$\n\\boxed{0}\n$$", "id": "2920250"}, {"introduction": "A key triumph of the Maier-Saupe theory is its ability to describe the temperature-driven phase transition from a disordered isotropic liquid to an ordered nematic liquid crystal. This phenomenon emerges from a self-consistent mechanism where molecular alignment generates a mean field, which in turn reinforces further alignment. This practice directs you through the pivotal derivation of the bifurcation temperature, $T^{\\ast}$, where a non-zero ordered solution first becomes possible, by linearizing the model's central self-consistency equation. [@problem_id:2945027]", "problem": "A uniaxial apolar nematic fluid is modeled at the mean-field level by a single-particle orientational potential $U(\\theta)=-\\lambda S P_{2}(\\cos\\theta)$, where $S$ is the scalar order parameter, $\\lambda>0$ is a temperature-independent coupling constant with units of energy, $P_{2}(\\cos\\theta)$ is the second Legendre polynomial, and $\\theta$ is the polar angle (measured in radians) between a molecular axis and the director. The orientational probability density is $f(\\theta,\\phi)=Z^{-1}\\exp(-\\beta U(\\theta))$ with $\\beta=1/(k_{B}T)$, $k_{B}$ the Boltzmann constant, $T$ the absolute temperature, and $Z$ the normalization such that $\\int f(\\theta,\\phi)\\,d\\Omega=1$, where $d\\Omega=\\sin\\theta\\,d\\theta\\,d\\phi$. The scalar order parameter is defined by the thermal average $S=\\langle P_{2}(\\cos\\theta)\\rangle=\\int P_{2}(\\cos\\theta) f(\\theta,\\phi)\\,d\\Omega$.\n\nStarting only from these definitions and general properties of angular integration on the unit sphere, do the following:\n\n1. Write the exact self-consistency relation for $S$ as a ratio of angular integrals over the unit sphere.\n2. Linearize this relation for small $S$ to determine the mean-field bifurcation temperature $T^{\\ast}$ at which a nonzero solution for $S$ first appears upon lowering $T$ from high temperature.\n3. In your derivation, explicitly evaluate the required angular averages of $P_{2}(\\cos\\theta)$ and $P_{2}^{2}(\\cos\\theta)$ over the unit sphere and identify the origin of the numerical factor that controls $T^{\\ast}$.\n\nExpress your final answer for $T^{\\ast}$ as a single closed-form analytic expression in terms of $\\lambda$ and $k_{B}$. Do not provide any numerical evaluation or units in your final answer.", "solution": "The user-provided problem statement has been evaluated and is determined to be valid. It is scientifically grounded in the established mean-field theory of liquid crystals (specifically, the Maier-Saupe model), is well-posed, and is formulated with objective, unambiguous language. All necessary information for a rigorous derivation is provided. We will proceed with the solution.\n\nThe problem requires the derivation of the mean-field bifurcation temperature, $T^{\\ast}$, for the nematic-isotropic phase transition. This will be accomplished in three stages as requested: first, by establishing the self-consistency relation for the scalar order parameter $S$; second, by linearizing this relation for small $S$; and third, by explicitly evaluating the necessary angular averages that appear in the linearized equation.\n\n**1. The Self-Consistency Relation for $S$**\n\nThe scalar order parameter, $S$, is defined as the thermal average of the second Legendre polynomial, $P_{2}(\\cos\\theta)$:\n$$\nS = \\langle P_{2}(\\cos\\theta) \\rangle = \\int P_{2}(\\cos\\theta) f(\\theta,\\phi) \\, d\\Omega\n$$\nThe orientational probability density function is given by $f(\\theta,\\phi) = Z^{-1}\\exp(-\\beta U(\\theta))$, where $\\beta = 1/(k_{B}T)$ and the orientational potential is $U(\\theta) = -\\lambda S P_{2}(\\cos\\theta)$. The normalization constant, or partition function, $Z$, is defined by the condition $\\int f(\\theta,\\phi) \\, d\\Omega = 1$, which implies:\n$$\nZ = \\int \\exp(-\\beta U(\\theta)) \\, d\\Omega = \\int \\exp(\\beta \\lambda S P_{2}(\\cos\\theta)) \\, d\\Omega\n$$\nSubstituting these expressions into the definition of $S$ yields the self-consistency relation:\n$$\nS = \\frac{\\int P_{2}(\\cos\\theta) \\exp(\\beta \\lambda S P_{2}(\\cos\\theta)) \\, d\\Omega}{\\int \\exp(\\beta \\lambda S P_{2}(\\cos\\theta)) \\, d\\Omega}\n$$\nThe volume element on the unit sphere is $d\\Omega = \\sin\\theta \\, d\\theta \\, d\\phi$, where the polar angle $\\theta$ ranges from $0$ to $\\pi$ and the azimuthal angle $\\phi$ ranges from $0$ to $2\\pi$. Since the integrand is independent of $\\phi$, the integration over $\\phi$ yields a factor of $2\\pi$ which cancels between the numerator and the denominator. We introduce the variable substitution $x = \\cos\\theta$, which implies $dx = -\\sin\\theta \\, d\\theta$. The integration limits for $x$ become $x=1$ (for $\\theta=0$) and $x=-1$ (for $\\theta=\\pi$). Therefore, $\\int_{0}^{\\pi} \\dots \\sin\\theta \\, d\\theta$ becomes $\\int_{-1}^{1} \\dots dx$.\n\nThe exact self-consistency relation for $S$ is thus given as a ratio of integrals over the variable $x$:\n$$\nS = \\frac{\\int_{-1}^{1} P_{2}(x) \\exp(\\beta \\lambda S P_{2}(x)) \\, dx}{\\int_{-1}^{1} \\exp(\\beta \\lambda S P_{2}(x)) \\, dx}\n$$\nThis is the required expression for the first part of the problem.\n\n**2. Linearization and the Bifurcation Temperature $T^{\\ast}$**\n\nThe bifurcation temperature $T^{\\ast}$ is the critical temperature at which a non-zero solution for $S$ first becomes possible as the system is cooled from the high-temperature isotropic phase (where $S=0$). Near this transition, $S$ is infinitesimally small. This allows us to linearize the self-consistency relation with respect to $S$.\n\nFor small $S$, the argument of the exponential, $\\beta \\lambda S P_{2}(x)$, is also small. We can use the Taylor series expansion $\\exp(y) \\approx 1 + y$ for small $y$.\nApplying this expansion to the numerator and denominator of the self-consistency relation:\nNumerator:\n$$\n\\int_{-1}^{1} P_{2}(x) \\left[ 1 + \\beta \\lambda S P_{2}(x) + \\mathcal{O}(S^{2}) \\right] \\, dx = \\int_{-1}^{1} P_{2}(x) \\, dx + \\beta \\lambda S \\int_{-1}^{1} [P_{2}(x)]^{2} \\, dx + \\mathcal{O}(S^{2})\n$$\nDenominator:\n$$\n\\int_{-1}^{1} \\left[ 1 + \\beta \\lambda S P_{2}(x) + \\mathcal{O}(S^{2}) \\right] \\, dx = \\int_{-1}^{1} 1 \\, dx + \\beta \\lambda S \\int_{-1}^{1} P_{2}(x) \\, dx + \\mathcal{O}(S^{2})\n$$\nThe linearized equation for $S$ becomes:\n$$\nS \\approx \\frac{\\int_{-1}^{1} P_{2}(x) \\, dx + \\beta \\lambda S \\int_{-1}^{1} [P_{2}(x)]^{2} \\, dx}{\\int_{-1}^{1} 1 \\, dx + \\beta \\lambda S \\int_{-1}^{1} P_{2}(x) \\, dx}\n$$\n\n**3. Evaluation of Angular Averages**\n\nWe now explicitly evaluate the required integrals. These correspond to averages over the isotropic distribution, where all orientations are equally probable. The average of a quantity $A(\\theta)$ over the unit sphere is $\\langle A \\rangle_{0} = (\\int A \\, d\\Omega) / (\\int d\\Omega)$.\nThe total solid angle of a sphere is $\\int d\\Omega = \\int_{0}^{2\\pi}d\\phi \\int_{0}^{\\pi} \\sin\\theta \\, d\\theta = 4\\pi$.\n\nThe first integral, $\\int_{-1}^{1} P_{2}(x) \\, dx$, corresponds to the un-normalized average of $P_{2}(\\cos\\theta)$. Using the orthogonality property of Legendre polynomials, $\\int_{-1}^{1} P_{l}(x) P_{m}(x) \\, dx = \\frac{2}{2l+1} \\delta_{lm}$, we can evaluate this integral by setting $l=2$ and $m=0$ (since $P_{0}(x)=1$):\n$$\n\\int_{-1}^{1} P_{2}(x) \\, dx = \\int_{-1}^{1} P_{2}(x) P_{0}(x) \\, dx = 0\n$$\nThe average of $P_{2}(\\cos\\theta)$ over the sphere is therefore $\\langle P_{2}(\\cos\\theta) \\rangle_{0} = \\frac{2\\pi \\int_{-1}^{1} P_{2}(x) \\, dx}{4\\pi} = 0$.\n\nThe second integral is $\\int_{-1}^{1} 1 \\, dx = [x]_{-1}^{1} = 2$.\n\nThe third integral is $\\int_{-1}^{1} [P_{2}(x)]^{2} \\, dx$. Using the orthogonality relation with $l=m=2$:\n$$\n\\int_{-1}^{1} [P_{2}(x)]^{2} \\, dx = \\frac{2}{2(2)+1} = \\frac{2}{5}\n$$\nThe mean-square average of $P_{2}(\\cos\\theta)$ over the sphere is $\\langle P_{2}^{2}(\\cos\\theta) \\rangle_{0} = \\frac{2\\pi \\int_{-1}^{1} [P_{2}(x)]^{2} \\, dx}{4\\pi} = \\frac{1}{2} \\left( \\frac{2}{5} \\right) = \\frac{1}{5}$. The numerical factor that will control $T^{\\ast}$ originates from this average.\n\nSubstituting these integral values back into the linearized equation for $S$:\n$$\nS \\approx \\frac{0 + \\beta \\lambda S \\left(\\frac{2}{5}\\right)}{2 + \\beta \\lambda S (0)} = \\frac{\\beta \\lambda S}{5}\n$$\nFor a non-trivial solution ($S \\neq 0$) to exist, we can divide by $S$. The bifurcation occurs when this equality holds. We set the temperature $T$ to the critical temperature $T^{\\ast}$, and correspondingly $\\beta$ to $\\beta^{\\ast} = 1/(k_{B}T^{\\ast})$.\n$$\n1 = \\frac{\\beta^{\\ast} \\lambda}{5} = \\frac{\\lambda}{5 k_{B} T^{\\ast}}\n$$\nSolving for the bifurcation temperature $T^{\\ast}$ gives:\n$$\nT^{\\ast} = \\frac{\\lambda}{5 k_{B}}\n$$\nThis is the mean-field prediction for the temperature at which the isotropic phase becomes unstable with respect to the formation of a nematic phase.", "answer": "$$\n\\boxed{\\frac{\\lambda}{5 k_{B}}}\n$$", "id": "2945027"}, {"introduction": "While analytical methods provide invaluable insight in specific limits, such as near the phase transition, exploring the full behavior of the Maier-Saupe model requires computational tools. To understand the system's properties away from these limits, we must solve the theory's integral equations numerically. This hands-on coding practice challenges you to translate theory into a functional algorithm, using high-accuracy Gauss-Legendre quadrature to compute the partition function $Z$ and order parameter $S$ for any given mean-field strength. [@problem_id:2920228]", "problem": "You are to implement a numerical evaluator for the orientational partition function and the nematic order parameter that arise in the Maier–Saupe mean-field description of the nematic–isotropic transition in polymers and soft matter. Start from the Boltzmann statistical weight for an axisymmetric one-body mean-field potential that is proportional to the second Legendre polynomial. Use the following fundamental principles and definitions:\n\n- The Boltzmann distribution assigns weight proportional to $\\exp\\!\\left(-\\beta U\\right)$ for energy $U$. In the Maier–Saupe mean-field, the one-body potential is proportional to the second Legendre polynomial $P_{2}(\\mu)$, where $P_{2}(\\mu) = \\tfrac{1}{2}\\left(3\\mu^{2}-1\\right)$ and $\\mu = \\cos\\theta$ is the cosine of the polar angle.\n- Introduce a dimensionless field parameter $\\lambda$ proportional to the mean-field strength divided by thermal energy, so that the unnormalized orientational weight is $\\exp\\!\\left(\\lambda P_{2}(\\mu)\\right)$.\n- The dimensionless partition function $Z(\\lambda)$ over the unit sphere reduces, after integrating over the azimuthal angle, to an integral over the interval $\\mu \\in [-1,1]$.\n- The nematic order parameter $S(\\lambda)$ is the statistical expectation of $P_{2}(\\mu)$ with respect to the normalized distribution obtained from the above Boltzmann weight.\n\nYour tasks are:\n\n1) Derive from the above principles explicit integral expressions for $Z(\\lambda)$ and $S(\\lambda)$ as integrals over $\\mu \\in [-1,1]$ involving only $\\lambda$ and $P_{2}(\\mu)$. Your derivation must be logically consistent and should not introduce any assumptions beyond those stated.\n\n2) Implement a Gauss–Legendre quadrature on $[-1,1]$ to evaluate $Z(\\lambda)$ and $S(\\lambda)$ to high accuracy. Your algorithm must:\n- Use $N$-point Gauss–Legendre quadrature with $N$ increased adaptively (for example, by doubling) until both $Z(\\lambda)$ and $S(\\lambda)$ are converged to within an absolute change no larger than $10^{-13}$, or until a clearly defined maximum $N$ is reached.\n- Use only a single spatial variable $\\mu$; you must not convert to angular variables beyond $\\mu = \\cos\\theta$. There are no physical units; all quantities are dimensionless.\n\n3) Verify the normalization to machine precision by performing an independent Gauss–Legendre integration (with a quadrature order strictly different from the one used to compute $Z(\\lambda)$ and $S(\\lambda)$) of the normalized distribution $f(\\mu \\,|\\, \\lambda)$ over $\\mu \\in [-1,1]$. Report the absolute deviation $\\varepsilon(\\lambda) = \\left|\\int_{-1}^{1} f(\\mu \\,|\\, \\lambda)\\,d\\mu - 1\\right|$.\n\nTest Suite:\nEvaluate your implementation for the following values of the dimensionless field parameter:\n- $\\lambda = 0$\n- $\\lambda = 0.5$\n- $\\lambda = 2$\n- $\\lambda = -1.5$\n- $\\lambda = 8$\n\nFinal Output Format:\n- For each input value of $\\lambda$ in the order given above, produce a list of three floating-point numbers $[Z(\\lambda), S(\\lambda), \\varepsilon(\\lambda)]$.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element is the three-entry list for one $\\lambda$, ordered as listed above. There are no physical units and no angles to report; all quantities are dimensionless.", "solution": "We begin from the Boltzmann weight principle. In the Maier–Saupe mean-field description, the single-particle orientational potential depends on the polar angle $\\theta$ only via $\\mu = \\cos\\theta$ and is proportional to the second Legendre polynomial. The core definitions are:\n\n- The second Legendre polynomial is $P_{2}(\\mu) = \\tfrac{1}{2}\\left(3\\mu^{2}-1\\right)$.\n- The Boltzmann weight is proportional to $\\exp\\!\\left(-\\beta U\\right)$. In the mean-field, the potential is proportional to $-P_{2}(\\mu)$ up to a constant prefactor absorbed into a dimensionless parameter $\\lambda$, so that the unnormalized weight is $\\exp\\!\\left(\\lambda P_{2}(\\mu)\\right)$.\n- Because the distribution is axisymmetric, after integrating over the azimuthal angle, the remaining integral is over $\\mu \\in [-1,1]$.\n\nHence, up to an overall constant (which cancels in normalized averages), the dimensionless partition function over $\\mu$ is\n$$\nZ(\\lambda) \\equiv \\int_{-1}^{1} \\exp\\!\\left(\\lambda P_{2}(\\mu)\\right)\\, d\\mu.\n$$\nThe normalized orientational distribution over $\\mu$ is therefore\n$$\nf(\\mu \\,|\\, \\lambda) = \\frac{\\exp\\!\\left(\\lambda P_{2}(\\mu)\\right)}{Z(\\lambda)}.\n$$\nThe nematic order parameter is the expectation of $P_{2}(\\mu)$ with respect to $f(\\mu \\,|\\, \\lambda)$:\n$$\nS(\\lambda) \\equiv \\int_{-1}^{1} P_{2}(\\mu)\\, f(\\mu \\,|\\, \\lambda)\\, d\\mu\n= \\frac{\\int_{-1}^{1} P_{2}(\\mu)\\, \\exp\\!\\left(\\lambda P_{2}(\\mu)\\right)\\, d\\mu}{\\int_{-1}^{1} \\exp\\!\\left(\\lambda P_{2}(\\mu)\\right)\\, d\\mu}.\n$$\nThese expressions follow directly from the Boltzmann principle and the axisymmetry that reduces the orientational integral to the $\\mu$-domain.\n\nNumerical evaluation strategy:\n- We approximate integrals over $\\mu \\in [-1,1]$ using $N$-point Gauss–Legendre quadrature, which is exact for polynomials up to degree $2N-1$ and highly accurate for smooth integrands such as $\\exp\\!\\left(\\lambda P_{2}(\\mu)\\right)$.\n- We compute two quantities simultaneously for a given $N$:\n  $$\n  Z_{N}(\\lambda) = \\sum_{i=1}^{N} w_{i}\\, \\exp\\!\\left(\\lambda P_{2}(\\mu_{i})\\right),\n  \\quad\n  \\mathcal{N}_{N}(\\lambda) = \\sum_{i=1}^{N} w_{i}\\, P_{2}(\\mu_{i})\\, \\exp\\!\\left(\\lambda P_{2}(\\mu_{i})\\right),\n  $$\n  where $\\{\\mu_{i}, w_{i}\\}_{i=1}^{N}$ are the Gauss–Legendre nodes and weights on $[-1,1]$. Then $S_{N}(\\lambda) = \\mathcal{N}_{N}(\\lambda)/Z_{N}(\\lambda)$.\n- We adaptively increase $N$ (for example, doubling from an initial $N$) until both $|Z_{N} - Z_{N/2}| \\leq 10^{-13}\\max(1,|Z_{N}|)$ and $|S_{N} - S_{N/2}| \\leq 10^{-13}\\max(1,|S_{N}|)$, or until a predefined maximum $N$ is reached. This ensures absolute convergence on the scale of $10^{-13}$ for both quantities, which is appropriate for double-precision accuracy.\n- To verify normalization without a trivial identity, we perform an independent Gauss–Legendre integration of $f(\\mu \\,|\\, \\lambda)$ using a quadrature order $M$ strictly different from the converged $N$ used to compute $Z(\\lambda)$, so that\n  $$\n  I_{M}(\\lambda) = \\sum_{j=1}^{M} \\tilde{w}_{j}\\, \\frac{\\exp\\!\\left(\\lambda P_{2}(\\tilde{\\mu}_{j})\\right)}{Z(\\lambda)},\n  $$\n  and we report\n  $$\n  \\varepsilon(\\lambda) = \\left| I_{M}(\\lambda) - 1 \\right|.\n  $$\n  Using a different $M$ prevents $\\varepsilon(\\lambda)$ from being identically zero due to reusing the same quadrature sum in numerator and denominator; with sufficiently large $M$, $\\varepsilon(\\lambda)$ should approach machine precision.\n\nSanity checks:\n- For $\\lambda = 0$, the integrand for $Z(\\lambda)$ is unity, giving $Z(0) = \\int_{-1}^{1} d\\mu = 2$, and the numerator for $S(0)$ is $\\int_{-1}^{1} P_{2}(\\mu)\\, d\\mu = 0$ by orthogonality of Legendre polynomials, hence $S(0) = 0$. The algorithm should reproduce these values to within the target tolerance.\n- For positive $\\lambda$, the weight concentrates near $\\mu$ with larger $P_{2}(\\mu)$ (aligned states), so $S(\\lambda) > 0$. For negative $\\lambda$, the weight concentrates toward $\\mu$ where $P_{2}(\\mu)$ is smaller (planar or oblate ordering), so $S(\\lambda) < 0$.\n\nAlgorithmic details:\n- Use the Gauss–Legendre nodes and weights on $[-1,1]$ obtained from a standard routine.\n- Implement adaptive refinement in $N \\in \\{32, 64, 128, \\dots\\}$ up to a maximum such as $N=4096$, comparing successive estimates until the $10^{-13}$ criterion is met.\n- For the normalization check, choose $M$ different from $N$ (for instance, $M=N+3$ or $M=2N$ if within limits), compute the integral of the normalized $f(\\mu \\,|\\, \\lambda)$, and report $\\varepsilon(\\lambda)$.\n\nThe program outputs, for each $\\lambda$ in the test suite in the specified order, the triple $[Z(\\lambda), S(\\lambda), \\varepsilon(\\lambda)]$, aggregated into a single top-level list on one line. All quantities are dimensionless, and there are no angles to report, so no angle unit is required. Because Gauss–Legendre quadrature integrates smooth functions very accurately and we employ adaptive refinement, the reported normalization deviations $\\varepsilon(\\lambda)$ should be close to machine precision for double-precision arithmetic.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom numpy.polynomial.legendre import leggauss\n\ndef P2(mu: np.ndarray) -> np.ndarray:\n    \"\"\"Second Legendre polynomial P2(mu) = (3 mu^2 - 1)/2.\"\"\"\n    return 0.5 * (3.0 * mu * mu - 1.0)\n\ndef gauss_legendre_integrate(func, n: int) -> float:\n    \"\"\"Integrate func(mu) over mu in [-1,1] using n-point Gauss-Legendre quadrature.\"\"\"\n    nodes, weights = leggauss(n)\n    values = func(nodes)\n    # Use dot product for numerical stability and performance.\n    return float(np.dot(weights, values))\n\ndef compute_Z_S_and_norm_error(lam: float,\n                               tol: float = 1e-13,\n                               n0: int = 32,\n                               nmax: int = 4096) -> tuple[float, float, float]:\n    \"\"\"\n    Compute Z(lam), S(lam), and an independent normalization error epsilon(lam)\n    using adaptive Gauss-Legendre quadrature.\n    \"\"\"\n    # Adaptive refinement for Z and S\n    n = n0\n    prev_Z = None\n    prev_S = None\n\n    # We predefine a function for the exponential weight for reuse\n    def exp_weight(mu: np.ndarray) -> np.ndarray:\n        return np.exp(lam * P2(mu))\n\n    while True:\n        nodes, weights = leggauss(n)\n        p2_vals = P2(nodes)\n        exp_vals = np.exp(lam * p2_vals)\n\n        Z = float(np.dot(weights, exp_vals))\n        S_num = float(np.dot(weights, p2_vals * exp_vals))\n        S = S_num / Z if Z != 0 else 0.0\n\n        if prev_Z is not None and prev_S is not None:\n            z_change = abs(Z - prev_Z)\n            s_change = abs(S - prev_S)\n            z_thresh = tol * max(1.0, abs(Z))\n            s_thresh = tol * max(1.0, abs(S))\n            if z_change <= z_thresh and s_change <= s_thresh:\n                break\n\n        if n >= nmax:\n            break\n\n        prev_Z, prev_S = Z, S\n        n *= 2\n\n    # Independent normalization check with a strictly different quadrature order\n    m = min(n + 3, nmax) if n + 3 != n else min(n + 1, nmax)\n    if m == n:  # ensure different order; if at cap, try to reduce by 1\n        m = max(2, n - 1)\n        if m == n: # if n is 2, m becomes 1 which is invalid for leggauss\n             m = 3\n\n    # Define normalized distribution f(mu) = exp(lam * P2(mu)) / Z\n    def f_norm(mu: np.ndarray) -> np.ndarray:\n        return np.exp(lam * P2(mu)) / Z\n\n    nodes_m, weights_m = leggauss(m)\n    I_norm = float(np.dot(weights_m, f_norm(nodes_m)))\n    err = abs(I_norm - 1.0)\n\n    return Z, S, err\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        0.0,\n        0.5,\n        2.0,\n        -1.5,\n        8.0,\n    ]\n\n    results = []\n    for lam in test_cases:\n        Z, S, err = compute_Z_S_and_norm_error(lam)\n        results.append([Z, S, err])\n\n    # Final print statement in the exact required format: single line list of per-case triples.\n    # Remove spaces for a compact, unambiguous representation.\n    results_str = str(results).replace(\" \", \"\")\n    print(results_str)\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "2920228"}]}