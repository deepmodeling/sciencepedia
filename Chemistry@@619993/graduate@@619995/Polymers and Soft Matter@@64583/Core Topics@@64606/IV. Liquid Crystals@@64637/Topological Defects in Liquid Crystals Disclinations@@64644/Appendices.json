{"hands_on_practices": [{"introduction": "The head-tail symmetry of nematic liquid crystals means their orientation angle $\\alpha$ is only defined modulo $\\pi$, which seemingly complicates the use of integer-based topological tools. This practice introduces a crucial mathematical technique to resolve this ambiguity by transforming the multivalued angle $\\alpha$ into a standard single-valued angle $\\theta$ that is periodic by $2\\pi$. By working through this transformation for a fundamental $+1/2$ disclination, you will see how the half-integer defect strength $s$ is directly related to a conventional integer winding number $m$ [@problem_id:2937209].", "problem": "A planar nematic liquid crystal is described by a headless director field $\\mathbf{n}(\\mathbf{r}) = (\\cos\\alpha(\\mathbf{r}), \\sin\\alpha(\\mathbf{r}))$, where the angle field $\\alpha(\\mathbf{r})$ is defined modulo $\\pi$ due to head-tail symmetry. Consider a single isolated disclination at the origin in the plane, so that on a circle $\\mathcal{C}_{R}$ of radius $R$ centered at the origin the director angle takes the form $\\alpha(\\phi) = s\\,\\phi + \\alpha_{0}$, where $\\phi$ is the polar angle measured in radians, $s = \\tfrac{1}{2}$ is the defect strength, and $\\alpha_{0}$ is a constant offset independent of $\\phi$. Introduce the double-angle field $\\theta(\\mathbf{r}) = 2\\,\\alpha(\\mathbf{r})$.\n\nStarting from the fundamental facts that (i) the headless nature of the director implies $\\alpha \\equiv \\alpha + \\pi$ but $\\theta$ is single-valued modulo $2\\pi$, and (ii) the integer winding number of a single-valued planar phase field equals its total phase accumulation around a closed loop divided by $2\\pi$, carry out the following:\n\n(a) Argue that $\\theta(\\mathbf{r})$ defines a continuous phase field with $2\\pi$ periodicity on the punctured plane excluding the defect core, and write $\\theta(\\phi)$ explicitly on $\\mathcal{C}_{R}$ in terms of $s$, $\\phi$, and $\\alpha_{0}$.\n\n(b) Using only the definition of winding for a single-valued angle field, express the integer winding number $m$ of $\\theta$ around $\\mathcal{C}_{R}$ as the net change of $\\theta$ along the loop divided by $2\\pi$.\n\n(c) Evaluate $m$ explicitly for the given $\\alpha(\\phi)$ with $s = \\tfrac{1}{2}$ and state, in one sentence, why the transformation $\\theta = 2\\,\\alpha$ is useful for classifying nematic disclinations.\n\nProvide the final answer as the single value of $m$. No rounding is required. The winding number is dimensionless. All angles are measured in radians.", "solution": "The problem is subjected to validation and is found to be scientifically grounded, well-posed, and self-consistent. It is a standard problem in the physics of liquid crystals. We proceed to solve it.\n\n(a) The director field of a nematic liquid crystal, $\\mathbf{n}$, is headless, meaning $\\mathbf{n}$ and $-\\mathbf{n}$ represent the same physical state. If the director's orientation is described by an angle $\\alpha$, this physical equivalence implies that $\\alpha$ and $\\alpha+\\pi$ are indistinguishable. Thus, the angle field $\\alpha(\\mathbf{r})$ is multivalued, defined modulo $\\pi$. The problem defines a new field $\\theta(\\mathbf{r}) = 2\\alpha(\\mathbf{r})$. To investigate its properties, consider the effect of the multivalency of $\\alpha$. If we take an equivalent representation $\\alpha' = \\alpha + k\\pi$ for an integer $k$, the new field becomes $\\theta' = 2\\alpha' = 2(\\alpha + k\\pi) = 2\\alpha + 2k\\pi = \\theta + 2k\\pi$. Since an angle is defined modulo $2\\pi$, $\\theta$ is effectively single-valued, as $\\theta \\equiv \\theta + 2k\\pi$. The original field $\\alpha(\\mathbf{r})$ is continuous on the punctured plane $\\mathbb{R}^2 \\setminus \\{\\mathbf{0}\\}$, so the field $\\theta(\\mathbf{r})=2\\alpha(\\mathbf{r})$ must also be continuous on this domain. Thus, $\\theta(\\mathbf{r})$ is a continuous, single-valued phase field with $2\\pi$ periodicity on the punctured plane.\n\nOn the circle $\\mathcal{C}_{R}$, the angle field $\\alpha$ is given by $\\alpha(\\phi) = s\\phi + \\alpha_{0}$, where $s = \\frac{1}{2}$. The corresponding double-angle field $\\theta(\\phi)$ is therefore:\n$$ \\theta(\\phi) = 2\\alpha(\\phi) = 2(s\\phi + \\alpha_{0}) = 2s\\phi + 2\\alpha_{0} $$\n\n(b) As instructed, the winding number $m$ of a single-valued phase field is defined as its total phase accumulation around a closed loop, divided by $2\\pi$. For the field $\\theta(\\phi)$ on the loop $\\mathcal{C}_R$ (parameterized by $\\phi$ from $0$ to $2\\pi$), the total phase accumulation is the net change $\\Delta\\theta = \\theta(\\phi=2\\pi) - \\theta(\\phi=0)$. The winding number $m$ is therefore expressed as:\n$$ m = \\frac{\\Delta\\theta}{2\\pi} = \\frac{\\theta(\\phi=2\\pi) - \\theta(\\phi=0)}{2\\pi} $$\n\n(c) We now evaluate $m$ using the expressions derived above. First, we find the values of $\\theta$ at the beginning and end of the loop:\n$$ \\theta(\\phi=0) = 2s(0) + 2\\alpha_{0} = 2\\alpha_{0} $$\n$$ \\theta(\\phi=2\\pi) = 2s(2\\pi) + 2\\alpha_{0} = 4\\pi s + 2\\alpha_{0} $$\nThe total phase accumulation is:\n$$ \\Delta\\theta = (4\\pi s + 2\\alpha_{0}) - 2\\alpha_{0} = 4\\pi s $$\nSubstituting this into the formula for the winding number $m$:\n$$ m = \\frac{4\\pi s}{2\\pi} = 2s $$\nThe problem states that the defect strength is $s = \\frac{1}{2}$. We substitute this value to find $m$:\n$$ m = 2 \\left(\\frac{1}{2}\\right) = 1 $$\nThis is an integer, consistent with the properties of a winding number for a single-valued field.\n\nThe transformation $\\theta = 2\\alpha$ is useful because it maps the half-integer topological charges $s$ of nematic disclinations to the integer winding numbers $m$ of a standard vector field, thereby simplifying their classification.", "answer": "$$\\boxed{1}$$", "id": "2937209"}, {"introduction": "While topology tells us which defects are possible, the principles of energy minimization dictate their behavior and stability. This practice delves into the energetic cost of disclinations using the Frank-Oseen free energy, demonstrating how different types of elastic distortion—splay and bend—contribute to the total energy. By comparing the energies of a $+1$ disclination in pure splay and pure bend configurations, you will develop a physical intuition for why such integer-strength defects tend to split into pairs of half-integer defects in realistic materials with anisotropic elasticity [@problem_id:2937179].", "problem": "A two-dimensional nematic liquid crystal film in the plane is described by a unit director field $\\mathbf{n}(\\mathbf{r}) = (\\cos\\psi(\\mathbf{r}), \\sin\\psi(\\mathbf{r}))$, with $\\mathbf{r} = (x,y)$ and $\\psi$ the in-plane director angle. The elastic free energy per unit thickness is given by the Frank–Oseen functional specialized to two dimensions with anisotropic elastic constants,\n$$\nF = \\int_{A} \\left[\\frac{K_1}{2}\\left(\\nabla\\cdot \\mathbf{n}\\right)^{2} + \\frac{K_3}{2}\\left|\\mathbf{n}\\times(\\nabla\\times \\mathbf{n})\\right|^{2}\\right] \\,\\mathrm{d}A,\n$$\nwhere $K_1$ and $K_3$ are the splay and bend elastic constants, respectively. Consider a circular domain of radius $R$ centered at the origin containing a single $+1$ disclination at $\\mathbf{r}=\\mathbf{0}$, with a microscopic core of radius $a$ that provides a short-distance cutoff for the continuum theory. Two canonical realizations of a $+1$ disclination are the pure splay (radial) texture $\\mathbf{n}(\\mathbf{r}) = \\hat{\\mathbf{e}}_{r}$ and the pure bend (circular) texture $\\mathbf{n}(\\mathbf{r}) = \\hat{\\mathbf{e}}_{\\phi}$, where $(r,\\phi)$ are polar coordinates and $\\hat{\\mathbf{e}}_{r}$ and $\\hat{\\mathbf{e}}_{\\phi}$ are the corresponding unit vectors. Using only the definitions above and standard vector calculus, compute the elastic energies per unit thickness $F_{\\mathrm{splay}}$ and $F_{\\mathrm{bend}}$ for these two textures by integrating over the annulus $a \\le r \\le R$. Then, by comparing the results, provide a physical rationale for the well-known tendency of a $+1$ disclination to split into a pair of $+1/2$ disclinations when $K_1 \\ne K_3$, taking into account how splay and bend distortions are distributed in the neighborhood of half-integer defects. \n\nYour final reported quantity must be a single closed-form analytic expression for the energy difference\n$$\n\\Delta F \\equiv F_{\\mathrm{bend}} - F_{\\mathrm{splay}}\n$$\nin terms of $K_1$, $K_3$, $R$, and $a$. Do not evaluate numerically. Do not include units in your final expression.", "solution": "The starting point is the two-dimensional Frank–Oseen free energy with anisotropic elastic constants,\n$$\nF = \\int_{A} \\left[\\frac{K_1}{2}\\left(\\nabla\\cdot \\mathbf{n}\\right)^{2} + \\frac{K_3}{2}\\left|\\mathbf{n}\\times(\\nabla\\times \\mathbf{n})\\right|^{2}\\right] \\,\\mathrm{d}A,\n$$\nwhere $\\mathbf{n}(\\mathbf{r})$ is a unit vector confined to the plane. In polar coordinates $(r,\\phi)$, the divergence and curl of a general in-plane vector field $\\mathbf{A} = A_r \\hat{\\mathbf{e}}_{r} + A_{\\phi} \\hat{\\mathbf{e}}_{\\phi}$ are given by standard vector calculus identities,\n$$\n\\nabla\\cdot \\mathbf{A} = \\frac{1}{r}\\frac{\\partial}{\\partial r}\\left(r A_r\\right) + \\frac{1}{r}\\frac{\\partial A_{\\phi}}{\\partial \\phi},\n$$\nand the out-of-plane component of the curl is\n$$\n\\left(\\nabla\\times \\mathbf{A}\\right)\\cdot \\hat{\\mathbf{e}}_{z} = \\frac{1}{r}\\frac{\\partial}{\\partial r}\\left(r A_{\\phi}\\right) - \\frac{1}{r}\\frac{\\partial A_{r}}{\\partial \\phi}.\n$$\nIn two dimensions, $\\nabla\\times \\mathbf{n}$ points along $\\hat{\\mathbf{e}}_{z}$, so $\\left|\\mathbf{n}\\times(\\nabla\\times \\mathbf{n})\\right| = \\left|\\nabla\\times \\mathbf{n}\\right|$.\n\nConsider first the pure splay (radial) $+1$ texture $\\mathbf{n} = \\hat{\\mathbf{e}}_{r}$. For this field, $A_r = 1$ and $A_{\\phi} = 0$ are independent of $r$ and $\\phi$. Therefore,\n$$\n\\nabla\\cdot \\mathbf{n} = \\frac{1}{r}\\frac{\\partial}{\\partial r}\\left(r\\cdot 1\\right) + \\frac{1}{r}\\frac{\\partial}{\\partial \\phi}(0) = \\frac{1}{r},\n$$\nand\n$$\n\\left(\\nabla\\times \\mathbf{n}\\right)\\cdot \\hat{\\mathbf{e}}_{z} = \\frac{1}{r}\\frac{\\partial}{\\partial r}\\left(r\\cdot 0\\right) - \\frac{1}{r}\\frac{\\partial}{\\partial \\phi}(1) = 0.\n$$\nThis is a pure splay distortion with no bend. The elastic energy per unit thickness becomes\n$$\nF_{\\mathrm{splay}} = \\int_{a \\le r \\le R} \\frac{K_1}{2}\\left(\\frac{1}{r}\\right)^{2} \\, \\mathrm{d}A = \\int_{0}^{2\\pi}\\int_{a}^{R} \\frac{K_1}{2}\\left(\\frac{1}{r}\\right)^{2} r \\,\\mathrm{d}r\\,\\mathrm{d}\\phi.\n$$\nEvaluating the integral,\n$$\nF_{\\mathrm{splay}} = \\int_{0}^{2\\pi}\\int_{a}^{R} \\frac{K_1}{2}\\frac{1}{r}\\,\\mathrm{d}r\\,\\mathrm{d}\\phi = \\left(2\\pi\\right)\\left(\\frac{K_1}{2}\\right)\\left[\\ln r\\right]_{a}^{R} = \\pi K_1 \\ln\\!\\left(\\frac{R}{a}\\right).\n$$\n\nNext consider the pure bend (circular) $+1$ texture $\\mathbf{n} = \\hat{\\mathbf{e}}_{\\phi}$. For this field, $A_r = 0$ and $A_{\\phi} = 1$. Therefore,\n$$\n\\nabla\\cdot \\mathbf{n} = \\frac{1}{r}\\frac{\\partial}{\\partial r}\\left(r\\cdot 0\\right) + \\frac{1}{r}\\frac{\\partial}{\\partial \\phi}(1) = 0,\n$$\nand\n$$\n\\left(\\nabla\\times \\mathbf{n}\\right)\\cdot \\hat{\\mathbf{e}}_{z} = \\frac{1}{r}\\frac{\\partial}{\\partial r}\\left(r\\cdot 1\\right) - \\frac{1}{r}\\frac{\\partial}{\\partial \\phi}(0) = \\frac{1}{r}.\n$$\nThis is a pure bend distortion with no splay. The elastic energy per unit thickness becomes\n$$\nF_{\\mathrm{bend}} = \\int_{a \\le r \\le R} \\frac{K_3}{2}\\left(\\frac{1}{r}\\right)^{2} \\, \\mathrm{d}A = \\int_{0}^{2\\pi}\\int_{a}^{R} \\frac{K_3}{2}\\left(\\frac{1}{r}\\right)^{2} r \\,\\mathrm{d}r\\,\\mathrm{d}\\phi,\n$$\nwhich evaluates to\n$$\nF_{\\mathrm{bend}} = \\pi K_3 \\ln\\!\\left(\\frac{R}{a}\\right).\n$$\n\nThe requested energy difference is therefore\n$$\n\\Delta F \\equiv F_{\\mathrm{bend}} - F_{\\mathrm{splay}} = \\pi\\left(K_3 - K_1\\right)\\ln\\!\\left(\\frac{R}{a}\\right).\n$$\n\nTo rationalize the tendency of a $+1$ disclination to split into a pair of $+1/2$ disclinations when $K_1 \\ne K_3$, consider how distortions are distributed around half-integer defects. A $+1$ defect enforces a $2\\pi$ rotation of the director around the core; in the pure splay realization this rotation is accommodated entirely by splay with energy scaling as $\\pi K_1 \\ln(R/a)$, and in the pure bend realization entirely by bend with energy $\\pi K_3 \\ln(R/a)$. If $K_3 \\gg K_1$, pure bend is energetically costly compared to pure splay, and vice versa. A configuration consisting of two well-separated $+1/2$ defects allows the director field to partition the required $2\\pi$ rotation into two $\\pi$ rotations, and, importantly, to arrange the local orientation of each $+1/2$ defect so that the high-cost distortion (bend when $K_3  K_1$, or splay when $K_1  K_3$) is confined to narrow angular sectors, while the low-cost distortion occupies most of space. In the one-constant limit $K_1 = K_3$, the energy of a defect of charge $s$ scales as $\\pi K s^{2}\\ln(R/a)$, implying that two $+1/2$ defects have the same logarithmic energy as one $+1$ defect up to interaction and core terms. Anisotropy $K_1 \\ne K_3$ lifts this degeneracy and favors splitting because the mixed-distortion environment around $+1/2$ defects can be optimized to minimize the contribution from the larger elastic constant, reducing the total energy below the higher of the two pure $+1$ realizations. Thus, when $K_1 \\ne K_3$, a $+1$ defect tends to split so that the system predominantly exhibits the lower-cost distortion in the far field, avoiding the globally costly pure distortion.", "answer": "$$\\boxed{\\pi\\left(K_3 - K_1\\right)\\ln\\!\\left(\\frac{R}{a}\\right)}$$", "id": "2937179"}, {"introduction": "Moving from theory to practice, the analysis of topological defects in simulations or experiments requires robust methods to handle discrete and often ambiguous data. This exercise challenges you to design a computational algorithm that can accurately determine a disclination's strength from a sequence of director angles, even in the presence of the inherent $\\pi$-jumps caused by head-tail symmetry. You will implement the powerful doubled-angle mapping to create a tool capable of analyzing defect configurations, a skill directly applicable to modern soft matter research [@problem_id:2937244].", "problem": "Consider a two-dimensional nematic liquid crystal on a plane. The local orientation is represented by a unit director field that is head-tail symmetric, meaning that the physical state is unchanged under $\\mathbf{n}\\to -\\mathbf{n}$. Let $\\alpha$ denote the orientation angle of the director, but defined only modulo $\\pi$ because $\\alpha$ and $\\alpha+\\pi$ describe the same physical state.\n\nA suspected disclination defect is encircled by a simple closed loop. Along this loop, the orientation is sampled at $N$ equally spaced points, yielding a sequence $\\{\\alpha_k\\}_{k=0}^{N-1}$, where each $\\alpha_k$ is given in radians and is only defined modulo $\\pi$. Due to the $\\alpha\\equiv\\alpha+\\pi$ equivalence and practical measurement choices, the sequence can exhibit apparent discontinuities corresponding to jumps by approximately $\\pi$. In addition, there may be small, smooth perturbations from an ideal field.\n\nYour task is to design and implement a robust algorithm that, given a discrete sequence $\\{\\alpha_k\\}$ sampled along a loop, computes the disclination strength $s$ associated with the enclosed defect. The algorithm must be invariant under local replacements of any sample $\\alpha_k$ by $\\alpha_k+\\pi$, must tolerate small smooth perturbations, and must return the correct sign depending on the loop orientation. All angles are to be treated in radians.\n\nThe algorithm must be derived from first principles appropriate to nematic liquids, starting from core definitions about the order parameter space and loop encirclement. Avoid any ad hoc heuristics that depend on a particular coordinate frame or on enforcing continuity of $\\alpha$ directly.\n\nYour program must implement this algorithm and apply it to the following deterministic test suite. In each test case, the sequence $\\{\\alpha_k\\}$ is synthesized by the following rule:\n- Fix an integer $N\\ge 3$. Define sample indices $k\\in\\{0,1,\\dots,N-1\\}$ and an orientation sign $\\sigma\\in\\{+1,-1\\}$, with $\\sigma=+1$ corresponding to counterclockwise sampling of the loop and $\\sigma=-1$ to clockwise sampling.\n- Let $\\theta_k = \\sigma \\cdot \\frac{2\\pi k}{N}$.\n- Let $s_{\\mathrm{true}}$ be the nominal disclination strength used to generate the field, and let $\\alpha_0$ be a constant phase offset. Define a smooth perturbation $\\varepsilon_k = \\varepsilon_{\\mathrm{amp}}\\cdot \\sin(3k+0.37)$.\n- Define the baseline orientation $\\tilde{\\alpha}_k = s_{\\mathrm{true}}\\cdot \\theta_k + \\alpha_0 + \\varepsilon_k$.\n- Define a deterministic head-tail branch pattern as follows. For Pattern A, set a branch indicator $b_k^{(A)}=1$ if $(7k)\\bmod 13  4$ and $b_k^{(A)}=0$ otherwise. For Pattern B, set $b_k^{(B)}=1$ if $k$ is odd and $b_k^{(B)}=0$ otherwise.\n- The reported angle is then $\\alpha_k = \\tilde{\\alpha}_k + b_k\\cdot \\pi$, where $b_k$ is either $b_k^{(A)}$ or $b_k^{(B)}$ depending on the test case. Note that $\\alpha_k$ is not reduced modulo $\\pi$; it is provided exactly as specified to intentionally include apparent $\\pi$-jumps.\n\nUse the following six test cases, each specified by $(N, s_{\\mathrm{true}}, \\alpha_0, \\varepsilon_{\\mathrm{amp}}, \\sigma, \\text{pattern})$:\n- Case 1: $(128,\\; 0.5,\\; 0.1,\\; 0.03,\\; +1,\\; \\text{A})$.\n- Case 2: $(128,\\; -0.5,\\; -0.2,\\; 0.02,\\; +1,\\; \\text{A})$.\n- Case 3: $(100,\\; 0.0,\\; 0.33,\\; 0.05,\\; +1,\\; \\text{A})$.\n- Case 4: $(256,\\; 1.0,\\; -0.4,\\; 0.015,\\; +1,\\; \\text{A})$.\n- Case 5: $(8,\\; 0.5,\\; 0.0,\\; 0.0,\\; +1,\\; \\text{B})$.\n- Case 6: $(128,\\; 0.5,\\; 0.1,\\; 0.0,\\; -1,\\; \\text{A})$.\n\nYour program must:\n- Implement a principled algorithm that produces an estimate $\\hat{s}$ from a given sequence $\\{\\alpha_k\\}$ and is mathematically invariant under any local replacement $\\alpha_k\\to \\alpha_k+\\pi$. The algorithm must use only the provided angle sequences in radians and must not assume any particular branch restriction for $\\alpha_k$.\n- Compute the result for each test case and round each $\\hat{s}$ to six decimal places.\n- Produce a single line of output containing the six results as a comma-separated list enclosed in square brackets (e.g., \"[0.500000,-0.500000,0.000000,1.000000,0.500000,-0.500000]\").\n\nNo user input is required or permitted; all data must be generated exactly as specified. The solution must be logically derived from fundamental definitions of nematic order and topological charge and must be expressed in radians. The final results must be floats as specified above and printed in the exact required output format on a single line.", "solution": "The problem as stated is subjected to rigorous validation and is found to be scientifically sound, well-posed, and objective. It is a formal problem in computational soft matter physics, free of contradiction, ambiguity, or fallacy. We may therefore proceed with a solution derived from first principles.\n\nThe central physical concept is that of a nematic liquid crystal, whose local average molecular orientation is described by a director field, denoted by $\\mathbf{n}$. The director is a unit vector, but possesses head-tail symmetry, meaning the states represented by $\\mathbf{n}$ and $-\\mathbf{n}$ are physically indistinguishable. In a two-dimensional system, the orientation can be described by an angle $\\alpha$, such that $\\mathbf{n} = (\\cos\\alpha, \\sin\\alpha)$. The head-tail symmetry implies that $\\alpha$ is defined only modulo $\\pi$, as replacing $\\alpha$ with $\\alpha+\\pi$ reverses the sign of $\\mathbf{n}$. This means the order parameter space of a $2$D nematic is not the circle $S^1$, but the real projective line $\\mathbb{R}P^1$.\n\nA disclination is a topological defect, a point singularity in the director field. The topological charge of such a defect, known as the disclination strength $s$, is a conserved quantity determined by the winding of the director field around the defect. Formally, it is an element of the first homotopy group $\\pi_1(\\mathbb{R}P^1) = \\mathbb{Z}$, which leads to the rule that possible strengths are multiples of $1/2$. For a continuous field, the strength $s$ is calculated by integrating the change in angle $\\alpha$ along a closed loop $\\mathcal{C}$ encircling the defect:\n$$ s = \\frac{1}{2\\pi} \\oint_{\\mathcal{C}} d\\alpha $$\nThe result of this integral must be of the form $n/2$ for some integer $n$.\n\nThe problem provides a discrete sequence of angles, $\\{\\alpha_k\\}_{k=0}^{N-1}$, sampled along such a loop. A naive attempt to approximate the integral as a sum of differences, $s \\approx \\frac{1}{2\\pi} \\sum_{k=0}^{N-1} (\\alpha_{(k+1)\\%N} - \\alpha_k)$, is doomed to fail. The reason is that the recorded value $\\alpha_k$ at any point can be shifted by an arbitrary integer multiple of $\\pi$ without changing the physical state. The provided data deliberately includes such jumps. A robust algorithm must be invariant to any local transformation $\\alpha_k \\to \\alpha_k + m_k\\pi$ for integers $m_k$.\n\nTo construct such an algorithm, we must operate on a quantity that is inherently invariant to these $\\pi$-jumps. A standard method in the theory of nematics is to construct a field that lacks the head-tail ambiguity. Consider defining a complex order parameter $\\Psi$ or a related angle $\\phi$ from the nematic angle $\\alpha$. Let us define a new angle $\\phi = 2\\alpha$. If we substitute $\\alpha$ with $\\alpha + m\\pi$ (for integer $m$), the new angle becomes $\\phi' = 2(\\alpha+m\\pi) = 2\\alpha + 2m\\pi = \\phi + 2m\\pi$. Since angles are defined modulo $2\\pi$, $\\phi$ and $\\phi'$ represent the same state for a standard vector field. In effect, we have performed a mapping from the nematic order parameter space $\\mathbb{R}P^1$ to the circle $S^1$ via the angle doubling $\\alpha \\mapsto 2\\alpha$. This is a $2$-to-$1$ covering map.\n\nThe problem is now transformed into finding the winding number, let us call it $W$, of the vector field represented by the sequence of angles $\\{\\phi_k = 2\\alpha_k\\}_{k=0}^{N-1}$. The winding number of this new field is defined as the total rotation of $\\phi$ around the loop, divided by $2\\pi$:\n$$ W = \\frac{1}{2\\pi} \\oint d\\phi $$\nThe relationship between the disclination strength $s$ and this new winding number $W$ is straightforward. Since $\\phi = 2\\alpha$, we have $d\\phi = 2d\\alpha$. Substituting this into the integral for $W$:\n$$ W = \\frac{1}{2\\pi} \\oint 2d\\alpha = 2 \\left( \\frac{1}{2\\pi} \\oint d\\alpha \\right) = 2s $$\nTherefore, the disclination strength is simply half the winding number of the doubled-angle field: $s = W/2$.\n\nThe remaining task is to compute $W$ from the discrete sequence $\\{\\phi_k\\}_{k=0}^{N-1}$. The total change in $\\phi$ around the loop is the sum of the unwrapped angle differences between consecutive points. The sum of the direct differences, $\\sum_{k=0}^{N-1} (\\phi_{(k+1)\\%N} - \\phi_k)$, is trivially zero. The winding number is encoded in the integer number of $2\\pi$ rotations that are \"hidden\" by the modular nature of the angle.\nA robust method to calculate the total unwrapped phase change is to sum the integer number of jumps of $2\\pi$ that occur between steps. The difference between two consecutive angles is $\\Delta\\phi_k = \\phi_{(k+1)\\%N} - \\phi_k$. Assuming that the underlying physical field is smooth (i.e., the variation between adjacent sample points is small, specifically $|\\Delta\\phi_k^{\\text{smooth}}|  \\pi$), any measured difference $\\Delta\\phi_k$ can be uniquely decomposed as $\\Delta\\phi_k = 2\\pi m_k + \\delta_k$, where $m_k$ is an integer and $|\\delta_k|  \\pi$. The integer $m_k$ can be found by rounding:\n$$ m_k = \\text{round}\\left( \\frac{\\Delta\\phi_k}{2\\pi} \\right) = \\text{round}\\left( \\frac{\\phi_{(k+1)\\%N} - \\phi_k}{2\\pi} \\right) $$\nThe total change in unwrapped phase is the sum of the true steps, $\\sum \\delta_k$, plus the sum of the jumps, $2\\pi \\sum m_k$. However, the sum of the small, unwrapped differences around a closed loop, $\\sum \\delta_k$, must approach zero. Therefore, the total winding is captured entirely by the sum of integers $m_k$. A subtlety exists in the sign convention. The sum of wrapped differences is $\\sum (\\Delta\\phi_k - 2\\pi m_k) = \\sum\\Delta\\phi_k - 2\\pi\\sum m_k = 0 - 2\\pi\\sum m_k$. This represents the total change accumulated by an observer following the sequence. Hence, the winding number of the field is $W = - \\sum m_k$.\n\nThe complete algorithm is as follows:\n1. Given the sequence $\\{\\alpha_k\\}_{k=0}^{N-1}$, construct the doubled-angle sequence $\\{\\phi_k\\}$ where $\\phi_k = 2\\alpha_k$ for all $k \\in \\{0, 1, \\dots, N-1\\}$.\n2. Compute the integer jump numbers for each step along the loop:\n   $$ m_k = \\text{round}\\left( \\frac{\\phi_{(k+1)\\%N} - \\phi_k}{2\\pi} \\right) $$\n3. Calculate the winding number $W$ of the $\\phi$-field by summing these integers with a negative sign:\n   $$ W = - \\sum_{k=0}^{N-1} m_k $$\n4. Determine the disclination strength $s$ using the relation $s=W/2$.\n\nThis algorithm is invariant under $\\alpha_k \\to \\alpha_k + n\\pi$ for any integer $n$, as this adds $2n\\pi$ to $\\phi_k$, which does not alter the difference $\\phi_{k+1}-\\phi_k$ modulo $2\\pi$ and thus does not affect the calculation of $m_k$. It is also robust to small perturbations $\\varepsilon_k$, provided that these perturbations and the underlying smooth field variation are not large enough to make $|\\delta_k|$ exceed $\\pi$, which would corrupt the `round` operation. The problem statement guarantees this condition for all test cases.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the disclination strength for a series of test cases of a 2D nematic liquid crystal.\n    \"\"\"\n\n    # Test cases specified in the problem statement\n    # Each case is a tuple: (N, s_true, alpha_0, eps_amp, sigma, pattern_type)\n    test_cases = [\n        (128, 0.5, 0.1, 0.03, 1, 'A'),\n        (128, -0.5, -0.2, 0.02, 1, 'A'),\n        (100, 0.0, 0.33, 0.05, 1, 'A'),\n        (256, 1.0, -0.4, 0.015, 1, 'A'),\n        (8, 0.5, 0.0, 0.0, 1, 'B'),\n        (128, 0.5, 0.1, 0.0, -1, 'A')\n    ]\n\n    results = []\n\n    for case in test_cases:\n        N, s_true, alpha_0, eps_amp, sigma, pattern_type = case\n\n        # Generate the sequence of angles alpha_k\n        k = np.arange(N)\n        theta_k = sigma * 2 * np.pi * k / N\n        epsilon_k = eps_amp * np.sin(3 * k + 0.37)\n        alpha_tilde_k = s_true * theta_k + alpha_0 + epsilon_k\n        \n        if pattern_type == 'A':\n            b_k = ((7 * k) % 13  4).astype(int)\n        elif pattern_type == 'B':\n            b_k = (k % 2 != 0).astype(int)\n        else:\n            raise ValueError(\"Unknown pattern type\")\n\n        alpha_k = alpha_tilde_k + b_k * np.pi\n\n        # --- Algorithm to compute disclination strength s ---\n        \n        # 1. Map nematic angle alpha to vector angle phi = 2*alpha\n        # This removes the head-tail ambiguity (mod pi).\n        phi_k = 2 * alpha_k\n\n        # 2. Compute the winding number W of the phi-field.\n        # This is done by summing the integer number of 2*pi jumps\n        # between consecutive points around the loop.\n        \n        # Get the sequence of phi values for the next point in the loop\n        phi_next_k = np.roll(phi_k, -1)\n\n        # Calculate the differences between consecutive phi values\n        diffs = phi_next_k - phi_k\n\n        # The integer number of 2*pi jumps is found by rounding the difference divided by 2*pi.\n        # The sum of these integers, with a sign flip, gives the winding number.\n        m_k = np.round(diffs / (2 * np.pi))\n        W = -np.sum(m_k)\n\n        # 3. The disclination strength s is half the winding number W.\n        s_hat = W / 2.0\n        \n        results.append(s_hat)\n\n    # Format and print the final results as specified.\n    formatted_results = [f\"{res:.6f}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2937244"}]}