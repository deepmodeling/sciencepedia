{"hands_on_practices": [{"introduction": "The Flory-Huggins theory provides the foundational framework for understanding the thermodynamics of polymer solutions. This first exercise [@problem_id:2934645] is a crucial first step, guiding you through the analytical derivation of the theta condition from first principles. By expanding the osmotic pressure and identifying the second virial coefficient, you will establish the seminal result that links the theta temperature $T_{\\theta}$ to the Flory-Huggins interaction parameter, $\\chi(T_{\\theta}) = 1/2$, solidifying your grasp of this central concept in polymer solution theory.", "problem": "A long, flexible polymer in a molecular solvent at low polymer volume fraction is described by the Flory–Huggins (FH) free energy of mixing per lattice site,\n$$\n\\frac{f}{k_B T} \\equiv g(\\phi;T) = \\frac{\\phi}{N}\\ln \\phi + (1-\\phi)\\ln(1-\\phi) + \\chi(T)\\,\\phi(1-\\phi),\n$$\nwhere $k_B$ is the Boltzmann constant, $T$ is the absolute temperature, $\\phi$ is the polymer volume fraction, $N$ is the degree of polymerization, and $\\chi(T)$ is the temperature-dependent FH interaction parameter. The osmotic pressure is defined from the free energy density by the standard thermodynamic relation $\\Pi = \\phi\\,(\\partial f/\\partial \\phi)_T - f$. The $\\theta$-condition is defined as the point where the effective two-body excluded-volume interactions vanish in the dilute limit, which coincides with vanishing second virial coefficient of the osmotic equation of state. The empirically well-supported temperature dependence of the interaction parameter is\n$$\n\\chi(T) = \\frac{A}{T} + B,\n$$\nwhere $A$ and $B$ are temperature-independent constants.\n\nStarting from the FH free energy given above and the definition of the osmotic pressure, work in the limit of small $\\phi$ and show how the $\\theta$-condition fixes the value of $\\chi$ at the $\\theta$ temperature $T_{\\theta}$. Then, using only the empirical form for $\\chi(T)$ stated above, derive a closed-form expression for $T_{\\theta}$ in terms of $A$ and $B$. Finally, for a specific polymer–solvent pair with $A = 86.0\\,\\mathrm{K}$ and $B = 0.22$, compute $T_{\\theta}$ and report its value in Kelvin. Round your answer to four significant figures. In your derivation, briefly explain which thermodynamic contributions are encoded in $A$ and $B$ and why their signs matter for solvent quality as $T$ varies.", "solution": "The starting point is the Flory–Huggins (FH) free energy density per lattice site,\n$$\n\\frac{f}{k_B T} = \\frac{\\phi}{N}\\ln \\phi + (1-\\phi)\\ln(1-\\phi) + \\chi(T)\\,\\phi(1-\\phi).\n$$\nFrom standard thermodynamics of mixtures, the osmotic pressure $ \\Pi $ follows from the Legendre transform of the free energy density with respect to volume fraction,\n$$\n\\Pi = \\phi \\left(\\frac{\\partial f}{\\partial \\phi}\\right)_{T} - f.\n$$\nTo connect to virial coefficients, we require the dilute expansion of the osmotic pressure in powers of the polymer volume fraction $\\phi$. We first expand the combinatorial entropy term at small $\\phi$ using the Taylor series of the natural logarithm, $\\ln(1-\\phi) = -\\phi - \\phi^{2}/2 - \\phi^{3}/3 - \\cdots$. Then\n$$\n(1-\\phi)\\ln(1-\\phi) = (1-\\phi)\\left(-\\phi - \\frac{\\phi^{2}}{2} - \\frac{\\phi^{3}}{3} - \\cdots \\right) = -\\phi + \\frac{\\phi^{2}}{2} + \\mathcal{O}(\\phi^{3}).\n$$\nHence, keeping terms up to $\\mathcal{O}(\\phi^{2})$,\n$$\n\\frac{f}{k_B T} = \\frac{\\phi}{N}\\ln \\phi - \\phi + \\frac{\\phi^{2}}{2} + \\chi(T)\\,\\phi - \\chi(T)\\,\\phi^{2} + \\mathcal{O}(\\phi^{3}).\n$$\nCollecting coefficients,\n$$\n\\frac{f}{k_B T} = \\frac{\\phi}{N}\\ln \\phi + \\bigl[\\chi(T) - 1\\bigr]\\phi + \\left[\\frac{1}{2} - \\chi(T)\\right]\\phi^{2} + \\mathcal{O}(\\phi^{3}).\n$$\nWe now compute $\\Pi/(k_B T)$ using $\\Pi = \\phi (\\partial f/\\partial \\phi) - f$. First compute the derivative,\n$$\n\\frac{1}{k_B T}\\left(\\frac{\\partial f}{\\partial \\phi}\\right)_{T} = \\frac{1}{N}\\left(\\ln \\phi + 1\\right) + \\bigl[\\chi(T) - 1\\bigr] + 2\\left[\\frac{1}{2} - \\chi(T)\\right]\\phi + \\mathcal{O}(\\phi^{2}).\n$$\nMultiply by $\\phi$,\n$$\n\\frac{\\phi}{k_B T}\\left(\\frac{\\partial f}{\\partial \\phi}\\right)_{T} = \\frac{\\phi}{N}\\ln \\phi + \\frac{\\phi}{N} + \\bigl[\\chi(T) - 1\\bigr]\\phi + \\left[1 - 2\\chi(T)\\right]\\phi^{2} + \\mathcal{O}(\\phi^{3}).\n$$\nSubtract $f/(k_B T)$ to obtain the osmotic pressure in thermal units,\n\\begin{align*}\n\\frac{\\Pi}{k_B T} = \\left(\\frac{\\phi}{N}\\ln \\phi + \\frac{\\phi}{N} + \\bigl[\\chi(T) - 1\\bigr]\\phi + \\left[1 - 2\\chi(T)\\right]\\phi^{2} + \\cdots \\right) \\\\\n\\quad - \\left(\\frac{\\phi}{N}\\ln \\phi + \\bigl[\\chi(T) - 1\\bigr]\\phi + \\left[\\frac{1}{2} - \\chi(T)\\right]\\phi^{2} + \\cdots \\right) \\\\\n= \\frac{\\phi}{N} + \\left(1 - 2\\chi(T) - \\frac{1}{2} + \\chi(T)\\right)\\phi^{2} + \\mathcal{O}(\\phi^{3}) \\\\\n= \\frac{\\phi}{N} + \\left(\\frac{1}{2} - \\chi(T)\\right)\\phi^{2} + \\mathcal{O}(\\phi^{3}).\n\\end{align*}\nThis is the osmotic equation of state to second order in $\\phi$. The coefficient of $\\phi^{2}$ is the reduced second virial coefficient (up to a choice of microscopic volume unit in the lattice model). The $\\theta$-condition is defined as the point where the effective two-body excluded volume vanishes, i.e., the second virial coefficient is zero. Therefore,\n$$\n\\frac{1}{2} - \\chi\\bigl(T_{\\theta}\\bigr) = 0 \\quad \\Longrightarrow \\quad \\chi\\bigl(T_{\\theta}\\bigr) = \\frac{1}{2}.\n$$\nThis establishes the $\\theta$-condition in terms of the FH interaction parameter.\n\nNow impose the empirical temperature dependence\n$$\n\\chi(T) = \\frac{A}{T} + B,\n$$\nwith temperature-independent constants $A$ and $B$. At $T_{\\theta}$ we have\n$$\n\\frac{A}{T_{\\theta}} + B = \\frac{1}{2}.\n$$\nSolving for $T_{\\theta}$ gives the closed-form expression\n$$\nT_{\\theta} = \\frac{A}{\\frac{1}{2} - B} = \\frac{2A}{1 - 2B}.\n$$\n\nFor the specific polymer–solvent pair with $A = 86.0\\,\\mathrm{K}$ and $B = 0.22$, we compute\n$$\nT_{\\theta} = \\frac{2 \\times 86.0}{1 - 2 \\times 0.22}\\ \\mathrm{K} = \\frac{172.0}{1 - 0.44}\\ \\mathrm{K} = \\frac{172.0}{0.56}\\ \\mathrm{K} \\approx 307.142857\\ \\mathrm{K}.\n$$\nRounded to four significant figures, this yields\n$$\nT_{\\theta} \\approx 307.1\\ \\mathrm{K}.\n$$\n\nFinally, we interpret $A$ and $B$ thermodynamically. In mean-field lattice treatments, the interaction parameter can be decomposed as\n$$\n\\chi(T) \\simeq \\frac{\\Delta H_{\\mathrm{mix}}}{k_B T} - \\frac{\\Delta S_{\\mathrm{mix}}^{\\mathrm{nonideal}}}{k_B},\n$$\nwhere $\\Delta H_{\\mathrm{mix}}$ represents contact enthalpy of mixing per lattice site and $\\Delta S_{\\mathrm{mix}}^{\\mathrm{nonideal}}$ encodes noncombinatorial entropy (e.g., local packing, compressibility, and segmental correlations) beyond the ideal combinatorial term already explicit in the FH free energy. Comparing with $\\chi(T) = A/T + B$, we identify $A \\propto \\Delta H_{\\mathrm{mix}}/k_B$ as an enthalpic contribution and $B \\simeq -\\Delta S_{\\mathrm{mix}}^{\\mathrm{nonideal}}/k_B$ as an entropic (temperature-independent) contribution. A positive $A$ signifies enthalpically unfavorable mixing that diminishes with increasing $T$, improving solvent quality at higher temperatures. The sign and magnitude of $B$ shift the baseline of solvent quality independent of $T$. Together, $A$ and $B$ determine $T_{\\theta}$ through $T_{\\theta} = 2A/(1 - 2B)$: larger $A$ raises $T_{\\theta}$, while larger $B$ (holding $A$ fixed) also raises $T_{\\theta}$ by reducing the denominator $1 - 2B$.", "answer": "$$\\boxed{307.1}$$", "id": "2934645"}, {"introduction": "Building upon the foundational theory, this practice [@problem_id:2934650] transitions from pure derivation to practical application, mirroring the challenges encountered in experimental work. Real-world characterization of polymer-solvent systems relies on measured parameters that inevitably carry uncertainty. This exercise challenges you to not only calculate the theta temperature from an empirical model of the interaction parameter $\\chi(T)$, but also to rigorously determine the resulting uncertainty in $T_{\\theta}$ by applying the principles of error propagation, a critical skill in experimental and computational polymer science.", "problem": "A dilute solution of long, flexible polymer coils in a molecular solvent is described at mean-field level by the Flory–Huggins free-energy density per reference volume $v$,\n$$\n\\frac{f(\\phi,T)}{k_{B}T} = \\frac{\\phi}{N}\\ln \\phi + (1-\\phi)\\ln(1-\\phi) + \\chi(T)\\,\\phi\\,(1-\\phi),\n$$\nwhere $\\phi$ is the polymer volume fraction, $N \\gg 1$ is the degree of polymerization, $k_{B}$ is the Boltzmann constant, and $\\chi(T)$ is the Flory–Huggins interaction parameter measured as a function of temperature $T$. The theta condition corresponds to the vanishing of the effective two-body excluded volume of the polymer segments in the solvent. For a polymer–solvent system, experimental analysis yields a temperature-dependent interaction parameter\n$$\n\\chi(T) = \\alpha + \\frac{\\beta}{T},\n$$\nwith $\\alpha = 0.25$ and $\\beta = 150\\ \\mathrm{K}$. The measurement uncertainty of $\\chi$ itself is temperature dependent and is quantified as a one-standard-deviation function\n$$\n\\sigma_{\\chi}(T) = \\sigma_{0} + \\sigma_{1}\\,\\frac{T}{T_{*}},\n$$\nwith $\\sigma_{0} = 2.0\\times 10^{-3}$, $\\sigma_{1} = 1.0\\times 10^{-3}$, and $T_{*} = 300\\ \\mathrm{K}$. Assume $N \\to \\infty$ so that finite-chain corrections to the theta condition can be neglected.\n\nUsing only first principles appropriate to this context, namely the Flory–Huggins free energy and the virial expansion of the osmotic pressure at small $\\phi$, perform the following:\n\n1. Starting from the given free-energy density, obtain the criterion for the theta temperature $T_{\\theta}$ in terms of $\\chi(T)$ by identifying the condition under which the second virial coefficient vanishes.\n2. Using the measured form of $\\chi(T)$ given above, compute the numerical value of $T_{\\theta}$.\n3. Treating the reported $\\sigma_{\\chi}(T)$ as the dominant source of uncertainty and using first-order propagation of uncertainty for the implicit equation that defines $T_{\\theta}$, compute the one-standard-deviation uncertainty $\\sigma_{T_{\\theta}}$ about $T_{\\theta}$. Your propagation must explicitly account for the fact that $\\sigma_{\\chi}$ is a function of temperature and hence should be evaluated at $T_{\\theta}$.\n4. Present your final numerical results for the pair $(T_{\\theta}, \\sigma_{T_{\\theta}})$ as a row vector, rounded to four significant figures. Express both entries in $\\mathrm{K}$.", "solution": "The problem is validated as being scientifically grounded, well-posed, and objective. It is a standard problem in polymer solution theory that can be solved using fundamental principles. All required data are provided, and there are no internal contradictions. We may proceed with the solution.\n\nThe problem requires a three-part calculation: derivation of the theta condition, calculation of the theta temperature $T_{\\theta}$, and determination of its uncertainty $\\sigma_{T_{\\theta}}$.\n\nPart 1: Derivation of the criterion for the theta temperature $T_{\\theta}$.\n\nThe osmotic pressure $\\Pi$ of a polymer solution is related to the chemical potential of the solvent, $\\mu_1$. In the context of Flory-Huggins theory on a lattice where the solvent molecule occupies one site (reference volume $v$), this relation is $\\Pi v = -(\\mu_1 - \\mu_1^0)$, where $\\mu_1^0$ is the chemical potential of the pure solvent. The chemical potential of the solvent in the solution is derived from the Gibbs free energy of mixing. Using the provided free-energy density $f(\\phi, T)$, the chemical potential difference is given by:\n$$\n\\frac{\\mu_1 - \\mu_1^0}{k_B T} = \\frac{f}{k_B T} - \\phi\\frac{\\partial}{\\partial\\phi}\\left(\\frac{f}{k_B T}\\right)\n$$\nThe dimensionless free-energy density is given as:\n$$\n\\frac{f(\\phi,T)}{k_{B}T} = \\frac{\\phi}{N}\\ln \\phi + (1-\\phi)\\ln(1-\\phi) + \\chi(T)\\,\\phi\\,(1-\\phi)\n$$\nFirst, we must compute the derivative with respect to the polymer volume fraction $\\phi$:\n$$\n\\frac{\\partial}{\\partial\\phi}\\left(\\frac{f}{k_B T}\\right) = \\left(\\frac{1}{N}\\ln\\phi + \\frac{1}{N}\\right) - \\left(\\ln(1-\\phi) + 1\\right) + \\chi(T)(1 - 2\\phi)\n$$\nSubstituting these expressions into the formula for the chemical potential gives:\n$$\n\\frac{\\mu_1 - \\mu_1^0}{k_B T} = \\left[\\frac{\\phi}{N}\\ln \\phi + (1-\\phi)\\ln(1-\\phi) + \\chi\\phi(1-\\phi)\\right] - \\phi\\left[\\frac{1}{N}\\ln\\phi + \\frac{1}{N} - \\ln(1-\\phi) - 1 + \\chi(1-2\\phi)\\right]\n$$\nSimplifying this expression yields the standard result for the solvent chemical potential in Flory-Huggins theory:\n$$\n\\frac{\\mu_1 - \\mu_1^0}{k_B T} = \\ln(1-\\phi) + \\left(1-\\frac{1}{N}\\right)\\phi + \\chi\\phi^2\n$$\nThe osmotic pressure is then:\n$$\n\\frac{\\Pi v}{k_B T} = -\\left[\\ln(1-\\phi) + \\left(1-\\frac{1}{N}\\right)\\phi + \\chi\\phi^2\\right]\n$$\nTo find the second virial coefficient, we perform a Taylor expansion of this expression for small volume fraction $\\phi \\ll 1$. The logarithmic term is expanded as $\\ln(1-\\phi) = -\\phi - \\frac{\\phi^2}{2} - \\frac{\\phi^3}{3} - \\dots$.\nSubstituting this series into the expression for $\\Pi$:\n$$\n\\frac{\\Pi v}{k_B T} = -\\left[\\left(-\\phi - \\frac{\\phi^2}{2} - \\frac{\\phi^3}{3} - \\dots\\right) + \\left(1-\\frac{1}{N}\\right)\\phi + \\chi\\phi^2\\right]\n$$\n$$\n\\frac{\\Pi v}{k_B T} = -\\left[-\\frac{\\phi}{N} + \\left(\\chi - \\frac{1}{2}\\right)\\phi^2 - \\frac{\\phi^3}{3} - \\dots\\right]\n$$\n$$\n\\frac{\\Pi v}{k_B T} = \\frac{\\phi}{N} + \\left(\\frac{1}{2} - \\chi\\right)\\phi^2 + \\frac{\\phi^3}{3} + \\dots\n$$\nThis is the virial expansion of the osmotic pressure in terms of the polymer volume fraction $\\phi$. The second virial coefficient, $A_2$, is proportional to the coefficient of the $\\phi^2$ term. The theta condition is defined as the state where the polymer chains behave as ideal, non-interacting coils on large length scales. This corresponds to the vanishing of the second virial coefficient, which quantifies the effective two-body interaction. The problem states we can neglect finite-chain corrections by taking $N \\to \\infty$, which is the standard definition of the theta point.\nThe condition $A_2 = 0$ implies that the coefficient of the $\\phi^2$ term must be zero. Thus, the criterion for the theta temperature $T_{\\theta}$ is:\n$$\n\\frac{1}{2} - \\chi(T_{\\theta}) = 0 \\implies \\chi(T_{\\theta}) = \\frac{1}{2}\n$$\n\nPart 2: Calculation of the theta temperature $T_{\\theta}$.\n\nWe are given the temperature dependence of the Flory-Huggins parameter:\n$$\n\\chi(T) = \\alpha + \\frac{\\beta}{T}\n$$\nwith constants $\\alpha = 0.25$ and $\\beta = 150\\ \\mathrm{K}$. Applying the theta criterion $\\chi(T_\\theta) = 1/2$:\n$$\n\\alpha + \\frac{\\beta}{T_{\\theta}} = \\frac{1}{2}\n$$\nSubstituting the given numerical values:\n$$\n0.25 + \\frac{150\\ \\mathrm{K}}{T_{\\theta}} = 0.5\n$$\nSolving for $T_{\\theta}$:\n$$\n\\frac{150\\ \\mathrm{K}}{T_{\\theta}} = 0.5 - 0.25 = 0.25\n$$\n$$\nT_{\\theta} = \\frac{150\\ \\mathrm{K}}{0.25} = 600\\ \\mathrm{K}\n$$\n\nPart 3: Calculation of the uncertainty $\\sigma_{T_{\\theta}}$.\n\nThe uncertainty in $T_{\\theta}$ arises from the uncertainty in the measurement of $\\chi(T)$, denoted by $\\sigma_{\\chi}(T)$. We use first-order propagation of uncertainty. The relationship between $T$ and $\\chi$ can be written as:\n$$\nT(\\chi) = \\frac{\\beta}{\\chi - \\alpha}\n$$\nThe uncertainty in $T_{\\theta}$ is related to the uncertainty in $\\chi$ evaluated at the theta condition, i.e., at $\\chi = 1/2$ and $T=T_{\\theta}$. The propagation formula is:\n$$\n\\sigma_{T_{\\theta}}^2 = \\left( \\left. \\frac{dT}{d\\chi} \\right|_{\\chi=1/2} \\right)^2 \\sigma_{\\chi}^2(T_{\\theta})\n$$\nFirst, we compute the derivative:\n$$\n\\frac{dT}{d\\chi} = \\frac{d}{d\\chi}\\left(\\frac{\\beta}{\\chi - \\alpha}\\right) = -\\frac{\\beta}{(\\chi - \\alpha)^2}\n$$\nAt the theta point, we have $\\chi - \\alpha = 1/2 - \\alpha = \\beta/T_{\\theta}$. Substituting this into the derivative:\n$$\n\\left. \\frac{dT}{d\\chi} \\right|_{\\chi=1/2} = -\\frac{\\beta}{(\\beta/T_{\\theta})^2} = -\\frac{\\beta T_{\\theta}^2}{\\beta^2} = -\\frac{T_{\\theta}^2}{\\beta}\n$$\nThe uncertainty in $T_{\\theta}$ is therefore given by:\n$$\n\\sigma_{T_{\\theta}} = \\left| -\\frac{T_{\\theta}^2}{\\beta} \\right| \\sigma_{\\chi}(T_{\\theta}) = \\frac{T_{\\theta}^2}{\\beta} \\sigma_{\\chi}(T_{\\theta})\n$$\nWe are given the function for the uncertainty in $\\chi$:\n$$\n\\sigma_{\\chi}(T) = \\sigma_{0} + \\sigma_{1}\\,\\frac{T}{T_{*}}\n$$\nwith $\\sigma_{0} = 2.0\\times 10^{-3}$, $\\sigma_{1} = 1.0\\times 10^{-3}$, and $T_{*} = 300\\ \\mathrm{K}$. We must evaluate this at $T = T_{\\theta} = 600\\ \\mathrm{K}$.\n$$\n\\sigma_{\\chi}(600\\ \\mathrm{K}) = 2.0\\times 10^{-3} + (1.0\\times 10^{-3})\\frac{600\\ \\mathrm{K}}{300\\ \\mathrm{K}} = 2.0\\times 10^{-3} + 2.0\\times 10^{-3} = 4.0\\times 10^{-3}\n$$\nNow, substitute all values into the expression for $\\sigma_{T_{\\theta}}$:\n$$\n\\sigma_{T_{\\theta}} = \\frac{(600\\ \\mathrm{K})^2}{150\\ \\mathrm{K}} \\left(4.0\\times 10^{-3}\\right)\n$$\n$$\n\\sigma_{T_{\\theta}} = \\frac{360000\\ \\mathrm{K^2}}{150\\ \\mathrm{K}} \\left(4.0\\times 10^{-3}\\right) = 2400\\ \\mathrm{K} \\left(4.0\\times 10^{-3}\\right) = 9.6\\ \\mathrm{K}\n$$\n\nPart 4: Final numerical results.\n\nThe problem requires the results for $T_{\\theta}$ and $\\sigma_{T_{\\theta}}$ to be presented as a row vector, with both values rounded to four significant figures.\n$T_{\\theta} = 600\\ \\mathrm{K}$, which to four significant figures is $600.0\\ \\mathrm{K}$.\n$\\sigma_{T_{\\theta}} = 9.6\\ \\mathrm{K}$, which to four significant figures is $9.600\\ \\mathrm{K}$.\nThe final result is the pair $(T_{\\theta}, \\sigma_{T_{\\theta}}) = (600.0\\ \\mathrm{K}, 9.600\\ \\mathrm{K})$.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n600.0  9.600\n\\end{pmatrix}\n}\n$$", "id": "2934650"}, {"introduction": "This final practice [@problem_id:2934617] introduces a powerful, modern approach to determining the theta condition through the lens of computational statistical mechanics. Computer simulations allow us to directly probe the effective interactions between polymer coils, which are encoded in the pair distribution function, $g(r)$. This exercise requires you to develop and implement a numerical workflow that connects the theoretical definition of the second virial coefficient to a model for $g(r)$, using numerical integration and root-finding algorithms to pinpoint $T_{\\theta}$. It is a hands-on experience in bridging fundamental theory with computational implementation, essential for the modern polymer scientist.", "problem": "You are asked to formalize and implement, from first principles, a procedure to determine the theta temperature, denoted by $T_{\\theta}$, for long polymer chains by computing the second virial coefficient from a pair distribution function. Your derivation must start from core definitions in statistical mechanics and polymer solution thermodynamics and must not assume any specialized formula as given. You will then implement the derived computation as a program.\n\nConsider a dilute solution of very long polymer chains, where the relevant pair correlation for the effective interaction between the centers of mass of two coils is the pair distribution function $g(r \\mid T)$ at temperature $T$. Assume an isotropic effective interaction so that $g(r \\mid T)$ depends only on the scalar separation $r$. The theta temperature $T_{\\theta}$ is defined as the temperature at which the second virial coefficient of the effective two-coil interaction vanishes in the long-chain limit. Equivalently, at $T_{\\theta}$ the net excluded volume effect cancels the attractive contributions so that the leading departure from ideality is zero.\n\nIn simulation practice, $g(r \\mid T)$ can be measured using a Monte Carlo protocol on long chains that combines global and local moves (e.g., pivot moves and configurational-bias regrowth moves) to equilibrate single-chain conformations and two-chain relative positions in the dilute regime. The objective of this problem is not to build the full simulation, but to derive and implement the computation that maps $g(r \\mid T)$ to the second virial coefficient and then to $T_{\\theta}$.\n\nTo make the problem universally computable, suppose that the measured $g(r \\mid T)$ is well represented by the following reduced model, which captures the temperature dependence of solvent quality near $T_{\\theta}$ for long coils:\n- The reduced potential of mean force $u(r;T)$ is defined via $g(r \\mid T) = \\exp[-u(r;T)]$.\n- For all test cases below, take $u(r;T) = a(T) \\exp\\!\\left[-\\left(\\dfrac{r}{R}\\right)^{2}\\right]$, where $R$ is a positive length scale proportional to the coil size and $a(T)$ is a scalar amplitude that varies linearly with $T$ according to $a(T) = a_{0} + a_{1} (T - T_{0})$.\n- The dimensionless reduced second virial coefficient is defined as $A_{2}^{\\ast}(T) \\equiv \\dfrac{B_{2}(T)}{(4\\pi/3) R^{3}}$, where $B_{2}(T)$ is the ordinary second virial coefficient of the effective isotropic interaction. The theta condition is $A_{2}^{\\ast}(T_{\\theta}) = 0$.\n\nTasks:\n1. Starting from the core definitions of the potential of mean force and the Mayer $f$-function for an isotropic pair correlation, derive an explicit expression for $A_{2}^{\\ast}(T)$ in terms of $g(r \\mid T)$ for the model given above. You must justify each step using fundamental definitions and standard statistical mechanics identities, not by quoting the target expression.\n2. Using your derived expression, design a robust numerical algorithm that, given parameters $(R, a_{0}, a_{1}, T_{0})$ and a temperature bracket $[T_{\\min}, T_{\\max}]$ known to contain $T_{\\theta}$, computes $A_{2}^{\\ast}(T)$ by numerical quadrature and then determines $T_{\\theta}$ as the unique root of $A_{2}^{\\ast}(T) = 0$ within the bracket. Your algorithm must:\n   - Evaluate any required integrals to high accuracy with explicit error control.\n   - Use a bracketed root-finding method guaranteed to converge when a sign change is present.\n   - Correctly handle the boundary case when the root coincides with $T_{\\min}$ or $T_{\\max}$.\n3. Implement the algorithm as a program that, for each of the test cases below, outputs $T_{\\theta}$ in Kelvin. Express each numerical answer in $\\mathrm{K}$, rounded to three decimal digits.\n\nTest suite:\nProvide results for the following three independent parameter sets, each with temperatures in Kelvin and lengths in nanometers (you may treat $R$ as an external length scale; ensure dimensional consistency in your derivation by using the reduced, dimensionless $A_{2}^{\\ast}$):\n- Case $1$ (general interior root): $R = 15\\,\\mathrm{nm}$, $a_{0} = 1.2$, $a_{1} = -0.01\\,\\mathrm{K}^{-1}$, $T_{0} = 300\\,\\mathrm{K}$, $T_{\\min} = 350\\,\\mathrm{K}$, $T_{\\max} = 500\\,\\mathrm{K}$.\n- Case $2$ (boundary root at lower bracket): $R = 12\\,\\mathrm{nm}$, $a_{0} = 0.5$, $a_{1} = 0.02\\,\\mathrm{K}^{-1}$, $T_{0} = 300\\,\\mathrm{K}$, $T_{\\min} = 275\\,\\mathrm{K}$, $T_{\\max} = 350\\,\\mathrm{K}$.\n- Case $3$ (shallow crossing): $R = 20\\,\\mathrm{nm}$, $a_{0} = 0.02$, $a_{1} = -1.0\\times 10^{-4}\\,\\mathrm{K}^{-1}$, $T_{0} = 300\\,\\mathrm{K}$, $T_{\\min} = 450\\,\\mathrm{K}$, $T_{\\max} = 550\\,\\mathrm{K}$.\n\nFinal output format:\nYour program should produce a single line of output containing the three computed values of $T_{\\theta}$, in Kelvin, rounded to three decimal digits, as a comma-separated list enclosed in square brackets (e.g., $[420.000,275.000,500.000]$). No other output is permitted.\n\nAngle units are not used. Percentages are not used. All numeric values must be reported as decimal numbers without a percent sign. All physical outputs that carry a unit must be reported in the unit specified above, i.e., $\\mathrm{K}$ for temperatures.", "solution": "The problem is valid as it is scientifically grounded in the principles of polymer solution thermodynamics and statistical mechanics, is well-posed with sufficient information for a unique solution, and is expressed in objective, formal language. We will proceed with a full derivation and solution.\n\nThe task is to determine the theta temperature, $T_{\\theta}$, for a model of interacting polymer coils. The theta temperature is defined as the temperature at which the second virial coefficient, $B_{2}(T)$, of the effective interaction between polymer coils vanishes. We are given a model for the pair distribution function $g(r \\mid T)$ and are required to derive the expression for $B_{2}(T)$, formulate the condition for $T_{\\theta}$, and implement a numerical solution.\n\nFirst, we begin from the fundamental definition of the second virial coefficient in statistical mechanics for a system with a spherically symmetric, pairwise-additive potential of mean force, $W(r)$. The definition is given by the cluster integral:\n$$ B_{2}(T) = -\\frac{1}{2} \\int (\\exp[-\\beta W(r)] - 1) d\\mathbf{r} $$\nwhere $\\beta = (k_{B}T)^{-1}$ with $k_{B}$ being the Boltzmann constant, and the integration is over all space. For a spherically symmetric potential, this simplifies to:\n$$ B_{2}(T) = -\\frac{1}{2} \\int_{0}^{\\infty} (\\exp[-\\beta W(r)] - 1) 4\\pi r^{2} dr = -2\\pi \\int_{0}^{\\infty} (\\exp[-\\beta W(r)] - 1) r^{2} dr $$\n\nThe pair distribution function, $g(r \\mid T)$, is related to the potential of mean force $W(r)$ by the definition $g(r \\mid T) = \\exp[-\\beta W(r)]$. The problem provides a reduced, dimensionless potential of mean force, $u(r;T)$, such that $g(r \\mid T) = \\exp[-u(r;T)]$. By comparison, we see that $u(r;T) = \\beta W(r)$. We can therefore express $B_{2}(T)$ directly in terms of the given $g(r \\mid T)$:\n$$ B_{2}(T) = -2\\pi \\int_{0}^{\\infty} [g(r \\mid T) - 1] r^{2} dr $$\n\nThe problem specifies the functional form for $u(r;T)$:\n$$ u(r;T) = a(T) \\exp\\left[-\\left(\\frac{r}{R}\\right)^{2}\\right] $$\nwhere $R$ is a characteristic length scale of the polymer coil and $a(T)$ is a temperature-dependent amplitude given by $a(T) = a_{0} + a_{1} (T - T_{0})$. Consequently, the pair distribution function is:\n$$ g(r \\mid T) = \\exp\\left[-a(T)\\exp\\left(-\\left(\\frac{r}{R}\\right)^{2}\\right)\\right] $$\nSubstituting this into the expression for $B_{2}(T)$, we obtain:\n$$ B_{2}(T) = -2\\pi \\int_{0}^{\\infty} \\left\\{ \\exp\\left[-a(T)\\exp\\left(-\\left(\\frac{r}{R}\\right)^{2}\\right)\\right] - 1 \\right\\} r^{2} dr $$\n\nThe problem asks for the computation of the reduced, dimensionless second virial coefficient, $A_{2}^{\\ast}(T)$, defined as:\n$$ A_{2}^{\\ast}(T) = \\frac{B_{2}(T)}{\\frac{4\\pi}{3} R^{3}} $$\nThis dimensionless form is convenient as it removes explicit dependence on the coil size $R$. To show this, we perform a change of variables in the integral for $B_{2}(T)$. Let the dimensionless separation be $x = r/R$. Then $r = xR$ and $dr = R\\,dx$.\n$$ B_{2}(T) = -2\\pi \\int_{0}^{\\infty} \\left\\{ \\exp[-a(T)\\exp(-x^{2})] - 1 \\right\\} (xR)^{2} (R\\,dx) $$\n$$ B_{2}(T) = -2\\pi R^{3} \\int_{0}^{\\infty} x^{2} \\left\\{ \\exp[-a(T)\\exp(-x^{2})] - 1 \\right\\} dx $$\nNow, substituting this into the definition of $A_{2}^{\\ast}(T)$:\n$$ A_{2}^{\\ast}(T) = \\frac{-2\\pi R^{3} \\int_{0}^{\\infty} x^{2} \\left\\{ \\exp[-a(T)\\exp(-x^{2})] - 1 \\right\\} dx}{\\frac{4\\pi}{3} R^{3}} $$\nThe term $R^{3}$ cancels, yielding the final expression for the reduced second virial coefficient, which is independent of $R$:\n$$ A_{2}^{\\ast}(T) = -\\frac{3}{2} \\int_{0}^{\\infty} x^{2} \\left\\{ \\exp[-a(T)\\exp(-x^{2})] - 1 \\right\\} dx $$\nThis is the central equation for our numerical procedure. The theta temperature $T_{\\theta}$ is the temperature at which polymer-solvent interactions are such that the effective coil-coil interactions vanish on average. This corresponds to the condition $A_{2}^{\\ast}(T_{\\theta}) = 0$. This implies that the integral itself must be zero:\n$$ \\int_{0}^{\\infty} x^{2} \\left\\{ \\exp[-a(T_{\\theta})\\exp(-x^{2})] - 1 \\right\\} dx = 0 $$\n\nThe numerical algorithm to find $T_{\\theta}$ proceeds as follows:\n$1$. We must implement a function that calculates $A_{2}^{\\ast}(T)$ for any given temperature $T$ using the provided parameters $(a_{0}, a_{1}, T_{0})$.\n$2$. This function will first compute $a(T) = a_{0} + a_{1}(T - T_{0})$.\n$3$. Then, it will evaluate the definite integral numerically. The integrand, $f(x, a) = x^{2} (\\exp[-a\\exp(-x^{2})] - 1)$, decays rapidly to zero as $x \\to \\infty$, making it suitable for high-accuracy numerical quadrature over the interval $[0, \\infty)$. We will use a standard library routine such as `scipy.integrate.quad` for this purpose, which can handle infinite integration limits and provides error estimates.\n$4$. The result of the integration is then multiplied by the prefactor $-\\frac{3}{2}$ to obtain $A_{2}^{\\ast}(T)$.\n\nOnce we have the function $A_{2}^{\\ast}(T)$, we must find the root $T_{\\theta}$ that satisfies $A_{2}^{\\ast}(T_{\\theta}) = 0$ within the given temperature bracket $[T_{\\min}, T_{\\max}]$.\n$1$. A robust, bracketed root-finding method is required. We will use the Brent-Dekker method, available as `scipy.optimize.brentq`. This method is guaranteed to converge provided that the function values at the endpoints of the bracket, $A_{2}^{\\ast}(T_{\\min})$ and $A_{2}^{\\ast}(T_{\\max})$, have opposite signs.\n$2$. The problem requires correct handling of boundary cases. We will first explicitly check if $A_{2}^{\\ast}(T_{\\min}) = 0$ or $A_{2}^{\\ast}(T_{\\max}) = 0$. If so, the root is one of the boundaries. Otherwise, we verify that $A_{2}^{\\ast}(T_{\\min}) \\cdot A_{2}^{\\ast}(T_{\\max})  0$ and proceed with the `brentq` algorithm.\n\nIt is worth noting that for the specific functional form given, the integrand $x^{2} \\left\\{ \\exp[-a(T)\\exp(-x^{2})] - 1 \\right\\}$ is strictly positive if $a(T)  0$, strictly negative if $a(T)  0$, and zero everywhere if $a(T) = 0$. Consequently, the integral is zero if and only if $a(T) = 0$. Thus, $T_{\\theta}$ could be found analytically by solving $a_{0} + a_{1} (T_{\\theta} - T_{0}) = 0$, which gives $T_{\\theta} = T_{0} - a_{0}/a_{1}$. However, the problem explicitly instructs us to design and implement the full numerical procedure involving quadrature and root-finding, which is what we will do. The analytical result serves as a verification of our numerical implementation.\n\nThe implementation will process each test case by defining the function for $A_2^*(T)$ with the corresponding parameters, and then applying the root-finding logic within the specified temperature bracket. The final results will be rounded to three decimal digits as required.", "answer": "$$\\boxed{[420.000, 275.000, 500.000]}$$", "id": "2934617"}]}