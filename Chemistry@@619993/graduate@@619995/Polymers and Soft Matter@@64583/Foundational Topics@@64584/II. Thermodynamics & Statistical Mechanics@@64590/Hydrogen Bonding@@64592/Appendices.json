{"hands_on_practices": [{"introduction": "The strength of a hydrogen bond, like any chemical bond, is determined by its underlying interaction potential. This exercise provides a fundamental hands-on experience in connecting a descriptive mathematical model, the Buckingham potential $V(r)$, to a core physical observable: the bond dissociation energy $D_e$. By analyzing this simplified potential, you will practice the essential skill of deriving macroscopic energy parameters from the microscopic forces governing molecular interactions, a foundational concept in physical chemistry and materials science [@problem_id:123622].", "id": "123622", "problem": "A simplified one-dimensional model for the interaction potential between two atoms forming a hydrogen bond is given by the Buckingham potential:\n$$V(r) = A e^{-Br} - \\frac{C}{r^6}$$\nwhere $r$ is the distance between the atomic nuclei. The first term represents the short-range Pauli repulsion, and the second term represents the long-range attractive interaction (van der Waals or dipole-dipole). The parameters $A$, $B$, and $C$ are positive constants specific to the interacting atoms.\n\nAssume that for a particular diatomic system, the equilibrium separation between the atoms is measured to be $r_0$. The parameters $B$ and $C$ of the potential are also known. The parameter $A$ is not given directly, as it is implicitly determined by the equilibrium condition of the system.\n\nAssuming the potential is zero at infinite separation, $V(r \\to \\infty) = 0$, determine the bond dissociation energy, $D_e$. Express your answer in terms of the known quantities $r_0$, $B$, and $C$.\n\n", "solution": "The Buckingham potential is given by:\n$$V(r) = A e^{-Br} - \\frac{C}{r^6}$$\nAt equilibrium separation $r_0$, the derivative of the potential with respect to $r$ is zero:\n$$\\left. \\frac{dV}{dr} \\right|_{r=r_0} = 0$$\nCompute the derivative:\n$$\\frac{dV}{dr} = -A B e^{-Br} + \\frac{6C}{r^7}$$\nSet it to zero at $r = r_0$:\n$$-A B e^{-B r_0} + \\frac{6C}{r_0^7} = 0$$\nSolve for $A$:\n$$A B e^{-B r_0} = \\frac{6C}{r_0^7}$$\n$$A = \\frac{6C}{B r_0^7} e^{B r_0}$$\nThe bond dissociation energy $D_e$ is the depth of the potential well. Given $V(r \\to \\infty) = 0$, we have:\n$$D_e = - V(r_0)$$\nSubstitute $r = r_0$ into the potential:\n$$V(r_0) = A e^{-B r_0} - \\frac{C}{r_0^6}$$\nSubstitute the expression for $A$:\n$$V(r_0) = \\left( \\frac{6C}{B r_0^7} e^{B r_0} \\right) e^{-B r_0} - \\frac{C}{r_0^6} = \\frac{6C}{B r_0^7} - \\frac{C}{r_0^6}$$\nTherefore:\n$$D_e = - \\left( \\frac{6C}{B r_0^7} - \\frac{C}{r_0^6} \\right) = \\frac{C}{r_0^6} - \\frac{6C}{B r_0^7}$$\nFactor out $\\frac{C}{r_0^6}$:\n$$D_e = \\frac{C}{r_0^6} \\left(1 - \\frac{6}{B r_0}\\right)$$\nThis expresses $D_e$ in terms of the known quantities $r_0$, $B$, and $C$.", "answer": "$$\\boxed{ \\dfrac{C}{r_0^6} \\left(1 - \\dfrac{6}{B r_0}\\right) }$$"}, {"introduction": "In condensed phases, the collective arrangement of hydrogen bonds dictates material properties. This practice moves beyond a single bond to explore the statistical consequences of local bonding constraints in a network, as described by the famous Bernal-Fowler ice rules. By applying the powerful transfer matrix method to a model system, you will quantify the vast number of allowed proton configurations, directly connecting microscopic rules to the macroscopic concept of residual entropy [@problem_id:123520]. This exercise is a classic introduction to the statistical mechanics of frustrated systems, which are central to understanding polymers, glasses, and other soft materials.", "id": "123520", "problem": "In crystalline ice, the arrangement of hydrogen atoms (protons) is governed by the Bernal-Fowler ice rules:\n1. Every oxygen atom is covalently bonded to exactly two hydrogen atoms.\n2. Every hydrogen bond, which connects two oxygen atoms, contains exactly one hydrogen atom.\n\nThese rules lead to a large number of possible proton configurations, giving rise to a residual entropy at zero temperature.\n\nConsider a simplified model for a structural motif found in some ice polymorphs or clathrates. The structure consists of a closed ring of $N$ oxygen atoms. Each oxygen atom, $O_i$ (for $i=1, \\dots, N$), is tetrahedrally coordinated. Two of its four hydrogen bonds link it to its neighbors, $O_{i-1}$ and $O_{i+1}$, within the ring (with periodic boundary conditions, i.e., $O_{N+1} \\equiv O_1$). The other two hydrogen bonds for each oxygen atom connect to the rest of the crystal lattice, which we can consider as an external environment.\n\nFor a ring of $N=10$ oxygen atoms, determine the total number of allowed proton configurations that are consistent with the Bernal-Fowler ice rules.\n\n", "solution": "The Bernal-Fowler ice rules require:\n1. Each oxygen atom has exactly two covalently bonded hydrogen atoms.\n2. Each hydrogen bond contains exactly one hydrogen atom.\n\nFor a ring of $N$ oxygen atoms, each oxygen $O_i$ ($i = 1, \\dots, N$) has:\n- Two ring bonds: left bond to $O_{i-1}$ (with periodic boundary, $O_0 \\equiv O_N$) and right bond to $O_{i+1}$ ($O_{N+1} \\equiv O_1$).\n- Two external bonds to the environment.\n\nDefine $L_i$ as:\n\n$$\nL_i = \\begin{cases} \n1 & \\text{if } O_i \\text{ owns the proton in the left ring bond (to } O_{i-1}\\text{)}, \\\\\n0 & \\text{if } O_{i-1} \\text{ owns the proton}.\n\\end{cases}\n$$\n\nThe ownership of the right ring bond (to $O_{i+1}$) is constrained by the ice rules: if $O_i$ owns the proton, $O_{i+1}$ cannot, and vice versa. Thus:\n\n$$\nR_i = 1 - L_{i+1},\n$$\n\nwhere $R_i$ indicates ownership by $O_i$ of the right bond.\n\nEach oxygen must own exactly two protons in total. The protons owned by $O_i$ come from:\n- Left ring bond: $L_i$,\n- Right ring bond: $R_i = 1 - L_{i+1}$,\n- Two external bonds: let $E_{i1}, E_{i2} \\in \\{0,1\\}$ indicate ownership by $O_i$.\n\nThe equation is:\n\n$$\nL_i + (1 - L_{i+1}) + E_{i1} + E_{i2} = 2,\n$$\n\nwhich simplifies to:\n\n$$\nL_i - L_{i+1} + s_i = 1, \\quad s_i = E_{i1} + E_{i2}, \\quad s_i \\in \\{0,1,2\\}.\n$$\n\nSince $L_i, L_{i+1} \\in \\{0,1\\}$, $L_i - L_{i+1} \\in \\{-1,0,1\\}$, and $s_i = 1 - L_i + L_{i+1}$ is always in $\\{0,1,2\\}$. The number of ways to assign the external bonds for given $s_i$ is:\n\n$$\nw(s_i) = \\begin{cases} \n1 & \\text{if } s_i = 0 \\text{ or } s_i = 2, \\\\\n2 & \\text{if } s_i = 1.\n\\end{cases}\n$$\n\nThus, $w(1 - L_i + L_{i+1})$ depends only on $L_i$ and $L_{i+1}$.\n\nThe transfer matrix $T$ for states of $L_i$ and $L_{i+1}$ is:\n\n$$\nT = \\begin{pmatrix}\nT_{00} & T_{01} \\\\\nT_{10} & T_{11}\n\\end{pmatrix}, \\quad \\text{where} \\quad T_{ab} = w(1 - a + b) \\quad \\text{for} \\quad a,b \\in \\{0,1\\}.\n$$\n\nCompute entries:\n- $a=0, b=0$: $s_i = 1 - 0 + 0 = 1$, $w(1) = 2$ → $T_{00} = 2$,\n- $a=0, b=1$: $s_i = 1 - 0 + 1 = 2$, $w(2) = 1$ → $T_{01} = 1$,\n- $a=1, b=0$: $s_i = 1 - 1 + 0 = 0$, $w(0) = 1$ → $T_{10} = 1$,\n- $a=1, b=1$: $s_i = 1 - 1 + 1 = 1$, $w(1) = 2$ → $T_{11} = 2$.\n\nSo:\n\n$$\nT = \\begin{pmatrix}\n2 & 1 \\\\\n1 & 2\n\\end{pmatrix}.\n$$\n\n\nThe number of configurations for the ring with periodic boundaries is $\\operatorname{Tr}(T^N)$. The eigenvalues of $T$ satisfy:\n\n$$\n\\det(T - \\lambda I) = \\det\\begin{pmatrix} 2 - \\lambda & 1 \\\\ 1 & 2 - \\lambda \\end{pmatrix} = (2 - \\lambda)^2 - 1 = \\lambda^2 - 4\\lambda + 3 = 0.\n$$\n\nSolutions:\n\n$$\n\\lambda = \\frac{4 \\pm \\sqrt{16 - 12}}{2} = \\frac{4 \\pm 2}{2} \\implies \\lambda_1 = 3, \\lambda_2 = 1.\n$$\n\nThus:\n\n$$\n\\operatorname{Tr}(T^N) = \\lambda_1^N + \\lambda_2^N = 3^N + 1^N = 3^N + 1.\n$$\n\n\nFor $N = 10$:\n\n$$\n3^{10} = 59049, \\quad 3^{10} + 1 = 59050.\n$$\n\nThis is the total number of allowed proton configurations, including ring and external bonds.", "answer": "$$\\boxed{59050}$$"}, {"introduction": "Quantifying the precise contribution of hydrogen bonding to a system's stability is a key task in modern computational soft matter physics. This advanced practice introduces thermodynamic integration, a powerful simulation technique that calculates free energy differences along a hypothetical \"alchemical\" path. By processing simulated data from a system where hydrogen bonds are gradually \"turned off\" via a coupling parameter $\\lambda$, you will compute the free energy change $\\Delta F$ and decompose it into its enthalpic and entropic contributions, providing deep insight into the thermodynamic driving forces at play [@problem_id:2773869]. This exercise bridges the gap between fundamental statistical mechanics and the practical methods used in cutting-edge computational research.", "id": "2773869", "problem": "Consider an isothermal canonical ensemble at temperature $T$ for a nanoscale interfacial system where a hydrogen-bonding interaction between an adsorbate and a surrounding fluid is modulated via an alchemical coupling parameter $\\lambda \\in [0,1]$. The potential energy is decomposed as $U(\\lambda) = U_{\\text{nonhb}} + s(\\lambda)\\,U_{\\text{hb}}$, where $U_{\\text{nonhb}}$ is the $\\lambda$-independent part of the force field and $U_{\\text{hb}}$ is the hydrogen-bond interaction energy term. The coupling schedule $s(\\lambda)$ satisfies $s(1)=1$ and $s(0)=0$, so that $\\lambda=1$ corresponds to the fully interacting hydrogen-bond state and $\\lambda=0$ corresponds to hydrogen bonding turned off. The Helmholtz free energy is defined by $F(\\lambda) = -k_{\\mathrm{B}} T \\ln Z(\\lambda)$, where $Z(\\lambda)$ is the canonical partition function at $\\lambda$. The goal is to compute the free energy change for turning off hydrogen bonding, $\\Delta F_{\\text{off}} = F(0)-F(1)$, and then interpret it in terms of enthalpy and entropy contributions. Work from first principles using the definition of the canonical partition function and the dependence of $U(\\lambda)$ on $\\lambda$ to derive a computable expression for $\\Delta F_{\\text{off}}$ and an algorithm to evaluate it numerically from ensemble averages. Use only the provided observable averages and the specified coupling schedules without introducing any additional assumptions beyond the fundamental definitions.\n\nYour program must, for each test case, compute:\n- The Helmholtz free energy change for turning off hydrogen bonding, $\\Delta F_{\\text{off}}$ (in kJ/mol).\n- The corresponding internal energy change $\\Delta U_{\\text{off}} = \\langle U_{\\text{tot}} \\rangle_{\\lambda=0} - \\langle U_{\\text{tot}} \\rangle_{\\lambda=1}$ (in kJ/mol), where $\\langle U_{\\text{tot}} \\rangle_{\\lambda}$ is the ensemble-averaged total potential energy at fixed $\\lambda$.\n- The entropy change $\\Delta S_{\\text{off}}$ defined by $\\Delta F_{\\text{off}} = \\Delta U_{\\text{off}} - T\\,\\Delta S_{\\text{off}}$ (in kJ/(mol·K)).\n\nAll numerical answers must be expressed in the specified units and rounded to three decimal places.\n\nYou are given discrete $\\lambda$-grids, the corresponding ensemble averages $\\langle U_{\\text{hb}} \\rangle_{\\lambda}$ (in kJ/mol), the endpoint averages $\\langle U_{\\text{tot}} \\rangle_{\\lambda=0}$ and $\\langle U_{\\text{tot}} \\rangle_{\\lambda=1}$ (in kJ/mol), and the coupling schedule $s(\\lambda)$. Use a quadrature scheme that is valid for equally spaced $\\lambda$-grids with an even number of subintervals to evaluate any $\\lambda$-integrals that arise from your derivation. Assume the sampling at each $\\lambda$ is equilibrated and sufficiently converged for quadrature.\n\nTest suite (four cases):\n\nCase A (happy path, linear coupling):\n- Temperature $T = 298.0\\,\\mathrm{K}$.\n- Coupling schedule $s(\\lambda) = \\lambda$ for $\\lambda \\in [0,1]$.\n- $\\lambda$-grid: $[0.0,\\,0.1,\\,0.2,\\,0.3,\\,0.4,\\,0.5,\\,0.6,\\,0.7,\\,0.8,\\,0.9,\\,1.0]$.\n- $\\langle U_{\\text{hb}} \\rangle_{\\lambda}$ (kJ/mol): $[-0.2,\\,-1.8,\\,-3.5,\\,-5.0,\\,-6.5,\\,-8.0,\\,-9.3,\\,-10.6,\\,-11.9,\\,-13.2,\\,-14.5]$.\n- $\\langle U_{\\text{tot}} \\rangle_{\\lambda=0} = -250.0\\,\\mathrm{kJ/mol}$, $\\langle U_{\\text{tot}} \\rangle_{\\lambda=1} = -262.0\\,\\mathrm{kJ/mol}$.\n\nCase B (edge case, negligible hydrogen bonding, linear coupling):\n- Temperature $T = 298.0\\,\\mathrm{K}$.\n- Coupling schedule $s(\\lambda) = \\lambda$.\n- $\\lambda$-grid: $[0.0,\\,0.25,\\,0.5,\\,0.75,\\,1.0]$.\n- $\\langle U_{\\text{hb}} \\rangle_{\\lambda}$ (kJ/mol): $[0.0,\\,-0.1,\\,-0.2,\\,-0.1,\\,0.0]$.\n- $\\langle U_{\\text{tot}} \\rangle_{\\lambda=0} = -150.0\\,\\mathrm{kJ/mol}$, $\\langle U_{\\text{tot}} \\rangle_{\\lambda=1} = -150.2\\,\\mathrm{kJ/mol}$.\n\nCase C (stronger hydrogen bonding at lower temperature, linear coupling):\n- Temperature $T = 260.0\\,\\mathrm{K}$.\n- Coupling schedule $s(\\lambda) = \\lambda$.\n- $\\lambda$-grid: $[0.0,\\,0.125,\\,0.25,\\,0.375,\\,0.5,\\,0.625,\\,0.75,\\,0.875,\\,1.0]$.\n- $\\langle U_{\\text{hb}} \\rangle_{\\lambda}$ (kJ/mol): $[-0.5,\\,-4.0,\\,-8.0,\\,-12.0,\\,-16.0,\\,-20.0,\\,-24.0,\\,-27.0,\\,-30.0]$.\n- $\\langle U_{\\text{tot}} \\rangle_{\\lambda=0} = -300.0\\,\\mathrm{kJ/mol}$, $\\langle U_{\\text{tot}} \\rangle_{\\lambda=1} = -322.5\\,\\mathrm{kJ/mol}$.\n\nCase D (nonlinear coupling, softening near $\\lambda=0$):\n- Temperature $T = 300.0\\,\\mathrm{K}$.\n- Coupling schedule $s(\\lambda) = \\lambda^{2}$.\n- $\\lambda$-grid: $[0.0,\\,0.1,\\,0.2,\\,0.3,\\,0.4,\\,0.5,\\,0.6,\\,0.7,\\,0.8,\\,0.9,\\,1.0]$.\n- $\\langle U_{\\text{hb}} \\rangle_{\\lambda}$ (kJ/mol): $[0.0,\\,-0.5,\\,-2.0,\\,-4.2,\\,-6.8,\\,-9.5,\\,-12.0,\\,-14.0,\\,-16.0,\\,-18.0,\\,-20.0]$.\n- $\\langle U_{\\text{tot}} \\rangle_{\\lambda=0} = -500.0\\,\\mathrm{kJ/mol}$, $\\langle U_{\\text{tot}} \\rangle_{\\lambda=1} = -510.0\\,\\mathrm{kJ/mol}$.\n\nRequired final output format:\n- Your program should produce a single line of output containing a list of per-case results in the order A, B, C, D. Each per-case result must be a list $[\\Delta F_{\\text{off}}, \\Delta U_{\\text{off}}, \\Delta S_{\\text{off}}]$ with values rounded to three decimal places and in units of kJ/mol for $\\Delta F_{\\text{off}}$ and $\\Delta U_{\\text{off}}$, and kJ/(mol·K) for $\\Delta S_{\\text{off}}$. For example: $[[x_1,y_1,z_1],[x_2,y_2,z_2],[x_3,y_3,z_3],[x_4,y_4,z_4]]$.", "solution": "The problem statement is subjected to validation before any attempt at a solution.\n\n**Step 1: Extraction of Givens**\n\n*   **System**: An isothermal canonical ensemble at temperature $T$ describing a nanoscale interfacial system.\n*   **Potential Energy**: $U(\\lambda) = U_{\\text{nonhb}} + s(\\lambda)\\,U_{\\text{hb}}$, where $\\lambda \\in [0,1]$ is an alchemical coupling parameter.\n*   **Energy Terms**: $U_{\\text{nonhb}}$ is the $\\lambda$-independent background potential energy; $U_{\\text{hb}}$ is the hydrogen-bond interaction energy.\n*   **Coupling Schedule**: A function $s(\\lambda)$ such that $s(1)=1$ (hydrogen bond fully on) and $s(0)=0$ (hydrogen bond fully off).\n*   **Helmholtz Free Energy**: $F(\\lambda) = -k_{\\mathrm{B}} T \\ln Z(\\lambda)$, with $Z(\\lambda)$ being the canonical partition function.\n*   **Primary Objective**: Compute the free energy change for turning off the hydrogen bond, $\\Delta F_{\\text{off}} = F(0)-F(1)$.\n*   **Secondary Objectives**: Compute the internal energy change $\\Delta U_{\\text{off}} = \\langle U_{\\text{tot}} \\rangle_{\\lambda=0} - \\langle U_{\\text{tot}} \\rangle_{\\lambda=1}$ and the entropy change $\\Delta S_{\\text{off}}$, related by the thermodynamic identity $\\Delta F_{\\text{off}} = \\Delta U_{\\text{off}} - T\\,\\Delta S_{\\text{off}}$.\n*   **Provided Data**: For each test case, the temperature $T$, the function $s(\\lambda)$, a discrete and equally spaced $\\lambda$-grid, the corresponding ensemble averages $\\langle U_{\\text{hb}} \\rangle_{\\lambda}$, and the endpoint total energy averages $\\langle U_{\\text{tot}} \\rangle_{\\lambda=0}$ and $\\langle U_{\\text{tot}} \\rangle_{\\lambda=1}$.\n*   **Numerical Method Constraint**: A quadrature scheme valid for equally spaced $\\lambda$-grids with an even number of subintervals must be used for any integrals.\n*   **Assumption**: Ensemble averages are considered converged.\n*   **Units**: All energy quantities are specified in units of $\\mathrm{kJ/mol}$; temperature in $\\mathrm{K}$; entropy change in $\\mathrm{kJ/(mol \\cdot K)}$.\n*   **Test Cases**: Four specific cases (A, B, C, D) are provided with all necessary numerical data.\n\n**Step 2: Validation of Problem Statement**\n\n*   **Scientific Grounding**: The problem is an application of thermodynamic integration, a cornerstone technique in statistical mechanics and computational physics for calculating free energy differences. The definitions of potential energy, Helmholtz free energy, and their relationship to ensemble averages are fundamental and correct.\n*   **Well-Posedness**: The problem is well-posed. It requests the derivation of a standard formula and its application to a complete set of data. The specification of the numerical integration method for the given grid structures (even number of intervals) implies a uniquely determined numerical result, for which Simpson's $1/3$ rule is the appropriate standard choice.\n*   **Objectivity**: The problem is stated in precise, objective, and quantitative terms, free from ambiguity or subjective content.\n*   **Conclusion**: The problem is scientifically sound, self-contained, and formally structured. It does not violate any of the specified invalidity criteria.\n\n**Step 3: Verdict and Action**\n\nThe problem is deemed **valid**. A solution will be provided.\n\n**Derivation of the Governing Equation**\n\nThe Helmholtz free energy $F(\\lambda)$ is given by:\n$$F(\\lambda) = -k_{\\mathrm{B}} T \\ln Z(\\lambda)$$\nwhere $k_{\\mathrm{B}}$ is the Boltzmann constant, $T$ is the absolute temperature, and $Z(\\lambda)$ is the canonical partition function for a given value of the coupling parameter $\\lambda$. The partition function is an integral over all microstates (phase space coordinates $\\mathbf{q}$ and momenta $\\mathbf{p}$):\n$$Z(\\lambda) = \\frac{1}{h^{3N}N!} \\int d\\mathbf{q} \\int d\\mathbf{p} \\, \\exp\\left(-\\frac{H(\\mathbf{q}, \\mathbf{p}, \\lambda)}{k_{\\mathrm{B}}T}\\right)$$\nAs the potential energy $U(\\lambda)$ is independent of momenta, the momentum part can be integrated out, yielding a constant factor. The relevant dependence is in the configurational integral:\n$$Z(\\lambda) \\propto \\int d\\mathbf{q} \\, \\exp\\left(-\\frac{U(\\mathbf{q}, \\lambda)}{k_{\\mathrm{B}}T}\\right)$$\nTo find the change in free energy, we first differentiate $F(\\lambda)$ with respect to $\\lambda$:\n$$\\frac{\\partial F}{\\partial \\lambda} = -k_{\\mathrm{B}} T \\frac{1}{Z(\\lambda)} \\frac{\\partial Z}{\\partial \\lambda}$$\nThe derivative of the partition function is:\n$$\\frac{\\partial Z}{\\partial \\lambda} \\propto \\int d\\mathbf{q} \\, \\left(-\\frac{1}{k_{\\mathrm{B}}T} \\frac{\\partial U(\\mathbf{q}, \\lambda)}{\\partial \\lambda}\\right) \\exp\\left(-\\frac{U(\\mathbf{q}, \\lambda)}{k_{\\mathrm{B}}T}\\right)$$\nSubstituting this into the expression for $\\frac{\\partial F}{\\partial \\lambda}$:\n$$\\frac{\\partial F}{\\partial \\lambda} = \\frac{\\int d\\mathbf{q} \\, \\frac{\\partial U(\\mathbf{q}, \\lambda)}{\\partial \\lambda} \\exp\\left(-\\frac{U(\\mathbf{q}, \\lambda)}{k_{\\mathrm{B}}T}\\right)}{\\int d\\mathbf{q} \\, \\exp\\left(-\\frac{U(\\mathbf{q}, \\lambda)}{k_{\\mathrm{B}}T}\\right)}$$\nThis is the definition of the canonical ensemble average of the derivative of the potential energy with respect to $\\lambda$. Thus, we arrive at the fundamental relation of thermodynamic integration:\n$$\\frac{\\partial F}{\\partial \\lambda} = \\left\\langle \\frac{\\partial U}{\\partial \\lambda} \\right\\rangle_{\\lambda}$$\nThe potential energy is given as $U(\\lambda) = U_{\\text{nonhb}} + s(\\lambda)U_{\\text{hb}}$. Differentiating with respect to $\\lambda$ gives:\n$$\\frac{\\partial U}{\\partial \\lambda} = \\frac{\\partial s(\\lambda)}{\\partial \\lambda} U_{\\text{hb}} = s'(\\lambda) U_{\\text{hb}}$$\nTherefore, the free energy derivative becomes:\n$$\\frac{\\partial F}{\\partial \\lambda} = \\left\\langle s'(\\lambda) U_{\\text{hb}} \\right\\rangle_{\\lambda} = s'(\\lambda) \\left\\langle U_{\\text{hb}} \\right\\rangle_{\\lambda}$$\nsince $s'(\\lambda)$ is a deterministic function of $\\lambda$ and does not fluctuate with the system's microstate.\n\nThe total free energy change for turning off the hydrogen bond, $\\Delta F_{\\text{off}} = F(\\lambda=0) - F(\\lambda=1)$, is found by integrating this derivative from $\\lambda = 1$ to $\\lambda = 0$:\n$$\\Delta F_{\\text{off}} = \\int_{1}^{0} \\frac{\\partial F}{\\partial \\lambda} d\\lambda = \\int_{1}^{0} s'(\\lambda) \\left\\langle U_{\\text{hb}} \\right\\rangle_{\\lambda} d\\lambda$$\nThis is equivalent to:\n$$\\Delta F_{\\text{off}} = - \\int_{0}^{1} s'(\\lambda) \\left\\langle U_{\\text{hb}} \\right\\rangle_{\\lambda} d\\lambda$$\nThis is the final expression to be computed. The inputs for $\\langle U_{\\text{hb}} \\rangle_{\\lambda}$ are provided in molar units ($\\mathrm{kJ/mol}$), so the resulting $\\Delta F_{\\text{off}}$ will also be in $\\mathrm{kJ/mol}$.\n\n**Thermodynamic Decomposition**\n\nThe problem requires a decomposition of the free energy change into its internal energy and entropic components. The change in internal energy upon turning off the hydrogen bond is given directly by the endpoint averages:\n$$\\Delta U_{\\text{off}} = \\langle U_{\\text{tot}} \\rangle_{\\lambda=0} - \\langle U_{\\text{tot}} \\rangle_{\\lambda=1}$$\nThe fundamental thermodynamic relation connecting these quantities is $\\Delta F = \\Delta U - T\\Delta S$. For the process of turning off the hydrogen bond, this is:\n$$\\Delta F_{\\text{off}} = \\Delta U_{\\text{off}} - T \\Delta S_{\\text{off}}$$\nRearranging for the entropy change, $\\Delta S_{\\text{off}}$, gives:\n$$\\Delta S_{\\text{off}} = \\frac{\\Delta U_{\\text{off}} - \\Delta F_{\\text{off}}}{T}$$\nA positive value of $\\Delta F_{\\text{off}}$ indicates that turning off the hydrogen bond is a non-spontaneous process, meaning the presence of the hydrogen bond is thermodynamically favorable. $\\Delta U_{\\text{off}}$ represents the change in the average potential energy of the system; a positive value means the system is energetically less stable without the hydrogen bond. $\\Delta S_{\\text{off}}$ represents the change in disorder; a positive value typically indicates that the system has more accessible microstates (e.g., greater conformational freedom) when the hydrogen bond is turned off.\n\n**Computational Algorithm**\n\nThe numerical evaluation proceeds as follows:\n$1$. For each test case, identify the temperature $T$, the coupling schedule $s(\\lambda)$, the $\\lambda$-grid $\\{\\lambda_i\\}_{i=0}^N$, the average hydrogen bond energies $\\{\\langle U_{\\text{hb}} \\rangle_{\\lambda_i}\\}_{i=0}^N$, and the endpoint total energies $\\langle U_{\\text{tot}} \\rangle_{\\lambda=0}$ and $\\langle U_{\\text{tot}} \\rangle_{\\lambda=1}$.\n$2$. Analytically determine the derivative of the coupling schedule, $s'(\\lambda)$.\n$3$. For each point $\\lambda_i$ on the grid, compute the value of the integrand $I_i = s'(\\lambda_i) \\langle U_{\\text{hb}} \\rangle_{\\lambda_i}$.\n$4$. Use Simpson's $1/3$ rule to numerically compute the integral $W = \\int_{0}^{1} I(\\lambda) d\\lambda$ from the discrete values $\\{I_i\\}$ and $\\{\\lambda_i\\}$. This method is appropriate for the an even number of intervals.\n$5$. Calculate the Helmholtz free energy change: $\\Delta F_{\\text{off}} = -W$.\n$6$. Calculate the internal energy change: $\\Delta U_{\\text{off}} = \\langle U_{\\text{tot}} \\rangle_{\\lambda=0} - \\langle U_{\\text{tot}} \\rangle_{\\lambda=1}$.\n$7$. Calculate the entropy change: $\\Delta S_{\\text{off}} = (\\Delta U_{\\text{off}} - \\Delta F_{\\text{off}}) / T$.\n$8$. Format the results $[\\Delta F_{\\text{off}}, \\Delta U_{\\text{off}}, \\Delta S_{\\text{off}}]$ with values rounded to three decimal places.\n\nThis algorithm will be implemented for the four provided test cases.", "answer": "```python\nimport numpy as np\nfrom scipy.integrate import simpson\n\ndef solve():\n    \"\"\"\n    Solves the thermodynamic integration problem for the given test cases.\n    \"\"\"\n\n    test_cases = [\n        {\n            \"T\": 298.0,\n            \"s_prime\": lambda l: 1.0,\n            \"lambdas\": np.array([0.0, 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1.0]),\n            \"U_hb\": np.array([-0.2, -1.8, -3.5, -5.0, -6.5, -8.0, -9.3, -10.6, -11.9, -13.2, -14.5]),\n            \"U_tot_0\": -250.0,\n            \"U_tot_1\": -262.0,\n        },\n        {\n            \"T\": 298.0,\n            \"s_prime\": lambda l: 1.0,\n            \"lambdas\": np.array([0.0, 0.25, 0.5, 0.75, 1.0]),\n            \"U_hb\": np.array([0.0, -0.1, -0.2, -0.1, 0.0]),\n            \"U_tot_0\": -150.0,\n            \"U_tot_1\": -150.2,\n        },\n        {\n            \"T\": 260.0,\n            \"s_prime\": lambda l: 1.0,\n            \"lambdas\": np.array([0.0, 0.125, 0.25, 0.375, 0.5, 0.625, 0.75, 0.875, 1.0]),\n            \"U_hb\": np.array([-0.5, -4.0, -8.0, -12.0, -16.0, -20.0, -24.0, -27.0, -30.0]),\n            \"U_tot_0\": -300.0,\n            \"U_tot_1\": -322.5,\n        },\n        {\n            \"T\": 300.0,\n            \"s_prime\": lambda l: 2 * l,\n            \"lambdas\": np.array([0.0, 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1.0]),\n            \"U_hb\": np.array([0.0, -0.5, -2.0, -4.2, -6.8, -9.5, -12.0, -14.0, -16.0, -18.0, -20.0]),\n            \"U_tot_0\": -500.0,\n            \"U_tot_1\": -510.0,\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        T = case[\"T\"]\n        s_prime = case[\"s_prime\"]\n        lambdas = case[\"lambdas\"]\n        U_hb_values = case[\"U_hb\"]\n        U_tot_0 = case[\"U_tot_0\"]\n        U_tot_1 = case[\"U_tot_1\"]\n\n        # Step 1: Compute the integrand I(lambda) = s'(lambda) * <U_hb>_lambda\n        integrand = s_prime(lambdas) * U_hb_values\n\n        # Step 2: Numerically integrate using Simpson's rule\n        # The integral corresponds to F(1) - F(0)\n        integral_value = simpson(y=integrand, x=lambdas)\n        \n        # Step 3: Calculate Delta F_off = F(0) - F(1) = -integral\n        delta_F_off = -integral_value\n\n        # Step 4: Calculate Delta U_off\n        delta_U_off = U_tot_0 - U_tot_1\n\n        # Step 5: Calculate Delta S_off from Delta F = Delta U - T * Delta S\n        # T * Delta S = Delta U - Delta F\n        # Delta S = (Delta U - Delta F) / T\n        if T == 0:\n            # Avoid division by zero, though not relevant for these test cases.\n            # In this limit, T*Delta S term vanishes, and Delta F = Delta U.\n            # Thus, Delta S would be undefined or context-dependent.\n            # Here, we can assume T > 0 based on problem context.\n            delta_S_off = 0.0\n        else:\n            delta_S_off = (delta_U_off - delta_F_off) / T\n\n        # Step 6: Round results to three decimal places\n        results.append([\n            round(delta_F_off, 3),\n            round(delta_U_off, 3),\n            round(delta_S_off, 3)\n        ])\n    \n    # Format the final output string exactly as specified.\n    # The map(str,...) is used to ensure floats are converted to strings before joining.\n    # The outer list comprehension formats each sublist.\n    output_str = f\"[[{'],['.join([','.join(map(str, res)) for res in results])}]]\"\n    # Manual formatting to get the spacing right as per example.\n    formatted_results = []\n    for r in results:\n        formatted_r = f\"[{r[0]:.3f},{r[1]:.3f},{r[2]:.3f}]\"\n        # The above formatting creates trailing zeros, e.g., 12.000, which is good.\n        formatted_results.append(formatted_r)\n\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"}]}