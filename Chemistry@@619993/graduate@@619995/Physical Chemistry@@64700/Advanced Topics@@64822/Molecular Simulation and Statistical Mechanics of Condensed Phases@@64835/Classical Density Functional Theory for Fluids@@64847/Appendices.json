{"hands_on_practices": [{"introduction": "The cornerstone of classical density functional theory (DFT) is the variational principle, which allows us to determine the equilibrium density profile of a fluid by minimizing a grand potential functional. This first practice is a foundational exercise where you will derive the central self-consistent equation for the density profile starting from this principle. Mastering this derivation is crucial as it reveals how the complex many-body problem is formally recast a more tractable problem for a one-body density in an effective potential, a concept that underlies all applications of DFT [@problem_id:2763947].", "problem": "Consider a single-component classical fluid described within classical density functional theory (CDFT). The intrinsic Helmholtz free-energy functional is decomposed as $F[n]=F_{\\text{id}}[n]+F_{\\text{hs}}[n]+F_{\\text{att}}[n]$, where the ideal-gas contribution is $F_{\\text{id}}[n]=k_{\\text{B}}T\\int \\mathrm{d}\\mathbf{r}\\,n(\\mathbf{r})\\left[\\ln\\!\\left(\\Lambda^{3}n(\\mathbf{r})\\right)-1\\right]$ with $\\Lambda$ the thermal de Broglie wavelength, the hard-sphere excess contribution $F_{\\text{hs}}[n]$ is an unknown but well-defined functional, and the mean-field attractive contribution is $F_{\\text{att}}[n]=\\frac{1}{2}\\int \\mathrm{d}\\mathbf{r}\\,\\mathrm{d}\\mathbf{r}'\\,n(\\mathbf{r})\\,n(\\mathbf{r}')\\,u_{\\text{att}}(|\\mathbf{r}-\\mathbf{r}'|)$ with $u_{\\text{att}}(r)$ a prescribed pairwise attractive potential. The system is subject to a given external field $V_{\\text{ext}}(\\mathbf{r})$ at fixed temperature $T$ and chemical potential $\\mu$.\n\nStarting from the variational principle that the equilibrium density profile $n(\\mathbf{r})$ minimizes the grand potential functional $\\Omega[n]=F[n]+\\int \\mathrm{d}\\mathbf{r}\\,n(\\mathbf{r})\\left(V_{\\text{ext}}(\\mathbf{r})-\\mu\\right)$, derive the Euler–Lagrange stationarity condition and rearrange it to obtain an explicit self-consistent integral equation for $n(\\mathbf{r})$.\n\nExpress your final result as the explicit closed-form functional expression $G[n](\\mathbf{r})$ such that $n(\\mathbf{r})=G[n](\\mathbf{r})$. Report only the expression for $G[n](\\mathbf{r})$ in terms of $\\mu$, $T$, $\\Lambda$, $V_{\\text{ext}}(\\mathbf{r})$, $u_{\\text{att}}(r)$, and the functional derivative $\\delta F_{\\text{hs}}[n]/\\delta n(\\mathbf{r})$. Do not include an equality sign in your final answer. Define $\\beta=1/(k_{\\text{B}}T)$ clearly in your derivation. No numerical evaluation is required.", "solution": "The problem statement has been rigorously validated.\n\n**Step 1: Extract Givens**\n- **System**: Single-component classical fluid.\n- **Framework**: Classical density functional theory (CDFT).\n- **Intrinsic Helmholtz Free-Energy Functional**: $F[n]=F_{\\text{id}}[n]+F_{\\text{hs}}[n]+F_{\\text{att}}[n]$.\n- **Ideal-Gas Contribution**: $F_{\\text{id}}[n]=k_{\\text{B}}T\\int \\mathrm{d}\\mathbf{r}\\,n(\\mathbf{r})\\left[\\ln\\!\\left(\\Lambda^{3}n(\\mathbf{r})\\right)-1\\right]$, with $\\Lambda$ being the thermal de Broglie wavelength.\n- **Hard-Sphere Excess Contribution**: $F_{\\text{hs}}[n]$, an unspecified functional.\n- **Mean-Field Attractive Contribution**: $F_{\\text{att}}[n]=\\frac{1}{2}\\int \\mathrm{d}\\mathbf{r}\\,\\mathrm{d}\\mathbf{r}'\\,n(\\mathbf{r})\\,n(\\mathbf{r}')\\,u_{\\text{att}}(|\\mathbf{r}-\\mathbf{r}'|)$, with $u_{\\text{att}}(r)$ as a prescribed attractive potential.\n- **Thermodynamic Conditions**: The system is at fixed temperature $T$ and chemical potential $\\mu$.\n- **External Field**: $V_{\\text{ext}}(\\mathbf{r})$.\n- **Grand Potential Functional**: $\\Omega[n]=F[n]+\\int \\mathrm{d}\\mathbf{r}\\,n(\\mathbf{r})\\left(V_{\\text{ext}}(\\mathbf{r})-\\mu\\right)$.\n- **Variational Principle**: The equilibrium density profile $n(\\mathbf{r})$ minimizes $\\Omega[n]$.\n- **Task**: Derive the Euler–Lagrange equation from the variational principle and express it as a self-consistent equation $n(\\mathbf{r})=G[n](\\mathbf{r})$.\n- **Output Requirement**: Report the functional expression for $G[n](\\mathbf{r})$.\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientific Grounding**: The problem is a standard, fundamental derivation in the well-established field of classical density functional theory. All definitions and principles are correct.\n- **Well-Posedness**: The problem is clearly stated, and all information required for the derivation is provided. The objective is to derive a known type of equation, which has a unique formal structure.\n- **Objectivity**: The problem is formulated in precise, objective, and scientific language.\n\n**Step 3: Verdict and Action**\nThe problem is scientifically sound, well-posed, objective, and contains no ambiguities or contradictions. It is deemed **valid**. We proceed with the solution.\n\nThe equilibrium density profile $n(\\mathbf{r})$ is the function that minimizes the grand potential functional $\\Omega[n]$. This condition is expressed by the Euler-Lagrange equation, which states that the functional derivative of $\\Omega[n]$ with respect to $n(\\mathbf{r})$ must vanish at equilibrium:\n$$\n\\frac{\\delta \\Omega[n]}{\\delta n(\\mathbf{r})} = 0\n$$\nThe grand potential functional is given by:\n$$\n\\Omega[n] = F_{\\text{id}}[n] + F_{\\text{hs}}[n] + F_{\\text{att}}[n] + \\int \\mathrm{d}\\mathbf{r}'\\, n(\\mathbf{r}') V_{\\text{ext}}(\\mathbf{r}') - \\mu \\int \\mathrm{d}\\mathbf{r}'\\, n(\\mathbf{r}')\n$$\nWe compute the functional derivative of each term with respect to $n(\\mathbf{r})$. To avoid confusion, integration variables are denoted with a prime, $\\mathbf{r}'$.\n\n1.  **Ideal-gas term**, $F_{\\text{id}}[n]$:\n    The functional is $F_{\\text{id}}[n] = \\int \\mathrm{d}\\mathbf{r}'\\, f(n(\\mathbf{r}'))$ where the free-energy density is $f(n) = k_{\\text{B}}T\\left(n\\ln(\\Lambda^{3}n) - n\\right)$. The functional derivative is the partial derivative of its integrand with respect to $n$, evaluated at $n(\\mathbf{r})$:\n    $$\n    \\frac{\\delta F_{\\text{id}}[n]}{\\delta n(\\mathbf{r})} = \\frac{d}{dn}\\left[k_{\\text{B}}T\\left(n\\ln(\\Lambda^{3}n) - n\\right)\\right]_{n=n(\\mathbf{r})} = k_{\\text{B}}T\\left[ \\ln(\\Lambda^{3}n(\\mathbf{r})) + n(\\mathbf{r})\\frac{\\Lambda^{3}}{n(\\mathbf{r})\\Lambda^{3}} - 1 \\right] = k_{\\text{B}}T \\ln(\\Lambda^{3}n(\\mathbf{r}))\n    $$\n\n2.  **Hard-sphere term**, $F_{\\text{hs}}[n]$:\n    As this functional is not explicitly given, its functional derivative is kept in symbolic form as required: $\\frac{\\delta F_{\\text{hs}}[n]}{\\delta n(\\mathbf{r})}$.\n\n3.  **Attractive term**, $F_{\\text{att}}[n]$:\n    The functional is $F_{\\text{att}}[n]=\\frac{1}{2}\\int \\mathrm{d}\\mathbf{r}'\\,\\mathrm{d}\\mathbf{r}''\\,n(\\mathbf{r}')\\,n(\\mathbf{r}'')\\,u_{\\text{att}}(|\\mathbf{r}'-\\mathbf{r}''|)$. Due to the symmetry of the integrand with respect to the exchange of $\\mathbf{r}'$ and $\\mathbf{r}''$, the functional derivative is:\n    $$\n    \\frac{\\delta F_{\\text{att}}[n]}{\\delta n(\\mathbf{r})} = \\int \\mathrm{d}\\mathbf{r}'\\, n(\\mathbf{r}')\\, u_{\\text{att}}(|\\mathbf{r}-\\mathbf{r}'|)\n    $$\n\n4.  **External potential term**:\n    $$\n    \\frac{\\delta}{\\delta n(\\mathbf{r})} \\int \\mathrm{d}\\mathbf{r}'\\, n(\\mathbf{r}') V_{\\text{ext}}(\\mathbf{r}') = \\int \\mathrm{d}\\mathbf{r}'\\, V_{\\text{ext}}(\\mathbf{r}') \\frac{\\delta n(\\mathbf{r}')}{\\delta n(\\mathbf{r})} = \\int \\mathrm{d}\\mathbf{r}'\\, V_{\\text{ext}}(\\mathbf{r}') \\delta(\\mathbf{r}' - \\mathbf{r}) = V_{\\text{ext}}(\\mathbf{r})\n    $$\n\n5.  **Chemical potential term**:\n    $$\n    \\frac{\\delta}{\\delta n(\\mathbf{r})} \\left[ -\\mu \\int \\mathrm{d}\\mathbf{r}'\\, n(\\mathbf{r}') \\right] = -\\mu \\int \\mathrm{d}\\mathbf{r}'\\, \\frac{\\delta n(\\mathbf{r}')}{\\delta n(\\mathbf{r})} = -\\mu \\int \\mathrm{d}\\mathbf{r}'\\, \\delta(\\mathbf{r}' - \\mathbf{r}) = -\\mu\n    $$\nCombining these results gives the Euler-Lagrange equation:\n$$\nk_{\\text{B}}T \\ln(\\Lambda^{3}n(\\mathbf{r})) + \\frac{\\delta F_{\\text{hs}}[n]}{\\delta n(\\mathbf{r})} + \\int \\mathrm{d}\\mathbf{r}'\\,n(\\mathbf{r}')\\,u_{\\text{att}}(|\\mathbf{r}-\\mathbf{r}'|) + V_{\\text{ext}}(\\mathbf{r}) - \\mu = 0\n$$\nTo obtain the self-consistent equation for $n(\\mathbf{r})$, we rearrange this stationarity condition to isolate $n(\\mathbf{r})$. First, we isolate the logarithmic term:\n$$\nk_{\\text{B}}T \\ln(\\Lambda^{3}n(\\mathbf{r})) = \\mu - V_{\\text{ext}}(\\mathbf{r}) - \\frac{\\delta F_{\\text{hs}}[n]}{\\delta n(\\mathbf{r})} - \\int \\mathrm{d}\\mathbf{r}'\\,n(\\mathbf{r}')\\,u_{\\text{att}}(|\\mathbf{r}-\\mathbf{r}'|)\n$$\nWe define the inverse temperature $\\beta = \\frac{1}{k_{\\text{B}}T}$. Dividing by $k_{\\text{B}}T$ yields:\n$$\n\\ln(\\Lambda^{3}n(\\mathbf{r})) = \\beta \\left[ \\mu - V_{\\text{ext}}(\\mathbf{r}) - \\frac{\\delta F_{\\text{hs}}[n]}{\\delta n(\\mathbf{r})} - \\int \\mathrm{d}\\mathbf{r}'\\,n(\\mathbf{r}')\\,u_{\\text{att}}(|\\mathbf{r}-\\mathbf{r}'|) \\right]\n$$\nExponentiating both sides gives:\n$$\n\\Lambda^{3}n(\\mathbf{r}) = \\exp\\left( \\beta \\left[ \\mu - V_{\\text{ext}}(\\mathbf{r}) - \\frac{\\delta F_{\\text{hs}}[n]}{\\delta n(\\mathbf{r})} - \\int \\mathrm{d}\\mathbf{r}'\\,n(\\mathbf{r}')\\,u_{\\text{att}}(|\\mathbf{r}-\\mathbf{r}'|) \\right] \\right)\n$$\nFinally, solving for $n(\\mathbf{r})$ gives the desired self-consistent integral equation of the form $n(\\mathbf{r}) = G[n](\\mathbf{r})$, where the functional $G[n](\\mathbf{r})$ is:\n$$\nG[n](\\mathbf{r}) = \\frac{1}{\\Lambda^{3}} \\exp\\left( \\beta \\left[ \\mu - V_{\\text{ext}}(\\mathbf{r}) - \\frac{\\delta F_{\\text{hs}}[n]}{\\delta n(\\mathbf{r})} - \\int \\mathrm{d}\\mathbf{r}'\\,n(\\mathbf{r}')\\,u_{\\text{att}}(|\\mathbf{r}-\\mathbf{r}'|) \\right] \\right)\n$$\nThis is the final expression required by the problem.", "answer": "$$\n\\boxed{\\frac{1}{\\Lambda^{3}} \\exp\\left( \\beta \\left( \\mu - V_{\\text{ext}}(\\mathbf{r}) - \\frac{\\delta F_{\\text{hs}}[n]}{\\delta n(\\mathbf{r})} - \\int \\mathrm{d}\\mathbf{r}'\\,n(\\mathbf{r}')\\,u_{\\text{att}}(|\\mathbf{r}-\\mathbf{r}'|) \\right) \\right)}\n$$", "id": "2763947"}, {"introduction": "The excess free energy functional, $F_{\\mathrm{ex}}[n]$, accounts for all the non-trivial particle interaction effects beyond the ideal gas, but its form can seem abstract. This exercise provides a powerful conceptual anchor by guiding you through the derivation of the exact excess functional for a \"zero-dimensional\" cavity that can hold at most one particle. By tackling this exactly solvable limit using fundamental statistical mechanics, you will gain a concrete understanding of what $F_{\\mathrm{ex}}[n]$ represents and how it captures the physics of particle exclusion [@problem_id:2763950].", "problem": "Consider a classical hard-sphere fluid treated within Classical Density Functional Theory (DFT), in the zero-dimensional limit of an external cavity that can accommodate at most one ($1$) particle. Let $\\beta \\equiv 1/(k_{\\text{B}}T)$ and denote by $\\eta \\in [0,1)$ the equilibrium mean occupancy of the cavity, which in DFT corresponds to the integral of the density, $\\eta = \\int n(\\mathbf{r})\\,d\\mathbf{r}$, and is the only nontrivial degree of freedom in this limit. Using only foundational statistical-mechanical definitions, namely the grand partition function, the grand potential, and the Legendre transform relation between the grand potential and the Helmholtz free energy at fixed mean occupancy, determine the exact zero-dimensional hard-sphere excess Helmholtz free energy functional as a function of $\\eta$,\n$$\n\\beta F_{\\text{hs}}^{\\text{(0D)}}(\\eta) = \\beta\\Big(F_{\\text{int}}^{\\text{(0D)}}(\\eta) - F_{\\text{id}}^{\\text{(0D)}}(\\eta)\\Big),\n$$\nwhere $F_{\\text{int}}^{\\text{(0D)}}$ is the exact Helmholtz free energy of the interacting hard-sphere system in the cavity and $F_{\\text{id}}^{\\text{(0D)}}$ is the corresponding ideal-gas Helmholtz free energy in the same cavity. Work in units where the one-particle configuration integral of the cavity is unity so that the activity is $z=\\exp(\\beta\\mu)$, with $\\mu$ the chemical potential. Your answer must be a single closed-form analytic expression for $\\beta F_{\\text{hs}}^{\\text{(0D)}}(\\eta)$ (dimensionless), expressed solely in terms of $\\eta$. No numerical evaluation is required.", "solution": "The problem is subjected to validation.\n\nStep 1: Extract Givens\n- System: Classical hard-sphere fluid in a zero-dimensional ($0D$) cavity.\n- Theory: Classical Density Functional Theory (DFT).\n- Constraint: The cavity can accommodate at most one ($1$) particle.\n- Notation: $\\beta \\equiv 1/(k_{\\text{B}}T)$.\n- Variable: $\\eta \\in [0,1)$ is the equilibrium mean occupancy, defined as $\\eta = \\int n(\\mathbf{r})\\,\\mathrm{d}\\mathbf{r}$.\n- Objective: Determine the exact zero-dimensional hard-sphere excess Helmholtz free energy functional, $\\beta F_{\\text{hs}}^{\\text{(0D)}}(\\eta)$.\n- Definition: $\\beta F_{\\text{hs}}^{\\text{(0D)}}(\\eta) = \\beta\\big(F_{\\text{int}}^{\\text{(0D)}}(\\eta) - F_{\\text{id}}^{\\text{(0D)}}(\\eta)\\big)$.\n- $F_{\\text{int}}^{\\text{(0D)}}(\\eta)$ is the exact Helmholtz free energy of the interacting system.\n- $F_{\\text{id}}^{\\text{(0D)}}(\\eta)$ is the corresponding ideal-gas Helmholtz free energy.\n- Normalization: The one-particle configuration integral of the cavity is unity.\n- Activity: $z = \\exp(\\beta\\mu)$, where $\\mu$ is the chemical potential.\n\nStep 2: Validate Using Extracted Givens\nThe problem is scientifically grounded, being a well-defined theoretical exercise in statistical mechanics and classical DFT. It is well-posed, with sufficient information provided to derive a unique solution using fundamental principles. The terminology is precise and objective. The problem does not violate any physical laws but instead uses a standard theoretical simplification (the $0D$ limit) to test the application of foundational concepts like the grand partition function and Legendre transforms. The setup is self-contained and consistent.\n\nStep 3: Verdict and Action\nThe problem is valid. A solution will be provided.\n\nThe solution proceeds from the foundational principles of the grand canonical ensemble. The system is a cavity at fixed volume, temperature $T$, and chemical potential $\\mu$. The central quantity is the grand partition function, $\\Xi$, defined as:\n$$\n\\Xi = \\sum_{N=0}^{\\infty} \\frac{z^N}{N!} Q_N\n$$\nwhere $z = \\exp(\\beta\\mu)$ is the activity and $Q_N$ is the canonical configuration integral for $N$ particles. The problem states that the one-particle configuration integral $Q_1$ is unity.\n\nFirst, we consider the interacting \"hard-sphere\" system. The constraint that the cavity can hold at most one particle is the manifestation of the hard-sphere interaction in this $0D$ limit. This means the number of particles $N$ can only be $0$ or $1$. The grand partition function for this interacting system, $\\Xi_{\\text{int}}$, is therefore:\n$$\n\\Xi_{\\text{int}} = \\frac{z^0}{0!} Q_0 + \\frac{z^1}{1!} Q_1 = 1 + z\n$$\nHere, we have used $Q_0 = 1$ by definition and $Q_1=1$ as given. For $N > 1$, the infinite repulsion means $Q_N = 0$.\n\nNext, we consider the corresponding ideal-gas system. An ideal gas consists of non-interacting point particles. In the same cavity, an arbitrary number of such particles can be accommodated. The grand partition function for the ideal gas, $\\Xi_{\\text{id}}$, is:\n$$\n\\Xi_{\\text{id}} = \\sum_{N=0}^{\\infty} \\frac{z^N}{N!} (Q_1)^N = \\sum_{N=0}^{\\infty} \\frac{z^N}{N!} = \\exp(z)\n$$\nwhere we have used the property that for an ideal gas, $Q_N = (Q_1)^N$.\n\nThe grand potential, $\\Omega$, is related to the grand partition function by $\\beta\\Omega = -\\ln\\Xi$.\nFor the interacting system:\n$$\n\\beta\\Omega_{\\text{int}} = -\\ln(\\Xi_{\\text{int}}) = -\\ln(1+z)\n$$\nFor the ideal-gas system:\n$$\n\\beta\\Omega_{\\text{id}} = -\\ln(\\Xi_{\\text{id}}) = -\\ln(\\exp(z)) = -z\n$$\nThe mean number of particles in the cavity, denoted by $\\eta$, is given by $\\eta = \\langle N \\rangle = z \\frac{\\partial(\\ln \\Xi)}{\\partial z}$.\nFor the interacting system, the mean occupancy $\\eta$ is:\n$$\n\\eta = z \\frac{\\partial}{\\partial z} \\ln(1+z) = \\frac{z}{1+z}\n$$\nThis equation relates the mean occupancy $\\eta$ to the activity $z$. We can invert it to express $z$ as a function of $\\eta$:\n$$\n\\eta(1+z) = z \\implies \\eta = z(1-\\eta) \\implies z = \\frac{\\eta}{1-\\eta}\n$$\nSince $z = \\exp(\\beta\\mu)$, the chemical potential for the interacting system is $\\beta\\mu = \\ln(z) = \\ln\\left(\\frac{\\eta}{1-\\eta}\\right)$.\n\nThe Helmholtz free energy, $F$, is obtained from the grand potential $\\Omega$ via a Legendre transform: $F(\\eta) = \\Omega + \\mu\\eta$. In dimensionless units, this is $\\beta F(\\eta) = \\beta\\Omega + (\\beta\\mu)\\eta$.\n\nWe now calculate the Helmholtz free energy for the interacting system, $\\beta F_{\\text{int}}(\\eta)$, by substituting the expressions for $\\beta\\Omega_{\\text{int}}$ and $\\beta\\mu$ in terms of $\\eta$:\n$$\n\\beta F_{\\text{int}}(\\eta) = -\\ln(1+z) + \\eta \\ln(z)\n$$\nUsing $z = \\frac{\\eta}{1-\\eta}$ and $1+z = 1+\\frac{\\eta}{1-\\eta} = \\frac{1}{1-\\eta}$, we get:\n$$\n\\beta F_{\\text{int}}(\\eta) = -\\ln\\left(\\frac{1}{1-\\eta}\\right) + \\eta \\ln\\left(\\frac{\\eta}{1-\\eta}\\right)\n$$\n$$\n\\beta F_{\\text{int}}(\\eta) = \\ln(1-\\eta) + \\eta \\ln(\\eta) - \\eta \\ln(1-\\eta)\n$$\n$$\n\\beta F_{\\text{int}}(\\eta) = (1-\\eta)\\ln(1-\\eta) + \\eta\\ln(\\eta)\n$$\nThis is the total dimensionless Helmholtz free energy for the interacting system.\n\nNext, we determine the ideal-gas Helmholtz free energy, $F_{\\text{id}}$. In DFT, the ideal-gas reference system must have the same one-body density profile, which in this $0D$ case means it must have the same mean occupancy $\\eta$ as the interacting system.\nFor the ideal gas, the mean occupancy $\\eta_{\\text{id}}$ is:\n$$\n\\eta_{\\text{id}} = z \\frac{\\partial}{\\partial z} \\ln(\\exp(z)) = z\n$$\nTherefore, to achieve a mean occupancy $\\eta$, the activity for the ideal gas must be $z = \\eta$, which implies its chemical potential is $\\beta\\mu_{\\text{id}} = \\ln(\\eta)$.\nThe ideal-gas grand potential at this activity is $\\beta\\Omega_{\\text{id}} = -z = -\\eta$.\nApplying the Legendre transform for the ideal gas system at mean occupancy $\\eta$:\n$$\n\\beta F_{\\text{id}}(\\eta) = \\beta\\Omega_{\\text{id}} + (\\beta\\mu_{\\text{id}})\\eta = -\\eta + \\eta\\ln(\\eta)\n$$\nThis expression, $\\beta F_{\\text{id}}(\\eta) = \\eta\\ln(\\eta) - \\eta$, is the well-known dimensionless free energy of a $0D$ ideal gas.\n\nFinally, the excess Helmholtz free energy is the difference between the interacting and ideal-gas free energies:\n$$\n\\beta F_{\\text{hs}}^{\\text{(0D)}}(\\eta) = \\beta F_{\\text{int}}(\\eta) - \\beta F_{\\text{id}}(\\eta)\n$$\n$$\n\\beta F_{\\text{hs}}^{\\text{(0D)}}(\\eta) = \\big[ (1-\\eta)\\ln(1-\\eta) + \\eta\\ln(\\eta) \\big] - \\big[ \\eta\\ln(\\eta) - \\eta \\big]\n$$\n$$\n\\beta F_{\\text{hs}}^{\\text{(0D)}}(\\eta) = (1-\\eta)\\ln(1-\\eta) + \\eta\\ln(\\eta) - \\eta\\ln(\\eta) + \\eta\n$$\n$$\n\\beta F_{\\text{hs}}^{\\text{(0D)}}(\\eta) = (1-\\eta)\\ln(1-\\eta) + \\eta\n$$\nThis is the exact expression for the dimensionless excess Helmholtz free energy functional for a hard-sphere fluid in the specified zero-dimensional limit, expressed solely in terms of the mean occupancy $\\eta$.", "answer": "$$\n\\boxed{(1-\\eta)\\ln(1-\\eta) + \\eta}\n$$", "id": "2763950"}, {"introduction": "Deriving the Euler-Lagrange equation is the first step; solving it is the practical challenge where theory meets computation. This practice bridges that gap by exploring the numerical methods used to solve the self-consistent DFT equation. You will analyze the structure of the equation to understand fixed-point iteration strategies, their potential pitfalls like numerical instability, and the stabilization techniques such as mixing schemes that are essential for obtaining robust solutions in real-world calculations [@problem_id:2763922].", "problem": "Consider a one-component classical fluid at fixed temperature $T$ and chemical potential $\\mu$ in an external one-body potential $V_{\\text{ext}}(\\mathbf{r})$. In classical density functional theory (DFT), the grand potential functional is defined by\n$$\n\\Omega[n] \\equiv F_{\\text{id}}[n] + F_{\\text{ex}}[n] + \\int \\mathrm{d}\\mathbf{r}\\, n(\\mathbf{r})\\left[V_{\\text{ext}}(\\mathbf{r}) - \\mu\\right],\n$$\nwhere $F_{\\text{id}}[n]$ is the intrinsic ideal-gas free-energy functional, $F_{\\text{ex}}[n]$ is the intrinsic excess (over ideal) free-energy functional, and $n(\\mathbf{r})$ is the number density field. The ideal-gas functional is\n$$\nF_{\\text{id}}[n] = k_{\\mathrm{B}} T \\int \\mathrm{d}\\mathbf{r}\\, n(\\mathbf{r})\\left[\\ln\\!\\left(\\Lambda^{3} n(\\mathbf{r})\\right) - 1\\right],\n$$\nwith $k_{\\mathrm{B}}$ the Boltzmann constant, $\\Lambda$ the thermal de Broglie wavelength, and $\\beta \\equiv 1/(k_{\\mathrm{B}}T)$. The equilibrium density $n^{\\star}(\\mathbf{r})$ minimizes $\\Omega[n]$ subject to $n(\\mathbf{r}) \\ge 0$.\n\nStarting from these definitions alone, derive the Euler–Lagrange stationarity condition $\\delta \\Omega[n]/\\delta n(\\mathbf{r}) = 0$ and rewrite it as an explicit algebraic relation for $n(\\mathbf{r})$ that is structurally analogous to the Kohn–Sham (KS) equation in electronic structure theory, expressed in terms of $V_{\\text{ext}}(\\mathbf{r})$, the excess functional derivative $v_{\\text{ex}}(\\mathbf{r}) \\equiv \\delta F_{\\text{ex}}[n]/\\delta n(\\mathbf{r})$, and $\\mu$. Then, discuss how this relation suggests a fixed-point iteration for computing $n^{\\star}(\\mathbf{r})$, and what modifications can improve convergence.\n\nBased on your derivation and analysis, select all statements below that are correct.\n\nA. The Euler–Lagrange condition yields a Kohn–Sham-like form\n$$\n\\ln\\!\\left(\\Lambda^{3} n(\\mathbf{r})\\right) \\;=\\; -\\beta\\left[V_{\\text{ext}}(\\mathbf{r}) + v_{\\text{ex}}(\\mathbf{r}) - \\mu\\right],\n$$\nwith $v_{\\text{ex}}(\\mathbf{r}) \\equiv \\delta F_{\\text{ex}}[n]/\\delta n(\\mathbf{r})$.\n\nB. A naive Picard fixed-point iteration that updates $n(\\mathbf{r})$ by direct substitution into the right-hand side of the KS-like equation always converges for any attractive fluid because $F_{\\text{ex}}[n]$ is a convex functional.\n\nC. An under-relaxed fixed-point scheme of the form\n$$\nn_{k+1}(\\mathbf{r}) \\;=\\; (1-\\alpha)\\, n_{k}(\\mathbf{r}) \\;+\\; \\alpha\\, \\frac{1}{\\Lambda^{3}} \\exp\\!\\Big\\{-\\beta\\big[V_{\\text{ext}}(\\mathbf{r}) + v_{\\text{ex}}[n_{k}](\\mathbf{r}) - \\mu\\big]\\Big\\},\n$$\nwith $0<\\alpha\\le 1$, is a valid iteration; choosing smaller $\\alpha$ generally improves robustness at the expense of speed.\n\nD. A Newton–Raphson method for solving the Euler–Lagrange condition requires inverting only the kernel $\\beta\\, \\delta^{2}F_{\\text{ex}}[n]/\\delta n(\\mathbf{r})\\delta n(\\mathbf{r}')$; the ideal-gas contribution does not enter the Jacobian.\n\nE. In a discretized representation, the linear system arising in a Newton step can be written as\n$$\n\\Big[k_{\\mathrm{B}}T\\,\\mathrm{diag}\\!\\big(1/n_{k}\\big) + H_{\\text{ex}}[n_{k}]\\Big]\\, \\delta \\mathbf{n} \\;=\\; -\\mathbf{R}[n_{k}],\n$$\nwhere $H_{\\text{ex}}[n_{k}]$ is the discretized Hessian of $F_{\\text{ex}}[n]$ at $n_{k}$ and $\\mathbf{R}[n_{k}]$ is the discretized residual; iterative Krylov solvers such as biconjugate gradient can be used to solve for $\\delta \\mathbf{n}$.\n\nF. In the canonical ensemble at fixed particle number $N$, one cannot use an Euler–Lagrange stationarity condition because the chemical potential $\\mu$ is undefined; therefore, a density functional approach based on variational minimization is not applicable.", "solution": "The problem statement is critically validated and found to be valid. It is scientifically grounded in classical density functional theory, well-posed, objective, and internally consistent. I will now proceed with the derivation and evaluation.\n\nThe grand potential functional $\\Omega[n]$ for a one-component classical fluid in an external potential $V_{\\text{ext}}(\\mathbf{r})$ at fixed chemical potential $\\mu$ and temperature $T$ is given by\n$$\n\\Omega[n] = F_{\\text{id}}[n] + F_{\\text{ex}}[n] + \\int \\mathrm{d}\\mathbf{r}\\, n(\\mathbf{r})\\left[V_{\\text{ext}}(\\mathbf{r}) - \\mu\\right]\n$$\nwhere $n(\\mathbf{r})$ is the number density, and the ideal-gas free energy functional is\n$$\nF_{\\text{id}}[n] = k_{\\mathrm{B}} T \\int \\mathrm{d}\\mathbf{r}\\, n(\\mathbf{r})\\left[\\ln\\!\\left(\\Lambda^{3} n(\\mathbf{r})\\right) - 1\\right]\n$$\nThe equilibrium density profile $n^{\\star}(\\mathbf{r})$ minimizes this functional. The stationarity condition is obtained by setting the functional derivative of $\\Omega[n]$ with respect to $n(\\mathbf{r})$ to zero: $\\delta \\Omega[n] / \\delta n(\\mathbf{r}) = 0$.\n\nLet us compute the functional derivative of each term in $\\Omega[n]$.\n\nThe derivative of the ideal-gas part $F_{\\text{id}}[n]$ is found by applying the standard rule for a local functional $\\int f(n(\\mathbf{r})) \\mathrm{d}\\mathbf{r}$, which gives $\\delta F_{\\text{id}}[n]/\\delta n(\\mathbf{r}) = \\partial f/\\partial n$.\nThe integrand is $f(n) = k_{\\mathrm{B}} T n (\\ln(\\Lambda^3 n) - 1)$.\nUsing the product rule for differentiation:\n$$\n\\frac{\\delta F_{\\text{id}}[n]}{\\delta n(\\mathbf{r})} = \\frac{\\partial}{\\partial n(\\mathbf{r})} \\left(k_{\\mathrm{B}} T n(\\mathbf{r})\\left[\\ln\\!\\left(\\Lambda^{3} n(\\mathbf{r})\\right) - 1\\right]\\right) = k_{\\mathrm{B}} T \\left(1 \\cdot \\left[\\ln\\!\\left(\\Lambda^{3} n(\\mathbf{r})\\right) - 1\\right] + n(\\mathbf{r}) \\cdot \\frac{1}{n(\\mathbf{r})}\\right)\n$$\n$$\n\\frac{\\delta F_{\\text{id}}[n]}{\\delta n(\\mathbf{r})} = k_{\\mathrm{B}} T \\left[\\ln\\!\\left(\\Lambda^{3} n(\\mathbf{r})\\right) - 1 + 1\\right] = k_{\\mathrm{B}} T \\ln\\!\\left(\\Lambda^{3} n(\\mathbf{r})\\right)\n$$\nThe derivative of the excess part $F_{\\text{ex}}[n]$ is given by its definition, $v_{\\text{ex}}[n](\\mathbf{r}) \\equiv \\delta F_{\\text{ex}}[n]/\\delta n(\\mathbf{r})$.\n\nThe derivative of the external potential and chemical potential term is:\n$$\n\\frac{\\delta}{\\delta n(\\mathbf{r})} \\int \\mathrm{d}\\mathbf{r}'\\, n(\\mathbf{r}')\\left[V_{\\text{ext}}(\\mathbf{r}') - \\mu\\right] = V_{\\text{ext}}(\\mathbf{r}) - \\mu\n$$\nCombining these results, the Euler–Lagrange stationarity condition $\\delta \\Omega[n]/\\delta n(\\mathbf{r}) = 0$ becomes:\n$$\nk_{\\mathrm{B}} T \\ln\\!\\left(\\Lambda^{3} n(\\mathbf{r})\\right) + v_{\\text{ex}}[n](\\mathbf{r}) + V_{\\text{ext}}(\\mathbf{r}) - \\mu = 0\n$$\nThis equation is a condition for the equilibrium density $n(\\mathbf{r})$. To obtain the Kohn–Sham-like form, we rearrange the equation to isolate the density term:\n$$\nk_{\\mathrm{B}} T \\ln\\!\\left(\\Lambda^{3} n(\\mathbf{r})\\right) = -\\left[V_{\\text{ext}}(\\mathbf{r}) + v_{\\text{ex}}[n](\\mathbf{r}) - \\mu\\right]\n$$\nUsing the definition $\\beta \\equiv 1/(k_{\\mathrm{B}}T)$, we divide by $k_{\\mathrm{B}}T$:\n$$\n\\ln\\!\\left(\\Lambda^{3} n(\\mathbf{r})\\right) = -\\beta\\left[V_{\\text{ext}}(\\mathbf{r}) + v_{\\text{ex}}[n](\\mathbf{r}) - \\mu\\right]\n$$\nThis is a self-consistent equation for $n(\\mathbf{r})$ because $v_{\\text{ex}}[n](\\mathbf{r})$ is a functional of the density itself. We can write an explicit expression for $n(\\mathbf{r})$ by exponentiating:\n$$\nn(\\mathbf{r}) = \\frac{1}{\\Lambda^3} \\exp\\left\\{-\\beta\\left[V_{\\text{ext}}(\\mathbf{r}) + v_{\\text{ex}}[n](\\mathbf{r}) - \\mu\\right]\\right\\}\n$$\nThis structure is analogous to the Kohn–Sham approach in electronic structure theory, as it expresses the density of the interacting system as the density of a fictitious non-interacting system in an effective potential $V_{\\text{eff}}[n](\\mathbf{r}) = V_{\\text{ext}}(\\mathbf{r}) + v_{\\text{ex}}[n](\\mathbf{r})$.\n\nThis self-consistent equation suggests a fixed-point iteration scheme (Picard iteration) for its solution:\n$$\nn_{k+1}(\\mathbf{r}) = \\frac{1}{\\Lambda^3} \\exp\\left\\{-\\beta\\left[V_{\\text{ext}}(\\mathbf{r}) + v_{\\text{ex}}[n_{k}](\\mathbf{r}) - \\mu\\right]\\right\\}\n$$\nThis simple iteration is often numerically unstable, particularly for strongly attractive interactions or near phase transitions. To improve convergence, one can employ mixing schemes. A common method is linear mixing (under-relaxation), where the next iterate is a linear combination of the old iterate and the new output:\n$$\nn_{k+1}(\\mathbf{r}) = (1-\\alpha) n_{k}(\\mathbf{r}) + \\alpha n_{\\text{out}}[n_k](\\mathbf{r})\n$$\nwhere $n_{\\text{out}}[n_k]$ is the right-hand side of the Picard iteration equation and $0 < \\alpha \\leq 1$ is a mixing parameter. A smaller $\\alpha$ provides greater stability (robustness) but typically slows the rate of convergence.\n\nNow, we evaluate each of the provided options.\n\n**A. The Euler–Lagrange condition yields a Kohn–Sham-like form $\\ln\\!\\left(\\Lambda^{3} n(\\mathbf{r})\\right) \\;=\\; -\\beta\\left[V_{\\text{ext}}(\\mathbf{r}) + v_{\\text{ex}}(\\mathbf{r}) - \\mu\\right]$, with $v_{\\text{ex}}(\\mathbf{r}) \\equiv \\delta F_{\\text{ex}}[n]/\\delta n(\\mathbf{r})$.**\nOur derivation above yielded exactly this equation:\n$k_{\\mathrm{B}} T \\ln\\!\\left(\\Lambda^{3} n(\\mathbf{r})\\right) + v_{\\text{ex}}[n](\\mathbf{r}) + V_{\\text{ext}}(\\mathbf{r}) - \\mu = 0$.\nRearranging and dividing by $k_{\\mathrm{B}} T = 1/\\beta$ gives $\\ln\\!\\left(\\Lambda^{3} n(\\mathbf{r})\\right) = -\\beta\\left[V_{\\text{ext}}(\\mathbf{r}) + v_{\\text{ex}}[n](\\mathbf{r}) - \\mu\\right]$. The notation $v_{\\text{ex}}(\\mathbf{r})$ is understood to be the functional derivative evaluated at density $n(\\mathbf{r})$.\n**Verdict: Correct.**\n\n**B. A naive Picard fixed-point iteration that updates $n(\\mathbf{r})$ by direct substitution into the right-hand side of the KS-like equation always converges for any attractive fluid because $F_{\\text{ex}}[n]$ is a convex functional.**\nThis statement is incorrect. Picard iteration for classical DFT is well-known to be unstable near phase transitions, which are characteristic of systems with attractive interactions. The iteration converges only if the spectral radius of the iteration operator's Jacobian is less than $1$. This condition is violated near critical points or spinodal lines. Furthermore, the convexity of $F_{\\text{ex}}[n]$ does not guarantee convergence of a naive Picard iteration. While convexity of the full grand potential functional $\\Omega[n]$ ensures a unique minimum, it does not dictate the convergence properties of a specific iterative algorithm used to find that minimum.\n**Verdict: Incorrect.**\n\n**C. An under-relaxed fixed-point scheme of the form $n_{k+1}(\\mathbf{r}) \\;=\\; (1-\\alpha)\\, n_{k}(\\mathbf{r}) \\;+\\; \\alpha\\, \\frac{1}{\\Lambda^{3}} \\exp\\!\\Big\\{-\\beta\\big[V_{\\text{ext}}(\\mathbf{r}) + v_{\\text{ex}}[n_{k}](\\mathbf{r}) - \\mu\\big]\\Big\\}$, with $0<\\alpha\\le 1$, is a valid iteration; choosing smaller $\\alpha$ generally improves robustness at the expense of speed.**\nThis equation describes linear mixing. The term with the exponential is the new proposed density, $n_{\\text{out}}[n_k]$, computed from the previous iterate $n_k$. The new iterate $n_{k+1}$ is a weighted average of the old density and the new proposed density. This is a standard and valid technique to stabilize self-consistent field calculations. Decreasing the mixing parameter $\\alpha$ dampens oscillations and can prevent divergence, thus improving robustness. However, smaller steps require more iterations to reach convergence, thus reducing the speed. The statement accurately describes this method and its properties.\n**Verdict: Correct.**\n\n**D. A Newton–Raphson method for solving the Euler–Lagrange condition requires inverting only the kernel $\\beta\\, \\delta^{2}F_{\\text{ex}}[n]/\\delta n(\\mathbf{r})\\delta n(\\mathbf{r}')$; the ideal-gas contribution does not enter the Jacobian.**\nThe Newton–Raphson method solves $R[n](\\mathbf{r}) = 0$, where $R[n](\\mathbf{r}) = \\delta \\Omega[n]/\\delta n(\\mathbf{r})$. It requires the inversion of the Jacobian (Hessian of $\\Omega$), $J(\\mathbf{r}, \\mathbf{r}') = \\delta R[n](\\mathbf{r})/\\delta n(\\mathbf{r}')$.\nThe residual is $R[n](\\mathbf{r}) = k_{\\mathrm{B}} T \\ln\\!\\left(\\Lambda^{3} n(\\mathbf{r})\\right) + v_{\\text{ex}}[n](\\mathbf{r}) + V_{\\text{ext}}(\\mathbf{r}) - \\mu$.\nThe Jacobian is $J(\\mathbf{r}, \\mathbf{r}') = \\frac{\\delta^2 \\Omega[n]}{\\delta n(\\mathbf{r}) \\delta n(\\mathbf{r}')}$.\nThe ideal-gas contribution is $\\frac{\\delta}{\\delta n(\\mathbf{r}')} \\left( k_{\\mathrm{B}} T \\ln(\\Lambda^3 n(\\mathbf{r})) \\right) = \\frac{k_{\\mathrm{B}} T}{n(\\mathbf{r})} \\delta(\\mathbf{r}-\\mathbf{r}')$. This term is not zero. The full Jacobian is $J(\\mathbf{r}, \\mathbf{r}') = \\frac{k_{\\mathrm{B}} T}{n(\\mathbf{r})} \\delta(\\mathbf{r}-\\mathbf{r}') + \\frac{\\delta^2 F_{\\text{ex}}[n]}{\\delta n(\\mathbf{r})\\delta n(\\mathbf{r}')}$. The statement incorrectly claims that the ideal-gas contribution does not enter the Jacobian.\n**Verdict: Incorrect.**\n\n**E. In a discretized representation, the linear system arising in a Newton step can be written as $\\Big[k_{\\mathrm{B}}T\\,\\mathrm{diag}\\!\\big(1/n_{k}\\big) + H_{\\text{ex}}[n_{k}]\\Big]\\, \\delta \\mathbf{n} \\;=\\; -\\mathbf{R}[n_{k}]$, where $H_{\\text{ex}}[n_{k}]$ is the discretized Hessian of $F_{\\text{ex}}[n]$ at $n_{k}$ and $\\mathbf{R}[n_{k}]$ is the discretized residual; iterative Krylov solvers such as biconjugate gradient can be used to solve for $\\delta \\mathbf{n}$.**\nThis statement correctly describes the discretized form of the Newton–Raphson method. The Jacobian $J$ is discretized into a matrix. The term $\\frac{k_{\\mathrm{B}} T}{n(\\mathbf{r})} \\delta(\\mathbf{r}-\\mathbf{r}')$ becomes a diagonal matrix $k_{\\mathrm{B}}T\\,\\mathrm{diag}(1/n_i)$, where $n_i$ are the density values at grid points. The term $\\frac{\\delta^2 F_{\\text{ex}}[n]}{\\delta n(\\mathbf{r})\\delta n(\\mathbf{r}')}$ becomes the Hessian matrix $H_{\\text{ex}}$. The Newton step is $\\delta \\mathbf{n} = -J^{-1}\\mathbf{R}$, which is equivalent to solving the linear system $J\\,\\delta\\mathbf{n} = -\\mathbf{R}$. The resulting linear system is large and the Jacobian matrix is typically non-symmetric, making iterative Krylov subspace methods like biconjugate gradient (BiCG) or its stabilized variants (e.g., BiCGSTAB) appropriate solution techniques.\n**Verdict: Correct.**\n\n**F. In the canonical ensemble at fixed particle number $N$, one cannot use an Euler–Lagrange stationarity condition because the chemical potential $\\mu$ is undefined; therefore, a density functional approach based on variational minimization is not applicable.**\nThis statement is fundamentally false. Density functional theory is readily applicable to the canonical ensemble (fixed $N, V, T$). The Helmholtz free energy functional $F[n]$ is minimized subject to the constraint $\\int \\mathrm{d}\\mathbf{r}\\, n(\\mathbf{r}) = N$. This constrained optimization is handled by the method of Lagrange multipliers, where the chemical potential $\\mu$ emerges as the Lagrange multiplier associated with the particle number constraint. The Euler–Lagrange equation is solved with $\\mu$ being an adjustable parameter chosen to satisfy the constraint, rather than a fixed input as in the grand canonical ensemble. Thus, a variational DFT approach is perfectly valid.\n**Verdict: Incorrect.**", "answer": "$$\\boxed{ACE}$$", "id": "2763922"}]}