{"hands_on_practices": [{"introduction": "A primary application of TD-DFT is to determine the geometries and vibrational frequencies of electronic excited states. This practice uses the displaced harmonic oscillator model, a cornerstone of molecular spectroscopy, to connect these computational results to observable photophysical properties. By calculating the reorganization energy $\\lambda$ from the geometric displacement $\\Delta Q$ between the ground and excited states, you will derive the vertical absorption and emission energies and quantify the resulting Stokes shift [@problem_id:2466206].", "problem": "Consider a model consistent with linear-response time-dependent density functional theory (TD-DFT) in which the ground and first excited electronic states of a molecule are represented by displaced harmonic potentials that share the same set of normal modes. Let there be $M$ independent normal modes with dimensionless normal coordinates $\\{Q_i\\}_{i=1}^M$. The ground-state potential energy surface is minimized at $\\mathbf{Q}=\\mathbf{0}$, and the excited-state potential energy surface is minimized at $\\mathbf{Q}=\\Delta \\mathbf{Q}$ with components $\\{\\Delta Q_i\\}_{i=1}^M$. Each mode $i$ has a vibrational quantum $\\hbar \\omega_i$ expressed in $\\mathrm{eV}$. The adiabatic $0\\text{–}0$ energy gap between the minima is $E_{00}$ in $\\mathrm{eV}$. Assume the Condon approximation, no Duschinsky rotation, identical curvatures between states, and that zero-point energy differences are negligible under these assumptions.\n\nThe Huang–Rhys factor (dimensionless) for mode $i$ is defined by $S_i = \\dfrac{(\\Delta Q_i)^2}{2}$. Using first principles of the displaced-harmonic model and the Franck–Condon principle, determine for each parameter set the following quantities:\n- the vertical absorption energy $E_{\\text{abs}}$ in $\\mathrm{eV}$,\n- the vertical emission energy $E_{\\text{em}}$ in $\\mathrm{eV}$,\n- the Stokes shift $\\Delta_{\\text{Stokes}}$ in $\\mathrm{eV}$,\n- and a boolean value `b` that is `True` if $\\Delta_{\\text{Stokes}}$ is at least as large as a given target $T$ (in $\\mathrm{eV}$), and `False` otherwise.\n\nReport all energies in $\\mathrm{eV}$, rounded to $6$ decimal places. The boolean value must be determined using the comparison $\\Delta_{\\text{Stokes}} \\ge T$. Angles do not appear in this problem. No percentages appear in this problem.\n\nTest suite (each case specifies $(E_{00}, \\{\\hbar \\omega_i\\}, \\{\\Delta Q_i\\}, T)$):\n- Case $1$: $E_{00} = 2.50$, $\\{\\hbar \\omega_i\\} = [0.200,\\,0.150]$, $\\{\\Delta Q_i\\} = [1.0,\\,0.5]$, $T = 0.20$.\n- Case $2$: $E_{00} = 2.20$, $\\{\\hbar \\omega_i\\} = [0.100,\\,0.200]$, $\\{\\Delta Q_i\\} = [0.0,\\,0.0]$, $T = 0.05$.\n- Case $3$: $E_{00} = 1.80$, $\\{\\hbar \\omega_i\\} = [0.050,\\,0.080,\\,0.120]$, $\\{\\Delta Q_i\\} = [2.0,\\,1.0,\\,0.5]$, $T = 0.31$.\n- Case $4$: $E_{00} = 3.00$, $\\{\\hbar \\omega_i\\} = [0.180]$, $\\{\\Delta Q_i\\} = [3.0]$, $T = 1.70$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each test case result is itself a list of the form $[E_{\\text{abs}}, E_{\\text{em}}, \\Delta_{\\text{Stokes}}, b]$. The formatting must have no extra spaces, and energies must be rounded to $6$ decimal places. For example, a valid output looks like `[[2.618750,2.381250,0.237500,True],[2.200000,2.200000,0.000000,False]]` where numeric strings are rounded to $6$ decimals.", "solution": "The problem statement is assessed to be valid. It is scientifically grounded in the principles of quantum mechanics and molecular spectroscopy, specifically the displaced harmonic oscillator model used to interpret vibronic spectra. The problem is well-posed, objective, and provides all necessary information to derive a unique solution for each test case. The provided physical parameters are realistic.\n\nThe solution is derived from the first principles of the specified model. The model consists of two electronic states, a ground state ($g$) and an excited state ($e$), whose potential energy surfaces, $U_g$ and $U_e$, are described as multidimensional harmonic potentials in the basis of $M$ dimensionless normal coordinates $\\{Q_i\\}_{i=1}^M$.\n\nThe ground state potential energy surface, $U_g(\\mathbf{Q})$, is defined with its minimum at the origin $\\mathbf{Q}=\\mathbf{0}$ and is given by:\n$$ U_g(\\mathbf{Q}) = \\sum_{i=1}^{M} \\frac{1}{2} \\hbar \\omega_i Q_i^2 $$\nwhere $\\hbar \\omega_i$ is the vibrational quantum for mode $i$. The energy at the minimum is $U_g(\\mathbf{0}) = 0$.\n\nThe excited state potential energy surface, $U_e(\\mathbf{Q})$, has the same vibrational frequencies (identical curvatures) but its minimum is displaced to $\\mathbf{Q} = \\Delta \\mathbf{Q}$ and shifted in energy by the adiabatic $0\\text{–}0$ energy gap, $E_{00}$. Its form is:\n$$ U_e(\\mathbf{Q}) = E_{00} + \\sum_{i=1}^{M} \\frac{1}{2} \\hbar \\omega_i (Q_i - \\Delta Q_i)^2 $$\nThe energy at the excited state minimum is $U_e(\\Delta \\mathbf{Q}) = E_{00}$.\n\nThe Franck-Condon principle dictates that electronic transitions (absorption and emission) are vertical, meaning they occur instantaneously on the timescale of nuclear motion. Thus, the nuclear coordinates do not change during the transition.\n\nThe vertical absorption energy, $E_{\\text{abs}}$, corresponds to a transition from the equilibrium geometry of the ground state ($\\mathbf{Q}=\\mathbf{0}$) to the excited state. It is the energy difference between the two states at $\\mathbf{Q}=\\mathbf{0}$:\n$$ E_{\\text{abs}} = U_e(\\mathbf{0}) - U_g(\\mathbf{0}) $$\nSubstituting the expressions for the potentials:\n$$ E_{\\text{abs}} = \\left( E_{00} + \\sum_{i=1}^{M} \\frac{1}{2} \\hbar \\omega_i (0 - \\Delta Q_i)^2 \\right) - 0 = E_{00} + \\sum_{i=1}^{M} \\frac{1}{2} \\hbar \\omega_i (\\Delta Q_i)^2 $$\nWe define the reorganization energy, $\\lambda$, as the energy required to distort the ground state geometry to the excited state equilibrium geometry:\n$$ \\lambda = U_g(\\Delta \\mathbf{Q}) - U_g(\\mathbf{0}) = \\sum_{i=1}^{M} \\frac{1}{2} \\hbar \\omega_i (\\Delta Q_i)^2 $$\nThus, the absorption energy can be written as:\n$$ E_{\\text{abs}} = E_{00} + \\lambda $$\n\nThe vertical emission energy, $E_{\\text{em}}$, corresponds to a transition from the equilibrium geometry of the excited state ($\\mathbf{Q}=\\Delta \\mathbf{Q}$) to the ground state. It is the energy difference between the two states at $\\mathbf{Q}=\\Delta \\mathbf{Q}$:\n$$ E_{\\text{em}} = U_e(\\Delta \\mathbf{Q}) - U_g(\\Delta \\mathbf{Q}) $$\nSubstituting the potential expressions and the definition of $\\lambda$:\n$$ E_{\\text{em}} = E_{00} - \\sum_{i=1}^{M} \\frac{1}{2} \\hbar \\omega_i (\\Delta Q_i)^2 = E_{00} - \\lambda $$\n\nThe Stokes shift, $\\Delta_{\\text{Stokes}}$, is the difference between the vertical absorption and emission energies:\n$$ \\Delta_{\\text{Stokes}} = E_{\\text{abs}} - E_{\\text{em}} $$\nSubstituting the derived expressions for $E_{\\text{abs}}$ and $E_{\\text{em}}$:\n$$ \\Delta_{\\text{Stokes}} = (E_{00} + \\lambda) - (E_{00} - \\lambda) = 2\\lambda $$\nThis can be expressed explicitly in terms of the given parameters:\n$$ \\Delta_{\\text{Stokes}} = 2 \\sum_{i=1}^{M} \\frac{1}{2} \\hbar \\omega_i (\\Delta Q_i)^2 = \\sum_{i=1}^{M} \\hbar \\omega_i (\\Delta Q_i)^2 $$\nThe problem defines the Huang-Rhys factor as $S_i = \\frac{(\\Delta Q_i)^2}{2}$. The reorganization energy can also be written as $\\lambda = \\sum_i S_i \\hbar\\omega_i$.\n\nFinally, the boolean value $b$ is determined by a direct comparison of the calculated Stokes shift with the given target value $T$:\n$$ b = (\\Delta_{\\text{Stokes}} \\ge T) $$\n\nThe algorithm for a given parameter set $(E_{00}, \\{\\hbar \\omega_i\\}, \\{\\Delta Q_i\\}, T)$ is as follows:\n$1$. Calculate the total reorganization energy $\\lambda = \\sum_{i=1}^{M} \\frac{1}{2} \\hbar \\omega_i (\\Delta Q_i)^2$.\n$2$. Calculate $E_{\\text{abs}} = E_{00} + \\lambda$.\n$3$. Calculate $E_{\\text{em}} = E_{00} - \\lambda$.\n$4$. Calculate $\\Delta_{\\text{Stokes}} = 2\\lambda$.\n$5$. Determine $b$ by evaluating the condition $\\Delta_{\\text{Stokes}} \\ge T$.\n$6$. Report the energies rounded to $6$ decimal places and the boolean value.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for vertical absorption/emission energies, Stokes shift, and a boolean\n    comparison based on a displaced harmonic oscillator model.\n    \"\"\"\n    # Test suite with parameters (E_00, {hbar*omega_i}, {Delta Q_i}, T).\n    # All energies are in eV. Delta Q_i are dimensionless.\n    test_cases = [\n        # Case 1\n        (2.50, [0.200, 0.150], [1.0, 0.5], 0.20),\n        # Case 2\n        (2.20, [0.100, 0.200], [0.0, 0.0], 0.05),\n        # Case 3\n        (1.80, [0.050, 0.080, 0.120], [2.0, 1.0, 0.5], 0.31),\n        # Case 4\n        (3.00, [0.180], [3.0], 1.70),\n    ]\n\n    results_str_list = []\n    for case in test_cases:\n        E00, hw_list, dQ_list, T = case\n        \n        # Convert lists to NumPy arrays for efficient vectorized calculations.\n        hw = np.array(hw_list)\n        dQ = np.array(dQ_list)\n\n        # Calculate the total reorganization energy (lambda) in eV.\n        # lambda = sum_i (1/2 * hbar*omega_i * (Delta Q_i)^2)\n        reorganization_energy = 0.5 * np.sum(hw * (dQ**2))\n        \n        # Calculate the vertical absorption energy (E_abs) in eV.\n        E_abs = E00 + reorganization_energy\n        \n        # Calculate the vertical emission energy (E_em) in eV.\n        E_em = E00 - reorganization_energy\n        \n        # The Stokes shift is the difference between absorption and emission,\n        # which equals twice the reorganization energy.\n        Delta_Stokes = 2.0 * reorganization_energy\n        \n        # Determine the boolean value by comparing the Stokes shift to the target T.\n        b = Delta_Stokes >= T\n        \n        # Format the results as a string according to requirements.\n        # Energies are rounded to 6 decimal places.\n        # Boolean is converted to a string ('True' or 'False').\n        case_result_str = (\n            f\"[{E_abs:.6f},\"\n            f\"{E_em:.6f},\"\n            f\"{Delta_Stokes:.6f},\"\n            f\"{str(b)}]\"\n        )\n        results_str_list.append(case_result_str)\n\n    # Join all case results into a single string for the final output.\n    final_output = f\"[{','.join(results_str_list)}]\"\n    print(final_output)\n\nsolve()\n```", "id": "2466206"}, {"introduction": "While TD-DFT is a versatile tool, its application requires awareness of the limitations inherent in common exchange-correlation functionals. This exercise tackles the famous failure of semi-local functionals to describe long-range charge-transfer (CT) excitations, a critical issue in systems like donor-acceptor pairs. By deriving the CT energy from fundamental principles and comparing it to the flawed TD-GGA prediction, you will uncover how the lack of the correct $-1/R$ asymptotic dependence leads to a catastrophic underestimation of the excitation energy [@problem_id:2466214].", "problem": "You are asked to write a complete, runnable program that demonstrates, within a minimal but scientifically grounded model, how Time-Dependent Density Functional Theory (TD-DFT) using a standard Generalized Gradient Approximation (GGA) functional can wrongly predict a spuriously low-energy charge-transfer excitation in a spatially separated donor–acceptor pair. Your program must implement the following logic from first principles.\n\nBegin from the fundamental definitions of ionization potential and electron affinity in density functional theory (DFT), and from the electrostatic interaction of separated charges. Use these principles to derive an expression for the lowest donor-to-acceptor charge-transfer excitation energy at large separation. Then, using linear-response TD-DFT and the fact that for spatially nonoverlapping orbitals the adiabatic semilocal Hartree–exchange–correlation kernel yields vanishing coupling, derive the corresponding prediction made by a semilocal GGA functional. Finally, connect the Kohn–Sham orbital energy difference to the fundamental gap by including the derivative discontinuity. Do not use or quote any pre-existing shortcut formulas in your derivation; instead, reason from the following foundational bases only:\n- Fundamental definitions: the ionization potential $I$ and electron affinity $A$ defined via total energy differences, and the electrostatic interaction energy of two unit charges separated by a distance $R$.\n- Linear-response theory core ideas: that the excitation energy arises from a response pole determined by a noninteracting transition energy and a coupling term, and that for charge-transfer between spatially separated fragments with negligible orbital overlap, a local and adiabatic kernel provides negligible long-range coupling.\n- The well-tested conceptual fact that the many-body fundamental gap is related to the Kohn–Sham gap by the derivative discontinuity.\n\nImplement a minimal two-fragment model with the following parameters for each test case:\n- Donor ionization potential $I_D$ in Hartree.\n- Acceptor electron affinity $A_A$ in Hartree.\n- Center-to-center separation $R$ in bohr.\n- An effective positive derivative-discontinuity parameter $\\Delta_{\\mathrm{xc}}$ in Hartree that captures the gap underestimation characteristic of a semilocal GGA functional.\n\nFor each test case, compute:\n1. The physically motivated large-separation charge-transfer excitation energy, based on the above principles, expressed in Hartree and denoted here as $E_{\\mathrm{true}}$.\n2. The adiabatic semilocal GGA TD-DFT prediction for the same charge-transfer excitation, expressed in Hartree and denoted here as $E_{\\mathrm{GGA}}$.\n3. The signed error $\\Delta E = E_{\\mathrm{GGA}} - E_{\\mathrm{true}}$ in Hartree.\n4. A boolean flag that is true if and only if the GGA prediction is spuriously low, defined by the strict inequality $E_{\\mathrm{GGA}} < E_{\\mathrm{true}}$.\n\nYour program must use the following fixed test suite of parameter tuples $(I_D,A_A,R,\\Delta_{\\mathrm{xc}})$, in atomic units (Hartree for energies, bohr for distances):\n- Test 1 (general separated pair): $(0.30, 0.08, 30.0, 0.12)$.\n- Test 2 (very large separation): $(0.30, 0.08, 200.0, 0.12)$.\n- Test 3 (small fundamental gap leading to near-zero GGA excitation): $(0.20, 0.08, 25.0, 0.12)$.\n- Test 4 (numerical balance where the underestimation equals the missing electrostatics at this $R$): $(0.25, 0.05, 25/3, 0.12)$.\n\nAll energies must be expressed in Hartree and rounded to six decimal places. For each test case, your program must output the four values $E_{\\mathrm{true}}$, $E_{\\mathrm{GGA}}$, $\\Delta E$, and the boolean flag, in that order. Aggregate the results for all test cases into a single flat list. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[result1,result2,result3,...]\").\n\nAngle units are not involved. No external input is permitted; the program must be fully self-contained and produce the required single-line output upon execution.", "solution": "The problem statement is scientifically grounded, well-posed, and contains all necessary information to derive a unique solution. It describes a well-known failure mode of common density functional approximations. The problem is therefore deemed valid, and a solution will be constructed based on the provided first principles.\n\nWe begin by deriving the expression for the physically correct charge-transfer ($CT$) excitation energy at large separation, denoted $E_{\\mathrm{true}}$. A $CT$ excitation involves moving an electron from a donor molecule, $D$, to an acceptor molecule, $A$, separated by a distance $R$. This process can be represented as $D^0A^0 \\rightarrow D^+A^-$. The energy of this excitation, $\\omega_{CT}$, is the difference in the total energies of the final and initial states:\n$$ \\omega_{CT} = E(D^+A^-) - E(D^0A^0) $$\nIn the limit of large separation $R$, the energy of a combined system can be approximated as the sum of the energies of its non-interacting constituent fragments plus their classical electrostatic interaction energy. For the initial neutral state, this is:\n$$ E(D^0A^0) \\approx E(D^0) + E(A^0) $$\nFor the final ionic state, the energy includes the electrostatic attraction between the newly formed ions:\n$$ E(D^+A^-) \\approx E(D^+) + E(A^-) + E_{\\mathrm{int}} $$\nHere, $E(X)$ represents the total energy of species $X$. The interaction energy, $E_{\\mathrm{int}}$, between a point charge of $+1e$ on $D^+$ and $-1e$ on $A^-$ is given by Coulomb's law. In atomic units, where energy is in Hartree and distance is in bohr, this is:\n$$ E_{\\mathrm{int}} = -\\frac{1}{R} $$\nBy substituting these expressions into the equation for $\\omega_{CT}$, we obtain:\n$$ \\omega_{CT} \\approx \\left( E(D^+) + E(A^-) - \\frac{1}{R} \\right) - \\left( E(D^0) + E(A^0) \\right) $$\nRearranging the terms to group them by species yields:\n$$ \\omega_{CT} \\approx \\left( E(D^+) - E(D^0) \\right) + \\left( E(A^-) - E(A^0) \\right) - \\frac{1}{R} $$\nThe terms in parentheses correspond to fundamental definitions. The ionization potential of the donor, $I_D$, is the energy required to remove an electron:\n$$ I_D = E(D^+) - E(D^0) $$\nThe electron affinity of the acceptor, $A_A$, is the energy released upon capturing an electron, defined as:\n$$ A_A = E(A^0) - E(A^-) $$\nFrom this definition, it follows that $E(A^-) - E(A^0) = -A_A$. By substituting these definitions for $I_D$ and $A_A$, we arrive at the expression for the true large-separation charge-transfer excitation energy:\n$$ E_{\\mathrm{true}} = I_D - A_A - \\frac{1}{R} $$\n\nNext, we derive the corresponding prediction from adiabatic semilocal Time-Dependent Density Functional Theory ($TD-DFT$), denoted $E_{\\mathrm{GGA}}$. Within linear-response $TD-DFT$, the excitation energies $\\omega$ are obtained as the eigenvalues of a matrix equation. For a single excitation from an occupied Kohn-Sham ($KS$) orbital $\\phi_i$ to a virtual $KS$ orbital $\\phi_a$, the excitation energy in the adiabatic approximation is given by:\n$$ \\omega_{ia} = \\varepsilon_a - \\varepsilon_i + K_{ia,ia} $$\nwhere $\\varepsilon_i$ and $\\varepsilon_a$ are the energies of the $KS$ orbitals, and $K_{ia,ia}$ is the coupling matrix element. This element depends on the Hartree-exchange-correlation ($HXC$) kernel, $f_{HXC}$:\n$$ K_{ia,ia} = \\iint \\phi_i^*(\\mathbf{r})\\phi_a(\\mathbf{r}) f_{HXC}(\\mathbf{r}, \\mathbf{r}') \\phi_a^*(\\mathbf{r}')\\phi_i(\\mathbf{r}') d\\mathbf{r} d\\mathbf{r}' $$\nFor the $CT$ excitation under consideration, the occupied orbital $\\phi_i$ is the highest occupied molecular orbital of the donor ($HOMO_D$) and the virtual orbital $\\phi_a$ is the lowest unoccupied molecular orbital of the acceptor ($LUMO_A$). At large separation $R$, these orbitals are spatially isolated, and their overlap product, $\\phi_i(\\mathbf{r})\\phi_a(\\mathbf{r})$, is negligible for all $\\mathbf{r}$.\nFor a semilocal functional, such as a Generalized Gradient Approximation ($GGA$), the kernel $f_{HXC}^{GGA}(\\mathbf{r}, \\mathbf{r}')$ is effectively local, meaning it vanishes rapidly as the distance $|\\mathbf{r} - \\mathbf{r}'|$ increases. The combination of a local kernel and vanishing orbital overlap causes the coupling integral $K_{ia,ia}$ to become zero:\n$$ K_{ia,ia}^{GGA} \\approx 0 $$\nConsequently, the $TD-GGA$ excitation energy spuriously reduces to the simple difference in the energies of the $KS$ orbitals involved:\n$$ E_{\\mathrm{GGA}} = \\omega_{CT}^{GGA} \\approx \\varepsilon_{LUMO,A} - \\varepsilon_{HOMO,D} $$\nTo make this expression useful, we must relate this $KS$ orbital energy gap to the physical quantities $I_D$ and $A_A$. The fundamental many-body gap of the combined $D-A$ system is $E_{gap} = I_D - A_A$. The corresponding $KS$ gap is $\\varepsilon_{gap}^{KS} = \\varepsilon_{LUMO,A} - \\varepsilon_{HOMO,D}$. For an exact functional, these quantities are related via the derivative discontinuity of the exchange-correlation potential, $\\Delta_{xc}$:\n$$ E_{gap} = \\varepsilon_{gap}^{KS} + \\Delta_{xc} \\implies I_D - A_A = (\\varepsilon_{LUMO,A} - \\varepsilon_{HOMO,D}) + \\Delta_{xc} $$\nApproximate functionals like $GGA$ are known to suffer from a systematic error that effectively corresponds to a missing derivative discontinuity. The problem provides an effective parameter, $\\Delta_{\\mathrm{xc}} > 0$, to model this deficiency. Rearranging the equation for the $KS$ gap as predicted within a $GGA$ framework gives:\n$$ \\varepsilon_{LUMO,A}^{GGA} - \\varepsilon_{HOMO,D}^{GGA} = (I_D - A_A) - \\Delta_{\\mathrm{xc}} $$\nThis provides the final expression for the $TD-GGA$ charge-transfer excitation energy:\n$$ E_{\\mathrm{GGA}} = I_D - A_A - \\Delta_{\\mathrm{xc}} $$\nThis result incorrectly shows the excitation energy approaching a constant value at large $R$, completely missing the correct $-1/R$ asymptotic behavior.\n\nFinally, we compute the signed error $\\Delta E$ and establish the condition for a spuriously low prediction. The error is the difference between the $GGA$ value and the true value:\n$$ \\Delta E = E_{\\mathrm{GGA}} - E_{\\mathrm{true}} = (I_D - A_A - \\Delta_{\\mathrm{xc}}) - \\left(I_D - A_A - \\frac{1}{R}\\right) $$\n$$ \\Delta E = \\frac{1}{R} - \\Delta_{\\mathrm{xc}} $$\nThe $GGA$ prediction is spuriously low if and only if $E_{\\mathrm{GGA}} < E_{\\mathrm{true}}$, which implies $\\Delta E < 0$. This gives the condition:\n$$ \\frac{1}{R} - \\Delta_{\\mathrm{xc}} < 0 \\implies \\frac{1}{R} < \\Delta_{\\mathrm{xc}} $$\nAs separation $R$ increases, $1/R$ decreases. For any system with a non-zero gap-underestimation error ($\\Delta_{\\mathrm{xc}} > 0$), there exists a separation beyond which this inequality holds, demonstrating the fundamental failure of adiabatic semilocal functionals for describing long-range charge transfer. The following program implements these derived formulas.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the true and TD-GGA charge-transfer excitation energies for a\n    series of donor-acceptor pairs to demonstrate the failure of semilocal DFT.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    # Each tuple is (I_D, A_A, R, delta_xc) in atomic units.\n    test_cases = [\n        # Test 1: General separated pair\n        (0.30, 0.08, 30.0, 0.12),\n        # Test 2: Very large separation\n        (0.30, 0.08, 200.0, 0.12),\n        # Test 3: Small fundamental gap\n        (0.20, 0.08, 25.0, 0.12),\n        # Test 4: Numerical balance point\n        (0.25, 0.05, 25.0/3.0, 0.12),\n    ]\n\n    results = []\n    for case in test_cases:\n        I_D, A_A, R, delta_xc = case\n        \n        # 1. Calculate the physically motivated charge-transfer energy, E_true.\n        # This is derived from E_true = I_D - A_A - 1/R.\n        E_true = I_D - A_A - 1.0/R\n        \n        # 2. Calculate the adiabatic semilocal GGA TD-DFT prediction, E_GGA.\n        # This is derived from E_GGA = I_D - A_A - delta_xc.\n        E_gga = I_D - A_A - delta_xc\n        \n        # 3. Calculate the signed error, delta_E.\n        # This is delta_E = E_GGA - E_true, which simplifies to 1/R - delta_xc.\n        delta_E = 1.0/R - delta_xc\n\n        # 4. Determine if the GGA prediction is spuriously low.\n        # This is true if E_GGA < E_true.\n        is_spurious = E_gga < E_true\n\n        # Append the four required results for this test case.\n        # Energies are rounded to six decimal places.\n        results.append(np.round(E_true, 6))\n        results.append(np.round(E_gga, 6))\n        results.append(np.round(delta_E, 6))\n        results.append(is_spurious)\n        \n    # Final print statement in the exact required format.\n    # The boolean `True`/`False` is converted to string \"True\"/\"False\".\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2466214"}, {"introduction": "Beyond the charge-transfer problem, another fundamental limitation of adiabatic TD-DFT is its inability to describe states with significant double-excitation character. This practice explores this issue using the textbook example of linear butadiene, whose low-lying $2^1A_g$ state is famously dominated by a double excitation from the HOMO to the LUMO. Within a simplified Hückel model, you will demonstrate that the spectrum generated by single-only excitations is constitutionally blind to this state, a critical insight for accurately interpreting calculated electronic spectra [@problem_id:2466175].", "problem": "Consider linear butadiene modeled as a chain of $4$ conjugated carbon $p_z$ orbitals within the Hückel tight-binding approximation. Let the site energies be zero and the nearest-neighbor couplings alternate along the chain. Specifically, label the sites as $1$–$4$ along the chain, and define the Hückel Hamiltonian $H \\in \\mathbb{R}^{4 \\times 4}$ in electronvolts (eV) as\n$$\nH = \\begin{pmatrix}\n0 & \\beta_1 & 0 & 0 \\\\\n\\beta_1 & 0 & \\beta_2 & 0 \\\\\n0 & \\beta_2 & 0 & \\beta_1 \\\\\n0 & 0 & \\beta_1 & 0\n\\end{pmatrix},\n$$\nwith $\\beta_1 = \\beta(1+\\delta)$ and $\\beta_2 = \\beta(1-\\delta)$, where $\\beta \\lt 0$ is the base coupling and $\\delta \\in [0,1)$ is a bond-alternation parameter. Assume $4$ $\\pi$-electrons, so that at zero temperature the two lowest-energy molecular orbitals are doubly occupied, and the two highest are empty.\n\nIn the adiabatic Tamm–Dancoff approximation (TDA) to Time-Dependent Density Functional Theory (TD-DFT), neglecting the electron–hole interaction kernel (independent-particle limit), the singlet excitation energies are equal to the set of all orbital energy differences $\\{\\varepsilon_a - \\varepsilon_i\\}$ with $i$ running over the $2$ occupied orbitals and $a$ over the $2$ virtual orbitals. The low-lying double excitation of interest, the $2^1A_g$ state in butadiene, is dominated by promoting two electrons from the highest occupied molecular orbital (HOMO) to the lowest unoccupied molecular orbital (LUMO). In the same independent-particle picture, a naive estimate of its energy is $2(\\varepsilon_{\\mathrm{LUMO}} - \\varepsilon_{\\mathrm{HOMO}})$.\n\nYour task is to write a program that, for each parameter set $(\\beta,\\delta,\\tau)$ given in the test suite below, performs the following, entirely in electronvolts (eV):\n\n1. Construct $H$ from $\\beta$ and $\\delta$ and determine all four orbital energies $\\varepsilon_1 \\le \\varepsilon_2 \\le \\varepsilon_3 \\le \\varepsilon_4$.\n2. Identify the two occupied orbital indices as those with the two lowest energies and the two virtual as those with the two highest energies.\n3. Form the set of all independent-particle (adiabatic TDA) singlet excitation energies $\\{\\varepsilon_a - \\varepsilon_i\\}$ where $i \\in \\{1,2\\}$ and $a \\in \\{3,4\\}$, and determine the lowest such excitation energy.\n4. Compute the naive double-excitation estimate $E_{\\mathrm{double}} = 2(\\varepsilon_3 - \\varepsilon_2)$.\n5. Decide whether the adiabatic TDA singles-only spectrum contains any excitation energy within a tolerance $\\tau$ of $E_{\\mathrm{double}}$, i.e., whether $\\min_{E \\in \\{\\varepsilon_a - \\varepsilon_i\\}} |E - E_{\\mathrm{double}}| \\le \\tau$.\n\nTest suite (each tuple is $(\\beta,\\delta,\\tau)$ in eV):\n- Case $1$: $(\\beta,\\delta,\\tau) = (-2.5,\\,0.2,\\,0.05)$.\n- Case $2$: $(\\beta,\\delta,\\tau) = (-2.0,\\,0.0,\\,0.05)$.\n- Case $3$: $(\\beta,\\delta,\\tau) = (-3.0,\\,0.4,\\,0.10)$.\n- Case $4$: $(\\beta,\\delta,\\tau) = (-2.5,\\,0.8,\\,0.10)$.\n\nOutput specification:\n- For each case, produce a list with three entries: $[E_{\\min}, E_{\\mathrm{double}}, \\mathrm{found}]$, where $E_{\\min}$ is the lowest independent-particle singlet excitation energy in eV, $E_{\\mathrm{double}}$ is the naive double-excitation estimate in eV, and $\\mathrm{found}$ is a boolean that is $\\mathrm{True}$ if and only if there exists an independent-particle singlet excitation within $\\tau$ of $E_{\\mathrm{double}}$ and $\\mathrm{False}$ otherwise.\n- Express $E_{\\min}$ and $E_{\\mathrm{double}}$ in eV, each rounded to three decimals.\n- Your program should produce a single line of output containing the results for all four test cases as a comma-separated list enclosed in square brackets. Each case’s triple must itself be enclosed in square brackets. For example: \"[[x1,y1,True],[x2,y2,False],[x3,y3,False],[x4,y4,True]]\", where $x_k$ and $y_k$ are decimal numbers rounded to three decimals.\n\nAnswer all energies in electronvolts (eV), rounded to three decimals as specified. Angles are not involved. Do not use percentages anywhere; if needed, use decimal fractions. The final output must be exactly one line in the format described above.", "solution": "The problem posed is a valid, well-defined problem in computational quantum chemistry. It requires the analysis of electronic excitation energies for a model of linear butadiene within the Hückel tight-binding framework, using concepts from time-dependent density functional theory (TD-DFT) in the independent-particle limit.\n\nThe fundamental scientific task is to determine the molecular orbital energies by solving the time-independent Schrödinger equation for the given system, which in a basis of atomic orbitals takes the form of a matrix eigenvalue problem:\n$$ H \\mathbf{c}_k = \\varepsilon_k \\mathbf{c}_k $$\nHere, $H$ is the Hückel Hamiltonian matrix, $\\varepsilon_k$ are the molecular orbital energies, and $\\mathbf{c}_k$ are the corresponding molecular orbital coefficients. The problem provides the explicit form of the $4 \\times 4$ Hamiltonian matrix for a chain of four sites, with site energies (diagonal elements) set to zero and alternating nearest-neighbor couplings (off-diagonal elements), $\\beta_1$ and $\\beta_2$:\n$$ H = \\begin{pmatrix} 0 & \\beta_1 & 0 & 0 \\\\ \\beta_1 & 0 & \\beta_2 & 0 \\\\ 0 & \\beta_2 & 0 & \\beta_1 \\\\ 0 & 0 & \\beta_1 & 0 \\end{pmatrix} $$\nThe couplings are defined in terms of a base coupling $\\beta < 0$ and a bond-alternation parameter $\\delta \\in [0,1)$:\n$$ \\beta_1 = \\beta(1+\\delta) $$\n$$ \\beta_2 = \\beta(1-\\delta) $$\nSince $H$ is a real symmetric matrix, its four eigenvalues, $\\varepsilon_1 \\le \\varepsilon_2 \\le \\varepsilon_3 \\le \\varepsilon_4$, are all real. These eigenvalues represent the energies of the four $\\pi$ molecular orbitals.\n\nThe system contains $4$ $\\pi$-electrons. According to the Aufbau principle, at zero temperature, these electrons occupy the lowest-energy orbitals available. Each orbital can hold two electrons of opposite spin. Thus, the two molecular orbitals with the lowest energies, $\\varepsilon_1$ and $\\varepsilon_2$, are doubly occupied. These form the set of occupied orbitals. The two higher-energy orbitals, with energies $\\varepsilon_3$ and $\\varepsilon_4$, are unoccupied and are called virtual orbitals. The Highest Occupied Molecular Orbital (HOMO) is the one with energy $\\varepsilon_{\\mathrm{HOMO}} = \\varepsilon_2$, and the Lowest Unoccupied Molecular Orbital (LUMO) has energy $\\varepsilon_{\\mathrm{LUMO}} = \\varepsilon_3$.\n\nThe problem then asks to consider electronic excitations within the adiabatic Tamm-Dancoff approximation (TDA) to TD-DFT, neglecting the interaction kernel. In this independent-particle picture, the singlet excitation energies are simply the differences in energy between virtual and occupied orbitals. The set of all such single-particle excitation energies, $E_{\\text{single}}$, is given by:\n$$ \\{ \\varepsilon_a - \\varepsilon_i \\mid i \\in \\{1, 2\\}, a \\in \\{3, 4\\} \\} $$\nThis gives four possible excitation energies: $\\varepsilon_3 - \\varepsilon_1$, $\\varepsilon_3 - \\varepsilon_2$, $\\varepsilon_4 - \\varepsilon_1$, and $\\varepsilon_4 - \\varepsilon_2$. The lowest of these is the HOMO-LUMO gap, $E_{\\min} = \\varepsilon_3 - \\varepsilon_2$.\n\nA naive estimate for the energy of a double excitation, corresponding to promoting two electrons from the HOMO to the LUMO, is given as:\n$$ E_{\\mathrm{double}} = 2(\\varepsilon_{\\mathrm{LUMO}} - \\varepsilon_{\\mathrm{HOMO}}) = 2(\\varepsilon_3 - \\varepsilon_2) $$\nThe core task is to determine if this double excitation energy is \"accidentally\" degenerate with any of the single excitation energies. This is tested by checking if the absolute difference between $E_{\\mathrm{double}}$ and any of the four single excitation energies is less than or equal to a given tolerance, $\\tau$. That is, we must check if the following condition holds:\n$$ \\min_{E \\in \\{\\varepsilon_a - \\varepsilon_i\\}} |E - E_{\\mathrm{double}}| \\le \\tau $$\n\nThe algorithmic procedure for each test case $(\\beta, \\delta, \\tau)$ is as follows:\n1.  Construct the matrix $H$ using the given $\\beta$ and $\\delta$.\n2.  Numerically compute the four eigenvalues of $H$. We label them in non-decreasing order: $\\varepsilon_1, \\varepsilon_2, \\varepsilon_3, \\varepsilon_4$.\n3.  Calculate the four single excitation energies: $E_{1 \\to 3} = \\varepsilon_3 - \\varepsilon_1$, $E_{2 \\to 3} = \\varepsilon_3 - \\varepsilon_2$, $E_{1 \\to 4} = \\varepsilon_4 - \\varepsilon_1$, and $E_{2 \\to 4} = \\varepsilon_4 - \\varepsilon_2$.\n4.  Identify the lowest single excitation energy, $E_{\\min} = E_{2 \\to 3} = \\varepsilon_3 - \\varepsilon_2$.\n5.  Calculate the naive double excitation energy estimate, $E_{\\mathrm{double}} = 2 \\cdot E_{\\min}$.\n6.  Compute the minimum absolute difference between $E_{\\mathrm{double}}$ and each of the four single excitation energies.\n7.  Compare this minimum difference to the tolerance $\\tau$ to determine the boolean value `found`.\n8.  Format the required output values, $E_{\\min}$ and $E_{\\mathrm{double}}$, rounded to three decimal places.\nThis procedure is implemented in the provided Python code, utilizing the `numpy` library for efficient and accurate matrix diagonalization.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the butadiene excitation energy problem for a given test suite.\n\n    The function iterates through a set of parameters (beta, delta, tau),\n    constructs the Hückel Hamiltonian for a 4-site linear polyene with\n    alternating bond couplings, and calculates its eigenvalues (orbital energies).\n    It then determines single and double excitation energies as defined in the\n    problem statement and checks for their near-degeneracy within a given\n    tolerance.\n    \"\"\"\n    # Test suite: tuples of (beta, delta, tau) in eV\n    test_cases = [\n        (-2.5, 0.2, 0.05),\n        (-2.0, 0.0, 0.05),\n        (-3.0, 0.4, 0.10),\n        (-2.5, 0.8, 0.10),\n    ]\n\n    # This list will hold the string representation of each case's result list\n    all_results_str = []\n\n    for beta, delta, tau in test_cases:\n        # Step 1: Construct the Hückel Hamiltonian matrix H\n        beta1 = beta * (1 + delta)\n        beta2 = beta * (1 - delta)\n        \n        H = np.array([\n            [0.0,   beta1, 0.0,   0.0  ],\n            [beta1, 0.0,   beta2, 0.0  ],\n            [0.0,   beta2, 0.0,   beta1],\n            [0.0,   0.0,   beta1, 0.0  ]\n        ], dtype=float)\n\n        # Step 1 (cont.): Determine all four orbital energies (eigenvalues of H)\n        # np.linalg.eigh returns sorted eigenvalues for a symmetric matrix, which is appropriate here.\n        orbital_energies = np.linalg.eigh(H)[0]\n        \n        eps1, eps2, eps3, eps4 = orbital_energies\n        \n        # Step 2: Identify occupied and virtual orbitals based on energy ordering.\n        # Occupied orbitals correspond to the two lowest energies: eps1, eps2.\n        # Virtual orbitals correspond to the two highest energies: eps3, eps4.\n        # HOMO energy is eps2, LUMO energy is eps3.\n        eps_homo = eps2\n        eps_lumo = eps3\n\n        # Step 3: Form the set of independent-particle singlet excitation energies.\n        # These are {eps_a - eps_i} for i in {1,2} and a in {3,4}.\n        single_excitations = [\n            eps3 - eps1,\n            eps3 - eps2,  # This is the HOMO-LUMO gap\n            eps4 - eps1,\n            eps4 - eps2\n        ]\n        \n        # The lowest singlet excitation energy is the HOMO-LUMO gap.\n        E_min = eps_lumo - eps_homo\n\n        # Step 4: Compute the naive double-excitation estimate.\n        E_double = 2 * (eps_lumo - eps_homo)\n\n        # Step 5: Decide whether any single excitation energy is within tau of E_double.\n        min_abs_diff = min([abs(E - E_double) for E in single_excitations])\n        found = min_abs_diff <= tau\n\n        # Store the formatted result string for the current case.\n        # The f-string formatting `{value:.3f}` ensures rounding to three decimal places.\n        case_result_str = f\"[{E_min:.3f},{E_double:.3f},{found}]\"\n        all_results_str.append(case_result_str)\n\n    # Print the final output as a single line, following the specified format.\n    # The format is a list of lists, represented as a string.\n    print(f\"[{','.join(all_results_str)}]\")\n\n# Execute the solver function.\nsolve()\n\n```", "id": "2466175"}]}