{"hands_on_practices": [{"introduction": "At the heart of the challenge in electronic structure theory lies the singularity in the potential at electron-electron coalescence points, which imposes a specific structure on the exact wavefunction known as the Kato cusp. This first practice invites you to engage with this fundamental concept directly by deriving the spin-singlet cusp condition for a simple two-electron system. By subsequently calculating the electron-electron repulsion energy for a wavefunction both with and without a simple, explicitly correlated term, you will gain a first-principles understanding of how F12 methods are designed to conquer this challenge and systematically improve accuracy. [@problem_id:2891520]", "problem": "Consider a helium-like two-electron atom in the nonrelativistic Born–Oppenheimer approximation with nuclear charge $Z=2$. Work in atomic units. The Hamiltonian is\n$$\n\\hat{H} = -\\frac{1}{2}\\left(\\nabla_{1}^{2} + \\nabla_{2}^{2}\\right) - Z\\left(\\frac{1}{r_{1}} + \\frac{1}{r_{2}}\\right) + \\frac{1}{r_{12}},\n$$\nwhere $r_{12} = |\\mathbf{r}_{1} - \\mathbf{r}_{2}|$. Use the following two spatial wavefunction models, each paired with a spin singlet:\n\n- Without explicit correlation: the uncorrelated product\n$$\n\\Phi_{0}(\\mathbf{r}_{1},\\mathbf{r}_{2}) = \\varphi(\\mathbf{r}_{1})\\,\\varphi(\\mathbf{r}_{2}), \\quad \\varphi(\\mathbf{r}) = \\left(\\frac{\\zeta^{3}}{\\pi}\\right)^{1/2} \\exp(-\\zeta r),\n$$\nwhere $\\zeta$ is a positive variational exponent.\n\n- With explicit correlation in the explicitly correlated F12 (F12) spirit: the geminal-augmented ansatz\n$$\n\\Phi_{F12}(\\mathbf{r}_{1},\\mathbf{r}_{2}) = \\mathcal{N}\\,g(r_{12})\\,\\varphi(\\mathbf{r}_{1})\\,\\varphi(\\mathbf{r}_{2}), \\quad g(r_{12}) = 1 + c\\, r_{12},\n$$\nwith normalization constant $\\mathcal{N}$ and a scalar $c$ to be fixed by the electron–electron cusp condition.\n\nTasks:\n1. Starting from the many-electron Schrödinger equation in the relative coordinate $u = r_{12}$, perform a local coalescence analysis to derive the electron–electron Kato cusp condition for the spin-singlet ground state,\n$$\n\\left.\\frac{\\partial \\Psi}{\\partial u}\\right|_{u=0} = \\frac{1}{2}\\,\\Psi\\big|_{u=0}.\n$$\nUse this to determine $c$ for the chosen $g(u)$.\n\n2. For the uncorrelated product density $|\\Phi_{0}|^{2}$, evaluate the following configuration-space averages exactly using Hylleraas coordinates $s=r_{1}+r_{2}$, $t=r_{1}-r_{2}$, and $u=r_{12}$:\n   - $\\langle u^{-1} \\rangle_{0}$,\n   - $\\langle u \\rangle_{0}$,\n   - $\\langle u^{2} \\rangle_{0}$,\n   where $\\langle \\cdot \\rangle_{0}$ denotes the normalized average with weight $|\\Phi_{0}|^{2}$. You must derive these integrals from first principles of the Hylleraas volume element and the exponential factor $\\exp(-2\\zeta s)$; do not assume any pre-tabulated values.\n\n3. Using the results of item 2, derive a closed-form expression for the electron–electron repulsion expectation value with the F12-augmented ansatz,\n$$\nJ(c) = \\frac{\\left\\langle g(u)^{2}\\,u^{-1}\\right\\rangle_{0}}{\\left\\langle g(u)^{2}\\right\\rangle_{0}},\n$$\nin terms of $\\zeta$ and $c$ only.\n\n4. For the uncorrelated model, evaluate the variational energy functional\n$$\nE_{0}(\\zeta) = \\langle \\Phi_{0} | \\hat{H} | \\Phi_{0} \\rangle\n$$\nand minimize it with respect to $\\zeta$. Use only definitions and standard one-electron hydrogenic expectation values to obtain a closed-form minimizer $\\zeta^{\\star}$ as a function of $Z$.\n\n5. Set $Z=2$ and $\\zeta = \\zeta^{\\star}$. Using the cusp-determined $c$ from item 1, compute the numerical value of the difference in electron–electron repulsion energy between the F12 and uncorrelated models,\n$$\n\\Delta J \\equiv J(c) - \\langle u^{-1} \\rangle_{0}.\n$$\nRound your final answer to four significant figures. Express the final energy difference in hartree.", "solution": "The problem is validated as scientifically grounded, well-posed, and objective. It presents a standard, albeit computationally intensive, problem in theoretical quantum chemistry. We proceed with the solution. All calculations are performed in atomic units.\n\n**Task 1: Electron-Electron Cusp Condition**\n\nThe nonrelativistic Schrödinger equation for a two-electron atom is $\\hat{H}\\Psi = E\\Psi$, where the Hamiltonian is given by\n$$\n\\hat{H} = -\\frac{1}{2}\\nabla_{1}^{2} -\\frac{1}{2}\\nabla_{2}^{2} - \\frac{Z}{r_{1}} - \\frac{Z}{r_{2}} + \\frac{1}{r_{12}}.\n$$\nWe analyze the behavior of the wavefunction $\\Psi(\\mathbf{r}_1, \\mathbf{r}_2)$ as the two electrons approach each other, i.e., as the inter-electron distance $u = r_{12} = |\\mathbf{r}_1 - \\mathbf{r}_2| \\to 0$. In this limit, the electron-electron repulsion term $1/u$ becomes singular. For the total energy $E$ to remain finite, this singularity must be canceled by a corresponding singularity from the kinetic energy operator. The dominant terms in the Schrödinger equation at small $u$ are\n$$\n\\left(-\\frac{1}{2}\\nabla_{1}^{2} -\\frac{1}{2}\\nabla_{2}^{2} + \\frac{1}{u}\\right)\\Psi \\approx \\left(E + \\frac{Z}{r_1} + \\frac{Z}{r_2}\\right)\\Psi.\n$$\nThe right-hand side is finite as $u \\to 0$ (since $\\mathbf{r}_1 \\to \\mathbf{r}_2$). We transform to center-of-mass $\\mathbf{R} = (\\mathbf{r}_1 + \\mathbf{r}_2)/2$ and relative $\\mathbf{u} = \\mathbf{r}_1 - \\mathbf{r}_2$ coordinates. The kinetic energy operator becomes $-\\frac{1}{4}\\nabla_R^2 - \\nabla_u^2$. The local Schrödinger equation is dominated by the relative coordinate terms:\n$$\n\\left(-\\nabla_{u}^{2} + \\frac{1}{u}\\right)\\Psi \\approx \\text{finite}.\n$$\nFor a spin-singlet ground state, the spatial wavefunction is symmetric with respect to electron exchange and is dominated by the $s$-wave ($l=0$) component in the relative coordinate. We can thus consider the spherically averaged wavefunction $\\bar{\\Psi}(u) = \\frac{1}{4\\pi}\\int \\Psi d\\Omega_u$, which depends only on the magnitude $u$. The radial part of the Laplacian $\\nabla_u^2$ for an $s$-wave is $\\frac{1}{u^2}\\frac{\\partial}{\\partial u}(u^2 \\frac{\\partial}{\\partial u})$. The local equation for $\\bar{\\Psi}(u)$ becomes\n$$\n-\\frac{1}{u^2}\\frac{d}{d u}\\left(u^2 \\frac{d\\bar{\\Psi}}{d u}\\right) + \\frac{1}{u}\\bar{\\Psi}(u) \\approx \\text{finite}.\n$$\nExpanding this gives $-\\frac{d^2\\bar{\\Psi}}{du^2} - \\frac{2}{u}\\frac{d\\bar{\\Psi}}{du} + \\frac{1}{u}\\bar{\\Psi}(u) \\approx \\text{finite}$.\nWe assume a Taylor series expansion for $\\bar{\\Psi}(u)$ around $u=0$: $\\bar{\\Psi}(u) = a_0 + a_1 u + a_2 u^2 + \\dots$, where $a_0 = \\bar{\\Psi}(0)$ and $a_1 = \\left.\\frac{d\\bar{\\Psi}}{du}\\right|_{u=0}$. Substituting this into the equation:\n$$\n-(2a_2 + \\dots) - \\frac{2}{u}(a_1 + 2a_2 u + \\dots) + \\frac{1}{u}(a_0 + a_1 u + \\dots) \\approx \\text{finite}.\n$$\nCollecting terms of order $u^{-1}$:\n$$\n\\frac{-2a_1 + a_0}{u} = 0 \\implies -2a_1 + a_0 = 0 \\implies a_1 = \\frac{1}{2}a_0.\n$$\nThis gives the Kato cusp condition for spin-singlet states:\n$$\n\\left.\\frac{\\partial \\bar{\\Psi}}{\\partial u}\\right|_{u=0} = \\frac{1}{2}\\bar{\\Psi}\\big|_{u=0}.\n$$\nThe problem asks for this condition for $\\Psi$, which holds for its $s$-wave component.\nFor the F12 ansatz, $\\Phi_{F12} = \\mathcal{N} g(u) \\Phi_0$, where $g(u)=1+cu$ and $\\Phi_0 = \\varphi(\\mathbf{r}_1)\\varphi(\\mathbf{r}_2)$ is a product of $1s$ orbitals. The function $\\Phi_0$ is smooth at $u=0$, and its spherically averaged form $\\bar{\\Phi}_0(u)$ has a Taylor expansion starting with terms of even powers, $\\bar{\\Phi}_0(u) = A + B u^2 + \\dots$. Thus, $\\left.\\frac{d\\bar{\\Phi}_0}{du}\\right|_{u=0}=0$.\nThe spherically averaged F12 wavefunction is $\\bar{\\Phi}_{F12}(u) \\approx \\mathcal{N}(1+cu)\\bar{\\Phi}_0(u)$.\nApplying the cusp condition:\n$\\bar{\\Phi}_{F12}(0) = \\mathcal{N}\\bar{\\Phi}_0(0)$.\n$\\left.\\frac{d\\bar{\\Phi}_{F12}}{du}\\right|_{u=0} = \\mathcal{N}\\left[c\\bar{\\Phi}_0(u) + (1+cu)\\frac{d\\bar{\\Phi}_0}{du}\\right]_{u=0} = \\mathcal{N}c\\bar{\\Phi}_0(0)$.\nThe condition $\\left.\\frac{d\\bar{\\Phi}_{F12}}{du}\\right|_{u=0} = \\frac{1}{2}\\bar{\\Phi}_{F12}(0)$ becomes $\\mathcal{N}c\\bar{\\Phi}_0(0) = \\frac{1}{2}\\mathcal{N}\\bar{\\Phi}_0(0)$.\nSince $\\bar{\\Phi}_0(0) \\neq 0$, we find $c = 1/2$.\n\n**Task 2: Expectation Values for the Uncorrelated Wavefunction**\n\nThe wavefunction $\\Phi_0$ is normalized. We compute expectation values of the form $\\langle u^k \\rangle_0 = \\int u^k |\\Phi_0|^2 d\\tau_1 d\\tau_2$.\nThe density is $|\\Phi_0|^2 = (\\zeta^3/\\pi)^2 \\exp(-2\\zeta(r_1+r_2))$. In Hylleraas coordinates ($s=r_1+r_2$, $t=r_1-r_2$, $u=r_{12}$), the volume element is $d\\tau_1 d\\tau_2 = \\pi^2 u(s^2-t^2)ds\\,dt\\,du$. The integration limits are $0 \\le u \\le s$ and $-u \\le t \\le u$.\n$|\\Phi_0|^2 = (\\zeta^3/\\pi)^2 \\exp(-2\\zeta s)$.\n$$\n\\langle u^k \\rangle_0 = \\frac{\\zeta^6}{\\pi^2} \\int_0^\\infty ds \\exp(-2\\zeta s) \\int_0^s du \\, u^{k+1} \\int_{-u}^u dt \\, \\pi^2 (s^2-t^2).\n$$\nThe integral over $t$ is $\\int_{-u}^u (s^2-t^2)dt = [s^2 t - t^3/3]_{-u}^u = 2s^2u - 2u^3/3 = 2u(s^2 - u^2/3)$.\n$$\n\\langle u^k \\rangle_0 = 2\\zeta^6 \\int_0^\\infty ds \\exp(-2\\zeta s) \\int_0^s du \\, u^{k+2} (s^2 - u^2/3).\n$$\nThe integral over $u$ is $\\int_0^s (s^2 u^{k+2} - \\frac{1}{3}u^{k+4})du = \\left[ \\frac{s^2 u^{k+3}}{k+3} - \\frac{u^{k+5}}{3(k+5)} \\right]_0^s = s^{k+5}\\left(\\frac{1}{k+3} - \\frac{1}{3(k+5)}\\right) = s^{k+5}\\frac{2k+12}{3(k+3)(k+5)}$.\n$$\n\\langle u^k \\rangle_0 = 2\\zeta^6 \\frac{2(k+6)}{3(k+3)(k+5)} \\int_0^\\infty s^{k+5} \\exp(-2\\zeta s) ds.\n$$\nUsing the standard integral $\\int_0^\\infty x^n e^{-ax} dx = n!/a^{n+1}$, we get\n$$\n\\langle u^k \\rangle_0 = \\frac{4\\zeta^6(k+6)}{3(k+3)(k+5)} \\frac{(k+5)!}{(2\\zeta)^{k+6}} = \\frac{4\\zeta^6(k+6)(k+5)(k+4)!}{3(k+3)(k+5) 2^{k+6}\\zeta^{k+6}} = \\frac{4(k+6)(k+4)!}{3(k+3)2^{k+6}\\zeta^k}.\n$$\nWe evaluate this for $k=-1, 1, 2$:\nFor $k=-1$: $\\langle u^{-1} \\rangle_0 = \\frac{4(5)(3!)}{3(2)2^5\\zeta^{-1}} = \\frac{120\\zeta}{192} = \\frac{5}{8}\\zeta$.\nFor $k=1$: $\\langle u \\rangle_0 = \\frac{4(7)(5!)}{3(4)2^7\\zeta} = \\frac{28 \\cdot 120}{12 \\cdot 128\\zeta} = \\frac{3360}{1536\\zeta} = \\frac{35}{16\\zeta}$.\nFor $k=2$: $\\langle u^2 \\rangle_0 = \\frac{4(8)(6!)}{3(5)2^8\\zeta^2} = \\frac{32 \\cdot 720}{15 \\cdot 256\\zeta^2} = \\frac{23040}{3840\\zeta^2} = \\frac{6}{\\zeta^2}$.\n\n**Task 3: Repulsion Energy for F12 Ansatz**\n\nThe repulsion energy is $J(c) = \\frac{\\left\\langle g(u)^{2}\\,u^{-1}\\right\\rangle_{0}}{\\left\\langle g(u)^{2}\\right\\rangle_{0}}$. With $g(u) = 1+cu$, we have $g(u)^2 = 1 + 2cu + c^2u^2$.\nThe numerator is $\\langle (1+2cu+c^2u^2)u^{-1} \\rangle_0 = \\langle u^{-1} + 2c + c^2u \\rangle_0 = \\langle u^{-1} \\rangle_0 + 2c\\langle 1 \\rangle_0 + c^2\\langle u \\rangle_0$.\nThe denominator is $\\langle 1+2cu+c^2u^2 \\rangle_0 = \\langle 1 \\rangle_0 + 2c\\langle u \\rangle_0 + c^2\\langle u^2 \\rangle_0$.\nUsing $\\langle 1 \\rangle_0 = 1$ and the results from Task 2:\n$$\nJ(c) = \\frac{\\frac{5}{8}\\zeta + 2c + c^2\\frac{35}{16\\zeta}}{1 + 2c\\frac{35}{16\\zeta} + c^2\\frac{6}{\\zeta^2}} = \\frac{\\frac{5}{8}\\zeta + 2c + \\frac{35c^2}{16\\zeta}}{1 + \\frac{35c}{8\\zeta} + \\frac{6c^2}{\\zeta^2}}.\n$$\n\n**Task 4: Variational Minimization of Energy for Uncorrelated Model**\n\nThe variational energy for $\\Phi_0$ is $E_0(\\zeta) = \\langle \\Phi_0 | \\hat{H} | \\Phi_0 \\rangle$.\n$E_0(\\zeta) = 2\\langle \\varphi |-\\frac{1}{2}\\nabla^2| \\varphi \\rangle - 2Z\\langle \\varphi |\\frac{1}{r}| \\varphi \\rangle + \\langle \\Phi_0 |\\frac{1}{r_{12}}| \\Phi_0 \\rangle$.\nFor a hydrogenic $1s$ orbital with exponent $\\zeta$, the expectation values are $\\langle T \\rangle = \\frac{\\zeta^2}{2}$ and $\\langle 1/r \\rangle = \\zeta$.\nThe electron repulsion term is $\\langle 1/r_{12} \\rangle_0 = \\langle u^{-1} \\rangle_0 = \\frac{5}{8}\\zeta$.\nThus, the energy functional is\n$$\nE_0(\\zeta) = 2\\left(\\frac{\\zeta^2}{2}\\right) - 2Z(\\zeta) + \\frac{5}{8}\\zeta = \\zeta^2 - \\left(2Z - \\frac{5}{8}\\right)\\zeta.\n$$\nTo find the optimal exponent $\\zeta^\\star$, we minimize $E_0(\\zeta)$ with respect to $\\zeta$:\n$\\frac{dE_0}{d\\zeta} = 2\\zeta - \\left(2Z - \\frac{5}{8}\\right) = 0$.\nThis yields the minimizer $\\zeta^\\star = Z - \\frac{5}{16}$.\n\n**Task 5: Numerical Calculation of Repulsion Energy Difference**\n\nWe are given $Z=2$.\nFrom Task 4, the optimal exponent is $\\zeta = \\zeta^\\star = 2 - \\frac{5}{16} = \\frac{27}{16}$.\nFrom Task 1, the cusp condition fixes $c = 1/2$.\nWe need to calculate $\\Delta J = J(c) - \\langle u^{-1} \\rangle_0$.\nFirst, the uncorrelated repulsion energy is $\\langle u^{-1} \\rangle_0 = \\frac{5}{8}\\zeta = \\frac{5}{8} \\cdot \\frac{27}{16} = \\frac{135}{128}$.\nNow we evaluate $J(c)$ with $c=1/2$ and $\\zeta=27/16$.\nThe numerator of $J(c)$ is $N = \\frac{5}{8}\\zeta + 2c + \\frac{35c^2}{16\\zeta} = \\frac{135}{128} + 1 + \\frac{35(1/4)}{16(27/16)} = \\frac{135+128}{128} + \\frac{35/4}{27} = \\frac{263}{128} + \\frac{35}{108}$.\nThe least common multiple of $128=2^7$ and $108=2^2 \\cdot 3^3$ is $2^7 \\cdot 3^3 = 3456$.\n$N = \\frac{263 \\cdot 27 + 35 \\cdot 32}{3456} = \\frac{7101 + 1120}{3456} = \\frac{8221}{3456}$.\nThe denominator of $J(c)$ is $D = 1 + \\frac{35c}{8\\zeta} + \\frac{6c^2}{\\zeta^2} = 1 + \\frac{35(1/2)}{8(27/16)} + \\frac{6(1/4)}{(27/16)^2} = 1 + \\frac{35/2}{27/2} + \\frac{3/2}{729/256} = 1 + \\frac{35}{27} + \\frac{3 \\cdot 128}{729} = 1 + \\frac{35}{27} + \\frac{128}{243}$.\nThe least common multiple of $27=3^3$ and $243=3^5$ is $243$.\n$D = \\frac{243 + 35 \\cdot 9 + 128}{243} = \\frac{243 + 315 + 128}{243} = \\frac{686}{243}$.\nSo, $J(c) = \\frac{N}{D} = \\frac{8221/3456}{686/243} = \\frac{8221}{3456} \\cdot \\frac{243}{686}$.\nSince $3456 = 128 \\times 27$ and $243 = 9 \\times 27$, the term becomes $\\frac{8221 \\cdot 9}{128 \\cdot 686} = \\frac{73989}{87808}$.\nThe difference is $\\Delta J = J(c) - \\langle u^{-1} \\rangle_0 = \\frac{73989}{87808} - \\frac{135}{128}$.\nTo subtract, we use a common denominator $87808 = 128 \\times 686$.\n$\\Delta J = \\frac{73989 - 135 \\cdot 686}{87808} = \\frac{73989 - 92610}{87808} = -\\frac{18621}{87808}$.\nNow we compute the numerical value:\n$\\Delta J \\approx -0.21206927$.\nRounding to four significant figures gives $-0.2121$. The explicit correlation factor $g(u)$ brings the electrons closer on average, but the $1/u$ weighting in the repulsion integral $J(c)$ is more sensitive to the distribution. The normalization in the denominator of $J(c)$ accounts for the change in the overall wavefunction shape. The negative sign indicates that this specific F12-like repulsion definition leads to a lower value than the simple uncorrelated one.", "answer": "$$\\boxed{-0.2121}$$", "id": "2891520"}, {"introduction": "Having seen how explicitly correlated terms are designed to improve the wavefunction, we now explore a practical and somewhat surprising consequence of their effectiveness. This exercise presents a scenario where a CCSD(T)-F12 calculation using a smaller basis set yields a lower, and more accurate, total electronic energy than a conventional CCSD(T) calculation with a larger basis. This hands-on comparison will not only demonstrate the remarkable efficiency of F12 methods but also reinforce the crucial concept that many advanced electronic structure methods are not strictly variational, a key insight for any practitioner. [@problem_id:2891519]", "problem": "Consider the helium atom in the non-relativistic Born–Oppenheimer approximation. Two correlation calculations are performed that differ only in their treatment of the electron–electron cusp and the orbital basis:\n\n- Conventional Coupled Cluster with Singles, Doubles, and perturbative Triples (CCSD(T)) using the correlation-consistent polarized valence triple-zeta orbital basis, denoted cc-pVTZ.\n- CCSD(T) with an explicitly correlated F12b ansatz (i.e., an $f_{12}$ Slater-type geminal is included in the wavefunction expansion) using the optimized cc-pVDZ-F12 orbital basis, together with a sufficiently large Complementary Auxiliary Basis Set (CABS) for the resolution-of-the-identity steps.\n\nBoth calculations employ identical frozen-core settings and evaluate the total electronic energy as a sum of a Hartree–Fock reference energy and post-Hartree–Fock correlation components. The Rayleigh–Ritz variational principle guarantees an upper bound for stationary solutions obtained by variation in a subspace with a Hermitian Hamiltonian, but neither truncated coupled cluster nor typical explicitly correlated implementations are strictly variational because they rely on non-Hermitian projective equations and additional approximations.\n\nThe following component energies (in Hartree) are obtained:\n- CCSD(T)/cc-pVTZ: $E_{\\mathrm{HF}} = -2.861679995$, $E_{\\mathrm{corr}}^{\\mathrm{CCSD}} = -0.040454321$, $E_{(T)} = -0.000566812$.\n- CCSD(T)-F12b/cc-pVDZ-F12: $E_{\\mathrm{HF}} = -2.861594227$, $E_{\\mathrm{corr}}^{\\mathrm{CCSD}} = -0.041002631$, $E_{(T)} = -0.000632955$.\n\nLet the total energies be $E_{\\mathrm{conv}}(\\mathrm{VTZ})$ and $E_{\\mathrm{F12}}(\\mathrm{VDZ-F12})$ for the conventional and F12-enhanced cases, respectively, defined by summing their components. Define the difference\n$$\\Delta E \\equiv E_{\\mathrm{F12}}(\\mathrm{VDZ-F12}) - E_{\\mathrm{conv}}(\\mathrm{VTZ}).$$\n\nTasks:\n1. Compute $\\Delta E$ in millihartree, where $1$ millihartree $=$ $10^{-3}$ Hartree.\n2. Based on the Rayleigh–Ritz variational principle and the formal structure of the methods, interpret the sign of $\\Delta E$ in terms of (non-)variationality.\n\nRound your numerical answer for $\\Delta E$ to four significant figures and report it in millihartree. State your interpretation in words, but the final answer must be only the requested numerical value.", "solution": "We begin from the Rayleigh–Ritz variational principle, which states that for a Hermitian Hamiltonian $\\hat{H}$ and any normalized trial function $\\Psi$, the expectation value $E[\\Psi] = \\langle \\Psi | \\hat{H} | \\Psi \\rangle$ satisfies $E[\\Psi] \\ge E_{0}$, with $E_{0}$ the exact ground-state energy. Truncated Coupled Cluster with Singles, Doubles, and perturbative Triples (CCSD(T)) does not provide a strict upper bound because it solves projected, non-Hermitian amplitude equations, rather than minimizing an expectation value of a Hermitian operator within a linear subspace. Explicitly correlated F12 methods improve basis-set convergence by including a geminal $f_{12}$ that depends on the interelectronic distance $r_{12}$, typically $f_{12} = \\exp(-\\gamma r_{12})$, and by employing resolution-of-the-identity and complementary auxiliary basis set (CABS) approximations. These approximations and the projective nature of coupled cluster break the strict variational upper-bound property. Consequently, it is possible for a smaller orbital basis with F12 to yield a lower total energy than a larger orbital basis without F12, even though neither is guaranteed to be an upper bound to the exact energy.\n\nWe are given component energies for two calculations on helium:\n\n- Conventional CCSD(T)/cc-pVTZ:\n  - $E_{\\mathrm{HF}} = -2.861679995$,\n  - $E_{\\mathrm{corr}}^{\\mathrm{CCSD}} = -0.040454321$,\n  - $E_{(T)} = -0.000566812$.\n\n- CCSD(T)-F12b/cc-pVDZ-F12:\n  - $E_{\\mathrm{HF}} = -2.861594227$,\n  - $E_{\\mathrm{corr}}^{\\mathrm{CCSD}} = -0.041002631$,\n  - $E_{(T)} = -0.000632955$.\n\nFirst, compute the total conventional energy:\n\n$$\nE_{\\mathrm{conv}}(\\mathrm{VTZ}) \\;=\\; E_{\\mathrm{HF}} + E_{\\mathrm{corr}}^{\\mathrm{CCSD}} + E_{(T)}\n\\;=\\; (-2.861679995) + (-0.040454321) + (-0.000566812).\n$$\n\nCombine the two correlation contributions:\n\n$$\n-0.040454321 + (-0.000566812) \\;=\\; -0.041021133.\n$$\n\nAdd to the Hartree–Fock energy:\n\n$$\nE_{\\mathrm{conv}}(\\mathrm{VTZ}) \\;=\\; -2.861679995 + (-0.041021133) \\;=\\; -2.902701128.\n$$\n\n\nNext, compute the total F12 energy:\n\n$$\nE_{\\mathrm{F12}}(\\mathrm{VDZ-F12}) \\;=\\; (-2.861594227) + (-0.041002631) + (-0.000632955).\n$$\n\nCombine the two correlation contributions:\n\n$$\n-0.041002631 + (-0.000632955) \\;=\\; -0.041635586.\n$$\n\nAdd to the Hartree–Fock energy:\n\n$$\nE_{\\mathrm{F12}}(\\mathrm{VDZ-F12}) \\;=\\; -2.861594227 + (-0.041635586) \\;=\\; -2.903229813.\n$$\n\n\nNow compute the difference:\n\n$$\n\\Delta E \\equiv E_{\\mathrm{F12}}(\\mathrm{VDZ-F12}) - E_{\\mathrm{conv}}(\\mathrm{VTZ})\n\\;=\\; (-2.903229813) - (-2.902701128) \\;=\\; -0.000528685 \\;\\text{Hartree}.\n$$\n\nConvert to millihartree using $1$ millihartree $= 10^{-3}$ Hartree:\n\n$$\n\\Delta E \\;=\\; -0.000528685 \\times 10^{3} \\;=\\; -0.528685 \\;\\text{millihartree}.\n$$\n\nRound to four significant figures:\n\n$$\n\\Delta E \\approx -0.5287 \\;\\text{millihartree}.\n$$\n\n\nInterpretation: The negative sign, $\\Delta E < 0$, shows that the smaller-basis explicitly correlated calculation yields a lower (more negative) total energy than the larger-basis conventional calculation. This does not contradict the Rayleigh–Ritz variational principle because neither truncated CCSD(T) nor the F12-augmented approach with resolution-of-the-identity and CABS approximations is strictly variational; the projective, non-Hermitian character and additional approximations permit energies that are not guaranteed to be upper bounds within a given orbital basis. The explicitly correlated ansatz accelerates basis-set convergence and, in practice, can overtake a larger conventional basis, providing this concrete counterexample to a naive expectation of monotonic variational convergence with increasing basis size.", "answer": "$$\\boxed{-0.5287}$$", "id": "2891519"}, {"introduction": "The benefits of explicitly correlated methods extend well beyond just total energies to the calculation of other essential chemical properties. The prediction of vibrational frequencies and zero-point energies, for example, relies on the accurate evaluation of the potential energy surface's second derivatives (the Hessian). This final practice utilizes a detailed model to investigate how the rapid basis set convergence of F12 analytic gradients translates into accelerated convergence for computed Hessians and, consequently, vibrational properties, showcasing the practical advantage of these methods for routine chemical applications. [@problem_id:2639433]", "problem": "You are asked to formalize and test a computational strategy for obtaining accurate zero-point energies using Explicitly Correlated (F12) methods and gradient-based finite-difference Hessians, and to evaluate basis set requirements for reliable vibrational frequencies in a mathematically defined, self-contained model.\n\nThe starting point is the Born–Oppenheimer potential energy surface for nuclear mass-weighted normal coordinates $q \\in \\mathbb{R}^N$. For small displacements about equilibrium, the Taylor expansion of the potential $V(q)$ up to second order defines the harmonic approximation. The gradient is $g(q) = \\nabla V(q)$ and the Hessian is $\\mathbf{H} = \\nabla \\nabla V(q) \\big|_{q = 0}$. In the harmonic approximation, the Hessian at equilibrium is equal to the constant symmetric positive-definite matrix $\\mathbf{K}$, and the harmonic angular frequencies are given by $\\omega_i = \\sqrt{\\lambda_i}$, where $\\lambda_i$ are the eigenvalues of the mass-weighted Hessian $\\mathbf{H}$ at equilibrium. The harmonic zero-point energy is $E_{\\text{ZPE}} = \\frac{1}{2} \\sum_{i=1}^N \\omega_i$. Energies are to be expressed in Hartree.\n\nTo mimic basis set incompleteness error and the effect of Explicitly Correlated (F12) methods on gradients, consider the following model. The exact harmonic model has gradient $g^{\\text{true}}(q) = \\mathbf{K} q$. A method with basis set cardinal number $L \\in \\mathbb{N}$ and a specified correlation treatment $m \\in \\{\\text{conv}, \\text{F12}\\}$ provides an approximate gradient\n$$\ng^{\\text{model}}(q; L, m) = g^{\\text{true}}(q) + e(q; L, m),\n$$\nwith a model error\n$$\ne(q; L, m) = s_m(L) \\left( \\mathbf{B} q + C \\, \\lVert q \\rVert^2 q \\right),\n$$\nwhere $s_m(L) = \\alpha_m \\left(L + \\frac{1}{2} \\right)^{-p_m}$ encodes basis set incompleteness scaling for conventional correlation ($m = \\text{conv}$) and explicitly correlated ($m = \\text{F12}$) treatments. The constants are given below. The term proportional to $\\mathbf{B}$ represents the leading systematic bias in the gradient due to basis set incompleteness, and the cubic term proportional to $C$ captures higher-order position-dependent errors. The Hessian can be estimated numerically from gradients by central finite differences along each coordinate unit vector $e_j$ with a step $h$:\n$$\nH_{ij}^{\\text{est}}(L, m) \\approx \\frac{g_i^{\\text{model}}(h e_j; L, m) - g_i^{\\text{model}}(-h e_j; L, m)}{2 h} \\quad \\text{at } q = 0.\n$$\nDiagonalization of the symmetric matrix $\\mathbf{H}^{\\text{est}}(L, m)$ yields eigenvalues $\\lambda_i^{\\text{est}}(L, m) \\ge 0$ (numerically enforce non-negativity by zeroing tiny negative values that may arise from roundoff), from which the harmonic angular frequencies are $\\omega_i^{\\text{est}}(L, m) = \\sqrt{\\lambda_i^{\\text{est}}(L, m)}$ and the zero-point energy estimate is\n$$\nE_{\\text{ZPE}}^{\\text{est}}(L, m) = \\frac{1}{2} \\sum_{i=1}^N \\omega_i^{\\text{est}}(L, m).\n$$\nThe exact reference values are computed from the exact Hessian $\\mathbf{K}$: $\\omega_i^{\\text{true}} = \\sqrt{\\lambda_i(\\mathbf{K})}$ and $E_{\\text{ZPE}}^{\\text{true}} = \\frac{1}{2} \\sum_{i=1}^N \\omega_i^{\\text{true}}$. All energies must be in Hartree. Frequencies are used in atomic units, so no angle units apply.\n\nUse the following concrete model parameters:\n- Dimension $N = 3$.\n- True Hessian (mass-weighted) at equilibrium:\n$$\n\\mathbf{K} = \\begin{bmatrix}\n1.6 \\times 10^{-4} & 0 & 0 \\\\\n0 & 4.0 \\times 10^{-4} & 0 \\\\\n0 & 0 & 9.0 \\times 10^{-4}\n\\end{bmatrix}.\n$$\n- Leading gradient error matrix:\n$$\n\\mathbf{B} = \\begin{bmatrix}\n6.0 \\times 10^{-5} & 1.0 \\times 10^{-5} & -0.5 \\times 10^{-5} \\\\\n1.0 \\times 10^{-5} & -4.0 \\times 10^{-5} & 0.8 \\times 10^{-5} \\\\\n-0.5 \\times 10^{-5} & 0.8 \\times 10^{-5} & 3.0 \\times 10^{-5}\n\\end{bmatrix}.\n$$\n- Higher-order gradient error coefficient: $C = 2.0 \\times 10^{-1}$ (dimensionless in atomic units).\n- Basis set scalings:\n  - Conventional: $\\alpha_{\\text{conv}} = 8.0 \\times 10^{-1}$, $p_{\\text{conv}} = 2.0$.\n  - Explicitly correlated (F12): $\\alpha_{\\text{F12}} = 1.5 \\times 10^{-1}$, $p_{\\text{F12}} = 3.2$.\n- Central difference step: $h = 1.0 \\times 10^{-3}$ (in bohr for the coordinate displacements; this is needed only for the finite-difference construction).\n\nDefine the following reliability criteria for vibrational predictions:\n- Absolute zero-point energy error threshold: $\\Delta E_{\\text{ZPE}}^{\\text{abs}} \\le 1.5 \\times 10^{-4}$ Hartree, where $\\Delta E_{\\text{ZPE}}^{\\text{abs}} = \\left| E_{\\text{ZPE}}^{\\text{est}}(L, m) - E_{\\text{ZPE}}^{\\text{true}} \\right|$.\n- Maximum relative frequency error threshold: $\\max_i \\left| \\omega_i^{\\text{est}}(L, m) - \\omega_i^{\\text{true}} \\right| / \\omega_i^{\\text{true}} \\le 1.0 \\times 10^{-2}$ (dimensionless; express as a decimal).\n\nYour tasks:\n1) Implement the finite-difference Hessian estimation from gradients $g^{\\text{model}}(q; L, m)$ at $q = 0$ using the central difference formula above, then compute the harmonic frequencies and zero-point energy in atomic units.\n2) For each test case, compute the boolean $b(L, m)$ indicating whether both reliability criteria are simultaneously satisfied.\n3) Determine, within the tested cardinal numbers $L$, the minimal $L$ for which $b(L, \\text{conv})$ is true and the minimal $L$ for which $b(L, \\text{F12})$ is true. If no $L$ within the tested set satisfies the criteria for a method, return $-1$ for that method.\n\nTest suite:\n- Conventional correlation with $L \\in \\{2, 3, 4, 5\\}$.\n- Explicitly correlated (F12) with $L \\in \\{2, 3, 4, 5\\}$.\n\nRequired final output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the following order:\n$$\n[\\; L_{\\min}^{\\text{conv}}, \\; L_{\\min}^{\\text{F12}}, \\; b(2,\\text{conv}), \\; b(3,\\text{conv}), \\; b(4,\\text{conv}), \\; b(5,\\text{conv}), \\; b(2,\\text{F12}), \\; b(3,\\text{F12}), \\; b(4,\\text{F12}), \\; b(5,\\text{F12}) \\;].\n$$\nHere $L_{\\min}^{\\text{conv}}$ and $L_{\\min}^{\\text{F12}}$ are integers and each $b(\\cdot)$ is a boolean. All energies must be computed and compared in Hartree, and relative frequency errors must be dimensionless decimals.", "solution": "The problem statement has been analyzed and is determined to be valid. It is a well-posed, scientifically grounded, and objective computational problem based on a simplified but conceptually correct model of errors in quantum chemical calculations of vibrational frequencies. The model serves to illustrate the faster convergence of explicitly correlated (F12) methods compared to conventional electronic structure methods with respect to the basis set size. All necessary parameters and definitions are provided, and there are no internal contradictions or ambiguities.\n\nThe solution proceeds as follows. First, the exact reference values for the harmonic frequencies and the zero-point energy (ZPE) are computed from the given true Hessian matrix $\\mathbf{K}$. Second, an analytical expression for the numerically estimated Hessian, $\\mathbf{H}^{\\text{est}}$, is derived from the provided model gradient and the central difference formula. This allows for a robust calculation for each method $m \\in \\{\\text{conv}, \\text{F12}\\}$ and basis set cardinal number $L$. Third, for each combination of $(L, m)$, the estimated frequencies and ZPE are calculated from the eigenvalues of $\\mathbf{H}^{\\text{est}}$. Fourth, these estimated values are checked against the two reliability criteria provided. Finally, the minimal cardinal number $L$ that satisfies both criteria is determined for each method.\n\nStep 1: Reference Values\nThe true mass-weighted Hessian at equilibrium is given as a diagonal matrix:\n$$\n\\mathbf{K} = \\begin{bmatrix}\n1.6 \\times 10^{-4} & 0 & 0 \\\\\n0 & 4.0 \\times 10^{-4} & 0 \\\\\n0 & 0 & 9.0 \\times 10^{-4}\n\\end{bmatrix}\n$$\nThe eigenvalues $\\lambda_i^{\\text{true}}$ of $\\mathbf{K}$ are its diagonal elements: $\\lambda_1^{\\text{true}} = 1.6 \\times 10^{-4}$, $\\lambda_2^{\\text{true}} = 4.0 \\times 10^{-4}$, and $\\lambda_3^{\\text{true}} = 9.0 \\times 10^{-4}$. The true harmonic angular frequencies $\\omega_i^{\\text{true}} = \\sqrt{\\lambda_i^{\\text{true}}}$ are:\n$$\n\\omega_1^{\\text{true}} = \\sqrt{1.6 \\times 10^{-4}} \\approx 0.012649\n$$\n$$\n\\omega_2^{\\text{true}} = \\sqrt{4.0 \\times 10^{-4}} = 0.02\n$$\n$$\n\\omega_3^{\\text{true}} = \\sqrt{9.0 \\times 10^{-4}} = 0.03\n$$\nThe true harmonic zero-point energy is $E_{\\text{ZPE}}^{\\text{true}} = \\frac{1}{2} \\sum_{i=1}^{3} \\omega_i^{\\text{true}}$:\n$$\nE_{\\text{ZPE}}^{\\text{true}} = \\frac{1}{2} (0.012649... + 0.02 + 0.03) \\approx 0.031325 \\text{ Hartree}\n$$\n\nStep 2: Estimated Hessian Matrix\nThe model gradient is $g^{\\text{model}}(q; L, m) = g^{\\text{true}}(q) + e(q; L, m)$, where $g^{\\text{true}}(q) = \\mathbf{K} q$ and the error term is $e(q; L, m) = s_m(L) ( \\mathbf{B} q + C \\lVert q \\rVert^2 q )$. The basis set incompleteness scaling factor is $s_m(L) = \\alpha_m (L + \\frac{1}{2})^{-p_m}$.\n\nThe Hessian is to be estimated using the central difference formula:\n$$\nH_{ij}^{\\text{est}}(L, m) = \\frac{g_i^{\\text{model}}(h e_j; L, m) - g_i^{\\text{model}}(-h e_j; L, m)}{2 h}\n$$\nwhere $e_j$ is the $j$-th Cartesian unit vector and $h$ is the displacement step. Let's substitute the expression for $g^{\\text{model}}$ into this formula.\nFor a displacement $q = h e_j$, we have $\\lVert q \\rVert^2 = h^2 \\lVert e_j \\rVert^2 = h^2$. The model gradient is:\n$$\ng^{\\text{model}}(h e_j; L, m) = \\mathbf{K}(h e_j) + s_m(L) \\left( \\mathbf{B}(h e_j) + C h^2 (h e_j) \\right) = h(\\mathbf{K}e_j) + s_m(L) h(\\mathbf{B}e_j + C h^2 e_j)\n$$\nSimilarly, for $q = -h e_j$:\n$$\ng^{\\text{model}}(-h e_j; L, m) = \\mathbf{K}(-h e_j) + s_m(L) \\left( \\mathbf{B}(-h e_j) + C h^2 (-h e_j) \\right) = -h(\\mathbf{K}e_j) - s_m(L) h(\\mathbf{B}e_j + C h^2 e_j)\n$$\nThe difference is:\n$$\ng^{\\text{model}}(h e_j) - g^{\\text{model}}(-h e_j) = 2h(\\mathbf{K}e_j) + 2h s_m(L)(\\mathbf{B}e_j + C h^2 e_j)\n$$\nDividing by $2h$ gives the $j$-th column of the Hessian matrix:\n$$\n\\mathbf{H}_{:,j}^{\\text{est}} = \\mathbf{K}e_j + s_m(L)(\\mathbf{B}e_j + C h^2 e_j) = \\left( \\mathbf{K} + s_m(L)(\\mathbf{B} + C h^2 \\mathbf{I}) \\right) e_j\n$$\nSince this holds for all $j$, the full estimated Hessian matrix is:\n$$\n\\mathbf{H}^{\\text{est}}(L, m) = \\mathbf{K} + s_m(L) \\left( \\mathbf{B} + C h^2 \\mathbf{I} \\right)\n$$\nwhere $\\mathbf{I}$ is the $3 \\times 3$ identity matrix. This analytical expression for the finite-difference Hessian is implemented for numerical stability.\n\nStep 3: Calculation Loop\nFor each method $m \\in \\{\\text{conv}, \\text{F12}\\}$ and each cardinal number $L \\in \\{2, 3, 4, 5\\}$, the following computations are performed:\n1.  Calculate the scaling factor $s_m(L)$ using the given parameters $\\alpha_m$ and $p_m$.\n2.  Construct the matrix $\\mathbf{H}^{\\text{est}}(L, m)$.\n3.  Compute the eigenvalues $\\lambda_i^{\\text{est}}$ of $\\mathbf{H}^{\\text{est}}$. Any negative eigenvalues resulting from numerical noise are set to zero, as specified.\n4.  Calculate the estimated frequencies $\\omega_i^{\\text{est}} = \\sqrt{\\lambda_i^{\\text{est}}}$.\n5.  Calculate the estimated ZPE: $E_{\\text{ZPE}}^{\\text{est}}(L, m) = \\frac{1}{2} \\sum_{i=1}^{3} \\omega_i^{\\text{est}}$.\n\nStep 4: Reliability Assessment\nThe computed values are then compared against the true values to check the two reliability criteria:\n1.  Absolute ZPE error: $\\left| E_{\\text{ZPE}}^{\\text{est}}(L, m) - E_{\\text{ZPE}}^{\\text{true}} \\right| \\le 1.5 \\times 10^{-4}$ Hartree.\n2.  Maximum relative frequency error: $\\max_i \\frac{\\left| \\omega_i^{\\text{est}}(L, m) - \\omega_i^{\\text{true}} \\right|}{\\omega_i^{\\text{true}}} \\le 1.0 \\times 10^{-2}$.\n\nA boolean flag $b(L, m)$ is set to true if and only if both criteria are satisfied.\n\nStep 5: Minimal L Determination\nAfter testing all specified $L$ values for each method, the minimal $L_{\\min}^m$ that results in $b(L, m)$ being true is identified. If no tested $L$ satisfies the criteria for a given method, $L_{\\min}^m$ is set to $-1$. The final output consists of $L_{\\min}^{\\text{conv}}$, $L_{\\min}^{\\text{F12}}$, and the boolean results for all test cases.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the computational chemistry model problem to evaluate basis set\n    requirements for reliable vibrational frequencies with conventional and F12 methods.\n    \"\"\"\n\n    # --- Define problem parameters ---\n    # Dimension\n    N = 3\n    \n    # True Hessian (mass-weighted) at equilibrium in Hartree / (Bohr^2 * amu)\n    K = np.diag([1.6e-4, 4.0e-4, 9.0e-4])\n    \n    # Leading gradient error matrix\n    B = np.array([\n        [6.0e-5, 1.0e-5, -0.5e-5],\n        [1.0e-5, -4.0e-5, 0.8e-5],\n        [-0.5e-5, 0.8e-5, 3.0e-5]\n    ])\n    \n    # Higher-order gradient error coefficient\n    C = 2.0e-1\n    \n    # Central difference step size\n    h = 1.0e-3\n    \n    # Method-specific parameters for basis set incompleteness scaling\n    params = {\n        'conv': {'alpha': 8.0e-1, 'p': 2.0},\n        'F12': {'alpha': 1.5e-1, 'p': 3.2}\n    }\n    \n    # Test cases for basis set cardinal number\n    L_values = [2, 3, 4, 5]\n    \n    # Reliability criteria thresholds\n    zpe_err_thresh = 1.5e-4\n    rel_freq_err_thresh = 1.0e-2\n\n    # --- Step 1: Calculate true reference values ---\n    # Eigenvalues of a diagonal matrix are its diagonal elements.\n    # We use eigvalsh and sort for robust comparison with estimated values.\n    lambda_true = np.sort(np.linalg.eigvalsh(K))\n    omega_true = np.sqrt(lambda_true)\n    E_ZPE_true = 0.5 * np.sum(omega_true)\n\n    results_bools = {'conv': [], 'F12': []}\n    \n    # --- Step 2-4: Loop over methods and basis sets, and check criteria ---\n    for m in ['conv', 'F12']:\n        for L in L_values:\n            # Calculate the basis set incompleteness scaling factor s_m(L)\n            s_m_L = params[m]['alpha'] * (L + 0.5)**(-params[m]['p'])\n            \n            # Construct the estimated Hessian matrix using the analytical formula\n            # for the specified central difference approximation.\n            # H_est = K + s_m(L) * (B + C * h^2 * I)\n            H_est = K + s_m_L * (B + C * h**2 * np.identity(N))\n            \n            # Symmetrize for numerical stability, though it's already symmetric by construction.\n            H_est = 0.5 * (H_est + H_est.T)\n            \n            # Compute estimated eigenvalues (sorted)\n            lambda_est = np.linalg.eigvalsh(H_est)\n            \n            # Enforce non-negativity as per problem statement\n            lambda_est[lambda_est < 0] = 0.0\n            \n            # Compute estimated frequencies\n            omega_est = np.sqrt(lambda_est)\n            \n            # Compute estimated Zero-Point Energy\n            E_ZPE_est = 0.5 * np.sum(omega_est)\n            \n            # --- Check reliability criteria ---\n            # Criterion 1: Absolute ZPE error\n            zpe_error = np.abs(E_ZPE_est - E_ZPE_true)\n            zpe_ok = zpe_error <= zpe_err_thresh\n            \n            # Criterion 2: Maximum relative frequency error\n            # Frequencies are sorted, so direct element-wise comparison is correct.\n            # omega_true is guaranteed non-zero.\n            rel_freq_errors = np.abs(omega_est - omega_true) / omega_true\n            max_rel_freq_error = np.max(rel_freq_errors)\n            freq_ok = max_rel_freq_error <= rel_freq_err_thresh\n            \n            # The boolean b(L, m) is true if both criteria are met\n            is_reliable = zpe_ok and freq_ok\n            results_bools[m].append(is_reliable)\n            \n    # --- Step 5: Determine minimal L for each method ---\n    L_min_conv = -1\n    for i, reliable in enumerate(results_bools['conv']):\n        if reliable:\n            L_min_conv = L_values[i]\n            break\n            \n    L_min_F12 = -1\n    for i, reliable in enumerate(results_bools['F12']):\n        if reliable:\n            L_min_F12 = L_values[i]\n            break\n            \n    # --- Format final output string ---\n    final_list = [L_min_conv, L_min_F12] + results_bools['conv'] + results_bools['F12']\n    \n    # Convert booleans to lowercase strings 'true'/'false' as required.\n    output_str = f\"[{','.join(map(lambda x: str(x).lower() if isinstance(x, bool) else str(x), final_list))}]\"\n    \n    print(output_str)\n\nsolve()\n```", "id": "2639433"}]}