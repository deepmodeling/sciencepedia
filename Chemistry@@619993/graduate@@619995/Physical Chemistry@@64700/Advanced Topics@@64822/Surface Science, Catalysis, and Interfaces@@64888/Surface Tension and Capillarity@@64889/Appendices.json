{"hands_on_practices": [{"introduction": "The breakup of a stream of water into droplets is a familiar sight, yet it exemplifies a profound physical principle. This exercise explores the Plateau-Rayleigh instability, which explains how a cylindrical column of liquid becomes unstable due to surface tension. By analyzing the change in surface energy associated with small perturbations, you will determine the critical wavelength beyond which a liquid jet will spontaneously break apart to minimize its surface area, a key process in technologies like inkjet printing and emulsification. [@problem_id:2007082]", "problem": "The formation of droplets in technologies like inkjet printing is governed by the controlled breakup of a fine liquid jet. This phenomenon can be understood through the Plateau-Rayleigh instability, which describes how a cylindrical fluid column becomes unstable due to surface tension.\n\nConsider an idealized, infinitely long cylindrical jet of a non-viscous, incompressible liquid with an initial uniform radius $R_0$ and a constant surface tension $\\gamma$. The jet is situated in a vacuum. The jet is then subjected to a small, axisymmetric sinusoidal perturbation of its radius along its length. Due to the physical constraint of volume conservation for a given segment of the jet, it can be mathematically shown that the change in the total surface area, $\\Delta S$, of a segment of length $L$ (where $L$ is an integer multiple of the perturbation wavelength) relative to the initial unperturbed cylinder is given by the expression:\n$$\n\\Delta S = \\frac{\\pi L \\epsilon^2}{2R_0} (k^2 R_0^2 - 1)\n$$\nHere, $\\epsilon$ is the small amplitude of the perturbation ($\\epsilon \\ll R_0$) and $k$ is the wavenumber of the sinusoidal perturbation.\n\nThe stability of the jet is determined by the change in its surface energy, $E_S = \\gamma S$. A perturbation is considered unstable and will grow spontaneously if it leads to a net decrease in the total surface energy of the system. This spontaneous growth eventually leads to the breakup of the jet into droplets.\n\nUsing the provided information, determine the critical wavelength, $\\lambda_c$, which marks the boundary between stable and unstable perturbations. Any perturbation with a wavelength $\\lambda > \\lambda_c$ will be unstable. The wavenumber is related to the wavelength by $k=2\\pi/\\lambda$. Express your final answer for $\\lambda_c$ as a function of $R_0$.", "solution": "The change in surface area for a length $L$ that is an integer multiple of the perturbation wavelength is given by\n$$\n\\Delta S = \\frac{\\pi L \\epsilon^{2}}{2 R_{0}} \\left(k^{2} R_{0}^{2} - 1\\right).\n$$\nThe surface energy is $E_{S} = \\gamma S$, so the change in surface energy due to the perturbation is\n$$\n\\Delta E_{S} = \\gamma \\Delta S = \\gamma \\frac{\\pi L \\epsilon^{2}}{2 R_{0}} \\left(k^{2} R_{0}^{2} - 1\\right).\n$$\nSince $\\gamma>0$, the sign of $\\Delta E_{S}$ is determined by the factor $\\left(k^{2} R_{0}^{2} - 1\\right)$. A perturbation is unstable if it decreases the surface energy, i.e., if $\\Delta E_{S}<0$, which requires\n$$\nk^{2} R_{0}^{2} - 1 < 0 \\quad \\Longrightarrow \\quad k R_{0} < 1.\n$$\nThe critical condition separating stability from instability is obtained by setting the change in surface energy to zero:\n$$\nk_{c}^{2} R_{0}^{2} - 1 = 0 \\quad \\Longrightarrow \\quad k_{c} = \\frac{1}{R_{0}}.\n$$\nUsing the relation between wavenumber and wavelength, $k = \\frac{2\\pi}{\\lambda}$, the critical wavelength is\n$$\n\\lambda_{c} = \\frac{2\\pi}{k_{c}} = 2\\pi R_{0}.\n$$\nTherefore, perturbations with $\\lambda > \\lambda_{c}$ are unstable, and the critical wavelength is a linear function of the initial radius.", "answer": "$$\\boxed{2\\pi R_{0}}$$", "id": "2007082"}, {"introduction": "The design of superhydrophobic surfaces, which exhibit extreme water repellency, hinges on controlling how liquid droplets interact with textured materials. This problem delves into the thermodynamic competition between two distinct wetting regimes: the fully-wetted Wenzel state and the suspended Cassie-Baxter state. By comparing the interfacial Gibbs free energies, you will derive the critical intrinsic contact angle, $\\theta_C$, that dictates the transition, providing a quantitative framework for engineering surface textures to achieve desired wetting properties. [@problem_id:1893642]", "problem": "A liquid droplet is deposited on a solid surface designed to exhibit superhydrophobic properties. The surface is textured with a regular square array of micropillars. Each pillar has a square cross-section of side length $L$ and a uniform height $H$. The pillars are arranged in a square lattice with a center-to-center spacing of $D$, where $D > L$. The intrinsic wetting behavior of the flat solid material is described by Young's contact angle, $\\theta_Y$, which relates the interfacial tensions for solid-liquid ($\\gamma_{SL}$), solid-vapor ($\\gamma_{SV}$), and liquid-vapor ($\\gamma_{LV}$) interfaces through Young's equation: $\\gamma_{LV} \\cos\\theta_Y = \\gamma_{SV} - \\gamma_{SL}$.\n\nOn this textured surface, the liquid can exist in one of two distinct states:\n1.  **Wenzel State**: The liquid completely wets the surface topography, filling the grooves between the pillars. The solid-liquid interface includes the pillar tops, sidewalls, and the substrate base.\n2.  **Cassie-Baxter State**: The liquid is suspended on top of the pillars, trapping vapor in the cavities underneath. The base of the droplet forms a composite interface of solid-liquid on the pillar tops and liquid-vapor over the gaps.\n\nThe thermodynamically stable state is the one that minimizes the total interfacial Gibbs free energy. The transition between these two states is defined to occur at a critical intrinsic contact angle, $\\theta_C$, where the Gibbs free energies of the Wenzel state and the Cassie-Baxter state are equal.\n\nYour task is to derive a symbolic expression for $\\cos\\theta_C$, corresponding to this thermodynamic transition point. Express your answer in terms of the geometric parameters $L$, $H$, and $D$.", "solution": "We compare the interfacial Gibbs free energies of the Wenzel and Cassie-Baxter states per unit cell of the texture. Consider one square unit cell of side length $D$, containing one square pillar of side $L$ and height $H$.\n\nGeometric areas within one cell:\n- Pillar top area: $A_{\\text{top}} = L^{2}$.\n- Pillar sidewall area: $A_{\\text{side}} = 4 L H$.\n- Base (floor) area between pillars: $A_{\\text{base}} = D^{2} - L^{2}$.\n- Actual rough solid area in the cell: $A_{r} = A_{\\text{top}} + A_{\\text{side}} + A_{\\text{base}} = D^{2} + 4 L H$.\n- Projected area of gaps: $A_{\\text{gap}} = D^{2} - L^{2}$.\n\nWe compute the change in interfacial energy within the contact patch relative to the initially dry textured surface (solid-vapor everywhere in the cell). The macroscopic liquid-vapor surface of the droplet is common to both states for a given base area and cancels when comparing the two states; we therefore count only the interfacial changes under the contact patch.\n\nWenzel state: The liquid completely wets the texture under the base. All rough solid area switches from solid-vapor to solid-liquid, and no liquid-vapor area is created under the base. The energy change per cell is\n$$\nE_{W} = (\\gamma_{SL} - \\gamma_{SV}) A_{r} = (\\gamma_{SL} - \\gamma_{SV}) \\left(D^{2} + 4 L H\\right).\n$$\n\nCassie-Baxter state: Only the pillar tops are wetted; the sidewalls and base remain solid-vapor. Additionally, a liquid-vapor interface spans the gaps under the droplet. The energy change per cell is\n$$\nE_{C} = (\\gamma_{SL} - \\gamma_{SV}) A_{\\text{top}} + \\gamma_{LV} A_{\\text{gap}} = (\\gamma_{SL} - \\gamma_{SV}) L^{2} + \\gamma_{LV} \\left(D^{2} - L^{2}\\right).\n$$\n\nAt the thermodynamic transition, $E_{W} = E_{C}$. Using Young's equation $\\gamma_{LV} \\cos \\theta_{Y} = \\gamma_{SV} - \\gamma_{SL}$, i.e., $\\gamma_{SL} - \\gamma_{SV} = - \\gamma_{LV} \\cos \\theta_{Y}$, and denoting the critical intrinsic angle by $\\theta_{C}$, we set\n$$\n(\\gamma_{SL} - \\gamma_{SV}) \\left(D^{2} + 4 L H\\right) = (\\gamma_{SL} - \\gamma_{SV}) L^{2} + \\gamma_{LV} \\left(D^{2} - L^{2}\\right),\n$$\nwhich simplifies to\n$$\n(\\gamma_{SL} - \\gamma_{SV}) \\left(D^{2} - L^{2} + 4 L H\\right) = \\gamma_{LV} \\left(D^{2} - L^{2}\\right).\n$$\nSubstituting $\\gamma_{SL} - \\gamma_{SV} = - \\gamma_{LV} \\cos \\theta_{C}$ gives\n$$\n- \\gamma_{LV} \\cos \\theta_{C} \\left(D^{2} - L^{2} + 4 L H\\right) = \\gamma_{LV} \\left(D^{2} - L^{2}\\right).\n$$\nCanceling $\\gamma_{LV}$ and solving for $\\cos \\theta_{C}$ yields\n$$\n\\cos \\theta_{C} = - \\frac{D^{2} - L^{2}}{D^{2} - L^{2} + 4 L H}.\n$$\nThis expression depends only on the geometric parameters $L$, $H$, and $D$, as required. It can also be written in the familiar form $\\cos \\theta_{C} = - (1 - f)/(r - f)$ with $f = L^{2}/D^{2}$ and $r = 1 + 4 L H / D^{2}$, but the requested form in terms of $L$, $H$, and $D$ is given above.", "answer": "$$\\boxed{-\\frac{D^{2} - L^{2}}{D^{2} - L^{2} + 4 L H}}$$", "id": "1893642"}, {"introduction": "While surface tension, $\\gamma$, is a macroscopic property, its origin lies in microscopic intermolecular forces. This computational exercise provides a practical walkthrough of how $\\gamma$ is calculated from first principles in molecular simulations, a cornerstone of modern computational physical chemistry. You will implement two fundamentally distinct but equivalent approaches—the mechanical route via the pressure tensor anisotropy and the thermodynamic route via free energy perturbation—thereby gaining a deep, practical understanding of how macroscopic phenomena are connected to their underlying molecular-level details. [@problem_id:2670014]", "problem": "A single-component fluid is simulated in a slab geometry with planar vapor–liquid interfaces under periodic boundary conditions along the direction normal to the interfaces. The goal is to compute the surface tension using two distinct simulation-based routes rooted in first principles: the mechanical route via the pressure tensor anisotropy and the thermodynamic test-area route via virtual area perturbations.\n\nStarting from fundamental definitions:\n\n- The surface free energy (surface tension) is defined as the derivative of the Helmholtz free energy with respect to interfacial area at fixed temperature, number of particles, and volume, namely $\\gamma = \\left(\\partial F / \\partial A\\right)_{T,N,V}$.\n- For a planar interface, the microscopic Irving–Kirkwood (IK) stress theory relates the surface tension to the integral of the interfacial stress anisotropy across the interface. In a periodic slab containing two identical interfaces, careful accounting of the interfacial multiplicity is required.\n- For the test-area method, small, virtual area changes at fixed volume lead to changes in the configurational energy that can be related, via a second-order cumulant expansion of the free energy, to the surface tension.\n\nYour task is to implement these two routes from the above bases without invoking any shortcut formulas not derivable from these principles, and to aggregate the numerical results for the following test suite. All calculations must be consistent with the stated physical units, and the final results must be expressed in milli–newton per meter (mN/m), rounded to six decimal places.\n\nMechanical-route test cases (planar slab with two interfaces, periodic along $z$):\n\n- Case M1 (happy path, localized interfacial region): The system has box length $L_z = 10.0$ nm and is discretized uniformly with spacing $\\Delta z = 0.001$ nm. The normal and tangential components of the local pressure tensor vary along $z$ due to the interface and are constructed from an isotropic background pressure $P_0 = 30.0$ MPa and an anisotropy field composed of two Gaussian peaks centered at $\\pm z_0$, with $z_0 = 2.0$ nm, standard deviation $\\sigma = 0.1$ nm, and peak amplitude $A = 50.0$ MPa. Specifically, at each grid point $z$, construct the anisotropy $\\Delta P(z)$ as the sum of two Gaussians centered at $\\pm z_0$ with amplitude $A$ and width $\\sigma$, then define $P_N(z) = P_0 + \\frac{1}{2} \\Delta P(z)$ and $P_T(z) = P_0 - \\frac{1}{2} \\Delta P(z)$. Use the mechanical route appropriate for a periodic slab with two interfaces to compute the surface tension. Express the answer in mN/m.\n- Case M2 (edge case, homogeneous fluid): Identical to Case M1 except that the anisotropy amplitude is $A = 0.0$ MPa. This corresponds to the absence of an interface and should return a zero surface tension within numerical precision. Express the answer in mN/m.\n\nThermodynamic test-area test case (virtual perturbation at fixed volume for a slab with two interfaces):\n\n- Case TA (thermodynamic route, second-order cumulant): Consider a set of $n = 5$ independent, small, virtual area-increasing deformations of magnitude $\\Delta A = 1.0$ nm$^2$ applied to a system at temperature $T = 300.0$ K. For each deformation $i \\in \\{1,\\dots,5\\}$, let the instantaneous change in configurational energy be $\\Delta U_i$. Construct a synthetic, thermodynamically consistent dataset by defining a baseline energy $U_0 = 1.46 \\times 10^{-19}$ J and a scale $s$ chosen such that the cumulant correction has a prescribed magnitude $C = 2.0 \\times 10^{-21}$ J. Specifically, use $k_B = 1.380\\,649 \\times 10^{-23}$ J/K, set $\\beta = 1/(k_B T)$, let $s = \\sqrt{C/\\beta}$, and define the five energy changes as $\\Delta U_i \\in \\{U_0 - 2s,\\; U_0 - s,\\; U_0,\\; U_0 + s,\\; U_0 + 2s\\}$. Use the second-order cumulant expansion for the free energy change suitable for small perturbations at fixed volume, and account for the presence of two interfaces in the slab when relating the free energy change to the surface tension. Convert all areas to square meters before computing the surface tension. Express the answer in mN/m.\n\nPhysical and numerical units:\n\n- Lengths along $z$ are in nanometers (nm); pressures are in megapascal (MPa); energies are in joules (J); temperature is in kelvin (K); area is in square nanometers (nm$^2$).\n- For the mechanical route, note that integrating a pressure in MPa over a length in nm yields units of MPa·nm, which equals mN/m, since $1$ MPa $\\times 1$ nm $= 10^{6}$ Pa $\\times 10^{-9}$ m $= 10^{-3}$ N/m $= 1$ mN/m.\n- For the test-area route, convert $\\Delta A$ from nm$^2$ to m$^2$ using $1$ nm$^2 = 10^{-18}$ m$^2$.\n\nFinal output format:\n\n- Your program should produce a single line of output containing the results for the three cases [M1, M2, TA], in that order, as a comma-separated list enclosed in square brackets, for example, \"[$\\gamma_{\\mathrm{M1}}$, $\\gamma_{\\mathrm{M2}}$, $\\gamma_{\\mathrm{TA}}$]\". Each entry must be a float in mN/m, rounded to six decimal places, with no additional text.\n\nTest suite summary to implement:\n\n- Case M1: $L_z = 10.0$ nm, $\\Delta z = 0.001$ nm, $P_0 = 30.0$ MPa, $A = 50.0$ MPa, $\\sigma = 0.1$ nm, $z_0 = 2.0$ nm.\n- Case M2: $L_z = 10.0$ nm, $\\Delta z = 0.001$ nm, $P_0 = 30.0$ MPa, $A = 0.0$ MPa, $\\sigma = 0.1$ nm, $z_0 = 2.0$ nm.\n- Case TA: $T = 300.0$ K, $k_B = 1.380\\,649 \\times 10^{-23}$ J/K, $\\Delta A = 1.0$ nm$^2$, $U_0 = 1.46 \\times 10^{-19}$ J, $C = 2.0 \\times 10^{-21}$ J, $n = 5$ energies as specified above.\n\nYour solution should start from the above fundamental bases to justify the computational procedures used, and then implement them faithfully to produce the requested outputs.", "solution": "The problem requires the calculation of the surface tension, $\\gamma$, of a single-component fluid with planar interfaces using two distinct first-principles methods: the mechanical route based on the pressure tensor and the thermodynamic test-area route. The problem is well-posed, scientifically grounded, and provides sufficient information for a unique solution. We shall address each method in turn.\n\nFirst, we analyze the mechanical route. The surface tension of a planar interface is defined mechanically through the integrated anisotropy of the pressure tensor. The fundamental formula, derived from the Irving-Kirkwood theory of stress, for a single interface perpendicular to the $z$-axis is given by:\n$$\n\\gamma = \\int_{-\\infty}^{\\infty} [P_N(z) - P_T(z)] dz\n$$\nwhere $P_N(z)$ is the normal component of the pressure tensor (along the $z$-axis) and $P_T(z)$ is the tangential component (in the $xy$-plane), both as a function of position $z$ across the interface.\n\nThe problem describes a slab geometry with periodic boundary conditions along the $z$-direction over a domain of length $L_z$. This system contains two identical, symmetric vapor-liquid interfaces. The integral of the pressure anisotropy over the entire simulation box captures the contribution from both interfaces. Since $\\gamma$ is an intrinsic property of a single interface, we must divide the total integrated value by the number of interfaces, which is $2$.\n$$\n\\gamma = \\frac{1}{2} \\int_{-L_z/2}^{L_z/2} [P_N(z) - P_T(z)] dz\n$$\nThe problem provides constitutive relations for the pressure components based on an isotropic background pressure $P_0$ and an anisotropy field $\\Delta P(z)$: $P_N(z) = P_0 + \\frac{1}{2} \\Delta P(z)$ and $P_T(z) = P_0 - \\frac{1}{2} \\Delta P(z)$. From these, the pressure anisotropy is simply $P_N(z) - P_T(z) = \\Delta P(z)$. The anisotropy field $\\Delta P(z)$ is modeled as the sum of two Gaussian functions, each representing an interface:\n$$\n\\Delta P(z) = A \\left[ \\exp\\left(-\\frac{(z-z_0)^2}{2\\sigma^2}\\right) + \\exp\\left(-\\frac{(z+z_0)^2}{2\\sigma^2}\\right) \\right]\n$$\nwhere $A$ is the amplitude, $\\sigma$ is the standard deviation (width), and $\\pm z_0$ are the positions of the two interfaces. The expression for surface tension becomes:\n$$\n\\gamma = \\frac{A}{2} \\int_{-L_z/2}^{L_z/2} \\left[ \\exp\\left(-\\frac{(z-z_0)^2}{2\\sigma^2}\\right) + \\exp\\left(-\\frac{(z+z_0)^2}{2\\sigma^2}\\right) \\right] dz\n$$\nGiven the discretization step $\\Delta z$, this integral must be computed numerically. The trapezoidal rule is a suitable and accurate method for this task. The physical units are consistent: integrating pressure (in MPa) over length (in nm) yields a result in MPa$\\cdot$nm, which is equivalent to mN/m, as required.\n\nFor Case M1, the parameters are $L_z = 10.0$ nm, $\\Delta z = 0.001$ nm, $A = 50.0$ MPa, $\\sigma = 0.1$ nm, and $z_0 = 2.0$ nm. The numerical integration of the defined $\\Delta P(z)$ over the range $[-5.0, 5.0]$ nm and division by $2$ will yield the surface tension $\\gamma_{\\mathrm{M1}}$.\n\nFor Case M2, the setup is identical except that the amplitude $A = 0.0$ MPa. This corresponds to a homogeneous fluid with no pressure anisotropy ($\\Delta P(z) = 0$ for all $z$). Consequently, the integral is zero, and the surface tension $\\gamma_{\\mathrm{M2}}$ must be $0.0$. This serves as a critical sanity check.\n\nNext, we analyze the thermodynamic test-area route. The surface tension is defined thermodynamically as the derivative of the Helmholtz free energy $F$ with respect to the interfacial area $A_{int}$ at constant temperature $T$, particle number $N$, and volume $V$:\n$$\n\\gamma = \\left(\\frac{\\partial F}{\\partial A_{int}}\\right)_{T,N,V}\n$$\nFor a small, finite perturbation of area, this can be approximated as $\\gamma \\approx \\Delta F / \\Delta A_{int}$. The change in Helmholtz free energy $\\Delta F$ due to a perturbation that changes the system's configurational energy by $\\Delta U$ is given by the free energy perturbation formula:\n$$\n\\Delta F = -k_B T \\ln \\langle e^{-\\beta \\Delta U} \\rangle\n$$\nwhere $\\beta = 1/(k_B T)$ and the angle brackets denote an ensemble average. For small perturbations, we can use a second-order cumulant expansion:\n$$\n\\Delta F \\approx \\langle \\Delta U \\rangle - \\frac{\\beta}{2} \\left( \\langle (\\Delta U)^2 \\rangle - \\langle \\Delta U \\rangle^2 \\right) = \\langle \\Delta U \\rangle - \\frac{\\beta}{2} \\text{Var}(\\Delta U)\n$$\nThe problem statement provides a synthetic dataset of $n=5$ energy changes $\\Delta U_i$ and a prescribed value for the second-order cumulant correction, $C = 2.0 \\times 10^{-21}$ J. Thus, the free energy change is $\\Delta F = \\langle \\Delta U \\rangle - C$. The average energy change $\\langle \\Delta U \\rangle$ is calculated from the provided dataset. The problem specifies $\\Delta U_i$ values $\\{U_0 - 2s, U_0 - s, U_0, U_0 + s, U_0 + 2s\\}$, from which the average is clearly $\\langle \\Delta U \\rangle = U_0 = 1.46 \\times 10^{-19}$ J.\n\nThe relation between $\\Delta F$ and $\\gamma$ must account for the two interfaces in the slab. The perturbation is an area change of magnitude $\\Delta A = 1.0$ nm$^2$ applied to the simulation box cross-section. This simultaneously changes the area of both interfaces. Therefore, the total change in interfacial area is $\\Delta A_{int} = 2\\Delta A$. The surface tension is then:\n$$\n\\gamma = \\frac{\\Delta F}{\\Delta A_{int}} = \\frac{\\langle \\Delta U \\rangle - C}{2\\Delta A}\n$$\nFor Case TA, we are given $U_0 = 1.46 \\times 10^{-19}$ J, $C = 2.0 \\times 10^{-21}$ J, and $\\Delta A = 1.0$ nm$^2$. We must perform the calculation using consistent SI units. The area $\\Delta A$ must be converted from nm$^2$ to m$^2$ using the conversion $1$ nm$^2 = 10^{-18}$ m$^2$. The resulting $\\gamma$ will be in J/m$^2$, which is equivalent to N/m. Finally, this result must be converted to mN/m by multiplying by $1000$.\n\nThe implementation will proceed by first defining functions for each case based on these derived formulas. The numerical integration for the mechanical route cases will be performed using the trapezoidal method. The thermodynamic route calculation is an algebraic evaluation. All results will be rounded to six decimal places as required.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main solver function to compute surface tension for all test cases.\n    \"\"\"\n\n    def solve_mechanical_route(Lz, dz, P0, A, sigma, z0):\n        \"\"\"\n        Calculates surface tension via the mechanical route (pressure tensor).\n        \n        Args:\n            Lz (float): Box length in z-direction (nm).\n            dz (float): Discretization spacing (nm).\n            P0 (float): Isotropic background pressure (MPa).\n            A (float): Anisotropy peak amplitude (MPa).\n            sigma (float): Standard deviation of Gaussian peaks (nm).\n            z0 (float): Position of Gaussian peaks (nm).\n            \n        Returns:\n            float: Surface tension in mN/m.\n        \"\"\"\n        # Create the discretized z-axis for the periodic box\n        z_points = np.arange(-Lz / 2.0, Lz / 2.0 + dz, dz)\n\n        # Calculate the pressure anisotropy profile delta_P(z) = P_N(z) - P_T(z)\n        gaussian1 = A * np.exp(-(z_points - z0)**2 / (2.0 * sigma**2))\n        gaussian2 = A * np.exp(-(z_points + z0)**2 / (2.0 * sigma**2))\n        delta_P = gaussian1 + gaussian2\n        \n        # Numerically integrate delta_P(z) over the box length using the trapezoidal rule.\n        # np.trapz(y, x) computes the integral of y wrt x.\n        integral = np.trapz(delta_P, z_points)\n\n        # For a system with two interfaces, the surface tension gamma of a single\n        # interface is half the total integral. The units are MPa*nm, which\n        # is equivalent to mN/m.\n        gamma = 0.5 * integral\n        \n        return gamma\n\n    def solve_thermodynamic_route(T, kB, delta_A_nm2, U0, C):\n        \"\"\"\n        Calculates surface tension via the thermodynamic test-area route.\n\n        Args:\n            T (float): Temperature (K).\n            kB (float): Boltzmann constant (J/K).\n            delta_A_nm2 (float): Area perturbation (nm^2).\n            U0 (float): Baseline average energy change (J).\n            C (float): Second-order cumulant correction (J).\n\n        Returns:\n            float: Surface tension in mN/m.\n        \"\"\"\n        # The average energy change <Delta U> is given as U0.\n        avg_delta_U = U0\n        \n        # The Helmholtz free energy change is given by the second-order expansion.\n        # Delta F = <Delta U> - C\n        delta_F = avg_delta_U - C\n\n        # Convert area perturbation from nm^2 to m^2.\n        # 1 nm^2 = 1e-18 m^2\n        delta_A_m2 = delta_A_nm2 * 1e-18\n\n        # The system has two interfaces, so the total change in interfacial area is 2 * delta_A.\n        total_delta_A = 2.0 * delta_A_m2\n\n        # Surface tension gamma = Delta F / (total area change)\n        # The resulting unit is J/m^2, which is equivalent to N/m.\n        gamma_in_Nm = delta_F / total_delta_A\n\n        # Convert from N/m to mN/m by multiplying by 1000.\n        gamma_in_mNm = gamma_in_Nm * 1000.0\n        \n        return gamma_in_mNm\n\n    # Define the test cases from the problem statement.\n    test_cases = {\n        'M1': {\n            'Lz': 10.0, 'dz': 0.001, 'P0': 30.0, 'A': 50.0, \n            'sigma': 0.1, 'z0': 2.0\n        },\n        'M2': {\n            'Lz': 10.0, 'dz': 0.001, 'P0': 30.0, 'A': 0.0, \n            'sigma': 0.1, 'z0': 2.0\n        },\n        'TA': {\n            'T': 300.0, 'kB': 1.380649e-23, 'delta_A_nm2': 1.0,\n            'U0': 1.46e-19, 'C': 2.0e-21\n        }\n    }\n    \n    # Calculate results for each case\n    gamma_m1 = solve_mechanical_route(**test_cases['M1'])\n    gamma_m2 = solve_mechanical_route(**test_cases['M2'])\n    gamma_ta = solve_thermodynamic_route(**test_cases['TA'])\n    \n    # Collect and round results to six decimal places\n    results = [\n        round(gamma_m1, 6),\n        round(gamma_m2, 6),\n        round(gamma_ta, 6)\n    ]\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2670014"}]}