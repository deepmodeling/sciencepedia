{"hands_on_practices": [{"introduction": "The classical harmonic oscillator serves as a cornerstone model in statistical mechanics, providing a clear and tractable system for exploring fundamental concepts. This practice challenges you to derive the position autocorrelation function and its corresponding spectral density from first principles, thereby connecting deterministic dynamics to statistical fluctuations. By extending the analysis to a damped oscillator, you will gain hands-on experience applying the fluctuation-dissipation theorem to relate a system's spontaneous fluctuations to its response to an external perturbation [@problem_id:2682778].", "problem": "A classical particle of mass $m$ moves in one dimension in a harmonic potential with natural angular frequency $\\,\\omega_{0}\\,$ and is in canonical equilibrium at temperature $\\,T\\,$. The Hamiltonian is $\\,H=\\frac{p^{2}}{2m}+\\frac{1}{2}m\\omega_{0}^{2}x^{2}\\,$. Define the position autocorrelation function $\\,C_{xx}(t)=\\langle x(t)\\,x(0)\\rangle_{\\mathrm{eq}}\\,$ and the corresponding spectral density as the Fourier transform (FT) $\\,S_{xx}(\\omega)=\\int_{-\\infty}^{\\infty}\\!dt\\,\\exp(i\\omega t)\\,C_{xx}(t)\\,$. \n\nUsing only fundamental dynamical equations and canonical equilibrium averages, do the following:\n\n1) Derive $\\,C_{xx}(t)\\,$ for the undamped oscillator and express it in terms of $\\,\\langle x^{2}\\rangle_{\\mathrm{eq}}\\,$ and $\\,\\omega_{0}\\,$. Then, using equipartition, express $\\,\\langle x^{2}\\rangle_{\\mathrm{eq}}\\,$ in terms of $\\,k_{B}\\,,\\,T\\,,\\,m\\,$, and $\\,\\omega_{0}\\,$.\n\n2) Compute $\\,S_{xx}(\\omega)\\,$ for the undamped oscillator using the above FT convention and comment on its support in frequency.\n\n3) Now couple the oscillator linearly to a thermal bath that produces viscous damping and fluctuations in the classical limit. Start from the driven equation $\\,m\\ddot{x}(t)+m\\gamma\\dot{x}(t)+m\\omega_{0}^{2}x(t)=f(t)\\,$, where $\\,\\gamma>0\\,$ is the friction coefficient and $\\,f(t)\\,$ is a weak external generalized force. Within linear response theory, determine the dynamical susceptibility $\\,\\chi(\\omega)\\,$ defined by $\\,x(\\omega)=\\chi(\\omega)\\,f(\\omega)\\,$. Then, invoking an appropriate classical fluctuation-dissipation relation connecting $\\,S_{xx}(\\omega)\\,$ to $\\,\\chi(\\omega)\\,$, derive a closed-form expression for the damped spectral density $\\,S_{xx}(\\omega)\\,$ in terms of $\\,m\\,,\\,\\gamma\\,,\\,\\omega_{0}\\,,\\,\\omega\\,,\\,k_{B}\\,$, and $\\,T\\,$ under the stated FT convention.\n\n4) Briefly explain, in terms of the derived $\\,S_{xx}(\\omega)\\,$, how increasing $\\,\\gamma\\,$ modifies the line shape near $\\,\\pm\\omega_{0}\\,$.\n\nAnswer specification: Provide your final answer as a single closed-form analytic expression for the damped spectral density $\\,S_{xx}(\\omega)\\,$ obtained in part 3, in terms of $\\,m\\,,\\,\\gamma\\,,\\,\\omega_{0}\\,,\\,\\omega\\,,\\,k_{B}\\,$, and $\\,T\\,$. Do not include any units in your final boxed expression.", "solution": "The problem statement is subjected to validation prior to any attempt at a solution.\n\n**Step 1: Extract Givens**\n- System: A classical particle of mass $m$ in one dimension.\n- Potential: Harmonic potential with natural angular frequency $\\omega_{0}$.\n- Equilibrium: Canonical equilibrium at temperature $T$.\n- Hamiltonian: $H=\\frac{p^{2}}{2m}+\\frac{1}{2}m\\omega_{0}^{2}x^{2}$.\n- Position autocorrelation function: $C_{xx}(t)=\\langle x(t)\\,x(0)\\rangle_{\\mathrm{eq}}$.\n- Spectral density: $S_{xx}(\\omega)=\\int_{-\\infty}^{\\infty}\\!dt\\,\\exp(i\\omega t)\\,C_{xx}(t)$.\n- Damped dynamics: $m\\ddot{x}(t)+m\\gamma\\dot{x}(t)+m\\omega_{0}^{2}x(t)=f(t)$, where $\\gamma>0$ is a friction coefficient and $f(t)$ is a weak external generalized force.\n- Dynamical susceptibility: $\\chi(\\omega)$ defined by $x(\\omega)=\\chi(\\omega)\\,f(\\omega)$.\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientific Groundedness**: The problem describes the classical harmonic oscillator, both undamped and damped (as described by the Langevin equation), which is a fundamental model in physics and physical chemistry. The concepts of time-correlation functions, spectral density, linear response theory, and the fluctuation-dissipation theorem are all standard, well-established principles of statistical mechanics. The problem is scientifically sound.\n- **Well-Posedness**: The problem is structured as a sequence of logically connected tasks, providing clear definitions for all quantities and specifying the required methods (e.g., use of fundamental equations, equipartition, linear response theory). The context is clearly defined.\n- **Objectivity**: The problem is stated in precise, objective, and technical language, free from any subjectivity or ambiguity.\n\n**Step 3: Verdict and Action**\nThe problem is scientifically sound, well-posed, objective, and self-contained. It is a standard exercise in statistical mechanics. Therefore, the problem is **valid**. A solution will be provided.\n\nThe solution is derived in four parts as requested by the problem statement.\n\n**Part 1: Autocorrelation Function for the Undamped Oscillator**\n\nFor the undamped oscillator, the Hamiltonian is $H=\\frac{p^{2}}{2m}+\\frac{1}{2}m\\omega_{0}^{2}x^{2}$. Hamilton's equations of motion are:\n$\\dot{x} = \\frac{\\partial H}{\\partial p} = \\frac{p}{m}$\n$\\dot{p} = -\\frac{\\partial H}{\\partial x} = -m\\omega_{0}^{2}x$\n\nCombining these yields the second-order differential equation for position:\n$\\ddot{x} = \\frac{\\dot{p}}{m} = -\\omega_{0}^{2}x \\implies \\ddot{x}(t) + \\omega_{0}^{2}x(t) = 0$\nThe general solution for the position $x(t)$ is given by specifying the initial conditions $x(0)$ and $p(0)$:\n$x(t) = x(0)\\cos(\\omega_{0}t) + \\frac{p(0)}{m\\omega_{0}}\\sin(\\omega_{0}t)$\n\nThe position autocorrelation function $C_{xx}(t)$ is defined as the canonical equilibrium average $C_{xx}(t) = \\langle x(t)x(0) \\rangle_{\\mathrm{eq}}$. Substituting the expression for $x(t)$:\n$C_{xx}(t) = \\left\\langle \\left(x(0)\\cos(\\omega_{0}t) + \\frac{p(0)}{m\\omega_{0}}\\sin(\\omega_{0}t)\\right) x(0) \\right\\rangle_{\\mathrm{eq}}$\n$C_{xx}(t) = \\cos(\\omega_{0}t)\\langle x(0)^{2} \\rangle_{\\mathrm{eq}} + \\frac{\\sin(\\omega_{0}t)}{m\\omega_{0}}\\langle x(0)p(0) \\rangle_{\\mathrm{eq}}$\n\nThe canonical average of any observable $A$ is given by $\\langle A \\rangle = \\frac{\\int \\!dx \\int \\!dp \\, A(x,p) \\exp(-\\beta H(x,p))}{\\int \\!dx \\int \\!dp \\, \\exp(-\\beta H(x,p))}$, where $\\beta = (k_{B}T)^{-1}$.\nThe average $\\langle x(0)p(0) \\rangle_{\\mathrm{eq}}$ is zero because the integrand $xp\\exp(-\\beta H)$ is an odd function of $p$ (and $x$), and the integration is over a symmetric domain $(-\\infty, \\infty)$.\nThus, the autocorrelation function simplifies to:\n$C_{xx}(t) = \\langle x^{2} \\rangle_{\\mathrm{eq}} \\cos(\\omega_{0}t)$\n\nNext, we apply the classical equipartition theorem. For any degree of freedom that appears quadratically in the Hamiltonian, the mean energy associated with that degree of freedom is $\\frac{1}{2}k_{B}T$. The potential energy term is $\\frac{1}{2}m\\omega_{0}^{2}x^{2}$. Therefore:\n$\\left\\langle \\frac{1}{2}m\\omega_{0}^{2}x^{2} \\right\\rangle_{\\mathrm{eq}} = \\frac{1}{2}k_{B}T$\nThis implies $\\frac{1}{2}m\\omega_{0}^{2}\\langle x^{2} \\rangle_{\\mathrm{eq}} = \\frac{1}{2}k_{B}T$, which gives:\n$\\langle x^{2} \\rangle_{\\mathrm{eq}} = \\frac{k_{B}T}{m\\omega_{0}^{2}}$\n\n**Part 2: Spectral Density for the Undamped Oscillator**\n\nThe spectral density $S_{xx}(\\omega)$ is the Fourier transform of $C_{xx}(t)$:\n$S_{xx}(\\omega) = \\int_{-\\infty}^{\\infty}\\!dt\\,\\exp(i\\omega t)\\,C_{xx}(t) = \\int_{-\\infty}^{\\infty}\\!dt\\,\\exp(i\\omega t)\\left(\\frac{k_{B}T}{m\\omega_{0}^{2}}\\cos(\\omega_{0}t)\\right)$\n\nUsing the Euler identity for cosine, $\\cos(\\theta) = \\frac{1}{2}(\\exp(i\\theta) + \\exp(-i\\theta))$:\n$S_{xx}(\\omega) = \\frac{k_{B}T}{m\\omega_{0}^{2}} \\int_{-\\infty}^{\\infty}\\!dt\\,\\exp(i\\omega t)\\left(\\frac{\\exp(i\\omega_{0}t) + \\exp(-i\\omega_{0}t)}{2}\\right)$\n$S_{xx}(\\omega) = \\frac{k_{B}T}{2m\\omega_{0}^{2}} \\left( \\int_{-\\infty}^{\\infty}\\!dt\\,\\exp(i(\\omega+\\omega_{0})t) + \\int_{-\\infty}^{\\infty}\\!dt\\,\\exp(i(\\omega-\\omega_{0})t) \\right)$\n\nUsing the integral representation of the Dirac delta function, $\\int_{-\\infty}^{\\infty}\\!dt\\,\\exp(iky) = 2\\pi\\delta(k)$:\n$S_{xx}(\\omega) = \\frac{k_{B}T}{2m\\omega_{0}^{2}} \\left( 2\\pi\\delta(\\omega+\\omega_{0}) + 2\\pi\\delta(\\omega-\\omega_{0}) \\right)$\n$S_{xx}(\\omega) = \\frac{\\pi k_{B}T}{m\\omega_{0}^{2}} \\left( \\delta(\\omega-\\omega_{0}) + \\delta(\\omega+\\omega_{0}) \\right)$\n\nThe support of the spectral density for the undamped oscillator is concentrated at precisely two frequencies, $\\omega = \\pm \\omega_{0}$. This signifies that the system's fluctuations contain only the natural frequency of oscillation.\n\n**Part 3: Spectral Density for the Damped Oscillator**\n\nWe start with the driven equation of motion for the damped oscillator:\n$m\\ddot{x}(t)+m\\gamma\\dot{x}(t)+m\\omega_{0}^{2}x(t)=f(t)$\n\nTo determine the susceptibility $\\chi(\\omega)$, we Fourier transform this equation. Using the convention $g(\\omega) = \\int_{-\\infty}^{\\infty}\\!dt\\,\\exp(i\\omega t)\\,g(t)$, the transforms of the derivatives are $\\mathcal{F}[\\dot{g}(t)] = -i\\omega g(\\omega)$ and $\\mathcal{F}[\\ddot{g}(t)] = (-i\\omega)^{2} g(\\omega) = -\\omega^{2}g(\\omega)$. Applying this to the equation of motion:\n$m(-\\omega^{2})x(\\omega) + m\\gamma(-i\\omega)x(\\omega) + m\\omega_{0}^{2}x(\\omega) = f(\\omega)$\n\nFactoring out $x(\\omega)$:\n$x(\\omega)\\left[ m(\\omega_{0}^{2}-\\omega^{2}) - im\\gamma\\omega \\right] = f(\\omega)$\n\nThe dynamical susceptibility $\\chi(\\omega) = x(\\omega)/f(\\omega)$ is therefore:\n$\\chi(\\omega) = \\frac{1}{m(\\omega_{0}^{2}-\\omega^{2}) - im\\gamma\\omega}$\n\nThe classical fluctuation-dissipation theorem (FDT) relates the spectral density of equilibrium fluctuations $S_{xx}(\\omega)$ to the imaginary part of the dynamical susceptibility $\\chi(\\omega)$. For the specified Fourier transform convention, the relation is:\n$S_{xx}(\\omega) = \\frac{2k_{B}T}{\\omega}\\operatorname{Im}[\\chi(\\omega)]$\n\nWe must compute the imaginary part of $\\chi(\\omega)$:\n$\\chi(\\omega) = \\frac{1}{m(\\omega_{0}^{2}-\\omega^{2}) - im\\gamma\\omega} \\times \\frac{m(\\omega_{0}^{2}-\\omega^{2}) + im\\gamma\\omega}{m(\\omega_{0}^{2}-\\omega^{2}) + im\\gamma\\omega}$\n$\\chi(\\omega) = \\frac{m(\\omega_{0}^{2}-\\omega^{2}) + im\\gamma\\omega}{[m(\\omega_{0}^{2}-\\omega^{2})]^{2} + (m\\gamma\\omega)^{2}}$\n$\\operatorname{Im}[\\chi(\\omega)] = \\frac{m\\gamma\\omega}{m^{2}[(\\omega_{0}^{2}-\\omega^{2})^{2} + (\\gamma\\omega)^{2}]} = \\frac{\\gamma\\omega}{m[(\\omega_{0}^{2}-\\omega^{2})^{2} + \\gamma^{2}\\omega^{2}]}$\n\nSubstituting this into the FDT:\n$S_{xx}(\\omega) = \\frac{2k_{B}T}{\\omega} \\left( \\frac{\\gamma\\omega}{m[(\\omega_{0}^{2}-\\omega^{2})^{2} + \\gamma^{2}\\omega^{2}]} \\right)$\n$S_{xx}(\\omega) = \\frac{2k_{B}T\\gamma}{m[(\\omega_{0}^{2}-\\omega^{2})^{2} + \\gamma^{2}\\omega^{2}]}$\nThis is the closed-form expression for the damped spectral density.\n\n**Part 4: Effect of Damping on the Line Shape**\n\nThe derived spectral density $S_{xx}(\\omega)$ is a Lorentzian-like function of $\\omega$. The denominator, $(\\omega_{0}^{2}-\\omega^{2})^{2} + \\gamma^{2}\\omega^{2}$, governs the shape. In the case of weak damping ($\\gamma \\ll \\omega_{0}$), the function has sharp peaks near $\\omega = \\pm\\omega_{0}$.\nNear the resonance, $\\omega \\approx \\omega_{0}$, we can approximate $\\omega_{0}^{2}-\\omega^{2} = (\\omega_{0}-\\omega)(\\omega_{0}+\\omega) \\approx 2\\omega_{0}(\\omega_{0}-\\omega)$. The spectral density becomes:\n$S_{xx}(\\omega) \\approx \\frac{2k_{B}T\\gamma}{m[4\\omega_{0}^{2}(\\omega_{0}-\\omega)^{2} + \\gamma^{2}\\omega_{0}^{2}]}$\n\nThe full-width at half-maximum (FWHM) of this Lorentzian peak is approximately $\\gamma$. Therefore, increasing the friction coefficient $\\gamma$ leads to broadening of the spectral lines near $\\pm\\omega_{0}$. This is known as damping broadening or collisional broadening. Concurrently, the peak height, $S_{xx}(\\omega_{0}) = \\frac{2k_{B}T}{m\\gamma\\omega_{0}^{2}}$, is inversely proportional to $\\gamma$. Thus, as $\\gamma$ increases, the spectral line becomes broader and shorter, while the total integrated intensity, $2\\pi C_{xx}(0) = \\frac{2\\pi k_{B}T}{m\\omega_{0}^{2}}$, remains constant and independent of $\\gamma$.", "answer": "$$\\boxed{\\frac{2k_{B}T\\gamma}{m\\left[(\\omega_{0}^{2}-\\omega^{2})^{2} + (\\gamma\\omega)^{2}\\right]}}$$", "id": "2682778"}, {"introduction": "One of the most powerful applications of linear response theory is in the interpretation of spectroscopic data. This practice delves into the origin of spectral lineshapes by modeling the dipole autocorrelation function for two distinct physical scenarios: rapid, memoryless dephasing (homogeneous broadening) and a static distribution of molecular environments (inhomogeneous broadening). By deriving the resulting Lorentzian and Gaussian line profiles and their respective widths, you will build a crucial link between microscopic relaxation dynamics and macroscopic experimental observables [@problem_id:2682812].", "problem": "A molecular ensemble with a single dominant transition at angular frequency $\\omega_{0}$ is probed in the weak-field limit. Within Linear Response Theory (LRT), the absorption line shape is proportional to the Fourier transform of the equilibrium dipole time autocorrelation function $C_{\\mu\\mu}(t)$. Consider two physically motivated models for $C_{\\mu\\mu}(t)$ that represent distinct broadening mechanisms:\n- Homogeneous broadening due to rapid, memoryless dephasing: $C_{\\mu\\mu}^{(\\mathrm{hom})}(t) = C_{0}\\,\\exp\\!\\left(-\\frac{|t|}{T_{2}}\\right)\\exp\\!\\left(-i\\,\\omega_{0} t\\right)$, with dephasing time $T_{2}>0$.\n- Inhomogeneous broadening due to static frequency disorder: $C_{\\mu\\mu}^{(\\mathrm{inh})}(t) = C_{0}\\,\\exp\\!\\left(-\\left(\\frac{t}{\\tau}\\right)^{2}\\right)\\exp\\!\\left(-i\\,\\omega_{0} t\\right)$, with static-disorder time scale $\\tau>0$.\n\nAssume stationarity of the equilibrium correlation functions and use the two-sided Fourier transform $S(\\omega) \\equiv \\int_{-\\infty}^{\\infty} \\mathrm{d}t\\, \\exp(i \\omega t)\\, C_{\\mu\\mu}(t)$ as the spectral density that determines the absorption line shape up to an overall multiplicative constant. Define the normalized spectral line shape as\n$$\nL(\\omega)\\equiv \\frac{S(\\omega)}{\\int_{-\\infty}^{\\infty}\\mathrm{d}\\omega'\\, S(\\omega')}.\n$$\n\nTasks:\n- Starting from the definitions above and without invoking any pre-tabulated Fourier pairs, derive the normalized line shapes $L_{\\mathrm{hom}}(\\omega)$ and $L_{\\mathrm{inh}}(\\omega)$ associated with $C_{\\mu\\mu}^{(\\mathrm{hom})}(t)$ and $C_{\\mu\\mu}^{(\\mathrm{inh})}(t)$, respectively. Express your results in terms of $\\omega$, $\\omega_{0}$, $T_{2}$, and $\\tau$.\n- For each line shape, derive the full width at half maximum (FWHM), denoted $\\Delta\\omega_{\\mathrm{FWHM,hom}}$ and $\\Delta\\omega_{\\mathrm{FWHM,inh}}$, as exact analytic expressions in terms of $T_{2}$ and $\\tau$.\n\nReport your four results in the order $L_{\\mathrm{hom}}(\\omega)$, $L_{\\mathrm{inh}}(\\omega)$, $\\Delta\\omega_{\\mathrm{FWHM,hom}}$, $\\Delta\\omega_{\\mathrm{FWHM,inh}}$ as a single row vector. No numerical evaluation is required, and no units should be included in the reported final expressions. If you introduce any intermediate variable such as $\\Delta\\omega \\equiv \\omega-\\omega_{0}$ in your derivation, eliminate it by the end so that the final expressions are written explicitly in terms of $\\omega$ and $\\omega_{0}$.", "solution": "The problem is subjected to validation and found to be valid. It is a well-posed, scientifically grounded problem within the domain of physical chemistry that requires the derivation of standard results from first principles. I will now proceed with the solution.\n\nThe task is to derive the normalized spectral line shapes, $L(\\omega)$, and their corresponding full widths at half maximum (FWHM), $\\Delta\\omega_{\\mathrm{FWHM}}$, for two models of a dipole time autocorrelation function, $C_{\\mu\\mu}(t)$. All derivations will be performed from the provided definitions without recourse to tabulated Fourier transforms.\n\nFirst, we establish a general relationship for the normalization constant. The normalized line shape is defined as $L(\\omega) = S(\\omega) / \\int_{-\\infty}^{\\infty} \\mathrm{d}\\omega' S(\\omega')$. The spectral density $S(\\omega)$ is the Fourier transform of the correlation function $C_{\\mu\\mu}(t)$:\n$$S(\\omega) = \\int_{-\\infty}^{\\infty} \\mathrm{d}t\\, \\exp(i \\omega t)\\, C_{\\mu\\mu}(t)$$\nThe inverse Fourier transform relationship gives:\n$$C_{\\mu\\mu}(t) = \\frac{1}{2\\pi} \\int_{-\\infty}^{\\infty} \\mathrm{d}\\omega\\, \\exp(-i \\omega t)\\, S(\\omega)$$\nEvaluating this expression at $t=0$ yields:\n$$C_{\\mu\\mu}(0) = \\frac{1}{2\\pi} \\int_{-\\infty}^{\\infty} \\mathrm{d}\\omega\\, S(\\omega)$$\nTherefore, the normalization integral is directly proportional to the value of the correlation function at $t=0$:\n$$\\int_{-\\infty}^{\\infty} \\mathrm{d}\\omega\\, S(\\omega) = 2\\pi C_{\\mu\\mu}(0)$$\nBoth correlation functions provided are of the form $C_{\\mu\\mu}(t) = C_{0} \\times (\\text{function of t})$, where the function evaluates to $1$ at $t=0$. Thus, for both models, $C_{\\mu\\mu}(0) = C_{0}$. Consequently, the normalization constant in both cases is $2\\pi C_{0}$.\n\n**Part 1: Homogeneous Broadening**\n\nThe correlation function for homogeneous broadening is given by:\n$$C_{\\mu\\mu}^{(\\mathrm{hom})}(t) = C_{0}\\,\\exp\\!\\left(-\\frac{|t|}{T_{2}}\\right)\\exp\\!\\left(-i\\,\\omega_{0} t\\right)$$\nThe corresponding spectral density, $S_{\\mathrm{hom}}(\\omega)$, is its Fourier transform:\n$$S_{\\mathrm{hom}}(\\omega) = C_{0} \\int_{-\\infty}^{\\infty} \\mathrm{d}t\\, \\exp(i \\omega t)\\, \\exp\\!\\left(-\\frac{|t|}{T_{2}}\\right)\\exp\\!\\left(-i\\,\\omega_{0} t\\right) = C_{0} \\int_{-\\infty}^{\\infty} \\mathrm{d}t\\, \\exp\\!\\left(i(\\omega-\\omega_{0}) t - \\frac{|t|}{T_{2}}\\right)$$\nWe split the integral over the domain $(-\\infty, 0)$ and $(0, \\infty)$:\n$$S_{\\mathrm{hom}}(\\omega) = C_{0} \\left[ \\int_{0}^{\\infty} \\mathrm{d}t\\, \\exp\\!\\left(i(\\omega-\\omega_{0}) t - \\frac{t}{T_{2}}\\right) + \\int_{-\\infty}^{0} \\mathrm{d}t\\, \\exp\\!\\left(i(\\omega-\\omega_{0}) t + \\frac{t}{T_{2}}\\right) \\right]$$\n$$S_{\\mathrm{hom}}(\\omega) = C_{0} \\left[ \\int_{0}^{\\infty} \\mathrm{d}t\\, \\exp\\!\\left(-\\left(\\frac{1}{T_{2}} - i(\\omega-\\omega_{0})\\right)t\\right) + \\int_{-\\infty}^{0} \\mathrm{d}t\\, \\exp\\!\\left(\\left(\\frac{1}{T_{2}} + i(\\omega-\\omega_{0})\\right)t\\right) \\right]$$\nEvaluating these standard exponential integrals gives:\n$$S_{\\mathrm{hom}}(\\omega) = C_{0} \\left[ \\frac{1}{\\frac{1}{T_{2}} - i(\\omega-\\omega_{0})} + \\frac{1}{\\frac{1}{T_{2}} + i(\\omega-\\omega_{0})} \\right]$$\nCombining the fractions:\n$$S_{\\mathrm{hom}}(\\omega) = C_{0} \\left[ \\frac{\\left(\\frac{1}{T_{2}} + i(\\omega-\\omega_{0})\\right) + \\left(\\frac{1}{T_{2}} - i(\\omega-\\omega_{0})\\right)}{\\left(\\frac{1}{T_{2}}\\right)^2 + (\\omega-\\omega_{0})^2} \\right] = C_{0} \\frac{2/T_{2}}{\\frac{1}{T_{2}^2} + (\\omega-\\omega_{0})^2} = C_{0} \\frac{2T_{2}}{1 + T_{2}^2(\\omega-\\omega_{0})^2}$$\nThe normalized line shape $L_{\\mathrm{hom}}(\\omega)$ is obtained by dividing $S_{\\mathrm{hom}}(\\omega)$ by the normalization constant $2\\pi C_0$:\n$$L_{\\mathrm{hom}}(\\omega) = \\frac{C_{0} \\frac{2T_{2}}{1 + T_{2}^2(\\omega-\\omega_{0})^2}}{2\\pi C_{0}} = \\frac{T_{2}}{\\pi(1 + T_{2}^2(\\omega-\\omega_{0})^2)}$$\nThis is the first required result.\n\nTo find the FWHM, we first determine the maximum value of $L_{\\mathrm{hom}}(\\omega)$, which occurs at $\\omega = \\omega_{0}$:\n$$L_{\\mathrm{hom, max}} = L_{\\mathrm{hom}}(\\omega_0) = \\frac{T_{2}}{\\pi}$$\nNext, we find the frequencies $\\omega$ where $L_{\\mathrm{hom}}(\\omega) = \\frac{1}{2}L_{\\mathrm{hom, max}}$:\n$$\\frac{T_{2}}{\\pi(1 + T_{2}^2(\\omega-\\omega_{0})^2)} = \\frac{1}{2} \\frac{T_{2}}{\\pi} \\implies 1 + T_{2}^2(\\omega-\\omega_{0})^2 = 2$$\n$$T_{2}^2(\\omega-\\omega_{0})^2 = 1 \\implies \\omega - \\omega_{0} = \\pm \\frac{1}{T_{2}}$$\nThe two frequencies are $\\omega_{\\pm} = \\omega_{0} \\pm \\frac{1}{T_{2}}$. The FWHM is the difference between these two frequencies:\n$$\\Delta\\omega_{\\mathrm{FWHM,hom}} = \\omega_{+} - \\omega_{-} = \\left(\\omega_{0} + \\frac{1}{T_{2}}\\right) - \\left(\\omega_{0} - \\frac{1}{T_{2}}\\right) = \\frac{2}{T_{2}}$$\nThis is the third required result.\n\n**Part 2: Inhomogeneous Broadening**\n\nThe correlation function for inhomogeneous broadening is:\n$$C_{\\mu\\mu}^{(\\mathrm{inh})}(t) = C_{0}\\,\\exp\\!\\left(-\\left(\\frac{t}{\\tau}\\right)^{2}\\right)\\exp\\!\\left(-i\\,\\omega_{0} t\\right)$$\nThe spectral density $S_{\\mathrm{inh}}(\\omega)$ is:\n$$S_{\\mathrm{inh}}(\\omega) = C_{0} \\int_{-\\infty}^{\\infty} \\mathrm{d}t\\, \\exp(i \\omega t)\\, \\exp\\!\\left(-\\frac{t^2}{\\tau^2}\\right)\\exp\\!\\left(-i\\,\\omega_{0} t\\right) = C_{0} \\int_{-\\infty}^{\\infty} \\mathrm{d}t\\, \\exp\\!\\left(-\\frac{t^2}{\\tau^2} + i(\\omega-\\omega_{0}) t \\right)$$\nTo solve this integral, we complete the square in the exponent:\n$$-\\frac{t^2}{\\tau^2} + i(\\omega-\\omega_{0})t = -\\frac{1}{\\tau^2}\\left( t^2 - i\\tau^2(\\omega-\\omega_{0})t \\right) = -\\frac{1}{\\tau^2}\\left( \\left(t - \\frac{i\\tau^2(\\omega-\\omega_{0})}{2}\\right)^2 - \\left(\\frac{i\\tau^2(\\omega-\\omega_{0})}{2}\\right)^2 \\right)$$\n$$= -\\frac{1}{\\tau^2}\\left(t - \\frac{i\\tau^2(\\omega-\\omega_{0})}{2}\\right)^2 - \\frac{\\tau^2(\\omega-\\omega_{0})^2}{4}$$\nThe integral becomes:\n$$S_{\\mathrm{inh}}(\\omega) = C_{0} \\exp\\!\\left(-\\frac{\\tau^2(\\omega-\\omega_{0})^2}{4}\\right) \\int_{-\\infty}^{\\infty} \\mathrm{d}t\\, \\exp\\!\\left(-\\frac{1}{\\tau^2}\\left(t - \\frac{i\\tau^2(\\omega-\\omega_{0})}{2}\\right)^2\\right)$$\nThis is a standard Gaussian integral of the form $\\int_{-\\infty}^{\\infty} \\exp(-ax^2)\\mathrm{d}x = \\sqrt{\\pi/a}$, with $a=1/\\tau^2$. The complex shift in the integration variable does not change the result for an integral over the real line.\n$$\\int_{-\\infty}^{\\infty} \\mathrm{d}t\\, \\exp\\!\\left(-\\frac{1}{\\tau^2}\\left(t - \\text{const}\\right)^2\\right) = \\sqrt{\\pi/(1/\\tau^2)} = \\tau\\sqrt{\\pi}$$\nThus, the spectral density is:\n$$S_{\\mathrm{inh}}(\\omega) = C_{0} \\tau\\sqrt{\\pi} \\exp\\!\\left(-\\frac{\\tau^2(\\omega-\\omega_{0})^2}{4}\\right)$$\nThe normalized line shape $L_{\\mathrm{inh}}(\\omega)$ is obtained by dividing by $2\\pi C_0$:\n$$L_{\\mathrm{inh}}(\\omega) = \\frac{C_{0} \\tau\\sqrt{\\pi} \\exp\\!\\left(-\\frac{\\tau^2(\\omega-\\omega_{0})^2}{4}\\right)}{2\\pi C_{0}} = \\frac{\\tau}{2\\sqrt{\\pi}} \\exp\\!\\left(-\\frac{\\tau^2(\\omega-\\omega_{0})^2}{4}\\right)$$\nThis is the second required result.\n\nTo find the FWHM, we find the maximum of $L_{\\mathrm{inh}}(\\omega)$, which occurs at $\\omega = \\omega_{0}$:\n$$L_{\\mathrm{inh, max}} = L_{\\mathrm{inh}}(\\omega_0) = \\frac{\\tau}{2\\sqrt{\\pi}}$$\nWe find the frequencies $\\omega$ where $L_{\\mathrm{inh}}(\\omega) = \\frac{1}{2}L_{\\mathrm{inh, max}}$:\n$$\\frac{\\tau}{2\\sqrt{\\pi}} \\exp\\!\\left(-\\frac{\\tau^2(\\omega-\\omega_{0})^2}{4}\\right) = \\frac{1}{2} \\frac{\\tau}{2\\sqrt{\\pi}} \\implies \\exp\\!\\left(-\\frac{\\tau^2(\\omega-\\omega_{0})^2}{4}\\right) = \\frac{1}{2}$$\nTaking the natural logarithm of both sides:\n$$-\\frac{\\tau^2(\\omega-\\omega_{0})^2}{4} = \\ln\\left(\\frac{1}{2}\\right) = -\\ln(2)$$\n$$\\tau^2(\\omega-\\omega_{0})^2 = 4\\ln(2) \\implies \\omega - \\omega_{0} = \\pm \\frac{2\\sqrt{\\ln(2)}}{\\tau}$$\nThe two frequencies are $\\omega_{\\pm} = \\omega_{0} \\pm \\frac{2\\sqrt{\\ln(2)}}{\\tau}$. The FWHM is the difference:\n$$\\Delta\\omega_{\\mathrm{FWHM,inh}} = \\omega_{+} - \\omega_{-} = \\left(\\omega_{0} + \\frac{2\\sqrt{\\ln(2)}}{\\tau}\\right) - \\left(\\omega_{0} - \\frac{2\\sqrt{\\ln(2)}}{\\tau}\\right) = \\frac{4\\sqrt{\\ln(2)}}{\\tau}$$\nThis is the fourth and final required result.\n\nThe four derived quantities are collected into a single row vector as requested.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{T_{2}}{\\pi(1 + T_{2}^{2} (\\omega - \\omega_{0})^{2})} & \\frac{\\tau}{2\\sqrt{\\pi}} \\exp\\left(-\\frac{\\tau^{2} (\\omega - \\omega_{0})^{2}}{4}\\right) & \\frac{2}{T_{2}} & \\frac{4\\sqrt{\\ln(2)}}{\\tau}\n\\end{pmatrix}\n}\n$$", "id": "2682812"}, {"introduction": "While analytical models provide invaluable insight, in modern research time-correlation functions are most often computed from numerical data, such as trajectories from molecular dynamics simulations. This computational practice guides you through the implementation of a discrete time-correlation function estimator, grounding the abstract concept of an ensemble average in the practical reality of a finite time series. You will explore how to handle real data and grapple with important statistical considerations like mean-centering and the trade-off between statistical accuracy and the length of the time lag [@problem_id:2682797].", "problem": "You are asked to design and implement a program that computes discrete time-correlation functions from uniformly sampled sequences, suitable for use in linear response calculations. Begin from the fundamental ensemble definition of a stationary two-time correlation function between observables $A$ and $B$, which is the ensemble average $\\langle A(0) B(t) \\rangle$, and the assumption of ergodicity that justifies approximating ensemble averages by time averages along a single sufficiently long trajectory. Use the following principles to construct your estimator and analysis without writing down any shortcut final formulas in the problem statement: use a uniform sampling interval $\\Delta t$, use overlapping pairs separated by lag $k$ to form time-averages, and divide by the number of overlapping pairs. Discuss how subtracting sample means affects the estimate, and how the number of overlapping products influences the variability of the estimate as a function of lag. Connect the integral of an autocorrelation function to linear response through the fluctuation–dissipation theorem (FDT), noting that a transport coefficient or susceptibility can be obtained by integrating the autocorrelation function over time.\n\nYour program must perform the following tasks exactly.\n\n1) Implement a function that, given two real sequences $A_0,\\dots,A_{N-1}$ and $B_0,\\dots,B_{N-1}$, a nonnegative integer lag $k$ with $0 \\le k \\le N-1$, and a Boolean flag indicating whether to subtract sample means, returns the discrete time-average correlation at lag $k$ computed over all overlapping index pairs. If centering is requested, subtract the sample means of the full sequences before forming products. Use the divisor equal to the number of overlapping pairs, which is $N-k$.\n\n2) Implement a function that, for a single real sequence $A_0,\\dots,A_{N-1}$, computes the full autocorrelation sequence for lags $k=0,1,\\dots,N-1$ using the estimator described above without subtracting the mean, and returns the discrete-time integral $\\Delta t \\sum_{k=0}^{N-1} C_{AA}(k \\Delta t)$.\n\n3) Use radians for any angles. No physical units are required for the outputs; report all numeric outputs as standard decimal floats.\n\nTest suite. For each parameter set below, compute the specified outputs in the specified order, and aggregate all results into a single list as described under the final output format.\n\n- Case $1$ (happy path; geometric decay and Green–Kubo-type discrete integral):\n  - Parameters: $N=10$, $\\Delta t=0.1$, define $r=0.8$, and set $A_n = r^n$ and $B_n = A_n$ for $n=0,\\dots,9$.\n  - Required outputs, in order:\n    - The correlation at lags $k=0$, $k=1$, and $k=3$ computed without subtracting means.\n    - The discrete-time integral $\\Delta t \\sum_{k=0}^{N-1} C_{AA}(k \\Delta t)$ computed without subtracting means.\n\n- Case $2$ (oscillatory signal; include a boundary lag to illustrate high-variance regime):\n  - Parameters: $N=12$, $\\Delta t=0.1$, define frequency $f=1.25$, angular frequency $\\omega = 2\\pi f$, and set $A_n = \\cos(\\omega n \\Delta t)$ and $B_n = A_n$ for $n=0,\\dots,11$; angles are in radians.\n  - Required outputs, in order:\n    - The correlation at lag $k=0$ computed without subtracting means.\n    - The correlation at lag $k=11$ computed without subtracting means.\n\n- Case $3$ (mean-offset alternating signals; compare naive and mean-centered estimates):\n  - Parameters: $N=9$, define $A_n = (-1)^n + 0.5$ and $B_n = (-1)^{n+1} + 0.5$ for $n=0,\\dots,8$.\n  - Required outputs, in order:\n    - The correlation at lag $k=0$ without subtracting means.\n    - The correlation at lag $k=0$ with subtracting sample means.\n    - The correlation at lag $k=1$ without subtracting means.\n    - The correlation at lag $k=1$ with subtracting sample means.\n\nFinal output format. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in this exact order aggregating all cases:\n- Case $1$: $C_{AA}(0)$, $C_{AA}(1)$, $C_{AA}(3)$, then the discrete integral.\n- Case $2$: $C_{AA}(0)$, $C_{AA}(11)$.\n- Case $3$: $C_{AB}(0)$ naive, $C_{AB}(0)$ centered, $C_{AB}(1)$ naive, $C_{AB}(1)$ centered.\n\nNo other text should be printed.", "solution": "The problem statement is scientifically grounded, well-posed, and objective. It presents a clear task in computational physical chemistry based on established principles of statistical mechanics. All necessary parameters and definitions for constructing a numerical solution are provided. Therefore, the problem is valid, and a solution will be provided.\n\nThe foundation of this problem lies in the theory of time-correlation functions, which are a central tool in statistical mechanics for describing the dynamics of fluctuations in a system at thermal equilibrium. For two macroscopic observables, represented by fluctuating variables $A(t)$ and $B(t)$, their two-time correlation function is defined as an ensemble average, denoted by angle brackets $\\langle \\dots \\rangle$. Assuming the system is in a stationary state, the correlation function depends only on the time difference $t$ and not on the absolute time $t'$. We can thus write it as:\n$$\nC_{AB}(t) = \\langle A(0) B(t) \\rangle\n$$\nThe ergodic hypothesis posits that for a system in equilibrium, the average over an ensemble of identical systems can be replaced by a time average over a single, sufficiently long trajectory of one system. This is a pragmatic and powerful assumption that allows for the computation of these functions from, for example, a molecular dynamics simulation trajectory. The time average is expressed as an integral:\n$$\n\\langle A(0) B(t) \\rangle = \\lim_{T \\to \\infty} \\frac{1}{T} \\int_0^T A(t') B(t' + t) dt'\n$$\nIn practice, we work with discrete data sampled at uniform intervals $\\Delta t$. We are given finite sequences of observations $A_n = A(n\\Delta t)$ and $B_n = B(n\\Delta t)$ for $n = 0, 1, \\dots, N-1$. A discrete estimator for the correlation function $C_{AB}(t)$ at a time lag $t = k\\Delta t$, where $k$ is a non-negative integer, can be constructed by replacing the integral with a sum. Following the problem specification, we sum over all available overlapping pairs of data points separated by a lag of $k$ steps:\n$$\n\\hat{C}_{AB}(k) = \\frac{1}{N-k} \\sum_{n=0}^{N-1-k} A_n B_{n+k}\n$$\nThis formula defines the estimator for the correlation at lag $k$. The number of terms in the sum is precisely $N-k$, which is used as the normalization factor. This choice of a lag-dependent divisor, $N-k$, provides an unbiased estimate of the covariance if the means of $A$ and $B$ are zero, but it has the consequence that the statistical variance of the estimator increases as the lag $k$ increases. For small lags, $k \\ll N$, we average over many products, resulting in a statistically robust estimate. However, as $k$ approaches $N-1$, the number of products diminishes. At the extreme lag $k=N-1$, the sum contains only a single term, $A_0 B_{N-1}$, and the estimate $\\hat{C}_{AB}(N-1) = A_0 B_{N-1}$ is extremely noisy, reflecting the behavior of two specific points rather than a statistical average.\n\nThe mean values of the observables play a critical role. If the observables have non-zero true means, $\\langle A \\rangle$ and $\\langle B \\rangle$, the correlation function contains a constant offset: $\\langle A(0) B(t) \\rangle = \\langle \\delta A(0) \\delta B(t) \\rangle + \\langle A \\rangle \\langle B \\rangle$, where $\\delta A(t) = A(t) - \\langle A \\rangle$ is the fluctuation around the mean. Many physical properties, particularly transport coefficients, are related to the correlation of these fluctuations. To estimate the fluctuation correlation function, $\\langle \\delta A(0) \\delta B(t) \\rangle$, from a finite sequence, we first remove the sample means. The sample means are calculated as $\\bar{A} = \\frac{1}{N}\\sum_{n=0}^{N-1} A_n$ and $\\bar{B} = \\frac{1}{N}\\sum_{n=0}^{N-1} B_n$. The mean-centered correlation estimator is then:\n$$\n\\hat{C}'_{AB}(k) = \\frac{1}{N-k} \\sum_{n=0}^{N-1-k} (A_n - \\bar{A})(B_{n+k} - \\bar{B})\n$$\nSubtracting the sample means isolates the dynamics of the fluctuations from any static, non-zero offset in the data, which is demonstrated in Case 3 of the problem.\n\nThe connection to linear response theory and transport coefficients is formalized by the Fluctuation-Dissipation Theorem (FDT). A key instance of this is the Green-Kubo relations, which state that a transport coefficient (like diffusion, viscosity, or thermal conductivity) is proportional to the time integral of an appropriate equilibrium autocorrelation function. For example, the self-diffusion coefficient $D$ in a $d$-dimensional system is given by the integral of the velocity autocorrelation function:\n$$\nD = \\frac{1}{d} \\int_0^\\infty \\langle \\mathbf{v}(0) \\cdot \\mathbf{v}(t) \\rangle dt\n$$\nThe problem asks for the computation of a discrete-time approximation of this integral for a generic autocorrelation function $C_{AA}(k\\Delta t) = \\hat{C}_{AA}(k)$. Using the simple rectangle rule for numerical integration, this \"Green-Kubo-type\" integral is calculated as:\n$$\nI_{GK} \\approx \\Delta t \\sum_{k=0}^{N-1} C_{AA}(k\\Delta t)\n$$\nThis sum captures the total memory or persistence of the fluctuations. A function that decays quickly to zero will have a small integral, corresponding to rapid loss of correlation and fast relaxation processes.\n\nThe implementation will consist of a primary function to calculate the correlation for a specific lag $k$, with an option for mean-centering. A second function will utilize the first to compute the entire autocorrelation sequence for $k \\in [0, N-1]$ and then calculate its discrete-time integral. These functions will be applied to the specified test cases.", "answer": "```python\nimport numpy as np\n\ndef compute_correlation(A, B, k, center):\n    \"\"\"\n    Computes the discrete time-average correlation at lag k.\n\n    Args:\n        A (np.ndarray): First sequence of length N.\n        B (np.ndarray): Second sequence of length N.\n        k (int): Non-negative integer lag, 0 = k = N-1.\n        center (bool): If True, subtract sample means before correlation.\n\n    Returns:\n        float: The correlation value at lag k.\n    \"\"\"\n    N = len(A)\n    if not (0 = k  N):\n        raise ValueError(\"Lag k must be in the range [0, N-1].\")\n\n    num_pairs = N - k\n    if num_pairs = 0:\n        # This case is avoided by the check above, but for robustness.\n        return 0.0\n\n    A_seq = A\n    B_seq = B\n\n    if center:\n        mean_A = np.mean(A)\n        mean_B = np.mean(B)\n        A_seq = A - mean_A\n        B_seq = B - mean_B\n\n    # The sum is over products A_n * B_{n+k} for n from 0 to N-1-k.\n    # This corresponds to slices A_seq[0:N-k] and B_seq[k:N].\n    product_sum = np.sum(A_seq[0:num_pairs] * B_seq[k:])\n    \n    return product_sum / num_pairs\n\ndef compute_integral(A_seq, dt):\n    \"\"\"\n    Computes the discrete-time integral of the autocorrelation function.\n\n    Args:\n        A_seq (np.ndarray): The sequence of length N.\n        dt (float): The time step delta_t.\n\n    Returns:\n        float: The value of the discrete-time integral.\n    \"\"\"\n    N = len(A_seq)\n    total_correlation = 0.0\n    for k in range(N):\n        # Per problem statement, integral is computed without subtracting the mean.\n        corr_at_k = compute_correlation(A_seq, A_seq, k, center=False)\n        total_correlation += corr_at_k\n    \n    return dt * total_correlation\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases and print results.\n    \"\"\"\n    all_results = []\n\n    # Case 1: Geometric decay and Green-Kubo-type integral\n    N1 = 10\n    dt1 = 0.1\n    r1 = 0.8\n    n1 = np.arange(N1)\n    A1 = r1**n1\n    B1 = A1\n\n    # C_AA(k=0), no centering\n    all_results.append(compute_correlation(A1, B1, 0, center=False))\n    # C_AA(k=1), no centering\n    all_results.append(compute_correlation(A1, B1, 1, center=False))\n    # C_AA(k=3), no centering\n    all_results.append(compute_correlation(A1, B1, 3, center=False))\n    # Discrete-time integral, no centering\n    all_results.append(compute_integral(A1, dt1))\n\n    # Case 2: Oscillatory signal\n    N2 = 12\n    dt2 = 0.1\n    f2 = 1.25\n    omega2 = 2 * np.pi * f2\n    n2 = np.arange(N2)\n    A2 = np.cos(omega2 * n2 * dt2)\n    B2 = A2\n\n    # C_AA(k=0), no centering\n    all_results.append(compute_correlation(A2, B2, 0, center=False))\n    # C_AA(k=11), no centering\n    all_results.append(compute_correlation(A2, B2, 11, center=False))\n\n    # Case 3: Mean-offset alternating signals\n    N3 = 9\n    n3 = np.arange(N3)\n    A3 = (-1)**n3 + 0.5\n    B3 = (-1)**(n3 + 1) + 0.5\n\n    # C_AB(k=0), no centering\n    all_results.append(compute_correlation(A3, B3, 0, center=False))\n    # C_AB(k=0), with centering\n    all_results.append(compute_correlation(A3, B3, 0, center=True))\n    # C_AB(k=1), no centering\n    all_results.append(compute_correlation(A3, B3, 1, center=False))\n    # C_AB(k=1), with centering\n    all_results.append(compute_correlation(A3, B3, 1, center=True))\n\n    # Final print statement\n    print(f\"[{','.join(map(str, all_results))}]\")\n\nsolve()\n```", "id": "2682797"}]}