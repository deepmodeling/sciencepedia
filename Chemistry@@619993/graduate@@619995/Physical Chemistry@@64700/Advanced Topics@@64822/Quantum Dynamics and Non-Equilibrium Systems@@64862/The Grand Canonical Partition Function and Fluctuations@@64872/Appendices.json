{"hands_on_practices": [{"introduction": "This first practice is a fundamental exercise in statistical mechanics, guiding you through the derivation of particle number fluctuations for a classical ideal gas from first principles. By starting with the canonical partition function and moving to the grand canonical ensemble, you will explicitly demonstrate that the particle number distribution is Poissonian. This result is a cornerstone for understanding open systems and serves as a crucial reference point for more complex, interacting models [@problem_id:2816826].", "problem": "A monoatomic classical ideal gas of particles of mass $m$ is in contact with a heat and particle reservoir at temperature $T$ and chemical potential $\\mu$, occupying a fixed volume $V$. Treat the system within the grand canonical ensemble (GCE). Starting only from the fundamental definitions\n- the $N$-particle classical canonical partition function as the phase-space integral with the Gibbs correction,\n- the grand partition function as the sum over particle numbers weighted by the activity,\nderive the particle-number distribution and show that the number fluctuations are Poissonian. Then compute the number variance $\\langle(\\Delta N)^{2}\\rangle$ in closed form. You may define the thermal de Broglie wavelength $\\lambda$ symbolically, but do not assume any additional properties beyond those derivable from the stated definitions.\n\nExpress your final answer as a single closed-form analytic expression in terms of $z$, $V$, and $\\lambda$, where $z$ is the activity $z = \\exp(\\beta \\mu)$ and $\\beta = 1/(k_{B}T)$. Do not include units. Do not provide an inequality or an equation. The final answer must be a single expression.", "solution": "The problem as stated is scientifically sound, well-posed, and objective. It represents a standard derivation in statistical mechanics and can be solved by starting from the specified first principles. We shall proceed with the derivation.\n\nThe foundation of this problem is the $N$-particle classical canonical partition function, $Q_N(T,V)$, for a system of $N$ indistinguishable, non-interacting particles of mass $m$ in a volume $V$ at an inverse temperature $\\beta = 1/(k_B T)$. Its definition, incorporating the Gibbs correction for indistinguishability, is given by the integral over the $6N$-dimensional phase space:\n$$\nQ_N(T,V) = \\frac{1}{N! h^{3N}} \\int \\prod_{i=1}^N d^3\\mathbf{q}_i d^3\\mathbf{p}_i \\, \\exp(-\\beta H(\\{\\mathbf{q}_i, \\mathbf{p}_i\\}))\n$$\nFor a monoatomic ideal gas, the Hamiltonian $H$ contains only the kinetic energy of the particles and is independent of their positions $\\{\\mathbf{q}_i\\}$:\n$$\nH(\\{\\mathbf{p}_i\\}) = \\sum_{i=1}^N \\frac{|\\mathbf{p}_i|^2}{2m}\n$$\nDue to the separability of the Hamiltonian, the phase-space integral can be factored into integrals over position and momentum coordinates. The integration over the spatial coordinates of the $N$ particles yields the volume term:\n$$\n\\int \\prod_{i=1}^N d^3\\mathbf{q}_i = \\left(\\int_V d^3\\mathbf{q}\\right)^N = V^N\n$$\nThe integration over the momentum coordinates also separates into a product of $N$ identical single-particle integrals:\n$$\n\\int \\prod_{i=1}^N d^3\\mathbf{p}_i \\, \\exp\\left(-\\beta \\sum_{j=1}^N \\frac{|\\mathbf{p}_j|^2}{2m}\\right) = \\left[ \\int d^3\\mathbf{p} \\, \\exp\\left(-\\frac{\\beta |\\mathbf{p}|^2}{2m}\\right) \\right]^N\n$$\nThe single-particle momentum integral is a standard three-dimensional Gaussian integral:\n$$\n\\int d^3\\mathbf{p} \\, \\exp\\left(-\\frac{\\beta |\\mathbf{p}|^2}{2m}\\right) = \\left[ \\int_{-\\infty}^{\\infty} dp \\, \\exp\\left(-\\frac{\\beta p^2}{2m}\\right) \\right]^3\n$$\nUsing the result for the one-dimensional Gaussian integral, $\\int_{-\\infty}^{\\infty} \\exp(-ax^2)dx = \\sqrt{\\pi/a}$, we obtain:\n$$\n\\int_{-\\infty}^{\\infty} dp \\, \\exp\\left(-\\frac{\\beta p^2}{2m}\\right) = \\sqrt{\\frac{2\\pi m}{\\beta}}\n$$\nThis gives the value of the three-dimensional momentum integral as $(2\\pi m/\\beta)^{3/2}$.\nSubstituting these results back into the expression for $Q_N(T,V)$, we find:\n$$\nQ_N(T,V) = \\frac{1}{N! h^{3N}} V^N \\left(\\frac{2\\pi m}{\\beta}\\right)^{3N/2} = \\frac{1}{N!} \\left[ V \\left(\\frac{2\\pi m}{h^2 \\beta}\\right)^{3/2} \\right]^N\n$$\nWe define the thermal de Broglie wavelength $\\lambda$ as $\\lambda = h\\sqrt{\\beta/(2\\pi m)}$. With this definition, the canonical partition function acquires a compact form:\n$$\nQ_N(T,V) = \\frac{1}{N!} \\left(\\frac{V}{\\lambda^3}\\right)^N\n$$\nThis is the canonical partition function for $N$ classical ideal gas particles. It is related to the single-particle partition function $Q_1 = V/\\lambda^3$ by $Q_N = Q_1^N/N!$.\n\nNow, we move to the grand canonical ensemble (GCE). The grand partition function $\\Xi(T,V,\\mu)$ is defined as a sum over states with all possible particle numbers $N \\in \\{0, 1, 2, ...\\}$, weighted by the chemical potential $\\mu$ through the activity $z = \\exp(\\beta\\mu)$:\n$$\n\\Xi(T,V,\\mu) = \\sum_{N=0}^{\\infty} z^N Q_N(T,V)\n$$\nSubstituting our result for $Q_N$, we get:\n$$\n\\Xi = \\sum_{N=0}^{\\infty} z^N \\frac{1}{N!} \\left(\\frac{V}{\\lambda^3}\\right)^N = \\sum_{N=0}^{\\infty} \\frac{1}{N!} \\left(\\frac{zV}{\\lambda^3}\\right)^N\n$$\nThis sum is the Maclaurin series for the exponential function, $\\exp(x) = \\sum_{k=0}^{\\infty} x^k/k!$. Identifying $x = zV/\\lambda^3$, we find the grand partition function in closed form:\n$$\n\\Xi = \\exp\\left(\\frac{zV}{\\lambda^3}\\right)\n$$\nThe probability $P(N)$ of finding the system with a specific number of particles $N$ is the ratio of the corresponding term in the sum to the total sum $\\Xi$:\n$$\nP(N) = \\frac{z^N Q_N}{\\Xi} = \\frac{\\frac{1}{N!} (zV/\\lambda^3)^N}{\\exp(zV/\\lambda^3)} = \\frac{(zV/\\lambda^3)^N}{N!} \\exp\\left(-\\frac{zV}{\\lambda^3}\\right)\n$$\nThis is the particle-number distribution function. To show it is Poissonian, we compare it to the standard form of a Poisson distribution for a discrete random variable $k$, which is $P(k;\\alpha) = \\frac{\\alpha^k e^{-\\alpha}}{k!}$, where $\\alpha$ is the average value $\\langle k \\rangle$. Our derived $P(N)$ matches this form precisely, with the parameter $\\alpha$ given by:\n$$\n\\alpha = \\frac{zV}{\\lambda^3}\n$$\nThus, the distribution of particle numbers is indeed Poissonian. The mean number of particles in the system is $\\langle N \\rangle = \\alpha = zV/\\lambda^3$.\n\nFinally, we compute the variance of the particle number, $\\langle(\\Delta N)^2\\rangle$. A well-known property of the Poisson distribution is that its variance is equal to its mean:\n$$\n\\langle(\\Delta N)^2\\rangle = \\langle N^2 \\rangle - \\langle N \\rangle^2 = \\langle N \\rangle\n$$\nTherefore, the number variance for the ideal gas in the GCE is:\n$$\n\\langle(\\Delta N)^2\\rangle = \\langle N \\rangle = \\frac{zV}{\\lambda^3}\n$$\nThis is the final closed-form expression for the number variance, derived strictly from the given definitions.", "answer": "$$\\boxed{\\frac{zV}{\\lambda^3}}$$", "id": "2816826"}, {"introduction": "Having established the nature of fluctuations in a classical system, we now turn our attention to the quantum world. This problem explores the statistical relationship between the occupation numbers of different single-particle states for a system of non-interacting bosons or fermions. You will investigate whether fluctuations in the number of particles in one quantum state are correlated with fluctuations in another, a key question in many-body physics [@problem_id:1208450].", "problem": "Consider a system of non-interacting quantum particles (either bosons or fermions) occupying a set of single-particle states indexed by $k$, each with energy $\\epsilon_k$. The system is in thermal equilibrium with a heat and particle reservoir at a constant temperature $T$ and chemical potential $\\mu$. The statistical properties of the system are therefore described by the grand canonical ensemble.\n\nLet $n_i$ and $n_j$ be the occupation numbers of two distinct single-particle quantum states, labeled $i$ and $j$ respectively (where $i \\neq j$). The correlation between the fluctuations of these occupation numbers is quantified by the covariance, defined as:\n$$\n\\text{Cov}(n_i, n_j) = \\langle n_i n_j \\rangle - \\langle n_i \\rangle \\langle n_j \\rangle\n$$\nwhere $\\langle \\cdot \\rangle$ denotes the thermal average in the grand canonical ensemble.\n\nYour task is to determine if the fluctuations of the occupation numbers $n_i$ and $n_j$ are correlated for this system. If they are correlated (i.e., $\\text{Cov}(n_i, n_j) \\neq 0$), your answer should be 1. If they are uncorrelated (i.e., $\\text{Cov}(n_i, n_j) = 0$), your answer should be 0.", "solution": "The system consists of non-interacting quantum particles (bosons or fermions) in thermal equilibrium with a heat and particle reservoir at temperature $T$ and chemical potential $\\mu$. The grand canonical partition function $\\Xi$ factorizes into single-state partition functions due to the absence of interactions:\n\n$$\n\\Xi = \\prod_k \\Xi_k,\n$$\n\nwhere $\\Xi_k$ is the partition function for state $k$. For fermions, $\\Xi_k = 1 + e^{-\\beta(\\epsilon_k - \\mu)}$; for bosons, $\\Xi_k = (1 - e^{-\\beta(\\epsilon_k - \\mu)})^{-1}$, with $\\beta = 1/(k_B T)$.\n\nThe thermal average of the occupation number $n_k$ is:\n\n$$\n\\langle n_k \\rangle = \\frac{1}{\\beta} \\frac{\\partial \\ln \\Xi_k}{\\partial \\mu}.\n$$\n\nFor distinct states $i \\neq j$, the joint expectation $\\langle n_i n_j \\rangle$ is:\n\n$$\n\\langle n_i n_j \\rangle = \\frac{1}{\\Xi} \\sum_{\\{n\\}} n_i n_j e^{-\\beta (E - \\mu N)},\n$$\n\nwhere the sum is over all occupation number configurations. Since the particles are non-interacting, the energy $E$ and total particle number $N$ are sums over single-state contributions, leading to a factorized probability distribution:\n\n$$\nP(\\{n_k\\}) = \\prod_k P_k(n_k),\n$$\n\nwhere $P_k(n_k)$ is the probability distribution for state $k$. Thus:\n\n$$\n\\langle n_i n_j \\rangle = \\sum_{n_i} \\sum_{n_j} n_i n_j P_i(n_i) P_j(n_j) = \\left( \\sum_{n_i} n_i P_i(n_i) \\right) \\left( \\sum_{n_j} n_j P_j(n_j) \\right) = \\langle n_i \\rangle \\langle n_j \\rangle.\n$$\n\nThe covariance is:\n\n$$\n\\text{Cov}(n_i, n_j) = \\langle n_i n_j \\rangle - \\langle n_i \\rangle \\langle n_j \\rangle = \\langle n_i \\rangle \\langle n_j \\rangle - \\langle n_i \\rangle \\langle n_j \\rangle = 0.\n$$\n\nThis result holds for both bosons and fermions, as the factorization is valid for non-interacting particles regardless of quantum statistics.", "answer": "$$ \\boxed{0} $$", "id": "1208450"}, {"introduction": "This final practice showcases the modern application of fluctuation theory in the study of critical phenomena. You will develop a computational method to estimate universal critical exponents from the scaling of number fluctuations in a lattice gas model near its critical point. This exercise bridges the gap between theoretical grand canonical ensemble concepts and the practical techniques used in computational physics to characterize phase transitions [@problem_id:2675496].", "problem": "You are tasked with developing and implementing a principled, finite-size scaling estimator of critical exponents for a lattice gas in the Grand Canonical Ensemble (GCE). Your method must proceed from first principles of the GCE and fluctuationâ€“response relations and must operate on system-size series of measured number fluctuations and susceptibility. All quantities in this problem are dimensionless. Your program must produce a single line of output containing the results as a comma-separated list enclosed in square brackets.\n\nFundamental base and definitions:\n- The Grand Canonical Ensemble (GCE) partition function is defined as $\\Xi(\\beta,\\mu,V) = \\sum_{N \\ge 0} \\exp\\!\\left(\\beta \\mu N\\right) Z_N(\\beta,V)$, where $\\beta = 1/(k_{\\mathrm{B}} T)$, $\\mu$ is the chemical potential, $V$ is the volume, and $Z_N(\\beta,V)$ is the canonical partition function at fixed particle number $N$.\n- The cumulants of the particle number $N$ follow from derivatives of $\\ln \\Xi(\\beta,\\mu,V)$ with respect to the field $f \\equiv \\beta \\mu$:\n  - $\\langle N \\rangle = \\partial \\ln \\Xi / \\partial f$,\n  - $\\mathrm{Var}(N) = \\partial^2 \\ln \\Xi / \\partial f^2 = \\partial \\langle N \\rangle / \\partial f$.\n- Define the per-volume susceptibility $\\kappa$ with respect to the GCE field $f = \\beta \\mu$ by $\\kappa \\equiv V^{-1} \\, \\partial \\langle N \\rangle / \\partial f$. It follows directly from the definitions that $\\mathrm{Var}(N) = V \\, \\kappa$.\n\nFinite-size scaling setting:\n- At criticality for a lattice gas, the correlation length $\\xi$ is controlled by the system size $L$ when $\\xi \\gtrsim L$. In $d$ spatial dimensions, one expects that response functions exhibit pure power-law scaling in $L$ at criticality. Assume that both the per-volume susceptibility $\\kappa(L)$ and the particle-number variance $\\mathrm{Var}(N;L)$ obey pure power laws in $L$ asymptotically at criticality with nonuniversal amplitudes.\n- The critical exponents $\\gamma$ and $\\nu$ characterize the divergence of the susceptibility and the correlation length in the thermodynamic limit, and the anomalous dimension $\\eta$ is related to the decay of critical two-point correlations. Your goal is to estimate the ratio $\\gamma/\\nu$ from each observable independently via finite-size scaling, and then estimate $\\eta$ using the scaling relation that connects $\\gamma/\\nu$ to $\\eta$.\n\nTasks your program must perform:\n1. Using only the fundamental base above, construct a principled estimator for the exponent ratio $\\gamma/\\nu$ from:\n   - the scaling of the per-volume susceptibility $\\kappa(L)$,\n   - the scaling of the total particle-number variance $\\mathrm{Var}(N;L)$,\n   while carefully accounting for the spatial dimension $d$ and the relation $\\mathrm{Var}(N) = V \\kappa$ with $V = L^d$.\n2. For each data set in the test suite below, compute:\n   - the estimate of $\\gamma/\\nu$ obtained from $\\kappa(L)$,\n   - the estimate of $\\gamma/\\nu$ obtained from $\\mathrm{Var}(N;L)$,\n   - the estimate of $\\eta$ obtained by averaging the two $\\gamma/\\nu$ estimates and invoking the critical scaling relation that links $\\gamma/\\nu$ and $\\eta$.\n3. Use linear regression in logarithmic variables to estimate power-law exponents from the $L$-dependence of each observable. Round all reported quantities to $6$ decimal places.\n\nTest suite:\nEach test case specifies a spatial dimension $d$, a nonuniversal amplitude $A > 0$, an exponent ratio target $r \\equiv \\gamma/\\nu$, and a set of linear sizes $L$. The measured series are defined by the critical, finite-size forms\n$\\kappa(L) = A \\, L^{r}$ and $\\mathrm{Var}(N;L) = L^{d} \\, \\kappa(L)$.\nFor each test case $(d,A,r,\\{L\\})$ below, construct the corresponding series $\\{\\kappa(L)\\}$ and $\\{\\mathrm{Var}(N;L)\\}$ and then apply your estimators.\n\n- Case $1$:\n  - $d = 2$, $A = 0.6$, $r = 1.75$, $L \\in \\{8,12,16,24,32\\}$.\n- Case $2$:\n  - $d = 3$, $A = 1.2$, $r = 1.96$, $L \\in \\{6,8,10,12,16\\}$.\n- Case $3$:\n  - $d = 2$, $A = 2.5$, $r = 1.5$, $L \\in \\{4,6,8,10\\}$.\n\nRequired final output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. For each case, output in order:\n  - the estimated $\\gamma/\\nu$ from $\\kappa(L)$,\n  - the estimated $\\gamma/\\nu$ from $\\mathrm{Var}(N;L)$,\n  - the estimated $\\eta$ computed from the average of the two $\\gamma/\\nu$ estimates.\n- All outputs must be rounded to $6$ decimal places.\n- The final output must flatten the three-case results into one list, e.g., $[\\mathrm{case1\\_gk},\\mathrm{case1\\_gv},\\mathrm{case1\\_\\eta},\\mathrm{case2\\_gk},\\mathrm{case2\\_gv},\\mathrm{case2\\_\\eta},\\mathrm{case3\\_gk},\\mathrm{case3\\_gv},\\mathrm{case3\\_\\eta}]$.", "solution": "The problem statement is critically examined and found to be valid. It is scientifically grounded in the principles of statistical mechanics and critical phenomena, internally consistent, and well-posed. We proceed with the solution.\n\nThe objective is to derive and implement estimators for the critical exponent ratio $\\gamma/\\nu$ and the anomalous dimension $\\eta$ for a $d$-dimensional lattice gas from finite-size scaling (FSS) data at criticality. The data are provided for the per-volume susceptibility $\\kappa(L)$ and the total particle number variance $\\mathrm{Var}(N;L)$ as a function of linear system size $L$.\n\nFirst, we establish the estimator for $\\gamma/\\nu$ from the scaling of the per-volume susceptibility, $\\kappa(L)$. In the theory of critical phenomena, a response function that diverges as $|t|^{-\\lambda}$ in the thermodynamic limit (where $t$ is a measure of distance from the critical point) is expected to scale as $L^{\\lambda/\\nu}$ at the critical point in a finite system of size $L$. The susceptibility is predicted to diverge with exponent $\\gamma$, hence the FSS hypothesis is $\\kappa(L) \\sim L^{\\gamma/\\nu}$. The problem provides a specific functional form for the data:\n$$\n\\kappa(L) = A L^r\n$$\nwhere the exponent $r$ is defined as $r \\equiv \\gamma/\\nu$. To extract this exponent, we perform a transformation to a linear relationship by taking the natural logarithm of both sides:\n$$\n\\ln(\\kappa(L)) = \\ln(A) + r \\ln(L)\n$$\nThis equation is of the form $y = c + m x$, with $y = \\ln(\\kappa(L))$, $x = \\ln(L)$, intercept $c = \\ln(A)$, and slope $m = r$. Therefore, the first estimator for $\\gamma/\\nu$, which we denote $(\\gamma/\\nu)_{\\kappa}$, is the slope of a linear regression fit to the data points $(\\ln(L), \\ln(\\kappa(L)))$.\n$$\n(\\gamma/\\nu)_{\\kappa} = \\frac{d[\\ln(\\kappa(L))]}{d[\\ln(L)]}\n$$\n\nSecond, we derive the estimator for $\\gamma/\\nu$ from the scaling of the particle number variance, $\\mathrm{Var}(N;L)$. We begin with the fundamental fluctuation-response relation provided:\n$$\n\\mathrm{Var}(N) = V \\kappa\n$$\nThe system volume $V$ for a $d$-dimensional hypercubic system is $V = L^d$. Substituting this and the FSS form for $\\kappa(L)$ gives the scaling of the variance:\n$$\n\\mathrm{Var}(N;L) = L^d \\kappa(L) \\sim L^d L^{\\gamma/\\nu} = L^{d + \\gamma/\\nu}\n$$\nThe data generation rule given in the problem, $\\mathrm{Var}(N;L) = L^{d} \\, \\kappa(L) = L^d(A L^r) = A L^{d+r}$, is consistent with this derivation. Taking the natural logarithm gives:\n$$\n\\ln(\\mathrm{Var}(N;L)) = \\ln(A) + (d+r) \\ln(L)\n$$\nThis is again a linear relationship. The slope of a plot of $\\ln(\\mathrm{Var}(N;L))$ versus $\\ln(L)$ is $m' = d+r = d+\\gamma/\\nu$. To find the estimator for $\\gamma/\\nu$ from the variance data, denoted $(\\gamma/\\nu)_{\\mathrm{Var}}$, we must compute the slope $m'$ from the regression and subtract the spatial dimension $d$:\n$$\n(\\gamma/\\nu)_{\\mathrm{Var}} = \\frac{d[\\ln(\\mathrm{Var}(N;L))]}{d[\\ln(L)]} - d\n$$\n\nThird, we construct the estimator for the anomalous dimension $\\eta$. The standard scaling relation connecting $\\gamma$, $\\nu$, and $\\eta$ is:\n$$\n\\gamma = \\nu(2-\\eta)\n$$\nThis can be rearranged to express $\\eta$ in terms of the ratio $\\gamma/\\nu$:\n$$\n\\eta = 2 - \\gamma/\\nu\n$$\nAs per the problem specification, we first compute an average estimate for the ratio $\\gamma/\\nu$ from our two independent methods:\n$$\n(\\gamma/\\nu)_{\\mathrm{avg}} = \\frac{1}{2} \\left[ (\\gamma/\\nu)_{\\kappa} + (\\gamma/\\nu)_{\\mathrm{Var}} \\right]\n$$\nThe final estimator for $\\eta$ is then:\n$$\n\\eta_{\\mathrm{est}} = 2 - (\\gamma/\\nu)_{\\mathrm{avg}}\n$$\n\nThe computational procedure for each test case $(d, A, r, \\{L_i\\})$ is as follows:\n$1$. Construct the data series $\\{\\kappa(L_i)\\}$ and $\\{\\mathrm{Var}(N;L_i)\\}$ using the given formulas $\\kappa(L) = A L^r$ and $\\mathrm{Var}(N;L) = L^d \\kappa(L)$.\n$2$. Create vectors of logarithmic variables: $x_i = \\ln(L_i)$, $y_{\\kappa,i} = \\ln(\\kappa(L_i))$, and $y_{\\mathrm{Var},i} = \\ln(\\mathrm{Var}(N;L_i))$.\n$3$. Perform a linear regression on $(x_i, y_{\\kappa,i})$ to find the slope $m_{\\kappa}$. This gives the estimate $(\\gamma/\\nu)_\\kappa = m_{\\kappa}$.\n$4$. Perform a linear regression on $(x_i, y_{\\mathrm{Var},i})$ to find the slope $m_{\\mathrm{Var}}$. The estimate is $(\\gamma/\\nu)_{\\mathrm{Var}} = m_{\\mathrm{Var}} - d$.\n$5$. Calculate the average $(\\gamma/\\nu)_{\\mathrm{avg}}$ and the estimate $\\eta_{\\mathrm{est}} = 2 - (\\gamma/\\nu)_{\\mathrm{avg}}$.\n$6$. Round the three resulting values, $(\\gamma/\\nu)_\\kappa$, $(\\gamma/\\nu)_{\\mathrm{Var}}$, and $\\eta_{\\mathrm{est}}$, to $6$ decimal places for reporting.\n\nThis procedure is applied to all test cases, and the results are aggregated into a single flat list. Since the input data are generated from perfect power laws without noise, the linear regressions will yield the exact exponents, and thus we expect $(\\gamma/\\nu)_\\kappa = (\\gamma/\\nu)_{\\mathrm{Var}} = r$ for all cases, subject to floating-point precision.", "answer": "```python\nimport numpy as np\nfrom scipy.stats import linregress\n\ndef solve():\n    \"\"\"\n    Solves the problem of estimating critical exponents from finite-size scaling data.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (d, A, r, L_list)\n    # d: spatial dimension\n    # A: nonuniversal amplitude\n    # r: exponent ratio gamma/nu\n    # L_list: list of linear system sizes\n    test_cases = [\n        (2, 0.6, 1.75, [8, 12, 16, 24, 32]),\n        (3, 1.2, 1.96, [6, 8, 10, 12, 16]),\n        (2, 2.5, 1.5, [4, 6, 8, 10]),\n    ]\n\n    all_results_flat = []\n\n    for case in test_cases:\n        d, A, r, L_values = case\n\n        # Convert list of L values to a numpy array for vectorized operations\n        L = np.array(L_values, dtype=np.float64)\n\n        # 1. Generate data series according to the problem's model\n        # Per-volume susceptibility: kappa(L) = A * L^r\n        kappa = A * (L ** r)\n        # Total particle-number variance: Var(N;L) = L^d * kappa(L)\n        var_N = (L ** d) * kappa\n\n        # 2. Transform to logarithmic variables for linear regression\n        log_L = np.log(L)\n        log_kappa = np.log(kappa)\n        log_var_N = np.log(var_N)\n\n        # 3. Perform linear regression for kappa(L) data\n        # The equation is log(kappa) = log(A) + r * log(L). The slope is 'r'.\n        kappa_regression = linregress(log_L, log_kappa)\n        gamma_nu_from_kappa = kappa_regression.slope\n\n        # 4. Perform linear regression for Var(N;L) data\n        # The equation is log(Var(N)) = log(A) + (d+r) * log(L). The slope is 'd+r'.\n        var_N_regression = linregress(log_L, log_var_N)\n        gamma_nu_from_var = var_N_regression.slope - d\n\n        # 5. Calculate the estimate for the anomalous dimension eta\n        # First, average the two estimates for gamma/nu.\n        gamma_nu_avg = (gamma_nu_from_kappa + gamma_nu_from_var) / 2.0\n        # Then, use the scaling relation eta = 2 - gamma/nu.\n        eta_est = 2.0 - gamma_nu_avg\n\n        # 6. Append formatted results to the list\n        all_results_flat.append(f\"{gamma_nu_from_kappa:.6f}\")\n        all_results_flat.append(f\"{gamma_nu_from_var:.6f}\")\n        all_results_flat.append(f\"{eta_est:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(all_results_flat)}]\")\n\nsolve()\n```", "id": "2675496"}]}