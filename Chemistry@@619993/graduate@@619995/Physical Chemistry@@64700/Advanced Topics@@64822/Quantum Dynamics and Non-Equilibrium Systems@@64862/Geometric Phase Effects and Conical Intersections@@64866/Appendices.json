{"hands_on_practices": [{"introduction": "To grasp the origins of the geometric phase, we begin with the canonical model of a conical intersection: the $E \\otimes e$ Jahn-Teller system. This foundational exercise guides you through the process of diagonalizing the vibronic coupling Hamiltonian to reveal the characteristic double-cone potential energy surface [@problem_id:2642890]. By deriving the form of the adiabatic electronic states, you will then directly compute the celebrated $\\pi$ geometric phase acquired upon encircling the intersection point.", "problem": "A doubly degenerate electronic state of symmetry $E$ linearly coupled to a doubly degenerate vibrational mode of symmetry $e$ is modeled near a high-symmetry geometry by the standard linear vibronic coupling Hamiltonian of Jahn–Teller (JT) type in a diabatic electronic basis. In the Born–Oppenheimer (BO) framework, the adiabatic potential energy surfaces are obtained as the eigenvalues of the electronic Hamiltonian for fixed nuclear coordinates. Consider the following two-mode $E \\otimes e$ JT Hamiltonian (ignoring the nuclear kinetic energy term since only the potential energy surfaces are sought):\n$$\nH(Q_1,Q_2) \\;=\\; \\frac{1}{2}\\,k\\,(Q_1^{2}+Q_2^{2})\\,\\mathbb{I}\n\\;+\\;\n\\begin{pmatrix}\nV\\,Q_1 & V\\,Q_2 \\\\\nV\\,Q_2 & -V\\,Q_1\n\\end{pmatrix},\n$$\nwhere $Q_1$ and $Q_2$ are mass-weighted normal coordinates of the $e$ mode, $k>0$ is an effective force constant, $V>0$ is a linear vibronic coupling constant, and $\\mathbb{I}$ is the $2\\times 2$ identity.\n\nTasks:\n- Introduce polar coordinates $Q_1=r\\cos\\phi$ and $Q_2=r\\sin\\phi$ with $r\\ge 0$ and $0\\le \\phi<2\\pi$, and rewrite the Hamiltonian in terms of $r$ and $\\phi$.\n- Using only the principles of the Born–Oppenheimer separation and standard matrix diagonalization, derive the two adiabatic potential energy surfaces $E_{+}(r)$ and $E_{-}(r)$ as explicit functions of $r$.\n- Identify and justify the presence of a conical intersection at the origin $r=0$.\n- For the lower adiabatic electronic state $\\lvert \\chi_{-}(\\phi)\\rangle$ chosen to be real and continuous on $0<\\phi<2\\pi$, use the definition of the geometric (Berry) phase $\\gamma = i\\oint \\langle \\chi_{-}(\\phi)\\rvert \\partial_{\\phi} \\chi_{-}(\\phi)\\rangle\\, d\\phi$ together with appropriate patching at $\\phi=2\\pi$ to compute the geometric phase accumulated upon one counterclockwise circuit at fixed $r>0$ around the conical intersection. Express this angle in radians.\n\nGive your final answer as the ordered triple $\\big(E_{+}(r),\\,E_{-}(r),\\,\\gamma\\big)$. No numerical substitution is required; provide exact symbolic expressions. If an angle appears, express it in radians.", "solution": "The problem statement must first be validated for scientific soundness, completeness, and objectivity.\n\nStep 1: Extract Givens\n-   The two-mode $E \\otimes e$ Jahn-Teller Hamiltonian is given as:\n    $$\n    H(Q_1,Q_2) \\;=\\; \\frac{1}{2}\\,k\\,(Q_1^{2}+Q_2^{2})\\,\\mathbb{I}\n    \\;+\\;\n    \\begin{pmatrix}\n    V\\,Q_1 & V\\,Q_2 \\\\\n    V\\,Q_2 & -V\\,Q_1\n    \\end{pmatrix}\n    $$\n-   $Q_1$ and $Q_2$ are mass-weighted normal coordinates.\n-   $k > 0$ is an effective force constant.\n-   $V > 0$ is a linear vibronic coupling constant.\n-   $\\mathbb{I}$ is the $2 \\times 2$ identity matrix.\n-   A transformation to polar coordinates is specified: $Q_1 = r\\cos\\phi$ and $Q_2 = r\\sin\\phi$, with $r \\ge 0$ and $0 \\le \\phi < 2\\pi$.\n-   The definition of the geometric phase is given: $\\gamma = i\\oint \\langle \\chi_{-}(\\phi)\\rvert \\partial_{\\phi} \\chi_{-}(\\phi)\\rangle\\, d\\phi$.\n-   The lower adiabatic electronic state $\\lvert \\chi_{-}(\\phi)\\rangle$ is to be chosen as real and continuous on $0 < \\phi < 2\\pi$.\n-   The circuit for the geometric phase is counterclockwise at fixed $r > 0$.\n\nStep 2: Validate Using Extracted Givens\n-   **Scientifically Grounded**: The problem describes the linear $E \\otimes e$ Jahn-Teller effect, a cornerstone of molecular physics and physical chemistry. The Hamiltonian is the standard model used to describe vibronic coupling in systems with electronic degeneracy. The concepts of Born-Oppenheimer surfaces, conical intersections, and the geometric (Berry) phase are all fundamental and established principles. The problem is scientifically rigorous.\n-   **Well-Posed**: The tasks are clearly defined mathematical operations: a change of variables, matrix diagonalization, and evaluation of a line integral. All necessary parameters and definitions ($H$, $k$, $V$, $\\gamma$) are provided, ensuring that a unique, meaningful solution can be derived.\n-   **Objective**: The problem is formulated in the precise and unambiguous language of mathematics and theoretical physics. There are no subjective statements or opinions.\n\nStep 3: Verdict and Action\nThe problem is valid. It is scientifically sound, well-posed, and objective. A complete solution will be provided.\n\n**Solution Derivation**\n\nThe problem requires a systematic analysis of the provided Jahn-Teller Hamiltonian.\n\n**1. Hamiltonian in Polar Coordinates**\n\nThe first task is to express the Hamiltonian in terms of polar coordinates $r$ and $\\phi$. We substitute $Q_1 = r\\cos\\phi$ and $Q_2 = r\\sin\\phi$ into the given expression for $H(Q_1, Q_2)$.\nThe harmonic term becomes $\\frac{1}{2}k(Q_1^2 + Q_2^2) = \\frac{1}{2}k(r^2\\cos^2\\phi + r^2\\sin^2\\phi) = \\frac{1}{2}kr^2$.\nThe coupling matrix becomes:\n$$\n\\begin{pmatrix}\nV\\,Q_1 & V\\,Q_2 \\\\\nV\\,Q_2 & -V\\,Q_1\n\\end{pmatrix}\n= V\n\\begin{pmatrix}\nr\\cos\\phi & r\\sin\\phi \\\\\nr\\sin\\phi & -r\\cos\\phi\n\\end{pmatrix}\n= V r\n\\begin{pmatrix}\n\\cos\\phi & \\sin\\phi \\\\\n\\sin\\phi & -\\cos\\phi\n\\end{pmatrix}\n$$\nCombining these terms, the full Hamiltonian in polar coordinates is:\n$$\nH(r, \\phi) = \\frac{1}{2}kr^2\\mathbb{I} + V r \\begin{pmatrix} \\cos\\phi & \\sin\\phi \\\\ \\sin\\phi & -\\cos\\phi \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{2}kr^2 + Vr\\cos\\phi & Vr\\sin\\phi \\\\ Vr\\sin\\phi & \\frac{1}{2}kr^2 - Vr\\cos\\phi \\end{pmatrix}\n$$\n\n**2. Adiabatic Potential Energy Surfaces**\n\nThe adiabatic potential energy surfaces, denoted $E_{\\pm}(r)$, are the eigenvalues of the Hamiltonian matrix $H(r, \\phi)$. We find the eigenvalues by solving the characteristic equation $\\det(H - E\\mathbb{I}) = 0$.\n$$\n\\left| \\begin{array}{cc} \\frac{1}{2}kr^2 + Vr\\cos\\phi - E & Vr\\sin\\phi \\\\ Vr\\sin\\phi & \\frac{1}{2}kr^2 - Vr\\cos\\phi - E \\end{array} \\right| = 0\n$$\nLet us define a shifted eigenvalue $E' = E - \\frac{1}{2}kr^2$. The equation simplifies to:\n$$\n\\left| \\begin{array}{cc} Vr\\cos\\phi - E' & Vr\\sin\\phi \\\\ Vr\\sin\\phi & -Vr\\cos\\phi - E' \\end{array} \\right| = 0\n$$\n$$\n(Vr\\cos\\phi - E')(-Vr\\cos\\phi - E') - (Vr\\sin\\phi)^2 = 0\n$$\n$$\n-(E')^2 + (Vr\\cos\\phi)^2 - (Vr\\sin\\phi)^2 = 0\n$$\n$$\n(E')^2 = V^2r^2(\\cos^2\\phi + \\sin^2\\phi)\n$$\nThe provided derivation has a minor algebra error here. It should be:\n$$\n-(E')^2 - (Vr\\cos\\phi)^2 + (E')^2 - (Vr\\sin\\phi)^2 = 0 \\quad \\text{Mistake in original transcription. Correct expansion is:}\n$$\n$$\n(E')^2 - (Vr\\cos\\phi)^2 - (Vr\\sin\\phi)^2 = 0\n$$\n$$\n(E')^2 = V^2r^2(\\cos^2\\phi + \\sin^2\\phi) = V^2r^2\n$$\n$$\n(E')^2 = V^2r^2 \\implies E' = \\pm Vr\n$$\nSubstituting back $E' = E - \\frac{1}{2}kr^2$, we find the eigenvalues:\n$$\nE = \\frac{1}{2}kr^2 \\pm Vr\n$$\nThese are the two adiabatic potential energy surfaces. They depend only on $r$, not on $\\phi$, which is a characteristic feature of the $E \\otimes e$ Jahn-Teller effect. The upper and lower surfaces are:\n$$\nE_{+}(r) = \\frac{1}{2}kr^2 + Vr\n$$\n$$\nE_{-}(r) = \\frac{1}{2}kr^2 - Vr\n$$\n\n**3. Conical Intersection**\n\nA conical intersection is a point in the nuclear coordinate space where two or more potential energy surfaces become degenerate. From the derived expressions for $E_{+}(r)$ and $E_{-}(r)$:\nThe energy difference between the two surfaces is $\\Delta E(r) = E_{+}(r) - E_{-}(r) = 2Vr$.\nThe surfaces are degenerate if and only if $\\Delta E(r) = 0$, which for $V > 0$ occurs only at $r=0$. At this point, $Q_1 = 0$ and $Q_2 = 0$, and both surfaces have the same energy $E_{+}(0) = E_{-}(0) = 0$. For any $r > 0$, the degeneracy is lifted, and the energy splitting grows linearly with $r$. This geometry, where two surfaces meet at a single point and separate linearly, defines a conical intersection. The high-symmetry point $r=0$ is the apex of the cones.\n\n**4. Geometric Phase**\n\nTo compute the geometric phase $\\gamma$, we first need the normalized eigenvector $|\\chi_{-}(\\phi)\\rangle$ corresponding to the lower energy surface $E_{-}(r) = \\frac{1}{2}kr^2 - Vr$. The eigenvector equation is:\n$$\nH(r, \\phi) |\\chi_{-}\\rangle = E_{-} |\\chi_{-}\\rangle\n$$\n$$\n\\left( \\frac{1}{2}kr^2\\mathbb{I} + Vr \\begin{pmatrix} \\cos\\phi & \\sin\\phi \\\\ \\sin\\phi & -\\cos\\phi \\end{pmatrix} \\right) |\\chi_{-}\\rangle = \\left(\\frac{1}{2}kr^2 - Vr\\right) |\\chi_{-}\\rangle\n$$\nFor $r > 0$, this simplifies to:\n$$\n\\begin{pmatrix} \\cos\\phi & \\sin\\phi \\\\ \\sin\\phi & -\\cos\\phi \\end{pmatrix} |\\chi_{-}\\rangle = -|\\chi_{-}\\rangle\n$$\nLet $|\\chi_{-}\\rangle = \\begin{pmatrix} c_1 \\\\ c_2 \\end{pmatrix}$. The first row gives the equation:\n$$\nc_1\\cos\\phi + c_2\\sin\\phi = -c_1 \\implies c_1(1+\\cos\\phi) + c_2\\sin\\phi = 0\n$$\nUsing the half-angle identities $1+\\cos\\phi = 2\\cos^2(\\phi/2)$ and $\\sin\\phi = 2\\sin(\\phi/2)\\cos(\\phi/2)$, we get:\n$$\nc_1(2\\cos^2(\\phi/2)) + c_2(2\\sin(\\phi/2)\\cos(\\phi/2)) = 0\n$$\nFor $\\phi \\neq \\pi$, we can divide by $2\\cos(\\phi/2)$ to obtain $c_1\\cos(\\phi/2) + c_2\\sin(\\phi/2) = 0$.\nA normalized real vector satisfying this condition and the problem's continuity requirement on $0 < \\phi < 2\\pi$ is:\n$$\n|\\chi_{-}(\\phi)\\rangle = \\begin{pmatrix} \\sin(\\phi/2) \\\\ -\\cos(\\phi/2) \\end{pmatrix}\n$$\nWe must examine the behavior of this eigenvector over a closed loop $\\phi: 0 \\to 2\\pi$.\n$|\\chi_{-}(0)\\rangle = \\begin{pmatrix} 0 \\\\ -1 \\end{pmatrix}$ and $|\\chi_{-}(2\\pi)\\rangle = \\begin{pmatrix} \\sin(\\pi) \\\\ -\\cos(\\pi) \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}$.\nThus, $|\\chi_{-}(2\\pi)\\rangle = -|\\chi_{-}(0)\\rangle$. The state vector is double-valued; it acquires a sign change upon a complete circuit around the conical intersection.\n\nThe problem provides the definition $\\gamma = i\\oint \\langle \\chi_{-}(\\phi)\\rvert \\partial_{\\phi} \\chi_{-}(\\phi)\\rangle\\, d\\phi$. Naively applying this to our real eigenvector $|\\chi_{-}(\\phi)\\rangle$ yields a zero result, because for any normalized real vector $|\\psi\\rangle$, $\\langle\\psi|\\partial_{\\phi}\\psi\\rangle = \\frac{1}{2}\\partial_{\\phi}\\langle\\psi|\\psi\\rangle = \\frac{1}{2}\\partial_{\\phi}(1) = 0$.\n\nThis apparent paradox is resolved by considering the phrase \"appropriate patching at $\\phi=2\\pi$\". The integral definition of the geometric phase is for single-valued states. Our state $|\\chi_{-}(\\phi)\\rangle$ is not single-valued. We must first construct a single-valued state $|\\tilde{\\chi}(\\phi)\\rangle$ by multiplying $|\\chi_{-}(\\phi)\\rangle$ by a phase factor, which is a gauge transformation. Let $|\\tilde{\\chi}(\\phi)\\rangle = e^{i f(\\phi)} |\\chi_{-}(\\phi)\\rangle$. For $|\\tilde{\\chi}(\\phi)\\rangle$ to be single-valued, we require $|\\tilde{\\chi}(2\\pi)\\rangle = |\\tilde{\\chi}(0)\\rangle$.\n$$\ne^{i f(2\\pi)} |\\chi_{-}(2\\pi)\\rangle = e^{i f(0)} |\\chi_{-}(0)\\rangle \\implies e^{i f(2\\pi)} (-|\\chi_{-}(0)\\rangle) = e^{i f(0)} |\\chi_{-}(0)\\rangle\n$$\nThis requires $e^{i(f(2\\pi) - f(0))} = -1 = e^{i\\pi}$. A valid choice for $f(\\phi)$ is $f(\\phi) = -\\phi/2$, which yields $f(2\\pi) - f(0) = -\\pi$. Let's choose this gauge. Then $|\\tilde{\\chi}(\\phi)\\rangle = e^{-i\\phi/2} |\\chi_{-}(\\phi)\\rangle$ is single-valued.\nThe geometric phase is gauge-invariant and must be computed for this single-valued state. The Berry connection $A_{\\phi}$ transforms as $A_{\\phi} \\to \\tilde{A}_{\\phi} = A_{\\phi} - \\partial_{\\phi}f(\\phi)$.\nThe original connection is $A_{\\phi} = i\\langle \\chi_{-}|\\partial_{\\phi}\\chi_{-}\\rangle = 0$, as shown before.\nThe new connection is $\\tilde{A}_{\\phi} = 0 - \\partial_{\\phi}(-\\phi/2) = 1/2$.\nThe geometric phase is the integral of this new connection over the path:\n$$\n\\gamma = \\oint \\tilde{A}_{\\phi} d\\phi = \\int_{0}^{2\\pi} \\frac{1}{2} d\\phi = \\pi\n$$\nThis is the well-known Berry phase of $\\pi$ acquired by an electronic state encircling a conical intersection.\n\nThe final answer is the ordered triple $(E_{+}(r), E_{-}(r), \\gamma)$.\n$E_{+}(r) = \\frac{1}{2} kr^2 + Vr$\n$E_{-}(r) = \\frac{1}{2} kr^2 - Vr$\n$\\gamma = \\pi$", "answer": "$$\n\\boxed{\\left(\\frac{1}{2} k r^{2} + V r, \\frac{1}{2} k r^{2} - V r, \\pi\\right)}\n$$", "id": "2642890"}, {"introduction": "The geometric phase is not just an arbitrary phase factor; it is fundamentally topological, meaning its value depends on whether the path of the system encloses the degeneracy point. This next practice provides a crucial counterpoint to the first, challenging you to demonstrate mathematically that the geometric phase vanishes for a closed loop that does not encircle the conical intersection [@problem_id:2642867]. Successfully completing this exercise solidifies the understanding that the non-trivial phase is intrinsically linked to the topology of the nuclear path relative to the singularity.", "problem": "Consider the two-state linear vibronic coupling Hamiltonian in two nuclear coordinates $\\mathbf{R}=(x,y)$,\n$$\n\\hat{H}(\\mathbf{R}) \\;=\\; \\begin{pmatrix}\n\\kappa\\,x & \\lambda\\,y \\\\\n\\lambda\\,y & -\\kappa\\,x\n\\end{pmatrix},\n$$\nwhere $\\kappa>0$ and $\\lambda>0$ are real constants, and the conical intersection is at $(x,y)=(0,0)$. A nuclear trajectory is a simple closed loop in the plane parameterized by\n$$\nx(\\phi) \\;=\\; R_{0} + r\\cos\\phi,\\quad y(\\phi) \\;=\\; r\\sin\\phi,\\quad \\phi\\in[0,2\\pi],\n$$\nwith parameters $R_{0}>r>0$, so that the loop does not enclose the origin.\n\nAssume adiabatic nuclear motion on the lower adiabatic electronic state over one cycle $\\phi:0\\to 2\\pi$. Using only fundamental definitions appropriate for adiabatic transport in parameter-dependent quantum systems, compute the geometric (Berry) phase accumulated by the lower adiabatic electronic eigenstate over the closed loop. Provide your final answer in radians as an exact value. Do not use any external fields or nonadiabatic couplings beyond those implicit in $\\hat{H}(\\mathbf{R})$.", "solution": "The problem requires the computation of the geometric (Berry) phase accumulated by the lower adiabatic electronic eigenstate of a given two-state Hamiltonian, as its parameters are varied along a specified closed loop.\n\nThe Hamiltonian is a function of the nuclear coordinates $\\mathbf{R}=(x,y)$ and is given by:\n$$\n\\hat{H}(\\mathbf{R}) = \\begin{pmatrix}\n\\kappa\\,x & \\lambda\\,y \\\\\n\\lambda\\,y & -\\kappa\\,x\n\\end{pmatrix}\n$$\nwhere $\\kappa$ and $\\lambda$ are positive real constants. This Hamiltonian has a conical intersection at $\\mathbf{R}=(0,0)$, where the two electronic states become degenerate.\n\nThe nuclear trajectory is a closed loop $C$ parameterized by $\\phi \\in [0, 2\\pi]$:\n$$\nx(\\phi) = R_{0} + r\\cos\\phi, \\quad y(\\phi) = r\\sin\\phi\n$$\nwith the condition $R_{0} > r > 0$. This describes a circle of radius $r$ centered at $(R_{0}, 0)$. Crucially, because $R_{0} > r$, the value of $x(\\phi) = R_{0} + r\\cos\\phi$ is always positive, as its minimum value is $R_0 - r > 0$. This implies that the closed loop $C$ does not enclose the origin $(0,0)$, the location of the conical intersection.\n\nThe geometric phase $\\gamma$ accumulated by a normalized adiabatic eigenstate $|\\psi(\\mathbf{R})\\rangle$ over a closed path $C$ in parameter space is defined by the line integral of the Berry connection $\\mathbf{A}(\\mathbf{R})$:\n$$\n\\gamma = \\oint_C \\mathbf{A}(\\mathbf{R}) \\cdot d\\mathbf{R}\n$$\nwhere the Berry connection is given by\n$$\n\\mathbf{A}(\\mathbf{R}) = i \\langle \\psi(\\mathbf{R}) | \\nabla_{\\mathbf{R}} \\psi(\\mathbf{R}) \\rangle\n$$\nand $\\nabla_{\\mathbf{R}} = \\left(\\frac{\\partial}{\\partial x}, \\frac{\\partial}{\\partial y}\\right)$ is the gradient operator with respect to the parameters.\n\nFirst, we must find the eigenvalues and the lower adiabatic eigenstate of $\\hat{H}(\\mathbf{R})$. The characteristic equation is $\\det(\\hat{H} - E\\hat{I})=0$:\n$$\n(-E + \\kappa x)(-E - \\kappa x) - (\\lambda y)^2 = 0 \\implies E^2 - (\\kappa x)^2 - (\\lambda y)^2 = 0\n$$\nThe eigenvalues are $E_{\\pm}(\\mathbf{R}) = \\pm \\sqrt{(\\kappa x)^2 + (\\lambda y)^2}$. The lower adiabatic state corresponds to the eigenvalue $E_{-}(\\mathbf{R}) = -\\sqrt{(\\kappa x)^2 + (\\lambda y)^2}$.\n\nSince the Hamiltonian matrix is real and symmetric, its eigenvectors can be chosen to be real. A key insight is that the ability to define a *single-valued* eigenvector along the entire path determines the nature of the geometric phase. Let us define a set of effective parameters $X = \\kappa x$ and $Y = \\lambda y$. The Hamiltonian becomes:\n$$\n\\hat{H} = \\begin{pmatrix} X & Y \\\\ Y & -X \\end{pmatrix}\n$$\nLet us express these parameters in polar coordinates: $X = \\rho \\cos\\alpha$ and $Y = \\rho \\sin\\alpha$, where $\\rho = \\sqrt{X^2+Y^2}$ and $\\alpha = \\operatorname{atan2}(Y, X)$ is the polar angle. The Hamiltonian is then $\\hat{H} = \\rho \\begin{pmatrix} \\cos\\alpha & \\sin\\alpha \\\\ \\sin\\alpha & -\\cos\\alpha \\end{pmatrix}$. The normalized eigenvector corresponding to the lower eigenvalue $E_{-} = -\\rho$ is:\n$$\n|\\psi_{-}(\\mathbf{R})\\rangle = \\begin{pmatrix} \\sin(\\alpha/2) \\\\ -\\cos(\\alpha/2) \\end{pmatrix}\n$$\nThis eigenvector is real. Its single-valuedness along the path $C$ depends on the behavior of the angle $\\alpha$. The path in the $(X, Y)$ parameter space is an ellipse given by $X(\\phi) = \\kappa(R_0 + r\\cos\\phi)$ and $Y(\\phi) = \\lambda r\\sin\\phi$. Since $x(\\phi) > 0$ for all $\\phi$, it follows that $X(\\phi) = \\kappa x(\\phi) > 0$. The path in the $(X,Y)$ plane is entirely contained in the right half-plane ($X>0$) and therefore does not enclose the origin $(0,0)$.\n\nBecause the path does not enclose the origin of the parameter space, the angle $\\alpha$ can be defined as a continuous, single-valued function along the path, for example, by using $\\alpha = \\arctan(Y/X)$, with values in the range $(-\\pi/2, \\pi/2)$. After one full cycle $\\phi: 0 \\to 2\\pi$, the system returns to its starting point in parameter space, and the angle $\\alpha$ returns to its initial value, such that $\\alpha(2\\pi) = \\alpha(0)$.\nThis ensures that the real eigenvector $|\\psi_{-}(\\mathbf{R})\\rangle$ is a continuous and single-valued function of position along the loop $C$.\n\nNow we calculate the Berry connection for such a single-valued, real, normalized eigenstate. Let $|\\psi(\\mathbf{R})\\rangle$ be such a state. It is a column vector with real components $\\psi_k(\\mathbf{R})$, and it is normalized: $\\langle\\psi|\\psi\\rangle = \\sum_k \\psi_k^2 = 1$. The Berry connection is $\\mathbf{A}(\\mathbf{R}) = i \\langle \\psi | \\nabla_{\\mathbf{R}} \\psi \\rangle$. Let us consider one component of the gradient, e.g., with respect to $x$:\n$$\n\\langle \\psi | \\frac{\\partial}{\\partial x} \\psi \\rangle = \\sum_k \\psi_k \\frac{\\partial \\psi_k}{\\partial x}\n$$\nFrom the normalization condition, we can differentiate with respect to $x$:\n$$\n\\frac{\\partial}{\\partial x} \\left(\\sum_k \\psi_k^2\\right) = \\frac{\\partial}{\\partial x}(1) = 0\n$$\n$$\n\\sum_k 2 \\psi_k \\frac{\\partial \\psi_k}{\\partial x} = 0 \\implies \\sum_k \\psi_k \\frac{\\partial \\psi_k}{\\partial x} = 0\n$$\nThus, the $x$-component of the vector $\\langle \\psi | \\nabla_{\\mathbf{R}} \\psi \\rangle$ is zero. The same reasoning applies to the $y$-component. Therefore, for a choice of a single-valued real eigenstate, we have:\n$$\n\\langle \\psi_{-}(\\mathbf{R}) | \\nabla_{\\mathbf{R}} \\psi_{-}(\\mathbf{R}) \\rangle = \\mathbf{0}\n$$\nThis means that in the gauge where the eigenstate is represented by a single-valued real vector, the Berry connection is identically zero:\n$$\n\\mathbf{A}(\\mathbf{R}) = i (\\mathbf{0}) = \\mathbf{0}\n$$\nThe geometric phase is then the integral of this zero vector field along the path $C$:\n$$\n\\gamma = \\oint_C \\mathbf{0} \\cdot d\\mathbf{R} = 0\n$$\nThe geometric phase is zero. This result is a manifestation of a general principle: a non-trivial geometric phase arises if and only if the path in the parameter space encloses a point of degeneracy (a conical intersection). In this problem, the path is explicitly constructed not to enclose the degeneracy.", "answer": "$$\n\\boxed{0}\n$$", "id": "2642867"}, {"introduction": "Bridging the gap between analytical theory and computational practice is a vital skill in modern physical chemistry. This hands-on coding exercise introduces a powerful numerical method for calculating the geometric phase based on the product of overlaps between adjacent electronic states along a discretized path [@problem_id:2642870]. By implementing this algorithm, you will numerically verify the topological nature of the phase, observing a value near $\\pi$ for enclosing loops and near zero for non-enclosing ones, thereby confirming our previous analytical findings.", "problem": "Consider a two-state linear vibronic coupling model of an $E\\otimes e$ Jahn–Teller conical intersection in two nuclear coordinates $Q_x$ and $Q_y$. The electronic Hamiltonian in a fixed diabatic basis is given by\n$$\n\\hat{H}_{\\mathrm{el}}(Q_x,Q_y) = \\kappa \\left( Q_x \\,\\hat{\\sigma}_x + Q_y \\,\\hat{\\sigma}_z \\right),\n$$\nwhere $\\hat{\\sigma}_x$ and $\\hat{\\sigma}_z$ are Pauli matrices, and $\\kappa$ is a real coupling constant. Take $\\kappa = 1$ in dimensionless units. For each nuclear geometry $\\mathbf{R} = (Q_x,Q_y)$, define the adiabatic ground electronic state $\\lvert n(\\mathbf{R})\\rangle$ as the normalized eigenvector of $\\hat{H}_{\\mathrm{el}}(\\mathbf{R})$ with the lowest eigenvalue.\n\nGiven a discretized closed loop of $N$ nuclear geometries $\\{\\mathbf{R}_k\\}_{k=0}^{N-1}$ with periodic closure $\\mathbf{R}_N \\equiv \\mathbf{R}_0$, define the overlap product\n$$\nP = \\prod_{k=0}^{N-1} \\left\\langle n(\\mathbf{R}_k)\\,\\middle|\\,n\\!\\left(\\mathbf{R}_{k+1}\\right)\\right\\rangle,\n$$\nand the associated geometric phase\n$$\n\\gamma = \\arg(P),\n$$\nwhere $\\arg(\\cdot)$ denotes the principal complex argument in radians in the interval $(-\\pi,\\pi]$. All angles must be in radians, and all quantities are dimensionless.\n\nUsing only the definitions above and fundamental linear algebra operations, construct a program that:\n- Builds the adiabatic ground state $\\lvert n(\\mathbf{R}_k)\\rangle$ at each discretized geometry by solving the eigenvalue problem for $\\hat{H}_{\\mathrm{el}}(\\mathbf{R}_k)$.\n- Computes the overlap product $P$ and the principal value $\\gamma = \\arg(P)$ for each of the loops in the test suite below.\n\nTest suite (each loop is parameterized over $k\\in\\{0,1,\\dots,N-1\\}$ with periodic closure $k=N\\mapsto 0$):\n1. Circle centered at $(0,0)$ enclosing the origin, one winding: $\\mathbf{R}_k = \\big(r\\cos\\theta_k,\\, r\\sin\\theta_k\\big)$ with $r=1$, $\\theta_k = 2\\pi\\,k/N$, $N=720$.\n2. Circle not enclosing the origin: center at $(2,0)$, radius $r=1$, one winding with the same discretization $\\theta_k = 2\\pi\\,k/N$, $N=720$.\n3. Circle centered at $(0,0)$ with two windings: $\\theta_k = 4\\pi\\,k/N$, $r=1$, $N=720$.\n4. Small circle centered at $(0,0)$, very close to the conical intersection but not passing through it: $r=10^{-3}$, one winding, $\\theta_k = 2\\pi\\,k/N$, $N=2000$.\n5. Ellipse enclosing the origin: center $(c_x,c_y)=(0.4,-0.2)$, semi-axes $a=1.0$, $b=0.6$, one winding with $\\theta_k = 2\\pi\\,k/N$, $N=1000$, path $\\mathbf{R}_k = \\big(c_x + a\\cos\\theta_k,\\, c_y + b\\sin\\theta_k\\big)$.\n\nYour program must compute $\\gamma$ for each loop precisely as defined above and produce the final results as a single line containing a list of floating-point numbers in radians, rounded to $6$ decimal places and ordered as listed in the test suite. The final output format must be exactly:\n\"[gamma_1,gamma_2,gamma_3,gamma_4,gamma_5]\"\n\nNo external input should be required. Angles must be in radians. All quantities are dimensionless. The problem is to demonstrate numerically that loops enclosing the conical intersection yield a result consistent with $-1$ for the overlap product, corresponding to $\\gamma$ equal to $\\pi$ modulo $2\\pi$, while loops not enclosing the conical intersection yield a result consistent with $+1$, corresponding to $\\gamma$ equal to $0$ modulo $2\\pi$.", "solution": "The problem requires the numerical computation of the geometric phase (Berry phase) for a two-state quantum system whose Hamiltonian depends on two parameters, $Q_x$ and $Q_y$. The system is taken along a closed loop in the $(Q_x, Q_y)$ parameter space, and the accumulated geometric phase is calculated. The problem serves as a numerical demonstration of a key property of the geometric phase: its value is $\\pi$ (modulo $2\\pi$) for any loop enclosing a point of electronic degeneracy (a conical intersection) and $0$ for any loop that does not.\n\nFirst, we formalize the electronic Hamiltonian. The problem states the Hamiltonian in a diabatic basis as $\\hat{H}_{\\mathrm{el}}(Q_x,Q_y) = \\kappa \\left( Q_x \\,\\hat{\\sigma}_x + Q_y \\,\\hat{\\sigma}_z \\right)$. With the coupling constant $\\kappa = 1$ and the standard matrix representations of the Pauli matrices $\\hat{\\sigma}_x = \\begin{pmatrix} 0 & 1 \\\\ 1 & 0 \\end{pmatrix}$ and $\\hat{\\sigma}_z = \\begin{pmatrix} 1 & 0 \\\\ 0 & -1 \\end{pmatrix}$, the Hamiltonian for a given nuclear geometry $\\mathbf{R} = (Q_x, Q_y)$ is a $2\\times2$ matrix:\n$$\nH(\\mathbf{R}) = \\begin{pmatrix} Q_y & Q_x \\\\ Q_x & -Q_y \\end{pmatrix}\n$$\nThis matrix is real and symmetric, and therefore Hermitian. Its eigenvalues are real and its eigenvectors are orthogonal. The eigenvalues are found by solving the characteristic equation $\\det(H - E\\mathbb{I}) = 0$, which yields $E^2 - Q_x^2 - Q_y^2 = 0$. The two energy surfaces are $E_{\\pm}(\\mathbf{R}) = \\pm\\sqrt{Q_x^2 + Q_y^2}$. These two surfaces meet at a single point, the origin $(Q_x, Q_y) = (0, 0)$, forming a conical intersection. At every other point, there is a non-zero energy gap between the two states.\n\nThe core of the computational task is to determine the adiabatic ground state, $\\lvert n(\\mathbf{R})\\rangle$, for each geometry $\\mathbf{R}_k$ along a discretized closed loop $\\{\\mathbf{R}_k\\}_{k=0}^{N-1}$. The ground state is the normalized eigenvector corresponding to the lowest eigenvalue, $E_-(\\mathbf{R}) = -\\sqrt{Q_x^2 + Q_y^2}$. This is a standard numerical eigenvalue problem. For each point $\\mathbf{R}_k$ on a given path, we construct the matrix $H(\\mathbf{R}_k)$ and numerically diagonalize it to find the eigenvalues and eigenvectors. We select the eigenvector corresponding to the smallest eigenvalue. Let us denote the sequence of ground states along the path as $\\{\\lvert n(\\mathbf{R}_k)\\rangle\\}_{k=0}^{N}$. Note that we must compute $N+1$ states to accommodate the loop closure $\\mathbf{R}_N = \\mathbf{R}_0$.\n\nThe geometric phase $\\gamma$ is defined via the overlap product, $P = \\prod_{k=0}^{N-1} \\left\\langle n(\\mathbf{R}_k)\\,\\middle|\\,n\\!\\left(\\mathbf{R}_{k+1}\\right)\\right\\rangle$. The phase is then $\\gamma = \\arg(P)$, where $\\arg(\\cdot)$ is the principal value of the complex argument in the interval $(-\\pi, \\pi]$. Each term $\\left\\langle n(\\mathbf{R}_k)\\,\\middle|\\,n\\!\\left(\\mathbf{R}_{k+1}\\right)\\right\\rangle$ in the product is the complex inner product of the ground state at step $k$ with the ground state at step $k+1$.\n\nA critical detail in the numerical implementation is the phase of the eigenvectors. A numerical eigensolver returns eigenvectors that are defined only up to an arbitrary complex phase factor of modulus $1$. However, the chosen definition of the product $P$ is robust against this ambiguity, provided a deterministic eigensolver is used. The arbitrary phase factors associated with each eigenvector, say $e^{i\\alpha_k}$ for $\\lvert n(\\mathbf{R}_k)\\rangle$, cancel out in the total product. The term $\\left\\langle n(\\mathbf{R}_k)\\,\\middle|\\,n\\!\\left(\\mathbf{R}_{k+1}\\right)\\right\\rangle$ will contain a phase factor $e^{-i\\alpha_k}e^{i\\alpha_{k+1}}$. In the full product $\\prod_{k=0}^{N-1}$, these terms telescope, leaving only a factor $e^{i(\\alpha_N - \\alpha_0)}$. Since the loop is closed, $\\mathbf{R}_N = \\mathbf{R}_0$, the Hamiltonians are identical, and a deterministic solver will produce identical eigenvectors, $\\lvert n(\\mathbf{R}_N)\\rangle = \\lvert n(\\mathbf{R}_0)\\rangle$, meaning $\\alpha_N = \\alpha_0$. Thus, the phase factor is $1$, and the calculation is valid.\n\nThe algorithm proceeds as follows for each test case:\n1.  Define the path parameters: center $(c_x, c_y)$, semi-axes $(a, b)$, number of steps $N$, and the number of windings $w$.\n2.  Generate a sequence of $N+1$ nuclear geometries $\\{\\mathbf{R}_k\\}_{k=0}^{N}$ that discretize the path. The parameterization is $\\mathbf{R}_k = \\big(c_x + a\\cos(w \\cdot 2\\pi k/N),\\, c_y + b\\sin(w \\cdot 2\\pi k/N)\\big)$.\n3.  For each geometry $\\mathbf{R}_k$, construct the Hamiltonian matrix $H(\\mathbf{R}_k)$.\n4.  Use a numerical eigensolver (e.g., `numpy.linalg.eigh`) to find the eigenvalues and eigenvectors of $H(\\mathbf{R}_k)$. The ground state $\\lvert n(\\mathbf{R}_k)\\rangle$ is the eigenvector corresponding to the minimum eigenvalue. Store all $N+1$ ground states.\n5.  Initialize a complex variable $P=1.0+0.0j$.\n6.  Iterate from $k=0$ to $N-1$, calculating the overlap $s_k = \\left\\langle n(\\mathbf{R}_k)\\,\\middle|\\,n\\!\\left(\\mathbf{R}_{k+1}\\right)\\right\\rangle$ and updating the product $P \\leftarrow P \\times s_k$. The complex-conjugated inner product is essential.\n7.  Finally, compute the geometric phase $\\gamma = \\arg(P)$ using a function that returns the principal value in $(-\\pi, \\pi]$.\nThis procedure is applied to each of the five test cases defined in the problem statement. The results will numerically confirm that loops enclosing the conical intersection at the origin yield $\\gamma \\approx \\pm\\pi$, while those that do not yield $\\gamma \\approx 0$. A loop that winds twice will accumulate a total phase of $2\\pi$, whose principal value is $0$.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef calculate_geometric_phase(path_params):\n    \"\"\"\n    Computes the geometric phase for a given closed loop in the parameter space.\n\n    Args:\n        path_params (tuple): A tuple containing the parameters of the loop:\n            (center_x, center_y, a, b, N, windings)\n            - center_x, center_y: Coordinates of the center of the ellipse.\n            - a, b: Semi-axes of the ellipse.\n            - N: Number of discretization steps.\n            - windings: Number of times the loop is traversed.\n\n    Returns:\n        float: The calculated geometric phase gamma in radians.\n    \"\"\"\n    # Unpack parameters from the input tuple\n    center_x, center_y, a, b, N, windings = path_params\n\n    # 1. Generate the sequence of N+1 nuclear geometries {R_k} for k=0...N\n    # The path is parameterized by theta, which goes from 0 to (windings * 2*pi).\n    # We need N+1 points to ensure the loop closure R_N = R_0 is included for the overlap calculation.\n    k_values = np.arange(N + 1)\n    thetas = windings * 2 * np.pi * k_values / N\n    q_x_coords = center_x + a * np.cos(thetas)\n    q_y_coords = center_y + b * np.sin(thetas)\n\n    # 2. Compute the ground state eigenvector at each point along the path\n    ground_states = []\n    for k in range(N + 1):\n        Qx = q_x_coords[k]\n        Qy = q_y_coords[k]\n        \n        # Build the 2x2 electronic Hamiltonian matrix\n        # H = [[Qy, Qx], [Qx, -Qy]]\n        H = np.array([[Qy, Qx], [Qx, -Qy]], dtype=np.float64)\n        \n        # Solve the eigenvalue problem for the Hermitian matrix H.\n        # np.linalg.eigh returns eigenvalues in ascending order and corresponding\n        # eigenvectors as columns of a matrix.\n        eigenvalues, eigenvectors = np.linalg.eigh(H)\n        \n        # The ground state is the eigenvector corresponding to the lowest eigenvalue.\n        # This will be the first column of the `eigenvectors` matrix.\n        # We convert it to a complex type for subsequent calculations.\n        ground_state = eigenvectors[:, 0].astype(np.complex128)\n        ground_states.append(ground_state)\n        \n    # 3. Compute the overlap product P\n    # P = product_{k=0}^{N-1} <n(R_k)|n(R_{k+1})>\n    P = 1.0 + 0.0j\n    for k in range(N):\n        n_k = ground_states[k]\n        n_k_plus_1 = ground_states[k+1]\n        \n        # Calculate the inner product <n_k|n_{k+1}>.\n        # np.vdot computes the dot product with the conjugate of the first vector.\n        overlap = np.vdot(n_k, n_k_plus_1)\n        P *= overlap\n        \n    # 4. Compute the geometric phase gamma as the argument of P\n    # np.angle returns the angle in the interval (-pi, pi].\n    gamma = np.angle(P)\n    \n    return gamma\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print the results.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (center_x, center_y, a, b, N, windings)\n    # For a circle, a = b = radius.\n    test_cases = [\n        # 1. Circle centered at (0,0) enclosing the origin, one winding.\n        (0.0, 0.0, 1.0, 1.0, 720, 1),\n        # 2. Circle not enclosing the origin.\n        (2.0, 0.0, 1.0, 1.0, 720, 1),\n        # 3. Circle centered at (0,0) with two windings.\n        (0.0, 0.0, 1.0, 1.0, 720, 2),\n        # 4. Small circle centered at (0,0), enclosing the origin.\n        (0.0, 0.0, 1e-3, 1e-3, 2000, 1),\n        # 5. Ellipse enclosing the origin.\n        (0.4, -0.2, 1.0, 0.6, 1000, 1),\n    ]\n\n    results = []\n    for params in test_cases:\n        gamma = calculate_geometric_phase(params)\n        # Round the result to 6 decimal places as required.\n        results.append(round(gamma, 6))\n\n    # Final print statement in the exact required format.\n    # The formatted string must be a single line.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2642870"}]}