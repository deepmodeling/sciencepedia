{"hands_on_practices": [{"introduction": "The Onsager reciprocal relations are not merely a theoretical statement; they furnish powerful, non-trivial predictions that connect seemingly disparate transport phenomena. This first practice grounds the theory in a tangible experimental setting involving electrokinetics in a porous membrane [@problem_id:1996390]. By analyzing measurements from two different experiments—one on electrical conductivity and another on streaming potential—you will use the reciprocity principle, $L_{12} = L_{21}$, to predict the outcome of a third, distinct experiment, showcasing the practical utility of this fundamental symmetry in physical chemistry.", "id": "1996390", "problem": "In a materials science laboratory, a team is characterizing the transport properties of a new porous ceramic membrane designed for water purification. The membrane separates two large reservoirs of a dilute potassium chloride (KCl) solution at a constant temperature. It is observed that applying a pressure difference, $\\Delta P$, or an electric potential difference, $\\Delta \\phi$, across the membrane induces a volume flow of the solution, $J_v$, and an electric current, $I$.\n\nFor small deviations from equilibrium, the coupled flows are described by the linear phenomenological equations:\n$$I = L_{11} \\Delta \\phi + L_{12} \\Delta P$$\n$$J_v = L_{21} \\Delta \\phi + L_{22} \\Delta P$$\nwhere $L_{ij}$ are the phenomenological coefficients that characterize the membrane.\n\nThe team performs two experiments to determine these coefficients:\n\n1.  **Conductivity Measurement:** With no pressure difference applied ($\\Delta P = 0$), a potential difference of $\\Delta \\phi = 50.0 \\text{ mV}$ is established across the membrane, resulting in a measured electric current of $I = 2.50 \\text{ mA}$.\n\n2.  **Streaming Potential Measurement:** The electrical contacts are set to an open circuit condition, which enforces zero net electric current ($I = 0$). A pressure difference of $\\Delta P = 1.20 \\text{ bar}$ is applied across the membrane, which is observed to generate a steady-state potential difference of $\\Delta \\phi = -8.40 \\text{ mV}$. For unit conversion, use $1 \\text{ bar} = 10^5 \\text{ Pa}$.\n\nAssuming the system is well-described by the linear theory of irreversible thermodynamics, predict the outcome of a third experiment. In this third experiment, what is the magnitude of the volume flow, $J_v$, that would be generated if a potential difference of $\\Delta \\phi = 125 \\text{ mV}$ is applied across the membrane while maintaining zero pressure difference?\n\nExpress your answer in cubic centimeters per second ($\\text{cm}^3/\\text{s}$) and round to three significant figures.\n\n", "solution": "For small driving forces, the coupled linear relations are\n$$I = L_{11}\\,\\Delta \\phi + L_{12}\\,\\Delta P,\\qquad J_{v} = L_{21}\\,\\Delta \\phi + L_{22}\\,\\Delta P.$$\n\nFrom experiment 1 with $\\Delta P=0$, we obtain\n$$L_{11}=\\frac{I}{\\Delta \\phi}.$$\nUsing $I=2.50\\times 10^{-3}\\,\\text{A}$ and $\\Delta \\phi=50.0\\times 10^{-3}\\,\\text{V}$,\n$$L_{11}=\\frac{2.50\\times 10^{-3}}{50.0\\times 10^{-3}}=5.00\\times 10^{-2}\\,\\text{A V}^{-1}.$$\n\nFrom experiment 2 with $I=0$, we have\n$$0=L_{11}\\,\\Delta \\phi+L_{12}\\,\\Delta P\\;\\Rightarrow\\;L_{12}=-\\,\\frac{L_{11}\\,\\Delta \\phi}{\\Delta P}.$$\nUsing $\\Delta \\phi=-8.40\\times 10^{-3}\\,\\text{V}$ and $\\Delta P=1.20\\times 10^{5}\\,\\text{Pa}$,\n$$L_{12}=-\\,\\frac{(5.00\\times 10^{-2})(-8.40\\times 10^{-3})}{1.20\\times 10^{5}}=3.50\\times 10^{-9}.$$\n\nAssuming Onsager reciprocity within linear irreversible thermodynamics, $L_{21}=L_{12}$. For the third experiment with $\\Delta P=0$ and $\\Delta \\phi=125\\times 10^{-3}\\,\\text{V}$,\n$$J_{v}=L_{21}\\,\\Delta \\phi=L_{12}\\,\\Delta \\phi=(3.50\\times 10^{-9})(0.125)=4.375\\times 10^{-10}\\,\\text{m}^{3}\\,\\text{s}^{-1}.$$\n\nConverting to cubic centimeters per second using $1\\,\\text{m}^{3}=10^{6}\\,\\text{cm}^{3}$,\n$$J_{v}=(4.375\\times 10^{-10})\\times 10^{6}=4.375\\times 10^{-4}\\,\\text{cm}^{3}\\,\\text{s}^{-1}.$$\n\nRounding to three significant figures gives\n$$J_{v}=4.38\\times 10^{-4}\\,\\text{cm}^{3}\\,\\text{s}^{-1}.$$", "answer": "$$\\boxed{4.38\\times 10^{-4}}$$"}, {"introduction": "Beyond interpreting specific experiments, the framework of irreversible thermodynamics provides profound insights into the design and performance limits of energy-converting systems. This exercise challenges you to analyze a generic linear energy converter, such as a thermoelectric device or a chemiosmotic process [@problem_id:291910]. You will derive a universal expression for the maximum thermodynamic efficiency, $\\eta_{\\text{max}}$, as a function of a single dimensionless parameter, the degree of coupling $q$, revealing the fundamental trade-offs that govern the performance of all such devices.", "id": "291910", "problem": "Consider a system in a non-equilibrium steady state characterized by two coupled irreversible processes. The state of the system can be described by a pair of thermodynamic fluxes, $J_1$ and $J_2$, and their conjugate thermodynamic forces, $X_1$ and $X_2$. In the linear regime, close to equilibrium, the fluxes are related to the forces by the linear phenomenological equations:\n$$\nJ_1 = L_{11} X_1 + L_{12} X_2\n$$\n$$\nJ_2 = L_{21} X_1 + L_{22} X_2\n$$\nThe coefficients $L_{ij}$ are the phenomenological or transport coefficients. According to Onsager's reciprocal relations, the matrix of these coefficients is symmetric, i.e., $L_{12} = L_{21}$. The second law of thermodynamics imposes constraints on these coefficients, namely $L_{11} > 0$, $L_{22} > 0$, and $L_{11}L_{22} - L_{12}^2 \\ge 0$.\n\nThis system can operate as an energy converter, where one process (the input) drives the other process (the output). The power input is given by $P_{in} = J_1 X_1$ and the power output is $P_{out} = -J_2 X_2$. For the device to function as a converter, both $P_{in}$ and $P_{out}$ must be positive. The efficiency of this energy conversion is defined as $\\eta = P_{out} / P_{in}$.\n\nA key parameter characterizing the coupling between the two processes is the degree of coupling, $q$, defined as:\n$$\nq = \\frac{L_{12}}{\\sqrt{L_{11}L_{22}}}\n$$\nThe constraint from the second law implies that $|q| \\le 1$.\n\nYour task is to derive an expression for the maximum possible thermodynamic efficiency, $\\eta_{max}$, of this linear energy converter. The final expression must be solely a function of the degree of coupling, $q$. The maximization should be performed by varying the ratio of the thermodynamic forces, which represents changing the operating conditions of the converter (e.g., changing the load).\n\n", "solution": "The efficiency $\\eta$ of the energy converter is given by the ratio of the output power to the input power:\n$$\n\\eta = \\frac{P_{out}}{P_{in}} = \\frac{-J_2 X_2}{J_1 X_1}\n$$\nSubstituting the linear phenomenological equations for $J_1$ and $J_2$:\n$$\n\\eta = \\frac{-(L_{12} X_1 + L_{22} X_2) X_2}{(L_{11} X_1 + L_{12} X_2) X_1}\n$$\nThe efficiency depends on the ratio of the thermodynamic forces. Let's define this ratio as $x = X_2/X_1$. We can divide the numerator and the denominator by $X_1^2$ to express $\\eta$ as a function of $x$:\n$$\n\\eta(x) = \\frac{-(L_{12} x + L_{22} x^2)}{L_{11} + L_{12} x}\n$$\nTo simplify this expression, we introduce the degree of coupling $q = L_{12} / \\sqrt{L_{11}L_{22}}$. We can rewrite the $L_{ij}$ coefficients in terms of $q$, $L_{11}$, and $L_{22}$:\n$L_{12} = q \\sqrt{L_{11}L_{22}}$.\nSo,\n$$\n\\eta(x) = \\frac{-(q \\sqrt{L_{11}L_{22}} x + L_{22} x^2)}{L_{11} + q \\sqrt{L_{11}L_{22}} x}\n$$\nTo further simplify, let's normalize the variable $x$. Let $y = x\\sqrt{L_{22}/L_{11}}$, so that $x = y\\sqrt{L_{11}/L_{22}}$. Substituting this into the expression for $\\eta$:\n$$\n\\eta(y) = \\frac{-\\left(q \\sqrt{L_{11}L_{22}} \\left(y\\sqrt{\\frac{L_{11}}{L_{22}}}\\right) + L_{22} \\left(y\\sqrt{\\frac{L_{11}}{L_{22}}}\\right)^2\\right)}{L_{11} + q \\sqrt{L_{11}L_{22}} \\left(y\\sqrt{\\frac{L_{11}}{L_{22}}}\\right)}\n$$\n$$\n\\eta(y) = \\frac{-(q L_{11} y + L_{22} y^2 \\frac{L_{11}}{L_{22}})}{L_{11} + q L_{11} y} = \\frac{-L_{11}(qy + y^2)}{L_{11}(1+qy)} = \\frac{-y^2 - qy}{1+qy}\n$$\nThis simplified expression for efficiency, $\\eta(y)$, needs to be maximized with respect to the variable $y$, which represents the operating conditions of the converter. We find the maximum by taking the derivative of $\\eta$ with respect to $y$ and setting it to zero:\n$$\n\\frac{d\\eta}{dy} = \\frac{d}{dy} \\left( \\frac{-y^2 - qy}{1+qy} \\right) = 0\n$$\nUsing the quotient rule for differentiation, $[f(y)/g(y)]' = [f'(y)g(y) - f(y)g'(y)] / g(y)^2$:\n$$\n\\frac{d\\eta}{dy} = \\frac{(-2y - q)(1+qy) - (-y^2 - qy)(q)}{(1+qy)^2} = 0\n$$\nFor the derivative to be zero, the numerator must be zero:\n$$\n(-2y - q)(1+qy) - (-y^2 - qy)(q) = 0\n$$\n$$\n-2y - 2qy^2 - q - q^2y + qy^2 + q^2y = 0\n$$\n$$\n-qy^2 - 2y - q = 0\n$$\n$$\nqy^2 + 2y + q = 0\n$$\nThis is a quadratic equation for the optimal value of $y$. We solve for $y$ using the quadratic formula:\n$$\ny = \\frac{-2 \\pm \\sqrt{2^2 - 4(q)(q)}}{2q} = \\frac{-2 \\pm \\sqrt{4(1-q^2)}}{2q} = \\frac{-1 \\pm \\sqrt{1-q^2}}{q}\n$$\nWe have two possible solutions for the optimal $y$. We must choose the one that corresponds to the physical operation of an energy converter. The input power $P_{in} = J_1 X_1$ must be positive.\n$$\nP_{in} = L_{11}X_1^2 + L_{12}X_1X_2 = L_{11}X_1^2 (1 + \\frac{L_{12}}{L_{11}}\\frac{X_2}{X_1}) = L_{11}X_1^2 (1 + qy)\n$$\nSince $L_{11}>0$ and $X_1^2 > 0$, we must have $1+qy > 0$. Let's check the two roots for $y$:\n1. $y = \\frac{-1 + \\sqrt{1-q^2}}{q} \\implies 1+qy = 1+q\\left(\\frac{-1 + \\sqrt{1-q^2}}{q}\\right) = 1-1+\\sqrt{1-q^2} = \\sqrt{1-q^2}$. Since $|q|<1$, $\\sqrt{1-q^2} > 0$. This root is physically valid.\n2. $y = \\frac{-1 - \\sqrt{1-q^2}}{q} \\implies 1+qy = 1+q\\left(\\frac{-1 - \\sqrt{1-q^2}}{q}\\right) = 1-1-\\sqrt{1-q^2} = -\\sqrt{1-q^2}$. This would make $P_{in}<0$, which describes a refrigerator or heat pump, not a power generator. So we discard this root.\n\nThe optimal condition is thus $y_{opt} = \\frac{-1 + \\sqrt{1-q^2}}{q}$. We substitute this back into the expression for $\\eta(y)$ to find the maximum efficiency $\\eta_{max}$:\n$$\n\\eta_{max} = \\frac{-y_{opt}^2 - qy_{opt}}{1+qy_{opt}}\n$$\nWe can use the condition $qy^2+2y+q=0$, which at the optimum gives $-qy^2 = 2y+q$.\nNumerator: $-y^2 - qy = \\frac{2y+q}{q} - qy = \\frac{2y+q-q^2y}{q} = \\frac{y(2-q^2)+q}{q}$.\nThis path is cumbersome. It's simpler to substitute $y_{opt}$ directly.\nLet's simplify the numerator differently: $-y(y+q)$.\n$y_{opt} = \\frac{-1+\\sqrt{1-q^2}}{q}$\n$1+qy_{opt} = \\sqrt{1-q^2}$\n$y_{opt}+q = \\frac{-1+\\sqrt{1-q^2}}{q} + q = \\frac{-1+\\sqrt{1-q^2}+q^2}{q} = \\frac{-(1-q^2)+\\sqrt{1-q^2}}{q} = \\frac{\\sqrt{1-q^2}(1-\\sqrt{1-q^2})}{q}$\nNow, substitute these into the efficiency formula:\n$$\n\\eta_{max} = \\frac{-y_{opt}(y_{opt}+q)}{1+qy_{opt}} = \\frac{-\\left(\\frac{-1+\\sqrt{1-q^2}}{q}\\right)\\left(\\frac{\\sqrt{1-q^2}(1-\\sqrt{1-q^2})}{q}\\right)}{\\sqrt{1-q^2}}\n$$\n$$\n\\eta_{max} = \\frac{-\\left(-\\frac{1-\\sqrt{1-q^2}}{q}\\right)\\left(\\frac{\\sqrt{1-q^2}(1-\\sqrt{1-q^2})}{q}\\right)}{\\sqrt{1-q^2}}\n$$\nThe term $\\sqrt{1-q^2}$ cancels out from the numerator and denominator:\n$$\n\\eta_{max} = \\frac{\\left(\\frac{1-\\sqrt{1-q^2}}{q}\\right)\\left(\\frac{1-\\sqrt{1-q^2}}{q}\\right)}{1} = \\left(\\frac{1-\\sqrt{1-q^2}}{q}\\right)^2\n$$\nSo the final expression for the maximum efficiency is:\n$$\n\\eta_{max} = \\frac{(1-\\sqrt{1-q^2})^2}{q^2}\n$$", "answer": "$$\n\\boxed{\\frac{\\left(1-\\sqrt{1-q^2}\\right)^2}{q^2}}\n$$"}, {"introduction": "The ultimate justification for the Onsager relations lies in the time-reversal symmetry of microscopic dynamics. This advanced practice bridges the gap between the macroscopic phenomenological theory and its microscopic foundations using the tools of statistical mechanics and computation [@problem_id:2656783]. Working with surrogate molecular dynamics data, you will implement the Green-Kubo relations to calculate transport coefficients and perform a rigorous statistical test to verify that the reciprocity $L_{12} = L_{21}$ holds, demonstrating how macroscopic symmetries emerge from the underlying molecular world.", "id": "2656783", "problem": "You are given a verification task for the Onsager reciprocal relations in a simple equilibrium model of a Lennard–Jones fluid, using surrogate molecular dynamics (MD) correlation data that are reproducible by construction. The verification must be performed from first principles of microscopic reversibility and Green–Kubo theory, formulated in a discrete-time computation that provides a quantitative statistical test of reciprocity.\n\nFoundational base and modeling assumptions:\n- Microscopic reversibility implies that for fluxes of the same time-reversal parity in equilibrium, the cross-correlation functions satisfy a symmetry that yields the Onsager reciprocal relations.\n- The transport matrix elements are defined by Green–Kubo time integrals of equilibrium flux cross-correlation functions. If the two fluxes share the same time-reversal parity, reciprocity requires that the corresponding transport coefficients satisfy $L_{ij}=L_{ji}$.\n- You are provided with discrete surrogate MD correlation data for two fluxes $J_{1}$ and $J_{2}$ that share the same parity. The discrete time step is $\\Delta t$, and you will work with $B$ independent blocks (independent MD segments), each providing $N$ time samples. To mimic finite-sampling variability in a deterministic, reproducible way, each block is assigned a distinct phase.\n\nDefinitions (to be used as the starting point for your derivation and computation):\n- Let $t_{n}=n\\,\\Delta t$ for $n\\in\\{0,1,\\dots,N-1\\}$.\n- Define a baseline equilibrium cross-correlation template\n$$\nS(t)\\;=\\;A\\,e^{-t/\\tau}\\cos(\\omega t),\n$$\nwith $A>0$, $\\tau>0$, and angular frequency $\\omega>0$ (angles in radians).\n- Define a deterministic, block-phased, decaying oscillatory perturbation\n$$\ns_{n}\\;=\\;e^{-n/N_{\\text{decay}}}\\,\\sin(\\kappa n),\n$$\nwith $N_{\\text{decay}}>0$ and frequency parameter $\\kappa>0$ (in radians per discrete step).\n- For block index $b\\in\\{0,1,\\dots,B-1\\}$ define the phase $\\theta_{b}=2\\pi b/B$ and let $\\phi$ be a fixed phase offset (in radians). The two cross-correlation functions per block are specified by\n$$\nC_{12}^{(b)}(t_{n})\\;=\\;S(t_{n})\\;+\\;\\eta\\,s_{n}\\,\\sin(\\theta_{b}),\n$$\n$$\nC_{21}^{(b)}(t_{n})\\;=\\;(1+\\delta)\\,S(t_{n})\\;+\\;\\eta\\,s_{n}\\,\\sin(\\theta_{b}+\\phi)\\;+\\;\\mu,\n$$\nwhere $\\eta$ controls the perturbation amplitude, $\\delta$ controls a systematic reciprocity-violating scaling, and $\\mu$ controls a constant bias (all dimensionless). Angles are in radians. For the Lennard–Jones fluid in equilibrium without external fields, the physically relevant case is $\\delta=0$ and $\\mu=0$, but $\\delta$ and $\\mu$ are included to test your method’s sensitivity.\n\nDiscrete Green–Kubo estimator and statistical test to implement:\n- Given an integration cutoff index $N_{c}$ with $0<N_{c}\\le N-1$, define the discrete trapezoidal estimator for the transport coefficient in block $b$ as\n$$\n\\widehat{L}_{ij}^{(b)}\\;=\\;\\Delta t\\,\\Big[\\tfrac{1}{2}\\,C_{ij}^{(b)}(t_{0})\\;+\\;\\sum_{n=1}^{N_{c}-1}C_{ij}^{(b)}(t_{n})\\;+\\;\\tfrac{1}{2}\\,C_{ij}^{(b)}(t_{N_{c}})\\Big].\n$$\n- Form the within-block differences\n$$\nd^{(b)}\\;=\\;\\widehat{L}_{12}^{(b)}\\;-\\;\\widehat{L}_{21}^{(b)}.\n$$\n- Compute the sample mean\n$$\n\\overline{d}\\;=\\;\\frac{1}{B}\\sum_{b=0}^{B-1}d^{(b)},\n$$\nand the unbiased sample standard deviation\n$$\ns_{d}\\;=\\;\\sqrt{\\frac{1}{B-1}\\sum_{b=0}^{B-1}\\Big(d^{(b)}-\\overline{d}\\Big)^{2}},\n$$\nwith the standard error of the mean\n$$\n\\mathrm{SE}\\;=\\;\\frac{s_{d}}{\\sqrt{B}}.\n$$\n- For a two-sided significance level $\\alpha$, compute the Gaussian critical value $z_{1-\\alpha/2}$ and accept Onsager reciprocity if and only if\n$$\n\\left|\\overline{d}\\right|\\;\\le\\;z_{1-\\alpha/2}\\,\\mathrm{SE}.\n$$\n- If $s_{d}=0$ exactly, accept if and only if $\\left|\\overline{d}\\right|$ is no greater than an absolute tolerance $\\varepsilon$ (use $\\varepsilon=10^{-12}$), which guards against floating-point roundoff.\n\nYour task: Implement a program that constructs the surrogate MD correlation data exactly as above for each test case, computes the discrete Green–Kubo estimates per block, performs the paired-difference statistical test, and returns a boolean per test case indicating whether reciprocity is verified at the specified significance.\n\nAngle unit: radians. No physical units are required for any output; report dimensionless booleans.\n\nTest suite (each test case specifies all parameters):\n- Test $1$ (happy path, exact reciprocity with structured variability): $B=8$, $\\Delta t=0.002$, $N=1800$, $N_{c}=1200$, $\\alpha=0.05$, $A=1.0$, $\\tau=0.3$, $\\omega=6.0$, $\\eta=0.02$, $\\kappa=0.35$, $N_{\\text{decay}}=600$, $\\phi=\\pi/2$, $\\delta=0.0$, $\\mu=0.0$.\n- Test $2$ (stricter significance, tiny constant bias): $B=8$, $\\Delta t=0.002$, $N=1800$, $N_{c}=1200$, $\\alpha=0.01$, $A=1.0$, $\\tau=0.3$, $\\omega=6.0$, $\\eta=0.02$, $\\kappa=0.35$, $N_{\\text{decay}}=600$, $\\phi=\\pi/2$, $\\delta=0.0$, $\\mu=0.000001$.\n- Test $3$ (reciprocity violation through systematic scaling): $B=12$, $\\Delta t=0.002$, $N=2000$, $N_{c}=1400$, $\\alpha=0.05$, $A=1.0$, $\\tau=0.3$, $\\omega=6.0$, $\\eta=0.01$, $\\kappa=0.35$, $N_{\\text{decay}}=600$, $\\phi=\\pi/2$, $\\delta=0.3$, $\\mu=0.0$.\n- Test $4$ (edge case with fewer blocks, different template): $B=4$, $\\Delta t=0.003$, $N=1600$, $N_{c}=900$, $\\alpha=0.05$, $A=0.8$, $\\tau=0.4$, $\\omega=5.0$, $\\eta=0.025$, $\\kappa=0.42$, $N_{\\text{decay}}=500$, $\\phi=\\pi/3$, $\\delta=0.0$, $\\mu=0.0$.\n\nFinal output format: Your program should produce a single line of output containing the results as a comma-separated Python-style list of booleans in the order of the tests, for example, \"[True,False,True,True]\".", "solution": "The problem statement is valid. It presents a well-posed, scientifically grounded computational task within the domain of physical chemistry and statistical mechanics. All definitions, parameters, and procedures are specified with sufficient clarity and precision to permit a unique, verifiable solution. The problem requires the implementation of a statistical test for Onsager's reciprocal relations using synthetically generated molecular dynamics data, a standard approach for validating numerical methods in computational physics.\n\nThe task is to verify Onsager reciprocity, $L_{12} = L_{21}$, for a pair of transport processes. The transport coefficients, $L_{ij}$, are related to time-integrals of equilibrium flux-flux time correlation functions, $C_{ij}(t) = \\langle J_i(0) J_j(t) \\rangle$, via the Green-Kubo relations. The verification will be performed on surrogate correlation data that are generated according to a deterministic model, which includes terms that represent physical behavior, statistical noise, and potential systematic violations of reciprocity.\n\nThe solution proceeds by implementing the specified computational and statistical procedure for each of a series of test cases.\n\nFirst, we generate the necessary data for the calculation. For each test case, we are given a set of parameters: number of blocks $B$, time step $\\Delta t$, number of samples per block $N$, integration cutoff index $N_c$, significance level $\\alpha$, and parameters defining the correlation functions ($A$, $\\tau$, $\\omega$, $\\eta$, $\\kappa$, $N_{\\text{decay}}$, $\\phi$, $\\delta$, $\\mu$).\n\nThe discrete time points are $t_n = n\\Delta t$ for $n \\in \\{0, 1, \\dots, N_c\\}$. We first compute the baseline correlation template $S(t_n)$ and the deterministic perturbation function $s_n$ over this range of time indices:\n$$S(t_n) = A e^{-t_n/\\tau} \\cos(\\omega t_n)$$\n$$s_n = e^{-n/N_{\\text{decay}}} \\sin(\\kappa n)$$\n\nNext, for each independent block $b \\in \\{0, 1, \\dots, B-1\\}$, we construct the two cross-correlation functions, $C_{12}^{(b)}(t_n)$ and $C_{21}^{(b)}(t_n)$. A block-specific phase $\\theta_b = 2\\pi b / B$ is introduced to create controlled variability between blocks.\n$$C_{12}^{(b)}(t_n) = S(t_n) + \\eta s_n \\sin(\\theta_b)$$\n$$C_{21}^{(b)}(t_n) = (1+\\delta)S(t_n) + \\eta s_n \\sin(\\theta_b+\\phi) + \\mu$$\nHere, $\\delta$ and $\\mu$ are parameters that introduce systematic violations of reciprocity ($L_{12} \\neq L_{21}$), while the term with $\\eta$ introduces structured, block-dependent noise designed to average to zero over a sufficient number of blocks.\n\nThe second step is to estimate the transport coefficients for each block using the discrete Green-Kubo formula. The integral of the correlation function is approximated using the trapezoidal rule up to the cutoff time $t_{N_c}$:\n$$\\widehat{L}_{ij}^{(b)} = \\Delta t \\left[ \\frac{1}{2}C_{ij}^{(b)}(t_0) + \\sum_{n=1}^{N_c-1} C_{ij}^{(b)}(t_n) + \\frac{1}{2}C_{ij}^{(b)}(t_{N_c}) \\right]$$\nThis calculation is performed for both $\\widehat{L}_{12}^{(b)}$ and $\\widehat{L}_{21}^{(b)}$.\n\nThe third step is the statistical analysis of the difference between the estimated coefficients. For each block, we compute the paired difference:\n$$d^{(b)} = \\widehat{L}_{12}^{(b)} - \\widehat{L}_{21}^{(b)}$$\nIf reciprocity holds perfectly and is unaffected by noise, we expect $d^{(b)} = 0$. In practice, we analyze the distribution of these differences across the $B$ blocks. We compute the sample mean $\\overline{d}$ and the unbiased sample standard deviation $s_d$ of the set $\\{d^{(b)}\\}_{b=0}^{B-1}$:\n$$\\overline{d} = \\frac{1}{B}\\sum_{b=0}^{B-1} d^{(b)}$$\n$$s_d = \\sqrt{\\frac{1}{B-1}\\sum_{b=0}^{B-1} (d^{(b)} - \\overline{d})^2}$$\nFrom these, we calculate the standard error of the mean, $\\mathrm{SE} = s_d / \\sqrt{B}$, which quantifies the statistical uncertainty in our estimate of the mean difference.\n\nFinally, we perform a hypothesis test to decide whether the observed mean difference $\\overline{d}$ is statistically consistent with zero. The null hypothesis is that Onsager reciprocity holds, meaning the true mean of the differences is zero. We compare the absolute value of the sample mean, $|\\overline{d}|$, to a critical value determined by the standard error and the chosen significance level $\\alpha$. Using a two-sided test based on a Gaussian distribution, the critical value is $z_{1-\\alpha/2}$, the $(1-\\alpha/2)$ quantile of the standard normal distribution. We accept reciprocity if the sample mean is within the confidence interval around zero:\n$$|\\overline{d}| \\le z_{1-\\alpha/2} \\cdot \\mathrm{SE}$$\nA special case is handled if $s_d = 0$, which implies all $d^{(b)}$ are identical. In this scenario, we accept reciprocity if and only if $|\\overline{d}|$ is smaller than a small numerical tolerance, $\\varepsilon = 10^{-12}$, to account for potential floating-point artifacts.\n\nThis entire procedure is encapsulated in a Python program that processes each test case and returns a boolean value indicating the outcome of the test.", "answer": "```python\nimport numpy as np\nfrom scipy.stats import norm\n\ndef solve():\n    \"\"\"\n    Solves the problem by running the specified test cases for Onsager reciprocity.\n    \"\"\"\n\n    test_cases = [\n        # Test 1: Happy path, exact reciprocity with structured variability\n        dict(B=8, dt=0.002, N=1800, Nc=1200, alpha=0.05, A=1.0, tau=0.3, \n             omega=6.0, eta=0.02, kappa=0.35, N_decay=600, phi=np.pi/2, \n             delta=0.0, mu=0.0),\n        # Test 2: Stricter significance, tiny constant bias\n        dict(B=8, dt=0.002, N=1800, Nc=1200, alpha=0.01, A=1.0, tau=0.3,\n             omega=6.0, eta=0.02, kappa=0.35, N_decay=600, phi=np.pi/2,\n             delta=0.0, mu=0.000001),\n        # Test 3: Reciprocity violation through systematic scaling\n        dict(B=12, dt=0.002, N=2000, Nc=1400, alpha=0.05, A=1.0, tau=0.3,\n             omega=6.0, eta=0.01, kappa=0.35, N_decay=600, phi=np.pi/2,\n             delta=0.3, mu=0.0),\n        # Test 4: Edge case with fewer blocks, different template\n        dict(B=4, dt=0.003, N=1600, Nc=900, alpha=0.05, A=0.8, tau=0.4,\n             omega=5.0, eta=0.025, kappa=0.42, N_decay=500, phi=np.pi/3,\n             delta=0.0, mu=0.0),\n    ]\n\n    results = []\n    for case in test_cases:\n        result = run_verification_test(**case)\n        results.append(result)\n\n    print(f\"[{','.join(map(str, results))}]\")\n\ndef run_verification_test(B, dt, N, Nc, alpha, A, tau, omega, eta, kappa, \n                          N_decay, phi, delta, mu, epsilon=1e-12):\n    \"\"\"\n    Performs the Onsager reciprocity verification for a single test case.\n\n    Args:\n        B (int): Number of independent blocks.\n        dt (float): Discrete time step.\n        N (int): Number of time samples per block.\n        Nc (int): Integration cutoff index.\n        alpha (float): Significance level for the two-sided test.\n        A (float): Amplitude of the baseline correlation template.\n        tau (float): Decay time of the baseline correlation template.\n        omega (float): Angular frequency of the baseline correlation template.\n        eta (float): Amplitude of the perturbation.\n        kappa (float): Frequency parameter of the perturbation.\n        N_decay (float): Decay steps for the perturbation.\n        phi (float): Phase offset for the perturbation in C21.\n        delta (float): Systematic reciprocity-violating scaling factor.\n        mu (float): Constant bias violating reciprocity.\n        epsilon (float): Absolute tolerance for the case when standard deviation is zero.\n\n    Returns:\n        bool: True if reciprocity is accepted, False otherwise.\n    \"\"\"\n    \n    # 1. Generate baseline data independent of block\n    n_vals = np.arange(Nc + 1)\n    t_vals = n_vals * dt\n    \n    S_t = A * np.exp(-t_vals / tau) * np.cos(omega * t_vals)\n    s_n = np.exp(-n_vals / N_decay) * np.sin(kappa * n_vals)\n\n    # 2. Loop over blocks to compute differences d_b\n    d_values = []\n    for b in range(B):\n        theta_b = 2.0 * np.pi * b / B\n        \n        # Construct correlation functions for the current block\n        C12_b = S_t + eta * s_n * np.sin(theta_b)\n        C21_b = (1.0 + delta) * S_t + eta * s_n * np.sin(theta_b + phi) + mu\n        \n        # Compute discrete Green-Kubo estimators using trapezoidal rule\n        # np.trapz(y, dx=h) implements the formula exactly\n        L12_b_hat = np.trapz(C12_b, dx=dt)\n        L21_b_hat = np.trapz(C21_b, dx=dt)\n        \n        # Form the within-block difference\n        d_b = L12_b_hat - L21_b_hat\n        d_values.append(d_b)\n    \n    d_values = np.array(d_values)\n    \n    # 3. Perform the statistical test\n    # This check is necessary as B=1 would lead to division by zero in std.\n    # The problem constraints imply B > 1.\n    if B <= 1:\n        # Undefined for B=1, but for robustness\n        return np.abs(d_values[0]) <= epsilon\n        \n    d_mean = np.mean(d_values)\n    d_std = np.std(d_values, ddof=1) # Unbiased sample standard deviation\n\n    if d_std == 0.0:\n        return np.abs(d_mean) <= epsilon\n    \n    # Standard error of the mean\n    SE = d_std / np.sqrt(B)\n    \n    # Gaussian critical value for two-sided test\n    z_critical = norm.ppf(1.0 - alpha / 2.0)\n    \n    # Accept reciprocity if the mean difference is not statistically significant\n    is_reciprocity_verified = np.abs(d_mean) <= z_critical * SE\n\n    return is_reciprocity_verified\n\nsolve()\n```"}]}