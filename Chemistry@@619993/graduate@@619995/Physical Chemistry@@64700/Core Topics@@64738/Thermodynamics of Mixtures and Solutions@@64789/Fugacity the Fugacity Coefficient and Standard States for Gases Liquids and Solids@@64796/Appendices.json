{"hands_on_practices": [{"introduction": "This first practice lays the theoretical groundwork for describing non-ideal gases by connecting macroscopic properties to an equation of state. You will derive the analytical expression for the fugacity coefficient, $\\phi$, directly from the Peng-Robinson equation of state, a powerful model widely used in engineering and science [@problem_id:2642544]. This exercise is fundamental for understanding how intermolecular forces, encapsulated within the equation's parameters, cause a real gas's effective pressure, or fugacity, to deviate from its measured pressure.", "problem": "A pure fluid is described by the Peng–Robinson (PR) cubic equation of state. You are asked to derive the fugacity coefficient from first principles. Use only thermodynamic definitions and the explicit form of the equation of state; do not invoke any pre-tabulated fugacity-coefficient expressions.\n\nThe Peng–Robinson (PR) equation of state is\n$$\nP \\;=\\; \\frac{R T}{v - b} \\;-\\; \\frac{a \\,\\alpha(T)}{v^2 + 2 b v - b^2},\n$$\nwhere $P$ is the pressure, $T$ is the temperature, $v$ is the molar volume, and $R$ is the universal gas constant. The parameters $a$ and $b$ are given in terms of the critical constants $T_c$ and $P_c$ by\n$$\na \\;=\\; 0.45724\\,\\frac{R^2 T_c^2}{P_c}, \\qquad b \\;=\\; 0.07780\\,\\frac{R T_c}{P_c},\n$$\nand the temperature-dependent factor is\n$$\n\\alpha(T) \\;=\\; \\left[ 1 + \\kappa \\left( 1 - \\sqrt{T_r} \\right) \\right]^2, \\qquad T_r \\;=\\; \\frac{T}{T_c}, \\qquad \\kappa \\;=\\; 0.37464 + 1.54226\\,\\omega - 0.26992\\,\\omega^2,\n$$\nwith $\\omega$ the Pitzer acentric factor. Let the gas standard state be the ideal gas at the same temperature and pressure, so that the fugacity $f$ satisfies $\\,\\mu(T,P)-\\mu^{\\mathrm{ig}}(T,P)=R T \\ln\\!\\left(\\frac{f}{P}\\right)\\,$, and define the fugacity coefficient $\\phi$ by $\\,f=\\phi P\\,$.\n\nStarting from the identities $\\,d\\mu = \\bar{V}\\,dP\\,$ and $\\,d\\mu^{\\mathrm{ig}} = R T\\,d\\ln P\\,$ at fixed $T$, and using only the PR equation of state, derive a closed-form analytical expression for the fugacity coefficient $\\phi$ of the pure fluid in terms of the compressibility factor $Z \\equiv \\dfrac{P v}{R T}$ and the reduced parameters\n$$\nA \\;\\equiv\\; \\frac{a\\,\\alpha(T)\\,P}{R^2 T^2}, \\qquad B \\;\\equiv\\; \\frac{b\\,P}{R T}.\n$$\nYour final answer must be a single, simplified expression for $\\ln \\phi$ written solely in terms of $Z$, $A$, and $B$ and numerical constants. Express the final result as an exact analytic expression. Do not provide any intermediate steps or additional commentary in the final answer.", "solution": "The problem as stated is a valid exercise in chemical thermodynamics. It is well-posed, scientifically grounded, and contains all necessary information to derive the requested expression. We shall proceed with the derivation from first principles.\n\nThe fugacity coefficient $\\phi$ is defined through the chemical potential $\\mu$. For a pure substance, the chemical potential is identical to the molar Gibbs free energy, $\\mu = G/n$. The relationship between the fugacity $f$ of a real fluid at a given temperature $T$ and pressure $P$, and its chemical potential is given by its difference from an ideal gas (ig) in the same state:\n$$ \\mu(T,P) - \\mu^{\\mathrm{ig}}(T,P) = R T \\ln \\left( \\frac{f}{P} \\right) $$\nBy definition, $f = \\phi P$, so the left-hand side is equal to $R T \\ln \\phi$. The term $\\mu(T,P) - \\mu^{\\mathrm{ig}}(T,P)$ is the molar residual Gibbs free energy, denoted $\\mu^R$ or $G_m^R$.\n$$ \\ln \\phi = \\frac{\\mu^R}{R T} $$\nThe residual Gibbs energy $G^R$ is related to the residual Helmholtz energy $A^R$ by the fundamental thermodynamic relation $G=A+PV$. For one mole:\n$$ \\mu^R(T,P) = \\mu(T,P) - \\mu^{\\mathrm{ig}}(T,P) = (A(T,v) + Pv) - (A^{\\mathrm{ig}}(T,v^{\\mathrm{ig}}) + Pv^{\\mathrm{ig}}) $$\nwhere $v$ is the molar volume of the real fluid and $v^{\\mathrm{ig}} = RT/P$ is the molar volume of the ideal gas, both at $(T, P)$.\nWe can write this as:\n$$ \\mu^R = (A(T,v) - A^{\\mathrm{ig}}(T,v)) + (A^{\\mathrm{ig}}(T,v) - A^{\\mathrm{ig}}(T,v^{\\mathrm{ig}})) + P(v - v^{\\mathrm{ig}}) $$\nThe first term is the residual Helmholtz energy at constant temperature and volume, $A^R(T,v)$. The second term, for an ideal gas, is $A^{\\mathrm{ig}}(T,v) - A^{\\mathrm{ig}}(T,v^{\\mathrm{ig}}) = -\\int_{v^{\\mathrm{ig}}}^v P^{\\mathrm{ig}}dv' = -\\int_{v^{\\mathrm{ig}}}^v \\frac{RT}{v'}dv' = -RT\\ln(v/v^{\\mathrm{ig}})$. The third term is $P(v - RT/P) = Pv - RT$.\nRecognizing that the compressibility factor is $Z = Pv/RT$, we have $v/v^{\\mathrm{ig}} = (Pv/RT) / (Pv^{\\mathrm{ig}}/RT) = Z / 1 = Z$.\nSubstituting these relations gives:\n$$ \\mu^R = A^R(T,v) - RT\\ln(Z) + (Pv - RT) = A^R(T,v) - RT\\ln(Z) + RT(Z-1) $$\nDividing by $RT$:\n$$ \\ln \\phi = \\frac{A^R(T,v)}{RT} + Z - 1 - \\ln Z $$\nThe residual Helmholtz energy is defined by the integral:\n$$ A^R(T,v) = A(T,v) - A^{\\mathrm{ig}}(T,v) = - \\int_{\\infty}^{v} \\left( P - \\frac{RT}{v'} \\right) dv' = \\int_{v}^{\\infty} \\left( P - \\frac{RT}{v'} \\right) dv' $$\nCombining these gives the master equation for our derivation:\n$$ \\ln \\phi = \\frac{1}{RT} \\int_{v}^{\\infty} \\left( P(v') - \\frac{RT}{v'} \\right) dv' + Z - 1 - \\ln Z $$\nNow, we substitute the Peng–Robinson (PR) equation of state into the integral:\n$$ P(v') = \\frac{RT}{v' - b} - \\frac{a \\alpha(T)}{v'^2 + 2bv' - b^2} $$\nThe integrand becomes:\n$$ P(v') - \\frac{RT}{v'} = \\left(\\frac{RT}{v' - b} - \\frac{RT}{v'}\\right) - \\frac{a \\alpha}{v'^2 + 2bv' - b^2} $$\nThe integral thus splits into two parts:\n$$ I = \\int_{v}^{\\infty} \\left( \\frac{RT}{v' - b} - \\frac{RT}{v'} \\right) dv' - \\int_{v}^{\\infty} \\frac{a \\alpha}{v'^2 + 2bv' - b^2} dv' $$\nLet's evaluate the first part, $I_1$:\n$$ I_1 = RT \\int_{v}^{\\infty} \\left( \\frac{1}{v' - b} - \\frac{1}{v'} \\right) dv' = RT \\left[ \\ln(v' - b) - \\ln(v') \\right]_{v}^{\\infty} $$\n$$ I_1 = RT \\left[ \\ln\\left(\\frac{v' - b}{v'}\\right) \\right]_{v}^{\\infty} = RT \\left[ \\ln\\left(1 - \\frac{b}{v'}\\right) \\right]_{v}^{\\infty} $$\nAs $v' \\to \\infty$, the logarithm term goes to $\\ln(1) = 0$. So,\n$$ I_1 = RT \\left( 0 - \\ln\\left(1 - \\frac{b}{v}\\right) \\right) = -RT \\ln\\left(\\frac{v-b}{v}\\right) = RT \\ln\\left(\\frac{v}{v-b}\\right) $$\nNow, for the second part, $I_2$. We first factor the denominator of the integrand: $v'^2 + 2bv' - b^2 = 0$ has roots $v' = -b \\pm b\\sqrt{2}$. Thus, the denominator is $(v' - (-b+b\\sqrt{2}))(v' - (-b-b\\sqrt{2})) = (v' + b(1-\\sqrt{2}))(v' + b(1+\\sqrt{2}))$.\nWe use partial fraction decomposition:\n$$ \\frac{1}{v'^2 + 2bv' - b^2} = \\frac{1}{2b\\sqrt{2}} \\left( \\frac{1}{v' + b(1-\\sqrt{2})} - \\frac{1}{v' + b(1+\\sqrt{2})} \\right) $$\nSo the integral $I_2$ is:\n$$ I_2 = - a \\alpha \\int_{v}^{\\infty} \\frac{1}{v'^2 + 2bv' - b^2} dv' = - \\frac{a \\alpha}{2b\\sqrt{2}} \\int_{v}^{\\infty} \\left( \\frac{1}{v' + b(1-\\sqrt{2})} - \\frac{1}{v' + b(1+\\sqrt{2})} \\right) dv' $$\n$$ I_2 = - \\frac{a \\alpha}{2b\\sqrt{2}} \\left[ \\ln(v' + b(1-\\sqrt{2})) - \\ln(v' + b(1+\\sqrt{2})) \\right]_{v}^{\\infty} $$\n$$ I_2 = - \\frac{a \\alpha}{2b\\sqrt{2}} \\left[ \\ln\\left( \\frac{v' + b(1-\\sqrt{2})}{v' + b(1+\\sqrt{2})} \\right) \\right]_{v}^{\\infty} $$\nAs $v' \\to \\infty$, the logarithm argument approaches $1$, so the term is $\\ln(1)=0$.\n$$ I_2 = - \\frac{a \\alpha}{2b\\sqrt{2}} \\left( 0 - \\ln\\left( \\frac{v + b(1-\\sqrt{2})}{v + b(1+\\sqrt{2})} \\right) \\right) = \\frac{a \\alpha}{2b\\sqrt{2}} \\ln\\left( \\frac{v + b(1+\\sqrt{2})}{v + b(1-\\sqrt{2})} \\right) $$\nCombining the results for the full integral term in the $\\ln\\phi$ expression:\n$$ \\frac{1}{RT} \\int_{v}^{\\infty} \\left( P(v') - \\frac{RT}{v'} \\right) dv' = \\frac{I_1+I_2}{RT} = \\ln\\left(\\frac{v}{v-b}\\right) + \\frac{a \\alpha}{2\\sqrt{2}bRT} \\ln\\left( \\frac{v + b(1+\\sqrt{2})}{v + b(1-\\sqrt{2})} \\right) $$\nNow, we substitute this back into the expression for $\\ln \\phi$:\n$$ \\ln \\phi = \\ln\\left(\\frac{v}{v-b}\\right) + \\frac{a \\alpha}{2\\sqrt{2}bRT} \\ln\\left( \\frac{v + b(1+\\sqrt{2})}{v + b(1-\\sqrt{2})} \\right) + Z - 1 - \\ln Z $$\nThe final step is to express this in terms of $Z$, $A$, and $B$.\n$$ Z = \\frac{Pv}{RT}, \\quad A = \\frac{a\\alpha P}{(RT)^2}, \\quad B = \\frac{bP}{RT} $$\nFrom these definitions, we find the following ratios:\n$$ \\frac{b}{v} = \\frac{bP/RT}{Pv/RT} = \\frac{B}{Z} $$\n$$ \\frac{a \\alpha}{bRT} = \\frac{a\\alpha P/(RT)^2}{bP/RT} = \\frac{A}{B} $$\nLet's substitute these into our expression for $\\ln \\phi$.\nThe first term:\n$$ \\ln\\left(\\frac{v}{v-b}\\right) = \\ln\\left(\\frac{1}{1-b/v}\\right) = -\\ln\\left(1 - \\frac{B}{Z}\\right) = - \\ln\\left(\\frac{Z-B}{Z}\\right) = \\ln Z - \\ln(Z-B) $$\nThe coefficient of the second term:\n$$ \\frac{a \\alpha}{2\\sqrt{2}bRT} = \\frac{1}{2\\sqrt{2}} \\frac{A}{B} $$\nThe argument of the logarithm in the second term:\n$$ \\frac{v + b(1+\\sqrt{2})}{v + b(1-\\sqrt{2})} = \\frac{1 + (b/v)(1+\\sqrt{2})}{1 + (b/v)(1-\\sqrt{2})} = \\frac{1 + (B/Z)(1+\\sqrt{2})}{1 + (B/Z)(1-\\sqrt{2})} = \\frac{Z + B(1+\\sqrt{2})}{Z + B(1-\\sqrt{2})} $$\nSubstituting these forms back into the $\\ln\\phi$ equation:\n$$ \\ln \\phi = (\\ln Z - \\ln(Z-B)) + \\frac{A}{2\\sqrt{2}B} \\ln\\left( \\frac{Z + B(1+\\sqrt{2})}{Z + B(1-\\sqrt{2})} \\right) + Z - 1 - \\ln Z $$\nThe $\\ln Z$ terms cancel out, yielding the final expression:\n$$ \\ln \\phi = Z - 1 - \\ln(Z-B) - \\frac{A}{2\\sqrt{2}B} \\ln\\left( \\frac{Z + (1+\\sqrt{2})B}{Z + (1-\\sqrt{2})B} \\right) $$\nThis expression gives the natural logarithm of the fugacity coefficient for a pure fluid described by the Peng–Robinson equation of state, in terms of the compressibility factor $Z$ and the reduced parameters $A$ and $B$.", "answer": "$$\\boxed{Z - 1 - \\ln(Z - B) - \\frac{A}{2\\sqrt{2}B} \\ln\\left(\\frac{Z + (1+\\sqrt{2})B}{Z + (1-\\sqrt{2})B}\\right)}$$", "id": "2642544"}, {"introduction": "Moving from the gas phase to condensed matter, this exercise demonstrates how to determine the fugacity of a pure liquid under elevated pressure. You will apply the fundamental thermodynamic relation $d\\mu = \\bar{V}dP$ to calculate the change in fugacity as a liquid is compressed from its saturation pressure to a higher pressure [@problem_id:2642547]. This calculation involves the Poynting correction, a crucial factor that accounts for the effect of pressure on the fugacity of a condensed phase, a key skill for high-pressure process design.", "problem": "A pure liquid (acetone) at temperature $T = 298.15\\,\\text{K}$ is brought from its equilibrium with its own vapor at the saturation pressure to a compressed state at a higher pressure. Starting from the fundamental definition that the chemical potential of a pure species can be written in terms of its fugacity $f$ via $\\mu(T,P) = \\mu^{\\circ}(T) + RT \\ln\\!\\big(f/f^{\\circ}\\big)$ (with $f^{\\circ}$ a chosen reference fugacity), the equality of chemical potentials of coexisting phases at phase equilibrium, and the thermodynamic identity at constant temperature $d\\mu = V\\,dP$ for a pure condensed phase, derive a working expression to compute the fugacity of the liquid at the higher pressure. Then evaluate it for the following data, treating the liquid as weakly compressible with constant isothermal compressibility.\n\nGiven:\n- Saturation pressure at $298.15\\,\\text{K}$: $P_{\\text{sat}} = 0.304\\,\\text{bar}$.\n- Vapor fugacity coefficient at $P_{\\text{sat}}$: $\\phi^{\\text{sat}} = 0.998$.\n- Liquid molar volume at $P_{0} = 1.000\\,\\text{bar}$: $V_{0} = 73.5\\,\\text{cm}^{3}\\,\\text{mol}^{-1}$.\n- Isothermal compressibility (assumed constant over the pressure interval): $\\kappa_{T} = 1.15 \\times 10^{-9}\\,\\text{Pa}^{-1}$.\n- Treat the liquid molar volume as a linear function of pressure about $P_{0}$: $V_{\\text{liq}}(P) \\approx V_{0}\\big[1 - \\kappa_{T}(P - P_{0})\\big]$.\n- Universal gas constant: $R = 8.314462618\\,\\text{J}\\,\\text{mol}^{-1}\\,\\text{K}^{-1}$.\n\nTarget pressure: $P = 100.0\\,\\text{bar}$. Use the International System of Units (SI) consistently when performing integrals and exponentials. Express the final fugacity of the liquid at $T = 298.15\\,\\text{K}$ and $P = 100.0\\,\\text{bar}$ in bar, and round your answer to four significant figures.", "solution": "The problem is valid as it is scientifically grounded in the principles of chemical thermodynamics, well-posed with all necessary information provided, and stated objectively. We are asked to derive an expression for the fugacity of a compressed liquid and then evaluate it for acetone under specified conditions.\n\nThe derivation begins from the condition of phase equilibrium between a pure liquid and its vapor at a given temperature $T$ and the corresponding saturation pressure $P_{\\text{sat}}$. At equilibrium, the chemical potentials of the two phases are equal:\n$$ \\mu_{\\text{liq}}(T, P_{\\text{sat}}) = \\mu_{\\text{vap}}(T, P_{\\text{sat}}) $$\nBy the definition of fugacity, $f$, the chemical potential $\\mu$ for a pure substance is given by $\\mu(T,P) = \\mu^{\\circ}(T) + RT \\ln(f/f^{\\circ})$, where $\\mu^{\\circ}$ is the chemical potential in a standard state and $f^{\\circ}$ is the fugacity in that state. The equality of chemical potentials thus implies the equality of fugacities for the coexisting phases:\n$$ f_{\\text{liq}}(T, P_{\\text{sat}}) = f_{\\text{vap}}(T, P_{\\text{sat}}) $$\nThe fugacity of the vapor, which is a gas, is related to the pressure by the fugacity coefficient, $\\phi = f/P$. At saturation, this gives $f_{\\text{vap}}(T, P_{\\text{sat}}) = \\phi^{\\text{sat}} P_{\\text{sat}}$. Therefore, the fugacity of the liquid at saturation pressure, which we denote as $f_{\\text{liq}}^{\\text{sat}}$, is:\n$$ f_{\\text{liq}}^{\\text{sat}} = f_{\\text{liq}}(T, P_{\\text{sat}}) = \\phi^{\\text{sat}} P_{\\text{sat}} $$\nThis value serves as our reference point.\n\nNext, we consider the process of compressing the liquid from its saturation pressure $P_{\\text{sat}}$ to a higher pressure $P$ at constant temperature $T$. The change in the chemical potential of a pure substance with pressure at constant temperature is given by the fundamental thermodynamic relation:\n$$ d\\mu_{\\text{liq}} = V_{\\text{liq}} dP $$\nwhere $V_{\\text{liq}}$ is the molar volume of the liquid. To find the chemical potential at the final pressure $P$, we integrate this expression from the initial state $(T, P_{\\text{sat}})$ to the final state $(T, P)$:\n$$ \\int_{\\mu_{\\text{liq}}(T, P_{\\text{sat}})}^{\\mu_{\\text{liq}}(T, P)} d\\mu = \\int_{P_{\\text{sat}}}^{P} V_{\\text{liq}}(P') dP' $$\n$$ \\mu_{\\text{liq}}(T, P) - \\mu_{\\text{liq}}(T, P_{\\text{sat}}) = \\int_{P_{\\text{sat}}}^{P} V_{\\text{liq}}(P') dP' $$\nWe again use the definition of fugacity, from which it follows that $\\mu(T, P) - \\mu(T, P_{\\text{sat}}) = RT \\ln(f_{\\text{liq}}(T, P) / f_{\\text{liq}}(T, P_{\\text{sat}}))$. Substituting this into the integrated equation gives:\n$$ RT \\ln\\left(\\frac{f_{\\text{liq}}(T, P)}{f_{\\text{liq}}^{\\text{sat}}}\\right) = \\int_{P_{\\text{sat}}}^{P} V_{\\text{liq}}(P') dP' $$\nSolving for the fugacity of the compressed liquid, $f_{\\text{liq}}(T, P)$, we obtain the general working expression:\n$$ f_{\\text{liq}}(T, P) = f_{\\text{liq}}^{\\text{sat}} \\exp\\left( \\frac{1}{RT} \\int_{P_{\\text{sat}}}^{P} V_{\\text{liq}}(P') dP' \\right) $$\nSubstituting $f_{\\text{liq}}^{\\text{sat}} = \\phi^{\\text{sat}} P_{\\text{sat}}$, this becomes:\n$$ f_{\\text{liq}}(T, P) = (\\phi^{\\text{sat}} P_{\\text{sat}}) \\exp\\left( \\frac{1}{RT} \\int_{P_{\\text{sat}}}^{P} V_{\\text{liq}}(P') dP' \\right) $$\nThe exponential term is known as the Poynting correction factor.\n\nNow, we evaluate this expression using the given data. The molar volume of the liquid is stated to be a linear function of pressure: $V_{\\text{liq}}(P) = V_{0}\\big[1 - \\kappa_{T}(P - P_{0})\\big]$. We substitute this into the integral:\n$$ \\int_{P_{\\text{sat}}}^{P} V_{0}\\big[1 - \\kappa_{T}(P' - P_{0})\\big] dP' = V_0 \\int_{P_{\\text{sat}}}^{P} (1 + \\kappa_{T}P_{0} - \\kappa_{T}P') dP' $$\nPerforming the integration:\n$$ \\int V_{\\text{liq}} dP' = V_0 \\left[ (1 + \\kappa_T P_0)P' - \\frac{\\kappa_T}{2} (P')^2 \\right]_{P_{\\text{sat}}}^{P} $$\n$$ = V_0 \\left( (1 + \\kappa_T P_0)(P - P_{\\text{sat}}) - \\frac{\\kappa_T}{2} (P^2 - P_{\\text{sat}}^2) \\right) $$\nFor numerical calculation, all quantities must be in consistent SI units.\nGiven data:\n$T = 298.15\\,\\text{K}$\n$R = 8.314462618\\,\\text{J}\\,\\text{mol}^{-1}\\,\\text{K}^{-1}$\n$P_{\\text{sat}} = 0.304\\,\\text{bar} = 0.304 \\times 10^5\\,\\text{Pa} = 3.04 \\times 10^4\\,\\text{Pa}$\n$P = 100.0\\,\\text{bar} = 100.0 \\times 10^5\\,\\text{Pa} = 1.000 \\times 10^7\\,\\text{Pa}$\n$\\phi^{\\text{sat}} = 0.998$\n$V_{0} = 73.5\\,\\text{cm}^{3}\\,\\text{mol}^{-1} = 73.5 \\times (10^{-2}\\,\\text{m})^3\\,\\text{mol}^{-1} = 7.35 \\times 10^{-5}\\,\\text{m}^{3}\\,\\text{mol}^{-1}$\n$P_{0} = 1.000\\,\\text{bar} = 1.000 \\times 10^5\\,\\text{Pa}$\n$\\kappa_{T} = 1.15 \\times 10^{-9}\\,\\text{Pa}^{-1}$\n\nFirst, we calculate the fugacity of the liquid at saturation:\n$f_{\\text{liq}}^{\\text{sat}} = \\phi^{\\text{sat}} P_{\\text{sat}} = 0.998 \\times 0.304\\,\\text{bar} = 0.303392\\,\\text{bar}$.\n\nNext, we evaluate the integral, let's call its value $I$:\n$P - P_{\\text{sat}} = 1.000 \\times 10^7 - 3.04 \\times 10^4 = 9.9696 \\times 10^6\\,\\text{Pa}$\n$P^2 - P_{\\text{sat}}^2 = (1.000 \\times 10^7)^2 - (3.04 \\times 10^4)^2 = 10^{14} - 9.2416 \\times 10^8 = 9.999907584 \\times 10^{13}\\,\\text{Pa}^2$\n$I = (7.35 \\times 10^{-5}) \\left( (1 + (1.15 \\times 10^{-9})(1.000 \\times 10^5))(9.9696 \\times 10^6) - \\frac{1.15 \\times 10^{-9}}{2} (9.999907584 \\times 10^{13}) \\right)$\n$I = (7.35 \\times 10^{-5}) \\left( (1.000115)(9.9696 \\times 10^6) - (5.75 \\times 10^{-10})(9.999907584 \\times 10^{13}) \\right)$\n$I = (7.35 \\times 10^{-5}) \\left( 9.9707465... \\times 10^6 - 57499.468... \\right)$\n$I = (7.35 \\times 10^{-5}) \\left( 9913247.0... \\right) = 728.6236...\\,\\text{J}\\,\\text{mol}^{-1}$\n\nNow, we compute the exponent of the Poynting factor:\n$\\frac{I}{RT} = \\frac{728.6236\\,\\text{J}\\,\\text{mol}^{-1}}{(8.314462618\\,\\text{J}\\,\\text{mol}^{-1}\\,\\text{K}^{-1})(298.15\\,\\text{K})} = \\frac{728.6236}{2478.9555} = 0.293924...$\n\nThe Poynting factor is:\n$\\exp(0.293924) = 1.34168...$\n\nFinally, we calculate the fugacity of the compressed liquid:\n$f_{\\text{liq}}(T, P) = f_{\\text{liq}}^{\\text{sat}} \\times \\exp\\left(\\frac{I}{RT}\\right) = (0.303392\\,\\text{bar}) \\times (1.34168...)$\n$f_{\\text{liq}}(T, P) = 0.407073...\\,\\text{bar}$\n\nRounding the result to four significant figures, as requested:\n$f_{\\text{liq}}(100.0\\,\\text{bar}) = 0.4071\\,\\text{bar}$.", "answer": "$$\\boxed{0.4071}$$", "id": "2642547"}, {"introduction": "This final practice applies the principles of fugacity and standard states to a practical and essential task: analyzing the behavior of non-ideal liquid mixtures. Using experimental vapor-liquid equilibrium (VLE) data, you will compute activity coefficients, $\\gamma_i$, which quantify deviations from ideal mixing behavior described by Raoult's Law [@problem_id:2531540]. Furthermore, you will use the Gibbs-Duhem equation to perform a thermodynamic consistency check on the dataset, a vital skill for validating experimental results and developing accurate models for chemical separations.", "problem": "A binary liquid mixture at isothermal vapor–liquid equilibrium (VLE) is characterized by measured liquid-phase mole fractions and coexisting vapor-phase mole fractions at a specified absolute temperature and absolute pressure. Starting only from the equality of component fugacities at phase equilibrium and the definitions of activity and activity coefficients, derive an algorithm to compute, for each data point, the liquid-phase activities and activity coefficients of both components using a corrected Raoult’s law based on a standard-state pure liquid at the same temperature. Then, assess the thermodynamic consistency of the computed activity coefficients by numerically evaluating the Gibbs–Duhem equation at constant temperature and pressure. Your program must implement this algorithm and return a single scalar residual per test case that quantifies the Gibbs–Duhem consistency via a trapezoidal integration of the differential form.\n\nFundamental bases and definitions to use:\n- At phase equilibrium, the fugacity of component $i$ in the vapor equals that in the liquid, $f_i^{V} = f_i^{L}$.\n- In the ideal-gas limit for the vapor, the fugacity is $f_i^{V} = y_i P$, where $y_i$ is the vapor-phase mole fraction, and $P$ is the total pressure.\n- The liquid-phase fugacity is $f_i^{L} = a_i f_i^{L,0}$, where $a_i$ is the activity and $f_i^{L,0}$ is the fugacity of the standard state (pure liquid at the same temperature).\n- The activity is $a_i = \\gamma_i x_i$, where $\\gamma_i$ is the activity coefficient and $x_i$ is the liquid-phase mole fraction.\n- For low-to-moderate pressures, correct the standard-state fugacity by the Poynting factor. Use $f_i^{L,0} = P_i^{\\mathrm{sat}} \\exp\\!\\left(\\dfrac{V_i^{L} (P - P_i^{\\mathrm{sat}})}{R T}\\right)$, where $P_i^{\\mathrm{sat}}$ is the saturation pressure of the pure liquid, $V_i^{L}$ is the molar volume of the liquid (assumed composition-independent and constant over the pressure interval), $R$ is the universal gas constant, and $T$ is the absolute temperature. Use the ideal-gas fugacity coefficient in the vapor phase (that is, unity).\n- The saturation pressure for each component is given by the exponential form $P_i^{\\mathrm{sat}}(T) = \\exp\\!\\left(A_i - \\dfrac{B_i}{T}\\right)$, with $P_i^{\\mathrm{sat}}$ in kilopascals and $T$ in kelvin. The natural exponential and natural logarithm are to be used throughout.\n- The Gibbs–Duhem equation for a binary mixture at constant $T$ and $P$ is $x_1 \\, d(\\ln \\gamma_1) + x_2 \\, d(\\ln \\gamma_2) = 0$, with $x_2 = 1 - x_1$.\n\nComputational tasks:\n1. For each composition data point $(x_1, y_1)$, compute $x_2 = 1 - x_1$ and $y_2 = 1 - y_1$.\n2. Compute $P_1^{\\mathrm{sat}}(T)$ and $P_2^{\\mathrm{sat}}(T)$ using the equation above. Use $R = 8.314462618 \\ \\mathrm{J \\, mol^{-1} \\, K^{-1}}$. Use $P$ and $P_i^{\\mathrm{sat}}$ in kilopascals when forming dimensionless ratios, and convert pressures to pascals inside the Poynting exponential as needed to maintain units consistency with $V_i^{L}$ in $\\mathrm{m^3 \\, mol^{-1}}$.\n3. From fugacity equality and the definitions above, derive and compute the activity coefficients $\\gamma_i$ and the activities $a_i$ for $i \\in \\{1,2\\}$ at each data point.\n4. Sort the data by increasing $x_1$ if necessary and numerically evaluate the Gibbs–Duhem integral residual over the tabulated composition range using the trapezoidal rule applied to the differential form. Specifically, for consecutive data points indexed by $k$ and $k+1$, approximate\n$$\n\\Delta \\equiv \\sum_{k} \\left[\\tfrac{1}{2}(x_{1,k} + x_{1,k+1}) \\left(\\ln \\gamma_{1,k+1} - \\ln \\gamma_{1,k}\\right) + \\tfrac{1}{2}(x_{2,k} + x_{2,k+1}) \\left(\\ln \\gamma_{2,k+1} - \\ln \\gamma_{2,k}\\right)\\right].\n$$\nReport the absolute value of $\\Delta$ as the residual. The ideal value is zero for perfectly consistent data without measurement noise and model error.\n5. All activities and activity coefficients are dimensionless. The Gibbs–Duhem residual is also dimensionless. Express the final residuals as dimensionless floating-point numbers.\n\nInput data to be hard-coded (test suite):\n- Test case 1 (happy path, moderate nonideality, near-atmospheric pressure):\n  - $T = 323.15 \\ \\mathrm{K}$, $P = 101.325 \\ \\mathrm{kPa}$.\n  - Component 1: $A_1 = 16.262$, $B_1 = 3800$, $V_1^{L} = 1.05 \\times 10^{-4} \\ \\mathrm{m^3 \\, mol^{-1}}$.\n  - Component 2: $A_2 = 15.900$, $B_2 = 4000$, $V_2^{L} = 0.95 \\times 10^{-4} \\ \\mathrm{m^3 \\, mol^{-1}}$.\n  - Liquid compositions $x_1$: $[0.05, 0.20, 0.40, 0.60, 0.80, 0.95]$ (dimensionless).\n  - Vapor compositions $y_1$: $[0.12, 0.32, 0.58, 0.78, 0.92, 0.985]$ (dimensionless).\n- Test case 2 (increased temperature, stronger volatility contrast):\n  - $T = 343.15 \\ \\mathrm{K}$, $P = 101.325 \\ \\mathrm{kPa}$.\n  - Component 1: $A_1 = 16.262$, $B_1 = 3800$, $V_1^{L} = 1.05 \\times 10^{-4} \\ \\mathrm{m^3 \\, mol^{-1}}$.\n  - Component 2: $A_2 = 15.900$, $B_2 = 4000$, $V_2^{L} = 0.95 \\times 10^{-4} \\ \\mathrm{m^3 \\, mol^{-1}}$.\n  - Liquid compositions $x_1$: $[0.05, 0.20, 0.40, 0.60, 0.80, 0.95]$ (dimensionless).\n  - Vapor compositions $y_1$: $[0.25, 0.50, 0.72, 0.88, 0.97, 0.995]$ (dimensionless).\n- Test case 3 (different binary with closer pure-component volatilities at sub-atmospheric pressure):\n  - $T = 323.15 \\ \\mathrm{K}$, $P = 60.0 \\ \\mathrm{kPa}$.\n  - Component 1: $A_1 = 16.000$, $B_1 = 4100$, $V_1^{L} = 1.00 \\times 10^{-4} \\ \\mathrm{m^3 \\, mol^{-1}}$.\n  - Component 2: $A_2 = 16.100$, $B_2 = 4200$, $V_2^{L} = 1.00 \\times 10^{-4} \\ \\mathrm{m^3 \\, mol^{-1}}$.\n  - Liquid compositions $x_1$: $[0.05, 0.20, 0.40, 0.60, 0.80, 0.95]$ (dimensionless).\n  - Vapor compositions $y_1$: $[0.06, 0.23, 0.41, 0.59, 0.77, 0.94]$ (dimensionless).\n\nProgram requirements:\n- Implement the derivation to compute $\\gamma_i$ and $a_i$ from the above bases and definitions. Ensure all logarithms and exponentials are natural.\n- Compute and report only the absolute Gibbs–Duhem residual $\\lvert \\Delta \\rvert$ for each test case as a floating-point number.\n- Final output format: Your program should produce a single line of output containing the three residuals as a comma-separated list enclosed in square brackets, with each residual rounded to six decimal places (for example, \"[0.000123,0.012345,0.001234]\").", "solution": "The problem statement has been critically examined and is deemed valid. It is scientifically sound, well-posed, and free of contradictions or ambiguities. It presents a standard and rigorous task in chemical thermodynamics: the assessment of vapor-liquid equilibrium (VLE) data for thermodynamic consistency using the Gibbs–Duhem equation. We shall proceed with the derivation and computational implementation.\n\nThe objective is to compute the activity coefficients, $\\gamma_i$, for a binary mixture from experimental VLE data and then to evaluate the thermodynamic consistency of these coefficients by numerically integrating the Gibbs–Duhem equation.\n\nFirst, we derive the expression for the activity coefficient, $\\gamma_i$. The fundamental condition for phase equilibrium for component $i$ is the equality of its fugacity in the liquid phase ($L$) and the vapor phase ($V$):\n$$ f_i^{L} = f_i^{V} $$\nThe problem specifies the models for each phase fugacity. For the liquid phase, the fugacity is related to the activity, $a_i$, and the standard-state fugacity, $f_i^{L,0}$:\n$$ f_i^{L} = a_i f_i^{L,0} $$\nThe activity is defined in terms of the activity coefficient, $\\gamma_i$, and the liquid-phase mole fraction, $x_i$:\n$$ a_i = \\gamma_i x_i $$\nCombining these gives the liquid-phase fugacity:\n$$ f_i^{L} = \\gamma_i x_i f_i^{L,0} $$\nFor the vapor phase, assuming it behaves as an ideal gas mixture, the fugacity of component $i$ is its partial pressure:\n$$ f_i^{V} = y_i P $$\nwhere $y_i$ is the vapor-phase mole fraction and $P$ is the total system pressure.\n\nEquating the fugacities, we obtain:\n$$ \\gamma_i x_i f_i^{L,0} = y_i P $$\nSolving for the activity coefficient, $\\gamma_i$, yields:\n$$ \\gamma_i = \\frac{y_i P}{x_i f_i^{L,0}} $$\nThe standard state is the pure liquid $i$ at the system temperature $T$. Its fugacity, $f_i^{L,0}$, must be corrected for the effect of pressure from its saturation pressure, $P_i^{\\mathrm{sat}}$, to the system pressure, $P$. This is accomplished using the Poynting correction factor:\n$$ f_i^{L,0} = P_i^{\\mathrm{sat}} \\exp\\!\\left(\\frac{V_i^{L} (P - P_i^{\\mathrm{sat}})}{R T}\\right) $$\nHere, $V_i^{L}$ is the molar volume of pure liquid $i$, $R$ is the universal gas constant, and $T$ is the absolute temperature. The saturation pressure, $P_i^{\\mathrm{sat}}$, is calculated from the given Antoine-type equation:\n$$ P_i^{\\mathrm{sat}}(T) = \\exp\\!\\left(A_i - \\frac{B_i}{T}\\right) $$\nSubstituting the expression for $f_i^{L,0}$ into the equation for $\\gamma_i$ gives the final computational formula:\n$$ \\gamma_i = \\frac{y_i P}{x_i P_i^{\\mathrm{sat}}(T) \\exp\\!\\left(\\frac{V_i^{L} (P - P_i^{\\mathrm{sat}}(T))}{R T}\\right)} $$\nThe activity, $a_i$, if required, is then simply $a_i = \\gamma_i x_i$.\n\nNext, we address the thermodynamic consistency test. The Gibbs–Duhem equation for a binary mixture at constant temperature $T$ and pressure $P$ is:\n$$ x_1 \\, d(\\ln \\gamma_1) + x_2 \\, d(\\ln \\gamma_2) = 0 $$\nwhere $x_2 = 1 - x_1$. For thermodynamically consistent data, the integral of this expression across the entire composition range must be zero:\n$$ \\int_{x_1=0}^{x_1=1} \\left[ x_1 \\, d(\\ln \\gamma_1) + x_2 \\, d(\\ln \\gamma_2) \\right] = 0 $$\nThe problem requires a numerical evaluation of this integral using the available discrete data points. The specified formula represents a summation of the integral over consecutive data intervals using the trapezoidal rule. For data points indexed from $k=0$ to $k=N-1$, the residual $\\Delta$ is calculated as:\n$$ \\Delta = \\sum_{k=0}^{N-2} \\left[ \\frac{1}{2}(x_{1,k} + x_{1,k+1}) (\\ln \\gamma_{1,k+1} - \\ln \\gamma_{1,k}) + \\frac{1}{2}(x_{2,k} + x_{2,k+1}) (\\ln \\gamma_{2,k+1} - \\ln \\gamma_{2,k}) \\right] $$\nThe reported result is the absolute value, $|\\Delta|$, which quantifies the deviation from ideal consistency. A value of $\\Delta = 0$ indicates perfect consistency within the framework of the chosen physical models. Non-zero values arise from experimental error and model inaccuracies.\n\nThe computational procedure for each test case is as follows:\n1.  Define all input parameters: $T$, $P$, $R$, and component-specific properties $A_1, B_1, V_1^{L}, A_2, B_2, V_2^{L}$. Organize the experimental data as arrays of $x_1$ and $y_1$.\n2.  Compute mole fractions for component $2$: $x_2 = 1 - x_1$ and $y_2 = 1 - y_1$.\n3.  Calculate the saturation pressures $P_1^{\\mathrm{sat}}$ and $P_2^{\\mathrm{sat}}$ at temperature $T$.\n4.  For each data point $(x_{1,k}, y_{1,k})$, compute the activity coefficients $\\gamma_{1,k}$ and $\\gamma_{2,k}$ using the derived formula. Care must be taken with units: pressures $P$ and $P_i^{\\mathrm{sat}}$ must be converted to Pascals ($1 \\ \\mathrm{kPa} = 1000 \\ \\mathrm{Pa}$) for the argument of the exponential function to be dimensionless, as $R$ is in S.I. units ($\\mathrm{J \\, mol^{-1} \\, K^{-1}}$) and $V_i^L$ is in $\\mathrm{m^3 \\, mol^{-1}}$.\n5.  Compute the natural logarithm of the activity coefficients, $\\ln \\gamma_{1,k}$ and $\\ln \\gamma_{2,k}$.\n6.  Apply the trapezoidal rule summation formula for $\\Delta$ over all adjacent pairs of data points.\n7.  The result for the test case is the absolute value of the total sum, $|\\Delta|$.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the Gibbs-Duhem consistency residual for three VLE test cases.\n    \"\"\"\n    R = 8.314462618  # J mol^-1 K^-1\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"T\": 323.15,  # K\n            \"P\": 101.325,  # kPa\n            \"comp1\": {\"A\": 16.262, \"B\": 3800, \"V_L\": 1.05e-4}, # m^3 mol^-1\n            \"comp2\": {\"A\": 15.900, \"B\": 4000, \"V_L\": 0.95e-4}, # m^3 mol^-1\n            \"x1_data\": [0.05, 0.20, 0.40, 0.60, 0.80, 0.95],\n            \"y1_data\": [0.12, 0.32, 0.58, 0.78, 0.92, 0.985],\n        },\n        {\n            \"T\": 343.15,  # K\n            \"P\": 101.325,  # kPa\n            \"comp1\": {\"A\": 16.262, \"B\": 3800, \"V_L\": 1.05e-4},\n            \"comp2\": {\"A\": 15.900, \"B\": 4000, \"V_L\": 0.95e-4},\n            \"x1_data\": [0.05, 0.20, 0.40, 0.60, 0.80, 0.95],\n            \"y1_data\": [0.25, 0.50, 0.72, 0.88, 0.97, 0.995],\n        },\n        {\n            \"T\": 323.15,  # K\n            \"P\": 60.0,    # kPa\n            \"comp1\": {\"A\": 16.000, \"B\": 4100, \"V_L\": 1.00e-4},\n            \"comp2\": {\"A\": 16.100, \"B\": 4200, \"V_L\": 1.00e-4},\n            \"x1_data\": [0.05, 0.20, 0.40, 0.60, 0.80, 0.95],\n            \"y1_data\": [0.06, 0.23, 0.41, 0.59, 0.77, 0.94],\n        },\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        T = case[\"T\"]\n        P_kpa = case[\"P\"]\n        P_pa = P_kpa * 1000.0\n\n        A1, B1, V1L = case[\"comp1\"][\"A\"], case[\"comp1\"][\"B\"], case[\"comp1\"][\"V_L\"]\n        A2, B2, V2L = case[\"comp2\"][\"A\"], case[\"comp2\"][\"B\"], case[\"comp2\"][\"V_L\"]\n\n        x1 = np.array(case[\"x1_data\"])\n        y1 = np.array(case[\"y1_data\"])\n        x2 = 1.0 - x1\n        y2 = 1.0 - y1\n\n        # Step 2: Compute saturation pressures (in kPa)\n        P1_sat_kpa = np.exp(A1 - B1 / T)\n        P2_sat_kpa = np.exp(A2 - B2 / T)\n        \n        P1_sat_pa = P1_sat_kpa * 1000.0\n        P2_sat_pa = P2_sat_kpa * 1000.0\n\n        # Step 3: Compute activity coefficients\n        # Poynting correction factor\n        poynting1 = np.exp(V1L * (P_pa - P1_sat_pa) / (R * T))\n        poynting2 = np.exp(V2L * (P_pa - P2_sat_pa) / (R * T))\n\n        # Denominator for gamma calculation\n        denom1 = x1 * P1_sat_kpa * poynting1\n        denom2 = x2 * P2_sat_kpa * poynting2\n        \n        # Activity coefficients\n        gamma1 = (y1 * P_kpa) / denom1\n        gamma2 = (y2 * P_kpa) / denom2\n\n        ln_gamma1 = np.log(gamma1)\n        ln_gamma2 = np.log(gamma2)\n\n        # Step 4: Numerically evaluate the Gibbs-Duhem integral residual\n        delta = 0.0\n        for k in range(len(x1) - 1):\n            # Trapezoidal rule for the interval [k, k+1]\n            avg_x1 = 0.5 * (x1[k] + x1[k+1])\n            avg_x2 = 0.5 * (x2[k] + x2[k+1])\n            \n            d_ln_gamma1 = ln_gamma1[k+1] - ln_gamma1[k]\n            d_ln_gamma2 = ln_gamma2[k+1] - ln_gamma2[k]\n            \n            term = avg_x1 * d_ln_gamma1 + avg_x2 * d_ln_gamma2\n            delta += term\n            \n        residual = abs(delta)\n        results.append(f\"{residual:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "2531540"}]}