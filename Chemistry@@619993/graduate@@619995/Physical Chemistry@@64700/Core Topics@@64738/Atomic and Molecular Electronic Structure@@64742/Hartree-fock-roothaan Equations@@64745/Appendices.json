{"hands_on_practices": [{"introduction": "To truly master the Hartree-Fock-Roothaan method, it is essential to move beyond abstract theory and see the equations in action. This first practice exercise demystifies the self-consistent field (SCF) procedure by guiding you through one full iteration for a simple, hypothetical two-electron system. By manually constructing the Fock matrix, solving the generalized eigenvalue problem, and updating the density matrix, you will gain a concrete, step-by-step understanding of the computational engine that drives modern quantum chemistry calculations [@problem_id:2643602].", "problem": "Consider a minimal toy system intended to illustrate the Hartree–Fock–Roothaan equations for a closed-shell molecule in a non-orthonormal atomic orbital (AO) basis. There are $2$ electrons occupying one spatial molecular orbital doubly (restricted closed shell). The basis has dimension $2$ with AO overlap matrix\n$$\nS \\;=\\; \\begin{pmatrix}\n1.0 & 0.2 \\\\\n0.2 & 1.0\n\\end{pmatrix}.\n$$\nThe one-electron core Hamiltonian matrix (in Hartree atomic units) is\n$$\nH^{\\text{core}} \\;=\\; \\begin{pmatrix}\n-1.0 & -0.2 \\\\\n-0.2 & -0.5\n\\end{pmatrix}.\n$$\nElectron repulsion integrals are given in chemists’ notation $(\\mu\\nu|\\lambda\\sigma)$ and respect the standard permutational symmetries. The only nonzero two-electron integrals (in Hartree) are\n$$\n(11|11)=0.7,\\quad (22|22)=0.6,\\quad (11|22)=(22|11)=0.2,\\quad (12|12)=(21|21)=(12|21)=(21|12)=0.25,\n$$\nand all other $(\\mu\\nu|\\lambda\\sigma)$ are zero. Assume the nuclear repulsion energy is $0$ Hartree.\n\nStarting from an initial zero density, perform one self-consistent-field (SCF) iteration explicitly in the sense of the Hartree–Fock–Roothaan method for a restricted closed-shell system: diagonalize the generalized eigenvalue problem for the initial Fock matrix in the AO basis to obtain the lowest-energy normalized molecular orbital (with $S$-orthonormalization), construct the updated AO density matrix, rebuild the Fock matrix using the updated density, and then evaluate the closed-shell electronic energy. Use the standard closed-shell definitions appropriate to Hartree–Fock theory in a non-orthonormal AO basis.\n\nExpress the final electronic energy (excluding nuclear repulsion) in Hartree and round your answer to four significant figures. Your final answer must be a single real number.", "solution": "The problem requires performing one full iteration of the self-consistent-field (SCF) procedure for a restricted closed-shell system, as described by the Hartree-Fock-Roothaan equations. The system consists of $2$ electrons in a non-orthogonal basis of two atomic orbitals (AOs). The final goal is to compute the electronic energy after this single iteration.\n\nThe Hartree-Fock-Roothaan equation in the AO basis is a generalized eigenvalue problem:\n$$ FC = SCE $$\nwhere $F$ is the Fock matrix, $C$ is the matrix of molecular orbital (MO) coefficients, $S$ is the AO overlap matrix, and $E$ is a diagonal matrix of orbital energies $\\epsilon_i$.\n\nFor a restricted closed-shell system, the elements of the Fock matrix $F_{\\mu\\nu}$ are given by:\n$$ F_{\\mu\\nu} = H_{\\mu\\nu}^{\\text{core}} + \\sum_{\\lambda\\sigma} P_{\\lambda\\sigma} \\left[ (\\mu\\nu|\\lambda\\sigma) - \\frac{1}{2}(\\mu\\lambda|\\nu\\sigma) \\right] $$\nHere, $H^{\\text{core}}$ is the core Hamiltonian, $(\\mu\\nu|\\lambda\\sigma)$ are the two-electron repulsion integrals in chemists' notation, and $P$ is the density matrix. The density matrix elements $P_{\\lambda\\sigma}$ for a system with $N$ electrons are defined as:\n$$ P_{\\lambda\\sigma} = 2 \\sum_{i=1}^{N/2} C_{\\lambda i} C_{\\sigma i}^* $$\nwhere the sum is over the occupied MOs. For this problem, $N=2$, so the sum is only over the lowest-energy MO, $i=1$.\n\nThe electronic energy $E_{elec}$ is calculated using the converged density and Fock matrices:\n$$ E_{elec} = \\frac{1}{2} \\sum_{\\mu\\nu} P_{\\nu\\mu} (H_{\\mu\\nu}^{\\text{core}} + F_{\\mu\\nu}) $$\nGiven that the matrices are real and symmetric, this is equivalent to $E_{elec} = \\frac{1}{2} \\text{Tr}[P(H^{\\text{core}} + F)]$.\n\nThe SCF procedure begins with an initial guess for the density matrix $P^{(0)}$.\n**Step 0: Initial Guess**\nThe problem specifies an initial zero density. Thus, the initial density matrix $P^{(0)}$ is the $2 \\times 2$ zero matrix:\n$$ P^{(0)} = \\begin{pmatrix} 0 & 0 \\\\ 0 & 0 \\end{pmatrix} $$\n\n**Step 1: Initial Fock Matrix**\nUsing $P^{(0)}$, we construct the initial Fock matrix, $F^{(0)}$. Since $P^{(0)}$ is a zero matrix, the two-electron term in the Fock matrix expression vanishes. Therefore, the initial Fock matrix is equal to the core Hamiltonian:\n$$ F^{(0)} = H^{\\text{core}} = \\begin{pmatrix} -1.0 & -0.2 \\\\ -0.2 & -0.5 \\end{pmatrix} $$\n\n**Step 2: Solve the Generalized Eigenvalue Problem**\nWe solve the generalized eigenvalue problem $F^{(0)}C^{(1)} = SC^{(1)}E^{(1)}$ to find the first iteration of MO coefficients $C^{(1)}$ and energies $E^{(1)}$. This requires solving the secular equation $\\det(F^{(0)} - \\epsilon S) = 0$.\n$$ \\det \\left( \\begin{pmatrix} -1.0 & -0.2 \\\\ -0.2 & -0.5 \\end{pmatrix} - \\epsilon \\begin{pmatrix} 1.0 & 0.2 \\\\ 0.2 & 1.0 \\end{pmatrix} \\right) = 0 $$\n$$ \\det \\begin{pmatrix} -1.0 - \\epsilon & -0.2 - 0.2\\epsilon \\\\ -0.2 - 0.2\\epsilon & -0.5 - \\epsilon \\end{pmatrix} = 0 $$\nThe determinant is:\n$$ (-1.0 - \\epsilon)(-0.5 - \\epsilon) - (-0.2 - 0.2\\epsilon)^2 = 0 $$\n$$ (1.0 + \\epsilon)(0.5 + \\epsilon) - (0.2)^2(1.0 + \\epsilon)^2 = 0 $$\n$$ (1.0 + \\epsilon) \\left[ (0.5 + \\epsilon) - 0.04(1.0 + \\epsilon) \\right] = 0 $$\n$$ (1.0 + \\epsilon) (0.5 + \\epsilon - 0.04 - 0.04\\epsilon) = 0 $$\n$$ (1.0 + \\epsilon) (0.96\\epsilon + 0.46) = 0 $$\nThis equation yields two orbital energies: $\\epsilon_1 = -1.0$ and $\\epsilon_2 = -0.46/0.96 \\approx -0.47917$. The lowest energy orbital is $\\epsilon_1 = -1.0$.\n\n**Step 3: Determine and Normalize the Lowest-Energy MO**\nWe find the eigenvector $C_1$ corresponding to $\\epsilon_1 = -1.0$ by solving $(F^{(0)} - \\epsilon_1 S)C_1 = 0$:\n$$ \\left( \\begin{pmatrix} -1.0 & -0.2 \\\\ -0.2 & -0.5 \\end{pmatrix} - (-1.0) \\begin{pmatrix} 1.0 & 0.2 \\\\ 0.2 & 1.0 \\end{pmatrix} \\right) \\begin{pmatrix} c_{11} \\\\ c_{21} \\end{pmatrix} = \\begin{pmatrix} 0 & 0 \\\\ 0 & 0.5 \\end{pmatrix} \\begin{pmatrix} c_{11} \\\\ c_{21} \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix} $$\nThe second row gives $0.5 c_{21} = 0$, so $c_{21}=0$. The first row $0=0$ provides no constraint on $c_{11}$. We can set $c_{11}=1$, giving the unnormalized eigenvector $C_1' = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$.\nThe MO must be normalized according to $C_1^\\dagger S C_1 = 1$.\n$$ \\begin{pmatrix} 1 & 0 \\end{pmatrix} \\begin{pmatrix} 1.0 & 0.2 \\\\ 0.2 & 1.0 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 1 & 0 \\end{pmatrix} \\begin{pmatrix} 1.0 \\\\ 0.2 \\end{pmatrix} = 1.0 $$\nThe normalization constant is $1$, so the normalized MO coefficient vector is $C_1^{(1)} = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$.\n\n**Step 4: Construct the Updated Density Matrix**\nWith $2$ electrons in the single occupied MO $\\psi_1$, the new density matrix $P^{(1)}$ is:\n$$ P_{\\mu\\nu}^{(1)} = 2 C_{\\mu 1}^{(1)} C_{\\nu 1}^{(1)} $$\nUsing $C_1^{(1)} = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$, we get:\n$P_{11}^{(1)} = 2(1)(1) = 2$\n$P_{12}^{(1)} = P_{21}^{(1)} = 2(1)(0) = 0$\n$P_{22}^{(1)} = 2(0)(0) = 0$\n$$ P^{(1)} = \\begin{pmatrix} 2 & 0 \\\\ 0 & 0 \\end{pmatrix} $$\n\n**Step 5: Rebuild the Fock Matrix**\nThe updated Fock matrix $F^{(1)}$ is built using $P^{(1)}$. The general expression for an element is:\n$$ F_{\\mu\\nu}^{(1)} = H_{\\mu\\nu}^{\\text{core}} + \\sum_{\\lambda\\sigma} P_{\\lambda\\sigma}^{(1)} \\left[ (\\mu\\nu|\\lambda\\sigma) - \\frac{1}{2}(\\mu\\lambda|\\nu\\sigma) \\right] $$\nSince only $P_{11}^{(1)} = 2$ is non-zero, the sum simplifies to the term where $\\lambda=\\sigma=1$:\n$$ F_{\\mu\\nu}^{(1)} = H_{\\mu\\nu}^{\\text{core}} + P_{11}^{(1)} \\left[ (\\mu\\nu|11) - \\frac{1}{2}(\\mu 1|\\nu 1) \\right] = H_{\\mu\\nu}^{\\text{core}} + 2 \\left[ (\\mu\\nu|11) - \\frac{1}{2}(\\mu 1|\\nu 1) \\right] $$\nThe integrals not listed are zero.\nFor $F_{11}^{(1)}$: $(\\mu=1, \\nu=1)$\n$$ F_{11}^{(1)} = H_{11}^{\\text{core}} + 2 \\left[ (11|11) - \\frac{1}{2}(11|11) \\right] = H_{11}^{\\text{core}} + (11|11) = -1.0 + 0.7 = -0.3 $$\nFor $F_{22}^{(1)}$: $(\\mu=2, \\nu=2)$\n$$ F_{22}^{(1)} = H_{22}^{\\text{core}} + 2 \\left[ (22|11) - \\frac{1}{2}(21|21) \\right] = -0.5 + 2 \\left[ 0.2 - \\frac{1}{2}(0.25) \\right] = -0.5 + 2(0.075) = -0.35 $$\nFor $F_{12}^{(1)}$: $(\\mu=1, \\nu=2)$\n$$ F_{12}^{(1)} = H_{12}^{\\text{core}} + 2 \\left[ (12|11) - \\frac{1}{2}(11|21) \\right] $$\nThe integrals $(12|11)$ and $(11|21)$ are not in the list of non-zero integrals, thus they are $0$.\n$$ F_{12}^{(1)} = H_{12}^{\\text{core}} + 0 = -0.2 $$\nBy symmetry, $F_{21}^{(1)} = -0.2$. The new Fock matrix is:\n$$ F^{(1)} = \\begin{pmatrix} -0.3 & -0.2 \\\\ -0.2 & -0.35 \\end{pmatrix} $$\n\n**Step 6: Evaluate the Electronic Energy**\nThe electronic energy after one iteration, $E_{elec}^{(1)}$, is calculated using $P^{(1)}$ and $F^{(1)}$:\n$$ E_{elec}^{(1)} = \\frac{1}{2} \\sum_{\\mu\\nu} P_{\\mu\\nu}^{(1)} (H_{\\mu\\nu}^{\\text{core}} + F_{\\mu\\nu}^{(1)}) $$\nSince $P^{(1)}$ has only one non-zero element, $P_{11}^{(1)}=2$:\n$$ E_{elec}^{(1)} = \\frac{1}{2} P_{11}^{(1)} (H_{11}^{\\text{core}} + F_{11}^{(1)}) = \\frac{1}{2} (2) (-1.0 + (-0.3)) = 1 \\cdot (-1.3) = -1.3 $$\nThe electronic energy, excluding nuclear repulsion, after one SCF iteration is $-1.3$ Hartree.\n\nThe problem asks for the answer to be rounded to four significant figures. This gives $-1.300$.", "answer": "$$\\boxed{-1.300}$$", "id": "2643602"}, {"introduction": "A crucial feature of the Hartree-Fock-Roothaan equations is their form as a generalized eigenvalue problem, $FC = SCE$, which explicitly accounts for the non-orthogonality of atomic orbital basis functions. This exercise presents a thought experiment to underscore the importance of the overlap matrix, $S$ [@problem_id:2464744]. You are asked to solve the equations for the hydrogen molecule under the deliberately incorrect assumption that the basis is orthonormal (i.e., $S = I$), which reduces the problem to a standard eigenvalue problem. This practice serves as a valuable cautionary tale, highlighting the significant errors introduced by ignoring basis set overlap and reinforcing why the generalized form is essential for physically meaningful results.", "problem": "Consider the Hartree-Fock-Roothaan (HFR) equations for the hydrogen molecule $H_2$ in a minimal basis of two hydrogen $1s$ orbitals. The HFR equations can be written as the generalized eigenvalue problem $F \\mathbf{c} = S \\mathbf{c} \\varepsilon$, where $F$ is the Fock matrix, $S$ is the overlap matrix, $\\mathbf{c}$ is the molecular orbital coefficient vector, and $\\varepsilon$ is the orbital energy. In this problem, you are asked to solve these equations under the deliberately incorrect assumption that the basis is orthonormal, that is, by setting $S = I$, where $I$ is the identity matrix. Under this assumption, the problem reduces to finding the ordinary eigenvalues of $F$.\n\nFor each test case below, you are given a symmetric $2 \\times 2$ real Fock matrix $F$ (in Hartree atomic units) and the corresponding overlap matrix $S$ (which you must ignore for the purposes of solving). Each case corresponds to a different internuclear separation $R$ (in Bohr) of $H_2$. Your task for each case is to compute the two molecular orbital energies by solving $F \\mathbf{c} = \\varepsilon \\mathbf{c}$, and to report them in ascending order. All energies must be expressed in Hartree and rounded to six decimal places.\n\nTest suite (each case provides $R$, $F$, and $S$; you must ignore $S$ and use only $F$ when computing the eigenvalues):\n\n- Case $1$ ($R = 0.5$ Bohr):\n  - $F^{(1)} = \\begin{pmatrix} -0.5 & -0.8402976848102109 \\\\ -0.8402976848102109 & -0.5 \\end{pmatrix}$\n  - $S^{(1)} = \\begin{pmatrix} 1.0 & 0.9603402112116696 \\\\ 0.9603402112116696 & 1.0 \\end{pmatrix}$\n- Case $2$ ($R = 1.4$ Bohr):\n  - $F^{(2)} = \\begin{pmatrix} -0.5 & -0.658824888663992 \\\\ -0.658824888663992 & -0.5 \\end{pmatrix}$\n  - $S^{(2)} = \\begin{pmatrix} 1.0 & 0.7529427299017052 \\\\ 0.7529427299017052 & 1.0 \\end{pmatrix}$\n- Case $3$ ($R = 2.0$ Bohr):\n  - $F^{(3)} = \\begin{pmatrix} -0.5 & -0.5131462822721565 \\\\ -0.5131462822721565 & -0.5 \\end{pmatrix}$\n  - $S^{(3)} = \\begin{pmatrix} 1.0 & 0.5864528940253217 \\\\ 0.5864528940253217 & 1.0 \\end{pmatrix}$\n- Case $4$ ($R = 4.0$ Bohr):\n  - $F^{(4)} = \\begin{pmatrix} -0.5 & -0.16560390161897155 \\\\ -0.16560390161897155 & -0.5 \\end{pmatrix}$\n  - $S^{(4)} = \\begin{pmatrix} 1.0 & 0.1892616018502532 \\\\ 0.1892616018502532 & 1.0 \\end{pmatrix}$\n\nRequirements:\n\n- For each case, compute the two eigenvalues of $F$ (in Hartree), sort them in ascending order, and round each to six decimal places.\n- Aggregate the results of all four cases into a single line: a list of four sublists, each sublist containing the two rounded eigenvalues for that case.\n- Final output format: a single line containing the results as a comma-separated list of sublists with no spaces, for example, $[[a_1,a_2],[b_1,b_2],[c_1,c_2],[d_1,d_2]]$, where each symbol represents a decimal number rounded to six places.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets with no spaces (for example, [[e11,e12],[e21,e22],[e31,e32],[e41,e42]]).", "solution": "The problem requires solving the Hartree-Fock-Roothaan (HFR) equations for the hydrogen molecule, $H_2$, in a minimal basis. The general form of these equations is the generalized eigenvalue problem:\n$$F \\mathbf{c} = S \\mathbf{c} \\varepsilon$$\nwhere $F$ is the Fock matrix, $S$ is the overlap matrix, $\\mathbf{c}$ is the vector of molecular orbital coefficients, and $\\varepsilon$ represents the orbital energies. The problem instructs us to make the simplifying, though physically incorrect, assumption that the basis functions are orthonormal. This implies setting the overlap matrix $S$ to the identity matrix $I$, which reduces the HFR equation to the standard eigenvalue problem:\n$$F \\mathbf{c} = \\varepsilon \\mathbf{c}$$\nOur task is to find the eigenvalues $\\varepsilon$ for several given $2 \\times 2$ Fock matrices.\n\nFor a general $2 \\times 2$ matrix $M = \\begin{pmatrix} m_{11} & m_{12} \\\\ m_{21} & m_{22} \\end{pmatrix}$, the eigenvalues $\\varepsilon$ are the roots of the characteristic polynomial $\\det(M - \\varepsilon I) = 0$.\n$$\n\\det \\begin{pmatrix} m_{11} - \\varepsilon & m_{12} \\\\ m_{21} & m_{22} - \\varepsilon \\end{pmatrix} = (m_{11} - \\varepsilon)(m_{22} - \\varepsilon) - m_{12}m_{21} = 0\n$$\nIn this problem, all provided Fock matrices $F$ are real and symmetric, with the specific structure derived from the symmetry of the $H_2$ molecule:\n$$\nF = \\begin{pmatrix} a & b \\\\ b & a \\end{pmatrix}\n$$\nwhere $a = -0.5$ and $b$ is a negative real number representing the resonance integral, which depends on the internuclear distance $R$.\n\nThe characteristic equation for this specific form is:\n$$\n(a - \\varepsilon)^2 - b^2 = 0\n$$\nThis leads to a simple analytical solution for the eigenvalues:\n$$\na - \\varepsilon = \\pm b\n$$\n$$\n\\varepsilon = a \\mp b\n$$\nThe two molecular orbital energies are therefore $\\varepsilon_1 = a - b$ and $\\varepsilon_2 = a + b$. Since $b$ is negative in all given cases, $a+b$ will correspond to the lower energy (bonding) orbital, and $a-b$ will correspond to the higher energy (antibonding) orbital. The task requires reporting them in ascending order, which is $[\\varepsilon_2, \\varepsilon_1]$.\n\nLet us demonstrate the procedure for Case 1 ($R = 0.5$ Bohr):\nThe Fock matrix is given as:\n$$\nF^{(1)} = \\begin{pmatrix} -0.5 & -0.8402976848102109 \\\\ -0.8402976848102109 & -0.5 \\end{pmatrix}\n$$\nHere, $a = -0.5$ and $b = -0.8402976848102109$.\nThe orbital energies are:\n$$\n\\varepsilon_{lower} = a + b = -0.5 + (-0.8402976848102109) = -1.3402976848102109 \\, \\text{Hartree}\n$$\n$$\n\\varepsilon_{upper} = a - b = -0.5 - (-0.8402976848102109) = 0.3402976848102109 \\, \\text{Hartree}\n$$\nRounding these values to six decimal places, we obtain $-1.340298$ and $0.340298$.\n\nApplying this same rigorous procedure to all four cases yields the following molecular orbital energies, sorted in ascending order and rounded to six decimal places:\n\nCase $1$ ($R=0.5$ Bohr): $[-1.340298, 0.340298]$\nCase $2$ ($R=1.4$ Bohr): $[-1.158825, 0.158825]$\nCase $3$ ($R=2.0$ Bohr): $[-1.013146, 0.013146]$\nCase $4$ ($R=4.0$ Bohr): $[-0.665604, -0.334396]$\n\nA numerical program will be written to perform these calculations systematically, ensuring precision and adherence to the specified output format. The program will diagonalize each matrix $F^{(i)}$ to find its eigenvalues, sort them, round them, and format the results as requested. This computational approach is equivalent to the analytical derivation demonstrated.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the standard eigenvalue problem F c = e c for a series of\n    2x2 real symmetric Fock matrices F, representing the H2 molecule\n    under the incorrect assumption of an orthonormal basis.\n    \"\"\"\n\n    # Define the Fock matrices for the four test cases from the problem statement.\n    # The overlap matrices S are ignored as per the problem's instructions.\n    test_cases = [\n        # Case 1 (R = 0.5 Bohr)\n        np.array([\n            [-0.5, -0.8402976848102109],\n            [-0.8402976848102109, -0.5]\n        ]),\n        # Case 2 (R = 1.4 Bohr)\n        np.array([\n            [-0.5, -0.658824888663992],\n            [-0.658824888663992, -0.5]\n        ]),\n        # Case 3 (R = 2.0 Bohr)\n        np.array([\n            [-0.5, -0.5131462822721565],\n            [-0.5131462822721565, -0.5]\n        ]),\n        # Case 4 (R = 4.0 Bohr)\n        np.array([\n            [-0.5, -0.16560390161897155],\n            [-0.16560390161897155, -0.5]\n        ])\n    ]\n\n    all_results = []\n    for F_matrix in test_cases:\n        # For a real symmetric matrix, np.linalg.eigvalsh is efficient and\n        # returns the eigenvalues in ascending order.\n        eigenvalues = np.linalg.eigvalsh(F_matrix)\n        \n        # Round each eigenvalue to six decimal places.\n        rounded_eigenvalues = np.round(eigenvalues, 6).tolist()\n        \n        all_results.append(rounded_eigenvalues)\n\n    # Format the final output string to match the specified format precisely.\n    # The string representation of the list is manipulated to remove all spaces.\n    # Example: '[[val1, val2], [val3, val4]]' -> '[[val1,val2],[val3,val4]]'\n    final_output_string = str(all_results).replace(\" \", \"\")\n\n    # Final print statement in the exact required format.\n    print(final_output_string)\n\nsolve()\n```", "id": "2464744"}, {"introduction": "The power of the Hartree-Fock method is governed by the variational principle, which states that the calculated energy is always an upper bound to the true ground-state energy. The quality of this result, however, is fundamentally limited by the flexibility of the chosen basis set. This exercise provides a striking hands-on demonstration of this concept by tasking you with calculating the ground-state energy of a hydrogen atom using a basis set composed exclusively of $p$-type orbitals [@problem_id:2464734]. Since this basis is inherently incapable of describing the true spherical $1s$ ground state, this calculation reveals the practical consequences of a physically inappropriate basis set and deepens your intuition for the interplay between basis set selection and the variational principle.", "problem": "You are asked to implement a complete, runnable program that determines the lowest Hartree-Fock total energy for a one-electron hydrogen atom using the Hartree-Fock-Roothaan (HFR) equations with a basis set composed exclusively of Cartesian $p$-type Gaussian-type orbitals (GTOs). The system is a single nucleus with charge $Z=1$ located at the origin, and a single electron. The one-electron Hamiltonian operator is $h(\\mathbf{r}) = -\\tfrac{1}{2}\\nabla^2 - \\tfrac{Z}{r}$, where $r = \\lVert \\mathbf{r} \\rVert$ and all quantities are in atomic units. The basis consists only of unnormalized Cartesian $p$-type primitives centered on the nucleus, with functions\n$\\phi_{p_x}(\\alpha,\\mathbf{r}) = x \\exp(-\\alpha r^2)$, $\\phi_{p_y}(\\alpha,\\mathbf{r}) = y \\exp(-\\alpha r^2)$, and $\\phi_{p_z}(\\alpha,\\mathbf{r}) = z \\exp(-\\alpha r^2)$,\nfor each exponent $\\alpha$ in a provided set. You must construct the one-electron integral matrices required by the Hartree-Fock-Roothaan framework directly from first principles as integrals over $\\mathbb{R}^3$:\n- the overlap matrix elements $S_{\\mu\\nu} = \\int \\phi_{\\mu}(\\mathbf{r}) \\, \\phi_{\\nu}(\\mathbf{r}) \\, d^3\\mathbf{r}$,\n- the kinetic energy matrix elements $T_{\\mu\\nu} = -\\tfrac{1}{2} \\int \\phi_{\\mu}(\\mathbf{r}) \\, \\nabla^2 \\phi_{\\nu}(\\mathbf{r}) \\, d^3\\mathbf{r}$,\n- the nuclear attraction matrix elements $V_{\\mu\\nu} = \\int \\phi_{\\mu}(\\mathbf{r}) \\, \\left(-\\tfrac{Z}{r}\\right) \\, \\phi_{\\nu}(\\mathbf{r}) \\, d^3\\mathbf{r}$,\nand the core Hamiltonian matrix $H_{\\mu\\nu} = T_{\\mu\\nu} + V_{\\mu\\nu}$. For a one-electron system, there are no two-electron contributions and the Hartree-Fock total energy equals the lowest eigenvalue obtained from the Hartree-Fock-Roothaan condition. Using only the information herein, determine the lowest energy value in Hartree for each of the specified test cases.\n\nImportant requirements:\n- All energies must be expressed in Hartree, rounded to $6$ decimal places.\n- Use unnormalized Cartesian GTOs as defined above, all centered at the nucleus at the origin, and do not introduce any functions other than the $p$-type primitives.\n- Treat each provided set of exponents as defining a basis composed of three Cartesian $p$-type primitives per exponent (one each for $p_x$, $p_y$, and $p_z$), all centered on the nucleus.\n- An energy is physically admissible for a bound electron in this potential if it is strictly less than $0$ Hartree. The program’s output should report only the lowest energy per test case; no additional flags are required in the output.\n\nTest suite:\n- Case $1$: $\\{\\alpha\\} = \\{1.0\\}$.\n- Case $2$: $\\{\\alpha\\} = \\{10.0\\}$.\n- Case $3$: $\\{\\alpha\\} = \\{0.05\\}$.\n- Case $4$: $\\{\\alpha\\} = \\{0.3, 1.5\\}$.\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the same order as the cases above. Each entry must be the lowest energy for that case, in Hartree, rounded to $6$ decimal places. For example, a syntactically correct output line has the form $[\\varepsilon_1,\\varepsilon_2,\\varepsilon_3,\\varepsilon_4]$, where each $\\varepsilon_k$ is a floating-point number with exactly $6$ digits after the decimal point.", "solution": "The problem requires the calculation of the lowest Hartree-Fock energy for a one-electron hydrogen atom ($Z=1$) using a basis set of unnormalized Cartesian $p$-type Gaussian-type orbitals (GTOs). For a one-electron system, the Hartree-Fock-Roothaan (HFR) equations simplify significantly. The two-electron repulsion integrals vanish, and the Fock matrix $\\mathbf{F}$ becomes identical to the core Hamiltonian matrix $\\mathbf{H}$, which is the sum of the kinetic energy matrix $\\mathbf{T}$ and the nuclear attraction matrix $\\mathbf{V}$. The problem thus reduces to solving the generalized eigenvalue equation:\n$$\n\\mathbf{H} \\mathbf{C} = \\mathbf{S} \\mathbf{C} \\boldsymbol{\\epsilon}\n$$\nwhere $\\mathbf{S}$ is the overlap matrix, $\\mathbf{C}$ is the matrix of molecular orbital coefficients, and $\\boldsymbol{\\epsilon}$ is the diagonal matrix of orbital energies. The total energy of the system is the energy of the single occupied orbital, which, according to the variational principle, is the lowest eigenvalue $\\epsilon_{\\min}$ from the solution of this equation.\n\nThe basis consists of unnormalized Cartesian p-type GTOs centered at the origin:\n$$\n\\phi_{p_x}(\\alpha, \\mathbf{r}) = x \\exp(-\\alpha r^2) \\\\\n\\phi_{p_y}(\\alpha, \\mathbf{r}) = y \\exp(-\\alpha r^2) \\\\\n\\phi_{p_z}(\\alpha, \\mathbf{r}) = z \\exp(-\\alpha r^2)\n$$\nA given set of exponents $\\{\\alpha_1, \\alpha_2, \\dots, \\alpha_N\\}$ defines a basis of size $3N$. However, due to the symmetry of the Hamiltonian and the basis functions, the matrices $\\mathbf{S}$, $\\mathbf{T}$, and $\\mathbf{V}$ are block-diagonal, consisting of three identical blocks corresponding to the $p_x$, $p_y$, and $p_z$ functions. Consequently, the eigenvalues will be triply degenerate, and we only need to construct and solve the $N \\times N$ problem for one block, for instance, the $p_x$ block.\n\nThe matrix elements are derived from first principles by evaluating three-dimensional integrals over all space. Let two basis functions be $\\phi_i(\\mathbf{r}) = x \\exp(-\\alpha_i r^2)$ and $\\phi_j(\\mathbf{r}) = x \\exp(-\\alpha_j r^2)$. Let $p_{ij} = \\alpha_i + \\alpha_j$.\n\n1.  **Overlap Matrix Elements, $S_{ij}$**:\n    The overlap integral is given by $S_{ij} = \\int \\phi_i(\\mathbf{r}) \\phi_j(\\mathbf{r}) d^3\\mathbf{r}$.\n    $$\n    S_{ij} = \\int x^2 \\exp(-p_{ij} r^2) d^3\\mathbf{r}\n    $$\n    This integral is solved by separation of variables:\n    $$\n    S_{ij} = \\left(\\int_{-\\infty}^{\\infty} x^2 e^{-p_{ij}x^2} dx\\right) \\left(\\int_{-\\infty}^{\\infty} e^{-p_{ij}y^2} dy\\right) \\left(\\int_{-\\infty}^{\\infty} e^{-p_{ij}z^2} dz\\right)\n    $$\n    Using the standard Gaussian integral formulas $\\int_{-\\infty}^{\\infty} e^{-ax^2} dx = \\sqrt{\\pi/a}$ and $\\int_{-\\infty}^{\\infty} x^2 e^{-ax^2} dx = \\frac{1}{2a}\\sqrt{\\pi/a}$, we obtain:\n    $$\n    S_{ij} = \\left(\\frac{1}{2p_{ij}}\\sqrt{\\frac{\\pi}{p_{ij}}}\\right) \\left(\\sqrt{\\frac{\\pi}{p_{ij}}}\\right) \\left(\\sqrt{\\frac{\\pi}{p_{ij}}}\\right) = \\frac{1}{2p_{ij}} \\left(\\frac{\\pi}{p_{ij}}\\right)^{3/2} = \\frac{\\pi^{3/2}}{2 p_{ij}^{5/2}}\n    $$\n\n2.  **Kinetic Energy Matrix Elements, $T_{ij}$**:\n    The kinetic energy integral is $T_{ij} = -\\frac{1}{2} \\int \\phi_i(\\mathbf{r}) \\nabla^2 \\phi_j(\\mathbf{r}) d^3\\mathbf{r}$. Using the Hermitian property of the kinetic energy operator, this is equivalent to $T_{ij} = \\frac{1}{2} \\int (\\nabla \\phi_i(\\mathbf{r})) \\cdot (\\nabla \\phi_j(\\mathbf{r})) d^3\\mathbf{r}$. Evaluation of this integral yields:\n    $$\n    T_{ij} = \\frac{5 \\alpha_i \\alpha_j}{p_{ij}} S_{ij} = \\frac{5 \\alpha_i \\alpha_j}{\\alpha_i + \\alpha_j} S_{ij}\n    $$\n\n3.  **Nuclear Attraction Matrix Elements, $V_{ij}$**:\n    The nuclear attraction integral for a nucleus of charge $Z$ at the origin is $V_{ij} = -Z \\int \\phi_i(\\mathbf{r}) \\frac{1}{r} \\phi_j(\\mathbf{r}) d^3\\mathbf{r}$. With $Z=1$:\n    $$\n    V_{ij} = - \\int \\frac{x^2}{r} \\exp(-p_{ij} r^2) d^3\\mathbf{r}\n    $$\n    This integral can be solved in spherical coordinates or by using the Gaussian integral transform for $1/r$. The result is:\n    $$\n    V_{ij} = -\\frac{2\\pi}{3 p_{ij}^2}\n    $$\n\nThe core Hamiltonian matrix elements are $H_{ij} = T_{ij} + V_{ij}$. For each test case defined by a set of exponents $\\{\\alpha_k\\}$, we construct the $N \\times N$ matrices $\\mathbf{S}$ and $\\mathbf{H}$ using the formulas above. The generalized eigenvalue problem is then solved numerically using `scipy.linalg.eigh` to find the orbital energies $\\epsilon$. The lowest of these eigenvalues is the required ground-state energy for the given p-orbital basis.\n\nThe computational procedure is as follows:\n1.  For a given test case with $N$ exponents $\\{\\alpha_1, \\dots, \\alpha_N\\}$, initialize $N \\times N$ matrices $\\mathbf{S}$ and $\\mathbf{H}$.\n2.  Iterate over all pairs $(i, j)$ to compute the matrix elements $S_{ij}$ and $H_{ij} = T_{ij} + V_{ij}$.\n3.  Solve the generalized eigenvalue problem $\\mathbf{H}\\mathbf{C} = \\boldsymbol{\\epsilon}\\mathbf{S}\\mathbf{C}$ for the eigenvalues $\\epsilon_k$.\n4.  The lowest eigenvalue, $\\min_k(\\epsilon_k)$, is the result for the given test case.\n5.  The final result is rounded to $6$ decimal places as required.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import eigh\n\ndef solve():\n    \"\"\"\n    Calculates the lowest Hartree-Fock energy for a hydrogen atom using a\n    basis of Cartesian p-type GTOs.\n    \"\"\"\n    # Test cases defined as lists of alpha exponents.\n    test_cases = [\n        [1.0],         # Case 1\n        [10.0],        # Case 2\n        [0.05],        # Case 3\n        [0.3, 1.5],    # Case 4\n    ]\n\n    results = []\n    Z = 1.0  # Nuclear charge for hydrogen atom\n\n    for alphas in test_cases:\n        n_basis = len(alphas)\n        S = np.zeros((n_basis, n_basis))\n        H = np.zeros((n_basis, n_basis))\n\n        # Construct the overlap (S) and core Hamiltonian (H) matrices.\n        # The problem reduces to an N x N system for p_x orbitals due to symmetry,\n        # yielding triply degenerate eigenvalues.\n        for i in range(n_basis):\n            for j in range(i, n_basis):\n                alpha_i = alphas[i]\n                alpha_j = alphas[j]\n                p_ij = alpha_i + alpha_j\n\n                # Overlap matrix element S_ij\n                # S_ij = integral(x*exp(-ai*r^2) * x*exp(-aj*r^2) dV)\n                # Formula: pi^(3/2) / (2 * p_ij^(5/2))\n                s_ij = (np.pi**1.5) / (2 * p_ij**2.5)\n                S[i, j] = S[j, i] = s_ij\n\n                # Kinetic energy matrix element T_ij\n                # T_ij = -1/2 * integral(phi_i * grad^2(phi_j) dV)\n                # Simplified relation: T_ij = (5 * alpha_i * alpha_j / p_ij) * S_ij\n                t_ij = (5.0 * alpha_i * alpha_j / p_ij) * s_ij\n                \n                # Nuclear attraction matrix element V_ij\n                # V_ij = integral(phi_i * (-Z/r) * phi_j dV)\n                # Formula: -2 * pi * Z / (3 * p_ij^2)\n                v_ij = (-2.0 * np.pi * Z) / (3.0 * p_ij**2)\n                \n                # Core Hamiltonian matrix element H_ij\n                H[i, j] = H[j, i] = t_ij + v_ij\n\n        # Solve the generalized eigenvalue problem H*C = S*C*e\n        # where 'e' are the orbital energies.\n        # eigh is used for Hermitian matrices; S and H are real symmetric.\n        try:\n            eigenvalues = eigh(H, S, eigvals_only=True)\n            lowest_energy = np.min(eigenvalues)\n        except np.linalg.LinAlgError:\n            # This might happen if the overlap matrix S is singular,\n            # which indicates a poorly chosen (linearly dependent) basis set.\n            lowest_energy = np.nan\n\n        results.append(lowest_energy)\n\n    # Format the results to 6 decimal places and print in the required format.\n    formatted_results = [f\"{res:.6f}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2464734"}]}