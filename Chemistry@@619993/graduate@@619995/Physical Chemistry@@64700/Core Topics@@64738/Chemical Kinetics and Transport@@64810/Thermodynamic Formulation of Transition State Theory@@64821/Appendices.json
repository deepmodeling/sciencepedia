{"hands_on_practices": [{"introduction": "A powerful aspect of Transition State Theory (TST) is its ability to connect with and provide a deeper physical meaning to the parameters of empirical rate laws, such as the Arrhenius equation. While the Arrhenius activation energy, $E_a$, is a cornerstone of experimental kinetics, TST allows us to interpret it in terms of thermodynamic state functions. This first exercise provides practice in bridging these two formalisms by relating the experimentally measured $E_a$ to the enthalpy of activation, $\\Delta H^{\\ddagger}$, a central quantity in the thermodynamic formulation of TST [@problem_id:1526797].", "problem": "A physical chemist is studying the kinetics of a unimolecular isomerization reaction of an organic molecule dissolved in an inert solvent. By measuring the reaction rate constant at various temperatures, they determine that the reaction follows the Arrhenius equation and has an experimental activation energy, $E_a$, of $95.5 \\, \\text{kJ/mol}$. Assuming the reaction can be described by transition state theory for reactions in solution, calculate the enthalpy of activation, $\\Delta H^{\\ddagger}$, for this process at a temperature of $298.15 \\, \\text{K}$. Use the ideal gas constant $R = 8.314 \\, \\text{J K}^{-1} \\text{mol}^{-1}$.\n\nExpress your final answer in kJ/mol, rounded to three significant figures.", "solution": "The problem requires us to find the enthalpy of activation, $\\Delta H^{\\ddagger}$, given the Arrhenius activation energy, $E_a$, for a unimolecular reaction taking place in solution. The relationship between these two quantities can be derived by comparing the Arrhenius equation and the Eyring-Polanyi equation from transition state theory.\n\nThe Arrhenius equation describes the temperature dependence of the rate constant $k$:\n$$k = A \\exp\\left(-\\frac{E_a}{RT}\\right)$$\nwhere $A$ is the pre-exponential factor, $E_a$ is the activation energy, $R$ is the ideal gas constant, and $T$ is the absolute temperature.\n\nThe Arrhenius activation energy is formally defined as:\n$$E_a = RT^2 \\frac{d(\\ln k)}{dT}$$\n\nThe Eyring-Polanyi equation from transition state theory expresses the rate constant in terms of thermodynamic activation parameters:\n$$k = \\frac{k_B T}{h} \\exp\\left(-\\frac{\\Delta G^{\\ddagger}}{RT}\\right)$$\nwhere $k_B$ is the Boltzmann constant, $h$ is the Planck constant, and $\\Delta G^{\\ddagger}$ is the Gibbs free energy of activation.\n\nWe can express $\\Delta G^{\\ddagger}$ in terms of the enthalpy of activation, $\\Delta H^{\\ddagger}$, and the entropy of activation, $\\Delta S^{\\ddagger}$: $\\Delta G^{\\ddagger} = \\Delta H^{\\ddagger} - T\\Delta S^{\\ddagger}$. Substituting this into the Eyring-Polanyi equation gives:\n$$k = \\frac{k_B T}{h} \\exp\\left(-\\frac{\\Delta H^{\\ddagger} - T\\Delta S^{\\ddagger}}{RT}\\right) = \\frac{k_B T}{h} \\exp\\left(\\frac{\\Delta S^{\\ddagger}}{R}\\right) \\exp\\left(-\\frac{\\Delta H^{\\ddagger}}{RT}\\right)$$\n\nTo find the relationship between $E_a$ and $\\Delta H^{\\ddagger}$, we take the natural logarithm of the Eyring-Polanyi equation:\n$$\\ln k = \\ln\\left(\\frac{k_B}{h}\\right) + \\ln T + \\frac{\\Delta S^{\\ddagger}}{R} - \\frac{\\Delta H^{\\ddagger}}{RT}$$\n\nNow, we differentiate $\\ln k$ with respect to $T$, assuming $\\Delta H^{\\ddagger}$ and $\\Delta S^{\\ddagger}$ are approximately independent of temperature:\n$$\\frac{d(\\ln k)}{dT} = \\frac{d}{dT}\\left[\\ln\\left(\\frac{k_B}{h}\\right) + \\ln T + \\frac{\\Delta S^{\\ddagger}}{R} - \\frac{\\Delta H^{\\ddagger}}{RT}\\right]$$\n$$\\frac{d(\\ln k)}{dT} = 0 + \\frac{1}{T} + 0 - \\left(-\\frac{\\Delta H^{\\ddagger}}{RT^2}\\right) = \\frac{1}{T} + \\frac{\\Delta H^{\\ddagger}}{RT^2}$$\n\nSubstituting this expression back into the definition of $E_a$:\n$$E_a = RT^2 \\left(\\frac{1}{T} + \\frac{\\Delta H^{\\ddagger}}{RT^2}\\right)$$\n$$E_a = RT + \\Delta H^{\\ddagger}$$\n\nThis relationship, $E_a = \\Delta H^{\\ddagger} + RT$, is generally used for all reactions (unimolecular or bimolecular) that occur in the liquid phase (solution).\n\nThe problem asks for $\\Delta H^{\\ddagger}$, so we rearrange the equation:\n$$\\Delta H^{\\ddagger} = E_a - RT$$\n\nNow, we can substitute the given values. First, we must ensure all units are consistent. Since $E_a$ is in kJ/mol, we should convert $R$ to kJ K$^{-1}$ mol$^{-1}$.\nGiven values:\n$E_a = 95.5 \\, \\text{kJ/mol}$\n$T = 298.15 \\, \\text{K}$\n$R = 8.314 \\, \\text{J K}^{-1} \\text{mol}^{-1} = 8.314 \\times 10^{-3} \\, \\text{kJ K}^{-1} \\text{mol}^{-1}$\n\nCalculate the term $RT$:\n$$RT = (8.314 \\times 10^{-3} \\, \\text{kJ K}^{-1} \\text{mol}^{-1}) \\times (298.15 \\, \\text{K})$$\n$$RT \\approx 2.4788 \\, \\text{kJ/mol}$$\n\nNow, calculate $\\Delta H^{\\ddagger}$:\n$$\\Delta H^{\\ddagger} = 95.5 \\, \\text{kJ/mol} - 2.4788 \\, \\text{kJ/mol}$$\n$$\\Delta H^{\\ddagger} \\approx 93.0212 \\, \\text{kJ/mol}$$\n\nThe problem requires the answer to be rounded to three significant figures.\n$$\\Delta H^{\\ddagger} \\approx 93.0 \\, \\text{kJ/mol}$$", "answer": "$$\\boxed{93.0}$$", "id": "1526797"}, {"introduction": "The thermodynamic framework of TST provides an elegant and comprehensive picture of a reaction's energy landscape, encompassing both the forward and reverse pathways. The principle of microscopic reversibility implies a strict relationship between the kinetics of a forward reaction and its reverse counterpart, governed by the overall thermodynamics of the system. This practice explores this fundamental connection by tasking you to determine the activation parameters for a reverse reaction using the known parameters for the forward reaction and the overall reaction enthalpy and entropy [@problem_id:1526820].", "problem": "The isomerization of molecules is a fundamental process in many areas of chemistry, from materials science to biology. Consider the reversible isomerization reaction between two conformers of a molecule, denoted as A and B, occurring in a solvent at a standard temperature and pressure:\n$$\n\\text{A} \\rightleftharpoons \\text{B}\n$$\nBased on the thermodynamic formulation of Transition State Theory, the activation parameters for the forward reaction (A $\\rightarrow$ B) have been experimentally determined. The standard enthalpy of activation is $\\Delta H_f^\\ddagger = +78.6 \\text{ kJ/mol}$, and the standard entropy of activation is $\\Delta S_f^\\ddagger = -21.4 \\text{ J/(mol·K)}$.\n\nFurthermore, the overall thermodynamics of the reaction have been characterized. The standard reaction enthalpy is $\\Delta H^\\circ = -15.2 \\text{ kJ/mol}$, and the standard reaction entropy is $\\Delta S^\\circ = +8.9 \\text{ J/(mol·K)}$.\n\nYour task is to calculate the standard enthalpy of activation, $\\Delta H_r^\\ddagger$, and the standard entropy of activation, $\\Delta S_r^\\ddagger$, for the reverse reaction (B $\\rightarrow$ A).\n\nExpress the activation enthalpy in kJ/mol and the activation entropy in J/(mol·K). Present your two answers, in that order, rounded to three significant figures.", "solution": "This problem asks for the activation parameters of a reverse reaction given the parameters for the forward reaction and the overall thermodynamics of the process. We will use the relationships derived from the thermodynamic formulation of Transition State Theory.\n\nLet $H_A$ and $S_A$ be the standard molar enthalpy and entropy of reactant A, $H_B$ and $S_B$ be those for product B, and $H_{TS}$ and $S_{TS}$ be those for the transition state.\n\nThe overall standard reaction enthalpy, $\\Delta H^\\circ$, and entropy, $\\Delta S^\\circ$, are defined as the difference between the products and reactants:\n$$\n\\Delta H^\\circ = H_B - H_A\n$$\n$$\n\\Delta S^\\circ = S_B - S_A\n$$\n\nThe standard enthalpy and entropy of activation for the forward reaction, A $\\rightarrow$ B, are defined as the difference between the transition state and the reactant A:\n$$\n\\Delta H_f^\\ddagger = H_{TS} - H_A\n$$\n$$\n\\Delta S_f^\\ddagger = S_{TS} - S_A\n$$\n\nSimilarly, the standard enthalpy and entropy of activation for the reverse reaction, B $\\rightarrow$ A, are defined as the difference between the transition state and the reactant B (which is the product of the forward reaction):\n$$\n\\Delta H_r^\\ddagger = H_{TS} - H_B\n$$\n$$\n\\Delta S_r^\\ddagger = S_{TS} - S_B\n$$\n\nOur goal is to find $\\Delta H_r^\\ddagger$ and $\\Delta S_r^\\ddagger$. We can derive expressions for these quantities in terms of the given parameters.\n\nFor the enthalpy of activation of the reverse reaction, $\\Delta H_r^\\ddagger$:\nWe can write $H_B$ in terms of $H_A$ and $\\Delta H^\\circ$ as $H_B = H_A + \\Delta H^\\circ$. Substituting this into the expression for $\\Delta H_r^\\ddagger$:\n$$\n\\Delta H_r^\\ddagger = H_{TS} - (H_A + \\Delta H^\\circ) = (H_{TS} - H_A) - \\Delta H^\\circ\n$$\nRecognizing that $(H_{TS} - H_A)$ is the definition of $\\Delta H_f^\\ddagger$, we get the relationship:\n$$\n\\Delta H_r^\\ddagger = \\Delta H_f^\\ddagger - \\Delta H^\\circ\n$$\n\nNow, we substitute the given numerical values:\n$\\Delta H_f^\\ddagger = +78.6 \\text{ kJ/mol}$\n$\\Delta H^\\circ = -15.2 \\text{ kJ/mol}$\n$$\n\\Delta H_r^\\ddagger = (+78.6 \\text{ kJ/mol}) - (-15.2 \\text{ kJ/mol}) = 78.6 + 15.2 = 93.8 \\text{ kJ/mol}\n$$\nRounding to three significant figures, $\\Delta H_r^\\ddagger = 93.8 \\text{ kJ/mol}$.\n\nNext, for the entropy of activation of the reverse reaction, $\\Delta S_r^\\ddagger$:\nUsing the same logic, we write $S_B$ in terms of $S_A$ and $\\Delta S^\\circ$ as $S_B = S_A + \\Delta S^\\circ$. Substituting this into the expression for $\\Delta S_r^\\ddagger$:\n$$\n\\Delta S_r^\\ddagger = S_{TS} - (S_A + \\Delta S^\\circ) = (S_{TS} - S_A) - \\Delta S^\\circ\n$$\nRecognizing that $(S_{TS} - S_A)$ is the definition of $\\Delta S_f^\\ddagger$, we get the relationship:\n$$\n\\Delta S_r^\\ddagger = \\Delta S_f^\\ddagger - \\Delta S^\\circ\n$$\n\nNow, we substitute the given numerical values:\n$\\Delta S_f^\\ddagger = -21.4 \\text{ J/(mol·K)}$\n$\\Delta S^\\circ = +8.9 \\text{ J/(mol·K)}$\n$$\n\\Delta S_r^\\ddagger = (-21.4 \\text{ J/(mol·K)}) - (+8.9 \\text{ J/(mol·K)}) = -21.4 - 8.9 = -30.3 \\text{ J/(mol·K)}\n$$\nRounding to three significant figures, $\\Delta S_r^\\ddagger = -30.3 \\text{ J/(mol·K)}$.\n\nThe calculated values are an activation enthalpy of 93.8 kJ/mol and an activation entropy of -30.3 J/(mol·K) for the reverse reaction.", "answer": "$$\\boxed{\\begin{pmatrix} 93.8 & -30.3 \\end{pmatrix}}$$", "id": "1526820"}, {"introduction": "Moving beyond simple analytical models, Transition State Theory finds its modern application as a cornerstone of computational chemistry for predicting reaction rates. In complex systems, the free energy landscape is often computed numerically, and the \"best\" transition state must be found variationally. This advanced, hands-on exercise simulates a real-world research scenario where you will implement Canonical Variational TST (CVT) to compute a rate constant from a discretized potential of mean force and, crucially, propagate numerical uncertainties using a bootstrap method to estimate the confidence in your result [@problem_id:2682419].", "problem": "You are given a discretized potential of mean force represented by the molar Gibbs free energy profile $G(\\xi)$ obtained from umbrella sampling along a scalar reaction coordinate $\\xi$. Your task is to derive, implement, and evaluate a numerical procedure to compute the Canonical Variational Transition State Theory (CVT) unimolecular rate constant $k_{\\mathrm{CVT}}(T)$ at temperature $T$ using the thermodynamic formulation of Transition State Theory (TST), and to estimate its statistical uncertainty from reported uncertainties in $G(\\xi)$.\n\nStarting point for derivation: Use only fundamental principles of equilibrium statistical mechanics and thermodynamics, including (but not limited to) the canonical ensemble, partition functions, free energy definitions, and the relationship between constrained partition functions and probabilities along a reaction coordinate. You may assume the following:\n- The reaction coordinate $\\xi$ parametrizes a family of candidate dividing surfaces that forbid recrossing by construction when used in the TST approximation.\n- The molar Gibbs free energy $G(\\xi)$ is the reversible work (potential of mean force) along $\\xi$ up to an additive constant, and is related to the marginal probability density along $\\xi$ in the canonical ensemble.\n- Dynamical recrossing corrections and tunneling corrections are neglected (i.e., assume a transmission coefficient equal to $1$ and no quantum tunneling).\n\nDefinitions and constraints for numerical evaluation:\n- Let the discrete grid be $\\{\\xi_i\\}_{i=1}^{N}$ with corresponding $G_i \\equiv G(\\xi_i)$ and standard deviations $\\sigma_i$ for each $G_i$, assumed statistically independent and Gaussian.\n- Define a reactant-basin window by an index $i \\in \\{1,\\dots,r\\}$ with a provided index $r$; the reactant reference free energy $G_{\\mathrm{R}}$ is the minimum of $\\{G_i\\}_{i=1}^{r}$. The set of admissible dividing surfaces is the set of indices $\\{r+1, r+2, \\dots, N\\}$.\n- Use consistent units so that exponents are dimensionless. The $G_i$ values are provided in $\\mathrm{kJ \\cdot mol^{-1}}$. Use the molar gas constant $R$ in $\\mathrm{J \\cdot mol^{-1} \\cdot K^{-1}}$. Use the Boltzmann constant $k_{\\mathrm{B}}$ in $\\mathrm{J \\cdot K^{-1}}$ and Planck’s constant $h$ in $\\mathrm{J \\cdot s}$.\n\nTasks:\n1. From thermodynamic first principles, derive an expression for the TST rate associated with a dividing surface at $\\xi$, written in terms of $G(\\xi)$, the reactant reference free energy, and fundamental constants. Then, explain how the CVT rate constant $k_{\\mathrm{CVT}}(T)$ arises from minimizing over the admissible dividing surfaces.\n2. Given discrete $\\{G_i\\}$, provide a numerically stable algorithm to compute $k_{\\mathrm{CVT}}(T)$ using only the provided arrays and constants, ensuring unit consistency.\n3. Statistical uncertainty: Assume each $G_i$ is an independent normal random variable with mean $G_i$ and standard deviation $\\sigma_i$. Use a parametric bootstrap with $N_{\\mathrm{boot}}$ replicates to estimate the mean and standard deviation of $k_{\\mathrm{CVT}}(T)$. Use a fixed random seed for reproducibility.\n4. Reporting: For each test case, report two floats: the bootstrap mean of $k_{\\mathrm{CVT}}(T)$ in $\\mathrm{s^{-1}}$ and the bootstrap standard deviation in $\\mathrm{s^{-1}}$. Round each float to $6$ significant figures. The final program output must be a single line containing a comma-separated Python-style list with the flattened results for all test cases in order, i.e., $[k_1, u_1, k_2, u_2, \\dots]$ where $k_j$ is the bootstrap mean and $u_j$ is the bootstrap standard deviation for test case $j$.\n\nConstants to use:\n- Boltzmann constant $k_{\\mathrm{B}} = 1.380649 \\times 10^{-23}\\ \\mathrm{J \\cdot K^{-1}}$.\n- Planck constant $h = 6.62607015 \\times 10^{-34}\\ \\mathrm{J \\cdot s}$.\n- Molar gas constant $R = 8.314462618\\ \\mathrm{J \\cdot mol^{-1} \\cdot K^{-1}}$.\n\nBootstrap configuration:\n- Number of bootstrap replicates $N_{\\mathrm{boot}} = 5000$.\n- Random seed $= 12345$.\n\nTest suite:\nProvide results for the following three cases. In all cases, indices are $1$-based in the description but you will implement them in zero-based arrays in code.\n- Case $1$ (happy path; moderate barrier):\n  - Temperature $T = 300\\ \\mathrm{K}$.\n  - Grid $\\xi_i$: $N = 11$ points, $\\xi = \\{0.0, 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1.0\\}$.\n  - Free energies $G(\\xi)$ in $\\mathrm{kJ \\cdot mol^{-1}}$: $\\{0, 8, 20, 35, 47, 50, 47, 35, 20, 8, 0\\}$.\n  - Standard deviations $\\sigma$ in $\\mathrm{kJ \\cdot mol^{-1}}$: all entries equal to $0.5$.\n  - Reactant window upper index $r = 1$ (i.e., only the first point).\n- Case $2$ (edge case; flat profile with noise):\n  - Temperature $T = 300\\ \\mathrm{K}$.\n  - Grid $\\xi_i$: same as Case $1$.\n  - Free energies $G(\\xi)$ in $\\mathrm{kJ \\cdot mol^{-1}}$: all entries equal to $0$.\n  - Standard deviations $\\sigma$ in $\\mathrm{kJ \\cdot mol^{-1}}$: all entries equal to $0.2$.\n  - Reactant window upper index $r = 1$.\n- Case $3$ (sparse high barrier at elevated temperature):\n  - Temperature $T = 500\\ \\mathrm{K}$.\n  - Grid $\\xi_i$: $N = 5$ points, $\\xi = \\{0.0, 0.25, 0.5, 0.75, 1.0\\}$.\n  - Free energies $G(\\xi)$ in $\\mathrm{kJ \\cdot mol^{-1}}$: $\\{0, 20, 40, 20, 0\\}$.\n  - Standard deviations $\\sigma$ in $\\mathrm{kJ \\cdot mol^{-1}}$: $\\{0.2, 1.0, 2.0, 1.0, 0.2\\}$.\n  - Reactant window upper index $r = 1$.\n\nNumerical requirements:\n- Ensure that all exponentials are computed using consistent units, i.e., convert $\\mathrm{kJ \\cdot mol^{-1}}$ to $\\mathrm{J \\cdot mol^{-1}}$ before forming dimensionless ratios with $R T$.\n- The final rate constant must be reported in $\\mathrm{s^{-1}}$, rounded to $6$ significant figures.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[k_1,u_1,k_2,u_2,k_3,u_3]$), where each $k_j$ and $u_j$ are floats rounded to $6$ significant figures in $\\mathrm{s^{-1}}$.", "solution": "The problem requires the derivation and numerical implementation of a procedure to compute the Canonical Variational Transition State Theory (CVT) rate constant, $k_{\\mathrm{CVT}}(T)$, from a discretized potential of mean force, $G(\\xi)$, and to estimate its statistical uncertainty. The solution proceeds by first validating the problem statement, which is found to be scientifically sound and well-posed. We then present the theoretical derivation, followed by the numerical algorithm and the statistical analysis method.\n\nThe problem is validated as follows:\n- **Givens**: Discretized Gibbs free energy profile $\\{G_i(\\xi_i)\\}_{i=1}^{N}$ with associated uncertainties $\\{\\sigma_i\\}_{i=1}^{N}$, temperature $T$, reactant window definition $r$, fundamental constants $k_{\\mathrm{B}}$, $h$, $R$, and bootstrap parameters $N_{\\mathrm{boot}}$ and seed.\n- **Validation**: The problem is scientifically grounded in established principles of statistical mechanics and chemical kinetics (Transition State Theory). It is well-posed, providing all necessary data and definitions for a unique solution. The formulation is objective and free of ambiguities. No flaws listed in the validation criteria are identified. Therefore, the problem is valid and a solution can be constructed.\n\n**1. Derivation of the CVT Rate Constant from Thermodynamic Principles**\n\nTransition State Theory (TST) provides an expression for the rate constant of a chemical reaction by assuming a quasi-equilibrium between reactants and an \"activated complex\" at a dividing surface separating reactants from products. For a unimolecular reaction in the canonical ensemble, the TST rate constant, $k_{\\mathrm{TST}}$, is given by:\n$$\nk_{\\mathrm{TST}} = \\frac{k_{\\mathrm{B}}T}{h} \\exp\\left(-\\frac{\\Delta G^{\\ddagger}}{RT}\\right)\n$$\nHere, $k_{\\mathrm{B}}$ is the Boltzmann constant ($1.380649 \\times 10^{-23}\\ \\mathrm{J \\cdot K^{-1}}$), $h$ is Planck's constant ($6.62607015 \\times 10^{-34}\\ \\mathrm{J \\cdot s}$), $T$ is the absolute temperature, $R$ is the molar gas constant ($8.314462618\\ \\mathrm{J \\cdot mol^{-1} \\cdot K^{-1}}$), and $\\Delta G^{\\ddagger}$ is the molar Gibbs free energy of activation.\n\nThe potential of mean force, $G(\\xi)$, represents the molar Gibbs free energy of the system as a function of the reaction coordinate $\\xi$. The Gibbs free energy of activation, $\\Delta G^{\\ddagger}(\\xi)$, for a dividing surface located at a specific coordinate $\\xi$, is the difference between the free energy at that surface and the reference free energy of the reactants, $G_{\\mathrm{R}}$:\n$$\n\\Delta G^{\\ddagger}(\\xi) = G(\\xi) - G_{\\mathrm{R}}\n$$\nThe TST rate constant is thus a function of the choice of the dividing surface $\\xi$:\n$$\nk(\\xi, T) = \\frac{k_{\\mathrm{B}}T}{h} \\exp\\left(-\\frac{G(\\xi) - G_{\\mathrm{R}}}{RT}\\right)\n$$\nA key assumption of TST is that any trajectory crossing the dividing surface from the reactant side to the product side will proceed to products without recrossing. This assumption is generally not strictly true, causing TST to provide an upper bound to the true rate constant.\n\nCanonical Variational Transition State Theory (CVT) refines TST by seeking the optimal dividing surface that minimizes the calculated rate constant. By minimizing the rate, one finds the dividing surface that best satisfies the \"no recrossing\" assumption, thus yielding a more accurate rate estimate. The CVT rate constant, $k_{\\mathrm{CVT}}(T)$, is therefore defined as:\n$$\nk_{\\mathrm{CVT}}(T) = \\min_{\\xi} k(\\xi, T)\n$$\nwhere the minimization is performed over all admissible dividing surfaces.\n\nSince the prefactor $\\frac{k_{\\mathrm{B}}T}{h}$ and the denominator $RT$ are positive constants for a given temperature $T$, minimizing $k(\\xi, T)$ is equivalent to maximizing the argument of the exponential, $-(G(\\xi) - G_{\\mathrm{R}})$, which in turn is equivalent to maximizing the free energy barrier, $G(\\xi) - G_{\\mathrm{R}}$. This leads to the central expression for the CVT rate:\n$$\nk_{\\mathrm{CVT}}(T) = \\frac{k_{\\mathrm{B}}T}{h} \\exp\\left(-\\frac{\\left(\\max_{\\xi \\in \\text{DS}} G(\\xi)\\right) - G_{\\mathrm{R}}}{RT}\\right)\n$$\nwhere $\\text{DS}$ denotes the set of admissible dividing surfaces. We define the CVT activation free energy as $\\Delta G_{\\mathrm{CVT}}^{\\ddagger} = \\left(\\max_{\\xi \\in \\text{DS}} G(\\xi)\\right) - G_{\\mathrm{R}}$.\n\n**2. Numerical Algorithm for Discrete Data**\n\nThe problem provides a discrete free energy profile $\\{G_i\\}_{i=1}^{N}$ on a grid $\\{\\xi_i\\}_{i=1}^{N}$. We are given that the reactant basin is defined by indices $i \\in \\{1, \\dots, r\\}$, and the set of admissible dividing surfaces corresponds to indices $i \\in \\{r+1, \\dots, N\\}$. The algorithm to compute $k_{\\mathrm{CVT}}(T)$ is as follows, using $0$-based indexing for implementation as is standard in Python:\n\n- **Step A: Determine Reactant Free Energy ($G_{\\mathrm{R}}$)**\n  The reactant reference free energy $G_{\\mathrm{R}}$ is the minimum free energy within the defined reactant region.\n  $$\n  G_{\\mathrm{R}} = \\min_{i \\in \\{0, \\dots, r-1\\}} G_i\n  $$\n\n- **Step B: Determine Transition State Free Energy ($G_{\\mathrm{CVT}}^{\\ddagger}$)**\n  The free energy of the variational transition state is the maximum free energy over the set of all admissible dividing surfaces.\n  $$\n  G_{\\mathrm{CVT}}^{\\ddagger} = \\max_{i \\in \\{r, \\dots, N-1\\}} G_i\n  $$\n\n- **Step C: Calculate Activation Free Energy ($\\Delta G_{\\mathrm{CVT}}^{\\ddagger}$)**\n  The activation barrier is the difference between the transition state and reactant free energies. A unit conversion is necessary, as the input $G_i$ values are in $\\mathrm{kJ \\cdot mol^{-1}}$, while the constant $R$ is in $\\mathrm{J \\cdot mol^{-1} \\cdot K^{-1}}$.\n  $$\n  \\Delta G_{\\mathrm{CVT}}^{\\ddagger}\\ [\\mathrm{J \\cdot mol^{-1}}] = (G_{\\mathrm{CVT}}^{\\ddagger} - G_{\\mathrm{R}})\\ [\\mathrm{kJ \\cdot mol^{-1}}] \\times 1000\n  $$\n\n- **Step D: Calculate the CVT Rate Constant ($k_{\\mathrm{CVT}}(T)$)**\n  Substitute the computed activation free energy into the CVT rate equation. The resulting rate constant will have units of $\\mathrm{s^{-1}}$.\n  $$\n  k_{\\mathrm{CVT}}(T) = \\frac{k_{\\mathrm{B}}T}{h} \\exp\\left(-\\frac{\\Delta G_{\\mathrm{CVT}}^{\\ddagger}}{RT}\\right)\n  $$\n\n**3. Statistical Uncertainty Estimation via Parametric Bootstrap**\n\nThe uncertainty in the computed rate constant $k_{\\mathrm{CVT}}(T)$ arises from the statistical uncertainties in the input free energy values, $\\{G_i\\}$. We are given that each $G_i$ is an independent random variable drawn from a Gaussian distribution with mean equal to the provided value and standard deviation $\\sigma_i$, i.e., $G_i \\sim \\mathcal{N}(G_{i,\\text{mean}}, \\sigma_i^2)$. A parametric bootstrap method is employed to propagate these uncertainties to the final rate constant.\n\nThe procedure, using a specified number of replicates $N_{\\mathrm{boot}} = 5000$ and a fixed random seed for reproducibility, is as follows:\n\n1.  Initialize a random number generator with the specified seed ($12345$).\n2.  Create an empty list to store the bootstrap estimates of the rate constant, `k_samples`.\n3.  For each replicate $j$ from $1$ to $N_{\\mathrm{boot}}$:\n    a. Generate a new, synthetic free energy profile $\\{G_i^{(j)}\\}_{i=0}^{N-1}$. For each index $i$, sample a value $G_i^{(j)}$ from the normal distribution $\\mathcal{N}(G_i, \\sigma_i^2)$.\n    b. Using this synthetic profile $\\{G_i^{(j)}\\}$, compute the corresponding rate constant, $k_{\\mathrm{CVT}}^{(j)}$, by applying the four-step numerical algorithm described in the previous section.\n    c. Add the computed rate $k_{\\mathrm{CVT}}^{(j)}$ to the `k_samples` list.\n4.  After completing all bootstrap replicates, calculate the mean ($\\bar{k}_{\\mathrm{CVT}}$) and the sample standard deviation ($u_{\\mathrm{CVT}}$) of the `k_samples` distribution.\n    $$\n    \\bar{k}_{\\mathrm{CVT}} = \\frac{1}{N_{\\mathrm{boot}}} \\sum_{j=1}^{N_{\\mathrm{boot}}} k_{\\mathrm{CVT}}^{(j)}\n    $$\n    $$\n    u_{\\mathrm{CVT}} = \\sqrt{\\frac{1}{N_{\\mathrm{boot}}-1} \\sum_{j=1}^{N_{\\mathrm{boot}}} (k_{\\mathrm{CVT}}^{(j)} - \\bar{k}_{\\mathrm{CVT}})^2}\n    $$\n5.  These two values, $\\bar{k}_{\\mathrm{CVT}}$ and $u_{\\mathrm{CVT}}$, represent the best estimate for the rate constant and its statistical uncertainty, respectively. They are then rounded to $6$ significant figures for reporting.\n\nThis procedure correctly propagates the full uncertainty distribution from the input free energies, accounting for the non-linear relationship between the $G_i$ values and $k_{\\mathrm{CVT}}$, including the uncertainty in identifying the locations of both the reactant minimum and the transition state maximum.", "answer": "```python\nimport numpy as np\nimport math\n\ndef round_to_significant_figures(value, sf):\n    \"\"\"\n    Rounds a floating-point number to a specified number of significant figures.\n    \"\"\"\n    if value == 0:\n        return 0.0\n    # Calculate the position to round to.\n    power = sf - 1 - int(math.floor(math.log10(abs(value))))\n    return round(value, power)\n\ndef solve():\n    \"\"\"\n    Solves the problem for all test cases, calculating the CVT rate constant\n    and its uncertainty using a parametric bootstrap method.\n    \"\"\"\n\n    # --- Constants ---\n    # As specified in the problem statement\n    K_B = 1.380649e-23  # Boltzmann constant in J/K\n    H = 6.62607015e-34   # Planck constant in J·s\n    R = 8.314462618     # Molar gas constant in J/(mol·K)\n\n    # --- Bootstrap Configuration ---\n    N_BOOT = 5000\n    RANDOM_SEED = 12345\n\n    # --- Test Suite ---\n    test_cases = [\n        {\n            \"T\": 300.0,  # K\n            \"G\": np.array([0., 8., 20., 35., 47., 50., 47., 35., 20., 8., 0.]),  # kJ/mol\n            \"sigma\": np.array([0.5] * 11),  # kJ/mol\n            \"r\": 1,  # 1-based index\n        },\n        {\n            \"T\": 300.0,\n            \"G\": np.array([0.0] * 11),\n            \"sigma\": np.array([0.2] * 11),\n            \"r\": 1,\n        },\n        {\n            \"T\": 500.0,\n            \"G\": np.array([0., 20., 40., 20., 0.]),\n            \"sigma\": np.array([0.2, 1.0, 2.0, 1.0, 0.2]),\n            \"r\": 1,\n        },\n    ]\n\n    all_results = []\n    \n    for case in test_cases:\n        T = case[\"T\"]\n        G_mean = case[\"G\"]\n        G_sigma = case[\"sigma\"]\n        # Convert 1-based reactant window index to 0-based slice upper bound\n        r_idx = case[\"r\"]\n\n        rng = np.random.default_rng(RANDOM_SEED)\n        \n        k_boot_samples = []\n\n        for _ in range(N_BOOT):\n            # 1. Generate a bootstrap replicate of the free energy profile\n            # G_sample is drawn from N(G_mean, G_sigma^2)\n            noise = rng.normal(loc=0.0, scale=1.0, size=G_mean.shape)\n            G_sample = G_mean + G_sigma * noise\n\n            # 2. Calculate k_CVT for the sampled profile\n            # Step A: Determine reactant free energy (using 0-based index)\n            G_R = np.min(G_sample[0:r_idx])\n            \n            # Step B: Determine transition state free energy\n            G_TS = np.max(G_sample[r_idx:])\n\n            # Step C: Calculate activation free energy in J/mol\n            delta_G_cvt_J_mol = (G_TS - G_R) * 1000.0\n\n            # Step D: Calculate the CVT rate constant\n            prefactor = (K_B * T) / H\n            exponent = -delta_G_cvt_J_mol / (R * T)\n            k_cvt = prefactor * np.exp(exponent)\n            \n            k_boot_samples.append(k_cvt)\n\n        # Calculate mean and standard deviation of the bootstrap samples\n        k_boot_samples = np.array(k_boot_samples)\n        k_mean = np.mean(k_boot_samples)\n        # Use ddof=1 for sample standard deviation\n        k_std_dev = np.std(k_boot_samples, ddof=1)\n        \n        # Round to 6 significant figures for reporting\n        k_mean_rounded = round_to_significant_figures(k_mean, 6)\n        k_std_dev_rounded = round_to_significant_figures(k_std_dev, 6)\n        \n        all_results.extend([k_mean_rounded, k_std_dev_rounded])\n\n    # Format the final output as a comma-separated list string\n    # Using a format specifier to avoid scientific notation for small numbers where possible\n    # and ensure standard float representation.\n    results_str = ','.join(f'{val:.15g}' for val in all_results)\n    print(f\"[{results_str}]\")\n\nsolve()\n```", "id": "2682419"}]}