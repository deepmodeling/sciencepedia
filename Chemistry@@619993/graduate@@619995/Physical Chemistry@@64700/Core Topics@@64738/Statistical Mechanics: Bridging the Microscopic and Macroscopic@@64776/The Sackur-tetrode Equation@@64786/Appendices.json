{"hands_on_practices": [{"introduction": "The Sackur-Tetrode equation provides a powerful link between the microscopic world of atoms and the macroscopic thermodynamic property of entropy. This first practice serves as a fundamental application of the equation, allowing you to calculate the translational entropy for a real-world gas under standard conditions. By treating nitrogen gas as a collection of point particles, you will gain practical experience in applying the formula and appreciate its utility in estimating thermodynamic quantities from first principles [@problem_id:1964172].", "problem": "In many applications, such as the modeling of gases at high temperatures or in simplified thermodynamic calculations, it is useful to determine the contribution to the total entropy from just the translational motion of the molecules. The Sackur-Tetrode equation provides a theoretical value for this quantity for a monatomic ideal gas.\n\nConsider nitrogen gas ($N_2$). Although it is a diatomic molecule with rotational and vibrational energy levels, we can approximate its translational behavior by treating it as an ideal gas of point particles, each having the mass of a nitrogen molecule.\n\nYour task is to calculate the standard molar entropy arising purely from the translational motion of nitrogen gas. The standard state is defined by a temperature of $T = 298.15$ K and a pressure of $P = 1 \\text{ bar} = 10^5$ Pa.\n\nUse the following values for the physical constants:\n- Molar mass of a nitrogen atom ($N$): $M_{\\text{atom}} = 14.007 \\text{ g/mol}$\n- Planck's constant: $h = 6.626070 \\times 10^{-34} \\text{ J}\\cdot\\text{s}$\n- Boltzmann constant: $k_B = 1.380649 \\times 10^{-23} \\text{ J/K}$\n- Avogadro's number: $N_A = 6.022141 \\times 10^{23} \\text{ mol}^{-1}$\n\nExpress your answer in units of joules per mole-kelvin (J/(mol·K)), rounded to four significant figures.", "solution": "For an ideal gas, the translational contribution to the molar entropy is given by the Sackur–Tetrode equation expressed in the $(T,P)$ form:\n$$\nS_{\\text{trans,m}} = R\\left[\\ln\\!\\left( \\left(\\frac{2\\pi m k_{B} T}{h^{2}}\\right)^{\\frac{3}{2}} \\frac{k_{B} T}{P} \\right) + \\frac{5}{2}\\right],\n$$\nwhere $m$ is the mass of a single molecule, $R = N_{A}k_{B}$, $T$ is the absolute temperature, and $P$ is the pressure.\n\nFor nitrogen gas, treated as point particles of molecular mass, the molecular mass is obtained from the atomic molar mass:\n$$\nM_{N_{2}} = 2\\,M_{\\text{atom}} = 2 \\times 14.007 \\times 10^{-3}\\ \\text{kg mol}^{-1} = 2.8014\\times 10^{-2}\\ \\text{kg mol}^{-1}.\n$$\nThus, the mass of one $N_{2}$ molecule is\n$$\nm = \\frac{M_{N_{2}}}{N_{A}} = \\frac{2.8014\\times 10^{-2}}{6.022141\\times 10^{23}}\\ \\text{kg} \\approx 4.65183\\times 10^{-26}\\ \\text{kg}.\n$$\n\nWith $T=298.15\\ \\text{K}$ and $P=1.0\\times 10^{5}\\ \\text{Pa}$, compute the argument of the logarithm:\n$$\nA \\equiv \\left(\\frac{2\\pi m k_{B} T}{h^{2}}\\right)^{\\frac{3}{2}} \\frac{k_{B} T}{P}.\n$$\nFirst evaluate\n$$\n\\frac{2\\pi m k_{B} T}{h^{2}} \\approx \\frac{2\\pi \\times (4.65183\\times 10^{-26}) \\times (1.380649\\times 10^{-23}) \\times 298.15}{(6.626070\\times 10^{-34})^{2}} \\approx 2.74031\\times 10^{21},\n$$\nhence\n$$\n\\left(\\frac{2\\pi m k_{B} T}{h^{2}}\\right)^{\\frac{3}{2}} \\approx (2.74031\\times 10^{21})^{\\frac{3}{2}} \\approx 1.434506916\\times 10^{32}.\n$$\nAlso,\n$$\n\\frac{k_{B} T}{P} = \\frac{1.380649\\times 10^{-23}\\times 298.15}{1.0\\times 10^{5}} \\approx 4.1164049935\\times 10^{-26}.\n$$\nTherefore,\n$$\nA \\approx (1.434506916\\times 10^{32}) \\times (4.1164049935\\times 10^{-26}) \\approx 5.905011432\\times 10^{6},\n$$\nso\n$$\n\\ln(A) \\approx \\ln(5.905011432) + 6\\ln(10) \\approx 1.775801402 + 13.815510558 = 15.591311960.\n$$\n\nUsing $R = N_{A}k_{B} = (6.022141\\times 10^{23})(1.380649\\times 10^{-23}) \\approx 8.31446295\\ \\text{J mol}^{-1}\\text{K}^{-1}$, the translational molar entropy is\n$$\nS_{\\text{trans,m}} = R\\left[\\ln(A) + \\frac{5}{2}\\right] \\approx 8.31446295 \\times \\left(15.591311960 + \\frac{5}{2}\\right)\\ \\text{J mol}^{-1}\\text{K}^{-1}.\n$$\nNumerically,\n$$\nS_{\\text{trans,m}} \\approx 8.31446295 \\times 18.091311960 \\approx 150.419543\\ \\text{J mol}^{-1}\\text{K}^{-1}.\n$$\nRounded to four significant figures, this is $150.4$ in units of J/(mol·K).", "answer": "$$\\boxed{150.4}$$", "id": "1964172"}, {"introduction": "Any powerful scientific model has its limits, and understanding these boundaries is as important as knowing how to apply the model itself. This exercise explores the low-temperature breakdown of the classical Sackur-Tetrode equation, a phenomenon that hints at the \"entropy catastrophe\" of classical physics. By calculating the temperature at which the equation yields a non-physical negative entropy, you will uncover the necessity of a quantum statistical approach to correctly describe matter at low temperatures, in accordance with the Third Law of Thermodynamics [@problem_id:1964187].", "problem": "In the study of condensed matter physics, systems are often explored under extreme conditions. Consider a scenario where one mole of hydrogen gas (H₂) is confined within a high-pressure chamber with a fixed internal volume of 1.00 cubic centimeter. The thermodynamic properties of this gas are modeled using the Sackur-Tetrode equation, which describes the entropy of a monatomic ideal gas. This classical model, however, is only an approximation and is known to fail at sufficiently low temperatures, where quantum mechanical effects become dominant. A key signature of this failure is the unphysical prediction of negative entropy.\n\nYour task is to determine the critical temperature below which the Sackur-Tetrode equation predicts a negative entropy for this system.\n\nFor the purpose of this problem, you should treat the hydrogen molecules (H₂) as indistinguishable, non-interacting point-like particles, effectively modeling them as a monatomic ideal gas. Use the following values for the necessary physical constants:\n\n- Molar mass of molecular hydrogen, $M = 2.016 \\times 10^{-3} \\text{ kg/mol}$\n- Avogadro's number, $N_A = 6.022 \\times 10^{23} \\text{ mol}^{-1}$\n- Planck's constant, $h = 6.626 \\times 10^{-34} \\text{ J}\\cdot\\text{s}$\n- Boltzmann constant, $k_B = 1.381 \\times 10^{-23} \\text{ J/K}$\n\nExpress your answer in Kelvin (K). Round your final answer to three significant figures.", "solution": "We model the gas with the Sackur–Tetrode entropy (monatomic ideal gas), written in terms of temperature:\n$$\nS = N k_{B}\\left[\\ln\\!\\left(\\frac{V}{N}\\left(\\frac{2\\pi m k_{B} T}{h^{2}}\\right)^{3/2}\\right)+\\frac{5}{2}\\right].\n$$\nThe critical temperature for which the Sackur–Tetrode formula predicts zero entropy is obtained by setting $S=0$ and solving for $T$:\n$$\n\\ln\\!\\left(\\frac{V}{N}\\left(\\frac{2\\pi m k_{B} T}{h^{2}}\\right)^{3/2}\\right) = -\\frac{5}{2},\n$$\n$$\n\\frac{V}{N}\\left(\\frac{2\\pi m k_{B} T}{h^{2}}\\right)^{3/2} = \\exp\\!\\left(-\\frac{5}{2}\\right),\n$$\n$$\n\\left(\\frac{2\\pi m k_{B} T}{h^{2}}\\right)^{3/2} = \\frac{N}{V}\\exp\\!\\left(-\\frac{5}{2}\\right),\n$$\n$$\n\\frac{2\\pi m k_{B} T}{h^{2}} = \\left(\\frac{N}{V}\\right)^{2/3}\\exp\\!\\left(-\\frac{5}{3}\\right),\n$$\n$$\nT_{c} = \\frac{h^{2}}{2\\pi m k_{B}}\\left(\\frac{N}{V}\\right)^{2/3}\\exp\\!\\left(-\\frac{5}{3}\\right).\n$$\nFor one mole, $N=N_{A}$, and for hydrogen molecules treated as point particles, $m = M/N_{A}$. With $V=1.00\\times 10^{-6}\\ \\text{m}^{3}$, the numerical inputs are:\n$$\nm = \\frac{M}{N_{A}} = \\frac{2.016\\times 10^{-3}\\ \\text{kg/mol}}{6.022\\times 10^{23}\\ \\text{mol}^{-1}} \\approx 3.3477\\times 10^{-27}\\ \\text{kg},\n$$\n$$\n\\frac{N}{V} = \\frac{N_{A}}{1.00\\times 10^{-6}\\ \\text{m}^{3}} = 6.022\\times 10^{29}\\ \\text{m}^{-3}.\n$$\nTherefore,\n$$\nT_{c} = \\frac{h^{2}}{2\\pi m k_{B}}\\left(\\frac{N}{V}\\right)^{2/3}\\exp\\!\\left(-\\frac{5}{3}\\right).\n$$\nSubstituting $h=6.626\\times 10^{-34}\\ \\text{J}\\cdot\\text{s}$, $k_{B}=1.381\\times 10^{-23}\\ \\text{J/K}$, $m\\approx 3.3477\\times 10^{-27}\\ \\text{kg}$, and $(N/V)^{2/3}\\approx 7.1309\\times 10^{19}\\ \\text{m}^{-2}$, we obtain\n$$\nT_{c} \\approx \\left(\\frac{(6.626\\times 10^{-34})^{2}}{2\\pi\\,(3.3477\\times 10^{-27})(1.381\\times 10^{-23})}\\right)\\left(7.1309\\times 10^{19}\\right)\\exp\\!\\left(-\\frac{5}{3}\\right) \\approx 20.356\\ \\text{K}.\n$$\nRounding to three significant figures gives $T_{c} = 20.4\\ \\text{K}$. Below this temperature, the Sackur–Tetrode formula predicts negative entropy for the specified system.", "answer": "$$\\boxed{20.4}$$", "id": "1964187"}, {"introduction": "To truly master the Sackur-Tetrode equation, we must go back to its statistical mechanical roots in both the canonical and microcanonical ensembles. This advanced practice challenges you to derive the entropy from the fundamental definitions of the partition function and phase-space volume, and then to implement these derivations computationally. By comparing the results from both ensembles, you will not only verify the Sackur-Tetrode formula but also gain a profound, hands-on understanding of the equivalence of ensembles, a cornerstone concept in statistical physics [@problem_id:2679956].", "problem": "You are to write a program that, for a monatomic ideal gas of $N$ identical particles of mass $m$ confined to volume $V$ at absolute temperature $T$, computes the entropy $S$ numerically in two independent ways based on first-principles statistical mechanics, and then compares the results.\n\nFundamental base to be used:\n- Canonical ensemble: The canonical partition function $Q_N(V,T)$ is defined by\n$$\nQ_N(V,T) \\equiv \\frac{1}{N!\\,h^{3N}} \\int_{\\mathbb{R}^{3N}} \\int_{V^N} \\exp\\!\\big(-\\beta\\,H(\\mathbf{p},\\mathbf{q})\\big)\\,d^{3N}\\mathbf{p}\\,d^{3N}\\mathbf{q},\n$$\nwhere $H(\\mathbf{p},\\mathbf{q}) = \\sum_{i=1}^{N} \\frac{\\mathbf{p}_i^2}{2m}$ is the classical Hamiltonian for a monatomic ideal gas, $\\beta \\equiv 1/(k_{\\mathrm{B}}T)$, $h$ is Planck’s constant, and $k_{\\mathrm{B}}$ is Boltzmann’s constant. The Helmholtz free energy is $F = -k_{\\mathrm{B}}T \\ln Q_N$, the internal energy is $U = -\\partial \\ln Q_N/\\partial \\beta$, and the entropy is $S_{\\mathrm{can}} = (U - F)/T = k_{\\mathrm{B}}\\big(\\ln Q_N + \\beta U\\big)$.\n- Microcanonical ensemble: The integrated phase volume (the cumulative number of states) is\n$$\n\\Gamma(E,V,N) \\equiv \\frac{1}{N!\\,h^{3N}} \\int_{\\mathbb{R}^{3N}} \\int_{V^N} \\Theta\\!\\big(E - H(\\mathbf{p},\\mathbf{q})\\big)\\,d^{3N}\\mathbf{p}\\,d^{3N}\\mathbf{q},\n$$\nwhere $\\Theta(\\cdot)$ is the Heaviside step function. The microcanonical entropy is defined as $S_{\\mu}(E,V,N) \\equiv k_{\\mathrm{B}}\\ln \\Gamma(E,V,N)$.\n\nConstraints for numerical implementation:\n- You must not perform any high-dimensional numerical integration. Instead, reduce the definitions above analytically to low-dimensional expressions involving well-known special functions that can be evaluated numerically with high accuracy. Your derivation must start only from the stated definitions and universal facts such as Gaussian integrals, properties of the Gamma function, and equipartition for quadratic degrees of freedom. Do not assume or quote any final closed-form entropy formula in the problem statement.\n- To compare the two entropies at the same intensive conditions, set the energy for the microcanonical calculation to the canonical mean energy for a monatomic ideal gas, namely $E \\equiv \\frac{3}{2}N k_{\\mathrm{B}} T$. This ensures both calculations refer to the same temperature $T$.\n- All entropies must be reported in $\\mathrm{J\\,K^{-1}}$. The final comparison metric to output is the absolute difference per particle in units of $k_{\\mathrm{B}}$, namely $\\Delta \\equiv \\frac{\\lvert S_{\\mathrm{can}} - S_{\\mu}\\rvert}{N\\,k_{\\mathrm{B}}}$, which is dimensionless.\n\nNumerical stability requirements:\n- Evaluate logarithms of factorials and Gamma functions using numerically stable special functions (for example, the logarithm of the Gamma function) to avoid overflow or underflow.\n- Treat $N$ as an integer, $m$ in $\\mathrm{kg}$, $T$ in $\\mathrm{K}$, and $V$ in $\\mathrm{m^3}$.\n\nTest suite:\nCompute $\\Delta$ for each of the following parameter sets $(m, T, V, N)$:\n- Case $1$ (edge case, single particle): $m = 6.646\\,476\\times 10^{-27}\\,\\mathrm{kg}$, $T = 300\\,\\mathrm{K}$, $N = 1$, $V = 4.0\\times 10^{-26}\\,\\mathrm{m^3}$.\n- Case $2$ (few particles, cryogenic temperature): $m = 6.633\\,520\\,9\\times 10^{-26}\\,\\mathrm{kg}$, $T = 2.7\\,\\mathrm{K}$, $N = 3$, $V = 1.2\\times 10^{-25}\\,\\mathrm{m^3}$.\n- Case $3$ (mesoscopic, high temperature): $m = 6.633\\,520\\,9\\times 10^{-26}\\,\\mathrm{kg}$, $T = 1500\\,\\mathrm{K}$, $N = 100$, $V = 4.0\\times 10^{-24}\\,\\mathrm{m^3}$.\n- Case $4$ (thermodynamic trend): $m = 6.646\\,476\\times 10^{-27}\\,\\mathrm{kg}$, $T = 300\\,\\mathrm{K}$, $N = 1000$, $V = 4.0\\times 10^{-23}\\,\\mathrm{m^3}$.\n\nRequired final output format:\n- Your program should produce a single line of output containing the four computed values of $\\Delta$ for the cases above, as a comma-separated list enclosed in square brackets (for example, $\"[x_1,x_2,x_3,x_4]\"$), where each $x_i$ is a floating-point number.", "solution": "The problem statement has been examined and found to be valid. It is a well-posed exercise in fundamental statistical mechanics, requiring the derivation and numerical comparison of entropy for a monatomic ideal gas in the canonical and microcanonical ensembles. The problem is scientifically sound, self-contained, and objective. We shall proceed with a rigorous, first-principles derivation as mandated.\n\nThe objective is to compute the entropy of a monatomic ideal gas of $N$ particles of mass $m$ in a volume $V$ at temperature $T$ using two statistical ensembles and to compare the results.\n\nFirst, we derive the expression for entropy in the canonical ensemble, denoted $S_{\\mathrm{can}}$.\nThe canonical partition function $Q_N(V,T)$ is given by:\n$$\nQ_N(V,T) = \\frac{1}{N!\\,h^{3N}} \\int_{\\mathbb{R}^{3N}} \\int_{V^N} \\exp\\!\\big(-\\beta\\,H(\\mathbf{p},\\mathbf{q})\\big)\\,d^{3N}\\mathbf{p}\\,d^{3N}\\mathbf{q}\n$$\nThe Hamiltonian for an ideal gas, $H(\\mathbf{p},\\mathbf{q}) = \\sum_{i=1}^{N} \\frac{\\mathbf{p}_i^2}{2m}$, depends only on the momenta $\\mathbf{p}_i$, not the positions $\\mathbf{q}_i$. The integral over the spatial coordinates can be performed immediately:\n$$\n\\int_{V^N} d^{3N}\\mathbf{q} = \\left(\\int_V d^3\\mathbf{q}\\right)^N = V^N\n$$\nThe momentum integral is over $3N$ dimensions. Since the exponential of a sum is the product of exponentials, the integral separates into a product of $N$ identical integrals for each particle:\n$$\n\\int_{\\mathbb{R}^{3N}} \\exp\\left(-\\beta \\sum_{i=1}^{N} \\frac{\\mathbf{p}_i^2}{2m}\\right) d^{3N}\\mathbf{p} = \\left[ \\int_{\\mathbb{R}^3} \\exp\\left(-\\frac{\\beta}{2m} \\mathbf{p}^2\\right) d^3\\mathbf{p} \\right]^N\n$$\nThe three-dimensional integral over a single particle's momentum $\\mathbf{p} = (p_x, p_y, p_z)$ can be separated into a product of three one-dimensional Gaussian integrals:\n$$\n\\int_{\\mathbb{R}^3} e^{-\\frac{\\beta}{2m}(p_x^2+p_y^2+p_z^2)} dp_x dp_y dp_z = \\left( \\int_{-\\infty}^{\\infty} e^{-\\frac{\\beta}{2m}p^2} dp \\right)^3\n$$\nUsing the standard result for a Gaussian integral, $\\int_{-\\infty}^{\\infty} e^{-ax^2} dx = \\sqrt{\\pi/a}$, with $a = \\beta/(2m)$, we find:\n$$\n\\int_{-\\infty}^{\\infty} e^{-\\frac{\\beta}{2m}p^2} dp = \\sqrt{\\frac{2m\\pi}{\\beta}}\n$$\nThus, the three-dimensional momentum integral for one particle is $(2m\\pi/\\beta)^{3/2}$.\nSubstituting these results back into the expression for $Q_N(V,T)$:\n$$\nQ_N(V,T) = \\frac{V^N}{N!h^{3N}} \\left( \\left(\\frac{2m\\pi}{\\beta}\\right)^{3/2} \\right)^N = \\frac{1}{N!} \\left[ \\frac{V}{h^3} (2\\pi m k_{\\mathrm{B}}T)^{3/2} \\right]^N\n$$\nwhere we used $\\beta = 1/(k_{\\mathrm{B}}T)$.\nTo find the entropy, we first compute the logarithm of the partition function. For numerical stability with large $N$, we use the log-gamma function, as $\\ln(N!) = \\ln(\\Gamma(N+1))$:\n$$\n\\ln Q_N = N \\ln V + \\frac{3N}{2} \\ln(2\\pi m k_{\\mathrm{B}}T) - 3N \\ln h - \\ln(\\Gamma(N+1))\n$$\nThe internal energy $U$ is given by $U = -\\partial (\\ln Q_N)/\\partial \\beta$. The only term in $\\ln Q_N$ dependent on $\\beta$ is $\\frac{3N}{2} \\ln(1/\\beta) = -\\frac{3N}{2} \\ln \\beta$.\n$$\nU = -\\frac{\\partial}{\\partial\\beta} \\left( -\\frac{3N}{2} \\ln\\beta \\right) = \\frac{3N}{2\\beta} = \\frac{3}{2}N k_{\\mathrm{B}}T\n$$\nThis is the expected result from the equipartition theorem for a monatomic gas.\nThe canonical entropy $S_{\\mathrm{can}}$ is then $S_{\\mathrm{can}} = (U - F)/T = (U + k_{\\mathrm{B}}T\\ln Q_N)/T = k_{\\mathrm{B}}(\\beta U + \\ln Q_N)$.\n$$\nS_{\\mathrm{can}} = k_{\\mathrm{B}} \\left( \\ln Q_N + \\frac{3N}{2} \\right) = k_{\\mathrm{B}} \\left[ N \\ln V + \\frac{3N}{2} \\ln(2\\pi m k_{\\mathrm{B}}T) - 3N \\ln h - \\ln(\\Gamma(N+1)) + \\frac{3N}{2} \\right]\n$$\nThis is the final expression for the canonical entropy that will be implemented numerically.\n\nNext, we derive the expression for the microcanonical entropy, $S_{\\mu}$.\nThe microcanonical entropy is defined as $S_{\\mu}(E,V,N) = k_{\\mathrm{B}}\\ln \\Gamma(E,V,N)$, where $\\Gamma(E,V,N)$ is the integrated phase volume:\n$$\n\\Gamma(E,V,N) = \\frac{1}{N!\\,h^{3N}} \\int_{\\mathbb{R}^{3N}} \\int_{V^N} \\Theta\\left(E - \\sum_{i=1}^{N} \\frac{\\mathbf{p}_i^2}{2m}\\right)\\,d^{3N}\\mathbf{p}\\,d^{3N}\\mathbf{q}\n$$\nThe Heaviside step function $\\Theta(\\cdot)$ restricts the integration to the region of phase space where the total energy is less than or equal to $E$. As before, the spatial integral yields $V^N$. The momentum integral is the volume of the region defined by $\\sum_{i=1}^{N} \\mathbf{p}_i^2 \\le 2mE$. This inequality describes a $3N$-dimensional ball in momentum space with radius $R = \\sqrt{2mE}$.\nThe volume of a $d$-dimensional ball of radius $R$ is given by the formula $V_d(R) = \\frac{\\pi^{d/2}}{\\Gamma(d/2 + 1)} R^d$.\nIn our case, the dimension is $d = 3N$. The volume of the accessible momentum space is:\n$$\n\\text{Vol}(\\mathbf{p}) = \\frac{\\pi^{3N/2}}{\\Gamma(3N/2 + 1)} (2mE)^{3N/2}\n$$\nSubstituting this into the expression for $\\Gamma(E,V,N)$:\n$$\n\\Gamma(E,V,N) = \\frac{V^N}{N!h^{3N}} \\frac{\\pi^{3N/2}}{\\Gamma(3N/2 + 1)} (2mE)^{3N/2}\n$$\nThe microcanonical entropy is $S_{\\mu} = k_{\\mathrm{B}}\\ln\\Gamma$. Again, using $\\ln(N!) = \\ln(\\Gamma(N+1))$:\n$$\n\\ln \\Gamma = N\\ln V - \\ln(\\Gamma(N+1)) - 3N\\ln h + \\frac{3N}{2}\\ln(\\pi) + \\frac{3N}{2}\\ln(2mE) - \\ln\\left(\\Gamma\\left(\\frac{3N}{2}+1\\right)\\right)\n$$\nCombining the $\\pi$ term with the $2mE$ term:\n$$\nS_{\\mu} = k_{\\mathrm{B}} \\left[ N\\ln V - \\ln(\\Gamma(N+1)) - 3N\\ln h + \\frac{3N}{2}\\ln(2\\pi mE) - \\ln\\left(\\Gamma\\left(\\frac{3N}{2}+1\\right)\\right) \\right]\n$$\nTo compare this with the canonical entropy at temperature $T$, we must evaluate it at an equivalent energy. The correct choice is the average energy of the canonical ensemble at that temperature, which we found to be $E = \\frac{3}{2}N k_{\\mathrm{B}} T$. This ensures both calculations describe the same thermodynamic state. Substituting for $E$:\n$$\nS_{\\mu} = k_{\\mathrm{B}} \\left[ N\\ln V + \\frac{3N}{2}\\ln\\left(2\\pi m \\left(\\frac{3}{2}N k_{\\mathrm{B}}T\\right)\\right) - 3N\\ln h - \\ln(\\Gamma(N+1)) - \\ln\\left(\\Gamma\\left(\\frac{3N}{2}+1\\right)\\right) \\right]\n$$\nThis is the final expression for the microcanonical entropy.\n\nFinally, we compute the required comparison metric, $\\Delta$, defined as the absolute difference in entropy per particle, in units of $k_{\\mathrm{B}}$:\n$$\n\\Delta = \\frac{\\lvert S_{\\mathrm{can}} - S_{\\mu}\\rvert}{N\\,k_{\\mathrm{B}}}\n$$\nThe discrepancy between $S_{\\mathrm{can}}$ and $S_{\\mu}$ is a known feature of statistical mechanics, originating from the different constraints of the ensembles (fixed $T$ vs. fixed $E$). This difference becomes negligible in the thermodynamic limit ($N \\to \\infty$), which is a manifestation of the equivalence of ensembles. For finite $N$, a small difference is expected.\n\nThe numerical implementation will compute $S_{\\mathrm{can}}$ and $S_{\\mu}$ using the derived formulae for each test case. The use of log-gamma functions (`scipy.special.gammaln`) is critical for avoiding numerical overflow with factorial and gamma function terms involving large $N$.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import constants\nfrom scipy.special import gammaln\n\ndef solve():\n    \"\"\"\n    Computes entropy in canonical and microcanonical ensembles for a monatomic ideal gas,\n    and calculates the difference per particle.\n    \"\"\"\n    # Define physical constants from scipy.constants\n    k_B = constants.k  # Boltzmann constant in J/K\n    h = constants.h    # Planck constant in J*s\n\n    # Define the test cases from the problem statement.\n    # Format: (mass in kg, temperature in K, volume in m^3, number of particles)\n    test_cases = [\n        (6.646476e-27, 300.0, 4.0e-26, 1),\n        (6.6335209e-26, 2.7, 1.2e-25, 3),\n        (6.6335209e-26, 1500.0, 4.0e-24, 100),\n        (6.646476e-27, 300.0, 4.0e-23, 1000),\n    ]\n\n    results = []\n    for m, T, V, N_float in test_cases:\n        # Per problem, N is an integer.\n        N = int(N_float)\n\n        # --- Canonical Ensemble Entropy (S_can) ---\n        # S_can = k_B * [ N*ln(V) + (3N/2)*ln(2*pi*m*k_B*T) - 3N*ln(h) - ln(N!) + 3N/2 ]\n        \n        # We calculate the term inside the brackets to maintain precision.\n        # ln(N!) is computed using the log-gamma function: gammaln(N + 1)\n        log_term_can = (\n            N * np.log(V)\n            + (3.0 * N / 2.0) * np.log(2.0 * np.pi * m * k_B * T)\n            - 3.0 * N * np.log(h)\n            - gammaln(N + 1.0)\n            + (3.0 * N / 2.0)\n        )\n        S_can = k_B * log_term_can\n\n        # --- Microcanonical Ensemble Entropy (S_mu) ---\n        # The energy E is set to the canonical mean energy.\n        E = (3.0 / 2.0) * N * k_B * T\n        \n        # S_mu = k_B * [ N*ln(V) - ln(N!) - 3N*ln(h) + (3N/2)*ln(2*pi*m*E) - ln(Γ(3N/2 + 1)) ]\n        \n        if N == 0:\n            # Although not in test cases, for completeness S=0 for N=0.\n            # Delta would be undefined. We assume N >= 1 as per tests.\n            continue\n            \n        log_term_mu = (\n            N * np.log(V)\n            - gammaln(N + 1.0)\n            - 3.0 * N * np.log(h)\n            + (3.0 * N / 2.0) * np.log(2.0 * np.pi * m * E)\n            - gammaln(3.0 * N / 2.0 + 1.0)\n        )\n        S_mu = k_B * log_term_mu\n\n        # --- Comparison Metric (Delta) ---\n        # Delta = |S_can - S_mu| / (N * k_B)\n        delta = np.abs(S_can - S_mu) / (N * k_B)\n        \n        results.append(delta)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.10f}' for r in results)}]\")\n\nsolve()\n```", "id": "2679956"}]}