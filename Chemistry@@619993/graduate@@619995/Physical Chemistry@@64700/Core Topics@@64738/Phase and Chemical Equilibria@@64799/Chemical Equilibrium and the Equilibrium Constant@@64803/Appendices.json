{"hands_on_practices": [{"introduction": "To truly grasp chemical equilibrium, we must first understand its thermodynamic origin. This practice [@problem_id:2628284] guides you through deriving the fundamental relationship between the instantaneous Gibbs free energy of reaction, $\\Delta_r G$, the standard state value, $\\Delta_r G^{\\circ}$, and the reaction quotient, $Q$. By applying this equation to a hypothetical reaction, you will practice determining the direction of spontaneous change and quantify the thermodynamic driving force that moves a system toward equilibrium.", "problem": "A single-step, stoichiometrically balanced reaction at constant temperature and pressure is described by the extent-based Gibbs free energy of reaction. Consider an ideal mixture (or ideal gas mixture) where the activity of each species equals its mole-fraction or partial-pressure ratio to the standard state, so that the reaction quotient is a dimensionless product of activities. The standard Gibbs free energy change of reaction at temperature $T$ is given as $\\Delta_{r} G^{\\circ}(T) = 5.0\\,\\mathrm{kJ\\,mol^{-1}}$ at $T=500\\,\\mathrm{K}$. Two nonequilibrium compositions are prepared with reaction quotients $Q_{1}=0.0100$ and $Q_{2}=100$, respectively. Using only fundamental definitions, begin from the chemical potential expression for an ideal mixture and derive the dependence of the instantaneous Gibbs free energy change of reaction $\\Delta_{r} G$ on $Q$ and $T$ at fixed $T$ and pressure. Use this to determine, for each $Q$, whether an infinitesimal advancement in the forward direction is spontaneous. Finally, define the scalar quantity\n$$\nS \\equiv \\Delta_{r} G(Q_{2}) - \\Delta_{r} G(Q_{1}),\n$$\nand compute $S$ numerically using $R=8.314462618\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$. Express the final value of $S$ in $\\mathrm{kJ\\,mol^{-1}}$ and round your answer to four significant figures. The final answer must be the single value of $S$ only.", "solution": "The problem statement has been validated and is found to be scientifically sound, self-contained, and well-posed. It is a standard problem in chemical thermodynamics that tests fundamental principles. We will proceed with a rigorous solution.\n\nThe instantaneous Gibbs free energy change of a reaction, $\\Delta_{r} G$, is defined as the derivative of the Gibbs free energy $G$ with respect to the extent of reaction $\\xi$ at constant temperature $T$ and pressure $p$. For a general chemical reaction $\\sum_{i} \\nu_{i} M_{i} = 0$, where $\\nu_{i}$ are the stoichiometric coefficients (positive for products, negative for reactants) and $M_{i}$ are the chemical species, this is given by:\n$$\n\\Delta_{r} G = \\left( \\frac{\\partial G}{\\partial \\xi} \\right)_{T,p} = \\sum_{i} \\nu_{i} \\mu_{i}\n$$\nwhere $\\mu_{i}$ is the chemical potential of species $i$.\n\nThe problem states to begin from the chemical potential expression for an ideal mixture. For a species $i$ in such a mixture, its chemical potential is related to its standard chemical potential $\\mu_{i}^{\\circ}(T)$ and its activity $a_{i}$ by the fundamental relation:\n$$\n\\mu_{i} = \\mu_{i}^{\\circ}(T) + RT \\ln(a_{i})\n$$\nwhere $R$ is the universal gas constant and $T$ is the absolute temperature. The standard state chemical potential $\\mu_{i}^{\\circ}(T)$ is a function of temperature only.\n\nSubstituting this expression for $\\mu_{i}$ into the equation for $\\Delta_{r} G$:\n$$\n\\Delta_{r} G = \\sum_{i} \\nu_{i} \\left( \\mu_{i}^{\\circ}(T) + RT \\ln(a_{i}) \\right)\n$$\nWe can distribute the summation:\n$$\n\\Delta_{r} G = \\sum_{i} \\nu_{i} \\mu_{i}^{\\circ}(T) + \\sum_{i} \\nu_{i} RT \\ln(a_{i})\n$$\nThe first term is, by definition, the standard Gibbs free energy change of reaction, $\\Delta_{r} G^{\\circ}(T)$:\n$$\n\\Delta_{r} G^{\\circ}(T) \\equiv \\sum_{i} \\nu_{i} \\mu_{i}^{\\circ}(T)\n$$\nThe second term can be manipulated using the properties of logarithms. The constant term $RT$ can be factored out:\n$$\n\\sum_{i} \\nu_{i} RT \\ln(a_{i}) = RT \\sum_{i} \\nu_{i} \\ln(a_{i}) = RT \\sum_{i} \\ln(a_{i}^{\\nu_{i}}) = RT \\ln \\left( \\prod_{i} a_{i}^{\\nu_{i}} \\right)\n$$\nThe product term $\\prod_{i} a_{i}^{\\nu_{i}}$ is the definition of the reaction quotient, $Q$.\n$$\nQ \\equiv \\prod_{i} a_{i}^{\\nu_{i}}\n$$\nCombining these results yields the desired relationship for the dependence of the instantaneous Gibbs free energy change of reaction on $Q$ and $T$:\n$$\n\\Delta_{r} G = \\Delta_{r} G^{\\circ}(T) + RT \\ln(Q)\n$$\nThis completes the required derivation.\n\nNext, we must determine if an infinitesimal advancement in the forward direction is spontaneous for each of the two compositions. The criterion for a spontaneous process at constant $T$ and $p$ is that the Gibbs free energy must decrease, which for a chemical reaction corresponds to $\\Delta_{r} G < 0$. We are given $\\Delta_{r} G^{\\circ}(T) = 5.0\\,\\mathrm{kJ\\,mol^{-1}} = 5000\\,\\mathrm{J\\,mol^{-1}}$, $T = 500\\,\\mathrm{K}$, and $R = 8.314462618\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$.\n\nFor the first composition, $Q_{1} = 0.0100$:\n$$\n\\Delta_{r} G(Q_{1}) = \\Delta_{r} G^{\\circ}(T) + RT \\ln(Q_{1})\n$$\n$$\n\\Delta_{r} G(Q_{1}) = 5000\\,\\mathrm{J\\,mol^{-1}} + (8.314462618\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}})(500\\,\\mathrm{K})\\ln(0.0100)\n$$\n$$\n\\Delta_{r} G(Q_{1}) \\approx 5000 + (4157.23)(-4.60517)\\,\\mathrm{J\\,mol^{-1}} \\approx 5000 - 19145.5\\,\\mathrm{J\\,mol^{-1}} \\approx -14146\\,\\mathrm{J\\,mol^{-1}}\n$$\nSince $\\Delta_{r} G(Q_{1}) < 0$, the reaction is spontaneous in the forward direction for this composition.\n\nFor the second composition, $Q_{2} = 100$:\n$$\n\\Delta_{r} G(Q_{2}) = \\Delta_{r} G^{\\circ}(T) + RT \\ln(Q_{2})\n$$\n$$\n\\Delta_{r} G(Q_{2}) = 5000\\,\\mathrm{J\\,mol^{-1}} + (8.314462618\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}})(500\\,\\mathrm{K})\\ln(100)\n$$\n$$\n\\Delta_{r} G(Q_{2}) \\approx 5000 + (4157.23)(4.60517)\\,\\mathrm{J\\,mol^{-1}} \\approx 5000 + 19145.5\\,\\mathrm{J\\,mol^{-1}} \\approx 24146\\,\\mathrm{J\\,mol^{-1}}\n$$\nSince $\\Delta_{r} G(Q_{2}) > 0$, the reaction is non-spontaneous in the forward direction. The reverse reaction is spontaneous.\n\nFinally, we compute the scalar quantity $S$, defined as:\n$$\nS \\equiv \\Delta_{r} G(Q_{2}) - \\Delta_{r} G(Q_{1})\n$$\nSubstituting the expressions derived earlier:\n$$\nS = \\left( \\Delta_{r} G^{\\circ}(T) + RT \\ln(Q_{2}) \\right) - \\left( \\Delta_{r} G^{\\circ}(T) + RT \\ln(Q_{1}) \\right)\n$$\nThe standard Gibbs free energy change $\\Delta_{r} G^{\\circ}(T)$ is a constant at a given temperature and cancels out:\n$$\nS = RT \\ln(Q_{2}) - RT \\ln(Q_{1}) = RT (\\ln(Q_{2}) - \\ln(Q_{1}))\n$$\nUsing the properties of logarithms, we arrive at the simplified expression for $S$:\n$$\nS = RT \\ln\\left(\\frac{Q_{2}}{Q_{1}}\\right)\n$$\nNow we substitute the provided numerical values:\n$$\nS = (8.314462618\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}})(500\\,\\mathrm{K}) \\ln\\left(\\frac{100}{0.0100}\\right)\n$$\n$$\nS = (4157.231309\\,\\mathrm{J\\,mol^{-1}}) \\ln(10000)\n$$\n$$\nS \\approx (4157.231309\\,\\mathrm{J\\,mol^{-1}}) \\times (9.21034037)\n$$\n$$\nS \\approx 38289.155\\,\\mathrm{J\\,mol^{-1}}\n$$\nThe problem requires the answer to be expressed in $\\mathrm{kJ\\,mol^{-1}}$ and rounded to four significant figures.\n$$\nS \\approx 38.289155\\,\\mathrm{kJ\\,mol^{-1}}\n$$\nRounding to four significant figures, we get $S = 38.29\\,\\mathrm{kJ\\,mol^{-1}}$.", "answer": "$$\n\\boxed{38.29}\n$$", "id": "2628284"}, {"introduction": "While ideal systems provide a useful starting point, real chemical reactions, especially in solution, exhibit non-ideal behavior due to intermolecular forces. This exercise [@problem_id:2628299] transitions from ideality to reality by introducing activity coefficients ($\\gamma_i$) to account for these interactions. You will derive the exact relationship between the true thermodynamic equilibrium constant, $K$, and the concentration-based ratio, $K_{\\mathrm{conc}}$, demonstrating how non-ideality quantitatively modifies the law of mass action.", "problem": "Consider the association reaction in aqueous solution at temperature $25^\\circ\\mathrm{C}$:\n$$\\mathrm{A} + \\mathrm{B} \\rightleftharpoons \\mathrm{AB}.$$\nAssume an ionic strength at which the (molarity-scale) activity coefficients for the solutes are constant and given by $\\gamma_{\\mathrm{A}}=\\gamma_{\\mathrm{B}}=0.85$ and $\\gamma_{\\mathrm{AB}}=0.92$. Adopt the molarity scale with the standard concentration $c^{\\circ}=1\\,\\mathrm{mol\\,L^{-1}}$ and the solute activity definition $a_i=\\gamma_i [i]/c^{\\circ}$, where $[i]$ denotes the molar concentration of species $i$.\n\nStarting only from the chemical equilibrium condition expressed in terms of chemical potentials and the definition of activity for solutes, derive how the dimensionless thermodynamic equilibrium constant $K$ relates to the concentration ratio $K_{\\mathrm{conc}}=[\\mathrm{AB}]/([\\mathrm{A}][\\mathrm{B}])$ on the molarity scale. Then, compute the single dimensionless numerical factor $F$ such that\n$$K = F\\,c^{\\circ}\\,K_{\\mathrm{conc}}.$$\n\nExpress your final answer for $F$ as an exact fraction with no units. Do not round.", "solution": "The problem statement is subjected to validation.\n\n**Step 1: Extract Givens**\nThe following information is provided:\n- Reaction: $\\mathrm{A} + \\mathrm{B} \\rightleftharpoons \\mathrm{AB}$\n- Temperature: $T = 25^\\circ\\mathrm{C}$\n- Solution: Aqueous\n- Activity coefficients: $\\gamma_{\\mathrm{A}}=0.85$, $\\gamma_{\\mathrm{B}}=0.85$, $\\gamma_{\\mathrm{AB}}=0.92$\n- Standard concentration: $c^{\\circ}=1\\,\\mathrm{mol\\,L^{-1}}$\n- Activity definition: $a_i=\\gamma_i [i]/c^{\\circ}$\n- Concentration ratio: $K_{\\mathrm{conc}}=[\\mathrm{AB}]/([\\mathrm{A}][\\mathrm{B}])$\n- Required relation: $K = F\\,c^{\\circ}\\,K_{\\mathrm{conc}}$\n- Objective: Compute the dimensionless numerical factor $F$.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is evaluated against the required criteria.\n- **Scientifically Grounded:** The problem is based on fundamental principles of chemical thermodynamics, specifically the relationship between chemical potential, activity, and the equilibrium constant. The definitions and values provided are standard and scientifically sound.\n- **Well-Posed:** The problem is clearly defined, with a specific objective to derive a relationship and compute a constant. All necessary information is provided for a unique solution.\n- **Objective:** The language is formal and quantitative, free of any subjectivity or ambiguity.\n- **Completeness and Consistency:** The problem is self-contained. The provided data are consistent and sufficient for the task. The inclusion of the standard concentration $c^{\\circ}$ is crucial for correct dimensional analysis.\n- **Conclusion:** The problem is valid. It is a standard exercise in physical chemistry that tests the understanding of chemical equilibrium.\n\n**Step 3: Verdict and Action**\nThe problem is valid. A rigorous solution will now be developed.\n\nThe fundamental condition for chemical equilibrium at constant temperature and pressure is that the Gibbs free energy of the system is at a minimum. This implies that the change in Gibbs free energy for the reaction, $\\Delta_rG$, is zero. For the reaction $\\mathrm{A} + \\mathrm{B} \\rightleftharpoons \\mathrm{AB}$, this condition is expressed in terms of the chemical potentials, $\\mu_i$, of the species involved:\n$$ \\sum_{i} \\nu_i \\mu_i = 0 $$\nwhere $\\nu_i$ are the stoichiometric coefficients, which are $\\nu_{\\mathrm{A}}=-1$, $\\nu_{\\mathrm{B}}=-1$, and $\\nu_{\\mathrm{AB}}=+1$. The equilibrium condition is therefore:\n$$ \\mu_{\\mathrm{AB}} - \\mu_{\\mathrm{A}} - \\mu_{\\mathrm{B}} = 0 $$\n$$ \\mu_{\\mathrm{A}} + \\mu_{\\mathrm{B}} = \\mu_{\\mathrm{AB}} $$\nThe chemical potential of a solute species $i$ in solution is related to its activity, $a_i$, by the expression:\n$$ \\mu_i = \\mu_i^{\\circ} + RT \\ln(a_i) $$\nwhere $\\mu_i^{\\circ}$ is the standard chemical potential of species $i$ at the standard concentration $c^{\\circ}$, $R$ is the ideal gas constant, and $T$ is the absolute temperature. Substituting this expression into the equilibrium condition yields:\n$$ (\\mu_{\\mathrm{A}}^{\\circ} + RT \\ln(a_{\\mathrm{A}})) + (\\mu_{\\mathrm{B}}^{\\circ} + RT \\ln(a_{\\mathrm{B}})) = \\mu_{\\mathrm{AB}}^{\\circ} + RT \\ln(a_{\\mathrm{AB}}) $$\nRearranging the terms to separate the standard potentials from the activity terms gives:\n$$ (\\mu_{\\mathrm{AB}}^{\\circ} - \\mu_{\\mathrm{A}}^{\\circ} - \\mu_{\\mathrm{B}}^{\\circ}) = RT \\ln(a_{\\mathrm{A}}) + RT \\ln(a_{\\mathrm{B}}) - RT \\ln(a_{\\mathrm{AB}}) $$\nThe term on the left is the standard Gibbs free energy of reaction, $\\Delta_r G^{\\circ}$:\n$$ \\Delta_r G^{\\circ} = \\mu_{\\mathrm{AB}}^{\\circ} - \\mu_{\\mathrm{A}}^{\\circ} - \\mu_{\\mathrm{B}}^{\\circ} $$\nCombining the logarithmic terms on the right side, we obtain:\n$$ \\Delta_r G^{\\circ} = -RT \\ln\\left(\\frac{a_{\\mathrm{AB}}}{a_{\\mathrm{A}} a_{\\mathrm{B}}}\\right)_{\\mathrm{eq}} $$\nThe dimensionless thermodynamic equilibrium constant, $K$, is defined by the relation $\\Delta_r G^{\\circ} = -RT \\ln K$. By comparison, it is evident that $K$ is the reaction quotient of activities at equilibrium:\n$$ K = \\left(\\frac{a_{\\mathrm{AB}}}{a_{\\mathrm{A}} a_{\\mathrm{B}}}\\right)_{\\mathrm{eq}} $$\nThe problem defines the activity of a solute $i$ as $a_i = \\gamma_i [i]/c^{\\circ}$, where $\\gamma_i$ is the activity coefficient, $[i]$ is the molar concentration, and $c^{\\circ}$ is the standard concentration of $1\\,\\mathrm{mol\\,L^{-1}}$. We substitute this definition into the expression for $K$:\n$$ K = \\frac{\\gamma_{\\mathrm{AB}} [\\mathrm{AB}] / c^{\\circ}}{(\\gamma_{\\mathrm{A}} [\\mathrm{A}] / c^{\\circ})(\\gamma_{\\mathrm{B}} [\\mathrm{B}] / c^{\\circ})} $$\nThis expression can be simplified by separating the activity coefficients, the concentrations, and the standard concentration terms:\n$$ K = \\left(\\frac{\\gamma_{\\mathrm{AB}}}{\\gamma_{\\mathrm{A}} \\gamma_{\\mathrm{B}}}\\right) \\left(\\frac{[\\mathrm{AB}]}{[\\mathrm{A}][\\mathrm{B}]}\\right) \\left(\\frac{1/c^{\\circ}}{(1/c^{\\circ})^2}\\right) $$\n$$ K = \\left(\\frac{\\gamma_{\\mathrm{AB}}}{\\gamma_{\\mathrm{A}} \\gamma_{\\mathrm{B}}}\\right) \\left(\\frac{[\\mathrm{AB}]}{[\\mathrm{A}][\\mathrm{B}]}\\right) c^{\\circ} $$\nThe problem defines the concentration ratio as $K_{\\mathrm{conc}} = [\\mathrm{AB}]/([\\mathrm{A}][\\mathrm{B}])$. Substituting this into the equation for $K$:\n$$ K = \\left(\\frac{\\gamma_{\\mathrm{AB}}}{\\gamma_{\\mathrm{A}} \\gamma_{\\mathrm{B}}}\\right) K_{\\mathrm{conc}} c^{\\circ} $$\nWe are asked to find the dimensionless factor $F$ in the relation $K = F c^{\\circ} K_{\\mathrm{conc}}$. By directly comparing our derived expression with this target form, we identify $F$ as the ratio of activity coefficients:\n$$ F = \\frac{\\gamma_{\\mathrm{AB}}}{\\gamma_{\\mathrm{A}} \\gamma_{\\mathrm{B}}} $$\nNow, we compute the numerical value of $F$ using the provided activity coefficients: $\\gamma_{\\mathrm{A}}=0.85$, $\\gamma_{\\mathrm{B}}=0.85$, and $\\gamma_{\\mathrm{AB}}=0.92$. To obtain an exact fraction as required, we convert the decimal values to fractions:\n$$ \\gamma_{\\mathrm{A}} = 0.85 = \\frac{85}{100} = \\frac{17}{20} $$\n$$ \\gamma_{\\mathrm{B}} = 0.85 = \\frac{17}{20} $$\n$$ \\gamma_{\\mathrm{AB}} = 0.92 = \\frac{92}{100} = \\frac{23}{25} $$\nSubstituting these fractions into the expression for $F$:\n$$ F = \\frac{\\frac{23}{25}}{\\left(\\frac{17}{20}\\right)\\left(\\frac{17}{20}\\right)} = \\frac{\\frac{23}{25}}{\\frac{17^2}{20^2}} = \\frac{\\frac{23}{25}}{\\frac{289}{400}} $$\nTo simplify this complex fraction, we multiply the numerator by the reciprocal of the denominator:\n$$ F = \\frac{23}{25} \\times \\frac{400}{289} $$\nSince $400/25 = 16$, the expression simplifies to:\n$$ F = 23 \\times \\frac{16}{289} = \\frac{23 \\times 16}{289} $$\nThe numerator is $23 \\times 16 = 368$. The denominator is $289 = 17^2$. Since $17$ is a prime number and does not divide $368$ (as $368 = 17 \\times 21 + 11$), the fraction is irreducible.\nThus, the final value for the factor $F$ is:\n$$ F = \\frac{368}{289} $$\nThis factor is dimensionless, as required.", "answer": "$$\\boxed{\\frac{368}{289}}$$", "id": "2628299"}, {"introduction": "The principles of equilibrium are most powerfully demonstrated when applied to complex systems with multiple, interacting reactions. This advanced practice [@problem_id:2628319] challenges you to build a complete computational model for the speciation of a diprotic acid, a system governed by simultaneous acid dissociations and water autoionization. By implementing an iterative algorithm that self-consistently solves for all concentrations and activity coefficients, you will gain hands-on experience in the numerical methods that are essential for modeling realistic chemical phenomena.", "problem": "You are asked to write a complete, runnable program that computes the equilibrium speciation and the acidity (International Union of Pure and Applied Chemistry (IUPAC) definition of acidity, denoted as $pH$) for an aqueous solution of a diprotic acid $\\mathrm{H_2A}$ at temperature $T = 298.15\\,\\mathrm{K}$ in the presence of a background $1{:}1$ inert electrolyte that controls ionic strength. The program must treat equilibrium constants on the activity scale and must apply activity corrections to all ionic species using the Davies equation. The program must not accept any user input and must use the fixed test suite specified below. All output must be produced on a single line as specified. Concentrations must be reported in $\\mathrm{mol\\,L^{-1}}$.\n\nFundamental starting points and definitions to be used:\n\n- Equilibrium is characterized by equality of chemical potentials; the law of mass action on the activity scale follows from this. For the reactions\n  $$\\mathrm{H_2A} \\rightleftharpoons \\mathrm{H^+} + \\mathrm{HA^-}, \\quad \\mathrm{HA^-} \\rightleftharpoons \\mathrm{H^+} + \\mathrm{A^{2-}}, \\quad \\mathrm{H_2O} \\rightleftharpoons \\mathrm{H^+} + \\mathrm{OH^-},$$\n  define thermodynamic equilibrium constants (infinite-dilution standard state) $K_{a1}^\\circ$, $K_{a2}^\\circ$, and $K_w^\\circ$ by\n  $$K_{a1}^\\circ = \\frac{a_{\\mathrm{H^+}} a_{\\mathrm{HA^-}}}{a_{\\mathrm{H_2A}}}, \\quad K_{a2}^\\circ = \\frac{a_{\\mathrm{H^+}} a_{\\mathrm{A^{2-}}}}{a_{\\mathrm{HA^-}}}, \\quad K_w^\\circ = a_{\\mathrm{H^+}} a_{\\mathrm{OH^-}},$$\n  where $a_i$ denotes the activity of species $i$.\n- Activities satisfy $a_i = \\gamma_i \\, c_i / c^\\circ$, where $c_i$ is the molar concentration, $c^\\circ = 1\\,\\mathrm{mol\\,L^{-1}}$ is the standard concentration, and $\\gamma_i$ is the activity coefficient. Take $\\gamma_{\\mathrm{H_2A}} = 1$ (neutral solute).\n- The ionic strength $I$ (in $\\mathrm{mol\\,L^{-1}}$) is\n  $$I = \\frac{1}{2} \\sum_i z_i^2 c_i,$$\n  where $z_i$ is the charge number of ion $i$. In this problem, the solution contains the ions $\\mathrm{H^+}$, $\\mathrm{OH^-}$, $\\mathrm{HA^-}$, $\\mathrm{A^{2-}}$, and an inert $1{:}1$ electrolyte at analytical concentration $C_s$ (completely dissociated into $\\mathrm{Na^+}$ and $\\mathrm{Cl^-}$). For a $1{:}1$ electrolyte, its contribution to $I$ is exactly $C_s$.\n- The Davies equation at $T = 298.15\\,\\mathrm{K}$ gives the activity coefficient of ion $i$ of charge $z_i$ as\n  $$\\log_{10} \\gamma_i = - A \\, z_i^2 \\left( \\frac{\\sqrt{I}}{1 + \\sqrt{I}} - 0.3 I \\right),$$\n  with $A = 0.509\\,\\mathrm{(mol/L)^{-1/2}}$. Use $\\gamma_i = 1$ when $I = 0$. Apply this to $\\mathrm{H^+}$, $\\mathrm{OH^-}$, $\\mathrm{HA^-}$, $\\mathrm{A^{2-}}$, $\\mathrm{Na^+}$, and $\\mathrm{Cl^-}$.\n- The IUPAC definition of acidity is $pH = -\\log_{10} a_{\\mathrm{H^+}} = -\\log_{10}(\\gamma_{\\mathrm{H^+}} c_{\\mathrm{H^+}}/c^\\circ)$.\n\nYour program must:\n\n- Use the following thermodynamic constants at $T = 298.15\\,\\mathrm{K}$:\n  - $pK_{a1}^\\circ = 3.60$ and $pK_{a2}^\\circ = 8.20$, hence $K_{a1}^\\circ = 10^{-3.60}$ and $K_{a2}^\\circ = 10^{-8.20}$.\n  - $K_w^\\circ = 1.0 \\times 10^{-14}$.\n- Enforce the following constraints simultaneously:\n  - Mass conservation of the diprotic acid: $c_{\\mathrm{H_2A}} + c_{\\mathrm{HA^-}} + c_{\\mathrm{A^{2-}}} = C_T$, where $C_T$ is the analytical total concentration of $\\mathrm{H_2A}$.\n  - Electroneutrality: $c_{\\mathrm{H^+}} + c_{\\mathrm{Na^+}} = c_{\\mathrm{OH^-}} + c_{\\mathrm{HA^-}} + 2 c_{\\mathrm{A^{2-}}} + c_{\\mathrm{Cl^-}}$. With $c_{\\mathrm{Na^+}} = c_{\\mathrm{Cl^-}} = C_s$, this reduces to $c_{\\mathrm{H^+}} = c_{\\mathrm{OH^-}} + c_{\\mathrm{HA^-}} + 2 c_{\\mathrm{A^{2-}}}$.\n  - Activity-based mass-action constraints for all three equilibria.\n  - Self-consistency of ionic strength $I$ with all ionic concentrations, including the background electrolyte, and self-consistent activity coefficients via the Davies equation.\n- Compute the $pH$ as defined above and the equilibrium concentrations $c_{\\mathrm{H_2A}}$, $c_{\\mathrm{HA^-}}$, and $c_{\\mathrm{A^{2-}}}$ in $\\mathrm{mol\\,L^{-1}}$.\n\nNumerical and unit requirements:\n\n- Report all concentrations in $\\mathrm{mol\\,L^{-1}}$.\n- Report $pH$ as a dimensionless number.\n- For each test case, output a list with four numbers in the order $[pH, c_{\\mathrm{H_2A}}, c_{\\mathrm{HA^-}}, c_{\\mathrm{A^{2-}}}]$.\n- Round $pH$ to $6$ decimal places. Express each concentration using scientific notation with $6$ significant figures.\n\nTest suite:\n\nCompute and return results for the following four test cases, each specified by $(C_T, I_b)$, where $C_T$ is the analytical total concentration of $\\mathrm{H_2A}$ and $I_b$ is the target background ionic strength imposed by a $1{:}1$ inert electrolyte. Implement this by taking the analytical concentration of the background electrolyte as $C_s = I_b$.\n\n- Case $1$ (general case): $(C_T, I_b) = (10^{-3}, 10^{-1})$.\n- Case $2$ (very dilute acid, essentially pure water): $(C_T, I_b) = (10^{-8}, 0)$.\n- Case $3$ (buffer-like regime at modest ionic strength): $(C_T, I_b) = (10^{-2}, 10^{-2})$.\n- Case $4$ (high ionic strength near the upper validity limit of the Davies equation): $(C_T, I_b) = (5 \\times 10^{-3}, 5 \\times 10^{-1})$.\n\nFinal output format:\n\nYour program should produce a single line of output containing a list of four sublists, one per test case, in the same order as specified above. Each sublist must be of the form $[pH, c_{\\mathrm{H_2A}}, c_{\\mathrm{HA^-}}, c_{\\mathrm{A^{2-}}}]$. The overall output must be a single line string of the form\n$[[\\dots],[\\dots],[\\dots],[\\dots]]$,\nwith commas separating the entries. For example, a syntactically valid output line would look like\n$[[7.000000,1.00000e-08,0.00000e+00,0.00000e+00],[\\dots],\\dots]$\nbut with the actual computed numbers for each test case.", "solution": "The problem requires the calculation of equilibrium speciation and $pH$ for an aqueous solution of a diprotic acid, $\\mathrm{H_2A}$, including activity corrections. This is a classic problem in physical chemistry which necessitates solving a system of coupled, non-linear algebraic equations. The solution must be self-consistent, meaning the calculated ionic concentrations must produce the ionic strength that, via the Davies equation, yields the activity coefficients used in the calculation itself. This circular dependency mandates an iterative numerical approach.\n\nThe system is governed by the following fundamental principles and equations:\n\n$1$. **Chemical Equilibria (Law of Mass Action):**\nThe three pertinent equilibria are the two dissociation steps of the acid and the autoionization of water. The thermodynamic equilibrium constants, defined on the activity scale ($a_i$), are given as:\n$$K_{a1}^\\circ = \\frac{a_{\\mathrm{H^+}} a_{\\mathrm{HA^-}}}{a_{\\mathrm{H_2A}}} = 10^{-3.60}$$\n$$K_{a2}^\\circ = \\frac{a_{\\mathrm{H^+}} a_{\\mathrm{A^{2-}}}}{a_{\\mathrm{HA^-}}} = 10^{-8.20}$$\n$$K_w^\\circ = a_{\\mathrm{H^+}} a_{\\mathrm{OH^-}} = 1.0 \\times 10^{-14}$$\nActivity $a_i$ is related to molar concentration $c_i$ by $a_i = \\gamma_i (c_i/c^\\circ)$, where $\\gamma_i$ is the activity coefficient and $c^\\circ = 1\\,\\mathrm{mol\\,L^{-1}}$. For the neutral species $\\mathrm{H_2A}$, we take $\\gamma_{\\mathrm{H_2A}} = 1$.\n\n$2$. **Conservation of Mass:**\nThe total analytical concentration of the diprotic acid, $C_T$, must equal the sum of the concentrations of all its forms at equilibrium:\n$$C_T = c_{\\mathrm{H_2A}} + c_{\\mathrm{HA^-}} + c_{\\mathrm{A^{2-}}}$$\n\n$3$. **Electroneutrality (Charge Balance):**\nThe total positive charge concentration in the solution must equal the total negative charge concentration. The ions present are $\\mathrm{H^+}$, $\\mathrm{OH^-}$, $\\mathrm{HA^-}$, $\\mathrm{A^{2-}}$, and the ions from the inert $1{:}1$ electrolyte, $\\mathrm{Na^+}$ and $\\mathrm{Cl^-}$, present at concentration $C_s$.\n$$c_{\\mathrm{H^+}} + c_{\\mathrm{Na^+}} = c_{\\mathrm{OH^-}} + c_{\\mathrm{HA^-}} + 2 c_{\\mathrm{A^{2-}}} + c_{\\mathrm{Cl^-}}$$\nGiven that $c_{\\mathrm{Na^+}} = c_{\\mathrm{Cl^-}} = C_s$, the charge balance equation simplifies to what is often called the proton condition:\n$$c_{\\mathrm{H^+}} = c_{\\mathrm{OH^-}} + c_{\\mathrm{HA^-}} + 2 c_{\\mathrm{A^{2-}}}$$\n\n$4$. **Ionic Strength and Activity Coefficients:**\nThe ionic strength, $I$, is defined by the concentrations and charges ($z_i$) of all ions in the solution:\n$$I = \\frac{1}{2} \\sum_i z_i^2 c_i = \\frac{1}{2} (c_{\\mathrm{H^+}} \\cdot 1^2 + c_{\\mathrm{OH^-}} \\cdot (-1)^2 + c_{\\mathrm{HA^-}} \\cdot (-1)^2 + c_{\\mathrm{A^{2-}}} \\cdot (-2)^2 + c_{\\mathrm{Na^+}} \\cdot 1^2 + c_{\\mathrm{Cl^-}} \\cdot (-1)^2)$$\n$$I = C_s + \\frac{1}{2} (c_{\\mathrm{H^+}} + c_{\\mathrm{OH^-}} + c_{\\mathrm{HA^-}} + 4 c_{\\mathrm{A^{2-}}})$$\nThe activity coefficient $\\gamma_i$ for an ion of charge $z_i$ is calculated using the Davies equation at $T = 298.15\\,\\mathrm{K}$:\n$$\\log_{10} \\gamma_i = - 0.509 \\, z_i^2 \\left( \\frac{\\sqrt{I}}{1 + \\sqrt{I}} - 0.3 I \\right)$$\nFor $I=0$, $\\gamma_i=1$. Note that $\\gamma_{\\mathrm{H^+}} = \\gamma_{\\mathrm{OH^-}} = \\gamma_{\\mathrm{HA^-}}$, as their charge magnitudes are all $1$.\n\nTo solve this system, we select a master variable, $h \\equiv c_{\\mathrm{H^+}}$, and express all other concentrations in terms of it. This process is embedded within an iterative loop that converges on a self-consistent ionic strength $I$.\n\n**Iterative Solution Algorithm:**\n\nThe algorithm starts with an initial guess for the ionic strength, $I^{(0)}$, for instance, $I^{(0)} = C_s + C_T$. The following steps are repeated until $I$ converges.\n\n**Step 1: Calculate Activity Coefficients.**\nFor a given ionic strength $I^{(k)}$ at iteration $k$, we calculate the activity coefficients $\\gamma_{\\mathrm{H^+}}$, $\\gamma_{\\mathrm{OH^-}}$, $\\gamma_{\\mathrm{HA^-}}$, and $\\gamma_{\\mathrm{A^{2-}}}$ using the Davies equation. Let $\\gamma_1$ be the coefficient for ions with charge $\\pm 1$ and $\\gamma_2$ for ions with charge $\\pm 2$.\n\n**Step 2: Define Conditional Equilibrium Constants.**\nIt is convenient to rewrite the mass-action laws in terms of concentrations. We define conditional (or apparent) equilibrium constants, which depend on the ionic strength through the activity coefficients:\n$$K_{a1,c} = \\frac{c_{\\mathrm{H^+}} c_{\\mathrm{HA^-}}}{c_{\\mathrm{H_2A}}} = K_{a1}^\\circ \\frac{\\gamma_{\\mathrm{H_2A}}}{\\gamma_{\\mathrm{H^+}}\\gamma_{\\mathrm{HA^-}}} = \\frac{K_{a1}^\\circ}{\\gamma_1^2}$$\n$$K_{a2,c} = \\frac{c_{\\mathrm{H^+}} c_{\\mathrm{A^{2-}}}}{c_{\\mathrm{HA^-}}} = K_{a2}^\\circ \\frac{\\gamma_{\\mathrm{HA^-}}}{\\gamma_{\\mathrm{H^+}}\\gamma_{\\mathrm{A^{2-}}}} = \\frac{K_{a2}^\\circ}{\\gamma_2}$$\n$$K_{w,c} = c_{\\mathrm{H^+}} c_{\\mathrm{OH^-}} = K_w^\\circ / (\\gamma_{\\mathrm{H^+}}\\gamma_{\\mathrm{OH^-}}) = K_w^\\circ / \\gamma_1^2$$\n\n**Step 3: Solve the Master Equation for $h = c_{\\mathrm{H^+}}$.**\nUsing the conditional constants, we express the concentrations of all species in the charge balance equation as a function of $h$:\n$$c_{\\mathrm{OH^-}} = \\frac{K_{w,c}}{h} = \\frac{K_w^\\circ}{\\gamma_1^2 h}$$\nThe concentrations of the acid species can be expressed in terms of $C_T$ and $h$ using the mass balance constraint:\n$$c_{\\mathrm{H_2A}} = C_T \\frac{h^2}{h^2 + K_{a1,c} h + K_{a1,c} K_{a2,c}}$$\n$$c_{\\mathrm{HA^-}} = C_T \\frac{K_{a1,c} h}{h^2 + K_{a1,c} h + K_{a1,c} K_{a2,c}}$$\n$$c_{\\mathrm{A^{2-}}} = C_T \\frac{K_{a1,c} K_{a2,c}}{h^2 + K_{a1,c} h + K_{a1,c} K_{a2,c}}$$\nSubstituting these into the simplified charge balance equation yields a single master equation in $h$:\n$$f(h) = h - \\frac{K_w^\\circ}{\\gamma_1^2 h} - C_T \\left( \\frac{K_{a1,c} h + 2 K_{a1,c} K_{a2,c}}{h^2 + K_{a1,c} h + K_{a1,c} K_{a2,c}} \\right) = 0$$\nThis non-linear equation is solved for its root $h > 0$ using a numerical method, such as Brent's method, which is robust and efficient.\n\n**Step 4: Update Ionic Strength.**\nOnce the root $h$ is found, all equilibrium concentrations ($c_{\\mathrm{H^+}}$, $c_{\\mathrm{OH^-}}$, $c_{\\mathrm{H_2A}}$, $c_{\\mathrm{HA^-}}$, $c_{\\mathrm{A^{2-}}}$) are calculated. A new value for the ionic strength, $I^{(k+1)}$, is computed using its definition.\n\n**Step 5: Check for Convergence.**\nThe new ionic strength $I^{(k+1)}$ is compared to the previous value $I^{(k)}$. If they are sufficiently close (e.g., $|I^{(k+1)} - I^{(k)}|/I^{(k+1)} < \\epsilon$ for a small tolerance $\\epsilon$), the solution is self-consistent and the iteration terminates. Otherwise, we set $I^{(k)} \\leftarrow I^{(k+1)}$ and return to Step 1.\n\n**Step 6: Final Calculation.**\nUpon convergence, the final concentrations are known. The activity of the hydrogen ion is $a_{\\mathrm{H^+}} = \\gamma_1 c_{\\mathrm{H^+}}$, and the $pH$ is calculated according to its IUPAC definition:\n$$pH = -\\log_{10}(a_{\\mathrm{H^+}})$$\nThe program implements this algorithm to solve for each test case provided.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import brentq\n\ndef solve():\n    \"\"\"\n    Computes equilibrium speciation for a diprotic acid in an aqueous solution\n    with a background electrolyte, applying activity corrections via the Davies equation.\n    \"\"\"\n\n    # Thermodynamic constants at T = 298.15 K\n    PKA1_0 = 3.60\n    PKA2_0 = 8.20\n    PKW_0 = 14.0\n    KA1_0 = 10**(-PKA1_0)\n    KA2_0 = 10**(-PKA2_0)\n    KW_0 = 10**(-PKW_0)\n    A_DEBYE = 0.509  # Parameter for Davies equation in (mol/L)^(-1/2)\n\n    def compute_speciation_for_case(Ct, Cs):\n        \"\"\"\n        Solves the equilibrium for a single case of total acid concentration (Ct)\n        and background salt concentration (Cs).\n\n        Args:\n            Ct (float): Total analytical concentration of the diprotic acid H2A.\n            Cs (float): Concentration of the 1:1 inert electrolyte.\n\n        Returns:\n            list: A list containing [pH, c_H2A, c_HA, c_A2-].\n        \"\"\"\n        # Initial guess for ionic strength.\n        # A small value is used if both Ct and Cs are zero to avoid division by zero.\n        I = Cs + Ct if (Cs + Ct) > 0 else 1e-12\n\n        for _ in range(100):  # Iterative loop for self-consistency, max 100 iterations.\n            # Step 1: Calculate activity coefficients based on current ionic strength I.\n            if I > 0:\n                sqrt_I = np.sqrt(I)\n                davies_term = (sqrt_I / (1.0 + sqrt_I)) - 0.3 * I\n                # gamma1 for ions with |z|=1 (H+, OH-, HA-)\n                log10_gamma1 = -A_DEBYE * (1**2) * davies_term\n                gamma1 = 10**log10_gamma1\n                # gamma2 for ions with |z|=2 (A^2-)\n                log10_gamma2 = -A_DEBYE * (2**2) * davies_term\n                gamma2 = 10**log10_gamma2\n            else:  # For I = 0, all activity coefficients are 1.\n                gamma1, gamma2 = 1.0, 1.0\n\n            # Step 2: Define conditional equilibrium constants.\n            Ka1_c = KA1_0 / (gamma1**2)\n            Ka2_c = KA2_0 / gamma2\n\n            # Step 3: Define the master equation (charge balance residual) to find h = c_H+.\n            def charge_balance_residual(h):\n                if h = 0: return -1.0\n                \n                denom = h**2 + Ka1_c * h + Ka1_c * Ka2_c\n                if denom == 0: return h # Should not happen for h > 0\n                \n                c_OH = KW_0 / (gamma1**2 * h)\n                c_HA = Ct * Ka1_c * h / denom\n                c_A2 = Ct * Ka1_c * Ka2_c / denom\n                \n                return h - c_OH - c_HA - 2.0 * c_A2\n            \n            # Find the root h = c_H+ using Brent's method.\n            # The interval [1e-15, Ct + Cs + 1.0] safely brackets the physical root.\n            try:\n                h = brentq(charge_balance_residual, 1e-15, Ct + Cs + 1.0)\n            except ValueError:\n                # This error indicates the function does not have opposite signs at the\n                # interval ends, which implies a problem with the model or interval.\n                # For this problem, the chosen interval is safe.\n                raise RuntimeError(\"Root finding failed. The interval may not bracket the root.\")\n\n            # Step 4: Calculate all species concentrations and the new ionic strength.\n            c_H = h\n            c_OH = KW_0 / (gamma1**2 * c_H)\n            denom = c_H**2 + Ka1_c * c_H + Ka1_c * Ka2_c\n            c_H2A = Ct * c_H**2 / denom\n            c_HA = Ct * Ka1_c * c_H / denom\n            c_A2 = Ct * Ka1_c * Ka2_c / denom\n            \n            # Update ionic strength definition\n            I_new = Cs + 0.5 * (c_H + c_OH + c_HA + 4.0 * c_A2)\n\n            # Step 5: Check for convergence.\n            if I > 1e-15 and abs(I_new - I) / I_new  1e-12:\n                I = I_new\n                break\n            # Special case for nearly pure water where I remains extremely small.\n            elif I  1e-15 and I_new  1e-12:\n                break\n            \n            I = I_new\n        \n        # Step 6: Final calculation of pH.\n        a_H = gamma1 * c_H\n        pH = -np.log10(a_H)\n        \n        return [pH, c_H2A, c_HA, c_A2]\n\n    # Define the test cases from the problem statement.\n    # Each tuple is (C_T, I_b), where I_b is implemented as C_s.\n    test_cases = [\n        (1e-3, 1e-1),   # Case 1\n        (1e-8, 0.0),    # Case 2\n        (1e-2, 1e-2),   # Case 3\n        (5e-3, 5e-1),   # Case 4\n    ]\n\n    results = []\n    for Ct, Cs in test_cases:\n        result = compute_speciation_for_case(Ct, Cs)\n        results.append(result)\n\n    # Format the final output string as specified.\n    formatted_case_results = []\n    for res in results:\n        pH, c_H2A, c_HA, c_A2 = res\n        # Format pH to 6 decimal places and concentrations to 6 significant figures in scientific notation.\n        formatted_list = [\n            f\"{pH:.6f}\",\n            f\"{c_H2A:.6e}\",\n            f\"{c_HA:.6e}\",\n            f\"{c_A2:.6e}\"\n        ]\n        formatted_case_results.append(f\"[{','.join(formatted_list)}]\")\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(formatted_case_results)}]\")\n\nsolve()\n```", "id": "2628319"}]}