{"hands_on_practices": [{"introduction": "Predicting chemical equilibrium at temperatures far from standard conditions is a critical skill in process design and materials science. This practice guides you through the rigorous, first-principles calculation of an equilibrium constant, $K(T)$, for a gas-phase reaction at high temperature [@problem_id:2627926]. By integrating heat capacity data from a reference temperature, you will master the application of Kirchhoff's law to find the temperature-dependent $\\Delta_r H^\\circ(T)$ and $\\Delta_r S^\\circ(T)$, providing the foundation for accurate thermodynamic modeling.", "problem": "Consider the gas-phase water–gas shift reaction at standard pressure:\n\n$$\n\\ce{CO(g) + H2O(g) => CO2(g) + H2(g)}\n$$\n\nAssume ideal-gas behavior and the standard state at $p^\\circ = 1\\,\\text{bar}$ over the temperature range $T \\in [300\\,\\text{K}, 1500\\,\\text{K}]$. You are provided the following data at the reference temperature $T_0 = 298.15\\,\\text{K}$:\n- Standard molar enthalpies of formation $\\Delta_f H_i^\\circ(T_0)$ (in $\\text{kJ}\\,\\text{mol}^{-1}$): $\\ce{CO2(g)}$: $-393.51$, $\\ce{CO(g)}$: $-110.53$, $\\ce{H2O(g)}$: $-241.826$, $\\ce{H2(g)}$: $0$.\n- Standard molar entropies $S_i^\\circ(T_0)$ (in $\\text{J}\\,\\text{mol}^{-1}\\,\\text{K}^{-1}$): $\\ce{CO2(g)}$: $213.795$, $\\ce{CO(g)}$: $197.66$, $\\ce{H2O(g)}$: $188.83$, $\\ce{H2(g)}$: $130.68$.\n- Ideal-gas constant: $R = 8.314462618\\,\\text{J}\\,\\text{mol}^{-1}\\,\\text{K}^{-1}$.\n- Temperature-dependent standard molar heat capacities at constant pressure $C_{p,i}^\\circ(T)$ (in $\\text{J}\\,\\text{mol}^{-1}\\,\\text{K}^{-1}$), valid for $T \\in [300\\,\\text{K}, 1500\\,\\text{K}]$:\n\n$$\n\\begin{aligned}\nC_{p,\\ce{CO2}}^\\circ(T) = 36.88 + 1.10\\times 10^{-2}\\,T - 1.50\\times 10^{-6}\\,T^2,\\\\\nC_{p,\\ce{H2}}^\\circ(T)  = 28.82 + 1.00\\times 10^{-3}\\,T - 2.00\\times 10^{-7}\\,T^2,\\\\\nC_{p,\\ce{CO}}^\\circ(T)  = 29.14 + 6.30\\times 10^{-3}\\,T - 1.00\\times 10^{-6}\\,T^2,\\\\\nC_{p,\\ce{H2O}}^\\circ(T) = 30.10 + 1.00\\times 10^{-2}\\,T \\quad\\text{(the quadratic term is negligible over this range).}\n\\end{aligned}\n$$\n\nStarting only from fundamental thermodynamic relations and definitions appropriate to chemical equilibrium in the standard state, perform the following steps:\n- Express the standard reaction enthalpy $\\Delta_r H^\\circ(T)$ and standard reaction entropy $\\Delta_r S^\\circ(T)$ as functions of $T$ by systematically eliminating their temperature dependence in favor of integrals over the temperature-dependent standard molar heat capacities supplied above. Do not assume any temperature independence beyond what is stated.\n- Using your derived expressions, evaluate $\\Delta_r H^\\circ(T)$ and $\\Delta_r S^\\circ(T)$ at $T = 1200\\,\\text{K}$.\n- From first principles, connect the standard Gibbs free energy change of reaction to the equilibrium constant and compute the dimensionless equilibrium constant $K(T)$ at $T = 1200\\,\\text{K}$.\n\nRound your final numerical answer for $K(1200\\,\\text{K})$ to four significant figures. Report $K$ as a dimensionless quantity (no units). All intermediate expressions must be dimensionally consistent. Do not use any empirical “shortcut” formulas that bypass the derivations from fundamental definitions.", "solution": "The problem is scientifically grounded, self-contained, and well-posed. It presents a standard exercise in chemical thermodynamics requiring the application of fundamental principles to determine the temperature dependence of thermodynamic state functions and the equilibrium constant. We proceed to the solution.\n\nThe reaction is:\n$$ \\ce{CO(g) + H2O(g) => CO2(g) + H2(g)} $$\nThe stoichiometric coefficients $\\nu_i$ are: $\\nu_{\\ce{CO}} = -1$, $\\nu_{\\ce{H2O}} = -1$, $\\nu_{\\ce{CO2}} = +1$, and $\\nu_{\\ce{H2}} = +1$.\n\nFirst, we calculate the standard enthalpy and entropy of reaction at the reference temperature $T_0 = 298.15\\,\\text{K}$.\nThe standard reaction enthalpy, $\\Delta_r H^\\circ(T_0)$, is given by Hess's law:\n$$ \\Delta_r H^\\circ(T_0) = \\sum_i \\nu_i \\Delta_f H_i^\\circ(T_0) $$\n$$ \\Delta_r H^\\circ(T_0) = \\left[ \\Delta_f H_{\\ce{CO2}}^\\circ(T_0) + \\Delta_f H_{\\ce{H2}}^\\circ(T_0) \\right] - \\left[ \\Delta_f H_{\\ce{CO}}^\\circ(T_0) + \\Delta_f H_{\\ce{H2O}}^\\circ(T_0) \\right] $$\nUsing the provided data (in $\\text{kJ}\\,\\text{mol}^{-1}$):\n$$ \\Delta_r H^\\circ(T_0) = \\left[ (-393.51) + (0) \\right] - \\left[ (-110.53) + (-241.826) \\right] = -393.51 - (-352.356) = -41.154\\,\\text{kJ}\\,\\text{mol}^{-1} $$\n$$ \\Delta_r H^\\circ(T_0) = -41154\\,\\text{J}\\,\\text{mol}^{-1} $$\nThe standard reaction entropy, $\\Delta_r S^\\circ(T_0)$, is:\n$$ \\Delta_r S^\\circ(T_0) = \\sum_i \\nu_i S_i^\\circ(T_0) $$\n$$ \\Delta_r S^\\circ(T_0) = \\left[ S_{\\ce{CO2}}^\\circ(T_0) + S_{\\ce{H2}}^\\circ(T_0) \\right] - \\left[ S_{\\ce{CO}}^\\circ(T_0) + S_{\\ce{H2O}}^\\circ(T_0) \\right] $$\nUsing the provided data (in $\\text{J}\\,\\text{mol}^{-1}\\,\\text{K}^{-1}$):\n$$ \\Delta_r S^\\circ(T_0) = \\left[ 213.795 + 130.68 \\right] - \\left[ 197.66 + 188.83 \\right] = 344.475 - 386.49 = -42.015\\,\\text{J}\\,\\text{mol}^{-1}\\,\\text{K}^{-1} $$\nNext, we determine the temperature dependence of $\\Delta_r H^\\circ$ and $\\Delta_r S^\\circ$. This requires the change in standard molar heat capacity for the reaction, $\\Delta_r C_p^\\circ(T) = \\sum_i \\nu_i C_{p,i}^\\circ(T)$. The heat capacity for each species is given by a polynomial in $T$. We find the polynomial for $\\Delta_r C_p^\\circ(T) = \\Delta A + \\Delta B \\, T + \\Delta C \\, T^2$.\n$$ \\Delta A = [ (36.88) + (28.82) ] - [ (29.14) + (30.10) ] = 6.46\\,\\text{J}\\,\\text{mol}^{-1}\\,\\text{K}^{-1} $$\n$$ \\Delta B = [ (1.10\\times 10^{-2}) + (1.00\\times 10^{-3}) ] - [ (6.30\\times 10^{-3}) + (1.00\\times 10^{-2}) ] = -4.30\\times 10^{-3}\\,\\text{J}\\,\\text{mol}^{-1}\\,\\text{K}^{-2} $$\n$$ \\Delta C = [ (-1.50\\times 10^{-6}) + (-2.00\\times 10^{-7}) ] - [ (-1.00\\times 10^{-6}) + (0) ] = -7.00\\times 10^{-7}\\,\\text{J}\\,\\text{mol}^{-1}\\,\\text{K}^{-3} $$\nThus, the expression for the change in heat capacity is:\n$$ \\Delta_r C_p^\\circ(T) = 6.46 - (4.30\\times 10^{-3}) T - (7.00\\times 10^{-7}) T^2 $$\nThe temperature dependence of the reaction enthalpy is given by Kirchhoff's law:\n$$ \\frac{d(\\Delta_r H^\\circ)}{dT} = \\Delta_r C_p^\\circ(T) $$\nIntegrating from $T_0$ to $T$:\n$$ \\Delta_r H^\\circ(T) = \\Delta_r H^\\circ(T_0) + \\int_{T_0}^T \\Delta_r C_p^\\circ(T')\\,dT' $$\n$$ \\Delta_r H^\\circ(T) = \\Delta_r H^\\circ(T_0) + \\int_{T_0}^T (\\Delta A + \\Delta B \\, T' + \\Delta C \\, T'^2)\\,dT' $$\n$$ \\Delta_r H^\\circ(T) = \\Delta_r H^\\circ(T_0) + \\left[ \\Delta A T' + \\frac{\\Delta B}{2} T'^2 + \\frac{\\Delta C}{3} T'^3 \\right]_{T_0}^T $$\nAt $T = 1200\\,\\text{K}$ and $T_0 = 298.15\\,\\text{K}$:\n$$ \\int_{298.15}^{1200} \\Delta_r C_p^\\circ(T')\\,dT' = \\left[ 6.46 T' - \\frac{4.30\\times 10^{-3}}{2} T'^2 - \\frac{7.00\\times 10^{-7}}{3} T'^3 \\right]_{298.15}^{1200} $$\nThe value of the definite integral is $2524.05\\,\\text{J}\\,\\text{mol}^{-1}$.\n$$ \\Delta_r H^\\circ(1200\\,\\text{K}) = -41154\\,\\text{J}\\,\\text{mol}^{-1} + 2524.05\\,\\text{J}\\,\\text{mol}^{-1} = -38629.95\\,\\text{J}\\,\\text{mol}^{-1} $$\nThe temperature dependence of the reaction entropy is given by:\n$$ \\frac{d(\\Delta_r S^\\circ)}{dT} = \\frac{\\Delta_r C_p^\\circ(T)}{T} $$\nIntegrating from $T_0$ to $T$:\n$$ \\Delta_r S^\\circ(T) = \\Delta_r S^\\circ(T_0) + \\int_{T_0}^T \\frac{\\Delta_r C_p^\\circ(T')}{T'}\\,dT' $$\n$$ \\Delta_r S^\\circ(T) = \\Delta_r S^\\circ(T_0) + \\int_{T_0}^T \\left(\\frac{\\Delta A}{T'} + \\Delta B + \\Delta C T'\\right)\\,dT' $$\n$$ \\Delta_r S^\\circ(T) = \\Delta_r S^\\circ(T_0) + \\left[ \\Delta A \\ln(T') + \\Delta B T' + \\frac{\\Delta C}{2} T'^2 \\right]_{T_0}^T $$\nAt $T = 1200\\,\\text{K}$ and $T_0 = 298.15\\,\\text{K}$:\n$$ \\int_{298.15}^{1200} \\frac{\\Delta_r C_p^\\circ(T')}{T'}\\,dT' = \\left[ 6.46 \\ln(T') - (4.30\\times 10^{-3}) T' - \\frac{7.00\\times 10^{-7}}{2} T'^2 \\right]_{298.15}^{1200} $$\nThe value of this definite integral is $4.6445\\,\\text{J}\\,\\text{mol}^{-1}\\,\\text{K}^{-1}$.\n$$ \\Delta_r S^\\circ(1200\\,\\text{K}) = -42.015\\,\\text{J}\\,\\text{mol}^{-1}\\,\\text{K}^{-1} + 4.6445\\,\\text{J}\\,\\text{mol}^{-1}\\,\\text{K}^{-1} = -37.3705\\,\\text{J}\\,\\text{mol}^{-1}\\,\\text{K}^{-1} $$\nThe standard Gibbs free energy of reaction, $\\Delta_r G^\\circ(T)$, is defined as $\\Delta_r G^\\circ(T) = \\Delta_r H^\\circ(T) - T \\Delta_r S^\\circ(T)$. At $T = 1200\\,\\text{K}$:\n$$ \\Delta_r G^\\circ(1200\\,\\text{K}) = (-38629.95\\,\\text{J}\\,\\text{mol}^{-1}) - (1200\\,\\text{K})(-37.3705\\,\\text{J}\\,\\text{mol}^{-1}\\,\\text{K}^{-1}) $$\n$$ \\Delta_r G^\\circ(1200\\,\\text{K}) = -38629.95 + 44844.60 = 6214.65\\,\\text{J}\\,\\text{mol}^{-1} $$\nFrom first principles, the relationship between the standard Gibbs free energy change and the dimensionless equilibrium constant $K(T)$ is:\n$$ \\Delta_r G^\\circ(T) = -RT \\ln K(T) $$\nwhere $R$ is the ideal-gas constant. Rearranging for $K(T)$:\n$$ K(T) = \\exp\\left( -\\frac{\\Delta_r G^\\circ(T)}{RT} \\right) $$\nWe can now compute the equilibrium constant at $T = 1200\\,\\text{K}$, using $R = 8.314462618\\,\\text{J}\\,\\text{mol}^{-1}\\,\\text{K}^{-1}$.\n$$ K(1200\\,\\text{K}) = \\exp\\left( -\\frac{6214.65}{8.314462618 \\times 1200} \\right) = \\exp\\left( -0.62287 \\right) $$\n$$ K(1200\\,\\text{K}) = 0.536417... $$\nRounding to four significant figures as required, the dimensionless equilibrium constant is $0.5364$.", "answer": "$$\n\\boxed{0.5364}\n$$", "id": "2627926"}, {"introduction": "While ideal-gas and ideal-solution models provide a useful baseline, most real-world chemical systems in the condensed phase exhibit non-ideal behavior. This exercise introduces the concept of activity and the regular solution model to quantify the effects of intermolecular interactions on chemical equilibrium [@problem_id:2627929]. You will derive expressions for activity coefficients from the excess Gibbs free energy and calculate how non-ideality directly modifies the reaction quotient, a crucial step in modeling liquid-phase reactions.", "problem": "A binary liquid mixture of components $1$ and $2$ at constant temperature $T$ and pressure $P$ is described by the regular solution model with molar excess Gibbs free energy $g^{E}$ given by\n$$\ng^{E}(T,P,\\{x_i\\})=\\Omega\\,x_{1}x_{2},\n$$\nwhere $\\Omega$ is a temperature-independent interaction parameter and $x_{i}$ are mole fractions. The activity coefficients $\\gamma_{i}$ are defined by the excess chemical potentials via $RT\\ln\\gamma_{i}=\\mu_{i}^{E}$, and the reaction quotient $Q$ for a unimolecular isomerization reaction $1 \\rightleftharpoons 2$ in this liquid phase is given by\n$$\nQ=\\frac{a_{2}}{a_{1}}=\\frac{\\gamma_{2}x_{2}}{\\gamma_{1}x_{1}}.\n$$\n\nStarting only from the definitions of $g^{E}$, $\\mu_{i}^{E}$, and $Q$, and the relations among total moles $n$, partial mole numbers $n_{i}$, and mole fractions $x_{i}=n_{i}/n$, do the following:\n\n1) Derive expressions for $\\ln \\gamma_{1}$ and $\\ln \\gamma_{2}$ as functions of $x_{1}$, $x_{2}$, $T$, $R$, and $\\Omega$.\n\n2) At fixed composition $x_{1}=0.35$ and $x_{2}=0.65$, quantify how nonideality alters the reaction quotient relative to the ideal-solution estimate by computing the multiplicative factor\n$$\nM \\equiv \\frac{Q_{\\text{nonideal}}}{Q_{\\text{ideal}}}=\\frac{\\gamma_{2}}{\\gamma_{1}},\n$$\nfor $T=298.15\\ \\text{K}$, $\\Omega=2.500\\times 10^{3}\\ \\text{J mol}^{-1}$, and $R=8.314462618\\ \\text{J mol}^{-1}\\text{K}^{-1}$.\n\nRound your final numerical answer for $M$ to four significant figures. Express the final answer as a pure number (no units).", "solution": "The problem statement has been validated and is found to be scientifically grounded, well-posed, objective, and complete. It is a standard problem in physical chemistry thermodynamics.\n\nThe solution proceeds in two parts as requested.\n\nPart 1: Derivation of expressions for $\\ln \\gamma_{1}$ and $\\ln \\gamma_{2}$.\n\nThe starting point is the molar excess Gibbs free energy, $g^{E}$, for a regular solution:\n$$\ng^{E} = \\Omega x_{1}x_{2}\n$$\nThe total excess Gibbs free energy of the system, $G^{E}$, containing $n$ total moles is given by $G^{E} = n g^{E}$. With mole fractions defined as $x_{i} = n_{i}/n$, where $n = n_{1} + n_{2}$, we can write $G^{E}$ in terms of the mole numbers $n_{1}$ and $n_{2}$:\n$$\nG^{E} = (n_{1}+n_{2}) \\left( \\Omega \\frac{n_{1}}{n_{1}+n_{2}} \\frac{n_{2}}{n_{1}+n_{2}} \\right) = \\frac{\\Omega n_{1}n_{2}}{n_{1}+n_{2}}\n$$\nThe excess chemical potential of component $i$, $\\mu_{i}^{E}$, is defined as the partial molar excess Gibbs free energy. This is the partial derivative of the total excess Gibbs free energy $G^{E}$ with respect to the mole number $n_{i}$, holding temperature $T$, pressure $P$, and the mole numbers of all other components $n_{j \\neq i}$ constant:\n$$\n\\mu_{i}^{E} = \\left( \\frac{\\partial G^{E}}{\\partial n_{i}} \\right)_{T, P, n_{j \\neq i}}\n$$\nWe apply this definition to find $\\mu_{1}^{E}$ and $\\mu_{2}^{E}$. For component $1$:\n$$\n\\mu_{1}^{E} = \\left( \\frac{\\partial}{\\partial n_{1}} \\left[ \\frac{\\Omega n_{1}n_{2}}{n_{1}+n_{2}} \\right] \\right)_{T, P, n_{2}}\n$$\nUsing the quotient rule for differentiation, where $u = \\Omega n_{1}n_{2}$ and $v = n_{1}+n_{2}$:\n$$\n\\mu_{1}^{E} = \\frac{(n_{1}+n_{2})\\left(\\frac{\\partial (\\Omega n_{1}n_{2})}{\\partial n_{1}}\\right) - (\\Omega n_{1}n_{2})\\left(\\frac{\\partial (n_{1}+n_{2})}{\\partial n_{1}}\\right)}{(n_{1}+n_{2})^{2}}\n$$\n$$\n\\mu_{1}^{E} = \\frac{(n_{1}+n_{2})(\\Omega n_{2}) - (\\Omega n_{1}n_{2})(1)}{(n_{1}+n_{2})^{2}} = \\frac{\\Omega n_{1}n_{2} + \\Omega n_{2}^{2} - \\Omega n_{1}n_{2}}{(n_{1}+n_{2})^{2}}\n$$\n$$\n\\mu_{1}^{E} = \\frac{\\Omega n_{2}^{2}}{(n_{1}+n_{2})^{2}}\n$$\nSubstituting the definition of the mole fraction $x_{2} = n_{2}/(n_{1}+n_{2})$, we find:\n$$\n\\mu_{1}^{E} = \\Omega x_{2}^{2}\n$$\nBy symmetry of the expression for $G^{E}$ with respect to $n_{1}$ and $n_{2}$, we can immediately write the expression for $\\mu_{2}^{E}$ by swapping indices $1 \\leftrightarrow 2$:\n$$\n\\mu_{2}^{E} = \\Omega x_{1}^{2}\n$$\nAlternatively, one can perform the explicit differentiation for $\\mu_{2}^{E}$:\n$$\n\\mu_{2}^{E} = \\left( \\frac{\\partial}{\\partial n_{2}} \\left[ \\frac{\\Omega n_{1}n_{2}}{n_{1}+n_{2}} \\right] \\right)_{T, P, n_{1}} = \\frac{(n_{1}+n_{2})(\\Omega n_{1}) - (\\Omega n_{1}n_{2})(1)}{(n_{1}+n_{2})^{2}} = \\frac{\\Omega n_{1}^{2}}{(n_{1}+n_{2})^{2}} = \\Omega x_{1}^{2}\n$$\nThe problem states the relationship between the excess chemical potential and the activity coefficient $\\gamma_{i}$ is $RT\\ln\\gamma_{i}=\\mu_{i}^{E}$. Rearranging for $\\ln \\gamma_{i}$ gives:\n$$\n\\ln\\gamma_{i} = \\frac{\\mu_{i}^{E}}{RT}\n$$\nSubstituting the derived expressions for $\\mu_{1}^{E}$ and $\\mu_{2}^{E}$, we obtain the required expressions:\n$$\n\\ln \\gamma_{1} = \\frac{\\Omega x_{2}^{2}}{RT}\n\\quad \\text{and} \\quad\n\\ln \\gamma_{2} = \\frac{\\Omega x_{1}^{2}}{RT}\n$$\n\nPart 2: Calculation of the multiplicative factor $M$.\n\nThe multiplicative factor $M$ is defined as the ratio of the non-ideal reaction quotient to the ideal-solution reaction quotient:\n$$\nM \\equiv \\frac{Q_{\\text{nonideal}}}{Q_{\\text{ideal}}}\n$$\nFor an ideal solution, the activity coefficients are unity, $\\gamma_{1}=\\gamma_{2}=1$, so $Q_{\\text{ideal}} = x_{2}/x_{1}$. The non-ideal reaction quotient is given as $Q_{\\text{nonideal}} = (\\gamma_{2}x_{2})/(\\gamma_{1}x_{1})$. Thus, $M$ simplifies to the ratio of the activity coefficients:\n$$\nM = \\frac{(\\gamma_{2}x_{2})/(\\gamma_{1}x_{1})}{x_{2}/x_{1}} = \\frac{\\gamma_{2}}{\\gamma_{1}}\n$$\nTo calculate $M$, we first evaluate its natural logarithm, $\\ln M$:\n$$\n\\ln M = \\ln \\left( \\frac{\\gamma_{2}}{\\gamma_{1}} \\right) = \\ln \\gamma_{2} - \\ln \\gamma_{1}\n$$\nUsing the expressions derived in Part 1:\n$$\n\\ln M = \\frac{\\Omega x_{1}^{2}}{RT} - \\frac{\\Omega x_{2}^{2}}{RT} = \\frac{\\Omega}{RT} (x_{1}^{2} - x_{2}^{2})\n$$\nUsing the algebraic identity $a^2 - b^2 = (a-b)(a+b)$ and the property of mole fractions $x_{1}+x_{2}=1$:\n$$\n\\ln M = \\frac{\\Omega}{RT} (x_{1}-x_{2})(x_{1}+x_{2}) = \\frac{\\Omega}{RT} (x_{1}-x_{2})\n$$\nWe are given the following values:\n$x_{1}=0.35$\n$x_{2}=0.65$\n$\\Omega=2.500\\times 10^{3}\\ \\text{J mol}^{-1}$\n$T=298.15\\ \\text{K}$\n$R=8.314462618\\ \\text{J mol}^{-1}\\text{K}^{-1}$\n\nFirst, we compute the product $RT$:\n$$\nRT = (8.314462618\\ \\text{J mol}^{-1}\\text{K}^{-1}) \\times (298.15\\ \\text{K}) \\approx 2478.9557\\ \\text{J mol}^{-1}\n$$\nNext, we compute the difference in mole fractions:\n$$\nx_{1}-x_{2} = 0.35 - 0.65 = -0.30\n$$\nNow, substitute these values into the expression for $\\ln M$:\n$$\n\\ln M = \\frac{2.500 \\times 10^{3}\\ \\text{J mol}^{-1}}{2478.9557\\ \\text{J mol}^{-1}} (-0.30)\n$$\n$$\n\\ln M \\approx (1.0084889) \\times (-0.30) \\approx -0.30254667\n$$\nFinally, we calculate $M$ by taking the exponential of $\\ln M$:\n$$\nM = \\exp(\\ln M) = \\exp(-0.30254667) \\approx 0.7389335\n$$\nRounding the result to four significant figures as required gives:\n$$\nM \\approx 0.7389\n$$\nThis result indicates that due to non-ideality, the reaction quotient for the isomerization in this mixture is reduced to approximately $73.89\\%$ of its value in an ideal solution of the same composition.", "answer": "$$\n\\boxed{0.7389}\n$$", "id": "2627929"}, {"introduction": "For many non-ideal systems, especially under conditions where phase behavior becomes complex, equilibrium compositions cannot be found through simple algebra. This advanced practice challenges you to bridge thermodynamic theory and computational science by developing a numerical solver for a non-ideal isomerization reaction [@problem_id:2627907]. You will implement an interior-point algorithm to solve the equilibrium condition derived from the Margules model and the van 't Hoff equation, building a robust tool that reflects modern approaches to chemical process simulation.", "problem": "Consider a closed, isothermal, isobaric binary liquid mixture undergoing the isomerization reaction $\\mathrm{A} \\rightleftharpoons \\mathrm{B}$ at temperature $T$. Assume the following physically realistic and widely used model assumptions as the only starting points:\n\n- Chemical potentials: For each species $i \\in \\{\\mathrm{A},\\mathrm{B}\\}$ in a liquid solution, the chemical potential is $\\mu_i(T) = \\mu_i^\\circ(T) + RT \\ln a_i$, where $R$ is the universal gas constant, $a_i$ is the activity, and $\\mu_i^\\circ(T)$ is the standard chemical potential at $T$ for the chosen standard state.\n- Standard state and activities: Use the pure-liquid standard state at $T$, with activities $a_i = \\gamma_i x_i$, where $x_i$ is the mole fraction of species $i$ and $\\gamma_i$ is its activity coefficient.\n- Nonideality model: Model nonideality using the symmetric two-suffix Margules excess Gibbs free energy model with a single, positive, dimensionless parameter $A$. For a binary mixture with $x_{\\mathrm{B}} = x$ and $x_{\\mathrm{A}} = 1 - x$, the activity coefficient relations are $\\ln \\gamma_{\\mathrm{A}} = A x^2$ and $\\ln \\gamma_{\\mathrm{B}} = A (1 - x)^2$.\n- Reaction equilibrium: For the isomerization reaction, the equilibrium condition is $\\nu_{\\mathrm{A}} \\mu_{\\mathrm{A}} + \\nu_{\\mathrm{B}} \\mu_{\\mathrm{B}} = 0$, with stoichiometric coefficients $\\nu_{\\mathrm{A}} = -1$ and $\\nu_{\\mathrm{B}} = +1$.\n- Temperature dependence of the equilibrium constant: Use the well-tested van 't Hoff relationship (assuming temperature-independent standard enthalpy change $\\Delta H^\\circ$) to propagate the equilibrium constant $K(T)$ from a reference temperature $T_{\\mathrm{ref}}$ at which the standard Gibbs free energy change $\\Delta G^\\circ(T_{\\mathrm{ref}})$ is known. Define $K(T_{\\mathrm{ref}}) = \\exp\\!\\left(-\\dfrac{\\Delta G^\\circ(T_{\\mathrm{ref}})}{R T_{\\mathrm{ref}}}\\right)$ and use $\\dfrac{d \\ln K}{d(1/T)} = -\\dfrac{\\Delta H^\\circ}{R}$ to obtain $\\ln K(T) = \\ln K(T_{\\mathrm{ref}}) - \\dfrac{\\Delta H^\\circ}{R} \\left(\\dfrac{1}{T} - \\dfrac{1}{T_{\\mathrm{ref}}}\\right)$.\n\nYour task is to derive, from these bases only (no shortcut formulas), a robust, numerically stable algorithm that computes the equilibrium composition $x_{\\mathrm{B}}^\\mathrm{eq} \\in (0,1)$ for given $(T, A, \\Delta H^\\circ, \\Delta G^\\circ(T_{\\mathrm{ref}}), T_{\\mathrm{ref}})$ by enforcing the reaction equilibrium condition with nonideal activities. You must implement an interior-point algorithm using a logarithmic barrier to handle the inequality constraints $x_{\\mathrm{B}} \\in (0,1)$ while solving the stationarity condition implied by the equilibrium requirement. Your algorithm should:\n\n- Formulate a smooth scalar residual based on the reaction equilibrium condition that equals zero at equilibrium.\n- Construct a barrier-augmented merit function using a logarithmic barrier that enforces $x_{\\mathrm{B}} \\in (0,1)$.\n- Apply a damped Newton or quasi-Newton update that respects the barrier and employs backtracking to ensure global convergence.\n- Terminate when a clearly stated, numerically meaningful stopping criterion holds.\n\nLe Châtelier's principle must be reflected in the outputs across temperatures: for endothermic reactions with $\\Delta H^\\circ  0$, the equilibrium composition of the product species $\\mathrm{B}$ should increase with $T$, all else equal; for exothermic reactions, the converse holds. The dependence arises via $K(T)$ as encoded by the van 't Hoff relation.\n\nPhysical units and constants:\n\n- Use $R = 8.314462618\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$ as the universal gas constant. In mathematical expressions, write $R$ as $R$ and $8.314462618$ as $8.314462618$.\n- Temperatures must be in $\\mathrm{K}$, enthalpies and Gibbs free energies in $\\mathrm{J}\\,\\mathrm{mol}^{-1}$, and mole fractions are dimensionless.\n- Your program must report $x_{\\mathrm{B}}^\\mathrm{eq}$ for each test case as a floating-point number rounded to six decimal places (unitless).\n\nTest suite:\n\nFor each case below, compute the equilibrium mole fraction $x_{\\mathrm{B}}^\\mathrm{eq}$ of species $\\mathrm{B}$ at temperature $T$ using the specified parameters. Use the initial guess $x_{\\mathrm{B}}^{(0)}$ to initialize the interior-point iterations. Each tuple lists $\\left(T, A, \\Delta H^\\circ, \\Delta G^\\circ(T_{\\mathrm{ref}}), T_{\\mathrm{ref}}, x_{\\mathrm{B}}^{(0)}\\right)$.\n\n- Case $1$: $(298.15, 1.2, 15000, 2000, 298.15, 0.5)$\n- Case $2$: $(350.0, 1.2, 15000, 2000, 298.15, 0.01)$\n- Case $3$: $(250.0, 1.2, 15000, 2000, 298.15, 0.99)$\n- Case $4$: $(298.15, 4.0, 15000, 2000, 298.15, 0.5)$\n- Case $5$: $(700.0, 0.0, 15000, 2000, 298.15, 0.5)$\n\nAll numbers in parentheses are in the order $(T\\,\\mathrm{[K]}, A\\,\\mathrm{[\\,dimensionless\\,]}, \\Delta H^\\circ\\,\\mathrm{[J/mol]}, \\Delta G^\\circ(T_{\\mathrm{ref}})\\,\\mathrm{[J/mol]}, T_{\\mathrm{ref}}\\,\\mathrm{[K]}, x_{\\mathrm{B}}^{(0)}\\,\\mathrm{[unitless]})$.\n\nFinal output format:\n\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, for example, $[r_1,r_2,r_3,r_4,r_5]$, where each $r_i$ is the computed $x_{\\mathrm{B}}^\\mathrm{eq}$ for Case $i$, rounded to six decimal places.", "solution": "The problem as stated is scientifically grounded, well-posed, and free of contradictions. It presents a standard problem in chemical reaction thermodynamics, requiring the application of first principles to derive a numerical solution. The physical model, based on the two-suffix Margules equation for a binary mixture and the van 't Hoff relation for temperature dependence, is a valid and commonly used framework. The task of deriving and implementing a custom interior-point Newton solver is a rigorous exercise in numerical methods applied to physical chemistry. We proceed with the derivation and solution.\n\nThe fundamental condition for chemical equilibrium for the reaction $\\mathrm{A} \\rightleftharpoons \\mathrm{B}$ at constant temperature $T$ and pressure $P$ is the stationarity of the Gibbs free energy with respect to the extent of reaction. This is equivalent to the condition that the chemical potentials $\\mu_i$ of the species involved satisfy $\\sum_i \\nu_i \\mu_i = 0$, where $\\nu_i$ are the stoichiometric coefficients. For the given reaction, $\\nu_{\\mathrm{A}} = -1$ and $\\nu_{\\mathrm{B}} = +1$, so the equilibrium condition is:\n$$\n\\mu_{\\mathrm{B}} - \\mu_{\\mathrm{A}} = 0\n$$\nThe chemical potential of species $i$ in the liquid mixture is given by $\\mu_i(T) = \\mu_i^\\circ(T) + RT \\ln a_i$, where $\\mu_i^\\circ(T)$ is the standard state chemical potential, $R$ is the universal gas constant, and $a_i$ is the activity. Substituting this into the equilibrium condition yields:\n$$\n(\\mu_{\\mathrm{B}}^\\circ(T) - \\mu_{\\mathrm{A}}^\\circ(T)) + RT(\\ln a_{\\mathrm{B}} - \\ln a_{\\mathrm{A}}) = 0\n$$\nThe term $\\mu_{\\mathrm{B}}^\\circ(T) - \\mu_{\\mathrm{A}}^\\circ(T)$ is the standard Gibbs free energy of reaction, $\\Delta G^\\circ(T)$, which is related to the thermodynamic equilibrium constant $K(T)$ by $\\Delta G^\\circ(T) = -RT \\ln K(T)$. The equation becomes:\n$$\n-RT \\ln K(T) + RT \\ln\\left(\\frac{a_{\\mathrm{B}}}{a_{\\mathrm{A}}}\\right) = 0 \\implies K(T) = \\frac{a_{\\mathrm{B}}}{a_{\\mathrm{A}}}\n$$\nThis is the general expression for the equilibrium constant in terms of activities.\n\nLet $x$ be the mole fraction of species $\\mathrm{B}$, so $x_{\\mathrm{B}} = x$ and $x_{\\mathrm{A}} = 1 - x$. The domain for the mole fraction is $x \\in (0,1)$. The activities are given by $a_i = \\gamma_i x_i$, with the two-suffix Margules model for the activity coefficients $\\gamma_i$:\n$$\n\\ln \\gamma_{\\mathrm{A}} = A x^2\n$$\n$$\n\\ln \\gamma_{\\mathrm{B}} = A (1 - x)^2\n$$\nSubstituting these into the activity expressions:\n$$\na_{\\mathrm{A}} = (1 - x) \\exp(A x^2)\n$$\n$$\na_{\\mathrm{B}} = x \\exp(A (1 - x)^2)\n$$\nThe equilibrium condition $K(T) = a_{\\mathrm{B}}/a_{\\mathrm{A}}$ becomes:\n$$\nK(T) = \\frac{x \\exp(A(1-x)^2)}{(1-x) \\exp(Ax^2)} = \\frac{x}{1-x} \\exp\\left(A(1-x)^2 - Ax^2\\right)\n$$\nThe exponent simplifies to $A(1 - 2x + x^2 - x^2) = A(1-2x)$. Thus, the equation to be solved for the equilibrium mole fraction $x$ is:\n$$\nK(T) = \\frac{x}{1-x} \\exp(A(1-2x))\n$$\nFor numerical stability, it is superior to work with the logarithmic form of this equation. We define a residual function $f(x)$ whose root is the equilibrium composition:\n$$\nf(x) = \\ln(x) - \\ln(1-x) + A(1-2x) - \\ln K(T) = 0\n$$\nThe value of $\\ln K(T)$ is determined from the provided thermodynamic data using the integrated van 't Hoff equation, assuming a temperature-independent standard enthalpy of reaction $\\Delta H^\\circ$:\n$$\n\\ln K(T) = \\ln K(T_{\\mathrm{ref}}) - \\frac{\\Delta H^\\circ}{R} \\left(\\frac{1}{T} - \\frac{1}{T_{\\mathrm{ref}}}\\right)\n$$\nwhere $\\ln K(T_{\\mathrm{ref}}) = -\\frac{\\Delta G^\\circ(T_{\\mathrm{ref}})}{R T_{\\mathrm{ref}}}$.\n\nTo solve $f(x) = 0$ for $x \\in (0,1)$, we implement a damped interior-point Newton-Raphson algorithm. This method is robust and respects the physical boundaries of the mole fraction. The iterative update rule for Newton's method is:\n$$\nx_{k+1} = x_k - \\alpha_k \\frac{f(x_k)}{f'(x_k)}\n$$\nwhere $x_k$ is the estimate at iteration $k$, and $\\alpha_k \\in (0,1]$ is a step size determined by a line search. The derivative of the residual function, $f'(x)$, is required:\n$$\nf'(x) = \\frac{d}{dx} \\left(\\ln(x) - \\ln(1-x) + A(1-2x) - \\ln K(T)\\right) = \\frac{1}{x} + \\frac{1}{1-x} - 2A\n$$\nThe logarithmic terms in $f(x)$ serve as a natural barrier, as $f(x) \\to -\\infty$ as $x \\to 0^+$ and $f(x) \\to +\\infty$ as $x \\to 1^-$. Our algorithm must ensure that all iterates $x_k$ remain strictly within the open interval $(0,1)$.\n\nThe algorithm proceeds as follows:\n1.  **Initialization**: Given an initial guess $x_0 \\in (0,1)$.\n2.  **Iteration**: For $k=0, 1, 2, ...$:\n    a.  Compute the residual $r_k = f(x_k)$ and its derivative $d_k = f'(x_k)$.\n    b.  If $|r_k|$ is below a specified tolerance $\\epsilon_{\\mathrm{res}}$, the solution is found.\n    c.  Compute the raw Newton step: $p_k = -r_k / d_k$.\n    d.  **Line Search for Step Size $\\alpha_k$**:\n        i.  Initialize $\\alpha_k = 1$.\n        ii. **Boundary Enforcement**: To ensure $x_{k+1} \\in (0,1)$, the step size $\\alpha_k$ must be limited. If $p_k  0$, the maximum possible step is $\\alpha_{\\max} = (1 - x_k) / p_k$. If $p_k  0$, $\\alpha_{\\max} = -x_k / p_k$. We cap the step size at $\\alpha_k = \\min(\\alpha_k, \\delta \\cdot \\alpha_{\\max})$, where $\\delta \\in (0,1)$ is a safety factor (e.g., $0.995$) to stay strictly inside the domain.\n        iii. **Damping (Backtracking)**: To ensure convergence, we check if the step reduces the squared residual. If $f(x_k + \\alpha_k p_k)^2 \\ge f(x_k)^2$, the step is too large. We repeatedly reduce $\\alpha_k$ by a factor $\\beta \\in (0,1)$ (e.g., $0.5$) until the condition $f(x_k + \\alpha_k p_k)^2  (1 - c_1 \\alpha_k) f(x_k)^2$ is met, where $c_1$ is a small constant (e.g., $10^{-4}$). This is the Armijo-Goldstein condition.\n    e.  **Update**: Set $x_{k+1} = x_k + \\alpha_k p_k$.\n    f. Check for convergence based on the step size: if $|\\alpha_k p_k|  \\epsilon_{\\mathrm{step}}$, terminate.\n3.  **Termination**: The loop terminates upon convergence or if a maximum number of iterations is exceeded.\n\nThis algorithm is robust for this problem, including for cases where non-ideality is strong ($A  2$) and multiple physical equilibria may exist. The outcome in such cases will depend on the provided initial guess $x_0$. The implementation will follow this logic.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main entry point to solve the problem for the given test suite.\n    It computes the equilibrium mole fraction for each case and prints the results\n    in the specified format.\n    \"\"\"\n\n    R_GAS_CONSTANT = 8.314462618  # J mol^-1 K^-1\n\n    # Test suite: (T, A, dH_std, dG_std_ref, T_ref, x_initial)\n    test_cases = [\n        (298.15, 1.2, 15000, 2000, 298.15, 0.5),\n        (350.0, 1.2, 15000, 2000, 298.15, 0.01),\n        (250.0, 1.2, 15000, 2000, 298.15, 0.99),\n        (298.15, 4.0, 15000, 2000, 298.15, 0.5),\n        (700.0, 0.0, 15000, 2000, 298.15, 0.5),\n    ]\n\n    def compute_equilibrium(T, A, dH_std, dG_std_ref, T_ref, x_initial):\n        \"\"\"\n        Computes the equilibrium mole fraction x_B using a damped interior-point\n        Newton-Raphson method.\n\n        Args:\n            T (float): Temperature (K).\n            A (float): Margules parameter (dimensionless).\n            dH_std (float): Standard enthalpy of reaction (J/mol).\n            dG_std_ref (float): Standard Gibbs free energy of reaction at T_ref (J/mol).\n            T_ref (float): Reference temperature (K).\n            x_initial (float): Initial guess for the mole fraction of B.\n\n        Returns:\n            float: The equilibrium mole fraction of B.\n        \"\"\"\n        # --- Algorithm Parameters ---\n        max_iter = 100\n        tol_res = 1.0e-12  # Residual tolerance\n        tol_x = 1.0e-12    # Step tolerance\n        boundary_factor = 0.995  # Factor to stay away from 0 and 1\n        backtrack_factor = 0.5   # Damping factor for backtracking\n        armijo_c1 = 1.0e-4   # Armijo condition constant\n\n        # 1. Preprocessing: Calculate ln(K(T))\n        try:\n            ln_K_ref = -dG_std_ref / (R_GAS_CONSTANT * T_ref)\n            ln_K_T = ln_K_ref - (dH_std / R_GAS_CONSTANT) * (1.0/T - 1.0/T_ref)\n        except ZeroDivisionError:\n            # Handle T_ref or T being zero, though physically impossible for K.\n            return np.nan\n\n        # 2. Define residual function f(x) and its derivative f'(x)\n        def f(x):\n            if not (0  x  1):\n                # This should not be hit if line search is correct\n                return np.inf\n            return np.log(x) - np.log(1 - x) + A * (1 - 2*x) - ln_K_T\n\n        def f_prime(x):\n            if not (0  x  1):\n                return np.inf\n            return 1.0/x + 1.0/(1 - x) - 2*A\n\n        # 3. Initialization\n        x_k = x_initial\n        if not (0  x_k  1):\n            # If initial guess is on boundary, move it slightly inside\n            x_k = np.clip(x_k, tol_x, 1.0 - tol_x)\n\n        # 4. Newton-Raphson Iteration\n        for _ in range(max_iter):\n            res = f(x_k)\n\n            # Check for residual convergence\n            if abs(res)  tol_res:\n                return x_k\n\n            deriv = f_prime(x_k)\n            if abs(deriv)  1e-12: # Avoid division by zero/small number\n                # Occurs at extrema, Newton step is unreliable\n                # A more advanced method would switch to gradient descent\n                # here we just stop\n                break\n                \n            p_k = -res / deriv  # Newton step\n\n            # --- Line Search ---\n            alpha = 1.0\n            \n            # Boundary enforcement\n            if p_k > 0:\n                alpha_max = (1.0 - x_k) / p_k\n                alpha = min(alpha, boundary_factor * alpha_max)\n            elif p_k  0:\n                alpha_max = -x_k / p_k\n                alpha = min(alpha, boundary_factor * alpha_max)\n            \n            # Backtracking (Armijo condition)\n            res_sq_k = res**2\n            while alpha > 1e-8: # Prevent infinite loop with tiny steps\n                x_new = x_k + alpha * p_k\n                # Ensure x_new is strictly within bounds before evaluation\n                if not (0  x_new  1): \n                    alpha *= backtrack_factor\n                    continue\n                \n                res_new = f(x_new)\n                # Check Armijo condition\n                if res_new**2  res_sq_k * (1 - armijo_c1 * alpha):\n                    break\n                alpha *= backtrack_factor\n            else:\n                # Line search failed to find a suitable step\n                break\n\n            step_size = alpha * p_k\n            x_k += step_size\n\n            # Check for step size convergence\n            if abs(step_size)  tol_x:\n                return x_k\n        \n        return x_k # Return best effort after max_iter\n\n    results = []\n    for case in test_cases:\n        x_eq = compute_equilibrium(*case)\n        results.append(x_eq)\n\n    # Format the results to exactly six decimal places for the final output\n    formatted_results = [f\"{r:.6f}\" for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2627907"}]}