{"hands_on_practices": [{"introduction": "Understanding the behavior of electrolyte solutions begins with a crucial parameter: the ionic strength. Before we can predict activity coefficients or analyze reaction kinetics, we must be able to accurately calculate this quantity from the composition of the solution. This first exercise [@problem_id:2942689] provides essential practice in applying the fundamental definition of ionic strength, $I = \\frac{1}{2} \\sum_{i} c_i z_i^2$, to a realistic mixture of salts. By working through the calculation, you will solidify your understanding of dissociation stoichiometry and gain a crucial intuition for why multivalent ions have a disproportionately large impact on the solution's electrostatic environment.", "problem": "An aqueous solution at thermal equilibrium contains three fully dissociating strong electrolytes: sodium chloride ($\\text{NaCl}$), calcium chloride ($\\text{CaCl}_{2}$), and sodium sulfate ($\\text{Na}_{2}\\text{SO}_{4}$). The analytical molar concentrations of the salts are $0.02000~\\text{mol}\\,\\text{L}^{-1}$ for $\\text{NaCl}$, $0.005000~\\text{mol}\\,\\text{L}^{-1}$ for $\\text{CaCl}_{2}$, and $0.01000~\\text{mol}\\,\\text{L}^{-1}$ for $\\text{Na}_{2}\\text{SO}_{4}$. Assume complete dissociation, ideal behavior, and no ion pairing or complex formation.\n\nStarting only from the accepted definition of ionic strength in electrolyte solutions and standard dissociation stoichiometry, derive an explicit expression for the ionic strength $I$ of this mixture in terms of the individual ion concentrations and charges, and evaluate it numerically for the given solution. Then, use your derivation to explain why the divalent ions contribute disproportionately compared to the monovalent ions, even when present at lower analytical concentrations. \n\nRound your final numerical value of $I$ to four significant figures and express it in $\\text{mol}\\,\\text{L}^{-1}$.", "solution": "The problem statement is first subjected to validation.\n\nGivens are extracted verbatim:\n- An aqueous solution at thermal equilibrium.\n- Three fully dissociating strong electrolytes: sodium chloride ($\\text{NaCl}$), calcium chloride ($\\text{CaCl}_{2}$), and sodium sulfate ($\\text{Na}_{2}\\text{SO}_{4}$).\n- Analytical molar concentration of $\\text{NaCl}$ is $0.02000~\\text{mol}\\,\\text{L}^{-1}$.\n- Analytical molar concentration of $\\text{CaCl}_{2}$ is $0.005000~\\text{mol}\\,\\text{L}^{-1}$.\n- Analytical molar concentration of $\\text{Na}_{2}\\text{SO}_{4}$ is $0.01000~\\text{mol}\\,\\text{L}^{-1}$.\n- Assumptions: complete dissociation, ideal behavior, no ion pairing or complex formation.\n- Tasks:\n    1.  Derive an explicit expression for ionic strength $I$.\n    2.  Evaluate $I$ numerically.\n    3.  Explain the disproportionate contribution of divalent ions.\n- Rounding: Final numerical value of $I$ to four significant figures.\n\nValidation assessment:\nThe problem is scientifically grounded, concerning the fundamental concept of ionic strength in electrolyte solutions, a standard topic in physical chemistry. It is well-posed, providing all necessary concentrations and explicit, standard assumptions (complete dissociation) required for a unique and unambiguous calculation. The language is objective and precise. The problem contains no scientific fallacies, contradictions, or ambiguities. It is a standard, solvable problem in an academic context.\n\nVerdict: The problem is valid. We will proceed to the solution.\n\nThe ionic strength, $I$, of a solution is a measure of the total concentration of ions. It is defined by the following expression, which accounts for the concentration, $c_i$, and the charge number, $z_i$, of each ionic species $i$ in the solution:\n$$I = \\frac{1}{2} \\sum_{i} c_i z_i^2$$\nThe problem states that the three salts, $\\text{NaCl}$, $\\text{CaCl}_{2}$, and $\\text{Na}_{2}\\text{SO}_{4}$, dissociate completely in the aqueous solution. We must first write the stoichiometric dissociation reactions to determine the concentration of each ion.\nThe dissociation reactions are:\n$$ \\text{NaCl}(s) \\rightarrow \\text{Na}^{+}(aq) + \\text{Cl}^{-}(aq) $$\n$$ \\text{CaCl}_{2}(s) \\rightarrow \\text{Ca}^{2+}(aq) + 2\\text{Cl}^{-}(aq) $$\n$$ \\text{Na}_{2}\\text{SO}_{4}(s) \\rightarrow 2\\text{Na}^{+}(aq) + \\text{SO}_{4}^{2-}(aq) $$\nGiven the analytical concentrations of the salts, and assuming complete dissociation, the molar concentrations of the individual ions are calculated. Note that both $\\text{Na}^{+}$ and $\\text{Cl}^{-}$ ions originate from more than one source.\nLet $c(\\text{salt})$ denote the analytical concentration of a given salt. The ion concentrations, denoted by brackets, are:\n$$ [\\text{Na}^{+}] = c_{\\text{Na}^{+}} = c(\\text{NaCl}) + 2 \\cdot c(\\text{Na}_{2}\\text{SO}_{4}) $$\n$$ [\\text{Ca}^{2+}] = c_{\\text{Ca}^{2+}} = c(\\text{CaCl}_{2}) $$\n$$ [\\text{Cl}^{-}] = c_{\\text{Cl}^{-}} = c(\\text{NaCl}) + 2 \\cdot c(\\text{CaCl}_{2}) $$\n$$ [\\text{SO}_{4}^{2-}] = c_{\\text{SO}_{4}^{2-}} = c(\\text{Na}_{2}\\text{SO}_{4}) $$\nThe charge numbers ($z_i$) for these ions are: $z_{\\text{Na}^{+}} = +1$, $z_{\\text{Ca}^{2+}} = +2$, $z_{\\text{Cl}^{-}} = -1$, and $z_{\\text{SO}_{4}^{2-}} = -2$.\n\nThe explicit expression for the ionic strength $I$ of this specific mixture is obtained by substituting the concentrations and charges of all four ionic species into the definition of $I$:\n$$ I = \\frac{1}{2} \\left( c_{\\text{Na}^{+}} z_{\\text{Na}^{+}}^2 + c_{\\text{Ca}^{2+}} z_{\\text{Ca}^{2+}}^2 + c_{\\text{Cl}^{-}} z_{\\text{Cl}^{-}}^2 + c_{\\text{SO}_{4}^{2-}} z_{\\text{SO}_{4}^{2-}}^2 \\right) $$\nSubstituting the expressions for the ion concentrations in terms of the initial salt concentrations yields:\n$$ I = \\frac{1}{2} \\left( (c(\\text{NaCl}) + 2c(\\text{Na}_{2}\\text{SO}_{4}))(+1)^2 + (c(\\text{CaCl}_{2}))(+2)^2 + (c(\\text{NaCl}) + 2c(\\text{CaCl}_{2}))(-1)^2 + (c(\\text{Na}_{2}\\text{SO}_{4}))(-2)^2 \\right) $$\nThis is the derived explicit expression for $I$.\n\nNow, we evaluate this expression numerically. First, we calculate the concentration of each ion:\n$$ c_{\\text{Na}^{+}} = 0.02000~\\text{mol}\\,\\text{L}^{-1} + 2 \\cdot (0.01000~\\text{mol}\\,\\text{L}^{-1}) = 0.04000~\\text{mol}\\,\\text{L}^{-1} $$\n$$ c_{\\text{Ca}^{2+}} = 0.005000~\\text{mol}\\,\\text{L}^{-1} $$\n$$ c_{\\text{Cl}^{-}} = 0.02000~\\text{mol}\\,\\text{L}^{-1} + 2 \\cdot (0.005000~\\text{mol}\\,\\text{L}^{-1}) = 0.03000~\\text{mol}\\,\\text{L}^{-1} $$\n$$ c_{\\text{SO}_{4}^{2-}} = 0.01000~\\text{mol}\\,\\text{L}^{-1} $$\nWe now substitute these concentrations and the corresponding charges into the ionic strength formula:\n$$ I = \\frac{1}{2} \\left[ (0.04000)(+1)^2 + (0.005000)(+2)^2 + (0.03000)(-1)^2 + (0.01000)(-2)^2 \\right] $$\nUnits of $\\text{mol}\\,\\text{L}^{-1}$ are omitted during the intermediate calculation for clarity.\n$$ I = \\frac{1}{2} \\left[ 0.04000 \\cdot 1 + 0.005000 \\cdot 4 + 0.03000 \\cdot 1 + 0.01000 \\cdot 4 \\right] $$\n$$ I = \\frac{1}{2} \\left[ 0.04000 + 0.02000 + 0.03000 + 0.04000 \\right] $$\n$$ I = \\frac{1}{2} \\left[ 0.13000 \\right] $$\n$$ I = 0.065000~\\text{mol}\\,\\text{L}^{-1} $$\nThe problem requires the final answer to be rounded to four significant figures. The calculated value $0.065000$ has five significant figures. Rounding to four significant figures gives $0.06500$.\n\nThe final part of the problem requires an explanation for the disproportionate contribution of divalent ions to ionic strength. This is a direct consequence of the mathematical form of the definition of $I$. The contribution of any given ion $i$ to the sum within the formula is $c_i z_i^2$. The charge number $z_i$ is squared.\nFor a monovalent ion ($z_i = \\pm 1$), its contribution to the sum is $c_i (\\pm 1)^2 = c_i$.\nFor a divalent ion ($z_i = \\pm 2$), its contribution to the sum is $c_i (\\pm 2)^2 = 4c_i$.\nThus, on a per-mole basis, a divalent ion contributes four times more to the ionic strength than a monovalent ion.\nIn our specific case:\n- Total concentration of monovalent ions ($\\text{Na}^{+}$, $\\text{Cl}^{-}$) is $0.04000 + 0.03000 = 0.07000~\\text{mol}\\,\\text{L}^{-1}$. Their contribution to the sum $\\sum c_i z_i^2$ is $0.04000 \\cdot 1^2 + 0.03000 \\cdot (-1)^2 = 0.07000$.\n- Total concentration of divalent ions ($\\text{Ca}^{2+}$, $\\text{SO}_{4}^{2-}$) is $0.005000 + 0.01000 = 0.01500~\\text{mol}\\,\\text{L}^{-1}$. Their contribution to the sum is $0.005000 \\cdot 2^2 + 0.01000 \\cdot (-2)^2 = 0.02000 + 0.04000 = 0.06000$.\nDespite the total concentration of divalent ions ($0.01500~\\text{mol}\\,\\text{L}^{-1}$) being less than a quarter of the total concentration of monovalent ions ($0.07000~\\text{mol}\\,\\text{L}^{-1}$), their contribution to the ionic strength sum ($0.06000$) is nearly as large as that from the monovalent ions ($0.07000$). This demonstrates unequivocally the disproportionately large influence of higher-charge ions, which stems from the quadratic dependence of ionic strength on ionic charge.", "answer": "$$\n\\boxed{0.06500}\n$$", "id": "2942689"}, {"introduction": "With the ability to calculate ionic strength, we can now explore its profound impact on chemical processes. A classic example is the primary kinetic salt effect, where the rate of a reaction between ions is sensitive to the overall ionic composition of the medium. This practice [@problem_id:2942653] guides you through the derivation of the Brønsted-Bjerrum equation from first principles, connecting the Debye–Hückel theory of ion atmospheres to transition state theory. You will then use this framework to predict how a reaction's rate constant changes with ionic strength, reinforcing the concept that the electrostatic environment directly modulates the activation energy of a reaction.", "problem": "A bimolecular reaction between two anions, $\\mathrm{A}^{-}$ and $\\mathrm{B}^{-}$, is studied in aqueous solution at $25\\,^\\circ \\mathrm{C}$. The ionic strength, $I$, is adjusted using an inert supporting electrolyte so that only the ionic strength changes while specific ion interactions remain negligible. Consider the following foundational elements:\n- The ionic strength is defined by $I = \\frac{1}{2}\\sum_{i} c_{i} z_{i}^{2}$, where $c_{i}$ and $z_{i}$ are the molar concentration and charge number of ion $i$.\n- Activities satisfy $a_{i} = \\gamma_{i} c_{i}$, where $\\gamma_{i}$ is the activity coefficient of species $i$.\n- In the Debye–Hückel limiting law at $25\\,^\\circ \\mathrm{C}$, $\\log_{10}\\gamma_{i} = -A z_{i}^{2}\\sqrt{I}$ with $A = 0.509$.\n- For an elementary step, assume the transition state behaves as an ionic species with charge equal to the algebraic sum of the reactant charges, so its activity coefficient obeys the same limiting law with $z^{\\ddagger} = z_{\\mathrm{A}} + z_{\\mathrm{B}}$.\n- The observed second-order rate constant based on concentrations, $k_{\\mathrm{obs}}$, arises from the rate law written in terms of activities for the reactants and the transition state.\n\nStarting from these principles only (and no further shortcut formulas), determine the sign of $\\frac{\\partial \\log_{10} k_{\\mathrm{obs}}}{\\partial \\sqrt{I}}$ for the reaction $\\mathrm{A}^{-} + \\mathrm{B}^{-} \\to \\text{products}$.\n\nThen, verify the prediction using the following measured rate constants at two ionic strengths:\n- At $I_{1} = 1.00 \\times 10^{-3}\\ \\mathrm{mol\\,L^{-1}}$, $k_{1} = 2.50 \\times 10^{3}\\ \\mathrm{L\\,mol^{-1}\\,s^{-1}}$.\n- At $I_{2} = 1.00 \\times 10^{-2}\\ \\mathrm{mol\\,L^{-1}}$, $k_{2} = 2.94 \\times 10^{3}\\ \\mathrm{L\\,mol^{-1}\\,s^{-1}}$.\n\nEstimate the finite-difference slope\n$$\n\\left.\\frac{\\Delta \\log_{10} k_{\\mathrm{obs}}}{\\Delta \\sqrt{I}}\\right|_{I_{1}\\to I_{2}} \\equiv \\frac{\\log_{10} k_{2} - \\log_{10} k_{1}}{\\sqrt{I_{2}} - \\sqrt{I_{1}}}\n$$\nand report its value. Express the slope in base-$10$ logarithm units per $(\\mathrm{mol\\,L^{-1}})^{1/2}$, and round your answer to four significant figures.", "solution": "The problem is well-posed, scientifically grounded, and contains all necessary information for a complete solution. It is a standard problem in chemical kinetics concerning the primary kinetic salt effect.\n\nFirst, we must derive the theoretical relationship between the observed rate constant, $k_{\\mathrm{obs}}$, and the ionic strength, $I$, starting from the given principles. The reaction is between two anions, $\\mathrm{A}^{-}$ and $\\mathrm{B}^{-}$, forming a transition state, denoted as $(\\mathrm{AB})^{\\ddagger}$.\n$$\n\\mathrm{A}^{-} + \\mathrm{B}^{-} \\rightleftharpoons (\\mathrm{AB})^{\\ddagger} \\to \\text{products}\n$$\nThe charge numbers of the reactants are $z_{\\mathrm{A}} = -1$ and $z_{\\mathrm{B}} = -1$.\nAccording to the problem statement, the charge of the transition state is the algebraic sum of the reactant charges:\n$$\nz^{\\ddagger} = z_{\\mathrm{A}} + z_{\\mathrm{B}} = (-1) + (-1) = -2\n$$\nThe rate of the reaction, according to transition state theory, is proportional to the concentration of the transition state, $c^{\\ddagger}$. The transition state is assumed to be in equilibrium with the reactants, governed by an equilibrium constant $K^{\\ddagger}$ expressed in terms of activities ($a_i$):\n$$\nK^{\\ddagger} = \\frac{a^{\\ddagger}}{a_{\\mathrm{A}} a_{\\mathrm{B}}}\n$$\nUsing the relationship between activity, concentration ($c_i$), and activity coefficient ($\\gamma_i$), $a_i = \\gamma_i c_i$, we can write:\n$$\nK^{\\ddagger} = \\frac{\\gamma^{\\ddagger} c^{\\ddagger}}{(\\gamma_{\\mathrm{A}} c_{\\mathrm{A}}) (\\gamma_{\\mathrm{B}} c_{\\mathrm{B}})}\n$$\nThe rate of reaction is given by $v = k_{\\mathrm{obs}} c_{\\mathrm{A}} c_{\\mathrm{B}}$. It is also fundamentally related to the concentration of the transition state by $v = k^{\\ddagger} c^{\\ddagger}$, where $k^{\\ddagger}$ is a universal frequency factor. By expressing $c^{\\ddagger}$ in terms of reactant concentrations, we find the relationship for $k_{\\mathrm{obs}}$:\n$$\nc^{\\ddagger} = K^{\\ddagger} \\frac{\\gamma_{\\mathrm{A}} \\gamma_{\\mathrm{B}}}{\\gamma^{\\ddagger}} c_{\\mathrm{A}} c_{\\mathrm{B}}\n$$\nThus, by comparison,\n$$\nk_{\\mathrm{obs}} = k_{0} \\frac{\\gamma_{\\mathrm{A}} \\gamma_{\\mathrm{B}}}{\\gamma^{\\ddagger}}\n$$\nwhere $k_{0}$ is the rate constant at infinite dilution ($I \\to 0$, where all $\\gamma_i \\to 1$), a combination of $k^{\\ddagger}$ and $K^{\\ddagger}$.\n\nTo analyze the effect of ionic strength, we take the base-$10$ logarithm of this equation:\n$$\n\\log_{10} k_{\\mathrm{obs}} = \\log_{10} k_{0} + \\log_{10} \\gamma_{\\mathrm{A}} + \\log_{10} \\gamma_{\\mathrm{B}} - \\log_{10} \\gamma^{\\ddagger}\n$$\nNow, we substitute the Debye–Hückel limiting law as given for $25\\,^\\circ \\mathrm{C}$: $\\log_{10}\\gamma_{i} = -A z_{i}^{2}\\sqrt{I}$, with $A = 0.509$.\n$$\n\\log_{10} k_{\\mathrm{obs}} = \\log_{10} k_{0} + (-A z_{\\mathrm{A}}^{2}\\sqrt{I}) + (-A z_{\\mathrm{B}}^{2}\\sqrt{I}) - (-A (z^{\\ddagger})^{2}\\sqrt{I})\n$$\nFactoring out $-A\\sqrt{I}$:\n$$\n\\log_{10} k_{\\mathrm{obs}} = \\log_{10} k_{0} - A\\sqrt{I} (z_{\\mathrm{A}}^{2} + z_{\\mathrm{B}}^{2} - (z^{\\ddagger})^{2})\n$$\nSubstitute $z^{\\ddagger} = z_{\\mathrm{A}} + z_{\\mathrm{B}}$:\n$$\n\\log_{10} k_{\\mathrm{obs}} = \\log_{10} k_{0} - A\\sqrt{I} (z_{\\mathrm{A}}^{2} + z_{\\mathrm{B}}^{2} - (z_{\\mathrm{A}} + z_{\\mathrm{B}})^{2})\n$$\nExpand the term $(z_{\\mathrm{A}} + z_{\\mathrm{B}})^{2} = z_{\\mathrm{A}}^{2} + 2z_{\\mathrm{A}}z_{\\mathrm{B}} + z_{\\mathrm{B}}^{2}$:\n$$\n\\log_{10} k_{\\mathrm{obs}} = \\log_{10} k_{0} - A\\sqrt{I} (z_{\\mathrm{A}}^{2} + z_{\\mathrm{B}}^{2} - z_{\\mathrm{A}}^{2} - 2z_{\\mathrm{A}}z_{\\mathrm{B}} - z_{\\mathrm{B}}^{2})\n$$\nSimplifying the expression in the parenthesis gives:\n$$\n\\log_{10} k_{\\mathrm{obs}} = \\log_{10} k_{0} - A\\sqrt{I} (-2z_{\\mathrm{A}}z_{\\mathrm{B}})\n$$\nThis yields the final form of the Brønsted-Bjerrum equation for this case:\n$$\n\\log_{10} k_{\\mathrm{obs}} = \\log_{10} k_{0} + 2A z_{\\mathrm{A}} z_{\\mathrm{B}} \\sqrt{I}\n$$\nThis equation shows a linear relationship between $\\log_{10} k_{\\mathrm{obs}}$ and $\\sqrt{I}$. The slope of this line is given by the derivative with respect to $\\sqrt{I}$:\n$$\n\\frac{\\partial \\log_{10} k_{\\mathrm{obs}}}{\\partial \\sqrt{I}} = 2A z_{\\mathrm{A}} z_{\\mathrm{B}}\n$$\nTo determine the sign of the slope, we substitute the known values. The constant $A = 0.509$ is positive. The charges are $z_{\\mathrm{A}} = -1$ and $z_{\\mathrm{B}} = -1$.\n$$\n\\text{sign}\\left(\\frac{\\partial \\log_{10} k_{\\mathrm{obs}}}{\\partial \\sqrt{I}}\\right) = \\text{sign}(2 \\times (0.509) \\times (-1) \\times (-1)) = \\text{sign}(1.018)\n$$\nThe sign is positive. This predicts that the rate constant for the reaction between two anions will increase as the ionic strength increases.\n\nNext, we verify this prediction with the given experimental data:\n- At $I_{1} = 1.00 \\times 10^{-3}\\ \\mathrm{mol\\,L^{-1}}$, $k_{1} = 2.50 \\times 10^{3}\\ \\mathrm{L\\,mol^{-1}\\,s^{-1}}$.\n- At $I_{2} = 1.00 \\times 10^{-2}\\ \\mathrm{mol\\,L^{-1}}$, $k_{2} = 2.94 \\times 10^{3}\\ \\mathrm{L\\,mol^{-1}\\,s^{-1}}$.\nSince $I_{2} > I_{1}$ and we observe that $k_{2} > k_{1}$ ($2.94 \\times 10^3 > 2.50 \\times 10^3$), the experimental data are consistent with our theoretical prediction.\n\nFinally, we calculate the finite-difference slope as requested.\n$$\n\\text{Slope} = \\frac{\\log_{10} k_{2} - \\log_{10} k_{1}}{\\sqrt{I_{2}} - \\sqrt{I_{1}}}\n$$\nFirst, calculate the square roots of the ionic strengths:\n$$\n\\sqrt{I_1} = \\sqrt{1.00 \\times 10^{-3}\\ \\mathrm{mol\\,L^{-1}}} \\approx 0.03162278\\ (\\mathrm{mol\\,L^{-1}})^{1/2}\n$$\n$$\n\\sqrt{I_2} = \\sqrt{1.00 \\times 10^{-2}\\ \\mathrm{mol\\,L^{-1}}} = 0.1\\ (\\mathrm{mol\\,L^{-1}})^{1/2}\n$$\nThe difference in the denominator is:\n$$\n\\Delta\\sqrt{I} = \\sqrt{I_{2}} - \\sqrt{I_{1}} \\approx 0.1 - 0.03162278 = 0.06837722\\ (\\mathrm{mol\\,L^{-1}})^{1/2}\n$$\nNext, calculate the difference in the numerator:\n$$\n\\Delta\\log_{10} k_{\\mathrm{obs}} = \\log_{10}(k_{2}) - \\log_{10}(k_{1}) = \\log_{10}\\left(\\frac{k_{2}}{k_{1}}\\right)\n$$\n$$\n\\Delta\\log_{10} k_{\\mathrm{obs}} = \\log_{10}\\left(\\frac{2.94 \\times 10^{3}}{2.50 \\times 10^{3}}\\right) = \\log_{10}(1.176) \\approx 0.0704154\n$$\nNow, compute the slope:\n$$\n\\text{Slope} = \\frac{0.0704154}{0.06837722} \\approx 1.0298099\n$$\nRounding the result to four significant figures gives $1.030$. The units are $(\\mathrm{mol\\,L^{-1}})^{-1/2}$, although the problem asks for the numerical value only. This value is in excellent agreement with the theoretical slope of $2Az_{\\mathrm{A}}z_{\\mathrm{B}} = 2(0.509)(-1)(-1) = 1.018$.", "answer": "$$\n\\boxed{1.030}\n$$", "id": "2942653"}, {"introduction": "Real-world chemical systems, such as biological fluids or environmental waters, involve numerous coupled equilibria that must be solved simultaneously. In this capstone practice [@problem_id:2942676], you are challenged to synthesize your knowledge of acid-base chemistry, mass and charge balance, and activity corrections into a single, robust computational model. By designing a self-consistent algorithm, you will tackle the interdependence of pH, species concentrations, and ionic strength, a problem that cannot be solved with simple algebraic shortcuts. This exercise provides a practical introduction to the iterative numerical methods that are essential for accurately modeling complex chemical equilibria.", "problem": "Implement a complete and self-consistent computational algorithm for a general polyprotic acid in aqueous solution that determines the hydrogen ion concentration and the ionic strength by simultaneously satisfying mass action, mass balance, charge neutrality, and ionic strength-dependent activity corrections. The algorithm must start from foundational laws and definitions and must not assume any pre-derived shortcut expressions beyond those definitions.\n\nYou must use the following fundamental definitions and well-tested relations at standard temperature $298\\,\\mathrm{K}$:\n- Activities: For each species $i$, the activity is $a_i = \\gamma_i c_i$, where $c_i$ is the molar concentration in $\\mathrm{mol\\,L^{-1}}$ and $\\gamma_i$ is the activity coefficient.\n- Ionic strength: $I = \\dfrac{1}{2}\\sum_{i} c_i z_i^2$, where $z_i$ is the integer charge of species $i$.\n- Water autoprotolysis: $K_\\mathrm{w} = a_{\\mathrm{H}^+} a_{\\mathrm{OH}^-}$. Use $K_\\mathrm{w} = 10^{-14}$ as the thermodynamic constant at the stated temperature. Hence $c_{\\mathrm{OH}^-} = \\dfrac{K_\\mathrm{w}}{\\gamma_{\\mathrm{H}^+}\\gamma_{\\mathrm{OH}^-} c_{\\mathrm{H}^+}}$.\n- Stepwise dissociation equilibria for a generic polyprotic acid $\\mathrm{H}_m\\mathrm{A}$ with $m$ acidic protons and stepwise thermodynamic dissociation constants $\\{K_1,\\dots,K_m\\}$:\n  For the $i$-th step, $\\mathrm{H}_{m-(i-1)}\\mathrm{A}^{-(i-1)} \\rightleftharpoons \\mathrm{H}^+ + \\mathrm{H}_{m-i}\\mathrm{A}^{-i}$ with $K_i = \\dfrac{a_{\\mathrm{H}^+}\\,a_{\\mathrm{H}_{m-i}\\mathrm{A}^{-i}}}{a_{\\mathrm{H}_{m-(i-1)}\\mathrm{A}^{-(i-1)}}}$.\n- Activity coefficients of ions are given by the Davies equation (a well-tested extension of the Debye–Hückel theory at moderate ionic strength):\n  $\\log_{10}\\gamma_i = -A z_i^2\\left(\\dfrac{\\sqrt{I}}{1+\\sqrt{I}} - 0.3\\,I\\right)$ with $A = 0.509$ at $298\\,\\mathrm{K}$. For neutral species $z_i = 0$ and $\\gamma_i = 1$.\n\nYou must enforce:\n- Total acid mass balance: $\\sum_{i=0}^{m} c_i = C_\\mathrm{T}$, where $c_0 = [\\mathrm{H}_m\\mathrm{A}]$, $c_1 = [\\mathrm{H}_{m-1}\\mathrm{A}^-]$, $\\dots$, $c_m = [\\mathrm{A}^{m-}]$.\n- Charge neutrality: $c_{\\mathrm{H}^+} - c_{\\mathrm{OH}^-} - \\sum_{i=1}^{m} i\\,c_i + \\sum_{\\text{background ions}} z_j c_j = 0$. Assume background salts are strong electrolytes added as charge-balanced ion pairs with fixed concentrations, so that their net charge is zero and only their ionic strength contribution matters. Under this assumption, the charge neutrality reduces to $c_{\\mathrm{H}^+} - c_{\\mathrm{OH}^-} - \\sum_{i=1}^{m} i\\,c_i = 0$.\n\nDesign requirements for the algorithm:\n- Unknowns include $c_{\\mathrm{H}^+}$ and all acid protonation-state concentrations $\\{c_i\\}$, with activity coefficients $\\{\\gamma_i\\}$ and $\\gamma_{\\mathrm{H}^+}$, $\\gamma_{\\mathrm{OH}^-}$ determined self-consistently via $I$ through the Davies relation.\n- Use a fixed-point outer iteration on $I$ to update activity coefficients, coupled with an inner root-finding procedure to satisfy the charge neutrality in terms of $c_{\\mathrm{H}^+}$ while enforcing mass balance through the stepwise equilibria and activities. The solution must be robust to cover dilute and moderately concentrated regimes. You may assume all dissociation constants are thermodynamic (activity-based) constants.\n- Treat background electrolytes as fully dissociated strong electrolytes with fixed ion concentrations that contribute to $I$ but do not appear in the charge neutrality because their net contribution is zero by construction.\n\nNumerical output requirements:\n- For each test case, compute the negative common logarithm of the hydrogen ion concentration, $\\mathrm{pH} = -\\log_{10} c_{\\mathrm{H}^+}$, and the total ionic strength $I$ in $\\mathrm{mol\\,L^{-1}}$.\n- Express $\\mathrm{pH}$ as a unitless quantity rounded to three decimal places.\n- Express $I$ in $\\mathrm{mol\\,L^{-1}}$ rounded to six significant figures; scientific notation is acceptable if needed.\n\nTest suite to be implemented exactly as specified:\n- Case $1$ (triprotic acid under substantial background salt):\n  - $m = 3$\n  - $\\mathrm{p}K_a$ values: $[2.15,\\,7.20,\\,12.35]$\n  - Total acid concentration $C_\\mathrm{T} = 1.0\\times 10^{-2}\\,\\mathrm{mol\\,L^{-1}}$\n  - Background strong electrolyte: $\\mathrm{NaCl}$ at $1.0\\times 10^{-1}\\,\\mathrm{mol\\,L^{-1}}$, treated as $c_{\\mathrm{Na}^+} = 1.0\\times 10^{-1}\\,\\mathrm{mol\\,L^{-1}}$ and $c_{\\mathrm{Cl}^-} = 1.0\\times 10^{-1}\\,\\mathrm{mol\\,L^{-1}}$\n- Case $2$ (diprotic acid without background salt):\n  - $m = 2$\n  - $\\mathrm{p}K_a$ values: $[6.35,\\,10.33]$\n  - $C_\\mathrm{T} = 1.0\\times 10^{-3}\\,\\mathrm{mol\\,L^{-1}}$\n  - No background electrolyte\n- Case $3$ (monoprotic weak acid with low background salt):\n  - $m = 1$\n  - $\\mathrm{p}K_a$ values: $[4.76]$\n  - $C_\\mathrm{T} = 1.0\\times 10^{-1}\\,\\mathrm{mol\\,L^{-1}}$\n  - Background strong electrolyte: $\\mathrm{NaCl}$ at $1.0\\times 10^{-3}\\,\\mathrm{mol\\,L^{-1}}$ with $c_{\\mathrm{Na}^+} = 1.0\\times 10^{-3}\\,\\mathrm{mol\\,L^{-1}}$ and $c_{\\mathrm{Cl}^-} = 1.0\\times 10^{-3}\\,\\mathrm{mol\\,L^{-1}}$\n- Case $4$ (tetraprotic acid at very low concentration, no background salt):\n  - $m = 4$\n  - $\\mathrm{p}K_a$ values: $[1.00,\\,3.50,\\,6.00,\\,8.50]$\n  - $C_\\mathrm{T} = 1.0\\times 10^{-6}\\,\\mathrm{mol\\,L^{-1}}$\n  - No background electrolyte\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list of pairs, one pair per test case, each pair being the $\\mathrm{pH}$ and $I$ in that order, for example, $[[\\mathrm{pH}_1, I_1],[\\mathrm{pH}_2, I_2],\\dots]$.", "solution": "The problem requires the development of a self-consistent computational algorithm to determine the equilibrium state of a general polyprotic acid in an aqueous solution. The state is defined by the hydrogen ion concentration, from which the $\\mathrm{pH}$ is calculated, and the total ionic strength of the solution. The algorithm must be grounded in fundamental physicochemical principles, accounting for mass action, mass and charge balance, and activity corrections for non-ideal behavior.\n\nThe equilibrium state of the system is described by a set of coupled, non-linear algebraic equations. Let the polyprotic acid be denoted by $\\mathrm{H}_m\\mathrm{A}$, with a total analytical concentration $C_\\mathrm{T}$ and $m$ stepwise thermodynamic dissociation constants $\\{K_1, K_2, \\dots, K_m\\}$. The species present in solution derived from the acid are $\\mathrm{H}_m\\mathrm{A}$, $\\mathrm{H}_{m-1}\\mathrm{A}^{-}$, $\\dots$, $\\mathrm{A}^{m-}$, with molar concentrations $\\{c_0, c_1, \\dots, c_m\\}$ respectively. Additionally, the solvent autoionizes to produce $\\mathrm{H}^+$ and $\\mathrm{OH}^-$.\n\nThe governing equations at a standard temperature of $298\\,\\mathrm{K}$ are:\n\n$1$. Mass Action Laws (Chemical Equilibria):\nThe activity $a_i$ of a species $i$ is related to its molar concentration $c_i$ by $a_i = \\gamma_i c_i$, where $\\gamma_i$ is the activity coefficient.\nFor the $k$-th dissociation step of the acid, $\\mathrm{H}_{m-(k-1)}\\mathrm{A}^{-(k-1)} \\rightleftharpoons \\mathrm{H}^+ + \\mathrm{H}_{m-k}\\mathrm{A}^{-k}$:\n$$K_k = \\frac{a_{\\mathrm{H}^+} a_{\\mathrm{H}_{m-k}\\mathrm{A}^{-k}}}{a_{\\mathrm{H}_{m-(k-1)}\\mathrm{A}^{-(k-1)}}} = \\frac{(\\gamma_{\\mathrm{H}^+} c_{\\mathrm{H}^+}) (\\gamma_k c_k)}{(\\gamma_{k-1} c_{k-1})}$$\nwhere we denote the activity coefficient of species $\\mathrm{H}_{m-k}\\mathrm{A}^{-k}$ as $\\gamma_k$. The charge of this species is $-k$. The neutral acid $\\mathrm{H}_m\\mathrm{A}$ has charge $z_0=0$, and its activity coefficient $\\gamma_0$ is defined as $1$.\n\nFor the autoprotolysis of water, $\\mathrm{H}_2\\mathrm{O} \\rightleftharpoons \\mathrm{H}^+ + \\mathrm{OH}^-$:\n$$K_\\mathrm{w} = a_{\\mathrm{H}^+} a_{\\mathrm{OH}^-} = (\\gamma_{\\mathrm{H}^+} c_{\\mathrm{H}^+}) (\\gamma_{\\mathrm{OH}^-} c_{\\mathrm{OH}^-}) = 10^{-14}$$\n\n$2$. Mass Balance for the Acid:\nThe sum of the concentrations of all species derived from the acid must equal the total analytical concentration $C_\\mathrm{T}$:\n$$\\sum_{k=0}^{m} c_k = C_\\mathrm{T}$$\n\n$3$. Charge Balance (Electroneutrality):\nThe solution must be electrically neutral. The sum of positive charges (in molar concentration units) must equal the sum of negative charges. For a solution of the acid in water with an inert background salt (e.g., $\\mathrm{NaCl}$), where the salt itself contributes no net charge, the condition simplifies to:\n$$c_{\\mathrm{H}^+} = c_{\\mathrm{OH}^-} + \\sum_{k=1}^{m} k \\cdot c_k$$\nThis can be rewritten as a function that must equal zero at equilibrium:\n$$f(c_{\\mathrm{H}^+}) = c_{\\mathrm{H}^+} - c_{\\mathrm{OH}^-} - \\sum_{k=1}^{m} k \\cdot c_k = 0$$\n\n$4$. Ionic Strength and Activity Coefficients:\nThe ionic strength, $I$, is a measure of the total ion concentration and is defined as:\n$$I = \\frac{1}{2} \\sum_i c_i z_i^2 = I_{\\mathrm{bg}} + \\frac{1}{2}\\left(c_{\\mathrm{H}^+} z_{\\mathrm{H}^+}^2 + c_{\\mathrm{OH}^-} z_{\\mathrm{OH}^-}^2 + \\sum_{k=1}^{m} c_k z_k^2\\right)$$\nwhere $I_{\\mathrm{bg}}$ is the contribution from any background electrolyte, $z_{\\mathrm{H}^+}=1$, $z_{\\mathrm{OH}^-}=-1$, and $z_k=-k$ for the species $\\mathrm{H}_{m-k}\\mathrm{A}^{-k}$. So,\n$$I = I_{\\mathrm{bg}} + \\frac{1}{2}\\left(c_{\\mathrm{H}^+} + c_{\\mathrm{OH}^-} + \\sum_{k=1}^{m} k^2 c_k\\right)$$\nThe activity coefficients, $\\gamma_i$, for ionic species are dependent on the ionic strength. This relationship is modeled by the Davies equation:\n$$\\log_{10}\\gamma_i = -A z_i^2 \\left( \\frac{\\sqrt{I}}{1+\\sqrt{I}} - 0.3 I \\right)$$\nwhere $A = 0.509$ at $298\\,\\mathrm{K}$. For neutral species ($z_i=0$), $\\gamma_i=1$.\n\nSolution Strategy:\nThe system is interdependent: concentrations determine ionic strength, which in turn determines activity coefficients, which then affect the equilibrium concentrations. This circular dependency suggests an iterative, self-consistent field approach. The problem specifies a two-level iterative scheme.\n\nFirst, we express all unknown concentrations as functions of a single variable, $c_{\\mathrm{H}^+}$, assuming the ionic strength $I$ (and thus all $\\gamma_i$ values) is momentarily fixed.\nFrom the mass action laws, we can derive the relative concentration of each acid species, $c_k$, in terms of $c_0$:\n$$c_k = c_0 \\frac{\\gamma_0}{\\gamma_k a_{\\mathrm{H}^+}^k} \\prod_{j=1}^{k} K_j = \\frac{c_0}{\\gamma_k (\\gamma_{\\mathrm{H}^+} c_{\\mathrm{H}^+})^k} \\prod_{j=1}^{k} K_j$$\nSubstituting these into the mass balance equation allows us to solve for $c_0$:\n$$C_\\mathrm{T} = c_0 \\left( 1 + \\sum_{k=1}^{m} \\frac{\\prod_{j=1}^{k} K_j}{\\gamma_k (\\gamma_{\\mathrm{H}^+} c_{\\mathrm{H}^+})^k} \\right)$$\nLet the denominator term be $\\mathcal{D}$:\n$$\\mathcal{D} = 1 + \\sum_{k=1}^{m} \\frac{\\prod_{j=1}^{k} K_j}{\\gamma_k (\\gamma_{\\mathrm{H}^+} c_{\\mathrm{H}^+})^k}$$\nThen, $c_0 = C_\\mathrm{T} / \\mathcal{D}$, and any $c_k$ can be found:\n$$c_k = \\frac{C_\\mathrm{T}}{\\mathcal{D}} \\frac{\\prod_{j=1}^{k} K_j}{\\gamma_k (\\gamma_{\\mathrm{H}^+} c_{\\mathrm{H}^+})^k}$$\nThe concentration of hydroxide is also a function of $c_{\\mathrm{H}^+}$:\n$$c_{\\mathrm{OH}^-} = \\frac{K_\\mathrm{w}}}{\\gamma_{\\mathrm{H}^+} \\gamma_{\\mathrm{OH}^-} c_{\\mathrm{H}^+}}$$\nWith these expressions, the charge balance equation becomes a function of only one unknown, $c_{\\mathrm{H}^+}$, for a fixed $I$: $f(c_{\\mathrm{H}^+}) = 0$. This function is monotonic and can be solved efficiently using a numerical root-finding algorithm like Brent's method.\n\nThe complete computational algorithm is as follows:\n$1$. **Initialization:** Set an initial guess for the ionic strength, $I_{\\mathrm{new}}$. A suitable guess is the contribution from the background electrolyte, $I_{\\mathrm{bg}}$, or a small value like $10^{-7}\\,\\mathrm{M}$ if $I_{\\mathrm{bg}}=0$.\n$2$. **Outer Iteration Loop (on $I$):**\n    a. Set $I_{\\mathrm{old}} = I_{\\mathrm{new}}$.\n    b. Based on $I_{\\mathrm{old}}$, calculate all required activity coefficients, $\\gamma_i$, using the Davies equation.\n    c. **Inner Procedure (Root-finding for $c_{\\mathrm{H}^+}$):**\n       Solve the charge balance equation $f(c_{\\mathrm{H}^+}) = 0$ for $c_{\\mathrm{H}^+}$. The function $f$ uses the fixed $\\gamma_i$ values from step $2$b. The solution yields the equilibrium hydrogen ion concentration, $c_{\\mathrm{H}^+,sol}$.\n    d. Using $c_{\\mathrm{H}^+,sol}$, calculate the equilibrium concentrations of all other species: $c_{\\mathrm{OH}^-}$ and all $c_k$.\n    e. Recalculate the total ionic strength, $I_{\\mathrm{new}}$, using the newly found concentrations.\n    f. Check for convergence: if $|I_{\\mathrm{new}} - I_{\\mathrm{old}}|$ is below a specified tolerance, the loop terminates. Otherwise, repeat from step $2$a.\n$3$. **Finalization:** Once converged, the final $c_{\\mathrm{H}^+,sol}$ and $I_{\\mathrm{new}}$ are the self-consistent results. Calculate $\\mathrm{pH} = -\\log_{10}(c_{\\mathrm{H}^+,sol})$ and format the outputs as required.\n\nThis iterative procedure ensures that the final set of concentrations simultaneously satisfies all the fundamental conditions of the equilibrium system.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import brentq\n\ndef solve():\n    \"\"\"\n    Main function to set up and run the test cases for the polyprotic acid equilibrium problem.\n    \"\"\"\n\n    class PolyproticAcidSolver:\n        \"\"\"\n        A solver for the equilibrium of a polyprotic acid in aqueous solution,\n        including activity corrections via the Davies equation.\n        \"\"\"\n        def __init__(self, m, pKas, C_T, background_electrolytes):\n            self.m = int(m)\n            self.pKas = np.array(pKas, dtype=float)\n            self.Kas = 10**(-self.pKas)\n            self.C_T = float(C_T)\n            \n            # Calculate ionic strength from background strong electrolytes\n            self.I_bg = 0.5 * sum(conc * charge**2 for conc, charge in background_electrolytes)\n            \n            self.charges = np.array([-i for i in range(self.m + 1)], dtype=int)\n            \n            # Pre-calculate cumulative products of Ka values\n            self.K_prods = np.cumprod(self.Kas)\n\n            # Constants\n            self.A = 0.509\n            self.K_w = 1.0e-14\n\n        def _davies_gamma(self, z, I):\n            \"\"\"Calculates activity coefficient using the Davies equation.\"\"\"\n            if z == 0 or I < 1e-15:\n                return 1.0\n            sqrt_I = np.sqrt(I)\n            log10_gamma = -self.A * z**2 * (sqrt_I / (1 + sqrt_I) - 0.3 * I)\n            return 10**log10_gamma\n\n        def calculate_equilibrium(self):\n            \"\"\"\n            Performs the self-consistent iterative calculation.\n            Outer loop iterates on ionic strength (I).\n            Inner procedure uses a root-finder for hydrogen ion concentration (c_H).\n            \"\"\"\n            I_new = self.I_bg\n            if I_new < 1e-14:  # Initial guess for I if no background salt\n                I_new = 1e-7\n\n            I_old = -1.0\n            c_H = np.nan # Initialize to indicate not yet solved\n            max_iter = 100\n            \n            for _ in range(max_iter):\n                if abs(I_new - I_old) < 1e-10 * (I_new + 1e-10):\n                    break\n                \n                I_old = I_new\n                \n                # Calculate activity coefficients for the current ionic strength I_old\n                max_charge = self.m\n                gammas_z = {z: self._davies_gamma(z, I_old) for z in range(1, max_charge + 2)}\n                gamma_H = gammas_z.get(1, 1.0)\n                gamma_OH = gammas_z.get(1, 1.0)\n\n                # Define the charge balance function to be solved for c_H\n                def charge_balance_func(c_H_test):\n                    if c_H_test <= 0: return -1.0 # Guard against non-physical inputs\n                    \n                    a_H = gamma_H * c_H_test\n                    \n                    # Denominator for speciation fractions (alpha_k = c_k / C_T)\n                    # Denom = 1 + sum( (prod(K_j) / (a_H^k * gamma_k)) for k=1..m )\n                    denom_terms = [1.0]\n                    a_H_pow_k = 1.0\n                    for k in range(1, self.m + 1):\n                        a_H_pow_k *= a_H\n                        gamma_k = gammas_z.get(k, 1.0)\n                        denom_terms.append(self.K_prods[k-1] / (a_H_pow_k * gamma_k))\n                    \n                    \n                    alpha0 = 1.0 / sum(denom_terms)\n\n                    # Sum term in charge balance: sum_{k=1 to m} k*c_k\n                    sum_term = 0.0\n                    for k in range(1, self.m + 1):\n                        # alpha_k = alpha_0 * term_k\n                        alpha_k = alpha0 * denom_terms[k]\n                        c_k = self.C_T * alpha_k\n                        sum_term += k * c_k\n                        \n                    c_OH = self.K_w / (gamma_H * gamma_OH * c_H_test)\n\n                    return c_H_test - c_OH - sum_term\n\n                # Find the root of the charge balance function using Brent's method\n                # The search interval [1e-15, 10.0] covers the pH range from 15 to -1.\n                try:\n                    c_H = brentq(charge_balance_func, 1e-15, 10.0, xtol=1e-15, rtol=1e-15)\n                except ValueError:\n                    # Brent's method may fail if the function does not cross zero within the interval.\n                    # This could happen in extreme cases, though unlikely for typical chemistry problems.\n                    return np.nan, np.nan # Indicate failure\n\n                # Recalculate concentrations and update ionic strength with the new c_H\n                a_H = gamma_H * c_H\n                c_OH = self.K_w / (gamma_H * gamma_OH * c_H)\n                \n                denom_terms = [1.0]\n                a_H_pow_k = 1.0\n                for k in range(1, self.m + 1):\n                    a_H_pow_k *= a_H\n                    gamma_k = gammas_z.get(k, 1.0)\n                    denom_terms.append(self.K_prods[k-1] / (a_H_pow_k * gamma_k))\n                \n                alpha0 = 1.0 / sum(denom_terms)\n\n                ionic_strength_acid_part = 0.0\n                for k in range(1, self.m + 1):\n                    alpha_k = alpha0 * denom_terms[k]\n                    c_k = self.C_T * alpha_k\n                    ionic_strength_acid_part += c_k * (self.charges[k]**2)\n\n                I_new = self.I_bg + 0.5 * (c_H + c_OH + ionic_strength_acid_part)\n            else:\n                 # Loop finished without convergence\n                 return np.nan, np.nan\n            \n            pH = -np.log10(c_H)\n            \n            return pH, I_new\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1: Triprotic acid with background salt\n        {'m': 3, 'pKas': [2.15, 7.20, 12.35], 'C_T': 1.0e-2, \n         'background': [(1.0e-1, 1), (1.0e-1, -1)]}, # 0.1M NaCl\n        # Case 2: Diprotic acid without background salt\n        {'m': 2, 'pKas': [6.35, 10.33], 'C_T': 1.0e-3, \n         'background': []}, # No background\n        # Case 3: Monoprotic acid with low background salt\n        {'m': 1, 'pKas': [4.76], 'C_T': 1.0e-1, \n         'background': [(1.0e-3, 1), (1.0e-3, -1)]}, # 0.001M NaCl\n        # Case 4: Tetraprotic acid at very low concentration\n        {'m': 4, 'pKas': [1.00, 3.50, 6.00, 8.50], 'C_T': 1.0e-6, \n         'background': []}, # No background\n    ]\n\n    results = []\n    for case in test_cases:\n        solver = PolyproticAcidSolver(case['m'], case['pKas'], case['C_T'], case['background'])\n        pH, I = solver.calculate_equilibrium()\n        \n        # Format the results as per requirements\n        pH_rounded = round(pH, 3)\n        # Round I to 6 significant figures. The 'g' format specifier does this.\n        # Then convert back to float to avoid quotes in the final list literal.\n        I_rounded = float(f\"{I:.6g}\")\n        \n        results.append([pH_rounded, I_rounded])\n\n    # Final print statement in the exact required format.\n    # Convert list of lists to its string representation and remove spaces.\n    print(str(results).replace(' ', ''))\n\nsolve()\n```", "id": "2942676"}]}