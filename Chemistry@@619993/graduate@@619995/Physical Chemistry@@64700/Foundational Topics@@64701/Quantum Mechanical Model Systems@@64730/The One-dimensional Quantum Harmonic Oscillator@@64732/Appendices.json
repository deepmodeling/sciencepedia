{"hands_on_practices": [{"introduction": "The elegance of the quantum harmonic oscillator is most apparent in the operator formalism, which sidesteps the complexities of wavefunctions and integrals in favor of pure algebra. This exercise provides hands-on practice with this powerful method. By calculating the matrix elements of powers of the position operator, $\\langle n|x^k|m\\rangle$, using ladder operators and their commutation relations, you will uncover the fundamental selection rules that govern spectroscopic transitions and build a representation of operators that is essential for more advanced computational methods [@problem_id:2678950].", "problem": "A single particle of mass $M$ in one spatial dimension is bound by a quadratic potential, so that its Hamiltonian is $H = \\frac{p^{2}}{2 M} + \\frac{1}{2} M \\omega^{2} x^{2}$. Introduce the ladder operators $a$ and $a^{\\dagger}$ defined by $a = \\sqrt{\\frac{M \\omega}{2 \\hbar}}\\,x + \\frac{i}{\\sqrt{2 M \\hbar \\omega}}\\,p$ and $a^{\\dagger} = \\sqrt{\\frac{M \\omega}{2 \\hbar}}\\,x - \\frac{i}{\\sqrt{2 M \\hbar \\omega}}\\,p$, which satisfy the canonical commutation relation $[a,a^{\\dagger}] = 1$. Let $\\{|n\\rangle\\}_{n=0}^{\\infty}$ denote the number eigenstates, with $a|n\\rangle = \\sqrt{n}\\,|n-1\\rangle$ and $a^{\\dagger}|n\\rangle = \\sqrt{n+1}\\,|n+1\\rangle$. The position operator can be written as $x = \\sqrt{\\frac{\\hbar}{2 M \\omega}}\\,(a + a^{\\dagger})$.\n\nStarting only from these definitions and the commutation relation $[a,a^{\\dagger}] = 1$, use normal ordering of powers of $a + a^{\\dagger}$ to compute the off-diagonal and diagonal matrix elements $\\langle n|x^{k}|m\\rangle$ explicitly for $k \\in \\{1,2,3,4\\}$ in terms of $n$, $m$, $\\hbar$, $M$, and $\\omega$. In your derivation, make clear how commutators generate the additional lower-order terms required by normal ordering for each $k$, and then evaluate the resulting matrix elements by the action of $a$ and $a^{\\dagger}$ on $|m\\rangle$. Discuss the sparsity patterns that follow from the parity of the harmonic-oscillator eigenfunctions and the parity of $x^{k}$.\n\nReport your final result as a single row whose $4$ entries are the closed-form analytic expressions for $\\langle n|x^{k}|m\\rangle$ with $k=1,2,3,4$ in that order. No numerical approximation is required, and no units should be included in the final reported expressions. Express your answer in terms of $\\hbar$, $M$, $\\omega$, $n$, and $m$ only, and use Kronecker deltas to encode selection rules.", "solution": "The problem requires the calculation of the matrix elements $\\langle n|x^{k}|m\\rangle$ for a one-dimensional quantum harmonic oscillator for $k \\in \\{1,2,3,4\\}$. The calculation must start from the provided definitions of the ladder operators $a$ and $a^{\\dagger}$, the position operator $x$ in terms of these operators, their commutation relation, and their action on the number eigenstates $|n\\rangle$. The method specified is to use normal ordering of powers of the operator $(a+a^{\\dagger})$.\n\nLet us begin by defining a constant for notational convenience. The position operator is given as $x = \\sqrt{\\frac{\\hbar}{2M\\omega}}(a+a^{\\dagger})$. Let us define the characteristic length scale of the oscillator as $x_0 = \\sqrt{\\frac{\\hbar}{M\\omega}}$. Then $x = \\frac{x_0}{\\sqrt{2}}(a+a^{\\dagger})$. The matrix elements are then $\\langle n|x^k|m\\rangle = \\left(\\frac{\\hbar}{2M\\omega}\\right)^{k/2} \\langle n|(a+a^{\\dagger})^k|m\\rangle$.\n\nWe proceed by calculating the normal-ordered form of $(a+a^{\\dagger})^k$ for each $k$ and then evaluating the corresponding matrix element. The normal ordering procedure involves rearranging operator products so that all creation operators $a^{\\dagger}$ are to the left of all annihilation operators $a$. This is achieved by repeatedly using the canonical commutation relation $[a, a^{\\dagger}] = aa^{\\dagger} - a^{\\dagger}a = 1$, or $aa^{\\dagger} = a^{\\dagger}a + 1$. This commutation relation is the source of lower-order terms that appear during the normal-ordering process. The matrix elements will be evaluated using the actions $a|m\\rangle = \\sqrt{m}|m-1\\rangle$ and $a^{\\dagger}|m\\rangle = \\sqrt{m+1}|m+1\\rangle$, and the orthonormality of the eigenstates, $\\langle n|m\\rangle = \\delta_{n,m}$.\n\n**Case k = 1**\n\nFor $k=1$, the operator is $x = \\sqrt{\\frac{\\hbar}{2M\\omega}}(a+a^{\\dagger})$. The term $(a+a^{\\dagger})$ is already in a form suitable for evaluation.\n$$ \\langle n|x|m\\rangle = \\sqrt{\\frac{\\hbar}{2M\\omega}} \\langle n| (a+a^{\\dagger}) |m\\rangle $$\nWe evaluate the matrix elements of $a$ and $a^{\\dagger}$ separately:\n$$ \\langle n|a|m\\rangle = \\langle n| \\sqrt{m}|m-1\\rangle = \\sqrt{m}\\langle n|m-1\\rangle = \\sqrt{m}\\delta_{n,m-1} $$\n$$ \\langle n|a^{\\dagger}|m\\rangle = \\langle n| \\sqrt{m+1}|m+1\\rangle = \\sqrt{m+1}\\langle n|m+1\\rangle = \\sqrt{m+1}\\delta_{n,m+1} $$\nCombining these results gives the final expression for $k=1$:\n$$ \\langle n|x|m\\rangle = \\sqrt{\\frac{\\hbar}{2M\\omega}} \\left( \\sqrt{m}\\delta_{n,m-1} + \\sqrt{m+1}\\delta_{n,m+1} \\right) $$\n\n**Case k = 2**\n\nFor $k=2$, we consider $x^2 = \\frac{\\hbar}{2M\\omega}(a+a^{\\dagger})^2$. We first normal-order the operator $(a+a^{\\dagger})^2$:\n$$ (a+a^{\\dagger})^2 = a^2 + aa^{\\dagger} + a^{\\dagger}a + (a^{\\dagger})^2 $$\nThe term $aa^{\\dagger}$ is not normal-ordered. Using the commutator, $aa^{\\dagger} = a^{\\dagger}a + 1$. The commutator thus introduces a constant term (an operator of order zero).\n$$ (a+a^{\\dagger})^2 = a^2 + (a^{\\dagger}a + 1) + a^{\\dagger}a + (a^{\\dagger})^2 = a^2 + (a^{\\dagger})^2 + 2a^{\\dagger}a + 1 $$\nNow we evaluate the matrix element of this normal-ordered expression:\n$$ \\langle n|x^2|m\\rangle = \\frac{\\hbar}{2M\\omega} \\langle n| (a^2 + (a^{\\dagger})^2 + 2a^{\\dagger}a + 1) |m\\rangle $$\nThe individual terms are:\n$$ \\langle n|a^2|m\\rangle = \\sqrt{m(m-1)}\\langle n|m-2\\rangle = \\sqrt{m(m-1)}\\delta_{n,m-2} $$\n$$ \\langle n|(a^{\\dagger})^2|m\\rangle = \\sqrt{(m+1)(m+2)}\\langle n|m+2\\rangle = \\sqrt{(m+1)(m+2)}\\delta_{n,m+2} $$\n$$ \\langle n|2a^{\\dagger}a|m\\rangle = 2m\\langle n|m\\rangle = 2m\\delta_{n,m} $$\n$$ \\langle n|1|m\\rangle = \\langle n|m\\rangle = \\delta_{n,m} $$\nSumming these contributions, we obtain:\n$$ \\langle n|x^2|m\\rangle = \\frac{\\hbar}{2M\\omega} \\left( \\sqrt{m(m-1)}\\delta_{n,m-2} + (2m+1)\\delta_{n,m} + \\sqrt{(m+1)(m+2)}\\delta_{n,m+2} \\right) $$\n\n**Case k = 3**\n\nFor $k=3$, we compute $x^3 = \\left(\\frac{\\hbar}{2M\\omega}\\right)^{3/2}(a+a^{\\dagger})^3$. We use the result for $(a+a^{\\dagger})^2$:\n$$ (a+a^{\\dagger})^3 = (a+a^{\\dagger})(a^2 + (a^{\\dagger})^2 + 2a^{\\dagger}a + 1) $$\n$$ = a^3 + a(a^{\\dagger})^2 + 2aa^{\\dagger}a + a + a^{\\dagger}a^2 + (a^{\\dagger})^3 + 2(a^{\\dagger})^2a + a^{\\dagger} $$\nWe normal-order the mixed terms using $aa^{\\dagger}=a^{\\dagger}a+1$:\n$$ a(a^{\\dagger})^2 = (a^{\\dagger}a+1)a^{\\dagger} = a^{\\dagger}aa^{\\dagger}+a^{\\dagger} = a^{\\dagger}(a^{\\dagger}a+1)+a^{\\dagger} = (a^{\\dagger})^2a + 2a^{\\dagger} $$\n$$ 2aa^{\\dagger}a = 2(a^{\\dagger}a+1)a = 2a^{\\dagger}a^2 + 2a $$\nThe commutators have generated terms of order one ($a, a^\\dagger$) from terms of order three. Substituting back:\n$$ (a+a^{\\dagger})^3 = a^3 + \\left((a^{\\dagger})^2a + 2a^{\\dagger}\\right) + \\left(2a^{\\dagger}a^2 + 2a\\right) + a + a^{\\dagger}a^2 + (a^{\\dagger})^3 + 2(a^{\\dagger})^2a + a^{\\dagger} $$\n$$ = a^3 + (a^{\\dagger})^3 + 3(a^{\\dagger})^2a + 3a^{\\dagger}a^2 + 3a^{\\dagger} + 3a $$\nNow we evaluate the matrix element:\n$$ \\langle n|x^3|m\\rangle = \\left(\\frac{\\hbar}{2M\\omega}\\right)^{3/2} \\langle n| a^3 + (a^{\\dagger})^3 + 3(a^{\\dagger})^2a + 3a^{\\dagger}a^2 + 3a^{\\dagger} + 3a |m\\rangle $$\nThe terms are:\n$$ \\langle n|a^3|m\\rangle = \\sqrt{m(m-1)(m-2)}\\delta_{n,m-3} $$\n$$ \\langle n|(a^{\\dagger})^3|m\\rangle = \\sqrt{(m+1)(m+2)(m+3)}\\delta_{n,m+3} $$\n$$ \\langle n|3(a^{\\dagger})^2a|m\\rangle = 3\\sqrt{m}\\langle n|(a^{\\dagger})^2|m-1\\rangle = 3\\sqrt{m}\\sqrt{m(m+1)}\\delta_{n,m+1} = 3m\\sqrt{m+1}\\delta_{n,m+1} $$\n$$ \\langle n|3a^{\\dagger}a^2|m\\rangle = 3\\sqrt{m(m-1)}\\langle n|a^{\\dagger}|m-2\\rangle = 3\\sqrt{m(m-1)}\\sqrt{m-1}\\delta_{n,m-1} = 3(m-1)\\sqrt{m}\\delta_{n,m-1} $$\n$$ \\langle n|3a^{\\dagger}|m\\rangle = 3\\sqrt{m+1}\\delta_{n,m+1} $$\n$$ \\langle n|3a|m\\rangle = 3\\sqrt{m}\\delta_{n,m-1} $$\nCombining these and grouping by the Kronecker delta:\nThe coefficient of $\\delta_{n,m-1}$ is $3(m-1)\\sqrt{m} + 3\\sqrt{m} = 3m\\sqrt{m}$.\nThe coefficient of $\\delta_{n,m+1}$ is $3m\\sqrt{m+1} + 3\\sqrt{m+1} = 3(m+1)\\sqrt{m+1}$.\nThe full expression is:\n$$ \\langle n|x^3|m\\rangle = \\left(\\frac{\\hbar}{2M\\omega}\\right)^{3/2} \\left[ \\sqrt{m(m-1)(m-2)}\\delta_{n,m-3} + 3m\\sqrt{m}\\delta_{n,m-1} + 3(m+1)\\sqrt{m+1}\\delta_{n,m+1} + \\sqrt{(m+1)(m+2)(m+3)}\\delta_{n,m+3} \\right] $$\n\n**Case k = 4**\n\nFor $k=4$, we have $x^4 = \\left(\\frac{\\hbar}{2M\\omega}\\right)^2 (a+a^{\\dagger})^4$. The normal-ordered form of $(a+a^{\\dagger})^4$ can be found by a similar, albeit more lengthy, procedure. Repeated application of the commutation relation yields:\n$$ (a+a^{\\dagger})^4 = a^4+(a^{\\dagger})^4 + 4(a^{\\dagger})^3 a + 4a^{\\dagger}a^3 + 6(a^{\\dagger})^2a^2 + 6(a^{\\dagger})^2 + 6a^2 + 12a^{\\dagger}a + 3 $$\nThe commutators have generated terms of order two and zero from the original terms of order four. We evaluate the matrix element of this expression:\n$$ \\langle n|x^4|m\\rangle = \\left(\\frac{\\hbar}{2M\\omega}\\right)^2 \\langle n| (a+a^{\\dagger})^4 |m\\rangle $$\nThe terms evaluate to:\n$$ \\langle n|a^4|m\\rangle = \\sqrt{m(m-1)(m-2)(m-3)}\\delta_{n,m-4} $$\n$$ \\langle n|(a^{\\dagger})^4|m\\rangle = \\sqrt{(m+1)(m+2)(m+3)(m+4)}\\delta_{n,m+4} $$\n$$ \\langle n|4(a^{\\dagger})^3a|m\\rangle = 4m\\sqrt{(m+1)(m+2)}\\delta_{n,m+2} $$\n$$ \\langle n|4a^{\\dagger}a^3|m\\rangle = 4(m-2)\\sqrt{m(m-1)}\\delta_{n,m-2} $$\n$$ \\langle n|6(a^{\\dagger})^2a^2|m\\rangle = 6m(m-1)\\delta_{n,m} $$\n$$ \\langle n|6(a^{\\dagger})^2|m\\rangle = 6\\sqrt{(m+1)(m+2)}\\delta_{n,m+2} $$\n$$ \\langle n|6a^2|m\\rangle = 6\\sqrt{m(m-1)}\\delta_{n,m-2} $$\n$$ \\langle n|12a^{\\dagger}a|m\\rangle = 12m\\delta_{n,m} $$\n$$ \\langle n|3|m\\rangle = 3\\delta_{n,m} $$\nCombining coefficients for each Kronecker delta:\n$\\delta_{n,m-2}$: $4(m-2)\\sqrt{m(m-1)} + 6\\sqrt{m(m-1)} = (4m-2)\\sqrt{m(m-1)}$.\n$\\delta_{n,m+2}$: $4m\\sqrt{(m+1)(m+2)} + 6\\sqrt{(m+1)(m+2)} = (4m+6)\\sqrt{(m+1)(m+2)}$.\n$\\delta_{n,m}$: $6m(m-1) + 12m + 3 = 6m^2 - 6m + 12m + 3 = 6m^2+6m+3$.\nThe final result for $k=4$ is:\n$$ \\langle n|x^4|m\\rangle = \\left(\\frac{\\hbar}{2M\\omega}\\right)^2 \\left[ \\sqrt{m(m-1)(m-2)(m-3)}\\delta_{n,m-4} + (4m-2)\\sqrt{m(m-1)}\\delta_{n,m-2} + (6m^2+6m+3)\\delta_{n,m} + (4m+6)\\sqrt{(m+1)(m+2)}\\delta_{n,m+2} + \\sqrt{(m+1)(m+2)(m+3)(m+4)}\\delta_{n,m+4} \\right] $$\n\n**Discussion of Sparsity and Parity**\n\nThe eigenfunctions $\\psi_n(x)$ of the quantum harmonic oscillator have definite parity, $\\psi_n(-x) = (-1)^n \\psi_n(x)$. The operator $x^k$ acts on functions of $x$. The matrix element is given by the integral $\\langle n|x^k|m\\rangle = \\int_{-\\infty}^{\\infty} \\psi_n^*(x) x^k \\psi_m(x) dx$. The parity of the integrand is $(-1)^n (-1)^k (-1)^m = (-1)^{n+m+k}$. For the integral to be non-zero, the integrand must be an even function, which requires $n+m+k$ to be an even number.\nThis leads to the following selection rules:\n1. If $k$ is odd, $n+m$ must be odd. This implies that $n$ and $m$ must have different parity. The matrix elements are non-zero only for transitions between states of opposite parity, e.g., $|n-m|=1, 3, 5, \\dots$. Our results for $k=1$ ($\\Delta n = \\pm 1$) and $k=3$ ($\\Delta n = \\pm 1, \\pm 3$) are consistent with this.\n2. If $k$ is even, $n+m$ must be even. This implies that $n$ and $m$ must have the same parity. The matrix elements are non-zero only for transitions between states of the same parity, e.g., $|n-m|=0, 2, 4, \\dots$. Our results for $k=2$ ($\\Delta n = 0, \\pm 2$) and $k=4$ ($\\Delta n = 0, \\pm 2, \\pm 4$) confirm this.\n\nThese selection rules result in a sparse matrix representation for the operators $x^k$. For $k=1$, the matrix is non-zero only on the first sub- and super-diagonals. For $k=2$, it is non-zero on the main diagonal and the second off-diagonals. For $k=3$, it is non-zero on the first and third off-diagonals. For $k=4$, it is non-zero on the main, second, and fourth off-diagonals. The maximum change in quantum number is $|n-m|_{max}=k$.", "answer": "$$ \\boxed{\\begin{pmatrix} \\left(\\frac{\\hbar}{2M\\omega}\\right)^{1/2} \\left[ \\sqrt{m}\\delta_{n,m-1} + \\sqrt{m+1}\\delta_{n,m+1} \\right] & \\left(\\frac{\\hbar}{2M\\omega}\\right) \\left[ \\sqrt{m(m-1)}\\delta_{n,m-2} + (2m+1)\\delta_{n,m} + \\sqrt{(m+1)(m+2)}\\delta_{n,m+2} \\right] & \\left(\\frac{\\hbar}{2M\\omega}\\right)^{3/2} \\left[ \\sqrt{m(m-1)(m-2)}\\delta_{n,m-3} + 3m\\sqrt{m}\\delta_{n,m-1} + 3(m+1)\\sqrt{m+1}\\delta_{n,m+1} + \\sqrt{(m+1)(m+2)(m+3)}\\delta_{n,m+3} \\right] & \\left(\\frac{\\hbar}{2M\\omega}\\right)^{2} \\left[ \\sqrt{m(m-1)(m-2)(m-3)}\\delta_{n,m-4} + (4m-2)\\sqrt{m(m-1)}\\delta_{n,m-2} + (6m^2+6m+3)\\delta_{n,m} + (4m+6)\\sqrt{(m+1)(m+2)}\\delta_{n,m+2} + \\sqrt{(m+1)(m+2)(m+3)(m+4)}\\delta_{n,m+4} \\right] \\end{pmatrix}} $$", "id": "2678950"}, {"introduction": "While the quantum harmonic oscillator is one of the few exactly solvable systems, most problems in quantum chemistry require approximation methods. The variational principle provides a powerful and rigorous framework for estimating the ground-state energy of any system. This practice applies the method to the harmonic oscillator itself, using a physically-motivated Gaussian trial function, allowing you to validate the principle against a known exact solution and build intuition for constructing effective trial wavefunctions [@problem_id:2678989].", "problem": "Consider a single particle of mass $m$ in one spatial dimension subject to a harmonic confining potential with angular frequency $\\omega$. The Hamiltonian operator is\n$$\n\\hat{H} \\;=\\; \\frac{\\hat{p}^{2}}{2 m} \\;+\\; \\frac{1}{2} m \\omega^{2} x^{2},\n$$\nwhere the canonical momentum operator is $\\hat{p} \\,=\\, -\\, i \\hbar \\,\\frac{d}{dx}$. Using the Rayleigh–Ritz variational principle, take the normalized Gaussian trial function\n$$\n\\psi_{\\alpha}(x) \\;=\\; \\left(\\frac{\\alpha}{\\pi}\\right)^{1/4} \\exp\\!\\left(-\\,\\frac{\\alpha x^{2}}{2}\\right),\n$$\nwith real variational parameter $\\alpha \\,>\\, 0$. Starting only from the definitions of the expectation value $\\langle \\hat{A} \\rangle \\,=\\, \\int_{-\\infty}^{\\infty} \\psi_{\\alpha}^{*}(x)\\,\\hat{A}\\,\\psi_{\\alpha}(x)\\,dx$, the explicit form of $\\hat{H}$ and $\\hat{p}$ above, and standard properties of Gaussian integrals, compute $\\langle \\hat{H} \\rangle$ as a function of $\\alpha$ and minimize it with respect to $\\alpha$. Determine the value of the width parameter $\\alpha$ that minimizes $\\langle \\hat{H} \\rangle$. Express your final answer as a closed-form analytic expression in terms of $m$, $\\omega$, and $\\hbar$.", "solution": "The objective is to compute the expectation value of the Hamiltonian, $\\langle \\hat{H} \\rangle$, using the provided trial wavefunction $\\psi_{\\alpha}(x)$, and then to minimize this expectation value with respect to the variational parameter $\\alpha$. The expectation value of the Hamiltonian, which we shall denote $E(\\alpha)$, is the sum of the expectation values of the kinetic and potential energy operators:\n$$\nE(\\alpha) = \\langle \\hat{H} \\rangle = \\langle \\hat{T} \\rangle + \\langle \\hat{V} \\rangle = \\left\\langle \\frac{\\hat{p}^{2}}{2 m} \\right\\rangle + \\left\\langle \\frac{1}{2} m \\omega^{2} x^{2} \\right\\rangle\n$$\nWe will compute each term separately.\n\nFirst, we compute the expectation value of the potential energy, $\\langle \\hat{V} \\rangle$:\n$$\n\\langle \\hat{V} \\rangle = \\int_{-\\infty}^{\\infty} \\psi_{\\alpha}^{*}(x) \\left( \\frac{1}{2} m \\omega^{2} x^{2} \\right) \\psi_{\\alpha}(x) dx\n$$\nSince $\\psi_{\\alpha}(x)$ is real, $\\psi_{\\alpha}^{*}(x) = \\psi_{\\alpha}(x)$.\n$$\n\\langle \\hat{V} \\rangle = \\frac{1}{2} m \\omega^{2} \\int_{-\\infty}^{\\infty} x^{2} |\\psi_{\\alpha}(x)|^{2} dx\n$$\nThe probability density is $|\\psi_{\\alpha}(x)|^{2} = \\left(\\frac{\\alpha}{\\pi}\\right)^{1/2} \\exp(-\\alpha x^{2})$.\n$$\n\\langle \\hat{V} \\rangle = \\frac{1}{2} m \\omega^{2} \\left(\\frac{\\alpha}{\\pi}\\right)^{1/2} \\int_{-\\infty}^{\\infty} x^{2} \\exp(-\\alpha x^{2}) dx\n$$\nWe use the standard definite integral formula for a Gaussian function:\n$$\n\\int_{-\\infty}^{\\infty} x^{2n} \\exp(-ax^{2}) dx = \\frac{(2n-1)!!}{2^{n} a^{n}} \\sqrt{\\frac{\\pi}{a}}\n$$\nFor our case, $n=1$ and $a=\\alpha$. Thus,\n$$\n\\int_{-\\infty}^{\\infty} x^{2} \\exp(-\\alpha x^{2}) dx = \\frac{1}{2\\alpha} \\sqrt{\\frac{\\pi}{\\alpha}}\n$$\nSubstituting this back into the expression for $\\langle \\hat{V} \\rangle$:\n$$\n\\langle \\hat{V} \\rangle = \\frac{1}{2} m \\omega^{2} \\left(\\frac{\\alpha}{\\pi}\\right)^{1/2} \\left( \\frac{1}{2\\alpha} \\sqrt{\\frac{\\pi}{\\alpha}} \\right) = \\frac{1}{2} m \\omega^{2} \\left(\\frac{\\alpha^{1/2}}{\\pi^{1/2}}\\right) \\left( \\frac{\\pi^{1/2}}{2\\alpha^{3/2}} \\right) = \\frac{m \\omega^{2}}{4\\alpha}\n$$\n\nNext, we compute the expectation value of the kinetic energy, $\\langle \\hat{T} \\rangle$:\n$$\n\\langle \\hat{T} \\rangle = \\left\\langle \\frac{\\hat{p}^{2}}{2 m} \\right\\rangle = \\frac{1}{2m} \\langle \\hat{p}^{2} \\rangle\n$$\nwhere $\\hat{p}^{2} = \\left(-i\\hbar\\frac{d}{dx}\\right)^{2} = -\\hbar^{2}\\frac{d^{2}}{dx^{2}}$.\n$$\n\\langle \\hat{T} \\rangle = \\frac{-\\hbar^{2}}{2m} \\int_{-\\infty}^{\\infty} \\psi_{\\alpha}^{*}(x) \\frac{d^{2}}{dx^{2}} \\psi_{\\alpha}(x) dx\n$$\nWe find the first and second derivatives of $\\psi_{\\alpha}(x)$:\n$$\n\\frac{d\\psi_{\\alpha}}{dx} = \\left(\\frac{\\alpha}{\\pi}\\right)^{1/4} \\frac{d}{dx} \\exp\\left(-\\frac{\\alpha x^{2}}{2}\\right) = \\left(\\frac{\\alpha}{\\pi}\\right)^{1/4} (-\\alpha x) \\exp\\left(-\\frac{\\alpha x^{2}}{2}\\right) = -\\alpha x \\psi_{\\alpha}(x)\n$$\n$$\n\\frac{d^{2}\\psi_{\\alpha}}{dx^{2}} = \\frac{d}{dx}(-\\alpha x \\psi_{\\alpha}(x)) = -\\alpha \\psi_{\\alpha}(x) - \\alpha x \\frac{d\\psi_{\\alpha}}{dx} = -\\alpha \\psi_{\\alpha}(x) - \\alpha x (-\\alpha x \\psi_{\\alpha}(x)) = (\\alpha^{2}x^{2} - \\alpha) \\psi_{\\alpha}(x)\n$$\nSubstituting this into the integral for $\\langle \\hat{T} \\rangle$:\n$$\n\\langle \\hat{T} \\rangle = \\frac{-\\hbar^{2}}{2m} \\int_{-\\infty}^{\\infty} \\psi_{\\alpha}(x) (\\alpha^{2}x^{2} - \\alpha) \\psi_{\\alpha}(x) dx = \\frac{-\\hbar^{2}}{2m} \\int_{-\\infty}^{\\infty} (\\alpha^{2}x^{2} - \\alpha) |\\psi_{\\alpha}(x)|^{2} dx\n$$\n$$\n\\langle \\hat{T} \\rangle = \\frac{-\\hbar^{2}}{2m} \\left( \\alpha^{2} \\int_{-\\infty}^{\\infty} x^{2} |\\psi_{\\alpha}(x)|^{2} dx - \\alpha \\int_{-\\infty}^{\\infty} |\\psi_{\\alpha}(x)|^{2} dx \\right)\n$$\nThe first integral is the expectation value $\\langle x^2 \\rangle$, which is related to the potential energy calculation. $\\langle x^{2} \\rangle = \\int x^{2} |\\psi_{\\alpha}|^{2} dx = \\frac{1}{2\\alpha}$. The second integral is $1$ because the wavefunction is normalized.\n$$\n\\langle \\hat{T} \\rangle = \\frac{-\\hbar^{2}}{2m} \\left( \\alpha^{2} \\left( \\frac{1}{2\\alpha} \\right) - \\alpha(1) \\right) = \\frac{-\\hbar^{2}}{2m} \\left( \\frac{\\alpha}{2} - \\alpha \\right) = \\frac{-\\hbar^{2}}{2m} \\left( -\\frac{\\alpha}{2} \\right) = \\frac{\\hbar^{2}\\alpha}{4m}\n$$\nNow, we combine the kinetic and potential energy expectation values to find the total energy functional $E(\\alpha)$:\n$$\nE(\\alpha) = \\langle \\hat{T} \\rangle + \\langle \\hat{V} \\rangle = \\frac{\\hbar^{2}\\alpha}{4m} + \\frac{m\\omega^{2}}{4\\alpha}\n$$\nTo find the value of $\\alpha$ that minimizes this energy, we must differentiate $E(\\alpha)$ with respect to $\\alpha$ and set the result to zero.\n$$\n\\frac{dE}{d\\alpha} = \\frac{d}{d\\alpha} \\left( \\frac{\\hbar^{2}\\alpha}{4m} + \\frac{m\\omega^{2}}{4\\alpha} \\right) = \\frac{\\hbar^{2}}{4m} - \\frac{m\\omega^{2}}{4\\alpha^{2}}\n$$\nSetting the derivative to zero:\n$$\n\\frac{dE}{d\\alpha} = 0 \\implies \\frac{\\hbar^{2}}{4m} = \\frac{m\\omega^{2}}{4\\alpha^{2}}\n$$\nSolving for $\\alpha^{2}$:\n$$\n\\hbar^{2}\\alpha^{2} = m^{2}\\omega^{2} \\implies \\alpha^{2} = \\frac{m^{2}\\omega^{2}}{\\hbar^{2}}\n$$\nSince the problem specifies $\\alpha > 0$, we take the positive square root:\n$$\n\\alpha = \\frac{m\\omega}{\\hbar}\n$$\nTo confirm this corresponds to a minimum, we evaluate the second derivative:\n$$\n\\frac{d^{2}E}{d\\alpha^{2}} = \\frac{d}{d\\alpha} \\left( \\frac{\\hbar^{2}}{4m} - \\frac{m\\omega^{2}}{4\\alpha^{2}} \\right) = \\frac{2m\\omega^{2}}{4\\alpha^{3}} = \\frac{m\\omega^{2}}{2\\alpha^{3}}\n$$\nSince $m$, $\\omega^{2}$, and $\\alpha$ are all positive, $\\frac{d^{2}E}{d\\alpha^{2}} > 0$, which confirms that the value of $\\alpha$ we found corresponds to a minimum of the energy.\n\nThus, the value of the width parameter $\\alpha$ that minimizes the expectation value of the Hamiltonian is $\\frac{m\\omega}{\\hbar}$.", "answer": "$$\n\\boxed{\\frac{m \\omega}{\\hbar}}\n$$", "id": "2678989"}, {"introduction": "The quantum harmonic oscillator is not just a pedagogical model; it is a powerful tool for solving more realistic and complex problems. This exercise moves from analytical theory to computational practice by tackling the anharmonic oscillator, a system that more accurately describes molecular vibrations but lacks an exact analytical solution. By using the QHO eigenfunctions as a basis set to construct and diagonalize the Hamiltonian matrix, you will implement a standard numerical technique in quantum chemistry and directly observe how the accuracy of your approximation improves as the basis size increases [@problem_id:2678924].", "problem": "Consider the one-dimensional anharmonic oscillator in dimensionless harmonic-oscillator units where $\\hbar = 1$, $m = 1$, and the harmonic frequency $\\omega = 1$. The time-independent Schrödinger equation (TISE) for the Hamiltonian operator $\\hat{H}$ acting on a stationary state $\\psi(x)$ is\n$$\n\\hat{H}\\,\\psi(x) = E\\,\\psi(x),\n$$\nwith\n$$\n\\hat{H} = \\frac{\\hat{p}^2}{2} + \\frac{x^2}{2} + \\alpha\\,x^4.\n$$\nHere $\\hat{p}$ is the momentum operator, $x$ is the position operator, and $\\alpha \\ge 0$ is a real parameter controlling the strength of the anharmonic term. All energies in this problem must be reported in units of $\\hbar\\omega$.\n\nYour task is to construct a finite-basis approximation (Ritz-Galerkin projection) using the orthonormal eigenfunctions of the one-dimensional Quantum Harmonic Oscillator (QHO) as the basis. Specifically:\n\n1. Starting from the TISE and the canonical commutation relation $[\\hat{x},\\hat{p}] = i$, define the QHO reference Hamiltonian $\\hat{H}_0 = \\frac{\\hat{p}^2}{2} + \\frac{x^2}{2}$ and its orthonormal eigenfunctions $\\{\\phi_n(x)\\}_{n=0}^{\\infty}$ with eigenvalues $\\{E_n^{(0)}\\}_{n=0}^{\\infty}$. Use these as the basis for a finite-dimensional approximation. Do not assume any target formulas for matrix elements; derive operator representations from first principles beginning with the commutation relations and definitions of the ladder operators.\n\n2. For a chosen basis size $N \\in \\mathbb{N}$, construct the $N\\times N$ matrix representation of $\\hat{H}$ in the QHO basis restricted to $\\{\\phi_0,\\phi_1,\\ldots,\\phi_{N-1}\\}$. Ensure that the representation is self-adjoint (Hermitian) and that it is constructed from the operator definitions (for example, by first expressing $\\hat{x}$ and $\\hat{p}$ in terms of ladder operators and then forming $\\hat{x}^4$ from $\\hat{x}$). Then numerically diagonalize the matrix to obtain the $N$ lowest Ritz approximations to the energy spectrum. The two lowest energies will be denoted $E_0^{(N)}$ and $E_1^{(N)}$.\n\n3. Investigate convergence with increasing basis size $N$ for each fixed $\\alpha$ by computing sequences $E_0^{(N_k)}$ and $E_1^{(N_k)}$ for an increasing list of basis sizes $\\{N_k\\}_{k=1}^K$. Determine whether each sequence is monotonically non-increasing as $k$ grows. Use a numerical tolerance of $10^{-10}$ to decide monotonicity, that is, declare that a sequence $\\{e_k\\}$ is monotonically non-increasing if $e_{k+1} \\le e_k + 10^{-10}$ for all $k$.\n\n4. Numerical specification and units:\n- All calculations must be performed in the stated dimensionless units. Energies must be reported in units of $\\hbar\\omega$ and rounded to $6$ decimal places.\n- Angles do not appear in this problem.\n- There are no percentage quantities in this problem.\n\nImplement a complete program that carries out the above for the following test suite of parameter values:\n- Test case $1$: $\\alpha = 0.0$, $N$-list $= [4,6,8]$.\n- Test case $2$: $\\alpha = 0.01$, $N$-list $= [6,10,14,18]$.\n- Test case $3$: $\\alpha = 0.1$, $N$-list $= [6,10,14,18]$.\n- Test case $4$: $\\alpha = 1.0$, $N$-list $= [8,12,16,24]$.\n\nFor each test case, your program must:\n- Compute the two lowest eigenvalues for each $N$ in the given list.\n- Report, for the largest $N$ in the list, the approximations $E_0^{(N_{\\max})}$ and $E_1^{(N_{\\max})}$ rounded to $6$ decimal places.\n- Report two boolean values indicating whether $\\{E_0^{(N_k)}\\}$ and $\\{E_1^{(N_k)}\\}$ are monotonically non-increasing as $k$ increases, using the tolerance specified above.\n\nFinal output format:\n- Your program should produce a single line of output containing a list with one entry per test case, where each entry is itself a list of the form\n$$\n\\big[ E_0^{(N_{\\max})},\\; E_1^{(N_{\\max})},\\; \\text{is\\_mono\\_E0},\\; \\text{is\\_mono\\_E1} \\big],\n$$\nwith energies rounded to $6$ decimal places and the booleans as either True or False.\n- Concretely, the output must be a single line string representation of a Python list, for example:\n\"[ [e00,e01,True,True], [e10,e11,True,False], [e20,e21,True,True], [e30,e31,True,True] ]\"\nwhere each $e_{jk}$ is a float as specified.", "solution": "The objective is to solve for the lowest energy eigenvalues of the anharmonic oscillator described by the Hamiltonian $\\hat{H} = \\hat{H}_0 + \\alpha \\hat{x}^4$, where $\\hat{H}_0 = \\frac{\\hat{p}^2}{2} + \\frac{x^2}{2}$ is the quantum harmonic oscillator (QHO) Hamiltonian. This will be accomplished by projecting the time-independent Schrödinger equation onto a finite-dimensional subspace spanned by the first $N$ eigenfunctions of the QHO.\n\n**1. Operator Formalism in the QHO Basis**\n\nWe work in dimensionless units where $\\hbar=1$, $m=1$, and $\\omega=1$. We begin by defining the ladder operators $\\hat{a}$ and $\\hat{a}^\\dagger$ from the position and momentum operators, $\\hat{x}$ and $\\hat{p}$:\n$$\n\\hat{a} = \\frac{1}{\\sqrt{2}}(\\hat{x} + i\\hat{p}) \\quad , \\quad \\hat{a}^\\dagger = \\frac{1}{\\sqrt{2}}(\\hat{x} - i\\hat{p})\n$$\nTheir commutator is derived from the canonical commutation relation $[\\hat{x}, \\hat{p}] = i$:\n$$\n[\\hat{a}, \\hat{a}^\\dagger] = \\frac{1}{2}[\\hat{x} + i\\hat{p}, \\hat{x} - i\\hat{p}] = \\frac{1}{2}( -i[\\hat{x}, \\hat{p}] + i[\\hat{p}, \\hat{x}] ) = \\frac{1}{2}( -i(i) - i(-i) ) = \\frac{1}{2}(1+1) = 1\n$$\nInverting the definitions of the ladder operators gives $\\hat{x}$ and $\\hat{p}$:\n$$\n\\hat{x} = \\frac{1}{\\sqrt{2}}(\\hat{a} + \\hat{a}^\\dagger) \\quad , \\quad \\hat{p} = \\frac{i}{\\sqrt{2}}(\\hat{a}^\\dagger - \\hat{a})\n$$\nThe QHO Hamiltonian $\\hat{H}_0$ can be expressed in terms of these operators:\n$$\n\\hat{H}_0 = \\frac{1}{2} \\left( \\left(\\frac{i}{\\sqrt{2}}(\\hat{a}^\\dagger - \\hat{a})\\right)^2 + \\left(\\frac{1}{\\sqrt{2}}(\\hat{a} + \\hat{a}^\\dagger)\\right)^2 \\right) = \\frac{1}{4} \\left( -(\\hat{a}^\\dagger - \\hat{a})^2 + (\\hat{a} + \\hat{a}^\\dagger)^2 \\right)\n$$\n$$\n\\hat{H}_0 = \\frac{1}{4} \\left( -(\\hat{a}^{\\dagger 2} - \\hat{a}^\\dagger \\hat{a} - \\hat{a}\\hat{a}^\\dagger + \\hat{a}^2) + (\\hat{a}^2 + \\hat{a}\\hat{a}^\\dagger + \\hat{a}^\\dagger\\hat{a} + \\hat{a}^{\\dagger 2}) \\right) = \\frac{1}{2}( \\hat{a}\\hat{a}^\\dagger + \\hat{a}^\\dagger\\hat{a} )\n$$\nUsing $[\\hat{a}, \\hat{a}^\\dagger]=1$, or $\\hat{a}\\hat{a}^\\dagger = \\hat{a}^\\dagger\\hat{a} + 1$, we simplify $\\hat{H}_0$ to:\n$$\n\\hat{H}_0 = \\frac{1}{2}( \\hat{a}^\\dagger\\hat{a} + 1 + \\hat{a}^\\dagger\\hat{a} ) = \\hat{a}^\\dagger\\hat{a} + \\frac{1}{2}\n$$\nThe orthonormal eigenfunctions of $\\hat{H}_0$, denoted $\\{|\\phi_n\\rangle\\}_{n=0}^{\\infty}$ or simply $\\{|n\\rangle\\}$, are the number states. They are eigenstates of the number operator $\\hat{n} \\equiv \\hat{a}^\\dagger\\hat{a}$ with integer eigenvalues $n$: $\\hat{n}|n\\rangle = n|n\\rangle$. Consequently, the energy eigenvalues of $\\hat{H}_0$ are $E_n^{(0)} = n + \\frac{1}{2}$. The actions of the ladder operators on these states are:\n$$\n\\hat{a}|n\\rangle = \\sqrt{n}|n-1\\rangle \\quad, \\quad \\hat{a}^\\dagger|n\\rangle = \\sqrt{n+1}|n+1\\rangle\n$$\n\n**2. Construction of the Hamiltonian Matrix**\n\nWe approximate the infinite-dimensional problem by restricting it to the subspace spanned by the first $N$ QHO eigenfunctions, $\\mathcal{B}_N = \\{|0\\rangle, |1\\rangle, \\ldots, |N-1\\rangle\\}$. The matrix representation of the Hamiltonian $\\hat{H}$ in this basis has elements $H_{mn} = \\langle m | \\hat{H} | n \\rangle$, where $m,n \\in \\{0, 1, \\ldots, N-1\\}$.\n$$\nH_{mn} = \\langle m | \\hat{H}_0 + \\alpha\\hat{x}^4 | n \\rangle = \\langle m | \\hat{H}_0 | n \\rangle + \\alpha \\langle m | \\hat{x}^4 | n \\rangle\n$$\nThe matrix for the QHO part is diagonal:\n$$\n\\langle m | \\hat{H}_0 | n \\rangle = \\langle m | (n + 1/2) | n \\rangle = (n + 1/2) \\delta_{mn}\n$$\nThe matrix elements of the perturbation term $\\hat{x}^4$ must be computed. A direct algebraic expansion of $\\hat{x}^4$ into ladder operators is tedious. A more robust and systematic method is to first construct the matrix representation of the operator $\\hat{x}$ and then compute its fourth power using matrix multiplication. The matrix elements of $\\hat{x}$ are:\n$$\nX_{mn} = \\langle m|\\hat{x}|n\\rangle = \\frac{1}{\\sqrt{2}}\\langle m|(\\hat{a} + \\hat{a}^\\dagger)|n\\rangle = \\frac{1}{\\sqrt{2}}(\\sqrt{n}\\langle m|n-1\\rangle + \\sqrt{n+1}\\langle m|n+1\\rangle)\n$$\n$$\nX_{mn} = \\frac{1}{\\sqrt{2}}(\\sqrt{n}\\,\\delta_{m,n-1} + \\sqrt{n+1}\\,\\delta_{m,n+1})\n$$\nThis defines a real, symmetric (and therefore Hermitian) $N \\times N$ matrix $X$. The matrix for $\\hat{x}^4$, denoted $X^4$, is obtained by multiplying $X$ by itself four times. As $X$ is Hermitian, $X^4$ is also Hermitian.\n\nThe full $N \\times N$ Hamiltonian matrix $H^{(N)}$ is thus:\n$$\nH^{(N)}_{mn} = (n + 1/2)\\delta_{mn} + \\alpha (X^4)_{mn}\n$$\n\n**3. Numerical Diagonalization and the Variational Principle**\n\nThe Ritz-Galerkin method consists of finding the eigenvalues of this finite matrix $H^{(N)}$. These eigenvalues, denoted $\\{E_k^{(N)}\\}_{k=0}^{N-1}$, are approximations to the true energy levels of the anharmonic oscillator. According to the Hylleraas-Undheim-MacDonald theorem, these Ritz energies are upper bounds to the true energies $E_k$, i.e., $E_k^{(N)} \\ge E_k$. Furthermore, the theorem guarantees that as the basis size $N$ is increased, these approximations improve monotonically from above:\n$$\nE_k \\le \\ldots \\le E_k^{(N+1)} \\le E_k^{(N)} \\le \\ldots\n$$\nThis property dictates that the sequences $\\{E_0^{(N_k)}\\}$ and $\\{E_1^{(N_k)}\\}$ must be monotonically non-increasing for any increasing sequence of basis sizes $\\{N_k\\}$, provided that numerical precision is sufficient. The condition $e_{k+1} \\le e_k + \\epsilon$ with a small positive tolerance $\\epsilon$ accommodates for floating-point arithmetic limitations.\n\nThe numerical implementation will construct the matrix $H^{(N)}$ for each required $N_k$ and $\\alpha$, diagonalize it to find its two lowest eigenvalues, and then check the monotonicity of the resulting energy sequences.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the 1D anharmonic oscillator problem using a QHO basis expansion.\n\n    This function iterates through a set of predefined test cases. For each case,\n    it calculates the two lowest energy eigenvalues for a list of increasing\n    basis sizes (N). It then reports the eigenvalues for the largest basis size\n    and checks if the sequences of eigenvalues are monotonically non-increasing,\n    as predicted by the variational principle.\n    \"\"\"\n\n    test_cases = [\n        {\"alpha\": 0.0, \"N_list\": [4, 6, 8]},\n        {\"alpha\": 0.01, \"N_list\": [6, 10, 14, 18]},\n        {\"alpha\": 0.1, \"N_list\": [6, 10, 14, 18]},\n        {\"alpha\": 1.0, \"N_list\": [8, 12, 16, 24]},\n    ]\n    \n    tolerance = 1e-10\n    final_results = []\n\n    for case in test_cases:\n        alpha = case[\"alpha\"]\n        N_list = case[\"N_list\"]\n\n        e0_sequence = []\n        e1_sequence = []\n\n        for N in N_list:\n            # 1. Construct the matrix representation of the position operator x.\n            # The matrix elements are X_mn = <m|x|n>\n            X = np.zeros((N, N), dtype=float)\n            for n in range(N - 1):\n                val = np.sqrt(n + 1)\n                X[n, n + 1] = val\n                X[n + 1, n] = val\n            X /= np.sqrt(2)\n\n            # 2. Construct the matrix for the QHO Hamiltonian H0.\n            # H0 is diagonal with elements H0_nn = n + 0.5\n            H0 = np.diag(np.arange(N) + 0.5)\n\n            # 3. Construct the full Hamiltonian matrix H = H0 + alpha * x^4.\n            # The matrix for x^4 is computed by matrix exponentiation.\n            X4 = np.linalg.matrix_power(X, 4)\n            H = H0 + alpha * X4\n\n            # 4. Diagonalize the Hermitian matrix H to find the eigenvalues.\n            # np.linalg.eigh returns eigenvalues in ascending order.\n            eigenvalues = np.linalg.eigh(H)[0]\n            \n            e0_sequence.append(eigenvalues[0])\n            e1_sequence.append(eigenvalues[1])\n\n        # 5. Check for monotonicity of the energy sequences.\n        # According to the variational principle, E_k(N) >= E_k(N+1).\n        is_mono_E0 = all(e0_sequence[i+1] <= e0_sequence[i] + tolerance for i in range(len(e0_sequence) - 1))\n        is_mono_E1 = all(e1_sequence[i+1] <= e1_sequence[i] + tolerance for i in range(len(e1_sequence) - 1))\n\n        # 6. Get the final energies from the largest basis set calculation.\n        e0_final = e0_sequence[-1]\n        e1_final = e1_sequence[-1]\n\n        final_results.append([\n            round(e0_final, 6),\n            round(e1_final, 6),\n            is_mono_E0,\n            is_mono_E1\n        ])\n    \n    # 7. Print the final results in the specified list-of-lists format.\n    print(str(final_results))\n\nsolve()\n```", "id": "2678924"}]}