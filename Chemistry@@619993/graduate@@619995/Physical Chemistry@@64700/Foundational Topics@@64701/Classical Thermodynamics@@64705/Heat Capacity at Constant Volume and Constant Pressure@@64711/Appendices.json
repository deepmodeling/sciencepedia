{"hands_on_practices": [{"introduction": "This first practice problem revisits a fundamental link between macroscopic thermodynamic properties and the microscopic world of molecules. By analyzing the experimentally measured heat capacity at constant pressure, $C_{p,m}$, you can infer the types of motion—translational and rotational—available to a gas molecule under specific conditions. This exercise [@problem_id:1983439] challenges you to apply the equipartition theorem, a cornerstone of classical statistical mechanics, to connect a simple calorimetric measurement to the likely geometry of a molecule.", "problem": "A chemical engineer is characterizing a newly synthesized, unknown gaseous compound at room temperature ($298 \\, \\text{K}$) and low pressure, where it can be accurately modeled as an ideal gas. Through careful calorimetric measurements, the molar heat capacity at constant pressure, $C_{p,m}$, is determined to be $29.05 \\, \\text{J}\\,\\text{mol}^{-1}\\,\\text{K}^{-1}$. Based on the equipartition theorem, and assuming that vibrational contributions to the heat capacity are negligible at this temperature, determine the most likely molecular structure of this compound. The ideal gas constant is $R = 8.314 \\, \\text{J}\\,\\text{mol}^{-1}\\,\\text{K}^{-1}$.\n\nA. Monatomic\n\nB. Diatomic or linear polyatomic\n\nC. Non-linear polyatomic\n\nD. The provided information is insufficient to make a determination.", "solution": "At low pressure the gas is ideal. By the equipartition theorem with vibrational contributions negligible at room temperature, each quadratic degree of freedom contributes an average energy of $\\frac{1}{2}RT$ per mole, so for $f$ active quadratic degrees of freedom the molar internal energy is\n$$\nU_{m}=\\frac{f}{2}RT,\n$$\nand therefore the molar heat capacities are\n$$\nC_{V,m}=\\left(\\frac{\\partial U_{m}}{\\partial T}\\right)_{V}=\\frac{f}{2}R,\\qquad C_{p,m}=C_{V,m}+R=\\left(\\frac{f}{2}+1\\right)R.\n$$\nThe translational contribution is always $3$ degrees of freedom. The rotational contribution depends on molecular structure:\n- Monatomic: no rotational quadratic energy at the classical level, effectively $f=3$, hence\n$$\nC_{p,m}^{\\text{mono}}=\\frac{5}{2}R.\n$$\n- Diatomic or linear polyatomic: two rotational degrees, $f=3+2=5$, hence\n$$\nC_{p,m}^{\\text{linear}}=\\frac{7}{2}R.\n$$\n- Non-linear polyatomic: three rotational degrees, $f=3+3=6$, hence\n$$\nC_{p,m}^{\\text{nonlin}}=4R.\n$$\nThe measured value is $C_{p,m}=29.05\\,\\text{J}\\,\\text{mol}^{-1}\\,\\text{K}^{-1}$. Normalizing by $R$,\n$$\n\\frac{C_{p,m}}{R}=\\frac{29.05}{8.314}\\approx 3.50\\approx \\frac{7}{2},\n$$\nwhich matches the diatomic or linear polyatomic prediction $\\frac{7}{2}R$ and is clearly distinct from the monatomic $\\frac{5}{2}R$ and the non-linear polyatomic $4R$. Therefore, the most likely molecular structure is diatomic or linear polyatomic.", "answer": "$$\\boxed{B}$$", "id": "1983439"}, {"introduction": "Moving beyond the classical equipartition theorem, this exercise explores the heat capacity of a system governed by quantum mechanics. We will analyze a collection of non-interacting two-level atoms, a model system that is not only of theoretical importance but also provides a simplified picture for phenomena like LASERs. By deriving the heat capacity $C_V$ from the canonical partition function [@problem_id:1969896], you will uncover its characteristic temperature dependence and investigate its behavior even at negative absolute temperatures, a concept crucial for understanding population-inverted states.", "problem": "A simplified model for the gain medium of a Light Amplification by Stimulated Emission of Radiation (LASER) consists of atoms that can be approximated as two-level systems. Consider a system of $N$ such non-interacting, distinguishable atoms kept at a constant volume. Each atom has a ground state with energy $\\epsilon_0$ and an excited state with energy $\\epsilon_1$. Let the energy gap be denoted by $\\Delta \\epsilon = \\epsilon_1 - \\epsilon_0$.\n\nThe system is in thermal equilibrium with a heat reservoir at a temperature $T$, which can be positive or negative. In this model, a positive temperature corresponds to a normal population distribution (more atoms in the ground state), while a negative absolute temperature corresponds to a state of population inversion (more atoms in the excited state), which is a necessary condition for LASER operation.\n\nYour task is to determine the total heat capacity at constant volume, $C_V$, for this entire system of $N$ atoms. Express your answer as a function of $N$, $\\Delta \\epsilon$, the temperature $T$, and the Boltzmann constant $k_B$.", "solution": "We consider $N$ non-interacting, distinguishable two-level atoms at fixed volume in contact with a heat reservoir at temperature $T$. Let the two energy levels be $\\epsilon_{0}$ and $\\epsilon_{1}$ with gap $\\Delta \\epsilon = \\epsilon_{1} - \\epsilon_{0}$. The heat capacity $C_{V}$ is defined as the temperature derivative of the internal energy at constant volume, and for a canonical ensemble it can be obtained from the partition function.\n\nAdding a constant to all energy levels shifts the internal energy by a $T$-independent constant and therefore does not change $C_{V}$. We exploit this by centering the two levels symmetrically about zero: set the single-atom energies to $-\\Delta \\epsilon/2$ and $+\\Delta \\epsilon/2$. This leaves all temperature derivatives invariant and makes the algebra transparent.\n\nFor one atom, the canonical partition function is\n$$\nz = \\sum_{i} \\exp(-\\beta \\epsilon_{i}) = \\exp\\!\\left(\\beta \\frac{\\Delta \\epsilon}{2}\\right) + \\exp\\!\\left(-\\beta \\frac{\\Delta \\epsilon}{2}\\right) = 2 \\cosh\\!\\left(\\beta \\frac{\\Delta \\epsilon}{2}\\right),\n$$\nwhere $\\beta = 1/(k_{B} T)$, which can be positive or negative.\n\nThe internal energy per atom is given by the canonical relation $u = - \\partial \\ln z / \\partial \\beta$:\n$$\nu = - \\frac{\\partial}{\\partial \\beta} \\ln\\!\\left[2 \\cosh\\!\\left(\\beta \\frac{\\Delta \\epsilon}{2}\\right)\\right]\n= - \\frac{1}{2 \\cosh\\!\\left(\\beta \\frac{\\Delta \\epsilon}{2}\\right)} \\cdot 2 \\cdot \\frac{\\Delta \\epsilon}{2} \\sinh\\!\\left(\\beta \\frac{\\Delta \\epsilon}{2}\\right)\n= - \\frac{\\Delta \\epsilon}{2} \\tanh\\!\\left(\\beta \\frac{\\Delta \\epsilon}{2}\\right).\n$$\n\nThe heat capacity per atom at constant volume is $c_{V} = (\\partial u / \\partial T)_{V}$. Using the chain rule with $\\beta = 1/(k_{B} T)$,\n$$\nc_{V} = \\frac{\\partial u}{\\partial \\beta} \\cdot \\frac{\\partial \\beta}{\\partial T}\n= \\left[- \\frac{\\Delta \\epsilon}{2} \\cdot \\frac{\\partial}{\\partial \\beta} \\tanh\\!\\left(\\beta \\frac{\\Delta \\epsilon}{2}\\right)\\right] \\cdot \\left(- \\frac{1}{k_{B} T^{2}}\\right).\n$$\nSince $\\frac{d}{dx} \\tanh x = \\frac{1}{\\cosh^{2} x}$ and $\\frac{\\partial}{\\partial \\beta} \\tanh\\!\\left(\\beta \\frac{\\Delta \\epsilon}{2}\\right) = \\frac{\\Delta \\epsilon}{2} \\cdot \\frac{1}{\\cosh^{2}\\!\\left(\\beta \\frac{\\Delta \\epsilon}{2}\\right)}$, we obtain\n$$\n\\frac{\\partial u}{\\partial \\beta} = - \\frac{\\Delta \\epsilon}{2} \\cdot \\frac{\\Delta \\epsilon}{2} \\cdot \\frac{1}{\\cosh^{2}\\!\\left(\\beta \\frac{\\Delta \\epsilon}{2}\\right)} = - \\frac{(\\Delta \\epsilon)^{2}}{4} \\cdot \\frac{1}{\\cosh^{2}\\!\\left(\\beta \\frac{\\Delta \\epsilon}{2}\\right)}.\n$$\nTherefore,\n$$\nc_{V} = \\frac{(\\Delta \\epsilon)^{2}}{4} \\cdot \\frac{1}{\\cosh^{2}\\!\\left(\\beta \\frac{\\Delta \\epsilon}{2}\\right)} \\cdot \\frac{1}{k_{B} T^{2}}\n= k_{B} \\left(\\frac{\\Delta \\epsilon}{2 k_{B} T}\\right)^{2} \\frac{1}{\\cosh^{2}\\!\\left(\\frac{\\Delta \\epsilon}{2 k_{B} T}\\right)}.\n$$\n\nFor $N$ independent atoms, energies add and so do heat capacities, yielding the total heat capacity\n$$\nC_{V} = N \\, c_{V} = N \\, k_{B} \\left(\\frac{\\Delta \\epsilon}{2 k_{B} T}\\right)^{2} \\frac{1}{\\cosh^{2}\\!\\left(\\frac{\\Delta \\epsilon}{2 k_{B} T}\\right)}.\n$$\nThis expression is valid for both positive and negative $T$ because it depends on $T$ only through $T^{2}$ and the even function $\\cosh$ of $\\Delta \\epsilon/(2 k_{B} T)$.", "answer": "$$\\boxed{N k_{B} \\left(\\frac{\\Delta \\epsilon}{2 k_{B} T}\\right)^{2} \\frac{1}{\\cosh^{2}\\!\\left(\\frac{\\Delta \\epsilon}{2 k_{B} T}\\right)}}$$", "id": "1969896"}, {"introduction": "This final practice bridges theoretical statistical mechanics with modern computational chemistry, a key skill for graduate researchers. You will derive and numerically validate a powerful relationship from the canonical ensemble: the connection between the heat capacity $C_V$ and the fluctuations of the system's total energy, an instance of the fluctuation-dissipation theorem. This exercise [@problem_id:2643817] involves both a rigorous derivation and a simulated numerical experiment, providing a hands-on look at how thermodynamic quantities are extracted from molecular simulation data and an appreciation for the challenges of finite sampling.", "problem": "You are asked to formalize, derive, and numerically validate two independent canonical-ensemble routes to the constant-volume heat capacity for a system sampled in the constant number, volume, and temperature ensemble (NVT). The goal is to test whether the constant-volume heat capacity computed from energy fluctuations and from temperature derivatives agree when estimated from finite-length NVT “simulations,” and to quantify the discrepancy under different sampling conditions.\n\nStart from the canonical ensemble and its fundamental definitions. Let the Hamiltonian be $H(\\mathbf{q},\\mathbf{p})$ and define the inverse temperature $\\beta = 1/\\left(k_{\\mathrm B} T\\right)$, where $k_{\\mathrm B}$ is the Boltzmann constant and $T$ is the absolute temperature. The canonical partition function is\n$$\nZ(\\beta) = \\int \\mathrm{d}\\mathbf{q}\\,\\mathrm{d}\\mathbf{p}\\,\\exp\\!\\left(-\\beta\\,H(\\mathbf{q},\\mathbf{p})\\right).\n$$\nAn ensemble average of any observable $A$ is\n$$\n\\langle A\\rangle_{\\beta} = \\frac{1}{Z(\\beta)} \\int \\mathrm{d}\\mathbf{q}\\,\\mathrm{d}\\mathbf{p}\\,A(\\mathbf{q},\\mathbf{p})\\,\\exp\\!\\left(-\\beta\\,H(\\mathbf{q},\\mathbf{p})\\right).\n$$\nUsing these definitions only, derive two independent expressions for the constant-volume heat capacity $C_V$ of the system, one expressed in terms of a derivative of the average total energy with respect to temperature at fixed volume, and the other expressed in terms of the equilibrium fluctuations of the total energy in the canonical ensemble. Your derivations must proceed from the canonical definitions above, and you must not assume any final form of the target expressions in advance.\n\nFor the numerical validation, consider a class of systems whose total energy is the sum of $f$ independent quadratic degrees of freedom. For such systems, the microcanonical density of states scales as a power of the energy, which leads to a canonical energy distribution that is a gamma distribution. You will emulate “NVT simulations” by independently sampling total energies from this canonical energy distribution for given $f$ and $T$. Use the value $k_{\\mathrm B} = 1.380649\\times 10^{-23}\\,\\mathrm{J}\\,\\mathrm{K}^{-1}$.\n\nFor each test case below, at a target temperature $T_0$, estimate $C_V$ by:\n- The fluctuation route at $T_0$ using energies sampled at $T_0$.\n- The temperature-derivative route by estimating $\\langle E\\rangle$ at three temperatures $T_- = (1-\\delta)\\,T_0$, $T_0$, and $T_+ = (1+\\delta)\\,T_0$, and then performing a symmetric finite-difference estimate of the slope $\\mathrm{d}\\langle E\\rangle/\\mathrm{d}T$ at $T_0$.\n\nFor each test case, report the absolute difference between the two $C_V$ estimates in $\\mathrm{J}\\,\\mathrm{K}^{-1}$. Express each reported difference in $\\mathrm{J}\\,\\mathrm{K}^{-1}$, rounded to $6$ significant figures.\n\nTest suite (each tuple lists $(f,\\,T_0,\\,N,\\,\\delta,\\,\\text{seed})$):\n- Case A (well-sampled): $(60,\\;300\\,\\mathrm{K},\\;200000,\\;0.05,\\;12345)$\n- Case B (undersampled): $(6,\\;300\\,\\mathrm{K},\\;2000,\\;0.05,\\;2024)$\n- Case C (very few degrees at high temperature): $(2,\\;1000\\,\\mathrm{K},\\;1000,\\;0.10,\\;777)$\n- Case D (many degrees, moderate sampling): $(300,\\;300\\,\\mathrm{K},\\;50000,\\;0.02,\\;424242)$\n\nImplementation details to respect:\n- Model the total energy $E$ as a gamma-distributed random variable appropriate for the sum of $f$ independent quadratic degrees of freedom at temperature $T$, and independently sample $N$ energies at each temperature needed for a given test case.\n- Use independent random number streams for each test case as specified by the seed.\n- For the derivative route, use the symmetric finite difference based on $\\langle E\\rangle$ at $T_+$ and $T_-$.\n- For the fluctuation route, estimate the variance from the $N$ energies at $T_0$ using the unbiased sample variance.\n- Numerically, express all energies in $\\mathrm{J}$ and all heat capacities in $\\mathrm{J}\\,\\mathrm{K}^{-1}$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order of the test suite above. Each entry must be the absolute difference between the two $C_V$ estimates for the corresponding test case, in $\\mathrm{J}\\,\\mathrm{K}^{-1}$, each rounded to $6$ significant figures (for example, $[1.23457\\mathrm{e}{-05},2.34568\\mathrm{e}{-06},\\dots]$). No other output is permitted.", "solution": "We begin from the canonical ensemble. The partition function is $Z(\\beta) = \\int \\mathrm{d}\\mathbf{q}\\,\\mathrm{d}\\mathbf{p}\\,\\exp\\!\\left(-\\beta\\,H(\\mathbf{q},\\mathbf{p})\\right)$ with $\\beta = 1/\\left(k_{\\mathrm B} T\\right)$. The ensemble average of the total energy $E = H(\\mathbf{q},\\mathbf{p})$ is\n$$\n\\langle E\\rangle_{\\beta} = \\frac{1}{Z(\\beta)} \\int \\mathrm{d}\\mathbf{q}\\,\\mathrm{d}\\mathbf{p}\\,H(\\mathbf{q},\\mathbf{p})\\,\\exp\\!\\left(-\\beta\\,H(\\mathbf{q},\\mathbf{p})\\right).\n$$\nA well-known identity derived from $Z(\\beta)$ is $\\langle E\\rangle_{\\beta} = -\\partial \\ln Z/\\partial \\beta$. Taking another derivative with respect to $\\beta$ yields\n$$\n\\frac{\\partial \\langle E\\rangle}{\\partial \\beta} = -\\frac{\\partial^2 \\ln Z}{\\partial \\beta^2} = -\\left(\\langle E^2\\rangle - \\langle E\\rangle^2\\right) = -\\mathrm{Var}(E).\n$$\nUsing $\\beta = 1/\\left(k_{\\mathrm B} T\\right)$, we have $\\mathrm{d}\\beta/\\mathrm{d}T = -1/\\left(k_{\\mathrm B} T^2\\right)$. By the chain rule,\n$$\n\\frac{\\mathrm{d}\\langle E\\rangle}{\\mathrm{d}T} = \\frac{\\mathrm{d}\\langle E\\rangle}{\\mathrm{d}\\beta}\\,\\frac{\\mathrm{d}\\beta}{\\mathrm{d}T} = \\left(-\\mathrm{Var}(E)\\right)\\left(-\\frac{1}{k_{\\mathrm B} T^2}\\right) = \\frac{\\mathrm{Var}(E)}{k_{\\mathrm B} T^2}.\n$$\nTherefore, the constant-volume heat capacity, defined as $C_V = \\left(\\partial \\langle E\\rangle/\\partial T\\right)_V$ in the canonical ensemble, admits two equivalent expressions:\n- A derivative route: $C_V = \\left(\\partial \\langle E\\rangle/\\partial T\\right)_V$.\n- A fluctuation route: $C_V = \\mathrm{Var}(E)/\\left(k_{\\mathrm B} T^2\\right)$.\n\nThese expressions are exact in the canonical ensemble for any Hamiltonian $H$ that has no explicit dependence on temperature. They provide the theoretical basis for our numerical test.\n\nTo construct an NVT-like sampler that is analytically tractable, we now specialize to a system whose total energy is a sum of $f$ independent quadratic degrees of freedom. For such a system, the microcanonical density of states scales as $g(E)\\propto E^{f/2 - 1}$. In the canonical ensemble, the probability density of the total energy is then\n$$\np(E;\\beta) = \\frac{1}{Z_E(\\beta)}\\,g(E)\\,\\mathrm{e}^{-\\beta E} \\propto E^{\\alpha-1}\\,\\mathrm{e}^{-E/\\theta},\n$$\nwith shape parameter $\\alpha = f/2$ and scale parameter $\\theta = k_{\\mathrm B} T$. This is precisely a gamma distribution with $\\mathrm{shape}=\\alpha$ and $\\mathrm{scale}=\\theta$. Its moments are $\\langle E\\rangle = \\alpha\\,\\theta$ and $\\mathrm{Var}(E) = \\alpha\\,\\theta^2$. Consequently, the exact constant-volume heat capacity for this class of systems is $C_V = \\alpha\\,k_{\\mathrm B} = (f/2)\\,k_{\\mathrm B}$. However, in finite “simulations,” we do not access exact moments, but rather sample estimates, which leads to discrepancies between the two numerical routes when statistical noise and numerical differentiation error are present.\n\nAlgorithmic design for the numerical test:\n1. For each test case, fix $f$, $T_0$, $N$, $\\delta$, and the random seed. Set $k_{\\mathrm B} = 1.380649\\times 10^{-23}\\,\\mathrm{J}\\,\\mathrm{K}^{-1}$.\n2. Define $\\alpha = f/2$ and, for any temperature $T$, set $\\theta(T) = k_{\\mathrm B} T$.\n3. Sample $N$ independent energies from the gamma distribution with shape $\\alpha$ and scale $\\theta(T_0)$ to emulate an NVT trajectory at $T_0$. Compute the unbiased sample variance $\\widehat{\\mathrm{Var}}(E;T_0)$ and form the fluctuation estimate\n$$\n\\widehat{C_V}^{(\\mathrm{fluc})}(T_0) = \\frac{\\widehat{\\mathrm{Var}}(E;T_0)}{k_{\\mathrm B} T_0^2}.\n$$\n4. For the derivative route, define $T_- = (1-\\delta)\\,T_0$ and $T_+ = (1+\\delta)\\,T_0$. Independently sample $N$ energies from gamma distributions at $T_-$ and $T_+$ and compute the corresponding sample means $\\widehat{\\langle E\\rangle}(T_-)$ and $\\widehat{\\langle E\\rangle}(T_+)$. Form the symmetric finite-difference estimate\n$$\n\\widehat{C_V}^{(\\mathrm{deriv})}(T_0) = \\frac{\\widehat{\\langle E\\rangle}(T_+) - \\widehat{\\langle E\\rangle}(T_-)}{T_+ - T_-}.\n$$\n5. For each test case, compute the absolute difference\n$$\n\\Delta = \\left|\\widehat{C_V}^{(\\mathrm{fluc})}(T_0) - \\widehat{C_V}^{(\\mathrm{deriv})}(T_0)\\right|\n$$\nexpressed in $\\mathrm{J}\\,\\mathrm{K}^{-1}$.\n6. Output the four $\\Delta$ values, in the order of the test suite, as a single line: a comma-separated list enclosed in square brackets, each rounded to $6$ significant figures.\n\nScientific realism and sources of discrepancies:\n- Finite sampling: With finite $N$, both the sample variance and the finite-difference slope are noisy, leading to nonzero $\\Delta$. The sampling error scales roughly as $N^{-1/2}$ for independent samples.\n- Numerical differentiation: The derivative route estimates a slope using a finite temperature increment. For nonlinear $\\langle E\\rangle(T)$, too large $\\delta$ introduces truncation error; too small $\\delta$ amplifies statistical noise. In our quadratic benchmark, $\\langle E\\rangle(T)$ is linear in $T$, so truncation error vanishes, but noise remains.\n- Autocorrelation and equilibration (not explicitly modeled here): In real NVT molecular dynamics, correlated samples reduce the effective sample size and bias naive error estimates; insufficient equilibration biases both routes.\n- Thermostat artifacts and noncanonical sampling (not modeled here): If the configurational distribution deviates from canonical, the fluctuation-derivative identity can appear to fail.\n\nUnder ideal canonical sampling, both routes converge to the same value as $N\\to\\infty$, and the reported $\\Delta$ values decrease with increasing $N$ and $f$ (the latter because relative fluctuations shrink), consistent with the central limit theorem and the fact that both estimators are consistent for $C_V$.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef sample_energies_gamma(f, T, N, rng, k_B):\n    \"\"\"\n    Sample total energies for a system with f quadratic degrees of freedom\n    from the canonical ensemble at temperature T using the gamma distribution.\n    shape = alpha = f/2\n    scale = theta = k_B * T\n    \"\"\"\n    alpha = 0.5 * f\n    theta = k_B * T\n    # numpy.random.Generator.gamma uses shape (k) and scale (theta)\n    E = rng.gamma(shape=alpha, scale=theta, size=N)\n    return E\n\ndef cv_fluctuation(energies, T, k_B):\n    \"\"\"\n    Compute C_V via the fluctuation formula using unbiased sample variance.\n    \"\"\"\n    var_e = np.var(energies, ddof=1)\n    return var_e / (k_B * T * T)\n\ndef cv_derivative(f, T0, delta, N, rng, k_B):\n    \"\"\"\n    Compute C_V via finite difference derivative using sample means at T+ and T-.\n    \"\"\"\n    T_minus = (1.0 - delta) * T0\n    T_plus = (1.0 + delta) * T0\n    E_minus = sample_energies_gamma(f, T_minus, N, rng, k_B)\n    E_plus = sample_energies_gamma(f, T_plus, N, rng, k_B)\n    mean_minus = np.mean(E_minus)\n    mean_plus = np.mean(E_plus)\n    slope = (mean_plus - mean_minus) / (T_plus - T_minus)\n    return slope\n\ndef solve():\n    # Constants\n    k_B = 1.380649e-23  # J/K\n\n    # Define the test cases from the problem statement.\n    # Each case: (f, T0 [K], N samples, delta, seed)\n    test_cases = [\n        (60, 300.0, 200000, 0.05, 12345),   # Case A\n        (6, 300.0, 2000, 0.05, 2024),       # Case B\n        (2, 1000.0, 1000, 0.10, 777),       # Case C\n        (300, 300.0, 50000, 0.02, 424242),  # Case D\n    ]\n\n    results = []\n    for f, T0, N, delta, seed in test_cases:\n        rng = np.random.default_rng(seed)\n        # Fluctuation route at T0\n        E_T0 = sample_energies_gamma(f, T0, N, rng, k_B)\n        cv_fluc = cv_fluctuation(E_T0, T0, k_B)\n        # Derivative route via symmetric finite difference\n        # Use a new RNG stream for derivative sampling to avoid overlap\n        rng_deriv = np.random.default_rng(seed + 1)\n        cv_der = cv_derivative(f, T0, delta, N, rng_deriv, k_B)\n        diff = abs(cv_fluc - cv_der)\n        # Round to 6 significant figures for output formatting\n        results.append(diff)\n\n    # Format each float to 6 significant figures using general format\n    formatted = []\n    for x in results:\n        # Use numpy formatting to ensure scientific notation for very small values\n        formatted.append(f\"{x:.6g}\")\n    print(f\"[{','.join(formatted)}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "2643817"}]}