{"hands_on_practices": [{"introduction": "Mastering quantum mechanics begins with solving the time-independent Schrödinger equation for simple, yet insightful, model potentials. The finite potential well is a canonical example that moves beyond the idealized infinite well to describe a particle with a finite escape energy, a more realistic scenario for electrons in molecules or quantum dots. This exercise [@problem_id:2922248] will guide you through the first-principles derivation of energy quantization conditions by enforcing the continuity of the wavefunction, providing a concrete illustration of how boundary conditions give rise to discrete energy levels.", "problem": "Consider a one-dimensional, symmetric finite square well potential defined by\n$$\nV(x)=\\begin{cases}\n- V_{0}, & |x|<a,\\\\\n0, & |x|\\ge a,\n\\end{cases}\n$$\nwith $V_{0}>0$, $a>0$, and a particle of mass $m$. Bound states have energies $E$ satisfying $-V_{0}<E<0$. Starting from the time-independent Schrödinger equation and enforcing the required boundary and continuity conditions for physically acceptable stationary states, do the following:\n\n- Derive, from first principles, the transcendental quantization conditions that determine the bound-state energies for even-parity and odd-parity stationary states in this potential.\n- Introduce the dimensionless parameters $z\\equiv k a$, $y\\equiv \\kappa a$, with $k\\equiv \\sqrt{2 m (E+V_{0})}/\\hbar$ and $\\kappa\\equiv \\sqrt{2 m (-E)}/\\hbar$, and the dimensionless well parameter $z_{0}\\equiv a \\sqrt{2 m V_{0}}/\\hbar$. Express your quantization conditions in terms of $z$, $y$, and $z_{0}$.\n- Using only the results you have derived, determine the minimal value of the dimensionless well parameter $z_{0}$ required for the existence of at least one bound state. Provide your final answer as a single exact number. No rounding is necessary. The final answer is dimensionless; do not include units.", "solution": "The problem statement will first be validated against the required criteria.\n\n**Step 1: Extract Givens**\n- Potential: $V(x)=\\begin{cases} -V_{0}, & |x|<a \\\\ 0, & |x|\\ge a \\end{cases}$\n- Constraints: $V_{0}>0$, $a>0$\n- Particle mass: $m$\n- Bound state energy range: $-V_{0}<E<0$\n- Task 1: Derive transcendental quantization conditions for even and odd parity stationary states.\n- Task 2: Introduce dimensionless parameters $z\\equiv k a$, $y\\equiv \\kappa a$, with $k\\equiv \\sqrt{2 m (E+V_{0})}/\\hbar$ and $\\kappa\\equiv \\sqrt{2 m (-E)}/\\hbar$, and the dimensionless well parameter $z_{0}\\equiv a \\sqrt{2 m V_{0}}/\\hbar$. Express quantization conditions in these variables.\n- Task 3: Determine the minimal value of $z_{0}$ for the existence of at least one bound state.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is a standard, fundamental exercise in one-dimensional quantum mechanics concerning the finite potential well.\n- **Scientifically Grounded**: The problem is built upon the time-independent Schrödinger equation and the principles of quantum mechanics. It is scientifically sound and factually correct.\n- **Well-Posed**: The problem is clearly defined and structured. It requests a step-by-step derivation leading to a final, specific value. The existence and uniqueness of the solution to this problem are well-established.\n- **Objective**: The language is precise, mathematical, and free of any subjective or ambiguous terminology.\n\nAll conditions for a valid problem are met. There are no scientific flaws, ambiguities, or contradictions.\n\n**Step 3: Verdict and Action**\nThe problem is valid. A full, reasoned solution will now be provided.\n\n**Derivation of Quantization Conditions**\n\nThe time-independent Schrödinger equation (TISE) for a particle of mass $m$ in a potential $V(x)$ is:\n$$\n-\\frac{\\hbar^2}{2m} \\frac{d^2\\psi(x)}{dx^2} + V(x)\\psi(x) = E\\psi(x)\n$$\nWe consider bound states, where $-V_{0} < E < 0$. We solve the TISE in the three regions defined by the potential.\n\n**Region I ($x \\ge a$) and Region III ($x \\le -a$)**:\nIn these regions, $V(x)=0$. The TISE becomes:\n$$\n\\frac{d^2\\psi}{dx^2} = \\frac{2mE}{\\hbar^2}\\psi = \\kappa^2\\psi\n$$\nwhere we have defined $\\kappa \\equiv \\frac{\\sqrt{2m(-E)}}{\\hbar}$. Since $E<0$, $\\kappa$ is a real, positive constant. The general solution is $\\psi(x) = C_1 e^{\\kappa x} + C_2 e^{-\\kappa x}$. For a bound state, the wavefunction must be normalizable, which requires $\\psi(x) \\to 0$ as $|x| \\to \\infty$.\n- In Region I ($x \\ge a$), we must discard the $e^{\\kappa x}$ term, so $\\psi_I(x) = A e^{-\\kappa x}$.\n- In Region III ($x \\le -a$), we must discard the $e^{-\\kappa x}$ term, so $\\psi_{III}(x) = B e^{\\kappa x}$.\n\n**Region II ($|x| < a$)**:\nIn this region, $V(x) = -V_0$. The TISE becomes:\n$$\n\\frac{d^2\\psi}{dx^2} = -\\frac{2m(E+V_0)}{\\hbar^2}\\psi = -k^2\\psi\n$$\nwhere we have defined $k \\equiv \\frac{\\sqrt{2m(E+V_0)}}{\\hbar}$. Since $E > -V_0$, $k$ is a real, positive constant. The general solution is $\\psi_{II}(x) = C \\cos(kx) + D \\sin(kx)$.\n\nThe potential $V(x)$ is symmetric, i.e., $V(x) = V(-x)$. Therefore, the stationary states can be chosen to have definite parity (even or odd).\n\n**Even-Parity Solutions ($\\psi(-x) = \\psi(x)$)**:\nFor an even solution, the wavefunction in Region II must be $\\psi_{II}(x) = C \\cos(kx)$. By symmetry, the solution in Regions I and III must be of the form $\\psi(x) = A e^{-\\kappa|x|}$ for $|x| \\ge a$. We apply the boundary conditions (continuity of $\\psi(x)$ and its derivative $\\psi'(x)$) at $x=a$.\n\\begin{align*} \\psi_{II}(a) &= \\psi_I(a) \\implies C \\cos(ka) = A e^{-\\kappa a} \\\\ \\psi_{II}'(a) &= \\psi_I'(a) \\implies -k C \\sin(ka) = -\\kappa A e^{-\\kappa a} \\end{align*}\nDividing the second equation by the first (assuming $C, A, \\cos(ka) \\ne 0$) yields:\n$$\n\\frac{-k C \\sin(ka)}{C \\cos(ka)} = \\frac{-\\kappa A e^{-\\kappa a}}{A e^{-\\kappa a}} \\implies k \\tan(ka) = \\kappa\n$$\nThis is the transcendental quantization condition for even-parity bound states.\n\n**Odd-Parity Solutions ($\\psi(-x) = -\\psi(x)$)**:\nFor an odd solution, the wavefunction in Region II must be $\\psi_{II}(x) = D \\sin(kx)$. The solution in Regions I and III must be of the form $\\psi(x) = A \\cdot \\text{sgn}(x) e^{-\\kappa|x|}$ for $|x| \\ge a$, ensuring $\\psi(a)=A e^{-\\kappa a}$ and $\\psi(-a)=-A e^{\\kappa a}$. We apply boundary conditions at $x=a$.\n\\begin{align*} \\psi_{II}(a) &= \\psi_I(a) \\implies D \\sin(ka) = A e^{-\\kappa a} \\\\ \\psi_{II}'(a) &= \\psi_I'(a) \\implies k D \\cos(ka) = -\\kappa A e^{-\\kappa a} \\end{align*}\nDividing the second equation by the first (assuming $D, A, \\sin(ka) \\ne 0$) gives:\n$$\n\\frac{k D \\cos(ka)}{D \\sin(ka)} = \\frac{-\\kappa A e^{-\\kappa a}}{A e^{-\\kappa a}} \\implies k \\cot(ka) = -\\kappa\n$$\nThis is the transcendental quantization condition for odd-parity bound states.\n\n**Dimensionless Formulation**\nWe introduce the dimensionless variables $z = ka$, $y = \\kappa a$, and $z_0 = \\frac{a}{\\hbar}\\sqrt{2mV_0}$. We establish a relationship between them:\n$$\nk^2 = \\frac{2m(E+V_0)}{\\hbar^2} \\implies k^2 a^2 = \\frac{2ma^2(E+V_0)}{\\hbar^2} = z^2\n$$\n$$\n\\kappa^2 = \\frac{2m(-E)}{\\hbar^2} \\implies \\kappa^2 a^2 = -\\frac{2ma^2 E}{\\hbar^2} = y^2\n$$\nAdding these two expressions:\n$$\nz^2 + y^2 = \\frac{2ma^2}{\\hbar^2}(E+V_0 - E) = \\frac{2ma^2 V_0}{\\hbar^2} = \\left(\\frac{a}{\\hbar}\\sqrt{2mV_0}\\right)^2 = z_0^2\n$$\nSo, we have the equation of a circle in the $(z, y)$ plane: $z^2 + y^2 = z_0^2$.\nNow we express the quantization conditions in these variables by multiplying by $a$:\n- **Even states**: $ka \\tan(ka) = \\kappa a \\implies z \\tan(z) = y$\n- **Odd states**: $-ka \\cot(ka) = \\kappa a \\implies -z \\cot(z) = y$\n\n**Minimal Condition for a Bound State**\nA bound state exists if there is an intersection between the circle $z^2+y^2=z_0^2$ and the transcendental curves in the first quadrant ($z>0$, $y>0$, since $k, \\kappa, a > 0$ for a non-trivial bound state with $E \\in (-V_0, 0)$).\n\nThe ground state corresponds to the lowest allowed energy, which is the first solution to appear as the well parameter $z_0$ is increased from $0$. Let us analyze the graphical solutions.\n- **Even states**: The curve $y = z \\tan(z)$ starts at the origin $(0,0)$ and increases, approaching a vertical asymptote at $z = \\pi/2$.\n- **Odd states**: The curve $y = -z \\cot(z)$ has its first branch in the first quadrant starting at the point $(\\pi/2, 0)$ and increasing towards an asymptote at $z = \\pi$.\n- **Circle**: $y = \\sqrt{z_0^2 - z^2}$ is a quarter-circle of radius $z_0$ centered at the origin.\n\nTo have at least one bound state, we seek the smallest $z_0 > 0$ that allows for an intersection. The ground state is always an even-parity state for a symmetric potential, so we first examine the condition for an even state.\n\nConsider the even-state curve $y=z \\tan(z)$ and the circle $y=\\sqrt{z_0^2-z^2}$.\nLet's analyze the behavior near the origin, $z \\to 0$.\nThe curve $y = z \\tan(z)$ starts at the origin $(0,0)$. For small $z$, $\\tan(z) \\approx z$, so $y \\approx z^2$.\nThe circle $y = \\sqrt{z_0^2-z^2}$ starts on the y-axis at $(0, z_0)$.\nAs $z$ increases from $0$, the curve $y=z \\tan(z)$ rises from $y=0$, while the circle arc falls from $y=z_0$. Since one starts at $0$ and the other starts at $z_0 > 0$, and both are continuous, they must intersect for any value $z_0 > 0$.\n\nMore formally, let $f(z) = z \\tan(z)$ and $g(z) = \\sqrt{z_0^2 - z^2}$. We are looking for a solution to $f(z) = g(z)$ for $z \\in (0, z_0)$. Let $h(z) = g(z) - f(z) = \\sqrt{z_0^2 - z^2} - z \\tan(z)$.\nFor any $z_0$ in the interval $(0, \\pi/2)$, we can evaluate $h(z)$ at the endpoints of the domain $[0, z_0]$:\n- At $z=0$: $h(0) = \\sqrt{z_0^2 - 0} - 0 = z_0 > 0$.\n- At $z=z_0$: $h(z_0) = \\sqrt{z_0^2 - z_0^2} - z_0 \\tan(z_0) = -z_0 \\tan(z_0)$. Since $z_0 \\in (0, \\pi/2)$, $\\tan(z_0) > 0$, so $h(z_0) < 0$.\nSince $h(z)$ is a continuous function on $[0, z_0]$ and changes sign from positive at $z=0$ to negative at $z=z_0$, the Intermediate Value Theorem guarantees that there must be at least one root for $z \\in (0, z_0)$. Even for $z_0 \\ge \\pi/2$, a solution is guaranteed as the curve $y=z\\tan(z)$ goes to infinity at $z=\\pi/2$ while the circle remains finite.\n\nTherefore, an even-parity bound state exists for any arbitrarily small but positive potential strength, i.e., for any $z_0 > 0$.\nThe question asks for the minimal value of $z_0$ required for the existence of *at least one* bound state. The set of $z_0$ values for which a bound state exists is $(0, \\infty)$. The minimal value is the infimum (greatest lower bound) of this set.\n$$\n\\inf \\{z_0 \\in \\mathbb{R} \\mid z_0 > 0\\} = 0\n$$\nFor completeness, the first odd-parity state only appears when the circle is large enough to intersect the odd-state curve $y=-z\\cot(z)$, which starts at $(\\pi/2, 0)$. This requires the radius of the circle $z_0$ to be at least $\\pi/2$. The threshold for the first odd state is $z_0 = \\pi/2$. However, since an even parity state always exists for any $z_0 > 0$, this is the true ground state of the system. The requirement for \"at least one bound state\" is met for any positive $z_0$. The minimal value is therefore $0$.", "answer": "$$\n\\boxed{0}\n$$", "id": "2922248"}, {"introduction": "While exactly solvable models are crucial for building intuition, the vast majority of problems in quantum chemistry do not have exact analytical solutions. This is where approximation methods become indispensable, and one of the most powerful of these is the variational principle. In this problem [@problem_id:2922377], you will apply this principle to estimate the ground-state energy of a particle in a quartic potential, a classic example of a system that defies simple solution, thereby gaining hands-on experience with the machinery that underpins many advanced computational techniques.", "problem": "Consider the one-dimensional stationary Schrödinger equation for a particle of mass $m$ in the purely quartic potential $V(x)=\\lambda x^{4}$ with $\\lambda>0$:\n$$\n\\left[-\\frac{\\hbar^{2}}{2m}\\frac{d^{2}}{dx^{2}}+\\lambda x^{4}\\right]\\psi(x)=E\\,\\psi(x).\n$$\nUsing the Rayleigh–Ritz variational principle, which states that for any normalized trial function $\\psi$ the expectation value $\\langle \\psi|\\hat{H}|\\psi\\rangle$ provides an upper bound to the exact ground-state energy, proceed as follows.\n\nUse the normalized Gaussian trial family \n$$\n\\psi_{\\alpha}(x)=\\left(\\frac{\\alpha}{\\pi}\\right)^{\\frac{1}{4}}\\exp\\!\\left(-\\frac{\\alpha x^{2}}{2}\\right),\n$$\nwith variational parameter $\\alpha>0$, to construct the variational energy functional $E(\\alpha)=\\langle \\psi_{\\alpha}|\\hat{H}|\\psi_{\\alpha}\\rangle$. Then, by minimizing $E(\\alpha)$ with respect to $\\alpha$, obtain a closed-form analytic expression for the optimized variational upper bound $E_{\\mathrm{var}}(\\lambda,m,\\hbar)$ to the ground-state energy.\n\nAdditionally, starting from the stationary Schrödinger equation, perform a scaling analysis to determine how the exact ground-state energy scales with $\\lambda$, $m$, and $\\hbar$, and compare that scaling with the dependence found in your variational upper bound.\n\nExpress your final answer as the single closed-form analytic expression for $E_{\\mathrm{var}}(\\lambda,m,\\hbar)$. No numerical evaluation or rounding is required, and no units are to be reported in the final answer.", "solution": "The problem is subjected to validation before a solution is attempted.\n\n**Step 1: Extract Givens**\n-   The one-dimensional stationary Schrödinger equation: $\\left[-\\frac{\\hbar^{2}}{2m}\\frac{d^{2}}{dx^{2}}+\\lambda x^{4}\\right]\\psi(x)=E\\,\\psi(x)$.\n-   The potential is $V(x)=\\lambda x^{4}$ with $\\lambda > 0$. The particle has mass $m$.\n-   The variational principle: For any normalized trial function $\\psi$, the expectation value $\\langle \\psi|\\hat{H}|\\psi\\rangle$ is an upper bound to the exact ground-state energy.\n-   The normalized trial wavefunction family: $\\psi_{\\alpha}(x)=\\left(\\frac{\\alpha}{\\pi}\\right)^{\\frac{1}{4}}\\exp\\!\\left(-\\frac{\\alpha x^{2}}{2}\\right)$, with variational parameter $\\alpha>0$.\n-   Task 1: Construct the variational energy functional $E(\\alpha)=\\langle \\psi_{\\alpha}|\\hat{H}|\\psi_{\\alpha}\\rangle$.\n-   Task 2: Minimize $E(\\alpha)$ with respect to $\\alpha$ to obtain a closed-form analytic expression for the optimized variational upper bound $E_{\\mathrm{var}}(\\lambda,m,\\hbar)$.\n-   Task 3: Perform a scaling analysis on the Schrödinger equation to determine the scaling of the exact ground-state energy and compare it with the variational result.\n\n**Step 2: Validate Using Extracted Givens**\n-   **Scientifically Grounded and Objective:** The problem deals with the stationary Schrödinger equation, the quartic oscillator potential, and the Rayleigh-Ritz variational principle. These are fundamental and well-established concepts in quantum mechanics and quantum chemistry. The language is precise and objective.\n-   **Well-Posed:** The problem is well-posed. It specifies the Hamiltonian, a valid family of trial wavefunctions, and a clear set of instructions for applying a standard approximation method (the variational principle). The goal is to find an analytic expression, which is a mathematically sound objective.\n-   **Complete and Consistent:** The problem provides all necessary information. The Hamiltonian is defined, the trial function is given in normalized form, and the parameter space for the variation ($\\alpha>0$) is specified. There are no contradictions.\n\n**Step 3: Verdict and Action**\nThe problem is valid as it is scientifically sound, well-posed, and self-contained. A complete solution will be provided.\n\n**Solution Derivation**\n\nThe Hamiltonian operator $\\hat{H}$ for the system is given by the sum of the kinetic energy operator $\\hat{T}$ and the potential energy operator $\\hat{V}$.\n$$\n\\hat{H} = \\hat{T} + \\hat{V} = -\\frac{\\hbar^{2}}{2m}\\frac{d^{2}}{dx^{2}} + \\lambda x^{4}\n$$\nThe variational energy functional $E(\\alpha)$ is the expectation value of the Hamiltonian with respect to the trial wavefunction $\\psi_{\\alpha}(x)$.\n$$\nE(\\alpha) = \\langle \\psi_{\\alpha} | \\hat{H} | \\psi_{\\alpha} \\rangle = \\int_{-\\infty}^{\\infty} \\psi_{\\alpha}^{*}(x) \\hat{H} \\psi_{\\alpha}(x) dx\n$$\nSince the trial wavefunction $\\psi_{\\alpha}(x)$ is real, $\\psi_{\\alpha}^{*}(x) = \\psi_{\\alpha}(x)$. The energy functional can be split into the expectation values of the kinetic and potential energies:\n$$\nE(\\alpha) = \\langle T \\rangle_{\\alpha} + \\langle V \\rangle_{\\alpha}\n$$\nThe trial wavefunction is $\\psi_{\\alpha}(x) = \\left(\\frac{\\alpha}{\\pi}\\right)^{1/4}\\exp\\left(-\\frac{\\alpha x^{2}}{2}\\right)$. The corresponding probability density is $\\psi_{\\alpha}^{2}(x) = \\left(\\frac{\\alpha}{\\pi}\\right)^{1/2}\\exp\\left(-\\alpha x^{2}\\right)$, which is a Gaussian distribution.\n\n**1. Kinetic Energy Expectation Value $\\langle T \\rangle_{\\alpha}$**\nThe kinetic energy expectation value can be calculated as:\n$$\n\\langle T \\rangle_{\\alpha} = \\int_{-\\infty}^{\\infty} \\psi_{\\alpha}(x) \\left(-\\frac{\\hbar^{2}}{2m}\\frac{d^{2}}{dx^{2}}\\right) \\psi_{\\alpha}(x) dx\n$$\nUsing integration by parts, this is equivalent to:\n$$\n\\langle T \\rangle_{\\alpha} = \\frac{\\hbar^{2}}{2m} \\int_{-\\infty}^{\\infty} \\left(\\frac{d\\psi_{\\alpha}}{dx}\\right)^{2} dx\n$$\nFirst, we find the derivative of the trial function:\n$$\n\\frac{d\\psi_{\\alpha}}{dx} = \\left(\\frac{\\alpha}{\\pi}\\right)^{1/4} \\exp\\left(-\\frac{\\alpha x^{2}}{2}\\right) (-\\alpha x) = -\\alpha x \\psi_{\\alpha}(x)\n$$\nTherefore, $\\left(\\frac{d\\psi_{\\alpha}}{dx}\\right)^{2} = \\alpha^{2} x^{2} \\psi_{\\alpha}^{2}(x)$. Substituting this into the integral for $\\langle T \\rangle_{\\alpha}$:\n$$\n\\langle T \\rangle_{\\alpha} = \\frac{\\hbar^{2}\\alpha^{2}}{2m} \\int_{-\\infty}^{\\infty} x^{2} \\psi_{\\alpha}^{2}(x) dx = \\frac{\\hbar^{2}\\alpha^{2}}{2m} \\langle x^{2} \\rangle_{\\alpha}\n$$\nThe term $\\langle x^{2} \\rangle_{\\alpha}$ is the variance of the Gaussian probability distribution $\\psi_{\\alpha}^{2}(x)$, which is known to be $\\frac{1}{2\\alpha}$. We can verify this with the standard integral $\\int_{-\\infty}^{\\infty} x^{2}e^{-ax^{2}}dx = \\frac{1}{2a}\\sqrt{\\frac{\\pi}{a}}$.\n$$\n\\langle x^{2} \\rangle_{\\alpha} = \\left(\\frac{\\alpha}{\\pi}\\right)^{1/2} \\int_{-\\infty}^{\\infty} x^{2}e^{-\\alpha x^{2}}dx = \\left(\\frac{\\alpha}{\\pi}\\right)^{1/2} \\left(\\frac{1}{2\\alpha}\\sqrt{\\frac{\\pi}{\\alpha}}\\right) = \\frac{1}{2\\alpha}\n$$\nSubstituting this back into the expression for $\\langle T \\rangle_{\\alpha}$:\n$$\n\\langle T \\rangle_{\\alpha} = \\frac{\\hbar^{2}\\alpha^{2}}{2m} \\left(\\frac{1}{2\\alpha}\\right) = \\frac{\\hbar^{2}\\alpha}{4m}\n$$\n\n**2. Potential Energy Expectation Value $\\langle V \\rangle_{\\alpha}$**\nThe potential energy expectation value is:\n$$\n\\langle V \\rangle_{\\alpha} = \\int_{-\\infty}^{\\infty} \\psi_{\\alpha}(x) (\\lambda x^{4}) \\psi_{\\alpha}(x) dx = \\lambda \\int_{-\\infty}^{\\infty} x^{4} \\psi_{\\alpha}^{2}(x) dx = \\lambda \\langle x^{4} \\rangle_{\\alpha}\n$$\nWe need to compute the fourth moment $\\langle x^{4} \\rangle_{\\alpha}$. Using the standard integral $\\int_{-\\infty}^{\\infty} x^{4}e^{-ax^{2}}dx = \\frac{3}{4a^{2}}\\sqrt{\\frac{\\pi}{a}}$:\n$$\n\\langle x^{4} \\rangle_{\\alpha} = \\left(\\frac{\\alpha}{\\pi}\\right)^{1/2} \\int_{-\\infty}^{\\infty} x^{4}e^{-\\alpha x^{2}}dx = \\left(\\frac{\\alpha}{\\pi}\\right)^{1/2} \\left(\\frac{3}{4\\alpha^{2}}\\sqrt{\\frac{\\pi}{\\alpha}}\\right) = \\frac{3}{4\\alpha^{2}}\n$$\nThus, the potential energy expectation value is:\n$$\n\\langle V \\rangle_{\\alpha} = \\lambda \\left(\\frac{3}{4\\alpha^{2}}\\right) = \\frac{3\\lambda}{4\\alpha^{2}}\n$$\n\n**3. Minimization of the Energy Functional $E(\\alpha)$**\nThe total energy functional is the sum of the kinetic and potential energy parts:\n$$\nE(\\alpha) = \\langle T \\rangle_{\\alpha} + \\langle V \\rangle_{\\alpha} = \\frac{\\hbar^{2}\\alpha}{4m} + \\frac{3\\lambda}{4\\alpha^{2}}\n$$\nTo find the value of $\\alpha$ that minimizes this energy, we differentiate $E(\\alpha)$ with respect to $\\alpha$ and set the result to zero:\n$$\n\\frac{dE(\\alpha)}{d\\alpha} = \\frac{d}{d\\alpha} \\left( \\frac{\\hbar^{2}\\alpha}{4m} + \\frac{3\\lambda}{4\\alpha^{2}} \\right) = \\frac{\\hbar^{2}}{4m} - \\frac{6\\lambda}{4\\alpha^{3}} = 0\n$$\n$$\n\\frac{\\hbar^{2}}{4m} = \\frac{3\\lambda}{2\\alpha^{3}}\n$$\nSolving for the optimal value of $\\alpha$, which we denote $\\alpha_{\\mathrm{min}}$:\n$$\n\\alpha_{\\mathrm{min}}^{3} = \\frac{12m\\lambda}{2\\hbar^{2}} = \\frac{6m\\lambda}{\\hbar^{2}} \\implies \\alpha_{\\mathrm{min}} = \\left(\\frac{6m\\lambda}{\\hbar^{2}}\\right)^{1/3}\n$$\nThe second derivative, $\\frac{d^{2}E}{d\\alpha^{2}} = \\frac{18\\lambda}{4\\alpha^{4}} = \\frac{9\\lambda}{2\\alpha^{4}}$, is positive for $\\lambda > 0$ and $\\alpha > 0$, confirming that this is a minimum.\n\n**4. Optimized Variational Energy $E_{\\mathrm{var}}$**\nThe optimized variational energy $E_{\\mathrm{var}}$ is obtained by substituting $\\alpha_{\\mathrm{min}}$ back into the expression for $E(\\alpha)$:\n$$\nE_{\\mathrm{var}} = E(\\alpha_{\\mathrm{min}}) = \\frac{\\hbar^{2}\\alpha_{\\mathrm{min}}}{4m} + \\frac{3\\lambda}{4\\alpha_{\\mathrm{min}}^{2}}\n$$\nAt the minimum, we have the relation $\\frac{\\hbar^{2}}{4m} = \\frac{3\\lambda}{2\\alpha_{\\mathrm{min}}^{3}}$. Multiplying by $\\alpha_{\\mathrm{min}}$ gives $\\frac{\\hbar^{2}\\alpha_{\\mathrm{min}}}{4m} = \\frac{3\\lambda}{2\\alpha_{\\mathrm{min}}^{2}}$. This shows that at the minimum, $\\langle T \\rangle = 2\\langle V \\rangle$, which is consistent with the virial theorem for a potential $V(x) \\propto x^{n}$ where $2\\langle T \\rangle = n\\langle V \\rangle$ with $n=4$.\nWe can express $E_{\\mathrm{var}}$ using only one of the terms. For instance, $E_{\\mathrm{var}} = \\langle T \\rangle + \\frac{1}{2}\\langle T \\rangle = \\frac{3}{2}\\langle T \\rangle$.\n$$\nE_{\\mathrm{var}} = \\frac{3}{2} \\left( \\frac{\\hbar^{2}\\alpha_{\\mathrm{min}}}{4m} \\right) = \\frac{3\\hbar^{2}}{8m} \\alpha_{\\mathrm{min}}\n$$\nSubstituting the expression for $\\alpha_{\\mathrm{min}}$:\n$$\nE_{\\mathrm{var}} = \\frac{3\\hbar^{2}}{8m} \\left(\\frac{6m\\lambda}{\\hbar^{2}}\\right)^{1/3} = \\frac{3\\hbar^{2}}{8m} \\frac{(6m\\lambda)^{1/3}}{(\\hbar^{2})^{1/3}}\n$$\n$$\nE_{\\mathrm{var}} = \\frac{3 \\cdot 6^{1/3}}{8} \\hbar^{2-2/3} m^{-1+1/3} \\lambda^{1/3} = \\frac{3 \\cdot 6^{1/3}}{8} \\hbar^{4/3} m^{-2/3} \\lambda^{1/3}\n$$\nThis expression can be rewritten to group the parameters:\n$$\nE_{\\mathrm{var}}(\\lambda,m,\\hbar) = \\frac{3 \\cdot 6^{1/3}}{8} \\left( \\frac{\\lambda \\hbar^{4}}{m^{2}} \\right)^{1/3}\n$$\n\n**5. Scaling Analysis of the Exact Energy**\nStarting from the Schrödinger equation:\n$$\n-\\frac{\\hbar^{2}}{2m}\\frac{d^{2}\\psi}{dx^{2}} + \\lambda x^{4} \\psi = E\\psi\n$$\nLet's introduce a dimensionless coordinate $u = x/x_{0}$ for some characteristic length $x_{0}$. Then $x=ux_{0}$ and $\\frac{d^{2}}{dx^{2}} = \\frac{1}{x_{0}^{2}}\\frac{d^{2}}{du^{2}}$. The equation in terms of $u$ becomes:\n$$\n-\\frac{\\hbar^{2}}{2mx_{0}^{2}}\\frac{d^{2}\\psi}{du^{2}} + \\lambda (ux_{0})^{4} \\psi = E\\psi\n$$\nTo make the equation dimensionless, we multiply by $\\frac{2mx_{0}^{2}}{\\hbar^{2}}$:\n$$\n-\\frac{d^{2}\\psi}{du^{2}} + \\frac{2m\\lambda x_{0}^{6}}{\\hbar^{2}} u^{4} \\psi = \\frac{2mEx_{0}^{2}}{\\hbar^{2}} \\psi\n$$\nWe choose $x_{0}$ such that the coefficient of the potential term is $1$:\n$$\n\\frac{2m\\lambda x_{0}^{6}}{\\hbar^{2}} = 1 \\implies x_{0}^{6} = \\frac{\\hbar^{2}}{2m\\lambda} \\implies x_{0} = \\left(\\frac{\\hbar^{2}}{2m\\lambda}\\right)^{1/6}\n$$\nThe equation then takes the form of a dimensionless eigenvalue problem:\n$$\n\\left(-\\frac{d^{2}}{du^{2}} + u^{4}\\right) \\psi = \\mathcal{E}\\psi\n$$\nwhere $\\mathcal{E} = \\frac{2mEx_{0}^{2}}{\\hbar^{2}}$ is a dimensionless energy eigenvalue. The ground state will correspond to the lowest eigenvalue $\\mathcal{E}_{0}$, which is a pure number. The physical energy $E$ is related to $\\mathcal{E}$ by:\n$$\nE = \\mathcal{E} \\frac{\\hbar^{2}}{2mx_{0}^{2}}\n$$\nSubstituting $x_{0}^{2} = \\left(\\frac{\\hbar^{2}}{2m\\lambda}\\right)^{1/3}$:\n$$\nE = \\mathcal{E} \\frac{\\hbar^{2}}{2m} \\left(\\frac{\\hbar^{2}}{2m\\lambda}\\right)^{-1/3} = \\mathcal{E} \\frac{\\hbar^{2}}{2m} \\left(\\frac{2m\\lambda}{\\hbar^{2}}\\right)^{1/3} = \\mathcal{E} \\frac{\\hbar^{2}}{2m} \\frac{(2m\\lambda)^{1/3}}{(\\hbar^{2})^{1/3}}\n$$\n$$\nE = \\left(\\frac{\\mathcal{E} \\cdot 2^{1/3}}{2}\\right) \\hbar^{4/3} m^{-2/3} \\lambda^{1/3}\n$$\nThe exact energy $E$ must therefore scale with the parameters as $E \\propto \\hbar^{4/3} m^{-2/3} \\lambda^{1/3}$, or equivalently $E \\propto \\left( \\frac{\\lambda \\hbar^{4}}{m^{2}} \\right)^{1/3}$.\n\n**Comparison and Conclusion**\nThe variational upper bound $E_{\\mathrm{var}} \\propto \\left( \\frac{\\lambda \\hbar^{4}}{m^{2}} \\right)^{1/3}$ has the exact same scaling dependence on $\\lambda, m, \\hbar$ as the true ground-state energy. This indicates that the Gaussian trial wavefunction, while not the exact solution, captures the correct fundamental scaling properties of the system. The difference between the variational energy and the exact energy lies only in the numerical prefactor.\nThe problem requests the closed-form analytic expression for the optimized variational upper bound $E_{\\mathrm{var}}(\\lambda,m,\\hbar)$.", "answer": "$$\n\\boxed{\\frac{3 \\cdot 6^{1/3}}{8} \\left( \\frac{\\lambda \\hbar^{4}}{m^{2}} \\right)^{1/3}}\n$$", "id": "2922377"}, {"introduction": "To fully bridge the gap between theory and application, we must translate the Schrödinger equation into a language that computers can understand. This practice [@problem_id:2922376] involves one of the most direct ways to do so: the finite-difference method, which converts the differential equation $\\hat{H}\\psi = E\\psi$ into a matrix eigenvalue problem. By implementing a numerical solver for simple potentials, you will gain firsthand insight into the core of computational quantum mechanics and explore the fundamental relationship between discretization error and the accuracy of calculated energies and wavefunctions.", "problem": "Consider the one-dimensional time-independent Schrödinger equation (TISE) for a single particle of mass $m$ in a potential $V(x)$, written in dimensionless units where $\\hbar = 1$ and $m = 1$. You will formulate the TISE as a finite-difference eigenvalue problem on a uniform grid with Dirichlet boundary conditions and analyze how the grid spacing affects the accuracy of stationary energies and wavefunctions.\n\nFundamental basis to use:\n- The definition of stationary states as solutions of the TISE $H \\psi(x) = E \\psi(x)$, where $H = -\\frac{1}{2}\\frac{d^2}{dx^2} + V(x)$.\n- The central difference approximation for the second derivative on a uniform grid.\n- Standard Dirichlet boundary conditions for bound states or infinite walls, $\\psi(a) = 0$ and $\\psi(b) = 0$.\n- The notion that central differences introduce a truncation error that scales with the square of the grid spacing.\n- Use of the $L^2$ inner product to assess wavefunction accuracy.\n\nYour tasks:\n1. Starting from the TISE and the central difference approximation of the second derivative on a uniform grid with spacing $h$, derive the discrete matrix eigenvalue problem for the Hamiltonian operator with Dirichlet boundary conditions on a finite interval $[a,b]$. Do not assume any pre-derived finite-difference stencil or matrix form; instead, deduce it from first principles as listed above.\n2. Implement a program that constructs the discrete Hamiltonian on the interior grid points, computes the lowest $k$ stationary energies and wavefunctions, and compares them against exact reference solutions for specified test potentials. Use the following principles in your implementation:\n   - Use a uniform grid with interior point count $M$, so the grid spacing is $h = \\frac{b-a}{M+1}$ and the interior points are $x_i = a + i h$ for $i = 1, \\dots, M$.\n   - Enforce Dirichlet boundary conditions at $x=a$ and $x=b$.\n   - Compute the $k$ lowest eigenvalues and corresponding eigenvectors of the discrete Hamiltonian.\n   - For each state index $n$ in $\\{0,1,\\dots,k-1\\}$, compute the relative energy error $\\left|\\frac{E_n^{\\mathrm{num}} - E_n^{\\mathrm{exact}}}{E_n^{\\mathrm{exact}}}\\right|$ and the wavefunction infidelity $1 - \\left|\\langle \\psi_n^{\\mathrm{num}}, \\psi_n^{\\mathrm{exact}} \\rangle_h \\right|$, where $\\langle f,g \\rangle_h = \\sum_{i=1}^{M} f(x_i) g(x_i)\\, h$ is the discrete $L^2$ inner product. Make sure to normalize both the numerical and the exact wavefunctions with respect to this discrete inner product before evaluating overlaps. Handle the arbitrary sign of eigenvectors by taking the absolute value of the overlap.\n3. Analyze how the grid spacing $h$ affects the computed stationary energies and wavefunctions by reporting the worst-case errors across the first $k$ states for each test case.\n\nPotentials and exact reference data:\n- Harmonic oscillator with angular frequency $\\omega$: $V(x) = \\tfrac{1}{2} \\omega^2 x^2$, exact energies $E_n^{\\mathrm{exact}} = \\left(n + \\tfrac{1}{2}\\right)\\omega$, and exact eigenfunctions $\\psi_n^{\\mathrm{exact}}(x) = \\frac{1}{\\sqrt{2^n n!}} \\left(\\frac{\\omega}{\\pi}\\right)^{1/4} H_n\\!\\left(\\sqrt{\\omega}\\, x\\right) \\exp\\!\\left(-\\tfrac{1}{2}\\omega x^2\\right)$, where $H_n$ are the physicists' Hermite polynomials and $n \\in \\{0,1,2,\\dots\\}$.\n- Infinite square well on $[0,L]$: $V(x) = 0$ for $x \\in (0,L)$ and $V(x) = +\\infty$ outside, exact energies $E_n^{\\mathrm{exact}} = \\frac{\\pi^2 n^2}{2 L^2}$ for $n \\in \\{1,2,3,\\dots\\}$, and exact eigenfunctions $\\psi_n^{\\mathrm{exact}}(x) = \\sqrt{\\frac{2}{L}} \\sin\\!\\left(\\frac{n\\pi x}{L}\\right)$ on $(0,L)$ with $\\psi_n^{\\mathrm{exact}}(0)=\\psi_n^{\\mathrm{exact}}(L)=0$. For comparison with the discrete results, match the $n$-th numerical state to the corresponding $n$-th exact state by index.\n\nUnits:\n- Work entirely in the specified dimensionless units with $\\hbar = 1$ and $m = 1$. Report energies and errors as dimensionless numbers.\n\nTest suite:\nUse $k = 3$ for all cases. For each case, compute the maximum relative energy error across the first $k$ states and the worst-case wavefunction infidelity across the first $k$ states, and output these two floats in this order.\n- Case $1$ (harmonic oscillator, coarse grid): $\\omega = 1$, $a = -8$, $b = 8$, $M = 41$.\n- Case $2$ (harmonic oscillator, moderate grid): $\\omega = 1$, $a = -8$, $b = 8$, $M = 201$.\n- Case $3$ (harmonic oscillator, fine grid): $\\omega = 1$, $a = -8$, $b = 8$, $M = 801$.\n- Case $4$ (infinite square well, moderate grid): $L = 1$, $a = 0$, $b = L$, $M = 51$.\n- Case $5$ (infinite square well, coarse grid): $L = 1$, $a = 0$, $b = L$, $M = 11$.\n\nAnswer specification:\n- For each of the $5$ test cases, compute:\n  - The maximum relative energy error over the first $k=3$ states, defined as $\\max_{0 \\le n \\le 2} \\left|\\frac{E_n^{\\mathrm{num}} - E_n^{\\mathrm{exact}}}{E_n^{\\mathrm{exact}}}\\right|$ for the harmonic oscillator, and $\\max_{1 \\le n \\le 3} \\left|\\frac{E_n^{\\mathrm{num}} - E_n^{\\mathrm{exact}}}{E_n^{\\mathrm{exact}}}\\right|$ for the infinite well (note the indexing shift).\n  - The worst-case wavefunction infidelity over the same states, defined as $\\max \\left(1 - \\left|\\langle \\psi_n^{\\mathrm{num}}, \\psi_n^{\\mathrm{exact}} \\rangle_h \\right|\\right)$ with both functions normalized in the discrete $L^2$ norm.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. The list must contain $10$ floats in the following order: for Case $1$, the two floats (energy error, wavefunction infidelity), then for Case $2$, the two floats, and so on through Case $5$. For example, an output with placeholder values would look like $[e_1,w_1,e_2,w_2,e_3,w_3,e_4,w_4,e_5,w_5]$.\n\nYour implementation must be a complete, runnable program that builds the finite-difference Hamiltonian from first principles as described, computes the required quantities, and prints the final result line exactly in the specified format.", "solution": "The problem R-891-B submitted for evaluation is valid. It is scientifically sound, well-posed, and all necessary data and conditions for a unique solution are provided. The problem is a standard exercise in computational quantum physics, specifically the numerical solution of the one-dimensional time-independent Schrödinger equation using the finite-difference method. I will proceed with the derivation and computational solution as requested.\n\n### 1. Derivation of the Discrete Hamiltonian Matrix\n\nThe starting point is the one-dimensional time-independent Schrödinger equation (TISE) in dimensionless units ($\\hbar = 1, m = 1$):\n$$\nH \\psi(x) = E \\psi(x)\n$$\nwhere the Hamiltonian operator $H$ is given by\n$$\nH = -\\frac{1}{2}\\frac{d^2}{dx^2} + V(x)\n$$\nWe discretize the spatial domain $[a, b]$ into a uniform grid. Let there be $M$ interior grid points. The total number of intervals is $M+1$. The grid spacing is $h = \\frac{b-a}{M+1}$. The grid points are $x_i = a + i h$ for $i = 0, 1, \\dots, M+1$. The interior points are $\\{x_1, \\dots, x_M\\}$. The wavefunction values at these points are denoted by $\\psi_i = \\psi(x_i)$.\n\nThe Dirichlet boundary conditions dictate that the wavefunction vanishes at the boundaries of the domain:\n$$\n\\psi(a) = \\psi(x_0) = \\psi_0 = 0\n$$\n$$\n\\psi(b) = \\psi(x_{M+1}) = \\psi_{M+1} = 0\n$$\nThe second derivative of the wavefunction, $\\frac{d^2\\psi}{dx^2}$, is approximated at an interior grid point $x_i$ using the central difference formula, which has a truncation error of order $O(h^2)$:\n$$\n\\frac{d^2\\psi}{dx^2}\\bigg|_{x=x_i} \\approx \\frac{\\psi(x_i+h) - 2\\psi(x_i) + \\psi(x_i-h)}{h^2} = \\frac{\\psi_{i+1} - 2\\psi_i + \\psi_{i-1}}{h^2}\n$$\nSubstituting this approximation into the TISE, we obtain a discrete equation for each interior point $x_i$, where $i = 1, \\dots, M$:\n$$\n-\\frac{1}{2} \\left( \\frac{\\psi_{i+1} - 2\\psi_i + \\psi_{i-1}}{h^2} \\right) + V(x_i)\\psi_i = E\\psi_i\n$$\nRearranging the terms to group the $\\psi_j$ components yields:\n$$\n-\\frac{1}{2h^2}\\psi_{i-1} + \\left( \\frac{1}{h^2} + V(x_i) \\right) \\psi_i - \\frac{1}{2h^2}\\psi_{i+1} = E\\psi_i\n$$\nThis represents a system of $M$ coupled linear algebraic equations for the unknown wavefunction values $\\{\\psi_1, \\dots, \\psi_M\\}$. This system can be written in matrix form as an eigenvalue problem:\n$$\n\\mathbf{H} \\vec{\\psi} = E \\vec{\\psi}\n$$\nwhere $\\vec{\\psi} = [\\psi_1, \\psi_2, \\dots, \\psi_M]^T$ is a column vector of the wavefunction values at the interior grid points, and $\\mathbf{H}$ is the $M \\times M$ discrete Hamiltonian matrix.\n\nThe matrix elements $H_{ij}$ are determined by considering the equations for each $i$:\n- For $i=1$: $-\\frac{1}{2h^2}\\psi_0 + \\left(\\frac{1}{h^2} + V_1\\right)\\psi_1 - \\frac{1}{2h^2}\\psi_2 = E\\psi_1$. Since $\\psi_0=0$, this becomes $\\left(\\frac{1}{h^2} + V_1\\right)\\psi_1 - \\frac{1}{2h^2}\\psi_2 = E\\psi_1$.\n- For $1 < i < M$: $-\\frac{1}{2h^2}\\psi_{i-1} + \\left(\\frac{1}{h^2} + V_i\\right)\\psi_i - \\frac{1}{2h^2}\\psi_{i+1} = E\\psi_i$.\n- For $i=M$: $-\\frac{1}{2h^2}\\psi_{M-1} + \\left(\\frac{1}{h^2} + V_M\\right)\\psi_M - \\frac{1}{2h^2}\\psi_{M+1} = E\\psi_M$. Since $\\psi_{M+1}=0$, this becomes $-\\frac{1}{2h^2}\\psi_{M-1} + \\left(\\frac{1}{h^2} + V_M\\right)\\psi_M = E\\psi_M$.\n\nFrom these equations, we can construct the Hamiltonian matrix $\\mathbf{H}$. It is a real, symmetric, tridiagonal matrix with the following elements:\n- Diagonal elements: $H_{ii} = \\frac{1}{h^2} + V(x_i)$ for $i = 1, \\dots, M$.\n- Off-diagonal elements (sub- and super-diagonal): $H_{i,i+1} = H_{i+1,i} = -\\frac{1}{2h^2}$ for $i=1, \\dots, M-1$.\n- All other elements are zero.\n\nThis completes the derivation of the discrete matrix eigenvalue problem.\n\n### 2. Numerical Implementation and Analysis\n\nThe numerical solution proceeds as follows:\n1.  **Construct the Hamiltonian Matrix**: For each test case, the grid parameters ($a, b, M$) and potential $V(x)$ are used to construct the $M \\times M$ matrix $\\mathbf{H}$ as derived above.\n2.  **Solve the Eigenvalue Problem**: The eigenvalues (stationary energies $E_n^{\\mathrm{num}}$) and eigenvectors (discretized wavefunctions $\\vec{\\psi}_n^{\\mathrm{num}}$) of the real symmetric matrix $\\mathbf{H}$ are computed. We use a numerical library routine optimized for this purpose, which provides the eigenvalues in ascending order and the corresponding orthonormal eigenvectors. We select the lowest $k=3$ solutions. The eigenvectors produced by standard eigensolvers are typically normalized with respect to the Euclidean norm, e.g., $\\sum_{i=1}^M (\\psi_{n,i}^{\\mathrm{num}})^2 = 1$.\n3.  **Compute Exact Solutions**: For each numerical state $n$, the corresponding exact energy $E_n^{\\mathrm{exact}}$ and exact wavefunction $\\psi_n^{\\mathrm{exact}}(x)$ are calculated based on the analytical formulas provided for the harmonic oscillator and the infinite square well. For the infinite well, the numerical states $n=0, 1, 2$ correspond to the exact states with quantum numbers $n=1, 2, 3$.\n4.  **Discretize and Normalize Wavefunctions**:\n    -   The exact wavefunction $\\psi_n^{\\mathrm{exact}}(x)$ is evaluated on the interior grid points $\\{x_i\\}$ to form a vector $\\vec{\\phi}_n^{\\mathrm{exact}}$.\n    -   Both the numerical eigenvector $\\vec{\\psi}_n^{\\mathrm{num}}$ and the exact wavefunction vector $\\vec{\\phi}_n^{\\mathrm{exact}}$ must be normalized with respect to the discrete $L^2$ inner product, defined as $\\langle f,g \\rangle_h = \\sum_{i=1}^{M} f(x_i) g(x_i)\\, h$. A vector $\\vec{f}$ is normalized if $\\langle f,f \\rangle_h = 1$.\n    -   The numerical eigenvector $\\vec{\\psi}_n^{\\mathrm{num}}$ from the eigensolver (with Euclidean norm $1$) is normalized by dividing by $\\sqrt{h}$. Let this be $\\tilde{\\psi}_n^{\\mathrm{num}}$.\n    -   The exact wavefunction vector $\\vec{\\phi}_n^{\\mathrm{exact}}$ is normalized by dividing by its discrete norm, $N_{\\mathrm{exact}} = \\sqrt{\\langle \\phi_n^{\\mathrm{exact}}, \\phi_n^{\\mathrm{exact}} \\rangle_h}$. Let this be $\\tilde{\\psi}_n^{\\mathrm{exact}}$.\n5.  **Calculate Errors**: For each of the $k=3$ lowest states:\n    -   **Relative Energy Error**: $\\epsilon_E(n) = \\left|\\frac{E_n^{\\mathrm{num}} - E_n^{\\mathrm{exact}}}{E_n^{\\mathrm{exact}}}\\right|$.\n    -   **Wavefunction Infidelity**: The overlap is computed as $C_n = \\langle \\tilde{\\psi}_n^{\\mathrm{num}}, \\tilde{\\psi}_n^{\\mathrm{exact}} \\rangle_h$. The infidelity is $\\epsilon_\\psi(n) = 1 - |C_n|$. The absolute value is taken to account for the arbitrary sign of eigenvectors.\n6.  **Report Worst-Case Errors**: For each test case, the maximum relative energy error $\\max_{n} \\epsilon_E(n)$ and the maximum wavefunction infidelity $\\max_{n} \\epsilon_\\psi(n)$ over the first $k=3$ states are computed and reported. This process is repeated for all five test cases. The results are aggregated into a single list for the final output.", "answer": "```python\nimport numpy as np\nfrom scipy.linalg import eigh\nfrom scipy.special import hermite, factorial\n\ndef solve():\n    \"\"\"\n    Solves the 1D TISE for given potentials using the finite difference method\n    and computes errors against exact solutions.\n    \"\"\"\n\n    test_cases = [\n        # Case 1: Harmonic oscillator, coarse grid\n        {'type': 'ho', 'omega': 1.0, 'a': -8.0, 'b': 8.0, 'M': 41, 'k': 3},\n        # Case 2: Harmonic oscillator, moderate grid\n        {'type': 'ho', 'omega': 1.0, 'a': -8.0, 'b': 8.0, 'M': 201, 'k': 3},\n        # Case 3: Harmonic oscillator, fine grid\n        {'type': 'ho', 'omega': 1.0, 'a': -8.0, 'b': 8.0, 'M': 801, 'k': 3},\n        # Case 4: Infinite square well, moderate grid\n        {'type': 'isw', 'L': 1.0, 'a': 0.0, 'b': 1.0, 'M': 51, 'k': 3},\n        # Case 5: Infinite square well, coarse grid\n        {'type': 'isw', 'L': 1.0, 'a': 0.0, 'b': 1.0, 'M': 11, 'k': 3},\n    ]\n\n    all_results = []\n    for case in test_cases:\n        max_energy_error, max_wf_infidelity = compute_errors(case)\n        all_results.extend([max_energy_error, max_wf_infidelity])\n\n    print(f\"[{','.join(f'{x:.7e}' for x in all_results)}]\")\n\ndef compute_errors(params):\n    \"\"\"\n    Computes max energy error and wavefunction infidelity for a single test case.\n    \"\"\"\n    potential_type = params['type']\n    a, b, M, k = params['a'], params['b'], params['M'], params['k']\n\n    # 1. Set up the grid\n    h = (b - a) / (M + 1)\n    x = np.linspace(a + h, b - h, M)\n\n    # 2. Define the potential\n    if potential_type == 'ho':\n        omega = params['omega']\n        V = 0.5 * omega**2 * x**2\n    elif potential_type == 'isw':\n        V = np.zeros(M)\n    else:\n        raise ValueError(\"Unknown potential type\")\n\n    # 3. Construct the Hamiltonian matrix\n    T_diag = np.ones(M) / h**2\n    T_offdiag = -1.0 / (2.0 * h**2) * np.ones(M - 1)\n    \n    H = np.diag(T_diag + V) + np.diag(T_offdiag, k=1) + np.diag(T_offdiag, k=-1)\n\n    # 4. Solve the eigenvalue problem\n    # eigh returns eigenvalues in ascending order and corresponding eigenvectors\n    eigenvalues, eigenvectors = eigh(H)\n    \n    # Select the lowest k states\n    num_energies = eigenvalues[:k]\n    num_wavefunctions = eigenvectors[:, :k]\n\n    energy_errors = []\n    wf_infidelities = []\n\n    for n_idx in range(k):\n        # 5. Get numerical solution\n        E_num = num_energies[n_idx]\n        psi_num_unnormalized = num_wavefunctions[:, n_idx]\n\n        # 6. Get exact solution\n        if potential_type == 'ho':\n            n = n_idx\n            omega = params['omega']\n            E_exact = (n + 0.5) * omega\n\n            # Physicists' Hermite polynomials\n            Hn_poly = hermite(n)\n            # Normalization constant for continuous L2 norm on (-inf, inf)\n            norm_const = 1.0 / np.sqrt(2**n * factorial(n)) * (omega / np.pi)**0.25\n            psi_exact_on_grid = norm_const * Hn_poly(np.sqrt(omega) * x) * np.exp(-0.5 * omega * x**2)\n        \n        elif potential_type == 'isw':\n            n = n_idx + 1 # Physical quantum number n=1,2,3...\n            L = params['L']\n            E_exact = (n**2 * np.pi**2) / (2 * L**2)\n            \n            # Normalization constant for continuous L2 norm on [0, L]\n            norm_const = np.sqrt(2.0 / L)\n            psi_exact_on_grid = norm_const * np.sin(n * np.pi * x / L)\n\n        # 7. Normalize wavefunctions using the discrete L2 inner product\n        # The inner product is defined as <f|g>_h = sum(f*g*h)\n        \n        # Eigenvectors from eigh are normalized to sum(psi^2) = 1.\n        # We need sum(psi^2 * h) = 1, so we must divide by sqrt(h).\n        psi_num_norm = psi_num_unnormalized / np.sqrt(h)\n\n        # Normalize the exact wavefunction on the grid\n        norm_sq_exact = np.sum(psi_exact_on_grid**2) * h\n        psi_exact_norm = psi_exact_on_grid / np.sqrt(norm_sq_exact)\n\n        # 8. Calculate errors\n        # Relative energy error\n        rel_energy_error = np.abs((E_num - E_exact) / E_exact)\n        energy_errors.append(rel_energy_error)\n\n        # Wavefunction infidelity: 1 - |<psi_num, psi_exact>_h|\n        # The overlap includes the factor of h from the inner product definition.\n        overlap = np.sum(psi_num_norm * psi_exact_norm) * h\n        infidelity = 1.0 - np.abs(overlap)\n        wf_infidelities.append(infidelity)\n\n    return np.max(energy_errors), np.max(wf_infidelities)\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "2922376"}]}