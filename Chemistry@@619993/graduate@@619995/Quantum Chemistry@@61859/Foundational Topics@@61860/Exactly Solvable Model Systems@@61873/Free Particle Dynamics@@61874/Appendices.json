{"hands_on_practices": [{"introduction": "The spreading of a wavepacket is a canonical illustration of quantum dynamics, distinct from the deterministic trajectory of a classical particle. This first practice invites you to derive this behavior from first principles for a one-dimensional Gaussian wavepacket. By using the elegant Heisenberg picture, you will uncover the time evolution of uncertainty and analyze how the characteristic time for quantum spreading depends on fundamental parameters like mass and initial localization, providing deep insight into the correspondence principle [@problem_id:2892591].", "problem": "A one-dimensional free particle of mass $m$ is prepared at time $t=0$ in the normalized Gaussian wavepacket\n$$\n\\psi(x,0)=\\left(\\frac{1}{2\\pi\\sigma^{2}}\\right)^{1/4}\\exp\\!\\left[-\\frac{(x-x_{0})^{2}}{4\\sigma^{2}}+\\frac{i p_{0} x}{\\hbar}\\right],\n$$\nwhere $\\sigma>0$ is a real width parameter, $x_{0}\\in\\mathbb{R}$ is the initial mean position, $p_{0}\\in\\mathbb{R}$ is the initial mean momentum, and $\\hbar$ is the reduced Planck constant. The particle evolves under the time-dependent Schrödinger equation for a free particle with Hamiltonian $\\hat{H}=\\hat{p}^{2}/(2m)$, and the canonical commutation relation $[\\hat{x},\\hat{p}]=i\\hbar$ holds.\n\nStarting only from these fundamentals, derive the time dependence of the position variance $\\operatorname{Var}[x](t)$ and determine the first positive time $t_{s}$ at which the spatial variance has doubled relative to its initial value at $t=0$. Express your final answer for $t_{s}$ as a closed-form expression in terms of $m$, $\\sigma$, and $\\hbar$. Then, based on your derived expression, briefly discuss how $t_{s}$ depends on $m$, $\\sigma$, and $\\hbar$, and explain the behavior in the classical limit $m\\to\\infty$.\n\nYour final reported answer must be the single analytic expression for $t_{s}$ only.", "solution": "The problem will first be subjected to a rigorous validation procedure before any attempt at a solution is made.\n\nProblem Validation\n\nStep 1: Extract Givens\nThe problem provides the following information verbatim:\n- A one-dimensional free particle of mass $m$.\n- Initial state at time $t=0$: A normalized Gaussian wavepacket $\\psi(x,0)=\\left(\\frac{1}{2\\pi\\sigma^{2}}\\right)^{1/4}\\exp\\!\\left[-\\frac{(x-x_{0})^{2}}{4\\sigma^{2}}+\\frac{i p_{0} x}{\\hbar}\\right]$.\n- Parameters: $\\sigma>0$ is a real width parameter, $x_{0}\\in\\mathbb{R}$ is the initial mean position, $p_{0}\\in\\mathbb{R}$ is the initial mean momentum, and $\\hbar$ is the reduced Planck constant.\n- Dynamics: The particle evolves under the time-dependent Schrödinger equation for a free particle.\n- Hamiltonian: $\\hat{H}=\\hat{p}^{2}/(2m)$.\n- Commutation relation: $[\\hat{x},\\hat{p}]=i\\hbar$.\n- Objective: Derive the time dependence of the position variance $\\operatorname{Var}[x](t)$.\n- Objective: Determine the first positive time $t_{s}$ at which the spatial variance has doubled relative to its initial value, $\\operatorname{Var}[x](t_{s})=2\\operatorname{Var}[x](0)$.\n- Objective: Express the final answer for $t_{s}$ as a closed-form expression in terms of $m$, $\\sigma$, and $\\hbar$.\n- Objective: Discuss the dependence of $t_{s}$ on the parameters and its behavior in the classical limit.\n\nStep 2: Validate Using Extracted Givens\nThe problem is examined against the required criteria.\n- **Scientifically Grounded**: The problem is a canonical exercise in quantum mechanics concerning the dynamics of a Gaussian wavepacket for a free particle. All principles, equations, and definitions—the Schrödinger equation, the free-particle Hamiltonian, the canonical commutation relation, and the form of the Gaussian wavepacket—are standard and fundamentally correct.\n- **Well-Posed**: The problem is well-posed. The initial state is specified, the governing equation of motion is provided, and the quantity to be calculated is clearly defined. A unique and stable solution is expected to exist.\n- **Objective**: The problem is stated in precise, objective mathematical language, free from ambiguity or subjective content.\n- **Flaw Analysis**: The problem statement contains a minor inconsistency where it requests the answer to be expressed \"in seconds\" while providing no numerical values, but this is immediately superseded by the instruction to provide a \"closed-form expression\" and the global rule that the final answer must be a single analytic expression. This minor flaw does not render the problem invalid; it merely requires a correct interpretation in favor of the more specific and dominant instruction. The problem is otherwise self-contained, consistent, and scientifically sound.\n\nStep 3: Verdict and Action\nThe problem is **valid**. A solution will be derived.\n\nSolution\nThe most direct method to find the time evolution of the variance is to use the Heisenberg picture, which describes the time evolution of operators. The variance of the position operator $\\hat{x}$ at time $t$ is given by $\\operatorname{Var}[x](t) = \\langle \\hat{x}(t)^2 \\rangle - \\langle \\hat{x}(t) \\rangle^2$, where the expectation values are taken with respect to the initial state $\\psi(x,0)$.\n\nThe Heisenberg equation of motion for an operator $\\hat{A}(t)$ is $\\frac{d\\hat{A}(t)}{dt} = \\frac{1}{i\\hbar}[\\hat{A}(t), \\hat{H}]$. The Hamiltonian for the free particle is $\\hat{H} = \\frac{\\hat{p}^2}{2m}$.\n\nFirst, we determine the time evolution of the position operator $\\hat{x}(t)$ and momentum operator $\\hat{p}(t)$. At $t=0$, we have $\\hat{x}(0) = \\hat{x}$ and $\\hat{p}(0) = \\hat{p}$.\nFor the momentum operator:\n$$ \\frac{d\\hat{p}(t)}{dt} = \\frac{1}{i\\hbar}[\\hat{p}, \\frac{\\hat{p}^2}{2m}] = 0 $$\nThus, the momentum operator is a constant of motion: $\\hat{p}(t) = \\hat{p}(0) = \\hat{p}$.\n\nFor the position operator:\n$$ \\frac{d\\hat{x}(t)}{dt} = \\frac{1}{i\\hbar}[\\hat{x}, \\frac{\\hat{p}^2}{2m}] = \\frac{1}{2mi\\hbar}([\\hat{x},\\hat{p}]\\hat{p} + \\hat{p}[\\hat{x},\\hat{p}]) = \\frac{1}{2mi\\hbar}(i\\hbar\\hat{p} + \\hat{p}i\\hbar) = \\frac{\\hat{p}}{m} $$\nIntegrating with respect to time yields:\n$$ \\hat{x}(t) = \\hat{x}(0) + \\frac{\\hat{p}(0)}{m}t = \\hat{x} + \\frac{\\hat{p}}{m}t $$\n\nNext, we calculate the expectation values with respect to the initial state $\\psi(x,0)$. The probability density at $t=0$ is:\n$$ |\\psi(x,0)|^2 = \\left(\\frac{1}{2\\pi\\sigma^2}\\right)^{1/2} \\exp\\left[-\\frac{(x-x_0)^2}{2\\sigma^2}\\right] $$\nThis is a normal distribution with mean $x_0$ and variance $\\sigma^2$.\nBy inspection and symmetry arguments, the expectation values of position and momentum at $t=0$ are:\n$$ \\langle \\hat{x} \\rangle_0 = x_0 $$\n$$ \\langle \\hat{p} \\rangle_0 = p_0 $$\nThe variance of position at $t=0$ is given directly by the parameter $\\sigma$:\n$$ \\operatorname{Var}[x](0) = (\\Delta x)_0^2 = \\langle (\\hat{x} - \\langle \\hat{x} \\rangle_0)^2 \\rangle_0 = \\sigma^2 $$\nThe initial state is a minimum-uncertainty Gaussian wavepacket, so it satisfies the condition $(\\Delta x)_0 (\\Delta p)_0 = \\hbar/2$. From this, we find the initial momentum variance:\n$$ (\\Delta p)_0^2 = \\frac{\\hbar^2}{4(\\Delta x)_0^2} = \\frac{\\hbar^2}{4\\sigma^2} $$\n\nNow, we find the time-dependent expectation values.\nThe mean position is:\n$$ \\langle \\hat{x} \\rangle(t) = \\langle \\hat{x}(t) \\rangle_0 = \\left\\langle \\hat{x} + \\frac{\\hat{p}}{m}t \\right\\rangle_0 = \\langle \\hat{x} \\rangle_0 + \\frac{\\langle \\hat{p} \\rangle_0}{m}t = x_0 + \\frac{p_0}{m}t $$\nThis describes the classical trajectory of the center of the wavepacket.\n\nThe expectation value of the squared position operator is:\n$$ \\langle \\hat{x}^2 \\rangle(t) = \\langle \\hat{x}(t)^2 \\rangle_0 = \\left\\langle \\left(\\hat{x} + \\frac{\\hat{p}}{m}t\\right)^2 \\right\\rangle_0 = \\left\\langle \\hat{x}^2 + \\frac{t}{m}(\\hat{x}\\hat{p}+\\hat{p}\\hat{x}) + \\frac{t^2}{m^2}\\hat{p}^2 \\right\\rangle_0 $$\n$$ \\langle \\hat{x}^2 \\rangle(t) = \\langle \\hat{x}^2 \\rangle_0 + \\frac{t}{m}\\langle \\hat{x}\\hat{p}+\\hat{p}\\hat{x} \\rangle_0 + \\frac{t^2}{m^2}\\langle \\hat{p}^2 \\rangle_0 $$\nWe need the initial second moments $\\langle \\hat{x}^2 \\rangle_0$ and $\\langle \\hat{p}^2 \\rangle_0$.\n$$ \\langle \\hat{x}^2 \\rangle_0 = (\\Delta x)_0^2 + \\langle \\hat{x} \\rangle_0^2 = \\sigma^2 + x_0^2 $$\n$$ \\langle \\hat{p}^2 \\rangle_0 = (\\Delta p)_0^2 + \\langle \\hat{p} \\rangle_0^2 = \\frac{\\hbar^2}{4\\sigma^2} + p_0^2 $$\nThe correlation term is $\\langle \\hat{x}\\hat{p}+\\hat{p}\\hat{x} \\rangle_0$. Since $\\hat{x}\\hat{p}+\\hat{p}\\hat{x} = 2\\hat{x}\\hat{p} - [\\hat{x},\\hat{p}] = 2\\hat{x}\\hat{p} - i\\hbar$, its expectation value is $2\\langle \\hat{x}\\hat{p} \\rangle_0 - i\\hbar$. Also, $\\langle (\\hat{x}\\hat{p})^\\dagger \\rangle_0 = \\langle \\hat{p}\\hat{x} \\rangle_0 = \\langle \\hat{x}\\hat{p} \\rangle_0^*$. Thus $\\langle \\hat{x}\\hat{p}+\\hat{p}\\hat{x} \\rangle_0 = 2\\operatorname{Re}(\\langle \\hat{x}\\hat{p} \\rangle_0)$. A direct calculation shows $\\langle \\hat{x}\\hat{p} \\rangle_0 = x_0 p_0 + i\\hbar/2$. Therefore,\n$$ \\langle \\hat{x}\\hat{p}+\\hat{p}\\hat{x} \\rangle_0 = 2\\operatorname{Re}(x_0 p_0 + i\\hbar/2) = 2x_0 p_0 $$\nSubstituting these into the expression for $\\langle \\hat{x}^2 \\rangle(t)$:\n$$ \\langle \\hat{x}^2 \\rangle(t) = (\\sigma^2 + x_0^2) + \\frac{t}{m}(2x_0 p_0) + \\frac{t^2}{m^2}\\left(\\frac{\\hbar^2}{4\\sigma^2} + p_0^2\\right) $$\n$$ \\langle \\hat{x}^2 \\rangle(t) = \\sigma^2 + \\frac{\\hbar^2 t^2}{4m^2\\sigma^2} + \\left(x_0^2 + \\frac{2x_0 p_0}{m}t + \\frac{p_0^2 t^2}{m^2}\\right) $$\n\nNow we compute the variance $\\operatorname{Var}[x](t) = \\langle \\hat{x}^2 \\rangle(t) - (\\langle \\hat{x} \\rangle(t))^2$:\n$$ (\\langle \\hat{x} \\rangle(t))^2 = \\left(x_0 + \\frac{p_0}{m}t\\right)^2 = x_0^2 + \\frac{2x_0 p_0}{m}t + \\frac{p_0^2 t^2}{m^2} $$\nSubtracting this from $\\langle \\hat{x}^2 \\rangle(t)$:\n$$ \\operatorname{Var}[x](t) = \\left(\\sigma^2 + \\frac{\\hbar^2 t^2}{4m^2\\sigma^2} + x_0^2 + \\frac{2x_0 p_0}{m}t + \\frac{p_0^2 t^2}{m^2}\\right) - \\left(x_0^2 + \\frac{2x_0 p_0}{m}t + \\frac{p_0^2 t^2}{m^2}\\right) $$\n$$ \\operatorname{Var}[x](t) = \\sigma^2 + \\frac{\\hbar^2 t^2}{4m^2\\sigma^2} $$\nThis fundamental result shows that the variance of the wavepacket grows quadratically in time. The spreading is independent of the initial position $x_0$ and momentum $p_0$.\n\nThe problem asks for the time $t_s$ at which the variance has doubled from its initial value.\nThe initial variance is $\\operatorname{Var}[x](0) = \\sigma^2$.\nWe must solve the equation $\\operatorname{Var}[x](t_s) = 2\\operatorname{Var}[x](0)$:\n$$ \\sigma^2 + \\frac{\\hbar^2 t_s^2}{4m^2\\sigma^2} = 2\\sigma^2 $$\n$$ \\frac{\\hbar^2 t_s^2}{4m^2\\sigma^2} = \\sigma^2 $$\n$$ t_s^2 = \\frac{4m^2\\sigma^4}{\\hbar^2} $$\nTaking the positive root for the first positive time $t_s$:\n$$ t_s = \\frac{2m\\sigma^2}{\\hbar} $$\n\nDiscussion of the result:\nThe time $t_s$ for the packet's variance to double is a characteristic time for quantum spreading. Its dependence on the parameters is revealing:\n- $t_s \\propto m$: The spreading time is directly proportional to the mass. Heavier particles exhibit slower quantum spreading, which is consistent with the correspondence principle; massive objects behave more classically.\n- $t_s \\propto \\sigma^2$: The spreading time is proportional to the square of the initial width. A wavepacket that is initially very localized (small $\\sigma$) has a large momentum uncertainty $(\\Delta p \\sim \\hbar/\\sigma)$ due to the uncertainty principle. The diverse momentum components cause the packet to fly apart rapidly. Conversely, a wide initial packet (large $\\sigma$) has a small momentum uncertainty, so its components travel at nearly the same velocity, leading to very slow spreading.\n- $t_s \\propto 1/\\hbar$: The spreading time is inversely proportional to the reduced Planck constant. In the classical limit where $\\hbar \\to 0$, $t_s \\to \\infty$. This signifies that quantum spreading is a purely quantum mechanical effect that vanishes in classical mechanics. A classical distribution of particles would simply translate without any change in its intrinsic width.\n- In the limit $m \\to \\infty$, $t_s \\to \\infty$. This implies that an infinitely massive particle would not experience quantum spreading, reinforcing the classical limit behavior. Macroscopic objects have such large mass that their quantum spreading time is astronomically long and practically unobservable.", "answer": "$$\n\\boxed{\\frac{2m\\sigma^{2}}{\\hbar}}\n$$", "id": "2892591"}, {"introduction": "Having explored the unbounded dispersion of a truly free particle, we now investigate the profound impact of spatial confinement. This exercise presents a comparative analysis between a particle evolving on the real line and one trapped within an infinite potential well. By calculating the infinite-time average of the position variance, you will discover how boundary conditions lead to quantized energy levels and fundamentally different long-term dynamics, replacing monotonic spreading with recurrent, bounded motion [@problem_id:2892676].", "problem": "Consider a nonrelativistic spinless particle of mass $m$ in one spatial dimension. Two scenarios are to be analyzed from first principles.\n\nScenario A (confined): The particle is in an infinite square well of width $L$ with potential $V(x)=0$ for $0<x<L$ and $V(x)=+\\infty$ otherwise. At time $t=0$, the normalized state is a minimum-uncertainty Gaussian wave packet centered at the well midpoint $x=L/2$ with zero mean momentum and position variance $\\sigma^{2}$, where $0<\\sigma \\ll L$:\n$$\n\\psi(x,0)=\\left(\\frac{1}{2\\pi \\sigma^{2}}\\right)^{1/4}\\exp\\!\\left(-\\frac{(x-\\frac{L}{2})^{2}}{4\\sigma^{2}}\\right),\n$$\nunderstood to be restricted to $0<x<L$ (the tails outside are negligible for $\\sigma\\ll L$). Let $\\{|n\\rangle\\}$ denote the stationary eigenbasis of the Hamiltonian on $[0,L]$, and expand $\\psi(x,0)=\\sum_{n=1}^{\\infty} c_{n}\\,\\phi_{n}(x)$.\n\nScenario B (free): The same initial Gaussian evolves under the free-particle Hamiltonian on the entire real line $\\mathbb{R}$.\n\nTasks:\n- Starting from the time-independent Schrödinger equation with the boundary conditions appropriate to the infinite well, derive the normalized eigenfunctions $\\phi_{n}(x)$ and the corresponding energy eigenvalues $E_{n}$.\n- Using only fundamental principles (unitary time evolution and the definition of time averages), derive the infinite-time average of the position variance in the well,\n$$\n\\overline{\\operatorname{Var}}_{L}=\\lim_{T\\to\\infty}\\frac{1}{T}\\int_{0}^{T}\\Big(\\langle x^{2}\\rangle_{t}-\\langle x\\rangle_{t}^{2}\\Big)\\,dt,\n$$\nexpressed in terms of $L$ and the expansion coefficients $\\{c_{n}\\}$. Compute exactly the diagonal matrix element $\\langle n|x^2|n\\rangle$ in the well basis. Then, in the asymptotic regime $\\sigma/L\\to 0$ with the packet centered at $x=L/2$ and of zero mean momentum, evaluate the leading nontrivial term of $\\overline{\\operatorname{Var}}_{L}$ as a closed-form analytic expression in $L$ and $\\sigma$, obtained by approximating the coefficients $c_{n}$ through the projection of the Gaussian onto the well eigenstates and performing the necessary asymptotics.\n- For Scenario B, use the Heisenberg equations of motion to obtain the time dependence of the free-particle position variance $\\operatorname{Var}_{\\infty}(t)$ for the same initial state. Then compute the limit\n$$\nR=\\lim_{t\\to\\infty}\\frac{\\overline{\\operatorname{Var}}_{L}}{\\operatorname{Var}_{\\infty}(t)}.\n$$\n\nAnswer specification:\n- Your final answer must consist of two entries: the leading-order analytic expression for $\\overline{\\operatorname{Var}}_{L}$ in terms of $L$ and $\\sigma$ in the limit $\\sigma/L\\to 0$, and the number $R$. \n- Express the final answer as a single row matrix using the $\\mathrm{pmatrix}$ environment in the order $\\big[\\overline{\\operatorname{Var}}_{L}\\ \\ R\\big]$. \n- Provide symbols only (no numerical substitution and no units). \n- No rounding is required; provide exact closed-form expressions.", "solution": "The problem statement has been analyzed and is deemed valid. It is a well-posed problem in standard, nonrelativistic quantum mechanics, free of scientific or logical inconsistencies.\n\nThe solution proceeds in three parts as requested.\n\nFirst, the stationary states of the infinite square well are determined. The time-independent Schrödinger equation for a particle of mass $m$ in a potential well of width $L$ is\n$$\n-\\frac{\\hbar^{2}}{2m}\\frac{d^{2}\\phi(x)}{dx^{2}} = E\\phi(x)\n$$\nfor $x \\in (0, L)$, with boundary conditions $\\phi(0)=\\phi(L)=0$. The general solution is $\\phi(x) = A\\sin(kx) + B\\cos(kx)$. The condition $\\phi(0)=0$ implies $B=0$. The condition $\\phi(L)=0$ implies $A\\sin(kL)=0$, which requires $kL = n\\pi$ for a non-trivial solution, where $n$ is a positive integer ($n \\in \\{1, 2, 3, \\dots\\}$). The momentum is quantized, $k_{n} = \\frac{n\\pi}{L}$.\nThe energy eigenvalues are found by substituting $k_{n}$ into the Schrödinger equation:\n$$\nE_{n} = \\frac{\\hbar^{2}k_{n}^{2}}{2m} = \\frac{n^{2}\\pi^{2}\\hbar^{2}}{2mL^{2}}.\n$$\nThe eigenfunctions are $\\phi_{n}(x) = A\\sin(\\frac{n\\pi x}{L})$. Normalization requires $\\int_{0}^{L} |\\phi_{n}(x)|^{2} dx = 1$.\n$$\n|A|^{2}\\int_{0}^{L}\\sin^{2}\\left(\\frac{n\\pi x}{L}\\right)dx = |A|^{2}\\frac{L}{2} = 1 \\implies A = \\sqrt{\\frac{2}{L}}.\n$$\nThus, the normalized eigenfunctions are\n$$\n\\phi_{n}(x) = \\sqrt{\\frac{2}{L}}\\sin\\left(\\frac{n\\pi x}{L}\\right).\n$$\n\nSecond, the infinite-time average of the position variance in the well, $\\overline{\\operatorname{Var}}_{L}$, is computed. A general state $|\\psi(t)\\rangle$ is given by the expansion over the energy eigenbasis:\n$$\n|\\psi(t)\\rangle = \\sum_{n=1}^{\\infty} c_{n} e^{-iE_{n}t/\\hbar} |n\\rangle,\n$$\nwhere $|n\\rangle$ corresponds to the eigenfunction $\\phi_{n}(x)$ and $c_{n}=\\langle n|\\psi(0)\\rangle$. The variance at time $t$ is $\\operatorname{Var}_{L}(t) = \\langle x^{2} \\rangle_{t} - \\langle x \\rangle_{t}^{2}$.\nThe time average of an operator expectation value $\\langle O \\rangle_{t}$ is\n$$\n\\overline{\\langle O \\rangle} = \\lim_{T\\to\\infty} \\frac{1}{T}\\int_{0}^{T} \\sum_{m,n} c_{m}^{*}c_{n} e^{i(E_{m}-E_{n})t/\\hbar} \\langle m|O|n\\rangle dt.\n$$\nSince the energies $E_n$ are non-degenerate, the time average selects the constant terms where $m=n$:\n$$\n\\overline{\\langle O \\rangle} = \\sum_{n} |c_{n}|^{2} \\langle n|O|n\\rangle.\n$$\nThe problem asks for $\\overline{\\operatorname{Var}}_{L} = \\overline{\\langle x^{2} \\rangle_{t} - \\langle x \\rangle_{t}^{2}} = \\overline{\\langle x^{2} \\rangle_{t}} - \\overline{\\langle x \\rangle_{t}^{2}}$.\nThe first term is simple: $\\overline{\\langle x^{2} \\rangle_{t}} = \\sum_{n} |c_{n}|^{2} \\langle n|x^{2}|n\\rangle$.\nFor the second term, $\\overline{\\langle x \\rangle_{t}^{2}}$, we analyze the time average of a product. Assuming no accidental degeneracies in transition frequencies ($E_m-E_n \\neq E_p-E_q$ for $\\{m,n\\} \\neq \\{p,q\\}$ and $\\{m,n\\} \\neq \\{q,p\\}$), the time average $\\overline{\\langle A \\rangle_{t}\\langle B \\rangle_{t}}$ is $\\overline{\\langle A \\rangle_{t}}\\cdot\\overline{\\langle B \\rangle_{t}} + \\sum_{m \\neq n} \\langle A \\rangle_{mn}\\langle B \\rangle_{nm}$, where $\\langle O \\rangle_{mn} = c_m^* c_n \\langle m|O|n\\rangle$. Setting $A=B=x$, we get:\n$$\n\\overline{\\langle x \\rangle_{t}^{2}} = \\left(\\sum_{n}|c_{n}|^{2}\\langle n|x|n\\rangle\\right)^{2} + \\sum_{m\\neq n} |c_{m}|^{2}|c_{n}|^{2}|\\langle m|x|n\\rangle|^{2}.\n$$\nThe initial state $\\psi(x,0)$ is a Gaussian centered at $x=L/2$, an even function with respect to $x-L/2$. The eigenfunctions $\\phi_n(x)$ have definite parity with respect to $x=L/2$: $\\phi_n(L-x) = (-1)^{n+1}\\phi_n(x)$. For $n$ odd, $\\phi_n$ is even; for $n$ even, $\\phi_n$ is odd. The expansion coefficients $c_n = \\int_0^L \\phi_n^*(x)\\psi(x,0)dx$ are non-zero only for odd $n$.\nThe operator $x$ can be written as $(x-L/2) + L/2$. The term $(x-L/2)$ is odd with respect to the center $L/2$. Thus, its matrix elements $\\langle m|x-L/2|n\\rangle$ are non-zero only if $m$ and $n$ have opposite parity. Since our state only contains odd-$n$ components, $\\langle m|x-L/2|n\\rangle = 0$ for all relevant $m,n$.\nThen $\\langle m|x|n\\rangle = \\langle m|x-L/2|n\\rangle + (L/2)\\langle m|n\\rangle = (L/2)\\delta_{mn}$.\nThis implies $\\langle m|x|n\\rangle=0$ for $m\\neq n$ (with $m, n$ odd) and $\\langle n|x|n\\rangle = L/2$.\nThe expression for the time-averaged variance simplifies significantly:\n$$\n\\overline{\\operatorname{Var}}_{L} = \\sum_{n \\text{ odd}} |c_{n}|^{2}\\langle n|x^{2}|n\\rangle - \\left(\\sum_{n \\text{ odd}}|c_{n}|^{2}\\frac{L}{2}\\right)^{2} = \\sum_{n \\text{ odd}} |c_{n}|^{2}\\langle n|x^{2}|n\\rangle - \\frac{L^{2}}{4}.\n$$\nThe diagonal matrix element $\\langle n|x^{2}|n\\rangle$ is computed:\n$$\n\\langle n|x^{2}|n\\rangle = \\frac{2}{L}\\int_{0}^{L} x^{2}\\sin^{2}\\left(\\frac{n\\pi x}{L}\\right)dx = L^{2}\\left(\\frac{1}{3} - \\frac{1}{2n^{2}\\pi^{2}}\\right).\n$$\nSubstituting this into the expression for $\\overline{\\operatorname{Var}}_{L}$ and using $\\sum_{n \\text{ odd}}|c_n|^2=1$:\n$$\n\\overline{\\operatorname{Var}}_{L} = \\sum_{n \\text{ odd}}|c_n|^2 L^2\\left(\\frac{1}{3} - \\frac{1}{2n^2\\pi^2}\\right) - \\frac{L^2}{4} = \\frac{L^2}{3} - \\frac{L^2}{4} - \\frac{L^2}{2\\pi^2}\\sum_{n \\text{ odd}}\\frac{|c_n|^2}{n^2} = \\frac{L^{2}}{12} - \\frac{L^{2}}{2\\pi^{2}}\\sum_{n \\text{ odd}}\\frac{|c_n|^2}{n^2}.\n$$\nTo evaluate this in the limit $\\sigma/L \\to 0$, we find the coefficients $c_{n}$ for odd $n$:\n$$\nc_{n} = \\int_{0}^{L} \\phi_{n}^{*}(x)\\psi(x,0)dx \\approx \\sqrt{\\frac{2}{L}}\\left(\\frac{1}{2\\pi\\sigma^{2}}\\right)^{1/4}\\int_{-\\infty}^{\\infty}\\sin\\left(\\frac{n\\pi x}{L}\\right)\\exp\\left(-\\frac{(x-L/2)^{2}}{4\\sigma^{2}}\\right)dx.\n$$\nFor odd $n$, $\\sin(\\frac{n\\pi x}{L})$ becomes $(-1)^{(n-1)/2}\\cos(\\frac{n\\pi(x-L/2)}{L})$. The integral is a Fourier transform of a Gaussian, yielding\n$|c_n|^{2} \\approx \\frac{4\\sqrt{2\\pi}\\sigma}{L}\\exp\\left(-\\frac{2n^{2}\\pi^{2}\\sigma^{2}}{L^{2}}\\right)$ for odd $n$.\nThe sum becomes $S = \\sum_{n \\text{ odd}}\\frac{|c_n|^2}{n^2} = \\frac{4\\sqrt{2\\pi}\\sigma}{L}\\sum_{n \\text{ odd}}\\frac{1}{n^2}\\exp\\left(-\\frac{2n^{2}\\pi^{2}\\sigma^{2}}{L^{2}}\\right)$.\nIn the limit $\\sigma/L \\to 0$, the exponential term approaches $1$, and the sum over $n$ is dominated by the leading term of the series $\\sum_{n \\text{ odd}} \\frac{1}{n^2} = \\frac{\\pi^{2}}{8}$.\n$$\nS \\approx \\frac{4\\sqrt{2\\pi}\\sigma}{L} \\cdot \\frac{\\pi^{2}}{8} = \\frac{\\sqrt{2\\pi}\\pi^{2}\\sigma}{2L}.\n$$\nSubstituting this into the expression for $\\overline{\\operatorname{Var}}_{L}$:\n$$\n\\overline{\\operatorname{Var}}_{L} \\approx \\frac{L^{2}}{12} - \\frac{L^{2}}{2\\pi^{2}}\\left(\\frac{\\sqrt{2\\pi}\\pi^{2}\\sigma}{2L}\\right) = \\frac{L^{2}}{12} - \\frac{\\sqrt{2\\pi}L\\sigma}{4}.\n$$\nThis is the leading-order expression for the time-averaged variance.\n\nThird, the free-particle variance is calculated. For the free-particle Hamiltonian $H=p^{2}/(2m)$, the Heisenberg equations of motion give $\\hat{p}(t)=\\hat{p}(0)$ and $\\hat{x}(t)=\\hat{x}(0)+\\frac{\\hat{p}(0)}{m}t$.\nThe initial state is a minimum-uncertainty Gaussian with $\\langle x(0)\\rangle = L/2$, $\\operatorname{Var}(x(0))=\\sigma^{2}$, $\\langle p(0)\\rangle = 0$, and $\\operatorname{Var}(p(0)) = \\sigma_{p}^{2}=\\frac{\\hbar^{2}}{4\\sigma^{2}}$. The position-momentum covariance is zero for this state.\nThe expectation values are $\\langle x \\rangle_{t} = \\langle x(0) \\rangle + \\frac{\\langle p(0)\\rangle}{m}t = L/2$.\n$\\langle x^{2} \\rangle_{t} = \\langle (\\hat{x}(0)+\\frac{\\hat{p}(0)}{m}t)^{2} \\rangle = \\langle x(0)^{2} \\rangle + \\frac{t}{m}\\langle \\hat{x}(0)\\hat{p}(0)+\\hat{p}(0)\\hat{x}(0) \\rangle + \\frac{t^{2}}{m^{2}}\\langle p(0)^{2} \\rangle$.\nWith $\\langle x(0)^{2} \\rangle = \\operatorname{Var}(x(0)) + \\langle x(0) \\rangle^{2} = \\sigma^{2}+(L/2)^{2}$, $\\langle \\hat{x}(0)\\hat{p}(0)+\\hat{p}(0)\\hat{x}(0) \\rangle = 0$, and $\\langle p(0)^{2} \\rangle = \\sigma_{p}^{2}$.\nThe variance for the free particle is\n$$\n\\operatorname{Var}_{\\infty}(t) = \\langle x^{2} \\rangle_{t} - \\langle x \\rangle_{t}^{2} = \\left(\\sigma^{2}+\\frac{L^{2}}{4}\\right) + \\frac{t^{2}}{m^{2}}\\frac{\\hbar^{2}}{4\\sigma^{2}} - \\left(\\frac{L}{2}\\right)^{2} = \\sigma^{2} + \\frac{\\hbar^{2}t^{2}}{4m^{2}\\sigma^{2}}.\n$$\n\nFinally, the ratio $R$ is computed:\n$$\nR = \\lim_{t\\to\\infty}\\frac{\\overline{\\operatorname{Var}}_{L}}{\\operatorname{Var}_{\\infty}(t)} = \\lim_{t\\to\\infty}\\frac{\\frac{L^{2}}{12} - \\frac{\\sqrt{2\\pi}L\\sigma}{4}}{\\sigma^{2} + \\frac{\\hbar^{2}t^{2}}{4m^{2}\\sigma^{2}}}.\n$$\nThe numerator is a finite constant, while the denominator grows quadratically with time. Therefore, the limit is zero.\n$$\nR=0.\n$$\n\nThe final answers are the expression for $\\overline{\\operatorname{Var}}_{L}$ and the value of $R$.", "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{L^{2}}{12} - \\frac{\\sqrt{2\\pi}L\\sigma}{4} & 0 \\end{pmatrix}}\n$$", "id": "2892676"}, {"introduction": "The analytical solutions for free particles are not merely textbook examples; they are the cornerstone of modern computational methods for simulating complex quantum systems. This final practice bridges the gap between analytical theory and numerical algorithms by exploring the symmetric operator-splitting, or Strang splitting, method. You will demonstrate that for a free particle, this widely used approximation scheme becomes exact, showing how the free-evolution kernel is precisely implemented in real-world simulations using the Fast Fourier Transform (FFT) [@problem_id:2892564].", "problem": "Implement a one-dimensional, second-order symmetric operator-splitting time propagator for a quantum particle governed by the time-dependent Schrödinger equation in a periodic box, and verify in the free-particle limit that it reduces to exact application of the kinetic phase. Work entirely in atomic units, where $\\hbar = 1$ and the particle mass is $m = 1$.\n\nStart from the time-dependent Schrödinger equation for a single particle in one spatial dimension,\n$$\n\\mathrm{i}\\,\\frac{\\partial}{\\partial t}\\,\\psi(x,t) \\;=\\; \\hat{H}\\,\\psi(x,t),\\qquad \\hat{H} \\;=\\; \\hat{T} + \\hat{V},\n$$\nwith kinetic energy operator $\\hat{T} = -\\frac{1}{2}\\frac{\\partial^2}{\\partial x^2}$ and multiplicative potential energy operator $(\\hat{V}\\psi)(x) = V(x)\\,\\psi(x)$. The exact evolution over a time step $\\Delta t$ is given by the unitary propagator $\\hat{U}(\\Delta t) = \\exp\\!\\left(-\\mathrm{i}\\,\\hat{H}\\,\\Delta t\\right)$. A second-order accurate, symmetric operator splitting (also known as Strang splitting) replaces the exact propagator by a composition of substeps that alternately apply free evolution generated by $\\hat{T}$ and pointwise potential evolution generated by $\\hat{V}$, arranged symmetrically in time.\n\nOn a periodic interval of length $L$ discretized with $N$ equidistant grid points $x_j = j\\,\\Delta x$ for $j \\in \\{0,1,\\dots,N-1\\}$ with $\\Delta x = L/N$, the free evolution generated by $\\hat{T}$ is diagonal in the momentum representation. Let $k_n = \\frac{2\\pi}{L} n$ denote the discrete angular wavenumbers associated with the grid, where $n$ runs over the $N$ modes consistent with the discrete Fourier transform. The free evolution over a time increment $\\Delta t$ corresponds to multiplying each Fourier mode by the kinetic phase factor associated with its kinetic energy $T(k_n) = \\frac{1}{2}k_n^2$.\n\nTasks:\n1. Derive, from the definitions above and without invoking any black-box results beyond standard properties of exponentials and commutators, a second-order accurate, symmetric operator-splitting scheme that advances $\\psi(x,t)$ by a time step $\\Delta t$ under $\\hat{H} = \\hat{T} + \\hat{V}$ on the periodic grid. Your derivation must start from the fundamental time-dependent Schrödinger equation and the fact that the exact propagator is $\\exp(-\\mathrm{i}\\,\\hat{H}\\,\\Delta t)$.\n2. Specialize your scheme to the free-particle limit $V(x) \\equiv 0$ and prove that, on the periodic grid, the scheme reduces to exact application of the kinetic phase in momentum space. That is, show that for total time $t = M\\,\\Delta t$ with integer $M \\geq 0$, the $M$ repeated splitting steps coincide with a single spectral application of the exact free propagator $\\exp\\!\\left(-\\mathrm{i}\\,\\hat{T}\\,t\\right)$.\n3. Implement your scheme using the Discrete Fourier Transform computed by the Fast Fourier Transform (FFT) on the periodic grid. Use the momentum-space kinetic update by multiplying by the appropriate kinetic phase factors, and the real-space potential update by pointwise multiplication by potential phase factors.\n4. Verify numerically, for the free-particle limit $V(x)=0$, that the multi-step second-order splitting coincides with the one-shot exact free evolution in momentum space over the same total time, by computing the $L^2$-norm difference on the grid, defined as\n$$\n\\left\\|\\psi - \\phi\\right\\|_{L^2(\\text{grid})} \\;=\\; \\left(\\sum_{j=0}^{N-1} \\left|\\psi_j - \\phi_j\\right|^2\\,\\Delta x\\right)^{1/2}.\n$$\nUse normalized initial states $\\psi(x,0)$.\n\nYour program must hard-code the following test suite and output the $L^2$-norm differences for each case as floating-point numbers. All computations are in atomic units and are dimensionless; no physical units need to be reported. The grid is periodic on $[0,L)$ in all cases.\n\nLet $\\Delta x = L/N$ and $k_n = \\frac{2\\pi}{L} n$ as above. For a Gaussian wavepacket centered at $x_0$ with width $\\sigma$ and mean wavenumber $k_0$, use\n$$\n\\psi(x,0) \\;=\\; \\frac{1}{(\\pi\\sigma^2)^{1/4}}\\,\\exp\\!\\left(-\\frac{(x-x_0)^2}{2\\sigma^2}\\right)\\,\\exp\\!\\left(\\mathrm{i}\\,k_0\\,x\\right),\n$$\nfollowed by discrete normalization so that $\\sum_j |\\psi_j|^2 \\Delta x = 1$. For a plane wave with wavenumber $k_0$ on the grid, use $\\psi(x,0) = L^{-1/2}\\,\\exp(\\mathrm{i}\\,k_0\\,x)$.\n\nTest suite:\n- Case A (happy path Gaussian): $N=1024$, $L=100.0$, $x_0=25.0$, $\\sigma=2.0$, $k_0=1.25$, $\\Delta t=0.05$, $M=200$, $V(x)\\equiv 0$.\n- Case B (zero-time boundary): same parameters as Case A, but $\\Delta t=0.0$, $M=0$, $V(x)\\equiv 0$.\n- Case C (grid-aligned plane wave): $N=1024$, $L=100.0$, choose mode index $m=100$ so that $k_0=\\frac{2\\pi}{L}m$, initialize $\\psi(x,0) = L^{-1/2}\\exp(\\mathrm{i}\\,k_0 x)$, take $\\Delta t=0.03$, $M=333$, $V(x)\\equiv 0$.\n- Case D (high-wavenumber Gaussian near Nyquist): $N=1024$, $L=100.0$, $x_0=40.0$, $\\sigma=10.0$, let $k_{\\max}=\\pi/\\Delta x$ and choose $k_0=0.8\\,k_{\\max}$, take $\\Delta t=0.02$, $M=250$, $V(x)\\equiv 0$.\n\nFor each case, compute the $L^2$-norm difference between:\n- the state obtained by applying $M$ steps of your second-order symmetric splitting with $V(x)=0$, and\n- the state obtained by applying the exact free evolution once in momentum space for total time $t=M\\,\\Delta t$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[r_A,r_B,r_C,r_D]\"), where $r_A$, $r_B$, $r_C$, $r_D$ are the four floating-point differences defined above, in the order of Cases A, B, C, D. No other output is permitted.", "solution": "The problem requires the derivation, analysis, and implementation of a second-order symmetric operator-splitting propagator for the one-dimensional time-dependent Schrödinger equation, with a specific focus on its exactness in the free-particle limit. We shall address each task in sequence. All calculations are performed in atomic units, where $\\hbar=1$ and the particle mass $m=1$.\n\nThe governing equation is\n$$\n\\mathrm{i}\\,\\frac{\\partial}{\\partial t}\\,\\psi(x,t) \\;=\\; \\hat{H}\\,\\psi(x,t)\n$$\nwhere the Hamiltonian is $\\hat{H} = \\hat{T} + \\hat{V}$, with $\\hat{T} = -\\frac{1}{2}\\frac{\\partial^2}{\\partial x^2}$ and $(\\hat{V}\\psi)(x) = V(x)\\,\\psi(x)$. The formal solution over a time step $\\Delta t$ is\n$$\n\\psi(x, t+\\Delta t) = \\exp(-\\mathrm{i}\\hat{H}\\Delta t)\\,\\psi(x,t)\n$$\nSince the operators $\\hat{T}$ and $\\hat{V}$ do not commute in general, i.e., $[\\hat{T}, \\hat{V}] \\neq 0$, the exponential of the sum cannot be factored into a product of exponentials: $\\exp(-\\mathrm{i}(\\hat{T}+\\hat{V})\\Delta t) \\neq \\exp(-\\mathrm{i}\\hat{T}\\Delta t)\\exp(-\\mathrm{i}\\hat{V}\\Delta t)$. Operator splitting methods provide a systematic way to approximate the full propagator as a sequence of propagators involving only $\\hat{T}$ or $\\hat{V}$.\n\n**Task 1: Derivation of the Second-Order Symmetric Propagator**\n\nWe seek an approximation $\\hat{U}_{approx}(\\Delta t)$ to the exact propagator $\\hat{U}(\\Delta t) = \\exp(-\\mathrm{i}(\\hat{T}+\\hat{V})\\Delta t)$ that is accurate to second order in $\\Delta t$. A symmetric composition, known as Strang splitting, is given by\n$$\n\\hat{U}_{approx}(\\Delta t) \\;=\\; \\exp(-\\mathrm{i}\\hat{T}\\frac{\\Delta t}{2})\\,\\exp(-\\mathrm{i}\\hat{V}\\Delta t)\\,\\exp(-\\mathrm{i}\\hat{T}\\frac{\\Delta t}{2})\n$$\nTo prove that this is a second-order approximation, we compare the Taylor series expansion of $\\hat{U}_{approx}(\\Delta t)$ with that of the exact propagator $\\hat{U}(\\Delta t)$ in powers of $\\Delta t$.\n\nThe expansion of the exact propagator is:\n$$\n\\hat{U}(\\Delta t) = \\mathbf{1} - \\mathrm{i}(\\hat{T}+\\hat{V})\\Delta t + \\frac{(-\\mathrm{i})^2}{2!}(\\hat{T}+\\hat{V})^2(\\Delta t)^2 + O((\\Delta t)^3)\n$$\n$$\n\\hat{U}(\\Delta t) = \\mathbf{1} - \\mathrm{i}(\\hat{T}+\\hat{V})\\Delta t - \\frac{1}{2}(\\hat{T}^2 + \\hat{T}\\hat{V} + \\hat{V}\\hat{T} + \\hat{V}^2)(\\Delta t)^2 + O((\\Delta t)^3)\n$$\nNow, we expand the components of the approximate propagator:\n$$\n\\exp(-\\mathrm{i}\\hat{T}\\frac{\\Delta t}{2}) = \\mathbf{1} - \\mathrm{i}\\frac{\\hat{T}\\Delta t}{2} - \\frac{1}{2}(\\frac{\\hat{T}\\Delta t}{2})^2 + O((\\Delta t)^3) = \\mathbf{1} - \\mathrm{i}\\frac{\\hat{T}\\Delta t}{2} - \\frac{\\hat{T}^2(\\Delta t)^2}{8} + O((\\Delta t)^3)\n$$\n$$\n\\exp(-\\mathrm{i}\\hat{V}\\Delta t) = \\mathbf{1} - \\mathrm{i}\\hat{V}\\Delta t - \\frac{1}{2}(\\hat{V}\\Delta t)^2 + O((\\Delta t)^3) = \\mathbf{1} - \\mathrm{i}\\hat{V}\\Delta t - \\frac{\\hat{V}^2(\\Delta t)^2}{2} + O((\\Delta t)^3)\n$$\nMultiplying these expansions for $\\hat{U}_{approx}(\\Delta t)$:\n$$\n\\hat{U}_{approx}(\\Delta t) = \\left( \\mathbf{1} - \\mathrm{i}\\frac{\\hat{T}\\Delta t}{2} - \\frac{\\hat{T}^2(\\Delta t)^2}{8} \\right) \\left( \\mathbf{1} - \\mathrm{i}\\hat{V}\\Delta t - \\frac{\\hat{V}^2(\\Delta t)^2}{2} \\right) \\left( \\mathbf{1} - \\mathrm{i}\\frac{\\hat{T}\\Delta t}{2} - \\frac{\\hat{T}^2(\\Delta t)^2}{8} \\right) + O((\\Delta t)^3)\n$$\nWe collect terms by powers of $\\Delta t$:\nThe term of order $(\\Delta t)^0$ is $\\mathbf{1} \\cdot \\mathbf{1} \\cdot \\mathbf{1} = \\mathbf{1}$, which matches.\nThe term of order $(\\Delta t)^1$ is:\n$$\n(-\\mathrm{i}\\frac{\\hat{T}}{2})\\Delta t + (-\\mathrm{i}\\hat{V})\\Delta t + (-\\mathrm{i}\\frac{\\hat{T}}{2})\\Delta t = -\\mathrm{i}(\\hat{T}+\\hat{V})\\Delta t\n$$\nThis also matches the exact expansion.\nThe term of order $(\\Delta t)^2$ is the sum of all operator products whose coefficients contain $(\\Delta t)^2$:\n$$\n\\underbrace{ \\left(-\\mathrm{i}\\frac{\\hat{T}}{2}\\right)\\left(-\\mathrm{i}\\hat{V}\\right)(\\Delta t)^2 }_{-\\frac{1}{2}\\hat{T}\\hat{V}(\\Delta t)^2} + \\underbrace{ \\left(-\\mathrm{i}\\frac{\\hat{T}}{2}\\right)\\left(-\\mathrm{i}\\frac{\\hat{T}}{2}\\right)(\\Delta t)^2 }_{-\\frac{1}{4}\\hat{T}^2(\\Delta t)^2} + \\underbrace{ \\left(-\\mathrm{i}\\hat{V}\\right)\\left(-\\mathrm{i}\\frac{\\hat{T}}{2}\\right)(\\Delta t)^2 }_{-\\frac{1}{2}\\hat{V}\\hat{T}(\\Delta t)^2} + \\underbrace{ \\left(-\\frac{\\hat{T}^2}{8}\\right)(\\Delta t)^2 + \\left(-\\frac{\\hat{V}^2}{2}\\right)(\\Delta t)^2 + \\left(-\\frac{\\hat{T}^2}{8}\\right)(\\Delta t)^2 }_{\\text{from squares in individual expansions}}\n$$\nSumming these terms:\n$$\n(\\Delta t)^2 \\left( -\\frac{1}{2}\\hat{T}\\hat{V} - \\frac{1}{4}\\hat{T}^2 - \\frac{1}{2}\\hat{V}\\hat{T} - \\frac{1}{8}\\hat{T}^2 - \\frac{1}{2}\\hat{V}^2 - \\frac{1}{8}\\hat{T}^2 \\right) = (\\Delta t)^2 \\left( -\\frac{1}{2}(\\hat{T}\\hat{V} + \\hat{V}\\hat{T}) - \\frac{1}{2}\\hat{V}^2 - (\\frac{1}{4}+\\frac{1}{8}+\\frac{1}{8})\\hat{T}^2 \\right)\n$$\n$$\n= (\\Delta t)^2 \\left( -\\frac{1}{2}(\\hat{T}^2 + \\hat{T}\\hat{V} + \\hat{V}\\hat{T} + \\hat{V}^2) \\right) = -\\frac{1}{2}(\\hat{T}+\\hat{V})^2 (\\Delta t)^2\n$$\nThis precisely matches the second-order term in the expansion of $\\hat{U}(\\Delta t)$. Since the expansions of $\\hat{U}(\\Delta t)$ and $\\hat{U}_{approx}(\\Delta t)$ agree up to and including terms of order $(\\Delta t)^2$, the symmetric splitting scheme is second-order accurate. The local error is $O((\\Delta t)^3)$.\n\n**Task 2: Specialization to the Free-Particle Limit**\n\nIn the free-particle limit, the potential energy is identically zero, $V(x) \\equiv 0$, which implies the operator $\\hat{V} = 0$. The Hamiltonian simplifies to $\\hat{H} = \\hat{T}$.\nThe exact propagator for a time step $\\Delta t$ is $\\hat{U}(\\Delta t) = \\exp(-\\mathrm{i}\\hat{T}\\Delta t)$.\nLet us evaluate the symmetric splitting propagator $\\hat{U}_{approx}(\\Delta t)$ under this condition:\n$$\n\\hat{U}_{approx}(\\Delta t) \\;=\\; \\exp(-\\mathrm{i}\\hat{T}\\frac{\\Delta t}{2})\\,\\exp(-\\mathrm{i}(0)\\Delta t)\\,\\exp(-\\mathrm{i}\\hat{T}\\frac{\\Delta t}{2})\n$$\nSince the exponential of the zero operator is the identity operator, $\\exp(0) = \\mathbf{1}$, this expression simplifies to:\n$$\n\\hat{U}_{approx}(\\Delta t) \\;=\\; \\exp(-\\mathrm{i}\\hat{T}\\frac{\\Delta t}{2})\\,\\mathbf{1}\\,\\exp(-\\mathrm{i}\\hat{T}\\frac{\\Delta t}{2}) \\;=\\; \\exp(-\\mathrm{i}\\hat{T}\\frac{\\Delta t}{2})\\,\\exp(-\\mathrm{i}\\hat{T}\\frac{\\Delta t}{2})\n$$\nAn operator always commutes with itself. Therefore, we can add the exponents: $\\exp(\\hat{A})\\exp(\\hat{B}) = \\exp(\\hat{A}+\\hat{B})$ if $[\\hat{A},\\hat{B}]=0$.\n$$\n\\hat{U}_{approx}(\\Delta t) \\;=\\; \\exp\\left(-\\mathrm{i}\\hat{T}\\frac{\\Delta t}{2} - \\mathrm{i}\\hat{T}\\frac{\\Delta t}{2}\\right) \\;=\\; \\exp(-\\mathrm{i}\\hat{T}\\Delta t)\n$$\nThis is identical to the exact free-particle propagator $\\hat{U}(\\Delta t)$. Thus, for any single time step $\\Delta t$, the symmetric splitting scheme is not an approximation but is exact for a free particle.\n\nNow, consider the evolution over a total time $t = M\\Delta t$, achieved by applying the propagator $M$ times. The state at time $t$ is given by\n$$\n\\psi(x, t) = \\left(\\hat{U}_{approx}(\\Delta t)\\right)^M \\psi(x, 0)\n$$\nSubstituting our result for the free-particle case:\n$$\n\\psi(x, t) = \\left(\\exp(-\\mathrm{i}\\hat{T}\\Delta t)\\right)^M \\psi(x, 0)\n$$\nAgain, since all operators in the product are identical, they commute, and we can sum the exponents:\n$$\n\\psi(x, t) = \\exp(-M \\cdot \\mathrm{i}\\hat{T}\\Delta t) \\psi(x, 0) = \\exp(-\\mathrm{i}\\hat{T}(M\\Delta t)) \\psi(x, 0)\n$$\nWith $t = M\\Delta t$, we have:\n$$\n\\psi(x, t) = \\exp(-\\mathrm{i}\\hat{T}t) \\psi(x, 0)\n$$\nThis is precisely the state obtained by applying the exact free-evolution propagator for the total time $t$ in a single step. This proves that for a free particle, the result of $M$ repeated splitting steps is identical to a single spectral application of the exact free propagator over the total duration.\n\n**Task 3 & 4: Implementation and Numerical Verification Strategy**\n\nThe action of the propagators is implemented on a discrete grid of $N$ points $x_j=j\\Delta x$ on a periodic interval of length $L$.\nThe potential propagator $\\exp(-\\mathrm{i}\\hat{V}\\tau)$ is local in real space; its action on a wavefunction $\\psi_j = \\psi(x_j)$ is pointwise multiplication: $(\\exp(-\\mathrm{i}\\hat{V}\\tau)\\psi)_j = \\exp(-\\mathrm{i}V(x_j)\\tau)\\psi_j$. For the free-particle case $V(x)=0$, this is simply multiplication by $1$.\n\nThe kinetic propagator $\\exp(-\\mathrm{i}\\hat{T}\\tau)$ is local in momentum space. We use the Discrete Fourier Transform (DFT), computed via the Fast Fourier Transform (FFT) algorithm, to switch between real and momentum space representations.\nThe action of $\\exp(-\\mathrm{i}\\hat{T}\\tau)$ on $\\psi$ is computed as:\n1.  Transform to momentum space: $\\tilde{\\psi}(k_n) = \\mathcal{F}\\{\\psi(x_j)\\}$, where $\\mathcal{F}$ denotes the DFT.\n2.  Apply the kinetic phase: $\\tilde{\\psi}'(k_n) = \\exp(-\\mathrm{i} T(k_n) \\tau) \\tilde{\\psi}(k_n)$, where the kinetic energy is $T(k_n) = \\frac{1}{2}k_n^2$. The discrete wavenumbers $k_n$ are those corresponding to the DFT.\n3.  Transform back to real space: $\\psi'(x_j) = \\mathcal{F}^{-1}\\{\\tilde{\\psi}'(k_n)\\}$.\n\nCombining these, the algorithm for the multi-step splitting evolution is as follows:\nInitialize $\\psi_j$ at $t=0$. For $m=1, \\dots, M$:\n  a. Apply kinetic half-step: $\\psi \\leftarrow \\mathcal{F}^{-1}\\{\\exp(-\\mathrm{i} k_n^2/2 \\cdot \\Delta t/2) \\mathcal{F}\\{\\psi\\}\\}$.\n  b. Apply potential step: For $V(x)=0$, this is an identity operation.\n  c. Apply kinetic half-step: $\\psi \\leftarrow \\mathcal{F}^{-1}\\{\\exp(-\\mathrm{i} k_n^2/2 \\cdot \\Delta t/2) \\mathcal{F}\\{\\psi\\}\\}$.\n\nThe one-shot exact evolution is computed as:\n  a. Set total time $t = M\\Delta t$.\n  b. Apply full kinetic step: $\\psi_{exact} \\leftarrow \\mathcal{F}^{-1}\\{\\exp(-\\mathrm{i} k_n^2/2 \\cdot t) \\mathcal{F}\\{\\psi\\}\\}$.\n\nAs shown in Task 2, these two procedures are algebraically identical. The numerical verification will thus compute the $L^2$-norm of the difference between the wavefunctions produced by the two methods. An ideally implemented code should yield a difference on the order of machine floating-point precision, confirming that the implementation correctly reflects the analytical result. The metric is:\n$$\n\\left\\|\\psi_{split} - \\psi_{exact}\\right\\|_{L^2(\\text{grid})} \\;=\\; \\left(\\sum_{j=0}^{N-1} \\left|\\psi_{split,j} - \\psi_{exact,j}\\right|^2\\,\\Delta x\\right)^{1/2}\n$$\nThe test suite explores different initial conditions (Gaussian, plane wave) and parameters (time steps, wavenumbers) to ensure the robustness of this conclusion.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.fft import fft, ifft, fftfreq\n\ndef solve():\n    \"\"\"\n    Solves the problem by implementing and verifying the symmetric operator-splitting\n    propagator for the free-particle Schrödinger equation.\n    \"\"\"\n\n    test_cases = [\n        # Case A: Happy path Gaussian\n        {\n            \"N\": 1024, \"L\": 100.0, \"x0\": 25.0, \"sigma\": 2.0, \"k0\": 1.25,\n            \"dt\": 0.05, \"M\": 200, \"type\": \"gaussian\"\n        },\n        # Case B: Zero-time boundary\n        {\n            \"N\": 1024, \"L\": 100.0, \"x0\": 25.0, \"sigma\": 2.0, \"k0\": 1.25,\n            \"dt\": 0.0, \"M\": 0, \"type\": \"gaussian\"\n        },\n        # Case C: Grid-aligned plane wave\n        {\n            \"N\": 1024, \"L\": 100.0, \"m\": 100,\n            \"dt\": 0.03, \"M\": 333, \"type\": \"plane_wave\"\n        },\n        # Case D: High-wavenumber Gaussian near Nyquist\n        {\n            \"N\": 1024, \"L\": 100.0, \"x0\": 40.0, \"sigma\": 10.0, \"k0_factor\": 0.8,\n            \"dt\": 0.02, \"M\": 250, \"type\": \"high_k_gaussian\"\n        }\n    ]\n\n    results = []\n\n    for case in test_cases:\n        N = case[\"N\"]\n        L = case[\"L\"]\n        dt = case[\"dt\"]\n        M = case[\"M\"]\n        \n        # 1. Set up spatial and momentum grids\n        dx = L / N\n        x = np.linspace(0.0, L, N, endpoint=False)\n        k = 2 * np.pi * fftfreq(N, d=dx)\n        \n        # 2. Initialize wavefunction psi0\n        if case[\"type\"] == \"gaussian\":\n            x0 = case[\"x0\"]\n            sigma = case[\"sigma\"]\n            k0 = case[\"k0\"]\n            # Unnormalized Gaussian\n            psi0 = (1.0 / (np.pi * sigma**2)**0.25) * \\\n                   np.exp(-(x - x0)**2 / (2 * sigma**2)) * \\\n                   np.exp(1j * k0 * x)\n        elif case[\"type\"] == \"plane_wave\":\n            m = case[\"m\"]\n            k0 = 2 * np.pi * m / L\n            psi0 = (1.0 / np.sqrt(L)) * np.exp(1j * k0 * x)\n        elif case[\"type\"] == \"high_k_gaussian\":\n            x0 = case[\"x0\"]\n            sigma = case[\"sigma\"]\n            k_max = np.pi / dx\n            k0 = case[\"k0_factor\"] * k_max\n            psi0 = (1.0 / (np.pi * sigma**2)**0.25) * \\\n                   np.exp(-(x - x0)**2 / (2 * sigma**2)) * \\\n                   np.exp(1j * k0 * x)\n        else:\n            raise ValueError(f\"Unknown case type: {case['type']}\")\n\n        # Discrete normalization for Gaussians, plane wave is already normalized\n        if \"gaussian\" in case[\"type\"]:\n            norm_factor = np.sqrt(np.sum(np.abs(psi0)**2) * dx)\n            psi0 /= norm_factor\n\n        # 3. Method 1: Multi-step splitting evolution for V=0\n        psi_split = np.copy(psi0)\n        \n        # Kinetic energy propagator for a half time step\n        # For V=0, V-step is identity. The two half-steps can be combined for efficiency,\n        # but we implement them separately to model the Strang splitting algorithm structure.\n        kinetic_propagator_half = np.exp(-1j * 0.5 * k**2 * dt / 2)\n        \n        # Explicit V=0 potential propagator (identity)\n        potential_propagator = np.ones(N) # exp(-i*0*dt) = 1\n\n        for _ in range(M):\n            # First kinetic half-step\n            psi_k = fft(psi_split)\n            psi_k *= kinetic_propagator_half\n            psi_split = ifft(psi_k)\n            \n            # Potential step (identity for V=0)\n            psi_split *= potential_propagator\n\n            # Second kinetic half-step\n            psi_k = fft(psi_split)\n            psi_k *= kinetic_propagator_half\n            psi_split = ifft(psi_k)\n            \n        # 4. Method 2: One-shot exact evolution\n        total_time = M * dt\n        kinetic_propagator_full = np.exp(-1j * 0.5 * k**2 * total_time)\n        psi0_k = fft(psi0)\n        psi_exact_k = psi0_k * kinetic_propagator_full\n        psi_exact = ifft(psi_exact_k)\n\n        # 5. Compute L2-norm difference\n        diff_norm = np.sqrt(np.sum(np.abs(psi_split - psi_exact)**2) * dx)\n        results.append(diff_norm)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2892564"}]}