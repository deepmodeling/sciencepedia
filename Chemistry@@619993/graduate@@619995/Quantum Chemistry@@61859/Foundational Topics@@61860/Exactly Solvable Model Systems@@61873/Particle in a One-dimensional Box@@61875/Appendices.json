{"hands_on_practices": [{"introduction": "The variational principle is a cornerstone of quantum chemistry, offering a robust method to approximate the ground state energy of complex systems for which exact solutions are unobtainable. This exercise provides a practical application of the principle to the familiar particle-in-a-box model, a system for which we know the exact solution. By using a simple, intuitive trial wavefunction, you can directly calculate an upper bound for the ground state energy and assess the accuracy of the variational method, gaining a deeper appreciation for its power. [@problem_id:1410510]", "problem": "A particle of mass $m$ is confined to a one-dimensional box of length $L$. The potential energy $V(x)$ is zero for $0 < x < L$ and infinite otherwise. The time-independent Schrödinger equation for this system is given by $\\hat{H}\\psi = E\\psi$, where the Hamiltonian operator is $\\hat{H} = -\\frac{\\hbar^2}{2m}\\frac{d^2}{dx^2}$ inside the box.\n\nThe variational principle provides a method to find an upper bound for the ground state energy of a quantum system. Consider the following unnormalized trial wavefunction for the particle in the box:\n$$\n\\phi(x) = x(L-x) \\quad \\text{for} \\quad 0 \\le x \\le L\n$$\nThis function correctly satisfies the boundary conditions $\\phi(0) = 0$ and $\\phi(L) = 0$.\n\nUsing the variational principle, calculate the expectation value of the energy, $E_{var}$, for this trial wavefunction. Your task is to determine by what factor this variational energy exceeds the true ground state energy of the system, $E_1 = \\frac{\\pi^2 \\hbar^2}{2mL^2}$. Express your answer as a single numerical value, representing the ratio $\\frac{E_{var}}{E_1}$, rounded to four significant figures.", "solution": "The variational energy for a real trial function $\\phi(x)$ that vanishes at the infinite walls is\n$$\nE_{var}=\\frac{\\langle \\phi|\\hat{H}|\\phi\\rangle}{\\langle \\phi|\\phi\\rangle}\n=-\\frac{\\hbar^{2}}{2m}\\frac{\\int_{0}^{L}\\phi(x)\\,\\frac{d^{2}\\phi}{dx^{2}}\\,dx}{\\int_{0}^{L}\\phi^{2}(x)\\,dx}.\n$$\nIntegrating by parts and using $\\phi(0)=\\phi(L)=0$ gives\n$$\n\\int_{0}^{L}\\phi\\,\\frac{d^{2}\\phi}{dx^{2}}\\,dx=\\left.\\phi\\,\\frac{d\\phi}{dx}\\right|_{0}^{L}-\\int_{0}^{L}\\left(\\frac{d\\phi}{dx}\\right)^{2}dx=-\\int_{0}^{L}\\left(\\frac{d\\phi}{dx}\\right)^{2}dx,\n$$\nso\n$$\nE_{var}=\\frac{\\hbar^{2}}{2m}\\frac{\\int_{0}^{L}\\left(\\frac{d\\phi}{dx}\\right)^{2}dx}{\\int_{0}^{L}\\phi^{2}(x)\\,dx}.\n$$\nWith $\\phi(x)=x(L-x)=Lx-x^{2}$, we have\n$$\n\\frac{d\\phi}{dx}=L-2x,\\qquad \\left(\\frac{d\\phi}{dx}\\right)^{2}=L^{2}-4Lx+4x^{2},\\qquad \\phi^{2}=x^{2}(L-x)^{2}=L^{2}x^{2}-2Lx^{3}+x^{4}.\n$$\nCompute the required integrals:\n$$\n\\int_{0}^{L}\\left(\\frac{d\\phi}{dx}\\right)^{2}dx=\\int_{0}^{L}\\left(L^{2}-4Lx+4x^{2}\\right)dx\n=\\left[L^{2}x-2Lx^{2}+\\frac{4}{3}x^{3}\\right]_{0}^{L}=\\frac{1}{3}L^{3},\n$$\n$$\n\\int_{0}^{L}\\phi^{2}(x)\\,dx=\\int_{0}^{L}\\left(L^{2}x^{2}-2Lx^{3}+x^{4}\\right)dx\n=\\left[\\frac{L^{2}}{3}x^{3}-\\frac{L}{2}x^{4}+\\frac{1}{5}x^{5}\\right]_{0}^{L}\n=\\left(\\frac{1}{3}-\\frac{1}{2}+\\frac{1}{5}\\right)L^{5}=\\frac{1}{30}L^{5}.\n$$\nHence\n$$\nE_{var}=\\frac{\\hbar^{2}}{2m}\\frac{\\frac{1}{3}L^{3}}{\\frac{1}{30}L^{5}}\n=\\frac{\\hbar^{2}}{2m}\\cdot\\frac{30}{3}\\cdot\\frac{1}{L^{2}}\n=\\frac{5\\hbar^{2}}{mL^{2}}.\n$$\nThe exact ground-state energy is $E_{1}=\\frac{\\pi^{2}\\hbar^{2}}{2mL^{2}}$. Therefore the ratio is\n$$\n\\frac{E_{var}}{E_{1}}=\\frac{\\frac{5\\hbar^{2}}{mL^{2}}}{\\frac{\\pi^{2}\\hbar^{2}}{2mL^{2}}}=\\frac{10}{\\pi^{2}}.\n$$\nNumerically, rounded to four significant figures,\n$$\n\\frac{E_{var}}{E_{1}}=1.013.\n$$", "answer": "$$\\boxed{1.013}$$", "id": "1410510"}, {"introduction": "Quantum systems do not always evolve adiabatically; sometimes, perturbations occur much faster than the system's characteristic response time. This exercise explores such a non-adiabatic process using the \"sudden approximation,\" a thought experiment where the potential well is instantaneously compressed. This practice offers excellent insight into the concept of state projection, as you must calculate the probability of the particle's initial wavefunction collapsing into a specific eigenstate of a new Hamiltonian. [@problem_id:1410506]", "problem": "A single electron is confined within a one-dimensional quantum wire of length $L$, which can be modeled as an infinite potential well with boundaries at $x=0$ and $x=L$. The electron is initially prepared in the second excited state, which corresponds to the principal quantum number $n=3$. In a rapid fabrication process, the wire is instantaneously shortened, such that the electron becomes confined to a new, smaller potential well spanning the region from $x=0$ to $x=L/2$. Immediately following this sudden compression, what is the probability of finding the electron in the ground state (principal quantum number $m=1$) of the new, smaller potential well?\n\nExpress your answer as a dimensionless analytic expression in terms of $\\pi$.", "solution": "The initial well is an infinite square well on the interval $0<x<L$. Its normalized stationary states are\n$$\n\\psi_{n}(x)=\\sqrt{\\frac{2}{L}}\\sin\\!\\left(\\frac{n\\pi x}{L}\\right), \\quad 0<x<L.\n$$\nThe electron is initially in the state with $n=3$, so\n$$\n\\psi_{\\text{initial}}(x)=\\sqrt{\\frac{2}{L}}\\sin\\!\\left(\\frac{3\\pi x}{L}\\right).\n$$\nAfter the sudden compression, the new well spans $0<x<L/2$, and its normalized stationary states are\n$$\n\\phi_{m}(x)=\\sqrt{\\frac{4}{L}}\\sin\\!\\left(\\frac{2m\\pi x}{L}\\right), \\quad 0<x<\\frac{L}{2}.\n$$\nIn the sudden approximation, the wavefunction immediately after the change is still $\\psi_{\\text{initial}}(x)$, and the probability amplitude to be in the new ground state $m=1$ is the overlap\n$$\nc_{1}=\\int_{0}^{L/2}\\phi_{1}(x)\\,\\psi_{\\text{initial}}(x)\\,dx\n=\\int_{0}^{L/2}\\sqrt{\\frac{4}{L}}\\sin\\!\\left(\\frac{2\\pi x}{L}\\right)\\,\\sqrt{\\frac{2}{L}}\\sin\\!\\left(\\frac{3\\pi x}{L}\\right)\\,dx.\n$$\nThis simplifies to\n$$\nc_{1}=\\frac{2\\sqrt{2}}{L}\\int_{0}^{L/2}\\sin\\!\\left(\\frac{2\\pi x}{L}\\right)\\sin\\!\\left(\\frac{3\\pi x}{L}\\right)\\,dx.\n$$\nUsing the identity $\\sin a\\,\\sin b=\\tfrac{1}{2}[\\cos(a-b)-\\cos(a+b)]$, with $a=\\tfrac{2\\pi x}{L}$ and $b=\\tfrac{3\\pi x}{L}$, we obtain\n$$\n\\int_{0}^{L/2}\\sin\\!\\left(\\frac{2\\pi x}{L}\\right)\\sin\\!\\left(\\frac{3\\pi x}{L}\\right)\\,dx\n=\\frac{1}{2}\\int_{0}^{L/2}\\left[\\cos\\!\\left(\\frac{\\pi x}{L}\\right)-\\cos\\!\\left(\\frac{5\\pi x}{L}\\right)\\right]dx.\n$$\nIntegrating term by term gives\n$$\n\\frac{1}{2}\\left[\\frac{L}{\\pi}\\sin\\!\\left(\\frac{\\pi x}{L}\\right)-\\frac{L}{5\\pi}\\sin\\!\\left(\\frac{5\\pi x}{L}\\right)\\right]_{0}^{L/2}\n=\\frac{1}{2}\\left[\\frac{L}{\\pi}\\cdot 1-\\frac{L}{5\\pi}\\cdot 1\\right]\n=\\frac{2L}{5\\pi}.\n$$\nTherefore,\n$$\nc_{1}=\\frac{2\\sqrt{2}}{L}\\cdot\\frac{2L}{5\\pi}=\\frac{4\\sqrt{2}}{5\\pi}.\n$$\nThe probability to find the electron in the new ground state is\n$$\nP_{1}=|c_{1}|^{2}=\\left(\\frac{4\\sqrt{2}}{5\\pi}\\right)^{2}=\\frac{32}{25\\pi^{2}}.\n$$\nThis is a dimensionless analytic expression in terms of $\\pi$, as required.", "answer": "$$\\boxed{\\frac{32}{25\\pi^{2}}}$$", "id": "1410506"}, {"introduction": "While the particle-in-a-box has an elegant analytical solution, most problems in quantum chemistry demand numerical approaches. This hands-on practice introduces the finite-difference method, a foundational technique in computational science for solving differential equations by discretizing the problem domain. By transforming the time-independent Schrödinger equation into a matrix eigenvalue problem, you will bridge the gap between abstract theory and practical computation, and directly observe how numerical accuracy depends on the resolution of the spatial grid. [@problem_id:2792822]", "problem": "Consider a single non-relativistic particle of mass $m$ in a one-dimensional infinite potential well (also called an infinite square box) defined on the interval $[0,L]$, with zero potential inside the box and infinite potential outside. Impose Dirichlet boundary conditions $\\psi(0)=0$ and $\\psi(L)=0$. Work in atomic units where the reduced Planck constant is set to $\\hbar=1$ and the electron mass is set to $m=1$. The time-independent Schrödinger equation inside the box is $-\\frac{\\hbar^2}{2m}\\frac{d^2\\psi}{dx^2}=E\\psi$.\n\nTask: Discretize the Hamiltonian on a uniform grid of $N$ interior points using the second-order central finite-difference approximation to the second derivative. Construct the discrete Hamiltonian matrix $H$ that enforces the Dirichlet boundary conditions $\\psi(0)=0$ and $\\psi(L)=0$ by excluding the endpoints from the set of unknowns. Compute the lowest $M$ eigenvalues (energies) numerically for each test case, and quantify the discretization accuracy by comparing to the exact continuum energies for an infinite square well. Specifically, for each test case, compute the maximum relative error among the first $M$ states, defined as $\\max_{1\\le n\\le M}\\left|\\frac{E^{\\mathrm{num}}_n - E^{\\mathrm{exact}}_n}{E^{\\mathrm{exact}}_n}\\right|$. You must not assume any values other than those explicitly stated here, and you must enforce the Dirichlet boundary conditions by construction of the matrix $H$.\n\nFundamental basis you may use:\n- The time-independent Schrödinger equation $-\\frac{\\hbar^2}{2m}\\frac{d^2\\psi}{dx^2}=E\\psi$ inside the well, with boundary conditions $\\psi(0)=0$ and $\\psi(L)=0$.\n- The second-order central finite-difference formula for the second derivative on a uniform grid.\n- Standard properties of symmetric matrices and their eigen-decompositions.\n\nImplementation requirements:\n- Use a uniform grid of $N$ interior points on $(0,L)$ with spacing $h=L/(N+1)$.\n- Use the second-order central finite difference to approximate $d^2\\psi/dx^2$ at interior grid points.\n- Assemble the symmetric tridiagonal Hamiltonian matrix $H$ that represents $-\\frac{\\hbar^2}{2m}\\frac{d^2}{dx^2}$ in atomic units (so $\\hbar=1$, $m=1$), respecting the Dirichlet boundary conditions by excluding the endpoints.\n- Compute the lowest $M$ eigenvalues of $H$ and compare them to the exact energies of the continuum infinite square well problem. From these, compute the maximum relative error over the first $M$ states.\n- All computations are to be done in atomic units. The reported errors are dimensionless real numbers.\n\nTest suite:\nProvide the maximum relative error for each of the following parameter sets $(L,N,M)$:\n- Case $1$: $(L,N,M)=(1.0,5,1)$.\n- Case $2$: $(L,N,M)=(1.0,50,3)$.\n- Case $3$: $(L,N,M)=(1.0,200,3)$.\n- Case $4$: $(L,N,M)=(2.5,200,2)$.\n- Case $5$: $(L,N,M)=(0.75,150,4)$.\n\nAnswer specification:\n- For each test case, output a single floating-point number equal to the maximum relative error over the first $M$ eigenvalues.\n- Express each output float rounded to eight decimal places.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order of the test suite above, for example, $[a_1,a_2,a_3,a_4,a_5]$ where each $a_i$ is rounded to eight decimal places.", "solution": "The system is a particle of mass $m$ confined to a one-dimensional box of length $L$, described by the time-independent Schrödinger equation. In atomic units, where the reduced Planck constant $\\hbar=1$ and the particle mass $m=1$, the equation inside the box (where potential $V(x)=0$) is:\n$$\n\\hat{H}\\psi(x) = -\\frac{1}{2}\\frac{d^2\\psi(x)}{dx^2} = E\\psi(x)\n$$\nwith Dirichlet boundary conditions $\\psi(0)=0$ and $\\psi(L)=0$.\n\nThe exact analytical solutions for the energy eigenvalues are known and serve as the benchmark for our numerical calculation. They are given by:\n$$\nE^{\\mathrm{exact}}_n = \\frac{n^2 \\pi^2 \\hbar^2}{2mL^2} = \\frac{n^2 \\pi^2}{2L^2}\n$$\nfor the principal quantum number $n = 1, 2, 3, \\dots$.\n\nTo solve the problem numerically, we discretize the spatial domain $[0, L]$. We define a uniform grid of $N+2$ points, $x_i = i \\cdot h$ for $i=0, 1, \\dots, N+1$. The grid consists of $N$ interior points, with the grid spacing $h$ given by $h = \\frac{L}{N+1}$. The wavefunction $\\psi(x)$ is represented by its values at these grid points, $\\psi_i \\equiv \\psi(x_i)$. The boundary conditions dictate $\\psi_0 = 0$ and $\\psi_{N+1} = 0$.\n\nThe second derivative operator, $\\frac{d^2}{dx^2}$, is approximated using the second-order central finite-difference formula at each interior grid point $x_i$:\n$$\n\\frac{d^2\\psi}{dx^2}\\bigg|_{x=x_i} \\approx \\frac{\\psi(x_i - h) - 2\\psi(x_i) + \\psi(x_i + h)}{h^2} = \\frac{\\psi_{i-1} - 2\\psi_i + \\psi_{i+1}}{h^2}\n$$\n\nSubstituting this approximation into the Schrödinger equation for an interior point $x_i$ ($i \\in \\{1, \\dots, N\\}$) yields:\n$$\n-\\frac{1}{2} \\left( \\frac{\\psi_{i-1} - 2\\psi_i + \\psi_{i+1}}{h^2} \\right) = E_i \\psi_i\n$$\nRearranging this expression gives the discrete equation for each point $i$:\n$$\n-\\frac{1}{2h^2}\\psi_{i-1} + \\frac{1}{h^2}\\psi_i - \\frac{1}{2h^2}\\psi_{i+1} = E_i \\psi_i\n$$\n\nWe can express this system of $N$ linear algebraic equations in matrix form, $H\\vec{\\psi} = E\\vec{\\psi}$, where $\\vec{\\psi}$ is a column vector of the wavefunction values at the $N$ interior points, $\\vec{\\psi} = [\\psi_1, \\psi_2, \\dots, \\psi_N]^T$. The boundary conditions are enforced by construction. For the first equation ($i=1$), the term $\\psi_0$ is set to zero. For the last equation ($i=N$), the term $\\psi_{N+1}$ is set to zero.\n\nThis procedure generates an $N \\times N$ matrix representation of the Hamiltonian operator. This discrete Hamiltonian matrix, $H$, is a symmetric, tridiagonal matrix with the following elements:\n$$\nH_{ij} =\n\\begin{cases}\n\\frac{1}{h^2} & \\text{for } i = j \\\\\n-\\frac{1}{2h^2} & \\text{for } |i - j| = 1 \\\\\n0 & \\text{otherwise}\n\\end{cases}\n$$\nOr, more explicitly,\n$$\nH = \\frac{1}{2h^2}\n\\begin{pmatrix}\n2 & -1 & 0 & \\cdots & 0 \\\\\n-1 & 2 & -1 & \\cdots & 0 \\\\\n0 & -1 & 2 & \\ddots & \\vdots \\\\\n\\vdots & \\vdots & \\ddots & \\ddots & -1 \\\\\n0 & 0 & \\cdots & -1 & 2\n\\end{pmatrix}\n$$\nThis matrix acts on the vector of wavefunction values at the interior points. The eigenvalues of this matrix, $E_n^{\\mathrm{num}}$, are the numerical approximations of the true energy eigenvalues.\n\nThe computational task is to construct this matrix $H$ for each set of parameters $(L, N, M)$ and compute its lowest $M$ eigenvalues. This is accomplished efficiently by using numerical linear algebra libraries optimized for symmetric tridiagonal matrices.\n\nFinally, we quantify the discretization accuracy by calculating the maximum relative error among the first $M$ energy levels. For each test case, the value to be reported is:\n$$\n\\text{Error} = \\max_{1 \\le n \\le M} \\left| \\frac{E^{\\mathrm{num}}_n - E^{\\mathrm{exact}}_n}{E^{\\mathrm{exact}}_n} \\right|\n$$\nwhere $E^{\\mathrm{num}}_n$ are the sorted eigenvalues from the numerical diagonalization of $H$, and $E^{\\mathrm{exact}}_n$ are the corresponding energies from the exact analytical formula. The following program implements this logic precisely as described.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import eigh_tridiagonal\n\ndef solve():\n    \"\"\"\n    Solves the discretized 1D particle-in-a-box problem for a series of test cases.\n\n    For each case (L, N, M), it constructs the finite-difference Hamiltonian,\n    computes the lowest M eigenvalues, compares them to the exact analytical\n    energies, and finds the maximum relative error.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    # Each tuple is (L, N, M) where:\n    # L: length of the box\n    # N: number of interior grid points\n    # M: number of lowest eigenvalues to check\n    test_cases = [\n        (1.0, 5, 1),\n        (1.0, 50, 3),\n        (1.0, 200, 3),\n        (2.5, 200, 2),\n        (0.75, 150, 4),\n    ]\n\n    results = []\n    for L, N, M in test_cases:\n        # Step 1: Set up the grid and constants.\n        # Atomic units are used (hbar=1, m=1).\n        # Grid spacing h for N interior points.\n        h = L / (N + 1)\n        \n        # Step 2: Construct the tridiagonal Hamiltonian matrix H.\n        # The TISE is (-1/2) * d^2(psi)/dx^2 = E * psi.\n        # The finite difference approximation for the second derivative is\n        # (psi_{i-1} - 2*psi_i + psi_{i+1}) / h^2.\n        # This leads to the discrete equation:\n        # (-1/(2*h^2)) * psi_{i-1} + (1/h^2) * psi_i + (-1/(2*h^2)) * psi_{i+1} = E * psi_i.\n        \n        # Main diagonal elements of H\n        diag_elements = np.full(N, 1.0 / h**2)\n        \n        # Off-diagonal elements of H\n        off_diag_elements = np.full(N - 1, -0.5 / h**2)\n\n        # Step 3: Compute the lowest M eigenvalues of H.\n        # eigh_tridiagonal is highly efficient for this matrix structure.\n        # It returns eigenvalues sorted in ascending order.\n        # We request the first M eigenvalues using select='i' and select_range.\n        # The function returns (eigenvalues, eigenvectors). We only need the eigenvalues.\n        numerical_eigenvalues, _ = eigh_tridiagonal(\n            diag_elements, \n            off_diag_elements,\n            select='i',\n            select_range=(0, M - 1)\n        )\n\n        # Step 4: Compute the exact analytical eigenvalues.\n        # E_n = (n^2 * pi^2) / (2 * L^2) for n=1, 2, 3, ...\n        n_values = np.arange(1, M + 1)\n        exact_eigenvalues = (n_values**2 * np.pi**2) / (2 * L**2)\n\n        # Step 5: Calculate the maximum relative error.\n        relative_errors = np.abs((numerical_eigenvalues - exact_eigenvalues) / exact_eigenvalues)\n        max_relative_error = np.max(relative_errors)\n        \n        results.append(max_relative_error)\n\n    # Final print statement in the exact required format.\n    # Results are rounded to eight decimal places.\n    print(f\"[{','.join(f'{r:.8f}' for r in results)}]\")\n\nsolve()\n```", "id": "2792822"}]}