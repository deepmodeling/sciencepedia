{"hands_on_practices": [{"introduction": "The link atom method is a cornerstone of many QM/MM simulations, providing a straightforward way to saturate the dangling valence of a quantum atom at the boundary. The placement of this link atom, typically a hydrogen, is not arbitrary. This exercise provides foundational practice in the vector geometry required to position the link atom collinearly with the severed bond, based on a target bond length constraint. Mastering this calculation is a crucial first step toward implementing and understanding any QM/MM simulation that employs a link atom scheme. [@problem_id:2902779]", "problem": "In a Quantum Mechanics/Molecular Mechanics (QM/MM) partitioning that cuts a covalent bond between a quantum-region atom and a molecular-mechanics-region atom, the link-atom (LA) scheme replaces the severed quantum-region valency by a hydrogen atom placed collinearly with the original bond. Let the molecular-mechanics boundary atom be at position vector $\\mathbf{r}_{\\mathrm{M}}$ and the quantum boundary atom be at position vector $\\mathbf{r}_{\\mathrm{Q}}$. The hydrogen link atom is constrained to lie on the line through $\\mathbf{r}_{\\mathrm{Q}}$ in the direction away from $\\mathbf{r}_{\\mathrm{M}}$, and is defined by\n$$\n\\mathbf{r}_{\\mathrm{H}} \\;=\\; \\mathbf{r}_{\\mathrm{Q}} \\;+\\; \\lambda \\bigl(\\mathbf{r}_{\\mathrm{Q}} - \\mathbf{r}_{\\mathrm{M}}\\bigr),\n$$\nfor some scalar $\\lambda \\in \\mathbb{R}$ to be determined by a bond-length constraint.\n\nStarting only from vector geometry and the definition of a covalent bond length as a target distance constraint, derive an analytic expression for $\\lambda$ in terms of the target link bond length $L_{\\mathrm{QH}}$ and the separation $|\\mathbf{r}_{\\mathrm{Q}}-\\mathbf{r}_{\\mathrm{M}}|$. Then, for a cut across a carbon–carbon bond in a saturated environment, take the covalent radii $r_{\\mathrm{cov}}(\\mathrm{C_{sp^3}})=0.77\\,\\text{\\AA}$ and $r_{\\mathrm{cov}}(\\mathrm{H})=0.31\\,\\text{\\AA}$ as the constraint to set the target carbon–hydrogen distance $L_{\\mathrm{QH}} = r_{\\mathrm{cov}}(\\mathrm{C_{sp^3}}) + r_{\\mathrm{cov}}(\\mathrm{H})$. Use the following coordinates (in \\AA) for a specific geometry:\n$$\n\\mathbf{r}_{\\mathrm{M}} = \\bigl(0.350,\\,-0.120,\\,0.980\\bigr), \\qquad\n\\mathbf{r}_{\\mathrm{Q}} = \\bigl(1.615,\\,0.420,\\,1.330\\bigr).\n$$\nCompute the numerical value of $\\lambda$ implied by the covalent-radii constraint. Round your answer to four significant figures. Report only the dimensionless scalar $\\lambda$ as your final answer.", "solution": "The problem statement has been evaluated and is deemed valid. It is scientifically grounded in the principles of computational chemistry, specifically the Quantum Mechanics/Molecular Mechanics (QM/MM) link-atom method. The problem is well-posed, with all necessary data and constraints provided to determine a unique and meaningful solution. We will proceed with the derivation and computation.\n\nThe objective is to find the scalar parameter $\\lambda$ that positions the hydrogen link atom $\\text{H}$ on the line defined by the quantum atom $\\text{Q}$ and the molecular mechanics atom $\\text{M}$. The position vector of the link atom, $\\mathbf{r}_{\\mathrm{H}}$, is given by the relation:\n$$\n\\mathbf{r}_{\\mathrm{H}} = \\mathbf{r}_{\\mathrm{Q}} + \\lambda (\\mathbf{r}_{\\mathrm{Q}} - \\mathbf{r}_{\\mathrm{M}})\n$$\nwhere $\\mathbf{r}_{\\mathrm{Q}}$ and $\\mathbf{r}_{\\mathrm{M}}$ are the position vectors of the quantum and molecular mechanics boundary atoms, respectively.\n\nThe parameter $\\lambda$ is determined by a constraint on the bond length between the quantum atom $\\text{Q}$ and the link atom $\\text{H}$. Let this target bond length be denoted by $L_{\\mathrm{QH}}$. By definition, this distance is the magnitude of the vector connecting the two atoms:\n$$\nL_{\\mathrm{QH}} = |\\mathbf{r}_{\\mathrm{H}} - \\mathbf{r}_{\\mathrm{Q}}|\n$$\nWe substitute the given expression for $\\mathbf{r}_{\\mathrm{H}}$ into this constraint equation:\n$$\n\\mathbf{r}_{\\mathrm{H}} - \\mathbf{r}_{\\mathrm{Q}} = \\left(\\mathbf{r}_{\\mathrm{Q}} + \\lambda (\\mathbf{r}_{\\mathrm{Q}} - \\mathbf{r}_{\\mathrm{M}})\\right) - \\mathbf{r}_{\\mathrm{Q}} = \\lambda (\\mathbf{r}_{\\mathrm{Q}} - \\mathbf{r}_{\\mathrm{M}})\n$$\nTaking the magnitude of both sides gives:\n$$\n|\\mathbf{r}_{\\mathrm{H}} - \\mathbf{r}_{\\mathrm{Q}}| = |\\lambda (\\mathbf{r}_{\\mathrm{Q}} - \\mathbf{r}_{\\mathrm{M}})|\n$$\nUsing the property of vector norms $|c\\mathbf{v}| = |c||\\mathbf{v}|$ for a scalar $c$ and vector $\\mathbf{v}$, we obtain:\n$$\nL_{\\mathrm{QH}} = |\\lambda| |\\mathbf{r}_{\\mathrm{Q}} - \\mathbf{r}_{\\mathrm{M}}|\n$$\nThe problem specifies that the link atom is placed \"in the direction away from $\\mathbf{r}_{\\mathrm{M}}$\". This means the displacement vector $\\mathbf{r}_{\\mathrm{H}} - \\mathbf{r}_{\\mathrm{Q}}$ must be parallel to and in the same direction as the vector $\\mathbf{r}_{\\mathrm{Q}} - \\mathbf{r}_{\\mathrm{M}}$. From the relation $\\mathbf{r}_{\\mathrm{H}} - \\mathbf{r}_{\\mathrm{Q}} = \\lambda (\\mathbf{r}_{\\mathrm{Q}} - \\mathbf{r}_{\\mathrm{M}})$, this condition implies that $\\lambda$ must be a positive scalar, so $|\\lambda| = \\lambda$. Therefore, the constraint simplifies to:\n$$\nL_{\\mathrm{QH}} = \\lambda |\\mathbf{r}_{\\mathrm{Q}} - \\mathbf{r}_{\\mathrm{M}}|\n$$\nSolving for $\\lambda$ yields the required analytic expression:\n$$\n\\lambda = \\frac{L_{\\mathrm{QH}}}{|\\mathbf{r}_{\\mathrm{Q}} - \\mathbf{r}_{\\mathrm{M}}|}\n$$\nThis expression gives $\\lambda$ in terms of the target link bond length $L_{\\mathrm{QH}}$ and the separation between the original bonded atoms $|\\mathbf{r}_{\\mathrm{Q}}-\\mathbf{r}_{\\mathrm{M}}|$.\n\nWe now proceed to the numerical calculation for the specific case provided.\nThe target bond length $L_{\\mathrm{QH}}$ is set by the sum of the covalent radii of a $\\mathrm{C_{sp^3}}$ atom (the quantum atom $\\text{Q}$) and a hydrogen atom (the link atom $\\text{H}$).\nGiven $r_{\\mathrm{cov}}(\\mathrm{C_{sp^3}}) = 0.77\\,\\text{\\AA}$ and $r_{\\mathrm{cov}}(\\mathrm{H}) = 0.31\\,\\text{\\AA}$:\n$$\nL_{\\mathrm{QH}} = r_{\\mathrm{cov}}(\\mathrm{C_{sp^3}}) + r_{\\mathrm{cov}}(\\mathrm{H}) = 0.77\\,\\text{\\AA} + 0.31\\,\\text{\\AA} = 1.08\\,\\text{\\AA}\n$$\nNext, we compute the separation $|\\mathbf{r}_{\\mathrm{Q}} - \\mathbf{r}_{\\mathrm{M}}|$. The position vectors are given in units of Ångströms as:\n$$\n\\mathbf{r}_{\\mathrm{M}} = \\begin{pmatrix} 0.350 \\\\ -0.120 \\\\ 0.980 \\end{pmatrix}, \\qquad\n\\mathbf{r}_{\\mathrm{Q}} = \\begin{pmatrix} 1.615 \\\\ 0.420 \\\\ 1.330 \\end{pmatrix}\n$$\nThe difference vector is:\n$$\n\\mathbf{r}_{\\mathrm{Q}} - \\mathbf{r}_{\\mathrm{M}} = \\begin{pmatrix} 1.615 - 0.350 \\\\ 0.420 - (-0.120) \\\\ 1.330 - 0.980 \\end{pmatrix} = \\begin{pmatrix} 1.265 \\\\ 0.540 \\\\ 0.350 \\end{pmatrix}\n$$\nThe magnitude of this vector is found using the Euclidean norm:\n$$\n|\\mathbf{r}_{\\mathrm{Q}} - \\mathbf{r}_{\\mathrm{M}}| = \\sqrt{(1.265)^{2} + (0.540)^{2} + (0.350)^{2}}\n$$\n$$\n|\\mathbf{r}_{\\mathrm{Q}} - \\mathbf{r}_{\\mathrm{M}}| = \\sqrt{1.600225 + 0.2916 + 0.1225} = \\sqrt{2.014325} \\approx 1.41926917\\,\\text{\\AA}\n$$\nThe initial C–C bond length is approximately $1.42\\,\\text{\\AA}$, which is a reasonable value, though shorter than a typical single bond.\n\nFinally, we substitute the numerical values for $L_{\\mathrm{QH}}$ and $|\\mathbf{r}_{\\mathrm{Q}} - \\mathbf{r}_{\\mathrm{M}}|$ into our derived expression for $\\lambda$:\n$$\n\\lambda = \\frac{1.08}{1.41926917} \\approx 0.7609653\n$$\nThe problem requires the answer to be rounded to four significant figures.\n$$\n\\lambda \\approx 0.7610\n$$\nThe trailing zero is significant and must be retained. This dimensionless scalar is the solution.", "answer": "$$\\boxed{0.7610}$$", "id": "2902779"}, {"introduction": "Once the mechanics of placing a link atom are understood, the critical question becomes a chemical one: where should the QM/MM boundary be drawn? This choice dramatically impacts the accuracy of a simulation, as carelessly cutting through polar or conjugated systems introduces severe electronic artifacts. This exercise challenges you to analyze the physical consequences of partitioning a molecule at two different locations, contrasting a nonpolar C–C bond cut with a polar C–O bond cut. By considering the loss of quantum effects like induction, hyperconjugation, and Pauli repulsion, you will develop the essential chemical intuition needed to design robust and physically meaningful QM/MM models. [@problem_id:2902682]", "problem": "Consider the ethanol molecule, $\\text{CH}_3\\text{-CH}_2\\text{-OH}$, described within a hybrid Quantum Mechanics/Molecular Mechanics (QM/MM) framework (Quantum Mechanics/Molecular Mechanics (QM/MM)). The total energy is modeled at the Born–Oppenheimer level by a partitioned Hamiltonian,\n$$\n\\hat{H}_{\\mathrm{tot}} = \\hat{H}_{\\mathrm{QM}} + \\hat{H}_{\\mathrm{MM}} + \\hat{H}_{\\mathrm{QM/MM}},\n$$\nwhere $\\hat{H}_{\\mathrm{QM}}$ acts on the electrons and nuclei in the quantum region, $\\hat{H}_{\\mathrm{MM}}$ is a classical force-field description of the molecular mechanics region, and $\\hat{H}_{\\mathrm{QM/MM}}$ accounts for the coupling (e.g., electrostatic embedding of point charges, van der Waals interactions, and removal of bonded terms that would otherwise be double-counted across a covalent cut).\n\nTo create a minimal boundary, one often uses a link-atom construction: the covalent bond across the QM/MM partition is severed, and the QM boundary valence is saturated by a link atom (commonly hydrogen), positioned colinear with the severed bond at a typical bond length (for example, $r_{\\mathrm{C-H}} \\approx 1.09\\,\\mathrm{\\AA}$). Denote by $q_i$ the MM point charges and by $\\mathbf{r}$ the electronic coordinate; in electrostatic embedding, the additional one-electron operator is approximately\n$$\n\\hat{V}_{\\mathrm{emb}}(\\mathbf{r}) = \\sum_i \\frac{q_i}{4\\pi\\varepsilon_0 \\lvert \\mathbf{r} - \\mathbf{R}_i \\rvert}.\n$$\n\nAnalyze the following two ethanol partitions and the physical implications of cutting different bonds:\n\n- Case $\\mathrm{I}$ (C–C cut): The QM region contains $\\text{HO-CH}_2$ (oxygen, hydroxyl hydrogen, and the $\\alpha$ carbon), while the $\\text{CH}_3$ methyl group is in the MM region. The cut is across the $\\text{C}_\\alpha\\text{-C}_\\beta$ bond, and a link hydrogen saturates the $C_\\alpha$ valence on the QM side.\n- Case $\\mathrm{II}$ (C–O cut): The QM region contains $\\text{CH}_3\\text{-CH}_2$ (the ethyl fragment), while the OH group is in the MM region. The cut is across the $\\text{C}_\\alpha\\text{-O}$ bond, and a link hydrogen saturates the $C_\\alpha$ valence on the QM side.\n\nUsing only fundamental considerations about the partitioned Hamiltonian, electrostatics from MM point charges, short-range exchange repulsion and Pauli effects (missing across a QM/MM covalent cut), and chemically reasonable orbital interactions (e.g., hyperconjugation $\\sigma \\to \\sigma^\\ast$ and lone-pair donation $n \\to \\sigma^\\ast$), determine which statement correctly identifies the dominant physical interactions that are lost or spuriously duplicated in each case and the boundary corrections required to control these errors.\n\nOptions:\nA. In Case $\\mathrm{I}$ (C–C cut), the dominant lost interactions are weak through-bond hyperconjugation between the $\\text{CH}_3$ group and the $\\text{C}_\\alpha\\text{-O}$ framework and mild inductive polarization of $\\mathrm{C_\\alpha}$ by $\\text{CH}_3$. A standard link-hydrogen plus removal of MM bonded terms that straddle the cut (e.g., $1$–$2$ and $1$–$3$ across-boundary terms) is typically sufficient; no special charge manipulation is required because the methyl fragment is only weakly polar. In Case $\\mathrm{II}$ (C–O cut), replacing a polar $\\mathrm{C-O}$ by a nonpolar $\\mathrm{C-H}$ link removes strong inductive polarization of $\\mathrm{C_\\alpha}$ by oxygen and the $n(\\mathrm{O}) \\to \\sigma^\\ast(\\mathrm{C-C})$ donation; moreover, a nearby MM oxygen point charge can overpolarize the QM density in $\\hat{V}_{\\mathrm{emb}}$ while Pauli repulsion across the broken bond is absent. Therefore, in addition to removing cross-boundary MM bonded terms, one should apply a boundary correction such as a charge-shift (setting or reducing $q_{\\mathrm{O}}$ and redistributing to neighbors) and/or a pseudobond/effective-core treatment on the QM side to emulate oxygen electronegativity and mitigate overpolarization.\n\nB. In Case $\\mathrm{I}$ (C–C cut), the methyl fragment is highly polarizing, so a charge-shift is essential; without it, strong inductive effects are lost. In Case $\\mathrm{II}$ (C–O cut), a link hydrogen faithfully reproduces the oxygen’s polarizing power, so no boundary correction beyond removing cross-boundary MM bonded terms is necessary, and no chemically significant orbital interactions are lost.\n\nC. The two cuts are physically equivalent: the same boundary correction suffices in both cases because only dispersion is lost across a QM/MM covalent cut. To restore dispersion and avoid double counting, one should keep the MM bonded terms across the cut and include electrostatics without modification.\n\nD. In Case $\\mathrm{I}$ (C–C cut), the dominant duplication error is electrostatic double counting because the link hydrogen carries an MM point charge that interacts with the QM density; thus one must delete the link-hydrogen MM charge. In Case $\\mathrm{II}$ (C–O cut), inductive and lone-pair donation effects are preserved automatically by electrostatic embedding, and dispersion is the only major lost interaction; therefore no charge-shift or pseudobond is warranted.", "solution": "The problem statement as presented is valid. It is scientifically grounded in the established principles of hybrid Quantum Mechanics/Molecular Mechanics (QM/MM) simulation, specifically the link-atom method for treating covalent bonds at the QM/MM boundary. The problem is well-posed, providing a clear and objective basis for a comparative analysis of two partitioning schemes for the ethanol molecule. The physical effects cited—electrostatic embedding, Pauli repulsion, induction, and hyperconjugation—are all standard concepts in this domain. A rigorous analysis based on these first principles is possible.\n\nThe core challenge in QM/MM partitioning across a covalent bond lies in how the electronic structure of the QM region is affected by the replacement of a QM atom with a classical MM description. The link-atom approach severs the bond, creating an open valence in the QM region, which is then saturated, typically by a hydrogen atom. The MM fragment interacts with the QM region only through the $\\hat{H}_{\\mathrm{QM/MM}}$ term, which in the electrostatic embedding scheme described, is dominated by the Coulomb interaction between the QM electron density and the MM point charges, $\\hat{V}_{\\mathrm{emb}}(\\mathbf{r})$. This scheme fails to capture short-range quantum effects such as Pauli repulsion, charge transfer, and exchange-correlation between the QM and MM fragments across the former bond. The quality of this approximation depends critically on the nature of the severed bond. A guiding principle is that QM/MM boundaries should not cut through highly polar bonds or conjugated systems if it can be avoided.\n\nAnalysis of Case $\\mathrm{I}$ (C–C cut):\nThe QM region is $\\mathrm{HO{-}CH_2}$ and the MM region is $\\mathrm{CH_3}$. The severed bond is the $\\mathrm{C_\\alpha{-}C_\\beta}$ bond. This bond connects two $sp^3$-hybridized carbon atoms and is characterized by low polarity. In the QM calculation, this $\\mathrm{C_\\alpha{-}C_\\beta}$ bond is replaced by a $\\mathrm{C_\\alpha{-}H}$ bond, where H is the link atom. A $\\mathrm{C{-}H}$ bond is also of low polarity. Therefore, the substitution of a methyl group with a hydrogen atom does not introduce a drastic perturbation to the local electronic environment of the $\\mathrm{C_\\alpha}$ atom. The primary quantum mechanical effects that are lost are:\n$1$. The inductive effect of the methyl group, which is weakly electron-donating. This is partially and imperfectly mimicked by the MM point charges on the methyl atoms through $\\hat{V}_{\\mathrm{emb}}$.\n$2$. Hyperconjugation, which involves orbital interactions like $\\sigma_{\\mathrm{C_\\beta H}} \\to \\sigma^\\ast_{\\mathrm{C_\\alpha O}}$. These through-bond delocalization effects are quantum mechanical in nature and are completely absent in the classical MM description.\n$3$. Pauli repulsion between the electron clouds of the QM fragment and the MM methyl group.\nGiven that these lost interactions are relatively weak for a $\\mathrm{C{-}C}$ bond, the standard link-atom scheme, supplemented by the removal of bonded MM terms (bonds, angles, dihedrals) that involve atoms from both regions to prevent double counting, is generally considered a reasonable approximation. No special charge modifications are typically deemed essential for such a nonpolar cut.\n\nAnalysis of Case $\\mathrm{II}$ (C–O cut):\nThe QM region is $\\mathrm{CH_3{-}CH_2}$ and the MM region is the $\\mathrm{OH}$ group. The severed bond is the $\\mathrm{C_\\alpha{-}O}$ bond. This bond is highly polar due to the large difference in electronegativity between carbon ($\\approx 2.55$) and oxygen ($\\approx 3.44$). In the QM calculation, the highly electronegative oxygen atom is replaced by a hydrogen link atom. This constitutes a severe electronic perturbation for the following reasons:\n$1$. Loss of strong inductive effect: The strong electron-withdrawing nature of the oxygen atom, which significantly polarizes the entire ethyl fragment, is lost. The QM system is modeled as ethane ($\\mathrm{CH_3{-}CH_3}$), which is nonpolar, a fundamentally poor representation of the polarized ethyl group in ethanol.\n$2$. Loss of lone-pair interactions: The oxygen atom possesses two lone pairs of electrons ($n_{\\mathrm{O}}$). These lone pairs can engage in hyperconjugative donation into antibonding orbitals of the ethyl group, such as $n_{\\mathrm{O}} \\to \\sigma^\\ast_{\\mathrm{C_\\alpha C_\\beta}}$. This significant quantum mechanical stabilizing interaction is completely absent.\n$3$. Spurious overpolarization: The MM oxygen atom carries a substantial negative point charge ($q_{\\mathrm{O}}$). In the electrostatic embedding Hamiltonian $\\hat{V}_{\\mathrm{emb}}$, this charge is located very close to the QM region. Without the corresponding Pauli repulsion from the oxygen atom's core and valence electrons (which are not present in the MM model), this large negative charge can unrealistically attract the QM electron density, causing it to \"spill out\" toward the MM atom. This is a well-known artifact called overpolarization.\n\nDue to these severe issues, cutting a polar bond like $\\mathrm{C{-}O}$ requires more sophisticated boundary corrections than the standard link-atom method. These include charge-shifting schemes (e.g., setting $q_{\\mathrm{O}}=0$ and redistributing the charge to other MM atoms further away to mitigate overpolarization) and/or using specialized potentials like pseudobonds or effective core potentials on the boundary QM atom ($\\mathrm{C_\\alpha}$) to better mimic the electronegativity and steric properties of the missing atom (oxygen).\n\nEvaluation of Options:\n\nA. This statement correctly identifies the lost interactions in Case $\\mathrm{I}$ as \"weak through-bond hyperconjugation\" and \"mild inductive polarization,\" and correctly concludes that a standard link-atom treatment is typically sufficient because the methyl group is weakly polar. For Case $\\mathrm{II}$, it correctly identifies the crucial issues: the removal of \"strong inductive polarization\" and \"$n(\\mathrm{O}) \\to \\sigma^\\ast(\\mathrm{C-C})$ donation\" by replacing a polar $\\mathrm{C-O}$ bond with a nonpolar $\\mathrm{C-H}$ link. It accurately describes the overpolarization artifact from the MM oxygen charge in the absence of Pauli repulsion. Finally, it correctly prescribes the necessary advanced corrections, such as a \"charge-shift\" or \"pseudobond/effective-core treatment\". This entire statement is in complete agreement with the principles of QM/MM theory.\nVerdict: **Correct**.\n\nB. This statement claims in Case $\\mathrm{I}$ that the methyl fragment is \"highly polarizing\" and requires a charge-shift. This is false; the methyl group is a weak donor and not highly polarizing. It claims in Case $\\mathrm{II}$ that a \"link hydrogen faithfully reproduces the oxygen’s polarizing power.\" This is fundamentally incorrect due to the vast difference in electronegativity between H and O. Consequently, its conclusion that no special corrections are needed is also false.\nVerdict: **Incorrect**.\n\nC. This statement begins with the false premise that the \"two cuts are physically equivalent.\" As established, cutting a nonpolar C–C bond and a highly polar C–O bond have vastly different physical and electronic consequences. It incorrectly claims that \"only dispersion is lost,\" ignoring induction, hyperconjugation, and Pauli repulsion. It also suggests keeping MM bonded terms across the cut, which would lead to a catastrophic double counting of forces.\nVerdict: **Incorrect**.\n\nD. This statement incorrectly identifies the dominant error in Case $\\mathrm{I}$ as electrostatic double counting from a link-hydrogen MM point charge. In standard implementations, the link atom does not have an MM point charge; it is purely a QM entity. For Case $\\mathrm{II}$, it falsely claims that \"inductive and lone-pair donation effects are preserved automatically by electrostatic embedding.\" This is the opposite of the truth; classical electrostatic embedding cannot capture these inherently quantum mechanical orbital effects, which is precisely why cutting polar bonds is problematic.\nVerdict: **Incorrect**.", "answer": "$$\\boxed{A}$$", "id": "2902682"}, {"introduction": "To address the limitations of the basic link atom method, more sophisticated boundary treatments such as Generalized Hybrid Orbitals (GHO) and Pseudobonds (PB) have been developed. This practice moves beyond qualitative analysis to a quantitative comparison of these methods within a simplified but powerful computational framework. Using a tight-binding (Hückel-type) model, you will design and implement a test to measure the energy and electron population artifacts introduced by each boundary scheme relative to a full quantum mechanical reference. This hands-on computational problem provides deep insight into how different theoretical approximations perform in practice and equips you with the skills to critically evaluate boundary methods. [@problem_id:2918439]", "problem": "Design a principled computational test to quantify artifacts introduced by different boundary treatments in Quantum Mechanics/Molecular Mechanics (QM/MM) partitioning when cutting a peptide bond at different locations. The goal is to measure how three common boundary treatments—link atom (LA), generalized hybrid orbital (GHO), and pseudobond (PB)—distort quantum-mechanical observables of the amide bond relative to a minimal full-quantum reference.\n\nBegin from the time-independent Schrödinger equation for a finite-dimensional tight-binding (Hückel-type) model, which is a well-tested abstraction for localized valence orbitals in quantum chemistry: for a Hamiltonian matrix $\\mathbf{H}$ and a wavefunction coefficient vector $\\mathbf{c}$, the eigenvalue problem is\n$$\n\\mathbf{H}\\,\\mathbf{c} \\;=\\; E\\,\\mathbf{c}.\n$$\nConsider a linear chain of sites that minimally represents the amide $\\pi$ system and its immediate environment. Use a one-electron picture with a single doubly occupied molecular orbital: the observable energy per electron is the lowest eigenvalue $E_{\\min}$, and the site populations are given by the squared moduli of the components of the normalized eigenvector corresponding to $E_{\\min}$.\n\nDefine the following models.\n\n- Full reference models:\n  - Left-environment model (cut at the $\\mathrm{C_{\\alpha}}$–$\\mathrm{C}$ bond): a three-site Hamiltonian with ordering $\\left[\\mathrm{L},\\mathrm{C},\\mathrm{N}\\right]$,\n    $$\n    \\mathbf{H}_{\\mathrm{full}}^{\\mathrm{left}} \\;=\\;\n    \\begin{bmatrix}\n    \\varepsilon_{\\mathrm{L}} & t_{\\mathrm{LC}} & 0 \\\\\n    t_{\\mathrm{LC}} & \\varepsilon_{\\mathrm{C}} & t_{\\mathrm{CN}} \\\\\n    0 & t_{\\mathrm{CN}} & \\varepsilon_{\\mathrm{N}}\n    \\end{bmatrix}.\n    $$\n  - Right-environment model (cut at the $\\mathrm{N}$–$\\mathrm{C'}$ bond): a three-site Hamiltonian with ordering $\\left[\\mathrm{C},\\mathrm{N},\\mathrm{R}\\right]$,\n    $$\n    \\mathbf{H}_{\\mathrm{full}}^{\\mathrm{right}} \\;=\\;\n    \\begin{bmatrix}\n    \\varepsilon_{\\mathrm{C}} & t_{\\mathrm{CN}} & 0 \\\\\n    t_{\\mathrm{CN}} & \\varepsilon_{\\mathrm{N}} & t_{\\mathrm{NR}} \\\\\n    0 & t_{\\mathrm{NR}} & \\varepsilon_{\\mathrm{R}}\n    \\end{bmatrix}.\n    $$\n  In both cases, diagonal elements are site energies in electronvolt (eV), and off-diagonal elements are nearest-neighbor couplings in electronvolt (eV). The lowest eigenvalue $E_{\\min}^{\\mathrm{full}}$ and its normalized eigenvector $\\mathbf{c}^{\\mathrm{full}}$ provide the reference.\n\n- Reduced two-site quantum region for the amide bond $\\left[\\mathrm{C},\\mathrm{N}\\right]$:\n  $$\n  \\mathbf{H}_{\\mathrm{QM}} \\;=\\;\n  \\begin{bmatrix}\n  \\varepsilon_{\\mathrm{C}}^{\\mathrm{eff}} & t_{\\mathrm{CN}}^{\\mathrm{eff}} \\\\\n  t_{\\mathrm{CN}}^{\\mathrm{eff}} & \\varepsilon_{\\mathrm{N}}^{\\mathrm{eff}}\n  \\end{bmatrix},\n  $$\n  where the effective parameters $\\varepsilon_{\\mathrm{C}}^{\\mathrm{eff}}$, $\\varepsilon_{\\mathrm{N}}^{\\mathrm{eff}}$, and $t_{\\mathrm{CN}}^{\\mathrm{eff}}$ depend on the boundary treatment and on which side is cut.\n\nDefine three boundary treatments with the following effective parameter rules, grounded in second-order Löwdin partitioning and physically motivated approximations.\n\n- Link atom (LA): replace the missing covalent partner by a hydrogen-like link that modifies only the boundary-site onsite energy via second-order perturbation, leaving the internal coupling unchanged.\n  - For a left cut, the boundary site is $\\mathrm{C}$:\n    $$\n    \\varepsilon_{\\mathrm{C}}^{\\mathrm{eff}} \\;=\\; \\varepsilon_{\\mathrm{C}} \\;+\\; \\frac{t_{\\mathrm{CH}}^{2}}{\\varepsilon_{\\mathrm{C}} - \\varepsilon_{\\mathrm{H}}}, \n    \\quad\n    \\varepsilon_{\\mathrm{N}}^{\\mathrm{eff}} \\;=\\; \\varepsilon_{\\mathrm{N}},\n    \\quad\n    t_{\\mathrm{CN}}^{\\mathrm{eff}} \\;=\\; t_{\\mathrm{CN}}.\n    $$\n  - For a right cut, the boundary site is $\\mathrm{N}$:\n    $$\n    \\varepsilon_{\\mathrm{N}}^{\\mathrm{eff}} \\;=\\; \\varepsilon_{\\mathrm{N}} \\;+\\; \\frac{t_{\\mathrm{NH}}^{2}}{\\varepsilon_{\\mathrm{N}} - \\varepsilon_{\\mathrm{H}}}, \n    \\quad\n    \\varepsilon_{\\mathrm{C}}^{\\mathrm{eff}} \\;=\\; \\varepsilon_{\\mathrm{C}},\n    \\quad\n    t_{\\mathrm{CN}}^{\\mathrm{eff}} \\;=\\; t_{\\mathrm{CN}}.\n    $$\n\n- Generalized hybrid orbital (GHO): model the rehybridization at the cut by combining a partial second-order onsite shift with a reduction of the internal coupling to account for hybrid occupancy toward the environment.\n  - Let $\\alpha$ be a reduction factor with $0 < \\alpha < 1$. Define\n    $$\n    f \\;=\\; \\frac{t_{\\mathrm{env}}^{2}}{t_{\\mathrm{env}}^{2} + t_{\\mathrm{CN}}^{2}}, \n    \\quad s \\;=\\; \\sqrt{1 - f}.\n    $$\n    For a left cut:\n    $$\n    \\varepsilon_{\\mathrm{C}}^{\\mathrm{eff}} \\;=\\; \\varepsilon_{\\mathrm{C}} \\;+\\; \\alpha\\,\\frac{t_{\\mathrm{LC}}^{2}}{\\varepsilon_{\\mathrm{C}} - \\varepsilon_{\\mathrm{L}}},\n    \\quad\n    \\varepsilon_{\\mathrm{N}}^{\\mathrm{eff}} \\;=\\; \\varepsilon_{\\mathrm{N}},\n    \\quad\n    t_{\\mathrm{CN}}^{\\mathrm{eff}} \\;=\\; s\\,t_{\\mathrm{CN}}.\n    $$\n    For a right cut:\n    $$\n    \\varepsilon_{\\mathrm{N}}^{\\mathrm{eff}} \\;=\\; \\varepsilon_{\\mathrm{N}} \\;+\\; \\alpha\\,\\frac{t_{\\mathrm{NR}}^{2}}{\\varepsilon_{\\mathrm{N}} - \\varepsilon_{\\mathrm{R}}},\n    \\quad\n    \\varepsilon_{\\mathrm{C}}^{\\mathrm{eff}} \\;=\\; \\varepsilon_{\\mathrm{C}},\n    \\quad\n    t_{\\mathrm{CN}}^{\\mathrm{eff}} \\;=\\; s\\,t_{\\mathrm{CN}}.\n    $$\n\n- Pseudobond (PB): integrate out the environment at second order to obtain an effective onsite shift on the boundary site, leaving the internal coupling unchanged (energy-independent approximation at a reference equal to the boundary-site energy).\n  - For a left cut:\n    $$\n    \\varepsilon_{\\mathrm{C}}^{\\mathrm{eff}} \\;=\\; \\varepsilon_{\\mathrm{C}} \\;+\\; \\frac{t_{\\mathrm{LC}}^{2}}{\\varepsilon_{\\mathrm{C}} - \\varepsilon_{\\mathrm{L}}},\n    \\quad\n    \\varepsilon_{\\mathrm{N}}^{\\mathrm{eff}} \\;=\\; \\varepsilon_{\\mathrm{N}},\n    \\quad\n    t_{\\mathrm{CN}}^{\\mathrm{eff}} \\;=\\; t_{\\mathrm{CN}}.\n    $$\n  - For a right cut:\n    $$\n    \\varepsilon_{\\mathrm{N}}^{\\mathrm{eff}} \\;=\\; \\varepsilon_{\\mathrm{N}} \\;+\\; \\frac{t_{\\mathrm{NR}}^{2}}{\\varepsilon_{\\mathrm{N}} - \\varepsilon_{\\mathrm{R}}},\n    \\quad\n    \\varepsilon_{\\mathrm{C}}^{\\mathrm{eff}} \\;=\\; \\varepsilon_{\\mathrm{C}},\n    \\quad\n    t_{\\mathrm{CN}}^{\\mathrm{eff}} \\;=\\; t_{\\mathrm{CN}}.\n    $$\n\nFor any case, define the following quantitative artifacts.\n\n- Energy-level artifact (in electronvolt, eV): let $E_{\\min}^{\\mathrm{full}}$ be the lowest eigenvalue of the relevant $\\mathbf{H}_{\\mathrm{full}}$ and $E_{\\min}^{\\mathrm{method}}$ be the lowest eigenvalue of $\\mathbf{H}_{\\mathrm{QM}}$ built by the boundary method. Define\n  $$\n  \\Delta E \\;=\\; E_{\\min}^{\\mathrm{method}} \\;-\\; E_{\\min}^{\\mathrm{full}} \\quad \\text{(in eV)}.\n  $$\n\n- Population artifact (dimensionless): let $\\mathbf{c}^{\\mathrm{full}}$ be the normalized eigenvector for $E_{\\min}^{\\mathrm{full}}$ for the full model, and let $\\mathbf{u}^{\\mathrm{method}}$ be the normalized eigenvector for $E_{\\min}^{\\mathrm{method}}$ for the two-site model. Define the quantum-region indices $\\mathcal{Q}=\\{\\mathrm{C},\\mathrm{N}\\}$. Compute the full-model populations on the quantum region, renormalized within that region:\n  $$\n  p_{\\mathrm{C}}^{\\mathrm{full}} \\;=\\; \\frac{|c_{\\mathrm{C}}^{\\mathrm{full}}|^{2}}{|c_{\\mathrm{C}}^{\\mathrm{full}}|^{2} + |c_{\\mathrm{N}}^{\\mathrm{full}}|^{2}}, \n  \\quad\n  p_{\\mathrm{N}}^{\\mathrm{full}} \\;=\\; \\frac{|c_{\\mathrm{N}}^{\\mathrm{full}}|^{2}}{|c_{\\mathrm{C}}^{\\mathrm{full}}|^{2} + |c_{\\mathrm{N}}^{\\mathrm{full}}|^{2}}.\n  $$\n  Compute the method-model populations $p_{\\mathrm{C}}^{\\mathrm{method}} = |u_{\\mathrm{C}}^{\\mathrm{method}}|^{2}$ and $p_{\\mathrm{N}}^{\\mathrm{method}} = |u_{\\mathrm{N}}^{\\mathrm{method}}|^{2}$. The population artifact is the Euclidean norm\n  $$\n  D \\;=\\; \\sqrt{\\left(p_{\\mathrm{C}}^{\\mathrm{method}} - p_{\\mathrm{C}}^{\\mathrm{full}}\\right)^{2} + \\left(p_{\\mathrm{N}}^{\\mathrm{method}} - p_{\\mathrm{N}}^{\\mathrm{full}}\\right)^{2}}.\n  $$\n\nImplement a program that, for each test case below, constructs the appropriate full and reduced Hamiltonians, computes $\\Delta E$ and $D$, and reports the outputs.\n\nUse the following constants and parameter values, all expressed in electronvolt (eV) for energies and couplings:\n\n- Core amide parameters:\n  - $\\varepsilon_{\\mathrm{C}} = -10.0$,\n  - $\\varepsilon_{\\mathrm{N}} = -12.0$,\n  - $t_{\\mathrm{CN}} = -2.0$.\n- Environment parameters (used in the full models):\n  - $\\varepsilon_{\\mathrm{L}} = \\varepsilon_{\\mathrm{R}} = -11.0$,\n  - $t_{\\mathrm{LC}}$ and $t_{\\mathrm{NR}}$ will be specified per test case as $t_{\\mathrm{env}}$.\n- Link-atom parameters (used only in LA effective models):\n  - $\\varepsilon_{\\mathrm{H}} = -13.6$,\n  - $t_{\\mathrm{CH}} = t_{\\mathrm{NH}} = -1.0$.\n- Generalized hybrid orbital scaling parameter:\n  - $\\alpha = 0.5$.\n\nDefine the test suite of six cases to probe different facets:\n\n- Case $\\mathrm{A}$: left cut with LA, $t_{\\mathrm{env}} = -1.0$.\n- Case $\\mathrm{B}$: left cut with GHO, $t_{\\mathrm{env}} = -1.0$.\n- Case $\\mathrm{C}$: left cut with PB, $t_{\\mathrm{env}} = -1.0$.\n- Case $\\mathrm{D}$: right cut with LA, $t_{\\mathrm{env}} = -1.0$.\n- Case $\\mathrm{E}$ (edge, weak coupling): left cut with LA, $t_{\\mathrm{env}} = -0.1$.\n- Case $\\mathrm{F}$ (edge, strong coupling): left cut with PB, $t_{\\mathrm{env}} = -3.0$.\n\nAngle units are not applicable. Energies must be reported in electronvolt (eV). The population artifacts are dimensionless. Your program must produce a single line of output containing the results for all six cases as a comma-separated list enclosed in square brackets, ordered as\n$$\n\\left[\\Delta E_{\\mathrm{A}},\\, D_{\\mathrm{A}},\\, \\Delta E_{\\mathrm{B}},\\, D_{\\mathrm{B}},\\, \\Delta E_{\\mathrm{C}},\\, D_{\\mathrm{C}},\\, \\Delta E_{\\mathrm{D}},\\, D_{\\mathrm{D}},\\, \\Delta E_{\\mathrm{E}},\\, D_{\\mathrm{E}},\\, \\Delta E_{\\mathrm{F}},\\, D_{\\mathrm{F}}\\right],\n$$\nwith each floating-point number rounded to $6$ decimals. Express $\\Delta E$ in electronvolt (eV), and $D$ as a dimensionless number. No other text should be printed. The final program must be complete and runnable without external input or files.", "solution": "The problem posed is a well-defined exercise in computational quantum chemistry. It is scientifically grounded in the principles of tight-binding theory and QM/MM boundary methods, mathematically consistent, and provides a complete set of parameters and definitions required for a unique solution. The task is to formulate and implement a computational procedure to quantify artifacts arising from different covalent bond-cutting schemes in a simplified model of a peptide. The problem is therefore deemed valid and a rigorous solution will be provided.\n\nThe core of the problem is to solve the time-independent Schrödinger equation, represented as a matrix eigenvalue problem $\\mathbf{H}\\,\\mathbf{c} = E\\,\\mathbf{c}$, for several model Hamiltonians and compare the results. The solution can be systematically constructed by following a three-step process for each test case: first, establish the full-quantum reference; second, construct the reduced two-site quantum mechanics (QM) model based on the specified boundary treatment; and third, compute the defined artifacts by comparing the observables from the two models.\n\nThe reference calculation begins with the construction of a $3 \\times 3$ Hamiltonian matrix, $\\mathbf{H}_{\\mathrm{full}}$, representing the unpartitioned system. The system comprises the amide bond atoms, Carbon ($C$) and Nitrogen ($N$), plus one environmental site, either from the Left ($L$) or Right ($R$). For a cut on the left side, the ordered basis is $[\\mathrm{L}, \\mathrm{C}, \\mathrm{N}]$, and the Hamiltonian is:\n$$\n\\mathbf{H}_{\\mathrm{full}}^{\\mathrm{left}} =\n\\begin{bmatrix}\n\\varepsilon_{\\mathrm{L}} & t_{\\mathrm{LC}} & 0 \\\\\nt_{\\mathrm{LC}} & \\varepsilon_{\\mathrm{C}} & t_{\\mathrm{CN}} \\\\\n0 & t_{\\mathrm{CN}} & \\varepsilon_{\\mathrm{N}}\n\\end{bmatrix}\n$$\nFor a cut on the right side, the basis is $[\\mathrm{C}, \\mathrm{N}, \\mathrm{R}]$, and the Hamiltonian is:\n$$\n\\mathbf{H}_{\\mathrm{full}}^{\\mathrm{right}} =\n\\begin{bmatrix}\n\\varepsilon_{\\mathrm{C}} & t_{\\mathrm{CN}} & 0 \\\\\nt_{\\mathrm{CN}} & \\varepsilon_{\\mathrm{N}} & t_{\\mathrm{NR}} \\\\\n0 & t_{\\mathrm{NR}} & \\varepsilon_{\\mathrm{R}}\n\\end{bmatrix}\n$$\nThe parameters $\\varepsilon_i$ are the on-site energies and $t_{ij}$ are the coupling terms. Since these matrices are real and symmetric, their eigenvalues are real and eigenvectors are orthogonal. We solve the eigenvalue problem for $\\mathbf{H}_{\\mathrm{full}}$ to find its lowest eigenvalue, $E_{\\min}^{\\mathrm{full}}$, and the corresponding normalized eigenvector, $\\mathbf{c}^{\\mathrm{full}} = [c_1, c_2, c_3]^T$. The vector components for the QM region, $c_{\\mathrm{C}}^{\\mathrm{full}}$ and $c_{\\mathrm{N}}^{\\mathrm{full}}$, are then extracted. Their squared moduli are used to compute the reference populations within the QM region, after renormalization:\n$$\np_{\\mathrm{C}}^{\\mathrm{full}} = \\frac{|c_{\\mathrm{C}}^{\\mathrm{full}}|^{2}}{|c_{\\mathrm{C}}^{\\mathrm{full}}|^{2} + |c_{\\mathrm{N}}^{\\mathrm{full}}|^{2}}, \\quad p_{\\mathrm{N}}^{\\mathrm{full}} = 1 - p_{\\mathrm{C}}^{\\mathrm{full}}\n$$\n\nNext, we construct the effective $2 \\times 2$ Hamiltonian, $\\mathbf{H}_{\\mathrm{QM}}$, for the reduced two-site QM region $[\\mathrm{C}, \\mathrm{N}]$:\n$$\n\\mathbf{H}_{\\mathrm{QM}} =\n\\begin{bmatrix}\n\\varepsilon_{\\mathrm{C}}^{\\mathrm{eff}} & t_{\\mathrm{CN}}^{\\mathrm{eff}} \\\\\nt_{\\mathrm{CN}}^{\\mathrm{eff}} & \\varepsilon_{\\mathrm{N}}^{\\mathrm{eff}}\n\\end{bmatrix}\n$$\nThe effective parameters depend on the boundary treatment method—Link Atom (LA), Generalized Hybrid Orbital (GHO), or Pseudobond (PB)—and the location of the cut.\n\nFor the Link Atom (LA) method, the environment is replaced by a hydrogen-like atom. For a left cut, this modifies the energy of the boundary site $\\mathrm{C}$:\n$$\n\\varepsilon_{\\mathrm{C}}^{\\mathrm{eff}} = \\varepsilon_{\\mathrm{C}} + \\frac{t_{\\mathrm{CH}}^{2}}{\\varepsilon_{\\mathrm{C}} - \\varepsilon_{\\mathrm{H}}}\n$$\nThe other parameters remain unchanged: $\\varepsilon_{\\mathrm{N}}^{\\mathrm{eff}} = \\varepsilon_{\\mathrm{N}}$ and $t_{\\mathrm{CN}}^{\\mathrm{eff}} = t_{\\mathrm{CN}}$. A similar correction is applied to $\\varepsilon_{\\mathrm{N}}$ for a right cut, using $t_{\\mathrm{NH}}$.\n\nFor the Generalized Hybrid Orbital (GHO) method, both the on-site energy and the internal coupling are adjusted. For a left cut, with $t_{\\mathrm{env}} = t_{\\mathrm{LC}}$, we define factors $f = \\frac{t_{\\mathrm{env}}^{2}}{t_{\\mathrm{env}}^{2} + t_{\\mathrm{CN}}^{2}}$ and $s = \\sqrt{1 - f}$. The effective parameters are:\n$$\n\\varepsilon_{\\mathrm{C}}^{\\mathrm{eff}} = \\varepsilon_{\\mathrm{C}} + \\alpha\\,\\frac{t_{\\mathrm{LC}}^{2}}{\\varepsilon_{\\mathrm{C}} - \\varepsilon_{\\mathrm{L}}}, \\quad \\varepsilon_{\\mathrm{N}}^{\\mathrm{eff}} = \\varepsilon_{\\mathrm{N}}, \\quad t_{\\mathrm{CN}}^{\\mathrm{eff}} = s\\,t_{\\mathrm{CN}}\n$$\nwhere $\\alpha$ is a scaling factor. An analogous rule applies for a right cut.\n\nFor the Pseudobond (PB) method, the effect of the environment is integrated out via a second-order perturbation correction to the boundary site's energy. For a left cut, this is:\n$$\n\\varepsilon_{\\mathrm{C}}^{\\mathrm{eff}} = \\varepsilon_{\\mathrm{C}} + \\frac{t_{\\mathrm{LC}}^{2}}{\\varepsilon_{\\mathrm{C}} - \\varepsilon_{\\mathrm{L}}}\n$$\nThe other parameters are unchanged: $\\varepsilon_{\\mathrm{N}}^{\\mathrm{eff}} = \\varepsilon_{\\mathrm{N}}$ and $t_{\\mathrm{CN}}^{\\mathrm{eff}} = t_{\\mathrm{CN}}$. A similar rule applies for a right cut. This method is identical in form to the LA method, but crucially uses the actual environment parameters ($\\varepsilon_{\\mathrm{L}}$, $t_{\\mathrm{LC}}$) instead of standardized link atom parameters ($\\varepsilon_{\\mathrm{H}}$, $t_{\\mathrm{CH}}$).\n\nOnce $\\mathbf{H}_{\\mathrm{QM}}$ is constructed for a given method, we solve its eigenvalue problem to find the lowest eigenvalue, $E_{\\min}^{\\mathrm{method}}$, and its corresponding normalized eigenvector, $\\mathbf{u}^{\\mathrm{method}} = [u_{\\mathrm{C}}, u_{\\mathrm{N}}]^T$. The populations for the method are then simply $p_{\\mathrm{C}}^{\\mathrm{method}} = |u_{\\mathrm{C}}|^{2}$ and $p_{\\mathrm{N}}^{\\mathrm{method}} = |u_{\\mathrm{N}}|^{2}$.\n\nFinally, the artifacts are computed. The energy-level artifact, $\\Delta E$, measures the absolute error in the ground state energy:\n$$\n\\Delta E = E_{\\min}^{\\mathrm{method}} - E_{\\min}^{\\mathrm{full}}\n$$\nThe population artifact, $D$, quantifies the distortion of the electron distribution within the QM region as the Euclidean distance between the population vectors:\n$$\nD = \\sqrt{\\left(p_{\\mathrm{C}}^{\\mathrm{method}} - p_{\\mathrm{C}}^{\\mathrm{full}}\\right)^{2} + \\left(p_{\\mathrm{N}}^{\\mathrm{method}} - p_{\\mathrm{N}}^{\\mathrm{full}}\\right)^{2}}\n$$\nThis protocol is applied to each of the six specified test cases. A computational program will implement these steps, using a numerical linear algebra library to solve the eigenvalue problems for the $3 \\times 3$ and $2 \\times 2$ matrices. The final output is an ordered list of the computed artifacts $(\\Delta E, D)$ for each case.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the QM/MM boundary artifact problem by calculating energy and\n    population artifacts for six test cases.\n    \"\"\"\n\n    # Define constants and parameters in electronvolt (eV)\n    params = {\n        'eps_C': -10.0,\n        'eps_N': -12.0,\n        't_CN': -2.0,\n        'eps_L': -11.0,\n        'eps_R': -11.0,  # Same as eps_L as per problem\n        'eps_H': -13.6,\n        't_CH': -1.0,\n        't_NH': -1.0,    # Same as t_CH as per problem\n        'alpha': 0.5,\n    }\n\n    # Define the six test cases\n    # Each tuple: (case_name, cut_side, method, t_env)\n    test_cases = [\n        ('A', 'left', 'LA', -1.0),\n        ('B', 'left', 'GHO', -1.0),\n        ('C', 'left', 'PB', -1.0),\n        ('D', 'right', 'LA', -1.0),\n        ('E', 'left', 'LA', -0.1),\n        ('F', 'left', 'PB', -3.0),\n    ]\n\n    results = []\n    \n    for _, cut_side, method, t_env in test_cases:\n        # Step 1: Construct and solve the full reference model\n        if cut_side == 'left':\n            t_LC = t_env\n            H_full = np.array([\n                [params['eps_L'], t_LC, 0],\n                [t_LC, params['eps_C'], params['t_CN']],\n                [0, params['t_CN'], params['eps_N']]\n            ])\n            # QM region corresponds to indices 1 (C) and 2 (N)\n            qm_indices = [1, 2]\n        else: # cut_side == 'right'\n            t_NR = t_env\n            H_full = np.array([\n                [params['eps_C'], params['t_CN'], 0],\n                [params['t_CN'], params['eps_N'], t_NR],\n                [0, t_NR, params['eps_R']]\n            ])\n            # QM region corresponds to indices 0 (C) and 1 (N)\n            qm_indices = [0, 1]\n\n        evals_full, evecs_full = np.linalg.eigh(H_full)\n        E_min_full = evals_full[0]\n        c_full = evecs_full[:, 0]\n\n        # Step 2: Calculate reference populations\n        c_C_full = c_full[qm_indices[0]]\n        c_N_full = c_full[qm_indices[1]]\n        \n        pop_C_full_unnorm = c_C_full**2\n        pop_N_full_unnorm = c_N_full**2\n        norm_factor = pop_C_full_unnorm + pop_N_full_unnorm\n        \n        p_C_full = pop_C_full_unnorm / norm_factor\n        p_N_full = pop_N_full_unnorm / norm_factor\n        \n        # Step 3: Construct the reduced QM model based on the method\n        eps_C_eff = params['eps_C']\n        eps_N_eff = params['eps_N']\n        t_CN_eff = params['t_CN']\n\n        if method == 'LA':\n            if cut_side == 'left':\n                eps_C_eff += params['t_CH']**2 / (params['eps_C'] - params['eps_H'])\n            else: # right\n                eps_N_eff += params['t_NH']**2 / (params['eps_N'] - params['eps_H'])\n        \n        elif method == 'GHO':\n            f = t_env**2 / (t_env**2 + params['t_CN']**2)\n            s = np.sqrt(1 - f)\n            t_CN_eff = s * params['t_CN']\n            if cut_side == 'left':\n                eps_C_eff += params['alpha'] * t_env**2 / (params['eps_C'] - params['eps_L'])\n            else: # right\n                eps_N_eff += params['alpha'] * t_env**2 / (params['eps_N'] - params['eps_R'])\n\n        elif method == 'PB':\n            if cut_side == 'left':\n                eps_C_eff += t_env**2 / (params['eps_C'] - params['eps_L'])\n            else: # right\n                eps_N_eff += t_env**2 / (params['eps_N'] - params['eps_R'])\n\n        H_QM = np.array([\n            [eps_C_eff, t_CN_eff],\n            [t_CN_eff, eps_N_eff]\n        ])\n\n        # Step 4: Solve the QM model\n        evals_method, evecs_method = np.linalg.eigh(H_QM)\n        E_min_method = evals_method[0]\n        u_method = evecs_method[:, 0]\n\n        p_C_method = u_method[0]**2\n        p_N_method = u_method[1]**2\n        \n        # Step 5: Calculate artifacts\n        delta_E = E_min_method - E_min_full\n        D = np.sqrt((p_C_method - p_C_full)**2 + (p_N_method - p_N_full)**2)\n\n        results.extend([delta_E, D])\n\n    # Final print statement in the exact required format\n    # The format string ensures each number is rounded to 6 decimal places.\n    output_str = f\"[{','.join([f'{r:.6f}' for r in results])}]\"\n    print(output_str)\n\nsolve()\n```", "id": "2918439"}]}