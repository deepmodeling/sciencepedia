{"hands_on_practices": [{"introduction": "The heart of the Fewest-Switches Surface Hopping (FSSH) method lies in the crucial decision of when a trajectory, representing the nuclei, should switch between potential energy surfaces. This decision is not arbitrary; it is governed by a probability derived from the rate of population flow between adiabatic states, as dictated by the time-dependent Schrödinger equation. This exercise [@problem_id:2928383] guides you through the foundational derivation of this hopping probability, connecting the underlying quantum mechanics to the practical FSSH algorithm and highlighting the important role of phase coherence between electronic state amplitudes.", "problem": "Consider a two-state non-adiabatic dynamics problem treated within the Fewest Switches Surface Hopping (FSSH) framework. Let the electronic wavefunction be expanded in the adiabatic basis as $\\Psi(\\mathbf{r},\\mathbf{R},t)=\\sum_{k} c_k(t)\\,\\phi_k(\\mathbf{r};\\mathbf{R}(t))$, where the nuclear trajectory $\\mathbf{R}(t)$ evolves classically. The time-dependent Schrödinger equation in the adiabatic representation implies a coupling between amplitudes $\\{c_k(t)\\}$ through the nuclear velocity $\\mathbf{v}(t)=\\dot{\\mathbf{R}}(t)$ and the non-adiabatic derivative couplings $d_{ij}(\\mathbf{R})=\\langle \\phi_i(\\mathbf{R})|\\nabla_{\\mathbf{R}}\\phi_j(\\mathbf{R})\\rangle$. Assume orthonormal adiabatic states that are sufficiently smooth in $\\mathbf{R}$ so that the derivative couplings are well-defined.\n\nStarting from these fundamentals and the requirement that the ensemble-averaged population transfer between adiabatic states induced by hops matches, to leading order in the time step $\\Delta t$, the population flow dictated by the time-dependent Schrödinger equation, derive the leading-order expression for the probability of a hop from state $i$ to state $j$ over a single time step $\\Delta t$ in terms of $c_i$, $c_j$, $\\mathbf{v}$, and $d_{ij}$.\n\nThen, evaluate this hop probability for the following data at a given instant:\n- $c_i = 0.8\\,\\exp(i\\theta_i)$ and $c_j = 0.6\\,\\exp(i\\theta_j)$ with $\\theta_j-\\theta_i=\\pi/3$ (radians),\n- $\\Delta t = 5.0\\times 10^{-16}\\ \\mathrm{s}$,\n- $\\mathbf{v}=(1500\\ \\mathrm{m\\,s^{-1}})\\,\\hat{\\mathbf{x}}+(1000\\ \\mathrm{m\\,s^{-1}})\\,\\hat{\\mathbf{y}}+0\\,\\hat{\\mathbf{z}}$,\n- $d_{ij}=(1.0\\times 10^{10}\\ \\mathrm{m^{-1}})\\,\\hat{\\mathbf{x}}+(1.0\\times 10^{10}\\ \\mathrm{m^{-1}})\\,\\hat{\\mathbf{y}}+0\\,\\hat{\\mathbf{z}}$.\n\nAssume the adiabatic electronic states are chosen real at this geometry so that $d_{ij}$ is real. Discuss qualitatively how the hop probability depends on the relative phase between $c_i$ and $c_j$, and the role of the phase choice (gauge) for the adiabatic states.\n\nExpress the final hop probability as a pure number (dimensionless) and round your answer to four significant figures.", "solution": "The problem statement has been evaluated and is deemed valid. It is scientifically grounded in the principles of non-adiabatic quantum dynamics, specifically the Fewest Switches Surface Hopping (FSSH) method. The problem is well-posed, objective, self-contained, and all provided data are physically and dimensionally consistent. The populations of the two states sum to unity, $|c_i|^2+|c_j|^2 = (0.8)^2+(0.6)^2 = 0.64+0.36 = 1.0$, as required. We may therefore proceed with the solution.\n\nThe solution is structured in three parts: first, the derivation of the hopping probability formula from fundamental principles; second, the numerical evaluation for the given data; and third, a discussion of the roles of phase and gauge.\n\n**1. Derivation of the Hopping Probability**\n\nThe evolution of the electronic wavefunction $\\Psi(\\mathbf{r},\\mathbf{R},t)=\\sum_{k} c_k(t)\\,\\phi_k(\\mathbf{r};\\mathbf{R}(t))$ is governed by the time-dependent Schrödinger equation (TDSE). In the adiabatic representation, the equation of motion for the complex amplitudes $c_k(t)$ is given by:\n$$ i\\hbar\\frac{d c_k(t)}{dt} = E_k(\\mathbf{R}) c_k(t) - i\\hbar \\sum_j \\mathbf{v}(t) \\cdot d_{kj}(\\mathbf{R}) c_j(t) $$\nwhere $E_k$ are the adiabatic potential energy surfaces, $\\mathbf{v}(t) = \\dot{\\mathbf{R}}(t)$ is the classical nuclear velocity, and $d_{kj} = \\langle \\phi_k | \\nabla_{\\mathbf{R}} \\phi_j \\rangle$ are the non-adiabatic derivative couplings. For simplicity, we shall work in atomic units where $\\hbar=1$.\n$$ \\frac{d c_k}{dt} = -i E_k c_k - \\sum_j (\\mathbf{v} \\cdot d_{kj}) c_j $$\nWe are interested in the rate of change of the population of a given state $j$, which is $\\rho_j(t) = |c_j(t)|^2 = c_j^*(t)c_j(t)$. Using the product rule, the time derivative is:\n$$ \\frac{d\\rho_j}{dt} = \\frac{dc_j^*}{dt}c_j + c_j^*\\frac{dc_j}{dt} $$\nThe complex conjugate of the equation for $c_j$ is:\n$$ \\frac{dc_j^*}{dt} = i E_j c_j^* - \\sum_k (\\mathbf{v} \\cdot d_{jk})^* c_k^* $$\nFrom the definition of the derivative coupling, it can be shown that $d_{jk}^* = -d_{kj}$. For the specific case of real adiabatic wavefunctions, as assumed in the problem, this simplifies to $d_{jk}$ being real and antisymmetric, $d_{jk}=-d_{kj}$. We use the more general relation $d_{jk}^* = -d_{kj}$.\n$$ \\frac{dc_j^*}{dt} = i E_j c_j^* + \\sum_k (\\mathbf{v} \\cdot d_{kj}) c_k^* $$\nSubstituting the expressions for $\\dot{c}_j$ and $\\dot{c}_j^*$ into the derivative of $\\rho_j$:\n$$ \\frac{d\\rho_j}{dt} = \\left( i E_j c_j^* + \\sum_k (\\mathbf{v} \\cdot d_{kj}) c_k^* \\right) c_j + c_j^* \\left( -i E_j c_j - \\sum_k (\\mathbf{v} \\cdot d_{jk}) c_k \\right) $$\nThe terms involving the energy $E_j$ cancel:\n$$ \\frac{d\\rho_j}{dt} = \\sum_k \\left[ (\\mathbf{v} \\cdot d_{kj}) c_k^* c_j - (\\mathbf{v} \\cdot d_{jk}) c_j^* c_k \\right] $$\nRearranging the sums and using the identity $Z - Z^* = 2i\\mathrm{Im}(Z)$:\n$$ \\frac{d\\rho_j}{dt} = \\sum_{k \\neq j} \\left( (\\mathbf{v} \\cdot d_{kj}) c_k^* c_j - (\\mathbf{v} \\cdot d_{jk}) c_j^* c_k \\right) $$\nUsing $d_{kj} = -d_{jk}^*$, the expression becomes:\n$$ \\frac{d\\rho_j}{dt} = \\sum_{k \\neq j} \\left( -(\\mathbf{v} \\cdot d_{jk}^*) c_k^* c_j - (\\mathbf{v} \\cdot d_{jk}) c_j^* c_k \\right) = -2 \\sum_{k \\neq j} \\mathrm{Re}[(\\mathbf{v} \\cdot d_{jk}) c_j^* c_k] $$\nThis equation describes the total rate of population change in state $j$ due to couplings with all other states $k$. The term for a specific state $i$ in the summation, $-2 \\mathrm{Re}[(\\mathbf{v} \\cdot d_{ji}) c_j^* c_i]$, represents the rate of population flow between states $i$ and $j$. The population that flows from state $i$ to state $j$ in a small time step $\\Delta t$ is:\n$$ \\Delta \\rho_{i \\to j} = 2 \\Delta t \\mathrm{Re}[(\\mathbf{v} \\cdot d_{ij}) c_j c_i^*] $$\nHere we have used $d_{ji} = -d_{ij}^*$ and the property $\\mathrm{Re}(-Z^*) = -\\mathrm{Re}(Z)$.\n\nThe central axiom of the FSSH algorithm is that the probability of a stochastic hop, $P_{i \\to j}$, for a trajectory currently on state $i$, must be defined such that the ensemble-averaged population transfer matches the quantum mechanical population flow predicted by the TDSE. The population transfer induced by hops from state $i$ to $j$ in an ensemble is the fraction of trajectories on state $i$, $|c_i|^2$, multiplied by the hop probability, $P_{i \\to j}$. Equating this to the quantum flow:\n$$ |c_i|^2 P_{i \\to j} = \\Delta \\rho_{i \\to j} = 2 \\Delta t \\mathrm{Re}[(\\mathbf{v} \\cdot d_{ij}) c_j c_i^*] $$\nSolving for $P_{i \\to j}$ yields the leading-order expression for the hopping probability:\n$$ P_{i \\to j} = \\frac{2 \\Delta t \\mathrm{Re}[(\\mathbf{v} \\cdot d_{ij}) c_j c_i^*]}{|c_i|^2} $$\nSince probability cannot be negative, a negative value of the right-hand side implies population flow from $j$ to $i$, so the probability of hopping from $i$ to $j$ is zero. The operational formula is $P_{i \\to j} = \\max\\left(0, \\frac{2 \\Delta t \\mathrm{Re}[(\\mathbf{v} \\cdot d_{ij}) c_j c_i^*]}{|c_i|^2}\\right)$.\n\n**2. Discussion of Phase and Gauge**\n\nThe hopping probability depends on the term $\\mathrm{Re}[(\\mathbf{v} \\cdot d_{ij}) c_j c_i^*]$. Let $c_k = |c_k|\\exp(i\\theta_k)$. Let us assume the gauge where $d_{ij}$ is real.\n$$ P_{i \\to j} \\propto (\\mathbf{v} \\cdot d_{ij}) \\mathrm{Re}[c_j c_i^*] = (\\mathbf{v} \\cdot d_{ij}) \\mathrm{Re}[|c_j|\\exp(i\\theta_j) |c_i|\\exp(-i\\theta_i)] $$\n$$ P_{i \\to j} \\propto (\\mathbf{v} \\cdot d_{ij}) |c_i| |c_j| \\cos(\\theta_j - \\theta_i) $$\nThe probability is directly proportional to the cosine of the relative phase between the complex coefficients. Constructive interference ($\\cos(\\Delta\\theta) > 0$) enhances the hopping probability, while destructive interference ($\\cos(\\Delta\\theta) < 0$) suppresses it, corresponding to a reversal in the direction of population flow.\n\nThe choice of phase for the adiabatic wavefunctions, $\\phi'_k = \\exp(i\\gamma_k(\\mathbf{R})) \\phi_k$, is a gauge freedom. This transformation induces changes in both the coefficients, $c'_k = c_k \\exp(-i\\gamma_k)$, and the off-diagonal derivative couplings, $d'_{ij} = d_{ij} \\exp(i(\\gamma_j-\\gamma_i))$. A physical observable like the hop probability must be gauge-invariant. We check the invariance of the key term:\n$$ (\\mathbf{v} \\cdot d'_{ij}) c'_j (c'_i)^* = (\\mathbf{v} \\cdot (d_{ij} e^{i(\\gamma_j-\\gamma_i)})) (c_j e^{-i\\gamma_j}) (c_i e^{-i\\gamma_i})^* $$\n$$ = (\\mathbf{v} \\cdot d_{ij}) e^{i(\\gamma_j-\\gamma_i)} c_j e^{-i\\gamma_j} c_i^* e^{i\\gamma_i} = (\\mathbf{v} \\cdot d_{ij}) c_j c_i^* e^{i(\\gamma_j-\\gamma_i-\\gamma_j+\\gamma_i)} = (\\mathbf{v} \\cdot d_{ij}) c_j c_i^* $$\nThe term is indeed invariant under a gauge transformation. The problem's assumption that the states are real (a specific gauge choice where $d_{ij}$ is real) is a convenience, not a physical necessity.\n\n**3. Numerical Evaluation**\n\nWe now calculate the hopping probability $P_{i \\to j}$ using the provided data.\nThe required quantities are:\ni. The denominator $|c_i|^2$:\n$$ |c_i|^2 = |0.8 \\exp(i\\theta_i)|^2 = (0.8)^2 = 0.64 $$\nii. The dot product $\\mathbf{v} \\cdot d_{ij}$:\n$$ \\mathbf{v} = (1500\\,\\hat{\\mathbf{x}} + 1000\\,\\hat{\\mathbf{y}}) \\ \\mathrm{m\\,s^{-1}} $$\n$$ d_{ij} = (1.0 \\times 10^{10}\\,\\hat{\\mathbf{x}} + 1.0 \\times 10^{10}\\,\\hat{\\mathbf{y}}) \\ \\mathrm{m^{-1}} $$\n$$ \\mathbf{v} \\cdot d_{ij} = (1500)(1.0 \\times 10^{10}) + (1000)(1.0 \\times 10^{10}) $$\n$$ \\mathbf{v} \\cdot d_{ij} = 1.5 \\times 10^{13} + 1.0 \\times 10^{13} = 2.5 \\times 10^{13} \\ \\mathrm{s^{-1}} $$\niii. The real part term $\\mathrm{Re}[(\\mathbf{v} \\cdot d_{ij}) c_j c_i^*]$. As $d_{ij}$ is real, this is $(\\mathbf{v} \\cdot d_{ij}) \\mathrm{Re}[c_j c_i^*]$.\n$$ c_j c_i^* = (0.6 \\exp(i\\theta_j)) (0.8 \\exp(-i\\theta_i)) = 0.48 \\exp(i(\\theta_j - \\theta_i)) $$\nGiven $\\theta_j - \\theta_i = \\pi/3$,\n$$ c_j c_i^* = 0.48 \\exp(i\\pi/3) = 0.48 \\left(\\cos(\\frac{\\pi}{3}) + i\\sin(\\frac{\\pi}{3})\\right) $$\n$$ \\mathrm{Re}[c_j c_i^*] = 0.48 \\cos(\\frac{\\pi}{3}) = 0.48 \\times \\frac{1}{2} = 0.24 $$\nThe term is positive, so the hop $i \\to j$ is allowed.\n\nSubstituting these values into the derived formula with $\\Delta t = 5.0 \\times 10^{-16} \\ \\mathrm{s}$:\n$$ P_{i \\to j} = \\frac{2 \\Delta t (\\mathbf{v} \\cdot d_{ij}) \\mathrm{Re}[c_j c_i^*]}{|c_i|^2} $$\n$$ P_{i \\to j} = \\frac{2 \\times (5.0 \\times 10^{-16} \\ \\mathrm{s}) \\times (2.5 \\times 10^{13} \\ \\mathrm{s^{-1}}) \\times (0.24)}{0.64} $$\n$$ P_{i \\to j} = \\frac{(1.0 \\times 10^{-15}) \\times (2.5 \\times 10^{13}) \\times 0.24}{0.64} = \\frac{(2.5 \\times 10^{-2}) \\times 0.24}{0.64} $$\n$$ P_{i \\to j} = \\frac{0.025 \\times 0.24}{0.64} = \\frac{0.006}{0.64} = 0.009375 $$\nThe result is required to four significant figures. The calculated value is $0.009375$, which is already in this form.", "answer": "$$\\boxed{0.009375}$$", "id": "2928383"}, {"introduction": "Once a stochastic hop from one electronic state to another is accepted, the classical motion of the nuclei must be adjusted to ensure the total energy of the system is conserved. In FSSH, this is typically achieved by changing the nuclear momentum along the direction of the non-adiabatic coupling vector, but what happens if the nuclei lack sufficient kinetic energy to \"pay\" for a jump to a higher-energy surface? This practice problem [@problem_id:2681521] presents a concrete scenario to explore the mechanics of momentum rescaling and the important concept of a \"frustrated hop,\" a situation where an electronically allowed transition is classically forbidden.", "problem": "A single nuclear degree-of-freedom model is embedded in three-dimensional Cartesian space to describe a nonadiabatic transition within a kinetic step of a reaction network. At a geometry with position vector $\\mathbf{R}$, a hop from electronic state $i$ to state $j$ is attempted using the Fewest Switches Surface Hopping (FSSH) algorithm. The nonadiabatic coupling vector between states $i$ and $j$ at $\\mathbf{R}$ is $\\mathbf{d}_{ij}$. The nuclear momentum is $\\mathbf{P}$, and the adiabatic energies are $E_i(\\mathbf{R})$ and $E_j(\\mathbf{R})$.\n\nAssume that only the component of the momentum along the direction of $\\mathbf{d}_{ij}$ is adjusted upon a successful hop to enforce conservation of total energy, and that a single scalar mass $m$ applies to all Cartesian components. If no real momentum adjustment is possible, the hop is frustrated due to insufficient kinetic energy and the momentum is left unchanged (no velocity reversal).\n\nUse atomic units throughout: energies in Hartree, mass in electron masses, and momentum in atomic units. Consider the following data at the hopping geometry:\n- $E_i(\\mathbf{R}) = -0.105$, $E_j(\\mathbf{R}) = -0.085$,\n- $\\mathbf{P} = (10,\\,-5,\\,2)$,\n- $\\mathbf{d}_{ij} = (0.6,\\,0.8,\\,0)$,\n- $m = 1836$,\n- an attempted hop from $i$ to $j$.\n\nStart from energy conservation and basic vector algebra to derive the momentum adjustment along the unit direction $\\hat{\\mathbf{e}} = \\mathbf{d}_{ij}/\\|\\mathbf{d}_{ij}\\|$, and determine whether the hop is frustrated due to insufficient kinetic energy. Additionally, derive from first principles the minimum required magnitude of the initial momentum projection along $\\hat{\\mathbf{e}}$ that makes an uphill hop energetically allowed.\n\nReport:\n1. The post-hop momentum vector $\\mathbf{P}'$ (equal to the original $\\mathbf{P}$ if the hop is frustrated);\n2. The minimum required magnitude of the initial projection $|\\mathbf{P}\\cdot \\hat{\\mathbf{e}}|$ for the hop to be allowed.\n\nRound all reported numerical values to four significant figures and express them in atomic units. Provide your final answer as a single row vector containing, in order, the three components of $\\mathbf{P}'$ followed by the minimum required magnitude $|\\mathbf{P}\\cdot \\hat{\\mathbf{e}}|_{\\min}$.", "solution": "The problem statement is scientifically grounded, well-posed, objective, and self-contained. It describes a standard procedure within the context of Fewest Switches Surface Hopping (FSSH), a valid and widely used method in computational chemistry for simulating nonadiabatic dynamics. All necessary parameters are provided, and the rules for momentum adjustment and frustrated hops are clearly defined. The problem is therefore deemed valid and a solution will be provided.\n\nThe fundamental principle governing the momentum adjustment is the conservation of total energy. The total energy of the system is the sum of the nuclear kinetic energy and the electronic potential energy. For a system on electronic state $k$ with nuclear momentum $\\mathbf{P}_k$ and mass $m$ at a fixed geometry $\\mathbf{R}$, the total energy is $E_{total} = \\frac{\\mathbf{P}_k^2}{2m} + E_k(\\mathbf{R})$.\n\nUpon a hop from an initial electronic state $i$ to a final state $j$, the total energy must be conserved:\n$$\n\\frac{\\mathbf{P}^2}{2m} + E_i(\\mathbf{R}) = \\frac{(\\mathbf{P}')^2}{2m} + E_j(\\mathbf{R})\n$$\nwhere $\\mathbf{P}$ is the momentum before the hop and $\\mathbf{P}'$ is the momentum after the hop. Rearranging this equation gives an expression for the magnitude of the post-hop momentum:\n$$\n(\\mathbf{P}')^2 = \\mathbf{P}^2 + 2m(E_i(\\mathbf{R}) - E_j(\\mathbf{R}))\n$$\nLet $\\Delta E = E_j(\\mathbf{R}) - E_i(\\mathbf{R})$ be the energy gap between the two states. The equation becomes:\n$$\n(\\mathbf{P}')^2 = \\mathbf{P}^2 - 2m\\Delta E\n$$\nThe problem specifies that the momentum adjustment occurs exclusively along the direction of the nonadiabatic coupling vector, $\\mathbf{d}_{ij}$. Let us define the unit vector in this direction as $\\hat{\\mathbf{e}} = \\frac{\\mathbf{d}_{ij}}{\\|\\mathbf{d}_{ij}\\|}$.\n\nThe initial momentum vector $\\mathbf{P}$ can be decomposed into components parallel ($\\mathbf{P}_{\\parallel}$) and perpendicular ($\\mathbf{P}_{\\perp}$) to $\\hat{\\mathbf{e}}$:\n$$\n\\mathbf{P} = \\mathbf{P}_{\\parallel} + \\mathbf{P}_{\\perp}\n$$\nwhere $\\mathbf{P}_{\\parallel} = (\\mathbf{P} \\cdot \\hat{\\mathbf{e}})\\hat{\\mathbf{e}}$ and $\\mathbf{P}_{\\perp} = \\mathbf{P} - \\mathbf{P}_{\\parallel}$. The magnitude squared of the momentum is $|\\mathbf{P}|^2 = |\\mathbf{P}_{\\parallel}|^2 + |\\mathbf{P}_{\\perp}|^2$, since the components are orthogonal.\n\nAccording to the specified adjustment protocol, the component of momentum perpendicular to $\\hat{\\mathbf{e}}$ is unchanged during the hop. Thus, the post-hop momentum $\\mathbf{P}'$ has the same perpendicular component, $\\mathbf{P}'_{\\perp} = \\mathbf{P}_{\\perp}$. The post-hop momentum is then:\n$$\n\\mathbf{P}' = \\mathbf{P}'_{\\parallel} + \\mathbf{P}_{\\perp}\n$$\nLet $p_e = \\mathbf{P} \\cdot \\hat{\\mathbf{e}}$ be the scalar projection of the initial momentum onto $\\hat{\\mathbf{e}}$, and $p'_e = \\mathbf{P}' \\cdot \\hat{\\mathbf{e}}$ be the corresponding projection of the post-hop momentum. Then $|\\mathbf{P}_{\\parallel}|^2 = p_e^2$ and $|\\mathbf{P}'_{\\parallel}|^2 = (p'_e)^2$.\nThe magnitudes squared of the momenta are related as:\n$$\n|\\mathbf{P}'|^2 = (p'_e)^2 + |\\mathbf{P}_{\\perp}|^2\n$$\n$$\n|\\mathbf{P}|^2 = p_e^2 + |\\mathbf{P}_{\\perp}|^2 \\implies |\\mathbf{P}_{\\perp}|^2 = |\\mathbf{P}|^2 - p_e^2\n$$\nSubstituting this into the expression for $|\\mathbf{P}'|^2$:\n$$\n|\\mathbf{P}'|^2 = (p'_e)^2 + |\\mathbf{P}|^2 - p_e^2\n$$\nWe now equate the two derived expressions for $|\\mathbf{P}'|^2$:\n$$\n\\mathbf{P}^2 - 2m\\Delta E = (p'_e)^2 + \\mathbf{P}^2 - p_e^2\n$$\nThis simplifies to a key relation for the squared projection of the post-hop momentum:\n$$\n(p'_e)^2 = p_e^2 - 2m\\Delta E\n$$\nFor a hop to be energetically possible, the post-hop momentum $\\mathbf{P}'$ must be a real-valued vector. This requires $(p'_e)^2 \\ge 0$. Therefore, a successful hop requires:\n$$\np_e^2 \\ge 2m\\Delta E\n$$\nThis condition has a clear physical meaning: the kinetic energy associated with the motion along the coupling direction, $\\frac{p_e^2}{2m}$, must be greater than or equal to the energy deficit $\\Delta E$ for an uphill hop ($\\Delta E > 0$). If this condition is not met, i.e., $p_e^2 < 2m\\Delta E$, the hop is termed \"frustrated\". The problem statement specifies that for a frustrated hop, the momentum is left unchanged, so $\\mathbf{P}' = \\mathbf{P}$.\n\nNow we apply this framework to the given data:\n- $E_i = -0.105$ a.u., $E_j = -0.085$ a.u.\n- $\\mathbf{P} = (10,\\,-5,\\,2)$ a.u.\n- $\\mathbf{d}_{ij} = (0.6,\\,0.8,\\,0)$ a.u.\n- $m = 1836$ a.u.\n\nFirst, calculate the energy gap $\\Delta E$:\n$$\n\\Delta E = E_j - E_i = -0.085 - (-0.105) = 0.020 \\text{ a.u.}\n$$\nNext, determine the unit vector $\\hat{\\mathbf{e}}$:\n$$\n\\|\\mathbf{d}_{ij}\\| = \\sqrt{0.6^2 + 0.8^2 + 0^2} = \\sqrt{0.36 + 0.64} = \\sqrt{1} = 1\n$$\nSince the norm is $1$, the vector is already a unit vector: $\\hat{\\mathbf{e}} = \\mathbf{d}_{ij} = (0.6,\\,0.8,\\,0)$.\n\nCalculate the initial momentum projection $p_e$:\n$$\np_e = \\mathbf{P} \\cdot \\hat{\\mathbf{e}} = (10)(0.6) + (-5)(0.8) + (2)(0) = 6.0 - 4.0 = 2.0 \\text{ a.u.}\n$$\nNow, check the condition for a successful hop. We must compare $p_e^2$ with $2m\\Delta E$:\n$$\np_e^2 = (2.0)^2 = 4.0\n$$\n$$\n2m\\Delta E = 2 \\times 1836 \\times 0.020 = 73.44\n$$\nSince $p_e^2 = 4.0$ is less than $2m\\Delta E = 73.44$, the condition $p_e^2 \\ge 2m\\Delta E$ is not satisfied. The hop is frustrated. According to the problem's rule, the momentum is unchanged.\nThus, the post-hop momentum $\\mathbf{P}'$ is:\n$$\n\\mathbf{P}' = \\mathbf{P} = (10,\\,-5,\\,2) \\text{ a.u.}\n$$\n\nThe second part of the problem asks for the minimum required magnitude of the initial projection, $|\\mathbf{P}\\cdot \\hat{\\mathbf{e}}|_{\\min}$, for the hop to be allowed. This corresponds to the threshold case where the kinetic energy is just sufficient:\n$$\n|\\mathbf{P}\\cdot \\hat{\\mathbf{e}}|_{\\min}^2 = 2m\\Delta E\n$$\n$$\n|\\mathbf{P}\\cdot \\hat{\\mathbf{e}}|_{\\min} = \\sqrt{2m\\Delta E} = \\sqrt{73.44} \\approx 8.569714... \\text{ a.u.}\n$$\nRounding the final numerical values to four significant figures:\n1. The post-hop momentum vector $\\mathbf{P}'$ is $(10.00, -5.000, 2.000)$.\n2. The minimum required projection magnitude is $8.570$.\n\nThe final answer combines these four numerical values into a single row vector.", "answer": "$$\n\\boxed{\\begin{pmatrix} 10.00 & -5.000 & 2.000 & 8.570 \\end{pmatrix}}\n$$", "id": "2681521"}, {"introduction": "A surface hopping simulation generates a wealth of microscopic trajectory data, but the ultimate goal is often to extract macroscopic observables like chemical reaction rates and equilibrium constants. By analyzing the statistics aggregated over many hopping events from a long simulation, one can test whether the method correctly reproduces fundamental principles of statistical mechanics, such as detailed balance. This final exercise [@problem_id:2928309] challenges you to bridge the gap between microscopic dynamics and macroscopic kinetics, using long-time simulation statistics to compute effective rate constants and verify their consistency with the Boltzmann distribution at thermal equilibrium.", "problem": "A trajectory-based Fewest-Switches Surface Hopping simulation of a diatomic molecule is run on two coupled adiabatic electronic states labeled $1$ and $2$. After an initial transient, the simulation reaches a stationary regime at a constant nuclear temperature $T$ in which time averages equal ensemble averages. The two adiabatic surfaces in the sampled region are approximately parallel and separated by a constant energy gap $\\Delta E = E_{2} - E_{1}$. Over a long observation window, the following statistics are recorded:\n- Total residence time on state $1$: $T_{1} = 9.95\\,\\mu\\mathrm{s}$.\n- Total residence time on state $2$: $T_{2} = 2.04\\,\\mu\\mathrm{s}$.\n- Number of hops from $1 \\to 2$: $N_{1\\to 2} = 50{,}112$.\n- Number of hops from $2 \\to 1$: $N_{2\\to 1} = 49{,}888$.\n\nAssume:\n- The long-time dynamics between the two adiabatic states can be modeled as a continuous-time, time-homogeneous, two-state Markov process for the electronic state, coupled to a canonical nuclear bath at temperature $T = 300\\,\\mathrm{K}$.\n- The ideal-gas constant is $R_{\\mathrm{g}} = 8.314462618\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$, and the energy gap is $\\Delta E = 3.95\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$.\n- Over the long observation window, hop counts may be treated as independent Poisson random variables conditioned on the effective rate constants, and the recorded residence times $T_{1}$ and $T_{2}$ are taken as exact.\n\nStarting only from the fundamental definitions of a continuous-time Markov process, stationarity of the two-state master equation, and canonical equilibrium for the nuclear degrees of freedom, derive expressions for the effective rate constants $k_{12}$ and $k_{21}$ in terms of $(N_{1\\to 2}, T_{1})$ and $(N_{2\\to 1}, T_{2})$, and for the expected equilibrium constraint linking $k_{12}/k_{21}$ to the energy gap and temperature. Then, compute the dimensionless quantity\n$$\nQ \\equiv \\frac{k_{12}/k_{21}}{\\exp\\!\\big(-\\Delta E/(R_{\\mathrm{g}} T)\\big)}.\n$$\nRound your answer for $Q$ to four significant figures. Express your final answer as a pure number (dimensionless). In your derivation, comment on the sampling uncertainty and whether the observed deviation from unity in $Q$ is statistically meaningful under the Poisson assumption, but do not report any additional numerical values beyond $Q$ in your final answer.", "solution": "The problem is subjected to validation and is found to be scientifically grounded, well-posed, and objective. It contains all necessary information for a rigorous solution. We proceed.\n\nThe task is to derive expressions for the kinetic rate constants, establish their relationship under thermal equilibrium, and then compute a dimensionless quantity $Q$ that measures the consistency of simulation data with the theoretical expectation of detailed balance.\n\n**1. Derivation of Effective Rate Constants**\n\nThe problem states that the long-time dynamics of the electronic state can be modeled as a continuous-time, time-homogeneous, two-state Markov process. Let the two states be labeled $1$ and $2$. The transition from state $1$ to state $2$ is a stochastic event with a rate constant $k_{12}$. The definition of such a rate constant is that for a system in state $1$, the probability of transitioning to state $2$ in an infinitesimal time interval $dt$ is $k_{12} dt$.\n\nOver a finite observation time, the number of transitions is proportional to the total time spent in the initial state. The simulation provides the total residence time on state $1$, $T_{1}$, and the total number of hops out of this state, $N_{1\\to 2}$. The most direct estimator for the effective rate constant $k_{12}$ is the observed frequency of transitions, which is the total number of events divided by the total exposure time.\nTherefore, the effective rate constant for the $1 \\to 2$ process is given by:\n$$\nk_{12} = \\frac{N_{1\\to 2}}{T_{1}}\n$$\nSimilarly, for the reverse process, the transition from state $2$ to state $1$, the effective rate constant $k_{21}$ is given by:\n$$\nk_{21} = \\frac{N_{2\\to 1}}{T_{2}}\n$$\nwhere $N_{2\\to 1}$ is the number of hops from state $2$ to $1$ and $T_{2}$ is the total residence time on state $2$.\n\n**2. Derivation of the Equilibrium Constraint (Detailed Balance)**\n\nLet $P_1(t)$ and $P_2(t)$ be the populations of states $1$ and $2$ at time $t$. For a two-state Markov process, the time evolution of these populations is described by the master equation:\n$$\n\\frac{dP_1(t)}{dt} = -k_{12} P_1(t) + k_{21} P_2(t)\n$$\n$$\n\\frac{dP_2(t)}{dt} = +k_{12} P_1(t) - k_{21} P_2(t)\n$$\nThe problem states that the simulation has reached a stationary regime. In a stationary state, the populations are constant, i.e., $\\frac{dP_1}{dt} = \\frac{dP_2}{dt} = 0$. This leads to the condition of detailed balance:\n$$\nk_{12} P_{1}^{\\text{st}} = k_{21} P_{2}^{\\text{st}}\n$$\nwhere $P_{1}^{\\text{st}}$ and $P_{2}^{\\text{st}}$ are the stationary populations of states $1$ and $2$.\n\nThe problem specifies that the nuclear degrees of freedom form a canonical bath at temperature $T = 300\\,\\mathrm{K}$ and that time averages equal ensemble averages. This ergodic hypothesis implies that the stationary populations observed in the simulation correspond to the equilibrium populations predicted by statistical mechanics for a system at this temperature. For two electronic states with energies $E_1$ and $E_2$, the ratio of their equilibrium populations is given by the Boltzmann factor:\n$$\n\\frac{P_{2}^{\\text{eq}}}{P_{1}^{\\text{eq}}} = Z_2/Z_1 \\exp\\left(-\\frac{E_2 - E_1}{k_B T}\\right)\n$$\nwhere $k_B$ is the Boltzmann constant and $Z_i$ are the partition functions for any internal degrees of freedom within each state. For simple electronic states as implied here, we can take $Z_1=Z_2=1$. The problem provides the energy gap as a molar quantity, $\\Delta E = 3.95\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$, and the ideal gas constant $R_{\\mathrm{g}}$. We use the identity $R_{\\mathrm{g}} = N_A k_B$, where $N_A$ is the Avogadro constant, to write the argument of the exponential in molar terms:\n$$\n\\frac{E_2 - E_1}{k_B T} = \\frac{N_A (E_2 - E_1)}{N_A k_B T} = \\frac{\\Delta E}{R_{\\mathrm{g}} T}\n$$\nThus, the equilibrium population ratio is:\n$$\n\\frac{P_{2}^{\\text{eq}}}{P_{1}^{\\text{eq}}} = \\exp\\left(-\\frac{\\Delta E}{R_{\\mathrm{g}} T}\\right)\n$$\nEquating the stationary and equilibrium populations ($P_i^{\\text{st}} = P_i^{\\text{eq}}$) and substituting this into the detailed balance condition, we find the expected relationship between the rate constants at equilibrium:\n$$\n\\frac{k_{12}}{k_{21}} = \\frac{P_{2}^{\\text{eq}}}{P_{1}^{\\text{eq}}} = \\exp\\left(-\\frac{\\Delta E}{R_{\\mathrm{g}} T}\\right)\n$$\nThis is the required equilibrium constraint.\n\n**3. Computation of the Quantity Q**\n\nWe are asked to compute the dimensionless quantity $Q$, defined as the ratio of the experimentally observed rate constant ratio to the theoretically expected one:\n$$\nQ \\equiv \\frac{(k_{12}/k_{21})_{\\text{observed}}}{(k_{12}/k_{21})_{\\text{theory}}} = \\frac{(k_{12}/k_{21})_{\\text{observed}}}{\\exp(-\\Delta E/(R_{\\mathrm{g}} T))}\n$$\nFirst, we compute the observed ratio of rate constants using the derived expressions and the provided simulation data:\n$T_{1} = 9.95 \\times 10^{-6}\\,\\mathrm{s}$, $T_{2} = 2.04 \\times 10^{-6}\\,\\mathrm{s}$, $N_{1\\to 2} = 50{,}112$, and $N_{2\\to 1} = 49{,}888$.\n$$\n\\left(\\frac{k_{12}}{k_{21}}\\right)_{\\text{observed}} = \\frac{N_{1\\to 2}/T_{1}}{N_{2\\to 1}/T_{2}} = \\frac{N_{1\\to 2} T_{2}}{N_{2\\to 1} T_{1}} = \\frac{50112 \\times (2.04 \\times 10^{-6})}{49888 \\times (9.95 \\times 10^{-6})} = \\frac{102228.48}{496385.6} \\approx 0.205946\n$$\nNext, we compute the theoretical ratio from the detailed balance principle. The given values are $\\Delta E = 3.95\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1} = 3950\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}$, $T = 300\\,\\mathrm{K}$, and $R_{\\mathrm{g}} = 8.314462618\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$.\n$$\n\\frac{\\Delta E}{R_{\\mathrm{g}} T} = \\frac{3950}{8.314462618 \\times 300} \\approx 1.58359\n$$\nThe theoretical ratio is:\n$$\n\\exp\\left(-\\frac{\\Delta E}{R_{\\mathrm{g}} T}\\right) \\approx \\exp(-1.58359) \\approx 0.205234\n$$\nFinally, we compute $Q$:\n$$\nQ = \\frac{0.205946}{0.205234} \\approx 1.003471\n$$\nRounding this result to four significant figures as requested gives $Q = 1.003$.\n\n**4. Commentary on Sampling Uncertainty**\n\nThe value of $Q$ is very close to $1$, which indicates good agreement between the simulation and the theoretical expectation of detailed balance. The question is whether the deviation from $1$ is statistically meaningful or simply a result of finite sampling. We assume the hop counts $N_{1\\to 2}$ and $N_{2\\to 1}$ are independent Poisson random variables, so their standard deviations are $\\sigma_{N_{1\\to 2}} = \\sqrt{N_{1\\to 2}}$ and $\\sigma_{N_{2\\to 1}} = \\sqrt{N_{2\\to 1}}$. The residence times $T_1$ and $T_2$ are treated as exact.\nLet $R_{\\text{obs}} = (N_{1\\to 2} T_2) / (N_{2\\to 1} T_1)$. The relative uncertainty in $R_{\\text{obs}}$ is given by standard error propagation:\n$$\n\\frac{\\sigma_{R_{\\text{obs}}}}{R_{\\text{obs}}} = \\sqrt{\\left(\\frac{\\sigma_{N_{1\\to 2}}}{N_{1\\to 2}}\\right)^2 + \\left(\\frac{\\sigma_{N_{2\\to 1}}}{N_{2\\to 1}}\\right)^2} = \\sqrt{\\frac{1}{N_{1\\to 2}} + \\frac{1}{N_{2\\to 1}}}\n$$\nSubstituting the numerical values:\n$$\n\\frac{\\sigma_{R_{\\text{obs}}}}{R_{\\text{obs}}} = \\sqrt{\\frac{1}{50112} + \\frac{1}{49888}} \\approx \\sqrt{1.9955 \\times 10^{-5} + 2.0045 \\times 10^{-5}} \\approx 0.006324\n$$\nThe absolute uncertainty in the observed ratio is $\\sigma_{R_{\\text{obs}}} = R_{\\text{obs}} \\times 0.006324 \\approx 0.205946 \\times 0.006324 \\approx 0.001302$.\nThe deviation between the observed and theoretical ratios is $|R_{\\text{obs}} - R_{\\text{theory}}| = |0.205946 - 0.205234| = 0.000712$.\nThis deviation is smaller than the calculated standard deviation of the measurement ($0.000712 < 0.001302$). The Z-score for this deviation is approximately $0.000712 / 0.001302 \\approx 0.55$. As this is less than one standard deviation, the observed difference is statistically insignificant. The simulation results are fully consistent with the principle of detailed balance within the expected statistical noise from a finite-length trajectory. The deviation of $Q$ from unity is not meaningful.", "answer": "$$\\boxed{1.003}$$", "id": "2928309"}]}