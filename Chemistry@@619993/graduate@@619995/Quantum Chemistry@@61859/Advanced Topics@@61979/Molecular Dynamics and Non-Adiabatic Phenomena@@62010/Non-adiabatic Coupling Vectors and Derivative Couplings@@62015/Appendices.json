{"hands_on_practices": [{"introduction": "Before embarking on complex quantum chemical calculations, molecular symmetry often provides a powerful shortcut to determine whether a particular non-adiabatic coupling must vanish. This exercise focuses on this fundamental principle, guiding you to apply group theory selection rules to a molecule with $C_{2v}$ symmetry. Mastering this skill allows you to quickly identify the vibrational modes that are effective in promoting non-adiabatic transitions between electronic states of specific symmetries, a crucial first step in analyzing photochemical reaction pathways.", "problem": "Consider a nonrelativistic molecule with point-group symmetry $C_{2v}$ at a nuclear geometry where the Born–Oppenheimer (BO) separation applies. Two adiabatic electronic states $\\lvert \\Psi_I \\rangle$ and $\\lvert \\Psi_J \\rangle$ transform as irreducible representations $A_1$ and $B_2$, respectively. Let $Q_k$ denote a normal mode transforming as $b_2$. The non-adiabatic coupling vector (NACV) component along $Q_k$ between these states is the electronic derivative coupling defined by the BO framework as the electronic Hilbert-space inner product of one state with the parametric derivative of the other with respect to the nuclear normal coordinate, i.e., an integral of the general form $\\langle \\Psi_I \\lvert \\partial/\\partial Q_k \\rvert \\Psi_J \\rangle$, evaluated at the symmetric geometry.\n\nUsing only symmetry considerations based on the transformation properties of electronic states and nuclear displacements under $C_{2v}$ and the requirement that nonzero electronic integrals must be totally symmetric (invariant) under the full symmetry group, determine whether this derivative coupling along the $b_2$ normal mode is symmetry-allowed (i.e., can be nonzero by symmetry) between the $A_1$ and $B_2$ electronic states. Neglect spin–orbit coupling (SOC), assume real representations, and ignore accidental symmetry lowering.\n\nWhich statement is correct?\n\nA. It is symmetry-allowed (can be nonzero) because the direct product $A_1 \\times b_2 \\times B_2$ contains the totally symmetric representation $A_1$.\n\nB. It is symmetry-forbidden because derivative couplings between states of different irreducible representations always vanish, regardless of the normal-mode symmetry.\n\nC. It is symmetry-allowed only for a totally symmetric $A_1$ mode; for a $b_2$ mode it vanishes by symmetry between $A_1$ and $B_2$.\n\nD. It is symmetry-forbidden in $C_{2v}$ because all irreducible representations are one-dimensional, so interstate derivative couplings between different symmetries vanish at symmetric geometries.", "solution": "We begin from the Born–Oppenheimer (BO) separation and the definition of the non-adiabatic coupling vector (NACV). For adiabatic electronic states $\\lvert \\Psi_I \\rangle$ and $\\lvert \\Psi_J \\rangle$ parametrically dependent on nuclear coordinates, the derivative coupling along a normal coordinate $Q_k$ is given by the electronic Hilbert-space inner product\n$$\n\\mathbf{d}_{IJ}^{(k)} \\equiv \\left\\langle \\Psi_I \\middle\\lvert \\frac{\\partial}{\\partial Q_k} \\middle\\rvert \\Psi_J \\right\\rangle,\n$$\nevaluated at the geometry of interest. The transformation property of the operator $\\partial/\\partial Q_k$ matches that of the normal coordinate $Q_k$ itself.\n\nA standard group-theoretical requirement for a nonzero electronic integral is that the integrand must be totally symmetric (invariant) under all symmetry operations of the molecule. For an electronic integral of the general form $\\langle \\Psi_I \\lvert \\hat{O} \\rvert \\Psi_J \\rangle$, this invariance condition is captured by the direct-product selection rule: the triple product of the irreducible representations (irreps) of the bra, operator, and ket must contain the totally symmetric irrep. The symmetry condition for a nonzero derivative coupling is therefore:\n$$\n\\Gamma(\\Psi_I) \\times \\Gamma\\left(\\frac{\\partial}{\\partial Q_k}\\right) \\times \\Gamma(\\Psi_J) \\supset A_1,\n$$\nwhere $A_1$ is the totally symmetric irrep of $C_{2v}$.\n\nWe now apply this to the case at hand. The given data state that\n$$\n\\Gamma(\\Psi_I) = A_1, \\quad \\Gamma(\\Psi_J) = B_2, \\quad \\Gamma(Q_k) = b_2\n$$\nSince $\\Gamma(\\partial/\\partial Q_k) = \\Gamma(Q_k)$, the irrep for the operator is $b_2$. Hence the relevant triple product is\n$$\nA_1 \\times b_2 \\times B_2.\n$$\nIn point group theory, irreps for electronic states (e.g., $B_2$) and vibrational modes (e.g., $b_2$) of the same symmetry type follow the same multiplication rules. Using the properties of direct products in $C_{2v}$, we find:\n$$\nb_2 \\times B_2 = A_1,\n$$\nand therefore\n$$\nA_1 \\times (b_2 \\times B_2) = A_1 \\times A_1 = A_1.\n$$\nBecause the triple product contains $A_1$, the derivative coupling along a $b_2$ normal mode between $A_1$ and $B_2$ states is symmetry-allowed and can be nonzero at the symmetric geometry.\n\nWe now assess each option:\n\nA. States that the coupling is symmetry-allowed because $A_1 \\times b_2 \\times B_2$ contains $A_1$. As shown above, the product evaluates to $A_1$, so this is Correct.\n\nB. Claims that derivative couplings between different irreducible representations always vanish. This is a common misconception; off-diagonal interstate couplings are permitted if the operator (here $\\partial/\\partial Q_k$) transforms so that the triple product contains $A_1$. In our case it does, so this is Incorrect.\n\nC. Claims that only a totally symmetric $A_1$ mode can mediate the coupling. For coupling between states of symmetry $\\Gamma_I$ and $\\Gamma_J$, the mediating mode must have a symmetry contained in the direct product $\\Gamma_I \\times \\Gamma_J$. Here, $A_1 \\times B_2 = B_2$. Thus, a mode of $b_2$ symmetry is required, not $a_1$. This is Incorrect.\n\nD. Attributes a prohibition to the fact that $C_{2v}$ has only one-dimensional irreducible representations. One-dimensionality does not forbid such couplings; the selection rule is still governed by the direct-product condition. As shown, the coupling is allowed. Hence this is Incorrect.\n\nTherefore, the correct choice is A.", "answer": "$$\\boxed{A}$$", "id": "2908894"}, {"introduction": "Beyond simple selection rules, non-adiabatic couplings exhibit profound topological properties, especially near conical intersections (CIs). This practice provides a deep dive into this concept by guiding you through an analytical calculation of the geometric phase for a model two-state system. By explicitly computing the Wilson loop around a CI, you will demonstrate that an adiabatic state acquires a phase factor of $-1$, a hallmark of the topology that makes CIs efficient funnels for electronic relaxation.", "problem": "Consider a two-state linear vibronic coupling model exhibiting a Conical Intersection (CI) at the origin in a two-dimensional nuclear coordinate space $\\mathbf{R}=(X,Y)$. In a diabatic basis, the electronic Hamiltonian is\n$$\n\\hat{H}_{\\mathrm{d}}(\\mathbf{R}) \\;=\\;\n\\begin{pmatrix}\na\\,X & b\\,Y \\\\\nb\\,Y & -\\,a\\,X\n\\end{pmatrix},\n$$\nwith real positive parameters $a>0$ and $b>0$. Let $\\{\\,|\\phi_{+}(\\mathbf{R})\\rangle,\\,|\\phi_{-}(\\mathbf{R})\\rangle\\,\\}$ denote the adiabatic electronic eigenstates obtained by diagonalizing $\\hat{H}_{\\mathrm{d}}(\\mathbf{R})$, chosen in a smooth real gauge on any simply connected domain not containing the origin. Define the non-adiabatic coupling (NAC) matrix field $\\boldsymbol{\\tau}(\\mathbf{R})$ by its components\n$$\n\\tau^{ij}_{k}(\\mathbf{R}) \\;=\\; \\langle \\phi_{i}(\\mathbf{R}) \\,|\\, \\partial_{R_{k}} \\phi_{j}(\\mathbf{R}) \\rangle,\\quad i,j\\in\\{+,-\\},\\; k\\in\\{X,Y\\},\n$$\nand the corresponding Wilson loop along a closed, counterclockwise, once-encircling path $\\mathcal{C}$ around the origin,\n$$\nW[\\mathcal{C}] \\;=\\; \\mathcal{P}\\,\\exp\\!\\left(\\,-\\oint_{\\mathcal{C}} \\boldsymbol{\\tau}(\\mathbf{R}) \\cdot d\\mathbf{R}\\right),\n$$\nwhere $\\mathcal{P}$ denotes path ordering. Take the loop to be the circle\n$$\n\\mathcal{C}:\\;\\mathbf{R}(\\varphi) \\;=\\; (R\\cos\\varphi,\\,R\\sin\\varphi), \\quad R>0,\\;\\varphi\\in[0,2\\pi].\n$$\n\nStarting only from the definitions above and fundamental properties of adiabatic eigenstates and non-adiabatic couplings, do the following:\n\n- Derive a convenient real parametrization of the adiabatic eigenstates in terms of a mixing angle $\\alpha(\\mathbf{R})$ associated with $\\hat{H}_{\\mathrm{d}}(\\mathbf{R})$.\n- Use this parametrization to obtain the NAC matrix field $\\boldsymbol{\\tau}(\\mathbf{R})$ in terms of $\\nabla_{\\mathbf{R}}\\alpha(\\mathbf{R})$ and constant $2\\times 2$ generators.\n- Evaluate the Wilson loop $W[\\mathcal{C}]$ explicitly for the given circular path and determine its action in the adiabatic basis.\n- From your explicit $W[\\mathcal{C}]$, extract the upper-left element $W_{++}$, which represents the geometric phase factor accumulated by the upper adiabatic state $|\\phi_{+}\\rangle$ under parallel transport along $\\mathcal{C}$.\n\nProvide your final answer as a single pure number with no units. No rounding is needed.", "solution": "The first task is to find a convenient parametrization of the adiabatic eigenstates. These states are the eigenvectors of the diabatic Hamiltonian $\\hat{H}_{\\mathrm{d}}(\\mathbf{R})$. We can relate the diabatic basis $\\{|d_1\\rangle, |d_2\\rangle\\}$, in which $\\hat{H}_{\\mathrm{d}}$ is written, to the adiabatic basis $\\{|\\phi_+\\rangle, |\\phi_-\\rangle\\}$ via a unitary transformation $U(\\mathbf{R})$ that diagonalizes $\\hat{H}_{\\mathrm{d}}(\\mathbf{R})$. For a real symmetric $2\\times 2$ Hamiltonian, this transformation is a rotation matrix which can be parametrized by a single mixing angle, which we will denote $\\alpha(\\mathbf{R})/2$.\nLet the transformation be:\n$$\n\\begin{pmatrix} |\\phi_+(\\mathbf{R})\\rangle \\\\ |\\phi_-(\\mathbf{R})\\rangle \\end{pmatrix} = U(\\mathbf{R}) \\begin{pmatrix} |d_1\\rangle \\\\ |d_2\\rangle \\end{pmatrix} = \\begin{pmatrix} \\cos(\\alpha/2) & \\sin(\\alpha/2) \\\\ -\\sin(\\alpha/2) & \\cos(\\alpha/2) \\end{pmatrix} \\begin{pmatrix} |d_1\\rangle \\\\ |d_2\\rangle \\end{pmatrix}\n$$\nThe adiabatic Hamiltonian $\\hat{H}_{\\mathrm{a}} = U \\hat{H}_{\\mathrm{d}} U^\\dagger$ must be diagonal. The off-diagonal elements of $\\hat{H}_{\\mathrm{a}}$ must be zero. Let us compute the $(1,2)$ element of $\\hat{H}_{\\mathrm{a}}$:\n$$\n(\\hat{H}_{\\mathrm{a}})_{12} = (U \\hat{H}_{\\mathrm{d}} U^\\dagger)_{12} = -aX\\sin\\alpha + bY\\cos\\alpha\n$$\nSetting this to zero to ensure diagonalization gives $bY\\cos\\alpha = aX\\sin\\alpha$, which defines the mixing angle $\\alpha(\\mathbf{R})$ via the relation:\n$$\n\\tan(\\alpha(\\mathbf{R})) = \\frac{bY}{aX}\n$$\nThis angle $\\alpha(\\mathbf{R})$ is more formally defined as $\\alpha(\\mathbf{R}) = \\mathrm{atan2}(bY, aX)$, which specifies the polar angle in the scaled coordinate plane $(aX, bY)$. This completes the first task.\n\nNext, we derive the NAC matrix field $\\boldsymbol{\\tau}(\\mathbf{R})$. The components are $\\tau^{ij}_{k} = \\langle\\phi_i | \\partial_{R_k} \\phi_j\\rangle$. In matrix form, the NAC for a given nuclear coordinate $R_k$ is $\\boldsymbol{\\tau}_k = U^\\dagger (\\partial_{R_k} U)$, assuming the diabatic basis is coordinate-independent ($\\partial_{R_k}|d_l\\rangle = 0$). The dependence of $U$ on $\\mathbf{R}$ is entirely through the mixing angle $\\alpha(\\mathbf{R})$. Using the chain rule, $\\partial_{R_k} U = (\\partial U / \\partial\\alpha)(\\partial\\alpha/\\partial R_k)$.\nFirst, we compute $\\partial U / \\partial\\alpha$:\n$$\n\\frac{\\partial U}{\\partial\\alpha} = \\frac{1}{2}\\begin{pmatrix} -\\sin(\\alpha/2) & \\cos(\\alpha/2) \\\\ -\\cos(\\alpha/2) & -\\sin(\\alpha/2) \\end{pmatrix}\n$$\nNow we compute the product $U^\\dagger (\\partial U / \\partial\\alpha)$:\n$$\nU^\\dagger \\frac{\\partial U}{\\partial\\alpha} = \\frac{1}{2}\\begin{pmatrix} \\cos(\\alpha/2) & -\\sin(\\alpha/2) \\\\ \\sin(\\alpha/2) & \\cos(\\alpha/2) \\end{pmatrix} \\begin{pmatrix} -\\sin(\\alpha/2) & \\cos(\\alpha/2) \\\\ -\\cos(\\alpha/2) & -\\sin(\\alpha/2) \\end{pmatrix} = \\frac{1}{2}\\begin{pmatrix} 0 & 1 \\\\ -1 & 0 \\end{pmatrix}\n$$\nLet us define the constant generator matrix $T = \\begin{pmatrix} 0 & 1 \\\\ -1 & 0 \\end{pmatrix}$. The NAC matrix for coordinate $R_k$ is then:\n$$\n\\boldsymbol{\\tau}_{k}(\\mathbf{R}) = \\left(U^\\dagger \\frac{\\partial U}{\\partial\\alpha}\\right) \\frac{\\partial\\alpha}{\\partial R_k} = \\frac{1}{2} T \\frac{\\partial\\alpha}{\\partial R_k}\n$$\nThe NAC vector field can be written compactly as $\\boldsymbol{\\tau}(\\mathbf{R}) = \\frac{1}{2} T \\nabla_{\\mathbf{R}}\\alpha(\\mathbf{R})$. This fulfills the second task.\n\nNow we evaluate the Wilson loop $W[\\mathcal{C}]$. The expression is $W[\\mathcal{C}] = \\mathcal{P}\\,\\exp\\left(-\\oint_{\\mathcal{C}} \\boldsymbol{\\tau}(\\mathbf{R}) \\cdot d\\mathbf{R}\\right)$.\nLet's first evaluate the line integral in the exponent:\n$$\n\\oint_{\\mathcal{C}} \\boldsymbol{\\tau}(\\mathbf{R}) \\cdot d\\mathbf{R} = \\oint_{\\mathcal{C}} \\left(\\frac{1}{2} T \\nabla_{\\mathbf{R}}\\alpha(\\mathbf{R})\\right) \\cdot d\\mathbf{R}\n$$\nSince $T$ is a constant matrix, it can be factored out of the integral:\n$$\n= \\frac{1}{2} T \\oint_{\\mathcal{C}} \\nabla_{\\mathbf{R}}\\alpha(\\mathbf{R}) \\cdot d\\mathbf{R}\n$$\nThe integral $\\oint_{\\mathcal{C}} \\nabla_{\\mathbf{R}}\\alpha(\\mathbf{R}) \\cdot d\\mathbf{R}$ represents the total change in the angle $\\alpha$ as we traverse the closed loop $\\mathcal{C}$. The path is a circle $\\mathbf{R}(\\varphi) = (R\\cos\\varphi, R\\sin\\varphi)$ for $\\varphi \\in [0, 2\\pi]$. The angle $\\alpha$ is given by $\\tan\\alpha = bY/aX$. Along the path $\\mathcal{C}$, the arguments to the $\\mathrm{atan2}$ function become $aX = aR\\cos\\varphi$ and $bY = bR\\sin\\varphi$. Since $a,b,R > 0$, as $\\varphi$ goes from $0$ to $2\\pi$, the point $(aR\\cos\\varphi, bR\\sin\\varphi)$ traces an ellipse in the $(aX,bY)$-plane, which encircles the origin once in a counterclockwise direction. Thus, the total change in the angle $\\alpha$ is exactly $2\\pi$.\n$$\n\\oint_{\\mathcal{C}} \\nabla_{\\mathbf{R}}\\alpha(\\mathbf{R}) \\cdot d\\mathbf{R} = \\alpha(2\\pi) - \\alpha(0) = 2\\pi\n$$\nSubstituting this result back, the integral in the exponent becomes:\n$$\n\\oint_{\\mathcal{C}} \\boldsymbol{\\tau}(\\mathbf{R}) \\cdot d\\mathbf{R} = \\frac{1}{2} T (2\\pi) = \\pi T = \\pi \\begin{pmatrix} 0 & 1 \\\\ -1 & 0 \\end{pmatrix}\n$$\nThe Wilson loop is $W[\\mathcal{C}] = \\mathcal{P}\\,\\exp\\left(-\\pi T\\right)$. The path-ordering operator $\\mathcal{P}$ is trivial in this case because the matrix being integrated, $\\boldsymbol{\\tau}(\\mathbf{R})\\cdot d\\mathbf{R} = (\\frac{1}{2} \\nabla\\alpha \\cdot d\\mathbf{R}) T$, is always proportional to the same constant matrix $T$. Therefore, the matrices at different points along the path commute, and path-ordering is identical to the standard matrix exponential.\n$$\nW[\\mathcal{C}] = \\exp(-\\pi T) = \\exp\\left(-\\pi \\begin{pmatrix} 0 & 1 \\\\ -1 & 0 \\end{pmatrix}\\right) = \\exp\\begin{pmatrix} 0 & -\\pi \\\\ \\pi & 0 \\end{pmatrix}\n$$\nTo evaluate this matrix exponential, let $M = \\begin{pmatrix} 0 & -\\pi \\\\ \\pi & 0 \\end{pmatrix}$. We note that $M^2 = \\begin{pmatrix} 0 & -\\pi \\\\ \\pi & 0 \\end{pmatrix}\\begin{pmatrix} 0 & -\\pi \\\\ \\pi & 0 \\end{pmatrix} = \\begin{pmatrix} -\\pi^2 & 0 \\\\ 0 & -\\pi^2 \\end{pmatrix} = -\\pi^2 \\mathbb{I}$, where $\\mathbb{I}$ is the $2\\times2$ identity matrix.\nUsing the matrix equivalent of Euler's formula, for a matrix $A$ such that $A^2 = -k^2\\mathbb{I}$, we have $\\exp(A) = \\cos(k)\\mathbb{I} + \\frac{1}{k}\\sin(k)A$.\nHere, $A=M$ and $k=\\pi$.\n$$\nW[\\mathcal{C}] = \\exp(M) = \\cos(\\pi)\\mathbb{I} + \\frac{1}{\\pi}\\sin(\\pi)M = (-1)\\mathbb{I} + (0)M = -\\mathbb{I}\n$$\nSo, the Wilson loop matrix is:\n$$\nW[\\mathcal{C}] = \\begin{pmatrix} -1 & 0 \\\\ 0 & -1 \\end{pmatrix}\n$$\nThis demonstrates that both adiabatic states, $|\\phi_+\\rangle$ and $|\\phi_-\\rangle$, acquire a geometric phase of $\\pi$ (i.e., a sign flip) upon parallel transport around the conical intersection.\n\nFinally, we extract the upper-left element $W_{++}$ of the Wilson loop matrix. This element represents the geometric phase factor accumulated by the upper adiabatic state $|\\phi_+(\\mathbf{R})\\rangle$.\nFrom the calculated matrix, we have:\n$$\nW_{++} = -1\n$$\nThis is the required final result.", "answer": "$$\n\\boxed{-1}\n$$", "id": "2908899"}, {"introduction": "Bridging the gap from elegant analytical models to practical computational chemistry reveals numerous numerical challenges. This exercise addresses the common pitfalls encountered when calculating derivative couplings with finite-difference methods, particularly near the regions of near-degeneracy explored in the previous problems. By analyzing how state-tracking algorithms can fail and produce spurious artifacts, you will develop a critical understanding of the numerical techniques required to ensure the accuracy and stability of non-adiabatic dynamics simulations.", "problem": "In the adiabatic representation of molecular electronic structure, the clamped-nuclei electronic Hamiltonian $\\hat{H}_{\\mathrm{e}}(\\mathbf{R})$ has instantaneous orthonormal eigenstates $\\{\\,\\lvert \\phi_{k}(\\mathbf{R}) \\rangle \\,\\}$ with associated eigenvalues $E_{k}(\\mathbf{R})$, where $\\mathbf{R}$ denotes the nuclear coordinates. The non-adiabatic derivative coupling vector between adiabatic states $i$ and $j$ is defined by $\\mathbf{d}_{ij}(\\mathbf{R}) = \\langle \\phi_{i}(\\mathbf{R}) \\lvert \\boldsymbol{\\nabla}_{\\mathbf{R}} \\phi_{j}(\\mathbf{R}) \\rangle$. In practice, many electronic structure codes estimate $\\mathbf{d}_{ij}(\\mathbf{R})$ by central finite differences along a chosen nuclear direction $\\hat{\\mathbf{e}}$, using\n$$\nd_{ij}^{(\\hat{\\mathbf{e}})}(\\mathbf{R}) \\approx \\left\\langle \\phi_{i}(\\mathbf{R}) \\left\\lvert \\frac{\\lvert \\phi_{j}(\\mathbf{R}+\\Delta R\\,\\hat{\\mathbf{e}})\\rangle - \\lvert \\phi_{j}(\\mathbf{R}-\\Delta R\\,\\hat{\\mathbf{e}})\\rangle}{2\\,\\Delta R} \\right. \\right\\rangle,\n$$\nwith a small step $\\Delta R$. To assemble a consistent sequence of adiabatic states along the path $\\mathbf{R} + s\\,\\hat{\\mathbf{e}}$, a simple state-tracking algorithm at each step may select, for each $k$, the state $\\lvert \\phi_{k}(\\mathbf{R}+\\Delta R\\,\\hat{\\mathbf{e}})\\rangle$ that maximizes the modulus of the overlap $\\bigl\\lvert \\langle \\phi_{k}(\\mathbf{R}) \\lvert \\phi_{\\ell}(\\mathbf{R}+\\Delta R\\,\\hat{\\mathbf{e}}) \\rangle \\bigr\\rvert$ over $\\ell$, and fixes the overall phase by requiring $\\langle \\phi_{k}(\\mathbf{R}) \\lvert \\phi_{k}(\\mathbf{R}+\\Delta R\\,\\hat{\\mathbf{e}}) \\rangle$ to be real and positive if possible.\n\nConsider an avoided crossing between two adiabatic states $i$ and $j$ along the one-dimensional coordinate $R$ along $\\hat{\\mathbf{e}}$. In a small neighborhood of the avoided crossing, the adiabatic energy gap $\\Delta E(R) = E_{j}(R) - E_{i}(R)$ becomes very small, and the adiabatic states exchange their diabatic character over a very short interval of $R$.\n\nSelect all statements that are correct about how such state-tracking and finite-difference procedures can produce spurious spikes in the computed derivative couplings and how to mitigate them, based on first principles of the adiabatic representation and definitions above.\n\nA. If the overlap-based tracker swaps the labels of $\\lvert \\phi_{i} \\rangle$ and $\\lvert \\phi_{j} \\rangle$ between $R-\\Delta R$ and $R+\\Delta R$, then the finite-difference numerator can become the difference of nearly orthogonal adiabatic states with $\\mathcal{O}(1)$ norm, so $d_{ij}^{(\\hat{\\mathbf{e}})}(R)$ exhibits an $\\mathcal{O}(1/\\Delta R)$ spike unrelated to the physical non-adiabatic coupling. Tracking and aligning the entire quasi-degenerate subspace by a unitary rotation that maximizes continuity across steps reduces such artifacts.\n\nB. Rewriting the derivative coupling using an expression inversely proportional to the adiabatic energy gap $\\Delta E(R)$ guarantees that $d_{ij}^{(\\hat{\\mathbf{e}})}(R)$ remains bounded at or near degeneracy, so spikes must be numerical and vanish if this expression is used instead of finite differences.\n\nC. Even when labels are correct, a discontinuous global phase flip $\\lvert \\phi_{j}(R+\\Delta R)\\rangle \\mapsto -\\lvert \\phi_{j}(R+\\Delta R)\\rangle$ can induce an artificial large finite-difference quotient. Enforcing phase continuity along the path (for example, via a parallel-transport condition that minimizes $\\langle \\phi_{j} \\lvert \\partial_{R} \\phi_{j} \\rangle$) suppresses such spikes.\n\nD. Decreasing $\\Delta R$ always reduces spurious spikes from mis-tracking, because the central finite difference converges uniformly regardless of state identity errors.\n\nE. Along a path that passes through a conical intersection, the exact adiabatic derivative coupling must remain finite, so any observed divergence necessarily signals a tracking artifact.\n\nF. When several states are quasi-degenerate, tracking should be performed in the subspace they span by determining a unitary that best maps the old subspace onto the new one before defining individual states; computing derivative couplings after this subspace alignment mitigates spikes from identity swaps within the group.\n\nChoose all that apply. Provide your reasoning from fundamental definitions and properties of adiabatic states and derivative couplings, without assuming any special model beyond what is stated.", "solution": "### Solution Derivation and Option Analysis\n\nThe core of the problem lies in the numerical approximation of the derivative coupling, particularly the term $\\partial_{\\mathbf{R}} \\lvert \\phi_j(\\mathbf{R}) \\rangle$, using a central difference scheme. The accuracy of this approximation relies on the function being differentiated—in this case, the state vector $\\lvert \\phi_j(\\mathbf{R})\\rangle$—being a smooth and continuous function of $\\mathbf{R}$. State tracking and phase fixing are procedures designed to construct such a smooth function from the raw eigenstates produced by diagonalization at each point $\\mathbf{R}$, whose ordering and phases are otherwise arbitrary.\n\nLet us analyze each statement:\n\n**A. If the overlap-based tracker swaps the labels of $\\lvert \\phi_{i} \\rangle$ and $\\lvert \\phi_{j} \\rangle$ between $R-\\Delta R$ and $R+\\Delta R$, then the finite-difference numerator can become the difference of nearly orthogonal adiabatic states with $\\mathcal{O}(1)$ norm, so $d_{ij}^{(\\hat{\\mathbf{e}})}(R)$ exhibits an $\\mathcal{O}(1/\\Delta R)$ spike unrelated to the physical non-adiabatic coupling. Tracking and aligning the entire quasi-degenerate subspace by a unitary rotation that maximizes continuity across steps reduces such artifacts.**\n\nThis statement describes a state identity swap. Let's analyze the finite-difference approximation for $d_{ij}(R)$ at a point $R$:\n$$d_{ij}(R) \\approx \\left\\langle \\phi_{i}(R) \\left\\lvert \\frac{\\lvert \\phi_{j}(R+\\Delta R)\\rangle - \\lvert \\phi_{j}(R-\\Delta R)\\rangle}{2\\,\\Delta R} \\right. \\right\\rangle$$\nA swap \"between $R-\\Delta R$ and $R+\\Delta R$\" means that the state labeled $\\lvert \\phi_{j}(R-\\Delta R)\\rangle$ has a different physical character from the state labeled $\\lvert \\phi_{j}(R+\\Delta R)\\rangle$. For instance, at an avoided crossing, the state labeled $j$ at $R-\\Delta R$ may be diabatically similar to the state labeled $i$ at $R+\\Delta R$.\nLet us assume that $\\lvert\\phi_j(R+\\Delta R)\\rangle$ is, in terms of smooth evolution, the continuation of $\\lvert\\phi_i(R)\\rangle$, i.e., $\\langle \\phi_i(R) \\lvert \\phi_j(R+\\Delta R) \\rangle \\approx 1$.\nSimultaneously, let us assume $\\lvert\\phi_j(R-\\Delta R)\\rangle$ is the smooth continuation of $\\lvert\\phi_j(R)\\rangle$, making $\\langle \\phi_i(R) \\lvert \\phi_j(R-\\Delta R) \\rangle \\approx \\langle \\phi_i(R) \\lvert \\phi_j(R) \\rangle = 0$.\nThe scalar product in the numerator becomes $\\langle \\phi_{i}(R) \\lvert \\phi_{j}(R+\\Delta R)\\rangle - \\langle \\phi_{i}(R) \\lvert \\phi_{j}(R-\\Delta R)\\rangle \\approx 1 - 0 = 1$, which is of order $\\mathcal{O}(1)$.\nDividing by $2\\,\\Delta R$, the computed coupling $d_{ij}(R)$ scales as $\\mathcal{O}(1/\\Delta R)$, creating a non-physical spike whose magnitude diverges as $\\Delta R \\to 0$.\nThe proposed solution, aligning the quasi-degenerate subspace with a unitary transformation that maximizes continuity (e.g., by maximizing the trace of the overlap matrix between the subspace basis at $R$ and the rotated basis at $R+\\Delta R$), is a sophisticated and robust method to prevent such identity swaps. It correctly defines the correspondence between the manifolds of states before defining individual states.\nTherefore, this statement is **Correct**.\n\n**B. Rewriting the derivative coupling using an expression inversely proportional to the adiabatic energy gap $\\Delta E(R)$ guarantees that $d_{ij}^{(\\hat{\\mathbf{e}})}(R)$ remains bounded at or near degeneracy, so spikes must be numerical and vanish if this expression is used instead of finite differences.**\n\nThe analytical expression for the off-diagonal derivative coupling, derived using the Hellmann-Feynman theorem, is:\n$$d_{ij}^{(\\hat{\\mathbf{e}})}(R) = \\frac{\\langle \\phi_i(R) \\lvert \\partial_R \\hat{H}_{\\mathrm{e}}(R) \\rvert \\phi_j(R) \\rangle}{E_j(R) - E_i(R)}$$\nThe statement claims this expression guarantees the coupling remains \"bounded\" near degeneracy, i.e., as $E_j - E_i \\to 0$. This is fundamentally incorrect. At an avoided crossing, the numerator $\\langle \\phi_i \\lvert \\partial_R \\hat{H}_{\\mathrm{e}} \\rvert \\phi_j \\rangle$ is generally non-zero. As the denominator $E_j - E_i$ becomes very small, the derivative coupling becomes very large. This large, physically meaningful coupling peak is precisely what mediates the non-adiabatic transition. The expression does not guarantee a bounded value; on the contrary, it explains why the coupling is large near an avoided crossing. While this formula avoids the *numerical tracking artifacts* of finite differences, it predicts a real physical peak, not its absence.\nTherefore, this statement is **Incorrect**.\n\n**C. Even when labels are correct, a discontinuous global phase flip $\\lvert \\phi_{j}(R+\\Delta R)\\rangle \\mapsto -\\lvert \\phi_{j}(R+\\Delta R)\\rangle$ can induce an artificial large finite-difference quotient. Enforcing phase continuity along the path (for example, via a parallel-transport condition that minimizes $\\langle \\phi_{j} \\lvert \\partial_{R} \\phi_{j} \\rangle$) suppresses such spikes.**\n\nLet us analyze the effect of a phase flip on the central difference approximation of a derivative. For a general vector function $\\lvert \\psi(x) \\rangle$, the derivative is approximated as $(\\lvert \\psi(x+\\Delta x)\\rangle - \\lvert \\psi(x-\\Delta x)\\rangle) / (2\\Delta x)$. If the phase is flipped at $x+\\Delta x$, we use $-\\lvert \\psi(x+\\Delta x)\\rangle$ instead. The approximation becomes $(-\\lvert \\psi(x+\\Delta x)\\rangle - \\lvert \\psi(x-\\Delta x)\\rangle) / (2\\Delta x)$. Using Taylor expansion, $\\lvert \\psi(x \\pm \\Delta x)\\rangle \\approx \\lvert \\psi(x)\\rangle$. The numerator becomes approximately $-2\\lvert \\psi(x)\\rangle$. The computed derivative is then approximately $-\\lvert \\psi(x)\\rangle/\\Delta x$.\nApplying this to the derivative coupling calculation: a phase flip in $\\lvert \\phi_j(R+\\Delta R)\\rangle$ results in an error in the computed derivative vector $\\partial_R \\lvert \\phi_j(R)\\rangle$ of approximately $-\\lvert \\phi_j(R)\\rangle/\\Delta R$. The error in the coupling $d_{ij}(R)$ is then $\\langle \\phi_i(R) \\lvert -\\lvert \\phi_j(R)\\rangle/\\Delta R \\rangle = -\\frac{1}{\\Delta R}\\langle \\phi_i(R) \\lvert \\phi_j(R)\\rangle = -\\frac{\\delta_{ij}}{\\Delta R}$.\nThis analysis shows that for an off-diagonal coupling ($i \\ne j$), the error is zero. However, for the *diagonal* coupling ($i = j$), the error is $-1/\\Delta R$, a large artificial spike. Such a spike is a \"large finite-difference quotient\". The problem context is an avoided crossing, where all elements of the coupling matrix may be of interest. The described phase-fixing protocol (ensuring $\\langle \\phi_k(R) \\lvert \\phi_k(R+\\Delta R) \\rangle$ is real and positive) directly prevents such a sign flip and thus suppresses the artificial spike in the diagonal coupling $d_{jj}(R)$.\nTherefore, this statement accurately describes a numerical artifact and its solution. It is **Correct**.\n\n**D. Decreasing $\\Delta R$ always reduces spurious spikes from mis-tracking, because the central finite difference converges uniformly regardless of state identity errors.**\n\nThis statement is incorrect on two counts. First, as established in the analysis of A, the magnitude of a spike caused by state mis-tracking is of order $\\mathcal{O}(1/\\Delta R)$. If one is already in a regime where mis-tracking occurs for a range of step sizes, decreasing $\\Delta R$ will *increase* the magnitude of the spurious spike, not reduce it. While a sufficiently small $\\Delta R$ will eventually fix the tracking problem itself, it is false that decreasing $\\Delta R$ \"always\" reduces the spike.\nSecond, the premise of uniform convergence is false. The convergence of finite-difference methods relies on the smoothness (differentiability) of the function. A state identity error introduces a discontinuity into the vector function $\\lvert \\phi_j(R) \\rangle$. The derivative of a discontinuous function is not well-defined in the classical sense, and finite difference approximations will not converge; they will diverge, as shown by the $\\mathcal{O}(1/\\Delta R)$ behavior.\nTherefore, this statement is **Incorrect**.\n\n**E. Along a path that passes through a conical intersection, the exact adiabatic derivative coupling must remain finite, so any observed divergence necessarily signals a tracking artifact.**\n\nA conical intersection is a point of true electronic degeneracy where $E_i(\\mathbf{R}) = E_j(\\mathbf{R})$. Near a conical intersection, the derivative coupling $\\mathbf{d}_{ij}(\\mathbf{R})$ is not finite. In the two-dimensional branching space that lifts the degeneracy, the coupling has a singularity and behaves as $1/r$, where $r$ is the distance to the intersection point. A key signature of a conical intersection is that the line integral of the derivative coupling vector around any loop enclosing the intersection is quantized: $\\oint \\mathbf{d}_{ij} \\cdot d\\mathbf{l} = \\pm\\pi$. This non-zero result would be impossible by Stokes' theorem if the vector field were finite everywhere inside the loop. The premise that the exact coupling must remain finite is false. Therefore, an observed divergence near a conical intersection is a feature of the exact physics, not necessarily a numerical artifact.\nTherefore, this statement is **Incorrect**.\n\n**F. When several states are quasi-degenerate, tracking should be performed in the subspace they span by determining a unitary that best maps the old subspace onto the new one before defining individual states; computing derivative couplings after this subspace alignment mitigates spikes from identity swaps within the group.**\n\nThis statement describes the same robust tracking methodology mentioned in statement A, but in a more general context of multiple quasi-degenerate states. When states are close in energy, their characters can mix easily, making simple one-to-one overlap-based tracking unreliable and prone to swaps. By treating the block of quasi-degenerate states as a single entity (a subspace), one can find a unitary transformation that aligns the basis vectors of the subspace at step $n$ with the basis vectors at step $n+1$ in the most continuous way possible. This is typically done by forming the overlap matrix between the two sets of basis vectors and using Singular Value Decomposition (SVD) to find the optimal rotation. Once the subspace as a whole is correctly propagated, individual state identities can be assigned within the block. This procedure robustly prevents the state identity swaps responsible for the $\\mathcal{O}(1/\\Delta R)$ artifacts.\nTherefore, this statement is **Correct**.", "answer": "$$\\boxed{ACF}$$", "id": "2908916"}]}