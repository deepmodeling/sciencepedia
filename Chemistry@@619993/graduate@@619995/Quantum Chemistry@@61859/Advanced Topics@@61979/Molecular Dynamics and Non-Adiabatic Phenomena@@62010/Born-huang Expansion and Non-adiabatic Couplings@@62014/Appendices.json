{"hands_on_practices": [{"introduction": "To truly grasp the essence of non-adiabatic phenomena, one must start with the fundamental quantity that mediates them: the non-adiabatic coupling. This first practice challenges you to derive this coupling from first principles for a prototypical two-state system exhibiting an avoided crossing. By performing this analytical calculation [@problem_id:2876944], you will gain direct insight into how the coupling strength is maximized at the point of closest approach between two potential energy surfaces and how it decays when the electronic states are well-separated.", "problem": "Consider a minimal $2$-state diabatic model for a single nuclear coordinate $R$ with real, $R$-independent diabatic basis $\\{|\\chi_{1}\\rangle,|\\chi_{2}\\rangle\\}$ and electronic Hamiltonian\n$$\nH(R)=\\begin{pmatrix} a\\,R & V \\\\ V & -a\\,R \\end{pmatrix},\n$$\nwhere $a>0$ and $V>0$ are constants. In the Born-Huang expansion, the total molecular wavefunction is written as a sum over adiabatic electronic states $|\\Phi_{i}(R)\\rangle$ parametrically dependent on $R$, with nuclear amplitudes $\\chi_{i}(R)$, and the non-adiabatic coupling vector (NACV) between adiabatic states $i$ and $j$ is defined as\n$$\n\\mathbf{d}_{ij}(R)=\\langle \\Phi_{i}(R)|\\nabla_{R} \\Phi_{j}(R)\\rangle.\n$$\nFor this $1$-dimensional coordinate $R$, identify the adiabatic energies and adiabatic electronic states by diagonalizing $H(R)$ via a real orthogonal rotation by a mixing angle $\\theta(R)$ acting on the diabatic basis. Then, from first principles, determine the analytic expression for the scalar derivative coupling $d_{12}(R)=\\langle \\Phi_{1}(R)|\\frac{d}{dR}\\Phi_{2}(R)\\rangle$ in terms of $a$, $V$, and $R$. Finally, analyze its asymptotic decay for large $|R|$ and its behavior near $R=0$, explaining how these behaviors arise from your expressions for the adiabatic energies and the mixing angle.\n\nReport as your final answer only the exact closed-form expression you found for $d_{12}(R)$ (no units).", "solution": "The problem statement is first subjected to a rigorous validation procedure.\n\nStep 1: Extracted Givens\n- System: A minimal $2$-state diabatic model.\n- Nuclear Coordinate: A single coordinate $R$.\n- Diabatic Basis: $\\{|\\chi_{1}\\rangle,|\\chi_{2}\\rangle\\}$, which is real and independent of $R$.\n- Electronic Hamiltonian in the diabatic basis representation:\n$$\nH(R)=\\begin{pmatrix} a\\,R & V \\\\ V & -a\\,R \\end{pmatrix}\n$$\nwhere $a>0$ and $V>0$ are real, positive constants.\n- Non-adiabatic Coupling Vector (NACV) definition: $\\mathbf{d}_{ij}(R)=\\langle \\Phi_{i}(R)|\\nabla_{R} \\Phi_{j}(R)\\rangle$.\n- Task: Determine the scalar derivative coupling $d_{12}(R)=\\langle \\Phi_{1}(R)|\\frac{d}{dR}\\Phi_{2}(R)\\rangle$ and analyze its behavior.\n- Method: Diagonalize $H(R)$ via a real orthogonal rotation involving a mixing angle $\\theta(R)$.\n- Final Answer Requirement: The exact closed-form expression for $d_{12}(R)$.\n\nStep 2: Validation Using Extracted Givens\nThe problem presented is a standard textbook model in quantum chemistry, often referred to as the Landau–Zener model.\n- **Scientifically Grounded:** The concepts of diabatic and adiabatic representations, the Born-Huang expansion, and non-adiabatic couplings are fundamental principles in molecular quantum mechanics. The Hamiltonian describes a prototypical avoided crossing scenario, which is a scientifically sound and widely studied model.\n- **Well-Posed:** The problem is fully specified. It provides the Hamiltonian, the basis properties, and a clear definition of the quantity to be calculated. The path to the solution is outlined, and a unique, meaningful answer can be determined.\n- **Objective:** The problem is stated using precise, objective mathematical and physical terminology. There are no subjective or ambiguous elements.\n\nStep 3: Verdict and Action\nThe problem is valid. It is scientifically sound, well-posed, and objective. A complete solution will now be derived.\n\nThe solution begins with the diagonalization of the electronic Hamiltonian $H(R)$ to find the adiabatic energies (eigenvalues) and adiabatic states (eigenvectors). The adiabatic states $|\\Phi_i(R)\\rangle$ are related to the diabatic states $|\\chi_j\\rangle$ through an $R$-dependent orthogonal transformation (a rotation), which we represent by a matrix $C(R)$.\nLet the transformation be:\n$$\n\\begin{pmatrix} |\\Phi_1(R)\\rangle \\\\ |\\Phi_2(R)\\rangle \\end{pmatrix} = \\begin{pmatrix} \\cos\\theta(R) & \\sin\\theta(R) \\\\ -\\sin\\theta(R) & \\cos\\theta(R) \\end{pmatrix} \\begin{pmatrix} |\\chi_1\\rangle \\\\ |\\chi_2\\rangle \\end{pmatrix}\n$$\nThis means $|\\Phi_1(R)\\rangle = \\cos\\theta(R)|\\chi_1\\rangle + \\sin\\theta(R)|\\chi_2\\rangle$ and $|\\Phi_2(R)\\rangle = -\\sin\\theta(R)|\\chi_1\\rangle + \\cos\\theta(R)|\\chi_2\\rangle$. The corresponding matrix of eigenvector components is $C(R) = \\begin{pmatrix} \\cos\\theta(R) & -\\sin\\theta(R) \\\\ \\sin\\theta(R) & \\cos\\theta(R) \\end{pmatrix}$.\nThe adiabatic Hamiltonian matrix $H_{ad}(R)$ is diagonal and is given by $H_{ad}(R) = C(R)^{\\dagger} H(R) C(R)$. Since the basis and Hamiltonian are real, the adjoint is the transpose, $C(R)^{\\dagger} = C(R)^{T}$.\n$$\nH_{ad}(R) = \\begin{pmatrix} \\cos\\theta & \\sin\\theta \\\\ -\\sin\\theta & \\cos\\theta \\end{pmatrix} \\begin{pmatrix} aR & V \\\\ V & -aR \\end{pmatrix} \\begin{pmatrix} \\cos\\theta & -\\sin\\theta \\\\ \\sin\\theta & \\cos\\theta \\end{pmatrix}\n$$\nFor $H_{ad}(R)$ to be diagonal, its off-diagonal elements must be zero. Let's compute the $(1,2)$ element of the product:\n$$\n(H_{ad})_{12} = (\\cos\\theta(aR) + \\sin\\theta(V))(-\\sin\\theta) + (\\cos\\theta(V) + \\sin\\theta(-aR))(\\cos\\theta)\n$$\n$$\n(H_{ad})_{12} = -aR\\cos\\theta\\sin\\theta - V\\sin^2\\theta + V\\cos^2\\theta - aR\\sin\\theta\\cos\\theta\n$$\n$$\n(H_{ad})_{12} = V(\\cos^2\\theta - \\sin^2\\theta) - 2aR\\sin\\theta\\cos\\theta = V\\cos(2\\theta) - aR\\sin(2\\theta)\n$$\nSetting this to zero yields the condition for the mixing angle $\\theta(R)$:\n$$\nV\\cos(2\\theta) = aR\\sin(2\\theta) \\implies \\tan(2\\theta(R)) = \\frac{V}{aR}\n$$\nFrom this, we can define the angle $\\theta(R) = \\frac{1}{2}\\arctan\\left(\\frac{V}{aR}\\right)$. The diagonal elements of $H_{ad}(R)$ are the adiabatic energies, $E_1(R)$ and $E_2(R)$.\n$$\nE_1(R) = (H_{ad})_{11} = aR\\cos(2\\theta) + V\\sin(2\\theta)\n$$\n$$\nE_2(R) = (H_{ad})_{22} = -aR\\cos(2\\theta) - V\\sin(2\\theta) = -E_1(R)\n$$\nUsing a right-triangle construction where $\\tan(2\\theta) = V/(aR)$, the hypotenuse is $\\sqrt{(aR)^2 + V^2}$. Thus, we find expressions for $\\sin(2\\theta)$ and $\\cos(2\\theta)$:\n$$\n\\sin(2\\theta) = \\frac{V}{\\sqrt{(aR)^2 + V^2}} \\quad , \\quad \\cos(2\\theta) = \\frac{aR}{\\sqrt{(aR)^2 + V^2}}\n$$\nSubstituting these into the expression for $E_1(R)$:\n$$\nE_1(R) = aR \\left(\\frac{aR}{\\sqrt{(aR)^2 + V^2}}\\right) + V \\left(\\frac{V}{\\sqrt{(aR)^2 + V^2}}\\right) = \\frac{(aR)^2 + V^2}{\\sqrt{(aR)^2 + V^2}} = \\sqrt{(aR)^2 + V^2}\n$$\nThe adiabatic energies are thus $E_1(R) = \\sqrt{(aR)^2 + V^2}$ and $E_2(R) = -\\sqrt{(aR)^2 + V^2}$. Our state $|\\Phi_1(R)\\rangle$ corresponds to the upper adiabatic potential energy surface, and $|\\Phi_2(R)\\rangle$ to the lower one.\n\nNext, we compute the non-adiabatic derivative coupling $d_{12}(R) = \\langle\\Phi_1(R)|\\frac{d}{dR}|\\Phi_2(R)\\rangle$.\nThe adiabatic states are:\n$|\\Phi_1(R)\\rangle = \\cos\\theta(R)|\\chi_1\\rangle + \\sin\\theta(R)|\\chi_2\\rangle$\n$|\\Phi_2(R)\\rangle = -\\sin\\theta(R)|\\chi_1\\rangle + \\cos\\theta(R)|\\chi_2\\rangle$\nSince the diabatic basis $\\{|\\chi_i\\rangle\\}$ is $R$-independent, its derivative with respect to $R$ is zero. We differentiate $|\\Phi_2(R)\\rangle$:\n$$\n\\frac{d}{dR}|\\Phi_2(R)\\rangle = -\\cos\\theta(R)\\frac{d\\theta}{dR}|\\chi_1\\rangle - \\sin\\theta(R)\\frac{d\\theta}{dR}|\\chi_2\\rangle = -\\frac{d\\theta}{dR}\\left(\\cos\\theta(R)|\\chi_1\\rangle + \\sin\\theta(R)|\\chi_2\\rangle\\right)\n$$\nRecognizing that the term in parenthesis is $|\\Phi_1(R)\\rangle$, we have:\n$$\n\\frac{d}{dR}|\\Phi_2(R)\\rangle = -\\frac{d\\theta}{dR}|\\Phi_1(R)\\rangle\n$$\nThe coupling is then:\n$$\nd_{12}(R) = \\langle\\Phi_1(R)| \\left(-\\frac{d\\theta}{dR}|\\Phi_1(R)\\rangle\\right) = -\\frac{d\\theta}{dR}\\langle\\Phi_1(R)|\\Phi_1(R)\\rangle\n$$\nDue to the orthonormality of the adiabatic states, $\\langle\\Phi_1(R)|\\Phi_1(R)\\rangle=1$, which simplifies the coupling to:\n$$\nd_{12}(R) = -\\frac{d\\theta}{dR}\n$$\nNow, we must find the derivative of the mixing angle $\\theta(R)$. Starting from $\\theta(R) = \\frac{1}{2}\\arctan\\left(\\frac{V}{aR}\\right)$:\n$$\n\\frac{d\\theta}{dR} = \\frac{d}{dR}\\left[\\frac{1}{2}\\arctan\\left(\\frac{V}{aR}\\right)\\right] = \\frac{1}{2} \\cdot \\frac{1}{1 + \\left(\\frac{V}{aR}\\right)^2} \\cdot \\frac{d}{dR}\\left(\\frac{V}{aR}\\right)\n$$\n$$\n\\frac{d\\theta}{dR} = \\frac{1}{2} \\cdot \\frac{1}{1 + \\frac{V^2}{a^2R^2}} \\cdot \\left(-\\frac{V}{aR^2}\\right) = \\frac{1}{2} \\cdot \\frac{a^2R^2}{a^2R^2 + V^2} \\cdot \\left(-\\frac{V}{aR^2}\\right) = -\\frac{aV}{2(a^2R^2 + V^2)}\n$$\nTherefore, the non-adiabatic coupling is:\n$$\nd_{12}(R) = - \\left(-\\frac{aV}{2(a^2R^2 + V^2)}\\right) = \\frac{aV}{2(a^2R^2 + V^2)}\n$$\nThis result can be verified using the Hellmann-Feynman theorem, which gives an alternative expression for the off-diagonal coupling elements:\n$$\nd_{12}(R) = \\frac{\\langle\\Phi_1(R)|\\frac{dH}{dR}|\\Phi_2(R)\\rangle}{E_2(R) - E_1(R)}\n$$\nThe derivative of the Hamiltonian is $\\frac{dH}{dR} = \\begin{pmatrix} a & 0 \\\\ 0 & -a \\end{pmatrix}$. The matrix element in the numerator is:\n$$\n\\langle\\Phi_1|\\frac{dH}{dR}|\\Phi_2\\rangle = \\begin{pmatrix} \\cos\\theta & \\sin\\theta \\end{pmatrix} \\begin{pmatrix} a & 0 \\\\ 0 & -a \\end{pmatrix} \\begin{pmatrix} -\\sin\\theta \\\\ \\cos\\theta \\end{pmatrix} = \\begin{pmatrix} a\\cos\\theta & -a\\sin\\theta \\end{pmatrix} \\begin{pmatrix} -\\sin\\theta \\\\ \\cos\\theta \\end{pmatrix} = -a\\sin\\theta\\cos\\theta - a\\sin\\theta\\cos\\theta = -a\\sin(2\\theta)\n$$\nThe energy denominator is $E_2(R) - E_1(R) = -2\\sqrt{(aR)^2 + V^2}$. Thus:\n$$\nd_{12}(R) = \\frac{-a\\sin(2\\theta)}{-2\\sqrt{(aR)^2 + V^2}} = \\frac{a}{2\\sqrt{(aR)^2 + V^2}} \\left(\\frac{V}{\\sqrt{(aR)^2 + V^2}}\\right) = \\frac{aV}{2(a^2R^2 + V^2)}\n$$\nThe results from both methods are identical, confirming the correctness of our expression.\n\nFinally, we analyze the behavior of $d_{12}(R)$. The expression is a Lorentzian function of $R$ centered at $R=0$.\n- **Behavior near $R=0$**: As $R \\to 0$, $d_{12}(R)$ approaches its maximum value:\n$$\nd_{12}(0) = \\frac{aV}{2(0 + V^2)} = \\frac{a}{2V}\n$$\nThis peak occurs at the point of avoided crossing, where the adiabatic energy gap $\\Delta E(R) = E_1(R) - E_2(R) = 2\\sqrt{(aR)^2+V^2}$ is minimal with value $2V$. At this point, the mixing angle $\\theta(R)$ changes most rapidly. As $R\\to 0^+$, $V/(aR) \\to +\\infty$, so $2\\theta \\to \\pi/2$ and $\\theta \\to \\pi/4$. As $R\\to 0^-$, $V/(aR) \\to -\\infty$, so $2\\theta \\to -\\pi/2$ and $\\theta \\to -\\pi/4$. The rapid change of the character of the wavefunctions maximizes the derivative coupling.\n\n- **Asymptotic behavior for large $|R|$**: As $|R| \\to \\infty$, the term $a^2R^2$ dominates the denominator:\n$$\nd_{12}(R) \\approx \\frac{aV}{2a^2R^2} = \\frac{V}{2aR^2}\n$$\nThe coupling decays as $R^{-2}$. This is because for large $|R|$, the adiabatic states approach the diabatic states. The energy gap $\\Delta E(R) \\approx 2a|R|$ grows linearly, making the states well-separated and reducing the propensity for non-adiabatic transitions. The mixing angle $\\theta(R) \\approx \\frac{1}{2}\\frac{V}{aR}$ approaches zero, so its derivative also vanishes, leading to the decay of the coupling.\n\nThe final required answer is the closed-form expression for $d_{12}(R)$.", "answer": "$$\n\\boxed{\\frac{aV}{2(a^{2}R^{2} + V^{2})}}\n$$", "id": "2876944"}, {"introduction": "While non-adiabatic couplings describe local interactions, their most profound consequences often emerge from global, topological properties of the potential energy surfaces. This exercise moves beyond a simple avoided crossing to the case of a true degeneracy—a conical intersection—which acts as a topological branching point [@problem_id:2876959]. By analyzing the electronic wavefunction as the nuclei complete a loop around the intersection, you will uncover the famous geometric phase of $\\pi$, a fundamental result that demonstrates why a single, real-valued electronic wavefunction cannot be defined globally in such systems.", "problem": "Consider a vibronically coupled two-state electronic subspace of a polyatomic molecule within the Born–Huang expansion (Born–Oppenheimer separation with nuclear kinetic couplings retained). Let the nuclear configuration space be the plane with coordinates $Q_{x}$ and $Q_{y}$, and let the electronic Hamiltonian (in a fixed diabatic basis) be the real-symmetric $2 \\times 2$ matrix\n$$\n\\hat{H}_{\\mathrm{el}}(Q_{x},Q_{y}) \\;=\\; k\n\\begin{pmatrix}\nQ_{x} & Q_{y} \\\\\nQ_{y} & -Q_{x}\n\\end{pmatrix},\n$$\nwith $k>0$ a constant. This Hamiltonian exhibits a conical intersection at $Q_{x}=Q_{y}=0$. For $Q\\neq 0$, the adiabatic electronic eigenstates $\\{\\,|\\phi_{+}(Q)\\rangle,|\\phi_{-}(Q)\\rangle\\,\\}$ are nondegenerate, with eigenvalues $E_{\\pm}(Q)$.\n\nIn the adiabatic representation of the Born–Huang expansion, the nuclear motion on a single adiabatic sheet $n\\in\\{+,-\\}$ is minimally coupled to the Berry–Mead–Truhlar (geometric) vector potential\n$$\n\\mathbf{A}_{n}(Q) \\;=\\; i\\,\\langle \\phi_{n}(Q)\\,|\\,\\nabla_{Q}\\,\\phi_{n}(Q)\\rangle,\n$$\nwhere $\\nabla_{Q}=(\\partial/\\partial Q_{x},\\partial/\\partial Q_{y})$. For a closed nuclear loop $\\mathcal{C}$ in configuration space, the associated Abelian holonomy is defined by\n$$\nW_{n}(\\mathcal{C}) \\;=\\; \\exp\\!\\Big(i \\oint_{\\mathcal{C}} \\mathbf{A}_{n}(Q)\\cdot d\\mathbf{Q}\\Big).\n$$\n\nLet $\\rho>0$ be fixed and define the loop $\\mathcal{C}$ by the circle $Q_{x}(\\theta)=\\rho\\cos\\theta$, $Q_{y}(\\theta)=\\rho\\sin\\theta$ with $0\\le\\theta\\le 2\\pi$, oriented counterclockwise. Focus on the lower adiabatic sheet $n=-$. Using only foundational definitions (the above Hamiltonian, eigenvalue problem, and the definition of $\\mathbf{A}_{-}(Q)$ and $W_{-}(\\mathcal{C})$), do the following:\n\n1. Determine $E_{\\pm}(Q)$ for $Q\\neq 0$, and construct a real, normalized adiabatic eigenvector $|\\phi_{-}(Q)\\rangle$ for the lower energy sheet on the domain $0\\le\\theta<2\\pi$. Express your result in terms of $\\rho$ and $\\theta$.\n\n2. Explain why a globally continuous real choice of $|\\phi_{-}(Q)\\rangle$ on the entire circle fails, despite the Hamiltonian being real. Your explanation must be based on the behavior of your explicit $|\\phi_{-}(Q)\\rangle$ when $\\theta$ is advanced from $0$ to $2\\pi$.\n\n3. Compute the holonomy $W_{-}(\\mathcal{C})$ associated with the loop $\\mathcal{C}$ by evaluating the line integral of $\\mathbf{A}_{-}(Q)$ along $\\mathcal{C}$ using a patchwise construction if necessary. Express your final answer as an exact real scalar without units.\n\nYour final reported value must be the exact value of $W_{-}(\\mathcal{C})$. Do not include units. No rounding is required.", "solution": "The problem statement is subjected to validation prior to any attempt at a solution.\n\n**Step 1: Extracted Givens**\n- The system is a two-state electronic subspace with nuclear configuration coordinates $Q_x$ and $Q_y$.\n- The electronic Hamiltonian in a diabatic basis is given as $\\hat{H}_{\\mathrm{el}}(Q_{x},Q_{y}) = k \\begin{pmatrix} Q_{x} & Q_{y} \\\\ Q_{y} & -Q_{x} \\end{pmatrix}$, where $k>0$ is a constant.\n- A conical intersection exists at $Q_{x}=Q_{y}=0$.\n- Adiabatic electronic eigenstates are denoted $|\\phi_{n}(Q)\\rangle$ with eigenvalues $E_{n}(Q)$ for $n \\in \\{+,-\\}$.\n- The Berry vector potential is defined as $\\mathbf{A}_{n}(Q) = i\\,\\langle \\phi_{n}(Q)\\,|\\,\\nabla_{Q}\\,\\phi_{n}(Q)\\rangle$, with $\\nabla_{Q}=(\\partial/\\partial Q_{x},\\partial/\\partial Q_{y})$.\n- The Abelian holonomy for a closed loop $\\mathcal{C}$ is $W_{n}(\\mathcal{C}) = \\exp\\!\\Big(i \\oint_{\\mathcal{C}} \\mathbf{A}_{n}(Q)\\cdot d\\mathbf{Q}\\Big)$.\n- The specific loop $\\mathcal{C}$ is a circle of radius $\\rho>0$, parameterized by $Q_{x}(\\theta)=\\rho\\cos\\theta$ and $Q_{y}(\\theta)=\\rho\\sin\\theta$ for $0\\le\\theta\\le 2\\pi$.\n- The task is to focus on the lower adiabatic sheet, $n=-$, and to:\n    1. Determine $E_{\\pm}(Q)$ and a real, normalized eigenvector $|\\phi_{-}(Q)\\rangle$ on the domain $0\\le\\theta<2\\pi$.\n    2. Explain the failure of global continuity for a real choice of $|\\phi_{-}(Q)\\rangle$.\n    3. Compute the holonomy $W_{-}(\\mathcal{C})$.\n- The final answer must be the exact scalar value of $W_{-}(\\mathcal{C})$.\n\n**Step 2: Validation Using Extracted Givens**\n- **Scientific Grounding**: The problem describes a linear vibronic coupling model, specifically the $E \\otimes e$ Jahn-Teller model, which leads to a conical intersection. The concepts of adiabatic states, Berry connection, and Berry phase (holonomy) are fundamental and standard in quantum chemistry and physics. The problem is scientifically sound.\n- **Well-Posedness**: The problem is mathematically well-defined. The Hamiltonian is specified, the tasks are concrete, and all necessary definitions are provided. A unique, stable, and meaningful solution exists.\n- **Objectivity**: The problem is stated in precise, objective mathematical language, free from ambiguity or subjective content.\n\n**Step 3: Verdict and Action**\n- **Verdict**: The problem is valid. It is a standard, well-posed problem in theoretical chemistry.\n- **Action**: Proceed with the solution.\n\nThe solution is constructed by addressing the three specified tasks in order.\n\n**Part 1: Eigenenergies and Eigenvector**\n\nFirst, we determine the eigenvalues $E_{\\pm}$ of the electronic Hamiltonian $\\hat{H}_{\\mathrm{el}}$ by solving the characteristic equation $\\det(\\hat{H}_{\\mathrm{el}} - E\\,\\mathbf{I}) = 0$.\n$$\n\\det \\begin{pmatrix} kQ_{x} - E & kQ_{y} \\\\ kQ_{y} & -kQ_{x} - E \\end{pmatrix} = 0\n$$\n$$\n(kQ_{x} - E)(-kQ_{x} - E) - (kQ_{y})^2 = 0\n$$\n$$\nE^2 - (kQ_{x})^2 - (kQ_{y})^2 = 0\n$$\n$$\nE^2 = k^2(Q_{x}^2 + Q_{y}^2)\n$$\nUsing the polar coordinate representation $Q_{x} = \\rho\\cos\\theta$ and $Q_{y} = \\rho\\sin\\theta$, we have $Q_x^2 + Q_y^2 = \\rho^2$. The eigenvalues are therefore:\n$$\nE_{\\pm}(\\rho) = \\pm k \\sqrt{\\rho^2} = \\pm k\\rho\n$$\nThe lower energy sheet corresponds to the eigenvalue $E_{-} = -k\\rho$.\n\nNext, we find the corresponding eigenvector $|\\phi_{-}\\rangle = \\begin{pmatrix} c_1 \\\\ c_2 \\end{pmatrix}$ by solving the eigenvalue equation $(\\hat{H}_{\\mathrm{el}} - E_{-}\\mathbf{I})|\\phi_{-}\\rangle = 0$.\n$$\nk \\begin{pmatrix} Q_{x} - (- \\rho) & Q_{y} \\\\ Q_{y} & -Q_{x} - (-\\rho) \\end{pmatrix} \\begin{pmatrix} c_1 \\\\ c_2 \\end{pmatrix} = k \\begin{pmatrix} \\rho\\cos\\theta + \\rho & \\rho\\sin\\theta \\\\ \\rho\\sin\\theta & -\\rho\\cos\\theta + \\rho \\end{pmatrix} \\begin{pmatrix} c_1 \\\\ c_2 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}\n$$\nFrom the first row, dividing by $k\\rho$:\n$$\n(\\cos\\theta + 1)c_1 + (\\sin\\theta)c_2 = 0\n$$\nUsing the half-angle identities $\\cos\\theta + 1 = 2\\cos^2(\\theta/2)$ and $\\sin\\theta = 2\\sin(\\theta/2)\\cos(\\theta/2)$, we get:\n$$\n2\\cos^2(\\theta/2) c_1 + 2\\sin(\\theta/2)\\cos(\\theta/2) c_2 = 0\n$$\nFor $\\theta \\neq \\pi$ (where $\\cos(\\theta/2) \\neq 0$), we can divide by $2\\cos(\\theta/2)$:\n$$\n\\cos(\\theta/2) c_1 + \\sin(\\theta/2) c_2 = 0\n$$\nA real solution satisfying this condition is $c_1 = \\sin(\\theta/2)$ and $c_2 = -\\cos(\\theta/2)$. The corresponding vector is normalized, since $\\sin^2(\\theta/2) + (-\\cos(\\theta/2))^2 = 1$. This solution also holds for $\\theta=\\pi$, as can be verified by direct substitution.\nThus, a real, normalized eigenvector for the lower adiabatic sheet on the domain $0 \\le \\theta < 2\\pi$ is:\n$$\n|\\phi_{-}(\\theta)\\rangle = \\begin{pmatrix} \\sin(\\theta/2) \\\\ -\\cos(\\theta/2) \\end{pmatrix}\n$$\n\n**Part 2: Failure of Global Continuity**\n\nA globally continuous eigenvector field on the circle $\\mathcal{C}$ must satisfy the periodicity condition $|\\phi_{-}(\\theta=2\\pi)\\rangle = |\\phi_{-}(\\theta=0)\\rangle$, since $\\theta=0$ and $\\theta=2\\pi$ represent the same point $(Q_x, Q_y) = (\\rho, 0)$ in the configuration space.\nLet us evaluate our explicit real eigenvector at the boundaries of the interval $[0, 2\\pi]$:\nAt $\\theta=0$:\n$$\n|\\phi_{-}(0)\\rangle = \\begin{pmatrix} \\sin(0) \\\\ -\\cos(0) \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ -1 \\end{pmatrix}\n$$\nIn the limit $\\theta \\to 2\\pi$ from below:\n$$\n|\\phi_{-}(2\\pi)\\rangle = \\begin{pmatrix} \\sin(\\pi) \\\\ -\\cos(\\pi) \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}\n$$\nWe observe that $|\\phi_{-}(2\\pi)\\rangle = -|\\phi_{-}(0)\\rangle$. The eigenvector acquires a sign flip upon completing the loop. Because the vector does not return to its initial value, it is impossible to define a globally continuous, single-valued, *real* eigenvector field on the entire circle. Any such choice will necessarily have at least one point of discontinuity. This sign change is a defining characteristic of the geometric phase associated with encircling a conical intersection.\n\n**Part 3: Holonomy Calculation**\n\nThe holonomy is $W_{-}(\\mathcal{C}) = \\exp(i\\gamma_{-})$, where $\\gamma_{-} = \\oint_{\\mathcal{C}} \\mathbf{A}_{-}(Q) \\cdot d\\mathbf{Q}$ is the geometric phase. The integrand involves the Berry connection $\\mathbf{A}_{-}(Q) = i\\,\\langle \\phi_{-}(Q)\\,|\\,\\nabla_{Q}\\,\\phi_{-}(Q)\\rangle$.\nAs established, a real eigenvector $|\\phi_{-}(Q)\\rangle$ is not single-valued on $\\mathcal{C}$. A direct integration using a multi-valued state is subtle. It is more rigorous to first construct a single-valued, (necessarily) complex eigenvector $|\\psi_{-}(Q)\\rangle$ and then perform the integration. We can construct such a state by multiplying $|\\phi_{-}(\\theta)\\rangle$ by a suitable phase factor.\nLet $|\\psi_{-}(\\theta)\\rangle = e^{-i\\theta/2} |\\phi_{-}(\\theta)\\rangle$. Let us check its periodicity:\n$$\n|\\psi_{-}(0)\\rangle = e^{0} |\\phi_{-}(0)\\rangle = |\\phi_{-}(0)\\rangle\n$$\n$$\n|\\psi_{-}(2\\pi)\\rangle = e^{-i\\pi} |\\phi_{-}(2\\pi)\\rangle = (-1) \\cdot (-|\\phi_{-}(0)\\rangle) = |\\phi_{-}(0)\\rangle\n$$\nThe state $|\\psi_{-}(\\theta)\\rangle$ is single-valued and continuous on the circle $\\mathcal{C}$. We can now compute the geometric phase using this state. In polar coordinates, the line element is $d\\mathbf{Q} = \\rho d\\theta \\,\\hat{\\theta}$, and the gradient is $\\nabla_Q = \\hat{\\rho}\\frac{\\partial}{\\partial \\rho} + \\hat{\\theta}\\frac{1}{\\rho}\\frac{\\partial}{\\partial \\theta}$. The line integral becomes:\n$$\n\\gamma_{-} = \\oint_{\\mathcal{C}} i \\langle\\psi_{-}|\\nabla_Q\\psi_{-}\\rangle \\cdot d\\mathbf{Q} = i \\int_{0}^{2\\pi} \\langle\\psi_{-}| \\left( \\hat{\\rho}\\frac{\\partial}{\\partial \\rho} + \\hat{\\theta}\\frac{1}{\\rho}\\frac{\\partial}{\\partial \\theta} \\right) \\psi_{-}\\rangle \\cdot (\\rho d\\theta \\,\\hat{\\theta})\n$$\n$$\n\\gamma_{-} = i \\int_{0}^{2\\pi} \\langle\\psi_{-}(\\theta)| \\frac{\\partial\\psi_{-}(\\theta)}{\\partial \\theta} \\rangle d\\theta\n$$\nWe compute the integrand term $\\langle\\psi_{-}|\\partial_{\\theta}\\psi_{-}\\rangle$:\n$$\n|\\psi_{-}(\\theta)\\rangle = e^{-i\\theta/2} \\begin{pmatrix} \\sin(\\theta/2) \\\\ -\\cos(\\theta/2) \\end{pmatrix} = \\begin{pmatrix} e^{-i\\theta/2}\\sin(\\theta/2) \\\\ -e^{-i\\theta/2}\\cos(\\theta/2) \\end{pmatrix}\n$$\n$$\n\\frac{\\partial\\psi_{-}(\\theta)}{\\partial\\theta} = \\begin{pmatrix} -\\frac{i}{2}e^{-i\\theta/2}\\sin(\\theta/2) + \\frac{1}{2}e^{-i\\theta/2}\\cos(\\theta/2) \\\\ \\frac{i}{2}e^{-i\\theta/2}\\cos(\\theta/2) + \\frac{1}{2}e^{-i\\theta/2}\\sin(\\theta/2) \\end{pmatrix}\n$$\nThe inner product is $\\langle\\psi_{-}(\\theta)|\\partial_{\\theta}\\psi_{-}(\\theta)\\rangle$:\n$$\n\\langle\\psi_{-}|\\partial_{\\theta}\\psi_{-}\\rangle = e^{i\\theta/2}\\sin(\\frac{\\theta}{2}) \\left(-\\frac{i}{2}e^{-i\\theta/2}\\sin\\frac{\\theta}{2} + \\frac{1}{2}e^{-i\\theta/2}\\cos\\frac{\\theta}{2}\\right) - e^{i\\theta/2}\\cos(\\frac{\\theta}{2}) \\left(\\frac{i}{2}e^{-i\\theta/2}\\cos\\frac{\\theta}{2} + \\frac{1}{2}e^{-i\\theta/2}\\sin\\frac{\\theta}{2}\\right)\n$$\n$$\n= \\left(-\\frac{i}{2}\\sin^2\\frac{\\theta}{2} + \\frac{1}{2}\\sin\\frac{\\theta}{2}\\cos\\frac{\\theta}{2}\\right) - \\left(\\frac{i}{2}\\cos^2\\frac{\\theta}{2} + \\frac{1}{2}\\cos\\frac{\\theta}{2}\\sin\\frac{\\theta}{2}\\right)\n$$\n$$\n= -\\frac{i}{2}\\left(\\sin^2\\frac{\\theta}{2} + \\cos^2\\frac{\\theta}{2}\\right) = -\\frac{i}{2}\n$$\nThe geometric phase is then the integral of this constant:\n$$\n\\gamma_{-} = i \\int_{0}^{2\\pi} \\left(-\\frac{i}{2}\\right) d\\theta = \\frac{1}{2} \\int_{0}^{2\\pi} d\\theta = \\frac{1}{2}(2\\pi) = \\pi\n$$\nFinally, the holonomy $W_{-}(\\mathcal{C})$ is calculated:\n$$\nW_{-}(\\mathcal{C}) = \\exp(i\\gamma_{-}) = \\exp(i\\pi) = -1\n$$\nThis value of $-1$ is a hallmark of encircling a conical intersection in a two-level system. It is a gauge-invariant quantity.", "answer": "$$\n\\boxed{-1}\n$$", "id": "2876959"}, {"introduction": "Understanding the theoretical nature of conical intersections is crucial, but locating them in multi-dimensional molecular systems is a practical and essential skill in modern computational chemistry. This final practice guides you to design a robust computational algorithm to find minimum-energy points on a conical intersection seam using constrained optimization techniques. Successfully implementing this protocol [@problem_id:2876964] bridges the gap between idealized analytical models and the powerful numerical tools used to characterize the key geometric features that govern photochemistry and ultrafast dynamics.", "problem": "You are given a two-state linear vibronic coupling model that arises from the Born-Oppenheimer electronic Hamiltonian and its Born-Huang expansion, with a diabatic representation for two coupled electronic states. Let the nuclear coordinates be collected in a vector $\\mathbf{Q} \\in \\mathbb{R}^d$. The diabatic Hamiltonian is defined by\n$$\n\\mathbf{H}_{\\mathrm{dia}}(\\mathbf{Q}) = \\begin{pmatrix}\n\\alpha(\\mathbf{Q}) & \\beta(\\mathbf{Q}) \\\\\n\\beta(\\mathbf{Q}) & -\\alpha(\\mathbf{Q})\n\\end{pmatrix} + V_{\\mathrm{avg}}(\\mathbf{Q}) \\, \\mathbf{I},\n$$\nwhere\n$$\n\\alpha(\\mathbf{Q}) = \\boldsymbol{\\kappa}^{\\top} \\mathbf{Q} + \\varepsilon, \\quad \\beta(\\mathbf{Q}) = \\boldsymbol{\\lambda}^{\\top} \\mathbf{Q}, \\quad V_{\\mathrm{avg}}(\\mathbf{Q}) = \\tfrac{1}{2} \\mathbf{Q}^{\\top} \\mathbf{A} \\mathbf{Q}.\n$$\nHere $\\boldsymbol{\\kappa}, \\boldsymbol{\\lambda} \\in \\mathbb{R}^d$, $\\varepsilon \\in \\mathbb{R}$, and $\\mathbf{A} \\in \\mathbb{R}^{d \\times d}$ is a symmetric positive definite matrix. The adiabatic energies are\n$$\nE_{\\pm}(\\mathbf{Q}) = V_{\\mathrm{avg}}(\\mathbf{Q}) \\pm \\sqrt{\\alpha(\\mathbf{Q})^2 + \\beta(\\mathbf{Q})^2}.\n$$\nWithin this model, a conical intersection seam occurs where the degeneracy condition $E_{+}(\\mathbf{Q}) = E_{-}(\\mathbf{Q})$ holds, which is equivalent to the simultaneous vanishing of $\\alpha(\\mathbf{Q})$ and $\\beta(\\mathbf{Q})$. The branching-plane vectors are the gradient difference vector $\\mathbf{g} = \\nabla_{\\mathbf{Q}} \\alpha(\\mathbf{Q}) = \\boldsymbol{\\kappa}$ and the non-adiabatic coupling vector proxy $\\mathbf{h} = \\nabla_{\\mathbf{Q}} \\beta(\\mathbf{Q}) = \\boldsymbol{\\lambda}$ (in this linear model they are constants). A curve $\\mathbf{Q}(s)$ that lies on the seam and follows it must satisfy to first order both the degeneracy constraints and the orthogonality conditions\n$$\n\\alpha(\\mathbf{Q}(s)) = 0, \\quad \\beta(\\mathbf{Q}(s)) = 0, \\quad \\mathbf{g}^{\\top} \\tfrac{d\\mathbf{Q}}{ds} = 0, \\quad \\mathbf{h}^{\\top} \\tfrac{d\\mathbf{Q}}{ds} = 0.\n$$\nDesign a computational protocol to locate a minimum-energy point on the conical intersection seam by minimizing $V_{\\mathrm{avg}}(\\mathbf{Q})$ subject to the degeneracy constraints, and to compute a unit tangent direction at that point that lies on the seam by simultaneously enforcing the orthogonality conditions to the branching-plane vectors. Your protocol must be derived from first principles and implemented as a runnable program that:\n1. Solves for the minimum of $V_{\\mathrm{avg}}(\\mathbf{Q})$ subject to $\\alpha(\\mathbf{Q}) = 0$ and $\\beta(\\mathbf{Q}) = 0$ using a mathematically sound constrained optimization method grounded in Lagrange multipliers.\n2. Computes a unit tangent vector $\\mathbf{t}$ at the located point that minimizes the local quadratic form $\\mathbf{t}^{\\top} \\mathbf{A} \\mathbf{t}$ among all directions satisfying $\\boldsymbol{\\kappa}^{\\top} \\mathbf{t} = 0$ and $\\boldsymbol{\\lambda}^{\\top} \\mathbf{t} = 0$ and $\\lVert \\mathbf{t} \\rVert = 1$.\n3. Reports quantitative residuals that verify both degeneracy and orthogonality constraints.\n\nAll quantities are dimensionless. Angles do not appear. Your program must output, for each test case, the four floats\n$$\n\\left[ V_{\\mathrm{avg}}(\\mathbf{Q}_{\\ast}), \\; \\Delta E(\\mathbf{Q}_{\\ast}), \\; \\left\\lVert \\mathbf{C}\\mathbf{t} \\right\\rVert_2, \\; \\mathbf{t}^{\\top} \\mathbf{A} \\mathbf{t} \\right],\n$$\nwhere $\\mathbf{Q}_{\\ast}$ is the constrained minimizer (minimum-energy point on the seam), $\\Delta E(\\mathbf{Q}_{\\ast}) = E_{+}(\\mathbf{Q}_{\\ast}) - E_{-}(\\mathbf{Q}_{\\ast})$ is the adiabatic energy gap at the solution (should be numerically near zero), $\\mathbf{C} \\in \\mathbb{R}^{2 \\times d}$ is formed by stacking $\\boldsymbol{\\kappa}^{\\top}$ and $\\boldsymbol{\\lambda}^{\\top}$ as rows, and $\\mathbf{t}$ is the computed unit tangent vector. The orthogonality residual is $\\left\\lVert \\mathbf{C}\\mathbf{t} \\right\\rVert_2$, which should be numerically near zero. The curvature measure $\\mathbf{t}^{\\top} \\mathbf{A} \\mathbf{t}$ quantifies the quadratic energy rise along the chosen tangent.\n\nTest Suite:\n- Test case 1 (baseline orthogonal branching plane):\n  - $d = 3$,\n  - $\\mathbf{A} = \\begin{pmatrix} 1 & 0 & 0 \\\\ 0 & 1 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix}$,\n  - $\\boldsymbol{\\kappa} = (1, 0, 0)^{\\top}$,\n  - $\\boldsymbol{\\lambda} = (0, 1, 0)^{\\top}$,\n  - $\\varepsilon = 0$.\n- Test case 2 (generic, anisotropic curvature):\n  - $d = 3$,\n  - $\\mathbf{A} = \\begin{pmatrix} 3 & 0.2 & 0.1 \\\\ 0.2 & 2 & 0.3 \\\\ 0.1 & 0.3 & 1.5 \\end{pmatrix}$,\n  - $\\boldsymbol{\\kappa} = (1, 1, 0)^{\\top}$,\n  - $\\boldsymbol{\\lambda} = (1, -1, 1)^{\\top}$,\n  - $\\varepsilon = 0.5$.\n- Test case 3 (near-colinear branching-plane vectors, stability edge case):\n  - $d = 4$,\n  - $\\mathbf{A} = \\begin{pmatrix} 2.5 & 0.3 & 0.2 & 0.0 \\\\ 0.3 & 2.4 & 0.1 & 0.0 \\\\ 0.2 & 0.1 & 1.8 & 0.05 \\\\ 0.0 & 0.0 & 0.05 & 1.6 \\end{pmatrix}$,\n  - $\\boldsymbol{\\kappa} = (1, 0.99, 0, 0)^{\\top}$,\n  - $\\boldsymbol{\\lambda} = (0.99, 1, 0.01, 0)^{\\top}$,\n  - $\\varepsilon = -0.2$.\n\nYour program should produce a single line of output containing the results for the three test cases as a list of three lists, each inner list ordered as\n$$\n\\left[ V_{\\mathrm{avg}}(\\mathbf{Q}_{\\ast}), \\; \\Delta E(\\mathbf{Q}_{\\ast}), \\; \\left\\lVert \\mathbf{C}\\mathbf{t} \\right\\rVert_2, \\; \\mathbf{t}^{\\top} \\mathbf{A} \\mathbf{t} \\right],\n$$\nrounded to six decimal places, with no extra spaces. For example, the output format must be exactly like\n\"[[v11,v12,v13,v14],[v21,v22,v23,v24],[v31,v32,v33,v34]]\".", "solution": "We begin from the molecular Hamiltonian that, under the Born-Oppenheimer separation, is written as $\\hat{H} = \\hat{T}_{\\mathrm{nuc}} + \\hat{H}_{\\mathrm{el}}(\\mathbf{R})$, where $\\hat{T}_{\\mathrm{nuc}}$ is the nuclear kinetic energy operator and $\\hat{H}_{\\mathrm{el}}(\\mathbf{R})$ is the electronic Hamiltonian parametrized by nuclear coordinates $\\mathbf{R}$. The Born-Huang expansion expresses the total wavefunction as a sum over electronic states with nuclear wavefunctions and introduces non-adiabatic couplings that couple adiabatic states through nuclear derivatives. In a diabatic representation and a two-state model, the non-adiabatic couplings are encapsulated into off-diagonal diabatic couplings. The linear vibronic coupling model expresses the diabatic Hamiltonian for two states as\n$$\n\\mathbf{H}_{\\mathrm{dia}}(\\mathbf{Q}) = \\begin{pmatrix}\n\\alpha(\\mathbf{Q}) & \\beta(\\mathbf{Q}) \\\\\n\\beta(\\mathbf{Q}) & -\\alpha(\\mathbf{Q})\n\\end{pmatrix} + V_{\\mathrm{avg}}(\\mathbf{Q}) \\, \\mathbf{I},\n$$\nwith $\\alpha(\\mathbf{Q}) = \\boldsymbol{\\kappa}^{\\top} \\mathbf{Q} + \\varepsilon$ and $\\beta(\\mathbf{Q}) = \\boldsymbol{\\lambda}^{\\top} \\mathbf{Q}$, where $\\mathbf{Q}$ are mass-weighted nuclear coordinates. The adiabatic energies are\n$$\nE_{\\pm}(\\mathbf{Q}) = V_{\\mathrm{avg}}(\\mathbf{Q}) \\pm \\sqrt{\\alpha(\\mathbf{Q})^2 + \\beta(\\mathbf{Q})^2}.\n$$\nThe degeneracy condition $E_{+} = E_{-}$ is equivalent to $\\sqrt{\\alpha^2 + \\beta^2} = 0$, hence to $\\alpha(\\mathbf{Q}) = 0$ and $\\beta(\\mathbf{Q}) = 0$. In this model, the gradient difference vector and the non-adiabatic coupling vector proxy that span the branching plane are\n$$\n\\mathbf{g} = \\nabla_{\\mathbf{Q}} (E_{+} - E_{-}) \\bigg|_{\\alpha=\\beta=0} \\propto \\nabla_{\\mathbf{Q}} \\alpha(\\mathbf{Q}) = \\boldsymbol{\\kappa}, \\quad \\mathbf{h} \\propto \\nabla_{\\mathbf{Q}} \\beta(\\mathbf{Q}) = \\boldsymbol{\\lambda}.\n$$\nAt a point on the seam, any infinitesimal displacement $\\mathrm{d} \\mathbf{Q}$ that remains on the seam must not open the gap to first order. Linearizing the degeneracy constraints $\\alpha(\\mathbf{Q})=0$ and $\\beta(\\mathbf{Q})=0$ gives\n$$\n\\mathrm{d}\\alpha = \\boldsymbol{\\kappa}^{\\top} \\mathrm{d}\\mathbf{Q} = 0, \\quad \\mathrm{d}\\beta = \\boldsymbol{\\lambda}^{\\top} \\mathrm{d}\\mathbf{Q} = 0.\n$$\nTherefore, a seam tangent vector $\\mathbf{t}$ at any point on the seam must satisfy the orthogonality conditions\n$$\n\\boldsymbol{\\kappa}^{\\top} \\mathbf{t} = 0, \\quad \\boldsymbol{\\lambda}^{\\top} \\mathbf{t} = 0.\n$$\nThe minimum-energy conical intersection point on the seam minimizes the average diabatic potential\n$$\nV_{\\mathrm{avg}}(\\mathbf{Q}) = \\tfrac{1}{2} \\mathbf{Q}^{\\top} \\mathbf{A} \\mathbf{Q}\n$$\nsubject to the degeneracy constraints. This is a smooth equality-constrained optimization problem with two linear constraints. Using Lagrange multipliers, we form\n$$\n\\mathcal{L}(\\mathbf{Q}, \\boldsymbol{\\mu}) = \\tfrac{1}{2} \\mathbf{Q}^{\\top} \\mathbf{A} \\mathbf{Q} + \\mu_{1} \\, (\\boldsymbol{\\kappa}^{\\top} \\mathbf{Q} + \\varepsilon) + \\mu_{2} \\, (\\boldsymbol{\\lambda}^{\\top} \\mathbf{Q}),\n$$\nwith first-order optimality (Karush–Kuhn–Tucker) conditions\n$$\n\\nabla_{\\mathbf{Q}} \\mathcal{L} = \\mathbf{A} \\mathbf{Q} + \\mu_{1} \\boldsymbol{\\kappa} + \\mu_{2} \\boldsymbol{\\lambda} = \\mathbf{0}, \\quad \\boldsymbol{\\kappa}^{\\top} \\mathbf{Q} + \\varepsilon = 0, \\quad \\boldsymbol{\\lambda}^{\\top} \\mathbf{Q} = 0.\n$$\nCollect these into a block linear system by defining the constraint matrix\n$$\n\\mathbf{C} = \\begin{pmatrix} \\boldsymbol{\\kappa}^{\\top} \\\\ \\boldsymbol{\\lambda}^{\\top} \\end{pmatrix}, \\quad \\mathbf{c} = \\begin{pmatrix} \\varepsilon \\\\ 0 \\end{pmatrix}, \\quad \\boldsymbol{\\mu} = \\begin{pmatrix} \\mu_{1} \\\\ \\mu_{2} \\end{pmatrix}.\n$$\nThe KKT system is\n$$\n\\begin{pmatrix}\n\\mathbf{A} & \\mathbf{C}^{\\top} \\\\\n\\mathbf{C} & \\mathbf{0}\n\\end{pmatrix}\n\\begin{pmatrix}\n\\mathbf{Q}_{\\ast} \\\\\n\\boldsymbol{\\mu}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n\\mathbf{0} \\\\\n-\\mathbf{c}\n\\end{pmatrix}.\n$$\nBecause $\\mathbf{A}$ is positive definite and $\\mathbf{C}$ has full row rank in the well-posed case (linearly independent constraints), this saddle-point system has a unique solution for $(\\mathbf{Q}_{\\ast}, \\boldsymbol{\\mu})$, yielding the minimum-energy point on the seam.\n\nTo quantify degeneracy at the solution, we compute the adiabatic gap\n$$\n\\Delta E(\\mathbf{Q}_{\\ast}) = E_{+}(\\mathbf{Q}_{\\ast}) - E_{-}(\\mathbf{Q}_{\\ast}) = 2 \\sqrt{\\alpha(\\mathbf{Q}_{\\ast})^2 + \\beta(\\mathbf{Q}_{\\ast})^2},\n$$\nwhich should be numerically near zero.\n\nFor a tangent direction that follows the seam and simultaneously enforces the orthogonality conditions, we require $\\mathbf{t}$ to satisfy $\\mathbf{C} \\mathbf{t} = \\mathbf{0}$ and $\\lVert \\mathbf{t} \\rVert = 1$. Among all such directions, a natural choice that minimizes the local increase in $V_{\\mathrm{avg}}$ is the minimizer of the Rayleigh quotient\n$$\n\\min_{\\mathbf{t} \\in \\mathbb{R}^{d}} \\; \\mathbf{t}^{\\top} \\mathbf{A} \\mathbf{t} \\quad \\text{subject to} \\quad \\mathbf{C} \\mathbf{t} = \\mathbf{0}, \\; \\lVert \\mathbf{t} \\rVert = 1.\n$$\nLet $\\mathbf{Z} \\in \\mathbb{R}^{d \\times (d-2)}$ have orthonormal columns spanning the null space of $\\mathbf{C}$, i.e., $\\mathbf{C} \\mathbf{Z} = \\mathbf{0}$ and $\\mathbf{Z}^{\\top} \\mathbf{Z} = \\mathbf{I}$. Any feasible $\\mathbf{t}$ can be written as $\\mathbf{t} = \\mathbf{Z} \\mathbf{y}$ with $\\lVert \\mathbf{y} \\rVert = 1$. Then\n$$\n\\mathbf{t}^{\\top} \\mathbf{A} \\mathbf{t} = \\mathbf{y}^{\\top} \\left( \\mathbf{Z}^{\\top} \\mathbf{A} \\mathbf{Z} \\right) \\mathbf{y},\n$$\nwhich is minimized by choosing $\\mathbf{y}$ as the normalized eigenvector corresponding to the smallest eigenvalue of $\\mathbf{Z}^{\\top} \\mathbf{A} \\mathbf{Z}$. The resulting $\\mathbf{t}$ is orthogonal to both $\\boldsymbol{\\kappa}$ and $\\boldsymbol{\\lambda}$ by construction and has the smallest quadratic curvature with respect to $V_{\\mathrm{avg}}$.\n\nAlgorithmic design:\n1. For each test case, read $\\mathbf{A}$, $\\boldsymbol{\\kappa}$, $\\boldsymbol{\\lambda}$, and $\\varepsilon$ and construct $\\mathbf{C}$ and $\\mathbf{c}$.\n2. Solve the KKT system for $(\\mathbf{Q}_{\\ast}, \\boldsymbol{\\mu})$ using a direct linear solver. This yields the minimum-energy conical intersection point on the seam.\n3. Compute $V_{\\mathrm{avg}}(\\mathbf{Q}_{\\ast}) = \\tfrac{1}{2} \\mathbf{Q}_{\\ast}^{\\top} \\mathbf{A} \\mathbf{Q}_{\\ast}$, $\\alpha(\\mathbf{Q}_{\\ast}) = \\boldsymbol{\\kappa}^{\\top} \\mathbf{Q}_{\\ast} + \\varepsilon$, $\\beta(\\mathbf{Q}_{\\ast}) = \\boldsymbol{\\lambda}^{\\top} \\mathbf{Q}_{\\ast}$, and the adiabatic gap $\\Delta E(\\mathbf{Q}_{\\ast}) = 2 \\sqrt{\\alpha(\\mathbf{Q}_{\\ast})^2 + \\beta(\\mathbf{Q}_{\\ast})^2}$.\n4. Compute an orthonormal basis $\\mathbf{Z}$ for the null space of $\\mathbf{C}$ using singular value decomposition: if $\\mathbf{C} = \\mathbf{U} \\boldsymbol{\\Sigma} \\mathbf{V}^{\\top}$, then $\\mathbf{V}$ columns corresponding to zero singular values span the null space. Extract these columns to form $\\mathbf{Z}$.\n5. Form the reduced matrix $\\mathbf{M} = \\mathbf{Z}^{\\top} \\mathbf{A} \\mathbf{Z}$ and compute its smallest eigenpair $(\\lambda_{\\min}, \\mathbf{y}_{\\min})$. Set $\\mathbf{t} = \\mathbf{Z} \\mathbf{y}_{\\min}$ and normalize to unit length.\n6. Evaluate the orthogonality residual $\\lVert \\mathbf{C} \\mathbf{t} \\rVert_{2}$ and the curvature $\\mathbf{t}^{\\top} \\mathbf{A} \\mathbf{t}$ (which equals $\\lambda_{\\min}$ after normalization).\n7. Output for each test case the list $[ V_{\\mathrm{avg}}(\\mathbf{Q}_{\\ast}), \\Delta E(\\mathbf{Q}_{\\ast}), \\lVert \\mathbf{C} \\mathbf{t} \\rVert_{2}, \\mathbf{t}^{\\top} \\mathbf{A} \\mathbf{t} ]$, rounded to six decimals.\n\nNumerical considerations:\n- The KKT matrix is indefinite but well-conditioned when $\\mathbf{A}$ is positive definite and $\\mathbf{C}$ has full row rank. A direct solver with pivoting suffices for the small dense systems used here.\n- For near-colinear $\\boldsymbol{\\kappa}$ and $\\boldsymbol{\\lambda}$, use a singular value decomposition to robustly determine the null space basis and avoid numerical instability.\n- Rounding the outputs to six decimals provides a stable, comparable representation while preserving the physically relevant zero residuals within numerical tolerance.\n\nThe implemented program follows this protocol for the specified test suite and prints a single line containing the three result lists in the required format.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve_kkt(A, kappa, lam, eps):\n    \"\"\"\n    Solve the KKT system for minimizing 0.5 Q^T A Q subject to\n    kappa^T Q + eps = 0 and lam^T Q = 0.\n    Returns Q_star.\n    \"\"\"\n    d = A.shape[0]\n    C = np.vstack([kappa.reshape(1, -1), lam.reshape(1, -1)])  # 2 x d\n    c = np.array([eps, 0.0])\n    # Build KKT matrix and RHS:\n    KKT = np.block([[A, C.T],\n                    [C, np.zeros((2, 2))]])\n    rhs = np.concatenate([np.zeros(d), -c])\n    # Solve\n    sol = np.linalg.solve(KKT, rhs)\n    Q_star = sol[:d]\n    return Q_star\n\ndef adiabatic_gap_and_energy(Q, A, kappa, lam, eps):\n    \"\"\"\n    Compute V_avg(Q) and the adiabatic gap DeltaE at Q.\n    \"\"\"\n    Vavg = 0.5 * float(Q.T @ A @ Q)\n    alpha = float(kappa.T @ Q + eps)\n    beta = float(lam.T @ Q)\n    gap = 2.0 * np.sqrt(alpha**2 + beta**2)\n    return Vavg, gap, alpha, beta\n\ndef nullspace(C, rtol=1e-12):\n    \"\"\"\n    Compute an orthonormal basis for the null space of C using SVD.\n    Returns Z with shape (d, d - rank(C)).\n    \"\"\"\n    U, S, Vt = np.linalg.svd(C, full_matrices=True)\n    # Rank determination\n    tol = rtol * S.max() if S.size > 0 else 0.0\n    rank = int(np.sum(S > tol))\n    d = C.shape[1]\n    if rank > d:\n        # Should not happen, but guard anyway\n        rank = d\n    # Null space spanned by last d - rank rows of Vt\n    Z = Vt[rank:].T  # shape (d, d - rank)\n    return Z\n\ndef seam_tangent(A, kappa, lam):\n    \"\"\"\n    Compute a unit tangent vector t that lies on the seam (orthogonal to kappa and lam),\n    minimizing t^T A t subject to ||t||=1 and C t = 0.\n    Returns t (unit vector) and curvature value t^T A t.\n    \"\"\"\n    C = np.vstack([kappa.reshape(1, -1), lam.reshape(1, -1)])  # 2 x d\n    Z = nullspace(C)\n    # If nullspace is empty (degenerate case), raise error\n    if Z.size == 0 or Z.shape[1] == 0:\n        # Fall back: try to find any vector orthogonal to both using least squares\n        d = C.shape[1]\n        # Project identity onto nullspace numerically using QR of C^T\n        Qc, _ = np.linalg.qr(C.T)\n        # Build projector onto nullspace approx\n        P = np.eye(d) - Qc[:, :C.shape[0]] @ Qc[:, :C.shape[0]].T\n        # Choose a random vector and project\n        v = np.zeros(d)\n        v[-1] = 1.0\n        t = P @ v\n        nrm = np.linalg.norm(t)\n        if nrm  1e-14:\n            # As a last resort, return zeros to avoid crash; curvature is NaN\n            return np.zeros(d), np.nan\n        t = t / nrm\n        curv = float(t.T @ A @ t)\n        return t, curv\n    # Reduced matrix\n    M = Z.T @ A @ Z\n    # Smallest eigenpair\n    evals, evecs = np.linalg.eigh(M)\n    idx = np.argmin(evals)\n    y = evecs[:, idx]\n    t = Z @ y\n    # Normalize to unit length\n    nrm = np.linalg.norm(t)\n    if nrm  1e-14:\n        # Numerical issue; pick another direction\n        # Choose next eigenvector if available\n        if evecs.shape[1] > 1:\n            y = evecs[:, (idx + 1) % evecs.shape[1]]\n            t = Z @ y\n            nrm = np.linalg.norm(t)\n            if nrm  1e-14:\n                # Give up gracefully\n                return np.zeros(Z.shape[0]), np.nan\n        else:\n            return np.zeros(Z.shape[0]), np.nan\n    t = t / nrm\n    curv = float(t.T @ A @ t)\n    return t, curv\n\ndef format_results(results):\n    # Format as [[a,b,c,d],[...],...] with six decimals and no spaces\n    def fmt(x):\n        if np.isnan(x) or np.isinf(x):\n            return \"nan\"\n        return f\"{x:.6f}\"\n    inner = []\n    for lst in results:\n        inner.append(\"[\" + \",\".join(fmt(v) for v in lst) + \"]\")\n    return \"[\" + \",\".join(inner) + \"]\"\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Test case 1\n    A1 = np.array([[1.0, 0.0, 0.0],\n                   [0.0, 1.0, 0.0],\n                   [0.0, 0.0, 1.0]])\n    k1 = np.array([1.0, 0.0, 0.0])\n    l1 = np.array([0.0, 1.0, 0.0])\n    eps1 = 0.0\n\n    # Test case 2\n    A2 = np.array([[3.0, 0.2, 0.1],\n                   [0.2, 2.0, 0.3],\n                   [0.1, 0.3, 1.5]])\n    k2 = np.array([1.0, 1.0, 0.0])\n    l2 = np.array([1.0, -1.0, 1.0])\n    eps2 = 0.5\n\n    # Test case 3\n    A3 = np.array([[2.5, 0.3, 0.2, 0.0],\n                   [0.3, 2.4, 0.1, 0.0],\n                   [0.2, 0.1, 1.8, 0.05],\n                   [0.0, 0.0, 0.05, 1.6]])\n    k3 = np.array([1.0, 0.99, 0.0, 0.0])\n    l3 = np.array([0.99, 1.0, 0.01, 0.0])\n    eps3 = -0.2\n\n    test_cases = [\n        (A1, k1, l1, eps1),\n        (A2, k2, l2, eps2),\n        (A3, k3, l3, eps3),\n    ]\n\n    results = []\n    for A, kappa, lam, eps in test_cases:\n        Q_star = solve_kkt(A, kappa, lam, eps)\n        Vavg, gap, alpha, beta = adiabatic_gap_and_energy(Q_star, A, kappa, lam, eps)\n        t, curvature = seam_tangent(A, kappa, lam)\n        C = np.vstack([kappa.reshape(1, -1), lam.reshape(1, -1)])\n        orth_resid = float(np.linalg.norm(C @ t))\n        results.append([Vavg, gap, orth_resid, curvature])\n\n    # Final print statement in the exact required format.\n    print(format_results(results))\n\nsolve()\n```", "id": "2876964"}]}