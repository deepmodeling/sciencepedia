{"hands_on_practices": [{"introduction": "Before any quantum algorithm can be applied to a chemical system, the electronic Hamiltonian must be translated into the language of qubits. This exercise walks you through the foundational process of fermion-to-qubit mapping, a critical bridge between second quantization and quantum computation. By performing this transformation for a simple yet representative molecule like $\\mathrm{H}_2$, you will gain hands-on experience in constructing a qubit Hamiltonian from fundamental one- and two-electron integrals [@problem_id:2917703].", "problem": "Consider the dihydrogen molecule $\\mathrm{H}_2$ in a minimal basis with two spatial molecular orbitals, the bonding orbital $g$ and the antibonding orbital $u$. Work in the spin-orbital basis ordered as $0 \\equiv g\\alpha$, $1 \\equiv g\\beta$, $2 \\equiv u\\alpha$, $3 \\equiv u\\beta$. Assume the following data are given and that the molecular orbitals are canonical so that the one-electron integrals are diagonal in this basis.\n\n1. Nuclear repulsion energy: $E_{\\mathrm{N}}$ (Hartree).\n2. One-electron integrals: $h_{00} = h_{11} = \\varepsilon_{g}$, $h_{22} = h_{33} = \\varepsilon_{u}$, and $h_{pq} = 0$ for $p \\neq q$.\n3. The only nonzero antisymmetrized two-electron integrals $\\langle pq \\| rs \\rangle$ (all in Hartree) are those with $p=r$ and $q=s$, with the distinct values:\n   - $\\langle 0\\,1 \\| 0\\,1 \\rangle = J_{gg}$,\n   - $\\langle 2\\,3 \\| 2\\,3 \\rangle = J_{uu}$,\n   - $\\langle 0\\,2 \\| 0\\,2 \\rangle = \\langle 1\\,3 \\| 1\\,3 \\rangle = J_{gu} - K_{gu}$,\n   - $\\langle 0\\,3 \\| 0\\,3 \\rangle = \\langle 1\\,2 \\| 1\\,2 \\rangle = J_{gu}$.\n\nStarting from the second-quantized electronic Hamiltonian and using the Jordan–Wigner transformation (qubit $i$ encodes spin-orbital $i$, with the ordering above), construct the explicit $4$-qubit Hamiltonian as a linear combination of tensor products of Pauli operators. Enumerate all distinct Pauli strings that appear and give their coefficients symbolically in terms of $E_{\\mathrm{N}}$, $\\varepsilon_{g}$, $\\varepsilon_{u}$, $J_{gg}$, $J_{uu}$, $J_{gu}$, and $K_{gu}$. Express all energy coefficients in Hartree. Your final answer must be a single closed-form analytic expression for the qubit Hamiltonian written as a linear combination of Pauli strings acting on the four qubits in the given order. Do not substitute numerical values and do not reduce the number of qubits by using symmetries.", "solution": "The problem requires the construction of a $4$-qubit Hamiltonian for the $\\mathrm{H}_2$ molecule in a minimal basis, starting from the second-quantized electronic Hamiltonian and using the Jordan-Wigner transformation.\n\nFirst, the problem statement is validated.\nGivens:\n1.  System: $\\mathrm{H}_2$ molecule, minimal basis of two spatial molecular orbitals, $g$ (bonding) and $u$ (antibonding).\n2.  Spin-orbital basis: Four spin-orbitals indexed $0, 1, 2, 3$ corresponding to $g\\alpha, g\\beta, u\\alpha, u\\beta$.\n3.  Nuclear repulsion energy: $E_{\\mathrm{N}}$.\n4.  One-electron integrals: $h_{00} = h_{11} = \\varepsilon_{g}$, $h_{22} = h_{33} = \\varepsilon_{u}$, with $h_{pq} = 0$ for $p \\neq q$.\n5.  Two-electron integrals: The only nonzero antisymmetrized integrals $\\langle pq \\| rs \\rangle$ are those with $p=r$ and $q=s$. The specific non-zero values are given as:\n    $\\langle 0\\,1 \\| 0\\,1 \\rangle = J_{gg}$\n    $\\langle 2\\,3 \\| 2\\,3 \\rangle = J_{uu}$\n    $\\langle 0\\,2 \\| 0\\,2 \\rangle = \\langle 1\\,3 \\| 1\\,3 \\rangle = J_{gu} - K_{gu}$\n    $\\langle 0\\,3 \\| 0\\,3 \\rangle = \\langle 1\\,2 \\| 1\\,2 \\rangle = J_{gu}$\n\nValidation Verdict:\nThe problem is scientifically grounded, well-posed, and objective. It provides a complete set of symbolic parameters to construct a Hamiltonian for a standard model system in quantum chemistry. The key simplification lies in the constraint on the two-electron integrals. A literal interpretation of \"the only nonzero antisymmetrized two-electron integrals $\\langle pq \\| rs \\rangle$ are those with $p=r$ and $q=s$\" severely restricts the form of the two-electron operator. This is a strong but syntactically clear premise. The problem is therefore deemed **valid**, and a solution can be constructed based on this premise.\n\nThe electronic Hamiltonian in second quantization is given by\n$$ \\hat{H} = E_{\\mathrm{N}} + \\sum_{p,q} h_{pq} \\hat{a}_p^\\dagger \\hat{a}_q + \\frac{1}{4} \\sum_{p,q,r,s} \\langle pq \\| rs \\rangle \\hat{a}_p^\\dagger \\hat{a}_q^\\dagger \\hat{a}_s \\hat{a}_r $$\nwhere $\\hat{a}_p^\\dagger$ and $\\hat{a}_p$ are the fermionic creation and annihilation operators for the spin-orbital $p$.\n\nThe one-electron term is simplified by the diagonal nature of $h_{pq}$:\n$$ \\hat{H}^{(1)} = \\sum_{p} h_{pp} \\hat{a}_p^\\dagger \\hat{a}_p = \\sum_{p} \\varepsilon_p \\hat{n}_p = \\varepsilon_g(\\hat{n}_0 + \\hat{n}_1) + \\varepsilon_u(\\hat{n}_2 + \\hat{n}_3) $$\nwhere $\\hat{n}_p = \\hat{a}_p^\\dagger \\hat{a}_p$ is the number operator for spin-orbital $p$.\n\nFor the two-electron term, the problem's constraint that only integrals with $p=r$ and $q=s$ are non-zero simplifies the sum to:\n$$ \\hat{H}^{(2)} = \\frac{1}{4} \\sum_{p,q} \\langle pq \\| pq \\rangle \\hat{a}_p^\\dagger \\hat{a}_q^\\dagger \\hat{a}_q \\hat{a}_p $$\nThe terms where $p=q$ are zero because $(\\hat{a}_p^\\dagger)^2 = 0$. For $p \\neq q$, the anticommutation rules give $\\hat{a}_p^\\dagger \\hat{a}_q^\\dagger \\hat{a}_q \\hat{a}_p = \\hat{n}_p \\hat{n}_q$. The sum is over all ordered pairs $(p,q)$ where $p \\neq q$. We can rewrite this as a sum over unordered pairs $\\{p,q\\}$ where $p  q$:\n$$ \\hat{H}^{(2)} = \\frac{1}{4} \\sum_{p  q} \\left( \\langle pq \\| pq \\rangle \\hat{n}_p \\hat{n}_q + \\langle qp \\| qp \\rangle \\hat{n}_q \\hat{n}_p \\right) $$\nUsing the property $\\langle qp \\| qp \\rangle = \\langle pq \\| pq \\rangle$ and that number operators commute ($\\hat{n}_p \\hat{n}_q = \\hat{n}_q \\hat{n}_p$), this becomes:\n$$ \\hat{H}^{(2)} = \\frac{1}{4} \\sum_{p  q} 2 \\langle pq \\| pq \\rangle \\hat{n}_p \\hat{n}_q = \\frac{1}{2} \\sum_{p  q} \\langle pq \\| pq \\rangle \\hat{n}_p \\hat{n}_q $$\nSubstituting the given integral values:\n$$ \\hat{H}^{(2)} = \\frac{1}{2} \\left( J_{gg}\\hat{n}_0\\hat{n}_1 + J_{uu}\\hat{n}_2\\hat{n}_3 + (J_{gu}-K_{gu})(\\hat{n}_0\\hat{n}_2 + \\hat{n}_1\\hat{n}_3) + J_{gu}(\\hat{n}_0\\hat{n}_3 + \\hat{n}_1\\hat{n}_2) \\right) $$\nThe total Hamiltonian in second quantization is:\n$$ \\hat{H} = E_{\\mathrm{N}} + \\varepsilon_g(\\hat{n}_0+\\hat{n}_1) + \\varepsilon_u(\\hat{n}_2+\\hat{n}_3) + \\frac{1}{2} \\left( J_{gg}\\hat{n}_0\\hat{n}_1 + J_{uu}\\hat{n}_2\\hat{n}_3 + (J_{gu}-K_{gu})(\\hat{n}_0\\hat{n}_2 + \\hat{n}_1\\hat{n}_3) + J_{gu}(\\hat{n}_0\\hat{n}_3 + \\hat{n}_1\\hat{n}_2) \\right) $$\nNext, we apply the Jordan-Wigner transformation. For a qubit register where qubit $j$ encodes spin-orbital $j$, the number operator transforms as:\n$$ \\hat{n}_j = \\frac{1}{2}(I_j - Z_j) $$\nwhere $I_j$ is the identity operator and $Z_j$ is the Pauli-$Z$ operator on qubit $j$. We substitute this into the Hamiltonian and expand. For clarity, the tensor product symbol $\\otimes$ and identity operators on other qubits are omitted (e.g., $Z_0$ implies $Z_0 \\otimes I_1 \\otimes I_2 \\otimes I_3$).\n\nThe one-electron part becomes:\n$$ \\hat{H}^{(1)} = \\varepsilon_g\\left(\\frac{I-Z_0}{2} + \\frac{I-Z_1}{2}\\right) + \\varepsilon_u\\left(\\frac{I-Z_2}{2} + \\frac{I-Z_3}{2}\\right) = (\\varepsilon_g + \\varepsilon_u)I - \\frac{\\varepsilon_g}{2}(Z_0+Z_1) - \\frac{\\varepsilon_u}{2}(Z_2+Z_3) $$\nThe two-electron part contains products of number operators:\n$$ \\hat{n}_p\\hat{n}_q = \\frac{1}{4}(I - Z_p - Z_q + Z_p Z_q) $$\nSubstituting this for each term in $\\hat{H}^{(2)}$ and summing up all contributions for each Pauli string:\n\n1.  **Constant Term ($I$):**\n    From $E_{\\mathrm{N}}$: $E_{\\mathrm{N}}$\n    From $\\hat{H}^{(1)}$: $\\varepsilon_g + \\varepsilon_u$\n    From $\\hat{H}^{(2)}$: $\\frac{1}{2} \\times \\frac{1}{4}(J_{gg} + J_{uu} + (J_{gu}-K_{gu})\\times 2 + J_{gu}\\times 2) = \\frac{1}{8}(J_{gg} + J_{uu} + 4J_{gu} - 2K_{gu})$\n    Total constant $c_I = E_{\\mathrm{N}} + \\varepsilon_g + \\varepsilon_u + \\frac{1}{8}(J_{gg} + J_{uu} + 4J_{gu} - 2K_{gu})$.\n\n2.  **Single-Z Terms ($Z_j$):**\n    - $Z_0$: From $\\hat{H}^{(1)}$: $-\\frac{\\varepsilon_g}{2}$. From $\\hat{H}^{(2)}$ terms involving $n_0$: $\\frac{1}{2} \\times (-\\frac{1}{4})(J_{gg} + (J_{gu}-K_{gu}) + J_{gu})$.\n      Coefficient $c_0 = -\\frac{\\varepsilon_g}{2} - \\frac{1}{8}(J_{gg} + 2J_{gu} - K_{gu})$.\n    - $Z_1$: By symmetry with $Z_0$, $c_1 = -\\frac{\\varepsilon_g}{2} - \\frac{1}{8}(J_{gg} + 2J_{gu} - K_{gu})$.\n    - $Z_2$: From $\\hat{H}^{(1)}$: $-\\frac{\\varepsilon_u}{2}$. From $\\hat{H}^{(2)}$ terms involving $n_2$: $\\frac{1}{2} \\times (-\\frac{1}{4})(J_{uu} + (J_{gu}-K_{gu}) + J_{gu})$.\n      Coefficient $c_2 = -\\frac{\\varepsilon_u}{2} - \\frac{1}{8}(J_{uu} + 2J_{gu} - K_{gu})$.\n    - $Z_3$: By symmetry with $Z_2$, $c_3 = -\\frac{\\varepsilon_u}{2} - \\frac{1}{8}(J_{uu} + 2J_{gu} - K_{gu})$.\n\n3.  **Two-Z Terms ($Z_p Z_q$):**\n    The coefficient of $Z_p Z_q$ is $\\frac{1}{2} \\times \\frac{1}{4} = \\frac{1}{8}$ of the coefficient of the corresponding $\\hat{n}_p\\hat{n}_q$ term's integral.\n    - $Z_0 Z_1$: $c_{01} = \\frac{1}{8}J_{gg}$.\n    - $Z_2 Z_3$: $c_{23} = \\frac{1}{8}J_{uu}$.\n    - $Z_0 Z_2$: $c_{02} = \\frac{1}{8}(J_{gu}-K_{gu})$.\n    - $Z_1 Z_3$: $c_{13} = \\frac{1}{8}(J_{gu}-K_{gu})$.\n    - $Z_0 Z_3$: $c_{03} = \\frac{1}{8}J_{gu}$.\n    - $Z_1 Z_2$: $c_{12} = \\frac{1}{8}J_{gu}$.\n\nNo other Pauli strings (e.g., involving X or Y) appear because the Hamiltonian in this simplified model is diagonal in the Fock basis.\n\nThe final qubit Hamiltonian is the sum of all Pauli strings multiplied by their derived coefficients:\n$$ \\hat{H} = c_I I + c_0 Z_0 + c_1 Z_1 + c_2 Z_2 + c_3 Z_3 + c_{01}Z_0Z_1 + c_{23}Z_2Z_3 + c_{02}Z_0Z_2 + c_{13}Z_1Z_3 + c_{03}Z_0Z_3 + c_{12}Z_1Z_2 $$\nSubstituting the symbolic coefficients gives the complete expression.", "answer": "$$\n\\boxed{\n\\begin{aligned}\n\\hat{H} =  \\left(E_{\\mathrm{N}} + \\varepsilon_g + \\varepsilon_u + \\frac{1}{8}(J_{gg} + J_{uu} + 4J_{gu} - 2K_{gu})\\right) I \\\\\n - \\left(\\frac{\\varepsilon_g}{2} + \\frac{1}{8}(J_{gg} + 2J_{gu} - K_{gu})\\right) (Z_0 + Z_1) \\\\\n - \\left(\\frac{\\varepsilon_u}{2} + \\frac{1}{8}(J_{uu} + 2J_{gu} - K_{gu})\\right) (Z_2 + Z_3) \\\\\n + \\frac{1}{8}J_{gg} Z_0 Z_1 + \\frac{1}{8}J_{uu} Z_2 Z_3 + \\frac{1}{8}(J_{gu}-K_{gu}) (Z_0 Z_2 + Z_1 Z_3) + \\frac{1}{8}J_{gu} (Z_0 Z_3 + Z_1 Z_2)\n\\end{aligned}\n}\n$$", "id": "2917703"}, {"introduction": "Quantum Phase Estimation (QPE) is a cornerstone algorithm capable of determining eigenvalues to high precision, but its power comes at a cost. This practice problem delves into the crucial task of resource estimation, guiding you to calculate the number of quantum operations and experimental repetitions needed to achieve chemical accuracy for a target system [@problem_id:2917715]. Understanding these trade-offs between precision, initial state quality, and computational cost is fundamental to assessing the feasibility of future quantum algorithms.", "problem": "Consider the hydrogen molecule $\\mathrm{H}_{2}$ in a minimal basis, restricted to the fixed particle-number and singlet-spin symmetry sector. You will estimate its ground-state energy using Quantum Phase Estimation (QPE). The electronic Hamiltonian in this sector is denoted by $\\hat{H}$ and has a known spectral width bound $W$ (the difference between the maximum and minimum eigenvalues in the sector). Assume:\n- A conservative a priori bound $W = 4$ Hartree.\n- The Hartree–Fock (HF) trial state $\\lvert \\mathrm{HF} \\rangle$ has squared overlap $p = \\lvert \\langle \\mathrm{HF} \\vert \\psi_{0} \\rangle \\rvert^{2} = 0.8$ with the exact ground state $\\lvert \\psi_{0} \\rangle$.\n- You implement standard QPE on the unitary $U = \\exp\\!\\big(-i(\\hat{H}-E_{\\mathrm{ref}}) t_{0}\\big)$ with a fixed time step $t_{0}$ chosen so that $W t_{0} \\leq 2\\pi$, and you select the largest such value $t_{0} = 2\\pi/W$.\n- You use the binary-controlled power schedule $U^{2^{k}}$ for $k = 0,1,\\dots,m-1$, with $m$ ancilla qubits, and count cost in terms of controlled-evolution queries as follows: one query is one invocation of a controlled-$U$ at time step $t_{0}$. Implementing $U^{2^{k}}$ uses $2^{k}$ such queries.\n- Conditioned on starting in an eigenstate of $\\hat{H}$, QPE returns an $m$-bit estimate of the phase that, upon rounding to the nearest grid point, yields an energy estimate with absolute discretization error at most $\\Delta E = W/2^{m}$; ignore any additional constant-factor failure probability of the inverse Quantum Fourier Transform by assuming ideal noiseless gates and perfect rounding to the nearest grid point.\n- The only stochasticity considered arises from the probabilistic projection of the HF state onto the ground state during QPE; you repeat the full QPE experiment independently $R$ times and take the best energy estimate observed. You require an overall success probability at least $0.9$ that at least one run returns the ground-state energy within the target precision.\n\nYour tasks:\n1. Determine the minimum number $m$ of phase bits needed so that the energy resolution is at most $1$ milli-Hartree, i.e., $\\varepsilon_{E} = 0.001$ Hartree.\n2. Using this $m$, compute the total number of controlled-evolution queries per single QPE run, $N_{q}$, under the query model specified above.\n3. Given the HF overlap $p = 0.8$, compute the minimum number of independent repetitions $R$ needed so that the probability that at least one run yields the ground-state energy within $\\varepsilon_{E}$ is at least $0.9$.\n\nExpress the final answer as a row matrix $\\begin{pmatrix} N_{q}  R \\end{pmatrix}$ with no units. If any numerical value requires rounding, round to an integer by taking the minimal integer that satisfies the specified requirement. No other rounding is needed.", "solution": "The problem statement is analyzed and determined to be valid, as it constitutes a well-posed, scientifically grounded problem in the field of quantum algorithms for quantum chemistry. We proceed with the solution.\n\nThe problem is divided into three parts, which we will solve sequentially.\n\nFirst, we determine the minimum number of phase bits, $m$, required for the Quantum Phase Estimation (QPE) algorithm. The energy resolution from the discretization of the phase is given as $\\Delta E = W/2^{m}$, where $W$ is the spectral width of the Hamiltonian in the relevant sector. We are given $W = 4$ Hartree and require the energy precision $\\varepsilon_{E}$ to be at most $0.001$ Hartree. The condition is therefore:\n$$\n\\Delta E \\leq \\varepsilon_{E}\n$$\nSubstituting the given expressions and values:\n$$\n\\frac{W}{2^{m}} \\leq \\varepsilon_{E} \\implies \\frac{4}{2^{m}} \\leq 0.001\n$$\nThis inequality can be rearranged to solve for $m$:\n$$\n2^{m} \\geq \\frac{4}{0.001} = 4000\n$$\nTo find the minimum integer value of $m$ that satisfies this condition, we take the base-$2$ logarithm of both sides:\n$$\nm \\geq \\log_{2}(4000)\n$$\nWe can evaluate this logarithm:\n$$\n\\log_{2}(4000) = \\log_{2}(2^{2} \\times 10^{3}) = \\log_{2}(2^{2}) + \\log_{2}(10^{3}) = 2 + 3\\log_{2}(10)\n$$\nUsing the approximation $\\log_{2}(10) \\approx 3.3219$, we find:\n$$\nm \\geq 2 + 3 \\times 3.3219 = 2 + 9.9657 = 11.9657\n$$\nSince $m$ must be an integer, we must choose the smallest integer that is greater than or equal to $11.9657$.\n$$\nm = \\lceil 11.9657 \\rceil = 12\n$$\nThus, a minimum of $m=12$ phase bits are required.\n\nSecond, we calculate the total number of controlled-evolution queries, $N_{q}$, for a single QPE run. The problem specifies a binary-controlled power schedule for the unitary $U = \\exp\\!\\big(-i(\\hat{H}-E_{\\mathrm{ref}}) t_{0}\\big)$, involving controlled gates of the form $U^{2^{k}}$ for $k = 0, 1, \\dots, m-1$. The cost of implementing a controlled-$U^{2^{k}}$ operation is stated to be $2^{k}$ queries. The total query cost $N_{q}$ is the sum of the costs for all controlled operations in one QPE run.\n$$\nN_{q} = \\sum_{k=0}^{m-1} 2^{k}\n$$\nThis is a standard geometric series, the sum of which is:\n$$\nN_{q} = \\frac{2^{m}-1}{2-1} = 2^{m} - 1\n$$\nSubstituting the value $m=12$ which we determined previously:\n$$\nN_{q} = 2^{12} - 1 = 4096 - 1 = 4095\n$$\nSo, a single run of QPE requires $N_{q} = 4095$ queries.\n\nThird, we compute the minimum number of independent QPE repetitions, $R$, to achieve the desired overall success probability. The probability of success in a single run is given by the squared overlap $p$ between the initial Hartree-Fock state $\\lvert \\mathrm{HF} \\rangle$ and the true ground state $\\lvert \\psi_{0} \\rangle$. We are given $p = \\lvert \\langle \\mathrm{HF} \\vert \\psi_{0} \\rangle \\rvert^{2} = 0.8$. The probability of failure in a single run is therefore $1-p = 1 - 0.8 = 0.2$.\n\nWe require that the probability of obtaining the ground-state energy in at least one of the $R$ independent runs is at least $0.9$. The probability of failure in all $R$ runs is $(1-p)^{R}$. The probability of at least one success is the complement:\n$$\nP(\\text{at least one success}) = 1 - (1-p)^{R}\n$$\nWe impose the condition:\n$$\n1 - (1-p)^{R} \\geq 0.9\n$$\nSubstituting the value of $p$:\n$$\n1 - (0.2)^{R} \\geq 0.9\n$$\nRearranging the inequality gives:\n$$\n0.1 \\geq (0.2)^{R}\n$$\nTo find the minimum integer $R$ that satisfies this, we take the logarithm of both sides. As the base of the logarithm is greater than $1$, the inequality is preserved for the arguments. Taking the natural logarithm, $\\ln$:\n$$\n\\ln(0.1) \\geq \\ln((0.2)^{R}) = R \\ln(0.2)\n$$\nSince $\\ln(0.2)$ is a negative number, dividing by it reverses the direction of the inequality:\n$$\nR \\geq \\frac{\\ln(0.1)}{\\ln(0.2)}\n$$\nNumerically, this is approximately:\n$$\nR \\geq \\frac{-2.3026}{-1.6094} \\approx 1.4307\n$$\nSince $R$ must be an integer, we take the smallest integer value that satisfies this condition:\n$$\nR = \\lceil 1.4307 \\rceil = 2\n$$\nThus, a minimum of $R=2$ repetitions are needed.\n\nThe final answer is required as a row matrix $\\begin{pmatrix} N_{q}  R \\end{pmatrix}$. We have found $N_{q} = 4095$ and $R=2$.", "answer": "$$\n\\boxed{\\begin{pmatrix} 4095  2 \\end{pmatrix}}\n$$", "id": "2917715"}, {"introduction": "The Variational Quantum Eigensolver (VQE) offers a pragmatic approach for near-term devices but introduces its own set of challenges, including managing various error sources. This problem places you in the role of an algorithm designer, tasked with optimally allocating an error budget between finite measurement statistics and ansatz imperfections to minimize the total computational cost [@problem_id:2917691]. This advanced exercise highlights the sophisticated optimization required to extract meaningful results from resource-constrained quantum hardware.", "problem": "A Variational Quantum Eigensolver (VQE) estimates the ground-state energy of a molecular electronic Hamiltonian by sampling expectation values of Pauli operators on a parameterized quantum circuit. Consider a VQE implementation in which two independent error sources dominate the final energy error: finite-sampling (measurement) error and ansatz truncation error. Assume the following physically motivated models.\n\n1. Measurement error: If $N$ independent circuit executions (shots) are performed in total (across all operator groups, after any classical post-processing and measurement grouping), the standard deviation of the energy estimator scales as $\\epsilon_{m} = \\kappa / \\sqrt{N}$, where $\\kappa$ aggregates the effective post-grouping variance of the Hamiltonian. Take $\\kappa = 5.0 \\times 10^{-2}$ Hartree$\\cdot\\sqrt{\\text{shot}}$.\n\n2. Ansatz truncation error: For an operator-pool or layered excitation ansatz truncated after $r$ layers (treated as a continuous positive variable), suppose the systematic energy bias decays exponentially as $\\epsilon_{t}(r) = \\alpha \\exp(-\\beta r)$, with $\\alpha = 1.0 \\times 10^{-1}$ Hartree and $\\beta = 5.0 \\times 10^{-1}$ per layer.\n\n3. Resource model: The two-qubit gate count per circuit execution scales linearly with ansatz depth as $g(r) = g_{0} + g_{1} r$, with $g_{0} = 2.0 \\times 10^{2}$ and $g_{1} = 4.0 \\times 10^{1}$. The total two-qubit gate executions required are $C = N \\, g(r)$.\n\nYour goal is to allocate an error budget across $\\epsilon_{m}$ and $\\epsilon_{t}$ to guarantee that the total energy error satisfies $\\epsilon_{m} + \\epsilon_{t} \\le E_{\\text{tol}}$ with minimal $C$, where the tolerance is $E_{\\text{tol}} = 1$ milliHartree $= 1.0 \\times 10^{-3}$ Hartree. Work in the continuous approximation for $r$ and $N$ for optimization, but compute a final real-valued $C$ using the given parameters.\n\nStarting from the basic statistical scaling $\\epsilon_{m} = \\kappa / \\sqrt{N}$ and the exponential truncation model $\\epsilon_{t}(r) = \\alpha \\exp(-\\beta r)$, and without introducing any additional unprovided formulas, determine the minimal achievable total two-qubit gate executions $C_{\\min}$ that satisfy $\\epsilon_{m} + \\epsilon_{t} \\le E_{\\text{tol}}$.\n\nRound your final answer for $C_{\\min}$ to three significant figures. Express the final result as a pure number (i.e., the count of two-qubit gate executions). No other quantity is required in the final answer.", "solution": "The problem presented is a constrained optimization task. We are required to find the minimal total number of two-qubit gate executions, $C$, subject to a constraint on the total energy error. The problem is well-posed and scientifically grounded in the context of resource estimation for variational quantum algorithms.\n\nThe objective function to be minimized is the total two-qubit gate count, $C$:\n$$C(N, r) = N \\cdot g(r) = N (g_{0} + g_{1} r)$$\nwhere $N$ is the total number of measurement shots and $r$ is the number of ansatz layers.\n\nThe minimization is subject to the constraint that the sum of the measurement error, $\\epsilon_{m}$, and the ansatz truncation error, $\\epsilon_{t}$, does not exceed a specified tolerance, $E_{\\text{tol}}$. The cost function $C(N, r)$ is a monotonically increasing function of both $N$ and $r$ for $r  0$. Therefore, the minimum cost will be achieved when the error constraint is active, that is, when the total error is exactly equal to the tolerance:\n$$\\epsilon_{m} + \\epsilon_{t} = E_{\\text{tol}}$$\nSubstituting the given models for the error terms, the constraint becomes:\n$$\\frac{\\kappa}{\\sqrt{N}} + \\alpha \\exp(-\\beta r) = E_{\\text{tol}}$$\n\nThis is a problem of minimizing $C(N, r)$ subject to the constraint $\\Phi(N, r) = \\frac{\\kappa}{\\sqrt{N}} + \\alpha \\exp(-\\beta r) - E_{\\text{tol}} = 0$. We will use the method of Lagrange multipliers. The Lagrangian, $\\mathcal{L}$, is defined as:\n$$\\mathcal{L}(N, r, \\lambda) = C(N, r) - \\lambda \\Phi(N, r)$$\n$$\\mathcal{L}(N, r, \\lambda) = N(g_{0} + g_{1} r) - \\lambda \\left( \\frac{\\kappa}{\\sqrt{N}} + \\alpha \\exp(-\\beta r) - E_{\\text{tol}} \\right)$$\n\nTo find the extremum, we set the partial derivatives of $\\mathcal{L}$ with respect to $N$, $r$, and $\\lambda$ to zero.\nThe partial derivative with respect to $N$ is:\n$$\\frac{\\partial \\mathcal{L}}{\\partial N} = (g_{0} + g_{1} r) - \\lambda \\left(-\\frac{1}{2}\\kappa N^{-3/2}\\right) = g(r) + \\frac{\\lambda \\kappa}{2 N^{3/2}} = 0 \\quad (1)$$\nThe partial derivative with respect to $r$ is:\n$$\\frac{\\partial \\mathcal{L}}{\\partial r} = N g_{1} - \\lambda \\left(-\\alpha \\beta \\exp(-\\beta r)\\right) = N g_{1} + \\lambda \\alpha \\beta \\exp(-\\beta r) = 0 \\quad (2)$$\nThe partial derivative with respect to $\\lambda$ recovers the constraint equation.\n\nFrom equation (1), we solve for the Lagrange multiplier $\\lambda$:\n$$\\lambda = -\\frac{2 N^{3/2} g(r)}{\\kappa}$$\nFrom equation (2), we also solve for $\\lambda$:\n$$\\lambda = -\\frac{N g_{1}}{\\alpha \\beta \\exp(-\\beta r)}$$\n\nEquating these two expressions for $\\lambda$ gives the condition for optimality:\n$$-\\frac{2 N^{3/2} g(r)}{\\kappa} = -\\frac{N g_{1}}{\\alpha \\beta \\exp(-\\beta r)}$$\n$$\\frac{2 \\sqrt{N} g(r)}{\\kappa} = \\frac{g_{1}}{\\alpha \\beta \\exp(-\\beta r)}$$\nWe recognize the error terms $\\epsilon_{m} = \\kappa/\\sqrt{N}$ and $\\epsilon_{t} = \\alpha \\exp(-\\beta r)$. Substituting these into the optimality condition yields a concise relationship between the error contributions and the resource costs:\n$$\\frac{2 g(r)}{\\epsilon_{m}} = \\frac{g_{1}}{\\beta \\epsilon_{t}} \\quad \\implies \\quad 2 \\beta g(r) \\epsilon_{t} = g_{1} \\epsilon_{m}$$\nThis equation provides the optimal partitioning of the total error budget $E_{\\text{tol}}$ between measurement error and truncation error.\n\nWe now have a system of two equations for the optimal error values $\\epsilon_{m}^*$ and $\\epsilon_{t}^*$:\n$$1) \\quad \\epsilon_{m}^* + \\epsilon_{t}^* = E_{\\text{tol}}$$\n$$2) \\quad 2 \\beta \\left(g_{0} + g_{1} r^*\\right) \\epsilon_{t}^* = g_{1} \\epsilon_{m}^*$$\nThe optimal depth $r^*$ is itself a function of $\\epsilon_{t}^*$ via the relation $\\epsilon_{t}^* = \\alpha \\exp(-\\beta r^*)$, which implies $r^* = \\frac{1}{\\beta} \\ln\\left(\\frac{\\alpha}{\\epsilon_{t}^*}\\right)$. Substituting this into the second equation:\n$$2 \\beta \\left(g_{0} + \\frac{g_{1}}{\\beta} \\ln\\left(\\frac{\\alpha}{\\epsilon_{t}^*}\\right)\\right) \\epsilon_{t}^* = g_{1} \\left(E_{\\text{tol}} - \\epsilon_{t}^*\\right)$$\n$$2 \\beta g_{0} \\epsilon_{t}^* + 2 g_{1} \\epsilon_{t}^* \\ln\\left(\\frac{\\alpha}{\\epsilon_{t}^*}\\right) = g_{1} E_{\\text{tol}} - g_{1} \\epsilon_{t}^*$$\nRearranging terms, we obtain a single transcendental equation for the optimal truncation error, $\\epsilon_{t}^*$:\n$$\\left(2 \\beta g_{0} + g_{1}\\right) \\epsilon_{t}^* + 2 g_{1} \\epsilon_{t}^* \\left(\\ln(\\alpha) - \\ln(\\epsilon_{t}^*)\\right) = g_{1} E_{\\text{tol}}$$\n$$\\epsilon_{t}^* \\left[ (2 \\beta g_{0} + g_{1} + 2 g_{1} \\ln \\alpha) - 2 g_{1} \\ln \\epsilon_{t}^* \\right] = g_{1} E_{\\text{tol}}$$\n\nNow, we substitute the given numerical values:\n$\\alpha = 1.0 \\times 10^{-1}$ Hartree\n$\\beta = 5.0 \\times 10^{-1}$ per layer\n$g_{0} = 2.0 \\times 10^{2}$\n$g_{1} = 4.0 \\times 10^{1}$\n$E_{\\text{tol}} = 1.0 \\times 10^{-3}$ Hartree\n\nThe coefficients are:\n$2 \\beta g_{0} + g_{1} = 2(0.5)(200) + 40 = 240$\n$2 g_{1} = 2(40) = 80$\n$\\ln \\alpha = \\ln(0.1) \\approx -2.302585$\n$g_{1} E_{\\text{tol}} = 40 \\times (1.0 \\times 10^{-3}) = 0.04$\n\nThe equation for $\\epsilon_{t}^*$ (letting $x = \\epsilon_{t}^*$) becomes:\n$$x [ (240 + 80 \\times (-2.302585)) - 80 \\ln x ] = 0.04$$\n$$x [ (240 - 184.2068) - 80 \\ln x ] = 0.04$$\n$$x [ 55.7932 - 80 \\ln x ] = 0.04$$\n\nThis equation must be solved numerically for $x = \\epsilon_{t}^*$. Using a numerical root-finding method (such as Newton's method or simply testing values), we find the solution to be approximately $\\epsilon_{t}^* \\approx 4.688 \\times 10^{-5}$ Hartree.\n\nWith this optimal value for $\\epsilon_{t}^*$, we can determine all other quantities:\n1.  Optimal measurement error:\n    $$\\epsilon_{m}^* = E_{\\text{tol}} - \\epsilon_{t}^* = 1.0 \\times 10^{-3} - 4.688 \\times 10^{-5} = 9.5312 \\times 10^{-4} \\text{ Hartree}$$\n2.  Optimal number of ansatz layers:\n    $$r^* = \\frac{1}{\\beta} \\ln\\left(\\frac{\\alpha}{\\epsilon_{t}^*}\\right) = \\frac{1}{0.5} \\ln\\left(\\frac{0.1}{4.688 \\times 10^{-5}}\\right) = 2 \\ln(2133.1) \\approx 2 \\times 7.6654 = 15.3308$$\n3.  Optimal number of shots:\n    $$N^* = \\left(\\frac{\\kappa}{\\epsilon_{m}^*}\\right)^2 = \\left(\\frac{5.0 \\times 10^{-2}}{9.5312 \\times 10^{-4}}\\right)^2 \\approx (52.459)^2 \\approx 2751.9$$\n4.  Gate count per circuit execution at optimal depth:\n    $$g(r^*) = g_{0} + g_{1} r^* = 200 + 40 \\times 15.3308 = 200 + 613.232 = 813.232$$\n5.  Minimal total two-qubit gate executions:\n    $$C_{\\min} = N^* \\cdot g(r^*) = 2751.9 \\times 813.232 \\approx 2238064$$\n\nThe problem requires the final answer to be rounded to three significant figures.\n$$C_{\\min} \\approx 2.24 \\times 10^6$$\nThis represents the minimal computational cost required to achieve the desired accuracy under the given error and resource models.", "answer": "$$\n\\boxed{2.24 \\times 10^{6}}\n$$", "id": "2917691"}]}