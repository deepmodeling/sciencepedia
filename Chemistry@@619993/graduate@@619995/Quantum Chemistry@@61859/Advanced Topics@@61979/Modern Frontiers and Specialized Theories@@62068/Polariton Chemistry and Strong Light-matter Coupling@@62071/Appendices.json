{"hands_on_practices": [{"introduction": "The quantum Rabi Hamiltonian is the cornerstone for describing the interaction between a two-level system and a single light mode. In many contexts, it is simplified to the Jaynes-Cummings model via the rotating-wave approximation (RWA), which neglects rapidly oscillating \"counter-rotating\" terms. This practice challenges you to look beyond this common approximation and explore its consequences [@problem_id:2915325]. By deriving the Bloch-Siegert shift, you will use perturbation theory to quantify the frequency renormalization induced by these counter-rotating terms, gaining a deeper understanding of the physics governing the transition from strong to ultrastrong coupling.", "problem": "A single molecular vibration coupled to a single electromagnetic cavity mode can be modeled by the quantum Rabi Hamiltonian\n$$\n\\hat{H} = \\hbar \\omega \\hat{a}^{\\dagger} \\hat{a} + \\frac{\\hbar \\omega_{0}}{2}\\hat{\\sigma}_{z} + \\hbar g \\left(\\hat{a} + \\hat{a}^{\\dagger}\\right)\\left(\\hat{\\sigma}_{+} + \\hat{\\sigma}_{-}\\right),\n$$\nwhere $\\omega$ is the cavity angular frequency, $\\omega_{0}$ is the molecular transition angular frequency, $g$ is the light-matter coupling rate, $\\hat{a}$ and $\\hat{a}^{\\dagger}$ are the photon annihilation and creation operators, and $\\hat{\\sigma}_{\\pm}$ and $\\hat{\\sigma}_{z}$ are Pauli operators acting on the two-level molecular subspace. The rotating-wave approximation retains only the energy-conserving interaction $\\hbar g\\left(\\hat{a}\\hat{\\sigma}_{+} + \\hat{a}^{\\dagger}\\hat{\\sigma}_{-}\\right)$ and neglects the counter-rotating interaction $\\hbar g\\left(\\hat{a}\\hat{\\sigma}_{-} + \\hat{a}^{\\dagger}\\hat{\\sigma}_{+}\\right)$.\n\nStarting from time-independent perturbation theory or an equivalent unitary (Schrieffer–Wolff) transformation that eliminates the counter-rotating interaction to second order, derive the leading-order correction to the molecular transition frequency induced by the counter-rotating terms in the small parameter $g/(\\omega + \\omega_{0})$. Work to order $g^{2}$ and assume $g/(\\omega + \\omega_{0}) \\ll 1$. Identify the resulting frequency renormalization (Bloch–Siegert shift) of the matter transition.\n\nNext, consider the cavity tuned to molecular resonance, $\\omega = \\omega_{0}$. For numerical estimation, take $g/(2\\pi) = 0.200\\,\\text{THz}$ and $\\omega_{0}/(2\\pi) = 30.0\\,\\text{THz}$. Compute the corresponding Bloch–Siegert shift as a frequency in megahertz. Round your final numerical answer to three significant figures. Express the final frequency in megahertz (MHz).", "solution": "The total Hamiltonian can be written as $\\hat{H} = \\hat{H}_0 + \\hat{V}_{\\text{RWA}} + \\hat{V}_{\\text{CRT}}$, where the non-interacting part is $\\hat{H}_0 = \\hbar \\omega \\hat{a}^{\\dagger} \\hat{a} + \\frac{\\hbar \\omega_{0}}{2}\\hat{\\sigma}_{z}$, the rotating-wave term is $\\hat{V}_{\\text{RWA}} = \\hbar g(\\hat{a}\\hat{\\sigma}_{+} + \\hat{a}^{\\dagger}\\hat{\\sigma}_{-})$, and the counter-rotating term is $\\hat{V}_{\\text{CRT}} = \\hbar g(\\hat{a}\\hat{\\sigma}_{-} + \\hat{a}^{\\dagger}\\hat{\\sigma}_{+})$. The task is to find an effective Hamiltonian that incorporates the effects of the off-resonant counter-rotating terms as a perturbation to the Jaynes-Cummings model $\\hat{H}_{\\text{JC}} = \\hat{H}_0 + \\hat{V}_{\\text{RWA}}$. We use a Schrieffer-Wolff transformation, which generates an effective Hamiltonian $\\hat{H}_{\\text{eff}} = e^{S}\\hat{H}e^{-S}$. The generator $S$ is an anti-hermitian operator chosen to eliminate the first-order off-diagonal terms, $\\hat{V}_{\\text{CRT}}$, by satisfying the condition $[S, \\hat{H}_0] = -\\hat{V}_{\\text{CRT}}$.\n\nThe effective Hamiltonian, expanded to second order in the perturbation parameter $g$, is\n$$\n\\hat{H}_{\\text{eff}} \\approx \\hat{H}_0 + \\hat{V}_{\\text{RWA}} + \\frac{1}{2}[S, \\hat{V}_{\\text{CRT}}]\n$$\nWe propose an ansatz for the anti-hermitian generator $S = \\alpha(\\hat{a}\\hat{\\sigma}_{-} - \\hat{a}^{\\dagger}\\hat{\\sigma}_{+})$. We compute the commutator:\n$$\n[S, \\hat{H}_0] = \\alpha( [\\hat{a}\\hat{\\sigma}_{-}, \\hat{H}_0] - [\\hat{a}^{\\dagger}\\hat{\\sigma}_{+}, \\hat{H}_0] ) = \\alpha\\hbar(\\omega+\\omega_0)(\\hat{a}\\hat{\\sigma}_{-} + \\hat{a}^{\\dagger}\\hat{\\sigma}_{+})\n$$\nSetting this equal to $-\\hat{V}_{\\text{CRT}} = -\\hbar g(\\hat{a}\\hat{\\sigma}_{-} + \\hat{a}^{\\dagger}\\hat{\\sigma}_{+})$ yields $\\alpha = -g/(\\omega+\\omega_0)$.\nThe generator is thus $S = -\\frac{g}{\\omega+\\omega_0}(\\hat{a}\\hat{\\sigma}_{-} - \\hat{a}^{\\dagger}\\hat{\\sigma}_{+})$. The second-order correction to the Hamiltonian is $\\Delta\\hat{H}^{(2)} = \\frac{1}{2}[S, \\hat{V}_{\\text{CRT}}]$.\n$$\n\\Delta\\hat{H}^{(2)} = \\frac{1}{2} \\left[ -\\frac{g}{\\omega+\\omega_0}(\\hat{a}\\hat{\\sigma}_{-} - \\hat{a}^{\\dagger}\\hat{\\sigma}_{+}), \\hbar g(\\hat{a}\\hat{\\sigma}_{-} + \\hat{a}^{\\dagger}\\hat{\\sigma}_{+}) \\right] = -\\frac{\\hbar g^2}{\\omega+\\omega_0} [\\hat{a}\\hat{\\sigma}_{-}, \\hat{a}^{\\dagger}\\hat{\\sigma}_{+}]\n$$\nUsing $[\\hat{a}, \\hat{a}^{\\dagger}] = 1$ and $[\\hat{\\sigma}_{-}, \\hat{\\sigma}_{+}] = -\\hat{\\sigma}_z$, we compute the final commutator:\n$$\n[\\hat{a}\\hat{\\sigma}_{-}, \\hat{a}^{\\dagger}\\hat{\\sigma}_{+}] = \\hat{a}\\hat{a}^{\\dagger}\\hat{\\sigma}_{-}\\hat{\\sigma}_{+} - \\hat{a}^{\\dagger}\\hat{a}\\hat{\\sigma}_{+}\\hat{\\sigma}_{-} = \\hat{a}^{\\dagger}\\hat{a}[\\hat{\\sigma}_{-}, \\hat{\\sigma}_{+}] + \\hat{\\sigma}_{-}\\hat{\\sigma}_{+}\n$$\nUsing $\\hat{\\sigma}_{-}\\hat{\\sigma}_{+} = |g\\rangle\\langle g| = \\frac{1}{2}(\\hat{I}-\\hat{\\sigma}_z)$, we get:\n$$\n[\\hat{a}\\hat{\\sigma}_{-}, \\hat{a}^{\\dagger}\\hat{\\sigma}_{+}] = -\\hat{a}^{\\dagger}\\hat{a}\\hat{\\sigma}_z + \\frac{1}{2}(\\hat{I}-\\hat{\\sigma}_z) = -(\\hat{a}^{\\dagger}\\hat{a} + \\frac{1}{2})\\hat{\\sigma}_z + \\frac{1}{2}\\hat{I}\n$$\nThe correction term becomes:\n$$\n\\Delta\\hat{H}^{(2)} = -\\frac{\\hbar g^2}{\\omega+\\omega_0} \\left( -(\\hat{a}^{\\dagger}\\hat{a} + \\frac{1}{2})\\hat{\\sigma}_z + \\frac{1}{2}\\hat{I} \\right) = \\frac{\\hbar g^2}{\\omega+\\omega_0}(\\hat{a}^{\\dagger}\\hat{a} + \\frac{1}{2})\\hat{\\sigma}_z - \\frac{\\hbar g^2}{2(\\omega+\\omega_0)}\\hat{I}\n$$\nThe effective Hamiltonian to order $g^2$ contains the terms proportional to $\\hat{\\sigma}_z$:\n$$\n\\frac{\\hbar\\omega_0}{2}\\hat{\\sigma}_z + \\frac{\\hbar g^2}{\\omega+\\omega_0}(\\hat{a}^{\\dagger}\\hat{a} + \\frac{1}{2})\\hat{\\sigma}_z = \\frac{\\hbar}{2}\\left(\\omega_0 + \\frac{2g^2}{\\omega+\\omega_0}(\\hat{a}^{\\dagger}\\hat{a} + \\frac{1}{2})\\right)\\hat{\\sigma}_z\n$$\nThe molecular transition frequency $\\omega_0$ is renormalized. The Bloch-Siegert shift is conventionally defined as the part of this frequency correction that is independent of the photon number, representing the shift due to vacuum-field fluctuations. This corresponds to the case where the expectation value of $\\hat{a}^{\\dagger}\\hat{a}$ is zero. The resulting frequency renormalization is:\n$$\n\\delta\\omega_0 = \\frac{g^2}{\\omega+\\omega_0}\n$$\nThis is the analytical expression for the Bloch-Siegert shift.\n\nNext, we compute the numerical value of this shift. The problem specifies the resonance condition $\\omega = \\omega_0$. Under this condition, the shift becomes:\n$$\n\\delta\\omega_0 = \\frac{g^2}{2\\omega_0}\n$$\nThe problem provides linear frequencies $f = \\omega/(2\\pi)$. Let $f_g = g/(2\\pi)$ and $f_0 = \\omega_0/(2\\pi)$. We need to calculate the shift as a linear frequency, $\\delta f_0 = \\delta\\omega_0/(2\\pi)$.\n$$\n\\delta f_0 = \\frac{1}{2\\pi} \\frac{g^2}{2\\omega_0} = \\frac{(2\\pi f_g)^2}{4\\pi(2\\pi f_0)} = \\frac{4\\pi^2 f_g^2}{8\\pi^2 f_0} = \\frac{f_g^2}{2f_0}\n$$\nThe given values are $f_g = 0.200\\,\\text{THz} = 0.200 \\times 10^{12}\\,\\text{Hz}$ and $f_0 = 30.0\\,\\text{THz} = 30.0 \\times 10^{12}\\,\\text{Hz}$.\n$$\n\\delta f_0 = \\frac{(0.200 \\times 10^{12}\\,\\text{Hz})^2}{2 \\times (30.0 \\times 10^{12}\\,\\text{Hz})} = \\frac{0.0400 \\times 10^{24}\\,\\text{Hz}^2}{60.0 \\times 10^{12}\\,\\text{Hz}} = \\frac{0.0400}{60.0} \\times 10^{12}\\,\\text{Hz}\n$$\n$$\n\\delta f_0 = \\frac{1}{1500} \\times 10^{12}\\,\\text{Hz} \\approx 6.666\\ldots \\times 10^8\\,\\text{Hz}\n$$\nThe question asks for the frequency shift in megahertz ($1\\,\\text{MHz} = 10^6\\,\\text{Hz}$).\n$$\n\\delta f_0 = 6.666\\ldots \\times 10^2\\,\\text{MHz} = 666.66\\ldots\\,\\text{MHz}\n$$\nRounding this to three significant figures gives $667\\,\\text{MHz}$.", "answer": "$$\\boxed{667}$$", "id": "2915325"}, {"introduction": "The hallmark of strong light-matter coupling in experimental spectroscopy is the splitting of a resonance peak into two distinct polaritonic branches. However, real-world systems are not ideal; they are \"open\" and experience energy dissipation and dephasing. This exercise introduces the non-Hermitian coupled-oscillator model, a standard theoretical tool for describing such dissipative systems [@problem_id:2915362]. Your task is to derive an analytical expression for the normal-mode splitting, which will reveal how the coherent coupling strength $g$ must overcome the system's decoherence rates, represented by linewidths $\\kappa$ and $\\gamma$, to produce an observable spectral split.", "problem": "Consider a single plasmonic nanoparticle supporting a localized surface plasmon mode that couples to a collectively bright molecular exciton. In the linear-response regime under weak plane-wave illumination, the dark-field scattering spectrum is well described by the poles of the coupled light–matter response. Model the system as two coupled damped harmonic oscillators: a cavity-like plasmon with resonance angular frequency $\\omega_{c}$ and intensity full-width-at-half-maximum (FWHM) linewidth $\\kappa$, and an exciton with resonance angular frequency $\\omega_{x}$ and homogeneous dephasing rate (intensity FWHM) $\\gamma$. The coherent light–matter coupling rate is $g$ (in angular frequency units). Assume the system is tuned to zero detuning, that is, $\\omega_{c}=\\omega_{x}$.\n\nAdopt the standard effective non-Hermitian description of the coupled system in the frequency domain, where the complex poles of the response are the eigenvalues of the $2\\times 2$ matrix with diagonal elements $\\omega_{c}- i\\,\\kappa/2$ and $\\omega_{x}- i\\,\\gamma/2$, and off-diagonal elements $g$. The observable normal-mode splitting in dark-field scattering, $\\delta\\omega_{\\mathrm{split}}$, is defined as the separation between the real parts of the two hybrid-mode poles at zero detuning.\n\nAssume that the plasmonic linewidth is set by its quality factor $Q$ via $\\kappa=\\omega_{c}/Q$ (intensity FWHM definition), and that the excitonic homogeneous dephasing rate is $\\gamma$. Starting from the coupled-oscillator description and on-resonance condition $\\omega_{c}=\\omega_{x}$, derive a closed-form analytic expression for the on-resonance normal-mode splitting $\\delta\\omega_{\\mathrm{split}}$ in terms of $g$, $\\omega_{c}$, $Q$, and $\\gamma$.\n\nExpress the final answer in angular frequency units (radians per second). No numerical evaluation is required.", "solution": "The poles of the coupled system's response are the eigenvalues, which we denote by $\\tilde{\\omega}$, of the effective non-Hermitian Hamiltonian matrix, $H_{\\mathrm{eff}}$. Under the specified on-resonance condition, $\\omega_{c} = \\omega_{x}$, the matrix is:\n$$\nH_{\\mathrm{eff}} = \\begin{pmatrix}\n\\omega_{c} - i\\,\\frac{\\kappa}{2} & g \\\\\ng & \\omega_{c} - i\\,\\frac{\\gamma}{2}\n\\end{pmatrix}\n$$\nThe eigenvalues $\\tilde{\\omega}$ are found by solving the characteristic equation, $\\det(H_{\\mathrm{eff}} - \\tilde{\\omega}I) = 0$, where $I$ is the $2\\times 2$ identity matrix.\n$$\n\\det\\begin{pmatrix}\n\\omega_{c} - i\\,\\frac{\\kappa}{2} - \\tilde{\\omega} & g \\\\\ng & \\omega_{c} - i\\,\\frac{\\gamma}{2} - \\tilde{\\omega}\n\\end{pmatrix} = 0\n$$\nExpanding the determinant gives the quadratic equation for the eigenvalues:\n$$\n\\left(\\omega_{c} - i\\,\\frac{\\kappa}{2} - \\tilde{\\omega}\\right)\\left(\\omega_{c} - i\\,\\frac{\\gamma}{2} - \\tilde{\\omega}\\right) - g^2 = 0\n$$\nTo simplify, let us define a variable $z = \\tilde{\\omega} - \\omega_{c}$. The equation transforms to:\n$$\n\\left(-z - i\\,\\frac{\\kappa}{2}\\right)\\left(-z - i\\,\\frac{\\gamma}{2}\\right) - g^2 = 0\n$$\n$$\nz^2 + i\\left(\\frac{\\kappa + \\gamma}{2}\\right)z - \\frac{\\kappa\\gamma}{4} - g^2 = 0\n$$\nThis is a standard quadratic equation in $z$. We solve for $z$ using the quadratic formula:\n$$\nz_{\\pm} = \\frac{-i\\frac{\\kappa+\\gamma}{2} \\pm \\sqrt{\\left(i\\frac{\\kappa+\\gamma}{2}\\right)^2 - 4(1)\\left(-g^2 - \\frac{\\kappa\\gamma}{4}\\right)}}{2}\n$$\nSimplifying the term under the square root (the discriminant):\n$$\n\\Delta = -\\left(\\frac{\\kappa+\\gamma}{2}\\right)^2 + 4g^2 + \\kappa\\gamma = 4g^2 - \\frac{\\kappa^2-2\\kappa\\gamma+\\gamma^2}{4} = 4g^2 - \\left(\\frac{\\kappa-\\gamma}{2}\\right)^2\n$$\nSubstituting this back into the expression for $z_{\\pm}$:\n$$\nz_{\\pm} = -i\\frac{\\kappa+\\gamma}{4} \\pm \\frac{1}{2}\\sqrt{4g^2 - \\left(\\frac{\\kappa-\\gamma}{2}\\right)^2}\n$$\nThe eigenvalues are $\\tilde{\\omega}_{\\pm} = \\omega_{c} + z_{\\pm}$. Therefore, the two complex poles are:\n$$\n\\tilde{\\omega}_{\\pm} = \\omega_{c} - i\\frac{\\kappa+\\gamma}{4} \\pm \\frac{1}{2}\\sqrt{4g^2 - \\left(\\frac{\\kappa-\\gamma}{2}\\right)^2}\n$$\nThe normal-mode splitting, $\\delta\\omega_{\\mathrm{split}}$, is defined as the separation between the real parts of these two poles. For a splitting to be observed, the coupling must be strong enough such that the argument of the square root is positive, i.e., $4g^2 > \\left(\\frac{\\kappa-\\gamma}{2}\\right)^2$. In this regime, the square root is a real number.\nThe real parts of the eigenvalues are:\n$$\n\\mathrm{Re}(\\tilde{\\omega}_{+}) = \\omega_{c} + \\frac{1}{2}\\sqrt{4g^2 - \\left(\\frac{\\kappa-\\gamma}{2}\\right)^2}\n$$\n$$\n\\mathrm{Re}(\\tilde{\\omega}_{-}) = \\omega_{c} - \\frac{1}{2}\\sqrt{4g^2 - \\left(\\frac{\\kappa-\\gamma}{2}\\right)^2}\n$$\nThe normal-mode splitting is then calculated as the absolute difference between these real parts:\n$$\n\\delta\\omega_{\\mathrm{split}} = |\\mathrm{Re}(\\tilde{\\omega}_{+}) - \\mathrm{Re}(\\tilde{\\omega}_{-})| = \\sqrt{4g^2 - \\left(\\frac{\\kappa-\\gamma}{2}\\right)^2}\n$$\nFinally, we substitute the given expression for the plasmonic linewidth, $\\kappa = \\frac{\\omega_{c}}{Q}$, into this result.\n$$\n\\delta\\omega_{\\mathrm{split}} = \\sqrt{4g^2 - \\left(\\frac{\\frac{\\omega_{c}}{Q}-\\gamma}{2}\\right)^2} = \\sqrt{4g^2 - \\left(\\frac{\\omega_{c} - Q\\gamma}{2Q}\\right)^2}\n$$\nThis is the final closed-form analytic expression for the on-resonance normal-mode splitting.", "answer": "$$\n\\boxed{\\sqrt{4g^2 - \\left(\\frac{\\omega_c - Q\\gamma}{2Q}\\right)^2}}\n$$", "id": "2915362"}, {"introduction": "Bridging fundamental theory with practical prediction is a key skill in computational science. This exercise guides you in developing a computational model for polaritonic systems based on the principles of Quantum Electrodynamical Time-Dependent Density Functional Theory (QED-TDDFT) [@problem_id:2915405]. You will construct and diagonalize an effective Hamiltonian to determine the energies and compositions of hybrid light-matter states. This hands-on problem illuminates the concepts of Hopfield coefficients—which describe the matter and photon character of each polariton—and the crucial phenomenon of oscillator strength redistribution, a key signature of polariton formation.", "problem": "Consider a nonrelativistic molecular system in the electric-dipole approximation interacting with quantized radiation inside a lossless cavity. The coupled electron–photon system is described by the Pauli–Fierz Hamiltonian in the length gauge, which, together with the Runge–Gross theorem, underpins Quantum Electrodynamical (QED) Time-Dependent Density Functional Theory (TDDFT). Starting from the time-dependent Kohn–Sham mapping where the interacting electron–photon system is represented by noninteracting Kohn–Sham electrons coupled to photon coordinates through mean fields, perform a linear-response analysis. Assume the following standard and well-tested starting points: (i) the time-dependent Kohn–Sham equations for electrons under an effective scalar potential that functionally depends on the electron density and photon coordinates, (ii) harmonic photon modes with canonical coordinates and momenta, and (iii) the electric-dipole and long-wavelength approximations in the length gauge. Work within the single-excitation subspace for the electronic response and adopt the Tamm–Dancoff approximation to the electronic sector. \n\nYour tasks are:\n- Derive the linear-response QED–TDDFT equations that determine the polaritonic excitation frequencies and eigenvectors when one bright electronic transition couples bilinearly to a set of cavity photon modes. Clearly identify how the matter subspace and the photonic subspace enter the Hermitian eigenvalue problem under the Tamm–Dancoff approximation and justify why the resulting eigenvectors can be interpreted as Hopfield coefficients (the amplitudes of electronic and photonic components in a polaritonic mode).\n- Define how to compute a dimensionless oscillator strength for each polaritonic mode that is consistent with the Thomas–Reiche–Kuhn sum rule in the reduced single-bright-excitation model. The oscillator strength for a polaritonic mode should be expressed as the product of the bare electronic oscillator strength and the squared magnitude of the electronic component of the corresponding normalized polaritonic eigenvector. Use atomic units throughout.\n\nNumerical implementation requirements:\n- Use a minimal, universal model consistent with the derived equations in which there is exactly one bright electronic excitation with energy $\\Omega_{\\mathrm{e}}$ (in Hartree) and transition dipole magnitude $\\mu_{\\mathrm{e}}$ (in atomic units), coupled linearly to $N_{\\mathrm{p}}$ photon modes of frequencies $\\{\\omega_{\\alpha}\\}_{\\alpha=1}^{N_{\\mathrm{p}}}$ (in Hartree) with coupling strengths $\\{g_{\\alpha}\\}_{\\alpha=1}^{N_{\\mathrm{p}}}$ (in Hartree). The Tamm–Dancoff polaritonic eigenproblem must be a real-symmetric Hermitian problem whose normalized eigenvectors decompose into one electronic amplitude and $N_{\\mathrm{p}}$ photonic amplitudes. The Hopfield coefficient associated with the electronic sector for mode $k$ is the first component $C_{\\mathrm{e}}^{(k)}$ of the normalized eigenvector for that mode. The bare (uncoupled) electronic oscillator strength is $f_{\\mathrm{e}} = 2\\Omega_{\\mathrm{e}}\\mu_{\\mathrm{e}}^{2}$, and the polaritonic oscillator strength for mode $k$ is $f_{k} = \\left|C_{\\mathrm{e}}^{(k)}\\right|^{2}f_{\\mathrm{e}}$. Express all energies in Hartree and oscillator strengths as dimensionless decimals.\n- Implement a program that, for each test case, constructs the appropriate Hermitian matrix implied by the derived linear-response QED–TDDFT Tamm–Dancoff model, solves for the eigenvectors, extracts the electronic Hopfield coefficient of each mode, and outputs the list of polaritonic oscillator strengths $\\{f_{k}\\}$ ordered by increasing polaritonic energy. Round each reported oscillator strength to $10$ decimal places.\n\nTest suite (hard-code these parameter sets in your program):\n- Case A (resonant, moderate coupling): $\\Omega_{\\mathrm{e}}=0.4$, $\\mu_{\\mathrm{e}}=1.0$, $N_{\\mathrm{p}}=1$, $\\omega_{1}=0.4$, $g_{1}=0.05$.\n- Case B (positive detuning): $\\Omega_{\\mathrm{e}}=0.4$, $\\mu_{\\mathrm{e}}=0.8$, $N_{\\mathrm{p}}=1$, $\\omega_{1}=0.6$, $g_{1}=0.05$.\n- Case C (very weak coupling): $\\Omega_{\\mathrm{e}}=0.4$, $\\mu_{\\mathrm{e}}=1.2$, $N_{\\mathrm{p}}=1$, $\\omega_{1}=0.35$, $g_{1}=0.000001$.\n- Case D (two photon modes): $\\Omega_{\\mathrm{e}}=0.4$, $\\mu_{\\mathrm{e}}=0.9$, $N_{\\mathrm{p}}=2$, $\\omega_{1}=0.35$, $\\omega_{2}=0.45$, $g_{1}=0.04$, $g_{2}=0.03$.\n\nFinal output format:\n- Your program should produce a single line of output containing a list of lists. The list at position $\\,i\\,$ should contain the polaritonic oscillator strengths for test case $\\,i\\,$ (in the order A, B, C, D), ordered by increasing polaritonic energy within each case, each value rounded to $\\,10$ decimal places. For example, a syntactic template is $\\,[[f_{1}^{(A)},f_{2}^{(A)},\\ldots],[f_{1}^{(B)},\\ldots],[\\ldots],[\\ldots]]\\,$ with plain decimal numbers and no units. Do not print any additional text.", "solution": "The problem asks for the derivation of the eigenvalue problem for polaritonic modes within the framework of linear-response QED-TDDFT under the Tamm–Dancoff Approximation (TDA), followed by a numerical implementation.\n\nThe model consists of one bright electronic excitation and $N_{\\mathrm{p}}$ single-photon excitations. The basis for this single-excitation subspace is composed of one purely electronic excited state, $\\lvert \\psi_{\\mathrm{e}}\\rangle = \\lvert \\mathrm{e}, \\{0\\}_{\\alpha}\\rangle$, and $N_{\\mathrm{p}}$ purely photonic excited states, $\\lvert \\psi_{\\mathrm{p}_{\\alpha}}\\rangle = \\lvert \\mathrm{g}, 1_{\\alpha}\\rangle$. Here, $\\lvert \\mathrm{g}\\rangle$ and $\\lvert \\mathrm{e}\\rangle$ are the electronic ground and excited states, and $\\lvert 0\\rangle_{\\alpha}$ and $\\lvert 1\\rangle_{\\alpha}$ are the vacuum and one-photon states of cavity mode $\\alpha$, respectively. The dimension of this subspace is $N_{\\mathrm{p}}+1$.\n\nIn this basis, $\\{\\lvert \\psi_{\\mathrm{e}}\\rangle, \\lvert \\psi_{\\mathrm{p}_1}\\rangle, \\dots, \\lvert \\psi_{\\mathrm{p}_{N_{\\mathrm{p}}}}\\rangle\\}$, the effective Hamiltonian matrix $\\mathbf{H}$ is constructed as follows:\nThe diagonal elements are the energies of the uncoupled, or \"bare,\" states:\n$$\nH_{\\mathrm{e},\\mathrm{e}} = \\langle \\psi_{\\mathrm{e}} \\vert \\mathbf{H} \\vert \\psi_{\\mathrm{e}} \\rangle = \\Omega_{\\mathrm{e}}\n$$\n$$\nH_{\\mathrm{p}_{\\alpha},\\mathrm{p}_{\\beta}} = \\langle \\psi_{\\mathrm{p}_{\\alpha}} \\vert \\mathbf{H} \\vert \\psi_{\\mathrm{p}_{\\beta}} \\rangle = \\omega_{\\alpha} \\delta_{\\alpha\\beta}\n$$\nwhere $\\Omega_{\\mathrm{e}}$ is the energy of the bright electronic transition and $\\omega_{\\alpha}$ is the energy of a photon in mode $\\alpha$. The Kronecker delta $\\delta_{\\alpha\\beta}$ signifies that there is no direct coupling between different photon modes.\n\nThe off-diagonal elements represent the light-matter coupling, given as a set of parameters $\\{g_{\\alpha}\\}_{\\alpha=1}^{N_{\\mathrm{p}}}$. These are the matrix elements:\n$$\nH_{\\mathrm{e},\\mathrm{p}_{\\alpha}} = \\langle \\psi_{\\mathrm{e}} \\vert \\mathbf{H} \\vert \\psi_{\\mathrm{p}_{\\alpha}} \\rangle = g_{\\alpha}\n$$\nDue to the Hermitian nature of the Hamiltonian, $H_{\\mathrm{p}_{\\alpha},\\mathrm{e}} = H_{\\mathrm{e},\\mathrm{p}_{\\alpha}}^{*} = g_{\\alpha}$, since the couplings $g_{\\alpha}$ are given as real numbers.\n\nThus, the full Hamiltonian matrix is a real-symmetric $(N_{\\mathrm{p}}+1) \\times (N_{\\mathrm{p}}+1)$ matrix:\n$$\n\\mathbf{H} = \\begin{pmatrix}\n\\Omega_{\\mathrm{e}} & g_1 & g_2 & \\dots & g_{N_{\\mathrm{p}}} \\\\\ng_1 & \\omega_1 & 0 & \\dots & 0 \\\\\ng_2 & 0 & \\omega_2 & \\dots & 0 \\\\\n\\vdots & \\vdots & \\vdots & \\ddots & \\vdots \\\\\ng_{N_{\\mathrm{p}}} & 0 & 0 & \\dots & \\omega_{N_{\\mathrm{p}}}\n\\end{pmatrix}\n$$\nSolving the eigenvalue problem $\\mathbf{H} \\mathbf{C}^{(k)} = E_k \\mathbf{C}^{(k)}$ yields the polaritonic energies $E_k$ and the corresponding polaritonic state vectors $\\mathbf{C}^{(k)} = (C_{\\mathrm{e}}^{(k)}, C_{\\mathrm{p}_1}^{(k)}, \\dots, C_{\\mathrm{p}_{N_{\\mathrm{p}}}}^{(k)})^T$. These amplitudes are the Hopfield coefficients, describing the composition of the $k$-th polaritonic state $\\lvert\\Psi_k\\rangle$:\n$$\n\\lvert\\Psi_k\\rangle = C_{\\mathrm{e}}^{(k)} \\lvert\\psi_{\\mathrm{e}}\\rangle + \\sum_{\\alpha=1}^{N_{\\mathrm{p}}} C_{\\mathrm{p}_{\\alpha}}^{(k)} \\lvert\\psi_{\\mathrm{p}_{\\alpha}}\\rangle\n$$\nThe oscillator strength $f_k$ for a transition from the ground state $\\lvert G\\rangle = \\lvert \\mathrm{g}, \\{0\\}_{\\alpha}\\rangle$ to an excited polaritonic state $\\lvert\\Psi_k\\rangle$ is determined by the transition dipole moment, $\\boldsymbol{\\mu}_k = \\langle \\Psi_k \\vert \\hat{\\mathbf{d}} \\vert G \\rangle$. This evaluates to:\n$$\n\\boldsymbol{\\mu}_k = \\left( C_{\\mathrm{e}}^{(k)} \\langle \\psi_{\\mathrm{e}} \\vert + \\sum_{\\alpha} C_{\\mathrm{p}_{\\alpha}}^{(k)} \\langle \\psi_{\\mathrm{p}_{\\alpha}} \\vert \\right) \\hat{\\mathbf{d}} \\lvert G\\rangle = C_{\\mathrm{e}}^{(k)} \\langle \\mathrm{e} \\vert \\hat{\\mathbf{d}} \\vert \\mathrm{g} \\rangle = C_{\\mathrm{e}}^{(k)} \\boldsymbol{\\mu}_{\\mathrm{e}}\n$$\nHere, $\\boldsymbol{\\mu}_{\\mathrm{e}}$ is the transition dipole moment of the bare electronic excitation. The terms involving $\\lvert\\psi_{\\mathrm{p}_{\\alpha}}\\rangle$ vanish.\n\nAs specified, the polaritonic oscillator strength $f_k$ is $f_k = |C_{\\mathrm{e}}^{(k)}|^2 f_{\\mathrm{e}}$, where $f_{\\mathrm{e}} = 2 \\Omega_{\\mathrm{e}} \\mu_{\\mathrm{e}}^2$ is the bare electronic oscillator strength. This definition ensures the total oscillator strength is conserved within this model:\n$$\n\\sum_{k=1}^{N_{\\mathrm{p}}+1} f_k = \\sum_{k=1}^{N_{\\mathrm{p}}+1} |C_{\\mathrm{e}}^{(k)}|^2 f_{\\mathrm{e}} = f_{\\mathrm{e}} \\sum_{k=1}^{N_{\\mathrm{p}}+1} |C_{\\mathrm{e}}^{(k)}|^2 = f_{\\mathrm{e}}\n$$\nThe numerical implementation will follow this derived formalism directly.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the polaritonic eigenvalue problem for several test cases\n    and computes the oscillator strengths for each polaritonic mode.\n    \"\"\"\n    \n    # Test suite:\n    # (Omega_e, mu_e, N_p, list_of_omegas, list_of_gs)\n    # Energies in Hartree, mu_e in a.u.\n    test_cases = [\n        # Case A: resonant, moderate coupling\n        (0.4, 1.0, 1, [0.4], [0.05]),\n        # Case B: positive detuning\n        (0.4, 0.8, 1, [0.6], [0.05]),\n        # Case C: very weak coupling\n        (0.4, 1.2, 1, [0.35], [0.000001]),\n        # Case D: two photon modes\n        (0.4, 0.9, 2, [0.35, 0.45], [0.04, 0.03]),\n    ]\n\n    all_results = []\n    \n    for case in test_cases:\n        Omega_e, mu_e, N_p, omegas, gs = case\n        \n        # The size of the Hermitian matrix is (N_p + 1) x (N_p + 1)\n        matrix_size = N_p + 1\n        H = np.zeros((matrix_size, matrix_size))\n        \n        # 1. Construct the Hamiltonian matrix\n        # Diagonal elements\n        # Electronic excitation energy\n        H[0, 0] = Omega_e\n        # Photonic mode energies\n        for i in range(N_p):\n            H[i + 1, i + 1] = omegas[i]\n            \n        # Off-diagonal elements (light-matter coupling)\n        for i in range(N_p):\n            H[0, i + 1] = gs[i]\n            H[i + 1, 0] = gs[i]\n            \n        # 2. Solve the eigenvalue problem for the Hermitian matrix\n        # np.linalg.eigh returns eigenvalues in ascending order and\n        # corresponding eigenvectors as columns.\n        eigvals, eigvecs = np.linalg.eigh(H)\n        \n        # 3. Calculate the bare electronic oscillator strength\n        # f_e = 2 * Omega_e * mu_e^2 (in atomic units)\n        f_e = 2.0 * Omega_e * mu_e**2\n        \n        case_oscillator_strengths = []\n        \n        # 4. Calculate the oscillator strength for each polaritonic mode\n        for k in range(matrix_size):\n            # The electronic Hopfield coefficient is the first component\n            # of the k-th eigenvector.\n            C_e_k = eigvecs[0, k]\n            \n            # The polaritonic oscillator strength is f_k = |C_e_k|^2 * f_e\n            f_k = (C_e_k**2) * f_e\n            \n            # Round to 10 decimal places as required\n            case_oscillator_strengths.append(round(f_k, 10))\n            \n        all_results.append(case_oscillator_strengths)\n\n    # Format the final output string as a list of lists.\n    # e.g., [[val1, val2], [val3, val4]]\n    final_output_parts = []\n    for res_list in all_results:\n        final_output_parts.append(f\"[{','.join(map(str, res_list))}]\")\n    \n    print(f\"[[{','.join(map(str, all_results[0]))}],[{','.join(map(str, all_results[1]))}],[{','.join(map(str, all_results[2]))}],[{','.join(map(str, all_results[3]))}]]\")\n\n\nsolve()\n```", "id": "2915405"}]}