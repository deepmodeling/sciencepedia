{"hands_on_practices": [{"introduction": "This first practice sets the stage by posing a fundamental question: when do we need to worry about relativistic effects in atoms and molecules? By comparing the characteristic kinetic energy of an electron to its rest mass energy, we will derive a simple yet powerful dimensionless parameter. This exercise provides the crucial physical intuition needed to identify systems where nonrelativistic quantum mechanics is insufficient and methods like the Zeroth-Order Regular Approximation (ZORA) become essential [@problem_id:2802879].", "problem": "Consider a nonrelativistic electron bound to a point nucleus of charge number $Z$ by a Coulomb potential $V(r) = -Z/r$ in atomic units. For a stationary bound state with principal quantum number $n$, define a dimensionless parameter that quantifies the order of magnitude of scalar relativistic corrections by comparing the characteristic nonrelativistic kinetic energy scale $\\langle \\mathbf{p}^{2} \\rangle/(2m)$ to the electron rest energy $mc^{2}$, with $m$ the electron mass and $c$ the speed of light. Assume standard atomic units where $m=1$, $\\hbar=1$, and the Hartree energy is the energy unit, and use the usual definition of the fine-structure constant $\\alpha$. Express your final answer as a single closed-form analytic expression in terms of $Z$, $n$, and $\\alpha$. Then, based on first principles, explain qualitatively how the magnitude of this parameter informs the validity of scalar relativistic Hamiltonians such as the Zero-Order Regular Approximation (ZORA) and the Douglas-Kroll-Hess (DKH) Hamiltonian for describing the bound state. The final answer must be the analytic expression for this dimensionless parameter. No numerical evaluation is required and no units should be reported in the final answer.", "solution": "The problem as stated is scientifically grounded, well-posed, and objective. It poses a standard question in theoretical physics and chemistry concerning the magnitude of relativistic effects in hydrogenic atoms. All required information is provided, and the terminology is precise. Therefore, we may proceed with a formal solution.\n\nThe problem asks for a dimensionless parameter that quantifies the scale of scalar relativistic corrections for a nonrelativistic electron in a hydrogenic atom. This parameter is defined as the ratio of the characteristic nonrelativistic kinetic energy to the electron's rest energy. We will work in atomic units, where the electron mass $m=1$, the reduced Planck constant $\\hbar=1$, and the elementary charge $e=1$. The unit of energy is the Hartree, $E_h$.\n\nFirst, we must determine the characteristic kinetic energy for an electron in a stationary state with principal quantum number $n$ of a hydrogenic atom with nuclear charge $Z$. The nonrelativistic Hamiltonian for this system in atomic units is:\n$$\n\\hat{H} = \\hat{T} + \\hat{V} = -\\frac{1}{2}\\nabla^2 - \\frac{Z}{r}\n$$\nwhere $\\hat{T} = -\\frac{1}{2}\\nabla^2 = \\frac{\\hat{\\mathbf{p}}^2}{2m}$ is the kinetic energy operator (with $m=1$) and $\\hat{V} = -Z/r$ is the Coulomb potential energy operator.\n\nThe total energy $E_n$ for a bound state with principal quantum number $n$ is given by the well-known formula:\n$$\nE_n = -\\frac{Z^2}{2n^2} \\quad (\\text{in Hartrees})\n$$\nTo find the expectation value of the kinetic energy, $\\langle T \\rangle$, we invoke the virial theorem. For a potential that is a homogeneous function of the coordinates of degree $k$, such that $V(\\lambda \\mathbf{r}) = \\lambda^k V(\\mathbf{r})$, the virial theorem states that $2\\langle T \\rangle = k \\langle V \\rangle$. The Coulomb potential $V(r) \\propto r^{-1}$, so the degree of homogeneity is $k=-1$. The virial theorem thus yields:\n$$\n2\\langle T \\rangle = (-1)\\langle V \\rangle = -\\langle V \\rangle\n$$\nThe total energy is the sum of the expectation values of the kinetic and potential energies:\n$$\nE_n = \\langle T \\rangle + \\langle V \\rangle\n$$\nWe can solve this system of two equations for $\\langle T \\rangle$. Substituting $\\langle V \\rangle = -2\\langle T \\rangle$ into the energy expression gives:\n$$\nE_n = \\langle T \\rangle + (-2\\langle T \\rangle) = -\\langle T \\rangle\n$$\nTherefore, the expectation value of the kinetic energy is the negative of the total energy:\n$$\n\\langle T \\rangle = -E_n = -\\left(-\\frac{Z^2}{2n^2}\\right) = \\frac{Z^2}{2n^2}\n$$\nThis is the characteristic nonrelativistic kinetic energy scale in atomic units, $\\langle T \\rangle = \\frac{\\langle \\mathbf{p}^2 \\rangle}{2m}$.\n\nNext, we must express the electron rest energy, $E_{rest} = mc^2$, in atomic units. In this system, the electron mass is $m=1$. The speed of light, $c$, is related to the fine-structure constant, $\\alpha$. The definition of the fine-structure constant is $\\alpha = \\frac{e^2}{4\\pi\\epsilon_0\\hbar c}$. In atomic units, $e=1$, $\\hbar=1$, and the Coulomb force constant $1/(4\\pi\\epsilon_0)=1$. Therefore, the fine-structure constant simplifies to:\n$$\n\\alpha = \\frac{1}{c}\n$$\nThis implies that the speed of light in atomic units is $c = 1/\\alpha$. The rest energy is then:\n$$\nE_{rest} = mc^2 = (1)\\left(\\frac{1}{\\alpha}\\right)^2 = \\frac{1}{\\alpha^2} \\quad (\\text{in Hartrees})\n$$\nThe dimensionless parameter requested is the ratio of the characteristic kinetic energy $\\langle T \\rangle$ to the rest energy $E_{rest}$:\n$$\n\\text{Parameter} = \\frac{\\langle T \\rangle}{E_{rest}} = \\frac{Z^2 / (2n^2)}{1/\\alpha^2}\n$$\nSimplifying this expression gives the final analytic form:\n$$\n\\text{Parameter} = \\frac{Z^2 \\alpha^2}{2n^2}\n$$\n\nNow, we address the qualitative explanation. This dimensionless parameter, which can be rewritten as $\\frac{1}{2}\\left(\\frac{Z\\alpha}{n}\\right)^2$, is a fundamental measure of the importance of relativistic effects. In the Bohr model, the velocity of an electron in the $n$-th orbit is $v_n = Z\\alpha c/n$, which means the ratio of the electron's speed to the speed of light is $v_n/c = Z\\alpha/n$. Our parameter is thus proportional to $(v/c)^2$, directly quantifying how \"relativistic\" the electron's motion is.\n\nRelativistic quantum chemical methods like the Zero-Order Regular Approximation (ZORA) and the Douglas-Kroll-Hess (DKH) approach are designed to incorporate scalar relativistic effects (mass-velocity and Darwin terms) by approximating the full four-component Dirac equation. These methods are essentially expansions, and the validity and convergence of these expansions depend on the magnitude of relativistic effects.\n\nThe ZORA method is derived from an expansion of the Dirac equation that is valid when the electronic energy is small compared to the electron rest-mass energy. It provides a correction to the nonrelativistic Hamiltonian. A known deficiency of standard ZORA is its gauge dependence and potential for variational collapse when the potential is strongly attractive, as is the case for core electrons in heavy elements (large $Z$). The parameter $\\frac{1}{2}(Z\\alpha/n)^2$ directly signals this regime. As $Z$ increases and $n$ decreases (for core orbitals like $1s$), the parameter grows rapidly, indicating that the potential is becoming a significant perturbation relative to the rest mass. In this situation, the simple ZORA expansion is less reliable, and the method's accuracy deteriorates.\n\nThe DKH method provides a more systematic and robust way to decouple the electronic and positronic states of the Dirac equation. It involves a sequence of unitary transformations that progressively block-diagonalize the Dirac Hamiltonian. Each transformation removes off-diagonal terms to a higher order in the external potential. Because DKH is a successive transformation scheme, it is generally more stable and accurate than ZORA for systems where relativistic effects are large. Higher-order DKH (e.g., DKH2, DKH3) can achieve high accuracy even for the heaviest elements.\n\nIn summary, the magnitude of the parameter $\\frac{Z^2 \\alpha^2}{2n^2}$ serves as a critical indicator:\n1.  For light elements (small $Z$) or high-lying states (large $n$), the parameter is very small ($\\ll 1$). Relativistic effects are minor perturbations. Nonrelativistic theory is a good starting point, and low-order ZORA provides sufficient correction.\n2.  For heavy elements (large $Z$) and core orbitals (small $n$), the parameter becomes significant. Nonrelativistic theory fails qualitatively. ZORA may provide a basic correction but is prone to errors and instability. A more rigorous, systematically improvable method like DKH is necessary for quantitative accuracy. The magnitude of this parameter is precisely what dictates the need to move from simpler approximations like ZORA to more sophisticated frameworks like DKH.", "answer": "$$\\boxed{\\frac{Z^2 \\alpha^2}{2n^2}}$$", "id": "2802879"}, {"introduction": "Having established *when* relativistic methods are necessary, we now turn to the practical matter of *how* they are implemented. This advanced exercise guides you through the derivation and numerical implementation of the scalar ZORA kinetic energy for a heavy one-electron atom, starting from the Dirac equation. By building and benchmarking this model, you will gain a concrete, hands-on understanding of how the ZORA formalism modifies the kinetic energy operator to capture the dominant scalar relativistic corrections [@problem_id:2936975].", "problem": "You are asked to construct, justify, and benchmark a simplified scalar relativistic model suitable for heavy-element one-electron systems using the zeroth-order regular approximation (ZORA) within quantum chemistry. Work entirely in atomic units where the electron mass is $m=1$ and Planck’s constant is $\\hbar=1$. Use the speed of light $c=137.035999084$ in atomic units. Energies must be reported in hartree.\n\nStarting from a first-principles base, use the following foundations only:\n- The one-electron Dirac Hamiltonian with an external scalar potential $V(\\mathbf{r})$, the standard Pauli representation, and the concept of separating large and small components to obtain an effective two-component Hamiltonian.\n- The nonrelativistic limit where the kinetic operator is $T_{\\mathrm{NR}}=-\\frac{1}{2}\\nabla^{2}$.\n- The general definition of an expectation value $\\langle \\hat{O} \\rangle = \\int \\psi^{*}(\\mathbf{r}) \\hat{O} \\psi(\\mathbf{r}) \\, d^{3}\\mathbf{r}$ for a normalized wavefunction $\\psi$.\n\nTask A (derivation requirement):\n- Derive from the stated foundations a scalar zeroth-order regular approximation (ZORA) model for a spin-free, spherically symmetric situation, appropriate when spin-orbit coupling is neglected and the potential is central, $V(\\mathbf{r})=V(r)$. Show how a position-dependent, positive-definite kinetic prefactor arises from the decoupling of large and small components and argue the form of the scalar ZORA kinetic energy expectation value for an $s$-type function $\\psi(r)$ in terms of a scalar metric $K(r)$ that depends on $V(r)$ and $c$. Your derivation must be grounded only in the listed base, without invoking any unintroduced results.\n\nTask B (modeling assumptions):\n- Adopt a finite-nucleus, softened Coulomb potential of the form $V(r)=-Z \\, \\mathrm{erf}\\!\\left(\\frac{r}{a}\\right)\\big/ r$ with the well-defined limit $V(0)=-\\frac{2Z}{\\sqrt{\\pi} \\, a}$. Here $Z$ is the nuclear charge (a positive integer parameter), and $a$ is a positive softening length parameter in bohr.\n- Use as a normalized trial wavefunction a spherically symmetric Gaussian of the form $\\psi(r)=\\mathcal{N}\\,\\exp\\!\\left(-\\frac{\\alpha r^{2}}{2}\\right)$ with exponent $\\alpha&gt;0$, where $\\mathcal{N}$ is the normalization constant. Treat this as a variational probe; no re-optimization of $\\alpha$ is required.\n\nTask C (computational specification):\n- Express the expectation values of the nonrelativistic kinetic energy $T_{\\mathrm{NR}}$ and the scalar ZORA kinetic energy $T_{\\mathrm{ZORA}}$ using three-dimensional spherical integration. You must evaluate the required radial integrals numerically over $r \\in [0,\\infty)$; closed-form expressions are not to be used in your implementation. You may use standard special functions such as the error function and standard numerical quadrature. Ensure proper handling of the $r\\to 0$ limit of $V(r)$.\n- Compute the nonrelativistic total energy $E_{\\mathrm{NR}}=\\langle T_{\\mathrm{NR}} \\rangle + \\langle V \\rangle$ and the scalar ZORA total energy $E_{\\mathrm{ZORA}}=\\langle T_{\\mathrm{ZORA}} \\rangle + \\langle V \\rangle$ for each test case. Report the scalar relativistic stabilization shift $\\Delta E = E_{\\mathrm{ZORA}}-E_{\\mathrm{NR}}$ in hartree. Because the potential expectation value is identical in both models for a fixed $\\psi$ and $V$, you may simplify the computation accordingly, but you must evaluate the necessary integrals as specified.\n\nTest suite:\n- Use $c=137.035999084$ (atomic units). For each tuple $(Z,\\alpha,a)$ given below, compute $\\Delta E$ (in hartree) rounded to $6$ decimal places:\n    - Case $1$: $(Z,\\alpha,a)=(1,0.5,0.05)$\n    - Case $2$: $(Z,\\alpha,a)=(10,1.0,0.05)$\n    - Case $3$: $(Z,\\alpha,a)=(50,2.0,0.05)$\n    - Case $4$: $(Z,\\alpha,a)=(80,3.0,0.05)$\n    - Case $5$: $(Z,\\alpha,a)=(100,4.0,0.05)$\n\nFinal output format:\n- Your program must produce a single line of output containing the five results as a comma-separated list enclosed in square brackets, for example $[\\delta_{1},\\delta_{2},\\delta_{3},\\delta_{4},\\delta_{5}]$, where each $\\delta_{i}$ is the rounded decimal string representation with exactly $6$ digits after the decimal point, in hartree.", "solution": "The problem posed is to derive and apply a scalar zeroth-order regular approximation (ZORA) model for a one-electron system with a heavy nucleus. The problem is scientifically grounded, well-posed, and objective. It provides a sound basis for a rigorous analytical derivation and a subsequent numerical implementation. I will proceed with the solution.\n\nThe solution is organized into three parts as requested: derivation of the theoretical model, specification of the computational components, and the design of the numerical calculation.\n\n**A. Derivation of the Scalar ZORA Model**\n\nWe begin with the time-independent one-electron Dirac equation in atomic units ($\\hbar=1$, $m_e=1$), where the Hamiltonian operates on a four-component spinor wavefunction $\\Psi$. With a scalar potential $V(\\mathbf{r})$ and an energy scale set relative to the electron rest mass, the equation is:\n$$\n\\begin{pmatrix} V(\\mathbf{r}) & c(\\boldsymbol{\\sigma} \\cdot \\mathbf{p}) \\\\ c(\\boldsymbol{\\sigma} \\cdot \\mathbf{p}) & V(\\mathbf{r}) - 2c^2 \\end{pmatrix} \\begin{pmatrix} \\psi_L \\\\ \\psi_S \\end{pmatrix} = E \\begin{pmatrix} \\psi_L \\\\ \\psi_S \\end{pmatrix}\n$$\nHere, $\\psi_L$ and $\\psi_S$ are the two-component large and small components of the spinor, $\\mathbf{p} = -i\\nabla$ is the momentum operator, $\\boldsymbol{\\sigma}$ is the vector of Pauli matrices, and $c$ is the speed of light.\n\nThis matrix equation yields two coupled equations:\n$$\nV \\psi_L + c(\\boldsymbol{\\sigma} \\cdot \\mathbf{p}) \\psi_S = E \\psi_L \\quad (1)\n$$\n$$\nc(\\boldsymbol{\\sigma} \\cdot \\mathbf{p}) \\psi_L + (V - 2c^2) \\psi_S = E \\psi_S \\quad (2)\n$$\nFrom equation $(2)$, we formally solve for the small component $\\psi_S$ in terms of the large component $\\psi_L$:\n$$\n\\psi_S = \\frac{c(\\boldsymbol{\\sigma} \\cdot \\mathbf{p})}{2c^2 - V + E} \\psi_L\n$$\nSubstituting this into equation $(1)$ eliminates $\\psi_S$ and results in an exact, energy-dependent equation for $\\psi_L$:\n$$\n\\left( V + (\\boldsymbol{\\sigma} \\cdot \\mathbf{p}) \\frac{c^2}{2c^2 - (V - E)} (\\boldsymbol{\\sigma} \\cdot \\mathbf{p}) \\right) \\psi_L = E \\psi_L\n$$\nThe zeroth-order regular approximation (ZORA) consists of expanding the denominator around a reference energy $E=0$. This is justified when the electron energy $E$ is small compared to the potential energy $V$ and both are much smaller than $2c^2$. Setting $E=0$ in the denominator gives the ZORA Hamiltonian:\n$$\nH_{\\mathrm{ZORA}} = V + (\\boldsymbol{\\sigma} \\cdot \\mathbf{p}) \\frac{c^2}{2c^2 - V} (\\boldsymbol{\\sigma} \\cdot \\mathbf{p})\n$$\nWe define the position-dependent kinetic factor $K(\\mathbf{r}) = \\frac{c^2}{2c^2 - V(\\mathbf{r})}$. The kinetic energy operator is $T_{\\mathrm{ZORA}} = (\\boldsymbol{\\sigma} \\cdot \\mathbf{p}) K(\\mathbf{r}) (\\boldsymbol{\\sigma} \\cdot \\mathbf{p})$. Using the identity $(\\boldsymbol{\\sigma} \\cdot \\mathbf{A})(\\boldsymbol{\\sigma} \\cdot \\mathbf{B}) = \\mathbf{A} \\cdot \\mathbf{B} + i\\boldsymbol{\\sigma} \\cdot (\\mathbf{A} \\times \\mathbf{B})$, with $\\mathbf{A}=\\mathbf{p}$ and $\\mathbf{B}=K\\mathbf{p}$, we can separate this into a scalar part and a spin-dependent part. The problem specifies a spin-free model, so we neglect the spin-orbit term and retain only the scalar part:\n$$\nT_{\\mathrm{sZORA}} = \\mathbf{p} \\cdot K(\\mathbf{r}) \\mathbf{p}\n$$\nThe expectation value of this operator for a given normalized wavefunction $\\psi$ is $\\langle T_{\\mathrm{sZORA}} \\rangle = \\langle \\psi | \\mathbf{p} \\cdot K \\mathbf{p} | \\psi \\rangle$. Using the hermiticity of $\\mathbf{p}$, this can be written as:\n$$\n\\langle T_{\\mathrm{sZORA}} \\rangle = \\langle \\mathbf{p}\\psi | K | \\mathbf{p}\\psi \\rangle = \\int (\\mathbf{p}\\psi)^* K(\\mathbf{r}) (\\mathbf{p}\\psi) \\,d^3\\mathbf{r}\n$$\nFor a spherically symmetric, real-valued $s$-type function $\\psi(r)$, we have $\\mathbf{p}\\psi = -i\\nabla\\psi = -i \\frac{d\\psi}{dr} \\frac{\\mathbf{r}}{r}$. The integrand becomes:\n$$\n\\left(-i \\frac{d\\psi}{dr} \\frac{\\mathbf{r}}{r}\\right)^* K(r) \\left(-i \\frac{d\\psi}{dr} \\frac{\\mathbf{r}}{r}\\right) = K(r) \\left(\\frac{d\\psi}{dr}\\right)^2 \\left(\\frac{\\mathbf{r}}{r} \\cdot \\frac{\\mathbf{r}}{r}\\right) = K(r) \\left(\\frac{d\\psi}{dr}\\right)^2\n$$\nThus, the scalar ZORA kinetic energy expectation value is:\n$$\n\\langle T_{\\mathrm{sZORA}} \\rangle = \\int K(r) \\left(\\frac{d\\psi}{dr}\\right)^2 \\,d^3\\mathbf{r} = \\int_0^\\infty K(r) \\left(\\frac{d\\psi}{dr}\\right)^2 4\\pi r^2 \\,dr\n$$\nThis form shows the scalar metric $K(r)$ acting as a position-dependent prefactor modifying the kinetic energy density. For comparison, the non-relativistic kinetic energy is $\\langle T_{\\mathrm{NR}} \\rangle = \\int \\frac{1}{2} \\left(\\frac{d\\psi}{dr}\\right)^2 4\\pi r^2 \\,dr$. In the non-relativistic limit ($c \\to \\infty$), $V(r) \\ll 2c^2$, so $K(r) \\to \\frac{c^2}{2c^2} = \\frac{1}{2}$, and $\\langle T_{\\mathrm{sZORA}} \\rangle$ correctly reduces to $\\langle T_{\\mathrm{NR}} \\rangle$.\n\n**B. Model Specification**\n\nThe problem specifies the following components:\n- **Potential:** A softened Coulomb potential $V(r) = -Z \\frac{\\mathrm{erf}(r/a)}{r}$. Its limit at the origin is well-defined: $\\lim_{r\\to 0} V(r) = -\\frac{2Z}{\\sqrt{\\pi}a}$.\n- **Wavefunction:** A normalized Gaussian trial function $\\psi(r) = \\mathcal{N} e^{-\\alpha r^2 / 2}$. The normalization constant $\\mathcal{N}$ is found by requiring $\\int |\\psi|^2 d^3\\mathbf{r} = 1$, which gives $\\mathcal{N} = (\\alpha/\\pi)^{3/4}$.\n- **Derivative of the wavefunction:** $\\frac{d\\psi}{dr} = -\\alpha r \\psi(r)$.\n\n**C. Computational Formulation**\n\nThe quantity to be computed is the scalar relativistic stabilization shift $\\Delta E = E_{\\mathrm{ZORA}} - E_{\\mathrm{NR}}$. Since the potential energy expectation value $\\langle V \\rangle$ is identical for both energies given a fixed wavefunction, the shift simplifies to the difference in kinetic energy expectation values:\n$$\n\\Delta E = \\langle T_{\\mathrm{sZORA}} \\rangle - \\langle T_{\\mathrm{NR}} \\rangle\n$$\nUsing the expressions derived above, this is:\n$$\n\\Delta E = \\int_0^\\infty \\left( K(r) - \\frac{1}{2} \\right) \\left(\\frac{d\\psi}{dr}\\right)^2 4\\pi r^2 \\,dr\n$$\nThe prefactor can be simplified:\n$$\nK(r) - \\frac{1}{2} = \\frac{c^2}{2c^2 - V(r)} - \\frac{1}{2} = \\frac{2c^2 - (2c^2 - V(r))}{2(2c^2 - V(r))} = \\frac{V(r)}{4c^2 - 2V(r)}\n$$\nSubstituting this and $(\\frac{d\\psi}{dr})^2 = \\alpha^2 r^2 \\psi(r)^2$ into the integral for $\\Delta E$:\n$$\n\\Delta E = \\int_0^\\infty \\frac{V(r)}{4c^2 - 2V(r)} \\left( \\alpha^2 r^2 \\psi(r)^2 \\right) 4\\pi r^2 \\,dr\n$$\nSubstituting $\\psi(r)^2 = \\mathcal{N}^2 e^{-\\alpha r^2} = (\\frac{\\alpha}{\\pi})^{3/2} e^{-\\alpha r^2}$:\n$$\n\\Delta E = 4\\pi \\left(\\frac{\\alpha}{\\pi}\\right)^{3/2} \\alpha^2 \\int_0^\\infty \\frac{V(r) r^4 e^{-\\alpha r^2}}{4c^2 - 2V(r)} \\,dr\n$$\nThis final one-dimensional integral expresses $\\Delta E$ in a form suitable for numerical quadrature. The integrand is well-behaved at $r=0$. The numerator term $V(r)r^4 = -Z r^3 \\mathrm{erf}(r/a)$ approaches zero as $r^4$, while the denominator approaches a non-zero constant, ensuring the integrand is finite and smooth at the origin. The implementation will use `scipy.integrate.quad` to evaluate this integral for each test case.", "answer": "```python\nimport numpy as np\nfrom scipy.special import erf\nfrom scipy.integrate import quad\n\ndef solve():\n    \"\"\"\n    Computes the scalar relativistic stabilization shift Delta_E = E_ZORA - E_NR\n    for a one-electron system using the ZORA model.\n    \"\"\"\n    # Constants in atomic units\n    c = 137.035999084\n    PI = np.pi\n\n    # Test suite parameters: (Z, alpha, a)\n    test_cases = [\n        (1, 0.5, 0.05),\n        (10, 1.0, 0.05),\n        (50, 2.0, 0.05),\n        (80, 3.0, 0.05),\n        (100, 4.0, 0.05),\n    ]\n\n    results = []\n\n    for Z, alpha, a in test_cases:\n        # Normalization constant for the Gaussian trial wavefunction, squared\n        N_sq = (alpha / PI)**(1.5)\n\n        # Prefactor for the Delta_E integral, combining various constants\n        prefactor = 4.0 * PI * N_sq * alpha**2\n\n        # Define the softened Coulomb potential V(r), handling the r=0 limit\n        def potential_V(r):\n            if r == 0.0:\n                # Use the analytical limit of erf(x)/x as x->0\n                return -2.0 * Z / (np.sqrt(PI) * a)\n            return -Z * erf(r / a) / r\n\n        # Define the integrand for the total Delta_E calculation.\n        # This function combines all r-dependent parts of the integral.\n        # Delta_E = Integral[ (K(r) - 1/2) * (d(psi)/dr)^2 * 4*pi*r^2 ] dr\n        def delta_e_integrand(r):\n            # Calculate the potential at r\n            vr = potential_V(r)\n            \n            # Relativistic factor: K(r) - 1/2 = V(r) / (4c^2 - 2V(r))\n            relativistic_factor = vr / (4.0 * c**2 - 2.0 * vr)\n\n            # Integrand of the kinetic energy density, without prefactors\n            # (d(psi)/dr)^2 * 4*pi*r^2, but simplified\n            # The full formula being integrated numerically is:\n            # 4*pi * N_sq * alpha^2 * Integral[ (V(r)r^4*exp(-alpha*r^2)) / (4c^2-2V(r)) ] dr\n            \n            # The core r-dependent part of the integrand\n            numerator = vr * r**4 * np.exp(-alpha * r**2)\n            denominator = 4.0 * c**2 - 2.0 * vr\n            \n            return numerator / denominator\n\n        # The full integral is the prefactor times the numerically evaluated part\n        integral_part, _ = quad(delta_e_integrand, 0, np.inf)\n        delta_E = prefactor * integral_part\n        \n        # Format the result as a string with 6 decimal places\n        results.append(f\"{delta_E:.6f}\")\n\n    # Print the final output in the specified list format\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "2936975"}, {"introduction": "In this final practice, we connect relativistic theory to observable chemical phenomena. You will use a simplified molecular orbital model to explore how scalar relativistic effects influence the bond angles of heavy-element dihydrides like $\\text{H}_2\\text{Te}$, a classic manifestation of the relativistic \"inert-pair effect\". This exercise demonstrates how the stabilization of valence s-orbitals, a key feature captured by ZORA and related models, directly impacts molecular geometry and explains well-known trends in the periodic table [@problem_id:2461818].", "problem": "You are to compute scalar relativistic effects on the equilibrium bond angle in bent dihydrides using a minimal valence Hamiltonian. Consider a central chalcogen atom with valence orbitals $ns$ and $np$ bonding to two hydrogen atoms placed at an angle $\\theta$ in a plane. Use a minimal basis $\\{ \\lvert s \\rangle, \\lvert p_x \\rangle, \\lvert p_y \\rangle, \\lvert 1s_a \\rangle, \\lvert 1s_b \\rangle \\}$, where the hydrogen atoms lie in the $xy$-plane with unit bond directions $\\mathbf{u}_a = (\\cos(\\theta/2), \\sin(\\theta/2), 0)$ and $\\mathbf{u}_b = (\\cos(\\theta/2), -\\sin(\\theta/2), 0)$. The $np_z$ orbital is orthogonal to the plane and does not couple to the hydrogens; it is not included in the basis and thus contributes an overall constant energy independent of $\\theta$ that is to be neglected for determining the equilibrium bond angle.\n\nThe one-electron Hamiltonian in this basis is defined by on-site energies and nearest-neighbor couplings:\n- On-site energies: $\\alpha_s$ on $\\lvert s \\rangle$, $\\alpha_p$ on each of $\\lvert p_x \\rangle$ and $\\lvert p_y \\rangle$, and $\\alpha_H$ on each of $\\lvert 1s_a \\rangle$ and $\\lvert 1s_b \\rangle$.\n- Off-diagonal couplings:\n  - $\\langle s \\lvert \\hat{H} \\rvert 1s_a \\rangle = \\langle s \\lvert \\hat{H} \\rvert 1s_b \\rangle = V_{sH}$,\n  - $\\langle p_x \\lvert \\hat{H} \\rvert 1s_a \\rangle = V_{pH} \\cos(\\theta/2)$,\n  - $\\langle p_y \\lvert \\hat{H} \\rvert 1s_a \\rangle = V_{pH} \\sin(\\theta/2)$,\n  - $\\langle p_x \\lvert \\hat{H} \\rvert 1s_b \\rangle = V_{pH} \\cos(\\theta/2)$,\n  - $\\langle p_y \\lvert \\hat{H} \\rvert 1s_b \\rangle = - V_{pH} \\sin(\\theta/2)$,\n  - All other off-diagonal elements not related by Hermiticity are zero.\nTake the overlap matrix to be the identity.\n\nAssume a total of $N_e = 8$ valence electrons occupy this five-orbital subspace, corresponding to filling the four lowest one-electron energy levels with two electrons each (the remaining pair in $np_z$ is ignored as explained above, since it is independent of $\\theta$). For a given parameter set, define the total electronic energy $E_{\\text{tot}}(\\theta)$, in electronvolts, as the sum of the four lowest one-electron energy levels at angle $\\theta$ (with $\\theta$ in radians when used in trigonometric functions). The equilibrium bond angle is the value $\\theta^\\star$ in degrees that minimizes $E_{\\text{tot}}(\\theta)$ over the closed interval $[80^\\circ, 120^\\circ]$.\n\nScalar relativistic corrections (for example, as captured by the Douglas-Kroll-Hess (DKH) or Zero-Order Regular Approximation (ZORA) frameworks) are incorporated here in an effective one-electron sense by shifting the chalcogen on-site energies, primarily stabilizing the $ns$ level relative to the $np$ levels. In this model, you will compare a nonrelativistic parameter set for tellurium to a scalar-relativistic-shifted parameter set to isolate the contribution of scalar relativity to the near-$90^\\circ$ bond angle in $\\text{H}_2\\text{Te}$.\n\nYour task is to, for each parameter set below, determine the minimizing bond angle $\\theta^\\star$ in degrees, rounded to three decimal places. Additionally, for tellurium, compute how much of the deviation from $90^\\circ$ is attributable to scalar relativistic effects, defined as the difference (in degrees) between the absolute deviations from $90^\\circ$ in the nonrelativistic and scalar-relativistic cases:\n$$\\Delta_{\\text{rel}} = \\left|\\theta^\\star_{\\text{nonrel}} - 90^\\circ \\right| - \\left|\\theta^\\star_{\\text{rel}} - 90^\\circ \\right|.$$\nReport $\\Delta_{\\text{rel}}$ rounded to three decimal places.\n\nUse the following test suite of parameter sets (all energies in electronvolts, angles in degrees):\n- Case 1 (oxygen, $\\text{H}_2\\text{O}$, treated as nonrelativistic reference):\n  - $\\alpha_H = -13.6$, $\\alpha_s = -32.0$, $\\alpha_p = -15.0$, $V_{sH} = -6.0$, $V_{pH} = -10.0$.\n- Case 2 (tellurium, $\\text{H}_2\\text{Te}$, nonrelativistic):\n  - $\\alpha_H = -13.6$, $\\alpha_s = -15.0$, $\\alpha_p = -9.0$, $V_{sH} = -3.0$, $V_{pH} = -5.0$.\n- Case 3 (tellurium, $\\text{H}_2\\text{Te}$, scalar relativistic):\n  - $\\alpha_H = -13.6$, $\\alpha_s = -18.0$, $\\alpha_p = -9.5$, $V_{sH} = -3.0$, $V_{pH} = -5.0$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets in the following order:\n- The minimizing bond angle for Case 1 in degrees (float with three decimals),\n- The minimizing bond angle for Case 2 in degrees (float with three decimals),\n- The minimizing bond angle for Case 3 in degrees (float with three decimals),\n- The value of $\\Delta_{\\text{rel}}$ in degrees computed from Cases 2 and 3 (float with three decimals).\n\nFor example, the output format must be exactly like\n[$\\theta^\\star_{\\mathrm{H_2O}}$, $\\theta^\\star_{\\mathrm{H_2Te,nonrel}}$, $\\theta^\\star_{\\mathrm{H_2Te,rel}}$, $\\Delta_{\\text{rel}}$],\nwith numerical values in degrees rounded to three decimal places and no units printed. Angles are in degrees, and all energies are in electronvolts. All trigonometric functions must use angles in radians internally. Ensure that minimization is performed strictly over $[80^\\circ, 120^\\circ]$.", "solution": "The objective is to find the equilibrium bond angle $\\theta^\\star$ for a dihydride molecule by minimizing its total electronic energy $E_{\\text{tot}}(\\theta)$. The energy is determined within a simplified one-electron (Hückel-type) model.\n\n1. Hamiltonian Matrix Construction\nThe first step is to construct the $5 \\times 5$ Hamiltonian matrix $H$ in the given atomic orbital basis $\\{ \\lvert s \\rangle, \\lvert p_x \\rangle, \\lvert p_y \\rangle, \\lvert 1s_a \\rangle, \\lvert 1s_b \\rangle \\}$. The matrix is real and symmetric. Using the provided interaction elements, and letting $c = \\cos(\\theta/2)$ and $s = \\sin(\\theta/2)$, the matrix $H(\\theta)$ is:\n$$\nH(\\theta) = \\begin{pmatrix}\n\\alpha_s & 0 & 0 & V_{sH} & V_{sH} \\\\\n0 & \\alpha_p & 0 & V_{pH} c & V_{pH} c \\\\\n0 & 0 & \\alpha_p & V_{pH} s & -V_{pH} s \\\\\nV_{sH} & V_{pH} c & V_{pH} s & \\alpha_H & 0 \\\\\nV_{sH} & V_{pH} c & -V_{pH} s & 0 & \\alpha_H\n\\end{pmatrix}\n$$\nThe problem can be simplified by block-diagonalizing the Hamiltonian using symmetry-adapted linear combinations (SALCs) of the hydrogen orbitals, which exploits the $C_{2v}$ symmetry of the molecule. However, for a small $5 \\times 5$ matrix, direct numerical diagonalization is equally efficient and more straightforward to implement.\n\n2. Total Energy Calculation\nFor a given bond angle $\\theta$, the one-electron molecular orbital energies $\\epsilon_i(\\theta)$ are the eigenvalues of the Hamiltonian matrix $H(\\theta)$. The problem states that $N_e = 8$ electrons occupy the $4$ lowest energy levels. In a restricted (closed-shell) model, this means each of the $4$ lowest spatial orbitals is occupied by $2$ electrons. The total electronic energy is the sum of the energies of all occupied orbitals. We adopt the standard physical definition:\n$$E_{\\text{tot}}(\\theta) = 2 \\sum_{i=1}^{4} \\epsilon_i(\\theta)$$\nwhere $\\{\\epsilon_i(\\theta)\\}_{i=1}^5$ are the eigenvalues of $H(\\theta)$ sorted in non-decreasing order.\n\n3. Minimization of Total Energy\nThe equilibrium bond angle $\\theta^\\star$ is the angle that minimizes the total energy function $E_{\\text{tot}}(\\theta)$. This is a one-dimensional optimization problem. We must find:\n$$\\theta^\\star = \\arg\\min_{\\theta \\in [80^\\circ, 120^\\circ]} E_{\\text{tot}}(\\theta)$$\nThis minimization will be performed numerically for each of the $3$ given parameter sets. The angle $\\theta$ in trigonometric functions must be in radians, so a conversion from degrees is necessary.\n\n4. Calculation of Relativistic Contribution\nThe effect of scalar relativity on the bond angle of $H_2Te$ is quantified by comparing the deviation from a $90^\\circ$ angle in the nonrelativistic (Case $2$) and relativistic (Case $3$) calculations. This is given by the formula:\n$$\\Delta_{\\text{rel}} = \\left|\\theta^\\star_{\\text{nonrel}} - 90^\\circ \\right| - \\left|\\theta^\\star_{\\text{rel}} - 90^\\circ \\right|$$\nA positive value for $\\Delta_{\\text{rel}}$ indicates that scalar relativistic effects cause the bond angle to move closer to $90^\\circ$. This is the expected physical behavior, as relativistic contraction and stabilization of the heavy atom's $ns$ orbital (the \"inert pair effect\") reduces its participation in bonding, favoring purer $np$-orbital bonding which has a natural orthogonality angle of $90^\\circ$.\n\nThe computational procedure is as follows:\n- For each of the $3$ cases:\n    - Define a function `total_energy(theta_deg, params)` that:\n        1.  Converts $\\theta$ from degrees to radians.\n        2.  Constructs the corresponding $5 \\times 5$ Hamiltonian matrix $H(\\theta)$.\n        3.  Calculates the eigenvalues of $H(\\theta)$ using a numerical library function (e.g., `numpy.linalg.eigh`).\n        4.  Returns the total energy, $2$ times the sum of the $4$ lowest eigenvalues.\n    - Use a numerical minimizer (e.g., `scipy.optimize.minimize_scalar`) to find the angle $\\theta^\\star$ in the interval $[80, 120]$ degrees that minimizes this energy function.\n- After obtaining $\\theta^\\star$ for all $3$ cases, calculate $\\Delta_{\\text{rel}}$ using the values from Case $2$ and Case $3$.\n- Format the final results as specified.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import minimize_scalar\n\ndef solve():\n    \"\"\"\n    Computes equilibrium bond angles and the relativistic contribution for dihydrides.\n    \"\"\"\n\n    def get_total_energy(theta_deg, params):\n        \"\"\"\n        Calculates the total electronic energy for a given bond angle and parameter set.\n\n        Args:\n            theta_deg (float): The H-X-H bond angle in degrees.\n            params (tuple): A tuple of parameters \n                            (alpha_H, alpha_s, alpha_p, V_sH, V_pH).\n\n        Returns:\n            float: The total electronic energy in eV.\n        \"\"\"\n        alpha_H, alpha_s, alpha_p, V_sH, V_pH = params\n        \n        # Convert angle to radians for trigonometric functions\n        theta_rad = np.deg2rad(theta_deg)\n        \n        c = np.cos(theta_rad / 2.0)\n        s = np.sin(theta_rad / 2.0)\n        \n        # Construct the 5x5 Hamiltonian matrix in the basis {s, px, py, 1sa, 1sb}\n        # The matrix is real and symmetric.\n        H = np.array([\n            [alpha_s, 0.0, 0.0, V_sH, V_sH],\n            [0.0, alpha_p, 0.0, V_pH * c, V_pH * c],\n            [0.0, 0.0, alpha_p, V_pH * s, -V_pH * s],\n            [V_sH, V_pH * c, V_pH * s, alpha_H, 0.0],\n            [V_sH, V_pH * c, -V_pH * s, 0.0, alpha_H]\n        ])\n        \n        # Calculate the eigenvalues of the Hamiltonian.\n        # np.linalg.eigh is suitable for Hermitian (or real symmetric) matrices\n        # and returns sorted eigenvalues.\n        eigenvalues = np.linalg.eigh(H)[0]\n        \n        # The system has 8 electrons, filling the 4 lowest molecular orbitals.\n        # The total energy in a one-electron model is twice the sum of the\n        # energies of the occupied spatial orbitals.\n        total_energy = 2.0 * np.sum(eigenvalues[:4])\n        \n        return total_energy\n\n    # Define the parameter sets for the three test cases.\n    # All energy values are in electronvolts (eV).\n    \n    # Case 1: H2O (nonrelativistic reference)\n    params_h2o = (-13.6, -32.0, -15.0, -6.0, -10.0)\n    \n    # Case 2: H2Te (nonrelativistic)\n    params_h2te_nonrel = (-13.6, -15.0, -9.0, -3.0, -5.0)\n    \n    # Case 3: H2Te (scalar relativistic)\n    params_h2te_rel = (-13.6, -18.0, -9.5, -3.0, -5.0)\n\n    test_cases = [params_h2o, params_h2te_nonrel, params_h2te_rel]\n    \n    # Store the resulting equilibrium angles\n    optimal_angles = []\n\n    for params in test_cases:\n        # Perform a bounded 1D minimization to find the equilibrium angle\n        # over the specified interval [80, 120] degrees.\n        result = minimize_scalar(\n            get_total_energy, \n            bounds=(80.0, 120.0), \n            args=(params,), \n            method='bounded'\n        )\n        optimal_angles.append(result.x)\n\n    theta_h2o_star = optimal_angles[0]\n    theta_h2te_nonrel_star = optimal_angles[1]\n    theta_h2te_rel_star = optimal_angles[2]\n\n    # Calculate the relativistic contribution to the bond angle deviation from 90 degrees\n    # a_rel = |theta_nonrel - 90| - |theta_rel - 90|\n    delta_rel = abs(theta_h2te_nonrel_star - 90.0) - abs(theta_h2te_rel_star - 90.0)\n\n    # Prepare the final list of results, rounded to three decimal places\n    final_results = [\n        round(theta_h2o_star, 3),\n        round(theta_h2te_nonrel_star, 3),\n        round(theta_h2te_rel_star, 3),\n        round(delta_rel, 3)\n    ]\n\n    # Print the final output in the exact required format\n    print(f\"[{','.join(map(str, final_results))}]\")\n\nsolve()\n```", "id": "2461818"}]}