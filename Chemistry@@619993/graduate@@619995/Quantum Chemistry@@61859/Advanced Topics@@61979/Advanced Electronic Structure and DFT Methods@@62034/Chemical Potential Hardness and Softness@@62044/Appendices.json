{"hands_on_practices": [{"introduction": "The formal definition of chemical hardness, $\\eta$, is based on the second derivative of energy with respect to electron number, $\\eta = \\frac{1}{2}(\\partial^{2} E / \\partial N^{2})_{v}$. This exercise provides a crucial link between this abstract mathematical concept and physically measurable quantities. By applying a finite-difference approximation, you will derive the well-known Parr-Pearson operational formula for hardness in terms of the vertical ionization potential ($I$) and electron affinity ($A$) [@problem_id:2879233].", "problem": "Consider the ground-state electronic energy as a function of electron number, $E(N)$, at fixed external potential $v(\\mathbf{r})$ (i.e., fixed nuclear geometry and charges). In conceptual Density Functional Theory (DFT), the chemical potential is defined as $\\mu = \\left(\\frac{\\partial E}{\\partial N}\\right)_{v}$ and the global chemical hardness is defined as $\\eta = \\frac{1}{2}\\left(\\frac{\\partial^{2} E}{\\partial N^{2}}\\right)_{v}$. It is a well-tested fact that, at fixed $v(\\mathbf{r})$, $E(N)$ is piecewise linear between integers and exhibits a derivative discontinuity at integer $N$. The vertical ionization potential and electron affinity are related to energy differences by $I = E(N-1) - E(N)$ and $A = E(N) - E(N+1)$, respectively, when all energies are evaluated at the same geometry (vertical processes).\n\nTask:\n1) Using a symmetric three-point finite-difference approximation for $\\left(\\frac{\\partial^{2} E}{\\partial N^{2}}\\right)_{v}$ at integer $N$, derive an expression for $\\eta$ in terms of $I$ and $A$ that is consistent with the definitions above and with the fixed-$v(\\mathbf{r})$ condition.\n2) For a specific molecule, high-level electronic-structure calculations at a single fixed geometry yield a vertical ionization potential $I = 9.47~\\text{eV}$ and a vertical electron affinity $A = 1.82~\\text{eV}$. Evaluate the global hardness $\\eta$ in electronvolts. Round your final numerical result to four significant figures and express the answer in $\\text{eV}$.", "solution": "The problem statement has been subjected to rigorous validation and is found to be scientifically grounded, self-contained, and well-posed. It presents a standard exercise in conceptual Density Functional Theory (DFT), free of factual errors, contradictions, or ambiguities. We shall therefore proceed with its solution.\n\nThe problem is divided into two parts. First, we must derive an expression for the global chemical hardness, $\\eta$, in terms of the vertical ionization potential, $I$, and the vertical electron affinity, $A$. Second, we must compute a numerical value for $\\eta$ using provided data.\n\nPart 1: Derivation of the expression for $\\eta$.\n\nThe global chemical hardness is defined as:\n$$ \\eta = \\frac{1}{2}\\left(\\frac{\\partial^{2} E}{\\partial N^{2}}\\right)_{v} $$\nwhere $E(N)$ is the ground-state electronic energy as a function of the number of electrons, $N$, at a fixed external potential, $v(\\mathbf{r})$.\n\nThe problem requires the use of a symmetric three-point finite-difference approximation to evaluate the second partial derivative, $\\left(\\frac{\\partial^{2} E}{\\partial N^{2}}\\right)_{v}$, at an integer number of electrons, $N$. The general formula for a symmetric three-point finite-difference approximation of the second derivative of a function $f(x)$ at a point $x$ is:\n$$ f''(x) \\approx \\frac{f(x+h) - 2f(x) + f(x-h)}{h^2} $$\nIn our specific case, the function is $E(N)$, the point of evaluation is an integer $N$, and the step size, $h$, corresponds to the addition or removal of a single electron, thus $h=1$. Applying this approximation to the energy function $E(N)$ gives:\n$$ \\left(\\frac{\\partial^{2} E}{\\partial N^{2}}\\right)_{v} \\approx \\frac{E(N+1) - 2E(N) + E(N-1)}{1^2} = E(N-1) - 2E(N) + E(N+1) $$\nSubstituting this result into the definition of hardness, $\\eta$, we obtain:\n$$ \\eta \\approx \\frac{1}{2} \\left[ E(N-1) - 2E(N) + E(N+1) \\right] $$\nTo express this in terms of the ionization potential, $I$, and electron affinity, $A$, we recall their definitions:\n$$ I = E(N-1) - E(N) $$\n$$ A = E(N) - E(N+1) $$\nThese definitions are for vertical processes, meaning all energies are evaluated at the same fixed nuclear geometry, which is consistent with the fixed external potential condition, $(\\dots)_{v}$.\n\nWe can rearrange the expression for $\\eta$ by regrouping the energy terms:\n$$ \\eta \\approx \\frac{1}{2} \\left[ (E(N-1) - E(N)) + (E(N+1) - E(N)) \\right] $$\nThe first term, $(E(N-1) - E(N))$, is precisely the definition of the ionization potential, $I$. The second term, $(E(N+1) - E(N))$, is the negative of the electron affinity, $A$, since $A = E(N) - E(N+1)$, which implies $-(E(N) - E(N+1)) = E(N+1) - E(N) = -A$.\n\nSubstituting these into the expression for $\\eta$ yields the desired relationship:\n$$ \\eta = \\frac{1}{2} (I - A) $$\nThis expression, known as the Parr-Pearson approximation for hardness, is the result for the first part of the task. The use of an equality sign is justified as this finite-difference formulation constitutes an operational definition of hardness within this conceptual framework.\n\nPart 2: Numerical evaluation of $\\eta$.\n\nFor the second part, we are given the following numerical values for a specific molecule:\n- Vertical ionization potential: $I = 9.47~\\text{eV}$\n- Vertical electron affinity: $A = 1.82~\\text{eV}$\n\nUsing the formula derived above, we can now calculate the global hardness, $\\eta$:\n$$ \\eta = \\frac{1}{2} (9.47~\\text{eV} - 1.82~\\text{eV}) $$\nPerforming the subtraction within the parentheses:\n$$ \\eta = \\frac{1}{2} (7.65~\\text{eV}) $$\nFinally, completing the calculation:\n$$ \\eta = 3.825~\\text{eV} $$\nThe problem requires the result to be rounded to four significant figures. The calculated value of $3.825$ already contains exactly four significant figures. Thus, no further rounding is necessary. The final answer is $3.825~\\text{eV}$.", "answer": "$$\n\\boxed{3.825}\n$$", "id": "2879233"}, {"introduction": "With a working definition of hardness, we can explore its chemical consequences in predicting reactivity. This practice problem models one of the most fundamental processes in chemistry: the transfer of charge between weakly interacting molecular fragments. Your task is to use the concepts of chemical potential and hardness to quantitatively predict the equilibrium charge distribution, thereby illustrating the foundational principle of electronegativity equalization [@problem_id:2879209].", "problem": "Two isolated fragments, labeled $A$ and $B$, with ground-state electron numbers $N_A^{0}$ and $N_B^{0}$ are brought into weak contact so that a small amount of charge can be transferred between them while the external potential remains fixed. Define $\\Delta N$ to be the number of electrons transferred from fragment $B$ to fragment $A$, so that the new electron numbers are $N_A = N_A^{0} + \\Delta N$ and $N_B = N_B^{0} - \\Delta N$. Work in the small-charge-transfer regime where a second-order expansion in electron number is accurate for each fragment’s energy.\n\nUse the following fundamental definitions from conceptual density functional theory (DFT):\n- The chemical potential $\\mu_{X}$ of fragment $X \\in \\{A,B\\}$ is $\\mu_{X} = \\left(\\frac{\\partial E_{X}}{\\partial N_{X}}\\right)_{v}$.\n- The chemical hardness $\\eta_{X}$ of fragment $X$ is $\\eta_{X} = \\frac{1}{2}\\left(\\frac{\\partial^{2} E_{X}}{\\partial N_{X}^{2}}\\right)_{v}$.\n- The Mulliken–Parr electronegativity $\\chi_{X}$ is related to the chemical potential by $\\chi_{X} = -\\mu_{X}$.\n\nAssume that higher-than-quadratic terms in the energy expansion are negligible and that each fragment’s hardness is positive. Construct the total energy $E_{\\text{tot}}(\\Delta N)$ of the pair up to quadratic order in $\\Delta N$, and determine the value of $\\Delta N$ that minimizes $E_{\\text{tot}}(\\Delta N)$. Express your final answer solely in terms of $\\chi_A$, $\\chi_B$, $\\eta_A$, and $\\eta_B$ as a single closed-form analytic expression. No units are required. No numerical rounding is required.", "solution": "The task is to obtain the charge transfer $\\Delta N$ that minimizes the total energy under a quadratic approximation in electron number, starting from definitions of chemical potential, hardness, and electronegativity.\n\nBy definition, for each fragment $X \\in \\{A,B\\}$ at fixed external potential, we expand the energy as a function of electron number $N_X$ around the isolated integer $N_X^{0}$:\n$$\nE_X(N_X^{0} + \\delta N_X) \\approx E_X(N_X^{0}) + \\mu_X\\, \\delta N_X + \\eta_X\\, (\\delta N_X)^{2},\n$$\nwhere $\\mu_X = \\left(\\frac{\\partial E_X}{\\partial N_X}\\right)_{v}$ and $\\eta_X = \\frac{1}{2}\\left(\\frac{\\partial^{2} E_X}{\\partial N_X^{2}}\\right)_{v}$. Stability of the isolated fragments implies $\\eta_X > 0$.\n\nBy convention in the problem, $\\Delta N$ is the number of electrons transferred from $B$ to $A$, so that\n$$\nN_A = N_A^{0} + \\Delta N, \\quad N_B = N_B^{0} - \\Delta N,\n$$\nand thus $\\delta N_A = \\Delta N$ and $\\delta N_B = -\\Delta N$.\n\nUsing the quadratic expansions for both fragments, the total energy is\n$$\nE_{\\text{tot}}(\\Delta N) = E_A(N_A^{0} + \\Delta N) + E_B(N_B^{0} - \\Delta N).\n$$\nExpanding each term,\n$$\nE_A(N_A^{0} + \\Delta N) \\approx E_A(N_A^{0}) + \\mu_A\\, \\Delta N + \\eta_A\\, (\\Delta N)^{2},\n$$\n$$\nE_B(N_B^{0} - \\Delta N) \\approx E_B(N_B^{0}) - \\mu_B\\, \\Delta N + \\eta_B\\, (\\Delta N)^{2}.\n$$\nAdding these,\n$$\nE_{\\text{tot}}(\\Delta N) \\approx \\left[E_A(N_A^{0}) + E_B(N_B^{0})\\right] + (\\mu_A - \\mu_B)\\, \\Delta N + (\\eta_A + \\eta_B)\\, (\\Delta N)^{2}.\n$$\n\nTo find the minimizing $\\Delta N$, differentiate with respect to $\\Delta N$ and set the derivative to zero:\n$$\n\\frac{dE_{\\text{tot}}}{d\\Delta N} = (\\mu_A - \\mu_B) + 2(\\eta_A + \\eta_B)\\, \\Delta N = 0.\n$$\nSolving for $\\Delta N$ gives\n$$\n\\Delta N^{*} = \\frac{\\mu_B - \\mu_A}{2(\\eta_A + \\eta_B)}.\n$$\n\nNow use the relation between electronegativity and chemical potential, $\\chi_X = -\\mu_X$, so that $\\mu_B - \\mu_A = -\\chi_B + \\chi_A = \\chi_A - \\chi_B$. Therefore,\n$$\n\\Delta N^{*} = \\frac{\\chi_A - \\chi_B}{2(\\eta_A + \\eta_B)}.\n$$\n\nWe can verify that this stationary point is a minimum because the second derivative is\n$$\n\\frac{d^{2}E_{\\text{tot}}}{d(\\Delta N)^{2}} = 2(\\eta_A + \\eta_B),\n$$\nwhich is positive under the stated assumption that $\\eta_A > 0$ and $\\eta_B > 0$. Hence the expression above is indeed the energy-minimizing charge transfer under the quadratic approximation.\n\nThe desired result, expressed solely in terms of $\\chi_A$, $\\chi_B$, $\\eta_A$, and $\\eta_B$, is\n$$\n\\Delta N^{*} = \\frac{\\chi_A - \\chi_B}{2(\\eta_A + \\eta_B)}.\n$$", "answer": "$$\\boxed{\\frac{\\chi_A-\\chi_B}{2(\\eta_A+\\eta_B)}}$$", "id": "2879209"}, {"introduction": "This final practice addresses a critical aspect of applying conceptual DFT: the computational method used to approximate the ionization potential and electron affinity. This exercise directs you to contrast the rigorous approach using total energy differences ($\\Delta E$) with the common approximation based on Kohn-Sham frontier orbital energies. Through a quantitative comparison using hypothetical data from various functionals, you will gain a deeper appreciation for the known limitations of practical DFT calculations and the importance of choosing the right method for the job [@problem_id:2879242].", "problem": "You are given a set of ground-state total energies and frontier orbital eigenvalues, each produced for the same neutral system by separate Density Functional Theory (DFT) calculations performed with different exchange-correlation functionals. Your task is to formalize and quantify how the choice of using total-energy differences versus frontier orbital eigenvalues affects the computed global chemical hardness.\n\nStart from the following fundamental base in conceptual Density Functional Theory (DFT):\n- The zero-temperature ground-state energy at fixed external potential $v(\\mathbf{r})$, denoted $E(N)$, is a piecewise-linear function of the (possibly fractional) electron number $N$, with kinks at integer $N$.\n- The chemical potential $\\mu$ is the first derivative $\\mu = \\left(\\partial E / \\partial N\\right)_{v}$, understood as a one-sided derivative at integer $N$.\n- The global chemical hardness $\\eta$ is the second derivative $\\eta = \\frac{1}{2}\\left(\\partial^{2} E / \\partial N^{2}\\right)_{v}$, interpreted via a finite-difference at integer $N$.\n- The ionization energy $I$ and electron affinity $A$ are defined by ground-state energy differences at fixed nuclear geometry and external potential: removing or adding one electron changes the energy by well-defined amounts.\n\nUsing only these bases, do the following:\n1. Derive expressions for the ionization energy $I$ and electron affinity $A$ as differences of total energies at integer electron numbers $N$, $N-1$, and $N+1$.\n2. Using a symmetric finite-difference construction at integer $N$ with step size $\\Delta N = 1$, derive an expression for the global chemical hardness $\\eta$ in terms of $I$ and $A$.\n3. Using Kohn–Sham Density Functional Theory (KS-DFT; Kohn–Sham), frontier orbital theory, and Janak’s theorem, obtain approximations for $I$ and $A$ in terms of the neutral system’s highest occupied molecular orbital (HOMO) and lowest unoccupied molecular orbital (LUMO) Kohn–Sham eigenvalues. State clearly any assumptions you need to make about the exchange–correlation derivative discontinuity for approximate functionals.\n4. Define the following diagnostics to quantify the effect on the global hardness when using frontier eigenvalue approximations instead of total-energy differences:\n   - The absolute deviation in hardness, $\\Delta \\eta_{\\mathrm{abs}} = \\left|\\eta_{\\Delta E} - \\eta_{\\mathrm{orb}}\\right|$.\n   - The relative deviation in hardness, $\\Delta \\eta_{\\mathrm{rel}} = \\Delta \\eta_{\\mathrm{abs}} / \\eta_{\\Delta E}$.\n   Here, $\\eta_{\\Delta E}$ is the hardness computed from total-energy differences and $\\eta_{\\mathrm{orb}}$ is the hardness computed from frontier orbital approximations.\n5. Implement a program that, for each test case below, computes $I$, $A$, $\\eta_{\\Delta E}$, the frontier-orbital approximations to $I$ and $A$, the corresponding $\\eta_{\\mathrm{orb}}$, and finally the two diagnostics $\\Delta \\eta_{\\mathrm{abs}}$ and $\\Delta \\eta_{\\mathrm{rel}}$.\n\nAll energies are given in electronvolts, and all requested outputs involving energies must be reported in electronvolts. Relative deviations are dimensionless. Use the following test suite of parameter values (each corresponds to an independent “functional” label, but all are to be treated as separate test cases):\n\n- Test case $1$ (GGA-like):\n  - $E(N-1) = -90.800\\,\\mathrm{eV}$, $E(N) = -100.000\\,\\mathrm{eV}$, $E(N+1) = -100.800\\,\\mathrm{eV}$\n  - $\\epsilon_{\\mathrm{HOMO}} = -4.700\\,\\mathrm{eV}$, $\\epsilon_{\\mathrm{LUMO}} = +0.800\\,\\mathrm{eV}$\n\n- Test case $2$ (hybrid-like):\n  - $E(N-1) = -93.300\\,\\mathrm{eV}$, $E(N) = -102.000\\,\\mathrm{eV}$, $E(N+1) = -103.300\\,\\mathrm{eV}$\n  - $\\epsilon_{\\mathrm{HOMO}} = -7.200\\,\\mathrm{eV}$, $\\epsilon_{\\mathrm{LUMO}} = -0.300\\,\\mathrm{eV}$\n\n- Test case $3$ (range-separated hybrid-like):\n  - $E(N-1) = -91.900\\,\\mathrm{eV}$, $E(N) = -101.000\\,\\mathrm{eV}$, $E(N+1) = -102.000\\,\\mathrm{eV}$\n  - $\\epsilon_{\\mathrm{HOMO}} = -9.000\\,\\mathrm{eV}$, $\\epsilon_{\\mathrm{LUMO}} = -1.200\\,\\mathrm{eV}$\n\n- Test case $4$ (LDA-like with negative electron affinity):\n  - $E(N-1) = -91.000\\,\\mathrm{eV}$, $E(N) = -99.000\\,\\mathrm{eV}$, $E(N+1) = -98.500\\,\\mathrm{eV}$\n  - $\\epsilon_{\\mathrm{HOMO}} = -3.500\\,\\mathrm{eV}$, $\\epsilon_{\\mathrm{LUMO}} = +1.000\\,\\mathrm{eV}$\n\n- Test case $5$ (meta-GGA-like with near-zero electron affinity):\n  - $E(N-1) = -113.000\\,\\mathrm{eV}$, $E(N) = -120.000\\,\\mathrm{eV}$, $E(N+1) = -120.000\\,\\mathrm{eV}$\n  - $\\epsilon_{\\mathrm{HOMO}} = -4.000\\,\\mathrm{eV}$, $\\epsilon_{\\mathrm{LUMO}} = 0.000\\,\\mathrm{eV}$\n\nYour program must compute, for each test case, the list $[\\eta_{\\Delta E}, \\eta_{\\mathrm{orb}}, \\Delta \\eta_{\\mathrm{abs}}, \\Delta \\eta_{\\mathrm{rel}}]$, in that order, where:\n- $\\eta_{\\Delta E}$ and $\\eta_{\\mathrm{orb}}$ are in $\\mathrm{eV}$ and must be rounded to $6$ decimal places.\n- $\\Delta \\eta_{\\mathrm{abs}}$ is in $\\mathrm{eV}$ and must be rounded to $6$ decimal places.\n- $\\Delta \\eta_{\\mathrm{rel}}$ is dimensionless and must be rounded to $6$ decimal places.\n\nFinal output format: Your program should produce a single line of output containing the results as a comma-separated list of lists, with each inner list corresponding to a test case, e.g., $[[\\cdots],[\\cdots],\\ldots]$. No extra whitespace or text is permitted in the output line.", "solution": "The problem statement has been analyzed and is found to be scientifically grounded, well-posed, objective, and internally consistent. It presents a valid task in the field of conceptual Density Functional Theory (DFT). We proceed with the solution.\n\n### 1. Ionization Energy ($I$) and Electron Affinity ($A$) from Total Energies\n\nBy definition, the vertical ionization energy, $I$, is the energy required to remove one electron from a system of $N$ electrons at a fixed nuclear geometry. It is the energy difference between the ground state of the $(N-1)$-electron system and the $N$-electron system.\n\n$$I = E(N-1) - E(N)$$\n\nSimilarly, the vertical electron affinity, $A$, is the energy released when one electron is added to the $N$-electron system. It is the energy difference between the ground state of the $N$-electron system and the $(N+1)$-electron system. A positive value of $A$ indicates that the anion is stable relative to the neutral species.\n\n$$A = E(N) - E(N+1)$$\n\nThese expressions for $I$ and $A$ are exact within the given framework, assuming the provided energies $E(N-1)$, $E(N)$, and $E(N+1)$ are the true ground-state energies for the respective electron counts.\n\n### 2. Global Hardness ($\\eta$) from $I$ and $A$\n\nThe global chemical hardness, $\\eta$, is defined as half the second derivative of the energy $E$ with respect to the number of electrons $N$ at a constant external potential $v(\\mathbf{r})$.\n\n$$\\eta = \\frac{1}{2} \\left(\\frac{\\partial^2 E}{\\partial N^2}\\right)_v$$\n\nTo evaluate this for an integer number of electrons, $N$, we must use a finite-difference approximation, as the function $E(N)$ is piecewise linear with discontinuous derivatives at integer $N$. We construct a symmetric second-order finite difference using a step size of $\\Delta N = 1$.\n\nThe first derivative, $\\left(\\partial E / \\partial N\\right)_v$, is the chemical potential, $\\mu$. At integer $N$, there are two one-sided derivatives:\n- The derivative from the right $(N \\to N+1)$: $\\mu^+ = \\frac{E(N+1)-E(N)}{(N+1)-N} = E(N+1)-E(N) = -A$.\n- The derivative from the left $(N \\to N-1)$: $\\mu^- = \\frac{E(N)-E(N-1)}{N-(N-1)} = E(N)-E(N-1) = -I$.\n\nThe second derivative is the rate of change of the first derivative. Using a central difference centered at $N$:\n\n$$\\left(\\frac{\\partial^2 E}{\\partial N^2}\\right)_v \\approx \\frac{\\mu^+ - \\mu^-}{1} = (-A) - (-I) = I - A$$\n\nSubstituting this into the definition of hardness gives the expression for the hardness based on total energy differences, which we denote $\\eta_{\\Delta E}$:\n\n$$\\eta_{\\Delta E} = \\frac{1}{2}(I - A)$$\n\nCombining with the expressions for $I$ and $A$, we obtain:\n\n$$\\eta_{\\Delta E} = \\frac{1}{2}([E(N-1) - E(N)] - [E(N) - E(N+1)]) = \\frac{E(N-1) + E(N+1) - 2E(N)}{2}$$\n\nThis expression represents half of the energy gap for disproportionation ($2M \\rightarrow M^+ + M^-$).\n\n### 3. Approximations for $I$ and $A$ from Frontier Orbitals\n\nWithin the Kohn-Sham (KS) DFT framework, Janak's theorem states that the derivative of the total energy with respect to the occupation number $n_i$ of the $i$-th KS orbital is equal to the eigenvalue of that orbital, $\\epsilon_i$.\n\n$$\\frac{\\partial E}{\\partial n_i} = \\epsilon_i$$\n\nFor the exact exchange-correlation (XC) functional, it can be shown that the ionization energy is precisely the negative of the highest occupied molecular orbital (HOMO) energy: $I = -\\epsilon_{\\mathrm{HOMO}}$. However, the relationship for the electron affinity is complicated by the derivative discontinuity of the XC potential, $\\Delta_{xc}$, which causes the energy of the lowest unoccupied molecular orbital (LUMO), $\\epsilon_{\\mathrm{LUMO}}$, to shift discontinuously as its occupation changes from $0$ to a non-zero value.\n\nFor approximate XC functionals, such as the Local Density Approximation (LDA) and Generalized Gradient Approximations (GGAs), this derivative discontinuity is nearly zero. This leads to a severe underestimation of the fundamental gap ($I-A$) by the KS orbital gap ($\\epsilon_{\\mathrm{LUMO}}-\\epsilon_{\\mathrm{HOMO}}$). Despite this known deficiency, a common practice is to adopt Koopmans'-like approximations for $I$ and $A$.\n\n**Assumption:** We assume that the XC functional used has a negligible derivative discontinuity. This allows for the approximation of the ionization energy and electron affinity directly from the HOMO and LUMO eigenvalues of the neutral $N$-electron system.\n\nUnder this assumption, we have:\n\n$$I_{\\mathrm{orb}} \\approx -\\epsilon_{\\mathrm{HOMO}}$$\n$$A_{\\mathrm{orb}} \\approx -\\epsilon_{\\mathrm{LUMO}}$$\n\nUsing these orbital-based approximations for $I$ and $A$, we can define an orbital-based hardness, $\\eta_{\\mathrm{orb}}$:\n\n$$\\eta_{\\mathrm{orb}} = \\frac{1}{2}(I_{\\mathrm{orb}} - A_{\\mathrm{orb}}) = \\frac{1}{2}((-\\epsilon_{\\mathrm{HOMO}}) - (-\\epsilon_{\\mathrm{LUMO}}))$$\n\n$$\\eta_{\\mathrm{orb}} = \\frac{\\epsilon_{\\mathrm{LUMO}} - \\epsilon_{\\mathrm{HOMO}}}{2}$$\n\nThis demonstrates that the hardness, under these approximations, is simply half the HOMO-LUMO gap. The discrepancy between $\\eta_{\\Delta E}$ and $\\eta_{\\mathrm{orb}}$ is a direct consequence of the deficiencies in the approximate XC functional, particularly its self-interaction error and lack of derivative discontinuity.\n\n### 4. Diagnostic Deviations\n\nTo quantify the difference between the two methods of calculating hardness, we use the diagnostic measures defined in the problem statement.\n\n- Absolute deviation in hardness:\n  $$\\Delta \\eta_{\\mathrm{abs}} = |\\eta_{\\Delta E} - \\eta_{\\mathrm{orb}}|$$\n\n- Relative deviation in hardness:\n  $$\\Delta \\eta_{\\mathrm{rel}} = \\frac{\\Delta \\eta_{\\mathrm{abs}}}{\\eta_{\\Delta E}}$$\nThis assumes $\\eta_{\\Delta E} \\neq 0$, which is true for all provided test cases, as the energy $E(N)$ is convex.\n\nThese metrics will now be computed for each test case using the derived formulae.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the DFT hardness problem by calculating and comparing hardness values\n    derived from total energy differences and frontier orbital energies.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each tuple contains: (E(N-1), E(N), E(N+1), e_homo, e_lumo) in eV.\n    test_cases = [\n        # Test case 1 (GGA-like)\n        (-90.800, -100.000, -100.800, -4.700, 0.800),\n        # Test case 2 (hybrid-like)\n        (-93.300, -102.000, -103.300, -7.200, -0.300),\n        # Test case 3 (range-separated hybrid-like)\n        (-91.900, -101.000, -102.000, -9.000, -1.200),\n        # Test case 4 (LDA-like with negative electron affinity)\n        (-91.000, -99.000, -98.500, -3.500, 1.000),\n        # Test case 5 (meta-GGA-like with near-zero electron affinity)\n        (-113.000, -120.000, -120.000, -4.000, 0.000),\n    ]\n\n    all_results = []\n    for case in test_cases:\n        e_n_minus_1, e_n, e_n_plus_1, eps_homo, eps_lumo = case\n\n        # 1. Calculate properties from total energy differences (Delta E method).\n        # Ionization energy I = E(N-1) - E(N)\n        i_delta_e = e_n_minus_1 - e_n\n        # Electron affinity A = E(N) - E(N+1)\n        a_delta_e = e_n - e_n_plus_1\n        # Hardness eta_delta_e = (I - A) / 2\n        eta_delta_e = (i_delta_e - a_delta_e) / 2.0\n\n        # 2. Calculate properties from frontier orbital eigenvalues (Orbital method).\n        # Hardness eta_orb = (epsilon_LUMO - epsilon_HOMO) / 2\n        eta_orb = (eps_lumo - eps_homo) / 2.0\n\n        # 3. Calculate the diagnostic deviations.\n        # Absolute deviation\n        delta_eta_abs = abs(eta_delta_e - eta_orb)\n        # Relative deviation\n        # The problem setup ensures eta_delta_e is non-zero.\n        delta_eta_rel = delta_eta_abs / eta_delta_e if eta_delta_e != 0 else 0.0\n\n        # 4. Format results to 6 decimal places as strings.\n        # The problem asks for computed list of values, not I, A, etc.\n        # So no need to compute I_orb and A_orb explicitly for the output.\n        # The list is [eta_delta_e, eta_orb, delta_eta_abs, delta_eta_rel].\n        \n        # Rounding for output formatting. np.round might be better for half-way cases\n        # but string formatting is usually sufficient and direct.\n        # The problem states values should be rounded, so we will use python's round().\n        eta_delta_e_r = round(eta_delta_e, 6)\n        eta_orb_r = round(eta_orb, 6)\n        delta_eta_abs_r = round(delta_eta_abs, 6)\n        delta_eta_rel_r = round(delta_eta_rel, 6)\n        \n        case_results = [\n            f\"{eta_delta_e_r:.6f}\",\n            f\"{eta_orb_r:.6f}\",\n            f\"{delta_eta_abs_r:.6f}\",\n            f\"{delta_eta_rel_r:.6f}\",\n        ]\n        all_results.append(case_results)\n\n    # 5. Format the final output string as a comma-separated list of lists.\n    # e.g., [[val1,val2,...],[val1,val2,...]]\n    inner_lists_str = [f\"[{','.join(res)}]\" for res in all_results]\n    final_output_str = f\"[{','.join(inner_lists_str)}]\"\n\n    print(final_output_str)\n\nsolve()\n```", "id": "2879242"}]}