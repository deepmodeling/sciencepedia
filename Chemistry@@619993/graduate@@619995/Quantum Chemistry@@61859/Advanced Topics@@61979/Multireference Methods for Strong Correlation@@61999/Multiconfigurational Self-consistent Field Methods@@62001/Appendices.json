{"hands_on_practices": [{"introduction": "The multiconfigurational wave function is built from a basis of functions that are eigenstates of the spin operators $\\hat{S}^2$ and $\\hat{S}_z$. This exercise demystifies these basis functions, known as Configuration State Functions (CSFs), by having you construct them from scratch for the minimal CAS(2,2) active space. Mastering this fundamental derivation [@problem_id:2906845] is essential for understanding how multireference methods properly handle electron spin and for interpreting the output of advanced quantum chemistry calculations.", "problem": "In the multiconfigurational self-consistent field framework, a spin-adapted configuration state function (CSF) is a many-electron basis function that is an eigenfunction of the total spin-squared operator $\\hat{S}^{2}$ and its $z$-component $\\hat{S}_{z}$. Consider an active space containing $2$ spatial orbitals, labeled $\\phi_{1}$ and $\\phi_{2}$, occupied by $2$ electrons. Let the associated spin orbitals be denoted $\\{1\\alpha,\\,1\\beta,\\,2\\alpha,\\,2\\beta\\}$, where $1$ and $2$ label spatial parts $\\phi_{1}$ and $\\phi_{2}$, and $\\alpha,\\beta$ denote spin-up and spin-down spinors, respectively.\n\nWork in the $2$-electron Slater determinant basis formed by occupying any two distinct spin orbitals from $\\{1\\alpha,\\,1\\beta,\\,2\\alpha,\\,2\\beta\\}$. Adopt the specific ordered determinant basis\n$$\n\\big\\{|1\\alpha\\,1\\beta\\rangle,\\ |2\\alpha\\,2\\beta\\rangle,\\ |1\\alpha\\,2\\alpha\\rangle,\\ |1\\beta\\,2\\beta\\rangle,\\ |1\\alpha\\,2\\beta\\rangle,\\ |1\\beta\\,2\\alpha\\rangle\\big\\}.\n$$\nUsing only the fundamental requirements of fermionic antisymmetry, the definition of Slater determinants, and angular momentum coupling of two $spin-\\tfrac{1}{2}$ particles (via standard Clebsch–Gordan coefficients), construct the complete set of normalized spin-adapted CSFs for this active space. Identify which CSFs are singlets ($S=0$; specifically give the $M_{S}=0$ forms) and which are triplets ($S=1$; give the $M_{S}=+1,0,-1$ forms), and express each CSF explicitly as a linear combination of the determinants in the ordered basis above with exact normalization and phases.\n\nAnswer specification:\n- Express your final result as the single $6\\times 6$ coefficient matrix that maps the ordered determinant basis above (columns) to the ordered CSF basis you construct (rows). Order your CSF rows as follows: first the two closed-shell singlets with double occupancy of $\\phi_{1}$ and $\\phi_{2}$ (in that order), then the open-shell singlet with one electron in each spatial orbital ($M_{S}=0$), followed by the triplet with $M_{S}=+1$, the triplet with $M_{S}=0$, and the triplet with $M_{S}=-1$.\n- Do not round; keep all coefficients in exact form.\n- Provide only the matrix as your final answer, using standard linear-algebra notation.", "solution": "The goal is to construct spin-adapted configuration state functions (CSFs) for a $2$-electron, $2$-orbital active space that are simultaneous eigenfunctions of $\\hat{S}^{2}$ and $\\hat{S}_{z}$, while respecting fermionic antisymmetry. We begin from the fundamental facts:\n- A Slater determinant formed from orthonormal spin orbitals is an antisymmetric $N$-electron wave function.\n- The total spin operators for two electrons are $\\hat{\\boldsymbol{S}}=\\hat{\\boldsymbol{s}}_{1}+\\hat{\\boldsymbol{s}}_{2}$, with $\\hat{S}^{2}=\\hat{s}_{1}^{2}+\\hat{s}_{2}^{2}+2\\,\\hat{\\boldsymbol{s}}_{1}\\cdot\\hat{\\boldsymbol{s}}_{2}$.\n- For two $spin-\\tfrac{1}{2}$ particles, the coupled spin eigenstates are a triplet with $S=1$ (three $M_{S}$ values) and a singlet with $S=0$ (one $M_{S}=0$ state). The Clebsch–Gordan coefficients yield\n$$\n\\begin{aligned}\n&\\text{Triplet }(S=1):\\quad\n\\big|1,1\\big\\rangle=\\big|\\alpha\\alpha\\big\\rangle,\\quad\n\\big|1,0\\big\\rangle=\\frac{1}{\\sqrt{2}}\\big(\\big|\\alpha\\beta\\big\\rangle+\\big|\\beta\\alpha\\big\\rangle\\big),\\quad\n\\big|1,-1\\big\\rangle=\\big|\\beta\\beta\\big\\rangle,\\\\\n&\\text{Singlet }(S=0):\\quad\n\\big|0,0\\big\\rangle=\\frac{1}{\\sqrt{2}}\\big(\\big|\\alpha\\beta\\big\\rangle-\\big|\\beta\\alpha\\big\\rangle\\big).\n\\end{aligned}\n$$\n\nWe use spatial orbitals $\\phi_{1}$ and $\\phi_{2}$ with associated spin orbitals $\\{1\\alpha,\\,1\\beta,\\,2\\alpha,\\,2\\beta\\}$. The $2$-electron Slater determinants built from this set are the $6$ determinants obtained by choosing any two distinct spin orbitals. We adopt the ordered determinant basis\n$$\n\\big\\{|1\\alpha\\,1\\beta\\rangle,\\ |2\\alpha\\,2\\beta\\rangle,\\ |1\\alpha\\,2\\alpha\\rangle,\\ |1\\beta\\,2\\beta\\rangle,\\ |1\\alpha\\,2\\beta\\rangle,\\ |1\\beta\\,2\\alpha\\rangle\\big\\}.\n$$\n\nWe now construct CSFs. A CSF is a linear combination of determinants that is an eigenfunction of $\\hat{S}^{2}$ with a definite $S$ and of $\\hat{S}_{z}$ with a definite $M_{S}$. The coupling of spins is entirely determined by the spin parts, while the spatial occupations determine which determinants can contribute to a given CSF.\n\n$1.$ Closed-shell singlets with double occupancy:\n- When both electrons occupy the same spatial orbital with opposite spins, the determinant has the spin function that is intrinsically the antisymmetric pair for that orbital, and it is an eigenfunction of $\\hat{S}^{2}$ with $S=0$. Hence the determinants\n$$\n|1\\alpha\\,1\\beta\\rangle,\\qquad |2\\alpha\\,2\\beta\\rangle\n$$\nare already normalized singlet CSFs with $S=0$, $M_{S}=0$. There is no mixing between these and open-shell configurations because they occupy different spin-orbital sets.\n\nThus we have two normalized singlet CSFs:\n$$\n\\big|(1)^{2};\\,S=0,M_{S}=0\\big\\rangle=|1\\alpha\\,1\\beta\\rangle,\\qquad\n\\big|(2)^{2};\\,S=0,M_{S}=0\\big\\rangle=|2\\alpha\\,2\\beta\\rangle.\n$$\n\n$2.$ Open-shell singlet with one electron in each spatial orbital:\n- For one electron in each of $\\phi_{1}$ and $\\phi_{2}$, the determinants with $M_{S}=0$ are $|1\\alpha\\,2\\beta\\rangle$ and $|1\\beta\\,2\\alpha\\rangle$. The singlet spin coupling is the antisymmetric combination:\n$$\n\\big|S=0,M_{S}=0\\big\\rangle_{\\text{open}}=\\frac{1}{\\sqrt{2}}\\Big(|1\\alpha\\,2\\beta\\rangle-\\,|1\\beta\\,2\\alpha\\rangle\\Big).\n$$\nThis state is normalized and has $\\hat{S}^{2}$ eigenvalue $S(S+1)=0$ by construction.\n\n$3.$ Triplet with one electron in each spatial orbital:\n- The triplet manifold has three $M_{S}$ components. Using the Clebsch–Gordan coefficients and the fact that both electrons occupy different spatial orbitals, the triplet CSFs are\n$$\n\\begin{aligned}\n\\big|S=1,M_{S}=+1\\big\\rangle&=|1\\alpha\\,2\\alpha\\rangle,\\\\\n\\big|S=1,M_{S}=0\\big\\rangle&=\\frac{1}{\\sqrt{2}}\\Big(|1\\alpha\\,2\\beta\\rangle+\\,|1\\beta\\,2\\alpha\\rangle\\Big),\\\\\n\\big|S=1,M_{S}=-1\\big\\rangle&=|1\\beta\\,2\\beta\\rangle,\n\\end{aligned}\n$$\nall normalized.\n\nThese six CSFs form an orthonormal set because:\n- Distinct $S$ or $M_{S}$ quantum numbers imply orthogonality as eigenfunctions of commuting Hermitian operators.\n- Within the same $M_{S}$ subspace for the open-shell sector, the singlet and triplet combinations are orthogonal due to the relative phase and the orthonormality of determinants.\n- The closed-shell determinants are orthogonal to the open-shell ones by virtue of distinct occupation patterns.\n\nWe now express each CSF as a linear combination of the ordered determinant basis. Define the determinant column order as\n$$\n\\Big[\\,|1\\alpha\\,1\\beta\\rangle,\\ |2\\alpha\\,2\\beta\\rangle,\\ |1\\alpha\\,2\\alpha\\rangle,\\ |1\\beta\\,2\\beta\\rangle,\\ |1\\alpha\\,2\\beta\\rangle,\\ |1\\beta\\,2\\alpha\\rangle\\,\\Big].\n$$\nDefine the CSF row order as\n$$\n\\Big[\\,\\big|(1)^{2};S=0,0\\big\\rangle,\\ \\big|(2)^{2};S=0,0\\big\\rangle,\\ \\big|S=0,0\\big\\rangle_{\\text{open}},\\ \\big|1,+1\\big\\rangle,\\ \\big|1,0\\big\\rangle,\\ \\big|1,-1\\big\\rangle\\,\\Big].\n$$\nReading off coefficients from the explicit forms above yields the $6\\times 6$ coefficient matrix $C$ whose $(i,j)$ entry is the coefficient of determinant $j$ in CSF $i$:\n- For $\\big|(1)^{2};S=0,0\\big\\rangle$: coefficients $[1,\\,0,\\,0,\\,0,\\,0,\\,0]$.\n- For $\\big|(2)^{2};S=0,0\\big\\rangle$: coefficients $[0,\\,1,\\,0,\\,0,\\,0,\\,0]$.\n- For $\\big|S=0,0\\big\\rangle_{\\text{open}}$: coefficients $[0,\\,0,\\,0,\\,0,\\,\\tfrac{1}{\\sqrt{2}},\\,-\\tfrac{1}{\\sqrt{2}}]$.\n- For $\\big|1,+1\\big\\rangle$: coefficients $[0,\\,0,\\,1,\\,0,\\,0,\\,0]$.\n- For $\\big|1,0\\big\\rangle$: coefficients $[0,\\,0,\\,0,\\,0,\\,\\tfrac{1}{\\sqrt{2}},\\,\\tfrac{1}{\\sqrt{2}}]$.\n- For $\\big|1,-1\\big\\rangle$: coefficients $[0,\\,0,\\,0,\\,1,\\,0,\\,0]$.\n\nThus\n$$\nC=\n\\begin{pmatrix}\n1 & 0 & 0 & 0 & 0 & 0\\\\\n0 & 1 & 0 & 0 & 0 & 0\\\\\n0 & 0 & 0 & 0 & \\tfrac{1}{\\sqrt{2}} & -\\tfrac{1}{\\sqrt{2}}\\\\\n0 & 0 & 1 & 0 & 0 & 0\\\\\n0 & 0 & 0 & 0 & \\tfrac{1}{\\sqrt{2}} & \\tfrac{1}{\\sqrt{2}}\\\\\n0 & 0 & 0 & 1 & 0 & 0\n\\end{pmatrix}.\n$$\nEach row is normalized and mutually orthogonal, so $C$ is an orthogonal matrix. This $C$ is the desired transformation from the determinant basis to the spin-adapted CSF basis in the specified order.", "answer": "$$\\boxed{\\begin{pmatrix}\n1 & 0 & 0 & 0 & 0 & 0\\\\\n0 & 1 & 0 & 0 & 0 & 0\\\\\n0 & 0 & 0 & 0 & \\tfrac{1}{\\sqrt{2}} & -\\tfrac{1}{\\sqrt{2}}\\\\\n0 & 0 & 1 & 0 & 0 & 0\\\\\n0 & 0 & 0 & 0 & \\tfrac{1}{\\sqrt{2}} & \\tfrac{1}{\\sqrt{2}}\\\\\n0 & 0 & 0 & 1 & 0 & 0\n\\end{pmatrix}}$$", "id": "2906845"}, {"introduction": "While spin is a universal symmetry, the electronic structure of molecules is also governed by their geometric point group symmetry. This practice problem [@problem_id:2906791] applies the concepts of spin adaptation to a concrete chemical example, the $\\pi$-system of ethylene, and combines it with the power of group theory. By determining the irreducible representations of the active orbitals and the resulting CSFs, you will see firsthand how symmetry simplifies the configuration interaction problem and provides a rigorous language for classifying electronic states.", "problem": "Ethylene is planar and belongs to the point group $D_{2h}$. Adopt the standard $D_{2h}$ axis convention: the molecular plane is the $xy$-plane, the carbon–carbon double bond lies along the $x$-axis, and the $z$-axis is perpendicular to the molecular plane. In a minimal complete active space with two electrons in two spatial orbitals, denoted $\\mathrm{CAS}(2,2)$, choose the active orbitals to be the $\\pi$ and $\\pi^{\\ast}$ orbitals arising from the two carbon $p_{z}$ atomic orbitals.\n\nStarting from the definitions of symmetry-adapted linear combinations and irreducible representations, and using only character properties of the $D_{2h}$ operations $C_{2}(x)$, $C_{2}(y)$, $C_{2}(z)$, and inversion $i$, do the following:\n\n1. Construct the two symmetry-adapted linear combinations of the two $p_{z}$ atomic orbitals and determine their transformation properties under $C_{2}(x)$, $C_{2}(y)$, $C_{2}(z)$, and $i$. Assign the corresponding $D_{2h}$ irreducible representations to the bonding $\\pi$ and antibonding $\\pi^{\\ast}$ molecular orbitals.\n\n2. Form the spin-adapted singlet configuration state functions that can be built within the $\\mathrm{CAS}(2,2)$ space and use direct products of irreducible representations to assign the spatial symmetry to each singlet configuration.\n\nWhat is the dimension of the spin-adapted singlet $\\mathrm{A}_{g}$ subspace of the corresponding complete active space configuration interaction (CAS-CI) problem? Provide your final answer as a single integer with no units. If you obtain a numerical value, do not round it.", "solution": "The problem statement is subjected to validation before a solution is attempted.\n\n**Step 1: Extract Givens**\n- Molecule: Ethylene ($C_2H_4$)\n- Point group: $D_{2h}$\n- Axis convention: The molecular plane is the $xy$-plane, the carbon–carbon double bond lies along the $x$-axis, and the $z$-axis is perpendicular to the molecular plane.\n- Active space: $\\mathrm{CAS}(2,2)$, two electrons in two spatial orbitals.\n- Active orbitals: $\\pi$ and $\\pi^{\\ast}$ orbitals derived from the two carbon $p_{z}$ atomic orbitals.\n- Operations for analysis: $C_{2}(x)$, $C_{2}(y)$, $C_{2}(z)$, and inversion $i$.\n- Task 1: Construct symmetry-adapted linear combinations (SALCs) of the two $p_{z}$ atomic orbitals, determine their transformation properties under the specified operations, and assign the corresponding $D_{2h}$ irreducible representations (irreps).\n- Task 2: Form spin-adapted singlet configuration state functions (CSFs) within the $\\mathrm{CAS}(2,2)$ space and assign their spatial symmetry.\n- Final question: Determine the dimension of the spin-adapted singlet $\\mathrm{A}_{g}$ subspace of the CAS-CI problem.\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientific Groundedness**: The problem is a standard application of group theory to molecular orbital theory and configuration interaction, a fundamental topic in quantum chemistry. It is scientifically sound.\n- **Well-Posedness**: The problem is well-posed, providing a clear question with sufficient information to derive a unique, integer-valued answer.\n- **Objectivity**: The problem is stated in precise, objective, and technical language.\n\n**Step 3: Verdict and Action**\nThe problem is valid. A rigorous solution will be constructed.\n\nThe solution proceeds in two parts as requested by the problem statement.\n\n**Part 1: Symmetry of Molecular Orbitals**\n\nWe begin by defining the basis. Let the two carbon atoms be denoted $C_A$ and $C_B$. According to the specified axis convention, we place them at coordinates $C_A = (-d, 0, 0)$ and $C_B = (d, 0, 0)$ for some distance $d > 0$. The basis set consists of the two $p_z$ atomic orbitals, $\\phi_A$ centered on $C_A$ and $\\phi_B$ centered on $C_B$. A $p_z$ orbital has the functional form $f(r)z$, which is antisymmetric with respect to the $xy$-plane.\n\nWe analyze the transformation of the basis orbitals $\\phi_A$ and $\\phi_B$ under the specified symmetry operations of the $D_{2h}$ group.\n1.  **$C_{2}(x)$ rotation**: Rotation by $\\pi$ radians about the $x$-axis. The coordinates transform as $(x, y, z) \\rightarrow (x, -y, -z)$. The atoms $C_A$ and $C_B$ lie on the axis and are not exchanged. The $z$ coordinate inverts, so the $p_z$ orbital flips its sign.\n    $$\n    C_{2}(x)\\phi_A = -\\phi_A \\quad ; \\quad C_{2}(x)\\phi_B = -\\phi_B\n    $$\n2.  **$C_{2}(y)$ rotation**: Rotation by $\\pi$ radians about the $y$-axis. The coordinates transform as $(x, y, z) \\rightarrow (-x, y, -z)$. This operation exchanges the carbon atoms, $C_A \\leftrightarrow C_B$. The $z$ coordinate also inverts.\n    $$\n    C_{2}(y)\\phi_A = -\\phi_B \\quad ; \\quad C_{2}(y)\\phi_B = -\\phi_A\n    $$\n3.  **$C_{2}(z)$ rotation**: Rotation by $\\pi$ radians about the $z$-axis. The coordinates transform as $(x, y, z) \\rightarrow (-x, -y, z)$. This operation exchanges the carbon atoms, $C_A \\leftrightarrow C_B$. The $z$ coordinate is unchanged, so the $p_z$ orbital sign is preserved.\n    $$\n    C_{2}(z)\\phi_A = \\phi_B \\quad ; \\quad C_{2}(z)\\phi_B = \\phi_A\n    $$\n4.  **Inversion $i$**: Inversion through the origin $(0, 0, 0)$. The coordinates transform as $(x, y, z) \\rightarrow (-x, -y, -z)$. This operation exchanges the carbon atoms, $C_A \\leftrightarrow C_B$, and inverts the $z$ coordinate.\n    $$\n    i\\phi_A = -\\phi_B \\quad ; \\quad i\\phi_B = -\\phi_A\n    $$\n\nNext, we construct the symmetry-adapted linear combinations (SALCs). These are the bonding ($\\pi$) and antibonding ($\\pi^{\\ast}$) molecular orbitals (MOs). Let $\\psi_1$ be the bonding $\\pi$ MO and $\\psi_2$ be the antibonding $\\pi^{\\ast}$ MO, ignoring normalization constants.\n$$\n\\psi_1 = \\phi_A + \\phi_B \\quad (\\text{bonding } \\pi \\text{ orbital})\n$$\n$$\n\\psi_2 = \\phi_A - \\phi_B \\quad (\\text{antibonding } \\pi^{\\ast} \\text{ orbital})\n$$\nWe determine the irrep for each MO by finding its character under the specified operations.\n\nFor the bonding $\\pi$ orbital, $\\psi_1$:\n- $C_{2}(x)\\psi_1 = C_{2}(x)(\\phi_A + \\phi_B) = -\\phi_A - \\phi_B = -1 \\cdot \\psi_1$. The character is $\\chi(C_{2}(x)) = -1$.\n- $C_{2}(y)\\psi_1 = C_{2}(y)(\\phi_A + \\phi_B) = -\\phi_B - \\phi_A = -1 \\cdot \\psi_1$. The character is $\\chi(C_{2}(y)) = -1$.\n- $C_{2}(z)\\psi_1 = C_{2}(z)(\\phi_A + \\phi_B) = \\phi_B + \\phi_A = +1 \\cdot \\psi_1$. The character is $\\chi(C_{2}(z)) = +1$.\n- $i\\psi_1 = i(\\phi_A + \\phi_B) = -\\phi_B - \\phi_A = -1 \\cdot \\psi_1$. The character is $\\chi(i) = -1$.\nThe characters for $(\\chi(C_{2}(z)), \\chi(C_{2}(y)), \\chi(C_{2}(x)))$ are $(+1, -1, -1)$. The character under inversion is $-1$ (ungerade, $u$). Consulting the $D_{2h}$ character table, the irrep with these characters is $B_{1u}$. Thus, the $\\pi$ orbital has $b_{1u}$ symmetry.\n\nFor the antibonding $\\pi^{\\ast}$ orbital, $\\psi_2$:\n- $C_{2}(x)\\psi_2 = C_{2}(x)(\\phi_A - \\phi_B) = -\\phi_A - (-\\phi_B) = -(\\phi_A - \\phi_B) = -1 \\cdot \\psi_2$. The character is $\\chi(C_{2}(x)) = -1$.\n- $C_{2}(y)\\psi_2 = C_{2}(y)(\\phi_A - \\phi_B) = -\\phi_B - (-\\phi_A) = \\phi_A - \\phi_B = +1 \\cdot \\psi_2$. The character is $\\chi(C_{2}(y)) = +1$.\n- $C_{2}(z)\\psi_2 = C_{2}(z)(\\phi_A - \\phi_B) = \\phi_B - \\phi_A = -(\\phi_A - \\phi_B) = -1 \\cdot \\psi_2$. The character is $\\chi(C_{2}(z)) = -1$.\n- $i\\psi_2 = i(\\phi_A - \\phi_B) = -\\phi_B - (-\\phi_A) = \\phi_A - \\phi_B = +1 \\cdot \\psi_2$. The character is $\\chi(i) = +1$.\nThe characters for $(\\chi(C_{2}(z)), \\chi(C_{2}(y)), \\chi(C_{2}(x)))$ are $(-1, +1, -1)$. The character under inversion is $+1$ (gerade, $g$). Consulting the $D_{2h}$ character table, the irrep with these characters is $B_{2g}$. Thus, the $\\pi^{\\ast}$ orbital has $b_{2g}$ symmetry.\n\n**Part 2: Symmetry of Configuration State Functions and Final Dimension**\n\nThe active space is $\\mathrm{CAS}(2,2)$, with two electrons distributed among the two active orbitals: $\\psi_{b_{1u}}$ ($\\pi$) and $\\psi_{b_{2g}}$ ($\\pi^{\\ast}$). The possible electronic configurations are:\n1.  $(\\psi_{b_{1u}})^2 (\\psi_{b_{2g}})^0$\n2.  $(\\psi_{b_{1u}})^1 (\\psi_{b_{2g}})^1$\n3.  $(\\psi_{b_{1u}})^0 (\\psi_{b_{2g}})^2$\n\nWe are concerned with spin-adapted singlet CSFs. The spatial symmetry of a CSF is determined by the direct product of the irreps of the occupied one-electron orbitals.\n\n1.  **Configuration $(\\psi_{b_{1u}})^2$**: This configuration has a doubly occupied orbital, which uniquely forms a singlet state. The spatial symmetry $\\Gamma_1$ is given by the direct product:\n    $$\n    \\Gamma_1 = B_{1u} \\otimes B_{1u} = A_g\n    $$\n    The direct product of any irrep with itself is always the totally symmetric irrep, $A_g$. This configuration contributes one CSF of $A_g$ symmetry to the singlet manifold.\n\n2.  **Configuration $(\\psi_{b_{1u}})^1 (\\psi_{b_{2g}})^1$**: This configuration of two electrons in two different orbitals gives rise to one singlet state and one triplet state. The spatial symmetry $\\Gamma_2$ of both the singlet and triplet CSFs is given by the direct product:\n    $$\n    \\Gamma_2 = B_{1u} \\otimes B_{2g}\n    $$\n    We find the resulting irrep by multiplying the characters of $B_{1u}$ and $B_{2g}$:\n    - $\\chi(C_{2}(z)) = (+1) \\times (-1) = -1$\n    - $\\chi(C_{2}(y)) = (-1) \\times (+1) = -1$\n    - $\\chi(C_{2}(x)) = (-1) \\times (-1) = +1$\n    - $\\chi(i) = (-1) \\times (+1) = -1$ (ungerade, $u$)\n    The character set $(\\chi(C_{2}(z)), \\chi(C_{2}(y)), \\chi(C_{2}(x))) = (-1,-1,+1)$ corresponds to the $B_3$ representation. Combined with the ungerade parity, the symmetry is $B_{3u}$. This configuration contributes one singlet CSF of $B_{3u}$ symmetry. It does not contribute to the $A_g$ subspace.\n\n3.  **Configuration $(\\psi_{b_{2g}})^2$**: This is another doubly occupied configuration, forming a singlet state. The spatial symmetry $\\Gamma_3$ is:\n    $$\n    \\Gamma_3 = B_{2g} \\otimes B_{2g} = A_g\n    $$\n    This configuration contributes a second CSF of $A_g$ symmetry to the singlet manifold.\n\nThe spin-adapted singlet $A_g$ subspace of the CAS-CI problem is spanned by the singlet CSFs that transform according to the $A_g$ irrep. We have found two such CSFs: one arising from the $(\\psi_{b_{1u}})^2$ configuration and one from the $(\\psi_{b_{2g}})^2$ configuration. These two CSFs form a basis for the $A_g$ singlet block of the CI matrix.\n\nTherefore, the dimension of the spin-adapted singlet $A_g$ subspace is $2$.", "answer": "$$\\boxed{2}$$", "id": "2906791"}, {"introduction": "The \"self-consistent field\" aspect of MCSCF methods involves a complex, iterative optimization of both orbitals and CI coefficients, which presents significant numerical challenges. A common and frustrating problem, especially for excited states, is \"root flipping,\" where the optimization inadvertently jumps from the desired state to a different one. This advanced exercise [@problem_id:2654005] dives into the algorithmic heart of MCSCF, asking you to analyze and evaluate modern techniques designed to ensure stable convergence, thereby giving you an expert's view of how these powerful computational tools are made robust.", "problem": "A state-specific multiconfiguration self-consistent field (MCSCF) optimization targets an excited root of a given symmetry in a diatomic molecule near an avoided crossing with another root of the same symmetry. The MCSCF wavefunction is parameterized as $|\\Psi(\\mathbf{c},\\boldsymbol{\\kappa})\\rangle = \\exp(\\hat{\\kappa}) \\sum_I c_I |I\\rangle$, where $\\mathbf{c}$ is the vector of configuration interaction (CI) coefficients, $\\hat{\\kappa}$ generates an orbital unitary via an anti-Hermitian one-electron operator, and $\\{|I\\rangle\\}$ is a configuration basis built from the current orbitals. The Rayleigh–Ritz variational principle implies that at fixed $\\boldsymbol{\\kappa}$, $E(\\mathbf{c},\\boldsymbol{\\kappa})=\\langle \\Psi|\\hat{H}|\\Psi\\rangle$ is stationary with respect to $\\mathbf{c}$ under the normalization constraint, yielding a CI eigenvalue problem for the target root, while at fixed $\\mathbf{c}$, stationarity with respect to $\\boldsymbol{\\kappa}$ yields generalized Brillouin-like conditions. In practice, one alternates a CI diagonalization with a Newton–Raphson orbital update using the orbital Hessian (possibly including response couplings). Near an avoided crossing, the CI step can return a different eigenvector as the lowest-energy of the targeted symmetry after an orbital update, a phenomenon known as root flipping.\n\nFrom these first principles, consider the following proposed modifications intended to maintain the desired root throughout the optimization while preserving the exact state-specific stationary point in the limit of convergence and retaining local quadratic convergence of the Newton step. Which proposals satisfy these requirements? Choose all that apply.\n\nA. Introduce a state-tracking penalty that augments the objective to $E_{\\mathrm{track}}(\\mathbf{c},\\boldsymbol{\\kappa}) = E(\\mathbf{c},\\boldsymbol{\\kappa}) + \\dfrac{\\kappa_k}{2}\\, \\min_{\\phi\\in[0,2\\pi)} \\|\\mathbf{c} - e^{i\\phi}\\mathbf{c}^{\\mathrm{ref}}\\|^2$, where $\\mathbf{c}^{\\mathrm{ref}}$ is a fixed reference CI vector updated only when the overlap $|\\langle \\mathbf{c}|\\mathbf{c}^{\\mathrm{ref}}\\rangle|$ exceeds a threshold, and $\\kappa_k>0$ is a sequence satisfying $\\kappa_k \\to 0$ as the norm of the MCSCF gradient $\\|\\nabla E\\| \\to 0$.\n\nB. Add a uniform positive level shift to the orbital Hessian at every iteration: replace $\\mathbf{H}_{\\kappa\\kappa}$ by $\\mathbf{H}_{\\kappa\\kappa} + \\sigma \\mathbf{I}$ with a fixed constant $\\sigma>0$ independent of iteration, leaving the CI selection rule unchanged.\n\nC. Replace the CI selection rule by a maximum-overlap method (MOM) for the state: at each CI diagonalization, select the eigenvector that maximizes the absolute overlap $|\\langle \\mathbf{c}^{(k)}|\\mathbf{c}^{\\mathrm{ref}}\\rangle|$ with a reference $\\mathbf{c}^{\\mathrm{ref}}$ carried from the previous iteration, rather than the eigenvector with the lowest eigenvalue of the targeted symmetry; perform the orbital Newton step using the selected eigenvector and leave the objective unmodified.\n\nD. Replace the state-specific target by an equally weighted state-averaged MCSCF over the $2$ near-degenerate roots, optimize orbitals for the average energy, and finally report the desired state’s energy by diagonalizing the CI problem in the optimized orbitals.\n\nE. Modify only the orbital Hessian by adding a positive semidefinite projector-based level shift confined to directions that mix the target root with its nearest rival: define a projector $\\mathbf{P}$ onto the span of first-order CI response directions that couple the target to the rival under orbital rotations, and use $\\mathbf{H}^{\\mathrm{mod}}_{\\kappa\\kappa}=\\mathbf{H}_{\\kappa\\kappa}+\\sigma_k \\mathbf{P}$ with $\\sigma_k>0$ chosen adaptively and driven to $0$ as the state overlap $|\\langle \\mathbf{c}^{(k)}|\\mathbf{c}^{\\mathrm{ref}}\\rangle|\\to 1$; leave the objective and CI selection rule otherwise unchanged.", "solution": "The problem requires an evaluation of five proposed modifications to a state-specific multiconfigurational self-consistent field (MCSCF) optimization algorithm, specifically a second-order method using a Newton–Raphson step, in the difficult case of an avoided crossing. The success of a modification is judged by three criteria: (1) it must ensure the optimization follows the desired electronic state (state tracking) and avoids \"root flipping\"; (2) it must converge to the true stationary point of the state-specific energy, meaning the modification must not alter the solution point; (3) it must retain the local quadratic convergence rate characteristic of the unmodified Newton–Raphson method. We will analyze each proposal against these three requirements with uncompromising rigor.\n\nThe MCSCF energy is $E(\\mathbf{c},\\boldsymbol{\\kappa})$, where $\\mathbf{c}$ is the vector of configuration-interaction (CI) coefficients and $\\boldsymbol{\\kappa}$ parameterizes the orbital rotation unitary $\\exp(\\hat{\\kappa})$. A Newton step for the orbital parameters is given by $\\Delta\\boldsymbol{\\kappa} = -(\\mathbf{H}_{\\kappa\\kappa})^{-1} \\mathbf{g}_{\\kappa}$, where $\\mathbf{g}_{\\kappa}$ is the orbital gradient and $\\mathbf{H}_{\\kappa\\kappa}$ is the orbital Hessian.\n\n**Analysis of Proposal A**\n\nThis proposal augments the energy functional to $E_{\\mathrm{track}}(\\mathbf{c},\\boldsymbol{\\kappa}) = E(\\mathbf{c},\\boldsymbol{\\kappa}) + P_A$, where the penalty term is $P_A = \\dfrac{\\kappa_k}{2}\\, \\min_{\\phi\\in[0,2\\pi)} \\|\\mathbf{c} - e^{i\\phi}\\mathbf{c}^{\\mathrm{ref}}\\|^2$. The penalty parameter $\\kappa_k$ is a positive sequence such that $\\kappa_k \\to 0$ as the norm of the physical MCSCF gradient $\\|\\nabla E\\| \\to 0$.\n\n1.  **State Tracking**: The penalty term $P_A$ is minimized when the current CI vector $\\mathbf{c}$ has maximum overlap with a reference vector $\\mathbf{c}^{\\mathrm{ref}}$ (typically from the previous iteration). The CI diagonalization step, which minimizes the total functional $E_{\\mathrm{track}}$, will thus be biased toward selecting the root that most closely resembles the desired state, as defined by $\\mathbf{c}^{\\mathrm{ref}}$. This directly counteracts root flipping. This requirement is satisfied.\n\n2.  **Correct Stationary Point**: The stationary points of the optimization are where the gradient of the objective function is zero. The gradient of the augmented functional is $\\nabla E_{\\mathrm{track}} = \\nabla E + \\nabla P_A$. The condition $\\kappa_k \\to 0$ as $\\|\\nabla E\\| \\to 0$ ensures that at a stationary point of the original energy $E$ (where $\\|\\nabla E\\| = 0$), the penalty parameter $\\kappa_k$ becomes $0$. Consequently, the penalty term $P_A$ and its gradient $\\nabla P_A$ vanish. The condition $\\nabla E_{\\mathrm{track}} = 0$ thus becomes equivalent to $\\nabla E = 0$. The stationary point is not altered. This requirement is satisfied.\n\n3.  **Quadratic Convergence**: A Newton–Raphson step on $E_{\\mathrm{track}}$ would use the Hessian $\\mathbf{H}_{\\mathrm{track}} = \\mathbf{H}_{E} + \\mathbf{H}_{P_A}$, where $\\mathbf{H}_{E}$ is the Hessian of $E$ and $\\mathbf{H}_{P_A}$ is the Hessian of the penalty term. As convergence is approached, $\\|\\nabla E\\| \\to 0$ and thus $\\kappa_k \\to 0$. The entire penalty term, including its second derivatives that constitute $\\mathbf{H}_{P_A}$, vanishes. Therefore, $\\mathbf{H}_{\\mathrm{track}} \\to \\mathbf{H}_{E}$ in the vicinity of the solution. Using a Hessian that converges to the true Hessian of the objective function is a key condition for retaining local quadratic convergence. This requirement is satisfied.\n\n**Verdict for A**: **Correct**.\n\n**Analysis of Proposal B**\n\nThis proposal modifies the orbital Hessian to $\\mathbf{H}_{\\kappa\\kappa}^{\\mathrm{mod}} = \\mathbf{H}_{\\kappa\\kappa} + \\sigma \\mathbf{I}$, where $\\sigma>0$ is a fixed constant, for the calculation of the orbital update step. The CI selection rule is unchanged.\n\n1.  **State Tracking**: This modification does not affect the CI diagonalization step. The root selection is still based on choosing the lowest-energy root of the specified symmetry from the solutions of the CI problem. If the orbital update step leads to a situation where the characters of the two roots interchange, this method will select the new, lower-energy root and thus fail to track the desired state. Level-shifting regularizes the Newton step, which can improve stability, but it does not constitute a direct state-tracking mechanism. This requirement is not satisfied.\n\n2.  **Correct Stationary Point**: The modification only affects the calculation of the Newton step $\\Delta\\boldsymbol{\\kappa} = -(\\mathbf{H}_{\\kappa\\kappa} + \\sigma\\mathbf{I})^{-1}\\mathbf{g}_{\\kappa}$. The convergence condition is that the gradient of the energy, $\\mathbf{g}_{\\kappa}$, must be zero. If $\\mathbf{g}_{\\kappa} = 0$, then $\\Delta\\boldsymbol{\\kappa} = 0$ regardless of the non-singular matrix used to compute the step. The stationary point of the energy functional is therefore unchanged. This requirement is satisfied.\n\n3.  **Quadratic Convergence**: The Newton step uses a modified Hessian $\\mathbf{H}_{\\kappa\\kappa} + \\sigma \\mathbf{I}$. For quadratic convergence, the Hessian used in the step calculation must converge to the true Hessian of the function being optimized, $\\mathbf{H}_{\\kappa\\kappa}$, as the solution is approached. Since $\\sigma$ is a fixed positive constant, the term $\\sigma \\mathbf{I}$ does not vanish at the solution. The step is not a true Newton step, but rather a Levenberg–Marquardt type step. Such methods exhibit linear, not quadratic, convergence. This requirement is not satisfied.\n\n**Verdict for B**: **Incorrect**.\n\n**Analysis of Proposal C**\n\nThis proposal replaces the energy-based CI root selection with a maximum-overlap method (MOM). The CI eigenvector $\\mathbf{c}^{(k)}$ for the current iteration $k$ is chosen to maximize the overlap $|\\langle \\mathbf{c}^{(k)}|\\mathbf{c}^{\\mathrm{ref}}\\rangle|$ with a reference vector $\\mathbf{c}^{\\mathrm{ref}}$ from the previous iteration. The objective function and Newton step calculation for the selected state remain unchanged.\n\n1.  **State Tracking**: This is the very definition of a state-tracking algorithm. By explicitly selecting the CI vector based on its similarity to the previous iteration's vector, the method is designed to follow a state of a consistent electronic character, thus preventing root flipping. This requirement is satisfied.\n\n2.  **Correct Stationary Point**: The method seeks to find a point where the MCSCF gradient for the tracked state, say state $j$, is zero. That is, $\\mathbf{g}_{\\kappa,j} = 0$. This is the definition of a state-specific stationary point for state $j$. The MOM procedure is a prescription for identifying which state is $j$ at each iteration. It does not alter the conditions that define the stationary point itself. This requirement is satisfied.\n\n3.  **Quadratic Convergence**: Near the solution, it is expected that the desired root is well-defined and consistently selected by MOM at each iteration. In this regime, the algorithm is equivalent to a standard second-order MCSCF optimization for a single, fixed state. The Newton step is performed with the correct gradient and Hessian for that state's energy surface. The standard analysis for Newton's method applies, which predicts local quadratic convergence. While the global convergence may be complicated by discontinuities when the state choice switches, the local convergence property is preserved. This requirement is satisfied.\n\n**Verdict for C**: **Correct**.\n\n**Analysis of Proposal D**\n\nThis proposal replaces the state-specific optimization with a state-averaged (SA-MCSCF) one, using an equally weighted average of the two near-degenerate roots. The final energy is obtained from a CI calculation in the converged SA-MCSCF orbitals.\n\n1.  **State Tracking**: The method avoids the choice between the two roots by optimizing a set of compromise orbitals for both simultaneously. In this sense, it provides a stable optimization procedure in the presence of near-degeneracy and avoids the root-flipping problem. This requirement is satisfied.\n\n2.  **Correct Stationary Point**: The orbitals are optimized to make the average energy $E_{\\mathrm{avg}} = \\frac{1}{2}(E_1 + E_2)$ stationary. The resulting orbitals are, in general, different from the orbitals that would make the energy of the target state, say $E_1$, stationary. The problem explicitly demands preservation of the *exact state-specific stationary point*. An SA-MCSCF calculation converges to a state-averaged stationary point, which is fundamentally different. This requirement is not satisfied.\n\n3.  **Quadratic Convergence**: It is possible to formulate an SA-MCSCF optimization that exhibits quadratic convergence by constructing the appropriate Newton step for the state-averaged energy functional. So, this condition could be met in principle. However, the failure to meet the second, more critical, requirement makes this point moot.\n\n**Verdict for D**: **Incorrect**.\n\n**Analysis of Proposal E**\n\nThis proposal adds a directed level-shift to the orbital Hessian, $\\mathbf{H}^{\\mathrm{mod}}_{\\kappa\\kappa}=\\mathbf{H}_{\\kappa\\kappa}+\\sigma_k \\mathbf{P}$. The projector $\\mathbf{P}$ targets orbital rotation directions that couple the target state with its rival. The shift magnitude $\\sigma_k$ goes to $0$ as the state tracking improves (i.e., as the overlap $|\\langle \\mathbf{c}^{(k)}|\\mathbf{c}^{\\mathrm{ref}}\\rangle|\\to 1$).\n\n1.  **State Tracking**: By adding a large positive term to the Hessian in directions corresponding to the problematic state-mixing orbital rotations, the Newton step is penalized for moving in these directions. This suppresses the orbital changes that lead to root flipping and stabilizes the tracking of the desired state. This is a sophisticated way to achieve what simple level-shifting fails to do in a targeted manner. This requirement is satisfied.\n\n2.  **Correct Stationary Point**: As in proposal B, the modification is only to the Hessian used to compute the orbital step. The gradient $\\mathbf{g}_{\\kappa}$ is not modified. The stationary condition remains $\\mathbf{g}_{\\kappa}=0$. The location of the stationary point is unaffected. This requirement is satisfied.\n\n3.  **Quadratic Convergence**: The Hessian modification is $\\sigma_k \\mathbf{P}$. The condition is that $\\sigma_k \\to 0$ as convergence is approached. This means the modified Hessian $\\mathbf{H}^{\\mathrm{mod}}_{\\kappa\\kappa}$ converges to the true Hessian $\\mathbf{H}_{\\kappa\\kappa}$ at the solution. This is precisely the condition needed to recover local quadratic convergence. The modification helps with stability far from the solution but vanishes where it would harm the convergence rate. This requirement is satisfied.\n\n**Verdict for E**: **Correct**.\n\nIn summary, proposals A, C, and E all satisfy the three stated requirements for a robust state-specific MCSCF optimization near an avoided crossing. Proposals B and D fail on at least one critical requirement.", "answer": "$$\\boxed{ACE}$$", "id": "2654005"}]}