{"hands_on_practices": [{"introduction": "To grasp the fundamental reason for the charge-transfer (CT) failure in Time-Dependent Density Functional Theory (TD-DFT), we will dissect an exactly solvable model. The asymmetric Hubbard dimer serves as a minimalist representation of a donor-acceptor system, allowing for a direct comparison between the exact many-body solution and the predictions of approximate DFT [@problem_id:2878994]. This exercise reveals the core of the problem: the inability of local-density approximations to capture the steep, non-local potential energy change associated with separating an electron and a hole over a large distance.", "problem": "Consider the asymmetric two-site Hubbard dimer with two electrons, defined by the Hamiltonian\n$$\n\\hat{H} \\;=\\; -t \\sum_{\\sigma}\\left(\\hat{c}_{1\\sigma}^{\\dagger}\\hat{c}_{2\\sigma} + \\hat{c}_{2\\sigma}^{\\dagger}\\hat{c}_{1\\sigma}\\right) \\;+\\; U \\sum_{i=1}^{2} \\hat{n}_{i\\uparrow}\\hat{n}_{i\\downarrow} \\;+\\; \\frac{\\Delta}{2}\\,(\\hat{n}_{1}-\\hat{n}_{2}),\n$$\nwhere $t>0$ is the intersite hopping, $U>0$ is the on-site interaction, $\\Delta>0$ is the site-energy asymmetry with on-site energies $\\varepsilon_{1}=+\\Delta/2$ and $\\varepsilon_{2}=-\\Delta/2$, $\\hat{c}_{i\\sigma}^{\\dagger}$ creates an electron of spin $\\sigma$ on site $i$, and $\\hat{n}_{i\\sigma}=\\hat{c}_{i\\sigma}^{\\dagger}\\hat{c}_{i\\sigma}$, $\\hat{n}_{i}=\\hat{n}_{i\\uparrow}+\\hat{n}_{i\\downarrow}$. Work in the strict limit $t \\to 0^{+}$ with $0<\\Delta<U$, and restrict attention to singlet states.\n\nA charge-transfer excitation is defined here as the lowest singlet excited state that changes the site occupations by one electron relative to the ground state (i.e., transfers one electron between sites).\n\nUsing first-principles many-body reasoning and linear-response Time-Dependent Density Functional Theory (TDDFT) with the Adiabatic Local Density Approximation (ALDA), determine the asymptotic error\n$$\n\\delta \\;=\\; \\omega_{\\text{exact}} \\;-\\; \\omega_{\\text{ALDA}}\n$$\nin the $t \\to 0^{+}$ limit under the stated parameter regime, where $\\omega_{\\text{exact}}$ is the exact many-body charge-transfer excitation energy and $\\omega_{\\text{ALDA}}$ is the excitation energy predicted by adiabatic local TDDFT for the exact Kohn–Sham reference reproducing the interacting ground-state density.\n\nExpress your final answer as a single simplified analytical expression in terms of $U$ and $\\Delta$, with no numerical evaluation and no units.", "solution": "We begin by characterizing the many-body spectrum in the strict $t \\to 0^{+}$ limit. In this limit, the Hamiltonian $\\hat{H}$ is diagonal in the site-occupation basis, because the hopping term vanishes. For two electrons, the relevant number-state configurations and their interaction-independent on-site energies are:\n- Doubly occupied lower-energy site (site $2$): $|0,2\\rangle$ with energy\n$$\nE(0,2) \\;=\\; 2\\varepsilon_{2} + U \\;=\\; 2\\left(-\\frac{\\Delta}{2}\\right) + U \\;=\\; -\\Delta + U.\n$$\n- One electron on each site (singlet sector): $|1,1\\rangle_{S}$ with energy\n$$\nE(1,1) \\;=\\; \\varepsilon_{1} + \\varepsilon_{2} \\;=\\; \\frac{\\Delta}{2} + \\left(-\\frac{\\Delta}{2}\\right) \\;=\\; 0.\n$$\n- Doubly occupied higher-energy site (site $1$): $|2,0\\rangle$ with energy\n$$\nE(2,0) \\;=\\; 2\\varepsilon_{1} + U \\;=\\; 2\\left(+\\frac{\\Delta}{2}\\right) + U \\;=\\; +\\Delta + U.\n$$\n\nGiven $0 < \\Delta < U$, the ordering of these energies is\n$$\nE(0,2) \\;=\\; -\\Delta + U \\;>\\; 0 \\quad \\text{and} \\quad E(2,0) \\;=\\; \\Delta + U \\;>\\; 0,\n$$\nso the lowest energy state is the one with one electron on each site (to avoid on-site repulsion), i.e.,\n$$\nE_{\\text{g}} \\;=\\; E(1,1) \\;=\\; 0.\n$$\nThe lowest charge-transfer excited state corresponds to transferring one electron to the lower-energy site to form a double occupation on site $2$, i.e., $|0,2\\rangle$, since $E(0,2) < E(2,0)$ for $\\Delta>0$. Therefore, the exact many-body charge-transfer excitation energy is\n$$\n\\omega_{\\text{exact}} \\;=\\; E(0,2) - E_{\\text{g}} \\;=\\; (-\\Delta + U) - 0 \\;=\\; U - \\Delta.\n$$\n\nNext, we analyze the prediction of linear-response Time-Dependent Density Functional Theory (TDDFT) within the Adiabatic Local Density Approximation (ALDA) for the exact Kohn–Sham (KS) reference that reproduces the interacting ground-state density. In the $t \\to 0^{+}$ limit under $0<\\Delta<U$, the interacting ground state has one electron on each site, i.e., the ground-state density satisfies\n$$\n\\langle \\hat{n}_{1} \\rangle \\;=\\; 1, \\qquad \\langle \\hat{n}_{2} \\rangle \\;=\\; 1.\n$$\nTo reproduce this density in a non-interacting KS system at $t \\to 0^{+}$, the KS site potentials must be such that the two one-body site orbitals are degenerate, because any nonzero KS asymmetry would lead both non-interacting electrons to doubly occupy the lower KS site. Thus, the exact KS potential difference must vanish,\n$$\n\\Delta_{s} \\;=\\; 0,\n$$\nin the $t \\to 0^{+}$ limit, yielding a KS HOMO–LUMO gap (i.e., the KS single-particle transition energy)\n$$\n\\omega_{s} \\;=\\; 0.\n$$\n\nIn linear-response TDDFT for a single dominant transition (the two-level or single-pole approximation, which is exact here in the $t \\to 0^{+}$ limit due to vanishing hybridization), the interacting excitation energy $\\omega$ satisfies the Casida-like scalar equation\n$$\n\\omega^{2} \\;=\\; \\omega_{s}^{2} + 4\\,\\omega_{s}\\,K_{\\text{Hxc}},\n$$\nwhere $K_{\\text{Hxc}}$ denotes the Hartree–exchange–correlation kernel matrix element coupling the occupied-to-virtual KS transition with itself. In the Adiabatic Local Density Approximation (ALDA), $K_{\\text{Hxc}}$ is frequency independent and finite, but because $\\omega_{s}=0$ exactly in this limit, the equation reduces to\n$$\n\\omega^{2} \\;=\\; 0,\n$$\nso the ALDA-predicted excitation energy is\n$$\n\\omega_{\\text{ALDA}} \\;=\\; 0.\n$$\nAn equivalent viewpoint is that, in the $t \\to 0^{+}$ limit, the occupied and virtual KS orbitals are strictly localized on different sites, so the transition density overlap vanishes, causing the linear-response kernel coupling to be ineffective at opening a finite gap within any adiabatic approximation.\n\nTherefore, the asymptotic TDDFT error for this charge-transfer excitation is\n$$\n\\delta \\;=\\; \\omega_{\\text{exact}} - \\omega_{\\text{ALDA}} \\;=\\; (U - \\Delta) - 0 \\;=\\; U - \\Delta.\n$$\n\nThis completes the derivation from the many-body spectrum and linear-response TDDFT in the specified asymptotic regime.", "answer": "$$\\boxed{U-\\Delta}$$", "id": "2878994"}, {"introduction": "Having established the theoretical origin of the CT problem, a crucial practical skill is to diagnose the character of an electronic excitation from a quantum chemical calculation. This hands-on coding exercise provides a powerful approach to do just that by analyzing the excitation-induced change in electron density, $\\Delta \\rho(\\mathbf{r})$ [@problem_id:2878978]. By implementing metrics to quantify charge-transfer and Rydberg character, you will build a practical diagnostic tool for identifying excitations where standard TD-DFT approximations are likely to fail.", "problem": "You will model and quantify charge-transfer and Rydberg character in single-electron excitations using one-dimensional, normalized electron densities as a proxy for occupied and virtual orbital probability densities. The aim is to formalize fragment partitioning of the excitation-induced density change and to compute two dimensionless metrics that are used to flag scenarios known to cause failures in Time-Dependent Density Functional Theory (TD-DFT): long-range charge transfer and diffuse (Rydberg-like) character.\n\nStart from the following fundamental bases:\n\n- The electron density for a single electron in one dimension is a nonnegative function $\\rho(x)$ that integrates to $1$ electron:\n$$\\int_{-\\infty}^{+\\infty} \\rho(x)\\, dx = 1.$$\n- A single-electron excitation from an occupied state with density $\\rho_i(x)$ to a virtual state with density $\\rho_a(x)$ preserves electron number, and the excitation-induced difference density is defined by\n$$\\Delta \\rho(x) = \\rho_a(x) - \\rho_i(x), \\quad \\text{with} \\quad \\int_{-\\infty}^{+\\infty} \\Delta \\rho(x)\\, dx = 0.$$\n- Partition the real line into donor and acceptor fragments by the sign of $x$:\n$$D = \\{ x \\in \\mathbb{R} \\, | \\, x < 0 \\}, \\quad A = \\{ x \\in \\mathbb{R} \\, | \\, x > 0 \\}.$$\n- For any real number $y$, define the positive part $[y]_+ = \\max(y, 0)$.\n\nDefine the following quantitative metrics:\n\n- The charge-transfer amount (in electrons) from donor to acceptor is\n$$Q_A^+ = \\int_A [\\Delta \\rho(x)]_+ \\, dx, \\qquad Q_D^- = \\int_D [-\\Delta \\rho(x)]_+ \\, dx,$$\nand the charge-transfer metric is\n$$f_{\\mathrm{CT}} = \\min\\left(Q_A^+,\\, Q_D^-\\right).$$\nFor an ideal, pure donor-to-acceptor charge transfer, $f_{\\mathrm{CT}}$ approaches $1$ electron; for a local excitation on one fragment, $f_{\\mathrm{CT}}$ is near $0$.\n- The Rydbergness (diffuseness) is determined from the fraction of added-electron density appearing in the asymptotic region\n$$R = \\{ x \\in \\mathbb{R} \\, | \\, |x| \\ge R_c \\},$$\nas\n$$f_{\\mathrm{Ry}} = \\frac{\\int_R [\\Delta \\rho(x)]_+ \\, dx}{\\int_{-\\infty}^{+\\infty} [\\Delta \\rho(x)]_+ \\, dx}.$$\nLarge $f_{\\mathrm{Ry}}$ indicates that the added-electron density is significantly diffuse, as in Rydberg excitations.\n\nIn this problem, approximate the occupied and virtual orbital probability densities by normalized Gaussian densities (normal distributions):\n$$\\rho(x; \\mu, \\sigma) = \\frac{1}{\\sigma \\sqrt{2\\pi}} \\exp\\!\\left( -\\frac{(x-\\mu)^2}{2\\sigma^2} \\right),$$\nwith mean position $\\mu$ (in bohr) and standard deviation $\\sigma$ (in bohr). For a single excitation, set $\\rho_i(x) = \\rho(x; \\mu_i, \\sigma_i)$ and $\\rho_a(x) = \\rho(x; \\mu_a, \\sigma_a)$.\n\nNumerical instructions:\n\n- Use a uniform grid on $x \\in [x_{\\min}, x_{\\max}]$ with spacing $\\Delta x$, and approximate integrals by Riemann sums,\n$$\\int g(x)\\, dx \\approx \\sum_k g(x_k) \\, \\Delta x.$$\n- Use the donor region $D = \\{ x < 0 \\}$ and acceptor region $A = \\{ x > 0 \\}$, and an asymptotic cutoff $R_c$ (all distances in bohr, denoted $a_0$).\n- All outputs are dimensionless and must be reported as decimal numbers rounded to six decimal places.\n\nTest suite:\n\nFor all test cases, use $x_{\\min} = -50\\, a_0$, $x_{\\max} = +50\\, a_0$, $\\Delta x = 0.01\\, a_0$, and $R_c = 4.0\\, a_0$. Each test case specifies $(\\mu_i, \\sigma_i, \\mu_a, \\sigma_a)$ in bohr:\n\n- Case $1$ (local excitation on donor): $(\\mu_i, \\sigma_i, \\mu_a, \\sigma_a) = (-3.0, 0.5, -2.5, 0.6)$.\n- Case $2$ (long-range charge transfer): $(\\mu_i, \\sigma_i, \\mu_a, \\sigma_a) = (-3.0, 0.5, +3.0, 0.5)$.\n- Case $3$ (Rydberg-like on donor): $(\\mu_i, \\sigma_i, \\mu_a, \\sigma_a) = (-2.0, 0.6, -2.0, 3.0)$.\n- Case $4$ (mixed charge transfer and Rydberg): $(\\mu_i, \\sigma_i, \\mu_a, \\sigma_a) = (-2.5, 0.7, +2.0, 2.5)$.\n\nTask:\n\n- Write a complete program that constructs $\\rho_i(x)$ and $\\rho_a(x)$ for each test case on the specified grid, forms $\\Delta \\rho(x)$, and computes $f_{\\mathrm{CT}}$ and $f_{\\mathrm{Ry}}$ as defined above.\n- If the denominator in $f_{\\mathrm{Ry}}$ is numerically zero (below $10^{-12}$), set $f_{\\mathrm{Ry}} = 0$.\n- Round each metric to six decimal places.\n\nFinal output format:\n\nYour program should produce a single line of output containing a comma-separated, bracket-enclosed list of the results in the order\n$$[f_{\\mathrm{CT}}^{(1)}, f_{\\mathrm{Ry}}^{(1)}, f_{\\mathrm{CT}}^{(2)}, f_{\\mathrm{Ry}}^{(2)}, f_{\\mathrm{CT}}^{(3)}, f_{\\mathrm{Ry}}^{(3)}, f_{\\mathrm{CT}}^{(4)}, f_{\\mathrm{Ry}}^{(4)}],$$\nwhere the superscript indicates the test case index. For example, the output must look like\n$$[0.123456,0.654321,0.111111,0.222222,0.333333,0.444444,0.555555,0.666666],$$\nwith exactly eight decimal numbers rounded to six digits after the decimal point.", "solution": "The problem requires the computation of two metrics, a charge-transfer metric $f_{\\mathrm{CT}}$ and a Rydbergness metric $f_{\\mathrm{Ry}}$, for single-electron excitations in a one-dimensional model system. The problem is scientifically valid, well-posed, and provides all necessary information for a unique numerical solution. The model, although simplified, correctly captures the essential features of charge-transfer and Rydberg excitations, which are known problematic cases for standard approximations in Time-Dependent Density Functional Theory. We will proceed with a direct numerical implementation based on the provided definitions.\n\nThe foundation of this problem is the concept of a single-electron density $\\rho(x)$, a non-negative function normalized to $1$ electron:\n$$\n\\int_{-\\infty}^{+\\infty} \\rho(x)\\, dx = 1.\n$$\nAn excitation is modeled as a transition from an initial (occupied) state with density $\\rho_i(x)$ to a final (virtual) state with density $\\rho_a(x)$. The change in electron density is described by the difference density, $\\Delta \\rho(x)$:\n$$\n\\Delta \\rho(x) = \\rho_a(x) - \\rho_i(x).\n$$\nDue to the normalization of $\\rho_i(x)$ and $\\rho_a(x)$, the integral of $\\Delta \\rho(x)$ over all space is zero, signifying conservation of the total number of electrons.\n\nThe analysis of the excitation character is performed by partitioning the system and integrating portions of $\\Delta \\rho(x)$. The real line is divided into a donor fragment $D = \\{ x \\in \\mathbb{R} \\, | \\, x < 0 \\}$ and an acceptor fragment $A = \\{ x \\in \\mathbb{R} \\, | \\, x > 0 \\}$.\n\nThe densities for the occupied and virtual states are modeled by normalized Gaussian functions:\n$$\n\\rho(x; \\mu, \\sigma) = \\frac{1}{\\sigma \\sqrt{2\\pi}} \\exp\\!\\left( -\\frac{(x-\\mu)^2}{2\\sigma^2} \\right),\n$$\nwhere $\\mu$ is the mean position and $\\sigma$ is the standard deviation. Thus, $\\rho_i(x) = \\rho(x; \\mu_i, \\sigma_i)$ and $\\rho_a(x) = \\rho(x; \\mu_a, \\sigma_a)$.\n\nThe numerical solution will be constructed on a discrete spatial grid. The domain is specified as $x \\in [-50, 50]\\,a_0$, with a grid spacing of $\\Delta x = 0.01\\,a_0$. This defines a set of discrete points $x_k = x_{\\min} + k \\Delta x$. Integrals are approximated as Riemann sums, e.g., $\\int g(x) dx \\approx \\sum_k g(x_k) \\Delta x$.\n\nFirst, we compute the charge-transfer metric, $f_{\\mathrm{CT}}$. This metric quantifies the amount of charge that moves between the donor and acceptor fragments. We define the positive part of a real number $y$ as $[y]_+ = \\max(y, 0)$. The amount of charge gained by the acceptor is the integral of the positive part of $\\Delta \\rho(x)$ over the acceptor region $A$:\n$$\nQ_A^+ = \\int_A [\\Delta \\rho(x)]_+ \\, dx \\approx \\sum_{x_k > 0} [\\Delta \\rho(x_k)]_+ \\Delta x.\n$$\nSimilarly, the amount of charge lost by the donor is the integral of the positive part of $-\\Delta \\rho(x)$ over the donor region $D$:\n$$\nQ_D^- = \\int_D [-\\Delta \\rho(x)]_+ \\, dx \\approx \\sum_{x_k < 0} [-\\Delta \\rho(x_k)]_+ \\Delta x.\n$$\nThe charge-transfer metric is then defined as the lesser of these two quantities:\n$$\nf_{\\mathrm{CT}} = \\min(Q_A^+, Q_D^-).\n$$\nFor a pure charge-transfer excitation from a donor fully contained in $D$ to an acceptor fully in $A$, both $Q_A^+$ and $Q_D^-$ would approach $1$, and thus $f_{\\mathrm{CT}}$ would approach $1$. For a local excitation within a single fragment, one of these quantities will be near zero, making $f_{\\mathrm{CT}}$ close to $0$.\n\nSecond, we compute the Rydbergness metric, $f_{\\mathrm{Ry}}$. This metric measures the diffuseness of the excitation by quantifying the fraction of the added electron density, $[\\Delta \\rho(x)]_+$, that lies in the asymptotic region $R = \\{ x \\in \\mathbb{R} \\, | \\, |x| \\ge R_c \\}$. The cutoff is given as $R_c = 4.0\\,a_0$. The metric is defined as the ratio:\n$$\nf_{\\mathrm{Ry}} = \\frac{\\int_R [\\Delta \\rho(x)]_+ \\, dx}{\\int_{-\\infty}^{+\\infty} [\\Delta \\rho(x)]_+ \\, dx}.\n$$\nThe total added charge, which is the denominator, must be equal to $1$ for a single-electron excitation.\nNumerically, this is computed as:\n$$\n\\text{Numerator} = \\sum_{|x_k| \\ge R_c} [\\Delta \\rho(x_k)]_+ \\Delta x.\n$$\n$$\n\\text{Denominator} = \\sum_{\\text{all } k} [\\Delta \\rho(x_k)]_+ \\Delta x.\n$$\nIf the denominator is smaller than a numerical threshold of $10^{-12}$, $f_{\\mathrm{Ry}}$ is set to $0$. A large value of $f_{\\mathrm{Ry}}$ indicates that the virtual orbital is diffuse, characteristic of a Rydberg state.\n\nThe algorithm proceeds by iterating through each of the four test cases provided:\n1.  Case $1$: $(\\mu_i, \\sigma_i, \\mu_a, \\sigma_a) = (-3.0, 0.5, -2.5, 0.6)$\n2.  Case $2$: $(\\mu_i, \\sigma_i, \\mu_a, \\sigma_a) = (-3.0, 0.5, +3.0, 0.5)$\n3.  Case $3$: $(\\mu_i, \\sigma_i, \\mu_a, \\sigma_a) = (-2.0, 0.6, -2.0, 3.0)$\n4.  Case $4$: $(\\mu_i, \\sigma_i, \\mu_a, \\sigma_a) = (-2.5, 0.7, +2.0, 2.5)$\n\nFor each case, we construct the densities $\\rho_i(x)$ and $\\rho_a(x)$ on the grid, calculate $\\Delta \\rho(x)$, and then apply the summation formulas to compute $f_{\\mathrm{CT}}$ and $f_{\\mathrm{Ry}}$. The final results are rounded to six decimal places as required.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes charge-transfer (f_CT) and Rydbergness (f_Ry) metrics\n    for four test cases of a 1D single-electron excitation model.\n    \"\"\"\n    # Define the global numerical parameters.\n    # All units are in bohr (a_0) or are dimensionless.\n    x_min = -50.0\n    x_max = 50.0\n    dx = 0.01\n    R_c = 4.0\n    \n    # Generate the uniform spatial grid.\n    num_points = int((x_max - x_min) / dx) + 1\n    x = np.linspace(x_min, x_max, num_points)\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (mu_i, sigma_i, mu_a, sigma_a)\n    test_cases = [\n        (-3.0, 0.5, -2.5, 0.6),  # Case 1: local excitation on donor\n        (-3.0, 0.5, 3.0, 0.5),   # Case 2: long-range charge transfer\n        (-2.0, 0.6, -2.0, 3.0),  # Case 3: Rydberg-like on donor\n        (-2.5, 0.7, 2.0, 2.5),   # Case 4: mixed charge transfer and Rydberg\n    ]\n\n    results = []\n\n    def gaussian_density(x, mu, sigma):\n        \"\"\"\n        Calculates the normalized Gaussian density rho(x; mu, sigma).\n        \"\"\"\n        return (1.0 / (sigma * np.sqrt(2.0 * np.pi))) * \\\n               np.exp(-((x - mu)**2) / (2.0 * sigma**2))\n\n    for case in test_cases:\n        mu_i, sigma_i, mu_a, sigma_a = case\n\n        # 1. Construct densities and difference density\n        rho_i = gaussian_density(x, mu_i, sigma_i)\n        rho_a = gaussian_density(x, mu_a, sigma_a)\n        delta_rho = rho_a - rho_i\n\n        # 2. Calculate the charge-transfer metric f_CT\n        \n        # Positive part of delta_rho for acceptor region gain\n        pos_delta_rho = np.maximum(0, delta_rho)\n        # Positive part of -delta_rho for donor region loss\n        neg_delta_rho = np.maximum(0, -delta_rho)\n\n        # Create masks for donor (x < 0) and acceptor (x > 0) regions\n        donor_mask = x < 0\n        acceptor_mask = x > 0\n\n        # Integrate over the respective regions using Riemann sum\n        Q_A_plus = np.sum(pos_delta_rho[acceptor_mask]) * dx\n        Q_D_minus = np.sum(neg_delta_rho[donor_mask]) * dx\n        \n        f_ct = min(Q_A_plus, Q_D_minus)\n\n        # 3. Calculate the Rydbergness metric f_Ry\n        \n        # Create mask for the asymptotic region R = {x | |x| >= R_c}\n        asymptotic_mask = np.abs(x) >= R_c\n        \n        # Numerator: integral of added density in the asymptotic region\n        numerator = np.sum(pos_delta_rho[asymptotic_mask]) * dx\n        \n        # Denominator: integral of total added density over all space\n        denominator = np.sum(pos_delta_rho) * dx\n        \n        # Calculate f_Ry with the zero-denominator check\n        if denominator < 1e-12:\n            f_ry = 0.0\n        else:\n            f_ry = numerator / denominator\n\n        # Append results for the current case, formatting to 6 decimal places\n        results.append(f\"{f_ct:.6f}\")\n        results.append(f\"{f_ry:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "2878978"}, {"introduction": "This final practice unifies our understanding by modeling the performance of different functional classes on various types of excitations—local, charge-transfer, and Rydberg. Using a parametric model, we will see why standard semi-local functionals qualitatively fail for CT and Rydberg states, while correctly describing local excitations [@problem_id:2878999]. Furthermore, this exercise demonstrates how modern range-separated functionals provide a systematic correction and explores the significant consequences of these errors on derived excited-state properties.", "problem": "Consider vertical excited-state ionization potentials and electron affinities within the linear-response framework of Time-Dependent Density Functional Theory (TD-DFT) and its known limitations for charge-transfer and Rydberg excitations. Let the ground-state energy of an $N$-electron system be $E_{0}(N)$, its first excited state energy be $E_{1}(N) = E_{0}(N) + \\Omega$, the ground-state energy of the $N-1$ electron system be $E_{0}(N-1)$, and the ground-state energy of the $N+1$ electron system be $E_{0}(N+1)$. Define the ground-state ionization potential $I_{g}$ and electron affinity $A_{g}$ by\n$$\nI_{g} = E_{0}(N-1) - E_{0}(N), \\quad A_{g} = E_{0}(N) - E_{0}(N+1).\n$$\nFor a vertical excitation of energy $\\Omega$, the exact excited-state ionization potential $I^{\\ast}$ and excited-state electron affinity $A^{\\ast}$ are given by the identities\n$$\nI^{\\ast} = E_{0}(N-1) - E_{1}(N) = I_{g} - \\Omega, \\quad A^{\\ast} = E_{1}(N) - E_{0}(N+1) = A_{g} + \\Omega.\n$$\nTo model the known failures of adiabatic semi-local TD-DFT for charge-transfer and Rydberg states, consider the following excitation-energy models. All energies must be expressed in electronvolts (eV) and all distances in ångström (Å). Use the Coulomb conversion factor $C = e^{2}/(4\\pi\\varepsilon_{0}) = 14.3996\\,\\text{eV}\\cdot\\text{\\AA}$.\n\nDefine two approximate model families $f \\in \\{\\text{S}, \\text{R}\\}$ representing a typical semi-local functional (S) and a tuned range-separated hybrid (R), respectively, via four parameters\n$$\n\\delta I_{f} \\ge 0, \\quad \\delta A_{f} \\ge 0, \\quad \\Delta_{\\text{gap},f} \\ge 0, \\quad \\lambda_{f} \\in [0,1],\n$$\nwhich emulate, respectively, the systematic underestimation of the ground-state ionization potential and electron affinity, the missing derivative-discontinuity correction to the fundamental gap, and the recovery of the long-range $-1/r$ electron–hole interaction in the excitation kernel. The approximate ground-state properties are modeled as\n$$\nI_{g}^{(f)} = I_{g} - \\delta I_{f}, \\quad A_{g}^{(f)} = A_{g} - \\delta A_{f}.\n$$\nFor a given excitation class with required inputs, the exact excitation energy $\\Omega_{\\text{true}}$ and the approximate excitation energy $\\Omega_{f}$ are defined as follows.\n\n- Local valence excitation (LE) with orbital-overlap factor $S \\in [0,1]$ and an overlap-scaled binding parameter $\\beta > 0$:\n$$\n\\Omega_{\\text{true}}^{\\text{LE}} = (I_{g} - A_{g}) - \\beta S, \\quad \\Omega_{f}^{\\text{LE}} = \\Omega_{\\text{true}}^{\\text{LE}}.\n$$\n\n- Long-range charge-transfer excitation (CT) between a donor with ionization potential $I_{D}$ and acceptor with electron affinity $A_{A}$ separated by distance $R$:\n$$\n\\Omega_{\\text{true}}^{\\text{CT}} = (I_{D} - A_{A}) - \\frac{C}{R}, \\quad \\Omega_{f}^{\\text{CT}} = (I_{D} - A_{A}) - \\Delta_{\\text{gap},f} - \\lambda_{f}\\frac{C}{R}.\n$$\n\n- Rydberg excitation (RY) with principal quantum number $n \\in \\mathbb{N}$ and hydrogenic binding parameter $\\chi > 0$:\n$\n\\Omega_{\\text{true}}^{\\text{RY}} = I_{g} - \\chi/n^{2}, \\quad \\Omega_{f}^{\\text{RY}} = (I_{g} - \\delta I_{f}) - \\lambda_{f}^{2}\\chi/n^{2}.\n$\n\nFor each case, define the excited-state ionization potential and electron affinity for model $f$ by\n$$\nI_{f}^{\\ast} = I_{g}^{(f)} - \\Omega_{f}, \\quad A_{f}^{\\ast} = A_{g}^{(f)} + \\Omega_{f}.\n$$\nThe exact values are recovered by taking $f$ to be the exact model with $\\delta I_{f} = 0$, $\\delta A_{f} = 0$, $\\Delta_{\\text{gap},f} = 0$, and $\\lambda_{f} = 1$.\n\nUse the following fixed model parameters for the two approximate families:\n- Semi-local (S): $\\delta I_{\\text{S}} = 1.50\\,\\text{eV}$, $\\delta A_{\\text{S}} = 1.00\\,\\text{eV}$, $\\Delta_{\\text{gap},\\text{S}} = 2.20\\,\\text{eV}$, $\\lambda_{\\text{S}} = 0$.\n- Range-separated (R): $\\delta I_{\\text{R}} = 0.10\\,\\text{eV}$, $\\delta A_{\\text{R}} = 0.05\\,\\text{eV}$, $\\Delta_{\\text{gap},\\text{R}} = 0.10\\,\\text{eV}$, $\\lambda_{\\text{R}} = 1$.\n\nTest suite. Compute the quantities for the following three test cases:\n\nCase LE:\n- $I_{g} = 9.50\\,\\text{eV}$, $A_{g} = 1.20\\,\\text{eV}$, $S = 0.85$, $\\beta = 1.50\\,\\text{eV}$.\n\nCase CT:\n- $I_{D} = 7.80\\,\\text{eV}$, $A_{A} = 1.10\\,\\text{eV}$, $R = 12.00\\,\\text{\\AA}$; identify $I_{g} = I_{D}$ and $A_{g} = A_{A}$ for the supermolecular limit.\n\nCase RY:\n- $I_{g} = 13.60\\,\\text{eV}$, $A_{g} = 0.00\\,\\text{eV}$, $\\chi = 13.60\\,\\text{eV}$, $n = 4$.\n\nFor each case, you must compute six numbers:\n$\n\\big(I_{\\text{exact}}^{\\ast},\\, A_{\\text{exact}}^{\\ast},\\, I_{\\text{S}}^{\\ast},\\, A_{\\text{S}}^{\\ast},\\, I_{\\text{R}}^{\\ast},\\, A_{\\text{R}}^{\\ast}\\big).\n$\nReport all energies in $\\text{eV}$, each rounded to three decimal places.\n\nFinal output format. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, concatenating the six-number outputs for the three cases in the order LE, CT, RY. For example, the line should look like\n\"[x1,x2,x3,x4,x5,x6,y1,y2,y3,y4,y5,y6,z1,z2,z3,z4,z5,z6]\"\nwith each entry being a decimal number rounded to three decimal places in $\\text{eV}$.", "solution": "The problem statement has been validated and is deemed scientifically sound, well-posed, and self-contained. It presents a simplified but conceptually correct model of known failures in Time-Dependent Density Functional Theory (TD-DFT) and asks for specific calculations based on this model. We will proceed with the solution.\n\nThe core task is to compute excited-state ionization potentials ($I^{\\ast}$) and electron affinities ($A^{\\ast}$) for different types of electronic excitations under three different theoretical models: an exact reference, a semi-local functional model (S), and a range-separated hybrid model (R).\n\nThe fundamental relations given are:\nFor the exact case:\n$$ I_{\\text{exact}}^{\\ast} = I_{g} - \\Omega_{\\text{true}} $$\n$$ A_{\\text{exact}}^{\\ast} = A_{g} + \\Omega_{\\text{true}} $$\nFor an approximate functional model $f \\in \\{\\text{S}, \\text{R}\\}$:\n$$ I_{f}^{\\ast} = I_{g}^{(f)} - \\Omega_{f} $$\n$$ A_{f}^{\\ast} = A_{g}^{(f)} + \\Omega_{f} $$\nwhere the approximate ground-state properties are defined as $I_{g}^{(f)} = I_{g} - \\delta I_{f}$ and $A_{g}^{(f)} = A_{g} - \\delta A_{f}$. The true ($\\Omega_{\\text{true}}$) and approximate ($\\Omega_{f}$) excitation energies depend on the type of excitation.\n\nThe fixed parameters for the models and constants are:\n- Coulomb constant: $C = 14.3996\\,\\text{eV}\\cdot\\text{\\AA}$\n- Semi-local model (S): $\\delta I_{\\text{S}} = 1.50\\,\\text{eV}$, $\\delta A_{\\text{S}} = 1.00\\,\\text{eV}$, $\\Delta_{\\text{gap},\\text{S}} = 2.20\\,\\text{eV}$, $\\lambda_{\\text{S}} = 0$\n- Range-separated model (R): $\\delta I_{\\text{R}} = 0.10\\,\\text{eV}$, $\\delta A_{\\text{R}} = 0.05\\,\\text{eV}$, $\\Delta_{\\text{gap},\\text{R}} = 0.10\\,\\text{eV}$, $\\lambda_{\\text{R}} = 1$\n\nWe will analyze each test case systematically.\n\n**Case 1: Local Excitation (LE)**\nThe input parameters are $I_{g} = 9.50\\,\\text{eV}$, $A_{g} = 1.20\\,\\text{eV}$, $S = 0.85$, and $\\beta = 1.50\\,\\text{eV}$.\n\n1.  **Excitation Energy**: For an LE state, the model excitation energy is the same as the true one, $\\Omega_{f}^{\\text{LE}} = \\Omega_{\\text{true}}^{\\text{LE}}$.\n    $$ \\Omega_{\\text{true}}^{\\text{LE}} = (I_{g} - A_{g}) - \\beta S = (9.50 - 1.20)\\,\\text{eV} - (1.50\\,\\text{eV} \\cdot 0.85) = 8.30\\,\\text{eV} - 1.275\\,\\text{eV} = 7.025\\,\\text{eV} $$\n2.  **Exact Properties**:\n    $$ I_{\\text{exact}}^{\\ast} = I_{g} - \\Omega_{\\text{true}}^{\\text{LE}} = 9.50\\,\\text{eV} - 7.025\\,\\text{eV} = 2.475\\,\\text{eV} $$\n    $$ A_{\\text{exact}}^{\\ast} = A_{g} + \\Omega_{\\text{true}}^{\\text{LE}} = 1.20\\,\\text{eV} + 7.025\\,\\text{eV} = 8.225\\,\\text{eV} $$\n3.  **Model S Properties**: With $\\Omega_{\\text{S}}^{\\text{LE}} = 7.025\\,\\text{eV}$:\n    $$ I_{g}^{(\\text{S})} = 9.50 - 1.50 = 8.00\\,\\text{eV}; \\quad A_{g}^{(\\text{S})} = 1.20 - 1.00 = 0.20\\,\\text{eV} $$\n    $$ I_{\\text{S}}^{\\ast} = 8.00\\,\\text{eV} - 7.025\\,\\text{eV} = 0.975\\,\\text{eV} $$\n    $$ A_{\\text{S}}^{\\ast} = 0.20\\,\\text{eV} + 7.025\\,\\text{eV} = 7.225\\,\\text{eV} $$\n4.  **Model R Properties**: With $\\Omega_{\\text{R}}^{\\text{LE}} = 7.025\\,\\text{eV}$:\n    $$ I_{g}^{(\\text{R})} = 9.50 - 0.10 = 9.40\\,\\text{eV}; \\quad A_{g}^{(\\text{R})} = 1.20 - 0.05 = 1.15\\,\\text{eV} $$\n    $$ I_{\\text{R}}^{\\ast} = 9.40\\,\\text{eV} - 7.025\\,\\text{eV} = 2.375\\,\\text{eV} $$\n    $$ A_{\\text{R}}^{\\ast} = 1.15\\,\\text{eV} + 7.025\\,\\text{eV} = 8.175\\,\\text{eV} $$\n\n**Case 2: Charge-Transfer Excitation (CT)**\nParameters: $I_{D} = 7.80\\,\\text{eV}$, $A_{A} = 1.10\\,\\text{eV}$, $R = 12.00\\,\\text{\\AA}$. We use $I_{g} = I_{D}$ and $A_{g} = A_{A}$.\n\n1.  **Excitation Energies**:\n    $$ \\Omega_{\\text{true}}^{\\text{CT}} = (I_{D} - A_{A}) - \\frac{C}{R} = (7.80 - 1.10)\\,\\text{eV} - \\frac{14.3996}{12.00}\\,\\text{eV} = 6.70\\,\\text{eV} - 1.199966... \\,\\text{eV} \\approx 5.500033\\,\\text{eV} $$\n    $$ \\Omega_{\\text{S}}^{\\text{CT}} = (I_{D} - A_{A}) - \\Delta_{\\text{gap},\\text{S}} - \\lambda_{\\text{S}}\\frac{C}{R} = (6.70 - 2.20 - 0)\\,\\text{eV} = 4.50\\,\\text{eV} $$\n    $$ \\Omega_{\\text{R}}^{\\text{CT}} = (I_{D} - A_{A}) - \\Delta_{\\text{gap},\\text{R}} - \\lambda_{\\text{R}}\\frac{C}{R} = (6.70 - 0.10 - 1.199966...)\\,\\text{eV} \\approx 5.400033\\,\\text{eV} $$\n2.  **Exact Properties**:\n    $$ I_{\\text{exact}}^{\\ast} = 7.80\\,\\text{eV} - 5.500033...\\,\\text{eV} = 2.299966...\\,\\text{eV} $$\n    $$ A_{\\text{exact}}^{\\ast} = 1.10\\,\\text{eV} + 5.500033...\\,\\text{eV} = 6.600033...\\,\\text{eV} $$\n3.  **Model S Properties**:\n    $$ I_{g}^{(\\text{S})} = 7.80 - 1.50 = 6.30\\,\\text{eV}; \\quad A_{g}^{(\\text{S})} = 1.10 - 1.00 = 0.10\\,\\text{eV} $$\n    $$ I_{\\text{S}}^{\\ast} = 6.30\\,\\text{eV} - 4.50\\,\\text{eV} = 1.800\\,\\text{eV} $$\n    $$ A_{\\text{S}}^{\\ast} = 0.10\\,\\text{eV} + 4.50\\,\\text{eV} = 4.600\\,\\text{eV} $$\n4.  **Model R Properties**:\n    $$ I_{g}^{(\\text{R})} = 7.80 - 0.10 = 7.70\\,\\text{eV}; \\quad A_{g}^{(\\text{R})} = 1.10 - 0.05 = 1.05\\,\\text{eV} $$\n    $$ I_{\\text{R}}^{\\ast} = 7.70\\,\\text{eV} - 5.400033...\\,\\text{eV} = 2.299966...\\,\\text{eV} $$\n    $$ A_{\\text{R}}^{\\ast} = 1.05\\,\\text{eV} + 5.400033...\\,\\text{eV} = 6.450033...\\,\\text{eV} $$\n\n**Case 3: Rydberg Excitation (RY)**\nParameters: $I_{g} = 13.60\\,\\text{eV}$, $A_{g} = 0.00\\,\\text{eV}$, $\\chi = 13.60\\,\\text{eV}$, $n = 4$.\n\n1.  **Excitation Energies**:\n    $$ \\Omega_{\\text{true}}^{\\text{RY}} = I_{g} - \\frac{\\chi}{n^{2}} = 13.60\\,\\text{eV} - \\frac{13.60}{4^2}\\,\\text{eV} = 13.60\\,\\text{eV} - 0.85\\,\\text{eV} = 12.75\\,\\text{eV} $$\n    $$ \\Omega_{\\text{S}}^{\\text{RY}} = (I_{g} - \\delta I_{\\text{S}}) - \\lambda_{\\text{S}}^{2}\\frac{\\chi}{n^{2}} = (13.60 - 1.50)\\,\\text{eV} - 0 = 12.10\\,\\text{eV} $$\n    $$ \\Omega_{\\text{R}}^{\\text{RY}} = (I_{g} - \\delta I_{\\text{R}}) - \\lambda_{\\text{R}}^{2}\\frac{\\chi}{n^{2}} = (13.60 - 0.10)\\,\\text{eV} - 1^2\\frac{13.60}{16}\\,\\text{eV} = 13.50\\,\\text{eV} - 0.85\\,\\text{eV} = 12.65\\,\\text{eV} $$\n2.  **Exact Properties**:\n    $$ I_{\\text{exact}}^{\\ast} = 13.60\\,\\text{eV} - 12.75\\,\\text{eV} = 0.850\\,\\text{eV} $$\n    $$ A_{\\text{exact}}^{\\ast} = 0.00\\,\\text{eV} + 12.75\\,\\text{eV} = 12.750\\,\\text{eV} $$\n3.  **Model S Properties**:\n    $$ I_{g}^{(\\text{S})} = 12.10\\,\\text{eV}; \\quad A_{g}^{(\\text{S})} = 0.00 - 1.00 = -1.00\\,\\text{eV} $$\n    $$ I_{\\text{S}}^{\\ast} = 12.10\\,\\text{eV} - 12.10\\,\\text{eV} = 0.000\\,\\text{eV} $$\n    $$ A_{\\text{S}}^{\\ast} = -1.00\\,\\text{eV} + 12.10\\,\\text{eV} = 11.100\\,\\text{eV} $$\n4.  **Model R Properties**:\n    $$ I_{g}^{(\\text{R})} = 13.50\\,\\text{eV}; \\quad A_{g}^{(\\text{R})} = 0.00 - 0.05 = -0.05\\,\\text{eV} $$\n    $$ I_{\\text{R}}^{\\ast} = 13.50\\,\\text{eV} - 12.65\\,\\text{eV} = 0.850\\,\\text{eV} $$\n    $$ A_{\\text{R}}^{\\ast} = -0.05\\,\\text{eV} + 12.65\\,\\text{eV} = 12.600\\,\\text{eV} $$\n\nThe results will be collected and formatted to three decimal places for the final output.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n# No other libraries are needed for this problem.\n\ndef solve():\n    \"\"\"\n    Computes excited-state ionization potentials and electron affinities for three\n    test cases based on a model of TD-DFT failures.\n    \"\"\"\n    \n    # Global constant\n    C = 14.3996  # eV * Angstrom\n\n    # Model parameters\n    params = {\n        'S': { # Semi-local\n            'delta_I': 1.50, \n            'delta_A': 1.00, \n            'delta_gap': 2.20, \n            'lambda': 0.0\n        },\n        'R': { # Range-separated\n            'delta_I': 0.10, \n            'delta_A': 0.05, \n            'delta_gap': 0.10, \n            'lambda': 1.0\n        }\n    }\n\n    def calculate_case_le(case_params, model_params):\n        \"\"\"Calculates results for the Local Excitation (LE) case.\"\"\"\n        I_g, A_g, S, beta = case_params\n        \n        # Calculate true excitation energy\n        omega_true = (I_g - A_g) - beta * S\n        \n        # Exact properties\n        I_exact_star = I_g - omega_true\n        A_exact_star = A_g + omega_true\n\n        # Model S properties\n        p_s = model_params['S']\n        omega_s = omega_true # For LE, omega_f = omega_true\n        I_g_s = I_g - p_s['delta_I']\n        A_g_s = A_g - p_s['delta_A']\n        I_s_star = I_g_s - omega_s\n        A_s_star = A_g_s + omega_s\n\n        # Model R properties\n        p_r = model_params['R']\n        omega_r = omega_true # For LE, omega_f = omega_true\n        I_g_r = I_g - p_r['delta_I']\n        A_g_r = A_g - p_r['delta_A']\n        I_r_star = I_g_r - omega_r\n        A_r_star = A_g_r + omega_r\n        \n        return (I_exact_star, A_exact_star, I_s_star, A_s_star, I_r_star, A_r_star)\n\n    def calculate_case_ct(case_params, model_params, C_const):\n        \"\"\"Calculates results for the Charge-Transfer (CT) case.\"\"\"\n        I_d, A_a, R = case_params\n        I_g, A_g = I_d, A_a # Supermolecular limit\n        \n        coulomb_term = C_const / R\n        \n        # True excitation energy\n        omega_true = (I_g - A_g) - coulomb_term\n        \n        # Exact properties\n        I_exact_star = I_g - omega_true\n        A_exact_star = A_g + omega_true\n\n        # Model S properties\n        p_s = model_params['S']\n        omega_s = (I_g - A_g) - p_s['delta_gap'] - p_s['lambda'] * coulomb_term\n        I_g_s = I_g - p_s['delta_I']\n        A_g_s = A_g - p_s['delta_A']\n        I_s_star = I_g_s - omega_s\n        A_s_star = A_g_s + omega_s\n\n        # Model R properties\n        p_r = model_params['R']\n        omega_r = (I_g - A_g) - p_r['delta_gap'] - p_r['lambda'] * coulomb_term\n        I_g_r = I_g - p_r['delta_I']\n        A_g_r = A_g - p_r['delta_A']\n        I_r_star = I_g_r - omega_r\n        A_r_star = A_g_r + omega_r\n\n        return (I_exact_star, A_exact_star, I_s_star, A_s_star, I_r_star, A_r_star)\n\n    def calculate_case_ry(case_params, model_params):\n        \"\"\"Calculates results for the Rydberg (RY) case.\"\"\"\n        I_g, A_g, chi, n = case_params\n        \n        binding_term = chi / (n**2)\n        \n        # True excitation energy\n        omega_true = I_g - binding_term\n        \n        # Exact properties\n        I_exact_star = I_g - omega_true\n        A_exact_star = A_g + omega_true\n\n        # Model S properties\n        p_s = model_params['S']\n        omega_s = (I_g - p_s['delta_I']) - (p_s['lambda']**2) * binding_term\n        I_g_s = I_g - p_s['delta_I']\n        A_g_s = A_g - p_s['delta_A']\n        I_s_star = I_g_s - omega_s\n        A_s_star = A_g_s + omega_s\n\n        # Model R properties\n        p_r = model_params['R']\n        omega_r = (I_g - p_r['delta_I']) - (p_r['lambda']**2) * binding_term\n        I_g_r = I_g - p_r['delta_I']\n        A_g_r = A_g - p_r['delta_A']\n        I_r_star = I_g_r - omega_r\n        A_r_star = A_g_r + omega_r\n\n        return (I_exact_star, A_exact_star, I_s_star, A_s_star, I_r_star, A_r_star)\n\n    # Define the test cases from the problem statement.\n    case_le_params = (9.50, 1.20, 0.85, 1.50)\n    case_ct_params = (7.80, 1.10, 12.00)\n    case_ry_params = (13.60, 0.00, 13.60, 4)\n\n    # Calculate results for all cases\n    results_le = calculate_case_le(case_le_params, params)\n    results_ct = calculate_case_ct(case_ct_params, params, C)\n    results_ry = calculate_case_ry(case_ry_params, params)\n    \n    # Concatenate all results\n    all_results = results_le + results_ct + results_ry\n    \n    # Format results to three decimal places\n    formatted_results = [f\"{x:.3f}\" for x in all_results]\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2878999"}]}