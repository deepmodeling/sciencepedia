{"hands_on_practices": [{"introduction": "This practice grounds the abstract formalism of response theory in a concrete, exactly solvable model: the quantum harmonic oscillator. It demonstrates how nonlinear response properties, such as the static first hyperpolarizability $\\beta$, can be derived directly from Rayleigh–Schrödinger perturbation theory. By comparing the perturbation theory result with an exact analytical solution, you will gain a deeper appreciation for the sum-over-states picture and the fundamental connection between energy derivatives and molecular properties. [@problem_id:2890583]", "problem": "Consider a one-dimensional, nonrelativistic, single-electron harmonic oscillator in the length gauge, described by the Hamiltonian under a uniform, static electric field $\\mathcal{E}$ along the $x$ axis,\n$$\n\\hat{H}(\\mathcal{E}) \\;=\\; \\frac{\\hat{p}^{2}}{2m} \\;+\\; \\frac{1}{2} m \\omega^{2} \\hat{x}^{2} \\;+\\; e\\, \\mathcal{E}\\, \\hat{x},\n$$\nwhere $m$ is the mass, $\\omega$ is the angular frequency, $e>0$ is the elementary charge, and the electronic dipole operator is $\\hat{\\mu} = -e \\hat{x}$. The induced dipole moment in the ground state is expanded in powers of the field as\n$$\n\\langle \\hat{\\mu} \\rangle_{\\mathcal{E}} \\;=\\; \\mu^{(0)} \\;+\\; \\alpha\\, \\mathcal{E} \\;+\\; \\frac{1}{2}\\, \\beta\\, \\mathcal{E}^{2} \\;+\\; \\frac{1}{6}\\, \\gamma\\, \\mathcal{E}^{3} \\;+\\; \\cdots,\n$$\nwhich defines the static polarizability $\\alpha$, the static first hyperpolarizability $\\beta(0;0,0)\\equiv \\beta$, and the static second hyperpolarizability $\\gamma$, respectively.\n\nStarting from first principles appropriate to quantum response theory and excited-state methods, do the following for the ground state of this system:\n1) Using the time-independent Schrödinger equation, the definition of the dipole operator, and Rayleigh–Schrödinger perturbation theory up to the necessary order in $\\mathcal{E}$, derive the field dependence of $\\langle \\hat{\\mu} \\rangle_{\\mathcal{E}}$ up to and including terms quadratic in $\\mathcal{E}$. Express your result in terms of harmonic-oscillator energies and position matrix elements, and evaluate it analytically using the ladder-operator structure of the harmonic oscillator.\n2) Independently obtain the exact field dependence of $\\langle \\hat{\\mu} \\rangle_{\\mathcal{E}}$ for the same system by solving the Hamiltonian at nonzero $\\mathcal{E}$ and extracting the series expansion coefficients.\n\nReport the final value of the static first hyperpolarizability $\\beta$ as a single closed-form analytic expression. No rounding is required, and no units should be included in the final boxed answer.", "solution": "The problem as stated is scientifically sound, well-posed, objective, and contains all necessary information for a unique solution. It is a standard problem in quantum mechanics and response theory. Therefore, we proceed with the solution.\n\nThe system is described by the Hamiltonian $\\hat{H}(\\mathcal{E}) = \\hat{H}^{(0)} + \\hat{V}$, where the unperturbed Hamiltonian is that of a simple harmonic oscillator, $\\hat{H}^{(0)} = \\frac{\\hat{p}^{2}}{2m} + \\frac{1}{2} m \\omega^{2} \\hat{x}^{2}$, and the perturbation due to the static electric field $\\mathcal{E}$ is $\\hat{V} = e \\mathcal{E} \\hat{x}$. The eigenstates and eigenvalues of $\\hat{H}^{(0)}$ are $|n\\rangle$ and $E_n^{(0)} = (n + \\frac{1}{2})\\hbar\\omega$, respectively, for $n=0, 1, 2, \\dots$. The dipole operator is $\\hat{\\mu} = -e\\hat{x}$.\n\nThe induced dipole moment in the ground state, $\\langle \\hat{\\mu} \\rangle_{\\mathcal{E}}$, can be related to the field-dependent ground state energy $E_0(\\mathcal{E})$ via the Hellmann-Feynman theorem:\n$$\n\\langle \\hat{\\mu} \\rangle_{\\mathcal{E}} = \\langle \\Psi_0(\\mathcal{E}) | -e\\hat{x} | \\Psi_0(\\mathcal{E}) \\rangle = - \\frac{\\partial E_0(\\mathcal{E})}{\\partial \\mathcal{E}},\n$$\nwhere we used $\\frac{\\partial \\hat{H}(\\mathcal{E})}{\\partial \\mathcal{E}} = e\\hat{x}$.\n\n**1. Perturbation Theory Approach**\n\nWe expand the ground-state energy $E_0(\\mathcal{E})$ using Rayleigh-Schrödinger perturbation theory:\n$$\nE_0(\\mathcal{E}) = E_0^{(0)} + E_0^{(1)} + E_0^{(2)} + E_0^{(3)} + \\cdots\n$$\nwhere $E_0^{(n)}$ is the $n$-th order energy correction, proportional to $\\mathcal{E}^n$. Substituting this into the expression for $\\langle \\hat{\\mu} \\rangle_{\\mathcal{E}}$ gives:\n$$\n\\langle \\hat{\\mu} \\rangle_{\\mathcal{E}} = - \\frac{\\partial}{\\partial \\mathcal{E}} \\left( E_0^{(0)} + \\mathcal{E} \\frac{E_0^{(1)}}{\\mathcal{E}} + \\mathcal{E}^2 \\frac{E_0^{(2)}}{\\mathcal{E}^2} + \\mathcal{E}^3 \\frac{E_0^{(3)}}{\\mathcal{E}^3} + \\cdots \\right) = - \\left( \\frac{E_0^{(1)}}{\\mathcal{E}} + 2\\mathcal{E} \\frac{E_0^{(2)}}{\\mathcal{E}^2} + 3\\mathcal{E}^2 \\frac{E_0^{(3)}}{\\mathcal{E}^3} + \\cdots \\right).\n$$\nComparing this with the given expansion $\\langle \\hat{\\mu} \\rangle_{\\mathcal{E}} = \\mu^{(0)} + \\alpha \\mathcal{E} + \\frac{1}{2}\\beta \\mathcal{E}^{2} + \\cdots$, we identify the coefficients:\n$$\n\\mu^{(0)} = - \\frac{E_0^{(1)}}{\\mathcal{E}}, \\quad \\alpha = -2 \\frac{E_0^{(2)}}{\\mathcal{E}^2}, \\quad \\beta = -6 \\frac{E_0^{(3)}}{\\mathcal{E}^3}.\n$$\nThe energy corrections are given by standard perturbation theory formulas:\n$E_0^{(1)} = \\langle 0 | \\hat{V} | 0 \\rangle = e\\mathcal{E} \\langle 0 | \\hat{x} | 0 \\rangle$.\n$E_0^{(2)} = \\sum_{k \\neq 0} \\frac{|\\langle k | \\hat{V} | 0 \\rangle|^2}{E_0^{(0)} - E_k^{(0)}} = e^2 \\mathcal{E}^2 \\sum_{k \\neq 0} \\frac{|\\langle k | \\hat{x} | 0 \\rangle|^2}{E_0^{(0)} - E_k^{(0)}}$.\n$E_0^{(3)} = e^3 \\mathcal{E}^3 \\left( \\sum_{k,l \\neq 0} \\frac{\\langle 0|\\hat{x}|k \\rangle \\langle k|\\hat{x}|l \\rangle \\langle l|\\hat{x}|0 \\rangle}{(E_0^{(0)}-E_k^{(0)})(E_0^{(0)}-E_l^{(0)})} - \\langle 0|\\hat{x}|0 \\rangle \\sum_{k \\neq 0} \\frac{|\\langle k|\\hat{x}|0 \\rangle|^2}{(E_0^{(0)}-E_k^{(0)})^2} \\right)$.\n\nTo evaluate these expressions, we use the ladder operator representation for $\\hat{x}$:\n$\\hat{x} = \\sqrt{\\frac{\\hbar}{2m\\omega}} (\\hat{a} + \\hat{a}^\\dagger)$, where $\\hat{a}|n\\rangle = \\sqrt{n}|n-1\\rangle$ and $\\hat{a}^\\dagger|n\\rangle = \\sqrt{n+1}|n+1\\rangle$.\nThe non-zero matrix elements of $\\hat{x}$ are $\\langle n-1 | \\hat{x} | n \\rangle = \\sqrt{\\frac{\\hbar n}{2m\\omega}}$ and $\\langle n+1 | \\hat{x} | n \\rangle = \\sqrt{\\frac{\\hbar (n+1)}{2m\\omega}}$.\n\nThe ground state $|0\\rangle$ has even parity, and $\\hat{x}$ has odd parity. Thus, the diagonal matrix element $\\langle 0 | \\hat{x} | 0 \\rangle = 0$.\nThis immediately implies $E_0^{(1)} = 0$, and therefore the permanent dipole moment is $\\mu^{(0)} = 0$.\n\nFor the polarizability $\\alpha$, we have:\n$\\alpha = -2e^2 \\sum_{k \\neq 0} \\frac{|\\langle k | \\hat{x} | 0 \\rangle|^2}{E_0^{(0)} - E_k^{(0)}}$.\nThe only non-zero matrix element $\\langle k | \\hat{x} | 0 \\rangle$ is for $k=1$, where $\\langle 1 | \\hat{x} | 0 \\rangle = \\sqrt{\\frac{\\hbar}{2m\\omega}}$. The energy difference is $E_0^{(0)} - E_1^{(0)} = \\frac{1}{2}\\hbar\\omega - \\frac{3}{2}\\hbar\\omega = -\\hbar\\omega$.\n$$\n\\alpha = -2e^2 \\frac{|\\langle 1 | \\hat{x} | 0 \\rangle|^2}{E_0^{(0)} - E_1^{(0)}} = -2e^2 \\frac{\\hbar/(2m\\omega)}{-\\hbar\\omega} = \\frac{e^2}{m\\omega^2}.\n$$\nThus, the term linear in $\\mathcal{E}$ in the induced dipole moment is $\\frac{e^2}{m\\omega^2}\\mathcal{E}$.\n\nFor the first hyperpolarizability $\\beta$, we examine $E_0^{(3)}$. Since $\\langle 0|\\hat{x}|0 \\rangle = 0$, the second term in the expression for $E_0^{(3)}$ vanishes.\n$$\n\\beta = -6 e^3 \\sum_{k,l \\neq 0} \\frac{\\langle 0|\\hat{x}|k \\rangle \\langle k|\\hat{x}|l \\rangle \\langle l|\\hat{x}|0 \\rangle}{(E_0^{(0)}-E_k^{(0)})(E_0^{(0)}-E_l^{(0)})}.\n$$\nThe matrix elements restrict the possible values of the intermediate states. $\\langle 0|\\hat{x}|k \\rangle \\neq 0$ implies $k=1$. Similarly, $\\langle l|\\hat{x}|0 \\rangle \\neq 0$ implies $l=1$. The sum reduces to a single term:\n$$\n\\beta = -6 e^3 \\frac{\\langle 0|\\hat{x}|1 \\rangle \\langle 1|\\hat{x}|1 \\rangle \\langle 1|\\hat{x}|0 \\rangle}{(E_0^{(0)}-E_1^{(0)})^2}.\n$$\nThe crucial term is the diagonal matrix element $\\langle 1|\\hat{x}|1 \\rangle$. Using ladder operators:\n$\\langle 1|\\hat{x}|1 \\rangle = \\sqrt{\\frac{\\hbar}{2m\\omega}} \\langle 1|\\hat{a}+\\hat{a}^\\dagger|1 \\rangle = \\sqrt{\\frac{\\hbar}{2m\\omega}} (\\langle 1|\\sqrt{1}|0 \\rangle + \\langle 1|\\sqrt{2}|2 \\rangle) = 0$.\nSince $\\langle 1|\\hat{x}|1 \\rangle=0$, the entire expression for $\\beta$ vanishes.\nTherefore, $\\beta=0$. The induced dipole moment up to quadratic terms is $\\langle \\hat{\\mu} \\rangle_{\\mathcal{E}} = \\frac{e^2}{m\\omega^2}\\mathcal{E}$.\n\n**2. Exact Solution**\n\nWe now solve the problem exactly. The Hamiltonian is $\\hat{H}(\\mathcal{E}) = \\frac{\\hat{p}^{2}}{2m} + \\frac{1}{2} m \\omega^{2} \\hat{x}^{2} + e \\mathcal{E} \\hat{x}$. We complete the square for the potential part:\n$$\n\\frac{1}{2} m \\omega^{2} \\hat{x}^{2} + e \\mathcal{E} \\hat{x} = \\frac{1}{2}m\\omega^2 \\left( \\hat{x}^2 + \\frac{2e\\mathcal{E}}{m\\omega^2}\\hat{x} \\right) = \\frac{1}{2}m\\omega^2 \\left( \\left(\\hat{x} + \\frac{e\\mathcal{E}}{m\\omega^2}\\right)^2 - \\left(\\frac{e\\mathcal{E}}{m\\omega^2}\\right)^2 \\right).\n$$\nLet us define a shifted position operator $\\hat{x}' = \\hat{x} + \\frac{e\\mathcal{E}}{m\\omega^2}$. Since $\\hat{p}$ commutes with the constant shift, the momentum operator is unchanged, $\\hat{p}' = \\hat{p}$, and the canonical commutation relation $[\\hat{x}', \\hat{p}'] = i\\hbar$ is preserved.\nThe Hamiltonian can be rewritten as:\n$$\n\\hat{H}(\\mathcal{E}) = \\frac{\\hat{p}'^2}{2m} + \\frac{1}{2}m\\omega^2\\hat{x}'^2 - \\frac{e^2\\mathcal{E}^2}{2m\\omega^2}.\n$$\nThis is the Hamiltonian for a harmonic oscillator in the coordinate $\\hat{x}'$, with a constant energy shift. The ground state of this system, $|\\Psi_0(\\mathcal{E})\\rangle$, is the ground state of the displaced oscillator, and its energy is $E_0(\\mathcal{E}) = \\frac{1}{2}\\hbar\\omega - \\frac{e^2\\mathcal{E}^2}{2m\\omega^2}$.\n\nThe expectation value of the dipole moment in this exact ground state is:\n$$\n\\langle \\hat{\\mu} \\rangle_{\\mathcal{E}} = \\langle \\Psi_0(\\mathcal{E}) | -e\\hat{x} | \\Psi_0(\\mathcal{E}) \\rangle.\n$$\nWe express $\\hat{x}$ in terms of the shifted coordinate: $\\hat{x} = \\hat{x}' - \\frac{e\\mathcal{E}}{m\\omega^2}$.\n$$\n\\langle \\hat{\\mu} \\rangle_{\\mathcal{E}} = \\langle \\Psi_0(\\mathcal{E}) | -e\\left(\\hat{x}' - \\frac{e\\mathcal{E}}{m\\omega^2}\\right) | \\Psi_0(\\mathcal{E}) \\rangle = -e\\langle \\Psi_0(\\mathcal{E})|\\hat{x}'|\\Psi_0(\\mathcal{E}) \\rangle + \\frac{e^2\\mathcal{E}}{m\\omega^2}\\langle \\Psi_0(\\mathcal{E})|\\Psi_0(\\mathcal{E}) \\rangle.\n$$\nSince $|\\Psi_0(\\mathcal{E})\\rangle$ is the ground state of the oscillator described by $\\hat{x}'$, the expectation value of $\\hat{x}'$ is zero, $\\langle \\Psi_0(\\mathcal{E})|\\hat{x}'|\\Psi_0(\\mathcal{E}) \\rangle = 0$. The wavefunction is normalized, $\\langle \\Psi_0(\\mathcal{E})|\\Psi_0(\\mathcal{E}) \\rangle = 1$.\nThis yields the exact expression for the induced dipole moment:\n$$\n\\langle \\hat{\\mu} \\rangle_{\\mathcal{E}} = \\frac{e^2}{m\\omega^2}\\mathcal{E}.\n$$\nThis result is exactly linear in the electric field $\\mathcal{E}$. Comparing this to the power series expansion:\n$$\n\\langle \\hat{\\mu} \\rangle_{\\mathcal{E}} = \\mu^{(0)} + \\alpha\\mathcal{E} + \\frac{1}{2}\\beta\\mathcal{E}^2 + \\frac{1}{6}\\gamma\\mathcal{E}^3 + \\cdots\n$$\nwe find by direct comparison of coefficients:\n$\\mu^{(0)} = 0$.\n$\\alpha = \\frac{e^2}{m\\omega^2}$.\n$\\beta = 0$.\n$\\gamma = 0$, and all higher-order hyperpolarizabilities are also zero.\n\nBoth the perturbation theory calculation and the exact solution demonstrate conclusively that the static first hyperpolarizability $\\beta$ for the quantum harmonic oscillator is zero.", "answer": "$$\\boxed{0}$$", "id": "2890583"}, {"introduction": "Building upon foundational principles, this exercise explores a critical challenge in computational quantum chemistry: the description of states with significant double-excitation character. You will compare the performance of several common approaches—adiabatic Time-Dependent Density Functional Theory (TDDFT), a 'dressed' TDDFT variant, and Equation-of-Motion Coupled-Cluster (EOM-CCSD)—using a minimal model designed to highlight their differing capabilities. This comparative analysis is crucial for understanding the reliability of excited-state methods and provides invaluable insight into why certain electronic transitions require higher-level theoretical treatments. [@problem_id:2890550]", "problem": "Consider a closed-shell, two-electron, two-spatial-orbital model with one occupied spatial orbital $i$ and one virtual spatial orbital $a$. Let the Kohn–Sham orbital energy gap be $\\Delta \\equiv \\varepsilon_{a}-\\varepsilon_{i} = 4.20$ eV. We will analyze the lowest singlet excitations using three methods: adiabatic Time-Dependent Density Functional Theory (TDDFT), dressed TDDFT (frequency-dependent kernel including an explicit double-excitation pole), and Equation-of-Motion Coupled-Cluster with Singles and Doubles (EOM-CCSD). Throughout, restrict to the singlet subspace and the minimal basis of one singly excited configuration and the corresponding doubly excited configuration, and assume the Tamm–Dancoff approximation (TDA) when invoking TDDFT.\n\nStart from the following foundational bases:\n- For linear response in TDDFT, excitations are poles of the interacting density–density response function, which in the Tamm–Dancoff approximation reduces to an eigenvalue problem in the space of single excitations using the Kohn–Sham transitions dressed by the Hartree–exchange–correlation kernel.\n- For dressed TDDFT, include a frequency-dependent correction that introduces an explicit double-excitation pole, leading to a coupled problem between the single and the double in the response equations.\n- For EOM-CCSD, excitation energies are right-eigenvalues $\\omega$ of the similarity-transformed Hamiltonian Jacobian acting in the space spanned by single and double excitation operators.\n\nUse the following data for this model:\n1. Adiabatic TDDFT (Tamm–Dancoff): the singlet coupling shift is $K_{\\mathrm{A}} = 0.80$ eV. Thus the adiabatic TDDFT singlet single-excitation energy is the TDA-interacting gap $\\omega_{S}^{\\mathrm{A}} = \\Delta + K_{\\mathrm{A}}$.\n2. Dressed TDDFT: include one explicit double-excitation pole with uncoupled energy $\\Omega_{D}^{0} = 8.20$ eV and a coupling between the single and the double of $\\lambda_{\\mathrm{d}} = 0.60$ eV. In the subspace spanned by the single and double configurations, the dressed response eigenvalue problem reduces to diagonalizing a $2\\times 2$ matrix with diagonal elements $\\omega_{S}^{\\mathrm{A}}$ and $\\Omega_{D}^{0}$ and off-diagonal elements $\\lambda_{\\mathrm{d}}$.\n3. EOM-CCSD: in the same two-state subspace, the similarity-transformed Hamiltonian Jacobian has diagonal elements $\\Omega_{S}^{\\mathrm{CC}} = 4.95$ eV and $\\Omega_{D}^{\\mathrm{CC}} = 8.05$ eV with off-diagonal coupling $\\Lambda_{\\mathrm{CC}} = 0.55$ eV.\n\nCompute the following excitation energies:\n- the adiabatic TDDFT Tamm–Dancoff single-excitation energy,\n- the two dressed TDDFT roots,\n- and the two EOM-CCSD roots,\n\nby solving the corresponding eigenvalue problems described above. Express all five energies in electronvolts (eV), rounded to four significant figures. Report your final results as a single row vector in the order $\\left[\\omega_{S}^{\\mathrm{A}},\\,\\omega_{-}^{\\mathrm{dress}},\\,\\omega_{+}^{\\mathrm{dress}},\\,\\omega_{-}^{\\mathrm{CC}},\\,\\omega_{+}^{\\mathrm{CC}}\\right]$.", "solution": "The supplied problem is subjected to rigorous validation.\n\n**Step 1: Extract Givens**\nThe problem provides the following data and definitions for a closed-shell, two-electron, two-spatial-orbital system:\n-   Kohn–Sham orbital energy gap: $\\Delta \\equiv \\varepsilon_{a}-\\varepsilon_{i} = 4.20$ eV.\n-   Adiabatic TDDFT singlet coupling shift (in Tamm–Dancoff approximation, TDA): $K_{\\mathrm{A}} = 0.80$ eV.\n-   Adiabatic TDDFT TDA single-excitation energy expression: $\\omega_{S}^{\\mathrm{A}} = \\Delta + K_{\\mathrm{A}}$.\n-   Dressed TDDFT uncoupled double-excitation energy: $\\Omega_{D}^{0} = 8.20$ eV.\n-   Dressed TDDFT single-double coupling: $\\lambda_{\\mathrm{d}} = 0.60$ eV.\n-   Dressed TDDFT problem: Diagonalize a $2 \\times 2$ matrix with diagonal elements $\\omega_{S}^{\\mathrm{A}}$ and $\\Omega_{D}^{0}$ and off-diagonal elements $\\lambda_{\\mathrm{d}}$.\n-   EOM-CCSD single-excitation diagonal element: $\\Omega_{S}^{\\mathrm{CC}} = 4.95$ eV.\n-   EOM-CCSD double-excitation diagonal element: $\\Omega_{D}^{\\mathrm{CC}} = 8.05$ eV.\n-   EOM-CCSD off-diagonal coupling: $\\Lambda_{\\mathrm{CC}} = 0.55$ eV.\n-   EOM-CCSD problem: Diagonalize a $2 \\times 2$ matrix with diagonal elements $\\Omega_{S}^{\\mathrm{CC}}$ and $\\Omega_{D}^{\\mathrm{CC}}$ and off-diagonal coupling $\\Lambda_{\\mathrm{CC}}$.\n-   Requirement: Compute five excitation energies ($\\omega_{S}^{\\mathrm{A}}$, the two dressed TDDFT roots, and the two EOM-CCSD roots) in eV, rounded to four significant figures.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is assessed for validity.\n-   **Scientific Grounding**: The problem is entirely grounded in the established theoretical frameworks of quantum chemistry, specifically excited-state methods such as Time-Dependent Density Functional Theory (TDDFT) and Equation-of-Motion Coupled-Cluster (EOM-CC). The use of the Tamm–Dancoff approximation, response functions, and the diagonalization of a configuration interaction or Jacobian matrix are standard procedures. The numerical values provided are physically plausible for a model system. The problem is scientifically sound.\n-   **Well-Posedness**: The problem is specified with clarity. It requires the calculation of an algebraic sum and the eigenvalues of two well-defined $2 \\times 2$ symmetric matrices. The solution exists, is unique, and is stable with respect to the input parameters.\n-   **Objectivity and Completeness**: The problem is stated in objective, formal language. All necessary constants and relationships are provided. It is a self-contained and consistent mathematical exercise.\n\n**Step 3: Verdict and Action**\nThe problem is valid. A solution will be derived.\n\nThe solution proceeds by performing the three calculations as specified.\n\n**1. Adiabatic TDDFT (TDA) Single-Excitation Energy**\nThe energy of the singly excited state in the adiabatic Tamm–Dancoff approximation, $\\omega_{S}^{\\mathrm{A}}$, is given as the sum of the Kohn–Sham orbital energy gap, $\\Delta$, and the singlet coupling shift, $K_{\\mathrm{A}}$.\nGiven $\\Delta = 4.20$ eV and $K_{\\mathrm{A}} = 0.80$ eV:\n$$\n\\omega_{S}^{\\mathrm{A}} = \\Delta + K_{\\mathrm{A}} = 4.20 \\text{ eV} + 0.80 \\text{ eV} = 5.00 \\text{ eV}\n$$\nThe value is $5.000$ eV when expressed to four significant figures.\n\n**2. Dressed TDDFT Excitation Energies**\nThe dressed TDDFT calculation in the specified two-state model requires the diagonalization of a $2 \\times 2$ matrix, $H_{\\mathrm{dress}}$. The diagonal elements are the uncoupled single-excitation energy, $\\omega_{S}^{\\mathrm{A}}$, and the uncoupled double-excitation energy, $\\Omega_{D}^{0}$. The off-diagonal elements are the coupling, $\\lambda_{\\mathrm{d}}$.\nThe matrix is:\n$$\nH_{\\mathrm{dress}} = \\begin{pmatrix} \\omega_{S}^{\\mathrm{A}} & \\lambda_{\\mathrm{d}} \\\\ \\lambda_{\\mathrm{d}} & \\Omega_{D}^{0} \\end{pmatrix} = \\begin{pmatrix} 5.00 & 0.60 \\\\ 0.60 & 8.20 \\end{pmatrix} \\text{ eV}\n$$\nThe eigenvalues, $\\omega^{\\mathrm{dress}}$, are found by solving the characteristic equation $\\det(H_{\\mathrm{dress}} - \\omega I) = 0$:\n$$\n(5.00 - \\omega)(8.20 - \\omega) - (0.60)^2 = 0\n$$\n$$\n\\omega^2 - (5.00 + 8.20)\\omega + (5.00 \\times 8.20 - 0.36) = 0\n$$\n$$\n\\omega^2 - 13.20\\omega + 40.64 = 0\n$$\nUsing the quadratic formula, $\\omega = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}$:\n$$\n\\omega_{\\pm}^{\\mathrm{dress}} = \\frac{13.20 \\pm \\sqrt{(-13.20)^2 - 4(1)(40.64)}}{2} = \\frac{13.20 \\pm \\sqrt{174.24 - 162.56}}{2} = \\frac{13.20 \\pm \\sqrt{11.68}}{2}\n$$\n$$\n\\omega_{\\pm}^{\\mathrm{dress}} = \\frac{13.20 \\pm 3.417601 \\ldots}{2}\n$$\nThe two roots are:\n$$\n\\omega_{-}^{\\mathrm{dress}} = \\frac{13.20 - 3.417601}{2} = \\frac{9.782399}{2} = 4.8911995 \\ldots \\text{ eV}\n$$\n$$\n\\omega_{+}^{\\mathrm{dress}} = \\frac{13.20 + 3.417601}{2} = \\frac{16.617601}{2} = 8.3088005 \\ldots \\text{ eV}\n$$\nRounding to four significant figures, we get $\\omega_{-}^{\\mathrm{dress}} = 4.891$ eV and $\\omega_{+}^{\\mathrm{dress}} = 8.309$ eV.\n\n**3. EOM-CCSD Excitation Energies**\nThe EOM-CCSD calculation requires the diagonalization of the similarity-transformed Hamiltonian Jacobian, $H_{\\mathrm{CC}}$, in the basis of single and double excitations.\nThe matrix is:\n$$\nH_{\\mathrm{CC}} = \\begin{pmatrix} \\Omega_{S}^{\\mathrm{CC}} & \\Lambda_{\\mathrm{CC}} \\\\ \\Lambda_{\\mathrm{CC}} & \\Omega_{D}^{\\mathrm{CC}} \\end{pmatrix} = \\begin{pmatrix} 4.95 & 0.55 \\\\ 0.55 & 8.05 \\end{pmatrix} \\text{ eV}\n$$\nThe eigenvalues, $\\omega^{\\mathrm{CC}}$, are found by solving the characteristic equation $\\det(H_{\\mathrm{CC}} - \\omega I) = 0$:\n$$\n(4.95 - \\omega)(8.05 - \\omega) - (0.55)^2 = 0\n$$\n$$\n\\omega^2 - (4.95 + 8.05)\\omega + (4.95 \\times 8.05 - 0.3025) = 0\n$$\n$$\n\\omega^2 - 13.00\\omega + (39.8475 - 0.3025) = 0\n$$\n$$\n\\omega^2 - 13.00\\omega + 39.545 = 0\n$$\nUsing the quadratic formula:\n$$\n\\omega_{\\pm}^{\\mathrm{CC}} = \\frac{13.00 \\pm \\sqrt{(-13.00)^2 - 4(1)(39.545)}}{2} = \\frac{13.00 \\pm \\sqrt{169 - 158.18}}{2} = \\frac{13.00 \\pm \\sqrt{10.82}}{2}\n$$\n$$\n\\omega_{\\pm}^{\\mathrm{CC}} = \\frac{13.00 \\pm 3.2893768 \\ldots}{2}\n$$\nThe two roots are:\n$$\n\\omega_{-}^{\\mathrm{CC}} = \\frac{13.00 - 3.2893768}{2} = \\frac{9.7106232}{2} = 4.8553116 \\ldots \\text{ eV}\n$$\n$$\n\\omega_{+}^{\\mathrm{CC}} = \\frac{13.00 + 3.2893768}{2} = \\frac{16.2893768}{2} = 8.1446884 \\ldots \\text{ eV}\n$$\nRounding to four significant figures, we get $\\omega_{-}^{\\mathrm{CC}} = 4.855$ eV and $\\omega_{+}^{\\mathrm{CC}} = 8.145$ eV.\n\nThe five computed excitation energies, reported in the specified order and rounded to four significant figures, are:\n-   $\\omega_{S}^{\\mathrm{A}} = 5.000$ eV\n-   $\\omega_{-}^{\\mathrm{dress}} = 4.891$ eV\n-   $\\omega_{+}^{\\mathrm{dress}} = 8.309$ eV\n-   $\\omega_{-}^{\\mathrm{CC}} = 4.855$ eV\n-   $\\omega_{+}^{\\mathrm{CC}} = 8.145$ eV", "answer": "$$\n\\boxed{\\begin{pmatrix} 5.000 & 4.891 & 8.309 & 4.855 & 8.145 \\end{pmatrix}}\n$$", "id": "2890550"}, {"introduction": "Our final practice applies these theoretical concepts to a phenomenon of central importance in photochemistry and photophysics: conical intersections, the funnels that mediate ultra-fast non-radiative decay. This advanced, hands-on exercise guides you through mapping a conical intersection seam using a vibronic coupling model inspired by methods like State-Averaged Complete Active Space Self-Consistent Field (SA-CASSCF). By implementing a program to trace the seam and analyze the governing branching plane vectors, you will bridge the gap between electronic structure theory and the dynamics of molecules on excited-state potential energy surfaces, developing skills to analyze the geometric features that control photochemical outcomes. [@problem_id:2890547]", "problem": "Consider a minimal, state-averaged complete active space self-consistent field (SA-CASSCF) inspired two-state linear-plus-quadratic vibronic coupling model in mass-weighted, dimensionless nuclear coordinates $\\mathbf{Q} = (Q_1,Q_2,Q_3)$. The electronic Hamiltonian in a diabatic basis $\\{ \\lvert \\phi_1 \\rangle, \\lvert \\phi_2 \\rangle \\}$ is modeled as a $2 \\times 2$ Hermitian matrix with elements\n$$\nV_{11}(\\mathbf{Q}) = \\kappa + \\boldsymbol{\\alpha} \\cdot \\mathbf{Q} + \\frac{k}{2} \\lVert \\mathbf{Q} \\rVert^2,\\quad\nV_{22}(\\mathbf{Q}) = \\kappa - \\boldsymbol{\\alpha} \\cdot \\mathbf{Q} + \\frac{k}{2} \\lVert \\mathbf{Q} \\rVert^2,\\quad\nV_{12}(\\mathbf{Q}) = \\boldsymbol{\\beta} \\cdot \\mathbf{Q} + \\gamma Q_3^2,\n$$\nwhere $\\kappa$ and $k$ are real constants, $\\boldsymbol{\\alpha} = (\\alpha_1,\\alpha_2,\\alpha_3)$ and $\\boldsymbol{\\beta} = (\\beta_1,\\beta_2,\\beta_3)$ are constant coefficient vectors arising from first-order vibronic couplings within the SA-CASSCF active space, and $\\gamma$ is a real constant modeling a second-order off-diagonal coupling along the $Q_3$ direction that mimics orbital-response effects under state averaging. The adiabatic energies $E_{\\pm}(\\mathbf{Q})$ are the eigenvalues of the matrix\n$$\n\\mathbf{V}(\\mathbf{Q}) = \\begin{pmatrix}\nV_{11}(\\mathbf{Q}) & V_{12}(\\mathbf{Q}) \\\\\nV_{12}(\\mathbf{Q}) & V_{22}(\\mathbf{Q})\n\\end{pmatrix}.\n$$\n\nA conical intersection between the two lowest adiabatic states occurs where the adiabatic energies become degenerate. In a two-state real-symmetric model, degeneracy occurs if and only if both the diabatic energy difference $\\Delta(\\mathbf{Q}) = V_{11}(\\mathbf{Q}) - V_{22}(\\mathbf{Q})$ and the diabatic coupling $V_{12}(\\mathbf{Q})$ are zero simultaneously. The set of points satisfying these two equations defines the conical intersection seam; in three nuclear dimensions this seam generically forms a one-dimensional curve. At any point $\\mathbf{Q}^\\ast$ on the seam, the branching plane is a two-dimensional subspace of nuclear coordinate space that lifts the degeneracy to first order, and is spanned by a gradient-difference vector $\\mathbf{g}$ and a nonadiabatic coupling vector $\\mathbf{h}$ defined by first principles of response theory for the two-state problem.\n\nYour tasks are:\n\n1) Starting from the fundamental definition of the time-independent electronic Hamiltonian $\\hat{H}_e(\\mathbf{Q})$ parametrized by nuclear coordinates, the Born–Oppenheimer separation, the Hellmann–Feynman theorem, and the two-state real-symmetric reduction, derive the conditions for the conical intersection seam in this model and derive explicit equations for mapping the seam as a function of the coordinate $Q_3$. Concretely, show how to obtain $Q_1(Q_3)$ and $Q_2(Q_3)$ by solving the simultaneous equations $\\Delta(\\mathbf{Q})=0$ and $V_{12}(\\mathbf{Q})=0$ for each fixed $Q_3$.\n\n2) Using first-order response definitions that connect energy derivatives and nonadiabatic couplings to $\\partial \\hat{H}_e/\\partial Q_k$ under state averaging, derive the expressions for the branching plane vectors $\\mathbf{g}$ and $\\mathbf{h}$ at a seam point $\\mathbf{Q}^\\ast$. Then, for the model specified above, express $\\mathbf{g}$ and $\\mathbf{h}$ in terms of $\\boldsymbol{\\alpha}$, $\\boldsymbol{\\beta}$, $\\gamma$, and $Q_3$ evaluated on the seam.\n\n3) For a given parameter set, sample the seam by taking $Q_3$ values uniformly from $-1$ to $+1$ in steps of $0.2$ (i.e., eleven samples including endpoints), compute the corresponding seam points $(Q_1(Q_3),Q_2(Q_3),Q_3)$, evaluate the branching plane vectors $\\mathbf{g}(Q_3)$ and $\\mathbf{h}(Q_3)$ at those points, normalize them to unit vectors, and compute the angle $\\theta(Q_3)$ between them using the Euclidean inner product. Angles must be reported in radians. To quantify the behavior of the branching plane along the seam, compute the maximum absolute deviation of $\\theta(Q_3)$ from $\\pi/2$ across the sampled seam points, that is,\n$$\n\\Delta_{\\max} = \\max_{Q_3 \\in \\{-1,-0.8,\\ldots,1\\}} \\left| \\theta(Q_3) - \\frac{\\pi}{2} \\right|.\n$$\n\n4) Implement a program that performs the above mapping and analysis for the following test suite of three parameter sets. All coordinates are dimensionless and mass-weighted; angles must be computed in radians.\n\n- Test case A (pure linear vibronic coupling in the off-diagonal): $\\boldsymbol{\\alpha} = (1.0,\\,0.5,\\,-0.2)$, $\\boldsymbol{\\beta} = (0.3,\\,-0.8,\\,0.4)$, $\\gamma = 0.0$. You may set $\\kappa = 0$ and $k = 0$ without loss of generality for the seam and branching plane analysis.\n\n- Test case B (positive quadratic off-diagonal coupling): $\\boldsymbol{\\alpha} = (0.6,\\,-0.9,\\,0.7)$, $\\boldsymbol{\\beta} = (-0.5,\\,0.2,\\,0.1)$, $\\gamma = 0.4$.\n\n- Test case C (orthogonal linear couplings with negative quadratic term): $\\boldsymbol{\\alpha} = (1.0,\\,0.0,\\,0.0)$, $\\boldsymbol{\\beta} = (0.0,\\,1.0,\\,0.0)$, $\\gamma = -0.6$.\n\nYour program must:\n\n- For each test case, solve the $2 \\times 2$ linear system at each sampled $Q_3$ to obtain $Q_1(Q_3)$ and $Q_2(Q_3)$ along the seam.\n- Compute the unit vectors $\\hat{\\mathbf{g}}(Q_3)$ and $\\hat{\\mathbf{h}}(Q_3)$ and the angle $\\theta(Q_3)$ between them via the arccosine of their dot product, using clamping to the interval $[-1,1]$ to avoid numerical issues.\n- Return, for each test case, a single floating-point number equal to $\\Delta_{\\max}$ defined above.\n\nFinal output format requirement:\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[rA,rB,rC]\"), where $r\\mathrm{A}$, $r\\mathrm{B}$, and $r\\mathrm{C}$ are the three $\\Delta_{\\max}$ values (in radians) for test cases A, B, and C, respectively. The output must be a single line, and each number should be a decimal floating-point literal.", "solution": "The problem requires the analysis of a two-state vibronic coupling model to characterize the conical intersection seam and the behavior of the branching plane along this seam. We will proceed through a systematic derivation of the required quantities, followed by an algorithmic description of the numerical evaluation.\n\nFirst, we establish the conditions defining the conical intersection seam. A conical intersection, which is a point of degeneracy between two adiabatic potential energy surfaces, occurs in this real-symmetric two-state model if and only if two conditions are met simultaneously. These are the vanishing of the diabatic energy difference and the vanishing of the off-diagonal diabatic coupling.\n\nThe diabatic energy difference, $\\Delta(\\mathbf{Q})$, is given by:\n$$\n\\Delta(\\mathbf{Q}) = V_{11}(\\mathbf{Q}) - V_{22}(\\mathbf{Q}) = \\left(\\kappa + \\boldsymbol{\\alpha} \\cdot \\mathbf{Q} + \\frac{k}{2} \\lVert \\mathbf{Q} \\rVert^2\\right) - \\left(\\kappa - \\boldsymbol{\\alpha} \\cdot \\mathbf{Q} + \\frac{k}{2} \\lVert \\mathbf{Q} \\rVert^2\\right) = 2 \\boldsymbol{\\alpha} \\cdot \\mathbf{Q}\n$$\nThe first condition is thus $\\Delta(\\mathbf{Q}) = 0$, which simplifies to:\n$$\n\\boldsymbol{\\alpha} \\cdot \\mathbf{Q} = \\alpha_1 Q_1 + \\alpha_2 Q_2 + \\alpha_3 Q_3 = 0 \\quad (\\text{Equation I})\n$$\nNote that this condition is independent of the parameters $\\kappa$ and $k$.\n\nThe off-diagonal diabatic coupling, $V_{12}(\\mathbf{Q})$, is given as:\n$$\nV_{12}(\\mathbf{Q}) = \\boldsymbol{\\beta} \\cdot \\mathbf{Q} + \\gamma Q_3^2\n$$\nThe second condition is $V_{12}(\\mathbf{Q}) = 0$:\n$$\n\\boldsymbol{\\beta} \\cdot \\mathbf{Q} + \\gamma Q_3^2 = \\beta_1 Q_1 + \\beta_2 Q_2 + \\beta_3 Q_3 + \\gamma Q_3^2 = 0 \\quad (\\text{Equation II})\n$$\nTo map the intersection seam as a function of the coordinate $Q_3$, we treat $Q_3$ as a parameter and solve Equations I and II for $Q_1$ and $Q_2$. This yields a linear system of two equations:\n$$\n\\alpha_1 Q_1 + \\alpha_2 Q_2 = -\\alpha_3 Q_3\n$$\n$$\n\\beta_1 Q_1 + \\beta_2 Q_2 = -(\\beta_3 Q_3 + \\gamma Q_3^2)\n$$\nIn matrix form, this is:\n$$\n\\begin{pmatrix} \\alpha_1 & \\alpha_2 \\\\ \\beta_1 & \\beta_2 \\end{pmatrix} \\begin{pmatrix} Q_1 \\\\ Q_2 \\end{pmatrix} = \\begin{pmatrix} -\\alpha_3 Q_3 \\\\ -\\beta_3 Q_3 - \\gamma Q_3^2 \\end{pmatrix}\n$$\nThis system has a unique solution for ($Q_1$, $Q_2$) for each value of $Q_3$, provided the determinant of the coefficient matrix, $D = \\alpha_1 \\beta_2 - \\alpha_2 \\beta_1$, is non-zero. For the given test cases, this condition holds. The solution provides the functions $Q_1(Q_3)$ and $Q_2(Q_3)$ that trace the one-dimensional conical intersection seam in the three-dimensional nuclear coordinate space.\n\nSecond, we derive the expressions for the branching plane vectors. At any point $\\mathbf{Q}^\\ast$ on the intersection seam, the branching plane is spanned by the gradient-difference vector $\\mathbf{g}$ and the nonadiabatic coupling vector $\\mathbf{h}$. In the diabatic basis representation, these vectors are defined by the gradients of the diabatic matrix elements.\n\nThe gradient-difference vector $\\mathbf{g}$ has components given by the gradient of the diabatic energy difference, $\\Delta(\\mathbf{Q})$:\n$$\ng_k(\\mathbf{Q}^\\ast) = \\left. \\frac{\\partial \\Delta(\\mathbf{Q})}{\\partial Q_k} \\right|_{\\mathbf{Q}=\\mathbf{Q}^\\ast} = \\frac{\\partial}{\\partial Q_k} (2 \\boldsymbol{\\alpha} \\cdot \\mathbf{Q}) = 2\\alpha_k\n$$\nThus, the vector $\\mathbf{g}$ is constant over the entire coordinate space:\n$$\n\\mathbf{g} = 2\\boldsymbol{\\alpha} = (2\\alpha_1, 2\\alpha_2, 2\\alpha_3)\n$$\n\nThe nonadiabatic coupling vector $\\mathbf{h}$ has components given by the gradient of the diabatic coupling element, $V_{12}(\\mathbf{Q})$:\n$$\nh_k(\\mathbf{Q}^\\ast) = \\left. \\frac{\\partial V_{12}(\\mathbf{Q})}{\\partial Q_k} \\right|_{\\mathbf{Q}=\\mathbf{Q}^\\ast} = \\frac{\\partial}{\\partial Q_k} (\\boldsymbol{\\beta} \\cdot \\mathbf{Q} + \\gamma Q_3^2)\n$$\nCalculating the partial derivatives yields the components of $\\mathbf{h}$:\n$$\nh_1 = \\frac{\\partial V_{12}}{\\partial Q_1} = \\beta_1\n$$\n$$\nh_2 = \\frac{\\partial V_{12}}{\\partial Q_2} = \\beta_2\n$$\n$$\nh_3 = \\frac{\\partial V_{12}}{\\partial Q_3} = \\beta_3 + 2\\gamma Q_3\n$$\nThe vector $\\mathbf{h}$ is therefore:\n$$\n\\mathbf{h}(\\mathbf{Q}^\\ast) = (\\beta_1, \\beta_2, \\beta_3 + 2\\gamma Q_3^\\ast)\n$$\nUnlike $\\mathbf{g}$, the vector $\\mathbf{h}$ is not constant if $\\gamma \\neq 0$, but depends on the position along the intersection seam through the coordinate $Q_3^\\ast$.\n\nThird, we outline the numerical procedure to compute the maximum deviation $\\Delta_{\\max}$. For each specified parameter set ($\\boldsymbol{\\alpha}, \\boldsymbol{\\beta}, \\gamma$):\n1.  Define the set of sampling points for $Q_3$: $\\{-1.0, -0.8, \\dots, 0.8, 1.0\\}$.\n2.  For each sample point $Q_{3,i}$ in this set:\n    a. Solve the $2 \\times 2$ linear system derived above to find the corresponding seam coordinates $Q_{1,i}$ and $Q_{2,i}$. This defines the seam point $\\mathbf{Q}_i^\\ast = (Q_{1,i}, Q_{2,i}, Q_{3,i})$.\n    b. Evaluate the branching plane vectors at this point. The vector $\\mathbf{g}$ is constant, $\\mathbf{g} = 2\\boldsymbol{\\alpha}$. The vector $\\mathbf{h}_i$ is $\\mathbf{h}(Q_{3,i}) = (\\beta_1, \\beta_2, \\beta_3 + 2\\gamma Q_{3,i})$.\n    c. Normalize both vectors to obtain unit vectors: $\\hat{\\mathbf{g}} = \\mathbf{g} / \\lVert \\mathbf{g} \\rVert$ and $\\hat{\\mathbf{h}}_i = \\mathbf{h}_i / \\lVert \\mathbf{h}_i \\rVert$.\n    d. Compute the angle $\\theta_i$ between them in radians. This is done by taking the arccosine of their dot product: $\\theta_i = \\arccos(\\hat{\\mathbf{g}} \\cdot \\hat{\\mathbf{h}}_i)$. To prevent numerical domain errors, the argument to arccosine must be clamped to the interval $[-1.0, 1.0]$.\n    e. Calculate the absolute deviation from orthogonality: $|\\theta_i - \\pi/2|$.\n3.  After iterating through all sample points, find the maximum among the computed deviations. This maximum value is the result, $\\Delta_{\\max}$.\n$$\n\\Delta_{\\max} = \\max_{i} \\left| \\theta_i - \\frac{\\pi}{2} \\right|\n$$\nThis procedure fully specifies the solution to the problem.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the maximum deviation of the branching plane angle from pi/2\n    for three test cases of a vibronic coupling model.\n    \"\"\"\n    test_cases = [\n        # Test case A\n        {'alpha': np.array([1.0, 0.5, -0.2]), 'beta': np.array([0.3, -0.8, 0.4]), 'gamma': 0.0},\n        # Test case B\n        {'alpha': np.array([0.6, -0.9, 0.7]), 'beta': np.array([-0.5, 0.2, 0.1]), 'gamma': 0.4},\n        # Test case C\n        {'alpha': np.array([1.0, 0.0, 0.0]), 'beta': np.array([0.0, 1.0, 0.0]), 'gamma': -0.6},\n    ]\n\n    final_results = []\n\n    for case in test_cases:\n        alpha = case['alpha']\n        beta = case['beta']\n        gamma = case['gamma']\n\n        # Define the sampling points for Q3\n        q3_samples = np.linspace(-1.0, 1.0, 11)\n        \n        deviations = []\n\n        # Define the constant g vector\n        g_vec = 2.0 * alpha\n        g_norm = np.linalg.norm(g_vec)\n        if g_norm == 0:\n            # Handle the unlikely case of a zero g vector.\n            # In this model, it means alpha is the zero vector,\n            # which would make the seam undefined.\n            # For the given test cases, this won't happen.\n            final_results.append(0.0)\n            continue\n            \n        g_hat = g_vec / g_norm\n\n        # Coefficient matrix for the linear system in (Q1, Q2)\n        # This matrix is constant for all Q3 samples.\n        A_matrix = np.array([\n            [alpha[0], alpha[1]],\n            [beta[0], beta[1]]\n        ])\n\n        for q3 in q3_samples:\n            # 1. Find the seam point (Q1, Q2, Q3)\n            # Right-hand side of the linear system\n            b_vector = np.array([\n                -alpha[2] * q3,\n                -(beta[2] * q3 + gamma * q3**2)\n            ])\n            \n            # Solve for (Q1, Q2)\n            try:\n                q1q2 = np.linalg.solve(A_matrix, b_vector)\n            except np.linalg.LinAlgError:\n                # The matrix is singular, seam is not a simple curve.\n                # This should not happen for the given test cases.\n                deviations.append(np.nan)\n                continue\n\n            # seam_point = np.array([q1q2[0], q1q2[1], q3]) # Not needed for calculation\n\n            # 2. Calculate the h vector at the seam point\n            h_vec = np.array([beta[0], beta[1], beta[2] + 2.0 * gamma * q3])\n            \n            h_norm = np.linalg.norm(h_vec)\n            if h_norm == 0:\n                # h vector is zero, angle is undefined.\n                deviations.append(0.0) # Orthogonality holds in a trivial sense.\n                continue\n            \n            h_hat = h_vec / h_norm\n\n            # 3. Calculate the angle theta between g_hat and h_hat\n            dot_product = np.dot(g_hat, h_hat)\n            \n            # Clamp the dot product to the valid range for arccos [-1, 1]\n            clamped_dot = np.clip(dot_product, -1.0, 1.0)\n            \n            theta = np.arccos(clamped_dot)\n            \n            # 4. Calculate the deviation from pi/2\n            deviation = np.abs(theta - np.pi / 2.0)\n            deviations.append(deviation)\n\n        # 5. Find the maximum deviation for the current test case.\n        # Filter out potential NaNs if any error occurred, though not expected here.\n        valid_deviations = [d for d in deviations if not np.isnan(d)]\n        if not valid_deviations:\n            max_deviation = 0.0\n        else:\n            max_deviation = np.max(valid_deviations)\n            \n        final_results.append(max_deviation)\n\n    # Print results in the required format\n    print(f\"[{','.join(map(str, final_results))}]\")\n\nsolve()\n\n```", "id": "2890547"}]}