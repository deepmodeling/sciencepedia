{"hands_on_practices": [{"introduction": "This first practice takes us back to a cornerstone of quantum mechanics: the one-dimensional harmonic oscillator. By applying a static electric field, we can use time-independent perturbation theory to derive an exact analytical expression for the static polarizability, $\\alpha$. This exercise not only reinforces fundamental theoretical skills but also demonstrates a powerful and general principle: how the inherent symmetry of a system dictates which electrical response properties are allowed to be non-zero [@problem_id:2915753].", "problem": "Consider a single particle of charge $q$ and mass $m$ moving along one spatial coordinate $x$ in the harmonic potential $V_{0}(x)=\\tfrac{1}{2} m \\omega^{2} x^{2}$. A uniform, static electric field of magnitude $F$ is applied along the $x$ direction, so that the total Hamiltonian is $H(F)=H_{0}+V(F)$ with $H_{0}=\\tfrac{p^{2}}{2m}+\\tfrac{1}{2} m \\omega^{2} x^{2}$ and $V(F)=-q F x$. Work in the electric dipole approximation and assume nondegenerate stationary states. \n\nStarting from the time-independent SchrÃ¶dinger equation and nondegenerate time-independent perturbation theory, and using only foundational definitions, do the following tasks:\n- Derive the static (zero-frequency) linear polarizability $\\alpha$ of the ground state from the field dependence of the ground-state energy. Your derivation must begin from the definition of $\\alpha$ as the second derivative of the ground-state energy with respect to the field at zero field, and proceed by systematic perturbation in $F$.\n- Using the inversion symmetry of the unperturbed potential, prove that all odd-order static hyperpolarizabilities vanish for this system.\n\nExpress your final result for the static polarizability as a closed-form analytic expression in terms of $q$, $m$, and $\\omega$. Use International System of Units (SI) conventions for the physical quantities, but do not substitute numerical values. Report as your final answer only the expression you obtain for $\\alpha$. No rounding is required and no numerical evaluation is needed.", "solution": "The problem statement has been subjected to rigorous validation.\n\n**Givens:**\n1.  System: A particle of charge $q$ and mass $m$ in one dimension $x$.\n2.  Unperturbed Hamiltonian: $H_{0}=\\tfrac{p^{2}}{2m}+\\tfrac{1}{2} m \\omega^{2} x^{2}$.\n3.  Perturbation: $V(F)=-q F x$ from a uniform, static electric field $F$.\n4.  Total Hamiltonian: $H(F)=H_{0}+V(F)$.\n5.  State: The ground state of the system, which is nondegenerate for $H_0$.\n6.  Definition of polarizability: $\\alpha = -\\frac{\\partial^2 E_0(F)}{\\partial F^2}|_{F=0}$, where $E_0(F)$ is the ground-state energy in the presence of the field.\n7.  Tasks: (i) Derive the static linear polarizability $\\alpha$. (ii) Prove that all odd-order static hyperpolarizabilities vanish.\n\n**Validation Verdict:**\nThe problem is scientifically grounded, as it describes the canonical quantum harmonic oscillator under a static electric field, a fundamental model in quantum mechanics. It is well-posed, with all necessary components defined, and objective in its language. The assumptions are consistent. The problem is therefore deemed **valid**, and we may proceed to the solution.\n\nThe solution is divided into two parts as requested.\n\n**Part 1: Derivation of the Static Linear Polarizability $\\alpha$**\n\nWe begin with the definition of the static polarizability of the ground state, denoted $|0\\rangle$, as a function of its energy $E_0(F)$:\n$$\n\\alpha = -\\left.\\frac{\\partial^2 E_0(F)}{\\partial F^2}\\right|_{F=0}\n$$\nTo evaluate this, we use nondegenerate time-independent perturbation theory to find the ground state energy as a power series in the electric field strength $F$. The perturbation Hamiltonian is $V = -qFx$. The ground-state energy $E_0(F)$ is expanded as:\n$$\nE_0(F) = E_0^{(0)} + E_0^{(1)} + E_0^{(2)} + \\dots\n$$\nwhere $E_0^{(k)}$ is the $k$-th order correction to the energy. The unperturbed ground-state energy is $E_0^{(0)} = \\frac{1}{2}\\hbar\\omega$.\n\nThe first-order energy correction is given by the expectation value of the perturbation in the unperturbed ground state $|0\\rangle$:\n$$\nE_0^{(1)} = \\langle 0 | V | 0 \\rangle = \\langle 0 | -qFx | 0 \\rangle = -qF \\langle 0 | x | 0 \\rangle\n$$\nFor the quantum harmonic oscillator, the eigenstates have definite parity. The ground state wavefunction $\\psi_0^{(0)}(x)$ is an even function. The position operator $x$ is an odd operator. The expectation value $\\langle 0 | x | 0 \\rangle$ is the integral of the product $\\psi_0^{(0)*} x \\psi_0^{(0)}$, which is an odd function, over a symmetric interval $(-\\infty, \\infty)$. This integral is identically zero. Therefore:\n$$\nE_0^{(1)} = 0\n$$\n\nThe second-order energy correction is given by:\n$$\nE_0^{(2)} = \\sum_{k \\neq 0} \\frac{|\\langle k | V | 0 \\rangle|^2}{E_0^{(0)} - E_k^{(0)}}\n$$\nSubstituting $V = -qFx$ and factoring out the field-dependent terms, we have:\n$$\nE_0^{(2)} = (-qF)^2 \\sum_{k \\neq 0} \\frac{|\\langle k | x | 0 \\rangle|^2}{E_0^{(0)} - E_k^{(0)}} = q^2 F^2 \\sum_{k \\neq 0} \\frac{|\\langle k | x | 0 \\rangle|^2}{E_0^{(0)} - E_k^{(0)}}\n$$\nTo evaluate the matrix elements $\\langle k | x | 0 \\rangle$, we express the position operator $x$ in terms of the annihilation ($a$) and creation ($a^\\dagger$) operators:\n$$\nx = \\sqrt{\\frac{\\hbar}{2m\\omega}}(a + a^\\dagger)\n$$\nThe action of these operators on the ground state $|0\\rangle$ is $a|0\\rangle = 0$ and $a^\\dagger|0\\rangle = |1\\rangle$. Thus, the matrix element is:\n$$\n\\langle k | x | 0 \\rangle = \\sqrt{\\frac{\\hbar}{2m\\omega}} \\langle k | a + a^\\dagger | 0 \\rangle = \\sqrt{\\frac{\\hbar}{2m\\omega}} (\\langle k | a | 0 \\rangle + \\langle k | a^\\dagger | 0 \\rangle) = \\sqrt{\\frac{\\hbar}{2m\\omega}} \\langle k | 1 \\rangle\n$$\nThis matrix element is non-zero only for $k=1$, due to the orthogonality condition $\\langle k | 1 \\rangle = \\delta_{k1}$. The sum for $E_0^{(2)}$ collapses to a single term:\n$$\nE_0^{(2)} = q^2 F^2 \\frac{|\\langle 1 | x | 0 \\rangle|^2}{E_0^{(0)} - E_1^{(0)}}\n$$\nThe unperturbed energy levels are $E_n^{(0)} = (n + \\frac{1}{2})\\hbar\\omega$. Thus, $E_0^{(0)} = \\frac{1}{2}\\hbar\\omega$ and $E_1^{(0)} = \\frac{3}{2}\\hbar\\omega$. The energy denominator is $E_0^{(0)} - E_1^{(0)} = -\\hbar\\omega$. The squared matrix element is $|\\langle 1 | x | 0 \\rangle|^2 = \\left(\\sqrt{\\frac{\\hbar}{2m\\omega}}\\right)^2 = \\frac{\\hbar}{2m\\omega}$.\nSubstituting these results gives the second-order energy correction:\n$$\nE_0^{(2)} = q^2 F^2 \\frac{\\frac{\\hbar}{2m\\omega}}{-\\hbar\\omega} = -\\frac{q^2 F^2}{2m\\omega^2}\n$$\nThe ground state energy, up to second order in $F$, is:\n$$\nE_0(F) \\approx E_0^{(0)} + E_0^{(1)} + E_0^{(2)} = \\frac{1}{2}\\hbar\\omega + 0 - \\frac{q^2 F^2}{2m\\omega^2}\n$$\nNow, we compute the polarizability from its definition:\n$$\n\\frac{\\partial E_0(F)}{\\partial F} \\approx -\\frac{q^2 F}{m\\omega^2}\n$$\n$$\n\\frac{\\partial^2 E_0(F)}{\\partial F^2} \\approx -\\frac{q^2}{m\\omega^2}\n$$\nThe second derivative is constant, so taking the limit at $F=0$ is trivial.\n$$\n\\alpha = -\\left.\\frac{\\partial^2 E_0(F)}{\\partial F^2}\\right|_{F=0} = - \\left( -\\frac{q^2}{m\\omega^2} \\right) = \\frac{q^2}{m\\omega^2}\n$$\nIt is noteworthy that for the harmonic oscillator, this result is exact. The complete Hamiltonian $H(F)$ can be solved exactly by completing the square, which reveals that the energy eigenvalues have a purely quadratic dependence on $F$. Consequently, all perturbation corrections $E_0^{(k)}$ for $k > 2$ are identically zero.\n\n**Part 2: Vanishing of Odd-Order Static Hyperpolarizabilities**\n\nOdd-order static hyperpolarizabilities (e.g., $\\beta$, $\\delta$, ...) are defined through odd-order derivatives of the energy with respect to the field, evaluated at zero field. For example, $\\beta = -\\frac{\\partial^3 E_0(F)}{\\partial F^3}|_{F=0}$. We will prove that all such quantities are zero.\n\nThe proof relies on the symmetry properties of the Hamiltonian.\n1.  The unperturbed Hamiltonian $H_0 = \\frac{p^2}{2m} + \\frac{1}{2}m\\omega^2 x^2$ is invariant under the parity transformation $\\mathcal{P}$, which in one dimension means $x \\to -x$ and $p \\to -p$. Both the kinetic energy term ($p^2$) and the potential energy term ($x^2$) are even functions of their respective operators. Thus, $[H_0, \\mathcal{P}] = 0$.\n2.  The perturbation $V(F) = -qFx$ is an odd function of $x$.\n3.  Consider the total Hamiltonian for a field $-F$, which is $H(-F) = H_0 + qFx$. Let us apply the parity operator $\\mathcal{P}$ to $H(-F)$ via a similarity transformation:\n$$\n\\mathcal{P} H(-F) \\mathcal{P}^{-1} = \\mathcal{P} (H_0 + qFx) \\mathcal{P}^{-1} = \\mathcal{P}H_0\\mathcal{P}^{-1} + qF (\\mathcal{P}x\\mathcal{P}^{-1})\n$$\nSince $[H_0, \\mathcal{P}]=0$, $\\mathcal{P}H_0\\mathcal{P}^{-1} = H_0$. The position operator transforms as $\\mathcal{P}x\\mathcal{P}^{-1} = -x$. Therefore:\n$$\n\\mathcal{P} H(-F) \\mathcal{P}^{-1} = H_0 - qFx = H(F)\n$$\nThis shows that the Hamiltonians $H(F)$ and $H(-F)$ are unitarily equivalent. Unitarily equivalent operators have identical eigenvalue spectra.\n4.  Let the set of energy eigenvalues of $H(F)$ be $\\{ E_n(F) \\}$. Then we must have $\\{ E_n(F) \\} = \\{ E_n(-F) \\}$.\n5.  The problem states that the stationary states of the unperturbed system are nondegenerate. For small field strengths $F$, this nondegeneracy is preserved. Therefore, the ordering of states is maintained, which implies $E_n(F) = E_n(-F)$ for each individual state $n$.\n6.  The ground state energy $E_0(F)$ must therefore be an even function of the field strength $F$.\n7.  A function that is even, $f(z) = f(-z)$, can only have even powers in its Taylor series expansion around $z=0$: $f(z) = \\sum_{j=0}^{\\infty} c_{2j} z^{2j}$.\n8.  Consequently, the expansion of $E_0(F)$ around $F=0$ must take the form:\n$$\nE_0(F) = E_0^{(0)} + c_2 F^2 + c_4 F^4 + \\dots\n$$\nAll coefficients of odd powers of $F$ must be zero.\n9.  The odd-order hyperpolarizabilities are defined by odd-order derivatives of $E_0(F)$ at $F=0$. For any odd integer $2k+1$ (with $k \\geq 0$):\n$$\n\\left.\\frac{\\partial^{2k+1} E_0(F)}{\\partial F^{2k+1}}\\right|_{F=0} = 0\n$$\nThis proves that all odd-order static hyperpolarizabilities of the ground state are zero. This is a general result for any system with a center of inversion symmetry in its unperturbed state.", "answer": "$$\n\\boxed{\\frac{q^2}{m\\omega^2}}\n$$", "id": "2915753"}, {"introduction": "While analytical models are instructive, most real-world calculations of molecular properties rely on numerical methods. This practice introduces the widely used finite-field technique, where response properties are extracted by fitting the molecule's energy as a function of an applied electric field. Your task is to connect the coefficients of a polynomial fit to the static second hyperpolarizability, $\\gamma_{zzzz}$, and, critically, to derive the statistical uncertainty in this value [@problem_id:2915758]. This exercise moves beyond pure theory to the practical and essential skills of data analysis and error propagation in computational chemistry.", "problem": "In atomic units, consider a nondegenerate electronic ground state of a fixed-geometry molecule subjected to a static, spatially uniform electric field applied along the $z$ axis, denoted $F_{z}$. Within the BornâOppenheimer (BO) approximation and time-independent RayleighâSchrÃ¶dinger (RS) perturbation theory, the field-dependent electronic Hamiltonian can be written as $H(F_{z}) = H_{0} - \\mu_{z} F_{z}$, where $\\mu_{z}$ is the $z$ component of the electric dipole moment operator. Assume the exact ground-state energy $E(F_{z})$ is analytic in a neighborhood of $F_{z}=0$.\n\nYou perform $N$ single-point electronic energy calculations at field values $\\{F_{k}\\}_{k=1}^{N}$ in a neighborhood of $F_{z}=0$ (including positive and negative fields), and you fit these data by ordinary least squares (OLS) to the quartic model\n$$\nE(F_{z}) \\approx a_{0} + a_{1} F_{z} + a_{2} F_{z}^{2} + a_{3} F_{z}^{3} + a_{4} F_{z}^{4}.\n$$\nLet $X$ be the $N \\times 5$ design matrix whose $k$th row is $\\big(1,\\,F_{k},\\,F_{k}^{2},\\,F_{k}^{3},\\,F_{k}^{4}\\big)$, and let the residual vector be $r = y - X \\hat{a}$, where $y$ collects the computed energies and $\\hat{a}$ is the OLS estimator of the coefficient vector $a = (a_{0},a_{1},a_{2},a_{3},a_{4})^{\\top}$. Assume that the energy errors are independent, identically distributed, Gaussian with zero mean and variance $\\sigma^{2}$, and define the residual sum of squares (RSS) as $\\mathrm{RSS} = r^{\\top} r$. Let $p=5$ be the number of fitted parameters, and let the unbiased estimator of the noise variance be $s^{2} = \\mathrm{RSS}/(N-p)$.\n\nUsing only the field-derivative definition of electric response tensors from RS perturbation theory and standard linear regression theory for OLS under homoscedastic Gaussian noise:\n\n1. Derive how to extract the static second hyperpolarizability component $\\gamma_{zzzz}(0;0,0,0)$ from the quartic coefficient $a_{4}$ of the fit. Your result must make explicit the overall sign and the exact multiplicative constant relating $\\gamma_{zzzz}(0;0,0,0)$ to $a_{4}$.\n\n2. Derive a closed-form expression for the standard uncertainty (standard error) of the estimate of $\\gamma_{zzzz}(0;0,0,0)$ in terms of $\\mathrm{RSS}$, $N$, and the design matrix $X$. Express your result using the $(5,5)$ element of the matrix $(X^{\\top} X)^{-1}$. Give the standard uncertainty as the positive square root of the variance.\n\nUse atomic units throughout. Express your final answer as a row matrix with two entries: the first entry is the expression for $\\gamma_{zzzz}(0;0,0,0)$ in terms of $a_{4}$, and the second entry is the expression for its standard uncertainty in terms of $\\mathrm{RSS}$, $N$, and $X$. No numerical rounding is required.", "solution": "The problem statement is subjected to validation before a solution is attempted.\n\n### Step 1: Extract Givens\n- **System**: A molecule with a nondegenerate electronic ground state and fixed geometry in the BornâOppenheimer (BO) approximation.\n- **Perturbation**: A static, spatially uniform electric field $F_{z}$ applied along the $z$ axis.\n- **Hamiltonian**: The field-dependent electronic Hamiltonian is $H(F_{z}) = H_{0} - \\mu_{z} F_{z}$, where $\\mu_{z}$ is the $z$ component of the electric dipole moment operator.\n- **Energy**: The ground-state energy $E(F_{z})$ is assumed to be an analytic function in a neighborhood of $F_{z}=0$.\n- **Data and Model**: $N$ energy calculations $\\{E_k\\}$ at field strengths $\\{F_{k}\\}_{k=1}^{N}$ are fitted by ordinary least squares (OLS) to the quartic model $E(F_{z}) \\approx a_{0} + a_{1} F_{z} + a_{2} F_{z}^{2} + a_{3} F_{z}^{3} + a_{4} F_{z}^{4}$.\n- **Linear Regression Parameters**:\n    - The design matrix $X$ is an $N \\times 5$ matrix with the $k$-th row being $\\big(1,\\,F_{k},\\,F_{k}^{2},\\,F_{k}^{3},\\,F_{k}^{4}\\big)$.\n    - The coefficient vector is $a = (a_{0},a_{1},a_{2},a_{3},a_{4})^{\\top}$ and its OLS estimator is $\\hat{a}$. The problem denotes the estimated coefficient as $a_4$.\n    - The number of parameters is $p=5$.\n- **Statistical Assumptions**:\n    - Energy errors are independent, identically distributed (i.i.d.) Gaussian random variables with zero mean and variance $\\sigma^{2}$.\n    - The residual sum of squares is $\\mathrm{RSS} = r^{\\top} r$, where $r = y - X \\hat{a}$.\n    - An unbiased estimator of the noise variance is $s^{2} = \\mathrm{RSS}/(N-p)$.\n- **Tasks**:\n    1.  Derive the relationship between the static second hyperpolarizability component $\\gamma_{zzzz}(0;0,0,0)$ and the fitted coefficient $a_{4}$, including the sign and multiplicative constant.\n    2.  Derive the standard uncertainty of the estimate of $\\gamma_{zzzz}(0;0,0,0)$ in terms of $\\mathrm{RSS}$, $N$, and the $(5,5)$ element of the matrix $(X^{\\top} X)^{-1}$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem describes the finite-field method for calculating molecular electric properties, a standard technique in computational quantum chemistry. The physical model (BO approximation, RS perturbation theory), the mathematical formulation (Taylor series expansion of energy), and the statistical analysis (OLS regression) are all sound and correctly integrated.\n\n- **Scientifically Grounded**: The problem is firmly rooted in established principles of quantum mechanics and statistical theory. The Hamiltonian, the perturbation, and the concept of polarizabilities as energy derivatives are fundamental.\n- **Well-Posed**: The problem is clearly stated, providing all necessary information to derive the requested expressions. The objectives are specific and admit a unique solution.\n- **Objective**: The language is precise, technical, and free of any subjectivity or ambiguity.\n\nThe problem does not exhibit any flaws such as scientific unsoundness, incompleteness, contradiction, or infeasibility. It is a well-posed problem that tests the connection between physical theory and data analysis methodology.\n\n### Step 3: Verdict and Action\nThe problem is valid. A complete solution will now be derived.\n\n### Derivation\n\nThe solution is presented in two parts as requested by the problem statement. All calculations are performed in atomic units.\n\n**Part 1: Extraction of the Second Hyperpolarizability $\\gamma_{zzzz}(0;0,0,0)$**\n\nThe energy of the molecule in the presence of the static electric field $F_{z}$, $E(F_{z})$, can be expanded as a Taylor series around $F_{z}=0$:\n$$\nE(F_{z}) = E(0) + \\left(\\frac{\\partial E}{\\partial F_{z}}\\right)_{F_{z}=0} F_{z} + \\frac{1}{2!} \\left(\\frac{\\partial^{2} E}{\\partial F_{z}^{2}}\\right)_{F_{z}=0} F_{z}^{2} + \\frac{1}{3!} \\left(\\frac{\\partial^{3} E}{\\partial F_{z}^{3}}\\right)_{F_{z}=0} F_{z}^{3} + \\frac{1}{4!} \\left(\\frac{\\partial^{4} E}{\\partial F_{z}^{4}}\\right)_{F_{z}=0} F_{z}^{4} + O(F_{z}^{5})\n$$\nThe problem states that the field-derivative definition of electric response tensors should be used. For a static field along the $z$ axis, the permanent dipole moment ($\\mu_{z}$), polarizability ($\\alpha_{zz}$), first hyperpolarizability ($\\beta_{zzz}$), and second hyperpolarizability ($\\gamma_{zzzz}$) are defined as follows:\n$$\n\\mu_{z} = -\\left(\\frac{\\partial E}{\\partial F_{z}}\\right)_{F_{z}=0}\n$$\n$$\n\\alpha_{zz} = -\\left(\\frac{\\partial^{2} E}{\\partial F_{z}^{2}}\\right)_{F_{z}=0}\n$$\n$$\n\\beta_{zzz} = -\\left(\\frac{\\partial^{3} E}{\\partial F_{z}^{3}}\\right)_{F_{z}=0}\n$$\n$$\n\\gamma_{zzzz}(0;0,0,0) = -\\left(\\frac{\\partial^{4} E}{\\partial F_{z}^{4}}\\right)_{F_{z}=0}\n$$\nThe notation $\\gamma_{zzzz}(0;0,0,0)$ explicitly denotes a static property, which is consistent with the use of a static field $F_z$. Substituting these definitions into the Taylor series for the energy gives:\n$$\nE(F_{z}) = E(0) - \\mu_{z} F_{z} - \\frac{1}{2!} \\alpha_{zz} F_{z}^{2} - \\frac{1}{3!} \\beta_{zzz} F_{z}^{3} - \\frac{1}{4!} \\gamma_{zzzz}(0;0,0,0) F_{z}^{4} + O(F_{z}^{5})\n$$\nThe problem involves fitting the computed energies to the quartic model:\n$$\nE(F_{z}) \\approx a_{0} + a_{1} F_{z} + a_{2} F_{z}^{2} + a_{3} F_{z}^{3} + a_{4} F_{z}^{4}\n$$\nBy comparing the coefficients of the powers of $F_{z}$ in the theoretical Taylor expansion and the fitted polynomial, we can associate the fitted coefficients $\\{a_i\\}$ with the physical properties. Specifically, for the coefficient of the $F_{z}^{4}$ term, we have:\n$$\na_{4} \\approx \\frac{1}{4!} \\left(\\frac{\\partial^{4} E}{\\partial F_{z}^{4}}\\right)_{F_{z}=0}\n$$\nUsing the definition of the second hyperpolarizability, this becomes:\n$$\na_{4} \\approx -\\frac{1}{4!} \\gamma_{zzzz}(0;0,0,0)\n$$\nSince $4! = 24$, we have $a_{4} \\approx -\\frac{1}{24} \\gamma_{zzzz}(0;0,0,0)$.\nTherefore, the estimate for the second hyperpolarizability component, here denoted $\\gamma_{zzzz}(0;0,0,0)$, can be extracted from the fitted coefficient $a_{4}$ as:\n$$\n\\gamma_{zzzz}(0;0,0,0) = -24 a_{4}\n$$\nThe multiplicative constant is $-24$.\n\n**Part 2: Standard Uncertainty of the Estimate of $\\gamma_{zzzz}(0;0,0,0)$**\n\nThis part requires results from the theory of ordinary least squares (OLS) regression. The vector of estimated coefficients, $\\hat{a}$, has a covariance matrix given by:\n$$\n\\mathrm{Cov}(\\hat{a}) = \\sigma^{2} (X^{\\top} X)^{-1}\n$$\nwhere $\\sigma^{2}$ is the true variance of the errors in the energy calculations. Since $\\sigma^{2}$ is unknown, it is replaced by its unbiased estimator $s^{2} = \\frac{\\mathrm{RSS}}{N-p}$, where $p=5$ is the number of fitted parameters. The estimated covariance matrix of $\\hat{a}$ is therefore:\n$$\n\\widehat{\\mathrm{Cov}}(\\hat{a}) = s^{2} (X^{\\top} X)^{-1} = \\frac{\\mathrm{RSS}}{N-5} (X^{\\top} X)^{-1}\n$$\nThe variance of a specific coefficient estimate, $\\hat{a}_{j}$, is the corresponding diagonal element of this matrix. For the coefficient $\\hat{a}_{4}$ (the fifth coefficient, corresponding to the index $j=5$), the estimated variance is:\n$$\n\\widehat{\\mathrm{Var}}(\\hat{a}_{4}) = \\frac{\\mathrm{RSS}}{N-5} \\left[ (X^{\\top} X)^{-1} \\right]_{55}\n$$\nwhere $\\left[ (X^{\\top} X)^{-1} \\right]_{55}$ denotes the $(5,5)$ element of the matrix $(X^{\\top} X)^{-1}$.\n\nFrom Part 1, the estimate of the hyperpolarizability, denoted $\\hat{\\gamma}_{zzzz}$, is related to the estimate of the coefficient, $\\hat{a}_{4}$, by a constant factor:\n$$\n\\hat{\\gamma}_{zzzz}(0;0,0,0) = -24 \\hat{a}_{4}\n$$\nThe variance of a random variable scaled by a constant $c$ is given by the rule $\\mathrm{Var}(cZ) = c^{2}\\mathrm{Var}(Z)$. Applying this rule to find the estimated variance of $\\hat{\\gamma}_{zzzz}(0;0,0,0)$:\n$$\n\\widehat{\\mathrm{Var}}(\\hat{\\gamma}_{zzzz}(0;0,0,0)) = \\widehat{\\mathrm{Var}}(-24 \\hat{a}_{4}) = (-24)^{2} \\widehat{\\mathrm{Var}}(\\hat{a}_{4}) = 576 \\, \\widehat{\\mathrm{Var}}(\\hat{a}_{4})\n$$\nSubstituting the expression for $\\widehat{\\mathrm{Var}}(\\hat{a}_{4})$:\n$$\n\\widehat{\\mathrm{Var}}(\\hat{\\gamma}_{zzzz}(0;0,0,0)) = 576 \\left( \\frac{\\mathrm{RSS}}{N-5} \\right) \\left[ (X^{\\top} X)^{-1} \\right]_{55}\n$$\nThe standard uncertainty, often denoted as the standard error, is the positive square root of the estimated variance. Let this be $u(\\hat{\\gamma}_{zzzz})$.\n$$\nu(\\hat{\\gamma}_{zzzz}(0;0,0,0)) = \\sqrt{\\widehat{\\mathrm{Var}}(\\hat{\\gamma}_{zzzz}(0;0,0,0))} = \\sqrt{576 \\frac{\\mathrm{RSS}}{N-5} \\left[ (X^{\\top} X)^{-1} \\right]_{55}}\n$$\n$$\nu(\\hat{\\gamma}_{zzzz}(0;0,0,0)) = 24 \\sqrt{\\frac{\\mathrm{RSS}}{N-5} \\left[ (X^{\\top} X)^{-1} \\right]_{55}}\n$$\nThis expression provides the standard uncertainty of the hyperpolarizability estimate in terms of the specified quantities.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n-24 a_{4} & 24 \\sqrt{\\frac{\\mathrm{RSS}}{N-5} \\left[ (X^{\\top} X)^{-1} \\right]_{55}}\n\\end{pmatrix}\n}\n$$", "id": "2915758"}, {"introduction": "This final practice provides a deep dive into the practical realities of computational chemistry by asking you to implement and compare two different methods for calculating the static polarizability, $\\alpha$. You will write code to perform both a sum-over-states \"analytic\" calculation and a finite-field numerical calculation for a model anharmonic system. By comparing the results from these methods against a highly-converged benchmark, you will learn to distinguish and quantify two fundamental sources of error: the physical approximation of a finite basis set and the numerical error of the finite-difference approximation [@problem_id:2915784]. This hands-on comparison is key to developing a critical eye for the accuracy and reliability of computational results.", "problem": "Consider a one-electron model for the component of the electronic motion along an external static electric field in a small molecule. Work in atomic units (a.u.) throughout. The effective one-dimensional Hamiltonian in the presence of a uniform electric field of magnitude $F$ along the $x$-axis is\n$$\n\\hat{H}(F) = \\frac{\\hat{p}^2}{2} + \\frac{1}{2}\\,\\omega^2 \\hat{x}^2 + \\lambda \\hat{x}^4 - F \\hat{x},\n$$\nwith physical parameters $\\omega$ and $\\lambda$ being fixed, real, positive constants. The static dipole polarizability $\\alpha$ is defined by the second derivative of the exact ground-state energy $E(F)$ with respect to $F$ at $F=0$ via the series $E(F) = E(0) - \\mu F - \\tfrac{1}{2}\\alpha F^2 - \\cdots$, so that $\\alpha = -\\left.\\dfrac{d^2 E}{dF^2}\\right|_{F=0}$.\n\nYour task is to implement two independent computations of $\\alpha$ for this Hamiltonian using a truncated harmonic oscillator basis and to compare the results:\n- An \"analytic derivative\" value from stationary-state linear response grounded in second-order RayleighâSchrÃ¶dinger perturbation theory about $F=0$ using the eigenstates and eigenvalues of $\\hat{H}(0)$ in the chosen truncated basis.\n- A \"finite-field\" estimate using a central second-order finite difference of the ground-state energies $E(F)$ computed by exact diagonalization in the same truncated basis.\n\nTo construct the truncated basis and Hamiltonian matrix, proceed as follows without assuming any black-box formulas not derived from first principles. Use the number states $\\{\\lvert n \\rangle\\}_{n=0}^{N-1}$ of a reference harmonic oscillator with basis frequency $\\omega_b$ as your orthonormal basis. Use the ladder operators $\\hat{a}$ and $\\hat{a}^\\dagger$ satisfying $[\\hat{a},\\hat{a}^\\dagger]=1$, and express $\\hat{x}$ and $\\hat{p}$ in terms of $\\hat{a}$ and $\\hat{a}^\\dagger$. Use these to build the matrix representation of $\\hat{x}$, then form $\\hat{x}^2$ and $\\hat{x}^4$ by explicit matrix multiplication. Let $\\hat{H}_b = \\omega_b\\left(\\hat{a}^\\dagger \\hat{a} + \\tfrac{1}{2}\\right)$ denote the basis harmonic oscillator Hamiltonian. Use the identity $\\tfrac{\\hat{p}^2}{2} = \\hat{H}_b - \\tfrac{1}{2}\\,\\omega_b^2 \\hat{x}^2$ to assemble the field-free Hamiltonian matrix for given physical parameters $\\omega$ and $\\lambda$ in the truncated basis as\n$$\n\\hat{H}(0) = \\hat{H}_b + \\frac{1}{2}\\left(\\omega^2 - \\omega_b^2\\right)\\hat{x}^2 + \\lambda \\hat{x}^4,\n$$\nand the field-perturbed Hamiltonian as\n$$\n\\hat{H}(F) = \\hat{H}(0) - F \\hat{x}.\n$$\n\nCompute the \"analytic derivative\" polarizability by applying time-independent second-order perturbation theory (equivalently, stationary-state linear response theory) at $F=0$ in terms of the eigenpairs of $\\hat{H}(0)$ within the truncated basis. Compute the \"finite-field\" polarizability as the negative of the second central finite difference quotient of the ground-state energy of $\\hat{H}(F)$ at $\\pm F$ and $0$. To analyze discrepancies, also compute a highly converged reference polarizability $\\alpha_{\\mathrm{ref}}$ by using the same \"analytic derivative\" procedure but with a much larger basis size $N_{\\mathrm{ref}}$.\n\nUse the following fixed physical parameters and basis frequency in atomic units: $\\omega = 0.7$, $\\lambda = 0.02$, and $\\omega_b = 0.7$. Use the following test suite of basis sizes $N$ and finite-field step sizes $F$:\n- Test $1$: $N=12$, $F=10^{-3}$.\n- Test $2$: $N=12$, $F=5\\times 10^{-2}$.\n- Test $3$: $N=4$, $F=10^{-3}$.\n- Test $4$: $N=8$, $F=10^{-5}$.\n- Test $5$: $N=20$, $F=10^{-3}$.\n\nUse $N_{\\mathrm{ref}} = 100$ to define $\\alpha_{\\mathrm{ref}}$.\n\nFor each test case, produce two floats:\n- $\\Delta_{\\mathrm{FF}} = \\alpha_{\\mathrm{analytic}}(N) - \\alpha_{\\mathrm{finite\\text{-}field}}(N,F)$, which isolates the numerical differentiation error for the given $F$ at fixed $N$.\n- $\\Delta_{\\mathrm{basis}} = \\alpha_{\\mathrm{ref}} - \\alpha_{\\mathrm{analytic}}(N)$, which isolates the basis set incompleteness error at $F=0$.\n\nExpress all outputs in atomic units. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets in the order\n$$\n[\\Delta_{\\mathrm{FF}}^{(1)}, \\Delta_{\\mathrm{basis}}^{(1)}, \\Delta_{\\mathrm{FF}}^{(2)}, \\Delta_{\\mathrm{basis}}^{(2)}, \\ldots, \\Delta_{\\mathrm{FF}}^{(5)}, \\Delta_{\\mathrm{basis}}^{(5)}].\n$$", "solution": "The problem as stated is a scientifically sound and well-posed exercise in computational quantum chemistry. It requires the calculation of the static dipole polarizability for a one-dimensional anharmonic oscillator model using two standard methodsâperturbation theory and the finite-field approachâwithin a truncated basis set. All parameters and procedures are clearly defined, permitting a unique and verifiable solution. We shall proceed with the derivation and implementation.\n\nThe physical system is described by the Hamiltonian in atomic units:\n$$\n\\hat{H}(F) = \\frac{\\hat{p}^2}{2} + \\frac{1}{2}\\,\\omega^2 \\hat{x}^2 + \\lambda \\hat{x}^4 - F \\hat{x}\n$$\nwhere $F$ is the magnitude of a static electric field. The static polarizability, $\\alpha$, is defined through the Taylor expansion of the ground-state energy $E(F)$ about $F=0$:\n$$\nE(F) = E(0) - \\mu F - \\frac{1}{2}\\alpha F^2 + \\mathcal{O}(F^3)\n$$\nFrom this, it is clear that $\\alpha = -\\left.\\dfrac{d^2 E}{dF^2}\\right|_{F=0}$. Our task is to compute $\\alpha$ using a truncated basis of dimension $N$.\n\n**1. Basis Set and Operator Representation**\n\nWe use a truncated basis consisting of the first $N$ number states, $\\{\\lvert n \\rangle\\}_{n=0}^{N-1}$, of a reference harmonic oscillator with frequency $\\omega_b$. These states are orthonormal, $\\langle m | n \\rangle = \\delta_{mn}$.\n\nThe position operator $\\hat{x}$ is expressed in terms of the ladder operators $\\hat{a}$ and $\\hat{a}^\\dagger$ of this reference oscillator:\n$$\n\\hat{x} = \\sqrt{\\frac{1}{2\\omega_b}} (\\hat{a} + \\hat{a}^\\dagger)\n$$\nThe matrix elements of the ladder operators in this basis are well-known:\n$$\n\\langle m | \\hat{a} | n \\rangle = \\sqrt{n}\\,\\delta_{m,n-1}\n$$\n$$\n\\langle m | \\hat{a}^\\dagger | n \\rangle = \\sqrt{n+1}\\,\\delta_{m,n+1}\n$$\nFrom these, we construct the $N \\times N$ matrix representations of $\\hat{a}$ and $\\hat{a}^\\dagger$, and subsequently the matrix $\\mathbf{X}$ for $\\hat{x}$.\n\n**2. Hamiltonian Matrix Construction**\n\nThe kinetic energy operator $\\frac{\\hat{p}^2}{2}$ is related to the reference harmonic oscillator Hamiltonian $\\hat{H}_b = \\omega_b(\\hat{a}^\\dagger\\hat{a} + \\frac{1}{2})$ by the identity $\\frac{\\hat{p}^2}{2} = \\hat{H}_b - \\frac{1}{2}\\omega_b^2 \\hat{x}^2$. Substituting this into the expression for the field-free Hamiltonian $\\hat{H}(0)$ yields:\n$$\n\\hat{H}(0) = \\left(\\hat{H}_b - \\frac{1}{2}\\omega_b^2 \\hat{x}^2\\right) + \\frac{1}{2}\\omega^2 \\hat{x}^2 + \\lambda \\hat{x}^4 = \\hat{H}_b + \\frac{1}{2}(\\omega^2 - \\omega_b^2)\\hat{x}^2 + \\lambda \\hat{x}^4\n$$\nThe problem specifies $\\omega = \\omega_b = 0.7$ a.u., which simplifies the expression significantly to:\n$$\n\\hat{H}(0) = \\hat{H}_b + \\lambda \\hat{x}^4\n$$\nThe matrix for $\\hat{H}_b$, denoted $\\mathbf{H}_b$, is diagonal in the number basis, with elements $(\\mathbf{H}_b)_{nn} = \\omega_b(n + \\frac{1}{2})$. The matrix for $\\hat{x}^4$, denoted $\\mathbf{X}^4$, is obtained by explicit matrix multiplication of $\\mathbf{X}$ with itself four times. Thus, the field-free Hamiltonian matrix is $\\mathbf{H}(0) = \\mathbf{H}_b + \\lambda \\mathbf{X}^4$. The full Hamiltonian in the presence of the field $F$ is then represented by the matrix:\n$$\n\\mathbf{H}(F) = \\mathbf{H}(0) - F\\mathbf{X}\n$$\nAs these matrices are real and symmetric, their eigenvalues are real and their eigenvectors form an orthonormal basis.\n\n**3. Analytic Derivative Polarizability: $\\alpha_{\\mathrm{analytic}}(N)$**\n\nThis approach uses time-independent, non-degenerate Rayleigh-SchrÃ¶dinger perturbation theory. We consider $\\hat{H}(0)$ as the unperturbed Hamiltonian and $\\hat{V} = -F\\hat{x}$ as the perturbation. The second-order correction to the ground-state energy $E_0^{(0)}$ is given by:\n$$\nE^{(2)} = \\sum_{k \\neq 0} \\frac{|\\langle\\psi_k^{(0)}| \\hat{V} |\\psi_0^{(0)}\\rangle|^2}{E_0^{(0)} - E_k^{(0)}} = F^2 \\sum_{k \\neq 0} \\frac{|\\langle\\psi_k^{(0)}| \\hat{x} |\\psi_0^{(0)}\\rangle|^2}{E_0^{(0)} - E_k^{(0)}}\n$$\nwhere $\\{E_k^{(0)}, |\\psi_k^{(0)}\\rangle\\}$ are the eigenpairs of $\\hat{H}(0)$ computed within the truncated basis of size $N$. Comparing this to the energy expansion $E(F) \\approx E_0^{(0)} + E^{(1)} + E^{(2)}$, where $E^{(1)}=0$ due to the symmetry of $\\hat{H}(0)$, we identify $E^{(2)} = -\\frac{1}{2}\\alpha F^2$. This yields the sum-over-states formula for the polarizability:\n$$\n\\alpha_{\\mathrm{analytic}}(N) = 2 \\sum_{k=1}^{N-1} \\frac{|\\langle\\psi_k^{(0)}| \\hat{x} |\\psi_0^{(0)}\\rangle|^2}{E_k^{(0)} - E_0^{(0)}}\n$$\nThe computational steps are:\n1. Construct the $N \\times N$ matrix $\\mathbf{H}(0)$.\n2. Numerically diagonalize $\\mathbf{H}(0)$ to obtain its eigenvalues $\\{E_k^{(0)}\\}_{k=0}^{N-1}$ and corresponding eigenvectors $\\{|\\psi_k^{(0)}\\rangle\\}_{k=0}^{N-1}$, sorted by energy.\n3. Construct the matrix $\\mathbf{X}$.\n4. Evaluate the sum using the computed eigenvalues and eigenvectors. The matrix element $\\langle\\psi_k^{(0)}| \\hat{x} |\\psi_0^{(0)}\\rangle$ is computed as $\\mathbf{c}_k^\\intercal \\mathbf{X} \\mathbf{c}_0$, where $\\mathbf{c}_k$ is the column vector representing $|\\psi_k^{(0)}\\rangle$.\n\n**4. Finite-Field Polarizability: $\\alpha_{\\mathrm{finite-field}}(N,F)$**\n\nThis method computes $\\alpha$ by numerically approximating the second derivative of the energy. The second central finite difference approximation for $E''(F)$ at $F=0$ is:\n$$\n\\left.\\frac{d^2E}{dF^2}\\right|_{F=0} \\approx \\frac{E(F) - 2E(0) + E(-F)}{F^2}\n$$\nThe Hamiltonian has a symmetric potential for $F=0$, so its eigenstates have definite parity. The perturbation $-F\\hat{x}$ is antisymmetric. Therefore, the Hamiltonians $\\hat{H}(F)$ and $\\hat{H}(-F)$ are unitarily equivalent under the parity operator, which implies their spectra are identical. In particular, their ground-state energies are equal: $E(F) = E(-F)$. The approximation for $\\alpha$ thus simplifies:\n$$\n\\alpha_{\\mathrm{finite-field}}(N, F) = -\\frac{E(F) - 2E(0) + E(-F)}{F^2} = -\\frac{2(E(F) - E(0))}{F^2}\n$$\nThe computational steps are:\n1. Construct the $N \\times N$ matrix $\\mathbf{H}(0)$ and find its lowest eigenvalue, $E(0)$.\n2. For a small field strength $F$, construct the matrix $\\mathbf{H}(F) = \\mathbf{H}(0) - F\\mathbf{X}$ and find its lowest eigenvalue, $E(F)$.\n3. Calculate $\\alpha$ using the simplified formula.\n\n**5. Reference Calculation and Error Analysis**\n\nA highly converged reference polarizability, $\\alpha_{\\mathrm{ref}}$, is computed using the analytic method with a large basis size, $N_{\\mathrm{ref}} = 100$. This value serves as a benchmark.\n\nWe then compute two error metrics for each test case $(N,F)$:\n- $\\Delta_{\\mathrm{FF}} = \\alpha_{\\mathrm{analytic}}(N) - \\alpha_{\\mathrm{finite-field}}(N,F)$: This isolates the error of the finite difference approximation itself, which is of order $\\mathcal{O}(F^2)$, plus higher-order electronic response terms not captured by the second-order perturbation theory. It is computed at a fixed basis size $N$.\n- $\\Delta_{\\mathrm{basis}} = \\alpha_{\\mathrm{ref}} - \\alpha_{\\mathrm{analytic}}(N)$: This isolates the error due to the incompleteness of the basis set of size $N$. It compares two results derived from the same perturbation theory formalism, differing only in the basis size.\n\nThe implementation will now follow this complete and validated procedure.", "answer": "```python\nimport numpy as np\n\ndef build_operators(N, omega_b):\n    \"\"\"\n    Builds matrix representations of a, a_dagger, and x operators.\n    \n    Args:\n        N (int): The size of the truncated harmonic oscillator basis.\n        omega_b (float): The frequency of the reference harmonic oscillator.\n\n    Returns:\n        tuple: Matrices for a, a_dagger, and x.\n    \"\"\"\n    # Annihilation operator\n    a = np.zeros((N, N), dtype=float)\n    for n in range(1, N):\n        a[n - 1, n] = np.sqrt(n)\n\n    # Creation operator\n    a_dag = a.T\n\n    # Position operator\n    x_mat = np.sqrt(1.0 / (2.0 * omega_b)) * (a + a_dag)\n    \n    return a, a_dag, x_mat\n\ndef get_hamiltonian_matrix(N, omega, lambda_, omega_b, x_mat):\n    \"\"\"\n    Builds the field-free Hamiltonian matrix H(0).\n    \n    Args:\n        N (int): The size of the basis.\n        omega (float): Physical frequency parameter.\n        lambda_ (float): Anharmonicity parameter.\n        omega_b (float): Basis frequency.\n        x_mat (np.ndarray): Matrix for the position operator.\n\n    Returns:\n        np.ndarray: The matrix for H(0).\n    \"\"\"\n    # Basis Hamiltonian H_b\n    n_op = np.diag(np.arange(N, dtype=float))\n    h_b = omega_b * (n_op + 0.5 * np.identity(N))\n\n    # x^2 and x^4 matrices\n    x2_mat = x_mat @ x_mat\n    x4_mat = x2_mat @ x2_mat\n\n    # Field-free Hamiltonian H(0)\n    h0_mat = h_b + 0.5 * (omega**2 - omega_b**2) * x2_mat + lambda_ * x4_mat\n    \n    return h0_mat\n\ndef compute_alpha_analytic(N, omega, lambda_, omega_b):\n    \"\"\"\n    Computes polarizability using the sum-over-states formula (perturbation theory).\n    \"\"\"\n    _, _, x_mat = build_operators(N, omega_b)\n    h0_mat = get_hamiltonian_matrix(N, omega, lambda_, omega_b, x_mat)\n\n    # Diagonalize H(0) to get eigenpairs\n    evals, evecs = np.linalg.eigh(h0_mat)\n    E0 = evals[0]\n    psi0 = evecs[:, 0]\n    \n    alpha = 0.0\n    for k in range(1, N):\n        Ek = evals[k]\n        psik = evecs[:, k]\n        \n        matrix_element = psik.T @ x_mat @ psi0\n        alpha += (matrix_element**2) / (Ek - E0)\n        \n    return 2.0 * alpha\n\ndef compute_alpha_finite_field(N, F, omega, lambda_, omega_b):\n    \"\"\"\n    Computes polarizability using the finite-field method.\n    \"\"\"\n    _, _, x_mat = build_operators(N, omega_b)\n    h0_mat = get_hamiltonian_matrix(N, omega, lambda_, omega_b, x_mat)\n\n    # Ground state energy at F=0\n    # Use eigvalsh as we only need the lowest eigenvalue\n    E0 = np.linalg.eigvalsh(h0_mat)[0]\n\n    # Hamiltonian at field F\n    hF_mat = h0_mat - F * x_mat\n\n    # Ground state energy at field F\n    EF = np.linalg.eigvalsh(hF_mat)[0]\n    \n    # Polarizability from central finite difference\n    # Note: E(F) = E(-F) due to symmetry, so the formula simplifies\n    alpha = -2.0 * (EF - E0) / (F**2)\n    \n    return alpha\n\ndef solve():\n    # Fixed physical parameters in atomic units\n    omega = 0.7\n    lambda_ = 0.02\n    omega_b = 0.7\n\n    # Test suite of (N, F) pairs\n    test_cases = [\n        (12, 1e-3),\n        (12, 5e-2),\n        (4, 1e-3),\n        (8, 1e-5),\n        (20, 1e-3),\n    ]\n\n    # Compute reference polarizability with a large basis\n    N_ref = 100\n    alpha_ref = compute_alpha_analytic(N_ref, omega, lambda_, omega_b)\n\n    results = []\n    \n    for N, F in test_cases:\n        # Compute analytic polarizability for the current basis size N\n        alpha_analytic = compute_alpha_analytic(N, omega, lambda_, omega_b)\n\n        # Compute finite-field polarizability for the current N and F\n        alpha_finite_field = compute_alpha_finite_field(N, F, omega, lambda_, omega_b)\n\n        # Calculate the two discrepancy metrics\n        # Delta_FF: Isolates numerical differentiation error\n        delta_ff = alpha_analytic - alpha_finite_field\n        \n        # Delta_basis: Isolates basis set incompleteness error\n        delta_basis = alpha_ref - alpha_analytic\n        \n        results.extend([delta_ff, delta_basis])\n\n    # Format the output as a comma-separated list in brackets\n    print(f\"[{','.join(f'{res:.8e}' for res in results)}]\")\n\nsolve()\n```", "id": "2915784"}]}