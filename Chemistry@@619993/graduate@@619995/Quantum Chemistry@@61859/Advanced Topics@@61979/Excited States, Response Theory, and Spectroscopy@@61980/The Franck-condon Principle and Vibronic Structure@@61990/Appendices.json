{"hands_on_practices": [{"introduction": "This first practice grounds your understanding of the Franck-Condon principle in its most fundamental model: the displaced, parallel harmonic oscillator. By calculating the intensity profile of a vibronic progression from the dimensionless Huang-Rhys factor $S$, you will directly translate this key theoretical parameter into an observable spectral signature. This exercise builds an essential skill for interpreting and predicting the shapes of electronic absorption and emission spectra based on changes in molecular geometry upon excitation.[@problem_id:2929685]", "problem": "A diatomic molecule undergoes an electronic absorption from the ground electronic state to an excited electronic state. Within the Born–Oppenheimer approximation and the Condon approximation (transition dipole independent of the normal coordinate), assume both electronic states are described by harmonic potential energy surfaces with identical curvature (same vibrational angular frequency $\\omega$) but displaced along a single totally symmetric normal coordinate $Q$. The vibrational quantum is $\\hbar\\omega = 0.16\\ \\mathrm{eV}$ (in both electronic states), and the displacement is characterized by the Huang–Rhys factor $S=2.5$. The sample is at $T=0\\ \\mathrm{K}$ so that only the vibrational ground level $v''=0$ of the initial electronic state is populated.\n\nStarting from the definition that the Franck–Condon factor (FCF) is the square of the overlap between initial and final vibrational wavefunctions, and using only the assumptions above (parallel displaced harmonic oscillators with no Duschinsky rotation and identical frequencies), derive the expression for the relative absorption intensity into the $n$-th vibrational level ($v'=n$) of the excited state from $v''=0$. Then compute the relative intensities of the first four vibronic absorption peaks corresponding to $n=0,1,2,3$.\n\nExpress each intensity as a unitless decimal, normalized so that the sum over all $n\\ge 0$ equals $1$. Round each intensity to four significant figures. Report your final result as a row matrix $\\bigl(I_0,\\ I_1,\\ I_2,\\ I_3\\bigr)$.", "solution": "The problem statement is evaluated and determined to be valid. It is scientifically grounded in the principles of quantum chemistry, specifically the theory of vibronic transitions. It is well-posed, providing all necessary information for a unique solution, and is formulated objectively. The provided values are physically realistic. The information regarding the vibrational quantum, $\\hbar\\omega = 0.16\\ \\mathrm{eV}$, is superfluous for the calculation of unitless relative intensities, which depend solely on the Huang–Rhys factor $S$, but it does not introduce any contradiction. We proceed with the solution.\n\nThe problem asks for the relative intensities of vibronic absorption peaks from the ground vibrational state ($v''=0$) of the ground electronic state to the $n$-th vibrational state ($v'=n$) of an excited electronic state. The sample is at $T=0\\ \\mathrm{K}$, so we only consider transitions originating from the $v''=0$ level.\n\nWithin the Born-Oppenheimer and Condon approximations, the intensity $I_{0 \\to n}$ of a transition from the initial state $|\\psi_{e''} \\chi_{v''=0}\\rangle$ to the final state $|\\psi_{e'} \\chi_{v'=n}\\rangle$ is proportional to the square of the transition dipole moment magnitude:\n$$I_{0 \\to n} \\propto |\\langle \\psi_{e'} \\chi_{n} | \\hat{\\mu} | \\psi_{e''} \\chi_{0} \\rangle|^2$$\nwhere $\\hat{\\mu}$ is the electric dipole operator, $\\psi$ are electronic wavefunctions, and $\\chi$ are vibrational wavefunctions. The Condon approximation assumes the electronic transition dipole moment $\\mu_{e'e''}(Q) = \\langle \\psi_{e'} | \\hat{\\mu} | \\psi_{e''} \\rangle_{\\mathbf{r}}$ is independent of the nuclear normal coordinate $Q$. This allows $\\mu_{e'e''}$ to be factored out of the integral over nuclear coordinates:\n$$I_{0 \\to n} \\propto |\\mu_{e'e''}|^2 |\\langle \\chi_{n} | \\chi_{0} \\rangle|^2$$\nThe term $|\\langle \\chi_{n} | \\chi_{0} \\rangle|^2$ is the Franck–Condon factor (FCF). The relative intensity for different final vibrational levels $n$ is therefore directly proportional to the FCF:\n$$I_n \\propto FCF_{0,n} = |\\langle \\chi_{n} | \\chi_{0} \\rangle|^2$$\n\nThe potential energy surfaces for the ground and excited electronic states are described as identical but displaced harmonic oscillators. We use a dimensionless coordinate $q = \\sqrt{m\\omega/\\hbar}Q$, where $m$ is the reduced mass and $\\omega$ is the vibrational angular frequency. The ground state vibrational wavefunction $\\chi_0(q)$, for $v''=0$, is centered at $q=0$. The excited state vibrational wavefunction $\\chi_n(q)$, for $v'=n$, is centered at a displaced position $q_e$.\nThe Huang–Rhys factor, $S$, is defined as the relaxation energy upon excitation in units of vibrational quanta, $\\hbar\\omega$. This energy corresponds to the potential energy difference at the ground state equilibrium geometry ($Q=0$ or $q=0$) in the excited state potential, $V'(Q) = \\frac{1}{2}m\\omega^2(Q-Q_e)^2$.\n$$S = \\frac{V'(Q=0) - V'(Q=Q_e)}{\\hbar\\omega} = \\frac{\\frac{1}{2}m\\omega^2(-Q_e)^2}{\\hbar\\omega} = \\frac{1}{2}\\frac{m\\omega}{\\hbar}Q_e^2 = \\frac{1}{2}q_e^2$$\nFrom this, the displacement in dimensionless coordinates is $q_e = \\sqrt{2S}$.\n\nThe FCF is the squared overlap of the wavefunctions $\\chi_0(q)$ and $\\chi_n(q-q_e)$. A direct method to evaluate this overlap is through the use of ladder operators. Let $a$ and $a^{\\dagger}$ be the annihilation and creation operators for the ground state oscillator. The operators for the displaced excited state oscillator, $b$ and $b^{\\dagger}$, are related by $b = a - d$ and $b^{\\dagger} = a^{\\dagger} - d$, where the displacement parameter $d$ is given by $d = q_e/\\sqrt{2} = \\sqrt{S}$.\n\nThe initial state is the ground state vacuum, $|0\\rangle$, satisfying $a|0\\rangle=0$. The final states are the number states of the displaced oscillator, $|n'\\rangle$, which can be expressed as $|n'\\rangle = \\frac{(b^{\\dagger})^n}{\\sqrt{n!}}|0'\\rangle$, where $|0'\\rangle$ is the displaced vacuum state. The overlap integral is $\\langle n' | 0 \\rangle$.\nWe proceed by noting that $\\langle 0 | b = \\langle 0 | (a-d) = -d\\langle 0 |$. Acting $n$ times gives $\\langle 0 | b^n = (-d)^n \\langle 0 |$.\nThe matrix element is thus:\n$$\\langle n' | 0 \\rangle = \\frac{1}{\\sqrt{n!}} \\langle (b^{\\dagger})^n 0' | 0 \\rangle = \\frac{1}{\\sqrt{n!}} \\langle 0' | b^n | 0 \\rangle = \\frac{(-d)^n}{\\sqrt{n!}} \\langle 0' | 0 \\rangle$$\nThe overlap of the two vacuum states, $|0'\\rangle$ and $|0\\rangle$, is a standard result for coherent states: $\\langle 0' | 0 \\rangle = \\exp(-d^2/2)$.\nSubstituting this and $d=\\sqrt{S}$ yields:\n$$\\langle n' | 0 \\rangle = \\frac{(-\\sqrt{S})^n}{\\sqrt{n!}}\\exp(-S/2)$$\nThe FCF is the square of the magnitude of this overlap:\n$$FCF_{0,n} = |\\langle n' | 0 \\rangle|^2 = \\left| \\frac{(-\\sqrt{S})^n}{\\sqrt{n!}}\\exp(-S/2) \\right|^2 = \\frac{S^n}{n!}\\exp(-S)$$\nThis is a Poisson distribution with mean $\\lambda = S$. To find the normalized relative intensities, we ensure their sum over all $n$ equals $1$:\n$$\\sum_{n=0}^{\\infty} FCF_{0,n} = \\exp(-S) \\sum_{n=0}^{\\infty} \\frac{S^n}{n!} = \\exp(-S)\\exp(S) = 1$$\nThe derived expression for the FCF is already normalized. Thus, the relative intensity $I_n$ for the $0 \\to n$ transition is:\n$$I_n = \\frac{S^n}{n!}\\exp(-S)$$\n\nNow, we compute the numerical values for $S=2.5$ and $n=0, 1, 2, 3$.\nThe common factor is $\\exp(-2.5) \\approx 0.0820849986$.\n\nFor $n=0$:\n$$I_0 = \\frac{(2.5)^0}{0!}\\exp(-2.5) = 1 \\cdot \\exp(-2.5) \\approx 0.082085$$\nRounded to four significant figures, $I_0 = 0.08208$.\n\nFor $n=1$:\n$$I_1 = \\frac{(2.5)^1}{1!}\\exp(-2.5) = 2.5 \\cdot I_0 \\approx 0.205212$$\nRounded to four significant figures, $I_1 = 0.2052$.\n\nFor $n=2$:\n$$I_2 = \\frac{(2.5)^2}{2!}\\exp(-2.5) = \\frac{6.25}{2}\\exp(-2.5) = 3.125 \\cdot \\exp(-2.5) \\approx 0.256516$$\nRounded to four significant figures, $I_2 = 0.2565$.\n\nFor $n=3$:\n$$I_3 = \\frac{(2.5)^3}{3!}\\exp(-2.5) = \\frac{15.625}{6}\\exp(-2.5) \\approx 0.213763$$\nRounded to four significant figures, $I_3 = 0.2138$.\n\nThe relative intensities for the transitions to $n=0, 1, 2, 3$ are approximately $0.08208$, $0.2052$, $0.2565$, and $0.2138$. The peak of the intensity distribution (the mode) is at $n=\\lfloor S \\rfloor = \\lfloor 2.5 \\rfloor = 2$, which is consistent with our calculations showing $I_2$ is the largest of the first four values.\n\nThe final result is reported as a row matrix.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.08208 & 0.2052 & 0.2565 & 0.2138\n\\end{pmatrix}\n}\n$$", "id": "2929685"}, {"introduction": "The Condon approximation, while powerful, assumes the electronic transition dipole moment is independent of nuclear coordinates. This practice challenges you to move beyond that simplification by modeling a linear dependence on a vibrational coordinate, an effect known as Herzberg-Teller coupling. By deriving how this non-Condon effect alters vibronic intensities, you will gain insight into the phenomenon of \"intensity borrowing,\" a crucial mechanism that allows otherwise forbidden transitions to appear in spectra.[@problem_id:2929683]", "problem": "Consider a single totally symmetric normal mode that is harmonic with the same angular frequency $\\omega$ in two electronic states, a ground state $\\lvert g \\rangle$ and an excited state $\\lvert e \\rangle$. Work in the Born–Oppenheimer and harmonic approximations, assume no Duschinsky rotation (i.e., no mode mixing), and take the mode to be mass-weighted and scaled to a dimensionless coordinate operator $\\hat{x}$ so that $\\hat{x} = (\\hat{a} + \\hat{a}^{\\dagger})/\\sqrt{2}$ in the ground-state potential, where $\\hat{a}$ and $\\hat{a}^{\\dagger}$ are the annihilation and creation operators, respectively. Let the minimum of the excited-state potential be displaced along this mode by a dimensionless amount $d$ relative to the ground state, and define the Huang–Rhys factor $S \\equiv d^{2}/2$. Assume the initial vibrational population is entirely in the ground vibrational level $\\lvert 0_{g} \\rangle$, and denote excited-state vibrational eigenstates by $\\lvert v_{e} \\rangle$.\n\nThe electronic transition dipole moment is non-Condon along this single mode and is approximated to first order (Herzberg–Teller expansion) by $\\hat{\\mu}(\\hat{x}) = \\mu_{0} + \\alpha \\,\\hat{x}$, where $\\mu_{0}$ and $\\alpha$ are real constants. According to the Franck–Condon principle generalized to non-Condon transitions, the vibronic intensity for the transition $\\lvert 0_{g} \\rangle \\to \\lvert v_{e} \\rangle$ is proportional to the squared modulus of the vibronic matrix element $\\langle v_{e} \\rvert \\hat{\\mu}(\\hat{x}) \\lvert 0_{g} \\rangle$.\n\nDerive, from these premises, a closed-form analytic expression for the ratio $R$ of the $0 \\to 1$ to $0 \\to 0$ vibronic intensities, where\n$$\nR \\equiv \\frac{I_{0 \\to 1}}{I_{0 \\to 0}} = \\frac{\\left|\\langle 1_{e} \\rvert \\hat{\\mu}(\\hat{x}) \\lvert 0_{g} \\rangle\\right|^{2}}{\\left|\\langle 0_{e} \\rvert \\hat{\\mu}(\\hat{x}) \\lvert 0_{g} \\rangle\\right|^{2}}.\n$$\nExpress your final result entirely in terms of $S$, $\\mu_{0}$, and $\\alpha$. The final answer must be a single simplified symbolic expression. No numerical approximation or rounding is required.", "solution": "The problem requires the derivation of the ratio of vibronic intensities $R = I_{0 \\to 1} / I_{0 \\to 0}$ for a displaced harmonic oscillator model with a non-Condon transition dipole moment. The problem statement is scientifically sound and well-posed, providing all necessary information for a rigorous quantum mechanical derivation.\n\nThe intensity of a vibronic transition from an initial state $\\lvert \\psi_i \\rangle$ to a final state $\\lvert \\psi_f \\rangle$ is proportional to the squared modulus of the transition dipole moment matrix element, $\\lvert \\langle \\psi_f \\rvert \\hat{\\mu} \\lvert \\psi_i \\rangle \\rvert^2$. Within the Born-Oppenheimer approximation, the vibronic states are products of electronic and vibrational states. For the specified transition, the initial state is $\\lvert g, 0_g \\rangle$ and the final state is $\\lvert e, v_e \\rangle$. The relevant matrix element is the vibronic transition moment, which involves an integral over both electronic and nuclear coordinates. Integrating over the electronic coordinates yields the electronic transition dipole moment, which, in this non-Condon case, depends on the nuclear coordinate $\\hat{x}$. The quantity of interest is therefore the vibronic matrix element, $\\langle v_e \\rvert \\hat{\\mu}(\\hat{x}) \\lvert 0_g \\rangle$, where $\\hat{\\mu}(\\hat{x}) = \\mu_0 + \\alpha\\hat{x}$.\n\nThe ratio $R$ is given by:\n$$\nR = \\frac{I_{0 \\to 1}}{I_{0 \\to 0}} = \\frac{\\left|\\langle 1_{e} \\rvert \\hat{\\mu}(\\hat{x}) \\lvert 0_{g} \\rangle\\right|^{2}}{\\left|\\langle 0_{e} \\rvert \\hat{\\mu}(\\hat{x}) \\lvert 0_{g} \\rangle\\right|^{2}}\n$$\nLet us define the matrix elements $M_{0 \\to v} = \\langle v_e \\rvert \\hat{\\mu}(\\hat{x}) \\lvert 0_g \\rangle$. We must compute $M_{0 \\to 0}$ and $M_{0 \\to 1}$.\n\nThe problem is most efficiently solved by expressing all operators and states in a single, consistent basis. We choose the basis of the excited electronic state, $\\{\\lvert v_e \\rangle\\}$. The ladder operators for this basis are denoted $\\hat{b}$ and $\\hat{b}^\\dagger$. The dimensionless coordinate operator in this basis is $\\hat{x}_e = (\\hat{b}+\\hat{b}^\\dagger)/\\sqrt{2}$.\n\nThe Hamiltonians for the ground ($g$) and excited ($e$) states are those of harmonic oscillators with the same frequency $\\omega$, but with their potential minima displaced. Let the ground state potential minimum be at coordinate $0$ and the excited state minimum at coordinate $d$. The potential energies are $V_g(\\hat{x}) \\propto \\hat{x}^2$ and $V_e(\\hat{x}) \\propto (\\hat{x}-d)^2$.\nThe coordinate operator $\\hat{x}$ (defined in the ground state frame) relates to the excited state coordinate operator $\\hat{x}_e$ by a simple shift: $\\hat{x}_e = \\hat{x} - d$, which implies $\\hat{x} = \\hat{x}_e + d$.\nThe transition dipole moment operator can thus be expressed in the excited state basis as:\n$$\n\\hat{\\mu}(\\hat{x}) = \\mu_0 + \\alpha(\\hat{x}_e + d)\n$$\nNext, we express the initial vibrational state $\\lvert 0_g \\rangle$ in the excited state basis $\\{\\lvert v_e \\rangle\\}$. The ground state potential is centered at $\\hat{x}=0$, while the excited state is centered at $\\hat{x}=d$. Therefore, the ground state Hamiltonian is obtained by displacing the excited state Hamiltonian. The vibrational eigenstates are related by a displacement operator $\\hat{D}$. Specifically, $\\lvert v_g \\rangle = \\hat{D}(-d/\\sqrt{2}) \\lvert v_e \\rangle$.\nLet $\\beta = d/\\sqrt{2}$. The displacement operator is $\\hat{D}(\\beta) = \\exp(\\beta \\hat{a}^\\dagger - \\beta^* \\hat{a})$. In our case, we relate the states via $\\lvert v_g \\rangle = \\hat{T}_d^{-1} \\lvert v_e \\rangle$ where $\\hat{T}_d$ shifts coordinate by $d$. The operator is $\\hat{D}_{b}(-\\beta) = \\exp(-\\beta(\\hat{b}^\\dagger-\\hat{b}))$.\nThus, the initial state $\\lvert 0_g \\rangle$ is a displaced vacuum state of the excited oscillator:\n$$\n\\lvert 0_g \\rangle = \\hat{D}_{b}(-\\beta) \\lvert 0_e \\rangle\n$$\nThis state, $\\hat{D}_{b}(-\\beta) \\lvert 0_e \\rangle$, is a coherent state in the excited state basis, which we denote $\\lvert -\\beta \\rangle_e$. An eigenstate $\\lvert \\gamma \\rangle_e$ of the annihilation operator $\\hat{b}$ satisfies $\\hat{b} \\lvert \\gamma \\rangle_e = \\gamma \\lvert \\gamma \\rangle_e$. The overlap with a number state $\\lvert v_e \\rangle$ is $\\langle v_e \\lvert \\gamma \\rangle_e = \\exp(-|\\gamma|^2/2) \\frac{\\gamma^v}{\\sqrt{v!}}$.\nHere, $\\gamma = -\\beta = -d/\\sqrt{2}$, which is real. The Huang-Rhys factor is $S = d^2/2$, so $\\beta^2 = S$.\nThe overlap is $\\langle v_e \\lvert 0_g \\rangle = \\langle v_e \\lvert -\\beta \\rangle_e = \\exp(-S/2) \\frac{(-\\beta)^v}{\\sqrt{v!}}$.\n\nWe now calculate the matrix elements $M_{0 \\to 0}$ and $M_{0 \\to 1}$:\n$$\nM_{0 \\to v} = \\langle v_e \\rvert \\mu_0 + \\alpha(d + \\hat{x}_e) \\lvert 0_g \\rangle = (\\mu_0 + \\alpha d) \\langle v_e \\rvert 0_g \\rangle + \\alpha \\langle v_e \\rvert \\hat{x}_e \\lvert 0_g \\rangle\n$$\nThe second term is evaluated using $\\hat{x}_e = (\\hat{b}+\\hat{b}^\\dagger)/\\sqrt{2}$:\n$$\n\\alpha \\langle v_e \\rvert \\frac{\\hat{b}+\\hat{b}^\\dagger}{\\sqrt{2}} \\lvert -\\beta \\rangle_e = \\frac{\\alpha}{\\sqrt{2}} \\left( \\langle v_e \\rvert \\hat{b} \\lvert -\\beta \\rangle_e + \\langle v_e \\rvert \\hat{b}^\\dagger \\lvert -\\beta \\rangle_e \\right)\n$$\nUsing $\\hat{b} \\lvert -\\beta \\rangle_e = -\\beta \\lvert -\\beta \\rangle_e$ and $\\langle v_e \\rvert \\hat{b}^\\dagger = \\sqrt{v_e+1} \\langle v_e+1 \\rvert$ (no, this should be $\\langle v_e \\rvert \\hat{b}^\\dagger = \\sqrt{v_e} \\langle v_e-1 \\rvert$ for $v_e \\ge 1$ and $0$ for $v_e=0$):\n$$\n\\langle v_e \\rvert \\hat{x}_e \\lvert -\\beta \\rangle_e = \\frac{1}{\\sqrt{2}} \\left( -\\beta \\langle v_e \\rvert -\\beta \\rangle_e + \\sqrt{v_e} \\langle v_e-1 \\rvert -\\beta \\rangle_e \\right)\n$$\n\nFor the $0 \\to 0$ transition ($v=0$):\n$\\langle 0_e \\rvert \\hat{x}_e \\lvert 0_g \\rangle = \\frac{1}{\\sqrt{2}} (-\\beta \\langle 0_e \\rvert -\\beta \\rangle_e + 0)$.\n$\\langle 0_e \\rvert 0_g \\rangle = \\exp(-S/2)$.\n$M_{0 \\to 0} = (\\mu_0 + \\alpha d) \\exp(-S/2) + \\frac{\\alpha}{\\sqrt{2}} (-\\beta \\exp(-S/2)) = (\\mu_0 + \\alpha d - \\frac{\\alpha\\beta}{\\sqrt{2}}) \\exp(-S/2)$.\nSubstituting $\\beta = d/\\sqrt{2}$:\n$$\nM_{0 \\to 0} = (\\mu_0 + \\alpha d - \\frac{\\alpha d}{2}) \\exp(-S/2) = (\\mu_0 + \\frac{\\alpha d}{2}) \\exp(-S/2)\n$$\n\nFor the $0 \\to 1$ transition ($v=1$):\n$\\langle 1_e \\rvert 0_g \\rangle = \\exp(-S/2) \\frac{-\\beta}{\\sqrt{1!}} = -\\beta \\exp(-S/2)$.\n$\\langle 1_e \\rvert \\hat{x}_e \\lvert 0_g \\rangle = \\frac{1}{\\sqrt{2}} \\left( -\\beta \\langle 1_e \\rvert -\\beta \\rangle_e + \\sqrt{1} \\langle 0_e \\rvert -\\beta \\rangle_e \\right) = \\frac{1}{\\sqrt{2}} \\left( -\\beta(-\\beta \\exp(-S/2)) + \\exp(-S/2) \\right) = \\frac{1}{\\sqrt{2}}(\\beta^2+1)\\exp(-S/2)$.\n$M_{0 \\to 1} = (\\mu_0 + \\alpha d) (-\\beta \\exp(-S/2)) + \\alpha \\frac{1}{\\sqrt{2}}(\\beta^2+1)\\exp(-S/2)$.\nFactoring out $\\exp(-S/2)$:\n$M_{0 \\to 1} = \\left[ -\\beta(\\mu_0+\\alpha d) + \\frac{\\alpha}{\\sqrt{2}}(\\beta^2+1) \\right] \\exp(-S/2)$.\nSubstitute $\\beta = d/\\sqrt{2}$ and $\\beta^2=S=d^2/2$:\n$M_{0 \\to 1} = \\left[ -\\frac{d}{\\sqrt{2}}(\\mu_0+\\alpha d) + \\frac{\\alpha}{\\sqrt{2}}(S+1) \\right] \\exp(-S/2) = \\frac{1}{\\sqrt{2}} [-\\mu_0 d - \\alpha d^2 + \\alpha(S+1)] \\exp(-S/2)$.\nUsing $d^2 = 2S$:\n$$\nM_{0 \\to 1} = \\frac{1}{\\sqrt{2}} [-\\mu_0 d - 2\\alpha S + \\alpha S + \\alpha] \\exp(-S/2) = \\frac{1}{\\sqrt{2}} [\\alpha(1-S)-\\mu_0 d] \\exp(-S/2)\n$$\n\nNow we compute the ratio $R$:\n$$\nR = \\frac{|M_{0 \\to 1}|^2}{|M_{0 \\to 0}|^2} = \\frac{\\left|\\frac{1}{\\sqrt{2}}[\\alpha(1-S)-\\mu_0 d] \\exp(-S/2)\\right|^2}{\\left|(\\mu_0 + \\frac{\\alpha d}{2}) \\exp(-S/2)\\right|^2} = \\frac{\\frac{1}{2}(\\alpha(1-S)-\\mu_0 d)^2}{(\\mu_0 + \\frac{\\alpha d}{2})^2}\n$$\nThe problem requires the answer in terms of $S$, $\\mu_0$, and $\\alpha$. We substitute $d=\\sqrt{2S}$ (assuming $d \\ge 0$):\n$$\nR = \\frac{\\frac{1}{2}\\left(\\alpha(1-S)-\\mu_0 \\sqrt{2S}\\right)^2}{\\left(\\mu_0 + \\frac{\\alpha \\sqrt{2S}}{2}\\right)^2} = \\frac{\\frac{1}{2}\\left(\\alpha(1-S)-\\mu_0 \\sqrt{2S}\\right)^2}{\\left(\\mu_0 + \\alpha \\sqrt{S/2}\\right)^2}\n$$\nTo simplify the expression, we can rewrite the denominator:\n$$\n\\left(\\mu_0 + \\alpha \\sqrt{S/2}\\right)^2 = \\left(\\frac{\\sqrt{2}\\mu_0 + \\alpha\\sqrt{S}}{\\sqrt{2}}\\right)^2 = \\frac{\\left(\\sqrt{2}\\mu_0 + \\alpha\\sqrt{S}\\right)^2}{2}\n$$\nSubstituting this into the expression for $R$:\n$$\nR = \\frac{\\frac{1}{2}\\left(\\alpha(1-S)-\\mu_0 \\sqrt{2S}\\right)^2}{\\frac{1}{2}\\left(\\sqrt{2}\\mu_0 + \\alpha\\sqrt{S}\\right)^2} = \\frac{\\left(\\alpha(1-S)-\\mu_0 \\sqrt{2S}\\right)^2}{\\left(\\sqrt{2}\\mu_0 + \\alpha\\sqrt{S}\\right)^2}\n$$\nSince the numerator is a squared term, we can write it as $(\\mu_0\\sqrt{2S} - \\alpha(1-S))^2$.\n$$\nR = \\frac{\\left(\\mu_0\\sqrt{2S} - \\alpha(1-S)\\right)^2}{\\left(\\sqrt{2}\\mu_0 + \\alpha\\sqrt{S}\\right)^2}\n$$\nThis is the final simplified expression.", "answer": "$$\n\\boxed{\\frac{\\left(\\mu_{0}\\sqrt{2S} - \\alpha(1-S)\\right)^{2}}{\\left(\\sqrt{2}\\mu_{0} + \\alpha\\sqrt{S}\\right)^{2}}}\n$$", "id": "2929683"}, {"introduction": "In reality, molecules are multidimensional, and their vibrational normal modes often rotate and mix upon electronic excitation—a phenomenon described by the Duschinsky transformation. This computational exercise bridges the gap between idealized one-dimensional models and the practical analysis of real molecular systems from quantum chemistry calculations. By constructing the Duschinsky rotation matrix $\\mathbf{J}$ and displacement vector $\\mathbf{K}$ from molecular geometries and Hessian matrices, you will master the foundational procedure for simulating realistic vibronic spectra in polyatomic molecules.[@problem_id:2929663]", "problem": "Consider the Born–Oppenheimer approximation and the harmonic normal-mode description of nuclear motion for two electronic states, an initial state and a final state. In mass-weighted Cartesian coordinates, the quadratic potential energy of small displacements about an equilibrium geometry is determined by a symmetric Hessian matrix. The Franck–Condon (FC) principle connects vibronic intensities to overlaps of harmonic-oscillator eigenfunctions defined in the normal-mode bases of the two electronic states. The linear transformation between the two normal-mode coordinate systems is characterized by the Duschinsky rotation matrix and a displacement vector. Your task is to derive, implement, and validate this transformation purely from the definitions of mass-weighted normal modes and symmetric positive-definite Hessians.\n\nStarting only from the following foundational facts:\n- The mass-weighted Hessian of a stable equilibrium is a real symmetric positive-definite matrix. Its eigen-decomposition defines an orthonormal basis of normal modes and a set of squared angular frequencies.\n- Normal coordinates are orthonormal linear combinations of mass-weighted Cartesian displacements, and the eigenvectors of the mass-weighted Hessian form an orthonormal matrix of coefficients.\n- The Duschinsky transformation is the unique linear map between the two orthonormal normal-mode bases that, together with a constant shift, maps displacements measured from the initial equilibrium to displacements measured from the final equilibrium.\n\nPerform the following for each test case listed below:\n- Let the initial-state equilibrium geometry be the column vector $\\mathbf{g}_i$ and the final-state equilibrium geometry be the column vector $\\mathbf{g}_f$, both in mass-weighted Cartesian coordinates. Let the corresponding mass-weighted Hessians be $\\mathbf{H}_i$ and $\\mathbf{H}_f$, respectively.\n- Diagonalize $\\mathbf{H}_i$ and $\\mathbf{H}_f$ to obtain their orthonormal eigenvector matrices and nonnegative eigenvalue spectra. Use these to construct the Duschinsky rotation matrix $\\mathbf{J}$ and the displacement vector $\\mathbf{K}$ that map the initial normal coordinates to the final normal coordinates.\n- Validate orthogonality by computing the Frobenius norm of $\\mathbf{J}^\\top \\mathbf{J} - \\mathbf{I}$ and checking whether it is less than a specified tolerance $\\varepsilon_{\\mathrm{orth}}$. Use $\\varepsilon_{\\mathrm{orth}} = 10^{-10}$.\n- Validate the positivity of vibrational frequencies by checking that all eigenvalues of both $\\mathbf{H}_i$ and $\\mathbf{H}_f$ are strictly greater than a small positive threshold $\\varepsilon_{\\mathrm{pos}}$. Use $\\varepsilon_{\\mathrm{pos}} = 10^{-12}$.\n- For each test case, return a boolean value that is true if and only if both validations pass.\n\nAll inputs are expressed in mass-weighted Cartesian coordinates so that units are absorbed into the coordinate definition; the boolean outputs are unitless. Angles are not used in inputs or outputs.\n\nTest suite:\n- Case A:\n  - $\\mathbf{g}_i = \\begin{bmatrix} 0.0 \\\\ 0.0 \\end{bmatrix}$, $\\mathbf{g}_f = \\begin{bmatrix} 0.2 \\\\ -0.1 \\end{bmatrix}$\n  - $\\mathbf{H}_i = \\begin{bmatrix} 1.0 & 0.0 \\\\ 0.0 & 4.0 \\end{bmatrix}$\n  - $\\mathbf{H}_f = \\begin{bmatrix} 2.08733219254516 & 0.282321236697517 \\\\ 0.282321236697517 & 2.91266780745484 \\end{bmatrix}$\n- Case B:\n  - $\\mathbf{g}_i = \\begin{bmatrix} 0.1 \\\\ -0.2 \\\\ 0.3 \\end{bmatrix}$, $\\mathbf{g}_f = \\begin{bmatrix} 0.1 \\\\ -0.2 \\\\ 0.3 \\end{bmatrix}$\n  - $\\mathbf{H}_i = \\begin{bmatrix} 1.0 & 0.0 & 0.0 \\\\ 0.0 & 2.0 & 0.0 \\\\ 0.0 & 0.0 & 3.0 \\end{bmatrix}$\n  - $\\mathbf{H}_f = \\begin{bmatrix} 1.0 & 0.0 & 0.0 \\\\ 0.0 & 2.0 & 0.0 \\\\ 0.0 & 0.0 & 3.0 \\end{bmatrix}$\n- Case C:\n  - $\\mathbf{g}_i = \\begin{bmatrix} 0.0 \\\\ 0.0 \\end{bmatrix}$, $\\mathbf{g}_f = \\begin{bmatrix} 0.001 \\\\ -0.002 \\end{bmatrix}$\n  - $\\mathbf{H}_i = \\begin{bmatrix} 1.0\\times 10^{-6} & 0.0 \\\\ 0.0 & 2.0 \\end{bmatrix}$\n  - $\\mathbf{H}_f = \\begin{bmatrix} 1.5 & 0.2 \\\\ 0.2 & 1.0 \\end{bmatrix}$\n- Case D:\n  - $\\mathbf{g}_i = \\begin{bmatrix} 0.0 \\\\ 0.0 \\end{bmatrix}$, $\\mathbf{g}_f = \\begin{bmatrix} 0.0 \\\\ 0.0 \\end{bmatrix}$\n  - $\\mathbf{H}_i = \\begin{bmatrix} 1.0 & 0.0 \\\\ 0.0 & -0.1 \\end{bmatrix}$\n  - $\\mathbf{H}_f = \\begin{bmatrix} 2.0 & 0.0 \\\\ 0.0 & 2.5 \\end{bmatrix}$\n\nImplementation requirements:\n- Your program must construct $\\mathbf{J}$ and $\\mathbf{K}$ from first principles as outlined above.\n- Use the orthogonality and positivity checks with $\\varepsilon_{\\mathrm{orth}} = 10^{-10}$ and $\\varepsilon_{\\mathrm{pos}} = 10^{-12}$.\n- For each case, output a boolean that is true if both validations pass and false otherwise.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, for example, $\\left[\\text{result}_A,\\text{result}_B,\\text{result}_C,\\text{result}_D\\right]$. The entries must be the boolean literals produced by your implementation in the order of the test suite above, with no spaces.", "solution": "The problem statement is scientifically grounded, well-posed, objective, and self-contained. It presents a standard, non-trivial task from computational quantum chemistry: the derivation and numerical validation of the Duschinsky transformation between two sets of harmonic normal modes. All necessary data and definitions are provided. The problem is therefore valid, and a solution will be provided.\n\nThe core of the problem is to derive the linear transformation that connects the normal coordinates of an initial electronic state, denoted by subscript $i$, to those of a final electronic state, denoted by subscript $f$. This transformation, known as the Duschinsky transformation, is fundamental for calculating Franck-Condon factors and simulating vibronic spectra.\n\nLet $\\mathbf{x}$ be the column vector of mass-weighted Cartesian coordinates of the nuclei. The displacement from the equilibrium geometry $\\mathbf{g}_s$ in electronic state $s \\in \\{i, f\\}$ is given by the vector $\\mathbf{q}_s$:\n$$ \\mathbf{q}_s = \\mathbf{x} - \\mathbf{g}_s $$\nThe relationship between the displacement vectors of the two states is derived by expressing one in terms of the other. The coordinate vector $\\mathbf{x}$ is common to both definitions. Thus, we can write:\n$$ \\mathbf{q}_f = \\mathbf{x} - \\mathbf{g}_f = (\\mathbf{x} - \\mathbf{g}_i) + (\\mathbf{g}_i - \\mathbf{g}_f) = \\mathbf{q}_i - (\\mathbf{g}_f - \\mathbf{g}_i) $$\nThis equation links the Cartesian displacements in the two electronic states.\n\nWithin the harmonic approximation, the potential energy surface around the equilibrium geometry $\\mathbf{g}_s$ is described by the mass-weighted Hessian matrix $\\mathbf{H}_s$:\n$$ V_s(\\mathbf{q}_s) = \\frac{1}{2}\\mathbf{q}_s^\\top \\mathbf{H}_s \\mathbf{q}_s $$\nFor a stable equilibrium, $\\mathbf{H}_s$ is a real, symmetric, and positive-definite matrix. Its spectral decomposition yields a set of eigenvalues $\\lambda_k^{(s)}$ and corresponding eigenvectors. The eigenvalues are the squared angular frequencies of the normal modes, $(\\omega_k^{(s)})^2$. The eigenvectors form the columns of an orthonormal matrix $\\mathbf{L}_s$, which defines the transformation to normal coordinates $\\mathbf{Q}_s$.\n$$ \\mathbf{H}_s \\mathbf{L}_s = \\mathbf{L}_s \\mathbf{\\Lambda}_s $$\nwhere $\\mathbf{\\Lambda}_s$ is the diagonal matrix of eigenvalues $\\lambda_k^{(s)}$ and $\\mathbf{L}_s$ is the orthogonal matrix of normal modes satisfying $\\mathbf{L}_s^\\top \\mathbf{L}_s = \\mathbf{L}_s \\mathbf{L}_s^\\top = \\mathbf{I}$.\n\nThe normal coordinates $\\mathbf{Q}_s$ are defined as the projection of the mass-weighted Cartesian displacements $\\mathbf{q}_s$ onto the basis of normal modes:\n$$ \\mathbf{Q}_s = \\mathbf{L}_s^\\top \\mathbf{q}_s $$\nThe inverse transformation is:\n$$ \\mathbf{q}_s = \\mathbf{L}_s \\mathbf{Q}_s $$\n\nTo derive the Duschinsky transformation, $\\mathbf{Q}_f = \\mathbf{J} \\mathbf{Q}_i + \\mathbf{K}$, we start with the definition of $\\mathbf{Q}_f$ and substitute the relationships established above:\n$$ \\mathbf{Q}_f = \\mathbf{L}_f^\\top \\mathbf{q}_f $$\nSubstitute the relation $\\mathbf{q}_f = \\mathbf{q}_i - (\\mathbf{g}_f - \\mathbf{g}_i)$:\n$$ \\mathbf{Q}_f = \\mathbf{L}_f^\\top \\left[ \\mathbf{q}_i - (\\mathbf{g}_f - \\mathbf{g}_i) \\right] $$\nNext, express the initial state's Cartesian displacement $\\mathbf{q}_i$ in terms of its normal coordinates $\\mathbf{Q}_i$ using $\\mathbf{q}_i = \\mathbf{L}_i \\mathbf{Q}_i$:\n$$ \\mathbf{Q}_f = \\mathbf{L}_f^\\top \\left[ (\\mathbf{L}_i \\mathbf{Q}_i) - (\\mathbf{g}_f - \\mathbf{g}_i) \\right] $$\nDistributing the matrix $\\mathbf{L}_f^\\top$ yields the final form:\n$$ \\mathbf{Q}_f = (\\mathbf{L}_f^\\top \\mathbf{L}_i) \\mathbf{Q}_i - \\mathbf{L}_f^\\top (\\mathbf{g}_f - \\mathbf{g}_i) $$\nBy comparing this result with the general form of the Duschinsky transformation, $\\mathbf{Q}_f = \\mathbf{J} \\mathbf{Q}_i + \\mathbf{K}$, we identify the Duschinsky rotation matrix $\\mathbf{J}$ and the displacement vector $\\mathbf{K}$:\n$$ \\mathbf{J} = \\mathbf{L}_f^\\top \\mathbf{L}_i $$\n$$ \\mathbf{K} = - \\mathbf{L}_f^\\top (\\mathbf{g}_f - \\mathbf{g}_i) $$\n\nThe problem requires two validation checks for each test case.\n\n1.  **Positivity of Frequencies**: A physically stable molecule must have real vibrational frequencies. This translates to the mathematical requirement that the Hessian matrix be positive-definite, meaning all its eigenvalues $\\lambda_k^{(s)}$ must be strictly positive. We must check if $\\lambda_k^{(s)} > \\varepsilon_{\\mathrm{pos}}$ for all modes $k$ in both states $s \\in \\{i, f\\}$, where the tolerance is given as $\\varepsilon_{\\mathrm{pos}} = 10^{-12}$. A negative eigenvalue would imply an imaginary frequency and correspond to a saddle point on the potential energy surface, not a minimum.\n\n2.  **Orthogonality of the Duschinsky Matrix**: The matrix $\\mathbf{J}$ is constructed as the product of two orthogonal matrices, $\\mathbf{L}_f^\\top$ and $\\mathbf{L}_i$. The product of orthogonal matrices is itself orthogonal. An orthogonal matrix must satisfy the condition $\\mathbf{J}^\\top \\mathbf{J} = \\mathbf{I}$. Due to the limitations of floating-point arithmetic, this equality may not hold exactly. Therefore, we validate the numerical orthogonality by computing the Frobenius norm of the residual matrix $\\mathbf{J}^\\top \\mathbf{J} - \\mathbf{I}$ and ensuring it is below a specified tolerance $\\varepsilon_{\\mathrm{orth}} = 10^{-10}$. The Frobenius norm of a matrix $\\mathbf{M}$ is defined as $\\|\\mathbf{M}\\|_F = \\sqrt{\\sum_{j,k} |M_{jk}|^2}$.\n\nThe implementation will proceed by calculating the eigenvalues and eigenvectors for each Hessian, then performing these two checks. A test case is valid if and only if both checks pass.\n\n-   **Case A**: All eigenvalues are positive. $\\mathbf{L}_i$ is identity, so $\\mathbf{J} = \\mathbf{L}_f^\\top$, which is orthogonal. Both checks pass.\n-   **Case B**: Trivial case where initial and final states are identical. $\\mathbf{H}_i=\\mathbf{H}_f$, $\\mathbf{g}_i=\\mathbf{g}_f$. Eigenvalues are positive. $\\mathbf{J}=\\mathbf{I}$ which is perfectly orthogonal. Both checks pass.\n-   **Case C**: The eigenvalues of $\\mathbf{H}_i$ are $1.0\\times 10^{-6}$ and $2.0$, both greater than $\\varepsilon_{\\mathrm{pos}} = 10^{-12}$. Eigenvalues of $\\mathbf{H}_f$ are also positive. Orthogonality holds as in Case A. Both checks pass.\n-   **Case D**: The Hessian $\\mathbf{H}_i$ has an eigenvalue of $-0.1$. This violates the positivity condition, as $-0.1 \\ngtr 10^{-12}$. The check fails.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the Duschinsky transformation problem for a suite of test cases.\n    For each case, it derives the Duschinsky matrix J and vector K,\n    and validates the physical and mathematical consistency of the inputs.\n    \"\"\"\n\n    # Tolerances for validation checks\n    EPS_ORTH = 1e-10\n    EPS_POS = 1e-12\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"name\": \"Case A\",\n            \"gi\": np.array([0.0, 0.0]),\n            \"gf\": np.array([0.2, -0.1]),\n            \"Hi\": np.array([[1.0, 0.0], \n                            [0.0, 4.0]]),\n            \"Hf\": np.array([[2.08733219254516, 0.282321236697517],\n                            [0.282321236697517, 2.91266780745484]]),\n        },\n        {\n            \"name\": \"Case B\",\n            \"gi\": np.array([0.1, -0.2, 0.3]),\n            \"gf\": np.array([0.1, -0.2, 0.3]),\n            \"Hi\": np.array([[1.0, 0.0, 0.0],\n                            [0.0, 2.0, 0.0],\n                            [0.0, 0.0, 3.0]]),\n            \"Hf\": np.array([[1.0, 0.0, 0.0],\n                            [0.0, 2.0, 0.0],\n                            [0.0, 0.0, 3.0]]),\n        },\n        {\n            \"name\": \"Case C\",\n            \"gi\": np.array([0.0, 0.0]),\n            \"gf\": np.array([0.001, -0.002]),\n            \"Hi\": np.array([[1.0e-6, 0.0], \n                            [0.0, 2.0]]),\n            \"Hf\": np.array([[1.5, 0.2], \n                            [0.2, 1.0]]),\n        },\n        {\n            \"name\": \"Case D\",\n            \"gi\": np.array([0.0, 0.0]),\n            \"gf\": np.array([0.0, 0.0]),\n            \"Hi\": np.array([[1.0, 0.0], \n                            [0.0, -0.1]]),\n            \"Hf\": np.array([[2.0, 0.0], \n                            [0.0, 2.5]]),\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        gi, gf, Hi, Hf = case[\"gi\"], case[\"gf\"], case[\"Hi\"], case[\"Hf\"]\n\n        # Step 1: Diagonalize Hessians to get eigenvalues and eigenvectors (normal modes)\n        # numpy.linalg.eigh is used for symmetric matrices. It returns eigenvalues\n        # in ascending order and corresponding eigenvectors as columns of a matrix.\n        try:\n            lambda_i, L_i = np.linalg.eigh(Hi)\n            lambda_f, L_f = np.linalg.eigh(Hf)\n        except np.linalg.LinAlgError:\n            # This would catch non-converging algorithms, but eigh is robust for symmetric matrices.\n            results.append(False)\n            continue\n\n        # Step 2: Validate positivity of vibrational frequencies (eigenvalues)\n        positivity_valid_i = np.all(lambda_i > EPS_POS)\n        positivity_valid_f = np.all(lambda_f > EPS_POS)\n        positivity_valid = positivity_valid_i and positivity_valid_f\n\n        if not positivity_valid:\n            results.append(False)\n            continue\n\n        # Step 3: Construct the Duschinsky rotation matrix J and displacement vector K\n        # J = L_f^T * L_i\n        J = L_f.T @ L_i\n        \n        # d_g = g_f - g_i\n        # K = -L_f^T * d_g\n        # The calculation of K is included for completeness but not required for validation.\n        # d_g = gf - gi\n        # K = -L_f.T @ d_g\n\n        # Step 4: Validate orthogonality of the Duschinsky matrix J\n        # We check if the Frobenius norm of (J^T * J - I) is close to zero.\n        dim = J.shape[0]\n        identity_matrix = np.identity(dim)\n        residual_matrix = J.T @ J - identity_matrix\n        ortho_norm = np.linalg.norm(residual_matrix, 'fro')\n        \n        orthogonality_valid = ortho_norm  EPS_ORTH\n\n        # The result for the case is true if and only if both validations pass.\n        final_result = positivity_valid and orthogonality_valid\n        results.append(final_result)\n\n    # Final print statement in the exact required format.\n    # Python's str() for booleans produces \"True\" and \"False\".\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2929663"}]}