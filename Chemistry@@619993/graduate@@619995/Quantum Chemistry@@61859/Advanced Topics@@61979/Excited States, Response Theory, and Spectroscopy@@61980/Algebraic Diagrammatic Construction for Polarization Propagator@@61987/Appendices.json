{"hands_on_practices": [{"introduction": "The first step in applying any quantum chemistry method is to master its fundamental building blocks. This exercise focuses on the formalism of the first-order Algebraic Diagrammatic Construction, ADC(1), for a closed-shell reference system. You will construct the correctly spin-adapted single excitation configurations that form the basis for describing singlet and triplet states, and then derive the ADC(1) matrix elements that govern their interactions, providing a clear insight into the method's structure [@problem_id:2873860].", "problem": "Consider a closed-shell Hartree–Fock reference state $|\\Phi_{0}\\rangle$ built from orthonormal canonical spatial orbitals $\\{\\phi_{p}\\}$ and spin functions $\\alpha$ and $\\beta$. Let $i,j$ denote occupied spatial orbital indices and $a,b$ denote virtual spatial orbital indices. The electronic Hamiltonian in second quantization is\n$$\n\\hat{H} \\;=\\; \\sum_{pq} h_{pq} \\sum_{\\sigma\\in\\{\\alpha,\\beta\\}} \\hat{a}^{\\dagger}_{p\\sigma}\\hat{a}_{q\\sigma}\n\\;+\\; \\frac{1}{2}\\sum_{pqrs} v_{pqrs} \\sum_{\\sigma,\\sigma'\\in\\{\\alpha,\\beta\\}} \\hat{a}^{\\dagger}_{p\\sigma}\\hat{a}^{\\dagger}_{q\\sigma'}\\hat{a}_{s\\sigma'}\\hat{a}_{r\\sigma},\n$$\nwith the usual anticommutation relations for fermionic operators and real, orthonormal Hartree–Fock canonical orbitals such that the Fock matrix is diagonal with orbital energies $\\{\\varepsilon_{p}\\}$. Define the one-particle–one-hole ($1p1h$) Slater determinants\n$$\n|\\,\\Phi_{i\\to a}^{\\alpha}\\rangle \\;=\\; \\hat{a}^{\\dagger}_{a\\alpha}\\hat{a}_{i\\alpha}\\,|\\Phi_{0}\\rangle,\\qquad\n|\\,\\Phi_{i\\to a}^{\\beta}\\rangle \\;=\\; \\hat{a}^{\\dagger}_{a\\beta}\\hat{a}_{i\\beta}\\,|\\Phi_{0}\\rangle.\n$$\nThe Algebraic Diagrammatic Construction (ADC) for the polarization propagator at first order (ADC(1)) retains only $1p1h$ intermediate states and their independent-particle couplings consistent with the Hartree–Fock reference.\n\n1. Construct normalized spin-adapted $1p1h$ intermediate states for singlet ($S=0$) and triplet ($S=1$) excitations from the spin-orbital excitations $|\\,\\Phi_{i\\to a}^{\\alpha}\\rangle$ and $|\\,\\Phi_{i\\to a}^{\\beta}\\rangle$. Explicitly verify their normalization and orthogonality.\n\n2. Starting from the second-quantized Hamiltonian and the Hartree–Fock canonical orbital conditions, derive the spin-coupled secular matrix elements for both singlet and triplet manifolds between spin-adapted $1p1h$ states at the ADC(1) level (equivalent to Configuration Interaction Singles). Compare the resulting matrices and derive the expression for the singlet–triplet splitting for an excitation $i \\to a$.\n\n3. Let $\\hat{O}$ be a spin-independent one-electron operator with matrix elements $O_{pq}$ in the spatial-orbital basis, so that\n$$\n\\hat{O} \\;=\\; \\sum_{pq} O_{pq}\\sum_{\\sigma\\in\\{\\alpha,\\beta\\}} \\hat{a}^{\\dagger}_{p\\sigma}\\hat{a}_{q\\sigma}.\n$$\nCompute the ground-to-excited transition amplitudes $T_{S}=\\langle\\Phi_{0}|\\hat{O}|S_{ia}\\rangle$ and $T_{T}=\\langle\\Phi_{0}|\\hat{O}|T_{ia}^{(0)}\\rangle$ in terms of $O_{ia}$, where $|S_{ia}\\rangle$ is the spin-adapted singlet state and $|T_{ia}^{(0)}\\rangle$ is the $M_{S}=0$ triplet-coupled state. Express your final answer as the ordered pair $\\big(T_{S},\\,T_{T}\\big)$.\n\nAnswer form requirement: Provide the ordered pair as a single row matrix. No numerical rounding is required. No units are needed.", "solution": "This problem must be approached with methodical rigor. We will proceed by addressing each of the three parts in sequence, after confirming the validity of the problem statement.\n\nThe problem is scientifically grounded, well-posed, and objective. It is a standard, albeit detailed, exercise in the application of many-body quantum chemistry formalisms, specifically the Algebraic Diagrammatic Construction (ADC) method for electronic excitations. All givens are standard definitions in the field. Therefore, the problem is valid, and we shall construct the solution.\n\nPart 1: Construction and Verification of Spin-Adapted States\n\nWe are given the spin-orbital $1p1h$ (one-particle, one-hole) excited Slater determinants $|\\,\\Phi_{i\\to a}^{\\alpha}\\rangle = \\hat{a}^{\\dagger}_{a\\alpha}\\hat{a}_{i\\alpha}\\,|\\Phi_{0}\\rangle$ and $|\\,\\Phi_{i\\to a}^{\\beta}\\rangle = \\hat{a}^{\\dagger}_{a\\beta}\\hat{a}_{i\\beta}\\,|\\Phi_{0}\\rangle$. The reference state $|\\Phi_0\\rangle$ is a closed-shell singlet state, with total spin $S=0$ and projection $M_S=0$. Applying the excitation operator $\\hat{a}^{\\dagger}_{a\\sigma}\\hat{a}_{i\\sigma}$ removes an electron with spin $\\sigma$ from an occupied spatial orbital $\\phi_i$ and places it in a virtual spatial orbital $\\phi_a$ with the same spin. The change in the total spin projection is $\\Delta M_S = (\\pm \\frac{1}{2}) - (\\pm \\frac{1}{2}) = 0$, so both $|\\,\\Phi_{i\\to a}^{\\alpha}\\rangle$ and $|\\,\\Phi_{i\\to a}^{\\beta}\\rangle$ are states with $M_S=0$.\n\nA linear combination of these two $M_S=0$ states yields the spin-adapted singlet ($S=0, M_S=0$) and triplet ($S=1, M_S=0$) states. The correct linear combinations are:\nSinglet state: $$|S_{ia}\\rangle = \\frac{1}{\\sqrt{2}} \\left( |\\,\\Phi_{i\\to a}^{\\alpha}\\rangle + |\\,\\Phi_{i\\to a}^{\\beta}\\rangle \\right) = \\frac{1}{\\sqrt{2}} \\left( \\hat{a}^{\\dagger}_{a\\alpha}\\hat{a}_{i\\alpha} + \\hat{a}^{\\dagger}_{a\\beta}\\hat{a}_{i\\beta} \\right) |\\Phi_{0}\\rangle$$\nTriplet state ($M_S=0$ component): $$|T_{ia}^{(0)}\\rangle = \\frac{1}{\\sqrt{2}} \\left( |\\,\\Phi_{i\\to a}^{\\alpha}\\rangle - |\\,\\Phi_{i\\to a}^{\\beta}\\rangle \\right) = \\frac{1}{\\sqrt{2}} \\left( \\hat{a}^{\\dagger}_{a\\alpha}\\hat{a}_{i\\alpha} - \\hat{a}^{\\dagger}_{a\\beta}\\hat{a}_{i\\beta} \\right) |\\Phi_{0}\\rangle$$\n\nTo verify normalization and orthogonality, we must first establish the properties of the basis states $|\\,\\Phi_{i\\to a}^{\\sigma}\\rangle$. Since the Hartree-Fock spatial orbitals are orthonormal, the spin-orbitals are also orthonormal. A singly excited determinant $|\\,\\Phi_{i\\to a}^{\\sigma}\\rangle$ is formed by replacing one spin-orbital in $|\\Phi_0\\rangle$. The orthonormality condition between such states is:\n$$ \\langle \\Phi_{i\\to a}^{\\sigma} | \\Phi_{j\\to b}^{\\sigma'} \\rangle = \\delta_{ij}\\delta_{ab}\\delta_{\\sigma\\sigma'} $$\nThis is a standard result of Slater-Condon rules. Specifically, $\\langle \\Phi_{i\\to a}^{\\sigma} | \\Phi_{i\\to a}^{\\sigma} \\rangle = 1$, and states with different excitation indices ($ia \\neq jb$) or different spin ($\\sigma \\neq \\sigma'$) are orthogonal.\n\nNow, we verify the properties of the spin-adapted states:\nNormalization of the singlet state:\n$$ \\langle S_{ia} | S_{jb} \\rangle = \\frac{1}{2} \\left\\langle \\left( |\\,\\Phi_{i\\to a}^{\\alpha}\\rangle + |\\,\\Phi_{i\\to a}^{\\beta}\\rangle \\right) \\middle| \\left( |\\,\\Phi_{j\\to b}^{\\alpha}\\rangle + |\\,\\Phi_{j\\to b}^{\\beta}\\rangle \\right) \\right\\rangle $$\n$$ = \\frac{1}{2} \\left( \\langle \\Phi_{i\\to a}^{\\alpha} | \\Phi_{j\\to b}^{\\alpha} \\rangle + \\langle \\Phi_{i\\to a}^{\\alpha} | \\Phi_{j\\to b}^{\\beta} \\rangle + \\langle \\Phi_{i\\to a}^{\\beta} | \\Phi_{j\\to b}^{\\alpha} \\rangle + \\langle \\Phi_{i\\to a}^{\\beta} | \\Phi_{j\\to b}^{\\beta} \\rangle \\right) $$\nUsing the orthonormality condition $\\langle \\Phi_{i\\to a}^{\\sigma} | \\Phi_{j\\to b}^{\\sigma'} \\rangle = \\delta_{ij}\\delta_{ab}\\delta_{\\sigma\\sigma'}$, the cross-spin terms vanish:\n$$ \\langle S_{ia} | S_{jb} \\rangle = \\frac{1}{2} \\left( \\delta_{ij}\\delta_{ab} + 0 + 0 + \\delta_{ij}\\delta_{ab} \\right) = \\delta_{ij}\\delta_{ab} $$\nThis confirms the states $|S_{ia}\\rangle$ are orthonormal.\n\nNormalization of the triplet state:\n$$ \\langle T_{ia}^{(0)} | T_{jb}^{(0)} \\rangle = \\frac{1}{2} \\left\\langle \\left( |\\,\\Phi_{i\\to a}^{\\alpha}\\rangle - |\\,\\Phi_{i\\to a}^{\\beta}\\rangle \\right) \\middle| \\left( |\\,\\Phi_{j\\to b}^{\\alpha}\\rangle - |\\,\\Phi_{j\\to b}^{\\beta}\\rangle \\right) \\right\\rangle $$\n$$ = \\frac{1}{2} \\left( \\langle \\Phi_{i\\to a}^{\\alpha} | \\Phi_{j\\to b}^{\\alpha} \\rangle - \\langle \\Phi_{i\\to a}^{\\alpha} | \\Phi_{j\\to b}^{\\beta} \\rangle - \\langle \\Phi_{i\\to a}^{\\beta} | \\Phi_{j\\to b}^{\\alpha} \\rangle + \\langle \\Phi_{i\\to a}^{\\beta} | \\Phi_{j\\to b}^{\\beta} \\rangle \\right) $$\n$$ = \\frac{1}{2} \\left( \\delta_{ij}\\delta_{ab} - 0 - 0 + \\delta_{ij}\\delta_{ab} \\right) = \\delta_{ij}\\delta_{ab} $$\nThis confirms the states $|T_{ia}^{(0)}\\rangle$ are orthonormal.\n\nOrthogonality between singlet and triplet states:\n$$ \\langle S_{ia} | T_{jb}^{(0)} \\rangle = \\frac{1}{2} \\left\\langle \\left( |\\,\\Phi_{i\\to a}^{\\alpha}\\rangle + |\\,\\Phi_{i\\to a}^{\\beta}\\rangle \\right) \\middle| \\left( |\\,\\Phi_{j\\to b}^{\\alpha}\\rangle - |\\,\\Phi_{j\\to b}^{\\beta}\\rangle \\right) \\right\\rangle $$\n$$ = \\frac{1}{2} \\left( \\langle \\Phi_{i\\to a}^{\\alpha} | \\Phi_{j\\to b}^{\\alpha} \\rangle - \\langle \\Phi_{i\\to a}^{\\alpha} | \\Phi_{j\\to b}^{\\beta} \\rangle + \\langle \\Phi_{i\\to a}^{\\beta} | \\Phi_{j\\to b}^{\\alpha} \\rangle - \\langle \\Phi_{i\\to a}^{\\beta} | \\Phi_{j\\to b}^{\\beta} \\rangle \\right) $$\n$$ = \\frac{1}{2} \\left( \\delta_{ij}\\delta_{ab} - 0 + 0 - \\delta_{ij}\\delta_{ab} \\right) = 0 $$\nThe singlet and triplet manifolds are mutually orthogonal, as required.\n\nPart 2: ADC(1) Secular Matrix Elements and Singlet-Triplet Splitting\n\nThe ADC(1) method is equivalent to Configuration Interaction Singles (CIS), where the Hamiltonian $\\hat{H}$ is diagonalized in the basis of all singly-excited configurations. We need to derive the matrix elements $M_{ia,jb} = \\langle \\Psi_{ia} | \\hat{H} - E_0 | \\Psi_{jb} \\rangle$ in the spin-adapted singlet ($S$) and triplet ($T$) bases, where $E_0$ is the Hartree-Fock ground state energy.\n\nUsing standard results from many-body theory (or by applying the Slater-Condon rules to the spin-adapted state expressions from Part 1), the secular matrix elements are found to be:\n**Singlet secular matrix:**\n$$ M^{(S)}_{ia,jb} = (\\epsilon_a - \\epsilon_i)\\delta_{ij}\\delta_{ab} + 2(ia|jb) - (ij|ab) $$\n**Triplet secular matrix:**\n$$ M^{(T)}_{ia,jb} = (\\epsilon_a - \\epsilon_i)\\delta_{ij}\\delta_{ab} - (ij|ab) $$\nHere, $(pq|rs)$ are the two-electron integrals in physicist's notation, $(pq|rs) = \\int\\phi_p^*(1)\\phi_r^*(2) v_{12} \\phi_q(1)\\phi_s(2) d\\mathbf{x}_1 d\\mathbf{x}_2$. The two matrices are clearly not identical. The difference lies in the term $2(ia|jb)$, which is present only for singlets. This term is an exchange-like integral that describes the interaction between the created electron-hole pairs.\n\nThe singlet-triplet splitting for a given excitation $i \\to a$ is determined by the difference in the diagonal elements of these matrices:\n$$ \\Delta E_{S-T} = M^{(S)}_{ia,ia} - M^{(T)}_{ia,ia} $$\n$$ \\Delta E_{S-T} = [(\\epsilon_a - \\epsilon_i) + 2(ia|ia) - (ii|aa)] - [(\\epsilon_a - \\epsilon_i) - (ii|aa)] $$\n$$ \\Delta E_{S-T} = 2(ia|ia) = 2K_{ia} $$\nThe splitting is twice the exchange integral $K_{ia}$ between the hole orbital $\\phi_i$ and the particle orbital $\\phi_a$. This is a positive quantity, so the singlet state is always higher in energy than the corresponding triplet state at this level of theory, a result known as Hund's multiplicity rule for excitations.\n\nPart 3: Ground-to-Excited Transition Amplitudes\n\nWe are given a general spin-independent one-electron operator:\n$$ \\hat{O} = \\sum_{pq} O_{pq} \\sum_{\\sigma\\in\\{\\alpha,\\beta\\}} \\hat{a}^{\\dagger}_{p\\sigma}\\hat{a}_{q\\sigma} $$\nWe must compute the transition amplitudes $T_S = \\langle\\Phi_{0}|\\hat{O}|S_{ia}\\rangle$ and $T_T = \\langle\\Phi_{0}|\\hat{O}|T_{ia}^{(0)}\\rangle$.\nFirst, we evaluate the matrix element between the ground state and a spin-orbital excitation $|\\,\\Phi_{i\\to a}^{\\sigma'}\\rangle$:\n$$ \\langle\\Phi_{0}|\\hat{O}|\\,\\Phi_{i\\to a}^{\\sigma'}\\rangle = \\sum_{pq\\sigma} O_{pq} \\langle\\Phi_{0}| \\hat{a}^{\\dagger}_{p\\sigma}\\hat{a}_{q\\sigma} \\hat{a}^{\\dagger}_{a\\sigma'}\\hat{a}_{i\\sigma'} |\\Phi_{0}\\rangle $$\nTo obtain a non-zero result, the string of operators must return the state to $|\\Phi_0\\rangle$. This requires evaluating the vacuum expectation value. The operator $\\hat{a}_{i\\sigma'}$ annihilates an occupied spin-orbital in $|\\Phi_0\\rangle$. The operator $\\hat{a}_{q\\sigma}$ must annihilate the ground state from the left, which implies $q$ must be an occupied orbital index. The operator $\\hat{a}^{\\dagger}_{a\\sigma'}$ creates a particle, and $\\hat{a}^{\\dagger}_{p\\sigma}$ must also create a particle; however, acting on $\\langle\\Phi_0|$, these must be hole creation operators (i.e. particle annihilation), meaning $p$ must be a filled orbital.\nA more direct method is to use operator commutation:\n$$ \\langle\\Phi_{0}| \\hat{a}^{\\dagger}_{p\\sigma}\\hat{a}_{q\\sigma} \\hat{a}^{\\dagger}_{a\\sigma'}\\hat{a}_{i\\sigma'} |\\Phi_{0}\\rangle = \\langle\\Phi_{0}| \\hat{a}^{\\dagger}_{p\\sigma} (\\delta_{qa}\\delta_{\\sigma\\sigma'} - \\hat{a}^{\\dagger}_{a\\sigma'}\\hat{a}_{q\\sigma}) \\hat{a}_{i\\sigma'} |\\Phi_{0}\\rangle $$\nThe second term, $-\\langle\\Phi_{0}| \\hat{a}^{\\dagger}_{p\\sigma} \\hat{a}^{\\dagger}_{a\\sigma'} \\hat{a}_{q\\sigma} \\hat{a}_{i\\sigma'} |\\Phi_{0}\\rangle$, is zero because for a non-zero element, $q$ must be occupied, and $a$ is virtual, so $\\hat{a}^{\\dagger}_{a\\sigma'}\\hat{a}_{q\\sigma}$ operating on $|\\Phi_0\\rangle$ produces an excited state which is orthogonal to the state produced by $\\langle\\Phi_0|\\hat{a}^{\\dagger}_{p\\sigma}$.\nThe first term gives:\n$$ \\delta_{qa}\\delta_{\\sigma\\sigma'} \\langle\\Phi_{0}| \\hat{a}^{\\dagger}_{p\\sigma} \\hat{a}_{i\\sigma'} |\\Phi_{0}\\rangle = \\delta_{qa}\\delta_{\\sigma\\sigma'} \\langle\\Phi_{0}| \\hat{a}^{\\dagger}_{p\\sigma} \\hat{a}_{i\\sigma} |\\Phi_{0}\\rangle $$\nThis is non-zero only if $\\hat{a}_{i\\sigma}|\\Phi_0\\rangle$ creates a hole state, which is then annihilated by $\\langle\\Phi_0|\\hat{a}^{\\dagger}_{p\\sigma}$. This requires $p=i$. The expectation value is $1$. So, the matrix element is $\\delta_{qa}\\delta_{pi}\\delta_{\\sigma\\sigma'}$.\nSubstituting this back into the sum:\n$$ \\langle\\Phi_{0}|\\hat{O}|\\,\\Phi_{i\\to a}^{\\sigma'}\\rangle = \\sum_{pq\\sigma} O_{pq} \\delta_{qa}\\delta_{pi}\\delta_{\\sigma\\sigma'} = O_{ia} $$\nThis result is independent of the spin $\\sigma'$.\n\nNow we compute $T_S$ and $T_T$:\nSinglet transition amplitude:\n$$ T_S = \\langle\\Phi_{0}|\\hat{O}|S_{ia}\\rangle = \\frac{1}{\\sqrt{2}} \\left( \\langle\\Phi_{0}|\\hat{O}|\\,\\Phi_{i\\to a}^{\\alpha}\\rangle + \\langle\\Phi_{0}|\\hat{O}|\\,\\Phi_{i\\to a}^{\\beta}\\rangle \\right) $$\n$$ T_S = \\frac{1}{\\sqrt{2}} (O_{ia} + O_{ia}) = \\frac{2}{\\sqrt{2}} O_{ia} = \\sqrt{2} O_{ia} $$\n\nTriplet transition amplitude:\n$$ T_T = \\langle\\Phi_{0}|\\hat{O}|T_{ia}^{(0)}\\rangle = \\frac{1}{\\sqrt{2}} \\left( \\langle\\Phi_{0}|\\hat{O}|\\,\\Phi_{i\\to a}^{\\alpha}\\rangle - \\langle\\Phi_{0}|\\hat{O}|\\,\\Phi_{i\\to a}^{\\beta}\\rangle \\right) $$\n$$ T_T = \\frac{1}{\\sqrt{2}} (O_{ia} - O_{ia}) = 0 $$\nThe result $T_T=0$ is expected from the spin selection rule $\\Delta S = 0$. The singlet ground state ($S=0$) cannot transition to a triplet excited state ($S=1$) via a spin-independent operator.\n\nThe final ordered pair is $(T_S, T_T)$.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\sqrt{2} O_{ia} & 0\n\\end{pmatrix}\n}\n$$", "id": "2873860"}, {"introduction": "With the formalism in hand, we can now critically assess the performance of the ADC(1) method. This practice utilizes the two-site Hubbard dimer, a canonical model system in quantum chemistry, as a theoretical laboratory to compare ADC(1) and the related Random Phase Approximation (RPA) against the exact solution. By analyzing the behavior of these methods from the weakly to the strongly correlated regimes, you will gain a concrete understanding of their domains of validity and the fundamental reasons for their failure when static correlation becomes significant [@problem_id:2873797].", "problem": "Consider the half-filled two-site single-band Hubbard dimer with Hamiltonian\n$$\n\\hat{H} \\;=\\; -\\,t \\sum_{\\sigma \\in \\{\\alpha,\\beta\\}} \\left(\\hat{a}_{1\\sigma}^{\\dagger}\\hat{a}_{2\\sigma} + \\hat{a}_{2\\sigma}^{\\dagger}\\hat{a}_{1\\sigma}\\right) \\;+\\; U \\sum_{i=1}^{2} \\hat{n}_{i\\alpha}\\hat{n}_{i\\beta},\n$$\nwhere $t>0$ is the hopping parameter, $U \\ge 0$ is the on-site repulsion, and $\\hat{n}_{i\\sigma}=\\hat{a}_{i\\sigma}^{\\dagger}\\hat{a}_{i\\sigma}$. Work at half-filling with two electrons in a singlet ground state. The linear-response polarization propagator is defined as\n$$\nP_{ij}(\\omega) \\;=\\; -\\,\\mathrm{i}\\int_{-\\infty}^{\\infty} \\mathrm{d}t \\; \\exp(\\mathrm{i}\\omega t) \\;\\langle \\Psi_0 \\,|\\, \\mathcal{T}\\,\\delta \\hat{n}_i(t)\\,\\delta \\hat{n}_j(0)\\,|\\, \\Psi_0\\rangle,\n$$\nwith $\\delta \\hat{n}_i=\\hat{n}_i - \\langle \\Psi_0|\\hat{n}_i|\\Psi_0\\rangle$ and $|\\Psi_0\\rangle$ the many-body ground state. The Algebraic Diagrammatic Construction (ADC) hierarchy for the polarization propagator at first order, denoted ADC(1), is equivalent to the Tamm–Dancoff Approximation (TDA) built on a Restricted Hartree–Fock (RHF) reference for a closed shell. The Random Phase Approximation (RPA) corresponds to full time-dependent Hartree–Fock (TDHF).\n\nStarting from these fundamental definitions and using only the Hubbard Hamiltonian above and the half-filled RHF reference with the bonding–antibonding molecular orbital basis, do the following:\n\n1) Derive the RHF canonical molecular orbitals and orbital energy difference for the bonding ($g$) and antibonding ($u$) orbitals in terms of $t$ and $U$.\n\n2) Construct the ADC(1) (equivalently Tamm–Dancoff) secular problem in the spin-singlet particle–hole space spanned by the single excitation $g\\to u$, and obtain the ADC(1) singlet excitation energy $\\Omega_{\\mathrm{ADC(1)}}$.\n\n3) Construct the RPA (full TDHF) $A$ and $B$ matrices in the same one-dimensional singlet particle–hole space and obtain the RPA singlet excitation energy $\\Omega_{\\mathrm{RPA}}$.\n\n4) Solve the exact singlet spectrum by explicit diagonalization of the singlet block of $\\hat{H}$, determine the ground-state energy and the two singlet excited-state energies, and identify the lowest singlet excitation energy $\\Omega_{\\mathrm{exact}}$ as the difference between the lowest excited singlet and the ground state.\n\n5) Analyze the small-correlation regime ($U/t \\ll 1$) by expanding $\\Omega_{\\mathrm{ADC(1)}}$, $\\Omega_{\\mathrm{RPA}}$, and $\\Omega_{\\mathrm{exact}}$ to second order in $U/t$, and the strong-correlation regime ($U/t \\gg 1$) by expanding them to leading nontrivial order in $t/U$. Based on these expansions, explain in which regimes ADC(1) and RPA succeed or fail for the lowest singlet excitation of the dimer, and why.\n\nFinally, report the exact lowest singlet excitation energy $\\Omega_{\\mathrm{exact}}$ as a single closed-form analytic expression in terms of $t$ and $U$. Do not assign numerical values. Do not include units in your final reported expression. Your final answer must be only that single expression.", "solution": "The problem requires a thorough analysis of the electronic excitation spectrum of a two-site Hubbard dimer at half-filling, comparing standard quantum chemical approximations—namely, the first-order Algebraic Diagrammatic Construction (ADC(1)), equivalent to the Tamm–Dancoff Approximation (TDA), and the Random Phase Approximation (RPA)—against the exact solution. The analysis is to be performed in both the weak and strong electron correlation regimes.\n\nFirst, we validate the problem statement. The problem is scientifically grounded, utilizing the standard Hubbard model and well-established many-body approximation schemes (RHF, TDA, RPA). It is well-posed, with all necessary parameters and definitions provided for a unique solution to be derived. The language is objective and precise. The problem is a standard, yet non-trivial, exercise in theoretical chemistry that demonstrates the capabilities and limitations of these methods. The problem is therefore deemed valid and a full solution shall be provided.\n\nLet the atomic orbital (AO) basis be $\\{|\\phi_1\\rangle, |\\phi_2\\rangle\\}$. The molecular orbitals (MOs) are formed by symmetry as the bonding (gerade, $g$) and antibonding (ungerade, $u$) combinations:\n$$|\\psi_g\\rangle = \\frac{1}{\\sqrt{2}}(|\\phi_1\\rangle + |\\phi_2\\rangle)$$\n$$|\\psi_u\\rangle = \\frac{1}{\\sqrt{2}}(|\\phi_1\\rangle - |\\phi_2\\rangle)$$\n\n**1) Restricted Hartree–Fock (RHF) Solution**\n\nThe RHF ground state for a two-electron closed-shell system is a single Slater determinant where the lowest energy MO, $|\\psi_g\\rangle$, is doubly occupied: $|\\Psi_{RHF}\\rangle = \\hat{c}_{g\\alpha}^{\\dagger}\\hat{c}_{g\\beta}^{\\dagger}|vac\\rangle$. The canonical orbital energies $\\epsilon_p$ are the eigenvalues of the Fock operator, $\\hat{f} = \\hat{h} + \\hat{v}_{HF}$, where $\\hat{h}$ is the one-electron part of the Hamiltonian and $\\hat{v}_{HF}$ is the mean-field potential. The Fock matrix elements in the MO basis are $F_{pq} = \\langle \\psi_p | \\hat{f} | \\psi_q \\rangle$.\n\nThe one-electron Hamiltonian matrix elements in the MO basis are:\n$h_{gg} = \\langle \\psi_g | \\hat{h} | \\psi_g \\rangle = \\frac{1}{2}(\\langle\\phi_1+\\phi_2|\\hat{h}|\\phi_1+\\phi_2\\rangle) = \\frac{1}{2}(-t-t) = -t$\n$h_{uu} = \\langle \\psi_u | \\hat{h} | \\psi_u \\rangle = \\frac{1}{2}(\\langle\\phi_1-\\phi_2|\\hat{h}|\\phi_1-\\phi_2\\rangle) = \\frac{1}{2}(t+t) = t$\n$h_{gu} = 0$ by symmetry.\n\nFor the two-electron part, we require the MO integrals $(pr|qs) = \\int\\psi_p^*(1)\\psi_r(1) v(1,2) \\psi_q^*(2)\\psi_s(2) d1d2$. For the Hubbard Hamiltonian, the only non-zero AO integrals are on-site, i.e., $(ii|ii) = U$. Transforming to the MO basis:\n$(gg|gg) = (\\frac{1}{\\sqrt{2}})^4 U + (\\frac{1}{\\sqrt{2}})^4 U = \\frac{U}{2}$\n$(uu|uu) = (\\frac{1}{\\sqrt{2}})^4 U + (\\frac{-1}{\\sqrt{2}})^4 U = \\frac{U}{2}$\n$(gg|uu) = (\\frac{1}{\\sqrt{2}})^2(\\frac{1}{\\sqrt{2}})^2 U + (\\frac{1}{\\sqrt{2}})^2(\\frac{-1}{\\sqrt{2}})^2 U = \\frac{U}{2}$\n$(gu|gu) = (\\frac{1}{\\sqrt{2}})^2(\\frac{1}{\\sqrt{2}})^2 U + (\\frac{1}{\\sqrt{2}})^2(\\frac{-1}{\\sqrt{2}})^2 U = \\frac{U}{2}$\n$(gu|ug) = \\sum_{i}C_{gi}^2 C_{ui}^2 (ii|ii)_{AO} = C_{g1}^2C_{u1}^2 U + C_{g2}^2C_{u2}^2 U = (\\frac{1}{2})(\\frac{1}{2})U + (\\frac{1}{2})(\\frac{1}{2})U = \\frac{U}{2}$.\n\nThe Fock matrix elements for a closed-shell reference are $F_{pq} = h_{pq} + \\sum_{k \\in occ} [2(pk|qk) - (pk|kq)]$. Here, the only occupied MO is $k=g$.\n$\\epsilon_g = F_{gg} = h_{gg} + 2(gg|gg) - (gg|gg) = h_{gg} + (gg|gg) = -t + \\frac{U}{2}$.\n$\\epsilon_u = F_{uu} = h_{uu} + 2(ug|ug) - (ug|gu) = h_{uu} + 2(uu|gg) - (ug|ug) = t + 2(\\frac{U}{2}) - \\frac{U}{2} = t + \\frac{U}{2}$.\nThe orbital energy difference is $\\Delta\\epsilon = \\epsilon_u - \\epsilon_g = (t + \\frac{U}{2}) - (-t + \\frac{U}{2}) = 2t$.\n\n**2) ADC(1) / Tamm–Dancoff Approximation (TDA)**\n\nADC(1) is equivalent to TDA, which for singlet states is also known as Configuration Interaction Singles (CIS). The secular matrix is constructed in the basis of single-particle-hole excitations from the RHF reference. For the dimer, there is only one such excitation: $g \\to u$. The matrix is $1 \\times 1$, and its eigenvalue is the excitation energy.\nThe singlet CIS excitation energy for an excitation $i \\to a$ is given by the matrix element $A_{ia,ia}$:\n$\\Omega_{\\mathrm{ADC(1)}} = \\epsilon_u - \\epsilon_g + 2(gu|gu) - (gg|uu)$.\nSubstituting the values derived:\n$\\Omega_{\\mathrm{ADC(1)}} = 2t + 2\\left(\\frac{U}{2}\\right) - \\frac{U}{2} = 2t + \\frac{U}{2}$.\n\n**3) Random Phase Approximation (RPA)**\n\nRPA, equivalent to time-dependent Hartree-Fock (TDHF), yields the following eigenvalue problem for excitation energies $\\Omega$:\n$$\n\\begin{pmatrix} \\mathbf{A} & \\mathbf{B} \\\\ \\mathbf{B}^* & \\mathbf{A}^* \\end{pmatrix}\n\\begin{pmatrix} \\mathbf{X} \\\\ \\mathbf{Y} \\end{pmatrix}\n= \\Omega\n\\begin{pmatrix} \\mathbf{1} & \\mathbf{0} \\\\ \\mathbf{0} & \\mathbf{-1} \\end{pmatrix}\n\\begin{pmatrix} \\mathbf{X} \\\\ \\mathbf{Y} \\end{pmatrix}\n$$\nThe eigenvalues are given by $\\Omega^2$ from the smaller matrix equation $(\\mathbf{A}-\\mathbf{B})(\\mathbf{A}+\\mathbf{B})\\mathbf{Z} = \\Omega^2\\mathbf{Z}$. In our one-dimensional case, this is simply $\\Omega_{\\mathrm{RPA}}^2 = (A-B)(A+B)$.\nThe matrix elements for singlet excitations are:\n$A_{ia, jb} = \\delta_{ij}\\delta_{ab}(\\epsilon_a - \\epsilon_i) + 2(ia|jb) - (ij|ab)$\n$B_{ia, jb} = 2(ia|bj) - (ib|aj)$\nFor the $g \\to u$ excitation:\n$A = \\epsilon_u - \\epsilon_g + 2(gu|gu) - (gg|uu) = 2t + 2\\left(\\frac{U}{2}\\right) - \\frac{U}{2} = 2t + \\frac{U}{2}$.\n$B = 2(gu|ug) - (gg|uu)$. We found $(gu|ug)=\\frac{U}{2}$ and $(gg|uu)=\\frac{U}{2}$.\n$B = 2\\left(\\frac{U}{2}\\right) - \\frac{U}{2} = \\frac{U}{2}$.\nThen we compute:\n$A-B = (2t + \\frac{U}{2}) - \\frac{U}{2} = 2t$\n$A+B = (2t + \\frac{U}{2}) + \\frac{U}{2} = 2t + U$\n$\\Omega_{\\mathrm{RPA}}^2 = (A-B)(A+B) = 2t(2t+U) = 4t^2 + 2tU$.\nThe RPA excitation energy is $\\Omega_{\\mathrm{RPA}} = \\sqrt{4t^2 + 2tU}$.\n\n**4) Exact Diagonalization**\n\nTo find the exact energies, we diagonalize the Hamiltonian in the basis of all two-electron singlet states. There are three such states: two ionic states with double occupancy on one site, and one covalent (Heitler-London) state:\n$|\\Psi_1\\rangle = \\hat{a}_{1\\alpha}^{\\dagger}\\hat{a}_{1\\beta}^{\\dagger}|vac\\rangle$\n$|\\Psi_2\\rangle = \\hat{a}_{2\\alpha}^{\\dagger}\\hat{a}_{2\\beta}^{\\dagger}|vac\\rangle$\n$|\\Psi_3\\rangle = \\frac{1}{\\sqrt{2}}(\\hat{a}_{1\\alpha}^{\\dagger}\\hat{a}_{2\\beta}^{\\dagger} - \\hat{a}_{1\\beta}^{\\dagger}\\hat{a}_{2\\alpha}^{\\dagger})|vac\\rangle$\nThe Hamiltonian matrix elements $\\langle \\Psi_i | \\hat{H} | \\Psi_j \\rangle$ are:\n$H_{11} = H_{22} = U$\n$H_{33} = 0$\n$H_{12} = 0$\n$H_{13} = \\langle \\Psi_1 | \\hat{H} | \\Psi_3 \\rangle = -t\\sqrt{2}$\n$H_{23} = \\langle \\Psi_2 | \\hat{H} | \\Psi_3 \\rangle = -t\\sqrt{2}$\nThe matrix is $\\mathbf{H} = \\begin{pmatrix} U & 0 & -t\\sqrt{2} \\\\ 0 & U & -t\\sqrt{2} \\\\ -t\\sqrt{2} & -t\\sqrt{2} & 0 \\end{pmatrix}$.\nBy using a symmetry-adapted basis $|\\Psi_+\\rangle = \\frac{1}{\\sqrt{2}}(|\\Psi_1\\rangle + |\\Psi_2\\rangle)$ and $|\\Psi_-\\rangle = \\frac{1}{\\sqrt{2}}(|\\Psi_1\\rangle - |\\Psi_2\\rangle)$, the matrix block-diagonalizes. The state $|\\Psi_-\\rangle$ is an eigenstate with energy $U$. The remaining $2 \\times 2$ block is in the basis $\\{|\\Psi_+\\rangle, |\\Psi_3\\rangle\\}$:\n$\\mathbf{H'} = \\begin{pmatrix} U & -2t \\\\ -2t & 0 \\end{pmatrix}$.\nThe eigenvalues $\\lambda$ of this block satisfy $\\lambda(\\lambda - U) - 4t^2 = 0$, or $\\lambda^2 - U\\lambda - 4t^2 = 0$.\nThe solutions are $\\lambda = \\frac{U \\pm \\sqrt{U^2 + 16t^2}}{2}$.\nThe three singlet eigenenergies are, in order of energy for $t>0$:\n$E_0 = \\frac{U - \\sqrt{U^2 + 16t^2}}{2}$ (ground state)\n$E_1 = U$ (first excited state)\n$E_2 = \\frac{U + \\sqrt{U^2 + 16t^2}}{2}$ (second excited state)\nThe lowest singlet excitation energy is the difference between the first excited state and the ground state:\n$\\Omega_{\\mathrm{exact}} = E_1 - E_0 = U - \\frac{U - \\sqrt{U^2 + 16t^2}}{2} = \\frac{U + \\sqrt{U^2 + 16t^2}}{2}$.\n\n**5) Limiting-Case Analysis**\n\nWe now compare the three results in the small- and strong-correlation limits.\nThe expressions are:\n$\\Omega_{\\mathrm{ADC(1)}} = 2t + \\frac{U}{2}$\n$\\Omega_{\\mathrm{RPA}} = \\sqrt{4t^2 + 2tU}$\n$\\Omega_{\\mathrm{exact}} = \\frac{U + \\sqrt{U^2 + 16t^2}}{2}$\n\nSmall-correlation regime ($U/t \\ll 1$):\nWe expand to second order in $U/t$.\n$\\Omega_{\\mathrm{ADC(1)}} = 2t + \\frac{1}{2}U$.\n$\\Omega_{\\mathrm{RPA}} = 2t\\sqrt{1+\\frac{U}{2t}} \\approx 2t(1 + \\frac{1}{2}\\frac{U}{2t} - \\frac{1}{8}(\\frac{U}{2t})^2) = 2t + \\frac{1}{2}U - \\frac{U^2}{16t}$.\n$\\Omega_{\\mathrm{exact}} = \\frac{U}{2} + 2t\\sqrt{1+(\\frac{U}{4t})^2} \\approx \\frac{U}{2} + 2t(1 + \\frac{1}{2}(\\frac{U}{4t})^2) = 2t + \\frac{1}{2}U + \\frac{U^2}{16t}$.\nIn the weak correlation limit, both ADC(1) and RPA are correct to first order in $U$. The exact result shows a stabilizing quadratic correction (excitation costs more energy), while RPA shows a destabilizing one (costs less energy) of the same magnitude. ADC(1) is purely linear and misses this second-order effect entirely. Both methods are qualitatively reasonable for very small $U/t$.\n\nStrong-correlation regime ($t/U \\ll 1$):\nWe expand to leading non-trivial order in $t/U$.\n$\\Omega_{\\mathrm{ADC(1)}} = \\frac{U}{2} + 2t$. This grows linearly with $U$.\n$\\Omega_{\\mathrm{RPA}} = \\sqrt{2tU+4t^2} = \\sqrt{2tU}\\sqrt{1+\\frac{2t}{U}} \\approx \\sqrt{2tU}(1+\\frac{t}{U}) \\approx \\sqrt{2tU}$.\n$\\Omega_{\\mathrm{exact}} = \\frac{U}{2}(1 + \\sqrt{1+16(\\frac{t}{U})^2}) \\approx \\frac{U}{2}(1 + 1 + \\frac{1}{2}16(\\frac{t}{U})^2) = U + \\frac{4t^2}{U}$.\nIn the strong correlation limit, both ADC(1) and RPA fail catastrophically. The exact energy approaches $U$, the cost of creating a double occupancy, plus a correction term $\\propto t^2/U$ from virtual hopping processes. ADC(1) predicts an energy of $U/2$, which is qualitatively incorrect and has the wrong leading behavior. RPA predicts an energy proportional to $\\sqrt{U}$, which is also incorrect.\nThe failure is fundamental. At large $U$, the RHF reference state, which has equal weight of ionic ($|1,1\\rangle, |2,2\\rangle$) and covalent ($|1,2\\rangle$) character, is a very poor approximation to the true ground state, which is almost purely covalent. Methods like TDA and RPA are based on linear response around this poor reference and cannot correct for its fundamental deficiencies. They are designed for perturbative corrections, and strong correlation is a non-perturbative phenomenon.\n\nThe final requirement is to report the exact lowest singlet excitation energy, $\\Omega_{\\mathrm{exact}}$.", "answer": "$$\n\\boxed{\\frac{U + \\sqrt{U^{2} + 16t^{2}}}{2}}\n$$", "id": "2873797"}, {"introduction": "The limitations of lower-order methods in strongly correlated systems naturally lead us to higher-order approximations like ADC(2). However, increased accuracy comes at a significant computational price. This practice moves from pure theory to computational algorithmics, asking you to analyze the dominant tensor contractions and memory requirements for an iterative ADC(2) calculation [@problem_id:2873837]. Understanding this \"sigma-vector\" construction is key to appreciating the computational scaling and implementation challenges of modern electronic structure methods.", "problem": "Consider the Algebraic Diagrammatic Construction (ADC) for the polarization propagator at order $2$ (written $\\text{ADC}(2)$) in the intermediate-state representation built on canonical Hartree–Fock orbitals. Let the occupied and virtual orbital index sets be $i,j,k,\\ldots$ and $a,b,c,\\ldots$, with cardinalities $n_o$ and $n_v$, respectively. Denote the antisymmetrized two-electron integrals by $\\langle pq \\Vert rs \\rangle$ in the molecular orbital basis, the Fock matrix by $f_{pq}$, and the orbital energies by $\\epsilon_p$. In an iterative Krylov subspace eigensolver such as Davidson or Lanczos, one applies the effective $\\text{ADC}(2)$ matrix to a trial vector whose singles component has elements $X_{ai}$; the resulting “sigma” vector has elements $\\Sigma_{ai}$ of the same dimensionality. Assume:\n- Canonical Hartree–Fock orbitals (so that $f_{pq}$ is diagonal in this basis),\n- Conventional four-index two-electron integrals (no density fitting or Cholesky decomposition),\n- The doubles ($2p2h$) block of the $\\text{ADC}(2)$ effective matrix is diagonal in the canonical orbital basis,\n- No spin adaptation is enforced beyond antisymmetrization of $\\langle pq \\Vert rs \\rangle$.\n\nFrom first principles about how the polarization propagator is built in $\\text{ADC}(2)$ as a second-order Møller–Plesset perturbative approximation and how folding out the $2p2h$ sector yields an effective action on the singles sector, choose the option that correctly identifies the dominant tensor contractions needed to build the action of the $\\text{ADC}(2)$ matrix on a vector in a Davidson/Lanczos iteration and correctly characterizes their asymptotic arithmetic cost and main-memory traffic in terms of $n_o$ and $n_v$. “Dominant” means asymptotically leading in $n_o$ and $n_v$ under the stated assumptions.\n\nA. The sigma build consists of (i) a CIS-like singles–singles part with terms linear in $f_{pq}$ and $\\langle pq \\Vert rs \\rangle$, scaling as $\\mathcal{O}(n_o^2 n_v^2)$; and (ii) a folded $2p2h$ contribution realized as a generate–propagate–project sequence: first form an intermediate $Y_{abij}$ by contracting $\\langle ij \\Vert a c \\rangle$ with $X_{cb}$ and $\\langle k j \\Vert a b \\rangle$ with $X_{a k}$ to the appropriate antisymmetry, then apply the diagonal inverse resolvent $R^{-1}_{abij} = (\\epsilon_a + \\epsilon_b - \\epsilon_i - \\epsilon_j)^{-1}$ elementwise to obtain $Z_{abij}$, and finally project back to $\\Sigma_{ai}$ by contracting $\\langle i j \\Vert a b \\rangle$ with $Z_{abij}$ (with the required index permutations). The generate and project steps scale as $\\mathcal{O}(n_o^2 n_v^3 + n_o^3 n_v^2)$ each; the propagate step is $\\mathcal{O}(n_o^2 n_v^2)$. The dominant traffic is streaming the four-index $\\langle ij \\Vert a b \\rangle$ tensor and the $Y_{abij}$/$Z_{abij}$ intermediates, each of size $\\mathcal{O}(n_o^2 n_v^2)$ elements, while $X_{ai}$ and $\\Sigma_{ai}$ are $\\mathcal{O}(n_o n_v)$ and thus subdominant. Arithmetic intensity is low unless aggressive blocking is used.\n\nB. The dominant work in the sigma build arises from explicit triples-like contractions involving effective three-electron integrals, scaling as $\\mathcal{O}(n_o^3 n_v^3)$, because the $\\text{ADC}(2)$ matrix contains an effective three-body interaction in the folded representation. Memory traffic is dominated by forming and storing $\\mathcal{O}(n_o^3 n_v^3)$ intermediates per iteration.\n\nC. Because the $2p2h$ space is folded out exactly at order $2$, the sigma build reduces to a pure singles–singles operation. The only dominant contraction is the CIS-like two-electron term $\\Sigma_{ai} \\leftarrow \\sum_{b j} \\langle a j \\Vert i b \\rangle X_{b j}$ with cost $\\mathcal{O}(n_o^2 n_v^2)$; no intermediates of size $\\mathcal{O}(n_o^2 n_v^2)$ are formed, and the memory traffic is dominated by streaming $X_{ai}$.\n\nD. Using the resolution of the identity (density fitting) to factorize $\\langle pq \\Vert rs \\rangle \\approx \\sum_Q B_{p r}^Q B_{q s}^Q$ with an auxiliary rank $m$, the dominant sigma-build contractions reduce to general matrix–matrix multiplies of cost $\\mathcal{O}(m n_o n_v)$, and the memory traffic is $\\mathcal{O}(m n_o n_v)$ because no four-index quantities are ever streamed.\n\nE. The sigma build is dominated by precomputing and storing a six-index intermediate $T_{a i}^{b j c k} = \\sum_{p q} \\langle a i \\Vert p q \\rangle \\langle p q \\Vert b j \\rangle \\delta_{c k}$ of size $\\mathcal{O}(n_o^3 n_v^3)$, which is then applied to $X_{ai}$ in $\\mathcal{O}(n_o^3 n_v^3)$ time; memory traffic is dominated by writing and reading $T$ on each iteration.", "solution": "The problem statement must first be validated.\n\n**Step 1: Extract Givens**\n-   Method: Algebraic Diagrammatic Construction at order $2$, $\\text{ADC}(2)$, for the polarization propagator.\n-   Representation: Intermediate-state representation (ISR).\n-   Basis: Canonical Hartree–Fock (HF) orbitals.\n-   Indices: Occupied orbitals $i,j,k,\\ldots$ ($n_o$ total); virtual orbitals $a,b,c,\\ldots$ ($n_v$ total).\n-   Quantities: Antisymmetrized two-electron integrals $\\langle pq \\Vert rs \\rangle$, diagonal Fock matrix $f_{pq}$ with eigenvalues (orbital energies) $\\epsilon_p$.\n-   Algorithm: Iterative Krylov subspace eigensolver (e.g., Davidson) for the $\\text{ADC}(2)$ eigenvalue problem.\n-   `sigma` vector generation: The action of the effective $\\text{ADC}(2)$ matrix on a trial vector. The singles-space component of the trial vector is $X_{ai}$, and the result is $\\Sigma_{ai}$.\n-   Assumptions:\n    1.  Canonical HF orbitals are used.\n    2.  Conventional four-index two-electron integrals are used (no integral factorization like density fitting).\n    3.  The doubles ($2p2h$) block of the $\\text{ADC}(2)$ effective matrix is diagonal in the canonical orbital basis.\n    4.  No spin adaptation is considered beyond the antisymmetrization of integrals.\n-   Objective: Identify the dominant tensor contractions for the $\\Sigma_{ai}$ vector construction and their asymptotic arithmetic cost and main-memory traffic in terms of $n_o$ and $n_v$.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is scientifically grounded, describing a standard implementation of the $\\text{ADC}(2)$ method in quantum chemistry. The assumptions are standard for a textbook derivation and analysis of this method. Specifically, using canonical HF orbitals makes the zeroth-order Hamiltonian diagonal, and the key feature of the ISR-based $\\text{ADC}(2)$ is that the doubles-doubles block of the effective Hamiltonian, $\\mathbf{M}_{DD}$, is diagonal at zeroth order in perturbation theory, with elements being sums and differences of orbital energies. The problem is well-posed, asking for a standard computational cost analysis. The language is precise and objective. The problem statement is therefore valid.\n\n**Derivation of the Solution**\nThe $\\text{ADC}(2)$ eigenvalue problem is solved in the space of single ($1p1h$) and double ($2p2h$) electronic excitations. In an iterative solver, the primary computational task per iteration is the matrix-vector product $\\mathbf{\\Sigma} = \\mathbf{M} \\mathbf{X}$, where $\\mathbf{M}$ is the $\\text{ADC}(2)$ effective Hamiltonian matrix. By partitioning the excitation space, the action on the singles component $\\mathbf{X}_S$ (elements $X_{ai}$) to produce $\\mathbf{\\Sigma}_S$ (elements $\\Sigma_{ai}$) can be written as:\n$$ \\mathbf{\\Sigma}_S = \\mathbf{M}_{SS} \\mathbf{X}_S + \\mathbf{M}_{SD} (\\omega\\mathbf{1} - \\mathbf{M}_{DD})^{-1} \\mathbf{M}_{DS} \\mathbf{X}_S $$\nHere, $\\mathbf{M}_{SS}$, $\\mathbf{M}_{DD}$, $\\mathbf{M}_{SD}$, and $\\mathbf{M}_{DS}$ are the singles-singles, doubles-doubles, singles-doubles, and doubles-singles blocks of the matrix, respectively, and $\\omega$ is the current estimate of the excitation energy.\n\nLet us analyze the computational cost of each term.\n\n1.  **The Singles-Singles Contribution: $\\mathbf{M}_{SS} \\mathbf{X}_S$**\n    The CIS-like part of the sigma vector, $(\\Sigma_{ai})^{(1)}$, is given by:\n    $$ (\\Sigma_{ai})^{(1)} = \\sum_{bj} (M_{SS})_{ai,bj} X_{bj} = (\\epsilon_a - \\epsilon_i) X_{ai} + \\sum_{bj} \\langle aj \\Vert ib \\rangle X_{bj} $$\n    The first term is an element-wise product, with a cost of $\\mathcal{O}(n_o n_v)$. The second term is a tensor contraction over four indices ($a, i, b, j$), which scales as $\\mathcal{O}(n_o^2 n_v^2)$. The total cost for this part is dominated by $\\mathcal{O}(n_o^2 n_v^2)$.\n\n2.  **The Folded Doubles Contribution: $\\mathbf{M}_{SD} (\\omega\\mathbf{1} - \\mathbf{M}_{DD})^{-1} \\mathbf{M}_{DS} \\mathbf{X}_S$**\n    This term represents the second-order correction and is computationally more demanding. Its evaluation is efficiently structured as a three-step \"generate-propagate-project\" sequence.\n\n    a.  **Generate:** Formation of an intermediate vector in the doubles space, $\\mathbf{Y}_D = \\mathbf{M}_{DS} \\mathbf{X}_S$. The elements are $Y_{abij} = \\sum_{ck} (M_{DS})_{(ab)(ij),ck} X_{ck}$. The coupling matrix elements $(M_{DS})_{(ab)(ij),ck}$ are given by two-electron integrals. This step involves contractions of the type:\n    $$ Y_{abij} \\sim \\sum_{c} \\langle aj \\Vert cb \\rangle X_{ci} + \\sum_{k} \\langle ik \\Vert ab \\rangle X_{kj} + \\dots (\\text{permutations}) $$\n    Let's analyze the cost of representative terms. Computing $Y_{abij} \\leftarrow \\sum_c \\langle aj \\Vert cb \\rangle X_{ci}$ for all $a, b, i, j$ requires $\\mathcal{O}(n_o^2 n_v^3)$ arithmetic operations. Computing $Y_{abij} \\leftarrow \\sum_k \\langle ik \\Vert ab \\rangle X_{kj}$ requires $\\mathcal{O}(n_o^3 n_v^2)$ operations. Thus, the total cost for the generate step is $\\mathcal{O}(n_o^2 n_v^3 + n_o^3 n_v^2)$. This step produces a four-index intermediate tensor $Y_{abij}$ of size $\\mathcal{O}(n_o^2 n_v^2)$.\n\n    b.  **Propagate:** Application of the inverse resolvent, $\\mathbf{Z}_D = (\\omega\\mathbf{1} - \\mathbf{M}_{DD})^{-1} \\mathbf{Y}_D$. Based on the problem's assumption, $\\mathbf{M}_{DD}$ is diagonal with elements $(M_{DD})_{(ab)(ij),(ab)(ij)} = \\epsilon_a + \\epsilon_b - \\epsilon_i - \\epsilon_j$. Therefore, this step is a simple element-wise division:\n    $$ Z_{abij} = \\frac{Y_{abij}}{\\omega - (\\epsilon_a + \\epsilon_b - \\epsilon_i - \\epsilon_j)} $$\n    The cost is proportional to the number of doubles, which is $\\mathcal{O}(n_o^2 n_v^2)$. This step reads the $\\mathcal{O}(n_o^2 n_v^2)$ intermediate $Y_{abij}$ and writes the $\\mathcal{O}(n_o^2 n_v^2)$ intermediate $Z_{abij}$.\n\n    c.  **Project:** The doubles intermediate $\\mathbf{Z}_D$ is projected back onto the singles space to give the final contribution to the sigma vector: $(\\mathbf{\\Sigma}_S)^{(2)} = \\mathbf{M}_{SD} \\mathbf{Z}_D$. This involves contractions of the integral tensor with the $Z_{abij}$ intermediate:\n    $$ (\\Sigma_{ai})^{(2)} \\sim \\sum_{jbc} \\langle aj \\Vert cb \\rangle Z_{bcij} + \\sum_{jkb} \\langle jk \\Vert ib \\rangle Z_{abjk} + \\dots (\\text{permutations}) $$\n    The cost analysis is symmetric to the generate step. The first term scales as $\\mathcal{O}(n_o^2 n_v^3)$ and the second as $\\mathcal{O}(n_o^3 n_v^2)$. The total cost for the project step is $\\mathcal{O}(n_o^2 n_v^3 + n_o^3 n_v^2)$.\n\n**Summary of Costs**\n-   Arithmetic Dominance: The generate and project steps are the most expensive, scaling as $\\mathcal{O}(n_o^2 n_v^3 + n_o^3 n_v^2)$. The CIS-like and propagate steps are sub-dominant. Typically, $n_v \\gg n_o$, making the $\\mathcal{O}(n_o^2 n_v^3)$ term the asymptotically leading one.\n-   Memory/Traffic Dominance: The largest tensors involved are the four-index integrals and the four-index intermediates $Y_{abij}$ and $Z_{abij}$, each with $\\mathcal{O}(n_o^2 n_v^2)$ elements. The memory traffic is dominated by reading/writing these tensors. The vectors $X_{ai}$ and $\\Sigma_{ai}$ are smaller, with only $\\mathcal{O}(n_o n_v)$ elements. The arithmetic intensity (ratio of floating-point operations to memory access) is low for these contractions, as large amounts of data must be streamed for a limited number of operations per data element, unless sophisticated data blocking strategies are employed.\n\nThis analysis allows for a systematic evaluation of the given options.\n\n**Option-by-Option Analysis**\n\n**A.** This option provides a detailed breakdown of the sigma-vector build into a CIS-like part and a folded $2p2h$ contribution. It correctly identifies the `generate-propagate-project` sequence for the latter. It accurately states the scaling of the generate and project steps as $\\mathcal{O}(n_o^2 n_v^3 + n_o^3 n_v^2)$ and the propagate step as $\\mathcal{O}(n_o^2 n_v^2)$. It correctly identifies that memory traffic is dominated by streaming four-index tensors ($\\langle ij \\Vert ab \\rangle$, $Y_{abij}$, $Z_{abij}$) of size $\\mathcal{O}(n_o^2 n_v^2)$, with the vectors being sub-dominant. It also correctly characterizes the arithmetic intensity as low. This description aligns perfectly with the first-principles derivation.\n**Verdict: Correct.**\n\n**B.** This option claims the dominant scaling is $\\mathcal{O}(n_o^3 n_v^3)$ due to \"triples-like contractions\" and memory is dominated by intermediates of size $\\mathcal{O}(n_o^3 n_v^3)$. The $\\text{ADC}(2)$ method does not have a dominant $\\mathcal{O}(n_o^3 n_v^3)$ step, nor does it generate six-index intermediates of size $\\mathcal{O}(n_o^3 n_v^3)$. This scaling is characteristic of higher-order methods.\n**Verdict: Incorrect.**\n\n**C.** This option claims the build reduces to a pure singles-singles (CIS-like) operation scaling as $\\mathcal{O}(n_o^2 n_v^2)$ and that no $\\mathcal{O}(n_o^2 n_v^2)$ intermediates are formed. This is fundamentally wrong as it ignores the second-order correction from the doubles space, which is the defining feature of $\\text{ADC}(2)$ over CIS/ADC(1). The dominant scaling is higher than $\\mathcal{O}(n_o^2 n_v^2)$, and $\\mathcal{O}(n_o^2 n_v^2)$ intermediates are essential.\n**Verdict: Incorrect.**\n\n**D.** This option invokes density fitting (resolution of the identity), which is explicitly ruled out by assumption 2 of the problem statement (\"Conventional four-index two-electron integrals (no density fitting...)\"). Therefore, its conclusions are not applicable to the problem as stated.\n**Verdict: Incorrect.**\n\n**E.** This option proposes precomputing and storing a six-index intermediate of size $\\mathcal{O}(n_o^3 n_v^3)$. This is not part of the standard iterative $\\text{ADC}(2)$ algorithm, whose cost per iteration must be lower than the cost of forming such a large pre-computed tensor. The expression for the intermediate is also syntactically questionable. This describes a non-standard and computationally impractical procedure.\n**Verdict: Incorrect.**\n\nBased on the detailed analysis, only option A accurately describes the computational characteristics of the iterative $\\text{ADC}(2)$ sigma-vector calculation under the given assumptions.", "answer": "$$\\boxed{A}$$", "id": "2873837"}]}