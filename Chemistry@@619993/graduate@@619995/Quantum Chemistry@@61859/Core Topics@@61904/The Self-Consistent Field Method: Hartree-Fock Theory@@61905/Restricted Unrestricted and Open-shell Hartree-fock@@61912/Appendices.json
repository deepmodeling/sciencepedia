{"hands_on_practices": [{"introduction": "A key distinction of the Unrestricted Hartree-Fock (UHF) method is its potential for spin contamination, where the resulting wavefunction is not a pure spin eigenstate. This exercise provides a foundational, first-principles practice in quantifying this effect by deriving the expectation value of the total spin-squared operator, $\\langle \\hat{S}^2 \\rangle$, for a simple two-electron UHF determinant. Mastering this derivation is crucial for understanding the trade-off between variational flexibility and spin purity in UHF [@problem_id:2921436].", "problem": "Consider a two-electron Unrestricted Hartree-Fock (UHF) single-determinant wavefunction constructed from two normalized spatial orbitals $\\psi_{a}$ and $\\psi_{b}$ and the spin functions $\\alpha$ and $\\beta$. The Slater determinant (antisymmetrized product) is\n$$\n\\Phi(1,2) \\;=\\; \\frac{1}{\\sqrt{2}}\\Big[\\psi_{a}(\\mathbf{r}_{1})\\,\\alpha(1)\\,\\psi_{b}(\\mathbf{r}_{2})\\,\\beta(2)\\;-\\;\\psi_{a}(\\mathbf{r}_{2})\\,\\alpha(2)\\,\\psi_{b}(\\mathbf{r}_{1})\\,\\beta(1)\\Big],\n$$\nwith the normalization conditions $\\langle \\psi_{a}|\\psi_{a}\\rangle = \\langle \\psi_{b}|\\psi_{b}\\rangle = 1$ and the overlap $S_{ab}=\\langle \\psi_{a}|\\psi_{b}\\rangle$, which may be complex. Using only first-principles definitions of the total spin operator $\\hat{S}^{2} = \\hat{S}_{1}^{2} + \\hat{S}_{2}^{2} + 2\\,\\hat{\\mathbf{S}}_{1}\\!\\cdot\\!\\hat{\\mathbf{S}}_{2}$ and the properties of spin functions and antisymmetrized products, derive the exact closed-form expression for the expectation value $\\langle \\hat{S}^{2}\\rangle$ in terms of $S_{ab}$. \n\nYour final answer must be a single closed-form analytic expression in terms of $S_{ab}$. No units are required. No rounding is required.", "solution": "The problem is subjected to validation and found to be valid. It is a well-posed problem in quantum chemistry that is scientifically sound, self-contained, and objective. We shall now proceed with its formal derivation.\n\nThe task is to compute the expectation value of the total spin-squared operator, $\\langle \\hat{S}^{2}\\rangle$, for the given two-electron Unrestricted Hartree-Fock (UHF) wavefunction. The wavefunction is a single Slater determinant:\n$$\n\\Phi(1,2) \\;=\\; \\frac{1}{\\sqrt{2}}\\Big[\\psi_{a}(\\mathbf{r}_{1})\\,\\alpha(1)\\,\\psi_{b}(\\mathbf{r}_{2})\\,\\beta(2)\\;-\\;\\psi_{a}(\\mathbf{r}_{2})\\,\\alpha(2)\\,\\psi_{b}(\\mathbf{r}_{1})\\,\\beta(1)\\Big]\n$$\nThis can be written compactly using Dirac notation as:\n$$\n|\\Phi\\rangle \\;=\\; \\frac{1}{\\sqrt{2}}\\Big(|\\psi_a \\alpha\\rangle_1 |\\psi_b \\beta\\rangle_2 - |\\psi_b \\beta\\rangle_1 |\\psi_a \\alpha\\rangle_2\\Big)\n$$\nThe spatial orbitals $\\psi_a$ and $\\psi_b$ are normalized, $\\langle \\psi_{a}|\\psi_{a}\\rangle = 1$ and $\\langle \\psi_{b}|\\psi_{b}\\rangle = 1$, with a non-zero overlap integral $S_{ab}=\\langle \\psi_{a}|\\psi_{b}\\rangle$. The spin functions $\\alpha$ and $\\beta$ are orthonormal.\n\nFirst, we must verify that the provided wavefunction $|\\Phi\\rangle$ is normalized. The norm-squared is $\\langle\\Phi|\\Phi\\rangle$:\n$$\n\\langle\\Phi|\\Phi\\rangle = \\frac{1}{2} \\left\\langle \\psi_a \\alpha(1)\\psi_b \\beta(2) - \\psi_b \\beta(1)\\psi_a \\alpha(2) \\Big| \\psi_a \\alpha(1)\\psi_b \\beta(2) - \\psi_b \\beta(1)\\psi_a \\alpha(2) \\right\\rangle\n$$\nExpanding this gives four terms. We integrate over the spatial and spin coordinates of both electrons, denoted by $\\int d\\tau_1 d\\tau_2$.\n$$\n\\langle\\Phi|\\Phi\\rangle = \\frac{1}{2}\\Big( \\langle\\psi_a\\alpha(1)\\psi_b\\beta(2)|\\psi_a\\alpha(1)\\psi_b\\beta(2)\\rangle - \\langle\\psi_a\\alpha(1)\\psi_b\\beta(2)|\\psi_b\\beta(1)\\psi_a\\alpha(2)\\rangle - \\langle\\psi_b\\beta(1)\\psi_a\\alpha(2)|\\psi_a\\alpha(1)\\psi_b\\beta(2)\\rangle + \\langle\\psi_b\\beta(1)\\psi_a\\alpha(2)|\\psi_b\\beta(1)\\psi_a\\alpha(2)\\rangle \\Big)\n$$\nWe evaluate each inner product:\n\\begin{itemize}\n    \\item $\\langle\\psi_a\\alpha|\\psi_a\\alpha\\rangle\\langle\\psi_b\\beta|\\psi_b\\beta\\rangle = \\langle\\psi_a|\\psi_a\\rangle\\langle\\alpha|\\alpha\\rangle\\langle\\psi_b|\\psi_b\\rangle\\langle\\beta|\\beta\\rangle = (1)(1)(1)(1) = 1$.\n    \\item $\\langle\\psi_a\\alpha|\\psi_b\\beta\\rangle\\langle\\psi_b\\beta|\\psi_a\\alpha\\rangle = (\\langle\\psi_a|\\psi_b\\rangle\\langle\\alpha|\\beta\\rangle)(\\langle\\psi_b|\\psi_a\\rangle\\langle\\beta|\\alpha\\rangle) = (S_{ab} \\cdot 0)(S_{ab}^* \\cdot 0) = 0$.\n    \\item The third term is the complex conjugate of the second, so it is also $0$.\n    \\item $\\langle\\psi_b\\beta|\\psi_b\\beta\\rangle\\langle\\psi_a\\alpha|\\psi_a\\alpha\\rangle = (1)(1)(1)(1) = 1$.\n\\end{itemize}\nThus, $\\langle\\Phi|\\Phi\\rangle = \\frac{1}{2}(1 - 0 - 0 + 1) = 1$. The wavefunction is normalized.\n\nThe total spin operator $\\hat{S}^{2}$ for a two-electron system is given by $\\hat{S}^{2} = (\\hat{\\mathbf{S}}_{1} + \\hat{\\mathbf{S}}_{2})^2 = \\hat{S}_{1}^{2} + \\hat{S}_{2}^{2} + 2\\hat{\\mathbf{S}}_{1}\\cdot\\hat{\\mathbf{S}}_{2}$. We use atomic units where $\\hbar=1$. The dot product can be expanded in terms of ladder operators $\\hat{S}_{\\pm} = \\hat{S}_x \\pm i\\hat{S}_y$ and the $z$-component operator $\\hat{S}_z$:\n$$\n\\hat{S}^{2} = \\hat{S}_{1}^{2} + \\hat{S}_{2}^{2} + 2\\hat{S}_{z,1}\\hat{S}_{z,2} + \\hat{S}_{+,1}\\hat{S}_{-,2} + \\hat{S}_{-,1}\\hat{S}_{+,2}\n$$\nThe expectation value is $\\langle \\hat{S}^{2}\\rangle = \\langle \\Phi|\\hat{S}^{2}|\\Phi\\rangle$. We evaluate the contribution of each term.\n\nThe one-electron spin-squared operator $\\hat{S}_{i}^{2}$ acting on any spin-$1/2$ wavefunction yields the eigenvalue $s(s+1) = \\frac{1}{2}(\\frac{1}{2}+1) = \\frac{3}{4}$.\n$$\n\\langle \\Phi|(\\hat{S}_{1}^{2} + \\hat{S}_{2}^{2})|\\Phi\\rangle = \\langle \\Phi|(\\frac{3}{4} + \\frac{3}{4})|\\Phi\\rangle = \\frac{3}{2}\\langle\\Phi|\\Phi\\rangle = \\frac{3}{2}\n$$\n\nNext, we evaluate the term $2\\hat{S}_{z,1}\\hat{S}_{z,2}$. The spin functions $\\alpha$ and $\\beta$ are eigenfunctions of $\\hat{S}_z$ with eigenvalues $+\\frac{1}{2}$ and $-\\frac{1}{2}$, respectively.\n$$\n2\\hat{S}_{z,1}\\hat{S}_{z,2}|\\Phi\\rangle = \\frac{2}{\\sqrt{2}} \\Big[ (\\hat{S}_{z,1}\\psi_a\\alpha(1))(\\hat{S}_{z,2}\\psi_b\\beta(2)) - (\\hat{S}_{z,2}\\psi_a\\alpha(2))(\\hat{S}_{z,1}\\psi_b\\beta(1)) \\Big]\n$$\n$$\n= \\frac{2}{\\sqrt{2}} \\Big[ (\\frac{1}{2}\\psi_a\\alpha(1))(-\\frac{1}{2}\\psi_b\\beta(2)) - (\\frac{1}{2}\\psi_a\\alpha(2))(-\\frac{1}{2}\\psi_b\\beta(1)) \\Big]\n$$\n$$\n= -\\frac{1}{2} \\cdot \\frac{1}{\\sqrt{2}} \\Big[ \\psi_a\\alpha(1)\\psi_b\\beta(2) - \\psi_a\\alpha(2)\\psi_b\\beta(1) \\Big] = -\\frac{1}{2}|\\Phi\\rangle\n$$\nTherefore, the expectation value of this term is $\\langle \\Phi|2\\hat{S}_{z,1}\\hat{S}_{z,2}|\\Phi\\rangle = \\langle \\Phi|-\\frac{1}{2}|\\Phi\\rangle = -\\frac{1}{2}$.\nCombining these diagonal terms, we have a contribution of $\\frac{3}{2} - \\frac{1}{2} = 1$.\n\nNow, we must evaluate the contribution from the spin-flipping terms, $\\hat{S}_{+,1}\\hat{S}_{-,2} + \\hat{S}_{-,1}\\hat{S}_{+,2}$. We use the properties of ladder operators: $\\hat{S}_+\\alpha = 0$, $\\hat{S}_+\\beta = \\alpha$, $\\hat{S}_-\\alpha = \\beta$, $\\hat{S}_-\\beta = 0$.\nLet's find the action of each operator on $|\\Phi\\rangle$:\n$$\n\\hat{S}_{+,1}\\hat{S}_{-,2}|\\Phi\\rangle = \\frac{1}{\\sqrt{2}} \\Big[ \\hat{S}_{+,1}\\hat{S}_{-,2}\\big(\\psi_a\\alpha(1)\\psi_b\\beta(2)\\big) - \\hat{S}_{+,1}\\hat{S}_{-,2}\\big(\\psi_b\\beta(1)\\psi_a\\alpha(2)\\big) \\Big]\n$$\nThe first term is zero because $\\hat{S}_{+,1}\\alpha(1) = 0$. The second term becomes:\n$$\n-\\frac{1}{\\sqrt{2}} \\big(\\hat{S}_{+,1}\\psi_b\\beta(1)\\big)\\big(\\hat{S}_{-,2}\\psi_a\\alpha(2)\\big) = -\\frac{1}{\\sqrt{2}} \\big(\\psi_b\\alpha(1)\\big)\\big(\\psi_a\\beta(2)\\big)\n$$\nSo, $\\hat{S}_{+,1}\\hat{S}_{-,2}|\\Phi\\rangle = -\\frac{1}{\\sqrt{2}} \\psi_b\\alpha(1)\\psi_a\\beta(2)$.\n\nSimilarly for $\\hat{S}_{-,1}\\hat{S}_{+,2}$:\n$$\n\\hat{S}_{-,1}\\hat{S}_{+,2}|\\Phi\\rangle = \\frac{1}{\\sqrt{2}} \\Big[ \\hat{S}_{-,1}\\hat{S}_{+,2}\\big(\\psi_a\\alpha(1)\\psi_b\\beta(2)\\big) - \\hat{S}_{-,1}\\hat{S}_{+,2}\\big(\\psi_b\\beta(1)\\psi_a\\alpha(2)\\big) \\Big]\n$$\nThe second term is zero because $\\hat{S}_{+,2}\\alpha(2) = 0$. The first term becomes:\n$$\n\\frac{1}{\\sqrt{2}} \\big(\\hat{S}_{-,1}\\psi_a\\alpha(1)\\big)\\big(\\hat{S}_{+,2}\\psi_b\\beta(2)\\big) = \\frac{1}{\\sqrt{2}} \\big(\\psi_a\\beta(1)\\big)\\big(\\psi_b\\alpha(2)\\big)\n$$\nSo, $\\hat{S}_{-,1}\\hat{S}_{+,2}|\\Phi\\rangle = \\frac{1}{\\sqrt{2}} \\psi_a\\beta(1)\\psi_b\\alpha(2)$.\n\nNow we compute the expectation value $\\langle \\Phi | (\\hat{S}_{+,1}\\hat{S}_{-,2} + \\hat{S}_{-,1}\\hat{S}_{+,2}) | \\Phi \\rangle$:\n$$\n= \\left\\langle \\Phi \\left| \\left(-\\frac{1}{\\sqrt{2}} \\psi_b\\alpha(1)\\psi_a\\beta(2) + \\frac{1}{\\sqrt{2}} \\psi_a\\beta(1)\\psi_b\\alpha(2)\\right) \\right.\\right\\rangle\n$$\n$$\n= -\\frac{1}{\\sqrt{2}} \\langle \\Phi | \\psi_b\\alpha(1)\\psi_a\\beta(2) \\rangle + \\frac{1}{\\sqrt{2}} \\langle \\Phi | \\psi_a\\beta(1)\\psi_b\\alpha(2) \\rangle\n$$\nLet's evaluate each inner product by substituting $|\\Phi\\rangle$:\nFirst inner product:\n$$\n\\langle \\Phi | \\psi_b\\alpha(1)\\psi_a\\beta(2) \\rangle = \\frac{1}{\\sqrt{2}}\\langle \\psi_a\\alpha(1)\\psi_b\\beta(2) - \\psi_b\\beta(1)\\psi_a\\alpha(2) | \\psi_b\\alpha(1)\\psi_a\\beta(2) \\rangle\n$$\n$$\n= \\frac{1}{\\sqrt{2}} \\Big( \\langle\\psi_a\\alpha(1)|\\psi_b\\alpha(1)\\rangle\\langle\\psi_b\\beta(2)|\\psi_a\\beta(2)\\rangle - \\langle\\psi_b\\beta(1)|\\psi_b\\alpha(1)\\rangle\\langle\\psi_a\\alpha(2)|\\psi_a\\beta(2)\\rangle \\Big)\n$$\nThe second term is zero because $\\langle\\beta|\\alpha\\rangle=0$. The first term is:\n$$\n\\frac{1}{\\sqrt{2}} \\big( \\langle\\psi_a|\\psi_b\\rangle\\langle\\alpha|\\alpha\\rangle \\cdot \\langle\\psi_b|\\psi_a\\rangle\\langle\\beta|\\beta\\rangle \\big) = \\frac{1}{\\sqrt{2}} (S_{ab} \\cdot 1 \\cdot S_{ab}^* \\cdot 1) = \\frac{1}{\\sqrt{2}} |S_{ab}|^2\n$$\nSecond inner product:\n$$\n\\langle \\Phi | \\psi_a\\beta(1)\\psi_b\\alpha(2) \\rangle = \\frac{1}{\\sqrt{2}}\\langle \\psi_a\\alpha(1)\\psi_b\\beta(2) - \\psi_b\\beta(1)\\psi_a\\alpha(2) | \\psi_a\\beta(1)\\psi_b\\alpha(2) \\rangle\n$$\n$$\n= \\frac{1}{\\sqrt{2}} \\Big( \\langle\\psi_a\\alpha(1)|\\psi_a\\beta(1)\\rangle\\langle\\psi_b\\beta(2)|\\psi_b\\alpha(2)\\rangle - \\langle\\psi_b\\beta(1)|\\psi_a\\beta(1)\\rangle\\langle\\psi_a\\alpha(2)|\\psi_b\\alpha(2)\\rangle \\Big)\n$$\nThe first term is zero because $\\langle\\alpha|\\beta\\rangle=0$. The second term is:\n$$\n-\\frac{1}{\\sqrt{2}} \\big( \\langle\\psi_b|\\psi_a\\rangle\\langle\\beta|\\beta\\rangle \\cdot \\langle\\psi_a|\\psi_b\\rangle\\langle\\alpha|\\alpha\\rangle \\big) = -\\frac{1}{\\sqrt{2}} (S_{ab}^* \\cdot 1 \\cdot S_{ab} \\cdot 1) = -\\frac{1}{\\sqrt{2}} |S_{ab}|^2\n$$\nCombining these results for the spin-flipping term's expectation value:\n$$\n= -\\frac{1}{\\sqrt{2}} \\left( \\frac{1}{\\sqrt{2}}|S_{ab}|^2 \\right) + \\frac{1}{\\sqrt{2}} \\left( -\\frac{1}{\\sqrt{2}}|S_{ab}|^2 \\right) = -\\frac{1}{2}|S_{ab}|^2 - \\frac{1}{2}|S_{ab}|^2 = -|S_{ab}|^2\n$$\nFinally, we sum all contributions to find the total expectation value of $\\hat{S}^2$:\n$$\n\\langle \\hat{S}^2 \\rangle = \\left(\\frac{3}{2}\\right) + \\left(-\\frac{1}{2}\\right) + \\left(-|S_{ab}|^2\\right) = 1 - |S_{ab}|^2\n$$\nThis result is the measure of spin contamination in the UHF wavefunction. For a pure singlet state ($S=0$, $\\langle \\hat{S}^2 \\rangle=0$), we would require $|S_{ab}|^2=1$, which occurs when $\\psi_a=\\psi_b$, corresponding to a Restricted Hartree-Fock (RHF) description. For orthogonal spatial orbitals ($S_{ab}=0$), $\\langle \\hat{S}^2 \\rangle=1$, which indicates the state is an equal mixture of a singlet ($S=0$) and a triplet ($S=1$) component.", "answer": "$$\n\\boxed{1 - |S_{ab}|^2}\n$$", "id": "2921436"}, {"introduction": "Building on the mathematical formalism of spin contamination, this practice explores its profound physical consequences in the canonical example of the $\\mathrm{H}_2$ molecule's dissociation. You will analyze why the single-determinant UHF approach, despite offering a qualitatively correct dissociation energy, fails to describe the correct spin state and instead yields a mixture of singlet and triplet character. This thought experiment highlights the concept of static correlation and the fundamental limitations of a single-reference description for bond-breaking processes [@problem_id:2466572].", "problem": "Consider the hydrogen molecule with two electrons, denoted $\\mathrm{H}_2$. In the Unrestricted Hartree-Fock (UHF) approximation, the $\\alpha$-spin and $\\beta$-spin electrons are allowed to occupy different spatial orbitals. At large internuclear separation $R \\to \\infty$, assume two orthonormal, localized one-electron orbitals $\\phi_A(\\mathbf{r})$ and $\\phi_B(\\mathbf{r})$ centered on atoms $A$ and $B$, respectively, with negligible overlap $\\langle \\phi_A | \\phi_B \\rangle \\approx 0$. A typical broken-symmetry UHF determinant at dissociation localizes one $\\alpha$ electron on $A$ and one $\\beta$ electron on $B$, i.e., it uses the Slater determinant built from spin-orbitals $\\phi_A(\\mathbf{r})\\alpha$ and $\\phi_B(\\mathbf{r})\\beta$.\n\nStarting only from (i) the definition that a Slater determinant enforces antisymmetry under particle exchange, (ii) the standard two-electron spin eigenfunctions for total spin singlet and triplet,\n$$\n\\chi_S = \\frac{1}{\\sqrt{2}}\\left(\\alpha(1)\\beta(2)-\\beta(1)\\alpha(2)\\right),\\quad\n\\chi_{T0} = \\frac{1}{\\sqrt{2}}\\left(\\alpha(1)\\beta(2)+\\beta(1)\\alpha(2)\\right),\n$$\nand (iii) the fact that at $R \\to \\infty$ the symmetric and antisymmetric products $\\phi_A(1)\\phi_B(2)\\pm \\phi_B(1)\\phi_A(2)$ are orthogonal and of equal norm in the negligible-overlap limit, analyze the UHF determinant’s behavior under electron exchange, decompose it into total-spin eigenfunctions, and use this to reason about the expectation value $\\langle \\hat{S}^2 \\rangle$ for the UHF state in the dissociation limit. Ignore spin-orbit coupling and any external fields.\n\nWhich option correctly and precisely explains why a UHF calculation on dissociated $\\mathrm{H}_2$ yields $\\langle \\hat{S}^2 \\rangle \\to 1$, rather than the singlet value $0$?\n\nA. At $R \\to \\infty$, the broken-symmetry UHF determinant with one $\\alpha$ electron on $A$ and one $\\beta$ electron on $B$ can be written as an equal-weight superposition of the total-spin singlet and the $M_S=0$ triplet, because the symmetric and antisymmetric spatial combinations become orthogonal and equally normalized; therefore $\\langle \\hat{S}^2 \\rangle = \\tfrac{1}{2}\\cdot 0 + \\tfrac{1}{2}\\cdot 2 = 1$.\n\nB. Unrestricted Hartree-Fock (UHF) constrains $\\langle \\hat{S}^2 \\rangle = \\langle \\hat{S}_z^2 \\rangle$ by construction; with one $\\alpha$ and one $\\beta$ electron, $M_S=0$ implies $\\langle \\hat{S}^2 \\rangle = 1$.\n\nC. At $R \\to \\infty$, the true ground state of $\\mathrm{H}_2$ becomes a triplet with total spin $S=1$, so UHF correctly predicts $\\langle \\hat{S}^2 \\rangle \\to 1$.\n\nD. The $\\alpha$ and $\\beta$ spatial orbitals are forced to be identical in UHF at all bond lengths, making the determinant a pure singlet; the deviation $\\langle \\hat{S}^2 \\rangle \\to 1$ arises solely from numerical roundoff error.\n\nSelect exactly one option.", "solution": "The problem statement concerns the behavior of the Unrestricted Hartree-Fock (UHF) wavefunction for the hydrogen molecule, $\\mathrm{H}_2$, in the dissociation limit ($R \\to \\infty$). The analysis is to be based on fundamental principles of quantum mechanics.\n\nFirst, a validation of the problem statement is required.\n\n**Step 1: Extract Givens**\n- System: $\\mathrm{H}_2$ molecule, two electrons.\n- Method: Unrestricted Hartree-Fock (UHF).\n- Limit: Large internuclear separation, $R \\to \\infty$.\n- Basis: Two orthonormal, localized atomic orbitals, $\\phi_A(\\mathbf{r})$ and $\\phi_B(\\mathbf{r})$, with negligible overlap, $\\langle \\phi_A | \\phi_B \\rangle \\approx 0$.\n- UHF wavefunction: A Slater determinant constructed from the spin-orbitals $\\phi_A(\\mathbf{r})\\alpha$ and $\\phi_B(\\mathbf{r})\\beta$.\n- Given Principle (i): A Slater determinant enforces antisymmetry under particle exchange.\n- Given Principle (ii): The two-electron total spin eigenfunctions for singlet ($S=0$) and the $M_S=0$ component of the triplet ($S=1$) are\n$$\n\\chi_S = \\frac{1}{\\sqrt{2}}\\left(\\alpha(1)\\beta(2)-\\beta(1)\\alpha(2)\\right)\n$$\n$$\n\\chi_{T0} = \\frac{1}{\\sqrt{2}}\\left(\\alpha(1)\\beta(2)+\\beta(1)\\alpha(2)\\right)\n$$\n- Given Principle (iii): At $R \\to \\infty$, the spatial functions $\\phi_A(1)\\phi_B(2)\\pm \\phi_B(1)\\phi_A(2)$ are orthogonal and have equal norm.\n- Task: Decompose the UHF determinant into total-spin eigenfunctions and use this to find the expectation value $\\langle \\hat{S}^2 \\rangle$.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is scientifically sound. The description of the UHF method for dissociating $\\mathrm{H}_2$ is a canonical example in quantum chemistry, often used to illustrate the concept of spin contamination. The given principles are correct definitions and consequences of the specified limit. The problem is well-posed, providing sufficient information to derive the required result. The language is precise and objective. No flaws are identified.\n\n**Step 3: Verdict and Action**\nThe problem is valid. A full solution will be derived.\n\n**Derivation**\n\nThe UHF wavefunction, $\\Psi_{\\mathrm{UHF}}$, is described as the Slater determinant built from the spin-orbitals $\\psi_1 = \\phi_A\\alpha$ and $\\psi_2 = \\phi_B\\beta$. For a two-electron system, this is:\n$$\n\\Psi_{\\mathrm{UHF}}(1, 2) = \\frac{1}{\\sqrt{2}} \\begin{vmatrix} \\psi_1(1) & \\psi_2(1) \\\\ \\psi_1(2) & \\psi_2(2) \\end{vmatrix} = \\frac{1}{\\sqrt{2}} \\begin{vmatrix} \\phi_A(1)\\alpha(1) & \\phi_B(1)\\beta(1) \\\\ \\phi_A(2)\\alpha(2) & \\phi_B(2)\\beta(2) \\end{vmatrix}\n$$\nExpanding the determinant, we obtain:\n$$\n\\Psi_{\\mathrm{UHF}}(1, 2) = \\frac{1}{\\sqrt{2}} \\left[ \\phi_A(1)\\alpha(1)\\phi_B(2)\\beta(2) - \\phi_B(1)\\beta(1)\\phi_A(2)\\alpha(2) \\right]\n$$\nTo analyze the spin character of this state, we must express it in terms of the provided total-spin eigenfunctions, $\\chi_S$ and $\\chi_{T0}$. We do this by rearranging the definitions for $\\chi_S$ and $\\chi_{T0}$ to express the simple spin products $\\alpha(1)\\beta(2)$ and $\\beta(1)\\alpha(2)$:\n$$\n\\alpha(1)\\beta(2) = \\frac{1}{\\sqrt{2}}(\\chi_{T0} + \\chi_S)\n$$\n$$\n\\beta(1)\\alpha(2) = \\frac{1}{\\sqrt{2}}(\\chi_{T0} - \\chi_S)\n$$\nSubstitute these into the expression for $\\Psi_{\\mathrm{UHF}}$:\n$$\n\\Psi_{\\mathrm{UHF}}(1, 2) = \\frac{1}{\\sqrt{2}} \\left[ \\phi_A(1)\\phi_B(2) \\frac{1}{\\sqrt{2}}(\\chi_{T0} + \\chi_S) - \\phi_B(1)\\phi_A(2) \\frac{1}{\\sqrt{2}}(\\chi_{T0} - \\chi_S) \\right]\n$$\nCollecting terms with $\\chi_S$ and $\\chi_{T0}$:\n$$\n\\Psi_{\\mathrm{UHF}}(1, 2) = \\frac{1}{2} \\left[ (\\phi_A(1)\\phi_B(2) - \\phi_B(1)\\phi_A(2))\\chi_{T0} + (\\phi_A(1)\\phi_B(2) + \\phi_B(1)\\phi_A(2))\\chi_S \\right]\n$$\nLet us define the unnormalized symmetric and antisymmetric spatial wavefunctions:\n$$\n\\Phi_{\\text{sym}}(1,2) = \\phi_A(1)\\phi_B(2) + \\phi_B(1)\\phi_A(2)\n$$\n$$\n\\Phi_{\\text{asym}}(1,2) = \\phi_A(1)\\phi_B(2) - \\phi_B(1)\\phi_A(2)\n$$\nThe ground singlet state wavefunction $\\Psi_S$ must have a symmetric spatial part, and the $M_S=0$ triplet state wavefunction $\\Psi_{T0}$ must have an antisymmetric spatial part. In the limit $R \\to \\infty$, where $\\langle \\phi_A|\\phi_B \\rangle \\approx 0$, the normalized versions are:\n$$\n\\Psi_S = \\frac{1}{\\sqrt{2}}\\Phi_{\\text{sym}}(1,2) \\chi_S \\quad (\\text{Eigenfunction of } \\hat{S}^2 \\text{ with eigenvalue } S(S+1)=0)\n$$\n$$\n\\Psi_{T0} = \\frac{1}{\\sqrt{2}}\\Phi_{\\text{asym}}(1,2) \\chi_{T0} \\quad (\\text{Eigenfunction of } \\hat{S}^2 \\text{ with eigenvalue } S(S+1)=2)\n$$\nUsing these definitions, we can rewrite our expression for $\\Psi_{\\mathrm{UHF}}$:\n$$\n\\Psi_{\\mathrm{UHF}} = \\frac{1}{\\sqrt{2}} ( \\Psi_S + \\Psi_{T0} )\n$$\nThis shows that the broken-symmetry UHF wavefunction is not a pure spin state (not an eigenfunction of $\\hat{S}^2$). Instead, it is a linear combination of the pure singlet state $\\Psi_S$ and the pure $M_S=0$ triplet state $\\Psi_{T0}$, with equal coefficients of $1/\\sqrt{2}$.\n\nThe expectation value of the total spin-squared operator, $\\hat{S}^2$, for the state $\\Psi_{\\mathrm{UHF}}$ is calculated as:\n$$\n\\langle \\hat{S}^2 \\rangle = \\langle \\Psi_{\\mathrm{UHF}} | \\hat{S}^2 | \\Psi_{\\mathrm{UHF}} \\rangle = \\left\\langle \\frac{1}{\\sqrt{2}}(\\Psi_S + \\Psi_{T0}) \\left| \\hat{S}^2 \\right| \\frac{1}{\\sqrt{2}}(\\Psi_S + \\Psi_{T0}) \\right\\rangle\n$$\n$$\n\\langle \\hat{S}^2 \\rangle = \\frac{1}{2} \\langle \\Psi_S + \\Psi_{T0} | \\hat{S}^2 \\Psi_S + \\hat{S}^2 \\Psi_{T0} \\rangle = \\frac{1}{2} \\langle \\Psi_S + \\Psi_{T0} | 0 \\cdot \\Psi_S + 2 \\cdot \\Psi_{T0} \\rangle\n$$\nSince $\\Psi_S$ and $\\Psi_{T0}$ are eigenfunctions of $\\hat{S}^2$ with different eigenvalues, they are orthogonal, i.e., $\\langle \\Psi_S | \\Psi_{T0} \\rangle = 0$. Using this orthogonality:\n$$\n\\langle \\hat{S}^2 \\rangle = \\frac{1}{2} \\left[ \\langle \\Psi_S | 2\\Psi_{T0} \\rangle + \\langle \\Psi_{T0} | 2\\Psi_{T0} \\rangle \\right] = \\frac{1}{2} \\left[ 0 + 2\\langle \\Psi_{T0} | \\Psi_{T0} \\rangle \\right]\n$$\nSince $\\Psi_{T0}$ is normalized, $\\langle \\Psi_{T0} | \\Psi_{T0} \\rangle = 1$.\n$$\n\\langle \\hat{S}^2 \\rangle = \\frac{1}{2} (2 \\cdot 1) = 1\n$$\nThis result arises because the UHF state is an equal-weight mixture of the singlet state (probability $|1/\\sqrt{2}|^2 = 1/2$, contributing $0$ to the expectation value) and the triplet state (probability $|1/\\sqrt{2}|^2 = 1/2$, contributing $2$ to the expectation value). The average is $(1/2) \\cdot 0 + (1/2) \\cdot 2 = 1$.\n\n**Option-by-Option Analysis**\n\nA. At $R \\to \\infty$, the broken-symmetry UHF determinant with one $\\alpha$ electron on $A$ and one $\\beta$ electron on $B$ can be written as an equal-weight superposition of the total-spin singlet and the $M_S=0$ triplet, because the symmetric and antisymmetric spatial combinations become orthogonal and equally normalized; therefore $\\langle \\hat{S}^2 \\rangle = \\tfrac{1}{2}\\cdot 0 + \\tfrac{1}{2}\\cdot 2 = 1$.\nThis option is a precise and accurate summary of the derivation performed above. The decomposition into an equal-weight superposition is correct. The reason provided (orthogonality and equal norm of spatial combinations) is the correct underlying cause. The final calculation is correct.\nVerdict: **Correct**.\n\nB. Unrestricted Hartree-Fock (UHF) constrains $\\langle \\hat{S}^2 \\rangle = \\langle \\hat{S}_z^2 \\rangle$ by construction; with one $\\alpha$ and one $\\beta$ electron, $M_S=0$ implies $\\langle \\hat{S}^2 \\rangle = 1$.\nThis statement is incorrect. UHF does not impose the constraint $\\langle \\hat{S}^2 \\rangle = \\langle \\hat{S}_z^2 \\rangle$. For the state in question, we have one $\\alpha$ and one $\\beta$ electron, so $M_S = (N_\\alpha - N_\\beta)/2 = 0$. Thus, $\\langle \\hat{S}_z \\rangle = 0$ and $\\langle \\hat{S}_z^2 \\rangle = 0$. The false constraint would imply $\\langle \\hat{S}^2 \\rangle = 0$, which contradicts the known result. The final implication \"$M_S=0$ implies $\\langle \\hat{S}^2 \\rangle = 1$\" is unsubstantiated and incorrect.\nVerdict: **Incorrect**.\n\nC. At $R \\to \\infty$, the true ground state of $\\mathrm{H}_2$ becomes a triplet with total spin $S=1$, so UHF correctly predicts $\\langle \\hat{S}^2 \\rangle \\to 1$.\nThis is factually incorrect. The ground state of $\\mathrm{H}_2$ is a singlet state ($S=0$) for all internuclear separations $R$. At dissociation, this ground state becomes degenerate with the lowest triplet state ($S=1$), but it does not become a triplet. The true ground state always has $\\langle \\hat{S}^2 \\rangle = 0$. The UHF result of $\\langle \\hat{S}^2 \\rangle \\to 1$ is a well-known deficiency of the single-determinant approximation, known as spin contamination, not a correct prediction.\nVerdict: **Incorrect**.\n\nD. The $\\alpha$ and $\\beta$ spatial orbitals are forced to be identical in UHF at all bond lengths, making the determinant a pure singlet; the deviation $\\langle \\hat{S}^2 \\rangle \\to 1$ arises solely from numerical roundoff error.\nThis statement misrepresents the UHF method. The method in which $\\alpha$ and $\\beta$ spatial orbitals are forced to be identical is Restricted Hartree-Fock (RHF), not UHF. The very essence of UHF is to allow these orbitals to be different, which is what leads to the broken-symmetry solution at large $R$. The deviation of $\\langle \\hat{S}^2 \\rangle$ from $0$ to $1$ is a fundamental property of the UHF wavefunction in this limit, not a small numerical artifact.\nVerdict: **Incorrect**.", "answer": "$$\\boxed{A}$$", "id": "2466572"}, {"introduction": "This practice transitions from theoretical analysis to computational implementation, a vital skill in modern quantum chemistry. You will develop a concrete algorithm to assemble the Fock matrices for RHF, UHF, and ROHF methods, translating their defining equations into procedural logic. By explicitly constructing the Coulomb ($J$) and Exchange ($K$) contributions for each variant, you will gain direct insight into their structural differences and relative computational costs [@problem_id:2921462].", "problem": "You are given the task of formalizing and implementing the assembly of the Fock matrix for three variants of the Hartree-Fock method in quantum chemistry: Restricted Hartree-Fock (RHF), Unrestricted Hartree-Fock (UHF), and Restricted Open-Shell Hartree-Fock (ROHF). Work entirely in the atomic orbital basis. The program you write must compute the Fock matrices using definitions derived from the Hartree-Fock variational principle and provide a leading-order computational cost estimate for each variant. All quantities are in atomic units, and any scalar energy-like results (e.g., traces of Fock matrices) must be understood as being in Hartree.\n\nStart from the fundamental definitions:\n\n- Let the one-electron core Hamiltonian matrix be denoted by $h_{\\mu \\nu}$.\n- Let the two-electron repulsion integrals in physicist’s notation be denoted by $(\\mu \\nu \\mid \\lambda \\sigma)$, with the usual $8$-fold permutation symmetry $(\\mu \\nu \\mid \\lambda \\sigma) = (\\nu \\mu \\mid \\lambda \\sigma) = (\\mu \\nu \\mid \\sigma \\lambda) = (\\lambda \\sigma \\mid \\mu \\nu) = \\dots$.\n- For any density matrix $P_{\\lambda \\sigma}$, define the Coulomb and exchange contractions as linear maps:\n  $$J_{\\mu \\nu}[P] \\equiv \\sum_{\\lambda \\sigma} (\\mu \\nu \\mid \\lambda \\sigma) \\, P_{\\lambda \\sigma}, \\qquad K_{\\mu \\nu}[P] \\equiv \\sum_{\\lambda \\sigma} (\\mu \\lambda \\mid \\nu \\sigma) \\, P_{\\lambda \\sigma}.$$\n- Denote the spin-resolved densities by $P^{\\alpha}$ and $P^{\\beta}$, and the total (spin-summed) density by $P^{\\mathrm{D}} \\equiv P^{\\alpha} + P^{\\beta}$.\n\nUsing only these definitions, assemble the following Fock matrices:\n\n1. Restricted Hartree-Fock (RHF-style, using the total density):\n   $$F^{\\mathrm{RHF}} \\equiv h + J[P^{\\mathrm{D}}] - \\tfrac{1}{2} K[P^{\\mathrm{D}}].$$\n\n2. Unrestricted Hartree-Fock (UHF):\n   $$F^{\\alpha} \\equiv h + J[P^{\\alpha} + P^{\\beta}] - K[P^{\\alpha}], \\qquad F^{\\beta} \\equiv h + J[P^{\\alpha} + P^{\\beta}] - K[P^{\\beta}].$$\n\n3. Restricted Open-Shell Hartree-Fock (ROHF, spin-averaged effective Fock for orbital optimization):\n   $$F^{\\mathrm{ROHF}} \\equiv \\tfrac{1}{2}\\big(F^{\\alpha} + F^{\\beta}\\big).$$\n\nIn all cases, $F$ is a matrix with indices $(\\mu,\\nu)$.\n\nLeading-order computational cost model:\n\n- Treat each evaluation of $J[P]$ or $K[P]$ with dense arrays as a single contraction whose leading-order cost scales like $\\mathcal{O}(N^4)$ in the number of basis functions $N$, with a constant prefactor that is independent of $N$ in this model.\n- Count the number of such dense two-electron contractions required to assemble each Fock matrix expression once, and report this count as the leading-order coefficient $\\gamma$ multiplying the $\\mathcal{O}(N^4)$ scaling. For example, if one $J$ and two $K$ contractions are required, report $\\gamma = 3$.\n\nYour program must:\n\n- Use the above definitions to compute $F^{\\mathrm{RHF}}$, $F^{\\alpha}$, $F^{\\beta}$, and $F^{\\mathrm{ROHF}}$ for each test case.\n- For each computed Fock matrix $F$, return the scalar $\\operatorname{tr}(F)$, which in atomic units has units of Hartree, as a floating-point number.\n- For each variant (RHF, UHF, ROHF), return the leading-order contraction count $\\gamma$ as an integer, based on the minimal number of dense $J$ and $K$ contractions implied by the expressions above.\n- All angles, if any, must be in radians. No angles are present in this task.\n- All results must be returned as plain numbers without unit annotations; however, interpret traces as Hartree.\n\nTest suite specification:\n\nFor each test case, you are given $N$, $h$, $(\\mu \\nu \\mid \\lambda \\sigma)$ constructed deterministically, and diagonal spin densities $P^{\\alpha}$, $P^{\\beta}$ representing occupations in an orthonormal basis. The deterministic construction rules are:\n\n- One-electron matrix:\n  $$h_{ij} = \\begin{cases}\n  -0.5 - 0.1 \\, i & \\text{if } i=j,\\\\\n  -0.1 \\left(1 + |i-j|\\right) & \\text{if } i \\neq j,\n  \\end{cases}$$\n  for zero-based indices $i,j \\in \\{0,\\dots,N-1\\}$.\n\n- Two-electron integrals:\n  $$(i j \\mid k \\ell) = \\frac{1}{1 + i + j + k + \\ell},$$\n  which satisfy all required permutation symmetries and are strictly positive.\n\n- Spin densities are diagonal in the given basis:\n  $$P^{\\alpha}_{ii} = \\begin{cases} 1 & \\text{if } i < n_{\\alpha},\\\\ 0 & \\text{otherwise,} \\end{cases} \\qquad\n  P^{\\beta}_{ii} = \\begin{cases} 1 & \\text{if } i < n_{\\beta},\\\\ 0 & \\text{otherwise,} \\end{cases}$$\n  with all off-diagonal elements equal to $0$.\n\nUse the following test suite, covering closed-shell, open-shell, and a one-basis-function edge case:\n\n- Case A (closed-shell): $N = 2$, $n_{\\alpha} = 1$, $n_{\\beta} = 1$.\n- Case B (open-shell doublet): $N = 3$, $n_{\\alpha} = 2$, $n_{\\beta} = 1$.\n- Case C (high-spin edge case): $N = 1$, $n_{\\alpha} = 1$, $n_{\\beta} = 0$.\n\nRequired final output format:\n\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets.\n- The result for each test case must be a list of the form\n  $$\\big[\\operatorname{tr}(F^{\\mathrm{RHF}}), \\operatorname{tr}(F^{\\alpha}), \\operatorname{tr}(F^{\\beta}), \\operatorname{tr}(F^{\\mathrm{ROHF}}), \\gamma_{\\mathrm{RHF}}, \\gamma_{\\mathrm{UHF}}, \\gamma_{\\mathrm{ROHF}}\\big].$$\n- Aggregate the three test-case lists into a single outer list. For example:\n  $$\\big[ [\\dots], [\\dots], [\\dots] \\big].$$\nAll numbers in the output must be plain numerals (no units or symbols), and the entire output must be a valid single-line Python list literal.", "solution": "The problem requires the formal implementation and computational cost analysis of three variants of the Hartree-Fock method: Restricted Hartree-Fock (RHF), Unrestricted Hartree-Fock (UHF), and a specific formulation of Restricted Open-Shell Hartree-Fock (ROHF). The problem is well-posed, scientifically grounded in established quantum chemical theory, and provides all necessary definitions and data for a unique solution. It is therefore deemed valid.\n\nThe solution proceeds by first defining the fundamental quantities and operations, then deriving the structure of the Fock matrix for each method, analyzing the computational cost, and finally outlining the implementation logic.\n\n**1. Fundamental Definitions**\n\nWe operate within the atomic orbital (AO) basis, denoted by Greek indices such as $\\mu, \\nu, \\lambda, \\sigma$. The number of basis functions is $N$.\n\n- **Core Hamiltonian Matrix ($h$)**: The matrix $h_{\\mu\\nu}$ contains the one-electron terms, representing the kinetic energy of an electron and its potential energy in the field of the atomic nuclei.\n\n- **Two-Electron Repulsion Integrals (ERIs)**: The tensor $(\\mu \\nu \\mid \\lambda \\sigma)$ represents the Coulomb repulsion energy between two electrons, one described by the charge distribution $\\phi_\\mu^* \\phi_\\nu$ and the other by $\\phi_\\lambda^* \\phi_\\sigma$. In physicist's notation, this is defined as:\n$$(\\mu \\nu \\mid \\lambda \\sigma) = \\iint \\phi_\\mu^*(\\mathbf{r}_1) \\phi_\\nu(\\mathbf{r}_1) \\frac{1}{|\\mathbf{r}_1 - \\mathbf{r}_2|} \\phi_\\lambda^*(\\mathbf{r}_2) \\phi_\\sigma(\\mathbf{r}_2) \\, d\\mathbf{r}_1 d\\mathbf{r}_2.$$\nThis tensor possesses an $8$-fold permutation symmetry, i.e., $(\\mu \\nu \\mid \\lambda \\sigma) = (\\nu \\mu \\mid \\lambda \\sigma) = (\\mu \\nu \\mid \\sigma \\lambda) = (\\lambda \\sigma \\mid \\mu \\nu)$, and so on.\n\n- **Density Matrices ($P^\\alpha, P^\\beta$)**: The spin-density matrices describe the one-electron distribution for $\\alpha$-spin and $\\beta$-spin electrons, respectively. The total density matrix is the sum of the spin densities:\n$$P^{\\mathrm{D}} = P^{\\alpha} + P^{\\beta}.$$\n\n- **Coulomb and Exchange Operators ($J$ and $K$)**: The two-electron interactions are incorporated into the effective one-electron Fock operator via the Coulomb ($J$) and exchange ($K$) matrices. Their construction from a given density matrix $P$ is defined by the following tensor contractions:\n$$J_{\\mu \\nu}[P] \\equiv \\sum_{\\lambda \\sigma} (\\mu \\nu \\mid \\lambda \\sigma) \\, P_{\\lambda \\sigma}$$\n$$K_{\\mu \\nu}[P] \\equiv \\sum_{\\lambda \\sigma} (\\mu \\lambda \\mid \\nu \\sigma) \\, P_{\\lambda \\sigma}$$\nThe $J$ matrix represents the classical Coulomb repulsion an electron feels from the average charge distribution of all electrons. The $K$ matrix is a purely quantum-mechanical term arising from the Pauli exclusion principle, representing a non-classical interaction between electrons of the same spin.\n\n**2. Fock Matrix Construction and Cost Analysis**\n\nThe Fock matrix $F$ is the effective one-electron Hamiltonian in the Hartree-Fock approximation. Its specific form depends on the spin constraints imposed on the wavefunction.\n\n**2.1. Restricted Hartree-Fock (RHF)**\n\nThe RHF method is applicable to closed-shell systems, where all electrons are paired in spatial orbitals. The single Fock matrix governing all electrons is:\n$$F^{\\mathrm{RHF}} \\equiv h + J[P^{\\mathrm{D}}] - \\tfrac{1}{2} K[P^{\\mathrm{D}}].$$\nHere, an electron interacts with the total electron density $P^{\\mathrm{D}}$ via the Coulomb term. The exchange interaction is with electrons of the same spin. In a closed-shell system, half the electrons have $\\alpha$ spin and half have $\\beta$ spin, leading to the factor of $\\tfrac{1}{2}$ on the exchange term built from the total density.\n\n*   **Computational Cost ($\\gamma_{\\mathrm{RHF}}$)**: To construct $F^{\\mathrm{RHF}}$, one must compute $J[P^{\\mathrm{D}}]$ and $K[P^{\\mathrm{D}}]$. These are two distinct contractions, each scaling as $\\mathcal{O}(N^4)$. Therefore, the leading-order contraction count is $\\gamma_{\\mathrm{RHF}} = 2$.\n\n**2.2. Unrestricted Hartree-Fock (UHF)**\n\nThe UHF method allows $\\alpha$-spin and $\\beta$-spin electrons to occupy different sets of spatial orbitals. This is necessary for open-shell systems or systems with significant spin polarization. Two distinct Fock matrices are constructed:\n$$F^{\\alpha} \\equiv h + J[P^{\\alpha} + P^{\\beta}] - K[P^{\\alpha}]$$\n$$F^{\\beta} \\equiv h + J[P^{\\alpha} + P^{\\beta}] - K[P^{\\beta}]$$\nAn $\\alpha$-electron feels the Coulomb repulsion from all electrons (density $P^{\\alpha} + P^{\\beta}$) but only experiences exchange interaction with other $\\alpha$-electrons (density $P^{\\alpha}$). A symmetric argument applies to a $\\beta$-electron. The term $J[P^{\\alpha} + P^{\\beta}]$ is equivalent to $J[P^{\\mathrm{D}}]$.\n\n*   **Computational Cost ($\\gamma_{\\mathrm{UHF}}$)**: To construct both $F^{\\alpha}$ and $F^{\\beta}$, we require three independent $\\mathcal{O}(N^4)$ contractions: one Coulomb term $J[P^{\\mathrm{D}}]$ and two exchange terms, $K[P^{\\alpha}]$ and $K[P^{\\beta}]$. Therefore, the leading-order contraction count is $\\gamma_{\\mathrm{UHF}} = 3$.\n\n**2.3. Restricted Open-Shell Hartree-Fock (ROHF)**\n\nThe ROHF method treats open-shell systems by enforcing that doubly-occupied and singly-occupied orbitals share the same spatial part. There are several formulations for the effective Fock matrix used in orbital optimization. The problem specifies a particular spin-averaged form:\n$$F^{\\mathrm{ROHF}} \\equiv \\tfrac{1}{2}\\big(F^{\\alpha} + F^{\\beta}\\big).$$\nSubstituting the UHF expressions for $F^{\\alpha}$ and $F^{\\beta}$:\n$$F^{\\mathrm{ROHF}} = \\tfrac{1}{2} \\left( (h + J[P^{\\mathrm{D}}] - K[P^{\\alpha}]) + (h + J[P^{\\mathrm{D}}] - K[P^{\\beta}]) \\right)$$\n$$F^{\\mathrm{ROHF}} = h + J[P^{\\mathrm{D}}] - \\tfrac{1}{2} \\left( K[P^{\\alpha}] + K[P^{\\beta}] \\right).$$\nThis represents a single, effective Hamiltonian whose eigenfunctions can be used to update the spatial orbitals.\n\n*   **Computational Cost ($\\gamma_{\\mathrm{ROHF}}$)**: To construct $F^{\\mathrm{ROHF}}$ from its fundamental components, one must calculate the same three contractions required for the UHF method: $J[P^{\\mathrm{D}}]$, $K[P^{\\alpha}]$, and $K[P^{\\beta}]$. Therefore, the cost is identical to UHF, and $\\gamma_{\\mathrm{ROHF}} = 3$.\n\n**3. Implementation Algorithm**\n\nFor each test case defined by ($N, n_{\\alpha}, n_{\\beta}$), the following steps are executed:\n1.  Construct the $N \\times N$ core Hamiltonian matrix $h$ according to the provided deterministic rule.\n2.  Construct the $N \\times N \\times N \\times N$ two-electron repulsion integral tensor $(\\mu \\nu \\mid \\lambda \\sigma)$ according to its rule.\n3.  Construct the diagonal $N \\times N$ spin-density matrices $P^{\\alpha}$ and $P^{\\beta}$ based on the occupation numbers $n_{\\alpha}$ and $n_{\\beta}$.\n4.  Calculate the total density matrix $P^{\\mathrm{D}} = P^{\\alpha} + P^{\\beta}$.\n5.  Implement the $J[P]$ and $K[P]$ contractions using `numpy.einsum` for efficiency and clarity. Specifically, $J_{\\mu\\nu}[P] = \\sum_{\\lambda\\sigma} (\\mu\\nu|\\lambda\\sigma) P_{\\lambda\\sigma}$ becomes `np.einsum('uvls,ls->uv', ERI, P)` and $K_{\\mu\\nu}[P] = \\sum_{\\lambda\\sigma} (\\mu\\lambda|\\nu\\sigma) P_{\\lambda\\sigma}$ becomes `np.einsum('ulvs,ls->uv', ERI, P)`.\n6.  Assemble the Fock matrices $F^{\\mathrm{RHF}}$, $F^{\\alpha}$, $F^{\\beta}$ and $F^{\\mathrm{ROHF}}$ using the formulas derived above and the computed $J$ and $K$ matrices.\n7.  Compute the trace of each Fock matrix, $\\operatorname{tr}(F)$, using `numpy.trace`.\n8.  Collect the traces and the pre-determined integer coefficients $\\gamma$ into a list for each test case.\n9.  Aggregate the results from all test cases into a final list for output.\n\nThis procedure correctly and rigorously implements the specified problem.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes RHF, UHF, and ROHF Fock matrices and their associated\n    computational costs for a given set of test cases.\n    \"\"\"\n\n    # Test cases are defined by (N, n_alpha, n_beta)\n    # N: number of basis functions\n    # n_alpha: number of alpha-spin electrons/occupied orbitals\n    # n_beta: number of beta-spin electrons/occupied orbitals\n    test_cases = [\n        (2, 1, 1),  # Case A: closed-shell\n        (3, 2, 1),  # Case B: open-shell doublet\n        (1, 1, 0),  # Case C: high-spin edge case\n    ]\n\n    # Leading-order computational cost coefficients (contraction counts)\n    # RHF: J[P_D], K[P_D] -> 2 contractions\n    gamma_rhf = 2\n    # UHF: J[P_D], K[P_alpha], K[P_beta] -> 3 contractions\n    gamma_uhf = 3\n    # ROHF (from scratch): J[P_D], K[P_alpha], K[P_beta] -> 3 contractions\n    gamma_rohf = 3\n\n    all_results = []\n\n    for N, n_alpha, n_beta in test_cases:\n        # 1. Construct one-electron core Hamiltonian matrix (h)\n        h = np.zeros((N, N))\n        for i in range(N):\n            for j in range(N):\n                if i == j:\n                    h[i, j] = -0.5 - 0.1 * i\n                else:\n                    h[i, j] = -0.1 * (1.0 + abs(i - j))\n\n        # 2. Construct two-electron repulsion integral tensor (ERI)\n        # Using physicist's notation (uv|ls)\n        eri = np.zeros((N, N, N, N))\n        for i in range(N):\n            for j in range(N):\n                for k in range(N):\n                    for l in range(N):\n                        eri[i, j, k, l] = 1.0 / (1.0 + i + j + k + l)\n\n        # 3. Construct spin-density matrices (P_alpha, P_beta)\n        # These are diagonal, representing occupations in the given basis.\n        p_alpha_diag = np.array([1.0 if i < n_alpha else 0.0 for i in range(N)])\n        p_beta_diag = np.array([1.0 if i < n_beta else 0.0 for i in range(N)])\n        P_alpha = np.diag(p_alpha_diag)\n        P_beta = np.diag(p_beta_diag)\n        \n        # 4. Total density matrix\n        P_total = P_alpha + P_beta\n\n        # 5. Define J and K builder functions using einsum\n        def build_J(P, eri_tensor):\n            # J[u,v] = sum_{l,s} (uv|ls) P[l,s]\n            return np.einsum('uvls,ls->uv', eri_tensor, P, optimize=True)\n\n        def build_K(P, eri_tensor):\n            # K[u,v] = sum_{l,s} (ul|vs) P[l,s]\n            return np.einsum('ulvs,ls->uv', eri_tensor, P, optimize=True)\n\n        # --- RHF Calculation ---\n        J_total_rhf = build_J(P_total, eri)\n        K_total_rhf = build_K(P_total, eri)\n        F_rhf = h + J_total_rhf - 0.5 * K_total_rhf\n        tr_rhf = np.trace(F_rhf)\n\n        # --- UHF Calculation ---\n        J_total_uhf = build_J(P_total, eri) # Same as J_total_rhf\n        K_alpha = build_K(P_alpha, eri)\n        K_beta = build_K(P_beta, eri)\n        \n        F_alpha = h + J_total_uhf - K_alpha\n        F_beta = h + J_total_uhf - K_beta\n        tr_alpha = np.trace(F_alpha)\n        tr_beta = np.trace(F_beta)\n\n        # --- ROHF Calculation ---\n        # Based on theproblem's definition F_rohf = 0.5 * (F_alpha + F_beta)\n        F_rohf = 0.5 * (F_alpha + F_beta)\n        tr_rohf = np.trace(F_rohf)\n        \n        # Assemble the results for the current test case\n        case_results = [\n            tr_rhf, \n            tr_alpha, \n            tr_beta, \n            tr_rohf, \n            gamma_rhf, \n            gamma_uhf, \n            gamma_rohf\n        ]\n        all_results.append(case_results)\n\n    # Final print statement in the exact required format.\n    # The f-string representation of a list of lists is a valid Python list literal.\n    print(f\"{all_results}\")\n\nsolve()\n```", "id": "2921462"}]}