{"hands_on_practices": [{"introduction": "This foundational exercise takes us back to first principles to explore Brillouin's theorem in its simplest, archetypal setting: the hydrogen molecule, $H_2$, in a minimal basis. By applying symmetry and the variational principle that underpins Hartree-Fock theory, you will analytically prove that the Fock matrix is diagonal in the basis of canonical orbitals. This practice [@problem_id:2877956] is essential for grasping why the theorem is not an ancillary detail, but a direct and necessary consequence of finding the optimal single-determinant wavefunction.", "problem": "Consider the hydrogen molecule $\\mathrm{H}_{2}$ at its equilibrium internuclear separation in a minimal basis consisting of the two $1s$ atomic orbitals centered on nuclei $A$ and $B$, denoted $\\chi_{A}$ and $\\chi_{B}$. Let the overlap integral be $S \\equiv \\langle \\chi_{A}|\\chi_{B}\\rangle$, with $0<S<1$. Assume a closed-shell restricted Hartree–Fock (RHF) description with $2$ electrons occupying a single spatial molecular orbital (MO) doubly with opposite spins. Work in atomic units. The Roothaan–Hall equations are $F C = S C \\varepsilon$, where $F$ is the Fock matrix in the atomic orbital basis, $S$ is the overlap matrix, $C$ is the coefficient matrix, and $\\varepsilon$ is the diagonal matrix of orbital energies.\n\na) Using only the inversion symmetry of $\\mathrm{H}_{2}$ and the fact that the nuclei and basis functions are equivalent by the symmetry that exchanges $A$ and $B$, derive the normalized canonical molecular orbitals $\\psi_{g}$ and $\\psi_{u}$ as linear combinations of $\\chi_{A}$ and $\\chi_{B}$ in terms of the overlap $S$. Do not assume orthogonality of $\\chi_{A}$ and $\\chi_{B}$; determine the required normalization constants explicitly in terms of $S$.\n\nb) Using the RHF variational principle and the Roothaan–Hall equations, argue from first principles that in the canonical MO basis the Fock matrix is diagonal, and identify the occupied orbital $i$ and the lowest virtual orbital $a$ with $\\psi_{g}$ and $\\psi_{u}$, respectively. From this, compute the off-diagonal canonical Fock matrix element $F_{ia}$.\n\nc) Using the Slater–Condon rules for configuration interaction matrix elements and the stationarity of the RHF determinant with respect to orbital rotations, evaluate the Hamiltonian coupling $\\langle \\Phi_{0}|H|\\Phi_{i}^{a}\\rangle$ between the RHF reference Slater determinant $\\Phi_{0}$ and the singly excited determinant $\\Phi_{i}^{a}$ obtained by replacing one electron in the occupied spatial MO $i$ by one in the virtual spatial MO $a$ (with a fixed spin). Express your final result in Hartree.\n\nReport your final answer as the pair $\\left(F_{ia},\\,\\langle \\Phi_{0}|H|\\Phi_{i}^{a}\\rangle\\right)$, written as a row matrix. No numerical rounding is required.", "solution": "The problem statement is subjected to validation.\n\nStep 1: Extract Givens\n- System: Hydrogen molecule, $\\mathrm{H}_{2}$, at equilibrium internuclear separation.\n- Basis set: Minimal basis of two $1s$ atomic orbitals, $\\chi_{A}$ and $\\chi_{B}$, centered on nuclei $A$ and $B$.\n- Overlap integral: $S \\equiv \\langle \\chi_{A}|\\chi_{B}\\rangle$, where $0 < S < 1$.\n- Electronic structure method: Closed-shell restricted Hartree–Fock (RHF) with $2$ electrons in a single doubly occupied spatial molecular orbital (MO).\n- Units: Atomic units (Hartrees for energy).\n- Governing equations: Roothaan–Hall equations, $F C = S C \\varepsilon$, where $F$ is the Fock matrix, $S$ is the overlap matrix, $C$ is the MO coefficient matrix, and $\\varepsilon$ is the diagonal matrix of orbital energies.\n- Symmetries: Inversion symmetry, and equivalence of nuclei and basis functions under exchange of $A$ and $B$.\n\nStep 2: Validate Using Extracted Givens\nThe problem is scientifically grounded, being a standard illustrative example from the field of quantum chemistry. It deals with fundamental concepts of the Linear Combination of Atomic Orbitals (LCAO) approximation, Hartree-Fock theory, and Configuration Interaction (CI). The problem is well-posed; the use of symmetry and the RHF framework provides a clear path to a unique answer. The language is objective and precise. The data provided, such as the existence of an overlap $S$ where $0 < S < 1$, is physically realistic for molecular systems. The problem is self-contained and free of contradictions.\n\nStep 3: Verdict and Action\nThe problem is valid. A complete solution will be provided.\n\nThe solution is structured into the three parts requested by the problem statement.\n\na) Derivation of the Canonical Molecular Orbitals\n\nThe molecular orbitals (MOs), $\\psi$, are constructed as a Linear Combination of Atomic Orbitals (LCAO), $\\chi_{A}$ and $\\chi_{B}$:\n$$ \\psi = c_{A}\\chi_{A} + c_{B}\\chi_{B} $$\nThe $\\mathrm{H}_{2}$ molecule possesses inversion symmetry. Let $\\hat{I}$ be the inversion operator. The basis functions are centered on the nuclei, which are exchanged by inversion, so $\\hat{I}\\chi_{A} = \\chi_{B}$ and $\\hat{I}\\chi_{B} = \\chi_{A}$. The MOs must be eigenfunctions of the symmetry operators of the molecular point group. Thus, $\\hat{I}\\psi = \\lambda\\psi$. Applying the operator twice restores the original state, so $\\hat{I}^2\\psi = \\psi$, which implies $\\lambda^2=1$ and thus $\\lambda = \\pm 1$.\n\nFor $\\lambda = +1$ (gerade symmetry, denoted by subscript $g$):\n$$ \\hat{I}\\psi_{g} = \\hat{I}(c_{A}\\chi_{A} + c_{B}\\chi_{B}) = c_{A}\\chi_{B} + c_{B}\\chi_{A} $$\nSetting this equal to $+1 \\cdot \\psi_{g} = c_{A}\\chi_{A} + c_{B}\\chi_{B}$ yields $c_{A} = c_{B}$. The unnormalized orbital is proportional to $(\\chi_{A} + \\chi_{B})$.\n\nFor $\\lambda = -1$ (ungerade symmetry, denoted by subscript $u$):\n$$ \\hat{I}\\psi_{u} = \\hat{I}(c_{A}\\chi_{A} + c_{B}\\chi_{B}) = c_{A}\\chi_{B} + c_{B}\\chi_{A} $$\nSetting this equal to $-1 \\cdot \\psi_{u} = -c_{A}\\chi_{A} - c_{B}\\chi_{B}$ yields $c_{A} = -c_{B}$. The unnormalized orbital is proportional to $(\\chi_{A} - \\chi_{B})$.\n\nWe now normalize these orbitals. The atomic orbitals are assumed to be normalized, $\\langle \\chi_{A} | \\chi_{A} \\rangle = \\langle \\chi_{B} | \\chi_{B} \\rangle = 1$. The overlap is given as $S = \\langle \\chi_{A} | \\chi_{B} \\rangle$. Since the orbitals are real, $S = \\langle \\chi_{B} | \\chi_{A} \\rangle$.\n\nFor $\\psi_{g} = N_{g}(\\chi_{A} + \\chi_{B})$, the normalization condition $\\langle \\psi_{g} | \\psi_{g} \\rangle = 1$ gives:\n$$ N_{g}^2 \\langle \\chi_{A} + \\chi_{B} | \\chi_{A} + \\chi_{B} \\rangle = N_{g}^2 (\\langle \\chi_{A}|\\chi_{A} \\rangle + \\langle \\chi_{B}|\\chi_{B} \\rangle + \\langle \\chi_{A}|\\chi_{B} \\rangle + \\langle \\chi_{B}|\\chi_{A} \\rangle) = 1 $$\n$$ N_{g}^2 (1 + 1 + S + S) = N_{g}^2 (2 + 2S) = 1 \\implies N_{g} = \\frac{1}{\\sqrt{2(1+S)}} $$\nThus, the normalized gerade MO is:\n$$ \\psi_{g} = \\frac{1}{\\sqrt{2(1+S)}} (\\chi_{A} + \\chi_{B}) $$\nFor $\\psi_{u} = N_{u}(\\chi_{A} - \\chi_{B})$, the normalization condition $\\langle \\psi_{u} | \\psi_{u} \\rangle = 1$ gives:\n$$ N_{u}^2 \\langle \\chi_{A} - \\chi_{B} | \\chi_{A} - \\chi_{B} \\rangle = N_{u}^2 (\\langle \\chi_{A}|\\chi_{A} \\rangle + \\langle \\chi_{B}|\\chi_{B} \\rangle - \\langle \\chi_{A}|\\chi_{B} \\rangle - \\langle \\chi_{B}|\\chi_{A} \\rangle) = 1 $$\n$$ N_{u}^2 (1 + 1 - S - S) = N_{u}^2 (2 - 2S) = 1 \\implies N_{u} = \\frac{1}{\\sqrt{2(1-S)}} $$\nThus, the normalized ungerade MO is:\n$$ \\psi_{u} = \\frac{1}{\\sqrt{2(1-S)}} (\\chi_{A} - \\chi_{B}) $$\n\nb) The Fock Matrix in the Canonical MO Basis\n\nThe Roothaan–Hall equations $F C = S C \\varepsilon$ define a generalized eigenvalue problem. The solutions are the molecular orbital coefficient matrix $C$ and the diagonal matrix of orbital energies $\\varepsilon$. The columns of $C$ contain the coefficients that define the canonical MOs $\\psi_{p}$ in the AO basis.\nThe transformation from the AO basis representation of the Fock matrix, $F_{AO}$, to the MO basis representation, $F_{MO}$, is given by $F_{MO} = C^{\\dagger} F_{AO} C$.\nBy left-multiplying the Roothaan–Hall equation by $C^{\\dagger}$, we get:\n$$ C^{\\dagger} F C = C^{\\dagger} S C \\varepsilon $$\nThe canonical MOs are by definition an orthonormal set, so $\\langle \\psi_{p} | \\psi_{q} \\rangle = \\delta_{pq}$. The matrix representation of the overlap operator in the MO basis is therefore the identity matrix, $I$. We can verify this: $(C^{\\dagger} S C)_{pq} = \\langle \\psi_{p} | \\psi_{q} \\rangle = \\delta_{pq}$.\nSubstituting this into the transformed equation yields:\n$$ F_{MO} = C^{\\dagger} F C = I \\varepsilon = \\varepsilon $$\nSince $\\varepsilon$ is the diagonal matrix of orbital energies, the Fock matrix $F_{MO}$ is diagonal in the basis of canonical MOs. This is not an assumption but a direct consequence of the definition of canonical Hartree-Fock orbitals.\n\nThe orbital $\\psi_{g}$ corresponds to a constructive interference (bonding) of the AOs, leading to an accumulation of electron density between the nuclei. This lowers the energy. The orbital $\\psi_{u}$ has a nodal plane between the nuclei (antibonding), which raises the energy. Therefore, $\\varepsilon_{g} < \\varepsilon_{u}$.\nIn the RHF ground state of $\\mathrm{H}_{2}$ with $2$ electrons, both electrons occupy the lowest energy spatial orbital, $\\psi_{g}$.\nThus, the occupied orbital is $i = \\psi_{g}$. The lowest-energy virtual (unoccupied) orbital is $a = \\psi_{u}$.\nThe off-diagonal element of the Fock matrix in the canonical MO basis is $F_{ia} = F_{gu}$. As established, the Fock matrix in this basis is diagonal:\n$$ F_{MO} = \\begin{pmatrix} F_{gg} & F_{gu} \\\\ F_{ug} & F_{uu} \\end{pmatrix} = \\begin{pmatrix} \\varepsilon_{g} & 0 \\\\ 0 & \\varepsilon_{u} \\end{pmatrix} $$\nTherefore, the off-diagonal element $F_{ia}$ is identically zero.\n$$ F_{ia} = F_{gu} = 0 $$\n\nc) The Hamiltonian Coupling Matrix Element $\\langle \\Phi_{0}|H|\\Phi_{i}^{a}\\rangle$\n\nThis is an evaluation of the matrix element that appears in Configuration Interaction (CI) theory and is central to Brillouin's theorem. The RHF ground state determinant is $\\Phi_{0} = |\\psi_{g}\\overline{\\psi_{g}}|$, where the bar denotes spin $\\beta$ and no bar denotes spin $\\alpha$. A singly excited determinant, where an electron is promoted from the occupied MO $i$ to the virtual MO $a$, is $\\Phi_{i}^{a}$. With $i=\\psi_{g}$ and $a=\\psi_{u}$, and choosing to excite the spin-$\\alpha$ electron, we have $\\Phi_{g}^{u} = |\\psi_{u}\\overline{\\psi_{g}}|$.\n\nBrillouin's theorem states that for a canonical Hartree-Fock wavefunction $\\Phi_{0}$, the Hamiltonian matrix elements between $\\Phi_{0}$ and all singly excited determinants $\\Phi_{i}^{a}$ are zero: $\\langle \\Phi_{0}|H|\\Phi_{i}^{a}\\rangle = 0$. This theorem is a direct consequence of the variational procedure used to obtain the Hartree-Fock orbitals. The HF energy $E_{HF} = \\langle \\Phi_{0}|H|\\Phi_{0}\\rangle$ is stationary (minimized) with respect to first-order variations in the spin-orbitals. A singly excited determinant $\\Phi_{i}^{a}$ can be shown to be the first-order component of a wavefunction obtained by an infinitesimal rotation of the occupied orbital $\\psi_i$ with the virtual orbital $\\psi_a$. The condition that the energy is stationary implies that the matrix element coupling the reference state to this first-order variation must vanish.\n\nAlternatively, we can prove this by explicit evaluation using the Slater-Condon rules and relating the result to the Fock matrix element derived in part (b). The matrix element between two determinants differing by a single spin-orbital $(\\phi_{i} \\to \\phi_{a})$ is given by:\n$$ \\langle \\Phi_{0}|H|\\Phi_{i}^{a}\\rangle = \\langle \\phi_{i} |h| \\phi_{a} \\rangle + \\sum_{j \\in \\mathrm{occ}} \\left( \\langle \\phi_{i}\\phi_{j}|\\frac{1}{r_{12}}|\\phi_{a}\\phi_{j} \\rangle - \\langle \\phi_{i}\\phi_{j}|\\frac{1}{r_{12}}|\\phi_{j}\\phi_{a} \\rangle \\right) $$\nwhere the sum runs over all spin-orbitals $j$ occupied in $\\Phi_{0}$. This expression is precisely the definition of the off-diagonal Fock matrix element between spin-orbitals $\\phi_{i}$ and $\\phi_{a}$, $F_{ia} = \\langle \\phi_{i}|F|\\phi_{a} \\rangle$.\nIn our specific case, the spin-orbitals are $\\phi_{i} = \\psi_{g}\\alpha$ and $\\phi_{a} = \\psi_{u}\\alpha$. The occupied spin-orbitals are $\\psi_{g}\\alpha$ and $\\psi_{g}\\beta$. We have shown in part (b) that the Fock matrix element between the canonical spatial orbitals $i=\\psi_{g}$ and $a=\\psi_{u}$ is $F_{ia}=0$. This implies that the Fock matrix element between the corresponding spin-orbitals is also zero.\nTherefore, we have the general identity known as the generalized Brillouin theorem:\n$$ \\langle \\Phi_{0}|H|\\Phi_{i}^{a}\\rangle = F_{ia} $$\nFrom part (b), we established that for canonical orbitals, $F_{ia} = 0$. Consequently, the Hamiltonian coupling is also zero.\n$$ \\langle \\Phi_{0}|H|\\Phi_{i}^{a}\\rangle = 0 \\text{ Hartree} $$\nThe pair of requested values is $(F_{ia}, \\langle \\Phi_{0}|H|\\Phi_{i}^{a}\\rangle) = (0, 0)$.", "answer": "$$\n\\boxed{\\begin{pmatrix} 0 & 0 \\end{pmatrix}}\n$$", "id": "2877956"}, {"introduction": "From analytical theory, we now transition to computational practice. This exercise [@problem_id:2877902] guides you through the process of writing a simple but complete self-consistent field (SCF) program to perform a Restricted Hartree-Fock calculation. The goal is to numerically verify that the off-diagonal Fock matrix elements between occupied and virtual canonical orbitals converge to zero, providing a tangible demonstration of Brillouin's theorem as an operational principle in quantum chemistry algorithms.", "problem": "You are to write a complete, runnable program that numerically verifies Brillouin’s theorem for closed-shell Restricted Hartree–Fock (RHF) in an orthonormal atomic orbital basis. The verification target is that for canonical Hartree–Fock orbitals, the occupied–virtual block elements $F_{ia}$ of the Fock matrix expressed in the molecular orbital basis vanish within a specified tight numerical threshold. The program must construct the RHF solution from first principles using the definitions below, without external data or user input, and report a boolean result for each provided test case.\n\nStart from the following foundational definitions and facts:\n- In RHF for a closed-shell system with an even number of electrons $N_{\\mathrm{e}}$, the number of doubly occupied spatial orbitals is $n_{\\mathrm{occ}} = N_{\\mathrm{e}}/2$, and the total number of spatial basis functions is $n$.\n- The one-electron core Hamiltonian matrix is $h_{\\mu\\nu}$ (in Hartree atomic units), and the two-electron integrals in chemist’s notation are $(\\mu\\nu\\vert\\lambda\\sigma)$.\n- The spin-summed RHF density matrix is $P_{\\mu\\nu} = 2\\sum_{i=1}^{n_{\\mathrm{occ}}} C_{\\mu i} C_{\\nu i}$, where $C_{\\mu i}$ are the molecular orbital coefficients.\n- The Fock matrix is $F_{\\mu\\nu} = h_{\\mu\\nu} + G_{\\mu\\nu}$ with $G_{\\mu\\nu} = \\sum_{\\lambda\\sigma} P_{\\lambda\\sigma}\\left[2(\\mu\\nu\\vert\\lambda\\sigma) - (\\mu\\lambda\\vert\\nu\\sigma)\\right]$.\n- Canonical Hartree–Fock orbitals are obtained by solving $F C = S C \\varepsilon$; in this problem the basis is orthonormal so $S_{\\mu\\nu} = \\delta_{\\mu\\nu}$, and the equation reduces to $F C = C \\varepsilon$ with diagonal matrix $\\varepsilon$ of orbital energies.\n- Brillouin’s theorem (for closed-shell RHF) implies that in the canonical molecular orbital basis, the occupied–virtual Fock elements $F_{ia}$ are zero at self-consistency, where index $i$ runs over occupied orbitals and index $a$ runs over virtual orbitals.\n\nImplementation model and constraints:\n- You will work in an orthonormal basis, so $S_{\\mu\\nu} = \\delta_{\\mu\\nu}$.\n- To keep the two-electron structure simple but nontrivial, use the following reduced integral model, consistent with a zero-differential-overlap style approximation that preserves the Coulomb and a simplified exchange structure:\n  1. Define a symmetric Coulomb parameter matrix $U \\in \\mathbb{R}^{n\\times n}$ with elements $U_{\\mu\\lambda}$.\n  2. Define the two-electron tensor by $(\\mu\\nu\\vert\\lambda\\sigma) = 0$ unless $\\mu = \\nu$ and $\\lambda = \\sigma$, in which case $(\\mu\\mu\\vert\\lambda\\lambda) = U_{\\mu\\lambda}$.\n  3. Under this model, the Coulomb and exchange contributions reduce to $J_{\\mu\\nu} = \\delta_{\\mu\\nu}\\sum_{\\lambda} P_{\\lambda\\lambda} U_{\\mu\\lambda}$ and $K_{\\mu\\nu} = P_{\\mu\\nu} U_{\\mu\\nu}$, so that $F = h + 2J - K$.\n- Use a straightforward self-consistent field iteration:\n  1. Initialize $P$ from the lowest $n_{\\mathrm{occ}}$ eigenvectors of $h$.\n  2. At each iteration, build $F = h + 2J - K$, diagonalize $F$ to obtain $C$ and update $P$ from the lowest $n_{\\mathrm{occ}}$ orbitals. Use linear mixing $P \\leftarrow (1-\\alpha) P_{\\mathrm{old}} + \\alpha P_{\\mathrm{new}}$ with a mixing factor $\\alpha$.\n  3. Converge when the Frobenius norm of the change in $P$ is below a tolerance; enforce a maximum number of iterations and assume convergence for the given data.\n  4. After convergence, rebuild $F$ from the converged $P$ and obtain the canonical orbitals by diagonalizing $F$.\n- Finally, compute $F$ in the molecular orbital basis $F^{\\mathrm{MO}} = C^{\\mathsf{T}} F C$, extract the block with indices $i \\in \\{1,\\dots,n_{\\mathrm{occ}}\\}$ and $a \\in \\{n_{\\mathrm{occ}}+1,\\dots,n\\}$, and verify that all elements $F_{ia}^{\\mathrm{MO}}$ are below a given threshold $\\tau$ in absolute value. If there are no virtual orbitals ($n_{\\mathrm{occ}} = n$) or no occupied orbitals ($n_{\\mathrm{occ}} = 0$), return a boolean value of true by convention for that case.\n\nTest suite:\nFor each case below, all entries of $h$ and $U$ are in Hartree atomic units. Indices are zero-based in the input description, but you will implement them as standard arrays. In each item, $n$ is the basis size and $N_{\\mathrm{e}}$ is the number of electrons. The RHF must be closed-shell with $N_{\\mathrm{e}}$ even and $N_{\\mathrm{e}} \\le 2n$.\n\n- Case A (Neon-like closed shell with one virtual orbital):\n  - $n = 6$, $N_{\\mathrm{e}} = 10$, threshold $\\tau = 10^{-8}$.\n  - One-electron matrix $h$ (symmetric, only listed nonzero distinct elements):\n    - Diagonal: $h_{00} = -32.0$, $h_{11} = -1.8$, $h_{22} = -0.9$, $h_{33} = -0.9$, $h_{44} = -0.9$, $h_{55} = -0.2$.\n    - Off-diagonal: $h_{1,5} = h_{5,1} = -0.05$, $h_{2,5} = h_{5,2} = -0.02$, $h_{3,5} = h_{5,3} = -0.02$, $h_{4,5} = h_{5,4} = -0.02$.\n  - Coulomb parameter matrix $U$ (symmetric; only upper triangle listed, with symmetry implied):\n    - $U_{00} = 5.0$, $U_{01} = 1.5$, $U_{02} = 1.2$, $U_{03} = 1.2$, $U_{04} = 1.2$, $U_{05} = 0.8$,\n    - $U_{11} = 1.6$, $U_{12} = 1.3$, $U_{13} = 1.3$, $U_{14} = 1.3$, $U_{15} = 1.0$,\n    - $U_{22} = 1.4$, $U_{23} = 1.2$, $U_{24} = 1.2$, $U_{25} = 0.9$,\n    - $U_{33} = 1.4$, $U_{34} = 1.2$, $U_{35} = 0.9$,\n    - $U_{44} = 1.4$, $U_{45} = 0.9$,\n    - $U_{55} = 1.1$.\n\n- Case B (Beryllium-like closed shell with multiple virtuals and mild mixing):\n  - $n = 5$, $N_{\\mathrm{e}} = 4$, $\\tau = 10^{-8}$.\n  - One-electron matrix $h$:\n    - Diagonal: $h_{00} = -10.0$, $h_{11} = -1.0$, $h_{22} = -0.6$, $h_{33} = -0.6$, $h_{44} = -0.2$.\n    - Off-diagonal: $h_{1,4} = h_{4,1} = -0.05$, $h_{2,3} = h_{3,2} = -0.02$.\n  - Coulomb parameter matrix $U$:\n    - $U_{00} = 4.0$, $U_{01} = 1.2$, $U_{02} = 1.0$, $U_{03} = 1.0$, $U_{04} = 0.7$,\n    - $U_{11} = 1.5$, $U_{12} = 1.1$, $U_{13} = 1.1$, $U_{14} = 0.9$,\n    - $U_{22} = 1.2$, $U_{23} = 1.1$, $U_{24} = 0.8$,\n    - $U_{33} = 1.2$, $U_{34} = 0.8$,\n    - $U_{44} = 1.0$.\n\n- Case C (Edge case with no virtual orbitals):\n  - $n = 2$, $N_{\\mathrm{e}} = 4$, $\\tau = 10^{-8}$.\n  - One-electron matrix $h$:\n    - Diagonal: $h_{00} = -1.0$, $h_{11} = -0.5$.\n  - Coulomb parameter matrix $U$:\n    - $U_{00} = 1.0$, $U_{01} = 0.7$, $U_{11} = 0.8$.\n\nAlgorithmic requirements:\n- Implement RHF with linear mixing using a mixing factor $\\alpha = 0.7$, maximum iterations $200$, and convergence threshold on the Frobenius norm of the density change $\\lVert \\Delta P \\rVert_{\\mathrm{F}} < 10^{-12}$.\n- After convergence, evaluate $F^{\\mathrm{MO}} = C^{\\mathsf{T}} F C$, extract the occupied–virtual block, and return true if its maximum absolute element is less than the test’s $\\tau$ (or true if there are no such elements).\n\nFinal output specification:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, for the cases A, B, and C in that order, for example: \"[true1,true2,true3]\". The elements must be the Python boolean literals \"True\" or \"False\".\n\nNo user input is permitted, and no external data sources may be used. All computations are in Hartree atomic units; the final answers are booleans, so no unit must be printed.", "solution": "The problem statement has been subjected to rigorous validation and is found to be valid. It is a well-posed, scientifically grounded problem in computational quantum chemistry that requests the numerical verification of Brillouin's theorem for a closed-shell Restricted Hartree-Fock (RHF) system within a specified simplified model. All necessary data, parameters, and algorithmic constraints are provided, allowing for a unique and verifiable solution. We shall proceed with a detailed exposition of the theoretical framework and the computational algorithm.\n\nThe objective is to implement the self-consistent field (SCF) procedure for a closed-shell molecule, as described by the RHF equations, and subsequently verify that for the resultant canonical molecular orbitals, the elements of the Fock matrix connecting occupied and virtual orbitals are numerically zero, as predicted by Brillouin's theorem.\n\nThe foundational equation of RHF theory in an orthonormal basis is the Roothaan-Hall equation, which takes the form of a matrix eigenvalue problem:\n$$\nF C = C \\varepsilon\n$$\nHere, $F$ is the Fock matrix in the atomic orbital (AO) basis, $C$ is the matrix of molecular orbital (MO) coefficients, and $\\varepsilon$ is a diagonal matrix containing the orbital energies. The basis is specified as orthonormal, hence the overlap matrix is the identity matrix, $S = I$.\n\nThe Fock matrix $F$ is defined as the sum of the one-electron core Hamiltonian $h$ and the two-electron operator $G$:\n$$\nF_{\\mu\\nu} = h_{\\mu\\nu} + G_{\\mu\\nu}\n$$\nThe two-electron part, $G_{\\mu\\nu}$, accounts for the average repulsion that one electron experiences from all other electrons. For a closed-shell system, it is given by:\n$$\nG_{\\mu\\nu} = \\sum_{\\lambda\\sigma} P_{\\lambda\\sigma} \\left[ (\\mu\\nu|\\lambda\\sigma) - \\frac{1}{2}(\\mu\\lambda|\\nu\\sigma) \\right]\n$$\nwhere $(\\mu\\nu|\\lambda\\sigma)$ are the two-electron repulsion integrals in chemist's notation, and $P_{\\lambda\\sigma}$ is the density matrix. The density matrix is constructed from the MO coefficients of the $n_{\\mathrm{occ}} = N_{\\mathrm{e}}/2$ doubly occupied orbitals:\n$$\nP_{\\mu\\nu} = 2 \\sum_{i=1}^{n_{\\mathrm{occ}}} C_{\\mu i} C^*_{\\nu i}\n$$\nSince this problem deals with real-valued orbitals, the complex conjugate is omitted.\n\nThe problem introduces a simplified model for the two-electron integrals, characteristic of Zero-Differential Overlap (ZDO) approximations. The integral $(\\mu\\nu|\\lambda\\sigma)$ is non-zero only if $\\mu=\\nu$ and $\\lambda=\\sigma$, in which case its value is given by a symmetric parameter matrix $U$:\n$$\n(\\mu\\nu|\\lambda\\sigma) = U_{\\mu\\lambda} \\delta_{\\mu\\nu} \\delta_{\\lambda\\sigma}\n$$\nUnder this approximation, the general expression for $G_{\\mu\\nu}$ simplifies significantly. The Coulomb contribution, $J_{\\mu\\nu} = \\sum_{\\lambda\\sigma} P_{\\lambda\\sigma} (\\mu\\nu|\\lambda\\sigma)$, becomes:\n$$\nJ_{\\mu\\nu} = \\sum_{\\lambda\\sigma} P_{\\lambda\\sigma} (U_{\\mu\\lambda} \\delta_{\\mu\\nu} \\delta_{\\lambda\\sigma}) = \\delta_{\\mu\\nu} \\sum_{\\lambda} P_{\\lambda\\lambda} U_{\\mu\\lambda}\n$$\nThis shows that the Coulomb matrix $J$ is diagonal. The exchange contribution, $K_{\\mu\\nu} = \\sum_{\\lambda\\sigma} P_{\\lambda\\sigma} (\\mu\\lambda|\\nu\\sigma)$, becomes:\n$$\nK_{\\mu\\nu} = \\sum_{\\lambda\\sigma} P_{\\lambda\\sigma} (U_{\\mu\\nu} \\delta_{\\mu\\lambda} \\delta_{\\nu\\sigma}) = U_{\\mu\\nu} P_{\\mu\\nu}\n$$\nThis shows that the exchange matrix $K$ is the element-wise (Hadamard) product of the matrices $U$ and $P$. The full two-electron term is $G = 2J - K$, leading to the specialized Fock matrix for this problem:\n$$\nF_{\\mu\\nu} = h_{\\mu\\nu} + 2\\delta_{\\mu\\nu} \\sum_{\\lambda} P_{\\lambda\\lambda} U_{\\mu\\lambda} - P_{\\mu\\nu} U_{\\mu\\nu}\n$$\n\nThe Roothaan-Hall equation is non-linear because the Fock matrix $F$ depends on the density matrix $P$, which in turn depends on the MO coefficients $C$ that are the eigenvectors of $F$. This non-linearity necessitates an iterative solution, known as the SCF procedure. The algorithm to be implemented is as follows:\n1.  **Initialization**: An initial guess for the density matrix $P$ is required. A standard choice is to diagonalize the core Hamiltonian $h$ to obtain initial MO coefficients $C^{(0)}$ and form $P^{(0)}$ from the $n_{\\mathrm{occ}}$ eigenvectors corresponding to the lowest eigenvalues.\n2.  **SCF Iteration**: For the $k$-th iteration:\n    a. Construct the Fock matrix $F^{(k)}$ using the current density matrix $P^{(k-1)}$.\n    b. Solve the eigenvalue problem $F^{(k)} C^{(k)} = C^{(k)} \\varepsilon^{(k)}$ to obtain new MO coefficients $C^{(k)}$ and orbital energies $\\varepsilon^{(k)}$. The eigenvectors in $C^{(k)}$ must be sorted according to their corresponding eigenvalues in ascending order.\n    c. Form a new density matrix $P_{\\mathrm{new}}^{(k)}$ using the first $n_{\\mathrm{occ}}$ columns of $C^{(k)}$.\n    d. To aid convergence, apply linear mixing of the old and new density matrices using a mixing parameter $\\alpha$: $P^{(k)} = (1-\\alpha) P^{(k-1)} + \\alpha P_{\\mathrm{new}}^{(k)}$.\n    e. Check for convergence by evaluating the change in the density matrix, for instance, by computing the Frobenius norm of the difference, $\\lVert P^{(k)} - P^{(k-1)} \\rVert_{\\mathrm{F}}$. The loop terminates when this norm falls below a specified convergence threshold, $\\epsilon_{\\mathrm{conv}}$. A maximum number of iterations is enforced.\n\n3.  **Post-SCF Verification**: Upon convergence, the final density matrix $P$ and the corresponding Fock matrix $F$ are self-consistent. The eigenvectors of this final $F$ are the canonical molecular orbitals. Brillouin's theorem states that for these canonical orbitals, the Fock matrix elements between occupied orbitals (indexed by $i, j, \\dots$) and virtual orbitals (indexed by $a, b, \\dots$) are zero. To verify this, we first transform the Fock matrix from the AO basis to the MO basis:\n    $$\n    F^{\\mathrm{MO}} = C^\\mathsf{T} F C\n    $$\n    Since $C$ contains the eigenvectors of $F$, $F^{\\mathrm{MO}}$ must be a diagonal matrix equal to $\\varepsilon$. Consequently, all off-diagonal elements, including the occupied-virtual block $F^{\\mathrm{MO}}_{ia}$, must be zero. The numerical verification consists of extracting this specific block, corresponding to rows $i \\in \\{1,\\dots,n_{\\mathrm{occ}}\\}$ and columns $a \\in \\{n_{\\mathrm{occ}}+1,\\dots,n\\}$, and checking if the absolute value of every element is smaller than the given numerical threshold $\\tau$. If the set of occupied or virtual orbitals is empty, the theorem is considered trivially satisfied.\n\nThe implementation will execute this entire procedure for each test case provided. The core calculations involve matrix constructions and diagonalizations, which are well-suited for numerical libraries such as NumPy and SciPy. The final result for each case will be a boolean value indicating whether $\\max_{i,a} |F^{\\mathrm{MO}}_{ia}| < \\tau$.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nimport scipy.linalg\n\ndef solve():\n    \"\"\"\n    Main function to define test cases and run the RHF verification.\n    \"\"\"\n    \n    # Algorithmic parameters from the problem description\n    alpha = 0.7\n    max_iter = 200\n    conv_tol = 1e-12\n\n    test_cases = [\n        # Case A: Neon-like closed shell\n        {\n            \"name\": \"A\",\n            \"n\": 6,\n            \"Ne\": 10,\n            \"tau\": 1e-8,\n            \"h_elements\": {\n                (0, 0): -32.0, (1, 1): -1.8, (2, 2): -0.9, (3, 3): -0.9,\n                (4, 4): -0.9, (5, 5): -0.2, (1, 5): -0.05, (2, 5): -0.02,\n                (3, 5): -0.02, (4, 5): -0.02\n            },\n            \"U_elements\": {\n                (0, 0): 5.0, (0, 1): 1.5, (0, 2): 1.2, (0, 3): 1.2, (0, 4): 1.2, (0, 5): 0.8,\n                (1, 1): 1.6, (1, 2): 1.3, (1, 3): 1.3, (1, 4): 1.3, (1, 5): 1.0,\n                (2, 2): 1.4, (2, 3): 1.2, (2, 4): 1.2, (2, 5): 0.9,\n                (3, 3): 1.4, (3, 4): 1.2, (3, 5): 0.9,\n                (4, 4): 1.4, (4, 5): 0.9,\n                (5, 5): 1.1\n            }\n        },\n        # Case B: Beryllium-like closed shell\n        {\n            \"name\": \"B\",\n            \"n\": 5,\n            \"Ne\": 4,\n            \"tau\": 1e-8,\n            \"h_elements\": {\n                (0, 0): -10.0, (1, 1): -1.0, (2, 2): -0.6, (3, 3): -0.6,\n                (4, 4): -0.2, (1, 4): -0.05, (2, 3): -0.02\n            },\n            \"U_elements\": {\n                (0, 0): 4.0, (0, 1): 1.2, (0, 2): 1.0, (0, 3): 1.0, (0, 4): 0.7,\n                (1, 1): 1.5, (1, 2): 1.1, (1, 3): 1.1, (1, 4): 0.9,\n                (2, 2): 1.2, (2, 3): 1.1, (2, 4): 0.8,\n                (3, 3): 1.2, (3, 4): 0.8,\n                (4, 4): 1.0\n            }\n        },\n        # Case C: Edge case with no virtuals\n        {\n            \"name\": \"C\",\n            \"n\": 2,\n            \"Ne\": 4,\n            \"tau\": 1e-8,\n            \"h_elements\": {\n                (0, 0): -1.0, (1, 1): -0.5\n            },\n            \"U_elements\": {\n                (0, 0): 1.0, (0, 1): 0.7, (1, 1): 0.8\n            }\n        }\n    ]\n\n    def construct_symmetric_matrix(size, elements):\n        \"\"\"Helper to build symmetric matrices from a dictionary of elements.\"\"\"\n        mat = np.zeros((size, size))\n        for (i, j), val in elements.items():\n            mat[i, j] = val\n            if i != j:\n                mat[j, i] = val\n        return mat\n\n    def run_rhf_and_verify(case_data):\n        \"\"\"Performs RHF-SCF and verifies Brillouin's theorem for a single case.\"\"\"\n        n, Ne, tau = case_data[\"n\"], case_data[\"Ne\"], case_data[\"tau\"]\n        h_elements, U_elements = case_data[\"h_elements\"], case_data[\"U_elements\"]\n        \n        n_occ = Ne // 2\n\n        # Per problem specification, return True if no occupied or no virtual orbitals.\n        if n_occ == 0 or n_occ == n:\n            return True\n\n        # Construct matrices from input data\n        h = construct_symmetric_matrix(n, h_elements)\n        U = construct_symmetric_matrix(n, U_elements)\n\n        # 1. Initial Guess for Density Matrix P\n        # Diagonalize core Hamiltonian h and use lowest n_occ eigenvectors\n        _, C = scipy.linalg.eigh(h)\n        C_occ = C[:, :n_occ]\n        P = 2 * (C_occ @ C_occ.T)\n\n        # 2. SCF Iteration Loop\n        for _ in range(max_iter):\n            P_old = P.copy()\n\n            # Build Fock matrix F = h + 2J - K\n            p_diag = np.diag(P)\n            j_diag = U @ p_diag\n            J = np.diag(j_diag)\n            K = P * U\n            F = h + 2 * J - K\n\n            # Diagonalize F to get new MO coefficients\n            # eigh returns eigenvalues in ascending order, which is convenient\n            _, C = scipy.linalg.eigh(F)\n\n            # Form new density matrix P_new\n            C_occ = C[:, :n_occ]\n            P_new = 2 * (C_occ @ C_occ.T)\n\n            # Apply linear mixing\n            P = (1 - alpha) * P_old + alpha * P_new\n\n            # Check for convergence\n            delta_P = P - P_old\n            if np.linalg.norm(delta_P) < conv_tol:\n                break\n        \n        # 3. Post-SCF Verification of Brillouin's Theorem\n        # Rebuild the final Fock matrix from the converged density matrix\n        p_diag = np.diag(P)\n        j_diag = U @ p_diag\n        J = np.diag(j_diag)\n        K = P * U\n        F_final = h + 2 * J - K\n\n        # Get the canonical orbitals by diagonalizing the final Fock matrix\n        _, C_final = scipy.linalg.eigh(F_final)\n\n        # Transform the Fock matrix to the MO basis\n        F_mo = C_final.T @ F_final @ C_final\n\n        # Extract the occupied-virtual block\n        # Occupied indices: 0 to n_occ-1\n        # Virtual indices: n_occ to n-1\n        F_ov = F_mo[:n_occ, n_occ:]\n\n        # F_ov block might be empty if n_occ=n (already handled), but this is robust\n        if F_ov.size == 0:\n            return True\n            \n        # Check if the largest absolute element is below the threshold\n        max_abs_val = np.max(np.abs(F_ov))\n        \n        return max_abs_val < tau\n\n    results = []\n    for case in test_cases:\n        result = run_rhf_and_verify(case)\n        results.append(str(result))\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "2877902"}, {"introduction": "Our final practice extends the concept of single-excitation constraints from Hartree-Fock theory to the more general and widely used framework of Kohn-Sham Density Functional Theory (DFT). In this advanced exercise [@problem_id:2877898], you will derive the structure of the Generalized Kohn-Sham (GKS) operator for a hybrid functional. You will demonstrate that a 'generalized Brillouin's theorem' holds, where the GKS matrix is diagonal in the canonical orbital basis, a crucial condition for achieving self-consistency in modern electronic structure calculations.", "problem": "Consider a closed-shell, two-electron system described by a single Slater determinant built from orthonormal spatial orbitals. Let the lowest spatial orbital be doubly occupied and denoted by $\\phi_{i}$, and the next spatial orbital be unoccupied and denoted by $\\phi_{a}$. The total energy is treated within the Generalized Kohn–Sham (GKS) framework using a hybrid functional with exact-exchange fraction $\\alpha \\in [0,1]$. The hybrid functional mixes Hartree–Fock exchange with a semilocal exchange–correlation energy $E_{xc}^{\\text{sl}}[n]$, where $n(\\mathbf{r})$ is the electron density. Assume the following standard components:\n- The one-electron operator $\\hat{h} \\equiv \\hat{t} + \\hat{v}_{\\text{ext}}$, with matrix elements $h_{pq} \\equiv \\langle \\phi_{p} | \\hat{h} | \\phi_{q} \\rangle$.\n- Two-electron repulsion integrals $(pq|rs) \\equiv \\iint \\phi_{p}(\\mathbf{r}_{1}) \\phi_{q}(\\mathbf{r}_{1}) \\frac{1}{|\\mathbf{r}_{1}-\\mathbf{r}_{2}|} \\phi_{r}(\\mathbf{r}_{2}) \\phi_{s}(\\mathbf{r}_{2}) \\, d\\mathbf{r}_{1} \\, d\\mathbf{r}_{2}$ in chemists’ notation, with the usual permutation symmetries.\n- The semilocal exchange–correlation potential operator $\\hat{v}_{xc}^{\\text{sl}}[n] \\equiv \\delta E_{xc}^{\\text{sl}}[n]/\\delta n$ with matrix elements $v^{\\text{sl}}_{xc,pq} \\equiv \\langle \\phi_{p} | \\hat{v}_{xc}^{\\text{sl}}[n] | \\phi_{q} \\rangle$ evaluated at the self-consistent density $n$.\n- The nonlocal exact-exchange operator $\\hat{K}$ acting on a test orbital $\\varphi$ as $(\\hat{K}\\varphi)(\\mathbf{r}) \\equiv \\sum_{j \\in \\text{occ}} \\phi_{j}(\\mathbf{r}) \\int \\frac{\\phi_{j}(\\mathbf{r}^{\\prime}) \\varphi(\\mathbf{r}^{\\prime})}{|\\mathbf{r}-\\mathbf{r}^{\\prime}|} \\, d\\mathbf{r}^{\\prime}$.\n\nStarting from the variational principle for orbital rotations that mix the occupied orbital $\\phi_{i}$ with the virtual orbital $\\phi_{a}$ under orthonormality constraints, and using only fundamental definitions and well-tested facts, do the following:\n\n1. Derive the occupied–virtual matrix element $F^{\\text{GKS}}_{ia} \\equiv \\langle \\phi_{i} | \\hat{F}^{\\text{GKS}} | \\phi_{a} \\rangle$ of the Generalized Kohn–Sham operator associated with the hybrid functional, expressed in terms of $h_{ia}$, two-electron integrals of the form $(ia|ii)$ and $(ii|ia)$ as needed, the semilocal matrix element $v^{\\text{sl}}_{xc,ia}$, and the mixing parameter $\\alpha$.\n2. For this minimal two-orbital model, write $F^{\\text{GKS}}_{ia}$ explicitly as a linear combination of $h_{ia}$, $(ia|ii)$, and $v^{\\text{sl}}_{xc,ia}$ with coefficients that may depend on $\\alpha$.\n3. Using the stationarity of the energy with respect to occupied–virtual orbital rotations in the canonical orbital basis, state the value that $F^{\\text{GKS}}_{ia}$ must take at self-consistency and justify why this occurs in the hybrid GKS framework in relation to Brillouin’s theorem and single-excitation constraints.\n\nProvide your final answer as the self-consistent canonical value of $F^{\\text{GKS}}_{ia}$. No units are required. Do not round.", "solution": "The problem requires the derivation of an off-diagonal element of the Generalized Kohn-Sham (GKS) operator for a minimal closed-shell two-electron system and the determination of its value at self-consistency. The process is as follows: first, the GKS operator is constructed based on the provided hybrid functional definition. Second, its matrix element between the occupied orbital $\\phi_i$ and the virtual orbital $\\phi_a$ is computed term by term. Finally, the value of this matrix element is determined from the stationarity condition of the energy, which is fundamental to the self-consistent field (SCF) method.\n\nThe total energy functional for a hybrid GKS calculation is typically expressed as:\n$$E^{\\text{GKS}} = T_s[\\{\\phi_k\\}] + E_{\\text{ext}}[n] + E_J[n] + E_{xc}^{\\text{hybrid}}[\\{\\phi_k\\}, n]$$\nwhere $T_s$ is the kinetic energy of the non-interacting reference system, $E_{\\text{ext}}$ is the external potential energy, $E_J$ is the classical Coulomb repulsion energy (Hartree energy), and $E_{xc}^{\\text{hybrid}}$ is the hybrid exchange-correlation functional. The problem states that the functional mixes Hartree-Fock exchange with a semilocal exchange-correlation energy $E_{xc}^{\\text{sl}}[n]$. This implies an exchange-correlation energy of the form $E_{xc}^{\\text{hybrid}} = \\alpha E_x^{\\text{HF}}[\\{\\phi_k\\}] + E_{xc}^{\\text{sl}}[n]$, where $E_x^{\\text{HF}}$ is the exact exchange energy from the Slater determinant, and $\\alpha$ is the mixing fraction.\n\nThe corresponding GKS operator, $\\hat{F}^{\\text{GKS}}$, is obtained from the variational principle and has the general form:\n$$\\hat{F}^{\\text{GKS}} = \\hat{h} + \\hat{J} + \\hat{v}_{xc}^{\\text{hybrid}}$$\nwhere $\\hat{h}$ is the one-electron core Hamiltonian, $\\hat{J}$ is the Coulomb operator, and $\\hat{v}_{xc}^{\\text{hybrid}}$ is the hybrid exchange-correlation potential operator. Based on the specified energy form, this potential operator is $\\hat{v}_{xc}^{\\text{hybrid}} = \\alpha \\hat{v}_x^{\\text{HF}} + \\hat{v}_{xc}^{\\text{sl}}[n]$. The exact-exchange potential operator $\\hat{v}_x^{\\text{HF}}$ is the non-local operator $-\\hat{K}$. Thus, the GKS operator is:\n$$\\hat{F}^{\\text{GKS}} = \\hat{h} + \\hat{J} - \\alpha \\hat{K} + \\hat{v}_{xc}^{\\text{sl}}[n]$$\n\nWe are asked to find the matrix element $F^{\\text{GKS}}_{ia} = \\langle \\phi_i | \\hat{F}^{\\text{GKS}} | \\phi_a \\rangle$. We evaluate this term-by-term.\n1.  **Core Hamiltonian term**: This is given by the definition $h_{ia} = \\langle \\phi_i | \\hat{h} | \\phi_a \\rangle$.\n\n2.  **Coulomb term**: The action of the Coulomb operator $\\hat{J}$ on a spatial orbital $\\phi_p$ in a closed-shell system is given by $(\\hat{J}\\phi_p)(\\mathbf{r}_1) = \\left( 2 \\sum_{k \\in \\text{occ}} \\int \\frac{|\\phi_k(\\mathbf{r}_2)|^2}{|\\mathbf{r}_1 - \\mathbf{r}_2|} d\\mathbf{r}_2 \\right) \\phi_p(\\mathbf{r}_1)$. For this system, the only occupied orbital is $\\phi_i$, so the sum over $k$ has only one term, $k=i$.\n    The matrix element $J_{ia} = \\langle \\phi_i | \\hat{J} | \\phi_a \\rangle$ is:\n    $$J_{ia} = \\int \\phi_i^*(\\mathbf{r}_1) \\left( 2 \\int \\frac{|\\phi_i(\\mathbf{r}_2)|^2}{|\\mathbf{r}_1 - \\mathbf{r}_2|} d\\mathbf{r}_2 \\right) \\phi_a(\\mathbf{r}_1) d\\mathbf{r}_1$$\n    This expression can be rewritten using the standard two-electron integral notation $(pq|rs)$:\n    $$J_{ia} = 2 \\iint \\phi_i^*(\\mathbf{r}_1) \\phi_a(\\mathbf{r}_1) \\frac{1}{|\\mathbf{r}_1 - \\mathbf{r}_2|} \\phi_i^*(\\mathbf{r}_2) \\phi_i(\\mathbf{r}_2) d\\mathbf{r}_1 d\\mathbf{r}_2 = 2(ia|ii)$$\n\n3.  **Exchange term**: The nonlocal exchange operator $\\hat{K}$ is defined by its action on a test orbital $\\varphi$: $(\\hat{K}\\varphi)(\\mathbf{r}_1) = \\sum_{j \\in \\text{occ}} \\phi_{j}(\\mathbf{r}_1) \\int \\frac{\\phi_{j}^*(\\mathbf{r}_2) \\varphi(\\mathbf{r}_2)}{|\\mathbf{r}_1 - \\mathbf{r}_2|} d\\mathbf{r}_2$. Again, the sum over occupied orbitals $j$ only contains the term $j=i$. The matrix element $K_{ia} = \\langle \\phi_i | \\hat{K} | \\phi_a \\rangle$ is:\n    $$K_{ia} = \\int \\phi_i^*(\\mathbf{r}_1) \\left( \\phi_i(\\mathbf{r}_1) \\int \\frac{\\phi_i^*(\\mathbf{r}_2) \\phi_a(\\mathbf{r}_2)}{|\\mathbf{r}_1 - \\mathbf{r}_2|} d\\mathbf{r}_2 \\right) d\\mathbf{r}_1$$\n    In integral notation, this is:\n    $$K_{ia} = \\iint \\phi_i^*(\\mathbf{r}_1) \\phi_i(\\mathbf{r}_1) \\frac{1}{|\\mathbf{r}_1 - \\mathbf{r}_2|} \\phi_i^*(\\mathbf{r}_2) \\phi_a(\\mathbf{r}_2) d\\mathbf{r}_1 d\\mathbf{r}_2 = (ii|ia)$$\n\n4.  **Semilocal term**: This is given by the definition $v^{\\text{sl}}_{xc,ia} = \\langle \\phi_i | \\hat{v}_{xc}^{\\text{sl}}[n] | \\phi_a \\rangle$.\n\nCombining these terms, we obtain the expression for $F^{\\text{GKS}}_{ia}$:\n$$F^{\\text{GKS}}_{ia} = h_{ia} + 2(ia|ii) - \\alpha (ii|ia) + v^{\\text{sl}}_{xc,ia}$$\nThis completes the first part of the problem.\n\nFor the second part, we must write this as a linear combination of $h_{ia}$, $(ia|ii)$, and $v^{\\text{sl}}_{xc,ia}$. This requires relating the two-electron integrals $(ia|ii)$ and $(ii|ia)$. By swapping the dummy integration variables $\\mathbf{r}_1 \\leftrightarrow \\mathbf{r}_2$ in the definition of $(ii|ia)$, we find:\n$$(ii|ia) = \\iint \\phi_i^*(\\mathbf{r}_2) \\phi_i(\\mathbf{r}_2) \\frac{1}{|\\mathbf{r}_2 - \\mathbf{r}_1|} \\phi_i^*(\\mathbf{r}_1) \\phi_a(\\mathbf{r}_1) d\\mathbf{r}_2 d\\mathbf{r}_1 = \\iint \\phi_i^*(\\mathbf{r}_1) \\phi_a(\\mathbf{r}_1) \\frac{1}{|\\mathbf{r}_1 - \\mathbf{r}_2|} \\phi_i^*(\\mathbf{r}_2) \\phi_i(\\mathbf{r}_2) d\\mathbf{r}_1 d\\mathbf{r}_2 = (ia|ii)$$\nThis symmetry, $(pq|rs) = (rs|pq)$, holds generally. Substituting this into the expression for $F^{\\text{GKS}}_{ia}$:\n$$F^{\\text{GKS}}_{ia} = h_{ia} + 2(ia|ii) - \\alpha (ia|ii) + v^{\\text{sl}}_{xc,ia}$$\n$$F^{\\text{GKS}}_{ia} = h_{ia} + (2 - \\alpha)(ia|ii) + v^{\\text{sl}}_{xc,ia}$$\nThis is the required linear combination, with coefficients $1$, $(2-\\alpha)$, and $1$.\n\nFor the third part, we use the stationarity condition. The GKS equations are derived from the variational principle, requiring the total energy to be stationary with respect to variations in the orbitals that preserve orthonormality. A rotation mixing an occupied orbital $\\phi_i$ and a virtual orbital $\\phi_a$ is one such variation. The condition for stationarity with respect to such rotations is that the off-diagonal elements of the GKS operator matrix between the occupied and virtual orbital blocks must be zero. The set of orbitals that satisfies this condition is the set of canonical GKS orbitals, which are the eigenvectors of the GKS operator.\nTherefore, at self-consistency, the GKS operator matrix $\\mathbf{F}^{\\text{GKS}}$ is diagonal in the basis of canonical orbitals $\\{\\phi_p\\}$. This directly implies that for any occupied orbital $\\phi_i$ and any virtual (unoccupied) orbital $\\phi_a$:\n$$F^{\\text{GKS}}_{ia} = \\langle \\phi_i | \\hat{F}^{\\text{GKS}} | \\phi_a \\rangle = 0$$\nThis condition is the GKS analogue of Brillouin's theorem in Hartree-Fock theory. Brillouin's theorem states that the Hamiltonian matrix element between the Hartree-Fock ground state and any singly-excited determinant is zero, $\\langle \\Psi_0 | \\hat{H} | \\Psi_i^a \\rangle = 0$. By the Slater-Condon rules, this matrix element is proportional to $F_{ia}$, so Brillouin's theorem is equivalent to $F_{ia}=0$. The stationarity condition in GKS theory is thus often referred to as a generalized Brillouin's theorem. It is the fundamental constraint that is enforced iteratively in the SCF procedure to find the optimal set of orbitals that minimizes the energy.\n\nHence, the value that $F^{\\text{GKS}}_{ia}$ must take at self-consistency in the canonical orbital basis is zero.", "answer": "$$\n\\boxed{0}\n$$", "id": "2877898"}]}