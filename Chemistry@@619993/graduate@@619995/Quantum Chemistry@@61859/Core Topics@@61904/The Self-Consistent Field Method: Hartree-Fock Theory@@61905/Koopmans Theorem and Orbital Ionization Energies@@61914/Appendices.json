{"hands_on_practices": [{"introduction": "Koopmans' theorem offers a powerful link between orbital energies and ionization, but its simplest form can be incomplete, especially for open-shell systems. This practice delves into this complexity by using the fundamental Slater-Condon rules to analyze the ionization of an open-shell molecule [@problem_id:2901769]. By constructing the energies of the neutral species and the possible final cation states, you will derive from first principles how removing an electron from a single orbital can lead to multiple, distinct ionization energies corresponding to different spin multiplets, with an energy gap directly related to the exchange integral $K_{sp}$.", "problem": "Consider an open-shell neutral species described at the level of Hartree–Fock (HF) theory, with orthonormal spatial orbitals and spin functions. The electronic configuration consists of a singly occupied spatial orbital $s$ containing one $\\alpha$ electron and a doubly occupied spatial orbital $p$ containing one $\\alpha$ and one $\\beta$ electron. Assume a minimal active space comprised only of the spatial orbitals $s$ and $p$, and neglect orbital relaxation and electron correlation beyond the mean-field. Use Koopmans’ theorem and the Slater–Condon rules to analyze ionization by removing an $\\alpha$ or a $\\beta$ electron from the $p$ orbital.\n\nLet $h_{q}$ denote the one-electron core Hamiltonian expectation value in spatial orbital $q \\in \\{s,p\\}$, $J_{pq}$ the Coulomb integral between spatial orbitals $p$ and $q$, and $K_{pq}$ the exchange integral between spatial orbitals $p$ and $q$, with the conventional definitions $J_{pq}=(pp|qq)$ and $K_{pq}=(pq|qp)$. All spatial orbitals are orthonormal.\n\nUsing the Slater–Condon rules as the fundamental base (energy of a Slater determinant equals the sum of one-electron terms plus pairwise Coulomb terms minus exchange terms for like-spin pairs) together with Koopmans’ theorem (ionization energy equals the total energy difference $E_{\\text{ion}}-E_{\\text{neu}}$ evaluated without orbital relaxation), perform the following:\n\n- Construct the HF energy of the neutral state built from one $\\alpha$ electron in $s$ and a doubly occupied $p$ orbital.\n- Construct the diagonal Hamiltonian matrix elements for the two-electron cation states that arise after removing an electron from the $p$ orbital: one state with parallel spins in $s$ and $p$ and one state with antiparallel spins in $s$ and $p$. Identify the spin multiplicity of each.\n- Using these, write the Koopmans ionization energies to the two cation states, and thereby obtain the multiplet splitting $\\Delta_{\\mathrm{IE}}$ between the ionization energies that correspond to the two spin states reached by electron removal from $p$.\n\nProvide the final analytic expression for the multiplet splitting $\\Delta_{\\mathrm{IE}}$ in terms of the exchange integral $K_{sp}$ only. The final answer must be a single closed-form symbolic expression. Do not round. Express your final answer without units.", "solution": "The problem as stated is scientifically grounded, well-posed, and free from internal contradictions or ambiguities. It presents a standard, albeit non-trivial, exercise in open-shell quantum chemistry, based on the established principles of Hartree-Fock theory, Slater-Condon rules, and Koopmans' theorem under the frozen-orbital approximation. We may therefore proceed with the derivation.\n\nThe first step is to determine the energy of the neutral, open-shell species. The electronic configuration is given as one $\\alpha$ electron in spatial orbital $s$ and a doubly occupied spatial orbital $p$. This corresponds to a three-electron system described by the single Slater determinant $|\\Psi_{\\text{neu}}\\rangle = |s\\alpha, p\\alpha, p\\beta\\rangle$. The total spin projection is $M_S = \\frac{1}{2} + \\frac{1}{2} - \\frac{1}{2} = \\frac{1}{2}$, so this is a doublet state.\n\nThe energy of a state represented by a single Slater determinant is given by the Slater-Condon rules as the sum of one-electron energies for each occupied spin-orbital, plus the sum of two-electron Coulomb minus exchange integrals over all unique pairs of occupied spin-orbitals.\n$$ E = \\sum_{i} h_i + \\sum_{i<j} (J_{ij} - K_{ij}) $$\nwhere the sums run over the occupied spin-orbitals. For our neutral state, the spin-orbitals are $\\{s\\alpha, p\\alpha, p\\beta\\}$.\n\nThe one-electron part of the energy is:\n$$ E^{(1)}_{\\text{neu}} = \\langle s\\alpha | \\hat{h} | s\\alpha \\rangle + \\langle p\\alpha | \\hat{h} | p\\alpha \\rangle + \\langle p\\beta | \\hat{h} | p\\beta \\rangle = h_s + h_p + h_p = h_s + 2h_p $$\nThe two-electron part involves three pairs of spin-orbitals:\n1. Pair $(s\\alpha, p\\alpha)$: These spin-orbitals have parallel spins. The interaction energy is $J_{s\\alpha, p\\alpha} - K_{s\\alpha, p\\alpha}$. In terms of spatial orbitals, this is $J_{sp} - K_{sp}$.\n2. Pair $(s\\alpha, p\\beta)$: These spin-orbitals have antiparallel spins. The exchange term $K_{s\\alpha, p\\beta}$ is zero. The interaction energy is $J_{s\\alpha, p\\beta} = J_{sp}$.\n3. Pair $(p\\alpha, p\\beta)$: These spin-orbitals have antiparallel spins. The exchange term is zero. The interaction energy is $J_{p\\alpha, p\\beta} = J_{pp}$.\n\nThe total energy of the neutral state, $E_{\\text{neu}}$, is the sum of these terms:\n$$ E_{\\text{neu}} = (h_s + 2h_p) + (J_{sp} - K_{sp}) + J_{sp} + J_{pp} = h_s + 2h_p + 2J_{sp} + J_{pp} - K_{sp} $$\n\nNext, we consider the cation states formed by removing one electron from the $p$ orbital. The resulting two-electron configuration is $(s)^1(p)^1$. This configuration gives rise to two spin multiplets: a singlet ($S=0$) and a triplet ($S=1$).\n\nThe state with parallel spins in $s$ and $p$ corresponds to the triplet state. Its spin multiplicity is $2S+1 = 2(1)+1 = 3$. We can find its energy by considering the $M_S=1$ component, which is represented by the single Slater determinant $|\\Psi_{\\text{triplet}}\\rangle = |s\\alpha, p\\alpha\\rangle$.\nUsing the Slater-Condon rules for this two-electron state:\n$$ E_{\\text{triplet}} = h_s + h_p + (J_{s\\alpha, p\\alpha} - K_{s\\alpha, p\\alpha}) = h_s + h_p + J_{sp} - K_{sp} $$\n\nThe state with antiparallel spins in $s$ and $p$ corresponds to the singlet state. Its spin multiplicity is $2S+1 = 2(0)+1 = 1$. The singlet wavefunction with $M_S=0$ is a linear combination of two Slater determinants:\n$$ |\\Psi_{\\text{singlet}}\\rangle = \\frac{1}{\\sqrt{2}} \\left( |s\\alpha, p\\beta\\rangle - |s\\beta, p\\alpha\\rangle \\right) $$\nThe energy of this state is the expectation value $E_{\\text{singlet}} = \\langle\\Psi_{\\text{singlet}}|\\hat{H}|\\Psi_{\\text{singlet}}\\rangle$. This involves diagonal and off-diagonal matrix elements between the two determinants.\nThe diagonal elements are equal:\n$$ \\langle s\\alpha, p\\beta | \\hat{H} | s\\alpha, p\\beta \\rangle = h_s + h_p + J_{sp} $$\nThe off-diagonal element $\\langle s\\alpha, p\\beta | \\hat{H} | s\\beta, p\\alpha \\rangle$ between determinants differing by two spin-orbitals ($s\\alpha \\leftrightarrow s\\beta$, $p\\beta \\leftrightarrow p\\alpha$) is given by the two-electron operator only: it equals $-K_{sp}$.\nTherefore, the singlet energy is:\n$$ E_{\\text{singlet}} = \\frac{1}{2} \\left[ \\langle s\\alpha, p\\beta | \\hat{H} | s\\alpha, p\\beta \\rangle + \\langle s\\beta, p\\alpha | \\hat{H} | s\\beta, p\\alpha \\rangle - 2\\langle s\\alpha, p\\beta | \\hat{H} | s\\beta, p\\alpha \\rangle \\right] $$\n$$ E_{\\text{singlet}} = \\frac{1}{2} \\left[ (h_s + h_p + J_{sp}) + (h_s + h_p + J_{sp}) - 2(-K_{sp}) \\right] = h_s + h_p + J_{sp} + K_{sp} $$\n\nThe problem defines the Koopmans' ionization energy (IE) as the energy difference $E_{\\text{ion}} - E_{\\textneu}$, calculated using frozen orbitals. We compute the IEs to the two final multiplet states.\n\nThe ionization energy to the triplet cation state is:\n$$ IE_{\\to T} = E_{\\text{triplet}} - E_{\\text{neu}} = (h_s + h_p + J_{sp} - K_{sp}) - (h_s + 2h_p + 2J_{sp} + J_{pp} - K_{sp}) $$\n$$ IE_{\\to T} = -h_p - J_{sp} - J_{pp} $$\n\nThe ionization energy to the singlet cation state is:\n$$ IE_{\\to S} = E_{\\text{singlet}} - E_{\\text{neu}} = (h_s + h_p + J_{sp} + K_{sp}) - (h_s + 2h_p + 2J_{sp} + J_{pp} - K_{sp}) $$\n$$ IE_{\\to S} = -h_p - J_{sp} - J_{pp} + 2K_{sp} $$\n\nFinally, the multiplet splitting $\\Delta_{\\mathrm{IE}}$ is the difference between these two ionization energies. Since exchange integrals are positive definite ($K_{sp}>0$), the singlet state is higher in energy than the triplet state, and therefore $IE_{\\to S} > IE_{\\to T}$.\n$$ \\Delta_{\\mathrm{IE}} = IE_{\\to S} - IE_{\\to T} $$\n$$ \\Delta_{\\mathrm{IE}} = (-h_p - J_{sp} - J_{pp} + 2K_{sp}) - (-h_p - J_{sp} - J_{pp}) $$\n$$ \\Delta_{\\mathrm{IE}} = 2K_{sp} $$\nThe splitting in ionization energy between the two final multiplet states is thus found to be twice the exchange integral between the spatial orbitals $s$ and $p$.", "answer": "$$\n\\boxed{2K_{sp}}\n$$", "id": "2901769"}, {"introduction": "The previous exercise operated within the frozen-orbital approximation. We now challenge this assumption by exploring the impact of orbital relaxation—the adjustment of the remaining electrons to the newly formed positive charge. This practice introduces an elegant-yet-powerful model based on perturbation theory to quantify this effect [@problem_id:2901820]. You will derive the analytical form of the relaxation energy and discover that this correction is not only significant but can be so large for certain orbitals that it inverts the ionization ordering predicted by Koopmans' theorem, a crucial concept for correctly interpreting photoelectron spectra.", "problem": "Consider a closed-shell Hartree–Fock (HF) reference with two occupied spatial orbitals $\\phi_a$ and $\\phi_b$ having orbital energies $\\varepsilon_a$ and $\\varepsilon_b$, and a single relevant virtual orbital $\\phi_v$ with energy $\\varepsilon_v$. Assume the ordering $\\varepsilon_a < \\varepsilon_b < \\varepsilon_v$, with all energies measured relative to the vacuum level so that occupied orbital energies are negative. In the frozen-orbital approximation, Koopmans' theorem asserts that the vertical ionization energy associated with removing an electron from orbital $i \\in \\{a,b\\}$ is $I_i^{\\mathrm{K}} = -\\varepsilon_i$.\n\nTo model orbital relaxation in the cation, restrict the relaxation to a single mixing channel between the hole orbital $i$ and the virtual orbital $v$, driven by an effective one-electron operator $\\widehat{W}_i$ arising from the change in the mean field upon ionization. Let $\\kappa_i = \\langle \\phi_v | \\widehat{W}_i | \\phi_i \\rangle$ be the only nonzero off-diagonal coupling matrix element in the one-electron subspace $\\mathrm{span}\\{\\phi_i,\\phi_v\\}$ for the $(N-1)$-electron cation associated with removing an electron from $i$. Treat this mixing within nondegenerate Rayleigh–Schrödinger perturbation theory to second order in $\\kappa_i$, and neglect all other correlation effects.\n\n1. Starting from the above model and the definition of the Koopmans limit, derive the leading orbital-relaxation correction to the vertical ionization energies $I_i$ and write $I_i$ in terms of $\\varepsilon_i$, $\\varepsilon_v$, and $\\kappa_i$.\n2. Show that there exist parameter regimes in which the relaxed ionization sequence is reordered relative to the Koopmans sequence ordered by $\\{-\\varepsilon_i\\}$.\n3. Construct a minimal instance by setting $\\kappa_a = \\kappa > 0$ and $\\kappa_b = 0$, with $\\varepsilon_a  \\varepsilon_b  \\varepsilon_v$. Determine the exact analytic threshold coupling magnitude $\\kappa_{\\mathrm{crit}}$ in terms of $\\varepsilon_a$, $\\varepsilon_b$, and $\\varepsilon_v$ such that for $\\kappa > \\kappa_{\\mathrm{crit}}$ the relaxed ordering inverts, i.e., $I_a  I_b$ even though $-\\varepsilon_a > -\\varepsilon_b$ in the Koopmans limit.\n\nProvide your final result for $\\kappa_{\\mathrm{crit}}$ as a single closed-form analytic expression. No numerical rounding is required, and no units should be reported in the final boxed answer.", "solution": "The problem describes a coherent model for analyzing orbital relaxation, a key correction to Koopmans' theorem. The goal is to derive the condition under which this relaxation effect is strong enough to invert the ordering of ionization energies.\n\n**1. Derivation of the Relaxed Ionization Energy**\n\nKoopmans' theorem gives the zeroth-order ionization energy as $I_i^{\\mathrm{K}} = -\\varepsilon_i$. Orbital relaxation stabilizes the final cation state, lowering its energy. This means the energy required to create the ion, the ionization energy, is *decreased*. The relaxation energy, $R_i$, is a positive quantity that is subtracted from the Koopmans' estimate.\n\nThe model attributes this relaxation to a perturbation on the cation state. The second-order energy correction from perturbation theory to the cation's ground state (associated with a hole in orbital $\\phi_i$) is:\n$$ E_{\\text{relax}} = \\frac{|\\langle \\phi_v | \\widehat{W}_i | \\phi_i \\rangle|^2}{\\varepsilon_i - \\varepsilon_v} = \\frac{|\\kappa_i|^2}{\\varepsilon_i - \\varepsilon_v} $$\nSince $\\varepsilon_i  \\varepsilon_v$, this energy correction is negative, indicating stabilization of the cation. We can define the relaxation energy magnitude $R_i$ as a positive value:\n$$ R_i = -E_{\\text{relax}} = -\\frac{|\\kappa_i|^2}{\\varepsilon_i - \\varepsilon_v} = \\frac{|\\kappa_i|^2}{\\varepsilon_v - \\varepsilon_i} $$\nThe relaxed ionization energy $I_i$ is thus the Koopmans' estimate minus this positive relaxation energy:\n$$ I_i = I_i^{\\mathrm{K}} - R_i = -\\varepsilon_i - \\frac{|\\kappa_i|^2}{\\varepsilon_v - \\varepsilon_i} $$\nThis expression correctly shows that relaxation provides a negative correction to the ionization energy, as established in the main article.\n\n**2. Condition for Reordering**\n\nThe Koopmans' ordering is based on the orbital energies. Since $\\varepsilon_a  \\varepsilon_b$, the Koopmans' ionization energies are ordered as $I_a^{\\mathrm{K}} = -\\varepsilon_a > -\\varepsilon_b = I_b^{\\mathrm{K}}$.\n\nReordering occurs when the final relaxed energies invert this, i.e., $I_a  I_b$. For this to happen, the relaxation energy for the deeper orbital ($a$) must be significantly larger than for the shallower orbital ($b$), overcompensating for the initial energy gap. The condition is:\n$$ -\\varepsilon_a - R_a  -\\varepsilon_b - R_b $$\n$$ \\varepsilon_b - \\varepsilon_a  R_a - R_b $$\nSince $\\varepsilon_b - \\varepsilon_a$ is positive, this requires $R_a > R_b$. This is physically realistic, as deeper holes often induce larger relaxation effects. The problem asks to construct a minimal instance to demonstrate this.\n\n**3. Derivation of the Critical Coupling $\\kappa_{\\mathrm{crit}}$**\n\nWe use the specified parameters for a minimal case: significant relaxation for the deeper orbital $a$ ($\\kappa_a = \\kappa > 0$) and negligible relaxation for the shallower orbital $b$ ($\\kappa_b = 0$).\n\nThe relaxation energies are:\n$$ R_a = \\frac{\\kappa^2}{\\varepsilon_v - \\varepsilon_a} $$\n$$ R_b = 0 $$\nThe relaxed ionization energies are:\n$$ I_a = -\\varepsilon_a - \\frac{\\kappa^2}{\\varepsilon_v - \\varepsilon_a} $$\n$$ I_b = -\\varepsilon_b $$\nThe ordering inverts when $I_a  I_b$. The threshold for this inversion, $\\kappa_{\\mathrm{crit}}$, is found by setting the two energies equal, $I_a = I_b$:\n$$ -\\varepsilon_a - \\frac{\\kappa_{\\mathrm{crit}}^2}{\\varepsilon_v - \\varepsilon_a} = -\\varepsilon_b $$\nRearranging the equation to solve for $\\kappa_{\\mathrm{crit}}$:\n$$ \\varepsilon_b - \\varepsilon_a = \\frac{\\kappa_{\\mathrm{crit}}^2}{\\varepsilon_v - \\varepsilon_a} $$\nIsolating $\\kappa_{\\mathrm{crit}}^2$ gives:\n$$ \\kappa_{\\mathrm{crit}}^2 = (\\varepsilon_b - \\varepsilon_a)(\\varepsilon_v - \\varepsilon_a) $$\nSince we are given $\\varepsilon_a  \\varepsilon_b  \\varepsilon_v$, both terms on the right are positive, so a real solution for $\\kappa_{\\mathrm{crit}}$ exists. Taking the positive root (as coupling magnitude is positive):\n$$ \\kappa_{\\mathrm{crit}} = \\sqrt{(\\varepsilon_b - \\varepsilon_a)(\\varepsilon_v - \\varepsilon_a)} $$\nFor any coupling strength $\\kappa$ on orbital $a$ that is greater than this critical value, the relaxation will be strong enough to make its ionization energy lower than that of orbital $b$, inverting the order predicted by Koopmans' theorem. This completes the derivation.", "answer": "$$\n\\boxed{\\sqrt{(\\varepsilon_b - \\varepsilon_a)(\\varepsilon_v - \\varepsilon_a)}}\n$$", "id": "2901820"}, {"introduction": "Having explored multiplet effects and orbital relaxation, we can now assemble a complete picture that bridges the gap from a simple orbital energy to a highly accurate ionization energy. This final hands-on practice guides you through a computational protocol to systematically decompose a vertical ionization energy into its three core physical components: the initial Koopmans' estimate, the energy correction from orbital relaxation ($\\Delta_{\\mathrm{relax}}$), and the final correction from electron correlation ($\\Delta_{\\mathrm{corr}}$) [@problem_id:2901813]. By implementing this framework, you will gain a practical understanding of how modern quantum chemistry accounts for the different physical phenomena that govern the process of ionization.", "problem": "You are asked to formalize and implement a protocol, grounded in first principles, that cleanly separates orbital relaxation effects from electron correlation effects in vertical ionization energies by comparing three levels of description: a Koopmans estimate, a frozen-orbitals Delta Self-Consistent Field (ΔSCF) estimate, and a fully relaxed ΔSCF estimate, optionally augmented by correlation energies. Your task is to derive the required relationships from base definitions and then encode them in a program that produces numerical outputs for a specified test suite.\n\nThe fundamental base you must use is:\n- The definition of the vertical ionization energy as a difference of electronic total energies at fixed nuclear geometry: removing one electron from a neutral system to form its cation, without changing nuclear positions. No geometry relaxation is allowed.\n- The Hartree–Fock (HF) mean-field picture of independent electrons and canonical molecular orbitals, together with the statement of Koopmans’ theorem: the ionization energy equals the negative of the energy of the ionized occupied orbital when orbital relaxation and electron correlation are neglected.\n- The Delta Self-Consistent Field (ΔSCF) concept: the ionization energy at the mean-field level is computed as a total energy difference between the cation and the neutral at fixed nuclear geometry, either with orbitals kept fixed (no orbital relaxation) or with orbitals fully re-optimized for the ionized electron configuration (with orbital relaxation). Correlation is defined as the beyond-mean-field energy contribution added to the mean-field total energy, and the change in correlation energy upon ionization is the correlation contribution to the ionization energy.\n\nYour program must, for each test case, compute and return the following six quantities, all in electronvolts (eV):\n- The Koopmans estimate, denoted $I_{K}$.\n- The frozen-orbitals mean-field ΔSCF ionization energy, denoted $I_{\\mathrm{FO}}$, where “frozen-orbitals” means all orbitals remain as in the neutral (no self-consistent relaxation after electron removal).\n- The fully relaxed mean-field ΔSCF ionization energy, denoted $I_{\\mathrm{FR}}$.\n- The correlated ionization energy, denoted $I_{\\mathrm{corr}}$, obtained by adding the correlation energy change to the fully relaxed mean-field ΔSCF.\n- The signed relaxation contribution, $\\Delta_{\\mathrm{relax}}$, defined as $I_{\\mathrm{FR}} - I_{\\mathrm{FO}}$.\n- The correlation contribution, $\\Delta_{\\mathrm{corr}}$, defined as $I_{\\mathrm{corr}} - I_{\\mathrm{FR}}$.\n\nIn keeping with the base principles above, you must enforce the following constraints in your derivation and implementation:\n- The Koopmans estimate $I_{K}$ is computed from the neutral system’s canonical orbital energy $\\varepsilon_{i}$ (in Hartree) of the ionized occupied orbital as $I_{K} = -\\varepsilon_{i}$ converted from Hartree to electronvolts, with the Hartree-to-electronvolt conversion factor of $27.211386$ eV per Hartree.\n- In the Hartree–Fock mean-field picture with frozen orbitals, $I_{\\mathrm{FO}}$ coincides with $I_{K}$.\n- Orbital relaxation stabilizes the ionized state relative to the frozen-orbitals picture. With a nonnegative relaxation magnitude $R$ (in eV), the fully relaxed mean-field ΔSCF ionization energy satisfies $I_{\\mathrm{FR}} = I_{\\mathrm{FO}} - R$.\n- The correlation contribution to the ionization energy is the difference between the cation and neutral correlation energies, $\\Delta_{\\mathrm{corr}} = E_{\\mathrm{corr}}^{+} - E_{\\mathrm{corr}}^{0}$ (each in eV, typically negative), so that $I_{\\mathrm{corr}} = I_{\\mathrm{FR}} + \\Delta_{\\mathrm{corr}}$.\n\nInput specification for each test case:\n- The neutral’s ionized orbital energy $\\varepsilon_{i}$ in Hartree (a negative number).\n- A nonnegative relaxation magnitude $R$ in electronvolts (eV), defined as the reduction in ionization energy due to mean-field orbital relaxation at fixed geometry.\n- The neutral correlation energy $E_{\\mathrm{corr}}^{0}$ in electronvolts (eV).\n- The cation correlation energy $E_{\\mathrm{corr}}^{+}$ in electronvolts (eV).\n\nAngle units are not applicable. All physical quantities are energies and must be expressed in electronvolts (eV). You must output all six results for each test case in eV and round them to three decimal places.\n\nTest suite to be used by your program:\n- Case 1 (general happy path): $\\varepsilon_{i} = -0.350$ Hartree, $R = 1.000$ eV, $E_{\\mathrm{corr}}^{0} = -1.500$ eV, $E_{\\mathrm{corr}}^{+} = -1.200$ eV.\n- Case 2 (boundary: no relaxation): $\\varepsilon_{i} = -0.500$ Hartree, $R = 0.000$ eV, $E_{\\mathrm{corr}}^{0} = -0.800$ eV, $E_{\\mathrm{corr}}^{+} = -0.600$ eV.\n- Case 3 (edge: correlation decreases ionization energy): $\\varepsilon_{i} = -0.250$ Hartree, $R = 0.500$ eV, $E_{\\mathrm{corr}}^{0} = -1.000$ eV, $E_{\\mathrm{corr}}^{+} = -1.400$ eV.\n- Case 4 (edge: small Koopmans value with modest relaxation): $\\varepsilon_{i} = -0.200$ Hartree, $R = 0.300$ eV, $E_{\\mathrm{corr}}^{0} = -0.050$ eV, $E_{\\mathrm{corr}}^{+} = -0.020$ eV.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each test case contributes an inner list of six floats in the order $[I_{K}, I_{\\mathrmFO}, I_{\\mathrm{FR}}, I_{\\mathrm{corr}}, \\Delta_{\\mathrm{relax}}, \\Delta_{\\mathrm{corr}}]$, all rounded to three decimal places. For example: $[[\\dots],[\\dots],[\\dots],[\\dots]]$.", "solution": "The problem presented is a valid and well-posed exercise in quantum chemistry. It is scientifically grounded in Hartree-Fock theory and the many-body perturbation theory concepts of orbital relaxation and electron correlation. All necessary data and definitions are provided, the constraints are consistent, and the task is to apply a clear set of formal relationships. I will therefore proceed with the solution.\n\nThe problem requires the calculation of six quantities related to the vertical ionization energy of a chemical system, partitioning the total value into distinct physical contributions. The methodology rests upon a hierarchy of approximations, starting from the simplest (Koopmans' theorem) and progressively including more sophisticated physical effects (orbital relaxation and electron correlation). We are given the necessary parameters to compute these quantities for a series of test cases.\n\nLet us first formalize the relationships between the input parameters and the required output quantities based on the provided first principles. The conversion factor between Hartree and electron-volt units is given as $C = 27.211386 \\, \\text{eV}/\\text{Hartree}$. All final energy quantities must be expressed in electronvolts (eV).\n\nThe input for each case consists of four parameters:\n1.  The canonical Hartree-Fock orbital energy of the electron to be removed, $\\varepsilon_{i}$ [Hartree].\n2.  The magnitude of the ionization energy reduction due to orbital relaxation, $R$ [eV], where $R \\ge 0$.\n3.  The correlation energy of the neutral $N$-electron system, $E_{\\mathrm{corr}}^{0}$ [eV].\n4.  The correlation energy of the cationic $(N-1)$-electron system, $E_{\\mathrm{corr}}^{+}$ [eV].\n\nFrom these, we derive the six output quantities:\n\n1.  **Koopmans' Estimate ($I_{K}$):** Koopmans' theorem states that if we neglect the relaxation of the remaining $(N-1)$ electron orbitals upon ionization and also neglect the change in electron correlation energy, the ionization energy is simply the negative of the canonical orbital energy of the removed electron. This provides a first approximation.\n    $$I_{K} = -\\varepsilon_{i} \\times C$$\n\n2.  **Frozen-Orbitals $\\Delta$SCF Ionization Energy ($I_{\\mathrm{FO}}$):** The $\\Delta$SCF method computes the ionization energy as the difference in total self-consistent field (SCF) energies between the cation and the neutral system, $I = E_{\\mathrm{SCF}}^{+} - E_{\\mathrm{SCF}}^{0}$. A \"frozen-orbitals\" (FO) calculation implies that the orbitals used to compute the cation's energy are the same as those of the neutral ground state. In the context of Hartree-Fock theory, this procedure is mathematically equivalent to the statement of Koopmans' theorem. Thus, we have the identity:\n    $$I_{\\mathrm{FO}} = I_{K}$$\n\n3.  **Fully Relaxed $\\Delta$SCF Ionization Energy ($I_{\\mathrm{FR}}$):** A more accurate mean-field estimate is obtained by allowing the orbitals of the cation to relax, i.e., re-optimize in the presence of the new electronic configuration (one fewer electron). This electronic relaxation always stabilizes the cation, lowering its total energy relative to the frozen-orbitals description. Consequently, the ionization energy is reduced. The problem defines this reduction as the relaxation magnitude, $R$.\n    $$I_{\\mathrm{FR}} = I_{\\mathrm{FO}} - R$$\n\n4.  **Signed Relaxation Contribution ($\\Delta_{\\mathrm{relax}}$):** This quantity is defined as the change in ionization energy when moving from the frozen-orbital picture to the fully relaxed picture.\n    $$\\Delta_{\\mathrm{relax}} = I_{\\mathrm{FR}} - I_{\\mathrm{FO}}$$\n    By substituting the expression for $I_{\\mathrm{FR}}$ from the previous step, we obtain:\n    $$\\Delta_{\\mathrm{relax}} = (I_{\\mathrm{FO}} - R) - I_{\\mathrm{FO}} = -R$$\n    This shows that the relaxation contribution is the negative of the stabilization magnitude $R$, representing a decrease in the ionization energy.\n\n5.  **Correlation Contribution ($\\Delta_{\\mathrm{corr}}$):** Electron correlation energy is the correction to the Hartree-Fock mean-field energy, accounting for the instantaneous interactions between electrons that are averaged out in the SCF model. The total electronic energy is $E_{\\mathrm{total}} = E_{\\mathrm{HF}} + E_{\\mathrm{corr}}$. The contribution of correlation to the ionization energy is the change in correlation energy upon removing an electron.\n    $$\\Delta_{\\mathrm{corr}} = E_{\\mathrm{corr}}^{\\mathrm{cation}} - E_{\\mathrm{corr}}^{\\mathrm{neutral}} = E_{\\mathrm{corr}}^{+} - E_{\\mathrm{corr}}^{0}$$\n\n6.  **Correlated Ionization Energy ($I_{\\mathrm{corr}}$):** This is the most accurate estimate of the ionization energy within this framework. It is obtained by adding the correlation contribution to the fully relaxed mean-field ionization energy.\n    $$I_{\\mathrm{corr}} = I_{\\mathrm{FR}} + \\Delta_{\\mathrm{corr}}$$\n\nThese six equations provide a complete computational protocol. We will apply this protocol to each test case provided in the problem statement. The results will be numerically calculated and then rounded to three decimal places for the final output. The implementation will be a direct encoding of these derived formulas.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes and formats ionization energy contributions for a suite of test cases\n    based on a hierarchical quantum chemistry model.\n    \"\"\"\n    \n    # Define the constant for Hartree to eV conversion.\n    HARTREE_TO_EV = 27.211386\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (eps_i [Hartree], R [eV], E_corr^0 [eV], E_corr^+ [eV])\n    test_cases = [\n        (-0.350, 1.000, -1.500, -1.200),  # Case 1\n        (-0.500, 0.000, -0.800, -0.600),  # Case 2\n        (-0.250, 0.500, -1.000, -1.400),  # Case 3\n        (-0.200, 0.300, -0.050, -0.020),  # Case 4\n    ]\n\n    list_of_lists = []\n    \n    for case in test_cases:\n        eps_i, R, E_corr_0, E_corr_p = case\n\n        # 1. Koopmans' estimate (I_K)\n        # I_K = -eps_i (converted from Hartree to eV)\n        I_K = -eps_i * HARTREE_TO_EV\n\n        # 2. Frozen-orbitals Delta SCF ionization energy (I_FO)\n        # In the HF model, I_FO is identical to I_K.\n        I_FO = I_K\n\n        # 3. Fully relaxed Delta SCF ionization energy (I_FR)\n        # Orbital relaxation stabilizes the cation, reducing the IE by R.\n        I_FR = I_FO - R\n\n        # 4. Correlated ionization energy (I_corr)\n        # The change in correlation energy is added to the relaxed mean-field IE.\n        delta_corr = E_corr_p - E_corr_0\n        I_corr = I_FR + delta_corr\n\n        # 5. Signed relaxation contribution (Delta_relax)\n        # This is the change from FO to FR, which is -R.\n        delta_relax = -R\n\n        # 6. Correlation contribution (Delta_corr)\n        # This is the change in correlation energy upon ionization.\n        # This was already calculated for I_corr.\n\n        # The six quantities to report, in the specified order.\n        results = [I_K, I_FO, I_FR, I_corr, delta_relax, delta_corr]\n        list_of_lists.append(results)\n\n    # Format the final output string according to the problem specification.\n    # The output is a string representing a list of lists, with all numbers\n    # rounded to three decimal places. e.g., [[val1, val2, ...], [val1, val2, ...]]\n    formatted_cases = []\n    for case_results in list_of_lists:\n        # Format each number in the list to 3 decimal places\n        formatted_numbers = [f\"{num:.3f}\" for num in case_results]\n        # Join the numbers into a string like \"[num1,num2,...]\"\n        formatted_cases.append(f\"[{','.join(formatted_numbers)}]\")\n    \n    # Join all case strings into the final output format \"[case1,case2,...]\"\n    final_output = f\"[{','.join(formatted_cases)}]\"\n\n    # Final print statement in the exact required format.\n    print(final_output)\n\nsolve()\n```", "id": "2901813"}]}