{"hands_on_practices": [{"introduction": "The first step in connecting the quantum mechanical description of a molecule to its thermodynamic properties is to account for its vibrational ground-state energy. This exercise practices the fundamental calculation of the Zero-Point Vibrational Energy (ZPVE) from first principles, starting with the energy levels of a quantum harmonic oscillator. Mastering this conversion from spectroscopic wavenumbers to energy is an essential skill for applying any thermochemical correction to calculated electronic energies [@problem_id:2936574].", "problem": "A linear triatomic molecule has been characterized at its equilibrium geometry within the harmonic approximation. The computed harmonic vibrational wavenumbers (with any imaginary modes removed) are given as $2349\\ \\text{cm}^{-1}$, $1333\\ \\text{cm}^{-1}$, $667\\ \\text{cm}^{-1}$, and $667\\ \\text{cm}^{-1}$. Starting only from the quantum harmonic oscillator energy-level structure and the spectroscopic relation that connects energy to wavenumber, derive a formula to compute the zero-point vibrational energy (ZPVE) in terms of the given wavenumbers. Then evaluate the ZPVE numerically and express it in Hartree atomic units of energy (Hartree). Use the conversion factor $1\\ \\text{Hartree} = 219474.63137\\ \\text{cm}^{-1}$. Explicitly verify the unit consistency of your conversion. Round your final numerical answer to six significant figures and express the final energy in Hartree.", "solution": "The problem is validated as scientifically grounded, well-posed, and objective. It is based on fundamental principles of quantum mechanics and molecular spectroscopy and provides sufficient, consistent information for a unique solution.\n\nThe derivation of the zero-point vibrational energy (ZPVE) begins with the energy levels of a single quantum harmonic oscillator (QHO). For a vibrational normal mode with frequency $\\nu$, the allowed energy levels are given by the expression:\n$$ E_n = \\left(n + \\frac{1}{2}\\right)h\\nu $$\nwhere $h$ is the Planck constant and $n$ is the vibrational quantum number, which can take integer values $n = 0, 1, 2, \\dots$. The zero-point energy (ZPE) is the minimum possible energy for the oscillator, which corresponds to the ground vibrational state where $n=0$. Substituting $n=0$ into the energy level expression gives the ZPE for a single mode:\n$$ E_0 = \\left(0 + \\frac{1}{2}\\right)h\\nu = \\frac{1}{2}h\\nu $$\nA polyatomic molecule possesses multiple vibrational normal modes. Within the harmonic approximation, the total vibrational energy of the molecule is the sum of the energies of its independent normal modes. For a linear molecule with $N$ atoms, the number of vibrational modes is $3N-5$. The given problem concerns a linear triatomic molecule, for which $N=3$, yielding $3(3)-5=4$ vibrational modes. This is consistent with the four vibrational wavenumbers provided.\n\nThe total zero-point vibrational energy (ZPVE) of the molecule is the sum of the zero-point energies of all its $M=4$ vibrational modes:\n$$ \\text{ZPVE} = \\sum_{i=1}^{M} E_{0,i} = \\sum_{i=1}^{4} \\frac{1}{2}h\\nu_i = \\frac{1}{2}h \\sum_{i=1}^{4} \\nu_i $$\nThe problem provides the vibrational data in terms of wavenumbers, $\\tilde{\\nu}_i$, which are expressed in units of $\\text{cm}^{-1}$. The spectroscopic relation connecting energy $E$, frequency $\\nu$, and wavenumber $\\tilde{\\nu}$ is $E = h\\nu = hc\\tilde{\\nu}$, where $c$ is the speed of light. Using this relation, the ZPE for a single mode $i$ can be expressed in terms of its wavenumber:\n$$ E_{0,i} = \\frac{1}{2}hc\\tilde{\\nu}_i $$\nConsequently, the total ZPVE for the molecule is:\n$$ \\text{ZPVE} = \\sum_{i=1}^{4} \\frac{1}{2}hc\\tilde{\\nu}_i = \\frac{1}{2}hc \\sum_{i=1}^{4} \\tilde{\\nu}_i $$\nThe quantity $\\frac{1}{2} \\sum_{i=1}^{4} \\tilde{\\nu}_i$ represents the ZPVE expressed in units of wavenumber ($\\text{cm}^{-1}$). Let us compute this value using the given data: $\\tilde{\\nu}_1 = 2349\\ \\text{cm}^{-1}$, $\\tilde{\\nu}_2 = 1333\\ \\text{cm}^{-1}$, $\\tilde{\\nu}_3 = 667\\ \\text{cm}^{-1}$, and $\\tilde{\\nu}_4 = 667\\ \\text{cm}^{-1}$. The sum of the wavenumbers is:\n$$ \\sum_{i=1}^{4} \\tilde{\\nu}_i = 2349\\ \\text{cm}^{-1} + 1333\\ \\text{cm}^{-1} + 667\\ \\text{cm}^{-1} + 667\\ \\text{cm}^{-1} = 5016\\ \\text{cm}^{-1} $$\nThe ZPVE in units of wavenumber is then:\n$$ \\tilde{E}_{\\text{ZPVE}} = \\frac{1}{2} \\sum_{i=1}^{4} \\tilde{\\nu}_i = \\frac{1}{2} (5016\\ \\text{cm}^{-1}) = 2508\\ \\text{cm}^{-1} $$\nThe final step is to convert this energy from the unit of reciprocal centimeters ($\\text{cm}^{-1}$) to the atomic unit of energy, the Hartree ($E_h$). The problem provides the conversion factor: $1\\ E_h = 219474.63137\\ \\text{cm}^{-1}$.\n\nVerification of unit consistency is necessary. The relation $1\\ E_h = C\\ \\text{cm}^{-1}$ (where $C = 219474.63137$) means that an energy of one Hartree corresponds to a quantum with a wavenumber of $C$. To convert an energy $\\tilde{E}$ expressed in $\\text{cm}^{-1}$ to its equivalent value $E$ in Hartrees, one must divide by this conversion factor. The units are handled as follows:\n$$ E\\ [E_h] = \\frac{\\tilde{E}\\ [\\text{cm}^{-1}]}{C\\ [\\text{cm}^{-1}/E_h]} $$\nThis operation shows that the $\\text{cm}^{-1}$ units cancel, yielding a result in units of $E_h$, confirming the dimensional consistency of the conversion.\n\nWe now perform the numerical calculation:\n$$ \\text{ZPVE}\\ [E_h] = \\frac{2508}{219474.63137} \\approx 0.011427281\\ E_h $$\nThe problem requires the answer to be rounded to six significant figures. The first non-zero digit is the first significant figure. Therefore, we round the value to $0.0114273$.", "answer": "$$\\boxed{0.0114273}$$", "id": "2936574"}, {"introduction": "While ZPVE corrects the electronic energy to the absolute zero-temperature enthalpy, real-world chemistry occurs at finite temperatures, where entropy becomes a crucial factor. This practice extends the use of harmonic frequencies into the domain of statistical mechanics to compute the vibrational entropy, a key component of the Gibbs free energy. You will derive and apply the formula for the vibrational partition function, which is the bridge between the microscopic quantum states and macroscopic thermodynamic properties [@problem_id:2936575].", "problem": "A non-linear tetraatomic molecule has $3N-6=6$ harmonic vibrational normal modes. Treat each mode as an independent quantum harmonic oscillator with energy levels $E_{n,k} = h \\nu_k \\left(n + \\frac{1}{2}\\right)$ for mode $k$, where $\\nu_k$ is the frequency corresponding to the wavenumber $\\tilde{\\nu}_k$. The measured fundamental wavenumbers are:\n- $\\tilde{\\nu}_1 = 220\\,\\mathrm{cm^{-1}}$\n- $\\tilde{\\nu}_2 = 350\\,\\mathrm{cm^{-1}}$\n- $\\tilde{\\nu}_3 = 600\\,\\mathrm{cm^{-1}}$\n- $\\tilde{\\nu}_4 = 1020\\,\\mathrm{cm^{-1}}$\n- $\\tilde{\\nu}_5 = 1540\\,\\mathrm{cm^{-1}}$\n- $\\tilde{\\nu}_6 = 3120\\,\\mathrm{cm^{-1}}$\n\nAssume all modes are non-degenerate, separable, and harmonic. At temperature $T = 500\\,\\mathrm{K}$, do the following:\n\n1. Starting from the canonical partition function definition $q_{\\text{vib},k} = \\sum_{n=0}^{\\infty} \\exp\\!\\left(-\\beta E_{n,k}\\right)$ with $\\beta = 1/(k_B T)$ and the harmonic-oscillator energy spectrum, derive the single-mode vibrational partition function $q_{\\text{vib},k}$ by explicit summation of the geometric series. Assemble the total molecular vibrational partition function as $Q_{\\text{vib}} = \\prod_{k=1}^{6} q_{\\text{vib},k}$.\n2. From the canonical definitions, obtain the total vibrational entropy $S_{\\text{vib}}(T)$ for one mole of molecules in terms of $Q_{\\text{vib}}$ and mode frequencies. Evaluate $S_{\\text{vib}}$ numerically for the given set of wavenumbers at $T=500\\,\\mathrm{K}$.\n\nUse the following constants: $h = 6.62607015\\times 10^{-34}\\,\\mathrm{J\\cdot s}$, $c = 2.99792458\\times 10^{10}\\,\\mathrm{cm\\cdot s^{-1}}$, $k_B = 1.380649\\times 10^{-23}\\,\\mathrm{J\\cdot K^{-1}}$, $N_A = 6.02214076\\times 10^{23}\\,\\mathrm{mol^{-1}}$, and $R = N_A k_B = 8.314462618\\,\\mathrm{J\\cdot mol^{-1}\\cdot K^{-1}}$. You may also use $hc/k_B = 1.438776877\\,\\mathrm{K\\cdot cm}$.\n\nExpress the final entropy as a single number in $\\mathrm{J\\cdot mol^{-1}\\cdot K^{-1}}$, and round your answer to four significant figures.", "solution": "The problem requires the derivation of the molecular vibrational partition function and the subsequent calculation of the molar vibrational entropy for a non-linear tetraatomic molecule at a specified temperature, given its fundamental vibrational wavenumbers.\n\nFirst, we validate the problem. The givens are:\n- A non-linear tetraatomic molecule ($N=4$), having $3N-6=3(4)-6=6$ vibrational modes.\n- The six fundamental vibrational wavenumbers are $\\tilde{\\nu}_1 = 220\\,\\mathrm{cm^{-1}}$, $\\tilde{\\nu}_2 = 350\\,\\mathrm{cm^{-1}}$, $\\tilde{\\nu}_3 = 600\\,\\mathrm{cm^{-1}}$, $\\tilde{\\nu}_4 = 1020\\,\\mathrm{cm^{-1}}$, $\\tilde{\\nu}_5 = 1540\\,\\mathrm{cm^{-1}}$, and $\\tilde{\\nu}_6 = 3120\\,\\mathrm{cm^{-1}}$.\n- The temperature is $T = 500\\,\\mathrm{K}$.\n- The vibrational modes are treated as independent quantum harmonic oscillators.\n- The energy levels for mode $k$ are $E_{n,k} = h \\nu_k (n + 1/2)$, where $\\nu_k = c\\tilde{\\nu}_k$.\n- The required constants are provided: $h$, $c$, $k_B$, $N_A$, $R$, and the composite constant $hc/k_B$.\n\nThe problem is scientifically grounded, using the standard harmonic oscillator model from quantum mechanics and statistical mechanics. It is well-posed, providing all necessary information for a unique solution. The language is objective and precise. Therefore, the problem is valid, and we may proceed with the solution.\n\nPart 1: Derivation of the Vibrational Partition Function\n\nThe canonical partition function for a single vibrational mode $k$, treated as a quantum harmonic oscillator, is given by the sum over all its quantum states $n$:\n$$q_{\\text{vib},k} = \\sum_{n=0}^{\\infty} \\exp(-\\beta E_{n,k})$$\nwhere $\\beta = 1/(k_B T)$ and the energy levels are $E_{n,k} = hc\\tilde{\\nu}_k(n + 1/2)$. Substituting the energy expression into the partition function definition gives:\n$$q_{\\text{vib},k} = \\sum_{n=0}^{\\infty} \\exp\\left(-\\beta hc\\tilde{\\nu}_k \\left(n + \\frac{1}{2}\\right)\\right)$$\nWe can factor out the term corresponding to the zero-point energy ($n=0$), as it is independent of the summation index $n$:\n$$q_{\\text{vib},k} = \\exp\\left(-\\frac{\\beta hc\\tilde{\\nu}_k}{2}\\right) \\sum_{n=0}^{\\infty} \\exp(-n\\beta hc\\tilde{\\nu}_k)$$\nThe summation is a geometric series of the form $\\sum_{n=0}^{\\infty} x^n$, where $x = \\exp(-\\beta hc\\tilde{\\nu}_k)$. Since $\\beta$, $h$, $c$, and $\\tilde{\\nu}_k$ are all positive, we have $0 < x < 1$. The sum of such a series is $1/(1-x)$. Therefore, the summation evaluates to:\n$$\\sum_{n=0}^{\\infty} \\left[\\exp(-\\beta hc\\tilde{\\nu}_k)\\right]^n = \\frac{1}{1 - \\exp(-\\beta hc\\tilde{\\nu}_k)}$$\nSubstituting this result back, we obtain the expression for the single-mode vibrational partition function, measured from the bottom of the potential energy well:\n$$q_{\\text{vib},k} = \\frac{\\exp(-\\beta hc\\tilde{\\nu}_k / 2)}{1 - \\exp(-\\beta hc\\tilde{\\nu}_k)}$$\nSince the vibrational modes are assumed to be independent and separable, the total molecular vibrational partition function, $Q_{\\text{vib}}$, is the product of the individual partition functions for each of the $6$ modes:\n$$Q_{\\text{vib}} = \\prod_{k=1}^{6} q_{\\text{vib},k} = \\prod_{k=1}^{6} \\frac{\\exp(-\\beta hc\\tilde{\\nu}_k / 2)}{1 - \\exp(-\\beta hc\\tilde{\\nu}_k)}$$\n\nPart 2: Derivation and Calculation of Molar Vibrational Entropy\n\nThe molar vibrational entropy $S_{\\text{vib}}$ is related to the molecular partition function $Q_{\\text{vib}}$ by the fundamental relation from statistical mechanics, $S = (U - A)/T$, where $U$ is the internal energy and $A = -RT \\ln Q$ is the Helmholtz free energy. This leads to $S = U/T + R \\ln Q$.\n\nFor entropy calculations, it is conventional to measure energies from the ground vibrational state, not the bottom of the potential well. This simplifies the expressions, as entropy is independent of the absolute zero of energy. Let's define a new partition function, $q'_{\\text{vib},k}$, where energies are measured relative to the ground state energy $\\frac{1}{2}h\\nu_k$:\n$$ q'_{\\text{vib},k} = \\sum_{n=0}^{\\infty} \\exp(-\\beta (E_{n,k} - E_{0,k})) = \\sum_{n=0}^{\\infty} \\exp(-\\beta n h\\nu_k) = \\frac{1}{1 - \\exp(-\\beta h\\nu_k)} $$\nThe total partition function is $Q'_{\\text{vib}} = \\prod_k q'_{\\text{vib},k}$. The molar internal energy relative to the ZPE is $U_{\\text{vib,th}} = RT^2 \\frac{d \\ln Q'_{\\text{vib}}}{dT}$. The molar Helmholtz free energy is $A_{\\text{vib}} = -RT \\ln Q'_{\\text{vib}}$. The molar entropy is then $S_{\\text{vib}} = (U_{\\text{vib,th}} - A_{\\text{vib}})/T$:\n$$ S_{\\text{vib}} = \\frac{U_{\\text{vib,th}}}{T} + R \\ln Q'_{\\text{vib}} $$\nSince $\\ln Q'_{\\text{vib}} = \\sum_k \\ln q'_{\\text{vib},k}$, the entropy is a sum of contributions from each mode, $S_{\\text{vib}} = \\sum_k S_{\\text{vib},k}$. Using $U_{\\text{vib,th},k} = -N_A \\frac{\\partial \\ln q'_{\\text{vib},k}}{\\partial \\beta}$, we find:\n$$ U_{\\text{vib,th},k} = N_A \\frac{hc\\tilde{\\nu}_k}{\\exp(\\beta hc\\tilde{\\nu}_k) - 1} $$\nSubstituting into the entropy formula for one mode:\n$$ S_{\\text{vib},k} = \\frac{U_{\\text{vib,th},k}}{T} + R \\ln q'_{\\text{vib},k} = \\frac{N_A}{T} \\frac{hc\\tilde{\\nu}_k}{\\exp(\\beta hc\\tilde{\\nu}_k) - 1} - R \\ln(1 - \\exp(-\\beta hc\\tilde{\\nu}_k)) $$\nUsing $R=N_A k_B$ and $\\beta = 1/(k_B T)$, the first term becomes $R \\frac{\\beta hc\\tilde{\\nu}_k}{\\exp(\\beta hc\\tilde{\\nu}_k) - 1}$. The total molar vibrational entropy is the sum over all modes:\n$$S_{\\text{vib}} = R \\sum_{k=1}^{6} \\left[ \\frac{\\beta hc\\tilde{\\nu}_k}{\\exp(\\beta hc\\tilde{\\nu}_k) - 1} - \\ln(1 - \\exp(-\\beta hc\\tilde{\\nu}_k)) \\right]$$\nTo perform the numerical calculation, we define a dimensionless variable $x_k = \\beta hc\\tilde{\\nu}_k = \\frac{hc\\tilde{\\nu}_k}{k_B T}$. The expression becomes:\n$$S_{\\text{vib}} = R \\sum_{k=1}^{6} \\left[ \\frac{x_k}{\\exp(x_k) - 1} - \\ln(1 - \\exp(-x_k)) \\right]$$\nWe use the given constants $T = 500\\,\\mathrm{K}$ and $\\frac{hc}{k_B} = 1.438776877\\,\\mathrm{K\\cdot cm}$.\nFirst, calculate $x_k = \\tilde{\\nu}_k \\times \\frac{hc}{k_B T} = \\tilde{\\nu}_k \\times \\frac{1.438776877\\,\\mathrm{K\\cdot cm}}{500\\,\\mathrm{K}} = \\tilde{\\nu}_k \\times 0.002877553754\\,\\mathrm{cm}$.\nThe values of $x_k$ for each mode are:\n- $x_1 = 220 \\times 0.002877... = 0.63306$\n- $x_2 = 350 \\times 0.002877... = 1.00714$\n- $x_3 = 600 \\times 0.002877... = 1.72653$\n- $x_4 = 1020 \\times 0.002877... = 2.93510$\n- $x_5 = 1540 \\times 0.002877... = 4.43143$\n- $x_6 = 3120 \\times 0.002877... = 8.97801$\n\nNow, we calculate the entropy contribution for each mode, $S_{\\text{vib}, k}/R$:\n- $S_1/R = \\frac{0.63306}{\\exp(0.63306) - 1} - \\ln(1 - \\exp(-0.63306)) = 0.71663 + 0.75702 = 1.47365$\n- $S_2/R = \\frac{1.00714}{\\exp(1.00714) - 1} - \\ln(1 - \\exp(-1.00714)) = 0.57952 + 0.45453 = 1.03405$\n- $S_3/R = \\frac{1.72653}{\\exp(1.72653) - 1} - \\ln(1 - \\exp(-1.72653)) = 0.37359 + 0.19595 = 0.56954$\n- $S_4/R = \\frac{2.93510}{\\exp(2.93510) - 1} - \\ln(1 - \\exp(-2.93510)) = 0.16469 + 0.05459 = 0.21928$\n- $S_5/R = \\frac{4.43143}{\\exp(4.43143) - 1} - \\ln(1 - \\exp(-4.43143)) = 0.05336 + 0.01202 = 0.06538$\n- $S_6/R = \\frac{8.97801}{\\exp(8.97801) - 1} - \\ln(1 - \\exp(-8.97801)) = 0.00113 + 0.00013 = 0.00126$\n\nThe total dimensionless entropy is the sum of these contributions:\n$$\\frac{S_{\\text{vib}}}{R} = \\sum_{k=1}^{6} \\frac{S_k}{R} = 1.47365 + 1.03405 + 0.56954 + 0.21928 + 0.06538 + 0.00126 = 3.36316$$\nFinally, we multiply by the molar gas constant $R = 8.314462618\\,\\mathrm{J\\cdot mol^{-1}\\cdot K^{-1}}$:\n$$S_{\\text{vib}} = 3.36316 \\times 8.314462618\\,\\mathrm{J\\cdot mol^{-1}\\cdot K^{-1}} = 27.9566\\,\\mathrm{J\\cdot mol^{-1}\\cdot K^{-1}}$$\nRounding the final answer to four significant figures as requested gives $27.96\\,\\mathrm{J\\cdot mol^{-1}\\cdot K^{-1}}$.", "answer": "$$\\boxed{27.96}$$", "id": "2936575"}, {"introduction": "The Rigid-Rotor Harmonic-Oscillator (RRHO) model, while powerful, has known limitations, especially for low-frequency torsions where the harmonic approximation fails. This advanced, hands-on practice challenges you to address this shortcoming by implementing a more accurate hindered-rotor model from scratch. By fitting a potential and numerically calculating the partition function, you will gain a profound understanding of how to move beyond standard approximations to achieve higher accuracy in computational thermochemistry [@problem_id:2936576].", "problem": "You are given discrete scans of a one-dimensional torsional potential energy surface as pairs of angles and energies. Your task is to write a complete program that, for each scan, fits a truncated Fourier series to the periodic potential, computes the torsional free energy using a semiclassical hindered-rotor model, computes the harmonic-oscillator free energy from the local curvature at the global minimum of the fitted potential, and returns the thermochemical correction defined as the difference in Gibbs free energies $\\Delta G^\\circ(T) = G^\\circ_{\\mathrm{HR}}(T) - G^\\circ_{\\mathrm{HO}}(T)$ for each test case. All free energies must be reported per mole in $\\mathrm{kJ/mol}$, rounded to six decimal places.\n\nFundamental starting points you may invoke in your derivation and algorithm design are limited to the canonical partition function definition of statistical mechanics, the quantized harmonic oscillator energy spectrum and partition function, and the classical limit for a one-dimensional hindered rotor obtained by integrating over angular momentum and angle with the appropriate phase space normalization and symmetry number. You must derive any working formula you use from these bases. You must justify how you obtain the local torsional angular frequency from the fitted potential by connecting the curvature at the minimum to the equation of motion for small oscillations of a rotor with a given moment of inertia. No other shortcut formulas are permitted in your derivation.\n\nInput data and units:\n- Each test case provides:\n  - A list of angles in degrees, $\\{\\phi_i\\}_{i=1}^{N}$, covering one full period $[0^\\circ,360^\\circ)$.\n  - A corresponding list of energies in $\\mathrm{kJ/mol}$, $\\{E_i\\}_{i=1}^{N}$, at those angles.\n  - A symmetry number $\\sigma$ (dimensionless integer) indicating indistinguishability of equivalent minima.\n  - A scalar moment of inertia $I$ in $\\mathrm{kg \\cdot m^2}$ for the torsional motion.\n  - A temperature $T$ in $\\mathrm{K}$.\n  - A positive integer $M$ for the highest Fourier order to include in the fit.\n- Your program must convert angles to radians for all trigonometric use.\n- Your program must convert energies from $\\mathrm{kJ/mol}$ to $\\mathrm{J}$ per molecule where appropriate using Avogadro’s constant.\n\nModeling requirements:\n- Fit a truncated Fourier series of the form $V(\\phi) \\approx c_0 + \\sum_{n=1}^{M} \\left[a_n \\cos(n \\phi) + b_n \\sin(n \\phi)\\right]$ by linear least squares to the provided $(\\phi_i,E_i)$ data (with $\\phi_i$ in radians). The fit must include the constant term. All coefficients must be determined from the data, not assumed.\n- Identify the global minimum $\\phi_0 \\in [0,2\\pi)$ of the fitted $V(\\phi)$ numerically, and shift the potential such that $V(\\phi_0)=0$ for all subsequent thermodynamic calculations.\n- Obtain the torsional angular frequency $\\omega$ for the harmonic-oscillator model from the second derivative of the fitted potential at $\\phi_0$ and the provided $I$ via the small-oscillation relation.\n- Compute the harmonic-oscillator contribution to the free energy for this torsion from first principles of a quantized harmonic oscillator at temperature $T$.\n- Compute the hindered-rotor free energy by evaluating the classical one-dimensional hindered-rotor partition function that follows from the canonical phase-space integral with symmetry number $\\sigma$. The configurational integral $\\int_0^{2\\pi} \\exp[-\\beta V(\\phi)] \\, d\\phi$ must be obtained numerically with sufficient accuracy; angles $\\phi$ must be in radians. Your program must ensure consistent energy units throughout.\n- The desired thermochemical correction is $\\Delta G^\\circ(T) = G^\\circ_{\\mathrm{HR}}(T) - G^\\circ_{\\mathrm{HO}}(T)$.\n\nPhysical constants:\n- Use Boltzmann constant $k_{\\mathrm{B}}$ in $\\mathrm{J/K}$, Planck constant $h$ in $\\mathrm{J \\cdot s}$, reduced Planck constant $\\hbar = h/(2\\pi)$, and Avogadro constant $N_{\\mathrm{A}}$ in $\\mathrm{mol^{-1}}$.\n- All results must be reported in $\\mathrm{kJ/mol}$.\n\nNumerical requirements:\n- The numerical integral over $\\phi$ must be accurate to better than $10^{-8}$ relative error for smooth potentials; you may use any robust quadrature or a sufficiently fine composite rule to ensure this.\n- The Fourier fit must be numerically stable; use standard linear least squares.\n\nAngle units:\n- All angles provided in degrees must be converted to radians before any trigonometric or integral computation. All integrations over angle must be carried out in radians.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, with each entry being the value of $\\Delta G^\\circ(T)$ in $\\mathrm{kJ/mol}$ for one test case, rounded to six decimal places, in the same order as the test suite below. For example: $[x_1,x_2,x_3]$.\n\nTest suite:\n- Test case $1$ (moderate three-fold barrier):\n  - Angles in degrees: $[0,30,60,90,120,150,180,210,240,270,300,330]$.\n  - Energies in $\\mathrm{kJ/mol}$: $[0.0,6.2,12.0,6.2,0.0,6.2,12.0,6.2,0.0,6.2,12.0,6.2]$.\n  - Symmetry number: $\\sigma = 3$.\n  - Moment of inertia: $I = 6.0\\times 10^{-47}\\ \\mathrm{kg \\cdot m^2}$.\n  - Temperature: $T = 298.15\\ \\mathrm{K}$.\n  - Fourier order: $M = 6$.\n- Test case $2$ (nearly free three-fold rotor at higher temperature):\n  - Angles in degrees: $[0,30,60,90,120,150,180,210,240,270,300,330]$.\n  - Energies in $\\mathrm{kJ/mol}$: $[0.0,0.30,0.50,0.30,0.0,0.30,0.50,0.30,0.0,0.30,0.50,0.30]$.\n  - Symmetry number: $\\sigma = 3$.\n  - Moment of inertia: $I = 1.5\\times 10^{-46}\\ \\mathrm{kg \\cdot m^2}$.\n  - Temperature: $T = 600.0\\ \\mathrm{K}$.\n  - Fourier order: $M = 6$.\n- Test case $3$ (high two-fold barrier at lower temperature):\n  - Angles in degrees: $[0,30,60,90,120,150,180,210,240,270,300,330]$.\n  - Energies in $\\mathrm{kJ/mol}$: $[0.0,5.0,15.0,20.0,15.0,5.0,0.0,5.0,15.0,20.0,15.0,5.0]$.\n  - Symmetry number: $\\sigma = 1$.\n  - Moment of inertia: $I = 3.0\\times 10^{-47}\\ \\mathrm{kg \\cdot m^2}$.\n  - Temperature: $T = 200.0\\ \\mathrm{K}$.\n  - Fourier order: $M = 4$.\n\nYour program must implement the full pipeline end-to-end and produce the single-line output described above. No user input should be read; the test suite is fixed as given here. All outputs must be expressed in $\\mathrm{kJ/mol}$, rounded to six decimal places, and ordered as $[\\Delta G^\\circ_1,\\Delta G^\\circ_2,\\Delta G^\\circ_3]$.", "solution": "The problem statement has been critically evaluated and is determined to be valid. It is scientifically grounded in the principles of statistical mechanics and quantum chemistry, well-posed, and provides all necessary information to derive a unique and meaningful solution. The methodology prescribed—fitting a potential, deriving thermodynamic properties from first principles via harmonic oscillator and hindered rotor models—is a standard and sound procedure in computational chemistry. We proceed with the solution.\n\nThe objective is to compute the thermochemical correction $\\Delta G^\\circ(T) = G^\\circ_{\\mathrm{HR}}(T) - G^\\circ_{\\mathrm{HO}}(T)$, where $G^\\circ_{\\mathrm{HR}}(T)$ is the Gibbs free energy from a semiclassical hindered-rotor model and $G^\\circ_{\\mathrm{HO}}(T)$ is the Gibbs free energy from a quantum harmonic-oscillator model. This requires a multi-step derivation and calculation.\n\n**1. Potential Energy Surface Fitting**\n\nThe discrete potential energy data, given as pairs $(\\phi_i, E_i)$, must first be represented by a continuous function $V(\\phi)$. The problem specifies a truncated Fourier series of order $M$:\n$$ V_{fit}(\\phi) = c_0 + \\sum_{n=1}^{M} \\left[ a_n \\cos(n\\phi) + b_n \\sin(n\\phi) \\right] $$\nThis is a linear model where the coefficients $\\{c_0, a_n, b_n\\}_{n=1}^M$ are unknowns. We determine them by minimizing the sum of squared residuals, $S = \\sum_{i=1}^{N} [V_{fit}(\\phi_i) - E_i]^2$, where $N$ is the number of data points. This is a linear least-squares problem. We construct a design matrix $\\mathbf{X}$ of size $N \\times (2M+1)$ and a vector of observed energies $\\mathbf{E}$. The elements of the design matrix for the $i$-th data point with angle $\\phi_i$ are:\n$$ X_{i,0} = 1 $$\n$$ X_{i, 2n-1} = \\cos(n\\phi_i), \\quad n=1, ..., M $$\n$$ X_{i, 2n} = \\sin(n\\phi_i), \\quad n=1, ..., M $$\nThe vector of coefficients $\\mathbf{c} = [c_0, a_1, b_1, \\ldots, a_M, b_M]^T$ is found by solving the normal equations $\\mathbf{X}^T \\mathbf{X} \\mathbf{c} = \\mathbf{X}^T \\mathbf{E}$. During computation, we convert input angles from degrees to radians and input energies from $\\mathrm{kJ/mol}$ to Joules per molecule using Avogadro's constant, $N_A$.\n\nAfter obtaining the coefficients, we have a continuous potential function $V_{fit}(\\phi)$. We must then find its global minimum $\\phi_0$ on the interval $[0, 2\\pi)$ via numerical optimization. For all subsequent thermodynamic calculations, the potential is shifted so that its minimum is zero: $V'(\\phi) = V_{fit}(\\phi) - V_{fit}(\\phi_0)$.\n\n**2. Harmonic Oscillator (HO) Model**\n\nThe HO model approximates the potential near the minimum $\\phi_0$ with a quadratic function, which is the second-order Taylor expansion of $V'(\\phi)$ around $\\phi_0$:\n$$ V_{HO}(\\phi) \\approx \\frac{1}{2} k_{tor} (\\phi - \\phi_0)^2 $$\nHere, $k_{tor}$ is the torsional force constant, given by the second derivative of the potential at the minimum:\n$$ k_{tor} = \\frac{d^2 V'}{d\\phi^2}\\bigg|_{\\phi=\\phi_0} = \\frac{d^2 V_{fit}}{d\\phi^2}\\bigg|_{\\phi=\\phi_0} $$\nThe second derivative of the fitted potential is:\n$$ \\frac{d^2 V_{fit}}{d\\phi^2} = -\\sum_{n=1}^{M} n^2 \\left[ a_n \\cos(n\\phi) + b_n \\sin(n\\phi) \\right] $$\nThe classical equation of motion for a rotor of moment of inertia $I$ under a restoring torque $\\tau = -k_{tor}(\\phi - \\phi_0)$ is $I \\ddot{\\phi} = -k_{tor}(\\phi - \\phi_0)$. This is the equation of a simple harmonic oscillator with angular frequency $\\omega$:\n$$ \\omega = \\sqrt{\\frac{k_{tor}}{I}} = \\sqrt{\\frac{1}{I} \\frac{d^2 V_{fit}}{d\\phi^2}\\bigg|_{\\phi=\\phi_0}} $$\nThe potential and its derivatives must be in SI units (Joules) for this calculation.\nThe energy levels of a quantum harmonic oscillator are quantized:\n$$ E_n = \\left(n + \\frac{1}{2}\\right) \\hbar \\omega, \\quad n = 0, 1, 2, \\ldots $$\nwhere $\\hbar$ is the reduced Planck constant. The molecular partition function $q_{\\mathrm{HO}}$ is the sum over all states:\n$$ q_{\\mathrm{HO}} = \\sum_{n=0}^{\\infty} e^{-\\beta E_n} = \\sum_{n=0}^{\\infty} e^{-\\beta (n + 1/2) \\hbar \\omega} = e^{-\\beta \\hbar \\omega / 2} \\sum_{n=0}^{\\infty} (e^{-\\beta \\hbar \\omega})^n $$\nwhere $\\beta = 1/(k_B T)$, $k_B$ is the Boltzmann constant, and $T$ is the temperature. The geometric series sums to $1/(1 - e^{-\\beta \\hbar \\omega})$, so:\n$$ q_{\\mathrm{HO}} = \\frac{e^{-\\beta \\hbar \\omega / 2}}{1 - e^{-\\beta \\hbar \\omega}} $$\nThis partition function is computed relative to the minimum of the potential well. The contribution of this mode to the molar Gibbs free energy is given by $G^\\circ = -RT \\ln q = -N_A k_B T \\ln q$.\n$$ G^\\circ_{\\mathrm{HO}}(T) = -N_A k_B T \\ln\\left(\\frac{e^{-\\beta \\hbar \\omega / 2}}{1 - e^{-\\beta \\hbar \\omega}}\\right) = N_A k_B T \\left(\\frac{\\beta \\hbar \\omega}{2} - \\ln(1 - (e^{-\\beta \\hbar \\omega})^{-1}) \\right) $$\nA more transparent form is:\n$$ G^\\circ_{\\mathrm{HO}}(T) = N_A \\left( \\frac{1}{2}\\hbar\\omega + k_B T \\ln(1 - e^{-\\beta\\hbar\\omega}) \\right) $$\n\n**3. Hindered Rotor (HR) Model**\n\nThe problem specifies the classical limit for the one-dimensional hindered rotor. The partition function is derived from the phase-space integral. For a system with Hamiltonian $H(p_\\phi, \\phi) = p_\\phi^2/(2I) + V'(\\phi)$, where $p_\\phi$ is the angular momentum, the partition function is:\n$$ q_{\\mathrm{HR}} = \\frac{1}{\\sigma h} \\int_{-\\infty}^{\\infty} dp_\\phi \\int_{0}^{2\\pi} d\\phi \\, \\exp\\left[-\\beta H(p_\\phi, \\phi)\\right] $$\nHere, $h$ is the Planck constant and $\\sigma$ is the symmetry number. The integrals over momentum and angle are separable:\n$$ q_{\\mathrm{HR}} = \\frac{1}{\\sigma h} \\left( \\int_{-\\infty}^{\\infty} e^{-\\beta p_\\phi^2 / (2I)} dp_\\phi \\right) \\left( \\int_{0}^{2\\pi} e^{-\\beta V'(\\phi)} d\\phi \\right) $$\nThe momentum integral is a Gaussian integral, $\\int_{-\\infty}^{\\infty} e^{-ax^2}dx = \\sqrt{\\pi/a}$, with $a = \\beta/(2I)$.\n$$ \\int_{-\\infty}^{\\infty} e^{-\\beta p_\\phi^2 / (2I)} dp_\\phi = \\sqrt{\\frac{2\\pi I}{\\beta}} = \\sqrt{2\\pi I k_B T} $$\nSubstituting this back, we obtain the partition function for the hindered rotor:\n$$ q_{\\mathrm{HR}} = \\frac{\\sqrt{2\\pi I k_B T}}{\\sigma h} \\int_{0}^{2\\pi} e^{-\\beta V'(\\phi)} d\\phi $$\nThe remaining configurational integral must be evaluated numerically using the fitted and shifted potential $V'(\\phi)$. The contribution to the molar Gibbs free energy is:\n$$ G^\\circ_{\\mathrm{HR}}(T) = -N_A k_B T \\ln(q_{\\mathrm{HR}}) $$\n\n**4. Thermochemical Correction $\\Delta G^\\circ(T)$**\n\nThe final desired quantity is the difference between the two models:\n$$ \\Delta G^\\circ(T) = G^\\circ_{\\mathrm{HR}}(T) - G^\\circ_{\\mathrm{HO}}(T) = -N_A k_B T \\ln(q_{\\mathrm{HR}}) - [-N_A k_B T \\ln(q_{\\mathrm{HO}})] $$\n$$ \\Delta G^\\circ(T) = -N_A k_B T \\ln\\left(\\frac{q_{\\mathrm{HR}}}{q_{\\mathrm{HO}}}\\right) $$\nSubstituting the expressions for the partition functions:\n$$ \\Delta G^\\circ(T) = -N_A k_B T \\ln\\left[ \\frac{\\sqrt{2\\pi I k_B T}}{\\sigma h} \\left( \\frac{1 - e^{-\\beta \\hbar \\omega}}{e^{-\\beta \\hbar \\omega / 2}} \\right) \\int_{0}^{2\\pi} e^{-\\beta V'(\\phi)} d\\phi \\right] $$\nThis expression will be computed for each test case. All intermediate calculations are performed in SI units (J, kg, m, s, K, mol), and the final result $\\Delta G^\\circ(T)$ is converted from $\\mathrm{J/mol}$ to $\\mathrm{kJ/mol}$.\n\nThe computational implementation will follow these derived steps: data conversion, least-squares fitting, numerical minimization, evaluation of derivatives, numerical integration, and final assembly of the thermodynamic quantities.", "answer": "```python\nimport numpy as np\nfrom scipy import constants\nfrom scipy.optimize import minimize_scalar\nfrom scipy.integrate import quad\n\ndef solve():\n    \"\"\"\n    Main function to compute the thermochemical correction for hindered rotors.\n    \"\"\"\n    # Physical constants (CODATA 2018)\n    k_B = constants.Boltzmann  # J/K\n    N_A = constants.Avogadro   # mol^-1\n    h = constants.h            # J*s\n    hbar = constants.hbar      # J*s\n    R = k_B * N_A              # J/(mol*K)\n\n    # Test suite from the problem statement\n    test_cases = [\n        {\n            \"angles_deg\": np.array([0, 30, 60, 90, 120, 150, 180, 210, 240, 270, 300, 330]),\n            \"energies_kJ_mol\": np.array([0.0, 6.2, 12.0, 6.2, 0.0, 6.2, 12.0, 6.2, 0.0, 6.2, 12.0, 6.2]),\n            \"sigma\": 3,\n            \"I\": 6.0e-47,  # kg*m^2\n            \"T\": 298.15,   # K\n            \"M\": 6,\n        },\n        {\n            \"angles_deg\": np.array([0, 30, 60, 90, 120, 150, 180, 210, 240, 270, 300, 330]),\n            \"energies_kJ_mol\": np.array([0.0, 0.30, 0.50, 0.30, 0.0, 0.30, 0.50, 0.30, 0.0, 0.30, 0.50, 0.30]),\n            \"sigma\": 3,\n            \"I\": 1.5e-46,\n            \"T\": 600.0,\n            \"M\": 6,\n        },\n        {\n            \"angles_deg\": np.array([0, 30, 60, 90, 120, 150, 180, 210, 240, 270, 300, 330]),\n            \"energies_kJ_mol\": np.array([0.0, 5.0, 15.0, 20.0, 15.0, 5.0, 0.0, 5.0, 15.0, 20.0, 15.0, 5.0]),\n            \"sigma\": 1,\n            \"I\": 3.0e-47,\n            \"T\": 200.0,\n            \"M\": 4,\n        },\n    ]\n\n    results = []\n\n    for case in test_cases:\n        # Step 1: Data preparation and unit conversion\n        angles_rad = np.deg2rad(case[\"angles_deg\"])\n        energies_J = case[\"energies_kJ_mol\"] * 1000.0 / N_A\n        M = case[\"M\"]\n        I = case[\"I\"]\n        T = case[\"T\"]\n        sigma = case[\"sigma\"]\n\n        # Step 2: Fourier series fit\n        # V(phi) = c0 + sum_{n=1 to M} [a_n*cos(n*phi) + b_n*sin(n*phi)]\n        num_points = len(angles_rad)\n        num_coeffs = 2 * M + 1\n        X = np.zeros((num_points, num_coeffs))\n        X[:, 0] = 1.0  # c0 term\n        for n in range(1, M + 1):\n            X[:, 2 * n - 1] = np.cos(n * angles_rad)\n            X[:, 2 * n] = np.sin(n * angles_rad)\n        \n        coeffs, _, _, _ = np.linalg.lstsq(X, energies_J, rcond=None)\n\n        def v_fit(phi):\n            val = coeffs[0]\n            for n in range(1, M + 1):\n                val += coeffs[2 * n - 1] * np.cos(n * phi)\n                val += coeffs[2 * n] * np.sin(n * phi)\n            return val\n\n        def v_fit_d2(phi):\n            val = 0.0\n            for n in range(1, M + 1):\n                n_sq = n * n\n                val -= n_sq * (coeffs[2 * n - 1] * np.cos(n * phi) +\n                               coeffs[2 * n] * np.sin(n * phi))\n            return val\n\n        # Step 3: Find potential minimum and shift potential\n        res = minimize_scalar(v_fit, bounds=(0, 2 * np.pi), method='bounded')\n        phi_0 = res.x\n        v_min = res.fun\n        \n        def v_shifted(phi):\n            return v_fit(phi) - v_min\n\n        # Step 4: Harmonic Oscillator (HO) free energy\n        beta = 1.0 / (k_B * T)\n        k_tor = v_fit_d2(phi_0)\n        \n        if k_tor = 0:\n            # If curvature is not positive, HO model is pathological.\n            # This indicates a poor fit or data. For now, we can raise this.\n            # For the given test cases, this should not happen.\n            raise ValueError(\"Non-positive curvature at a potential minimum.\")\n            \n        omega_ho = np.sqrt(k_tor / I)\n        \n        term_ho = beta * hbar * omega_ho\n        q_ho = np.exp(-0.5 * term_ho) / (1.0 - np.exp(-term_ho))\n        g_ho_mol = -R * T * np.log(q_ho)\n\n        # Step 5: Hindered Rotor (HR) free energy\n        # Configurational integral\n        integrand = lambda phi: np.exp(-beta * v_shifted(phi))\n        conf_integral, _ = quad(integrand, 0, 2 * np.pi)\n        \n        # Kinetic part of the partition function\n        q_kin_factor = np.sqrt(2 * np.pi * I * k_B * T) / h\n        \n        q_hr = q_kin_factor * conf_integral / sigma\n        g_hr_mol = -R * T * np.log(q_hr)\n        \n        # Step 6: Final correction\n        delta_g_mol = g_hr_mol - g_ho_mol  # in J/mol\n        delta_g_kj_mol = delta_g_mol / 1000.0\n        \n        results.append(round(delta_g_kj_mol, 6))\n\n    # Final print statement in the exact required format\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2936576"}]}