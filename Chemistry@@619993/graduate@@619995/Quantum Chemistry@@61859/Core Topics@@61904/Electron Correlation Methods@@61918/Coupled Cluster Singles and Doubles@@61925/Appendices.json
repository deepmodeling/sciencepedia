{"hands_on_practices": [{"introduction": "A robust theoretical model must yield correct results in well-understood limits. This first exercise serves as a fundamental sanity check for the Coupled Cluster Singles and Doubles (CCSD) method by applying it to the simplest possible quantum system: a single-electron atom. By working through this thought experiment [@problem_id:2453766], you will reinforce your understanding of electron correlation by confirming that the CCSD framework correctly yields zero correlation energy when no electron-electron interaction is present, showing its consistency with the exact Hartree-Fock solution in this limit.", "problem": "Consider a non-relativistic hydrogen atom with nuclear charge $Z=1$ in the Born–Oppenheimer approximation. You perform a Coupled Cluster Singles and Doubles (CCSD) calculation using a Hartree–Fock (HF) reference determinant and an otherwise complete one-electron basis. The electronic correlation energy is defined as the difference between the exact non-relativistic electronic energy and the Hartree–Fock energy, i.e., $E_{\\mathrm{corr}} = E_{\\mathrm{exact}} - E_{\\mathrm{HF}}$. Which statement best describes the CCSD correlation energy for this one-electron system and the fundamental reason for it?\n\nA. $E_{\\mathrm{corr}}=0$ because there is no electron–electron interaction in a one-electron system, so HF is exact and the CCSD cluster amplitudes vanish.\n\nB. $E_{\\mathrm{corr}}<0$ because CCSD captures dynamical correlation via double excitations that lower the energy even with one electron.\n\nC. $E_{\\mathrm{corr}}=0$ because basis set incompleteness cancels the correlation energy error in CCSD for 1 electron.\n\nD. $E_{\\mathrm{corr}}>0$ because truncation in CCSD leads to an overestimation of correlation that raises the energy above HF for 1 electron.", "solution": "The validity of the problem statement must first be established.\n\n### Step 1: Extract Givens\n- System: A non-relativistic hydrogen atom.\n- Nuclear Charge: $Z=1$.\n- Approximation: Born–Oppenheimer approximation is assumed.\n- Calculation Method: Coupled Cluster Singles and Doubles (CCSD).\n- Reference Wavefunction: Hartree–Fock (HF) determinant.\n- Basis Set: A complete one-electron basis.\n- Definition Provided: The electronic correlation energy is $E_{\\mathrm{corr}} = E_{\\mathrm{exact}} - E_{\\mathrm{HF}}$.\n- Question: Describe the CCSD correlation energy for this $1$-electron system and the fundamental reason for this result.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically grounded. The hydrogen atom is a fundamental system in quantum mechanics. The Hartree-Fock method, Coupled Cluster theory, and the concept of electron correlation are central pillars of modern computational chemistry. The problem is well-posed, providing all necessary information (system, methods, basis set limit, definitions) to arrive at a unique, logical conclusion. The language is objective and precise. The idealization of a \"complete one-electron basis\" is a standard theoretical construct used to separate method error from basis set error. The problem does not violate any fundamental principles, is not ambiguous, and is directly relevant to the specified scientific field.\n\n### Step 3: Verdict and Action\nThe problem statement is declared **valid**. A solution will be derived.\n\n### Derivation of the Correct Answer\n\nThe problem concerns the application of the Hartree-Fock (HF) and Coupled Cluster Singles and Doubles (CCSD) methods to a one-electron system, specifically the hydrogen atom ($Z=1$).\n\n$1$. **The Hamiltonian and the Exact Solution:**\nWithin the Born-Oppenheimer approximation, the nucleus is stationary. The non-relativistic electronic Hamiltonian for a one-electron system with nuclear charge $Z$ is purely a one-electron operator:\n$$ \\hat{H} = \\hat{h}(1) = -\\frac{1}{2}\\nabla_1^2 - \\frac{Z}{r_1} $$\nFor the hydrogen atom, $Z=1$. This Hamiltonian does not contain any two-electron terms ($1/r_{ij}$), as there is only one electron. The Schrödinger equation, $\\hat{H}\\Psi = E\\Psi$, is exactly solvable for this system. The energy obtained, $E_{\\mathrm{exact}}$, is the exact non-relativistic electronic energy.\n\n$2$. **The Hartree-Fock (HF) Method for a One-Electron System:**\nThe HF method approximates the many-electron wavefunction as a single Slater determinant. For a one-electron system, this determinant is simply the one-electron orbital itself, $|\\Phi_0\\rangle = |\\psi_1\\rangle$. The HF energy is found by minimizing the expectation value of the Hamiltonian, $E_{\\mathrm{HF}} = \\langle\\Phi_0|\\hat{H}|\\Phi_0\\rangle$. The minimization process leads to the canonical HF equations, $\\hat{f}|\\psi_i\\rangle = \\epsilon_i|\\psi_i\\rangle$, where $\\hat{f}$ is the Fock operator.\n\nThe general form of the Fock operator for electron $1$ is:\n$$ \\hat{f}(1) = \\hat{h}(1) + \\sum_{j=1}^{N} \\left( \\hat{J}_j(1) - \\hat{K}_j(1) \\right) $$\nwhere $\\hat{J}_j$ is the Coulomb operator and $\\hat{K}_j$ is the exchange operator, which both describe interactions with other electrons. For a one-electron system ($N=1$), the sum describes the interaction of the electron with itself. This self-interaction is known to be exactly canceled, i.e., $\\hat{J}_1(1) - \\hat{K}_1(1) = 0$. Consequently, the Fock operator simplifies to the core Hamiltonian:\n$$ \\hat{f}(1) = \\hat{h}(1) $$\nTherefore, the HF equation for the single electron becomes $\\hat{h}(1)|\\psi_1\\rangle = \\epsilon_1|\\psi_1\\rangle$. This is identical to the exact Schrödinger equation for the system.\n\nGiven that a \"complete one-electron basis\" is used, the HF calculation is able to find the exact orbital $|\\psi_1\\rangle$ and thus the exact energy. This means that for any one-electron system, the HF method is not an approximation but is exact.\n$$ E_{\\mathrm{HF}} = E_{\\mathrm{exact}} $$\n\n$3$. **Electronic Correlation Energy:**\nThe problem defines correlation energy as $E_{\\mathrm{corr}} = E_{\\mathrm{exact}} - E_{\\mathrm{HF}}$. Based on our finding that $E_{\\mathrm{HF}} = E_{\\mathrm{exact}}$, the exact correlation energy for a one-electron system is identically zero.\n$$ E_{\\mathrm{corr}} = E_{\\mathrm{exact}} - E_{\\mathrm{HF}} = 0 $$\nElectron correlation is fundamentally a many-electron phenomenon, arising from the inadequacy of the mean-field (HF) approximation to describe the instantaneous interactions between electrons. With only one electron, such interactions do not exist, and thus there is no correlation.\n\n$4$. **The Coupled Cluster (CCSD) Method for a One-Electron System:**\nThe CCSD wavefunction is constructed as $|\\Psi_{\\text{CCSD}}\\rangle = e^{\\hat{T}}|\\Phi_0\\rangle$, where $|\\Phi_0\\rangle$ is the HF reference and the cluster operator $\\hat{T}$ is truncated at single and double excitations: $\\hat{T} = \\hat{T}_1 + \\hat{T}_2$.\n- The singles operator, $\\hat{T}_1 = \\sum_{i,a} t_i^a \\hat{a}_a^\\dagger \\hat{a}_i$, excites one electron from an occupied orbital $i$ to a virtual orbital $a$.\n- The doubles operator, $\\hat{T}_2 = \\frac{1}{4} \\sum_{i,j,a,b} t_{ij}^{ab} \\hat{a}_a^\\dagger \\hat{a}_b^\\dagger \\hat{a}_j \\hat{a}_i$, excites two electrons from occupied orbitals $i,j$ to virtual orbitals $a,b$.\n\nFor a one-electron system, the occupied space contains only one orbital. It is therefore impossible to select two occupied orbitals for a double excitation. The operator $\\hat{T}_2$ cannot produce a non-zero result when acting on a one-electron determinant. Consequently, all double excitation amplitudes must be zero: $t_{ij}^{ab} = 0$.\n\nThe CCSD equations for the amplitudes are derived from projecting the CC Schrödinger equation onto the space of excited determinants. These equations are driven by the two-electron part of the Hamiltonian. Since the Hamiltonian for a one-electron system has no two-electron terms, all two-electron integrals are zero.\nThe double-excitation amplitude equations have the general form:\n$$ (\\epsilon_a + \\epsilon_b - \\epsilon_i - \\epsilon_j) t_{ij}^{ab} = \\langle ij || ab \\rangle + \\dots $$\nwhere $\\langle ij || ab \\rangle$ is an antisymmetrized two-electron integral. Since all such integrals are zero, and the remaining terms also depend on two-electron interactions, the only solution is $t_{ij}^{ab}=0$.\nWith $t_{ij}^{ab}=0$, the single-excitation amplitude equations simplify to:\n$$ (\\epsilon_a - \\epsilon_i) t_i^a = \\dots $$\nThe terms on the right-hand side also vanish because they involve two-electron integrals that couple singles and doubles amplitudes. This leaves $(\\epsilon_a - \\epsilon_i) t_i^a = 0$. Since for an excitation $\\epsilon_a > \\epsilon_i$, the energy difference is non-zero, requiring that the singles amplitudes must also be zero: $t_i^a=0$.\n\nTherefore, for a one-electron system, all cluster amplitudes vanish, $\\hat{T} = \\hat{T}_1 + \\hat{T}_2 = 0$. The CCSD wavefunction becomes identical to the HF reference:\n$$ |\\Psi_{\\text{CCSD}}\\rangle = e^0 |\\Phi_0\\rangle = |\\Phi_0\\rangle = |\\Psi_{\\text{HF}}\\rangle $$\nThe CCSD energy is thus equal to the HF energy:\n$$ E_{\\text{CCSD}} = E_{\\text{HF}} $$\nThe correlation energy predicted by CCSD is $E_{\\text{CCSD}} - E_{\\text{HF}}$. For this system, the value is $0$.\nSo, CCSD correctly finds that the correlation energy is zero for a one-electron system.\n\n### Evaluation of Options\n\n**A. $E_{\\mathrm{corr}}=0$ because there is no electron–electron interaction in a one-electron system, so HF is exact and the CCSD cluster amplitudes vanish.**\nThis statement claims that the correlation energy is $0$. This is **Correct**. It provides a three-part reason:\n$1$. \"there is no electron–electron interaction in a one-electron system\": This is the fundamental physical reality. **Correct**.\n$2$. \"so HF is exact\": As derived above, the absence of electron-electron interaction makes the HF equation identical to the Schrödinger equation, rendering the HF solution exact (in a complete basis). **Correct**.\n$3$. \"and the CCSD cluster amplitudes vanish\": As derived above, the absence of two-electron interactions, which drive the excitations, forces all singles and doubles amplitudes to be zero. **Correct**.\nThe entire statement is a complete and accurate description of the situation.\n\n**B. $E_{\\mathrm{corr}}<0$ because CCSD captures dynamical correlation via double excitations that lower the energy even with one electron.**\nThis statement claims $E_{\\mathrm{corr}}<0$. This is **Incorrect**. The correlation energy is exactly $0$. The reasoning is also flawed: \"double excitations ... even with one electron\" is a physical impossibility. One cannot excite two electrons when only one is present.\n\n**C. $E_{\\mathrm{corr}}=0$ because basis set incompleteness cancels the correlation energy error in CCSD for 1 electron.**\nThis statement claims $E_{\\mathrm{corr}}=0$, which is the correct value. However, the reasoning is entirely flawed. First, the problem explicitly posits a \"complete one-electron basis,\" so \"basis set incompleteness\" is not a factor. Second, there is no \"correlation energy error in CCSD\" for this system; CCSD is exact here. Third, the idea of a fortuitous cancellation between two unrelated error types is not a valid fundamental principle. This reasoning is nonsensical. **Incorrect**.\n\n**D. $E_{\\mathrm{corr}}>0$ because truncation in CCSD leads to an overestimation of correlation that raises the energy above HF for 1 electron.**\nThis statement claims $E_{\\mathrm{corr}}>0$. By definition, for the exact ground state, $E_{\\mathrm{exact}} \\le E_{\\mathrm{HF}}$ (due to the variational principle for HF), which implies $E_{\\mathrm{corr}} = E_{\\mathrm{exact}} - E_{\\mathrm{HF}} \\le 0$. A positive correlation energy is a physical impossibility. Furthermore, the reasoning is incorrect. CCSD is not truncated for a one-electron system; it is exact. Therefore, the statement is **Incorrect**.\n\n### Conclusion\nOption A provides the correct value for the correlation energy and a completely sound and fundamental explanation.", "answer": "$$\\boxed{A}$$", "id": "2453766"}, {"introduction": "Having established the baseline behavior of CCSD for a one-electron system, we now investigate the first case where electron correlation becomes a non-trivial phenomenon. This problem explores the remarkable power of the CCSD ansatz by applying it to a general two-electron system, such as the helium atom or the hydrogen molecule. By analyzing the structure of the cluster operator, this exercise [@problem_id:237876] demonstrates that CCSD is not merely an approximation but provides the exact energy for these systems, equivalent to Full Configuration Interaction (FCI), highlighting the fundamental importance of single and double excitations.", "problem": "In quantum chemistry, the Coupled Cluster (CC) method is a powerful tool for calculating the electronic structure of atoms and molecules. The CC wavefunction is given by the ansatz $|\\Psi_{CC}\\rangle = e^{\\hat{T}} |\\Phi_0\\rangle$, where $|\\Phi_0\\rangle$ is a reference single-determinant wavefunction (typically the Hartree-Fock ground state) and $\\hat{T}$ is the cluster operator. The cluster operator is a sum of excitation operators, $\\hat{T} = \\hat{T}_1 + \\hat{T}_2 + \\dots + \\hat{T}_N$, where $\\hat{T}_k$ generates all $k$-fold excitations from the reference and $N$ is the total number of electrons.\n\nThe Coupled Cluster Singles and Doubles (CCSD) method is a common approximation where the cluster operator is truncated to include only single and double excitations: $\\hat{T} \\approx \\hat{T}_{CCSD} = \\hat{T}_1 + \\hat{T}_2$. The energy and amplitudes defining the excitation operators are found by solving the CC equations:\n$$\nE_{CCSD} = \\langle \\Phi_0 | e^{-\\hat{T}} \\hat{H} e^{\\hat{T}} | \\Phi_0 \\rangle\n$$\n$$\n\\langle \\Phi_{\\mu} | e^{-\\hat{T}} \\hat{H} e^{\\hat{T}} | \\Phi_0 \\rangle = 0\n$$\nwhere $\\hat{H}$ is the electronic Hamiltonian, and $|\\Phi_{\\mu}\\rangle$ represents the space of singly and doubly excited determinants.\n\nFor any given system, the Full Configuration Interaction (FCI) method provides the exact ground-state energy, $E_{FCI}$, within the chosen one-particle basis set. The FCI wavefunction includes contributions from all possible excited determinants. For a two-electron system, the FCI expansion contains at most double excitations.\n\nConsider a general two-electron system. By analyzing the structure of the exact (FCI) wavefunction and its relationship to the CCSD wavefunction ansatz, derive a final, simple expression for the energy difference $\\Delta E = E_{FCI} - E_{CCSD}$.", "solution": "1. Relevant ansatz and equations:  \n$$|\\Psi_{CC}\\rangle=e^{\\hat{T}}|\\Phi_0\\rangle,\\qquad \\hat{T}=\\hat{T}_1+\\hat{T}_2$$  \nThe exact FCI wavefunction for two electrons spans $|\\Phi_0\\rangle$, single excitations, and double excitations only.  \n2. Expand the cluster exponential:  \n$$e^{\\hat{T}_1+\\hat{T}_2}=1+\\hat{T}_1+\\hat{T}_2+\\tfrac12\\hat{T}_1^2+\\dots$$  \nHigher-order terms vanish for two electrons: $\\hat{T}_2^2=0$ and $\\hat{T}_1^n=0$ for $n\\ge3$.  \n3. The CCSD wavefunction is  \n$$|\\Psi_{CCSD}\\rangle=(1+\\hat{T}_1)|\\Phi_0\\rangle+(\\hat{T}_2+\\tfrac12\\hat{T}_1^2)|\\Phi_0\\rangle,$$  \nwhich exactly spans the FCI space of singles and doubles.  \n4. Hence the CCSD energy equals the FCI energy, $E_{CCSD}=E_{FCI}$, and  \n$$\\Delta E=E_{FCI}-E_{CCSD}=0.$$", "answer": "$$\\boxed{0}$$", "id": "237876"}, {"introduction": "While the previous exercises demonstrated the theoretical elegance and accuracy of CCSD in important limiting cases, its practical utility for general chemical systems is ultimately dictated by its computational expense. This final practice problem shifts our focus from theoretical exactness to computational feasibility by dissecting the CCSD algorithm itself. By deriving the computational scaling of one of the most resource-intensive terms in the CCSD equations [@problem_id:2453758], you will gain essential insight into why CCSD calculations, despite their accuracy, are computationally demanding and typically limited to systems of a modest size.", "problem": "Consider a closed-shell molecule described in a canonical Hartree–Fock molecular orbital basis. In a spin-orbital formulation of Coupled Cluster Singles and Doubles (CCSD), let the number of occupied spin orbitals be $n_o$ and the number of virtual spin orbitals be $n_v$. Use occupied indices $i,j,k,\\dots$ and virtual indices $a,b,c,d,\\dots$. The antisymmetrized $2$-electron integral is $\\langle pq||rs\\rangle \\equiv \\langle pq|rs\\rangle - \\langle pq|sr\\rangle$.\n\nFocus on assembling the doubles amplitude residual $R_{ij}^{ab}$ for all $(i,j,a,b)$ using a naive dense algorithm that exploits no permutational symmetry and applies no screening. Among the terms contributing to $R_{ij}^{ab}$, consider the tensor contraction\n$$\nR_{ij}^{ab} \\leftarrow \\sum_{c,d} \\langle ab||cd\\rangle\\, \\tau_{ij}^{cd},\n$$\nwhere $\\tau_{ij}^{cd}$ is a doubles-like intermediate with the same index structure as $t_{ij}^{cd}$, and the sum runs over all virtual indices $c$ and $d$.\n\nAssuming that the cost is dominated by the number of scalar multiplications and that additions have the same scaling, derive the leading-order computational cost (operation count) of evaluating the above contraction for all $i,j,a,b$ as a function of $n_o$ and $n_v$. Express your final answer as a single monomial in $n_o$ and $n_v$, ignoring all constant prefactors and lower-order terms.", "solution": "The problem statement is subjected to validation and is found to be valid. It is a well-posed, scientifically grounded problem in the field of computational quantum chemistry, specifically concerning the computational cost analysis of Coupled Cluster theory. All terms and conditions are clearly defined, allowing for a rigorous and objective derivation.\n\nThe task is to determine the leading-order computational cost of evaluating a specific tensor contraction that contributes to the Coupled Cluster Singles and Doubles (CCSD) amplitude residual, $R_{ij}^{ab}$. The contraction is given by:\n$$\nR_{ij}^{ab} \\leftarrow \\sum_{c,d} \\langle ab||cd\\rangle\\, \\tau_{ij}^{cd}\n$$\nThis update must be performed for all combinations of occupied spin-orbital indices $i,j$ and virtual spin-orbital indices $a,b$. The variables $n_o$ and $n_v$ represent the number of occupied and virtual spin orbitals, respectively.\n\nThe problem specifies a \"naive dense algorithm that exploits no permutational symmetry\". This implies a direct implementation using nested loops over all indices. The total computational cost, dominated by scalar multiplications, can be determined by counting the total number of floating-point operations required.\n\nLet us analyze the indices involved in the expression.\nThe residual tensor $R_{ij}^{ab}$ has four external indices:\n- $i$ runs over $n_o$ occupied spin orbitals.\n- $j$ runs over $n_o$ occupied spin orbitals.\n- $a$ runs over $n_v$ virtual spin orbitals.\n- $b$ runs over $n_v$ virtual spin orbitals.\n\nSince the problem states that no permutational symmetry is exploited, we consider all combinations of these indices independently. Therefore, the total number of elements in the residual tensor $R_{ij}^{ab}$ that must be computed is the product of the ranges of its indices:\n$$\n\\text{Number of elements} = n_o \\times n_o \\times n_v \\times n_v = n_o^2 n_v^2\n$$\n\nFor each of these $n_o^2 n_v^2$ elements, we must evaluate the summation on the right-hand side. This summation involves two internal indices, $c$ and $d$, which are summed over.\n- $c$ runs over all $n_v$ virtual spin orbitals.\n- $d$ runs over all $n_v$ virtual spin orbitals.\n\nThe summation for a single element $R_{ij}^{ab}$ is $\\sum_{c,d} \\langle ab||cd\\rangle\\, \\tau_{ij}^{cd}$. To evaluate this sum, we iterate through all possible values of $c$ and $d$. The number of terms in this double summation is:\n$$\n\\text{Number of terms in sum} = n_v \\times n_v = n_v^2\n$$\nEach term in the sum, $\\langle ab||cd\\rangle\\, \\tau_{ij}^{cd}$, involves the multiplication of one element from the two-electron integral tensor $\\langle ab||cd\\rangle$ and one element from the intermediate tensor $\\tau_{ij}^{cd}$. This constitutes one scalar multiplication. Assuming additions scale similarly, the cost of computing one element $R_{ij}^{ab}$ is proportional to the number of terms in the sum.\n$$\n\\text{Cost per } R_{ij}^{ab} \\text{ element} \\propto n_v^2\n$$\nThe total computational cost is the product of the number of residual elements to be calculated and the cost to compute each element.\n$$\n\\text{Total Cost} \\propto (\\text{Number of elements of } R_{ij}^{ab}) \\times (\\text{Cost per element})\n$$\nSubstituting the expressions derived above:\n$$\n\\text{Total Cost} \\propto (n_o^2 n_v^2) \\times (n_v^2) = n_o^2 n_v^4\n$$\nA direct loop-based implementation would look as follows:\n```\nFor i = 1 to n_o\n  For j = 1 to n_o\n    For a = 1 to n_v\n      For b = 1 to n_v\n        accumulator = 0\n        For c = 1 to n_v\n          For d = 1 to n_v\n            // One multiplication and one addition\n            accumulator += get_integral(a,b,c,d) * get_tau(i,j,c,d)\n        R(i,j,a,b) += accumulator\n```\nThe innermost operation is executed for each combination of the six indices. The total number of iterations, and thus the dominant computational scaling, is the product of the loop ranges: $n_o \\times n_o \\times n_v \\times n_v \\times n_v \\times n_v = n_o^2 n_v^4$.\n\nThe problem asks for the leading-order cost as a single monomial, ignoring constant prefactors. Therefore, the computational cost scales as $n_o^2 n_v^4$.", "answer": "$$\n\\boxed{n_o^{2} n_v^{4}}\n$$", "id": "2453758"}]}