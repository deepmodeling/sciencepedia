{"hands_on_practices": [{"introduction": "Understanding electron correlation begins with the simplest chemical bond. This exercise [@problem_id:2962803] takes you back to first principles, using the hydrogen molecule ($\\text{H}_2$) as a model system. By applying Rayleigh-Schrödinger perturbation theory to a minimal basis description, you will estimate the correlation energy's contribution to bond stability and, more importantly, discover why this simple picture breaks down as the bond is stretched, providing a clear window into the emergence of static correlation.", "problem": "A hydrogen molecule $\\text{H}_2$ at its equilibrium internuclear separation is modeled in a minimal basis with one doubly occupied bonding molecular orbital $\\sigma_{g}$ of one-electron energy $\\varepsilon_{g}$ and one corresponding antibonding virtual molecular orbital $\\sigma_{u}$ of one-electron energy $\\varepsilon_{u}$. Take the Hartree-Fock (HF) determinant as the zeroth-order reference state and treat the residual electron-electron interaction beyond HF as a perturbation in the sense of Rayleigh-Schrödinger perturbation theory. For a closed-shell reference in this minimal description, single excitations do not contribute at second order, and the leading correlation correction arises from the unique double excitation $\\sigma_g^2 \\rightarrow \\sigma_u^2$.\n\nYou are given the following spectroscopic-quality data at the equilibrium separation:\n- The orbital energy gap is $\\Delta \\equiv \\varepsilon_{u} - \\varepsilon_{g} = 0.50\\,E_{h}$, where $E_{h}$ is the Hartree energy.\n- The magnitude of the antisymmetrized two-electron integral driving the $\\sigma_g^2 \\rightarrow \\sigma_u^2$ mixing is $M \\equiv |\\langle gg \\Vert uu \\rangle| = 0.198\\,E_{h}$.\n- For separated hydrogen atoms, the correlation energy is zero.\n\nUsing only the stated foundations (Hartree-Fock as the zeroth-order state and Rayleigh-Schrödinger perturbation theory), estimate the second-order electron correlation contribution to the covalent bond dissociation energy of $\\text{H}_2$ at equilibrium. Report the result as a positive number in $\\text{kJ mol}^{-1}$. Use the conversion $1\\,E_{h} = 2625.5\\,\\text{kJ mol}^{-1}$.\n\nIn addition, justify which component of electron correlation—static (near-degeneracy) correlation versus dynamic (short-range Coulomb) correlation—is expected to dominate as the bond is stretched toward dissociation, based on a two-configuration reasoning. Your justification should be conceptual and derived from the same perturbative starting point, but your final reported answer must only be the requested numerical estimate.\n\nRound your reported numerical answer to four significant figures.", "solution": "The problem statement has been evaluated and is determined to be valid. It is a scientifically grounded, well-posed, and objective problem in the domain of quantum chemistry. It provides a self-contained set of data and principles to arrive at a unique, meaningful solution.\n\nThe problem requires the calculation of the second-order electron correlation energy contribution to the bond dissociation energy of the dihydrogen molecule, $\\text{H}_2$, within a minimal basis model. The theoretical framework is specified as Rayleigh-Schrödinger perturbation theory, with the Hartree-Fock (HF) ground state serving as the zeroth-order reference.\n\nThe zeroth-order reference state is the HF determinant, $|\\Phi_{0}\\rangle$, corresponding to the electronic configuration $\\sigma_{g}^{2}$. The zeroth-order energy is the sum of the orbital energies of the occupied orbitals, $E_{0}^{(0)} = 2\\varepsilon_{g}$. The perturbation, $\\hat{V}$, is the difference between the true electronic Hamiltonian and the fictitious HF operator.\n\nThe second-order correction to the energy, $E^{(2)}$, is given by the general formula of perturbation theory:\n$$ E^{(2)} = \\sum_{I \\neq 0} \\frac{|\\langle \\Phi_{I} | \\hat{V} | \\Phi_{0} \\rangle|^{2}}{E_{0}^{(0)} - E_{I}^{(0)}} $$\nwhere $|\\Phi_{I}\\rangle$ are excited determinants with corresponding zeroth-order energies $E_{I}^{(0)}$.\n\nFor the given minimal basis model of $\\text{H}_2$, which consists of one occupied bonding molecular orbital ($\\sigma_{g}$) and one virtual antibonding molecular orbital ($\\sigma_{u}$), the only possible excitation from the closed-shell ground state $|\\Phi_0\\rangle = |\\sigma_g\\alpha \\sigma_g\\beta \\rangle$ to a doubly excited determinant is to $|\\Phi_{D}\\rangle = |\\sigma_u\\alpha \\sigma_u\\beta \\rangle$. The problem statement correctly notes that single excitations do not contribute to the energy at second order due to Brillouin's theorem.\n\nThe zeroth-order energy of the excited state $|\\Phi_{D}\\rangle$ is $E_{D}^{(0)} = 2\\varepsilon_{u}$. The energy denominator in the perturbation formula is therefore:\n$$ E_{0}^{(0)} - E_{D}^{(0)} = 2\\varepsilon_{g} - 2\\varepsilon_{u} = -2(\\varepsilon_{u} - \\varepsilon_{g}) = -2\\Delta $$\nwhere $\\Delta$ is the given orbital energy gap, $\\Delta = \\varepsilon_{u} - \\varepsilon_{g} = 0.50\\,E_{h}$.\n\nThe numerator requires the matrix element $\\langle \\Phi_{D} | \\hat{V} | \\Phi_{0} \\rangle$. For a double excitation, this is equivalent to $\\langle \\Phi_{D} | \\hat{H} | \\Phi_{0} \\rangle$, where $\\hat{H}$ is the full electronic Hamiltonian. According to the Slater-Condon rules for matrix elements between determinants differing by two spin-orbitals ($\\sigma_{g}\\alpha \\rightarrow \\sigma_{u}\\alpha$ and $\\sigma_{g}\\beta \\rightarrow \\sigma_{u}\\beta$), this matrix element simplifies to a single two-electron integral in chemist's notation:\n$$ \\langle \\Phi_{D} | \\hat{H} | \\Phi_{0} \\rangle = (\\sigma_{g}\\sigma_{u}|\\sigma_{g}\\sigma_{u}) = \\iint \\sigma_{g}^{*}(1)\\sigma_{u}(1) \\frac{1}{r_{12}} \\sigma_{g}^{*}(2)\\sigma_{u}(2) \\, d\\mathbf{r}_{1}d\\mathbf{r}_{2} $$\nThis integral is often denoted as the exchange-type integral $K_{gu}$. The problem provides the magnitude of the integral driving the mixing as $M \\equiv |\\langle gg \\Vert uu \\rangle| = 0.198\\,E_{h}$. In the context of the perturbation that mixes the $|\\sigma_g^2\\rangle$ and $|\\sigma_u^2\\rangle$ configurations, this quantity $M$ must be identified with the magnitude of the off-diagonal Hamiltonian matrix element, $|K_{gu}|$.\n\nSubstituting these components into the second-order energy formula yields the correlation energy for the $\\text{H}_2$ molecule at its equilibrium separation:\n$$ E_{\\text{corr, eq}}^{(2)} = \\frac{|K_{gu}|^{2}}{-2\\Delta} = -\\frac{M^{2}}{2\\Delta} $$\nUsing the provided data:\n$$ E_{\\text{corr, eq}}^{(2)} = -\\frac{(0.198\\,E_{h})^{2}}{2(0.50\\,E_{h})} = -0.039204\\,E_{h} $$\n\nThe problem asks for the contribution of electron correlation to the bond dissociation energy, $D_{e}$. The bond dissociation energy is defined as the energy of the separated atoms minus the energy of the molecule: $D_{e} = E(\\text{atoms}) - E(\\text{molecule})$. The total energies can be partitioned into HF and correlation components:\n$$ D_{e} = [E_{\\text{HF}}(\\text{atoms}) + E_{\\text{corr}}(\\text{atoms})] - [E_{\\text{HF}}(\\text{H}_{2}) + E_{\\text{corr}}(\\text{H}_{2})] $$\n$$ D_{e} = [E_{\\text{HF}}(\\text{atoms}) - E_{\\text{HF}}(\\text{H}_{2})] + [E_{\\text{corr}}(\\text{atoms}) - E_{\\text{corr}}(\\text{H}_{2})] $$\nThe term $[E_{\\text{corr}}(\\text{atoms}) - E_{\\text{corr}}(\\text{H}_{2})]$ is the correlation contribution to the bond dissociation energy. The problem correctly states that for the separated hydrogen atoms, which are one-electron systems, the correlation energy is zero: $E_{\\text{corr}}(\\text{atoms}) = 0$. Using our second-order estimate for the molecular correlation energy, $E_{\\text{corr}}(\\text{H}_{2}) \\approx E_{\\text{corr, eq}}^{(2)}$, the contribution is:\n$$ \\Delta D_{e, \\text{corr}} = 0 - E_{\\text{corr, eq}}^{(2)} = -(-0.039204\\,E_{h}) = 0.039204\\,E_{h} $$\nThe positive sign indicates that electron correlation lowers the energy of the molecule, thus increasing its stability and the energy required to dissociate it.\n\nTo report the result in the requested units of $\\text{kJ mol}^{-1}$, we use the conversion factor $1\\,E_{h} = 2625.5\\,\\text{kJ mol}^{-1}$:\n$$ \\Delta D_{e, \\text{corr}} = 0.039204 \\times 2625.5\\,\\text{kJ mol}^{-1} \\approx 102.923\\,\\text{kJ mol}^{-1} $$\nRounding to four significant figures, the result is $102.9\\,\\text{kJ mol}^{-1}$.\n\nFor the second part of the inquiry, concerning the dominant type of electron correlation during bond stretching, we analyze the behavior of the two-configuration model. At equilibrium, the energy gap $\\Delta$ is large, making the HF configuration $|\\sigma_{g}^{2}\\rangle$ a good zeroth-order description. The correction from mixing with $|\\sigma_{u}^{2}\\rangle$ is small and accounts for the dynamic avoidance of electrons, which is termed **dynamic correlation**.\n\nAs the internuclear distance $R$ increases towards dissociation ($R \\rightarrow \\infty$), the atomic orbitals from which the MOs are formed ($1s_{A}$ and $1s_{B}$) cease to overlap. This causes the energies of the bonding ($\\sigma_{g}$) and antibonding ($\\sigma_{u}$) orbitals to become degenerate: $\\varepsilon_{g} \\rightarrow \\varepsilon_{u}$, which implies $\\Delta \\rightarrow 0$.\nThe denominator in the perturbation theory expression for energy, $-2\\Delta$, approaches zero. This leads to a divergence, signaling the breakdown of single-reference perturbation theory. The physical reason for this failure is that the two configurations, $|\\sigma_{g}^{2}\\rangle$ and $|\\sigma_{u}^{2}\\rangle$, are no longer well-separated in energy; they become degenerate. In such a situation, a qualitatively correct description of the electronic structure requires a multi-configurational wavefunction, i.e., a linear combination of the degenerate or near-degenerate determinants. The correlation effect that arises from the need to include multiple determinants in the zeroth-order wavefunction to obtain a qualitatively correct description (especially for bond breaking) is known as **static correlation**, or near-degeneracy correlation. Therefore, as the bond is stretched, static correlation becomes the dominant effect that must be addressed. The Hartree-Fock method itself fails catastrophically in this limit, incorrectly describing the dissociation into a mixture of neutral atoms and ionic species ($\\text{H}^+\\text{H}^-$).", "answer": "$$\n\\boxed{102.9}\n$$", "id": "2962803"}, {"introduction": "While single-reference methods can fail for systems with strong static correlation, a variety of advanced techniques have been developed to overcome this challenge. This practice [@problem_id:2770423] puts you in the role of a computational chemist comparing different methods for a prototypical biradicaloid, a system defined by its near-degenerate frontier orbitals. By calculating the vertical singlet-triplet gap with different approaches—from a simple (and flawed) spin-projected UHF to sophisticated CASPT2 and EOM-SF-CCSD—you will gain a practical understanding of their relative strengths and weaknesses in treating both static and dynamic correlation.", "problem": "Consider a prototypical biradicaloid at a fixed nuclear geometry corresponding to the optimized singlet reference structure under the Born–Oppenheimer approximation. You are given single-point electronic energies (in Hartree) computed with several electronic structure methods for the lowest singlet and triplet states, as well as spin expectation values for unrestricted Hartree–Fock (UHF) states. All energies correspond to the same nuclear geometry and are therefore suitable for vertical energy gap analysis.\n\nDefinitions and data:\n- The vertical singlet–triplet gap is defined as $\\Delta E_{ST} = E_{T}(R_{S}) - E_{S}(R_{S})$, where $E_{S}(R_{S})$ and $E_{T}(R_{S})$ are the singlet and triplet electronic energies evaluated at the singlet-state geometry $R_{S}$.\n- Unrestricted Hartree–Fock (UHF):\n  - Broken-symmetry singlet solution: $E_{\\mathrm{BS}}^{\\mathrm{UHF}} = -152.497800$, $\\langle \\hat{S}^{2} \\rangle_{\\mathrm{BS}} = 0.92$.\n  - High-spin triplet solution: $E_{T}^{\\mathrm{UHF}} = -152.497300$, $\\langle \\hat{S}^{2} \\rangle_{T} = 2.02$.\n  - Use an approximate spin-projection based on $\\langle \\hat{S}^{2} \\rangle$ values to estimate a spin-pure singlet energy from the broken-symmetry UHF solution and the UHF triplet.\n- Spin-flip equation-of-motion coupled-cluster with single and double excitations (EOM-SF-CCSD) based on a high-spin triplet reference:\n  - $E_{S}^{\\text{SF-CCSD}} = -152.500000$, $E_{T}^{\\text{SF-CCSD}} = -152.498092$.\n- Complete active space self-consistent field with a $(2,2)$ active space (CASSCF) followed by second-order perturbation theory (CASPT2):\n  - $E_{S}^{\\mathrm{CASPT2}} = -152.521300$, $E_{T}^{\\mathrm{CASPT2}} = -152.518700$.\n- Conversion factor: $1$ Hartree $= 627.5095$ kilocalories per mole.\n\nTasks:\n1. Starting from first principles of spin symmetry and expectation values of $\\hat{S}^{2}$, derive an approximate expression to obtain a spin-pure $S=0$ energy from a broken-symmetry UHF solution using the given $\\langle \\hat{S}^{2} \\rangle$ values and the UHF triplet energy. Use this to compute the UHF-based vertical singlet–triplet gap $\\Delta E_{ST}^{\\mathrm{UHF}}$.\n2. Compute the vertical singlet–triplet gap from EOM-SF-CCSD, $\\Delta E_{ST}^{\\mathrm{SF-CCSD}}$.\n3. Compute the vertical singlet–triplet gap from CASPT2, $\\Delta E_{ST}^{\\mathrm{CASPT2}}$.\n\nExplain, using fundamental definitions of static versus dynamic electron correlation and the variational principle, why the three $\\Delta E_{ST}$ values may differ in magnitude and sign for a biradicaloid. In your reasoning, connect each method’s treatment of electron correlation to the expected bias in the predicted $\\Delta E_{ST}$.\n\nExpress your final numerical answers for the three gaps in kilocalories per mole as a single row matrix in the order $\\left(\\Delta E_{ST}^{\\mathrm{UHF}}, \\Delta E_{ST}^{\\mathrm{SF-CCSD}}, \\Delta E_{ST}^{\\mathrm{CASPT2}}\\right)$ and round each entry to four significant figures.", "solution": "The problem presented is scientifically grounded, well-posed, and objective. It utilizes standard concepts and methods from theoretical chemistry, and the provided data are consistent and sufficient for a complete analysis. Therefore, the problem is valid, and I will proceed with its solution.\n\nThe problem requires a three-part calculation of the vertical singlet-triplet energy gap, $\\Delta E_{ST} = E_T - E_S$, and a theoretical justification for the differences observed between the methods.\n\nFirst, we address the Unrestricted Hartree-Fock (UHF) case. The broken-symmetry (BS) singlet wavefunction, $|\\Psi_{\\mathrm{BS}}\\rangle$, is not an eigenfunction of the total spin squared operator, $\\hat{S}^2$. It is a mixture of pure spin states, predominantly the singlet ($S=0$) and triplet ($S=1$) states for a biradicaloid. The energy of this mixed state is a weighted average of the pure state energies. A common approximation to project out the singlet energy assumes a linear relationship between the energy and the expectation value $\\langle \\hat{S}^2 \\rangle$ for a series of spin-contaminated states.\nLet us denote the spin-pure singlet energy as $E_S$, the spin-pure triplet energy as $E_T$, the broken-symmetry UHF energy as $E_{\\mathrm{BS}}^{\\mathrm{UHF}}$, and the high-spin triplet UHF energy as $E_T^{\\mathrm{UHF}}$. The corresponding $\\langle \\hat{S}^2 \\rangle$ values are $0$, $2$, $\\langle \\hat{S}^2 \\rangle_{\\mathrm{BS}}$, and $\\langle \\hat{S}^2 \\rangle_T$. Assuming a linear dependence $E(\\langle \\hat{S}^2 \\rangle) = a + b \\langle \\hat{S}^2 \\rangle$, we can extrapolate to $\\langle \\hat{S}^2 \\rangle = 0$ to find the projected singlet energy, which we will call $E_S^{\\mathrm{AP-UHF}}$. Using the two data points provided, $(E_{\\mathrm{BS}}^{\\mathrm{UHF}}, \\langle \\hat{S}^2 \\rangle_{\\mathrm{BS}})$ and $(E_T^{\\mathrm{UHF}}, \\langle \\hat{S}^2 \\rangle_T)$, the slope $b$ is:\n$$ b = \\frac{E_T^{\\mathrm{UHF}} - E_{\\mathrm{BS}}^{\\mathrm{UHF}}}{\\langle \\hat{S}^2 \\rangle_T - \\langle \\hat{S}^2 \\rangle_{\\mathrm{BS}}} $$\nThe extrapolated energy for the pure singlet state ($S=0$, $\\langle \\hat{S}^2 \\rangle = 0$) is then given by the Yamaguchi spin-projection formula:\n$$ E_S^{\\mathrm{AP-UHF}} = E_{\\mathrm{BS}}^{\\mathrm{UHF}} - b \\langle \\hat{S}^2 \\rangle_{\\mathrm{BS}} = E_{\\mathrm{BS}}^{\\mathrm{UHF}} - \\left( \\frac{E_T^{\\mathrm{UHF}} - E_{\\mathrm{BS}}^{\\mathrm{UHF}}}{\\langle \\hat{S}^2 \\rangle_T - \\langle \\hat{S}^2 \\rangle_{\\mathrm{BS}}} \\right) \\langle \\hat{S}^2 \\rangle_{\\mathrm{BS}} $$\nUsing the given values:\n$E_{\\mathrm{BS}}^{\\mathrm{UHF}} = -152.497800$ Hartree, $\\langle \\hat{S}^{2} \\rangle_{\\mathrm{BS}} = 0.92$\n$E_{T}^{\\mathrm{UHF}} = -152.497300$ Hartree, $\\langle \\hat{S}^{2} \\rangle_{T} = 2.02$\n$$ E_S^{\\mathrm{AP-UHF}} = -152.497800 - \\left( \\frac{-152.497300 - (-152.497800)}{2.02 - 0.92} \\right) \\cdot 0.92 $$\n$$ E_S^{\\mathrm{AP-UHF}} = -152.497800 - \\left( \\frac{0.000500}{1.10} \\right) \\cdot 0.92 \\approx -152.498218 \\text{ Hartree} $$\nThe UHF-based singlet-triplet gap is:\n$$ \\Delta E_{ST}^{\\mathrm{UHF}} = E_T^{\\mathrm{UHF}} - E_S^{\\mathrm{AP-UHF}} = -152.497300 - (-152.498218) \\approx 0.000918 \\text{ Hartree} $$\n\nSecond, we calculate the gap from the EOM-SF-CCSD results. This is a direct subtraction of the provided energies:\n$E_{S}^{\\text{SF-CCSD}} = -152.500000$ Hartree, $E_{T}^{\\text{SF-CCSD}} = -152.498092$ Hartree\n$$ \\Delta E_{ST}^{\\text{SF-CCSD}} = E_{T}^{\\text{SF-CCSD}} - E_{S}^{\\text{SF-CCSD}} = -152.498092 - (-152.500000) = 0.001908 \\text{ Hartree} $$\n\nThird, we calculate the gap from the CASPT2 results. This is also a direct subtraction:\n$E_{S}^{\\mathrm{CASPT2}} = -152.521300$ Hartree, $E_{T}^{\\mathrm{CASPT2}} = -152.518700$ Hartree\n$$ \\Delta E_{ST}^{\\mathrm{CASPT2}} = E_{T}^{\\mathrm{CASPT2}} - E_{S}^{\\mathrm{CASPT2}} = -152.518700 - (-152.521300) = 0.002600 \\text{ Hartree} $$\n\nTo convert these gaps to kilocalories per mole (kcal/mol), we use the conversion factor $1 \\text{ Hartree} = 627.5095 \\text{ kcal/mol}$.\n$$ \\Delta E_{ST}^{\\mathrm{UHF}} \\approx 0.000918 \\text{ Hartree} \\times 627.5095 \\frac{\\text{kcal/mol}}{\\text{Hartree}} \\approx 0.5762 \\text{ kcal/mol} $$\n$$ \\Delta E_{ST}^{\\text{SF-CCSD}} = 0.001908 \\text{ Hartree} \\times 627.5095 \\frac{\\text{kcal/mol}}{\\text{Hartree}} \\approx 1.197 \\text{ kcal/mol} $$\n$$ \\Delta E_{ST}^{\\mathrm{CASPT2}} = 0.002600 \\text{ Hartree} \\times 627.5095 \\frac{\\text{kcal/mol}}{\\text{Hartree}} \\approx 1.632 \\text{ kcal/mol} $$\n\nNow, we must explain the discrepancies. The differences originate from how each method treats electron correlation, which is categorized into static and dynamic correlation.\n**Static correlation** arises from the near-degeneracy of multiple electronic configurations, which is the defining feature of a biradicaloid's singlet state. It is essential for a qualitatively correct description.\n**Dynamic correlation** is the short-range correlation of electron motion due to their mutual Coulombic repulsion.\n\n1.  **UHF with Approximate Projection (AP-UHF)**: The UHF method is based on a single Slater determinant. For a closed-shell singlet, this formalism fails completely for a biradicaloid, leading to a variationally unstable solution. The broken-symmetry UHF approach allows different orbitals for different spins, which artificially lowers the energy by mixing in the character of the low-lying triplet state. This leads to severe spin contamination ($\\langle \\hat{S}^2 \\rangle_{\\mathrm{BS}} = 0.92$, far from the pure singlet value of $0$). The method does not explicitly account for either static or dynamic correlation in a rigorous manner. The spin-projection formula is an *a posteriori* correction that attempts to rectify the spin contamination defect but is not part of a self-consistent, variational procedure. The resulting energy gap, while positive, is the least reliable and serves only as a crude estimate.\n\n2.  **CASPT2**: This is a two-step, multireference method. First, a Complete Active Space Self-Consistent Field (CASSCF) calculation is performed. For a biradicaloid, a $(2,2)$ active space (two electrons in two orbitals) is appropriate. CASSCF variationally optimizes a multiconfigurational wavefunction, explicitly including all key electronic configurations. This correctly captures the static correlation within the active space, providing a balanced, spin-pure description of both the multireference singlet state and the single-reference triplet state. The variational principle applies to the CASSCF energies, ensuring they are upper bounds to the exact energies *within the chosen active space*. The second step, second-order perturbation theory (PT2), adds a correction for dynamic correlation by considering excitations from the CASSCF reference. This correction is non-variational. CASPT2 is a powerful method as it systematically treats both static and dynamic correlation, yielding the lowest absolute energies in this problem and, generally, a reliable energy gap.\n\n3.  **EOM-SF-CCSD**: Equation-of-Motion Spin-Flip Coupled-Cluster with Singles and Doubles is a multireference-capable method built upon a single-reference foundation. It begins with a well-behaved high-spin triplet reference state ($M_S=1$), which is accurately described by a single determinant. Dynamic correlation is treated to high accuracy via the CCSD formalism. The spin-flip (SF) operator then generates target states with different spin multiplicity, including the $M_S=0$ component of the triplet and the multireference $M_S=0$ singlet state. This approach provides a balanced description of both target states because they are generated from the same reference and treated at the same theoretical level. It effectively captures both static correlation (through the spin-flip configuration mixing) and dynamic correlation (through the underlying CCSD). EOM-CCSD energies are not variational.\n\n**Comparison**:\nThe UHF result is small because the BS-UHF state is heavily contaminated with the triplet, making $E_{\\mathrm{BS}}^{\\mathrm{UHF}}$ and $E_T^{\\mathrm{UHF}}$ very close in energy; the projection is a significant correction. The CASPT2 and EOM-SF-CCSD methods are both far more sophisticated. Both correctly predict a singlet ground state ($\\Delta E_{ST} > 0$). The CASPT2 method yields the largest gap. This indicates that the PT2 correction provides a greater stabilization for the singlet state relative to the triplet state compared to the EOM-SF-CCSD method. This is physically plausible, as the singlet state, with its paired electron density, typically has a larger dynamic correlation energy than the triplet state, where the Pauli principle keeps the two electrons apart. The differences between CASPT2 and EOM-SF-CCSD reflect the inherent approximations in their respective treatments of dynamic correlation.", "answer": "$$ \\boxed{ \\begin{pmatrix} 0.5762 & 1.197 & 1.632 \\end{pmatrix} } $$", "id": "2770423"}, {"introduction": "A key skill for any computational chemist is the ability to critically analyze computed potential energy surfaces (PES) and diagnose the reliability of the methods used. This final practice [@problem_id:2888416] provides a hands-on toolkit for exactly this purpose, using a set of synthetic PES data. You will implement and apply quantitative metrics to assess method performance, such as the Non-Parallelity Error (NPE), and use modern diagnostics based on coupled-cluster amplitudes ($T_1$) and natural orbital occupation numbers to flag regions of a PES where static correlation effects become dominant and demand a multi-reference treatment.", "problem": "You are given three small, synthetic potential energy surface (PES) datasets intended to probe electron correlation with an emphasis on static and dynamic components. Your task is to implement, in code, a principled energy-decomposition and PES-error analysis grounded in standard definitions, and to evaluate practical diagnostics that flag multi-reference character. All energies are to be handled in Hartree (atomic units). Your program must compute, for each dataset, the requested metrics and aggregate the results across all datasets into a single required output format as specified at the end. All floating-point answers must be rounded to six decimal places and expressed in Hartree where applicable.\n\nFundamental bases and core definitions:\n- The Born–Oppenheimer potential energy surface is the function $E(R)$ of nuclear geometry $R$ arising from the electronic ground-state solution of the electronic Schrödinger equation. For a given electronic Hamiltonian and basis, let $E_{\\mathrm{ref}}(R)$ denote a high-accuracy reference energy (e.g., Full Configuration Interaction (FCI)), $E_{\\mathrm{HF}}(R)$ the Hartree–Fock (HF) energy, and $E_{\\mathrm{MP2}}(R)$ the Møller–Plesset second-order perturbation theory (MP2) energy.\n- The correlation energy at geometry $R$ with respect to Hartree–Fock is defined as $E_{\\mathrm{corr}}(R) = E_{\\mathrm{ref}}(R) - E_{\\mathrm{HF}}(R)$.\n- To obtain a pragmatic decomposition into a dynamic component and a static component, assume the following:\n  1. The MP2 correlation magnitude approximates the dynamic component when single-reference assumptions hold. Define $E_{\\mathrm{corr}}^{(2)}(R) = E_{\\mathrm{MP2}}(R) - E_{\\mathrm{HF}}(R)$.\n  2. The dynamic correlation estimate is constrained not to exceed the reference correlation magnitude in absolute value. Define\n     $$E_{\\mathrm{dyn}}(R) = \\operatorname{sign}\\!\\big(E_{\\mathrm{corr}}(R)\\big)\\,\\min\\!\\left(\\left|E_{\\mathrm{corr}}(R)\\right|,\\;\\max\\!\\left(0,\\left|E_{\\mathrm{corr}}^{(2)}(R)\\right|\\right)\\right).$$\n  3. The static correlation estimate is the remainder:\n     $$E_{\\mathrm{stat}}(R) = E_{\\mathrm{corr}}(R) - E_{\\mathrm{dyn}}(R).$$\n- A potential energy surface non-parallelity error (NPE) for method $X$ over a discrete set of geometries $\\{R_i\\}_{i=1}^N$ with a fixed reference is defined as\n  $$\\mathrm{NPE}_X = \\max_{i}\\left|E_X(R_i)-E_{\\mathrm{ref}}(R_i)\\right| \\;-\\; \\min_{i}\\left|E_X(R_i)-E_{\\mathrm{ref}}(R_i)\\right|.$$\n- A practical multi-reference diagnostic based on natural orbital occupation numbers (NOONs): given spin-summed occupations $\\{n_j(R)\\}$ satisfying $\\sum_j n_j(R) = N_e$ electrons, define\n  $$M(R) = \\frac{1}{N_e}\\sum_j \\min\\!\\left(n_j(R),\\,2 - n_j(R)\\right).$$\n  Larger $M(R)$ indicates stronger near-degeneracy (static correlation).\n- A complementary single-reference stability diagnostic is the $T_1$ diagnostic from Coupled Cluster theory, here provided as data per geometry. Typical practice flags concern when $\\max_R T_1(R) \\gtrsim 0.02$ for closed-shell molecules; this threshold is adopted here.\n\nRequired computations per dataset:\n- Compute $\\mathrm{NPE}_{\\mathrm{HF}}$ and $\\mathrm{NPE}_{\\mathrm{MP2}}$ in Hartree.\n- Compute the average absolute static and dynamic correlation magnitudes across the geometries, namely\n  $$\\overline{|E_{\\mathrm{stat}}|} = \\frac{1}{N}\\sum_{i=1}^N \\left|E_{\\mathrm{stat}}(R_i)\\right|,\\qquad \\overline{|E_{\\mathrm{dyn}}|} = \\frac{1}{N}\\sum_{i=1}^N \\left|E_{\\mathrm{dyn}}(R_i)\\right|,$$\n  reported in Hartree.\n- Compute a boolean flag needs_multireference that is true if either $\\max_i T_1(R_i) > 0.02$ or $\\max_i M(R_i) > 0.15$, and false otherwise.\n\nTest suite:\nImplement your program to process exactly the following three datasets. Each dataset contains:\n- A set of geometries labeled $R_1,\\dots,R_N$ (labels only; actual distances need not be used).\n- Reference energies $E_{\\mathrm{ref}}(R_i)$, HF energies $E_{\\mathrm{HF}}(R_i)$, and MP2 energies $E_{\\mathrm{MP2}}(R_i)$ in Hartree.\n- Natural orbital occupations per geometry as lists of spin-summed NOONs summing to $N_e$.\n- $T_1$ diagnostic values per geometry (dimensionless).\n- The total number of electrons $N_e$ (an integer).\n\nDataset A (two-electron diatomic-like scan):\n- $E_{\\mathrm{ref}}$: $[-0.90,\\,-1.1746,\\,-1.1400,\\,-1.0300,\\,-1.0000]$.\n- $E_{\\mathrm{HF}}$: $[-0.88,\\,-1.1167,\\,-1.0900,\\,-0.9850,\\,-0.9500]$.\n- $E_{\\mathrm{MP2}}$: $[-0.8980,\\,-1.1697,\\,-1.1380,\\,-0.9950,\\,-0.9510]$.\n- NOONs per geometry:\n  - $[1.99,\\,0.01]$,\n  - $[1.90,\\,0.10]$,\n  - $[1.80,\\,0.20]$,\n  - $[1.20,\\,0.80]$,\n  - $[1.00,\\,1.00]$.\n- $T_1$: $[0.005,\\,0.010,\\,0.015,\\,0.030,\\,0.040]$.\n- $N_e = 2$.\n\nDataset B (two-electron weakly correlated scan):\n- $E_{\\mathrm{ref}}$: $[-1.05,\\,-1.10,\\,-1.08]$.\n- $E_{\\mathrm{HF}}$: $[-1.03,\\,-1.08,\\,-1.06]$.\n- $E_{\\mathrm{MP2}}$: $[-1.049,\\,-1.099,\\,-1.079]$.\n- NOONs per geometry:\n  - $[1.98,\\,0.02]$,\n  - $[1.98,\\,0.02]$,\n  - $[1.98,\\,0.02]$.\n- $T_1$: $[0.005,\\,0.006,\\,0.005]$.\n- $N_e = 2$.\n\nDataset C (two-electron edge case with small correlation and MP2 overshoot):\n- $E_{\\mathrm{ref}}$: $[-0.700,\\,-0.720,\\,-0.710,\\,-0.705]$.\n- $E_{\\mathrm{HF}}$: $[-0.698,\\,-0.718,\\,-0.708,\\,-0.703]$.\n- $E_{\\mathrm{MP2}}$: $[-0.701,\\,-0.724,\\,-0.713,\\,-0.707]$.\n- NOONs per geometry:\n  - $[1.99,\\,0.01]$,\n  - $[1.99,\\,0.01]$,\n  - $[1.99,\\,0.01]$,\n  - $[1.99,\\,0.01]$.\n- $T_1$: $[0.004,\\,0.005,\\,0.004,\\,0.005]$.\n- $N_e = 2$.\n\nOutput specification:\n- For each dataset, produce a list of five elements in the following order:\n  1. $\\mathrm{NPE}_{\\mathrm{HF}}$ (float, Hartree, rounded to six decimal places).\n  2. $\\mathrm{NPE}_{\\mathrm{MP2}}$ (float, Hartree, rounded to six decimal places).\n  3. $\\overline{|E_{\\mathrm{stat}}|}$ (float, Hartree, rounded to six decimal places).\n  4. $\\overline{|E_{\\mathrm{dyn}}|}$ (float, Hartree, rounded to six decimal places).\n  5. needs_multireference (boolean).\n- Your program should produce a single line of output containing the results as a comma-separated list of the three per-dataset lists enclosed in square brackets (for example, \"[[...],[...],[...]]\"). All floating-point outputs must be expressed in Hartree and rounded to six decimal places. Angles are not used. Do not print any additional text.", "solution": "The problem statement has been critically examined and is determined to be valid. It is a well-posed, scientifically grounded problem in computational quantum chemistry. It provides explicit mathematical definitions and complete datasets for a series of calculations. The task is to implement these calculations and produce results in a specified format. No logical contradictions, missing information, or scientific inaccuracies were found.\n\nThe solution requires the implementation of a computational protocol to analyze three synthetic potential energy surface (PES) datasets. The analysis centers on quantifying electron correlation effects, method performance, and diagnostics for multi-reference character. The procedure will be executed for each dataset, and the results will be aggregated.\n\nThe computational steps are as follows, adhering strictly to the provided definitions. For a given dataset comprising $N$ geometries $\\{R_i\\}_{i=1}^N$, we are given the reference energies $E_{\\mathrm{ref}}(R_i)$, Hartree-Fock energies $E_{\\mathrm{HF}}(R_i)$, Møller-Plesset second-order (MP2) energies $E_{\\mathrm{MP2}}(R_i)$, natural orbital occupation numbers (NOONs) $\\{n_j(R_i)\\}$, and $T_1$ diagnostic values $T_1(R_i)$.\n\nFirst, we compute several per-geometry quantities for each point $R_i$:\n1.  The total correlation energy, defined as the difference between the exact reference energy and the mean-field Hartree-Fock energy:\n    $$E_{\\mathrm{corr}}(R_i) = E_{\\mathrm{ref}}(R_i) - E_{\\mathrm{HF}}(R_i)$$\n2.  The MP2 correlation energy, which serves as a pragmatic estimate for the dynamic correlation:\n    $$E_{\\mathrm{corr}}^{(2)}(R_i) = E_{\\mathrm{MP2}}(R_i) - E_{\\mathrm{HF}}(R_i)$$\n3.  The dynamic correlation energy, $E_{\\mathrm{dyn}}(R_i)$, is defined by a constrained formula that prevents the magnitude of the MP2 estimate from unphysically exceeding the true correlation energy magnitude:\n    $$E_{\\mathrm{dyn}}(R_i) = \\operatorname{sign}\\!\\big(E_{\\mathrm{corr}}(R_i)\\big)\\,\\min\\!\\left(\\left|E_{\\mathrm{corr}}(R_i)\\right|,\\;\\max\\!\\left(0,\\left|E_{\\mathrm{corr}}^{(2)}(R_i)\\right|\\right)\\right)$$\n    The $\\max(0, \\dots)$ term ensures the dynamic correlation estimate is non-negative in magnitude, as is physically required. The $\\min(\\dots)$ term correctly handles cases where MP2 overestimates the correlation energy.\n4.  The static correlation energy, $E_{\\mathrm{stat}}(R_i)$, is defined as the remainder of the total correlation energy after the dynamic component has been subtracted:\n    $$E_{\\mathrm{stat}}(R_i) = E_{\\mathrm{corr}}(R_i) - E_{\\mathrm{dyn}}(R_i)$$\n    This component captures effects from near-degeneracy of electronic states, which are poorly described by single-reference methods like Hartree-Fock and MP2.\n5.  The multi-reference diagnostic $M(R_i)$, which quantifies the degree of static correlation character from the deviation of NOONs from integer values ($0$ or $2$):\n    $$M(R_i) = \\frac{1}{N_e}\\sum_j \\min\\!\\left(n_j(R_i),\\,2 - n_j(R_i)\\right)$$\n    where $N_e$ is the total number of electrons.\n\nNext, we compute the required metrics that characterize the entire PES for a given method or property:\n1.  The Non-Parallelity Error (NPE) for a method $X \\in \\{\\mathrm{HF}, \\mathrm{MP2}\\}$. This metric measures the non-uniformity of the error of a method across the PES, which is often more critical than the average error itself. It is defined as:\n    $$\\mathrm{NPE}_X = \\max_{i}\\left|E_X(R_i)-E_{\\mathrm{ref}}(R_i)\\right| \\;-\\; \\min_{i}\\left|E_X(R_i)-E_{\\mathrm{ref}}(R_i)\\right|$$\n    We will compute $\\mathrm{NPE}_{\\mathrm{HF}}$ and $\\mathrm{NPE}_{\\mathrm{MP2}}$.\n2.  The average absolute static and dynamic correlation energies, which provide an overall measure of the importance of these effects across the PES:\n    $$\\overline{|E_{\\mathrm{stat}}|} = \\frac{1}{N}\\sum_{i=1}^N \\left|E_{\\mathrm{stat}}(R_i)\\right|$$\n    $$\\overline{|E_{\\mathrm{dyn}}|} = \\frac{1}{N}\\sum_{i=1}^N \\left|E_{\\mathrm{dyn}}(R_i)\\right|$$\n3.  A boolean flag, `needs_multireference`, to indicate significant multi-reference character. This flag is set to true if either the maximum $T_1$ diagnostic exceeds its typical threshold or the maximum $M(R)$ diagnostic exceeds its threshold:\n    $$\\text{needs\\_multireference} = (\\max_i T_1(R_i) > 0.02) \\lor (\\max_i M(R_i) > 0.15)$$\n\nThe implementation will be carried out in Python, leveraging the `numpy` library for efficient vectorized operations on the energy arrays. A single function will process each dataset by sequentially applying the formulae above. The resulting floating-point values will be rounded to six decimal places, and the final output will be formatted into a single string as specified. This rigorous, step-wise application of the defined principles ensures a correct and reproducible solution.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to process all datasets and print the final result.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Dataset A\n        {\n            \"name\": \"A\",\n            \"E_ref\": np.array([-0.90, -1.1746, -1.1400, -1.0300, -1.0000]),\n            \"E_HF\":  np.array([-0.88, -1.1167, -1.0900, -0.9850, -0.9500]),\n            \"E_MP2\": np.array([-0.8980, -1.1697, -1.1380, -0.9950, -0.9510]),\n            \"noons\": [\n                [1.99, 0.01], [1.90, 0.10], [1.80, 0.20], \n                [1.20, 0.80], [1.00, 1.00]\n            ],\n            \"T1\": np.array([0.005, 0.010, 0.015, 0.030, 0.040]),\n            \"Ne\": 2\n        },\n        # Dataset B\n        {\n            \"name\": \"B\",\n            \"E_ref\": np.array([-1.05, -1.10, -1.08]),\n            \"E_HF\":  np.array([-1.03, -1.08, -1.06]),\n            \"E_MP2\": np.array([-1.049, -1.099, -1.079]),\n            \"noons\": [\n                [1.98, 0.02], [1.98, 0.02], [1.98, 0.02]\n            ],\n            \"T1\": np.array([0.005, 0.006, 0.005]),\n            \"Ne\": 2\n        },\n        # Dataset C\n        {\n            \"name\": \"C\",\n            \"E_ref\": np.array([-0.700, -0.720, -0.710, -0.705]),\n            \"E_HF\":  np.array([-0.698, -0.718, -0.708, -0.703]),\n            \"E_MP2\": np.array([-0.701, -0.724, -0.713, -0.707]),\n            \"noons\": [\n                [1.99, 0.01], [1.99, 0.01], [1.99, 0.01], [1.99, 0.01]\n            ],\n            \"T1\": np.array([0.004, 0.005, 0.004, 0.005]),\n            \"Ne\": 2\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        result = process_dataset(case)\n        results.append(result)\n\n    # Format each individual result list into a string '[e1,e2,...]'\n    # This is done to ensure correct rounding and no spaces.\n    formatted_results = []\n    for res_list in results:\n        str_elements = [\n            f\"{res_list[0]:.6f}\",\n            f\"{res_list[1]:.6f}\",\n            f\"{res_list[2]:.6f}\",\n            f\"{res_list[3]:.6f}\",\n            str(res_list[4]).lower()\n        ]\n        formatted_results.append(f\"[{','.join(str_elements)}]\")\n    \n    # Final print statement in the exact required format '[[...],[...]]'\n    print(f\"[{','.join(formatted_results)}]\")\n\ndef process_dataset(data: dict) -> list:\n    \"\"\"\n    Computes all required metrics for a single dataset.\n    \n    Args:\n        data: A dictionary containing all data for one PES scan.\n\n    Returns:\n        A list of the 5 computed metrics in the specified order.\n    \"\"\"\n    E_ref = data[\"E_ref\"]\n    E_HF = data[\"E_HF\"]\n    E_MP2 = data[\"E_MP2\"]\n    noons_list = data[\"noons\"]\n    T1 = data[\"T1\"]\n    Ne = data[\"Ne\"]\n\n    # --- Per-geometry calculations ---\n    \n    # Correlation energies\n    E_corr = E_ref - E_HF\n    E_corr_2 = E_MP2 - E_HF\n\n    # Dynamic and static correlation with constraints\n    E_dyn_abs = np.minimum(np.abs(E_corr), np.maximum(0, np.abs(E_corr_2)))\n    E_dyn = np.sign(E_corr) * E_dyn_abs\n    E_stat = E_corr - E_dyn\n\n    # M diagnostic\n    M_values = []\n    for noons in noons_list:\n        m_sum = sum(min(n, 2 - n) for n in noons)\n        M_values.append(m_sum / Ne)\n    M = np.array(M_values)\n\n    # --- Dataset-wide metrics ---\n    \n    # Non-Parallelity Error (NPE)\n    abs_err_HF = np.abs(E_HF - E_ref)\n    npe_hf = np.max(abs_err_HF) - np.min(abs_err_HF)\n    \n    abs_err_MP2 = np.abs(E_MP2 - E_ref)\n    npe_mp2 = np.max(abs_err_MP2) - np.min(abs_err_MP2)\n\n    # Average absolute static and dynamic correlation\n    avg_abs_E_stat = np.mean(np.abs(E_stat))\n    avg_abs_E_dyn = np.mean(np.abs(E_dyn))\n\n    # Multi-reference flag\n    needs_multireference = (np.max(T1) > 0.02) or (np.max(M) > 0.15)\n    \n    return [\n        npe_hf,\n        npe_mp2,\n        avg_abs_E_stat,\n        avg_abs_E_dyn,\n        needs_multireference\n    ]\n\nif __name__ == \"__main__\":\n    solve()\n\n```", "id": "2888416"}]}