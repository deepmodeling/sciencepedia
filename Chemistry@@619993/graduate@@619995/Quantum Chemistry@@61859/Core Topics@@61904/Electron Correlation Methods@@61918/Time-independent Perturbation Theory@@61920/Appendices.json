{"hands_on_practices": [{"introduction": "Before embarking on complex calculations, a skilled physicist first analyzes the symmetries of the system. This practice illustrates the power of such an analysis by using parity arguments to establish a crucial selection rule. You will demonstrate that for a system with inversion symmetry, a perturbation with odd parity cannot shift the energy of a non-degenerate state in the first order, a result that holds true regardless of the detailed form of the wavefunctions or the potential [@problem_id:1212254].", "problem": "Consider a spinless particle in three dimensions described by the unperturbed Hamiltonian  \n$$H_0 = -\\frac{\\hbar^2}{2m}\\nabla^2 + U(\\mathbf{r}),$$  \nwhere the potential $U(\\mathbf{r})$ is invariant under spatial inversion (parity), $U(-\\mathbf{r}) = U(\\mathbf{r})$. Thus each nondegenerate eigenstate $|n\\rangle$ of $H_0$ satisfies  \n$$H_0|n\\rangle = E_n^{(0)}|n\\rangle,\\qquad P|n\\rangle = \\pi_n|n\\rangle,\\quad \\pi_n=\\pm1,$$  \nwhere $P$ is the parity operator acting as $(P\\psi)(\\mathbf{r})=\\psi(-\\mathbf{r})$.  \n\nNow introduce a small perturbation  \n$$V(\\mathbf{r}),\\quad V(-\\mathbf{r})=-V(\\mathbf{r}),$$  \nwhich is odd under parity.Using first-order nondegenerate perturbation theory, determine whether the first-order energy shift  \n$$E_n^{(1)}=\\langle n|V|n\\rangle$$  \nis always zero. Answer with 1 (true) or 0 (false).", "solution": "The first-order energy shift is given by:\n\n$$\nE_n^{(1)} = \\langle n | V | n \\rangle\n$$\n\nwhere $ |n\\rangle $ is a nondegenerate eigenstate of $ H_0 $ with definite parity $ P|n\\rangle = \\pi_n |n\\rangle $ and $ \\pi_n = \\pm 1 $. The perturbation $ V $ is odd under parity, so $ V(-\\mathbf{r}) = -V(\\mathbf{r}) $, which implies the operator relation:\n\n$$\nP V P^{-1} = -V\n$$\n\nSince $ P $ is unitary and Hermitian ($ P^\\dagger = P $) and satisfies $ P^2 = I $, we have $ P^{-1} = P $. Thus:\n\n$$\nP V P = -V\n$$\n\nRearranging gives:\n\n$$\nV = -PVP\n$$\n\nNow evaluate $ E_n^{(1)} $:\n\n$$\nE_n^{(1)} = \\langle n | V | n \\rangle = \\langle n | (-PVP) | n \\rangle = - \\langle n | PVP | n \\rangle\n$$\n\nSince the parity operator $P$ is Hermitian ($P^\\dagger = P$), we can write:\n\n$$\nE_n^{(1)} = - \\langle Pn | V | Pn \\rangle\n$$\n\nUsing the fact that $|n\\rangle$ is an eigenstate of $P$: $P|n\\rangle = \\pi_n |n\\rangle$:\n\n$$\nE_n^{(1)} = - \\langle \\pi_n n | V | \\pi_n n \\rangle = - (\\pi_n^* \\pi_n) \\langle n | V | n \\rangle\n$$\n\nSince $\\pi_n$ is real ($\\pm 1$), $\\pi_n^* = \\pi_n$, and $\\pi_n^2 = 1$:\n\n$$\nE_n^{(1)} = - (1) \\langle n | V | n \\rangle = -E_n^{(1)}\n$$\n\nTherefore:\n\n$$\n2 E_n^{(1)} = 0 \\quad \\Rightarrow \\quad E_n^{(1)} = 0\n$$\n\nHence, for any nondegenerate eigenstate $ |n\\rangle $, the first-order energy shift is always zero.", "answer": "$$ \\boxed{1} $$", "id": "1212254"}, {"introduction": "While symmetry can reveal when energy shifts are zero, many physical phenomena arise from perturbations that lift degeneracies. This exercise provides a concrete application of degenerate perturbation theory, a cornerstone for understanding effects like the Stark and Zeeman splittings. You will calculate the energy splitting of the first excited state of a particle in a two-dimensional box by constructing and diagonalizing the Hamiltonian matrix in the degenerate subspace [@problem_id:222600].", "problem": "A particle of mass $m$ is confined to a two-dimensional infinite square well with potential $V(x,y)$. The potential is zero for $0  x  L$ and $0  y  L$, and infinite otherwise. The unperturbed Hamiltonian of the system is $H_0 = -\\frac{\\hbar^2}{2m}\\left(\\frac{\\partial^2}{\\partial x^2} + \\frac{\\partial^2}{\\partial y^2}\\right)$. Its eigenfunctions and eigenvalues are given by $\\psi^{(0)}_{n_x, n_y}(x,y) = \\frac{2}{L} \\sin\\left(\\frac{n_x \\pi x}{L}\\right) \\sin\\left(\\frac{n_y \\pi y}{L}\\right)$ and $E^{(0)}_{n_x, n_y} = \\frac{\\pi^2 \\hbar^2}{2mL^2}(n_x^2 + n_y^2)$, where $n_x, n_y$ are positive integers.\n\nThe system is subjected to a weak perturbation described by the Hamiltonian $H' = \\lambda \\delta(x-y)$, where $\\lambda$ is a small real constant and $\\delta(z)$ is the Dirac delta function.\n\nUsing first-order degenerate perturbation theory, determine the energy splitting of the first excited energy level of the system.", "solution": "1. Unperturbed degenerate states:  \n   $$\\psi_{1,2}^{(0)}(x,y)=\\frac{2}{L}\\sin\\!\\bigl(\\tfrac{\\pi x}{L}\\bigr)\\sin\\!\\bigl(\\tfrac{2\\pi y}{L}\\bigr),\\quad\n     \\psi_{2,1}^{(0)}(x,y)=\\frac{2}{L}\\sin\\!\\bigl(\\tfrac{2\\pi x}{L}\\bigr)\\sin\\!\\bigl(\\tfrac{\\pi y}{L}\\bigr).$$  \n\n2. Perturbation matrix elements in this basis:  \n   $$H'_{ij}=\\lambda\\iint_{0}^{L}\\psi_i^{(0)}(x,y)\\,\\delta(x-y)\\,\\psi_j^{(0)}(x,y)\\,dx\\,dy\n             =\\lambda\\int_{0}^{L}\\psi_i^{(0)}(x,x)\\,\\psi_j^{(0)}(x,x)\\,dx.$$  \n\n3. Evaluate the diagonal and off-diagonal elements. For instance, for $H'_{11}$:  \n   $$\\psi_{1,2}^{(0)}(x,x) = \\frac{2}{L}\\sin\\!\\tfrac{\\pi x}{L}\\sin\\!\\tfrac{2\\pi x}{L}$$\n   $$H'_{11} = \\lambda \\int_0^L \\left(\\frac{2}{L}\\sin\\!\\tfrac{\\pi x}{L}\\sin\\!\\tfrac{2\\pi x}{L}\\right)^2 dx$$\n   The integral evaluates to:\n   $$\\int_{0}^{L}\\sin^{2}\\!\\tfrac{\\pi x}{L}\\,\\sin^{2}\\!\\tfrac{2\\pi x}{L}\\,dx = \\frac{L}{4}$$\n   Using the identity $\\sin^{2}A\\,\\sin^{2}B = \\frac{1}{4}\\bigl[1-\\cos2A-\\cos2B+\\tfrac12(\\cos(2A+2B)+\\cos(2A-2B))\\bigr]$, where the integral over all cosine terms on $[0,L]$ is zero.\n   So, $H'_{11} = \\lambda \\frac{4}{L^2} \\frac{L}{4} = \\frac{\\lambda}{L}$.\n   By symmetry, $H'_{22} = H'_{11}$.\n   For the off-diagonal element $H'_{12}$:\n   $$H'_{12} = \\lambda \\int_0^L \\psi_{1,2}^{(0)}(x,x)\\psi_{2,1}^{(0)}(x,x) dx = \\lambda \\int_0^L \\left(\\frac{2}{L}\\sin\\!\\tfrac{\\pi x}{L}\\sin\\!\\tfrac{2\\pi x}{L}\\right) \\left(\\frac{2}{L}\\sin\\!\\tfrac{2\\pi x}{L}\\sin\\!\\tfrac{\\pi x}{L}\\right) dx = H'_{11}$$\n\n4. Perturbation matrix in the $\\{\\psi_{1,2},\\psi_{2,1}\\}$ basis:  \n   $$H' = \\frac{\\lambda}{L}\n     \\begin{pmatrix}11\\\\11\\end{pmatrix}.$$  \n\n5. The eigenvalues of this matrix are the first-order energy shifts. The characteristic equation is $(1-E')^2 - 1 = 0$, giving eigenvalues $E' = 0$ and $E' = 2$.\n   The energy shifts are thus $E^{(1)}_{\\pm}=\\{0,\\;2\\lambda/L\\}$.\n   The splitting is the difference between these shifts:\n   $$\\Delta E = \\frac{2\\lambda}{L}.$$", "answer": "$$\\boxed{\\frac{2\\lambda}{L}}$$", "id": "222600"}, {"introduction": "This advanced practice bridges abstract theory with computational chemistry by challenging you to implement different perturbation formalisms from first principles. You will derive the expressions for both Rayleigh-Schrödinger and Brillouin-Wigner perturbation theory for a simple two-state model. By comparing their numerical results against an exact solution, you will gain tangible insight into their convergence properties and practical limitations, particularly in the challenging case of near-degeneracy [@problem_id:2933735].", "problem": "Consider a two-state electronic model in atomic units (Hartree atomic system) represented by a time-independent Hamiltonian partitioned as $H(\\lambda) = H_0 + \\lambda V$, where $H_0$ is exactly solvable and $V$ is a small perturbation scaled by the dimensionless parameter $\\lambda$. Let the unperturbed Hamiltonian and perturbation, in the unperturbed eigenbasis $\\{\\lvert 1 \\rangle, \\lvert 2 \\rangle\\}$ of $H_0$, be given by:\n- $H_0 = \\mathrm{diag}(E_1, E_2)$ with $E_1  E_2$\n- $V = \\begin{pmatrix} 0  v \\\\ v  0 \\end{pmatrix}$ with real $v$\nand take $\\lambda = 1$ for all numerical evaluations. This is a near-degenerate model when $\\lvert E_1 - E_2 \\rvert$ is small compared to $\\lvert v \\rvert$.\n\nYour task is to implement, from first principles of time-independent perturbation theory, numerical procedures that:\n- Construct the exact Hamiltonian $H(\\lambda)$ for each test case and obtain its lower exact eigenvalue $E_{\\mathrm{exact,lower}}$ via exact diagonalization,\n- Derive and implement the non-degenerate Rayleigh–Schrödinger (RS) perturbation theory energy approximation to second order in $\\lambda$ for the state $\\lvert 1 \\rangle$ using the basis defined above, and evaluate it at $\\lambda = 1$ to produce $E_{\\mathrm{RS}}$,\n- Derive and implement the Brillouin–Wigner (BW) perturbation theory self-consistent energy equation for the same state and solve it to obtain the BW energy $E_{\\mathrm{BW,lower}}$ corresponding to the lower root,\n- Quantify the deviation of each approximation from exact diagonalization by computing the absolute errors $\\lvert E_{\\mathrm{RS}} - E_{\\mathrm{exact,lower}} \\rvert$ and $\\lvert E_{\\mathrm{BW,lower}} - E_{\\mathrm{exact,lower}} \\rvert$.\n\nBase your derivations strictly on the time-independent Schrödinger equation $H(\\lambda)\\lvert \\psi(\\lambda) \\rangle = E(\\lambda)\\lvert \\psi(\\lambda) \\rangle$, the definition of perturbative expansions in powers of $\\lambda$, linear algebra properties of Hermitian matrices, and projection of the Schrödinger equation onto the unperturbed eigenbasis. Do not assume any pre-given perturbation theory formulas; instead, reason from these fundamentals to obtain the working expressions needed for implementation.\n\nUse atomic units where all energies, including $E_1$, $E_2$, $v$, and any energy-like outputs, must be expressed in Hartree. Report absolute errors in Hartree. No angles are involved.\n\nImplement your program to evaluate the following test suite of parameter triples $(E_1, E_2, v)$:\n- Test $1$: $(E_1, E_2, v) = (-0.05, 0.05, 0.02)$,\n- Test $2$: $(E_1, E_2, v) = (-0.005, 0.005, 0.02)$,\n- Test $3$: $(E_1, E_2, v) = (-0.5, 0.5, 0.02)$,\n- Test $4$: $(E_1, E_2, v) = (-0.1, 0.1, 0.0)$,\n- Test $5$: $(E_1, E_2, v) = (0.10, 0.11, 0.003)$,\n- Test $6$: $(E_1, E_2, v) = (0.0, 10^{-6}, 5\\times 10^{-4})$.\n\nFor each test case, your program must output a list of two floats $[\\lvert E_{\\mathrm{RS}} - E_{\\mathrm{exact,lower}} \\rvert, \\lvert E_{\\mathrm{BW,lower}} - E_{\\mathrm{exact,lower}} \\rvert]$ in Hartree. Aggregate the results from all test cases into a single line formatted as a comma-separated list enclosed in square brackets, where each element is the two-float list for one test case. For example, the output must look like $[[x_1,y_1],[x_2,y_2],\\ldots,[x_6,y_6]]$ with no additional whitespace or text.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[[\\text{result}_{1,1},\\text{result}_{1,2}],[\\text{result}_{2,1},\\text{result}_{2,2}],\\ldots]$).", "solution": "The problem presented is a standard, well-posed exercise in quantum-mechanical perturbation theory. We shall proceed with its validation and subsequent solution.\n\n**Problem Validation**\n\nFirst, we must extract the givens. The problem defines a two-state system governed by the Hamiltonian $H(\\lambda) = H_0 + \\lambda V$. The unperturbed Hamiltonian $H_0$ and the perturbation $V$ are given in the basis of unperturbed eigenstates, $\\{\\lvert 1 \\rangle, \\lvert 2 \\rangle\\}$, as:\n$$\nH_0 = \\begin{pmatrix} E_1  0 \\\\ 0  E_2 \\end{pmatrix}, \\quad E_1  E_2\n$$\n$$\nV = \\begin{pmatrix} 0  v \\\\ v  0 \\end{pmatrix}, \\quad v \\in \\mathbb{R}\n$$\nThe perturbation parameter $\\lambda$ is set to $1$ for all numerical calculations. The task is to find the lower exact eigenvalue, the second-order Rayleigh-Schrödinger (RS) energy, and the Brillouin-Wigner (BW) energy for the state originating from $\\lvert 1 \\rangle$, and to compute the absolute errors of the approximations. All derivations must be from first principles.\n\nThe problem is scientifically sound, as it is based on the time-independent Schrödinger equation for a two-level system, a cornerstone of quantum mechanics. It is well-posed, providing all necessary matrices and parameters to find a unique solution. The language is objective and precise. The problem is complete, consistent, and computationally feasible. It does not violate any of the validation criteria. Therefore, the problem is deemed valid. We now proceed to derive the required expressions.\n\n**1. Exact Eigenvalues**\n\nThe full Hamiltonian for $\\lambda=1$ is $H = H_0 + V$. In the given basis, its matrix representation is:\n$$\nH = \\begin{pmatrix} E_1  v \\\\ v  E_2 \\end{pmatrix}\n$$\nThe eigenvalues $E$ are the roots of the characteristic equation $\\det(H - E I) = 0$:\n$$\n\\det \\begin{pmatrix} E_1 - E  v \\\\ v  E_2 - E \\end{pmatrix} = 0\n$$\n$$\n(E_1 - E)(E_2 - E) - v^2 = 0\n$$\n$$\nE^2 - (E_1 + E_2)E + E_1 E_2 - v^2 = 0\n$$\nThis is a quadratic equation for $E$. Applying the quadratic formula, we find the two exact eigenvalues:\n$$\nE_{\\pm} = \\frac{(E_1 + E_2) \\pm \\sqrt{(E_1 + E_2)^2 - 4(E_1 E_2 - v^2)}}{2}\n$$\n$$\nE_{\\pm} = \\frac{(E_1 + E_2) \\pm \\sqrt{E_1^2 + 2E_1E_2 + E_2^2 - 4E_1E_2 + 4v^2}}{2}\n$$\n$$\nE_{\\pm} = \\frac{(E_1 + E_2) \\pm \\sqrt{(E_1 - E_2)^2 + 4v^2}}{2}\n$$\nThe problem requires the lower exact eigenvalue, which we denote $E_{\\mathrm{exact,lower}}$. This corresponds to the negative sign in the formula, as the square root term is always non-negative.\n$$\nE_{\\mathrm{exact,lower}} = \\frac{1}{2}\\left( (E_1 + E_2) - \\sqrt{(E_2 - E_1)^2 + 4v^2} \\right)\n$$\nThis expression is exact and will be used as the benchmark for our approximations.\n\n**2. Rayleigh-Schrödinger (RS) Perturbation Theory**\n\nWe start from the time-independent Schrödinger equation $H(\\lambda)\\lvert \\psi(\\lambda) \\rangle = E(\\lambda)\\lvert \\psi(\\lambda) \\rangle$. We expand the energy $E(\\lambda)$ and state $\\lvert \\psi(\\lambda) \\rangle$ as power series in $\\lambda$:\n$$\nE(\\lambda) = E^{(0)} + \\lambda E^{(1)} + \\lambda^2 E^{(2)} + \\mathcal{O}(\\lambda^3)\n$$\n$$\n\\lvert \\psi(\\lambda) \\rangle = \\lvert \\psi^{(0)} \\rangle + \\lambda \\lvert \\psi^{(1)} \\rangle + \\lambda^2 \\lvert \\psi^{(2)} \\rangle + \\mathcal{O}(\\lambda^3)\n$$\nWe are interested in the state that evolves from the unperturbed state $\\lvert 1 \\rangle$. Thus, we set $\\lvert \\psi^{(0)} \\rangle = \\lvert 1 \\rangle$ and $E^{(0)} = E_1$. Substituting the expansions into the Schrödinger equation:\n$$\n(H_0 + \\lambda V)(\\lvert 1 \\rangle + \\lambda \\lvert \\psi^{(1)} \\rangle + \\dots) = (E_1 + \\lambda E^{(1)} + \\lambda^2 E^{(2)} + \\dots)(\\lvert 1 \\rangle + \\lambda \\lvert \\psi^{(1)} \\rangle + \\dots)\n$$\nWe collect terms of the same order in $\\lambda$.\nThe zeroth-order equation, $H_0 \\lvert 1 \\rangle = E_1 \\lvert 1 \\rangle$, is satisfied by definition.\n\nFor the first-order terms ($\\mathcal{O}(\\lambda^1)$):\n$$\nH_0 \\lvert \\psi^{(1)} \\rangle + V \\lvert 1 \\rangle = E_1 \\lvert \\psi^{(1)} \\rangle + E^{(1)} \\lvert 1 \\rangle\n$$\nTo find the first-order energy correction $E^{(1)}$, we project this equation onto $\\langle 1 \\rvert$:\n$$\n\\langle 1 \\rvert H_0 \\lvert \\psi^{(1)} \\rangle + \\langle 1 \\rvert V \\lvert 1 \\rangle = E_1 \\langle 1 \\rvert \\psi^{(1)} \\rangle + E^{(1)} \\langle 1 \\rvert 1 \\rangle\n$$\nSince $H_0$ is Hermitian and $\\langle 1 \\rvert H_0 = E_1 \\langle 1 \\rvert$, the first term on the left becomes $E_1 \\langle 1 \\rvert \\psi^{(1)} \\rangle$. With $\\langle 1 \\rvert 1 \\rangle = 1$, the equation simplifies:\n$$\nE_1 \\langle 1 \\rvert \\psi^{(1)} \\rangle + V_{11} = E_1 \\langle 1 \\rvert \\psi^{(1)} \\rangle + E^{(1)}\n$$\n$$\nE^{(1)} = V_{11}\n$$\nFrom the problem definition, the diagonal elements of $V$ are zero, so $V_{11} = 0$. Thus, $E^{(1)} = 0$.\n\nFor the second-order terms ($\\mathcal{O}(\\lambda^2)$):\n$$\nH_0 \\lvert \\psi^{(2)} \\rangle + V \\lvert \\psi^{(1)} \\rangle = E_1 \\lvert \\psi^{(2)} \\rangle + E^{(1)} \\lvert \\psi^{(1)} \\rangle + E^{(2)} \\lvert 1 \\rangle\n$$\nProjecting onto $\\langle 1 \\rvert$:\n$$\n\\langle 1 \\rvert H_0 \\lvert \\psi^{(2)} \\rangle + \\langle 1 \\rvert V \\lvert \\psi^{(1)} \\rangle = E_1 \\langle 1 \\rvert \\psi^{(2)} \\rangle + E^{(1)} \\langle 1 \\rvert \\psi^{(1)} \\rangle + E^{(2)} \\langle 1 \\rvert 1 \\rangle\n$$\nThe first terms on both sides cancel, leaving:\n$$\nE^{(2)} = \\langle 1 \\rvert V \\lvert \\psi^{(1)} \\rangle - E^{(1)} \\langle 1 \\rvert \\psi^{(1)} \\rangle\n$$\nSince $E^{(1)} = 0$, this simplifies to $E^{(2)} = \\langle 1 \\rvert V \\lvert \\psi^{(1)} \\rangle$. We must first find the first-order wave function correction $\\lvert \\psi^{(1)} \\rangle$. From the first-order equation, rearranged:\n$$\n(H_0 - E_1) \\lvert \\psi^{(1)} \\rangle = (E^{(1)} - V) \\lvert 1 \\rangle = -V \\lvert 1 \\rangle\n$$\nWe expand $\\lvert \\psi^{(1)} \\rangle$ in the unperturbed basis: $\\lvert \\psi^{(1)} \\rangle = c_{11} \\lvert 1 \\rangle + c_{12} \\lvert 2 \\rangle$. The standard convention in RS theory sets $\\langle 1 \\rvert \\psi^{(1)} \\rangle = 0$, which implies $c_{11} = 0$. So, $\\lvert \\psi^{(1)} \\rangle = c_{12} \\lvert 2 \\rangle$. Projecting the equation for $\\lvert \\psi^{(1)} \\rangle$ onto $\\langle 2 \\rvert$:\n$$\n\\langle 2 \\rvert (H_0 - E_1) (c_{12} \\lvert 2 \\rangle) = -\\langle 2 \\rvert V \\lvert 1 \\rangle\n$$\n$$\nc_{12} \\langle 2 \\rvert (E_2 - E_1) \\lvert 2 \\rangle = -V_{21}\n$$\n$$\nc_{12} (E_2 - E_1) = -v\n$$\n$$\nc_{12} = \\frac{-v}{E_2 - E_1}\n$$\nSo, $\\lvert \\psi^{(1)} \\rangle = \\frac{-v}{E_2 - E_1} \\lvert 2 \\rangle$. Now we can compute $E^{(2)}$:\n$$\nE^{(2)} = \\langle 1 \\rvert V \\left( \\frac{-v}{E_2 - E_1} \\lvert 2 \\rangle \\right) = \\frac{-v}{E_2 - E_1} \\langle 1 \\rvert V \\lvert 2 \\rangle = \\frac{-v}{E_2 - E_1} V_{12}\n$$\nSince $V_{12} = v$, we have:\n$$\nE^{(2)} = -\\frac{v^2}{E_2 - E_1}\n$$\nThe RS energy approximated to second order is $E_{\\mathrm{RS}} = E^{(0)} + \\lambda E^{(1)} + \\lambda^2 E^{(2)}$. Evaluating at $\\lambda = 1$:\n$$\nE_{\\mathrm{RS}} = E_1 - \\frac{v^2}{E_2 - E_1}\n$$\n\n**3. Brillouin-Wigner (BW) Perturbation Theory**\n\nThe BW formulation avoids expanding the energy $E$ inside the equations. We start again with the Schrödinger equation, setting $\\lambda=1$: $(H_0 + V) \\lvert \\psi \\rangle = E \\lvert \\psi \\rangle$. We can write this as:\n$$\n(E - H_0) \\lvert \\psi \\rangle = V \\lvert \\psi \\rangle\n$$\nLet us represent the unknown state $\\lvert \\psi \\rangle$ in the unperturbed basis: $\\lvert \\psi \\rangle = c_1 \\lvert 1 \\rangle + c_2 \\lvert 2 \\rangle$. Substituting this into the matrix form of the Schrödinger equation:\n$$\n\\begin{pmatrix} E_1  v \\\\ v  E_2 \\end{pmatrix} \\begin{pmatrix} c_1 \\\\ c_2 \\end{pmatrix} = E \\begin{pmatrix} c_1 \\\\ c_2 \\end{pmatrix}\n$$\nThis gives a system of two linear equations:\n$$\nE_1 c_1 + v c_2 = E c_1  \\quad \\implies \\quad (E - E_1) c_1 = v c_2\n$$\n$$\nv c_1 + E_2 c_2 = E c_2  \\quad \\implies \\quad v c_1 = (E - E_2) c_2\n$$\nBW theory uses intermediate normalization, which for the state evolving from $\\lvert 1 \\rangle$ means we fix its component along $\\lvert 1 \\rangle$ to be unity. That is, we set $c_1 = 1$. The equations become:\n$$\nE - E_1 = v c_2\n$$\n$$\nv = (E - E_2) c_2\n$$\nFrom the second equation, we express $c_2$ as $c_2 = \\frac{v}{E - E_2}$. We then substitute this into the first equation:\n$$\nE - E_1 = v \\left( \\frac{v}{E - E_2} \\right)\n$$\nThis yields the self-consistent equation for the BW energy $E$:\n$$\nE = E_1 + \\frac{v^2}{E - E_2}\n$$\nTo solve for $E$, we rearrange it into a polynomial form:\n$$\n(E - E_1)(E - E_2) = v^2\n$$\n$$\nE^2 - (E_1 + E_2)E + E_1 E_2 - v^2 = 0\n$$\nThis is precisely the same characteristic equation obtained for the exact eigenvalues. The solutions for $E$ in the BW formalism are the exact energies of the system. This is a known result for a two-level system. The problem asks for the lower root, $E_{\\mathrm{BW,lower}}$, which must be equal to $E_{\\mathrm{exact,lower}}$:\n$$\nE_{\\mathrm{BW,lower}} = \\frac{1}{2}\\left( (E_1 + E_2) - \\sqrt{(E_2 - E_1)^2 + 4v^2} \\right)\n$$\n\n**4. Error Calculation**\nThe absolute errors are computed as:\n$$\n\\text{Error}_{\\mathrm{RS}} = \\lvert E_{\\mathrm{RS}} - E_{\\mathrm{exact,lower}} \\rvert\n$$\n$$\n\\text{Error}_{\\mathrm{BW}} = \\lvert E_{\\mathrm{BW,lower}} - E_{\\mathrm{exact,lower}} \\rvert\n$$\nFrom our derivation, it is clear that for this specific problem, $E_{\\mathrm{BW,lower}} = E_{\\mathrm{exact,lower}}$, so $\\text{Error}_{\\mathrm{BW}}$ will be identically zero for all test cases.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes absolute errors for Rayleigh-Schrödinger and Brillouin-Wigner\n    perturbation theories for a two-level system against exact diagonalization.\n    \"\"\"\n    \n    # Test cases are given as tuples (E1, E2, v) in Hartree atomic units.\n    # E1, E2 are unperturbed energies; v is the off-diagonal coupling.\n    test_cases = [\n        (-0.05, 0.05, 0.02),      # Test 1\n        (-0.005, 0.005, 0.02),    # Test 2\n        (-0.5, 0.5, 0.02),        # Test 3\n        (-0.1, 0.1, 0.0),         # Test 4\n        (0.10, 0.11, 0.003),      # Test 5\n        (0.0, 1e-6, 5e-4),        # Test 6\n    ]\n\n    all_results = []\n\n    for case in test_cases:\n        e1, e2, v = case\n\n        # The unperturbed energy difference, delta_e = E2 - E1.\n        delta_e = e2 - e1\n\n        # 1. Calculation of the lower exact eigenvalue from the characteristic equation.\n        # E_exact_lower = 0.5 * ( (e1 + e2) - sqrt((e2 - e1)^2 + 4*v^2) )\n        sqrt_term = np.sqrt(delta_e**2 + 4 * v**2)\n        e_exact_lower = 0.5 * (e1 + e2 - sqrt_term)\n\n        # 2. Calculation of the Rayleigh-Schrödinger energy to second order.\n        # E_RS = E1 - v^2 / (E2 - E1)\n        # This formula is valid as E1 != E2 in all non-trivial test cases.\n        if delta_e == 0:\n            # This case is degenerate and RS theory as formulated diverges.\n            # The problem statement avoids this, but it's good practice.\n            # We can assign infinity to error, but for the given tests this is not hit.\n            e_rs = -np.inf \n        else:\n            e_rs = e1 - (v**2) / delta_e\n\n        # 3. Calculation of the Brillouin-Wigner energy for the lower root.\n        # For a two-level system, the BW self-consistent equation yields a quadratic\n        # equation identical to the exact secular equation. Thus, its roots are the exact energies.\n        e_bw_lower = e_exact_lower\n\n        # 4. Computation of absolute errors for both theories.\n        error_rs = np.abs(e_rs - e_exact_lower)\n        error_bw = np.abs(e_bw_lower - e_exact_lower)  # This is analytically 0.0\n\n        all_results.append([error_rs, error_bw])\n\n    # Format the final output string as a list of lists: [[err1,err2],[err3,err4],...].\n    # The format must be exact, with no whitespace inside the inner brackets.\n    result_str = \"[\" + \",\".join([f\"[{res[0]},{res[1]}]\" for res in all_results]) + \"]\"\n    \n    print(result_str)\n\nsolve()\n```", "id": "2933735"}]}