{"hands_on_practices": [{"introduction": "The Local Density Approximation (LDA) forms the first rung of Jacob's Ladder, providing a foundational but simplified picture of electron exchange and correlation. Its most well-known deficiency is the self-interaction error ($SIE$), where an electron spuriously interacts with its own charge density. This hands-on practice [@problem_id:2890214] offers a chance to get to the heart of this issue by calculating the LDA exchange energy for the hydrogen atom and comparing it to the exact value, thereby quantifying the $SIE$ for the simplest-possible one-electron case.", "problem": "Consider the first rung of Jacob’s ladder of density functional approximations, the Local (Spin) Density Approximation (LSDA), for the exchange energy in Kohn–Sham density functional theory (DFT). The LSDA exchange functional for a general spin density $(n_{\\uparrow},n_{\\downarrow})$ is defined by\n$$\nE_{x}^{\\mathrm{LSDA}}[n_{\\uparrow},n_{\\downarrow}] \\;=\\; -\\frac{3}{4}\\left(\\frac{3}{\\pi}\\right)^{1/3} \\int \\left(n_{\\uparrow}(\\mathbf{r})^{4/3} + n_{\\downarrow}(\\mathbf{r})^{4/3}\\right)\\, d\\mathbf{r}.\n$$\nFor a one-electron system, the spin density is fully polarized, so that $n_{\\uparrow}(\\mathbf{r}) = n(\\mathbf{r})$ and $n_{\\downarrow}(\\mathbf{r})=0$. The exact Kohn–Sham exchange energy for a one-electron system must cancel the classical Coulomb (Hartree) self-interaction, where the Hartree energy is\n$$\nE_{H}[n] \\;=\\; \\frac{1}{2}\\int \\int \\frac{n(\\mathbf{r})\\,n(\\mathbf{r'})}{|\\mathbf{r}-\\mathbf{r'}|}\\, d\\mathbf{r}\\, d\\mathbf{r'}.\n$$\nHence, for a true one-electron density, the exact exchange energy is $E_{x}^{\\mathrm{exact}}[n] = -E_{H}[n]$ and the correlation energy is zero.\n\nTake the hydrogen atom ground-state (one-electron) density in atomic units (Hartree atomic units) as\n$$\nn(\\mathbf{r}) \\;=\\; \\frac{1}{\\pi}\\,\\exp(-2 r),\n$$\nwhere $r = |\\mathbf{r}|$ and the Bohr radius is $a_{0}=1$.\n\nStarting from these definitions, and without introducing any other approximations, carry out the necessary integrals to:\n1) evaluate the LSDA exchange energy $E_{x}^{\\mathrm{LSDA}}[n]$ for the given density, and\n2) quantify the residual exchange self-interaction error by comparing to the exact one-electron exchange, i.e., compute\n$$\n\\Delta_{x} \\;=\\; E_{x}^{\\mathrm{LSDA}}[n] - E_{x}^{\\mathrm{exact}}[n] \\;=\\; E_{x}^{\\mathrm{LSDA}}[n] + E_{H}[n].\n$$\n\nExpress your final answers as exact analytic expressions in hartree. No numerical rounding is required. Provide both requested quantities in your final answer.", "solution": "The task is to compute the LSDA exchange energy, $E_{x}^{\\mathrm{LSDA}}[n]$, and the residual exchange self-interaction error, $\\Delta_{x}$, for the hydrogen atom. We will compute these in sequence.\n\nFirst, we evaluate the LSDA exchange energy $E_{x}^{\\mathrm{LSDA}}[n]$. The problem provides the functional:\n$$\nE_{x}^{\\mathrm{LSDA}}[n_{\\uparrow},n_{\\downarrow}] \\;=\\; -\\frac{3}{4}\\left(\\frac{3}{\\pi}\\right)^{1/3} \\int \\left(n_{\\uparrow}(\\mathbf{r})^{4/3} + n_{\\downarrow}(\\mathbf{r})^{4/3}\\right)\\, d\\mathbf{r}\n$$\nFor a one-electron system such as the hydrogen atom, the spin density is fully polarized. We set $n_{\\uparrow}(\\mathbf{r}) = n(\\mathbf{r})$ and $n_{\\downarrow}(\\mathbf{r}) = 0$. The functional simplifies to:\n$$\nE_{x}^{\\mathrm{LSDA}}[n] \\;=\\; -\\frac{3}{4}\\left(\\frac{3}{\\pi}\\right)^{1/3} \\int n(\\mathbf{r})^{4/3}\\, d\\mathbf{r}\n$$\nThe ground-state density of the hydrogen atom is given in atomic units as:\n$$\nn(\\mathbf{r}) \\;=\\; \\frac{1}{\\pi}\\,\\exp(-2 r)\n$$\nwhere $r=|\\mathbf{r}|$. We raise the density to the power of $4/3$:\n$$\nn(\\mathbf{r})^{4/3} \\;=\\; \\left(\\frac{1}{\\pi}\\,\\exp(-2 r)\\right)^{4/3} \\;=\\; \\frac{1}{\\pi^{4/3}}\\,\\exp\\left(-\\frac{8}{3} r\\right)\n$$\nThe integral is over all space. Since the integrand is spherically symmetric, we can use spherical coordinates and the volume element $d\\mathbf{r} = 4\\pi r^2 dr$:\n$$\n\\int n(\\mathbf{r})^{4/3}\\, d\\mathbf{r} \\;=\\; \\int_0^\\infty \\frac{1}{\\pi^{4/3}}\\,\\exp\\left(-\\frac{8}{3} r\\right) (4\\pi r^2)\\,dr \\;=\\; \\frac{4\\pi}{\\pi^{4/3}} \\int_0^\\infty r^2 \\exp\\left(-\\frac{8}{3} r\\right)\\,dr \\;=\\; 4\\pi^{-1/3} \\int_0^\\infty r^2 \\exp\\left(-\\frac{8}{3} r\\right)\\,dr\n$$\nThis is a standard integral of the form $\\int_0^\\infty x^n \\exp(-ax)\\,dx = \\frac{n!}{a^{n+1}}$. Here, $n=2$ and $a=8/3$.\n$$\n\\int_0^\\infty r^2 \\exp\\left(-\\frac{8}{3} r\\right)\\,dr \\;=\\; \\frac{2!}{(8/3)^3} \\;=\\; \\frac{2}{512/27} \\;=\\; \\frac{54}{512} \\;=\\; \\frac{27}{256}\n$$\nSubstituting this result back, we find the integrated density term:\n$$\n\\int n(\\mathbf{r})^{4/3}\\, d\\mathbf{r} \\;=\\; 4\\pi^{-1/3} \\left(\\frac{27}{256}\\right) \\;=\\; \\frac{27}{64}\\pi^{-1/3}\n$$\nNow, we compute $E_{x}^{\\mathrm{LSDA}}[n]$:\n$$\nE_{x}^{\\mathrm{LSDA}}[n] \\;=\\; -\\frac{3}{4}\\left(\\frac{3}{\\pi}\\right)^{1/3} \\left(\\frac{27}{64}\\pi^{-1/3}\\right) \\;=\\; -\\frac{3 \\cdot 3^{1/3} \\cdot 27}{4 \\cdot 64 \\cdot \\pi^{1/3} \\cdot \\pi^{1/3}} \\;=\\; -\\frac{3^{1} \\cdot 3^{1/3} \\cdot 3^3}{256 \\pi^{2/3}} \\;=\\; -\\frac{3^{13/3}}{256\\pi^{2/3}}\n$$\n\nNext, we evaluate the residual self-interaction error $\\Delta_x = E_{x}^{\\mathrm{LSDA}}[n] + E_{H}[n]$. This requires the calculation of the Hartree energy $E_H[n]$.\n$$\nE_{H}[n] \\;=\\; \\frac{1}{2}\\int \\int \\frac{n(\\mathbf{r})\\,n(\\mathbf{r'})}{|\\mathbf{r}-\\mathbf{r'}|}\\, d\\mathbf{r}\\, d\\mathbf{r'}\n$$\nThis is the classical electrostatic self-energy of the charge distribution $n(\\mathbf{r})$. It can be computed as $E_H[n] = \\frac{1}{2}\\int n(\\mathbf{r})\\phi(\\mathbf{r})\\,d\\mathbf{r}$, where $\\phi(\\mathbf{r})$ is the electrostatic potential generated by the density $n(\\mathbf{r})$. For a spherically symmetric density $n(r)$, the potential $\\phi(r)$ at a distance $r$ from the origin is given by:\n$$\n\\phi(r) \\;=\\; \\frac{1}{r} \\int_0^r n(r')\\,4\\pi r'^2\\,dr' + \\int_r^\\infty \\frac{n(r')\\,4\\pi r'^2}{r'}\\,dr'\n$$\nUsing $n(r') = \\frac{1}{\\pi}\\exp(-2r')$, the first term (charge enclosed in sphere of radius $r$, divided by $r$) is:\n$$\n\\frac{1}{r} \\int_0^r \\frac{1}{\\pi}\\exp(-2r')\\,4\\pi r'^2\\,dr' = \\frac{4}{r} \\int_0^r r'^2 \\exp(-2r')\\,dr' = \\frac{4}{r} \\left[-\\frac{\\exp(-2r')}{2}(r'^2+r'+1/2)\\right]_0^r = \\frac{1}{r}\\left[1 - \\exp(-2r)(2r^2+2r+1)\\right]\n$$\nThe second term (potential from charge outside sphere of radius $r$) is:\n$$\n\\int_r^\\infty \\frac{1}{\\pi}\\exp(-2r')\\,\\frac{4\\pi r'^2}{r'}\\,dr' = 4 \\int_r^\\infty r'\\exp(-2r')\\,dr' = 4\\left[-\\frac{\\exp(-2r')}{2}(r'+1/2)\\right]_r^\\infty = \\exp(-2r)(2r+1)\n$$\nCombining these terms, the potential is:\n$$\n\\phi(r) \\;=\\; \\frac{1}{r} - \\frac{\\exp(-2r)(2r^2+2r+1)}{r} + \\exp(-2r)(2r+1) \\;=\\; \\frac{1}{r} - \\exp(-2r)(2r+2+1/r) + \\exp(-2r)(2r+1) \\;=\\; \\frac{1}{r} - \\exp(-2r)(1+1/r)\n$$\nNow we can compute the Hartree energy:\n$$\nE_H[n] \\;=\\; \\frac{1}{2}\\int_0^\\infty n(r)\\phi(r)\\,4\\pi r^2\\,dr \\;=\\; \\frac{1}{2}\\int_0^\\infty \\left(\\frac{1}{\\pi}\\exp(-2r)\\right) \\left(\\frac{1}{r} - \\exp(-2r)(1+1/r)\\right) 4\\pi r^2\\,dr\n$$\n$$\nE_H[n] \\;=\\; 2 \\int_0^\\infty r^2 \\exp(-2r) \\left(\\frac{1}{r} - \\exp(-2r) - \\frac{\\exp(-2r)}{r}\\right)\\,dr \\;=\\; 2 \\int_0^\\infty \\left(r\\exp(-2r) - r^2\\exp(-4r) - r\\exp(-4r)\\right)\\,dr\n$$\nThis expression contains three standard integrals:\n$$\n\\int_0^\\infty r\\exp(-2r)\\,dr = \\frac{1!}{2^2} = \\frac{1}{4}\n$$\n$$\n\\int_0^\\infty r^2\\exp(-4r)\\,dr = \\frac{2!}{4^3} = \\frac{2}{64} = \\frac{1}{32}\n$$\n$$\n\\int_0^\\infty r\\exp(-4r)\\,dr = \\frac{1!}{4^2} = \\frac{1}{16}\n$$\nSubstituting these values:\n$$\nE_H[n] \\;=\\; 2 \\left(\\frac{1}{4} - \\frac{1}{32} - \\frac{1}{16}\\right) \\;=\\; 2 \\left(\\frac{8}{32} - \\frac{1}{32} - \\frac{2}{32}\\right) \\;=\\; 2 \\left(\\frac{5}{32}\\right) \\;=\\; \\frac{5}{16}\n$$\nThe exact exchange for this one-electron system is $E_{x}^{\\mathrm{exact}}[n] = -E_{H}[n] = -5/16$.\n\nFinally, the residual exchange self-interaction error is:\n$$\n\\Delta_{x} \\;=\\; E_{x}^{\\mathrm{LSDA}}[n] + E_{H}[n] \\;=\\; -\\frac{3^{13/3}}{256\\pi^{2/3}} + \\frac{5}{16}\n$$\nThe two requested quantities are $E_{x}^{\\mathrm{LSDA}}[n]$ and $\\Delta_{x}$.", "answer": "$$\n\\boxed{\\begin{pmatrix} -\\dfrac{3^{13/3}}{256\\pi^{2/3}} & \\dfrac{5}{16} - \\dfrac{3^{13/3}}{256\\pi^{2/3}} \\end{pmatrix}}\n$$", "id": "2890214"}, {"introduction": "A critical consequence of self-interaction error is the tendency of semi-local functionals (Rungs 1 and 2) to overly delocalize electron density, a problem vividly illustrated in stretched molecules. This exercise [@problem_id:2890247] employs an intuitive model of the stretched hydrogen molecular ion ($\\text{H}_2^+$) to contrast the incorrect predictions of LDA and PBE with the physically sound, localized solution provided by a higher-rung Range-Separated Hybrid. By working through this model, you will gain a clear, qualitative understanding of why climbing Jacob's ladder is essential for describing charge localization phenomena.", "problem": "You will model the stretched hydrogen molecular cation, where the single electron can occupy either of two far-separated fragments. At large separation, the two fragments are effectively noninteracting, so the total energy can be approximated as the sum of fragment energies constrained by electron-number conservation. Your task is to implement a program that predicts the electron-number distribution across the two fragments under three classes of density functionals from different rungs of Jacob’s ladder: the Local Density Approximation (LDA), the Perdew–Burke–Ernzerhof Generalized Gradient Approximation (PBE GGA), and a Range-Separated Hybrid (RSH). You must ground your derivation in the exact piecewise linearity of the total energy of an isolated fragment as a function of noninteger electron number and a quadratic-curvature deviation model.\n\nFundamental base: In exact ensemble Density Functional Theory (DFT), the ground-state energy of an isolated fragment as a function of electron number between adjacent integers is piecewise linear. Deviations from piecewise linearity can be modeled by a curvature parameter that quantifies the degree and sign of deviation. Semilocal approximations such as LDA and PBE are known to exhibit convex curvature in the energy as a function of electron number on a fragment, associated with delocalization error, while Hartree–Fock-like exchange contributions tend to induce concave curvature. Range-separated hybrids can reduce or even flip the sign of the curvature relative to semilocal approximations.\n\nModel and constraints: Consider two identical fragments, labeled A and B, separated far enough that interfragment Coulomb couplings can be neglected. Let $N_A$ and $N_B$ denote the electron numbers on fragments A and B, respectively, constrained by $N_A + N_B = 1$ and $0 \\le N_A \\le 1$, $0 \\le N_B \\le 1$. Let $a_A$ and $a_B$ be linear coefficients representing the leading-order site-energy terms that encode a small external asymmetry between the fragments; define the asymmetry parameter $\\Delta \\equiv a_A - a_B$. Approximate each fragment’s energy by a quadratic curvature model\n$$\nE_f(n) = a_f\\, n + \\frac{k}{2}\\, n^2,\n$$\nwhere $f \\in \\{\\mathrm{A},\\mathrm{B}\\}$, $n \\in [0,1]$, and $k$ is the curvature parameter that characterizes the rung and class of the exchange–correlation functional. The total energy at fixed $N_A$ is\n$$\nE_{\\mathrm{tot}}(N_A) = E_{\\mathrm{A}}(N_A) + E_{\\mathrm{B}}(1 - N_A).\n$$\nThe physically relevant prediction for charge localization is the minimizer $N_A^\\star$ of $E_{\\mathrm{tot}}(N_A)$ subject to the bounds.\n\nInterpretation: The sign of $k$ encodes the convexity of $E(n)$ on a fragment. Positive $k$ (convex) models semilocal approximations such as LDA and PBE that tend to delocalize charge. Approximately zero or slightly negative $k$ models range-separated hybrids that mitigate delocalization error and favor localization.\n\nTasks:\n1. Starting from the model and constraint above, derive an algorithm to find the minimizing value $N_A^\\star$ for given $(k,\\Delta)$, including correct handling of boundary solutions under the constraints $0 \\le N_A \\le 1$.\n2. Implement a program that, for each test case listed below, computes the triple of predicted values $(N_A^\\star(\\text{LDA}), N_A^\\star(\\text{PBE}), N_A^\\star(\\text{RSH}))$ using the curvature parameters assigned to each rung:\n   - LDA: $k_{\\mathrm{LDA}} = 0.40$,\n   - PBE: $k_{\\mathrm{PBE}} = 0.20$,\n   - RSH: $k_{\\mathrm{RSH}} = -0.05$.\n   Use the same $\\Delta$ for all three within each test case.\n3. Treat the degenerate case of exactly zero curvature carefully: when $k = 0$ and $\\Delta \\ne 0$, the energy is linear in $N_A$ with a unique boundary minimizer; when $k = 0$ and $\\Delta = 0$, the energy is flat, and you must return the convention $N_A^\\star = 0.5$.\n4. In the concave case $k < 0$, ensure that interior stationary points are rejected as maxima and that the minimizer lies at a boundary, chosen by the sign of $\\Delta$; in the exactly symmetric case $\\Delta = 0$ with $k < 0$, return the deterministic choice $N_A^\\star = 0.0$ to represent one of the degenerate localized minima.\n\nTest suite:\n- Use the following four values of $\\Delta$ to probe symmetry, weak bias, and strong bias:\n  1. $\\Delta = 0.00$,\n  2. $\\Delta = 0.05$,\n  3. $\\Delta = 0.50$,\n  4. $\\Delta = -0.05$.\n- For each of the four $\\Delta$ values, compute and report the three predicted values in the fixed order LDA, PBE, RSH.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. The list must be the concatenation of the triples for the four test cases in the order given above. That is, the output must be\n$[N_A^\\star(\\text{LDA},\\Delta_1),N_A^\\star(\\text{PBE},\\Delta_1),N_A^\\star(\\text{RSH},\\Delta_1),N_A^\\star(\\text{LDA},\\Delta_2),\\dots,N_A^\\star(\\text{RSH},\\Delta_4)]$,\nwith each entry a floating-point number. No units are required.", "solution": "The task is to find the electron number on fragment A, denoted as $N_A^\\star$, that minimizes the total energy of a two-fragment system with one electron. The fragments are labeled A and B, with electron numbers $N_A$ and $N_B$, subject to the constraints $N_A + N_B = 1$ and $0 \\le N_A \\le 1$. The energy of an individual fragment $f \\in \\{\\mathrm{A},\\mathrm{B}\\}$ is given by the quadratic model:\n$$\nE_f(n) = a_f n + \\frac{k}{2} n^2\n$$\nwhere $n$ is the electron number on the fragment, $a_f$ is a site-energy parameter, and $k$ is a curvature parameter characteristic of the density functional approximation. The total energy of the system as a function of $N_A$ is:\n$$\nE_{\\mathrm{tot}}(N_A) = E_{\\mathrm{A}}(N_A) + E_{\\mathrm{B}}(N_B) = E_{\\mathrm{A}}(N_A) + E_{\\mathrm{B}}(1 - N_A)\n$$\nSubstituting the fragment energy expressions:\n$$\nE_{\\mathrm{tot}}(N_A) = \\left( a_A N_A + \\frac{k}{2} N_A^2 \\right) + \\left( a_B (1 - N_A) + \\frac{k}{2} (1 - N_A)^2 \\right)\n$$\nTo simplify, we expand the terms and collect powers of $N_A$:\n$$\nE_{\\mathrm{tot}}(N_A) = a_A N_A + \\frac{k}{2} N_A^2 + a_B - a_B N_A + \\frac{k}{2} (1 - 2N_A + N_A^2)\n$$\n$$\nE_{\\mathrm{tot}}(N_A) = a_A N_A + \\frac{k}{2} N_A^2 + a_B - a_B N_A + \\frac{k}{2} - k N_A + \\frac{k}{2} N_A^2\n$$\n$$\nE_{\\mathrm{tot}}(N_A) = \\left(\\frac{k}{2} + \\frac{k}{2}\\right)N_A^2 + (a_A - a_B - k)N_A + \\left(a_B + \\frac{k}{2}\\right)\n$$\n$$\nE_{\\mathrm{tot}}(N_A) = k N_A^2 + (a_A - a_B - k)N_A + C\n$$\nwhere $C = a_B + k/2$ is a constant offset. Using the definition of the asymmetry parameter $\\Delta = a_A - a_B$, the total energy to be minimized is:\n$$\nE_{\\mathrm{tot}}(N_A) = k N_A^2 + (\\Delta - k) N_A + C\n$$\nWe seek the minimizer $N_A^\\star$ of this quadratic function on the closed interval $[0, 1]$. To find this, we analyze the first and second derivatives with respect to $N_A$:\n$$\n\\frac{dE_{\\mathrm{tot}}}{dN_A} = 2k N_A + \\Delta - k\n$$\n$$\n\\frac{d^2E_{\\mathrm{tot}}}{dN_A^2} = 2k\n$$\nThe sign of the curvature parameter $k$ determines the convexity of the energy function and thus dictates the minimization strategy. We must consider three distinct cases.\n\nCase 1: $k > 0$ (Convex Energy). This case models semilocal functionals like LDA ($k_{\\mathrm{LDA}} = 0.40$) and PBE ($k_{\\mathrm{PBE}} = 0.20$), which tend to spuriously delocalize charge. The second derivative $2k$ is positive, indicating that the energy function is convex (a parabola opening upward). The unconstrained global minimum is found by setting the first derivative to zero:\n$$\n2k N_A + \\Delta - k = 0 \\implies N_A^{\\text{unconstrained}} = \\frac{k - \\Delta}{2k} = \\frac{1}{2} - \\frac{\\Delta}{2k}\n$$\nThe minimum of a convex function on a closed interval is found by clipping the unconstrained minimum to the interval's bounds. Therefore, the minimizer $N_A^\\star$ is given by:\n$$\nN_A^\\star = \\max\\left(0, \\min\\left(1, \\frac{1}{2} - \\frac{\\Delta}{2k}\\right)\\right)\n$$\nThis result shows that for small asymmetries $|\\Delta| < k$, the electron is partially delocalized ($0 < N_A^\\star < 1$). For larger asymmetries $|\\Delta| \\ge k$, the electron fully localizes ($N_A^\\star = 0$ or $N_A^\\star = 1$).\n\nCase 2: $k < 0$ (Concave Energy). This models Range-Separated Hybrid (RSH) functionals ($k_{\\mathrm{RSH}} = -0.05$), which mitigate delocalization error and favor integer-like charge distributions. The second derivative $2k$ is negative, so the energy function is concave (a parabola opening downward). The stationary point is a maximum. For a concave function, the minimum on a closed interval must lie at one of its boundaries. Thus, $N_A^\\star \\in \\{0, 1\\}$. To select the correct boundary, we compare the energy at the endpoints $N_A = 0$ and $N_A = 1$:\n$$\nE_{\\mathrm{tot}}(0) = C\n$$\n$$\nE_{\\mathrm{tot}}(1) = k(1)^2 + (\\Delta - k)(1) + C = \\Delta + C\n$$\nThe minimum occurs at $N_A^\\star = 0$ if $E_{\\mathrm{tot}}(0) \\le E_{\\mathrm{tot}}(1)$, which means $C \\le \\Delta + C$, or $\\Delta \\ge 0$. The minimum occurs at $N_A^\\star = 1$ if $E_{\\mathrm{tot}}(1) < E_{\\mathrm{tot}}(0)$, which means $\\Delta < 0$. The problem specifies that for the degenerate symmetric case $\\Delta = 0$, the convention $N_A^\\star = 0.0$ must be used. Combining these conditions gives:\n$$\nN_A^\\star = \\begin{cases} 0.0 & \\text{if } \\Delta \\ge 0 \\\\ 1.0 & \\text{if } \\Delta < 0 \\end{cases}\n$$\nThis demonstrates that for functionals with concave curvature, any infinitesimal asymmetry immediately causes complete charge localization.\n\nCase 3: $k = 0$ (Linear Energy). This corresponds to the exact piecewise-linear behavior of the energy for fractional electron numbers. The energy function becomes linear in $N_A$:\n$$\nE_{\\mathrm{tot}}(N_A) = \\Delta N_A + C\n$$\nThe minimum of a linear function on an interval is always at a boundary, unless the function is constant. The location depends on the sign of the slope, $\\Delta$.\n- If $\\Delta > 0$, the function is strictly increasing, so the minimum is at $N_A^\\star = 0$.\n- If $\\Delta < 0$, the function is strictly decreasing, so the minimum is at $N_A^\\star = 1$.\n- If $\\Delta = 0$, the energy is constant. The problem instructs to return the conventional value $N_A^\\star = 0.5$.\n\nThis comprehensive case analysis provides a robust algorithm to determine $N_A^\\star$ for any given $(k, \\Delta)$ pair, as implemented in the accompanying program.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the electron number distribution for a stretched H2+ model\n    under different density functional approximations.\n    \"\"\"\n    \n    # Define the curvature parameters from the problem for each functional class.\n    k_params = {\n        \"LDA\": 0.40,  # Local Density Approximation\n        \"PBE\": 0.20,  # Perdew–Burke–Ernzerhof GGA\n        \"RSH\": -0.05, # Range-Separated Hybrid\n    }\n\n    # Define the asymmetry parameter test cases.\n    delta_values = [0.00, 0.05, 0.50, -0.05]\n\n    results = []\n\n    def get_na_star(k: float, delta: float) -> float:\n        \"\"\"\n        Calculates the minimizing electron number N_A* based on the \n        curvature k and asymmetry delta.\n\n        Args:\n            k: The curvature parameter of the energy model.\n            delta: The site-energy asymmetry parameter.\n\n        Returns:\n            The electron number N_A* on fragment A that minimizes the total energy.\n        \"\"\"\n        if k > 0.0:\n            # Case 1: Convex energy (LDA, PBE). The energy function E_tot(N_A) is a\n            # parabola opening upward. The unconstrained minimum is at 0.5 - delta/(2k).\n            # The solution is this value clamped to the interval [0, 1].\n            na_unconstrained = 0.5 - delta / (2.0 * k)\n            return np.clip(na_unconstrained, 0.0, 1.0)\n        \n        elif k < 0.0:\n            # Case 2: Concave energy (RSH). The energy function is a parabola opening\n            # downward. The minimum must be at the boundaries (N_A=0 or N_A=1).\n            # The choice depends on the sign of delta. For delta=0, the problem\n            # specifies a deterministic choice of 0.0.\n            if delta >= 0.0:\n                return 0.0\n            else:  # delta < 0.0\n                return 1.0\n        \n        else:  # k == 0.0\n            # Case 3: Linear energy. The minimum is at a boundary, determined\n            # by the slope, delta. For delta=0, the energy is flat, and the\n            # problem specifies the convention 0.5.\n            if delta > 0.0:\n                return 0.0\n            elif delta < 0.0:\n                return 1.0\n            else:  # delta == 0.0\n                return 0.5\n\n    # Iterate through each test case for the asymmetry parameter delta.\n    for delta in delta_values:\n        # For each delta, calculate N_A* for LDA, PBE, and RSH in the required order.\n        na_lda = get_na_star(k_params[\"LDA\"], delta)\n        na_pbe = get_na_star(k_params[\"PBE\"], delta)\n        na_rsh = get_na_star(k_params[\"RSH\"], delta)\n        \n        results.extend([na_lda, na_pbe, na_rsh])\n\n    # Final print statement in the exact required format. The results are converted\n    # to strings and joined by commas, enclosed in square brackets.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2890247"}, {"introduction": "Climbing to the fourth rung of Jacob's Ladder, hybrid functionals mitigate delocalization error by mixing in a fraction of exact Hartree-Fock exchange, which is free of self-interaction. However, this is not a panacea, as exact exchange can exaggerate static correlation errors, which are prominent in systems with stretched bonds. This practice [@problem_id:2890240] explores this crucial compromise, using a quantitative model to analyze how varying the exact exchange fraction trades improvement in one area for degradation in another, revealing the delicate balancing act at the core of modern functional design.", "problem": "Consider the role of exchange-correlation approximations in Kohn–Sham Density Functional Theory (DFT) as organized by Jacob’s ladder, in particular the effect of incorporating a fraction of exact (Hartree–Fock) exchange to form a global hybrid functional (rung four). Work in atomic units, so all energies are in hartree. You will analyze two exact-constraint-based error measures that diagnose, respectively, delocalization error and static correlation error, and you will model how these errors change when a fraction of exact exchange is added.\n\nAs fundamental base, use the following well-tested facts and definitions:\n1) For the exact functional, the ground-state energy as a function of electron number $N$ at fixed external potential is piecewise linear between adjacent integers; for an approximate functional, deviation from piecewise linearity in the open interval between integers can be quantified by the curvature $\\kappa \\equiv \\dfrac{d^{2}E}{dN^{2}}$, which vanishes for the exact functional.\n2) For the exact functional at the dissociation limit of the hydrogen molecule $\\text{H}_{2}$, the energy of the spin-restricted ensemble as a function of fractional spin polarization $y$ at fixed electron number $N=1$ is constant; for an approximate functional, deviation from constancy can be quantified by the quadratic coefficient $\\mu$ in the expansion $E(y) = E(0) + \\dfrac{1}{2}\\mu\\,y^{2} + O(y^{4})$, which vanishes for the exact functional.\n3) A global hybrid functional mixes exchange-correlation contributions linearly: for a mixing fraction $a \\in [0,1]$, its exchange-correlation energy is $E_{\\text{xc}}^{(a)} = a\\,E_{x}^{\\text{HF}} + (1-a)\\,E_{\\text{xc}}^{\\text{DFA}}$, where Hartree–Fock (HF) denotes exact exchange and Density Functional Approximation (DFA) denotes a semilocal rung-two or rung-three functional. Assume the correlation part of the DFA does not depend on $a$.\n\nUse the following scientifically plausible, fixed reference values for the two diagnostic coefficients associated with the two limiting components (they are treated as constants characterizing the response of each component in the specified regimes):\n- For delocalization error in the one-electron sector (e.g., the $\\text{H}_{2}^{+}$ problem near a fixed geometry), the curvature constants are $\\kappa_{\\text{DFA}} = +0.30$ and $\\kappa_{\\text{HF}} = -0.20$ (in hartree).\n- For static correlation error in stretched $\\text{H}_{2}$ at a large internuclear separation (e.g., $R = 10.0$ bohr), the fractional-spin quadratic coefficients are $\\mu_{\\text{DFA}} = 0.10$ and $\\mu_{\\text{HF}} = 0.50$ (in hartree).\n\nTask A (derivation): Starting only from items (1)–(3) above, derive how the hybrid mixing with fraction $a$ propagates to the two diagnostic coefficients. In particular, express the hybrid curvature $\\kappa(a)$ and the hybrid fractional-spin coefficient $\\mu(a)$ in terms of $a$, $\\kappa_{\\text{DFA}}$, $\\kappa_{\\text{HF}}$, $\\mu_{\\text{DFA}}$, and $\\mu_{\\text{HF}}$. Then, define the magnitudes to be reported as $|\\kappa(a)|$ (delocalization error magnitude) and $\\mu(a)$ (static correlation error magnitude).\n\nTask B (computation): For a set of test cases, compute $|\\kappa(a)|$, $\\mu(a)$, and a trade-off score\n$$\nS(a) = w_{d}\\,|\\kappa(a)| + w_{s}\\,\\mu(a),\n$$\nwhere $w_{d}$ and $w_{s}$ are nonnegative weights. All reported quantities must be in hartree. Your program must implement the derived formulas from Task A and evaluate the following test suite, which probes boundary cases and interior points:\n- Test $1$: $a=0.0$, $w_{d}=1.0$, $w_{s}=1.0$.\n- Test $2$: $a=1.0$, $w_{d}=1.0$, $w_{s}=1.0$.\n- Test $3$: $a=0.25$, $w_{d}=2.0$, $w_{s}=1.0$.\n- Test $4$: $a=0.75$, $w_{d}=1.0$, $w_{s}=2.0$.\n- Test $5$: $a=0.50$, $w_{d}=1.0$, $w_{s}=1.5$.\n\nYour program should produce a single line of output containing the results for all tests as a comma-separated list enclosed in square brackets. Each test’s result must be a three-element list in the order $[|\\kappa(a)|,\\,\\mu(a),\\,S(a)]$, with each float rounded to six decimal places, and all energies in hartree. For example, the overall structure must be\n$\\big[\\,[x_{1},y_{1},z_{1}],\\,[x_{2},y_{2},z_{2}],\\,\\dots\\,\\big]\\,$,\nprinted on one line with no spaces.", "solution": "**Task A: Derivation**\n\nThe task requires the derivation of the functional dependence of the diagnostic coefficients $\\kappa(a)$ and $\\mu(a)$ on the mixing fraction $a$.\n\nThe total electronic energy for a system described by a hybrid functional with mixing parameter $a$ is, within the generalized Kohn-Sham (GKS) framework, a functional of the set of GKS orbitals. Using the specified definition of the exchange-correlation energy, the total energy functional is:\n$$E^{(a)} = T_s + V_{ne} + J + E_{\\text{xc}}^{(a)} = T_s + V_{ne} + J + a\\,E_{x}^{\\text{HF}} + (1-a)\\,E_{\\text{xc}}^{\\text{DFA}}$$\nwhere all terms are functionals of the self-consistent density $\\rho^{(a)}$. To a good approximation, we can analyze the change in energy by evaluating the perturbed functional using a fixed reference density, which leads to the approximation that the energy $E^{(a)}$ is a linear function of the mixing parameter $a$. Consequently, any derivative of the energy with respect to a parameter other than $a$ will also exhibit this linear dependence.\n\nFor the curvature $\\kappa(a) = \\frac{d^2E^{(a)}}{dN^2}$, taking the second derivative of the energy expression with respect to the electron number $N$ results in a linear function of $a$. We can determine this function by its values at the endpoints $a=0$ and $a=1$.\nAt $a=0$, the functional is pure DFA, so we must have $\\kappa(0) = \\kappa_{\\text{DFA}}$.\nAt $a=1$, the model should recover the property of the HF limit, so we must have $\\kappa(1) = \\kappa_{\\text{HF}}$.\nA linear function connecting these two points is a simple linear interpolation:\n$$\\kappa(a) = (1-a)\\kappa(0) + a\\kappa(1)$$\nSubstituting the known endpoint values, we arrive at the final expression for the hybrid curvature:\n$$\\kappa(a) = (1-a)\\kappa_{\\text{DFA}} + a\\kappa_{\\text{HF}}$$\n\nThe same reasoning is applied to the static correlation error metric $\\mu(a)$. This coefficient is obtained from the second derivative of the energy with respect to the fractional spin polarization $y$, evaluated at $y=0$: $\\mu(a) = \\frac{d^2 E^{(a)}}{dy^2} \\big|_{y=0}$. Following the same logic, this property must also interpolate linearly between the pure DFA and pure HF values.\n$$\\mu(a) = (1-a)\\mu(0) + a\\mu(1)$$\nSubstituting the known reference values, $\\mu(0) = \\mu_{\\text{DFA}}$ and $\\mu(1) = \\mu_{\\text{HF}}$ yields:\n$$\\mu(a) = (1-a)\\mu_{\\text{DFA}} + a\\mu_{\\text{HF}}$$\n\n**Task B: Computation**\n\nThe derived formulae are implemented for the computational task. The reported magnitudes are $|\\kappa(a)|$ for delocalization error and $\\mu(a)$ for static correlation error (since $\\mu(a)$ is non-negative for $a \\in [0,1]$). The trade-off score is $S(a) = w_{d}\\,|\\kappa(a)| + w_{s}\\,\\mu(a)$. The Python program in the final answer section performs these calculations for the specified test suite.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the DFT hybrid functional error analysis problem.\n    \"\"\"\n    \n    # Define reference values from the problem statement (in Hartree).\n    kappa_dfa = 0.30\n    kappa_hf = -0.20\n    mu_dfa = 0.10\n    mu_hf = 0.50\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (a, w_d, w_s)\n    test_cases = [\n        (0.0, 1.0, 1.0),   # Test 1\n        (1.0, 1.0, 1.0),   # Test 2\n        (0.25, 2.0, 1.0),  # Test 3\n        (0.75, 1.0, 2.0),  # Test 4\n        (0.50, 1.0, 1.5),  # Test 5\n    ]\n\n    results_for_printing = []\n\n    for case in test_cases:\n        a, w_d, w_s = case\n\n        # Task A: Implement the derived formulas for kappa(a) and mu(a).\n        # kappa(a) = (1-a)*kappa_DFA + a*kappa_HF\n        kappa_a = (1.0 - a) * kappa_dfa + a * kappa_hf\n        \n        # mu(a) = (1-a)*mu_DFA + a*mu_HF\n        mu_a = (1.0 - a) * mu_dfa + a * mu_hf\n\n        # The problem specifies reporting |kappa(a)| for the delocalization error magnitude.\n        abs_kappa_a = np.abs(kappa_a)\n\n        # Task B: Compute the trade-off score S(a).\n        # S(a) = w_d * |kappa(a)| + w_s * mu(a)\n        score_a = w_d * abs_kappa_a + w_s * mu_a\n\n        # Format the result for the current test case as a string \"[x,y,z]\"\n        # with numbers rounded to six decimal places.\n        case_result_str = (\n            f\"[{abs_kappa_a:.6f},{mu_a:.6f},{score_a:.6f}]\"\n        )\n        results_for_printing.append(case_result_str)\n\n    # Final print statement in the exact required format: [[x1,y1,z1],[x2,y2,z2],...]\n    # without any spaces.\n    print(f\"[{','.join(results_for_printing)}]\")\n\nsolve()\n```", "id": "2890240"}]}