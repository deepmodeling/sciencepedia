{"hands_on_practices": [{"introduction": "Generalized Gradient Approximations (GGAs) improve upon the Local Density Approximation (LDA) by incorporating information about the gradient of the electron density, $\\nabla\\rho$. This is quantified by the dimensionless reduced density gradient, $s$, which measures how rapidly the density varies on a local scale. This exercise provides a fundamental, hands-on derivation of $s(\\mathbf{r})$ for the hydrogen atom, the simplest one-electron system, allowing you to analytically probe the core assumption of GGAs—that the density is \"slowly varying\" ($s \\ll 1$)—and discover where this assumption succeeds and fails. [@problem_id:2903617]", "problem": "Consider the nonrelativistic ground-state hydrogen atom in vacuum. The exact Kohn–Sham (KS) one-electron orbital equals the real hydrogenic $1s$ orbital. Let the spatial coordinate be $\\mathbf{r}$, with $r = |\\mathbf{r}|$, and let the Bohr radius be $a_{0}$. The normalized $1s$ orbital is $\\psi_{1s}(\\mathbf{r}) = \\frac{1}{\\sqrt{\\pi}\\,a_{0}^{3/2}} \\exp\\left(-\\frac{r}{a_{0}}\\right)$. The corresponding electron density is $\\rho(\\mathbf{r}) = |\\psi_{1s}(\\mathbf{r})|^{2}$. The reduced density gradient used in generalized gradient approximations (GGA) is defined by\n\n$$\ns(\\mathbf{r}) \\equiv \\frac{|\\nabla \\rho(\\mathbf{r})|}{2\\,k_{F}(\\mathbf{r})\\,\\rho(\\mathbf{r})}, \\quad\\text{with}\\quad k_{F}(\\mathbf{r}) \\equiv \\big(3\\pi^{2}\\rho(\\mathbf{r})\\big)^{1/3}.\n$$\n\nUsing only these definitions and standard vector calculus in spherical coordinates, derive an explicit analytical expression for $s(r)$ for the hydrogen $1s$ density. Then, based solely on the small-$s$ criterion that underlies gradient expansions, argue whether a semilocal generalized gradient approximation should be close to the local density approximation (LDA) for this one-electron density across space. State clearly any limits you consider in your reasoning. Your final reported answer must be the explicit closed-form expression for $s(r)$. Do not include units in the final answer, and do not provide any commentary in the final answer.", "solution": "The problem as stated is scientifically grounded, well-posed, objective, and contains all necessary information for a complete derivation and reasoned argument. It is therefore deemed valid. We proceed with the solution.\n\nThe problem requires the derivation of the reduced density gradient, $s(r)$, for the ground-state hydrogen atom, and an analysis of its behavior to evaluate the applicability of the generalized gradient approximation (GGA) relative to the local density approximation (LDA).\n\nFirst, we establish the electron density, $\\rho(\\mathbf{r})$, from the given $1s$ orbital, $\\psi_{1s}(\\mathbf{r})$. The orbital is given as:\n$$\n\\psi_{1s}(\\mathbf{r}) = \\frac{1}{\\sqrt{\\pi}\\,a_{0}^{3/2}} \\exp\\left(-\\frac{r}{a_{0}}\\right)\n$$\nwhere $r = |\\mathbf{r}|$ and $a_0$ is the Bohr radius. Since the orbital is a real-valued function, the electron density $\\rho(\\mathbf{r}) = |\\psi_{1s}(\\mathbf{r})|^{2}$ simplifies to $\\rho(\\mathbf{r}) = \\psi_{1s}(\\mathbf{r})^{2}$. The density is spherically symmetric, so we denote it as $\\rho(r)$:\n$$\n\\rho(r) = \\left( \\frac{1}{\\sqrt{\\pi}\\,a_{0}^{3/2}} \\exp\\left(-\\frac{r}{a_{0}}\\right) \\right)^{2} = \\frac{1}{\\pi a_{0}^{3}} \\exp\\left(-\\frac{2r}{a_{0}}\\right)\n$$\n\nNext, we compute the gradient of the density, $\\nabla \\rho(r)$. In spherical coordinates, for a function that depends only on the radial coordinate $r$, the gradient simplifies to $\\nabla\\rho(r) = \\frac{d\\rho}{dr}\\hat{\\mathbf{r}}$, where $\\hat{\\mathbf{r}}$ is the unit vector in the radial direction. We calculate the derivative of $\\rho(r)$ with respect to $r$:\n$$\n\\frac{d\\rho}{dr} = \\frac{d}{dr} \\left[ \\frac{1}{\\pi a_{0}^{3}} \\exp\\left(-\\frac{2r}{a_{0}}\\right) \\right] = \\frac{1}{\\pi a_{0}^{3}} \\left(-\\frac{2}{a_{0}}\\right) \\exp\\left(-\\frac{2r}{a_{0}}\\right) = -\\frac{2}{a_{0}} \\rho(r)\n$$\nThe gradient is therefore $\\nabla \\rho(r) = -\\frac{2}{a_{0}}\\rho(r)\\hat{\\mathbf{r}}$.\n\nThe magnitude of the gradient, $|\\nabla \\rho(r)|$, is required for the numerator of $s(r)$. Since $\\rho(r)$ is always positive and $|\\hat{\\mathbf{r}}|=1$:\n$$\n|\\nabla \\rho(r)| = \\left| -\\frac{2}{a_{0}}\\rho(r)\\hat{\\mathbf{r}} \\right| = \\frac{2}{a_{0}}\\rho(r)\n$$\n\nNow, we determine the local Thomas-Fermi wave vector, $k_{F}(r)$, defined as $k_{F}(r) = (3\\pi^{2}\\rho(r))^{1/3}$. Substituting the expression for $\\rho(r)$:\n$$\nk_{F}(r) = \\left[ 3\\pi^{2} \\left( \\frac{1}{\\pi a_{0}^{3}} \\exp\\left(-\\frac{2r}{a_{0}}\\right) \\right) \\right]^{1/3} = \\left[ \\frac{3\\pi}{a_{0}^{3}} \\exp\\left(-\\frac{2r}{a_{0}}\\right) \\right]^{1/3} = \\frac{(3\\pi)^{1/3}}{a_{0}} \\exp\\left(-\\frac{2r}{3a_{0}}\\right)\n$$\n\nFinally, we assemble the reduced density gradient, $s(r)$, using its definition:\n$$\ns(r) = \\frac{|\\nabla \\rho(r)|}{2\\,k_{F}(r)\\,\\rho(r)}\n$$\nSubstituting the expressions for $|\\nabla \\rho(r)|$ and $k_{F}(r)$:\n$$\ns(r) = \\frac{\\frac{2}{a_{0}}\\rho(r)}{2 \\left[ \\frac{(3\\pi)^{1/3}}{a_{0}} \\exp\\left(-\\frac{2r}{3a_{0}}\\right) \\right] \\rho(r)}\n$$\nThe terms $2$, $\\rho(r)$, and $a_{0}$ cancel, leaving:\n$$\ns(r) = \\frac{1}{(3\\pi)^{1/3} \\exp\\left(-\\frac{2r}{3a_{0}}\\right)} = \\frac{1}{(3\\pi)^{1/3}} \\exp\\left(\\frac{2r}{3a_{0}}\\right)\n$$\nThis is the explicit analytical expression for $s(r)$ for the hydrogen $1s$ density.\n\nFor the second part of the problem, we must argue whether a GGA functional should be close to LDA for this system. The theoretical foundation for including density gradients in an exchange-correlation functional is the gradient expansion, which is a Taylor series in the gradients of the density. Such an expansion is valid only when the density is \"slowly varying\". The reduced density gradient $s(\\mathbf{r})$ is the dimensionless parameter that quantifies this variation. The condition for a slowly varying density, and thus for the validity of a gradient expansion, is $s(\\mathbf{r}) \\ll 1$. In regions where this condition holds, GGA is expected to be a small correction to LDA, and their results should be similar.\n\nWe now analyze the behavior of our derived $s(r)$ for the hydrogen atom across all space. The expression is $s(r) = (3\\pi)^{-1/3} \\exp(2r/(3a_0))$.\nWe consider two important limits:\n$1$. Near the nucleus, as $r \\to 0$:\n$$\n\\lim_{r\\to 0} s(r) = \\frac{1}{(3\\pi)^{1/3}} \\exp(0) = \\frac{1}{(3\\pi)^{1/3}} \\approx 0.473\n$$\nThis value is a constant of order unity; it is not much smaller than $1$.\n$2$. In the tail region, far from the nucleus, as $r \\to \\infty$:\n$$\n\\lim_{r\\to \\infty} s(r) = \\frac{1}{(3\\pi)^{1/3}} \\lim_{r\\to \\infty} \\exp\\left(\\frac{2r}{3a_{0}}\\right) = \\infty\n$$\nThe value of $s(r)$ grows exponentially and diverges in the region of decaying density.\n\nThe \"small-$s$\" criterion, $s(r) \\ll 1$, is not met anywhere in space for the hydrogen atom. The value of $s(r)$ is minimally $\\approx 0.473$ at the nucleus and increases without bound for larger $r$. The density of the hydrogen atom is therefore not slowly varying in the sense required for the gradient expansion to be accurate. Consequently, one should not expect a semilocal GGA to be close to the LDA. The significant deviation from the $s \\ll 1$ condition, especially the divergence in the tail, indicates that this one-electron system represents a challenging case for any functional based on the small-gradient assumption. This is a manifestation of the self-interaction problem, which is particularly severe for one-electron densities in both LDA and standard GGAs.", "answer": "$$\n\\boxed{\\frac{1}{(3\\pi)^{1/3}} \\exp\\left(\\frac{2r}{3a_{0}}\\right)}\n$$", "id": "2903617"}, {"introduction": "As we discovered that the reduced gradient $s$ is large in many chemically important regions, a more sophisticated ingredient is needed to improve density functionals. Meta-GGAs provide this by incorporating the kinetic energy density, $\\tau(\\mathbf{r})$, which helps distinguish different electronic environments. This practice involves deriving the inhomogeneity indicator $\\alpha(\\mathbf{r})$, a key component of modern meta-GGAs, for two limiting cases: a single-orbital region and the uniform electron gas. By seeing how $\\alpha$ takes on distinct values of $0$ and $1$ in these limits, you will understand the mechanism by which meta-GGAs can apply different physics to overcome the limitations of standard GGAs. [@problem_id:2903593]", "problem": "Consider a meta-Generalized Gradient Approximation (meta-GGA) in Kohn–Sham Density Functional Theory (KS-DFT), which uses the inhomogeneity indicator defined by\n$$\\alpha(\\mathbf{r})=\\frac{\\tau(\\mathbf{r})-\\tau_{W}(\\mathbf{r})}{\\tau_{\\mathrm{UEG}}(\\mathbf{r})}.$$\nHere, $\\tau(\\mathbf{r})$ is the positive-definite Kohn–Sham kinetic energy density\n$$\\tau(\\mathbf{r})=\\frac{1}{2}\\sum_{i}^{\\mathrm{occ}}|\\nabla \\psi_{i}(\\mathbf{r})|^{2},$$\n$\\tau_{W}(\\mathbf{r})$ is the von Weizsäcker kinetic energy density\n$$\\tau_{W}(\\mathbf{r})=\\frac{|\\nabla n(\\mathbf{r})|^{2}}{8\\,n(\\mathbf{r})},$$\nand $\\tau_{\\mathrm{UEG}}(\\mathbf{r})$ is the kinetic energy density of the Uniform Electron Gas (UEG) at the local density $n(\\mathbf{r})$\n$$\\tau_{\\mathrm{UEG}}(\\mathbf{r})=\\frac{3}{10}\\left(3\\pi^{2}\\right)^{2/3}\\left[n(\\mathbf{r})\\right]^{5/3}.$$\nAll expressions are in Hartree atomic units. \n\n(a) For the hydrogen atom in its ground state, take the real Kohn–Sham orbital to be the exact $1s$ orbital\n$$\\psi_{1s}(\\mathbf{r})=\\frac{1}{\\sqrt{\\pi}}\\,\\exp(-r),$$\nso that the electron density is $n(\\mathbf{r})=|\\psi_{1s}(\\mathbf{r})|^{2}=\\pi^{-1}\\exp(-2r)$. Compute $\\alpha(\\mathbf{r})$.\n\n(b) For a homogeneous electron gas with constant density $n(\\mathbf{r})=n_{0}$, compute $\\alpha(\\mathbf{r})$.\n\nThen, based on these limits, explain qualitatively how a meta-Generalized Gradient Approximation (meta-GGA) exchange enhancement factor $F_{x}(s,\\alpha)$, at fixed reduced gradient $s$, should be modulated as a function of $\\alpha$ in the single-orbital limit versus the metallic-like uniform limit, so as to recover appropriate exact constraints.\n\nProvide your final answer as the two values of $\\alpha$ for parts (a) and (b), written as a row vector in the order $\\big(\\alpha_{\\text{H-1s}}(\\mathbf{r}),\\,\\alpha_{\\text{UEG}}\\big)$. No numerical rounding is required, and no physical units should be included in the final boxed answer.", "solution": "The problem presented is a standard exercise in the formalism of Kohn-Sham Density Functional Theory, specifically concerning the construction of meta-Generalized Gradient Approximation (meta-GGA) functionals. The problem is well-posed, scientifically grounded, and contains all necessary information for its resolution. I will proceed with the solution.\n\nThe problem requires the calculation of the inhomogeneity indicator $\\alpha(\\mathbf{r})$ for two limiting cases and a subsequent qualitative discussion of its role in functional design. The definition provided is\n$$ \\alpha(\\mathbf{r})=\\frac{\\tau(\\mathbf{r})-\\tau_{W}(\\mathbf{r})}{\\tau_{\\mathrm{UEG}}(\\mathbf{r})} $$\nwhere $\\tau(\\mathbf{r})$ is the Kohn-Sham kinetic energy density, $\\tau_{W}(\\mathbf{r})$ is the von Weizsäcker kinetic energy density, and $\\tau_{\\mathrm{UEG}}(\\mathbf{r})$ is the kinetic energy density of a uniform electron gas (UEG) at the same local density $n(\\mathbf{r})$.\n\n(a) Case of the Hydrogen atom ground state.\nFor any system described by a single real Kohn-Sham spatial orbital $\\psi(\\mathbf{r})$, occupied by one or two electrons (a singlet pair), the electron density is given by $n(\\mathbf{r}) = N |\\psi(\\mathbf{r})|^2$, where $N$ is the occupation number ($1$ or $2$). For the hydrogen atom, $N=1$ and the density is $n(\\mathbf{r}) = |\\psi_{1s}(\\mathbf{r})|^2$.\n\nThe Kohn-Sham kinetic energy density for this single-orbital case is\n$$ \\tau(\\mathbf{r}) = \\frac{1}{2} |\\nabla \\psi_{1s}(\\mathbf{r})|^2 $$\nThe von Weizsäcker kinetic energy density is defined as\n$$ \\tau_{W}(\\mathbf{r}) = \\frac{|\\nabla n(\\mathbf{r})|^2}{8n(\\mathbf{r})} $$\nLet us establish the relationship between $\\tau(\\mathbf{r})$ and $\\tau_{W}(\\mathbf{r})$ for this general single-orbital case. The gradient of the density is\n$$ \\nabla n(\\mathbf{r}) = \\nabla |\\psi_{1s}(\\mathbf{r})|^2 = \\nabla (\\psi_{1s}(\\mathbf{r}) \\cdot \\psi_{1s}(\\mathbf{r})) = 2 \\psi_{1s}(\\mathbf{r}) \\nabla \\psi_{1s}(\\mathbf{r}) $$\nsince the orbital $\\psi_{1s}$ is real. The squared magnitude of the gradient is\n$$ |\\nabla n(\\mathbf{r})|^2 = 4 |\\psi_{1s}(\\mathbf{r})|^2 |\\nabla \\psi_{1s}(\\mathbf{r})|^2 = 4 n(\\mathbf{r}) |\\nabla \\psi_{1s}(\\mathbf{r})|^2 $$\nSubstituting this into the expression for $\\tau_{W}(\\mathbf{r})$ yields\n$$ \\tau_{W}(\\mathbf{r}) = \\frac{4 n(\\mathbf{r}) |\\nabla \\psi_{1s}(\\mathbf{r})|^2}{8 n(\\mathbf{r})} = \\frac{1}{2} |\\nabla \\psi_{1s}(\\mathbf{r})|^2 $$\nThis is identical to the expression for the Kohn-Sham kinetic energy density $\\tau(\\mathbf{r})$. Therefore, for any region of space described by a single real orbital, it is a mathematical identity that $\\tau(\\mathbf{r}) = \\tau_{W}(\\mathbf{r})$.\n\nThis can be verified explicitly with the given orbital $\\psi_{1s}(\\mathbf{r})=\\frac{1}{\\sqrt{\\pi}}\\,\\exp(-r)$.\nThe density is $n(r) = \\pi^{-1}\\exp(-2r)$. The gradient is $\\nabla n(r) = \\frac{dn}{dr}\\hat{\\mathbf{r}} = -2\\pi^{-1}\\exp(-2r)\\hat{\\mathbf{r}} = -2n(r)\\hat{\\mathbf{r}}$.\nThus, $|\\nabla n(r)|^2 = 4n(r)^2$.\nSo, $\\tau_{W}(r) = \\frac{4n(r)^2}{8n(r)} = \\frac{1}{2}n(r)$.\nFor the Kohn-Sham kinetic energy density, $\\nabla \\psi_{1s}(r) = \\frac{d\\psi_{1s}}{dr}\\hat{\\mathbf{r}} = -\\frac{1}{\\sqrt{\\pi}}\\exp(-r)\\hat{\\mathbf{r}} = -\\psi_{1s}(r)\\hat{\\mathbf{r}}$.\nThen, $|\\nabla \\psi_{1s}(r)|^2 = \\psi_{1s}(r)^2 = n(r)$.\nSo, $\\tau(r) = \\frac{1}{2}|\\nabla \\psi_{1s}(r)|^2 = \\frac{1}{2}n(r)$.\nThe explicit calculation confirms $\\tau(r) = \\tau_W(r)$.\n\nThe numerator of the expression for $\\alpha(\\mathbf{r})$ is $\\tau(\\mathbf{r}) - \\tau_{W}(\\mathbf{r}) = 0$.\nThe denominator, $\\tau_{\\mathrm{UEG}}(\\mathbf{r})$, is non-zero for any region with non-zero density. Therefore, for the hydrogen atom, the inhomogeneity indicator is\n$$ \\alpha_{\\text{H-1s}}(\\mathbf{r}) = 0 $$\nThis result holds for all points $\\mathbf{r}$ where $n(\\mathbf{r}) \\neq 0$.\n\n(b) Case of the Homogeneous Electron Gas (UEG).\nFor a homogeneous electron gas, the electron density is constant, $n(\\mathbf{r}) = n_0$.\nThe gradient of the density is $\\nabla n(\\mathbf{r}) = \\nabla n_0 = 0$.\nSubstituting this into the definition of the von Weizsäcker kinetic energy density gives\n$$ \\tau_{W}(\\mathbf{r}) = \\frac{|\\nabla n_0|^2}{8n_0} = \\frac{0}{8n_0} = 0 $$\nThe Kohn-Sham kinetic energy density for a UEG, whose orbitals are plane waves, is precisely what the model quantity $\\tau_{\\mathrm{UEG}}(\\mathbf{r})$ is constructed to represent. The total kinetic energy of $N$ electrons in a volume $V$ is $T = N \\frac{3}{5} E_F$, where $E_F$ is the Fermi energy. In atomic units, this leads to a kinetic energy density $\\tau = T/V = \\frac{3}{10}(3\\pi^2)^{2/3}n_0^{5/3}$.\nTherefore, by definition of the UEG system and the corresponding model density,\n$$ \\tau(\\mathbf{r}) = \\tau_{\\mathrm{UEG}}(\\mathbf{r}) = \\frac{3}{10}\\left(3\\pi^{2}\\right)^{2/3}n_0^{5/3} $$\nNow we compute $\\alpha(\\mathbf{r})$ for the UEG:\n$$ \\alpha_{\\text{UEG}} = \\frac{\\tau(\\mathbf{r}) - \\tau_{W}(\\mathbf{r})}{\\tau_{\\mathrm{UEG}}(\\mathbf{r})} = \\frac{\\tau_{\\mathrm{UEG}}(\\mathbf{r}) - 0}{\\tau_{\\mathrm{UEG}}(\\mathbf{r})} = 1 $$\nThis is valid for any $n_0 > 0$.\n\nQualitative explanation for meta-GGA functional design.\nThe calculations above demonstrate that the iso-orbital indicator $\\alpha$ serves to distinguish between two fundamentally different physical regimes.\n1.  $\\alpha = 0$: This limit corresponds to single-orbital regions, such as the hydrogen atom, the tail region of any finite system's electron density, or certain covalent bonds. In these regions, the exchange-correlation functional must satisfy the constraint of being free from self-interaction error (SIE). For a one-electron system, the exact exchange energy $E_x$ must perfectly cancel the artificial Hartree self-repulsion energy $E_H$.\n2.  $\\alpha = 1$: This limit corresponds to the uniform electron gas, which is characteristic of the interior of simple metals and serves as the baseline for constructing local and semi-local density functionals. In this limit, where the reduced density gradient $s=|\\nabla n|/[2(3\\pi^2)^{1/3}n^{4/3}]=0$, the exchange enhancement factor $F_x(s=0, \\alpha=1)$ must equal $1$ to recover the exact Dirac exchange energy of the UEG.\n\nStandard GGA functionals, which depend only on $n$ and $s$, cannot distinguish these two limits. They are designed to improve upon the local density approximation by including gradient corrections, and their enhancement factors $F_x(s)$ are typically monotonic functions of $s$. This works reasonably well for the $\\alpha \\approx 1$ regime but fails catastrophically for the $\\alpha = 0$ regime, leading to significant self-interaction error. A large $s$ value can occur in either a rapidly varying many-electron system or in the tail of a single orbital; a GGA cannot tell the difference.\n\nA meta-GGA functional, with its dependence on $\\tau$ through $\\alpha$, can resolve this ambiguity. The enhancement factor $F_x(s, \\alpha)$ is designed to modulate its behavior based on the value of $\\alpha$. To satisfy the exact constraints:\n-   In a region where $\\alpha \\approx 1$ (metallic-like), $F_x(s, \\alpha)$ should behave like an advanced GGA, providing an accurate description of exchange in slowly-varying-to-moderately-varying electron gases.\n-   In a region where $\\alpha \\to 0$ (single-orbital), $F_x(s, \\alpha)$ must be suppressed. At a fixed, non-zero $s$, the value of $F_x$ must decrease as $\\alpha$ goes from $1$ to $0$. This suppression is crucial to eliminate or at least substantially reduce the self-interaction error. Functionals like SCAN (Strongly Constrained and Appropriately Normed) explicitly use a switching function dependent on $\\alpha$ to interpolate between these two behaviors, thereby enforcing the self-interaction-free constraint for all one-electron densities.\n\nIn summary, the role of $\\alpha$ is to inform the functional about the local electronic structure, allowing $F_x(s, \\alpha)$ to adapt its form to be physically appropriate for either a many-electron delocalized environment or a single-orbital localized environment.", "answer": "$$\n\\boxed{\\begin{pmatrix} 0 & 1 \\end{pmatrix}}\n$$", "id": "2903593"}, {"introduction": "Hybrid functionals represent another powerful strategy for enhancing accuracy, primarily by mixing a fraction, $a$, of exact Hartree-Fock exchange to directly combat self-interaction error. However, the optimal value of $a$ is not universal and often depends on the property of interest. This computational exercise uses a simplified linear model to explore the well-known trade-off in hybrid functional design, where you will quantify how varying the exact exchange fraction impacts accuracy for thermochemical properties versus reaction barrier heights. This practice illustrates a central challenge in creating a universally accurate functional and highlights why different hybrid functionals are parameterized for different purposes. [@problem_id:2903641]", "problem": "Consider the Kohn–Sham formulation of Density Functional Theory (Kohn–Sham DFT), where the ground-state total energy for an electronic system with density $\\rho(\\mathbf{r})$ is given by the sum of non-interacting kinetic energy, classical electron–electron repulsion, external potential energy, and exchange–correlation energy. In the generalized hybrid functional approximation, the exchange–correlation energy is modeled as a convex mixture of exact Hartree–Fock exchange and a semilocal exchange plus a semilocal correlation, controlled by a fraction parameter $a \\in [0,1]$. Under the frozen-density approximation (neglecting density relaxation with respect to $a$), the total energy of a species $S$ can be written as\n$$\nE_{\\mathrm{tot}}(S;a) \\approx E_{\\mathrm{sl}}(S) + a \\,\\Delta_x(S),\n$$\nwhere $E_{\\mathrm{sl}}(S)$ is the total energy at a reference semilocal functional (with semilocal exchange–correlation), and $\\Delta_x(S) = E_x^{\\mathrm{HF}}(S) - E_x^{\\mathrm{sl}}(S)$ is the difference between exact Hartree–Fock exchange and semilocal exchange, both evaluated at the reference density. This linear model is widely used for conceptual analysis of the trade-off between thermochemical accuracy and barrier heights upon varying $a$.\n\nYour task is to implement this model to compute atomization energies and a prototype barrier height across a small test set, as functions of the exact exchange fraction $a$. Then, quantify the trade-off by comparing to supplied high-level reference values. All energies must be expressed in hartree.\n\nDefinitions:\n- The atomization energy of a molecule $M$ with constituent atoms $\\{A_i\\}$ is\n$$\nD_e(M;a) = \\sum_i E_{\\mathrm{tot}}(A_i;a) - E_{\\mathrm{tot}}(M;a).\n$$\n- The barrier height for the hydrogen exchange reaction $ \\mathrm{H} + \\mathrm{H}_2 \\rightleftharpoons \\mathrm{H}_3^{\\ddagger} \\to \\mathrm{H} + \\mathrm{H}_2$ is modeled as\n$$\nB(a) = E_{\\mathrm{tot}}(\\mathrm{H}_3^{\\ddagger};a) - \\left[E_{\\mathrm{tot}}(\\mathrm{H};a) + E_{\\mathrm{tot}}(\\mathrm{H}_2;a)\\right].\n$$\n- The mean absolute error for atomization energies across a set of molecules $\\{M_j\\}_{j=1}^N$ with reference values $\\{D_e^{\\mathrm{ref}}(M_j)\\}$ is\n$$\n\\mathrm{MAE}(a) = \\frac{1}{N}\\sum_{j=1}^N \\left| D_e(M_j;a) - D_e^{\\mathrm{ref}}(M_j) \\right|.\n$$\n\nUse the following dataset of species with their $E_{\\mathrm{sl}}(S)$ and $\\Delta_x(S)$ values, in hartree:\n- Atoms:\n  - $\\mathrm{H}$: $E_{\\mathrm{sl}}(\\mathrm{H}) = -0.500$, $\\Delta_x(\\mathrm{H}) = -0.025$.\n  - $\\mathrm{C}$: $E_{\\mathrm{sl}}(\\mathrm{C}) = -37.600$, $\\Delta_x(\\mathrm{C}) = -0.500$.\n  - $\\mathrm{O}$: $E_{\\mathrm{sl}}(\\mathrm{O}) = -74.800$, $\\Delta_x(\\mathrm{O}) = -0.650$.\n- Molecules:\n  - $\\mathrm{H}_2$: $E_{\\mathrm{sl}}(\\mathrm{H}_2) = -1.174$, $\\Delta_x(\\mathrm{H}_2) = -0.030$.\n  - $\\mathrm{CH}_4$: $E_{\\mathrm{sl}}(\\mathrm{CH}_4) = -40.235$, $\\Delta_x(\\mathrm{CH}_4) = -0.400$.\n  - $\\mathrm{H}_2\\mathrm{O}$: $E_{\\mathrm{sl}}(\\mathrm{H}_2\\mathrm{O}) = -76.180$, $\\Delta_x(\\mathrm{H}_2\\mathrm{O}) = -0.500$.\n- Transition state:\n  - $\\mathrm{H}_3^{\\ddagger}$: $E_{\\mathrm{sl}}(\\mathrm{H}_3^{\\ddagger}) = -1.664$, $\\Delta_x(\\mathrm{H}_3^{\\ddagger}) = -0.020$.\n\nUse the following reference atomization energies, in hartree:\n- $D_e^{\\mathrm{ref}}(\\mathrm{H}_2) = 0.1746$,\n- $D_e^{\\mathrm{ref}}(\\mathrm{CH}_4) = 0.6250$,\n- $D_e^{\\mathrm{ref}}(\\mathrm{H}_2\\mathrm{O}) = 0.3700$.\n\nUse the following reference barrier height, in hartree:\n- $B^{\\mathrm{ref}} = 0.0150$.\n\nCompute for each $a$ in the test suite $\\{0.0,\\,0.15,\\,0.25,\\,0.50,\\,1.00\\}$:\n- The mean absolute error $\\mathrm{MAE}(a)$ for the molecule set $\\{\\mathrm{H}_2,\\,\\mathrm{CH}_4,\\,\\mathrm{H}_2\\mathrm{O}\\}$.\n- The absolute error in the barrier height, $\\left|B(a) - B^{\\mathrm{ref}}\\right|$, for the hydrogen exchange reaction modeled via $\\mathrm{H}_3^{\\ddagger}$ and $\\mathrm{H} + \\mathrm{H}_2$.\n\nYour program must produce a single line of output containing the results as a comma-separated list enclosed in square brackets, ordered as follows: for each $a$ in the given test suite, append the two floats $\\mathrm{MAE}(a)$ and $\\left|B(a) - B^{\\mathrm{ref}}\\right|$, in that order. All outputs must be in hartree, each rounded to $6$ decimal places. For example, the output format must be exactly\n$$\n[\\mathrm{MAE}(a_1),|B(a_1)-B^{\\mathrm{ref}}|,\\mathrm{MAE}(a_2),|B(a_2)-B^{\\mathrm{ref}}|,\\ldots].\n$$\nNo additional text should be printed besides this single-line list.", "solution": "The problem is subjected to validation and is found to be scientifically sound, well-posed, and objective. It presents a standard, albeit simplified, model from quantum chemistry for the analysis of hybrid density functionals. All required data and definitions are provided, and the task is a direct application of these principles. We may therefore proceed with a rigorous solution.\n\nThe central task is to analyze the performance of a simplified hybrid functional model for thermochemical (atomization energy) and kinetic (reaction barrier) properties. The total energy of a species $S$ is modeled as a linear function of the exact exchange fraction, $a$:\n$$\nE_{\\mathrm{tot}}(S;a) = E_{\\mathrm{sl}}(S) + a \\cdot \\Delta_x(S)\n$$\nwhere $E_{\\mathrm{sl}}(S)$ is the energy from a reference semilocal functional and $\\Delta_x(S)$ is the exchange correction term.\n\nFirst, we must derive expressions for the atomization energy and barrier height as functions of $a$.\n\nStep 1: Derivation of the Atomization Energy Model\nThe atomization energy, $D_e(M;a)$, of a molecule $M$ composed of atoms $\\{A_i\\}$ is defined as the energy difference between the constituent atoms and the molecule:\n$$\nD_e(M;a) = \\sum_i E_{\\mathrm{tot}}(A_i;a) - E_{\\mathrm{tot}}(M;a)\n$$\nSubstituting the linear energy model for each term:\n$$\nD_e(M;a) = \\sum_i \\left( E_{\\mathrm{sl}}(A_i) + a \\cdot \\Delta_x(A_i) \\right) - \\left( E_{\\mathrm{sl}}(M) + a \\cdot \\Delta_x(M) \\right)\n$$\nBy rearranging and grouping terms by powers of $a$, we obtain a linear model for the atomization energy:\n$$\nD_e(M;a) = \\left( \\sum_i E_{\\mathrm{sl}}(A_i) - E_{\\mathrm{sl}}(M) \\right) + a \\cdot \\left( \\sum_i \\Delta_x(A_i) - \\Delta_x(M) \\right)\n$$\nLet us define the semilocal atomization energy, $D_e^{\\mathrm{sl}}(M)$, and the corresponding exchange correction term, $\\Delta D_x(M)$:\n$$\nD_e^{\\mathrm{sl}}(M) = \\sum_i E_{\\mathrm{sl}}(A_i) - E_{\\mathrm{sl}}(M)\n$$\n$$\n\\Delta D_x(M) = \\sum_i \\Delta_x(A_i) - \\Delta_x(M)\n$$\nThe model simplifies to:\n$$\nD_e(M;a) = D_e^{\\mathrm{sl}}(M) + a \\cdot \\Delta D_x(M)\n$$\n\nStep 2: Derivation of the Barrier Height Model\nThe barrier height, $B(a)$, for the reaction $\\mathrm{H} + \\mathrm{H}_2 \\to \\mathrm{H}_3^{\\ddagger}$ is defined as the energy difference between the transition state and the reactants:\n$$\nB(a) = E_{\\mathrm{tot}}(\\mathrm{H}_3^{\\ddagger};a) - \\left( E_{\\mathrm{tot}}(\\mathrm{H};a) + E_{\\mathrm{tot}}(\\mathrm{H}_2;a) \\right)\n$$\nSubstituting the linear energy model:\n$$\nB(a) = \\left( E_{\\mathrm{sl}}(\\mathrm{H}_3^{\\ddagger}) + a \\cdot \\Delta_x(\\mathrm{H}_3^{\\ddagger}) \\right) - \\left[ \\left( E_{\\mathrm{sl}}(\\mathrm{H}) + a \\cdot \\Delta_x(\\mathrm{H}) \\right) + \\left( E_{\\mathrm{sl}}(\\mathrm{H}_2) + a \\cdot \\Delta_x(\\mathrm{H}_2) \\right) \\right]\n$$\nRearranging the terms yields a linear model for the barrier height:\n$$\nB(a) = \\left( E_{\\mathrm{sl}}(\\mathrm{H}_3^{\\ddagger}) - E_{\\mathrm{sl}}(\\mathrm{H}) - E_{\\mathrm{sl}}(\\mathrm{H}_2) \\right) + a \\cdot \\left( \\Delta_x(\\mathrm{H}_3^{\\ddagger}) - \\Delta_x(\\mathrm{H}) - \\Delta_x(\\mathrm{H}_2) \\right)\n$$\nLet us define the semilocal barrier height, $B^{\\mathrm{sl}}$, and its exchange correction, $\\Delta B_x$:\n$$\nB^{\\mathrm{sl}} = E_{\\mathrm{sl}}(\\mathrm{H}_3^{\\ddagger}) - E_{\\mathrm{sl}}(\\mathrm{H}) - E_{\\mathrm{sl}}(\\mathrm{H}_2)\n$$\n$$\n\\Delta B_x = \\Delta_x(\\mathrm{H}_3^{\\ddagger}) - \\Delta_x(\\mathrm{H}) - \\Delta_x(\\mathrm{H}_2)\n$$\nThe model for the barrier height becomes:\n$$\nB(a) = B^{\\mathrm{sl}} + a \\cdot \\Delta B_x\n$$\n\nStep 3: Calculation of Model Parameters\nUsing the provided data, we compute the parameters for our linear models. All energies are in hartree.\n\nFor $\\mathrm{H}_2$:\n$D_e^{\\mathrm{sl}}(\\mathrm{H}_2) = 2 \\cdot E_{\\mathrm{sl}}(\\mathrm{H}) - E_{\\mathrm{sl}}(\\mathrm{H}_2) = 2 \\cdot (-0.500) - (-1.174) = 0.174$\n$\\Delta D_x(\\mathrm{H}_2) = 2 \\cdot \\Delta_x(\\mathrm{H}) - \\Delta_x(\\mathrm{H}_2) = 2 \\cdot (-0.025) - (-0.030) = -0.020$\n$D_e(\\mathrm{H}_2; a) = 0.174 - 0.020 \\cdot a$\n\nFor $\\mathrm{CH}_4$:\n$D_e^{\\mathrm{sl}}(\\mathrm{CH}_4) = E_{\\mathrm{sl}}(\\mathrm{C}) + 4 \\cdot E_{\\mathrm{sl}}(\\mathrm{H}) - E_{\\mathrm{sl}}(\\mathrm{CH}_4) = -37.600 + 4 \\cdot (-0.500) - (-40.235) = 0.635$\n$\\Delta D_x(\\mathrm{CH}_4) = \\Delta_x(\\mathrm{C}) + 4 \\cdot \\Delta_x(\\mathrm{H}) - \\Delta_x(\\mathrm{CH}_4) = -0.500 + 4 \\cdot (-0.025) - (-0.400) = -0.200$\n$D_e(\\mathrm{CH}_4; a) = 0.635 - 0.200 \\cdot a$\n\nFor $\\mathrm{H}_2\\mathrm{O}$:\n$D_e^{\\mathrm{sl}}(\\mathrm{H}_2\\mathrm{O}) = 2 \\cdot E_{\\mathrm{sl}}(\\mathrm{H}) + E_{\\mathrm{sl}}(\\mathrm{O}) - E_{\\mathrm{sl}}(\\mathrm{H}_2\\mathrm{O}) = 2 \\cdot (-0.500) - 74.800 - (-76.180) = 0.380$\n$\\Delta D_x(\\mathrm{H}_2\\mathrm{O}) = 2 \\cdot \\Delta_x(\\mathrm{H}) + \\Delta_x(\\mathrm{O}) - \\Delta_x(\\mathrm{H}_2\\mathrm{O}) = 2 \\cdot (-0.025) - 0.650 - (-0.500) = -0.200$\n$D_e(\\mathrm{H}_2\\mathrm{O}; a) = 0.380 - 0.200 \\cdot a$\n\nFor the reaction barrier:\n$B^{\\mathrm{sl}} = E_{\\mathrm{sl}}(\\mathrm{H}_3^{\\ddagger}) - E_{\\mathrm{sl}}(\\mathrm{H}) - E_{\\mathrm{sl}}(\\mathrm{H}_2) = -1.664 - (-0.500) - (-1.174) = 0.010$\n$\\Delta B_x = \\Delta_x(\\mathrm{H}_3^{\\ddagger}) - \\Delta_x(\\mathrm{H}) - \\Delta_x(\\mathrm{H}_2) = -0.020 - (-0.025) - (-0.030) = 0.035$\n$B(a) = 0.010 + 0.035 \\cdot a$\n\nStep 4: Computation of Errors for the Test Suite\nWe now compute the mean absolute error for atomization energies ($\\mathrm{MAE}(a)$) and the absolute error for the barrier height ($|B(a) - B^{\\mathrm{ref}}|$) for each $a \\in \\{0.0, 0.15, 0.25, 0.50, 1.00\\}$.\n\nFor $a=0.0$:\n$D_e(\\mathrm{H}_2; 0.0) = 0.174$, error = $|0.174 - 0.1746| = 0.0006$\n$D_e(\\mathrm{CH}_4; 0.0) = 0.635$, error = $|0.635 - 0.6250| = 0.0100$\n$D_e(\\mathrm{H}_2\\mathrm{O}; 0.0) = 0.380$, error = $|0.380 - 0.3700| = 0.0100$\n$\\mathrm{MAE}(0.0) = (0.0006 + 0.0100 + 0.0100) / 3 \\approx 0.006867$\n$B(0.0) = 0.010$, error = $|0.010 - 0.0150| = 0.0050$\n\nFor $a=0.15$:\n$D_e(\\mathrm{H}_2; 0.15) = 0.171$, error = $|0.171 - 0.1746| = 0.0036$\n$D_e(\\mathrm{CH}_4; 0.15) = 0.605$, error = $|0.605 - 0.6250| = 0.0200$\n$D_e(\\mathrm{H}_2\\mathrm{O}; 0.15) = 0.350$, error = $|0.350 - 0.3700| = 0.0200$\n$\\mathrm{MAE}(0.15) = (0.0036 + 0.0200 + 0.0200) / 3 \\approx 0.014533$\n$B(0.15) = 0.01525$, error = $|0.01525 - 0.0150| = 0.00025$\n\nFor $a=0.25$:\n$D_e(\\mathrm{H}_2; 0.25) = 0.169$, error = $|0.169 - 0.1746| = 0.0056$\n$D_e(\\mathrm{CH}_4; 0.25) = 0.585$, error = $|0.585 - 0.6250| = 0.0400$\n$D_e(\\mathrm{H}_2\\mathrm{O}; 0.25) = 0.330$, error = $|0.330 - 0.3700| = 0.0400$\n$\\mathrm{MAE}(0.25) = (0.0056 + 0.0400 + 0.0400) / 3 \\approx 0.028533$\n$B(0.25) = 0.01875$, error = $|0.01875 - 0.0150| = 0.00375$\n\nFor $a=0.50$:\n$D_e(\\mathrm{H}_2; 0.50) = 0.164$, error = $|0.164 - 0.1746| = 0.0106$\n$D_e(\\mathrm{CH}_4; 0.50) = 0.535$, error = $|0.535 - 0.6250| = 0.0900$\n$D_e(\\mathrm{H}_2\\mathrm{O}; 0.50) = 0.280$, error = $|0.280 - 0.3700| = 0.0900$\n$\\mathrm{MAE}(0.50) = (0.0106 + 0.0900 + 0.0900) / 3 \\approx 0.063533$\n$B(0.50) = 0.0275$, error = $|0.0275 - 0.0150| = 0.0125$\n\nFor $a=1.00$:\n$D_e(\\mathrm{H}_2; 1.00) = 0.154$, error = $|0.154 - 0.1746| = 0.0206$\n$D_e(\\mathrm{CH}_4; 1.00) = 0.435$, error = $|0.435 - 0.6250| = 0.1900$\n$D_e(\\mathrm{H}_2\\mathrm{O}; 1.00) = 0.180$, error = $|0.180 - 0.3700| = 0.1900$\n$\\mathrm{MAE}(1.00) = (0.0206 + 0.1900 + 0.1900) / 3 \\approx 0.133533$\n$B(1.00) = 0.045$, error = $|0.045 - 0.0150| = 0.0300$\n\nThe results illustrate the well-known trade-off in hybrid DFT: lower values of $a$ (e.g., $a=0$) are better for thermochemistry (smaller $\\mathrm{MAE}$), while higher values of $a$ are needed to correct the self-interaction error that plagues semilocal functionals, leading to systematically underestimated barrier heights. The barrier height error is minimized near $a=0.15$ for this system, while the thermochemical error is minimized at $a=0.0$. This conflict is a fundamental challenge in the design of broadly applicable density functionals.\nThe implementation will now proceed based on these calculations.", "answer": "[0.006867,0.005000,0.014533,0.000250,0.028533,0.003750,0.063533,0.012500,0.133533,0.030000]", "id": "2903641"}]}