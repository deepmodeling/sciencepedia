{"hands_on_practices": [{"introduction": "Before embarking on the complex machinery of integral evaluation, it is essential to understand the landscape of integrals that a quantum chemical calculation requires. This exercise guides you through a foundational thought experiment on the simplest molecule, $\\mathrm{H_2}$, to demonstrate how the number of unique integrals is dramatically reduced by exploiting molecular symmetry. Mastering this practice hones your ability to apply principles of hermiticity and spatial symmetry to identify a minimal, non-redundant set of integrals, a cornerstone of efficient algorithm design in quantum chemistry [@problem_id:2910082].", "problem": "Consider the minimal atomic-orbital basis description of the dihydrogen molecule $\\mathrm{H_2}$ at a fixed internuclear separation. Let the basis be $\\{\\chi_A,\\chi_B\\}$, where $\\chi_A$ and $\\chi_B$ are real, normalized, hydrogenic $1s$-like functions centered on nuclei $A$ and $B$, respectively. Define the overlap integrals $S_{\\mu\\nu}=\\langle \\chi_\\mu|\\chi_\\nu\\rangle$, the one-electron (core) integrals $h_{\\mu\\nu}=\\langle \\chi_\\mu|\\hat{T}+\\hat{V}_{ne}|\\chi_\\nu\\rangle$ with $\\hat{T}$ the kinetic energy operator and $\\hat{V}_{ne}$ the electron–nuclear attraction operator for the two equal nuclear charges, and the two-electron (electron–electron repulsion) integrals in chemists’ notation\n$$(\\mu\\nu|\\lambda\\sigma)=\\iint \\chi_\\mu(\\mathbf{r}_1)\\chi_\\nu(\\mathbf{r}_1)\\frac{1}{r_{12}}\\chi_\\lambda(\\mathbf{r}_2)\\chi_\\sigma(\\mathbf{r}_2)\\,d\\mathbf{r}_1\\,d\\mathbf{r}_2.$$\nAssume the nuclei are identical and the molecule is collinear with an inversion center at the midpoint, and assume all basis functions are real and individually normalized. Using only these definitions and symmetry arguments (hermiticity, real-valuedness, homonuclear interchange $A\\leftrightarrow B$, and the intrinsic permutation symmetries of $(\\mu\\nu|\\lambda\\sigma)$), select the option that correctly identifies a minimal independent set of nonredundant one-electron and two-electron integrals that must be evaluated in the atomic-orbital basis to construct the Hartree–Fock Fock matrix for $\\mathrm{H_2}$, together with the symmetry-induced equalities that eliminate all other members of the corresponding integral families.\n\nA. Independent set:\n- Overlap: $S_{AB}$ (with $S_{AA}=S_{BB}=1$ by normalization and $S_{BA}=S_{AB}$ by hermiticity).\n- One-electron core: $h_{AA}$ and $h_{AB}$ (with $h_{BB}=h_{AA}$ by $A\\leftrightarrow B$ and $h_{BA}=h_{AB}$ by hermiticity).\n- Two-electron: $(AA|AA)$, $(AA|BB)$, $(AB|AB)$, $(AA|AB)$.\nRedundancies: $(BB|BB)=(AA|AA)$ by $A\\leftrightarrow B$; $(BB|AB)=(AA|AB)$ by $A\\leftrightarrow B$; all other index permutations follow from $(\\mu\\nu|\\lambda\\sigma)=(\\nu\\mu|\\lambda\\sigma)=(\\mu\\nu|\\sigma\\lambda)=(\\lambda\\sigma|\\mu\\nu)$ for real orbitals.\n\nB. Independent set:\n- Overlap: none beyond $S_{AA}=S_{BB}=1$; $S_{AB}=0$ by orthogonality of different centers.\n- One-electron core: $h_{AA}$ only; $h_{AB}=0$ by orthogonality.\n- Two-electron: $(AA|AA)$ and $(AA|BB)$ only; all mixed-center three-index objects like $(AA|AB)$ vanish by inversion symmetry; $(AB|AB)=0$ because $\\chi_A$ and $\\chi_B$ do not overlap.\n\nC. Independent set:\n- Overlap: $S_{AA}$, $S_{BB}$, $S_{AB}$ (all distinct).\n- One-electron core: $h_{AA}$, $h_{BB}$, $h_{AB}$, $h_{BA}$ (all distinct).\n- Two-electron: $(AA|AA)$, $(BB|BB)$, $(AA|BB)$, $(AB|AB)$, $(AB|BA)$, $(AA|AB)$, $(BB|AB)$ (all distinct).\nRedundancies: none beyond $(\\mu\\nu|\\lambda\\sigma)=(\\nu\\mu|\\lambda\\sigma)$.\n\nD. Independent set:\n- Use symmetry-adapted molecular orbitals so only $S_{gg}=S_{uu}=1$ and $h_{gg}$, $h_{uu}$ are needed; off-diagonal one-electron and all three-center two-electron integrals vanish by symmetry; two-electron integrals reduce to $(gg|gg)$ and $(uu|uu)$ only.\nRedundancies: all others are zero in the chosen basis; no atomic-orbital two-center integrals are required.\n\nWhich option is correct?", "solution": "The task is to determine the set of unique one- and two-electron integrals over the atomic orbital basis $\\{\\chi_\\mu\\} = \\{\\chi_A, \\chi_B\\}$ by applying the given symmetry principles.\n\n**1. Overlap Integrals ($S_{\\mu\\nu}$)**\nThe overlap matrix $\\mathbf{S}$ has elements $S_{\\mu\\nu} = \\langle\\chi_\\mu|\\chi_\\nu\\rangle$.\n- **Normalization:** The basis functions are normalized, so $S_{AA} = \\langle\\chi_A|\\chi_A\\rangle = 1$ and $S_{BB} = \\langle\\chi_B|\\chi_B\\rangle = 1$. These are not integrals to be calculated but are fixed by definition.\n- **Hermiticity:** The inner product is Hermitian, so $S_{\\mu\\nu} = S_{\\nu\\mu}^*$. Since the basis functions are real, this simplifies to $S_{\\mu\\nu} = S_{\\nu\\mu}$. Thus, $S_{AB} = S_{BA}$.\n- **Homonuclear Interchange ($A \\leftrightarrow B$):** The system is unchanged by swapping the identical nuclei. This operation sends $\\chi_A \\to \\chi_B$ and $\\chi_B \\to \\chi_A$.\n    - $S_{AA} = \\langle\\chi_A|\\chi_A\\rangle \\xrightarrow{A\\leftrightarrow B} \\langle\\chi_B|\\chi_B\\rangle = S_{BB}$. This confirms $S_{AA} = S_{BB}$, consistent with normalization.\n- **Conclusion:** Of the four formal entries in the $\\mathbf{S}$ matrix, only one, $S_{AB}$, is an independent, non-trivial integral that must be evaluated.\n\n**2. One-Electron Core Integrals ($h_{\\mu\\nu}$)**\nThe core Hamiltonian matrix $\\mathbf{h}$ has elements $h_{\\mu\\nu} = \\langle\\chi_\\mu|\\hat{h}|\\chi_\\nu\\rangle$, where the core Hamiltonian operator $\\hat{h}=\\hat{T}+\\hat{V}_{ne}$ is symmetric with respect to nuclear interchange.\n- **Hermiticity:** $\\hat{h}$ is a Hermitian operator. For a real basis, this implies $h_{\\mu\\nu} = h_{\\nu\\mu}$. Thus, $h_{AB} = h_{BA}$.\n- **Homonuclear Interchange ($A \\leftrightarrow B$):**\n    - $h_{AA} = \\langle\\chi_A|\\hat{h}|\\chi_A\\rangle \\xrightarrow{A\\leftrightarrow B} \\langle\\chi_B|\\hat{h}|\\chi_B\\rangle = h_{BB}$.\n- **Conclusion:** Of the four entries in the $\\mathbf{h}$ matrix, there are only two independent integrals to evaluate: the Coulomb-type integral $h_{AA}$ and the resonance integral $h_{AB}$.\n\n**3. Two-Electron Integrals ($(\\mu\\nu|\\lambda\\sigma)$)**\nThere are $2^4 = 16$ such integrals. We reduce this number using symmetry.\n- **Intrinsic Permutation Symmetry (real orbitals):** The definition of the integral leads to several identities.\n    1.  $(\\mu\\nu|\\lambda\\sigma) = (\\nu\\mu|\\lambda\\sigma)$ (symmetry within electron 1 distribution)\n    2.  $(\\mu\\nu|\\lambda\\sigma) = (\\mu\\nu|\\sigma\\lambda)$ (symmetry within electron 2 distribution)\n    3.  $(\\mu\\nu|\\lambda\\sigma) = (\\lambda\\sigma|\\mu\\nu)$ (swapping electron 1 and 2 coordinates)\n    These relations taken together generate an 8-fold permutation symmetry for general indices.\n- **Homonuclear Interchange ($A \\leftrightarrow B$):** This symmetry relates integrals by swapping all $A$ and $B$ labels.\n\nLet us enumerate the distinct classes of integrals:\n- **One-center:** $(AA|AA)$. The integral $(BB|BB)$ is related by homonuclear symmetry: $(BB|BB) = (AA|AA)$. This is one independent integral.\n- **Two-center, Coulomb:** $(AA|BB)$. Note that $(\\mu\\nu|\\lambda\\sigma) = (\\lambda\\sigma|\\mu\\nu)$ implies $(AA|BB) = (BB|AA)$, which is also evident from homonuclear symmetry. This is a second independent integral.\n- **Two-center, hybrid:** $(AA|AB)$. There are formally $8$ integrals of this type (3 indices of one type, 1 of the other), e.g., $(AA|BA)$, $(AB|AA)$, $(BB|AB)$, etc.\n    - Intrinsic symmetry: $(AA|AB) = (AA|BA)$ and $(AA|AB) = (AB|AA)$. All permutations of $(AA|AB)$ without changing index counts are equal.\n    - Homonuclear symmetry: $(AA|AB) \\xrightarrow{A\\leftrightarrow B} (BB|BA)$.\n    - We know from intrinsic symmetry that $(BB|BA) = (BB|AB)$. Therefore, all integrals with three of one index and one of the other are related to $(AA|AB)$. This is a third independent integral.\n- **Two-center, exchange-type:** $(AB|AB)$. There are formally $4$ integrals of this type, $(AB|AB)$, $(AB|BA)$, $(BA|AB)$, and $(BA|BA)$.\n    - Intrinsic symmetry shows these are all equal. For example, $(AB|AB) = (BA|AB)$ by symmetry (1). Also, $(AB|AB) = (AB|BA)$ by symmetry (2). Finally, $(AB|AB) = (AB|AB)$ from symmetry (3). Thus we have $(AB|AB) = (BA|AB) = (AB|BA) = (BA|BA)$. This is a fourth independent integral.\n\n**Summary of Independent Integrals:**\n- **Overlap:** $S_{AB}$ ($1$ value)\n- **One-electron:** $h_{AA}$, $h_{AB}$ ($2$ values)\n- **Two-electron:** $(AA|AA)$, $(AA|BB)$, $(AA|AB)$, $(AB|AB)$ ($4$ values)\n\nNow, we evaluate the given options.\n\n**Option A Analysis**\n- **Independent set:** Proposes $S_{AB}$; $h_{AA}$ and $h_{AB}$; and $(AA|AA)$, $(AA|BB)$, $(AB|AB)$, $(AA|AB)$. This matches our derived minimal independent set precisely.\n- **Redundancies:**\n    - Correctly states $S_{AA}=S_{BB}=1$ and $S_{BA}=S_{AB}$.\n    - Correctly states $h_{BB}=h_{AA}$ and $h_{BA}=h_{AB}$.\n    - Correctly states $(BB|BB)=(AA|AA)$.\n    - Correctly states $(BB|AB) = (AA|AB)$. As derived, $(AA|AB) \\xrightarrow{A\\leftrightarrow B} (BB|BA)$. Also $(BB|BA) = (BB|AB)$ by intrinsic permutation symmetry. So the relation holds.\n    - Correctly identifies the source of other redundancies as the intrinsic permutation symmetries.\nThis option is a complete and correct accounting of the problem.\n\n**Option B Analysis**\n- This option claims $S_{AB}=0$ and $h_{AB}=0$ because atomic orbitals on different centers are orthogonal. This premise is fundamentally false. Atomic orbitals in a molecular context are non-orthogonal, and their overlap is essential for describing chemical bonding. For $1s$ orbitals, $S_{AB} > 0$. The integral $h_{AB}$ is the resonance integral, which is also non-zero and negative, and is the primary source of the bond energy.\n- It further claims that integrals such as $(AA|AB)$ and $(AB|AB)$ are zero, which is also incorrect and follows from the same flawed premise. The overlap density $\\chi_A(\\mathbf{r})\\chi_B(\\mathbf{r})$ is not zero, and therefore $(AB|AB)$ is not zero.\n\n**Option C Analysis**\n- This option claims that $S_{AA}$, $S_{BB}$, $S_{AB}$ are all distinct, which violates homonuclear symmetry ($S_{AA}=S_{BB}=1$).\n- It claims $h_{AA}, h_{BB}, h_{AB}, h_{BA}$ are all distinct, which violates both homonuclear symmetry ($h_{AA}=h_{BB}$) and Hermiticity ($h_{AB}=h_{BA}$).\n- It lists a large number of two-electron integrals as distinct, failing to apply homonuclear symmetry (e.g., $(AA|AA)=(BB|BB)$) and intrinsic permutation symmetries (e.g., $(AB|AB)=(AB|BA)$).\n- This option demonstrates a failure to apply any of the relevant symmetries, apart from the most trivial one.\n\n**Option D Analysis**\n- This option proposes to switch from the atomic orbital (AO) basis to the symmetry-adapted molecular orbital (MO) basis. The question explicitly asks for the analysis **in the atomic-orbital basis**. Therefore, this option does not answer the question posed.\n- Furthermore, its claims about the MO basis are themselves flawed. While some off-diagonal and odd-symmetry integrals do vanish in the MO basis (e.g., $\\langle g | \\hat{h} | u \\rangle = 0$, $(gg|gu)=0$), it incorrectly claims that the two-electron integrals reduce to only $(gg|gg)$ and $(uu|uu)$. This is false; the integrals $(gg|uu)$ (Coulomb) and $(gu|gu)$ (exchange) are also non-zero and are essential for describing electron correlation and excited states.\n\nBased on the rigorous application of symmetry principles, only Option A provides a correct and complete description of the independent integrals and their associated redundancy relations in the atomic orbital basis.", "answer": "$$\\boxed{A}$$", "id": "2910082"}, {"introduction": "Having established how to enumerate the necessary integrals, we now turn to their evaluation, where symmetry once again provides powerful shortcuts. Many integrals that appear formally non-trivial can be shown to be exactly zero through simple parity arguments, saving immense computational effort. This practice offers a concrete example, demonstrating how analyzing the odd/even character of the integrand with respect to a coordinate reflection can instantly resolve the value of a multi-center integral without resorting to complex algebra [@problem_id:2910096].", "problem": "Consider three normalized Cartesian Gaussian primitive basis functions in atomic units: a $p_x$-type orbital $\\phi_{p_x}(\\mathbf{r})$ with exponent $\\alpha$, an $s$-type orbital $\\phi_{s}(\\mathbf{r})$ with exponent $\\beta$, and an auxiliary $s$-type orbital $\\chi_{P_s}(\\mathbf{r})$ with exponent $\\gamma$. Let all three functions be centered at the common point $\\mathbf{A} = \\mathbf{B} = \\mathbf{C} = (0,0,0)$. Take the explicit exponents to be $\\alpha = 0.7$, $\\beta = 0.9$, and $\\gamma = 1.1$. The functions are the usual normalized Cartesian Gaussian primitives, meaning that each function is the product of a Cartesian polynomial and a spherical Gaussian, multiplied by the standard normalization constant appropriate for its angular momentum and exponent.\n\nDefine the three-center Coulomb integral\n$$\n(\\mu\\,\\nu \\mid P) \\equiv \\int_{\\mathbb{R}^3} \\int_{\\mathbb{R}^3} \\phi_{\\mu}(\\mathbf{r}_1)\\,\\phi_{\\nu}(\\mathbf{r}_1)\\,\\frac{1}{\\lvert \\mathbf{r}_1 - \\mathbf{r}_2\\rvert}\\,\\chi_{P}(\\mathbf{r}_2)\\,d\\mathbf{r}_1\\,d\\mathbf{r}_2,\n$$\nwhere the Coulomb kernel $1/\\lvert \\mathbf{r}_1 - \\mathbf{r}_2\\rvert$ is in atomic units.\n\nStarting only from the fundamental definitions of normalized Cartesian Gaussian primitives, their parity under spatial inversion of a single Cartesian coordinate, and the evenness of the Coulomb kernel with respect to such inversions, determine the exact value of the three-center integral\n$$\n(p_x\\,s \\mid P_s)\n$$\nfor the specified exponents and common center. Then, verify the symmetry under interchange of the orbital indices by considering the swapped integral $(s\\,p_x \\mid P_s)$ in the same setting.\n\nExpress the final integral value in atomic units as an exact number. No numerical rounding is required.", "solution": "The integral to be evaluated is given by the definition:\n$$\nI = (p_x\\,s \\mid P_s) \\equiv \\int_{\\mathbb{R}^3} \\int_{\\mathbb{R}^3} \\phi_{p_x}(\\mathbf{r}_1)\\,\\phi_{s}(\\mathbf{r}_1)\\,\\frac{1}{\\lvert \\mathbf{r}_1 - \\mathbf{r}_2\\rvert}\\,\\chi_{P_s}(\\mathbf{r}_2)\\,d\\mathbf{r}_1\\,d\\mathbf{r}_2\n$$\nThis integral represents the electrostatic repulsion energy between a charge distribution $\\rho_A(\\mathbf{r}_1)$ and a charge distribution $\\rho_B(\\mathbf{r}_2)$, where:\n$$\n\\rho_A(\\mathbf{r}_1) = \\phi_{p_x}(\\mathbf{r}_1)\\,\\phi_{s}(\\mathbf{r}_1)\n$$\n$$\n\\rho_B(\\mathbf{r}_2) = \\chi_{P_s}(\\mathbf{r}_2)\n$$\nWe can reformulate the integral by first calculating the electrostatic potential $V_B(\\mathbf{r}_1)$ generated by the charge distribution $\\rho_B(\\mathbf{r}_2)$:\n$$\nV_B(\\mathbf{r}_1) = \\int_{\\mathbb{R}^3} \\frac{\\rho_B(\\mathbf{r}_2)}{\\lvert \\mathbf{r}_1 - \\mathbf{r}_2\\rvert} \\,d\\mathbf{r}_2\n$$\nThe total integral then becomes the energy of interaction between the charge distribution $\\rho_A(\\mathbf{r}_1)$ and the potential $V_B(\\mathbf{r}_1)$:\n$$\nI = \\int_{\\mathbb{R}^3} \\rho_A(\\mathbf{r}_1)\\,V_B(\\mathbf{r}_1)\\,d\\mathbf{r}_1\n$$\nThe problem demands a solution based on parity, which we shall now apply. Let $\\mathbf{r} = (x, y, z)$.\n\nFirst, we analyze the symmetry of the charge distribution $\\rho_A(\\mathbf{r}_1)$, where $\\mathbf{r}_1 = (x_1, y_1, z_1)$.\nThe function $\\phi_{s}(\\mathbf{r}_1)$ is an $s$-type Gaussian primitive centered at the origin. Its functional form is $N_s \\exp(-\\beta r_1^2)$, where $r_1 = |\\mathbf{r}_1|$. This function is spherically symmetric and therefore an even function with respect to the inversion of any Cartesian coordinate. Specifically, it is even under the reflection $x_1 \\to -x_1$.\nThe function $\\phi_{p_x}(\\mathbf{r}_1)$ is a $p_x$-type Gaussian primitive centered at the origin. Its functional form is $N_{p_x} x_1 \\exp(-\\alpha r_1^2)$. The presence of the linear factor $x_1$ makes this function odd with respect to the reflection $x_1 \\to -x_1$:\n$$\n\\phi_{p_x}(-x_1, y_1, z_1) = N_{p_x} (-x_1) \\exp(-\\alpha ((-x_1)^2 + y_1^2 + z_1^2)) = - \\phi_{p_x}(x_1, y_1, z_1)\n$$\nThe charge distribution $\\rho_A(\\mathbf{r}_1)$ is the product of an odd function ($\\phi_{p_x}$) and an even function ($\\phi_s$) with respect to the coordinate $x_1$. The product of an odd and an even function is odd. Therefore, $\\rho_A(\\mathbf{r}_1)$ is an odd function with respect to the reflection $x_1 \\to -x_1$:\n$$\n\\rho_A(-x_1, y_1, z_1) = \\phi_{p_x}(-x_1, y_1, z_1)\\,\\phi_{s}(-x_1, y_1, z_1) = [-\\phi_{p_x}(x_1, y_1, z_1)]\\,[\\phi_{s}(x_1, y_1, z_1)] = -\\rho_A(x_1, y_1, z_1)\n$$\n\nSecond, we analyze the symmetry of the electrostatic potential $V_B(\\mathbf{r}_1)$. This potential is generated by the charge distribution $\\rho_B(\\mathbf{r}_2) = \\chi_{P_s}(\\mathbf{r}_2)$. The function $\\chi_{P_s}(\\mathbf{r}_2)$ is an $s$-type Gaussian primitive centered at the origin, and is thus spherically symmetric. A fundamental theorem of electrostatics, a consequence of Gauss's Law, states that the electrostatic potential generated by a spherically symmetric charge distribution is itself spherically symmetric. Thus, the potential $V_B(\\mathbf{r}_1)$ depends only on the distance from the origin, $r_1 = |\\mathbf{r}_1| = \\sqrt{x_1^2 + y_1^2 + z_1^2}$. A function that depends only on $r_1$ is an even function with respect to the inversion of any of its Cartesian coordinates. Hence, $V_B(\\mathbf{r}_1)$ is an even function with respect to the reflection $x_1 \\to -x_1$:\n$$\nV_B(-x_1, y_1, z_1) = V_B(\\sqrt{(-x_1)^2 + y_1^2 + z_1^2}) = V_B(\\sqrt{x_1^2 + y_1^2 + z_1^2}) = V_B(x_1, y_1, z_1)\n$$\n\nNow, we examine the integrand of the integral $I = \\int_{\\mathbb{R}^3} \\rho_A(\\mathbf{r}_1)\\,V_B(\\mathbf{r}_1)\\,d\\mathbf{r}_1$. The integrand is the product of $\\rho_A(\\mathbf{r}_1)$, which is odd in $x_1$, and $V_B(\\mathbf{r}_1)$, which is even in $x_1$. The product of an odd function and an even function is an odd function. Therefore, the total integrand $F(\\mathbf{r}_1) = \\rho_A(\\mathbf{r}_1)V_B(\\mathbf{r}_1)$ is an odd function of $x_1$.\n\nThe integral $I$ is performed over all space $\\mathbb{R}^3$, which can be written as:\n$$\nI = \\int_{-\\infty}^{\\infty} dy_1 \\int_{-\\infty}^{\\infty} dz_1 \\left[ \\int_{-\\infty}^{\\infty} F(x_1, y_1, z_1)\\,dx_1 \\right]\n$$\nThe inner integral with respect to $x_1$ is an integral of an odd function over a symmetric interval $(-\\infty, \\infty)$. Such an integral is identically zero.\n$$\n\\int_{-\\infty}^{\\infty} F(x_1, y_1, z_1)\\,dx_1 = 0\n$$\nConsequently, the total integral $I$ is zero. The specific numerical values of the exponents $\\alpha = 0.7$, $\\beta = 0.9$, and $\\gamma = 1.1$ are entirely irrelevant to this conclusion, which follows strictly from the symmetry properties of the functions involved.\n\nFor the verification task, we must consider the swapped integral $(s\\,p_x \\mid P_s)$.\n$$\nI' = (s\\,p_x \\mid P_s) = \\int_{\\mathbb{R}^3} \\int_{\\mathbb{R}^3} \\phi_{s}(\\mathbf{r}_1)\\,\\phi_{p_x}(\\mathbf{r}_1)\\,\\frac{1}{\\lvert \\mathbf{r}_1 - \\mathbf{r}_2\\rvert}\\,\\chi_{P_s}(\\mathbf{r}_2)\\,d\\mathbf{r}_1\\,d\\mathbf{r}_2\n$$\nThe charge distribution for electron $1$ is now $\\rho'_A(\\mathbf{r}_1) = \\phi_s(\\mathbf{r}_1)\\phi_{p_x}(\\mathbf{r}_1)$. Since the multiplication of scalar functions is commutative, $\\rho'_A(\\mathbf{r}_1) = \\phi_{p_x}(\\mathbf{r}_1)\\phi_s(\\mathbf{r}_1) = \\rho_A(\\mathbf{r}_1)$. The rest of the integral expression remains identical. Therefore, the same symmetry argument applies, and $I'$ must also be zero. This confirms that $(s\\,p_x \\mid P_s) = (p_x\\,s \\mid P_s)$, as expected.\nThe final value of the integral is exactly zero.", "answer": "$$\n\\boxed{0}\n$$", "id": "2910096"}, {"introduction": "We now bridge the gap from conceptual analysis to practical implementation by tackling the computational heart of the matter: evaluating a general, non-zero, four-center two-electron integral. This hands-on coding exercise introduces the Obara-Saika recurrence relations, a cornerstone of modern integral engines, which systematically break down complex integrals into a sum over simpler, fundamental auxiliary integrals known as Boys functions, $F_m(T)$. By building and verifying an integral routine, you will gain direct insight into the algorithmic architecture that powers contemporary quantum chemistry software [@problem_id:2910072].", "problem": "Implement a complete, runnable program that evaluates the two-electron electron-repulsion integral between four unnormalized Cartesian Gaussian-type orbitals in atomic units for the case where the bra consists of a $p_x$ orbital on center $A$ and a $p_y$ orbital on center $B$, and the ket consists of two $s$ orbitals on centers $C$ and $D$, that is, the integral $(p_x\\,p_y \\mid s\\,s)$. The program must compute this integral twice for each test case: first by using Obara–Saika-type Hermite recursions to reduce the four-center integral to a finite sum of Boys functions, and second by independently verifying the result using a one-dimensional quadrature evaluation of the Boys function in the Rys-quadrature spirit. The final output must be a single line containing a list of floating-point absolute differences between the two evaluations, in atomic units, for all provided test cases.\n\nUse the following foundational facts as the starting point for your derivation and implementation.\n\n- Each unnormalized Cartesian primitive Gaussian-type orbital centered at position $A$ with exponent $\\alpha$ and angular momentum $(\\ell_x,\\ell_y,\\ell_z)$ is given by\n  $$\n  \\phi(\\mathbf{r};\\alpha,A;\\ell_x,\\ell_y,\\ell_z) = (x-A_x)^{\\ell_x}(y-A_y)^{\\ell_y}(z-A_z)^{\\ell_z}\\exp\\!\\left(-\\alpha\\lVert \\mathbf{r}-\\mathbf{A}\\rVert^2\\right).\n  $$\n  Do not include normalization constants.\n\n- The two-electron electron-repulsion integral is\n  $$\n  (ab\\mid cd)=\\iint \\phi_a(\\mathbf{r}_1)\\,\\phi_b(\\mathbf{r}_1)\\,\\frac{1}{\\lVert \\mathbf{r}_1-\\mathbf{r}_2\\rVert}\\,\\phi_c(\\mathbf{r}_2)\\,\\phi_d(\\mathbf{r}_2)\\,d\\mathbf{r}_1\\,d\\mathbf{r}_2.\n  $$\n\n- The Gaussian product theorem: for exponents $\\alpha,\\beta&gt;0$ and centers $A,B$,\n  $$\n  \\exp(-\\alpha\\lVert \\mathbf{r}-\\mathbf{A}\\rVert^2)\\,\\exp(-\\beta\\lVert \\mathbf{r}-\\mathbf{B}\\rVert^2)\n  = \\exp\\!\\left(-(\\alpha+\\beta)\\lVert \\mathbf{r}-\\mathbf{P}\\rVert^2\\right)\\,\\exp\\!\\left(-\\frac{\\alpha\\beta}{\\alpha+\\beta}\\lVert \\mathbf{A}-\\mathbf{B}\\rVert^2\\right),\n  $$\n  where $\\mathbf{P}=\\frac{\\alpha \\mathbf{A}+\\beta \\mathbf{B}}{\\alpha+\\beta}$ and $p=\\alpha+\\beta$.\n\n- Define similarly for the ket $q=\\gamma+\\delta$ and $\\mathbf{Q}=\\frac{\\gamma \\mathbf{C}+\\delta \\mathbf{D}}{\\gamma+\\delta}$.\n\n- The Boys function of order $m\\in\\mathbb{N}_0$ is defined by\n  $$\n  F_m(T)=\\int_0^1 t^{2m}\\exp(-T t^2)\\,dt,\n  $$\n  which is a well-defined special function for all $T\\ge 0$.\n\nYour implementation must adhere to the following requirements.\n\n- Use the Obara–Saika-type Hermite recursive strategy for $(p_x\\,p_y \\mid s\\,s)$ integrals. Start from the product-center reduction implied by the Gaussian product theorem and reduce the integral to a finite sum of products of one-dimensional Hermite coefficients multiplied by Boys functions $F_m(T)$, where $T=\\frac{pq}{p+q}\\lVert \\mathbf{P}-\\mathbf{Q}\\rVert^2$. For this specific angular momentum pattern, only the Hermite expansion associated with the bra pair is nontrivial; the ket is $s\\,s$.\n\n- Independently verify the result by evaluating the same finite sum but replacing the analytical Boys function evaluation with a numerical one-dimensional quadrature over $[0,1]$ for $F_m(T)$ for each required $m$. This serves as a Rys-quadrature-style verification in which the Coulomb kernel reduction is checked via direct numerical quadrature of the Boys integral. The quadrature should be spectrally accurate on $[0,1]$ and must be implemented using a standard Gaussian quadrature on the unit interval. Do not use any pretabulated nodes or weights; generate them programmatically.\n\n- Your program must compute both values and return, for each test case, the absolute difference between the two evaluations in atomic units, as a floating-point number.\n\n- Pay careful attention to numerical stability. For small $T$, ensure a stable evaluation of $F_m(T)$ using a small-$T$ series or limiting behavior. For general $T$, ensure stable recurrence relations.\n\n- The final output must be a single line containing a list of results as a comma-separated list enclosed in square brackets. The $k$-th entry must be the absolute difference for the $k$-th test case.\n\nUse the following fixed test suite. In all cases, all coordinates are in bohr radii and all exponents are in inverse square bohr units, and the required output is in atomic units.\n\n- Test case 1 (general well-separated centers):\n  - $A=(0.0,\\,0.1,\\,-0.2)$, $B=(1.1,\\,-0.7,\\,0.3)$, $C=(-0.9,\\,0.4,\\,-1.2)$, $D=(0.6,\\,-0.3,\\,0.8)$.\n  - $\\alpha=0.7$, $\\beta=0.9$, $\\gamma=0.5$, $\\delta=1.3$.\n\n- Test case 2 (coincident bra centers):\n  - $A=(0.0,\\,0.0,\\,0.0)$, $B=(0.0,\\,0.0,\\,0.0)$, $C=(0.5,\\,0.5,\\,0.5)$, $D=(-0.5,\\,-0.5,\\,-0.5)$.\n  - $\\alpha=1.0$, $\\beta=1.0$, $\\gamma=0.8$, $\\delta=0.8$.\n\n- Test case 3 (diffuse exponents):\n  - $A=(0.2,\\,-0.1,\\,0.3)$, $B=(0.4,\\,0.1,\\,-0.2)$, $C=(-0.3,\\,0.2,\\,0.1)$, $D=(0.1,\\,-0.4,\\,0.2)$.\n  - $\\alpha=0.05$, $\\beta=0.06$, $\\gamma=0.07$, $\\delta=0.08$.\n\n- Test case 4 (nearly coincident product centers $\\mathbf{P}$ and $\\mathbf{Q}$):\n  - $A=(0.0,\\,0.0,\\,0.0)$, $B=(0.2,\\,0.1,\\,-0.1)$, $C=(0.1,\\,0.05,\\,-0.05)$, $D=(0.3,\\,0.15,\\,-0.15)$.\n  - $\\alpha=1.0$, $\\beta=1.2$, $\\gamma=1.1$, $\\delta=1.3$.\n\nProgram specification and output formatting:\n\n- The program must be fully self-contained and executable without user input.\n\n- For each test case, compute the $(p_x\\,p_y \\mid s\\,s)$ integral twice as specified and append the absolute difference of the two values, expressed as a floating-point number in atomic units, to a results list.\n\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[r1,r2,r3,r4]\"), where each $r_k$ is the absolute difference for test case $k$.\n\n- Angles are not involved in this problem; no angle unit specification is necessary.\n\n- All outputs must be floating-point numbers; do not round or truncate beyond the default string conversion used by the language runtime.\n\nEnsure scientific realism: use the exact forms implied by the Gaussian product theorem and well-defined Boys functions, avoiding any ad hoc approximations beyond controlled numerical quadrature for verification.", "solution": "The objective is to evaluate the integral $I = (p_x p_y \\mid s s)$. First, we apply the Gaussian Product Theorem to consolidate the four GTOs into two product Gaussians centered at $\\mathbf{P}$ and $\\mathbf{Q}$.\n\nThe integral is expressed as:\n$$\nI = \\iint (x_1-A_x)e^{-\\alpha\\lVert\\mathbf{r}_1-\\mathbf{A}\\rVert^2} (y_1-B_y)e^{-\\beta\\lVert\\mathbf{r}_1-\\mathbf{B}\\rVert^2} \\frac{1}{r_{12}} e^{-\\gamma\\lVert\\mathbf{r}_2-\\mathbf{C}\\rVert^2} e^{-\\delta\\lVert\\mathbf{r}_2-\\mathbf{D}\\rVert^2} d\\mathbf{r}_1 d\\mathbf{r}_2\n$$\nwhere $r_{12} = \\lVert\\mathbf{r}_1-\\mathbf{r}_2\\rVert$.\n\nApplying the theorem, the integral becomes:\n$$\nI = K_{AB} K_{CD} \\iint (x_1-A_x)(y_1-B_y) e^{-p\\lVert\\mathbf{r}_1-\\mathbf{P}\\rVert^2} \\frac{1}{r_{12}} e^{-q\\lVert\\mathbf{r}_2-\\mathbf{Q}\\rVert^2} d\\mathbf{r}_1 d\\mathbf{r}_2\n$$\nThe pre-exponential Cartesian factors for the bra, $(x_1-A_x)$ and $(y_1-B_y)$, must be re-expressed in terms of the new center $\\mathbf{P}$:\n$$\nx_1-A_x = (x_1-P_x) + (P_x-A_x)\n$$\n$$\ny_1-B_y = (y_1-P_y) + (P_y-B_y)\n$$\nThe product of these terms expands into four components:\n$$\n(x_1-A_x)(y_1-B_y) = (x_1-P_x)(y_1-P_y) + (P_y-B_y)(x_1-P_x) + (P_x-A_x)(y_1-P_y) + (P_x-A_x)(P_y-B_y)\n$$\nSubstituting this expansion into the integral decomposes it into a sum of four simpler integrals, a strategy known as the McMurchie-Davidson transfer relations:\n$$\nI = K_{AB} K_{CD} \\left( I_{p_x p_y} + (P_y-B_y)I_{p_x} + (P_x-A_x)I_{p_y} + (P_x-A_x)(P_y-B_y)I_s \\right)\n$$\nEach term $I_{\\dots}$ represents a fundamental two-center integral involving Cartesian operators centered at $\\mathbf{P}$ and $\\mathbf{Q}$:\n$$\nI_s = (s_P s_P \\mid s_Q s_Q) = \\iint e^{-p\\lVert\\mathbf{r}_1-\\mathbf{P}\\rVert^2} \\frac{1}{r_{12}} e^{-q\\lVert\\mathbf{r}_2-\\mathbf{Q}\\rVert^2} d\\mathbf{r}_1 d\\mathbf{r}_2\n$$\n$$\nI_{p_x} = (p_{x,P} s_P \\mid s_Q s_Q) = \\iint (x_1-P_x) e^{-p\\lVert\\mathbf{r}_1-\\mathbf{P}\\rVert^2} \\frac{1}{r_{12}} e^{-q\\lVert\\mathbf{r}_2-\\mathbf{Q}\\rVert^2} d\\mathbf{r}_1 d\\mathbf{r}_2\n$$\n$$\nI_{p_y} = (p_{y,P} s_P \\mid s_Q s_Q) = \\iint (y_1-P_y) e^{-p\\lVert\\mathbf{r}_1-\\mathbf{P}\\rVert^2} \\frac{1}{r_{12}} e^{-q\\lVert\\mathbf{r}_2-\\mathbf{Q}\\rVert^2} d\\mathbf{r}_1 d\\mathbf{r}_2\n$$\n$$\nI_{p_x p_y} = (p_{x,P} p_{y,P} \\mid s_Q s_Q) = \\iint (x_1-P_x)(y_1-P_y) e^{-p\\lVert\\mathbf{r}_1-\\mathbf{P}\\rVert^2} \\frac{1}{r_{12}} e^{-q\\lVert\\mathbf{r}_2-\\mathbf{Q}\\rVert^2} d\\mathbf{r}_1 d\\mathbf{r}_2\n$$\nThese fundamental integrals are evaluated using auxiliary integrals, denoted $(\\mathbf{a} \\mid \\mathbf{c})^{(m)}$, which are related to derivatives of the basic $(s s \\mid s s)$ integral. The fundamental result is:\n$$\n(s_P s_P \\mid s_Q s_Q)^{(m)} \\equiv (00 \\mid 00)^{(m)} = \\frac{2\\pi^{5/2}}{pq\\sqrt{p+q}} F_m(T) \\quad \\text{where } T = \\frac{pq}{p+q}\\lVert\\mathbf{P}-\\mathbf{Q}\\rVert^2\n$$\nThe required integrals are obtained via recurrence relations. The relevant recurrence for adding angular momentum to the bra is:\n$$\n(\\mathbf{a}+\\mathbf{1}_i \\mid \\mathbf{c})^{(m)} = (P_i-Q_i)(\\mathbf{a} \\mid \\mathbf{c})^{(m+1)} + \\frac{a_i}{2p}(\\mathbf{a}-\\mathbf{1}_i \\mid \\mathbf{c})^{(m+1)} + \\frac{c_i}{2(p+q)}(\\mathbf{a} \\mid \\mathbf{c}-\\mathbf{1}_i)^{(m+1)}\n$$\nFor our case, the ket angular momentum $\\mathbf{c}$ is always zero. The relation simplifies to:\n$$\n(\\mathbf{a}+\\mathbf{1}_i \\mid 0)^{(m)} = (P_i-Q_i)(\\mathbf{a} \\mid 0)^{(m+1)} + \\frac{a_i}{2p}(\\mathbf{a}-\\mathbf{1}_i \\mid 0)^{(m+1)}\n$$\nApplying this recurrence:\n- For $I_{p_x} = (1_x \\mid 0)^{(0)}$: Let $\\mathbf{a}=0$, $i=x$. The second term vanishes.\n  $I_{p_x} = (P_x-Q_x)(0 \\mid 0)^{(1)} = (P_x-Q_x)\\frac{2\\pi^{5/2}}{pq\\sqrt{p+q}}F_1(T)$.\n- Symmetrically, for $I_{p_y} = (1_y \\mid 0)^{(0)}$:\n  $I_{p_y} = (P_y-Q_y)(0 \\mid 0)^{(1)} = (P_y-Q_y)\\frac{2\\pi^{5/2}}{pq\\sqrt{p+q}}F_1(T)$.\n- For $I_{p_x p_y} = (1_x 1_y \\mid 0)^{(0)}$: First, apply the recurrence for $i=x$ to $\\mathbf{a}=(0,1,0)$.\n  $(1_x 1_y \\mid 0)^{(m)} = (P_x-Q_x)(1_y \\mid 0)^{(m+1)} + \\frac{0}{2p}(\\dots) = (P_x-Q_x)(1_y \\mid 0)^{(m+1)}$.\n  We need $(1_y \\mid 0)^{(m+1)}$, which is $(P_y-Q_y)(0 \\mid 0)^{(m+2)}$.\n  Setting $m=0$:\n  $I_{p_x p_y} = (P_x-Q_x)(P_y-Q_y)(0 \\mid 0)^{(2)} = (P_x-Q_x)(P_y-Q_y)\\frac{2\\pi^{5/2}}{pq\\sqrt{p+q}}F_2(T)$.\n\nCombining all terms, the final expression for the integral is:\n$$\nI = K_{AB}K_{CD}\\frac{2\\pi^{5/2}}{pq\\sqrt{p+q}} \\left[ (P_x-A_x)(P_y-B_y)F_0(T) + \\left((P_y-B_y)(P_x-Q_x) + (P_x-A_x)(P_y-Q_y)\\right)F_1(T) + (P_x-Q_x)(P_y-Q_y)F_2(T) \\right]\n$$\nThis formula reduces the integral evaluation to computing the Boys functions $F_0(T)$, $F_1(T)$, and $F_2(T)$.\n\n**Evaluation of Boys Functions**\n\n1.  **Analytical Method**: The Boys functions will be evaluated based on the value of $T$.\n    - For small $T$ (e.g., $T < 10^{-8}$), a direct Taylor series expansion provides a numerically stable result:\n      $$ F_m(T) = \\sum_{k=0}^{\\infty} \\frac{(-T)^k}{k!(2m+2k+1)} $$\n    - For larger $T$, we first compute $F_0(T)$ using its relation to the error function:\n      $$ F_0(T) = \\int_0^1 e^{-Tt^2}dt = \\frac{1}{2}\\sqrt{\\frac{\\pi}{T}} \\text{erf}(\\sqrt{T}) $$\n      Then, $F_1(T)$ and $F_2(T)$ are computed using the stable upward recurrence relation, which is only numerically problematic for very small $T$:\n      $$ F_m(T) = \\frac{(2m-1)F_{m-1}(T) - e^{-T}}{2T} \\quad (m \\ge 1) $$\n      This gives:\n      $$ F_1(T) = \\frac{F_0(T) - e^{-T}}{2T} $$\n      $$ F_2(T) = \\frac{3F_1(T) - e^{-T}}{2T} $$\n\n2.  **Numerical Quadrature Method**: For verification, $F_m(T) = \\int_0^1 t^{2m}e^{-Tt^2}dt$ is evaluated using Gauss-Legendre quadrature. The integration interval $[0,1]$ is mapped from the standard $[-1,1]$ interval. Given $N$ quadrature points $x_i$ and weights $w_i$ on $[-1,1]$, the integral is approximated as:\n    $$ F_m(T) \\approx \\sum_{i=1}^N \\frac{w_i}{2} \\left(\\frac{x_i+1}{2}\\right)^{2m} \\exp\\left(-T\\left(\\frac{x_i+1}{2}\\right)^2\\right) $$\n    The nodes and weights will be computed programmatically. A sufficiently large $N$ (e.g., $N=64$) ensures high accuracy.\n\nThe program will compute the integral using both methods and report the absolute difference.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.special import erf\n\ndef solve():\n    \"\"\"\n    Main solver function that orchestrates the computation for all test cases.\n    \"\"\"\n    # Test cases: [(A, B, C, D, alpha, beta, gamma, delta), ...]\n    # Coordinates are in bohr, exponents are in bohr^-2.\n    test_cases = [\n        # Test case 1: General well-separated centers\n        (\n            np.array([0.0, 0.1, -0.2]), np.array([1.1, -0.7, 0.3]),\n            np.array([-0.9, 0.4, -1.2]), np.array([0.6, -0.3, 0.8]),\n            0.7, 0.9, 0.5, 1.3\n        ),\n        # Test case 2: Coincident bra centers\n        (\n            np.array([0.0, 0.0, 0.0]), np.array([0.0, 0.0, 0.0]),\n            np.array([0.5, 0.5, 0.5]), np.array([-0.5, -0.5, -0.5]),\n            1.0, 1.0, 0.8, 0.8\n        ),\n        # Test case 3: Diffuse exponents\n        (\n            np.array([0.2, -0.1, 0.3]), np.array([0.4, 0.1, -0.2]),\n            np.array([-0.3, 0.2, 0.1]), np.array([0.1, -0.4, 0.2]),\n            0.05, 0.06, 0.07, 0.08\n        ),\n        # Test case 4: Nearly coincident product centers P and Q\n        (\n            np.array([0.0, 0.0, 0.0]), np.array([0.2, 0.1, -0.1]),\n            np.array([0.1, 0.05, -0.05]), np.array([0.3, 0.15, -0.15]),\n            1.0, 1.2, 1.1, 1.3\n        ),\n    ]\n\n    results = []\n    for case in test_cases:\n        A, B, C, D, alpha, beta, gamma, delta = case\n\n        # Method 1: Analytical Boys function evaluation\n        val_analytic = compute_pxpy_ss(A, B, C, D, alpha, beta, gamma, delta, method='analytic')\n\n        # Method 2: Numerical Boys function evaluation via quadrature\n        val_numeric = compute_pxpy_ss(A, B, C, D, alpha, beta, gamma, delta, method='numeric')\n\n        # Compute absolute difference\n        abs_diff = abs(val_analytic - val_numeric)\n        results.append(abs_diff)\n\n    # Format and print the final output\n    print(f\"[{','.join(map(str, results))}]\")\n\n\ndef boys_analytic(m_list, T):\n    \"\"\"\n    Computes Boys functions F_m(T) for m in m_list using an analytical approach.\n    Switches between a Taylor series for small T and an erf-based/recurrence method for larger T.\n    \"\"\"\n    if T < 1e-8:\n        # Small T: Use Taylor series expansion for stability\n        # F_m(T) = sum_{k=0 to inf} (-T)^k / (k! * (2m + 2k + 1))\n        results = {}\n        for m in m_list:\n            val = 0.0\n            term = 1.0 / (2 * m + 1)\n            val += term\n            for k in range(1, 20):\n                term *= -T / k * (2 * m + 2 * k - 1) / (2 * m + 2 * k + 1)\n                val += term\n            results[m] = val\n        return [results[m] for m in m_list]\n    else:\n        # Large T: Use erf for F_0(T) and upward recurrence for F_m(T)\n        sqrt_T = np.sqrt(T)\n        F0 = (np.sqrt(np.pi) / (2 * sqrt_T)) * erf(sqrt_T)\n        exp_minus_T = np.exp(-T)\n        \n        boys_vals = {0: F0}\n        max_m = max(m_list)\n        for m in range(1, max_m + 1):\n            boys_vals[m] = ((2 * m - 1) * boys_vals[m-1] - exp_minus_T) / (2 * T)\n        \n        return [boys_vals[m] for m in m_list]\n\ndef boys_numeric(m_list, T, n_points=64):\n    \"\"\"\n    Computes Boys functions F_m(T) via numerical Gauss-Legendre quadrature.\n    F_m(T) = integral_0^1 t^(2m) * exp(-T*t^2) dt\n    \"\"\"\n    nodes, weights = np.polynomial.legendre.leggauss(n_points)\n    \n    # Map nodes from [-1, 1] to [0, 1]\n    t = 0.5 * (nodes + 1.0)\n    w = 0.5 * weights\n\n    t_sq = t * t\n    exp_term = np.exp(-T * t_sq)\n    \n    results = {}\n    for m in m_list:\n        integrand = np.power(t, 2 * m) * exp_term\n        results[m] = np.sum(w * integrand)\n        \n    return [results[m] for m in m_list]\n\ndef compute_pxpy_ss(A, B, C, D, alpha, beta, gamma, delta, method='analytic'):\n    \"\"\"\n    Computes the (px py | s s) two-electron integral.\n    \n    Args:\n        A, B, C, D (np.array): Center coordinates of the GTOs.\n        alpha, beta, gamma, delta (float): Exponents of the GTOs.\n        method (str): 'analytic' or 'numeric' for Boys function evaluation.\n        \n    Returns:\n        float: The value of the integral.\n    \"\"\"\n    # Bra charge distribution\n    p = alpha + beta\n    P = (alpha * A + beta * B) / p\n    K_AB = np.exp(-alpha * beta / p * np.sum((A - B)**2))\n\n    # Ket charge distribution\n    q = gamma + delta\n    Q = (gamma * C + delta * D) / q\n    K_CD = np.exp(-gamma * delta / q * np.sum((C - D)**2))\n\n    # Argument for Boys function\n    PQ_dist_sq = np.sum((P - Q)**2)\n    T = p * q / (p + q) * PQ_dist_sq\n\n    # Get required Boys functions F_0, F_1, F_2\n    m_list_needed = sorted(list(set([0, 1, 2])))\n    if method == 'analytic':\n        F = boys_analytic(m_list_needed, T)\n    elif method == 'numeric':\n        F = boys_numeric(m_list_needed, T)\n    else:\n        raise ValueError(\"Method must be 'analytic' or 'numeric'\")\n\n    F0, F1, F2 = F[0], F[1], F[2]\n    \n    # Pre-factor for the fundamental integrals\n    prefactor = K_AB * K_CD * (2 * np.pi**2.5) / (p * q * np.sqrt(p + q))\n    \n    # McMurchie-Davidson terms\n    Px_minus_Ax = P[0] - A[0]\n    Py_minus_By = P[1] - B[1]\n    \n    Px_minus_Qx = P[0] - Q[0]\n    Py_minus_Qy = P[1] - Q[1]\n\n    term0 = Px_minus_Ax * Py_minus_By * F0\n    term1 = (Py_minus_By * Px_minus_Qx + Px_minus_Ax * Py_minus_Qy) * F1\n    term2 = Px_minus_Qx * Py_minus_Qy * F2\n\n    integral_value = prefactor * (term0 + term1 + term2)\n    \n    return integral_value\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "2910072"}]}