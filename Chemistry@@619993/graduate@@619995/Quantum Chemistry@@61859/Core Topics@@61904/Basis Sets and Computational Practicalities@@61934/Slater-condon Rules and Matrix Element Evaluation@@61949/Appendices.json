{"hands_on_practices": [{"introduction": "This exercise provides a foundational workout in applying the Slater-Condon rules from first principles. By calculating the energy of a reference determinant and its coupling to singly excited states, you will directly engage with the one- and two-electron components of the Hamiltonian. This practice is invaluable not only for mastering the formulas but also for developing a deeper intuition for how spin orthogonality leads to important selection rules, which you will confirm by explicit evaluation of the spin integrals. [@problem_id:2924391]", "problem": "Consider a nonrelativistic, spin-free electronic Hamiltonian for fixed nuclei under the Born–Oppenheimer approximation,\n$$\n\\hat{H}=\\sum_{k=1}^{N}\\hat{h}(k)+\\sum_{1\\le k<\\ell\\le N}\\hat{g}(k,\\ell),\n$$\nwith one-electron operator\n$$\n\\hat{h}(k)=-\\frac{1}{2}\\nabla_k^2-\\sum_{A}\\frac{Z_A}{|\\mathbf{r}_k-\\mathbf{R}_A|},\n$$\nand two-electron Coulomb operator\n$$\n\\hat{g}(k,\\ell)=\\frac{1}{r_{k\\ell}}.\n$$\nLet $x\\equiv(\\mathbf{r},\\omega)$ denote the combined spatial and spin coordinate. Let $\\{\\chi_p(x)\\}$ be an orthonormal set of spin-orbitals with the following five explicitly specified members built from orthonormal spatial orbitals $\\{\\phi_p(\\mathbf{r})\\}$ and spin functions $\\alpha(\\omega)$ and $\\beta(\\omega)$:\n$$\n\\chi_1(x)=\\phi_1(\\mathbf{r})\\,\\alpha(\\omega),\\quad\n\\chi_2(x)=\\phi_2(\\mathbf{r})\\,\\alpha(\\omega),\\quad\n\\chi_3(x)=\\phi_3(\\mathbf{r})\\,\\beta(\\omega),\n$$\n$$\n\\chi_4(x)=\\phi_4(\\mathbf{r})\\,\\alpha(\\omega),\\quad\n\\chi_5(x)=\\phi_5(\\mathbf{r})\\,\\beta(\\omega).\n$$\nAll spin functions are orthonormal, $\\int \\alpha^{*}(\\omega)\\alpha(\\omega)\\,d\\omega=\\int \\beta^{*}(\\omega)\\beta(\\omega)\\,d\\omega=1$ and $\\int \\alpha^{*}(\\omega)\\beta(\\omega)\\,d\\omega=0$, and all spatial orbitals are orthonormal, $\\int \\phi_p^{*}(\\mathbf{r})\\phi_q(\\mathbf{r})\\,d\\mathbf{r}=\\delta_{pq}$.\n\nConsider a system of three ($3$) electrons in the Slater determinant\n$$\n\\Phi_0(x_1,x_2,x_3)=\\frac{1}{\\sqrt{3!}}\n\\begin{vmatrix}\n\\chi_1(x_1) & \\chi_2(x_1) & \\chi_3(x_1) \\\\\n\\chi_1(x_2) & \\chi_2(x_2) & \\chi_3(x_2) \\\\\n\\chi_1(x_3) & \\chi_2(x_3) & \\chi_3(x_3)\n\\end{vmatrix}.\n$$\nDefine three singly excited determinants by orbital replacement at fixed column position (no reordering of columns): $\\Phi_1^{4}$ obtained by replacing $\\chi_1\\to\\chi_4$, $\\Phi_3^{5}$ obtained by replacing $\\chi_3\\to\\chi_5$, and $\\Phi_1^{5}$ obtained by replacing $\\chi_1\\to\\chi_5$.\n\nIntroduce the standard one- and two-electron spin-orbital integrals,\n$$\nh_{pq}=\\int \\chi_p^{*}(x)\\,\\hat{h}(1)\\,\\chi_q(x)\\,dx,\n$$\n$$\n(pq|rs)=\\iint \\chi_p^{*}(x_1)\\chi_q^{*}(x_2)\\,\\frac{1}{r_{12}}\\,\\chi_r(x_1)\\chi_s(x_2)\\,dx_1\\,dx_2,\n$$\nwhere $dx\\equiv d\\mathbf{r}\\,d\\omega$ and $dx_1\\,dx_2\\equiv d\\mathbf{r}_1\\,d\\omega_1\\,d\\mathbf{r}_2\\,d\\omega_2$.\n\nStarting from these definitions and the Hamiltonian, and using only orthonormality and antisymmetry of Slater determinants, compute the following Hamiltonian matrix elements in fully reduced analytic form in terms of $h_{pq}$ and $(pq|rs)$:\n- The diagonal energy $E_0=\\langle \\Phi_0|\\hat{H}|\\Phi_0\\rangle$.\n- The single-excitation couplings $V_{1\\to 4}=\\langle \\Phi_0|\\hat{H}|\\Phi_1^{4}\\rangle$, $V_{3\\to 5}=\\langle \\Phi_0|\\hat{H}|\\Phi_3^{5}\\rangle$, and $V_{1\\to 5}=\\langle \\Phi_0|\\hat{H}|\\Phi_1^{5}\\rangle$.\n\nConfirm by explicit evaluation of spin integrals which terms vanish and why, thereby establishing the selection rule for spin-conserving versus spin-flipping single excitations.\n\nExpress your final answer as a single row matrix $\\big(E_0,\\;V_{1\\to 4},\\;V_{3\\to 5},\\;V_{1\\to 5}\\big)$ using only $h_{pq}$ and $(pq|rs)$. There is no numerical evaluation and no rounding requirement. Do not include units in the final answer.", "solution": "The problem requires the evaluation of Hamiltonian matrix elements between Slater determinants. The procedure begins with the validation of the problem statement. The problem is found to be scientifically grounded, well-posed, objective, and self-contained. It is a standard exercise in quantum chemistry and is thus deemed valid. We may proceed to the solution.\n\nThe Hamiltonian is given as a sum of one-electron operators, $\\hat{F} = \\sum_{k=1}^{N} \\hat{h}(k)$, and two-electron operators, $\\hat{G} = \\sum_{1 \\le k < \\ell \\le N} \\hat{g}(k,\\ell)$, where $N=3$ for this problem. The matrix elements of this Hamiltonian between Slater determinants, constructed from an orthonormal set of spin-orbitals $\\{\\chi_p\\}$, are determined by the Slater-Condon rules. These rules are a direct consequence of the antisymmetry of the wavefunctions and the orthonormality of the spin-orbitals.\n\nLet $\\Psi_A$ and $\\Psi_B$ be two $N$-electron Slater determinants.\n$1.$ If $\\Psi_A$ and $\\Psi_B$ are identical, $\\Psi_A = |\\chi_{a_1} \\chi_{a_2} \\dots \\chi_{a_N}\\rangle$, the diagonal matrix element is:\n$$\n\\langle \\Psi_A | \\hat{H} | \\Psi_A \\rangle = \\sum_{i=1}^{N} h_{a_i a_i} + \\sum_{1 \\le i < j \\le N} \\left[ (a_i a_j | a_i a_j) - (a_i a_j | a_j a_i) \\right]\n$$\n$2.$ If $\\Psi_B$ differs from $\\Psi_A$ by a single spin-orbital, where $\\chi_{a_p}$ in $\\Psi_A$ is replaced by $\\chi_{b_q}$ in $\\Psi_B$, the off-diagonal matrix element is:\n$$\n\\langle \\Psi_A | \\hat{H} | \\Psi_B \\rangle = h_{a_p b_q} + \\sum_{j=1, j \\ne p}^{N} \\left[ (a_p a_j | b_q a_j) - (a_p a_j | a_j b_q) \\right]\n$$\n$3.$ If $\\Psi_A$ and $\\Psi_B$ differ by more than two spin-orbitals, the matrix element of $\\hat{H}$ is zero.\n\nThe one- and two-electron integrals are defined over spin-orbitals. As the operators $\\hat{h}$ and $\\hat{g}$ are spin-independent, these integrals can be separated into spatial and spin components.\nLet a spin-orbital be $\\chi_p(x) = \\phi_p(\\mathbf{r})\\sigma_p(\\omega)$, where $\\sigma_p$ is either $\\alpha$ or $\\beta$.\nThe one-electron integral is:\n$$\nh_{pq} = \\int \\chi_p^{*}(x)\\hat{h}(1)\\chi_q(x)dx = \\left( \\int \\phi_p^{*}(\\mathbf{r})\\hat{h}(1)\\phi_q(\\mathbf{r})d\\mathbf{r} \\right) \\left( \\int \\sigma_p^{*}(\\omega)\\sigma_q(\\omega)d\\omega \\right) = h_{pq}^{\\text{space}} \\delta_{\\sigma_p, \\sigma_q}\n$$\nThe two-electron integral is:\n$$\n(pq|rs) = \\iint \\chi_p^{*}(x_1)\\chi_q^{*}(x_2)\\frac{1}{r_{12}}\\chi_r(x_1)\\chi_s(x_2)dx_1 dx_2 = [\\phi_p\\phi_r|\\phi_q\\phi_s] \\delta_{\\sigma_p, \\sigma_r} \\delta_{\\sigma_q, \\sigma_s}\n$$\nwhere $[\\phi_p\\phi_r|\\phi_q\\phi_s]$ denotes the spatial part of the integral. The Kronecker deltas $\\delta_{\\sigma_i,\\sigma_j}$ enforce spin conservation.\n\nThe reference determinant is $\\Phi_0 = |\\chi_1 \\chi_2 \\chi_3\\rangle$. The spin assignments are $\\chi_1=\\phi_1\\alpha$, $\\chi_2=\\phi_2\\alpha$, $\\chi_3=\\phi_3\\beta$.\n\n**1. Diagonal Energy $E_0 = \\langle \\Phi_0|\\hat{H}|\\Phi_0\\rangle$**\nThe set of occupied spin-orbitals is $\\{\\chi_1, \\chi_2, \\chi_3\\}$. Applying the diagonal Slater-Condon rule:\n$$\nE_0 = h_{11} + h_{22} + h_{33} + [(12|12) - (12|21)] + [(13|13) - (13|31)] + [(23|23) - (23|32)]\n$$\nWe examine the spin part of each term.\n- $h_{11}, h_{22}, h_{33}$: The spin functions are identical, e.g., $\\delta_{\\sigma_1, \\sigma_1}=1$. These terms are non-zero.\n- $(12|12)$: A Coulomb integral. Spin factors are $\\delta_{\\sigma_1, \\sigma_1}\\delta_{\\sigma_2, \\sigma_2} = \\delta_{\\alpha, \\alpha}\\delta_{\\alpha, \\alpha} = 1$. Non-zero.\n- $(12|21)$: An exchange integral. Spin factors are $\\delta_{\\sigma_1, \\sigma_2}\\delta_{\\sigma_2, \\sigma_1} = \\delta_{\\alpha, \\alpha}\\delta_{\\alpha, \\alpha} = 1$. Non-zero.\n- $(13|13)$: A Coulomb integral. Spin factors are $\\delta_{\\sigma_1, \\sigma_1}\\delta_{\\sigma_3, \\sigma_3} = \\delta_{\\alpha, \\alpha}\\delta_{\\beta, \\beta} = 1$. Non-zero.\n- $(13|31)$: An exchange integral. Spin factors are $\\delta_{\\sigma_1, \\sigma_3}\\delta_{\\sigma_3, \\sigma_1} = \\delta_{\\alpha, \\beta}\\delta_{\\beta, \\alpha} = 0$. This term vanishes.\n- $(23|23)$: A Coulomb integral. Spin factors are $\\delta_{\\sigma_2, \\sigma_2}\\delta_{\\sigma_3, \\sigma_3} = \\delta_{\\alpha, \\alpha}\\delta_{\\beta, \\beta} = 1$. Non-zero.\n- $(23|32)$: An exchange integral. Spin factors are $\\delta_{\\sigma_2, \\sigma_3}\\delta_{\\sigma_3, \\sigma_2} = \\delta_{\\alpha, \\beta}\\delta_{\\beta, \\alpha} = 0$. This term vanishes.\n\nExchange integrals between spin-orbitals of different spin are zero. Thus, the energy is:\n$$\nE_0 = h_{11} + h_{22} + h_{33} + (12|12) - (12|21) + (13|13) + (23|23)\n$$\n\n**2. Single Excitation $V_{1\\to 4}=\\langle \\Phi_0|\\hat{H}|\\Phi_1^{4}\\rangle$**\n$\\Phi_1^{4} = |\\chi_4 \\chi_2 \\chi_3\\rangle$. This is a single excitation $\\chi_1 \\to \\chi_4$. The spectator spin-orbitals are $\\chi_2$ and $\\chi_3$. The spin assignments are $\\sigma_1=\\alpha, \\sigma_2=\\alpha, \\sigma_3=\\beta, \\sigma_4=\\alpha$. This is a spin-conserving excitation.\nApplying the single-excitation rule:\n$$\nV_{1\\to 4} = h_{14} + [(12|42) - (12|24)] + [(13|43) - (13|34)]\n$$\n- $h_{14}$: Spin factor is $\\delta_{\\sigma_1, \\sigma_4} = \\delta_{\\alpha, \\alpha} = 1$. Non-zero.\n- $(12|42)$: Coulomb-type. Spin factors $\\delta_{\\sigma_1, \\sigma_4}\\delta_{\\sigma_2, \\sigma_2} = \\delta_{\\alpha, \\alpha}\\delta_{\\alpha, \\alpha} = 1$. Non-zero.\n- $(12|24)$: Exchange-type. Spin factors $\\delta_{\\sigma_1, \\sigma_2}\\delta_{\\sigma_2, \\sigma_4} = \\delta_{\\alpha, \\alpha}\\delta_{\\alpha, \\alpha} = 1$. Non-zero.\n- $(13|43)$: Coulomb-type. Spin factors $\\delta_{\\sigma_1, \\sigma_4}\\delta_{\\sigma_3, \\sigma_3} = \\delta_{\\alpha, \\alpha}\\delta_{\\beta, \\beta} = 1$. Non-zero.\n- $(13|34)$: Exchange-type. Spin factors $\\delta_{\\sigma_1, \\sigma_3}\\delta_{\\sigma_3, \\sigma_4} = \\delta_{\\alpha, \\beta}\\delta_{\\beta, \\alpha} = 0$. This term vanishes.\nThe matrix element is:\n$$\nV_{1\\to 4} = h_{14} + (12|42) - (12|24) + (13|43)\n$$\n\n**3. Single Excitation $V_{3\\to 5}=\\langle \\Phi_0|\\hat{H}|\\Phi_3^{5}\\rangle$**\n$\\Phi_3^{5} = |\\chi_1 \\chi_2 \\chi_5\\rangle$. This is a single excitation $\\chi_3 \\to \\chi_5$. The spectator spin-orbitals are $\\chi_1$ and $\\chi_2$. The spin assignments are $\\sigma_1=\\alpha, \\sigma_2=\\alpha, \\sigma_3=\\beta, \\sigma_5=\\beta$. This is also a spin-conserving excitation.\nApplying the single-excitation rule:\n$$\nV_{3\\to 5} = h_{35} + [(31|51) - (31|15)] + [(32|52) - (32|25)]\n$$\n- $h_{35}$: Spin factor is $\\delta_{\\sigma_3, \\sigma_5} = \\delta_{\\beta, \\beta} = 1$. Non-zero.\n- $(31|51)$: Coulomb-type. Spin factors $\\delta_{\\sigma_3, \\sigma_5}\\delta_{\\sigma_1, \\sigma_1} = \\delta_{\\beta, \\beta}\\delta_{\\alpha, \\alpha} = 1$. Non-zero.\n- $(31|15)$: Exchange-type. Spin factors $\\delta_{\\sigma_3, \\sigma_1}\\delta_{\\sigma_1, \\sigma_5} = \\delta_{\\beta, \\alpha}\\delta_{\\alpha, \\beta} = 0$. This term vanishes.\n- $(32|52)$: Coulomb-type. Spin factors $\\delta_{\\sigma_3, \\sigma_5}\\delta_{\\sigma_2, \\sigma_2} = \\delta_{\\beta, \\beta}\\delta_{\\alpha, \\alpha} = 1$. Non-zero.\n- $(32|25)$: Exchange-type. Spin factors $\\delta_{\\sigma_3, \\sigma_2}\\delta_{\\sigma_2, \\sigma_5} = \\delta_{\\beta, \\alpha}\\delta_{\\alpha, \\beta} = 0$. This term vanishes.\nThe matrix element is:\n$$\nV_{3\\to 5} = h_{35} + (31|51) + (32|52)\n$$\n\n**4. Single Excitation $V_{1\\to 5}=\\langle \\Phi_0|\\hat{H}|\\Phi_1^{5}\\rangle$**\n$\\Phi_1^{5} = |\\chi_5 \\chi_2 \\chi_3\\rangle$. This is a single excitation $\\chi_1 \\to \\chi_5$. The spectator spin-orbitals are $\\chi_2$ and $\\chi_3$. The spin assignments are $\\sigma_1=\\alpha, \\sigma_2=\\alpha, \\sigma_3=\\beta, \\sigma_5=\\beta$. This is a spin-flipping excitation ($\\alpha \\to \\beta$). The total spin projection changes from $M_S=1/2$ for $\\Phi_0$ to $M_S=-1/2$ for $\\Phi_1^5$. Since the Hamiltonian $\\hat{H}$ is spin-free, it commutes with the total spin projection operator $\\hat{S}_z$, and thus its matrix element between states with different $M_S$ eigenvalues must be zero. We confirm this by explicit evaluation of integrals.\nApplying the single-excitation rule:\n$$\nV_{1\\to 5} = h_{15} + [(12|52) - (12|25)] + [(13|53) - (13|35)]\n$$\n- $h_{15}$: Spin factor is $\\delta_{\\sigma_1, \\sigma_5} = \\delta_{\\alpha, \\beta} = 0$. Vanishes.\n- $(12|52)$: Spin factors $\\delta_{\\sigma_1, \\sigma_5}\\delta_{\\sigma_2, \\sigma_2} = \\delta_{\\alpha, \\beta}\\delta_{\\alpha, \\alpha} = 0 \\cdot 1 = 0$. Vanishes.\n- $(12|25)$: Spin factors $\\delta_{\\sigma_1, \\sigma_2}\\delta_{\\sigma_2, \\sigma_5} = \\delta_{\\alpha, \\alpha}\\delta_{\\alpha, \\beta} = 1 \\cdot 0 = 0$. Vanishes.\n- $(13|53)$: Spin factors $\\delta_{\\sigma_1, \\sigma_5}\\delta_{\\sigma_3, \\sigma_3} = \\delta_{\\alpha, \\beta}\\delta_{\\beta, \\beta} = 0 \\cdot 1 = 0$. Vanishes.\n- $(13|35)$: Spin factors $\\delta_{\\sigma_1, \\sigma_3}\\delta_{\\sigma_3, \\sigma_5} = \\delta_{\\alpha, \\beta}\\delta_{\\beta, \\beta} = 0 \\cdot 1 = 0$. Vanishes.\nEvery term in the expression is zero due to spin-orthogonality.\n$$\nV_{1\\to 5} = 0\n$$\nThis result explicitly demonstrates the selection rule for this spin-free Hamiltonian: it cannot induce transitions that change the net spin of the system.\n\nCombining the results, we have the final expressions for the four requested quantities. These are presented in the required matrix format.", "answer": "$$\n\\boxed{\\begin{pmatrix} h_{11} + h_{22} + h_{33} + (12|12) - (12|21) + (13|13) + (23|23) & h_{14} + (12|42) - (12|24) + (13|43) & h_{35} + (31|51) + (32|52) & 0 \\end{pmatrix}}\n$$", "id": "2924391"}, {"introduction": "While computing individual matrix elements is a core skill, the ultimate goal is often to solve the Schrödinger equation by diagonalizing the full Hamiltonian matrix. This practice moves from calculating isolated components to assembling the complete Full Configuration Interaction (FCI) matrix for a small but illustrative system. By constructing this matrix, you will see how the Slater-Condon rules populate its structure and how fundamental symmetries, like the conservation of spin projection $M_s$, lead to a block-diagonal form that simplifies the problem. [@problem_id:2797542]", "problem": "Consider a nonrelativistic, clamped-nuclei two-electron problem in second quantization with four orthonormal spin-orbitals labeled by indices $p \\in \\{1,2,3,4\\}$ corresponding to $\\{1\\alpha, 1\\beta, 2\\alpha, 2\\beta\\}$, respectively. The electronic Hamiltonian is\n$$\n\\hat{H} \\;=\\; \\sum_{p,q} h_{pq}\\, \\hat{a}_{p}^{\\dagger}\\hat{a}_{q} \\;+\\; \\frac{1}{2}\\sum_{p,q,r,s} (pq|rs)\\, \\hat{a}_{p}^{\\dagger}\\hat{a}_{q}^{\\dagger}\\hat{a}_{s}\\hat{a}_{r},\n$$\nwhere $\\hat{a}_{p}^{\\dagger}$ and $\\hat{a}_{p}$ are fermionic creation and annihilation operators obeying canonical anticommutation relations, $h_{pq}$ are one-electron integrals, and $(pq|rs)$ are two-electron Coulomb integrals in chemists’ notation. All quantities are in Hartree atomic units.\n\nYou are given the following nonzero one-electron integrals $h_{pq}$ (Hermitian, so $h_{pq}=h_{qp}$):\n- $h_{11} = h_{22} = -1.000$, $h_{33} = h_{44} = -0.500$,\n- $h_{13} = h_{31} = -0.100$, $h_{24} = h_{42} = -0.100$,\n- all other $h_{pq} = 0$.\n\nThe two-electron spin-orbital integrals $(pq|rs)$ are constructed from the following nonzero spatial-orbital Coulomb-exchange data, with all permutational symmetries respected and all other spatial integrals zero:\n- $(11|11) = 0.700$, $(22|22) = 0.600$,\n- $(11|22) = (22|11) = 0.500$,\n- $(12|21) = (21|12) = 0.200$,\n- all other spatial $(\\mu\\nu|\\lambda\\kappa) = 0$.\nMap to spin-orbital integrals via spin selection rules: $(p q|r s)$ is nonzero only if the spin of $p$ equals the spin of $r$ and the spin of $q$ equals the spin of $s$, in which case $(p q|r s)$ equals the corresponding spatial $(\\mu\\nu|\\lambda\\kappa)$ where $p\\to\\mu$, $q\\to\\nu$, $r\\to\\lambda$, $s\\to\\kappa$ denote the associated spatial labels.\n\nWork in the Slater determinant basis of all two-electron determinants built from the four spin-orbitals, ordered by increasing spin-orbital indices to fix phases:\n- $| D_{1} \\rangle = | 1,2 \\rangle$, $| D_{2} \\rangle = | 1,3 \\rangle$, $| D_{3} \\rangle = | 1,4 \\rangle$,\n- $| D_{4} \\rangle = | 2,3 \\rangle$, $| D_{5} \\rangle = | 2,4 \\rangle$, $| D_{6} \\rangle = | 3,4 \\rangle$.\n\nTasks:\n1. Starting from the second-quantized Hamiltonian and fermionic anticommutation relations, construct the full $6\\times 6$ full configuration interaction (FCI) Hamiltonian matrix in the above determinant basis by evaluating all matrix elements $\\langle D_{I} | \\hat{H} | D_{J} \\rangle$ directly from the given $h_{pq}$ and $(pq|rs)$.\n2. Using your constructed matrix, explicitly confirm Hermiticity and consistency with antisymmetry (i.e., the structure implied by Slater-Condon rules derived from anticommutation and the symmetry properties of $(pq|rs)$).\n3. What is the trace of the FCI Hamiltonian matrix? Express the final answer in Hartree. No rounding is required; report the exact value.", "solution": "The problem statement is a standard, well-posed problem in quantum chemistry, specifically a Full Configuration Interaction (FCI) calculation for a two-electron system within a four-spin-orbital basis. It is scientifically grounded, complete, and objective. There are no flaws. We proceed to the solution.\n\nThe solution requires constructing the $6 \\times 6$ Hamiltonian matrix $\\mathbf{H}$ in the given Slater determinant basis. The matrix elements $H_{IJ} = \\langle D_{I} | \\hat{H} | D_{J} \\rangle$ are evaluated using the Slater-Condon rules, which are a direct consequence of applying the second-quantized Hamiltonian to Slater determinants and using the fermionic anticommutation relations $\\{\\hat{a}_p, \\hat{a}_q\\} = 0$, $\\{\\hat{a}_p^\\dagger, \\hat{a}_q^\\dagger\\} = 0$, and $\\{\\hat{a}_p, \\hat{a}_q^\\dagger\\} = \\delta_{pq}$.\n\nThe basis determinants are:\n$| D_{1} \\rangle = | 1,2 \\rangle$ ($M_S=0$), $| D_{2} \\rangle = | 1,3 \\rangle$ ($M_S=1$), $| D_{3} \\rangle = | 1,4 \\rangle$ ($M_S=0$),\n$| D_{4} \\rangle = | 2,3 \\rangle$ ($M_S=0$), $| D_{5} \\rangle = | 2,4 \\rangle$ ($M_S=-1$), $| D_{6} \\rangle = | 3,4 \\rangle$ ($M_S=0$).\n\nThe Hamiltonian is non-relativistic and spin-independent, so it commutes with the total spin-projection operator $\\hat{S}_z$. This implies the Hamiltonian matrix is block-diagonal in the basis of determinants, with non-zero elements only between determinants having the same $M_S$ value. The basis separates into three blocks: $M_S=1$ ($\\{D_2\\}$), $M_S=-1$ ($\\{D_5\\}$), and $M_S=0$ ($\\{D_1, D_3, D_4, D_6\\}$).\n\nFirst, we must derive the necessary non-zero spin-orbital integrals $(pq|rs)$ from the given spatial integrals $(\\mu\\nu|\\lambda\\kappa)$ and selection rules. The spin-orbital mapping is $1 \\to (1, \\alpha)$, $2 \\to (1, \\beta)$, $3 \\to (2, \\alpha)$, $4 \\to (2, \\beta)$.\nAn integral $(pq|rs)$ is non-zero only if $\\sigma(p)=\\sigma(r)$ and $\\sigma(q)=\\sigma(s)$, and its value is given by the spatial integral $(\\mu(p)\\mu(q)|\\mu(r)\\mu(s))$.\n\nFrom $(11|11) = 0.700$: $(12|12)=0.700$. Other integrals like $(11|11)$ are not used as they involve identical spin-orbitals in a pair.\nFrom $(22|22) = 0.600$: $(34|34)=0.600$.\nFrom $(11|22) = 0.500$: this corresponds to $\\mu(p)=1, \\mu(q)=1, \\mu(r)=2, \\mu(s)=2$. With spin rules, this generates $(12|34)=0.500$ (spins $(\\alpha,\\beta) \\to (\\alpha,\\beta)$) and $(21|43)=0.500$ (spins $(\\beta,\\alpha) \\to (\\beta,\\alpha)$).\nFrom $(12|21) = 0.200$: this corresponds to $\\mu(p)=1, \\mu(q)=2, \\mu(r)=2, \\mu(s)=1$. This generates $(13|31)=0.200$ (spins $(\\alpha,\\alpha) \\to (\\alpha,\\alpha)$), $(24|42)=0.200$ (spins $(\\beta,\\beta) \\to (\\beta,\\beta)$), and $(14|32)=0.200$ (spins $(\\alpha,\\beta) \\to (\\alpha,\\beta)$), and $(23|41)=0.200$ (spins $(\\beta,\\alpha) \\to (\\beta,\\alpha)$).\n\nNow we apply the Slater-Condon rules.\nFor diagonal elements $\\langle D | \\hat{H} | D \\rangle$ where $|D\\rangle = |i,j\\rangle$:\n$\\langle i,j | \\hat{H} | i,j \\rangle = h_{ii} + h_{jj} + (ij|ij) - (ij|ji)$.\n$H_{11} = \\langle 1,2|\\hat{H}|1,2\\rangle = h_{11}+h_{22}+(12|12)-(12|21) = -1.000-1.000+0.700-0 = -1.300$.\n$H_{22} = \\langle 1,3|\\hat{H}|1,3\\rangle = h_{11}+h_{33}+(13|13)-(13|31) = -1.000-0.500+0-0.200 = -1.700$.\n$H_{33} = \\langle 1,4|\\hat{H}|1,4\\rangle = h_{11}+h_{44}+(14|14)-(14|41) = -1.000-0.500+0-0 = -1.500$.\n$H_{44} = \\langle 2,3|\\hat{H}|2,3\\rangle = h_{22}+h_{33}+(23|23)-(23|32) = -1.000-0.500+0-0 = -1.500$.\n$H_{55} = \\langle 2,4|\\hat{H}|2,4\\rangle = h_{22}+h_{44}+(24|24)-(24|42) = -1.000-0.500+0-0.200 = -1.700$.\n$H_{66} = \\langle 3,4|\\hat{H}|3,4\\rangle = h_{33}+h_{44}+(34|34)-(34|43) = -0.500-0.500+0.600-0 = -0.400$.\n\nFor off-diagonal elements between determinants differing by one spin-orbital, e.g. $\\langle i,j|\\hat{H}|k,j\\rangle$ (excitation $i \\to k$):\n$H_I \\neq H_J$: $\\langle i,j|\\hat{H}|k,j\\rangle = \\pm (h_{ik} + (ij|kj)-(ij|jk))$. The sign depends on the ordering of operators.\n$H_{13}=\\langle 1,2|\\hat{H}|1,4\\rangle$: excitation $2 \\to 4$, common orbital $1$. Element is $h_{24} + (21|41) - (21|14) = -0.100+0-0 = -0.100$.\n$H_{14}=\\langle 1,2|\\hat{H}|2,3\\rangle$: excitation $1 \\to 3$, common orbital $2$. With sign correction for orbital order, element is $-h_{13} - ((12|32)-(12|23)) = -(-0.100) - (0-0) = 0.100$.\n$H_{36}=\\langle 1,4|\\hat{H}|3,4\\rangle$: excitation $1 \\to 3$, common orbital $4$. Element is $h_{13} + (14|34) - (14|43) = -0.100+0-0 = -0.100$.\n$H_{46}=\\langle 2,3|\\hat{H}|3,4\\rangle$: excitation $2 \\to 4$, common orbital $3$. With sign correction, element is $-h_{24} - ((23|43)-(23|34)) = -(-0.100) - (0-0) = 0.100$.\n\nFor off-diagonal elements between determinants differing by two spin-orbitals, e.g. $\\langle i,j|\\hat{H}|k,l\\rangle$:\n$H_I \\neq H_J$: $\\langle i,j|\\hat{H}|k,l\\rangle = \\pm ((ij|kl)-(ij|lk))$.\n$H_{16}=\\langle 1,2|\\hat{H}|3,4\\rangle$: excitation $(1,2) \\to (3,4)$. Element is $(12|34) - (12|43) = 0.500-0 = 0.500$.\n$H_{34}=\\langle 1,4|\\hat{H}|2,3\\rangle$: excitation $(1,4) \\to (2,3)$. Element is $(14|23)-(14|32) = 0-0.200 = -0.200$.\n\nAll other off-diagonal matrix elements are zero, due to $M_S$ conservation or because the relevant integrals are zero.\n\n**1. The Full CI Hamiltonian Matrix**\nAssembling these elements gives the $6 \\times 6$ FCI matrix $\\mathbf{H}$:\n$$\n\\mathbf{H} =\n\\begin{pmatrix}\n-1.300 & 0 & -0.100 & 0.100 & 0 & 0.500 \\\\\n0 & -1.700 & 0 & 0 & 0 & 0 \\\\\n-0.100 & 0 & -1.500 & -0.200 & 0 & -0.100 \\\\\n0.100 & 0 & -0.200 & -1.500 & 0 & 0.100 \\\\\n0 & 0 & 0 & 0 & -1.700 & 0 \\\\\n0.500 & 0 & -0.100 & 0.100 & 0 & -0.400\n\\end{pmatrix}\n$$\n\n**2. Hermiticity and Consistency**\nThe constructed matrix is explicitly Hermitian, as $H_{IJ} = H_{JI}$ for all $I,J$ (since all elements are real). The structure is fully consistent with the consequences of the Slater-Condon rules and fundamental symmetries. The block-diagonal nature with respect to $M_S$ is evident: the matrix elements $H_{IJ}$ are zero if $D_I$ and $D_J$ have different $M_S$ values. Specifically, the basis states $D_2$ ($M_S=1$) and $D_5$ ($M_S=-1$) are decoupled from all other states and each other. The remaining states $D_1, D_3, D_4, D_6$ form the $M_S=0$ block. This confirms the physical consistency of the calculation.\n\n**3. Trace of the FCI Hamiltonian Matrix**\nThe trace of a matrix is the sum of its diagonal elements.\n$$ \\text{Tr}(\\mathbf{H}) = \\sum_{I=1}^{6} H_{II} $$\n$$ \\text{Tr}(\\mathbf{H}) = (-1.300) + (-1.700) + (-1.500) + (-1.500) + (-1.700) + (-0.400) $$\n$$ \\text{Tr}(\\mathbf{H}) = -8.100 $$\nThe trace is $-8.100$ Hartree.\n\nAs a verification, the trace can also be computed from the sum of Hamiltonian expectation values over the entire basis. The sum of all diagonal energies is given by the general formula:\n$$ \\text{Tr}(\\mathbf{H}) = \\binom{M-1}{n-1}\\sum_{p=1}^M h_{pp} + \\binom{M-2}{n-2}\\sum_{1 \\le p < q \\le M} \\left((pq|pq) - (pq|qp)\\right) $$\nwhere $M$ is the number of spin-orbitals and $n$ is the number of electrons. For this problem, $M=4$ and $n=2$:\n$$ \\text{Tr}(\\mathbf{H}) = \\binom{4-1}{2-1}\\sum_{p=1}^4 h_{pp} + \\binom{4-2}{2-2}\\sum_{1 \\le p < q \\le 4} \\left((pq|pq) - (pq|qp)\\right) $$\n$$ \\text{Tr}(\\mathbf{H}) = 3\\sum_{p=1}^4 h_{pp} + \\sum_{p<q} \\left((pq|pq) - (pq|qp)\\right) $$\nThe one-electron contribution is $3 \\times (h_{11}+h_{22}+h_{33}+h_{44}) = 3 \\times (-1.0 - 1.0 - 0.5 - 0.5) = 3 \\times (-3.000) = -9.000$.\nThe two-electron contribution is the sum over all unique pairs of spin-orbitals $(p,q)$: $((12|12)-(12|21)) + ((13|13)-(13|31)) + ((14|14)-(14|41)) + ((23|23)-(23|32)) + ((24|24)-(24|42)) + ((34|34)-(34|43))$.\nUsing the integrals derived for the diagonal elements: $(0.700-0) + (0-0.200) + (0-0) + (0-0) + (0-0.200) + (0.600-0) = 0.700 - 0.200 - 0.200 + 0.600 = 0.900$.\nThe total trace is $-9.000 + 0.900 = -8.100$. This confirms the result from summing the diagonal elements of the constructed matrix.", "answer": "$$\\boxed{-8.100}$$", "id": "2797542"}, {"introduction": "Modern quantum chemistry relies on computers to handle the immense complexity of many-electron systems, and a crucial step in this process is automating the rules we've practiced. This exercise challenges you to think algorithmically about a ubiquitous and subtle aspect of many-fermion wavefunctions: the phase factor, or \"sign,\" that arises from their antisymmetric nature. By designing an algorithm to determine the relative sign between any two Slater determinants, you will be taking a significant step from theoretical understanding towards practical computational implementation. [@problem_id:2924367]", "problem": "Consider a fixed reference Slater determinant specified by a bitstring over $M$ spin-orbitals, where the least significant bit corresponds to spin-orbital index $0$, the next bit to index $1$, and so on up to index $M-1$. A bit value of $1$ at position $i$ indicates that spin-orbital $i$ is occupied, and $0$ indicates that it is unoccupied. For any other Slater determinant with the same number of electrons (same number of $1$ bits) represented by a second bitstring over the same $M$ spin-orbitals, define the relative sign to the reference as the fermionic phase factor obtained by transforming the reference determinant into the target determinant using a well-defined sequence of annihilation and creation operations, consistent with the antisymmetry of fermionic wavefunctions. The task is to devise an algorithm that, given $M$, the reference bitstring, and a target determinant bitstring, computes this sign as $+1$ or $-1$.\n\nYou must design your algorithm starting from the following foundational principles:\n- The Slater determinant $|\\Phi\\rangle$ corresponding to occupied spin-orbitals $i_1<i_2<\\cdots<i_N$ is represented by the ordered product of fermionic creation operators $a^\\dagger_{i_1} a^\\dagger_{i_2} \\cdots a^\\dagger_{i_N} |0\\rangle$.\n- The canonical anticommutation relations for fermionic operators hold: $\\{a_p, a_q^\\dagger\\} = a_p a_q^\\dagger + a_q^\\dagger a_p = \\delta_{pq}$ and $\\{a_p, a_q\\} = \\{a_p^\\dagger, a_q^\\dagger\\} = 0$.\n- In second quantization, applying $a_i$ (annihilation) or $a_i^\\dagger$ (creation) to a Slater determinant produces a phase factor $(-1)^{n_{<i}}$, where $n_{<i}$ is the number of occupied spin-orbitals with indices strictly less than $i$ in the current determinant.\n\nYour program must:\n- Implement an algorithm that computes the sign factor $s \\in \\{+1,-1\\}$ for any given pair of bitstrings with equal Hamming weight (same number of electrons), using only the above principles. You must not assume or use any shortcut formulas beyond what follows directly from these principles.\n- Treat the bitstrings as nonnegative integers encoding occupancy in the least significant $M$ bits. You should mask higher bits, if any, using $2^M-1$ to ensure only the first $M$ spin-orbitals are considered.\n\nDefine the following test suite of parameter triples $(M,\\ \\text{ref},\\ \\text{det})$, where all integers are given in base-$10$:\n- Case A (identity, baseline): $(8,\\ 45,\\ 45)$, i.e., reference and target both occupy $\\{0,2,3,5\\}$.\n- Case B (single excitation with odd parity): $(8,\\ 45,\\ 101)$, i.e., reference $\\{0,2,3,5\\}$ to target $\\{0,2,5,6\\}$.\n- Case C (single excitation with even parity): $(8,\\ 45,\\ 46)$, i.e., reference $\\{0,2,3,5\\}$ to target $\\{1,2,3,5\\}$.\n- Case D (double excitation, even parity): $(8,\\ 45,\\ 75)$, i.e., reference $\\{0,2,3,5\\}$ to target $\\{0,1,3,6\\}$.\n- Case E (double excitation, even parity): $(8,\\ 45,\\ 116)$, i.e., reference $\\{0,2,3,5\\}$ to target $\\{2,4,5,6\\}$.\n- Case F (triple excitation, odd parity): $(8,\\ 45,\\ 90)$, i.e., reference $\\{0,2,3,5\\}$ to target $\\{1,3,4,6\\}$.\n- Case G (single excitation downward, even parity): $(8,\\ 45,\\ 29)$, i.e., reference $\\{0,2,3,5\\}$ to target $\\{0,2,3,4\\}$.\n- Case H (different $M$, even parity): $(6,\\ 19,\\ 41)$, i.e., reference $\\{0,1,4\\}$ to target $\\{0,3,5\\}$.\n- Case I (different $M$, odd parity): $(6,\\ 19,\\ 14)$, i.e., reference $\\{0,1,4\\}$ to target $\\{1,2,3\\}$.\n\nYour program should:\n- For each case, compute and return the sign $+1$ or $-1$.\n- Aggregate results for all cases into a single line of output containing the results as a comma-separated list enclosed in square brackets, e.g., $[1,-1,1]$.\n\nAssumptions and constraints:\n- You must only consider the least significant $M$ bits of each bitstring (mask with $2^M-1$).\n- If the Hamming weights (number of electrons) of the reference and target differ, the sign is undefined for the present task; however, all provided test cases satisfy equal Hamming weight.\n- No physical units are involved in this problem; all quantities are dimensionless integers.", "solution": "The problem as stated is valid. It is a well-posed, scientifically grounded exercise in applying the fundamental principles of second quantization for fermionic systems, a standard topic in quantum chemistry. We will proceed with a rigorous, step-by-step derivation of the solution.\n\nThe task is to compute the relative sign, $s \\in \\{+1, -1\\}$, between two Slater determinants, $|\\Phi_{ref}\\rangle$ and $|\\Phi_{det}\\rangle$, represented by integer bitstrings over $M$ spin-orbitals. This sign is a direct consequence of the antisymmetry of fermionic wavefunctions, formalized by the canonical anticommutation relations: $\\{a_p^\\dagger, a_q^\\dagger\\} = \\{a_p, a_q\\} = 0$ and $\\{a_p, a_q^\\dagger\\} = \\delta_{pq}$.\n\nA core principle provided is that applying a creation operator $a_i^\\dagger$ or an annihilation operator $a_i$ to a Slater determinant introduces a phase factor of $(-1)^{n_{<i}}$, where $n_{<i}$ is the number of occupied spin-orbitals with indices strictly less than $i$. This phase arises from permuting the operator to its canonical position in the ordered product of creation operators that defines the determinant, with each operator swap contributing a factor of $-1$.\n\nTo find the total sign for transforming $|\\Phi_{ref}\\rangle$ into $|\\Phi_{det}\\rangle$, we shall simulate a sequence of elementary operations that performs this transformation, accumulating the resulting phase factors. As both determinants have the same number of electrons (equal Hamming weight), the transformation can be expressed as a series of annihilations followed by creations.\n\nLet the integer representations of the reference and target determinants be $d_{ref}$ and $d_{tgt}$. The sets of occupied spin-orbital indices are implicitly defined by the positions of the set ($1$) bits. The transformation from $|\\Phi_{ref}\\rangle$ to $|\\Phi_{det}\\rangle$ requires:\n1. Annihilating electrons from spin-orbitals in the set $H$, which are occupied in $|\\Phi_{ref}\\rangle$ but not in $|\\Phi_{det}\\rangle$. These are the 'hole' states.\n2. Creating electrons in spin-orbitals in the set $P$, which are occupied in $|\\Phi_{det}\\rangle$ but not in $|\\Phi_{ref}\\rangle$. These are the 'particle' states.\n\nTo ensure a uniquely defined sign, we must adopt a canonical ordering for these operations. We will use the standard convention of performing all annihilations first, followed by all creations. Furthermore, annihilation operations are performed in descending order of spin-orbital index, and creation operations are performed in ascending order of index. This choice ensures that the application of an operator does not alter the occupancy count for any operators applied later in the same sequence (i.e., when annihilating $a_{h_i}$ then $a_{h_j}$ with $h_i > h_j$, the count $n_{<h_j}$ is unaffected by the prior removal of the electron at $h_i$).\n\nThe algorithm proceeds as follows:\n\n1.  **Initialization**:\n    - The input integers for the reference and target determinants are masked with $(2^M-1)$ to consider only the $M$ specified spin-orbitals. Let the masked determinants be $d_{ref}$ and $d_{tgt}$.\n    - Initialize the total sign factor $s = +1$.\n    - Initialize a working copy of the determinant, $d_{current} = d_{ref}$.\n\n2.  **Identify and Order Hole/Particle States**:\n    - The set of hole indices, $H$, is determined from the bit positions that are set to $1$ in $d_{ref}$ but $0$ in $d_{tgt}$. These indices are collected and sorted in descending order.\n    - The set of particle indices, $P$, is determined from the bit positions that are set to $1$ in $d_{tgt}$ but $0$ in $d_{ref}$. These indices are collected and sorted in ascending order.\n\n3.  **Annihilation Phase**:\n    - For each hole index $h \\in H$:\n        a. Calculate the number of occupied spin-orbitals in $d_{current}$ with an index less than $h$. This is the population count (popcount) of the lower bits: $n_{<h} = \\text{popcount}(d_{current} \\ \\& \\ ((1 \\ll h) - 1))$. The `popcount` function counts the number of set bits in an integer.\n        b. If $n_{<h}$ is odd, the sign is flipped: $s \\leftarrow s \\times (-1)$.\n        c. Update the working determinant by annihilating the electron at $h$: $d_{current} \\leftarrow d_{current} \\oplus (1 \\ll h)$, where $\\oplus$ is the bitwise XOR operation.\n\n4.  **Creation Phase**:\n    - After all annihilations, the working determinant $d_{current}$ represents the intermediate state corresponding to orbitals common to both determinants.\n    - For each particle index $p \\in P$:\n        a. Calculate the number of occupied spin-orbitals in $d_{current}$ with an index less than $p$: $n_{<p} = \\text{popcount}(d_{current} \\ \\& \\ ((1 \\ll p) - 1))$.\n        b. If $n_{<p}$ is odd, the sign is flipped: $s \\leftarrow s \\times (-1)$.\n        c. Update the working determinant by creating an electron at $p$: $d_{current} \\leftarrow d_{current} \\oplus (1 \\ll p)$.\n\n5.  **Final Result**:\n    - Upon completion, $d_{current}$ will be equal to $d_{tgt}$, and the accumulated variable $s$ will hold the final relative sign.\n\nThis procedural simulation directly implements the consequences of the fermionic commutation rules. It is constructed from first principles as required and does not rely on any unstated or underived shortcut formulas.", "answer": "```python\nimport numpy as np\n# from scipy import ...\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print results.\n    \"\"\"\n    test_cases = [\n        # (M, ref, det)\n        (8, 45, 45),    # Case A\n        (8, 45, 101),   # Case B\n        (8, 45, 46),    # Case C\n        (8, 45, 75),    # Case D\n        (8, 45, 116),   # Case E\n        (8, 45, 90),    # Case F\n        (8, 45, 29),    # Case G\n        (6, 19, 41),    # Case H\n        (6, 19, 14),    # Case I\n    ]\n\n    results = []\n    for M, ref, det in test_cases:\n        sign = calculate_fermionic_sign(M, ref, det)\n        results.append(sign)\n\n    print(f\"[{','.join(map(str, results))}]\")\n\ndef calculate_fermionic_sign(M, ref, det):\n    \"\"\"\n    Calculates the fermionic sign between two Slater determinants.\n\n    The sign is computed by simulating the transformation from the reference\n    to the target determinant via a canonical sequence of annihilation and\n    creation operations, accumulating the phase at each step.\n\n    Args:\n        M (int): The number of spin-orbitals in the basis.\n        ref (int): The reference determinant as a bitstring integer.\n        det (int): The target determinant as a bitstring integer.\n\n    Returns:\n        int: The sign factor (+1 or -1).\n    \"\"\"\n    # 1. Initialization and Masking\n    # Ensure only the least significant M bits are considered.\n    bitmask = (1 << M) - 1\n    ref &= bitmask\n    det &= bitmask\n\n    if ref == det:\n        return 1\n\n    # 2. Identify Hole and Particle States\n    holes_mask = ref & ~det\n    particles_mask = det & ~ref\n\n    h_indices = []\n    p_indices = []\n\n    for i in range(M):\n        if (holes_mask >> i) & 1:\n            h_indices.append(i)\n        if (particles_mask >> i) & 1:\n            p_indices.append(i)\n\n    # Sort according to the canonical prescription:\n    # Annihilate from high index to low.\n    h_indices.sort(reverse=True)\n    # Create from low index to high.\n    p_indices.sort()\n\n    total_sign = 1\n    current_det = ref\n\n    # 3. Annihilation Phase\n    for h in h_indices:\n        # Count occupied orbitals with index less than h.\n        less_than_mask = (1 << h) - 1\n        n_less_than = (current_det & less_than_mask).bit_count()\n        \n        # Accumulate phase factor (-1)^n_less_than.\n        if n_less_than % 2 != 0:\n            total_sign *= -1\n            \n        # Annihilate electron at orbital h.\n        current_det ^= (1 << h)\n\n    # 4. Creation Phase\n    for p in p_indices:\n        # Count occupied orbitals with index less than p.\n        less_than_mask = (1 << p) - 1\n        n_less_than = (current_det & less_than_mask).bit_count()\n\n        # Accumulate phase factor (-1)^n_less_than.\n        if n_less_than % 2 != 0:\n            total_sign *= -1\n            \n        # Create electron at orbital p.\n        current_det ^= (1 << p)\n\n    # 5. Final Result\n    # As a sanity check, the final determinant must match the target.\n    # assert current_det == det\n    return total_sign\n\nsolve()\n```", "id": "2924367"}]}