{"hands_on_practices": [{"introduction": "To truly master a concept, it is often instructive to rebuild it from first principles in a new context. This exercise challenges you to construct a system of atomic units for a hypothetical two-dimensional universe [@problem_id:2450254]. By non-dimensionalizing the Hamiltonian for this system and deriving its characteristic length scale, you will deepen your understanding of how such unit systems are fundamentally tools for revealing the natural scales of a physical problem.", "problem": "Consider a hypothetical two-dimensional ($2$D) universe in which electrons are strictly confined to a plane, while electromagnetism follows the usual three-dimensional Coulomb law restricted to the plane. A point nucleus of charge $+e$ located in the plane produces a potential $V(r)=-\\dfrac{e^{2}}{4\\pi \\varepsilon_{0}\\,r}$ for an electron at planar distance $r$. For a nonrelativistic one-electron, one-nucleus system with reduced mass $\\mu$, you wish to construct a system of $2$D atomic units such that the one-electron Hamiltonian contains no explicit dimensional constants.\n\nDefine this $2$D atomic unit system by specifying which fundamental constants are set equal to $1$ in this universe. Then, from first principles of nonrelativistic quantum mechanics for a particle in a central potential, determine the exact analytic expression for the $2$D Bohr radius $a_{\\mathrm{2D}}$, defined as the characteristic length scale that renders the Hamiltonian dimensionless under the corresponding coordinate scaling in these atomic units.\n\nProvide your final answer as a single closed-form expression for $a_{\\mathrm{2D}}$ in terms of $\\hbar$, $\\mu$, $e$, $\\varepsilon_{0}$, and $\\pi$. Do not substitute numerical values. Do not include any units in your final answer. If you choose to approximate at any step, your final answer must nevertheless remain an exact symbolic expression.", "solution": "The problem statement is first subjected to rigorous validation.\n\n**Step 1: Extract Givens**\n- The system exists in a two-dimensional ($2$D) universe.\n- An electron is confined to a plane.\n- Electromagnetism follows the three-dimensional Coulomb law, restricted to the plane.\n- The potential energy of an electron at a planar distance $r$ from a point nucleus of charge $+e$ is $V(r)=-\\dfrac{e^{2}}{4\\pi \\varepsilon_{0}\\,r}$.\n- The system is a nonrelativistic one-electron, one-nucleus system with reduced mass $\\mu$.\n- The task is to construct a system of $2$D atomic units where the Hamiltonian contains no explicit dimensional constants.\n- The definition of this system must be provided by specifying which fundamental constants are set to $1$.\n- The exact analytic expression for the $2$D Bohr radius, $a_{\\mathrm{2D}}$, must be determined. This is defined as the characteristic length scale that renders the Hamiltonian dimensionless.\n- The expression for $a_{\\mathrm{2D}}$ must be in terms of $\\hbar$, $\\mu$, $e$, $\\varepsilon_{0}$, and $\\pi$.\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientifically Grounded:** The problem describes a hypothetical physical system, but it is analyzed using the established principles of nonrelativistic quantum mechanics and a specified potential law. Such \"toy models\" are standard tools in theoretical physics for understanding fundamental concepts. The problem is free of pseudoscience or factual inaccuracies within its own defined context.\n- **Well-Posed:** The problem is clearly stated. It provides all necessary information (the form of the kinetic and potential energy) to construct the Hamiltonian. The task of non-dimensionalizing a physical equation to find characteristic scales is a standard and well-defined mathematical procedure that yields a unique solution.\n- **Objective:** The language is precise, quantitative, and free of any subjective or ambiguous terminology.\n\nThe problem is found to be valid. It is a self-contained, consistent, and well-posed problem in theoretical physics that can be solved through direct application of quantum mechanical principles and dimensional analysis.\n\n**Step 3: Verdict and Action**\nThe problem is valid. The solution proceeds.\n\nThe objective is to derive the characteristic length scale, the $2$D Bohr radius $a_{\\mathrm{2D}}$, by non-dimensionalizing the system's Hamiltonian. The time-independent Schrödinger equation for the system is $\\hat{H}\\psi = E\\psi$.\n\nThe Hamiltonian operator, $\\hat{H}$, is the sum of the kinetic energy operator, $\\hat{T}$, and the potential energy operator, $\\hat{V}$. In a two-dimensional plane, using Cartesian coordinates $(x, y)$, the kinetic energy operator for a particle of reduced mass $\\mu$ is:\n$$\n\\hat{T} = -\\frac{\\hbar^{2}}{2\\mu}\\nabla^{2}_{2D} = -\\frac{\\hbar^{2}}{2\\mu}\\left(\\frac{\\partial^{2}}{\\partial x^{2}} + \\frac{\\partial^{2}}{\\partial y^{2}}\\right)\n$$\nThe potential energy is given as:\n$$\n\\hat{V}(r) = -\\frac{e^{2}}{4\\pi \\varepsilon_{0} r}\n$$\nwhere $r = \\sqrt{x^{2} + y^{2}}$.\n\nThe complete Hamiltonian is:\n$$\n\\hat{H} = -\\frac{\\hbar^{2}}{2\\mu}\\nabla^{2}_{2D} - \\frac{e^{2}}{4\\pi \\varepsilon_{0} r}\n$$\nTo construct a system of atomic units, we seek to rewrite this Hamiltonian in a dimensionless form, where the coefficients of the operators are pure numbers of order unity. This is achieved by introducing a characteristic length scale, which the problem defines as the $2$D Bohr radius, $a_{\\mathrm{2D}}$. We define dimensionless coordinates $\\vec{r}' = (x', y')$ such that $\\vec{r} = a_{\\mathrm{2D}}\\vec{r}'$. Consequently, $x=a_{\\mathrm{2D}}x'$, $y=a_{\\mathrm{2D}}y'$, and the radial distance is $r = a_{\\mathrm{2D}}r'$.\n\nThe derivatives must also be transformed:\n$$\n\\frac{\\partial}{\\partial x} = \\frac{\\partial x'}{\\partial x}\\frac{\\partial}{\\partial x'} = \\frac{1}{a_{\\mathrm{2D}}}\\frac{\\partial}{\\partial x'}\n$$\nThus, the Laplacian operator transforms as:\n$$\n\\nabla^{2}_{2D} = \\frac{1}{a_{\\mathrm{2D}}^{2}}\\nabla'^{2}_{2D}\n$$\nwhere $\\nabla'^{2}_{2D} = \\frac{\\partial^{2}}{\\partial x'^{2}} + \\frac{\\partial^{2}}{\\partial y'^{2}}$.\n\nSubstituting these scaled variables into the Hamiltonian gives:\n$$\n\\hat{H} = -\\frac{\\hbar^{2}}{2\\mu a_{\\mathrm{2D}}^{2}}\\nabla'^{2}_{2D} - \\frac{e^{2}}{4\\pi \\varepsilon_{0} a_{\\mathrm{2D}} r'}\n$$\nThis expression still has dimensions of energy. We introduce a characteristic energy scale, the $2$D Hartree energy $E_{\\mathrm{h,2D}}$, and define a dimensionless Hamiltonian $\\hat{H}' = \\hat{H} / E_{\\mathrm{h,2D}}$.\n$$\n\\hat{H}' = \\frac{1}{E_{\\mathrm{h,2D}}}\\left(-\\frac{\\hbar^{2}}{2\\mu a_{\\mathrm{2D}}^{2}}\\nabla'^{2}_{2D} - \\frac{e^{2}}{4\\pi \\varepsilon_{0} a_{\\mathrm{2D}} r'}\\right) = \\left(-\\frac{\\hbar^{2}}{2\\mu a_{\\mathrm{2D}}^{2} E_{\\mathrm{h,2D}}}\\right)\\nabla'^{2}_{2D} - \\left(\\frac{e^{2}}{4\\pi \\varepsilon_{0} a_{\\mathrm{2D}} E_{\\mathrm{h,2D}}}\\right)\\frac{1}{r'}\n$$\nThe system of atomic units is defined by setting the coefficients in the dimensionless Hamiltonian to simple numerical values. The standard convention, which produces the simplest form, is to have the dimensionless Hamiltonian be:\n$$\n\\hat{H}' = -\\frac{1}{2}\\nabla'^{2}_{2D} - \\frac{1}{r'}\n$$\nFor this to be true, the following conditions must be met by the coefficients:\n1. The coefficient of the kinetic term: $\\dfrac{\\hbar^{2}}{2\\mu a_{\\mathrm{2D}}^{2} E_{\\mathrm{h,2D}}} = \\dfrac{1}{2} \\implies \\dfrac{\\hbar^{2}}{\\mu a_{\\mathrm{2D}}^{2} E_{\\mathrm{h,2D}}} = 1$\n2. The coefficient of the potential term: $\\dfrac{e^{2}}{4\\pi \\varepsilon_{0} a_{\\mathrm{2D}} E_{\\mathrm{h,2D}}} = 1$\n\nThis gives a system of two equations with two unknowns, $a_{\\mathrm{2D}}$ and $E_{\\mathrm{h,2D}}$. The problem asks for the expression for $a_{\\mathrm{2D}}$.\n\nFrom the second equation, we solve for the energy unit $E_{\\mathrm{h,2D}}$:\n$$\nE_{\\mathrm{h,2D}} = \\frac{e^{2}}{4\\pi \\varepsilon_{0} a_{\\mathrm{2D}}}\n$$\nNow, substitute this expression for $E_{\\mathrm{h,2D}}$ into the first equation:\n$$\n\\frac{\\hbar^{2}}{\\mu a_{\\mathrm{2D}}^{2} \\left(\\frac{e^{2}}{4\\pi \\varepsilon_{0} a_{\\mathrm{2D}}}\\right)} = 1\n$$\nSimplifying the expression on the left-hand side:\n$$\n\\frac{\\hbar^{2} (4\\pi \\varepsilon_{0} a_{\\mathrm{2D}})}{\\mu a_{\\mathrm{2D}}^{2} e^{2}} = \\frac{4\\pi \\varepsilon_{0} \\hbar^{2}}{\\mu e^{2} a_{\\mathrm{2D}}} = 1\n$$\nFinally, we solve for $a_{\\mathrm{2D}}$:\n$$\na_{\\mathrm{2D}} = \\frac{4\\pi \\varepsilon_{0} \\hbar^{2}}{\\mu e^{2}}\n$$\nThis expression is the $2$D Bohr radius. It is formally identical to the standard $3$D Bohr radius, with the electron mass replaced by the reduced mass $\\mu$. This is a direct consequence of the potential energy having the same $1/r$ dependence as in the $3$D case.\n\nThe problem also requires defining the atomic unit system. Based on the non-dimensionalization, the system of $2$D atomic units is one in which the following fundamental constants are set to unity:\n- Reduced mass: $\\mu = 1$\n- Elementary charge: $e = 1$\n- Reduced Planck constant: $\\hbar = 1$\n- Coulomb force constant: $1/(4\\pi\\varepsilon_0) = 1$\n\nIn this system, the unit of length is $a_{\\mathrm{2D}}$, which has a value of $1$. The derived expression provides its value in terms of the fundamental constants.", "answer": "$$\n\\boxed{\\frac{4 \\pi \\varepsilon_{0} \\hbar^{2}}{\\mu e^{2}}}\n$$", "id": "2450254"}, {"introduction": "One of the most elegant applications of atomic units is in revealing how quantum mechanical properties scale with fundamental parameters like nuclear charge. This practice guides you through a powerful coordinate scaling analysis of the Schrödinger equation for a hydrogenic atom [@problem_id:2874935]. You will derive the universal scaling laws for energy eigenvalues and wavefunctions with respect to the nuclear charge $Z$ and then use this result to find a general formula for radial expectation values $\\langle r^k \\rangle$.", "problem": "In atomic units (a.u.), defined by setting the electron mass $m_{e}=1$, the elementary charge $e=1$, the reduced Planck constant $\\hbar=1$, and the Coulomb constant $1/(4\\pi\\varepsilon_{0})=1$, consider the nonrelativistic one-electron Coulomb problem with nuclear charge $Z>0$. The stationary Schrödinger equation for the bound states in position representation is\n$$\n\\left[-\\frac{1}{2}\\nabla_{r}^{2}-\\frac{Z}{r}\\right]\\psi_{Z}(\\mathbf{r})=E_{Z}\\,\\psi_{Z}(\\mathbf{r}).\n$$\nWork entirely within atomic units.\n\nStarting only from this equation and standard properties of coordinate transformations and normalization, do the following:\n\n1. Introduce a scaled coordinate $\\boldsymbol{\\rho}=Z\\,\\mathbf{r}$ and use it to recast the Schrödinger equation into a $Z$-independent form. From this, deduce how the energy $E_{Z}$ and the normalized bound-state wavefunction $\\psi_{Z}(\\mathbf{r})$ scale with $Z$ relative to the $Z=1$ problem.\n\n2. Specialize to the spherically symmetric ground state and use your scaling result to obtain a closed-form expression for the moment $\\langle r^{k}\\rangle_{Z}\\equiv\\int_{\\mathbb{R}^{3}} r^{k}\\,|\\psi_{Z}(\\mathbf{r})|^{2}\\,d^{3}\\mathbf{r}$ as a function of real $k$ for which the integral converges, expressed in terms of $Z$ and the Gamma function $\\Gamma(\\cdot)$. You may assume the standard integral $\\int_{0}^{\\infty} x^{\\alpha-1}\\exp(-\\beta x)\\,dx=\\Gamma(\\alpha)\\,\\beta^{-\\alpha}$ for $\\Re(\\alpha)>0$, $\\Re(\\beta)>0$, and the well-tested fact that the $Z=1$ ground-state wavefunction is $\\psi_{1s}(\\mathbf{r})=(1/\\sqrt{\\pi})\\exp(-r)$.\n\nProvide the final result for $\\langle r^{k}\\rangle_{Z}$ as a single closed-form analytic expression in terms of $Z$ and $k$. Express your answer in atomic units and do not include units. No numerical rounding is required.", "solution": "The problem as stated is valid. It is a well-posed, scientifically grounded exercise in the application of scaling principles to the quantum-mechanical Coulomb problem, which is a fundamental topic. All provided information is self-consistent and sufficient for deriving a unique solution.\n\nWe will proceed in two parts, as requested. First, we derive the scaling laws for the energy and wavefunction. Second, we apply these laws to calculate the expectation value $\\langle r^{k}\\rangle_{Z}$ for the ground state.\n\nPart 1: Derivation of Scaling Relations\n\nThe stationary Schrödinger equation for a one-electron atom with nuclear charge $Z$ in atomic units is given as:\n$$\n\\left[-\\frac{1}{2}\\nabla_{r}^{2}-\\frac{Z}{r}\\right]\\psi_{Z}(\\mathbf{r})=E_{Z}\\,\\psi_{Z}(\\mathbf{r})\n$$\nWe introduce the scaled coordinate $\\boldsymbol{\\rho} = Z\\mathbf{r}$. This implies that $\\mathbf{r} = \\frac{1}{Z}\\boldsymbol{\\rho}$ and consequently $r = |\\mathbf{r}| = \\frac{1}{Z}|\\boldsymbol{\\rho}| = \\frac{\\rho}{Z}$. The gradient operator transforms according to the chain rule. For any component $i \\in \\{x, y, z\\}$, we have $\\frac{\\partial}{\\partial r_i} = \\frac{\\partial \\rho_i}{\\partial r_i}\\frac{\\partial}{\\partial \\rho_i} = Z \\frac{\\partial}{\\partial \\rho_i}$. Therefore, the gradient vector transforms as $\\nabla_{r} = Z\\nabla_{\\rho}$, and the Laplacian operator as $\\nabla_{r}^{2} = \\nabla_{r} \\cdot \\nabla_{r} = (Z\\nabla_{\\rho}) \\cdot (Z\\nabla_{\\rho}) = Z^{2}\\nabla_{\\rho}^{2}$.\n\nSubstituting these transformations into the Schrödinger equation:\n$$\n\\left[-\\frac{1}{2}(Z^{2}\\nabla_{\\rho}^{2})-\\frac{Z}{(\\rho/Z)}\\right]\\psi_{Z}\\left(\\frac{\\boldsymbol{\\rho}}{Z}\\right)=E_{Z}\\,\\psi_{Z}\\left(\\frac{\\boldsymbol{\\rho}}{Z}\\right)\n$$\nSimplifying the potential term gives:\n$$\n\\left[-\\frac{Z^{2}}{2}\\nabla_{\\rho}^{2}-\\frac{Z^{2}}{\\rho}\\right]\\psi_{Z}\\left(\\frac{\\boldsymbol{\\rho}}{Z}\\right)=E_{Z}\\,\\psi_{Z}\\left(\\frac{\\boldsymbol{\\rho}}{Z}\\right)\n$$\nWe can factor out $Z^2$ from the Hamiltonian operator on the left side:\n$$\nZ^{2}\\left[-\\frac{1}{2}\\nabla_{\\rho}^{2}-\\frac{1}{\\rho}\\right]\\psi_{Z}\\left(\\frac{\\boldsymbol{\\rho}}{Z}\\right)=E_{Z}\\,\\psi_{Z}\\left(\\frac{\\boldsymbol{\\rho}}{Z}\\right)\n$$\nDividing the entire equation by $Z^{2}$, we obtain:\n$$\n\\left[-\\frac{1}{2}\\nabla_{\\rho}^{2}-\\frac{1}{\\rho}\\right]\\psi_{Z}\\left(\\frac{\\boldsymbol{\\rho}}{Z}\\right)=\\frac{E_{Z}}{Z^{2}}\\,\\psi_{Z}\\left(\\frac{\\boldsymbol{\\rho}}{Z}\\right)\n$$\nThis equation has the exact form of the Schrödinger equation for the hydrogen atom ($Z=1$) in the coordinate system $\\boldsymbol{\\rho}$. The hydrogen atom equation is:\n$$\n\\left[-\\frac{1}{2}\\nabla_{\\rho}^{2}-\\frac{1}{\\rho}\\right]\\psi_{1}(\\boldsymbol{\\rho}) = E_{1}\\,\\psi_{1}(\\boldsymbol{\\rho})\n$$\nBy comparing these two equations, we deduce two scaling relations. First, for the energy eigenvalues:\n$$\n\\frac{E_{Z}}{Z^{2}} = E_{1} \\implies E_{Z} = Z^{2}E_{1}\n$$\nThe energy scales as the square of the nuclear charge. Second, the eigenfunctions must be functionally related. The function $\\psi_{Z}(\\boldsymbol{\\rho}/Z)$ must be an eigenfunction of the $Z=1$ Hamiltonian. Thus, it must be proportional to $\\psi_{1}(\\boldsymbol{\\rho})$. We write this relationship as $\\psi_{Z}(\\mathbf{r}) = N \\psi_{1}(Z\\mathbf{r})$, where $N$ is a normalization constant.\n\nTo find $N$, we enforce the normalization condition $\\int |\\psi_{Z}(\\mathbf{r})|^{2}\\,d^{3}\\mathbf{r} = 1$.\n$$\n\\int |N \\psi_{1}(Z\\mathbf{r})|^{2}\\,d^{3}\\mathbf{r} = 1 \\implies |N|^{2} \\int |\\psi_{1}(Z\\mathbf{r})|^{2}\\,d^{3}\\mathbf{r} = 1\n$$\nWe perform a change of variables in the integral from $\\mathbf{r}$ to $\\boldsymbol{\\rho} = Z\\mathbf{r}$. The volume element transforms as $d^{3}\\boldsymbol{\\rho} = Z^{3}d^{3}\\mathbf{r}$, so $d^{3}\\mathbf{r} = Z^{-3}d^{3}\\boldsymbol{\\rho}$.\n$$\n|N|^{2} \\int |\\psi_{1}(\\boldsymbol{\\rho})|^{2}\\,(Z^{-3}d^{3}\\boldsymbol{\\rho}) = 1\n$$\n$$\n|N|^{2}Z^{-3} \\int |\\psi_{1}(\\boldsymbol{\\rho})|^{2}\\,d^{3}\\boldsymbol{\\rho} = 1\n$$\nSince $\\psi_{1}$ is a normalized wavefunction, its normalization integral is $1$.\n$$\n|N|^{2}Z^{-3} = 1 \\implies |N|^{2} = Z^{3}\n$$\nChoosing the conventional real and positive value for the constant, we find $N = Z^{3/2}$. The scaling relation for the normalized wavefunction is therefore:\n$$\n\\psi_{Z}(\\mathbf{r}) = Z^{3/2}\\psi_{1}(Z\\mathbf{r})\n$$\n\nPart 2: Calculation of the Moment $\\langle r^{k}\\rangle_{Z}$\n\nWe are asked to compute the radial moment $\\langle r^{k}\\rangle_{Z} = \\int_{\\mathbb{R}^{3}} r^{k}\\,|\\psi_{Z}(\\mathbf{r})|^{2}\\,d^{3}\\mathbf{r}$ for the spherically symmetric ground state. We use the wavefunction scaling relation derived above.\n$$\n|\\psi_{Z}(\\mathbf{r})|^{2} = |Z^{3/2}\\psi_{1}(Z\\mathbf{r})|^{2} = Z^{3}|\\psi_{1}(Z\\mathbf{r})|^{2}\n$$\nThe problem states that the ground state wavefunction for $Z=1$ is $\\psi_{1}(\\mathbf{r}) = (1/\\sqrt{\\pi})\\exp(-r)$. This is a spherically symmetric function, depending only on the magnitude $r=|\\mathbf{r}|$. Thus, $|\\psi_{1}(Z\\mathbf{r})|^{2} = |\\psi_{1}(|Z\\mathbf{r}|)|^{2} = |\\psi_{1}(Zr)|^{2}$.\n$$\n|\\psi_{1}(Zr)|^{2} = \\left(\\frac{1}{\\sqrt{\\pi}}\\exp(-Zr)\\right)^{2} = \\frac{1}{\\pi}\\exp(-2Zr)\n$$\nSubstituting these expressions into the integral for the moment:\n$$\n\\langle r^{k}\\rangle_{Z} = \\int_{\\mathbb{R}^{3}} r^{k} \\left(Z^{3} \\frac{1}{\\pi}\\exp(-2Zr)\\right) d^{3}\\mathbf{r}\n$$\nWe transform to spherical coordinates, where $d^{3}\\mathbf{r} = r^{2}\\sin\\theta\\,dr\\,d\\theta\\,d\\phi$. As the integrand is spherically symmetric, the angular integration yields a factor of $4\\pi$.\n$$\n\\langle r^{k}\\rangle_{Z} = \\frac{Z^{3}}{\\pi} \\int_{0}^{\\infty} r^{k}\\exp(-2Zr)\\,(4\\pi r^{2}\\,dr) = 4Z^{3} \\int_{0}^{\\infty} r^{k+2}\\exp(-2Zr)\\,dr\n$$\nThis integral is of the standard form $\\int_{0}^{\\infty} x^{\\alpha-1}\\exp(-\\beta x)\\,dx=\\Gamma(\\alpha)\\,\\beta^{-\\alpha}$. We identify the parameters by comparing our integral to this form. Let $x=r$.\nThe exponent of $r$ is $k+2$, which must equal $\\alpha-1$. Thus, $\\alpha = k+3$.\nThe coefficient in the exponential is $2Z$, which must equal $\\beta$.\nThe integral converges for real $k$ when $\\alpha > 0$, which implies $k+3 > 0$, or $k > -3$.\nThe value of the integral is $\\Gamma(k+3)(2Z)^{-(k+3)}$.\n\nSubstituting this result back into our expression for $\\langle r^{k}\\rangle_{Z}$:\n$$\n\\langle r^{k}\\rangle_{Z} = 4Z^{3} \\left[ \\Gamma(k+3)(2Z)^{-(k+3)} \\right]\n$$\nWe simplify the prefactors:\n$$\n\\langle r^{k}\\rangle_{Z} = 4Z^{3} \\Gamma(k+3) 2^{-(k+3)} Z^{-(k+3)}\n$$\n$$\n\\langle r^{k}\\rangle_{Z} = (2^{2}) (2^{-k-3}) (Z^{3}) (Z^{-k-3}) \\Gamma(k+3)\n$$\n$$\n\\langle r^{k}\\rangle_{Z} = 2^{2-k-3} Z^{3-k-3} \\Gamma(k+3)\n$$\n$$\n\\langle r^{k}\\rangle_{Z} = 2^{-k-1} Z^{-k} \\Gamma(k+3)\n$$\nThis can be written in a more structured form as:\n$$\n\\langle r^{k}\\rangle_{Z} = \\frac{\\Gamma(k+3)}{2^{k+1}Z^{k}}\n$$\nThis is the final closed-form expression for the moment $\\langle r^{k}\\rangle_{Z}$ for the ground state of a hydrogenic atom with nuclear charge $Z$, valid for real $k > -3$.", "answer": "$$\n\\boxed{\\frac{\\Gamma(k+3)}{2^{k+1}Z^{k}}}\n$$", "id": "2874935"}, {"introduction": "Atomic units are indispensable in modern computational chemistry, where they strip physical constants from equations and simplify numerical algorithms. This problem bridges theory and practice by having you implement the split-operator method, a cornerstone algorithm for simulating quantum dynamics [@problem_id:2857777]. By solving the time-dependent Schrödinger equation and numerically verifying the algorithm's convergence, you will gain hands-on experience with the interplay between quantum mechanics, numerical methods, and the practical utility of atomic units.", "problem": "Implement a program that solves the one-dimensional time-dependent Schrödinger equation using the split-operator method based on the second-order Trotter (Strang) factorization, and numerically analyzes the global error scaling with respect to the time step. Begin from the fundamental law $i\\hbar \\frac{\\partial}{\\partial t}\\psi(x,t)=H\\psi(x,t)$, with the Hamiltonian split into $H=H_T+H_V$, where $H_T$ is the kinetic-energy operator and $H_V$ is the potential-energy operator. Use Hartree atomic units, where $\\hbar=1$ and the electron mass $m=1$; all quantities are thus dimensionless in this unit system. Define $H_T = -\\frac{1}{2}\\frac{\\partial^2}{\\partial x^2}$ and $H_V=V(x)$, so that $H_T$ is diagonal in momentum space and $H_V$ is diagonal in position space. The second-order Trotter factorization approximates one step of time evolution by\n$$\ne^{-i(H_T+H_V)\\Delta t}\\approx e^{-iH_V\\Delta t/2}\\,e^{-iH_T\\Delta t}\\,e^{-iH_V\\Delta t/2},\n$$\nwhich is unitary and has a local error of order $\\mathcal{O}(\\Delta t^3)$.\n\nYou must implement this approximation using the Fast Fourier Transform (FFT) to apply $e^{-iH_T\\Delta t}$ in momentum space and $e^{-iH_V\\Delta t/2}$ in position space. For the convergence study, restrict to the harmonic oscillator potential $V(x)=\\frac{1}{2}\\omega^2 x^2$ and choose as the initial state the exact normalized ground state of the harmonic oscillator,\n$$\n\\psi_0(x)=\\left(\\frac{\\omega}{\\pi}\\right)^{1/4}\\exp\\!\\left(-\\frac{\\omega x^2}{2}\\right).\n$$\nIn atomic units, the ground-state energy is $E_0=\\frac{\\omega}{2}$, so the exact wave function at time $t$ is $\\psi_{\\text{exact}}(x,t)=\\psi_0(x)\\,e^{-iE_0 t}$.\n\nDiscretize space on a uniform grid of $N$ points over a domain of length $L$ using periodic boundary conditions implied by the FFT. Let the grid spacing be $\\Delta x=L/N$, with coordinates chosen as $x_j=-L/2 + j\\,\\Delta x$ for $j\\in\\{0,1,\\dots,N-1\\}$. Implement the following for each time step $\\Delta t$:\n- Apply the potential half-step in position space: $\\psi(x)\\leftarrow e^{-iV(x)\\Delta t/2}\\psi(x)$.\n- Apply the kinetic full-step in momentum space: $\\tilde{\\psi}(k)=\\mathcal{F}[\\psi(x)]$, then $\\tilde{\\psi}(k)\\leftarrow e^{-ik^2\\Delta t/2}\\tilde{\\psi}(k)$, and then $\\psi(x)=\\mathcal{F}^{-1}[\\tilde{\\psi}(k)]$, where $k$ is the angular wavenumber defined by the FFT frequency convention and $k^2$ appears from $H_T$ in atomic units.\n- Apply the potential half-step again in position space.\n\nFor each specified $\\Delta t$, propagate the initial state for a total time $T$ using $n=T/\\Delta t$ steps (assume $n$ is an integer) and compute the discrete $L^2$-error at time $T$:\n$$\nE(\\Delta t)=\\left(\\sum_{j=0}^{N-1}\\left|\\psi_{\\text{num}}(x_j,T)-\\psi_{\\text{exact}}(x_j,T)\\right|^2\\,\\Delta x\\right)^{1/2}.\n$$\nNormalize the initial state numerically so that $\\sum_j|\\psi_0(x_j)|^2\\,\\Delta x=1$. In all computations, use double-precision complex arithmetic.\n\nAnalyze the global error scaling by fitting a line to $\\log E(\\Delta t)$ versus $\\log \\Delta t$ for a given set of $\\Delta t$ values and reporting the slope $s$, which should reflect second-order accuracy, i.e., $E(\\Delta t)\\propto \\Delta t^2$ implying $s\\approx 2$. For additional quantitative checks, also compute successive error ratios $E(\\Delta t)/E(\\Delta t/2)$.\n\nUse the following three test cases. For each case, all parameters must be implemented exactly as given. All quantities are in atomic units.\n\n- Test Case $1$ (general case):\n  - Harmonic oscillator with angular frequency $\\omega=1.0$.\n  - Spatial domain length $L=20.0$ and number of grid points $N=4096$.\n  - Total propagation time $T=1.0$.\n  - Time steps $\\Delta t\\in\\{0.2,\\,0.1,\\,0.05,\\,0.025\\}$.\n  - Outputs to report for this case:\n    - The fitted slope $s_1$ from linear regression of $\\log E(\\Delta t)$ versus $\\log \\Delta t$.\n    - The three successive error ratios $r_{1a}=E(0.2)/E(0.1)$, $r_{1b}=E(0.1)/E(0.05)$, and $r_{1c}=E(0.05)/E(0.025)$.\n\n- Test Case $2$ (stronger confinement):\n  - Harmonic oscillator with angular frequency $\\omega=2.0$.\n  - Spatial domain length $L=20.0$ and number of grid points $N=4096$.\n  - Total propagation time $T=1.0$.\n  - Time steps $\\Delta t\\in\\{0.2,\\,0.1,\\,0.05,\\,0.025\\}$.\n  - Output to report: the fitted slope $s_2$.\n\n- Test Case $3$ (longer time):\n  - Harmonic oscillator with angular frequency $\\omega=1.0$.\n  - Spatial domain length $L=20.0$ and number of grid points $N=4096$.\n  - Total propagation time $T=2.0$.\n  - Time steps $\\Delta t\\in\\{0.2,\\,0.1,\\,0.05,\\,0.025\\}$.\n  - Output to report: the fitted slope $s_3$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets with the following order and rounding:\n- $[s_1,\\,r_{1a},\\,r_{1b},\\,r_{1c},\\,s_2,\\,s_3]$,\n- where each number is rounded to exactly $6$ decimal places.\n\nAll mathematical quantities are dimensionless in atomic units. No angles are reported, and all final outputs are pure numbers without units. Ensure the spatial discretization is sufficiently accurate so that the observed scaling is dominated by time-discretization error for the specified parameters. Your implementation must be self-contained and must not require any external input files.", "solution": "The problem presented is a standard exercise in computational quantum mechanics and is deemed valid. It is scientifically grounded, well-posed, objective, and contains all necessary information for a unique solution. We will proceed with the formulation of the solution.\n\nThe fundamental task is to solve the one-dimensional time-dependent Schrödinger equation (TDSE) for a particle in a potential $V(x)$. In Hartree atomic units, where the reduced Planck constant $\\hbar$ and the electron mass $m$ are both unity, the TDSE is given by:\n$$\ni \\frac{\\partial}{\\partial t}\\psi(x,t) = \\hat{H}\\psi(x,t)\n$$\nThe Hamiltonian operator $\\hat{H}$ is the sum of the kinetic energy operator $\\hat{H}_T$ and the potential energy operator $\\hat{H}_V$:\n$$\n\\hat{H} = \\hat{H}_T + \\hat{H}_V = -\\frac{1}{2}\\frac{\\partial^2}{\\partial x^2} + V(x)\n$$\nThe formal solution for the evolution of the wavefunction $\\psi(x,t)$ from time $t$ to $t+\\Delta t$ is expressed via the time evolution operator $\\hat{U}(\\Delta t) = e^{-i\\hat{H}\\Delta t}$:\n$$\n\\psi(x, t+\\Delta t) = e^{-i\\hat{H}\\Delta t} \\psi(x,t)\n$$\nDirect numerical application of this exponential operator is intractable because the kinetic and potential operators, $\\hat{H}_T$ and $\\hat{H}_V$, do not commute, i.e., $[\\hat{H}_T, \\hat{H}_V] \\neq 0$. This non-commutativity prevents the simple factorization $e^{-i(\\hat{H}_T + \\hat{H}_V)\\Delta t} = e^{-i\\hat{H}_T\\Delta t} e^{-i\\hat{H}_V\\Delta t}$.\n\nTo circumvent this, we employ the split-operator method, which is based on a Trotter-Suzuki product formula. The specific variant requested is the second-order symmetric Strang splitting, which approximates the evolution operator for a small time step $\\Delta t$ as:\n$$\n\\hat{U}(\\Delta t) = e^{-i(\\hat{H}_T + \\hat{H}_V)\\Delta t} \\approx e^{-i\\hat{H}_V\\Delta t/2} \\, e^{-i\\hat{H}_T\\Delta t} \\, e^{-i\\hat{H}_V\\Delta t/2}\n$$\nThis approximation is unitary, preserving the norm of the wavefunction, and has a local error of order $\\mathcal{O}(\\Delta t^3)$. Propagating the system for a total time $T$ requires $n = T/\\Delta t$ steps, resulting in a global error of order $\\mathcal{O}(\\Delta t^2)$. This is the scaling behavior we must verify.\n\nThe power of this method lies in its implementation. The operator $\\hat{H}_V$ is diagonal in the position basis (its action is simple multiplication by the function $V(x)$), while the operator $\\hat{H}_T$ is diagonal in the momentum basis. The Fast Fourier Transform (FFT) provides a highly efficient numerical means of transforming the wavefunction between the position basis and the momentum basis.\n\nLet the wavefunction be represented on a discrete spatial grid of $N$ points, $\\{x_j\\}$, with spacing $\\Delta x = L/N$. The corresponding momentum (wavenumber) grid $\\{k_j\\}$ is determined by the properties of the discrete Fourier transform. The algorithm for propagating the wavefunction $\\psi(x)$ over one time step $\\Delta t$ is as follows:\n\n1.  **First Potential Half-Step**: The wavefunction is in the position representation. We apply the first half of the potential propagator, which is a simple multiplication:\n    $$\n    \\psi(x_j, t + \\Delta t/2) = e^{-iV(x_j)\\Delta t/2} \\psi(x_j, t)\n    $$\n    For the specified harmonic oscillator potential, $V(x) = \\frac{1}{2}\\omega^2 x^2$.\n\n2.  **Kinetic Full-Step**: To apply the kinetic propagator, we transform the wavefunction to the momentum representation using the FFT:\n    $$\n    \\tilde{\\psi}(k_j, t + \\Delta t/2) = \\mathcal{F}[\\psi(x_j, t + \\Delta t/2)]\n    $$\n    In momentum space, the operator $\\hat{H}_T = \\hat{p}^2/2$ becomes multiplication by the function $k^2/2$ (since $p=k$ in our units). The kinetic evolution is thus:\n    $$\n    \\tilde{\\psi}(k_j, t + \\Delta t/2)_{\\text{after}} = e^{-ik_j^2\\Delta t/2} \\tilde{\\psi}(k_j, t + \\Delta t/2)\n    $$\n    The wavefunction is then transformed back to the position representation using the inverse FFT (iFFT):\n    $$\n    \\psi'(x_j, t + \\Delta t/2) = \\mathcal{F}^{-1}[\\tilde{\\psi}(k_j, t + \\Delta t/2)_{\\text{after}}]\n    $$\n\n3.  **Second Potential Half-Step**: The final step is to apply the second half of the potential propagator in the position representation:\n    $$\n    \\psi(x_j, t + \\Delta t) = e^{-iV(x_j)\\Delta t/2} \\psi'(x_j, t + \\Delta t/2)\n    $$\n\nThis three-step sequence advances the state from $t$ to $t + \\Delta t$. It is repeated $n = T/\\Delta t$ times to reach the final time $T$.\n\nFor the convergence analysis, we use the exact ground state of the quantum harmonic oscillator as the initial state, $\\psi(x,0) = \\psi_0(x)$. This is an eigenstate of the Hamiltonian with energy $E_0 = \\omega/2$. Therefore, the exact time-evolved state is known analytically:\n$$\n\\psi_{\\text{exact}}(x,t) = \\psi_0(x) \\, e^{-iE_0 t}\n$$\nAfter obtaining the numerical solution $\\psi_{\\text{num}}(x_j, T)$ at the final time $T$, we compute the discrete $L^2$-error:\n$$\nE(\\Delta t) = \\left(\\sum_{j=0}^{N-1} |\\psi_{\\text{num}}(x_j, T) - \\psi_{\\text{exact}}(x_j, T)|^2 \\Delta x\\right)^{1/2}\n$$\nThe order of convergence is determined by analyzing the relationship $E(\\Delta t) \\propto (\\Delta t)^s$. In logarithmic scale, this becomes $\\log E = s \\log \\Delta t + C$, which is a linear relationship. We perform a linear regression on the $(\\log \\Delta t, \\log E)$ data points to find the slope $s$, which should be approximately $2$. Additionally, for a method of order $s$, the ratio of errors for successive step sizes $E(\\Delta t) / E(\\Delta t/2)$ should approach $2^s$. For $s=2$, this ratio is $4$.\n\nThe computational procedure is thus: for each test case, we set up the spatial grid, define and normalize the initial wavefunction, and pre-calculate the exact solution at time $T$. We then iterate through the specified list of time steps $\\Delta t$. For each $\\Delta t$, we run the split-operator simulation and compute the final error $E(\\Delta t)$. Finally, we use the collected error data to compute the required slope and error ratios. This entire process is encapsulated in the provided Python code.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.stats import linregress\n\ndef run_simulation(omega, L, N, T, delta_t_list):\n    \"\"\"\n    Runs a simulation for a given set of parameters and returns the error analysis.\n\n    Args:\n        omega (float): Angular frequency of the harmonic oscillator.\n        L (float): Length of the spatial domain.\n        N (int): Number of grid points.\n        T (float): Total propagation time.\n        delta_t_list (list of float): List of time steps for the convergence study.\n\n    Returns:\n        tuple: A tuple containing the fitted slope (float) and a list of error ratios (list of float).\n    \"\"\"\n\n    # 1. Setup spatial and momentum grids\n    dx = L / N\n    x = -L / 2 + np.arange(N) * dx\n    k = 2 * np.pi * np.fft.fftfreq(N, d=dx)\n\n    # 2. Define initial and exact final wavefunctions\n    # The initial state is the analytic ground state of the harmonic oscillator.\n    # We ensure it is a complex array for subsequent calculations.\n    psi0_analytic = ((omega / np.pi)**0.25 * np.exp(-omega * x**2 / 2)).astype(np.complex128)\n\n    # Numerically normalize the initial state on the discrete grid.\n    norm_factor = np.sqrt(np.sum(np.abs(psi0_analytic)**2) * dx)\n    psi0 = psi0_analytic / norm_factor\n\n    # The exact state at time T is the initial state multiplied by a phase factor.\n    # We use the numerically normalized psi0 for consistency.\n    E0 = omega / 2\n    psi_exact_T = psi0 * np.exp(-1j * E0 * T)\n\n    errors = []\n    \n    # Define the potential energy operator V(x)\n    V = 0.5 * omega**2 * x**2\n\n    # 3. Time evolution loop for each delta_t\n    for dt in delta_t_list:\n        n_steps = int(round(T / dt))\n        psi_current = psi0.copy()\n        \n        # Pre-compute time-evolution operators for this dt\n        exp_V_half = np.exp(-1j * V * dt / 2)\n        exp_T_full = np.exp(-1j * k**2 * dt / 2)\n        \n        for _ in range(n_steps):\n            # Apply first potential half-step in position space\n            psi_current *= exp_V_half\n            \n            # Apply kinetic full-step in momentum space\n            psi_k = np.fft.fft(psi_current)\n            psi_k *= exp_T_full\n            psi_current = np.fft.ifft(psi_k)\n            \n            # Apply second potential half-step in position space\n            psi_current *= exp_V_half\n            \n        # 4. Compute L2 error\n        error = np.sqrt(np.sum(np.abs(psi_current - psi_exact_T)**2) * dx)\n        errors.append(error)\n\n    # 5. Analyze error scaling\n    log_dt = np.log(delta_t_list)\n    log_E = np.log(errors)\n    \n    # Fit a line to log(E) vs log(dt) to find the slope\n    slope, _, _, _, _ = linregress(log_dt, log_E)\n    \n    # Compute successive error ratios\n    ratios = [errors[i] / errors[i+1] for i in range(len(errors) - 1)]\n    \n    return slope, ratios\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases and print the final results.\n    \"\"\"\n    \n    # Common Parameters\n    L = 20.0\n    N = 4096\n    delta_t_list = [0.2, 0.1, 0.05, 0.025]\n\n    # Test Case 1: General case\n    omega1 = 1.0\n    T1 = 1.0\n    s1, ratios1 = run_simulation(omega1, L, N, T1, delta_t_list)\n    r1a, r1b, r1c = ratios1[0], ratios1[1], ratios1[2]\n    \n    # Test Case 2: Stronger confinement\n    omega2 = 2.0\n    T2 = 1.0\n    s2, _ = run_simulation(omega2, L, N, T2, delta_t_list)\n\n    # Test Case 3: Longer time\n    omega3 = 1.0\n    T3 = 2.0\n    s3, _ = run_simulation(omega3, L, N, T3, delta_t_list)\n    \n    # Consolidate and format results\n    results = [s1, r1a, r1b, r1c, s2, s3]\n    formatted_results = [f\"{num:.6f}\" for num in results]\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2857777"}]}