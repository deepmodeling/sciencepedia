{"hands_on_practices": [{"introduction": "The slow convergence of electron correlation energy with respect to basis set size is a central challenge in quantum chemistry. This practice provides a direct handle on the solution: complete basis set (CBS) extrapolation. You will derive the standard two-point formula from the known asymptotic behavior $E_{\\text{corr}}(X) \\approx E_{\\text{corr}}^{\\text{CBS}} + A X^{-3}$ and then apply it to numerical data, mastering a fundamental technique for obtaining high-accuracy energies. [@problem_id:2893369]", "problem": "In full configuration interaction (FCI) within a systematic correlation-consistent basis set family (for example, the correlation-consistent polarized valence $X$-zeta sequence), the basis-set truncation error of the correlation energy is well known to decay as a power of the basis cardinal number. Empirically and theoretically, the leading asymptotic term for the correlation energy behaves as $X^{-3}$ in such families, reflecting the partial-wave convergence of the electron–electron cusp. Let $E_{\\text{corr}}(X)$ denote the FCI correlation energy in a basis with cardinal number $X$, and let $E_{\\text{corr}}^{\\text{CBS}}$ denote the complete basis set (CBS) limit of the FCI correlation energy in the nonrelativistic Born–Oppenheimer framework.\n\n1. Starting from the asymptotic model $E_{\\text{corr}}(X)=E_{\\text{corr}}^{\\text{CBS}}+A X^{-3}$ with a basis-independent constant $A$, derive an explicit two-point expression for $E_{\\text{corr}}^{\\text{CBS}}$ in terms of $E_{\\text{corr}}(X)$, $E_{\\text{corr}}(Y)$, $X$, and $Y$, suitable for extrapolating from two finite cardinal numbers $X$ and $Y$.\n\n2. Apply your expression to the following FCI correlation energies (in hartree) obtained with $X=3$ and $Y=4$:\n   - $E_{\\text{corr}}(3) = -0.220365\\,\\mathrm{E_h}$,\n   - $E_{\\text{corr}}(4) = -0.238742\\,\\mathrm{E_h}$.\n   \n   Report the extrapolated $E_{\\text{corr}}^{\\text{CBS}}$ in hartree. Round your final answer to $6$ significant figures. Provide only the extrapolated numerical value as your final answer.", "solution": "The problem as stated is scientifically grounded, well-posed, and objective. It presents a standard procedure in quantum chemistry for extrapolating to the complete basis set limit. We will proceed with the solution.\n\nThe problem is divided into two parts. First, we must derive a two-point extrapolation formula for the complete basis set (CBS) correlation energy, $E_{\\text{corr}}^{\\text{CBS}}$. Second, we must apply this formula to the provided numerical data.\n\nPart 1: Derivation of the extrapolation formula.\n\nThe starting point is the asymptotic model for the correlation energy, $E_{\\text{corr}}(X)$, as a function of the basis set cardinal number, $X$:\n$$E_{\\text{corr}}(X) = E_{\\text{corr}}^{\\text{CBS}} + A X^{-3}$$\nHere, $E_{\\text{corr}}^{\\text{CBS}}$ is the desired CBS limit energy and $A$ is a constant that does not depend on the basis set.\n\nWe are given two calculations performed with basis sets of cardinal numbers $X$ and $Y$. This provides us with two specific instances of the model equation:\n$$E_{\\text{corr}}(X) = E_{\\text{corr}}^{\\text{CBS}} + A X^{-3} \\quad (1)$$\n$$E_{\\text{corr}}(Y) = E_{\\text{corr}}^{\\text{CBS}} + A Y^{-3} \\quad (2)$$\n\nThis is a system of two linear equations with two unknowns, $E_{\\text{corr}}^{\\text{CBS}}$ and $A$. Our goal is to eliminate the unknown parameter $A$ and solve for $E_{\\text{corr}}^{\\text{CBS}}$.\n\nFrom equation (1), we can isolate the term containing $A$:\n$$A X^{-3} = E_{\\text{corr}}(X) - E_{\\text{corr}}^{\\text{CBS}}$$\nFrom equation (2), we do the same:\n$$A Y^{-3} = E_{\\text{corr}}(Y) - E_{\\text{corr}}^{\\text{CBS}}$$\n\nTo eliminate $A$, we can multiply the first of these rearranged equations by $Y^3$ and the second by $X^3$:\n$$A Y^3 = Y^3 (E_{\\text{corr}}(X) - E_{\\text{corr}}^{\\text{CBS}})$$\n$$A X^3 = X^3 (E_{\\text{corr}}(Y) - E_{\\text{corr}}^{\\text{CBS}})$$\n\nThis is not the most direct path. Let us restart the algebraic manipulation to solve for $A$ from each equation.\nFrom equation (1):\n$$A = X^3 (E_{\\text{corr}}(X) - E_{\\text{corr}}^{\\text{CBS}})$$\nFrom equation (2):\n$$A = Y^3 (E_{\\text{corr}}(Y) - E_{\\text{corr}}^{\\text{CBS}})$$\n\nSince $A$ is the same in both expressions, we can equate them:\n$$X^3 (E_{\\text{corr}}(X) - E_{\\text{corr}}^{\\text{CBS}}) = Y^3 (E_{\\text{corr}}(Y) - E_{\\text{corr}}^{\\text{CBS}})$$\n\nOur objective is to solve for $E_{\\text{corr}}^{\\text{CBS}}$. We expand the terms:\n$$X^3 E_{\\text{corr}}(X) - X^3 E_{\\text{corr}}^{\\text{CBS}} = Y^3 E_{\\text{corr}}(Y) - Y^3 E_{\\text{corr}}^{\\text{CBS}}$$\n\nNext, we group all terms containing $E_{\\text{corr}}^{\\text{CBS}}$ on one side of the equation and all other terms on the other side:\n$$Y^3 E_{\\text{corr}}^{\\text{CBS}} - X^3 E_{\\text{corr}}^{\\text{CBS}} = Y^3 E_{\\text{corr}}(Y) - X^3 E_{\\text{corr}}(X)$$\n\nFactor out $E_{\\text{corr}}^{\\text{CBS}}$ from the left side:\n$$E_{\\text{corr}}^{\\text{CBS}} (Y^3 - X^3) = Y^3 E_{\\text{corr}}(Y) - X^3 E_{\\text{corr}}(X)$$\n\nFinally, we isolate $E_{\\text{corr}}^{\\text{CBS}}$ by dividing by the factor $(Y^3 - X^3)$, assuming $X \\neq Y$, which is true for any meaningful extrapolation.\n$$E_{\\text{corr}}^{\\text{CBS}} = \\frac{Y^3 E_{\\text{corr}}(Y) - X^3 E_{\\text{corr}}(X)}{Y^3 - X^3}$$\nThis is the required explicit two-point expression for the CBS correlation energy.\n\nPart 2: Application of the formula to numerical data.\n\nWe are given the following data:\n- Cardinal number $X = 3$\n- Cardinal number $Y = 4$\n- Correlation energy for $X=3$: $E_{\\text{corr}}(3) = -0.220365 \\, \\mathrm{E_h}$\n- Correlation energy for $Y=4$: $E_{\\text{corr}}(4) = -0.238742 \\, \\mathrm{E_h}$\n\nWe substitute these values into the derived formula:\n$$E_{\\text{corr}}^{\\text{CBS}} = \\frac{4^3 E_{\\text{corr}}(4) - 3^3 E_{\\text{corr}}(3)}{4^3 - 3^3}$$\n\nFirst, we calculate the powers of the cardinal numbers:\n$$X^3 = 3^3 = 27$$\n$$Y^3 = 4^3 = 64$$\n\nNow, substitute these into the equation:\n$$E_{\\text{corr}}^{\\text{CBS}} = \\frac{64 \\times (-0.238742) - 27 \\times (-0.220365)}{64 - 27}$$\n\nWe evaluate the numerator:\nNumerator $= (64 \\times -0.238742) - (27 \\times -0.220365)$\nNumerator $= -15.279488 - (-5.949855)$\nNumerator $= -15.279488 + 5.949855$\nNumerator $= -9.329633$\n\nWe evaluate the denominator:\nDenominator $= 64 - 27 = 37$\n\nNow we perform the final division:\n$$E_{\\text{corr}}^{\\text{CBS}} = \\frac{-9.329633}{37} \\approx -0.2521522432...$$\n\nThe problem requires the answer to be rounded to $6$ significant figures. The calculated value is $-0.2521522432...$. The first six significant digits are $2$, $5$, $2$, $1$, $5$, $2$. The seventh significant digit is $2$, which is less than $5$. Therefore, we round down, which means we truncate the value after the sixth significant digit.\n\nThe final extrapolated CBS correlation energy is $-0.252152 \\, \\mathrm{E_h}$.", "answer": "$$\n\\boxed{-0.252152}\n$$", "id": "2893369"}, {"introduction": "Beyond general extrapolation, the true power of correlation-consistent basis sets lies in their systematic hierarchy, which allows us to isolate specific physical effects. This exercise demonstrates this principle by quantifying the contribution of core-electron correlation to a chemical property, the atomization energy of the $N_2$ molecule. By comparing results from valence-only (cc-pVTZ) and core-valence (cc-pCVTZ) basis sets, you will learn how to dissect the total energy into physically meaningful components. [@problem_id:2766320]", "problem": "You are given total electronic energies (in Hartree atomic units) for the nitrogen atom and the nitrogen molecule computed with two correlation-consistent contracted Gaussian basis set families: correlation-consistent polarized valence triple-zeta (cc-pVTZ) and correlation-consistent polarized core-valence triple-zeta (cc-pCVTZ). For each basis, you have both all-electron correlated energies (core and valence electrons correlated) and frozen-core correlated energies (only valence electrons correlated). Your task is to compute the change in atomization energy of the nitrogen molecule when moving from cc-pVTZ to cc-pCVTZ and to attribute this change to core correlation effects by removing the change observed under the frozen-core approximation.\n\nUse the following fundamental definitions and facts as the sole base of your derivation:\n- The atomization energy of a diatomic molecule with two identical atoms is defined as $E_{\\mathrm{atom}} = 2 E_{\\mathrm{atom}}^{(1)} - E_{\\mathrm{mol}}$, where $E_{\\mathrm{atom}}^{(1)}$ is the total energy of one isolated atom and $E_{\\mathrm{mol}}$ is the total energy of the molecule, all at the same level of theory and basis.\n- The Hartree-to-kilojoule-per-mole conversion is $1\\,E_h = 2625.49962\\,\\mathrm{kJ/mol}$.\n- The change in atomization energy between two bases A and B at the same electron correlation treatment is the difference of their atomization energies computed at that treatment.\n- To estimate the part of the change that is attributable to core correlation, remove the change observed under the frozen-core approximation from the change observed with all electrons correlated, both for the same basis change.\n\nCompute all requested quantities in $\\mathrm{kJ/mol}$, rounded to three decimals. Do not print unit symbols in the output; ensure the numeric values are in the requested unit.\n\nTest suite (each test case supplies eight total energies: for nitrogen atom and nitrogen molecule, at each of the two bases, and at each of the two correlation treatments):\n\nTest case 1 (realistic cc-pCVTZ increment dominated by core correlation):\n- All-electron cc-pVTZ: $E_{\\mathrm{N}} = -54.589200$, $E_{\\mathrm{N_2}} = -109.542600$.\n- All-electron cc-pCVTZ: $E_{\\mathrm{N}} = -54.589550$, $E_{\\mathrm{N_2}} = -109.545200$.\n- Frozen-core cc-pVTZ: $E_{\\mathrm{N}} = -54.570000$, $E_{\\mathrm{N_2}} = -109.510000$.\n- Frozen-core cc-pCVTZ: $E_{\\mathrm{N}} = -54.570020$, $E_{\\mathrm{N_2}} = -109.510040$.\n\nTest case 2 (boundary: no change across bases):\n- All-electron cc-pVTZ: $E_{\\mathrm{N}} = -54.600000$, $E_{\\mathrm{N_2}} = -109.560000$.\n- All-electron cc-pCVTZ: $E_{\\mathrm{N}} = -54.600000$, $E_{\\mathrm{N_2}} = -109.560000$.\n- Frozen-core cc-pVTZ: $E_{\\mathrm{N}} = -54.580000$, $E_{\\mathrm{N_2}} = -109.530000$.\n- Frozen-core cc-pCVTZ: $E_{\\mathrm{N}} = -54.580000$, $E_{\\mathrm{N_2}} = -109.530000$.\n\nTest case 3 (edge: slight negative change across bases):\n- All-electron cc-pVTZ: $E_{\\mathrm{N}} = -54.590000$, $E_{\\mathrm{N_2}} = -109.543000$.\n- All-electron cc-pCVTZ: $E_{\\mathrm{N}} = -54.591000$, $E_{\\mathrm{N_2}} = -109.543500$.\n- Frozen-core cc-pVTZ: $E_{\\mathrm{N}} = -54.572000$, $E_{\\mathrm{N_2}} = -109.512000$.\n- Frozen-core cc-pCVTZ: $E_{\\mathrm{N}} = -54.572000$, $E_{\\mathrm{N_2}} = -109.512000$.\n\nFor each test case:\n1. Compute the atomization energy at all-electron for cc-pVTZ and cc-pCVTZ, then the change (cc-pCVTZ minus cc-pVTZ).\n2. Compute the atomization energy at frozen-core for cc-pVTZ and cc-pCVTZ, then the change (cc-pCVTZ minus cc-pVTZ).\n3. Attribute the change to core correlation as the all-electron change minus the frozen-core change.\n\nYour program should output a single line containing a flat list of floats with two numbers per test case in this exact order:\n- For each test case $i$ in order $1,2,3$: first the change in atomization energy with all electrons correlated (in $\\mathrm{kJ/mol}$, rounded to three decimals), then the portion attributed to core correlation (in $\\mathrm{kJ/mol}$, rounded to three decimals).\n\nThus the output should be a single line containing a comma-separated list enclosed in square brackets, for example $[x_1,y_1,x_2,y_2,x_3,y_3]$, where $x_i$ is the all-electron change for case $i$ and $y_i$ is the core-correlation-attributed portion for case $i$, each in $\\mathrm{kJ/mol}$ rounded to three decimals.", "solution": "The problem statement has been rigorously validated and is deemed valid. It is scientifically grounded in the principles of quantum chemistry, mathematically well-posed, and objective. All necessary data and definitions for a unique solution are provided. We shall proceed with the derivation and computation.\n\nThe objective is to compute the change in the atomization energy of the dinitrogen molecule ($\\mathrm{N_2}$) when improving the basis set from correlation-consistent polarized valence triple-zeta (cc-pVTZ) to correlation-consistent polarized core-valence triple-zeta (cc-pCVTZ), and to isolate the contribution of core-electron correlation to this change.\n\nLet us establish a formal notation. The total electronic energy for a given species ($S$), correlation treatment ($M$), and basis set ($B$) is denoted as $E(S, M, B)$, where:\n- Species $S \\in \\{\\mathrm{N}, \\mathrm{N_2}\\}$ for the nitrogen atom and molecule, respectively.\n- Correlation treatment $M \\in \\{\\text{AE, FC}\\}$, for all-electron and frozen-core calculations.\n- Basis set $B \\in \\{\\text{VTZ, CVTZ}\\}$, for cc-pVTZ and cc-pCVTZ.\n\nThe atomization energy, $E_{\\mathrm{atom}}$, is defined as the energy required to separate the molecule into its constituent atoms. For the diatomic molecule $\\mathrm{N_2}$, this is given by:\n$$E_{\\mathrm{atom}}(M, B) = 2 \\times E(\\mathrm{N}, M, B) - E(\\mathrm{N_2}, M, B)$$\nAll energies are initially in Hartree atomic units ($E_h$). The conversion factor to kilojoules per mole is given as $C = 2625.49962\\,\\mathrm{kJ/mol}$ per $1\\,E_h$.\n\nThe principal quantities to be calculated for each test case are:\n1. The change in all-electron atomization energy, $\\Delta E_{\\mathrm{atom, AE}}$, when transitioning from the VTZ to the CVTZ basis set. This is the first required value for each case, let us call it $x$.\n$$x = [E_{\\mathrm{atom}}(\\mathrm{AE, CVTZ}) - E_{\\mathrm{atom}}(\\mathrm{AE, VTZ})] \\times C$$\n2. The contribution to this change from core correlation effects, $\\Delta E_{\\mathrm{core}}$. This is estimated by subtracting a similar change computed under the frozen-core approximation from the all-electron change. This is the second required value, let us call it $y$.\n$$y = [\\Delta E_{\\mathrm{atom, AE}} - \\Delta E_{\\mathrm{atom, FC}}] \\times C$$\nwhere $\\Delta E_{\\mathrm{atom, FC}}$ is the change in frozen-core atomization energy:\n$$\\Delta E_{\\mathrm{atom, FC}} = E_{\\mathrm{atom}}(\\mathrm{FC, CVTZ}) - E_{\\mathrm{atom}}(\\mathrm{FC, VTZ})$$\n\nWe will now apply this procedure to each test case provided.\n\n**Test Case 1**\n\nData ($E_h$):\n- $E(\\mathrm{N}, \\mathrm{AE, VTZ}) = -54.589200$\n- $E(\\mathrm{N_2}, \\mathrm{AE, VTZ}) = -109.542600$\n- $E(\\mathrm{N}, \\mathrm{AE, CVTZ}) = -54.589550$\n- $E(\\mathrm{N_2}, \\mathrm{AE, CVTZ}) = -109.545200$\n- $E(\\mathrm{N}, \\mathrm{FC, VTZ}) = -54.570000$\n- $E(\\mathrm{N_2}, \\mathrm{FC, VTZ}) = -109.510000$\n- $E(\\mathrm{N}, \\mathrm{FC, CVTZ}) = -54.570020$\n- $E(\\mathrm{N_2}, \\mathrm{FC, CVTZ}) = -109.510040$\n\nStep 1: All-electron atomization energies.\n$E_{\\mathrm{atom}}(\\mathrm{AE, VTZ}) = 2(-54.589200) - (-109.542600) = 0.364200\\,E_h$\n$E_{\\mathrm{atom}}(\\mathrm{AE, CVTZ}) = 2(-54.589550) - (-109.545200) = 0.366100\\,E_h$\nChange: $\\Delta E_{\\mathrm{atom, AE}} = 0.366100 - 0.364200 = 0.001900\\,E_h$\nIn $\\mathrm{kJ/mol}$: $x_1 = 0.001900 \\times 2625.49962 \\approx 4.988\\,\\mathrm{kJ/mol}$.\n\nStep 2: Frozen-core atomization energies.\n$E_{\\mathrm{atom}}(\\mathrm{FC, VTZ}) = 2(-54.570000) - (-109.510000) = 0.370000\\,E_h$\n$E_{\\mathrm{atom}}(\\mathrm{FC, CVTZ}) = 2(-54.570020) - (-109.510040) = 0.370000\\,E_h$\nChange: $\\Delta E_{\\mathrm{atom, FC}} = 0.370000 - 0.370000 = 0.000000\\,E_h$\n\nStep 3: Core correlation contribution.\n$\\Delta E_{\\mathrm{core}} = \\Delta E_{\\mathrm{atom, AE}} - \\Delta E_{\\mathrm{atom, FC}} = 0.001900 - 0.000000 = 0.001900\\,E_h$\nIn $\\mathrm{kJ/mol}$: $y_1 = 0.001900 \\times 2625.49962 \\approx 4.988\\,\\mathrm{kJ/mol}$.\n\n**Test Case 2**\n\nData ($E_h$):\n- $E(\\mathrm{N}, \\mathrm{AE, VTZ}) = -54.600000$\n- $E(\\mathrm{N_2}, \\mathrm{AE, VTZ}) = -109.560000$\n- $E(\\mathrm{N}, \\mathrm{AE, CVTZ}) = -54.600000$\n- $E(\\mathrm{N_2}, \\mathrm{AE, CVTZ}) = -109.560000$\n- $E(\\mathrm{N}, \\mathrm{FC, VTZ}) = -54.580000$\n- $E(\\mathrm{N_2}, \\mathrm{FC, VTZ}) = -109.530000$\n- $E(\\mathrm{N}, \\mathrm{FC, CVTZ}) = -54.580000$\n- $E(\\mathrm{N_2}, \\mathrm{FC, CVTZ}) = -109.530000$\n\nStep 1: All-electron atomization energies.\n$E_{\\mathrm{atom}}(\\mathrm{AE, VTZ}) = 2(-54.600000) - (-109.560000) = 0.360000\\,E_h$\n$E_{\\mathrm{atom}}(\\mathrm{AE, CVTZ}) = 2(-54.600000) - (-109.560000) = 0.360000\\,E_h$\nChange: $\\Delta E_{\\mathrm{atom, AE}} = 0.360000 - 0.360000 = 0.000000\\,E_h$\nIn $\\mathrm{kJ/mol}$: $x_2 = 0.000000 \\times 2625.49962 \\approx 0.000\\,\\mathrm{kJ/mol}$.\n\nStep 2: Frozen-core atomization energies.\n$E_{\\mathrm{atom}}(\\mathrm{FC, VTZ}) = 2(-54.580000) - (-109.530000) = 0.370000\\,E_h$\n$E_{\\mathrm{atom}}(\\mathrm{FC, CVTZ}) = 2(-54.580000) - (-109.530000) = 0.370000\\,E_h$\nChange: $\\Delta E_{\\mathrm{atom, FC}} = 0.370000 - 0.370000 = 0.000000\\,E_h$\n\nStep 3: Core correlation contribution.\n$\\Delta E_{\\mathrm{core}} = \\Delta E_{\\mathrm{atom, AE}} - \\Delta E_{\\mathrm{atom, FC}} = 0.000000 - 0.000000 = 0.000000\\,E_h$\nIn $\\mathrm{kJ/mol}$: $y_2 = 0.000000 \\times 2625.49962 \\approx 0.000\\,\\mathrm{kJ/mol}$.\n\n**Test Case 3**\n\nData ($E_h$):\n- $E(\\mathrm{N}, \\mathrm{AE, VTZ}) = -54.590000$\n- $E(\\mathrm{N_2}, \\mathrm{AE, VTZ}) = -109.543000$\n- $E(\\mathrm{N}, \\mathrm{AE, CVTZ}) = -54.591000$\n- $E(\\mathrm{N_2}, \\mathrm{AE, CVTZ}) = -109.543500$\n- $E(\\mathrm{N}, \\mathrm{FC, VTZ}) = -54.572000$\n- $E(\\mathrm{N_2}, \\mathrm{FC, VTZ}) = -109.512000$\n- $E(\\mathrm{N}, \\mathrm{FC, CVTZ}) = -54.572000$\n- $E(\\mathrm{N_2}, \\mathrm{FC, CVTZ}) = -109.512000$\n\nStep 1: All-electron atomization energies.\n$E_{\\mathrm{atom}}(\\mathrm{AE, VTZ}) = 2(-54.590000) - (-109.543000) = 0.363000\\,E_h$\n$E_{\\mathrm{atom}}(\\mathrm{AE, CVTZ}) = 2(-54.591000) - (-109.543500) = 0.361500\\,E_h$\nChange: $\\Delta E_{\\mathrm{atom, AE}} = 0.361500 - 0.363000 = -0.001500\\,E_h$\nIn $\\mathrm{kJ/mol}$: $x_3 = -0.001500 \\times 2625.49962 \\approx -3.938\\,\\mathrm{kJ/mol}$.\n\nStep 2: Frozen-core atomization energies.\n$E_{\\mathrm{atom}}(\\mathrm{FC, VTZ}) = 2(-54.572000) - (-109.512000) = 0.368000\\,E_h$\n$E_{\\mathrm{atom}}(\\mathrm{FC, CVTZ}) = 2(-54.572000) - (-109.512000) = 0.368000\\,E_h$\nChange: $\\Delta E_{\\mathrm{atom, FC}} = 0.368000 - 0.368000 = 0.000000\\,E_h$\n\nStep 3: Core correlation contribution.\n$\\Delta E_{\\mathrm{core}} = \\Delta E_{\\mathrm{atom, AE}} - \\Delta E_{\\mathrm{atom, FC}} = -0.001500 - 0.000000 = -0.001500\\,E_h$\nIn $\\mathrm{kJ/mol}$: $y_3 = -0.001500 \\times 2625.49962 \\approx -3.938\\,\\mathrm{kJ/mol}$.\n\nSummary of results to be generated by the program:\n- Case 1: $x_1 \\approx 4.988$, $y_1 \\approx 4.988$\n- Case 2: $x_2 \\approx 0.000$, $y_2 \\approx 0.000$\n- Case 3: $x_3 \\approx -3.938$, $y_3 \\approx -3.938$\n\nThe implementation will follow these calculations precisely.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes changes in N2 atomization energy and attributes them to core\n    correlation effects based on provided quantum chemistry energy data.\n    \"\"\"\n    # Conversion factor from Hartree to kJ/mol.\n    HARTREE_TO_KJ_PER_MOL = 2625.49962\n\n    # Test suite: each tuple contains 8 energy values in Hartrees for a case.\n    # Order: (E_N_AE_VTZ, E_N2_AE_VTZ, E_N_AE_CVTZ, E_N2_AE_CVTZ,\n    #         E_N_FC_VTZ, E_N2_FC_VTZ, E_N_FC_CVTZ, E_N2_FC_CVTZ)\n    test_cases = [\n        # Test case 1 (realistic cc-pCVTZ increment)\n        (-54.589200, -109.542600, -54.589550, -109.545200,\n         -54.570000, -109.510000, -54.570020, -109.510040),\n        \n        # Test case 2 (boundary: no change)\n        (-54.600000, -109.560000, -54.600000, -109.560000,\n         -54.580000, -109.530000, -54.580000, -109.530000),\n\n        # Test case 3 (edge: slight negative change)\n        (-54.590000, -109.543000, -54.591000, -109.543500,\n         -54.572000, -109.512000, -54.572000, -109.512000),\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        e_n_ae_vtz, e_n2_ae_vtz, e_n_ae_cvtz, e_n2_ae_cvtz, \\\n        e_n_fc_vtz, e_n2_fc_vtz, e_n_fc_cvtz, e_n2_fc_cvtz = case\n\n        # --- All-electron calculations ---\n        # Atomization energy for all-electron, cc-pVTZ\n        e_atom_ae_vtz = 2 * e_n_ae_vtz - e_n2_ae_vtz\n        # Atomization energy for all-electron, cc-pCVTZ\n        e_atom_ae_cvtz = 2 * e_n_ae_cvtz - e_n2_ae_cvtz\n        # Change in all-electron atomization energy (in Hartrees)\n        delta_e_atom_ae = e_atom_ae_cvtz - e_atom_ae_vtz\n\n        # --- Frozen-core calculations ---\n        # Atomization energy for frozen-core, cc-pVTZ\n        e_atom_fc_vtz = 2 * e_n_fc_vtz - e_n2_fc_vtz\n        # Atomization energy for frozen-core, cc-pCVTZ\n        e_atom_fc_cvtz = 2 * e_n_fc_cvtz - e_n2_fc_cvtz\n        # Change in frozen-core atomization energy (in Hartrees)\n        delta_e_atom_fc = e_atom_fc_cvtz - e_atom_fc_vtz\n\n        # --- Core correlation contribution ---\n        # Change attributed to core correlation (in Hartrees)\n        delta_e_core = delta_e_atom_ae - delta_e_atom_fc\n\n        # --- Convert to kJ/mol and store results ---\n        # First required value: change in all-electron atomization energy\n        x_val = delta_e_atom_ae * HARTREE_TO_KJ_PER_MOL\n        # Second required value: portion attributed to core correlation\n        y_val = delta_e_core * HARTREE_TO_KJ_PER_MOL\n        \n        # Append formatted strings to ensure three decimal places\n        results.append(f\"{x_val:.3f}\")\n        results.append(f\"{y_val:.3f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "2766320"}, {"introduction": "Assembling a protocol for chemical accuracy—often defined as better than $1 \\text{ kcal mol}^{-1}$—requires more than just applying a single formula; it demands strategic thinking. This final practice moves you from calculation to computational design, challenging you to construct a cost-effective protocol for achieving high accuracy. You will learn to leverage the different convergence behaviors of the Hartree-Fock ($E_{\\text{HF}}$) and correlation energy components ($E_{\\text{corr}}^{\\text{CCSD}}$, $E_{(T)}$) to create an optimal, multi-level extrapolation scheme. [@problem_id:2880582]", "problem": "You are tasked with proposing a cost-effective, black-box protocol to obtain reaction energies with better than $1$ $\\mathrm{kcal}\\,\\mathrm{mol}^{-1}$ accuracy for closed-shell main-group reactions where static correlation is negligible and valence correlation dominates. You have access to the correlation-consistent basis set family cc-pV$n$Z (and their augmented variants) with cardinal numbers $n \\equiv L \\in \\{3,4,5\\}$. The electronic structure method is Coupled-Cluster with Singles, Doubles, and perturbative Triples (CCSD(T)). You must use a two-point complete basis set strategy that separates the energy into well-defined components and employs $(4,5)$ extrapolation for the correlation component and $(3,4)$ extrapolation for the $(T)$ component, with physically justified exponents.\n\nYour protocol must be justified from first principles and well-tested facts that are appropriate to correlation-consistent basis sets: (i) the Hartree–Fock (HF) mean-field energy converges faster than any power law with respect to $L$ in systematic basis set sequences; (ii) the leading basis set incompleteness error in the valence electron correlation energy for correlation-consistent basis sets decays approximately as a power law in $L$ due to the electron–electron cusp and the partial-wave expansion of the interelectronic interaction; (iii) reaction energies benefit from cancellation of residual basis set errors when all species are treated consistently.\n\nSelect the single option that lays out a protocol most likely to achieve the target accuracy at the lowest reasonable computational cost while adhering to the required $(4,5)$ correlation and $(3,4)$ $(T)$ extrapolation pattern and using justified exponents.\n\nA. Partition $E_{\\mathrm{tot}}$ into $E_{\\mathrm{HF}} + E_{\\mathrm{corr}}^{\\mathrm{CCSD}} + E_{(T)}$. Compute $E_{\\mathrm{HF}}$ at $L=5$ (frozen core) without extrapolation. Extrapolate the valence $E_{\\mathrm{corr}}^{\\mathrm{CCSD}}$ from $L=4,5$ using an inverse-cubic power law in $L$. Extrapolate $E_{(T)}$ from $L=3,4$ using an inverse-cubic power law in $L$. Use aug-cc-pV$n$Z for anions, Rydberg states, and strong hydrogen bonding; otherwise cc-pV$n$Z. Add scalar relativistic and core–valence corrections as small additivity terms evaluated at a moderate level, e.g., CCSD(T)/cc-pCVTZ with a second-order Douglas–Kroll–Hess Hamiltonian for scalar relativistic effects, and correlate $(n-1)s(n-1)p$ subvalence where applicable.\n\nB. Extrapolate the total CCSD(T) energy $E_{\\mathrm{tot}}$ as a single quantity from $L=4,5$ using an exponential form in $L$; do not separate HF, CCSD correlation, and $(T)$ contributions. Omit core–valence and scalar relativistic corrections, arguing that error cancellation in reaction energies suffices with large basis sets.\n\nC. Partition $E_{\\mathrm{tot}}$ into mean-field and correlation, but extrapolate $E_{\\mathrm{corr}}^{\\mathrm{CCSD}}$ from $L=4,5$ with an inverse-quartic power law in $L$, extrapolate $E_{(T)}$ from $L=3,4$ with an inverse-quartic power law in $L$, and compute $E_{\\mathrm{HF}}$ only at $L=3$ without extrapolation, relying on error cancellation.\n\nD. Use $E_{\\mathrm{HF}}$ extrapolated from $L=4,5$ with an inverse-cubic form, extrapolate $E_{\\mathrm{corr}}^{\\mathrm{CCSD}}$ from $L=3,4$ with an inverse-cubic form, and extrapolate $E_{(T)}$ from $L=4,5$ with an inverse-$L^{3.5}$ form. Neglect augmentation for anions to save cost, and omit scalar relativistic and core–valence corrections on the grounds that they are small.\n\nChoose the best option and be prepared to defend it from first principles appropriate to correlation-consistent basis sets and standard many-electron theory, including the choice of exponents for the $(4,5)$ correlation extrapolation and $(3,4)$ $(T)$ extrapolation and any small additive corrections needed to reach sub-kcal accuracy.", "solution": "The problem statement requires the formulation of a high-accuracy computational protocol for reaction energies, targeting an accuracy better than $1$ $\\mathrm{kcal}\\,\\mathrm{mol}^{-1}$. The protocol must be based on the CCSD(T) method, use the correlation-consistent basis set family up to $L=5$, and employ a specific two-point complete basis set (CBS) extrapolation strategy. The validity of the protocol is to be judged against fundamental principles of many-electron theory and basis set convergence.\n\nFirst, a validation of the problem statement is in order.\nThe givens are:\n*   **Method:** Coupled-Cluster with Singles, Doubles, and perturbative Triples, CCSD(T).\n*   **Target:** Reaction energies for closed-shell main-group species with negligible static correlation.\n*   **Accuracy Target:** Better than $1$ $\\mathrm{kcal}\\,\\mathrm{mol}^{-1}$.\n*   **Basis Sets:** Correlation-consistent family $\\mathrm{cc}$-$\\mathrm{pV}n\\mathrm{Z}$ (and augmented versions) for cardinal numbers $n \\equiv L \\in \\{3,4,5\\}$.\n*   **Extrapolation Mandate:** A two-point CBS scheme that separates energy components, using $(L_1, L_2) = (4,5)$ for the correlation component and $(L_1, L_2) = (3,4)$ for the perturbative triples, $(T)$, component.\n*   **Theoretical axioms provided:** (i) Hartree–Fock (HF) energy converges faster than any power law; (ii) Valence correlation energy incompleteness error decays as a power law in $L$; (iii) Error cancellation benefits reaction energies.\n\nThe problem is scientifically grounded, well-posed, and objective. It deals with established methods ($\\mathrm{CCSD(T)}$) and concepts (CBS extrapolation) in quantum chemistry. The axioms provided are correct statements about basis set convergence. The constraints are specific and do not contain contradictions. The problem is therefore valid. I will proceed with the analysis.\n\nA robust protocol for achieving sub-$\\mathrm{kcal}\\,\\mathrm{mol}^{-1}$ accuracy must treat the different components of the total electronic energy according to their distinct basis set convergence properties. The total CCSD(T) energy, $E_{\\mathrm{tot}}^{\\mathrm{CCSD(T)}}$, is partitioned as:\n$$E_{\\mathrm{tot}}^{\\mathrm{CCSD(T)}} = E_{\\mathrm{HF}} + E_{\\mathrm{corr}}^{\\mathrm{CCSD}} + E_{(T)}$$\nwhere $E_{\\mathrm{HF}}$ is the Hartree-Fock energy, $E_{\\mathrm{corr}}^{\\mathrm{CCSD}}$ is the correlation energy from the CCSD calculation, and $E_{(T)}$ is the perturbative triples correction.\n\n1.  **Hartree-Fock Energy ($E_{\\mathrm{HF}}$):** As stated in the problem, the HF energy converges very rapidly with the basis set cardinal number $L$. Its convergence is best described by an exponential function, $E_{\\mathrm{HF}}(L) \\approx E_{\\mathrm{HF}}^{\\mathrm{CBS}} + A \\exp(-B L)$. Applying a power-law extrapolation scheme, such as $E(L) = E^{\\mathrm{CBS}} + C L^{-X}$, is fundamentally incorrect for the HF energy. The most reliable and simple procedure is to take the HF energy computed with the largest available basis set as the best estimate of the CBS value. In this problem, that corresponds to $E_{\\mathrm{HF}} \\approx E_{\\mathrm{HF}}(\\mathrm{cc-pV5Z})$. The residual error is typically negligible for reaction energies.\n\n2.  **CCSD Correlation Energy ($E_{\\mathrm{corr}}^{\\mathrm{CCSD}}$):** The convergence of the correlation energy is dominated by the difficulty of describing the electron-electron cusp. Theoretical analysis based on the partial-wave expansion of the interelectronic interaction shows that for basis sets including functions up to angular momentum $L$, the truncation error in the correlation energy for a singlet electron pair diminishes as $L^{-3}$. Therefore, the energy can be modeled as $E_{\\mathrm{corr}}(L) \\approx E_{\\mathrm{corr}}^{\\mathrm{CBS}} + A L^{-3}$. This gives rise to the standard two-point extrapolation formula for points $(L_1, L_2)$:\n    $$E_{\\mathrm{corr}}^{\\mathrm{CBS}} = \\frac{L_2^3 E_{\\mathrm{corr}}(L_2) - L_1^3 E_{\\mathrm{corr}}(L_1)}{L_2^3 - L_1^3}$$\n    The problem specifies a $(4,5)$ extrapolation for this component. Using the inverse-cubic power law is thus the most physically justified approach.\n\n3.  **Perturbative Triples Correction ($E_{(T)}$):** The basis set convergence of the $(T)$ correction is known to be faster than that of the CCSD correlation energy. While the exact asymptotic form is not as cleanly derived as for second-order correlation, empirical evidence overwhelmingly suggests a convergence rate of $L^{-X}$ with an exponent $X \\geq 3$. Using $X=3$ is a common, conservative choice found in established protocols like the Feller-Peterson-Dixon (FPD) methods, though higher exponents are also used. The problem mandates a $(3,4)$ extrapolation, which is a cost-saving measure to avoid the computationally demanding $E_{(T)}$ calculation with an $L=5$ basis set. Applying the $L^{-3}$ extrapolation to the $(3,4)$ data pair is a reasonable and defensible strategy.\n\n4.  **Additional Corrections:** To reliably achieve sub-$\\mathrm{kcal}\\,\\mathrm{mol}^{-1}$ accuracy, several smaller physical effects must be accounted for.\n    *   **Core-Valence Correlation ($\\Delta E_{\\mathrm{CV}}$):** The frozen-core approximation is an important source of error. This correction requires calculations with basis sets designed to correlate core electrons (e.g., $\\mathrm{cc}$-$\\mathrm{pCV}n\\mathrm{Z}$).\n    *   **Scalar Relativistic Effects ($\\Delta E_{\\mathrm{rel}}$):** For atoms beyond the first row, relativistic effects are not negligible. Scalar relativistic effects are typically computed using a specialized Hamiltonian, such as the second-order Douglas-Kroll-Hess (DKH2) Hamiltonian.\n    These are typically computed at a single, moderate level of theory and added to the final valence energy, assuming additivity.\n\n5.  **Basis Set Augmentation:** For systems with diffuse electron density, such as anions, or for interactions dominated by long-range electrostatics or dispersion, like hydrogen bonding, standard basis sets are inadequate. The addition of diffuse functions, creating augmented basis sets ($\\mathrm{aug}$-$\\mathrm{cc}$-$\\mathrm{pV}n\\mathrm{Z}$), is mandatory.\n\nWith these principles established, I will evaluate each option.\n\n**A.** This option proposes to partition the energy as $E_{\\mathrm{HF}} + E_{\\mathrm{corr}}^{\\mathrm{CCSD}} + E_{(T)}$. It uses $E_{\\mathrm{HF}}$ at $L=5$ without extrapolation, which is correct. It extrapolates valence $E_{\\mathrm{corr}}^{\\mathrm{CCSD}}$ from $L=4,5$ using an inverse-cubic law, which is correct and abides by the problem's constraints. It extrapolates $E_{(T)}$ from $L=3,4$ using an inverse-cubic law, which is a reasonable choice and follows the specified cost-saving $(3,4)$ pattern. It correctly mandates the use of augmented basis sets for anions and other relevant cases. Finally, it includes the essential scalar relativistic and core-valence corrections computed at an appropriate level. This protocol is theoretically sound, complete, and adheres to all requirements. **Correct**.\n\n**B.** This option proposes to extrapolate the total $E_{\\mathrm{tot}}$ as a single quantity using an exponential form. This is a severe theoretical flaw. The Hartree-Fock and correlation energies have fundamentally different convergence behaviors (exponential versus power-law), and they cannot be correctly extrapolated using a single functional form. Furthermore, this violates the mandate to separate components and use different basis pairs for different parts. The omission of core-valence and scalar relativistic corrections is a critical oversight for achieving the target accuracy. This protocol is unsound. **Incorrect**.\n\n**C.** This option computes $E_{\\mathrm{HF}}$ at $L=3$. This is a poor choice, as it discards the more accurate results available from $L=4$ and $L=5$ calculations, introducing unnecessary error. It proposes an inverse-quartic ($L^{-4}$) extrapolation for $E_{\\mathrm{corr}}^{\\mathrm{CCSD}}$. While some components of correlation may converge faster, the leading error term for singlet pairs scales as $L^{-3}$, making this choice less physically justified than the inverse-cubic law. The protocol also omits any mention of core-valence or relativistic corrections. This protocol is suboptimal and theoretically questionable. **Incorrect**.\n\n**D.** This option proposes extrapolating $E_{\\mathrm{HF}}$ with an inverse-cubic form, which is theoretically incorrect. It also reverses the mandated extrapolation scheme, using $(3,4)$ for $E_{\\mathrm{corr}}^{\\mathrm{CCSD}}$ and $(4,5)$ for $E_{(T)}$, directly contradicting the problem description and leading to a computationally inefficient strategy. It dangerously suggests neglecting augmentation for anions, which would result in large, uncontrolled errors. The omission of scalar relativistic and core-valence corrections further compromises its ability to reach the target accuracy. This protocol is flawed in almost every aspect. **Incorrect**.\n\nBased on a meticulous analysis from first principles, Option A is the only one that describes a coherent, theoretically justified, and complete protocol capable of systematically achieving the desired accuracy while respecting all constraints of the problem.", "answer": "$$\\boxed{A}$$", "id": "2880582"}]}