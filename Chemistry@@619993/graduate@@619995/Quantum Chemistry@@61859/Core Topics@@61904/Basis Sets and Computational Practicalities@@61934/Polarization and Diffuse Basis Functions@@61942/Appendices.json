{"hands_on_practices": [{"introduction": "The first step in performing any reliable quantum chemical calculation is selecting an appropriate basis set. The Pople-style notation, such as $6-31+G(d,p)$, is a compact and widely-used language that precisely describes the set of mathematical functions used to build molecular orbitals. This exercise will build your fluency in this essential notation, enabling you to deconstruct a basis set label into its constituent parts and understand exactly how polarization and diffuse functions are specified for different atoms in a molecule [@problem_id:2796127].", "problem": "You are preparing an ab initio calculation on a main-group anion and a hydrogen-bonded complex using a Pople split-valence Gaussian-type orbital (GTO) basis set. The basis set label is $\\text{6-31+G(d,p)}$. Using the standard semantics of Pople-style notation, determine, relative to the parent $\\text{6-31G}$, exactly which additional shells are added on non-hydrogen (“heavy”) atoms and on hydrogens, and how many Gaussian primitives each such added shell contains. Base your reasoning on the following widely accepted facts: polarization functions are higher-angular-momentum GTOs than those minimally required by the occupied valence space on a given atom, diffuse functions are low-exponent GTOs of the same angular momentum as the occupied valence space that improve the radial flexibility for weakly bound electron density, the symbol “$+$” augments only heavy atoms with diffuse functions while “$++$” augments both heavy atoms and hydrogens, and in Pople sets each indicated polarization or diffuse “set” is implemented as a single uncontracted primitive per angular momentum per atom.\n\nWhich option is correct?\n\nA. Heavy atoms: add $1$ uncontracted $d$-type polarization primitive and add $1$ diffuse $s$ primitive and $1$ diffuse $p$ primitive; hydrogens: add $1$ uncontracted $p$-type polarization primitive; no diffuse primitives on hydrogens.\n\nB. Heavy atoms: add $1$ uncontracted $d$-type polarization primitive and add $1$ diffuse $s$ primitive only; hydrogens: add $1$ diffuse $s$ primitive; no polarization on hydrogens.\n\nC. Heavy atoms: add $1$ uncontracted $d$-type and $1$ uncontracted $p$-type polarization primitive and add $1$ diffuse $s$ primitive; hydrogens: add $1$ uncontracted $d$-type polarization primitive.\n\nD. Heavy atoms: add $1$ uncontracted $f$-type polarization primitive and add $1$ diffuse $s$ primitive and $1$ diffuse $p$ primitive; hydrogens: add $1$ uncontracted $p$-type polarization primitive and add $1$ diffuse $s$ primitive.\n\nE. Heavy atoms: add $1$ uncontracted $d$-type polarization primitive; hydrogens: add $1$ uncontracted $p$-type polarization primitive; diffuse augmentation on heavy atoms consists of $2$ primitives for $s$ and $2$ primitives for $p$ per atom; no diffuse primitives on hydrogens.", "solution": "The analysis of this problem must be conducted with rigorous adherence to established principles of theoretical chemistry. First, the problem statement itself must be validated for scientific soundness and logical consistency.\n\n**Problem Validation**\n\n**Step 1: Extract Givens**\n-   **System**: A main-group anion and a hydrogen-bonded complex.\n-   **Methodology**: Ab initio calculation.\n-   **Basis Set**: Pople split-valence Gaussian-type orbital (GTO) basis set, specifically labeled $\\text{6-31+G(d,p)}$.\n-   **Objective**: Determine the additional shells added to the parent $\\text{6-31G}$ basis set for both non-hydrogen (“heavy”) atoms and hydrogen atoms, including the number of Gaussian primitives per added shell.\n-   **Provided Definitions and Rules**:\n    1.  Polarization functions are higher-angular-momentum GTOs than those minimally required by the occupied valence space on a given atom.\n    2.  Diffuse functions are low-exponent GTOs of the same angular momentum as the occupied valence space.\n    3.  The symbol “$+$” augments only heavy atoms with diffuse functions.\n    4.  The symbol “$++$” augments both heavy atoms and hydrogens.\n    5.  In Pople sets, each indicated polarization or diffuse “set” is implemented as a single uncontracted primitive per angular momentum per atom.\n\n**Step 2: Validate Using Extracted Givens**\n-   **Scientific Grounding**: The problem is anchored in the standard notation and definitions used for Pople-style basis sets in quantum chemistry. The description of polarization and diffuse functions, and the meaning of symbols like `$+$` and `(d,p)`, are all consistent with universally accepted conventions in the field. The choice of systems (anion, H-bonded complex) correctly motivates the use of such functions to describe diffuse electron density and distortions in charge distribution. The problem is scientifically sound.\n-   **Well-Posedness**: The question is precise and unambiguous. Given the standard semantics of Pople notation, which are explicitly provided as rules, a unique and definite solution can be derived.\n-   **Objectivity**: The problem is stated in objective, technical language, free from any subjective or non-scientific content.\n\n**Step 3: Verdict and Action**\nThe problem statement is scientifically sound, well-posed, objective, and internally consistent. It contains all necessary information to derive a unique answer. Therefore, the problem is **valid**. I will proceed to the solution.\n\n**Derivation of the Solution**\n\nThe task is to deconstruct the basis set label $\\text{6-31+G(d,p)}$ and identify the functions added to the base $\\text{6-31G}$ set. We will analyze the components `+G` and `(d,p)` separately, as is standard practice.\n\n1.  **Analysis of Polarization Functions: `(d,p)`**\n    The notation `(d,p)` specifies the addition of polarization functions. The function listed before the comma applies to heavy (non-hydrogen) atoms, and the function listed after the comma applies to hydrogen atoms.\n    -   **Heavy Atoms**: The symbol `$d$` indicates the addition of $d$-type polarization functions. As stated in the provided rules, polarization functions possess a higher angular momentum ($L$) than the valence orbitals. For main-group heavy atoms (e.g., carbon, oxygen, nitrogen), the valence shell consists of $s$ ($L=0$) and $p$ ($L=1$) orbitals. The next higher angular momentum is $d$ ($L=2$). The problem states that each indicated set is a single uncontracted primitive. Thus, for each heavy atom, **one uncontracted $d$-type primitive shell** is added.\n    -   **Hydrogen Atoms**: The symbol `$p$` after the comma indicates the addition of $p$-type polarization functions to hydrogen atoms. For hydrogen, the valence shell consists of an $s$ orbital ($L=0$). The next higher angular momentum is $p$ ($L=1$). Therefore, for each hydrogen atom, **one uncontracted $p$-type primitive shell** is added.\n\n2.  **Analysis of Diffuse Functions: `+G`**\n    The `$+$` symbol, placed before the `G`, signifies the addition of diffuse functions.\n    -   **Heavy Atoms**: The problem explicitly states that a single `$+$` augments **only heavy atoms** with diffuse functions. It also states that diffuse functions have the same angular momentum as the occupied valence space. For main-group heavy atoms, the valence orbitals are of $s$ and $p$ type. Consequently, diffuse functions of both $s$-type and $p$-type must be added. As per the rule that each \"set\" is a single uncontracted primitive, this means adding **one uncontracted diffuse $s$-type primitive** and **one uncontracted diffuse $p$-type primitive** to each heavy atom.\n    -   **Hydrogen Atoms**: The problem specifies that the `$+$` symbol applies only to heavy atoms. To add diffuse functions to hydrogen, the `$++$` notation would be required. Therefore, **no diffuse functions are added to hydrogen atoms**.\n\n**Summary of Additions to $\\text{6-31G}$:**\n-   **On each heavy atom**: One uncontracted $d$-type polarization primitive, one uncontracted diffuse $s$-type primitive, and one uncontracted diffuse $p$-type primitive.\n-   **On each hydrogen atom**: One uncontracted $p$-type polarization primitive.\n\nWith this correct derivation, we now evaluate the provided options.\n\n**Option-by-Option Analysis**\n\n-   **A. Heavy atoms: add $1$ uncontracted $d$-type polarization primitive and add $1$ diffuse $s$ primitive and $1$ diffuse $p$ primitive; hydrogens: add $1$ uncontracted $p$-type polarization primitive; no diffuse primitives on hydrogens.**\n    This statement perfectly matches our derived conclusion. It correctly identifies the $d$-polarization on heavy atoms, the $p$-polarization on hydrogens, the addition of both $s$ and $p$ diffuse functions on heavy atoms, and the absence of diffuse functions on hydrogens. The counts of primitives ($1$ for each added shell type) are also correct according to the problem's premises.\n    **Verdict: Correct.**\n\n-   **B. Heavy atoms: add $1$ uncontracted $d$-type polarization primitive and add $1$ diffuse $s$ primitive only; hydrogens: add $1$ diffuse $s$ primitive; no polarization on hydrogens.**\n    This option is incorrect on multiple counts. For heavy atoms, it omits the necessary diffuse $p$ primitive. For hydrogens, it incorrectly adds a diffuse $s$ primitive (which would require `$++$`) and incorrectly omits the $p$-type polarization function indicated by `(d,p)`.\n    **Verdict: Incorrect.**\n\n-   **C. Heavy atoms: add $1$ uncontracted $d$-type and $1$ uncontracted $p$-type polarization primitive and add $1$ diffuse $s$ primitive; hydrogens: add $1$ uncontracted $d$-type polarization primitive.**\n    This option is fundamentally flawed. It incorrectly adds $p$-type polarization to heavy atoms. It omits the diffuse $p$-type functions for heavy atoms. It incorrectly adds $d$-type polarization to hydrogen atoms, which is not what `(d,p)` implies.\n    **Verdict: Incorrect.**\n\n-   **D. Heavy atoms: add $1$ uncontracted $f$-type polarization primitive and add $1$ diffuse $s$ primitive and $1$ diffuse $p$ primitive; hydrogens: add $1$ uncontracted $p$-type polarization primitive and add $1$ diffuse $s$ primitive.**\n    This option is incorrect. It specifies $f$-type polarization for heavy atoms, while the notation is `(d,p)`. It also incorrectly adds diffuse functions to hydrogen atoms.\n    **Verdict: Incorrect.**\n\n-   **E. Heavy atoms: add $1$ uncontracted $d$-type polarization primitive; hydrogens: add $1$ uncontracted $p$-type polarization primitive; diffuse augmentation on heavy atoms consists of $2$ primitives for $s$ and $2$ primitives for $p$ per atom; no diffuse primitives on hydrogens.**\n    This option correctly identifies the polarization functions and the absence of diffuse functions on hydrogen. However, it incorrectly describes the diffuse function augmentation on heavy atoms. The `$+$` notation adds a single set of diffuse functions (one primitive for $s$ and one for $p$), not two. A basis set with `$2$` diffuse primitives for each valence angular momentum would be designated differently and contradicts the premise that \"each indicated... diffuse 'set' is implemented as a single uncontracted primitive\".\n    **Verdict: Incorrect.**", "answer": "$$\\boxed{A}$$", "id": "2796127"}, {"introduction": "Beyond just identifying them, it is crucial to understand the physical impact of adding polarization and diffuse functions. Polarization functions, in particular, provide the necessary flexibility for the electron cloud to deform anisotropically in response to an electric field. This hands-on practice connects this abstract concept to a tangible physical observable—the static dipole polarizability—by using a simplified model derived from perturbation theory to quantify how the addition of a single $d$-type function enhances a molecule's response [@problem_id:2916115].", "problem": "Consider the change in the static dipole polarizability when a single polarization function of angular momentum $d$ is added on the oxygen center of a water molecule, modeled in a minimal way as follows. Work in Hartree atomic units (a.u.), where the elementary charge, the reduced Planck constant, and the electron mass are set to $1$, dipole moments have units of Bohr ($a_0$), energies have units of Hartree ($E_h$), and polarizabilities have units of $a_0^3$.\n\nStart from the definition that the static dipole polarizability tensor $\\alpha_{ij}$ is the second derivative of the electronic ground-state energy $E$ with respect to a homogeneous electric field component $\\mathcal{E}_i$, evaluated at zero field, i.e., $\\alpha_{ij} = -\\left.\\partial^2 E / \\partial \\mathcal{E}_i \\partial \\mathcal{E}_j\\right\\vert_{\\mathcal{E}=0}$. Use time-independent nondegenerate Rayleigh–Schrödinger perturbation theory and the standard sum-over-states representation as the fundamental base to derive a lowest-order expression for the change in a single tensor component $\\Delta \\alpha_{kk}$ along a fixed molecular axis $k$ when one new oxygen-centered virtual channel is introduced by adding a single, orthonormalized, cartesian $d$-type Gaussian-type orbital (GTO).\n\nAdopt the following physically motivated and self-consistent modeling assumptions to make the problem definite and numerically testable, without introducing any additional approximations beyond those listed here:\n- The change $\\Delta \\alpha_{kk}$ is dominated by mixing of a single occupied oxygen-centered lone-pair-like molecular orbital of $p$ character, $\\lvert p\\rangle$, with the newly available virtual configuration $\\lvert d\\rangle$ supported by the added $d$-type GTO. All other occupied–virtual channels are assumed unchanged and therefore cancel in the difference.\n- The energy gap between these two configurations is a positive constant $\\Delta E = E_d - E_p > 0$, specified per test case in units of $E_h$.\n- The transition dipole matrix element along the $k$ axis scales with the spatial extent of the added cartesian $d$-type GTO. Specifically, take the matrix element magnitude to be $\\mu_{pd}^{(k)} = S\\,\\zeta_d^{-1/2}$, where $\\zeta_d > 0$ is the Gaussian exponent of the $d$ function in units of $a_0^{-2}$, and $S > 0$ is a dimensionless amplitude capturing the effective $p$ character on oxygen along axis $k$ and angular coupling.\n- Assume orthonormality of the involved states and neglect relaxation beyond first order in the electric field, consistent with linear response.\n\nYour tasks are:\n1. Using only the stated fundamental base and modeling assumptions, derive an explicit expression for $\\Delta \\alpha_{kk}$ in terms of $\\Delta E$, $\\zeta_d$, and $S$, and determine its sign. Your derivation must be grounded in the first-order perturbed density viewpoint and the sum-over-states picture, and it must logically connect the scaling of $\\mu_{pd}^{(k)}$ to the observed dependence of $\\Delta \\alpha_{kk}$ on $\\zeta_d$ and $\\Delta E$.\n2. Implement a program that evaluates your derived expression for a small test suite of parameter triples $(\\Delta E, \\zeta_d, S)$ given below. Produce numerical values of $\\Delta \\alpha_{kk}$ in $a_0^3$ for each test case.\n3. The final output must be a single line containing a Python list literal with the results for the test cases, in the same order as listed, each value rounded to $6$ decimal places, e.g., $[x_1,x_2,x_3]$.\n4. You are required to express the results in units of $a_0^3$.\n\nTest suite (each triple is $(\\Delta E, \\zeta_d, S)$, with $\\Delta E$ in $E_h$, $\\zeta_d$ in $a_0^{-2}$, and $S$ dimensionless):\n- Case A (general happy path): $(0.6,\\;1.5,\\;1.1)$.\n- Case B (tight $d$ function, boundary-like behavior): $(1.5,\\;6.0,\\;1.1)$.\n- Case C (diffuse $d$ function, edge-case behavior): $(0.3,\\;0.5,\\;1.1)$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[r_1,r_2,r_3]$), where each $r_i$ is the computed $\\Delta \\alpha_{kk}$ in $a_0^3$ for the corresponding test case, rounded to $6$ decimal places.", "solution": "The problem statement is first subjected to a validation procedure.\n\nStep 1: Extracted Givens.\n- The definition of the static dipole polarizability tensor is $\\alpha_{ij} = -\\left.\\partial^2 E / \\partial \\mathcal{E}_i \\partial \\mathcal{E}_j\\right|_{\\mathcal{E}=0}$.\n- The theoretical foundation is time-independent nondegenerate Rayleigh–Schrödinger perturbation theory and the sum-over-states representation.\n- The quantity of interest is the change in a polarizability tensor component, $\\Delta \\alpha_{kk}$, upon adding a single cartesian $d$-type Gaussian-type orbital (GTO) on the oxygen atom of a water molecule.\n- Assumption 1: The change $\\Delta \\alpha_{kk}$ is solely due to the introduction of a new excitation channel between an occupied $p$-type molecular orbital (MO) $\\lvert p\\rangle$ and a new virtual $d$-type MO $\\lvert d\\rangle$.\n- Assumption 2: The energy gap between these two states is a positive constant $\\Delta E = E_d - E_p > 0$.\n- Assumption 3: The magnitude of the transition dipole matrix element between these states along axis $k$ is given by the model $\\mu_{pd}^{(k)} = S\\,\\zeta_d^{-1/2}$, where $\\zeta_d > 0$ is the GTO exponent and $S > 0$ is a dimensionless amplitude.\n- Assumption 4: The states are orthonormal, and electronic relaxation effects beyond first order are neglected.\n- All calculations are performed in Hartree atomic units, with polarizability expressed in units of $a_0^3$.\n- Test cases for $(\\Delta E, \\zeta_d, S)$: Case A $(0.6, 1.5, 1.1)$; Case B $(1.5, 6.0, 1.1)$; Case C $(0.3, 0.5, 1.1)$.\n\nStep 2: Validation.\nThe problem is scientifically grounded, being based on standard principles of quantum chemistry (perturbation theory, basis sets, molecular properties). Its simplifying assumptions, while aggressive, are physically motivated for creating a tractable model and are explicitly stated. The problem is well-posed, objective, and self-contained, providing all necessary information to derive a unique expression and compute the required numerical values. It does not violate any fundamental laws, nor is it trivial or ill-defined.\n\nStep 3: Verdict.\nThe problem is valid. A reasoned solution will be provided.\n\nThe derivation proceeds from the sum-over-states (SOS) expression for the static dipole polarizability, which is a direct consequence of second-order Rayleigh-Schrödinger perturbation theory applied to a molecule in a static electric field. For a diagonal component $\\alpha_{kk}$, the SOS expression is:\n$$\n\\alpha_{kk} = 2 \\sum_{n \\neq 0} \\frac{|\\langle \\Psi_0 | \\hat{\\mu}_k | \\Psi_n \\rangle|^2}{E_n - E_0}\n$$\nwhere $\\Psi_0$ is the ground electronic state with energy $E_0$, $\\{\\Psi_n\\}_{n \\neq 0}$ is the set of all excited electronic states with energies $E_n$, and $\\hat{\\mu}_k$ is the $k$-component of the electric dipole operator. All quantities are in atomic units.\n\nThe problem states that adding a new $d$-type GTO introduces a single new virtual channel involving an occupied orbital $\\lvert p \\rangle$ and the new virtual orbital $\\lvert d \\rangle$. All other occupied-virtual channels are assumed to be unaffected. Therefore, the change in polarizability, $\\Delta \\alpha_{kk}$, is simply the contribution of this single new term to the sum-over-states:\n$$\n\\Delta \\alpha_{kk} = 2 \\frac{|\\langle \\Psi_0 | \\hat{\\mu}_k | \\Psi_{p \\to d} \\rangle|^2}{E_{p \\to d} - E_0}\n$$\nwhere $\\Psi_{p \\to d}$ is the newly accessible excited state corresponding to the promotion of an electron from $\\lvert p \\rangle$ to $\\lvert d \\rangle$.\n\nWe now apply the modeling assumptions to evaluate this expression.\n1. The energy denominator, $E_{p \\to d} - E_0$, is the energy of the excitation. Within a molecular orbital picture, this is approximated by the difference in orbital energies. The problem provides this value directly as the energy gap $\\Delta E = E_d - E_p$.\n2. The numerator contains the squared transition dipole moment, $|\\langle \\Psi_0 | \\hat{\\mu}_k | \\Psi_{p \\to d} \\rangle|^2$. Within a single-particle model, this state-to-state matrix element is proportional to the orbital matrix element $\\mu_{pd}^{(k)} = \\langle p | \\hat{\\mu}_k | d \\rangle$. The problem provides a model for the magnitude of this effective transition moment as $|\\mu_{pd}^{(k)}| = S \\zeta_d^{-1/2}$.\n\nSubstituting these model parameters into the expression for $\\Delta \\alpha_{kk}$:\n$$\n\\Delta \\alpha_{kk} = 2 \\frac{(S \\zeta_d^{-1/2})^2}{\\Delta E}\n$$\nThis simplifies to the final expression:\n$$\n\\Delta \\alpha_{kk} = \\frac{2 S^2}{\\Delta E \\cdot \\zeta_d}\n$$\nThis is the explicit expression for $\\Delta \\alpha_{kk}$ in terms of the given parameters $\\Delta E$, $\\zeta_d$, and $S$.\n\nTo determine the sign of $\\Delta \\alpha_{kk}$, we note that $S > 0$ by definition, so $S^2 > 0$. The energy gap $\\Delta E > 0$ and the Gaussian exponent $\\zeta_d > 0$ are also given as positive constants. As all factors in the expression are positive, the resulting change in polarizability $\\Delta \\alpha_{kk}$ must be positive. This is physically correct: adding a polarization channel for the electron density to respond to an external field must increase the polarizability of the system.\n\nThe derivation also illuminates the dependence of $\\Delta \\alpha_{kk}$ on the model parameters. The inverse proportionality to the energy gap, $\\Delta \\alpha_{kk} \\propto 1/\\Delta E$, is characteristic of second-order perturbation theory: smaller energy gaps lead to stronger coupling and larger responses. The inverse proportionality to the exponent, $\\Delta \\alpha_{kk} \\propto 1/\\zeta_d$, arises from the scaling of the transition dipole moment. A smaller exponent $\\zeta_d$ signifies a more spatially diffuse GTO. A diffuse function has a larger spatial extent, which leads to a larger value for the matrix element of the position-dependent dipole operator, $\\mu_{pd}^{(k)}$. This larger transition moment, in turn, yields a greater contribution to the polarizability, consistent with the known fact that diffuse basis functions are crucial for accurately describing polarizabilities.\n\nThe problem is now reduced to a numerical calculation using the derived formula for the provided test cases.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the change in static dipole polarizability based on a derived\n    two-level model and provided test cases.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each tuple is (delta_E, zeta_d, S)\n    test_cases = [\n        (0.6, 1.5, 1.1),  # Case A: General happy path\n        (1.5, 6.0, 1.1),  # Case B: Tight d function, boundary-like behavior\n        (0.3, 0.5, 1.1),  # Case C: Diffuse d function, edge-case behavior\n    ]\n\n    results = []\n    for case in test_cases:\n        # Unpack parameters for the current case\n        delta_E, zeta_d, S = case\n\n        # The derived formula for the change in polarizability is:\n        # delta_alpha_kk = (2 * S^2) / (delta_E * zeta_d)\n        # All inputs are in Hartree atomic units, so the result is in the\n        # atomic unit of polarizability, which is a_0^3.\n        delta_alpha_kk = (2 * S**2) / (delta_E * zeta_d)\n\n        # Append the result formatted to 6 decimal places as required.\n        results.append(f\"{delta_alpha_kk:.6f}\")\n\n    # Final print statement in the exact required format: [r1,r2,r3]\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "2916115"}, {"introduction": "Accurately modeling intermolecular interactions, especially those involving charged or highly polar species, presents unique challenges that go beyond single-molecule calculations. This exercise delves into the practical consequences of basis set choice for noncovalent complexes, where errors from basis set incompleteness and Basis Set Superposition Error (BSSE) can be significant. By analyzing a set of hypothetical calculations on a halide-water complex, you will learn to use the Counterpoise correction scheme to diagnose and partition these errors, providing a clear demonstration of the vital role diffuse functions play in obtaining reliable interaction energies [@problem_id:2916061].", "problem": "You are given a supermolecular description of a halide–water complex and a set of absolute electronic energies computed with different basis sets, with and without diffuse augmentation. The target is to partition the interaction energy error into a component attributable to Basis Set Superposition Error (BSSE) and a component attributable to basis-set incompleteness (sometimes called Basis-Set Incompleteness Error), using the half-Counterpoise (half-CP) framework.\n\nStart from the following foundational facts and definitions, which are standard in quantum chemistry and follow from the variational principle and supermolecular energy definitions:\n- Let $E_{AB}^{AB}$ denote the electronic energy of the dimer computed in the dimer basis.\n- Let $E_{A}^{A}$ and $E_{B}^{B}$ denote the electronic energies of the monomers computed in their own monomer bases.\n- Let $E_{A}^{AB}$ and $E_{B}^{AB}$ denote the monomer energies computed in the presence of the partner’s basis functions as ghosts (the “dimer basis” with one ghost), which by the variational principle satisfy $E_{A}^{AB} \\le E_{A}^{A}$ and $E_{B}^{AB} \\le E_{B}^{B}$.\n- The raw (uncorrected) supermolecular interaction energy is \n$$\nI_{\\mathrm{raw}} \\equiv E_{AB}^{AB} - E_{A}^{A} - E_{B}^{B}.\n$$\n- The Counterpoise (CP) corrected interaction energy, following Boys–Bernardi Counterpoise, is\n$$\nI_{\\mathrm{CP}} \\equiv E_{AB}^{AB} - E_{A}^{AB} - E_{B}^{AB}.\n$$\n- The half-Counterpoise (half-CP) interaction energy is the average\n$$\nI_{1/2} \\equiv \\tfrac{1}{2}\\left(I_{\\mathrm{raw}} + I_{\\mathrm{CP}}\\right).\n$$\n- The CP shift (the standard estimator of Basis Set Superposition Error (BSSE)) is\n$$\n\\Delta_{\\mathrm{CP}} \\equiv \\left(E_{A}^{AB} - E_{A}^{A}\\right) + \\left(E_{B}^{AB} - E_{B}^{B}\\right),\n$$\nwhich satisfies $I_{\\mathrm{CP}} = I_{\\mathrm{raw}} - \\Delta_{\\mathrm{CP}}$.\n\nLet the reference (complete-basis) interaction energy be provided as $I_{\\mathrm{ref}}$, and define the half-CP interaction energy error as\n$$\n\\varepsilon_{1/2} \\equiv I_{1/2} - I_{\\mathrm{ref}}.\n$$\n\nYour tasks are:\n1) Using only the definitions above, algebraically express $\\varepsilon_{1/2}$ as the sum of two contributions, one that depends on $\\Delta_{\\mathrm{CP}}$ and one that depends only on $I_{\\mathrm{CP}} - I_{\\mathrm{ref}}$. Interpret these two terms as the “residual BSSE contribution in half-CP” and the “basis-set incompleteness contribution in half-CP,” respectively. Do not introduce any additional assumptions beyond the given definitions.\n2) Implement these expressions in a program that evaluates the two contributions and their sum for each test case.\n3) Convert all final reported quantities from hartree to kilojoules per mole using the factor $1\\,\\text{hartree} = 2625.49962\\,\\text{kJ}\\,\\text{mol}^{-1}$.\n4) Express all final numerical answers in $\\text{kJ}\\,\\text{mol}^{-1}$ rounded to six decimal places.\n\nUse the following test suite of parameter sets, each providing $\\left(E_{AB}^{AB}, E_{A}^{A}, E_{B}^{B}, E_{A}^{AB}, E_{B}^{AB}\\right)$ in hartree, together with a single common reference interaction energy $I_{\\mathrm{ref}}$ in hartree corresponding to the same complex geometry:\n\n- Test Case 1 (non-augmented, polarized, double-zeta-like):\n  - $E_{AB}^{AB} = -536.490000$\n  - $E_{A}^{A} = -460.180000$\n  - $E_{B}^{B} = -76.280000$\n  - $E_{A}^{AB} = -460.186000$\n  - $E_{B}^{AB} = -76.284000$\n- Test Case 2 (non-augmented, polarized, triple-zeta-like):\n  - $E_{AB}^{AB} = -536.526666$\n  - $E_{A}^{A} = -460.200000$\n  - $E_{B}^{B} = -76.300000$\n  - $E_{A}^{AB} = -460.205000$\n  - $E_{B}^{AB} = -76.302000$\n- Test Case 3 (diffuse-augmented, polarized, triple-zeta-like):\n  - $E_{AB}^{AB} = -536.542800$\n  - $E_{A}^{A} = -460.210000$\n  - $E_{B}^{B} = -76.310000$\n  - $E_{A}^{AB} = -460.211500$\n  - $E_{B}^{AB} = -76.310800$\n- Test Case 4 (diffuse-augmented, polarized, quadruple-zeta-like):\n  - $E_{AB}^{AB} = -536.550700$\n  - $E_{A}^{A} = -460.215000$\n  - $E_{B}^{B} = -76.315000$\n  - $E_{A}^{AB} = -460.215200$\n  - $E_{B}^{AB} = -76.315100$\n\nUse the same reference interaction energy for all cases:\n- $I_{\\mathrm{ref}} = -0.020500$ hartree.\n\nFor each test case, your program must compute and return a triple\n$[\\varepsilon_{1/2},\\ \\varepsilon_{\\mathrm{BSSE}}^{(1/2)},\\ \\varepsilon_{\\mathrm{inc}}^{(1/2)}]$,\neach entry expressed in $\\text{kJ}\\,\\text{mol}^{-1}$ and rounded to six decimal places, where $\\varepsilon_{1/2}$ is the total half-CP interaction energy error, $\\varepsilon_{\\mathrm{BSSE}}^{(1/2)}$ is the residual BSSE contribution in half-CP, and $\\varepsilon_{\\mathrm{inc}}^{(1/2)}$ is the basis-set incompleteness contribution in half-CP, such that\n$$\n\\varepsilon_{1/2} = \\varepsilon_{\\mathrm{BSSE}}^{(1/2)} + \\varepsilon_{\\mathrm{inc}}^{(1/2)}.\n$$\n\nFinal output format:\nYour program should produce a single line of output containing the results as a JSON-like list of lists, one inner list per test case, in the order given above. For example:\n`\"[[x11,x12,x13],[x21,x22,x23],[x31,x32,x33],[x41,x42,x43]]\"`\nwith each $x_{ij}$ in $\\text{kJ}\\,\\text{mol}^{-1}$ rounded to six decimal places, and no additional text.\n\nAngle units are not applicable. All energies provided are in hartree, and all requested outputs must be in $\\text{kJ}\\,\\text{mol}^{-1}$.", "solution": "The problem statement has been subjected to rigorous validation and is found to be scientifically sound, well-posed, and internally consistent. All provided definitions are standard within the field of quantum chemistry, and the numerical data are physically realistic and conform to the variational principle, where $E_{X}^{XY} \\le E_{X}^{X}$. We may therefore proceed with the solution.\n\nThe primary task is to decompose the total error of the half-Counterpoise (half-CP) interaction energy, $\\varepsilon_{1/2}$, into two physically meaningful components: a residual Basis Set Superposition Error (BSSE) contribution, $\\varepsilon_{\\mathrm{BSSE}}^{(1/2)}$, and a basis-set incompleteness contribution, $\\varepsilon_{\\mathrm{inc}}^{(1/2)}$. This decomposition must be derived algebraically from the provided foundational definitions.\n\nWe begin with the definition of the half-CP interaction energy error:\n$$\n\\varepsilon_{1/2} \\equiv I_{1/2} - I_{\\mathrm{ref}}\n$$\nThe half-CP interaction energy, $I_{1/2}$, is defined as the arithmetic mean of the raw and the fully Counterpoise-corrected interaction energies:\n$$\nI_{1/2} \\equiv \\frac{1}{2}\\left(I_{\\mathrm{raw}} + I_{\\mathrm{CP}}\\right)\n$$\nSubstituting this into the expression for $\\varepsilon_{1/2}$ gives:\n$$\n\\varepsilon_{1/2} = \\frac{1}{2}\\left(I_{\\mathrm{raw}} + I_{\\mathrm{CP}}\\right) - I_{\\mathrm{ref}}\n$$\nThe problem provides the relationship between the raw interaction energy, $I_{\\mathrm{raw}}$, the CP-corrected interaction energy, $I_{\\mathrm{CP}}$, and the CP shift, $\\Delta_{\\mathrm{CP}}$, as $I_{\\mathrm{CP}} = I_{\\mathrm{raw}} - \\Delta_{\\mathrm{CP}}$. We can rearrange this to express $I_{\\mathrm{raw}}$ in terms of $I_{\\mathrm{CP}}$ and $\\Delta_{\\mathrm{CP}}$:\n$$\nI_{\\mathrm{raw}} = I_{\\mathrm{CP}} + \\Delta_{\\mathrm{CP}}\n$$\nWe now substitute this expression for $I_{\\mathrm{raw}}$ into our equation for $\\varepsilon_{1/2}$:\n$$\n\\varepsilon_{1/2} = \\frac{1}{2}\\left((I_{\\mathrm{CP}} + \\Delta_{\\mathrm{CP}}) + I_{\\mathrm{CP}}\\right) - I_{\\mathrm{ref}}\n$$\nCombining terms inside the parenthesis yields:\n$$\n\\varepsilon_{1/2} = \\frac{1}{2}\\left(2I_{\\mathrm{CP}} + \\Delta_{\\mathrm{CP}}\\right) - I_{\\mathrm{ref}}\n$$\nDistributing the factor of $\\frac{1}{2}$ and rearranging the terms to isolate the desired dependencies, we obtain:\n$$\n\\varepsilon_{1/2} = I_{\\mathrm{CP}} + \\frac{1}{2}\\Delta_{\\mathrm{CP}} - I_{\\mathrm{ref}} = \\left(I_{\\mathrm{CP}} - I_{\\mathrm{ref}}\\right) + \\frac{1}{2}\\Delta_{\\mathrm{CP}}\n$$\nThis expression provides the required decomposition. We can now identify the two contributions.\n\nThe first term, $(I_{\\mathrm{CP}} - I_{\\mathrm{ref}})$, represents the deviation of the fully CP-corrected interaction energy from the exact, reference value. The CP correction is designed to eliminate the BSSE. Therefore, any remaining error in $I_{\\mathrm{CP}}$ is attributed to the intrinsic inadequacy, or incompleteness, of the chosen basis set. We define this as the basis-set incompleteness contribution:\n$$\n\\varepsilon_{\\mathrm{inc}}^{(1/2)} \\equiv I_{\\mathrm{CP}} - I_{\\mathrm{ref}}\n$$\nThe second term, $\\frac{1}{2}\\Delta_{\\mathrm{CP}}$, is exactly one half of the total CP correction, which is the standard estimator for the magnitude of the BSSE. The half-CP method, by its construction, corrects for only half of the estimated BSSE. It is therefore logical to interpret this second term as the residual BSSE that remains uncorrected in the half-CP scheme:\n$$\n\\varepsilon_{\\mathrm{BSSE}}^{(1/2)} \\equiv \\frac{1}{2}\\Delta_{\\mathrm{CP}}\n$$\nThe total half-CP error is the sum of these two components, $\\varepsilon_{1/2} = \\varepsilon_{\\mathrm{BSSE}}^{(1/2)} + \\varepsilon_{\\mathrm{inc}}^{(1/2)}$, as derived.\n\nThe computational procedure for each test case is as follows. Given the set of energies $\\left(E_{AB}^{AB}, E_{A}^{A}, E_{B}^{B}, E_{A}^{AB}, E_{B}^{AB}\\right)$ in hartree and the reference interaction energy $I_{\\mathrm{ref}}$ in hartree:\n1.  Calculate the CP shift, $\\Delta_{\\mathrm{CP}}$, in hartree:\n    $$\n    \\Delta_{\\mathrm{CP}} = (E_{A}^{AB} - E_{A}^{A}) + (E_{B}^{AB} - E_{B}^{B})\n    $$\n2.  Calculate the CP-corrected interaction energy, $I_{\\mathrm{CP}}$, in hartree:\n    $$\n    I_{\\mathrm{CP}} = E_{AB}^{AB} - E_{A}^{AB} - E_{B}^{AB}\n    $$\n3.  Calculate the two error components in hartree:\n    $$\n    \\varepsilon_{\\mathrm{BSSE}}^{(1/2)} = \\frac{1}{2}\\Delta_{\\mathrm{CP}}\n    $$\n    $$\n    \\varepsilon_{\\mathrm{inc}}^{(1/2)} = I_{\\mathrm{CP}} - I_{\\mathrm{ref}}\n    $$\n4.  Calculate the total half-CP error, $\\varepsilon_{1/2}$, in hartree as their sum:\n    $$\n    \\varepsilon_{1/2} = \\varepsilon_{\\mathrm{BSSE}}^{(1/2)} + \\varepsilon_{\\mathrm{inc}}^{(1/2)}\n    $$\n5.  Convert each of these three quantities from hartree to $\\text{kJ}\\,\\text{mol}^{-1}$ using the provided factor $1\\,\\text{hartree} = 2625.49962\\,\\text{kJ}\\,\\text{mol}^{-1}$.\n6.  Round the final results in $\\text{kJ}\\,\\text{mol}^{-1}$ to six decimal places.\n\nThis procedure will be implemented and applied to the four provided test cases.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes and partitions the half-CP interaction energy error for a series of\n    quantum chemical calculations on a halide-water complex.\n    \"\"\"\n\n    # Conversion factor from Hartree to kJ/mol as specified.\n    H_TO_KJ_MOL = 2625.49962\n\n    # Reference interaction energy in Hartree, common to all test cases.\n    I_ref_hartree = -0.020500\n\n    # Test cases: (E_AB_AB, E_A_A, E_B_B, E_A_AB, E_B_AB) in Hartree.\n    test_cases = [\n        # Test Case 1 (non-augmented, polarized, double-zeta-like)\n        (-536.490000, -460.180000, -76.280000, -460.186000, -76.284000),\n        # Test Case 2 (non-augmented, polarized, triple-zeta-like)\n        (-536.526666, -460.200000, -76.300000, -460.205000, -76.302000),\n        # Test Case 3 (diffuse-augmented, polarized, triple-zeta-like)\n        (-536.542800, -460.210000, -76.310000, -460.211500, -76.310800),\n        # Test Case 4 (diffuse-augmented, polarized, quadruple-zeta-like)\n        (-536.550700, -460.215000, -76.315000, -460.215200, -76.315100),\n    ]\n\n    all_results = []\n\n    for case in test_cases:\n        E_AB_AB, E_A_A, E_B_B, E_A_AB, E_B_AB = case\n\n        # 1. Calculate CP shift (Delta_CP) in Hartree.\n        # This is the standard estimator for the Basis Set Superposition Error (BSSE).\n        delta_cp_hartree = (E_A_AB - E_A_A) + (E_B_AB - E_B_B)\n\n        # 2. Calculate CP-corrected interaction energy (I_CP) in Hartree.\n        I_cp_hartree = E_AB_AB - E_A_AB - E_B_AB\n\n        # 3. Calculate the error components in Hartree based on the derivation.\n        # Residual BSSE contribution in half-CP scheme.\n        eps_bsse_half_cp_hartree = 0.5 * delta_cp_hartree\n        # Basis-set incompleteness contribution in half-CP scheme.\n        eps_inc_half_cp_hartree = I_cp_hartree - I_ref_hartree\n        # Total half-CP error, being the sum of the two components.\n        eps_half_cp_hartree = eps_bsse_half_cp_hartree + eps_inc_half_cp_hartree\n\n        # 4. Convert all quantities to kJ/mol.\n        eps_half_cp_kjmol = eps_half_cp_hartree * H_TO_KJ_MOL\n        eps_bsse_half_cp_kjmol = eps_bsse_half_cp_hartree * H_TO_KJ_MOL\n        eps_inc_half_cp_kjmol = eps_inc_half_cp_hartree * H_TO_KJ_MOL\n\n        # 5. Round to six decimal places as required.\n        result_triple = [\n            round(eps_half_cp_kjmol, 6),\n            round(eps_bsse_half_cp_kjmol, 6),\n            round(eps_inc_half_cp_kjmol, 6),\n        ]\n        \n        all_results.append(result_triple)\n\n    # 6. Format the output as a JSON-like string of a list of lists.\n    # The format requires no spaces and specific bracketing.\n    case_strings = [f\"[{res[0]},{res[1]},{res[2]}]\" for res in all_results]\n    final_output = f\"[{','.join(case_strings)}]\"\n    \n    # Print the final formatted string.\n    print(final_output)\n\nsolve()\n```", "id": "2916061"}]}