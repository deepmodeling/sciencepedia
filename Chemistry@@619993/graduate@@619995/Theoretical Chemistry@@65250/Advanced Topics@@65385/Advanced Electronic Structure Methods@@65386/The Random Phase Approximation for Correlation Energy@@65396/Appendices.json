{"hands_on_practices": [{"introduction": "To begin our hands-on exploration, we first tackle a problem that reveals a fundamental strength of the Random Phase Approximation. This exercise [@problem_id:2821013] contrasts RPA with second-order Møller-Plesset (MP2) theory for a model system with a tunable electronic gap, $\\Delta$. By analyzing the behavior as the gap closes ($\\Delta \\to 0$), you will see firsthand how RPA's infinite-order summation correctly handles situations where simple perturbation theory fails, providing a powerful motivation for its use in challenging electronic structure problems.", "problem": "Consider a minimal two-band insulating model with a single occupied valence band and a single empty conduction band separated by an energy gap $\\Delta>0$. Assume that the only optically active interband transition has energy $\\Delta$ and an effective density–response oscillator strength summarized by a positive constant $\\alpha>0$. The independent-particle density–density response function at zero temperature on the imaginary frequency axis is then given, by the Lehmann representation for a single interband transition, as\n$$\n\\chi_{0}(i\\omega)\\;=\\;-\\frac{\\alpha\\,\\Delta}{\\omega^{2}+\\Delta^{2}}\\,,\n$$\nwhere the minus sign reflects the fact that the electronic density responds oppositely to an external potential. Let the electron–electron interaction be modeled as a scalar coupling $v>0$ that is separable onto this single interband channel, and define the dimensionful effective coupling $g \\equiv v\\,\\alpha$.\n\nUsing the Adiabatic-Connection Fluctuation–Dissipation Theorem (ACFDT) as the fundamental starting point, and the Dyson equation for the interacting response within the Random Phase Approximation (RPA), you will:\n\n1) Derive the direct Møller–Plesset second order (MP2) correlation energy by expanding the ACFDT integrand to second order in $v$.\n2) Derive the RPA correlation energy by evaluating the ACFDT integral with the RPA interacting response.\n3) From your closed-form expressions, extract the small-gap behavior as $\\Delta\\to 0^{+}$ and explicitly determine how the MP2 correlation energy scales with $\\Delta$ and what finite limit, if any, the RPA correlation energy approaches.\n\nAssume that exchange (ladder) terms are neglected and that the system remains linearly stable for the couplings considered. Express your final results in terms of $g$ and $\\Delta$. Your final answer must consist of two entries presented as a single row: the leading small-$\\Delta$ expression for the MP2 correlation energy and the $\\Delta\\to 0^{+}$ limit of the RPA correlation energy. No numerical evaluation is required, and no rounding instructions apply. Do not include units in your final answer.", "solution": "The problem requires the derivation and analysis of the correlation energy for a simplified two-band model using two different approximations: Møller–Plesset second-order perturbation theory (MP2) and the Random Phase Approximation (RPA). The starting point for both derivations is the Adiabatic-Connection Fluctuation–Dissipation Theorem (ACFDT).\n\nThe givens are:\n- A two-band insulating model with energy gap $\\Delta > 0$.\n- The independent-particle density-density response function on the imaginary frequency axis: $\\chi_{0}(i\\omega) = -\\frac{\\alpha\\,\\Delta}{\\omega^{2}+\\Delta^{2}}$, with $\\alpha > 0$.\n- A scalar electron-electron interaction coupling $v > 0$.\n- The effective coupling strength $g \\equiv v\\alpha > 0$.\n\nThe ACFDT formula for the correlation energy $E_c$ in the RPA (which includes only direct ring diagrams) is given by an integral over imaginary frequency $\\omega$:\n$$\nE_c = \\frac{1}{2\\pi} \\int_{0}^{\\infty} d\\omega \\, \\left[ \\ln(1 - v\\chi_0(i\\omega)) + v\\chi_0(i\\omega) \\right]\n$$\nThis formula is for a single effective channel, as implied by the problem's scalar model. The correlation energy is negative, which is assured because for a repulsive interaction ($v>0$) and a physical response function ($\\chi_0<0$), the product $v\\chi_0$ is negative. Let $X = v\\chi_0 < 0$. The integrand is $\\ln(1-X)+X$. A Taylor expansion $\\ln(1-X) = -X - \\frac{X^2}{2} - \\frac{X^3}{3} - \\dots$ reveals the integrand is $-\\frac{X^2}{2} - \\frac{X^3}{3} - \\dots$, which is negative for small $X$. For any $X<0$, let $y=-X>0$. The function is $\\ln(1+y)-y$, which is always negative for $y>0$. Therefore, $E_c$ is correctly negative.\n\n1) Derivation of the direct MP2 correlation energy.\nThe MP2 correlation energy corresponds to the lowest-order (second-order) non-trivial term in the perturbation expansion of the correlation energy in powers of the interaction $v$. We expand the integrand of the ACFDT formula to order $v^2$:\n$$\n\\ln(1 - v\\chi_0(i\\omega)) + v\\chi_0(i\\omega) = \\left( -v\\chi_0(i\\omega) - \\frac{1}{2}(v\\chi_0(i\\omega))^2 - O(v^3) \\right) + v\\chi_0(i\\omega) = -\\frac{1}{2}v^2(\\chi_0(i\\omega))^2 + O(v^3)\n$$\nSubstituting this into the ACFDT formula gives the MP2 correlation energy:\n$$\nE_c^{(\\text{MP2})} = \\frac{1}{2\\pi} \\int_{0}^{\\infty} d\\omega \\left(-\\frac{1}{2}v^2(\\chi_0(i\\omega))^2\\right) = -\\frac{v^2}{4\\pi} \\int_{0}^{\\infty} (\\chi_0(i\\omega))^2 d\\omega\n$$\nNow, we substitute the given expression for $\\chi_0(i\\omega)$:\n$$\nE_c^{(\\text{MP2})} = -\\frac{v^2}{4\\pi} \\int_{0}^{\\infty} \\left(-\\frac{\\alpha\\,\\Delta}{\\omega^{2}+\\Delta^{2}}\\right)^2 d\\omega = -\\frac{v^2\\alpha^2\\Delta^2}{4\\pi} \\int_{0}^{\\infty} \\frac{1}{(\\omega^2+\\Delta^2)^2} d\\omega\n$$\nThe integral can be evaluated using a trigonometric substitution $\\omega = \\Delta \\tan\\theta$, $d\\omega = \\Delta \\sec^2\\theta d\\theta$:\n$$\n\\int_{0}^{\\infty} \\frac{d\\omega}{(\\omega^2+\\Delta^2)^2} = \\int_{0}^{\\pi/2} \\frac{\\Delta\\sec^2\\theta d\\theta}{(\\Delta^2\\tan^2\\theta+\\Delta^2)^2} = \\int_{0}^{\\pi/2} \\frac{\\Delta\\sec^2\\theta d\\theta}{(\\Delta^2\\sec^2\\theta)^2} = \\frac{1}{\\Delta^3} \\int_{0}^{\\pi/2} \\cos^2\\theta d\\theta\n$$\n$$\n= \\frac{1}{\\Delta^3} \\int_{0}^{\\pi/2} \\frac{1+\\cos(2\\theta)}{2} d\\theta = \\frac{1}{\\Delta^3} \\left[\\frac{\\theta}{2} + \\frac{\\sin(2\\theta)}{4}\\right]_{0}^{\\pi/2} = \\frac{1}{\\Delta^3}\\frac{\\pi}{4}\n$$\nSubstituting this result back and using $g = v\\alpha$:\n$$\nE_c^{(\\text{MP2})} = -\\frac{v^2\\alpha^2\\Delta^2}{4\\pi} \\left(\\frac{\\pi}{4\\Delta^3}\\right) = -\\frac{(v\\alpha)^2}{16\\Delta} = -\\frac{g^2}{16\\Delta}\n$$\n\n2) Derivation of the RPA correlation energy.\nFor the RPA correlation energy, we evaluate the full ACFDT integral without expansion.\n$$\nE_c^{(\\text{RPA})} = \\frac{1}{2\\pi} \\int_{0}^{\\infty} d\\omega \\, \\left[ \\ln\\left(1 - v\\left(-\\frac{\\alpha\\,\\Delta}{\\omega^{2}+\\Delta^{2}}\\right)\\right) + v\\left(-\\frac{\\alpha\\,\\Delta}{\\omega^{2}+\\Delta^{2}}\\right) \\right]\n$$\nUsing $g=v\\alpha$, the expression becomes:\n$$\nE_c^{(\\text{RPA})} = \\frac{1}{2\\pi} \\int_{0}^{\\infty} d\\omega \\, \\left[ \\ln\\left(1 + \\frac{g\\Delta}{\\omega^2+\\Delta^2}\\right) - \\frac{g\\Delta}{\\omega^2+\\Delta^2} \\right]\n$$\nThe integral is separated into two parts:\n$$\nE_c^{(\\text{RPA})} = \\frac{1}{2\\pi} \\int_{0}^{\\infty} \\ln\\left(\\frac{\\omega^2+\\Delta^2+g\\Delta}{\\omega^2+\\Delta^2}\\right) d\\omega - \\frac{g\\Delta}{2\\pi} \\int_{0}^{\\infty} \\frac{d\\omega}{\\omega^2+\\Delta^2}\n$$\nThe second integral is standard:\n$$\n\\int_{0}^{\\infty} \\frac{d\\omega}{\\omega^2+\\Delta^2} = \\left[\\frac{1}{\\Delta}\\arctan\\left(\\frac{\\omega}{\\Delta}\\right)\\right]_{0}^{\\infty} = \\frac{\\pi}{2\\Delta}\n$$\nThe first integral, of the form $\\int_0^\\infty \\ln(1 + A/(x^2+B))dx$, has the known analytical solution $\\pi(\\sqrt{A+B}-\\sqrt{B})$. Here, $A=g\\Delta$ and $B=\\Delta^2$.\n$$\n\\int_{0}^{\\infty} \\ln\\left(1 + \\frac{g\\Delta}{\\omega^2+\\Delta^2}\\right) d\\omega = \\pi\\left(\\sqrt{g\\Delta + \\Delta^2} - \\sqrt{\\Delta^2}\\right) = \\pi\\left(\\sqrt{\\Delta^2+g\\Delta} - \\Delta\\right)\n$$\nSubstituting these integral results back into the expression for $E_c^{(\\text{RPA})}$:\n$$\nE_c^{(\\text{RPA})} = \\frac{1}{2\\pi} \\left[ \\pi(\\sqrt{\\Delta^2+g\\Delta} - \\Delta) \\right] - \\frac{g\\Delta}{2\\pi} \\left( \\frac{\\pi}{2\\Delta} \\right)\n$$\n$$\nE_c^{(\\text{RPA})} = \\frac{1}{2}(\\sqrt{\\Delta^2+g\\Delta} - \\Delta) - \\frac{g}{4}\n$$\nThis is the closed-form expression for the RPA correlation energy. As a check, expanding this for small $g$ yields $E_c^{(\\text{RPA})} = \\frac{1}{2}(\\Delta(1+\\frac{g}{2\\Delta}-\\frac{g^2}{8\\Delta^2}+\\dots)-\\Delta) - \\frac{g}{4} = (\\frac{g}{4}-\\frac{g^2}{16\\Delta}+\\dots) - \\frac{g}{4} \\approx -\\frac{g^2}{16\\Delta}$, which correctly recovers the MP2 result.\n\n3) Small-gap ($\\Delta\\to 0^{+}$) behavior.\nFor the MP2 correlation energy, the behavior as $\\Delta\\to 0^{+}$ is immediately apparent:\n$$\nE_c^{(\\text{MP2})} = -\\frac{g^2}{16\\Delta}\n$$\nThis expression diverges to $-\\infty$ as $\\Delta \\to 0^{+}$. The leading behavior is proportional to $\\Delta^{-1}$.\n\nFor the RPA correlation energy, we must evaluate the limit:\n$$\n\\lim_{\\Delta\\to 0^{+}} E_c^{(\\text{RPA})} = \\lim_{\\Delta\\to 0^{+}} \\left[ \\frac{1}{2}(\\sqrt{\\Delta^2+g\\Delta} - \\Delta) - \\frac{g}{4} \\right]\n$$\nWe analyze the first term by multiplying and dividing by the conjugate:\n$$\n\\lim_{\\Delta\\to 0^{+}} \\frac{\\sqrt{\\Delta^2+g\\Delta} - \\Delta}{2} = \\lim_{\\Delta\\to 0^{+}} \\frac{(\\Delta^2+g\\Delta) - \\Delta^2}{2(\\sqrt{\\Delta^2+g\\Delta} + \\Delta)} = \\lim_{\\Delta\\to 0^{+}} \\frac{g\\Delta}{2(\\sqrt{\\Delta^2+g\\Delta} + \\Delta)}\n$$\n$$\n= \\lim_{\\Delta\\to 0^{+}} \\frac{g\\Delta}{2(\\sqrt{\\Delta}\\sqrt{\\Delta+g} + \\Delta)} = \\lim_{\\Delta\\to 0^{+}} \\frac{g\\sqrt{\\Delta}}{2(\\sqrt{\\Delta+g} + \\sqrt{\\Delta})} = \\frac{g \\cdot 0}{2(\\sqrt{g}+0)} = 0\n$$\nTherefore, the RPA correlation energy approaches a finite limit:\n$$\n\\lim_{\\Delta\\to 0^{+}} E_c^{(\\text{RPA})} = 0 - \\frac{g}{4} = -\\frac{g}{4}\n$$\nThe RPA summation regularizes the divergence found in second-order perturbation theory, yielding a finite correlation energy even when the gap closes.\n\nThe required final answer consists of two parts: the leading small-$\\Delta$ expression for the MP2 energy and the $\\Delta\\to 0^{+}$ limit of the RPA energy.\nLeading small-$\\Delta$ MP2 energy: $-\\frac{g^2}{16\\Delta}$\n$\\Delta\\to 0^{+}$ limit of RPA energy: $-\\frac{g}{4}$", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n-\\frac{g^{2}}{16\\Delta} & -\\frac{g}{4}\n\\end{pmatrix}\n}\n$$", "id": "2821013"}, {"introduction": "Having established a key motivation for RPA, we now delve deeper into its theoretical structure. This practice [@problem_id:2820895] demonstrates the formal equivalence between two powerful perspectives on the RPA correlation energy: the 'plasmon formula' derived from a zero-point energy argument, and the trace-log formula derived from the Adiabatic-Connection Fluctuation-Dissipation Theorem. By proving their identity for a simple, exactly-solvable model, you will gain a more robust and unified understanding of the theory's foundations.", "problem": "Consider an independent-particle reference for a small molecule in which the neutral excitation spectrum is dominated by two particle-hole transitions. Work in the particle-hole basis under the linear-response framework that leads to the Random Phase Approximation (RPA). In this basis, the RPA equations are written in terms of the orbital-rotation blocks $\\mathbf{A}$ and $\\mathbf{B}$, where $\\mathbf{A}$ is the independent-particle Hamiltonian plus the residual Coulomb kernel and $\\mathbf{B}$ is the coupling (annihilation-creation) block arising from the same kernel. Assume that only two uncoupled transitions contribute and that $\\mathbf{A}$ and $\\mathbf{B}$ are diagonal in this subspace:\n$$\n\\mathbf{A} = \\mathrm{diag}(\\Delta_{1}, \\Delta_{2}), \\qquad \\mathbf{B} = \\mathrm{diag}(\\kappa_{1}, \\kappa_{2}),\n$$\nwith $\\Delta_{i} > |\\kappa_{i}| > 0$ so that the RPA excitation frequencies are real and positive.\n\nLet the numerical values be $\\Delta_{1} = 0.80$ Hartree (Ha), $\\Delta_{2} = 1.20$ Ha, $\\kappa_{1} = 0.20$ Ha, and $\\kappa_{2} = 0.30$ Ha. Using as fundamental starting points the Adiabatic Connection Fluctuation-Dissipation Theorem (ACFDT) for the correlation energy and the linear-response structure of RPA, perform the following:\n\n1. Starting from the RPA eigenvalue problem in the particle-hole representation, obtain the two positive RPA excitation energies $\\omega_{1}$ and $\\omega_{2}$ and, from first principles arguments about zero-point energy differences between the interacting and independent-boson limits of these modes, derive an expression for the RPA correlation energy in this decoupled two-mode limit in terms of $\\{\\omega_{i}\\}$ and $\\{\\Delta_{i}\\}$. Evaluate it numerically for the given parameters.\n\n2. Starting from the ACFDT expression and its linear-response RPA reduction, show that for diagonal $\\mathbf{A}$ and $\\mathbf{B}$ the correlation energy can be written as a frequency integral over a trace-logarithm of a ratio of quadratic forms involving $(\\mathbf{A}-\\mathbf{B})(\\mathbf{A}+\\mathbf{B})$ and $\\mathbf{A}^{2}$, and reduce it to a sum of one-dimensional integrals of the form $\\int_{0}^{\\infty} d\\omega \\,\\ln\\!\\left((\\omega^{2}+\\alpha^{2})/(\\omega^{2}+\\beta^{2})\\right)$. Evaluate these integrals analytically and use them to compute the RPA correlation energy for the given parameters.\n\nReport the common value of the correlation energy (they should match if the derivations are consistent) as a single number in Hartree. Round your answer to six significant figures and express the energy in Hartree (Ha).", "solution": "We begin by conducting a mandatory validation of the provided problem statement.\n\nThe givens are extracted verbatim: a system with two dominant particle-hole transitions is described within the Random Phase Approximation (RPA). The orbital-rotation block $\\mathbf{A}$ and coupling block $\\mathbf{B}$ are given as diagonal matrices in the basis of these two transitions: $\\mathbf{A} = \\mathrm{diag}(\\Delta_{1}, \\Delta_{2})$ and $\\mathbf{B} = \\mathrm{diag}(\\kappa_{1}, \\kappa_{2})$. The condition $\\Delta_{i} > |\\kappa_{i}| > 0$ holds. The numerical values are $\\Delta_{1} = 0.80$ Ha, $\\Delta_{2} = 1.20$ Ha, $\\kappa_{1} = 0.20$ Ha, and $\\kappa_{2} = 0.30$ Ha. The task is to compute the RPA correlation energy, $E_c$, through two distinct, specified derivations and report the common numerical result.\n\nThe problem is scientifically grounded, rooted in the well-established many-body theory of electronic structure, specifically the Random Phase Approximation and the Adiabatic Connection Fluctuation-Dissipation Theorem (ACFDT). It is well-posed, providing all necessary data and conditions for a unique, stable solution. The condition $\\Delta_{i} > |\\kappa_{i}|$ ensures the stability of the RPA solution, guaranteeing real excitation energies. The language is objective and precise. The problem is a standard, albeit simplified, exercise in theoretical chemistry that tests fundamental understanding, not a trivial or pseudo-profound question. Thus, the problem is deemed valid and we may proceed to its solution.\n\nThe solution is presented in two parts as requested, followed by the numerical evaluation.\n\nPart 1: Derivation from the RPA Eigenvalue Problem and Zero-Point Energy\n\nThe non-Hermitian RPA eigenvalue problem is given in the particle-hole basis by the matrix equation:\n$$\n\\begin{pmatrix} \\mathbf{A} & \\mathbf{B} \\\\ \\mathbf{B} & \\mathbf{A} \\end{pmatrix} \\begin{pmatrix} \\mathbf{X} \\\\ \\mathbf{Y} \\end{pmatrix} = \\omega \\begin{pmatrix} \\mathbf{1} & \\mathbf{0} \\\\ \\mathbf{0} & -\\mathbf{1} \\end{pmatrix} \\begin{pmatrix} \\mathbf{X} \\\\ \\mathbf{Y} \\end{pmatrix}\n$$\nThis corresponds to two coupled equations for the amplitudes $\\mathbf{X}$ and $\\mathbf{Y}$:\n$$\n\\mathbf{A}\\mathbf{X} + \\mathbf{B}\\mathbf{Y} = \\omega\\mathbf{X} \\quad (1)\n$$\n$$\n\\mathbf{B}\\mathbf{X} + \\mathbf{A}\\mathbf{Y} = -\\omega\\mathbf{Y} \\quad (2)\n$$\nBy adding and subtracting these two equations, we obtain a more convenient form:\n$$\n(\\mathbf{A}+\\mathbf{B})(\\mathbf{X}+\\mathbf{Y}) = \\omega(\\mathbf{X}-\\mathbf{Y}) \\quad (3)\n$$\n$$\n(\\mathbf{A}-\\mathbf{B})(\\mathbf{X}-\\mathbf{Y}) = \\omega(\\mathbf{X}+\\mathbf{Y}) \\quad (4)\n$$\nSubstituting $(\\mathbf{X}-\\mathbf{Y})$ from equation ($3$) into equation ($4$), assuming $\\omega \\neq 0$, gives:\n$$\n(\\mathbf{A}-\\mathbf{B}) \\frac{1}{\\omega}(\\mathbf{A}+\\mathbf{B})(\\mathbf{X}+\\mathbf{Y}) = \\omega(\\mathbf{X}+\\mathbf{Y})\n$$\nThis can be rearranged into a standard symmetric eigenvalue problem for $\\omega^2$:\n$$\n(\\mathbf{A}-\\mathbf{B})(\\mathbfA+\\mathbf{B})(\\mathbf{X}+\\mathbf{Y}) = \\omega^2(\\mathbf{X}+\\mathbf{Y})\n$$\nIn the specific case given, $\\mathbf{A}$ and $\\mathbf{B}$ are diagonal matrices. Therefore, they commute, and the product $(\\mathbf{A}-\\mathbf{B})(\\mathbf{A}+\\mathbf{B})$ simplifies to $\\mathbf{A}^2 - \\mathbf{B}^2$. The eigenvalue equation becomes:\n$$\n(\\mathbf{A}^2 - \\mathbf{B}^2)(\\mathbf{X}+\\mathbf{Y}) = \\omega^2(\\mathbf{X}+\\mathbf{Y})\n$$\nSince $\\mathbf{A}^2 - \\mathbf{B}^2 = \\mathrm{diag}(\\Delta_1^2 - \\kappa_1^2, \\Delta_2^2 - \\kappa_2^2)$, the eigenvalues $\\omega_i^2$ are the diagonal elements. The positive RPA excitation energies are therefore:\n$$\n\\omega_i = \\sqrt{\\Delta_i^2 - \\kappa_i^2}\n$$\nfor $i=1, 2$.\n\nThe RPA correlation energy, $E_c^{\\text{RPA}}$, can be interpreted as the difference between the ground-state zero-point energy of the interacting system (described by fictitious bosons with frequencies $\\omega_i$) and the non-interacting reference system (where $\\mathbf{B}=0$, implying frequencies are $\\Delta_i$). Each mode contributes $\\frac{1}{2}\\hbar\\omega$, and in atomic units $\\hbar=1$. Thus, the total zero-point energy of the interacting system is $\\frac{1}{2}\\sum_i \\omega_i$, and for the reference system it is $\\frac{1}{2}\\sum_i \\Delta_i$. The correlation energy is the difference:\n$$\nE_c^{\\text{RPA}} = \\frac{1}{2}\\sum_{i} (\\omega_i - \\Delta_i)\n$$\nFor the two-mode system under consideration, this becomes:\n$$\nE_c = \\frac{1}{2} \\left[ (\\omega_1 - \\Delta_1) + (\\omega_2 - \\Delta_2) \\right]\n$$\n\nPart 2: Derivation from the Adiabatic Connection Fluctuation-Dissipation Theorem\n\nWe start from the trace-log or \"plasmon\" formula for the RPA correlation energy, which is a direct consequence of integrating the ACFDT expression over the interaction strength parameter $\\lambda$ within the RPA. At imaginary frequency $iu$, this formula reads:\n$$\nE_c = \\frac{1}{2\\pi} \\int_0^\\infty du \\, \\mathrm{Tr}\\left[ \\ln\\left((\\mathbf{A}-i u\\mathbf{1})^{-1}(\\mathbf{A}+i u\\mathbf{1})^{-1}\\right) - \\ln\\left((\\mathbf{A}+\\mathbf{B}-i u\\mathbf{1})^{-1}(\\mathbf{A}-\\mathbf{B}+i u\\mathbf{1})^{-1}\\right) \\right]\n$$\nA more common and equivalent formulation which we shall use is:\n$$\nE_c = \\frac{1}{2\\pi} \\int_0^\\infty du \\, \\mathrm{Tr}\\left[ \\ln\\left((\\mathbf{A}-\\mathbf{B})(\\mathbf{A}+\\mathbf{B}) + u^2 \\mathbf{1}\\right) - \\ln(\\mathbf{A}^2 + u^2 \\mathbf{1}) \\right]\n$$\nThis expression represents the integral of the difference in zero-point fluctuations of the non-interacting and interacting response functions over all frequencies. Since $\\mathbf{A}$ and $\\mathbf{B}$ are diagonal, the matrices $\\mathbf{A}^2$ and $(\\mathbf{A}-\\mathbf{B})(\\mathbf{A}+\\mathbf{B}) = \\mathbf{A}^2 - \\mathbf{B}^2$ are also diagonal. As established in Part 1, the eigenvalues of $\\mathbf{A}^2 - \\mathbf{B}^2$ are $\\omega_i^2 = \\Delta_i^2 - \\kappa_i^2$. The trace of the logarithm of a diagonal matrix is the sum of the logarithms of its diagonal elements. The expression for $E_c$ thus separates into a sum over the uncoupled modes:\n$$\nE_c = \\frac{1}{2\\pi} \\sum_{i=1,2} \\int_0^\\infty du \\, \\left[ \\ln(\\omega_i^2 + u^2) - \\ln(\\Delta_i^2 + u^2) \\right]\n$$\n$$\nE_c = \\sum_{i=1,2} \\frac{1}{2\\pi} \\int_0^\\infty du \\, \\ln\\left(\\frac{u^2 + \\omega_i^2}{u^2 + \\Delta_i^2}\\right)\n$$\nWe must now evaluate the definite integral $I = \\int_0^\\infty du \\, \\ln\\left(\\frac{u^2 + \\alpha^2}{u^2 + \\beta^2}\\right)$ for positive constants $\\alpha$ and $\\beta$. We use integration by parts, with $f(u) = \\ln\\left(\\frac{u^2 + \\alpha^2}{u^2 + \\beta^2}\\right)$ and $g'(u)=1$.\n$$\nI = \\left[u \\ln\\left(\\frac{u^2 + \\alpha^2}{u^2 + \\beta^2}\\right)\\right]_0^\\infty - \\int_0^\\infty u \\left( \\frac{2u}{u^2+\\alpha^2} - \\frac{2u}{u^2+\\beta^2} \\right) du\n$$\nThe boundary term at $u \\to \\infty$ is $\\lim_{u\\to\\infty} u \\ln\\left(\\frac{1+\\alpha^2/u^2}{1+\\beta^2/u^2}\\right) = \\lim_{u\\to\\infty} u \\left( (\\alpha^2/u^2 - \\beta^2/u^2) + O(u^{-4}) \\right) = 0$. The term at $u=0$ is also $0$. The integral becomes:\n$$\nI = - \\int_0^\\infty 2u^2 \\left( \\frac{1}{u^2+\\alpha^2} - \\frac{1}{u^2+\\beta^2} \\right) du = - \\int_0^\\infty 2u^2 \\frac{\\beta^2 - \\alpha^2}{(u^2+\\alpha^2)(u^2+\\beta^2)} du\n$$\n$$\nI = 2(\\alpha^2 - \\beta^2) \\int_0^\\infty \\frac{u^2}{(u^2+\\alpha^2)(u^2+\\beta^2)} du\n$$\nUsing partial fraction decomposition $\\frac{u^2}{(u^2+\\alpha^2)(u^2+\\beta^2)} = \\frac{1}{\\alpha^2-\\beta^2}\\left(\\frac{-\\beta^2}{u^2+\\beta^2} + \\frac{\\alpha^2}{u^2+\\alpha^2}\\right)$, we get:\n$$\nI = 2(\\alpha^2 - \\beta^2) \\frac{1}{\\alpha^2-\\beta^2} \\int_0^\\infty \\left( \\frac{\\alpha^2}{u^2+\\alpha^2} - \\frac{\\beta^2}{u^2+\\beta^2} \\right) du\n$$\n$$\nI = 2 \\left[ \\alpha^2 \\left(\\frac{1}{\\alpha}\\arctan\\frac{u}{\\alpha}\\right)_0^\\infty - \\beta^2 \\left(\\frac{1}{\\beta}\\arctan\\frac{u}{\\beta}\\right)_0^\\infty \\right] = 2 \\left[ \\alpha \\frac{\\pi}{2} - \\beta \\frac{\\pi}{2} \\right] = \\pi(\\alpha - \\beta)\n$$\nSubstituting this result back into the expression for $E_c$, with $\\alpha \\to \\omega_i$ and $\\beta \\to \\Delta_i$:\n$$\nE_c = \\sum_{i=1,2} \\frac{1}{2\\pi} \\left[ \\pi(\\omega_i - \\Delta_i) \\right] = \\frac{1}{2} \\sum_{i=1,2} (\\omega_i - \\Delta_i)\n$$\nThis expression is identical to the one derived in Part 1, confirming the consistency of the two approaches. The correlation energy is always negative, as $\\omega_i < \\Delta_i$.\n\nNumerical Evaluation\n\nWe are given the parameters:\n$\\Delta_1 = 0.80$ Ha\n$\\Delta_2 = 1.20$ Ha\n$\\kappa_1 = 0.20$ Ha\n$\\kappa_2 = 0.30$ Ha\n\nFirst, we compute the RPA excitation energies $\\omega_1$ and $\\omega_2$:\n$$\n\\omega_1 = \\sqrt{\\Delta_1^2 - \\kappa_1^2} = \\sqrt{(0.80)^2 - (0.20)^2} = \\sqrt{0.64 - 0.04} = \\sqrt{0.60} \\, \\text{Ha}\n$$\n$$\n\\omega_2 = \\sqrt{\\Delta_2^2 - \\kappa_2^2} = \\sqrt{(1.20)^2 - (0.30)^2} = \\sqrt{1.44 - 0.09} = \\sqrt{1.35} \\, \\text{Ha}\n$$\nNumerically, $\\omega_1 \\approx 0.77459667$ Ha and $\\omega_2 \\approx 1.16189500$ Ha.\n\nNow, we compute the correlation energy $E_c$:\n$$\nE_c = \\frac{1}{2} \\left[ (\\omega_1 - \\Delta_1) + (\\omega_2 - \\Delta_2) \\right]\n$$\n$$\nE_c = \\frac{1}{2} \\left[ (\\sqrt{0.60} - 0.80) + (\\sqrt{1.35} - 1.20) \\right]\n$$\n$$\nE_c \\approx \\frac{1}{2} \\left[ (0.77459667 - 0.80) + (1.16189500 - 1.20) \\right]\n$$\n$$\nE_c \\approx \\frac{1}{2} \\left[ -0.02540333 - 0.03810500 \\right]\n$$\n$$\nE_c \\approx \\frac{1}{2} (-0.06350833) = -0.031754165 \\, \\text{Ha}\n$$\nRounding the result to six significant figures as requested, we obtain $E_c = -0.0317542$ Ha.", "answer": "$$\\boxed{-0.0317542}$$", "id": "2820895"}, {"introduction": "Our final practice shifts from abstract theory to the practical realities of computational chemistry. This exercise [@problem_id:2820910] challenges you to determine the computational cost scaling of a direct RPA implementation as a function of system size, $N$. By identifying the rate-limiting step in the algorithm, you will understand why naive RPA is considered computationally demanding and appreciate the importance of the advanced, lower-scaling methods discussed in modern literature.", "problem": "You are analyzing a naive implementation of the random phase approximation (RPA) correlation energy based on the adiabatic connection fluctuation–dissipation (ACFD) formulation in an atomic orbital (AO) basis for a closed-shell system. Let the number of atoms be $N$, and assume the following physically motivated scalings hold under a fixed-basis, fixed-density regime typical of theoretical chemistry:\n- The number of AO basis functions is $M = \\alpha N$, where $\\alpha$ is a positive constant independent of $N$.\n- The number of occupied molecular orbitals (MO) is $N_{\\mathrm{o}} = \\beta N$ and the number of virtual MOs is $N_{\\mathrm{v}} = \\gamma N$, where $\\beta$ and $\\gamma$ are positive constants independent of $N$.\n- The number of quadrature points on the imaginary frequency axis is $N_{\\omega} = \\delta$, where $\\delta$ is a positive constant independent of $N$.\n\nThe independent-particle density–density response function (also called the independent-particle polarizability) at imaginary frequency $\\mathrm{i}\\omega$ is represented in the AO basis $\\{\\phi_{\\mu}\\}_{\\mu=1}^{M}$ as the matrix with elements\n$$\n\\chi_{0}(\\mathrm{i}\\omega)_{\\mu\\nu}\n=\n\\sum_{i=1}^{N_{\\mathrm{o}}}\\sum_{a=1}^{N_{\\mathrm{v}}}\n\\phi_{i\\mu}\\,\\phi_{i\\nu}\\,\\phi_{a\\mu}\\,\\phi_{a\\nu}\\,f_{ia}(\\mathrm{i}\\omega),\n$$\nwhere $\\phi_{p\\mu}$ denotes the coefficient of MO $p$ in AO $\\mu$, and $f_{ia}(\\mathrm{i}\\omega)$ is a scalar function of the orbital energy difference and frequency (its explicit form is not required for this problem). The Coulomb kernel in the AO basis defines an $M \\times M$ matrix $v$, and the ACFD RPA correlation energy requires, for each quadrature point, the evaluation of dense matrix operations such as forming products like $v\\,\\chi_{0}(\\mathrm{i}\\omega)$ and taking a matrix function (for example, a logarithm or eigenvalue decomposition) of an $M \\times M$ matrix, followed by a trace.\n\nAssume a naive implementation that\n- constructs $\\chi_{0}(\\mathrm{i}\\omega)$ explicitly by direct summation over $(i,a)$ for each AO index pair $(\\mu,\\nu)$, for each of the $N_{\\omega}$ quadrature points, without using resolution of the identity, density fitting, imaginary-time factorization, or low-rank compression, and\n- evaluates the required dense linear algebra for the trace at each quadrature point using standard cubic-cost routines.\n\nStarting only from these definitions and assumptions, and by identifying the dominant tensor contractions and matrix operations together with their arithmetic costs as functions of $M$, $N_{\\mathrm{o}}$, and $N_{\\mathrm{v}}$, derive the overall leading-order computational scaling with $N$ of this naive RPA implementation. Express your final result as a single symbolic expression in $N$, ignoring multiplicative constants and lower-order terms. Do not include units. The final answer must be a single closed-form expression.", "solution": "We begin from the independent-particle polarizability $\\chi_{0}(\\mathrm{i}\\omega)$ expressed in the atomic orbital (AO) basis. For each imaginary frequency $\\mathrm{i}\\omega$, the AO matrix elements are\n$$\n\\chi_{0}(\\mathrm{i}\\omega)_{\\mu\\nu}\n=\n\\sum_{i=1}^{N_{\\mathrm{o}}}\\sum_{a=1}^{N_{\\mathrm{v}}}\n\\phi_{i\\mu}\\,\\phi_{i\\nu}\\,\\phi_{a\\mu}\\,\\phi_{a\\nu}\\,f_{ia}(\\mathrm{i}\\omega),\n$$\nwhere $\\mu,\\nu \\in \\{1,\\dots,M\\}$ are AO indices, $i \\in \\{1,\\dots,N_{\\mathrm{o}}\\}$ runs over occupied molecular orbitals (MOs), $a \\in \\{1,\\dots,N_{\\mathrm{v}}\\}$ runs over virtual MOs, $\\phi_{p\\mu}$ are the MO coefficients in the AO basis, and $f_{ia}(\\mathrm{i}\\omega)$ is a scalar depending on orbital energies and the frequency $\\omega$.\n\nWe identify the dominant operations involved in a naive implementation.\n\n1. Construction of $\\chi_{0}(\\mathrm{i}\\omega)$ for one frequency:\n   - The target is an $M \\times M$ matrix in the AO basis, so there are $M^{2}$ matrix elements $\\chi_{0}(\\mathrm{i}\\omega)_{\\mu\\nu}$ to be computed.\n   - For each fixed pair $(\\mu,\\nu)$, the formula requires a double sum over occupied–virtual pairs $(i,a)$ with $N_{\\mathrm{o}} N_{\\mathrm{v}}$ terms. The body of the loop consists of a constant number of scalar operations (multiplications and additions) per $(i,a)$ because $\\phi_{i\\mu}$, $\\phi_{i\\nu}$, $\\phi_{a\\mu}$, $\\phi_{a\\nu}$, and $f_{ia}(\\mathrm{i}\\omega)$ are scalars.\n   - Therefore, the arithmetic cost to build $\\chi_{0}(\\mathrm{i}\\omega)$ scales as\n     $$\n     \\mathcal{O}\\!\\left(M^{2}\\,N_{\\mathrm{o}}\\,N_{\\mathrm{v}}\\right).\n     $$\n\n2. Dense linear algebra per frequency to evaluate the ACFD trace:\n   - The ACFD random phase approximation (RPA) correlation energy requires evaluation of a trace of a matrix function of an $M \\times M$ matrix constructed from $v$ and $\\chi_{0}(\\mathrm{i}\\omega)$ (for example, forming $A(\\mathrm{i}\\omega)=\\mathbf{1}-v\\,\\chi_{0}(\\mathrm{i}\\omega)$, then computing a matrix logarithm or performing an eigenvalue decomposition).\n   - Forming the product $v\\,\\chi_{0}(\\mathrm{i}\\omega)$ costs $\\mathcal{O}\\!(M^{3})$ using standard dense matrix–matrix multiplication.\n   - Taking a matrix function via diagonalization or Schur decomposition also costs $\\mathcal{O}\\!(M^{3})$.\n   - Hence, the dense linear algebra per frequency is\n     $$\n     \\mathcal{O}\\!\\left(M^{3}\\right).\n     $$\n\n3. Total cost across the frequency grid:\n   - There are $N_{\\omega}$ quadrature points on the imaginary axis, with $N_{\\omega}=\\delta$ being a constant independent of $N$. Therefore, the total cost is the per-frequency cost multiplied by a constant factor, which does not change the scaling with $N$.\n   - The per-frequency cost is the sum of the costs from steps $1$ and $2$:\n     $$\n     \\mathcal{O}\\!\\left(M^{2}\\,N_{\\mathrm{o}}\\,N_{\\mathrm{v}}\\right)\\;+\\;\\mathcal{O}\\!\\left(M^{3}\\right).\n     $$\n\n4. Substitution of system-size scalings:\n   - By assumption, $M=\\alpha N$, $N_{\\mathrm{o}}=\\beta N$, and $N_{\\mathrm{v}}=\\gamma N$, where $\\alpha$, $\\beta$, and $\\gamma$ are positive constants independent of $N$.\n   - Substitute into the two terms:\n     $$\n     \\mathcal{O}\\!\\left(M^{2}\\,N_{\\mathrm{o}}\\,N_{\\mathrm{v}}\\right)\n     = \\mathcal{O}\\!\\left((\\alpha N)^{2}\\,(\\beta N)\\,(\\gamma N)\\right)\n     = \\mathcal{O}\\!\\left(\\alpha^{2}\\beta\\gamma\\,N^{4}\\right)\n     = \\mathcal{O}\\!\\left(N^{4}\\right),\n     $$\n     $$\n     \\mathcal{O}\\!\\left(M^{3}\\right) = \\mathcal{O}\\!\\left((\\alpha N)^{3}\\right) = \\mathcal{O}\\!\\left(\\alpha^{3} N^{3}\\right) = \\mathcal{O}\\!\\left(N^{3}\\right).\n     $$\n   - Comparing $\\mathcal{O}\\!\\left(N^{4}\\right)$ and $\\mathcal{O}\\!\\left(N^{3}\\right)$, the dominant term for large $N$ is $\\mathcal{O}\\!\\left(N^{4}\\right)$.\n\n5. Identification of the dominant tensor contraction:\n   - The dominant cost arises from the four-index contraction that builds $\\chi_{0}(\\mathrm{i}\\omega)$ by summing over the occupied–virtual pairs $(i,a)$ for each AO index pair $(\\mu,\\nu)$, i.e., the $(\\mu\\nu)\\leftarrow(ia)$ contraction with cost $\\mathcal{O}\\!\\left(M^{2}\\,N_{\\mathrm{o}}\\,N_{\\mathrm{v}}\\right)$.\n   - All subsequent dense matrix operations on $M \\times M$ matrices, such as forming $v\\,\\chi_{0}$ and evaluating a matrix logarithm or an eigenvalue decomposition, contribute subdominant $\\mathcal{O}\\!\\left(M^{3}\\right)=\\mathcal{O}\\!\\left(N^{3}\\right)$ cost.\n\nTherefore, under the stated assumptions and in a naive implementation without auxiliary basis techniques or compression, the overall leading-order computational scaling with system size $N$ is given by the $\\mathcal{O}\\!\\left(N^{4}\\right)$ term originating from the construction of $\\chi_{0}(\\mathrm{i}\\omega)$.\n\nIgnoring multiplicative constants and lower-order terms, the leading-order cost as a symbolic expression in $N$ is\n$$\nN^{4}.\n$$", "answer": "$$\\boxed{N^{4}}$$", "id": "2820910"}]}