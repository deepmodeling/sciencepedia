{"hands_on_practices": [{"introduction": "To understand relativistic effects, we must first dissect the leading-order scalar corrections that emerge from the Dirac equation: the mass-velocity and Darwin terms. This foundational exercise [@problem_id:2802831] requires you to derive their relative contributions from first principles for a simple hydrogenic system. By calculating why this balance shifts dramatically between an $s$-orbital and a $p$-orbital, you will gain a core physical intuition for how relativity reshapes the electronic structure of heavy atoms.", "problem": "A one-electron heavy ion with nuclear charge $Z$ is modeled by a point nucleus and a central Coulomb potential. Work in atomic units (i.e., $\\hbar = 1$, $m_{e} = 1$, $e^{2}/(4\\pi\\varepsilon_{0}) = 1$) and treat the scalar relativistic effects to order $\\mathcal{O}(c^{-2})$ using the scalar part of either the Zeroth-Order Regular Approximation (ZORA) or the Douglas-Kroll-Hess (DKH) Hamiltonian, applied as a first-order perturbation to the nonrelativistic hydrogenic problem. The scalar relativistic correction for an orbital is the sum of a mass–velocity term and a Darwin term.\n\nDefine, for a bound hydrogenic eigenstate labeled by principal and orbital angular momentum quantum numbers $(n,\\ell)$, the magnitude-weighted relative contribution of the Darwin term to the total scalar relativistic correction as\n$$\nf_{n\\ell} \\equiv \\frac{\\left|\\langle H_{\\mathrm{D}} \\rangle\\right|}{\\left|\\langle H_{\\mathrm{D}} \\rangle\\right| + \\left|\\langle H_{\\mathrm{MV}} \\rangle\\right|},\n$$\nwhere $H_{\\mathrm{D}}$ denotes the Darwin operator and $H_{\\mathrm{MV}}$ denotes the mass–velocity operator, and $\\langle \\cdot \\rangle$ indicates the expectation value over the nonrelativistic hydrogenic eigenfunction for $(n,\\ell)$. Using only well-established results that follow from expanding the Dirac Hamiltonian to $\\mathcal{O}(c^{-2})$ and hydrogenic quantum mechanics, compute the difference\n$$\n\\Delta f \\equiv f_{1s} - f_{2p}\n$$\nfor the $1s$ and $2p$ orbitals in the limit of a point nucleus. Express your final answer as a reduced exact fraction (dimensionless). Briefly rationalize, based on first principles, why the two orbitals differ in their Darwin contributions under these assumptions.", "solution": "The problem requires the calculation of a quantity, $\\Delta f$, which depends on the scalar relativistic corrections for a hydrogenic system. We begin by defining the operators for the mass–velocity ($H_{\\mathrm{MV}}$) and Darwin ($H_{\\mathrm{D}}$) corrections. These operators are derived from the expansion of the Dirac Hamiltonian to order $\\mathcal{O}(c^{-2})$. In atomic units ($\\hbar = 1, m_{e} = 1$), the operators are given by:\n$$\nH_{\\mathrm{MV}} = -\\frac{1}{8c^2} p^4\n$$\n$$\nH_{\\mathrm{D}} = \\frac{1}{8c^2} \\nabla^2 V(r)\n$$\nFor a point nucleus with charge $Z$, the Coulomb potential is $V(r) = -Z/r$. We compute the Laplacian of this potential: $\\nabla^2 V(r) = -Z \\nabla^2(1/r)$. The Laplacian of $1/r$ is a standard result in mathematical physics, $\\nabla^2(1/r) = -4\\pi \\delta(\\mathbf{r})$, where $\\delta(\\mathbf{r})$ is the three-dimensional Dirac delta function. The Darwin operator is therefore:\n$$\nH_{\\mathrm{D}} = \\frac{1}{8c^2} (-Z)(-4\\pi \\delta(\\mathbf{r})) = \\frac{\\pi Z}{2c^2} \\delta(\\mathbf{r})\n$$\nThe problem defines the quantity $f_{n\\ell}$ as the magnitude-weighted relative contribution of the Darwin term:\n$$\nf_{n\\ell} \\equiv \\frac{\\left|\\langle H_{\\mathrm{D}} \\rangle\\right|}{\\left|\\langle H_{\\mathrm{D}} \\rangle\\right| + \\left|\\langle H_{\\mathrm{MV}} \\rangle\\right|}\n$$\nThe expectation values $\\langle \\cdot \\rangle$ are to be calculated using the non-relativistic hydrogenic wavefunctions $\\psi_{n\\ell m}$. We need to compute $\\Delta f \\equiv f_{1s} - f_{2p}$.\n\nFirst, we analyze the $2p$ orbital, which corresponds to quantum numbers $n=2$ and $\\ell=1$. The expectation value of the Darwin term is:\n$$\n\\langle H_{\\mathrm{D}} \\rangle_{2p} = \\left\\langle \\psi_{21m} \\left| \\frac{\\pi Z}{2c^2} \\delta(\\mathbf{r}) \\right| \\psi_{21m} \\right\\rangle = \\frac{\\pi Z}{2c^2} |\\psi_{21m}(0)|^2\n$$\nFor any orbital with a non-zero orbital angular momentum quantum number ($\\ell > 0$), the wavefunction vanishes at the nucleus, i.e., $\\psi_{n\\ell m}(0) = 0$ for $\\ell \\ge 1$. This is a consequence of the centrifugal barrier term $\\ell(\\ell+1)/r^2$ in the effective potential of the radial Schrödinger equation, which forces the radial wavefunction to zero as $r \\to 0$. Therefore, $|\\psi_{21m}(0)|^2 = 0$, and the Darwin expectation value is strictly zero:\n$$\n\\langle H_{\\mathrm{D}} \\rangle_{2p} = 0\n$$\nFrom this result, the value of $f_{2p}$ is immediately determined to be zero, provided that $\\langle H_{\\mathrm{MV}} \\rangle_{2p}$ is not zero (which we will verify):\n$$\nf_{2p} = \\frac{|0|}{|0| + \\left|\\langle H_{\\mathrm{MV}} \\rangle_{2p}\\right|} = 0\n$$\n\nSecond, we analyze the $1s$ orbital, with quantum numbers $n=1$ and $\\ell=0$. For an s-orbital ($\\ell=0$), the wavefunction has a finite amplitude at the nucleus. For a general hydrogenic s-orbital, the probability density at the origin is given by the well-established formula:\n$$\n|\\psi_{n00}(0)|^2 = \\frac{Z^3}{\\pi n^3}\n$$\nFor the $1s$ state ($n=1$), this gives $|\\psi_{100}(0)|^2 = Z^3/\\pi$. The expectation value of the Darwin term is therefore non-zero:\n$$\n\\langle H_{\\mathrm{D}} \\rangle_{1s} = \\frac{\\pi Z}{2c^2} |\\psi_{100}(0)|^2 = \\frac{\\pi Z}{2c^2} \\frac{Z^3}{\\pi} = \\frac{Z^4}{2c^2}\n$$\nThis correction is positive, hence it is a destabilizing energy shift.\n\nNext, we must evaluate the expectation value of the mass–velocity operator, $\\langle H_{\\mathrm{MV}} \\rangle_{n\\ell} = \\langle -p^4/(8c^2) \\rangle_{n\\ell}$. From the non-relativistic Schrödinger equation, $H_0 \\psi = (\\frac{p^2}{2} + V)\\psi = E_n \\psi$, we can write $p^2\\psi = 2(E_n - V)\\psi$. The expectation value of $p^4$ is then found as:\n$$\n\\langle p^4 \\rangle = \\langle \\psi | p^2 \\cdot p^2 | \\psi \\rangle = \\langle \\psi | (2(E_n - V))^2 | \\psi \\rangle = 4 \\langle (E_n - V)^2 \\rangle = 4(E_n^2 - 2E_n\\langle V \\rangle + \\langle V^2 \\rangle)\n$$\nFor a hydrogenic system in atomic units, we use the following standard results:\nThe energy is $E_n = -\\frac{Z^2}{2n^2}$.\nFrom the virial theorem for a Coulomb potential, $\\langle V \\rangle = 2E_n = -\\frac{Z^2}{n^2}$.\nThe expectation value of $r^{-2}$ is given by Kramer's relation as $\\langle r^{-2} \\rangle = \\frac{Z^2}{n^3(\\ell+1/2)}$. Since $V^2 = (-Z/r)^2 = Z^2/r^2$, we have $\\langle V^2 \\rangle = Z^2\\langle r^{-2} \\rangle = \\frac{Z^4}{n^3(\\ell+1/2)}$.\nSubstituting these into the expression for $\\langle p^4 \\rangle$:\n$$\n\\langle p^4 \\rangle_{n\\ell} = 4\\left( \\left(-\\frac{Z^2}{2n^2}\\right)^2 - 2\\left(-\\frac{Z^2}{2n^2}\\right)\\left(-\\frac{Z^2}{n^2}\\right) + \\frac{Z^4}{n^3(\\ell+1/2)} \\right)\n$$\n$$\n\\langle p^4 \\rangle_{n\\ell} = 4\\left( \\frac{Z^4}{4n^4} - \\frac{Z^4}{n^4} + \\frac{Z^4}{n^3(\\ell+1/2)} \\right) = 4Z^4 \\left( -\\frac{3}{4n^4} + \\frac{1}{n^3(\\ell+1/2)} \\right)\n$$\nThe mass–velocity correction is then $\\langle H_{\\mathrm{MV}} \\rangle_{n\\ell} = -\\frac{1}{8c^2} \\langle p^4 \\rangle_{n\\ell}$:\n$$\n\\langle H_{\\mathrm{MV}} \\rangle_{n\\ell} = -\\frac{4Z^4}{8c^2} \\left( -\\frac{3}{4n^4} + \\frac{1}{n^3(\\ell+1/2)} \\right) = \\frac{Z^4}{2c^2} \\left( \\frac{3}{4n^4} - \\frac{1}{n^3(\\ell+1/2)} \\right)\n$$\nFor the $1s$ state ($n=1, \\ell=0$):\n$$\n\\langle H_{\\mathrm{MV}} \\rangle_{1s} = \\frac{Z^4}{2c^2} \\left( \\frac{3}{4(1)^4} - \\frac{1}{(1)^3(0+1/2)} \\right) = \\frac{Z^4}{2c^2} \\left( \\frac{3}{4} - 2 \\right) = -\\frac{5Z^4}{8c^2}\n$$\nThis correction is negative, representing a stabilization of the orbital energy. Now we assemble the expression for $f_{1s}$:\n$$\nf_{1s} = \\frac{\\left|\\langle H_{\\mathrm{D}} \\rangle_{1s}\\right|}{\\left|\\langle H_{\\mathrm{D}} \\rangle_{1s}\\right| + \\left|\\langle H_{\\mathrm{MV}} \\rangle_{1s}\\right|} = \\frac{\\left|\\frac{Z^4}{2c^2}\\right|}{\\left|\\frac{Z^4}{2c^2}\\right| + \\left|-\\frac{5Z^4}{8c^2}\\right|} = \\frac{\\frac{Z^4}{2c^2}}{\\frac{Z^4}{2c^2} + \\frac{5Z^4}{8c^2}}\n$$\nTo simplify the fraction, we can express the numerator and denominator in common units of $Z^4/(8c^2)$:\n$$\nf_{1s} = \\frac{\\frac{4Z^4}{8c^2}}{\\frac{4Z^4}{8c^2} + \\frac{5Z^4}{8c^2}} = \\frac{4}{4 + 5} = \\frac{4}{9}\n$$\nThe required difference is:\n$$\n\\Delta f = f_{1s} - f_{2p} = \\frac{4}{9} - 0 = \\frac{4}{9}\n$$\nAs a final step, we rationalize the difference in Darwin contributions. As shown, the Darwin operator $H_{\\mathrm{D}}$ is proportional to the Dirac delta function $\\delta(\\mathbf{r})$. It is therefore a contact interaction that provides a measure of the electron probability density precisely at the location of the nucleus, $|\\psi(0)|^2$. For hydrogenic orbitals, this density is non-zero only for s-orbitals ($\\ell=0$). The angular momentum of p-orbitals ($\\ell=1$) creates a centrifugal barrier that forces the wavefunction to be zero at the origin. Consequently, the $2p$ orbital has a node at the nucleus, $|\\psi_{2p}(0)|^2 = 0$, leading to an identically zero Darwin correction. The $1s$ orbital, in contrast, has its maximum probability density at the nucleus, resulting in a substantial, non-zero Darwin correction. This fundamental difference in the spatial distribution of the orbitals near the nucleus is the direct cause for the computed disparity in their Darwin contributions.", "answer": "$$\n\\boxed{\\frac{4}{9}}\n$$", "id": "2802831"}, {"introduction": "While first-order perturbation theory provides insight, modern quantum chemistry employs more sophisticated and accurate scalar relativistic Hamiltonians like ZORA, DKH, and X2C. This practice problem [@problem_id:2802892] establishes a clear hierarchy of accuracy among these key methods by comparing their predictions against the exact analytical solution of the Dirac equation. By focusing on the unique case of a $1s$ orbital, where spin-orbit coupling is absent, you will see precisely how well each approximation scheme manages to reproduce the true relativistic energy.", "problem": "Consider a hydrogen-like one-electron atom with nuclear charge $Z$ in a Coulomb potential $V(r) = - Z \\alpha \\hbar c / r$. Work in Hartree atomic units, where $\\hbar = m_{e} = e = 1$ and $c = 1/\\alpha$, so that $V(r) = -Z/r$ and the rest energy is $c^{2}$. The exact relativistic reference is the spectrum of the one-electron Dirac Hamiltonian $H_{\\mathrm{D}} = c \\,\\boldsymbol{\\alpha} \\cdot \\mathbf{p} + \\beta \\, c^{2} + V(r)$. Three scalar relativistic methods are to be compared for the $1s$ level: the Zero-Order Regular Approximation (ZORA), the Douglas–Kroll–Hess method truncated at second order (DKH2), and the Exact Two-Component decoupling (X2C).  \n\n(a) Starting from the Dirac Hamiltonian for a Coulomb field, obtain the closed-form expression for the exact $1s$ energy $E_{\\mathrm{D}}(1s)$ and then expand it as a power series in $Z \\alpha$ up to and including terms of order $(Z \\alpha)^{4}$.  \n\n(b) Using first-principles reasoning about how each scalar relativistic method is constructed from the Dirac equation, determine, for the $1s$ level, the order in $(Z \\alpha)$ to which its scalar energy is guaranteed to agree with the exact Dirac energy, and hence the leading order in $(Z \\alpha)$ of its energy error relative to the exact Dirac value. State the leading error order for ZORA, DKH2, and X2C.  \n\n(c) Let $Z = 70$. Among ZORA, DKH2, and X2C, determine the smallest absolute scalar energy deviation from the exact Dirac $1s$ energy. Express this absolute deviation in Hartree. If any numerical rounding were required, you would round to four significant figures, but do not round unless necessary. Provide only the numerical value of this smallest deviation as your final answer.", "solution": "(a) The exact energy eigenvalues of the Dirac Hamiltonian for a hydrogen-like atom with nuclear charge $Z$ are given by the Sommerfeld fine-structure formula. In terms of the principal quantum number $n$ and the total angular momentum quantum number $j$, the total energy $E_{n,j}$ (including rest mass energy) is:\n$$E_{n,j} = m_e c^2 \\left[ 1 + \\left( \\frac{Z\\alpha}{n - (j+\\frac{1}{2}) + \\sqrt{(j+\\frac{1}{2})^2 - (Z\\alpha)^2}} \\right)^2 \\right]^{-\\frac{1}{2}}$$\nWe are working in Hartree atomic units where $m_e = 1$ and $c = 1/\\alpha$.\nFor the $1s$ state, the quantum numbers are $n=1$ and $j=1/2$. Substituting these values into the formula gives the energy for the $1s$ level, $E_{\\mathrm{D}}(1s)$:\n$$E_{\\mathrm{D}}(1s) = c^2 \\left[ 1 + \\left( \\frac{Z\\alpha}{1 - (1/2+\\frac{1}{2}) + \\sqrt{(1/2+\\frac{1}{2})^2 - (Z\\alpha)^2}} \\right)^2 \\right]^{-\\frac{1}{2}}$$\n$$E_{\\mathrm{D}}(1s) = c^2 \\left[ 1 + \\left( \\frac{Z\\alpha}{\\sqrt{1 - (Z\\alpha)^2}} \\right)^2 \\right]^{-\\frac{1}{2}} = c^2 \\left[ 1 + \\frac{(Z\\alpha)^2}{1 - (Z\\alpha)^2} \\right]^{-\\frac{1}{2}}$$\n$$E_{\\mathrm{D}}(1s) = c^2 \\left[ \\frac{1 - (Z\\alpha)^2 + (Z\\alpha)^2}{1 - (Z\\alpha)^2} \\right]^{-\\frac{1}{2}} = c^2 \\left[ \\frac{1}{1 - (Z\\alpha)^2} \\right]^{-\\frac{1}{2}}$$\nThe closed-form expression for the exact $1s$ energy is thus:\n$$E_{\\mathrm{D}}(1s) = c^2 \\sqrt{1 - (Z\\alpha)^2}$$\nTo expand this expression as a power series in $Z\\alpha$, we use the binomial expansion for $(1-x)^{1/2}$ where $x = (Z\\alpha)^2$:\n$$(1-x)^{\\frac{1}{2}} = 1 - \\frac{1}{2}x - \\frac{1}{8}x^2 - O(x^3)$$\nSubstituting $x=(Z\\alpha)^2$ yields:\n$$E_{\\mathrm{D}}(1s) = c^2 \\left( 1 - \\frac{1}{2}(Z\\alpha)^2 - \\frac{1}{8}(Z\\alpha)^4 - O((Z\\alpha)^6) \\right)$$\nThis is the required expansion up to terms of order $(Z\\alpha)^4$. Note that the binding energy, $E_{bind} = E_{\\mathrm{D}}(1s) - c^2$, expanded in powers of $Z$ and $\\alpha$ using $c^2\\alpha^2=1$, is $E_{bind} = -\\frac{1}{2}Z^2 - \\frac{1}{8}Z^4\\alpha^2 - \\dots$, which correctly reproduces the non-relativistic Schrödinger energy and the leading fine-structure correction.\n\n(b) The accuracy of scalar relativistic methods is determined by how well they approximate the exact decoupling of the electronic and positronic degrees of freedom of the Dirac equation. For the $1s$ state, there is no spin-orbit coupling, so a scalar relativistic method's accuracy is judged by its ability to reproduce the full Dirac energy.\n\nZORA: The Zero-Order Regular Approximation replaces the energy-dependent denominator in the exact one-component formulation with an energy-independent one by approximating $E-V \\approx 0$. This is a severe approximation, which leads to known deficiencies, including a gauge-dependence on the choice of potential zero. Even for the Coulomb potential, ZORA fails to correctly reproduce the leading relativistic correction of order $c^{-2}$. The ZORA energy is correct only to order $c^0$, meaning it gets the non-relativistic term right, but the first relativistic correction of order $(Z\\alpha)^4$ in the total energy is incorrect. Therefore, the leading order of its energy error is $\\mathcal{O}((Z\\alpha)^4)$.\n\nDKH2: The Douglas-Kroll-Hess method provides a systematic, perturbative way to decouple the Dirac Hamiltonian via a sequence of unitary transformations that successively remove coupling terms to higher orders in the external potential $V$. Truncating the procedure at second order (DKH2) yields a Hamiltonian that is correct through order $c^{-4}$ when its expectation value is taken. This means the DKH2 method correctly reproduces the Dirac energy expansion up to and including terms of order $(Z\\alpha)^6$ in the total energy. The first discrepancy appears at the next order. Thus, the leading order of the DKH2 energy error is $\\mathcal{O}((Z\\alpha)^8)$.\n\nX2C: The Exact Two-Component method, in principle (i.e., in the complete basis set limit), achieves an exact decoupling of the Dirac Hamiltonian in its matrix representation. The scalar relativistic version (sf-X2C) is then derived by neglecting spin-dependent operators from the decoupled electronic Hamiltonian. For a $1s$ state, the energy is independent of spin and there is no spin-orbit interaction ($l=0$). Therefore, the spin-dependent terms that sf-X2C neglects are already zero for this state. The sf-X2C Hamiltonian for the $1s$ state is thus equivalent to the fully relativistic decoupled Hamiltonian, and its eigenvalue must be identical to the exact Dirac eigenvalue, $E_{\\mathrm{D}}(1s)$. For this specific case, the X2C method is exact. The energy error is not a matter of order, but is identically zero.\n\nSummary of leading error orders in $(Z\\alpha)$:\n- ZORA: $\\mathcal{O}((Z\\alpha)^4)$\n- DKH2: $\\mathcal{O}((Z\\alpha)^8)$\n- X2C: zero error\n\n(c) Based on the analysis in part (b), the hierarchy of accuracy for the $1s$ state is ZORA < DKH2 < X2C. ZORA is the least accurate, DKH2 is significantly better, and X2C is exact for this particular case. The question asks for the smallest absolute scalar energy deviation from the exact Dirac $1s$ energy. This will be provided by the most accurate method, which is X2C. Since the sf-X2C energy for the $1s$ state is identical to the exact Dirac energy, the absolute deviation is exactly zero.\n$$\\Delta E_{\\mathrm{ZORA}} = |E_{\\mathrm{ZORA}} - E_{\\mathrm{D}}| > 0$$\n$$\\Delta E_{\\mathrm{DKH2}} = |E_{\\mathrm{DKH2}} - E_{\\mathrm{D}}| > 0$$\n$$\\Delta E_{\\mathrm{X2C}} = |E_{\\mathrm{X2C}} - E_{\\mathrm{D}}| = 0$$\nThe smallest of these deviations is $\\Delta E_{\\mathrm{X2C}}$.", "answer": "$$\n\\boxed{0}\n$$", "id": "2802892"}, {"introduction": "The ultimate test of a theoretical method is its ability to predict measurable chemical properties. This hands-on task [@problem_id:2802862] bridges the gap between abstract Hamiltonian theory and practical chemical application by modeling the atomization energy of a heavy-element molecule, $\\mathrm{PbCl_{2}}$. Using a framework that links relativistic energy shifts to changes in atomic orbital populations upon bonding, you will quantify how the known theoretical flaws of ZORA versus the higher accuracy of DKH3 translate directly into errors in a crucial thermochemical quantity.", "problem": "A neutral diatomic-like molecular system can be modeled at the scalar relativistic level by starting from the one-electron Dirac Hamiltonian for an electron in an external potential, which is given by $H_{\\mathrm{D}} = c\\,\\boldsymbol{\\alpha}\\cdot \\mathbf{p} + \\beta m c^{2} + V(\\mathbf{r})$. After a block-diagonalization and a Foldy–Wouthuysen type expansion, a scalar (spin-free) effective Hamiltonian to leading orders is obtained as $H_{\\mathrm{eff}} \\approx \\dfrac{\\mathbf{p}^{2}}{2m} + V(\\mathbf{r}) - \\dfrac{\\mathbf{p}^{4}}{8 m^{3} c^{2}} + \\dfrac{\\hbar^{2}}{8 m^{2} c^{2}} \\nabla^{2} V(\\mathbf{r})$, where the last two terms are the mass–velocity and Darwin corrections. Two widely used scalar relativistic approximations in theoretical chemistry are the Zero-Order Regular Approximation (ZORA) and the Douglas–Kroll–Hess (DKH) family. The DKH method yields a unitary-transformed Hamiltonian expanded to a finite order (here third order, DKH3), while ZORA replaces the exact energy-dependent denominator by an approximate local denominator of the form $2 m c^{2} - V(\\mathbf{r})$. Both approximations aim to reproduce the four-component reference (fully relativistic Dirac–Coulomb) results for scalar energies while avoiding explicit spinor structure.\n\nConsider the atomization energy, defined as $E_{\\mathrm{atom}} = \\sum_{A} E_{A} - E_{\\mathrm{mol}}$, where $E_{A}$ are energies of the isolated atomic fragments and $E_{\\mathrm{mol}}$ is the molecular energy. Suppose that the nonrelativistic (spin-free) baseline atomization energy is $E_{0}$, and that the scalar relativistic correction can be modeled, for each computational method, as a linear functional of angular-momentum-resolved populations localized on atomic centers:\n$$\n\\Delta E_{\\mathrm{SR}}^{\\mathrm{state}}(\\mathrm{method}) = \\sum_{X} \\sum_{\\ell} w^{(\\mathrm{method})}_{X,\\ell}\\, N^{(\\mathrm{state})}_{X,\\ell},\n$$\nwhere $X$ denotes the element ($\\mathrm{Pb}$ or $\\mathrm{Cl}$), $\\ell \\in \\{s,p\\}$ is the angular momentum channel, $w^{(\\mathrm{method})}_{X,\\ell}$ are per-electron scalar relativistic weights in $\\mathrm{kJ/mol}$ that encode the net effect of mass–velocity and Darwin contributions within the chosen approximation, and $N^{(\\mathrm{state})}_{X,\\ell}$ are channel populations in electrons for the given state (molecule or atom fragments). The method-specific atomization energy is then\n$$\nE_{\\mathrm{atom}}^{(\\mathrm{method})} = E_{0} + \\sum_{A} \\Delta E_{\\mathrm{SR}}^{(A)}(\\mathrm{method}) - \\Delta E_{\\mathrm{SR}}^{(\\mathrm{mol})}(\\mathrm{method}),\n$$\nwith the sum over fragments $A$.\n\nIn this problem, you will implement this model to compare the Zero-Order Regular Approximation (ZORA) and the third-order Douglas–Kroll–Hess (DKH3) approximations against a four-component reference for lead dichloride $\\mathrm{PbCl_{2}}$. You are given per-electron weights $w^{(\\mathrm{method})}_{X,\\ell}$ for the four-component reference, ZORA, and DKH3; atomic-fragment populations; and three molecular population sets representing distinct bonding scenarios. All energies must be expressed in $\\mathrm{kJ/mol}$ and all populations are electron counts.\n\nYou must:\n- Compute $E_{\\mathrm{atom}}^{(\\mathrm{ZORA})}$, $E_{\\mathrm{atom}}^{(\\mathrm{DKH3})}$, and $E_{\\mathrm{atom}}^{(\\mathrm{ref})}$ for each case using the formula above.\n- Compute absolute deviations from the four-component reference: $\\left|E_{\\mathrm{atom}}^{(\\mathrm{ZORA})} - E_{\\mathrm{atom}}^{(\\mathrm{ref})}\\right|$ and $\\left|E_{\\mathrm{atom}}^{(\\mathrm{DKH3})} - E_{\\mathrm{atom}}^{(\\mathrm{ref})}\\right|$.\n- Attribute the dominant source of ZORA deviation by comparing the ZORA–DKH3 gap and the DKH3–reference gap. Declare a boolean flag\n$$\nb_{\\mathrm{denom}} = \\left(\\left|E_{\\mathrm{atom}}^{(\\mathrm{ZORA})} - E_{\\mathrm{atom}}^{(\\mathrm{DKH3})}\\right| \\ge \\left|E_{\\mathrm{atom}}^{(\\mathrm{DKH3})} - E_{\\mathrm{atom}}^{(\\mathrm{ref})}\\right|\\right),\n$$\nwhich indicates whether the energy-denominator approximation (characteristic of ZORA) is the dominant contributor to ZORA’s total deviation (true) versus residual DKH3 truncation error (false).\n- Declare a second boolean flag\n$$\nb_{\\mathrm{DKH3\\_small}} = \\left(\\left|E_{\\mathrm{atom}}^{(\\mathrm{DKH3})} - E_{\\mathrm{atom}}^{(\\mathrm{ref})}\\right| \\le 3.0\\right),\n$$\nindicating whether the DKH3 truncation error is small (within $3.0\\,\\mathrm{kJ/mol}$).\n\nRound all reported energies and absolute deviations to one decimal place in $\\mathrm{kJ/mol}$.\n\nWeights (in $\\mathrm{kJ/mol}$ per electron):\n- Four-component reference:\n  - $\\mathrm{Pb}\\,s$: $-210.0$, $\\mathrm{Pb}\\,p$: $-35.0$, $\\mathrm{Cl}\\,p$: $-6.0$.\n- ZORA:\n  - $\\mathrm{Pb}\\,s$: $-235.0$, $\\mathrm{Pb}\\,p$: $-28.0$, $\\mathrm{Cl}\\,p$: $-5.0$.\n- DKH3:\n  - $\\mathrm{Pb}\\,s$: $-212.0$, $\\mathrm{Pb}\\,p$: $-34.0$, $\\mathrm{Cl}\\,p$: $-6.1$.\n\nAtomic fragment populations (electrons):\n- Combined fragments $\\mathrm{Pb} + 2\\,\\mathrm{Cl}$:\n  - $\\mathrm{Pb}\\,s$: $2.0$, $\\mathrm{Pb}\\,p$: $2.0$, $\\mathrm{Cl}\\,p$ (sum over two $\\mathrm{Cl}$ atoms): $10.0$.\n\nTest suite (three molecular cases; each case provides $E_{0}$ and molecular populations):\n- Case $1$ (balanced bonding):\n  - $E_{0} = 360.0$.\n  - Molecular populations: $\\mathrm{Pb}\\,s = 1.8$, $\\mathrm{Pb}\\,p = 0.5$, $\\mathrm{Cl}\\,p = 11.7$.\n- Case $2$ (enhanced $\\mathrm{Pb}\\,s$ character):\n  - $E_{0} = 350.0$.\n  - Molecular populations: $\\mathrm{Pb}\\,s = 2.2$, $\\mathrm{Pb}\\,p = 0.2$, $\\mathrm{Cl}\\,p = 11.6$.\n- Case $3$ (ionic limit-like):\n  - $E_{0} = 340.0$.\n  - Molecular populations: $\\mathrm{Pb}\\,s = 2.0$, $\\mathrm{Pb}\\,p = 0.0$, $\\mathrm{Cl}\\,p = 12.0$.\n\nYour program must compute, for each case, a list of the form\n$[E_{\\mathrm{atom}}^{(\\mathrm{ZORA})}, E_{\\mathrm{atom}}^{(\\mathrm{DKH3})}, E_{\\mathrm{atom}}^{(\\mathrm{ref})}, \\left|E_{\\mathrm{atom}}^{(\\mathrm{ZORA})} - E_{\\mathrm{atom}}^{(\\mathrm{ref})}\\right|, \\left|E_{\\mathrm{atom}}^{(\\mathrm{DKH3})} - E_{\\mathrm{atom}}^{(\\mathrm{ref})}\\right|, b_{\\mathrm{denom}}, b_{\\mathrm{DKH3\\_small}}]$, where all energies are rounded to one decimal place in $\\mathrm{kJ/mol}$ and the booleans are as defined above.\n\nFinal output format: Your program should produce a single line of output containing the results as a comma-separated list of the three per-case lists, enclosed in square brackets (for example, $[[\\cdots],[\\cdots],[\\cdots]]$). No other text should be printed.", "solution": "The core task is to compute the atomization energy, $E_{\\mathrm{atom}}$, for the $\\mathrm{PbCl_{2}}$ molecule using three different relativistic methods (a four-component reference, ZORA, and DKH3), and to analyze the deviations. The atomization energy for a given method is defined as:\n$$\nE_{\\mathrm{atom}}^{(\\mathrm{method})} = E_{0} + \\sum_{A} \\Delta E_{\\mathrm{SR}}^{(A)}(\\mathrm{method}) - \\Delta E_{\\mathrm{SR}}^{(\\mathrm{mol})}(\\mathrm{method})\n$$\nwhere $E_{0}$ is the nonrelativistic atomization energy, $\\Delta E_{\\mathrm{SR}}^{(\\mathrm{mol})}$ is the scalar relativistic correction for the molecule, and $\\sum_{A} \\Delta E_{\\mathrm{SR}}^{(A)}$ is the sum of corrections for the atomic fragments. This latter term is calculated for the combined fragments $\\mathrm{Pb} + 2\\,\\mathrm{Cl}$ and will be denoted $\\Delta E_{\\mathrm{SR}}^{(\\mathrm{frag})}$.\n\nThe relativistic correction for any state (molecule or fragments) is given by a linear model:\n$$\n\\Delta E_{\\mathrm{SR}}^{\\mathrm{state}}(\\mathrm{method}) = \\sum_{X, \\ell} w^{(\\mathrm{method})}_{X,\\ell}\\, N^{(\\mathrm{state})}_{X,\\ell}\n$$\nHere, $X$ is the element ($\\mathrm{Pb}$ or $\\mathrm{Cl}$), $\\ell$ is the angular momentum quantum number ($s$ or $p$), $w^{(\\mathrm{method})}_{X,\\ell}$ are the method-specific energy weights per electron, and $N^{(\\mathrm{state})}_{X,\\ell}$ are the corresponding electron populations in the given state.\n\nThe total relativistic correction to the atomization energy, $\\Delta E_{\\mathrm{atom, SR}}$, can therefore be expressed as the difference in the corrections for the fragment and molecular states:\n$$\n\\Delta E_{\\mathrm{atom, SR}}^{(\\mathrm{method})} = \\Delta E_{\\mathrm{SR}}^{(\\mathrm{frag})}(\\mathrm{method}) - \\Delta E_{\\mathrm{SR}}^{(\\mathrm{mol})}(\\mathrm{method}) = \\sum_{X, \\ell} w^{(\\mathrm{method})}_{X,\\ell} \\left( N^{(\\mathrm{frag})}_{X,\\ell} - N^{(\\mathrm{mol})}_{X,\\ell} \\right)\n$$\nLet us define the change in electron population upon bonding as $\\Delta N_{X,\\ell} = N^{(\\mathrm{frag})}_{X,\\ell} - N^{(\\mathrm{mol})}_{X,\\ell}$. The calculation proceeds as follows for each of the three test cases.\n\nThe fragment populations are given as: $N^{(\\mathrm{frag})}_{\\mathrm{Pb},s} = 2.0$, $N^{(\\mathrm{frag})}_{\\mathrm{Pb},p} = 2.0$, and $N^{(\\mathrm{frag})}_{\\mathrm{Cl},p} = 10.0$.\nThe method-specific weights $w^{(\\mathrm{method})}_{X,\\ell}$ (in $\\mathrm{kJ/mol}$) are provided for the reference (ref), ZORA, and DKH3 methods.\n\n**Case 1: Balanced bonding**\n- $E_{0} = 360.0 \\, \\mathrm{kJ/mol}$\n- Molecular populations: $N^{(\\mathrm{mol})}_{\\mathrm{Pb},s} = 1.8$, $N^{(\\mathrm{mol})}_{\\mathrm{Pb},p} = 0.5$, $N^{(\\mathrm{mol})}_{\\mathrm{Cl},p} = 11.7$.\n- Population changes:\n  - $\\Delta N_{\\mathrm{Pb},s} = 2.0 - 1.8 = 0.2$\n  - $\\Delta N_{\\mathrm{Pb},p} = 2.0 - 0.5 = 1.5$\n  - $\\Delta N_{\\mathrm{Cl},p} = 10.0 - 11.7 = -1.7$\n- Relativistic corrections to atomization energy:\n  - $\\Delta E_{\\mathrm{atom, SR}}^{(\\mathrm{ref})} = (-210.0)(0.2) + (-35.0)(1.5) + (-6.0)(-1.7) = -42.0 - 52.5 + 10.2 = -84.3 \\, \\mathrm{kJ/mol}$\n  - $\\Delta E_{\\mathrm{atom, SR}}^{(\\mathrm{ZORA})} = (-235.0)(0.2) + (-28.0)(1.5) + (-5.0)(-1.7) = -47.0 - 42.0 + 8.5 = -80.5 \\, \\mathrm{kJ/mol}$\n  - $\\Delta E_{\\mathrm{atom, SR}}^{(\\mathrm{DKH3})} = (-212.0)(0.2) + (-34.0)(1.5) + (-6.1)(-1.7) = -42.4 - 51.0 + 10.37 = -83.03 \\, \\mathrm{kJ/mol}$\n- Atomization energies:\n  - $E_{\\mathrm{atom}}^{(\\mathrm{ref})} = 360.0 - 84.3 = 275.7 \\, \\mathrm{kJ/mol}$\n  - $E_{\\mathrm{atom}}^{(\\mathrm{ZORA})} = 360.0 - 80.5 = 279.5 \\, \\mathrm{kJ/mol}$\n  - $E_{\\mathrm{atom}}^{(\\mathrm{DKH3})} = 360.0 - 83.03 = 276.97 \\, \\mathrm{kJ/mol}$\n- Deviations and flags:\n  - $\\left|E_{\\mathrm{atom}}^{(\\mathrm{ZORA})} - E_{\\mathrm{atom}}^{(\\mathrm{ref})}\\right| = |279.5 - 275.7| = 3.8 \\, \\mathrm{kJ/mol}$\n  - $\\left|E_{\\mathrm{atom}}^{(\\mathrm{DKH3})} - E_{\\mathrm{atom}}^{(\\mathrm{ref})}\\right| = |276.97 - 275.7| = 1.27 \\, \\mathrm{kJ/mol}$\n  - $b_{\\mathrm{denom}} = (|279.5 - 276.97| \\ge |276.97 - 275.7|) = (2.53 \\ge 1.27) \\rightarrow \\mathrm{True}$\n  - $b_{\\mathrm{DKH3\\_small}} = (1.27 \\le 3.0) \\rightarrow \\mathrm{True}$\n- Result list (rounded): $[279.5, 277.0, 275.7, 3.8, 1.3, \\mathrm{True}, \\mathrm{True}]$\n\n**Case 2: Enhanced $\\mathrm{Pb}\\,s$ character**\n- $E_{0} = 350.0 \\, \\mathrm{kJ/mol}$\n- Molecular populations: $N^{(\\mathrm{mol})}_{\\mathrm{Pb},s} = 2.2$, $N^{(\\mathrm{mol})}_{\\mathrm{Pb},p} = 0.2$, $N^{(\\mathrm{mol})}_{\\mathrm{Cl},p} = 11.6$.\n- Population changes:\n  - $\\Delta N_{\\mathrm{Pb},s} = 2.0 - 2.2 = -0.2$\n  - $\\Delta N_{\\mathrm{Pb},p} = 2.0 - 0.2 = 1.8$\n  - $\\Delta N_{\\mathrm{Cl},p} = 10.0 - 11.6 = -1.6$\n- Relativistic corrections:\n  - $\\Delta E_{\\mathrm{atom, SR}}^{(\\mathrm{ref})} = (-210.0)(-0.2) + (-35.0)(1.8) + (-6.0)(-1.6) = 42.0 - 63.0 + 9.6 = -11.4 \\, \\mathrm{kJ/mol}$\n  - $\\Delta E_{\\mathrm{atom, SR}}^{(\\mathrm{ZORA})} = (-235.0)(-0.2) + (-28.0)(1.8) + (-5.0)(-1.6) = 47.0 - 50.4 + 8.0 = 4.6 \\, \\mathrm{kJ/mol}$\n  - $\\Delta E_{\\mathrm{atom, SR}}^{(\\mathrm{DKH3})} = (-212.0)(-0.2) + (-34.0)(1.8) + (-6.1)(-1.6) = 42.4 - 61.2 + 9.76 = -9.04 \\, \\mathrm{kJ/mol}$\n- Atomization energies:\n  - $E_{\\mathrm{atom}}^{(\\mathrm{ref})} = 350.0 - 11.4 = 338.6 \\, \\mathrm{kJ/mol}$\n  - $E_{\\mathrm{atom}}^{(\\mathrm{ZORA})} = 350.0 + 4.6 = 354.6 \\, \\mathrm{kJ/mol}$\n  - $E_{\\mathrm{atom}}^{(\\mathrm{DKH3})} = 350.0 - 9.04 = 340.96 \\, \\mathrm{kJ/mol}$\n- Deviations and flags:\n  - $\\left|E_{\\mathrm{atom}}^{(\\mathrm{ZORA})} - E_{\\mathrm{atom}}^{(\\mathrm{ref})}\\right| = |354.6 - 338.6| = 16.0 \\, \\mathrm{kJ/mol}$\n  - $\\left|E_{\\mathrm{atom}}^{(\\mathrm{DKH3})} - E_{\\mathrm{atom}}^{(\\mathrm{ref})}\\right| = |340.96 - 338.6| = 2.36 \\, \\mathrm{kJ/mol}$\n  - $b_{\\mathrm{denom}} = (|354.6 - 340.96| \\ge |340.96 - 338.6|) = (13.64 \\ge 2.36) \\rightarrow \\mathrm{True}$\n  - $b_{\\mathrm{DKH3\\_small}} = (2.36 \\le 3.0) \\rightarrow \\mathrm{True}$\n- Result list (rounded): $[354.6, 341.0, 338.6, 16.0, 2.4, \\mathrm{True}, \\mathrm{True}]$\n\n**Case 3: Ionic limit-like**\n- $E_{0} = 340.0 \\, \\mathrm{kJ/mol}$\n- Molecular populations: $N^{(\\mathrm{mol})}_{\\mathrm{Pb},s} = 2.0$, $N^{(\\mathrm{mol})}_{\\mathrm{Pb},p} = 0.0$, $N^{(\\mathrm{mol})}_{\\mathrm{Cl},p} = 12.0$.\n- Population changes:\n  - $\\Delta N_{\\mathrm{Pb},s} = 2.0 - 2.0 = 0.0$\n  - $\\Delta N_{\\mathrm{Pb},p} = 2.0 - 0.0 = 2.0$\n  - $\\Delta N_{\\mathrm{Cl},p} = 10.0 - 12.0 = -2.0$\n- Relativistic corrections:\n  - $\\Delta E_{\\mathrm{atom, SR}}^{(\\mathrm{ref})} = (-210.0)(0.0) + (-35.0)(2.0) + (-6.0)(-2.0) = -70.0 + 12.0 = -58.0 \\, \\mathrm{kJ/mol}$\n  - $\\Delta E_{\\mathrm{atom, SR}}^{(\\mathrm{ZORA})} = (-235.0)(0.0) + (-28.0)(2.0) + (-5.0)(-2.0) = -56.0 + 10.0 = -46.0 \\, \\mathrm{kJ/mol}$\n  - $\\Delta E_{\\mathrm{atom, SR}}^{(\\mathrm{DKH3})} = (-212.0)(0.0) + (-34.0)(2.0) + (-6.1)(-2.0) = -68.0 + 12.2 = -55.8 \\, \\mathrm{kJ/mol}$\n- Atomization energies:\n  - $E_{\\mathrm{atom}}^{(\\mathrm{ref})} = 340.0 - 58.0 = 282.0 \\, \\mathrm{kJ/mol}$\n  - $E_{\\mathrm{atom}}^{(\\mathrm{ZORA})} = 340.0 - 46.0 = 294.0 \\, \\mathrm{kJ/mol}$\n  - $E_{\\mathrm{atom}}^{(\\mathrm{DKH3})} = 340.0 - 55.8 = 284.2 \\, \\mathrm{kJ/mol}$\n- Deviations and flags:\n  - $\\left|E_{\\mathrm{atom}}^{(\\mathrm{ZORA})} - E_{\\mathrm{atom}}^{(\\mathrm{ref})}\\right| = |294.0 - 282.0| = 12.0 \\, \\mathrm{kJ/mol}$\n  - $\\left|E_{\\mathrm{atom}}^{(\\mathrm{DKH3})} - E_{\\mathrm{atom}}^{(\\mathrm{ref})}\\right| = |284.2 - 282.0| = 2.2 \\, \\mathrm{kJ/mol}$\n  - $b_{\\mathrm{denom}} = (|294.0 - 284.2| \\ge |284.2 - 282.0|) = (9.8 \\ge 2.2) \\rightarrow \\mathrm{True}$\n  - $b_{\\mathrm{DKH3\\_small}} = (2.2 \\le 3.0) \\rightarrow \\mathrm{True}$\n- Result list (rounded): $[294.0, 284.2, 282.0, 12.0, 2.2, \\mathrm{True}, \\mathrm{True}]$\n\nThe calculations demonstrate that for the given model, the DKH3 approximation provides results consistently close to the four-component reference. The ZORA method shows larger deviations, particularly when the change in the lead $s$-orbital population is significant (Cases 1 and 2). The analysis confirms that the primary source of ZORA's deviation from the reference is its intrinsic methodological approximation rather than the residual truncation error also present in DKH3, as indicated by $b_{\\mathrm{denom}}$ being true in all cases.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes and compares atomization energies for PbCl2 using ZORA, DKH3,\n    and a reference method based on a linear model of relativistic effects.\n    \"\"\"\n\n    # Per-electron scalar relativistic weights (kJ/mol)\n    weights = {\n        'ref':  {'Pb_s': -210.0, 'Pb_p': -35.0, 'Cl_p': -6.0},\n        'zora': {'Pb_s': -235.0, 'Pb_p': -28.0, 'Cl_p': -5.0},\n        'dkh3': {'Pb_s': -212.0, 'Pb_p': -34.0, 'Cl_p': -6.1}\n    }\n\n    # Atomic fragment populations (Pb + 2Cl)\n    frag_pops = {'Pb_s': 2.0, 'Pb_p': 2.0, 'Cl_p': 10.0}\n\n    # Test suite: (E0, molecular populations)\n    test_cases = [\n        # Case 1: balanced bonding\n        (360.0, {'Pb_s': 1.8, 'Pb_p': 0.5, 'Cl_p': 11.7}),\n        # Case 2: enhanced Pb s character\n        (350.0, {'Pb_s': 2.2, 'Pb_p': 0.2, 'Cl_p': 11.6}),\n        # Case 3: ionic limit-like\n        (340.0, {'Pb_s': 2.0, 'Pb_p': 0.0, 'Cl_p': 12.0})\n    ]\n\n    all_results = []\n\n    for E0, mol_pops in test_cases:\n        # Calculate population changes (frag - mol)\n        delta_pops = {\n            'Pb_s': frag_pops['Pb_s'] - mol_pops['Pb_s'],\n            'Pb_p': frag_pops['Pb_p'] - mol_pops['Pb_p'],\n            'Cl_p': frag_pops['Cl_p'] - mol_pops['Cl_p']\n        }\n\n        # Calculate atomization energies for each method\n        E_atom = {}\n        for method in ['ref', 'zora', 'dkh3']:\n            w = weights[method]\n            delta_E_sr = (w['Pb_s'] * delta_pops['Pb_s'] +\n                          w['Pb_p'] * delta_pops['Pb_p'] +\n                          w['Cl_p'] * delta_pops['Cl_p'])\n            E_atom[method] = E0 + delta_E_sr\n\n        # Extract energies for clarity\n        E_ref = E_atom['ref']\n        E_zora = E_atom['zora']\n        E_dkh3 = E_atom['dkh3']\n\n        # Compute absolute deviations from reference\n        dev_zora = abs(E_zora - E_ref)\n        dev_dkh3 = abs(E_dkh3 - E_ref)\n\n        # Compute boolean flags\n        # b_denom: is ZORA's own approximation error dominant?\n        zora_dkh3_gap = abs(E_zora - E_dkh3)\n        dkh3_ref_gap = abs(E_dkh3 - E_ref)\n        b_denom = zora_dkh3_gap >= dkh3_ref_gap\n\n        # b_dkh3_small: is DKH3 truncation error small?\n        b_dkh3_small = dev_dkh3 <= 3.0\n\n        # Assemble the list of results for the current case\n        case_results = [\n            E_zora,\n            E_dkh3,\n            E_ref,\n            dev_zora,\n            dev_dkh3,\n            b_denom,\n            b_dkh3_small\n        ]\n        all_results.append(case_results)\n\n    # Format the final output string as a list of lists with no spaces\n    output_lists_str = []\n    for res_list in all_results:\n        # Format numbers to one decimal place, and bools as standard 'True'/'False'\n        items_str = [\n            f\"{item:.1f}\" if isinstance(item, (float, int)) else str(item)\n            for item in res_list\n        ]\n        output_lists_str.append(f\"[{','.join(items_str)}]\")\n    \n    final_output_str = f\"[{','.join(output_lists_str)}]\"\n    print(final_output_str)\n\nsolve()\n```", "id": "2802862"}]}