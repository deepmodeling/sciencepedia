{"hands_on_practices": [{"introduction": "Before simulating the complex motion of a wavepacket—a superposition of many states—we must first understand the behavior of the system's fundamental building blocks: its energy eigenstates. This foundational exercise explores the time evolution of a system prepared in a single eigenstate, specifically the ground state of a harmonic potential, revealing the nature of a \"stationary state\" whose probability density $|\\Psi(R,t)|^2$ remains constant [@problem_id:2799407]. Mastering this simple case solidifies the link between the time-dependent and time-independent Schrödinger equations and establishes a crucial baseline for studying more complex dynamics.", "problem": "In the Born–Oppenheimer approximation for a diatomic molecule projected onto a single adiabatic potential energy surface near its minimum, the nuclear motion along the internuclear separation coordinate $R$ can be modeled as a quantum particle of mass $M$ in a harmonic potential $V(R)=\\frac{1}{2}M\\omega^{2}R^{2}$. Consider the time-dependent Schrödinger equation (TDSE) for the nuclear wavefunction $\\psi(R,t)$ with a time-independent Hamiltonian $\\hat{H}=-\\frac{\\hbar^{2}}{2M}\\frac{\\partial^{2}}{\\partial R^{2}}+\\frac{1}{2}M\\omega^{2}R^{2}$. At time $t=0$, the nuclear wavepacket is prepared exactly in the harmonic oscillator ground state of $\\hat{H}$.\n\nStarting only from the TDSE and the definition of energy eigenstates for time-independent Hamiltonians, derive why the wavepacket $\\psi(R,t)$ is stationary up to a global phase. Then compute the explicit closed-form expression for that global phase factor in terms of $\\omega$ and $t$, using only fundamental constants and symbols. Your answer must be the isolated global phase factor as a single analytic expression. Do not include normalization constants, and do not include units. No numerical rounding is required because the final result is symbolic.", "solution": "We begin from the time-dependent Schrödinger equation (TDSE) for a time-independent Hamiltonian,\n$$\n\\mathrm{i}\\hbar\\,\\frac{\\partial}{\\partial t}\\,\\psi(R,t)=\\hat{H}\\,\\psi(R,t),\n$$\nwith\n$$\n\\hat{H}=-\\frac{\\hbar^{2}}{2M}\\frac{\\partial^{2}}{\\partial R^{2}}+\\frac{1}{2}M\\omega^{2}R^{2}.\n$$\nFundamentally, for any time-independent Hamiltonian $\\hat{H}$, its energy eigenstates $\\{\\phi_{n}(R)\\}$ satisfy the time-independent Schrödinger equation\n$$\n\\hat{H}\\,\\phi_{n}(R)=E_{n}\\,\\phi_{n}(R),\n$$\nwith real eigenvalues $E_{n}$. If the initial state is a single eigenstate, $\\psi(R,0)=\\phi_{n}(R)$, we can seek a solution of the TDSE of the separable form\n$$\n\\psi(R,t)=c_{n}(t)\\,\\phi_{n}(R).\n$$\nSubstituting this ansatz into the TDSE and using $\\hat{H}\\,\\phi_{n}=E_{n}\\phi_{n}$ gives\n$$\n\\mathrm{i}\\hbar\\,\\dot{c}_{n}(t)\\,\\phi_{n}(R)=c_{n}(t)\\,E_{n}\\,\\phi_{n}(R),\n$$\nwhich, after canceling $\\phi_{n}(R)$ (nonzero for an eigenfunction), reduces to the ordinary differential equation\n$$\n\\mathrm{i}\\hbar\\,\\dot{c}_{n}(t)=E_{n}\\,c_{n}(t).\n$$\nThis integrates immediately to\n$$\nc_{n}(t)=\\exp\\!\\left(-\\frac{\\mathrm{i}E_{n}t}{\\hbar}\\right)c_{n}(0).\n$$\nImposing the initial condition $c_{n}(0)=1$ to match $\\psi(R,0)=\\phi_{n}(R)$ gives\n$$\n\\psi(R,t)=\\phi_{n}(R)\\,\\exp\\!\\left(-\\frac{\\mathrm{i}E_{n}t}{\\hbar}\\right).\n$$\nTherefore the probability density $|\\psi(R,t)|^{2}=|\\phi_{n}(R)|^{2}$ is time-independent, and the state is stationary up to a global phase factor $\\exp(-\\mathrm{i}E_{n}t/\\hbar)$.\n\nIt remains to identify $E_{n}$ for the harmonic oscillator ground state. For the quantum harmonic oscillator with mass $M$ and frequency $\\omega$, the spectrum is the well-tested result\n$$\nE_{n}=\\hbar\\omega\\left(n+\\frac{1}{2}\\right),\\quad n=0,1,2,\\dots\n$$\nIn particular, the ground state energy is\n$$\nE_{0}=\\frac{1}{2}\\hbar\\omega.\n$$\nThus, for the preparation $\\psi(R,0)=\\phi_{0}(R)$, the time evolution is\n$$\n\\psi(R,t)=\\phi_{0}(R)\\,\\exp\\!\\left(-\\frac{\\mathrm{i}}{\\hbar}\\,\\frac{1}{2}\\hbar\\omega\\,t\\right)\n=\\phi_{0}(R)\\,\\exp\\!\\left(-\\frac{\\mathrm{i}\\omega t}{2}\\right).\n$$\nHence, the wavepacket is stationary up to the global phase factor\n$$\n\\exp\\!\\left(-\\frac{\\mathrm{i}\\omega t}{2}\\right).\n$$\nThis factor is dimensionless and depends only on $\\omega$ and $t$.", "answer": "$$\\boxed{\\exp\\!\\left(-\\frac{\\mathrm{i}\\,\\omega\\,t}{2}\\right)}$$", "id": "2799407"}, {"introduction": "Real molecular processes, such as photochemical reactions, often involve multiple interacting electronic states, a scenario where the simplest Born-Oppenheimer picture can break down. This theoretical practice guides you beyond a single potential energy surface to explore how these states interact [@problem_id:2799435]. You will derive the physically observable adiabatic surfaces and, crucially, the non-adiabatic coupling terms that arise from the nuclear-derivative of the electronic wavefunctions, which are the very terms responsible for driving transitions between states.", "problem": "Consider a one-dimensional nuclear coordinate $Q$ of mass $M$ coupled to two diabatic electronic states by linear vibronic coupling. The vibronic Hamiltonian is\n$$\n\\hat{H} \\;=\\; \\hat{T}_n \\otimes \\mathbf{1}_2 \\;+\\; \\hat{H}_d(Q),\n$$\nwhere the nuclear kinetic energy operator is $\\hat{T}_n \\,=\\, -\\dfrac{\\hbar^2}{2M}\\dfrac{\\partial^2}{\\partial Q^2}$, $\\mathbf{1}_2$ is the $2\\times 2$ identity, and the diabatic electronic Hamiltonian is\n$$\n\\hat{H}_d(Q) \\;=\\; \\begin{pmatrix}\nV_0 + \\kappa Q & \\lambda \\\\\n\\lambda & V_0 - \\kappa Q\n\\end{pmatrix},\n$$\nwith real constants $V_0$, $\\kappa$, and $\\lambda$. The diabatic basis vectors are taken to be independent of $Q$ and real.\n\nUsing only foundational principles of the adiabatic representation for coupled electron–nuclear motion (e.g., the parametric electronic problem at fixed $Q$ and the effect of $Q$-dependent basis rotations on the nuclear kinetic energy), perform a $Q$-dependent real orthogonal transformation that diagonalizes the electronic Hamiltonian at each $Q$ to define the adiabatic electronic states $\\{|\\phi_+(Q)\\rangle, |\\phi_-(Q)\\rangle\\}$ and their adiabatic potential energy surfaces $E_{\\pm}(Q)$. Adopt the phase and ordering convention\n$$\n\\begin{pmatrix}\n|\\phi_+(Q)\\rangle \\\\\n|\\phi_-(Q)\\rangle\n\\end{pmatrix}\n\\;=\\;\n\\begin{pmatrix}\n\\cos\\theta(Q) & \\sin\\theta(Q) \\\\\n-\\sin\\theta(Q) & \\cos\\theta(Q)\n\\end{pmatrix}\n\\begin{pmatrix}\n|\\chi_1\\rangle \\\\\n|\\chi_2\\rangle\n\\end{pmatrix},\n$$\nwhere $\\{|\\chi_1\\rangle, |\\chi_2\\rangle\\}$ is the diabatic basis.\n\nDerive:\n1) The adiabatic potential energy surfaces $E_{\\pm}(Q)$.\n2) The mixing angle $\\theta(Q)$ that achieves the diagonalization.\n3) The scalar nonadiabatic derivative coupling between the adiabatic states, defined by\n$$\n\\tau_{12}(Q) \\;=\\; \\big\\langle \\phi_-(Q) \\big| \\dfrac{\\partial}{\\partial Q} \\big| \\phi_+(Q) \\big\\rangle.\n$$\n\nShow all steps starting from the definitions above and the requirement that the electronic Hamiltonian be diagonal in the adiabatic basis. As your final answer, report the closed-form analytic expression for $\\tau_{12}(Q)$ in terms of $\\kappa$, $\\lambda$, and $Q$ only. Do not include numerical values or units in the final answer.", "solution": "The problem as stated is scientifically sound, self-contained, and well-posed. It represents a standard and fundamental exercise in the theory of nonadiabatic transitions in molecular systems, specifically the linear vibronic coupling model. All necessary information is provided, and the objectives are clearly defined. Therefore, we proceed with the derivation.\n\nThe core of the problem is the diagonalization of the $Q$-dependent diabatic electronic Hamiltonian $\\hat{H}_d(Q)$. The adiabatic potential energy surfaces $E_{\\pm}(Q)$ are the eigenvalues of this matrix, and the adiabatic electronic states $\\{|\\phi_{\\pm}(Q)\\rangle\\}$ are the corresponding eigenvectors.\n\nThe diabatic electronic Hamiltonian is given by:\n$$\n\\hat{H}_d(Q) \\;=\\; \\begin{pmatrix}\nV_0 + \\kappa Q & \\lambda \\\\\n\\lambda & V_0 - \\kappa Q\n\\end{pmatrix}\n$$\n\n1) Derivation of the adiabatic potential energy surfaces $E_{\\pm}(Q)$.\n\nThe eigenvalues $E$ are found by solving the characteristic equation $\\det(\\hat{H}_d(Q) - E\\mathbf{1}_2) = 0$.\n$$\n\\det \\begin{pmatrix} V_0 + \\kappa Q - E & \\lambda \\\\ \\lambda & V_0 - \\kappa Q - E \\end{pmatrix} \\;=\\; 0\n$$\n$$\n(V_0 + \\kappa Q - E)(V_0 - \\kappa Q - E) - \\lambda^2 \\;=\\; 0\n$$\nThis can be rearranged as:\n$$\n((V_0 - E) + \\kappa Q)((V_0 - E) - \\kappa Q) - \\lambda^2 \\;=\\; 0\n$$\n$$\n(V_0 - E)^2 - (\\kappa Q)^2 - \\lambda^2 \\;=\\; 0\n$$\n$$\n(V_0 - E)^2 \\;=\\; \\kappa^2 Q^2 + \\lambda^2\n$$\nTaking the square root of both sides yields:\n$$\nV_0 - E \\;=\\; \\pm \\sqrt{\\kappa^2 Q^2 + \\lambda^2}\n$$\nSolving for $E$ gives the two eigenvalues, which are the adiabatic potential energy surfaces. Adhering to the convention $E_+ > E_-$, we identify:\n$$\nE_+(Q) \\;=\\; V_0 + \\sqrt{\\kappa^2 Q^2 + \\lambda^2}\n$$\n$$\nE_-(Q) \\;=\\; V_0 - \\sqrt{\\kappa^2 Q^2 + \\lambda^2}\n$$\n\n2) Derivation of the mixing angle $\\theta(Q)$.\n\nThe adiabatic states $\\{|\\phi_+(Q)\\rangle, |\\phi_-(Q)\\rangle\\}$ are related to the diabatic basis $\\{|\\chi_1\\rangle, |\\chi_2\\rangle\\}$ by the real orthogonal transformation provided:\n$$\n\\mathbf{U}(Q) = \\begin{pmatrix} \\cos\\theta(Q) & \\sin\\theta(Q) \\\\ -\\sin\\theta(Q) & \\cos\\theta(Q) \\end{pmatrix}\n$$\nThe transformation diagonalizes $\\hat{H}_d(Q)$:\n$$\n\\hat{H}_a(Q) = \\mathbf{U}(Q) \\hat{H}_d(Q) \\mathbf{U}^T(Q) = \\begin{pmatrix} E_+(Q) & 0 \\\\ 0 & E_-(Q) \\end{pmatrix}\n$$\nThe condition that the off-diagonal elements of the transformed Hamiltonian $\\hat{H}_a(Q)$ are zero determines the mixing angle $\\theta(Q)$. Let us compute the $(2,1)$ element of $\\hat{H}_a(Q)$, which is $\\langle \\phi_-(Q) | \\hat{H}_d(Q) | \\phi_+(Q) \\rangle$.\n$$\n(\\hat{H}_a)_{21} \\;=\\; \\begin{pmatrix} -\\sin\\theta & \\cos\\theta \\end{pmatrix} \\begin{pmatrix} V_0 + \\kappa Q & \\lambda \\\\ \\lambda & V_0 - \\kappa Q \\end{pmatrix} \\begin{pmatrix} \\cos\\theta \\\\ \\sin\\theta \\end{pmatrix} \\;=\\; 0\n$$\n$$\n\\begin{pmatrix} -\\sin\\theta & \\cos\\theta \\end{pmatrix} \\begin{pmatrix} (V_0 + \\kappa Q)\\cos\\theta + \\lambda\\sin\\theta \\\\ \\lambda\\cos\\theta + (V_0 - \\kappa Q)\\sin\\theta \\end{pmatrix} \\;=\\; 0\n$$\n$$\n-\\sin\\theta((V_0 + \\kappa Q)\\cos\\theta + \\lambda\\sin\\theta) + \\cos\\theta(\\lambda\\cos\\theta + (V_0 - \\kappa Q)\\sin\\theta) \\;=\\; 0\n$$\nExpanding and collecting terms:\n$$\n(-V_0\\sin\\theta\\cos\\theta - \\kappa Q\\sin\\theta\\cos\\theta - \\lambda\\sin^2\\theta) + (\\lambda\\cos^2\\theta + V_0\\sin\\theta\\cos\\theta - \\kappa Q\\sin\\theta\\cos\\theta) \\;=\\; 0\n$$\n$$\n\\lambda(\\cos^2\\theta - \\sin^2\\theta) - 2\\kappa Q\\sin\\theta\\cos\\theta \\;=\\; 0\n$$\nUsing the double-angle trigonometric identities, $\\cos(2\\theta) = \\cos^2\\theta - \\sin^2\\theta$ and $\\sin(2\\theta) = 2\\sin\\theta\\cos\\theta$, we obtain:\n$$\n\\lambda\\cos(2\\theta) - \\kappa Q\\sin(2\\theta) \\;=\\; 0\n$$\nThis gives a direct relationship for the mixing angle:\n$$\n\\tan(2\\theta(Q)) \\;=\\; \\frac{\\lambda}{\\kappa Q}\n$$\nFrom this, the mixing angle is explicitly:\n$$\n\\theta(Q) \\;=\\; \\frac{1}{2} \\arctan\\left(\\frac{\\lambda}{\\kappa Q}\\right)\n$$\n\n3) Derivation of the nonadiabatic derivative coupling $\\tau_{12}(Q)$.\n\nThe scalar nonadiabatic derivative coupling is defined as:\n$$\n\\tau_{12}(Q) \\;=\\; \\big\\langle \\phi_-(Q) \\big| \\dfrac{\\partial}{\\partial Q} \\big| \\phi_+(Q) \\big\\rangle\n$$\nWe must first compute the derivative of the adiabatic state $|\\phi_+(Q)\\rangle$ with respect to the nuclear coordinate $Q$. From the given transformation:\n$$\n|\\phi_+(Q)\\rangle \\;=\\; \\cos\\theta(Q)|\\chi_1\\rangle + \\sin\\theta(Q)|\\chi_2\\rangle\n$$\nSince the diabatic basis $\\{|\\chi_i\\rangle\\}$ is independent of $Q$, the derivative acts only on the coefficients:\n$$\n\\frac{\\partial}{\\partial Q} |\\phi_+(Q)\\rangle \\;=\\; \\frac{\\partial}{\\partial Q}(\\cos\\theta(Q))|\\chi_1\\rangle + \\frac{\\partial}{\\partial Q}(\\sin\\theta(Q))|\\chi_2\\rangle\n$$\n$$\n\\frac{\\partial}{\\partial Q} |\\phi_+(Q)\\rangle \\;=\\; \\left(-\\sin\\theta(Q) \\frac{d\\theta}{dQ}\\right)|\\chi_1\\rangle + \\left(\\cos\\theta(Q) \\frac{d\\theta}{dQ}\\right)|\\chi_2\\rangle\n$$\nFactoring out the scalar derivative $\\frac{d\\theta}{dQ}$:\n$$\n\\frac{\\partial}{\\partial Q} |\\phi_+(Q)\\rangle \\;=\\; \\frac{d\\theta}{dQ} \\left(-\\sin\\theta(Q)|\\chi_1\\rangle + \\cos\\theta(Q)|\\chi_2\\rangle\\right)\n$$\nWe recognize the expression in the parenthesis as the definition of the state $|\\phi_-(Q)\\rangle$:\n$$\n|\\phi_-(Q)\\rangle \\;=\\; -\\sin\\theta(Q)|\\chi_1\\rangle + \\cos\\theta(Q)|\\chi_2\\rangle\n$$\nTherefore, we have the simple and general relation for this system and phase convention:\n$$\n\\frac{\\partial}{\\partial Q} |\\phi_+(Q)\\rangle \\;=\\; \\frac{d\\theta}{dQ} |\\phi_-(Q)\\rangle\n$$\nSubstituting this into the definition of $\\tau_{12}(Q)$:\n$$\n\\tau_{12}(Q) \\;=\\; \\left\\langle \\phi_-(Q) \\left| \\left(\\frac{d\\theta}{dQ} |\\phi_-(Q)\\rangle\\right) \\right.\\right\\rangle \\;=\\; \\frac{d\\theta}{dQ} \\langle \\phi_-(Q) | \\phi_-(Q) \\rangle\n$$\nSince the adiabatic states are orthonormal, $\\langle \\phi_-(Q) | \\phi_-(Q) \\rangle = 1$. Thus, we find that the nonadiabatic coupling is identical to the derivative of the mixing angle:\n$$\n\\tau_{12}(Q) \\;=\\; \\frac{d\\theta}{dQ}\n$$\nNow we compute this derivative using our expression for $\\theta(Q)$:\n$$\n\\tau_{12}(Q) \\;=\\; \\frac{d}{dQ} \\left[ \\frac{1}{2} \\arctan\\left(\\frac{\\lambda}{\\kappa Q}\\right) \\right]\n$$\nUsing the chain rule and the fact that $\\frac{d}{dx}(\\arctan(x)) = \\frac{1}{1+x^2}$:\n$$\n\\tau_{12}(Q) \\;=\\; \\frac{1}{2} \\cdot \\frac{1}{1 + \\left(\\frac{\\lambda}{\\kappa Q}\\right)^2} \\cdot \\frac{d}{dQ}\\left(\\frac{\\lambda}{\\kappa Q}\\right)\n$$\nThe derivative of the argument is:\n$$\n\\frac{d}{dQ}\\left(\\frac{\\lambda}{\\kappa Q}\\right) \\;=\\; \\frac{\\lambda}{\\kappa} \\frac{d}{dQ}(Q^{-1}) \\;=\\; \\frac{\\lambda}{\\kappa}(-1)Q^{-2} \\;=\\; -\\frac{\\lambda}{\\kappa Q^2}\n$$\nSubstituting this back:\n$$\n\\tau_{12}(Q) \\;=\\; \\frac{1}{2} \\cdot \\frac{1}{1 + \\frac{\\lambda^2}{\\kappa^2 Q^2}} \\cdot \\left(-\\frac{\\lambda}{\\kappa Q^2}\\right)\n$$\nSimplifying the first fraction:\n$$\n\\tau_{12}(Q) \\;=\\; \\frac{1}{2} \\cdot \\frac{\\kappa^2 Q^2}{\\kappa^2 Q^2 + \\lambda^2} \\cdot \\left(-\\frac{\\lambda}{\\kappa Q^2}\\right)\n$$\nCanceling terms ($\\kappa$ and $Q^2$):\n$$\n\\tau_{12}(Q) \\;=\\; \\frac{1}{2} \\cdot \\frac{\\kappa}{\\kappa^2 Q^2 + \\lambda^2} \\cdot (-\\lambda)\n$$\nThis gives the final closed-form expression for the nonadiabatic derivative coupling:\n$$\n\\tau_{12}(Q) \\;=\\; -\\frac{\\kappa \\lambda}{2(\\kappa^2 Q^2 + \\lambda^2)}\n$$", "answer": "$$ \\boxed{-\\frac{\\kappa \\lambda}{2(\\kappa^{2} Q^{2} + \\lambda^{2})}} $$", "id": "2799435"}, {"introduction": "Having explored the theoretical origins of state coupling, this practice applies these ideas to a concrete numerical simulation. You will implement a full two-dimensional wavepacket propagation to observe the real-time consequences of an anharmonic coupling term linking two vibrational modes [@problem_id:2799404]. This computational exercise provides a direct window into fundamental intramolecular dynamics, allowing you to quantify key physical phenomena such as energy transfer between modes and the generation of quantum entanglement.", "problem": "Design and implement a complete, self-contained program that simulates the quantum wavepacket dynamics of two coupled vibrational modes on a two-dimensional potential energy surface using atomic units, where the reduced Planck constant and masses are set to one. The objective is to quantify both energy flow between modes and entanglement generation during unitary evolution for a set of parameterized test cases.\n\nStart from the time-dependent Schrödinger equation, which in atomic units reads $i \\,\\partial_t \\Psi(x_1,x_2,t) = \\hat{H}\\,\\Psi(x_1,x_2,t)$, with Hamiltonian $\\hat{H} = \\hat{T}_1 + \\hat{T}_2 + \\hat{V}(x_1,x_2)$, where $\\hat{T}_j = -\\tfrac{1}{2}\\,\\partial^2/\\partial x_j^2$ for $j \\in \\{1,2\\}$, and the potential energy surface is\n$$\nV(x_1,x_2) = \\tfrac{1}{2}\\,\\omega_1^2\\,x_1^2 + \\tfrac{1}{2}\\,\\omega_2^2\\,x_2^2 + g\\,x_1^2\\,x_2^2,\n$$\nwhere $\\omega_1$ and $\\omega_2$ are harmonic frequencies and $g$ is an anharmonic coupling constant. Use a split-operator method based on the Trotter factorization to approximate the short-time propagator, and implement the kinetic evolution in momentum space using the Fast Fourier Transform (FFT).\n\nInitial state. Prepare a separable initial wavepacket that is a product of displaced harmonic ground states (coherent-state-like Gaussians) for the bare harmonic parts, with optional initial momenta:\n$$\n\\Psi(x_1,x_2,0) = \\phi_0^{(\\omega_1)}(x_1 - x_{10})\\, e^{i p_{10} x_1} \\;\\times\\; \\phi_0^{(\\omega_2)}(x_2 - x_{20})\\, e^{i p_{20} x_2},\n$$\nwhere the one-dimensional harmonic ground state is\n$$\n\\phi_0^{(\\omega)}(x) = \\left(\\tfrac{\\omega}{\\pi}\\right)^{1/4} \\exp\\!\\left(-\\tfrac{\\omega}{2}\\,x^2\\right).\n$$\nNormalize $\\Psi(x_1,x_2,0)$ so that $\\iint |\\Psi|^2\\,dx_1\\,dx_2 = 1$.\n\nDiscretization. Use a uniform square grid of size $N \\times N$ in each coordinate with $N=64$ over a domain $x_j \\in [-L,L)$ with $L=8$, so that the grid spacing is $\\Delta x = 2L/N$. Use the corresponding conjugate momentum grid given by $p = 2\\pi\\,\\mathrm{fftfreq}(N,\\Delta x)$ (in atomic units). Time propagate up to a final time $t_{\\mathrm{final}}$ with a constant time step $\\Delta t = 0.005$ using the second-order split-operator scheme:\n$$\ne^{-i \\hat{H} \\Delta t} \\approx e^{-i \\hat{V}\\, \\Delta t/2}\\, e^{-i (\\hat{T}_1+\\hat{T}_2)\\, \\Delta t}\\, e^{-i \\hat{V}\\, \\Delta t/2}.\n$$\n\nObservables to compute for each test case:\n1. Mode-1 bare energy change. Define the bare mode-1 Hamiltonian as $\\hat{H}_1^{\\mathrm{bare}} = \\hat{T}_1 + \\tfrac{1}{2}\\omega_1^2 x_1^2$. Compute the expectation value at $t=0$ and at $t=t_{\\mathrm{final}}$:\n$$\nE_1^{\\mathrm{bare}}(t) = \\langle \\Psi(t) | \\hat{T}_1 + \\tfrac{1}{2}\\omega_1^2 x_1^2 | \\Psi(t) \\rangle.\n$$\nUse the identity $\\langle \\Psi | \\hat{T}_1 | \\Psi \\rangle = \\tfrac{1}{2}\\iint |\\partial \\Psi/\\partial x_1|^2\\,dx_1\\,dx_2$ to evaluate the kinetic contribution via finite differences on the grid, and the potential contribution by quadrature. Report the change $\\Delta E_1 = E_1^{\\mathrm{bare}}(t_{\\mathrm{final}}) - E_1^{\\mathrm{bare}}(0)$ as a real number in atomic units.\n\n2. Bipartite entanglement entropy at final time. Treat the two modes as subsystems $A$ and $B$ with a pure state $\\Psi(t_{\\mathrm{final}})$. Compute the von Neumann entropy of the reduced density matrix of mode $A$ (mode 1),\n$$\nS = -\\mathrm{Tr}\\left[\\rho_A \\log \\rho_A\\right], \\quad \\rho_A = \\mathrm{Tr}_B \\left[|\\Psi\\rangle\\langle\\Psi|\\right],\n$$\nwhere the trace is over mode 2. In the discrete representation, construct the matrix $M$ with entries $M_{ij} = \\Psi(x_{1,i}, x_{2,j}; t_{\\mathrm{final}}) \\sqrt{\\Delta x\\,\\Delta x}$ so that $\\sum_{ij} |M_{ij}|^2 = 1$, and compute its singular values $\\{s_k\\}$; the eigenvalues of $\\rho_A$ are $\\lambda_k = s_k^2$, and the entropy is $S = -\\sum_k \\lambda_k \\log \\lambda_k$. Use the natural logarithm. Report $S$ as a real number (dimensionless).\n\nNumerical details and requirements:\n- Use atomic units (dimensionless) throughout, where all quantities are unitless within this system.\n- Use central finite differences for $\\partial \\Psi/\\partial x_1$ with periodic indexing implied by the FFT grid.\n- Maintain normalization by renormalizing the wavefunction after initialization; the split-operator scheme should preserve norm to high accuracy, but you may renormalize at the end before measuring observables to mitigate accumulated numerical error.\n- The time integration uses a fixed $\\Delta t = 0.005$ and the number of steps is $N_t = \\lfloor t_{\\mathrm{final}}/\\Delta t \\rfloor$.\n\nTest suite. Run the simulation for the following three cases:\n- Case 1 (weak anharmonic coupling, degenerate modes): $(\\omega_1,\\omega_2,g,x_{10},x_{20},p_{10},p_{20},t_{\\mathrm{final}}) = (1.0,\\,1.0,\\,0.02,\\,1.5,\\,0.0,\\,0.0,\\,0.0,\\,3.0)$.\n- Case 2 (stronger coupling, slight detuning): $(\\omega_1,\\omega_2,g,x_{10},x_{20},p_{10},p_{20},t_{\\mathrm{final}}) = (1.0,\\,1.2,\\,0.10,\\,1.5,\\,0.0,\\,0.0,\\,0.0,\\,3.0)$.\n- Case 3 (no coupling, control): $(\\omega_1,\\omega_2,g,x_{10},x_{20},p_{10},p_{20},t_{\\mathrm{final}}) = (1.0,\\,1.0,\\,0.00,\\,1.5,\\,0.0,\\,0.0,\\,0.0,\\,3.0)$.\n\nAnswer specification and output format:\n- For each case, compute two floats: the entanglement entropy $S$ at $t_{\\mathrm{final}}$ and the bare mode-1 energy change $\\Delta E_1$ at $t_{\\mathrm{final}}$ in atomic units.\n- The program must output a single line containing a comma-separated list enclosed in square brackets with six decimal places per value, ordered as $[S_1,\\Delta E_{1,1},S_2,\\Delta E_{1,2},S_3,\\Delta E_{1,3}]$ corresponding to Cases 1, 2, and 3, respectively.", "solution": "The problem presented is a well-posed and standard exercise in computational quantum chemistry, specifically in the field of non-adiabatic molecular dynamics. It requires the simulation of a two-dimensional quantum system governed by the time-dependent Schrödinger equation with a defined initial condition and a specified numerical algorithm. The problem is scientifically grounded, free of contradictions, and contains all necessary information to proceed with a unique and verifiable solution. We shall therefore proceed to delineate the formal solution.\n\nThe core of the problem is to solve the time-dependent Schrödinger equation (TDSE) in atomic units ($\\hbar=1$, masses $m_1=m_2=1$):\n$$\ni \\frac{\\partial}{\\partial t} \\Psi(x_1, x_2, t) = \\hat{H} \\Psi(x_1, x_2, t)\n$$\nThe Hamiltonian operator $\\hat{H}$ is given by the sum of kinetic and potential energy operators, $\\hat{H} = \\hat{T} + \\hat{V}$, where the kinetic part is $\\hat{T} = \\hat{T}_1 + \\hat{T}_2 = -\\frac{1}{2}\\frac{\\partial^2}{\\partial x_1^2} - \\frac{1}{2}\\frac{\\partial^2}{\\partial x_2^2}$, and the potential energy surface is\n$$\nV(x_1, x_2) = \\frac{1}{2}\\omega_1^2 x_1^2 + \\frac{1}{2}\\omega_2^2 x_2^2 + g x_1^2 x_2^2\n$$\nThe formal solution to the TDSE is $\\Psi(t) = e^{-i\\hat{H}t} \\Psi(0)$. The numerical task is to approximate the action of the time-evolution operator $e^{-i\\hat{H}\\Delta t}$ for a small time step $\\Delta t$.\n\n**Discretization and State Representation**\nThe continuous wavefunction $\\Psi(x_1, x_2, t)$ is represented on a two-dimensional uniform grid. The spatial domain is defined as $x_j \\in [-L, L)$ for $j \\in \\{1, 2\\}$, with $L=8$, discretized into $N=64$ points. The grid spacing is therefore $\\Delta x = 2L/N$. The grid points are $x_{j,k} = -L + k\\Delta x$ for $k=0, 1, \\dots, N-1$. The wavefunction is represented as an $N \\times N$ complex matrix $\\Psi_{k,l}(t) \\equiv \\Psi(x_{1,k}, x_{2,l}, t)$.\n\nThe corresponding momentum space is accessed via the discrete Fourier transform. The momentum grid coordinates are given by $p_j = 2\\pi k_j$, where $k_j$ are the spatial frequencies provided by the `fftfreq` function: $k_j = \\mathrm{fftfreq}(N, \\Delta x)$.\n\n**Initial State Preparation**\nThe initial state at $t=0$ is a separable product of two Gaussian wavepackets, one for each mode:\n$$\n\\Psi(x_1, x_2, 0) = \\phi_0^{(\\omega_1)}(x_1 - x_{10}) e^{i p_{10} x_1} \\times \\phi_0^{(\\omega_2)}(x_2 - x_{20}) e^{i p_{20} x_2}\n$$\nwhere $\\phi_0^{(\\omega)}(x) = (\\frac{\\omega}{\\pi})^{1/4} \\exp(-\\frac{\\omega}{2}x^2)$ is the ground state of a harmonic oscillator with frequency $\\omega$. This initial wavefunction is constructed on the discrete grid and then numerically normalized such that the probability density integrates to one: $\\sum_{k,l} |\\Psi_{k,l}|^2 \\Delta x^2 = 1$.\n\n**Time Evolution: Split-Operator Fourier Method**\nThe kinetic and potential energy operators, $\\hat{T}$ and $\\hat{V}$, do not commute. Therefore, the exponential of their sum is approximated using a Trotter-Suzuki factorization. The specified second-order split-operator scheme is:\n$$\ne^{-i\\hat{H}\\Delta t} \\approx e^{-i\\hat{V}\\frac{\\Delta t}{2}} e^{-i\\hat{T}\\Delta t} e^{-i\\hat{V}\\frac{\\Delta t}{2}}\n$$\nThis scheme is unitary and preserves the norm of the wavefunction. The propagation from time $t$ to $t+\\Delta t$ is implemented in three sequential steps:\n1.  **Half Potential Step:** The wavefunction is multiplied by the potential phase factor in coordinate space: $\\Psi'(x_1, x_2) = e^{-iV(x_1, x_2)\\frac{\\Delta t}{2}} \\Psi(x_1, x_2, t)$.\n2.  **Full Kinetic Step:** This step is most efficiently performed in momentum space, where the kinetic energy operator is diagonal.\n    a. The wavefunction is transformed to momentum space using a 2D Fast Fourier Transform (FFT): $\\tilde{\\Psi}'(p_1, p_2) = \\mathcal{F}[\\Psi'(x_1,x_2)]$.\n    b. In momentum space, the kinetic propagation is a simple multiplication by a phase factor: $\\tilde{\\Psi}''(p_1, p_2) = e^{-iT(p_1, p_2)\\Delta t} \\tilde{\\Psi}'(p_1, p_2)$, where $T(p_1, p_2) = \\frac{1}{2}(p_1^2+p_2^2)$.\n    c. The result is transformed back to coordinate space via an inverse 2D FFT: $\\Psi''(x_1, x_2) = \\mathcal{F}^{-1}[\\tilde{\\Psi}''(p_1, p_2)]$.\n3.  **Half Potential Step:** A second half step of potential propagation is applied: $\\Psi(x_1, x_2, t+\\Delta t) = e^{-iV(x_1, x_2)\\frac{\\Delta t}{2}} \\Psi''(x_1, x_2)$.\nThis entire sequence is repeated for $N_t = \\lfloor t_{\\mathrm{final}}/\\Delta t \\rfloor$ time steps to reach the final time $t_{\\mathrm{final}}$.\n\n**Calculation of Observables**\nAfter the time evolution, we compute the required observables from the final state $\\Psi(t_{\\mathrm{final}})$.\n\n1.  **Mode-1 Bare Energy Change ($\\Delta E_1$)**:\n    The bare energy of mode 1 is the expectation value of the operator $\\hat{H}_1^{\\mathrm{bare}} = \\hat{T}_1 + \\frac{1}{2}\\omega_1^2 x_1^2$.\n    $$\n    E_1^{\\mathrm{bare}}(t) = \\langle \\Psi(t) | \\hat{H}_1^{\\mathrm{bare}} | \\Psi(t) \\rangle = \\langle \\hat{T}_1 \\rangle_t + \\langle \\frac{1}{2}\\omega_1^2 x_1^2 \\rangle_t\n    $$\n    The potential energy part is computed by grid quadrature:\n    $$\n    \\langle \\frac{1}{2}\\omega_1^2 x_1^2 \\rangle_t \\approx \\sum_{k,l} |\\Psi_{k,l}(t)|^2 \\left(\\frac{1}{2}\\omega_1^2 x_{1,k}^2\\right) \\Delta x^2\n    $$\n    The kinetic energy part is computed, as specified, using the identity $\\langle \\hat{T}_1 \\rangle_t = \\frac{1}{2}\\iint |\\partial\\Psi/\\partial x_1|^2 dx_1 dx_2$. The partial derivative is approximated using a second-order central finite difference scheme with periodic boundary conditions on the grid:\n    $$\n    \\left(\\frac{\\partial\\Psi}{\\partial x_1}\\right)_{k,l} \\approx \\frac{\\Psi_{k+1,l} - \\Psi_{k-1,l}}{2\\Delta x}\n    $$\n    The kinetic energy is then computed via grid summation:\n    $$\n    \\langle \\hat{T}_1 \\rangle_t \\approx \\frac{1}{2}\\sum_{k,l} \\left|\\frac{\\Psi_{k+1,l}(t) - \\Psi_{k-1,l}(t)}{2\\Delta x}\\right|^2 \\Delta x^2\n    $$\n    The total change is $\\Delta E_1 = E_1^{\\mathrm{bare}}(t_{\\mathrm{final}}) - E_1^{\\mathrm{bare}}(0)$.\n\n2.  **Bipartite Entanglement Entropy ($S$)**:\n    The entanglement between the two modes is quantified by the von Neumann entropy of the reduced density matrix of one subsystem (e.g., mode 1). The reduced density matrix $\\rho_A$ is obtained by tracing out the degrees of freedom of mode 2: $\\rho_A = \\mathrm{Tr}_B[|\\Psi\\rangle\\langle\\Psi|]$.\n    The entropy is $S = -\\mathrm{Tr}[\\rho_A \\log \\rho_A]$.\n    Numerically, this is efficiently computed via Singular Value Decomposition (SVD). The normalized discrete wavefunction $\\Psi_{k,l}$ is used to construct a matrix $M_{k,l} = \\Psi_{k,l} \\Delta x$, such that $\\mathrm{Tr}[M^\\dagger M]=1$. The singular values $\\{s_m\\}$ of the matrix $M$ are the Schmidt coefficients of the bipartite system. The eigenvalues of the reduced density matrix $\\rho_A$ are given by $\\lambda_m = s_m^2$. The entropy is then calculated as:\n    $$\n    S = -\\sum_{m} \\lambda_m \\log \\lambda_m\n    $$\n    The summation is over all non-zero eigenvalues. For a separable state (as in the $g=0$ case), only one singular value will be non-zero (equal to $1$), resulting in an entropy of $S=0$. For an entangled state, multiple singular values are non-zero, yielding $S>0$.\n\nThe implementation combines these principles into a single program that iterates through the provided test cases, performs the simulation for each, calculates the observables, and formats the output as specified.", "answer": "```python\nimport numpy as np\nfrom scipy import linalg\n# Note: Using numpy.fft which is the standard implementation.\n# The problem allows `numpy` and `scipy`.\n# `scipy.fft` is an alternative but `numpy.fft` is sufficient and canonical.\n\ndef solve():\n    \"\"\"\n    Main driver function to run simulations for all test cases and print results.\n    \"\"\"\n\n    # Grid and time-stepping parameters from the problem statement\n    N = 64\n    L = 8.0\n    DT = 0.005\n\n    # Test suite from the problem statement\n    test_cases = [\n        # (w1, w2, g, x10, x20, p10, p20, t_final)\n        (1.0, 1.0, 0.02, 1.5, 0.0, 0.0, 0.0, 3.0),  # Case 1\n        (1.0, 1.2, 0.10, 1.5, 0.0, 0.0, 0.0, 3.0),  # Case 2\n        (1.0, 1.0, 0.00, 1.5, 0.0, 0.0, 0.0, 3.0),  # Case 3\n    ]\n\n    # Set up computational grids\n    dx = 2 * L / N\n    x_coords = np.linspace(-L, L, N, endpoint=False)\n    p_coords = 2 * np.pi * np.fft.fftfreq(N, d=dx)\n\n    x1, x2 = np.meshgrid(x_coords, x_coords, indexing='ij')\n    p1, p2 = np.meshgrid(p_coords, p_coords, indexing='ij')\n\n    kinetic_energy_op_p = 0.5 * (p1**2 + p2**2)\n\n    results = []\n    for case_params in test_cases:\n        s_final, delta_e1 = run_simulation(case_params, N, L, DT, dx, x1, x2, kinetic_energy_op_p)\n        results.extend([s_final, delta_e1])\n    \n    # Format the final output as specified\n    print(f\"[{','.join([f'{val:.6f}' for val in results])}]\")\n\ndef run_simulation(params, N, L, dt, dx, x1, x2, T_op_p):\n    \"\"\"\n    Performs a single quantum dynamics simulation for a given set of parameters.\n    \"\"\"\n    w1, w2, g, x10, x20, p10, p20, t_final = params\n\n    # --- 1. Initial State Preparation ---\n    def phi0(x, omega):\n        return (omega / np.pi)**0.25 * np.exp(-0.5 * omega * x**2)\n\n    psi_x1 = phi0(x1 - x10, w1) * np.exp(1j * p10 * x1)\n    psi_x2 = phi0(x2 - x20, w2) * np.exp(1j * p20 * x2)\n    psi_initial = psi_x1 * psi_x2\n\n    # Normalize the initial wavefunction\n    norm = np.sqrt(np.sum(np.abs(psi_initial)**2) * dx**2)\n    psi_initial /= norm\n\n    # --- 2. Calculate Initial Energy ---\n    e1_initial = calculate_e1_bare(psi_initial, w1, x1, dx)\n\n    # --- 3. Time Evolution (Split-Operator FFT) ---\n    potential_energy_op_x = 0.5 * w1**2 * x1**2 + 0.5 * w2**2 * x2**2 + g * x1**2 * x2**2\n    \n    # Pre-calculate propagators\n    V_prop_half = np.exp(-0.5j * potential_energy_op_x * dt)\n    T_prop_full = np.exp(-1.0j * T_op_p * dt)\n\n    num_steps = int(np.floor(t_final / dt))\n    psi_current = psi_initial.copy()\n\n    for _ in range(num_steps):\n        # First half potential step\n        psi_current *= V_prop_half\n        # Full kinetic step in momentum space\n        psi_p = np.fft.fft2(psi_current)\n        psi_p *= T_prop_full\n        psi_current = np.fft.ifft2(psi_p)\n        # Second half potential step\n        psi_current *= V_prop_half\n\n    psi_final = psi_current\n\n    # --- 4. Calculate Final Observables ---\n    # Optional renormalization to correct for any minor numerical drift\n    final_norm = np.sqrt(np.sum(np.abs(psi_final)**2) * dx**2)\n    psi_final /= final_norm\n    \n    # a. Final Bare Mode-1 Energy and its change\n    e1_final = calculate_e1_bare(psi_final, w1, x1, dx)\n    delta_e1 = e1_final - e1_initial\n\n    # b. Bipartite Entanglement Entropy\n    # Construct the matrix M for SVD, as per problem description\n    M = psi_final * dx  #dx = sqrt(dx*dx)\n    singular_values = linalg.svd(M, compute_uv=False)\n    \n    # Eigenvalues of the reduced density matrix are squares of singular values\n    lambda_k = singular_values**2\n    \n    # Filter out zero eigenvalues to avoid log(0) issues.\n    lambda_k_pos = lambda_k[lambda_k > 1e-15] # Use a small threshold for numerical stability\n    \n    # von Neumann entropy S = -Tr(rho * log(rho))\n    s_final = -np.sum(lambda_k_pos * np.log(lambda_k_pos))\n\n    return s_final, delta_e1\n\ndef calculate_e1_bare(psi, w1, x1_grid, dx):\n    \"\"\"\n    Calculates the expectation value of the bare mode-1 Hamiltonian.\n    \"\"\"\n    # Potential energy part\n    v1_bare_op = 0.5 * w1**2 * x1_grid**2\n    v1_expect = np.sum(np.abs(psi)**2 * v1_bare_op) * dx**2\n\n    # Kinetic energy part using central finite differences with periodic boundaries\n    # Derivative along axis=0, which corresponds to x1\n    dpsi_dx1 = (np.roll(psi, -1, axis=0) - np.roll(psi, 1, axis=0)) / (2 * dx)\n    t1_expect = 0.5 * np.sum(np.abs(dpsi_dx1)**2) * dx**2\n    \n    return v1_expect + t1_expect\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "2799404"}]}