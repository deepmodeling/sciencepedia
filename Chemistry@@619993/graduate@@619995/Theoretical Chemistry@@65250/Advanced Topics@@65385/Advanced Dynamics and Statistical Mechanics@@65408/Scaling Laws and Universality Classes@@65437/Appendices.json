{"hands_on_practices": [{"introduction": "Our exploration of scaling laws begins with the foundational mean-field approximation, elegantly captured by Landau theory. This analytical exercise provides a crucial first step, demonstrating how the complex behavior near a critical point can be modeled by a simple polynomial expansion of the free energy in an order parameter, $\\phi$. By applying the principle of free energy minimization, you will derive the characteristic power-law scaling of the spontaneous order parameter and susceptibility, which serve as the canonical predictions of mean-field theory [@problem_id:2803286].", "problem": "A symmetric binary liquid mixture near a critical demixing transition can be described, in mean-field theory, by the Landau free-energy density functional\n$$\nf(\\phi)=a\\,(T-T_{c})\\,\\phi^{2}+b\\,\\phi^{4}-h\\,\\phi,\n$$\nwhere $\\phi$ is the scalar order parameter (composition difference), $T$ is the temperature, $T_{c}$ is the critical temperature, $h$ is the uniform ordering field conjugate to $\\phi$, and $a>0$, $b>0$ are temperature-independent coefficients. The thermodynamic equilibrium at fixed $T$ and $h$ is obtained by minimizing $f(\\phi)$ with respect to $\\phi$. The spontaneous order parameter $\\phi^{*}(T)$ is defined as the minimizing $\\phi$ at $h=0$; in the symmetry-broken phase, adopt the convention $\\phi^{*}(T)>0$ corresponding to the limit $h\\to 0^{+}$. The isothermal susceptibility is defined by $\\chi=\\partial \\phi/\\partial h$ evaluated at fixed $T$ and at $h=0$ about the equilibrium solution.\n\nStarting from the principle of free-energy minimization and the given definitions, determine the explicit expressions for:\n- the spontaneous order parameter $\\phi^{*}(T)$ for $T>T_{c}$ and for $T<T_{c}$, and\n- the susceptibility $\\chi(T)$ at $h=0$ for $T>T_{c}$ and for $T<T_{c}$, evaluated about the stable equilibrium branch in each regime.\n\nExpress your final answer as a row matrix in the order $\\big(\\phi^{*}_{>}(T),\\,\\phi^{*}_{<}(T),\\,\\chi_{>}(T),\\,\\chi_{<}(T)\\big)$, where the subscripts $>$ and $<$ denote $T>T_{c}$ and $T<T_{c}$, respectively. No numerical evaluation or rounding is required; provide closed-form symbolic expressions in terms of $a$, $b$, $T$, and $T_{c}$ only.", "solution": "The problem as stated is scientifically grounded, well-posed, and objective. It represents a standard application of Landau theory to a second-order phase transition, a cornerstone of theoretical chemistry and physics. All necessary definitions and parameters are provided, and no inconsistencies or ambiguities are present. The problem is therefore valid, and we proceed with the solution.\n\nThe starting point is the Landau free-energy density functional for a symmetric binary liquid mixture:\n$$\nf(\\phi) = a(T-T_{c})\\phi^{2} + b\\phi^{4} - h\\phi\n$$\nwhere $\\phi$ is the order parameter, $T$ is the temperature, $T_{c}$ is the critical temperature, $h$ is the conjugate field, and the coefficients $a$ and $b$ are positive constants.\n\nThe thermodynamic equilibrium state corresponds to the value of $\\phi$ that minimizes $f(\\phi)$ for given $T$ and $h$. The necessary condition for an extremum is that the first derivative of $f(\\phi)$ with respect to $\\phi$ must be zero:\n$$\n\\frac{\\partial f}{\\partial \\phi} = 2a(T-T_{c})\\phi + 4b\\phi^{3} - h = 0\n$$\nThis equation is the equation of state for the system.\n\nFor an extremum to be a stable minimum, the second derivative of $f(\\phi)$ with respect to $\\phi$ must be positive:\n$$\n\\frac{\\partial^{2} f}{\\partial \\phi^{2}} = 2a(T-T_{c}) + 12b\\phi^{2} > 0\n$$\n\nFirst, we determine the spontaneous order parameter, $\\phi^{*}(T)$, which is the value of $\\phi$ that minimizes the free energy in the absence of an external field, i.e., at $h=0$. Setting $h=0$ in the equation of state gives:\n$$\n2a(T-T_{c})\\phi + 4b\\phi^{3} = 0\n$$\n$$\n\\phi \\left( 2a(T-T_{c}) + 4b\\phi^{2} \\right) = 0\n$$\nThis equation has up to three real solutions for $\\phi$, which we must analyze for the two temperature regimes.\n\nCase 1: High-temperature phase ($T > T_{c}$)\nIn this regime, the term $(T-T_{c})$ is positive. The equation for $\\phi^{2}$ from the second factor is $\\phi^{2} = -\\frac{a(T-T_{c})}{2b}$. Since $a>0$, $b>0$, and $(T-T_{c})>0$, the right-hand side is negative. Thus, there are no non-zero real solutions for $\\phi$. The only real solution is $\\phi = 0$.\nWe must check the stability of this solution. The second derivative at $\\phi=0$ is:\n$$\n\\frac{\\partial^{2} f}{\\partial \\phi^{2}}\\bigg|_{\\phi=0} = 2a(T-T_{c})\n$$\nSince $a>0$ and $(T-T_{c})>0$, this second derivative is positive. The solution $\\phi=0$ corresponds to a stable minimum.\nTherefore, the spontaneous order parameter for $T>T_{c}$ is:\n$$\n\\phi^{*}_{>}(T) = 0\n$$\n\nCase 2: Low-temperature phase ($T < T_{c}$)\nIn this regime, the term $(T-T_{c})$ is negative. It is convenient to write it as $-(T_{c}-T)$, where $(T_{c}-T)>0$. The equation of state at $h=0$ yields three real solutions:\n1. $\\phi = 0$\n2. $\\phi^{2} = -\\frac{a(T-T_{c})}{2b} = \\frac{a(T_{c}-T)}{2b} \\implies \\phi = \\pm\\sqrt{\\frac{a(T_{c}-T)}{2b}}$\n\nWe test the stability of these solutions.\nFor $\\phi=0$:\n$$\n\\frac{\\partial^{2} f}{\\partial \\phi^{2}}\\bigg|_{\\phi=0} = 2a(T-T_{c})\n$$\nSince $(T-T_{c})<0$, this second derivative is negative. The solution $\\phi=0$ corresponds to a local maximum and is thus unstable.\nFor $\\phi = \\pm\\sqrt{\\frac{a(T_{c}-T)}{2b}}$:\n$$\n\\frac{\\partial^{2} f}{\\partial \\phi^{2}} = 2a(T-T_{c}) + 12b\\phi^{2} = 2a(T-T_{c}) + 12b\\left(\\frac{a(T_{c}-T)}{2b}\\right)\n$$\n$$\n= -2a(T_{c}-T) + 6a(T_{c}-T) = 4a(T_{c}-T)\n$$\nSince $a>0$ and $(T_{c}-T)>0$, this second derivative is positive. These two non-zero solutions correspond to stable minima. By convention, we take the positive root for the spontaneous order parameter.\nTherefore, the spontaneous order parameter for $T<T_{c}$ is:\n$$\n\\phi^{*}_{<}(T) = \\sqrt{\\frac{a(T_{c}-T)}{2b}}\n$$\n\nNext, we determine the isothermal susceptibility, $\\chi(T)$, defined as $\\chi = \\frac{\\partial \\phi}{\\partial h}$, evaluated at $h=0$ about the stable equilibrium branch. We start from the equation of state:\n$$\n2a(T-T_{c})\\phi + 4b\\phi^{3} - h = 0\n$$\nWe differentiate this whole equation with respect to $h$, treating $\\phi$ as a function of $h$:\n$$\n\\frac{d}{dh} \\left( 2a(T-T_{c})\\phi(h) + 4b\\phi(h)^{3} - h \\right) = 0\n$$\n$$\n2a(T-T_{c})\\frac{\\partial \\phi}{\\partial h} + 12b\\phi^{2}\\frac{\\partial \\phi}{\\partial h} - 1 = 0\n$$\n$$\n\\frac{\\partial \\phi}{\\partial h} \\left( 2a(T-T_{c}) + 12b\\phi^{2} \\right) = 1\n$$\nSolving for $\\chi = \\frac{\\partial \\phi}{\\partial h}$ gives:\n$$\n\\chi = \\frac{1}{2a(T-T_{c}) + 12b\\phi^{2}}\n$$\nThis expression must be evaluated at $h=0$, which means we substitute the appropriate stable equilibrium value of $\\phi$ (i.e., $\\phi^{*}(T)$) for each temperature regime.\n\nCase 1: High-temperature phase ($T > T_{c}$)\nThe stable equilibrium is at $\\phi^{*}_{>}(T) = 0$. Substituting this into the expression for $\\chi$:\n$$\n\\chi_{>}(T) = \\frac{1}{2a(T-T_{c}) + 12b(0)^{2}} = \\frac{1}{2a(T-T_{c})}\n$$\n\nCase 2: Low-temperature phase ($T < T_{c}$)\nThe stable equilibrium is at $\\phi^{*}_{<}(T)^{2} = \\frac{a(T_{c}-T)}{2b}$. Substituting this into the expression for $\\chi$:\n$$\n\\chi_{<}(T) = \\frac{1}{2a(T-T_{c}) + 12b\\left(\\frac{a(T_{c}-T)}{2b}\\right)} = \\frac{1}{-2a(T_{c}-T) + 6a(T_{c}-T)}\n$$\n$$\n\\chi_{<}(T) = \\frac{1}{4a(T_{c}-T)}\n$$\n\nWe can now assemble the results into the required row matrix format $\\big(\\phi^{*}_{>}(T),\\,\\phi^{*}_{<}(T),\\,\\chi_{>}(T),\\,\\chi_{<}(T)\\big)$.\nThe four expressions are:\n1. $\\phi^{*}_{>}(T) = 0$\n2. $\\phi^{*}_{<}(T) = \\sqrt{\\frac{a(T_{c}-T)}{2b}}$\n3. $\\chi_{>}(T) = \\frac{1}{2a(T-T_{c})}$\n4. $\\chi_{<}(T) = \\frac{1}{4a(T_{c}-T)}$\nThese expressions correctly describe the behavior of the order parameter and susceptibility in the mean-field approximation near the critical point.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0 & \\sqrt{\\frac{a(T_{c}-T)}{2b}} & \\frac{1}{2a(T-T_{c})} & \\frac{1}{4a(T_{c}-T)}\n\\end{pmatrix}\n}\n$$", "id": "2803286"}, {"introduction": "While mean-field theory provides a valuable starting point, the Renormalization Group (RG) offers the profound explanation for the universality of critical phenomena. This practice takes you into the theoretical heart of the subject, guiding you through a Wilsonian momentum-shell RG calculation for the classic $\\phi^4$ theory [@problem_id:2803301]. By explicitly integrating out short-wavelength fluctuations and observing how the effective coupling constant \"flows\" with scale, you will derive the beta function and witness the emergence of a non-trivial fixed point, the very origin of universal scaling behavior.", "problem": "Consider a one-component Landau–Ginzburg–Wilson (LGW) free-energy functional for a scalar order parameter field $\\phi(\\mathbf{x})$ appropriate for an Ising-like fluid critical point in $d=4-\\epsilon$ spatial dimensions with an ultraviolet momentum cutoff $\\Lambda$:\n$$\n\\mathcal{H}[\\phi] \\;=\\; \\int d^d x \\left[ \\frac{1}{2} (\\nabla \\phi)^2 \\;+\\; \\frac{1}{2} r\\, \\phi^2 \\;+\\; \\frac{\\lambda}{4!}\\, \\phi^4 \\right].\n$$\nImplement a Wilsonian momentum-shell Renormalization Group (RG) by splitting $\\phi=\\phi_<+\\phi_>$ into slow modes $\\phi_<$ with $|\\mathbf{q}|\\le \\Lambda e^{-d\\ell}$ and fast modes $\\phi_>$ with $\\Lambda e^{-d\\ell}<|\\mathbf{q}|\\le \\Lambda$, where $d\\ell$ is infinitesimal. To one-loop order and to leading order in $d\\ell$, integrate out $\\phi_>$ perturbatively assuming the system is tuned to criticality so that $r=0$. Work to the lowest nontrivial order in $\\lambda$.\n\nThen define a renormalized, dimensionless quartic coupling at the running scale $\\mu=\\Lambda e^{-\\ell}$ by\n$$\nu(\\mu) \\;\\equiv\\; \\frac{\\lambda(\\mu)}{16\\pi^2}\\,\\mu^{-\\epsilon}.\n$$\nUsing only fundamental definitions of the Wilsonian shell integration, the cumulant expansion for the effective action, and the thin-shell momentum integral in $d=4-\\epsilon$, derive the beta function\n$$\n\\beta(u) \\;\\equiv\\; \\mu \\frac{d u}{d \\mu} \\;=\\; -\\,\\epsilon\\, u \\;+\\; A\\, u^2 \\;+\\; \\mathcal{O}(u^3)\n$$\nand determine the exact value of the constant $A$ for a single-component field.\n\nGive your final answer as the exact value of $A$. No units are required. Do not round.", "solution": "The problem requires the derivation of the beta function for a scalar $\\phi^4$ theory in $d=4-\\epsilon$ dimensions using Wilsonian momentum-shell Renormalization Group (RG) methods, and the determination of the constant $A$ in the expression $\\beta(u) = -\\epsilon u + A u^2$.\n\nFirst, we validate the problem statement.\n\nStep 1: Extract Givens.\n- Landau-Ginzburg-Wilson (LGW) Hamiltonian: $\\mathcal{H}[\\phi] = \\int d^d x \\left[ \\frac{1}{2} (\\nabla \\phi)^2 + \\frac{1}{2} r \\phi^2 + \\frac{\\lambda}{4!} \\phi^4 \\right]$.\n- Spatial dimensions: $d=4-\\epsilon$.\n- UV momentum cutoff: $\\Lambda$.\n- Momentum shell split: fast modes $\\phi_>$ in $\\Lambda e^{-d\\ell} < |\\mathbf{q}| \\le \\Lambda$ and slow modes $\\phi_<$ in $|\\mathbf{q}| \\le \\Lambda e^{-d\\ell}$, for infinitesimal $d\\ell$.\n- Criticality condition: $r=0$.\n- Approximation: One-loop order, leading order in $d\\ell$, lowest nontrivial order in $\\lambda$.\n- Dimensionless coupling: $u(\\mu) \\equiv \\frac{\\lambda(\\mu)}{16\\pi^2}\\,\\mu^{-\\epsilon}$, where $\\mu = \\Lambda e^{-\\ell}$ is the running scale.\n- Beta function definition: $\\beta(u) \\equiv \\mu \\frac{d u}{d \\mu}$.\n- Target form of beta function: $\\beta(u) = -\\epsilon u + A u^2 + \\mathcal{O}(u^3)$.\n- Task: Find the constant $A$.\n\nStep 2: Validate Using Extracted Givens.\nThe problem is scientifically grounded, rooted in the established principles of statistical field theory and critical phenomena. It is a standard textbook calculation in the study of the renormalization group. The problem is well-posed, objective, and all provided information is self-consistent and sufficient to determine a unique value for the constant $A$. The terminology is precise, and the approximations are clearly stated. The methods specified (Wilsonian shell integration, cumulant expansion) are appropriate for the task.\n\nStep 3: Verdict and Action.\nThe problem is valid. I will now provide the full solution.\n\nThe RG procedure involves integrating out high-momentum (fast) modes to obtain an effective theory for the low-momentum (slow) modes. We are interested in how the quartic coupling $\\lambda$ changes as we lower the momentum cutoff. Let the theory be defined with a cutoff $\\mu$. We seek the change in parameters as the cutoff is lowered from $\\mu$ to $\\mu' = \\mu - d\\mu$. This is equivalent to integrating out the modes in the momentum shell $[\\mu-d\\mu, \\mu]$.\n\nThe effective action for the slow modes $\\phi_<$ is obtained by integrating out the fast modes $\\phi_>$:\n$$\n\\exp(-\\mathcal{H}_{eff}[\\phi_<]) = \\int \\mathcal{D}\\phi_> \\exp(-\\mathcal{H}[\\phi_<+\\phi_>])\n$$\nWe use the cumulant expansion for $\\mathcal{H}_{eff}[\\phi_<]$. With $r=0$, the Hamiltonian is $\\mathcal{H} = \\mathcal{H}_0 + \\mathcal{H}_{int}$, where $\\mathcal{H}_0 = \\int d^dx \\frac{1}{2}(\\nabla\\phi)^2$ and $\\mathcal{H}_{int} = \\int d^dx \\frac{\\lambda}{4!}\\phi^4$.\n$$\n\\mathcal{H}_{eff}[\\phi_<] \\approx \\mathcal{H}_0[\\phi_<] + \\mathcal{H}_{int}[\\phi_<] + \\langle \\mathcal{H}_{int,mix} \\rangle_{>} - \\frac{1}{2}\\left( \\langle \\mathcal{H}_{int,mix}^2 \\rangle_{>} - \\langle \\mathcal{H}_{int,mix} \\rangle_>^2 \\right) + \\dots\n$$\nwhere $\\langle \\dots \\rangle_>$ denotes an average over the fast modes $\\phi_>$ with the Gaussian weight $\\exp(-\\mathcal{H}_0[\\phi_>])$. The term $\\mathcal{H}_{int,mix}$ contains terms from $\\mathcal{H}_{int}$ involving both $\\phi_<$ and $\\phi_>$. The correction to the $\\phi^4$ vertex arises at one-loop order, which corresponds to the second-order term in the cumulant expansion.\n\nWe are interested in the correction to the $\\int d^d x \\frac{\\lambda}{4!}\\phi_<^4$ term. This correction is generated by the connected part of the correlation function of the interaction term $\\frac{\\lambda}{4!} \\int d^dx \\, 6\\phi_<^2\\phi_>^2$.\nThe change in the action is:\n$$\n\\Delta\\mathcal{H} = -\\frac{1}{2} \\left\\langle \\left( \\int d^dx \\frac{6\\lambda}{4!} \\phi_<^2 \\phi_>^2 \\right)^2 \\right\\rangle_{>, conn}\n$$\nApplying Wick's theorem to the $\\phi_>$ fields:\n$$\n\\Delta\\mathcal{H} = -\\frac{1}{2} \\left(\\frac{\\lambda}{4}\\right)^2 \\int d^dx \\int d^dy \\, \\phi_<^2(x) \\phi_<^2(y) \\left( 2 \\left[\\langle \\phi_>(x)\\phi_>(y) \\rangle_>\\right]^2 \\right)\n$$\nThe propagator for the fast modes is $G_>(x-y) = \\langle \\phi_>(x)\\phi_>(y) \\rangle_>$. For slow external fields $\\phi_<(x)$, which have very small momenta, we can approximate the non-local expression by a local one by setting the external momenta to zero. In momentum space, this corresponds to calculating the correction to the four-point vertex function $\\Gamma^{(4)}$ at zero external momenta.\n\nThe one-loop correction to $\\Gamma^{(4)}$ is given by the sum of three diagrams (s, t, and u channels), each involving an internal loop of fast modes. The symmetry factor for the diagrams is $3 \\times \\frac{1}{2}$. The vertex factor from $\\frac{\\lambda}{4!}\\phi^4$ is $-\\lambda$. The change in the vertex function $\\delta\\Gamma^{(4)}$ is:\n$$\n\\delta\\Gamma^{(4)} = 3 \\times \\frac{1}{2} (-\\lambda)^2 \\int_{\\text{shell}} \\frac{d^d q}{(2\\pi)^d} \\frac{1}{q^2} \\frac{1}{q^2} = \\frac{3\\lambda^2}{2} \\int_{\\text{shell}} \\frac{d^d q}{(2\\pi)^d} \\frac{1}{q^4}\n$$\nThe effective action contains the term $\\frac{\\lambda_{eff}}{4!}\\int \\phi^4 d^dx$. The vertex function is $\\Gamma^{(4)}_{eff} = \\lambda_{eff}$. Thus, the change in the coupling constant is $\\delta\\lambda = \\delta\\Gamma^{(4)}$.\n$$\n\\delta\\lambda = \\frac{3\\lambda^2}{2} \\int_{\\text{shell}} \\frac{d^d q}{(2\\pi)^d} \\frac{1}{q^4}\n$$\nWe are lowering the cutoff from $\\mu$ to $\\mu-d\\mu$. The integration shell is $[\\mu-d\\mu, \\mu]$. For an infinitesimal shell of width $d\\mu$, the integral is:\n$$\n\\int_{\\mu-d\\mu}^{\\mu} \\frac{d^d q}{(2\\pi)^d} \\frac{1}{q^4} = \\frac{S_{d-1}}{(2\\pi)^d} \\int_{\\mu-d\\mu}^{\\mu} q^{d-1} dq \\, \\frac{1}{q^4} \\approx \\frac{S_{d-1}}{(2\\pi)^d} \\mu^{d-5} d\\mu\n$$\nwhere $S_{d-1} = \\frac{2\\pi^{d/2}}{\\Gamma(d/2)}$ is the surface area of a $(d-1)$-sphere. For $d=4-\\epsilon$, $S_{d-1} \\approx S_3 = 2\\pi^2$ and $(2\\pi)^d \\approx (2\\pi)^4$.\n$$\n\\int_{\\mu-d\\mu}^{\\mu} \\frac{d^d q}{(2\\pi)^d} \\frac{1}{q^4} \\approx \\frac{2\\pi^2}{(2\\pi)^4} \\mu^{(4-\\epsilon)-5} d\\mu = \\frac{1}{8\\pi^2} \\mu^{-1-\\epsilon} d\\mu\n$$\nThis gives the change in the dimensionful coupling $\\lambda(\\mu)$ as a function of the cutoff $\\mu$. When we integrate out the shell, we add this contribution to the coupling. Thus, the change $\\delta\\lambda$ corresponding to a change $d\\mu$ in the cutoff is:\n$$\n\\delta\\lambda = \\frac{3\\lambda^2}{2} \\left[ \\frac{1}{8\\pi^2} \\mu^{-1-\\epsilon} d\\mu \\right] = \\frac{3\\lambda^2}{16\\pi^2} \\mu^{-1-\\epsilon} d\\mu\n$$\nThis leads to the differential equation for the running coupling $\\lambda(\\mu)$:\n$$\n\\frac{d\\lambda}{d\\mu} = \\frac{3\\lambda^2}{16\\pi^2} \\mu^{-1-\\epsilon}\n$$\nNow, we derive the beta function for the dimensionless coupling $u(\\mu) \\equiv \\frac{\\lambda(\\mu)}{16\\pi^2} \\mu^{-\\epsilon}$. Using the definition $\\beta(u) \\equiv \\mu \\frac{du}{d\\mu}$:\n$$\n\\beta(u) = \\mu \\frac{d}{d\\mu} \\left( \\frac{\\lambda}{16\\pi^2} \\mu^{-\\epsilon} \\right) = \\frac{\\mu}{16\\pi^2} \\left( \\frac{d\\lambda}{d\\mu} \\mu^{-\\epsilon} + \\lambda(-\\epsilon)\\mu^{-\\epsilon-1} \\right) = \\frac{\\mu^{-\\epsilon}}{16\\pi^2} \\left( \\mu \\frac{d\\lambda}{d\\mu} - \\epsilon \\lambda \\right)\n$$\nSubstitute the expression for $\\frac{d\\lambda}{d\\mu}$:\n$$\n\\beta(u) = \\frac{\\mu^{-\\epsilon}}{16\\pi^2} \\left( \\mu \\left[ \\frac{3\\lambda^2}{16\\pi^2} \\mu^{-1-\\epsilon} \\right] - \\epsilon \\lambda \\right) = \\frac{\\mu^{-\\epsilon}}{16\\pi^2} \\left( \\frac{3\\lambda^2}{16\\pi^2} \\mu^{-\\epsilon} - \\epsilon \\lambda \\right)\n$$\nTo express this in terms of $u$, we use the relation $\\lambda = 16\\pi^2 u \\mu^{\\epsilon}$:\n$$\n\\beta(u) = \\frac{\\mu^{-\\epsilon}}{16\\pi^2} \\left( \\frac{3 (16\\pi^2 u \\mu^\\epsilon)^2}{16\\pi^2} \\mu^{-\\epsilon} - \\epsilon (16\\pi^2 u \\mu^\\epsilon) \\right)\n$$\n$$\n\\beta(u) = \\frac{3 \\cdot (16\\pi^2)^2}{(16\\pi^2)^2} u^2 (\\mu^{-\\epsilon} \\mu^{2\\epsilon} \\mu^{-\\epsilon}) - \\frac{\\epsilon \\cdot 16\\pi^2}{16\\pi^2} u (\\mu^{-\\epsilon}\\mu^{\\epsilon})\n$$\n$$\n\\beta(u) = 3u^2 - \\epsilon u\n$$\nComparing this result to the given form $\\beta(u) = -\\epsilon u + A u^2$, we identify the constant $A$.\n$$\nA = 3\n$$\nThis result is derived strictly following the requested procedure: one-loop perturbative integration of a momentum shell and application of the provided definitions for $u$ and $\\beta(u)$, without invoking the explicit rescaling steps of the full Wilsonian transformation, which are implicitly handled by the definition of the dimensionless coupling and its beta function.", "answer": "$$\\boxed{3}$$", "id": "2803301"}, {"introduction": "The ultimate test of a physical theory lies in its ability to describe experimental observation. This final, computational practice bridges the gap between the abstract RG framework and the practical analysis of scattering data from a near-critical system [@problem_id:2803227]. You will fit a key prediction of RG theory, the Fisher-Burford structure factor, to synthetic data, grappling with the real-world complications of instrumental resolution and measurement noise. This exercise will not only solidify your understanding of critical parameters like the anomalous dimension $\\eta$ but also cultivate essential skills in discerning true physical effects from systematic experimental artifacts.", "problem": "A central observable in equilibrium scattering experiments on near-critical molecular fluids and polymer solutions is the static structure factor $S(q)$, which is the Fourier transform of the pair correlation function. Renormalization-group analysis predicts that, sufficiently close to criticality, the $q$-dependence of $S(q)$ at small $q$ follows the Fisher–Burford (FB) form $S(q) = \\frac{S(0)}{1+(q\\xi)^{2-\\eta}}$, where $\\xi$ is the correlation length and $\\eta$ is the anomalous dimension. Real instruments measure a resolution-broadened intensity because the spectrometer accepts a distribution of scattering vectors around the nominal $q$. If the instrumental resolution is modeled as a normalized Gaussian $R(\\Delta q)=\\frac{1}{\\sqrt{2\\pi}\\sigma_q}\\exp\\left(-\\frac{\\Delta q^2}{2\\sigma_q^2}\\right)$ of known width $\\sigma_q$, the measured mean signal at discrete sampling points $\\{q_i\\}_{i=1}^N$ is $I_i=\\int_{0}^{\\infty} R(q_i-q')\\,S(q')\\,\\mathrm{d}q'$. We consider additive, independent Gaussian noise $\\varepsilon_i\\sim\\mathcal{N}(0,\\sigma_i^2)$ with known standard deviation $\\sigma_i$. Under these assumptions, the maximum likelihood estimator of parameters $\\theta=\\big(S(0),\\xi,\\eta\\big)$ minimizes the weighted sum of squares $\\chi^2(\\theta)=\\sum_{i=1}^N \\left(\\frac{y_i-\\mu_i(\\theta)}{\\sigma_i}\\right)^2$, where $y_i$ are the observed intensities and $\\mu_i(\\theta)$ is the model prediction, either the direct FB line shape $\\mu_i(\\theta)=\\frac{S(0)}{1+(q_i\\xi)^{2-\\eta}}$ when instrumental resolution is neglected, or the resolution-convolved prediction $\\mu_i(\\theta)=\\int_{0}^{\\infty} R(q_i-q')\\,\\frac{S(0)}{1+(q'\\xi)^{2-\\eta}}\\,\\mathrm{d}q'$ when resolution is accounted for.\n\nImplement the following in a single program:\n\n- Use a uniform grid of $N$ points from $q_{\\min}=0$ to $q_{\\max}$ (inclusive) for each test case. For all cases below, set the true amplitude to $S(0)=1.0$ (dimensionless). Generate mock data by computing the noiseless convolved mean $I_i$ on the grid, then adding independent Gaussian noise $\\varepsilon_i$ with standard deviation $\\sigma_i=r\\,I_i$, where the relative noise level $r$ is specified per test. Use a fixed random seed $12345$ to make the draws of $\\varepsilon_i$ reproducible. Take the instrumental resolution to be Gaussian with standard deviation $\\sigma_q$ in $\\mathrm{nm}^{-1}$ and assume the Gaussian is properly normalized. For the convolution integral in the resolution-aware prediction, approximate $\\int_0^{\\infty}$ on the discrete grid using a row-normalized Gaussian weight matrix constructed on the given grid. For the special case $\\sigma_q=0$, define the resolution operator as the identity (no broadening).\n\n- Perform two separate weighted nonlinear least-squares fits for each test case:\n  1. A fit that neglects instrumental resolution, using $\\mu_i(\\theta)=\\frac{S(0)}{1+(q_i\\xi)^{2-\\eta}}$.\n  2. A fit that accounts for instrumental resolution by numerically convolving the FB form with the Gaussian resolution on the grid to predict $\\mu_i(\\theta)$.\n\n  In both fits, treat $S(0)$, $\\xi$, and $\\eta$ as free parameters with bounds $S(0)\\in[10^{-6},10]$, $\\xi\\in[1,100]$ (in $\\mathrm{nm}$), and $\\eta\\in[0,0.5]$ (dimensionless). Use weighted residuals with weights $1/\\sigma_i$; if $r=0$ so that $\\sigma_i=0$, use unit weights. Initialize the optimizer with $S(0)$ equal to the first data point $y_1$, $\\xi=10$ (in $\\mathrm{nm}$), and $\\eta=0.05$ (dimensionless).\n\n- For each test case, compute the absolute biases in the estimated correlation length and anomalous dimension both when the fit ignores resolution and when it accounts for resolution. That is, report $\\big|\\widehat{\\xi}_{\\mathrm{no\\_res}}-\\xi_{\\mathrm{true}}\\big|$ (in $\\mathrm{nm}$), $\\big|\\widehat{\\eta}_{\\mathrm{no\\_res}}-\\eta_{\\mathrm{true}}\\big|$ (dimensionless), $\\big|\\widehat{\\xi}_{\\mathrm{with\\_res}}-\\xi_{\\mathrm{true}}\\big|$ (in $\\mathrm{nm}$), and $\\big|\\widehat{\\eta}_{\\mathrm{with\\_res}}-\\eta_{\\mathrm{true}}\\big|$ (dimensionless).\n\nUse the following test suite of scientifically plausible parameter sets that exercise different regimes:\n\n- Case A (moderate broadening, small anomalous dimension): $\\xi_{\\mathrm{true}}=12$ $\\mathrm{nm}$, $\\eta_{\\mathrm{true}}=0.06$, $\\sigma_q=0.02$ $\\mathrm{nm}^{-1}$, $r=0.01$, $q_{\\max}=0.8$ $\\mathrm{nm}^{-1}$, $N=200$.\n- Case B (larger correlation length, mean-field exponent): $\\xi_{\\mathrm{true}}=25$ $\\mathrm{nm}$, $\\eta_{\\mathrm{true}}=0.00$, $\\sigma_q=0.05$ $\\mathrm{nm}^{-1}$, $r=0.03$, $q_{\\max}=1.0$ $\\mathrm{nm}^{-1}$, $N=220$.\n- Case C (stronger broadening, larger anomalous dimension): $\\xi_{\\mathrm{true}}=8$ $\\mathrm{nm}$, $\\eta_{\\mathrm{true}}=0.15$, $\\sigma_q=0.10$ $\\mathrm{nm}^{-1}$, $r=0.02$, $q_{\\max}=1.2$ $\\mathrm{nm}^{-1}$, $N=240$.\n- Case D (boundary case, perfect instrument and noiseless): $\\xi_{\\mathrm{true}}=15$ $\\mathrm{nm}$, $\\eta_{\\mathrm{true}}=0.10$, $\\sigma_q=0.00$ $\\mathrm{nm}^{-1}$, $r=0.00$, $q_{\\max}=1.0$ $\\mathrm{nm}^{-1}$, $N=200$.\n\nRequired final output format: Your program should produce a single line of output containing a list of four sublists, one per test case, in the order A, B, C, D. Each sublist must contain the four floats $\\left[\\big|\\widehat{\\xi}_{\\mathrm{no\\_res}}-\\xi_{\\mathrm{true}}\\big|,\\big|\\widehat{\\eta}_{\\mathrm{no\\_res}}-\\eta_{\\mathrm{true}}\\big|,\\big|\\widehat{\\xi}_{\\mathrm{with\\_res}}-\\xi_{\\mathrm{true}}\\big|,\\big|\\widehat{\\eta}_{\\mathrm{with\\_res}}-\\eta_{\\mathrm{true}}\\big|\\right]$ with $\\xi$-errors in $\\mathrm{nm}$ and $\\eta$-errors dimensionless, formatted with exactly six digits after the decimal point, and no spaces. For example: $\\left[\\left[0.123456,0.000789,0.012345,0.000067\\right],\\ldots\\right]$.", "solution": "The problem presented is a valid and well-posed exercise in computational physics and data analysis. It concerns the estimation of physical parameters from experimental data that is subject to both systematic (instrumental resolution) and statistical (noise) errors. The problem is scientifically grounded in the theory of critical phenomena, specifically using the Fisher-Burford form for the static structure factor, a cornerstone result from renormalization-group theory. All provided data and constraints are clear, consistent, and physically plausible.\n\nThe objective is to quantify the systematic error, or bias, incurred in parameter estimation when a known instrumental broadening effect is neglected in the data analysis model. We will compare the results of a naive fit, which ignores resolution, to those of a sophisticated fit, which correctly models the convolution of the theoretical signal with the instrumental resolution function. This will be performed for several parameter sets representing different physical and experimental conditions.\n\nThe procedure for each test case is as follows:\n\nFirst, we generate a synthetic dataset that mimics an actual scattering experiment.\nA uniform grid of $N$ momentum transfer points, $\\{q_i\\}$, is defined from $q_{\\min}=0$ to a specified $q_{\\max}$.\nThe true, ideal scattering intensity is given by the Fisher-Burford (FB) model:\n$$S(q) = \\frac{S(0)}{1+(q\\xi)^{2-\\eta}}$$\nUsing the true parameters provided for each case ($S(0)_{\\text{true}}=1.0$, $\\xi_{\\text{true}}$, $\\eta_{\\text{true}}$), we compute the ideal signal $S(q_i)$ at each grid point.\n\nSecond, we model the effect of the instrument's finite resolution. The instrumental resolution function is given as a Gaussian, $R(\\Delta q)$, with a standard deviation of $\\sigma_q$. The signal measured by the instrument, $I_i$, at a nominal setting $q_i$ is the convolution of the true signal $S(q')$ with the resolution function:\n$$I_i = \\int_{0}^{\\infty} R(q_i-q') S(q') \\mathrm{d}q'$$\nWe will approximate this integral numerically on the discrete grid $\\{q_j\\}$. This is achieved by constructing an $N \\times N$ matrix, $\\mathbf{K}$, representing the convolution operator. For a non-zero resolution width $\\sigma_q > 0$, the elements of the unnormalized kernel matrix are given by the Gaussian function $G_{ij} = \\exp\\left(-(q_i-q_j)^2/(2\\sigma_q^2)\\right)$. To ensure that the convolution represents a weighted averaging and conserves total intensity for a flat signal, we use a row-normalized matrix $\\mathbf{K}$, where each element $K_{ij}$ is given by $K_{ij} = G_{ij} / \\sum_k G_{ik}$. The convolved, noiseless signal vector $\\mathbf{I}$ is then calculated via the matrix-vector product $\\mathbf{I} = \\mathbf{K} \\mathbf{S}$, where $\\mathbf{S}$ is the vector of ideal signal values $S(q_i)$. In the special case of a perfect instrument where $\\sigma_q = 0$, the resolution function is a Dirac delta function, and the convolution operator $\\mathbf{K}$ becomes the identity matrix, $\\mathbf{I}$.\n\nThird, we simulate measurement noise. The final mock data, $\\{y_i\\}$, are generated by adding independent Gaussian noise $\\varepsilon_i$ to the convolved signal $I_i$. Each noise term $\\varepsilon_i$ is drawn from a normal distribution $\\mathcal{N}(0, \\sigma_i^2)$ with a standard deviation $\\sigma_i = r I_i$, where $r$ is the specified relative noise level. A fixed random seed of $12345$ is used to ensure the reproducibility of the noise realization.\n\nFourth, we perform two separate parameter estimations using weighted nonlinear least-squares (WNLLS) fitting to the generated data $\\{y_i\\}$. The goal is to minimize the chi-squared statistic:\n$$\\chi^2(\\theta) = \\sum_{i=1}^N \\left(\\frac{y_i - \\mu_i(\\theta)}{\\sigma_i}\\right)^2$$\nwhere $\\theta = (S(0), \\xi, \\eta)$ is the vector of parameters to be estimated, and $\\mu_i(\\theta)$ is the model prediction for the $i$-th data point. The weights for the WNLLS fit are $w_i = 1/\\sigma_i$. For the noiseless case ($r=0$, hence $\\sigma_i=0$), unit weights $w_i=1$ are used. The optimization is performed with bounds on the parameters: $S(0)\\in[10^{-6},10]$, $\\xi\\in[1,100]$, and $\\eta\\in[0,0.5]$. The initial guess for the optimizer is set to $S(0) = y_1$ (the first data point), $\\xi = 10$, and $\\eta = 0.05$.\n\nThe two fitting procedures are:\n1.  **Fit Neglecting Resolution**: The model function is the direct FB form: $\\mu_i(\\theta) = \\frac{S(0)}{1+(q_i\\xi)^{2-\\eta}}$. This fit is expected to yield biased parameter estimates, specifically for $\\xi$ and $\\eta$, because the model does not account for the broadening present in the data.\n2.  **Fit Accounting for Resolution**: The model function correctly includes the convolution: $\\mu_i(\\theta) = (\\mathbf{K} \\mathbf{S}(\\theta))_i$. This fit uses the same physical process that generated the data and is expected to recover the true parameters within the uncertainty imposed by the noise.\n\nFinally, for each test case, we compute the absolute bias for the estimated correlation length $\\xi$ and anomalous dimension $\\eta$ from both fits. These are defined as $|\\widehat{\\xi}_{\\mathrm{no\\_res}}-\\xi_{\\mathrm{true}}|$, $|\\widehat{\\eta}_{\\mathrm{no\\_res}}-\\eta_{\\mathrm{true}}|$, $|\\widehat{\\xi}_{\\mathrm{with\\_res}}-\\xi_{\\mathrm{true}}|$, and $|\\widehat{\\eta}_{\\mathrm{with\\_res}}-\\eta_{\\mathrm{true}}|$. These four values constitute the result for one test case. The entire procedure is repeated for all specified test cases.", "answer": "```python\nimport numpy as np\nfrom scipy.optimize import least_squares\nfrom scipy.stats import norm\n\ndef solve():\n    \"\"\"\n    Main function to run the data generation and fitting for all test cases.\n    \"\"\"\n    test_cases = [\n        # Case A (moderate broadening, small anomalous dimension)\n        {'xi_true': 12.0, 'eta_true': 0.06, 'sigma_q': 0.02, 'r': 0.01, 'q_max': 0.8, 'N': 200},\n        # Case B (larger correlation length, mean-field exponent)\n        {'xi_true': 25.0, 'eta_true': 0.00, 'sigma_q': 0.05, 'r': 0.03, 'q_max': 1.0, 'N': 220},\n        # Case C (stronger broadening, larger anomalous dimension)\n        {'xi_true': 8.0, 'eta_true': 0.15, 'sigma_q': 0.10, 'r': 0.02, 'q_max': 1.2, 'N': 240},\n        # Case D (boundary case, perfect instrument and noiseless)\n        {'xi_true': 15.0, 'eta_true': 0.10, 'sigma_q': 0.00, 'r': 0.00, 'q_max': 1.0, 'N': 200},\n    ]\n\n    S0_true = 1.0\n    rng = np.random.default_rng(12345)\n    all_results = []\n\n    for case in test_cases:\n        xi_true = case['xi_true']\n        eta_true = case['eta_true']\n        sigma_q = case['sigma_q']\n        r = case['r']\n        q_max = case['q_max']\n        N = case['N']\n\n        q_grid = np.linspace(0, q_max, N)\n\n        def fb_model(q, S0, xi, eta):\n            \"\"\"Fisher-Burford model for the static structure factor S(q).\"\"\"\n            return S0 / (1 + (q * xi)**(2 - eta))\n\n        # 1. Generate true signal\n        S_true = fb_model(q_grid, S0_true, xi_true, eta_true)\n\n        # 2. Construct convolution matrix\n        if sigma_q == 0.0:\n            K = np.eye(N)\n        else:\n            q_diff_sq = (q_grid[:, np.newaxis] - q_grid[np.newaxis, :])**2\n            G = np.exp(-q_diff_sq / (2 * sigma_q**2))\n            row_sums = G.sum(axis=1, keepdims=True)\n            # Handle potential division by zero if a row sum is zero, though unlikely here\n            row_sums[row_sums == 0] = 1\n            K = G / row_sums\n\n        # 3. Convolve signal\n        I_convolved = K @ S_true\n\n        # 4. Add noise to generate mock data\n        sigma_noise = r * I_convolved\n        # Ensure sigma_noise is non-negative for the random number generator\n        sigma_noise[sigma_noise  0] = 0\n        noise = rng.normal(loc=0, scale=sigma_noise)\n        y_data = I_convolved + noise\n\n        # 5. Define weights for fitting\n        if r == 0.0:\n            weights = np.ones_like(y_data)\n        else:\n            # Avoid division by zero, though I_convolved should be > 0.\n            weights = np.divide(1.0, sigma_noise, out=np.ones_like(sigma_noise), where=sigma_noise!=0)\n\n        # 6. Perform fits\n        p0 = (y_data[0], 10.0, 0.05)\n        bounds = ([1e-6, 1.0, 0.0], [10.0, 100.0, 0.5])\n\n        # Fit 1: Neglecting resolution\n        def residuals_no_res(p, q, y, w):\n            S0, xi, eta = p\n            model_y = fb_model(q, S0, xi, eta)\n            return w * (y - model_y)\n\n        fit_result_no_res = least_squares(\n            residuals_no_res, p0, args=(q_grid, y_data, weights), bounds=bounds)\n        p_fit_no_res = fit_result_no_res.x\n\n        # Fit 2: Accounting for resolution\n        def residuals_with_res(p, q, y, w, K_matrix):\n            S0, xi, eta = p\n            model_unconvolved = fb_model(q, S0, xi, eta)\n            model_y = K_matrix @ model_unconvolved\n            return w * (y - model_y)\n\n        fit_result_with_res = least_squares(\n            residuals_with_res, p0, args=(q_grid, y_data, weights, K), bounds=bounds)\n        p_fit_with_res = fit_result_with_res.x\n\n        # 7. Calculate biases\n        bias_xi_no_res = abs(p_fit_no_res[1] - xi_true)\n        bias_eta_no_res = abs(p_fit_no_res[2] - eta_true)\n        bias_xi_with_res = abs(p_fit_with_res[1] - xi_true)\n        bias_eta_with_res = abs(p_fit_with_res[2] - eta_true)\n\n        all_results.append([\n            bias_xi_no_res, bias_eta_no_res,\n            bias_xi_with_res, bias_eta_with_res\n        ])\n\n    # 8. Format and print final output\n    formatted_sublists = []\n    for sublist in all_results:\n        formatted_numbers = [f\"{num:.6f}\" for num in sublist]\n        formatted_sublists.append(f\"[{','.join(formatted_numbers)}]\")\n    \n    final_output = f\"[{','.join(formatted_sublists)}]\"\n    print(final_output)\n\nsolve()\n```", "id": "2803227"}]}