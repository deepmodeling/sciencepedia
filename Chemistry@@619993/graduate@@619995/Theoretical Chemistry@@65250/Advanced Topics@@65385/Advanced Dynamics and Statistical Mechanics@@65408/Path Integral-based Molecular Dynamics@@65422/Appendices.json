{"hands_on_practices": [{"introduction": "The first step in any practical Path Integral Molecular Dynamics (PIMD) simulation is selecting the number of beads, $P$. This choice is not arbitrary; it must be guided by the physical characteristics of the system to ensure convergence of quantum statistical properties. This exercise guides you through the derivation of a crucial rule ofthumb, $P \\ge \\beta \\hbar \\omega_{\\max}$, which connects the number of beads to the highest vibrational frequency $\\omega_{\\max}$ at a given temperature, ensuring that crucial nuclear quantum effects like zero-point energy are accurately captured [@problem_id:2759518].", "problem": "A hydrogen-bonded molecular system at temperature $T = 300\\,\\mathrm{K}$ exhibits its highest relevant intramolecular vibrational mode as an O–H stretch with wavenumber $\\tilde{\\nu}_{\\max} = 3300\\,\\mathrm{cm}^{-1}$. You wish to include nuclear quantum effects at the level of zero-point energy using Path Integral Molecular Dynamics (PIMD) within an ab initio molecular dynamics (AIMD) framework.\n\nStarting from the imaginary-time path integral representation of the quantum canonical partition function for a harmonic oscillator of angular frequency $\\omega$, and the Trotter discretization into $P$ time slices, derive a conservative condition on the Trotter number $P$ that ensures the ring-polymer representation can resolve the zero-point fluctuations of the fastest vibrational mode at $\\tilde{\\nu}_{\\max}$. Express your condition in terms of $P$, $\\beta = 1/(k_{B}T)$, and $\\omega_{\\max} = 2\\pi c\\,\\tilde{\\nu}_{\\max}$, and determine the smallest integer $P$ that satisfies it for the given $T$ and $\\tilde{\\nu}_{\\max}$. Use the identity $\\hbar \\omega = h \\nu = h c \\tilde{\\nu}$ and the conversion $k_{B}/(h c) = 0.69503476\\,\\mathrm{cm}^{-1}\\,\\mathrm{K}^{-1}$.\n\nIn your derivation, also propose an ab initio molecular dynamics setup consistent with your bead count, choosing between Born–Oppenheimer molecular dynamics (BOMD) and Car–Parrinello molecular dynamics (CPMD), and estimate a stable time step based on the largest frequency that must be resolved in the extended PIMD dynamics. Briefly justify your thermostatting strategy for sampling the quantum canonical ensemble. Report only the required number of beads $P$ as your final answer. Do not include units in your final answer. The final answer does not require rounding to a specified number of significant figures; report the smallest integer $P$ that satisfies your derived criterion.", "solution": "The problem statement is subjected to validation.\n\nGivens are extracted verbatim:\n- Temperature: $T = 300\\,\\mathrm{K}$\n- Highest relevant intramolecular vibrational mode wavenumber: $\\tilde{\\nu}_{\\max} = 3300\\,\\mathrm{cm}^{-1}$\n- Method of interest: Path Integral Molecular Dynamics (PIMD) within an ab initio molecular dynamics (AIMD) framework.\n- Core task: Derive a conservative condition on the Trotter number $P$.\n- Variables for the condition: $P$, $\\beta = 1/(k_{B}T)$, and $\\omega_{\\max} = 2\\pi c\\,\\tilde{\\nu}_{\\max}$.\n- Starting point: Imaginary-time path integral representation of the quantum canonical partition function for a harmonic oscillator with Trotter discretization.\n- Identity: $\\hbar \\omega = h \\nu = h c \\tilde{\\nu}$.\n- Constant: $k_{B}/(h c) = 0.69503476\\,\\mathrm{cm}^{-1}\\,\\mathrm{K}^{-1}$.\n- Final numerical result: The smallest integer $P$ satisfying the derived condition for the given $T$ and $\\tilde{\\nu}_{\\max}$.\n- Additional tasks: Propose a consistent AIMD setup (BOMD vs. CPMD), estimate a stable time step, and justify a thermostatting strategy.\n\nValidation verdict:\nThe problem is valid. It is scientifically grounded in the established theory of quantum statistical mechanics and computational chemistry, specifically the Path Integral Molecular Dynamics method. The premises are factually correct; the value for an O–H stretch is standard, and room temperature is a common simulation condition. The problem is well-posed, providing sufficient information to derive the condition and compute the requested value. The language is objective and precise. The problem is directly relevant to the topic of *ab initio molecular dynamics*. No flaws are identified. We may proceed with the solution.\n\nThe quantum canonical partition function $Z$ for a system with Hamiltonian $\\hat{H} = \\hat{T} + \\hat{V}$ at inverse temperature $\\beta = 1/(k_{B}T)$ is $Z = \\text{Tr}[\\exp(-\\beta \\hat{H})]$. The path integral formulation relies on the Trotter factorization of the Boltzmann operator:\n$$\n\\exp(-\\beta \\hat{H}) = \\left[ \\exp\\left(-\\frac{\\beta}{P} \\hat{H}\\right) \\right]^P \\approx \\left[ \\exp\\left(-\\frac{\\beta \\hat{V}}{2P}\\right) \\exp\\left(-\\frac{\\beta \\hat{T}}{P}\\right) \\exp\\left(-\\frac{\\beta \\hat{V}}{2P}\\right) \\right]^P\n$$\nThis factorization introduces an error that is negligible only when the argument of the exponential, $(\\beta/P)\\hat{H}$, is in some sense \"small.\" The energy scale of the system is set by its highest frequency mode, $\\omega_{\\max}$. The characteristic energy is $\\hbar \\omega_{\\max}$. Therefore, for the Trotter approximation to be valid, the dimensionless quantity $(\\beta/P) \\hbar \\omega_{\\max}$ must be small compared to unity. This leads to the conservative condition:\n$$\n\\frac{\\beta \\hbar \\omega_{\\max}}{P} \\le 1 \\implies P \\ge \\beta \\hbar \\omega_{\\max}\n$$\nThis condition ensures that the imaginary time step, $\\Delta\\tau = \\hbar\\beta/P$, is smaller than the characteristic timescale of the fastest quantum oscillation, $1/\\omega_{\\max}$. Fulfilling this criterion is essential for the discretized ring-polymer representation to accurately capture the quantum mechanical delocalization, which is dominated by the zero-point motion of the highest frequency modes.\n\nWe must now calculate the minimum integer value of $P$ that satisfies this condition for the given system parameters. The required quantity is $\\beta \\hbar \\omega_{\\max}$. We can express this using the provided constants:\n$$\n\\beta \\hbar \\omega_{\\max} = \\frac{1}{k_B T} \\cdot \\hbar \\cdot (2\\pi c \\tilde{\\nu}_{\\max}) = \\frac{1}{k_B T} \\cdot \\frac{h}{2\\pi} \\cdot (2\\pi c \\tilde{\\nu}_{\\max}) = \\frac{h c \\tilde{\\nu}_{\\max}}{k_B T}\n$$\nThis can be computed as:\n$$\n\\beta \\hbar \\omega_{\\max} = \\frac{\\tilde{\\nu}_{\\max}}{T \\cdot (k_B / (hc))}\n$$\nSubstituting the given values:\n$$\n\\beta \\hbar \\omega_{\\max} = \\frac{3300\\,\\mathrm{cm}^{-1}}{300\\,\\mathrm{K} \\cdot 0.69503476\\,\\mathrm{cm}^{-1}\\,\\mathrm{K}^{-1}} = \\frac{3300}{208.510428} \\approx 15.8265\n$$\nThe condition on the Trotter number $P$ is thus $P \\ge 15.8265$. Since $P$ must be an integer, the smallest number of beads required is $P=16$.\n\nFor the ab initio PIMD setup, one must choose between Born-Oppenheimer MD (BOMD) and Car-Parrinello MD (CPMD). In AI-PIMD, the potential for each of the $P$ beads is computed on-the-fly from an electronic structure calculation. A BOMD-based approach involves optimizing the electronic wavefunction to the ground state for each of the $P$ nuclear configurations at every MD step. This is computationally demanding, scaling linearly with $P$, but is robust and conceptually straightforward. A CPMD-based approach would require propagating $P$ sets of fictitious electronic degrees of freedom, which must remain adiabatically separated from $P$ sets of nuclear degrees of freedom. This introduces severe time step limitations and complex stability challenges. Therefore, the **Born-Oppenheimer molecular dynamics (BOMD)** framework is the more practical and stable choice for AI-PIMD.\n\nThe integration time step, $\\Delta t$, must be chosen to resolve the highest frequency motion in the simulated system. In PIMD, the dynamics are those of a classical ring polymer where beads are connected by harmonic springs. The frequency of these springs is $\\omega_P = P/(\\hbar\\beta)$. The normal mode frequencies of the free ring polymer are $\\Omega_k = 2\\omega_P \\sin(k\\pi/P)$ for $k=1, \\dots, P-1$. The highest of these frequencies is $\\Omega_{\\max} \\approx 2\\omega_P = 2P/(\\hbar\\beta)$. The frequencies of the full system are $\\omega_k^{\\text{full}} = \\sqrt{\\omega_{\\text{phys}}^2 + \\Omega_k^2}$. The highest frequency is therefore dominated by the ring-polymer spring modes: $\\omega_{\\text{PIMD, max}} \\approx \\Omega_{\\max} = 2P/(\\hbar\\beta)$. The period of this fastest motion is $T_{\\min} = 2\\pi / \\omega_{\\text{PIMD, max}} = \\pi\\hbar\\beta/P$. For $P=16$, we have $T_{\\min} = \\pi \\hbar\\beta / 16$. Using our prior result, $\\hbar\\beta = (\\beta\\hbar\\omega_{\\max})/\\omega_{\\max} = 15.8265 / (2\\pi c \\tilde{\\nu}_{\\max}) \\approx 2.54 \\times 10^{-14}\\,\\mathrm{s}$, or $25.4\\,\\mathrm{fs}$. Thus, $T_{\\min} \\approx \\pi(25.4\\,\\mathrm{fs})/16 \\approx 5.0\\,\\mathrm{fs}$. A stable integration requires a time step $\\Delta t$ at least an order of magnitude smaller, so a reasonable estimate for a stable time step is $\\Delta t \\approx 0.1 - 0.2\\,\\mathrm{fs}$.\n\nFinally, for the thermostatting strategy, the PIMD system is known to suffer from severe non-ergodicity problems. A single thermostat applied to all degrees of freedom fails because energy exchange between the physical modes and the stiff, high-frequency internal modes of the ring polymer is extremely slow. This leads to incorrect sampling of the canonical ensemble. To ensure proper thermalization of all modes, a specialized thermostat is required. The optimal strategy is to apply a separate thermostat to each of the normal modes of the ring polymer. The **path integral Nosé-Hoover chain (PI-NHC)** thermostat is a standard and robust method for this purpose. It guarantees correct canonical sampling by individually thermalizing each normal mode, thereby overcoming the ergodicity issue. Alternatively, a properly configured generalized Langevin equation (GLE) thermostat can also be highly effective.", "answer": "$$\n\\boxed{16}\n$$", "id": "2759518"}, {"introduction": "While the path integral formalism provides an exact mapping of a quantum system to a classical ring polymer for calculating static equilibrium properties, it does not offer a direct solution for real-time quantum dynamics. This conceptual exercise challenges you to identify the physical phenomenon that most clearly illustrates the limitations of approximating dynamics by simply evolving the isomorphic polymer with classical equations of motion. By analyzing different potential energy surfaces [@problem_id:2459919], you will develop a critical understanding of quantum coherence and tunneling, and recognize why these effects necessitate specialized methods like RPMD or CMD.", "problem": "You are asked to select a simple one-dimensional ($1$D) model system to most clearly demonstrate the breakdown of using the Path Integral Molecular Dynamics (PIMD) isomorphism to compute real-time correlation functions by propagating the isomorphic ring polymer with classical equations of motion. Consider the exact quantum real-time position autocorrelation function\n$$\nC_{xx}(t)=\\frac{1}{Z}\\,\\mathrm{Tr}\\!\\left[e^{-\\beta \\hat H}\\,\\hat x(0)\\,\\hat x(t)\\right],\\quad \\hat x(t)=e^{\\frac{i}{\\hbar}\\hat H t}\\,\\hat x\\,e^{-\\frac{i}{\\hbar}\\hat H t},\\quad Z=\\mathrm{Tr}\\!\\left[e^{-\\beta \\hat H}\\right],\n$$\nat inverse temperature $\\beta$, where $\\hat H$ is the Hamiltonian of a single particle of mass $m$ in a $1$D potential $V(x)$ and $\\hbar$ is the reduced Planck constant. The imaginary-time path-integral isomorphism underlying PIMD is exact for equilibrium (static) quantum statistics, but it does not provide a direct route to exact real-time quantum dynamics. Which of the following single-particle $1$D potentials most cleanly exhibits qualitative features in the exact $C_{xx}(t)$ that cannot be captured by classical evolution of the isomorphic ring polymer, thereby demonstrating this breakdown? Choose the single best option.\n\nA. Harmonic oscillator: $V(x)=\\tfrac{1}{2} m \\omega^{2} x^{2}$, with $\\omega$ arbitrary.\n\nB. Symmetric double well: $V(x)=a\\,(x^{2}-b^{2})^{2}$ with $a>0$, $b>0$, and barrier height $V_{0}=a\\,b^{4}$ satisfying $V_{0}\\gg k_{\\mathrm{B}}T$ (where $k_{\\mathrm{B}}$ is the Boltzmann constant), so that the lowest two energy eigenstates are split by a small tunneling energy $\\Delta$.\n\nC. Free particle on a ring: $V(x)=0$ with periodic boundary conditions on a domain of length $L$.\n\nD. Morse oscillator: $V(x)=D_{e}\\,\\big(1-e^{-\\alpha x}\\big)^{2}$ with $D_{e}>0$ and $\\alpha>0$.", "solution": "The problem requires an identification of a one-dimensional ($1$D) potential where the classical propagation of an isomorphic ring polymer, as used in methods like Ring Polymer Molecular Dynamics (RPMD), most clearly fails to reproduce the qualitative features of the exact quantum real-time position autocorrelation function, $C_{xx}(t)$.\n\nLet us begin by establishing the fundamental principles. The exact quantum real-time position autocorrelation function is given by:\n$$\nC_{xx}(t) = \\frac{1}{Z} \\sum_{n,m} e^{-\\beta E_n} |\\langle n|\\hat{x}|m \\rangle|^2 e^{i(E_n - E_m)t/\\hbar}\n$$\nwhere $\\{|n\\rangle\\}$ and $\\{E_n\\}$ are the eigenstates and eigenvalues of the Hamiltonian $\\hat{H}$, respectively. The time evolution of $C_{xx}(t)$ is dictated by a coherent superposition of oscillations at the Bohr frequencies $\\omega_{nm} = (E_n - E_m)/\\hbar$.\n\nThe Path Integral Molecular Dynamics (PIMD) isomorphism maps a single quantum particle onto a classical ring polymer of $P$ beads. The dynamics of this ring polymer, when propagated using classical equations of motion, is intended to approximate quantum dynamics. This classical evolution, however, cannot fundamentally capture quantum coherence, which arises from the phase factors $e^{i(E_n - E_m)t/\\hbar}$. The dynamics of the classical polymer are governed by motion on a classical potential energy surface. This motion can exhibit oscillations at frequencies related to the curvature of the potential, and it can exhibit stochastic transitions over potential barriers, but it cannot reproduce oscillations whose frequencies are determined by energy level differences arising from purely quantum phenomena like tunneling.\n\nWe will now evaluate each potential to determine which one provides the most unambiguous example of this failure.\n\nA. Harmonic oscillator: $V(x)=\\tfrac{1}{2} m \\omega^{2} x^{2}$.\nThe energy levels are equidistant: $E_n = \\hbar\\omega(n+\\frac{1}{2})$. The selection rule for the position operator $\\hat{x}$ is $\\Delta n = \\pm 1$. Therefore, the only non-zero Bohr frequencies contributing to $C_{xx}(t)$ are $\\omega_{n, n\\pm 1} = \\mp \\omega$. The exact correlation function is purely oscillatory with a single frequency $\\omega$: $C_{xx}(t) \\propto \\cos(\\omega t)$.\nFor the harmonic oscillator, the classical propagation of the isomorphic ring polymer (RPMD) is known to be exact. The normal modes of the ring polymer decouple, and the centroid mode, which corresponds to the physical position, oscillates precisely at the frequency $\\omega$. Thus, the harmonic oscillator is a unique case where this approximate method yields the exact quantum result. It is therefore the worst possible choice to demonstrate the method's breakdown.\n**Verdict**: Incorrect.\n\nB. Symmetric double well: $V(x)=a\\,(x^{2}-b^{2})^{2}$ with a high barrier $V_{0}\\gg k_{\\mathrm{B}}T$.\nDue to the high potential barrier, the low-energy eigenstates are formed by symmetric and antisymmetric combinations of states localized in each well. The ground state $|0\\rangle$ (symmetric) and the first excited state $|1\\rangle$ (antisymmetric) are separated by a small tunneling splitting, $\\Delta = E_1 - E_0$. At low temperatures ($k_{\\mathrm{B}}T \\ll V_0$), these are the dominant states in the thermal ensemble.\nThe position operator $\\hat{x}$ has odd parity, so it only connects states of opposite parity. The most significant matrix element at low energy is $\\langle 0|\\hat{x}|1 \\rangle$. The corresponding Bohr frequency is $\\omega_{10} = \\Delta/\\hbar$. Consequently, the exact $C_{xx}(t)$ will exhibit a slow, coherent oscillation at this tunneling frequency: $C_{xx}(t) \\propto \\cos((\\Delta/\\hbar) t)$. This oscillation represents the particle coherently tunneling back and forth between the two wells.\nNow, consider the classical dynamics of the isomorphic ring polymer. The polymer as a whole is localized in one of the two wells. For the system to transition between wells, the entire polymer must cross the potential barrier. This is a classical, thermally activated process. The dynamics will be characterized by incoherent, stochastic hopping between the wells, with a rate determined by an Arrhenius law. The resulting correlation function will show an exponential-like decay, not a coherent oscillation. The classical system is fundamentally incapable of capturing the coherent superposition of left-well and right-well states that leads to tunneling oscillations.\nThis presents a stark, qualitative disagreement: the exact quantum dynamics are oscillatory and coherent, while the approximate classical polymer dynamics are stochastic and incoherent. This is the canonical example of the failure of RPMD to describe quantum coherence.\n**Verdict**: Correct.\n\nC. Free particle on a ring: $V(x)=0$ with periodic boundary conditions on a domain of length $L$.\nThe eigenstates are plane waves with energies $E_n = \\frac{\\hbar^2}{2m}(\\frac{2\\pi n}{L})^2$. The quantum dynamics involves the dispersion of wave packets. The time-correlation function $C_{xx}(t)$ will decay over time as an initial localized state spreads out over the ring.\nIn the RPMD description, the system is a ring polymer of free particles connected by harmonic springs. The centroid of this polymer moves as a classical free particle. The internal modes of the polymer oscillate. The resulting correlation function from RPMD will also show a decay of correlations. While the functional form of the decay will not be exact, the qualitative behavior—the decay of position correlation over time—is captured. The failure is quantitative, not a stark qualitative contradiction as seen in the double-well case. There is no unique, purely quantum oscillatory feature like tunneling that is completely absent in the classical model.\n**Verdict**: Incorrect.\n\nD. Morse oscillator: $V(x)=D_{e}\\,\\big(1-e^{-\\alpha x}\\big)^{2}$.\nThis potential is anharmonic and supports a finite number of bound states. The energy levels are not equidistant: $E_n \\approx \\hbar\\omega_e(n+\\frac{1}{2}) - \\hbar\\omega_e x_e (n+\\frac{1}{2})^2$. The selection rules for $\\hat{x}$ are relaxed compared to the harmonic oscillator, so transitions with $\\Delta n = \\pm 1, \\pm 2, \\ldots$ are allowed. The exact $C_{xx}(t)$ will be a superposition of many different frequencies, leading to dephasing and decay of the correlation function, with possible recurrences (quantum beats).\nThe RPMD simulation for a Morse oscillator involves a classical ring polymer where each bead experiences the Morse potential. Due to the anharmonicity, the normal modes of the polymer are coupled. This coupling leads to energy flow between modes, resulting in the decay of the position autocorrelation function. Thus, RPMD does capture the qualitative feature of vibrational dephasing and decay, which is also present in the exact quantum dynamics. The failure is largely quantitative, concerning the exact frequencies and decay rates. It does not represent a complete qualitative breakdown where an entire class of physical phenomenon (like coherent tunneling) is missed.\n**Verdict**: Incorrect.\n\nConclusion: The symmetric double-well potential provides the most unambiguous and qualitatively clear demonstration of the breakdown. The quantum system exhibits coherent tunneling oscillations, a feature fundamentally absent in the classical, incoherent hopping dynamics of the isomorphic ring polymer.", "answer": "$$\\boxed{B}$$", "id": "2459919"}, {"introduction": "Building upon the path integral framework, several powerful methods like Ring Polymer Molecular Dynamics (RPMD), Centroid Molecular Dynamics (CMD), and Thermostatted RPMD (TRPMD) have been developed to approximate quantum dynamics. This comprehensive computational problem allows you to perform a principled comparison of these techniques for the quantum harmonic oscillator, a benchmark model with known exact solutions. By implementing the normal-mode representation to calculate both static properties (position variance) from PIMD and dynamic metrics (effective frequencies) from RPMD, CMD, and TRPMD, you will gain invaluable hands-on insight into the relationships, strengths, and approximations inherent in each method [@problem_id:2793590].", "problem": "Construct a complete, runnable program that, for a one-dimensional quantum harmonic oscillator, implements a principled comparison of four path integral-based molecular dynamics approximations: Path Integral Molecular Dynamics (PIMD), Ring Polymer Molecular Dynamics (RPMD), Centroid Molecular Dynamics (CMD), and Thermostatted Ring Polymer Molecular Dynamics (TRPMD). Your program must compute specified equilibrium and dynamical summary quantities from first principles, starting from the path-integral discretization and the ring-polymer normal-mode representation.\n\nYou must adhere to the following requirements.\n\n- Physical model. Consider a single particle of mass $m$ moving in the harmonic potential $V(x) = \\tfrac{1}{2} m \\omega^2 x^2$ at inverse temperature $\\beta$. Use reduced units where Planck's constant and Boltzmann's constant are $ \\hbar = 1 $ and $ k_B = 1 $. All quantities must be expressed in these reduced units.\n\n- Fundamental base to use. Begin from the imaginary-time Feynman path integral discretized into $P$ time slices and mapped to a classical ring polymer with $P$ beads. The corresponding ring-polymer Hamiltonian is a sum of $P$ decoupled harmonic modes in the normal-mode representation. Let the ring-polymer spring frequency be $\\omega_P = \\dfrac{P}{\\beta \\hbar}$, and the $k$-th normal-mode frequency be\n$$\n\\Omega_k \\equiv \\sqrt{ \\omega^2 + 4 \\omega_P^2 \\sin^2\\!\\left( \\frac{\\pi k}{P} \\right) }, \\quad k = 0,1,\\dots,P-1.\n$$\nYour derivations must rely on this representation and the Gaussian statistics of harmonic modes under canonical sampling.\n\n- Quantities to compute. For each parameter set, compute the following:\n  1. The PIMD bead-averaged position variance for a single bead, denoted $\\langle x^2 \\rangle_{\\text{PIMD}}(P)$, expressed in terms of the ring-polymer normal modes. This must come from the equilibrium covariance of bead coordinates implied by the normal modes.\n  2. The exact quantum mechanical variance for the harmonic oscillator:\n  $$\n  \\langle x^2 \\rangle_{\\text{exact}} = \\frac{\\hbar}{2 m \\omega} \\coth\\!\\left( \\frac{\\beta \\hbar \\omega}{2} \\right),\n  $$\n  expressed in the specified reduced units.\n  3. A summary frequency for RPMD, defined as the bead-averaged position autocorrelation’s normal-mode weighted mean oscillation frequency. Construct this by using the equilibrium mode-amplitude weights that appear in the PIMD variance and the undamped frequencies $\\Omega_k$.\n  4. A corresponding summary frequency for TRPMD, defined the same way but with internal modes $(k \\neq 0)$ undergoing Langevin damping with a uniform friction coefficient $\\gamma$ applied to the internal normal modes only, leaving the centroid mode $(k=0)$ undamped. For each internal mode, use the underdamped frequency $\\sqrt{\\max(\\Omega_k^2 - \\gamma^2/4,\\,0)}$ in the weighted mean.\n  5. The CMD summary frequency, obtained by adiabatic removal of internal modes so that only the centroid mode contributes dynamically.\n  6. The exact harmonic frequency.\n\n- Angle unit. All frequencies must be treated and reported in radians per unit time.\n\n- Output specification. For each test case, output a list containing the following seven floats in this exact order:\n  - $\\langle x^2 \\rangle_{\\text{PIMD}}(P)$\n  - $\\langle x^2 \\rangle_{\\text{exact}}$\n  - The RPMD weighted-mean frequency\n  - The TRPMD weighted-mean frequency\n  - The CMD frequency\n  - The exact harmonic frequency\n  - The relative error in the PIMD variance with respect to the exact value, defined as $\\left( \\langle x^2 \\rangle_{\\text{PIMD}} - \\langle x^2 \\rangle_{\\text{exact}} \\right) / \\langle x^2 \\rangle_{\\text{exact}}$\n\n- Test suite. Your program must evaluate exactly the following four parameter sets, each given as a tuple $(m,\\omega,\\beta,\\hbar,P,\\gamma)$ in reduced units with $\\hbar=1$ enforced internally:\n  - Case A (boundary, single bead): $(1.0,\\,1.0,\\,5.0,\\,1.0,\\,1,\\,0.8)$\n  - Case B (low temperature, many beads): $(1.0,\\,1.0,\\,20.0,\\,1.0,\\,64,\\,1.0)$\n  - Case C (high frequency, moderate beads): $(1.0,\\,3.0,\\,1.0,\\,1.0,\\,16,\\,2.0)$\n  - Case D (heavier mass, softer mode): $(2.0,\\,0.5,\\,10.0,\\,1.0,\\,32,\\,0.5)$\n\n- Final output format. Your program should produce a single line of output containing a list of four lists, one per test case, in the exact order A, B, C, D. Each inner list must contain the seven floats described above, and the outer list must be printed as a comma-separated list enclosed in square brackets. For example:\n\"[[a1,a2,a3,a4,a5,a6,a7],[b1,b2,b3,b4,b5,b6,b7],[c1,c2,c3,c4,c5,c6,c7],[d1,d2,d3,d4,d5,d6,d7]]\"\n\nNo user input is allowed; the program must be fully self-contained and run as-is.", "solution": "The problem statement is subjected to rigorous validation.\n\n**Step 1: Extract Givens**\n-   **Physical System**: A one-dimensional quantum harmonic oscillator with mass $m$ and potential $V(x) = \\frac{1}{2} m \\omega^2 x^2$.\n-   **Thermodynamic State**: Inverse temperature $\\beta = 1/(k_B T)$.\n-   **Units**: Reduced units with $\\hbar = 1$ and $k_B = 1$.\n-   **Path Integral Model**: Ring polymer with $P$ beads.\n-   **Ring-Polymer Spring Frequency**: $\\omega_P = \\frac{P}{\\beta \\hbar}$.\n-   **Normal-Mode Frequencies**: $\\Omega_k = \\sqrt{ \\omega^2 + 4 \\omega_P^2 \\sin^2\\!\\left( \\frac{\\pi k}{P} \\right) }$ for $k = 0, 1, \\dots, P-1$.\n-   **Quantities to Compute**:\n    1.  PIMD bead-averaged position variance, $\\langle x^2 \\rangle_{\\text{PIMD}}(P)$.\n    2.  Exact quantum mechanical position variance, $\\langle x^2 \\rangle_{\\text{exact}} = \\frac{\\hbar}{2 m \\omega} \\coth\\!\\left( \\frac{\\beta \\hbar \\omega}{2} \\right)$.\n    3.  RPMD summary frequency, $\\omega_{\\text{RPMD}}$.\n    4.  TRPMD summary frequency, $\\omega_{\\text{TRPMD}}$, with internal mode friction $\\gamma$. Damped frequency for $k \\neq 0$ is $\\sqrt{\\max(\\Omega_k^2 - \\gamma^2/4, 0)}$.\n    5.  CMD summary frequency, $\\omega_{\\text{CMD}}$.\n    6.  Exact harmonic frequency, $\\omega$.\n    7.  Relative error: $(\\langle x^2 \\rangle_{\\text{PIMD}} - \\langle x^2 \\rangle_{\\text{exact}}) / \\langle x^2 \\rangle_{\\text{exact}}$.\n-   **Test Parameters**: Four sets of $(m, \\omega, \\beta, \\hbar, P, \\gamma)$ are provided.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is scientifically grounded within the established framework of theoretical and computational chemistry. It is well-posed, objective, and self-contained. The provided formulas and concepts—the ring-polymer isomorphism, normal-mode analysis, and the definitions of PIMD, RPMD, CMD, and TRPMD—are standard in the field. The harmonic oscillator is a canonical, non-trivial model system for which exact results are known, allowing for a principled comparison. There are no contradictions, ambiguities, or factual inaccuracies.\n\n**Step 3: Verdict and Action**\nThe problem is deemed **valid**. We proceed to the derivation of the required quantities from first principles as specified.\n\nThe foundation of our analysis is the classical isomorphism of the quantum partition function, which maps a single quantum particle to a classical ring polymer of $P$ beads. For a harmonic potential, the ring-polymer potential energy is a quadratic form in the bead coordinates $\\{x_j\\}$. This quadratic form is diagonalized by a transformation to normal-mode coordinates $\\{c_k'\\}$. The potential energy in these coordinates is:\n$$\nV_{\\text{NM}} = \\frac{1}{2} m \\sum_{k=0}^{P-1} \\Omega_k^2 (c_k')^2\n$$\nwhere $\\Omega_k$ are the given normal-mode frequencies. Each normal mode behaves as an independent classical harmonic oscillator.\n\n1.  **PIMD Bead-Averaged Position Variance, $\\langle x^2 \\rangle_{\\text{PIMD}}(P)$**\n    The ring-polymer model is a classical system at inverse temperature $\\beta$. By the equipartition theorem, the average potential energy stored in each normal mode is $\\frac{1}{2}k_B T = \\frac{1}{2\\beta}$.\n    $$\n    \\frac{1}{2} m \\Omega_k^2 \\langle (c_k')^2 \\rangle = \\frac{1}{2\\beta} \\implies \\langle (c_k')^2 \\rangle = \\frac{1}{\\beta m \\Omega_k^2}\n    $$\n    The transformation from bead coordinates $\\{x_j\\}$ to normal-mode coordinates $\\{c_k'\\}$ is orthogonal. Therefore, by Parseval's theorem, the sum of squared positions is conserved: $\\sum_{j=0}^{P-1} x_j^2 = \\sum_{k=0}^{P-1} (c_k')^2$. Taking the thermal average:\n    $$\n    \\sum_{j=0}^{P-1} \\langle x_j^2 \\rangle = \\sum_{k=0}^{P-1} \\langle (c_k')^2 \\rangle\n    $$\n    By symmetry, all beads are equivalent, so $\\langle x_j^2 \\rangle$ is the same for all $j$. We denote this as $\\langle x^2 \\rangle_{\\text{PIMD}}$.\n    $$\n    P \\langle x^2 \\rangle_{\\text{PIMD}} = \\sum_{k=0}^{P-1} \\frac{1}{\\beta m \\Omega_k^2}\n    $$\n    Thus, the bead-averaged position variance is:\n    $$\n    \\langle x^2 \\rangle_{\\text{PIMD}}(P) = \\frac{1}{P \\beta m} \\sum_{k=0}^{P-1} \\frac{1}{\\Omega_k^2}\n    $$\n    Substituting the expression for $\\Omega_k$ and setting $\\hbar=1$:\n    $$\n    \\langle x^2 \\rangle_{\\text{PIMD}}(P) = \\frac{1}{P \\beta m} \\sum_{k=0}^{P-1} \\frac{1}{\\omega^2 + 4(P/\\beta)^2 \\sin^2(\\pi k / P)}\n    $$\n\n2.  **Exact Quantum Variance, $\\langle x^2 \\rangle_{\\text{exact}}$**\n    This quantity is provided directly. With $\\hbar=1$:\n    $$\n    \\langle x^2 \\rangle_{\\text{exact}} = \\frac{1}{2 m \\omega} \\coth\\left(\\frac{\\beta \\omega}{2}\\right)\n    $$\n\n3.  **RPMD Summary Frequency, $\\omega_{\\text{RPMD}}$**\n    The problem defines this as a weighted mean of the normal-mode frequencies $\\Omega_k$. The weights are proportional to each mode's contribution to the position variance, which is proportional to $\\langle (c_k')^2 \\rangle$ and thus to $1/\\Omega_k^2$. Let the weights be $w_k = C / \\Omega_k^2$ where $C$ is a normalization constant. The weighted average is:\n    $$\n    \\omega_{\\text{RPMD}} = \\frac{\\sum_{k=0}^{P-1} w_k \\Omega_k}{\\sum_{k=0}^{P-1} w_k} = \\frac{\\sum_{k=0}^{P-1} (1/\\Omega_k^2) \\Omega_k}{\\sum_{k=0}^{P-1} 1/\\Omega_k^2} = \\frac{\\sum_{k=0}^{P-1} 1/\\Omega_k}{\\sum_{k=0}^{P-1} 1/\\Omega_k^2}\n    $$\n\n4.  **TRPMD Summary Frequency, $\\omega_{\\text{TRPMD}}$**\n    This is constructed similarly to $\\omega_{\\text{RPMD}}$, but the internal modes ($k=1, \\dots, P-1$) have their frequencies modified by Langevin damping with friction $\\gamma$. The centroid mode ($k=0$) remains undamped. The frequency for the centroid mode is $\\Omega_0 = \\omega$. The frequencies for the internal modes are $\\Omega'_k = \\sqrt{\\max(0, \\Omega_k^2 - \\gamma^2/4)}$. The weighted average is:\n    $$\n    \\omega_{\\text{TRPMD}} = \\frac{w_0 \\Omega_0 + \\sum_{k=1}^{P-1} w_k \\Omega'_k}{\\sum_{k=0}^{P-1} w_k} = \\frac{(1/\\Omega_0^2) \\Omega_0 + \\sum_{k=1}^{P-1} (1/\\Omega_k^2) \\Omega'_k}{\\sum_{k=0}^{P-1} 1/\\Omega_k^2}\n    $$\n    Substituting $\\Omega_0 = \\omega$ and the expression for $\\Omega'_k$:\n    $$\n    \\omega_{\\text{TRPMD}} = \\frac{(1/\\omega) + \\sum_{k=1}^{P-1} \\Omega_k^{-2} \\sqrt{\\max(0, \\Omega_k^2 - \\gamma^2/4)}}{\\sum_{k=0}^{P-1} 1/\\Omega_k^2}\n    $$\n\n5.  **CMD Summary Frequency, $\\omega_{\\text{CMD}}$**\n    Centroid Molecular Dynamics describes the evolution of the ring-polymer centroid, $q_c = \\frac{1}{P} \\sum_j x_j$, on a potential of mean force (PMF) generated by integrating out the internal modes. For a quantum harmonic oscillator, the PMF is exactly harmonic with the same frequency as the original potential. This is a known exact result. Therefore, the CMD frequency is identical to the physical frequency of the oscillator. Dynamically, this corresponds to the frequency of the centroid normal mode, $\\Omega_0$.\n    $$\n    \\omega_{\\text{CMD}} = \\Omega_0 = \\sqrt{\\omega^2 + 4 \\omega_P^2 \\sin^2(0)} = \\omega\n    $$\n\n6.  **Exact Harmonic Frequency, $\\omega_{\\text{exact}}$**\n    This is the parameter $\\omega$ of the harmonic potential.\n    $$\n    \\omega_{\\text{exact}} = \\omega\n    $$\n\n7.  **Relative Error in PIMD Variance**\n    This is defined by the problem statement:\n    $$\n    \\text{Error} = \\frac{\\langle x^2 \\rangle_{\\text{PIMD}}(P) - \\langle x^2 \\rangle_{\\text{exact}}}{\\langle x^2 \\rangle_{\\text{exact}}}\n    $$\n\nThese seven quantities will be computed for each parameter set provided.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes equilibrium and dynamical properties for a 1D quantum harmonic oscillator\n    using PIMD, RPMD, CMD, and TRPMD approximations based on the normal-mode representation.\n    \"\"\"\n    # Test cases: (m, omega, beta, hbar, P, gamma)\n    # The problem specifies hbar=1, which is used in the calculations.\n    test_cases = [\n        (1.0, 1.0, 5.0, 1.0, 1, 0.8),    # Case A\n        (1.0, 1.0, 20.0, 1.0, 64, 1.0),   # Case B\n        (1.0, 3.0, 1.0, 1.0, 16, 2.0),   # Case C\n        (2.0, 0.5, 10.0, 1.0, 32, 0.5),  # Case D\n    ]\n\n    all_results = []\n\n    for case in test_cases:\n        m, omega, beta, hbar, P, gamma = case\n\n        # Enforce reduced units\n        hbar = 1.0\n        k_B = 1.0\n\n        # --- Normal Mode Frequencies ---\n        # Ring-polymer spring frequency\n        omega_P = P / (beta * hbar)\n        \n        # Normal mode indices k = 0, 1, ..., P-1\n        k_indices = np.arange(P)\n        \n        # Normal mode frequencies squared, Omega_k^2\n        sin_term = np.sin(np.pi * k_indices / P)\n        Omega_k_sq = omega**2 + 4 * omega_P**2 * sin_term**2\n        Omega_k = np.sqrt(Omega_k_sq)\n\n        # --- 1. PIMD Bead-Averaged Position Variance ---\n        # <x^2>_PIMD = (1 / (P * beta * m)) * sum(1 / Omega_k^2)\n        inv_Omega_k_sq = 1.0 / Omega_k_sq\n        pimd_variance = np.sum(inv_Omega_k_sq) / (P * beta * m)\n\n        # --- 2. Exact Quantum Variance ---\n        # <x^2>_exact = (hbar / (2*m*omega)) * coth(beta*hbar*omega/2)\n        arg = beta * hbar * omega / 2.0\n        # Use 1/tanh(x) for coth(x) for numerical stability.\n        # For x > ~36, tanh(x) is 1.0 in float64, so avoid overflow with exp.\n        if arg > 36:\n            coth_val = 1.0\n        else:\n            coth_val = 1.0 / np.tanh(arg) \n        exact_variance = (hbar / (2.0 * m * omega)) * coth_val\n\n        # --- 3. RPMD Summary Frequency ---\n        # omega_RPMD = sum(1/Omega_k) / sum(1/Omega_k^2)\n        inv_Omega_k = 1.0 / Omega_k\n        rpmd_freq = np.sum(inv_Omega_k) / np.sum(inv_Omega_k_sq)\n\n        # --- 4. TRPMD Summary Frequency ---\n        # omega_TRPMD includes damping on internal modes (k > 0)\n        # Undamped centroid mode (k=0) frequency is omega\n        # Damped internal mode frequencies are sqrt(max(0, Omega_k^2 - gamma^2/4))\n        \n        # Numerator: w_0*Omega_0 + sum_{k>0} w_k*Omega'_k\n        # w_k is proportional to 1/Omega_k^2\n        # Numerator simplifies to (1/Omega_0) + sum_{k>0} Omega'_k/Omega_k^2\n        if P > 1:\n            Omega_k_internal_sq = Omega_k_sq[1:]\n            damped_freq_internal = np.sqrt(np.maximum(0, Omega_k_internal_sq - (gamma**2 / 4.0)))\n            \n            numerator = inv_Omega_k[0] + np.sum(damped_freq_internal / Omega_k_internal_sq)\n        else: # P=1, no internal modes\n            numerator = inv_Omega_k[0]\n\n        # Denominator is sum(1/Omega_k^2), same as for RPMD\n        denominator = np.sum(inv_Omega_k_sq)\n        trpmd_freq = numerator / denominator\n\n        # --- 5. CMD Summary Frequency ---\n        # For a harmonic oscillator, the CMD frequency is exactly omega.\n        cmd_freq = omega\n\n        # --- 6. Exact Harmonic Frequency ---\n        exact_freq = omega\n        \n        # --- 7. Relative Error in PIMD Variance ---\n        rel_error = (pimd_variance - exact_variance) / exact_variance\n\n        case_results = [\n            pimd_variance,\n            exact_variance,\n            rpmd_freq,\n            trpmd_freq,\n            cmd_freq,\n            exact_freq,\n            rel_error\n        ]\n        all_results.append(case_results)\n\n    # Final output formatted as a single line string \"[[],[],[],[]]\" without spaces\n    print(str(all_results).replace(\" \", \"\"))\n\nsolve()\n```", "id": "2793590"}]}