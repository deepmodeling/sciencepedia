{"hands_on_practices": [{"introduction": "To begin our exploration of surface hopping, we must first understand the quantum engine that drives the dynamics: the time evolution of the electronic wavefunction. This exercise simplifies the complex reality of a molecule's journey to an exactly solvable model, allowing you to integrate the time-dependent Schrödinger equation by hand. By solving for the electronic state populations, you will gain fundamental insight into how nonadiabatic coupling facilitates population transfer between states, forming the very basis for the probability of a \"hop\" [@problem_id:2681596].", "problem": "Consider a two-state nonadiabatic system treated within Fewest Switches Surface Hopping (FSSH), where the nuclei follow a prescribed classical trajectory $\\mathbf{R}(t)$ and the electronic amplitudes $c_{i}(t)$ evolve according to the time-dependent Schrödinger equation (TDSE). In the adiabatic representation, the electronic Hamiltonian along the classical path is given by $H_{ab}(t)=E_{a}(\\mathbf{R}(t))\\delta_{ab}-i\\hbar\\,\\dot{\\mathbf{R}}(t)\\cdot\\mathbf{d}_{ab}(\\mathbf{R}(t))$, where $\\mathbf{d}_{ab}(\\mathbf{R})=\\langle\\phi_{a}(\\mathbf{R})|\\nabla_{\\mathbf{R}}|\\phi_{b}(\\mathbf{R})\\rangle$ are the derivative couplings and $E_{a}(\\mathbf{R})$ are the adiabatic energies. Assume a short time window $t\\in[0,T]$ during which the following holds along the trajectory:\n- The adiabatic energies are locally degenerate to leading order, $E_{1}(\\mathbf{R}(t))=E_{2}(\\mathbf{R}(t))$ for all $t\\in[0,T]$.\n- The velocity is constant and colinear with the derivative coupling, $\\dot{\\mathbf{R}}(t)=\\mathbf{v}$ with $|\\mathbf{v}|=v$ and $\\mathbf{d}_{12}(\\mathbf{R}(t))=\\mathbf{d}_{0}$ with $|\\mathbf{d}_{0}|=d_{0}$, and $\\mathbf{v}\\parallel\\mathbf{d}_{0}$, so that $\\kappa\\equiv\\dot{\\mathbf{R}}(t)\\cdot \\mathbf{d}_{12}(\\mathbf{R}(t))=v d_{0}$ is constant.\n- The initial electronic condition at $t=0$ is $c_{1}(0)=1$ and $c_{2}(0)=0$.\n\nUnder these assumptions, the adiabatic electronic Hamiltonian is time-independent with off-diagonal elements determined by the derivative coupling term. Using the TDSE $i\\hbar\\,\\dot{\\mathbf{c}}(t)=H(t)\\,\\mathbf{c}(t)$, integrate to obtain $c_{1}(t)$ and $c_{2}(t)$, and from them the populations $p_{i}(t)=|c_{i}(t)|^{2}$ and the coherence $\\rho_{12}(t)=c_{1}(t)c_{2}(t)^{\\ast}$. Then evaluate the excited-state population $p_{2}(T)$ for the specific parameters $v=2.0 \\, \\text{Å ps}^{-1}$, $d_{0}=\\pi/16 \\, \\text{Å}^{-1}$, and $T=2.0 \\, \\text{ps}$. Assume all trigonometric functions use arguments in radians. Express the final answer as a single exact number (no units). No rounding is required.", "solution": "The problem statement has been evaluated and is deemed valid. It presents a well-posed, scientifically grounded problem in quantum dynamics. The scenario is an idealized but standard model of nonadiabatic transitions in a two-level system, commonly used for pedagogical purposes. All necessary parameters and initial conditions are provided, and there are no internal contradictions or violations of fundamental principles.\n\nThe task is to solve the time-dependent Schrödinger equation (TDSE) for a two-state system under a set of simplifying assumptions. The TDSE is given by $i\\hbar\\,\\dot{\\mathbf{c}}(t)=H(t)\\,\\mathbf{c}(t)$, where $\\mathbf{c}(t) = \\begin{pmatrix} c_1(t) \\\\ c_2(t) \\end{pmatrix}$ is the vector of electronic amplitudes in the adiabatic basis.\n\nThe adiabatic Hamiltonian matrix elements are $H_{ab}(t) = E_{a}(\\mathbf{R}(t))\\delta_{ab} - i\\hbar\\,\\dot{\\mathbf{R}}(t)\\cdot\\mathbf{d}_{ab}(\\mathbf{R}(t))$. The derivative couplings satisfy the relation $\\mathbf{d}_{ab} = -\\mathbf{d}_{ba}^*$. For the typical case of real adiabatic wavefunctions, this simplifies to $\\mathbf{d}_{ab} = -\\mathbf{d}_{ba}$. The diagonal derivative couplings $\\mathbf{d}_{aa}$ are zero.\n\nThe problem states the following assumptions for the time interval $t \\in [0, T]$:\n$1$. The adiabatic energies are degenerate: $E_{1}(t) = E_{2}(t)$. We can set this common energy to zero, $E_{1} = E_{2} = 0$, as a global energy shift only adds a common phase factor to the amplitudes, which does not affect populations.\n$2$. The nonadiabatic coupling term $\\dot{\\mathbf{R}}(t)\\cdot \\mathbf{d}_{12}(\\mathbf{R}(t))$ is a constant, which we define as $\\kappa \\equiv v d_{0}$.\n\nWith these assumptions, the Hamiltonian matrix becomes time-independent. The elements are:\n$H_{11} = E_{1} - i\\hbar \\dot{\\mathbf{R}} \\cdot \\mathbf{d}_{11} = 0 - 0 = 0$.\n$H_{22} = E_{2} - i\\hbar \\dot{\\mathbf{R}} \\cdot \\mathbf{d}_{22} = 0 - 0 = 0$.\n$H_{12} = -i\\hbar \\dot{\\mathbf{R}}(t) \\cdot \\mathbf{d}_{12}(\\mathbf{R}(t)) = -i\\hbar\\kappa$.\n$H_{21} = -i\\hbar \\dot{\\mathbf{R}}(t) \\cdot \\mathbf{d}_{21}(\\mathbf{R}(t)) = -i\\hbar \\dot{\\mathbf{R}}(t) \\cdot (-\\mathbf{d}_{12}(\\mathbf{R}(t))) = i\\hbar\\kappa$.\nThe Hamiltonian is thus:\n$$ H = \\begin{pmatrix} 0 & -i\\hbar\\kappa \\\\ i\\hbar\\kappa & 0 \\end{pmatrix} $$\nThe TDSE, $i\\hbar\\,\\dot{\\mathbf{c}} = H\\mathbf{c}$, becomes:\n$$ i\\hbar \\frac{d}{dt}\\begin{pmatrix} c_{1}(t) \\\\ c_{2}(t) \\end{pmatrix} = \\begin{pmatrix} 0 & -i\\hbar\\kappa \\\\ i\\hbar\\kappa & 0 \\end{pmatrix} \\begin{pmatrix} c_{1}(t) \\\\ c_{2}(t) \\end{pmatrix} $$\nDividing by $i\\hbar$, we obtain a system of coupled ordinary differential equations:\n$$ \\frac{d c_{1}}{dt} = -\\kappa c_{2}(t) $$\n$$ \\frac{d c_{2}}{dt} = \\kappa c_{1}(t) $$\nTo solve this system, we differentiate the first equation with respect to time:\n$$ \\frac{d^2 c_{1}}{dt^2} = -\\kappa \\frac{d c_{2}}{dt} $$\nSubstituting the second equation into this expression gives a second-order ODE for $c_1(t)$:\n$$ \\frac{d^2 c_{1}}{dt^2} = -\\kappa (\\kappa c_{1}(t)) = -\\kappa^2 c_{1}(t) $$\nThis is the equation for a simple harmonic oscillator, $\\ddot{c}_1 + \\kappa^2 c_1 = 0$, with the general solution:\n$$ c_{1}(t) = A \\cos(\\kappa t) + B \\sin(\\kappa t) $$\nThe constants $A$ and $B$ are determined by the initial conditions at $t=0$: $c_{1}(0)=1$ and $c_{2}(0)=0$.\nFrom $c_{1}(0)=1$:\n$$ c_{1}(0) = A \\cos(0) + B \\sin(0) = A = 1 $$\nSo, $c_{1}(t) = \\cos(\\kappa t) + B \\sin(\\kappa t)$.\nFrom the first ODE, we have $\\dot{c}_{1}(t) = -\\kappa c_{2}(t)$. At $t=0$, $\\dot{c}_{1}(0) = -\\kappa c_{2}(0) = -\\kappa(0) = 0$.\nDifferentiating our solution for $c_1(t)$:\n$$ \\dot{c}_{1}(t) = -\\kappa \\sin(\\kappa t) + B\\kappa \\cos(\\kappa t) $$\nAt $t=0$:\n$$ \\dot{c}_{1}(0) = -\\kappa \\sin(0) + B\\kappa \\cos(0) = B\\kappa $$\nSince $\\dot{c}_{1}(0)=0$ and $\\kappa \\neq 0$, we must have $B=0$.\nThus, the solution for $c_{1}(t)$ is:\n$$ c_{1}(t) = \\cos(\\kappa t) $$\nNow we find $c_{2}(t)$ using the second ODE: $\\dot{c}_{2}(t) = \\kappa c_{1}(t) = \\kappa \\cos(\\kappa t)$.\nIntegrating with respect to time:\n$$ c_{2}(t) = \\int \\kappa \\cos(\\kappa t) dt = \\sin(\\kappa t) + C' $$\nUsing the initial condition $c_{2}(0)=0$:\n$$ c_{2}(0) = \\sin(0) + C' = C' = 0 $$\nThus, the solution for $c_{2}(t)$ is:\n$$ c_{2}(t) = \\sin(\\kappa t) $$\nThe populations $p_{i}(t) = |c_{i}(t)|^{2}$ and the coherence $\\rho_{12}(t) = c_{1}(t)c_{2}(t)^*$ are:\n$$ p_{1}(t) = \\cos^2(\\kappa t) $$\n$$ p_{2}(t) = \\sin^2(\\kappa t) $$\n$$ \\rho_{12}(t) = \\cos(\\kappa t)\\sin(\\kappa t) = \\frac{1}{2}\\sin(2\\kappa t) $$\nWe are asked to evaluate the excited-state population $p_{2}(T)$ for the given parameters. The expression is:\n$$ p_{2}(T) = \\sin^2(\\kappa T) $$\nThe parameter $\\kappa$ is given by the product of velocity magnitude $v$ and derivative coupling magnitude $d_0$:\n$$ \\kappa = v d_{0} = (2.0 \\, \\text{Å ps}^{-1}) \\times (\\frac{\\pi}{16} \\, \\text{Å}^{-1}) = \\frac{2.0\\pi}{16} \\, \\text{ps}^{-1} = \\frac{\\pi}{8} \\, \\text{ps}^{-1} $$\nThe argument of the sine function is $\\kappa T$:\n$$ \\kappa T = (\\frac{\\pi}{8} \\, \\text{ps}^{-1}) \\times (2.0 \\, \\text{ps}) = \\frac{2.0\\pi}{8} = \\frac{\\pi}{4} $$\nThe argument is a dimensionless value in radians, as required.\nFinally, we compute the population $p_2(T)$:\n$$ p_{2}(T) = \\sin^2\\left(\\frac{\\pi}{4}\\right) $$\nSince $\\sin(\\frac{\\pi}{4}) = \\frac{\\sqrt{2}}{2}$, the population is:\n$$ p_{2}(T) = \\left(\\frac{\\sqrt{2}}{2}\\right)^2 = \\frac{2}{4} = \\frac{1}{2} $$\nThe final answer is an exact number.", "answer": "$$\\boxed{\\frac{1}{2}}$$", "id": "2681596"}, {"introduction": "The previous exercise demonstrated how a nonadiabatic coupling term, $d_{ij}$, drives population transfer. But where does this crucial term come from, and what determines its magnitude? This practice problem delves into the origin of the nonadiabatic coupling, showing how it arises directly from the structure of the electronic Hamiltonian and its change with nuclear geometry. By deriving the coupling for a classic avoided-crossing model, you will discover that the interaction is strongest precisely where the adiabatic energy gap is smallest, a foundational concept in nonadiabatic chemistry [@problem_id:2681616].", "problem": "Consider a one-dimensional two-state avoided-crossing model frequently used in Fewest Switches Surface Hopping (FSSH) simulations of nonadiabatic dynamics. Let the diabatic Hamiltonian be\n$$\nH(x)=\\begin{pmatrix}\n\\Delta+\\kappa x & \\lambda\\\\\n\\lambda & -(\\Delta+\\kappa x)\n\\end{pmatrix},\n$$\nwith real parameters $\\Delta$, $\\kappa$, and $\\lambda$, and coordinate $x$. The corresponding adiabatic potential energy surfaces are\n$$\nE_{1,2}(x)=\\mp\\sqrt{(\\Delta+\\kappa x)^{2}+\\lambda^{2}},\n$$\nwith ordering $E_{1}(x)\\le E_{2}(x)$. Let $\\{\\,|\\phi_{j}(x)\\rangle\\,\\}_{j=1,2}$ denote the adiabatic eigenstates satisfying the time-independent Schrödinger equation $H(x)|\\phi_{j}(x)\\rangle=E_{j}(x)|\\phi_{j}(x)\\rangle$ and the orthonormality condition $\\langle\\phi_{i}(x)|\\phi_{j}(x)\\rangle=\\delta_{ij}$. Define the nonadiabatic derivative coupling $d_{12}(x)=\\langle\\phi_{1}(x)|\\partial_{x}\\phi_{2}(x)\\rangle$.\n\nStarting only from the eigenvalue equation $H(x)|\\phi_{j}(x)\\rangle=E_{j}(x)|\\phi_{j}(x)\\rangle$ and orthonormality, derive a general relation connecting $d_{12}(x)$, $\\partial_{x}H(x)$, and the energy gap $E_{2}(x)-E_{1}(x)$. Then evaluate $d_{12}(x)$ explicitly for the model above in closed form as a function of $\\Delta$, $\\kappa$, $\\lambda$, and $x$. Finally, determine the global maximum of $|d_{12}(x)|$ as $x$ varies over $\\mathbb{R}$, expressing your answer as a simplified symbolic expression in terms of $\\Delta$, $\\kappa$, and $\\lambda$. Assume $\\kappa\\neq 0$ and $\\lambda\\neq 0$. Provide your final answer as a symbolic expression with no units attached.", "solution": "The problem is well-posed, scientifically grounded, and contains all necessary information for a unique solution. The model is a standard representation of a two-state avoided crossing, fundamental to the study of nonadiabatic dynamics. We proceed with the solution, which consists of three parts.\n\nFirst, we derive the general relation connecting the nonadiabatic coupling $d_{12}(x)$, the derivative of the Hamiltonian $\\partial_{x}H(x)$, and the energy gap $E_{2}(x)-E_{1}(x)$. We begin with the time-independent Schrödinger equation for the adiabatic eigenstate $|\\phi_{2}(x)\\rangle$:\n$$\nH(x)|\\phi_{2}(x)\\rangle = E_{2}(x)|\\phi_{2}(x)\\rangle\n$$\nDifferentiating this equation with respect to the coordinate $x$ gives:\n$$\n(\\partial_{x}H(x))|\\phi_{2}(x)\\rangle + H(x)(\\partial_{x}|\\phi_{2}(x)\\rangle) = (\\partial_{x}E_{2}(x))|\\phi_{2}(x)\\rangle + E_{2}(x)(\\partial_{x}|\\phi_{2}(x)\\rangle)\n$$\nWe then project this equation onto the other adiabatic eigenstate $\\langle\\phi_{1}(x)|$:\n$$\n\\langle\\phi_{1}(x)|(\\partial_{x}H(x))|\\phi_{2}(x)\\rangle + \\langle\\phi_{1}(x)|H(x)(\\partial_{x}|\\phi_{2}(x)\\rangle) = (\\partial_{x}E_{2}(x))\\langle\\phi_{1}(x)|\\phi_{2}(x)\\rangle + E_{2}(x)\\langle\\phi_{1}(x)|\\partial_{x}\\phi_{2}(x)\\rangle\n$$\nThe Hamiltonian $H(x)$ is Hermitian, so we can operate with it to the left on $\\langle\\phi_{1}(x)|$, yielding $\\langle\\phi_{1}(x)|H(x) = E_{1}(x)\\langle\\phi_{1}(x)|$. The states are orthonormal, so $\\langle\\phi_{1}(x)|\\phi_{2}(x)\\rangle = 0$. By definition, $d_{12}(x) = \\langle\\phi_{1}(x)|\\partial_{x}\\phi_{2}(x)\\rangle$. Substituting these relations into the projected equation simplifies it considerably:\n$$\n\\langle\\phi_{1}(x)|\\partial_{x}H(x)|\\phi_{2}(x)\\rangle + E_{1}(x)\\langle\\phi_{1}(x)|\\partial_{x}\\phi_{2}(x)\\rangle = (\\partial_{x}E_{2}(x)) \\cdot 0 + E_{2}(x)\\langle\\phi_{1}(x)|\\partial_{x}\\phi_{2}(x)\\rangle\n$$\n$$\n\\langle\\phi_{1}(x)|\\partial_{x}H(x)|\\phi_{2}(x)\\rangle = (E_{2}(x) - E_{1}(x))\\langle\\phi_{1}(x)|\\partial_{x}\\phi_{2}(x)\\rangle\n$$\nSolving for $d_{12}(x)$, under the condition that $E_{1}(x) \\neq E_{2}(x)$ (away from a true crossing), gives the desired general relation:\n$$\nd_{12}(x) = \\frac{\\langle\\phi_{1}(x)|\\partial_{x}H(x)|\\phi_{2}(x)\\rangle}{E_{2}(x) - E_{1}(x)}\n$$\nThis is an off-diagonal version of the Hellmann-Feynman theorem.\n\nSecond, we evaluate $d_{12}(x)$ explicitly for the given system. The diabatic Hamiltonian is:\n$$\nH(x) = \\begin{pmatrix} \\Delta+\\kappa x & \\lambda \\\\ \\lambda & -(\\Delta+\\kappa x) \\end{pmatrix}\n$$\nIt is convenient to represent the adiabatic eigenstates using a mixing angle $\\theta(x)$. Let $V(x) = \\Delta+\\kappa x$. The Hamiltonian is $H(x) = V(x)\\sigma_z + \\lambda\\sigma_x$, where $\\sigma_z$ and $\\sigma_x$ are Pauli matrices. We can diagonalize this matrix by a rotation. The adiabatic eigenstates are:\n$$\n|\\phi_{1}(x)\\rangle = \\begin{pmatrix} \\sin\\theta(x) \\\\ -\\cos\\theta(x) \\end{pmatrix}, \\quad |\\phi_{2}(x)\\rangle = \\begin{pmatrix} \\cos\\theta(x) \\\\ \\sin\\theta(x) \\end{pmatrix}\n$$\nwhere the mixing angle $\\theta(x)$ is defined such that $\\tan(2\\theta(x)) = \\frac{\\lambda}{V(x)} = \\frac{\\lambda}{\\Delta+\\kappa x}$. This choice of eigenvectors correctly diagonalizes the Hamiltonian to give the eigenvalues $E_1(x)$ and $E_2(x)$, with the specified ordering $E_1(x) \\le E_2(x)$, as can be verified by direct substitution.\n\nNow, we calculate $d_{12}(x) = \\langle\\phi_{1}(x)|\\partial_{x}\\phi_{2}(x)\\rangle$.\n$$\n\\partial_{x}|\\phi_{2}(x)\\rangle = \\partial_{x}\\begin{pmatrix} \\cos\\theta(x) \\\\ \\sin\\theta(x) \\end{pmatrix} = \\begin{pmatrix} -\\sin\\theta(x) \\\\ \\cos\\theta(x) \\end{pmatrix} \\frac{d\\theta}{dx}\n$$\nThus, the inner product is:\n$$\nd_{12}(x) = \\begin{pmatrix} \\sin\\theta(x) & -\\cos\\theta(x) \\end{pmatrix} \\begin{pmatrix} -\\sin\\theta(x) \\\\ \\cos\\theta(x) \\end{pmatrix} \\frac{d\\theta}{dx} = (-\\sin^{2}\\theta(x) - \\cos^{2}\\theta(x))\\frac{d\\theta}{dx} = -\\frac{d\\theta}{dx}\n$$\nTo find $\\frac{d\\theta}{dx}$, we differentiate the relation $\\tan(2\\theta) = \\frac{\\lambda}{\\Delta+\\kappa x}$:\n$$\n\\sec^{2}(2\\theta) \\cdot 2\\frac{d\\theta}{dx} = \\frac{-\\lambda\\kappa}{(\\Delta+\\kappa x)^2}\n$$\n$$\n2\\frac{d\\theta}{dx} = -\\frac{\\lambda\\kappa}{(\\Delta+\\kappa x)^2} \\cos^{2}(2\\theta)\n$$\nUsing the identity $\\cos^{2}(2\\theta) = \\frac{1}{1+\\tan^{2}(2\\theta)}$:\n$$\n\\cos^{2}(2\\theta) = \\frac{1}{1 + (\\frac{\\lambda}{\\Delta+\\kappa x})^2} = \\frac{(\\Delta+\\kappa x)^2}{(\\Delta+\\kappa x)^2 + \\lambda^2}\n$$\nSubstituting this back, we obtain:\n$$\n2\\frac{d\\theta}{dx} = -\\frac{\\lambda\\kappa}{(\\Delta+\\kappa x)^2} \\frac{(\\Delta+\\kappa x)^2}{(\\Delta+\\kappa x)^2 + \\lambda^2} = -\\frac{\\lambda\\kappa}{(\\Delta+\\kappa x)^2 + \\lambda^2}\n$$\n$$\n\\frac{d\\theta}{dx} = -\\frac{\\lambda\\kappa}{2((\\Delta+\\kappa x)^2 + \\lambda^2)}\n$$\nFinally, the nonadiabatic coupling is:\n$$\nd_{12}(x) = -\\frac{d\\theta}{dx} = \\frac{\\kappa\\lambda}{2((\\Delta+\\kappa x)^2 + \\lambda^2)}\n$$\nThis is the explicit closed-form expression for the nonadiabatic coupling.\n\nThird, we determine the global maximum of $|d_{12}(x)|$. The function to maximize is:\n$$\n|d_{12}(x)| = \\left| \\frac{\\kappa\\lambda}{2((\\Delta+\\kappa x)^2 + \\lambda^2)} \\right| = \\frac{|\\kappa\\lambda|}{2((\\Delta+\\kappa x)^2 + \\lambda^2)}\n$$\nThe numerator, $|\\kappa\\lambda|$, is a positive constant since it is given that $\\kappa \\neq 0$ and $\\lambda \\neq 0$. To maximize this expression, we must minimize the denominator. The denominator is $D(x) = 2((\\Delta+\\kappa x)^2 + \\lambda^2)$. Since $(\\Delta+\\kappa x)^2 \\ge 0$ for all real $x$, the minimum value of this term is $0$. The minimum of the denominator occurs when $\\Delta+\\kappa x = 0$, which is at $x = -\\frac{\\Delta}{\\kappa}$. At this point, the denominator becomes $D_{min} = 2(0 + \\lambda^2) = 2\\lambda^2$.\nThe global maximum of $|d_{12}(x)|$ is therefore:\n$$\n\\max_{x \\in \\mathbb{R}} |d_{12}(x)| = \\frac{|\\kappa\\lambda|}{2\\lambda^2} = \\frac{|\\kappa||\\lambda|}{2|\\lambda|^2} = \\frac{|\\kappa|}{2|\\lambda|}\n$$\nThis maximum occurs at the point of closest approach of the adiabatic potential energy surfaces, known as the center of the avoided crossing.", "answer": "$$\n\\boxed{\\frac{|\\kappa|}{2|\\lambda|}}\n$$", "id": "2681616"}, {"introduction": "Having seen how electronic populations evolve and how couplings arise, we now turn to the \"surface hopping\" event itself—the classical-mechanical part of the mixed quantum-classical algorithm. When a hop occurs, the total energy of the system must be conserved, which requires an instantaneous adjustment of the nuclei's momentum. This exercise provides a hands-on look at this critical algorithmic step, challenging you to apply energy conservation to determine the post-hop momentum and to identify when a hop is energetically forbidden—a so-called \"frustrated hop\" [@problem_id:2681521].", "problem": "A single nuclear degree-of-freedom model is embedded in three-dimensional Cartesian space to describe a nonadiabatic transition within a kinetic step of a reaction network. At a geometry with position vector $\\mathbf{R}$, a hop from electronic state $i$ to state $j$ is attempted using the Fewest Switches Surface Hopping (FSSH) algorithm. The nonadiabatic coupling vector between states $i$ and $j$ at $\\mathbf{R}$ is $\\mathbf{d}_{ij}$. The nuclear momentum is $\\mathbf{P}$, and the adiabatic energies are $E_i(\\mathbf{R})$ and $E_j(\\mathbf{R})$.\n\nAssume that only the component of the momentum along the direction of $\\mathbf{d}_{ij}$ is adjusted upon a successful hop to enforce conservation of total energy, and that a single scalar mass $m$ applies to all Cartesian components. If no real momentum adjustment is possible, the hop is frustrated due to insufficient kinetic energy and the momentum is left unchanged (no velocity reversal).\n\nUse atomic units throughout: energies in Hartree, mass in electron masses, and momentum in atomic units. Consider the following data at the hopping geometry:\n- $E_i(\\mathbf{R}) = -0.105$, $E_j(\\mathbf{R}) = -0.085$,\n- $\\mathbf{P} = (10,\\,-5,\\,2)$,\n- $\\mathbf{d}_{ij} = (0.6,\\,0.8,\\,0)$,\n- $m = 1836$,\n- an attempted hop from $i$ to $j$.\n\nStart from energy conservation and basic vector algebra to derive the momentum adjustment along the unit direction $\\hat{\\mathbf{e}} = \\mathbf{d}_{ij}/\\|\\mathbf{d}_{ij}\\|$, and determine whether the hop is frustrated due to insufficient kinetic energy. Additionally, derive from first principles the minimum required magnitude of the initial momentum projection along $\\hat{\\mathbf{e}}$ that makes an uphill hop energetically allowed.\n\nReport:\n1. The post-hop momentum vector $\\mathbf{P}'$ (equal to the original $\\mathbf{P}$ if the hop is frustrated);\n2. The minimum required magnitude of the initial projection $|\\mathbf{P}\\cdot \\hat{\\mathbf{e}}|$ for the hop to be allowed.\n\nRound all reported numerical values to four significant figures and express them in atomic units. Provide your final answer as a single row vector containing, in order, the three components of $\\mathbf{P}'$ followed by the minimum required magnitude $|\\mathbf{P}\\cdot \\hat{\\mathbf{e}}|_{\\min}$.", "solution": "The problem statement is scientifically grounded, well-posed, objective, and self-contained. It describes a standard procedure within the context of Fewest Switches Surface Hopping (FSSH), a valid and widely used method in computational chemistry for simulating nonadiabatic dynamics. All necessary parameters are provided, and the rules for momentum adjustment and frustrated hops are clearly defined. The problem is therefore deemed valid and a solution will be provided.\n\nThe fundamental principle governing the momentum adjustment is the conservation of total energy. The total energy of the system is the sum of the nuclear kinetic energy and the electronic potential energy. For a system on electronic state $k$ with nuclear momentum $\\mathbf{P}_k$ and mass $m$ at a fixed geometry $\\mathbf{R}$, the total energy is $E_{total} = \\frac{\\mathbf{P}_k^2}{2m} + E_k(\\mathbf{R})$.\n\nUpon a hop from an initial electronic state $i$ to a final state $j$, the total energy must be conserved:\n$$\n\\frac{\\mathbf{P}^2}{2m} + E_i(\\mathbf{R}) = \\frac{(\\mathbf{P}')^2}{2m} + E_j(\\mathbf{R})\n$$\nwhere $\\mathbf{P}$ is the momentum before the hop and $\\mathbf{P}'$ is the momentum after the hop. Rearranging this equation gives an expression for the magnitude of the post-hop momentum:\n$$\n(\\mathbf{P}')^2 = \\mathbf{P}^2 + 2m(E_i(\\mathbf{R}) - E_j(\\mathbf{R}))\n$$\nLet $\\Delta E = E_j(\\mathbf{R}) - E_i(\\mathbf{R})$ be the energy gap between the two states. The equation becomes:\n$$\n(\\mathbf{P}')^2 = \\mathbf{P}^2 - 2m\\Delta E\n$$\nThe problem specifies that the momentum adjustment occurs exclusively along the direction of the nonadiabatic coupling vector, $\\mathbf{d}_{ij}$. Let us define the unit vector in this direction as $\\hat{\\mathbf{e}} = \\frac{\\mathbf{d}_{ij}}{\\|\\mathbf{d}_{ij}\\|}$.\n\nThe initial momentum vector $\\mathbf{P}$ can be decomposed into components parallel ($\\mathbf{P}_{\\parallel}$) and perpendicular ($\\mathbf{P}_{\\perp}$) to $\\hat{\\mathbf{e}}$:\n$$\n\\mathbf{P} = \\mathbf{P}_{\\parallel} + \\mathbf{P}_{\\perp}\n$$\nwhere $\\mathbf{P}_{\\parallel} = (\\mathbf{P} \\cdot \\hat{\\mathbf{e}})\\hat{\\mathbf{e}}$ and $\\mathbf{P}_{\\perp} = \\mathbf{P} - \\mathbf{P}_{\\parallel}$. The magnitude squared of the momentum is $|\\mathbf{P}|^2 = |\\mathbf{P}_{\\parallel}|^2 + |\\mathbf{P}_{\\perp}|^2$, since the components are orthogonal.\n\nAccording to the specified adjustment protocol, the component of momentum perpendicular to $\\hat{\\mathbf{e}}$ is unchanged during the hop. Thus, the post-hop momentum $\\mathbf{P}'$ has the same perpendicular component, $\\mathbf{P}'_{\\perp} = \\mathbf{P}_{\\perp}$. The post-hop momentum is then:\n$$\n\\mathbf{P}' = \\mathbf{P}'_{\\parallel} + \\mathbf{P}_{\\perp}\n$$\nLet $p_e = \\mathbf{P} \\cdot \\hat{\\mathbf{e}}$ be the scalar projection of the initial momentum onto $\\hat{\\mathbf{e}}$, and $p'_e = \\mathbf{P}' \\cdot \\hat{\\mathbf{e}}$ be the corresponding projection of the post-hop momentum. Then $|\\mathbf{P}_{\\parallel}|^2 = p_e^2$ and $|\\mathbf{P}'_{\\parallel}|^2 = (p'_e)^2$.\nThe magnitudes squared of the momenta are related as:\n$$\n|\\mathbf{P}'|^2 = (p'_e)^2 + |\\mathbf{P}_{\\perp}|^2\n$$\n$$\n|\\mathbf{P}|^2 = p_e^2 + |\\mathbf{P}_{\\perp}|^2 \\implies |\\mathbf{P}_{\\perp}|^2 = |\\mathbf{P}|^2 - p_e^2\n$$\nSubstituting this into the expression for $|\\mathbf{P}'|^2$:\n$$\n|\\mathbf{P}'|^2 = (p'_e)^2 + |\\mathbf{P}|^2 - p_e^2\n$$\nWe now equate the two derived expressions for $|\\mathbf{P}'|^2$:\n$$\n\\mathbf{P}^2 - 2m\\Delta E = (p'_e)^2 + \\mathbf{P}^2 - p_e^2\n$$\nThis simplifies to a key relation for the squared projection of the post-hop momentum:\n$$\n(p'_e)^2 = p_e^2 - 2m\\Delta E\n$$\nFor a hop to be energetically possible, the post-hop momentum $\\mathbf{P}'$ must be a real-valued vector. This requires $(p'_e)^2 \\ge 0$. Therefore, a successful hop requires:\n$$\np_e^2 \\ge 2m\\Delta E\n$$\nThis condition has a clear physical meaning: the kinetic energy associated with the motion along the coupling direction, $\\frac{p_e^2}{2m}$, must be greater than or equal to the energy deficit $\\Delta E$ for an uphill hop ($\\Delta E > 0$). If this condition is not met, i.e., $p_e^2 < 2m\\Delta E$, the hop is termed \"frustrated\". The problem statement specifies that for a frustrated hop, the momentum is left unchanged, so $\\mathbf{P}' = \\mathbf{P}$.\n\nNow we apply this framework to the given data:\n- $E_i = -0.105$ a.u., $E_j = -0.085$ a.u.\n- $\\mathbf{P} = (10,\\,-5,\\,2)$ a.u.\n- $\\mathbf{d}_{ij} = (0.6,\\,0.8,\\,0)$ a.u.\n- $m = 1836$ a.u.\n\nFirst, calculate the energy gap $\\Delta E$:\n$$\n\\Delta E = E_j - E_i = -0.085 - (-0.105) = 0.020 \\text{ a.u.}\n$$\nNext, determine the unit vector $\\hat{\\mathbf{e}}$:\n$$\n\\|\\mathbf{d}_{ij}\\| = \\sqrt{0.6^2 + 0.8^2 + 0^2} = \\sqrt{0.36 + 0.64} = \\sqrt{1} = 1\n$$\nSince the norm is $1$, the vector is already a unit vector: $\\hat{\\mathbf{e}} = \\mathbf{d}_{ij} = (0.6,\\,0.8,\\,0)$.\n\nCalculate the initial momentum projection $p_e$:\n$$\np_e = \\mathbf{P} \\cdot \\hat{\\mathbf{e}} = (10)(0.6) + (-5)(0.8) + (2)(0) = 6.0 - 4.0 = 2.0 \\text{ a.u.}\n$$\nNow, check the condition for a successful hop. We must compare $p_e^2$ with $2m\\Delta E$:\n$$\np_e^2 = (2.0)^2 = 4.0\n$$\n$$\n2m\\Delta E = 2 \\times 1836 \\times 0.020 = 73.44\n$$\nSince $p_e^2 = 4.0$ is less than $2m\\Delta E = 73.44$, the condition $p_e^2 \\ge 2m\\Delta E$ is not satisfied. The hop is frustrated. According to the problem's rule, the momentum is unchanged.\nThus, the post-hop momentum $\\mathbf{P}'$ is:\n$$\n\\mathbf{P}' = \\mathbf{P} = (10,\\,-5,\\,2) \\text{ a.u.}\n$$\n\nThe second part of the problem asks for the minimum required magnitude of the initial projection, $|\\mathbf{P}\\cdot \\hat{\\mathbf{e}}|_{\\min}$, for the hop to be allowed. This corresponds to the threshold case where the kinetic energy is just sufficient:\n$$\n|\\mathbf{P}\\cdot \\hat{\\mathbf{e}}|_{\\min}^2 = 2m\\Delta E\n$$\n$$\n|\\mathbf{P}\\cdot \\hat{\\mathbf{e}}|_{\\min} = \\sqrt{2m\\Delta E} = \\sqrt{73.44} \\approx 8.569714... \\text{ a.u.}\n$$\nRounding the final numerical values to four significant figures:\n1. The post-hop momentum vector $\\mathbf{P}'$ is $(10.00, -5.000, 2.000)$.\n2. The minimum required projection magnitude is $8.570$.\n\nThe final answer combines these four numerical values into a single row vector.", "answer": "$$\n\\boxed{\\begin{pmatrix} 10.00 & -5.000 & 2.000 & 8.570 \\end{pmatrix}}\n$$", "id": "2681521"}]}