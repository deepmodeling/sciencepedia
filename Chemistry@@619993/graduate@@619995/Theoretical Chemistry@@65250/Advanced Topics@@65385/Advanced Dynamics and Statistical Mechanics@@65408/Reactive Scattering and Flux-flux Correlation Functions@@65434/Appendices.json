{"hands_on_practices": [{"introduction": "The scattering matrix, or $S$-matrix, is the cornerstone of quantum scattering theory, containing all information about the asymptotic outcomes of a collision. To connect this theoretical construct to experimental reality, we calculate observables like the reactive cross-section. This exercise [@problem_id:2800585] provides hands-on practice in synthesizing state-to-state $S$-matrix elements from different partial waves to compute the integral cross section, $\\sigma_{fi}(E)$, a fundamental skill for analyzing reaction dynamics.", "problem": "A two-channel rearrangement reaction of the form $A + BC \\to AB + C$ is studied in the center-of-mass frame at collision energy $E$. The initial internal state is labeled $i$ and the final product state is labeled $f$. The asymptotic channel solutions are normalized to unit incoming flux in channel $i$, and the dynamics are described by the scattering matrix (S-matrix). Assume the reactants and products are distinguishable and that only total angular momenta $J \\in \\{0,1,2,3\\}$ contribute appreciably at the specified energy. The reduced mass is $\\mu = 1.000$ atomic mass units, which equals $\\mu = 1.66053906660 \\times 10^{-27}$ kg. The collision energy is $E = 0.001$ eV. The channel wave number $k_i$ in the incident channel satisfies $E = \\hbar^{2} k_i^{2}/(2\\mu)$ in the asymptotic region.\n\nAt this energy, the state-to-state S-matrix elements for the transition $i \\to f$ in each contributing $J$-block are provided in polar form as\n$$\nS_{fi}^{0}(E) = 0.200 \\,\\exp(\\mathrm{i}\\,0.30), \\quad\nS_{fi}^{1}(E) = 0.150 \\,\\exp(-\\mathrm{i}\\,1.10), \\quad\nS_{fi}^{2}(E) = 0.100 \\,\\exp(\\mathrm{i}\\,2.00), \\quad\nS_{fi}^{3}(E) = 0.050 \\,\\exp(\\mathrm{i}\\,0.70).\n$$\n\nStarting from the definition of the microcanonical flux-flux correlation function and its connection to the scattering-probability content of the S-matrix, derive the expression for the state-to-state integral reactive cross section in terms of the partial-wave reaction probabilities and the incident channel wave number. Then evaluate the cross section for the data above.\n\nUse the following constants for your evaluation:\n- $\\hbar = 1.054571817 \\times 10^{-34}$ J·s,\n- $1$ eV $= 1.602176634 \\times 10^{-19}$ J,\n- $1$ Å $= 1.000000000 \\times 10^{-10}$ m.\n\nExpress your final answer in square angstroms (Å$^{2}$). Round your answer to three significant figures.", "solution": "The problem statement is scrutinized and found to be valid. It is scientifically grounded in the principles of quantum scattering theory, well-posed with all necessary information provided, and expressed in objective, formal language. There are no contradictions, ambiguities, or factual inaccuracies. We may proceed with the solution.\n\nThe problem requires a derivation of the formula for the state-to-state integral reactive cross section, $\\sigma_{fi}(E)$, and its subsequent calculation using the provided data.\n\nFirst, we establish the theoretical connection between the scattering matrix ($S$-matrix) and the cross section, as requested, starting from the perspective of flux-flux correlation functions. In modern chemical dynamics, the thermal rate coefficient for a reaction is formally expressed as the time integral of a flux-flux correlation function, $C_f(t)$. A central result from this formalism is its connection to the energy-resolved scattering properties of the system. The cumulative reaction probability, $N(E)$, which is the sum of probabilities over all possible product quantum states for a given total energy $E$, is directly related to the $S$-matrix:\n$$\nN(E) = \\sum_{fi} |S_{fi}(E)|^2\n$$\nIn a more detailed partial wave analysis, where total angular momentum $J$ is conserved, this becomes:\n$$\nN(E) = \\sum_{J=0}^{\\infty} (2J+1) \\sum_{fi} P_{fi}^J(E)\n$$\nwhere $P_{fi}^J(E)$ is the state-to-state reaction probability for a specific transition from initial state $i$ to final state $f$ within the $J$-th partial wave. This probability is given by the squared modulus of the corresponding off-diagonal $S$-matrix element:\n$$\nP_{fi}^J(E) = |S_{fi}^J(E)|^2\n$$\nThe factor $(2J+1)$ accounts for the degeneracy of the total angular momentum projection quantum number.\n\nThe integral cross section for a specific state-to-state transition, $\\sigma_{fi}(E)$, represents the effective area presented by the target for scattering incident particles from channel $i$ into channel $f$. It is defined as the ratio of the total scattered flux into channel $f$ to the incident flux density in channel $i$. This leads to the fundamental formula for the integral cross section as a sum over partial waves:\n$$\n\\sigma_{fi}(E) = \\frac{\\pi}{k_i^2} \\sum_{J=0}^{\\infty} (2J+1) P_{fi}^J(E)\n$$\nwhere $k_i$ is the wave number of the incident particle in the center-of-mass frame, related to the collision energy $E$ and the reduced mass $\\mu$ by $E = \\frac{\\hbar^2 k_i^2}{2\\mu}$.\n\nSubstituting the expression for the reaction probability $P_{fi}^J(E)$ in terms of the $S$-matrix, we arrive at the final expression required for the calculation:\n$$\n\\sigma_{fi}(E) = \\frac{\\pi}{k_i^2} \\sum_{J=0}^{\\infty} (2J+1) |S_{fi}^J(E)|^2\n$$\nThis completes the derivation. Now we proceed to the numerical evaluation.\n\nThe calculation is performed in three steps.\n\nStep 1: Calculate the square of the incident wave number, $k_i^2$.\nFrom the given relation $E = \\frac{\\hbar^2 k_i^2}{2\\mu}$, we rearrange to find $k_i^2$:\n$$\nk_i^2 = \\frac{2\\mu E}{\\hbar^2}\n$$\nThe provided constants must be in consistent SI units.\n$E = 0.001 \\text{ eV} = 0.001 \\times (1.602176634 \\times 10^{-19} \\text{ J}) = 1.602176634 \\times 10^{-22}$ J.\n$\\mu = 1.000 \\text{ amu} = 1.66053906660 \\times 10^{-27}$ kg.\n$\\hbar = 1.054571817 \\times 10^{-34}$ J·s.\nSubstituting these values:\n$$\nk_i^2 = \\frac{2 \\times (1.66053906660 \\times 10^{-27} \\text{ kg}) \\times (1.602176634 \\times 10^{-22} \\text{ J})}{(1.054571817 \\times 10^{-34} \\text{ J·s})^2}\n$$\n$$\nk_i^2 = \\frac{5.32115904 \\times 10^{-49} \\text{ kg·J}}{1.11211736 \\times 10^{-68} \\text{ J}^2\\text{·s}^2} = 4.7846003 \\times 10^{19} \\text{ m}^{-2}\n$$\n\nStep 2: Calculate the partial wave sum.\nThe problem states that only total angular momenta $J \\in \\{0, 1, 2, 3\\}$ contribute. The sum is therefore truncated:\n$$\n\\text{Sum} = \\sum_{J=0}^{3} (2J+1) |S_{fi}^J(E)|^2\n$$\nThe $S$-matrix elements are given in polar form, $S = |S| \\exp(i\\phi)$, so $|S|^2$ is the square of the given amplitude.\nFor $J=0$: $(2 \\cdot 0 + 1) |S_{fi}^0|^2 = 1 \\times (0.200)^2 = 1 \\times 0.0400 = 0.0400$.\nFor $J=1$: $(2 \\cdot 1 + 1) |S_{fi}^1|^2 = 3 \\times (0.150)^2 = 3 \\times 0.0225 = 0.0675$.\nFor $J=2$: $(2 \\cdot 2 + 1) |S_{fi}^2|^2 = 5 \\times (0.100)^2 = 5 \\times 0.0100 = 0.0500$.\nFor $J=3$: $(2 \\cdot 3 + 1) |S_{fi}^3|^2 = 7 \\times (0.050)^2 = 7 \\times 0.0025 = 0.0175$.\nThe total sum is:\n$$\n\\text{Sum} = 0.0400 + 0.0675 + 0.0500 + 0.0175 = 0.175\n$$\n\nStep 3: Calculate the cross section $\\sigma_{fi}(E)$ and convert units.\nSubstituting the results from the previous steps into the cross-section formula:\n$$\n\\sigma_{fi}(E) = \\frac{\\pi}{k_i^2} \\times \\text{Sum} = \\frac{\\pi}{4.7846003 \\times 10^{19} \\text{ m}^{-2}} \\times 0.175\n$$\n$$\n\\sigma_{fi}(E) = 1.149064 \\times 10^{-20} \\text{ m}^2\n$$\nThe final answer must be in square angstroms (Å$^2$). We use the conversion $1$ Å = $10^{-10}$ m, which implies $1$ Å$^2 = 10^{-20}$ m$^2$.\n$$\n\\sigma_{fi}(E) = 1.149064 \\text{ Å}^2\n$$\nRounding to three significant figures as requested gives the final result.\n$$\n\\sigma_{fi}(E) \\approx 1.15 \\text{ Å}^2\n$$", "answer": "$$\\boxed{1.15}$$", "id": "2800585"}, {"introduction": "While cross-sections describe single-energy collision events, thermal rate constants average over a statistical ensemble, providing a macroscopic view of reactivity. The flux-flux correlation function, $C_{FF}(t)$, provides a powerful theoretical bridge, as its time integral directly yields the rate constant $k(T)$. This practice [@problem_id:2800442] simulates the common task of a computational chemist: calculating a rate constant from a discrete, finite-time data set for $C_{FF}(t)$ and rigorously establishing bounds on the result.", "problem": "A canonical rate constant for a thermally activated chemical reaction can be formulated in terms of the transport of population across a dividing surface. Consider a system with Hamiltonian $\\hat{H}$, a dividing surface defined by a Heaviside operator $\\hat{h}$, and the associated quantum mechanical flux operator $\\hat{F} \\equiv \\frac{\\mathrm{i}}{\\hbar}\\left[\\hat{H},\\hat{h}\\right]$. The thermal average is taken in the canonical ensemble at temperature $T$, with inverse temperature $\\beta \\equiv \\left(k_{B}T\\right)^{-1}$. The reactant partition function is $Q_{r} \\equiv \\mathrm{Tr}\\left(\\mathrm{e}^{-\\beta \\hat{H}}\\hat{h}\\right)$. Starting from these elements and the standard time-correlation formalism for transport processes, derive an expression for the canonical rate constant $k(T)$ in terms of a time integral of the flux-flux correlation function $C_{FF}(t)$.\n\nYou are provided with a dataset of $C_{FF}(t)$ values at temperature $T$ for a single dividing surface, sampled at discrete times $t_{i}$, with symmetric one-sigma uncertainties. The data are given in units of $\\mathrm{ps}^{-2}$ and the times are given in $\\mathrm{ps}$. The reactant partition function for these conditions is $Q_{r} = 2.50$ (dimensionless). Use the following data:\n- $t_{0} = 0.00\\ \\mathrm{ps}$, $C_{FF}(t_{0}) = 12.0 \\pm 0.4\\ \\mathrm{ps}^{-2}$\n- $t_{1} = 0.05\\ \\mathrm{ps}$, $C_{FF}(t_{1}) = 8.6 \\pm 0.3\\ \\mathrm{ps}^{-2}$\n- $t_{2} = 0.10\\ \\mathrm{ps}$, $C_{FF}(t_{2}) = 4.9 \\pm 0.2\\ \\mathrm{ps}^{-2}$\n- $t_{3} = 0.20\\ \\mathrm{ps}$, $C_{FF}(t_{3}) = -0.6 \\pm 0.2\\ \\mathrm{ps}^{-2}$\n- $t_{4} = 0.40\\ \\mathrm{ps}$, $C_{FF}(t_{4}) = 0.25 \\pm 0.05\\ \\mathrm{ps}^{-2}$\n- $t_{5} = 0.80\\ \\mathrm{ps}$, $C_{FF}(t_{5}) = 0.030 \\pm 0.010\\ \\mathrm{ps}^{-2}$\n- $t_{6} = 1.20\\ \\mathrm{ps}$, $C_{FF}(t_{6}) = 0.008 \\pm 0.005\\ \\mathrm{ps}^{-2}$\n\nAssume the following for constructing rigorous conservative bounds:\n- Between successive sampling times $t_{i}$ and $t_{i+1}$, the unknown $C_{FF}(t)$ is constrained to be any function consistent with linear interpolation of endpoint values that lie within the reported uncertainty intervals at those endpoints.\n- For the long-time tail $t \\ge t_{6}$, the magnitude of the correlation function is bounded by a decaying exponential envelope,\n$$\n\\left|C_{FF}(t)\\right| \\le A\\,\\exp\\!\\left[-\\gamma\\,(t-t_{6})\\right],\\quad \\text{for } t \\ge t_{6},\n$$\nwith $A = 0.015\\ \\mathrm{ps}^{-2}$ and $\\gamma = 5.0\\ \\mathrm{ps}^{-1}$.\n\nUsing only these assumptions, construct a conservative lower and upper bound on the canonical rate constant $k(T)$ by combining:\n- A truncated-time integral bound over $[0,t_{6}]$ obtained from the linear-interpolation admissible set, and\n- A rigorous tail bound over $(t_{6},\\infty)$ obtained from the exponential envelope.\n\nExpress your final bounds for $k(T)$ in units of $\\mathrm{s}^{-1}$ and round each bound to four significant figures. Report your answer as two numbers: the lower bound and the upper bound. Angles, if any, are not involved in this problem.", "solution": "The problem statement is first subjected to validation.\n\nGivens extracted verbatim are:\n- System Hamiltonian: $\\hat{H}$\n- Dividing surface operator: $\\hat{h}$ (Heaviside operator)\n- Flux operator: $\\hat{F} \\equiv \\frac{\\mathrm{i}}{\\hbar}\\left[\\hat{H},\\hat{h}\\right]$\n- Canonical ensemble at temperature $T$, inverse temperature $\\beta \\equiv \\left(k_{B}T\\right)^{-1}$.\n- Reactant partition function: $Q_{r} \\equiv \\mathrm{Tr}\\left(\\mathrm{e}^{-\\beta \\hat{H}}\\hat{h}\\right) = 2.50$ (dimensionless).\n- Flux-flux correlation function data $C_{FF}(t)$ in $\\mathrm{ps}^{-2}$ versus time $t$ in $\\mathrm{ps}$:\n  - $t_{0} = 0.00$, $C_{FF}(t_{0}) = 12.0 \\pm 0.4$\n  - $t_{1} = 0.05$, $C_{FF}(t_{1}) = 8.6 \\pm 0.3$\n  - $t_{2} = 0.10$, $C_{FF}(t_{2}) = 4.9 \\pm 0.2$\n  - $t_{3} = 0.20$, $C_{FF}(t_{3}) = -0.6 \\pm 0.2$\n  - $t_{4} = 0.40$, $C_{FF}(t_{4}) = 0.25 \\pm 0.05$\n  - $t_{5} = 0.80$, $C_{FF}(t_{5}) = 0.030 \\pm 0.010$\n  - $t_{6} = 1.20$, $C_{FF}(t_{6}) = 0.008 \\pm 0.005$\n- Bounding assumptions:\n  1. For $t \\in [t_i, t_{i+1}]$, $C_{FF}(t)$ is consistent with linear interpolation of endpoint values within their uncertainties.\n  2. For $t \\ge t_{6}$, $|C_{FF}(t)| \\le A\\,\\exp[-\\gamma\\,(t-t_{6})]$ with $A = 0.015\\ \\mathrm{ps}^{-2}$ and $\\gamma = 5.0\\ \\mathrm{ps}^{-1}$.\n\nThe problem is scientifically grounded in the established quantum theory of reaction rates. It is well-posed, objective, and provides a complete set of data and constraints necessary to determine a unique set of conservative bounds for the rate constant. The problem is therefore deemed valid.\n\nThe first task is to derive the expression for the canonical rate constant $k(T)$. The standard time-correlation function formalism for chemical kinetics relates the rate constant to the flux through a dividing surface. The rate constant multiplied by the reactant partition function, $k(T)Q_r$, is the total reactive flux. This reactive flux can be identified as the long-time limit of the flux-position correlation function, $C_{fh}(t) \\equiv \\langle\\hat{F}(0)\\hat{h}(t)\\rangle$, where the average is a canonical trace.\n$$\nk(T)Q_r = \\lim_{t \\to \\infty} C_{fh}(t)\n$$\nThe time derivative of $C_{fh}(t)$ is taken using the Heisenberg equation of motion for operators, $\\frac{d\\hat{A}(t)}{dt} = \\frac{\\mathrm{i}}{\\hbar}[\\hat{H}, \\hat{A}(t)]$:\n$$\n\\frac{dC_{fh}(t)}{dt} = \\left\\langle \\hat{F}(0) \\frac{d\\hat{h}(t)}{dt} \\right\\rangle = \\left\\langle \\hat{F}(0) \\frac{\\mathrm{i}}{\\hbar}[\\hat{H}, \\hat{h}(t)] \\right\\rangle = \\langle \\hat{F}(0) \\hat{F}(t) \\rangle \\equiv C_{FF}(t)\n$$\nwhere $C_{FF}(t)$ is the flux-flux correlation function. Integrating this equation from $0$ to $t$ gives:\n$$\nC_{fh}(t) - C_{fh}(0) = \\int_0^t C_{FF}(t') dt'\n$$\nTaking the limit $t \\to \\infty$, and assuming that the system relaxes to a state where correlations decay, we have:\n$$\n\\lim_{t \\to \\infty} C_{fh}(t) = C_{fh}(0) + \\int_0^\\infty C_{FF}(t') dt'\n$$\nThe term $C_{fh}(0) = \\langle\\hat{F}\\hat{h}\\rangle$ represents an initial transient correlation that, depending on the precise definition of the dividing surface, either vanishes or is re-absorbed into a redefinition of the flux operator. The conventional form used in numerical applications assumes the reactive flux is given solely by the time integral of $C_{FF}(t)$. Thus, we arrive at the standard expression:\n$$\nk(T) Q_r = \\int_0^\\infty C_{FF}(t) dt\n$$\nThe rate constant is therefore:\n$$\nk(T) = \\frac{1}{Q_r} \\int_0^\\infty C_{FF}(t) dt\n$$\nThe primary task is to find conservative lower and upper bounds for the integral $I = \\int_0^\\infty C_{FF}(t) dt$. The integral is split into two parts: a truncated integral over the data range and a tail integral.\n$$\nI = \\int_0^{t_6} C_{FF}(t) dt + \\int_{t_6}^\\infty C_{FF}(t) dt = I_{\\text{trunc}} + I_{\\text{tail}}\n$$\nThe bounds on $I$ are found by summing the respective bounds on $I_{\\text{trunc}}$ and $I_{\\text{tail}}$.\n\nTo find the bounds for $I_{\\text{trunc}}$, the interval $[0, t_6]$ is divided into subintervals $[t_i, t_{i+1}]$. The provided constraint implies that for $t \\in [t_i, t_{i+1}]$, the function $C_{FF}(t)$ is bounded from below by the line segment connecting $(t_i, C_{FF}(t_i) - \\sigma_i)$ and $(t_{i+1}, C_{FF}(t_{i+1}) - \\sigma_{i+1})$, and from above by the line segment connecting $(t_i, C_{FF}(t_i) + \\sigma_i)$ and $(t_{i+1}, C_{FF}(t_{i+1}) + \\sigma_{i+1})$. The integral bounds are therefore found by integrating these piecewise linear bounding functions, which corresponds to summing the areas of the trapezoids defined by the lower and upper bounds of the data points.\n\nThe lower bound on the truncated integral is:\n$$\nI_{\\text{trunc,lower}} = \\sum_{i=0}^{5} \\frac{1}{2}\\left((C_{FF}(t_i)-\\sigma_i) + (C_{FF}(t_{i+1})-\\sigma_{i+1})\\right)(t_{i+1}-t_i)\n$$\nUsing the provided values (all in ps units for time and ps$^{-2}$ for correlation):\n$I_{\\text{trunc,lower}} = \\frac{1}{2}((12.0-0.4)+(8.6-0.3))(0.05-0.00) + \\frac{1}{2}((8.6-0.3)+(4.9-0.2))(0.10-0.05) + \\frac{1}{2}((4.9-0.2)+(-0.6-0.2))(0.20-0.10) + \\frac{1}{2}((-0.6-0.2)+(0.25-0.05))(0.40-0.20) + \\frac{1}{2}((0.25-0.05)+(0.030-0.010))(0.80-0.40) + \\frac{1}{2}((0.030-0.010)+(0.008-0.005))(1.20-0.80)$\n$I_{\\text{trunc,lower}} = \\frac{1}{2}(11.6+8.3)(0.05) + \\frac{1}{2}(8.3+4.7)(0.05) + \\frac{1}{2}(4.7-0.8)(0.10) + \\frac{1}{2}(-0.8+0.20)(0.20) + \\frac{1}{2}(0.20+0.020)(0.40) + \\frac{1}{2}(0.020+0.003)(0.40)$\n$I_{\\text{trunc,lower}} = (0.5)(19.9)(0.05) + (0.5)(13.0)(0.05) + (0.5)(3.9)(0.10) + (0.5)(-0.6)(0.20) + (0.5)(0.22)(0.40) + (0.5)(0.023)(0.40)$\n$I_{\\text{trunc,lower}} = 0.4975 + 0.325 + 0.195 - 0.06 + 0.044 + 0.0046 = 1.0061\\ \\mathrm{ps}^{-1}$\n\nThe upper bound on the truncated integral is:\n$$\nI_{\\text{trunc,upper}} = \\sum_{i=0}^{5} \\frac{1}{2}\\left((C_{FF}(t_i)+\\sigma_i) + (C_{FF}(t_{i+1})+\\sigma_{i+1})\\right)(t_{i+1}-t_i)\n$$\n$I_{\\text{trunc,upper}} = \\frac{1}{2}((12.0+0.4)+(8.6+0.3))(0.05) + \\frac{1}{2}((8.6+0.3)+(4.9+0.2))(0.05) + \\frac{1}{2}((4.9+0.2)+(-0.6+0.2))(0.10) + \\frac{1}{2}((-0.6+0.2)+(0.25+0.05))(0.20) + \\frac{1}{2}((0.25+0.05)+(0.030+0.010))(0.40) + \\frac{1}{2}((0.030+0.010)+(0.008+0.005))(0.40)$\n$I_{\\text{trunc,upper}} = \\frac{1}{2}(12.4+8.9)(0.05) + \\frac{1}{2}(8.9+5.1)(0.05) + \\frac{1}{2}(5.1-0.4)(0.10) + \\frac{1}{2}(-0.4+0.30)(0.20) + \\frac{1}{2}(0.30+0.040)(0.40) + \\frac{1}{2}(0.040+0.013)(0.40)$\n$I_{\\text{trunc,upper}} = (0.5)(21.3)(0.05) + (0.5)(14.0)(0.05) + (0.5)(4.7)(0.10) + (0.5)(-0.1)(0.20) + (0.5)(0.34)(0.40) + (0.5)(0.053)(0.40)$\n$I_{\\text{trunc,upper}} = 0.5325 + 0.350 + 0.235 - 0.010 + 0.068 + 0.0106 = 1.1861\\ \\mathrm{ps}^{-1}$\n\nFor the tail integral $I_{\\text{tail}} = \\int_{t_6}^\\infty C_{FF}(t) dt$, the bound $|C_{FF}(t)| \\le A\\,\\exp[-\\gamma\\,(t-t_{6})]$ implies that $-A\\,\\exp[-\\gamma\\,(t-t_{6})] \\le C_{FF}(t) \\le A\\,\\exp[-\\gamma\\,(t-t_{6})]$.\nThe bounds on the tail integral are therefore:\n$$\nI_{\\text{tail,lower}} = \\int_{t_6}^\\infty -A\\,\\exp[-\\gamma(t-t_6)] dt = -A \\left[ -\\frac{1}{\\gamma} \\exp[-\\gamma(t-t_6)] \\right]_{t_6}^{\\infty} = -\\frac{A}{\\gamma}\n$$\n$$\nI_{\\text{tail,upper}} = \\int_{t_6}^\\infty A\\,\\exp[-\\gamma(t-t_6)] dt = A \\left[ -\\frac{1}{\\gamma} \\exp[-\\gamma(t-t_6)] \\right]_{t_6}^{\\infty} = \\frac{A}{\\gamma}\n$$\nWith $A = 0.015\\ \\mathrm{ps}^{-2}$ and $\\gamma = 5.0\\ \\mathrm{ps}^{-1}$, the magnitude of the tail contribution is $\\frac{A}{\\gamma} = \\frac{0.015}{5.0} = 0.003\\ \\mathrm{ps}^{-1}$.\nSo, $I_{\\text{tail,lower}} = -0.003\\ \\mathrm{ps}^{-1}$ and $I_{\\text{tail,upper}} = 0.003\\ \\mathrm{ps}^{-1}$.\n\nThe bounds on the total integral $I$ are:\n$I_{\\text{lower}} = I_{\\text{trunc,lower}} + I_{\\text{tail,lower}} = 1.0061 - 0.003 = 1.0031\\ \\mathrm{ps}^{-1}$\n$I_{\\text{upper}} = I_{\\text{trunc,upper}} + I_{\\text{tail,upper}} = 1.1861 + 0.003 = 1.1891\\ \\mathrm{ps}^{-1}$\n\nThe bounds for the rate constant $k(T) = I/Q_r$ are found using $Q_r = 2.50$:\n$k_{\\text{lower}} = \\frac{I_{\\text{lower}}}{Q_r} = \\frac{1.0031}{2.50} = 0.40124\\ \\mathrm{ps}^{-1}$\n$k_{\\text{upper}} = \\frac{I_{\\text{upper}}}{Q_r} = \\frac{1.1891}{2.50} = 0.47564\\ \\mathrm{ps}^{-1}$\n\nFinally, the results must be converted to units of $\\mathrm{s}^{-1}$ and rounded to four significant figures. Since $1\\ \\mathrm{ps}^{-1} = 10^{12}\\ \\mathrm{s}^{-1}$:\n$k_{\\text{lower}} = 0.40124 \\times 10^{12}\\ \\mathrm{s}^{-1} = 4.0124 \\times 10^{11}\\ \\mathrm{s}^{-1} \\approx 4.012 \\times 10^{11}\\ \\mathrm{s}^{-1}$\n$k_{\\text{upper}} = 0.47564 \\times 10^{12}\\ \\mathrm{s}^{-1} = 4.7564 \\times 10^{11}\\ \\mathrm{s}^{-1} \\approx 4.756 \\times 10^{11}\\ \\mathrm{s}^{-1}$\nThe conservative bounds for the rate constant are therefore $[4.012 \\times 10^{11}, 4.756 \\times 10^{11}]\\ \\mathrm{s}^{-1}$.", "answer": "$$\n\\boxed{\\begin{pmatrix} 4.012 \\times 10^{11} & 4.756 \\times 10^{11} \\end{pmatrix}}\n$$", "id": "2800442"}, {"introduction": "A deep understanding of reaction rates comes from comparing predictions from different theoretical models, which highlights the role of underlying physical principles. This culminating exercise [@problem_id:2800490] involves deriving and implementing rate expressions for classical mechanics, quantum transition state theory, and a quantum model that includes tunneling corrections. By applying these distinct frameworks to the same model system, you will gain direct insight into their domains of validity and the quantitative importance of quantum mechanical effects in chemical reactivity.", "problem": "You are to implement a complete, runnable program that computes and compares classical and quantum thermal reaction rates for a two-dimensional reactive scattering model using the flux across a dividing surface and the flux-flux correlation function framework. All physics must be formulated in natural units where the Boltzmann constant $k_B = 1$, the reduced Planck constant $\\hbar = 1$, and all masses are unity, so that Planck’s constant is $h = 2\\pi$. In these units, all frequencies, energies, and temperatures are dimensionless, and rates must be reported in inverse time units. Angles used by any trigonometric function must be in radians.\n\nModel definition and assumptions:\n- Consider a separable two-dimensional Hamiltonian with coordinates $(x,y)$, momenta $(p_x,p_y)$, and masses equal to unity. The reactant region is a harmonic well, and the transition state region is described locally by a quadratic saddle (an inverted parabola along the reaction coordinate and a stable vibration orthogonal to it).\n- The reactant valley is approximated by a harmonic potential with two vibrational frequencies $\\omega_x^{\\mathrm{R}}$ and $\\omega_y^{\\mathrm{R}}$ about its minimum (the minimum energy is set to zero without loss of generality).\n- The transition state region is approximated by a barrier of height $V^\\ddagger$ with an imaginary frequency of magnitude $\\omega_b$ along $x$ (the reaction coordinate) and one stable frequency $\\omega_y^\\ddagger$ orthogonal to $x$.\n- The dividing surface is $s(\\mathbf{q}) = x = 0$, with the reactant region defined by $x  0$ and the product region by $x > 0$.\n\nFrom first principles, do the following:\n1) Starting from the classical canonical ensemble and the definition of the classical flux across the dividing surface as the $t \\to 0^+$ limit of the classical flux-flux correlation function, derive an explicit, closed-form expression for the classical thermal rate constant $k_\\mathrm{cl}(T)$ for this separable harmonic model. Your derivation must begin from the definition of the classical rate as the ratio of a phase-space flux integral over the dividing surface to the reactant phase-space partition integral, both under Boltzmann weighting. Do not assume any pre-tabulated rate expressions.\n2) Starting from the quantum statistical mechanical partition function of a harmonic oscillator and the generalized transition state theory construction, derive the quantum transition state theory rate $k_\\mathrm{QTST}(T)$ for this model, expressed entirely in terms of $T$, $V^\\ddagger$, $\\omega_x^{\\mathrm{R}}$, $\\omega_y^{\\mathrm{R}}$, and $\\omega_y^\\ddagger$. Your derivation should begin from the definition of the quantum harmonic partition function and the ratio of transition state to reactant partition functions, multiplied by the appropriate dynamical prefactor, without assuming any “shortcut” formula for the final rate.\n3) Using the flux-flux correlation function for an inverted parabolic barrier, obtain the exact quantum dynamical tunneling correction factor $\\kappa(T,\\omega_b)$ that multiplies the quantum transition state theory rate for this specific quadratic barrier model. Combine it with your result from part 2) to define the quantum-corrected rate $k_\\mathrm{Q}(T) = \\kappa(T,\\omega_b)\\,k_\\mathrm{QTST}(T)$.\n\nProgram requirements:\n- Implement a program that, given a test suite of parameter sets, computes for each case:\n  - The classical rate $k_\\mathrm{cl}(T)$ obtained from your part 1) expression.\n  - The quantum transition state theory rate $k_\\mathrm{QTST}(T)$ obtained from your part 2) expression.\n  - The quantum-corrected rate $k_\\mathrm{Q}(T)$ obtained from your part 3) expression.\n  - The ratio $k_\\mathrm{Q}(T)/k_\\mathrm{cl}(T)$.\n- Your implementation must use only deterministic computations with no user input.\n- All results must be expressed in inverse time units (dimensionless in the adopted unit system) and rounded to eight decimal places.\n\nTest suite:\n- Use the following parameter sets, each specified as a tuple $(T, V^\\ddagger, \\omega_b, \\omega_x^{\\mathrm{R}}, \\omega_y^{\\mathrm{R}}, \\omega_y^\\ddagger)$:\n  1) $(1.0,\\; 5.0,\\; 2.0,\\; 1.5,\\; 1.2,\\; 1.1)$\n  2) $(0.6,\\; 4.0,\\; 2.5,\\; 1.8,\\; 1.0,\\; 1.3)$\n  3) $(2.5,\\; 3.0,\\; 1.0,\\; 1.1,\\; 0.9,\\; 1.0)$\n  4) $(1.2,\\; 2.0,\\; 0.5,\\; 1.4,\\; 1.6,\\; 1.5)$\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list of lists, one list per test case, in the order given above. Each inner list must be of the form $[k_\\mathrm{cl},k_\\mathrm{QTST},k_\\mathrm{Q},k_\\mathrm{Q}/k_\\mathrm{cl}]$ with each float rounded to eight decimal places. For example: [[val11,val12,val13,val14],[val21,val22,val23,val24],...].\n\nNo external input is allowed and no explanatory text should be printed, only the single required line. All trigonometric functions must use radians as their angle unit.", "solution": "The problem as stated is scientifically sound, well-posed, and contains all necessary information for a complete and unambiguous solution. It is a standard model problem in theoretical chemical kinetics. Therefore, a solution is derived and implemented as requested. The derivation proceeds in three parts, following the problem statement. All calculations are performed in natural units where $\\hbar=1$, $k_B=1$, and all masses are unity ($m=1$). Consequently, temperature $T$ has units of energy, and the rate constant $k$ has units of inverse time.\n\nPart 1: Derivation of the Classical Thermal Rate Constant $k_{\\mathrm{cl}}(T)$\n\nThe classical rate constant, according to Transition State Theory (TST), is defined as the ratio of the one-way thermal flux through the dividing surface to the reactant partition function. The problem requests this derivation to start from the phase-space integrals.\n\nThe rate constant is $k_{\\mathrm{cl}}(T) = \\mathcal{F} / Q_R$, where $\\mathcal{F}$ is the classical flux integral and $Q_R$ is the classical reactant partition function integral. The factor of $1/h^D$ (where $h=2\\pi$ and $D=2$) is common to both numerator and denominator and will cancel.\n\nThe flux integral $\\mathcal{F}$ represents the thermally-averaged rate of crossing the dividing surface $s(\\mathbf{q}) = x = 0$ in the positive $x$ direction. It is given by:\n$$ \\mathcal{F} = \\int d\\mathbf{p} \\int d\\mathbf{q} \\left(\\frac{p_x}{m}\\right) \\delta(x) \\Theta(p_x) e^{-\\beta H(\\mathbf{p},\\mathbf{q})} $$\nHere, $\\mathbf{q}=(x,y)$, $\\mathbf{p}=(p_x,p_y)$, $m=1$, $\\beta = 1/T$, $\\delta(x)$ is the Dirac delta function enforcing the dividing surface constraint, and $\\Theta(p_x)$ is the Heaviside step function selecting trajectories moving towards products ($p_x>0$). The Hamiltonian is $H = (p_x^2+p_y^2)/2 + V(x,y)$.\n\nThe integral over $x$ is resolved by the delta function, which sets $x=0$. At this surface, the potential is that of the transition state: $V(0,y) = V^\\ddagger + \\frac{1}{2}(\\omega_y^\\ddagger)^2 y^2$. The flux integral becomes:\n$$ \\mathcal{F} = \\int_{-\\infty}^{\\infty} dp_x \\int_{-\\infty}^{\\infty} dp_y \\int_{-\\infty}^{\\infty} dy \\;\\; p_x \\Theta(p_x) \\exp\\left(-\\beta\\left[\\frac{p_x^2}{2} + \\frac{p_y^2}{2} + V^\\ddagger + \\frac{1}{2}(\\omega_y^\\ddagger)^2 y^2\\right]\\right) $$\nThis integral is separable:\n$$ \\mathcal{F} = \\left(\\int_{0}^{\\infty} p_x e^{-\\beta p_x^2/2} dp_x \\right) \\left(\\int_{-\\infty}^{\\infty} e^{-\\beta p_y^2/2} dp_y \\right) \\left(e^{-\\beta V^\\ddagger} \\int_{-\\infty}^{\\infty} e^{-\\beta(\\omega_y^\\ddagger)^2 y^2/2} dy \\right) $$\nEvaluating each Gaussian or related integral:\n\\begin{enumerate}\n    \\item $p_x$ integral: $\\int_0^{\\infty} p_x e^{-\\beta p_x^2/2} dp_x = \\left[-\\frac{1}{\\beta}e^{-\\beta p_x^2/2}\\right]_0^\\infty = 1/\\beta = T$\n    \\item $p_y$ integral: $\\int_{-\\infty}^{\\infty} e^{-\\beta p_y^2/2} dp_y = \\sqrt{2\\pi/\\beta} = \\sqrt{2\\pi T}$\n    \\item $y$ integral: $\\int_{-\\infty}^{\\infty} e^{-\\beta(\\omega_y^\\ddagger)^2 y^2/2} dy = \\sqrt{2\\pi/(\\beta(\\omega_y^\\ddagger)^2)} = \\frac{\\sqrt{2\\pi T}}{\\omega_y^\\ddagger}$\n\\end{enumerate}\nMultiplying these components gives the total flux integral:\n$$ \\mathcal{F} = T \\cdot \\sqrt{2\\pi T} \\cdot e^{-V^\\ddagger/T} \\cdot \\frac{\\sqrt{2\\pi T}}{\\omega_y^\\ddagger} = \\frac{2\\pi T^2}{\\omega_y^\\ddagger} e^{-V^\\ddagger/T} $$\n\nNext, we compute the classical reactant partition function integral, $Q_R$. The reactant potential is a 2D harmonic well with minimum at $V=0$: $V_R(x,y) = \\frac{1}{2}(\\omega_x^{\\mathrm{R}})^2 x^2 + \\frac{1}{2}(\\omega_y^{\\mathrm{R}})^2 y^2$.\n$$ Q_R = \\int d\\mathbf{p} \\int d\\mathbf{q} \\;\\; e^{-\\beta H_R(\\mathbf{p},\\mathbf{q})} = \\int e^{-\\beta \\left[\\frac{p_x^2+p_y^2}{2} + \\frac{1}{2}(\\omega_x^{\\mathrm{R}})^2 x^2 + \\frac{1}{2}(\\omega_y^{\\mathrm{R}})^2 y^2\\right]} dp_x dp_y dx dy $$\nThis is a product of four Gaussian integrals:\n$$ Q_R = \\left(\\sqrt{\\frac{2\\pi}{\\beta}}\\right)_{p_x} \\left(\\sqrt{\\frac{2\\pi}{\\beta}}\\right)_{p_y} \\left(\\sqrt{\\frac{2\\pi}{\\beta(\\omega_x^{\\mathrm{R}})^2}}\\right)_x \\left(\\sqrt{\\frac{2\\pi}{\\beta(\\omega_y^{\\mathrm{R}})^2}}\\right)_y = \\frac{(2\\pi T)^2}{\\omega_x^{\\mathrm{R}}\\omega_y^{\\mathrm{R}}} $$\n\nThe classical rate constant is the ratio:\n$$ k_{\\mathrm{cl}}(T) = \\frac{\\mathcal{F}}{Q_R} = \\frac{\\frac{2\\pi T^2}{\\omega_y^\\ddagger} e^{-V^\\ddagger/T}}{\\frac{(2\\pi T)^2}{\\omega_x^{\\mathrm{R}}\\omega_y^{\\mathrm{R}}}} = \\frac{2\\pi T^2 e^{-V^\\ddagger/T}}{\\omega_y^\\ddagger} \\frac{\\omega_x^{\\mathrm{R}}\\omega_y^{\\mathrm{R}}}{4\\pi^2 T^2} $$\n$$ k_{\\mathrm{cl}}(T) = \\frac{\\omega_x^{\\mathrm{R}} \\omega_y^{\\mathrm{R}}}{2\\pi \\omega_y^\\ddagger} e^{-V^\\ddagger/T} $$\n\nPart 2: Derivation of the Quantum Transition State Theory Rate $k_{\\mathrm{QTST}}(T)$\n\nQuantum TST is formulated using quantum statistical mechanical partition functions. The rate is given by $k_{\\mathrm{QTST}}(T) = \\frac{k_B T}{h} \\frac{Q^\\ddagger(T)}{Q_R(T)}$. In our units, this is $k_{\\mathrm{QTST}}(T) = \\frac{T}{2\\pi} \\frac{Q^\\ddagger(T)}{Q_R(T)}$.\n\nThe quantum partition function for a 1D harmonic oscillator with frequency $\\omega$ is:\n$$ q_{ho}(\\omega, T) = \\sum_{n=0}^{\\infty} e^{-\\beta E_n} = \\sum_{n=0}^{\\infty} e^{-\\beta \\hbar \\omega (n + 1/2)} = \\frac{e^{-\\hbar\\omega\\beta/2}}{1-e^{-\\hbar\\omega\\beta}} = \\frac{1}{2\\sinh(\\hbar\\omega\\beta/2)} $$\nWith $\\hbar=1$ and $\\beta=1/T$, this is $q_{ho}(\\omega, T) = \\frac{1}{2\\sinh(\\omega/2T)}$.\n\nThe reactant partition function $Q_R(T)$ is the product of the partition functions for its two independent vibrational modes, with frequencies $\\omega_x^{\\mathrm{R}}$ and $\\omega_y^{\\mathrm{R}}$. The zero-point of energy is at the reactant well minimum.\n$$ Q_R(T) = q_{ho}(\\omega_x^{\\mathrm{R}}, T) q_{ho}(\\omega_y^{\\mathrm{R}}, T) = \\frac{1}{2\\sinh(\\frac{\\omega_x^{\\mathrm{R}}}{2T})} \\frac{1}{2\\sinh(\\frac{\\omega_y^{\\mathrm{R}}}{2T})} $$\n\nThe transition state partition function $Q^\\ddagger(T)$ includes contributions from modes orthogonal to the reaction coordinate at the saddle point. Here, this is one stable vibration with frequency $\\omega_y^\\ddagger$. Its energy is shifted by the barrier height $V^\\ddagger$.\n$$ Q^\\ddagger(T) = q_{ho}(\\omega_y^\\ddagger, T) e^{-V^\\ddagger/T} = \\frac{e^{-V^\\ddagger/T}}{2\\sinh(\\frac{\\omega_y^\\ddagger}{2T})} $$\n\nSubstituting these into the rate expression:\n$$ k_{\\mathrm{QTST}}(T) = \\frac{T}{2\\pi} \\frac{Q^\\ddagger(T)}{Q_R(T)} = \\frac{T}{2\\pi} \\frac{ \\frac{e^{-V^\\ddagger/T}}{2\\sinh(\\frac{\\omega_y^\\ddagger}{2T})} }{ \\frac{1}{4\\sinh(\\frac{\\omega_x^{\\mathrm{R}}}{2T})\\sinh(\\frac{\\omega_y^{\\mathrm{R}}}{2T})} } $$\nSimplifying, we obtain the final expression:\n$$ k_{\\mathrm{QTST}}(T) = \\frac{T}{\\pi} e^{-V^\\ddagger/T} \\frac{\\sinh\\left(\\frac{\\omega_x^{\\mathrm{R}}}{2T}\\right) \\sinh\\left(\\frac{\\omega_y^{\\mathrm{R}}}{2T}\\right)}{\\sinh\\left(\\frac{\\omega_y^\\ddagger}{2T}\\right)} $$\n\nPart 3: Derivation of the Quantum-Corrected Rate $k_{\\mathrm{Q}}(T)$\n\nThe exact quantum rate for a separable system with a parabolic barrier can be expressed as $k_{\\mathrm{Q}}(T) = \\kappa(T, \\omega_b) k_{\\mathrm{QTST}}(T)$. The factor $\\kappa(T, \\omega_b)$ is a dynamical correction that accounts for quantum tunneling through the barrier and non-classical reflection above it. For an inverted parabolic barrier potential $V(x) = V^\\ddagger - \\frac{1}{2}\\omega_b^2 x^2$, this correction factor is a well-known result from the path integral formulation of quantum mechanics (or from evaluating the flux-flux correlation function). It is given by:\n$$ \\kappa(T, \\omega_b) = \\frac{k_{1D,exact}(T)}{k_{1D,TST}(T)} $$\nwhere $k_{1D,exact}$ is the exact quantum rate for one-dimensional motion over the barrier and $k_{1D,TST}$ is its TST approximation. This ratio evaluates to:\n$$ \\kappa(T, \\omega_b) = \\frac{\\hbar \\omega_b \\beta / 2}{\\sin(\\hbar \\omega_b \\beta / 2)} $$\nIn our units ($\\hbar=1, \\beta=1/T$):\n$$ \\kappa(T, \\omega_b) = \\frac{\\omega_b / (2T)}{\\sin(\\omega_b / (2T))} $$\nThis expression is valid for $\\omega_b/(2T)  \\pi$. The parameters in the test suite satisfy this condition.\n\nThe final quantum-corrected rate is therefore:\n$$ k_{\\mathrm{Q}}(T) = \\kappa(T, \\omega_b) k_{\\mathrm{QTST}}(T) = \\frac{\\omega_b / (2T)}{\\sin(\\omega_b / (2T))} \\left( \\frac{T}{\\pi} e^{-V^\\ddagger/T} \\frac{\\sinh\\left(\\frac{\\omega_x^{\\mathrm{R}}}{2T}\\right) \\sinh\\left(\\frac{\\omega_y^{\\mathrm{R}}}{2T}\\right)}{\\sinh\\left(\\frac{\\omega_y^\\ddagger}{2T}\\right)} \\right) $$\n\nSummary of Formulas for Implementation:\n1.  Classical rate: $k_{\\mathrm{cl}}(T) = \\frac{\\omega_x^{\\mathrm{R}} \\omega_y^{\\mathrm{R}}}{2\\pi \\omega_y^\\ddagger} e^{-V^\\ddagger/T}$\n2.  Quantum TST rate: $k_{\\mathrm{QTST}}(T) = \\frac{T}{\\pi} e^{-V^\\ddagger/T} \\frac{\\sinh(\\omega_x^{\\mathrm{R}}/2T) \\sinh(\\omega_y^{\\mathrm{R}}/2T)}{\\sinh(\\omega_y^\\ddagger/2T)}$\n3.  Quantum-corrected rate: $k_{\\mathrm{Q}}(T) = \\kappa(T, \\omega_b) k_{\\mathrm{QTST}}(T)$, where $\\kappa(T, \\omega_b) = \\frac{\\omega_b/(2T)}{\\sin(\\omega_b/(2T))}$\nThese formulas are now used to construct the required program.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes classical and quantum reaction rates for a 2D separable harmonic model.\n\n    The program calculates three rates for each parameter set:\n    1. k_cl(T): The classical thermal rate constant.\n    2. k_QTST(T): The quantum Transition State Theory rate constant.\n    3. k_Q(T): The quantum-corrected rate constant including tunneling.\n    4. The ratio k_Q(T) / k_cl(T).\n\n    All calculations are done in natural units where hbar = 1, k_B = 1, and m = 1.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    # Each tuple is (T, V_ddagger, omega_b, omega_x_R, omega_y_R, omega_y_ddagger)\n    test_cases = [\n        (1.0, 5.0, 2.0, 1.5, 1.2, 1.1),\n        (0.6, 4.0, 2.5, 1.8, 1.0, 1.3),\n        (2.5, 3.0, 1.0, 1.1, 0.9, 1.0),\n        (1.2, 2.0, 0.5, 1.4, 1.6, 1.5)\n    ]\n\n    all_results = []\n\n    for case in test_cases:\n        T, V_ddagger, omega_b, omega_x_R, omega_y_R, omega_y_ddagger = case\n\n        # 1. Calculate the classical rate constant, k_cl(T)\n        k_cl = (omega_x_R * omega_y_R) / (2 * np.pi * omega_y_ddagger) * np.exp(-V_ddagger / T)\n\n        # 2. Calculate the quantum Transition State Theory rate, k_QTST(T)\n        # Pre-calculate arguments for sinh functions for clarity\n        arg_x_R = omega_x_R / (2 * T)\n        arg_y_R = omega_y_R / (2 * T)\n        arg_y_ddagger = omega_y_ddagger / (2 * T)\n        \n        sinh_prod = np.sinh(arg_x_R) * np.sinh(arg_y_R)\n        sinh_denom = np.sinh(arg_y_ddagger)\n        \n        k_qtst = (T / np.pi) * np.exp(-V_ddagger / T) * (sinh_prod / sinh_denom)\n\n        # 3. Calculate the quantum-corrected rate, k_Q(T)\n        # This involves the tunneling correction factor, kappa.\n        arg_kappa = omega_b / (2 * T)\n        \n        # The formula is valid since arg_kappa  pi for all test cases.\n        if np.sin(arg_kappa) == 0:\n            # Handle cases where sin is zero, though not expected for given inputs\n            # This would correspond to a resonance condition where kappa diverges\n            kappa = np.inf\n        else:\n            kappa = arg_kappa / np.sin(arg_kappa)\n        \n        k_q = kappa * k_qtst\n        \n        # 4. Calculate the ratio k_Q / k_cl\n        # Handle the case k_cl = 0 to avoid division by zero, though unlikely here\n        if k_cl == 0:\n            ratio = np.inf if k_q  0 else 0\n        else:\n            ratio = k_q / k_cl\n\n        all_results.append([k_cl, k_qtst, k_q, ratio])\n\n    # Format the final output string according to the problem specification.\n    # The output should be a single line: [[val1,val2,...],[val1,val2,...],...]\n    # Each float value must be rounded to eight decimal places.\n    formatted_inner_lists = []\n    for inner_list in all_results:\n        formatted_floats = [f\"{x:.8f}\" for x in inner_list]\n        formatted_inner_lists.append(f\"[{','.join(formatted_floats)}]\")\n        \n    final_output_string = f\"[{','.join(formatted_inner_lists)}]\"\n\n    print(final_output_string)\n\nsolve()\n```", "id": "2800490"}]}