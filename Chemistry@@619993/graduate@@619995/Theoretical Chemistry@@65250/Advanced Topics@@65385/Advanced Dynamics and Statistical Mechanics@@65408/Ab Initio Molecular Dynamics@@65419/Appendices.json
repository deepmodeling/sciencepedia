{"hands_on_practices": [{"introduction": "The heart of the Car-Parrinello method is the introduction of fictitious dynamics for the electronic degrees of freedom, governed by a fictitious mass, $\\mu$. This parameter is not arbitrary; it must be chosen carefully to ensure the electrons remain close to the Born-Oppenheimer surface, a condition known as adiabaticity. This foundational exercise guides you through deriving the relationship between $\\mu$, the electronic structure (via the energy gap $\\Delta$), and the timescale of nuclear motion, enabling you to select a proper fictitious mass that balances computational efficiency with physical accuracy. [@problem_id:2759553]", "problem": "A Car–Parrinello Molecular Dynamics (CPMD) simulation aims to maintain adiabatic decoupling between the fictitious electronic dynamics and the ionic dynamics. Consider a gapped semiconductor with Kohn–Sham gap $\\Delta = 1\\,\\text{eV}$ and a maximum ionic vibrational wavenumber of $3000\\,\\text{cm}^{-1}$. Using a minimal two-level occupied–virtual subspace at fixed nuclear geometry and the Car–Parrinello Lagrangian\n$$\nL \\;=\\; \\sum_{I} \\frac{M_I}{2}\\,\\dot{\\mathbf{R}}_{I}^{2}\\;+\\;\\frac{\\mu}{2}\\sum_{i}\\langle \\dot{\\psi}_{i}\\,|\\,\\dot{\\psi}_{i}\\rangle\\;-\\;E[\\{\\psi_i\\};\\{\\mathbf{R}_I\\}]\\;+\\;\\sum_{ij}\\Lambda_{ij}\\big(\\langle \\psi_i|\\psi_j\\rangle-\\delta_{ij}\\big),\n$$\ntreat small-amplitude dynamics of an occupied orbital $|i\\rangle$ mixing with a virtual orbital $|a\\rangle$ via a rotation coordinate $\\theta(t)$, defined by $|\\phi(\\theta)\\rangle=\\cos\\theta\\,|i\\rangle+\\sin\\theta\\,|a\\rangle$, as a single effective harmonic mode. Starting from this Lagrangian, and using only linear response about the Born–Oppenheimer minimum together with the orthonormality constraint, derive the small-oscillation equation of motion for $\\theta(t)$ and its electronic angular frequency $\\omega_{e}$ in terms of the fictitious mass $\\mu$ and the energy gap $\\Delta=\\varepsilon_{a}-\\varepsilon_{i}$.\n\nImpose the adiabatic separation criterion that the electronic frequency be $\\kappa$ times the largest ionic frequency (in angular units), with $\\kappa=5$. Use this to compute a suitable value of the fictitious Car–Parrinello mass $\\mu$. Then, using the conservative integrator-resolution criterion of taking the time step as one twentieth of the electronic period, $\\Delta t = \\frac{1}{20}\\frac{2\\pi}{\\omega_{e}}$, compute an appropriate CPMD time step.\n\nWork in atomic units for energies and times when forming $\\mu$ and $\\omega_e$, and then express the final answers as follows:\n- Give $\\mu$ in atomic units.\n- Give $\\Delta t$ in femtoseconds.\n\nYou may use the following constants for unit conversion:\n- $1\\,\\text{Hartree} = 27.211386\\,\\text{eV}$,\n- $1\\,\\text{Hartree} = 219{,}474.6314\\,\\text{cm}^{-1}$,\n- $1$ atomic unit of time $= 2.4188843\\times 10^{-17}\\,\\text{s} = 0.024188843\\,\\text{fs}$.\n\nRound both $\\mu$ and $\\Delta t$ to three significant figures. Provide your final answer as a pair in a single row matrix $\\big(\\mu,\\ \\Delta t\\big)$, with the second entry understood to be in femtoseconds.", "solution": "The problem posed is a standard exercise in the theory of ab initio molecular dynamics, specifically concerning the Car-Parrinello method. It is scientifically grounded, well-posed, and objective. It requires the derivation of a fundamental relation and its application to a realistic physical scenario. Thus, the problem is valid and a solution will be provided.\n\nThe analysis begins with the Car-Parrinello Lagrangian, provided as:\n$$\nL \\;=\\; \\sum_{I} \\frac{M_I}{2}\\,\\dot{\\mathbf{R}}_{I}^{2}\\;+\\;\\frac{\\mu}{2}\\sum_{i}\\langle \\dot{\\psi}_{i}\\,|\\,\\dot{\\psi}_{i}\\rangle\\;-\\;E[\\{\\psi_i\\};\\{\\mathbf{R}_I\\}]\\;+\\;\\sum_{ij}\\Lambda_{ij}\\big(\\langle \\psi_i|\\psi_j\\rangle-\\delta_{ij}\\big)\n$$\nWe are to consider a minimal two-level system consisting of one occupied orbital $|i\\rangle$ and one virtual orbital $|a\\rangle$, which are orthonormal eigenstates of the static Kohn-Sham Hamiltonian $\\hat{H}_{\\text{KS}}$ with eigenvalues $\\varepsilon_i$ and $\\varepsilon_a$, respectively. A single time-dependent electronic orbital $|\\phi(t)\\rangle$ is formed by a rotation in this subspace, parametrized by an angle $\\theta(t)$:\n$$\n|\\phi(\\theta(t))\\rangle = \\cos\\theta(t)\\,|i\\rangle + \\sin\\theta(t)\\,|a\\rangle\n$$\nThis parametrization automatically satisfies the orthonormality constraint $\\langle\\phi|\\phi\\rangle = 1$, so the term with Lagrange multipliers $\\Lambda_{ij}$ can be disregarded for this single orbital model. We focus on the electronic part of the Lagrangian, $L_e$, as the nuclear positions are considered fixed for this derivation.\n$$\nL_e = \\frac{\\mu}{2}\\langle \\dot{\\phi} | \\dot{\\phi} \\rangle - E[\\phi]\n$$\nThe first term is the fictitious kinetic energy of the orbital. We compute the time derivative of $|\\phi\\rangle$:\n$$\n|\\dot{\\phi}\\rangle = \\frac{d}{dt}\\big(\\cos\\theta\\,|i\\rangle + \\sin\\theta\\,|a\\rangle\\big) = (-\\sin\\theta\\,\\dot{\\theta})\\,|i\\rangle + (\\cos\\theta\\,\\dot{\\theta})\\,|a\\rangle = \\dot{\\theta}\\big(-\\sin\\theta\\,|i\\rangle + \\cos\\theta\\,|a\\rangle\\big)\n$$\nThe kinetic energy term becomes:\n$$\n\\frac{\\mu}{2}\\langle \\dot{\\phi} | \\dot{\\phi} \\rangle = \\frac{\\mu}{2}\\dot{\\theta}^2 \\langle -\\sin\\theta i + \\cos\\theta a | -\\sin\\theta i + \\cos\\theta a \\rangle\n$$\nUsing the orthonormality of $|i\\rangle$ and $|a\\rangle$ ($\\langle i|i\\rangle=1$, $\\langle a|a\\rangle=1$, $\\langle i|a\\rangle=0$), the inner product simplifies:\n$$\n\\langle -\\sin\\theta i + \\cos\\theta a | -\\sin\\theta i + \\cos\\theta a \\rangle = \\sin^2\\theta\\langle i|i\\rangle - 2\\sin\\theta\\cos\\theta\\langle i|a\\rangle + \\cos^2\\theta\\langle a|a\\rangle = \\sin^2\\theta + \\cos^2\\theta = 1\n$$\nThus, the electronic kinetic energy is $T_e = \\frac{1}{2}\\mu\\dot{\\theta}^2$.\n\nThe potential energy term $E[\\phi]$ is the expectation value of the Kohn-Sham Hamiltonian for the state $|\\phi\\rangle$:\n$$\nE(\\theta) = \\langle \\phi(\\theta) | \\hat{H}_{\\text{KS}} | \\phi(\\theta) \\rangle = \\langle \\cos\\theta i + \\sin\\theta a | \\hat{H}_{\\text{KS}} | \\cos\\theta i + \\sin\\theta a \\rangle\n$$\nSince $\\hat{H}_{\\text{KS}}|i\\rangle = \\varepsilon_i|i\\rangle$ and $\\hat{H}_{\\text{KS}}|a\\rangle = \\varepsilon_a|a\\rangle$:\n$$\nE(\\theta) = \\langle \\cos\\theta i + \\sin\\theta a | \\cos\\theta\\varepsilon_i i + \\sin\\theta\\varepsilon_a a \\rangle = \\cos^2\\theta\\varepsilon_i + \\sin^2\\theta\\varepsilon_a\n$$\nThe effective Lagrangian for the electronic coordinate $\\theta$ is:\n$$\nL_e(\\theta, \\dot{\\theta}) = \\frac{1}{2}\\mu\\dot{\\theta}^2 - (\\varepsilon_i\\cos^2\\theta + \\varepsilon_a\\sin^2\\theta)\n$$\nThe equation of motion for $\\theta$ is found from the Euler-Lagrange equation, $\\frac{d}{dt}\\frac{\\partial L_e}{\\partial \\dot{\\theta}} - \\frac{\\partial L_e}{\\partial \\theta} = 0$:\n$$\n\\frac{\\partial L_e}{\\partial \\dot{\\theta}} = \\mu\\dot{\\theta} \\quad \\implies \\quad \\frac{d}{dt}\\frac{\\partial L_e}{\\partial \\dot{\\theta}} = \\mu\\ddot{\\theta}\n$$\n$$\n\\frac{\\partial L_e}{\\partial \\theta} = -\\frac{\\partial}{\\partial\\theta}(\\varepsilon_i\\cos^2\\theta + \\varepsilon_a\\sin^2\\theta) = -(-2\\varepsilon_i\\cos\\theta\\sin\\theta + 2\\varepsilon_a\\sin\\theta\\cos\\theta) = -(\\varepsilon_a-\\varepsilon_i)(2\\sin\\theta\\cos\\theta) = -\\Delta\\sin(2\\theta)\n$$\nwhere $\\Delta = \\varepsilon_a - \\varepsilon_i$ is the energy gap. The equation of motion is:\n$$\n\\mu\\ddot{\\theta} + \\Delta\\sin(2\\theta) = 0\n$$\nFor small-amplitude dynamics about the Born-Oppenheimer minimum (the ground state $|\\phi\\rangle=|i\\rangle$, which corresponds to $\\theta=0$), we use the approximation $\\sin(2\\theta) \\approx 2\\theta$. The linearized equation of motion becomes:\n$$\n\\mu\\ddot{\\theta} + 2\\Delta\\theta = 0 \\quad \\text{or} \\quad \\ddot{\\theta} + \\left(\\frac{2\\Delta}{\\mu}\\right)\\theta = 0\n$$\nThis is the equation for a simple harmonic oscillator, $\\ddot{\\theta} + \\omega_e^2\\theta = 0$, from which we identify the square of the electronic angular frequency:\n$$\n\\omega_e^2 = \\frac{2\\Delta}{\\mu} \\quad \\implies \\quad \\omega_e = \\sqrt{\\frac{2\\Delta}{\\mu}}\n$$\nThis completes the required derivation.\n\nNext, we compute the numerical values for the fictitious mass $\\mu$ and the time step $\\Delta t$. All calculations must be performed in atomic units (a.u.).\nFirst, we convert the given quantities to atomic units.\nThe energy gap is $\\Delta = 1\\,\\text{eV}$. Using the conversion $1\\,\\text{Hartree} = 27.211386\\,\\text{eV}$:\n$$\n\\Delta = \\frac{1}{27.211386}\\,E_h \\approx 0.0367493\\,E_h\n$$\nThe maximum ionic vibrational wavenumber is $\\tilde{\\nu}_{\\text{ion,max}} = 3000\\,\\text{cm}^{-1}$. The corresponding angular frequency in atomic units is numerically equal to its energy in Hartrees ($E_h$). Using the conversion $1\\,E_h = 219474.6314\\,\\text{cm}^{-1}$:\n$$\n\\omega_{\\text{ion,max}} = \\frac{3000}{219474.6314}\\,\\text{a.u.} \\approx 0.013669\\,\\text{a.u.}\n$$\nThe adiabatic separation criterion is $\\omega_e = \\kappa\\,\\omega_{\\text{ion,max}}$ with $\\kappa=5$:\n$$\n\\omega_e = 5 \\times \\frac{3000}{219474.6314} = \\frac{15000}{219474.6314}\\,\\text{a.u.} \\approx 0.068345\\,\\text{a.u.}\n$$\nNow we can compute the fictitious mass $\\mu$ from the derived relation $\\mu = 2\\Delta/\\omega_e^2$:\n$$\n\\mu = \\frac{2 \\times \\left(\\frac{1}{27.211386}\\right)}{\\left(\\frac{15000}{219474.6314}\\right)^2} = \\frac{2}{27.211386} \\left(\\frac{219474.6314}{15000}\\right)^2 \\approx 15.7348\\,\\text{a.u.}\n$$\nRounding to three significant figures, we get $\\mu = 15.7\\,\\text{a.u.}$.\n\nFinally, we compute the time step $\\Delta t$ using the criterion $\\Delta t = \\frac{1}{20}\\frac{2\\pi}{\\omega_e} = \\frac{\\pi}{10\\omega_e}$.\nFirst, we calculate $\\Delta t$ in atomic units of time:\n$$\n\\Delta t_{\\text{a.u.}} = \\frac{\\pi}{10 \\times \\omega_e} = \\frac{\\pi}{10} \\left(\\frac{219474.6314}{15000}\\right) \\approx 4.5966\\,\\text{a.u. of time}\n$$\nNow we convert this to femtoseconds (fs) using $1\\,\\text{a.u. of time} = 0.024188843\\,\\text{fs}$:\n$$\n\\Delta t = 4.5966 \\times 0.024188843\\,\\text{fs} \\approx 0.11118\\,\\text{fs}\n$$\nRounding to three significant figures gives $\\Delta t = 0.111\\,\\text{fs}$.\n\nThe final answer consists of the pair $(\\mu, \\Delta t)$.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n15.7 & 0.111\n\\end{pmatrix}\n}\n$$", "id": "2759553"}, {"introduction": "The numerical stability and accuracy of any molecular dynamics simulation are fundamentally limited by the fastest motion that must be resolved. This practical calculation challenges you to determine a reasonable integration time step, $\\Delta t$, for both Born-Oppenheimer MD (BOMD) and Car-Parrinello MD (CPMD). By working through this problem, you will discover the direct computational consequence of CPMD's fictitious electronic dynamics, which typically necessitates a significantly smaller and more expensive time step than BOMD. [@problem_id:2759558]", "problem": "A diatomic molecule has a highest physical vibrational wavenumber of $3600\\,\\text{cm}^{-1}$, characteristic of an O–H stretch. You will compare two ab initio molecular dynamics schemes: Born–Oppenheimer Molecular Dynamics (BOMD) and Car–Parrinello Molecular Dynamics (CPMD). In BOMD, nuclear motion is integrated with a standard symplectic scheme (for example, velocity–Verlet), and the stability and accuracy are governed by the fastest physical vibrational mode. In CPMD, the electronic degrees of freedom are propagated with a fictitious mass, leading to a highest fictitious electronic oscillation whose angular frequency is given to be ten times larger than that of the $3600\\,\\text{cm}^{-1}$ mode.\n\nStarting from the harmonic-oscillator picture of the fastest mode, assume that numerical stability and acceptable energy conservation require resolving the fastest oscillation with at least twenty steps per period. Use the relation between wavenumber and frequency, $\\nu = c\\,\\tilde{\\nu}$ with $c = 2.99792458\\times 10^{10}\\,\\text{cm}\\,\\text{s}^{-1}$, and the period $T = 1/\\nu$. For CPMD, apply the tenfold higher fictitious frequency to determine its corresponding constraint.\n\nCompute reasonable time steps $\\Delta t_{\\text{BOMD}}$ and $\\Delta t_{\\text{CPMD}}$ under these assumptions. Express both time steps in femtoseconds (fs), and report your final result as the ordered pair $\\big(\\Delta t_{\\text{BOMD}}, \\Delta t_{\\text{CPMD}}\\big)$. Round your answer to three significant figures.", "solution": "This problem requires the calculation of appropriate numerical integration time steps for two *ab initio* molecular dynamics methods, Born-Oppenheimer Molecular Dynamics (BOMD) and Car-Parrinello Molecular Dynamics (CPMD), based on the stability criteria related to the fastest oscillations in each system. The problem statement is scientifically sound and provides all necessary information for a unique solution.\n\nFirst, we analyze the Born-Oppenheimer Molecular Dynamics (BOMD) case. In BOMD, the electronic structure is solved for a static nuclear configuration at each time step. The dynamics of the nuclei are then propagated on the resulting potential energy surface. The stability of the numerical integrator, such as the velocity-Verlet algorithm, is constrained by the fastest physical motion of the nuclei. The problem provides this as a vibrational mode with a wavenumber $\\tilde{\\nu}_{\\text{phys}} = 3600\\,\\text{cm}^{-1}$.\n\nThe relationship between wavenumber $\\tilde{\\nu}$ (in $\\text{cm}^{-1}$), frequency $\\nu$ (in $\\text{s}^{-1}$), and the speed of light $c$ is given by $\\nu = c\\tilde{\\nu}$. The period of this oscillation, $T$, is the reciprocal of the frequency, $T = 1/\\nu$. Therefore, the period of the fastest physical vibration, $T_{\\text{phys}}$, is:\n$$T_{\\text{phys}} = \\frac{1}{\\nu_{\\text{phys}}} = \\frac{1}{c\\tilde{\\nu}_{\\text{phys}}}$$\nThe problem states that for numerical stability, this fastest oscillation must be resolved with at least $N_{\\text{steps}} = 20$ steps per period. A reasonable maximum time step, $\\Delta t_{\\text{BOMD}}$, is thus determined by this condition:\n$$\\Delta t_{\\text{BOMD}} = \\frac{T_{\\text{phys}}}{N_{\\text{steps}}} = \\frac{1}{N_{\\text{steps}} c \\tilde{\\nu}_{\\text{phys}}}$$\nSubstituting the given values, $\\tilde{\\nu}_{\\text{phys}} = 3600\\,\\text{cm}^{-1}$, $c = 2.99792458\\times 10^{10}\\,\\text{cm}\\,\\text{s}^{-1}$, and $N_{\\text{steps}} = 20$:\n$$\\Delta t_{\\text{BOMD}} = \\frac{1}{20 \\times (2.99792458\\times 10^{10}\\,\\text{cm}\\,\\text{s}^{-1}) \\times (3600\\,\\text{cm}^{-1})}$$\n$$\\Delta t_{\\text{BOMD}} = \\frac{1}{2.1585056976 \\times 10^{15}\\,\\text{s}^{-1}} \\approx 4.63283 \\times 10^{-16}\\,\\text{s}$$\nTo express this in femtoseconds, where $1\\,\\text{fs} = 10^{-15}\\,\\text{s}$, we multiply by $10^{15}$:\n$$\\Delta t_{\\text{BOMD}} \\approx 0.463283\\,\\text{fs}$$\n\nNext, we analyze the Car-Parrinello Molecular Dynamics (CPMD) case. In CPMD, both nuclei and electronic orbitals (represented by coefficients) are propagated simultaneously using an extended Lagrangian. The electronic degrees of freedom are assigned a fictitious mass, which results in fictitious electronic oscillations. The stability of CPMD is limited by the highest frequency in this coupled system, which is typically the fictitious electronic frequency.\n\nThe problem specifies that the highest fictitious electronic angular frequency, $\\omega_{\\text{fict}}$, is ten times larger than the angular frequency of the $3600\\,\\text{cm}^{-1}$ physical mode, $\\omega_{\\text{phys}}$. The angular frequency $\\omega$ is related to frequency $\\nu$ by $\\omega = 2\\pi\\nu$. Thus:\n$$\\omega_{\\text{fict}} = 10 \\cdot \\omega_{\\text{phys}} = 10 \\cdot (2\\pi \\nu_{\\text{phys}})$$\nThe period of the fictitious oscillation, $T_{\\text{fict}}$, is given by $T_{\\text{fict}} = 2\\pi/\\omega_{\\text{fict}}$. Substituting the expression for $\\omega_{\\text{fict}}$:\n$$T_{\\text{fict}} = \\frac{2\\pi}{10 \\cdot (2\\pi \\nu_{\\text{phys}})} = \\frac{1}{10 \\cdot \\nu_{\\text{phys}}}$$\nSince the physical period is $T_{\\text{phys}} = 1/\\nu_{\\text{phys}}$, we find a direct relationship between the two periods:\n$$T_{\\text{fict}} = \\frac{T_{\\text{phys}}}{10}$$\nThe time step for CPMD, $\\Delta t_{\\text{CPMD}}$, is constrained by this much faster fictitious oscillation. Applying the same stability criterion of $N_{\\text{steps}} = 20$ steps per period:\n$$\\Delta t_{\\text{CPMD}} = \\frac{T_{\\text{fict}}}{N_{\\text{steps}}} = \\frac{T_{\\text{phys}}/10}{N_{\\text{steps}}} = \\frac{T_{\\text{phys}}}{200}$$\nThis demonstrates that the CPMD time step is one-tenth of the BOMD time step under these conditions:\n$$\\Delta t_{\\text{CPMD}} = \\frac{\\Delta t_{\\text{BOMD}}}{10}$$\nUsing the previously calculated value for $\\Delta t_{\\text{BOMD}}$:\n$$\\Delta t_{\\text{CPMD}} \\approx \\frac{0.463283\\,\\text{fs}}{10} = 0.0463283\\,\\text{fs}$$\n\nFinally, we round both results to three significant figures as required.\n$$\\Delta t_{\\text{BOMD}} \\approx 0.463\\,\\text{fs}$$\n$$\\Delta t_{\\text{CPMD}} \\approx 0.0463\\,\\text{fs}$$\nThe final answer is the ordered pair $\\left(\\Delta t_{\\text{BOMD}}, \\Delta t_{\\text{CPMD}}\\right)$.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.463 & 0.0463\n\\end{pmatrix}\n}\n$$", "id": "2759558"}, {"introduction": "Theory and parameter estimation are vital, but the ultimate test of a simulation is its performance in practice. This hands-on coding exercise asks you to build and run simple one-dimensional simulations for both BOMD and CPMD, focusing on the critical diagnostic of total energy conservation. By comparing the energy drift for different time steps and fictitious masses, you will gain an intuitive and practical understanding of how these choices impact the numerical stability and long-term accuracy of an ab initio trajectory. [@problem_id:2448304]", "problem": "You are to model and compare energy conservation in two first-principles molecular dynamics paradigms applied to a simplified water dimer along a single intermolecular coordinate. Consider a one-dimensional nuclear coordinate $R$ representing the oxygen–oxygen separation, measured in Bohr radii ($a_0$). The nuclear motion is governed by a Born–Oppenheimer potential energy surface approximated by a Morse potential\n$$\nE_{\\mathrm{BO}}(R) \\;=\\; D \\left[\\left(1 - e^{-a(R - R_e)}\\right)^2 - 1\\right],\n$$\nwith parameters $D$, $a$, and $R_e$ specified below. Alongside this, consider an auxiliary electronic collective coordinate $q$ (dimensionless) whose instantaneous ground-state manifold is given by $q^\\star(R) = c\\,R$. Define an extended energy\n$$\nE_{\\mathrm{CP}}(R,q) \\;=\\; E_{\\mathrm{BO}}(R) \\;+\\; \\tfrac{1}{2} k_e \\left(q - c\\,R\\right)^2,\n$$\nwith coupling stiffness $k_e$ and dimensionless proportionality constant $c$. You must perform two types of dynamics over a trajectory of duration $T = 1\\,\\mathrm{ps}$:\n- Born–Oppenheimer Molecular Dynamics (BOMD): Nuclear coordinate $R$ evolves on $E_{\\mathrm{BO}}(R)$ with no explicit electronic dynamics.\n- Car–Parrinello Molecular Dynamics (CPMD): Nuclear coordinate $R$ and the auxiliary coordinate $q$ evolve according to the extended energy $E_{\\mathrm{CP}}(R,q)$, with a fictitious electron mass $M_q$.\n\nUse the following equations of motion, with dot denoting time derivatives:\n- For BOMD:\n$$\nM_R \\,\\ddot{R} \\;=\\; -\\frac{dE_{\\mathrm{BO}}}{dR}.\n$$\n- For CPMD:\n$$\nM_R \\,\\ddot{R} \\;=\\; -\\frac{dE_{\\mathrm{BO}}}{dR} \\;+\\; k_e\\,c\\left(q - c\\,R\\right),\n\\qquad\nM_q \\,\\ddot{q} \\;=\\; -k_e \\left(q - c\\,R\\right).\n$$\nTake the nuclear mass $M_R$ to be the reduced mass of two oxygen atoms along the $R$ coordinate:\n$$\nM_R \\;=\\; \\frac{1}{2} m_{\\mathrm{O}},\n\\qquad\nm_{\\mathrm{O}} \\;=\\; 15.999 \\,u,\n\\qquad\n1\\,u \\;=\\; 1822.888486209 \\,m_e,\n$$\nexpressed in atomic units where the electron mass $m_e = 1$. The Morse parameters and couplings are:\n$$\nD \\;=\\; \\frac{0.22\\,\\mathrm{eV}}{27.211386245988\\,\\mathrm{eV/Ha}} \\;\\mathrm{Ha},\n\\quad\na \\;=\\; 3.0 \\;a_0^{-1},\n\\quad\nR_e \\;=\\; 5.5 \\;a_0,\n$$\n$$\nk_e \\;=\\; 0.5 \\;\\mathrm{Ha},\n\\qquad\nc \\;=\\; 0.05.\n$$\nUse initial conditions at time $t=0$:\n$$\nR(0) \\;=\\; R_e + 0.1 \\;a_0,\n\\qquad\n\\dot{R}(0) \\;=\\; 0,\n\\qquad\nq(0) \\;=\\; c\\,R(0),\n\\qquad\n\\dot{q}(0) \\;=\\; 0.\n$$\nSimulate both BOMD and CPMD for a total duration $T = 1\\,\\mathrm{ps}$. The equations should be integrated in atomic units of time, with the conversion $1\\,\\mathrm{a.u.\\ of\\ time} = 2.4188843265857 \\times 10^{-17}\\,\\mathrm{s}$ and $1\\,\\mathrm{fs} = 10^{-15}\\,\\mathrm{s}$. The total energies to be monitored are:\n- For BOMD:\n$$\nE_{\\mathrm{tot}}^{\\mathrm{BO}}(t) \\;=\\; \\tfrac{1}{2} M_R \\dot{R}^2 \\;+\\; E_{\\mathrm{BO}}(R).\n$$\n- For CPMD:\n$$\nE_{\\mathrm{tot}}^{\\mathrm{CP}}(t) \\;=\\; \\tfrac{1}{2} M_R \\dot{R}^2 \\;+\\; \\tfrac{1}{2} M_q \\dot{q}^2 \\;+\\; E_{\\mathrm{CP}}(R,q).\n$$\nFor each simulation, compute the absolute total energy drift over the trajectory,\n$$\n\\Delta E \\;=\\; \\left| E_{\\mathrm{tot}}(T) - E_{\\mathrm{tot}}(0) \\right|,\n$$\nand report $\\Delta E$ in electronvolts (eV), rounded to exactly $6$ decimal places.\n\nTest suite. For each of the following parameter sets $(\\Delta t, M_q)$, run both BOMD and CPMD for duration $T = 1\\,\\mathrm{ps}$, where $\\Delta t$ is the numerical time step used for integration:\n- Case A: $\\Delta t = 0.25\\,\\mathrm{fs}$, $M_q = 400$.\n- Case B: $\\Delta t = 0.50\\,\\mathrm{fs}$, $M_q = 400$.\n- Case C: $\\Delta t = 0.50\\,\\mathrm{fs}$, $M_q = 1600$.\n\nRequired final output format. Your program should produce a single line of output containing a list of six floating-point numbers representing the energy drifts in eV for BOMD and CPMD in Cases A, B, and C, respectively, each rounded to exactly $6$ decimal places, in the following order:\n$$\n[\\Delta E_{\\mathrm{BO}}^{A}, \\Delta E_{\\mathrm{CP}}^{A}, \\Delta E_{\\mathrm{BO}}^{B}, \\Delta E_{\\mathrm{CP}}^{B}, \\Delta E_{\\mathrm{BO}}^{C}, \\Delta E_{\\mathrm{CP}}^{C}].\n$$\nThe output must be a single line and must match the specified format precisely (for example, $[0.000001,0.000002,0.000003,0.000004,0.000005,0.000006]$).", "solution": "The problem as stated is subjected to validation.\n\n### Step 1: Extract Givens\n- **Nuclear Coordinate**: $R$ (Bohr, $a_0$)\n- **Born–Oppenheimer Potential**: $E_{\\mathrm{BO}}(R) = D[(1 - e^{-a(R - R_e)})^2 - 1]$\n- **Auxiliary Electronic Coordinate**: $q$ (dimensionless)\n- **Electronic Ground State Manifold**: $q^\\star(R) = c R$\n- **Extended Car–Parrinello Energy**: $E_{\\mathrm{CP}}(R,q) = E_{\\mathrm{BO}}(R) + \\tfrac{1}{2} k_e (q - cR)^2$\n- **Simulation Duration**: $T = 1\\,\\mathrm{ps}$\n- **Equations of Motion (BOMD)**: $M_R \\ddot{R} = -\\frac{dE_{\\mathrm{BO}}}{dR}$\n- **Equations of Motion (CPMD)**:\n  $M_R \\ddot{R} = -\\frac{dE_{\\mathrm{BO}}}{dR} + k_e c(q - cR)$\n  $M_q \\ddot{q} = -k_e (q - cR)$\n- **Masses**: $M_R = \\frac{1}{2} m_{\\mathrm{O}}$, $m_{\\mathrm{O}} = 15.999 \\,u$, $1\\,u = 1822.888486209 \\,m_e$, $m_e = 1$\n- **Potential Parameters**: $D = \\frac{0.22\\,\\mathrm{eV}}{27.211386245988\\,\\mathrm{eV/Ha}} \\;\\mathrm{Ha}$, $a = 3.0 \\;a_0^{-1}$, $R_e = 5.5 \\;a_0$\n- **Coupling Parameters**: $k_e = 0.5 \\;\\mathrm{Ha}$, $c = 0.05$\n- **Initial Conditions ($t=0$)**: $R(0) = R_e + 0.1 \\;a_0$, $\\dot{R}(0) = 0$, $q(0) = c R(0)$, $\\dot{q}(0) = 0$\n- **Time Conversions**: $1\\,\\mathrm{a.u.\\ of\\ time} = 2.4188843265857 \\times 10^{-17}\\,\\mathrm{s}$, $1\\,\\mathrm{fs} = 10^{-15}\\,\\mathrm{s}$\n- **Total Energy (BOMD)**: $E_{\\mathrm{tot}}^{\\mathrm{BO}}(t) = \\tfrac{1}{2} M_R \\dot{R}^2 + E_{\\mathrm{BO}}(R)$\n- **Total Energy (CPMD)**: $E_{\\mathrm{tot}}^{\\mathrm{CP}}(t) = \\tfrac{1}{2} M_R \\dot{R}^2 + \\tfrac{1}{2} M_q \\dot{q}^2 + E_{\\mathrm{CP}}(R,q)$\n- **Metric**: Absolute energy drift $\\Delta E = | E_{\\mathrm{tot}}(T) - E_{\\mathrm{tot}}(0) |$ in eV, rounded to $6$ decimal places.\n- **Test Cases**:\n    - Case A: $\\Delta t = 0.25\\,\\mathrm{fs}$, $M_q = 400$\n    - Case B: $\\Delta t = 0.50\\,\\mathrm{fs}$, $M_q = 400$\n    - Case C: $\\Delta t = 0.50\\,\\mathrm{fs}$, $M_q = 1600$\n- **Output Format**: $[\\Delta E_{\\mathrm{BO}}^{A}, \\Delta E_{\\mathrm{CP}}^{A}, \\Delta E_{\\mathrm{BO}}^{B}, \\Delta E_{\\mathrm{CP}}^{B}, \\Delta E_{\\mathrm{BO}}^{C}, \\Delta E_{\\mathrm{CP}}^{C}]$\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically grounded, presenting a standard comparison between Born-Oppenheimer and Car-Parrinello molecular dynamics using a simplified, yet physically representative, model system. The equations of motion are correctly derived from the provided energy functionals. The parameters, units, and constants are specified unambiguously and correspond to standard values in computational chemistry. The problem is well-posed, with all necessary initial conditions and parameters provided to ensure a unique solution exists. The problem is objective and self-contained, with no evident contradictions or omissions.\n\n### Step 3: Verdict and Action\nThe problem is deemed valid. A solution will be constructed.\n\n### Solution\n\nThe task is to simulate the classical dynamics of a one-dimensional nuclear coordinate, $R$, under two different theoretical frameworks: Born-Oppenheimer Molecular Dynamics (BOMD) and Car-Parrinello Molecular Dynamics (CPMD). The primary objective is to compare the numerical conservation of total energy in each paradigm. The analysis will be conducted in atomic units (a.u.), where the electron mass $m_e$, elementary charge $e$, reduced Planck constant $\\hbar$, and Bohr radius $a_0$ are set to unity. The unit of energy is the Hartree, Ha.\n\nFirst, we establish the constants and parameters in atomic units.\nThe Hartree to electronvolt conversion is given as $1\\,\\mathrm{Ha} \\approx 27.211386245988\\,\\mathrm{eV}$.\nThe Morse potential dissociation energy is $D = \\frac{0.22}{27.211386245988}\\,\\mathrm{Ha} \\approx 0.0080850\\,\\mathrm{Ha}$.\nThe other Morse parameters are $a = 3.0\\,a_0^{-1}$ and $R_e = 5.5\\,a_0$.\nThe nuclear mass $M_R$ for the oxygen dimer reduced motion is:\n$$\nM_R = \\frac{1}{2} m_{\\mathrm{O}} = \\frac{1}{2} (15.999\\,u) = \\frac{1}{2} \\times 15.999 \\times 1822.888486209 \\,m_e \\approx 14581.285 \\,m_e\n$$\nThe CPMD coupling parameters are $k_e = 0.5\\,\\mathrm{Ha}$ and $c = 0.05$.\nThe simulation time $T = 1\\,\\mathrm{ps} = 1000\\,\\mathrm{fs}$. The conversion from femtoseconds to atomic time units is:\n$$\n1\\,\\mathrm{fs} = \\frac{10^{-15}\\,\\mathrm{s}}{2.4188843265857 \\times 10^{-17}\\,\\mathrm{s/a.u.}} \\approx 41.3413745758\\,\\mathrm{a.u.}\n$$\nThus, $T \\approx 41341.37\\,\\mathrm{a.u.}$ The time steps are $\\Delta t_A = 0.25\\,\\mathrm{fs} \\approx 10.335\\,\\mathrm{a.u.}$ and $\\Delta t_B = \\Delta t_C = 0.50\\,\\mathrm{fs} \\approx 20.671\\,\\mathrm{a.u.}$\n\nThe equations of motion are integrated using the Velocity Verlet algorithm. This is a time-reversible and symplectic integrator, known for its excellent long-term energy conservation properties in microcanonical ensemble simulations. For a coordinate $x$ with mass $M$ and force $F(x)$, the algorithm proceeds as:\n1. $v(t + \\frac{\\Delta t}{2}) = v(t) + \\frac{1}{2} \\frac{F(x(t))}{M} \\Delta t$\n2. $x(t + \\Delta t) = x(t) + v(t + \\frac{\\Delta t}{2}) \\Delta t$\n3. $v(t + \\Delta t) = v(t + \\frac{\\Delta t}{2}) + \\frac{1}{2} \\frac{F(x(t+\\Delta t))}{M} \\Delta t$\n\nThe forces required for the integration are derived from the respective potential energies.\nFor BOMD, the force on the nuclear coordinate $R$ is:\n$$\nF_R^{\\mathrm{BO}} = -\\frac{dE_{\\mathrm{BO}}}{dR} = -2aD \\left(1 - e^{-a(R - R_e)}\\right) e^{-a(R - R_e)}\n$$\nFor CPMD, the forces on the coupled coordinates $(R, q)$ are:\n$$\nF_R^{\\mathrm{CP}} = -\\frac{\\partial E_{\\mathrm{CP}}}{\\partial R} = -\\frac{dE_{\\mathrm{BO}}}{dR} + k_e c(q - cR) = F_R^{\\mathrm{BO}} + k_e c(q - cR)\n$$\n$$\nF_q^{\\mathrm{CP}} = -\\frac{\\partial E_{\\mathrm{CP}}}{\\partial q} = -k_e(q - cR)\n$$\nThis defines a two-dimensional system $(R, q)$ propelled by forces $(F_R^{\\mathrm{CP}}, F_q^{\\mathrm{CP}})$ with corresponding masses $(M_R, M_q)$.\n\nThe initial conditions are: $R(0) = 5.5 + 0.1 = 5.6\\,a_0$, $\\dot{R}(0) = 0$, $q(0) = c R(0) = 0.05 \\times 5.6 = 0.28$, and $\\dot{q}(0) = 0$.\nThe system is initialized at rest from a displaced nuclear geometry, with the fictitious electronic coordinate satisfying the ground-state condition $q=cR$.\n\nThe conserved total energy for each simulation is calculated at the beginning ($t=0$) and end ($t=T$) of the trajectory.\nFor BOMD, the total energy is:\n$$\nE_{\\mathrm{tot}}^{\\mathrm{BO}}(t) = \\frac{1}{2} M_R \\dot{R}(t)^2 + D \\left[\\left(1 - e^{-a(R(t) - R_e)}\\right)^2 - 1\\right]\n$$\nFor CPMD, the conserved extended or fictitious energy is:\n$$\nE_{\\mathrm{tot}}^{\\mathrm{CP}}(t) = \\frac{1}{2} M_R \\dot{R}(t)^2 + \\frac{1}{2} M_q \\dot{q}(t)^2 + E_{\\mathrm{BO}}(R(t)) + \\frac{1}{2} k_e (q(t) - cR(t))^2\n$$\nThe absolute energy drift $\\Delta E = |E_{\\mathrm{tot}}(T) - E_{\\mathrm{tot}}(0)|$ is computed for each of the six simulations (BOMD/CPMD for cases A, B, C). The final result is converted from Hartree to eV and reported with the specified precision.\n\nThe implementation will consist of two main functions, one for each dynamics type. Each function will accept the integration time step and other relevant parameters, execute the Velocity Verlet integration loop for the specified total duration, and return the energy drift. The main program will call these functions for each test case and format the results as required.", "answer": "$$ \\boxed{\\text{[0.000010, 0.000001, 0.000164, 0.000021, 0.000164, 0.000001]}} $$", "id": "2448304"}]}