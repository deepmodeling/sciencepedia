{"hands_on_practices": [{"introduction": "The journey into non-adiabatic dynamics begins with a clear understanding of the fundamental building blocks: the diabatic and adiabatic representations. This first exercise provides a foundational look at a minimal two-state model, which is the cornerstone for describing phenomena like charge transfer and photochemical reactions. By diagonalizing a simple diabatic Hamiltonian, you will derive the adiabatic potential energy surfaces and the mixing angle that connects the two representations, offering a first-hand look at the origin of an avoided crossing ([@problem_id:2873401]).", "problem": "In a minimal avoided-crossing model for a diatomic molecule, the electronic Hamiltonian in the diabatic representation depends on a single nuclear coordinate $R$ and is given by\n$$\nH(R)=\\begin{pmatrix}\n\\alpha R & V_{12}\\\\\nV_{12} & -\\alpha R\n\\end{pmatrix},\n$$\nwhere $\\alpha>0$ and $V_{12}>0$ are real constants. In the Born–Oppenheimer (BO) separation, the adiabatic potential energy surfaces are obtained as the eigenvalues of the electronic Hamiltonian at fixed $R$. The adiabatic representation is related to the diabatic representation by a real orthogonal transformation $U(\\theta)$ that diagonalizes $H(R)$ at each $R$. Starting from the time-independent electronic Schrödinger equation and the definition of an adiabatic basis as the eigenbasis of $H(R)$, derive the adiabatic energies $E_{\\pm}(R)$ and determine an explicit, continuous adiabatic mixing angle $\\theta(R)$, defined by $U(\\theta)^{\\top}H(R)U(\\theta)$ being diagonal, with the convention $0\\le \\theta(R)\\le \\pi/2$ and asymptotic behavior $\\theta(R)\\to 0$ as $R\\to +\\infty$ and $\\theta(R)\\to \\pi/2$ as $R\\to -\\infty$. Express all intermediate steps symbolically in terms of $\\alpha$, $R$, and $V_{12}$.\n\nReport, as your final answer, the analytic expression for the adiabatic energy gap $\\Delta E(R)=E_{+}(R)-E_{-}(R)$. The final answer must be a single closed-form expression. No numerical evaluation or rounding is required.", "solution": "The problem statement presented is valid. It is a standard, well-posed problem in quantum chemistry concerning the diagonalization of a two-level electronic Hamiltonian, a cornerstone of understanding avoided crossings and non-adiabatic transitions. The problem is self-contained, scientifically grounded in the Born-Oppenheimer approximation, and all parameters and conditions are clearly defined. We shall proceed with the derivation.\n\nThe adiabatic potential energy surfaces, denoted by $E_{\\pm}(R)$, are the eigenvalues of the electronic Hamiltonian matrix $H(R)$. To find these eigenvalues, we must solve the characteristic equation $\\det(H(R) - E \\cdot I) = 0$, where $I$ is the $2 \\times 2$ identity matrix and $E$ represents the eigenvalues.\n\nThe characteristic equation is:\n$$\n\\det \\begin{pmatrix}\n\\alpha R - E & V_{12} \\\\\nV_{12} & -\\alpha R - E\n\\end{pmatrix} = 0\n$$\nExpanding the determinant gives:\n$$\n(\\alpha R - E)(-\\alpha R - E) - V_{12}^{2} = 0\n$$\n$$\n-(\\alpha R)^{2} - \\alpha R E + \\alpha R E + E^{2} - V_{12}^{2} = 0\n$$\n$$\nE^{2} - (\\alpha R)^{2} - V_{12}^{2} = 0\n$$\nSolving for $E^{2}$:\n$$\nE^{2} = (\\alpha R)^{2} + V_{12}^{2}\n$$\nThe two eigenvalues, which are the adiabatic energies, are therefore:\n$$\nE_{\\pm}(R) = \\pm \\sqrt{(\\alpha R)^{2} + V_{12}^{2}}\n$$\nBy convention, $E_{+}(R)$ is the upper potential energy surface and $E_{-}(R)$ is the lower one.\n\nNext, we must determine the adiabatic mixing angle $\\theta(R)$. The adiabatic basis is related to the diabatic basis by a real orthogonal transformation $U(\\theta)$, which for a $2 \\times 2$ system is a rotation matrix:\n$$\nU(\\theta) = \\begin{pmatrix}\n\\cos\\theta & -\\sin\\theta \\\\\n\\sin\\theta & \\cos\\theta\n\\end{pmatrix}\n$$\nThis transformation diagonalizes the Hamiltonian:\n$$\nU(\\theta)^{\\top}H(R)U(\\theta) = \\begin{pmatrix}\nE_{\\text{diag},1} & 0 \\\\\n0 & E_{\\text{diag},2}\n\\end{pmatrix}\n$$\nThe off-diagonal elements of the transformed matrix must be zero. Let us compute the $(1,2)$ element of $U(\\theta)^{\\top}H(R)U(\\theta)$:\n$$\n(U^{\\top}HU)_{12} = \\begin{pmatrix} \\cos\\theta & \\sin\\theta \\end{pmatrix} \\begin{pmatrix} \\alpha R & V_{12} \\\\ V_{12} & -\\alpha R \\end{pmatrix} \\begin{pmatrix} -\\sin\\theta \\\\ \\cos\\theta \\end{pmatrix}\n$$\n$$\n(U^{\\top}HU)_{12} = (\\alpha R \\cos\\theta + V_{12} \\sin\\theta)(-\\sin\\theta) + (V_{12} \\cos\\theta - \\alpha R \\sin\\theta)(\\cos\\theta)\n$$\n$$\n(U^{\\top}HU)_{12} = -\\alpha R \\sin\\theta \\cos\\theta - V_{12} \\sin^{2}\\theta + V_{12} \\cos^{2}\\theta - \\alpha R \\sin\\theta \\cos\\theta\n$$\n$$\n(U^{\\top}HU)_{12} = V_{12}(\\cos^{2}\\theta - \\sin^{2}\\theta) - 2\\alpha R \\sin\\theta \\cos\\theta\n$$\nUsing the double-angle trigonometric identities $\\cos(2\\theta) = \\cos^{2}\\theta - \\sin^{2}\\theta$ and $\\sin(2\\theta) = 2\\sin\\theta\\cos\\theta$, we get:\n$$\n(U^{\\top}HU)_{12} = V_{12}\\cos(2\\theta) - \\alpha R \\sin(2\\theta)\n$$\nSetting this element to zero gives the condition for diagonalization:\n$$\nV_{12}\\cos(2\\theta) = \\alpha R \\sin(2\\theta)\n$$\nFor $\\alpha R \\neq 0$ and $\\cos(2\\theta) \\neq 0$, we can write:\n$$\n\\tan(2\\theta) = \\frac{V_{12}}{\\alpha R}\n$$\nTo find an explicit, continuous function $\\theta(R)$ that satisfies the given boundary conditions, $0 \\le \\theta(R) \\le \\pi/2$, $\\theta(R \\to +\\infty) \\to 0$, and $\\theta(R \\to -\\infty) \\to \\pi/2$, we must carefully choose the branch of the inverse tangent function. The standard $\\arctan$ function has a range of $(-\\pi/2, \\pi/2)$, which would lead to $\\theta \\in (-\\pi/4, \\pi/4)$ and fail to satisfy the conditions. A correct approach is to use the `arccot` function, which has a standard range of $(0, \\pi)$. Let us define $2\\theta(R)$ as:\n$$\n2\\theta(R) = \\text{arccot}\\left(\\frac{\\alpha R}{V_{12}}\\right)\n$$\nThis gives the mixing angle:\n$$\n\\theta(R) = \\frac{1}{2} \\text{arccot}\\left(\\frac{\\alpha R}{V_{12}}\\right)\n$$\nLet us verify this solution against the problem's constraints.\nSince $\\text{arccot}(x)$ maps $\\mathbb{R}$ to $(0, \\pi)$, our expression for $\\theta(R)$ maps $\\mathbb{R}$ to $(0, \\pi/2)$, satisfying $0 \\le \\theta(R) \\le \\pi/2$.\nLet's check the asymptotic behavior:\nAs $R \\to +\\infty$, the argument $\\frac{\\alpha R}{V_{12}} \\to +\\infty$. Then $\\text{arccot}(+\\infty) \\to 0$. Thus, $\\theta(R) \\to 0$. This is correct.\nAs $R \\to -\\infty$, the argument $\\frac{\\alpha R}{V_{12}} \\to -\\infty$. Then $\\text{arccot}(-\\infty) \\to \\pi$. Thus, $\\theta(R) \\to \\pi/2$. This is also correct.\nThe function is continuous for all $R$. At $R=0$, $\\theta(0) = \\frac{1}{2}\\text{arccot}(0) = \\frac{1}{2}(\\pi/2) = \\pi/4$.\nThis expression for $\\theta(R)$ is the unique continuous function satisfying all given constraints.\n\nFinally, the problem requires the adiabatic energy gap, $\\Delta E(R)$, defined as the difference between the upper and lower adiabatic energies:\n$$\n\\Delta E(R) = E_{+}(R) - E_{-}(R)\n$$\nSubstituting the derived expressions for $E_{\\pm}(R)$:\n$$\n\\Delta E(R) = \\left(\\sqrt{(\\alpha R)^{2} + V_{12}^{2}}\\right) - \\left(-\\sqrt{(\\alpha R)^{2} + V_{12}^{2}}\\right)\n$$\n$$\n\\Delta E(R) = 2\\sqrt{(\\alpha R)^{2} + V_{12}^{2}}\n$$\nThis is the final analytical expression for the energy gap. At $R=0$, the gap has its minimum value, $\\Delta E(0) = 2V_{12}$, which represents the magnitude of the avoided crossing.", "answer": "$$\\boxed{2\\sqrt{(\\alpha R)^{2} + V_{12}^{2}}}$$", "id": "2873401"}, {"introduction": "While the adiabatic representation simplifies the potential energy by diagonalizing the electronic Hamiltonian, it introduces off-diagonal terms in the nuclear kinetic energy operator, known as non-adiabatic couplings (NACs). These terms are responsible for driving transitions between adiabatic states and are thus at the heart of non-adiabatic dynamics. This practice guides you through the crucial derivation of the NAC element, expressing it in terms of the more intuitive diabatic Hamiltonian elements, revealing the direct mathematical link between the two pictures ([@problem_id:1351773]).", "problem": "In the study of molecular photochemistry and reaction dynamics, the distinction between adiabatic and diabatic electronic states is crucial for understanding processes that occur at avoided crossings or conical intersections of potential energy surfaces.\n\nConsider a simple two-state quantum system, described by a real and symmetric diabatic Hamiltonian matrix $H^d(R)$ that depends on a single nuclear coordinate $R$. The diabatic basis states, $|\\phi_1\\rangle$ and $|\\phi_2\\rangle$, are assumed to be independent of $R$. The diabatic Hamiltonian is given by:\n$$\nH^d(R) = \\begin{pmatrix} H^d_{11}(R) & H^d_{12}(R) \\\\ H^d_{21}(R) & H^d_{22}(R) \\end{pmatrix}\n$$\nwhere $H^d_{12}(R) = H^d_{21}(R)$.\n\nThe corresponding adiabatic states, $|\\Psi_1(R)\\rangle$ and $|\\Psi_2(R)\\rangle$, are the eigenstates of this Hamiltonian for each value of $R$. They satisfy the time-independent Schrödinger equation:\n$$\nH^d(R) |\\Psi_k(R)\\rangle = E_k(R) |\\Psi_k(R)\\rangle\n$$\nfor $k=1,2$. The adiabatic potential energy surfaces are the eigenvalues $E_1(R)$ and $E_2(R)$, which are conventionally ordered such that $E_1(R) \\le E_2(R)$.\n\nTransitions between these adiabatic states are governed by the non-adiabatic coupling (NAC) elements. The off-diagonal NAC element is defined as:\n$$\nf_{12}(R) = \\left\\langle \\Psi_1(R) \\middle| \\frac{\\partial}{\\partial R} \\middle| \\Psi_2(R) \\right\\rangle\n$$\n\nYour task is to derive a general, closed-form analytic expression for the non-adiabatic coupling element $f_{12}(R)$ solely in terms of the elements of the diabatic Hamiltonian matrix $H^d_{ij}(R)$ and their first derivatives with respect to $R$, denoted as $\\frac{d H^d_{ij}}{dR}$.", "solution": "Because the diabatic basis states are independent of $R$, all non-adiabatic couplings arise from the $R$-dependence of the adiabatic eigenvectors of the (real, symmetric) diabatic Hamiltonian $H^{d}(R)$. Let the adiabatic eigenstates satisfy\n$$\nH^{d}(R)\\,|\\Psi_{k}(R)\\rangle=E_{k}(R)\\,|\\Psi_{k}(R)\\rangle,\\quad k=1,2,\\quad E_{1}(R)\\leq E_{2}(R).\n$$\nDifferentiate the $k=2$ eigenvalue equation with respect to $R$ and project onto $\\langle\\Psi_{1}|$:\n$$\n\\langle\\Psi_{1}|\\frac{dH^{d}}{dR}|\\Psi_{2}\\rangle+\\langle\\Psi_{1}|H^{d}\\frac{\\partial}{\\partial R}|\\Psi_{2}\\rangle=\\frac{dE_{2}}{dR}\\langle\\Psi_{1}|\\Psi_{2}\\rangle+E_{2}\\langle\\Psi_{1}|\\frac{\\partial}{\\partial R}|\\Psi_{2}\\rangle.\n$$\nUsing orthonormality $\\langle\\Psi_{1}|\\Psi_{2}\\rangle=0$ and the left-eigenvalue relation $\\langle\\Psi_{1}|H^{d}=E_{1}\\langle\\Psi_{1}|$, this reduces to the Hellmann–Feynman-like identity\n$$\n\\langle\\Psi_{1}|\\frac{dH^{d}}{dR}|\\Psi_{2}\\rangle=(E_{2}-E_{1})\\,\\left\\langle\\Psi_{1}\\middle|\\frac{\\partial}{\\partial R}\\middle|\\Psi_{2}\\right\\rangle=(E_{2}-E_{1})\\,f_{12}(R).\n$$\nHence,\n$$\nf_{12}(R)=\\frac{\\langle\\Psi_{1}|\\frac{dH^{d}}{dR}|\\Psi_{2}\\rangle}{E_{2}-E_{1}}.\n$$\n\nNow write the real-symmetric diabatic Hamiltonian in the diabatic basis $\\{|\\phi_{1}\\rangle,|\\phi_{2}\\rangle\\}$ as\n$$\nH^{d}(R)=\\begin{pmatrix}H^{d}_{11}(R)&H^{d}_{12}(R)\\\\ H^{d}_{12}(R)&H^{d}_{22}(R)\\end{pmatrix},\n$$\nand define the convenient combinations\n$$\n\\Delta(R)\\equiv H^{d}_{11}(R)-H^{d}_{22}(R),\\qquad V(R)\\equiv H^{d}_{12}(R).\n$$\nThe adiabatic eigenvectors are related to the diabatic basis by an orthogonal rotation characterized by a mixing angle $\\theta(R)$. Choosing the conventional (real) parametrization\n$$\n|\\Psi_{1}\\rangle=\\cos\\theta\\,|\\phi_{1}\\rangle-\\sin\\theta\\,|\\phi_{2}\\rangle,\\qquad\n|\\Psi_{2}\\rangle=\\sin\\theta\\,|\\phi_{1}\\rangle+\\cos\\theta\\,|\\phi_{2}\\rangle,\n$$\nthe diagonalization condition implies\n$$\n\\tan\\bigl(2\\theta\\bigr)=-\\frac{2V}{\\Delta},\\qquad E_{2}-E_{1}=D,\\qquad D\\equiv\\sqrt{\\Delta^{2}+4V^{2}},\n$$\nand therefore\n$$\n\\sin\\bigl(2\\theta\\bigr)=-\\frac{2V}{D},\\qquad \\cos\\bigl(2\\theta\\bigr)=\\frac{\\Delta}{D}.\n$$\nLet $A\\equiv \\frac{dH^{d}}{dR}$ so that, in the diabatic basis, $A$ has matrix elements $A_{11}=\\frac{dH^{d}_{11}}{dR}$, $A_{22}=\\frac{dH^{d}_{22}}{dR}$, and $A_{12}=A_{21}=\\frac{dH^{d}_{12}}{dR}=\\frac{dV}{dR}$. Using the above eigenvector parametrization and the fact that the diabatic basis is $R$-independent, one finds by direct matrix multiplication\n$$\n\\langle\\Psi_{1}|A|\\Psi_{2}\\rangle=\\sin\\theta\\cos\\theta\\left(A_{11}-A_{22}\\right)+\\left(\\cos^{2}\\theta-\\sin^{2}\\theta\\right)A_{12}\n=\\frac{1}{2}\\frac{d\\Delta}{dR}\\,\\sin(2\\theta)+\\frac{dV}{dR}\\,\\cos(2\\theta).\n$$\nSubstituting the trigonometric relations and $E_{2}-E_{1}=D$ into $f_{12}=\\langle\\Psi_{1}|A|\\Psi_{2}\\rangle/(E_{2}-E_{1})$ gives\n$$\nf_{12}(R)=\\frac{\\frac{1}{2}\\frac{d\\Delta}{dR}\\left(-\\frac{2V}{D}\\right)+\\frac{dV}{dR}\\left(\\frac{\\Delta}{D}\\right)}{D}\n=\\frac{\\Delta\\,\\frac{dV}{dR}-V\\,\\frac{d\\Delta}{dR}}{\\Delta^{2}+4V^{2}}.\n$$\nRe-expressing $\\Delta$ and $V$ in terms of the diabatic matrix elements yields the desired closed-form expression solely in terms of $H^{d}_{ij}(R)$ and their first derivatives:\n$$\nf_{12}(R)=\\frac{\\left(H^{d}_{11}-H^{d}_{22}\\right)\\frac{d H^{d}_{12}}{dR}-H^{d}_{12}\\left(\\frac{d H^{d}_{11}}{dR}-\\frac{d H^{d}_{22}}{dR}\\right)}{\\left(H^{d}_{11}-H^{d}_{22}\\right)^{2}+4\\left(H^{d}_{12}\\right)^{2}}.\n$$\nAll quantities are evaluated at the same $R$.", "answer": "$$\\boxed{\\frac{\\left(H^{d}_{11}-H^{d}_{22}\\right)\\,\\frac{d H^{d}_{12}}{dR}-H^{d}_{12}\\left(\\frac{d H^{d}_{11}}{dR}-\\frac{d H^{d}_{22}}{dR}\\right)}{\\left(H^{d}_{11}-H^{d}_{22}\\right)^{2}+4\\left(H^{d}_{12}\\right)^{2}}}$$", "id": "1351773"}, {"introduction": "Moving from analytical theory to computational practice, this final exercise challenges you to implement a widely used diabatization scheme: Boys localization. In real-world calculations, strictly diabatic bases are not directly accessible; instead, we construct them approximately based on physical principles. This coding problem requires you to build a complete workflow—from a model Hamiltonian to the final diabatic coupling—by using the electronic dipole moment to define a localized, and therefore diabatic-like, set of states, bridging the gap between theoretical concepts and their practical application in computational chemistry ([@problem_id:2760838]).", "problem": "Consider a two-state charge-transfer system within the Born–Oppenheimer framework, where the electronic Hamiltonian depends parametrically on a one-dimensional nuclear coordinate $R$ (e.g., an interfragment separation). The adiabatic representation consists of electronic eigenstates $\\lvert \\Phi_i(R) \\rangle$ of the electronic Hamiltonian $\\hat{H}_{\\mathrm{el}}(R)$, and the diabatic representation is related to the adiabatic one by a unitary transformation. For a two-state, real-valued subspace, this transformation reduces to an orthogonal rotation by an angle $\\varphi(R)$:\n$$\n\\mathbf{R}(\\varphi) \\;=\\;\n\\begin{pmatrix}\n\\cos\\varphi & \\sin\\varphi \\\\\n-\\sin\\varphi & \\cos\\varphi\n\\end{pmatrix},\n$$\napplied to any matrix representation $\\mathbf{A}$ in that subspace as $\\mathbf{A}'=\\mathbf{R}(\\varphi)^{\\mathsf{T}} \\mathbf{A}\\,\\mathbf{R}(\\varphi)$.\n\nIn the Boys diabatization, the rotation angle $\\varphi(R)$ is chosen to minimize the sum of squares of the off-diagonal elements of the electronic dipole operator components in the rotated basis. Let $\\boldsymbol{\\mu}^{(A)}$ denote the matrix of the $A$-th Cartesian component ($A \\in \\{x,y,z\\}$) of the electronic dipole operator in the current basis. The Boys functional is\n$$\nF(\\varphi) \\;=\\; \\sum_{A\\in\\{x,y,z\\}} \\left[ \\mu^{(A)}_{12}(\\varphi) \\right]^2,\\quad\n\\text{where}\\quad \\mu^{(A)}_{12}(\\varphi) \\;=\\; \\left[ \\mathbf{R}(\\varphi)^{\\mathsf{T}} \\,\\boldsymbol{\\mu}^{(A)}\\, \\mathbf{R}(\\varphi) \\right]_{12}.\n$$\nFor a $2\\times 2$ real symmetric matrix $\\boldsymbol{\\mu}^{(A)}$ with elements $\\mu^{(A)}_{11}$, $\\mu^{(A)}_{22}$, and $\\mu^{(A)}_{12}=\\mu^{(A)}_{21}$ in the adiabatic basis, one can show that\n$$\n\\mu^{(A)}_{12}(\\varphi) \\;=\\; \\alpha_A \\,\\sin(2\\varphi) \\;+\\; \\beta_A \\,\\cos(2\\varphi),\n$$\nwith\n$$\n\\alpha_A \\;=\\; \\frac{\\mu^{(A)}_{11} - \\mu^{(A)}_{22}}{2},\\qquad \\beta_A \\;=\\; \\mu^{(A)}_{12}.\n$$\n\nYour task is to write a program that, given a model for adiabatic states derived from an underlying diabatic Hamiltonian and diabatic dipoles, constructs the adiabatic dipole matrices, performs Boys diabatization to obtain the rotation angle $\\varphi(R)$ that minimizes $F(\\varphi)$, and evaluates the resulting diabatic coupling (the off-diagonal element of the electronic Hamiltonian in the Boys diabatic basis) as a function of geometry $R$.\n\nUse the following physically motivated and self-consistent model:\n\n- Diabatic Hamiltonian in the diabatic basis $\\{\\lvert D\\rangle,\\lvert A\\rangle\\}$:\n$$\n\\mathbf{H}_{\\mathrm{d}}(R) \\;=\\;\n\\begin{pmatrix}\nE_D(R) & V(R) \\\\\nV(R) & E_A(R)\n\\end{pmatrix},\n$$\nwith\n$$\nE_D(R) \\;=\\; s\\,(R-R_0), \\qquad E_A(R) \\;=\\; -s\\,(R-R_0),\n$$\n$$\nV(R) \\;=\\; V_0\\,\\exp\\!\\big(-\\alpha\\,[\\,R-R_0\\,]\\big).\n$$\n\n- Diabatic electronic dipole matrices (in units of elementary charge times Angstrom, denoted $\\mathrm{e}\\,\\AA$):\n$$\n\\boldsymbol{\\mu}^{(x)}_{\\mathrm{d}}(R) \\;=\\;\n\\begin{pmatrix}\n-\\dfrac{Q\\,R}{2} & 0 \\\\\n0 & +\\dfrac{Q\\,R}{2}\n\\end{pmatrix},\\qquad\n\\boldsymbol{\\mu}^{(y)}_{\\mathrm{d}}(R) \\;=\\;\n\\begin{pmatrix}\n0 & \\mu_{\\mathrm{tr}}\\,\\exp(-\\beta R) \\\\\n\\mu_{\\mathrm{tr}}\\,\\exp(-\\beta R) & 0\n\\end{pmatrix},\\qquad\n\\boldsymbol{\\mu}^{(z)}_{\\mathrm{d}}(R) \\;=\\;\n\\begin{pmatrix}\n0 & 0 \\\\\n0 & 0\n\\end{pmatrix}.\n$$\n\n- The adiabatic representation is obtained by diagonalizing $\\mathbf{H}_{\\mathrm{d}}(R)$ with a rotation $\\mathbf{R}(\\theta(R))$ such that\n$$\n\\mathbf{R}(\\theta)^{\\mathsf{T}}\\, \\mathbf{H}_{\\mathrm{d}}(R)\\, \\mathbf{R}(\\theta) \\;=\\; \\mathrm{diag}\\!\\left(E_1(R), E_2(R)\\right),\n$$\nwith\n$$\n\\theta(R) \\;=\\; \\tfrac{1}{2}\\,\\mathrm{atan2}\\!\\left(2\\,V(R),\\,E_D(R)-E_A(R)\\right),\n$$\nand the adiabatic dipole matrices are\n$$\n\\boldsymbol{\\mu}^{(A)}_{\\mathrm{a}}(R) \\;=\\; \\mathbf{R}(\\theta(R))^{\\mathsf{T}}\\, \\boldsymbol{\\mu}^{(A)}_{\\mathrm{d}}(R)\\, \\mathbf{R}(\\theta(R)).\n$$\n\n- The Boys diabatic states are obtained by rotating the adiabatic basis with $\\mathbf{R}(\\varphi(R))$ that minimizes $F(\\varphi)$ as defined above. Denote the resulting Hamiltonian in the Boys diabatic basis as\n$$\n\\mathbf{H}_{\\mathrm{B}}(R) \\;=\\; \\mathbf{R}(\\varphi(R))^{\\mathsf{T}}\\, \\mathrm{diag}\\!\\left(E_1(R), E_2(R)\\right)\\, \\mathbf{R}(\\varphi(R)).\n$$\nThe diabatic coupling to be reported is the magnitude of the off-diagonal element,\n$$\n\\lvert V_{\\mathrm{B}}(R)\\rvert \\;=\\; \\left\\lvert \\left[ \\mathbf{H}_{\\mathrm{B}}(R) \\right]_{12} \\right\\rvert,\n$$\nexpressed in electron volts ($\\mathrm{eV}$).\n\nImplementation requirements:\n\n- Derive from first principles that, for two states, minimizing $F(\\varphi)$ leads to an angle that satisfies\n$$\n\\tan\\!\\left(4\\varphi\\right) \\;=\\; \\frac{-\\,2\\,\\sum_A \\alpha_A\\,\\beta_A}{\\sum_A \\left(\\alpha_A^2 - \\beta_A^2\\right)},\n$$\nwith $\\alpha_A$ and $\\beta_A$ computed from the adiabatic dipole matrices as above, and select the branch of $\\varphi$ that minimizes $F(\\varphi)$ over a period (you may verify by direct evaluation of $F$ at candidate extrema).\n\n- Angles must be treated in radians.\n\n- Use the following fixed parameters:\n$$\ns \\;=\\; 1.0\\ \\mathrm{eV}/\\AA,\\quad R_0 \\;=\\; 3.0\\ \\AA,\\quad V_0 \\;=\\; 0.2\\ \\mathrm{eV},\\quad \\alpha \\;=\\; 1.0\\ \\AA^{-1},\\\\\nQ \\;=\\; 1.0\\ \\mathrm{e},\\quad \\beta \\;=\\; 0.5\\ \\AA^{-1}.\n$$\n\nTest suite:\n\nProvide results for the following $4$ test cases, each specified by $(R,\\ \\mu_{\\mathrm{tr}})$ where $R$ is in Angstrom and $\\mu_{\\mathrm{tr}}$ is in $\\mathrm{e}\\,\\AA$:\n\n- Case $1$: $(R,\\ \\mu_{\\mathrm{tr}}) = (2.0,\\ 0.05)$.\n- Case $2$: $(R,\\ \\mu_{\\mathrm{tr}}) = (3.0,\\ 0.05)$.\n- Case $3$: $(R,\\ \\mu_{\\mathrm{tr}}) = (5.0,\\ 0.05)$.\n- Case $4$: $(R,\\ \\mu_{\\mathrm{tr}}) = (3.0,\\ 0.0)$.\n\nYour program must compute $\\lvert V_{\\mathrm{B}}(R)\\rvert$ in $\\mathrm{eV}$ for each case and produce a single line of output containing the $4$ results as a comma-separated list enclosed in square brackets, in the same order as the cases above, with each value rounded to exactly $6$ decimal places. For example, an acceptable output format is\n$$\n\\left[ v_1,\\ v_2,\\ v_3,\\ v_4 \\right],\n$$\nwhere each $v_i$ is a floating-point number rounded to $6$ decimal places representing $\\lvert V_{\\mathrm{B}}(R)\\rvert$ in $\\mathrm{eV}$ for the corresponding test case.", "solution": "The problem statement has been rigorously validated and is determined to be sound. It is scientifically grounded in the principles of theoretical chemistry, specifically concerning non-adiabatic coupling and diabatization methods. The problem is well-posed, with all necessary parameters, models, and mathematical definitions provided. The language is objective and unambiguous. The model, while simplified, is physically consistent and represents a standard paradigm for avoided crossings in molecular systems. Therefore, a complete solution will be provided.\n\nThe task is to compute the diabatic coupling in the Boys diabatic representation for a model two-state system. The procedure involves several transformations between different electronic state representations: from an initial diabatic basis to an adiabatic basis, and subsequently to the Boys diabatic basis.\n\nFirst, we verify the required minimization condition for the Boys angle $\\varphi$. The Boys functional to be minimized is given by:\n$$\nF(\\varphi) = \\sum_{A\\in\\{x,y,z\\}} \\left[ \\mu^{(A)}_{12}(\\varphi) \\right]^2\n$$\nwhere $\\mu^{(A)}_{12}(\\varphi)$ is the off-diagonal element of the $A$-th dipole component matrix in the basis rotated by an angle $\\varphi$ from the adiabatic basis. For a general real symmetric $2 \\times 2$ matrix $\\mathbf{M}$ with elements $M_{11}, M_{22}, M_{12}$, the off-diagonal element after rotation by $\\mathbf{R}(\\varphi)$ is:\n$$\nM_{12}(\\varphi) = \\left[ \\mathbf{R}(\\varphi)^{\\mathsf{T}} \\mathbf{M} \\mathbf{R}(\\varphi) \\right]_{12} = \\frac{M_{11} - M_{22}}{2} \\sin(2\\varphi) + M_{12} \\cos(2\\varphi)\n$$\nThe problem defines coefficients $\\alpha_A = \\frac{\\mu^{(A)}_{a,11} - \\mu^{(A)}_{a,22}}{2}$ and $\\beta_A = \\mu^{(A)}_{a,12}$, based on the dipole matrices in the adiabatic basis, $\\boldsymbol{\\mu}^{(A)}_{\\mathrm{a}}$. Thus, $\\mu^{(A)}_{12}(\\varphi) = \\alpha_A \\sin(2\\varphi) + \\beta_A \\cos(2\\varphi)$.\n\nThe functional becomes:\n$$\nF(\\varphi) = \\sum_{A} \\left( \\alpha_A \\sin(2\\varphi) + \\beta_A \\cos(2\\varphi) \\right)^2 = \\sum_{A} \\left( \\alpha_A^2 \\sin^2(2\\varphi) + \\beta_A^2 \\cos^2(2\\varphi) + 2\\alpha_A\\beta_A \\sin(2\\varphi)\\cos(2\\varphi) \\right)\n$$\nUsing trigonometric identities $\\sin^2(x) = (1-\\cos(2x))/2$, $\\cos^2(x) = (1+\\cos(2x))/2$, and $\\sin(x)\\cos(x) = \\sin(2x)/2$, we rewrite $F(\\varphi)$ as a function of $4\\varphi$:\n$$\nF(\\varphi) = \\frac{1}{2} \\sum_A (\\alpha_A^2 + \\beta_A^2) + \\frac{1}{2}\\cos(4\\varphi) \\sum_A (\\beta_A^2 - \\alpha_A^2) + \\sin(4\\varphi) \\sum_A (\\alpha_A \\beta_A)\n$$\nTo find the minimum, we set the derivative with respect to $\\varphi$ to zero:\n$$\n\\frac{dF}{d\\varphi} = -2\\sin(4\\varphi) \\sum_A (\\beta_A^2 - \\alpha_A^2) + 4\\cos(4\\varphi) \\sum_A (\\alpha_A \\beta_A) = 0\n$$\n$$\n2\\sin(4\\varphi) \\sum_A (\\alpha_A^2 - \\beta_A^2) = -4\\cos(4\\varphi) \\sum_A (\\alpha_A \\beta_A)\n$$\nThis gives the required condition for the extrema:\n$$\n\\tan(4\\varphi) = \\frac{-2 \\sum_A \\alpha_A \\beta_A}{\\sum_A (\\alpha_A^2 - \\beta_A^2)}\n$$\nThe second derivative test confirms that the angle $\\varphi$ obtained from the principal value of $\\mathrm{atan2}$ corresponds to a minimum. Specifically, $\\varphi = \\frac{1}{4} \\mathrm{atan2}(Y, X)$ where $Y = -2\\sum_A \\alpha_A \\beta_A$ and $X = \\sum_A (\\alpha_A^2 - \\beta_A^2)$.\n\nThe computational procedure for each test case $(R, \\mu_{\\mathrm{tr}})$ is as follows:\n\n1.  **Define model parameters**:\n    $s = 1.0\\ \\mathrm{eV}/\\AA, R_0 = 3.0\\ \\AA, V_0 = 0.2\\ \\mathrm{eV}, \\alpha = 1.0\\ \\AA^{-1}, Q = 1.0\\ \\mathrm{e}, \\beta = 0.5\\ \\AA^{-1}$.\n\n2.  **Construct the diabatic Hamiltonian $\\mathbf{H}_{\\mathrm{d}}(R)$**:\n    The elements are $E_D(R) = s(R-R_0)$, $E_A(R) = -s(R-R_0)$, and $V(R) = V_0 \\exp(-\\alpha(R-R_0))$.\n\n3.  **Determine the adiabatic representation**:\n    Diagonalize $\\mathbf{H}_{\\mathrm{d}}(R)$. The mixing angle $\\theta(R)$ that transforms from the diabatic to the adiabatic basis is:\n    $$\n    \\theta(R) = \\frac{1}{2} \\mathrm{atan2}(2V(R), E_D(R) - E_A(R))\n    $$\n    The eigenvalues are the adiabatic energies $E_1(R)$ and $E_2(R)$. We order them such that $E_1 > E_2$.\n    $$\n    E_{1,2}(R) = \\frac{E_D+E_A}{2} \\pm \\sqrt{\\left(\\frac{E_D-E_A}{2}\\right)^2 + V(R)^2} = \\pm \\sqrt{s^2(R-R_0)^2 + V(R)^2}\n    $$\n    So, $E_1(R) = \\sqrt{s^2(R-R_0)^2 + V(R)^2}$ and $E_2(R) = -E_1(R)$. The adiabatic Hamiltonian is $\\mathbf{H}_{\\mathrm{a}} = \\mathrm{diag}(E_1, E_2)$.\n\n4.  **Construct the diabatic dipole matrices $\\boldsymbol{\\mu}^{(A)}_{\\mathrm{d}}(R)$**:\n    These are given by the problem statement. Note that $\\boldsymbol{\\mu}^{(z)}_{\\mathrm{d}}$ is the zero matrix.\n\n5.  **Transform dipole matrices to the adiabatic basis**:\n    The adiabatic dipole matrices are computed via the transformation:\n    $$\n    \\boldsymbol{\\mu}^{(A)}_{\\mathrm{a}}(R) = \\mathbf{R}(\\theta(R))^{\\mathsf{T}} \\boldsymbol{\\mu}^{(A)}_{\\mathrm{d}}(R) \\mathbf{R}(\\theta(R))\n    $$\n    where $\\mathbf{R}(\\theta)$ is the rotation matrix.\n\n6.  **Calculate $\\alpha_A$ and $\\beta_A$ coefficients**:\n    Using the elements of the computed adiabatic dipole matrices $\\boldsymbol{\\mu}^{(A)}_{\\mathrm{a}}$:\n    $$\n    \\alpha_A = \\frac{\\mu^{(A)}_{a,11} - \\mu^{(A)}_{a,22}}{2}, \\quad \\beta_A = \\mu^{(A)}_{a,12}\n    $$\n    for $A \\in \\{x, y\\}$. For $A=z$, the coefficients are zero.\n\n7.  **Determine the Boys diabatization angle $\\varphi(R)$**:\n    Calculate the sums $Y = -2\\sum_A \\alpha_A \\beta_A$ and $X = \\sum_A (\\alpha_A^2 - \\beta_A^2)$. The angle that minimizes the Boys functional is:\n    $$\n    \\varphi(R) = \\frac{1}{4} \\mathrm{atan2}(Y, X)\n    $$\n\n8.  **Calculate the Boys diabatic coupling $\\lvert V_{\\mathrm{B}}(R)\\rvert$**:\n    The Hamiltonian in the Boys diabatic basis is obtained by rotating the adiabatic Hamiltonian, $\\mathbf{H}_{\\mathrm{B}}(R) = \\mathbf{R}(\\varphi)^{\\mathsf{T}} \\mathbf{H}_{\\mathrm{a}}(R) \\mathbf{R}(\\varphi)$. The off-diagonal element of $\\mathbf{H}_{\\mathrm{B}}$ is the coupling $V_{\\mathrm{B}}(R)$:\n    $$\n    V_{\\mathrm{B}}(R) = [\\mathbf{H}_{\\mathrm{B}}]_{12} = \\frac{E_1(R) - E_2(R)}{2} \\sin(2\\varphi(R))\n    $$\n    The desired result is its magnitude, $\\lvert V_{\\mathrm{B}}(R) \\rvert$.\n    Substituting for $E_1-E_2$:\n    $$\n    \\lvert V_{\\mathrm{B}}(R) \\rvert = \\left\\lvert \\sqrt{s^2(R-R_0)^2 + V(R)^2} \\sin(2\\varphi(R)) \\right\\rvert\n    $$\nThis procedure is implemented for each of the given test cases. The angle $\\theta+\\varphi$ represents the total rotation from the initial diabatic basis to the final Boys basis. When $R$ is far from $R_0$, $\\theta \\approx 0$, and we expect $\\varphi \\approx 0$, thus the Boys coupling $V_{\\mathrm{B}}$ should approach the original diabatic coupling $V(R)$. At $R=R_0$ with $\\mu_{\\mathrm{tr}}=0$, the initial diabatic basis is a charge-localized basis, which Boys diabatization seeks. In this case, the total rotation angle $\\theta+\\varphi$ should correspond to a simple permutation of basis states ($k\\pi/2$), and the calculated coupling $\\lvert V_B \\rvert$ must equal the initial coupling $V(R_0)$. The numerical calculations confirm this physical reasoning.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the theoretical chemistry problem for calculating Boys diabatic coupling.\n    \"\"\"\n\n    # Fixed parameters from the problem statement\n    s = 1.0       # eV/A\n    R0 = 3.0      # A\n    V0 = 0.2      # eV\n    alpha = 1.0   # 1/A\n    Q = 1.0       # e\n    beta = 0.5    # 1/A\n\n    # Test cases: (R in Angstrom, mu_tr in e*A)\n    test_cases = [\n        (2.0, 0.05),\n        (3.0, 0.05),\n        (5.0, 0.05),\n        (3.0, 0.0),\n    ]\n\n    results = []\n    \n    for R, mu_tr in test_cases:\n        # Step 1: Calculate diabatic Hamiltonian elements\n        E_D = s * (R - R0)\n        E_A = -s * (R - R0)\n        V_R = V0 * np.exp(-alpha * (R - R0))\n        \n        # H_d = np.array([[E_D, V_R], [V_R, E_A]])\n\n        # Step 2: Determine adiabatic representation\n        # Adiabatic mixing angle theta\n        theta = 0.5 * np.arctan2(2 * V_R, E_D - E_A)\n        \n        # Adiabatic energies E1 > E2\n        E1 = np.sqrt((s * (R - R0))**2 + V_R**2)\n        E2 = -E1\n\n        # Step 3: Construct diabatic dipole matrices (only non-zero components)\n        mu_d_x = np.array([[-Q * R / 2, 0], [0, Q * R / 2]])\n        mu_tr_d = mu_tr * np.exp(-beta * R)\n        mu_d_y = np.array([[0, mu_tr_d], [mu_tr_d, 0]])\n        \n        # Step 4: Transform dipole matrices to adiabatic basis\n        c_theta, s_theta = np.cos(theta), np.sin(theta)\n        rot_matrix_theta_T = np.array([[c_theta, -s_theta], [s_theta, c_theta]])\n        rot_matrix_theta = np.array([[c_theta, s_theta], [-s_theta, c_theta]])\n        \n        mu_a_x = rot_matrix_theta_T @ mu_d_x @ rot_matrix_theta\n        mu_a_y = rot_matrix_theta_T @ mu_d_y @ rot_matrix_theta\n        \n        # Step 5: Calculate alpha_A and beta_A coefficients\n        alpha_x = (mu_a_x[0, 0] - mu_a_x[1, 1]) / 2\n        beta_x = mu_a_x[0, 1]\n        \n        alpha_y = (mu_a_y[0, 0] - mu_a_y[1, 1]) / 2\n        beta_y = mu_a_y[0, 1]\n\n        #\n        # Note: alpha_z and beta_z are zero as mu_d_z is the zero matrix\n        #\n        \n        # Step 6: Determine the Boys diabatization angle phi\n        sum_alpha_beta = (alpha_x * beta_x) + (alpha_y * beta_y)\n        sum_alpha_sq_minus_beta_sq = (alpha_x**2 - beta_x**2) + (alpha_y**2 - beta_y**2)\n        \n        Y = -2 * sum_alpha_beta\n        X = sum_alpha_sq_minus_beta_sq\n        \n        phi = 0.25 * np.arctan2(Y, X)\n\n        # Step 7: Calculate the Boys diabatic coupling |V_B(R)|\n        V_B_R = ((E1 - E2) / 2) * np.sin(2 * phi)\n        \n        results.append(abs(V_B_R))\n\n    # Format output as specified\n    formatted_results = [f\"{res:.6f}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2760838"}]}