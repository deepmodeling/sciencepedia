{"hands_on_practices": [{"introduction": "A realistic description of a molecule's response to an electric field must account for its shape and the orientation of its electron cloud. This is captured by the polarizability tensor, $\\boldsymbol{\\alpha}$, which describes how an electric field along one axis can induce a dipole moment with components along other axes. This exercise [@problem_id:2795490] will guide you through the essential mathematics of transforming this tensor from a molecule's internal coordinate frame to the fixed laboratory frame, a fundamental skill for correctly modeling anisotropic induction effects in any simulation.", "problem": "In a polarizable force field, the induced dipole moment is modeled as the linear response of a molecule to an external electric field. Consider a rigid, anisotropically polarizable molecule whose polarizability tensor is diagonal in its molecular principal-axis frame with principal values $ \\alpha_{a} $, $ \\alpha_{b} $, and $ \\alpha_{c} $. Assume the linear response relation $ \\boldsymbol{\\mu}^{\\text{ind}} = \\boldsymbol{\\alpha} \\boldsymbol{E} $, the orthogonality of proper rotation matrices $ \\boldsymbol{R} $ with $ \\boldsymbol{R}^{\\mathsf{T}} \\boldsymbol{R} = \\boldsymbol{I} $, and the standard tensorial transformation law under orthogonal changes of basis.\n\nStarting from these fundamentals, first derive the transformation that gives the laboratory-frame polarizability tensor $ \\boldsymbol{\\alpha}_{\\text{lab}} $ from the molecular-frame tensor $ \\boldsymbol{\\alpha}_{\\text{mol}} $ and an orthogonal matrix $ \\boldsymbol{R} $ that maps molecular-frame vector components into laboratory-frame components, and justify each step physically and mathematically. Then, for the specific case where\n- $ \\boldsymbol{\\alpha}_{\\text{mol}} = \\operatorname{diag}(\\alpha_{a}, \\alpha_{b}, \\alpha_{c}) $ with $ \\alpha_{a} = 12 $, $ \\alpha_{b} = 8 $, and $ \\alpha_{c} = 6 $ (all in atomic units (a.u.)),\n- the molecular frame is rotated into the laboratory frame by a right-handed rotation about the molecular $ x $-axis by angle $ \\theta = \\pi/6 $ so that\n$$\n\\boldsymbol{R} = \\begin{pmatrix}\n1 & 0 & 0 \\\\\n0 & \\cos\\theta & -\\sin\\theta \\\\\n0 & \\sin\\theta & \\cos\\theta\n\\end{pmatrix},\n$$\n- the external electric field in the laboratory frame is $ \\boldsymbol{E}_{\\text{lab}} = (0,\\,0,\\,E_{0}) $ with $ E_{0} = 0.02 $ (in atomic units),\n\ncompute the magnitude $ |\\boldsymbol{\\mu}^{\\text{ind}}| $ of the induced dipole moment vector. Use atomic units consistently, and express the final magnitude in atomic units of dipole moment. Provide your final result as an exact closed-form expression (do not round or decimalize).", "solution": "The problem is well-posed and scientifically grounded in the principles of classical electromagnetism and its application in molecular modeling. We shall proceed with the solution.\n\nThe problem is divided into two parts: first, a derivation of the transformation law for the polarizability tensor, and second, a calculation of the magnitude of an induced dipole moment for a specific case.\n\nPart 1: Derivation of the Polarizability Tensor Transformation Law\n\nWe begin with the fundamental linear response relation between the induced dipole moment vector $ \\boldsymbol{\\mu}^{\\text{ind}} $ and the external electric field vector $ \\boldsymbol{E} $, which is mediated by the rank-$2$ polarizability tensor $ \\boldsymbol{\\alpha} $:\n$$\n\\boldsymbol{\\mu}^{\\text{ind}} = \\boldsymbol{\\alpha} \\boldsymbol{E}\n$$\nThis relation holds in any coordinate system. Let us denote quantities in the laboratory frame with the subscript 'lab' and quantities in the molecule-fixed frame with the subscript 'mol'.\n\nIn the laboratory frame, the relation is:\n$$\n\\boldsymbol{\\mu}^{\\text{ind}}_{\\text{lab}} = \\boldsymbol{\\alpha}_{\\text{lab}} \\boldsymbol{E}_{\\text{lab}}\n$$\nIn the molecular frame, where the polarizability tensor $ \\boldsymbol{\\alpha}_{\\text{mol}} $ is diagonal, the relation is:\n$$\n\\boldsymbol{\\mu}^{\\text{ind}}_{\\text{mol}} = \\boldsymbol{\\alpha}_{\\text{mol}} \\boldsymbol{E}_{\\text{mol}}\n$$\nThe problem states that the molecular frame is related to the laboratory frame by a proper rotation, represented by an orthogonal matrix $ \\boldsymbol{R} $, such that it maps vector components from the molecular frame to the laboratory frame. If $ \\boldsymbol{v}_{\\text{mol}} $ represents the components of a vector in the molecular frame, its components in the laboratory frame, $ \\boldsymbol{v}_{\\text{lab}} $, are given by:\n$$\n\\boldsymbol{v}_{\\text{lab}} = \\boldsymbol{R} \\boldsymbol{v}_{\\text{mol}}\n$$\nSince $ \\boldsymbol{R} $ is an orthogonal matrix, its inverse is equal to its transpose, $ \\boldsymbol{R}^{-1} = \\boldsymbol{R}^{\\mathsf{T}} $. Thus, the inverse transformation is:\n$$\n\\boldsymbol{v}_{\\text{mol}} = \\boldsymbol{R}^{-1} \\boldsymbol{v}_{\\text{lab}} = \\boldsymbol{R}^{\\mathsf{T}} \\boldsymbol{v}_{\\text{lab}}\n$$\nThis transformation rule applies to the electric field vector and the induced dipole moment vector:\n$$\n\\boldsymbol{E}_{\\text{mol}} = \\boldsymbol{R}^{\\mathsf{T}} \\boldsymbol{E}_{\\text{lab}}\n$$\n$$\n\\boldsymbol{\\mu}^{\\text{ind}}_{\\text{lab}} = \\boldsymbol{R} \\boldsymbol{\\mu}^{\\text{ind}}_{\\text{mol}}\n$$\nWe now establish the connection between $ \\boldsymbol{\\alpha}_{\\text{lab}} $ and $ \\boldsymbol{\\alpha}_{\\text{mol}} $ by substituting these transformations into the defining equations.\nStarting from the laboratory-frame dipole moment:\n$$\n\\boldsymbol{\\mu}^{\\text{ind}}_{\\text{lab}} = \\boldsymbol{R} \\boldsymbol{\\mu}^{\\text{ind}}_{\\text{mol}}\n$$\nSubstitute the molecular-frame constitutive relation:\n$$\n\\boldsymbol{\\mu}^{\\text{ind}}_{\\text{lab}} = \\boldsymbol{R} \\left( \\boldsymbol{\\alpha}_{\\text{mol}} \\boldsymbol{E}_{\\text{mol}} \\right)\n$$\nFinally, express the molecular-frame electric field in terms of the laboratory-frame field:\n$$\n\\boldsymbol{\\mu}^{\\text{ind}}_{\\text{lab}} = \\boldsymbol{R} \\boldsymbol{\\alpha}_{\\text{mol}} \\left( \\boldsymbol{R}^{\\mathsf{T}} \\boldsymbol{E}_{\\text{lab}} \\right)\n$$\nBy associativity of matrix multiplication, we can group the matrices:\n$$\n\\boldsymbol{\\mu}^{\\text{ind}}_{\\text{lab}} = \\left( \\boldsymbol{R} \\boldsymbol{\\alpha}_{\\text{mol}} \\boldsymbol{R}^{\\mathsf{T}} \\right) \\boldsymbol{E}_{\\text{lab}}\n$$\nComparing this result with the laboratory-frame definition $ \\boldsymbol{\\mu}^{\\text{ind}}_{\\text{lab}} = \\boldsymbol{\\alpha}_{\\text{lab}} \\boldsymbol{E}_{\\text{lab}} $, we identify the transformation for the polarizability tensor:\n$$\n\\boldsymbol{\\alpha}_{\\text{lab}} = \\boldsymbol{R} \\boldsymbol{\\alpha}_{\\text{mol}} \\boldsymbol{R}^{\\mathsf{T}}\n$$\nThis is the required similarity transformation for a rank-$2$ tensor under a change of basis defined by an orthogonal matrix $ \\boldsymbol{R} $.\n\nPart 2: Calculation of the Induced Dipole Moment Magnitude\n\nWe are given the following:\nThe molecular-frame polarizability tensor is diagonal:\n$$\n\\boldsymbol{\\alpha}_{\\text{mol}} = \\begin{pmatrix} \\alpha_{a} & 0 & 0 \\\\ 0 & \\alpha_{b} & 0 \\\\ 0 & 0 & \\alpha_{c} \\end{pmatrix} = \\begin{pmatrix} 12 & 0 & 0 \\\\ 0 & 8 & 0 \\\\ 0 & 0 & 6 \\end{pmatrix} \\text{ a.u.}\n$$\nThe rotation matrix $ \\boldsymbol{R} $ corresponds to a rotation by $ \\theta = \\frac{\\pi}{6} $ about the molecular $x$-axis. With $ \\cos(\\frac{\\pi}{6}) = \\frac{\\sqrt{3}}{2} $ and $ \\sin(\\frac{\\pi}{6}) = \\frac{1}{2} $, the matrix is:\n$$\n\\boldsymbol{R} = \\begin{pmatrix} 1 & 0 & 0 \\\\ 0 & \\cos\\theta & -\\sin\\theta \\\\ 0 & \\sin\\theta & \\cos\\theta \\end{pmatrix} = \\begin{pmatrix} 1 & 0 & 0 \\\\ 0 & \\frac{\\sqrt{3}}{2} & -\\frac{1}{2} \\\\ 0 & \\frac{1}{2} & \\frac{\\sqrt{3}}{2} \\end{pmatrix}\n$$\nThe external electric field in the laboratory frame is:\n$$\n\\boldsymbol{E}_{\\text{lab}} = \\begin{pmatrix} 0 \\\\ 0 \\\\ E_{0} \\end{pmatrix} \\quad \\text{with } E_{0} = 0.02 = \\frac{1}{50} \\text{ a.u.}\n$$\nOur goal is to compute the magnitude of the induced dipole moment, $ |\\boldsymbol{\\mu}^{\\text{ind}}| $, which we take to be the laboratory-frame quantity $ |\\boldsymbol{\\mu}^{\\text{ind}}_{\\text{lab}}| $. We can compute this by first finding the vector $ \\boldsymbol{\\mu}^{\\text{ind}}_{\\text{lab}} $. A computationally efficient path is to transform the field to the molecular frame, calculate the dipole there, and then transform the dipole back to the lab frame.\n\nStep 1: Transform $ \\boldsymbol{E}_{\\text{lab}} $ to the molecular frame.\nThe transpose of $ \\boldsymbol{R} $ is:\n$$\n\\boldsymbol{R}^{\\mathsf{T}} = \\begin{pmatrix} 1 & 0 & 0 \\\\ 0 & \\cos\\theta & \\sin\\theta \\\\ 0 & -\\sin\\theta & \\cos\\theta \\end{pmatrix} = \\begin{pmatrix} 1 & 0 & 0 \\\\ 0 & \\frac{\\sqrt{3}}{2} & \\frac{1}{2} \\\\ 0 & -\\frac{1}{2} & \\frac{\\sqrt{3}}{2} \\end{pmatrix}\n$$\n$$\n\\boldsymbol{E}_{\\text{mol}} = \\boldsymbol{R}^{\\mathsf{T}} \\boldsymbol{E}_{\\text{lab}} = \\begin{pmatrix} 1 & 0 & 0 \\\\ 0 & \\frac{\\sqrt{3}}{2} & \\frac{1}{2} \\\\ 0 & -\\frac{1}{2} & \\frac{\\sqrt{3}}{2} \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 0 \\\\ E_{0} \\end{pmatrix} = E_{0} \\begin{pmatrix} 0 \\\\ \\frac{1}{2} \\\\ \\frac{\\sqrt{3}}{2} \\end{pmatrix}\n$$\n\nStep 2: Calculate $ \\boldsymbol{\\mu}^{\\text{ind}}_{\\text{mol}} $.\n$$\n\\boldsymbol{\\mu}^{\\text{ind}}_{\\text{mol}} = \\boldsymbol{\\alpha}_{\\text{mol}} \\boldsymbol{E}_{\\text{mol}} = \\begin{pmatrix} 12 & 0 & 0 \\\\ 0 & 8 & 0 \\\\ 0 & 0 & 6 \\end{pmatrix} E_{0} \\begin{pmatrix} 0 \\\\ \\frac{1}{2} \\\\ \\frac{\\sqrt{3}}{2} \\end{pmatrix} = E_{0} \\begin{pmatrix} 12 \\times 0 \\\\ 8 \\times \\frac{1}{2} \\\\ 6 \\times \\frac{\\sqrt{3}}{2} \\end{pmatrix} = E_{0} \\begin{pmatrix} 0 \\\\ 4 \\\\ 3\\sqrt{3} \\end{pmatrix}\n$$\n\nStep 3: Transform $ \\boldsymbol{\\mu}^{\\text{ind}}_{\\text{mol}} $ back to the laboratory frame.\n$$\n\\boldsymbol{\\mu}^{\\text{ind}}_{\\text{lab}} = \\boldsymbol{R} \\boldsymbol{\\mu}^{\\text{ind}}_{\\text{mol}} = \\begin{pmatrix} 1 & 0 & 0 \\\\ 0 & \\frac{\\sqrt{3}}{2} & -\\frac{1}{2} \\\\ 0 & \\frac{1}{2} & \\frac{\\sqrt{3}}{2} \\end{pmatrix} E_{0} \\begin{pmatrix} 0 \\\\ 4 \\\\ 3\\sqrt{3} \\end{pmatrix} = E_{0} \\begin{pmatrix} 0 \\\\ 4\\frac{\\sqrt{3}}{2} - (3\\sqrt{3})\\frac{1}{2} \\\\ 4\\frac{1}{2} + (3\\sqrt{3})\\frac{\\sqrt{3}}{2} \\end{pmatrix}\n$$\n$$\n\\boldsymbol{\\mu}^{\\text{ind}}_{\\text{lab}} = E_{0} \\begin{pmatrix} 0 \\\\ 2\\sqrt{3} - \\frac{3\\sqrt{3}}{2} \\\\ 2 + \\frac{9}{2} \\end{pmatrix} = E_{0} \\begin{pmatrix} 0 \\\\ \\frac{4\\sqrt{3} - 3\\sqrt{3}}{2} \\\\ \\frac{4+9}{2} \\end{pmatrix} = E_{0} \\begin{pmatrix} 0 \\\\ \\frac{\\sqrt{3}}{2} \\\\ \\frac{13}{2} \\end{pmatrix}\n$$\nSubstituting $ E_{0} = \\frac{1}{50} $:\n$$\n\\boldsymbol{\\mu}^{\\text{ind}}_{\\text{lab}} = \\frac{1}{50} \\begin{pmatrix} 0 \\\\ \\frac{\\sqrt{3}}{2} \\\\ \\frac{13}{2} \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ \\frac{\\sqrt{3}}{100} \\\\ \\frac{13}{100} \\end{pmatrix} \\text{ a.u.}\n$$\n\nStep 4: Compute the magnitude $ |\\boldsymbol{\\mu}^{\\text{ind}}_{\\text{lab}}| $.\n$$\n|\\boldsymbol{\\mu}^{\\text{ind}}_{\\text{lab}}| = \\sqrt{0^2 + \\left(\\frac{\\sqrt{3}}{100}\\right)^2 + \\left(\\frac{13}{100}\\right)^2}\n$$\n$$\n|\\boldsymbol{\\mu}^{\\text{ind}}_{\\text{lab}}| = \\sqrt{\\frac{3}{10000} + \\frac{169}{10000}} = \\sqrt{\\frac{172}{10000}} = \\frac{\\sqrt{172}}{100}\n$$\nWe simplify the square root: $ \\sqrt{172} = \\sqrt{4 \\times 43} = 2\\sqrt{43} $.\n$$\n|\\boldsymbol{\\mu}^{\\text{ind}}_{\\text{lab}}| = \\frac{2\\sqrt{43}}{100} = \\frac{\\sqrt{43}}{50}\n$$\nAlternatively, since rotation is an isometry, it preserves the norm of a vector. Therefore, $ |\\boldsymbol{\\mu}^{\\text{ind}}_{\\text{lab}}| = |\\boldsymbol{\\mu}^{\\text{ind}}_{\\text{mol}}| $.\nUsing the result from Step 2:\n$$\n|\\boldsymbol{\\mu}^{\\text{ind}}_{\\text{mol}}| = \\left| E_{0} \\begin{pmatrix} 0 \\\\ 4 \\\\ 3\\sqrt{3} \\end{pmatrix} \\right| = E_{0} \\sqrt{0^2 + 4^2 + (3\\sqrt{3})^2} = \\frac{1}{50} \\sqrt{16 + 9 \\times 3} = \\frac{1}{50} \\sqrt{16 + 27} = \\frac{\\sqrt{43}}{50}\n$$\nBoth methods yield the same result, confirming the correctness of the calculation. The magnitude of the induced dipole moment is $ \\frac{\\sqrt{43}}{50} $ in atomic units.", "answer": "$$\n\\boxed{\\frac{\\sqrt{43}}{50}}\n$$", "id": "2795490"}, {"introduction": "A simple point-dipole model of induction, while useful, suffers from a critical flaw: at short distances, the interaction energy can diverge unphysically in what is known as the \"polarization catastrophe.\" To create stable and accurate force fields, this divergence must be corrected using screening models like Thole damping, which effectively \"smear\" the charge distribution. By working through this problem [@problem_id:2795524], you will perform a direct calculation that quantifies the significant impact of Thole damping and gain a concrete appreciation for its role in regularizing short-range electrostatic interactions.", "problem": "Consider two identical, isotropic polarizable sites located on the $z$-axis at positions $z=\\pm r/2$ with scalar polarizability $\\alpha$. A uniform external electric field $\\mathbf{E}_0$ of magnitude $E_0$ is applied along $+\\hat{\\mathbf{z}}$. Work in atomic units so that $4\\pi\\varepsilon_0=1$. Assume that the induced dipoles are constrained to lie along $z$ by symmetry and that the sites are identical, so that $\\mu_1=\\mu_2=\\mu$.\n\nFundamental bases to use:\n- Linear response (definition of isotropic polarizability): $\\boldsymbol{\\mu}^{\\text{ind}}=\\alpha\\,\\mathbf{E}_{\\text{loc}}$.\n- The electric field of a point dipole on its axial line (in atomic units): $E_{\\text{axis}}=2\\mu/r^3$ directed along the dipole moment.\n- For two sites, the local field at each site is the sum of the external field and the field due to the other site's induced dipole (modified by damping if present).\n\nYou will compare two models for the intermolecular dipole–dipole coupling tensor:\n1. Undamped point dipoles: use the axial coupling $T_{zz}=2/r^3$.\n2. Thole-damped dipoles: replace $T_{zz}$ by $T_{zz}^{\\text{damp}}=f_3(u)\\,(2/r^3)$, where the Thole screening function for dipole–dipole interactions is\n$$\nf_3(u)=1-\\exp\\!\\big(-a\\,u^3\\big)\\sum_{n=0}^{2}\\frac{\\big(a\\,u^3\\big)^n}{n!},\n$$\nwith $u=r/(\\alpha^{1/3})$ for identical isotropic sites and $a$ a dimensionless damping parameter.\n\nParameters:\n- Separation $r=3.000\\,a_0$.\n- Polarizability $\\alpha=10.00\\,a_0^3$.\n- External field magnitude $E_0=0.0100$ (atomic units of electric field).\n- Thole parameter $a=0.390$.\n\nTasks:\n- Set up from first principles and solve the coupled linear response equations to obtain the induced dipole magnitude $\\mu$ at each site without damping and with Thole damping.\n- Define the fractional reduction in the induced dipole magnitude due to Thole damping as\n$$\n\\mathcal{R}=1-\\frac{|\\mu|_{\\text{Thole}}}{|\\mu|_{\\text{undamped}}}.\n$$\nCompute $\\mathcal{R}$ for the given parameters.\n\nAnswer specification:\n- Report only the value of $\\mathcal{R}$ as a decimal fraction (unitless).\n- Round your final answer to four significant figures.", "solution": "The problem statement is evaluated and found to be valid. It is scientifically grounded in the principles of classical electrostatics and linear response theory as applied in polarizable molecular modeling. The problem is well-posed, providing all necessary data and definitions for a unique solution. The language is objective and precise. Therefore, I will proceed with the solution.\n\nThe system consists of two identical, isotropic polarizable sites, labeled $1$ and $2$, located at $z = -r/2$ and $z = +r/2$ respectively. An external uniform electric field, $\\mathbf{E}_0 = E_0 \\hat{\\mathbf{z}}$, is applied. The scalar polarizability of each site is $\\alpha$. Due to the symmetry of the system, the induced dipole moments at the two sites must be identical, $\\boldsymbol{\\mu}_1 = \\boldsymbol{\\mu}_2 = \\boldsymbol{\\mu}$. Furthermore, as the external field is along the $z$-axis, the induced dipoles are also constrained to be along the $z$-axis, so $\\boldsymbol{\\mu} = \\mu\\hat{\\mathbf{z}}$.\n\nThe fundamental principle governing this system is the linear response equation, which states that the induced dipole moment at a site $i$ is proportional to the local electric field, $\\mathbf{E}_{\\text{loc}, i}$, at that site:\n$$\n\\boldsymbol{\\mu}_i = \\alpha \\mathbf{E}_{\\text{loc}, i}\n$$\nThe local field at site $i$ is the vector sum of the external field $\\mathbf{E}_0$ and the field produced by the other dipole moment, $\\mathbf{E}_{j \\to i}$. For site $2$:\n$$\n\\mathbf{E}_{\\text{loc}, 2} = \\mathbf{E}_0 + \\mathbf{E}_{1 \\to 2}\n$$\nThe field generated by the dipole $\\boldsymbol{\\mu}_1$ at the location of site $2$ is given by $\\mathbf{E}_{1 \\to 2} = \\mathbf{T}_{21} \\boldsymbol{\\mu}_1$, where $\\mathbf{T}_{21}$ is the dipole interaction tensor. For two dipoles separated by a distance $r$ along the $z$-axis, where the dipoles themselves are oriented along $z$, the pertinent component of the interaction tensor is $T_{zz}$. The problem provides that the field from an axial dipole is $2\\mu/r^3$ along the dipole direction. Both dipoles point along $+\\hat{\\mathbf{z}}$, so the field produced by $\\boldsymbol{\\mu}_1$ at site $2$ is $\\mathbf{E}_{1\\to2} = (T_{zz} \\mu_1) \\hat{\\mathbf{z}}$.\nThe scalar equation for the $z$-component of the induced dipole at site $2$ is thus:\n$$\n\\mu_2 = \\alpha (E_0 + T_{zz} \\mu_1)\n$$\nGiven the symmetry $\\mu_1 = \\mu_2 = \\mu$, this simplifies to a single equation for the magnitude $\\mu$:\n$$\n\\mu = \\alpha (E_0 + T_{zz} \\mu)\n$$\nSolving for $\\mu$:\n$$\n\\mu - \\alpha T_{zz} \\mu = \\alpha E_0\n$$\n$$\n\\mu(1 - \\alpha T_{zz}) = \\alpha E_0\n$$\n$$\n\\mu = \\frac{\\alpha E_0}{1 - \\alpha T_{zz}}\n$$\nThis general expression can be used for both the undamped and Thole-damped models by substituting the appropriate form for $T_{zz}$.\n\nCase 1: Undamped point dipoles.\nThe interaction tensor component is $T_{zz}^{\\text{undamped}} = 2/r^3$. The induced dipole magnitude is:\n$$\n\\mu_{\\text{undamped}} = \\frac{\\alpha E_0}{1 - \\alpha (2/r^3)} = \\frac{\\alpha E_0}{1 - 2\\alpha/r^3}\n$$\n\nCase 2: Thole-damped dipoles.\nThe interaction is screened, and the tensor component is $T_{zz}^{\\text{damp}} = f_3(u) (2/r^3)$. The induced dipole magnitude is:\n$$\n\\mu_{\\text{Thole}} = \\frac{\\alpha E_0}{1 - \\alpha f_3(u) (2/r^3)} = \\frac{\\alpha E_0}{1 - (2\\alpha/r^3)f_3(u)}\n$$\nThe Thole screening function $f_3(u)$ is given by:\n$$\nf_3(u) = 1 - \\exp(-a u^3) \\sum_{n=0}^{2} \\frac{(a u^3)^n}{n!}\n$$\nwhere $u = r/\\alpha^{1/3}$.\n\nThe fractional reduction in the induced dipole magnitude is defined as:\n$$\n\\mathcal{R} = 1 - \\frac{|\\mu|_{\\text{Thole}}}{|\\mu|_{\\text{undamped}}}\n$$\nSince $E_0 > 0$ and the denominator $(1-\\alpha T_{zz})$ is positive (to avoid polarization catastrophe), $\\mu$ is positive, so $|\\mu|=\\mu$.\n$$\n\\mathcal{R} = 1 - \\frac{\\mu_{\\text{Thole}}}{\\mu_{\\text{undamped}}} = 1 - \\frac{\\frac{\\alpha E_0}{1 - (2\\alpha/r^3)f_3(u)}}{\\frac{\\alpha E_0}{1 - 2\\alpha/r^3}} = 1 - \\frac{1 - 2\\alpha/r^3}{1 - (2\\alpha/r^3)f_3(u)}\n$$\nNow, we substitute the given parameters: $r = 3.000\\,a_0$, $\\alpha = 10.00\\,a_0^3$, and $a = 0.390$.\n\nFirst, we calculate the argument of the Thole function. The dimensionless distance cubed is:\n$$\nu^3 = \\left(\\frac{r}{\\alpha^{1/3}}\\right)^3 = \\frac{r^3}{\\alpha} = \\frac{(3.000)^3}{10.00} = \\frac{27.00}{10.00} = 2.700\n$$\nThe exponent argument in the screening function is $X = a u^3$:\n$$\nX = a u^3 = 0.390 \\times 2.700 = 1.053\n$$\nNext, we evaluate the Thole function $f_3(u)$:\n$$\nf_3(u) = 1 - \\exp(-X) \\left(\\frac{X^0}{0!} + \\frac{X^1}{1!} + \\frac{X^2}{2!}\\right) = 1 - \\exp(-X) \\left(1 + X + \\frac{X^2}{2}\\right)\n$$\nSubstituting $X=1.053$:\n$$\n1 + X + \\frac{X^2}{2} = 1 + 1.053 + \\frac{(1.053)^2}{2} = 1 + 1.053 + \\frac{1.108809}{2} = 1 + 1.053 + 0.5544045 = 2.6074045\n$$\n$$\n\\exp(-1.053) \\approx 0.34889006\n$$\n$$\nf_3(u) \\approx 1 - (0.34889006) \\times (2.6074045) \\approx 1 - 0.90977614 = 0.09022386\n$$\nNow we compute the term $2\\alpha/r^3$:\n$$\n\\frac{2\\alpha}{r^3} = \\frac{2 \\times 10.00}{(3.000)^3} = \\frac{20.00}{27.00} = \\frac{20}{27}\n$$\nFinally, we calculate $\\mathcal{R}$:\n$$\n\\mathcal{R} = 1 - \\frac{1 - 20/27}{1 - (20/27) \\times f_3(u)} = 1 - \\frac{7/27}{1 - (20/27) \\times 0.09022386}\n$$\n$$\n\\mathcal{R} \\approx 1 - \\frac{0.25925926}{1 - 0.74074074 \\times 0.09022386} \\approx 1 - \\frac{0.25925926}{1 - 0.06683249}\n$$\n$$\n\\mathcal{R} \\approx 1 - \\frac{0.25925926}{0.93316751} \\approx 1 - 0.27782149\n$$\n$$\n\\mathcal{R} \\approx 0.72217851\n$$\nRounding to four significant figures, the fractional reduction is $0.7222$.", "answer": "$$\\boxed{0.7222}$$", "id": "2795524"}, {"introduction": "In a system with many interacting sites, the induced dipole at each site depends on the induced dipoles of all other sites, creating a complex many-body problem. This network of interactions can be elegantly formulated as a single linear system, $\\mathbf{A}\\boldsymbol{\\mu} = \\mathbf{b}$, where minimizing the polarization energy is equivalent to finding the solution vector $\\boldsymbol{\\mu}$. This coding exercise [@problem_id:2795523] provides hands-on experience implementing the Conjugate Gradient algorithm, a powerful iterative method used to solve these systems, connecting the abstract principles of self-consistency to the practical numerical engine inside modern polarizable simulation software.", "problem": "Consider a classical polarizable point-dipole model with three sites in reduced, dimensionless units. Each site has an isotropic polarizability and carries an induced dipole moment that responds to both an external field and the dipolar field induced by the other sites. The total polarization energy is a quadratic functional of the induced dipoles and is minimized at self-consistency.\n\nStarting from the following foundational base:\n- The induced field at site $i$ due to a dipole $\\boldsymbol{\\mu}_j$ at site $j$ (with $j \\neq i$) is given by the dipole field tensor applied to $\\boldsymbol{\\mu}_j$, where the dipole–dipole interaction tensor is\n$$\n\\mathbf{T}(\\mathbf{r}) \\;=\\; \\frac{3\\,\\hat{\\mathbf{r}}\\hat{\\mathbf{r}}^{\\mathsf{T}} - \\mathbf{I}}{r^3}\n\\quad\\text{with}\\quad\n\\mathbf{r} \\;=\\; \\mathbf{r}_i - \\mathbf{r}_j,\\;\\; r \\;=\\; \\|\\mathbf{r}\\|,\\;\\; \\hat{\\mathbf{r}} \\;=\\; \\mathbf{r}/r,\n$$\nand $\\mathbf{I}$ is the $3\\times 3$ identity.\n- For isotropic polarizabilities $\\alpha_i$, the quadratic polarization energy functional (up to an additive constant independent of the induced dipoles) is\n$$\nU_{\\text{pol}}(\\boldsymbol{\\mu}) \\;=\\; \\frac{1}{2}\\,\\boldsymbol{\\mu}^{\\mathsf{T}} \\mathbf{A}\\,\\boldsymbol{\\mu} \\;-\\; \\boldsymbol{\\mu}^{\\mathsf{T}}\\mathbf{b},\n$$\nwhere $\\boldsymbol{\\mu}$ is the $3N$-vector stacking all site dipoles, $\\mathbf{b}$ stacks the external fields at all sites, and the symmetric block matrix\n$$\n\\mathbf{A} \\;=\\; \\operatorname{diag}\\!\\left(\\alpha_1^{-1}\\mathbf{I},\\alpha_2^{-1}\\mathbf{I},\\alpha_3^{-1}\\mathbf{I}\\right) \\;-\\; \\mathbf{T},\n$$\nwith $\\mathbf{T}$ containing off-diagonal $3\\times 3$ blocks $\\mathbf{T}_{ij}=\\mathbf{T}(\\mathbf{r}_i-\\mathbf{r}_j)$ for $i\\neq j$ and zero diagonal blocks. The stationarity condition $\\nabla U_{\\text{pol}}= \\mathbf{0}$ yields the linear system\n$$\n\\mathbf{A}\\,\\boldsymbol{\\mu} \\;=\\; \\mathbf{b}.\n$$\n\nTask:\n1. Implement the Conjugate Gradient (CG) method to solve the symmetric positive-definite linear system $\\mathbf{A}\\,\\boldsymbol{\\mu}=\\mathbf{b}$ for the induced dipoles, starting from the zero vector $\\boldsymbol{\\mu}^{(0)}=\\mathbf{0}$.\n2. After each CG iterate $k$, compute the polarization energy $U_{\\text{pol}}(\\boldsymbol{\\mu}^{(k)})$. Verify the variational property that the sequence $U_{\\text{pol}}(\\boldsymbol{\\mu}^{(0)}), U_{\\text{pol}}(\\boldsymbol{\\mu}^{(1)}), \\dots$ is non-increasing. Treat numerical roundoff by allowing a tolerance: accept $U_{\\text{pol}}(\\boldsymbol{\\mu}^{(k+1)}) \\le U_{\\text{pol}}(\\boldsymbol{\\mu}^{(k)}) + \\varepsilon_k$ with $\\varepsilon_k = 10^{-12}\\,\\max\\{1, |U_{\\text{pol}}(\\boldsymbol{\\mu}^{(k)})|\\}$.\n3. Use the following three-site test suite. All quantities are dimensionless reduced units. Each test case specifies positions $\\mathbf{r}_i$, polarizabilities $\\alpha_i$, and external fields $\\mathbf{E}_i^{(0)}$ at each site, and you should construct $\\mathbf{A}$ and $\\mathbf{b}$ accordingly, with $\\mathbf{b}$ being the stacked external fields.\n\nTest Suite:\n- Case A (colinear, moderate coupling):\n  - Positions: $\\mathbf{r}_1=(0,0,0)$, $\\mathbf{r}_2=(0,0,2.5)$, $\\mathbf{r}_3=(0,0,5.0)$.\n  - Polarizabilities: $\\alpha_1=0.20$, $\\alpha_2=0.25$, $\\alpha_3=0.22$.\n  - External fields: $\\mathbf{E}_1^{(0)}=(0,0,0.5)$, $\\mathbf{E}_2^{(0)}=(0,0,0.5)$, $\\mathbf{E}_3^{(0)}=(0,0,0.5)$.\n- Case B (planar triangle, heterogeneous driving):\n  - Positions: $\\mathbf{r}_1=(0,0,0)$, $\\mathbf{r}_2=(2.0,0,0)$, $\\mathbf{r}_3=(0,2.0,0)$.\n  - Polarizabilities: $\\alpha_1=0.15$, $\\alpha_2=0.18$, $\\alpha_3=0.16$.\n  - External fields: $\\mathbf{E}_1^{(0)}=(0.1,0,0.2)$, $\\mathbf{E}_2^{(0)}=(0,0.2,0)$, $\\mathbf{E}_3^{(0)}=(0.1,0.1,0.1)$.\n- Case C (colinear, near-zero driving; edge case):\n  - Positions: $\\mathbf{r}_1=(0,0,0)$, $\\mathbf{r}_2=(0,0,1.5)$, $\\mathbf{r}_3=(0,0,3.0)$.\n  - Polarizabilities: $\\alpha_1=0.40$, $\\alpha_2=0.35$, $\\alpha_3=0.38$.\n  - External fields: $\\mathbf{E}_1^{(0)}=(0,0,0)$, $\\mathbf{E}_2^{(0)}=(0,0,0)$, $\\mathbf{E}_3^{(0)}=(0,0,0)$.\n\nAlgorithmic and numerical requirements:\n- Assemble the $9\\times 9$ matrix $\\mathbf{A}$ and the $9\\times 1$ vector $\\mathbf{b}$ for each case using the formulas above.\n- Implement Conjugate Gradient (CG) with the standard three-term recurrence, starting from $\\boldsymbol{\\mu}^{(0)}=\\mathbf{0}$, stopping when the relative residual norm $\\|\\mathbf{r}^{(k)}\\|_2/\\|\\mathbf{b}\\|_2 \\le 10^{-12}$ or after at most $1000$ iterations. If $\\|\\mathbf{b}\\|_2=0$, stop immediately.\n- At each iterate, compute $U_{\\text{pol}}(\\boldsymbol{\\mu}^{(k)})=\\frac{1}{2}(\\boldsymbol{\\mu}^{(k)})^{\\mathsf{T}}\\mathbf{A}\\,\\boldsymbol{\\mu}^{(k)}-(\\boldsymbol{\\mu}^{(k)})^{\\mathsf{T}}\\mathbf{b}$.\n\nOutput specification:\n- For each case, report two quantities:\n  1. A boolean indicating whether $U_{\\text{pol}}$ is non-increasing at every iteration within the stated tolerance.\n  2. The final minimized polarization energy $U_{\\text{pol}}(\\boldsymbol{\\mu}^{(*)})$ as a floating-point number.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets in the order\n$$\n[\\text{flag}_A,\\;U_A,\\;\\text{flag}_B,\\;U_B,\\;\\text{flag}_C,\\;U_C].\n$$\nNo units are required, because all inputs are in reduced, dimensionless units. Angles are not used.", "solution": "The problem presented is a valid and well-posed exercise in computational physics, specifically in the domain of polarizable force fields. It requires the numerical solution of a linear system derived from the principle of energy minimization for a system of interacting induced dipoles. The problem is scientifically grounded, self-contained, and all data and parameters are provided for a complete solution. We shall proceed with its resolution.\n\nThe central task is to determine the set of induced dipole moments, $\\boldsymbol{\\mu}$, for a three-site system that minimizes the polarization energy $U_{\\text{pol}}$. The vector $\\boldsymbol{\\mu}$ is a $9$-dimensional vector formed by stacking the three $3$-dimensional dipole vectors, $\\boldsymbol{\\mu} = (\\boldsymbol{\\mu}_1^{\\mathsf{T}}, \\boldsymbol{\\mu}_2^{\\mathsf{T}}, \\boldsymbol{\\mu}_3^{\\mathsf{T}})^{\\mathsf{T}}$. The energy functional is given as:\n$$\nU_{\\text{pol}}(\\boldsymbol{\\mu}) = \\frac{1}{2}\\,\\boldsymbol{\\mu}^{\\mathsf{T}} \\mathbf{A}\\,\\boldsymbol{\\mu} - \\boldsymbol{\\mu}^{\\mathsf{T}}\\mathbf{b}\n$$\nMinimization of this quadratic form with respect to $\\boldsymbol{\\mu}$ is achieved when its gradient vanishes, $\\nabla_{\\boldsymbol{\\mu}}U_{\\text{pol}} = \\mathbf{A}\\boldsymbol{\\mu} - \\mathbf{b} = \\mathbf{0}$. This leads to the symmetric positive-definite linear system $\\mathbf{A}\\boldsymbol{\\mu} = \\mathbf{b}$, which we will solve using the Conjugate Gradient (CG) method.\n\nStep 1: Construction of the System Matrix $\\mathbf{A}$ and Vector $\\mathbf{b}$\n\nFor a system of $N=3$ sites, the matrix $\\mathbf{A}$ is a $9 \\times 9$ block matrix, and the vector $\\mathbf{b}$ is a $9 \\times 1$ vector.\n\nThe vector $\\mathbf{b}$ represents the stacked external electric fields at each site:\n$$\n\\mathbf{b} = \\begin{pmatrix} \\mathbf{E}_1^{(0)} \\\\ \\mathbf{E}_2^{(0)} \\\\ \\mathbf{E}_3^{(0)} \\end{pmatrix}\n$$\nwhere each $\\mathbf{E}_i^{(0)}$ is a $3 \\times 1$ vector provided in the test data.\n\nThe matrix $\\mathbf{A}$ is defined as:\n$$\n\\mathbf{A} = \\operatorname{diag}\\!\\left(\\alpha_1^{-1}\\mathbf{I},\\alpha_2^{-1}\\mathbf{I},\\alpha_3^{-1}\\mathbf{I}\\right) - \\mathbf{T}\n$$\nThis structure can be expanded into $3 \\times 3$ blocks:\n$$\n\\mathbf{A} = \\begin{pmatrix}\n\\alpha_1^{-1}\\mathbf{I} & -\\mathbf{T}_{12} & -\\mathbf{T}_{13} \\\\\n-\\mathbf{T}_{21} & \\alpha_2^{-1}\\mathbf{I} & -\\mathbf{T}_{23} \\\\\n-\\mathbf{T}_{31} & -\\mathbf{T}_{32} & \\alpha_3^{-1}\\mathbf{I}\n\\end{pmatrix}\n$$\nThe diagonal blocks are multiples of the $3 \\times 3$ identity matrix $\\mathbf{I}$, with the inverse of the isotropic polarizability $\\alpha_i$ as the scalar factor. The off-diagonal blocks $\\mathbf{A}_{ij}$ for $i \\neq j$ are given by $-\\mathbf{T}_{ij}$, where $\\mathbf{T}_{ij} = \\mathbf{T}(\\mathbf{r}_i - \\mathbf{r}_j)$ is the dipole-dipole interaction tensor. Note that $\\mathbf{T}_{ij} = \\mathbf{T}_{ji}$, making $\\mathbf{A}$ symmetric. The tensor $\\mathbf{T}(\\mathbf{r})$ is calculated as:\n$$\n\\mathbf{T}(\\mathbf{r}) = \\frac{3\\,\\mathbf{r}\\mathbf{r}^{\\mathsf{T}} - \\|\\mathbf{r}\\|^2\\mathbf{I}}{\\|\\mathbf{r}\\|^5}\n$$\nwhere $\\mathbf{r} = \\mathbf{r}_i - \\mathbf{r}_j$ is the displacement vector between sites $i$ and $j$, and $\\mathbf{r}\\mathbf{r}^{\\mathsf{T}}$ denotes the outer product. This formula is implemented for each distinct pair of sites $(i, j)$ to populate the off-diagonal blocks of $\\mathbf{A}$.\n\nStep 2: Solution via Conjugate Gradient (CG)\n\nThe CG algorithm is an iterative method ideal for solving large, sparse, symmetric positive-definite (SPD) linear systems. The problem statement asserts that $\\mathbf{A}$ is SPD, a condition under which CG is guaranteed to converge to the unique solution.\n\nThe algorithm begins with an initial guess $\\boldsymbol{\\mu}^{(0)} = \\mathbf{0}$ and proceeds as follows:\n\n1.  Initialize:\n    -   Solution: $\\boldsymbol{\\mu}^{(0)} = \\mathbf{0}$\n    -   Residual: $\\mathbf{r}^{(0)} = \\mathbf{b} - \\mathbf{A}\\boldsymbol{\\mu}^{(0)} = \\mathbf{b}$\n    -   Search direction: $\\mathbf{p}^{(0)} = \\mathbf{r}^{(0)}$\n    -   Squared residual norm: $\\delta_0 = (\\mathbf{r}^{(0)})^{\\mathsf{T}}\\mathbf{r}^{(0)}$\n\n2.  Iterate for $k = 0, 1, 2, \\ldots$:\n    a. Compute matrix-vector product: $\\mathbf{q}^{(k)} = \\mathbf{A}\\mathbf{p}^{(k)}$\n    b. Compute step size: $\\gamma_k = \\frac{\\delta_k}{(\\mathbf{p}^{(k)})^{\\mathsf{T}}\\mathbf{q}^{(k)}}$\n    c. Update solution: $\\boldsymbol{\\mu}^{(k+1)} = \\boldsymbol{\\mu}^{(k)} + \\gamma_k \\mathbf{p}^{(k)}$\n    d. Update residual: $\\mathbf{r}^{(k+1)} = \\mathbf{r}^{(k)} - \\gamma_k \\mathbf{q}^{(k)}$\n    e. Compute new squared residual norm: $\\delta_{k+1} = (\\mathbf{r}^{(k+1)})^{\\mathsf{T}}\\mathbf{r}^{(k+1)}$\n    f. Check for convergence: Stop if $\\sqrt{\\delta_{k+1}} / \\|\\mathbf{b}\\|_2 \\le 10^{-12}$ or $k$ reaches $999$. The maximum number of iterations is $1000$.\n    g. Update search direction: $\\mathbf{p}^{(k+1)} = \\mathbf{r}^{(k+1)} + \\frac{\\delta_{k+1}}{\\delta_k} \\mathbf{p}^{(k)}$\n    h. Update squared residual norm for next iteration: $\\delta_k \\leftarrow \\delta_{k+1}$\n\nA special case arises when $\\mathbf{b} = \\mathbf{0}$ (as in Test Case C). In this situation, the initial residual $\\mathbf{r}^{(0)}$ is zero. The solution is trivially $\\boldsymbol{\\mu}=\\mathbf{0}$, and the algorithm terminates immediately. The polarization energy is $0$.\n\nStep 3: Energy Calculation and Variational Property Verification\n\nAt each iteration $k$ (including the initial state $k=0$), we compute the polarization energy:\n$$\nU_{\\text{pol}}(\\boldsymbol{\\mu}^{(k)}) = \\frac{1}{2}(\\boldsymbol{\\mu}^{(k)})^{\\mathsf{T}}(\\mathbf{A}\\,\\boldsymbol{\\mu}^{(k)}) - (\\boldsymbol{\\mu}^{(k)})^{\\mathsf{T}}\\mathbf{b}\n$$\nA fundamental property of the CG method when applied to minimize a quadratic functional is that the objective function value must be non-increasing at each step. We verify this property by checking if:\n$$\nU_{\\text{pol}}(\\boldsymbol{\\mu}^{(k+1)}) \\le U_{\\text{pol}}(\\boldsymbol{\\mu}^{(k)}) + \\varepsilon_k\n$$\nfor all $k \\ge 0$, where the tolerance $\\varepsilon_k = 10^{-12}\\,\\max\\{1, |U_{\\text{pol}}(\\boldsymbol{\\mu}^{(k)})|\\}$ accounts for finite-precision arithmetic. A boolean flag tracks whether this condition holds throughout the entire iterative process for each test case.\n\nThe final reported energy is the value of $U_{\\text{pol}}$ at the last computed iterate, which is our best approximation of the true minimum energy $U_{\\text{pol}}(\\boldsymbol{\\mu}^{(*)})$.\n\nThe implementation will now proceed according to these principles.", "answer": "[True,-0.0264177726588267,True,-0.00547012988182967,True,0.0]", "id": "2795523"}]}