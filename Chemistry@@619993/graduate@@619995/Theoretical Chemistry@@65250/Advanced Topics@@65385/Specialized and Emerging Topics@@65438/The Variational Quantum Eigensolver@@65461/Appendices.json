{"hands_on_practices": [{"introduction": "In any VQE simulation, the molecular Hamiltonian is decomposed into a sum of Pauli strings, often numbering in the thousands. A naive approach of measuring each term's expectation value in a separate experiment is computationally prohibitive. This first practice introduces the crucial concept of measurement grouping, where qubit-wise commuting Pauli terms are measured simultaneously, drastically reducing the number of required circuit executions. By working through a simple two-qubit example [@problem_id:2932509], you will gain hands-on insight into one of the most fundamental and effective cost-reduction techniques in VQE.", "problem": "In the Variational Quantum Eigensolver (VQE), the energy of a parameterized state $\\rho(\\boldsymbol{\\theta})$ with respect to a molecular electronic Hamiltonian $H$ is evaluated as the sum of expectation values of tensor products of Pauli operators. A measurement setting is defined as a single choice of local measurement axes on each qubit, specified by a tensor product $\\bigotimes_{i=0}^{n-1} P_i$ with $P_i \\in \\{X,Y,Z\\}$, used in one experiment to collect samples. Two Pauli strings are simultaneously estimable from the same measurement setting if they are simultaneously diagonal in a common product basis (qubit-wise commuting), so that a single setting yields all their expectation values by appropriate post-processing of the same bitstrings. The identity operator contributes a known constant and requires no sampling.\n\nConsider the two-qubit Hamiltonian\n$$\nH \\;=\\; c_0\\, I \\;+\\; c_1\\, Z_0 \\;+\\; c_2\\, Z_1 \\;+\\; c_3\\, Z_0 Z_1,\n$$\nwhere $c_0, c_1, c_2, c_3 \\in \\mathbb{R}$, $I$ is the identity on two qubits, $Z_0 = Z \\otimes I$, $Z_1 = I \\otimes Z$, and $Z_0 Z_1 = Z \\otimes Z$.\n\nUsing only the following foundational principles:\n- Linearity of expectation values, $\\langle A + B \\rangle = \\langle A \\rangle + \\langle B \\rangle$.\n- Commuting observables that are qubit-wise commuting (diagonalizable by single-qubit basis changes) can be measured simultaneously in one product basis measurement setting.\n- The identity term $I$ has expectation value exactly $1$ for any quantum state and thus requires no measurement.\n\nAnswer the two parts:\n1) Without grouping: assume each non-identity Pauli termâ€™s expectation value is estimated in a dedicated experiment and sampling from one experiment is not reused to estimate any other term. How many measurement settings are required?\n2) With grouping under qubit-wise commuting (QWC) compatibility: cluster Pauli strings that can be made simultaneously diagonal by single-qubit rotations, and count the minimal number of measurement settings required.\n\nExpress your final answer as a row matrix $\\begin{pmatrix} N_{\\text{no group}} & N_{\\text{QWC group}} \\end{pmatrix}$. No rounding is needed, and no units are required.", "solution": "The problem statement is subjected to validation before a solution is attempted.\n\n**Step 1: Extract Givens**\n- The system is described by a two-qubit Hamiltonian: $H = c_0\\, I + c_1\\, Z_0 + c_2\\, Z_1 + c_3\\, Z_0 Z_1$, where $c_0, c_1, c_2, c_3 \\in \\mathbb{R}$.\n- Pauli operators are defined as: $Z_0 = Z \\otimes I$, $Z_1 = I \\otimes Z$, and $Z_0 Z_1 = Z \\otimes Z$.\n- A measurement setting is a tensor product $\\bigotimes_{i=0}^{n-1} P_i$ with $P_i \\in \\{X,Y,Z\\}$.\n- Foundational principles provided:\n    1. Linearity of expectation values: $\\langle A + B \\rangle = \\langle A \\rangle + \\langle B \\rangle$.\n    2. Grouping condition: Pauli strings are simultaneously estimable if they are qubit-wise commuting (QWC), meaning they are simultaneously diagonal in a common product basis.\n    3. Identity term: $\\langle I \\rangle = 1$ and requires no measurement.\n- The task is to find the number of measurement settings required in two cases:\n    1. Part 1 ($N_{\\text{no group}}$): Each non-identity term is measured in a dedicated experiment.\n    2. Part 2 ($N_{\\text{QWC group}}$): Pauli terms are grouped if they are QWC compatible.\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientifically Grounded:** The problem is based on the standard formulation of the Variational Quantum Eigensolver (VQE) algorithm, a cornerstone of near-term quantum computing for quantum chemistry. The concepts of Pauli strings, measurement settings, and qubit-wise commuting groups for measurement reduction are fundamental and factually correct within quantum information theory.\n- **Well-Posed:** The Hamiltonian is clearly defined. The rules for counting measurement settings for both parts of the problem are explicit and unambiguous. The problem is structured to yield a unique numerical answer for each part.\n- **Objective:** The problem is stated in precise, technical language, free of subjectivity or ambiguity.\n\n**Step 3: Verdict and Action**\nThe problem is scientifically sound, well-posed, objective, and internally consistent. It does not violate any of the invalidity criteria. Therefore, the problem is deemed **valid**. A solution will be provided.\n\n**Solution**\n\nThe objective is to determine the minimum number of measurement settings required to estimate the expectation value of the Hamiltonian $H = c_0\\, I + c_1\\, Z_0 + c_2\\, Z_1 + c_3\\, Z_0 Z_1$. The expectation value is given by $\\langle H \\rangle = c_0 \\langle I \\rangle + c_1 \\langle Z_0 \\rangle + c_2 \\langle Z_1 \\rangle + c_3 \\langle Z_0 Z_1 \\rangle$.\n\nAs stated in the problem, the identity term $c_0 I$ contributes a constant value $c_0$ to the energy, since $\\langle I \\rangle = 1$ for any state. This term requires no experimental measurement. We must therefore consider only the non-identity Pauli strings in the Hamiltonian, which are:\n- $P^{(1)} = Z_0 = Z \\otimes I$\n- $P^{(2)} = Z_1 = I \\otimes Z$\n- $P^{(3)} = Z_0 Z_1 = Z \\otimes Z$\n\nThere are $3$ such non-identity terms.\n\n**Part 1: No Grouping ($N_{\\text{no group}}$)**\nIn this scenario, each non-identity Pauli term's expectation value is estimated in a dedicated experiment. This means that data from one experiment cannot be reused to estimate the expectation value of another term.\nThe terms to be measured are $\\langle Z_0 \\rangle$, $\\langle Z_1 \\rangle$, and $\\langle Z_0 Z_1 \\rangle$.\nAccording to the problem's explicit rule for this part, we require:\n- One experiment (setting) to measure $\\langle Z_0 \\rangle$.\n- One experiment (setting) to measure $\\langle Z_1 \\rangle$.\n- One experiment (setting) to measure $\\langle Z_0 Z_1 \\rangle$.\n\nTherefore, the total number of required measurement settings is the count of the non-identity Pauli terms.\n$$\nN_{\\text{no group}} = 3\n$$\n\n**Part 2: Grouping under Qubit-Wise Commuting (QWC) Compatibility ($N_{\\text{QWC group}}$)**\nIn this scenario, we group Pauli strings that are qubit-wise commuting. Two Pauli strings $P = \\bigotimes_{i=0}^{n-1} P_i$ and $Q = \\bigotimes_{i=0}^{n-1} Q_i$ are qubit-wise commuting if $[P_i, Q_i] = 0$ for all qubit indices $i$, where $[A,B]=AB-BA$ is the commutator. For Pauli matrices, this condition simplifies to $P_i$ and $Q_i$ being the same operator or one of them being the identity $I$.\n\nLet us examine the set of non-identity Pauli strings: $\\{P^{(1)}, P^{(2)}, P^{(3)}\\} = \\{Z \\otimes I, I \\otimes Z, Z \\otimes Z\\}$.\nWe check the qubit-wise commutativity for the entire set by inspecting the Pauli operators at each qubit position.\n\n- For qubit $0$ (the first qubit), the operators are $\\{Z, I, Z\\}$. The Pauli operators in this set are either $I$ or $Z$. Since $[Z, I] = 0$ and $[Z, Z] = 0$, all operators at this position commute with each other.\n\n- For qubit $1$ (the second qubit), the operators are $\\{I, Z, Z\\}$. Similarly, the Pauli operators in this set are either $I$ or $Z$. Since $[I, Z] = 0$ and $[Z, Z] = 0$, all operators at this position also commute with each other.\n\nSince the operators commute on a per-qubit basis for all pairs of strings in the set $\\{P^{(1)}, P^{(2)}, P^{(3)}\\}$, the entire set is mutually qubit-wise commuting. Consequently, all three Pauli strings can be measured simultaneously in a single measurement group.\n\nThis single group requires a measurement setting that is compatible with all member strings. To measure a Pauli string containing a non-identity operator $P_i \\in \\{X, Y, Z\\}$ on qubit $i$, one must measure qubit $i$ in the eigenbasis of $P_i$.\n- To measure $P^{(1)} = Z \\otimes I$, we must measure qubit $0$ in the $Z$-basis.\n- To measure $P^{(2)} = I \\otimes Z$, we must measure qubit $1$ in the $Z$-basis.\n- To measure $P^{(3)} = Z \\otimes Z$, we must measure qubit $0$ in the $Z$-basis and qubit $1$ in the $Z$-basis.\n\nAll three requirements are satisfied by a single measurement setting: measuring both qubit $0$ and qubit $1$ in the $Z$-basis. This corresponds to the measurement setting defined by the operator $Z \\otimes Z$. By collecting statistics from this single experiment, one can compute all three expectation values $\\langle Z_0 \\rangle$, $\\langle Z_1 \\rangle$, and $\\langle Z_0 Z_1 \\rangle$.\n\nTherefore, only one measurement setting is required when using QWC grouping.\n$$\nN_{\\text{QWC group}} = 1\n$$\n\nThe final answer is to be expressed as a row matrix $\\begin{pmatrix} N_{\\text{no group}} & N_{\\text{QWC group}} \\end{pmatrix}$.\nSubstituting the derived values, we have $\\begin{pmatrix} 3 & 1 \\end{pmatrix}$.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n3 & 1\n\\end{pmatrix}\n}\n$$", "id": "2932509"}, {"introduction": "Even after optimizing the number of measurement settings through grouping, the statistical nature of quantum measurement remains a key challenge. With a finite total number of shots, $N_{\\mathrm{tot}}$, shot noise inevitably limits the precision of our energy estimate. This exercise guides you through a foundational problem in quantum error mitigation: how to optimally allocate your measurement budget across the different Pauli terms to minimize the overall variance of the estimated energy. Using the method of Lagrange multipliers [@problem_id:2932482], you will derive a powerful formula that connects statistical theory to practical resource management on a quantum computer.", "problem": "In the Variational Quantum Eigensolver (VQE), the molecular electronic Hamiltonian is decomposed as a weighted sum of tensor-product Pauli operators, $H=\\sum_{i=1}^{m} c_{i} P_{i}$, where each $P_{i}$ is a Hermitian Pauli string with eigenvalues $\\pm 1$, and $c_{i} \\in \\mathbb{R}$. Suppose you estimate the ground-state energy by separately measuring each $P_{i}$ on the prepared ansatz state, using $N_{i}$ independent projective measurements (shots) to form the sample mean $\\widehat{\\mu}_{i}$ for $\\langle P_{i} \\rangle$, and then constructing the unbiased energy estimator $\\widehat{E}=\\sum_{i=1}^{m} c_{i} \\widehat{\\mu}_{i}$. Assume the following fundamental facts:\n- For an observable with variance $\\mathrm{Var}(P_{i})$ under the prepared state, the variance of its sample mean from $N_{i}$ independent and identically distributed measurements is $\\mathrm{Var}(\\widehat{\\mu}_{i})=\\mathrm{Var}(P_{i})/N_{i}$.\n- Measurements used to estimate distinct $\\widehat{\\mu}_{i}$ are performed independently, so covariances between $\\widehat{\\mu}_{i}$ and $\\widehat{\\mu}_{j}$ vanish for $i \\neq j$.\n\nYou are given a fixed total shot budget $N_{\\mathrm{tot}}$, so that $\\sum_{i=1}^{m} N_{i}=N_{\\mathrm{tot}}$ with $N_{i} \\ge 0$. Using the method of Lagrange multipliers, derive from first principles the unique allocation $N_{i}^{\\star}$ that minimizes the total energy-estimator variance $\\mathrm{Var}(\\widehat{E})$ subject to the budget constraint. Express your final result as a single closed-form analytic expression for $N_{i}^{\\star}$ in terms of $N_{\\mathrm{tot}}$, $\\{c_{i}\\}$, and $\\{\\mathrm{Var}(P_{i})\\}$. Then, briefly explain how, during an iterative VQE run, one can estimate $\\mathrm{Var}(P_{i})$ on the fly from streaming $\\pm 1$ measurement outcomes for each $P_{i}$ without storing the full history of outcomes.\n\nYour final answer must be the analytic expression for $N_{i}^{\\star}$ only. Do not include any discussion or units in the final answer box.", "solution": "The problem statement is subjected to validation before any attempt at a solution.\n\n**Step 1: Extract Givens**\n- The molecular electronic Hamiltonian is given by $H=\\sum_{i=1}^{m} c_{i} P_{i}$.\n- Each $P_{i}$ is a Hermitian Pauli string with eigenvalues $\\pm 1$.\n- The coefficients $c_{i}$ are real numbers, $c_{i} \\in \\mathbb{R}$.\n- The ground-state energy estimator is $\\widehat{E}=\\sum_{i=1}^{m} c_{i} \\widehat{\\mu}_{i}$, where $\\widehat{\\mu}_{i}$ is the sample mean of $\\langle P_{i} \\rangle$ obtained from $N_{i}$ independent measurements.\n- The variance of the sample mean is $\\mathrm{Var}(\\widehat{\\mu}_{i})=\\mathrm{Var}(P_{i})/N_{i}$.\n- The measurements for different Pauli terms are independent, thus $\\mathrm{Cov}(\\widehat{\\mu}_{i}, \\widehat{\\mu}_{j}) = 0$ for $i \\neq j$.\n- A total shot budget is fixed: $\\sum_{i=1}^{m} N_{i}=N_{\\mathrm{tot}}$, with $N_{i} \\ge 0$.\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientific Grounding**: The problem is well-grounded in the principles of quantum mechanics and statistical estimation theory as applied to the Variational Quantum Eigensolver (VQE) algorithm. The representation of a Hamiltonian as a sum of Pauli strings and the statistical methods for estimating its expectation value are standard in the field of quantum computing.\n- **Well-Posedness**: The problem is a classic constrained optimization task. It asks for the minimization of a well-defined objective function, $\\mathrm{Var}(\\widehat{E})$, subject to a linear constraint. The structure suggests a unique solution can be found using the method of Lagrange multipliers.\n- **Objectivity**: The language is precise, technical, and free of subjective or ambiguous terminology. All terms are standard within quantum chemistry and information theory.\n\n**Step 3: Verdict and Action**\nThe problem is scientifically valid, well-posed, and objective. It contains no contradictions, ambiguities, or factual errors. Therefore, a formal solution will be derived.\n\nThe objective is to minimize the variance of the energy estimator, $\\mathrm{Var}(\\widehat{E})$, subject to the constraint on the total number of measurements, $N_{\\mathrm{tot}}$.\n\nFirst, we express the objective function, $\\mathrm{Var}(\\widehat{E})$, in terms of the variables $N_{i}$. The estimator for the energy is $\\widehat{E} = \\sum_{i=1}^{m} c_{i} \\widehat{\\mu}_{i}$. Due to the independence of the measurements for different Pauli terms, the variance of this sum is the sum of the variances:\n$$\n\\mathrm{Var}(\\widehat{E}) = \\mathrm{Var}\\left(\\sum_{i=1}^{m} c_{i} \\widehat{\\mu}_{i}\\right) = \\sum_{i=1}^{m} \\mathrm{Var}(c_{i} \\widehat{\\mu}_{i})\n$$\nUsing the property $\\mathrm{Var}(aX) = a^2 \\mathrm{Var}(X)$, where $a$ is a constant, we have:\n$$\n\\mathrm{Var}(\\widehat{E}) = \\sum_{i=1}^{m} c_{i}^2 \\mathrm{Var}(\\widehat{\\mu}_{i})\n$$\nSubstituting the given relation $\\mathrm{Var}(\\widehat{\\mu}_{i}) = \\mathrm{Var}(P_{i})/N_{i}$:\n$$\n\\mathrm{Var}(\\widehat{E}) = \\sum_{i=1}^{m} \\frac{c_{i}^2 \\mathrm{Var}(P_{i})}{N_{i}}\n$$\nThis is the function to be minimized. The optimization is performed with respect to the allocation $\\{N_{i}\\}_{i=1}^{m}$, which we treat as continuous positive real variables. The constraint is the fixed total number of shots:\n$$\n\\sum_{i=1}^{m} N_{i} = N_{\\mathrm{tot}}\n$$\nWe employ the method of Lagrange multipliers. The Lagrangian function $\\mathcal{L}$ is constructed as:\n$$\n\\mathcal{L}(\\{N_i\\}, \\lambda) = \\sum_{i=1}^{m} \\frac{c_{i}^2 \\mathrm{Var}(P_{i})}{N_{i}} - \\lambda \\left(\\sum_{i=1}^{m} N_{i} - N_{\\mathrm{tot}}\\right)\n$$\nTo find the stationary point, we set the partial derivatives of $\\mathcal{L}$ with respect to each $N_{k}$ (for $k = 1, \\dots, m$) and $\\lambda$ to zero.\n$$\n\\frac{\\partial \\mathcal{L}}{\\partial N_{k}} = -\\frac{c_{k}^2 \\mathrm{Var}(P_{k})}{N_{k}^2} - \\lambda = 0\n$$\n$$\n\\frac{\\partial \\mathcal{L}}{\\partial \\lambda} = -\\left(\\sum_{k=1}^{m} N_{k} - N_{\\mathrm{tot}}\\right) = 0\n$$\nFrom the first equation, we solve for $N_k$:\n$$\n\\frac{c_{k}^2 \\mathrm{Var}(P_{k})}{N_{k}^2} = -\\lambda\n$$\nSince $N_{k}^2 > 0$, $c_k^2 \\ge 0$, and $\\mathrm{Var}(P_k) \\ge 0$, it must be that $\\lambda \\le 0$. We can solve for $N_k$ (taking the positive root as $N_k$ represents a number of shots):\n$$\nN_{k} = \\frac{|c_k|\\sqrt{\\mathrm{Var}(P_k)}}{\\sqrt{-\\lambda}}\n$$\nNow, we use the constraint equation to determine the Lagrange multiplier $\\lambda$.\n$$\n\\sum_{k=1}^{m} N_{k} = \\sum_{k=1}^{m} \\frac{|c_k|\\sqrt{\\mathrm{Var}(P_k)}}{\\sqrt{-\\lambda}} = N_{\\mathrm{tot}}\n$$\nFactoring out the term with $\\lambda$:\n$$\n\\frac{1}{\\sqrt{-\\lambda}} \\sum_{k=1}^{m} |c_k|\\sqrt{\\mathrm{Var}(P_k)} = N_{\\mathrm{tot}}\n$$\nSolving for $1/\\sqrt{-\\lambda}$:\n$$\n\\frac{1}{\\sqrt{-\\lambda}} = \\frac{N_{\\mathrm{tot}}}{\\sum_{j=1}^{m} |c_j|\\sqrt{\\mathrm{Var}(P_j)}}\n$$\nFinally, we substitute this expression back into the equation for $N_k$ to find the optimal allocation, which we denote as $N_{k}^{\\star}$:\n$$\nN_{k}^{\\star} = |c_k|\\sqrt{\\mathrm{Var}(P_k)} \\cdot \\left( \\frac{N_{\\mathrm{tot}}}{\\sum_{j=1}^{m} |c_j|\\sqrt{\\mathrm{Var}(P_j)}} \\right)\n$$\nRe-writing using the index $i$ as requested by the problem statement:\n$$\nN_{i}^{\\star} = N_{\\mathrm{tot}} \\frac{|c_i|\\sqrt{\\mathrm{Var}(P_i)}}{\\sum_{j=1}^{m} |c_j|\\sqrt{\\mathrm{Var}(P_j)}}\n$$\nThis expression provides the optimal number of shots $N_{i}^{\\star}$ for measuring each Pauli term $P_i$ to minimize the total statistical error in the energy estimate for a fixed total number of measurements $N_{\\mathrm{tot}}$.\n\nRegarding the second part of the inquiry, on estimating $\\mathrm{Var}(P_i)$ on the fly:\nThe variance of the observable $P_i$ for a given quantum state is defined as $\\mathrm{Var}(P_i) = \\langle P_i^2 \\rangle - \\langle P_i \\rangle^2$. Because each $P_i$ is a Pauli string, its constituent operators (Pauli matrices) square to the identity matrix. Consequently, $P_i^2 = I$, the identity operator. This implies $\\langle P_i^2 \\rangle = \\langle I \\rangle = 1$. The true variance is therefore $\\mathrm{Var}(P_i) = 1 - \\langle P_i \\rangle^2$. To estimate this quantity, we only need an estimate of the mean, $\\langle P_i \\rangle$.\n\nLet the sequence of $k$ measurement outcomes for $P_i$ be $o_1, o_2, \\dots, o_k$, where each $o_j \\in \\{-1, 1\\}$. The sample mean after $k$ measurements is $\\widehat{\\mu}_{i,k} = \\frac{1}{k}\\sum_{j=1}^{k} o_j$. This sample mean can be updated recursively as new outcomes arrive without storing the entire history. If $\\widehat{\\mu}_{i,k}$ is the mean after $k$ outcomes, and a new outcome $o_{k+1}$ is measured, the new mean $\\widehat{\\mu}_{i,k+1}$ is:\n$$\n\\widehat{\\mu}_{i,k+1} = \\frac{k\\widehat{\\mu}_{i,k} + o_{k+1}}{k+1} = \\widehat{\\mu}_{i,k} + \\frac{o_{k+1} - \\widehat{\\mu}_{i,k}}{k+1}\n$$\nThis update rule requires storing only the current mean $\\widehat{\\mu}_{i,k}$ and the number of measurements $k$. At each step of the iterative VQE run, one can update the estimate of the mean for each $P_i$ using this formula. The variance is then estimated simply as $\\widehat{\\mathrm{Var}}(P_i) = 1 - (\\widehat{\\mu}_{i,k+1})^2$. These updated variance estimates are then used in the formula for $N_{i}^{\\star}$ to adaptively re-allocate the shot budget for the next VQE iteration.", "answer": "$$\\boxed{N_{\\mathrm{tot}} \\frac{|c_i| \\sqrt{\\mathrm{Var}(P_i)}}{\\sum_{j=1}^{m} |c_j| \\sqrt{\\mathrm{Var}(P_j)}}}$$", "id": "2932482"}, {"introduction": "The heart of the VQE algorithm is the classical optimization loop that adjusts the ansatz parameters to find the ground state energy. Gradient-based optimizers are powerful, and the parameter-shift rule provides an elegant way to compute analytic gradients directly on a quantum computer. However, this rule is not universally applicable to the complex gates found in chemically-accurate ansÃ¤tze like UCCSD. This practice delves into the nuances of gradient computation, asking you to analyze the spectral properties of different gate generators to determine when the simple parameter-shift rule applies and what advanced strategies are needed when it does not [@problem_id:2932516].", "problem": "In the Variational Quantum Eigensolver (VQE) for quantum chemistry, a common ansatz is the Unitary Coupled Cluster Singles and Doubles (UCCSD) ansatz. Consider an energy function of the form $E(\\boldsymbol{\\theta}) = \\langle \\psi_{0} | U(\\boldsymbol{\\theta})^{\\dagger} H U(\\boldsymbol{\\theta}) | \\psi_{0} \\rangle$, with $U(\\boldsymbol{\\theta})$ a product of parameterized unitaries. For a single parameterized gate $U_{\\ell}(\\theta_{\\ell}) = e^{-i \\theta_{\\ell} G_{\\ell}}$ with Hermitian generator $G_{\\ell}$, exact parameter-shift gradient rules with $2$ evaluation points exist only under specific spectral conditions on $G_{\\ell}$. In practice, UCCSD layers may be implemented in several equivalent forms at differing levels of compilation or Trotterization after a fermion-to-qubit mapping such as Jordanâ€“Wigner. Consider the following representative gate families:\n- Single-excitation exchange gates realized directly as $U_{\\mathrm{ex}}(\\theta) = \\exp\\!\\big[-i \\theta \\, G_{pq}\\big]$ with $G_{pq} = \\tfrac{1}{2}\\big(X_{p} X_{q} + Y_{p} Y_{q}\\big)$ acting on qubits $p$ and $q$.\n- Untrotterized double-excitation gates realized directly as $U_{\\mathrm{d}}(\\theta) = \\exp\\!\\big[-i \\theta \\, G_{pq}^{rs}\\big]$, where $G_{pq}^{rs}$ is the qubit-mapped image of the anti-Hermitian fermionic operator $(a_{p}^{\\dagger} a_{q}^{\\dagger} a_{s} a_{r} - a_{r}^{\\dagger} a_{s}^{\\dagger} a_{q} a_{p})$; after Jordanâ€“Wigner, $G_{pq}^{rs}$ is a sum of noncommuting Pauli words with real coefficients.\n- A first-order Trotter product for a given excitation using fixed ordering, $U_{\\mathrm{Trot}}(\\theta) = \\prod_{k=1}^{K} \\exp\\!\\big(-i \\theta \\, c_{k} P_{k}\\big)$, where each $P_{k}$ is a Pauli word, $c_{k} \\in \\mathbb{R}$, and $K \\in \\mathbb{N}$.\n- A single Pauli rotation, $U_{P}(\\theta) = \\exp\\!\\big(-i \\theta \\, P\\big)$ with $P^{2} = I$.\n\nFor the purpose of unbiased gradient estimation in VQE with UCCSD, which of the following statements correctly identify gate families whose generators do not admit an exact $2$-point parameter-shift rule and, at the same time, propose valid strategiesâ€”based on the Linear Combination of Unitaries (LCU) paradigm or ancilla-assisted interferenceâ€”to obtain unbiased gradients?\n\nA. The number-conserving exchange gate $U_{\\mathrm{ex}}(\\theta)$ has a generator $G_{pq}$ whose spectrum contains more than $2$ distinct eigenvalues, so the exact $2$-point parameter-shift rule does not apply. One can obtain unbiased gradients using a generalized multi-point parameter-shift realized as an LCU over a finite set of parameter shifts, or by an ancilla-assisted circuit that coherently implements a linear combination of shifted unitaries and interferes them to extract the derivative.\n\nB. The single Pauli rotation $U_{P}(\\theta)$ does not admit a $2$-point parameter-shift rule and therefore requires an ancilla-based method to obtain unbiased gradients.\n\nC. The untrotterized double-excitation gate $U_{\\mathrm{d}}(\\theta)$ has a generator $G_{pq}^{rs}$ that is a sum of noncommuting Pauli words and thus does not admit a $2$-point parameter-shift rule. Unbiased gradients can be obtained either by an LCU estimator derived from the generalized parameter-shift rule associated with the full spectrum of $G_{pq}^{rs}$ (realized as a finite weighted sum over circuits with shifted parameters) or by an ancilla-assisted Hadamard-test construction that block-encodes $G_{pq}^{rs}$ and measures the commutator contribution to the energy gradient.\n\nD. Any first-order Trotter product $U_{\\mathrm{Trot}}(\\theta)$ as defined above automatically violates the $2$-point parameter-shift property, so exact parameter-shift gradients are impossible for such compiled UCCSD circuits.\n\nE. Adding a single control ancilla to a gate of the form $U_{\\mathrm{d}}(\\theta)$ universally makes the $2$-point parameter-shift rule applicable, regardless of the spectrum of its generator.\n\nSelect all statements that are correct.", "solution": "The problem statement has been evaluated and is determined to be valid. It is scientifically grounded, well-posed, and contains sufficient information for a rigorous analysis of the claims made in the options.\n\nThe core of the problem lies in the calculation of the gradient of an expectation value, $\\nabla_{\\boldsymbol{\\theta}} E(\\boldsymbol{\\theta})$, where $E(\\boldsymbol{\\theta}) = \\langle \\psi_{0} | U(\\boldsymbol{\\theta})^{\\dagger} H U(\\boldsymbol{\\theta}) | \\psi_{0} \\rangle$. For a single parameter $\\theta_{\\ell}$ in a gate $U_{\\ell}(\\theta_{\\ell}) = e^{-i \\theta_{\\ell} G_{\\ell}}$, the partial derivative is:\n$$\n\\frac{\\partial E}{\\partial \\theta_{\\ell}} = i \\langle \\psi(\\boldsymbol{\\theta}) | [G_{\\ell}, H] | \\psi(\\boldsymbol{\\theta}) \\rangle\n$$\nwhere $|\\psi(\\boldsymbol{\\theta})\\rangle = U(\\boldsymbol{\\theta})|\\psi_0\\rangle$. Measuring this commutator directly is often impractical. The parameter-shift rule provides an alternative by expressing this derivative as a linear combination of expectation values of the same observable $H$, but with shifted parameters.\n\nA general generator $G$ with a set of $M$ distinct eigenvalues $\\{\\lambda_j\\}_{j=1}^M$ has a corresponding generalized parameter-shift rule, which requires at least $M$ (and typically $2M$ or more for real-valued functions) evaluation points. The highly desirable **2-point parameter-shift rule** is an exact analytical expression for the gradient using only two circuit evaluations. A sufficient condition for its existence is that the generator $G_{\\ell}$ has only two unique eigenvalues. A common case is when the two eigenvalues are $\\pm r$ for some $r > 0$. In this scenario, the rule takes the form:\n$$\n\\frac{\\partial E}{\\partial \\theta_{\\ell}} = r \\left( E\\left(\\theta_{\\ell} + \\frac{\\pi}{4r}\\right) - E\\left(\\theta_{\\ell} - \\frac{\\pi}{4r}\\right) \\right)\n$$\nIf this condition is not met, alternative methods are required for unbiased gradient estimation. These include:\n1.  **The Generalized Parameter-Shift Rule**: This applies for any generator with a known, finite eigenvalue spectrum. It expresses the gradient as a linear combination of multiple shifted-parameter expectation values, i.e., $\\frac{\\partial E}{\\partial \\theta_{\\ell}} = \\sum_k c_k E(\\theta_{\\ell} + s_k)$. This can be viewed as an instance of the Linear Combination of Unitaries (LCU) paradigm.\n2.  **Ancilla-Assisted Methods**: These techniques, such as the Hadamard test, use an auxiliary qubit to interfere different quantum operations, allowing for the direct measurement of quantities like $\\operatorname{Re}\\langle\\psi|A^\\dagger B|\\psi\\rangle$ or $\\operatorname{Im}\\langle\\psi|A^\\dagger B|\\psi\\rangle$. By expressing the gradient as such a quantity (e.g., related to a commutator), one can construct an ancilla-based circuit to estimate it without needing to know the spectral properties of the generator.\n\nWe will now analyze each gate family described in the problem statement.\n\n- **Single Pauli rotation, $U_{P}(\\theta) = \\exp(-i \\theta P)$**: The generator is the Pauli word $P$. By definition, $P$ is Hermitian and $P^2 = I$. Its eigenvalues are therefore restricted to $\\{-1, +1\\}$. As there are exactly two distinct eigenvalues, the 2-point parameter-shift rule is applicable.\n\n- **Single-excitation exchange gate, $U_{\\mathrm{ex}}(\\theta) = \\exp(-i \\theta G_{pq})$**: The generator is $G_{pq} = \\frac{1}{2}(X_p X_q + Y_p Y_q)$. This operator acts on the Hilbert space of two qubits. In the computational basis $\\{|00\\rangle, |01\\rangle, |10\\rangle, |11\\rangle\\}$, its matrix representation is:\n$$\nG_{pq} = \\frac{1}{2} \\left[ \\begin{pmatrix} 0 & 0 & 0 & 1 \\\\ 0 & 0 & 1 & 0 \\\\ 0 & 1 & 0 & 0 \\\\ 1 & 0 & 0 & 0 \\end{pmatrix} + \\begin{pmatrix} 0 & 0 & 0 & -1 \\\\ 0 & 0 & 1 & 0 \\\\ 0 & 1 & 0 & 0 \\\\ -1 & 0 & 0 & 0 \\end{pmatrix} \\right] = \\begin{pmatrix} 0 & 0 & 0 & 0 \\\\ 0 & 0 & 1 & 0 \\\\ 0 & 1 & 0 & 0 \\\\ 0 & 0 & 0 & 0 \\end{pmatrix}\n$$\nThe eigenvalues of this matrix are the roots of the characteristic equation $\\det(G_{pq} - \\lambda I) = \\lambda^2(\\lambda^2 - 1) = 0$. The eigenvalues are therefore $\\{0, 0, 1, -1\\}$. The set of distinct eigenvalues is $\\{-1, 0, 1\\}$. Since there are three distinct eigenvalues, the 2-point parameter-shift rule does not apply.\n\n- **Untrotterized double-excitation gate, $U_{\\mathrm{d}}(\\theta) = \\exp(-i \\theta G_{pq}^{rs})$**: The generator $G_{pq}^{rs}$ is derived from the fermionic double-excitation operator $a_{p}^{\\dagger} a_{q}^{\\dagger} a_{s} a_{r} - \\text{h.c.}$ followed by a fermion-to-qubit mapping like Jordanâ€“Wigner. A single such term maps to a linear combination of multiple non-commuting Pauli words with real coefficients. A generic linear combination of non-commuting operators does not have a simple spectrum with only two eigenvalues. Therefore, the 2-point parameter-shift rule is generally not applicable for these gates.\n\n- **First-order Trotter product, $U_{\\mathrm{Trot}}(\\theta) = \\prod_{k=1}^{K} \\exp(-i \\theta c_k P_k)$**: This unitary is a product of exponentials where the parameter $\\theta$ is coupled to each exponent. This is not of the form $\\exp(-i\\theta G)$ for a single, simple generator $G$. The derivative must be computed using the product rule:\n$$\n\\frac{\\partial U_{\\mathrm{Trot}}}{\\partial \\theta} = \\sum_{j=1}^{K} \\left( \\prod_{k=1}^{j-1} e^{-i\\theta c_k P_k} \\right) \\left( -i c_j P_j e^{-i\\theta c_j P_j} \\right) \\left( \\prod_{k=j+1}^{K} e^{-i\\theta c_k P_k} \\right)\n$$\nThis leads to a gradient of the form $\\frac{\\partial E}{\\partial \\theta} = \\sum_{k=1}^{K} c_k \\frac{\\partial E}{\\partial \\phi_k}\\big|_{\\phi_k=\\theta c_k}$, where $\\phi_k$ is the parameter of the $k$-th gate in the product. Each term $\\frac{\\partial E}{\\partial \\phi_k}$ corresponds to a gate with generator $P_k$, for which the 2-point parameter-shift rule applies. Thus, the total gradient is exact and can be computed as a sum of $K$ terms, each obtained via a 2-point shift. The total number of circuit evaluations would be $2K$.\n\nWe now proceed to evaluate each option.\n\n**Option A**:\nThe statement claims that the generator $G_{pq}$ for the exchange gate $U_{\\mathrm{ex}}(\\theta)$ has more than $2$ distinct eigenvalues, thus invalidating the 2-point parameter-shift rule. Our analysis showed that the distinct eigenvalues are $\\{-1, 0, 1\\}$, which confirms this claim. The statement then proposes that unbiased gradients can be obtained via a generalized multi-point parameter-shift rule (an LCU method) or via an ancilla-assisted interference circuit. Both are valid and standard advanced techniques for computing gradients when the 2-point rule does not apply.\n**Verdict: Correct**\n\n**Option B**:\nThe statement claims that a single Pauli rotation $U_P(\\theta)$ does not admit a 2-point parameter-shift rule. This is fundamentally incorrect. The generator is a Pauli word $P$ with eigenvalues $\\{-1, 1\\}$, which is the canonical case where the 2-point rule is applicable. The premise of the statement is false.\n**Verdict: Incorrect**\n\n**Option C**:\nThe statement asserts that the generator $G_{pq}^{rs}$ of the untrotterized double-excitation gate $U_{\\mathrm{d}}(\\theta)$ is a sum of noncommuting Pauli words and thus does not admit a 2-point parameter-shift rule. This is correct, as such generators typically have complex spectra with more than two distinct eigenvalues. The statement then proposes two valid methods for obtaining unbiased gradients: a generalized parameter-shift rule (an LCU estimator based on the generator's spectrum) and an ancilla-assisted Hadamard-test construction. The latter is a general method for measuring commutators or implementing LCU, and is indeed a valid strategy. Both proposed solutions are correct.\n**Verdict: Correct**\n\n**Option D**:\nThis statement claims that for a Trotter product $U_{\\mathrm{Trot}}(\\theta)$, the 2-point parameter-shift property is violated and \"exact parameter-shift gradients are impossible\". While the composite gate itself does not satisfy the condition for a single 2-point shift rule, the conclusion that exact gradients are impossible is false. As shown in our analysis, the exact gradient can be computed by applying the product rule and evaluating each of the $K$ resulting terms using the 2-point parameter-shift rule, since each component gate is a simple Pauli rotation.\n**Verdict: Incorrect**\n\n**Option E**:\nThe statement claims that adding a control ancilla to a gate $U_{\\mathrm{d}}(\\theta)$ makes the 2-point parameter-shift rule applicable. This is a misunderstanding of the role of ancilla qubits in gradient computation. Ancilla-based methods provide an alternative measurement scheme to *calculate* the gradient, essentially by constructing a circuit that estimates the necessary commutator. They do not alter the spectral properties of the original generator $G_{pq}^{rs}$. The applicability of the parameter-shift rule is an intrinsic property of the generator of the parameterized gate, not a feature that can be induced by an external measurement circuit.\n**Verdict: Incorrect**\n\nTherefore, statements A and C are the only correct descriptions of the situation.", "answer": "$$\\boxed{AC}$$", "id": "2932516"}]}