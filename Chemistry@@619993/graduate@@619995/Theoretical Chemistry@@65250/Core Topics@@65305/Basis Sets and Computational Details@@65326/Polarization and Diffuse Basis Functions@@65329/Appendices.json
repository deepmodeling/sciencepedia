{"hands_on_practices": [{"introduction": "Before performing any quantum chemical calculation, one must select a basis set, and understanding the nomenclature is a critical first step. Pople-style notations like $\\text{6-31+G(d,p)}$ are a compact language describing the construction of these basis sets. This first practice focuses on decoding this language, a fundamental skill for translating theoretical needs—such as describing anions or distorted geometries—into a concrete computational setup. By parsing this notation, you will practice identifying the specific polarization and diffuse functions added to heavy atoms and hydrogens, reinforcing your understanding of their distinct roles ([@problem_id:2796127]).", "problem": "You are preparing an ab initio calculation on a main-group anion and a hydrogen-bonded complex using a Pople split-valence Gaussian-type orbital (GTO) basis set. The basis set label is $\\text{6-31+G(d,p)}$. Using the standard semantics of Pople-style notation, determine, relative to the parent $\\text{6-31G}$, exactly which additional shells are added on non-hydrogen (“heavy”) atoms and on hydrogens, and how many Gaussian primitives each such added shell contains. Base your reasoning on the following widely accepted facts: polarization functions are higher-angular-momentum GTOs than those minimally required by the occupied valence space on a given atom, diffuse functions are low-exponent GTOs of the same angular momentum as the occupied valence space that improve the radial flexibility for weakly bound electron density, the symbol “$+$” augments only heavy atoms with diffuse functions while “$++$” augments both heavy atoms and hydrogens, and in Pople sets each indicated polarization or diffuse “set” is implemented as a single uncontracted primitive per angular momentum per atom.\n\nWhich option is correct?\n\nA. Heavy atoms: add $1$ uncontracted $d$-type polarization primitive and add $1$ diffuse $s$ primitive and $1$ diffuse $p$ primitive; hydrogens: add $1$ uncontracted $p$-type polarization primitive; no diffuse primitives on hydrogens.\n\nB. Heavy atoms: add $1$ uncontracted $d$-type polarization primitive and add $1$ diffuse $s$ primitive only; hydrogens: add $1$ diffuse $s$ primitive; no polarization on hydrogens.\n\nC. Heavy atoms: add $1$ uncontracted $d$-type and $1$ uncontracted $p$-type polarization primitive and add $1$ diffuse $s$ primitive; hydrogens: add $1$ uncontracted $d$-type polarization primitive.\n\nD. Heavy atoms: add $1$ uncontracted $f$-type polarization primitive and add $1$ diffuse $s$ primitive and $1$ diffuse $p$ primitive; hydrogens: add $1$ uncontracted $p$-type polarization primitive and add $1$ diffuse $s$ primitive.\n\nE. Heavy atoms: add $1$ uncontracted $d$-type polarization primitive; hydrogens: add $1$ uncontracted $p$-type polarization primitive; diffuse augmentation on heavy atoms consists of $2$ primitives for $s$ and $2$ primitives for $p$ per atom; no diffuse primitives on hydrogens.", "solution": "The analysis of this problem must be conducted with rigorous adherence to established principles of theoretical chemistry. First, the problem statement itself must be validated for scientific soundness and logical consistency.\n\n**Problem Validation**\n\n**Step 1: Extract Givens**\n-   **System**: A main-group anion and a hydrogen-bonded complex.\n-   **Methodology**: Ab initio calculation.\n-   **Basis Set**: Pople split-valence Gaussian-type orbital (GTO) basis set, specifically labeled $\\text{6-31+G(d,p)}$.\n-   **Objective**: Determine the additional shells added to the parent $\\text{6-31G}$ basis set for both non-hydrogen (“heavy”) atoms and hydrogen atoms, including the number of Gaussian primitives per added shell.\n-   **Provided Definitions and Rules**:\n    1.  Polarization functions are higher-angular-momentum GTOs than those minimally required by the occupied valence space on a given atom.\n    2.  Diffuse functions are low-exponent GTOs of the same angular momentum as the occupied valence space.\n    3.  The symbol “$+$” augments only heavy atoms with diffuse functions.\n    4.  The symbol “$++$” augments both heavy atoms and hydrogens.\n    5.  In Pople sets, each indicated polarization or diffuse “set” is implemented as a single uncontracted primitive per angular momentum per atom.\n\n**Step 2: Validate Using Extracted Givens**\n-   **Scientific Grounding**: The problem is anchored in the standard notation and definitions used for Pople-style basis sets in quantum chemistry. The description of polarization and diffuse functions, and the meaning of symbols like `$+$` and `(d,p)`, are all consistent with universally accepted conventions in the field. The choice of systems (anion, H-bonded complex) correctly motivates the use of such functions to describe diffuse electron density and distortions in charge distribution. The problem is scientifically sound.\n-   **Well-Posedness**: The question is precise and unambiguous. Given the standard semantics of Pople notation, which are explicitly provided as rules, a unique and definite solution can be derived.\n-   **Objectivity**: The problem is stated in objective, technical language, free from any subjective or non-scientific content.\n\n**Step 3: Verdict and Action**\nThe problem statement is scientifically sound, well-posed, objective, and internally consistent. It contains all necessary information to derive a unique answer. Therefore, the problem is **valid**. I will proceed to the solution.\n\n**Derivation of the Solution**\n\nThe task is to deconstruct the basis set label $\\text{6-31+G(d,p)}$ and identify the functions added to the base $\\text{6-31G}$ set. We will analyze the components `+G` and `(d,p)` separately, as is standard practice.\n\n1.  **Analysis of Polarization Functions: `(d,p)`**\n    The notation `(d,p)` specifies the addition of polarization functions. The function listed before the comma applies to heavy (non-hydrogen) atoms, and the function listed after the comma applies to hydrogen atoms.\n    -   **Heavy Atoms**: The symbol `$d$` indicates the addition of $d$-type polarization functions. As stated in the provided rules, polarization functions possess a higher angular momentum ($L$) than the valence orbitals. For main-group heavy atoms (e.g., carbon, oxygen, nitrogen), the valence shell consists of $s$ ($L=0$) and $p$ ($L=1$) orbitals. The next higher angular momentum is $d$ ($L=2$). The problem states that each indicated set is a single uncontracted primitive. Thus, for each heavy atom, **one uncontracted $d$-type primitive shell** is added.\n    -   **Hydrogen Atoms**: The symbol `$p$` after the comma indicates the addition of $p$-type polarization functions to hydrogen atoms. For hydrogen, the valence shell consists of an $s$ orbital ($L=0$). The next higher angular momentum is $p$ ($L=1$). Therefore, for each hydrogen atom, **one uncontracted $p$-type primitive shell** is added.\n\n2.  **Analysis of Diffuse Functions: `+G`**\n    The `$+$` symbol, placed before the `G`, signifies the addition of diffuse functions.\n    -   **Heavy Atoms**: The problem explicitly states that a single `$+$` augments **only heavy atoms** with diffuse functions. It also states that diffuse functions have the same angular momentum as the occupied valence space. For main-group heavy atoms, the valence orbitals are of $s$ and $p$ type. Consequently, diffuse functions of both $s$-type and $p$-type must be added. As per the rule that each \"set\" is a single uncontracted primitive, this means adding **one uncontracted diffuse $s$-type primitive** and **one uncontracted diffuse $p$-type primitive** to each heavy atom.\n    -   **Hydrogen Atoms**: The problem specifies that the `$+$` symbol applies only to heavy atoms. To add diffuse functions to hydrogen, the `$++$` notation would be required. Therefore, **no diffuse functions are added to hydrogen atoms**.\n\n**Summary of Additions to $\\text{6-31G}$:**\n-   **On each heavy atom**: One uncontracted $d$-type polarization primitive, one uncontracted diffuse $s$-type primitive, and one uncontracted diffuse $p$-type primitive.\n-   **On each hydrogen atom**: One uncontracted $p$-type polarization primitive.\n\nWith this correct derivation, we now evaluate the provided options.\n\n**Option-by-Option Analysis**\n\n-   **A. Heavy atoms: add $1$ uncontracted $d$-type polarization primitive and add $1$ diffuse $s$ primitive and $1$ diffuse $p$ primitive; hydrogens: add $1$ uncontracted $p$-type polarization primitive; no diffuse primitives on hydrogens.**\n    This statement perfectly matches our derived conclusion. It correctly identifies the $d$-polarization on heavy atoms, the $p$-polarization on hydrogens, the addition of both $s$ and $p$ diffuse functions on heavy atoms, and the absence of diffuse functions on hydrogens. The counts of primitives ($1$ for each added shell type) are also correct according to the problem's premises.\n    **Verdict: Correct.**\n\n-   **B. Heavy atoms: add $1$ uncontracted $d$-type polarization primitive and add $1$ diffuse $s$ primitive only; hydrogens: add $1$ diffuse $s$ primitive; no polarization on hydrogens.**\n    This option is incorrect on multiple counts. For heavy atoms, it omits the necessary diffuse $p$ primitive. For hydrogens, it incorrectly adds a diffuse $s$ primitive (which would require `$++$`) and incorrectly omits the $p$-type polarization function indicated by `(d,p)`.\n    **Verdict: Incorrect.**\n\n-   **C. Heavy atoms: add $1$ uncontracted $d$-type and $1$ uncontracted $p$-type polarization primitive and add $1$ diffuse $s$ primitive; hydrogens: add $1$ uncontracted $d$-type polarization primitive.**\n    This option is fundamentally flawed. It incorrectly adds $p$-type polarization to heavy atoms. It omits the diffuse $p$-type functions for heavy atoms. It incorrectly adds $d$-type polarization to hydrogen atoms, which is not what `(d,p)` implies.\n    **Verdict: Incorrect.**\n\n-   **D. Heavy atoms: add $1$ uncontracted $f$-type polarization primitive and add $1$ diffuse $s$ primitive and $1$ diffuse $p$ primitive; hydrogens: add $1$ uncontracted $p$-type polarization primitive and add $1$ diffuse $s$ primitive.**\n    This option is incorrect. It specifies $f$-type polarization for heavy atoms, while the notation is `(d,p)`. It also incorrectly adds diffuse functions to hydrogen atoms.\n    **Verdict: Incorrect.**\n\n-   **E. Heavy atoms: add $1$ uncontracted $d$-type polarization primitive; hydrogens: add $1$ uncontracted $p$-type polarization primitive; diffuse augmentation on heavy atoms consists of $2$ primitives for $s$ and $2$ primitives for $p$ per atom; no diffuse primitives on hydrogens.**\n    This option correctly identifies the polarization functions and the absence of diffuse functions on hydrogen. However, it incorrectly describes the diffuse function augmentation on heavy atoms. The `$+$` notation adds a single set of diffuse functions (one primitive for $s$ and one for $p$), not two. A basis set with `$2$` diffuse primitives for each valence angular momentum would be designated differently and contradicts the premise that \"each indicated... diffuse 'set' is implemented as a single uncontracted primitive\".\n    **Verdict: Incorrect.**", "answer": "$$\\boxed{A}$$", "id": "2796127"}, {"introduction": "Polarization functions are not merely mathematical add-ons; they are essential for describing how a molecule's electron density responds to its environment. This hands-on practice explores this concept by quantifying the change in a molecule's static dipole polarizability, $\\alpha$, when a single polarization function is introduced. Using a simplified model grounded in perturbation theory, you will derive and compute the direct impact of adding a $d$-type function on an oxygen atom, providing a concrete illustration of how these functions enable the electron cloud to deform in an electric field ([@problem_id:2916115]).", "problem": "Consider the change in the static dipole polarizability when a single polarization function of angular momentum $d$ is added on the oxygen center of a water molecule, modeled in a minimal way as follows. Work in Hartree atomic units (a.u.), where the elementary charge, the reduced Planck constant, and the electron mass are set to $1$, dipole moments have units of Bohr ($a_0$), energies have units of Hartree ($E_h$), and polarizabilities have units of $a_0^3$.\n\nStart from the definition that the static dipole polarizability tensor $\\alpha_{ij}$ is the second derivative of the electronic ground-state energy $E$ with respect to a homogeneous electric field component $\\mathcal{E}_i$, evaluated at zero field, i.e., $\\alpha_{ij} = - \\left.\\frac{\\partial^2 E}{\\partial \\mathcal{E}_i \\partial \\mathcal{E}_j}\\right|_{\\mathcal{E}=0}$. Use time-independent nondegenerate Rayleigh–Schrödinger perturbation theory and the standard sum-over-states representation as the fundamental base to derive a lowest-order expression for the change in a single tensor component $\\Delta \\alpha_{kk}$ along a fixed molecular axis $k$ when one new oxygen-centered virtual channel is introduced by adding a single, orthonormalized, cartesian $d$-type Gaussian-type orbital (GTO).\n\nAdopt the following physically motivated and self-consistent modeling assumptions to make the problem definite and numerically testable, without introducing any additional approximations beyond those listed here:\n- The change $\\Delta \\alpha_{kk}$ is dominated by mixing of a single occupied oxygen-centered lone-pair-like molecular orbital of $p$ character, $\\lvert p\\rangle$, with the newly available virtual configuration $\\lvert d\\rangle$ supported by the added $d$-type GTO. All other occupied–virtual channels are assumed unchanged and therefore cancel in the difference.\n- The energy gap between these two configurations is a positive constant $\\Delta E = E_d - E_p > 0$, specified per test case in units of $E_h$.\n- The transition dipole matrix element along the $k$ axis scales with the spatial extent of the added cartesian $d$-type GTO. Specifically, take the matrix element magnitude to be $\\mu_{pd}^{(k)} = S\\,\\zeta_d^{-1/2}$, where $\\zeta_d > 0$ is the Gaussian exponent of the $d$ function in units of $a_0^{-2}$, and $S > 0$ is a dimensionless amplitude capturing the effective $p$ character on oxygen along axis $k$ and angular coupling.\n- Assume orthonormality of the involved states and neglect relaxation beyond first order in the electric field, consistent with linear response.\n\nYour tasks are:\n1. Using only the stated fundamental base and modeling assumptions, derive an explicit expression for $\\Delta \\alpha_{kk}$ in terms of $\\Delta E$, $\\zeta_d$, and $S$, and determine its sign. Your derivation must be grounded in the first-order perturbed density viewpoint and the sum-over-states picture, and it must logically connect the scaling of $\\mu_{pd}^{(k)}$ to the observed dependence of $\\Delta \\alpha_{kk}$ on $\\zeta_d$ and $\\Delta E$.\n2. Implement a program that evaluates your derived expression for a small test suite of parameter triples $(\\Delta E, \\zeta_d, S)$ given below. Produce numerical values of $\\Delta \\alpha_{kk}$ in $a_0^3$ for each test case.\n3. The final output must be a single line containing a Python list literal with the results for the test cases, in the same order as listed, each value rounded to $6$ decimal places, e.g., $[x_1,x_2,x_3]$.\n4. You are required to express the results in units of $a_0^3$.\n\nTest suite (each triple is $(\\Delta E, \\zeta_d, S)$, with $\\Delta E$ in $E_h$, $\\zeta_d$ in $a_0^{-2}$, and $S$ dimensionless):\n- Case A (general happy path): $(0.6,\\;1.5,\\;1.1)$.\n- Case B (tight $d$ function, boundary-like behavior): $(1.5,\\;6.0,\\;1.1)$.\n- Case C (diffuse $d$ function, edge-case behavior): $(0.3,\\;0.5,\\;1.1)$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[r_1,r_2,r_3]$), where each $r_i$ is the computed $\\Delta \\alpha_{kk}$ in $a_0^3$ for the corresponding test case, rounded to $6$ decimal places.", "solution": "The problem statement is first subjected to a validation procedure.\n\nStep 1: Extracted Givens.\n- The definition of the static dipole polarizability tensor is $\\alpha_{ij} = -\\left.\\frac{\\partial^2 E}{\\partial \\mathcal{E}_i \\partial \\mathcal{E}_j}\\right|_{\\mathcal{E}=0}$.\n- The theoretical foundation is time-independent nondegenerate Rayleigh–Schrödinger perturbation theory and the sum-over-states representation.\n- The quantity of interest is the change in a polarizability tensor component, $\\Delta \\alpha_{kk}$, upon adding a single cartesian $d$-type Gaussian-type orbital (GTO) on the oxygen atom of a water molecule.\n- Assumption 1: The change $\\Delta \\alpha_{kk}$ is solely due to the introduction of a new excitation channel between an occupied $p$-type molecular orbital (MO) $\\lvert p\\rangle$ and a new virtual $d$-type MO $\\lvert d\\rangle$.\n- Assumption 2: The energy gap between these two states is a positive constant $\\Delta E = E_d - E_p > 0$.\n- Assumption 3: The magnitude of the transition dipole matrix element between these states along axis $k$ is given by the model $\\mu_{pd}^{(k)} = S\\,\\zeta_d^{-1/2}$, where $\\zeta_d > 0$ is the GTO exponent and $S > 0$ is a dimensionless amplitude.\n- Assumption 4: The states are orthonormal, and electronic relaxation effects beyond first order are neglected.\n- All calculations are performed in Hartree atomic units, with polarizability expressed in units of $a_0^3$.\n- Test cases for $(\\Delta E, \\zeta_d, S)$: Case A $(0.6, 1.5, 1.1)$; Case B $(1.5, 6.0, 1.1)$; Case C $(0.3, 0.5, 1.1)$.\n\nStep 2: Validation.\nThe problem is scientifically grounded, being based on standard principles of quantum chemistry (perturbation theory, basis sets, molecular properties). Its simplifying assumptions, while aggressive, are physically motivated for creating a tractable model and are explicitly stated. The problem is well-posed, objective, and self-contained, providing all necessary information to derive a unique expression and compute the required numerical values. It does not violate any fundamental laws, nor is it trivial or ill-defined.\n\nStep 3: Verdict.\nThe problem is valid. A reasoned solution will be provided.\n\nThe derivation proceeds from the sum-over-states (SOS) expression for the static dipole polarizability, which is a direct consequence of second-order Rayleigh-Schrödinger perturbation theory applied to a molecule in a static electric field. For a diagonal component $\\alpha_{kk}$, the SOS expression is:\n$$\n\\alpha_{kk} = 2 \\sum_{n \\neq 0} \\frac{|\\langle \\Psi_0 | \\hat{\\mu}_k | \\Psi_n \\rangle|^2}{E_n - E_0}\n$$\nwhere $\\Psi_0$ is the ground electronic state with energy $E_0$, $\\{\\Psi_n\\}_{n \\neq 0}$ is the set of all excited electronic states with energies $E_n$, and $\\hat{\\mu}_k$ is the $k$-component of the electric dipole operator. All quantities are in atomic units.\n\nThe problem states that adding a new $d$-type GTO introduces a single new virtual channel involving an occupied orbital $\\lvert p \\rangle$ and the new virtual orbital $\\lvert d \\rangle$. All other occupied-virtual channels are assumed to be unaffected. Therefore, the change in polarizability, $\\Delta \\alpha_{kk}$, is simply the contribution of this single new term to the sum-over-states:\n$$\n\\Delta \\alpha_{kk} = 2 \\frac{|\\langle \\Psi_0 | \\hat{\\mu}_k | \\Psi_{p \\to d} \\rangle|^2}{E_{p \\to d} - E_0}\n$$\nwhere $\\Psi_{p \\to d}$ is the newly accessible excited state corresponding to the promotion of an electron from $\\lvert p \\rangle$ to $\\lvert d \\rangle$.\n\nWe now apply the modeling assumptions to evaluate this expression.\n1. The energy denominator, $E_{p \\to d} - E_0$, is the energy of the excitation. Within a molecular orbital picture, this is approximated by the difference in orbital energies. The problem provides this value directly as the energy gap $\\Delta E = E_d - E_p$.\n2. The numerator contains the squared transition dipole moment, $|\\langle \\Psi_0 | \\hat{\\mu}_k | \\Psi_{p \\to d} \\rangle|^2$. Within a single-particle model, this state-to-state matrix element is proportional to the orbital matrix element $\\mu_{pd}^{(k)} = \\langle p | \\hat{\\mu}_k | d \\rangle$. The problem provides a model for the magnitude of this effective transition moment as $|\\mu_{pd}^{(k)}| = S \\zeta_d^{-1/2}$.\n\nSubstituting these model parameters into the expression for $\\Delta \\alpha_{kk}$:\n$$\n\\Delta \\alpha_{kk} = 2 \\frac{(S \\zeta_d^{-1/2})^2}{\\Delta E}\n$$\nThis simplifies to the final expression:\n$$\n\\Delta \\alpha_{kk} = \\frac{2 S^2}{\\Delta E \\cdot \\zeta_d}\n$$\nThis is the explicit expression for $\\Delta \\alpha_{kk}$ in terms of the given parameters $\\Delta E$, $\\zeta_d$, and $S$.\n\nTo determine the sign of $\\Delta \\alpha_{kk}$, we note that $S > 0$ by definition, so $S^2 > 0$. The energy gap $\\Delta E > 0$ and the Gaussian exponent $\\zeta_d > 0$ are also given as positive constants. As all factors in the expression are positive, the resulting change in polarizability $\\Delta \\alpha_{kk}$ must be positive. This is physically correct: adding a polarization channel for the electron density to respond to an external field must increase the polarizability of the system.\n\nThe derivation also illuminates the dependence of $\\Delta \\alpha_{kk}$ on the model parameters. The inverse proportionality to the energy gap, $\\Delta \\alpha_{kk} \\propto 1/\\Delta E$, is characteristic of second-order perturbation theory: smaller energy gaps lead to stronger coupling and larger responses. The inverse proportionality to the exponent, $\\Delta \\alpha_{kk} \\propto 1/\\zeta_d$, arises from the scaling of the transition dipole moment. A smaller exponent $\\zeta_d$ signifies a more spatially diffuse GTO. A diffuse function has a larger spatial extent, which leads to a larger value for the matrix element of the position-dependent dipole operator, $\\mu_{pd}^{(k)}$. This larger transition moment, in turn, yields a greater contribution to the polarizability, consistent with the known fact that diffuse basis functions are crucial for accurately describing polarizabilities.\n\nThe problem is now reduced to a numerical calculation using the derived formula for the provided test cases.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the change in static dipole polarizability based on a derived\n    two-level model and provided test cases.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each tuple is (delta_E, zeta_d, S)\n    test_cases = [\n        (0.6, 1.5, 1.1),  # Case A: General happy path\n        (1.5, 6.0, 1.1),  # Case B: Tight d function, boundary-like behavior\n        (0.3, 0.5, 1.1),  # Case C: Diffuse d function, edge-case behavior\n    ]\n\n    results = []\n    for case in test_cases:\n        # Unpack parameters for the current case\n        delta_E, zeta_d, S = case\n\n        # The derived formula for the change in polarizability is:\n        # delta_alpha_kk = (2 * S^2) / (delta_E * zeta_d)\n        # All inputs are in Hartree atomic units, so the result is in the\n        # atomic unit of polarizability, which is a_0^3.\n        delta_alpha_kk = (2 * S**2) / (delta_E * zeta_d)\n\n        # Append the result formatted to 6 decimal places as required.\n        results.append(f\"{delta_alpha_kk:.6f}\")\n\n    # Final print statement in the exact required format: [r1,r2,r3]\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "2916115"}, {"introduction": "While polarization functions are vital for describing charge distribution in bonding regions, diffuse functions are crucial for capturing the behavior of weakly-bound and spatially extended electrons. This practice provides a hands-on method to distinguish between valence and Rydberg electronic excitations—a common task in computational spectroscopy—by analyzing the character of the target molecular orbital. You will implement a model to compute the orbital's spatial extent, $\\langle r^2 \\rangle$, and its diffuse character, demonstrating quantitatively how adding diffuse functions is essential for correctly identifying and describing Rydberg states ([@problem_id:2916133]).", "problem": "You are asked to design and implement a mathematically self-contained program that distinguishes valence from Rydberg excitations in a toy model of ammonia by examining attachment densities and orbital characters with and without augmentation by diffuse functions. Work in atomic units throughout, where length is measured in bohr and exponents are in bohr$^{-2}$. All final second-moment radii must be expressed in bohr$^{2}$.\n\nThe model is as follows. Consider a single-center basis of normalized $s$-type Gaussian-Type Orbitals (GTOs), each of the form $\\chi_{p}(\\mathbf{r}) = N(\\alpha_{p}) \\exp(-\\alpha_{p} r^{2})$ centered at the origin, where $r = \\|\\mathbf{r}\\|$, and the normalization factor is $N(\\alpha) = \\left(\\dfrac{2\\alpha}{\\pi}\\right)^{3/4}$. A molecular orbital $\\phi(\\mathbf{r})$ is a linear combination of these basis functions, $\\phi(\\mathbf{r}) = \\sum_{p=1}^{M} c_{p} \\chi_{p}(\\mathbf{r})$, where $M$ is the number of primitives. The attachment density for a one-electron excitation from an occupied orbital to a virtual orbital is taken to be $|\\phi_{\\mathrm{virt}}(\\mathbf{r})|^{2}$, which encodes the spatial character of the electron following the excitation.\n\nFundamental Gaussian integral results for $s$-type functions at the same center that you may use are:\n- The overlap integral $S_{pq} = \\int \\chi_{p}(\\mathbf{r}) \\chi_{q}(\\mathbf{r}) \\, d^{3}r = \\left(\\dfrac{2\\sqrt{\\alpha_{p}\\alpha_{q}}}{\\alpha_{p}+\\alpha_{q}}\\right)^{3/2}$.\n- The second-moment integral $R^{(2)}_{pq} = \\int r^{2}\\,\\chi_{p}(\\mathbf{r}) \\chi_{q}(\\mathbf{r}) \\, d^{3}r = S_{pq}\\,\\dfrac{3}{2(\\alpha_{p}+\\alpha_{q})}$.\n\nGiven a coefficient vector $\\mathbf{c} \\in \\mathbb{R}^{M}$ and the matrices $S = [S_{pq}]$ and $R^{(2)} = [R^{(2)}_{pq}]$, the second moment of the attachment density (equivalently of the virtual orbital) is\n$$\\langle r^{2} \\rangle_{\\mathrm{attach}} = \\frac{\\mathbf{c}^{\\mathsf{T}} R^{(2)} \\mathbf{c}}{\\mathbf{c}^{\\mathsf{T}} S \\mathbf{c}},$$\nwhich must be reported in bohr$^{2}$. The Mulliken-like diffuse-fraction of an orbital over a specified index set $\\mathcal{D}$ of diffuse primitives is defined by\n$$ f_{\\mathrm{diffuse}} = \\frac{\\sum_{p\\in \\mathcal{D}} \\sum_{q=1}^{M} c_{p}\\,c_{q}\\,S_{pq}}{\\sum_{p=1}^{M} \\sum_{q=1}^{M} c_{p}\\,c_{q}\\,S_{pq}}. $$\n\nFor each test case below, you are given:\n- A valence-only set of exponents $\\{\\alpha_{v}\\}$.\n- An augmented set of diffuse exponents $\\{\\alpha_{d}\\}$ to be appended to the valence set to form the augmented basis.\n- Two unnormalized coefficient lists in the augmented basis: one for an occupied valence molecular orbital $\\mathbf{c}_{\\mathrm{occ}}^{\\mathrm{aug}}$ and one for a virtual target orbital $\\mathbf{c}_{\\mathrm{virt}}^{\\mathrm{aug}}$.\n- Two thresholds $r^{2}_{\\mathrm{cut}}$ (in bohr$^{2}$) and $f_{\\mathrm{cut}}$ (unitless, as a decimal fraction).\n\nYour program must, for each test case:\n1. Build the augmented basis by concatenating $\\{\\alpha_{v}\\}$ and $\\{\\alpha_{d}\\}$ (valence indices first, then diffuse). Construct $S$ and $R^{(2)}$ for this augmented basis using the formulas above.\n2. Normalize both $\\mathbf{c}_{\\mathrm{occ}}^{\\mathrm{aug}}$ and $\\mathbf{c}_{\\mathrm{virt}}^{\\mathrm{aug}}$ with respect to the $S$ metric, i.e., scale $\\mathbf{c}$ so that $\\mathbf{c}^{\\mathsf{T}} S \\mathbf{c} = 1$.\n3. Compute the augmented-case attachment second moment $\\langle r^{2} \\rangle_{\\mathrm{attach}}^{\\mathrm{aug}}$ from the normalized $\\mathbf{c}_{\\mathrm{virt}}^{\\mathrm{aug}}$ and the diffuse fraction $f_{\\mathrm{diffuse}}^{\\mathrm{aug}}$ using the diffuse index set $\\mathcal{D}$ corresponding to the appended diffuse primitives.\n4. Build the non-augmented (valence-only) basis by discarding the diffuse primitives and truncating the coefficient vectors to the valence block, then re-normalize with the valence-only overlap matrix. Compute the non-augmented attachment second moment $\\langle r^{2} \\rangle_{\\mathrm{attach}}^{\\mathrm{noaug}}$. Define $f_{\\mathrm{diffuse}}^{\\mathrm{noaug}} = 0$ because no diffuse primitives are present.\n5. Classify the excitation as \"Rydberg\" in the augmented basis if and only if both $\\langle r^{2} \\rangle_{\\mathrm{attach}}^{\\mathrm{aug}} \\ge r^{2}_{\\mathrm{cut}}$ and $f_{\\mathrm{diffuse}}^{\\mathrm{aug}} \\ge f_{\\mathrm{cut}}$. Otherwise, classify it as \"valence\". Report this classification as an integer, with $1$ for Rydberg and $0$ for valence.\n6. Compute $\\Delta r^{2} = \\langle r^{2} \\rangle_{\\mathrm{attach}}^{\\mathrm{aug}} - \\langle r^{2} \\rangle_{\\mathrm{attach}}^{\\mathrm{noaug}}$ in bohr$^{2}$.\n\nTest suite. Use the following four test cases; each list is given in the order (valence exponents, diffuse exponents, occupied coefficients in augmented basis, virtual coefficients in augmented basis, $r^{2}_{\\mathrm{cut}}$, $f_{\\mathrm{cut}}$):\n- Case $1$ (happy path, strongly Rydberg under augmentation):\n  - $\\{\\alpha_{v}\\} = \\{1.6, 0.5\\}$, $\\{\\alpha_{d}\\} = \\{0.08, 0.03\\}$,\n  - $\\mathbf{c}_{\\mathrm{occ}}^{\\mathrm{aug}} = (0.8, 1.0, 0.05, 0.02)$,\n  - $\\mathbf{c}_{\\mathrm{virt}}^{\\mathrm{aug}} = (0.1, 0.2, 1.0, 0.9)$,\n  - $r^{2}_{\\mathrm{cut}} = 8.0$ bohr$^{2}$, $f_{\\mathrm{cut}} = 0.6$.\n- Case $2$ (valence-like virtual, augmentation present but unimportant):\n  - $\\{\\alpha_{v}\\} = \\{1.6, 0.6\\}$, $\\{\\alpha_{d}\\} = \\{0.1\\}$,\n  - $\\mathbf{c}_{\\mathrm{occ}}^{\\mathrm{aug}} = (0.9, 1.0, 0.0)$,\n  - $\\mathbf{c}_{\\mathrm{virt}}^{\\mathrm{aug}} = (0.7, 0.8, 0.1)$,\n  - $r^{2}_{\\mathrm{cut}} = 6.0$ bohr$^{2}$, $f_{\\mathrm{cut}} = 0.5$.\n- Case $3$ (borderline mixture of valence and diffuse character):\n  - $\\{\\alpha_{v}\\} = \\{1.2, 0.4\\}$, $\\{\\alpha_{d}\\} = \\{0.08\\}$,\n  - $\\mathbf{c}_{\\mathrm{occ}}^{\\mathrm{aug}} = (0.9, 1.1, 0.05)$,\n  - $\\mathbf{c}_{\\mathrm{virt}}^{\\mathrm{aug}} = (0.45, 0.50, 0.45)$,\n  - $r^{2}_{\\mathrm{cut}} = 6.0$ bohr$^{2}$, $f_{\\mathrm{cut}} = 0.5$.\n- Case $4$ (edge case with extremely diffuse augmentation):\n  - $\\{\\alpha_{v}\\} = \\{1.8\\}$, $\\{\\alpha_{d}\\} = \\{0.02\\}$,\n  - $\\mathbf{c}_{\\mathrm{occ}}^{\\mathrm{aug}} = (1.0, 0.01)$,\n  - $\\mathbf{c}_{\\mathrm{virt}}^{\\mathrm{aug}} = (0.05, 1.0)$,\n  - $r^{2}_{\\mathrm{cut}} = 12.0$ bohr$^{2}$, $f_{\\mathrm{cut}} = 0.8$.\n\nFinal output format. Your program must produce a single line containing a single list whose entries are, for each test case in order:\n- $\\langle r^{2} \\rangle_{\\mathrm{attach}}^{\\mathrm{aug}}$ (float, in bohr$^{2}$),\n- $f_{\\mathrm{diffuse}}^{\\mathrm{aug}}$ (float, unitless),\n- $\\langle r^{2} \\rangle_{\\mathrm{attach}}^{\\mathrm{noaug}}$ (float, in bohr$^{2}$),\n- $f_{\\mathrm{diffuse}}^{\\mathrm{noaug}}$ (float, always $0$),\n- $\\Delta r^{2}$ (float, in bohr$^{2}$),\n- the classification integer ($1$ for Rydberg, $0$ for valence).\n\nThe program should thus print a single line of the form\n$[x_{1},x_{2},\\dots,x_{24}]$\nfor the $4$ cases, where the entries appear in the order specified above. All second-moment quantities must be in bohr$^{2}$, and all fractions must be decimals (no percentage signs). Angles do not appear in this problem. The computation must be fully deterministic and not require any user input.", "solution": "The problem presented is a valid, self-contained exercise in computational quantum chemistry. It requires the implementation of a simplified model to analyze and classify electronic excitations based on the spatial extent of the target molecular orbital. The model, while a toy representation, is built upon sound and standard principles of quantum mechanics, namely the use of Gaussian-Type Orbitals (GTOs) as a basis set and the calculation of electronic properties from wavefunctions constructed in this basis. All necessary definitions, formulas, and data are provided, and the logic is free from contradiction or ambiguity. We proceed with the solution.\n\nThe fundamental components of the model are the atomic basis functions, molecular orbitals (MOs), and the operators for physical properties. The basis set consists of normalized, single-center $s$-type GTOs, $\\chi_{p}(\\mathbf{r})$, defined by an exponent $\\alpha_{p}$:\n$$ \\chi_{p}(\\mathbf{r}) = \\left(\\frac{2\\alpha_{p}}{\\pi}\\right)^{3/4} \\exp(-\\alpha_{p} r^{2}) $$\nA molecular orbital, $\\phi(\\mathbf{r})$, is a linear combination of these basis functions:\n$$ \\phi(\\mathbf{r}) = \\sum_{p=1}^{M} c_{p} \\chi_{p}(\\mathbf{r}) $$\nwhere $\\mathbf{c} = (c_1, c_2, \\dots, c_M)^{\\mathsf{T}}$ is the vector of MO coefficients in the basis of $M$ GTOs.\n\nThe analysis of orbital properties requires computing matrix elements of operators in the GTO basis. The problem provides the necessary analytical formulas for the overlap matrix, $S$, and the second-moment-radius matrix, $R^{(2)}$:\n$$ S_{pq} = \\int \\chi_{p}(\\mathbf{r}) \\chi_{q}(\\mathbf{r}) \\, d^{3}r = \\left(\\frac{2\\sqrt{\\alpha_{p}\\alpha_{q}}}{\\alpha_{p}+\\alpha_{q}}\\right)^{3/2} $$\n$$ R^{(2)}_{pq} = \\int r^{2}\\,\\chi_{p}(\\mathbf{r}) \\chi_{q}(\\mathbf{r}) \\, d^{3}r = S_{pq}\\,\\frac{3}{2(\\alpha_{p}+\\alpha_{q})} $$\nThe expectation value of the squared radius, $\\langle r^2 \\rangle$, for an orbital described by the coefficient vector $\\mathbf{c}$ is given by the general formula for an expectation value in a non-orthogonal basis:\n$$ \\langle r^{2} \\rangle = \\frac{\\int \\phi^{*}(\\mathbf{r}) r^2 \\phi(\\mathbf{r}) \\, d^3r}{\\int \\phi^{*}(\\mathbf{r}) \\phi(\\mathbf{r}) \\, d^3r} = \\frac{\\mathbf{c}^{\\mathsf{T}} R^{(2)} \\mathbf{c}}{\\mathbf{c}^{\\mathsf{T}} S \\mathbf{c}} $$\nThe denominator, $\\mathbf{c}^{\\mathsf{T}} S \\mathbf{c}$, is the squared norm of the MO. For a normalized orbital, this denominator is $1$, simplifying the expression. The normalization condition is $\\mathbf{c}^{\\mathsf{T}} S \\mathbf{c} = 1$. An unnormalized coefficient vector $\\mathbf{c}_{\\mathrm{unnorm}}$ is normalized by scaling: $\\mathbf{c}_{\\mathrm{norm}} = \\mathbf{c}_{\\mathrm{unnorm}} / \\sqrt{\\mathbf{c}_{\\mathrm{unnorm}}^{\\mathsf{T}} S \\mathbf{c}_{\\mathrm{unnorm}}}$.\n\nThe problem models an electronic excitation by focusing on the character of the virtual (target) orbital, $\\phi_{\\mathrm{virt}}$. The attachment density is defined as $|\\phi_{\\mathrm{virt}}(\\mathbf{r})|^2$, and its spatial extent, quantified by $\\langle r^2 \\rangle_{\\mathrm{attach}} = \\langle r^2 \\rangle_{\\phi_{\\mathrm{virt}}}$, serves as a primary metric. A large $\\langle r^2 \\rangle$ indicates a diffuse, Rydberg-like orbital, while a smaller $\\langle r^2 \\rangle$ suggests a more compact, valence-like orbital.\n\nA second metric, the diffuse fraction $f_{\\mathrm{diffuse}}$, quantifies the contribution of a designated set of diffuse basis functions (those with small exponents $\\alpha_p$) to the MO. The specified definition is a Mulliken-like partition of the total electronic density:\n$$ f_{\\mathrm{diffuse}} = \\frac{\\sum_{p\\in \\mathcal{D}} \\sum_{q=1}^{M} c_{p}\\,c_{q}\\,S_{pq}}{\\mathbf{c}^{\\mathsf{T}} S \\mathbf{c}} $$\nwhere $\\mathcal{D}$ is the index set of diffuse primitives. For a normalized MO, the denominator is $1$. The numerator can be computed efficiently: let $\\mathbf{v} = S \\mathbf{c}$; the numerator is then $\\sum_{p \\in \\mathcal{D}} c_p v_p$.\n\nThe computational procedure for each test case is as follows:\n1.  **Construct Bases and Matrices**:\n    The augmented basis is formed by concatenating the valence exponents $\\{\\alpha_v\\}$ and diffuse exponents $\\{\\alpha_d\\}$. Let $N_v$ be the number of valence functions and $M$ be the total number of functions. The augmented overlap matrix $S^{\\mathrm{aug}}$ and second-moment matrix $(R^{(2)})^{\\mathrm{aug}}$ of size $M \\times M$ are constructed. The valence-only matrices, $S^{\\mathrm{noaug}}$ and $(R^{(2)})^{\\mathrm{noaug}}$, are the top-left $N_v \\times N_v$ blocks of the augmented matrices.\n\n2.  **Process Orbitals**:\n    The problem provides unnormalized coefficient vectors for both an occupied and a virtual orbital, $\\mathbf{c}_{\\mathrm{occ}}^{\\mathrm{aug}}$ and $\\mathbf{c}_{\\mathrm{virt}}^{\\mathrm{aug}}$. The instructions require normalizing both. It must be noted that only the virtual orbital properties are used for the final classification and output. The processing of the occupied orbital is performed as instructed but serves only as a procedural check.\n    \n    For the virtual orbital:\n    a.  **Augmented Case**: The vector $\\mathbf{c}_{\\mathrm{virt}}^{\\mathrm{aug}}$ is normalized using $S^{\\mathrm{aug}}$. Using the normalized vector, $\\langle r^{2} \\rangle_{\\mathrm{attach}}^{\\mathrm{aug}}$ and $f_{\\mathrm{diffuse}}^{\\mathrm{aug}}$ are computed. The set $\\mathcal{D}$ for the diffuse fraction consists of the indices corresponding to $\\{\\alpha_d\\}$.\n    b.  **Non-Augmented Case**: The vector $\\mathbf{c}_{\\mathrm{virt}}^{\\mathrm{aug}}$ is truncated to its first $N_v$ components to yield $\\mathbf{c}_{\\mathrm{virt}}^{\\mathrm{noaug}}$. This vector is re-normalized using $S^{\\mathrm{noaug}}$. Then, $\\langle r^{2} \\rangle_{\\mathrm{attach}}^{\\mathrm{noaug}}$ is computed. By definition, since there are no diffuse functions in this basis, $f_{\\mathrm{diffuse}}^{\\mathrm{noaug}} = 0$.\n\n3.  **Classify and Report**:\n    The excitation is classified as Rydberg (output $1$) if both $\\langle r^{2} \\rangle_{\\mathrm{attach}}^{\\mathrm{aug}} \\ge r^{2}_{\\mathrm{cut}}$ and $f_{\\mathrm{diffuse}}^{\\mathrm{aug}} \\ge f_{\\mathrm{cut}}$. Otherwise, it is classified as valence (output $0$). The change in the second moment, $\\Delta r^{2} = \\langle r^{2} \\rangle_{\\mathrm{attach}}^{\\mathrm{aug}} - \\langle r^{2} \\rangle_{\\mathrm{attach}}^{\\mathrm{noaug}}$, is calculated. The final six quantities—$\\langle r^{2} \\rangle_{\\mathrm{attach}}^{\\mathrm{aug}}$, $f_{\\mathrm{diffuse}}^{\\mathrm{aug}}$, $\\langle r^{2} \\rangle_{\\mathrm{attach}}^{\\mathrm{noaug}}$, $f_{\\mathrm{diffuse}}^{\\mathrm{noaug}}$, $\\Delta r^{2}$, and the classification integer—are compiled for each case.\n\nThis systematic application of fundamental quantum chemical principles to the provided data yields a deterministic and verifiable solution.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to solve the quantum chemistry problem for all test cases.\n    \"\"\"\n    \n    test_cases = [\n        # Case 1 (happy path, strongly Rydberg under augmentation)\n        {\n            \"alpha_v\": [1.6, 0.5], \"alpha_d\": [0.08, 0.03],\n            \"c_occ_aug\": [0.8, 1.0, 0.05, 0.02],\n            \"c_virt_aug\": [0.1, 0.2, 1.0, 0.9],\n            \"r2_cut\": 8.0, \"f_cut\": 0.6\n        },\n        # Case 2 (valence-like virtual, augmentation present but unimportant)\n        {\n            \"alpha_v\": [1.6, 0.6], \"alpha_d\": [0.1],\n            \"c_occ_aug\": [0.9, 1.0, 0.0],\n            \"c_virt_aug\": [0.7, 0.8, 0.1],\n            \"r2_cut\": 6.0, \"f_cut\": 0.5\n        },\n        # Case 3 (borderline mixture of valence and diffuse character)\n        {\n            \"alpha_v\": [1.2, 0.4], \"alpha_d\": [0.08],\n            \"c_occ_aug\": [0.9, 1.1, 0.05],\n            \"c_virt_aug\": [0.45, 0.50, 0.45],\n            \"r2_cut\": 6.0, \"f_cut\": 0.5\n        },\n        # Case 4 (edge case with extremely diffuse augmentation)\n        {\n            \"alpha_v\": [1.8], \"alpha_d\": [0.02],\n            \"c_occ_aug\": [1.0, 0.01],\n            \"c_virt_aug\": [0.05, 1.0],\n            \"r2_cut\": 12.0, \"f_cut\": 0.8\n        },\n    ]\n\n    results = []\n    for case in test_cases:\n        case_results = process_case(case)\n        results.extend(case_results)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\ndef build_matrices(alphas):\n    \"\"\"\n    Constructs overlap (S) and second-moment-radius (R2) matrices.\n    \n    Args:\n        alphas (list of float): List of Gaussian exponents.\n        \n    Returns:\n        (np.ndarray, np.ndarray): The S and R2 matrices.\n    \"\"\"\n    n = len(alphas)\n    S = np.zeros((n, n))\n    R2 = np.zeros((n, n))\n    \n    for i in range(n):\n        for j in range(n):\n            ap = alphas[i]\n            aq = alphas[j]\n            \n            S_pq = (2 * np.sqrt(ap * aq) / (ap + aq))**1.5\n            R2_pq = S_pq * 1.5 / (ap + aq)\n            \n            S[i, j] = S_pq\n            R2[i, j] = R2_pq\n            \n    return S, R2\n\ndef normalize_coeffs(c, S):\n    \"\"\"Normalizes a coefficient vector with respect to the overlap matrix S.\"\"\"\n    norm_sq = c.T @ S @ c\n    if norm_sq = 0: # Should not happen with valid positive definite S\n        raise ValueError(\"Non-positive norm squared.\")\n    return c / np.sqrt(norm_sq)\n\ndef process_case(case_data):\n    \"\"\"\n    Processes a single test case according to the problem specification.\n    \n    Args:\n        case_data (dict): A dictionary containing all data for one test case.\n        \n    Returns:\n        list of float: The 6 result values for the case.\n    \"\"\"\n    alpha_v = case_data[\"alpha_v\"]\n    alpha_d = case_data[\"alpha_d\"]\n    c_occ_aug_unnorm = np.array(case_data[\"c_occ_aug\"])\n    c_virt_aug_unnorm = np.array(case_data[\"c_virt_aug\"])\n    r2_cut = case_data[\"r2_cut\"]\n    f_cut = case_data[\"f_cut\"]\n\n    n_v = len(alpha_v)\n    n_d = len(alpha_d)\n    M = n_v + n_d\n    \n    alpha_aug = alpha_v + alpha_d\n    \n    # 1. Build augmented basis matrices\n    S_aug, R2_aug = build_matrices(alpha_aug)\n\n    # Extract non-augmented (valence-only) sub-matrices\n    S_noaug = S_aug[:n_v, :n_v]\n    R2_noaug = R2_aug[:n_v, :n_v]\n    \n    # 2. Normalize both occupied and virtual orbitals (as per instructions)\n    # The occupied orbital calculations are performed for procedural completeness\n    # but are not used in the final output values.\n    _ = normalize_coeffs(c_occ_aug_unnorm, S_aug)\n    c_occ_noaug_unnorm = c_occ_aug_unnorm[:n_v]\n    if n_v > 0:\n        _ = normalize_coeffs(c_occ_noaug_unnorm, S_noaug)\n\n    # Process the virtual orbital for the required outputs\n    # Augmented case\n    c_virt_aug_norm = normalize_coeffs(c_virt_aug_unnorm, S_aug)\n    \n    # 3. Compute augmented-case metrics\n    r2_attach_aug = c_virt_aug_norm.T @ R2_aug @ c_virt_aug_norm\n    \n    # Denominator for f_diffuse is 1 due to normalization\n    norm_check_aug = c_virt_aug_norm.T @ S_aug @ c_virt_aug_norm\n    \n    # Numerator of f_diffuse\n    v_vec = S_aug @ c_virt_aug_norm\n    diffuse_indices = range(n_v, M)\n    f_diffuse_num = np.dot(c_virt_aug_norm[diffuse_indices], v_vec[diffuse_indices])\n    f_diffuse_aug = f_diffuse_num / norm_check_aug\n\n    # 4. Compute non-augmented case metrics\n    c_virt_noaug_unnorm = c_virt_aug_unnorm[:n_v]\n    if n_v > 0:\n        c_virt_noaug_norm = normalize_coeffs(c_virt_noaug_unnorm, S_noaug)\n        r2_attach_noaug = c_virt_noaug_norm.T @ R2_noaug @ c_virt_noaug_norm\n    else: # Should not happen based on test cases\n        r2_attach_noaug = 0.0\n\n    f_diffuse_noaug = 0.0\n    \n    # 5. Classify the excitation\n    is_rydberg = (r2_attach_aug >= r2_cut and f_diffuse_aug >= f_cut)\n    classification = 1 if is_rydberg else 0\n    \n    # 6. Compute delta r^2\n    delta_r2 = r2_attach_aug - r2_attach_noaug\n\n    return [\n        r2_attach_aug,\n        f_diffuse_aug,\n        r2_attach_noaug,\n        f_diffuse_noaug,\n        delta_r2,\n        classification\n    ]\n\nsolve()\n```", "id": "2916133"}]}