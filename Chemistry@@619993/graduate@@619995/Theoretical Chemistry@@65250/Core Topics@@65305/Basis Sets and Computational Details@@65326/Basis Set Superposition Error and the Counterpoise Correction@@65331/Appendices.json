{"hands_on_practices": [{"introduction": "The first step in mastering the counterpoise (CP) correction is to understand the relationships between the key energy terms. This exercise guides you through the fundamental derivation that connects the raw, uncorrected interaction energy, the Basis Set Superposition Error (BSSE) itself, and the final CP-corrected interaction energy. By performing this derivation and interpreting the results of a hypothetical scenario, you will solidify your understanding of why BSSE is an artificial stabilization and how the correction systematically removes it [@problem_id:2875570].", "problem": "A noncovalent dimer composed of monomers $A$ and $B$ is studied at a fixed geometry using the same atomic-orbital basis for all calculations. The raw interaction energy (computed as the supermolecular energy difference between the dimer and the isolated monomers, each optimized in their own monomer basis) is reported as $-4.5$ kcal/mol. Using the Boys–Bernardi counterpoise principle, the basis set superposition error (BSSE) correction for this dimer at the same geometry is evaluated to be $+1.2$ kcal/mol.\n\nStarting only from the fundamental definition of supermolecular interaction energy as the difference between the energy of the dimer and the sum of monomer energies, and from the conceptual definition of the counterpoise correction as the removal of artificial stabilization due to basis set sharing via “ghost” functions, derive how the counterpoise-corrected interaction energy relates to the uncorrected interaction energy and the BSSE correction. Then compute the counterpoise-corrected interaction energy from the data above. Finally, interpret the sign of both the correction and the corrected interaction energy in terms of binding strength and BSSE. Express the final energy in kcal/mol, and do not round.", "solution": "The problem presented is a standard exercise in computational quantum chemistry. A critical validation is required before any attempt at a solution is made.\n\nFirst, the givens of the problem statement are extracted verbatim.\n1.  The system is a noncovalent dimer of monomers $A$ and $B$ at a fixed geometry.\n2.  The raw interaction energy, defined as the supermolecular energy difference between the dimer and isolated, optimized monomers, is $E_{\\text{int}}^{\\text{raw}} = -4.5 \\, \\text{kcal/mol}$.\n3.  The Boys–Bernardi counterpoise correction for basis set superposition error (BSSE) is evaluated to be $\\delta_{\\text{BSSE}} = +1.2 \\, \\text{kcal/mol}$.\n\nNext, these givens are validated against criteria for scientific soundness and well-posedness.\nThe problem is scientifically grounded. The concepts of supermolecular interaction energy, Basis Set Superposition Error, and the counterpoise correction are fundamental and well-established within the framework of quantum chemistry, originating from the application of the variational principle to systems described by incomplete (finite) basis sets.\nThe problem is well-posed and self-contained. It provides all necessary definitions and numerical values to perform the requested derivation, calculation, and interpretation. The values themselves are physically realistic for a noncovalent dimer; a negative interaction energy signifies binding, and a positive BSSE correction value is the expected outcome, as the error is almost always stabilizing. The language used is objective and precise, using standard terminology.\nThe problem is not trivial, as it requires a correct derivation from first principles and a clear physical interpretation of the results.\n\nThe verdict is that the problem is valid. I will now proceed with the solution.\n\nThe task is to derive the relationship between the corrected interaction energy, the uncorrected interaction energy, and the BSSE correction, starting from their fundamental definitions.\n\nLet us define the energy terms. The basis set used for a given calculation is denoted by a superscript. Let $\\chi_A$ be the basis set centered on monomer $A$, and $\\chi_B$ be the basis set centered on monomer $B$. The supermolecular basis set is their union, $\\chi_{AB} = \\chi_A \\cup \\chi_B$.\n\nThe energy of the isolated monomer $A$ calculated with its own basis set $\\chi_A$ is $E_{A}^{\\chi_A}$.\nThe energy of the isolated monomer $B$ calculated with its own basis set $\\chi_B$ is $E_{B}^{\\chi_B}$.\nThe energy of the dimer $AB$ calculated with the full supermolecular basis set $\\chi_{AB}$ is $E_{AB}^{\\chi_{AB}}$.\n\nThe uncorrected, or raw, interaction energy, given as $E_{\\text{int}}^{\\text{raw}}$ in the problem and denoted here as $\\Delta E_{\\text{uncorr}}$, is defined as:\n$$\n\\Delta E_{\\text{uncorr}} = E_{AB}^{\\chi_{AB}} - (E_{A}^{\\chi_A} + E_{B}^{\\chi_B})\n$$\nThe problem states this value is $-4.5 \\, \\text{kcal/mol}$.\n\nThe Basis Set Superposition Error arises because in the dimer calculation of $E_{AB}^{\\chi_{AB}}$, monomer $A$ can \"borrow\" basis functions from $\\chi_B$, and monomer $B$ can borrow functions from $\\chi_A$. This allows each monomer fragment within the dimer to be described by a larger, more flexible basis set ($\\chi_{AB}$) than the isolated monomers, which are described only by their own basis sets ($\\chi_A$ and $\\chi_B$, respectively). According to the variational principle, a larger basis set leads to a lower (more negative) calculated energy. This leads to an artificial, non-physical stabilization of the dimer.\n\nThe counterpoise correction of Boys and Bernardi is designed to estimate and remove this artificial stabilization. This is done by calculating the energies of the individual monomers using the full supermolecular basis set $\\chi_{AB}$. To do this, one calculates the energy of monomer $A$ in the presence of the basis functions of $B$ (but not its nuclei or electrons), which are referred to as \"ghost functions\". This energy is denoted $E_{A}^{\\chi_{AB}}$. Similarly, the energy of monomer $B$ with the ghost functions of $A$ is $E_{B}^{\\chi_{AB}}$.\n\nThe counterpoise correction, $\\delta_{\\text{BSSE}}$, is the sum of the artificial stabilizations experienced by each monomer:\n$$\n\\delta_{\\text{BSSE}} = (E_{A}^{\\chi_A} - E_{A}^{\\chi_{AB}}) + (E_{B}^{\\chi_B} - E_{B}^{\\chi_{AB}})\n$$\nSince $E_{A}^{\\chi_{AB}} \\le E_{A}^{\\chi_A}$ and $E_{B}^{\\chi_{AB}} \\le E_{B}^{\\chi_B}$ due to the variational principle, the value of $\\delta_{\\text{BSSE}}$ is non-negative. It represents the magnitude of the unphysical stabilization. The problem states this correction is $+1.2 \\, \\text{kcal/mol}$.\n\nThe counterpoise-corrected interaction energy, $\\Delta E_{\\text{corr}}$, is defined such that the energies of the dimer and the constituent monomers are calculated on an \"equal footing,\" meaning they are all calculated with the same supermolecular basis set $\\chi_{AB}$:\n$$\n\\Delta E_{\\text{corr}} = E_{AB}^{\\chi_{AB}} - (E_{A}^{\\chi_{AB}} + E_{B}^{\\chi_{AB}})\n$$\nTo derive the relationship between $\\Delta E_{\\text{corr}}$, $\\Delta E_{\\text{uncorr}}$, and $\\delta_{\\text{BSSE}}$, we can rearrange the expression for $\\Delta E_{\\text{corr}}$ by adding and subtracting the term $(E_{A}^{\\chi_A} + E_{B}^{\\chi_B})$:\n$$\n\\Delta E_{\\text{corr}} = E_{AB}^{\\chi_{AB}} - (E_{A}^{\\chi_{AB}} + E_{B}^{\\chi_{AB}}) + (E_{A}^{\\chi_A} + E_{B}^{\\chi_B}) - (E_{A}^{\\chi_A} + E_{B}^{\\chi_B})\n$$\nRegrouping the terms:\n$$\n\\Delta E_{\\text{corr}} = \\left[ E_{AB}^{\\chi_{AB}} - (E_{A}^{\\chi_A} + E_{B}^{\\chi_B}) \\right] + \\left[ (E_{A}^{\\chi_A} + E_{B}^{\\chi_B}) - (E_{A}^{\\chi_{AB}} + E_{B}^{\\chi_{AB}}) \\right]\n$$\nThe first bracketed term is, by definition, the uncorrected interaction energy, $\\Delta E_{\\text{uncorr}}$. The second bracketed term can be rearranged as:\n$$\n(E_{A}^{\\chi_A} - E_{A}^{\\chi_{AB}}) + (E_{B}^{\\chi_B} - E_{B}^{\\chi_{AB}})\n$$\nThis is precisely the definition of the counterpoise correction, $\\delta_{\\text{BSSE}}$.\nTherefore, the derived relationship is:\n$$\n\\Delta E_{\\text{corr}} = \\Delta E_{\\text{uncorr}} + \\delta_{\\text{BSSE}}\n$$\nThis completes the derivation.\n\nNow, we compute the numerical value for the corrected interaction energy using the provided data:\n$\\Delta E_{\\text{uncorr}} = -4.5 \\, \\text{kcal/mol}$\n$\\delta_{\\text{BSSE}} = +1.2 \\, \\text{kcal/mol}$\n\n$$\n\\Delta E_{\\text{corr}} = -4.5 \\, \\text{kcal/mol} + 1.2 \\, \\text{kcal/mol} = -3.3 \\, \\text{kcal/mol}\n$$\n\nFinally, we interpret the signs and values.\n1.  **Sign of the BSSE correction ($\\delta_{\\text{BSSE}} = +1.2 \\, \\text{kcal/mol}$)**: The correction is positive. This signifies that the uncorrected calculation overestimates the binding energy of the dimer by $1.2 \\, \\text{kcal/mol}$. The raw interaction energy of $-4.5 \\, \\text{kcal/mol}$ is artificially low (too stable) due to the unphysical \"borrowing\" of basis functions between monomers. The positive sign indicates that this error is a stabilizing one, and the correction acts to reduce the magnitude of the binding energy, making the interaction less strong. This is the physically expected result for BSSE.\n\n2.  **Sign of the corrected interaction energy ($\\Delta E_{\\text{corr}} = -3.3 \\, \\text{kcal/mol}$)**: The corrected interaction energy is negative. In chemical thermodynamics, a negative energy of formation indicates a stabilizing interaction. Thus, the value of $-3.3 \\, \\text{kcal/mol}$ represents the \"true\" physical binding energy of the dimer $AB$ at the given geometry, after the artifact of basis set superposition has been removed. It confirms that the dimer is a bound complex, stable with respect to dissociation into its constituent monomers by an energy of $3.3 \\, \\text{kcal/mol}$. The uncorrected result suggested a binding energy of $4.5 \\, \\text{kcal/mol}$, but approximately $27\\%$ of this apparent stability ($1.2/4.5 \\approx 0.267$) was an artifact of the calculation method. The counterpoise correction provides a more physically meaningful estimate of the interaction strength.", "answer": "$$\\boxed{-3.3}$$", "id": "2875570"}, {"introduction": "Building on the foundational concepts, this practice moves to a complete calculation using realistic energy data from a computational chemistry output. You are given a set of energies for the water dimer, calculated at two different levels of theory, to see how the uncorrected and CP-corrected interaction energies are derived from their constituent parts: the dimer energy and the various monomer energies (both with and without \"ghost\" basis functions). This exercise provides a concrete numerical feel for the magnitude of BSSE and demonstrates the important principle that the size of this error depends on the chosen theoretical method [@problem_id:2875497].", "problem": "A water dimer interaction is computed at two levels of electronic structure theory using the correlation-consistent polarized valence double-zeta basis (cc-pVDZ): Møller–Plesset second order (MP2) and Coupled Cluster with Singles, Doubles, and perturbative Triples (CCSD(T)). The supermolecular interaction energy is defined as the difference between the dimer total electronic energy and the sum of the isolated monomer total electronic energies, all in Hartree. Basis set superposition error arises because in a finite basis each monomer in the dimer can variationally lower its energy by borrowing basis functions from the partner monomer. The Boys–Bernardi counterpoise correction replaces the monomer energies with monomer-in-dimer-basis energies, where the partner’s basis functions are included as unoccupied “ghost” functions.\n\nYou are given the following total electronic energies, each computed at the specified level with cc-pVDZ:\n\n- At MP2:\n  - Dimer energy in the dimer basis: $E_{AB}^{AB} = -152.064220$.\n  - Monomer energies in their own monomer bases: $E_{A}^{A} = -76.026760$, $E_{B}^{B} = -76.026760$.\n  - Monomer-in-dimer-basis energies (ghost calculations): $E_{A}^{AB} = -76.028600$, $E_{B}^{AB} = -76.028320$.\n\n- At CCSD(T):\n  - Dimer energy in the dimer basis: $E_{AB}^{AB} = -152.226100$.\n  - Monomer energies in their own monomer bases: $E_{A}^{A} = -76.108150$, $E_{B}^{B} = -76.108150$.\n  - Monomer-in-dimer-basis energies (ghost calculations): $E_{A}^{AB} = -76.109300$, $E_{B}^{AB} = -76.108900$.\n\nUsing only the supermolecular definition of the interaction energy, the notion of ghost basis functions, and the idea that the counterpoise-corrected interaction energy replaces monomer energies by their monomer-in-dimer-basis counterparts, do the following at each level (MP2 and CCSD(T)):\n\n1. Compute the uncorrected interaction energy (without counterpoise).\n2. Compute the counterpoise-corrected interaction energy.\n3. Define the overbinding due to basis set superposition error as the excess in the magnitude of the uncorrected interaction energy relative to the counterpoise-corrected interaction energy. Then compute the fraction of overbinding removed by counterpoise as the ratio of this excess to the magnitude of the uncorrected interaction energy.\n\nExpress each result for the fraction of overbinding removed as a unitless decimal fraction. Round your two results to four significant figures. Provide your final answer in the order $(\\text{MP2}, \\text{CCSD(T)})$.", "solution": "The problem presented is a standard exercise in computational quantum chemistry and is scientifically sound, well-posed, objective, and contains all necessary information for a complete solution. Therefore, we proceed with the analysis.\n\nThe fundamental quantities are the uncorrected and counterpoise-corrected interaction energies. Let the superscripts on an energy term $E$ denote the basis set used for the calculation, and let the subscripts denote the molecular system. The basis set for a monomer $A$ is denoted $A$, and the basis set for the dimer $AB$ is the union of monomer basis sets, also denoted $AB$.\n\nThe uncorrected supermolecular interaction energy, $\\Delta E_{\\text{uncorr}}$, is defined as the difference between the total energy of the dimer $AB$ calculated in the full dimer basis, $E_{AB}^{AB}$, and the sum of the energies of the isolated monomers $A$ and $B$, each calculated in its own basis, $E_{A}^{A}$ and $E_{B}^{B}$ respectively.\n$$\n\\Delta E_{\\text{uncorr}} = E_{AB}^{AB} - (E_{A}^{A} + E_{B}^{B})\n$$\n\nThe basis set superposition error (BSSE) arises because in the dimer calculation, monomer $A$ can \"borrow\" basis functions from monomer $B$ to lower its energy, and vice-versa. This is an artifact of using an incomplete, finite basis set. The Boys–Bernardi counterpoise correction attempts to correct for this. The counterpoise-corrected interaction energy, $\\Delta E_{\\text{corr}}$, is calculated using monomer energies computed in the full dimer basis. This is achieved by performing calculations on each monomer in the presence of the \"ghost\" basis functions of the partner monomer, but without its nuclei or electrons. These energies are denoted $E_{A}^{AB}$ and $E_{B}^{AB}$.\n$$\n\\Delta E_{\\text{corr}} = E_{AB}^{AB} - (E_{A}^{AB} + E_{B}^{AB})\n$$\n\nThe overbinding due to BSSE is defined as the difference in the magnitudes of the uncorrected and corrected interaction energies. Since interaction energies for bound complexes are negative, the magnitude is $|\\Delta E|$.\n$$\n\\text{Overbinding} = |\\Delta E_{\\text{uncorr}}| - |\\Delta E_{\\text{corr}}|\n$$\nThe fraction of overbinding removed, which we will denote as $F$, is the ratio of this overbinding to the magnitude of the uncorrected interaction energy.\n$$\nF = \\frac{|\\Delta E_{\\text{uncorr}}| - |\\Delta E_{\\text{corr}}|}{|\\Delta E_{\\text{uncorr}}|} = 1 - \\frac{|\\Delta E_{\\text{corr}}|}{|\\Delta E_{\\text{uncorr}}|}\n$$\nWe will now compute this fraction for the two specified levels of theory.\n\nFirst, for the MP2/cc-pVDZ level of theory:\nThe given energies are:\n$E_{AB}^{AB} = -152.064220$\n$E_{A}^{A} = -76.026760$\n$E_{B}^{B} = -76.026760$\n$E_{A}^{AB} = -76.028600$\n$E_{B}^{AB} = -76.028320$\n\nThe uncorrected interaction energy is:\n$$\n\\Delta E_{\\text{uncorr}}(\\text{MP2}) = -152.064220 - (-76.026760 - 76.026760) = -152.064220 + 152.053520 = -0.010700 \\, \\text{Hartree}\n$$\nThe corrected interaction energy is:\n$$\n\\Delta E_{\\text{corr}}(\\text{MP2}) = -152.064220 - (-76.028600 - 76.028320) = -152.064220 + 152.056920 = -0.007300 \\, \\text{Hartree}\n$$\nNow, we compute the fraction of overbinding removed:\n$$\nF(\\text{MP2}) = \\frac{|-0.010700| - |-0.007300|}{|-0.010700|} = \\frac{0.010700 - 0.007300}{0.010700} = \\frac{0.003400}{0.010700} \\approx 0.317757\n$$\nRounding to four significant figures, we get $F(\\text{MP2}) = 0.3178$.\n\nSecond, for the CCSD(T)/cc-pVDZ level of theory:\nThe given energies are:\n$E_{AB}^{AB} = -152.226100$\n$E_{A}^{A} = -76.108150$\n$E_{B}^{B} = -76.108150$\n$E_{A}^{AB} = -76.109300$\n$E_{B}^{AB} = -76.108900$\n\nThe uncorrected interaction energy is:\n$$\n\\Delta E_{\\text{uncorr}}(\\text{CCSD(T)}) = -152.226100 - (-76.108150 - 76.108150) = -152.226100 + 152.216300 = -0.009800 \\, \\text{Hartree}\n$$\nThe corrected interaction energy is:\n$$\n\\Delta E_{\\text{corr}}(\\text{CCSD(T)}) = -152.226100 - (-76.109300 - 76.108900) = -152.226100 + 152.218200 = -0.007900 \\, \\text{Hartree}\n$$\nNow, we compute the fraction of overbinding removed:\n$$\nF(\\text{CCSD(T)}) = \\frac{|-0.009800| - |-0.007900|}{|-0.009800|} = \\frac{0.009800 - 0.007900}{0.009800} = \\frac{0.001900}{0.009800} \\approx 0.193877\n$$\nRounding to four significant figures, we get $F(\\text{CCSD(T)}) = 0.1939$.\n\nThe final results for the fraction of overbinding removed are $0.3178$ for MP2 and $0.1939$ for CCSD(T). The problem asks for the final answer in the order $(\\text{MP2}, \\text{CCSD(T)})$.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.3178 & 0.1939\n\\end{pmatrix}\n}\n$$", "id": "2875497"}, {"introduction": "The final and most comprehensive practice bridges the gap between theoretical understanding and practical implementation by automating the entire computational workflow. Successfully running a counterpoise correction requires generating precise and reproducible input files for quantum chemistry software. This exercise challenges you to write a program that assembles molecular geometries, constructs the three necessary input files (dimer, monomer-in-dimer-basis, and vice-versa) using the \"ghost atom\" syntax, and processes the resulting energies to yield a final, corrected interaction energy [@problem_id:2762232]. This is the ultimate hands-on test of your understanding of the end-to-end CP correction procedure.", "problem": "Write a complete program that constructs a reproducible, automated workflow for computing the counterpoise-corrected interaction energy using ghost basis functions for two-body complexes. The program must: (i) assemble reproducible monomer and dimer geometries from given monomer coordinates and a rigid translation for one monomer, (ii) generate three text inputs per case in a clearly defined pseudo-quantum-chemistry format (full dimer, monomer A with monomer B ghosted, monomer B with monomer A ghosted), and (iii) compute the counterpoise-corrected interaction energy from supplied total energies. Your implementation must be principled and grounded in first principles of electronic structure theory.\n\nUse the following fundamental base to motivate and design the algorithm:\n- Under the Born–Oppenheimer approximation, the electronic ground-state energy is obtained by minimizing the Rayleigh–Ritz functional over a finite basis representation, which implies that increasing the basis set monotonically lowers the variational energy due to the variational principle.\n- When two subsystems are brought together, a finite basis set for the composite permits each monomer to variationally “borrow” functions centered on the other monomer, which is known as Basis Set Superposition Error (BSSE).\n- The counterpoise procedure with ghost basis functions formalizes monomer-in-dimer-basis energies by placing basis functions on nuclei that contribute no electrons and no nuclear attraction (ghost atoms), evaluated at the same nuclear coordinates as in the dimer geometry.\n\nYour program should therefore:\n- Accept, for each test case, Cartesian coordinates for monomer A and monomer B in angstroms and a rigid translation vector (no rotation) applied to monomer B to form the dimer geometry. All atom coordinates are three-dimensional tuples. The charge and spin multiplicity for each species are also given.\n- Generate three text inputs (not written to disk; it is sufficient to construct strings in memory):\n    1. Full dimer input with both monomer geometries combined at the specified positions.\n    2. Monomer A input in the dimer basis, where monomer B appears as ghost atoms.\n    3. Monomer B input in the dimer basis, where monomer A appears as ghost atoms.\n  Use the following unambiguous pseudo-format for every generated input:\n    - First line: the literal text “molecule &lt;name&gt;”\n    - Second line: “charge &lt;q&gt; mult &lt{m}&gt; basis &lt;label&gt;” where the basis label is an arbitrary string.\n    - Subsequent lines: one atom per line as “&lt;symbol&gt; &lt;x&gt; &lt;y&gt; &lt;z&gt;” with angstrom coordinates. A ghost atom must be denoted by prefixing its symbol with the literal “Gh:” (for example, “Gh:O”).\n- Compute, for each test case, the counterpoise-corrected interaction energy using the following data provided per case:\n    - Total energy of the dimer in the full dimer basis (in hartree).\n    - Total energy of monomer A computed in the dimer basis with monomer B ghosts (in hartree).\n    - Total energy of monomer B computed in the dimer basis with monomer A ghosts (in hartree).\n- Convert the final counterpoise-corrected interaction energy to kilojoules per mole using the exact factor $2625.49962\\,\\mathrm{kJ\\,mol^{-1}\\,E_h^{-1}}$, and round to three decimal places. Report only the counterpoise-corrected interaction energy for each test case.\n\nTest suite and parameters to implement:\n- Case 1 (happy path, hydrogen-bonded dimer):\n  - Monomer A (water): atoms with coordinates in angstrom\n    - $\\mathrm{O}\\ (0.000000,\\,0.000000,\\,0.000000)$\n    - $\\mathrm{H}\\ (0.957200,\\,0.000000,\\,0.000000)$\n    - $\\mathrm{H}\\ (-0.239987,\\,0.927297,\\,0.000000)$\n  - Monomer B (water): identical coordinates as above, translation vector for B is $(0.000000,\\,0.000000,\\,2.900000)$.\n  - Charge and multiplicity for all molecules: $q=0$, $m=1$.\n  - Energies (in hartree):\n    - Dimer in dimer basis: $-152.792000$\n    - Monomer A in dimer basis (ghosted B): $-76.392345$\n    - Monomer B in dimer basis (ghosted A): $-76.391500$\n- Case 2 (boundary: large separation, very weak interaction):\n  - Monomer A (neon atom): $\\mathrm{Ne}\\ (0.000000,\\,0.000000,\\,0.000000)$\n  - Monomer B (neon atom): identical, translation vector for B is $(0.000000,\\,0.000000,\\,8.000000)$.\n  - Charge and multiplicity: $q=0$, $m=1$ for all.\n  - Energies (in hartree):\n    - Dimer in dimer basis: $-257.094250$\n    - Monomer A in dimer basis (ghosted B): $-128.547100$\n    - Monomer B in dimer basis (ghosted A): $-128.547100$\n- Case 3 (edge: minimal-basis-like strong BSSE scenario):\n  - Monomer A (ammonia): atoms with coordinates in angstrom\n    - $\\mathrm{N}\\ (0.000000,\\,0.000000,\\,0.000000)$\n    - $\\mathrm{H}\\ (0.000000,\\,0.937700,\\,-0.381600)$\n    - $\\mathrm{H}\\ (-0.812100,\\,-0.468900,\\,-0.381600)$\n    - $\\mathrm{H}\\ (0.812100,\\,-0.468900,\\,-0.381600)$\n  - Monomer B (ammonia): identical coordinates as above, translation vector for B is $(0.000000,\\,0.000000,\\,3.000000)$.\n  - Charge and multiplicity: $q=0$, $m=1$ for all.\n  - Energies (in hartree):\n    - Dimer in dimer basis: $-112.485500$\n    - Monomer A in dimer basis (ghosted B): $-56.234000$\n    - Monomer B in dimer basis (ghosted A): $-56.233500$\n\nProgram specification and output format:\n- Hard-code the above test suite within the program; do not read external input or write files.\n- Implement deterministic geometry assembly and input string generation following the pseudo-format and ghosting rule stated above to ensure reproducibility.\n- For each test case, compute the counterpoise-corrected interaction energy in $\\mathrm{kJ\\,mol^{-1}}$ with three decimal places.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, for example: “[$x_1,x_2,x_3$]”, where each $x_i$ is the rounded float for one test case in $\\mathrm{kJ\\,mol^{-1}}$.", "solution": "The design proceeds from the variational principle and definitions of basis-restricted energies. Under the Born–Oppenheimer approximation, for fixed nuclear coordinates, the nonrelativistic electronic Hamiltonian $\\hat{H}$ admits a ground-state energy that is the minimum of the Rayleigh–Ritz functional $E[\\Psi]=\\langle \\Psi \\vert \\hat{H} \\vert \\Psi \\rangle/\\langle \\Psi \\vert \\Psi \\rangle$ over admissible wave functions $\\Psi$. In a finite basis representation, the approximate ground-state energy $E^{\\mathcal{B}}$ decreases monotonically as the basis $\\mathcal{B}$ is enlarged. For two subsystems $A$ and $B$, the basis set superposition error (BSSE) arises because, when computing the dimer energy in the combined basis $\\mathcal{B}_{AB}=\\mathcal{B}_A \\cup \\mathcal{B}_B$, the space available to variationally lower the energy is larger than for each monomer in its own basis. If one forms an interaction energy by subtracting monomer energies obtained in their respective monomeric bases, the result is biased toward overbinding because the dimer is “helped” by basis functions on both monomers, while the monomers are not.\n\nThe counterpoise idea replaces the monomer calculations by monomer-in-dimer-basis calculations at the dimer geometry: one computes $E_A^{AB}$, the energy of monomer $A$ with electrons and nuclei of $A$ only, but with the basis $\\mathcal{B}_{AB}$ that includes functions centered on $B$ as “ghosts” that contribute no electrons and no nuclear attraction. Analogously, one computes $E_B^{AB}$. These two are evaluated at the same nuclear coordinates as in the dimer geometry to ensure a like-for-like comparison. Denoting the full dimer energy in the dimer basis as $E_{AB}^{AB}$, the counterpoise-corrected interaction energy is obtained by subtracting the monomer-in-dimer-basis energies from the dimer energy. This follows from the definition of an interaction energy as the change in energy upon bringing $A$ and $B$ together at fixed geometry within the same variational space; the latter requirement is enforced by using the same basis set $\\mathcal{B}_{AB}$ for all three energies.\n\nAlgorithmically:\n1. Geometry assembly. We are given Cartesian coordinates (angstrom) for monomer $A$ as a list $\\{(\\mathrm{sym}_i, x_i, y_i, z_i)\\}$ and for monomer $B$ as $\\{(\\mathrm{sym}_j, x'_j, y'_j, z'_j)\\}$. A rigid translation vector $\\mathbf{t}=(t_x,t_y,t_z)$ is provided for $B$. The dimer geometry is the concatenation of monomer $A$’s coordinates and translated monomer $B$’s coordinates $\\{(\\mathrm{sym}_j, x'_j+t_x, y'_j+t_y, z'_j+t_z)\\}$. The process is deterministic and hence reproducible. No rotations are applied in this problem, so no angles are needed.\n2. Input generation. For a given basis label (an arbitrary string) and charge $q$ and multiplicity $m$, we generate three strings:\n   - Dimer AB: header lines “molecule AB”, “charge $q$ mult $m$ basis &lt;label&gt;”, then all dimer atoms, each as “symbol x y z”.\n   - Monomer A in dimer basis: header “molecule A_in_AB_basis”, same “charge $q$ mult $m$ basis &lt;label&gt;”, then atoms of $A$ as real atoms and atoms of $B$ prefixed with “Gh:” to denote ghosts, using the same coordinates as in the dimer geometry.\n   - Monomer B in dimer basis: header “molecule B_in_AB_basis”, and vice versa, $B$ real and $A$ ghosted.\n   This reproduces the conceptual counterpoise inputs: the ghost atoms provide basis functions without electrons or nuclear attraction.\n3. Energy computation. For each case, we are given three scalar energies in hartree: $E_{AB}^{AB}$, $E_{A}^{AB}$, and $E_{B}^{AB}$. The counterpoise-corrected interaction energy in hartree is\n   $$\\Delta E_{\\mathrm{CP}} = E_{AB}^{AB} - E_{A}^{AB} - E_{B}^{AB}.$$\n   The conversion to kilojoules per mole uses the factor $f=2625.49962\\,\\mathrm{kJ\\,mol^{-1}\\,E_h^{-1}}$, yielding\n   $$\\Delta E_{\\mathrm{CP}}^{(\\mathrm{kJ/mol})} = f \\times \\Delta E_{\\mathrm{CP}}.$$\n   We then round to three decimal places.\n4. Determinism. Because the assembly is a pure concatenation with a fixed translation, and the input format is specified unambiguously (including the “Gh:” prefix for ghosts), the workflow is reproducible. No random choices are present.\n\nApplying this to the test suite:\n- Case $1$ (water dimer):\n  $$\\Delta E_{\\mathrm{CP}} = (-152.792000) - (-76.392345) - (-76.391500) = -0.008155\\ \\mathrm{E_h},$$\n  $$\\Delta E_{\\mathrm{CP}}^{(\\mathrm{kJ/mol})} = 2625.49962 \\times (-0.008155) \\approx -21.410949 \\ \\Rightarrow\\ \\text{rounded to } -21.411.$$\n- Case $2$ (neon dimer, large separation):\n  $$\\Delta E_{\\mathrm{CP}} = (-257.094250) - (-128.547100) - (-128.547100) = -0.000050\\ \\mathrm{E_h},$$\n  $$\\Delta E_{\\mathrm{CP}}^{(\\mathrm{kJ/mol})} = 2625.49962 \\times (-0.000050) \\approx -0.131275 \\ \\Rightarrow\\ \\text{rounded to } -0.131.$$\n- Case $3$ (ammonia dimer, strong BSSE-like):\n  $$\\Delta E_{\\mathrm{CP}} = (-112.485500) - (-56.234000) - (-56.233500) = -0.018000\\ \\mathrm{E_h},$$\n  $$\\Delta E_{\\mathrm{CP}}^{(\\mathrm{kJ/mol})} = 2625.49962 \\times (-0.018000) \\approx -47.258993 \\ \\Rightarrow\\ \\text{rounded to } -47.259.$$\n\nThe program should therefore output a single line:\n[-21.411,-0.131,-47.259]", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Execution environment: Python 3.12, standard library only (numpy/scipy optional but not required).\n# This script constructs ghosted inputs and computes CP-corrected interaction energies for given test cases.\n\nHARTREE_TO_KJ_MOL = 2625.49962  # kJ/mol per Eh\n\nfrom dataclasses import dataclass\nfrom typing import List, Tuple\n\n@dataclass(frozen=True)\nclass Atom:\n    symbol: str\n    x: float\n    y: float\n    z: float\n\n@dataclass(frozen=True)\nclass Monomer:\n    label: str\n    charge: int\n    multiplicity: int\n    atoms: List[Atom]\n\n@dataclass(frozen=True)\nclass TestCase:\n    name: str\n    basis_label: str\n    monomer_A: Monomer\n    monomer_B: Monomer\n    translation_B: Tuple[float, float, float]  # translation applied to monomer B\n    E_AB_AB: float  # Hartree\n    E_A_AB: float   # Hartree (monomer A in dimer basis, B ghosted)\n    E_B_AB: float   # Hartree (monomer B in dimer basis, A ghosted)\n\ndef translate_atoms(atoms: List[Atom], t: Tuple[float, float, float]) -> List[Atom]:\n    tx, ty, tz = t\n    return [Atom(a.symbol, a.x + tx, a.y + ty, a.z + tz) for a in atoms]\n\ndef build_dimer_geometry(mA: Monomer, mB: Monomer, tB: Tuple[float, float, float]) -> List[Atom]:\n    # Deterministic concatenation: A atoms first, then translated B atoms\n    b_translated = translate_atoms(mB.atoms, tB)\n    return list(mA.atoms) + b_translated\n\ndef generate_input_string(name: str, charge: int, mult: int, basis: str, real_atoms: List[Atom], ghost_atoms: List[Atom]) -> str:\n    # Pseudo-format as specified\n    lines = []\n    lines.append(f\"molecule {name}\")\n    lines.append(f\"charge {charge} mult {mult} basis {basis}\")\n    for a in real_atoms:\n        lines.append(f\"{a.symbol} {a.x:.6f} {a.y:.6f} {a.z:.6f}\")\n    for g in ghost_atoms:\n        lines.append(f\"Gh:{g.symbol} {g.x:.6f} {g.y:.6f} {g.z:.6f}\")\n    return \"\\n\".join(lines)\n\ndef build_counterpoise_inputs(case: TestCase) -> Tuple[str, str, str]:\n    # Dimer geometry\n    dimer_atoms = build_dimer_geometry(case.monomer_A, case.monomer_B, case.translation_B)\n    # Split back to A (real) and B (translated) for ghost constructions\n    nA = len(case.monomer_A.atoms)\n    atoms_A_real = dimer_atoms[:nA]\n    atoms_B_real = dimer_atoms[nA:]\n    # Build three inputs\n    input_AB = generate_input_string(\n        name=\"AB\",\n        charge=case.monomer_A.charge + case.monomer_B.charge,\n        mult=case.monomer_A.multiplicity,  # both are singlets in test suite\n        basis=case.basis_label,\n        real_atoms=dimer_atoms,\n        ghost_atoms=[]\n    )\n    input_A_in_AB = generate_input_string(\n        name=\"A_in_AB_basis\",\n        charge=case.monomer_A.charge,\n        mult=case.monomer_A.multiplicity,\n        basis=case.basis_label,\n        real_atoms=atoms_A_real,\n        ghost_atoms=atoms_B_real\n    )\n    input_B_in_AB = generate_input_string(\n        name=\"B_in_AB_basis\",\n        charge=case.monomer_B.charge,\n        mult=case.monomer_B.multiplicity,\n        basis=case.basis_label,\n        real_atoms=atoms_B_real,\n        ghost_atoms=atoms_A_real\n    )\n    return input_AB, input_A_in_AB, input_B_in_AB\n\ndef delta_E_cp_kjmol(E_AB_AB: float, E_A_AB: float, E_B_AB: float) -> float:\n    delta_E_hartree = E_AB_AB - E_A_AB - E_B_AB\n    return delta_E_hartree * HARTREE_TO_KJ_MOL\n\ndef solve():\n    # Define monomer coordinates and test cases as specified\n    water_atoms = [\n        Atom(\"O\", 0.000000, 0.000000, 0.000000),\n        Atom(\"H\", 0.957200, 0.000000, 0.000000),\n        Atom(\"H\", -0.239987, 0.927297, 0.000000),\n    ]\n    neon_atoms = [Atom(\"Ne\", 0.000000, 0.000000, 0.000000)]\n    ammonia_atoms = [\n        Atom(\"N\", 0.000000, 0.000000, 0.000000),\n        Atom(\"H\", 0.000000, 0.937700, -0.381600),\n        Atom(\"H\", -0.812100, -0.468900, -0.381600),\n        Atom(\"H\", 0.812100, -0.468900, -0.381600),\n    ]\n\n    monomer_water = Monomer(\"H2O\", 0, 1, water_atoms)\n    monomer_neon = Monomer(\"Ne\", 0, 1, neon_atoms)\n    monomer_ammonia = Monomer(\"NH3\", 0, 1, ammonia_atoms)\n\n    test_cases = [\n        TestCase(\n            name=\"Water_dimer\",\n            basis_label=\"def2-SVP\",\n            monomer_A=monomer_water,\n            monomer_B=monomer_water,\n            translation_B=(0.000000, 0.000000, 2.900000),\n            E_AB_AB=-152.792000,\n            E_A_AB=-76.392345,\n            E_B_AB=-76.391500\n        ),\n        TestCase(\n            name=\"Neon_dimer_far\",\n            basis_label=\"def2-SVP\",\n            monomer_A=monomer_neon,\n            monomer_B=monomer_neon,\n            translation_B=(0.000000, 0.000000, 8.000000),\n            E_AB_AB=-257.094250,\n            E_A_AB=-128.547100,\n            E_B_AB=-128.547100\n        ),\n        TestCase(\n            name=\"Ammonia_dimer\",\n            basis_label=\"MIN\",\n            monomer_A=monomer_ammonia,\n            monomer_B=monomer_ammonia,\n            translation_B=(0.000000, 0.000000, 3.000000),\n            E_AB_AB=-112.485500,\n            E_A_AB=-56.234000,\n            E_B_AB=-56.233500\n        ),\n    ]\n\n    results = []\n    # Also build the ghosted inputs (not printed) to satisfy the workflow requirement\n    for case in test_cases:\n        _ab, _a_in_ab, _b_in_ab = build_counterpoise_inputs(case)\n        # In a real workflow, these strings would be written to files and submitted to a QC engine.\n        # Here, we only compute the CP-corrected interaction energy from provided totals.\n        value_kjmol = delta_E_cp_kjmol(case.E_AB_AB, case.E_A_AB, case.E_B_AB)\n        # Round to three decimals for output\n        results.append(f\"{value_kjmol:.3f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "2762232"}]}