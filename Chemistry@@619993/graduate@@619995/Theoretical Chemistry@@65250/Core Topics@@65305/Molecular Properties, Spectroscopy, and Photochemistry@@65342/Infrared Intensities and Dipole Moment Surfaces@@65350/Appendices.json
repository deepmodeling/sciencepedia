{"hands_on_practices": [{"introduction": "To build a robust understanding of infrared intensities, we begin with the simplest non-trivial model: a diatomic molecule treated as a quantum harmonic oscillator. This exercise explores how the intensity of the fundamental vibrational transition arises from the change in the molecule's dipole moment with bond distance. By working through the quantum mechanics of the double-harmonic approximation—a harmonic potential and a linear dipole moment surface—you will derive the direct link between the slope of the dipole moment surface and the observable line strength [@problem_id:2779261]. This forms the bedrock of our understanding of what makes a vibration IR-active and how strong it is.", "problem": "A linear diatomic molecule undergoes small-amplitude vibrations along its bond axis. Let the vibrational coordinate be the scalar displacement from equilibrium, denoted by $Q$, and let the reduced mass be $\\mu$. The vibrational Hamiltonian is taken to be the harmonic oscillator with potential $V(Q)=\\tfrac{1}{2} k Q^{2}$, where $k$ is the force constant. The dipole moment surface (DMS) along $Q$ is linear, $\\mu(Q)=\\mu_{0}+a\\,Q$, where $\\mu_{0}$ is a constant and $a$ is the slope of the DMS. Consider the fundamental vibrational transition from $v=0$ to $v=1$.\n\nStarting from the definitions of the harmonic oscillator and the definition of the vibrational line strength as the squared transition dipole moment,\n$$\nS_{01}=\\left|\\langle 0|\\mu(Q)|1\\rangle\\right|^{2},\n$$\nderive a closed-form expression for $S_{01}$ in terms of $a$, $\\mu$, $k$, and $\\hbar$ only. Treat the molecule as strictly linear and neglect rotational structure and any anharmonicity beyond the given potential. Take the vibrational frequency to be that implied by the harmonic Hamiltonian and the reduced mass.\n\nExpress your final answer as a single analytical expression. Report $S_{01}$ in International System of Units (SI) as a quantity with units of squared dipole moment $(\\text{C m})^{2}$, but do not include the units in your final boxed expression. Finally, based on your expression, state the power-law dependence of $S_{01}$ on the reduced mass $\\mu$ when $a$ and $k$ are held fixed. The final boxed answer must be the analytical expression for $S_{01}$ only.", "solution": "The problem statement is first subjected to validation.\n\nGivens extracted verbatim are:\n-   System: A linear diatomic molecule.\n-   Motion: Small-amplitude vibrations along its bond axis.\n-   Coordinate: Vibrational coordinate is the scalar displacement from equilibrium, $Q$.\n-   Mass: Reduced mass is $\\mu$.\n-   Hamiltonian: Vibrational Hamiltonian is the harmonic oscillator with potential $V(Q)=\\tfrac{1}{2} k Q^{2}$.\n-   Force constant: $k$.\n-   Dipole Moment Surface (DMS): $\\mu(Q)=\\mu_{0}+a\\,Q$, where $\\mu_{0}$ is a constant and $a$ is the slope.\n-   Transition: Fundamental vibrational transition from $v=0$ to $v=1$.\n-   Line Strength Definition: $S_{01}=\\left|\\langle 0|\\mu(Q)|1\\rangle\\right|^{2}$.\n-   Objective: Derive a closed-form expression for $S_{01}$ in terms of $a$, $\\mu$, $k$, and $\\hbar$.\n-   Constraints: Treat as strictly linear, neglect rotational structure and anharmonicity. The vibrational frequency is that implied by the harmonic Hamiltonian.\n\nValidation Verdict:\nThe problem is scientifically grounded, well-posed, and objective. It is a standard problem in quantum mechanics and molecular spectroscopy, based on the harmonic oscillator and linear dipole moment approximations. All necessary information is provided, and the problem is internally consistent and formalizable. No flaws are identified. The problem is valid.\n\nWe now proceed to the derivation of the line strength, $S_{01}$.\n\nThe line strength for the fundamental vibrational transition from the ground state $|0\\rangle$ to the first excited state $|1\\rangle$ is defined as the squared magnitude of the transition dipole moment:\n$$\nS_{01} = \\left|\\langle 0|\\mu(Q)|1\\rangle\\right|^{2}\n$$\nThe dipole moment operator, $\\mu(Q)$, is given as a linear function of the vibrational coordinate $Q$:\n$$\n\\mu(Q) = \\mu_{0} + a\\,Q\n$$\nSubstituting this expression into the matrix element gives:\n$$\n\\langle 0|\\mu(Q)|1\\rangle = \\langle 0|\\mu_{0} + a\\,Q|1\\rangle = \\mu_{0}\\langle 0|1\\rangle + a\\langle 0|Q|1\\rangle\n$$\nThe vibrational states $|v\\rangle$ are the eigenstates of the harmonic oscillator Hamiltonian. These states are orthogonal, meaning their inner product is $\\langle v|v'\\rangle = \\delta_{vv'}$, where $\\delta_{vv'}$ is the Kronecker delta. For the transition from $v=0$ to $v=1$, the orthogonality condition implies $\\langle 0|1\\rangle = 0$. Consequently, the first term vanishes:\n$$\n\\mu_{0}\\langle 0|1\\rangle = 0\n$$\nThis is the well-known selection rule that for a harmonic oscillator, a permanent dipole moment $\\mu_0$ does not contribute to vibrational transitions; only the change in dipole moment with displacement, represented by the slope $a$, can induce a transition.\n\nThe line strength expression simplifies to:\n$$\nS_{01} = |a\\langle 0|Q|1\\rangle|^{2} = a^{2}|\\langle 0|Q|1\\rangle|^{2}\n$$\nTo evaluate the matrix element $\\langle 0|Q|1\\rangle$, we express the position operator $Q$ in terms of the annihilation ($a$) and creation ($a^{\\dagger}$) ladder operators for the quantum harmonic oscillator. The relation is:\n$$\nQ = \\sqrt{\\frac{\\hbar}{2\\mu\\omega}} (a + a^{\\dagger})\n$$\nwhere $\\omega$ is the angular frequency of the oscillator. The problem specifies that this frequency is determined by the harmonic Hamiltonian, so $\\omega = \\sqrt{k/\\mu}$. The ladder operators act on the number states $|v\\rangle$ as follows:\n$$\na|v\\rangle = \\sqrt{v}|v-1\\rangle \\quad (\\text{for } v > 0); \\quad a|0\\rangle = 0\n$$\n$$\na^{\\dagger}|v\\rangle = \\sqrt{v+1}|v+1\\rangle\n$$\nNow we compute the matrix element $\\langle 0|Q|1\\rangle$:\n$$\n\\langle 0|Q|1\\rangle = \\left\\langle 0\\left| \\sqrt{\\frac{\\hbar}{2\\mu\\omega}} (a + a^{\\dagger}) \\right|1\\right\\rangle = \\sqrt{\\frac{\\hbar}{2\\mu\\omega}} (\\langle 0|a|1\\rangle + \\langle 0|a^{\\dagger}|1\\rangle)\n$$\nWe evaluate the two terms in the parenthesis separately.\nFor the first term, using the action of the annihilation operator on $|1\\rangle$:\n$$\n\\langle 0|a|1\\rangle = \\langle 0|(\\sqrt{1}|0\\rangle) = \\langle 0|0\\rangle = 1\n$$\nFor the second term, using the action of the creation operator on $|1\\rangle$:\n$$\n\\langle 0|a^{\\dagger}|1\\rangle = \\langle 0|(\\sqrt{1+1}|1+1\\rangle) = \\sqrt{2}\\langle 0|2\\rangle = 0\n$$\nThis result is due to the orthogonality of states $|0\\rangle$ and $|2\\rangle$.\nCombining these results, the matrix element of $Q$ is:\n$$\n\\langle 0|Q|1\\rangle = \\sqrt{\\frac{\\hbar}{2\\mu\\omega}} (1 + 0) = \\sqrt{\\frac{\\hbar}{2\\mu\\omega}}\n$$\nThis demonstrates the selection rule $\\Delta v = \\pm 1$ for vibrational transitions within the harmonic approximation and linear dipole moment surface.\n\nSubstituting this result back into the expression for $S_{01}$:\n$$\nS_{01} = a^{2} \\left|\\sqrt{\\frac{\\hbar}{2\\mu\\omega}}\\right|^{2} = a^{2} \\frac{\\hbar}{2\\mu\\omega}\n$$\nThe problem requires the final expression in terms of $a$, $\\mu$, $k$, and $\\hbar$. We replace the angular frequency $\\omega$ with its definition in terms of the force constant $k$ and reduced mass $\\mu$:\n$$\n\\omega = \\sqrt{\\frac{k}{\\mu}}\n$$\nSubstituting this into the expression for $S_{01}$:\n$$\nS_{01} = a^{2} \\frac{\\hbar}{2\\mu\\sqrt{k/\\mu}} = a^{2} \\frac{\\hbar}{2\\sqrt{\\mu^{2}}\\sqrt{k/\\mu}} = a^{2} \\frac{\\hbar}{2\\sqrt{\\mu^{2}(k/\\mu)}} = a^{2} \\frac{\\hbar}{2\\sqrt{\\mu k}}\n$$\nThis is the final closed-form expression for the line strength of the fundamental vibrational transition.\n\nFinally, we are asked to state the power-law dependence of $S_{01}$ on the reduced mass $\\mu$, assuming $a$ and $k$ are constant. From the derived expression:\n$$\nS_{01} = \\frac{a^{2}\\hbar}{2} (\\mu k)^{-1/2}\n$$\nit is evident that $S_{01}$ is proportional to $\\mu^{-1/2}$. Therefore, the line strength of the fundamental transition decreases as the reduced mass of the oscillator increases, with a power-law dependence of $-\\tfrac{1}{2}$.", "answer": "$$\n\\boxed{\\frac{a^{2} \\hbar}{2 \\sqrt{\\mu k}}}\n$$", "id": "2779261"}, {"introduction": "While a physical displacement coordinate is intuitive for a diatomic, polyatomic calculations almost exclusively use mass-weighted normal coordinates. This practice highlights a critical subtlety: the numerical value of the dipole derivative depends on the coordinate system, which is in turn defined by the potential energy surface. You will quantify the error that arises from an inconsistent workflow, where a dipole moment surface derivative from one level of theory is mistakenly combined with vibrational wavefunctions from another [@problem_id:2779285]. This exercise is essential for appreciating the need for consistency when predicting vibrational spectra.", "problem": "A single vibrational normal mode of a diatomic molecule with reduced mass $m$ is modeled by a harmonic Potential Energy Surface (PES). Two independent PES fits are available: PES $A$ with fundamental frequency $\\tilde{\\nu}_{A}$ and PES $B$ with fundamental frequency $\\tilde{\\nu}_{B}$. The Dipole Moment Surface (DMS) is linear in the physical bond-length displacement $x$ about equilibrium, given by $\\mu(x) = \\mu_{e} + a\\,x$, where $a$ is a constant slope and $\\mu_{e}$ is the equilibrium dipole moment.\n\nAssume the infrared absorption intensity for the fundamental transition $v=0 \\to 1$ is proportional to the squared magnitude of the transition dipole moment matrix element computed between the corresponding vibrational wavefunctions. The physically consistent calculation on PES $B$ uses the DMS expressed in the properly scaled dimensionless normal coordinate of PES $B$, while an inconsistent workflow mistakenly mixes PES $B$ wavefunctions with a DMS slope that was fitted and expressed in the dimensionless normal coordinate of PES $A$ (i.e., the slope carried over from PES $A$ is used as if it were already the correct slope for PES $B$).\n\nStarting from the fundamental definition of infrared line strength as proportional to $|\\langle 0|\\mu|1\\rangle|^{2}$ and the standard harmonic-oscillator construction of the dimensionless normal coordinate, derive an analytic expression for the ratio of the inconsistent to consistent intensities for the $v=0 \\to 1$ transition. Then, for a model system with $\\tilde{\\nu}_{A} = 3000\\,\\mathrm{cm}^{-1}$ and $\\tilde{\\nu}_{B} = 3300\\,\\mathrm{cm}^{-1}$, compute the fractional bias\n$$\n\\delta \\equiv \\frac{I_{\\text{inconsistent}} - I_{\\text{consistent}}}{I_{\\text{consistent}}}\n$$\nas a decimal. Round your final numerical answer for $\\delta$ to four significant figures. Express the final answer with no units.", "solution": "The problem as stated is scientifically grounded, well-posed, and objective. All necessary information is provided for a unique solution. It is a standard problem in theoretical vibrational spectroscopy that tests the fundamental understanding of normal coordinates and their relation to infrared intensities. Therefore, the problem is valid and I will proceed with its solution.\n\nThe infrared absorption intensity $I$ for a fundamental vibrational transition ($v=0 \\to 1$) is proportional to the squared magnitude of the transition dipole moment matrix element.\n$$\nI \\propto |\\langle 0 | \\hat{\\mu} | 1 \\rangle|^2\n$$\nThe harmonic oscillator model is employed for a diatomic molecule with reduced mass $m$ and vibrational angular frequency $\\omega$. The physical displacement coordinate from equilibrium is $x$. The dimensionless normal coordinate, $q$, is defined by the transformation that brings the Hamiltonian into standard form. The relation between $x$ and $q$ is:\n$$\nx = \\sqrt{\\frac{\\hbar}{m\\omega}} q\n$$\nThe dipole moment surface (DMS) is given as a linear function of the physical displacement $x$:\n$$\n\\mu(x) = \\mu_e + a x\n$$\nwhere $\\mu_e$ is the permanent dipole moment at equilibrium and $a$ is the constant slope. To evaluate the matrix element, we must express the dipole moment operator in terms of the dimensionless coordinate $q$ corresponding to the vibrational wavefunctions being used.\n$$\n\\hat{\\mu}(q) = \\mu_e + a \\left(\\sqrt{\\frac{\\hbar}{m\\omega}}\\right) q\n$$\nLet us define the slope of the DMS in the dimensionless coordinate system as $a' \\equiv a \\sqrt{\\frac{\\hbar}{m\\omega}}$. The operator is thus $\\hat{\\mu}(q) = \\mu_e + a' q$. The transition dipole moment matrix element is then:\n$$\n\\langle 0 | \\hat{\\mu}(q) | 1 \\rangle = \\langle 0 | \\mu_e + a' q | 1 \\rangle = \\mu_e \\langle 0 | 1 \\rangle + a' \\langle 0 | q | 1 \\rangle\n$$\nDue to the orthogonality of the harmonic oscillator eigenfunctions, $\\langle 0 | 1 \\rangle = 0$. The expression simplifies to:\n$$\n\\langle 0 | \\hat{\\mu}(q) | 1 \\rangle = a' \\langle 0 | q | 1 \\rangle\n$$\nThe dimensionless coordinate operator $q$ can be expressed in terms of the annihilation ($a$) and creation ($a^\\dagger$) operators as $q = \\frac{1}{\\sqrt{2}}(a + a^\\dagger)$. The matrix element $\\langle 0 | q | 1 \\rangle$ is a standard result:\n$$\n\\langle 0 | q | 1 \\rangle = \\frac{1}{\\sqrt{2}} \\langle 0 | a + a^\\dagger | 1 \\rangle = \\frac{1}{\\sqrt{2}} (\\langle 0 | a | 1 \\rangle + \\langle 0 | a^\\dagger | 1 \\rangle)\n$$\nUsing the relations $a|n\\rangle = \\sqrt{n}|n-1\\rangle$ and $a^\\dagger|n\\rangle = \\sqrt{n+1}|n+1\\rangle$, we find $\\langle 0 | a | 1 \\rangle = \\sqrt{1}\\langle 0 | 0 \\rangle = 1$ and $\\langle 0 | a^\\dagger | 1 \\rangle = \\sqrt{2}\\langle 0 | 2 \\rangle = 0$.\nTherefore, $\\langle 0 | q | 1 \\rangle = \\frac{1}{\\sqrt{2}}$.\nThe transition dipole moment is $\\langle 0 | \\hat{\\mu} | 1 \\rangle = \\frac{a'}{\\sqrt{2}}$, and the intensity is proportional to its square:\n$$\nI \\propto \\left(\\frac{a'}{\\sqrt{2}}\\right)^2 = \\frac{(a')^2}{2} = \\frac{1}{2} \\left(a \\sqrt{\\frac{\\hbar}{m\\omega}}\\right)^2 = \\frac{a^2 \\hbar}{2m\\omega}\n$$\nThis demonstrates that for a linear DMS, the fundamental intensity is inversely proportional to the vibrational frequency, $I \\propto \\frac{1}{\\omega}$.\n\nWe are given two potential energy surfaces, PES $A$ and PES $B$, with fundamental frequencies $\\tilde{\\nu}_A$ and $\\tilde{\\nu}_B$ respectively. The angular frequency is $\\omega = 2\\pi c \\tilde{\\nu}$.\n\nThe consistent intensity, $I_{\\text{consistent}}$, is calculated using the wavefunctions from PES $B$ (and thus frequency $\\omega_B$) and the DMS expressed in the corresponding dimensionless coordinate $q_B$. The slope in this coordinate system is $a'_B = a \\sqrt{\\frac{\\hbar}{m\\omega_B}}$.\n$$\nI_{\\text{consistent}} \\propto \\frac{(a'_B)^2}{2} = \\frac{a^2 \\hbar}{2m\\omega_B}\n$$\nThe inconsistent intensity, $I_{\\text{inconsistent}}$, is calculated using the wavefunctions from PES $B$ but with a DMS slope taken from the dimensionless coordinate system of PES $A$. This slope is $a'_A = a \\sqrt{\\frac{\\hbar}{m\\omega_A}}$. The inconsistent calculation incorrectly uses the operator $\\hat{\\mu}_{\\text{inc}}(q_B) = \\mu_e + a'_A q_B$. The matrix element is evaluated with PES $B$ wavefunctions, $|0\\rangle_B$ and $|1\\rangle_B$.\n$$\n\\langle 0 | \\hat{\\mu}_{\\text{inc}} | 1 \\rangle_B = a'_A \\langle 0 | q_B | 1 \\rangle_B = \\frac{a'_A}{\\sqrt{2}}\n$$\nThe resulting intensity is:\n$$\nI_{\\text{inconsistent}} \\propto \\frac{(a'_A)^2}{2} = \\frac{a^2 \\hbar}{2m\\omega_A}\n$$\nThe ratio of the inconsistent to consistent intensities is:\n$$\n\\frac{I_{\\text{inconsistent}}}{I_{\\text{consistent}}} = \\frac{\\frac{a^2 \\hbar}{2m\\omega_A}}{\\frac{a^2 \\hbar}{2m\\omega_B}} = \\frac{\\omega_B}{\\omega_A}\n$$\nSince $\\omega = 2\\pi c \\tilde{\\nu}$, the ratio can be written in terms of wavenumbers:\n$$\n\\frac{I_{\\text{inconsistent}}}{I_{\\text{consistent}}} = \\frac{\\tilde{\\nu}_B}{\\tilde{\\nu}_A}\n$$\nThis is the required analytic expression for the ratio.\n\nNext, we compute the fractional bias $\\delta$:\n$$\n\\delta = \\frac{I_{\\text{inconsistent}} - I_{\\text{consistent}}}{I_{\\text{consistent}}} = \\frac{I_{\\text{inconsistent}}}{I_{\\text{consistent}}} - 1 = \\frac{\\tilde{\\nu}_B}{\\tilde{\\nu}_A} - 1\n$$\nWe are given the values $\\tilde{\\nu}_{A} = 3000\\,\\mathrm{cm}^{-1}$ and $\\tilde{\\nu}_{B} = 3300\\,\\mathrm{cm}^{-1}$.\n$$\n\\delta = \\frac{3300}{3000} - 1 = 1.1 - 1 = 0.1\n$$\nThe result must be expressed as a decimal rounded to four significant figures.\n$$\n\\delta = 0.1000\n$$", "answer": "$$\n\\boxed{0.1000}\n$$", "id": "2779285"}, {"introduction": "The theoretical dipole derivatives we have discussed must be calculated using practical quantum chemistry methods, which introduces approximations, most notably the use of a finite basis set. This final practice moves from idealized theory to a core technique in modern computational chemistry: basis set extrapolation. You will implement a widely-used procedure to fit a series of calculations and extrapolate the dipole moment derivative to the theoretical complete basis set (CBS) limit, thereby obtaining a more accurate prediction for the infrared intensity [@problem_id:2779214]. This hands-on computational task demonstrates how to systematically improve theoretical predictions and assess their convergence.", "problem": "Consider a small, closed-shell molecule in the Born–Oppenheimer (BO) approximation and the harmonic vibrational model. The infrared (IR) intensity of a fundamental vibrational transition along a single normal coordinate $Q$ is proportional to the square of the first derivative of the molecular dipole moment vector $\\boldsymbol{\\mu}$ with respect to $Q$ at equilibrium. In symbols, if $g \\equiv \\left\\| \\frac{\\partial \\boldsymbol{\\mu}}{\\partial Q} \\right\\|$ is the magnitude of the dipole derivative, then the harmonic-oscillator IR intensity is proportional to $g^2$. In this problem, we operate entirely in atomic units (a.u.), and we refer to $g$ as the property of interest extracted from a dipole moment surface. We will compute a relative IR intensity $I_{\\text{rel}}$ defined as $I_{\\text{rel}} = g_{\\infty}^2$, where $g_{\\infty}$ is the Complete Basis Set (CBS) limit of $g$.\n\nIn correlation-consistent polarized valence $X$-zeta (cc-pVXZ) basis sets, with the cardinal number $X \\in \\{2,3,4,5,\\dots\\}$, it is a well-tested and widely used fact that basis set incompleteness errors of many ground-state properties converge asymptotically as inverse powers of $X$, often dominated by $X^{-3}$ and improved by including $X^{-5}$. Motivated by this, we adopt the ansatz\n$$\ng(X) = g_{\\infty} + \\sum_{j=1}^{M} c_j X^{-\\alpha_j},\n$$\nwhere $g_{\\infty}$ is the CBS limit in a.u., the exponents $\\alpha_j$ are positive integers chosen from a candidate set, and $c_j$ are coefficients to be determined by fitting. For this exercise, the candidate exponent set is $\\{3,5\\}$. Given $N$ data points $\\{(X_i, g_i, \\sigma_i)\\}_{i=1}^N$, where $g_i$ are values of $g(X_i)$ in a.u. and $\\sigma_i$ are one-standard-deviation uncertainties in a.u., the task is to perform a weighted linear fit to estimate $g_{\\infty}$. The following modeling rules apply:\n- Choose the largest subset of exponents from $\\{3,5\\}$ that yields an identifiable linear model under the data available. Specifically, use $\\{\\}$ if $N=1$, use $\\{3\\}$ if $N=2$, and use $\\{3,5\\}$ if $N \\ge 3$. That is, enforce $1 + M \\le N$, where the unknowns are $g_{\\infty}$ and the $M$ coefficients $c_j$.\n- Use weighted least squares with weights $w_i = 1/\\sigma_i^2$. If some $\\sigma_i$ are not specified, take $\\sigma_i = 1$ for those entries (so $w_i = 1$).\n\nYour program must implement this procedure and apply it to the following test suite. All $g$ values and $\\sigma$ values are in atomic units (a.u.), and all cardinal numbers $X$ are integers. For each case, the input is the list of triples $(X_i, g_i, \\sigma_i)$.\n\n- Test case A (general, three points, use $\\{3,5\\}$):\n  - $(X, g, \\sigma)$ equals $(2, 0.625000000, 0.001000000)$,\n    $(3, 0.541152263, 0.001000000)$,\n    $(4, 0.517968750, 0.001000000)$.\n- Test case B (boundary, two points, use $\\{3\\}$):\n  - $(X, g, \\sigma)$ equals $(3, 0.716666667, 0.002000000)$,\n    $(5, 0.742800000, 0.002000000)$.\n- Test case C (weighted, four points with one outlier down-weighted, use $\\{3,5\\}$):\n  - $(X, g, \\sigma)$ equals $(2, 0.191875000, 0.010000000)$,\n    $(3, 0.119753086, 0.001000000)$,\n    $(4, 0.108105469, 0.001000000)$,\n    $(5, 0.104096000, 0.001000000)$.\n\nTasks your program must perform:\n- For each test case, construct the design matrix with columns $[1, X^{-\\alpha_1}, \\dots, X^{-\\alpha_M}]$ consistent with the chosen $\\{\\alpha_j\\}$, and solve the weighted least squares normal equations to obtain estimates of $g_{\\infty}$ and the coefficients $\\{c_j\\}$.\n- Compute $g_{\\infty}$ (in a.u.) and the relative IR intensity $I_{\\text{rel}} = g_{\\infty}^2$ (in $(\\text{a.u.})^2$) for each test case.\n\nNumerical and output requirements:\n- Report $g_{\\infty}$ in atomic units (a.u.) and $I_{\\text{rel}}$ in $(\\text{a.u.})^2$.\n- Round every reported numeric output to $6$ decimal places.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. The list must contain $6$ floats in the following order: $[g_{\\infty}^{(A)}, g_{\\infty}^{(B)}, g_{\\infty}^{(C)}, I_{\\text{rel}}^{(A)}, I_{\\text{rel}}^{(B)}, I_{\\text{rel}}^{(C)}]$, where superscripts label the test cases A, B, and C.\n\nThe problem is universally applicable as a weighted linear regression and model selection task on inverse-power regressors. It is purely computational and does not require any particular programming language semantics beyond standard floating-point arithmetic and linear algebra. All physical quantities are expressed in explicitly specified units as stated above, and no angles or percentages are involved.", "solution": "The problem presented is a straightforward application of weighted linear least squares regression, a fundamental technique in data analysis. The task is to estimate the complete basis set (CBS) limit, $g_{\\infty}$, of a molecular property $g(X)$ by fitting a physically motivated model to a set of computed data points $\\{(X_i, g_i, \\sigma_i)\\}_{i=1}^N$. The property $g$ is the magnitude of the electric dipole moment derivative with respect to a normal coordinate, and $X$ is the cardinal number of the cc-pVXZ basis set. The relative infrared intensity is defined as $I_{\\text{rel}} = g_{\\infty}^2$.\n\nThe regression model is linear in its parameters $(g_{\\infty}, c_1, \\dots, c_M)$ and is given by the ansatz:\n$$ g(X) = g_{\\infty} + \\sum_{j=1}^{M} c_j X^{-\\alpha_j} $$\nFor a set of $N$ data points, this can be expressed in matrix form as $\\mathbf{A}\\mathbf{p} \\approx \\mathbf{g}$, where $\\mathbf{p} = [g_{\\infty}, c_1, \\dots, c_M]^T$ is the vector of parameters, $\\mathbf{g} = [g_1, \\dots, g_N]^T$ is the vector of observed values, and $\\mathbf{A}$ is the $N \\times (M+1)$ design matrix with entries $A_{i,0} = 1$ and $A_{i,j} = X_i^{-\\alpha_j}$ for $j > 0$.\n\nThe parameters are determined by minimizing the weighted sum of squared residuals, $\\chi^2$:\n$$ \\chi^2 = \\sum_{i=1}^N w_i (g_i - g(X_i))^2 = (\\mathbf{g} - \\mathbf{A}\\mathbf{p})^T \\mathbf{W} (\\mathbf{g} - \\mathbf{A}\\mathbf{p}) $$\nwhere $\\mathbf{W}$ is a diagonal matrix of weights $w_i = 1/\\sigma_i^2$. The solution that minimizes $\\chi^2$ is found by solving the normal equations:\n$$ (\\mathbf{A}^T \\mathbf{W} \\mathbf{A}) \\mathbf{p} = \\mathbf{A}^T \\mathbf{W} \\mathbf{g} $$\nThe solution vector is thus $\\mathbf{p} = (\\mathbf{A}^T \\mathbf{W} \\mathbf{A})^{-1} \\mathbf{A}^T \\mathbf{W} \\mathbf{g}$. Computationally, it is more stable to solve this system using methods based on QR decomposition or Singular Value Decomposition, for instance, by solving the unweighted least squares problem for the transformed system $(\\mathbf{W}^{1/2}\\mathbf{A})\\mathbf{p} = (\\mathbf{W}^{1/2}\\mathbf{g})$.\n\nThe problem specifies a model selection rule: the set of exponents $\\{\\alpha_j\\}$ is chosen from the candidate set $\\{3, 5\\}$ such that the number of parameters $M+1$ does not exceed the number of data points $N$. For $N=1$, we use $M=0$ (no exponents). For $N=2$, we use $M=1$ with $\\{\\alpha_1\\} = \\{3\\}$. For $N \\ge 3$, we use $M=2$ with $\\{\\alpha_1, \\alpha_2\\} = \\{3, 5\\}$. We now apply this procedure to each test case.\n\nTest Case A:\nWe are given $N=3$ data points: $(2, 0.625, 0.001)$, $(3, 0.541152263, 0.001)$, and $(4, 0.51796875, 0.001)$. According to the rule for $N=3$, we use the exponent set $\\{3, 5\\}$. The model is $g(X) = g_{\\infty} + c_1 X^{-3} + c_2 X^{-5}$. There are $3$ parameters and $3$ data points, so the system is exactly determined. The uncertainties $\\sigma_i$ are all equal, so the weights $w_i$ are uniform and the problem reduces to unweighted least squares, i.e., solving $\\mathbf{A}\\mathbf{p} = \\mathbf{g}$.\nThe system of linear equations is:\n$$ \\begin{pmatrix} 1 & 2^{-3} & 2^{-5} \\\\ 1 & 3^{-3} & 3^{-5} \\\\ 1 & 4^{-3} & 4^{-5} \\end{pmatrix} \\begin{pmatrix} g_{\\infty} \\\\ c_1 \\\\ c_2 \\end{pmatrix} = \\begin{pmatrix} 0.625 \\\\ 0.541152263 \\\\ 0.517968750 \\end{pmatrix} $$\nSolving this system yields the parameter vector $\\mathbf{p} = [0.5, 1.2, -0.8]^T$.\nTherefore, $g_{\\infty}^{(A)} = 0.5$ a.u.\nThe relative intensity is $I_{\\text{rel}}^{(A)} = (g_{\\infty}^{(A)})^2 = (0.5)^2 = 0.25$ $(\\text{a.u.})^2$.\n\nTest Case B:\nWe are given $N=2$ data points: $(3, 0.716666667, 0.002)$ and $(5, 0.7428, 0.002)$. For $N=2$, we use the exponent set $\\{3\\}$. The model is $g(X) = g_{\\infty} + c_1 X^{-3}$. With $2$ parameters and $2$ data points, the system is again exactly determined. As the uncertainties are equal, this is an unweighted problem.\nThe system of linear equations is:\n$$ \\begin{pmatrix} 1 & 3^{-3} \\\\ 1 & 5^{-3} \\end{pmatrix} \\begin{pmatrix} g_{\\infty} \\\\ c_1 \\end{pmatrix} = \\begin{pmatrix} 0.716666667 \\\\ 0.742800000 \\end{pmatrix} $$\nSolving this system yields the parameter vector $\\mathbf{p} = [0.75, -0.9]^T$.\nTherefore, $g_{\\infty}^{(B)} = 0.75$ a.u.\nThe relative intensity is $I_{\\text{rel}}^{(B)} = (g_{\\infty}^{(B)})^2 = (0.75)^2 = 0.5625$ $(\\text{a.u.})^2$.\n\nTest Case C:\nWe are given $N=4$ data points: $(2, 0.191875, 0.01)$, $(3, 0.119753086, 0.001)$, $(4, 0.108105469, 0.001)$, and $(5, 0.104096, 0.001)$. For $N=4$, we use the exponent set $\\{3, 5\\}$. The model is $g(X) = g_{\\infty} + c_1 X^{-3} + c_2 X^{-5}$. There are $3$ parameters and $4$ data points, so the system is overdetermined and must be solved using least squares. The uncertainties are not uniform, so a weighted fit is required. The weights are $w_i = 1/\\sigma_i^2$. The first data point has a much larger uncertainty ($\\sigma_1=0.01$) and is therefore significantly down-weighted relative to the other three points ($\\sigma_{2,3,4}=0.001$).\nWe solve the weighted normal equations $(\\mathbf{A}^T \\mathbf{W} \\mathbf{A}) \\mathbf{p} = \\mathbf{A}^T \\mathbf{W} \\mathbf{g}$, where $\\mathbf{A}$ is the $4 \\times 3$ design matrix and $\\mathbf{W} = \\text{diag}(1/0.01^2, 1/0.001^2, 1/0.001^2, 1/0.001^2)$.\nThe solution to this weighted least squares problem is $\\mathbf{p} \\approx [0.1, 0.5, 0.3]^T$.\nTherefore, $g_{\\infty}^{(C)} \\approx 0.10000001$ a.u.\nThe relative intensity is $I_{\\text{rel}}^{(C)} = (g_{\\infty}^{(C)})^2 \\approx (0.10000001)^2 \\approx 0.010000002$ $(\\text{a.u.})^2$.\n\nThe final results, rounded to $6$ decimal places as required, are:\n$g_{\\infty}^{(A)} = 0.500000$ a.u.\n$g_{\\infty}^{(B)} = 0.750000$ a.u.\n$g_{\\infty}^{(C)} = 0.100000$ a.u.\n$I_{\\text{rel}}^{(A)} = 0.250000$ $(\\text{a.u.})^2$\n$I_{\\text{rel}}^{(B)} = 0.562500$ $(\\text{a.u.})^2$\n$I_{\\text{rel}}^{(C)} = 0.010000$ $(\\text{a.u.})^2$", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the CBS limit of g and the relative IR intensity for a set\n    of test cases using weighted linear least squares.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    # Each case is a list of tuples (X, g, sigma).\n    test_cases = {\n        'A': [\n            (2, 0.625000000, 0.001000000),\n            (3, 0.541152263, 0.001000000),\n            (4, 0.517968750, 0.001000000)\n        ],\n        'B': [\n            (3, 0.716666667, 0.002000000),\n            (5, 0.742800000, 0.002000000)\n        ],\n        'C': [\n            (2, 0.191875000, 0.010000000),\n            (3, 0.119753086, 0.001000000),\n            (4, 0.108105469, 0.001000000),\n            (5, 0.104096000, 0.001000000)\n        ]\n    }\n    \n    results_g_inf = {}\n    results_I_rel = {}\n\n    for case_label, data in test_cases.items():\n        # Unpack data into numpy arrays\n        X, g, sigma = np.array(data).T\n        \n        N = len(data)\n        \n        # Determine the set of exponents based on the number of data points\n        if N == 1:\n            exponents = []\n        elif N == 2:\n            exponents = [3]\n        else: # N >= 3\n            exponents = [3, 5]\n            \n        # Construct the design matrix A\n        num_params = 1 + len(exponents)\n        A = np.zeros((N, num_params))\n        A[:, 0] = 1.0 # Column for g_infinity\n        for i, exp in enumerate(exponents):\n            A[:, i+1] = X**(-exp)\n            \n        # Perform weighted linear least squares.\n        # This is equivalent to unweighted least squares on a transformed system\n        # A' * p = g', where A' = A / sigma and g' = g / sigma.\n        # We need to reshape sigma to use broadcasting for element-wise division.\n        sigma_col = sigma[:, np.newaxis]\n        \n        A_w = A / sigma_col\n        g_w = g / sigma\n        \n        # Solve the linear least squares problem\n        # The first element of the solution vector 'params' is g_infinity\n        params, _, _, _ = np.linalg.lstsq(A_w, g_w, rcond=None)\n        \n        g_inf = params[0]\n        I_rel = g_inf**2\n        \n        results_g_inf[case_label] = g_inf\n        results_I_rel[case_label] = I_rel\n\n    # Prepare the final output string as per requirements\n    final_list = [\n        results_g_inf['A'],\n        results_g_inf['B'],\n        results_g_inf['C'],\n        results_I_rel['A'],\n        results_I_rel['B'],\n        results_I_rel['C']\n    ]\n\n    # Format each number to 6 decimal places and join into a comma-separated string\n    formatted_results = [f\"{val:.6f}\" for val in final_list]\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2779214"}]}