{"hands_on_practices": [{"introduction": "Understanding electron correlation begins with recognizing where our simplest models fail. This foundational exercise explores the dissociation of the hydrogen molecule, contrasting the molecular orbital (MO) and Heitler–London (valence bond) wavefunctions to precisely identify the signature of static correlation [@problem_id:2770430]. By deriving the probability of unphysical ionic character in the dissociated state, you will gain a first-principles insight into why single-reference methods struggle with stretched chemical bonds.", "problem": "Consider the hydrogen molecule, $\\mathrm{H_2}$, in the Born–Oppenheimer approximation at a large internuclear separation, so that the atomic orbitals are weakly overlapping. Let $\\phi_{A}(\\mathbf{r})$ and $\\phi_{B}(\\mathbf{r})$ be normalized hydrogenic $1s$-like atomic orbitals centered on nuclei $A$ and $B$, respectively, with overlap $S \\equiv \\langle \\phi_{A} | \\phi_{B} \\rangle$, where $0  S \\ll 1$ for large separation $R$. Work with the spin-singlet state so that the total electronic wavefunction is an overall antisymmetric product of a symmetric spatial factor and the antisymmetric singlet spin function.\n\nStarting from first principles of indistinguishability and the Pauli principle, proceed as follows:\n\n1. Construct the normalized Heitler–London spatial wavefunction for the singlet state as a covalent superposition of products $\\phi_{A}(1)\\phi_{B}(2)$ and $\\phi_{B}(1)\\phi_{A}(2)$, keeping the $S$-dependence of the normalization exact.\n\n2. Construct the normalized restricted Hartree–Fock molecular orbital spatial wavefunction for the singlet state by doubly occupying the bonding molecular orbital $\\sigma_{g} = (\\phi_{A}+\\phi_{B})/\\sqrt{2(1+S)}$.\n\n3. Define an operator $\\hat{D}$ that measures the integrated probability of double occupancy on the same atomic center in the atomic-orbital subspace,\n$$\n\\hat{D} \\equiv \\big| \\phi_{A}\\phi_{A} \\big\\rangle \\big\\langle \\phi_{A}\\phi_{A} \\big| \\;+\\; \\big| \\phi_{B}\\phi_{B} \\big\\rangle \\big\\langle \\phi_{B}\\phi_{B} \\big| ,\n$$\nwhere $\\big| \\phi_{X}\\phi_{Y} \\big\\rangle$ denotes the two-electron product $\\phi_{X}(1)\\phi_{Y}(2)$ acting on spatial coordinates only. Using only normalization, overlap, and product-integral identities implied by the definitions of $\\phi_{A}$, $\\phi_{B}$, and $S$, evaluate the double-occupancy probabilities $p_{\\mathrm{same}}^{\\mathrm{HL}}(S) \\equiv \\langle \\Psi_{\\mathrm{HL}} | \\hat{D} | \\Psi_{\\mathrm{HL}} \\rangle$ and $p_{\\mathrm{same}}^{\\mathrm{MO}}(S) \\equiv \\langle \\Psi_{\\mathrm{MO}} | \\hat{D} | \\Psi_{\\mathrm{MO}} \\rangle$ as closed-form functions of $S$.\n\n4. To identify the signature of static correlation at large $R$, consider the difference\n$$\n\\Delta(S) \\equiv p_{\\mathrm{same}}^{\\mathrm{MO}}(S) - p_{\\mathrm{same}}^{\\mathrm{HL}}(S),\n$$\nand compute the limiting value\n$$\n\\Delta_{\\infty} \\equiv \\lim_{S \\to 0} \\Delta(S) .\n$$\n\nProvide your final answer as a single number. No rounding is required. No units are needed.", "solution": "We begin from the Born–Oppenheimer separation and the Pauli principle. For a two-electron singlet, the spin function is antisymmetric, so the spatial wavefunction must be symmetric under particle exchange.\n\nAtomic orbitals $\\phi_{A}$ and $\\phi_{B}$ are normalized, $\\langle \\phi_{A}|\\phi_{A}\\rangle = \\langle \\phi_{B}|\\phi_{B}\\rangle = 1$, and their overlap is $S \\equiv \\langle \\phi_{A}|\\phi_{B}\\rangle$. For two-electron product states we use the notation $\\big| \\phi_{X}\\phi_{Y} \\big\\rangle \\equiv \\phi_{X}(1)\\phi_{Y}(2)$ and the identity\n$$\n\\big\\langle \\phi_{X}\\phi_{Y} \\big| \\phi_{X'}\\phi_{Y'} \\big\\rangle \\;=\\; \\langle \\phi_{X}|\\phi_{X'}\\rangle \\; \\langle \\phi_{Y}|\\phi_{Y'}\\rangle.\n$$\nWith these, the fundamental overlaps among the two-electron product states are\n$$\n\\langle AA|AA\\rangle = \\langle BB|BB\\rangle = \\langle AB|AB\\rangle = \\langle BA|BA\\rangle = 1,\n$$\n$$\n\\langle AA|BB\\rangle = \\langle BB|AA\\rangle = S^{2}, \\quad \\langle AB|BA\\rangle = \\langle BA|AB\\rangle = S^{2},\n$$\n$$\n\\langle AA|AB\\rangle = \\langle AA|BA\\rangle = \\langle BB|AB\\rangle = \\langle BB|BA\\rangle = S,\n$$\nand their Hermitian conjugates.\n\nHeitler–London construction. The symmetric covalent spatial function is\n$$\n\\Phi_{\\mathrm{cov}} \\;=\\; \\big| AB \\big\\rangle + \\big| BA \\big\\rangle.\n$$\nIts norm is\n$$\n\\langle \\Phi_{\\mathrm{cov}} | \\Phi_{\\mathrm{cov}} \\rangle \\;=\\; \\langle AB|AB\\rangle + \\langle BA|BA\\rangle + 2 \\,\\Re \\langle AB|BA\\rangle \\;=\\; 1 + 1 + 2 S^{2} \\;=\\; 2(1+S^{2}).\n$$\nHence the normalized Heitler–London spatial wavefunction is\n$$\n\\Psi_{\\mathrm{HL}} \\;=\\; \\frac{1}{\\sqrt{2(1+S^{2})}} \\, \\big( \\, |AB\\rangle + |BA\\rangle \\, \\big).\n$$\n\nMolecular orbital construction. The normalized bonding molecular orbital is\n$$\n\\sigma_{g} \\;=\\; \\frac{\\phi_{A} + \\phi_{B}}{\\sqrt{2(1+S)}},\n$$\nso the restricted Hartree–Fock singlet spatial function is the symmetric product\n$$\n\\Psi_{\\mathrm{MO}} \\;=\\; \\sigma_{g}(1)\\,\\sigma_{g}(2) \\;=\\; \\frac{1}{2(1+S)} \\, \\big( \\, |AA\\rangle + |AB\\rangle + |BA\\rangle + |BB\\rangle \\, \\big).\n$$\nThis is normalized because $\\sigma_{g}$ is normalized.\n\nDouble-occupancy operator. We define\n$$\n\\hat{D} \\;=\\; |AA\\rangle\\langle AA| + |BB\\rangle\\langle BB|.\n$$\nIts action on the two-electron product states is obtained from overlaps:\n$$\n\\hat{D}|AA\\rangle = |AA\\rangle, \\quad \\hat{D}|BB\\rangle = |BB\\rangle,\n$$\n$$\n\\hat{D}|AB\\rangle = |AA\\rangle \\langle AA|AB\\rangle + |BB\\rangle \\langle BB|AB\\rangle = S \\,\\big( |AA\\rangle + |BB\\rangle \\big),\n$$\n$$\n\\hat{D}|BA\\rangle = S \\,\\big( |AA\\rangle + |BB\\rangle \\big).\n$$\n\nExpectation value in the Heitler–London state. Using $\\Psi_{\\mathrm{HL}}$ and the above actions,\n$$\n\\hat{D} \\, \\Psi_{\\mathrm{HL}} \\;=\\; \\frac{1}{\\sqrt{2(1+S^{2})}} \\, \\Big( \\hat{D}|AB\\rangle + \\hat{D}|BA\\rangle \\Big)\n\\;=\\; \\frac{2S}{\\sqrt{2(1+S^{2})}} \\, \\big( |AA\\rangle + |BB\\rangle \\big).\n$$\nThen\n\\begin{align*}\np_{\\mathrm{same}}^{\\mathrm{HL}}(S) \\;\\equiv\\; \\langle \\Psi_{\\mathrm{HL}} | \\hat{D} | \\Psi_{\\mathrm{HL}} \\rangle \\\\\n=\\; \\frac{1}{2(1+S^{2})} \\, \\big( \\langle AB| + \\langle BA| \\big) \\, \\Big( 2S \\big( |AA\\rangle + |BB\\rangle \\big) \\Big) \\\\\n=\\; \\frac{2S}{2(1+S^{2})} \\, \\Big( \\langle AB|AA\\rangle + \\langle AB|BB\\rangle + \\langle BA|AA\\rangle + \\langle BA|BB\\rangle \\Big) \\\\\n=\\; \\frac{S}{1+S^{2}} \\, \\Big( S + S + S + S \\Big) \\\\\n=\\; \\frac{4 S^{2}}{1+S^{2}}.\n\\end{align*}\nThus $p_{\\mathrm{same}}^{\\mathrm{HL}}(S) = \\frac{4 S^{2}}{1+S^{2}}$, which tends to $0$ as $S \\to 0$.\n\nExpectation value in the molecular orbital state. Write $\\Psi_{\\mathrm{MO}} = C \\, \\Phi_{\\mathrm{MO}}$ with $C = 1/[2(1+S)]$ and $\\Phi_{\\mathrm{MO}} = |AA\\rangle + |AB\\rangle + |BA\\rangle + |BB\\rangle$. Then\n\\begin{align*}\n\\hat{D} \\, \\Phi_{\\mathrm{MO}} \\;=\\; \\hat{D}|AA\\rangle + \\hat{D}|AB\\rangle + \\hat{D}|BA\\rangle + \\hat{D}|BB\\rangle \\\\\n=\\; |AA\\rangle + S(|AA\\rangle + |BB\\rangle) + S(|AA\\rangle + |BB\\rangle) + |BB\\rangle \\\\\n=\\; (1+2S)\\, |AA\\rangle + (1+2S)\\, |BB\\rangle.\n\\end{align*}\nTherefore\n\\begin{align*}\np_{\\mathrm{same}}^{\\mathrm{MO}}(S) \\;=\\; \\langle \\Psi_{\\mathrm{MO}} | \\hat{D} | \\Psi_{\\mathrm{MO}} \\rangle \\\\\n=\\; C^{2} \\, \\langle \\Phi_{\\mathrm{MO}} | \\big( (1+2S)\\, |AA\\rangle + (1+2S)\\, |BB\\rangle \\big) \\\\\n=\\; C^{2} \\, (1+2S) \\, \\Big( \\langle \\Phi_{\\mathrm{MO}} | AA\\rangle + \\langle \\Phi_{\\mathrm{MO}} | BB\\rangle \\Big) \\\\\n=\\; C^{2} \\, (1+2S) \\, \\Big( \\langle AA|AA\\rangle + \\langle AB|AA\\rangle + \\langle BA|AA\\rangle + \\langle BB|AA\\rangle \\\\\n\\qquad\\qquad\\qquad\\qquad + \\langle AA|BB\\rangle + \\langle AB|BB\\rangle + \\langle BA|BB\\rangle + \\langle BB|BB\\rangle \\Big) \\\\\n=\\; C^{2} \\, (1+2S) \\, \\Big( (1 + S + S + S^{2}) + (S^{2} + S + S + 1) \\Big) \\\\\n=\\; C^{2} \\, (1+2S) \\, \\Big( 2 + 4S + 2S^{2} \\Big) \\\\\n=\\; \\frac{1}{4(1+S)^{2}} \\, (1+2S) \\, 2(1+S)^{2} \\\\\n=\\; \\frac{1+2S}{2}.\n\\end{align*}\nThus $p_{\\mathrm{same}}^{\\mathrm{MO}}(S) = \\frac{1+2S}{2}$, which tends to $\\frac{1}{2}$ as $S \\to 0$.\n\nDifference and large-separation limit. The difference is\n$$\n\\Delta(S) \\;=\\; p_{\\mathrm{same}}^{\\mathrm{MO}}(S) - p_{\\mathrm{same}}^{\\mathrm{HL}}(S) \\;=\\; \\frac{1+2S}{2} \\;-\\; \\frac{4 S^{2}}{1+S^{2}}.\n$$\nTaking the limit $S \\to 0$ gives\n$$\n\\Delta_{\\infty} \\;=\\; \\lim_{S \\to 0} \\Delta(S) \\;=\\; \\frac{1}{2} - 0 \\;=\\; \\frac{1}{2}.\n$$\n\nInterpretation. The Heitler–London state eliminates same-center double occupancy in the large-$R$ limit, yielding $p_{\\mathrm{same}}^{\\mathrm{HL}} \\to 0$, while the restricted Hartree–Fock molecular orbital state retains a finite same-center double-occupancy probability $p_{\\mathrm{same}}^{\\mathrm{MO}} \\to 1/2$. The nonzero $\\Delta_{\\infty} = 1/2$ is the signature of static correlation missed by the single-determinant molecular orbital description.", "answer": "$$\\boxed{\\frac{1}{2}}$$", "id": "2770430"}, {"introduction": "Having qualitatively identified static correlation, we now move to a quantitative analysis within a minimal but exactly solvable model [@problem_id:2770452]. This practice involves implementing a Full Configuration Interaction (FCI) calculation for a model of hydrogen dissociation, a benchmark for 'exact' results in a given basis. By deriving and computing the natural orbital occupation numbers, you will learn to partition the total correlation energy into its static and dynamic components, observing how their balance shifts dramatically from equilibrium to dissociation.", "problem": "You will implement a minimal, mathematically self-contained model of the dissociation of molecular hydrogen to compute the correlation energy at the Full Configuration Interaction (FCI) level and partition it into static and dynamic components using occupation number analysis. The model is defined in a two-orbital minimal basis consisting of the gerade bonding orbital and the ungerade antibonding orbital. The system has two electrons with total spin singlet.\n\nFundamental base and model assumptions:\n- The nonrelativistic Born–Oppenheimer electronic Hamiltonian in second quantization is assumed, and the Slater–Condon rules apply for the construction of Hamiltonian matrix elements in an orthonormal spin orbital basis.\n- In the restricted, spin-adapted singlet gerade space spanned by the double-occupancy configurations of the bonding and antibonding spatial orbitals, the FCI Hamiltonian reduces to a real symmetric matrix of dimension two. In the ordered basis $\\{ \\lvert g^2 \\rangle, \\lvert u^2 \\rangle \\}$, the electronic Hamiltonian has diagonal elements $E_{g^2}$ and $E_{u^2}$ and an off-diagonal coupling $\\langle g g \\Vert u u \\rangle$, the antisymmetrized two-electron integral between the two doubly occupied configurations.\n- Let $\\Delta(R)$ denote the energy gap between the two double-occupancy diagonal matrix elements, $\\Delta(R) \\equiv E_{u^2}(R) - E_{g^2}(R)$, and let $V(R)$ denote the off-diagonal coupling, $V(R) \\equiv \\langle g g \\Vert u u \\rangle(R)$.\n\nYou will work relative to the reference $E_{g^2}(R)$, so that the Hamiltonian matrix is\n$$\n\\mathbf{H}(R) \\equiv \n\\begin{pmatrix}\n0  V(R) \\\\\nV(R)  \\Delta(R)\n\\end{pmatrix},\n$$\nwhich is sufficient to determine both the correlation energy and the natural orbital occupations for a two-electron singlet in this model.\n\nParametric, scientifically plausible $R$-dependence:\n- Distances $R$ are given in Angstroms and must be converted to Bohr using the exact conversion $1\\,\\text{\\AA} = 1.889726125\\,a_0$. All energies are to be computed and reported in Hartree.\n- The one-electron bonding–antibonding splitting is modeled by an exponentially decaying resonance (hopping) parameter\n$$\nt(R) = -\\tau \\, e^{-a R_\\mathrm{B}},\n$$\nwhere $R_\\mathrm{B}$ is the internuclear distance in Bohr, $\\tau = 0.5$ and $a = 1.0$ (both in atomic units). The contribution of the one-electron part to the double-occupancy energy gap is $4\\lvert t(R)\\rvert$.\n- A small differential Coulomb contribution to the double-occupancy gap is included as\n$$\n\\delta J(R) = \\delta_0 \\, e^{-d R_\\mathrm{B}},\n$$\nwith $\\delta_0 = 0.02$ and $d = 1.0$ (atomic units).\n- The antisymmetrized pair-coupling between the two doubly occupied configurations is taken as\n$$\nV(R) = V_\\infty + V_0 \\, e^{-c R_\\mathrm{B}},\n$$\nwith $V_\\infty = 0.035$, $V_0 = 0.015$, and $c = 1.2$ in atomic units.\n\nWith these, the total double-occupancy gap is\n$$\n\\Delta(R) = 4\\lvert t(R)\\rvert + \\delta J(R).\n$$\n\nRequired derivations and computations:\n1. Using the two-by-two Hamiltonian $\\mathbf{H}(R)$ above and basic linear algebra, derive an expression for the correlation energy\n$$\nE_\\mathrm{corr}(R) \\equiv E_\\mathrm{FCI}(R) - E_\\mathrm{RHF}(R),\n$$\nin Hartree, where $E_\\mathrm{FCI}(R)$ is the lower eigenvalue of $\\mathbf{H}(R)$ and $E_\\mathrm{RHF}(R)$ is the Hartree–Fock (HF) energy of the closed-shell reference $\\lvert g^2\\rangle$, which equals the lower diagonal element (set to zero by our reference choice). You must obtain a closed form for $E_\\mathrm{corr}(R)$ in terms of $\\Delta(R)$ and $V(R)$, or compute it by eigenvalue evaluation. The nuclear repulsion does not enter because you work entirely in the energy-difference gauge where $E_{g^2}(R)$ is the zero of energy.\n2. Let $\\lvert \\Psi_0(R) \\rangle = c_g(R) \\lvert g^2 \\rangle + c_u(R) \\lvert u^2 \\rangle$ be the normalized FCI ground-state eigenvector of $\\mathbf{H}(R)$. Using the definition of the one-electron reduced density matrix and the fact that the two spatial orbitals are symmetry-adapted and orthonormal, derive the natural occupation numbers $n_g(R)$ and $n_u(R)$ of the bonding and antibonding orbitals, respectively, in terms of $c_g(R)$ and $c_u(R)$.\n3. Use occupation number analysis to partition $E_\\mathrm{corr}(R)$ into static and dynamic components. For this problem, base your partition on the physical principle that static correlation is associated with occupations near unity and dynamic correlation with small deviations from idempotency. Define the static-correlation fraction for a two-electron singlet as\n$$\nf_\\mathrm{stat}(R) \\equiv \\min\\{ n_g(R),\\, n_u(R) \\},\n$$\nand the dynamic-correlation fraction as $f_\\mathrm{dyn}(R) \\equiv 1 - f_\\mathrm{stat}(R)$. Then define\n$$\nE_\\mathrm{stat}(R) \\equiv f_\\mathrm{stat}(R)\\, E_\\mathrm{corr}(R), \\quad\nE_\\mathrm{dyn}(R) \\equiv f_\\mathrm{dyn}(R)\\, E_\\mathrm{corr}(R).\n$$\nAll energies must be expressed in Hartree.\n4. Implement the above in a program that, for each test internuclear distance, computes and returns the triple $\\big[ E_\\mathrm{corr}(R), E_\\mathrm{stat}(R), E_\\mathrm{dyn}(R) \\big]$ rounded to six decimal places.\n\nAngle units are not involved. All numerical outputs must be in Hartree and reported as decimal floating-point numbers.\n\nTest suite:\n- Use the following internuclear distances in Angstroms: $R \\in \\{ 0.74, 1.20, 2.00, 4.00, 7.00 \\}$.\n- Your program should produce a single line of output containing the results as a comma-separated list of lists, each inner list containing three floats for a distance in the order given above. The line must be exactly of the form\n\"[ [Ecorr(R1),Estat(R1),Edyn(R1)], [Ecorr(R2),Estat(R2),Edyn(R2)], ... ]\"\nwith all floats rounded to six decimal places, no additional text, and a single space after each comma separating list elements for readability. For example: \"[[x11,x12,x13],[x21,x22,x23],...]\".", "solution": "The problem statement has been subjected to rigorous validation and is found to be scientifically sound, well-posed, and objective. It outlines a standard, albeit minimal, model for studying electron correlation in molecular dissociation, a cornerstone concept in quantum chemistry. The model is self-contained, providing all necessary parameters and functional forms. We will therefore proceed with a complete solution.\n\nThe problem requires a three-part analysis: first, the derivation of the correlation energy $E_\\mathrm{corr}(R)$; second, the derivation of the natural orbital occupation numbers $n_g(R)$ and $n_u(R)$; and third, the partitioning of the correlation energy into static and dynamic components based on these occupations.\n\n**1. Derivation of the Correlation Energy**\n\nThe model is defined by a $2 \\times 2$ electronic Hamiltonian matrix in the basis of doubly-occupied configurations $\\{ \\lvert g^2 \\rangle, \\lvert u^2 \\rangle \\}$, relative to the energy of the Hartree-Fock reference state $\\lvert g^2 \\rangle$:\n$$\n\\mathbf{H}(R) = \n\\begin{pmatrix}\n0  V(R) \\\\\nV(R)  \\Delta(R)\n\\end{pmatrix}\n$$\nThe eigenvalues $E$ of this matrix are the roots of the characteristic equation $\\det(\\mathbf{H}(R) - E\\mathbf{I}) = 0$.\n$$\n\\det \\begin{pmatrix} -E  V(R) \\\\ V(R)  \\Delta(R) - E \\end{pmatrix} = 0\n$$\n$$\n(-E)(\\Delta(R) - E) - V(R)^2 = 0\n$$\n$$\nE^2 - E\\Delta(R) - V(R)^2 = 0\n$$\nThis is a quadratic equation for the energy eigenvalues $E$. Applying the quadratic formula yields the two eigenvalues:\n$$\nE_{\\pm}(R) = \\frac{\\Delta(R) \\pm \\sqrt{(-\\Delta(R))^2 - 4(1)(-V(R)^2)}}{2} = \\frac{\\Delta(R) \\pm \\sqrt{\\Delta(R)^2 + 4V(R)^2}}{2}\n$$\nThe Full Configuration Interaction (FCI) ground state energy, $E_\\mathrm{FCI}(R)$, corresponds to the lower of these two eigenvalues. Since $\\sqrt{\\Delta(R)^2 + 4V(R)^2}  \\Delta(R)$ for non-zero $V(R)$, the lower eigenvalue is $E_-(R)$.\n$$\nE_\\mathrm{FCI}(R) = \\frac{\\Delta(R) - \\sqrt{\\Delta(R)^2 + 4V(R)^2}}{2}\n$$\nThe problem defines the correlation energy $E_\\mathrm{corr}(R)$ as the difference between the FCI energy and the Restricted Hartree-Fock (RHF) energy. In our chosen energy gauge, the RHF energy $E_\\mathrm{RHF}(R)$ (the energy of the $\\lvert g^2 \\rangle$ state) is set to zero.\n$$\nE_\\mathrm{RHF}(R) = 0\n$$\nTherefore, the correlation energy is simply equal to the FCI ground state energy.\n$$\nE_\\mathrm{corr}(R) = E_\\mathrm{FCI}(R) - E_\\mathrm{RHF}(R) = \\frac{\\Delta(R) - \\sqrt{\\Delta(R)^2 + 4V(R)^2}}{2}\n$$\nThis is the closed-form expression for the correlation energy in terms of the model parameters $\\Delta(R)$ and $V(R)$. Note that since $\\Delta(R)$ and $V(R)$ are constructed to be positive quantities, $E_\\mathrm{corr}(R)$ is always negative, as is required for a variational correction to the ground state.\n\n**2. Derivation of Natural Orbital Occupation Numbers**\n\nThe FCI ground state eigenvector $\\lvert \\Psi_0(R) \\rangle$ corresponding to the eigenvalue $E_\\mathrm{FCI}(R)$ is a linear combination of the basis configurations:\n$$\n\\lvert \\Psi_0(R) \\rangle = c_g(R) \\lvert g^2 \\rangle + c_u(R) \\lvert u^2 \\rangle\n$$\nThe coefficients $c_g(R)$ and $c_u(R)$ are determined by solving the eigenvector equation $\\mathbf{H}(R) \\mathbf{c} = E_\\mathrm{FCI}(R) \\mathbf{c}$, where $\\mathbf{c} = (c_g, c_u)^T$. This gives:\n$$\nV(R) c_u(R) = E_\\mathrm{FCI}(R) c_g(R)\n$$\nFor a two-electron singlet state described by this expansion in terms of orthonormal spatial orbitals $g$ and $u$, the natural orbital occupation numbers are given by the standard relations:\n$$\nn_g(R) = 2c_g(R)^2\n$$\n$$\nn_u(R) = 2c_u(R)^2\n$$\nThe total number of electrons is conserved: $n_g(R) + n_u(R) = 2(c_g(R)^2 + c_u(R)^2) = 2$, due to the normalization condition $c_g(R)^2 + c_u(R)^2 = 1$.\n\nTo find the coefficients, we use the eigenvector equation and the normalization condition.\n$$\nc_u(R) = \\frac{E_\\mathrm{FCI}(R)}{V(R)} c_g(R)\n$$\nSubstituting into the normalization condition:\n$$\nc_g(R)^2 + \\left(\\frac{E_\\mathrm{FCI}(R)}{V(R)}\\right)^2 c_g(R)^2 = 1\n$$\n$$\nc_g(R)^2 \\left( 1 + \\frac{E_\\mathrm{FCI}(R)^2}{V(R)^2} \\right) = 1\n$$\n$$\nc_g(R)^2 = \\frac{V(R)^2}{V(R)^2 + E_\\mathrm{FCI}(R)^2}\n$$\nFrom this, it immediately follows that:\n$$\nc_u(R)^2 = 1 - c_g(R)^2 = 1 - \\frac{V(R)^2}{V(R)^2 + E_\\mathrm{FCI}(R)^2} = \\frac{E_\\mathrm{FCI}(R)^2}{V(R)^2 + E_\\mathrm{FCI}(R)^2}\n$$\nSubstituting these expressions for the squared coefficients into the formulas for the occupation numbers gives:\n$$\nn_g(R) = 2 \\frac{V(R)^2}{V(R)^2 + E_\\mathrm{FCI}(R)^2}\n$$\n$$\nn_u(R) = 2 \\frac{E_\\mathrm{FCI}(R)^2}{V(R)^2 + E_\\mathrm{FCI}(R)^2}\n$$\nWith $E_\\mathrm{FCI}(R)$ being equal to $E_\\mathrm{corr}(R)$ in this model, we have all necessary formulas for computation.\n\n**3. Partitioning of Correlation Energy**\n\nThe problem provides a specific, physically motivated scheme for partitioning the total correlation energy. This scheme relies on the deviation of occupation numbers from the idempotent RHF case (where $n_g=2$, $n_u=0$). The static correlation fraction is defined by the extent of multireference character, quantified by the occupation of the minority orbital.\n$$\nf_\\mathrm{stat}(R) \\equiv \\min\\{ n_g(R),\\, n_u(R) \\}\n$$\nThe dynamic correlation fraction is defined as the remainder:\n$$\nf_\\mathrm{dyn}(R) \\equiv 1 - f_\\mathrm{stat}(R)\n$$\nThe corresponding energy components are then obtained by multiplying the total correlation energy by these fractions:\n$$\nE_\\mathrm{stat}(R) \\equiv f_\\mathrm{stat}(R) \\times E_\\mathrm{corr}(R)\n$$\n$$\nE_\\mathrm{dyn}(R) \\equiv f_\\mathrm{dyn}(R) \\times E_\\mathrm{corr}(R)\n$$\n\n**Computational Procedure**\n\nThe implementation will proceed as follows for each given internuclear distance $R$ in Angstroms:\n1.  Convert the distance $R$ from Angstroms to Bohr ($a_0$) using the given conversion factor $1.889726125$. Let this be $R_\\mathrm{B}$.\n2.  Calculate the model parameters using the provided exponential functions:\n    *   $\\Delta(R) = (2.0 \\times e^{-1.0 R_\\mathrm{B}}) + (0.02 \\times e^{-1.0 R_\\mathrm{B}}) = 2.02 \\times e^{-R_\\mathrm{B}}$.\n    *   $V(R) = 0.035 + 0.015 \\times e^{-1.2 R_\\mathrm{B}}$.\n3.  Compute the total correlation energy $E_\\mathrm{corr}(R)$ using its derived closed-form expression.\n4.  Compute the natural occupation numbers $n_g(R)$ and $n_u(R)$ using the expressions derived from the FCI eigenvector coefficients.\n5.  Determine the static and dynamic fractions $f_\\mathrm{stat}(R)$ and $f_\\mathrm{dyn}(R)$.\n6.  Calculate the static and dynamic correlation energies, $E_\\mathrm{stat}(R)$ and $E_\\mathrm{dyn}(R)$.\n7.  Store the resulting triplet $[E_\\mathrm{corr}(R), E_\\mathrm{stat}(R), E_\\mathrm{dyn}(R)]$ and format all values to six decimal places.\nThis procedure will be repeated for all specified test distances.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes total, static, and dynamic correlation energies for a minimal\n    model of H2 dissociation at various internuclear distances.\n    \"\"\"\n    \n    # Define physical and model constants\n    A_to_BOHR = 1.889726125  # Conversion factor from Angstrom to Bohr\n    \n    # Parameters for the one-electron hopping term component of Delta\n    # t(R) = -tau * exp(-a * R_B)\n    TAU = 0.5  # a.u.\n    A = 1.0    # a.u.\n    \n    # Parameters for the differential Coulomb term component of Delta\n    # deltaJ(R) = delta0 * exp(-d * R_B)\n    DELTA0 = 0.02 # a.u.\n    D = 1.0       # a.u.\n    \n    # Parameters for the off-diagonal coupling V(R)\n    # V(R) = V_inf + V0 * exp(-c * R_B)\n    V_INF = 0.035 # a.u.\n    V0 = 0.015    # a.u.\n    C = 1.2       # a.u.\n    \n    # Internuclear distances in Angstroms for the test suite\n    test_distances_A = [0.74, 1.20, 2.00, 4.00, 7.00]\n    \n    results = []\n    \n    for R_A in test_distances_A:\n        # Step 1: Convert distance to Bohr\n        R_B = R_A * A_to_BOHR\n        \n        # Step 2: Calculate model parameters Delta(R) and V(R)\n        # Note: 4 * |t(R)| = 4 * |-tau * exp(-a * R_B)| = 4 * tau * exp(-a * R_B)\n        # Delta(R) = 4*|t(R)| + deltaJ(R)\n        delta_R = 4.0 * TAU * np.exp(-A * R_B) + DELTA0 * np.exp(-D * R_B)\n        \n        # V(R) = V_inf + V0 * exp(-c * R_B)\n        v_R = V_INF + V0 * np.exp(-C * R_B)\n        \n        # Step 3: Compute total correlation energy\n        # E_corr(R) = (Delta - sqrt(Delta^2 + 4*V^2)) / 2\n        e_corr = (delta_R - np.sqrt(delta_R**2 + 4.0 * v_R**2)) / 2.0\n        \n        # E_fci is the same as e_corr in this model since E_rhf = 0\n        e_fci = e_corr\n        \n        # Step 4: Compute natural orbital occupation numbers\n        # n_g = 2 * V^2 / (V^2 + E_fci^2)\n        # n_u = 2 * E_fci^2 / (V^2 + E_fci^2)\n        denominator = v_R**2 + e_fci**2\n        n_g = 2.0 * v_R**2 / denominator\n        n_u = 2.0 * e_fci**2 / denominator\n        \n        # Step 5: Determine static and dynamic correlation fractions\n        # f_stat = min(n_g, n_u)\n        # f_dyn = 1 - f_stat\n        f_stat = min(n_g, n_u)\n        f_dyn = 1.0 - f_stat\n        \n        # Step 6: Calculate static and dynamic correlation energies\n        e_stat = f_stat * e_corr\n        e_dyn = f_dyn * e_corr\n        \n        # Store the triplet of results\n        results.append([e_corr, e_stat, e_dyn])\n\n    # Final print statement in the exact required format.\n    # The format requires spaces after commas, both inside and between inner lists.\n    inner_strings = []\n    for res_triple in results:\n        inner_strings.append(f\"[{res_triple[0]:.6f}, {res_triple[1]:.6f}, {res_triple[2]:.6f}]\")\n    \n    print(f\"[{', '.join(inner_strings)}]\")\n\nsolve()\n```", "id": "2770452"}, {"introduction": "In practical research, we often use sophisticated but approximate methods, and it is crucial to know when they can be trusted. This final exercise simulates the analysis of real computational data for the $\\mathrm{H}_2$ molecule, focusing on two widely used diagnostics for static correlation: the $M$ diagnostic from natural orbital occupancies and the fraction of the atomization energy from the perturbative triples correction ($f[(T)]$) [@problem_id:2770439]. By interpreting the trends in these diagnostics, you will learn to recognize the characteristic signatures of a breakdown in single-reference methods when faced with strong multireference character.", "problem": "Consider the homonuclear diatomic molecule $\\mathrm{H}_{2}$ along a bond dissociation coordinate. You are given the following information obtained from consistent, well-converged electronic structure calculations in the Born–Oppenheimer and nonrelativistic approximations, using a sufficiently large basis so that basis-set incompleteness is negligible for the purposes of this exercise.\n\nFor two internuclear distances, $R_{\\mathrm{eq}} = 0.741\\,\\mathrm{\\AA}$ (near equilibrium) and $R_{\\mathrm{st}} = 2.000\\,\\mathrm{\\AA}$ (stretched), the computed quantities are:\n- Total electronic energy of the separated atoms (two hydrogen atoms) at the coupled cluster with single and double excitations and perturbative triple excitations [CCSD(T)] level: $E_{\\mathrm{atoms}}^{\\mathrm{CCSD(T)}} = -1.0000\\,\\mathrm{E_{h}}$ at both $R_{\\mathrm{eq}}$ and $R_{\\mathrm{st}}$.\n- Total electronic energy of $\\mathrm{H}_{2}$ at CCSD(T): $E_{\\mathrm{mol}}^{\\mathrm{CCSD(T)}}(R_{\\mathrm{eq}}) = -1.1745\\,\\mathrm{E_{h}}$ and $E_{\\mathrm{mol}}^{\\mathrm{CCSD(T)}}(R_{\\mathrm{st}}) = -1.0100\\,\\mathrm{E_{h}}$.\n- The perturbative triples correction $(T)$ to the energy of $\\mathrm{H}_{2}$: $E_{(T)}(R_{\\mathrm{eq}}) = -0.0045\\,\\mathrm{E_{h}}$ and $E_{(T)}(R_{\\mathrm{st}}) = -0.0030\\,\\mathrm{E_{h}}$. For the hydrogen atoms, $E_{(T)}(\\mathrm{H}) = 0\\,\\mathrm{E_{h}}$.\n- Natural orbital occupation numbers (from a multireference calculation that yields the one-particle reduced density matrix consistent with the above electronic structure description) for the highest occupied natural orbital (HONO) and the lowest unoccupied natural orbital (LUNO):\n  - At $R_{\\mathrm{eq}}$: $n_{\\mathrm{HONO}}(R_{\\mathrm{eq}}) = 1.98$ and $n_{\\mathrm{LUNO}}(R_{\\mathrm{eq}}) = 0.02$.\n  - At $R_{\\mathrm{st}}$: $n_{\\mathrm{HONO}}(R_{\\mathrm{st}}) = 1.10$ and $n_{\\mathrm{LUNO}}(R_{\\mathrm{st}}) = 0.90$.\n\nYour tasks are:\n1. Starting from the definition of atomization energy as the difference between the energy of the separated atoms and the molecular energy, derive the expression for the fraction of the atomization energy arising from the perturbative triples contribution, $f[(T)] \\equiv \\mathrm{TAE}[(T)]/\\mathrm{TAE}$, at a given internuclear distance $R$, in terms of $E_{(T)}$ for the molecule and atoms and the corresponding total energies. Then evaluate $f[(T)]$ for $R_{\\mathrm{eq}}$ and for $R_{\\mathrm{st}}$. Express $f[(T)]$ as a decimal (not using a percentage sign).\n2. Using the natural orbital occupation numbers provided, evaluate the $M$ diagnostic at each geometry, defined here by\n$$\nM \\equiv \\min\\!\\big(2 - n_{\\mathrm{HONO}},\\, n_{\\mathrm{LUNO}}\\big).\n$$\n3. Briefly interpret how the trends you obtained for $M$ and $f[(T)]$ from $R_{\\mathrm{eq}}$ to $R_{\\mathrm{st}}$ reflect changes in the balance between static (nondynamical) and dynamic correlation along bond dissociation.\n\nRound all numerical answers to four significant figures. Report the final numerical results in the order $\\big[M(R_{\\mathrm{eq}}),\\, f[(T)](R_{\\mathrm{eq}}),\\, M(R_{\\mathrm{st}}),\\, f[(T)](R_{\\mathrm{st}})\\big]$ as a row matrix. These quantities are dimensionless; do not include units in your final numerical answer.", "solution": "The problem is scientifically grounded, well-posed, objective, and contains sufficient information for a unique solution. It is a standard exercise in theoretical chemistry and is thus deemed valid. We proceed with the solution.\n\nThe problem requires the calculation of two quantities, the fraction of the atomization energy from the perturbative triples correction, $f[(T)]$, and the multireference diagnostic $M$, at two internuclear distances, $R_{\\mathrm{eq}}$ and $R_{\\mathrm{st}}$. Subsequently, an interpretation of the results in the context of electron correlation is required.\n\nFirst, we address task 1: the derivation and calculation of $f[(T)]$.\nThe total atomization energy, which we denote as $\\mathrm{TAE}$, is defined as the energy of the separated constituent atoms minus the energy of the molecule. For the $\\mathrm{H}_{2}$ molecule at the CCSD(T) level of theory, this is:\n$$\n\\mathrm{TAE}^{\\mathrm{CCSD(T)}} = E_{\\mathrm{atoms}}^{\\mathrm{CCSD(T)}} - E_{\\mathrm{mol}}^{\\mathrm{CCSD(T)}}\n$$\nThe problem provides $E_{\\mathrm{atoms}}^{\\mathrm{CCSD(T)}}$ as the total energy for two hydrogen atoms.\n\nThe contribution to the atomization energy originating from the perturbative triples correction, $\\mathrm{TAE}[(T)]$, is computed using the same definition but applied only to the energy component from the $(T)$ correction. The total CCSD(T) energy is a sum of the CCSD energy and the triples correction: $E^{\\mathrm{CCSD(T)}} = E^{\\mathrm{CCSD}} + E_{(T)}$. Therefore, $\\mathrm{TAE}[(T)]$ is given by:\n$$\n\\mathrm{TAE}[(T)] = E_{(T),\\mathrm{atoms}} - E_{(T),\\mathrm{mol}}\n$$\nFor two hydrogen atoms, $E_{(T),\\mathrm{atoms}} = 2 \\times E_{(T)}(\\mathrm{H})$. The problem states that $E_{(T)}(\\mathrm{H}) = 0\\,\\mathrm{E_{h}}$.\nThe fraction of the atomization energy from the triples correction, $f[(T)]$, is the ratio of these two quantities:\n$$\nf[(T)] = \\frac{\\mathrm{TAE}[(T)]}{\\mathrm{TAE}^{\\mathrm{CCSD(T)}}} = \\frac{E_{(T),\\mathrm{atoms}} - E_{(T),\\mathrm{mol}}}{E_{\\mathrm{atoms}}^{\\mathrm{CCSD(T)}} - E_{\\mathrm{mol}}^{\\mathrm{CCSD(T)}}} = \\frac{-E_{(T)}(\\mathrm{H}_{2})}{E_{\\mathrm{atoms}}^{\\mathrm{CCSD(T)}} - E_{\\mathrm{mol}}^{\\mathrm{CCSD(T)}}(\\mathrm{H}_{2})}\n$$\nWe now evaluate this expression at the two specified geometries, rounding to four significant figures.\n\nAt the equilibrium distance, $R_{\\mathrm{eq}} = 0.741\\,\\mathrm{\\AA}$:\n$$\n\\mathrm{TAE}^{\\mathrm{CCSD(T)}}(R_{\\mathrm{eq}}) = -1.0000\\,\\mathrm{E_{h}} - (-1.1745\\,\\mathrm{E_{h}}) = 0.1745\\,\\mathrm{E_{h}}\n$$\n$$\n\\mathrm{TAE}[(T)](R_{\\mathrm{eq}}) = -(E_{(T)}(R_{\\mathrm{eq}})) = -(-0.0045\\,\\mathrm{E_{h}}) = 0.0045\\,\\mathrm{E_{h}}\n$$\n$$\nf[(T)](R_{\\mathrm{eq}}) = \\frac{0.0045}{0.1745} \\approx 0.0257879... \\approx 0.02579\n$$\n\nAt the stretched distance, $R_{\\mathrm{st}} = 2.000\\,\\mathrm{\\AA}$:\n$$\n\\mathrm{TAE}^{\\mathrm{CCSD(T)}}(R_{\\mathrm{st}}) = -1.0000\\,\\mathrm{E_{h}} - (-1.0100\\,\\mathrm{E_{h}}) = 0.0100\\,\\mathrm{E_{h}}\n$$\n$$\n\\mathrm{TAE}[(T)](R_{\\mathrm{st}}) = -(E_{(T)}(R_{\\mathrm{st}})) = -(-0.0030\\,\\mathrm{E_{h}}) = 0.0030\\,\\mathrm{E_{h}}\n$$\n$$\nf[(T)](R_{\\mathrm{st}}) = \\frac{0.0030}{0.0100} = 0.3000\n$$\n\nNext, we address task 2: the evaluation of the $M$ diagnostic.\nThe $M$ diagnostic is defined as:\n$$\nM \\equiv \\min\\!\\big(2 - n_{\\mathrm{HONO}},\\, n_{\\mathrm{LUNO}}\\big)\n$$\nwhere $n_{\\mathrm{HONO}}$ and $n_{\\mathrm{LUNO}}$ are the natural orbital occupation numbers of the highest occupied and lowest unoccupied natural orbitals, respectively.\n\nAt $R_{\\mathrm{eq}}$, with $n_{\\mathrm{HONO}}(R_{\\mathrm{eq}}) = 1.98$ and $n_{\\mathrm{LUNO}}(R_{\\mathrm{eq}}) = 0.02$:\nThe quantity $2 - n_{\\mathrm{HONO}}(R_{\\mathrm{eq}}) = 2 - 1.98 = 0.02$.\n$$\nM(R_{\\mathrm{eq}}) = \\min(0.02, 0.02) = 0.02000\n$$\nThe value is given to four significant figures.\n\nAt $R_{\\mathrm{st}}$, with $n_{\\mathrm{HONO}}(R_{\\mathrm{st}}) = 1.10$ and $n_{\\mathrm{LUNO}}(R_{\\mathrm{st}}) = 0.90$:\nThe quantity $2 - n_{\\mathrm{HONO}}(R_{\\mathrm{st}}) = 2 - 1.10 = 0.90$.\n$$\nM(R_{\\mathrm{st}}) = \\min(0.90, 0.90) = 0.9000\n$$\nThe value is given to four significant figures.\n\nFinally, we address task 3: the interpretation of these trends.\nThe results are summarized as follows:\n- At $R_{\\mathrm{eq}}$: $M = 0.02000$, $f[(T)] = 0.02579$.\n- At $R_{\\mathrm{st}}$: $M = 0.9000$, $f[(T)] = 0.3000$.\n\nThe transition from $R_{\\mathrm{eq}}$ to $R_{\\mathrm{st}}$ shows a dramatic increase in both $M$ and $f[(T)]$. This behavior reflects a fundamental change in the nature of electron correlation as the H–H bond is stretched.\n\nThe $M$ diagnostic is a measure of multireference character, which is a manifestation of static (or nondynamical) correlation. Static correlation becomes important when two or more electronic configurations (Slater determinants) are nearly degenerate and must be included in the zeroth-order description of the wavefunction for even qualitative correctness. A small $M$ value indicates a system is well-described by a single reference determinant. At $R_{\\mathrm{eq}}$, $M = 0.02000$, which is very small. This confirms that the $\\mathrm{H}_{2}$ molecule near its equilibrium geometry is a prototypical single-reference system, dominated by the $(\\sigma_g)^2$ configuration. Electron correlation is primarily dynamic, arising from electrons avoiding each other's instantaneous positions.\n\nAs the bond is stretched to $R_{\\mathrm{st}}$, the $M$ diagnostic increases sharply to $0.9000$. This large value signifies severe multireference character. The reason is the energetic near-degeneracy between the covalent bonding configuration $(\\sigma_g)^2$ and the antibonding configuration $(\\sigma_u^*)^2$. A proper description requires a linear combination of both, a classic example of strong static correlation. The natural orbital occupation numbers, $n_{\\mathrm{HONO}} \\to 1$ and $n_{\\mathrm{LUNO}} \\to 1$ as $R \\to \\infty$, signal the unpairing of electrons to form two separate hydrogen atoms. The values at $R_{\\mathrm{st}}$ ($1.10$ and $0.90$) show the system is far along this path.\n\nThe fraction $f[(T)]$ quantifies the relative importance of the perturbative triples correction to the binding energy. The $(T)$ correction is primarily designed to recover dynamic correlation energy beyond what is captured by CCSD. At $R_{\\mathrm{eq}}$, where static correlation is negligible, $f[(T)]$ is small ($0.02579$, or about $2.6\\%$). The triples correction provides a small but important refinement to the atomization energy, capturing higher-order dynamic correlation effects. The total atomization energy is large and physically meaningful.\n\nAt $R_{\\mathrm{st}}$, $f[(T)]$ explodes to an unphysically large value of $0.3000$ ($30\\%$). This does not imply that triple excitations are now physically responsible for $30\\%$ of the bond energy. Rather, it is a clear artifact of the breakdown of the single-reference CCSD(T) method. The denominator, $\\mathrm{TAE}^{\\mathrm{CCSD(T)}}$, has become artificially small because the underlying single-reference model performs poorly for the stretched bond. The large perturbative $(T)$ correction is a symptom of this failure, attempting to correct a qualitatively incorrect zeroth-order CCSD description. Such a large relative contribution from a perturbative correction indicates that the perturbation series is divergent or poorly convergent, and the method is unreliable.\n\nIn conclusion, the increase in $M$ from $R_{\\mathrm{eq}}$ to $R_{\\mathrm{st}}$ correctly diagnoses the increasing importance of static correlation upon bond stretching. The concurrent sharp rise in $f[(T)]$ is not a physical effect but a diagnostic indicator of the failure of the single-reference CCSD(T) approach in this multireference regime. The system's electronic structure has transitioned from being dominated by dynamic correlation to being dominated by static correlation.", "answer": "$$\n\\boxed{\\begin{pmatrix} 0.02000  0.02579  0.9000  0.3000 \\end{pmatrix}}\n$$", "id": "2770439"}]}