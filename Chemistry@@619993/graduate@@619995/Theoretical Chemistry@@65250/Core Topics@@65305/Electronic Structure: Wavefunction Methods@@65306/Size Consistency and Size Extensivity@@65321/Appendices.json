{"hands_on_practices": [{"introduction": "The first step in mastering any theoretical concept is to apply its formal definition. This exercise provides a direct test of the definitions of size consistency and size extensivity by presenting a hypothetical method's energy expression, which includes a non-linear error term. By comparing this expression against the mathematical requirements for size consistency, $E(N) = N \\times E(1)$, and size extensivity, where energy scales linearly with system size $N$, you can rigorously classify the method's behavior. This foundational practice [@problem_id:1394925] hones the ability to connect a method's mathematical form to its fundamental theoretical properties, a crucial skill for evaluating and developing new quantum chemical models.", "problem": "In computational quantum chemistry, two important properties of a theoretical method are size consistency and size extensivity.\n- A method is defined as **size-consistent** if the calculated total energy of a system composed of $N$ identical, non-interacting subsystems is exactly equal to $N$ times the calculated energy of a single subsystem. That is, if $E(N)$ is the energy of $N$ subsystems, the condition is $E(N) = N \\times E(1)$.\n- A method is defined as **size-extensive** if the calculated total energy scales linearly with the number of particles (or subsystems, $N$) as the system size grows.\n\nConsider a hypothetical quantum chemistry method being tested on a system of $N$ non-interacting helium atoms. The method yields a total energy for the system given by the expression:\n$$E_{total}(N) = N E_{a} + c N^{2}$$\nwhere $N$ is the number of helium atoms, $E_{a}$ is a constant representing the dominant single-atom energy contribution, and $c$ is a small, non-zero constant representing a systematic error in the method.\n\nBased on the definitions provided, determine whether this hypothetical method is size-consistent and/or size-extensive.\n\nWhich of the following statements is correct?\n\nA. The method is size-consistent but not size-extensive.\n\nB. The method is size-extensive but not size-consistent.\n\nC. The method is both size-consistent and size-extensive.\n\nD. The method is neither size-consistent nor size-extensive.\n\nE. Whether the method is size-consistent or size-extensive depends on the value of $E_{a}$.", "solution": "We are given a method with total energy for $N$ non-interacting identical subsystems (helium atoms) as\n$$\nE_{total}(N) = N E_{a} + c N^{2},\n$$\nwith $c \\neq 0$.\n\nBy the definition of size consistency, for $N$ identical, non-interacting subsystems, the energy must satisfy\n$$\nE(N) = N \\times E(1).\n$$\nFirst compute $E(1)$ from the given method:\n$$\nE(1) = E_{a} + c.\n$$\nThen the size-consistency requirement implies\n$$\nN \\times E(1) = N(E_{a} + c) = N E_{a} + c N.\n$$\nCompare this to the method’s prediction:\n$$\nE_{total}(N) = N E_{a} + c N^{2}.\n$$\nThese are equal only if\n$$\nc N^{2} = c N \\quad \\Longleftrightarrow \\quad c N (N - 1) = 0.\n$$\nSince $c \\neq 0$ and for $N > 1$ we have $N(N-1) \\neq 0$, the equality fails. Therefore, the method is not size-consistent.\n\nBy the definition of size extensivity, the total energy should scale linearly with $N$ for a system composed of non-interacting subsystems. The given expression contains a quadratic term $c N^{2}$, so for large $N$ the energy grows as\n$$\nE_{total}(N) \\sim c N^{2},\n$$\nwhich is not linear in $N$. Equivalently, the energy per particle is\n$$\n\\frac{E_{total}(N)}{N} = E_{a} + c N,\n$$\nwhich depends on $N$ and thus violates linear scaling. Therefore, the method is not size-extensive.\n\nHence, the correct choice is that the method is neither size-consistent nor size-extensive.", "answer": "$$\\boxed{D}$$", "id": "1394925"}, {"introduction": "Having established the formal definitions, we now delve into the microscopic origins of size-consistency errors. Truncated Configuration Interaction (CI) methods are a classic example of important methodologies that suffer from this theoretical deficiency. This exercise [@problem_id:2805781] uses a simplified but powerful two-level model for a stretched hydrogen molecule to guide you through a derivation showing how truncating the CI expansion for a non-interacting dimer—specifically by omitting products of excitations from different monomers—leads to an incorrect total energy. This hands-on derivation reveals precisely how the mathematical structure of a many-electron wavefunction ansatz dictates its adherence to, or violation of, size consistency, moving beyond mere definition to a deeper, mechanistic understanding of the error's source.", "problem": "Consider two identical, infinitely separated hydrogen dimers $\\mathrm{H}_{2}^{(A)}$ and $\\mathrm{H}_{2}^{(B)}$ at stretched geometries, treated within the Born–Oppenheimer approximation (fixed nuclei) and a minimal basis set per monomer. For each monomer, use a two-configuration spin-adapted model space consisting of the restricted Hartree–Fock (RHF) reference determinant $\\lvert \\Phi_{0} \\rangle$ and the corresponding doubly excited determinant $\\lvert \\Phi_{2} \\rangle$ in which the electron pair is promoted from the bonding to the antibonding spatial orbital. Assume the following for each isolated monomer: (i) choose the zero of energy such that $\\langle \\Phi_{0} \\rvert \\hat{H} \\lvert \\Phi_{0} \\rangle = 0$, (ii) the diagonal energy of $\\lvert \\Phi_{2} \\rangle$ is $\\Delta > 0$, and (iii) the off-diagonal coupling between the two determinants is a real constant $v \\neq 0$, so that the electronic Hamiltonian restricted to $\\{ \\lvert \\Phi_{0} \\rangle, \\lvert \\Phi_{2} \\rangle \\}$ is\n$$\n\\mathbf{H}_{\\text{mono}} \\;=\\; \\begin{pmatrix}\n0 & v \\\\\nv & \\Delta\n\\end{pmatrix}.\n$$\nConfiguration Interaction with Singles and Doubles (CISD) is defined here as the variational solution of the Schrödinger equation within the span of determinants obtained by all single and double excitations from the RHF reference for the system under consideration, using the variational principle. For a two-electron monomer in the above two-determinant space, CISD coincides with full configuration interaction.\n\nNow construct the composite, noninteracting dimer $\\mathrm{H}_{2}^{(A)} + \\mathrm{H}_{2}^{(B)}$ with Hamiltonian $\\hat{H} = \\hat{H}_{A} + \\hat{H}_{B}$, and take the CISD model space for the dimer to be spanned by the three product determinants\n$$\n\\big\\{ \\lvert \\Phi_{0}^{A} \\Phi_{0}^{B} \\rangle,\\; \\lvert \\Phi_{2}^{A} \\Phi_{0}^{B} \\rangle,\\; \\lvert \\Phi_{0}^{A} \\Phi_{2}^{B} \\rangle \\big\\},\n$$\nwhich omits the disconnected product $\\lvert \\Phi_{2}^{A} \\Phi_{2}^{B} \\rangle$ because it is a quadruple excitation relative to the dimer RHF reference. Assume strict noninteraction between monomers, so there is no coupling between excitations on different monomers and no energy shifts beyond the sum of monomer contributions.\n\nUsing only the variational principle, separability of noninteracting subsystems, and linear algebra, do the following:\n- Derive the CISD ground-state energy $E_{\\text{mono}}(\\Delta, v)$ for a single monomer.\n- Derive the CISD ground-state energy $E_{\\text{dimer}}^{\\text{CISD}}(\\Delta, v)$ for the noninteracting dimer within the three-determinant space above.\n- Define the size-consistency error as $\\delta E_{\\text{CISD}}(\\Delta, v) \\equiv E_{\\text{dimer}}^{\\text{CISD}}(\\Delta, v) - \\big[ E_{\\text{mono}}(\\Delta, v) + E_{\\text{mono}}(\\Delta, v) \\big]$ and obtain a closed-form analytic expression for $\\delta E_{\\text{CISD}}(\\Delta, v)$.\n\nExpress your final answer as a single simplified analytic expression in terms of $\\Delta$ and $v$. No rounding is required. Leave the answer in symbolic form; do not include units.", "solution": "The problem statement is found to be valid, as it is scientifically grounded, well-posed, and objective. It presents a standard model in theoretical chemistry for the analysis of size consistency. We now proceed with the solution.\n\nThe problem requires a three-part derivation to find the size-consistency error of a simplified Configuration Interaction with Singles and Doubles (CISD) model.\n\nFirst, we determine the ground-state energy of a single monomer, $E_{\\text{mono}}(\\Delta, v)$. The electronic Hamiltonian for a monomer, within the specified $2$-determinant basis $\\{ \\lvert \\Phi_{0} \\rangle, \\lvert \\Phi_{2} \\rangle \\}$, is given as:\n$$\n\\mathbf{H}_{\\text{mono}} = \\begin{pmatrix} 0 & v \\\\ v & \\Delta \\end{pmatrix}\n$$\nThe energy eigenvalues are found by solving the secular equation $\\det(\\mathbf{H}_{\\text{mono}} - E\\mathbf{I}) = 0$, where $\\mathbf{I}$ is the identity matrix of dimension $2$.\n$$\n\\det \\begin{pmatrix} -E & v \\\\ v & \\Delta - E \\end{pmatrix} = 0\n$$\nThis leads to the characteristic polynomial:\n$$\n(-E)(\\Delta - E) - v^2 = 0\n$$\n$$\nE^2 - \\Delta E - v^2 = 0\n$$\nThis is a quadratic equation for the energy $E$. Applying the quadratic formula, $E = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}$, with coefficients $a = 1$, $b = -\\Delta$, and $c = -v^2$, we obtain the two energy eigenvalues:\n$$\nE = \\frac{\\Delta \\pm \\sqrt{(-\\Delta)^2 - 4(1)(-v^2)}}{2} = \\frac{\\Delta \\pm \\sqrt{\\Delta^2 + 4v^2}}{2}\n$$\nThe ground-state energy is the lower of these two eigenvalues. Given that $\\Delta > 0$ and $v \\neq 0$, the term $\\sqrt{\\Delta^2 + 4v^2}$ is strictly greater than $\\Delta$. Thus, the lowest energy eigenvalue corresponds to the minus sign. This energy is the CISD energy for the monomer, which in this $2$-state model is identical to the Full Configuration Interaction (FCI) energy.\n$$\nE_{\\text{mono}}(\\Delta, v) = \\frac{\\Delta - \\sqrt{\\Delta^2 + 4v^2}}{2}\n$$\n\nSecond, we determine the CISD ground-state energy for the noninteracting dimer, $E_{\\text{dimer}}^{\\text{CISD}}(\\Delta, v)$. The dimer Hamiltonian is $\\hat{H} = \\hat{H}_{A} + \\hat{H}_{B}$. The CISD model space for the dimer is spanned by the $3$ basis functions $\\{ \\lvert \\Psi_1 \\rangle, \\lvert \\Psi_2 \\rangle, \\lvert \\Psi_3 \\rangle \\} = \\{ \\lvert \\Phi_{0}^{A} \\Phi_{0}^{B} \\rangle, \\lvert \\Phi_{2}^{A} \\Phi_{0}^{B} \\rangle, \\lvert \\Phi_{0}^{A} \\Phi_{2}^{B} \\rangle \\}$. We must construct the Hamiltonian matrix $\\mathbf{H}_{\\text{dimer}}^{\\text{CISD}}$ in this basis. The matrix elements are $H_{ij} = \\langle \\Psi_i \\rvert \\hat{H}_A + \\hat{H}_B \\rvert \\Psi_j \\rangle$. Using the properties of the monomer basis states and the noninteraction assumption:\n$H_{11} = \\langle \\Phi_{0}^{A} \\Phi_{0}^{B} \\rvert \\hat{H}_A + \\hat{H}_B \\rvert \\Phi_{0}^{A} \\Phi_{0}^{B} \\rangle = \\langle \\Phi_{0}^{A} \\rvert \\hat{H}_A \\rvert \\Phi_{0}^{A} \\rangle + \\langle \\Phi_{0}^{B} \\rvert \\hat{H}_B \\rvert \\Phi_{0}^{B} \\rangle = 0 + 0 = 0$.\n$H_{22} = \\langle \\Phi_{2}^{A} \\Phi_{0}^{B} \\rvert \\hat{H}_A + \\hat{H}_B \\rvert \\Phi_{2}^{A} \\Phi_{0}^{B} \\rangle = \\langle \\Phi_{2}^{A} \\rvert \\hat{H}_A \\rvert \\Phi_{2}^{A} \\rangle + \\langle \\Phi_{0}^{B} \\rvert \\hat{H}_B \\rvert \\Phi_{0}^{B} \\rangle = \\Delta + 0 = \\Delta$.\n$H_{33} = \\langle \\Phi_{0}^{A} \\Phi_{2}^{B} \\rvert \\hat{H}_A + \\hat{H}_B \\rvert \\Phi_{0}^{A} \\Phi_{2}^{B} \\rangle = \\langle \\Phi_{0}^{A} \\rvert \\hat{H}_A \\rvert \\Phi_{0}^{A} \\rangle + \\langle \\Phi_{2}^{B} \\rvert \\hat{H}_B \\rvert \\Phi_{2}^{B} \\rangle = 0 + \\Delta = \\Delta$.\n$H_{12} = \\langle \\Phi_{0}^{A} \\Phi_{0}^{B} \\rvert \\hat{H}_A + \\hat{H}_B \\rvert \\Phi_{2}^{A} \\Phi_{0}^{B} \\rangle = \\langle \\Phi_{0}^{A} \\rvert \\hat{H}_A \\rvert \\Phi_{2}^{A} \\rangle \\langle \\Phi_{0}^{B} \\rvert \\Phi_{0}^{B} \\rangle = v \\cdot 1 = v$.\n$H_{13} = \\langle \\Phi_{0}^{A} \\Phi_{0}^{B} \\rvert \\hat{H}_A + \\hat{H}_B \\rvert \\Phi_{0}^{A} \\Phi_{2}^{B} \\rangle = \\langle \\Phi_{0}^{A} \\rvert \\Phi_{0}^{A} \\rangle \\langle \\Phi_{0}^{B} \\rvert \\hat{H}_B \\rvert \\Phi_{2}^{B} \\rangle = 1 \\cdot v = v$.\n$H_{23} = \\langle \\Phi_{2}^{A} \\Phi_{0}^{B} \\rvert \\hat{H}_A + \\hat{H}_B \\rvert \\Phi_{0}^{A} \\Phi_{2}^{B} \\rangle = 0$, as the Hamiltonians only couple states within the same monomer.\nThe resulting Hermitian matrix is:\n$$\n\\mathbf{H}_{\\text{dimer}}^{\\text{CISD}} = \\begin{pmatrix} 0 & v & v \\\\ v & \\Delta & 0 \\\\ v & 0 & \\Delta \\end{pmatrix}\n$$\nTo find the eigenvalues $E$, we solve the characteristic equation $\\det(\\mathbf{H}_{\\text{dimer}}^{\\text{CISD}} - E\\mathbf{I}) = 0$:\n$$\n\\det \\begin{pmatrix} -E & v & v \\\\ v & \\Delta - E & 0 \\\\ v & 0 & \\Delta - E \\end{pmatrix} = -E(\\Delta - E)^2 - v(v(\\Delta-E)) - v(-v(\\Delta-E)) = 0\n$$\n$$\n-E(\\Delta - E)^2 - 2v^2(\\Delta - E) = 0\n$$\n$$\n-(\\Delta - E)[E(\\Delta - E) + 2v^2] = 0\n$$\nThis equation yields two possibilities:\n1. $\\Delta - E = 0 \\implies E = \\Delta$.\n2. $E(\\Delta - E) + 2v^2 = 0 \\implies E^2 - \\Delta E - 2v^2 = 0$.\nThe second case is a quadratic equation with solutions:\n$$\nE = \\frac{\\Delta \\pm \\sqrt{\\Delta^2 - 4(1)(-2v^2)}}{2} = \\frac{\\Delta \\pm \\sqrt{\\Delta^2 + 8v^2}}{2}\n$$\nThe three eigenvalues are thus $\\Delta$, $\\frac{1}{2}(\\Delta + \\sqrt{\\Delta^2 + 8v^2})$, and $\\frac{1}{2}(\\Delta - \\sqrt{\\Delta^2 + 8v^2})$. The ground-state energy is the lowest of these. Since $\\sqrt{\\Delta^2 + 8v^2} > \\Delta$, the lowest eigenvalue is:\n$$\nE_{\\text{dimer}}^{\\text{CISD}}(\\Delta, v) = \\frac{\\Delta - \\sqrt{\\Delta^2 + 8v^2}}{2}\n$$\n\nThird, we compute the size-consistency error, $\\delta E_{\\text{CISD}}(\\Delta, v)$, defined as the difference between the energy of the dimer and twice the energy of the monomer.\n$$\n\\delta E_{\\text{CISD}}(\\Delta, v) = E_{\\text{dimer}}^{\\text{CISD}}(\\Delta, v) - 2 E_{\\text{mono}}(\\Delta, v)\n$$\nSubstituting the expressions derived above:\n$$\n\\delta E_{\\text{CISD}}(\\Delta, v) = \\left( \\frac{\\Delta - \\sqrt{\\Delta^2 + 8v^2}}{2} \\right) - 2\\left( \\frac{\\Delta - \\sqrt{\\Delta^2 + 4v^2}}{2} \\right)\n$$\n$$\n\\delta E_{\\text{CISD}}(\\Delta, v) = \\frac{\\Delta - \\sqrt{\\Delta^2 + 8v^2}}{2} - (\\Delta - \\sqrt{\\Delta^2 + 4v^2})\n$$\n$$\n\\delta E_{\\text{CISD}}(\\Delta, v) = \\frac{\\Delta - \\sqrt{\\Delta^2 + 8v^2} - 2\\Delta + 2\\sqrt{\\Delta^2 + 4v^2}}{2}\n$$\n$$\n\\delta E_{\\text{CISD}}(\\Delta, v) = \\frac{-\\Delta - \\sqrt{\\Delta^2 + 8v^2} + 2\\sqrt{\\Delta^2 + 4v^2}}{2}\n$$\nThis expression can be rearranged to a more structured form:\n$$\n\\delta E_{\\text{CISD}}(\\Delta, v) = \\sqrt{\\Delta^2 + 4v^2} - \\frac{\\Delta + \\sqrt{\\Delta^2 + 8v^2}}{2}\n$$\nThis is the final closed-form expression for the size-consistency error. Since $v \\neq 0$, this error is generally nonzero, demonstrating the failure of the truncated CISD method to be size-consistent. This failure arises from the omission of the disconnected quadruple-excitation configuration $\\lvert \\Phi_{2}^{A} \\Phi_{2}^{B} \\rangle$ from the dimer's model space.", "answer": "$$\n\\boxed{\\sqrt{\\Delta^2 + 4v^2} - \\frac{\\Delta + \\sqrt{\\Delta^2 + 8v^2}}{2}}\n$$", "id": "2805781"}, {"introduction": "In practical computations, the intrinsic size-consistency error of a method is often conflated with another computational artifact: Basis Set Superposition Error (BSSE), which arises from the use of incomplete basis sets. This final practice provides a computational framework to disentangle these two distinct types of errors. You will implement a quantitative \"toy model\" that explicitly parameterizes both the intrinsic size-consistency error of the CID method and the distance-dependent BSSE. By applying the Boys–Bernardi counterpoise correction within this model [@problem_id:2462360], you will demonstrate how this procedure effectively isolates the true, method-inherent size-consistency error. This exercise bridges theory and practice, solidifying the understanding of how to design numerical experiments that separate physical effects from methodological limitations.", "problem": "You are asked to construct a precise, self-contained computational experiment that mathematically isolates the size-consistency error of Configuration Interaction with Doubles (CID) from the basis set superposition error (BSSE) for a helium dimer. The objective is to implement a toy, yet principled, model that captures the mathematical structure of both errors and to use Boys–Bernardi counterpoise correction to remove BSSE and reveal the residual size-consistency error. All quantities must be expressed in Hartree for energy and angstrom for distance.\n\nBackground and model assumptions:\n- In many-electron methods, a method is called size-consistent if the total energy of two noninteracting subsystems equals the sum of their separate energies. Non-size-extensive methods like Configuration Interaction with Doubles (CID) violate this property.\n- Basis Set Superposition Error (BSSE) arises because, in a finite basis, two fragments can spuriously lower their energies by borrowing each other’s basis functions. The Boys–Bernardi counterpoise correction evaluates monomer energies in the dimer basis (with ghost functions) to estimate and subtract this spurious stabilization.\n\nYou must implement the following physically motivated toy model, which encodes these definitions quantitatively:\n\n1) Monomer correlation model:\n- Let the monomer basis quality parameter be $q \\in \\mathbb{R}_{>0}$. The true monomer correlation energy is modeled as\n$$\nC_{\\mathrm{true}}(q) \\;=\\; -C_{\\infty}\\,\\frac{q}{q+q_{0}},\n$$\nwith $C_{\\infty} = 0.042$ Hartree and $q_{0} = 1.0$.\n- The CID monomer correlation energy is modeled as a constant fraction of the true correlation:\n$$\nC_{\\mathrm{CID}}(q) \\;=\\; s_{\\mathrm{CID}}\\,C_{\\mathrm{true}}(q),\n$$\nwith $s_{\\mathrm{CID}} = 0.9$.\n- The Hartree–Fock reference energy for helium is treated as a constant\n$$\nE_{\\mathrm{ref}} = -2.8617 \\;\\text{Hartree}.\n$$\nThus, the isolated monomer energy at the CID level is\n$$\nE_{\\mathrm{mono}}^{\\mathrm{iso}}(q) \\;=\\; E_{\\mathrm{ref}} + C_{\\mathrm{CID}}(q).\n$$\n\n2) Dimer energy model without true interaction:\n- For the purpose of isolating errors, take the true interaction potential to be identically zero, so the only contributions to the interaction energy are the method-induced artifacts (size inconsistency and BSSE).\n\n3) Size-consistency error (cross-term) for CID:\n- For two noninteracting monomers with basis qualities $q_A$ and $q_B$, the CID dimer acquires a spurious cross-term that scales with the product of the monomer correlation energies:\n$$\n\\Delta_{\\mathrm{SCE}}(q_A,q_B) \\;=\\; \\gamma \\,\\frac{C_{\\mathrm{CID}}(q_A)\\,C_{\\mathrm{CID}}(q_B)}{C_{\\mathrm{scale}}},\n$$\nwith $\\gamma = 0.02$ and $C_{\\mathrm{scale}} = 0.05$ Hartree. This term is independent of separation and reflects the lack of size extensivity in CID.\n\n4) Basis set superposition error (BSSE):\n- Let the interatomic separation be $R$ in angstrom. Define an overlap-like decay\n$$\nS(R) = e^{-kR}, \\quad k = 1.2 \\;\\text{\\AA}^{-1}.\n$$\n- The monomer BSSE stabilization (when using the partner’s ghost basis) is modeled as\n$$\n\\Delta_{\\mathrm{BSSE}}^{A}(R,q_A) \\;=\\; -\\beta \\,S(R)\\,\\frac{1}{1+q_A}, \\qquad\n\\Delta_{\\mathrm{BSSE}}^{B}(R,q_B) \\;=\\; -\\beta \\,S(R)\\,\\frac{1}{1+q_B},\n$$\nwith $\\beta = 0.02$ Hartree. The total dimer BSSE is the sum of the monomer contributions:\n$$\n\\Delta_{\\mathrm{BSSE}}^{\\mathrm{dimer}}(R,q_A,q_B) \\;=\\; \\Delta_{\\mathrm{BSSE}}^{A}(R,q_A) + \\Delta_{\\mathrm{BSSE}}^{B}(R,q_B).\n$$\n\n5) Energies to be computed:\n- Uncorrected dimer energy (no counterpoise), neglecting any true interaction:\n$$\nE^{\\mathrm{uncorr}}_{\\mathrm{dimer}}(R,q_A,q_B)\n= \\big[E_{\\mathrm{ref}} + C_{\\mathrm{CID}}(q_A)\\big]\n  + \\big[E_{\\mathrm{ref}} + C_{\\mathrm{CID}}(q_B)\\big]\n  + \\Delta_{\\mathrm{SCE}}(q_A,q_B)\n  + \\Delta_{\\mathrm{BSSE}}^{\\mathrm{dimer}}(R,q_A,q_B).\n$$\n- Monomer-in-dimer-basis energies (counterpoise terms):\n$$\nE^{\\ast}_A(R,q_A) = E_{\\mathrm{ref}} + C_{\\mathrm{CID}}(q_A) + \\Delta_{\\mathrm{BSSE}}^{A}(R,q_A), \\quad\nE^{\\ast}_B(R,q_B) = E_{\\mathrm{ref}} + C_{\\mathrm{CID}}(q_B) + \\Delta_{\\mathrm{BSSE}}^{B}(R,q_B).\n$$\n\n6) Interaction energies:\n- Uncorrected interaction energy:\n$$\n\\Delta E_{\\mathrm{int}}^{\\mathrm{uncorr}}(R,q_A,q_B) \\;=\\;\nE^{\\mathrm{uncorr}}_{\\mathrm{dimer}}(R,q_A,q_B) \\;-\\; \\big[E_{\\mathrm{mono}}^{\\mathrm{iso}}(q_A) + E_{\\mathrm{mono}}^{\\mathrm{iso}}(q_B)\\big].\n$$\n- Counterpoise-corrected interaction energy:\n$$\n\\Delta E_{\\mathrm{int}}^{\\mathrm{CP}}(R,q_A,q_B) \\;=\\;\nE^{\\mathrm{uncorr}}_{\\mathrm{dimer}}(R,q_A,q_B) \\;-\\; \\big[E^{\\ast}_A(R,q_A) + E^{\\ast}_B(R,q_B)\\big].\n$$\n\nTarget quantity:\n- Show that the counterpoise-corrected interaction energy isolates the size-consistency error:\n$$\n\\Delta E_{\\mathrm{int}}^{\\mathrm{CP}}(R,q_A,q_B) \\;=\\; \\Delta_{\\mathrm{SCE}}(q_A,q_B).\n$$\nYour program should compute this isolated size-consistency error for each test case and output only those values.\n\nRequirements:\n- Implement the model exactly as specified above.\n- Energy must be expressed in Hartree, rounded to six decimal places.\n- Distances must be used in angstrom.\n\nTest suite:\nProvide results for the following five parameter sets $(R, q_A, q_B)$:\n- Case $1$: $R = 1.0$ angstrom, $q_A = 1.0$, $q_B = 1.0$.\n- Case $2$: $R = 3.0$ angstrom, $q_A = 1.0$, $q_B = 1.0$.\n- Case $3$: $R = 10.0$ angstrom, $q_A = 1.0$, $q_B = 1.0$.\n- Case $4$: $R = 3.0$ angstrom, $q_A = 0.5$, $q_B = 2.0$.\n- Case $5$: $R = 3.0$ angstrom, $q_A = 5.0$, $q_B = 5.0$.\n\nFinal output format:\n- Your program should produce a single line of output containing the isolated size-consistency errors for the five cases, expressed as a comma-separated list of six-decimal-place floats enclosed in square brackets, for example, \"[0.000000,0.000000,0.000000,0.000000,0.000000]\".", "solution": "The problem statement has been subjected to rigorous validation. It is a well-posed, self-contained, and scientifically sound pedagogical exercise. It presents a simplified, yet principled, \"toy model\" to demonstrate the distinct mathematical natures of size-consistency error (SCE) and basis set superposition error (BSSE) in quantum chemistry, and to illustrate the function of the Boys-Bernardi counterpoise (CP) correction. All definitions, constants, and functional forms are provided unambiguously. The problem is therefore deemed valid and a solution will be provided.\n\nThe objective is to demonstrate that within this model, the counterpoise-corrected interaction energy, $\\Delta E_{\\mathrm{int}}^{\\mathrm{CP}}$, correctly isolates the size-consistency error, $\\Delta_{\\mathrm{SCE}}$, by eliminating the basis set superposition error. We will first prove this algebraically, and then compute the value of this isolated error for the specified test cases.\n\nThe counterpoise-corrected interaction energy is defined as:\n$$\n\\Delta E_{\\mathrm{int}}^{\\mathrm{CP}}(R,q_A,q_B) \\;=\\; E^{\\mathrm{uncorr}}_{\\mathrm{dimer}}(R,q_A,q_B) \\;-\\; \\big[E^{\\ast}_A(R,q_A) + E^{\\ast}_B(R,q_B)\\big]\n$$\nWe substitute the given expressions for the terms on the right-hand side. The uncorrected dimer energy is:\n$$\nE^{\\mathrm{uncorr}}_{\\mathrm{dimer}}(R,q_A,q_B) = \\big[E_{\\mathrm{ref}} + C_{\\mathrm{CID}}(q_A)\\big] + \\big[E_{\\mathrm{ref}} + C_{\\mathrm{CID}}(q_B)\\big] + \\Delta_{\\mathrm{SCE}}(q_A,q_B) + \\Delta_{\\mathrm{BSSE}}^{\\mathrm{dimer}}(R,q_A,q_B)\n$$\nThe sum of the monomer energies calculated in the dimer basis (the counterpoise correction terms) is:\n$$\nE^{\\ast}_A(R,q_A) + E^{\\ast}_B(R,q_B) = \\big[E_{\\mathrm{ref}} + C_{\\mathrm{CID}}(q_A) + \\Delta_{\\mathrm{BSSE}}^{A}(R,q_A)\\big] + \\big[E_{\\mathrm{ref}} + C_{\\mathrm{CID}}(q_B) + \\Delta_{\\mathrm{BSSE}}^{B}(R,q_B)\\big]\n$$\nBy definition, the total dimer BSSE is the sum of the monomer BSSE contributions: $\\Delta_{\\mathrm{BSSE}}^{\\mathrm{dimer}}(R,q_A,q_B) = \\Delta_{\\mathrm{BSSE}}^{A}(R,q_A) + \\Delta_{\\mathrm{BSSE}}^{B}(R,q_B)$. Therefore, the sum of counterpoise-corrected monomer energies can be rewritten as:\n$$\nE^{\\ast}_A(R,q_A) + E^{\\ast}_B(R,q_B) = \\big[E_{\\mathrm{ref}} + C_{\\mathrm{CID}}(q_A)\\big] + \\big[E_{\\mathrm{ref}} + C_{\\mathrm{CID}}(q_B)\\big] + \\Delta_{\\mathrm{BSSE}}^{\\mathrm{dimer}}(R,q_A,q_B)\n$$\nNow, we substitute these expanded forms back into the expression for $\\Delta E_{\\mathrm{int}}^{\\mathrm{CP}}$:\n$$\n\\Delta E_{\\mathrm{int}}^{\\mathrm{CP}} = \\Big( \\big[E_{\\mathrm{ref}} + C_{\\mathrm{CID}}(q_A)\\big] + \\big[E_{\\mathrm{ref}} + C_{\\mathrm{CID}}(q_B)\\big] + \\Delta_{\\mathrm{SCE}}(q_A,q_B) + \\Delta_{\\mathrm{BSSE}}^{\\mathrm{dimer}} \\Big) - \\Big( \\big[E_{\\mathrm{ref}} + C_{\\mathrm{CID}}(q_A)\\big] + \\big[E_{\\mathrm{ref}} + C_{\\mathrm{CID}}(q_B)\\big] + \\Delta_{\\mathrm{BSSE}}^{\\mathrm{dimer}} \\Big)\n$$\nUpon subtraction, all terms cancel except for the size-consistency error term. The terms related to the reference energy, the monomer correlation energies, and the basis set superposition error are perfectly removed by the counterpoise correction scheme, as designed in this model. This leaves:\n$$\n\\Delta E_{\\mathrm{int}}^{\\mathrm{CP}}(R,q_A,q_B) \\;=\\; \\Delta_{\\mathrm{SCE}}(q_A,q_B)\n$$\nThis algebraic proof confirms that the procedure correctly isolates the size-consistency error. It is also evident that this isolated error, $\\Delta_{\\mathrm{SCE}}$, is independent of the interatomic separation $R$, which is a fundamental characteristic of the size-consistency error for non-interacting fragments.\n\nThe computational task reduces to calculating $\\Delta_{\\mathrm{SCE}}(q_A, q_B)$ for the five given test cases. The formula is:\n$$\n\\Delta_{\\mathrm{SCE}}(q_A,q_B) \\;=\\; \\gamma \\,\\frac{C_{\\mathrm{CID}}(q_A)\\,C_{\\mathrm{CID}}(q_B)}{C_{\\mathrm{scale}}}\n$$\nwhere $C_{\\mathrm{CID}}(q)$ itself is given by:\n$$\nC_{\\mathrm{CID}}(q) \\;=\\; s_{\\mathrm{CID}}\\,C_{\\mathrm{true}}(q) \\;=\\; s_{\\mathrm{CID}}\\,\\left(-C_{\\infty}\\,\\frac{q}{q+q_{0}}\\right)\n$$\nSubstituting the constants $C_{\\infty} = 0.042$, $q_{0} = 1.0$, $s_{\\mathrm{CID}} = 0.9$, $\\gamma = 0.02$, and $C_{\\mathrm{scale}} = 0.05$, we will compute this quantity for each parameter set $(R, q_A, q_B)$.\n\nCase $1$: $(R=1.0, q_A=1.0, q_B=1.0)$\n$C_{\\mathrm{CID}}(1.0) = 0.9 \\left(-0.042 \\times \\frac{1.0}{1.0+1.0}\\right) = -0.0189$\n$\\Delta_{\\mathrm{SCE}}(1.0, 1.0) = 0.02 \\times \\frac{(-0.0189)^2}{0.05} = 0.000142884$\n\nCase $2$: $(R=3.0, q_A=1.0, q_B=1.0)$\nThe result is identical to Case $1$ as $\\Delta_{\\mathrm{SCE}}$ is independent of $R$.\n$\\Delta_{\\mathrm{SCE}}(1.0, 1.0) = 0.000142884$\n\nCase $3$: $(R=10.0, q_A=1.0, q_B=1.0)$\nThe result is identical to Case $1$.\n$\\Delta_{\\mathrm{SCE}}(1.0, 1.0) = 0.000142884$\n\nCase $4$: $(R=3.0, q_A=0.5, q_B=2.0)$\n$C_{\\mathrm{CID}}(0.5) = 0.9 \\left(-0.042 \\times \\frac{0.5}{0.5+1.0}\\right) = -0.0126$\n$C_{\\mathrm{CID}}(2.0) = 0.9 \\left(-0.042 \\times \\frac{2.0}{2.0+1.0}\\right) = -0.0252$\n$\\Delta_{\\mathrm{SCE}}(0.5, 2.0) = 0.02 \\times \\frac{(-0.0126) \\times (-0.0252)}{0.05} = 0.000127008$\n\nCase $5$: $(R=3.0, q_A=5.0, q_B=5.0)$\n$C_{\\mathrm{CID}}(5.0) = 0.9 \\left(-0.042 \\times \\frac{5.0}{5.0+1.0}\\right) = -0.0315$\n$\\Delta_{\\mathrm{SCE}}(5.0, 5.0) = 0.02 \\times \\frac{(-0.0315)^2}{0.05} = 0.0003969$\n\nThe final values, rounded to six decimal places, are:\n- Cases $1, 2, 3$: $0.000143$\n- Case $4$: $0.000127$\n- Case $5$: $0.000397$\n\nThe following program will implement these calculations.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the isolated size-consistency error (SCE) for a toy model of a\n    helium dimer, based on the problem specification.\n    \"\"\"\n\n    # Define the constants from the problem statement.\n    C_inf = 0.042     # Hartree\n    q0 = 1.0          # dimensionless\n    s_CID = 0.9       # dimensionless\n    E_ref = -2.8617   # Hartree\n    gamma = 0.02      # dimensionless\n    C_scale = 0.05    # Hartree\n    k = 1.2           # 1/angstrom\n    beta = 0.02       # Hartree\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple (R, q_A, q_B)\n    test_cases = [\n        (1.0, 1.0, 1.0),  # Case 1\n        (3.0, 1.0, 1.0),  # Case 2\n        (10.0, 1.0, 1.0), # Case 3\n        (3.0, 0.5, 2.0),  # Case 4\n        (3.0, 5.0, 5.0),  # Case 5\n    ]\n\n    results = []\n\n    def compute_c_cid(q):\n        \"\"\"\n        Computes the CID monomer correlation energy C_CID(q).\n        \n        Args:\n            q (float): The monomer basis quality parameter.\n        \n        Returns:\n            float: The CID correlation energy in Hartree.\n        \"\"\"\n        c_true = -C_inf * (q / (q + q0))\n        c_cid = s_CID * c_true\n        return c_cid\n\n    def compute_delta_sce(q_A, q_B):\n        \"\"\"\n        Computes the size-consistency error Δ_SCE(q_A, q_B).\n        \n        Args:\n            q_A (float): Basis quality parameter for monomer A.\n            q_B (float): Basis quality parameter for monomer B.\n            \n        Returns:\n            float: The size-consistency error in Hartree.\n        \"\"\"\n        c_cid_A = compute_c_cid(q_A)\n        c_cid_B = compute_c_cid(q_B)\n        delta_sce = gamma * (c_cid_A * c_cid_B) / C_scale\n        return delta_sce\n\n    for case in test_cases:\n        # The problem requires computing the isolated size-consistency error,\n        # which has been proven algebraically to be Δ_SCE(q_A, q_B).\n        # This quantity is independent of the separation R.\n        _R, q_A, q_B = case\n        \n        isolated_error = compute_delta_sce(q_A, q_B)\n        \n        # Round the result to six decimal places.\n        results.append(f\"{isolated_error:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2462360"}]}