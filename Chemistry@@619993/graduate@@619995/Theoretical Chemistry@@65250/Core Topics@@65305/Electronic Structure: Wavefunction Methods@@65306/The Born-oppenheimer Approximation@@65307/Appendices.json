{"hands_on_practices": [{"introduction": "The primary output of the Born-Oppenheimer approximation is the potential energy surface (PES), a landscape that dictates nuclear motion. This exercise provides a concrete link between the theoretical PES and experimentally measurable molecular properties. By fitting the curvature of a calculated Born-Oppenheimer potential to an analytical form like the Morse potential, you will extract key parameters such as the dissociation energy, which is fundamental to understanding chemical bond strength. [@problem_id:204375]", "problem": "In the framework of the Born-Oppenheimer approximation, the electronic energy of a diatomic molecule, for a given electronic state, defines a potential energy curve (PEC), $U(R)$, as a function of the internuclear distance $R$. A widely used analytical model for this PEC is the Morse potential, given by:\n$$ V(R) = D_e \\left(1 - e^{-a(R - R_e)}\\right)^2 $$\nHere, $D_e$ is the dissociation energy relative to the potential minimum, $R_e$ is the equilibrium bond distance, and $a$ is a parameter that controls the curvature of the potential well.\n\nA high-precision quantum chemistry calculation has been performed for a diatomic molecule, yielding the PEC, $U(R)$. Instead of fitting to a large set of data points, it is often convenient to characterize the potential by its properties near the minimum. The following quantities have been determined from the calculated PEC:\n1. The equilibrium bond distance, $R_e$.\n2. The harmonic force constant, $k_f = \\frac{d^2U}{dR^2}\\bigg|_{R=R_e}$.\n3. The cubic anharmonicity constant, $\\gamma = \\frac{d^3U}{dR^3}\\bigg|_{R=R_e}$.\n\nYour task is to find the parameters of the Morse potential that best reproduce the properties of the calculated PEC around its minimum. By matching the second and third derivatives of the Morse potential $V(R)$ to the given constants $k_f$ and $\\gamma$ at $R=R_e$, determine an analytical expression for the dissociation energy $D_e$ in terms of $k_f$ and $\\gamma$.", "solution": "The Morse potential is \n$$V(R)=D_e\\bigl(1-e^{-a(R-R_e)}\\bigr)^2.\\quad\\text{Let }x=R-R_e.$$\nExpand and differentiate:\n$$V(R)=D_e\\bigl(1-2e^{-ax}+e^{-2ax}\\bigr).$$\nFirst derivative:\n$$V'=D_e\\bigl(2a e^{-ax}-2a e^{-2ax}\\bigr).$$\nSecond derivative:\n$$V''=D_e\\bigl(-2a^2 e^{-ax}+4a^2 e^{-2ax}\\bigr)=2a^2D_e\\bigl(-e^{-ax}+2e^{-2ax}\\bigr).$$\nAt equilibrium ($x=0$):\n$$V''(0)=2a^2D_e=k_f.\\quad(1)$$\nThird derivative:\n$$V'''=D_e\\bigl(2a^3 e^{-ax}-8a^3 e^{-2ax}\\bigr)=2a^3D_e\\bigl(e^{-ax}-4e^{-2ax}\\bigr).$$\nAt $x=0$:\n$$V'''(0)=-6a^3D_e=\\gamma.\\quad(2)$$\nFrom (2)/(1):\n$$\\frac{\\gamma}{k_f}=\\frac{-6a^3D_e}{2a^2D_e}=-3a\\quad\\Longrightarrow\\quad a=-\\frac{\\gamma}{3k_f}.$$\nSubstitute into (1):\n$$D_e=\\frac{k_f}{2a^2}\n=\\frac{k_f}{2\\bigl(\\frac{\\gamma^2}{9k_f^2}\\bigr)}\n=\\frac{9k_f^3}{2\\gamma^2}.$$", "answer": "$$\\boxed{\\frac{9k_f^3}{2\\gamma^2}}$$", "id": "204375"}, {"introduction": "The Born-Oppenheimer approximation falters near \"avoided crossings\" where electronic states of the same symmetry would otherwise intersect, leading to rapid changes in the electronic wavefunctions. This practice takes you deep into the mathematical framework used to describe this breakdown. You will work with a two-state model to derive the nonadiabatic coupling, the very term responsible for mediating transitions between Born-Oppenheimer surfaces, which is the cornerstone of photochemistry and electron transfer theory. [@problem_id:2877190]", "problem": "In the Born–Oppenheimer approximation (BOA), the nuclear coordinate is treated as a parameter in the electronic Schrödinger equation, and the adiabatic electronic states are defined as the eigenfunctions of the electronic Hamiltonian at fixed nuclear geometry. Consider a $1$-dimensional nuclear coordinate $R$ and a $2$-state diabatic electronic basis $\\{|1\\rangle, |2\\rangle\\}$ that is chosen to be $R$-independent. The diabatic electronic Hamiltonian is\n$$\n\\hat{H}_{\\mathrm{d}}(R)\n=\n\\begin{pmatrix}\nV_{11}(R) & V_{12} \\\\\nV_{12} & V_{22}(R)\n\\end{pmatrix},\n$$\nwith the diabatic potentials and coupling specified by\n$$\nV_{11}(R)=\\kappa R,\\qquad V_{22}(R)=-\\kappa R,\\qquad V_{12}=V_{21}=V_c,\n$$\nwhere $\\kappa>0$ and $V_c>0$ are real constants.\n\nTransform to the adiabatic representation by diagonalizing $\\hat{H}_{\\mathrm{d}}(R)$ to obtain the adiabatic electronic states $\\{|\\phi_{+}(R)\\rangle,|\\phi_{-}(R)\\rangle\\}$. Then, within the BOA, define the nonadiabatic derivative coupling between the two adiabatic states as\n$$\n\\tau_{+-}(R)\\equiv\\langle \\phi_{+}(R)|\\partial_R|\\phi_{-}(R)\\rangle,\n$$\nwhere $\\partial_R$ denotes differentiation with respect to $R$ and the electronic diabatic basis is $R$-independent.\n\nConstruct this avoided-crossing model, perform the adiabatic transformation, and compute the closed-form expression for $\\tau_{+-}(R)$ as a function of $R$ in terms of $\\kappa$ and $V_c$. Express your final answer as a single analytic expression. No numerical evaluation is required.", "solution": "The problem asks for the nonadiabatic derivative coupling between two adiabatic electronic states, derived from a $2$-state diabatic model. The process involves three main steps:\n$1$. Diagonalization of the diabatic electronic Hamiltonian to find the adiabatic eigenvalues and eigenstates.\n$2$. Expression of the adiabatic eigenstates in terms of a mixing angle, which is a function of the nuclear coordinate $R$.\n$3$. Calculation of the derivative coupling using the definition $\\tau_{+-}(R)\\equiv\\langle \\phi_{+}(R)|\\partial_R|\\phi_{-}(R)\\rangle$.\n\nThe diabatic electronic Hamiltonian in the basis $\\{|1\\rangle, |2\\rangle\\}$ is given by:\n$$\n\\hat{H}_{\\mathrm{d}}(R) =\n\\begin{pmatrix}\nV_{11}(R) & V_{12} \\\\\nV_{21} & V_{22}(R)\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n\\kappa R & V_c \\\\\nV_c & -\\kappa R\n\\end{pmatrix}\n$$\nwhere $\\kappa > 0$ and $V_c > 0$ are real constants.\n\nFirst, we diagonalize this Hamiltonian to find the adiabatic potential energy surfaces, which are the eigenvalues $E_{\\pm}(R)$. The characteristic equation is $\\det(\\hat{H}_{\\mathrm{d}}(R) - E \\cdot \\mathbb{I}) = 0$.\n$$\n\\det \\begin{pmatrix} \\kappa R - E & V_c \\\\ V_c & -\\kappa R - E \\end{pmatrix} = 0\n$$\n$$\n(\\kappa R - E)(-\\kappa R - E) - V_c^2 = 0\n$$\n$$\n-(\\kappa R)^2 - \\kappa R E + \\kappa R E + E^2 - V_c^2 = 0\n$$\n$$\nE^2 = (\\kappa R)^2 + V_c^2\n$$\nThe eigenvalues are the adiabatic potentials:\n$$\nE_{\\pm}(R) = \\pm \\sqrt{(\\kappa R)^2 + V_c^2}\n$$\nWe associate $E_+(R)$ with the upper adiabatic state $|\\phi_{+}(R)\\rangle$ and $E_-(R)$ with the lower adiabatic state $|\\phi_{-}(R)\\rangle$.\n\nThe transformation from the diabatic basis $\\{|1\\rangle, |2\\rangle\\}$ to the adiabatic basis $\\{|\\phi_{+}(R)\\rangle, |\\phi_{-}(R)\\rangle\\}$ can be described by a rotation matrix $U(R)$:\n$$\nU(R) =\n\\begin{pmatrix}\n\\cos(\\theta(R)) & -\\sin(\\theta(R)) \\\\\n\\sin(\\theta(R)) & \\cos(\\theta(R))\n\\end{pmatrix}\n$$\nThe columns of this matrix are the adiabatic eigenvectors expressed in the diabatic basis.\n$$\n|\\phi_{+}(R)\\rangle = \\cos(\\theta(R))|1\\rangle + \\sin(\\theta(R))|2\\rangle = \\begin{pmatrix} \\cos(\\theta(R)) \\\\ \\sin(\\theta(R)) \\end{pmatrix}\n$$\n$$\n|\\phi_{-}(R)\\rangle = -\\sin(\\theta(R))|1\\rangle + \\cos(\\theta(R))|2\\rangle = \\begin{pmatrix} -\\sin(\\theta(R)) \\\\ \\cos(\\theta(R)) \\end{pmatrix}\n$$\nThe mixing angle $\\theta(R)$ is determined by the condition that $U(R)$ diagonalizes $\\hat{H}_{\\mathrm{d}}(R)$. The diagonalization condition sets the off-diagonal elements of the transformed Hamiltonian $\\hat{H}_{\\mathrm{ad}} = U^{\\dagger}(R) \\hat{H}_{\\mathrm{d}}(R) U(R)$ to zero. This leads to the well-known relation for a $2 \\times 2$ matrix of this form:\n$$\n\\tan(2\\theta(R)) = \\frac{2 V_{12}}{V_{11}(R) - V_{22}(R)} = \\frac{2V_c}{\\kappa R - (-\\kappa R)} = \\frac{2V_c}{2\\kappa R} = \\frac{V_c}{\\kappa R}\n$$\nFrom this relation, we can express $\\cos(2\\theta(R))$ in terms of $R$:\n$$\n\\cos(2\\theta(R)) = \\frac{\\kappa R}{\\sqrt{(\\kappa R)^2 + V_c^2}}\n$$\n\nNow, we compute the nonadiabatic derivative coupling $\\tau_{+-}(R)$.\n$$\n\\tau_{+-}(R) = \\langle \\phi_{+}(R)|\\partial_R|\\phi_{-}(R)\\rangle\n$$\nFirst, we find the derivative of the state vector $|\\phi_{-}(R)\\rangle$ with respect to $R$:\n$$\n\\partial_R |\\phi_{-}(R)\\rangle = \\partial_R \\begin{pmatrix} -\\sin(\\theta(R)) \\\\ \\cos(\\theta(R)) \\end{pmatrix} = \\begin{pmatrix} -\\cos(\\theta(R)) \\frac{d\\theta}{dR} \\\\ -\\sin(\\theta(R)) \\frac{d\\theta}{dR} \\end{pmatrix} = -\\frac{d\\theta}{dR} \\begin{pmatrix} \\cos(\\theta(R)) \\\\ \\sin(\\theta(R)) \\end{pmatrix} = -\\frac{d\\theta}{dR} |\\phi_{+}(R)\\rangle\n$$\nSubstituting this into the definition of $\\tau_{+-}(R)$:\n$$\n\\tau_{+-}(R) = \\left\\langle \\phi_{+}(R) \\left| \\left( -\\frac{d\\theta}{dR} |\\phi_{+}(R)\\rangle \\right) \\right. \\right\\rangle = -\\frac{d\\theta}{dR} \\langle \\phi_{+}(R) | \\phi_{+}(R) \\rangle\n$$\nSince the adiabatic states are normalized, $\\langle \\phi_{+}(R) | \\phi_{+}(R) \\rangle = 1$, the coupling simplifies to:\n$$\n\\tau_{+-}(R) = -\\frac{d\\theta}{dR}\n$$\nTo find $\\frac{d\\theta}{dR}$, we differentiate the expression for the mixing angle, $\\tan(2\\theta) = \\frac{V_c}{\\kappa R}$, with respect to $R$. Using the chain rule on the left side:\n$$\n\\frac{d}{dR} \\tan(2\\theta(R)) = \\sec^2(2\\theta(R)) \\cdot 2 \\frac{d\\theta}{dR}\n$$\nDifferentiating the right side:\n$$\n\\frac{d}{dR} \\left( \\frac{V_c}{\\kappa R} \\right) = -\\frac{V_c}{\\kappa R^2}\n$$\nEquating the two expressions:\n$$\n2 \\sec^2(2\\theta(R)) \\frac{d\\theta}{dR} = -\\frac{V_c}{\\kappa R^2}\n$$\nSolving for $\\frac{d\\theta}{dR}$:\n$$\n\\frac{d\\theta}{dR} = -\\frac{V_c}{2\\kappa R^2 \\sec^2(2\\theta(R))} = -\\frac{V_c \\cos^2(2\\theta(R))}{2\\kappa R^2}\n$$\nWe substitute the expression for $\\cos(2\\theta(R))$:\n$$\n\\cos^2(2\\theta(R)) = \\left(\\frac{\\kappa R}{\\sqrt{(\\kappa R)^2 + V_c^2}}\\right)^2 = \\frac{(\\kappa R)^2}{(\\kappa R)^2 + V_c^2}\n$$\nThis gives:\n$$\n\\frac{d\\theta}{dR} = -\\frac{V_c}{2\\kappa R^2} \\left( \\frac{(\\kappa R)^2}{(\\kappa R)^2 + V_c^2} \\right) = -\\frac{\\kappa V_c}{2((\\kappa R)^2 + V_c^2)}\n$$\nFinally, the nonadiabatic derivative coupling is:\n$$\n\\tau_{+-}(R) = -\\frac{d\\theta}{dR} = - \\left( -\\frac{\\kappa V_c}{2((\\kappa R)^2 + V_c^2)} \\right) = \\frac{\\kappa V_c}{2(\\kappa^2 R^2 + V_c^2)}\n$$\nThis is the closed-form expression for the nonadiabatic derivative coupling as a function of $R$ in terms of the constants $\\kappa$ and $V_c$.", "answer": "$$\n\\boxed{\\frac{\\kappa V_c}{2(\\kappa^2 R^2 + V_c^2)}}\n$$", "id": "2877190"}, {"introduction": "Building on the concept of nonadiabatic coupling, this final practice applies these principles to a computational simulation of a real chemical process: the photodissociation of NaI. You will implement the famous Landau-Zener model to predict the branching ratio between ionic and neutral products, a classic example of dynamics near an avoided crossing. This exercise bridges the gap from analytical theory to practical computational chemistry, demonstrating how these models predict the outcomes of chemical reactions. [@problem_id:2463678]", "problem": "Consider a one-dimensional two-state diabatic model for the photodissociation of sodium iodide (NaI) along the internuclear separation coordinate $R$ (in bohr), capturing the competition between ionic and neutral product channels near an avoided crossing where the Born–Oppenheimer approximation (BOA) may fail. The model Hamiltonian in the diabatic basis is\n$$\n\\mathbf{H}_\\mathrm{d}(R)=\n\\begin{pmatrix}\nE_\\mathrm{c} + \\kappa\\,(R-R_\\mathrm{c}) & C \\\\\nC & E_\\mathrm{c} - \\kappa\\,(R-R_\\mathrm{c})\n\\end{pmatrix},\n$$\nwhere $E_\\mathrm{c}$ is a constant energy shift (in Hartree), $\\kappa$ is a constant diabatic slope parameter (in Hartree/bohr), $R_\\mathrm{c}$ is the crossing location (in bohr), and $C$ is the diabatic electronic coupling (in Hartree). The corresponding adiabatic potential energy surfaces are the eigenvalues\n$$\nE_{\\pm}(R) = E_\\mathrm{c} \\pm \\sqrt{ \\left[\\kappa\\,(R-R_\\mathrm{c})\\right]^2 + C^2 },\n$$\nwith adiabatic energy gap\n$$\n\\Delta E_\\mathrm{ad}(R) \\equiv E_{+}(R)-E_{-}(R) = 2\\sqrt{ \\left[\\kappa\\,(R-R_\\mathrm{c})\\right]^2 + C^2 }.\n$$\nAssume that at small separation $R<R_\\mathrm{c}$ the diabatic state $1$ is ionic in character and diabatic state $2$ is neutral in character. At large separation $R>R_\\mathrm{c}$, these diabatic states correlate to the ionic and neutral product channels, respectively. An initially prepared wavefunction on diabatic state $1$ at $t\\to -\\infty$ moves through the crossing region with a constant relative nuclear speed $v$ (in bohr per atomic time unit), following the trajectory\n$$\nR(t) = R_\\mathrm{c} + v\\,t.\n$$\nThe speed $v$ is determined by the nuclear kinetic energy $E_\\mathrm{kin}$ (in Hartree) at the crossing and the reduced mass $\\mu$ (in atomic units of electron mass) by\n$$\nv = \\sqrt{\\frac{2\\,E_\\mathrm{kin}}{\\mu}}.\n$$\nUse the atomic mass unit $1\\,\\mathrm{u} = 1822.888486209$ in atomic units of electron mass. For sodium and iodine, use the isotopic masses $m_\\mathrm{Na}=22.98976928\\,\\mathrm{u}$ and $m_\\mathrm{I}=126.90447\\,\\mathrm{u}$, and the reduced mass\n$$\n\\mu = \\frac{m_\\mathrm{Na}\\,m_\\mathrm{I}}{m_\\mathrm{Na}+m_\\mathrm{I}} \\quad \\text{(in atomic units of electron mass).}\n$$\nYou must:\n- Compute the asymptotic probability $p_\\mathrm{ionic}$ to exit in the ionic product channel given the above two-state model and initial condition on diabatic state $1$ at $t\\to -\\infty$.\n- Identify the region in $R$ where the Born–Oppenheimer approximation is expected to fail based on an adiabatic gap threshold $E_\\mathrm{gap}^{(\\mathrm{thr})}$ (in Hartree), defined as the set of $R$ such that $\\Delta E_\\mathrm{ad}(R) \\le E_\\mathrm{gap}^{(\\mathrm{thr})}$. Report the interval endpoints `R_min` and `R_max` (in bohr). If no such $R$ exists, report `R_min=R_c` and `R_max=R_c`.\n- Determine the dominant product channel as an integer code: output `0` if the ionic channel dominates (i.e., $p_\\mathrm{ionic} \\ge 0.5$) and `1` if the neutral channel dominates (i.e., $p_\\mathrm{ionic} < 0.5$).\n\nAll energies must be in Hartree, all distances in bohr, all masses in atomic units of electron mass, and all speeds in bohr per atomic time unit. Angles are not used. Your program must evaluate the following test suite of parameter sets, each given as a tuple $(\\kappa, C, R_\\mathrm{c}, E_\\mathrm{kin}, E_\\mathrm{gap}^{(\\mathrm{thr})})$ with units as specified above:\n- Test $1$: $(0.02, 0.005, 12.0, 0.05, 0.02)$.\n- Test $2$: $(0.02, 0.02, 12.0, 0.05, 0.03)$.\n- Test $3$: $(0.02, 0.001, 12.0, 0.2, 0.005)$.\n\nFor each test case, output a list of four values `[p_ionic, R_min, R_max, product_code]`. The final output must be a single line containing a list of these three per-test-case lists, formatted as a comma-separated list enclosed in square brackets.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[[p1,Rmin1,Rmax1,code1],[p2,Rmin2,Rmax2,code2],[p3,Rmin3,Rmax3,code3]]\"). Numerical values must be floats for `p_ionic`, `R_min`, and `R_max`, and an integer for the product code. Express `R_min` and `R_max` in bohr and probabilities as dimensionless numbers. Round all floating-point outputs to six digits after the decimal point.", "solution": "The problem requires the calculation of three quantities for a two-state diabatic model of NaI photodissociation: the asymptotic probability of forming ionic products, the spatial region where the Born-Oppenheimer approximation (BOA) is expected to fail, and the dominant product channel.\n\n### 1. Asymptotic Ionic Probability ($p_\\mathrm{ionic}$)\n\nThe dynamics of the system are governed by the time-dependent Schrödinger equation with the provided diabatic Hamiltonian $\\mathbf{H}_\\mathrm{d}(R)$. By substituting the classical nuclear trajectory $R(t) = R_\\mathrm{c} + v\\,t$ into the Hamiltonian, we obtain a time-dependent Hamiltonian suitable for the Landau-Zener analysis:\n$$\n\\mathbf{H}_\\mathrm{d}(t)=\n\\begin{pmatrix}\nE_\\mathrm{c} + \\kappa\\,v\\,t & C \\\\\nC & E_\\mathrm{c} - \\kappa\\,v\\,t\n\\end{pmatrix}\n$$\nThe system is prepared in diabatic state $1$ at $t \\to -\\infty$, which corresponds to $R \\ll R_\\mathrm{c}$. The question asks for the probability to be found in the ionic channel at $t \\to +\\infty$. According to the problem, for $R > R_\\mathrm{c}$, diabatic state $1$ correlates to the ionic product channel. Thus, we must compute the probability of the system remaining in diabatic state $1$ after passing through the crossing region. This is a non-adiabatic transition in the adiabatic basis.\n\nLet us analyze the behavior of the adiabatic states. The adiabatic energies are $E_{\\pm}(R)$. For $R \\ll R_\\mathrm{c}$, the diabatic potential $V_{11}(R) = E_\\mathrm{c} + \\kappa(R-R_\\mathrm{c})$ is lower than $V_{22}(R) = E_\\mathrm{c} - \\kappa(R-R_\\mathrm{c})$ (assuming $\\kappa > 0$). Thus, at the start, the populated diabatic state $1$ corresponds to the lower adiabatic state $E_-(R)$. For $R \\gg R_\\mathrm{c}$, $V_{11}(R)$ becomes higher than $V_{22}(R)$, so diabatic state $1$ now corresponds to the upper adiabatic state $E_+(R)$.\n\nFor the system to start in diabatic state $1$ and end in diabatic state $1$, it must effectively transition from the lower adiabatic potential energy surface $E_-(R)$ to the upper one $E_+(R)$. The probability of such a non-adiabatic hop is given by the Landau-Zener formula:\n$$\nP_\\mathrm{LZ} = \\exp\\left(-\\frac{2\\pi |V_{12}|^2}{\\hbar |\\frac{d}{dt}(V_{11}-V_{22})|}\\right)\n$$\nIn our model, the coupling is $V_{12} = C$. The difference in the time-dependent diagonal potentials is $V_{11}(t) - V_{22}(t) = 2\\kappa v t$. The rate of change of this difference is $\\frac{d}{dt}(2\\kappa v t) = 2\\kappa v$. In atomic units, $\\hbar=1$. The transition probability, which is the desired ionic probability $p_\\mathrm{ionic}$, is therefore:\n$$\np_\\mathrm{ionic} = P_\\mathrm{LZ} = \\exp\\left(-\\frac{2\\pi C^2}{1 \\cdot |2\\kappa v|}\\right) = \\exp\\left(-\\frac{\\pi C^2}{|\\kappa| v}\\right)\n$$\nThe nuclear speed $v$ is determined by the kinetic energy at the crossing, $E_\\mathrm{kin}$, and the reduced mass of the system, $\\mu$:\n$$\nv = \\sqrt{\\frac{2 E_\\mathrm{kin}}{\\mu}}\n$$\nThe reduced mass $\\mu$ is calculated from the isotopic masses of Sodium ($m_\\mathrm{Na} = 22.98976928\\,\\mathrm{u}$) and Iodine ($m_\\mathrm{I} = 126.90447\\,\\mathrm{u}$). The conversion factor from atomic mass units to atomic units of electron mass is $1\\,\\mathrm{u} \\approx 1822.888486209\\,m_e$.\n$$\n\\mu = \\frac{m_\\mathrm{Na}\\,m_\\mathrm{I}}{m_\\mathrm{Na}+m_\\mathrm{I}} \\quad \\text{(in atomic units of electron mass)}\n$$\nThis allows for the complete determination of $p_\\mathrm{ionic}$.\n\n### 2. Born-Oppenheimer Approximation Failure Region\n\nThe Born-Oppenheimer approximation (BOA) is most likely to fail where the adiabatic potential energy surfaces are close to each other, as non-adiabatic coupling is inversely proportional to the energy gap. The problem defines this region as the set of internuclear separations $R$ for which the adiabatic energy gap $\\Delta E_\\mathrm{ad}(R)$ is less than or equal to a given threshold, $E_\\mathrm{gap}^{(\\mathrm{thr})}$.\n$$\n\\Delta E_\\mathrm{ad}(R) \\le E_\\mathrm{gap}^{(\\mathrm{thr})}\n$$\nSubstituting the expression for the gap, we get:\n$$\n2\\sqrt{ \\left[\\kappa\\,(R-R_\\mathrm{c})\\right]^2 + C^2 } \\le E_\\mathrm{gap}^{(\\mathrm{thr})}\n$$\nTo solve for $R$, we perform algebraic manipulation. Assuming $E_\\mathrm{gap}^{(\\mathrm{thr})} > 0$, we can square both sides:\n$$\n4\\left( \\left[\\kappa\\,(R-R_\\mathrm{c})\\right]^2 + C^2 \\right) \\le \\left(E_\\mathrm{gap}^{(\\mathrm{thr})}\\right)^2\n$$\n$$\n\\kappa^2 (R-R_\\mathrm{c})^2 \\le \\frac{\\left(E_\\mathrm{gap}^{(\\mathrm{thr})}\\right)^2}{4} - C^2\n$$\nThe left side is non-negative. This inequality has real solutions for $R$ only if the right-hand side is also non-negative, which requires $E_\\mathrm{gap}^{(\\mathrm{thr})} \\ge 2|C|$ (since the minimum gap is $\\Delta E_\\mathrm{ad}(R_\\mathrm{c}) = 2|C|$). If $E_\\mathrm{gap}^{(\\mathrm{thr})} < 2|C|$, no such $R$ exists, and as per the problem, we report $R_\\mathrm{min} = R_\\mathrm{max} = R_\\mathrm{c}$.\n\nIf $E_\\mathrm{gap}^{(\\mathrm{thr})} \\ge 2|C|$, we proceed:\n$$\n(R-R_\\mathrm{c})^2 \\le \\frac{1}{\\kappa^2}\\left( \\frac{\\left(E_\\mathrm{gap}^{(\\mathrm{thr})}\\right)^2}{4} - C^2 \\right)\n$$\nTaking the square root gives:\n$$\n|R-R_\\mathrm{c}| \\le \\frac{1}{|\\kappa|}\\sqrt{ \\frac{\\left(E_\\mathrm{gap}^{(\\mathrm{thr})}\\right)^2}{4} - C^2 }\n$$\nThis defines the interval $[R_\\mathrm{min}, R_\\mathrm{max}]$ where:\n$$\nR_\\mathrm{min} = R_\\mathrm{c} - \\frac{1}{|\\kappa|}\\sqrt{ \\frac{\\left(E_\\mathrm{gap}^{(\\mathrm{thr})}\\right)^2}{4} - C^2 }\n$$\n$$\nR_\\mathrm{max} = R_\\mathrm{c} + \\frac{1}{|\\kappa|}\\sqrt{ \\frac{\\left(E_\\mathrm{gap}^{(\\mathrm{thr})}\\right)^2}{4} - C^2 }\n$$\nThese formulas provide the endpoints of the required region.\n\n### 3. Dominant Product Channel\n\nThe dominant product channel is determined by comparing the ionic channel probability $p_\\mathrm{ionic}$ to the neutral channel probability $p_\\mathrm{neutral} = 1 - p_\\mathrm{ionic}$. The ionic channel dominates if its probability is greater. The problem specifies the condition and the corresponding integer codes:\n- If $p_\\mathrm{ionic} \\ge 0.5$, the ionic channel is dominant (or equiprobable). The output code is $0$.\n- If $p_\\mathrm{ionic} < 0.5$, the neutral channel is dominant. The output code is $1$.\n\n### Numerical Algorithm\n\nThe computational procedure is as follows:\n1.  Define the constants: $m_\\mathrm{Na}$, $m_\\mathrm{I}$, and the conversion factor from u to a.u. of electron mass.\n2.  Calculate the reduced mass $\\mu$ in atomic units of electron mass. This value is constant for all test cases.\n3.  For each test case $(\\kappa, C, R_\\mathrm{c}, E_\\mathrm{kin}, E_\\mathrm{gap}^{(\\mathrm{thr})})$:\n    a.  Compute the nuclear velocity $v = \\sqrt{2 E_\\mathrm{kin} / \\mu}$.\n    b.  Compute the ionic probability $p_\\mathrm{ionic} = \\exp(-\\pi C^2 / (|\\kappa| v))$.\n    c.  Determine the BOA failure region:\n        i.  If $E_\\mathrm{gap}^{(\\mathrm{thr})} < 2|C|$, set $R_\\mathrm{min} = R_\\mathrm{max} = R_\\mathrm{c}$.\n        ii. Else, calculate $R_\\mathrm{min}$ and $R_\\mathrm{max}$ using the derived formulas.\n    d.  Determine the product code: $0$ if $p_\\mathrm{ionic} \\ge 0.5$, otherwise $1$.\n    e.  Round the floating-point results ($p_\\mathrm{ionic}$, $R_\\mathrm{min}$, $R_\\mathrm{max}$) to six decimal places.\n4.  Format the results from all test cases into a single-line string representing a list of lists.\nThis procedure will be implemented in the provided Python environment.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the NaI photodissociation problem for a given set of test cases.\n    \"\"\"\n\n    # Physical constants\n    # Atomic mass unit in atomic units of electron mass\n    U_TO_AU_MASS = 1822.888486209\n    # Isotopic masses in atomic mass units (u)\n    M_NA_U = 22.98976928\n    M_I_U = 126.90447\n\n    # Calculate reduced mass in atomic units (electron mass)\n    mu_u = (M_NA_U * M_I_U) / (M_NA_U + M_I_U)\n    mu_au = mu_u * U_TO_AU_MASS\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (kappa, C, R_c, E_kin, E_gap_thr)\n    test_cases = [\n        (0.02, 0.005, 12.0, 0.05, 0.02),\n        (0.02, 0.02, 12.0, 0.05, 0.03),\n        (0.02, 0.001, 12.0, 0.2, 0.005),\n    ]\n\n    all_results = []\n    for case in test_cases:\n        kappa, C, R_c, E_kin, E_gap_thr = case\n\n        # 1. Compute asymptotic ionic probability (p_ionic)\n        \n        # Nuclear speed v in bohr per atomic time unit\n        v = np.sqrt(2 * E_kin / mu_au)\n        \n        # Landau-Zener probability for staying on the diabatic curve\n        # which corresponds to the ionic channel exit.\n        # kappa is positive, so abs(kappa) = kappa.\n        p_ionic = np.exp(-np.pi * C**2 / (kappa * v))\n\n        # 2. Compute the BOA failure region [R_min, R_max]\n        \n        # Minimum adiabatic gap is 2*C at the crossing R_c\n        min_gap = 2 * C\n        if E_gap_thr < min_gap:\n            # No region where the gap is smaller than the threshold\n            R_min = R_c\n            R_max = R_c\n        else:\n            # Solve Delta_E_ad(R) <= E_gap_thr for R\n            delta_R = (1 / kappa) * np.sqrt((E_gap_thr**2) / 4 - C**2)\n            R_min = R_c - delta_R\n            R_max = R_c + delta_R\n            \n        # 3. Determine the dominant product channel code\n        \n        # 0 for ionic, 1 for neutral\n        product_code = 0 if p_ionic >= 0.5 else 1\n        \n        # Store results for this case\n        all_results.append([p_ionic, R_min, R_max, product_code])\n\n    # Format the final output as a string\n    formatted_results = []\n    for result in all_results:\n        p, r_min, r_max, code = result\n        # Round floats to 6 decimal places and format\n        s_p = f\"{p:.6f}\"\n        s_r_min = f\"{r_min:.6f}\"\n        s_r_max = f\"{r_max:.6f}\"\n        s_code = str(code)\n        formatted_results.append(f\"[{s_p},{s_r_min},{s_r_max},{s_code}]\")\n\n    # Final print statement in the exact required format\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2463678"}]}