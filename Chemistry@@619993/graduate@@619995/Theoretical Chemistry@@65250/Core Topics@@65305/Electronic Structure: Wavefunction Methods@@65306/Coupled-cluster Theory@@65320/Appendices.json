{"hands_on_practices": [{"introduction": "Coupled-cluster theory can seem daunting, but its foundations are deeply connected to more familiar concepts like perturbation theory. This first exercise illuminates this connection by guiding you to derive the expression for the doubles amplitudes from second-order Møller–Plesset theory ($MP2$) as the lowest-order solution to the coupled-cluster doubles amplitude equations [@problem_id:2766799]. By applying a perturbative analysis to the similarity-transformed Hamiltonian, you will see how the complex, non-linear CC equations simplify to a well-known result, providing a solid anchor for your understanding.", "problem": "Consider a closed-shell Hartree–Fock (HF) reference determinant $|\\Phi_{0}\\rangle$ built from canonical spin orbitals with diagonal Fock matrix, so that the one-electron Fock operator satisfies $f |\\phi_{p}\\rangle = \\epsilon_{p} |\\phi_{p}\\rangle$, with orbital energies $\\epsilon_{p}$. Use Møller–Plesset partitioning of the electronic Hamiltonian $\\hat{H}$ into a zeroth-order Fock part and a fluctuation potential, and write the normal-ordered Hamiltonian with respect to $|\\Phi_{0}\\rangle$ as $\\hat{H}_{N} = \\hat{F}_{N} + \\hat{V}_{N}$. In coupled-cluster (CC) theory with cluster operator $\\hat{T}$, the amplitude equations are obtained by projecting the similarity-transformed Hamiltonian $\\bar{H} = \\exp(-\\hat{T}) \\hat{H}_{N} \\exp(\\hat{T})$ onto excited determinants. Focus on the doubles sector within coupled-cluster doubles (CCD) or coupled-cluster singles and doubles (CCSD), and assume canonical HF orbitals so that singles do not contribute at the lowest nonvanishing order by Brillouin’s theorem.\n\nStarting from the projected doubles amplitude equation $0 = \\langle \\Phi_{ij}^{ab} | \\bar{H} | \\Phi_{0} \\rangle$, where indices $i,j$ denote occupied orbitals and $a,b$ virtual orbitals, derive the lowest-order (in the fluctuation potential) analytic expression for the doubles amplitude $t_{ij}^{ab}$ in terms of antisymmetrized two-electron integrals and orbital energies. Clearly state any truncations of the Baker–Campbell–Hausdorff expansion you invoke and justify them by perturbation-theory order counting. Define the antisymmetrized two-electron integral as $\\bar{v}_{ij}^{ab} = \\langle ij \\Vert ab \\rangle$, and provide your final result as a single closed-form analytic expression for $t_{ij}^{ab}$ in terms of $\\bar{v}_{ij}^{ab}$ and the set $\\{\\epsilon_{p}\\}$.\n\nYour final answer must be a single closed-form analytic expression. Do not include units. No numerical evaluation or rounding is required.", "solution": "The problem requires the derivation of the lowest-order expression for the coupled-cluster doubles amplitude, $t_{ij}^{ab}$, starting from the projected coupled-cluster equation. The analysis will proceed by invoking the Møller–Plesset (MP) partitioning of the Hamiltonian and applying perturbation-theory order counting.\n\nThe electronic Hamiltonian $\\hat{H}$ is partitioned into a zeroth-order Fock operator $\\hat{F}_0$ and a first-order fluctuation potential $\\hat{V}$. In the normal-ordered formalism with respect to the Hartree-Fock reference determinant $|\\Phi_0\\rangle$, the Hamiltonian is $\\hat{H}_N = \\hat{F}_N + \\hat{V}_N$. Here, $\\hat{F}_N$ is zeroth-order and $\\hat{V}_N$ is first-order in the perturbation. The coupled-cluster (CC) wave function is given by $|\\Psi_{CC}\\rangle = \\exp(\\hat{T})|\\Phi_0\\rangle$, where the cluster operator is $\\hat{T} = \\hat{T}_1 + \\hat{T}_2 + \\dots$. For this problem, we consider coupled-cluster doubles (CCD) or singles and doubles (CCSD), so $\\hat{T} \\approx \\hat{T}_1 + \\hat{T}_2$.\n\nThe amplitudes for the doubles part of the cluster operator, $\\hat{T}_2 = \\frac{1}{4} \\sum_{ijab} t_{ij}^{ab} a^\\dagger_a a^\\dagger_b a_j a_i$, are determined by projecting the similarity-transformed Schrödinger equation onto the space of doubly excited determinants $|\\Phi_{ij}^{ab}\\rangle = a^\\dagger_a a^\\dagger_b a_j a_i |\\Phi_0\\rangle$. This yields the amplitude equation:\n$$\n0 = \\langle \\Phi_{ij}^{ab} | \\bar{H} | \\Phi_0 \\rangle\n$$\nwhere $\\bar{H} = \\exp(-\\hat{T}) \\hat{H}_N \\exp(\\hat{T})$.\n\nTo find the lowest-order expression for $t_{ij}^{ab}$, we expand $\\bar{H}$ using the Baker–Campbell–Hausdorff (BCH) formula:\n$$\n\\bar{H} = \\hat{H}_N + [\\hat{H}_N, \\hat{T}] + \\frac{1}{2}[[\\hat{H}_N, \\hat{T}], \\hat{T}] + \\dots\n$$\nSubstituting this into the amplitude equation gives:\n$$\n0 = \\langle \\Phi_{ij}^{ab} | \\hat{H}_N + [\\hat{H}_N, \\hat{T}] + \\frac{1}{2}[[\\hat{H}_N, \\hat{T}], \\hat{T}] + \\dots | \\Phi_0 \\rangle\n$$\nWe now perform an order analysis based on the MP partitioning. The operators and amplitudes are assigned an order in the fluctuation potential:\n- The normal-ordered Fock operator $\\hat{F}_N$ is zeroth-order, $O(0)$.\n- The normal-ordered fluctuation potential $\\hat{V}_N$ is first-order, $O(1)$.\n- Thus, $\\hat{H}_N = \\hat{F}_N^{(0)} + \\hat{V}_N^{(1)}$.\n- The cluster amplitudes are expanded perturbatively: $\\hat{T} = \\hat{T}^{(1)} + \\hat{T}^{(2)} + \\dots$.\n\nFor canonical Hartree-Fock orbitals, Brillouin's theorem states that matrix elements of the full Hamiltonian between the HF determinant and singly excited determinants are zero. This implies that the first-order singles amplitudes, $t_i^{a(1)}$, are zero. Thus, $\\hat{T}_1$ contributes only at second order and higher, $\\hat{T}_1 \\sim O(2)$. The doubles amplitudes, however, have a first-order contribution, so $\\hat{T}_2 = \\hat{T}_2^{(1)} + \\hat{T}_2^{(2)} + \\dots$, where $\\hat{T}_2^{(1)} \\sim O(1)$.\n\nTo find the lowest-order (first-order) expression for $t_{ij}^{ab}$, we need to collect all terms in the expanded amplitude equation that are of first order.\n\n1.  **Term 1: $\\langle \\Phi_{ij}^{ab} | \\hat{H}_N | \\Phi_0 \\rangle$**\n    Since $\\hat{H}_N = \\hat{F}_N^{(0)} + \\hat{V}_N^{(1)}$, we have $\\langle \\Phi_{ij}^{ab} | \\hat{F}_N^{(0)} | \\Phi_0 \\rangle + \\langle \\Phi_{ij}^{ab} | \\hat{V}_N^{(1)} | \\Phi_0 \\rangle$.\n    The operator $\\hat{F}_N$ is a one-body operator and cannot connect the reference $|\\Phi_0\\rangle$ to a doubly excited determinant $|\\Phi_{ij}^{ab}\\rangle$. Thus, $\\langle \\Phi_{ij}^{ab} | \\hat{F}_N | \\Phi_0 \\rangle = 0$.\n    The term $\\langle \\Phi_{ij}^{ab} | \\hat{V}_N | \\Phi_0 \\rangle$ involves the two-body fluctuation potential, which can directly couple the reference to a doubly excited state. This matrix element is, by definition, the antisymmetrized two-electron integral $\\bar{v}_{ij}^{ab} = \\langle ij \\Vert ab \\rangle$. This term is first-order.\n    $$\n    \\langle \\Phi_{ij}^{ab} | \\hat{H}_N | \\Phi_0 \\rangle = \\bar{v}_{ij}^{ab}\n    $$\n\n2.  **Term 2: $\\langle \\Phi_{ij}^{ab} | [\\hat{H}_N, \\hat{T}] | \\Phi_0 \\rangle$**\n    We expand this as $\\langle \\Phi_{ij}^{ab} | [\\hat{F}_N^{(0)} + \\hat{V}_N^{(1)}, \\hat{T}_1 + \\hat{T}_2] | \\Phi_0 \\rangle$.\n    To obtain a first-order contribution, we must combine the zeroth-order part of $\\hat{H}_N$ with the first-order part of $\\hat{T}$. As established, $\\hat{T}_1^{(1)}=0$, so we only consider $\\hat{T}_2^{(1)}$. The relevant term is $\\langle \\Phi_{ij}^{ab} | [\\hat{F}_N^{(0)}, \\hat{T}_2^{(1)}] | \\Phi_0 \\rangle$.\n    The action of the commutator on the reference state is:\n    $$\n    [\\hat{F}_N, \\hat{T}_2]|\\Phi_0\\rangle = \\hat{F}_N \\hat{T}_2 |\\Phi_0\\rangle - \\hat{T}_2 \\hat{F}_N |\\Phi_0\\rangle\n    $$\n    The normal-ordered Fock operator annihilates the reference vacuum, $\\hat{F}_N |\\Phi_0\\rangle = 0$. So the second term vanishes.\n    The first term is $\\hat{F}_N \\hat{T}_2 |\\Phi_0\\rangle$. The operator $\\hat{T}_2$ acting on the reference creates a linear combination of doubly excited determinants: $\\hat{T}_2|\\Phi_0\\rangle = \\frac{1}{4} \\sum_{klcd} t_{kl}^{cd} |\\Phi_{kl}^{cd}\\rangle$.\n    For canonical orbitals, excited determinants are eigenstates of $\\hat{F}_N$:\n    $$\n    \\hat{F}_N |\\Phi_{kl}^{cd}\\rangle = (\\epsilon_c + \\epsilon_d - \\epsilon_k - \\epsilon_l) |\\Phi_{kl}^{cd}\\rangle\n    $$\n    Therefore, the matrix element becomes:\n    $$\n    \\langle \\Phi_{ij}^{ab} | \\hat{F}_N \\hat{T}_2 | \\Phi_0 \\rangle = \\frac{1}{4} \\sum_{klcd} t_{kl}^{cd} (\\epsilon_c + \\epsilon_d - \\epsilon_k - \\epsilon_l) \\langle \\Phi_{ij}^{ab} | \\Phi_{kl}^{cd} \\rangle\n    $$\n    Due to the orthogonality of the determinants, the only term that survives the summation is for $(k,l)$ being a permutation of $(i,j)$ and $(c,d)$ being a permutation of $(a,b)$. After accounting for the antisymmetry of the amplitudes and determinants, this expression simplifies to:\n    $$\n    \\langle \\Phi_{ij}^{ab} | [\\hat{F}_N, \\hat{T}_2^{(1)}] | \\Phi_0 \\rangle = t_{ij}^{ab(1)} (\\epsilon_a + \\epsilon_b - \\epsilon_i - \\epsilon_j)\n    $$\n    This term is of first-order ($O(0) \\times O(1)$).\n\n3.  **Higher-Order Terms**\n    All other terms in the BCH expansion are of second or higher order. For instance:\n    - $\\langle \\Phi_{ij}^{ab} | [\\hat{V}_N^{(1)}, \\hat{T}^{(1)}] | \\Phi_0 \\rangle$ is of second order.\n    - $\\langle \\Phi_{ij}^{ab} | [[\\hat{F}_N^{(0)}, \\hat{T}^{(1)}], \\hat{T}^{(1)}] | \\Phi_0 \\rangle$ is of second order.\n    These terms are justifiably neglected in a lowest-order derivation. The truncation of the BCH expansion after the first commutator term (plus the bare Hamiltonian) is thereby justified for a first-order perturbative analysis.\n\n**Assembling the Lowest-Order Equation**\nCollecting all first-order terms, the doubles amplitude equation becomes:\n$$\n0 = \\bar{v}_{ij}^{ab} + t_{ij}^{ab(1)} (\\epsilon_a + \\epsilon_b - \\epsilon_i - \\epsilon_j)\n$$\nSolving for the first-order doubles amplitude $t_{ij}^{ab(1)}$ yields:\n$$\nt_{ij}^{ab(1)} (\\epsilon_i + \\epsilon_j - \\epsilon_a - \\epsilon_b) = \\bar{v}_{ij}^{ab}\n$$\n$$\nt_{ij}^{ab(1)} = \\frac{\\bar{v}_{ij}^{ab}}{\\epsilon_i + \\epsilon_j - \\epsilon_a - \\epsilon_b}\n$$\nThis expression is the lowest-order approximation to the doubles amplitude $t_{ij}^{ab}$ and is identical to the expression for doubles amplitudes in second-order Møller-Plesset perturbation theory (MP2).", "answer": "$$\n\\boxed{\\frac{\\bar{v}_{ij}^{ab}}{\\epsilon_{i} + \\epsilon_{j} - \\epsilon_{a} - \\epsilon_{b}}}\n$$", "id": "2766799"}, {"introduction": "Having established the link to perturbation theory, we now explore the remarkable power of coupled-cluster theory in a case where it provides the exact solution. This practice focuses on a minimal two-electron system, a fundamental model in quantum chemistry, for which the coupled-cluster with singles and doubles (CCSD) method is exact [@problem_id:2766789]. By explicitly deriving the amplitude equations and the resulting energy, you will demonstrate that the CCSD result is identical to the full configuration interaction (FCI) energy, thereby proving a key property of the theory.", "problem": "Consider a closed-shell two-electron system described in a canonical restricted Hartree–Fock (RHF) spin-orbital basis with exactly one doubly occupied spatial orbital $i$ and one virtual spatial orbital $a$. Let $|\\Phi_{0}\\rangle$ denote the RHF reference determinant (both electrons in $i$ with opposite spins) and let the unique doubly excited determinant be $|\\Phi_{2}\\rangle \\equiv |\\Phi_{i i}^{a a}\\rangle$ (both electrons promoted to $a$ with opposite spins). Work with the electronic Hamiltonian $\\hat{H}$ in second quantization, and define the matrix elements $H_{00} \\equiv \\langle \\Phi_{0}|\\hat{H}|\\Phi_{0}\\rangle$, $H_{22} \\equiv \\langle \\Phi_{2}|\\hat{H}|\\Phi_{2}\\rangle$, and $H_{20} \\equiv \\langle \\Phi_{2}|\\hat{H}|\\Phi_{0}\\rangle = \\langle \\Phi_{0}|\\hat{H}|\\Phi_{2}\\rangle$.\n\nStarting from the coupled-cluster ansatz $|\\Psi\\rangle = \\exp(\\hat{T})|\\Phi_{0}\\rangle$ with cluster operator $\\hat{T} = \\hat{T}_{1} + \\hat{T}_{2}$, proceed as follows:\n\n- Use only the foundational definitions of coupled-cluster theory (exponential ansatz, similarity-transformed Hamiltonian $\\bar{H} \\equiv \\exp(-\\hat{T}) \\hat{H} \\exp(\\hat{T})$, and projection equations) together with canonical RHF properties. Derive from first principles that in this system the singles amplitudes vanish, so that $\\hat{T}_{1} = 0$, and that only one independent double-excitation amplitude survives, $t \\equiv t_{i\\alpha\\, i\\beta}^{a\\alpha\\, a\\beta}$.\n\n- Exploit the finite-dimensional structure of this two-determinant subspace and the Baker–Campbell–Hausdorff expansion to show that, for this system, the Baker–Campbell–Hausdorff series truncates exactly at the double commutator, and obtain a closed Riccati-type equation for $t$ from the projected amplitude condition $\\langle \\Phi_{2}| \\bar{H} |\\Phi_{0}\\rangle = 0$.\n\n- Derive the coupled-cluster with singles and doubles (CCSD) energy from $E = \\langle \\Phi_{0}| \\bar{H} |\\Phi_{0}\\rangle$ in terms of $t$ and the Hamiltonian matrix elements defined above.\n\n- Show by explicit comparison with the full configuration interaction (FCI) secular problem in the $\\{|\\Phi_{0}\\rangle, |\\Phi_{2}\\rangle\\}$ basis that the CCSD energy coincides with the exact FCI ground-state energy for this two-electron system.\n\nYour final answer must be a single closed-form analytic expression for the exact correlated ground-state energy $E$ in terms of $H_{00}$, $H_{22}$, and $H_{20}$ only. Do not include units and do not provide an inequality or an equation as your final answer; provide a single expression. No numerical evaluation is required.", "solution": "We begin by analyzing the structure of the Hilbert space and the cluster operator $\\hat{T} = \\hat{T}_1 + \\hat{T}_2$. The system consists of two electrons in a restricted Hartree-Fock (RHF) ground state determinant $|\\Phi_0\\rangle = |i\\alpha, i\\beta\\rangle$, where $i$ is the single occupied spatial orbital. The only available virtual spatial orbital is $a$.\n\nThe exact wavefunction, or FCI wavefunction $|\\Psi_{\\text{FCI}}\\rangle$, must be an eigenfunction of the Hamiltonian $\\hat{H}$ and the total spin operator $\\hat{S}^2$. Since we start from a closed-shell singlet RHF determinant, and the Hamiltonian is spin-independent, the ground state must be a singlet. Possible excited determinants are singly-excited and doubly-excited.\nSingly-excited determinants, like $|\\Phi_{i\\alpha}^{a\\alpha}\\rangle$, must be combined to form spin-adapted configurations. The singlet singly-excited configuration is ${}^1|\\Phi_{i}^{a}\\rangle = \\frac{1}{\\sqrt{2}}(|\\Phi_{i\\alpha}^{a\\alpha}\\rangle + |\\Phi_{i\\beta}^{a\\beta}\\rangle)$. By Brillouin's theorem, for canonical RHF orbitals, the Hamiltonian does not couple the reference determinant to singly-excited determinants: $\\langle {}^1\\Phi_{i}^{a} | \\hat{H} | \\Phi_0 \\rangle = 0$.\nThe only possible doubly-excited determinant is $|\\Phi_2\\rangle \\equiv |\\Phi_{ii}^{aa}\\rangle = |a\\alpha, a\\beta\\rangle$, which is already a singlet. This determinant couples to the reference via the two-electron part of the Hamiltonian, so $\\langle \\Phi_2 | \\hat{H} | \\Phi_0 \\rangle = H_{20} \\neq 0$ in general. No other excitations are possible. Thus, the FCI space is spanned only by $\\{|\\Phi_0\\rangle, |\\Phi_2\\rangle\\}$, and the exact ground-state wavefunction has the form $|\\Psi_{\\text{FCI}}\\rangle = c_0 |\\Phi_0\\rangle + c_2 |\\Phi_2\\rangle$.\n\nThe coupled-cluster ansatz is $|\\Psi_{\\text{CC}}\\rangle = \\exp(\\hat{T})|\\Phi_0\\rangle$. Expanding this gives:\n$$|\\Psi_{\\text{CC}}\\rangle = (1 + \\hat{T}_1 + \\hat{T}_2 + \\frac{1}{2}\\hat{T}_1^2 + \\dots)|\\Phi_0\\rangle = |\\Phi_0\\rangle + \\hat{T}_1|\\Phi_0\\rangle + \\hat{T}_2|\\Phi_0\\rangle + \\dots$$\nThe operator $\\hat{T}_1$ generates a linear combination of singly-excited determinants. Since these are absent from the exact wavefunction $|\\Psi_{\\text{FCI}}\\rangle$, their coefficients in the expansion of $|\\Psi_{\\text{CC}}\\rangle$ must be zero. This requires $\\hat{T}_1|\\Phi_0\\rangle = 0$, which implies that all single-excitation amplitudes are zero. Therefore, $\\hat{T}_1 = 0$.\nThe operator $\\hat{T}_2$ generates doubly-excited determinants. In this system, only one such excitation is possible, from orbital pair $(i,i)$ to $(a,a)$. We define its amplitude as $t$. The corresponding operator is $\\hat{T}_2 = t \\, a_{a\\alpha}^\\dagger a_{a\\beta}^\\dagger a_{i\\beta} a_{i\\alpha}$. By this definition, $\\hat{T}_2|\\Phi_0\\rangle = t|\\Phi_2\\rangle$. Thus we have established the first point requested.\n\nNext, we analyze the Baker-Campbell-Hausdorff (BCH) expansion for the similarity-transformed Hamiltonian $\\bar{H} = \\exp(-\\hat{T})\\hat{H}\\exp(\\hat{T})$. With $\\hat{T}=\\hat{T}_2$, this is $\\bar{H} = \\exp(-\\hat{T}_2)\\hat{H}\\exp(\\hat{T}_2)$. The key insight for this system is that the operator $\\hat{T}_2$ squares to zero. The operator $a_{i\\alpha}$ annihilates an electron in spin-orbital $i\\alpha$. If we apply $\\hat{T}_2$ twice, the second application would involve creation operators $a_{a\\alpha}^\\dagger, a_{a\\beta}^\\dagger$ acting on a state that already has these orbitals occupied (in $|\\Phi_2\\rangle$), resulting in zero by the Pauli exclusion principle. More formally, $\\hat{T}_2 = t \\hat{A}$ where $\\hat{A} = a_{a\\alpha}^\\dagger a_{a\\beta}^\\dagger a_{i\\beta} a_{i\\alpha}$. Since there is only one virtual spatial orbital $a$, $(\\hat{A})^2 = 0$. Therefore, the operator $\\hat{T}_2$ is nilpotent of order $2$: $\\hat{T}_2^2 = 0$.\nThis immediately truncates the Taylor series for the exponential: $\\exp(\\hat{T}_2) = 1 + \\hat{T}_2$.\nThe BCH series is $\\bar{H} = \\hat{H} + [\\hat{H}, \\hat{T}_2] + \\frac{1}{2}[[\\hat{H}, \\hat{T}_2], \\hat{T}_2] + \\frac{1}{6}[[[\\hat{H}, \\hat{T}_2], \\hat{T}_2], \\hat{T}_2] + \\dots$.\nLet's evaluate the commutators:\n$[[\\hat{H}, \\hat{T}_2], \\hat{T}_2] = [\\hat{H}\\hat{T}_2 - \\hat{T}_2\\hat{H}, \\hat{T}_2] = \\hat{H}\\hat{T}_2^2 - \\hat{T}_2\\hat{H}\\hat{T}_2 - \\hat{T}_2\\hat{H}\\hat{T}_2 + \\hat{T}_2^2\\hat{H} = -2\\hat{T}_2\\hat{H}\\hat{T}_2$ (since $\\hat{T}_2^2=0$).\nThe triple commutator is $[[[\\hat{H}, \\hat{T}_2], \\hat{T}_2], \\hat{T}_2] = [-2\\hat{T}_2\\hat{H}\\hat{T}_2, \\hat{T}_2] = -2(\\hat{T}_2\\hat{H}\\hat{T}_2^2 - \\hat{T}_2^2\\hat{H}\\hat{T}_2) = 0$.\nAll higher-order commutators are also zero. Thus, the BCH series terminates exactly at the double commutator:\n$\\bar{H} = \\hat{H} + [\\hat{H}, \\hat{T}_2] - \\hat{T}_2\\hat{H}\\hat{T}_2$.\nAlternatively, $\\bar{H} = (1-\\hat{T}_2)\\hat{H}(1+\\hat{T}_2) = \\hat{H} + \\hat{H}\\hat{T}_2 - \\hat{T}_2\\hat{H} - \\hat{T}_2\\hat{H}\\hat{T}_2$.\n\nNow, we derive the equation for the amplitude $t$ from the projected Schrödinger equation $\\langle \\Phi_2 | \\bar{H} | \\Phi_0 \\rangle = 0$.\n$$ \\langle \\Phi_2 | (\\hat{H} + \\hat{H}\\hat{T}_2 - \\hat{T}_2\\hat{H} - \\hat{T}_2\\hat{H}\\hat{T}_2) | \\Phi_0 \\rangle = 0 $$\nWe evaluate each term:\n1. $\\langle \\Phi_2 | \\hat{H} | \\Phi_0 \\rangle = H_{20}$.\n2. $\\langle \\Phi_2 | \\hat{H}\\hat{T}_2 | \\Phi_0 \\rangle = \\langle \\Phi_2 | \\hat{H} (t|\\Phi_2\\rangle) = t \\langle \\Phi_2 | \\hat{H} | \\Phi_2 \\rangle = t H_{22}$.\n3. $\\langle \\Phi_2 | \\hat{T}_2\\hat{H} | \\Phi_0 \\rangle = ( \\langle \\Phi_0 | \\hat{H}^\\dagger \\hat{T}_2^\\dagger | \\Phi_2 \\rangle )^*$. With $\\hat{H}$ Hermitian and real matrix elements, this is $\\langle \\Phi_0 | \\hat{H} \\hat{T}_2^\\dagger | \\Phi_2 \\rangle$. The operator $\\hat{T}_2^\\dagger = t^* a_{i\\alpha}^\\dagger a_{i\\beta}^\\dagger a_{a\\beta} a_{a\\alpha}$. Acting on $|\\Phi_2\\rangle = a_{a\\alpha}^\\dagger a_{a\\beta}^\\dagger |\\text{vac}\\rangle$ gives $\\hat{T}_2^\\dagger |\\Phi_2\\rangle = t^* |\\Phi_0\\rangle$. Assuming $t$ is real, this is $t|\\Phi_0\\rangle$. The term becomes $\\langle \\Phi_0 | \\hat{H} (t|\\Phi_0\\rangle) = t \\langle \\Phi_0 | \\hat{H} | \\Phi_0 \\rangle = t H_{00}$.\n4. $\\langle \\Phi_2 | \\hat{T}_2\\hat{H}\\hat{T}_2 | \\Phi_0 \\rangle = \\langle \\Phi_2 | \\hat{T}_2\\hat{H} (t|\\Phi_2\\rangle) = t ( \\langle \\Phi_2 | \\hat{T}_2\\hat{H} |\\Phi_2\\rangle )$. Using the same adjoint trick, $\\langle \\Phi_2 | \\hat{T}_2\\hat{H} |\\Phi_2\\rangle = (\\langle \\Phi_2 | \\hat{H}^\\dagger \\hat{T}_2^\\dagger |\\Phi_2\\rangle)^* = ( \\langle \\Phi_2 | \\hat{H} (t|\\Phi_0\\rangle) )^* = t H_{20}$. The full term is $t(t H_{20}) = t^2 H_{20}$.\n\nCombining these results, the amplitude equation for $t$ is:\n$H_{20} + t H_{22} - t H_{00} - t^2 H_{20} = 0$, which is a Riccati-type equation: $H_{20}(1 - t^2) + t(H_{22} - H_{00}) = 0$.\n\nThe CCSD energy is $E = \\langle \\Phi_0 | \\bar{H} | \\Phi_0 \\rangle$.\n$$ E = \\langle \\Phi_0 | (\\hat{H} + \\hat{H}\\hat{T}_2 - \\hat{T}_2\\hat{H} - \\hat{T}_2\\hat{H}\\hat{T}_2) | \\Phi_0 \\rangle $$\nWe evaluate each term's contribution to the energy:\n1. $\\langle \\Phi_0 | \\hat{H} | \\Phi_0 \\rangle = H_{00}$.\n2. $\\langle \\Phi_0 | \\hat{H}\\hat{T}_2 | \\Phi_0 \\rangle = \\langle \\Phi_0 | \\hat{H} (t|\\Phi_2\\rangle) = t \\langle \\Phi_0 | \\hat{H} | \\Phi_2 \\rangle = t H_{02} = t H_{20}$.\n3. $\\langle \\Phi_0 | \\hat{T}_2\\hat{H} | \\Phi_0 \\rangle = 0$ because $\\langle \\Phi_0 | \\hat{T}_2 = (\\hat{T}_2^\\dagger |\\Phi_0\\rangle)^\\dagger = 0$, as $\\hat{T}_2^\\dagger$ contains annihilation operators for virtual orbitals, which are not present in $|\\Phi_0\\rangle$.\n4. $\\langle \\Phi_0 | \\hat{T}_2\\hat{H}\\hat{T}_2 | \\Phi_0 \\rangle = 0$ for the same reason.\nThe CCSD energy is therefore $E = H_{00} + t H_{20}$.\n\nTo find the explicit form of the energy, we solve the quadratic equation for $t$: $H_{20} t^2 - (H_{22} - H_{00})t - H_{20} = 0$.\nThe solutions are $t = \\frac{(H_{22} - H_{00}) \\pm \\sqrt{(H_{22} - H_{00})^2 + 4H_{20}^2}}{2H_{20}}$. For the amplitude $t$ to vanish as the interaction $H_{20}$ vanishes, we must choose the negative sign.\n$$ t = \\frac{H_{22} - H_{00} - \\sqrt{(H_{22} - H_{00})^2 + 4H_{20}^2}}{2H_{20}} $$\nSubstituting this into the energy expression:\n$$ E = H_{00} + \\left( \\frac{H_{22} - H_{00} - \\sqrt{(H_{22} - H_{00})^2 + 4H_{20}^2}}{2H_{20}} \\right) H_{20} $$\n$$ E = H_{00} + \\frac{H_{22} - H_{00} - \\sqrt{(H_{22} - H_{00})^2 + 4H_{20}^2}}{2} $$\n$$ E = \\frac{2H_{00} + H_{22} - H_{00} - \\sqrt{(H_{22} - H_{00})^2 + 4H_{20}^2}}{2} $$\n$$ E = \\frac{H_{00} + H_{22} - \\sqrt{(H_{22} - H_{00})^2 + 4H_{20}^2}}{2} $$\n\nFinally, we compare this to the FCI result. The FCI Hamiltonian in the $\\{|\\Phi_0\\rangle, |\\Phi_2\\rangle\\}$ basis is the $2 \\times 2$ matrix $\\mathbf{H} = \\begin{pmatrix} H_{00} & H_{20} \\\\ H_{20} & H_{22} \\end{pmatrix}$. Its eigenvalues $\\lambda$ are found from the secular equation $\\det(\\mathbf{H} - \\lambda\\mathbf{I}) = 0$, which gives $(H_{00} - \\lambda)(H_{22} - \\lambda) - H_{20}^2 = 0$. The ground-state energy is the lower eigenvalue:\n$$ E_{\\text{FCI}} = \\frac{H_{00} + H_{22} - \\sqrt{(H_{00} + H_{22})^2 - 4(H_{00}H_{22} - H_{20}^2)}}{2} $$\n$$ E_{\\text{FCI}} = \\frac{H_{00} + H_{22} - \\sqrt{(H_{22} - H_{00})^2 + 4H_{20}^2}}{2} $$\nThis is identical to the CCSD energy we derived. This confirms that CCSD (and CCD) is exact for any two-electron system. The final expression is the exact correlated ground-state energy.", "answer": "$$\n\\boxed{\\frac{H_{00} + H_{22} - \\sqrt{(H_{22} - H_{00})^{2} + 4H_{20}^{2}}}{2}}\n$$", "id": "2766789"}, {"introduction": "A complete understanding of a theoretical method requires not only grasping its formal structure but also its computational cost. This final exercise shifts focus to the practical realities of implementing CCSD, challenging you to analyze the asymptotic scaling of its key tensor contractions [@problem_id:2766796]. You will derive how a naive evaluation leads to prohibitively expensive steps and, more importantly, discover how the introduction of intermediates reduces the dominant computational cost to the well-known $\\mathcal{O}(N_o^2 N_v^4)$ and $\\mathcal{O}(N_o^3 N_v^3)$ scaling, a cornerstone of modern quantum chemistry software.", "problem": "Consider the spin-orbital Coupled-Cluster Singles and Doubles (CCSD) equations for a closed-shell system in a canonical Hartree–Fock molecular orbital basis. Let $N_o$ denote the number of occupied orbitals and $N_v$ the number of virtual orbitals. Indices $i,j,k,l$ label occupied orbitals (dimension $N_o$) and $a,b,c,d$ label virtual orbitals (dimension $N_v$). Let $t_{i}^{a}$ and $t_{ij}^{ab}$ denote the single and double excitation amplitudes, respectively, and let $v_{pq}^{rs} \\equiv \\langle pr \\| qs \\rangle$ denote antisymmetrized two-electron integrals. Focus on the doubles amplitude update, which is built from tensor contractions of the general form “two-electron integrals contracted with amplitudes.” Throughout, count floating-point multiply-accumulate operations at the level of index-loop cardinalities; ignore constant factors and lower-order terms, and assume no symmetry exploitation in loop ranges beyond antisymmetry already encoded in the algebra.\n\n1) Starting from the basic tensor-contraction structure of the CCSD doubles residual, analyze the naive computational cost (in big-$\\mathcal{O}$ scaling with respect to $N_o$ and $N_v$) for the following representative contributions to the doubles update $r_{ij}^{ab}$:\n- Particle–particle ladder-type contraction: $r_{ij}^{ab} \\leftarrow \\sum_{cd} v_{ab}^{cd} \\, t_{ij}^{cd}$.\n- Hole–hole ladder-type contraction: $r_{ij}^{ab} \\leftarrow \\sum_{kl} v_{kl}^{ij} \\, t_{kl}^{ab}$.\n- Ring/particle–hole contraction: $r_{ij}^{ab} \\leftarrow \\sum_{kc} v_{kb}^{ic} \\, t_{jk}^{ac}$, together with its index-permuted counterparts.\n\nFor each, derive the asymptotic operation count by explicitly enumerating the sizes of the outer (free-index) loops and inner (contracted-index) loops, and then multiplying these cardinalities.\n\n2) It is well known that a direct, term-by-term evaluation of the doubles update can be reorganized through the introduction of intermediates (for example, by forming particle–hole intermediates and Fock-dressed objects) so that no tensor contraction exceeds the asymptotic costs associated with either a particle–particle ladder-type contraction or a particle–hole (ring-type) contraction. Show, at the level of asymptotic index-loop counting, how grouping terms and introducing intermediates can:\n- Leave the particle–particle ladder-type contribution at cost $\\mathcal{O}(N_o^2 N_v^4)$, and\n- Reduce any naive $\\mathcal{O}(N_o^4 N_v^2)$ contributions into contractions whose leading cost is $\\mathcal{O}(N_o^3 N_v^3)$,\nso that the overall dominant costs of an optimized CCSD amplitude build are $\\mathcal{O}(N_o^2 N_v^4)$ and $\\mathcal{O}(N_o^3 N_v^3)$.\n\nYour reasoning must begin from the definition of tensor contraction costs based on index dimensions and the structure of the CCSD doubles residual; do not assume the target scalings at the outset.\n\n3) For a system with $N_o = 28$ and $N_v = 220$, assuming equal leading constants for the naive hole–hole ladder-type path and the intermediate-based reorganized path, compute the ratio\n$$\nR \\equiv \\frac{\\text{naive hole–hole ladder cost}}{\\text{intermediate-based reorganized cost}} \\, ,\n$$\nby comparing $\\mathcal{O}(N_o^4 N_v^2)$ to $\\mathcal{O}(N_o^3 N_v^3)$. Round your final numerical value of $R$ to four significant figures. Express $R$ as a pure number without units.", "solution": "The computational cost of a tensor contraction is determined by the product of the dimensions of all indices involved. For an operation of the form $C_{\\text{free}} = \\sum_{\\text{summed}} A_{\\dots} B_{\\dots}$, the total operation count scales as the product of the number of free indices and the number of summed indices. We will analyze each requested term accordingly.\n\n1) Analysis of Naive Computational Costs\n\nLet $r_{ij}^{ab}$ be the residual for the doubles amplitudes. The indices $i,j$ range over $N_o$ occupied orbitals, and $a,b$ range over $N_v$ virtual orbitals. Thus, any update to the full $r_{ij}^{ab}$ tensor necessarily involves evaluating an expression for all $N_o^2 N_v^2$ combinations of these free indices. The total cost is this factor multiplied by the cost of the summation for each element.\n\n- Particle–particle ladder-type contraction: The update is $r_{ij}^{ab} \\leftarrow \\sum_{cd} v_{ab}^{cd} \\, t_{ij}^{cd}$.\nThe free indices are $i, j, a, b$, giving $N_o^2 N_v^2$ operations fundamentally. The summation is over indices $c$ and $d$, which are virtual orbital indices. The loops for these summations run up to $N_v$. Thus, the summation costs $\\mathcal{O}(N_v^2)$.\nThe total computational cost is the product of the cardinalities of the outer (free-index) loops and the inner (contracted-index) loops:\n$$\n\\text{Cost}_{pp} \\propto (N_o \\times N_o \\times N_v \\times N_v) \\times (N_v \\times N_v) = N_o^2 N_v^4 \\, .\n$$\nThe asymptotic scaling is $\\mathcal{O}(N_o^2 N_v^4)$.\n\n- Hole–hole ladder-type contraction: The update is $r_{ij}^{ab} \\leftarrow \\sum_{kl} v_{kl}^{ij} \\, t_{kl}^{ab}$.\nThe free indices are again $i, j, a, b$, contributing a factor of $N_o^2 N_v^2$. The summation is over indices $k$ and $l$, which are occupied orbital indices. The loops for these summations run up to $N_o$. The summation costs $\\mathcal{O}(N_o^2)$.\nThe total computational cost is:\n$$\n\\text{Cost}_{hh} \\propto (N_o \\times N_o \\times N_v \\times N_v) \\times (N_o \\times N_o) = N_o^4 N_v^2 \\, .\n$$\nThe asymptotic scaling is $\\mathcal{O}(N_o^4 N_v^2)$.\n\n- Ring/particle–hole contraction: The update is $r_{ij}^{ab} \\leftarrow \\sum_{kc} v_{kb}^{ic} \\, t_{jk}^{ac}$.\nThe free indices are $i, j, a, b$, contributing $N_o^2 N_v^2$. The summation is over one occupied index $k$ and one virtual index $c$. The summation costs $\\mathcal{O}(N_o N_v)$.\nThe total computational cost is:\n$$\n\\text{Cost}_{ring} \\propto (N_o \\times N_o \\times N_v \\times N_v) \\times (N_o \\times N_v) = N_o^3 N_v^3 \\, .\n$$\nThe asymptotic scaling is $\\mathcal{O}(N_o^3 N_v^3)$. The other index permutations of this term, such as $\\sum_{kc} v_{ka}^{ic} t_{jk}^{bc}$, share the same structure and scaling.\n\n2) Reorganization using Intermediates\n\nA direct, term-by-term evaluation of the CCSD equations leads to steps with very high computational scaling, such as the $\\mathcal{O}(N_o^4 N_v^2)$ hole-hole ladder term and certain quadratic terms that can scale as high as $\\mathcal{O}(N_o^4 N_v^4)$. An optimized implementation reorganizes the calculation by grouping terms and forming intermediates to reduce the scaling of the most expensive step.\n\nThe particle-particle ladder term, scaling as $\\mathcal{O}(N_o^2 N_v^4)$, represents one of the computational bottlenecks of CCSD and is typically not reducible by simple factorization. Its cost scaling remains $\\mathcal{O}(N_o^2 N_v^4)$.\n\nThe question is how to reduce contributions with naive $\\mathcal{O}(N_o^4 N_v^2)$ scaling to a sequence of steps with a more manageable cost, such as $\\mathcal{O}(N_o^3 N_v^3)$. This is achieved not by factorizing a single term in isolation, but by a global restructuring of the equations. The principle can be illustrated most clearly by examining a different term that naively has an even higher cost, $\\mathcal{O}(N_o^4 N_v^4)$, and demonstrating its factorization. This showcases the general strategy.\n\nConsider a representative quadratic term appearing in the CCD residual:\n$$\nX_{ij}^{ab} = \\sum_{klcd} v_{kl}^{cd} t_{ik}^{ac} t_{jl}^{bd}\n$$\nA naive evaluation involves a loop over the $8$ indices $i, j, a, b, k, l, c, d$, leading to an unacceptable $\\mathcal{O}(N_o^4 N_v^4)$ scaling. We can reduce this cost by introducing an intermediate and performing the contraction in two successive steps.\n\nLet us rearrange the summation as:\n$$\nX_{ij}^{ab} = \\sum_{kc} \\left( \\sum_{ld} v_{kl}^{cd} t_{jl}^{bd} \\right) t_{ik}^{ac}\n$$\nThe expression in the parenthesis can be defined as an intermediate tensor, $I_{kc}^{ja}$. Note that for this definition to be useful, the indices of the intermediate must not depend on indices outside the parenthesis. The indices are $k, c, j, a$.\n$$\nI_{kc}^{ja} = \\sum_{ld} v_{kl}^{cd} t_{jl}^{bd}\n$$\nStep 1: Construct the intermediate $I_{kc}^{ja}$. The free indices are $k, j$ (occupied, $N_o$) and $c, a$ (virtual, $N_v$). The summed indices are $l$ (occupied, $N_o$) and $d$ (virtual, $N_v$). The cost of constructing this intermediate is the product of the dimensions of all participating indices:\n$$\n\\text{Cost}(I) \\propto (N_o \\times N_v \\times N_o \\times N_v) \\times (N_o \\times N_v) = N_o^3 N_v^3\n$$\nThe intermediate $I_{kc}^{ja}$ is a tensor of size $N_o^2 N_v^2$.\n\nStep 2: Contract the intermediate with the remaining amplitude tensor to compute $X_{ij}^{ab}$:\n$$\nX_{ij}^{ab} = \\sum_{kc} I_{kc}^{ja} t_{ik}^{ac}\n$$\nThe free indices are $i, j, a, b$ ($N_o^2 N_v^2$ elements). The summed indices are $k$ (occupied, $N_o$) and $c$ (virtual, $N_v$). The cost of this second step is:\n$$\n\\text{Cost}(X) \\propto (N_o \\times N_o \\times N_v \\times N_v) \\times (N_o \\times N_v) = N_o^3 N_v^3\n$$\nBy breaking the single $\\mathcal{O}(N_o^4 N_v^4)$ step into two sequential $\\mathcal{O}(N_o^3 N_v^3)$ steps, the overall computational scaling for this contribution is reduced to $\\mathcal{O}(N_o^3 N_v^3)$.\n\nThis exact same principle of forming intermediates from contractions of integrals and amplitudes is the general strategy used to handle all high-order terms in the CCSD equations. While the hole-hole ladder term $\\sum_{kl} v_{kl}^{ij} t_{kl}^{ab}$ is linear in the amplitudes and its direct factorization is not so simple, it is evaluated as part of larger composite intermediates within the full algorithm. The overall result is that the entire CCSD residual can be constructed in a series of steps where the most expensive are the particle-particle ladder, $\\mathcal{O}(N_o^2 N_v^4)$, and various ring-type contractions, which scale as $\\mathcal{O}(N_o^3 N_v^3)$. The naive $\\mathcal{O}(N_o^4 N_v^2)$ cost is thereby avoided in an optimized algorithm. The problem statement refers to the effective dominant cost of the reorganized path for these \"hole-heavy\" terms being $\\mathcal{O}(N_o^3 N_v^3)$.\n\n3) Ratio Calculation\n\nWe are asked to compute the ratio $R$ of the naive hole-hole ladder cost to the cost of the reorganized, intermediate-based path for the same type of contribution.\nThe naive cost scales as $\\mathcal{O}(N_o^4 N_v^2)$.\nThe reorganized path has a dominant scaling of $\\mathcal{O}(N_o^3 N_v^3)$, as established in part 2.\nThe problem states to assume equal leading constants for the scaling laws. Let this constant be $C$.\n$$\n\\text{Cost}_{\\text{naive}} = C \\cdot N_o^4 N_v^2\n$$\n$$\n\\text{Cost}_{\\text{reorganized}} = C \\cdot N_o^3 N_v^3\n$$\nThe ratio $R$ is therefore:\n$$\nR = \\frac{\\text{Cost}_{\\text{naive}}}{\\text{Cost}_{\\text{reorganized}}} = \\frac{C \\cdot N_o^4 N_v^2}{C \\cdot N_o^3 N_v^3} = \\frac{N_o}{N_v}\n$$\nGiven the values $N_o = 28$ and $N_v = 220$:\n$$\nR = \\frac{28}{220} = \\frac{7}{55}\n$$\nConverting this fraction to a decimal value and rounding to four significant figures:\n$$\nR \\approx 0.12727272... \\approx 0.1273\n$$\nThis demonstrates the substantial computational saving achieved by reorganizing the calculation, especially for systems where the number of virtual orbitals $N_v$ far exceeds the number of occupied orbitals $N_o$, which is the typical scenario.", "answer": "$$\\boxed{0.1273}$$", "id": "2766796"}]}