{"hands_on_practices": [{"introduction": "The Hartree-Fock-Roothaan equations, $FC=SCE$, form a generalized eigenvalue problem due to the non-orthogonal nature of atomic orbital basis sets. Before these equations can be solved using standard numerical algorithms, they must be converted into a standard eigenvalue problem of the form $F'C' = C'E$. This exercise [@problem_id:215564] solidifies your understanding of this crucial step by tasking you with performing a symmetric orthogonalization, a procedure that involves calculating the transformation matrix $S^{-1/2}$ for a simple yet representative molecular system.", "problem": "In the Hartree-Fock-Roothaan self-consistent field (SCF) method, the electronic structure problem is formulated as a generalized eigenvalue problem:\n$$ \\mathbf{F}\\mathbf{C} = \\mathbf{S}\\mathbf{C}\\mathbf{E} $$\nHere, $\\mathbf{F}$ is the Fock matrix, $\\mathbf{C}$ is the matrix of molecular orbital coefficients, $\\mathbf{S}$ is the overlap matrix of the non-orthogonal atomic orbital basis functions, and $\\mathbf{E}$ is a diagonal matrix of orbital energies.\n\nTo solve this equation using standard numerical algorithms for eigenvalue problems, it must first be transformed into a standard eigenvalue problem of the form $\\mathbf{F}'\\mathbf{C}' = \\mathbf{C}'\\mathbf{E}$. A common way to achieve this is via symmetric orthogonalization, also known as Löwdin orthogonalization. This method introduces a transformation matrix $\\mathbf{X} = \\mathbf{S}^{-1/2}$, which is used to transform the basis functions and the Fock matrix.\n\nConsider a simple model for a linear, symmetric triatomic molecule A-B-A described by a minimal basis set consisting of one s-type atomic orbital on each atom, denoted $\\phi_1$, $\\phi_2$, and $\\phi_3$. The overlap matrix $\\mathbf{S}$ in this basis is given by:\n$$ \\mathbf{S} = \\begin{pmatrix} 1 & s & 0 \\\\ s & 1 & s \\\\ 0 & s & 1 \\end{pmatrix} $$\nwhere $s$ is the overlap integral between adjacent atomic orbitals, and the overlap between the terminal atoms is assumed to be zero. The parameter $s$ is a real number satisfying $0 < s < 1/\\sqrt{2}$ to ensure that the overlap matrix is positive definite.\n\nYour task is to calculate the off-diagonal matrix element $X_{12}$ of the symmetric orthogonalization matrix $\\mathbf{X} = \\mathbf{S}^{-1/2}$.", "solution": "We wish to compute the off‐diagonal element $X_{12}$ of \n\n$$\n\\mathbf X = \\mathbf S^{-1/2},\n\\qquad\n\\mathbf S = \\begin{pmatrix}1 & s & 0\\\\s & 1 & s\\\\0 & s & 1\\end{pmatrix}.\n$$\n\n1. Diagonalize $\\mathbf S$ by an orthonormal matrix $U$:\n\n$$\n\\mathbf S = U\\,\\Lambda\\,U^T,\n\\qquad\n\\Lambda = \\operatorname{diag}(\\lambda_1,\\lambda_2,\\lambda_3).\n$$\n\nFor a linear chain of three orbitals the eigenvalues are\n\n$$\n\\lambda_k=1+2s\\cos\\frac{k\\pi}{4},\n\\quad k=1,2,3,\n$$\n\nso\n\n$$\n\\lambda_1=1+\\sqrt2\\,s,\\quad\n\\lambda_2=1,\\quad\n\\lambda_3=1-\\sqrt2\\,s.\n$$\n\n\n2. The (unnormalized) eigenvectors have components \n\n$$\nu_{j k}=\\sin\\!\\bigl(jk\\pi/4\\bigr),\n\\quad j=1,2,3,\n$$\n\nand are normalized by\n$\\sum_{j=1}^3\\sin^2(jk\\pi/4)=2$. Hence\n\n$$\nU_{jk}=\\frac{\\sin(jk\\pi/4)}{\\sqrt2}.\n$$\n\n\n3. The symmetric orthogonalizer is\n\n$$\n\\mathbf X=\\mathbf S^{-1/2}\n=U\\,\\Lambda^{-1/2}\\,U^T,\n$$\n\nso each element\n\n$$\nX_{12}\n=\\sum_{k=1}^3U_{1k}\\,U_{2k}\\,\\frac1{\\sqrt{\\lambda_k}}.\n$$\n\nSince $U_{12}U_{22}=0$, only $k=1,3$ contribute.  We have\n\n$$\nU_{11}U_{21}\n=\\frac{\\sin(\\pi/4)\\sin(2\\pi/4)}{2}\n=\\frac{1}{2\\sqrt2},\n\\quad\nU_{13}U_{23}\n=\\frac{\\sin(3\\pi/4)\\sin(6\\pi/4)}{2}\n=-\\frac{1}{2\\sqrt2}.\n$$\n\nThus\n\n$$\nX_{12}\n=\\frac{1}{2\\sqrt2}\\Bigl(\\frac1{\\sqrt{1+\\sqrt2\\,s}}\n-\\frac1{\\sqrt{1-\\sqrt2\\,s}}\\Bigr).\n$$", "answer": "$$\\boxed{\\frac{1}{2\\sqrt{2}}\\Bigl(\\frac{1}{\\sqrt{1+\\sqrt{2}\\,s}}-\\frac{1}{\\sqrt{1-\\sqrt{2}\\,s}}\\Bigr)}$$", "id": "215564"}, {"introduction": "In any self-consistent field method, the one-electron density matrix, $P$, is a central quantity that determines all one-electron properties. A fundamental requirement for the exact density matrix of a single-determinant wavefunction is idempotency, meaning it satisfies the relation $P^2=P$. This practice [@problem_id:215598] explores McWeeny's purification scheme, an elegant algorithm used to restore this critical property to a trial density matrix that may have deviated from idempotency during the iterative process, a common scenario in modern electronic structure methods.", "problem": "In the context of the Self-Consistent Field (SCF) procedure in quantum chemistry, particularly in linear-scaling methods, the one-particle density matrix, $D$, plays a central role. For a closed-shell system described by a single determinant wavefunction, the exact density matrix must be idempotent, meaning it satisfies the condition $D^2 = D$. Furthermore, its trace must equal the number of occupied orbitals, $Tr(D) = N_{occ}$.\n\nDuring the iterative SCF process, a trial density matrix $D_n$ might not be perfectly idempotent. McWeeny's purification scheme is a method to restore idempotency. One of the most common purification algorithms updates the density matrix according to the formula:\n$$\nD_{n+1} = f(D_n) = 3D_n^2 - 2D_n^3\n$$\nThis transformation has the property that if the eigenvalues of $D_n$ are in the interval $[0, 1]$, the eigenvalues of $D_{n+1}$ are pushed closer to either $0$ or $1$, thus making the matrix more idempotent with each iteration.\n\nConsider a simple two-orbital, two-electron model system (e.g., a minimal basis representation of $H_2$). The density matrix is a $2 \\times 2$ matrix and for this system, $N_{occ} = 1$. A non-idempotent trial density matrix $D$ is given by:\n$$\nD = \\begin{pmatrix} \\frac{3}{4} & \\frac{1}{4} \\\\ \\frac{1}{4} & \\frac{1}{4} \\end{pmatrix}\n$$\nThis matrix is symmetric and has the correct trace, $Tr(D) = 1$.\n\nYour task is to apply one iteration of the McWeeny purification algorithm to this trial density matrix to obtain a purified matrix $D'$. Calculate the determinant of this new matrix, $\\det(D')$.", "solution": "1. McWeeny purification formula:\n$$\nD' \\;=\\;3D^2\\;-\\;2D^3.\n$$\n\n2. Given \n$$\nD=\\begin{pmatrix}\\tfrac34&\\tfrac14\\\\ \\tfrac14&\\tfrac14\\end{pmatrix},\n$$\ncompute \n$$\nD^2=\\begin{pmatrix}\n\\tfrac34^2+\\tfrac14^2 & \\tfrac34\\cdot\\tfrac14+\\tfrac14\\cdot\\tfrac14\\\\\n\\tfrac34\\cdot\\tfrac14+\\tfrac14\\cdot\\tfrac14 & \\tfrac14^2+\\tfrac14^2\n\\end{pmatrix}\n=\\begin{pmatrix}\\tfrac{10}{16}&\\tfrac{4}{16}\\\\ \\tfrac{4}{16}&\\tfrac{2}{16}\\end{pmatrix}\n=\\begin{pmatrix}\\tfrac58&\\tfrac14\\\\ \\tfrac14&\\tfrac18\\end{pmatrix}.\n$$\n\n3. Next,\n$$\nD^3 = D^2D\n=\\begin{pmatrix}p&q\\\\ q&r\\end{pmatrix}\n\\begin{pmatrix}a&b\\\\ b&c\\end{pmatrix}\n\\quad\\text{with }a=\\tfrac34,\\;b=\\tfrac14,\\;c=\\tfrac14,\\;\np=\\tfrac58,\\;q=\\tfrac14,\\;r=\\tfrac18,\n$$\ngiving\n$$\nD^3\n=\\begin{pmatrix}\n\\tfrac{17}{32}&\\tfrac{7}{32}\\\\\n\\tfrac{7}{32}&\\tfrac{3}{32}\n\\end{pmatrix}.\n$$\n\n4. Form the purified matrix:\n$$\nD' =3D^2-2D^3\n=\\begin{pmatrix}\n3\\cdot\\tfrac58 -2\\cdot\\tfrac{17}{32}&3\\cdot\\tfrac14 -2\\cdot\\tfrac{7}{32}\\\\\n3\\cdot\\tfrac14 -2\\cdot\\tfrac{7}{32}&3\\cdot\\tfrac18 -2\\cdot\\tfrac{3}{32}\n\\end{pmatrix}\n=\\begin{pmatrix}\n\\tfrac{13}{16}&\\tfrac{5}{16}\\\\\n\\tfrac{5}{16}&\\tfrac{3}{16}\n\\end{pmatrix}.\n$$\n\n5. Determinant of $D'$:\n$$\n\\det(D')\n=\\frac{13}{16}\\cdot\\frac{3}{16}-\\Bigl(\\frac{5}{16}\\Bigr)^2\n=\\frac{39}{256}-\\frac{25}{256}\n=\\frac{14}{256}\n=\\frac{7}{128}.\n$$", "answer": "$$\\boxed{7/128}$$", "id": "215598"}, {"introduction": "Determining when an SCF calculation has successfully converged is a critical practical skill. While monitoring the change in total energy between iterations is common, it can be misleading. This advanced practice [@problem_id:2804024] presents a carefully constructed thought experiment that reveals a \"false convergence\" scenario, where the energy change is negligible but the solution is far from self-consistent. By calculating both the energy change and the commutator of the Fock and density matrices, $[F, P]$, you will gain a deeper appreciation for why the commutator norm is a more robust criterion for true convergence.", "problem": "Consider a one-electron, two-level toy Self-Consistent Field (SCF) model in an orthonormal atomic orbital basis $\\{|1\\rangle, |2\\rangle\\}$. At SCF iteration $n$, the Fock operator is represented by the Hermitian matrix\n$$\nF^{(n)} \\;=\\; \\begin{pmatrix} \\alpha & 0 \\\\ 0 & \\beta \\end{pmatrix},\n$$\nwith $\\alpha = 0$ (in $\\mathrm{Hartree}$) and $\\beta = \\Delta$, where $\\Delta = 2.0 \\times 10^{-2}$ (in $\\mathrm{Hartree}$). The one-electron density at iteration $n$ is the projector $P^{(n)} = |c\\rangle \\langle c|$ onto the occupied spin-orbital\n$$\n|c\\rangle \\;=\\; \\begin{pmatrix} \\cos\\theta \\\\ \\sin\\theta \\end{pmatrix}, \\quad \\text{with } \\theta = \\frac{\\pi}{4} \\text{ (radians)}.\n$$\nSuppose that at iteration $n+1$ the algorithm applies a tiny uniform diagonal shift, producing\n$$\nF^{(n+1)} \\;=\\; \\begin{pmatrix} \\alpha + \\delta & 0 \\\\ 0 & \\beta + \\delta \\end{pmatrix},\n$$\nwith $\\delta = 1.0 \\times 10^{-10}$ (in $\\mathrm{Hartree}$), while the density remains unchanged due to damping, $P^{(n+1)} = P^{(n)}$.\n\nUse as energy functional for this one-electron toy model the expectation value\n$$\nE^{(k)} \\;=\\; \\operatorname{Tr}\\!\\big(F^{(k)} P^{(k)}\\big),\n$$\nand recall that the self-consistency stationarity condition in an orthonormal basis requires the commutator $[F^{(n)}, P^{(n)}] = F^{(n)} P^{(n)} - P^{(n)} F^{(n)}$ to vanish at convergence. The residual norm is taken to be the Frobenius norm $\\|X\\|_{\\mathrm{F}} = \\sqrt{\\operatorname{Tr}(X^{\\dagger} X)}$. The target convergence thresholds are: energy-change threshold $\\tau_{E} = 1.0 \\times 10^{-8}$ (in $\\mathrm{Hartree}$) and residual threshold $\\tau_{R} = 1.0 \\times 10^{-3}$ (in $\\mathrm{Hartree}$).\n\nTasks:\n1) Compute $E^{(n)}$ and $E^{(n+1)}$, and verify whether $\\big|E^{(n+1)} - E^{(n)}\\big| < \\tau_{E}$.\n2) Compute the Frobenius norm $\\big\\|\\,[F^{(n)}, P^{(n)}]\\,\\big\\|_{\\mathrm{F}}$ and compare it to $\\tau_{R}$ to assess whether the residual indicates non-convergence.\n\nExpress the final numerical value of the Frobenius norm in $\\mathrm{Hartree}$ and round your answer to four significant figures. Your final answer must be a single number.", "solution": "The first step is to construct the one-electron density matrix $P^{(n)}$ from the given occupied spin-orbital $|c\\rangle$. The spin-orbital is defined in the orthonormal basis $\\{|1\\rangle, |2\\rangle\\}$ as:\n$$\n|c\\rangle \\;=\\; \\begin{pmatrix} \\cos\\theta \\\\ \\sin\\theta \\end{pmatrix}, \\quad \\text{with } \\theta = \\frac{\\pi}{4}\n$$\nSubstituting the value of $\\theta$, we have $\\cos(\\frac{\\pi}{4}) = \\frac{1}{\\sqrt{2}}$ and $\\sin(\\frac{\\pi}{4}) = \\frac{1}{\\sqrt{2}}$. Thus, the orbital is:\n$$\n|c\\rangle \\;=\\; \\frac{1}{\\sqrt{2}}\\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}\n$$\nThe corresponding adjoint vector is $\\langle c| = \\frac{1}{\\sqrt{2}}\\begin{pmatrix} 1 & 1 \\end{pmatrix}$. The density matrix $P^{(n)}$ is the projector $|c\\rangle \\langle c|$:\n$$\nP^{(n)} \\;=\\; |c\\rangle \\langle c| \\;=\\; \\frac{1}{\\sqrt{2}}\\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} \\frac{1}{\\sqrt{2}}\\begin{pmatrix} 1 & 1 \\end{pmatrix} \\;=\\; \\frac{1}{2}\\begin{pmatrix} 1 & 1 \\\\ 1 & 1 \\end{pmatrix} \\;=\\; \\begin{pmatrix} \\frac{1}{2} & \\frac{1}{2} \\\\ \\frac{1}{2} & \\frac{1}{2} \\end{pmatrix}\n$$\nThe problem states that due to damping, the density matrix remains unchanged at the next iteration, so $P^{(n+1)} = P^{(n)}$.\n\n**Task 1: Energy Calculation and Convergence**\n\nWe compute the energy $E^{(k)}$ at iteration $k$ using the functional $E^{(k)} = \\operatorname{Tr}(F^{(k)} P^{(k)})$.\n\nAt iteration $n$, the Fock matrix is given as $F^{(n)} = \\begin{pmatrix} \\alpha & 0 \\\\ 0 & \\beta \\end{pmatrix}$ with $\\alpha = 0$ and $\\beta = \\Delta = 2.0 \\times 10^{-2}$.\n$$\nF^{(n)} \\;=\\; \\begin{pmatrix} 0 & 0 \\\\ 0 & \\Delta \\end{pmatrix}\n$$\nThe product $F^{(n)} P^{(n)}$ is:\n$$\nF^{(n)} P^{(n)} \\;=\\; \\begin{pmatrix} 0 & 0 \\\\ 0 & \\Delta \\end{pmatrix} \\begin{pmatrix} \\frac{1}{2} & \\frac{1}{2} \\\\ \\frac{1}{2} & \\frac{1}{2} \\end{pmatrix} \\;=\\; \\begin{pmatrix} 0 & 0 \\\\ \\frac{\\Delta}{2} & \\frac{\\Delta}{2} \\end{pmatrix}\n$$\nThe energy $E^{(n)}$ is the trace of this matrix:\n$$\nE^{(n)} \\;=\\; \\operatorname{Tr}(F^{(n)} P^{(n)}) \\;=\\; 0 + \\frac{\\Delta}{2} \\;=\\; \\frac{\\Delta}{2}\n$$\nAt iteration $n+1$, the Fock matrix is $F^{(n+1)} = \\begin{pmatrix} \\alpha + \\delta & 0 \\\\ 0 & \\beta + \\delta \\end{pmatrix}$ with $\\delta = 1.0 \\times 10^{-10}$.\n$$\nF^{(n+1)} \\;=\\; \\begin{pmatrix} \\delta & 0 \\\\ 0 & \\Delta + \\delta \\end{pmatrix}\n$$\nThe product $F^{(n+1)} P^{(n+1)}$ is, using $P^{(n+1)} = P^{(n)}$:\n$$\nF^{(n+1)} P^{(n+1)} \\;=\\; \\begin{pmatrix} \\delta & 0 \\\\ 0 & \\Delta + \\delta \\end{pmatrix} \\begin{pmatrix} \\frac{1}{2} & \\frac{1}{2} \\\\ \\frac{1}{2} & \\frac{1}{2} \\end{pmatrix} \\;=\\; \\begin{pmatrix} \\frac{\\delta}{2} & \\frac{\\delta}{2} \\\\ \\frac{\\Delta + \\delta}{2} & \\frac{\\Delta + \\delta}{2} \\end{pmatrix}\n$$\nThe energy $E^{(n+1)}$ is the trace of this matrix:\n$$\nE^{(n+1)} \\;=\\; \\operatorname{Tr}(F^{(n+1)} P^{(n+1)}) \\;=\\; \\frac{\\delta}{2} + \\frac{\\Delta + \\delta}{2} \\;=\\; \\frac{\\Delta + 2\\delta}{2} \\;=\\; \\frac{\\Delta}{2} + \\delta\n$$\nThe change in energy is:\n$$\n\\big|E^{(n+1)} - E^{(n)}\\big| \\;=\\; \\left|\\left(\\frac{\\Delta}{2} + \\delta\\right) - \\frac{\\Delta}{2}\\right| \\;=\\; |\\delta| \\;=\\; 1.0 \\times 10^{-10} \\, \\mathrm{Hartree}\n$$\nWe compare this to the energy-change threshold $\\tau_{E} = 1.0 \\times 10^{-8} \\, \\mathrm{Hartree}$. Since $1.0 \\times 10^{-10} < 1.0 \\times 10^{-8}$, the energy convergence criterion $|E^{(n+1)} - E^{(n)}| < \\tau_{E}$ is satisfied.\n\n**Task 2: Residual Norm Calculation and Convergence**\n\nThe self-consistency stationarity condition is that the commutator $[F^{(n)}, P^{(n)}]$ vanishes. We compute this commutator. First, we need the product $P^{(n)} F^{(n)}$:\n$$\nP^{(n)} F^{(n)} \\;=\\; \\begin{pmatrix} \\frac{1}{2} & \\frac{1}{2} \\\\ \\frac{1}{2} & \\frac{1}{2} \\end{pmatrix} \\begin{pmatrix} 0 & 0 \\\\ 0 & \\Delta \\end{pmatrix} \\;=\\; \\begin{pmatrix} 0 & \\frac{\\Delta}{2} \\\\ 0 & \\frac{\\Delta}{2} \\end{pmatrix}\n$$\nThe commutator, which we denote as $C^{(n)}$, is:\n$$\nC^{(n)} \\;=\\; [F^{(n)}, P^{(n)}] \\;=\\; F^{(n)} P^{(n)} - P^{(n)} F^{(n)} \\;=\\; \\begin{pmatrix} 0 & 0 \\\\ \\frac{\\Delta}{2} & \\frac{\\Delta}{2} \\end{pmatrix} - \\begin{pmatrix} 0 & \\frac{\\Delta}{2} \\\\ 0 & \\frac{\\Delta}{2} \\end{pmatrix} \\;=\\; \\begin{pmatrix} 0 & -\\frac{\\Delta}{2} \\\\ \\frac{\\Delta}{2} & 0 \\end{pmatrix}\n$$\nThe residual norm is the Frobenius norm of this commutator, $\\|C^{(n)}\\|_{\\mathrm{F}} = \\sqrt{\\operatorname{Tr}((C^{(n)})^{\\dagger} C^{(n)})}$. The adjoint of $C^{(n)}$ is:\n$$\n(C^{(n)})^{\\dagger} \\;=\\; \\begin{pmatrix} 0 & \\frac{\\Delta}{2} \\\\ -\\frac{\\Delta}{2} & 0 \\end{pmatrix}\n$$\nThe product $(C^{(n)})^{\\dagger} C^{(n)}$ is:\n$$\n(C^{(n)})^{\\dagger} C^{(n)} \\;=\\; \\begin{pmatrix} 0 & \\frac{\\Delta}{2} \\\\ -\\frac{\\Delta}{2} & 0 \\end{pmatrix} \\begin{pmatrix} 0 & -\\frac{\\Delta}{2} \\\\ \\frac{\\Delta}{2} & 0 \\end{pmatrix} \\;=\\; \\begin{pmatrix} \\frac{\\Delta^2}{4} & 0 \\\\ 0 & \\frac{\\Delta^2}{4} \\end{pmatrix}\n$$\nThe trace of this matrix is:\n$$\n\\operatorname{Tr}((C^{(n)})^{\\dagger} C^{(n)}) \\;=\\; \\frac{\\Delta^2}{4} + \\frac{\\Delta^2}{4} \\;=\\; \\frac{\\Delta^2}{2}\n$$\nThe Frobenius norm is the square root of this value:\n$$\n\\big\\|[F^{(n)}, P^{(n)}]\\big\\|_{\\mathrm{F}} \\;=\\; \\sqrt{\\frac{\\Delta^2}{2}} \\;=\\; \\frac{|\\Delta|}{\\sqrt{2}}\n$$\nGiven $\\Delta = 2.0 \\times 10^{-2} \\, \\mathrm{Hartree}$, the norm is:\n$$\n\\big\\|[F^{(n)}, P^{(n)}]\\big\\|_{\\mathrm{F}} \\;=\\; \\frac{2.0 \\times 10^{-2}}{\\sqrt{2}} \\;=\\; \\sqrt{2} \\times 10^{-2} \\, \\mathrm{Hartree}\n$$\nNumerically, $\\sqrt{2} \\approx 1.41421356$. So, the norm is approximately $1.41421356 \\times 10^{-2} \\, \\mathrm{Hartree}$.\nWe compare this to the residual threshold $\\tau_{R} = 1.0 \\times 10^{-3} \\, \\mathrm{Hartree}$.\n$$\n1.414... \\times 10^{-2} \\; > \\; 1.0 \\times 10^{-3}\n$$\nThus, the residual norm is greater than the threshold, indicating that the SCF procedure has not converged at iteration $n$, despite the energy change being very small. This illustrates that a small energy change is a necessary but not sufficient condition for SCF convergence. The gradient of the energy with respect to orbital rotations, represented here by the commutator norm, must also be small.\n\nThe problem requires the numerical value of the Frobenius norm, rounded to four significant figures.\n$$\n\\sqrt{2} \\times 10^{-2} \\approx 1.414 \\times 10^{-2}\n$$\nThis is the final numerical result.", "answer": "$$\\boxed{1.414 \\times 10^{-2}}$$", "id": "2804024"}]}