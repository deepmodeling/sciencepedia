{"hands_on_practices": [{"introduction": "Before tackling complex exchange-correlation functionals, we must ensure our numerical grid can correctly handle the most fundamental quantity: the volume of space itself. This foundational exercise lets you manually perform a 3D numerical integration using a simple product grid. By verifying that a constant function integrates to the correct volume, you will gain direct insight into how radial and angular quadrature points and weights, along with the Jacobian factor $r^2$, combine to approximate volume integrals [@problem_id:2790980].", "problem": "In Kohn–Sham Density Functional Theory (DFT), atom-centered numerical quadrature grids approximate three-dimensional integrals of exchange–correlation contributions by a product of a radial quadrature and an angular quadrature. Starting from the definition of the three-dimensional integral in spherical coordinates, verify that the product of radial and angular quadrature weights reproduces the spherical volume element for the constant integrand. To avoid divergence of the infinite-volume integral, restrict the domain to the ball of radius $R=3$ bohr centered at the origin and take $f(\\mathbf{r})=1$.\n\nUse the following product grid:\n- Angular quadrature: a six-point octahedral grid with directions on the Cartesian axes $\\pm \\hat{\\mathbf{x}}, \\pm \\hat{\\mathbf{y}}, \\pm \\hat{\\mathbf{z}}$ and equal weights $w_{k}^{\\mathrm{ang}}=\\frac{4\\pi}{6}$ for $k=1,\\dots,6$.\n- Radial quadrature on $[0,R]$: two-point Gauss–Legendre with nodes and weights obtained by mapping $x\\in[-1,1]$ to $r\\in[0,R]$ via $r=\\frac{R}{2}(1+x)$, so that the nodes are $r_{i}=\\frac{R}{2}\\left(1+x_{i}\\right)$ with $x_{1}=-\\frac{1}{\\sqrt{3}}$, $x_{2}=+\\frac{1}{\\sqrt{3}}$, and the corresponding radial weights are $\\omega_{i}=\\frac{R}{2}w_{i}$ with $w_{1}=w_{2}=1$.\n\nApproximate the integral\n$$\n\\int_{|\\mathbf{r}|\\le R} f(\\mathbf{r})\\,\\mathrm{d}^{3}\\mathbf{r}\n$$\nby the product quadrature\n$$\n\\sum_{i=1}^{2}\\sum_{k=1}^{6}\\omega_{i}\\,r_{i}^{2}\\,w_{k}^{\\mathrm{ang}}\\,f\\!\\left(r_{i},\\Omega_{k}\\right).\n$$\nCompute this discrete quadrature estimate explicitly and give your final result as a single exact analytic expression in terms of $\\pi$. Express the physical quantity conceptually in cubic bohr, but do not include units in your final boxed answer.", "solution": "The problem as stated is scientifically grounded, well-posed, and contains all necessary information for a unique solution. The definitions for the numerical quadrature grid, including both radial and angular components, are standard in computational physics and chemistry. The task is a direct application of these definitions to a specific case. Therefore, we proceed with the calculation.\n\nThe objective is to compute the value of the discrete quadrature approximation to the integral\n$$\nI = \\int_{|\\mathbf{r}|\\le R} f(\\mathbf{r})\\,\\mathrm{d}^{3}\\mathbf{r}\n$$\nfor the specific case where the domain is a ball of radius $R=3$ bohr and the integrand is a constant function $f(\\mathbf{r})=1$. The quadrature formula is given as\n$$\nI_{\\text{approx}} = \\sum_{i=1}^{2}\\sum_{k=1}^{6}\\omega_{i}\\,r_{i}^{2}\\,w_{k}^{\\mathrm{ang}}\\,f(r_{i},\\Omega_{k})\n$$\nSince $f(r_{i},\\Omega_{k})=1$ for all points, the expression simplifies. We can separate the sums over the radial index $i$ and the angular index $k$:\n$$\nI_{\\text{approx}} = \\left(\\sum_{k=1}^{6} w_{k}^{\\mathrm{ang}}\\right) \\left(\\sum_{i=1}^{2} \\omega_{i} r_{i}^{2}\\right)\n$$\nWe shall evaluate the angular and radial parts separately.\n\nFirst, we compute the sum of the angular weights. The problem specifies a six-point octahedral grid with equal weights $w_{k}^{\\mathrm{ang}}=\\frac{4\\pi}{6}$ for $k=1,\\dots,6$.\nThe sum is:\n$$\n\\sum_{k=1}^{6} w_{k}^{\\mathrm{ang}} = \\sum_{k=1}^{6} \\frac{4\\pi}{6} = 6 \\times \\frac{4\\pi}{6} = 4\\pi\n$$\nThis is, as expected, the surface area of the unit sphere, ensuring that the angular quadrature correctly integrates the constant function $f(\\Omega)=1$ over the sphere.\n\nNext, we evaluate the radial part of the sum, $\\sum_{i=1}^{2} \\omega_{i} r_{i}^{2}$. This requires the explicit values for the radial nodes $r_{i}$ and weights $\\omega_{i}$. The problem defines a two-point Gauss-Legendre quadrature on the interval $[0,R]$ with $R=3$. The quadrature is constructed by mapping the standard interval $x \\in [-1,1]$.\n\nThe standard two-point Gauss-Legendre nodes on $[-1,1]$ are $x_{1}=-\\frac{1}{\\sqrt{3}}$ and $x_{2}=+\\frac{1}{\\sqrt{3}}$, with corresponding weights $w_{1}=1$ and $w_{2}=1$.\n\nThe mapping to the radial coordinate $r \\in [0,R]$ is given by $r=\\frac{R}{2}(1+x)$. With $R=3$, the radial nodes $r_{i}$ are:\n$$\nr_{1} = \\frac{3}{2}\\left(1 + x_{1}\\right) = \\frac{3}{2}\\left(1 - \\frac{1}{\\sqrt{3}}\\right)\n$$\n$$\nr_{2} = \\frac{3}{2}\\left(1 + x_{2}\\right) = \\frac{3}{2}\\left(1 + \\frac{1}{\\sqrt{3}}\\right)\n$$\nThe corresponding radial weights $\\omega_{i}$ are given by $\\omega_{i}=\\frac{R}{2}w_{i}$. With $R=3$ and $w_{1}=w_{2}=1$, we have:\n$$\n\\omega_{1} = \\frac{3}{2}(1) = \\frac{3}{2}\n$$\n$$\n\\omega_{2} = \\frac{3}{2}(1) = \\frac{3}{2}\n$$\nNow we can compute the sum $\\sum_{i=1}^{2} \\omega_{i} r_{i}^{2}$:\n$$\n\\sum_{i=1}^{2} \\omega_{i} r_{i}^{2} = \\omega_{1} r_{1}^{2} + \\omega_{2} r_{2}^{2} = \\frac{3}{2} r_{1}^{2} + \\frac{3}{2} r_{2}^{2} = \\frac{3}{2} (r_{1}^{2} + r_{2}^{2})\n$$\nWe calculate the sum of the squares of the radial nodes:\n$$\nr_{1}^{2} + r_{2}^{2} = \\left[\\frac{3}{2}\\left(1 - \\frac{1}{\\sqrt{3}}\\right)\\right]^{2} + \\left[\\frac{3}{2}\\left(1 + \\frac{1}{\\sqrt{3}}\\right)\\right]^{2}\n$$\n$$\n= \\left(\\frac{3}{2}\\right)^{2} \\left[ \\left(1 - \\frac{1}{\\sqrt{3}}\\right)^{2} + \\left(1 + \\frac{1}{\\sqrt{3}}\\right)^{2} \\right]\n$$\n$$\n= \\frac{9}{4} \\left[ \\left(1 - \\frac{2}{\\sqrt{3}} + \\frac{1}{3}\\right) + \\left(1 + \\frac{2}{\\sqrt{3}} + \\frac{1}{3}\\right) \\right]\n$$\n$$\n= \\frac{9}{4} \\left[ 1 - \\frac{2}{\\sqrt{3}} + \\frac{1}{3} + 1 + \\frac{2}{\\sqrt{3}} + \\frac{1}{3} \\right]\n$$\nThe terms with $\\sqrt{3}$ cancel out:\n$$\n= \\frac{9}{4} \\left[ 2 + \\frac{2}{3} \\right] = \\frac{9}{4} \\left[ \\frac{6}{3} + \\frac{2}{3} \\right] = \\frac{9}{4} \\left( \\frac{8}{3} \\right) = \\frac{72}{12} = 6\n$$\nSubstituting this result back into the expression for the radial sum:\n$$\n\\sum_{i=1}^{2} \\omega_{i} r_{i}^{2} = \\frac{3}{2} (6) = 9\n$$\nThis result correctly reproduces the exact value of the radial integral $\\int_0^R r^2 dr = \\frac{R^3}{3} = \\frac{3^3}{3} = 9$. This is expected, as the two-point Gauss-Legendre rule is exact for polynomials of degree up to $2(2)-1=3$, and the transformed integrand is a polynomial of degree $2$ in the integration variable $x$.\n\nFinally, we combine the angular and radial results to obtain the total value of the quadrature:\n$$\nI_{\\text{approx}} = \\left(\\sum_{k=1}^{6} w_{k}^{\\mathrm{ang}}\\right) \\left(\\sum_{i=1}^{2} \\omega_{i} r_{i}^{2}\\right) = (4\\pi) \\times (9) = 36\\pi\n$$\nThis numerical result is identical to the analytical volume of a sphere of radius $R=3$, which is $V = \\frac{4}{3}\\pi R^3 = \\frac{4}{3}\\pi (3)^3 = 36\\pi$. This verifies that the specified product quadrature is exact for the integration of a constant function over a spherical volume.", "answer": "$$\n\\boxed{36\\pi}\n$$", "id": "2790980"}, {"introduction": "A key practical skill is choosing a numerical grid that is \"good enough\" without being computationally wasteful. This exercise links the abstract theory of spherical harmonics to the concrete task of selecting an appropriate angular grid for a Generalized Gradient Approximation (GGA) calculation. By analyzing how the mathematical operations in a GGA functional affect the angular complexity of the electron density, you will determine the minimum Lebedev grid order required for an exact angular integration, a crucial step in ensuring the accuracy of any DFT simulation [@problem_id:2790984].", "problem": "A common approach to evaluating exchange-correlation energies in Kohn–Sham Density Functional Theory is to perform a radial–angular quadrature, using a one-dimensional radial rule times a spherical rule exact for spherical harmonics up to a specified degree. Consider a single radial shell at fixed radius $r$, for which the electron density is represented exactly by a finite spherical harmonic expansion\n$$\nn(\\Omega)\\;=\\;\\sum_{\\ell=0}^{9}\\sum_{m=-\\ell}^{\\ell} c_{\\ell m}\\,Y_{\\ell m}(\\Omega),\n$$\nwith $\\Omega$ denoting the angular coordinates and $Y_{\\ell m}$ the real or complex spherical harmonics. Suppose the exchange-correlation energy density in a Generalized Gradient Approximation (GGA) is locally a smooth scalar function of $n$ and $|\\nabla n|$, and, on this shell, can be approximated by the second-order expansion\n$$\n\\varepsilon_{\\mathrm{xc}}(\\Omega)\\;\\approx\\;A\\,n(\\Omega)\\;+\\;B\\,\\big(n(\\Omega)\\big)^{2}\\;+\\;C\\,\\big|\\nabla n(\\Omega)\\big|^{2},\n$$\nwhere $A$, $B$, and $C$ are constants with respect to $\\Omega$ on this shell. A Lebedev spherical quadrature of exactness degree $T$ is defined to integrate exactly every spherical harmonic $Y_{LM}(\\Omega)$ for all $L\\leq T$ and all $M$.\n\nUsing only the following foundational facts:\n\n- The product of two spherical harmonics decomposes into a finite sum of spherical harmonics with angular momenta $L$ ranging from $|\\ell_{1}-\\ell_{2}|$ to $\\ell_{1}+\\ell_{2}$.\n- The angular part of the gradient operator acting on $Y_{\\ell m}$ transforms like the tensor product of a rank-$1$ object with a rank-$\\ell$ spherical tensor, and therefore couples to ranks $\\ell-1$, $\\ell$, and $\\ell+1$; thus, for fixed $r$, the angular dependence generated by $\\nabla Y_{\\ell m}$ contains only degrees up to $\\ell+1$.\n\ndetermine the minimal Lebedev exactness degree $T$ such that the angular integral of $\\varepsilon_{\\mathrm{xc}}(\\Omega)$ over the unit sphere is evaluated exactly for arbitrary coefficients $\\{c_{\\ell m}\\}$ consistent with the given bound $\\ell\\leq 9$. For the purpose of this problem, you may assume that commonly available Lebedev rules have odd exactness degrees, so that if $T^{\\star}$ is required by the analysis, the practically usable minimal degree is the smallest odd integer greater than or equal to $T^{\\star}$.\n\nProvide your final answer as the single integer $T$, with no units and no rounding instruction needed.", "solution": "The problem requires the determination of the minimal Lebedev quadrature exactness degree, $T$, necessary to exactly integrate a given approximate form of the exchange-correlation energy density, $\\varepsilon_{\\mathrm{xc}}(\\Omega)$, over the surface of a sphere.\n\nThe first step is to establish the highest degree spherical harmonic, denoted by its angular momentum quantum number $L$, present in the expansion of the integrand $\\varepsilon_{\\mathrm{xc}}(\\Omega)$. A Lebedev quadrature is exact for all spherical harmonics $Y_{LM}(\\Omega)$ up to a degree $T$. Therefore, to guarantee an exact integral, the degree of exactness $T$ must be at least as large as the maximum degree $L_{\\mathrm{max}}$ found in the spherical harmonic expansion of the integrand. The theoretical minimum exactness degree is thus $T^{\\star} = L_{\\mathrm{max}}$.\n\nThe integrand is given as:\n$$\n\\varepsilon_{\\mathrm{xc}}(\\Omega) = A\\,n(\\Omega) + B\\,\\big(n(\\Omega)\\big)^{2} + C\\,\\big|\\nabla n(\\Omega)\\big|^{2}\n$$\nwhere $A$, $B$, and $C$ are constants on the spherical shell. We must analyze the spherical harmonic content of each term. The electron density $n(\\Omega)$ is given by a finite expansion:\n$$\nn(\\Omega) = \\sum_{\\ell=0}^{9}\\sum_{m=-\\ell}^{\\ell} c_{\\ell m}\\,Y_{\\ell m}(\\Omega)\n$$\nThe maximum angular momentum degree in the expansion of $n(\\Omega)$ is explicitly stated to be $\\ell_{\\mathrm{max},n} = 9$.\n\nLet us analyze each term of $\\varepsilon_{\\mathrm{xc}}(\\Omega)$:\n\n1.  The term $A\\,n(\\Omega)$:\n    Since $A$ is a constant, this term is simply a scaling of the density $n(\\Omega)$. The highest degree spherical harmonic in this term is the same as in $n(\\Omega)$, which is $L_{\\mathrm{max},1} = 9$.\n\n2.  The term $B\\,\\big(n(\\Omega)\\big)^{2}$:\n    This term involves the product of the density with itself. The product of two spherical harmonics, $Y_{\\ell_1 m_1}(\\Omega)$ and $Y_{\\ell_2 m_2}(\\Omega)$, can be expanded into a linear combination of spherical harmonics $Y_{LM}(\\Omega)$ whose degrees $L$ are in the range $|\\ell_1 - \\ell_2| \\leq L \\leq \\ell_1 + \\ell_2$. To find the maximum degree in the expansion of $\\big(n(\\Omega)\\big)^{2}$, we must consider the product of the highest-degree components from $n(\\Omega)$. Since the maximum degree in $n(\\Omega)$ is $\\ell_{\\mathrm{max},n} = 9$, the highest degree in the product $\\big(n(\\Omega)\\big)^{2}$ arises from terms like $Y_{9,m_1}(\\Omega) \\times Y_{9,m_2}(\\Omega)$. According to the product rule, the maximum degree resulting from this product is $L = 9 + 9 = 18$. Thus, the maximum degree in this term is $L_{\\mathrm{max},2} = 18$.\n\n3.  The term $C\\,\\big|\\nabla n(\\Omega)\\big|^{2}$:\n    This term is the squared magnitude of the gradient of the density. We must first determine the spherical harmonic content of the gradient vector $\\nabla n(\\Omega)$. The problem provides the rule that the gradient operator acting on a spherical harmonic $Y_{\\ell m}$ generates components with angular momenta up to degree $\\ell+1$.\n    The density $n(\\Omega)$ contains spherical harmonics up to degree $\\ell=9$. Applying the gradient operator, $\\nabla$, to $n(\\Omega)$ will therefore produce a vector field whose components, when expanded in scalar spherical harmonics, contain degrees up to a maximum of $9+1=10$.\n    Let the Cartesian components of the gradient vector $\\nabla n(\\Omega)$ be denoted by $g_x(\\Omega)$, $g_y(\\Omega)$, and $g_z(\\Omega)$. Each of these is a scalar function on the sphere, and the highest degree in the spherical harmonic expansion of any of these components is $L=10$.\n    The term in the energy density is $|\\nabla n(\\Omega)|^2$, which in Cartesian coordinates is $g_x(\\Omega)^2 + g_y(\\Omega)^2 + g_z(\\Omega)^2$. We analyze the maximum degree in a squared component, for instance $g_x(\\Omega)^2$. This is a product of a function containing spherical harmonics up to degree $10$ with itself. Applying the same product rule as in step $2$, the maximum degree in the expansion of $g_x(\\Omega)^2$ is $10+10=20$. Similarly, the maximum degree in $g_y(\\Omega)^2$ and $g_z(\\Omega)^2$ is also $20$.\n    The sum of these three squared components, $|\\nabla n(\\Omega)|^2$, will therefore have a spherical harmonic expansion with a maximum degree of $L_{\\mathrm{max},3} = 20$.\n\nCombining these results, the full integrand $\\varepsilon_{\\mathrm{xc}}(\\Omega)$ is a linear combination of terms whose maximum spherical harmonic degrees are $9$, $18$, and $20$. The highest degree in the overall expansion of $\\varepsilon_{\\mathrm{xc}}(\\Omega)$ is the maximum of these values:\n$$\nL_{\\mathrm{max}} = \\max(L_{\\mathrm{max},1}, L_{\\mathrm{max},2}, L_{\\mathrm{max},3}) = \\max(9, 18, 20) = 20\n$$\nTo exactly integrate $\\varepsilon_{\\mathrm{xc}}(\\Omega)$, the Lebedev quadrature must be exact for all spherical harmonics up to degree $L_{\\mathrm{max}} = 20$. Therefore, the minimal theoretical exactness degree required is $T^{\\star} = 20$.\n\nThe problem specifies that the practically usable Lebedev rules have odd exactness degrees. We are asked for the minimal odd integer $T$ that satisfies $T \\ge T^{\\star}$.\nGiven $T^{\\star} = 20$, the smallest odd integer that is greater than or equal to $20$ is $21$.\nTherefore, the minimal practical Lebedev exactness degree required is $T = 21$.", "answer": "$$\n\\boxed{21}\n$$", "id": "2790984"}, {"introduction": "The ultimate test of any computational method is not just its theoretical elegance, but its robust and correct implementation in code. This final practice moves from calculation to strategy, asking you to design a comprehensive protocol for validating an atom-centered grid implementation. By evaluating different testing strategies, you will learn to appreciate the importance of using analytic test cases, verifying fundamental invariances and scaling laws, and performing systematic convergence studies to build confidence in a complex scientific code [@problem_id:2790958].", "problem": "In generalized gradient approximations (GGA) for Kohn–Sham density functional theory, exchange–correlation energies are expressed as volume integrals of functions of the electron density and its gradient, i.e., integrals of the form $\\int f[n,\\nabla n](\\mathbf r)\\,d\\mathbf r$. A common dimensionless gradient measure is the reduced gradient $s(\\mathbf r)$, defined for exchange by\n$$\ns(\\mathbf r)\\equiv \\frac{|\\nabla n(\\mathbf r)|}{2\\,k_{\\mathrm F}(\\mathbf r)\\,n(\\mathbf r)},\\qquad k_{\\mathrm F}(\\mathbf r) \\equiv \\big(3\\pi^2 n(\\mathbf r)\\big)^{1/3}.\n$$\nSuppose you want to validate an atom-centered numerical quadrature implementation for exchange–correlation-like integrals by using a controlled test integrand that mimics the structure of a GGA exchange energy density,\n$$\nf(\\mathbf r) \\equiv n(\\mathbf r)^{4/3}\\,\\big(1+\\beta\\,s(\\mathbf r)^2\\big),\n$$\nwith a tunable parameter $\\beta \\in \\mathbb R$.\n\nYou will use standard atom-centered grids with a radial quadrature times an angular quadrature on each atom, combined via a smooth partition of unity (e.g., Becke weights), to approximate integrals $\\int f(\\mathbf r)\\,d\\mathbf r$ by weighted sums $\\sum_{A}\\sum_{i}\\sum_{j} w_{Aij}\\,f(\\mathbf r_{Aij})$. Your goal is to choose a composite test integrand $f(\\mathbf r)$ and a validation protocol that probes both $n(\\mathbf r)$ and $\\nabla n(\\mathbf r)$ contributions and that is grounded in first principles, including invariances and known scaling properties.\n\nWhich option below proposes a scientifically sound composite test integrand and a principled validation protocol that together provide stringent and interpretable checks of a grid implementation?\n\nA. Define a two-center analytic density composed of normalized Gaussians,\n- $n(\\mathbf r)=\\sum_{A=1}^{2} N_A\\left(\\frac{\\alpha_A}{\\pi}\\right)^{3/2}\\exp\\big(-\\alpha_A|\\mathbf r-\\mathbf R_A|^2\\big)$ with $N_A>0$, $\\alpha_A>0$, and distinct centers $\\mathbf R_A$.\n- Use $s(\\mathbf r)=|\\nabla n(\\mathbf r)|/\\big(2\\,k_{\\mathrm F}(\\mathbf r)\\,n(\\mathbf r)\\big)$ with $k_{\\mathrm F}(\\mathbf r)=\\big(3\\pi^2 n(\\mathbf r)\\big)^{1/3}$, and any fixed $\\beta\\neq 0$.\nValidation protocol:\n- Single-center analytic check: for the special case of a single Gaussian and $\\beta=0$, verify $\\int n(\\mathbf r)^{4/3}\\,d\\mathbf r$ against the analytic value to confirm correct Jacobian and radial weighting.\n- Grid-convergence study: on the two-center density, increase radial and angular orders systematically; verify smooth, monotone decrease of the absolute error relative to a near-exact reference obtained on a very dense grid.\n- Rigid-body invariance: translate and rotate the two-center density (shift and rotate $\\{\\mathbf R_A\\}$); verify the integral is invariant within a tight tolerance (e.g., below $10^{-8}$ relative).\n- Uniform coordinate scaling: define $n_\\gamma(\\mathbf r)=\\gamma^3 n(\\gamma\\mathbf r)$ for $\\gamma>0$; verify the scaling law $\\int f_\\gamma(\\mathbf r)\\,d\\mathbf r=\\gamma\\int f(\\mathbf r)\\,d\\mathbf r$, where $f_\\gamma$ is built from $n_\\gamma$ and the same $\\beta$.\n- Linearity in $\\beta$: compute $I(\\beta)=\\int n^{4/3}(1+\\beta s^2)\\,d\\mathbf r$ at several $\\beta$ values; confirm linear dependence and verify the slope numerically equals $\\int n^{4/3}s^2\\,d\\mathbf r$ obtained by a separate quadrature.\n- Partition-of-unity check: spot-check that the Becke weights satisfy $\\sum_A w_A(\\mathbf r)=1$ at random points, to diagnose weight implementation errors.\n\nB. Define a uniform-density top-hat,\n- $n(\\mathbf r)=n_0$ for $|\\mathbf r|\\le R$ and $n(\\mathbf r)=0$ otherwise, with $n_0>0$ and $R>0$.\n- Use $s(\\mathbf r)=0$ because $n(\\mathbf r)$ is constant inside the sphere, and choose any $\\beta$.\nValidation protocol:\n- Use a uniform Cartesian grid of the cube enclosing the sphere with equal weights; verify $\\int f(\\mathbf r)\\,d\\mathbf r = n_0^{4/3}\\,\\tfrac{4\\pi R^3}{3}$ on a single coarse grid.\n- Do not vary radial or angular resolutions, since $s(\\mathbf r)=0$ renders gradient effects negligible.\n\nC. Define a single-center Gaussian density,\n- $n(\\mathbf r)=N\\left(\\frac{\\alpha}{\\pi}\\right)^{3/2}\\exp(-\\alpha r^2)$ with $N>0$, $\\alpha>0$.\n- Use a modified reduced gradient $s'(\\mathbf r)=|\\nabla n(\\mathbf r)|/n(\\mathbf r)^{4/3}$ instead of the standard $s(\\mathbf r)$, and fix $\\beta\\neq 0$.\nValidation protocol:\n- Verify only that under uniform coordinate scaling $n_\\gamma(\\mathbf r)=\\gamma^3 n(\\gamma\\mathbf r)$, the integral scales as $\\int f_\\gamma(\\mathbf r)\\,d\\mathbf r=\\gamma^3\\int f(\\mathbf r)\\,d\\mathbf r$.\n- No translation or rotation checks are needed because the density is spherically symmetric.\n\nD. Define a two-center Slater-type mixture,\n- $n(\\mathbf r)=\\sum_{A=1}^{2} N_A\\,\\frac{\\zeta_A^3}{\\pi}\\exp\\big(-2\\zeta_A|\\mathbf r-\\mathbf R_A|\\big)$ with $N_A>0$, $\\zeta_A>0$.\n- Use the standard $s(\\mathbf r)=|\\nabla n(\\mathbf r)|/\\big(2\\,k_{\\mathrm F}(\\mathbf r)\\,n(\\mathbf r)\\big)$, but set a large negative $\\beta<0$.\nValidation protocol:\n- Hold the radial grid fixed and vary only the angular grid; verify the integral changes by less than $10^{-4}$ upon rotation of the dimer.\n- No checks of partition-of-unity or uniform coordinate scaling are necessary, because the Slater form already captures near-nuclear behavior.\n\nSelect the best option.", "solution": "The problem statement proposes the task of selecting a scientifically sound validation protocol for a numerical quadrature implementation used in Kohn-Sham density functional theory. The protocol must test the ability of an atom-centered grid scheme to compute integrals of the form $\\int f[n,\\nabla n](\\mathbf r)\\,d\\mathbf r$, with a specific focus on a model exchange-like integrand $f(\\mathbf r) = n(\\mathbf r)^{4/3}\\,\\big(1+\\beta\\,s(\\mathbf r)^2\\big)$. The definitions of the electron density $n(\\mathbf r)$, its gradient $\\nabla n(\\mathbf r)$, the reduced gradient $s(\\mathbf r)$, and the Thomas-Fermi wavevector $k_{\\mathrm F}(\\mathbf r)$ are standard and well-defined within the field of theoretical chemistry. The problem is scientifically grounded, well-posed, and contains no internal contradictions or ambiguities. It presents a valid and practical challenge in computational science. Therefore, I will proceed with the evaluation of the provided options.\n\nThe objective is to identify the most stringent and interpretable set of checks for an atom-centered grid implementation. A robust protocol must test all components of the numerical scheme: the radial quadrature, the angular quadrature, the partition of unity for combining atomic contributions, and the implementation of the integrand itself, including both the density and its gradient. Furthermore, the validation must be grounded in fundamental principles, such as physical invariances and mathematical scaling laws.\n\nAnalysis of Option A:\nThis option proposes a comprehensive validation suite based on a two-center analytic density composed of Gaussian functions.\n1.  **Test System**: The choice of a sum of two Gaussians, $n(\\mathbf r)=\\sum_{A=1}^{2} N_A\\left(\\frac{\\alpha_A}{\\pi}\\right)^{3/2}\\exp\\big(-\\alpha_A|\\mathbf r-\\mathbf R_A|^2\\big)$, is excellent. The function is smooth and infinitely differentiable, ensuring that $n(\\mathbf r)$ and $\\nabla n(\\mathbf r)$ are well-behaved everywhere. It is non-spherical, thus providing a non-trivial test case for the angular quadrature and the partition of unity. As it is analytic, all quantities can be computed to arbitrary precision for reference purposes.\n2.  **Validation Protocol**: The protocol is multi-tiered and systematic.\n    -   *Single-center analytic check*: By setting $\\beta=0$ and using a single Gaussian, the problem reduces to computing $\\int n(\\mathbf r)^{4/3}\\,d\\mathbf r$. This integral is analytically solvable and isolates the performance of the radial quadrature and the correct use of the integration Jacobian, which is a crucial first step.\n    -   *Grid-convergence study*: Verifying smooth, monotonic convergence as grid resolution is increased is the cornerstone of validating any numerical method. This demonstrates that the implementation is correct and allows for the estimation of discretization error.\n    -   *Rigid-body invariance*: The integral must be invariant to translation and rotation of the molecule as a whole. Testing this to a tight tolerance (e.g., below $10^{-8}$) is a critical check on the grid construction, the orientation of angular grids, and the partition of unity functions. Failure here points to a serious implementation flaw.\n    -   *Uniform coordinate scaling*: This is a powerful, non-trivial check derived from first principles. For a density scaled as $n_\\gamma(\\mathbf r)=\\gamma^3 n(\\gamma\\mathbf r)$, we must verify the scaling of the integral. The reduced gradient scales as $s_\\gamma(\\mathbf r) = \\frac{|\\nabla n_\\gamma(\\mathbf r)|}{2k_{\\mathrm F,\\gamma}(\\mathbf r)n_\\gamma(\\mathbf r)} = \\frac{\\gamma^4 |\\nabla n(\\gamma\\mathbf r)|}{2(\\gamma k_{\\mathrm F}(\\gamma\\mathbf r))(\\gamma^3 n(\\gamma\\mathbf r))} = s(\\gamma\\mathbf r)$. The integrand $f(\\mathbf r)$ then scales as $f_\\gamma(\\mathbf r) = n_\\gamma(\\mathbf r)^{4/3}(1+\\beta s_\\gamma(\\mathbf r)^2) = (\\gamma^3 n(\\gamma\\mathbf r))^{4/3}(1+\\beta s(\\gamma \\mathbf r)^2) = \\gamma^4 f(\\gamma \\mathbf r)$. The integral becomes $\\int f_\\gamma(\\mathbf r)d\\mathbf r = \\int \\gamma^4 f(\\gamma\\mathbf r) d\\mathbf r$. With the substitution $\\mathbf u = \\gamma\\mathbf r$, $d\\mathbf r = \\gamma^{-3}d\\mathbf u$, the integral is $\\int \\gamma^4 f(\\mathbf u) \\gamma^{-3}d\\mathbf u = \\gamma \\int f(\\mathbf u) d\\mathbf u$. The scaling law $\\int f_\\gamma(\\mathbf r)\\,d\\mathbf r=\\gamma\\int f(\\mathbf r)\\,d\\mathbf r$ is correct. Verifying it numerically provides a stringent test that couples the evaluation of $n$, $\\nabla n$, and the integration volume element.\n    -   *Linearity in $\\beta$*: The integrand $f(\\mathbf r)$ is linear in $\\beta$. The integral $I(\\beta)=\\int f(\\mathbf r)d\\mathbf r$ must also be linear. Verifying this and checking that the slope corresponds to a separate numerical integration of the coefficient of $\\beta$ is a strong internal consistency check.\n    -   *Partition-of-unity check*: Verifying $\\sum_A w_A(\\mathbf r)=1$ at various points is a direct and simple \"sanity check\" for the Becke weight implementation.\nThis protocol is multifaceted, rigorous, and grounded in correct physical and mathematical principles.\nVerdict for A: **Correct**.\n\nAnalysis of Option B:\nThis option uses a uniform-density sphere (a top-hat function).\n1.  **Test System**: This choice is fundamentally flawed. Atom-centered quadrature grids are designed for functions that are smooth and peaked at atomic nuclei. A top-hat function has a discontinuity at the sphere boundary, where its gradient is a Dirac delta function. Such a function is pathological for this type of grid and will lead to large, difficult-to-interpret errors.\n2.  **Validation Protocol**: The protocol is deficient.\n    -   It postulates $s(\\mathbf r)=0$ everywhere, completely ignoring the crucial gradient contribution at the boundary. This fails the stated goal of probing **both** $n(\\mathbf r)$ and $\\nabla n(\\mathbf r)$ contributions. The test is trivialized.\n    -   It suggests using a uniform Cartesian grid, which is not the type of grid being validated (atom-centered grids).\n    -   It recommends a check on a single coarse grid, which is scientifically meaningless. A proper validation requires a convergence study.\n    -   It explicitly advises against varying grid resolutions, which is the opposite of what a proper validation protocol should do.\nThis entire option is misguided and demonstrates a misunderstanding of numerical analysis principles.\nVerdict for B: **Incorrect**.\n\nAnalysis of Option C:\nThis option uses a single-center Gaussian density and a modified reduced gradient.\n1.  **Test System**: A single-center density is too simple. It cannot test the multi-center aspect of the quadrature, which involves the partition of unity and is a primary source of complexity and error in molecular calculations. Rotational invariance is trivially satisfied and thus not tested in a meaningful way.\n2.  **Validation Protocol**: The protocol is both incomplete and incorrect.\n    -   It modifies the standard definition of the reduced gradient to $s'(\\mathbf r)=|\\nabla n(\\mathbf r)|/n(\\mathbf r)^{4/3}$. While one is free to define a test function, this deviation from a physically motivated form reduces the relevance of the test.\n    -   Critically, it proposes verifying an incorrect scaling law. As derived in the analysis of option A, the integrand built with this modified $s'$ would be $f(\\mathbf r) = n^{4/3} + \\beta |\\nabla n|^2 / n^{4/3}$. This scales as $f_\\gamma(\\mathbf r) = \\gamma^4 f(\\gamma \\mathbf r)$, leading to an overall integral scaling of $\\gamma^1$. The proposed scaling law of $\\gamma^3$ is false. A validation protocol based on a falsehood is invalid.\n    -   It incorrectly dismisses the need for invariance checks. Translational invariance is still a non-trivial check even for a single-center density.\nThis option is based on a flawed premise and is insufficient for a comprehensive validation.\nVerdict for C: **Incorrect**.\n\nAnalysis of Option D:\nThis option uses a two-center Slater-type mixture.\n1.  **Test System**: Slater-type functions are a physically reasonable choice for the density.\n2.  **Validation Protocol**: The protocol is grossly inadequate.\n    -   It suggests varying only the angular grid while keeping the radial grid fixed. A proper convergence study must investigate convergence with respect to all grid parameters, both radial and angular.\n    -   It proposes a rotational invariance tolerance of $10^{-4}$. This is an extremely loose tolerance. A well-implemented quadrature should exhibit rotational invariance to a level approaching machine precision (e.g., $10^{-8}$ or better). A tolerance of $10^{-4}$ could easily pass a buggy implementation.\n    -   Most grievously, it makes the false assertion that checks of the partition of unity and uniform coordinate scaling are \"unnecessary.\" These tests probe fundamental aspects of the grid and integration algorithm, and their necessity is independent of the choice of atomic basis functions (Slater vs. Gaussian). To dismiss these principled checks is to invite major, undiscovered errors.\nThis protocol is weak, incomplete, and based on fallacious reasoning.\nVerdict for D: **Incorrect**.\n\nConclusion:\nOption A is the only proposal that constitutes a scientifically sound, rigorous, and comprehensive validation protocol. It employs a suitable analytic test function and a battery of checks that probe all relevant aspects of the numerical implementation based on fundamental principles of numerical analysis and physics. The other options are flawed due to inappropriate test cases, weak or incomplete protocols, and/or reliance on incorrect mathematical statements.", "answer": "$$\\boxed{A}$$", "id": "2790958"}]}