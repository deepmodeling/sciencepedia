{"hands_on_practices": [{"introduction": "The self-interaction error (SIE) is a fundamental deficiency of most approximate density functionals, where an electron unphysically interacts with its own charge density. For a one-electron system like the hydrogen atom, the exact theory dictates a perfect cancellation between the classical electrostatic self-repulsion (Hartree energy) and the self-exchange energy. This exercise provides a rigorous, first-principles demonstration of this cancellation and allows you to quantify the residual SIE in two common families of approximations, the Local Density Approximation (LDA) and a prototype Generalized Gradient Approximation (GGA), by performing an exact analytical calculation.", "problem": "Consider a one-electron hydrogen atom in its nonrelativistic ground state within Kohn–Sham density functional theory (KS-DFT). The spatial orbital is the normalized hydrogenic $1s$ function and the electron is fully spin-polarized. Work in Hartree atomic units, so that the Bohr radius satisfies $a_0 = 1$, the electronic density is spherically symmetric and equals\n\n$$\nn(r) \\;=\\; \\frac{1}{\\pi}\\,\\exp(-2 r),\n$$\n\nand the system has exactly one electron.\n\nStarting from first principles and standard definitions, do the following:\n\n- Using the definition of the classical Hartree electrostatic energy,\n\n$$\nE_{\\mathrm{H}}[n] \\;=\\; \\frac{1}{2}\\int \\!\\! \\int \\frac{n(\\mathbf{r})\\,n(\\mathbf{r}')}{|\\mathbf{r}-\\mathbf{r}'|}\\,d\\mathbf{r}\\,d\\mathbf{r}',\n$$\n\nand the Hartree–Fock exchange energy for a Slater determinant,\n\n$$\nE_{x}^{\\mathrm{HF}}[\\{\\varphi_i\\}] \\;=\\; -\\frac{1}{2}\\sum_{i,j}\\int \\!\\! \\int \\frac{\\varphi_i(\\mathbf{r})\\,\\varphi_j^{*}(\\mathbf{r})\\,\\varphi_j(\\mathbf{r}')\\,\\varphi_i^{*}(\\mathbf{r}')}{|\\mathbf{r}-\\mathbf{r}'|}\\,d\\mathbf{r}\\,d\\mathbf{r}',\n$$\n\nverify from these definitions that for a one-electron system $E_{\\mathrm{H}} + E_{x}^{\\mathrm{exact}} = 0$, where $E_{x}^{\\mathrm{exact}}$ denotes the exact exchange energy functional evaluated on the given density.\n\n- Next, quantify the residual self-interaction error defined as $E_{\\mathrm{H}} + E_{x}^{\\mathrm{approx}}$ for two approximate exchange functionals:\n  1. The Local Density Approximation (LDA) exchange for spin-density functional theory,\n  \n$$\n  E_{x}^{\\mathrm{LDA}}[n_{\\uparrow},n_{\\downarrow}] \\;=\\; -\\frac{3}{4}\\left(\\frac{3}{\\pi}\\right)^{1/3}\\int \\left(n_{\\uparrow}^{4/3} + n_{\\downarrow}^{4/3}\\right)\\,d\\mathbf{r},\n  $$\n\n  evaluated for the fully spin-polarized hydrogen density $n_{\\uparrow} = n$, $n_{\\downarrow} = 0$.\n  2. The second-order gradient expansion (a Generalized Gradient Approximation (GGA) prototype) for exchange,\n  \n$$\n  E_{x}^{\\mathrm{GEA2}}[n] \\;=\\; -C_{x}\\int n(\\mathbf{r})^{4/3}\\left[1 + \\mu\\,s(\\mathbf{r})^{2}\\right]\\,d\\mathbf{r},\n  $$\n\n  where $C_{x} = \\frac{3}{4}\\left(\\frac{3}{\\pi}\\right)^{1/3}$, $\\mu = \\frac{10}{81}$, the reduced gradient is $s(\\mathbf{r}) = \\frac{|\\nabla n(\\mathbf{r})|}{2 k_{F}(\\mathbf{r})\\,n(\\mathbf{r})}$, and the local Fermi wavevector is $k_{F}(\\mathbf{r}) = \\left(3\\pi^{2} n(\\mathbf{r})\\right)^{1/3}$.\n\nDerive analytic closed-form expressions for the two residual self-interaction errors,\n\n$$\n\\Delta_{\\mathrm{LDA}} \\;=\\; E_{\\mathrm{H}}[n] + E_{x}^{\\mathrm{LDA}}[n_{\\uparrow}=n,n_{\\downarrow}=0], \n\\quad\n\\Delta_{\\mathrm{GEA2}} \\;=\\; E_{\\mathrm{H}}[n] + E_{x}^{\\mathrm{GEA2}}[n],\n$$\n\nin terms of rational numbers and powers of $\\pi$ and $3$. Express the final answer as a row matrix $\\bigl[\\Delta_{\\mathrm{LDA}}\\;\\;\\Delta_{\\mathrm{GEA2}}\\bigr]$ and use Hartree ($\\mathrm{E_h}$) as the energy unit. No numerical rounding is required; provide exact expressions.", "solution": "The problem statement is scientifically grounded, well-posed, and objective. All provided definitions, constants, and physical quantities are standard within the framework of density functional theory, or are explicitly defined for the purpose of the problem. The task is a rigorous and verifiable calculation. Therefore, the problem is deemed valid and a full solution will be provided.\n\nThe problem requires a two-part analysis of self-interaction in a one-electron system, specifically the hydrogen atom in its ground state. All calculations are performed in Hartree atomic units ($e=m_e=\\hbar=1$, $a_0=1$).\n\nPart 1: Verification of Exact Self-Interaction Cancellation\n\nFor any one-electron system, the ground-state electron density $n(\\mathbf{r})$ is given by the square of the single occupied orbital $\\varphi_1(\\mathbf{r})$, such that $n(\\mathbf{r}) = |\\varphi_1(\\mathbf{r})|^2$. Since the hydrogen $1s$ orbital is a real function, we have $n(\\mathbf{r}) = \\varphi_1(\\mathbf{r})^2$.\n\nThe Hartree energy is defined as:\n$$\nE_{\\mathrm{H}}[n] = \\frac{1}{2}\\int \\!\\! \\int \\frac{n(\\mathbf{r})\\,n(\\mathbf{r}')}{|\\mathbf{r}-\\mathbf{r}'|}\\,d\\mathbf{r}\\,d\\mathbf{r}'\n$$\nSubstituting $n(\\mathbf{r}) = \\varphi_1(\\mathbf{r})^2$, we get:\n$$\nE_{\\mathrm{H}}[n] = \\frac{1}{2}\\int \\!\\! \\int \\frac{\\varphi_1(\\mathbf{r})^2\\,\\varphi_1(\\mathbf{r}')^2}{|\\mathbf{r}-\\mathbf{r}'|}\\,d\\mathbf{r}\\,d\\mathbf{r}'\n$$\nThe exact exchange energy, $E_{x}^{\\mathrm{exact}}$, is given by the Hartree-Fock exchange expression evaluated on the exact Kohn-Sham orbitals. For a one-electron system, there is only one orbital, $\\varphi_1$. The summations over $i$ and $j$ in the definition of $E_{x}^{\\mathrm{HF}}$ each have only one term, $i=j=1$.\n$$\nE_{x}^{\\mathrm{exact}} = E_{x}^{\\mathrm{HF}}[\\{\\varphi_1\\}] = -\\frac{1}{2}\\int \\!\\! \\int \\frac{\\varphi_1(\\mathbf{r})\\,\\varphi_1^{*}(\\mathbf{r})\\,\\varphi_1(\\mathbf{r}')\\,\\varphi_1^{*}(\\mathbf{r}')}{|\\mathbf{r}-\\mathbf{r}'|}\\,d\\mathbf{r}\\,d\\mathbf{r}'\n$$\nSince $\\varphi_1$ is real, $\\varphi_1^* = \\varphi_1$. The expression simplifies to:\n$$\nE_{x}^{\\mathrm{exact}} = -\\frac{1}{2}\\int \\!\\! \\int \\frac{\\varphi_1(\\mathbf{r})^2\\,\\varphi_1(\\mathbf{r}')^2}{|\\mathbf{r}-\\mathbf{r}'|}\\,d\\mathbf{r}\\,d\\mathbf{r}'\n$$\nComparing this with the expression for the Hartree energy, we see that:\n$$\nE_{x}^{\\mathrm{exact}} = -E_{\\mathrm{H}}[n]\n$$\nTherefore, for any one-electron system, the sum of the Hartree energy and the exact exchange energy is identically zero:\n$$\nE_{\\mathrm{H}}[n] + E_{x}^{\\mathrm{exact}} = 0\n$$\nThis demonstrates the exact cancellation of the self-interaction in the exact theory. Approximate functionals, however, do not typically satisfy this condition, leading to a residual self-interaction error.\n\nPart 2: Calculation of Residual Self-Interaction Errors\n\nWe must compute $\\Delta_{\\mathrm{LDA}} = E_{\\mathrm{H}}[n] + E_{x}^{\\mathrm{LDA}}[n]$ and $\\Delta_{\\mathrm{GEA2}} = E_{\\mathrm{H}}[n] + E_{x}^{\\mathrm{GEA2}}[n]$. The first step is to compute the Hartree energy $E_{\\mathrm{H}}$ for the given density, $n(r) = \\frac{1}{\\pi}\\exp(-2r)$.\n\nCalculation of the Hartree Energy, $E_{\\mathrm{H}}$\nThe Hartree energy is the electrostatic self-energy of the charge distribution $n(\\mathbf{r})$. It can be expressed as $E_{\\mathrm{H}} = \\frac{1}{2}\\int n(\\mathbf{r}) V_{\\mathrm{H}}(\\mathbf{r}) \\,d\\mathbf{r}$, where $V_{\\mathrm{H}}(\\mathbf{r})$ is the electrostatic potential generated by $n(\\mathbf{r})$. For a spherically symmetric density, the potential is:\n$$\nV_{\\mathrm{H}}(r) = \\frac{1}{r} \\int_0^r n(r') 4\\pi r'^2 dr' + \\int_r^\\infty \\frac{n(r') 4\\pi r'^2}{r'} dr'\n$$\nUsing $n(r) = \\frac{1}{\\pi}\\exp(-2r)$, the integrals yield $V_{\\mathrm{H}}(r) = \\frac{1}{r} - \\left(\\frac{1}{r}+1\\right)\\exp(-2r)$.\nNow we compute $E_{\\mathrm{H}}$:\n$$\nE_{\\mathrm{H}} = \\frac{1}{2} \\int_0^\\infty V_{\\mathrm{H}}(r) n(r) 4\\pi r^2 dr = \\frac{1}{2} \\int_0^\\infty \\left[\\frac{1}{r} - \\left(\\frac{1}{r}+1\\right)\\exp(-2r)\\right] \\left(\\frac{1}{\\pi}\\exp(-2r)\\right) 4\\pi r^2 dr\n$$\n$$\nE_{\\mathrm{H}} = 2 \\int_0^\\infty \\left[ r\\exp(-2r) - (r+r^2)\\exp(-4r) \\right] dr\n$$\nWe use the standard integral $\\int_0^\\infty x^k \\exp(-ax) dx = k!/a^{k+1}$:\n- $\\int_0^\\infty r\\exp(-2r) dr = 1!/2^2 = \\frac{1}{4}$\n- $\\int_0^\\infty r^2\\exp(-4r) dr = 2!/4^3 = \\frac{2}{64} = \\frac{1}{32}$\n- $\\int_0^\\infty r\\exp(-4r) dr = 1!/4^2 = \\frac{1}{16}$\nSubstituting these results:\n$$\nE_{\\mathrm{H}} = 2 \\left[ \\frac{1}{4} - \\left(\\frac{1}{16} + \\frac{1}{32}\\right) \\right] = 2 \\left[ \\frac{8}{32} - \\frac{2}{32} - \\frac{1}{32} \\right] = 2 \\left( \\frac{5}{32} \\right) = \\frac{5}{16}\n$$\n\nCalculation of the LDA Self-Interaction Error, $\\Delta_{\\mathrm{LDA}}$\nThe problem provides the LDA exchange energy functional for a spin-polarized system ($n_{\\uparrow}=n, n_{\\downarrow}=0$) as:\n$$\nE_{x}^{\\mathrm{LDA}}[n] = -\\frac{3}{4}\\left(\\frac{3}{\\pi}\\right)^{1/3}\\int n(\\mathbf{r})^{4/3}\\,d\\mathbf{r}\n$$\nWe compute the integral $\\int n(\\mathbf{r})^{4/3}\\,d\\mathbf{r}$:\n$$\n\\int n(r)^{4/3} 4\\pi r^2 dr = \\int_0^\\infty \\left(\\frac{1}{\\pi}\\exp(-2r)\\right)^{4/3} 4\\pi r^2 dr = 4\\pi \\pi^{-4/3} \\int_0^\\infty r^2 \\exp\\left(-\\frac{8}{3}r\\right) dr\n$$\n$$\n= 4\\pi^{-1/3} \\left( \\frac{2!}{(8/3)^3} \\right) = 4\\pi^{-1/3} \\left( \\frac{2}{512/27} \\right) = 4\\pi^{-1/3} \\left( \\frac{54}{512} \\right) = \\frac{27}{64}\\pi^{-1/3}\n$$\nNow we substitute this into the expression for $E_{x}^{\\mathrm{LDA}}$:\n$$\nE_{x}^{\\mathrm{LDA}} = -\\frac{3}{4}\\left(\\frac{3}{\\pi}\\right)^{1/3} \\left(\\frac{27}{64}\\pi^{-1/3}\\right) = -\\frac{3}{4} \\frac{3^{1/3}}{\\pi^{1/3}} \\frac{27}{64\\pi^{1/3}} = -\\frac{81 \\cdot 3^{1/3}}{256 \\pi^{2/3}} = -\\frac{3^{4} \\cdot 3^{1/3}}{256 \\pi^{2/3}} = -\\frac{3^{13/3}}{256 \\pi^{2/3}}\n$$\nThe residual self-interaction error for LDA is:\n$$\n\\Delta_{\\mathrm{LDA}} = E_{\\mathrm{H}} + E_{x}^{\\mathrm{LDA}} = \\frac{5}{16} - \\frac{3^{13/3}}{256 \\pi^{2/3}}\n$$\n\nCalculation of the GEA2 Self-Interaction Error, $\\Delta_{\\mathrm{GEA2}}$\nThe GEA2 exchange energy is given by:\n$$\nE_{x}^{\\mathrm{GEA2}}[n] = -C_{x}\\int n^{4/3}\\left[1 + \\mu\\,s^{2}\\right]\\,d\\mathbf{r} = E_{x}^{\\mathrm{LDA}} - C_x \\mu \\int n^{4/3}s^2\\,d\\mathbf{r}\n$$\nWe need to evaluate the gradient correction term. First, we find the reduced gradient $s$:\n$s = \\frac{|\\nabla n|}{2 k_F n}$, with $k_F = (3\\pi^2 n)^{1/3}$.\nFor the given density, $\\nabla n = \\frac{dn}{dr}\\hat{\\mathbf{r}} = -2 \\frac{1}{\\pi}\\exp(-2r) \\hat{\\mathbf{r}} = -2n\\hat{\\mathbf{r}}$, so $|\\nabla n| = 2n$.\n$$\ns = \\frac{2n}{2 (3\\pi^2 n)^{1/3} n} = \\frac{1}{(3\\pi^2 n)^{1/3}} \\implies s^2 = \\frac{1}{(3\\pi^2 n)^{2/3}} = \\frac{1}{3^{2/3}\\pi^{4/3}n^{2/3}}\n$$\nThe integrand of the correction term is $n^{4/3}s^2$:\n$$\nn^{4/3}s^2 = n^{4/3} \\frac{1}{3^{2/3}\\pi^{4/3}n^{2/3}} = \\frac{n^{2/3}}{3^{2/3}\\pi^{4/3}}\n$$\nThe gradient correction energy is:\n$$\n\\Delta E_{x}^{\\mathrm{GEA2}} = -C_x \\mu \\int \\frac{n^{2/3}}{3^{2/3}\\pi^{4/3}}\\,d\\mathbf{r} = -\\frac{C_x \\mu}{3^{2/3}\\pi^{4/3}} \\int n^{2/3}\\,d\\mathbf{r}\n$$\nWe compute the integral $\\int n^{2/3}\\,d\\mathbf{r}$:\n$$\n\\int n(r)^{2/3} 4\\pi r^2 dr = \\int_0^\\infty \\left(\\frac{1}{\\pi}\\exp(-2r)\\right)^{2/3} 4\\pi r^2 dr = 4\\pi \\pi^{-2/3} \\int_0^\\infty r^2 \\exp\\left(-\\frac{4}{3}r\\right) dr\n$$\n$$\n= 4\\pi^{1/3} \\left( \\frac{2!}{(4/3)^3} \\right) = 4\\pi^{1/3} \\left( \\frac{2}{64/27} \\right) = 4\\pi^{1/3} \\left( \\frac{54}{64} \\right) = \\frac{27}{8}\\pi^{1/3}\n$$\nSubstituting this back, along with $C_x = \\frac{3}{4}\\left(\\frac{3}{\\pi}\\right)^{1/3}$ and $\\mu = \\frac{10}{81}$:\n$$\n\\Delta E_{x}^{\\mathrm{GEA2}} = -\\left(\\frac{3}{4}\\frac{3^{1/3}}{\\pi^{1/3}}\\right) \\left(\\frac{10}{81}\\right) \\frac{1}{3^{2/3}\\pi^{4/3}} \\left(\\frac{27}{8}\\pi^{1/3}\\right)\n$$\n$$\n= -\\frac{3 \\cdot 10 \\cdot 27}{4 \\cdot 81 \\cdot 8} \\frac{3^{1/3}}{3^{2/3}} \\frac{\\pi^{1/3}}{\\pi^{1/3}\\pi^{4/3}} = -\\frac{810}{2592} \\cdot 3^{-1/3} \\pi^{-4/3} = -\\frac{5 \\cdot 162}{16 \\cdot 162} \\cdot 3^{-1/3} \\pi^{-4/3} = -\\frac{5}{16} 3^{-1/3} \\pi^{-4/3}\n$$\nThe total GEA2 exchange energy is $E_{x}^{\\mathrm{GEA2}} = E_{x}^{\\mathrm{LDA}} + \\Delta E_{x}^{\\mathrm{GEA2}}$. The residual self-interaction error is:\n$$\n\\Delta_{\\mathrm{GEA2}} = E_{\\mathrm{H}} + E_{x}^{\\mathrm{GEA2}} = \\frac{5}{16} - \\frac{3^{13/3}}{256 \\pi^{2/3}} - \\frac{5}{16} 3^{-1/3} \\pi^{-4/3}\n$$\nThe final results are the expressions for $\\Delta_{\\mathrm{LDA}}$ and $\\Delta_{\\mathrm{GEA2}}$.", "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{5}{16} - \\frac{3^{13/3}}{256 \\pi^{2/3}} & \\frac{5}{16} - \\frac{3^{13/3}}{256 \\pi^{2/3}} - \\frac{5 \\cdot 3^{-1/3}}{16 \\pi^{4/3}} \\end{pmatrix}}\n$$", "id": "2901403"}, {"introduction": "The self-interaction error manifests in many-electron systems as a delocalization error, artificially favoring fractional charges and leading to catastrophic failures in describing processes like molecular dissociation. To understand this, we can move beyond specific systems and use a simplified theoretical model that captures the essential physics governing these errors. This practice guides you in building a quantitative two-site model to diagnose both the fractional charge error related to energy convexity and the fractional spin error that arises from incorrect handling of spin-degenerate ensembles.", "problem": "Consider a two-site, one-orbital-per-site dissociation-limit model for a stretched diatomic, intended to capture the essential self-interaction and delocalization features of Kohn-Sham density functional theory (Kohn-Sham DFT). You will build a quantitative diagnostic for many-electron self-interaction error by comparing a simplified exact reference (consistent with ensemble density functional theory) to a toy approximate functional that violates the exact flat-plane conditions. Work in atomic units (Hartree), so all energies must be reported in Hartree.\n\nFundamental base and modeling assumptions:\n- The Hohenberg-Kohn theorems and ensemble density functional theory imply exact piecewise linearity of the ground-state energy with respect to the total electron number and constancy of the energy for ensembles of degenerate spin states. In this dissociation-limit model, each site supports at most one electron.\n- For an isolated site with a single electron, the exact site energy is linear in the occupation: if the total on-site occupation is $n \\in [0,1]$, the exact site contribution is $-I \\, n$, where $I$ is the first ionization energy of the corresponding atom. For hydrogen in atomic units, $I \\approx 0.5$.\n- Site asymmetry is modeled by an energy bias $\\Delta$ (in Hartree) so that the one-electron energy on site $A$ is $-I_{A} = -(I + \\Delta/2)$ and on site $B$ is $-I_{B} = -(I - \\Delta/2)$. Positive $\\Delta$ makes site $A$ more favorable.\n- Many-electron self-interaction and delocalization errors of a typical approximate density functional are modeled by two scalar error coefficients:\n  1. A charge-curvature coefficient $c$ (in Hartree) multiplying $n(1-n)$ per site, which vanishes at integer occupations and is maximized at $n = 1/2$. Negative $c$ induces convex deviation below the straight line between integers, favoring delocalized fractional charge.\n  2. A spin-curvature coefficient $s$ (in Hartree) multiplying $n_{\\uparrow} n_{\\downarrow}$ per site, which is zero for pure-spin densities and maximized at equal-spin mixtures. Positive $s$ penalizes fractional spin ensembles, creating an erroneous energy maximum at half-and-half spin mixture.\n- In the dissociation limit, noninteracting kinetic contributions are negligible for localized orbitals, and Hartree plus exact exchange cancel self-interaction exactly for one electron per site in the exact reference. We therefore ignore kinetic and explicit electron-electron terms beyond the above model corrections.\n\nDefinitions and tasks:\n- Let the on-site spin occupations be $n_{A\\uparrow}$, $n_{A\\downarrow}$ and $n_{B\\uparrow}$, $n_{B\\downarrow}$. For each site $i \\in \\{A,B\\}$, the total occupation is $n_i = n_{i\\uparrow} + n_{i\\downarrow}$, with $0 \\le n_i \\le 1$ in the dissociation limit.\n- The exact site energy model is $E_{\\text{exact},i} = -I_i \\, n_i$ and the total exact energy is $E_{\\text{exact}} = \\sum_i E_{\\text{exact},i}$.\n- The toy approximate site energy is $E_{\\text{approx},i} = -I_i \\, n_i + c \\, n_i (1 - n_i) + s \\, n_{i\\uparrow} n_{i\\downarrow}$ and the total approximate energy is $E_{\\text{approx}} = \\sum_i E_{\\text{approx},i}$.\n\nYour program must, for each parameter set $(I, c, s, \\Delta)$ provided in the test suite, compute two diagnostics in Hartree:\n1. Fractional-charge delocalization error for stretched $H_2^+$ (one electron in total):\n   - Model the one-electron system with total occupation $n_A + n_B = 1$. To isolate fractional charge effects, assume spin-pure densities at each site, so $n_{i\\downarrow} = 0$ and $n_{i\\uparrow} = n_i$ for both $i \\in \\{A,B\\}$.\n   - Let $\\alpha \\in [0,1]$ denote the fraction of the electron on site $A$ so that $n_A = \\alpha$ and $n_B = 1 - \\alpha$.\n   - The exact minimum energy is the lower of the two site linear energies at integer localization. The approximate minimum energy is obtained by minimizing the approximate total energy over $\\alpha \\in [0,1]$.\n   - Define the delocalization error as $\\Delta E_{\\text{charge}} = E_{\\text{approx}}^{\\min} - E_{\\text{exact}}^{\\min}$ in Hartree. Negative $\\Delta E_{\\text{charge}}$ indicates spurious lowering (delocalization error).\n2. Fractional-spin error for stretched $H_2$ (two electrons in total):\n   - Enforce one electron per site in the dissociation limit, $n_A = n_B = 1$.\n   - Consider the ensemble with half-and-half spin mixing on each site but with opposite local polarizations to produce total $S_z = 0$: on site $A$, take $n_{A\\uparrow} = 1/2$ and $n_{A\\downarrow} = 1/2$, while on site $B$, take $n_{B\\uparrow} = 1/2$ and $n_{B\\downarrow} = 1/2$.\n   - The exact energy is independent of fractional spin and equals the sum of linear site energies at $n_A = n_B = 1$. The approximate energy includes the spin-curvature terms.\n   - Define the fractional-spin error as $\\Delta E_{\\text{spin}} = E_{\\text{approx}}(\\text{half-and-half spin}) - E_{\\text{exact}}$ in Hartree. Positive $\\Delta E_{\\text{spin}}$ indicates an erroneous energy elevation at fractional spin.\n\nAngle units are not involved. All outputs are energies in Hartree. Round each reported float to six decimal places.\n\nTest suite:\n- Case 1 (symmetric, clear delocalization and spin errors): $I = 0.5$, $c = -0.20$, $s = 0.30$, $\\Delta = 0.0$.\n- Case 2 (mild asymmetry): $I = 0.5$, $c = -0.10$, $s = 0.20$, $\\Delta = 0.15$.\n- Case 3 (no charge curvature): $I = 0.5$, $c = 0.0$, $s = 0.25$, $\\Delta = 0.0$.\n- Case 4 (strong charge curvature, strong asymmetry, no spin curvature): $I = 0.5$, $c = -0.50$, $s = 0.0$, $\\Delta = 0.60$.\n\nRequired final output format:\n- Your program should produce a single line of output containing the results for the test cases as a comma-separated list enclosed in square brackets. Each element of this list corresponds to one test case and must itself be a two-element list in the order $[\\Delta E_{\\text{charge}}, \\Delta E_{\\text{spin}}]$. For example, the printed line must look like: [[x1,y1],[x2,y2],[x3,y3],[x4,y4]], where each $x_i$ and $y_i$ is a float in Hartree rounded to six decimal places.", "solution": "The problem statement is scientifically well-posed, complete, and contains no contradictions. It describes a valid and common toy model used in theoretical chemistry to analyze and understand self-interaction errors in density functional theory. We will therefore proceed with the derivation of the two requested error diagnostics.\n\nFirst, we analyze the fractional-charge delocalization error, $\\Delta E_{\\text{charge}}$, for the one-electron system, which serves as a model for stretched $H_2^+$. The total number of electrons is $1$. The electron's distribution is described by a parameter $\\alpha$, where site $A$ has occupation $n_A = \\alpha$ and site $B$ has occupation $n_B = 1-\\alpha$, with $\\alpha \\in [0,1]$. The site ionization energies are defined as $I_A = I + \\Delta/2$ and $I_B = I - \\Delta/2$.\n\nThe total exact energy is a linear function of $\\alpha$:\n$$E_{\\text{exact}}(\\alpha) = -I_A n_A - I_B n_B = -(I + \\Delta/2)\\alpha - (I - \\Delta/2)(1-\\alpha) = -I - \\Delta\\alpha + \\Delta/2$$\nThe minimum of a linear function on the closed interval $[0,1]$ must occur at an endpoint. The minimal exact energy is therefore:\n$$E_{\\text{exact}}^{\\min} = \\min(E_{\\text{exact}}(0), E_{\\text{exact}}(1)) = \\min(-I_B, -I_A) = \\min(-(I-\\Delta/2), -(I+\\Delta/2)) = -(I + |\\Delta|/2)$$\n\nFor this one-electron system, the problem specifies spin-pure densities ($n_{i\\downarrow}=0$), so the approximate energy on site $i$ is $E_{\\text{approx},i} = -I_i n_i + c \\, n_i(1-n_i)$, as the spin-curvature term $s \\, n_{i\\uparrow}n_{i\\downarrow}$ is zero. The total approximate energy is the sum over both sites:\n$$E_{\\text{approx}}(\\alpha) = \\left[-I_A \\alpha + c\\alpha(1-\\alpha)\\right] + \\left[-I_B(1-\\alpha) + c(1-\\alpha)\\alpha\\right]$$\n$$E_{\\text{approx}}(\\alpha) = E_{\\text{exact}}(\\alpha) + 2c\\alpha(1-\\alpha) = -2c\\alpha^2 + (2c-\\Delta)\\alpha - I + \\Delta/2$$\nThis is a quadratic function of $\\alpha$. To find its minimum, $E_{\\text{approx}}^{\\min}$, on the interval $\\alpha \\in [0,1]$, we analyze its derivative with respect to $\\alpha$:\n$$\\frac{dE_{\\text{approx}}}{d\\alpha} = -4c\\alpha + 2c - \\Delta$$\nSetting the derivative to zero yields the extremum at $\\alpha_{ext} = \\frac{2c-\\Delta}{4c} = \\frac{1}{2} - \\frac{\\Delta}{4c}$, for $c \\neq 0$. The nature of this extremum depends on the second derivative, $\\frac{d^2E_{\\text{approx}}}{d\\alpha^2} = -4c$.\n\n- If $c \\geq 0$, the function is concave or linear. The minimum on $[0,1]$ must be at an endpoint, $\\alpha=0$ or $\\alpha=1$. At these integer occupations, the $c \\cdot n_i(1-n_i)$ terms are zero, so $E_{\\text{approx}}^{\\min} = E_{\\text{exact}}^{\\min}$. Thus, for $c \\geq 0$, the delocalization error is $\\Delta E_{\\text{charge}} = 0$.\n- If $c < 0$, the function is convex, and $\\alpha_{ext}$ corresponds to a minimum. The minimum value on the interval $[0,1]$ is found by evaluating $E_{\\text{approx}}(\\alpha)$ at $\\alpha^* = \\max(0, \\min(1, \\alpha_{ext}))$. Let this minimum value be $E_{\\text{approx}}^{\\min}$.\n\nThe delocalization error is then calculated as $\\Delta E_{\\text{charge}} = E_{\\text{approx}}^{\\min} - E_{\\text{exact}}^{\\min}$.\n\nSecond, we analyze the fractional-spin error, $\\Delta E_{\\text{spin}}$, for the two-electron system ($H_2$ model). The problem specifies a total occupation of one electron per site, $n_A = 1$ and $n_B = 1$. The state under consideration is a non-polarized spin ensemble defined by local occupations $n_{A\\uparrow}=n_{A\\downarrow}=1/2$ and $n_{B\\uparrow}=n_{B\\downarrow}=1/2$.\n\nThe exact energy is independent of the spin distribution for a fixed integer occupation. It is given by the sum of the linear site energies:\n$$E_{\\text{exact}} = -I_A n_A - I_B n_B = -I_A(1) - I_B(1) = -(I + \\Delta/2) - (I - \\Delta/2) = -2I$$\n\nThe approximate energy is calculated using the full site energy expression, $E_{\\text{approx},i} = -I_i n_i + c \\, n_i(1-n_i) + s \\, n_{i\\uparrow}n_{i\\downarrow}$.\nFor each site $i \\in \\{A, B\\}$, since $n_i=1$, the charge-curvature term $c \\, n_i(1-n_i)$ is zero. The spin-curvature term for each site is $s \\, n_{i\\uparrow}n_{i\\downarrow} = s(1/2)(1/2) = s/4$.\nThe total approximate energy is:\n$$E_{\\text{approx}} = \\sum_{i \\in \\{A,B\\}} \\left(-I_i(1) + c(1)(0) + s/4 \\right) = (-I_A + s/4) + (-I_B + s/4) = -2I + s/2$$\n\nThe fractional-spin error is the difference between the approximate and exact energies for this state:\n$$\\Delta E_{\\text{spin}} = E_{\\text{approx}} - E_{\\text{exact}} = (-2I + s/2) - (-2I) = s/2$$\nThis error is determined solely by the spin-curvature parameter $s$, as designed by the model.\n\nThese derived formulae are implemented below to compute the diagnostics for each test case.\n```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates delocalization and fractional-spin errors for a two-site model\n    of a diatomic molecule in the dissociation limit, based on concepts from\n    Kohn-Sham DFT.\n    \"\"\"\n    test_cases = [\n        # (I, c, s, Delta)\n        # Case 1: symmetric, clear delocalization and spin errors\n        (0.5, -0.20, 0.30, 0.0),\n        # Case 2: mild asymmetry\n        (0.5, -0.10, 0.20, 0.15),\n        # Case 3: no charge curvature\n        (0.5, 0.0, 0.25, 0.0),\n        # Case 4: strong charge curvature, strong asymmetry, no spin curvature\n        (0.5, -0.50, 0.0, 0.60),\n    ]\n\n    all_results = []\n    \n    for I, c, s, delta in test_cases:\n        # --- Part 1: Fractional-charge delocalization error (Delta E_charge) ---\n\n        # The exact minimum energy for the one-electron system is determined by\n        # the electron localizing on the more favorable site.\n        E_exact_min = -(I + abs(delta) / 2.0)\n        \n        delta_E_charge = 0.0\n        if c < 0:\n            # For c < 0, the approximate energy function is convex and may have a\n            # minimum at a fractional charge distribution.\n            # The vertex of the quadratic E_approx(alpha) is at:\n            alpha_ext = 0.5 - delta / (4.0 * c)\n            \n            # The minimum on the interval [0, 1] is at alpha_ext if it falls\n            # within the interval, otherwise it's at the boundary.\n            alpha_star = np.clip(alpha_ext, 0.0, 1.0)\n            \n            # The total approximate energy is E_approx = E_exact + correction.\n            # E_exact(alpha) = -I - delta*alpha + delta/2\n            E_exact_at_alpha_star = -I - delta * alpha_star + delta / 2.0\n            correction_term = 2.0 * c * alpha_star * (1.0 - alpha_star)\n            E_approx_min = E_exact_at_alpha_star + correction_term\n            \n            delta_E_charge = E_approx_min - E_exact_min\n        \n        # --- Part 2: Fractional-spin error (Delta E_spin) ---\n        \n        # This error is calculated for a two-electron system (one per site)\n        # with a half-and-half spin mixture on each site.\n        # The error evaluates to s/2.\n        delta_E_spin = s / 2.0\n        \n        all_results.append([delta_E_charge, delta_E_spin])\n\n    # --- Final Output Formatting ---\n    # The output must be a single line, formatted as a list of lists of floats,\n    # with each float rounded to six decimal places.\n    # Ex: [[x1,y1],[x2,y2],[x3,y3],[x4,y4]]\n    \n    formatted_pairs = []\n    for res_pair in all_results:\n        # The :.6f format specifier handles both rounding and padding with zeros.\n        formatted_pairs.append(f\"[{res_pair[0]:.6f},{res_pair[1]:.6f}]\")\n    \n    final_output = f\"[{','.join(formatted_pairs)}]\"\n    # This function is not called in the final script, but if run, it would print the result.\n    # print(final_output)\n\nsolve()\n```", "answer": "[[-0.050000,0.150000],[-0.005625,0.100000],[0.000000,0.125000],[-0.040000,0.000000]]", "id": "2815502"}, {"introduction": "When studying open-shell systems like radicals, the Unrestricted Kohn-Sham (UKS) method is often employed, allowing alpha and beta spin electrons to occupy different spatial orbitals. While this provides necessary flexibility, the resulting single-determinant wavefunction is often not a pure eigenstate of the total spin-squared operator, $\\hat{S}^2$, a phenomenon known as spin contamination. This exercise provides a practical method for quantifying this contamination by calculating the expectation value $\\langle \\hat{S}^2 \\rangle$ and interpreting its deviation from the exact value as a mixture of different spin states.", "problem": "A computational chemist is studying a three-electron radical using the Unrestricted Kohn-Sham (UKS) method, where the system's state is approximated by a single Slater determinant. In this unrestricted formalism, electrons with spin-up (alpha) and spin-down (beta) are allowed to occupy different spatial orbitals. The calculation uses a basis set that results in two occupied alpha spatial orbitals ($\\phi_1^\\alpha, \\phi_2^\\alpha$) and one occupied beta spatial orbital ($\\phi_1^\\beta$).\n\nFor a single-determinant wavefunction composed of $N_\\alpha$ alpha electrons and $N_\\beta$ beta electrons, the expectation value of the total spin-squared operator, $\\hat{S}^2$, is given by the formula:\n$$ \\langle \\hat{S}^2 \\rangle = \\left(\\frac{N_\\alpha - N_\\beta}{2}\\right)\\left(\\frac{N_\\alpha - N_\\beta}{2} + 1\\right) + N_\\beta - \\sum_{i=1}^{N_\\alpha} \\sum_{j=1}^{N_\\beta} (\\langle \\phi_i^\\alpha | \\phi_j^\\beta \\rangle)^2 $$\nwhere $\\langle \\phi_i^\\alpha | \\phi_j^\\beta \\rangle$ represents the overlap integral between the $i$-th alpha spatial orbital and the $j$-th beta spatial orbital.\n\nFrom the output of the UKS calculation for the three-electron radical, the following non-zero overlap integrals between the occupied spatial orbitals are obtained:\n- $\\langle \\phi_1^\\alpha | \\phi_1^\\beta \\rangle = 0.995$\n- $\\langle \\phi_2^\\alpha | \\phi_1^\\beta \\rangle = 0.080$\n\nBecause the alpha and beta spatial orbitals are not identical, the resulting UKS wavefunction is not a pure eigenstate of the $\\hat{S}^2$ operator. This phenomenon is known as spin contamination. The calculated state can be modeled as a mixture of the target pure spin state (the one with the lowest energy for a radical) and the next-highest pure spin state.\n\nCalculate the percentage of contamination from this next-highest spin state in the UKS wavefunction. Express your answer as a decimal. Round your final answer to four significant figures.", "solution": "We have an unrestricted single-determinant with $N_{\\alpha}=2$ and $N_{\\beta}=1$. The expectation value of $\\hat{S}^{2}$ for a single-determinant UKS state is\n$$\n\\langle \\hat{S}^{2} \\rangle = \\left(\\frac{N_{\\alpha}-N_{\\beta}}{2}\\right)\\left(\\frac{N_{\\alpha}-N_{\\beta}}{2}+1\\right) + N_{\\beta} - \\sum_{i=1}^{N_{\\alpha}} \\sum_{j=1}^{N_{\\beta}} \\left(\\langle \\phi_{i}^{\\alpha} | \\phi_{j}^{\\beta} \\rangle\\right)^{2}.\n$$\nInsert $N_{\\alpha}=2$ and $N_{\\beta}=1$:\n$$\n\\left(\\frac{2-1}{2}\\right)\\left(\\frac{2-1}{2}+1\\right) = \\frac{1}{2}\\cdot\\frac{3}{2}=\\frac{3}{4}.\n$$\nWith the given overlaps, the double sum is\n$$\n\\left(\\langle \\phi_{1}^{\\alpha} | \\phi_{1}^{\\beta} \\rangle\\right)^{2} + \\left(\\langle \\phi_{2}^{\\alpha} | \\phi_{1}^{\\beta} \\rangle\\right)^{2}\n= (0.995)^{2} + (0.080)^{2} = 0.990025 + 0.0064 = 0.996425.\n$$\nTherefore,\n$$\n\\langle \\hat{S}^{2} \\rangle = \\frac{3}{4} + 1 - 0.996425 = 0.753575.\n$$\nFor three electrons, the target pure spin state is the doublet with $S_{D}=\\frac{1}{2}$, and the next-highest is the quartet with $S_{Q}=\\frac{3}{2}$. Model the UKS state as a mixture of these two eigenstates,\n$$\n|\\Psi\\rangle = c_{D}|\\Psi_{D}\\rangle + c_{Q}|\\Psi_{Q}\\rangle, \\quad |c_{D}|^{2}+|c_{Q}|^{2}=1,\n$$\nso that, using orthogonality of different spin eigenstates,\n$$\n\\langle \\hat{S}^{2} \\rangle = |c_{D}|^{2} S_{D}(S_{D}+1) + |c_{Q}|^{2} S_{Q}(S_{Q}+1).\n$$\nWith $S_{D}(S_{D}+1)=\\frac{3}{4}$ and $S_{Q}(S_{Q}+1)=\\frac{15}{4}$, define $w_{Q}=|c_{Q}|^{2}$ (the contamination fraction). Then\n$$\n\\langle \\hat{S}^{2} \\rangle = (1-w_{Q})\\frac{3}{4} + w_{Q}\\frac{15}{4}\n= \\frac{3}{4} + 3\\,w_{Q}.\n$$\nSolve for $w_{Q}$:\n$$\nw_{Q} = \\frac{\\langle \\hat{S}^{2} \\rangle - \\frac{3}{4}}{3}\n= \\frac{0.753575 - 0.75}{3} = \\frac{0.003575}{3} = 0.001191666\\ldots\n$$\nRounded to four significant figures, the contamination as a decimal is $0.001192$.", "answer": "$$\\boxed{0.001192}$$", "id": "1407893"}]}