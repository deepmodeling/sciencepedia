{"hands_on_practices": [{"introduction": "The Local Density Approximation (LDA) is a cornerstone of modern DFT, providing a surprisingly effective description of many materials. To truly understand its origins and limitations, we must go back to its theoretical foundation: the uniform electron gas. This exercise provides a hands-on derivation of the scaling behavior for the noninteracting kinetic and exchange energies, two fundamental components of the total energy functional for this idealized system [@problem_id:2453886].", "problem": "Consider a three-dimensional uniform electron gas (often called jellium): a very large number of spin-unpolarized electrons with constant number density $\\rho_{0}$ occupying a cubic box of volume $V$, with periodic boundary conditions, in the thermodynamic limit. Work in Hartree atomic units, so that $\\hbar=m_{e}=e=4\\pi\\varepsilon_{0}=1$. In Kohn–Sham Density Functional Theory (DFT), the noninteracting kinetic energy functional $T_{s}[\\rho]$ is defined as the ground-state kinetic energy of a noninteracting reference system that reproduces the density $\\rho(\\mathbf{r})$, and the exchange energy functional $E_{x}[\\rho]$ is defined as the Fock exchange energy of that reference system.\n\nFor the uniform density $\\rho(\\mathbf{r})=\\rho_{0}$, determine the exact dependence of $T_{s}[\\rho_{0}]$ and $E_{x}[\\rho_{0}]$ on $\\rho_{0}$ and $V$, assuming a spin degeneracy of $g_{s}=2$. Express your final answer as a two-entry row matrix containing, in order, $T_{s}[\\rho_{0}]$ and $E_{x}[\\rho_{0}]$, in Hartree atomic units. No rounding is required.", "solution": "The problem as stated is valid. It is a canonical problem from solid-state physics and density functional theory concerning the uniform electron gas, also known as jellium. The premises are scientifically sound, well-posed, and all necessary information is provided. We will proceed with the solution.\n\nThe problem asks for the noninteracting kinetic energy functional, $T_s[\\rho_0]$, and the exchange energy functional, $E_x[\\rho_0]$, for a uniform electron gas of constant density $\\rho_0$ in a volume $V$. We are working in Hartree atomic units where $\\hbar = m_e = e = 4\\pi\\varepsilon_0 = 1$. The spin degeneracy is given as $g_s=2$.\n\nFirst, we determine the noninteracting kinetic energy, $T_s[\\rho_0]$. By definition, this is the kinetic energy of a system of noninteracting electrons that has the ground-state density $\\rho_0$. For a uniform gas, the noninteracting reference system is simply a gas of noninteracting fermions. The ground state is constructed by filling the single-particle energy levels up to the Fermi energy.\n\nThe single-particle wavefunctions for electrons in a cubic box of volume $V=L^3$ with periodic boundary conditions are plane waves:\n$$\n\\psi_{\\mathbf{k}}(\\mathbf{r}) = \\frac{1}{\\sqrt{V}} \\exp(i\\mathbf{k} \\cdot \\mathbf{r})\n$$\nThe corresponding kinetic energies are:\n$$\n\\epsilon_{\\mathbf{k}} = \\frac{\\hbar^2 |\\mathbf{k}|^2}{2m_e} = \\frac{|\\mathbf{k}|^2}{2}\n$$\nIn the ground state, all states with wavevector magnitude $|\\mathbf{k}|$ up to the Fermi wavevector, $k_F$, are occupied. The total number of electrons, $N$, is related to the density $\\rho_0$ by $N = \\rho_0 V$. In the thermodynamic limit, the sum over discrete $\\mathbf{k}$ states can be replaced by an integral over $\\mathbf{k}$-space:\n$$\n\\sum_{\\mathbf{k}} \\to V \\int \\frac{d^3\\mathbf{k}}{(2\\pi)^3}\n$$\nThe total number of electrons is found by integrating over the volume of the Fermi sphere in $\\mathbf{k}$-space, multiplied by the spin degeneracy $g_s=2$:\n$$\nN = g_s V \\int_{|\\mathbf{k}| \\le k_F} \\frac{d^3\\mathbf{k}}{(2\\pi)^3} = 2V \\left( \\frac{4\\pi k_F^3}{3(2\\pi)^3} \\right) = V \\frac{k_F^3}{3\\pi^2}\n$$\nFrom this, we establish the relationship between the density $\\rho_0 = N/V$ and the Fermi wavevector $k_F$:\n$$\n\\rho_0 = \\frac{k_F^3}{3\\pi^2} \\implies k_F = (3\\pi^2 \\rho_0)^{1/3}\n$$\nThe total noninteracting kinetic energy $T_s[\\rho_0]$ is the sum of the energies of all occupied states:\n$$\nT_s[\\rho_0] = g_s \\sum_{|\\mathbf{k}| \\le k_F} \\epsilon_{\\mathbf{k}} = g_s V \\int_{|\\mathbf{k}| \\le k_F} \\frac{|\\mathbf{k}|^2}{2} \\frac{d^3\\mathbf{k}}{(2\\pi)^3}\n$$\nSubstituting $g_s=2$ and switching to spherical coordinates in $\\mathbf{k}$-space ($d^3\\mathbf{k} = 4\\pi |\\mathbf{k}|^2 d|\\mathbf{k}|$), the integral becomes:\n$$\nT_s[\\rho_0] = 2 V \\frac{4\\pi}{(2\\pi)^3} \\int_0^{k_F} \\frac{k^2}{2} k^2 dk = \\frac{V}{\\pi^2} \\int_0^{k_F} \\frac{k^4}{2} dk = \\frac{V}{2\\pi^2} \\left[ \\frac{k^5}{5} \\right]_0^{k_F} = \\frac{V k_F^5}{10\\pi^2}\n$$\nFinally, we substitute the expression for $k_F$ in terms of $\\rho_0$:\n$$\nT_s[\\rho_0] = \\frac{V}{10\\pi^2} \\left[ (3\\pi^2 \\rho_0)^{1/3} \\right]^5 = \\frac{V}{10\\pi^2} (3\\pi^2)^{5/3} \\rho_0^{5/3} = \\frac{3^{5/3}\\pi^{10/3}}{10\\pi^2} V \\rho_0^{5/3} = \\frac{3}{10}(3\\pi^2)^{2/3} V \\rho_0^{5/3}\n$$\nThis is the well-known Thomas-Fermi kinetic energy functional evaluated for a uniform density.\n\nNext, we determine the exchange energy, $E_x[\\rho_0]$. For the uniform electron gas, the exchange energy given by the Local Density Approximation (LDA) is exact. The LDA exchange energy functional is given by:\n$$\nE_x^{\\text{LDA}}[\\rho] = \\int e_x^{\\text{unif}}(\\rho(\\mathbf{r})) d^3\\mathbf{r}\n$$\nwhere $e_x^{\\text{unif}}(\\rho)$ is the exchange energy per unit volume for a uniform, spin-unpolarized electron gas of density $\\rho$. The standard expression for this quantity is:\n$$\ne_x^{\\text{unif}}(\\rho) = - C_x \\rho^{4/3}\n$$\nwith the constant $C_x$ given by:\n$$\nC_x = \\frac{3}{4} \\left(\\frac{3}{\\pi}\\right)^{1/3}\n$$\nFor the system in question, the density is constant, $\\rho(\\mathbf{r}) = \\rho_0$. Therefore, the exchange energy is:\n$$\nE_x[\\rho_0] = \\int -C_x \\rho_0^{4/3} d^3\\mathbf{r} = -C_x \\rho_0^{4/3} \\int d^3\\mathbf{r} = -C_x V \\rho_0^{4/3}\n$$\nSubstituting the expression for $C_x$:\n$$\nE_x[\\rho_0] = -\\frac{3}{4} \\left(\\frac{3}{\\pi}\\right)^{1/3} V \\rho_0^{4/3}\n$$\nThis is the exact exchange energy for the uniform electron gas.\n\nWe combine the two results into a single row matrix as requested.\nThe first entry is $T_s[\\rho_0] = \\frac{3}{10}(3\\pi^2)^{2/3} V \\rho_0^{5/3}$.\nThe second entry is $E_x[\\rho_0] = -\\frac{3}{4}(\\frac{3}{\\pi})^{1/3} V \\rho_0^{4/3}$.", "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{3}{10}(3\\pi^{2})^{2/3} V \\rho_{0}^{5/3}  - \\frac{3}{4} \\left(\\frac{3}{\\pi}\\right)^{1/3} V \\rho_{0}^{4/3} \\end{pmatrix}}\n$$", "id": "2453886"}, {"introduction": "While powerful, approximate functionals like the LDA and GGAs have well-known systematic errors, one of which is their incorrect description of the potential an electron experiences far from an atom or molecule. This practice will guide you through a first-principles derivation of the correct asymptotic behavior of the exact exchange-correlation potential. By contrasting this with the failure of semi-local functionals, you will gain a crucial diagnostic tool for understanding functional performance [@problem_id:2768010].", "problem": "Consider an isolated, finite, neutral $N$-electron system with point nuclei at positions $\\{\\mathbf{R}_{A}\\}$ and charges $\\{Z_{A}\\}$, described within Kohn–Sham density functional theory (Kohn–Sham DFT). The Kohn–Sham effective potential is $v_{s}(\\mathbf{r}) = v_{\\mathrm{ext}}(\\mathbf{r}) + v_{H}(\\mathbf{r}) + v_{\\mathrm{xc}}(\\mathbf{r})$, where $v_{\\mathrm{ext}}(\\mathbf{r}) = -\\sum_{A} \\frac{Z_{A}}{|\\mathbf{r} - \\mathbf{R}_{A}|}$ is the external potential due to the nuclei, $v_{H}(\\mathbf{r})$ is the Hartree (classical Coulomb) potential of the electron density $n(\\mathbf{r})$, and $v_{\\mathrm{xc}}(\\mathbf{r})$ is the exchange–correlation (xc) potential. Assume the system is finite and neutral, i.e., $\\sum_{A} Z_{A} = N$, and the density $n(\\mathbf{r})$ is localized.\n\nUse only the following fundamental facts and definitions as starting points:\n\n1) There exists an exact representation of the exchange–correlation energy in terms of the coupling–constant averaged exchange–correlation hole $\\bar{n}_{\\mathrm{xc}}(\\mathbf{r}',\\mathbf{r})$,\n$$\nE_{\\mathrm{xc}}[n] \\;=\\; \\frac{1}{2} \\int d\\mathbf{r} \\int d\\mathbf{r}' \\, \\frac{n(\\mathbf{r})\\, \\bar{n}_{\\mathrm{xc}}(\\mathbf{r}',\\mathbf{r})}{|\\mathbf{r} - \\mathbf{r}'|},\n$$\nwhere, for each fixed $\\mathbf{r}$, the hole obeys the sum rule and localization property\n$$\n\\int d\\mathbf{r}' \\, \\bar{n}_{\\mathrm{xc}}(\\mathbf{r}',\\mathbf{r}) \\;=\\; -1, \\qquad \\text{and} \\qquad \\bar{n}_{\\mathrm{xc}}(\\mathbf{r}',\\mathbf{r}) \\text{ is localized in } \\mathbf{r}' \\text{ for finite systems.}\n$$\n\n2) The local density approximation (LDA) exchange energy density of the uniform electron gas is\n$$\n\\varepsilon_{x}(n) \\;=\\; -\\frac{3}{4} \\left( \\frac{3}{\\pi} \\right)^{1/3} n^{4/3},\n$$\nand the corresponding LDA exchange potential is\n$$\nv_{x}^{\\mathrm{LDA}}(n) \\;=\\; \\frac{d}{dn}\\!\\left[ n\\, \\varepsilon_{x}(n) \\right] \\;=\\; -\\left( \\frac{3}{\\pi} \\right)^{1/3} n^{1/3}.\n$$\n\n3) The exact ground-state density of a finite system with first ionization energy $I$ has the asymptotic form\n$$\nn(r) \\;\\sim\\; A\\, r^{\\beta} \\exp\\!\\big( -2 \\sqrt{2 I}\\, r \\big) \\quad \\text{as } r \\to \\infty,\n$$\nfor some constants $A$ and $\\beta$ determined by the highest occupied Kohn–Sham orbital.\n\nTasks:\n\n(a) Starting from item $1$ and basic electrostatics (multipole expansion) for localized charge distributions, derive the leading-order asymptotic behavior of the exact exchange–correlation potential $v_{\\mathrm{xc}}(r)$ as $r \\to \\infty$ in a neutral, finite system.\n\n(b) Using items $2$ and $3$, determine the leading asymptotic behavior of the LDA exchange potential $v_{x}^{\\mathrm{LDA}}(r)$ as $r \\to \\infty$, and explain why any generalized gradient approximation (GGA) that depends semilocally on $n(\\mathbf{r})$ and a finite number of its derivatives also fails to reproduce the leading term you obtained in part (a).\n\nReport as your final answer only the leading asymptotic expression for $v_{\\mathrm{xc}}(r)$ obtained in part (a), as a single closed-form analytic expression. Do not include units.", "solution": "The problem statement has been evaluated and is determined to be valid. It is scientifically grounded in density functional theory, self-contained, and well-posed. The a priori statements and definitions are standard and correct within this field of theoretical chemistry. We proceed with the solution.\n\n(a) Derivation of the asymptotic behavior of the exact exchange-correlation potential $v_{\\mathrm{xc}}(r)$.\n\nThe task is to derive the leading-order behavior of the exact exchange–correlation potential, $v_{\\mathrm{xc}}(\\mathbf{r})$, for large distances $r = |\\mathbf{r}|$ from a finite, neutral system. The starting point is the provided expression for the exchange-correlation energy, $E_{\\mathrm{xc}}[n]$, in terms of the coupling-constant averaged exchange-correlation hole, $\\bar{n}_{\\mathrm{xc}}(\\mathbf{r}',\\mathbf{r})$. While the formal definition of $v_{\\mathrm{xc}}(\\mathbf{r})$ is the functional derivative $\\frac{\\delta E_{\\mathrm{xc}}[n]}{\\delta n(\\mathbf{r})}$, a direct and physically transparent derivation for the asymptotic region can be achieved via an electrostatic analogy that is strongly suggested by the problem statement.\n\nThe quantity $\\bar{n}_{\\mathrm{xc}}(\\mathbf{r}',\\mathbf{r})$ represents the charge distribution of the exchange-correlation hole that surrounds an electron located at position $\\mathbf{r}$. The total charge of this hole is given by the sum rule from Item 1:\n$$\n\\int d\\mathbf{r}' \\, \\bar{n}_{\\mathrm{xc}}(\\mathbf{r}',\\mathbf{r}) = -1\n$$\nThis means the hole corresponds to a net charge of $-1$ elementary charge. For a finite system, the electron density $n(\\mathbf{r})$ is localized around the nuclei (which we place near the origin $\\mathbf{r}=0$). When the reference electron is at a position $\\mathbf{r}$ far from the system ($r \\to \\infty$), the hole it induces in the electronic density must also be localized where the density is, i.e., near the origin. Thus, for large $|\\mathbf{r}|$, the hole distribution $\\bar{n}_{\\mathrm{xc}}(\\mathbf{r}',\\mathbf{r})$ is localized in the integration variable $\\mathbf{r}'$ near the origin.\n\nThe exchange-correlation potential $v_{\\mathrm{xc}}(\\mathbf{r})$ is properly understood as the work done per unit charge against the field of the xc-hole, which corresponds to the electrostatic potential generated by the xc-hole charge distribution.\n$$\nv_{\\mathrm{xc}}(\\mathbf{r}) = \\int d\\mathbf{r}' \\frac{\\bar{n}_{\\mathrm{xc}}(\\mathbf{r}',\\mathbf{r})}{|\\mathbf{r} - \\mathbf{r}'|}\n$$\nTo find the asymptotic behavior of this potential for $r \\to \\infty$, we can apply the multipole expansion to the Coulomb kernel $|\\mathbf{r} - \\mathbf{r}'|^{-1}$, since $|\\mathbf{r}|$ is large and $|\\mathbf{r}'|$ is confined to a finite region near the origin. The expansion is:\n$$\n\\frac{1}{|\\mathbf{r} - \\mathbf{r}'|} = \\frac{1}{r} + \\frac{\\mathbf{r} \\cdot \\mathbf{r}'}{r^3} + \\dots = \\frac{1}{r} + O\\left(\\frac{1}{r^2}\\right)\n$$\nSubstituting the leading term of this expansion into the integral for $v_{\\mathrm{xc}}(\\mathbf{r})$ gives:\n$$\nv_{\\mathrm{xc}}(\\mathbf{r}) = \\int d\\mathbf{r}' \\left( \\frac{1}{r} + O\\left(\\frac{1}{r^2}\\right) \\right) \\bar{n}_{\\mathrm{xc}}(\\mathbf{r}',\\mathbf{r}) = \\frac{1}{r} \\int d\\mathbf{r}' \\bar{n}_{\\mathrm{xc}}(\\mathbf{r}',\\mathbf{r}) + \\int d\\mathbf{r}' O\\left(\\frac{1}{r^2}\\right) \\bar{n}_{\\mathrm{xc}}(\\mathbf{r}',\\mathbf{r})\n$$\nThe first term is the monopole contribution. Using the hole sum rule $\\int d\\mathbf{r}' \\, \\bar{n}_{\\mathrm{xc}}(\\mathbf{r}',\\mathbf{r}) = -1$, this term becomes $-\\frac{1}{r}$. The higher-order terms, such as the dipole term, decay faster (as $1/r^2$ or faster). Thus, the leading-order asymptotic behavior of the exact exchange-correlation potential is:\n$$\nv_{\\mathrm{xc}}(r) \\to -\\frac{1}{r} \\quad \\text{as } r \\to \\infty\n$$\nThis result is consistent with the physical picture that an electron far from a neutral $N$-electron system must experience the Coulomb potential of the remaining $(N-1)$-electron cation, which has a net charge of $+1$. The total Kohn-Sham potential $v_s(\\mathbf{r})$ must reproduce this physical potential. For a neutral system, the sum of the external nuclear potential $v_{\\mathrm{ext}}(r) \\to -N/r$ and the Hartree potential $v_H(r) \\to N/r$ leads to a cancellation of the $1/r$ terms, with the remainder $v_{\\mathrm{ext}}(r) + v_H(r)$ decaying as $O(1/r^2)$ or faster. Therefore, the correct $-1/r$ asymptotic behavior of $v_s(r)$ must come entirely from $v_{\\mathrm{xc}}(r)$.\n\n(b) Asymptotic behavior of LDA and GGA potentials.\n\nThe local density approximation (LDA) for the exchange potential is given in Item 2 as a purely local function of the electron density $n(\\mathbf{r})$:\n$$\nv_{x}^{\\mathrm{LDA}}(r) = v_{x}^{\\mathrm{LDA}}(n(r)) = -\\left( \\frac{3}{\\pi} \\right)^{1/3} [n(r)]^{1/3}\n$$\nThe asymptotic form of the exact ground-state density is given in Item 3:\n$$\nn(r) \\sim A r^{\\beta} \\exp(-2 \\sqrt{2 I} r) \\quad \\text{as } r \\to \\infty\n$$\nSubstituting this density into the LDA potential expression yields:\n$$\nv_{x}^{\\mathrm{LDA}}(r) \\sim -\\left( \\frac{3}{\\pi} \\right)^{1/3} \\left[ A r^{\\beta} \\exp(-2 \\sqrt{2 I} r) \\right]^{1/3} = -C r^{\\beta/3} \\exp\\left(-\\frac{2}{3} \\sqrt{2 I} r\\right)\n$$\nwhere $C$ is a constant. This potential decays exponentially to zero. This exponential decay is fundamentally different from the slow, power-law decay of the exact potential, $v_{\\mathrm{xc}}(r) \\to -1/r$. The LDA potential vanishes much too quickly in the asymptotic region.\n\nThis failure is not limited to the LDA. Any generalized gradient approximation (GGA) defines the exchange-correlation energy as an integral over a function that depends semi-locally on the density $n(\\mathbf{r})$ and a finite number of its derivatives, e.g., $E_{\\mathrm{xc}}^{\\mathrm{GGA}} = \\int f(n(\\mathbf{r}), \\nabla n(\\mathbf{r}), \\nabla^2 n(\\mathbf{r}), \\dots) d\\mathbf{r}$. The corresponding potential $v_{\\mathrm{xc}}^{\\mathrm{GGA}}(\\mathbf{r})$ will also be a semi-local function of $n(\\mathbf{r})$ and its derivatives.\n\nGiven that $n(r)$ decays exponentially as $r \\to \\infty$, all of its derivatives will also decay with the same exponential rate, e.g., $|\\nabla n(r)| \\sim \\exp(-2 \\sqrt{2 I} r)$, $|\\nabla^2 n(r)| \\sim \\exp(-2 \\sqrt{2 I} r)$, and so on. Any potential constructed from these exponentially decaying quantities will itself decay exponentially.\n$$\nv_{\\mathrm{xc}}^{\\mathrm{GGA}}(r) \\sim \\exp(-\\delta r) \\quad (\\text{for some } \\delta  0)\n$$\nTherefore, all standard GGA functionals also fail to reproduce the correct $-1/r$ tail of the exchange-correlation potential. This is a generic deficiency of semi-local approximations, which are by construction \"short-sighted\" and cannot capture the non-local information encoded in the xc-hole sum rule that governs the potential's long-range behavior.", "answer": "$$\n\\boxed{-\\frac{1}{r}}\n$$", "id": "2768010"}, {"introduction": "Solving the Kohn-Sham equations is an iterative process that requires finding a self-consistent density, a task that can be notoriously difficult to converge. This exercise delves into the numerical art of accelerating this convergence using the Direct Inversion in the Iterative Subspace (DIIS) method. You will derive the core equations of this powerful extrapolation technique and apply it to a concrete example, gaining insight into the practical machinery that makes modern DFT calculations feasible [@problem_id:2768007].", "problem": "Consider the Kohn–Sham density functional theory fixed-point problem for the ground-state electron density, formulated as finding a density $n(\\mathbf{r})$ such that $n(\\mathbf{r}) = \\mathcal{F}[n](\\mathbf{r})$, where $\\mathcal{F}$ is the Kohn–Sham mapping from an input density to the output density obtained by solving the single-particle Kohn–Sham equations under the effective potential generated by that input density. Let the residual associated with a trial density $n$ be $r[n](\\mathbf{r}) = \\mathcal{F}[n](\\mathbf{r}) - n(\\mathbf{r})$. In a discretized representation, write the residuals as vectors $r \\in \\mathbb{R}^{N}$, and suppose a symmetric positive-definite preconditioner $M \\in \\mathbb{R}^{N \\times N}$ defines the weighted inner product $\\langle x, y \\rangle_{M} = x^{\\mathsf{T}} M y$ and the induced norm $\\|x\\|_{M} = \\sqrt{x^{\\mathsf{T}} M x}$. \n\nYou are given a set of past trial densities $\\{n_{i}\\}_{i=1}^{k}$ with associated residuals $\\{r_{i}\\}_{i=1}^{k}$ and wish to construct an extrapolated density $n^{\\ast} = \\sum_{i=1}^{k} c_{i} n_{i}$, with coefficients satisfying the affine constraint $\\sum_{i=1}^{k} c_{i} = 1$. Assume the residual is locally affine over this subspace so that $r[n^{\\ast}] \\approx \\sum_{i=1}^{k} c_{i} r_{i}$. \n\nTasks:\n- Briefly explain, at a fundamental level, how preconditioning (acting through $M$) and Pulay/Direct Inversion in the Iterative Subspace (DIIS) acceleration act to improve Self-Consistent Field (SCF) convergence without invoking any black-box formulas.\n- Starting only from the fixed-point formulation, the definition of the residual, and the above $M$-weighted norm, set up and derive the first-order optimality conditions for the coefficient vector $c = (c_{1},\\dots,c_{k})^{\\mathsf{T}}$ that minimize $\\| \\sum_{i=1}^{k} c_{i} r_{i} \\|_{M}^{2}$ subject to $\\sum_{i=1}^{k} c_{i} = 1$. Your derivation should yield a closed-form expression for $c$ in terms of $\\{r_{i}\\}$ and $M$.\n\nNow specialize to $k=2$ in a two-dimensional discretization with\n$$\nr_{1} = \\begin{pmatrix} 1 \\\\ 2 \\end{pmatrix}, \\quad\nr_{2} = \\begin{pmatrix} -1 \\\\ 1 \\end{pmatrix}, \\quad\nM = \\begin{pmatrix} 2  0 \\\\ 0  1 \\end{pmatrix}.\n$$\nCompute the DIIS coefficients $c_{1}$ and $c_{2}$ that minimize the $M$-norm of the extrapolated residual under the affine constraint. Express your final answer as a single row vector $(c_{1}\\; c_{2})$ in exact form. Do not round.", "solution": "The problem presented is well-posed, scientifically grounded, and contains all necessary information for a complete solution. We will proceed with the analysis.\n\nThe Self-Consistent Field (SCF) procedure aims to solve a non-linear fixed-point problem, which in the context of Kohn-Sham density functional theory is $n(\\mathbf{r}) = \\mathcal{F}[n](\\mathbf{r})$. Simple iterative substitution, known as simple mixing, often fails to converge. This failure is typically due to so-called charge sloshing, where electron density oscillates unstably between different regions of the system across iterations. Mathematically, this corresponds to the Jacobian of the mapping $\\mathcal{F}$ having eigenvalues with magnitude greater than unity, leading to amplification of error components.\n\nThe Direct Inversion in the Iterative Subspace (DIIS) method, also known as Pulay mixing, provides a robust remedy. It is an extrapolation technique, not a simple mixing scheme. Instead of using only the last iterate, DIIS considers a history of $k$ previous trial densities $\\{n_i\\}$ and their associated residuals $\\{r_i\\}$. The core assumption is that the residual mapping is approximately affine over the subspace spanned by these iterates. DIIS then constructs a new trial density $n^{\\ast} = \\sum_{i=1}^{k} c_{i} n_{i}$ by finding the set of coefficients $\\{c_i\\}$ that minimizes the norm of the corresponding extrapolated residual, $\\sum_{i=1}^{k} c_{i} r_{i}$, subject to the normalization constraint $\\sum_{i=1}^{k} c_i = 1$. This procedure seeks a point in the affine subspace of densities that is closest to satisfying the fixed-point condition $r[n]=\\mathcal{F}[n]-n=0$. By constructing this \"best\" guess from a history, DIIS effectively identifies and damps the oscillatory error modes that plague simpler methods, leading to substantially improved, often super-linear, convergence.\n\nPreconditioning addresses the fact that not all components of the residual vector are equally significant for convergence. The standard Euclidean norm treats all components equally, which is physically naive. In many systems, particularly large or inhomogeneous ones, there exist \"soft\" modes of charge fluctuation (e.g., long-wavelength variations) that converge very slowly. A preconditioner $M$ is a symmetric positive-definite matrix used to define a weighted norm, $\\|r\\|_M^2 = r^{\\mathsf{T}} M r$. A well-chosen preconditioner approximates the inverse of the system's static dielectric matrix or the Jacobian of the residual map. By minimizing the $M$-weighted norm of the residual, the DIIS procedure gives more weight to suppressing the physically softest, most troublesome error modes, thereby accelerating the convergence of the most persistent components of the error.\n\nWe now derive the expression for the optimal coefficients $c_i$. The problem is to minimize the objective function $f(c) = \\| \\sum_{i=1}^{k} c_{i} r_{i} \\|_{M}^{2}$ subject to the constraint $\\sum_{i=1}^{k} c_{i} = 1$. Let $c$ be the column vector of coefficients $(c_1, \\dots, c_k)^{\\mathsf{T}}$ and let $R$ be the $N \\times k$ matrix whose columns are the residual vectors $\\{r_i\\}_{i=1}^k$. The linear combination of residuals can be written as $Rc$.\n\nThe objective function is\n$$f(c) = (Rc)^{\\mathsf{T}} M (Rc) = c^{\\mathsf{T}} (R^{\\mathsf{T}} M R) c$$\nLet us define the $k \\times k$ matrix $B = R^{\\mathsf{T}} M R$. The elements of this matrix are given by $B_{ij} = r_i^{\\mathsf{T}} M r_j = \\langle r_i, r_j \\rangle_M$. The constraint can be written as $\\mathbf{1}^{\\mathsf{T}} c = 1$, where $\\mathbf{1}$ is a $k \\times 1$ column vector of ones.\n\nWe use the method of Lagrange multipliers to solve this constrained optimization problem. The Lagrangian is:\n$$\\mathcal{L}(c, \\lambda) = c^{\\mathsf{T}} B c - \\lambda (\\mathbf{1}^{\\mathsf{T}} c - 1)$$\nThe first-order optimality conditions are found by setting the gradients with respect to $c$ and $\\lambda$ to zero.\nThe gradient with respect to the vector $c$ is:\n$$\\nabla_c \\mathcal{L} = 2Bc - \\lambda\\mathbf{1} = 0$$\nThis yields $2Bc = \\lambda\\mathbf{1}$. Since $M$ is positive-definite and we assume the vectors $\\{r_i\\}$ are linearly independent, the matrix $B$ is also positive-definite and thus invertible. We can therefore write:\n$$c = \\frac{\\lambda}{2} B^{-1} \\mathbf{1}$$\nThe derivative with respect to $\\lambda$ simply recovers the constraint:\n$$\\frac{\\partial \\mathcal{L}}{\\partial \\lambda} = -(\\mathbf{1}^{\\mathsf{T}} c - 1) = 0 \\implies \\mathbf{1}^{\\mathsf{T}} c = 1$$\nSubstituting the expression for $c$ into the constraint equation allows us to find the Lagrange multiplier:\n$$\\mathbf{1}^{\\mathsf{T}} \\left( \\frac{\\lambda}{2} B^{-1} \\mathbf{1} \\right) = 1$$\n$$\\frac{\\lambda}{2} (\\mathbf{1}^{\\mathsf{T}} B^{-1} \\mathbf{1}) = 1 \\implies \\frac{\\lambda}{2} = \\frac{1}{\\mathbf{1}^{\\mathsf{T}} B^{-1} \\mathbf{1}}$$\nFinally, we substitute this expression for $\\frac{\\lambda}{2}$ back into the equation for $c$:\n$$c = \\frac{B^{-1} \\mathbf{1}}{\\mathbf{1}^{\\mathsf{T}} B^{-1} \\mathbf{1}}$$\nThis is the closed-form expression for the optimal DIIS coefficients.\n\nNow, we specialize to the given case with $k=2$:\n$$\nr_{1} = \\begin{pmatrix} 1 \\\\ 2 \\end{pmatrix}, \\quad\nr_{2} = \\begin{pmatrix} -1 \\\\ 1 \\end{pmatrix}, \\quad\nM = \\begin{pmatrix} 2  0 \\\\ 0  1 \\end{pmatrix}\n$$\nFirst, we compute the elements of the $2 \\times 2$ matrix $B$:\n$$B_{11} = r_1^{\\mathsf{T}} M r_1 = \\begin{pmatrix} 1  2 \\end{pmatrix} \\begin{pmatrix} 2  0 \\\\ 0  1 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 2 \\end{pmatrix} = \\begin{pmatrix} 2  2 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 2 \\end{pmatrix} = (2)(1) + (2)(2) = 6$$\n$$B_{12} = r_1^{\\mathsf{T}} M r_2 = \\begin{pmatrix} 1  2 \\end{pmatrix} \\begin{pmatrix} 2  0 \\\\ 0  1 \\end{pmatrix} \\begin{pmatrix} -1 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 2  2 \\end{pmatrix} \\begin{pmatrix} -1 \\\\ 1 \\end{pmatrix} = (2)(-1) + (2)(1) = 0$$\n$$B_{21} = r_2^{\\mathsf{T}} M r_1 = B_{12} = 0 \\text{ (by symmetry)}$$\n$$B_{22} = r_2^{\\mathsf{T}} M r_2 = \\begin{pmatrix} -1  1 \\end{pmatrix} \\begin{pmatrix} 2  0 \\\\ 0  1 \\end{pmatrix} \\begin{pmatrix} -1 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} -2  1 \\end{pmatrix} \\begin{pmatrix} -1 \\\\ 1 \\end{pmatrix} = (-2)(-1) + (1)(1) = 3$$\nThe matrix $B$ is:\n$$B = \\begin{pmatrix} 6  0 \\\\ 0  3 \\end{pmatrix}$$\nIts inverse is trivial to compute:\n$$B^{-1} = \\begin{pmatrix} \\frac{1}{6}  0 \\\\ 0  \\frac{1}{3} \\end{pmatrix}$$\nWe now apply the derived formula for $c = (c_1, c_2)^{\\mathsf{T}}$ with $\\mathbf{1} = (1, 1)^{\\mathsf{T}}$.\nFirst, calculate the numerator $B^{-1} \\mathbf{1}$:\n$$B^{-1} \\mathbf{1} = \\begin{pmatrix} \\frac{1}{6}  0 \\\\ 0  \\frac{1}{3} \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{6} \\\\ \\frac{1}{3} \\end{pmatrix}$$\nNext, calculate the denominator $\\mathbf{1}^{\\mathsf{T}} B^{-1} \\mathbf{1}$:\n$$\\mathbf{1}^{\\mathsf{T}} B^{-1} \\mathbf{1} = \\begin{pmatrix} 1  1 \\end{pmatrix} \\begin{pmatrix} \\frac{1}{6} \\\\ \\frac{1}{3} \\end{pmatrix} = \\frac{1}{6} + \\frac{1}{3} = \\frac{1}{6} + \\frac{2}{6} = \\frac{3}{6} = \\frac{1}{2}$$\nThe coefficient vector $c$ is then:\n$$c = \\frac{\\begin{pmatrix} \\frac{1}{6} \\\\ \\frac{1}{3} \\end{pmatrix}}{\\frac{1}{2}} = 2 \\begin{pmatrix} \\frac{1}{6} \\\\ \\frac{1}{3} \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{3} \\\\ \\frac{2}{3} \\end{pmatrix}$$\nThus, the optimal coefficients are $c_1 = \\frac{1}{3}$ and $c_2 = \\frac{2}{3}$.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{1}{3}  \\frac{2}{3}\n\\end{pmatrix}\n}\n$$", "id": "2768007"}]}