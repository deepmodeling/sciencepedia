{"hands_on_practices": [{"introduction": "Mastering degenerate perturbation theory begins with a foundational exercise: applying the full procedure to a simple, exactly solvable system. This practice involves a particle in a two-dimensional box, a canonical model in quantum mechanics. By manually constructing and diagonalizing the perturbation matrix for a two-fold degeneracy, you will solidify the core mechanics of the theory, from evaluating integrals to finding the 'good' basis states that lift the degeneracy. [@problem_id:2767570]", "problem": "Consider a non-relativistic particle of mass $m$ confined in a two-dimensional infinite square well of side length $L$ with $0 \\le x \\le L$ and $0 \\le y \\le L$. The unperturbed Hamiltonian $\\hat{H}_{0}$ describes the standard infinite-well boundary-value problem, whose normalized eigenfunctions are the sine-product basis\n$$\n\\psi_{n_{x},n_{y}}(x,y) \\;=\\; \\phi_{n_{x}}(x)\\,\\phi_{n_{y}}(y), \n\\qquad \n\\phi_{n}(u) \\;=\\; \\sqrt{\\frac{2}{L}}\\,\\sin\\!\\left(\\frac{n\\pi u}{L}\\right),\n$$\nwith corresponding energies\n$$\nE^{(0)}_{n_{x},n_{y}} \\;=\\; \\frac{\\hbar^{2}\\pi^{2}}{2mL^{2}}\\left(n_{x}^{2}+n_{y}^{2}\\right).\n$$\nThe levels with $(n_{x},n_{y})=(1,2)$ and $(2,1)$ are exactly degenerate under $\\hat{H}_{0}$.\n\nNow introduce a weak, static perturbation\n$$\n\\hat{V}(x,y) \\;=\\; \\lambda\\,\\frac{xy}{L^{2}},\n$$\nwhere $\\lambda$ is a real constant with dimensions of energy and $|\\lambda|$ is sufficiently small that time-independent perturbation theory is valid.\n\nUsing degenerate time-independent perturbation theory from first principles, do the following:\n- Construct the secular (effective) matrix $W$ within the degenerate subspace spanned by $\\{\\psi_{1,2},\\psi_{2,1}\\}$, where $W_{ij}=\\langle \\psi_{i}|\\hat{V}|\\psi_{j}\\rangle$ with $i,j\\in\\{(1,2),(2,1)\\}$.\n- Evaluate all matrix elements explicitly by carrying out the required integrals in the sine basis. Express your results in closed form in terms of $\\lambda$, $\\pi$, and rational numbers.\n- Determine the orthonormal linear combinations of $\\{\\psi_{1,2},\\psi_{2,1}\\}$ that diagonalize $\\hat{V}$, and identify which combination has the lower first-order energy.\n- From your diagonalization, deduce the first-order energy splitting $\\Delta E^{(1)}$ between the two corrected energies in this degenerate manifold.\n\nReport as your final answer a single closed-form analytic expression for the first-order splitting $\\Delta E^{(1)}$ in terms of $\\lambda$. Do not substitute numerical values and do not include units. No rounding is required.", "solution": "The principles of time-independent degenerate perturbation theory must be applied. The problem is well-defined and presents a standard exercise in quantum mechanics.\n\nThe unperturbed Hamiltonian $\\hat{H}_{0}$ has degenerate eigenstates for the states labeled by quantum numbers $(n_{x},n_{y})=(1,2)$ and $(2,1)$. Let us denote these orthonormal states as $|\\psi_{a}\\rangle \\equiv |\\psi_{1,2}\\rangle$ and $|\\psi_{b}\\rangle \\equiv |\\psi_{2,1}\\rangle$. Both states correspond to the same unperturbed energy:\n$$\nE^{(0)} = E^{(0)}_{1,2} = E^{(0)}_{2,1} = \\frac{\\hbar^{2}\\pi^{2}}{2mL^{2}}(1^{2}+2^{2}) = \\frac{5\\hbar^{2}\\pi^{2}}{2mL^{2}}\n$$\nThe perturbation is given by $\\hat{V}(x,y) = \\lambda \\frac{xy}{L^{2}}$. To find the first-order corrections to the energy, we must diagonalize the perturbation matrix $W$ constructed within the degenerate subspace spanned by $\\{|\\psi_{a}\\rangle, |\\psi_{b}\\rangle\\}$. The elements of this $2 \\times 2$ matrix are $W_{ij} = \\langle \\psi_{i} | \\hat{V} | \\psi_{j} \\rangle$, where $i,j \\in \\{a,b\\}$.\n\nThe matrix elements are:\n$$\nW_{aa} = \\langle \\psi_{1,2} | \\hat{V} | \\psi_{1,2} \\rangle\n$$\n$$\nW_{bb} = \\langle \\psi_{2,1} | \\hat{V} | \\psi_{2,1} \\rangle\n$$\n$$\nW_{ab} = \\langle \\psi_{1,2} | \\hat{V} | \\psi_{2,1} \\rangle\n$$\n$$\nW_{ba} = \\langle \\psi_{2,1} | \\hat{V} | \\psi_{1,2} \\rangle\n$$\nSince $\\hat{V}$ is a real operator, the matrix $W$ is Hermitian. In this case, it is real and symmetric, so $W_{ab} = W_{ba}$.\n\nThe eigenfunctions are separable: $\\psi_{n_{x},n_{y}}(x,y) = \\phi_{n_{x}}(x)\\phi_{n_{y}}(y)$. The perturbation $\\hat{V}$ is also separable. This simplifies the calculation of the matrix elements. A general matrix element is:\n$$\n\\langle \\psi_{n_{x},n_{y}} | \\hat{V} | \\psi_{n'_{x},n'_{y}} \\rangle = \\frac{\\lambda}{L^{2}} \\left( \\int_{0}^{L} \\phi_{n_{x}}(x) \\, x \\, \\phi_{n'_{x}}(x) \\, dx \\right) \\left( \\int_{0}^{L} \\phi_{n_{y}}(y) \\, y \\, \\phi_{n'_{y}}(y) \\, dy \\right)\n$$\nLet us define the integral:\n$$\nI(n, n') = \\int_{0}^{L} u \\, \\phi_{n}(u) \\, \\phi_{n'}(u) \\, du = \\frac{2}{L} \\int_{0}^{L} u \\sin\\left(\\frac{n\\pi u}{L}\\right) \\sin\\left(\\frac{n'\\pi u}{L}\\right) \\, du\n$$\nThe matrix elements become:\n$$\nW_{aa} = \\frac{\\lambda}{L^{2}} I(1,1) I(2,2)\n$$\n$$\nW_{bb} = \\frac{\\lambda}{L^{2}} I(2,2) I(1,1) = W_{aa}\n$$\n$$\nW_{ab} = \\frac{\\lambda}{L^{2}} I(1,2) I(2,1)\n$$\n$$\nW_{ba} = \\frac{\\lambda}{L^{2}} I(2,1) I(1,2) = W_{ab}\n$$\nWe must now evaluate the integral $I(n, n')$.\n\nFor the diagonal case, $n=n'$:\n$$\n\\sin^{2}\\left(\\frac{n\\pi u}{L}\\right) = \\frac{1}{2}\\left(1 - \\cos\\left(\\frac{2n\\pi u}{L}\\right)\\right)\n$$\n$$\nI(n,n) = \\frac{1}{L} \\int_{0}^{L} u \\left(1 - \\cos\\left(\\frac{2n\\pi u}{L}\\right)\\right) du = \\frac{1}{L}\\left[\\frac{u^{2}}{2}\\right]_{0}^{L} - \\frac{1}{L}\\int_{0}^{L} u \\cos\\left(\\frac{2n\\pi u}{L}\\right) du\n$$\nThe first term is $\\frac{L}{2}$. The second integral is zero, which can be shown by integration by parts:\n$$\n\\int u \\cos(ku) du = \\frac{u}{k}\\sin(ku) + \\frac{1}{k^{2}}\\cos(ku)\n$$\nEvaluating from $0$ to $L$ with $k = \\frac{2n\\pi}{L}$, the $\\sin$ term vanishes at both limits, and the $\\cos$ term is identical at both limits, resulting in zero.\nThus, $I(n,n) = \\frac{L}{2}$.\n\nFor the off-diagonal case, $n \\neq n'$, we use the product-to-sum identity:\n$$\n\\sin\\left(\\frac{n\\pi u}{L}\\right)\\sin\\left(\\frac{n'\\pi u}{L}\\right) = \\frac{1}{2}\\left(\\cos\\left(\\frac{(n-n')\\pi u}{L}\\right) - \\cos\\left(\\frac{(n+n')\\pi u}{L}\\right)\\right)\n$$\nThe integral $I(n,n')$ for $n \\neq n'$ is non-zero only if $n$ and $n'$ have different parity. For $n=1$ and $n'=2$, they have different parity, so the integral is non-zero.\n$$\nI(1,2) = \\frac{1}{L} \\int_{0}^{L} u \\left(\\cos\\left(\\frac{-\\pi u}{L}\\right) - \\cos\\left(\\frac{3\\pi u}{L}\\right)\\right) du\n$$\nUsing the primitive $\\int u \\cos(ku) du$:\n$$\n\\int_{0}^{L} u \\cos\\left(\\frac{\\pi u}{L}\\right) du = \\left[\\frac{Lu}{\\pi}\\sin\\left(\\frac{\\pi u}{L}\\right) + \\frac{L^{2}}{\\pi^{2}}\\cos\\left(\\frac{\\pi u}{L}\\right)\\right]_{0}^{L} = \\frac{L^{2}}{\\pi^{2}}(\\cos(\\pi) - \\cos(0)) = -\\frac{2L^{2}}{\\pi^{2}}\n$$\n$$\n\\int_{0}^{L} u \\cos\\left(\\frac{3\\pi u}{L}\\right) du = \\left[\\frac{Lu}{3\\pi}\\sin\\left(\\frac{3\\pi u}{L}\\right) + \\frac{L^{2}}{9\\pi^{2}}\\cos\\left(\\frac{3\\pi u}{L}\\right)\\right]_{0}^{L} = \\frac{L^{2}}{9\\pi^{2}}(\\cos(3\\pi) - \\cos(0)) = -\\frac{2L^{2}}{9\\pi^{2}}\n$$\nSo, $I(1,2) = \\frac{1}{L} \\left( -\\frac{2L^{2}}{\\pi^{2}} - \\left(-\\frac{2L^{2}}{9\\pi^{2}}\\right) \\right) = \\frac{L}{\\pi^{2}} \\left(-2 + \\frac{2}{9}\\right) = -\\frac{16L}{9\\pi^{2}}$.\nBy symmetry, $I(2,1)=I(1,2)$.\n\nNow we construct the matrix $W$:\n$$\nW_{aa} = W_{bb} = \\frac{\\lambda}{L^{2}} I(1,1) I(2,2) = \\frac{\\lambda}{L^{2}} \\left(\\frac{L}{2}\\right)\\left(\\frac{L}{2}\\right) = \\frac{\\lambda}{4}\n$$\n$$\nW_{ab} = W_{ba} = \\frac{\\lambda}{L^{2}} I(1,2) I(2,1) = \\frac{\\lambda}{L^{2}} \\left(-\\frac{16L}{9\\pi^{2}}\\right)^{2} = \\frac{\\lambda}{L^{2}} \\frac{256L^{2}}{81\\pi^{4}} = \\frac{256\\lambda}{81\\pi^{4}}\n$$\nThe secular matrix is:\n$$\nW = \\begin{pmatrix} \\frac{\\lambda}{4} & \\frac{256\\lambda}{81\\pi^{4}} \\\\ \\frac{256\\lambda}{81\\pi^{4}} & \\frac{\\lambda}{4} \\end{pmatrix}\n$$\nThe eigenvalues $E^{(1)}$ of this matrix are the first-order energy corrections. They are found by solving the characteristic equation $\\det(W - E^{(1)}I)=0$:\n$$\n\\left(\\frac{\\lambda}{4} - E^{(1)}\\right)^{2} - \\left(\\frac{256\\lambda}{81\\pi^{4}}\\right)^{2} = 0\n$$\n$$\nE^{(1)} = \\frac{\\lambda}{4} \\pm \\frac{256\\lambda}{81\\pi^{4}}\n$$\nThe two first-order energy corrections are:\n$$\nE^{(1)}_{\\pm} = \\lambda\\left(\\frac{1}{4} \\pm \\frac{256}{81\\pi^{4}}\\right)\n$$\nThe \"good\" basis states (eigenvectors of $W$) are the symmetric and antisymmetric linear combinations of the original degenerate states.\nFor $E^{(1)}_{+}$, the eigenvector is $|\\psi_{S}\\rangle = \\frac{1}{\\sqrt{2}}(|\\psi_{1,2}\\rangle + |\\psi_{2,1}\\rangle)$.\nFor $E^{(1)}_{-}$, the eigenvector is $|\\psi_{A}\\rangle = \\frac{1}{\\sqrt{2}}(|\\psi_{1,2}\\rangle - |\\psi_{2,1}\\rangle)$.\nThe energy correction for $|\\psi_{S}\\rangle$ is $E^{(1)}_{S} = \\lambda(\\frac{1}{4} + \\frac{256}{81\\pi^4})$ and for $|\\psi_{A}\\rangle$ is $E^{(1)}_{A} = \\lambda(\\frac{1}{4} - \\frac{256}{81\\pi^4})$.\nIf $\\lambda > 0$, the antisymmetric combination $|\\psi_{A}\\rangle$ has the lower energy. If $\\lambda < 0$, the symmetric combination $|\\psi_{S}\\rangle$ has the lower energy.\n\nThe first-order energy splitting $\\Delta E^{(1)}$ is the difference between these two energy corrections:\n$$\n\\Delta E^{(1)} = E^{(1)}_{S} - E^{(1)}_{A} = \\lambda\\left(\\frac{1}{4} + \\frac{256}{81\\pi^{4}}\\right) - \\lambda\\left(\\frac{1}{4} - \\frac{256}{81\\pi^{4}}\\right)\n$$\n$$\n\\Delta E^{(1)} = 2\\lambda\\frac{256}{81\\pi^{4}} = \\frac{512\\lambda}{81\\pi^{4}}\n$$\nThis is the required splitting.", "answer": "$$ \\boxed{\\frac{512\\lambda}{81\\pi^{4}}} $$", "id": "2767570"}, {"introduction": "We now move from a simple model to a cornerstone physical phenomenon: the linear Stark effect in the hydrogen atom. This problem demonstrates how an external electric field lifts the famous $n=2$ degeneracy between the $2s$ and $2p$ orbitals. Here, the power of symmetry and angular momentum selection rules becomes apparent, allowing you to predict which interactions are non-zero and radically simplify the perturbation matrix before any integrals are even calculated. [@problem_id:2767589]", "problem": "A hydrogen-like one-electron ion with nuclear charge $Z$ is described by the field-free Hamiltonian $\\hat{H}_{0}$, whose eigenstates are the normalized hydrogenic orbitals $\\{|n \\ell m\\rangle\\}$ with eigenenergies $E_{n}^{(0)}$ that depend only on the principal quantum number $n$. Consider the degenerate $n=2$ manifold, which consists of the four states $\\{|200\\rangle, |210\\rangle, |211\\rangle, |21{-}1\\rangle\\}$ corresponding to the $(2s, 2p_{m=0}, 2p_{m=+1}, 2p_{m=-1})$ orbitals. A weak, uniform, static electric field of magnitude $\\mathcal{E}$ is applied along the $z$ axis. In the length gauge, the perturbation is $\\hat{W} = e\\,\\mathcal{E}\\, z$, where $e$ is the elementary charge and $z$ is the position operator along the field direction. Assume nonrelativistic motion and neglect spin, fine structure, and hyperfine effects. Work within time-independent degenerate perturbation theory.\n\nStarting from the definitions of the hydrogenic wavefunctions and basic angular momentum theory:\n- Justify which matrix elements of $z$ are symmetry-allowed within the $n=2$ manifold by using angular momentum selection rules that follow from the tensorial character of $z \\propto r \\cos\\theta$.\n- Compute the nonzero dipole matrix element between $|200\\rangle$ and $|210\\rangle$ from first principles by separating radial and angular parts. You may use the normalized hydrogenic radial functions for $n=2$,\n$$\nR_{20}(r) \\;=\\; \\left(\\frac{Z}{a_{0}}\\right)^{3/2}\\,\\frac{1}{2\\sqrt{2}}\\,\\exp\\!\\left(-\\frac{Z r}{2 a_{0}}\\right)\\left(2 - \\frac{Z r}{a_{0}}\\right),\\qquad\nR_{21}(r) \\;=\\; \\left(\\frac{Z}{a_{0}}\\right)^{3/2}\\,\\frac{1}{2\\sqrt{6}}\\,\\exp\\!\\left(-\\frac{Z r}{2 a_{0}}\\right)\\left(\\frac{Z r}{a_{0}}\\right),\n$$\nand the standard spherical harmonics $Y_{\\ell m}(\\theta,\\phi)$, together with $z = r \\cos\\theta$.\n- Assemble and diagonalize the perturbation matrix $\\mathbf{W}$ in the ordered basis $\\{|200\\rangle, |210\\rangle, |211\\rangle, |21{-}1\\rangle\\}$ to obtain the first-order Stark energy corrections within this manifold.\n\nAnswer specification:\n- Provide the four first-order energy shifts as a single row matrix in ascending order of energy shift.\n- Express the final energy shifts in joules, as an analytic expression in terms of $e$, $a_{0}$, $\\mathcal{E}$, and $Z$. Do not insert numerical values for constants.\n- No rounding is required. The final answer must be a single row matrix.", "solution": "The problem posed is a standard application of degenerate time-independent perturbation theory to calculate the linear Stark effect for the $n=2$ level of a hydrogen-like atom. The problem is well-posed and scientifically sound, so we proceed directly to the solution.\n\nThe unperturbed Hamiltonian is $\\hat{H}_{0}$, and its eigenstates for the principal quantum number $n=2$ form a four-fold degenerate manifold. The basis states are given as $\\{|200\\rangle, |210\\rangle, |211\\rangle, |21{-}1\\rangle\\}$. All these states share the same unperturbed energy, $E_{2}^{(0)}$. The perturbation is due to a uniform electric field $\\vec{\\mathcal{E}} = \\mathcal{E} \\hat{k}$ applied along the $z$-axis, so the perturbation Hamiltonian is $\\hat{W} = e\\,\\mathcal{E}\\,z$.\n\nAccording to degenerate perturbation theory, the first-order energy corrections, $E^{(1)}$, are the eigenvalues of the perturbation matrix $\\mathbf{W}$ constructed in the basis of the degenerate states. The elements of this $4 \\times 4$ matrix are given by $W_{ij} = \\langle \\psi_i | \\hat{W} | \\psi_j \\rangle$, where $|\\psi_i\\rangle, |\\psi_j\\rangle$ belong to the degenerate manifold $\\{|2 \\ell m\\rangle\\}$.\n\nFirst, we determine the structure of the matrix $\\mathbf{W}$ by applying selection rules. The operator $z$ is proportional to $r \\cos\\theta$. The function $\\cos\\theta$ is proportional to the spherical harmonic $Y_{10}(\\theta, \\phi)$. Specifically, $z = r\\sqrt{\\frac{4\\pi}{3}} Y_{10}(\\theta, \\phi)$. This shows that the operator $z$ is a component of a rank-$1$ irreducible tensor operator, with projection index $q=0$. The Wigner-Eckart theorem dictates the selection rules for its matrix elements $\\langle n' \\ell' m' | z | n \\ell m \\rangle$:\n$1$. The projection quantum number must satisfy $m' = m+q$, which for $z$ means $\\Delta m = m' - m = 0$.\n$2$. The angular momentum quantum numbers must satisfy triangular inequality $|\\ell - 1| \\le \\ell' \\le \\ell + 1$. This implies $\\Delta \\ell = \\ell' - \\ell = \\pm 1$.\n$3$. Parity must be conserved overall. The parity of a state $|n \\ell m\\rangle$ is $(-1)^{\\ell}$. The operator $z$ has odd parity $(-1)^1$. For the matrix element to be non-zero, the parity of the integrand $\\psi_{\\ell' m'}^* z \\psi_{\\ell m}$ must be even. The total parity is $(-1)^{\\ell'} (-1)^1 (-1)^{\\ell} = (-1)^{\\ell'+\\ell+1}$. This must be $+1$, which requires $\\ell'+\\ell$ to be odd. This ensures that $\\ell$ and $\\ell'$ have different parity, which is consistent with $\\Delta \\ell = \\pm 1$. It also strictly forbids matrix elements where $\\Delta \\ell = 0$, meaning all diagonal matrix elements $\\langle n \\ell m | z | n \\ell m \\rangle$ are zero.\n\nWe apply these rules to the $n=2$ basis $\\{|200\\rangle, |210\\rangle, |211\\rangle, |21{-}1\\rangle\\}$:\n- The diagonal elements $W_{ii} = \\langle 2 \\ell m | e\\mathcal{E}z | 2 \\ell m \\rangle$ are all zero due to the parity rule ($\\Delta \\ell = 0$).\n- The rule $\\Delta m = 0$ implies that $\\hat{W}$ only connects states with the same $m$ value. Thus, the matrix $\\mathbf{W}$ is block-diagonal. The states $|211\\rangle$ (with $m=+1$) and $|21{-}1\\rangle$ (with $m=-1$) do not mix with any other states or with each other. Their first-order energy shifts are simply the diagonal elements $W_{33}$ and $W_{44}$, which are zero. Hence, two of the energy shifts are $E^{(1)}=0$.\n- The states $|200\\rangle$ and $|210\\rangle$ both have $m=0$. They can mix. The only non-zero matrix elements are the off-diagonal ones connecting these two states: $W_{12} = \\langle 200 | e\\mathcal{E}z | 210 \\rangle$ and $W_{21} = \\langle 210 | e\\mathcal{E}z | 200 \\rangle$. The selection rules $\\Delta \\ell = \\pm 1$ and $\\Delta m=0$ are satisfied for this pair.\nThe perturbation matrix in the ordered basis $\\{|200\\rangle, |210\\rangle, |211\\rangle, |21{-}1\\rangle\\}$ is therefore:\n$$ \\mathbf{W} = \\begin{pmatrix} 0 & W_{12} & 0 & 0 \\\\ W_{21} & 0 & 0 & 0 \\\\ 0 & 0 & 0 & 0 \\\\ 0 & 0 & 0 & 0 \\end{pmatrix} $$\nSince $\\hat{W}$ is a Hermitian operator, $W_{21} = W_{12}^*$. As the wavefunctions and the operator $z$ can be chosen to be real, $W_{12}$ will be real, so $W_{21}=W_{12}$.\n\nNext, we compute the non-zero matrix element $W_{12} = e\\mathcal{E}\\langle 200 | z | 210 \\rangle$. The integral is given by:\n$$ \\langle 200 | z | 210 \\rangle = \\int_0^\\infty r^2 dr \\int_0^\\pi \\sin\\theta d\\theta \\int_0^{2\\pi} d\\phi \\, \\psi_{200}^*(r,\\theta,\\phi) \\, (r \\cos\\theta) \\, \\psi_{210}(r,\\theta,\\phi) $$\nWe separate this into radial and angular parts. The wavefunctions are $\\psi_{n\\ell m}(r,\\theta,\\phi) = R_{n\\ell}(r)Y_{\\ell m}(\\theta,\\phi)$.\n$$ \\langle 200 | z | 210 \\rangle = \\left( \\int_0^\\infty r^3 R_{20}(r) R_{21}(r) \\, dr \\right) \\left( \\int_0^{2\\pi} d\\phi \\int_0^\\pi \\sin\\theta d\\theta \\, Y_{00}^*(\\theta,\\phi) \\cos\\theta Y_{10}(\\theta,\\phi) \\right) $$\nThe angular integral is computed using the spherical harmonics $Y_{00} = \\frac{1}{\\sqrt{4\\pi}}$ and $Y_{10} = \\sqrt{\\frac{3}{4\\pi}}\\cos\\theta$.\n$$ \\text{Angular Part} = \\int d\\Omega \\, \\left(\\frac{1}{\\sqrt{4\\pi}}\\right) \\left(\\sqrt{\\frac{4\\pi}{3}}Y_{10}\\right) Y_{10} = \\frac{1}{\\sqrt{3}} \\int |Y_{10}(\\theta,\\phi)|^2 d\\Omega = \\frac{1}{\\sqrt{3}} $$\nThe radial integral is calculated using the provided functions:\n$$ I_r = \\int_0^\\infty r^3 R_{20}(r) R_{21}(r) \\, dr $$\n$$ R_{20}(r) R_{21}(r) = \\left(\\frac{Z}{a_{0}}\\right)^3 \\frac{1}{2\\sqrt{2}} \\frac{1}{2\\sqrt{6}} \\left(2 - \\frac{Z r}{a_{0}}\\right) \\left(\\frac{Z r}{a_{0}}\\right) \\exp\\!\\left(-\\frac{Z r}{a_{0}}\\right) $$\nThe prefactor is $\\left(\\frac{Z}{a_{0}}\\right)^3 \\frac{1}{8\\sqrt{3}}$. Let $\\rho = \\frac{Zr}{a_0}$, so $r=\\frac{a_0}{Z}\\rho$ and $dr=\\frac{a_0}{Z}d\\rho$.\n$$ I_r = \\left(\\frac{Z}{a_{0}}\\right)^3 \\frac{1}{8\\sqrt{3}} \\int_0^\\infty \\left(\\frac{a_0}{Z}\\rho\\right)^3 (2 - \\rho)\\rho \\, \\exp(-\\rho) \\, \\left(\\frac{a_0}{Z}d\\rho\\right) $$\n$$ I_r = \\left(\\frac{Z}{a_{0}}\\right)^3 \\frac{1}{8\\sqrt{3}} \\left(\\frac{a_0}{Z}\\right)^4 \\int_0^\\infty (\\rho^4(2-\\rho)) \\, \\exp(-\\rho) \\, d\\rho $$\n$$ I_r = \\frac{a_0}{Z} \\frac{1}{8\\sqrt{3}} \\left( 2\\int_0^\\infty \\rho^4 e^{-\\rho} d\\rho - \\int_0^\\infty \\rho^5 e^{-\\rho} d\\rho \\right) $$\nUsing the standard integral $\\int_0^\\infty x^n e^{-x} dx = n!$, we get:\n$$ I_r = \\frac{a_0}{Z} \\frac{1}{8\\sqrt{3}} \\left( 2(4!) - 5! \\right) = \\frac{a_0}{Z} \\frac{1}{8\\sqrt{3}} (2 \\times 24 - 120) = \\frac{a_0}{Z} \\frac{48 - 120}{8\\sqrt{3}} = \\frac{a_0}{Z} \\frac{-72}{8\\sqrt{3}} = -\\frac{9a_0}{Z\\sqrt{3}} $$\nSimplifying this expression yields $I_r = -\\frac{3\\sqrt{3}a_0}{Z}$.\nNow we combine the radial and angular parts:\n$$ \\langle 200 | z | 210 \\rangle = I_r \\times (\\text{Angular Part}) = \\left(-\\frac{3\\sqrt{3}a_0}{Z}\\right) \\left(\\frac{1}{\\sqrt{3}}\\right) = -\\frac{3a_0}{Z} $$\nSo, $W_{12} = W_{21} = -e\\mathcal{E}\\frac{3a_0}{Z}$.\n\nFinally, we find the eigenvalues of $\\mathbf{W}$. The non-trivial part is the upper-left $2 \\times 2$ block for the $m=0$ subspace:\n$$ \\mathbf{W}_{m=0} = \\begin{pmatrix} 0 & -3ea_0\\mathcal{E}/Z \\\\ -3ea_0\\mathcal{E}/Z & 0 \\end{pmatrix} $$\nThe eigenvalues $E^{(1)}$ are found from the characteristic equation $\\det(\\mathbf{W}_{m=0} - E^{(1)}I) = 0$:\n$$ \\begin{vmatrix} -E^{(1)} & -3ea_0\\mathcal{E}/Z \\\\ -3ea_0\\mathcal{E}/Z & -E^{(1)} \\end{vmatrix} = 0 $$\n$$ (E^{(1)})^2 - \\left(-\\frac{3ea_0\\mathcal{E}}{Z}\\right)^2 = 0 \\implies (E^{(1)})^2 = \\left(\\frac{3ea_0\\mathcal{E}}{Z}\\right)^2 $$\nThis gives two eigenvalues $E^{(1)} = \\pm \\frac{3ea_0\\mathcal{E}}{Z}$.\n\nThe four first-order energy corrections for the $n=2$ manifold are the two eigenvalues from this submatrix and the two zero eigenvalues for the $|211\\rangle$ and $|21{-}1\\rangle$ states. In ascending order, the energy shifts are:\n$$ -\\frac{3ea_0\\mathcal{E}}{Z}, \\quad 0, \\quad 0, \\quad \\frac{3ea_0\\mathcal{E}}{Z} $$\nThese are the first-order Stark energy corrections, expressed in terms of the fundamental constants and parameters as required. The units are Joules, as $e\\mathcal{E}$ has units of force and $a_0$ has units of length, giving an energy.", "answer": "$$ \\boxed{ \\begin{pmatrix} -\\frac{3 e a_{0} \\mathcal{E}}{Z} & 0 & 0 & \\frac{3 e a_{0} \\mathcal{E}}{Z} \\end{pmatrix} } $$", "id": "2767589"}, {"introduction": "While analytical solutions are invaluable for building intuition, modern theoretical chemistry relies on computational algorithms to handle complex, many-electron systems. This practice bridges the gap between pen-and-paper theory and its implementation in a quantum chemistry program. You will translate the principles of degenerate perturbation theory into a sequence of linear algebra operations, a crucial skill for applying these concepts to realistic molecular problems. [@problem_id:2767462]", "problem": "Consider a non-relativistic molecular system described by an unperturbed Hamiltonian with a $g$-fold degenerate eigenvalue at energy $E_0$. Let the corresponding degenerate manifold be spanned by orthonormal states $\\{ \\lvert \\phi_a \\rangle \\}_{a=1}^g$ expressed in an orthonormal Atomic Orbital (AO) basis $\\{ \\lvert \\chi_\\mu \\rangle \\}_{\\mu=1}^n$. The perturbation is represented by a one-electron operator $\\hat{V}$ with AO-representation given as a real symmetric matrix $V_{\\text{AO}} \\in \\mathbb{R}^{n \\times n}$ (in atomic units, hartree). Each degenerate state has AO coefficients collected as columns in $C \\in \\mathbb{R}^{n \\times g}$, with the orthonormality condition $C^\\top C = I_g$ and the AO basis assumed orthonormal. The goal is to implement the degenerate time-independent first-order perturbation theory procedure in a computationally robust way for large degenerate manifolds.\n\nStarting from the definitions of matrix elements and projection operators in Hilbert space, and without invoking any pre-assembled \"shortcut\" expressions, your task is to:\n- Construct the restriction of $\\hat{V}$ to the degenerate subspace by assembling the effective perturbation matrix $W$ in the $\\{ \\lvert \\phi_a \\rangle \\}$ basis using only the fundamental definition $W_{ab} = \\langle \\phi_a \\lvert \\hat{V} \\rvert \\phi_b \\rangle$ and the linear expansion of $\\lvert \\phi_a \\rangle$ in the AO basis.\n- Diagonalize $W$ to obtain first-order energy corrections (eigenvalues) and the unitary transformation within the degenerate manifold (eigenvectors).\n- Construct the transformed degenerate-state AO coefficients $\\widetilde{C}$ corresponding to the new optimal zeroth-order states that diagonalize the perturbation within the degenerate subspace.\n- Verify numerically that the transformed coefficients remain orthonormal in the AO metric (which is the identity in this problem), and quantify the maximum absolute deviation from the identity.\n\nYour program must implement the above pipeline for the following test suite. In each case, the AO basis is orthonormal, all matrices are real, and energies are in hartree.\n\nTest suite:\n- Case $1$ (general two-dimensional manifold):\n  - $n = 4$, $g = 2$.\n  - AO perturbation matrix\n    $$\n    V_{\\text{AO}}^{(1)} =\n    \\begin{bmatrix}\n    2 & 0 & 1 & 0 \\\\\n    0 & 4 & 0 & 1 \\\\\n    1 & 0 & 3 & 0 \\\\\n    0 & 1 & 0 & 5\n    \\end{bmatrix}.\n    $$\n  - Degenerate-manifold AO coefficient columns\n    $$\n    C^{(1)} =\n    \\begin{bmatrix}\n    \\frac{1}{\\sqrt{2}} & 0 \\\\\n    \\frac{1}{\\sqrt{2}} & 0 \\\\\n    0 & \\frac{1}{\\sqrt{2}} \\\\\n    0 & \\frac{1}{\\sqrt{2}}\n    \\end{bmatrix}.\n    $$\n- Case $2$ (boundary, effectively non-degenerate within the AO block):\n  - $n = 4$, $g = 1$.\n  - AO perturbation matrix\n    $$\n    V_{\\text{AO}}^{(2)} =\n    \\begin{bmatrix}\n    1 & 0 & 0 & 0 \\\\\n    0 & 3 & 0 & 0 \\\\\n    0 & 0 & 5 & 0 \\\\\n    0 & 0 & 0 & 7\n    \\end{bmatrix}.\n    $$\n  - Degenerate-manifold AO coefficient column\n    $$\n    C^{(2)} =\n    \\begin{bmatrix}\n    \\frac{1}{\\sqrt{2}} \\\\\n    \\frac{1}{\\sqrt{2}} \\\\\n    0 \\\\\n    0\n    \\end{bmatrix}.\n    $$\n- Case $3$ (three-dimensional manifold with inter-block couplings):\n  - $n = 5$, $g = 3$.\n  - AO perturbation matrix\n    $$\n    V_{\\text{AO}}^{(3)} =\n    \\begin{bmatrix}\n    6 & 2 & 1 & 0 & 1 \\\\\n    2 & 6 & 0 & 1 & 0 \\\\\n    1 & 0 & 8 & -1 & 0 \\\\\n    0 & 1 & -1 & 10 & 2 \\\\\n    1 & 0 & 0 & 2 & 12\n    \\end{bmatrix}.\n    $$\n  - Degenerate-manifold AO coefficient columns\n    $$\n    C^{(3)} =\n    \\begin{bmatrix}\n    \\frac{1}{\\sqrt{2}} & 0 & 0 \\\\\n    \\frac{1}{\\sqrt{2}} & 0 & 0 \\\\\n    0 & \\frac{1}{\\sqrt{2}} & 0 \\\\\n    0 & \\frac{1}{\\sqrt{2}} & 0 \\\\\n    0 & 0 & 1\n    \\end{bmatrix}.\n    $$\n\nImplementation and output requirements:\n- For each case, assemble $W$, diagonalize it to obtain the first-order energy corrections (the eigenvalues), construct $\\widetilde{C}$, and compute the maximum absolute deviation from orthonormality defined as\n  $$\n  \\delta = \\max_{i,j} \\left| \\left( \\widetilde{C}^\\top \\widetilde{C} \\right)_{ij} - \\left( I_g \\right)_{ij} \\right|.\n  $$\n- Report, for each case in the order given, a list containing the sorted eigenvalues of $W$ in ascending order (in hartree), followed by the value of $\\delta$. Round all reported numbers to $6$ decimal places.\n- Your program should produce a single line of output containing the results for all cases as a comma-separated list of these per-case lists, enclosed in square brackets. For example, a valid output structure is\n  $$\n  \\big[ [\\cdots], [\\cdots], [\\cdots] \\big],\n  $$\n  with all numbers rounded to $6$ decimal places. There should be no additional text printed.\n\nNote: All reported energies must be expressed in hartree, rounded to $6$ decimal places. Angles do not appear in this problem. Percentages do not appear in this problem. The design must be universally implementable in any modern language using standard linear algebra primitives and must not rely on external inputs beyond the matrices specified above.", "solution": "The problem presented is a standard and well-posed exercise in quantum mechanical\ndegenerate time-independent perturbation theory, specifically focusing on its matrix\nrepresentation in a finite atomic orbital basis. All provided information is complete,\nconsistent, and scientifically sound. No logical or physical flaws are present.\nTherefore, a rigorous solution can be constructed.\n\nThe problem requires the calculation of first-order energy corrections and the corresponding\nzeroth-order wavefunctions for a system with a $g$-fold degenerate energy level $E_0$.\nThe unperturbed states spanning this degenerate manifold are denoted $\\{ \\lvert \\phi_a \\rangle \\}_{a=1}^g$.\nThese states are expressed as linear combinations of an underlying orthonormal atomic\norbital (AO) basis $\\{ \\lvert \\chi_\\mu \\rangle \\}_{\\mu=1}^n$. The expansion is given by:\n$$\n\\lvert \\phi_a \\rangle = \\sum_{\\mu=1}^n \\lvert \\chi_\\mu \\rangle C_{\\mu a}\n$$\nwhere $C$ is an $n \\times g$ matrix of coefficients. The states $\\{ \\lvert \\phi_a \\rangle \\}$\nare orthonormal, which implies $\\langle \\phi_a \\lvert \\phi_b \\rangle = \\delta_{ab}$.\nIn the orthonormal AO basis, this condition translates to the matrix equation $C^\\top C = I_g$, where\n$I_g$ is the $g \\times g$ identity matrix.\n\nAccording to degenerate perturbation theory, the first-order corrections to the energy are the\neigenvalues of the perturbation operator $\\hat{V}$ projected onto the degenerate subspace.\nWe must construct the matrix representation of this projected operator, which we denote as $W$.\nThe elements of this $g \\times g$ matrix are given by the fundamental definition:\n$$\nW_{ab} = \\langle \\phi_a \\lvert \\hat{V} \\rvert \\phi_b \\rangle\n$$\nTo evaluate this expression, we substitute the AO expansion for $\\lvert \\phi_a \\rangle$ and $\\lvert \\phi_b \\rangle$:\n$$\nW_{ab} = \\left\\langle \\sum_{\\mu=1}^n \\chi_\\mu C_{\\mu a} \\right\\lvert \\hat{V} \\left\\lvert \\sum_{\\nu=1}^n \\chi_\\nu C_{\\nu b} \\right\\rangle\n$$\nDue to the linearity of the inner product and the operator, and given that the coefficients $C_{\\mu a}$ are real, we can write:\n$$\nW_{ab} = \\sum_{\\mu=1}^n \\sum_{\\nu=1}^n C_{\\mu a} C_{\\nu b} \\langle \\chi_\\mu \\lvert \\hat{V} \\rvert \\chi_\\nu \\rangle\n$$\nThe term $\\langle \\chi_\\mu \\lvert \\hat{V} \\rvert \\chi_\\nu \\rangle$ is precisely the matrix element $(V_{\\text{AO}})_{\\mu\\nu}$\nof the perturbation operator in the AO basis. Substituting this gives:\n$$\nW_{ab} = \\sum_{\\mu=1}^n \\sum_{\\nu=1}^n C_{\\mu a} (V_{\\text{AO}})_{\\mu\\nu} C_{\\nu b}\n$$\nThis expression is the component-wise form of a matrix product. Recognizing that $C_{\\mu a} = (C^\\top)_{a\\mu}$, we have:\n$$\nW_{ab} = \\sum_{\\mu=1}^n (C^\\top)_{a\\mu} \\left( \\sum_{\\nu=1}^n (V_{\\text{AO}})_{\\mu\\nu} C_{\\nu b} \\right)\n$$\nThe term in the parenthesis is the $(\\mu, b)$-th element of the matrix product $V_{\\text{AO}}C$.\nTherefore, the entire expression is the $(a, b)$-th element of the product $C^\\top (V_{\\text{AO}}C)$.\nWe arrive at the compact matrix formula for the effective perturbation matrix:\n$$\nW = C^\\top V_{\\text{AO}} C\n$$\nSince $V_{\\text{AO}}$ is a real symmetric matrix, $W$ is also real and symmetric. The first-order\nenergy corrections, $\\{ E_k^{(1)} \\}_{k=1}^g$, are the eigenvalues of $W$. We find these\nby solving the eigenvalue problem for $W$:\n$$\nW U = U \\Lambda\n$$\nHere, $\\Lambda$ is the diagonal matrix of eigenvalues, $\\Lambda_{kk} = E_k^{(1)}$, and $U$ is an\northogonal matrix ($U^\\top U = I_g$) whose columns are the corresponding eigenvectors of $W$.\n\nThe original degenerate states $\\{ \\lvert \\phi_a \\rangle \\}$ are not, in general, the correct\nzeroth-order states that diagonalize the perturbation. The correct states, which we shall denote\n$\\{ \\lvert \\psi_k \\rangle \\}_{k=1}^g$, are linear combinations of the original states, where the\ntransformation is given by the eigenvector matrix $U$:\n$$\n\\lvert \\psi_k \\rangle = \\sum_{a=1}^g \\lvert \\phi_a \\rangle U_{ak}\n$$\nThis transformation ensures that $\\langle \\psi_k \\lvert \\hat{V} \\rvert \\psi_j \\rangle = E_k^{(1)} \\delta_{kj}$.\nTo find the AO coefficients of these new states, we construct the matrix $\\widetilde{C}$ whose\ncolumns hold the coefficients for each $\\lvert \\psi_k \\rangle$. We substitute the AO expansion of\n$\\lvert \\phi_a \\rangle$ into the expression for $\\lvert \\psi_k \\rangle$:\n$$\n\\lvert \\psi_k \\rangle = \\sum_{a=1}^g \\left( \\sum_{\\mu=1}^n \\lvert \\chi_\\mu \\rangle C_{\\mu a} \\right) U_{ak} = \\sum_{\\mu=1}^n \\lvert \\chi_\\mu \\rangle \\left( \\sum_{a=1}^g C_{\\mu a} U_{ak} \\right)\n$$\nThe term in the parenthesis is the $(\\mu, k)$-th element of the new coefficient matrix $\\widetilde{C}$.\nThis corresponds to the matrix product:\n$$\n\\widetilde{C} = C U\n$$\nFinally, we must verify that the new states $\\{ \\lvert \\psi_k \\rangle \\}$ are orthonormal.\nTheir inner product is $\\langle \\psi_k \\lvert \\psi_j \\rangle = \\delta_{kj}$. In the AO basis,\nthis is represented by the matrix $\\widetilde{C}^\\top \\widetilde{C}$. We can verify this theoretically:\n$$\n\\widetilde{C}^\\top \\widetilde{C} = (C U)^\\top (C U) = U^\\top C^\\top C U\n$$\nUsing the initial conditions $C^\\top C = I_g$ and the property that $U$ is an orthogonal matrix\n($U^\\top U = I_g$), we have:\n$$\n\\widetilde{C}^\\top \\widetilde{C} = U^\\top I_g U = U^\\top U = I_g\n$$\nThe numerical validation involves computing $\\widetilde{C}^\\top \\widetilde{C}$ and\nmeasuring its maximum deviation from the identity matrix $I_g$. The deviation $\\delta$ is defined as:\n$$\n\\delta = \\max_{i,j} \\left| \\left( \\widetilde{C}^\\top \\widetilde{C} \\right)_{ij} - \\left( I_g \\right)_{ij} \\right|\n$$\nThis value should be close to zero, limited only by machine floating-point precision.\n\nThe computational procedure is as follows:\n1.  For each test case, take the given matrices $V_{\\text{AO}}$ and $C$.\n2.  Compute the effective perturbation matrix $W = C^\\top V_{\\text{AO}} C$.\n3.  Solve the eigensystem for the symmetric matrix $W$ to find the eigenvalues (first-order energy corrections, $E_k^{(1)}$) and the eigenvector matrix $U$.\n4.  Sort the eigenvalues in ascending order.\n5.  Construct the new AO coefficient matrix $\\widetilde{C} = C U$.\n6.  Calculate the orthonormality check matrix $\\widetilde{C}^\\top \\widetilde{C}$.\n7.  Compute the maximum absolute deviation $\\delta$ from the identity matrix $I_g$.\n8.  Report the sorted eigenvalues and $\\delta$, rounded to the specified precision.\n\nThis procedure constitutes a complete and robust implementation of degenerate perturbation\ntheory in a matrix representation, adhering strictly to fundamental principles.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the degenerate perturbation theory problem for a given test suite.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"C\": np.array([\n                [1/np.sqrt(2), 0],\n                [1/np.sqrt(2), 0],\n                [0, 1/np.sqrt(2)],\n                [0, 1/np.sqrt(2)]\n            ]),\n            \"V_AO\": np.array([\n                [2, 0, 1, 0],\n                [0, 4, 0, 1],\n                [1, 0, 3, 0],\n                [0, 1, 0, 5]\n            ])\n        },\n        {\n            \"C\": np.array([\n                [1/np.sqrt(2)],\n                [1/np.sqrt(2)],\n                [0],\n                [0]\n            ]),\n            \"V_AO\": np.array([\n                [1, 0, 0, 0],\n                [0, 3, 0, 0],\n                [0, 0, 5, 0],\n                [0, 0, 0, 7]\n            ])\n        },\n        {\n            \"C\": np.array([\n                [1/np.sqrt(2), 0, 0],\n                [1/np.sqrt(2), 0, 0],\n                [0, 1/np.sqrt(2), 0],\n                [0, 1/np.sqrt(2), 0],\n                [0, 0, 1]\n            ]),\n            \"V_AO\": np.array([\n                [6, 2, 1, 0, 1],\n                [2, 6, 0, 1, 0],\n                [1, 0, 8, -1, 0],\n                [0, 1, -1, 10, 2],\n                [1, 0, 0, 2, 12]\n            ])\n        }\n    ]\n\n    all_results = []\n\n    for case in test_cases:\n        C = case[\"C\"]\n        V_AO = case[\"V_AO\"]\n        \n        # Get dimensions\n        n, g = C.shape\n\n        # Step 1: Construct the effective perturbation matrix W in the degenerate subspace.\n        # W = C^T * V_AO * C\n        W = C.T @ V_AO @ C\n\n        # Step 2: Diagonalize W to get first-order energy corrections and the transformation matrix U.\n        # np.linalg.eigh is used for symmetric/Hermitian matrices. It returns eigenvalues\n        # in ascending order and corresponding eigenvectors as columns.\n        energy_corrections, U = np.linalg.eigh(W)\n\n        # The energy corrections are the eigenvalues, already sorted.\n\n        # Step 3: Construct the transformed degenerate-state AO coefficients C_tilde.\n        # C_tilde = C * U\n        C_tilde = C @ U\n\n        # Step 4: Verify orthonormality of the transformed coefficients.\n        # Compute the identity matrix of size g for comparison.\n        I_g = np.identity(g)\n        \n        # Compute the Gram matrix of the new coefficients.\n        ortho_check_matrix = C_tilde.T @ C_tilde\n        \n        # Compute the maximum absolute deviation from the identity matrix.\n        delta = np.max(np.abs(ortho_check_matrix - I_g))\n        \n        # Collect results for the current case.\n        # Format all numbers to 6 decimal places.\n        case_results = [f\"{val:.6f}\" for val in energy_corrections]\n        case_results.append(f\"{delta:.6f}\")\n        \n        all_results.append(f\"[{','.join(case_results)}]\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(all_results)}]\")\n\nsolve()\n```", "id": "2767462"}]}