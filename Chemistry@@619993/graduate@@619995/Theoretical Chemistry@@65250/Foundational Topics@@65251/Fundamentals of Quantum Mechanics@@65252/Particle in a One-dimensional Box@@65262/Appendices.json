{"hands_on_practices": [{"introduction": "The variational principle is a cornerstone of quantum mechanics, providing a robust method for approximating the ground-state energy of a system even when the Schrödinger equation cannot be solved exactly. This exercise [@problem_id:2792826] challenges you to apply this principle using a flexible trial wavefunction for the familiar particle-in-a-box system. By deriving and minimizing the variational energy functional, you will practice a fundamental technique used throughout quantum chemistry to tackle complex atoms and molecules.", "problem": "A single particle of mass $m$ is confined to a one-dimensional infinite potential well (particle in a box) on the interval $x \\in [0,L]$, with potential $V(x)=0$ for $0<x<L$ and $V(x)=+\\infty$ otherwise. The corresponding Hamiltonian inside the box is $H=-\\frac{\\hbar^{2}}{2m}\\frac{d^{2}}{dx^{2}}$, and admissible wavefunctions must satisfy Dirichlet boundary conditions $\\psi(0)=\\psi(L)=0$.\n\nUsing the Rayleigh–Ritz variational principle, consider the one-parameter trial family\n$$\n\\psi_{\\beta}(x)=x\\,(L-x)\\,\\exp(-\\beta x),\n$$\nwith real parameter $\\beta$ and $0 \\le x \\le L$. Starting only from the time-independent Schrödinger equation and the variational principle (no other formulas may be assumed), perform the following:\n\n- Derive the variational energy functional $E(\\beta)=\\dfrac{\\langle \\psi_{\\beta}|H|\\psi_{\\beta}\\rangle}{\\langle \\psi_{\\beta}|\\psi_{\\beta}\\rangle}$ in a form that depends only on integrals of elementary functions on $[0,L]$, and justify all steps from first principles.\n- Introduce dimensionless variables to isolate the dependence on $L$ and $\\beta$ into a single dimensionless parameter. Use this to argue which value of $\\beta$ extremizes $E(\\beta)$.\n- Determine whether this extremum is a minimum by analyzing the behavior of $E(\\beta)$ in the vicinity of that point from first principles (e.g., a symmetry argument supplemented by a systematic small-parameter expansion of the relevant integrals up to order $t^{2}$, where $t$ is an appropriate dimensionless form of $\\beta$).\n- Evaluate the corresponding optimized variational upper bound to the ground-state energy in closed form.\n\nExpress your final answer as an exact analytical expression in terms of $\\hbar$, $m$, and $L$. No numerical substitution is required. If one were to evaluate numerically, the energy should be expressed in Joules. Do not provide any intermediate results; report only the optimized variational upper bound to the ground-state energy as your final answer. No rounding is required.", "solution": "The system is a particle in a one-dimensional infinite well on $x \\in [0,L]$ with $V(x)=0$ inside the interval and $V(x)=+\\infty$ outside, so admissible wavefunctions must satisfy $\\psi(0)=\\psi(L)=0$. The Hamiltonian inside the well is $H=-\\frac{\\hbar^{2}}{2m}\\frac{d^{2}}{dx^{2}}$. The Rayleigh–Ritz variational principle states that for any normalized admissible $\\psi$, the expectation value $E[\\psi]=\\dfrac{\\langle \\psi|H|\\psi\\rangle}{\\langle \\psi|\\psi\\rangle}$ satisfies $E[\\psi]\\ge E_{0}$, where $E_{0}$ is the exact ground-state energy.\n\nFor the real trial function $\\psi_{\\beta}(x)=x(L-x)\\exp(-\\beta x)$, the energy functional is\n$$\nE(\\beta)=\\frac{\\displaystyle \\int_{0}^{L}\\psi_{\\beta}(x)\\left(-\\frac{\\hbar^{2}}{2m}\\frac{d^{2}}{dx^{2}}\\right)\\psi_{\\beta}(x)\\,dx}{\\displaystyle \\int_{0}^{L} \\psi_{\\beta}(x)^{2}\\,dx}.\n$$\nAn integration by parts using $\\psi_{\\beta}(0)=\\psi_{\\beta}(L)=0$ yields\n$$\n\\int_{0}^{L}\\psi_{\\beta}(x)\\left(-\\frac{d^{2}}{dx^{2}}\\psi_{\\beta}(x)\\right)\\,dx=\\int_{0}^{L}\\left(\\frac{d\\psi_{\\beta}}{dx}\\right)^{2}\\,dx,\n$$\nbecause the boundary term $-\\psi_{\\beta}\\,\\psi_{\\beta}'\\big|_{0}^{L}$ vanishes. Therefore,\n$$\nE(\\beta)=\\frac{\\hbar^{2}}{2m}\\,\\frac{\\displaystyle \\int_{0}^{L}\\left(\\frac{d\\psi_{\\beta}}{dx}\\right)^{2} dx}{\\displaystyle \\int_{0}^{L}\\psi_{\\beta}(x)^{2}\\,dx}.\n$$\nThis reduces the problem to computing integrals of elementary functions.\n\nTo expose the scaling and reduce parameters, define the dimensionless coordinate $y=x/L$ (so $y\\in[0,1]$), the dimensionless parameter $t=\\beta L$, and write $x=L y$. Then\n$$\n\\psi_{\\beta}(x)=L^{2}\\,y(1-y)\\,\\exp(-t y),\n$$\nand\n$$\n\\frac{d\\psi_{\\beta}}{dx}=\\frac{1}{L}\\frac{d}{dy}\\left(L^{2}y(1-y)\\exp(-t y)\\right)=L\\,\\frac{d}{dy}\\left(y(1-y)\\exp(-t y)\\right).\n$$\nHence,\n$$\n\\int_{0}^{L}\\psi_{\\beta}(x)^{2}\\,dx=L^{5}\\int_{0}^{1} y^{2}(1-y)^{2}\\,\\exp(-2 t y)\\,dy\\equiv L^{5}\\,I_{0}(t),\n$$\nand\n$$\n\\int_{0}^{L}\\left(\\frac{d\\psi_{\\beta}}{dx}\\right)^{2}\\,dx=L^{3}\\int_{0}^{1}\\left[\\frac{d}{dy}\\left(y(1-y)\\exp(-t y)\\right)\\right]^{2}dy\\equiv L^{3}\\,I_{1}(t).\n$$\nTherefore the variational energy can be written as\n$$\nE(\\beta)=\\frac{\\hbar^{2}}{2m}\\,\\frac{L^{3} I_{1}(t)}{L^{5} I_{0}(t)}=\\frac{\\hbar^{2}}{2m L^{2}}\\;\\frac{I_{1}(t)}{I_{0}(t)}\\equiv \\frac{\\hbar^{2}}{2m L^{2}}\\,F(t),\n$$\nwith\n$$\nI_{0}(t)=\\int_{0}^{1} y^{2}(1-y)^{2}\\,\\exp(-2 t y)\\,dy,\\qquad I_{1}(t)=\\int_{0}^{1}\\left[\\frac{d}{dy}\\left(y(1-y)\\exp(-t y)\\right)\\right]^{2}dy.\n$$\nThe derivative inside $I_{1}(t)$ is\n$$\n\\frac{d}{dy}\\left(y(1-y)\\exp(-t y)\\right)=\\exp(-t y)\\left[(1-2y)-t\\,y(1-y)\\right],\n$$\nso\n$$\nI_{1}(t)=\\int_{0}^{1}\\exp(-2 t y)\\left[(1-2y)-t\\,y(1-y)\\right]^{2}dy.\n$$\n\nNext, we analyze the optimization over $t$ (equivalently, over $\\beta$). Consider the reflection $y\\mapsto 1-y$ (equivalently $x\\mapsto L-x$). Under this map,\n$$\n\\psi_{\\beta}(L-x)=(L-x)\\,x\\,\\exp\\!\\left(-\\beta(L-x)\\right)=\\exp(-\\beta L)\\,x(L-x)\\,\\exp(+\\beta x)\\propto \\psi_{-\\beta}(x).\n$$\nBecause the energy functional depends on the trial function only through the normalized ratio $\\langle \\psi|H|\\psi\\rangle/\\langle\\psi|\\psi\\rangle$, any overall constant factor cancels between numerator and denominator. Since the Hamiltonian and the domain are invariant under $x\\mapsto L-x$, the energy must satisfy\n$$\nE(\\beta)=E(-\\beta),\n$$\ni.e., $F(t)$ is an even function of $t$. Thus $t=0$ is a stationary point.\n\nTo establish that $t=0$ is a minimum, we expand $F(t)$ to order $t^{2}$ and show that the quadratic coefficient is positive. Write\n$$\nA(y)=1-2y,\\qquad B(y)=y(1-y).\n$$\nThen\n$$\nI_{0}(t)=\\int_{0}^{1} B(y)^{2}\\,\\exp(-2 t y)\\,dy,\\qquad I_{1}(t)=\\int_{0}^{1}\\left[A(y)-t B(y)\\right]^{2}\\exp(-2 t y)\\,dy.\n$$\nExpanding $\\exp(-2 t y)=1-2 t y+2 t^{2} y^{2}+\\mathcal{O}(t^{3})$ and retaining terms up to order $t^{2}$ yields\n$$\nI_{0}(t)=\\int_{0}^{1}\\left[B^{2}-2 t\\,y B^{2}+2 t^{2} y^{2} B^{2}\\right]dy+\\mathcal{O}(t^{3}),\n$$\n$$\nI_{1}(t)=\\int_{0}^{1}\\left[A^{2}-2 t A B+t^{2} B^{2}\\right]\\left(1-2 t y+2 t^{2} y^{2}\\right)dy+\\mathcal{O}(t^{3}).\n$$\nUsing elementary integrals on $[0,1]$,\n$$\n\\int_{0}^{1}A^{2}dy=\\frac{1}{3},\\quad \\int_{0}^{1}y A^{2}dy=\\frac{1}{6},\\quad \\int_{0}^{1}y^{2}A^{2}dy=\\frac{2}{15},\n$$\n$$\n\\int_{0}^{1}B^{2}dy=\\frac{1}{30},\\quad \\int_{0}^{1}y B^{2}dy=\\frac{1}{60},\\quad \\int_{0}^{1}y^{2} B^{2}dy=\\frac{1}{105},\n$$\nand $\\int_{0}^{1}A B\\,dy=0$, $\\int_{0}^{1}y A B\\,dy=-\\frac{1}{60}$, we obtain\n$$\nI_{0}(t)=\\frac{1}{30}-\\frac{1}{30}t+\\frac{2}{105}t^{2}+\\mathcal{O}(t^{3}),\n$$\n$$\nI_{1}(t)=\\frac{1}{3}-\\frac{1}{3}t+\\frac{7}{30}t^{2}+\\mathcal{O}(t^{3}).\n$$\nForming the ratio,\n$$\nF(t)=\\frac{I_{1}(t)}{I_{0}(t)}=10\\left[1+\\left(\\frac{7}{10}-\\frac{4}{7}\\right)t^{2}+\\mathcal{O}(t^{3})\\right]=10\\left[1+\\frac{9}{70}t^{2}+\\mathcal{O}(t^{3})\\right].\n$$\nThe positive coefficient of $t^{2}$ shows that $t=0$ is a strict local minimum. By evenness and smoothness, $t=0$ is the global minimizer within this one-parameter family.\n\nTherefore the optimal parameter is $\\beta^{\\star}=0$, and the corresponding integrals at $t=0$ are\n$$\nI_{0}(0)=\\int_{0}^{1}y^{2}(1-y)^{2}dy=\\frac{1}{30},\\qquad I_{1}(0)=\\int_{0}^{1}(1-2y)^{2}dy=\\frac{1}{3}.\n$$\nHence\n$$\nF(0)=\\frac{I_{1}(0)}{I_{0}(0)}=\\frac{1/3}{1/30}=10,\n$$\nand the optimized variational upper bound to the ground-state energy is\n$$\nE_{\\mathrm{var,min}}=\\frac{\\hbar^{2}}{2m L^{2}}\\times 10=\\frac{5\\,\\hbar^{2}}{m\\,L^{2}}.\n$$\nThis is a rigorous upper bound to the exact ground-state energy. It is larger than the exact value for the infinite well, consistent with the variational principle, and the optimization over $\\beta$ within this family selects the symmetric member $\\beta=0$ as expected from the reflection symmetry of the Hamiltonian and domain.", "answer": "$$\\boxed{\\frac{5\\,\\hbar^{2}}{m\\,L^{2}}}$$", "id": "2792826"}, {"introduction": "Beyond stationary states, a key aspect of quantum mechanics is understanding how systems evolve when their environment changes. This practice [@problem_id:1410530] explores the dynamics of a particle in a box whose walls are moved, contrasting two crucial limits: an infinitely slow (adiabatic) versus an instantaneous (sudden) expansion. By analyzing the final state and energy in both scenarios, you will gain deep insight into the adiabatic theorem and the concept of state projection following a rapid perturbation.", "problem": "A particle of mass $m$ is initially in the ground state of a one-dimensional infinite potential well defined by $V(x)=0$ for $0 < x < L$ and $V(x)=\\infty$ otherwise. The initial energy of the particle is $E_{init}$. The box is expanded to a new length of $2L$ by moving the right-hand wall. We will compare two distinct scenarios for this expansion.\n\n**Scenario A (Adiabatic Expansion):** The wall is moved from $x=L$ to $x=2L$ infinitely slowly. Let the final energy of the particle in this case be $E_{final,A}$.\n\n**Scenario B (Sudden Expansion):** The wall is instantaneously moved from $x=L$ to $x=2L$. The particle's state immediately after the expansion is a superposition of the eigenstates $\\phi_n(x)$ of the new, larger box. For each $n=1, 2, 3, \\ldots$, let $P_n$ be the probability of finding the particle in the $n$-th eigenstate $\\phi_n$, which has energy $E'_n$.\n\nLet $\\phi_j$ and $\\phi_k$ be the two specific eigenstates that the particle is most likely to occupy after the sudden expansion, with corresponding probabilities $P_j$ and $P_k$ such that $P_j > P_k > P_m$ for all other states $m \\neq j, k$. The expectation value of energy, conditioned on the particle being in the subspace spanned by these two states, is given by $\\bar{E}_{jk} = \\frac{P_j E'_j + P_k E'_k}{P_j + P_k}$.\n\nCalculate the dimensionless ratio $\\mathcal{R}$ defined as:\n$$\n\\mathcal{R} = \\frac{\\bar{E}_{jk} - E_{final,A}}{E_{init} - E_{final,A}}\n$$\nExpress your answer as a closed-form analytic expression.", "solution": "The stationary states and energies in a one-dimensional infinite well of width $a$ are $\\psi_{n}^{(a)}(x)=\\sqrt{2/a}\\,\\sin(n\\pi x/a)$ with $E_{n}(a)=n^{2}\\pi^{2}\\hbar^{2}/(2ma^{2})$. Initially, for width $L$, the particle is in the ground state with\n$$\nE_{init}=E_{1}(L)=\\frac{\\pi^{2}\\hbar^{2}}{2mL^{2}}.\n$$\nIn the adiabatic expansion to width $2L$, the quantum number is preserved, so the particle remains in the ground state of the new well and\n$$\nE_{final,A}=E_{1}(2L)=\\frac{\\pi^{2}\\hbar^{2}}{2m(2L)^{2}}=\\frac{1}{4}E_{init}.\n$$\nFor the sudden expansion to width $2L$, the new eigenstates are $\\phi_{n}(x)=\\sqrt{2/(2L)}\\sin(n\\pi x/(2L))=\\sqrt{1/L}\\sin(n\\pi x/(2L))$ with energies\n$$\nE'_{n}=E_{n}(2L)=\\frac{n^{2}\\pi^{2}\\hbar^{2}}{2m(2L)^{2}}=\\frac{n^{2}}{4}E_{init}.\n$$\nThe overlap coefficients with the initial state $\\psi_{1}^{(L)}(x)=\\sqrt{2/L}\\sin(\\pi x/L)$ are\n$$\nc_{n}=\\int_{0}^{2L}\\phi_{n}(x)\\psi_{1}^{(L)}(x)\\,dx=\\frac{\\sqrt{2}}{L}\\int_{0}^{L}\\sin\\!\\left(\\frac{\\pi x}{L}\\right)\\sin\\!\\left(\\frac{n\\pi x}{2L}\\right)dx.\n$$\nWith $u=x/L$,\n$$\nc_{n}=\\sqrt{2}\\int_{0}^{1}\\sin(\\pi u)\\sin\\!\\left(\\frac{n\\pi u}{2}\\right)du.\n$$\nUsing $\\sin A\\sin B=\\frac{1}{2}\\left[\\cos(A-B)-\\cos(A+B)\\right]$,\n$$\nc_{n}=\\frac{\\sqrt{2}}{2}\\left[\\frac{\\sin\\!\\big(\\pi(1-\\tfrac{n}{2})\\big)}{\\pi(1-\\tfrac{n}{2})}-\\frac{\\sin\\!\\big(\\pi(1+\\tfrac{n}{2})\\big)}{\\pi(1+\\tfrac{n}{2})}\\right].\n$$\nFor $n\\neq 2$, use $\\sin(\\pi(1\\mp n/2))=\\pm\\sin(\\pi n/2)$ to obtain\n$$\nc_{n}=\\frac{4\\sqrt{2}}{\\pi}\\,\\frac{\\sin(\\pi n/2)}{4-n^{2}},\\quad n\\neq 2,\n$$\nwhile for $n=2$,\n$$\nc_{2}=\\sqrt{2}\\int_{0}^{1}\\sin^{2}(\\pi u)\\,du=\\frac{\\sqrt{2}}{2}.\n$$\nThus the probabilities are\n$$\nP_{2}=|c_{2}|^{2}=\\frac{1}{2},\\quad P_{n}=|c_{n}|^{2}=\\frac{32}{\\pi^{2}}\\frac{\\sin^{2}(\\pi n/2)}{(4-n^{2})^{2}}\\ \\text{for}\\ n\\neq 2.\n$$\nHence $P_{n}=0$ for even $n\\neq 2$, and for odd $n$ one has $\\sin^{2}(\\pi n/2)=1$, so in particular\n$$\nP_{1}=\\frac{32}{9\\pi^{2}},\\quad P_{3}=\\frac{32}{25\\pi^{2}},\\ \\ldots\n$$\nTherefore the two most probable states are $j=2$ and $k=1$ with $P_{2}>P_{1}>P_{m}$ for all $m\\neq 1,2$. Their energies are $E'_{2}=E_{init}$ and $E'_{1}=E_{init}/4=E_{final,A}$. The conditional expectation is\n$$\n\\bar{E}_{21}=\\frac{P_{2}E'_{2}+P_{1}E'_{1}}{P_{2}+P_{1}}=E_{init}\\,\\frac{P_{2}+\\tfrac{1}{4}P_{1}}{P_{2}+P_{1}}.\n$$\nThe ratio\n$$\n\\mathcal{R}=\\frac{\\bar{E}_{21}-E_{final,A}}{E_{init}-E_{final,A}}=\\frac{E_{init}\\left(\\frac{P_{2}+\\tfrac{1}{4}P_{1}}{P_{2}+P_{1}}-\\frac{1}{4}\\right)}{\\frac{3}{4}E_{init}}=\\frac{P_{2}}{P_{1}+P_{2}}.\n$$\nSubstituting $P_{2}=\\frac{1}{2}$ and $P_{1}=\\frac{32}{9\\pi^{2}}$,\n$$\n\\mathcal{R}=\\frac{\\frac{1}{2}}{\\frac{1}{2}+\\frac{32}{9\\pi^{2}}}=\\frac{1}{1+\\frac{64}{9\\pi^{2}}}=\\frac{9\\pi^{2}}{9\\pi^{2}+64}.\n$$\nThis is a closed-form analytic expression.", "answer": "$$\\boxed{\\frac{9\\pi^{2}}{9\\pi^{2}+64}}$$", "id": "1410530"}, {"introduction": "While analytical solutions provide immense insight, most real-world quantum problems require numerical computation. This hands-on practice [@problem_id:2913789] guides you through translating the continuous Schrödinger equation into a discrete problem solvable by a computer using the finite difference method. You will construct the Hamiltonian matrix for the particle-in-a-box and learn to assess the accuracy of your numerical results, a foundational skill in computational science.", "problem": "Consider a nonrelativistic particle of mass $m$ confined to a one-dimensional interval $(0,L)$ with infinite potential barriers at $x=0$ and $x=L$. The time-independent Schrödinger equation for stationary states inside the well is the homogeneous second-order linear ordinary differential equation\n$$\n-\\frac{\\hbar^2}{2m}\\frac{d^2\\psi(x)}{dx^2}=E\\,\\psi(x),\\quad x\\in(0,L),\n$$\nsubject to Dirichlet boundary conditions $\\psi(0)=0$ and $\\psi(L)=0$. Starting only from this differential equation and boundary conditions, construct a second-order accurate finite difference (FD) discretization of the kinetic energy operator on a uniform grid with spacing $h$ over the interior of $(0,L)$. Your derivation must use Taylor expansions about interior grid points, including a demonstration that the local truncation error scales as $\\mathcal{O}(h^2)$.\n\nFrom your discretization, form a finite-dimensional symmetric matrix eigenvalue problem that approximates the continuous problem. Then, for each given test case below, implement a program that:\n- Builds the discrete kinetic operator matrix on the interior grid of $M$ points ($M$ is the number of interior points; the uniform spacing is $h=L/(M+1)$).\n- Solves the resulting symmetric matrix eigenvalue problem and extracts the $n$-th eigenvalue $E_{n,h}$ (ordered increasingly).\n- Computes the corresponding exact continuum energy $E_n$ for the same $n$, $L$, and $m$ from the analytical solution of the Schrödinger equation for a particle in a one-dimensional box.\n- Returns the absolute discretization error $|E_{n,h}-E_n|$.\n\nPhysical constants to use:\n- Reduced Planck constant $\\hbar = 1.054571817\\times 10^{-34}\\,\\mathrm{J\\cdot s}$.\n- Elementary charge $e = 1.602176634\\times 10^{-19}\\,\\mathrm{C}$ (exact), for converting Joules to electronvolts by $1\\,\\mathrm{eV}=e\\,\\mathrm{J}$.\n- Electron mass $m_{\\mathrm{e}}=9.1093837015\\times 10^{-31}\\,\\mathrm{kg}$.\n\nAll energies and energy errors must be expressed in electronvolts (eV). Your program must compute, for each test case, the absolute discretization error $|E_{n,h}-E_n|$ in $\\mathrm{eV}$ and output the result rounded to $10$ decimal places.\n\nTest suite (each case is a quadruple $(L\\,[\\mathrm{m}],\\,m\\,[\\mathrm{kg}],\\,n,\\,M)$):\n1. $(1.0\\times 10^{-9},\\,9.1093837015\\times 10^{-31},\\,1,\\,10)$\n2. $(1.0\\times 10^{-9},\\,9.1093837015\\times 10^{-31},\\,1,\\,20)$\n3. $(1.0\\times 10^{-9},\\,9.1093837015\\times 10^{-31},\\,1,\\,40)$\n4. $(1.0\\times 10^{-9},\\,9.1093837015\\times 10^{-31},\\,3,\\,120)$\n5. $(1.0\\times 10^{-9},\\,9.1093837015\\times 10^{-31},\\,5,\\,200)$\n6. $(0.5\\times 10^{-9},\\,9.1093837015\\times 10^{-31},\\,1,\\,40)$\n7. $(1.0\\times 10^{-9},\\,9.1093837015\\times 10^{-31},\\,8,\\,10)$\n\nFinal output format requirement:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the same order as the test cases above. For example, the output must look like\n$$\n[\\text{result}_1,\\text{result}_2,\\ldots,\\text{result}_7],\n$$\nwhere each $\\text{result}_k$ is a decimal number representing $|E_{n,h}-E_n|$ in $\\mathrm{eV}$, rounded to $10$ decimal places.", "solution": "The problem requires the derivation of a numerical method to solve the one-dimensional time-independent Schrödinger equation for a particle in a box and its implementation to calculate the discretization error for several test cases.\n\nFirst, we derive the finite difference approximation for the kinetic energy operator. The Schrödinger equation is given by:\n$$\n-\\frac{\\hbar^2}{2m}\\frac{d^2\\psi(x)}{dx^2} = E\\psi(x) \\quad \\text{for } x \\in (0, L)\n$$\nwith boundary conditions $\\psi(0)=0$ and $\\psi(L)=0$.\n\nWe discretize the domain $(0,L)$ into $M+1$ segments of equal length $h = L/(M+1)$. This defines a grid of $M+2$ points $x_i = i \\cdot h$ for $i=0, 1, \\dots, M+1$. The interior points are $x_1, \\dots, x_M$. The wavefunction at these a grid point $x_i$ is denoted by $\\psi_i \\equiv \\psi(x_i)$. The boundary conditions imply $\\psi_0 = 0$ and $\\psi_{M+1} = 0$.\n\nTo approximate the second derivative $\\frac{d^2\\psi}{dx^2}$ at an interior grid point $x_i$, we use Taylor series expansions of $\\psi(x)$ around $x_i$:\n$$\n\\psi(x_i + h) = \\psi(x_i) + h \\psi'(x_i) + \\frac{h^2}{2!} \\psi''(x_i) + \\frac{h^3}{3!} \\psi'''(x_i) + \\frac{h^4}{4!} \\psi^{(4)}(x_i) + \\mathcal{O}(h^5)\n$$\n$$\n\\psi(x_i - h) = \\psi(x_i) - h \\psi'(x_i) + \\frac{h^2}{2!} \\psi''(x_i) - \\frac{h^3}{3!} \\psi'''(x_i) + \\frac{h^4}{4!} \\psi^{(4)}(x_i) - \\mathcal{O}(h^5)\n$$\nIn grid point notation, this is:\n$$\n\\psi_{i+1} = \\psi_i + h \\psi'(x_i) + \\frac{h^2}{2} \\psi''(x_i) + \\frac{h^3}{6} \\psi'''(x_i) + \\frac{h^4}{24} \\psi^{(4)}(x_i) + \\mathcal{O}(h^5)\n$$\n$$\n\\psi_{i-1} = \\psi_i - h \\psi'(x_i) + \\frac{h^2}{2} \\psi''(x_i) - \\frac{h^3}{6} \\psi'''(x_i) + \\frac{h^4}{24} \\psi^{(4)}(x_i) - \\mathcal{O}(h^5)\n$$\nAdding these two equations eliminates all odd-power terms in $h$:\n$$\n\\psi_{i+1} + \\psi_{i-1} = 2\\psi_i + h^2 \\psi''(x_i) + \\frac{h^4}{12} \\psi^{(4)}(x_i) + \\mathcal{O}(h^6)\n$$\nRearranging to solve for the second derivative $\\psi''(x_i)$:\n$$\n\\psi''(x_i) = \\frac{\\psi_{i+1} - 2\\psi_i + \\psi_{i-1}}{h^2} - \\frac{h^2}{12} \\psi^{(4)}(x_i) + \\mathcal{O}(h^4)\n$$\nThe centered finite difference approximation for the second derivative is thus:\n$$\n\\frac{d^2\\psi}{dx^2}\\bigg|_{x=x_i} \\approx \\frac{\\psi_{i+1} - 2\\psi_i + \\psi_{i-1}}{h^2}\n$$\nThe local truncation error (LTE) is the difference between the exact derivative and its approximation:\n$$\n\\text{LTE} = \\psi''(x_i) - \\left( \\frac{\\psi_{i+1} - 2\\psi_i + \\psi_{i-1}}{h^2} \\right) = - \\frac{h^2}{12} \\psi^{(4)}(x_i) + \\mathcal{O}(h^4)\n$$\nThe leading error term is proportional to $h^2$, so this is a second-order accurate scheme, as required.\n\nNow, we substitute this approximation into the Schrödinger equation for each interior grid point $x_i$, $i = 1, \\dots, M$:\n$$\n-\\frac{\\hbar^2}{2m} \\left( \\frac{\\psi_{i+1} - 2\\psi_i + \\psi_{i-1}}{h^2} \\right) = E_h \\psi_i\n$$\nwhere $E_h$ is the numerical approximation of the energy eigenvalue. Rearranging the terms, we get:\n$$\n-\\frac{\\hbar^2}{2mh^2} \\psi_{i-1} + \\frac{2\\hbar^2}{2mh^2} \\psi_i - \\frac{\\hbar^2}{2mh^2} \\psi_{i+1} = E_h \\psi_i\n$$\nThis represents a system of $M$ coupled linear equations for the values $\\psi_1, \\dots, \\psi_M$.\nFor $i=1$: $-\\frac{\\hbar^2}{2mh^2}\\psi_0 + \\frac{\\hbar^2}{mh^2}\\psi_1 - \\frac{\\hbar^2}{2mh^2}\\psi_2 = E_h \\psi_1$. With $\\psi_0=0$, this becomes $\\frac{\\hbar^2}{mh^2}\\psi_1 - \\frac{\\hbar^2}{2mh^2}\\psi_2 = E_h \\psi_1$.\nFor $i=M$: $-\\frac{\\hbar^2}{2mh^2}\\psi_{M-1} + \\frac{\\hbar^2}{mh^2}\\psi_M - \\frac{\\hbar^2}{2mh^2}\\psi_{M+1} = E_h \\psi_M$. With $\\psi_{M+1}=0$, this becomes $-\\frac{\\hbar^2}{2mh^2}\\psi_{M-1} + \\frac{\\hbar^2}{mh^2}\\psi_M = E_h \\psi_M$.\n\nThis system of equations can be written as a matrix eigenvalue problem $\\mathbf{H}\\vec{\\psi} = E_h \\vec{\\psi}$, where $\\vec{\\psi} = [\\psi_1, \\psi_2, \\dots, \\psi_M]^T$ is the vector of the wavefunction values at the interior grid points, and $\\mathbf{H}$ is the $M \\times M$ discrete Hamiltonian matrix. The elements of $\\mathbf{H}$ are:\n$$\nH_{ij} = \\begin{cases} \\frac{\\hbar^2}{mh^2} & \\text{if } i=j \\\\ -\\frac{\\hbar^2}{2mh^2} & \\text{if } |i-j|=1 \\\\ 0 & \\text{otherwise} \\end{cases}\n$$\nThis matrix can be expressed as:\n$$\n\\mathbf{H} = \\frac{\\hbar^2}{2mh^2}\n\\begin{pmatrix}\n2 & -1 & 0 & \\cdots & 0 \\\\\n-1 & 2 & -1 & \\cdots & 0 \\\\\n0 & -1 & 2 & \\ddots & \\vdots \\\\\n\\vdots & \\vdots & \\ddots & \\ddots & -1 \\\\\n0 & 0 & \\cdots & -1 & 2\n\\end{pmatrix}\n$$\nThis is a real, symmetric, tridiagonal matrix. Solving this eigenvalue problem yields $M$ eigenvalues $E_{n,h}$ and corresponding eigenvectors $\\vec{\\psi}_n$ for $n=1, \\dots, M$. These are the numerical approximations to the first $M$ energy levels and wavefunctions of the continuous system.\n\nThe analytical solution for the energy eigenvalues of the continuous particle in a one-dimensional box problem is:\n$$\nE_n = \\frac{n^2 \\pi^2 \\hbar^2}{2mL^2}, \\quad n=1, 2, 3, \\dots\n$$\nThe program will solve the matrix eigenvalue problem for $\\mathbf{H}$ to find the numerical eigenvalues $E_{n,h}$, calculate the corresponding exact eigenvalues $E_n$, and compute the absolute error $|E_{n,h} - E_n|$. All energies must be converted from Joules to electronvolts (eV) by dividing by the elementary charge $e$. The required physical constants are $\\hbar = 1.054571817 \\times 10^{-34}\\,\\mathrm{J\\cdot s}$, $m_{\\mathrm{e}}=9.1093837015\\times 10^{-31}\\,\\mathrm{kg}$, and $e = 1.602176634\\times 10^{-19}\\,\\mathrm{C}$.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import eigh_tridiagonal\n\ndef solve():\n    \"\"\"\n    Solves the particle in a box problem using a finite difference method\n    and computes the absolute error against the exact analytical solution.\n    \"\"\"\n    # Define physical constants as specified.\n    HBAR = 1.054571817e-34  # J*s\n    E_CHARGE = 1.602176634e-19  # C (for J to eV conversion)\n    M_E = 9.1093837015e-31  # kg (electron mass)\n    J_PER_EV = E_CHARGE # Joules per electronvolt\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (L [m], m [kg], n, M)\n        (1.0e-9, M_E, 1, 10),\n        (1.0e-9, M_E, 1, 20),\n        (1.0e-9, M_E, 1, 40),\n        (1.0e-9, M_E, 3, 120),\n        (1.0e-9, M_E, 5, 200),\n        (0.5e-9, M_E, 1, 40),\n        (1.0e-9, M_E, 8, 10),\n    ]\n\n    results = []\n    for L, m, n, M in test_cases:\n        # Calculate the uniform grid spacing h.\n        h = L / (M + 1)\n        \n        # Construct the tridiagonal Hamiltonian matrix H.\n        # The matrix is H = (hbar^2 / (2*m*h^2)) * Tridiag(-1, 2, -1).\n        # We can implement this for eigh_tridiagonal by defining the main\n        # and off-diagonal vectors.\n        \n        # Main diagonal elements: hbar^2 / (m * h^2)\n        main_diag_val = HBAR**2 / (m * h**2)\n        main_diag = np.full(M, main_diag_val)\n        \n        # Off-diagonal elements: -hbar^2 / (2 * m * h^2)\n        off_diag_val = -HBAR**2 / (2 * m * h**2)\n        off_diag = np.full(M - 1, off_diag_val)\n        \n        # Solve the eigenvalue problem for the symmetric tridiagonal matrix.\n        # eigh_tridiagonal is highly efficient and returns eigenvalues sorted in\n        # ascending order. The energies are in Joules.\n        eigenvalues_J, _ = eigh_tridiagonal(main_diag, off_diag)\n        \n        # Select the n-th numerical eigenvalue (using 0-based indexing).\n        # The problem uses 1-based indexing for n (n-th eigenvalue).\n        E_nh_J = eigenvalues_J[n - 1]\n        \n        # Calculate the exact analytical energy for the n-th state.\n        E_n_J = (n**2 * np.pi**2 * HBAR**2) / (2 * m * L**2)\n        \n        # Convert energies from Joules to electronvolts (eV).\n        E_nh_eV = E_nh_J / J_PER_EV\n        E_n_eV = E_n_J / J_PER_EV\n        \n        # Compute the absolute discretization error in eV.\n        absolute_error_eV = abs(E_nh_eV - E_n_eV)\n        \n        # Append the rounded result to the list.\n        results.append(f\"{absolute_error_eV:.10f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "2913789"}]}