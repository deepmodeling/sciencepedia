{"hands_on_practices": [{"introduction": "The first step in mastering the canonical ensemble is to apply its core principles to a simple, analytically solvable model. This exercise [@problem_id:1996069] introduces a hypothetical two-level system, which serves as a powerful pedagogical model for many real-world phenomena like protein folding or simple chemical equilibria. By calculating the canonical partition function and deriving the average energy, you will gain direct, hands-on experience in connecting the microscopic energy landscape of a system to its macroscopic thermodynamic behavior as a function of temperature.", "problem": "A simplified toy model is used to describe the conformational changes of a single biological macromolecule. The molecule can exist in only two distinct states: a compact, folded state and an extended, unfolded state. The folded state is taken to be the ground state with an energy of zero. The unfolded state requires an energy input to form, and thus has an energy of $\\epsilon$, where $\\epsilon > 0$. The macromolecule is immersed in a large heat bath held at a constant absolute temperature $T$.\n\nBased on this model, derive an expression for the average energy, $\\langle E \\rangle$, of a single such macromolecule. Your final answer should be a closed-form analytic expression in terms of the energy difference $\\epsilon$, the temperature $T$, and the Boltzmann constant $k_B$.", "solution": "The macromolecule has two energy levels: folded with energy $E_{0}=0$ and unfolded with energy $E_{1}=\\epsilon$, with $\\epsilon>0$. In contact with a heat bath at absolute temperature $T$, the appropriate ensemble is the canonical ensemble. Define $\\beta=\\frac{1}{k_{B}T}$. The Boltzmann weight for a state of energy $E_{i}$ is $\\exp(-\\beta E_{i})$, and the partition function is the sum of these weights over all states:\n$$\nZ=\\sum_{i}\\exp(-\\beta E_{i})=\\exp(-\\beta\\cdot 0)+\\exp(-\\beta\\epsilon)=1+\\exp(-\\beta\\epsilon).\n$$\nThe probability to be in state $i$ is $p_{i}=\\frac{\\exp(-\\beta E_{i})}{Z}$. Therefore, the average energy is\n$$\n\\langle E\\rangle=\\sum_{i}E_{i}p_{i}=0\\cdot\\frac{\\exp(0)}{Z}+\\epsilon\\cdot\\frac{\\exp(-\\beta\\epsilon)}{Z}=\\epsilon\\,\\frac{\\exp(-\\beta\\epsilon)}{1+\\exp(-\\beta\\epsilon)}.\n$$\nTo simplify, multiply numerator and denominator by $\\exp(\\beta\\epsilon)$:\n$$\n\\langle E\\rangle=\\epsilon\\,\\frac{1}{\\exp(\\beta\\epsilon)+1}.\n$$\nSubstituting $\\beta=\\frac{1}{k_{B}T}$ yields the closed-form expression in terms of $\\epsilon$, $T$, and $k_{B}$:\n$$\n\\langle E\\rangle=\\frac{\\epsilon}{1+\\exp\\left(\\frac{\\epsilon}{k_{B}T}\\right)}.\n$$\nThis result is consistent with the limits $T\\to 0$ giving $\\langle E\\rangle\\to 0$ and $T\\to\\infty$ giving $\\langle E\\rangle\\to \\frac{\\epsilon}{2}$.", "answer": "$$\\boxed{\\frac{\\epsilon}{1+\\exp\\left(\\frac{\\epsilon}{k_{B}T}\\right)}}$$", "id": "1996069"}, {"introduction": "Building on the fundamentals, we now move to a more complex scenario involving a system of many non-interacting atoms with degenerate energy levels [@problem_id:118084]. This practice challenges you to construct a partition function that accounts for degeneracy and its partial lifting by an external field. The main goal is to derive the heat capacity, a key thermodynamic response function, in the high-temperature limit, a common task in physical chemistry that requires careful application of series approximations to the partition function.", "problem": "A solid contains $N$ distinguishable, non-interacting atoms. The energy levels of each atom can be modeled as follows. There is a non-degenerate ground state with energy $E_0=0$. There is also a set of excited states which, in the absence of any external fields, are $g$-fold degenerate with energy $\\epsilon > 0$. We assume $g$ is an odd integer, so we can write $g=2m+1$ for some non-negative integer $m$.\n\nAn external field is applied to the solid, which partially lifts the degeneracy of the excited state. The $g$ excited levels are now split symmetrically about the original energy $\\epsilon$, with new energies given by\n$$ E_j = \\epsilon + j\\delta $$\nfor $j = -m, -m+1, \\dots, m$. The parameter $\\delta$ is a small, positive energy splitting constant determined by the field strength.\n\nThe system is in thermal equilibrium with a heat bath at temperature $T$. In the high-temperature limit ($k_B T \\gg \\epsilon, k_B T \\gg g\\delta$), find the heat capacity at constant volume, $C_V$, for this system of $N$ atoms. Your answer should be the leading non-vanishing term in the high-temperature expansion. Express your result in a single closed-form expression in terms of $N$, $g$, $\\epsilon$, $\\delta$, the temperature $T$, and the Boltzmann constant $k_B$.", "solution": "The system consists of $N$ distinguishable, non-interacting atoms. The single-atom partition function $z$ is given by:\n\n$$\nz = 1 + \\sum_{j=-m}^{m} e^{-E_j / (k_B T)},\n$$\n\nwhere $E_j = \\epsilon + j\\delta$ for $j = -m, -m+1, \\dots, m$, and $g = 2m+1$ is the degeneracy of the unsplit excited state. Thus,\n\n$$\nz = 1 + e^{-\\epsilon / (k_B T)} \\sum_{j=-m}^{m} e^{-j\\delta / (k_B T)}.\n$$\n\nDefine $\\beta = 1/(k_B T)$. The sum $S = \\sum_{j=-m}^{m} e^{-\\beta j \\delta}$ is symmetric in $j$. In the high-temperature limit, $\\beta \\epsilon \\ll 1$ and $\\beta g \\delta \\ll 1$, so expand $S$ to second order in $\\beta$:\n\n$$\nS \\approx \\sum_{j=-m}^{m} \\left(1 - \\beta j \\delta + \\frac{1}{2} (\\beta j \\delta)^2\\right).\n$$\n\nThe linear term vanishes due to symmetry, leaving:\n\n$$\nS \\approx \\sum_{j=-m}^{m} \\left(1 + \\frac{1}{2} \\beta^2 j^2 \\delta^2\\right) = g + \\frac{1}{2} \\beta^2 \\delta^2 \\sum_{j=-m}^{m} j^2.\n$$\n\nThe sum $\\sum_{j=-m}^{m} j^2 = \\frac{g(g^2 - 1)}{12}$, so:\n\n$$\nS \\approx g + \\frac{\\beta^2 \\delta^2 g (g^2 - 1)}{24}.\n$$\n\nNow, $z$ becomes:\n\n$$\nz = 1 + e^{-\\beta \\epsilon} \\left( g + \\frac{\\beta^2 \\delta^2 g (g^2 - 1)}{24} \\right).\n$$\n\nExpand $e^{-\\beta \\epsilon} \\approx 1 - \\beta \\epsilon + \\frac{1}{2} \\beta^2 \\epsilon^2$:\n\n$$\nz \\approx 1 + \\left(1 - \\beta \\epsilon + \\frac{1}{2} \\beta^2 \\epsilon^2\\right) \\left( g + \\frac{\\beta^2 \\delta^2 g (g^2 - 1)}{24} \\right).\n$$\n\nMultiplying and keeping terms up to $\\beta^2$:\n\n$$\nz \\approx 1 + g - g \\beta \\epsilon + \\frac{g}{2} \\beta^2 \\epsilon^2 + \\frac{\\beta^2 \\delta^2 g (g^2 - 1)}{24}.\n$$\n\nSet $A = 1 + g$, $B = -g \\epsilon$, $C = \\frac{g}{2} \\epsilon^2 + \\frac{\\delta^2 g (g^2 - 1)}{24}$, so:\n\n$$\nz \\approx A + B \\beta + C \\beta^2.\n$$\n\nThe logarithm of $z$ is:\n\n$$\n\\ln z = \\ln A + \\ln\\left(1 + \\frac{B}{A} \\beta + \\frac{C}{A} \\beta^2\\right) \\approx \\ln A + \\frac{B}{A} \\beta + \\left( \\frac{C}{A} - \\frac{1}{2} \\left( \\frac{B}{A} \\right)^2 \\right) \\beta^2.\n$$\n\nThe internal energy for one atom is $U_1 = -\\frac{\\partial \\ln z}{\\partial \\beta}$:\n\n$$\nU_1 \\approx -\\left[ \\frac{B}{A} + 2 \\left( \\frac{C}{A} - \\frac{1}{2} \\left( \\frac{B}{A} \\right)^2 \\right) \\beta \\right].\n$$\n\nFor $N$ atoms, $U = N U_1$. The heat capacity is $C_V = \\left( \\frac{\\partial U}{\\partial T} \\right)_V$. Since $\\frac{d\\beta}{dT} = -\\frac{1}{k_B T^2}$:\n\n$$\nC_V = \\frac{N}{k_B T^2} \\frac{\\partial U_1}{\\partial \\beta}.\n$$\n\nSubstituting $U_1$:\n\n$$\n\\frac{\\partial U_1}{\\partial \\beta} \\approx -2 \\left( \\frac{C}{A} - \\frac{1}{2} \\left( \\frac{B}{A} \\right)^2 \\right),\n$$\n\nso:\n\n$$\nC_V \\approx \\frac{2N}{k_B T^2} \\left( \\frac{C}{A} - \\frac{1}{2} \\left( \\frac{B}{A} \\right)^2 \\right).\n$$\n\nNow substitute $A = 1 + g$, $B = -g \\epsilon$, $C = \\frac{g}{2} \\epsilon^2 + \\frac{\\delta^2 g (g^2 - 1)}{24}$:\n\n$$\n\\frac{C}{A} = \\frac{ \\frac{g}{2} \\epsilon^2 + \\frac{\\delta^2 g (g^2 - 1)}{24} }{1 + g}, \\quad \\left( \\frac{B}{A} \\right)^2 = \\left( \\frac{-g \\epsilon}{1 + g} \\right)^2 = \\frac{g^2 \\epsilon^2}{(1 + g)^2}.\n$$\n\nThus:\n\n$$\n\\frac{C}{A} - \\frac{1}{2} \\left( \\frac{B}{A} \\right)^2 = \\frac{ \\frac{g}{2} \\epsilon^2 + \\frac{\\delta^2 g (g^2 - 1)}{24} }{1 + g} - \\frac{1}{2} \\frac{g^2 \\epsilon^2}{(1 + g)^2}.\n$$\n\nCombining terms with a common denominator $(1 + g)^2$:\n\n$$\n= \\frac{ (1 + g) \\left( \\frac{g}{2} \\epsilon^2 + \\frac{\\delta^2 g (g^2 - 1)}{24} \\right) - \\frac{1}{2} g^2 \\epsilon^2 }{(1 + g)^2}.\n$$\n\nThe numerator is:\n\n$$\n(1 + g) \\frac{g}{2} \\epsilon^2 + (1 + g) \\frac{\\delta^2 g (g^2 - 1)}{24} - \\frac{1}{2} g^2 \\epsilon^2 = \\frac{g}{2} \\epsilon^2 (1 + g - g) + \\frac{\\delta^2 g (g^2 - 1) (1 + g)}{24} = \\frac{g \\epsilon^2}{2} + \\frac{\\delta^2 g (g^2 - 1) (1 + g)}{24}.\n$$\n\nSo:\n\n$$\n\\frac{C}{A} - \\frac{1}{2} \\left( \\frac{B}{A} \\right)^2 = \\frac{ \\frac{g \\epsilon^2}{2} + \\frac{\\delta^2 g (g^2 - 1) (1 + g)}{24} }{(1 + g)^2} = \\frac{g \\epsilon^2}{2 (1 + g)^2} + \\frac{\\delta^2 g (g^2 - 1)}{24 (1 + g)}.\n$$\n\nNow:\n\n$$\n2 \\left( \\frac{C}{A} - \\frac{1}{2} \\left( \\frac{B}{A} \\right)^2 \\right) = 2 \\cdot \\frac{g \\epsilon^2}{2 (1 + g)^2} + 2 \\cdot \\frac{\\delta^2 g (g^2 - 1)}{24 (1 + g)} = \\frac{g \\epsilon^2}{(1 + g)^2} + \\frac{\\delta^2 g (g^2 - 1)}{12 (1 + g)}.\n$$\n\nSince $g^2 - 1 = (g - 1)(g + 1)$:\n\n$$\n\\frac{\\delta^2 g (g^2 - 1)}{12 (1 + g)} = \\frac{\\delta^2 g (g - 1) (g + 1)}{12 (g + 1)} = \\frac{\\delta^2 g (g - 1)}{12}.\n$$\n\nThus:\n\n$$\nC_V = \\frac{N}{k_B T^2} \\left( \\frac{g \\epsilon^2}{(1 + g)^2} + \\frac{g (g - 1) \\delta^2}{12} \\right).\n$$\n\nThis is the leading non-vanishing term in the high-temperature expansion.", "answer": "$$ \\boxed{ \\frac{N}{k_B T^2} \\left( \\frac{g \\epsilon^2}{(g+1)^2} + \\frac{g(g-1)\\delta^2}{12} \\right) } $$", "id": "118084"}, {"introduction": "The canonical ensemble not only provides a theoretical description of systems at constant temperature but also forms the foundation for powerful computational simulation techniques. This exercise [@problem_id:2463730] bridges the gap between abstract theory and computational practice by tasking you with designing a Monte Carlo move for a binary mixture. To ensure the simulation correctly samples from the canonical distribution, your proposed move must satisfy the condition of detailed balance, a cornerstone principle of stochastic simulation methods. This practice offers invaluable insight into the algorithmic implementation of statistical mechanics.", "problem": "Consider a classical binary mixture in the canonical (NVT) ensemble, that is, the Number-Volume-Temperature (NVT) ensemble with fixed species counts: there are $N_A$ particles of species $A$ and $N_B$ particles of species $B$ in a container of volume $V$ at temperature $T$, so that the total number is $N=N_A+N_B$. The configurational state can be denoted by $(\\mathbf{r},\\sigma)$, where $\\mathbf{r}=(\\mathbf{r}_1,\\ldots,\\mathbf{r}_N)$ are particle positions and $\\sigma=(\\sigma_1,\\ldots,\\sigma_N)$ are species labels with $\\sigma_i\\in\\{A,B\\}$ and exactly $N_A$ labels equal to $A$ and $N_B$ equal to $B$. The potential energy is $U(\\mathbf{r},\\sigma)$, which depends on the species through interaction parameters, but there is no coordinate transformation in the move described below. The canonical configurational probability density is proportional to $\\exp(-\\beta U)$ with $\\beta=1/(k_\\mathrm{B}T)$, where $k_\\mathrm{B}$ is the Boltzmann constant.\n\nYou wish to augment a standard Monte Carlo sampler with an identity-swap move that exchanges the species labels of one particle of type $A$ and one particle of type $B$, leaving the positions $\\mathbf{r}$ unchanged, so that the composition $(N_A,N_B)$ remains fixed. Which of the following designs ensures satisfaction of detailed balance with respect to the canonical distribution?\n\nA. At each trial, select one $A$ uniformly at random among the $N_A$ particles of type $A$ and one $B$ uniformly at random among the $N_B$ particles of type $B$; swap their species labels, compute the potential-energy change $\\Delta U=U(\\mathbf{r},\\sigma')-U(\\mathbf{r},\\sigma)$, and accept with probability $\\min\\{1,\\exp(-\\beta\\,\\Delta U)\\}$.\n\nB. At each trial, select one $A$ and one $B$ uniformly at random; swap their species labels, and accept with probability $\\min\\{1,\\exp[-\\beta(\\Delta U-\\Delta\\mu)]\\}$, where $\\Delta\\mu=\\mu_A-\\mu_B$ is the chemical-potential difference between $A$ and $B$.\n\nC. At each trial, select one $A$ and one $B$ uniformly at random; swap their species labels, and accept with probability $\\min\\{1,\\exp(-\\beta\\,\\Delta U)\\,(N_A/N_B)\\}$ to correct for the differing numbers of $A$ and $B$ choices.\n\nD. At each trial, select one $A$ and one $B$ uniformly at random; swap their species labels, and accept if and only if $\\Delta U\\le 0$, otherwise reject, because uphill moves would violate energy conservation in the canonical ensemble.", "solution": "The validity of the problem statement will now be assessed.\n\n### Step 1: Extract Givens\n- Ensemble: Canonical (NVT) ensemble for a classical binary mixture.\n- Fixed quantities: Number of particles of species A ($N_A$), number of particles of species B ($N_B$), volume ($V$), temperature ($T$).\n- Total number of particles: $N = N_A + N_B$.\n- System state: A configurational state is denoted by $(\\mathbf{r},\\sigma)$, where $\\mathbf{r}=(\\mathbf{r}_1,\\ldots,\\mathbf{r}_N)$ are particle positions and $\\sigma=(\\sigma_1,\\ldots,\\sigma_N)$ are species labels. There are $N_A$ labels equal to $A$ and $N_B$ equal to $B$.\n- Potential energy function: $U(\\mathbf{r},\\sigma)$.\n- Canonical configurational probability density: $p(\\mathbf{r},\\sigma) \\propto \\exp(-\\beta U(\\mathbf{r},\\sigma))$, where $\\beta = 1/(k_\\mathrm{B}T)$.\n- Monte Carlo move: An identity-swap move exchanging the species labels of one particle of type $A$ and one of type $B$. Positions $\\mathbf{r}$ are unchanged. Composition $(N_A, N_B)$ is fixed.\n- Objective: Determine which of the provided move designs satisfies the detailed balance condition with respect to the specified canonical distribution.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientifically Grounded:** The problem is set within the rigorous framework of statistical mechanics (canonical ensemble) and computational simulation (Monte Carlo methods). The identity-swap move, Boltzmann factor, and detailed balance are all standard, well-established concepts in these fields. The problem is factually and scientifically sound.\n- **Well-Posed:** The problem asks for the correct acceptance criterion for a specific Monte Carlo move to satisfy a precise mathematical condition (detailed balance) for a given probability distribution. This is a well-defined question with a unique correct answer derivable from first principles.\n- **Objective:** The problem is stated in precise, formal language, free of ambiguity or subjective claims.\n- **Conclusion:** The problem statement is free from scientific flaws, contradictions, or ambiguities. It is a standard and valid problem in computational statistical mechanics.\n\n### Step 3: Verdict and Action\nThe problem is valid. A full derivation and evaluation will now be performed.\n\n### Solution Derivation\nThe condition of detailed balance, or microscopic reversibility, is a sufficient condition for a Markov chain to have the target distribution as its stationary distribution. For any two states $x$ and $x'$, the detailed balance equation is:\n$$\np(x) T(x \\to x') = p(x') T(x' \\to x)\n$$\nwhere $p(x)$ is the equilibrium probability of state $x$, and $T(x \\to x')$ is the total transition probability from state $x$ to $x'$. The transition probability is a product of the proposal probability, $g(x \\to x')$, and the acceptance probability, $A(x \\to x')$. Thus,\n$$\np(x) g(x \\to x') A(x \\to x') = p(x') g(x' \\to x) A(x' \\to x)\n$$\nThis can be rearranged to express the ratio of acceptance probabilities:\n$$\n\\frac{A(x \\to x')}{A(x' \\to x)} = \\frac{p(x')}{p(x)} \\frac{g(x' \\to x)}{g(x \\to x')}\n$$\nThe standard Metropolis-Hastings choice for the acceptance probability is:\n$$\nA(x \\to x') = \\min\\left(1, \\frac{p(x')}{p(x)} \\frac{g(x' \\to x)}{g(x \\to x')}\\right)\n$$\n\nWe must now apply this formalism to the problem at hand.\nA state $x$ is defined by the species labels $\\sigma = (\\sigma_1, \\ldots, \\sigma_N)$, as the positions $\\mathbf{r}$ are held constant during the move. A move consists of changing from a state $\\sigma$ to a new state $\\sigma'$ by swapping the labels of particle $i$ (initially type $A$) and particle $j$ (initially type $B$).\n\nThe target probability distribution is the canonical one:\n$$\np(\\sigma) \\propto \\exp[-\\beta U(\\sigma)]\n$$\nThe ratio of probabilities for two states $\\sigma$ and $\\sigma'$ is:\n$$\n\\frac{p(\\sigma')}{p(\\sigma)} = \\frac{\\exp[-\\beta U(\\sigma')]}{\\exp[-\\beta U(\\sigma)]} = \\exp[-\\beta (U(\\sigma') - U(\\sigma))] = \\exp(-\\beta \\Delta U)\n$$\n\nNext, we must determine the proposal probabilities. The proposal scheme is: \"select one $A$ uniformly at random among the $N_A$ particles of type $A$ and one $B$ uniformly at random among the $N_B$ particles of type $B$\".\nThe probability of proposing a swap between a specific particle $i$ of type $A$ and a specific particle $j$ of type $B$ is:\n$$\ng(\\sigma \\to \\sigma') = \\left(\\frac{1}{N_A}\\right) \\left(\\frac{1}{N_B}\\right) = \\frac{1}{N_A N_B}\n$$\nNow consider the reverse move, from $\\sigma'$ to $\\sigma$. In state $\\sigma'$, particle $i$ is now of type $B$ and particle $j$ is of type $A$. The total numbers of particles of each type remain $N_A$ and $N_B$. To reverse the move, we must select particle $j$ (now type $A$) and particle $i$ (now type $B$) and swap their labels. The probability of selecting this specific pair for the reverse swap is:\n$$\ng(\\sigma' \\to \\sigma) = \\left(\\frac{1}{N_A}\\right) \\left(\\frac{1}{N_B}\\right) = \\frac{1}{N_A N_B}\n$$\nThe proposal probability is symmetric: $g(\\sigma \\to \\sigma') = g(\\sigma' \\to \\sigma)$. The ratio of proposal probabilities is therefore unity:\n$$\n\\frac{g(\\sigma' \\to \\sigma)}{g(\\sigma \\to \\sigma')} = 1\n$$\nSubstituting these results into the Metropolis-Hastings acceptance probability formula gives:\n$$\nA(\\sigma \\to \\sigma') = \\min\\left(1, \\frac{p(\\sigma')}{p(\\sigma)} \\times 1\\right) = \\min\\left(1, \\exp(-\\beta \\Delta U)\\right)\n$$\nThis derivation determines the correct form of the acceptance probability. We now evaluate each option.\n\n### Option-by-Option Analysis\n\n**A. At each trial, select one $A$ uniformly at random among the $N_A$ particles of type $A$ and one $B$ uniformly at random among the $N_B$ particles of type $B$; swap their species labels, compute the potential-energy change $\\Delta U=U(\\mathbf{r},\\sigma')-U(\\mathbf{r},\\sigma)$, and accept with probability $\\min\\{1,\\exp(-\\beta\\,\\Delta U)\\}$.**\nThe proposal scheme described here is precisely the one analyzed above, which leads to a symmetric proposal probability $g(\\sigma \\to \\sigma') = g(\\sigma' \\to \\sigma)$. For such a symmetric proposal, the correct Metropolis acceptance rule is $A = \\min\\{1, \\exp(-\\beta \\Delta U)\\}$. This option correctly combines the symmetric proposal scheme with the appropriate simplified Metropolis acceptance rule.\nVerdict: **Correct**.\n\n**B. At each trial, select one $A$ and one $B$ uniformly at random; swap their species labels, and accept with probability $\\min\\{1,\\exp[-\\beta(\\Delta U-\\Delta\\mu)]\\}$, where $\\Delta\\mu=\\mu_A-\\mu_B$ is the chemical-potential difference between $A$ and $B$.**\nThis acceptance probability is incorrect for the canonical (NVT) ensemble. The term involving the chemical potential difference, $\\Delta\\mu$, is used for simulations in ensembles where particle numbers can fluctuate and are controlled by a chemical potential, such as the grand canonical ensemble or semi-grand canonical ensemble. The problem explicitly specifies the canonical ensemble, where particle numbers $N_A$ and $N_B$ are strictly fixed. In this ensemble, chemical potentials are emergent properties, not input parameters for the simulation dynamics.\nVerdict: **Incorrect**.\n\n**C. At each trial, select one $A$ and one $B$ uniformly at random; swap their species labels, and accept with probability $\\min\\{1,\\exp(-\\beta\\,\\Delta U)\\,(N_A/N_B)\\}$ to correct for the differing numbers of $A$ and $B$ choices.**\nThis acceptance rule includes a correction factor of $N_A/N_B$. Such factors appear in the Metropolis-Hastings formula when the proposal probabilities are asymmetric, i.e., $g(\\sigma \\to \\sigma') \\neq g(\\sigma' \\to \\sigma)$. However, as demonstrated in the derivation, the specified method of selecting one particle from $N_A$ and one from $N_B$ results in a symmetric proposal probability. Therefore, the ratio $g(\\sigma' \\to \\sigma)/g(\\sigma \\to \\sigma')$ is $1$, and the factor $N_A/N_B$ is both unnecessary and incorrect. It would violate detailed balance.\nVerdict: **Incorrect**.\n\n**D. At each trial, select one $A$ and one $B$ uniformly at random; swap their species labels, and accept if and only if $\\Delta U\\le 0$, otherwise reject, because uphill moves would violate energy conservation in the canonical ensemble.**\nThis option presents two fundamental errors. First, the acceptance rule $A=1$ for $\\Delta U \\le 0$ and $A=0$ for $\\Delta U > 0$ will not sample the canonical distribution. It is a greedy algorithm that only accepts energy-lowering or energy-neutral moves, which leads the system to a local energy minimum rather than exploring the full state space according to the Boltzmann distribution. Second, the justification is based on a profound misunderstanding of the canonical ensemble. The NVT ensemble describes a system in thermal equilibrium with a heat bath, allowing for energy exchange. The system's energy $U$ is not conserved; it fluctuates. Energy conservation is the defining characteristic of the microcanonical (NVE) ensemble, not the canonical ensemble. Uphill moves ($\\Delta U > 0$) are essential for correctly sampling the thermal fluctuations characteristic of the canonical ensemble.\nVerdict: **Incorrect**.", "answer": "$$\\boxed{A}$$", "id": "2463730"}]}