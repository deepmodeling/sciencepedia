{"hands_on_practices": [{"introduction": "The harmonic oscillator model provides the foundation for understanding the vibrational contributions to molecular thermodynamics. This practice applies this core concept to a polyatomic molecule, guiding you to derive the total vibrational entropy from a given set of vibrational frequencies and their degeneracies. By treating each vibrational mode as an independent quantum harmonic oscillator, you will reinforce the principle that for independent subsystems, the total entropy is the sum of the individual entropies, a cornerstone of statistical thermodynamics [@problem_id:2023555].", "problem": "In computational chemistry, the thermodynamic properties of a molecule can be predicted from its quantum mechanical structure. A key component of this calculation is the vibrational contribution, which is often modeled by treating each vibrational normal mode as an independent quantum harmonic oscillator.\n\nConsider the benzene molecule, $C_6H_6$. As a non-linear molecule with 12 atoms, it has 30 vibrational modes. A computational analysis has determined the frequencies of these modes. Due to the molecule's symmetry, many modes share the same frequency (i.e., they are degenerate). The distinct vibrational wavenumbers, $\\tilde{\\nu}_i$, and their corresponding degeneracies, $g_i$, are provided below:\n- $g_1$ modes with wavenumber $\\tilde{\\nu}_1$\n- $g_2$ modes with wavenumber $\\tilde{\\nu}_2$\n- $g_3$ modes with wavenumber $\\tilde{\\nu}_3$\n- ...and so on for all distinct modes.\n\nAssuming each vibrational mode is an independent quantum harmonic oscillator, derive a symbolic expression for the total vibrational entropy, $S_v$, of a single benzene molecule at a given absolute temperature $T$.\n\nYour final answer should be a single, closed-form analytic expression, expressed as a sum over the index $i$ representing the distinct vibrational modes. The expression must be in terms of the temperature $T$, the degeneracies $\\{g_i\\}$, the wavenumbers $\\{\\tilde{\\nu}_i\\}$, the speed of light $c$, Planck's constant $h$, and the Boltzmann constant $k_B$.", "solution": "We treat each vibrational normal mode as an independent quantum harmonic oscillator. For a single quantum harmonic oscillator of frequency $\\nu$, the energy levels are $E_{n} = h \\nu \\left(n + \\frac{1}{2}\\right)$ with $n \\in \\{0,1,2,\\ldots\\}$. At temperature $T$, with $\\beta \\equiv \\frac{1}{k_{B} T}$, the canonical partition function is\n$$\nZ = \\sum_{n=0}^{\\infty} \\exp\\!\\left(-\\beta h \\nu \\left(n + \\frac{1}{2}\\right)\\right)\n= \\exp\\!\\left(-\\frac{1}{2}\\beta h \\nu\\right) \\sum_{n=0}^{\\infty} \\left(\\exp(-\\beta h \\nu)\\right)^{n}\n= \\frac{\\exp\\!\\left(-\\frac{1}{2}\\beta h \\nu\\right)}{1 - \\exp(-\\beta h \\nu)}.\n$$\nThe Helmholtz free energy is\n$$\nF = -k_{B} T \\ln Z = -k_{B} T \\left[-\\frac{1}{2}\\beta h \\nu - \\ln\\!\\left(1 - \\exp(-\\beta h \\nu)\\right)\\right]\n= \\frac{1}{2}h \\nu + k_{B} T \\ln\\!\\left(1 - \\exp(-\\beta h \\nu)\\right).\n$$\nThe vibrational entropy for this mode is $S = - \\left(\\frac{\\partial F}{\\partial T}\\right)$ at fixed volume. Differentiating the expression for $F$ with respect to $T$ and using $x \\equiv \\beta h \\nu = \\frac{h \\nu}{k_{B} T}$, we obtain\n$$\nS = - \\left[ k_{B} \\ln\\!\\left(1 - \\exp(-x)\\right) + k_{B} T \\frac{\\partial}{\\partial T} \\ln\\!\\left(1 - \\exp(-x)\\right) \\right].\n$$\nSince $x = \\frac{h \\nu}{k_{B} T}$, we have $\\frac{d x}{d T} = -\\frac{x}{T}$ and\n$$\n\\frac{\\partial}{\\partial T} \\ln\\!\\left(1 - \\exp(-x)\\right)\n= \\frac{\\exp(-x)}{1 - \\exp(-x)} \\frac{d x}{d T}\n= -\\frac{x}{T} \\frac{1}{\\exp(x) - 1}.\n$$\nSubstituting this derivative yields\n$$\nS = - k_{B} \\ln\\!\\left(1 - \\exp(-x)\\right) + k_{B} \\frac{x}{\\exp(x) - 1}.\n$$\nFor a vibrational mode specified by a wavenumber $\\tilde{\\nu}$, the frequency is $\\nu = c \\tilde{\\nu}$ and hence $x = \\frac{h c \\tilde{\\nu}}{k_{B} T}$. Therefore, the vibrational entropy contribution of one mode with wavenumber $\\tilde{\\nu}$ is\n$$\nS(\\tilde{\\nu}, T) = k_{B} \\left[ \\frac{\\frac{h c \\tilde{\\nu}}{k_{B} T}}{\\exp\\!\\left(\\frac{h c \\tilde{\\nu}}{k_{B} T}\\right) - 1} - \\ln\\!\\left(1 - \\exp\\!\\left(-\\frac{h c \\tilde{\\nu}}{k_{B} T}\\right)\\right) \\right].\n$$\nFor benzene, the distinct vibrational wavenumbers are $\\{\\tilde{\\nu}_{i}\\}$ with degeneracies $\\{g_{i}\\}$, and the modes are independent. Entropy is additive for independent subsystems at a common temperature, so the total vibrational entropy for a single molecule is the sum over all distinct modes weighted by degeneracy:\n$$\nS_{v}(T) = \\sum_{i} g_{i} \\, S(\\tilde{\\nu}_{i}, T)\n= k_{B} \\sum_{i} g_{i} \\left[ \\frac{\\frac{h c \\tilde{\\nu}_{i}}{k_{B} T}}{\\exp\\!\\left(\\frac{h c \\tilde{\\nu}_{i}}{k_{B} T}\\right) - 1} - \\ln\\!\\left(1 - \\exp\\!\\left(-\\frac{h c \\tilde{\\nu}_{i}}{k_{B} T}\\right)\\right) \\right].\n$$\nThis expression depends only on $T$, $\\{g_{i}\\}$, $\\{\\tilde{\\nu}_{i}\\}$, $c$, $h$, and $k_{B}$, as required. The zero-point energy $\\frac{1}{2} h c \\tilde{\\nu}_{i}$ cancels out of the entropy, as seen in the derivation.", "answer": "$$\\boxed{k_{B} \\sum_{i} g_{i} \\left[ \\frac{\\frac{h c \\tilde{\\nu}_{i}}{k_{B} T}}{\\exp\\!\\left(\\frac{h c \\tilde{\\nu}_{i}}{k_{B} T}\\right) - 1} - \\ln\\!\\left(1 - \\exp\\!\\left(-\\frac{h c \\tilde{\\nu}_{i}}{k_{B} T}\\right)\\right) \\right]}$$", "id": "2023555"}, {"introduction": "While invaluable, the harmonic model is an idealization; real molecular potentials exhibit anharmonicity. This practice introduces a perturbative method to account for small deviations from the ideal harmonic potential by including a cubic term. You will calculate the first-order correction to the average particle position, a direct consequence of this anharmonicity, offering insight into physical phenomena like thermal expansion [@problem_id:2015523]. This exercise develops crucial skills in applying approximation techniques within the framework of classical statistical mechanics.", "problem": "A single classical particle of mass $m$ moves in one dimension under the influence of a potential $V(x) = \\frac{1}{2} k x^2 + \\alpha x^3$. The parameter $k$ is the spring constant of the harmonic part of the potential, and $\\alpha$ is a small constant representing a weak anharmonicity. The particle is in thermal equilibrium with a heat bath at a constant absolute temperature $T$.\n\nCalculate the thermal average position of the particle, $\\langle x \\rangle$. Your calculation should be accurate to the first order in the anharmonicity parameter $\\alpha$.\n\nExpress your answer as an analytic expression in terms of $k$, $\\alpha$, $T$, and the Boltzmann constant $k_B$.", "solution": "Let $\\beta \\equiv \\frac{1}{k_{B}T}$. In the classical canonical ensemble, the momentum degree of freedom factorizes and cancels in a position average, so the thermal average of the position is determined solely by the potential:\n$$\n\\langle x \\rangle=\\frac{\\int_{-\\infty}^{\\infty} x \\exp\\!\\big(-\\beta V(x)\\big)\\,dx}{\\int_{-\\infty}^{\\infty} \\exp\\!\\big(-\\beta V(x)\\big)\\,dx},\n\\qquad\nV(x)=\\frac{1}{2}k x^{2}+\\alpha x^{3}.\n$$\nTreating $\\alpha$ as a small parameter and expanding to first order,\n$$\n\\exp\\!\\big(-\\beta V(x)\\big)=\\exp\\!\\left(-\\beta \\frac{k}{2}x^{2}\\right)\\exp\\!\\left(-\\beta \\alpha x^{3}\\right)\n\\approx \\exp\\!\\left(-\\beta \\frac{k}{2}x^{2}\\right)\\left(1-\\beta \\alpha x^{3}\\right).\n$$\nTherefore,\n$$\n\\langle x \\rangle \\approx \\frac{\\int x \\exp\\!\\left(-\\beta \\frac{k}{2}x^{2}\\right)\\left(1-\\beta \\alpha x^{3}\\right)\\,dx}{\\int \\exp\\!\\left(-\\beta \\frac{k}{2}x^{2}\\right)\\left(1-\\beta \\alpha x^{3}\\right)\\,dx}.\n$$\nDefine $a\\equiv \\frac{\\beta k}{2}$. Using the parity of the integrands,\n$$\n\\int_{-\\infty}^{\\infty} x \\exp(-a x^{2})\\,dx=0,\\qquad \\int_{-\\infty}^{\\infty} x^{3} \\exp(-a x^{2})\\,dx=0,\n$$\nso to first order in $\\alpha$ the denominator is unchanged and the numerator reduces to\n$$\n-\\beta \\alpha \\int_{-\\infty}^{\\infty} x^{4} \\exp(-a x^{2})\\,dx.\n$$\nHence,\n$$\n\\langle x \\rangle \\approx -\\beta \\alpha \\frac{\\int_{-\\infty}^{\\infty} x^{4} \\exp(-a x^{2})\\,dx}{\\int_{-\\infty}^{\\infty} \\exp(-a x^{2})\\,dx}.\n$$\nThe required Gaussian integrals are\n$$\n\\int_{-\\infty}^{\\infty} \\exp(-a x^{2})\\,dx=\\frac{\\sqrt{\\pi}}{\\sqrt{a}},\\qquad\n\\int_{-\\infty}^{\\infty} x^{4} \\exp(-a x^{2})\\,dx=\\frac{3\\sqrt{\\pi}}{4 a^{5/2}},\n$$\nso their ratio is\n$$\n\\frac{\\int x^{4} \\exp(-a x^{2})\\,dx}{\\int \\exp(-a x^{2})\\,dx}=\\frac{3}{4 a^{2}}.\n$$\nSubstituting $a=\\frac{\\beta k}{2}$ yields\n$$\n\\langle x \\rangle \\approx -\\beta \\alpha \\cdot \\frac{3}{4}\\cdot \\frac{4}{\\beta^{2} k^{2}}=-\\frac{3\\alpha}{\\beta k^{2}}=-\\frac{3 \\alpha k_{B} T}{k^{2}},\n$$\nwhich is accurate to first order in $\\alpha$.", "answer": "$$\\boxed{-\\frac{3 \\alpha k_{B} T}{k^{2}}}$$", "id": "2015523"}, {"introduction": "For large-amplitude motions, such as the internal rotation of a methyl group, the harmonic approximation is not merely inaccurate but qualitatively wrong. This advanced computational problem addresses such a scenario by treating the motion as a hindered rotor governed by a periodic potential. You will numerically solve the Schr√∂dinger equation to obtain the \"exact\" energy levels and partition function, then compare this rigorous result to the flawed prediction of the harmonic model [@problem_id:2824222]. This exercise provides a quantitative understanding of the limits of the harmonic approximation and highlights the necessity of more sophisticated models for describing molecular flexibility.", "problem": "You are asked to implement a numerical comparison between a quantum mechanical hindered internal rotor and its harmonic-mode approximation at room temperature. The internal coordinate is an angular torsion described by an angle $\\theta$ in radians with $0 \\le \\theta < 2\\pi$. The system has a periodic potential and a rigid moment of inertia. Your task is to compute the dimensionless canonical partition function of the hindered rotor from first principles and compare it to the harmonic-mode partition function obtained by a quadratic expansion of the potential around a minimum.\n\nFundamental base to use:\n- The canonical partition function for a system with discrete quantum energy levels $\\{E_j\\}$ is $q = \\sum_{j=0}^{\\infty} \\exp(-\\beta E_j)$ with $\\beta = 1/(k_\\mathrm{B} T)$, where $k_\\mathrm{B}$ is the Boltzmann constant and $T$ is the absolute temperature.\n- The one-dimensional quantum Hamiltonian in an angular coordinate $\\theta$ for a rigid rotor with moment of inertia $I$ in a potential $V(\\theta)$ is $\\hat{H} = - \\dfrac{\\hbar^2}{2 I} \\dfrac{d^2}{d\\theta^2} + V(\\theta)$, subject to $2\\pi$-periodic boundary conditions in $\\theta$.\n- The harmonic-mode approximation is obtained by expanding the potential to second order around a minimum and modeling the motion as a one-dimensional quantum harmonic oscillator with frequency $\\omega$. For a harmonic oscillator with angular frequency $\\omega$, energy levels are $E_n = \\hbar \\omega \\left(n + \\dfrac{1}{2}\\right)$, $n \\in \\mathbb{N}_0$, which implies the partition function $q_\\mathrm{harm} = \\dfrac{\\exp(-\\beta \\hbar \\omega/2)}{1 - \\exp(-\\beta \\hbar \\omega)}$.\n\nSystem definition:\n- Consider the $n$-fold periodic cosine potential\n$$\nV(\\theta) = \\frac{V_0}{2}\\left[1 - \\cos(n \\theta)\\right],\n$$\nwith period $2\\pi$ and minima at $\\theta = \\dfrac{2\\pi k}{n}$ for integers $k$. The barrier height between adjacent minima is $V_0$.\n- The harmonic angular frequency near a minimum is defined from the curvature $k_\\theta = \\left.\\dfrac{d^2 V}{d\\theta^2}\\right|_{\\theta_\\text{min}}$ and the kinetic term $\\dfrac{1}{2} I \\dot{\\theta}^2$ as\n$$\n\\omega = \\sqrt{\\frac{k_\\theta}{I}} = \\sqrt{\\frac{n^2 V_0}{2 I}}.\n$$\n- To approximate the full torsional mode by harmonic wells when the barrier is large relative to $k_\\mathrm{B} T$, multiply the single-well harmonic partition function by the number of equivalent minima $n$, giving $q_{\\mathrm{harm,\\,total}} = n \\, q_\\mathrm{harm}$.\n\nNumerical method for the hindered rotor:\n- Discretize $\\theta$ on a uniform grid of $N_\\theta$ points on $[0, 2\\pi)$ with $2\\pi$-periodic boundary conditions. Use $N_\\theta = 256$.\n- Approximate the second derivative by the standard second-order central finite difference with periodic wrap-around. If $h = \\dfrac{2\\pi}{N_\\theta}$ is the grid spacing, then the discrete operator for $\\dfrac{d^2}{d\\theta^2}$ is represented by a circulant matrix with diagonal entries $-2/h^2$, nearest off-diagonal entries $1/h^2$, and corner entries $1/h^2$ to enforce periodicity.\n- Construct the Hamiltonian matrix $H = - \\dfrac{\\hbar^2}{2 I} D^{(2)} + \\mathrm{diag}(V(\\theta_i))$, diagonalize it to obtain eigenvalues $\\{E_j\\}$, and evaluate\n$$\nq_\\mathrm{HR} = \\sum_{j=0}^{N_\\theta - 1} \\exp(-\\beta E_j),\n$$\nas an accurate approximation to the exact $q$ at temperature $T$.\n\nConstants and units:\n- Use $T = 298\\,\\mathrm{K}$.\n- Use $k_\\mathrm{B} = 1.380\\,649 \\times 10^{-23}\\,\\mathrm{J\\,K^{-1}}$ and $\\hbar = 1.054\\,571\\,817 \\times 10^{-34}\\,\\mathrm{J\\,s}$.\n- All energies, including $V_0$ and eigenvalues $E_j$, must be in $\\mathrm{J}$ per molecule. The moment of inertia $I$ must be in $\\mathrm{kg\\,m^2}$. The angle $\\theta$ must be in radians.\n\nWhat to compute and compare:\n- For each test case, compute the hindered rotor partition function $q_\\mathrm{HR}$ numerically as described.\n- Compute the harmonic-mode partition function $q_{\\mathrm{harm,\\,total}} = n \\, \\dfrac{\\exp(-\\beta \\hbar \\omega/2)}{1 - \\exp(-\\beta \\hbar \\omega)}$, where $\\omega = \\sqrt{ \\dfrac{n^2 V_0}{2 I} }$.\n- For each test case, output the ratio\n$$\nR = \\frac{q_\\mathrm{HR}}{q_{\\mathrm{harm,\\,total}}}.\n$$\n\nTest suite:\n- Use the following four test cases, each specified as $(V_0, I, n)$:\n  - Case $1$: $V_0 = 1.0 \\times 10^{-22}\\,\\mathrm{J}$, $I = 5.0 \\times 10^{-47}\\,\\mathrm{kg\\,m^2}$, $n = 3$.\n  - Case $2$: $V_0 = 4.0 \\times 10^{-21}\\,\\mathrm{J}$, $I = 5.0 \\times 10^{-47}\\,\\mathrm{kg\\,m^2}$, $n = 3$.\n  - Case $3$: $V_0 = 2.0 \\times 10^{-20}\\,\\mathrm{J}$, $I = 5.0 \\times 10^{-47}\\,\\mathrm{kg\\,m^2}$, $n = 3$.\n  - Case $4$: $V_0 = 2.0 \\times 10^{-20}\\,\\mathrm{J}$, $I = 5.0 \\times 10^{-47}\\,\\mathrm{kg\\,m^2}$, $n = 1$.\n\nRequired final output format:\n- Your program should produce a single line of output containing the four ratios for the test suite as a comma-separated list enclosed in square brackets, with each ratio rounded to exactly six digits after the decimal point. For example, a sample output would look like this\n$$\n[\\text{r}_1,\\text{r}_2,\\text{r}_3,\\text{r}_4],\n$$\nwhere each $\\text{r}_i$ is a floating-point number with six digits after the decimal point and no spaces anywhere in the line.", "solution": "The problem presented is a standard exercise in quantum statistical mechanics, requiring the numerical comparison of two models for internal rotation in a molecule: the full quantum hindered rotor and its simplified harmonic-mode approximation. The problem is scientifically sound, well-posed, and contains all necessary information for its resolution. We will therefore proceed with a complete solution.\n\nThe objective is to compute the ratio $R = q_\\mathrm{HR} / q_{\\mathrm{harm,\\,total}}$ for several test cases, where $q_\\mathrm{HR}$ is the canonical partition function of a one-dimensional hindered rotor and $q_{\\mathrm{harm,\\,total}}$ is the partition function of its harmonic oscillator approximation.\n\nFirst, we define the thermal energy factor $\\beta = (k_\\mathrm{B} T)^{-1}$, where $k_\\mathrm{B}$ is the Boltzmann constant and $T$ is the absolute temperature. For the given temperature $T = 298\\,\\mathrm{K}$, and using the provided constant $k_\\mathrm{B} = 1.380\\,649 \\times 10^{-23}\\,\\mathrm{J\\,K^{-1}}$, we find $\\beta \\approx 2.431\\,66 \\times 10^{20}\\,\\mathrm{J}^{-1}$.\n\n**1. The Hindered Rotor Partition Function ($q_\\mathrm{HR}$)**\n\nThe quantum mechanical motion of the internal rotor is governed by the one-dimensional Schr√∂dinger equation, $\\hat{H}\\psi(\\theta) = E\\psi(\\theta)$, with the Hamiltonian operator:\n$$\n\\hat{H} = - \\frac{\\hbar^2}{2I} \\frac{d^2}{d\\theta^2} + V(\\theta)\n$$\nHere, $\\hbar$ is the reduced Planck constant, $I$ is the moment of inertia, $\\theta$ is the torsional angle, and $V(\\theta)$ is the periodic potential given by:\n$$\nV(\\theta) = \\frac{V_0}{2}\\left[1 - \\cos(n \\theta)\\right]\n$$\nwhere $V_0$ is the barrier height and $n$ is the periodicity. The wavefunction $\\psi(\\theta)$ must satisfy $2\\pi$-periodic boundary conditions, $\\psi(\\theta) = \\psi(\\theta + 2\\pi)$.\n\nTo solve for the energy eigenvalues $\\{E_j\\}$, we employ a numerical finite difference method. The angular coordinate $\\theta \\in [0, 2\\pi)$ is discretized into a uniform grid of $N_\\theta = 256$ points: $\\theta_i = i \\cdot h$ for $i=0, 1, \\dots, N_\\theta-1$, with grid spacing $h = 2\\pi/N_\\theta$.\n\nThe second derivative operator $\\frac{d^2}{d\\theta^2}$ is approximated by a matrix $\\mathbf{D}^{(2)}$. Using the second-order central difference formula with periodic boundary conditions, the elements of this $N_\\theta \\times N_\\theta$ matrix are:\n$$\n(\\mathbf{D}^{(2)})_{ij} = \\frac{1}{h^2} \\begin{cases} -2 & \\text{if } i=j \\\\ 1 & \\text{if } |i-j|=1 \\\\ 1 & \\text{if } \\{i,j\\} = \\{0, N_\\theta-1\\} \\\\ 0 & \\text{otherwise} \\end{cases}\n$$\nThis is a symmetric circulant matrix. The kinetic energy operator becomes the matrix $\\mathbf{T} = -\\frac{\\hbar^2}{2I}\\mathbf{D}^{(2)}$. The potential energy operator becomes a diagonal matrix $\\mathbf{V}$ with elements $(\\mathbf{V})_{ii} = V(\\theta_i)$. The total Hamiltonian is represented by the matrix:\n$$\n\\mathbf{H} = \\mathbf{T} + \\mathbf{V} = -\\frac{\\hbar^2}{2I}\\mathbf{D}^{(2)} + \\mathrm{diag}(V(\\theta_0), V(\\theta_1), \\dots, V(\\theta_{N_\\theta-1}))\n$$\nThe energy eigenvalues $\\{E_j\\}$ are found by numerically diagonalizing the real, symmetric matrix $\\mathbf{H}$. The hindered rotor partition function is then computed by summing over these $N_\\theta$ approximate eigenvalues:\n$$\nq_\\mathrm{HR} = \\sum_{j=0}^{N_\\theta-1} \\exp(-\\beta E_j)\n$$\n\n**2. The Harmonic-Mode Partition Function ($q_{\\mathrm{harm,\\,total}}$)**\n\nThe harmonic approximation models the system as a quantum harmonic oscillator in each of the potential wells. The potential has minima where $\\cos(n\\theta) = 1$, i.e., at $\\theta_\\text{min} = 2\\pi k/n$ for integer $k$. We expand $V(\\theta)$ in a Taylor series around a minimum, for instance $\\theta_\\text{min} = 0$:\n$$\nV(\\theta) \\approx V(0) + V'(0)(\\theta-0) + \\frac{1}{2}V''(0)(\\theta-0)^2\n$$\nWe find $V(0) = 0$, $V'(\\theta) = \\frac{nV_0}{2}\\sin(n\\theta) \\implies V'(0) = 0$, and the force constant (curvature) is $k_\\theta = V''(\\theta) = \\frac{n^2 V_0}{2}\\cos(n\\theta) \\implies k_\\theta = V''(0) = \\frac{n^2 V_0}{2}$. The potential is approximated as $V(\\theta) \\approx \\frac{1}{2}k_\\theta \\theta^2$.\n\nThis corresponds to a harmonic oscillator with angular frequency $\\omega = \\sqrt{k_\\theta/I}$. Substituting the expression for $k_\\theta$:\n$$\n\\omega = \\sqrt{\\frac{n^2 V_0}{2I}}\n$$\nThe energy levels of a quantum harmonic oscillator are $E_m = \\hbar\\omega(m + 1/2)$ for $m=0, 1, 2, \\dots$. The partition function for a single such oscillator is a geometric series:\n$$\nq_\\mathrm{harm} = \\sum_{m=0}^{\\infty} \\exp\\left[-\\beta\\hbar\\omega\\left(m + \\frac{1}{2}\\right)\\right] = \\exp(-\\beta\\hbar\\omega/2) \\sum_{m=0}^{\\infty} (\\exp(-\\beta\\hbar\\omega))^m = \\frac{\\exp(-\\beta\\hbar\\omega/2)}{1 - \\exp(-\\beta\\hbar\\omega)}\n$$\nSince the potential $V(\\theta)$ has $n$ equivalent minima in the interval $[0, 2\\pi)$, we multiply the single-well partition function by $n$ to obtain the total harmonic-mode partition function, assuming the barrier $V_0$ is large enough to consider the wells independent:\n$$\nq_{\\mathrm{harm,\\,total}} = n \\cdot q_\\mathrm{harm}\n$$\n\n**3. The Ratio**\n\nFor each test case specified by $(V_0, I, n)$, we compute both $q_\\mathrm{HR}$ and $q_{\\mathrm{harm,\\,total}}$ using the methods and constants described above. The final result is their ratio:\n$$\nR = \\frac{q_\\mathrm{HR}}{q_{\\mathrm{harm,\\,total}}}\n$$\nThis ratio quantifies the deviation of the true quantum system from its harmonic approximation. A ratio of $R \\approx 1$ indicates the harmonic approximation is accurate, which is expected for high potential barriers ($V_0 \\gg k_\\mathrm{B}T$). For low barriers ($V_0 \\ll k_\\mathrm{B}T$), the system approaches a free rotor, and the harmonic approximation, based on localized wells, is expected to fail, leading to significant deviation from $R=1$.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the ratio of the hindered rotor and harmonic oscillator\n    partition functions for several test cases.\n    \"\"\"\n    # Define physical constants and temperature\n    K_B = 1.380649e-23  # Boltzmann constant in J/K\n    HBAR = 1.054571817e-34 # Reduced Planck constant in J.s\n    T = 298.0  # Temperature in K\n    BETA = 1.0 / (K_B * T)  # Inverse thermal energy in 1/J\n\n    # Numerical grid parameters\n    N_THETA = 256\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (V0 in J, I in kg.m^2, n)\n        (1.0e-22, 5.0e-47, 3), # Case 1\n        (4.0e-21, 5.0e-47, 3), # Case 2\n        (2.0e-20, 5.0e-47, 3), # Case 3\n        (2.0e-20, 5.0e-47, 1), # Case 4\n    ]\n\n    results = []\n    for V0, I, n in test_cases:\n        # --- 1. Hindered Rotor Partition Function (q_HR) Computation ---\n\n        # Discretize the angular coordinate\n        h_theta = 2.0 * np.pi / N_THETA\n        theta_grid = np.linspace(0, 2.0 * np.pi, N_THETA, endpoint=False)\n\n        # Construct the potential energy matrix (diagonal)\n        potential_vector = 0.5 * V0 * (1.0 - np.cos(n * theta_grid))\n        V_matrix = np.diag(potential_vector)\n\n        # Construct the kinetic energy matrix (second derivative)\n        D2 = np.zeros((N_THETA, N_THETA))\n        diag_val = -2.0 / h_theta**2\n        offdiag_val = 1.0 / h_theta**2\n        \n        # Fill diagonal and off-diagonals\n        np.fill_diagonal(D2, diag_val)\n        D2 += np.diag(np.full(N_THETA - 1, offdiag_val), k=1)\n        D2 += np.diag(np.full(N_THETA - 1, offdiag_val), k=-1)\n        \n        # Periodic boundary conditions (corner elements)\n        D2[0, N_THETA - 1] = offdiag_val\n        D2[N_THETA - 1, 0] = offdiag_val\n\n        # Kinetic energy matrix\n        T_matrix = - (HBAR**2 / (2.0 * I)) * D2\n\n        # Construct the full Hamiltonian matrix\n        H_matrix = T_matrix + V_matrix\n\n        # Diagonalize the Hamiltonian to find energy eigenvalues\n        # np.linalg.eigh is used as the matrix is real and symmetric\n        eigenvalues = np.linalg.eigh(H_matrix)[0]\n\n        # Compute the partition function from eigenvalues\n        q_hr = np.sum(np.exp(-BETA * eigenvalues))\n\n        # --- 2. Harmonic-Mode Partition Function (q_harm_total) Computation ---\n\n        # If V0 is zero, the harmonic approximation is ill-defined.\n        # This problem has V0 > 0, so no special handling is needed.\n        # Calculate harmonic angular frequency omega\n        omega = np.sqrt((n**2 * V0) / (2.0 * I))\n\n        # Calculate the single-well harmonic partition function\n        x = BETA * HBAR * omega\n        q_harm = np.exp(-x / 2.0) / (1.0 - np.exp(-x))\n\n        # Total partition function is n times the single-well function\n        q_harm_total = n * q_harm\n\n        # --- 3. Compute and store the ratio ---\n        ratio = q_hr / q_harm_total\n        results.append(f\"{ratio:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "2824222"}]}