{"hands_on_practices": [{"introduction": "Liouville's theorem can feel abstract, stating that the phase-space distribution function is constant along the trajectories of the system. This exercise makes the concept tangible by exploring its geometric consequence: the incompressibility of phase-space volume. By tracking a simple rectangular area in the phase space of a one-dimensional harmonic oscillator, you will explicitly calculate its deformation over time and verify that its area remains constant, providing a concrete, visual understanding of the theorem's core principle. [@problem_id:98440]", "problem": "A classical system consisting of a particle of mass $m$ is constrained to move in one dimension under the influence of a harmonic potential $V(q) = \\frac{1}{2}m\\omega^2q^2$. The state of the system is described by a point $(q, p)$ in a two-dimensional phase space, where $q$ is the position and $p$ is the momentum. The time evolution of the system is governed by the Hamiltonian $H(q, p) = \\frac{p^2}{2m} + \\frac{1}{2}m\\omega^2q^2$.\n\nConsider an ensemble of such systems. At time $t=0$, the states of this ensemble occupy a rectangular region in phase space defined by the four vertices with coordinates $(q_a, p_a)$, $(q_b, p_a)$, $(q_b, p_b)$, and $(q_a, p_b)$, where $q_b > q_a$ and $p_b > p_a$. Let the area of this initial region be $A_0$.\n\nAs time progresses, each point in this region evolves according to Hamilton's equations. Consequently, the rectangular region will deform. Let $A(t)$ be the area of this deformed region at a time $t > 0$.\n\nBy explicitly calculating the time evolution of the vertices of the rectangle, determine the value of the ratio $\\frac{A(t)}{A_0}$.", "solution": "The Hamiltonian for the system is given by:\n\n$$\nH(q, p) = \\frac{p^2}{2m} + \\frac{1}{2} m \\omega^2 q^2\n$$\n\nHamilton's equations of motion are:\n\n$$\n\\dot{q} = \\frac{\\partial H}{\\partial p} = \\frac{p}{m}, \\quad \\dot{p} = -\\frac{\\partial H}{\\partial q} = -m \\omega^2 q\n$$\n\nThe solutions to these equations are:\n\n$$\nq(t) = q(0) \\cos(\\omega t) + \\frac{p(0)}{m \\omega} \\sin(\\omega t)\n$$\n\n\n$$\np(t) = p(0) \\cos(\\omega t) - m \\omega q(0) \\sin(\\omega t)\n$$\n\nThis can be expressed in matrix form as:\n\n$$\n\\begin{pmatrix} q(t) \\\\ p(t) \\end{pmatrix} = \\begin{pmatrix} \\cos(\\omega t) & \\frac{\\sin(\\omega t)}{m \\omega} \\\\ -m \\omega \\sin(\\omega t) & \\cos(\\omega t) \\end{pmatrix} \\begin{pmatrix} q(0) \\\\ p(0) \\end{pmatrix}\n$$\n\nThe initial rectangular region in phase space has vertices at $(q_a, p_a)$, $(q_b, p_a)$, $(q_b, p_b)$, and $(q_a, p_b)$, with $q_b > q_a$ and $p_b > p_a$. The initial area is:\n\n$$\nA_0 = (q_b - q_a)(p_b - p_a)\n$$\n\nApplying the time evolution to each vertex:\n\n- Vertex at $(q_a, p_a)$:\n  \n$$\n  q_1'(t) = q_a \\cos(\\omega t) + \\frac{p_a}{m \\omega} \\sin(\\omega t), \\quad p_1'(t) = -m \\omega q_a \\sin(\\omega t) + p_a \\cos(\\omega t)\n  $$\n\n\n- Vertex at $(q_b, p_a)$:\n  \n$$\n  q_2'(t) = q_b \\cos(\\omega t) + \\frac{p_a}{m \\omega} \\sin(\\omega t), \\quad p_2'(t) = -m \\omega q_b \\sin(\\omega t) + p_a \\cos(\\omega t)\n  $$\n\n\n- Vertex at $(q_b, p_b)$:\n  \n$$\n  q_3'(t) = q_b \\cos(\\omega t) + \\frac{p_b}{m \\omega} \\sin(\\omega t), \\quad p_3'(t) = -m \\omega q_b \\sin(\\omega t) + p_b \\cos(\\omega t)\n  $$\n\n\n- Vertex at $(q_a, p_b)$:\n  \n$$\n  q_4'(t) = q_a \\cos(\\omega t) + \\frac{p_b}{m \\omega} \\sin(\\omega t), \\quad p_4'(t) = -m \\omega q_a \\sin(\\omega t) + p_b \\cos(\\omega t)\n  $$\n\n\nThe transformed region is a parallelogram. To find its area, consider vectors from the vertex at $(q_a, p_a)$ to $(q_b, p_a)$ and from $(q_a, p_a)$ to $(q_a, p_b)$:\n\n- Vector $\\vec{v}_1$ from $(q_1', p_1')$ to $(q_2', p_2')$:\n  \n$$\n  \\Delta q_1 = q_2' - q_1' = (q_b - q_a) \\cos(\\omega t), \\quad \\Delta p_1 = p_2' - p_1' = -m \\omega (q_b - q_a) \\sin(\\omega t)\n  $$\n\n\n- Vector $\\vec{v}_2$ from $(q_1', p_1')$ to $(q_4', p_4')$:\n  \n$$\n  \\Delta q_2 = q_4' - q_1' = \\frac{(p_b - p_a)}{m \\omega} \\sin(\\omega t), \\quad \\Delta p_2 = p_4' - p_1' = (p_b - p_a) \\cos(\\omega t)\n  $$\n\n\nThe area of the parallelogram is the magnitude of the cross product:\n\n$$\nA(t) = \\left| \\Delta q_1 \\Delta p_2 - \\Delta p_1 \\Delta q_2 \\right|\n$$\n\nSubstituting the expressions:\n\n$$\n\\Delta q_1 \\Delta p_2 = (q_b - q_a) \\cos(\\omega t) \\cdot (p_b - p_a) \\cos(\\omega t) = (q_b - q_a)(p_b - p_a) \\cos^2(\\omega t)\n$$\n\n\n$$\n\\Delta p_1 \\Delta q_2 = [-m \\omega (q_b - q_a) \\sin(\\omega t)] \\cdot \\left[ \\frac{(p_b - p_a)}{m \\omega} \\sin(\\omega t) \\right] = - (q_b - q_a)(p_b - p_a) \\sin^2(\\omega t)\n$$\n\nThus,\n\n$$\n\\Delta q_1 \\Delta p_2 - \\Delta p_1 \\Delta q_2 = (q_b - q_a)(p_b - p_a) \\cos^2(\\omega t) - \\left[ - (q_b - q_a)(p_b - p_a) \\sin^2(\\omega t) \\right] = (q_b - q_a)(p_b - p_a) [\\cos^2(\\omega t) + \\sin^2(\\omega t)] = (q_b - q_a)(p_b - p_a)\n$$\n\nSince $q_b > q_a$ and $p_b > p_a$, the expression is positive, so:\n\n$$\nA(t) = (q_b - q_a)(p_b - p_a)\n$$\n\nThe area at time $t$ is equal to the initial area:\n\n$$\nA(t) = A_0\n$$\n\nTherefore, the ratio is:\n\n$$\n\\frac{A(t)}{A_0} = 1\n$$\n\nThis result is consistent with Liouville's theorem, which states that the phase space area is conserved under Hamiltonian dynamics.", "answer": "$$ \\boxed{1} $$", "id": "98440"}, {"introduction": "The conservation of phase-space volume is a special property of Hamiltonian systems. To deepen our understanding, it is instructive to explore what happens when this condition is not met, as is the case in systems with dissipation. This practice examines coupled, damped harmonic oscillators, a model for systems that lose energy to their environment, and asks you to calculate the rate at which their phase-space volume contracts, a direct violation of Liouville's theorem. [@problem_id:1250887]", "problem": "In classical mechanics, the state of a system with $N$ degrees of freedom is described by a point in a $2N$-dimensional phase space. For a general dynamical system described by the first-order equations $\\dot{\\mathbf{z}} = \\mathbf{F}(\\mathbf{z})$, where $\\mathbf{z}=(q_1, \\dots, q_N, p_1, \\dots, p_N)$ are the phase space coordinates, the fractional rate of change of an infinitesimal phase space volume element $dV$ is given by the divergence of the phase space flow vector $\\mathbf{F}$:\n$$\n\\frac{1}{dV}\\frac{d(dV)}{dt} = \\nabla \\cdot \\mathbf{F} = \\sum_{i=1}^{N} \\left( \\frac{\\partial \\dot{q}_i}{\\partial q_i} + \\frac{\\partial \\dot{p}_i}{\\partial p_i} \\right)\n$$\nFor Hamiltonian systems, this divergence is always zero (Liouville's theorem), signifying the conservation of phase space volume. However, for dissipative systems, the volume can contract or expand.\n\nConsider a system of two coupled, damped harmonic oscillators moving in one dimension. Particle 1 has mass $m_1$ and is attached to a fixed wall by a spring of constant $k_1$. Particle 2 has mass $m_2$ and is attached to another fixed wall by a spring of constant $k_2$. The two particles are coupled to each other by a spring of constant $k_c$. Each particle experiences a linear viscous damping force, characterized by coefficients $\\Gamma_1$ and $\\Gamma_2$ respectively. The equations of motion for the positions of the particles, $x_1(t)$ and $x_2(t)$, are:\n$$\nm_1\\ddot{x}_1 + \\Gamma_1 \\dot{x}_1 + k_1 x_1 + k_c(x_1 - x_2) = 0\n$$\n$$\nm_2\\ddot{x}_2 + \\Gamma_2 \\dot{x}_2 + k_2 x_2 + k_c(x_2 - x_1) = 0\n$$\nThe phase space for this system is four-dimensional, with coordinates $(x_1, x_2, p_1, p_2)$, where $p_1 = m_1 \\dot{x}_1$ and $p_2 = m_2 \\dot{x}_2$ are the canonical momenta.\n\nCalculate the fractional rate of change of the phase space volume, $\\frac{1}{V}\\frac{dV}{dt}$, for this system.", "solution": "1. Define canonical momenta $p_i=m_i\\dot x_i$. The first-order system is\n$$\n\\dot x_1=\\frac{p_1}{m_1},\\quad\n\\dot x_2=\\frac{p_2}{m_2},\n$$\n$$\n\\dot p_1=-\\frac{\\Gamma_1}{m_1}p_1-(k_1+k_c)x_1+k_cx_2,\n\\quad\n\\dot p_2=-\\frac{\\Gamma_2}{m_2}p_2-(k_2+k_c)x_2+k_cx_1.\n$$\n\n2. The divergence in phase space is\n$$\n\\nabla\\cdot\\mathbf F\n=\\frac{\\partial\\dot x_1}{\\partial x_1}\n+\\frac{\\partial\\dot x_2}{\\partial x_2}\n+\\frac{\\partial\\dot p_1}{\\partial p_1}\n+\\frac{\\partial\\dot p_2}{\\partial p_2}.\n$$\n\n3. Compute each term:\n$$\n\\frac{\\partial\\dot x_1}{\\partial x_1}=0,\\quad\n\\frac{\\partial\\dot x_2}{\\partial x_2}=0,\n$$\n$$\n\\frac{\\partial\\dot p_1}{\\partial p_1}=-\\frac{\\Gamma_1}{m_1},\\quad\n\\frac{\\partial\\dot p_2}{\\partial p_2}=-\\frac{\\Gamma_2}{m_2}.\n$$\n\n4. Summing yields\n$$\n\\frac1V\\frac{dV}{dt}\n=-\\frac{\\Gamma_1}{m_1}-\\frac{\\Gamma_2}{m_2}.\n$$", "answer": "$$\\boxed{-\\!\\bigl(\\tfrac{\\Gamma_1}{m_1}+\\tfrac{\\Gamma_2}{m_2}\\bigr)}$$", "id": "1250887"}, {"introduction": "The principles of Hamiltonian mechanics have profound implications for computational chemistry, particularly in molecular dynamics simulations where we approximate continuous time evolution with discrete steps. This advanced exercise bridges theory and practice by comparing a 'naive' numerical integrator (explicit Euler) with a structure-preserving symplectic integrator. By analyzing how each method transforms a phase-space area over a single timestep, you will discover why symplectic algorithms are essential for maintaining the physical fidelity of long-term simulations, directly connecting the abstract concept of phase-space conservation to the stability and accuracy of computational models. [@problem_id:2783804]", "problem": "A single normal mode of a polyatomic molecule can be modeled as a one-dimensional harmonic oscillator with Hamiltonian $H(q,p) = \\frac{p^{2}}{2 m} + \\frac{1}{2} k q^{2}$, where $q$ is the mass-weighted coordinate, $p$ is its conjugate momentum, $m$ is the effective mass, and $k$ is the force constant. The exact Hamiltonian flow generated by Hamilton's equations preserves phase-space volume according to Liouville's theorem.\n\nConsider two discrete-time integrators that advance the state by a timestep $h$ starting from $(q_{n},p_{n})$ to $(q_{n+1},p_{n+1})$:\n\n- The explicit Euler method defined by applying the right-hand sides of Hamilton's equations at $(q_{n},p_{n})$ to update $(q,p)$ over one step.\n\n- The symplectic Euler method in the kick-drift variant, defined by first updating the momentum using the force at $(q_{n},p_{n})$ and then updating the coordinate using the new momentum.\n\nTreat each one-step update as a differentiable map $(q_{n},p_{n}) \\mapsto (q_{n+1},p_{n+1})$, and let the phase-space volume change factor be the determinant of the Jacobian matrix of this map. Starting from Hamilton's equations as the fundamental base, derive for each integrator the linear map associated with one step and compute its Jacobian determinant (the area scaling in the two-dimensional phase space). Then, define the contrast ratio\n$$\nR \\equiv \\frac{\\text{(phase-space volume change factor for explicit Euler in one step)}}{\\text{(phase-space volume change factor for symplectic Euler in one step)}}.\n$$\nExpress $R$ in closed form in terms of $h$, $m$, and $k$. Your final answer must be a single analytic expression. Do not include units in your final answer. No numerical rounding is required.", "solution": "The problem requires an analysis of two numerical integration schemes for a one-dimensional harmonic oscillator and a comparison of their effect on phase-space volume. A rigorous approach demands that we begin from the fundamental equations of motion.\n\nThe system is described by the Hamiltonian:\n$$ H(q,p) = \\frac{p^{2}}{2m} + \\frac{1}{2} k q^{2} $$\nwhere $q$ is the generalized coordinate, $p$ is the conjugate momentum, $m$ is the effective mass, and $k$ is the force constant. The continuous-time evolution of the system is governed by Hamilton's equations:\n$$ \\dot{q} = \\frac{\\partial H}{\\partial p} = \\frac{p}{m} $$\n$$ \\dot{p} = -\\frac{\\partial H}{\\partial q} = -kq $$\nWe will discretize these equations using a timestep $h$ to define the one-step maps $(q_n, p_n) \\mapsto (q_{n+1}, p_{n+1})$ for each specified integrator. The change in phase-space area is given by the determinant of the Jacobian matrix of this map.\n\nFirst, we analyze the explicit Euler method. This method approximates the state at time $t_{n+1} = t_n + h$ by using the derivatives evaluated at the current state $(q_n, p_n)$. The update rules are:\n$$ q_{n+1} = q_n + h \\dot{q}(q_n, p_n) = q_n + h \\frac{p_n}{m} $$\n$$ p_{n+1} = p_n + h \\dot{p}(q_n, p_n) = p_n - h k q_n $$\nThis transformation from $(q_n, p_n)$ to $(q_{n+1}, p_{n+1})$ is a linear map. We can express it in matrix form:\n$$ \\begin{pmatrix} q_{n+1} \\\\ p_{n+1} \\end{pmatrix} = \\begin{pmatrix} 1 & \\frac{h}{m} \\\\ -hk & 1 \\end{pmatrix} \\begin{pmatrix} q_n \\\\ p_n \\end{pmatrix} $$\nThe Jacobian matrix of this map, which we denote as $J_{EE}$, is the matrix of the linear transformation itself:\n$$ J_{EE} = \\frac{\\partial(q_{n+1}, p_{n+1})}{\\partial(q_n, p_n)} = \\begin{pmatrix} \\frac{\\partial q_{n+1}}{\\partial q_n} & \\frac{\\partial q_{n+1}}{\\partial p_n} \\\\ \\frac{\\partial p_{n+1}}{\\partial q_n} & \\frac{\\partial p_{n+1}}{\\partial p_n} \\end{pmatrix} = \\begin{pmatrix} 1 & \\frac{h}{m} \\\\ -hk & 1 \\end{pmatrix} $$\nThe phase-space volume change factor for the explicit Euler method is the determinant of this Jacobian:\n$$ \\det(J_{EE}) = (1)(1) - \\left(\\frac{h}{m}\\right)(-hk) = 1 + \\frac{h^2 k}{m} $$\n\nNext, we analyze the symplectic Euler method in its kick-drift variant. The procedure is sequential.\nFirst, the momentum is updated (the \"kick\") using the force evaluated at the current position $q_n$:\n$$ p_{n+1} = p_n + h \\dot{p}(q_n) = p_n - hk q_n $$\nSecond, the position is updated (the \"drift\") using the *newly computed* momentum $p_{n+1}$:\n$$ q_{n+1} = q_n + h \\dot{q}(p_{n+1}) = q_n + h \\frac{p_{n+1}}{m} $$\nTo find the single map from $(q_n, p_n)$ to $(q_{n+1}, p_{n+1})$, we substitute the expression for $p_{n+1}$ from the first step into the second step:\n$$ q_{n+1} = q_n + \\frac{h}{m} (p_n - hk q_n) = \\left(1 - \\frac{h^2 k}{m}\\right) q_n + \\frac{h}{m} p_n $$\nThe complete map is thus:\n$$ q_{n+1} = \\left(1 - \\frac{h^2 k}{m}\\right) q_n + \\frac{h}{m} p_n $$\n$$ p_{n+1} = -hk q_n + p_n $$\nAgain, this is a linear map. The Jacobian matrix, $J_{SE}$, is:\n$$ J_{SE} = \\frac{\\partial(q_{n+1}, p_{n+1})}{\\partial(q_n, p_n)} = \\begin{pmatrix} 1 - \\frac{h^2 k}{m} & \\frac{h}{m} \\\\ -hk & 1 \\end{pmatrix} $$\nThe phase-space volume change factor for the symplectic Euler method is the determinant of this matrix:\n$$ \\det(J_{SE}) = \\left(1 - \\frac{h^2 k}{m}\\right)(1) - \\left(\\frac{h}{m}\\right)(-hk) = 1 - \\frac{h^2 k}{m} + \\frac{h^2 k}{m} = 1 $$\nThis result, a determinant of exactly $1$, confirms the defining property of a symplectic integrator: it preserves phase-space volume exactly at the discrete level, a feature it shares with the exact continuous flow.\n\nFinally, we compute the contrast ratio $R$ as defined in the problem statement:\n$$ R \\equiv \\frac{\\text{(phase-space volume change factor for explicit Euler in one step)}}{\\text{(phase-space volume change factor for symplectic Euler in one step)}} = \\frac{\\det(J_{EE})}{\\det(J_{SE})} $$\nSubstituting the derived determinants:\n$$ R = \\frac{1 + \\frac{h^2 k}{m}}{1} = 1 + \\frac{h^2 k}{m} $$\nThis expression reveals that the explicit Euler method causes an artificial increase in phase-space volume at each step, proportional to the square of the timestep $h$. The symplectic Euler method, by contrast, exactly preserves the volume. This demonstrates the superior qualitative behavior of symplectic integrators for long-time simulations of Hamiltonian systems.", "answer": "$$\n\\boxed{1 + \\frac{h^2 k}{m}}\n$$", "id": "2783804"}]}