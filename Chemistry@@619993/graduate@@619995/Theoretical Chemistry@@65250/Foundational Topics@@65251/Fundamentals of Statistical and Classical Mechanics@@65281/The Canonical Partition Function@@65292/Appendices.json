{"hands_on_practices": [{"introduction": "We begin our hands-on exploration by constructing the canonical partition function from first principles. This fundamental exercise [@problem_id:1996263] focuses on a system of distinguishable, non-interacting particles, allowing us to apply two core concepts: defining the single-particle partition function, $z$, by summing over its discrete energy states, and constructing the total system partition function, $Z$, through factorization. Mastering this process is the essential first step toward analyzing the thermodynamic properties of more complex materials.", "problem": "Consider a simplified model for defects in a crystal lattice. The system consists of $N$ identical, non-interacting defects that are fixed at specific locations within the lattice, making them distinguishable. Each defect can exist in one of two energy levels. The ground state has an energy defined as $0$. There is also an excited state with energy $\\epsilon > 0$. A quantum mechanical analysis reveals that while the ground state is non-degenerate, the excited state is doubly degenerate, meaning there are two distinct quantum states that share the same energy $\\epsilon$. The entire crystal is maintained in thermal equilibrium with a heat reservoir at a constant absolute temperature $T$.\n\nYour task is to find the canonical partition function, $Z$, for this entire system of $N$ defects. Express your answer as a closed-form analytic expression in terms of $N$, $\\epsilon$, $T$, and the Boltzmann constant, $k_B$.", "solution": "We analyze the system using the canonical ensemble. The canonical partition function for a system of distinguishable, non-interacting constituents factorizes into the product of the single-constituent partition functions. Therefore, if $z$ denotes the single-defect partition function, then the total partition function for $N$ distinguishable, non-interacting defects is given by\n$$\nZ = z^{N}.\n$$\nFor a single defect with discrete energy levels and associated degeneracies, the canonical partition function is given by the sum over all microstates,\n$$\nz = \\sum_{i} g_{i} \\exp\\left(-\\frac{E_{i}}{k_{B} T}\\right),\n$$\nwhere $g_{i}$ is the degeneracy of the level with energy $E_{i}$. In this problem, there are two energy levels: a non-degenerate ground state with $E_{0}=0$ and $g_{0}=1$, and a doubly degenerate excited state with $E_{1}=\\epsilon$ and $g_{1}=2$. Substituting these into the expression for $z$ gives\n$$\nz = 1 \\cdot \\exp\\left(-\\frac{0}{k_{B} T}\\right) + 2 \\cdot \\exp\\left(-\\frac{\\epsilon}{k_{B} T}\\right) = 1 + 2 \\exp\\left(-\\frac{\\epsilon}{k_{B} T}\\right).\n$$\nUsing the factorization property for $N$ distinguishable, non-interacting defects, the total canonical partition function is\n$$\nZ = \\left(1 + 2 \\exp\\left(-\\frac{\\epsilon}{k_{B} T}\\right)\\right)^{N}.\n$$\nThis is the required closed-form analytic expression in terms of $N$, $\\epsilon$, $T$, and $k_{B}$.", "answer": "$$\\boxed{\\left(1 + 2 \\exp\\left(-\\frac{\\epsilon}{k_{B} T}\\right)\\right)^{N}}$$", "id": "1996263"}, {"introduction": "Building on the discrete-state model, we now turn to a classical system with continuous degrees of freedom. This practice [@problem_id:488837] introduces the classical partition function as a phase-space integral over the system's Hamiltonian, $H(p,x)$. You will employ perturbation theory to tackle a common challenge in realistic systems—anharmonicity—by calculating the first-order correction to the partition function of a simple harmonic oscillator, a widely applicable and powerful approximation technique.", "problem": "A single classical particle of mass $m$ is constrained to move in one dimension under the influence of a symmetric anharmonic potential given by\n$$V(x) = \\frac{1}{2} m\\omega^2 x^2 + \\frac{1}{4} \\lambda x^4$$\nwhere $\\omega$ is the angular frequency of the corresponding harmonic oscillator, and $\\lambda$ is a small positive parameter representing the strength of the anharmonicity. The particle is in thermal equilibrium with a heat bath at a constant temperature $T$.\n\nThe classical canonical partition function $Z$ for a single particle in one dimension is defined by the phase-space integral:\n$$Z = \\frac{1}{h} \\int_{-\\infty}^{\\infty} dp \\int_{-\\infty}^{\\infty} dx \\, e^{-\\beta H(p,x)}$$\nwhere $p$ is the momentum, $x$ is the position, $H(p,x)$ is the Hamiltonian of the system, $\\beta = 1/(k_B T)$ with $k_B$ being the Boltzmann constant, and $h$ is Planck's constant.\n\nAssuming the anharmonic term $\\frac{1}{4}\\lambda x^4$ is a small perturbation, the total partition function can be expressed as a series expansion in $\\lambda$, $Z = Z_0 + Z_1 + O(\\lambda^2)$, where $Z_0$ is the partition function of the simple harmonic oscillator ($\\lambda=0$) and $Z_1$ is the first-order correction proportional to $\\lambda$.\n\nCalculate the first-order correction, $Z_1$, to the classical partition function for this particle.", "solution": "1.  **Write the Hamiltonian and partition-function expansion.**\n    The Hamiltonian is $H(p,x)=\\frac{p^2}{2m}+\\frac12m\\omega^2x^2+\\frac14\\lambda x^4$. The partition function is expanded as $Z=\\frac1h \\int dp dx e^{-\\beta H} =Z_0+Z_1+O(\\lambda^2)$, where $H_0=\\frac{p^2}{2m}+\\frac12m\\omega^2x^2$ is the harmonic part and the first-order correction is:\n    $$Z_1=-\\frac{\\beta\\lambda}{4}\\frac1h\\int dp dx x^4 e^{-\\beta H_0}$$\n\n2.  **Evaluate the Gaussian integrals.**\n    The momentum integral is a standard Gaussian:\n    $$\\int_{-\\infty}^\\infty dp e^{-\\beta p^2/(2m)} = \\sqrt{\\frac{2\\pi m}{\\beta}}$$\n    The position integral is a Gaussian moment. Letting $a=\\beta m\\omega^2/2$:\n    $$\\int_{-\\infty}^\\infty dx x^4e^{-a x^2} = \\frac{3\\sqrt\\pi}{4 a^{5/2}} = \\frac{3\\sqrt\\pi}{4}\\left(\\frac{2}{\\beta m\\omega^2}\\right)^{5/2}$$\n\n3.  **Assemble $Z_1$.**\n    Combining the results gives:\n    $$Z_1=-\\frac{\\beta\\lambda}{4h} \\sqrt{\\frac{2\\pi m}{\\beta}} \\frac{3\\sqrt\\pi}{4}\\left(\\frac{2}{\\beta m\\omega^2}\\right)^{5/2}$$\n\n4.  **Simplify the expression.**\n    Step-by-step simplification yields:\n    $$Z_1=-\\frac{3\\pi\\lambda}{16h} \\beta \\sqrt{\\frac{2m}{\\beta}} \\frac{2^{5/2}}{\\beta^{5/2}m^{5/2}\\omega^5} = -\\frac{3\\pi\\lambda}{16h} \\frac{\\sqrt{2m} \\cdot 4\\sqrt{2}}{\\beta^2 m^{5/2} \\omega^5} = -\\frac{3\\pi\\lambda}{2h} \\frac{\\beta^{-2}}{m^2\\omega^5}$$\n    Finally, using $\\beta = 1/(k_B T)$, so $\\beta^{-2}=(k_B T)^2$:\n    $$Z_1=-\\frac{3\\pi\\lambda(k_B T)^2}{2 h m^2\\omega^5}$$", "answer": "$$\\boxed{-\\frac{3\\pi\\lambda\\,(k_B T)^2}{2\\,h\\,m^2\\,\\omega^5}}$$", "id": "488837"}, {"introduction": "Our final practice bridges the gap between abstract theory and experimentally measurable quantities, culminating in a computational task. Here, you will derive the second virial coefficient, $B_2(T)$, which describes the leading-order deviation of a real gas from ideal behavior, directly from the partition function using the cluster expansion formalism [@problem_id:2812036]. This exercise challenges you to translate the resulting integral for a Lennard-Jones fluid into a robust numerical algorithm, providing hands-on experience in calculating macroscopic properties from microscopic interactions.", "problem": "Consider a classical three-dimensional fluid of identical particles interacting via a spherically symmetric pair potential. The canonical partition function $Q_N$ for $N$ particles in a volume $V$ at temperature $T$ can be written as a configuration integral times an ideal-gas momentum factor. Starting from this foundational representation of $Q_N$, and the virial expansion of the equation of state, derive from first principles an expression for the second virial coefficient $B_2(T)$ in terms of a one-dimensional integral over the Mayer function constructed from the pair potential. Then specialize to the Lennard-Jones (LJ) pair potential\n$$\nu(r) = 4 \\varepsilon \\left[\\left(\\frac{\\sigma}{r}\\right)^{12} - \\left(\\frac{\\sigma}{r}\\right)^6\\right],\n$$\nand reduce your expression to a dimensionless integral in terms of the reduced temperature $T^\\ast = k_{\\mathrm{B}} T / \\varepsilon$ and the reduced distance $x = r/\\sigma$, where $k_{\\mathrm{B}}$ is the Boltzmann constant. Explain why the resulting integral is absolutely convergent and identify the contributions at small and large $x$ that control its numerical convergence.\n\nDesign and implement a robust numerical quadrature to evaluate the reduced second virial coefficient $B_2^\\ast(T^\\ast) = B_2(T)/\\sigma^3$ for the Lennard-Jones potential. Your design must address the behavior near the repulsive core, the deep attractive well, and the long-range tail. To assess tail convergence explicitly, in addition to a direct finite-interval quadrature on $x \\in [0, R_c]$, include an analytic tail correction based on the leading large-$r$ behavior of $u(r)$, derived from your asymptotic analysis. Use reduced units $k_{\\mathrm{B}} = \\varepsilon = \\sigma = 1$ throughout, so that $T^\\ast = T$ and the sought quantity is $B_2^\\ast(T) = B_2(T)$ in units of $\\sigma^3$.\n\nYour program must:\n- Implement a stable one-dimensional numerical quadrature for the reduced integral over $x \\in [0, R_c]$, with two cutoffs $R_c = 6$ and $R_c = 12$ (both expressed in units of $\\sigma$).\n- Implement the analytic tail correction obtained from the leading-order asymptotic behavior of the Mayer integrand for large $x$.\n- For each test case, return four floating-point values: the direct finite-cutoff estimate at $R_c = 6$, the direct finite-cutoff estimate at $R_c = 12$, the tail-corrected estimate at $R_c = 6$, and the tail-corrected estimate at $R_c = 12$.\n\nPhysical and numerical units:\n- Report $B_2^\\ast$ in units of $\\sigma^3$ (dimensionless in reduced units), rounded to exactly $8$ digits after the decimal point.\n\nTest suite:\n- Temperatures (reduced): $T^\\ast \\in \\{0.6, 1.0, 5.0, 20.0\\}$. These cases probe a low-temperature regime where the attractive well dominates and convergence is slow, a moderate-temperature regime, an intermediate high-temperature regime, and a very high-temperature regime where $B_2^\\ast$ approaches $0$.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as an outer list of length equal to the number of test temperatures, where each inner list contains the four floats for that temperature in the order specified above. The floats must be printed with exactly $8$ digits after the decimal point. The lists must be comma-separated and there must be no spaces anywhere in the output. For example, the output structure must be of the form\nouter_list = [inner_list_for_$T_1^\\ast$, inner_list_for_$T_2^\\ast$, ...]\nwhere each inner list has the form\n[$B_{2,\\text{direct}}^\\ast(R_c=6)$, $B_{2,\\text{direct}}^\\ast(R_c=12)$, $B_{2,\\text{tail}}^\\ast(R_c=6)$, $B_{2,\\text{tail}}^\\ast(R_c=12)$]\nwith all four entries given as decimal floats rounded to $8$ decimal places. The program must not print anything else.", "solution": "The problem posed is a standard exercise in equilibrium statistical mechanics, specifically in the theory of imperfect gases. It requires the derivation and subsequent numerical evaluation of the second virial coefficient, $B_2(T)$, for a fluid whose constituent particles interact via the Lennard-Jones potential. The problem is scientifically grounded, well-posed, and contains all necessary information for a unique solution. We shall proceed by first principles.\n\nFirst, we derive the general expression for the second virial coefficient $B_2(T)$ starting from the canonical partition function $Q_N$. The pressure $P$ of a system of $N$ particles in a volume $V$ at temperature $T$ is given by the fundamental thermodynamic relation:\n$$ P = k_{\\mathrm{B}} T \\left( \\frac{\\partial \\ln Q_N}{\\partial V} \\right)_{T,N} $$\nwhere $k_{\\mathrm{B}}$ is the Boltzmann constant and $Q_N$ is the canonical partition function. For a classical system of identical, structureless particles, $Q_N$ is given by:\n$$ Q_N = \\frac{1}{N! \\Lambda^{3N}} Z_N $$\nHere, $\\Lambda = h / \\sqrt{2\\pi m k_{\\mathrm{B}} T}$ is the thermal de Broglie wavelength, which arises from the integration over momenta and is independent of volume. $Z_N$ is the configuration integral:\n$$ Z_N = \\int_V \\dots \\int_V \\exp\\left(-\\beta U(\\mathbf{r}_1, \\dots, \\mathbf{r}_N)\\right) d^3r_1 \\dots d^3r_N $$\nwith $\\beta = 1/(k_{\\mathrm{B}}T)$ and $U$ being the total potential energy. For a system with only pair interactions, $U = \\sum_{1 \\le i < j \\le N} u(r_{ij})$. The pressure is thus determined by the volume dependence of $Z_N$:\n$$ P = k_{\\mathrm{B}} T \\left( \\frac{\\partial \\ln Z_N}{\\partial V} \\right)_{T,N} $$\nThe virial equation of state expresses the compressibility factor $PV/(Nk_{\\mathrm{B}}T)$ as a power series in the number density $\\rho = N/V$:\n$$ \\frac{P V}{N k_{\\mathrm{B}} T} = 1 + B_2(T)\\rho + B_3(T)\\rho^2 + \\dots $$\nTo find $B_2(T)$, we must evaluate $Z_N$ to first order in density. This is equivalent to considering the deviation from ideal gas behavior due to pairwise interactions. We use the cluster expansion formalism, introducing the Mayer function $f_{ij} = e^{-\\beta u(r_{ij})} - 1$. The configuration integral becomes:\n$$ Z_N = \\int_V \\dots \\int_V \\prod_{1 \\le i < j \\le N} (1 + f_{ij}) d^3r_1 \\dots d^3r_N $$\nExpanding the product and retaining terms corresponding to zero or one interaction (which is sufficient for the low-density limit where the $B_2$ term dominates):\n$$ Z_N \\approx \\int_V \\dots \\int_V \\left(1 + \\sum_{1 \\le i < j \\le N} f_{ij}\\right) d^3r_1 \\dots d^3r_N $$\nThe first term gives $V^N$. There are $N(N-1)/2$ identical terms in the sum.\n$$ Z_N \\approx V^N + \\frac{N(N-1)}{2} \\int_V d^3r_1 \\dots d^3r_N \\, f_{12} $$\nThe integrations over coordinates $\\mathbf{r}_3, \\dots, \\mathbf{r}_N$ each yield a factor of $V$.\n$$ Z_N \\approx V^N + \\frac{N(N-1)}{2} V^{N-2} \\iint_V f_{12} \\, d^3r_1 d^3r_2 $$\nChanging to center-of-mass and relative coordinates, $\\mathbf{R} = (\\mathbf{r}_1 + \\mathbf{r}_2)/2$ and $\\mathbf{r} = \\mathbf{r}_2 - \\mathbf{r}_1$, the integral over $\\mathbf{R}$ gives $V$, assuming the range of the potential is much smaller than $V^{1/3}$.\n$$ Z_N \\approx V^N + \\frac{N(N-1)}{2} V^{N-1} \\int f(r) d^3r = V^N \\left(1 + \\frac{N(N-1)}{2V} \\int f(r) d^3r \\right) $$\nTaking the logarithm and using $\\ln(1+x) \\approx x$ for small $x$:\n$$ \\ln Z_N \\approx N \\ln V + \\frac{N^2}{2V} \\int f(r) d^3r \\quad (\\text{for large } N) $$\nThe pressure is then:\n$$ P = k_{\\mathrm{B}} T \\left( \\frac{N}{V} + \\frac{\\partial}{\\partial V}\\left(\\frac{N^2}{2V}\\right) \\int f(r) d^3r \\right) = k_{\\mathrm{B}} T \\left( \\rho - \\frac{\\rho^2}{2} \\int f(r) d^3r \\right) $$\nwhere $\\rho = N/V$. Comparing this to the virial expansion $P = k_{\\mathrm{B}}T(\\rho + B_2 \\rho^2 + \\dots)$, we identify the second virial coefficient:\n$$ B_2(T) = -\\frac{1}{2} \\int f(r) d^3r = -\\frac{1}{2} \\int_0^\\infty (e^{-\\beta u(r)} - 1) 4\\pi r^2 dr = -2\\pi \\int_0^\\infty (e^{-\\beta u(r)} - 1) r^2 dr $$\nThis is the required expression.\n\nNext, we specialize to the Lennard-Jones (LJ) potential $u(r) = 4\\varepsilon [(\\sigma/r)^{12} - (\\sigma/r)^6]$ and introduce reduced units. Let $x=r/\\sigma$ and $T^\\ast = k_{\\mathrm{B}}T/\\varepsilon$. The potential in reduced form is $u^\\ast(x) = u(r)/\\varepsilon = 4(x^{-12} - x^{-6})$. The argument of the exponential becomes $\\beta u(r) = u^\\ast(x)/T^\\ast$. Substituting these into the integral for $B_2(T)$:\n$$ B_2(T) = -2\\pi \\int_0^\\infty \\left( \\exp\\left[-\\frac{u^\\ast(x)}{T^\\ast}\\right] - 1 \\right) (x\\sigma)^2 d(x\\sigma) = -2\\pi\\sigma^3 \\int_0^\\infty \\left( \\exp\\left[-\\frac{u^\\ast(x)}{T^\\ast}\\right] - 1 \\right) x^2 dx $$\nThe reduced second virial coefficient is $B_2^\\ast(T^\\ast) = B_2(T)/\\sigma^3$:\n$$ B_2^\\ast(T^\\ast) = -2\\pi \\int_0^\\infty \\left( \\exp\\left[-\\frac{4}{T^\\ast}(x^{-12} - x^{-6})\\right] - 1 \\right) x^2 dx $$\nFor the convergence analysis, we examine the integrand $I(x) = (e^{-u^\\ast(x)/T^\\ast} - 1)x^2$.\nAs $x \\to 0$, the repulsive term $4x^{-12}$ dominates, $u^\\ast(x) \\to +\\infty$, and $e^{-u^\\ast(x)/T^\\ast} \\to 0$. Thus, the Mayer function approaches $-1$, and the integrand behaves as $I(x) \\approx -x^2$. This is integrable at $x=0$.\nAs $x \\to \\infty$, the potential $u^\\ast(x) \\to 0$. Using the Taylor expansion $e^z-1 \\approx z$ for small $z = -u^\\ast(x)/T^\\ast$, the Mayer function becomes $e^{-u^\\ast/T^\\ast}-1 \\approx -u^\\ast/T^\\ast = -\\frac{4}{T^\\ast}(x^{-12} - x^{-6})$. The integrand behaves as $I(x) \\approx -\\frac{4}{T^\\ast}(x^{-10} - x^{-4})$. For large $x$, the dominant term is proportional to $x^{-4}$. Since $\\int^\\infty x^{-4} dx$ converges, the integral for $B_2^\\ast(T^\\ast)$ is absolutely convergent. The numerical convergence is controlled by the rapid change near the potential minimum and the slow $x^{-4}$ decay of the tail.\n\nFor the numerical implementation, we are instructed to use reduced units where $k_{\\mathrm{B}}=\\varepsilon=\\sigma=1$, so $T^\\ast=T$ and $B_2^\\ast=B_2$. The integral is split at a cutoff $R_c$.\nThe direct finite-cutoff estimate is:\n$$ B_{2,\\mathrm{direct}}^\\ast(T, R_c) = -2\\pi \\int_0^{R_c} \\left( \\exp\\left[-\\frac{4}{T}(x^{-12} - x^{-6})\\right] - 1 \\right) x^2 dx $$\nThe tail correction is computed by integrating the large-$x$ approximation of the integrand from $R_c$ to $\\infty$:\n$$ \\Delta B_2^\\ast(T, R_c) = -2\\pi \\int_{R_c}^{\\infty} \\left(-\\frac{u^\\ast(x)}{T}\\right) x^2 dx = \\frac{2\\pi}{T} \\int_{R_c}^{\\infty} 4(x^{-12} - x^{-6})x^2 dx $$\n$$ \\Delta B_2^\\ast(T, R_c) = \\frac{8\\pi}{T} \\int_{R_c}^{\\infty} (x^{-10} - x^{-4}) dx = \\frac{8\\pi}{T} \\left[\\frac{x^{-9}}{-9} - \\frac{x^{-3}}{-3}\\right]_{R_c}^{\\infty} $$\n$$ \\Delta B_2^\\ast(T, R_c) = \\frac{8\\pi}{T} \\left( \\frac{1}{3}R_c^{-3} - \\frac{1}{9}R_c^{-9} \\right) $$\nThe tail-corrected estimate is the sum of the numerical integral and this analytical correction: $B_{2,\\mathrm{tail}}^\\ast(T, R_c) = B_{2,\\mathrm{direct}}^\\ast(T, R_c) + \\Delta B_2^\\ast(T, R_c)$. The numerical part will be performed using the adaptive quadrature routine `scipy.integrate.quad`, which is robust for this type of well-behaved but varied integrand.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import quad\n\ndef solve():\n    \"\"\"\n    Calculates the reduced second virial coefficient for the Lennard-Jones potential\n    at various temperatures and cutoffs, with and without tail corrections.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_temperatures = [0.6, 1.0, 5.0, 20.0]\n    cutoffs = [6.0, 12.0]\n\n    def integrand(x, T):\n        \"\"\"\n        The integrand for the reduced second virial coefficient B2_star.\n        The function is (exp(-u*(x)/T) - 1) * x^2.\n        Reduced units are used: epsilon = sigma = 1.\n        \"\"\"\n        # The x^2 term ensures the integrand is 0 at x=0.\n        if x == 0.0:\n            return 0.0\n        \n        # Calculate reduced LJ potential u*(x) = 4 * (x^-12 - x^-6)\n        # Use a stable way to compute powers to avoid re-calculation\n        x_inv6 = x**-6\n        x_inv12 = x_inv6**2\n        u_star = 4.0 * (x_inv12 - x_inv6)\n        \n        # Use np.expm1(y) for exp(y) - 1 to maintain precision for small y.\n        # This occurs at large x where u_star/T is close to zero.\n        mayer_f_term = np.expm1(-u_star / T)\n        \n        return mayer_f_term * x**2\n\n    def analytical_tail_correction(Rc, T):\n        \"\"\"\n        Calculates the leading-order analytical tail correction for the B2_star integral\n        for x > Rc.\n        Formula: (8*pi/T) * ( (1/3)*Rc^-3 - (1/9)*Rc^-9 )\n        \"\"\"\n        Rc_inv3 = Rc**-3\n        Rc_inv9 = Rc_inv3**3\n        \n        correction = (8.0 * np.pi / T) * ((1.0 / 3.0) * Rc_inv3 - (1.0 / 9.0) * Rc_inv9)\n        return correction\n\n    all_results = []\n    \n    for T_star in test_temperatures:\n        \n        results_for_T = []\n        \n        # Calculate direct and corrected values for each cutoff\n        b2_direct_6, err_6 = quad(integrand, 0, cutoffs[0], args=(T_star,))\n        b2_direct_6 *= -2.0 * np.pi\n        \n        b2_direct_12, err_12 = quad(integrand, 0, cutoffs[1], args=(T_star,))\n        b2_direct_12 *= -2.0 * np.pi\n        \n        tail_corr_6 = analytical_tail_correction(cutoffs[0], T_star)\n        tail_corr_12 = analytical_tail_correction(cutoffs[1], T_star)\n        \n        b2_tail_corrected_6 = b2_direct_6 + tail_corr_6\n        b2_tail_corrected_12 = b2_direct_12 + tail_corr_12\n        \n        # Assemble the results in the required order:\n        # [direct_Rc=6, direct_Rc=12, tail_corrected_Rc=6, tail_corrected_Rc=12]\n        results_for_T.append(b2_direct_6)\n        results_for_T.append(b2_direct_12)\n        results_for_T.append(b2_tail_corrected_6)\n        results_for_T.append(b2_tail_corrected_12)\n        \n        all_results.append(results_for_T)\n\n    # Format the final output string exactly as specified:\n    # A list of lists, with numbers formatted to 8 decimal places,\n    # and no spaces.\n    inner_strings = []\n    for res_list in all_results:\n        formatted_vals = [f\"{val:.8f}\" for val in res_list]\n        inner_strings.append(f\"[{','.join(formatted_vals)}]\")\n    \n    final_output = f\"[{','.join(inner_strings)}]\"\n\n    # Final print statement in the exact required format.\n    print(final_output)\n\nsolve()\n```", "id": "2812036"}]}