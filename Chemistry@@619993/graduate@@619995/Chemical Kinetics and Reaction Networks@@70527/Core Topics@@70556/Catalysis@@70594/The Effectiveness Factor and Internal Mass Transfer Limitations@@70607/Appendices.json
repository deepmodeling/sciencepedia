{"hands_on_practices": [{"introduction": "The journey into understanding internal mass transfer begins with mastering its mathematical description. This foundational exercise guides you through deriving the effectiveness factor, $\\eta$, from first principles for a first-order reaction in three canonical catalyst geometries. By solving the steady-state reaction-diffusion balance, you will build the essential analytical models that connect the physical properties of a catalyst system, encapsulated by the Thiele modulus $\\phi$, to its overall performance.", "problem": "An isothermal, porous catalyst pellet carries an irreversible, first-order reaction of species $A$ with intrinsic rate $-r_{A} = k\\,C_{A}$, where $k$ is the intrinsic rate constant and $C_{A}$ is the pore-phase concentration. Inside the pellet, mass transport of $A$ occurs by diffusion with constant effective diffusivity $D_{e}$. External mass transfer resistance is negligible so that the pore-phase concentration at the external surface equals the surrounding fluid concentration $C_{s}$. Assume steady state, constant properties, and no bulk flow within the pores.\n\nStarting from a local species balance that combines Fick’s law of diffusion with reaction at steady state, derive closed-form, analytical expressions for the internal effectiveness factor $\\eta$ for the following canonical pellet geometries:\n- an infinite slab of half-thickness $L$,\n- an infinitely long cylinder of radius $R$,\n- a sphere of radius $R$.\n\nImpose the symmetry condition at the centerline/axis/origin as appropriate and the Dirichlet boundary condition $C_{A} = C_{s}$ at the external surface. Define the Thiele modulus $\\phi$ by $\\phi = L\\sqrt{k/D_{e}}$ for the slab and $\\phi = R\\sqrt{k/D_{e}}$ for the cylinder and the sphere. Define the internal effectiveness factor as\n$$\n\\eta \\equiv \\frac{\\text{actual total reaction rate within the pellet}}{\\text{total reaction rate if }C_{A} \\equiv C_{s}\\text{ everywhere in the pellet}}.\n$$\n\nYour derivations must begin from the steady-state species balance and appropriate boundary conditions for each geometry, and proceed by solving the governing boundary-value problem and integrating to obtain the total reaction rate. Express your final results for the slab, cylinder, and sphere, respectively, as a single row vector in terms of $\\phi$. If special functions arise, they must be standard, named special functions. The final answer must be a single closed-form analytic expression without units. Do not round.", "solution": "The problem as stated is valid. It is a well-posed, scientifically grounded problem in chemical reaction engineering that admits a unique and meaningful solution. It is free of contradictions, ambiguities, and factual errors. We shall proceed with the derivation.\n\nThe fundamental principle is the local species balance for component $A$ at steady state within the porous catalyst. The general balance equation states that the rate of generation of species $A$ per unit volume must balance the divergence of its flux. Given a consumption reaction with rate $-r_{A}$, the generation rate is $r_{A}$. The balance is:\n$$ \\nabla \\cdot \\vec{N}_A + (-r_A) = 0 $$\nwhere $\\vec{N}_A$ is the molar flux of $A$. With mass transport occurring only by diffusion and no bulk flow, Fick's first law describes the flux:\n$$ \\vec{N}_A = -D_e \\nabla C_A $$\nThe reaction is first-order, so $-r_A = k C_A$. Substituting these expressions into the species balance, and assuming the effective diffusivity $D_e$ is constant, we obtain the governing second-order partial differential equation:\n$$ -D_e \\nabla^2 C_A + k C_A = 0 \\quad \\implies \\quad \\nabla^2 C_A - \\frac{k}{D_e} C_A = 0 $$\nWe will now solve this equation for each of the three specified geometries. To generalize, we introduce dimensionless variables for concentration, $\\psi = C_A/C_s$, and for the spatial coordinate. The Thiele modulus, $\\phi$, will emerge naturally from this non-dimensionalization.\n\nThe internal effectiveness factor, $\\eta$, is defined as the ratio of the actual total reaction rate to the rate that would occur if the entire interior of the pellet were at the surface concentration $C_s$.\n$$ \\eta = \\frac{\\int_{V_p} (-r_A) dV}{\\int_{V_p} (-r_A)|_{C_A=C_s} dV} = \\frac{\\int_{V_p} k C_A dV}{k C_s V_p} = \\frac{1}{V_p} \\int_{V_p} \\frac{C_A}{C_s} dV = \\frac{1}{V_p} \\int_{V_p} \\psi dV $$\nThis shows that $\\eta$ is the volume-averaged dimensionless concentration.\n\nCase 1: Infinite Slab of Half-Thickness $L$\nFor an infinite slab, transport is one-dimensional. Let $x$ be the coordinate measured from the center of the slab. The domain is $x \\in [-L, L]$. The Laplacian operator is $\\nabla^2 = \\frac{d^2}{dx^2}$. The governing equation is:\n$$ D_e \\frac{d^2 C_A}{dx^2} - k C_A = 0 $$\nBy symmetry, we solve on the domain $x \\in [0, L]$ with boundary conditions:\n1. Symmetry at the center: $\\frac{dC_A}{dx} = 0$ at $x=0$.\n2. Surface concentration: $C_A = C_s$ at $x=L$.\n\nLet $z = x/L$. The dimensionless equation becomes:\n$$ \\frac{d^2 \\psi}{dz^2} - \\left(\\frac{k L^2}{D_e}\\right) \\psi = 0 \\quad \\implies \\quad \\frac{d^2 \\psi}{dz^2} - \\phi^2 \\psi = 0 $$\nwhere $\\phi = L\\sqrt{k/D_e}$. The dimensionless boundary conditions are $\\frac{d\\psi}{dz}=0$ at $z=0$ and $\\psi=1$ at $z=1$.\nThe general solution to this ordinary differential equation (ODE) is $\\psi(z) = A \\cosh(\\phi z) + B \\sinh(\\phi z)$.\nApplying the symmetry condition at $z=0$: $\\frac{d\\psi}{dz}|_{z=0} = A\\phi \\sinh(0) + B\\phi \\cosh(0) = B\\phi = 0$, which implies $B=0$.\nApplying the surface condition at $z=1$: $\\psi(1) = A \\cosh(\\phi) = 1$, which implies $A = 1/\\cosh(\\phi)$.\nThe concentration profile is therefore:\n$$ \\psi(z) = \\frac{\\cosh(\\phi z)}{\\cosh(\\phi)} $$\nThe effectiveness factor is the volume average of $\\psi$. For a slab of cross-sectional area $A_{cs}$, the volume is $V_p = 2LA_{cs}$ and $dV = A_{cs}dx$.\n$$ \\eta_{slab} = \\frac{1}{L} \\int_0^L \\psi(x/L) dx = \\int_0^1 \\psi(z) dz = \\int_0^1 \\frac{\\cosh(\\phi z)}{\\cosh(\\phi)} dz $$\n$$ \\eta_{slab} = \\frac{1}{\\cosh(\\phi)} \\left[ \\frac{\\sinh(\\phi z)}{\\phi} \\right]_0^1 = \\frac{\\sinh(\\phi)}{\\phi \\cosh(\\phi)} = \\frac{\\tanh(\\phi)}{\\phi} $$\n\nCase 2: Infinitely Long Cylinder of Radius $R$\nFor a cylinder with radial diffusion, the Laplacian in cylindrical coordinates is $\\nabla^2 = \\frac{1}{r}\\frac{d}{dr}\\left(r\\frac{d}{dr}\\right)$. The governing equation is:\n$$ \\frac{D_e}{r} \\frac{d}{dr}\\left(r \\frac{dC_A}{dr}\\right) - k C_A = 0 $$\nThe domain is $r \\in [0, R]$ with boundary conditions:\n1. Symmetry at the axis: $\\frac{dC_A}{dr} = 0$ at $r=0$.\n2. Surface concentration: $C_A = C_s$ at $r=R$.\n\nLet $\\rho = r/R$. The dimensionless equation is:\n$$ \\frac{1}{\\rho} \\frac{d}{d\\rho}\\left(\\rho \\frac{d\\psi}{d\\rho}\\right) - \\left(\\frac{k R^2}{D_e}\\right) \\psi = 0 \\quad \\implies \\quad \\frac{d^2\\psi}{d\\rho^2} + \\frac{1}{\\rho}\\frac{d\\psi}{d\\rho} - \\phi^2 \\psi = 0 $$\nwhere $\\phi = R\\sqrt{k/D_e}$. This is the modified Bessel equation of order zero. The general solution is $\\psi(\\rho) = A I_0(\\phi \\rho) + B K_0(\\phi \\rho)$, where $I_0$ and $K_0$ are modified Bessel functions of order zero.\nThe function $K_0(x)$ diverges as $x \\to 0$. For a physically bounded concentration at the cylinder axis ($\\rho=0$), we must have $B=0$.\nApplying the surface condition at $\\rho=1$: $\\psi(1) = A I_0(\\phi) = 1$, so $A = 1/I_0(\\phi)$.\nThe concentration profile is:\n$$ \\psi(\\rho) = \\frac{I_0(\\phi \\rho)}{I_0(\\phi)} $$\nThe effectiveness factor is found by integrating over the volume. For a cylinder of length $H$, $V_p = \\pi R^2 H$ and $dV = 2\\pi r H dr$.\n$$ \\eta_{cyl} = \\frac{1}{\\pi R^2 H} \\int_0^R \\psi(r/R) (2\\pi r H dr) = \\frac{2}{R^2} \\int_0^R r \\psi(r/R) dr = 2 \\int_0^1 \\rho \\psi(\\rho) d\\rho $$\n$$ \\eta_{cyl} = 2 \\int_0^1 \\rho \\frac{I_0(\\phi \\rho)}{I_0(\\phi)} d\\rho = \\frac{2}{I_0(\\phi)} \\int_0^1 \\rho I_0(\\phi \\rho) d\\rho $$\nUsing the identity $\\int x I_0(ax) dx = \\frac{x}{a} I_1(ax)$, where $I_1$ is the modified Bessel function of the first kind, order one:\n$$ \\int_0^1 \\rho I_0(\\phi \\rho) d\\rho = \\left[ \\frac{\\rho}{\\phi} I_1(\\phi \\rho) \\right]_0^1 = \\frac{I_1(\\phi)}{\\phi} $$\nSubstituting this back gives the effectiveness factor for the cylinder:\n$$ \\eta_{cyl} = \\frac{2}{I_0(\\phi)} \\frac{I_1(\\phi)}{\\phi} = \\frac{2 I_1(\\phi)}{\\phi I_0(\\phi)} $$\n\nCase 3: Sphere of Radius $R$\nFor a sphere with radial diffusion, the Laplacian is $\\nabla^2 = \\frac{1}{r^2}\\frac{d}{dr}\\left(r^2\\frac{d}{dr}\\right)$. The governing equation is:\n$$ \\frac{D_e}{r^2} \\frac{d}{dr}\\left(r^2 \\frac{dC_A}{dr}\\right) - k C_A = 0 $$\nThe domain is $r \\in [0, R]$ with boundary conditions:\n1. Symmetry at the center: $\\frac{dC_A}{dr} = 0$ at $r=0$.\n2. Surface concentration: $C_A = C_s$ at $r=R$.\n\nLet $\\rho = r/R$. The dimensionless equation is:\n$$ \\frac{1}{\\rho^2} \\frac{d}{d\\rho}\\left(\\rho^2 \\frac{d\\psi}{d\\rho}\\right) - \\phi^2 \\psi = 0 $$\nwhere $\\phi = R\\sqrt{k/D_e}$. We use the substitution $u(\\rho) = \\rho \\psi(\\rho)$, which transforms the ODE to:\n$$ \\frac{d^2 u}{d\\rho^2} - \\phi^2 u = 0 $$\nThe general solution is $u(\\rho) = A \\sinh(\\phi \\rho) + B \\cosh(\\phi \\rho)$. Thus, $\\psi(\\rho) = \\frac{A \\sinh(\\phi \\rho) + B \\cosh(\\phi \\rho)}{\\rho}$.\nAt the center ($\\rho \\to 0$), the concentration must be finite. As $\\rho \\to 0$, $\\psi(\\rho) \\approx \\frac{A(\\phi \\rho) + B(1)}{\\rho} = A\\phi + B/\\rho$. Finiteness requires $B=0$.\nApplying the surface condition at $\\rho=1$: $\\psi(1) = \\frac{A \\sinh(\\phi)}{1} = 1$, so $A = 1/\\sinh(\\phi)$.\nThe concentration profile is:\n$$ \\psi(\\rho) = \\frac{\\sinh(\\phi \\rho)}{\\rho \\sinh(\\phi)} $$\nThe effectiveness factor is found by integrating over the spherical volume. Here, $V_p = \\frac{4}{3}\\pi R^3$ and $dV = 4\\pi r^2 dr$.\n$$ \\eta_{sphere} = \\frac{1}{\\frac{4}{3}\\pi R^3} \\int_0^R \\psi(r/R) (4\\pi r^2 dr) = \\frac{3}{R^3} \\int_0^R r^2 \\psi(r/R) dr = 3 \\int_0^1 \\rho^2 \\psi(\\rho) d\\rho $$\n$$ \\eta_{sphere} = 3 \\int_0^1 \\rho^2 \\left( \\frac{\\sinh(\\phi \\rho)}{\\rho \\sinh(\\phi)} \\right) d\\rho = \\frac{3}{\\sinh(\\phi)} \\int_0^1 \\rho \\sinh(\\phi \\rho) d\\rho $$\nWe integrate $\\rho \\sinh(\\phi \\rho)$ by parts: $\\int x \\sinh(ax) dx = \\frac{x}{a}\\cosh(ax) - \\frac{1}{a^2}\\sinh(ax)$.\n$$ \\int_0^1 \\rho \\sinh(\\phi \\rho) d\\rho = \\left[ \\frac{\\rho}{\\phi}\\cosh(\\phi\\rho) - \\frac{1}{\\phi^2}\\sinh(\\phi\\rho) \\right]_0^1 = \\frac{\\cosh(\\phi)}{\\phi} - \\frac{\\sinh(\\phi)}{\\phi^2} $$\nSubstituting this result:\n$$ \\eta_{sphere} = \\frac{3}{\\sinh(\\phi)} \\left( \\frac{\\cosh(\\phi)}{\\phi} - \\frac{\\sinh(\\phi)}{\\phi^2} \\right) = \\frac{3}{\\phi} \\frac{\\cosh(\\phi)}{\\sinh(\\phi)} - \\frac{3}{\\phi^2} = \\frac{3}{\\phi} \\coth(\\phi) - \\frac{3}{\\phi^2} $$\nThis can be written compactly as:\n$$ \\eta_{sphere} = \\frac{3}{\\phi^2} (\\phi \\coth(\\phi) - 1) $$\nThe three derived expressions for the effectiveness factor $\\eta$ for the slab, cylinder, and sphere, respectively, are now compiled into the final answer.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{\\tanh(\\phi)}{\\phi}  \\frac{2 I_1(\\phi)}{\\phi I_0(\\phi)}  \\frac{3}{\\phi^2}(\\phi \\coth(\\phi) - 1)\n\\end{pmatrix}\n}\n$$", "id": "2685344"}, {"introduction": "Moving from theory to practical observation, this exercise demonstrates one of the most critical consequences of severe diffusion limitation. It presents a scenario where an intrinsically first-order reaction appears to follow zero-order kinetics, a common pitfall in experimental analysis. By calculating the effectiveness factor from experimental data, you will quantify this discrepancy and solidify your understanding of how internal gradients can mask a reaction's true kinetic behavior.", "problem": "An industrial chemical engineer is investigating a new catalyst for the endothermic, irreversible gas-phase reaction $A \\to B$. The catalyst is available as spherical pellets. To characterize the system, she conducts experiments in a differential reactor operating at a constant temperature of 600 K and atmospheric pressure.\n\nFirst, to determine the intrinsic kinetics free from mass transfer limitations, she uses very fine catalyst powder (mean radius $\\approx 10 \\, \\mu\\text{m}$). The measured reaction rate per unit mass of catalyst, $(-r'_{A,obs})$, as a function of the bulk reactant concentration, $C_{A,b}$, is recorded in the table below.\n\n| Bulk Concentration $C_{A,b}$ (mol/m³) | Observed Rate $(-r'_{A,obs})$ (mol/(kg-cat·s)) |\n| :----------------------------------: | :-------------------------------------------: |\n| 10.0                                 | 0.0400                                        |\n| 20.0                                 | 0.0800                                        |\n| 30.0                                 | 0.1200                                        |\n\nNext, she tests the commercial-size spherical pellets with a radius of $R = 4.00 \\, \\text{mm}$. Due to the high reactivity and the endothermic nature of the reaction, she suspects that severe non-isothermal pore diffusion limitations might be present. The experimental data for these large pellets are as follows:\n\n| Bulk Concentration $C_{A,b}$ (mol/m³) | Observed Rate $(-r'_{A,obs})$ (mol/(kg-cat·s)) |\n| :----------------------------------: | :-------------------------------------------: |\n| 10.0                                 | 0.00550                                       |\n| 20.0                                 | 0.00580                                       |\n| 30.0                                 | 0.00595                                       |\n\nAn inexperienced technician, looking only at the second set of data, notes that the rate is nearly constant and preliminarily concludes the reaction is zero-order. The engineer, knowing the true kinetics from the powder experiment, recognizes this as a classic symptom of severe diffusion limitations.\n\nTo quantify the extent of these limitations, calculate the overall effectiveness factor, $\\eta$, for the large pellets when the bulk concentration of reactant A is $C_{A,b} = 20.0 \\, \\text{mol/m}^3$. Assume that external mass transfer resistance is negligible, meaning the concentration at the outer surface of the pellet is equal to the bulk concentration. Provide your answer as a dimensionless value rounded to three significant figures.", "solution": "The differential reactor with very fine catalyst powder removes internal diffusion limitations; with negligible external mass transfer, the observed rate per unit catalyst mass equals the intrinsic kinetic rate. From the powder data, the rate varies linearly with bulk concentration, indicating first-order kinetics:\n$$-r_{A}'=k' C_{A}.$$\nFrom any data pair (e.g., $C_{A,b}=20.0$ and $-r_{A,obs}'=0.0800$), the intrinsic mass-based rate constant is the slope:\n$$k'=\\frac{-r_{A,obs}'}{C_{A,b}}=\\frac{0.0800}{20.0}=0.004\\;\\text{m}^{3}\\,(\\text{kg-cat}\\cdot\\text{s})^{-1}.$$\n\nFor the large spherical pellets, the overall effectiveness factor is defined as the ratio of the actual observed reaction rate to the rate that would occur if the entire pellet interior were at the external surface conditions (intrinsic kinetics), with negligible external mass transfer implying $C_{A,s}=C_{A,b}$:\n$$\\eta=\\frac{-r_{A,obs}'}{-r_{A,\\text{ideal}}'}=\\frac{-r_{A,obs}'}{k' C_{A,s}}=\\frac{-r_{A,obs}'}{k' C_{A,b}}.$$\n\nAt $C_{A,b}=20.0$, the observed rate for the large pellets is $-r_{A,obs}'=0.00580$. Using $k'=0.004$,\n$$\\eta=\\frac{0.00580}{0.004\\times 20.0}=\\frac{0.00580}{0.0800}=0.0725.$$\n\nThis low value confirms severe internal (mass and thermal) limitations consistent with the endothermic, highly reactive system.", "answer": "$$\\boxed{0.0725}$$", "id": "1481280"}, {"introduction": "This practice shifts our perspective from prediction to analysis, a common task for chemical engineers. Using the analytical relationship for a spherical pellet [@problem_id:2685344], you will tackle the inverse problem: estimating the Thiele modulus and catalyst radius from a measured effectiveness factor. This computational task provides hands-on experience in applying theoretical models for practical catalyst characterization and design.", "problem": "You are to write a complete, runnable program that estimates the Thiele modulus and the pellet radius for a porous spherical catalyst pellet undergoing a first-order irreversible reaction under isothermal, steady-state conditions with intraparticle diffusion. Start from first principles: Fick’s second law for diffusion in spherical coordinates and first-order kinetics inside a sphere of radius $R$ with effective diffusivity $D_e$ and intrinsic rate constant $k$ such that the local reaction rate per unit volume is $r = k\\,c$. External mass transfer resistance is negligible, so the concentration at the external surface is equal to the surrounding fluid concentration. The intraparticle effectiveness factor $\\eta$ is defined as the ratio of the actual overall reaction rate inside the pellet to the rate that would occur if the entire pellet were at the surface concentration. The Thiele modulus $\\phi$ is the dimensionless group that compares reaction to diffusion inside the pellet. Using these fundamental definitions and equations only, you must derive a computational procedure that:\n- Uses the steady-state diffusion–reaction balance in spherical symmetry to relate the effectiveness factor $\\eta$ to the Thiele modulus $\\phi$ for a first-order reaction.\n- Uses the monotonicity of the mapping $\\phi \\mapsto \\eta$ to invert this relation numerically and recover $\\phi$ from a given measured effectiveness factor $\\eta \\in (0,1]$ for a spherical pellet, then compute $R$ from the known $k$ and $D_e$.\n- You must:\n- Compute and return $\\phi$ (dimensionless).\n- Compute and return $R$ expressed in millimeters, rounded to $6$ significant figures.\n- Round $\\phi$ to $6$ significant figures as well.\n\nPhysical units:\n- Use $k$ in $\\mathrm{s^{-1}}$ and $D_e$ in $\\mathrm{m^2\\,s^{-1}}$ as inputs.\n- Report $R$ in millimeters.\n\nTest suite:\nYour program must compute results for the following parameter sets $(\\eta, k, D_e)$:\n- Case A (happy path): $(0.35,\\; 1.2,\\; 2.5\\times 10^{-9})$.\n- Case B (near kinetic control): $(0.95,\\; 1.2,\\; 2.5\\times 10^{-9})$.\n- Case C (strong diffusion limitation): $(0.10,\\; 1.2,\\; 2.5\\times 10^{-9})$.\n- Case D (different transport and kinetics): $(0.60,\\; 0.4,\\; 8.0\\times 10^{-10})$.\n- Case E (boundary case): $(1.0,\\; 2.0,\\; 1.0\\times 10^{-9})$.\n\nAnswer specification:\n- For each test case, output a two-element list $[\\phi,\\; R_{\\mathrm{mm}}]$, where $\\phi$ is the estimated Thiele modulus and $R_{\\mathrm{mm}}$ is the pellet radius in millimeters.\n- Aggregate the results for all test cases into a single list in the same order as above.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, with each inner pair also enclosed in square brackets and no spaces. For example: $[[\\phi_1,R_{1,\\mathrm{mm}}],[\\phi_2,R_{2,\\mathrm{mm}}],\\dots]$.\n\nImportant constraints:\n- The derivation base must be the steady-state diffusion–reaction equation in spherical coordinates, Fick’s law, the first-order kinetic rate law, the boundary conditions of spherical symmetry and finite center gradient, and the definition of the Thiele modulus and effectiveness factor. Do not assume any direct “shortcut” formulas in constructing your algorithm; instead, derive the relation you need and then implement a numerical procedure suitable for inversion.\n- Express all final numerical answers in the specified units and rounded to $6$ significant figures.", "solution": "We start from the steady-state mass balance with diffusion and reaction for species with concentration $c(r)$ in a porous spherical pellet of radius $R$ with spherical symmetry. Fick’s second law at steady state with first-order kinetics gives\n$$\n0 \\;=\\; D_e \\,\\frac{1}{r^2}\\,\\frac{d}{dr}\\!\\left(r^2 \\frac{dc}{dr}\\right) \\;-\\; k\\,c,\n$$\nwith boundary conditions $dc/dr|_{r=0} = 0$ (symmetry and finite gradient at the center) and $c(R) = c_s$ (surface concentration equal to surrounding fluid due to negligible external mass transfer).\n\nIntroduce the dimensionless radial coordinate $\\rho = r/R$ and the dimensionless concentration $\\tilde{c}(\\rho) = c(r)/c_s$. Using $r = R\\rho$ and $dr = R\\,d\\rho$, the equation becomes\n$$\n0 \\;=\\; D_e \\,\\frac{1}{(R\\rho)^2}\\,\\frac{d}{d(R\\rho)}\\!\\left((R\\rho)^2 \\frac{d}{d(R\\rho)}(c_s \\tilde{c})\\right) \\;-\\; k\\,c_s \\tilde{c}.\n$$\nCarrying out the differentiation and cancellations, we obtain the standard dimensionless form\n$$\n\\frac{1}{\\rho^2}\\,\\frac{d}{d\\rho}\\!\\left(\\rho^2 \\frac{d \\tilde{c}}{d\\rho}\\right) \\;-\\; \\phi^2 \\tilde{c} \\;=\\; 0,\n$$\nwhere the Thiele modulus for a spherical pellet with a first-order reaction is defined by\n$$\n\\phi \\;=\\; R\\,\\sqrt{\\frac{k}{D_e}}.\n$$\nThe boundary conditions become $d\\tilde{c}/d\\rho|_{\\rho=0} = 0$ and $\\tilde{c}(1) = 1$.\n\nSolving this linear ordinary differential equation yields a dimensionless concentration profile that is finite at the center and satisfies the surface constraint. The general solution that is regular at $\\rho=0$ can be written using hyperbolic functions. Enforcing $\\tilde{c}(1)=1$ fixes the constant of integration and leads to an explicit concentration profile $\\tilde{c}(\\rho)$.\n\nThe intraparticle effectiveness factor $\\eta$ is defined as the ratio of the actual integrated reaction rate to the hypothetical rate if the entire pellet were at the surface concentration. For a first-order reaction, the hypothetical rate is $k\\,c_s$ times the pellet volume, while the actual rate is $k$ times the integral of $c(r)$ over the pellet volume. Thus,\n$$\n\\eta \\;=\\; \\frac{\\displaystyle \\int_0^R k\\,c(r)\\,4\\pi r^2\\,dr}{\\displaystyle k\\,c_s \\,\\frac{4\\pi R^3}{3}}\n\\;=\\; \\frac{3}{R^3}\\int_0^R \\tilde{c}(r)\\, r^2\\,dr\n\\;=\\; 3\\int_0^1 \\tilde{c}(\\rho)\\,\\rho^2\\,d\\rho.\n$$\nAlternatively, one can use the equivalent flux-based definition at the surface due to steady state:\n$$\n\\eta \\;=\\; \\frac{\\text{actual overall rate}}{\\text{hypothetical rate at }c_s}\n\\;=\\; \\frac{4\\pi R^2\\left(-D_e\\,\\frac{dc}{dr}\\big|_{r=R}\\right)}{k\\,c_s\\,\\frac{4\\pi R^3}{3}}\n\\;=\\; \\frac{3 D_e}{k R}\\left(-\\frac{1}{c_s}\\frac{dc}{dr}\\bigg|_{r=R}\\right).\n$$\nUsing the analytical solution of the dimensionless boundary value problem with the given boundary conditions, one finds a closed-form expression for the effectiveness factor of a sphere with a first-order reaction:\n$$\n\\eta(\\phi) \\;=\\; \\frac{3}{\\phi^2}\\left(\\phi\\,\\coth \\phi \\;-\\; 1\\right),\n$$\nwhere $\\coth \\phi = \\cosh \\phi / \\sinh \\phi$. This function satisfies $\\eta(0)=1$, is strictly decreasing for $\\phi0$, and tends to $0$ as $\\phi\\to\\infty$. Two asymptotic regimes are particularly useful:\n- For small $\\phi$, a series expansion yields\n$$\n\\eta(\\phi) \\;=\\; 1 \\;-\\; \\frac{\\phi^2}{15} \\;+\\; \\frac{2\\phi^4}{315} \\;+\\; \\mathcal{O}(\\phi^6).\n$$\n- For large $\\phi$, one obtains\n$$\n\\eta(\\phi) \\;=\\; \\frac{3}{\\phi} \\;-\\; \\frac{3}{\\phi^2} \\;+\\; \\mathcal{O}\\!\\left(\\frac{1}{\\phi^3}\\right).\n$$\n\nBecause $\\eta(\\phi)$ is continuous and strictly decreasing from $1$ to $0$ on $\\phi\\in[0,\\infty)$, for any measured $\\eta\\in(0,1]$ there is a unique $\\phi\\ge 0$ solving $\\eta(\\phi)=\\eta_{\\mathrm{meas}}$. Therefore, we can compute $\\phi$ by solving the scalar root-finding problem\n$$\nf(\\phi) \\;=\\; \\eta(\\phi) \\;-\\; \\eta_{\\mathrm{meas}} \\;=\\; 0,\n$$\nwith a robust bracketing method. A suitable bracket is $\\phi\\in[0,\\Phi_{\\max}]$ for a sufficiently large $\\Phi_{\\max}$ because $f(0)=1-\\eta_{\\mathrm{meas}}\\ge 0$ and $f(\\Phi_{\\max}) \\approx -\\eta_{\\mathrm{meas}}0$ for large $\\Phi_{\\max}$. The small-$\\phi$ and large-$\\phi$ asymptotics can be used to generate good initial estimates and to improve numerical stability for extreme values, though a simple adaptive bracketing strategy is sufficient.\n\nOnce $\\phi$ has been determined, the pellet radius $R$ is recovered from the definition of the Thiele modulus:\n$$\nR \\;=\\; \\phi\\,\\sqrt{\\frac{D_e}{k}},\n$$\nwhich we then express in millimeters:\n$$\nR_{\\mathrm{mm}} \\;=\\; 1000\\,R \\;=\\; 1000\\,\\phi\\,\\sqrt{\\frac{D_e}{k}}.\n$$\n\nAlgorithmic design:\n- Implement a numerically stable function for $\\eta(\\phi)$ using the closed-form expression. For very small $\\phi$ (e.g., $\\phi \\ll 1$), use the small-$\\phi$ series to avoid numerical cancellation; for general $\\phi$, use $\\eta(\\phi)=\\frac{3}{\\phi^2}\\left(\\frac{\\phi}{\\tanh \\phi}-1\\right)$, noting that $\\coth\\phi = 1/\\tanh\\phi$.\n- Given $\\eta_{\\mathrm{meas}}$, if $\\eta_{\\mathrm{meas}} \\ge 1$ within a tolerance, set $\\phi=0$ and $R=0$. Otherwise, solve $f(\\phi)=0$ with a bracketing root-finder such as the Brent method on $[10^{-12},\\Phi_{\\max}]$ with an adaptive increase of $\\Phi_{\\max}$ until $f(\\Phi_{\\max})0$.\n- Compute $R_{\\mathrm{mm}}=1000\\,\\phi\\sqrt{D_e/k}$.\n- Round both $\\phi$ and $R_{\\mathrm{mm}}$ to $6$ significant figures.\n- Apply this procedure to the specified test suite with $(\\eta, k, D_e)$ equal to $(0.35,\\,1.2,\\,2.5\\times 10^{-9})$, $(0.95,\\,1.2,\\,2.5\\times 10^{-9})$, $(0.10,\\,1.2,\\,2.5\\times 10^{-9})$, $(0.60,\\,0.4,\\,8.0\\times 10^{-10})$, and $(1.0,\\,2.0,\\,1.0\\times 10^{-9})$.\n- Output a single line containing the comma-separated list of $[\\phi,R_{\\mathrm{mm}}]$ pairs enclosed in square brackets and with no spaces.\n\nThis approach is grounded in the steady-state diffusion–reaction balance, the first-order rate law, and the definitions of the Thiele modulus and effectiveness factor. The monotonicity of $\\eta(\\phi)$ ensures a unique solution to the inversion problem for $\\phi$, and the subsequent computation of $R$ follows directly from the definition of $\\phi$.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import brentq\n\ndef spherical_eta(phi: float) - float:\n    \"\"\"\n    Effectiveness factor for a first-order reaction in a spherical pellet:\n    eta(phi) = 3/phi^2 * (phi * coth(phi) - 1)\n    Implemented with numerical safeguards for small phi.\n    \"\"\"\n    if phi  1e-8:\n        # Small-phi series expansion: eta = 1 - phi^2/15 + 2*phi^4/315 + O(phi^6)\n        # This avoids catastrophic cancellation when phi ~ 0.\n        phi2 = phi * phi\n        phi4 = phi2 * phi2\n        return 1.0 - (phi2 / 15.0) + (2.0 * phi4 / 315.0)\n    # General case: use coth(phi) = 1 / tanh(phi)\n    th = np.tanh(phi)\n    # Guard against tanh under/overflow (for very large phi, th - 1)\n    if th = 1.0:\n        # For extremely large phi, use leading asymptotic terms\n        # eta ~ 3/phi - 3/phi^2\n        return (3.0 / phi) - (3.0 / (phi * phi))\n    return (3.0 / (phi * phi)) * (phi / th - 1.0)\n\ndef invert_eta_to_phi(eta_meas: float, tol: float = 1e-12) - float:\n    \"\"\"\n    Invert eta(phi) = eta_meas to find phi = 0 for a spherical pellet.\n    Uses robust bracketing (Brent's method).\n    \"\"\"\n    if eta_meas = 1.0 - 1e-12:\n        return 0.0\n    # Define the function to find the root of\n    def f(phi):\n        return spherical_eta(phi) - eta_meas\n    # Bracket: start with a small lower bound and moderate upper bound,\n    # increase upper bound until sign change is achieved.\n    lo = 1e-12\n    hi = max(100.0, 10.0 / max(eta_meas, 1e-12))\n    flo = f(lo)  # ~ 1 - eta_meas  0\n    fhi = f(hi)\n    # Expand the upper bound if needed\n    expand_count = 0\n    while fhi = 0.0 and expand_count  100:\n        hi *= 2.0\n        fhi = f(hi)\n        expand_count += 1\n    # Now we should have flo  0 and fhi  0, suitable for brentq\n    phi_root = brentq(f, lo, hi, xtol=tol, rtol=tol, maxiter=1000)\n    return phi_root\n\ndef compute_radius_mm(phi: float, k: float, De: float) - float:\n    \"\"\"\n    Compute pellet radius R from Thiele modulus definition:\n    phi = R * sqrt(k / De)  =  R = phi * sqrt(De / k)\n    Return R in millimeters.\n    \"\"\"\n    if phi == 0.0:\n        return 0.0\n    R_m = phi * np.sqrt(De / k)\n    return 1000.0 * R_m\n\ndef format_sigfigs(x: float, sig: int = 6) - str:\n    \"\"\"\n    Format a float with a given number of significant figures,\n    stripping any trailing spaces. We avoid spaces in the final output.\n    \"\"\"\n    return f\"{x:.{sig}g}\"\n\ndef solve():\n    # Define the test cases from the problem statement: (eta, k [1/s], De [m^2/s])\n    test_cases = [\n        (0.35, 1.2, 2.5e-9),        # Case A\n        (0.95, 1.2, 2.5e-9),        # Case B\n        (0.10, 1.2, 2.5e-9),        # Case C\n        (0.60, 0.4, 8.0e-10),       # Case D\n        (1.0, 2.0, 1.0e-9),         # Case E\n    ]\n\n    results = []\n    for eta_meas, k, De in test_cases:\n        # Invert eta to get phi\n        phi = invert_eta_to_phi(eta_meas)\n        # Compute R in mm\n        R_mm = compute_radius_mm(phi, k, De)\n        # Round to 6 significant figures as strings\n        phi_s = format_sigfigs(phi, 6)\n        Rmm_s = format_sigfigs(R_mm, 6)\n        # Append formatted pair without spaces\n        results.append(f\"[{phi_s},{Rmm_s}]\")\n\n    # Final print statement in the exact required format: a single list of pairs, no spaces.\n    print(f\"[{','.join(results)}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "2648673"}]}