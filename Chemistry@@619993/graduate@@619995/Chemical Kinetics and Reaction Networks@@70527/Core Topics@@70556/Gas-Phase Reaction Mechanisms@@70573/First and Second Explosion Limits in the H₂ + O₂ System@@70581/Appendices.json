{"hands_on_practices": [{"introduction": "Understanding the first explosion limit begins with analyzing the fundamental competition between chain-branching and chain-termination reactions. This exercise uses a minimal kinetic mechanism and the steady-state approximation to derive the critical condition for explosion. By exploring the relationship between the first explosion limit pressure $P_1$ and the reactor's characteristic size $L$, you will gain hands-on experience with the core principles governing this phenomenon [@problem_id:2643058].", "problem": "Consider an isothermal, well-stirred vessel containing a premixed hydrogen–oxygen mixture at fixed composition, with mole fraction of oxygen denoted by $x_{\\mathrm{O_2}}$ and temperature $T$. The vessel has a characteristic diffusion length $L$ (slab geometry), and the net loss of hydrogen radicals at the wall is modeled as a first-order process with effective rate constant $k_w$. Assume the effective wall-loss constant scales with the mixture-averaged diffusivity $D$ as $k_w = \\alpha D / L^2$, where $\\alpha$ is a geometry-dependent constant. Treat $D$, $\\alpha$, $T$, and all elementary-kinetic parameters as constants.\n\nFor the low-pressure first explosion limit in the hydrogen–oxygen system, consider the following minimal chain mechanism with elementary mass-action kinetics:\n- Chain-branching: $\\mathrm{H} + \\mathrm{O_{2}} \\rightarrow \\mathrm{O} + \\mathrm{OH}$ with rate coefficient $k_{1}$.\n- Chain-propagation: $\\mathrm{O} + \\mathrm{H_{2}} \\rightarrow \\mathrm{OH} + \\mathrm{H}$ with rate coefficient $k_{2}$.\n- Chain-propagation: $\\mathrm{OH} + \\mathrm{H_{2}} \\rightarrow \\mathrm{H_{2}O} + \\mathrm{H}$ with rate coefficient $k_{3}$.\n- Wall loss: $\\mathrm{H} \\rightarrow \\text{wall}$ with first-order rate constant $k_w$.\n\nAssume that the radical intermediates $\\mathrm{O}$ and $\\mathrm{OH}$ obey the steady-state approximation (SSA), and that the ideal gas law holds so that the molar concentration satisfies $[\\mathrm{O_2}] = x_{\\mathrm{O_2}} P / (RT)$, where $P$ is the total pressure and $R$ is the universal gas constant. The onset of explosion may be localized by the condition that the linearized growth rate of the hydrogen radical concentration about the radical-free state changes sign.\n\nUnder these assumptions and starting only from the stated elementary steps, mass-action kinetics, the steady-state approximation, and the ideal gas law, determine the multiplicative change in the first explosion limit pressure $P_1$ when the vessel size is halved from $L$ to $L/2$. Express your final answer as a single number (no units). No numerical rounding is required.", "solution": "The problem requires the determination of the multiplicative change in the first explosion limit pressure, $P_{1}$, for the hydrogen-oxygen system when the characteristic dimension of the vessel, $L$, is halved. The analysis will proceed from the provided elementary reaction mechanism and assumptions.\n\nFirst, we establish the rate equations for the concentrations of the radical species H, O, and OH based on the principle of mass-action kinetics. The species $\\mathrm{H_{2}O}$ is a stable product and does not participate in the chain cycle, so its rate equation is not needed for the stability analysis. The concentrations of the stable reactants $\\mathrm{H_{2}}$ and $\\mathrm{O_{2}}$ are assumed to be approximately constant during the initial phase of the reaction, which is valid for determining the explosion boundary.\n\nThe rate of change of the concentrations of the radical species are:\n$$\n\\frac{d[\\mathrm{H}]}{dt} = -k_{1}[\\mathrm{O_{2}}][\\mathrm{H}] + k_{2}[\\mathrm{H_{2}}][\\mathrm{O}] + k_{3}[\\mathrm{H_{2}}][\\mathrm{OH}] - k_{w}[\\mathrm{H}]\n$$\n$$\n\\frac{d[\\mathrm{O}]}{dt} = k_{1}[\\mathrm{O_{2}}][\\mathrm{H}] - k_{2}[\\mathrm{H_{2}}][\\mathrm{O}]\n$$\n$$\n\\frac{d[\\mathrm{OH}]}{dt} = k_{1}[\\mathrm{O_{2}}][\\mathrm{H}] + k_{2}[\\mathrm{H_{2}}][\\mathrm{O}] - k_{3}[\\mathrm{H_{2}}][\\mathrm{OH}]\n$$\n\nThe problem states that the radical intermediates $\\mathrm{O}$ and $\\mathrm{OH}$ can be treated under the steady-state approximation (SSA). This implies that their rates of change are set to zero, as their concentrations adjust rapidly to any change in the concentration of the main chain carrier, $\\mathrm{H}$.\n\nApplying the SSA to $\\mathrm{O}$:\n$$\n\\frac{d[\\mathrm{O}]}{dt} \\approx 0 \\implies k_{1}[\\mathrm{O_{2}}][\\mathrm{H}] = k_{2}[\\mathrm{H_{2}}][\\mathrm{O}]\n$$\nSolving for the steady-state concentration of $\\mathrm{O}$, denoted $[\\mathrm{O}]_{ss}$:\n$$\n[\\mathrm{O}]_{ss} = \\frac{k_{1}[\\mathrm{O_{2}}][\\mathrm{H}]}{k_{2}[\\mathrm{H_{2}}]}\n$$\n\nApplying the SSA to $\\mathrm{OH}$:\n$$\n\\frac{d[\\mathrm{OH}]}{dt} \\approx 0 \\implies k_{1}[\\mathrm{O_{2}}][\\mathrm{H}] + k_{2}[\\mathrm{H_{2}}][\\mathrm{O}] - k_{3}[\\mathrm{H_{2}}][\\mathrm{OH}] = 0\n$$\nWe substitute the result from the SSA for $\\mathrm{O}$ into this equation. The term $k_{2}[\\mathrm{H_{2}}][\\mathrm{O}]$ is equal to $k_{1}[\\mathrm{O_{2}}][\\mathrm{H}]$.\n$$\nk_{1}[\\mathrm{O_{2}}][\\mathrm{H}] + k_{1}[\\mathrm{O_{2}}][\\mathrm{H}] - k_{3}[\\mathrm{H_{2}}][\\mathrm{OH}] = 0\n$$\n$$\n2k_{1}[\\mathrm{O_{2}}][\\mathrm{H}] = k_{3}[\\mathrm{H_{2}}][\\mathrm{OH}]\n$$\nSolving for the steady-state concentration of $\\mathrm{OH}$, denoted $[\\mathrm{OH}]_{ss}$:\n$$\n[\\mathrm{OH}]_{ss} = \\frac{2k_{1}[\\mathrm{O_{2}}][\\mathrm{H}]}{k_{3}[\\mathrm{H_{2}}]}\n$$\n\nNow, we substitute these steady-state expressions for $[\\mathrm{O}]_{ss}$ and $[\\mathrm{OH}]_{ss}$ back into the rate equation for $[\\mathrm{H}]$:\n$$\n\\frac{d[\\mathrm{H}]}{dt} = -k_{1}[\\mathrm{O_{2}}][\\mathrm{H}] + k_{2}[\\mathrm{H_{2}}]\\left(\\frac{k_{1}[\\mathrm{O_{2}}][\\mathrm{H}]}{k_{2}[\\mathrm{H_{2}}]}\\right) + k_{3}[\\mathrm{H_{2}}]\\left(\\frac{2k_{1}[\\mathrm{O_{2}}][\\mathrm{H}]}{k_{3}[\\mathrm{H_{2}}]}\\right) - k_{w}[\\mathrm{H}]\n$$\nThe terms involving $[\\mathrm{H_{2}}]$ cancel out:\n$$\n\\frac{d[\\mathrm{H}]}{dt} = -k_{1}[\\mathrm{O_{2}}][\\mathrm{H}] + k_{1}[\\mathrm{O_{2}}][\\mathrm{H}] + 2k_{1}[\\mathrm{O_{2}}][\\mathrm{H}] - k_{w}[\\mathrm{H}]\n$$\nSimplifying this expression yields:\n$$\n\\frac{d[\\mathrm{H}]}{dt} = \\left( 2k_{1}[\\mathrm{O_{2}}] - k_{w} \\right) [\\mathrm{H}]\n$$\nThis is a first-order linear ordinary differential equation for $[\\mathrm{H}]$. The term in the parentheses, $\\phi = 2k_{1}[\\mathrm{O_{2}}] - k_{w}$, is the net branching factor, which represents the linearized growth rate of the radical concentration.\n\nAn explosion occurs when the radical concentration grows exponentially, which corresponds to the condition $\\phi > 0$. The boundary between stable reaction ($\\phi  0$) and explosion ($\\phi > 0$) is the critical condition $\\phi = 0$. This defines the first explosion limit.\n$$\n2k_{1}[\\mathrm{O_{2}}] - k_{w} = 0\n$$\nThe rate of chain branching, represented by $2k_{1}[\\mathrm{O_{2}}]$, must equal the rate of chain termination, represented by $k_{w}$.\n\nWe are given the relationships for $[\\mathrm{O_{2}}]$ from the ideal gas law and for $k_{w}$ from the diffusion model. The first explosion limit pressure is denoted $P_{1}$.\n$$\n[\\mathrm{O_{2}}] = \\frac{x_{\\mathrm{O_{2}}}P_{1}}{RT}\n$$\n$$\nk_{w} = \\frac{\\alpha D}{L^{2}}\n$$\nSubstituting these into the explosion limit condition:\n$$\n2k_{1}\\left(\\frac{x_{\\mathrm{O_{2}}}P_{1}}{RT}\\right) - \\frac{\\alpha D}{L^{2}} = 0\n$$\nNow, we solve for the first explosion limit pressure, $P_{1}$:\n$$\n2k_{1}\\frac{x_{\\mathrm{O_{2}}}P_{1}}{RT} = \\frac{\\alpha D}{L^{2}}\n$$\n$$\nP_{1} = \\frac{\\alpha D R T}{2k_{1}x_{\\mathrm{O_{2}}} L^{2}}\n$$\nThis expression shows the dependence of the first explosion limit pressure on the system parameters. The parameters $\\alpha$, $D$, $R$, $T$, $k_{1}$, and $x_{\\mathrm{O_{2}}}$ are all stated to be constant for this problem. Therefore, we can establish a proportionality:\n$$\nP_{1} \\propto \\frac{1}{L^{2}}\n$$\nor equivalently, $P_{1}L^{2} = \\text{constant}$.\n\nWe are asked to find the multiplicative change in $P_{1}$ when the vessel size is halved. Let the initial state be $(P_{1, \\text{old}}, L_{\\text{old}})$ and the new state be $(P_{1, \\text{new}}, L_{\\text{new}})$. We have $L_{\\text{old}} = L$ and $L_{\\text{new}} = L/2$.\nFrom the relationship $P_{1}L^{2} = \\text{constant}$, we can write:\n$$\nP_{1, \\text{new}}L_{\\text{new}}^{2} = P_{1, \\text{old}}L_{\\text{old}}^{2}\n$$\nThe multiplicative change is the ratio $\\frac{P_{1, \\text{new}}}{P_{1, \\text{old}}}$:\n$$\n\\frac{P_{1, \\text{new}}}{P_{1, \\text{old}}} = \\frac{L_{\\text{old}}^{2}}{L_{\\text{new}}^{2}} = \\left(\\frac{L_{\\text{old}}}{L_{\\text{new}}}\\right)^{2}\n$$\nSubstituting the given values for the lengths:\n$$\n\\frac{P_{1, \\text{new}}}{P_{1, \\text{old}}} = \\left(\\frac{L}{L/2}\\right)^{2} = (2)^{2} = 4\n$$\nThus, halving the vessel size increases the first explosion limit pressure by a factor of $4$. This is physically consistent: a smaller vessel has a larger surface-area-to-volume ratio, which enhances the rate of radical termination at the walls. To overcome this increased termination and reach the explosion condition, a higher pressure is required to increase the rate of gas-phase branching reactions.", "answer": "$$\n\\boxed{4}\n$$", "id": "2643058"}, {"introduction": "The previous practice demonstrated the critical role of the wall-loss rate, $k_w$, in defining the first explosion limit. This problem provides a first-principles derivation of this parameter, grounding the abstract rate constant in the physical process of diffusion. By solving Fick's second law for a simple geometry, you will see how $k_w$ depends on the diffusion coefficient $D$ and system size $L$, providing a deeper understanding of heterogeneous reaction kinetics [@problem_id:2643007].", "problem": "In the study of explosion limits in the hydrogen–oxygen system, the fate of chain-carrying radicals at reactor walls is a key loss pathway. Consider a planar slab reactor of thickness $L$ (two parallel plates at $x=0$ and $x=L$), held at fixed temperature $T$ and total pressure $P$, containing a dilute radical species $X$ (for example, atomic hydrogen) that is transported by diffusion and removed solely by recombination at the walls. Assume that the radical has a binary diffusion coefficient $D(P)$ satisfying $D(P)=D_0/P$ with $D_0$ a constant at fixed $T$. The bulk has no homogeneous source or sink of $X$ on the time scale of interest.\n\nAssume that the wall removal is described by the kinetic-theory boundary condition that the diffusive flux of $X$ into each wall is proportional to its near-wall concentration,\n$$\n-D\\,\\frac{\\partial C}{\\partial n}\\bigg|_{\\text{wall}} \\,=\\, \\kappa\\, C_{\\text{wall}},\n$$\nwhere $C(x,t)$ is the number concentration of $X$, $\\partial/\\partial n$ denotes the outward normal derivative at the wall, and $\\kappa$ is an effective first-order surface rate coefficient given by $\\kappa = (\\gamma/4)\\bar{c}$ with $\\gamma$ the (dimensionless) surface reaction probability per collision and $\\bar{c}=\\sqrt{8k_B T/(\\pi m)}$ the mean thermal speed of $X$ of mass $m$.\n\nStarting from Fick’s second law and the above boundary condition, derive the effective first-order volumetric loss rate $k_w$ governing the exponential decay of a spatially averaged initial perturbation of $C(x,t)$ due solely to wall removal. Show that it can be written in the form\n$$\nk_w = \\alpha \\frac{D}{L^2},\n$$\nand define the dimensionless factor $\\alpha$ in terms of the appropriate eigenvalue condition that follows from the boundary condition. Then, evaluate $\\alpha$ explicitly in the diffusion-limited limit in which the wall acts as a perfect absorber (equivalently, the Dirichlet boundary condition $C=0$ at $x=0$ and $x=L$). State the value of $\\alpha$ as your final answer. No numerical rounding is required. The final answer should be a single number without units.", "solution": "The problem requires the derivation of the effective first-order wall loss rate, $k_w$, for a radical species $X$ in a planar slab reactor. The process is governed by diffusion and surface recombination at the walls.\n\nThe concentration of the species, $C(x,t)$, is described by Fick's second law in one dimension, as there are no homogeneous sources or sinks:\n$$\n\\frac{\\partial C}{\\partial t} = D \\frac{\\partial^2 C}{\\partial x^2}\n$$\nThe reactor domain is $x \\in [0, L]$. The problem specifies that the analysis should be performed for the diffusion-limited limit, in which the walls act as perfect absorbers. This physical condition is explicitly stated to be equivalent to the imposition of Dirichlet boundary conditions:\n$$\nC(0, t) = 0 \\quad \\text{and} \\quad C(L, t) = 0\n$$\nTo solve this partial differential equation, we use the method of separation of variables, assuming a solution of the form $C(x,t) = X(x)T(t)$. Substituting this into the governing equation and rearranging gives:\n$$\n\\frac{1}{D T(t)} \\frac{dT(t)}{dt} = \\frac{1}{X(x)} \\frac{d^2X(x)}{dx^2}\n$$\nSince the left side is a function of $t$ only and the right side is a function of $x$ only, both sides must be equal to a constant, which we denote as $-\\lambda^2$ for a physically meaningful decaying solution.\n\nThis separation yields two ordinary differential equations. The temporal equation is:\n$$\n\\frac{dT(t)}{dt} = -D \\lambda^2 T(t)\n$$\nThe solution is $T(t) = T_0 \\exp(-D\\lambda^2 t)$, where $T_0$ is a constant. This indicates that the concentration of any given spatial mode decays exponentially. The overall decay of the spatially averaged concentration, after an initial transient, is dominated by the slowest decaying mode, which corresponds to the smallest non-zero eigenvalue, $\\lambda_1$. The effective first-order volumetric loss rate is therefore given by $k_w = D\\lambda_1^2$.\n\nThe spatial equation is a Sturm-Liouville boundary value problem:\n$$\n\\frac{d^2X(x)}{dx^2} + \\lambda^2 X(x) = 0\n$$\nsubject to the boundary conditions $X(0)=0$ and $X(L)=0$. The general solution to this second-order ODE is:\n$$\nX(x) = A \\sin(\\lambda x) + B \\cos(\\lambda x)\n$$\nwhere $A$ and $B$ are constants. Applying the first boundary condition at $x=0$:\n$$\nX(0) = A \\sin(0) + B \\cos(0) = B = 0\n$$\nThis simplifies the solution to $X(x) = A \\sin(\\lambda x)$. Now, applying the second boundary condition at $x=L$:\n$$\nX(L) = A \\sin(\\lambda L) = 0\n$$\nFor a non-trivial solution ($A \\neq 0$), we must satisfy the condition:\n$$\n\\sin(\\lambda L) = 0\n$$\nThis equation holds true if $\\lambda L$ is an integer multiple of $\\pi$. Thus, the eigenvalues $\\lambda_n$ are:\n$$\n\\lambda_n L = n\\pi \\quad \\implies \\quad \\lambda_n = \\frac{n\\pi}{L}, \\quad \\text{for } n = 1, 2, 3, \\dots\n$$\nThe index $n=0$ corresponds to $\\lambda=0$, which yields the trivial solution $X(x)=0$ and is therefore excluded.\n\nThe fundamental mode of decay corresponds to the smallest eigenvalue, which occurs for $n=1$:\n$$\n\\lambda_1 = \\frac{\\pi}{L}\n$$\nThe effective wall loss rate $k_w$ is determined by this eigenvalue:\n$$\nk_w = D \\lambda_1^2 = D \\left(\\frac{\\pi}{L}\\right)^2 = \\pi^2 \\frac{D}{L^2}\n$$\nThe problem requires this rate to be expressed in the form $k_w = \\alpha \\frac{D}{L^2}$. By direct comparison of our result with this required form, we identify the dimensionless factor $\\alpha$:\n$$\n\\alpha = \\pi^2\n$$\nThis value corresponds to the squared fundamental eigenvalue of the diffusion operator in a 1D slab with Dirichlet boundary conditions, scaled by the system length $L$.", "answer": "$$\n\\boxed{\\pi^2}\n$$", "id": "2643007"}, {"introduction": "To capture the full explosion peninsula, we must also consider the second explosion limit, which arises from a pressure-dependent, gas-phase termination reaction. This computational practice moves beyond simple analytical models to the more powerful method of linear stability analysis, allowing you to map both $P_1$ and $P_2$. By comparing a basic kinetic model with a more realistic Lindemann falloff mechanism, you will explore the impact of model choice on predicting complex kinetic behavior [@problem_id:2643055].", "problem": "You must write a complete and runnable program that, at fixed temperature $T=800$ K, predicts the first and second explosion limits (pressures $P_1$ and $P_2$) for the hydrogen-oxygen system using two kinetic descriptions: a minimal $4$-step mechanism and a more detailed mechanism that accounts for pressure falloff in the three-body association reaction. Your solution must be derived from the fundamental law of mass action, the ideal gas law, and linear stability analysis of the radical pool. The goal is to determine, for each mechanism, the pressures at which the leading growth rate of the radical pool is exactly zero, indicating the boundary between decay and growth of chain reactions. You must implement a procedure that identifies the lower pressure limit $P_1$ (onset of explosion with increasing pressure) and the higher pressure limit $P_2$ (quenching of explosion due to enhanced termination with further increase of pressure). The analysis must be performed at $T=800$ K and the pressures must be expressed in pascal (Pa).\n\nThe reaction network must be expressed in terms of the radical vector $\\mathbf{r} = ([\\mathrm{H}],[\\mathrm{O}],[\\mathrm{OH}])^\\top$, and you must assume a stoichiometric hydrogen-oxygen mixture with no diluent, so that the mole fractions are $x_{\\mathrm{H_2}} = 2/3$ and $x_{\\mathrm{O_2}} = 1/3$. Under the ideal gas law, for total pressure $P$ and temperature $T$, the total molar concentration is $C_{\\mathrm{tot}} = P/(RT)$, and the species concentrations are $[\\mathrm{H_2}] = x_{\\mathrm{H_2}}C_{\\mathrm{tot}}$, $[\\mathrm{O_2}] = x_{\\mathrm{O_2}}C_{\\mathrm{tot}}$, and $[\\mathrm{M}] \\approx C_{\\mathrm{tot}}$, where $R$ is the universal gas constant.\n\nYou must model the following reactions (all rate constants are specified at $T=800$ K in SI units; ensure strict dimensional consistency):\n\n- Chain-branching and propagation:\n  1. $\\mathrm{H} + \\mathrm{O_2} \\rightarrow \\mathrm{O} + \\mathrm{OH}$ with rate $r_1 = k_1[\\mathrm{H}][\\mathrm{O_2}]$, where $k_1 = 7.0\\times 10^{3}$ $\\mathrm{m^3\\,mol^{-1}\\,s^{-1}}$.\n  2. $\\mathrm{O} + \\mathrm{H_2} \\rightarrow \\mathrm{H} + \\mathrm{OH}$ with rate $r_2 = k_2[\\mathrm{O}][\\mathrm{H_2}]$, where $k_2 = 2.0\\times 10^{4}$ $\\mathrm{m^3\\,mol^{-1}\\,s^{-1}}$.\n  3. $\\mathrm{OH} + \\mathrm{H_2} \\rightarrow \\mathrm{H} + \\mathrm{H_2O}$ with rate $r_3 = k_3[\\mathrm{OH}][\\mathrm{H_2}]$, where $k_3 = 1.0\\times 10^{3}$ $\\mathrm{m^3\\,mol^{-1}\\,s^{-1}}$.\n\n- Termination by three-body association to hydroperoxyl:\n  4. $\\mathrm{H} + \\mathrm{O_2} + \\mathrm{M} \\rightarrow \\mathrm{HO_2} + \\mathrm{M}$, which you must treat as a net sink for $\\mathrm{H}$ (with $\\mathrm{HO_2}$ assumed to be lost at the wall). For this step:\n    - In the minimal $4$-step mechanism, treat it strictly in the low-pressure limit with effective bimolecular rate coefficient $k_{4,\\min} = k_0[\\mathrm{M}]$, where $k_0 = 3.0\\times 10^{4}$ $\\mathrm{m^6\\,mol^{-2}\\,s^{-1}}$. Thus the loss rate for $\\mathrm{H}$ is $r_4^{\\min} = k_{4,\\min}[\\mathrm{H}][\\mathrm{O_2}]$.\n    - In the detailed mechanism, use the Lindemann falloff model with $k_{4,\\det} = \\dfrac{k_0[\\mathrm{M}]}{1 + \\dfrac{k_0[\\mathrm{M}]}{k_\\infty}}$, where $k_\\infty = 5.0\\times 10^{3}$ $\\mathrm{m^3\\,mol^{-1}\\,s^{-1}}$. The loss rate for $\\mathrm{H}$ is $r_4^{\\det} = k_{4,\\det}[\\mathrm{H}][\\mathrm{O_2}]$.\n\n- First-order diffusive wall loss of radicals:\n  $\\mathrm{H}\\xrightarrow{\\text{wall}} \\emptyset$, $\\mathrm{O}\\xrightarrow{\\text{wall}} \\emptyset$, $\\mathrm{OH}\\xrightarrow{\\text{wall}} \\emptyset$, with rates $-k_{\\mathrm{w,H}}[\\mathrm{H}]$, $-k_{\\mathrm{w,O}}[\\mathrm{O}]$, and $-k_{\\mathrm{w,OH}}[\\mathrm{OH}]$, respectively.\n\nLinearize the radical kinetics near the radical-free state (base mixture fixed) and write the system as $\\dfrac{d\\mathbf{r}}{dt} = \\mathbf{A}(P)\\,\\mathbf{r}$, where the entries of $\\mathbf{A}(P)$ depend on $P$ through $[\\mathrm{H_2}]$, $[\\mathrm{O_2}]$, and $[\\mathrm{M}]$. Define the auxiliary quantities $a_1 = k_1[\\mathrm{O_2}]$, $a_2 = k_2[\\mathrm{H_2}]$, $a_3 = k_3[\\mathrm{H_2}]$, and $a_4 = k_4[\\mathrm{O_2}]$, where $k_4$ equals $k_{4,\\min}$ for the minimal mechanism and $k_{4,\\det}$ for the detailed mechanism. Then the linear operator is\n$$\n\\mathbf{A}(P) =\n\\begin{bmatrix}\n-(a_1 + a_4 + k_{\\mathrm{w,H}})  a_2  a_3 \\\\\na_1  -(a_2 + k_{\\mathrm{w,O}})  0 \\\\\na_1  a_2  -(a_3 + k_{\\mathrm{w,OH}})\n\\end{bmatrix}.\n$$\nExplosion occurs when the largest real part of the eigenvalues of $\\mathbf{A}(P)$, denoted $\\lambda_{\\max}(P)$, becomes positive. The explosion limits are those pressures where $\\lambda_{\\max}(P)=0$; $P_1$ is the smallest positive pressure where $\\lambda_{\\max}(P)$ crosses zero from negative to positive as $P$ increases, and $P_2$ is the next higher pressure where it crosses back from positive to negative.\n\nYou must implement a numerical search over $P$ using a robust bracketing and root-finding method (for example, scanning on a logarithmic grid to detect sign changes of $\\lambda_{\\max}(P)$ and then applying bisection) to locate $P_1$ and $P_2$ for each mechanism. If a limit is not found within the scan range, you must return $-1$ for that limit.\n\nUse the universal gas constant $R=8.314462618$ $\\mathrm{J\\,mol^{-1}\\,K^{-1}}$. All pressures $P$ must be expressed in $\\mathrm{Pa}$. Your program must compute $P_1$ and $P_2$ for each of the following three test cases, each specifying distinct wall-loss rates $(k_{\\mathrm{w,H}},k_{\\mathrm{w,O}},k_{\\mathrm{w,OH}})$ in $\\mathrm{s^{-1}}$:\n\n- Test Case A: $(k_{\\mathrm{w,H}},k_{\\mathrm{w,O}},k_{\\mathrm{w,OH}})=(50,80,100)$.\n- Test Case B: $(k_{\\mathrm{w,H}},k_{\\mathrm{w,O}},k_{\\mathrm{w,OH}})=(10,12,15)$.\n- Test Case C: $(k_{\\mathrm{w,H}},k_{\\mathrm{w,O}},k_{\\mathrm{w,OH}})=(150,200,220)$.\n\nFor each test case, compute:\n- $(P_1,P_2)$ using the minimal $4$-step mechanism (low-pressure limit for step $4$).\n- $(P_1,P_2)$ using the detailed mechanism (Lindemann falloff for step $4$).\n\nUse a pressure search domain of at least $P \\in [10^2, 2 \\times 10^6]$ $\\mathrm{Pa}$ and ensure numerical robustness against missed sign changes. If no crossing is found for $P_1$ or $P_2$ within this domain, return $-1$ for that limit.\n\nFinal output format requirements:\n- Report all pressures in $\\mathrm{Pa}$ as integers rounded to the nearest integer.\n- For each test case, output the results in the order $[P_{1,\\min},P_{2,\\min},P_{1,\\det},P_{2,\\det}]$.\n- Aggregate the three test cases in a single list in the order A, B, C.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[r_1,r_2,\\dots]$).\n\nYour program must not read any input and must not access any files or networks. It must use only the standard libraries plus the following libraries: NumPy and SciPy, though SciPy is not required.", "solution": "The problem posed is validated as scientifically sound, well-posed, and containing all necessary information for a unique solution. It is a standard problem in chemical kinetics that requires the application of linear stability theory to a simplified reaction network for the hydrogen-oxygen system. The objective is to determine the first and second explosion limits, which are the pressures at which the system transitions between stable and unstable (explosive) behavior. This transition is marked by the largest real part of the eigenvalues of the system's kinetic matrix crossing zero.\n\nThe solution proceeds as follows:\nFirst, we establish the relationship between the system pressure $P$ and the concentrations of the species involved. According to the ideal gas law, the total molar concentration of the gas mixture is $C_{\\mathrm{tot}} = P / (RT)$, where $R$ is the universal gas constant and $T$ is the temperature. For a stoichiometric mixture of hydrogen and oxygen ($x_{\\mathrm{H_2}} = 2/3$, $x_{\\mathrm{O_2}} = 1/3$), the concentrations of the stable species are:\n$$\n[\\mathrm{H_2}] = x_{\\mathrm{H_2}} C_{\\mathrm{tot}} = \\frac{2}{3} \\frac{P}{RT}\n$$\n$$\n[\\mathrm{O_2}] = x_{\\mathrm{O_2}} C_{\\mathrm{tot}} = \\frac{1}{3} \\frac{P}{RT}\n$$\nThe concentration of the third body, $[\\mathrm{M}]$, for the termolecular reaction is given by the total concentration, so $[\\mathrm{M}] \\approx C_{\\mathrm{tot}} = P/(RT)$.\n\nThe kinetics of the radical pool, represented by the vector $\\mathbf{r} = ([\\mathrm{H}],[\\mathrm{O}],[\\mathrm{OH}])^\\top$, is described by the linear system $\\dfrac{d\\mathbf{r}}{dt} = \\mathbf{A}(P)\\,\\mathbf{r}$. The matrix $\\mathbf{A}(P)$ is constructed from the rate coefficients, which depend on pressure. The auxiliary quantities $a_i(P)$ are defined based on the elementary reaction rates:\n$a_1(P) = k_1[\\mathrm{O_2}] = k_1 \\left(\\frac{1}{3} \\frac{P}{RT}\\right)$\n$a_2(P) = k_2[\\mathrm{H_2}] = k_2 \\left(\\frac{2}{3} \\frac{P}{RT}\\right)$\n$a_3(P) = k_3[\\mathrm{H_2}] = k_3 \\left(\\frac{2}{3} \\frac{P}{RT}\\right)$\n\nThe termination step coefficient, $a_4(P)$, depends on the chosen kinetic model for reaction $4$: $\\mathrm{H} + \\mathrm{O_2} + \\mathrm{M} \\rightarrow \\mathrm{HO_2} + \\mathrm{M}$. The problem statement implies the loss term for H from this reaction is $a_4[\\mathrm{H}]$. From the rate laws given, $r_4 = k_4[\\mathrm{H}][\\mathrm{O_2}]$, which means $a_4 = k_4[\\mathrm{O_2}]$.\n\nFor the minimal $4$-step mechanism (low-pressure limit):\nThe termolecular reaction rate is directly proportional to $[\\mathrm{M}]$, so $k_4 = k_0[\\mathrm{M}]$. Thus, we have:\n$$\na_{4,\\min}(P) = (k_0[\\mathrm{M}])[\\mathrm{O_2}] = k_0 \\left(\\frac{P}{RT}\\right) \\left(\\frac{1}{3} \\frac{P}{RT}\\right) = \\frac{k_0}{3(RT)^2} P^2\n$$\nThis shows a quadratic dependence on pressure for the termination term's coefficient.\n\nFor the detailed mechanism (Lindemann falloff):\nThe pressure dependence of the termolecular reaction is moderated at high pressures. The effective rate coefficient $k_{4,\\det}$ is used.\n$$\nk_{4,\\det}(P) = \\frac{k_0[\\mathrm{M}]}{1 + \\frac{k_0[\\mathrm{M}]}{k_\\infty}} = \\frac{k_0 P/(RT)}{1 + \\frac{k_0 P}{k_\\infty RT}}\n$$\nThe coefficient $a_4$ is then $a_4 = k_{4,\\det}[\\mathrm{O_2}]$:\n$$\na_{4,\\det}(P) = \\left(\\frac{k_0 P/(RT)}{1 + \\frac{k_0 P}{k_\\infty RT}}\\right) \\left(\\frac{1}{3} \\frac{P}{RT}\\right) = \\frac{k_0}{3(RT)^2} \\frac{P^2}{1 + \\frac{k_0 P}{k_\\infty RT}}\n$$\nThis expression transitions from a quadratic dependence on $P$ at low pressures to a linear dependence at high pressures.\n\nWith these pressure-dependent coefficients, the system matrix $\\mathbf{A}(P)$ is fully defined for any pressure $P$:\n$$\n\\mathbf{A}(P) =\n\\begin{bmatrix}\n-(a_1(P) + a_4(P) + k_{\\mathrm{w,H}})  a_2(P)  a_3(P) \\\\\na_1(P)  -(a_2(P) + k_{\\mathrm{w,O}})  0 \\\\\na_1(P)  a_2(P)  -(a_3(P) + k_{\\mathrm{w,OH}})\n\\end{bmatrix}\n$$\nThe explosion limits are the pressures $P_1$ and $P_2$ where the system's stability changes. This occurs when the maximum real part of the eigenvalues of $\\mathbf{A}(P)$, denoted $\\lambda_{\\max}(P)$, is equal to zero. We must find the roots of the equation $\\lambda_{\\max}(P) = 0$.\n\nThe numerical strategy to find these roots is as follows:\n1. Define a function that, for a given pressure $P$, a set of wall loss rates $(k_{\\mathrm{w,H}}, k_{\\mathrm{w,O}}, k_{\\mathrm{w,OH}})$, and a kinetic model, computes the matrix $\\mathbf{A}(P)$ and returns $\\lambda_{\\max}(P)$. This involves calculating the eigenvalues of the matrix and finding the maximum of their real parts.\n2. Scan the specified pressure domain, $P \\in [10^2, 2 \\times 10^6]$ Pa, to find intervals where $\\lambda_{\\max}(P)$ changes sign. A logarithmic grid is suitable for this scan to cover the wide pressure range effectively.\n3. For each interval $[P_i, P_{i+1}]$ where a sign change is detected (i.e., $\\lambda_{\\max}(P_i) \\cdot \\lambda_{\\max}(P_{i+1})  0$), use a robust numerical root-finding algorithm, such as the bisection method, to determine the pressure $P$ where $\\lambda_{\\max}(P) = 0$ with high accuracy.\n4. The first positive root found as pressure increases from the low end of the domain corresponds to the first explosion limit, $P_1$. The next root corresponds to the second explosion limit, $P_2$. If no roots or only one root is found, the missing limits are reported as $-1$.\nThis procedure is applied for each test case and for both kinetic models to produce the required set of results.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the first and second explosion limits for the H2-O2 system\n    at T=800K for three test cases, using two different kinetic models.\n    \"\"\"\n\n    # --- Constants and Configuration ---\n    R = 8.314462618  # Universal gas constant in J mol^-1 K^-1\n    T = 800.0        # Temperature in K\n    \n    # Mole fractions for stoichiometric H2-O2 mixture\n    X_H2 = 2.0 / 3.0\n    X_O2 = 1.0 / 3.0\n\n    # Rate constants at T=800K (SI units: m, mol, s)\n    K1 = 7.0e3    # k_1 (H + O2 - O + OH) in m^3 mol^-1 s^-1\n    K2 = 2.0e4    # k_2 (O + H2 - H + OH) in m^3 mol^-1 s^-1\n    K3 = 1.0e3    # k_3 (OH + H2 - H + H2O) in m^3 mol^-1 s^-1\n    K0 = 3.0e4    # k_0 (H + O2 + M - HO2 + M low-P limit) in m^6 mol^-2 s^-1\n    K_INF = 5.0e3 # k_inf for Lindemann model in m^3 mol^-1 s^-1\n\n    # Test cases for wall-loss rates (k_w,H, k_w,O, k_w,OH) in s^-1\n    test_cases = {\n        'A': (50.0, 80.0, 100.0),\n        'B': (10.0, 12.0, 15.0),\n        'C': (150.0, 200.0, 220.0),\n    }\n\n    # Numerical search parameters\n    P_MIN = 1.0e2  # Minimum pressure for search in Pa\n    P_MAX = 2.0e6  # Maximum pressure for search in Pa\n    N_POINTS = 1000  # Number of points for initial scan\n    BISECTION_TOL = 1e-6 # Tolerance for bisection method\n\n    # --- Core Functions ---\n\n    def get_lambda_max(pressure, kw, model_type):\n        \"\"\"\n        Calculates the maximum real part of the eigenvalues of the kinetic matrix A(P).\n        \n        Args:\n            pressure (float): Pressure in Pa.\n            kw (tuple): Wall loss rates (k_w,H, k_w,O, k_w,OH).\n            model_type (str): 'minimal' or 'detailed'.\n\n        Returns:\n            float: The maximum real part of the eigenvalues.\n        \"\"\"\n        kw_h, kw_o, kw_oh = kw\n        rt_inv = 1.0 / (R * T)\n        \n        # Concentrations\n        c_tot = pressure * rt_inv\n        conc_h2 = X_H2 * c_tot\n        conc_o2 = X_O2 * c_tot\n        \n        # Pressure-dependent coefficients a_i\n        a1 = K1 * conc_o2\n        a2 = K2 * conc_h2\n        a3 = K3 * conc_h2\n\n        # Coefficient a4 depends on the kinetic model\n        if model_type == 'minimal':\n            # k4_min = k0 * [M]\n            # a4 = k4_min * [O2] = k0 * [M] * [O2]\n            a4 = K0 * c_tot * conc_o2\n        elif model_type == 'detailed':\n            # k4_det = (k0 * [M]) / (1 + k0 * [M] / k_inf)\n            # a4 = k4_det * [O2]\n            k0_m = K0 * c_tot\n            k4_det = k0_m / (1.0 + k0_m / K_INF)\n            a4 = k4_det * conc_o2\n        else:\n            raise ValueError(\"Unknown model_type\")\n\n        # Construct the matrix A(P)\n        A = np.array([\n            [-(a1 + a4 + kw_h), a2, a3],\n            [a1, -(a2 + kw_o), 0.0],\n            [a1, a2, -(a3 + kw_oh)]\n        ])\n\n        # Compute eigenvalues and return the maximum of their real parts\n        eigenvalues = np.linalg.eigvals(A)\n        return np.max(np.real(eigenvalues))\n\n    def bisection(func, a, b, tol):\n        \"\"\"Simple bisection root-finding algorithm.\"\"\"\n        fa = func(a)\n        fb = func(b)\n        if fa * fb = 0:\n            # Should not happen if a bracket is correctly identified\n            return (a + b) / 2.0\n            \n        while (b - a) / 2.0  tol:\n            c = (a + b) / 2.0\n            fc = func(c)\n            if fc == 0.0:\n                return c\n            if fa * fc  0:\n                b = c\n            else:\n                a = c\n                fa = fc\n        return (a + b) / 2.0\n\n    def find_explosion_limits(kw, model_type):\n        \"\"\"\n        Finds P1 and P2 for a given test case and model.\n        \"\"\"\n        # Create a log-spaced grid for pressure scanning\n        p_grid = np.logspace(np.log10(P_MIN), np.log10(P_MAX), N_POINTS)\n\n        # Create a lambda function for root finding\n        f = lambda p: get_lambda_max(p, kw, model_type)\n\n        lambda_vals = np.array([f(p) for p in p_grid])\n        \n        roots = []\n        # Find all brackets where lambda_max crosses zero\n        for i in range(len(p_grid) - 1):\n            if lambda_vals[i] * lambda_vals[i+1]  0:\n                # A root is bracketed, refine with bisection\n                root = bisection(f, p_grid[i], p_grid[i+1], BISECTION_TOL)\n                roots.append(root)\n\n        p1, p2 = -1, -1\n        if len(roots) == 1:\n            # If one root is found, assume it is P1 as lambda typically goes from neg to pos\n            p1 = roots[0]\n        elif len(roots) = 2:\n            # P1 is the first root, P2 is the second\n            p1 = roots[0]\n            p2 = roots[1]\n        \n        return p1, p2\n\n    # --- Main Execution Logic ---\n    all_results = []\n    \n    # Iterate through each test case\n    for case_name in sorted(test_cases.keys()):\n        kw = test_cases[case_name]\n        \n        # Minimal 4-step model\n        p1_min, p2_min = find_explosion_limits(kw, 'minimal')\n        all_results.append(int(round(p1_min)))\n        all_results.append(int(round(p2_min)))\n\n        # Detailed falloff model\n        p1_det, p2_det = find_explosion_limits(kw, 'detailed')\n        all_results.append(int(round(p1_det)))\n        all_results.append(int(round(p2_det)))\n        \n    # Format and print the final output\n    print(f\"[{','.join(map(str, all_results))}]\")\n\n\nsolve()\n```", "id": "2643055"}]}