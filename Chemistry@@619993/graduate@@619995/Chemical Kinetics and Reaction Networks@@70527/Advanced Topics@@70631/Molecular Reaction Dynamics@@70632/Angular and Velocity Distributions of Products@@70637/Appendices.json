{"hands_on_practices": [{"introduction": "To properly analyze a molecular collision, we must first transform our perspective from the fixed laboratory (LAB) frame to the center-of-mass (CM) frame, which moves with the colliding system. This transformation simplifies the dynamics by isolating the relative motion of the reactants from the trivial overall motion of the system as a whole. This foundational exercise, [@problem_id:1529507], provides practice in performing this crucial step by calculating the velocity of the center of mass and the collision energy, the energy available to drive the reaction.", "problem": "A crossed-molecular-beam experiment, a powerful technique for studying reaction dynamics, is set up to investigate collisions between argon atoms and oxygen molecules. A beam of argon (Ar) atoms travels along the positive x-axis, and a perpendicular beam of diatomic oxygen ($\\text{O}_2$) molecules travels along the positive y-axis. The two beams intersect at the origin. The experimental parameters are as follows:\n\n- The speed of the argon atoms is $v_{Ar} = 500.0 \\text{ m/s}$.\n- The speed of the oxygen molecules is $v_{O_2} = 400.0 \\text{ m/s}$.\n- The molar mass of argon is $M_{Ar} = 39.95 \\text{ g/mol}$.\n- The molar mass of oxygen is $M_{O_2} = 32.00 \\text{ g/mol}$.\n- Avogadro's constant is $N_A = 6.022 \\times 10^{23} \\text{ mol}^{-1}$.\n\nTo analyze the collision event, it is essential to work in the center-of-mass (CM) reference frame. You are asked to determine the key properties of this frame. Calculate the speed of the center of mass, the angle its velocity vector makes with the positive x-axis, and the total kinetic energy of the system within the center-of-mass frame (often called the collision energy).\n\nProvide your final answer as a set of three numerical values corresponding to the speed, the angle, and the kinetic energy, in that order. Express the speed in m/s, the angle in degrees, and the kinetic energy in Joules. Round all three of your final answers to three significant figures.", "solution": "We model the collision as a two-body system with an Ar atom (mass per particle $m_{Ar}$, velocity $\\vec{v}_{Ar}$) and an $\\mathrm{O}_{2}$ molecule (mass per particle $m_{O_{2}}$, velocity $\\vec{v}_{O_{2}}$). The per-particle masses follow from the given molar masses $M_{Ar}$ and $M_{O_{2}}$ via $m_{i} = \\frac{M_{i}}{N_{A}}$.\n\nThe center-of-mass (CM) velocity is defined by conservation of momentum as\n$$\n\\vec{V}_{\\mathrm{CM}}=\\frac{m_{Ar}\\,\\vec{v}_{Ar}+m_{O_{2}}\\,\\vec{v}_{O_{2}}}{m_{Ar}+m_{O_{2}}}.\n$$\nWith $\\vec{v}_{Ar}=(v_{Ar},0)$ and $\\vec{v}_{O_{2}}=(0,v_{O_{2}})$, the components are\n$$\nV_{x}=\\frac{m_{Ar}\\,v_{Ar}}{m_{Ar}+m_{O_{2}}}=\\frac{M_{Ar}\\,v_{Ar}}{M_{Ar}+M_{O_{2}}},\\qquad\nV_{y}=\\frac{m_{O_{2}}\\,v_{O_{2}}}{m_{Ar}+m_{O_{2}}}=\\frac{M_{O_{2}}\\,v_{O_{2}}}{M_{Ar}+M_{O_{2}}}.\n$$\nThus the CM speed and its direction relative to the $+x$-axis are\n$$\nV_{\\mathrm{CM}}=\\sqrt{V_{x}^{2}+V_{y}^{2}}=\\frac{\\sqrt{(M_{Ar}v_{Ar})^{2}+(M_{O_{2}}v_{O_{2}})^{2}}}{M_{Ar}+M_{O_{2}}},\\qquad\n\\theta=\\arctan\\!\\left(\\frac{V_{y}}{V_{x}}\\right)=\\arctan\\!\\left(\\frac{M_{O_{2}}\\,v_{O_{2}}}{M_{Ar}\\,v_{Ar}}\\right).\n$$\nThe total kinetic energy in the CM frame (collision energy) for a two-body system is\n$$\nE_{\\mathrm{coll}}=\\frac{1}{2}\\,\\mu\\,v_{\\mathrm{rel}}^{2},\\qquad \\mu=\\frac{m_{Ar}\\,m_{O_{2}}}{m_{Ar}+m_{O_{2}}}=\\frac{M_{Ar}M_{O_{2}}}{N_{A}\\,(M_{Ar}+M_{O_{2}})},\n$$\nwhere the relative speed is $v_{\\mathrm{rel}}=|\\vec{v}_{Ar}-\\vec{v}_{O_{2}}|$. Because the beams are perpendicular,\n$$\nv_{\\mathrm{rel}}=\\sqrt{v_{Ar}^{2}+v_{O_{2}}^{2}}.\n$$\n\nNow substitute the given numerical values (in SI units for $M$) and evaluate:\n- $M_{Ar}=0.03995\\,\\text{kg/mol}$, $M_{O_{2}}=0.03200\\,\\text{kg/mol}$, $N_{A}=6.022\\times 10^{23}\\,\\text{mol}^{-1}$,\n- $v_{Ar}=500.0\\,\\text{m/s}$, $v_{O_{2}}=400.0\\,\\text{m/s}$.\n\nCM velocity components:\n$$\nV_{x}=\\frac{0.03995\\times 500.0}{0.03995+0.03200}=\\frac{19.975}{0.07195}\\approx 2.77623\\times 10^{2}\\,\\text{m/s},\n$$\n$$\nV_{y}=\\frac{0.03200\\times 400.0}{0.03995+0.03200}=\\frac{12.800}{0.07195}\\approx 1.77901\\times 10^{2}\\,\\text{m/s}.\n$$\nCM speed and angle:\n$$\nV_{\\mathrm{CM}}=\\sqrt{(2.77623\\times 10^{2})^{2}+(1.77901\\times 10^{2})^{2}}\\approx 3.29733\\times 10^{2}\\,\\text{m/s},\n$$\n$$\n\\theta=\\arctan\\!\\left(\\frac{12.800}{19.975}\\right)\\approx \\arctan(0.640801)\\approx 32.7\\,\\text{degrees}.\n$$\n\nCollision energy:\n$$\n\\mu=\\frac{M_{Ar}M_{O_{2}}}{N_{A}(M_{Ar}+M_{O_{2}})}=\\frac{0.03995\\times 0.03200}{6.022\\times 10^{23}\\times 0.07195}\\,\\text{kg}\\approx \\frac{1.776789437\\times 10^{-2}}{6.022\\times 10^{23}}\\,\\text{kg}\\approx 2.95\\times 10^{-26}\\,\\text{kg},\n$$\n$$\nv_{\\mathrm{rel}}=\\sqrt{500.0^{2}+400.0^{2}}=\\sqrt{410000}\\,\\text{m/s},\n$$\n$$\nE_{\\mathrm{coll}}=\\frac{1}{2}\\,\\mu\\,v_{\\mathrm{rel}}^{2}=\\frac{1}{2}\\,\\frac{M_{Ar}M_{O_{2}}}{N_{A}(M_{Ar}+M_{O_{2}})}\\,(v_{Ar}^{2}+v_{O_{2}}^{2})\\approx \\frac{1}{2}\\times \\frac{0.01776789437}{6.022\\times 10^{23}}\\times 4.10\\times 10^{5}\\,\\text{J}\\approx 6.05\\times 10^{-21}\\,\\text{J}.\n$$\n\nRounded to three significant figures, the CM speed, angle (degrees), and collision energy (J) are:\n- $V_{\\mathrm{CM}}\\approx 3.30\\times 10^{2}$,\n- $\\theta\\approx 32.7$,\n- $E_{\\mathrm{coll}}\\approx 6.05\\times 10^{-21}$.", "answer": "$$\\boxed{\\begin{pmatrix}3.30\\times 10^{2} & 32.7 & 6.05\\times 10^{-21}\\end{pmatrix}}$$", "id": "1529507"}, {"introduction": "The angular distribution of scattered products provides a detailed map of the forces experienced during a reactive encounter. By connecting the interaction potential energy surface to the final scattering angles, we can decode the dynamics of the collision. In this practice, [@problem_id:2626670], you will explore this link by deriving the classical deflection function $\\Theta(b)$ for a model repulsive potential and predicting the location of a 'rainbow angle,' a prominent feature in the differential cross section that offers a direct probe of the potential's characteristics.", "problem": "In bimolecular reactive scattering at energies above the reaction threshold, product angular distributions can be analyzed semiclassically via the classical deflection function. Consider a central, repulsive barrier that is well approximated near the interaction region by a Gaussian potential $V(r) = V_{0}\\exp\\!\\big(-r^{2}/a^{2}\\big)$, with $V_{0} > 0$ and range parameter $a > 0$. Two reactants approach with relative speed $v$ and reduced mass $\\mu$, so that the collision energy is $E = \\tfrac{1}{2}\\mu v^{2}$. Assume the high-energy, small-angle regime in which the trajectory can be approximated as a straight line displaced by the impact parameter $b$.\n\nStarting from Newton’s second law and conservation of linear momentum, derive the small-angle deflection function $\\Theta(b)$ as an integral over the unperturbed, straight-line path. Evaluate this expression for the given Gaussian potential to obtain a closed-form analytic $\\Theta(b)$. Then, by analyzing $d\\Theta/db$, determine whether a rainbow angle occurs, and if so, find the impact parameter $b_{r}$ at which $d\\Theta/db=0$ and the corresponding rainbow scattering angle $\\theta_{r} = \\Theta(b_{r})$. Finally, using the method of stationary phase and the uniform semiclassical construction based on the Wentzel–Kramers–Brillouin (WKB) approximation, discuss qualitatively the emergence of Airy-function oscillations in the differential cross section near $\\theta_{r}$, identifying the role of the second derivative $\\Theta''(b_{r})$ in setting the local angular scale.\n\nExpress your final answer as a single closed-form analytic expression for the rainbow angle $\\theta_{r}$ in terms of $E$ and $V_{0}$ only. Express the angle in radians.", "solution": "We consider two-body scattering in a central potential $V(r)$, with relative speed $v$ and reduced mass $\\mu$. In the high-energy, small-angle regime, one can approximate the unperturbed trajectory as a straight line along the $z$-axis with transverse displacement $b$ (the impact parameter). Let the transverse coordinate be $x$, with $x=b$ fixed along the straight-line path, and $z \\approx v t$. The small deflection angle $\\Theta(b)$ is given by the ratio of the transverse velocity impulse to the incident speed,\n$$\n\\Theta(b) \\approx \\frac{\\Delta v_{\\perp}}{v} = \\frac{1}{\\mu v}\\int_{-\\infty}^{\\infty} F_{\\perp}(t)\\,dt,\n$$\nwhere $F_{\\perp}(t) = -\\partial V/\\partial x$ is the transverse force. Writing $r=\\sqrt{b^{2}+z^{2}}$ along the straight-line path and using the chain rule,\n$$\n\\frac{\\partial V}{\\partial x} = \\frac{dV}{dr}\\frac{\\partial r}{\\partial x} = \\frac{dV}{dr}\\frac{b}{r}.\n$$\nTherefore,\n$$\n\\Delta v_{\\perp} = -\\frac{1}{\\mu}\\int_{-\\infty}^{\\infty}\\frac{dV}{dr}\\frac{b}{r}\\,dt = -\\frac{1}{\\mu v}\\int_{-\\infty}^{\\infty}\\frac{dV}{dr}\\frac{b}{r}\\,dz,\n$$\nand hence\n$$\n\\Theta(b) = -\\frac{1}{\\mu v^{2}}\\int_{-\\infty}^{\\infty}\\frac{dV}{dr}\\frac{b}{r}\\,dz.\n$$\nDefine the longitudinal potential line-integral\n$$\n\\Phi(b) \\equiv \\int_{-\\infty}^{\\infty} V\\!\\big(\\sqrt{b^{2}+z^{2}}\\big)\\,dz.\n$$\nDifferentiation under the integral sign gives\n$$\n\\frac{d\\Phi}{db} = \\int_{-\\infty}^{\\infty}\\frac{\\partial V}{\\partial b}\\,dz \n= \\int_{-\\infty}^{\\infty}\\frac{dV}{dr}\\frac{\\partial r}{\\partial b}\\,dz\n= \\int_{-\\infty}^{\\infty}\\frac{dV}{dr}\\frac{b}{r}\\,dz.\n$$\nThus the deflection function can be written compactly as\n$$\n\\Theta(b) = -\\frac{1}{\\mu v^{2}}\\frac{d\\Phi}{db}.\n$$\n\nWe now evaluate $\\Phi(b)$ for the Gaussian potential $V(r) = V_{0}\\exp\\!\\big(-r^{2}/a^{2}\\big)$. Along the straight-line path $r^{2} = b^{2}+z^{2}$, so\n$$\n\\Phi(b) = \\int_{-\\infty}^{\\infty} V_{0}\\exp\\!\\Big(-\\frac{b^{2}+z^{2}}{a^{2}}\\Big)\\,dz \n= V_{0}\\exp\\!\\Big(-\\frac{b^{2}}{a^{2}}\\Big)\\int_{-\\infty}^{\\infty}\\exp\\!\\Big(-\\frac{z^{2}}{a^{2}}\\Big)\\,dz \n= V_{0} a \\sqrt{\\pi}\\,\\exp\\!\\Big(-\\frac{b^{2}}{a^{2}}\\Big).\n$$\nDifferentiating with respect to $b$ gives\n$$\n\\frac{d\\Phi}{db} = V_{0} a \\sqrt{\\pi}\\left(-\\frac{2b}{a^{2}}\\right)\\exp\\!\\Big(-\\frac{b^{2}}{a^{2}}\\Big) \n= -\\frac{2 V_{0}\\sqrt{\\pi}}{a}\\,b\\,\\exp\\!\\Big(-\\frac{b^{2}}{a^{2}}\\Big).\n$$\nTherefore,\n$$\n\\Theta(b) = -\\frac{1}{\\mu v^{2}}\\frac{d\\Phi}{db} \n= \\frac{2 V_{0}\\sqrt{\\pi}}{\\mu v^{2} a}\\,b\\,\\exp\\!\\Big(-\\frac{b^{2}}{a^{2}}\\Big).\n$$\n\nTo locate a rainbow, we seek stationary points of the deflection function by solving $d\\Theta/db=0$. Differentiate:\n$$\n\\frac{d\\Theta}{db} = \\frac{2 V_{0}\\sqrt{\\pi}}{\\mu v^{2} a}\\,\\exp\\!\\Big(-\\frac{b^{2}}{a^{2}}\\Big)\\left(1-\\frac{2b^{2}}{a^{2}}\\right).\n$$\nThe nontrivial zero occurs at\n$$\n1-\\frac{2b^{2}}{a^{2}}=0 \\quad\\Rightarrow\\quad b_{r}=\\frac{a}{\\sqrt{2}}.\n$$\nEvaluating the deflection at $b_{r}$ gives the rainbow angle\n$$\n\\theta_{r} \\equiv \\Theta(b_{r}) = \\frac{2 V_{0}\\sqrt{\\pi}}{\\mu v^{2} a}\\,\\frac{a}{\\sqrt{2}}\\,\\exp\\!\\Big(-\\frac{1}{2}\\Big) \n= \\frac{V_{0}\\sqrt{\\pi}}{\\mu v^{2}}\\,\\sqrt{2}\\,\\exp\\!\\Big(-\\frac{1}{2}\\Big).\n$$\nExpressing the speed via the collision energy $E=\\tfrac{1}{2}\\mu v^{2}$, we use $\\mu v^{2} = 2E$ to obtain\n$$\n\\theta_{r} = \\frac{V_{0}\\sqrt{\\pi}}{2E}\\,\\sqrt{2}\\,\\exp\\!\\Big(-\\frac{1}{2}\\Big) \n= \\frac{V_{0}\\sqrt{\\pi}\\,\\exp(-1/2)}{\\sqrt{2}\\,E}.\n$$\nThis is the desired closed-form expression in radians.\n\nTo analyze the Airy-like oscillations semiclassically near the rainbow, expand $\\Theta(b)$ about $b_{r}$. Write $b=b_{r}+\\Delta b$ and note that $d\\Theta/db|_{b_{r}}=0$. A Taylor expansion gives\n$$\n\\Theta(b) \\approx \\theta_{r} + \\tfrac{1}{2}\\Theta''(b_{r})\\,(\\Delta b)^{2}.\n$$\nFor $\\Theta(b)=A\\,b\\,\\exp(-b^{2}/a^{2})$ with $A=\\tfrac{2 V_{0}\\sqrt{\\pi}}{\\mu v^{2} a}$, one finds\n$$\n\\Theta''(b_{r}) = -\\frac{4\\,\\theta_{r}}{a^{2}}.\n$$\nClassically, the differential cross section $d\\sigma/d\\Omega \\propto \\sum b/|\\sin\\Theta|\\,|db/d\\Theta|$ exhibits a divergence at the stationary point because $d\\Theta/db=0$. The uniform semiclassical construction based on the Wentzel–Kramers–Brillouin (WKB) approximation replaces the two coalescing stationary-phase contributions by an Airy function. Introducing the relative wave number $k=\\mu v/\\hbar$ (with $\\hbar$ the reduced Planck constant), the scattering amplitude near $\\theta_{r}$ has the universal form\n$$\nf(\\theta)\\,\\propto\\,\\mathrm{Ai}\\!\\Big(\\gamma\\,(\\theta-\\theta_{r})\\Big),\n$$\nwhere the scale factor $\\gamma$ is proportional to $k^{2/3}\\big(|\\Theta''(b_{r})|/2\\big)^{1/3}$. Consequently, the angular fringe spacing is set by $|\\Theta''(b_{r})|^{-1/3}k^{-2/3}$. Using $|\\Theta''(b_{r})|=4\\theta_{r}/a^{2}$ and the expression for $\\theta_{r}$ above, the local fringe scale depends on $a$ and $V_{0}$ through $a^{2/3}V_{0}^{-1/3}$, with the collision-energy dependence canceling at this order within the present Gaussian-barrier, small-angle model. This yields the characteristic Airy-like oscillations that smooth the classical rainbow singularity and determine the product angular distribution near $\\theta_{r}$.", "answer": "$$\\boxed{\\frac{V_{0}\\sqrt{\\pi}\\,\\exp(-1/2)}{\\sqrt{2}\\,E}}$$", "id": "2626670"}, {"introduction": "Bridging the gap between theory and experiment requires robust methods for analyzing measured data. In scattering experiments, product angular distributions are often measured as noisy counts within discrete angular bins. This computational exercise, [@problem_id:2626680], guides you through the process of transforming this raw data into a physically meaningful form by using the orthogonality of Legendre polynomials, $P_{\\ell}(\\cos\\theta)$, to extract the expansion coefficients $A_{\\ell}$ that quantitatively describe the shape of the distribution.", "problem": "You are given an axisymmetric reactive scattering scenario in which the differential cross section (DCS) depends only on the polar angle $\\theta \\in [0,\\pi]$ and admits a Legendre polynomial expansion of the form $d\\sigma/d\\Omega = f(\\theta) = \\sum_{\\ell=0}^{\\ell_{\\max}} A_{\\ell} P_{\\ell}(\\cos\\theta)$. Here $P_{\\ell}$ denotes the degree-$\\ell$ Legendre polynomial, and $A_{\\ell}$ are real coefficients that characterize the angular distribution of products. The measurable quantity is $f(\\theta)$ per unit solid angle. Data are collected in polar angle bins, and within each bin the reported value is a noisy estimate of $f(\\theta)$ evaluated at the bin midpoint.\n\nFoundational facts:\n- The Legendre polynomials satisfy the orthogonality relation $\\int_{-1}^{1} P_{\\ell}(\\mu) P_{m}(\\mu)\\, d\\mu = \\frac{2}{2\\ell+1}\\delta_{\\ell m}$, where $\\mu = \\cos\\theta$, $\\delta_{\\ell m}$ is the Kronecker delta, and $\\ell,m \\in \\mathbb{N}_0$.\n- The solid-angle measure separates as $d\\Omega = \\sin\\theta\\, d\\theta\\, d\\phi$. For an axisymmetric $f(\\theta)$, dependence on the azimuthal angle $\\phi$ is absent, and projections onto $P_{\\ell}(\\cos\\theta)$ reduce to one-dimensional integrals in $\\theta$ with weight $\\sin\\theta$.\n\nTask:\n- Starting from the orthogonality relation and the expansion definition, derive a projection estimator for $A_{\\ell}$ expressed as an integral of $f(\\theta) P_{\\ell}(\\cos\\theta)$ over $\\theta \\in [0,\\pi]$ with the appropriate weight. Then, to compute $A_{\\ell}$ from noisy, binned data, approximate this integral by a midpoint-rule Riemann sum over the bins: use the bin mid-angle $\\theta_i$, the bin width $\\Delta\\theta_i$, and the measured value $y_i \\approx f(\\theta_i)$, with the physically correct weight $\\sin\\theta_i$. Your estimator must be valid for nonuniform bin widths as well as uniform bins. All angles provided in the data are in degrees; you must convert degrees to radians internally before any trigonometric computation.\n- Implement this estimator in a program that, for each test case described below, returns the list of estimated coefficients $[A_0,A_1,\\dots,A_{\\ell_{\\max}}]$ as floating-point numbers rounded to six decimal places.\n\nAngle unit requirement:\n- All input angles are specified in degrees. Your program must convert degrees to radians prior to computation. No angle should be treated as radians in the input. Trigonometric functions and any angular integrals must use radians.\n\nFinal output format:\n- Your program should produce a single line of output containing the results for all test cases as a comma-separated list enclosed in square brackets, where each test case result is itself a bracketed, comma-separated list of coefficients. For example, a valid output would look like $[[a_{0}^{(1)},a_{1}^{(1)}],[a_{0}^{(2)},a_{1}^{(2)}]]$ with each $a$ rounded to six decimal places.\n\nTest suite:\n- For each test case, you are given the bin edges in degrees and the noisy measurements at midpoints. The bins partition $[0^\\circ,180^\\circ]$; the midpoint of bin $i$ is the average of its two edge angles. The corresponding bin width in radians is the difference between adjacent edges converted to radians.\n\nProvide a single program that evaluates all of the following cases:\n\n1) Case $\\#1$ (uniform bins, moderate anisotropy):\n- $\\ell_{\\max} = 4$.\n- Bin edges in degrees: $[\\,\\;0,\\;30,\\;60,\\;90,\\;120,\\;150,\\;180\\;\\,]$.\n- Midpoint measurements $y_i$ (dimension of $f(\\theta)$ per unit solid angle): $[\\,\\;1.324820,\\;1.198250,\\;0.776555,\\;0.765555,\\;1.215250,\\;1.308820\\;\\,]$.\n\n2) Case $\\#2$ (nonuniform bins, anisotropy with different scale):\n- $\\ell_{\\max} = 2$.\n- Bin edges in degrees: $[\\,\\;0,\\;20,\\;50,\\;80,\\;120,\\;160,\\;180\\;\\,]$.\n- Midpoint measurements $y_i$: $[\\,\\;1.723569,\\;1.833045,\\;2.089627,\\;2.131431,\\;1.885929,\\;1.718569\\;\\,]$.\n\n3) Case $\\#3$ (uniform bins, estimator boundary case):\n- $\\ell_{\\max} = 0$.\n- Bin edges in degrees: $[\\,\\;0,\\;45,\\;90,\\;135,\\;180\\;\\,]$.\n- Midpoint measurements $y_i$: $[\\,\\;1.812132,\\;1.377868,\\;1.407868,\\;1.807132\\;\\,]$.\n\nScientific realism and units:\n- Treat $y_i$ as noisy evaluations of $f(\\theta)$ at the bin midpoints, with no additional scaling factors required. The estimator you implement must respect the correct angular measure through the $\\sin\\theta$ weight and bin widths in radians. There are no other units to report in the final answer beyond the numerical coefficient values. Angles must be handled in radians internally.\n\nAnswer specification:\n- The output must be a single line containing a bracketed list of three lists of floating-point numbers rounded to six decimal places, corresponding to the estimated $A_{\\ell}$ for the three cases above, in the order given.", "solution": "The problem as stated is scientifically grounded, mathematically consistent, and well-posed. It presents a standard task in the analysis of scattering data, which is to extract angular momentum components from a measured differential cross section. All necessary information is provided. We shall proceed with the derivation and implementation of the required estimator.\n\nThe task is to determine the coefficients $A_{\\ell}$ in the Legendre polynomial expansion of an axisymmetric differential cross section, given by:\n$$\n\\frac{d\\sigma}{d\\Omega} = f(\\theta) = \\sum_{\\ell=0}^{\\ell_{\\max}} A_{\\ell} P_{\\ell}(\\cos\\theta)\n$$\nwhere $P_{\\ell}$ is the Legendre polynomial of degree $\\ell$ and $\\theta$ is the polar scattering angle.\n\nFirst, we derive the analytical formula for $A_{\\ell}$. The extraction of these coefficients relies upon the orthogonality property of the Legendre polynomials, which is given for the variable $\\mu \\in [-1, 1]$:\n$$\n\\int_{-1}^{1} P_{\\ell}(\\mu) P_{m}(\\mu)\\, d\\mu = \\frac{2}{2\\ell+1}\\delta_{\\ell m}\n$$\nwhere $\\delta_{\\ell m}$ is the Kronecker delta.\n\nTo utilize this property, we must formulate an appropriate integral involving $f(\\theta)$. The connection between the angular domain $\\theta \\in [0, \\pi]$ and the domain of orthogonality $\\mu \\in [-1, 1]$ is the substitution $\\mu = \\cos\\theta$. This implies $d\\mu = -\\sin\\theta \\, d\\theta$. Furthermore, the problem states that for an axisymmetric system, projections onto $P_{\\ell}(\\cos\\theta)$ involve an integral in $\\theta$ with a weight of $\\sin\\theta$. This arises naturally from the solid angle element $d\\Omega = \\sin\\theta \\, d\\theta \\, d\\phi$.\n\nLet us consider the integral of $f(\\theta)$ multiplied by $P_m(\\cos\\theta)$ and the weight function $\\sin\\theta$ over the full range of $\\theta$:\n$$\nI_m = \\int_{0}^{\\pi} f(\\theta) P_{m}(\\cos\\theta) \\sin\\theta \\, d\\theta\n$$\nSubstituting the expansion for $f(\\theta)$:\n$$\nI_m = \\int_{0}^{\\pi} \\left( \\sum_{\\ell=0}^{\\ell_{\\max}} A_{\\ell} P_{\\ell}(\\cos\\theta) \\right) P_{m}(\\cos\\theta) \\sin\\theta \\, d\\theta\n$$\nFor a finite sum, we can exchange the order of summation and integration:\n$$\nI_m = \\sum_{\\ell=0}^{\\ell_{\\max}} A_{\\ell} \\int_{0}^{\\pi} P_{\\ell}(\\cos\\theta) P_{m}(\\cos\\theta) \\sin\\theta \\, d\\theta\n$$\nWe now perform the change of variable $\\mu = \\cos\\theta$. As $\\theta$ goes from $0$ to $\\pi$, $\\mu$ goes from $1$ to $-1$. The differential becomes $d\\mu = -\\sin\\theta \\, d\\theta$, or $\\sin\\theta \\, d\\theta = -d\\mu$.\n$$\nI_m = \\sum_{\\ell=0}^{\\ell_{\\max}} A_{\\ell} \\int_{1}^{-1} P_{\\ell}(\\mu) P_{m}(\\mu) (-d\\mu) = \\sum_{\\ell=0}^{\\ell_{\\max}} A_{\\ell} \\int_{-1}^{1} P_{\\ell}(\\mu) P_{m}(\\mu) \\, d\\mu\n$$\nApplying the orthogonality relation:\n$$\nI_m = \\sum_{\\ell=0}^{\\ell_{\\max}} A_{\\ell} \\left( \\frac{2}{2\\ell+1}\\delta_{\\ell m} \\right)\n$$\nThe Kronecker delta ensures that the only non-zero term in the summation is the one where $\\ell = m$. Thus, the sum collapses to:\n$$\nI_m = A_m \\left( \\frac{2}{2m+1} \\right)\n$$\nBy equating the two expressions for $I_m$ and solving for $A_m$ (or renaming the index to $\\ell$ for consistency):\n$$\nA_{\\ell} = \\frac{2\\ell+1}{2} \\int_{0}^{\\pi} f(\\theta) P_{\\ell}(\\cos\\theta) \\sin\\theta \\, d\\theta\n$$\nThis is the exact analytical expression for the coefficient $A_{\\ell}$.\n\nNext, we must approximate this integral using the provided binned data. The data consists of measurements $y_i$ of the function $f(\\theta)$ at the midpoints $\\theta_i$ of angular bins. The problem specifies a midpoint-rule Riemann sum. The integral over $[0, \\pi]$ is partitioned into a sum of integrals over each bin $[\\theta_{edge, i-1}, \\theta_{edge, i}]$.\n$$\n\\int_{0}^{\\pi} g(\\theta) \\, d\\theta = \\sum_{i=1}^{N} \\int_{\\theta_{edge, i-1}}^{\\theta_{edge, i}} g(\\theta) \\, d\\theta\n$$\nwhere $g(\\theta) = f(\\theta) P_{\\ell}(\\cos\\theta) \\sin\\theta$ and $N$ is the number of bins. Using the midpoint rule, the integral over a single bin is approximated as:\n$$\n\\int_{\\theta_{edge, i-1}}^{\\theta_{edge, i}} g(\\theta) \\, d\\theta \\approx g(\\theta_i) \\Delta\\theta_i\n$$\nwhere the midpoint is $\\theta_i = (\\theta_{edge, i-1} + \\theta_{edge, i}) / 2$ and the bin width is $\\Delta\\theta_i = \\theta_{edge, i} - \\theta_{edge, i-1}$. The function $f(\\theta_i)$ is approximated by its measured value $y_i$.\n\nA critical detail is that all angles must be in radians for trigonometric calculations and for the bin width $\\Delta\\theta_i$. The input bin edges are in degrees and require conversion.\n\nCombining these elements, the integral is approximated as:\n$$\n\\int_{0}^{\\pi} f(\\theta) P_{\\ell}(\\cos\\theta) \\sin\\theta \\, d\\theta \\approx \\sum_{i=1}^{N} y_i P_{\\ell}(\\cos\\theta_i) \\sin(\\theta_i) \\Delta\\theta_i\n$$\nSubstituting this sum into our analytical formula yields the final numerical estimator for $A_{\\ell}$:\n$$\nA_{\\ell} \\approx \\frac{2\\ell+1}{2} \\sum_{i=1}^{N} y_i P_{\\ell}(\\cos\\theta_i) \\sin(\\theta_i) \\Delta\\theta_i\n$$\nThis estimator correctly incorporates the non-uniform bin widths $\\Delta\\theta_i$ and the necessary $\\sin\\theta_i$ weight from the integration measure. The implementation will compute this sum for each required value of $\\ell$ from $0$ to $\\ell_{\\max}$ for each test case.", "answer": "```python\nimport numpy as np\nfrom scipy.special import eval_legendre\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for all specified test cases.\n    It orchestrates the calculation of Legendre coefficients and formats\n    the final output as per the problem requirements.\n    \"\"\"\n    test_cases = [\n        {\n            \"l_max\": 4,\n            \"edges_deg\": [0, 30, 60, 90, 120, 150, 180],\n            \"y\": [1.324820, 1.198250, 0.776555, 0.765555, 1.215250, 1.308820],\n        },\n        {\n            \"l_max\": 2,\n            \"edges_deg\": [0, 20, 50, 80, 120, 160, 180],\n            \"y\": [1.723569, 1.833045, 2.089627, 2.131431, 1.885929, 1.718569],\n        },\n        {\n            \"l_max\": 0,\n            \"edges_deg\": [0, 45, 90, 135, 180],\n            \"y\": [1.812132, 1.377868, 1.407868, 1.807132],\n        },\n    ]\n\n    all_results = []\n    for case in test_cases:\n        coeffs = calculate_coefficients(\n            case[\"l_max\"],\n            case[\"edges_deg\"],\n            case[\"y\"]\n        )\n        # Format the coefficients to 6 decimal places and create a string representation\n        rounded_coeffs_str = [f\"{c:.6f}\" for c in coeffs]\n        case_result_str = f\"[{','.join(rounded_coeffs_str)}]\"\n        all_results.append(case_result_str)\n\n    # Final print statement in the exact required format\n    print(f\"[{','.join(all_results)}]\")\n\ndef calculate_coefficients(l_max, edges_deg, y_values):\n    \"\"\"\n    Calculates the Legendre expansion coefficients A_l for a given dataset.\n\n    Args:\n        l_max (int): The maximum degree of the Legendre polynomial in the expansion.\n        edges_deg (list of float): The bin edges in degrees.\n        y_values (list of float): The measured values of f(theta) at bin midpoints.\n\n    Returns:\n        list of float: A list of the calculated coefficients [A_0, A_1, ..., A_lmax].\n    \"\"\"\n    # Convert input lists to numpy arrays for efficient vectorized operations\n    edges_deg = np.array(edges_deg, dtype=float)\n    y_values = np.array(y_values, dtype=float)\n\n    # Convert bin edges from degrees to radians, the correct unit for computation\n    edges_rad = np.deg2rad(edges_deg)\n    \n    # Calculate bin midpoints and widths in radians\n    # midpoints_rad are the theta_i values\n    midpoints_rad = (edges_rad[:-1] + edges_rad[1:]) / 2.0\n    # widths_rad are the Delta_theta_i values\n    widths_rad = np.diff(edges_rad)\n\n    # Prepare to store the resulting coefficients\n    coefficients = []\n    \n    # Loop from l=0 to l_max to calculate each coefficient A_l\n    for l in range(l_max + 1):\n        # The estimator formula is:\n        # A_l = (2*l+1)/2 * sum( y_i * P_l(cos(theta_i)) * sin(theta_i) * Delta_theta_i )\n\n        # Calculate P_l(cos(theta_i)) for all bins at once\n        cos_theta_midpoints = np.cos(midpoints_rad)\n        p_l_values = eval_legendre(l, cos_theta_midpoints)\n        \n        # Calculate sin(theta_i) for all bins\n        sin_theta_midpoints = np.sin(midpoints_rad)\n        \n        # Evaluate the term inside the summation for all bins\n        # This is y_i * P_l(cos(theta_i)) * sin(theta_i)\n        summand = y_values * p_l_values * sin_theta_midpoints\n        \n        # Approximate the integral by the midpoint-rule Riemann sum\n        # sum_{i} (summand_i * Delta_theta_i)\n        integral_approx = np.sum(summand * widths_rad)\n        \n        # Apply the pre-factor to get the coefficient A_l\n        a_l = (2.0 * l + 1.0) / 2.0 * integral_approx\n        coefficients.append(a_l)\n        \n    return coefficients\n\n# Execute the solution\nsolve()\n\n```", "id": "2626680"}]}