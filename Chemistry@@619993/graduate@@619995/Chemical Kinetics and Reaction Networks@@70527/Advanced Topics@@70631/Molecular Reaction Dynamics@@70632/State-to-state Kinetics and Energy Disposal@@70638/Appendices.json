{"hands_on_practices": [{"introduction": "This first practice provides a fundamental exercise in connecting a microscopic kinetic model to a macroscopic experimental observable. By setting up and solving a master equation for a simple two-state photophysical system, you will derive the relationship between the observed fluorescence lifetime and the rate constants for various decay processes, including collisional quenching [@problem_id:2675867]. This exercise is key to understanding how bimolecular rate constants are determined from time-resolved spectroscopic measurements.", "problem": "A dilute gas-phase molecule is modeled as a two-state system with a ground electronic state $\\mathrm{X}$ and an electronically excited state $\\mathrm{A}$. For $t<0$, the system is continuously pumped from $\\mathrm{X}$ to $\\mathrm{A}$ by incoherent light at a constant pumping rate $W$ (in $\\mathrm{s^{-1}}$ per molecule). The excited state $\\mathrm{A}$ can relax by three independent first-order channels: spontaneous radiative emission to $\\mathrm{X}$ with rate constant $k_{r}$ (in $\\mathrm{s^{-1}}$), nonradiative internal conversion with rate constant $k_{nr}$ (in $\\mathrm{s^{-1}}$) that disposes the electronic energy into vibrational energy of the molecule and heat to the bath, and collisional quenching by a quencher species $\\mathrm{Q}$ present at concentration $[\\mathrm{Q}]$ (in $\\mathrm{M}$). The collisional quenching is second order with bimolecular rate constant $k_{q}$ (in $\\mathrm{M^{-1}\\,s^{-1}}$) and thus contributes a pseudo-first-order loss $k_{q}[\\mathrm{Q}]$ (in $\\mathrm{s^{-1}}$) to the $\\mathrm{A}$ population.\n\nAt $t=0$, the pump is instantaneously switched off (so that $W=0$ for $t\\ge 0$) after a steady state has been established for $t<0$. Immediately after $t=0$, the time-resolved fluorescence intensity $I(t)$ is measured and found to be purely single-exponential over several lifetimes. Assume that $I(t)$ is proportional to the radiative emission rate from $\\mathrm{A}$, that is, $I(t)\\propto k_{r}N_{\\mathrm{A}}(t)$ where $N_{\\mathrm{A}}(t)$ is the excited-state population.\n\nStarting only from the population master equation for $N_{\\mathrm{A}}(t)$ and the stated physical processes, derive the functional form of $I(t)$ for $t\\ge 0$ and use it to determine the bimolecular quenching rate constant $k_{q}$ that is consistent with the following measurements and independently known parameters:\n- Measured fluorescence decay lifetime at $[\\mathrm{Q}]=8.00\\times 10^{-3}\\,\\mathrm{M}$: $\\tau = 12.5\\,\\mathrm{ns}$.\n- Independent radiative rate constant: $k_{r}=5.00\\times 10^{7}\\,\\mathrm{s^{-1}}$.\n- Independent nonradiative internal conversion rate constant: $k_{nr}=1.00\\times 10^{7}\\,\\mathrm{s^{-1}}$.\n\nExpress your final answer for $k_{q}$ in $\\mathrm{M^{-1}\\,s^{-1}}$ and round your answer to three significant figures.", "solution": "The problem statement is first subjected to validation.\n\n**Step 1: Extract Givens**\n- System: A two-state molecule with ground state $\\mathrm{X}$ and excited state $\\mathrm{A}$.\n- Pump: For $t<0$, continuous pumping from $\\mathrm{X}$ to $\\mathrm{A}$ at rate $W$. For $t \\ge 0$, $W=0$.\n- Relaxation channels for state $\\mathrm{A}$:\n  1. Spontaneous radiative emission to $\\mathrm{X}$: first-order, rate constant $k_{r}$.\n  2. Nonradiative internal conversion: first-order, rate constant $k_{nr}$.\n  3. Collisional quenching by species $\\mathrm{Q}$: second-order, rate constant $k_{q}$. Pseudo-first-order rate is $k_{q}[\\mathrm{Q}]$.\n- Initial condition: At $t=0$, the system is at steady state established for $t<0$.\n- Measurement: For $t \\ge 0$, fluorescence intensity $I(t)$ is measured.\n- Proportionality: $I(t) \\propto k_{r}N_{\\mathrm{A}}(t)$, where $N_{\\mathrm{A}}(t)$ is the population of state $\\mathrm{A}$.\n- Observation: $I(t)$ is a single-exponential decay.\n- Numerical data:\n  - Measured fluorescence lifetime $\\tau = 12.5\\,\\mathrm{ns}$ at quencher concentration $[\\mathrm{Q}]=8.00\\times 10^{-3}\\,\\mathrm{M}$.\n  - Radiative rate constant $k_{r}=5.00\\times 10^{7}\\,\\mathrm{s^{-1}}$.\n  - Nonradiative internal conversion rate constant $k_{nr}=1.00\\times 10^{7}\\,\\mathrm{s^{-1}}$.\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientific Grounding**: The problem describes a standard scenario in photophysical kinetics, involving optical excitation, radiative and non-radiative decay, and collisional quenching (Stern-Volmer kinetics). All concepts are based on fundamental, well-established principles of chemical kinetics and spectroscopy. It is scientifically sound.\n- **Well-Posedness**: The problem is well-posed. It provides a clear physical model, sufficient data, and a specific quantity to be determined. A unique solution exists and is obtainable from the provided information.\n- **Objectivity**: The problem is stated in precise, quantitative, and objective language, free of ambiguity or subjective claims.\n\n**Step 3: Verdict and Action**\nThe problem is valid. It is a standard, solvable problem in chemical kinetics. A solution will be derived.\n\nThe population dynamics of the excited state $\\mathrm{A}$ are described by a master equation. Let $N_{\\mathrm{A}}(t)$ be the population of molecules in state $\\mathrm{A}$ at time $t$. The rate of change of $N_{\\mathrm{A}}(t)$ is the sum of rates of formation processes minus the sum of rates of depopulation processes.\n\nFor time $t \\ge 0$, the optical pump is switched off, so the pumping rate $W$ is zero. The depopulation of state $\\mathrm{A}$ occurs via three independent, parallel pathways:\n1. Radiative decay: Rate $= k_{r}N_{\\mathrm{A}}(t)$\n2. Nonradiative decay: Rate $= k_{nr}N_{\\mathrm{A}}(t)$\n3. Collisional quenching: Rate $= k_{q}[\\mathrm{Q}]N_{\\mathrm{A}}(t)$\n\nThe master equation for the population $N_{\\mathrm{A}}(t)$ for $t \\ge 0$ is therefore:\n$$ \\frac{dN_{\\mathrm{A}}(t)}{dt} = -k_{r}N_{\\mathrm{A}}(t) - k_{nr}N_{\\mathrm{A}}(t) - k_{q}[\\mathrm{Q}]N_{\\mathrm{A}}(t) $$\nThis equation can be written more compactly by defining an observed total decay rate constant, $k_{obs}$:\n$$ \\frac{dN_{\\mathrm{A}}(t)}{dt} = -(k_{r} + k_{nr} + k_{q}[\\mathrm{Q}]) N_{\\mathrm{A}}(t) = -k_{obs} N_{\\mathrm{A}}(t) $$\nwhere\n$$ k_{obs} = k_{r} + k_{nr} + k_{q}[\\mathrm{Q}] $$\nThis is a first-order linear ordinary differential equation. The solution is obtained by direct integration:\n$$ \\int_{N_{\\mathrm{A}}(0)}^{N_{\\mathrm{A}}(t)} \\frac{dN_{\\mathrm{A}}}{N_{\\mathrm{A}}} = -k_{obs} \\int_{0}^{t} dt' $$\n$$ \\ln\\left(\\frac{N_{\\mathrm{A}}(t)}{N_{\\mathrm{A}}(0)}\\right) = -k_{obs}t $$\n$$ N_{\\mathrm{A}}(t) = N_{\\mathrm{A}}(0) \\exp(-k_{obs}t) $$\nHere, $N_{\\mathrm{A}}(0)$ is the steady-state population at $t=0$, which serves as the initial condition for the decay process.\n\nThe problem states that the fluorescence intensity $I(t)$ is proportional to the radiative emission rate, $k_{r}N_{\\mathrm{A}}(t)$. Let $C$ be the proportionality constant that accounts for detection efficiency and geometric factors.\n$$ I(t) = C k_{r} N_{\\mathrm{A}}(t) $$\nSubstituting the expression for $N_{\\mathrm{A}}(t)$:\n$$ I(t) = C k_{r} N_{\\mathrm{A}}(0) \\exp(-k_{obs}t) $$\nLet $I_{0} = C k_{r} N_{\\mathrm{A}}(0)$ be the intensity at $t=0$. Then, the functional form of the fluorescence decay is:\n$$ I(t) = I_{0} \\exp(-k_{obs}t) $$\nThis derived form is a single-exponential decay, which is consistent with the experimental observation. The characteristic decay time, or lifetime $\\tau$, is the time at which the intensity has decreased to $1/e$ of its initial value. From the functional form, we can identify the relationship between the measured lifetime $\\tau$ and the observed rate constant $k_{obs}$:\n$$ k_{obs} = \\frac{1}{\\tau} $$\nNow we have two expressions for $k_{obs}$, which we can equate:\n$$ \\frac{1}{\\tau} = k_{r} + k_{nr} + k_{q}[\\mathrm{Q}] $$\nThis is the Stern-Volmer equation relating the observed lifetime to the quencher concentration. We are asked to determine the bimolecular quenching rate constant $k_{q}$. We rearrange the equation to solve for $k_{q}$:\n$$ k_{q}[\\mathrm{Q}] = \\frac{1}{\\tau} - k_{r} - k_{nr} $$\n$$ k_{q} = \\frac{1}{[\\mathrm{Q}]} \\left( \\frac{1}{\\tau} - k_{r} - k_{nr} \\right) $$\nNow, we substitute the given numerical values into this expression. The units must be consistent. We convert the lifetime $\\tau$ from nanoseconds to seconds.\n- $\\tau = 12.5\\,\\mathrm{ns} = 12.5 \\times 10^{-9}\\,\\mathrm{s}$\n- $[\\mathrm{Q}] = 8.00 \\times 10^{-3}\\,\\mathrm{M}$\n- $k_{r} = 5.00 \\times 10^{7}\\,\\mathrm{s^{-1}}$\n- $k_{nr} = 1.00 \\times 10^{7}\\,\\mathrm{s^{-1}}$\n\nFirst, calculate the observed decay rate constant $k_{obs} = 1/\\tau$:\n$$ k_{obs} = \\frac{1}{12.5 \\times 10^{-9}\\,\\mathrm{s}} = 8.00 \\times 10^{7}\\,\\mathrm{s^{-1}} $$\nNext, substitute this and the other rate constants into the equation for $k_{q}$:\n$$ k_{q} = \\frac{1}{8.00 \\times 10^{-3}\\,\\mathrm{M}} \\left( 8.00 \\times 10^{7}\\,\\mathrm{s^{-1}} - 5.00 \\times 10^{7}\\,\\mathrm{s^{-1}} - 1.00 \\times 10^{7}\\,\\mathrm{s^{-1}} \\right) $$\nPerforming the subtraction within the parentheses:\n$$ k_{q} = \\frac{1}{8.00 \\times 10^{-3}\\,\\mathrm{M}} \\left( (8.00 - 5.00 - 1.00) \\times 10^{7}\\,\\mathrm{s^{-1}} \\right) $$\n$$ k_{q} = \\frac{1}{8.00 \\times 10^{-3}\\,\\mathrm{M}} \\left( 2.00 \\times 10^{7}\\,\\mathrm{s^{-1}} \\right) $$\nFinally, we perform the division:\n$$ k_{q} = \\frac{2.00 \\times 10^{7}}{8.00 \\times 10^{-3}} \\,\\mathrm{M^{-1}\\,s^{-1}} = 0.250 \\times 10^{10} \\,\\mathrm{M^{-1}\\,s^{-1}} $$\nExpressing the final answer in standard scientific notation with three significant figures, as justified by the precision of the input data:\n$$ k_{q} = 2.50 \\times 10^{9} \\,\\mathrm{M^{-1}\\,s^{-1}} $$", "answer": "$$\\boxed{2.50 \\times 10^{9}}$$", "id": "2675867"}, {"introduction": "We now move from simple state-to-state transitions to the heart of unimolecular reaction theory. This exercise challenges you to apply the principles of Rice–Ramsperger–Kassel–Marcus (RRKM) theory to calculate the energy-dependent microcanonical rate coefficient, $k(E)$, for an isomerization reaction [@problem_id:2675861]. You will use the Whitten-Rabinovitch approximation to estimate the vibrational sum and density of states, gaining direct insight into how the microscopic properties of a molecule and its transition state govern its reactivity.", "problem": "A unimolecular isomerization proceeds over a barrier via a tight transition state. The reactant is a nonlinear triatomic with three vibrational modes and the transition state (activated complex) has one imaginary mode and two real vibrational modes. The vibrational fundamentals (in wavenumbers) are as follows:\n- Reactant vibrational frequencies: $900\\,\\text{cm}^{-1}$, $1200\\,\\text{cm}^{-1}$, $1800\\,\\text{cm}^{-1}$.\n- Transition-state real vibrational frequencies: $400\\,\\text{cm}^{-1}$, $1000\\,\\text{cm}^{-1}$.\n\nRotational constants (in wavenumbers) are provided for realism:\n- Reactant rigid-rotor constants: $A_{R} = 9.8\\,\\text{cm}^{-1}$, $B_{R} = 0.70\\,\\text{cm}^{-1}$, $C_{R} = 0.50\\,\\text{cm}^{-1}$.\n- Transition-state rigid-rotor constants: $A_{\\ddagger} = 6.0\\,\\text{cm}^{-1}$, $B_{\\ddagger} = 0.40\\,\\text{cm}^{-1}$, $C_{\\ddagger} = 0.30\\,\\text{cm}^{-1}$.\n\nAt total internal energy $E = 220\\,\\text{kJ mol}^{-1}$ (measured from the reactant minimum), the microcanonical threshold for reaction is $E_{0} = 140\\,\\text{kJ mol}^{-1}$ measured from the same reference. Assume separability of vibrational and rotational motions and total angular momentum $J=0$ so that rotational contributions can be neglected in the microcanonical counting. Assume reaction-path degeneracy unity and overall symmetry numbers equal to $1$.\n\nUsing microcanonical Rice–Ramsperger–Kassel–Marcus (RRKM) theory with Whitten–Rabinovitch corrections to approximate the quantum and anharmonic effects in the vibrational density and sum of states, compute the microcanonical rate coefficient $k(E)$ at the specified $E$. Use the following constants: Planck’s constant $h = 6.62607015\\times 10^{-34}\\,\\text{J s}$, speed of light $c = 2.99792458\\times 10^{10}\\,\\text{cm s}^{-1}$, and Avogadro’s number $N_{A} = 6.02214076\\times 10^{23}\\,\\text{mol}^{-1}$. Express your final answer in $\\text{s}^{-1}$ and round your result to three significant figures.", "solution": "The fundamental base is microcanonical Transition State Theory leading to the Rice–Ramsperger–Kassel–Marcus (RRKM) expression for unimolecular reactions. For a given total internal energy $E$, the microcanonical rate coefficient is\n$$\nk(E) = \\frac{N^{\\ddagger}(E - E_{0})}{h\\,\\rho(E)},\n$$\nwhere $N^{\\ddagger}(E - E_{0})$ is the sum of states of the transition state (activated complex) at energy $E - E_{0}$ above its minimum (excluding the unstable mode along the reaction coordinate) and $\\rho(E)$ is the density of states of the reactant at energy $E$ above its minimum. Under the $J=0$ assumption, rotational contributions are neglected in both numerator and denominator, so only vibrational states are counted.\n\nTo approximate the vibrational state counts, we use the Whitten–Rabinovitch (WR) correction, a well-tested method to incorporate quantum level spacing and leading anharmonicity effects into semiclassical state counting. For a set of $s$ independent vibrational modes with harmonic spacings $\\{\\varepsilon_{i}\\}$, the WR approximation replaces the classical expressions by energy-shifted forms:\n- Vibrational density of states for $s$ modes:\n$$\n\\rho_{\\text{WR}}(E) \\approx \\frac{(E + \\delta)^{s-1}}{(s-1)!\\,\\prod_{i=1}^{s}\\varepsilon_{i}},\n$$\n- Vibrational sum of states for $s$ modes:\n$$\nN_{\\text{WR}}(E) \\approx \\frac{(E + \\delta)^{s}}{s!\\,\\prod_{i=1}^{s}\\varepsilon_{i}},\n$$\nwhere the shift $\\delta$ is approximately the vibrational zero-point contribution $\\delta = \\frac{1}{2}\\sum_{i=1}^{s}\\varepsilon_{i}$, and $\\varepsilon_{i} = h c \\tilde{\\nu}_{i}$ with $\\tilde{\\nu}_{i}$ in $\\text{cm}^{-1}$.\n\nFor the present system:\n- The reactant has $s_{R} = 3$ vibrational modes with $\\tilde{\\nu}_{R} = \\{900,\\,1200,\\,1800\\}\\,\\text{cm}^{-1}$. Its WR density is\n$$\n\\rho_{R}(E) \\approx \\frac{(E + \\delta_{R})^{2}}{2!\\,\\prod_{i=1}^{3}\\varepsilon_{R,i}},\n\\quad \\delta_{R} = \\frac{1}{2}\\sum_{i=1}^{3}\\varepsilon_{R,i}.\n$$\n- The transition state has $s_{\\ddagger} = 2$ stable vibrational modes with $\\tilde{\\nu}_{\\ddagger} = \\{400,\\,1000\\}\\,\\text{cm}^{-1}$. Its WR sum of states at $E' = E - E_{0}$ is\n$$\nN^{\\ddagger}(E') \\approx \\frac{(E' + \\delta_{\\ddagger})^{2}}{2!\\,\\prod_{j=1}^{2}\\varepsilon_{\\ddagger,j}},\n\\quad \\delta_{\\ddagger} = \\frac{1}{2}\\sum_{j=1}^{2}\\varepsilon_{\\ddagger,j}.\n$$\n\nSubstituting these into the RRKM expression yields\n$$\nk(E) = \\frac{ \\dfrac{(E' + \\delta_{\\ddagger})^{2}}{2!\\,\\prod_{j=1}^{2}\\varepsilon_{\\ddagger,j}} }{ h\\, \\dfrac{(E + \\delta_{R})^{2}}{2!\\,\\prod_{i=1}^{3}\\varepsilon_{R,i}} }\n= \\left(\\frac{E' + \\delta_{\\ddagger}}{E + \\delta_{R}}\\right)^{2}\n\\frac{ \\prod_{i=1}^{3}\\varepsilon_{R,i} }{ h\\, \\prod_{j=1}^{2}\\varepsilon_{\\ddagger,j} }.\n$$\nWith $\\varepsilon_{k} = h c \\tilde{\\nu}_{k}$, the product ratio simplifies:\n$$\n\\frac{ \\prod_{i=1}^{3}\\varepsilon_{R,i} }{ h\\, \\prod_{j=1}^{2}\\varepsilon_{\\ddagger,j} }\n= \\frac{ (h c)^{3}\\,\\prod_{i=1}^{3}\\tilde{\\nu}_{R,i} }{ h\\,(h c)^{2}\\,\\prod_{j=1}^{2}\\tilde{\\nu}_{\\ddagger,j} }\n= c\\,\\frac{ \\prod_{i=1}^{3}\\tilde{\\nu}_{R,i} }{ \\prod_{j=1}^{2}\\tilde{\\nu}_{\\ddagger,j} }.\n$$\nTherefore,\n$$\nk(E) = c\\,\\left(\\frac{E' + \\delta_{\\ddagger}}{E + \\delta_{R}}\\right)^{2}\n\\frac{ \\tilde{\\nu}_{R,1}\\tilde{\\nu}_{R,2}\\tilde{\\nu}_{R,3} }{ \\tilde{\\nu}_{\\ddagger,1}\\tilde{\\nu}_{\\ddagger,2} }.\n$$\n\nWe now compute all quantities numerically in SI units for energies and in $\\text{cm}^{-1}$ for wavenumbers.\n\nStep 1: Convert energies per mole to per molecule. The conversion factor is\n$$\n\\alpha = \\frac{1000}{N_{A}}\\,\\text{J mol}^{-1}\\to\\text{J} = 1.660539067\\times 10^{-21}\\,\\text{J}.\n$$\nThus,\n$$\nE = 220\\,\\text{kJ mol}^{-1} = 220\\,\\alpha = 3.6531859474\\times 10^{-19}\\,\\text{J},\n$$\n$$\nE' = E - E_{0} = (220 - 140)\\,\\text{kJ mol}^{-1} = 80\\,\\alpha = 1.3284312536\\times 10^{-19}\\,\\text{J}.\n$$\n\nStep 2: Compute vibrational quanta and WR shifts. With $\\varepsilon = h c \\tilde{\\nu}$ and $h c = 1.98644586\\times 10^{-23}\\,\\text{J cm}$:\n- Reactant:\n$$\n\\sum_{i=1}^{3}\\tilde{\\nu}_{R,i} = 900 + 1200 + 1800 = 3900\\,\\text{cm}^{-1},\n$$\n$$\n\\delta_{R} = \\frac{1}{2} h c \\times 3900\n= \\frac{1}{2}\\times 1.98644586\\times 10^{-23}\\times 3900\n= 3.873569427\\times 10^{-20}\\,\\text{J}.\n$$\n- Transition state:\n$$\n\\sum_{j=1}^{2}\\tilde{\\nu}_{\\ddagger,j} = 400 + 1000 = 1400\\,\\text{cm}^{-1},\n$$\n$$\n\\delta_{\\ddagger} = \\frac{1}{2} h c \\times 1400\n= \\frac{1}{2}\\times 1.98644586\\times 10^{-23}\\times 1400\n= 1.390512102\\times 10^{-20}\\,\\text{J}.\n$$\n\nStep 3: Assemble the energy ratio:\n$$\nE + \\delta_{R} = 3.6531859474\\times 10^{-19} + 3.873569427\\times 10^{-20}\n= 4.0405428901\\times 10^{-19}\\,\\text{J},\n$$\n$$\nE' + \\delta_{\\ddagger} = 1.3284312536\\times 10^{-19} + 1.390512102\\times 10^{-20}\n= 1.4674824638\\times 10^{-19}\\,\\text{J}.\n$$\nHence\n$$\n\\left(\\frac{E' + \\delta_{\\ddagger}}{E + \\delta_{R}}\\right)^{2}\n= \\left(\\frac{1.4674824638\\times 10^{-19}}{4.0405428901\\times 10^{-19}}\\right)^{2}\n\\approx (0.36318943)^{2} \\approx 0.13190656.\n$$\n\nStep 4: Compute the wavenumber product ratio and the prefactor:\n$$\n\\frac{ \\tilde{\\nu}_{R,1}\\tilde{\\nu}_{R,2}\\tilde{\\nu}_{R,3} }{ \\tilde{\\nu}_{\\ddagger,1}\\tilde{\\nu}_{\\ddagger,2} }\n= \\frac{900\\times 1200\\times 1800}{400\\times 1000}\n= \\frac{1.944\\times 10^{9}}{4.0\\times 10^{5}} = 4860,\n$$\nand with $c = 2.99792458\\times 10^{10}\\,\\text{cm s}^{-1}$,\n$$\nc\\times 4860 = 1.45699134588\\times 10^{14}\\,\\text{s}^{-1}.\n$$\n\nStep 5: Final rate coefficient:\n$$\nk(E) = \\left[1.45699134588\\times 10^{14}\\right]\\times 0.13190656\n= 1.9217716808\\times 10^{13}\\,\\text{s}^{-1}.\n$$\n\nRounding to three significant figures and expressing in $\\text{s}^{-1}$ gives\n$$\nk(E) \\approx 1.92\\times 10^{13}\\,\\text{s}^{-1}.\n$$\n\nNotes on modeling assumptions:\n- The $J=0$ constraint eliminates rotational contributions from the microcanonical counting; hence the provided rotational constants serve only to establish nonlinearity and physical plausibility.\n- The Whitten–Rabinovitch shifts $\\delta_{R}$ and $\\delta_{\\ddagger}$ approximate quantum level spacing and leading anharmonicity effects in the vibrational state counts. At high excitation, the resulting expression reduces smoothly to the classical limit.\n- Symmetry numbers and reaction-path degeneracy were set to unity as specified, so no additional degeneracy factors enter $k(E)$.", "answer": "$$\\boxed{1.92\\times 10^{13}}$$", "id": "2675861"}, {"introduction": "This final practice synthesizes the concepts of energy-dependent reaction and collisional energy transfer into a comprehensive computational model. You will tackle the challenge of setting up and numerically solving a one-dimensional master equation for a chemically activated reaction system under steady-state conditions [@problem_id:2675883]. By implementing this model, you will directly observe how the competition between unimolecular reaction and collisional stabilization gives rise to pressure-dependent product yields, bridging the gap from microscopic state-to-state processes to macroscopic chemical kinetics.", "problem": "Consider a chemically activated association that forms an energized intermediate denoted by $I^{\\ast}$. The intermediate $I^{\\ast}$ is characterized by an internal energy $E$ and can either (i) undergo unimolecular reaction to products with a microcanonical rate coefficient $k(E)$, or (ii) be collisionally transferred in energy by a bath gas with an energy-transfer kernel $W(E' \\to E)$ occurring at a collision frequency $Z$ proportional to the bath gas concentration. Assume that energies are discretized into equally spaced grains $E_{i} = i \\,\\Delta E$ for $i=0,1,\\dots,N$, where $\\Delta E$ is the energy grain size. Assume that the system is in the steady state under a constant formation source $S(E)$ for $I^{\\ast}$, and that energies below a threshold $E_{0}$ are considered collisionally stabilized (absorbing sink), while unimolecular reaction to products is only possible for $E \\ge E_{0}$.\n\nStarting from the continuous master equation for the energy-resolved population $n(E,t)$:\n$$\n\\frac{\\partial n(E,t)}{\\partial t} = S(E) + Z \\int \\left[n(E',t)\\, W(E' \\to E) - n(E,t)\\, W(E \\to E') \\right] \\, dE' - k(E)\\, n(E,t),\n$$\nderive its discretized steady-state form for the non-absorbing energy grains $E_{i} \\ge E_{0}$, and express it as a linear system in the unknown steady-state populations $n_{i} = n(E_{i})$. Use the following physical and modeling assumptions to fully specify a computational task:\n\n1. Discretization and absorbing set:\n   - Let the energy grid be $E_{i} = i \\,\\Delta E$ with $\\Delta E = 100\\ \\mathrm{cm}^{-1}$ and $E_{\\max} = 20000\\ \\mathrm{cm}^{-1}$, so that $N = 200$.\n   - Let the absorbing (stabilized) set be all grains with $E_{i} < E_{0}$, and the non-absorbing set be all grains with $E_{i} \\ge E_{0}$.\n   - Use $E_{0} = 1500\\ \\mathrm{cm}^{-1}$.\n\n2. Microcanonical unimolecular rate $k(E)$:\n   - For $E \\ge E_{0}$, use a model\n     $$\n     k(E) = k_{\\mathrm{ref}} \\left( \\frac{E - E_{0}}{E_{\\mathrm{ref}}} \\right)^{m},\n     $$\n     and $k(E) = 0$ for $E < E_{0}$.\n   - Use $k_{\\mathrm{ref}} = 10^{8}\\ \\mathrm{s}^{-1}$, $E_{\\mathrm{ref}} = 1000\\ \\mathrm{cm}^{-1}$, and $m = 1.5$.\n\n3. Source term $S(E)$:\n   - A constant overall formation rate $F_{\\mathrm{form}}$ is distributed over the non-absorbing grains according to\n     $$\n     S(E) \\propto \\exp\\!\\left(-\\frac{E - E_{0}}{E_{\\mathrm{ex}}}\\right) \\quad \\text{for } E \\ge E_{0}, \\quad S(E) = 0 \\text{ for } E < E_{0},\n     $$\n     normalized so that $\\sum_{E_{i} \\ge E_{0}} S(E_{i}) = F_{\\mathrm{form}}$.\n   - Use $F_{\\mathrm{form}} = 1\\ \\mathrm{s}^{-1}$ and $E_{\\mathrm{ex}} = 2000\\ \\mathrm{cm}^{-1}$.\n\n4. Energy-transfer kernel $W(E' \\to E)$ per collision:\n   - Construct $W$ so that it satisfies detailed balance with respect to a stationary distribution $\\pi(E)$ and enforces realistic energy step sizes via a symmetric proposal. Specifically:\n     - Let the target stationary distribution be\n       $$\n       \\pi(E) \\propto g(E)\\, \\exp\\!\\left(-\\frac{E}{\\theta}\\right), \\quad \\theta = k_{\\mathrm{B}}^{\\ast} T,\n       $$\n       where $g(E) \\propto E^{s-1}$ is a density of states for $s$ harmonic degrees of freedom, $T$ is the bath temperature, and $k_{\\mathrm{B}}^{\\ast} = 0.69503476\\ \\mathrm{cm}^{-1}\\ \\mathrm{K}^{-1}$ is Boltzmann’s constant expressed in wavenumber units.\n     - Use $s = 8$.\n     - Use a Metropolis-Hastings (MH) construction with a symmetric proposal\n       $$\n       Q(E' \\to E) \\propto \\exp\\!\\left(-\\frac{|E - E'|}{E_{\\mathrm{step}}}\\right), \\quad E \\ne E',\n       $$\n       normalized over $E$ for each fixed $E'$ so that $\\sum_{E} Q(E' \\to E) = 1$ and $Q(E' \\to E') = 0$.\n     - The accepted transition probabilities for $E \\ne E'$ are\n       $$\n       W(E' \\to E) = Q(E' \\to E)\\, \\min\\!\\left(1,\\ \\frac{\\pi(E)}{\\pi(E')}\\right),\n       $$\n       and the self-probability ensures normalization,\n       $$\n       W(E' \\to E') = 1 - \\sum_{E \\ne E'} W(E' \\to E).\n       $$\n     - This construction guarantees detailed balance $\\pi(E') W(E' \\to E) = \\pi(E) W(E \\to E')$ and $\\sum_{E} W(E' \\to E) = 1$ for each origin energy $E'$.\n\n5. Steady-state master equation in discretized form:\n   - For each non-absorbing grain index $i$ (with $E_{i} \\ge E_{0}$), the steady-state equation is\n     $$\n     0 = S_{i} + Z \\sum_{j \\in \\mathcal{N}} n_{j}\\, W_{j \\to i}\\; -\\; Z\\, n_{i}\\; -\\; k_{i}\\, n_{i},\n     $$\n     where $\\mathcal{N}$ is the set of non-absorbing indices, $S_{i} = S(E_{i})$, and $k_{i} = k(E_{i})$. Note that the total collisional loss $Z n_{i}$ accounts for transitions from $i$ to all destinations (including absorbing grains), while the collisional gain sums only over non-absorbing origins.\n   - In matrix form for the unknown vector $\\boldsymbol{n}$ over non-absorbing grains:\n     $\n     \\mathbf{A}\\, \\boldsymbol{n} = -\\boldsymbol{S},\n     $\n     with\n     $\n     \\mathbf{A} = -\\mathrm{diag}(k_{i} + Z) + Z\\, \\mathbf{W}_{\\mathcal{N}}^{\\top},\n     $\n     where $\\mathbf{W}_{\\mathcal{N}}$ is the submatrix of $W$ restricted to rows and columns in $\\mathcal{N}$ and $\\boldsymbol{S}$ is the source restricted to $\\mathcal{N}$.\n\n6. Fluxes and product yield:\n   - The steady-state flux to products is\n     $$\n     R_{\\mathrm{prod}} = \\sum_{i \\in \\mathcal{N}} k_{i}\\, n_{i}.\n     $$\n   - The steady-state flux to stabilization (absorbing sink) is\n     $$\n     R_{\\mathrm{stab}} = Z \\sum_{i \\in \\mathcal{N}} n_{i} \\left( \\sum_{j \\in \\mathcal{A}} W_{i \\to j} \\right),\n     $$\n     where $\\mathcal{A}$ denotes absorbing indices with $E_{j} < E_{0}$.\n   - Mass balance implies $R_{\\mathrm{prod}} + R_{\\mathrm{stab}} = F_{\\mathrm{form}}$ under these assumptions.\n   - Define the pressure-dependent product yield as the fraction\n     $$\n     Y_{\\mathrm{prod}} = \\frac{R_{\\mathrm{prod}}}{R_{\\mathrm{prod}} + R_{\\mathrm{stab}}}.\n     $$\n\nYour task is to implement a program that constructs the energy grid, $k(E)$, $S(E)$, and the MH-based kernel $W(E' \\to E)$, solves the steady-state linear system for $\\boldsymbol{n}$, and computes $Y_{\\mathrm{prod}}$ for the parameter sets below. Use the following test suite, which varies collision frequency $Z$, characteristic energy step $E_{\\mathrm{step}}$, and temperature $T$:\n- Case 1 (general): $Z = 10^{8}\\ \\mathrm{s}^{-1}$, $E_{\\mathrm{step}} = 300\\ \\mathrm{cm}^{-1}$, $T = 300\\ \\mathrm{K}$.\n- Case 2 (low pressure limit): $Z = 10^{6}\\ \\mathrm{s}^{-1}$, $E_{\\mathrm{step}} = 300\\ \\mathrm{cm}^{-1}$, $T = 300\\ \\mathrm{K}$.\n- Case 3 (high pressure limit): $Z = 10^{9}\\ \\mathrm{s}^{-1}$, $E_{\\mathrm{step}} = 300\\ \\mathrm{cm}^{-1}$, $T = 300\\ \\mathrm{K}$.\n- Case 4 (small energy transfer per collision): $Z = 10^{8}\\ \\mathrm{s}^{-1}$, $E_{\\mathrm{step}} = 100\\ \\mathrm{cm}^{-1}$, $T = 300\\ \\mathrm{K}$.\n- Case 5 (large energy transfer and hotter bath): $Z = 10^{8}\\ \\mathrm{s}^{-1}$, $E_{\\mathrm{step}} = 600\\ \\mathrm{cm}^{-1}$, $T = 600\\ \\mathrm{K}$.\n\nAll energies must be treated in $\\mathrm{cm}^{-1}$, temperatures in $\\mathrm{K}$, and rates in $\\mathrm{s}^{-1}$. Your program must output the computed yields for the five cases as decimal floats, each rounded to six decimal places, in a single line formatted exactly as a comma-separated list enclosed in square brackets, for example $[0.123456,0.234567,0.345678,0.456789,0.567890]$.", "solution": "The problem requires the calculation of the pressure-dependent product yield for a chemically activated reaction system described by a one-dimensional steady-state master equation. The solution necessitates a full construction of the discretized system, including the microcanonical reaction rates, the formation source term, and the collisional energy transfer kernel, followed by solving the resulting linear system for the steady-state populations. The procedure is as follows.\n\nFirst, we establish the discretized energy domain. The energy levels are given by $E_{i} = i \\cdot \\Delta E$ for $i = 0, 1, \\dots, N$. With the parameters $\\Delta E = 100\\ \\mathrm{cm}^{-1}$ and $N = 200$, we have $201$ energy grains from $E_{0} = 0\\ \\mathrm{cm}^{-1}$ to $E_{200} = 20000\\ \\mathrm{cm}^{-1}$. The energy domain is partitioned into two sets based on the threshold energy $E_{0, \\text{thresh}} = 1500\\ \\mathrm{cm}^{-1}$.\nThe set of absorbing states, $\\mathcal{A}$, contains grains with energy below this threshold:\n$$ \\mathcal{A} = \\{ i \\mid E_{i} < 1500\\ \\mathrm{cm}^{-1} \\} = \\{ i \\mid i \\cdot 100 < 1500 \\} = \\{0, 1, \\dots, 14\\}. $$\nThe set of non-absorbing, or reactive, states, $\\mathcal{N}$, contains grains with energy at or above the threshold:\n$$ \\mathcal{N} = \\{ i \\mid E_{i} \\ge 1500\\ \\mathrm{cm}^{-1} \\} = \\{ i \\mid i \\cdot 100 \\ge 1500 \\} = \\{15, 16, \\dots, 200\\}. $$\nThe problem is solved for the populations $n_i$ for $i \\in \\mathcal{N}$. The number of such states is $200 - 15 + 1 = 186$.\n\nNext, we specify the vectors and matrices defined over this grid.\n\nThe microcanonical rate coefficient $k(E)$ is discretized to a vector $\\boldsymbol{k}$ over the non-absorbing set $\\mathcal{N}$. For each $i \\in \\mathcal{N}$, the rate $k_i$ is given by:\n$$ k_{i} = k(E_{i}) = k_{\\mathrm{ref}} \\left( \\frac{E_{i} - E_{0, \\text{thresh}}}{E_{\\mathrm{ref}}} \\right)^{m} $$\nUsing the given parameters $k_{\\mathrm{ref}} = 10^{8}\\ \\mathrm{s}^{-1}$, $E_{\\mathrm{ref}} = 1000\\ \\mathrm{cm}^{-1}$, and $m = 1.5$, we compute the value of $k_i$ for each $i \\in \\mathcal{N}$. For $i \\in \\mathcal{A}$, $k_i = 0$.\n\nThe source term $S(E)$ is discretized into a vector $\\boldsymbol{S}$ over $\\mathcal{N}$. It is non-zero only for $i \\in \\mathcal{N}$, where it is proportional to an exponential decay:\n$$ S_{i} \\propto \\exp\\!\\left(-\\frac{E_{i} - E_{0, \\text{thresh}}}{E_{\\mathrm{ex}}}\\right) $$\nwith $E_{\\mathrm{ex}} = 2000\\ \\mathrm{cm}^{-1}$. This vector must be normalized such that the total formation rate equals $F_{\\mathrm{form}} = 1\\ \\mathrm{s}^{-1}$. First, we compute the unnormalized source terms $S'_{i}$ for $i \\in \\mathcal{N}$. The normalization constant is $C = F_{\\mathrm{form}} / \\sum_{j \\in \\mathcal{N}} S'_{j}$. The final source vector components are then $S_{i} = C \\cdot S'_{i}$.\n\nThe most critical component is the energy transfer transition probability matrix $\\mathbf{W}$, where $W_{j \\to i}$ is the probability of transition from grain $j$ to grain $i$ per collision. Its construction follows a Metropolis-Hastings procedure to ensure detailed balance.\nFirst, we define the stationary distribution $\\pi(E)$ with which the kernel must comply. It is given by $\\pi(E) \\propto g(E) \\exp(-E/\\theta)$, where $\\theta = k_{\\mathrm{B}}^{\\ast} T$. The density of states $g(E)$ for $s=8$ harmonic oscillators is $g(E) \\propto E^{s-1} = E^{7}$. Thus, for each energy grain $E_i$, we have $\\pi_i \\propto E_i^{7} \\exp(-E_i/\\theta)$. Note that $\\pi_0 = 0$ since $E_0=0$.\nSecond, we construct the symmetric proposal matrix $\\mathbf{Q}$. For each origin grain $j$, the probability to propose a move to grain $i \\ne j$ is $Q_{j \\to i} \\propto \\exp(-|E_i - E_j|/E_{\\mathrm{step}})$. The proposal probabilities from grain $j$ are normalized such that $\\sum_{i \\ne j} Q_{j \\to i} = 1$, and $Q_{j \\to j} = 0$.\nThird, the accepted transition probabilities $W_{j \\to i}$ for $i \\ne j$ are calculated as:\n$$ W_{j \\to i} = Q_{j \\to i} \\min\\!\\left(1,\\ \\frac{\\pi_i}{\\pi_j}\\right) $$\nThis step requires careful handling for $j=0$ where $\\pi_0=0$. However, since we only need to solve for populations in $\\mathcal{N}$, where $E_j > 0$ and thus $\\pi_j > 0$, no division by zero will occur in the relevant sub-matrix construction.\nFinally, the diagonal elements of $\\mathbf{W}$ are set to ensure normalization of the rows (conservation of probability):\n$$ W_{j \\to j} = 1 - \\sum_{i \\ne j} W_{j \\to i} $$\n\nWith all components defined, we formulate the steady-state master equation as a linear system $\\mathbf{A} \\boldsymbol{n} = -\\boldsymbol{S}$ for the vector of unknown populations $\\boldsymbol{n} = [n_i]_{i \\in \\mathcal{N}}$. The system matrix $\\mathbf{A}$ is given by:\n$$ \\mathbf{A} = Z\\, \\mathbf{W}_{\\mathcal{N}}^{\\top} - (Z \\mathbf{I} + \\mathbf{K}) $$\nHere, $\\mathbf{W}_{\\mathcal{N}}$ is the submatrix of $\\mathbf{W}$ for transitions within the non-absorbing set, i.e., $W_{ij}$ for $i,j \\in \\mathcal{N}$. $\\mathbf{K}$ is the diagonal matrix of reaction rates, $[\\mathbf{K}]_{ii} = k_i$ for $i \\in \\mathcal{N}$. $\\mathbf{I}$ is the identity matrix, and $Z$ is the collision frequency. The populations vector $\\boldsymbol{n}$ can be found by solving this linear system.\n\nOnce $\\boldsymbol{n}$ is determined, we compute the macroscopic fluxes. The flux to products, $R_{\\mathrm{prod}}$, is the sum of all unimolecular reaction fluxes:\n$$ R_{\\mathrm{prod}} = \\sum_{i \\in \\mathcal{N}} k_{i}\\, n_{i} = \\boldsymbol{k} \\cdot \\boldsymbol{n} $$\nThe flux to stabilization, $R_{\\mathrm{stab}}$, is the sum of all collisional deactivation fluxes from the non-absorbing set $\\mathcal{N}$ to the absorbing set $\\mathcal{A}$:\n$$ R_{\\mathrm{stab}} = Z \\sum_{i \\in \\mathcal{N}} n_{i} \\left( \\sum_{j \\in \\mathcal{A}} W_{i \\to j} \\right) $$\nThe product yield $Y_{\\mathrm{prod}}$ is the fraction of the total formation flux that leads to products. Given the mass balance $R_{\\mathrm{prod}} + R_{\\mathrm{stab}} = F_{\\mathrm{form}}$, the yield is:\n$$ Y_{\\mathrm{prod}} = \\frac{R_{\\mathrm{prod}}}{R_{\\mathrm{prod}} + R_{\\mathrm{stab}}} = \\frac{R_{\\mathrm{prod}}}{F_{\\mathrm{form}}} $$\nSince $F_{\\mathrm{form}} = 1\\ \\mathrm{s}^{-1}$, the yield is numerically equal to $R_{\\mathrm{prod}}$. This computation is repeated for each of the five test cases provided.", "answer": "```python\nimport numpy as np\nfrom scipy.linalg import solve\n\ndef calculate_yield(Z, E_step, T):\n    \"\"\"\n    Calculates the product yield for a given set of parameters.\n\n    Args:\n        Z (float): Collision frequency in s^-1.\n        E_step (float): Characteristic energy step for transfer in cm^-1.\n        T (float): Bath temperature in K.\n\n    Returns:\n        float: The product yield Y_prod.\n    \"\"\"\n    # 1. Discretization and Constants\n    delta_E = 100.0  # cm^-1\n    N = 200\n    E_max = 20000.0  # cm^-1\n    energies = np.arange(N + 1) * delta_E\n    \n    E0_thresh = 1500.0   # cm^-1\n    k_ref = 1.0e8    # s^-1\n    E_ref = 1000.0   # cm^-1\n    m = 1.5\n    \n    F_form = 1.0     # s^-1\n    E_ex = 2000.0    # cm^-1\n    \n    s = 8\n    kB_star = 0.69503476  # cm^-1 K^-1\n\n    # Indices for absorbing and non-absorbing sets\n    A_idx = np.where(energies < E0_thresh)[0]\n    N_idx = np.where(energies >= E0_thresh)[0]\n    num_N = len(N_idx)\n    num_total = N + 1\n\n    # 2. Microcanonical Rate Coefficients k(E)\n    k_vec = np.zeros(num_N)\n    energies_N = energies[N_idx]\n    # np.maximum handles case where E_i might be slightly less than E0_thresh due to float precision\n    non_neg_E_diff = np.maximum(0, energies_N - E0_thresh)\n    k_vec = k_ref * (non_neg_E_diff / E_ref)**m\n\n    # 3. Source Term S(E)\n    S_unnormalized = np.exp(-(energies_N - E0_thresh) / E_ex)\n    S_vec = F_form * S_unnormalized / np.sum(S_unnormalized)\n\n    # 4. Energy Transfer Kernel W(E' -> E)\n    # Stationary distribution pi(E)\n    theta = kB_star * T\n    pi = np.zeros(num_total)\n    # Avoid E=0 for E^(s-1) term; pi[0] will be 0 as energies[0] is 0.\n    non_zero_E_mask = energies > 0\n    pi[non_zero_E_mask] = (energies[non_zero_E_mask]**(s - 1)) * np.exp(-energies[non_zero_E_mask] / theta)\n\n    # Proposal matrix Q(E' -> E)\n    Q = np.zeros((num_total, num_total))\n    E_diff_matrix = np.abs(energies[:, np.newaxis] - energies)\n    Q_unnormalized = np.exp(-E_diff_matrix / E_step)\n    np.fill_diagonal(Q_unnormalized, 0)\n    \n    row_sums = Q_unnormalized.sum(axis=1)\n    # Avoid division by zero for any rows that might sum to zero (unlikely)\n    non_zero_rows = row_sums > 1e-12\n    Q[non_zero_rows] = Q_unnormalized[non_zero_rows] / row_sums[non_zero_rows, np.newaxis]\n\n    # Transition matrix W(E' -> E)\n    W = np.zeros((num_total, num_total))\n    \n    # Off-diagonal elements\n    for j in range(num_total): # From state j\n        if pi[j] > 1e-12: # Avoid division by zero\n            # Metropolis-Hastings acceptance probability\n            acceptance = np.minimum(1.0, pi / pi[j])\n            W[j, :] = Q[j, :] * acceptance\n    \n    # Diagonal elements (ensure rows sum to 1)\n    np.fill_diagonal(W, 1.0 - W.sum(axis=1))\n    \n    # 5. Formulate and Solve the Linear System\n    # Extract submatrix for non-absorbing states\n    W_NN = W[np.ix_(N_idx, N_idx)]\n    \n    # A = Z * W_NN^T - (Z*I + K_diag)\n    A_matrix = Z * W_NN.T - (Z * np.identity(num_N) + np.diag(k_vec))\n    \n    # Solve A*n = -S\n    n_vec = solve(A_matrix, -S_vec, assume_a='gen')\n\n    # 6. Calculate Fluxes and Yield\n    R_prod = np.dot(k_vec, n_vec)\n\n    # The problem asks to compute Y_prod, which is R_prod / F_form.\n    # Since F_form = 1, Y_prod = R_prod. We can also verify with R_stab.\n    # W_NA = W[np.ix_(N_idx, A_idx)]\n    # R_stab = Z * np.dot(n_vec, W_NA.sum(axis=1))\n    # Y_prod_check = R_prod / (R_prod + R_stab)\n    # assert np.isclose(R_prod / F_form, Y_prod_check)\n    \n    Y_prod = R_prod / F_form\n    \n    return Y_prod\n\ndef solve_problem():\n    \"\"\"\n    Main function to solve the problem for the given test cases.\n    \"\"\"\n    test_cases = [\n        # (Z, E_step, T)\n        (1.0e8, 300.0, 300.0),  # Case 1\n        (1.0e6, 300.0, 300.0),  # Case 2\n        (1.0e9, 300.0, 300.0),  # Case 3\n        (1.0e8, 100.0, 300.0),  # Case 4\n        (1.0e8, 600.0, 600.0),  # Case 5\n    ]\n    \n    results = []\n    for Z, E_step, T in test_cases:\n        yield_val = calculate_yield(Z, E_step, T)\n        results.append(f\"{yield_val:.6f}\")\n        \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\n# Execute the solution\nsolve_problem()\n```", "id": "2675883"}]}