{"hands_on_practices": [{"introduction": "The harpoon mechanism is defined by its long-range nature, initiated by an electron transfer that creates a strong Coulombic attraction. This exercise explores the classic Langevin model, which describes this interaction using an ion-induced dipole potential, $V(r) \\propto -1/r^4$. By applying the principles of energy and angular momentum conservation, you will derive the capture cross section $\\sigma(v)$ from scratch, revealing its characteristic inverse dependence on relative velocity, a hallmark result in gas-phase kinetics [@problem_id:2680311].", "problem": "A bimolecular gas-phase reaction proceeds through long-range capture and subsequent electron transfer characteristic of the harpoon mechanism, in contrast to short-range stripping and rebound mechanisms. Consider a single-channel capture model in which the probability of reaction at a given impact parameter $b$ is described by a step-function opacity function $P(b)=\\Theta(b_{c}-b)$, where $\\Theta(x)$ is the Heaviside step function with $\\Theta(x)=1$ for $x\\ge 0$ and $\\Theta(x)=0$ otherwise, and $b_{c}$ is a critical impact parameter determined by conservation of energy and angular momentum. The relative speed is $v$ and the reduced mass is $\\mu$. After electron transfer, the interaction is governed by an ion–induced dipole potential $V(r)=-C_{4}/r^{4}$ with $C_{4}>0$. Assume classical motion in a central potential and that reaction occurs if the collision energy exceeds the centrifugal barrier associated with $V(r)$.\n\nUsing only conservation of energy and angular momentum, together with the form of $V(r)$, and the definition of the reduced mass $\\mu$, answer the following:\n\n1) State the range of impact parameters $b$ that contributes to the reactive cross section under the assumed opacity function $P(b)=\\Theta(b_{c}-b)$.\n\n2) Derive the critical impact parameter $b_{c}$ as a function of $v$, $\\mu$, and $C_{4}$, by requiring that the collision energy equals the height of the centrifugal barrier in the effective potential.\n\n3) Hence compute the reactive cross section $\\sigma(v)$ defined by the classical expression $\\sigma(v)=\\int_{0}^{\\infty} 2\\pi b\\,P(b)\\,\\mathrm{d}b$.\n\nExpress your final answer as a single closed-form analytic expression for $\\sigma(v)$ in terms of $v$, $\\mu$, and $C_{4}$. No numerical evaluation or rounding is required. Do not include units in your final answer.", "solution": "The problem statement is validated as follows.\n\n**Step 1: Extracted Givens**\n- Reaction type: Bimolecular gas-phase, harpoon mechanism.\n- Opacity function: $P(b) = \\Theta(b_{c}-b)$, where $\\Theta(x)$ is the Heaviside step function defined as $\\Theta(x)=1$ for $x \\ge 0$ and $\\Theta(x)=0$ otherwise.\n- $b$: impact parameter.\n- $b_{c}$: critical impact parameter.\n- $v$: relative speed.\n- $\\mu$: reduced mass.\n- Interaction potential after electron transfer: $V(r) = -C_{4}/r^{4}$ with $C_{4}>0$.\n- Reaction condition: The collision energy must exceed the centrifugal barrier associated with $V(r)$.\n- Cross section definition: $\\sigma(v)=\\int_{0}^{\\infty} 2\\pi b\\,P(b)\\,\\mathrm{d}b$.\n\n**Step 2: Validation Using Extracted Givens**\n- **Scientific Grounding:** The problem describes the Langevin capture model for an ion-induced dipole interaction, a cornerstone of classical reaction dynamics. The potential $V(r) \\propto -1/r^4$, the concept of an effective potential incorporating a centrifugal barrier, and the calculation of a capture cross section via an opacity function are all standard, physically correct concepts from scattering theory and chemical kinetics.\n- **Well-Posedness:** The problem is well-posed. It provides all necessary physical quantities and a clear condition (collision energy equals barrier height) to determine the unknown critical impact parameter $b_c$. This, in turn, allows for a direct calculation of the cross section. A unique, stable, and meaningful solution exists.\n- **Objectivity:** The problem is stated in precise, objective language, free of ambiguity or subjective claims.\n\n**Step 3: Verdict and Action**\nThe problem is valid. It is a standard exercise in classical scattering theory applied to chemical reactions. A full solution will be provided.\n\nThe solution is derived in three parts as requested. The analysis is conducted in the center-of-mass frame.\n\n1) The reactive cross section is defined as $\\sigma(v)=\\int_{0}^{\\infty} 2\\pi b\\,P(b)\\,\\mathrm{d}b$. The opacity function is given as $P(b) = \\Theta(b_c - b)$. By definition of the Heaviside step function, $P(b) = 1$ only if $b_c - b \\ge 0$, which implies $b \\le b_c$. For all $b > b_c$, $P(b) = 0$. Since the impact parameter $b$ must be non-negative, the range of impact parameters that contributes to the reactive cross section is $0 \\le b \\le b_c$.\n\n2) The critical impact parameter $b_c$ is found by analyzing the classical motion in the central potential $V(r)$. The total energy of the system is the initial relative kinetic energy, $E = \\frac{1}{2}\\mu v^2$. The magnitude of the conserved angular momentum is $L = \\mu v b$. The motion can be described by an effective potential $V_{\\text{eff}}(r)$, which is the sum of the interaction potential and the centrifugal potential term:\n$$V_{\\text{eff}}(r) = V(r) + \\frac{L^2}{2\\mu r^2}$$\nSubstituting the given potential $V(r) = -C_4/r^4$ and the expression for $L$:\n$$V_{\\text{eff}}(r) = -\\frac{C_4}{r^4} + \\frac{(\\mu v b)^2}{2\\mu r^2} = -\\frac{C_4}{r^4} + \\frac{\\mu v^2 b^2}{2r^2}$$\nThe centrifugal barrier is the maximum of this effective potential. To find the location of the maximum, denoted $r_c$, we set the first derivative of $V_{\\text{eff}}(r)$ with respect to $r$ to zero:\n$$\\frac{\\mathrm{d}V_{\\text{eff}}}{\\mathrm{d}r} = \\frac{\\mathrm{d}}{\\mathrm{d}r}\\left(-\\frac{C_4}{r^4} + \\frac{\\mu v^2 b^2}{2r^2}\\right) = \\frac{4C_4}{r^5} - \\frac{\\mu v^2 b^2}{r^3} = 0$$\nSolving for $r$ at the barrier, which we call $r_c$:\n$$\\frac{4C_4}{r_c^5} = \\frac{\\mu v^2 b^2}{r_c^3} \\implies r_c^2 = \\frac{4C_4}{\\mu v^2 b^2}$$\nThe height of the barrier, $E_{\\text{barrier}}$, is the value of the effective potential at $r_c$:\n$$E_{\\text{barrier}} = V_{\\text{eff}}(r_c) = -\\frac{C_4}{r_c^4} + \\frac{\\mu v^2 b^2}{2r_c^2}$$\nFrom the condition for $r_c$, we have $\\mu v^2 b^2 = \\frac{4C_4}{r_c^2}$. Substituting this into the second term for $E_{\\text{barrier}}$:\n$$E_{\\text{barrier}} = -\\frac{C_4}{r_c^4} + \\frac{1}{2r_c^2}\\left(\\frac{4C_4}{r_c^2}\\right) = -\\frac{C_4}{r_c^4} + \\frac{2C_4}{r_c^4} = \\frac{C_4}{r_c^4}$$\nNow, we substitute the expression for $r_c^2$:\n$$E_{\\text{barrier}} = C_4 \\left(\\frac{\\mu v^2 b^2}{4C_4}\\right)^2 = C_4 \\frac{\\mu^2 v^4 b^4}{16 C_4^2} = \\frac{\\mu^2 v^4 b^4}{16 C_4}$$\nReaction occurs if the collision energy $E$ is sufficient to overcome this barrier. The critical impact parameter $b_c$ corresponds to the case where the collision energy is exactly equal to the barrier height: $E = E_{\\text{barrier}}$.\n$$\\frac{1}{2}\\mu v^2 = \\frac{\\mu^2 v^4 b_c^4}{16 C_4}$$\nWe now solve for $b_c$:\n$$b_c^4 = \\frac{16 C_4}{ \\mu^2 v^4} \\left(\\frac{1}{2}\\mu v^2\\right) = \\frac{8 C_4}{\\mu v^2}$$\nTaking the fourth root gives the critical impact parameter:\n$$b_c = \\left(\\frac{8 C_4}{\\mu v^2}\\right)^{1/4}$$\n\n3) Finally, we compute the reactive cross section $\\sigma(v)$ using its definition and the opacity function $P(b) = \\Theta(b_c - b)$.\n$$\\sigma(v) = \\int_{0}^{\\infty} 2\\pi b\\,P(b)\\,\\mathrm{d}b = \\int_{0}^{\\infty} 2\\pi b\\,\\Theta(b_c - b)\\,\\mathrm{d}b$$\nThe integral is non-zero only for $0 \\le b \\le b_c$, where $P(b)=1$.\n$$\\sigma(v) = \\int_{0}^{b_c} 2\\pi b\\,\\mathrm{d}b = 2\\pi \\left[\\frac{b^2}{2}\\right]_{0}^{b_c} = \\pi b_c^2$$\nSubstituting the expression for $b_c^2$ derived from the previous part:\n$$b_c^2 = \\left(\\left(\\frac{8 C_4}{\\mu v^2}\\right)^{1/4}\\right)^2 = \\left(\\frac{8 C_4}{\\mu v^2}\\right)^{1/2}$$\nTherefore, the cross section is:\n$$\\sigma(v) = \\pi \\left(\\frac{8 C_4}{\\mu v^2}\\right)^{1/2} = \\pi \\sqrt{\\frac{8 C_4}{\\mu v^2}} = \\pi \\frac{\\sqrt{8}\\sqrt{C_4}}{\\sqrt{\\mu}v} = \\frac{2\\pi\\sqrt{2C_4}}{v\\sqrt{\\mu}}$$\nThis expression can be rearranged to show the velocity dependence explicitly:\n$$\\sigma(v) = \\frac{2\\pi}{v} \\sqrt{\\frac{2C_4}{\\mu}}$$\nThis is the final expression for the reactive cross section.", "answer": "$$\\boxed{\\frac{2\\pi}{v}\\sqrt{\\frac{2C_{4}}{\\mu}}}$$", "id": "2680311"}, {"introduction": "While simple models can describe a single mechanism, real reactive systems often feature competition between multiple pathways like rebound and stripping. These distinct dynamics emerge from different features of the underlying multi-dimensional Potential Energy Surface (PES). This practice reverses the usual process: instead of analyzing a given PES, you will engineer a minimalist potential function by tuning its anisotropy and long-range character to explicitly produce the signatures of both backward-scattered rebound and forward-scattered stripping [@problem_id:2680229], thereby building a deeper intuition for the fundamental link between interaction potentials and reaction dynamics.", "problem": "A minimalist potential energy surface (PES) for atom–diatom scattering is constructed by combining an anisotropic neutral repulsive wall to model rebound and a long-range ionic branch to model harpoon-assisted stripping. Let the atom–diatom separation be denoted by $R$ and the angle between the approach direction and the diatom axis by $\\theta$. The neutral repulsive branch is modeled by the leading repulsive term with a quadrupolar anisotropy,\n$$\nV_{n}(R,\\theta) \\;=\\; D \\left(\\frac{\\sigma}{R}\\right)^{12}\\left[1 + \\eta\\,P_{2}(\\cos\\theta)\\right],\n$$\nwhere $P_{2}(x)$ is the second Legendre polynomial, $P_{2}(x) = \\tfrac{1}{2}(3x^{2}-1)$, $D$ and $\\sigma$ are positive constants with units of energy and length, respectively, and $\\eta$ is a dimensionless anisotropy parameter to be determined. The harpoon (charge-transfer) branch is modeled for $R \\le R_{c}$ by the Coulombic ionic potential\n$$\nV_{i}(R) \\;=\\; -\\frac{C_{1}}{R},\n$$\nwhere $C_{1} = \\dfrac{e^{2}}{4\\pi\\varepsilon_{0}}$ is taken as a known constant. The neutral and ionic asymptotes cross at a radius $R_{c}$ determined by the neutral–ionic energy gap $\\Delta$ via the resonance condition\n$$\n\\Delta \\;=\\; \\frac{C_{1}}{R_{c}}.\n$$\n\nImpose the following two mechanistic design constraints:\n\n1) Backward-peaked rebound in head-on (linear) collisions: at a relative collision energy $E$, require the linear approach $\\theta = 0$ to experience a classical turning point at $R = \\sigma$, while the isotropic neutral repulsive energy at $R = \\sigma$ is only half the collision energy. In symbols, require\n$$\nV_{n}(\\sigma,0) \\,=\\, E\n\\quad\\text{and}\\quad\nD\\left(\\frac{\\sigma}{\\sigma}\\right)^{12} \\,=\\, \\frac{E}{2}.\n$$\nUse these conditions to determine the anisotropy parameter $\\eta$.\n\n2) Forward-peaked stripping via harpooning at large impact parameters: require the harpoon crossing radius to be twice the neutral collision diameter, $R_{c} = 2\\sigma$, so that the largest impact parameter that can reach the crossing satisfies $b_{\\max} = R_{c} \\ge 2\\sigma$, biasing scattering to small deflection angles. Use the resonance condition to determine the required neutral–ionic energy gap $\\Delta$.\n\nUse the numerical values $E = 0.200\\,\\mathrm{eV}$, $\\sigma = 3.50\\,\\mathrm{\\AA}$, and $C_{1} = 14.3996\\,\\mathrm{eV\\cdot\\AA}$. Compute the pair $(\\eta,\\Delta)$ that satisfies the above constraints. Round $\\Delta$ to four significant figures. Express $\\Delta$ in $\\mathrm{eV}$. Provide your final answer as a row matrix $\\begin{pmatrix}\\eta & \\Delta\\end{pmatrix}$.", "solution": "We begin from the mechanistic design requirements and the given minimalist PES definitions. The neutral repulsive branch is\n$$\nV_{n}(R,\\theta) \\;=\\; D \\left(\\frac{\\sigma}{R}\\right)^{12}\\left[1 + \\eta\\,P_{2}(\\cos\\theta)\\right],\n$$\nwith $P_{2}(x)=\\tfrac{1}{2}(3x^{2}-1)$, and the ionic branch is $V_{i}(R) = -C_{1}/R$, with the resonance crossing determined by $\\Delta = C_{1}/R_{c}$.\n\nConstraint 1 (backward-peaked rebound) is designed to make the linear approach $\\theta = 0$ significantly more repulsive than the isotropic reference at the contact distance $R=\\sigma$. First, the isotropic neutral repulsion at $R=\\sigma$ is defined by\n$$\nV_{n}^{\\text{iso}}(\\sigma) \\;=\\; D\\left(\\frac{\\sigma}{\\sigma}\\right)^{12} \\;=\\; D \\;=\\; \\frac{E}{2}.\n$$\nThis sets the overall repulsive scale $D$ relative to the collision energy $E$, but $D$ will cancel when determining $\\eta$. Next, impose the linear-geometry turning-point condition at $R=\\sigma$:\n$$\nV_{n}(\\sigma,0) \\;=\\; D\\left(\\frac{\\sigma}{\\sigma}\\right)^{12}\\left[1 + \\eta\\,P_{2}(\\cos 0)\\right]\n\\;=\\; D\\left[1 + \\eta\\,P_{2}(1)\\right]\n\\;=\\; E.\n$$\nUsing $P_{2}(1) = \\tfrac{1}{2}(3\\cdot 1^{2}-1) = 1$ and $D = E/2$, we obtain\n$$\n\\frac{E}{2}\\left(1+\\eta\\right) \\;=\\; E\n\\quad\\Longrightarrow\\quad\n1+\\eta \\;=\\; 2\n\\quad\\Longrightarrow\\quad\n\\eta \\;=\\; 1.\n$$\nThus the required anisotropy parameter is $\\eta = 1$. Physically, this choice makes the linear configuration twice as repulsive as the isotropic baseline at $R=\\sigma$, ensuring a strong reflection in head-on collisions and thereby a backward-peaked differential scattering.\n\nConstraint 2 (forward-peaked stripping via harpoon) aims to admit capture at large impact parameters, which in a classical picture biases deflections to remain small (forward-peaked). For a resonance harpoon event, the neutral and ionic curves cross when the ionic stabilization equals the neutral–ionic asymptotic gap, i.e.,\n$$\n\\Delta \\;=\\; \\frac{C_{1}}{R_{c}}.\n$$\nThe requirement $R_{c} = 2\\sigma$ sets the capture radius to twice the neutral collision diameter. Substituting $R_{c} = 2\\sigma$ into the resonance condition gives\n$$\n\\Delta \\;=\\; \\frac{C_{1}}{2\\sigma}.\n$$\nWe now insert the given numerical values, being careful with units. We have $C_{1} = 14.3996\\,\\mathrm{eV\\cdot\\AA}$ and $\\sigma = 3.50\\,\\mathrm{\\AA}$, so\n$$\n\\Delta \\;=\\; \\frac{14.3996\\,\\mathrm{eV\\cdot\\AA}}{2 \\times 3.50\\,\\mathrm{\\AA}}\n\\;=\\; \\frac{14.3996}{7.00}\\,\\mathrm{eV}\n\\;=\\; 2.057085714\\ldots\\,\\mathrm{eV}.\n$$\nRounding $\\Delta$ to four significant figures yields\n$$\n\\Delta \\;=\\; 2.057\\,\\mathrm{eV}.\n$$\n\nCollecting the results, the minimal PES parameter pair is\n$$\n\\eta \\;=\\; 1,\n\\qquad\n\\Delta \\;=\\; 2.057\\,\\mathrm{eV}.\n$$\nThis choice enforces, by construction: (i) a strongly enhanced repulsive wall in the linear approach that causes a turning point at $R=\\sigma$ and thus backward-peaked rebound; and (ii) a harpoon crossing radius $R_{c} = 2\\sigma$ that admits trajectories with impact parameter up to $b_{\\max} = R_{c}$ to reach the crossing, promoting forward-peaked stripping due to capture at long range and small angular deflection. The use of the quadrupolar anisotropy $P_{2}(\\cos\\theta)$ is the lowest-order even angular term compatible with the head-on versus side-on repulsive contrast, and the Coulomb constant $C_{1}$ provides a physically justified ionic stabilization scale without resorting to ad hoc long-range parameters.", "answer": "$$\\boxed{\\begin{pmatrix}1 & 2.057\\end{pmatrix}}$$", "id": "2680229"}, {"introduction": "Theoretical models, from analytical forms to complex potential energy surfaces, must ultimately be validated against experimental observables. Quasi-classical trajectory (QCT) simulations are a powerful tool for bridging this theory-experiment gap, but they produce vast amounts of raw data that require careful processing. This exercise provides hands-on practice with the final, crucial step of a QCT study: analyzing discretized trajectory outcomes to compute the opacity function $P(b)$ and numerically integrating it to obtain mechanism-resolved and total reactive cross sections [@problem_id:2680391]. This is a core data analysis skill in modern computational reaction dynamics.", "problem": "You are given discretized trajectory outcomes for a bimolecular reactive scattering system exhibiting three mechanistic pathways: stripping, rebound, and harpoon. From these outcomes, your task is to compute the opacity function, the mechanism-resolved and total reactive cross sections, and validate the computed totals against provided experimental cross sections. The opacity function is the reaction probability as a function of impact parameter and collision energy. You must base your derivation and computations on the following fundamental facts and definitions:\n- The opacity function $P(b;E)$ is the probability that a collision with impact parameter $b$ at collision energy $E$ leads to reaction.\n- The total reactive cross section at energy $E$ is given by the integral $\\sigma(E) = 2\\pi \\int_{0}^{\\infty} b \\, P(b;E) \\, db$. In a piecewise-constant discretization over impact parameter bins with edges $\\{b_i\\}_{i=0}^{n}$, the Riemann sum approximation is $\\sigma(E) \\approx \\pi \\sum_{i=0}^{n-1} P_i(E)\\left(b_{i+1}^2 - b_i^2\\right)$, where $P_i(E)$ is the opacity within bin $[b_i,b_{i+1})$.\n- If trajectories are classified into mechanisms $m \\in \\{\\text{stripping}, \\text{rebound}, \\text{harpoon}\\}$, then $P(b;E) = \\sum_m P_m(b;E)$, where $P_m(b;E)$ are mechanism-specific opacities. Consequently, the total cross section equals the sum of mechanism-resolved cross sections.\n\nYour program must perform the following, in the order specified:\n1. For each test energy and each impact parameter bin, compute the binwise opacity $P_i(E)$ and the mechanism-resolved opacities $P_{m,i}(E)$ from the trajectory outcomes.\n2. Compute the mechanism-resolved cross sections and their sum using the discretized formula. Compute the total reactive cross section using the same discretized formula applied to the total opacity. All cross sections must be expressed in square angstroms (write your final numeric answers in square angstroms).\n3. Validate the total computed cross section against the experimental total cross section by computing the absolute relative deviation $D(E) = \\left|\\sigma_{\\text{calc}}(E) - \\sigma_{\\text{exp}}(E)\\right| / \\sigma_{\\text{exp}}(E)$.\n4. Validate the additivity of mechanisms by checking whether the sum of the mechanism-resolved cross sections equals the total computed cross section within an absolute tolerance of $10^{-12}$.\n5. Aggregate the results for all test energies into a single output line as specified below.\n\nDiscretization and data:\n- Use the common set of impact parameter bin edges $b$ (in angstroms): $\\{0.0, 1.0, 2.0, 3.0, 4.0\\}$.\n- For each energy $E$, you are provided with four vectors (each of length $4$) for the bins $[b_0,b_1), [b_1,b_2), [b_2,b_3), [b_3,b_4)$:\n  1. The total number of trajectories per bin $N_i$.\n  2. The number of reactive stripping trajectories per bin $S_i$.\n  3. The number of reactive rebound trajectories per bin $R_i$.\n  4. The number of reactive harpoon trajectories per bin $H_i$.\n- The binwise opacities must be computed as $P_i(E) = \\frac{S_i + R_i + H_i}{N_i}$ and $P_{m,i}(E) = \\frac{M_i}{N_i}$ for each mechanism $m$ with counts $M_i \\in \\{S_i,R_i,H_i\\}$. If $N_i = 0$ for a bin, you must set $P_i(E) = 0$ and $P_{m,i}(E) = 0$ for all mechanisms in that bin.\n\nTest suite (energies in kilojoules per mole are labels; they do not enter any formula directly):\n- Energy $E = 10$:\n  - $N_i = \\{300, 300, 300, 300\\}$\n  - $S_i = \\{30, 80, 60, 0\\}$\n  - $R_i = \\{90, 40, 15, 0\\}$\n  - $H_i = \\{0, 0, 9, 12\\}$\n  - Experimental total cross section $\\sigma_{\\text{exp}}(10) = 10.30$ (square angstroms).\n- Energy $E = 30$:\n  - $N_i = \\{400, 400, 400, 400\\}$\n  - $S_i = \\{160, 140, 60, 0\\}$\n  - $R_i = \\{160, 60, 20, 0\\}$\n  - $H_i = \\{0, 0, 0, 0\\}$\n  - Experimental total cross section $\\sigma_{\\text{exp}}(30) = 10.35$ (square angstroms).\n- Energy $E = 5$ (edge case includes a bin with zero trajectories):\n  - $N_i = \\{200, 200, 200, 0\\}$\n  - $S_i = \\{0, 0, 0, 0\\}$\n  - $R_i = \\{10, 0, 0, 0\\}$\n  - $H_i = \\{0, 6, 4, 0\\}$\n  - Experimental total cross section $\\sigma_{\\text{exp}}(5) = 0.76$ (square angstroms).\n\nRequired final output format:\n- For each energy $E$ in the order $E \\in \\{10, 30, 5\\}$, produce three values:\n  1. The total computed reactive cross section $\\sigma_{\\text{calc}}(E)$ in square angstroms, rounded to $4$ decimal places.\n  2. The absolute relative deviation $D(E)$, rounded to $6$ decimal places.\n  3. A boolean indicating whether the sum of mechanism-resolved cross sections equals the total computed cross section within an absolute tolerance of $10^{-12}$.\n- Your program should produce a single line of output containing these nine values as a comma-separated list enclosed in square brackets, in the order: $[\\sigma_{\\text{calc}}(10), D(10), \\text{check}_{10}, \\sigma_{\\text{calc}}(30), D(30), \\text{check}_{30}, \\sigma_{\\text{calc}}(5), D(5), \\text{check}_{5}]$.", "solution": "The problem presented is a standard exercise in the analysis of quasi-classical trajectory simulation data for a bimolecular reactive scattering event. It is scientifically sound, well-posed, and contains all necessary information for a unique solution. We shall proceed with the derivation and computation.\n\nThe fundamental quantity of interest is the total reactive cross section, $\\sigma(E)$, at a given collision energy, $E$. It represents the effective target area for a reaction to occur. It is formally defined by the integral of the opacity function, $P(b;E)$, over all impact parameters, $b$:\n$$\n\\sigma(E) = 2\\pi \\int_{0}^{\\infty} b \\, P(b;E) \\, db\n$$\nHere, the opacity function $P(b;E)$ is the probability that a collision at impact parameter $b$ and energy $E$ results in a reaction. In computational studies, this integral is approximated by a sum over discrete bins of the impact parameter. Given a set of bin edges $\\{b_i\\}_{i=0}^{n}$, the cross section is approximated by the Riemann sum:\n$$\n\\sigma(E) \\approx \\pi \\sum_{i=0}^{n-1} P_i(E)\\left(b_{i+1}^2 - b_i^2\\right)\n$$\nwhere $P_i(E)$ is the average reaction probability in the impact parameter bin $[b_i, b_{i+1})$. The term $\\pi(b_{i+1}^2 - b_i^2)$ represents the area of the annulus corresponding to the $i$-th bin.\n\nThe opacity $P_i(E)$ is estimated from simulation data by the ratio of reactive trajectories, $N_{\\text{reac}, i}$, to the total number of trajectories, $N_i$, run in that bin:\n$$\nP_i(E) = \\frac{N_{\\text{reac}, i}}{N_i}\n$$\nThe problem specifies that the total number of reactive trajectories is the sum of trajectories following three distinct mechanisms: stripping ($S_i$), rebound ($R_i$), and harpoon ($H_i$). Thus, $N_{\\text{reac}, i} = S_i + R_i + H_i$.\nThe total opacity is therefore $P_i(E) = \\frac{S_i + R_i + H_i}{N_i}$. By definition, this can be decomposed into mechanism-specific opacities:\n$$\nP_i(E) = P_{S,i}(E) + P_{R,i}(E) + P_{H,i}(E)\n$$\nwhere $P_{S,i}(E) = S_i/N_i$, $P_{R,i}(E) = R_i/N_i$, and $P_{H,i}(E) = H_i/N_i$. It follows from the linearity of the summation that the total cross section is the sum of the mechanism-resolved cross sections:\n$$\n\\sigma_{\\text{calc}}(E) = \\sigma_S(E) + \\sigma_R(E) + \\sigma_H(E)\n$$\nThis additive property serves as a self-consistency check for the calculation.\n\nThe problem provides impact parameter bin edges $b=\\{0.0, 1.0, 2.0, 3.0, 4.0\\}$ in angstroms. We have four bins ($i=0,1,2,3$): $[0,1)$, $[1,2)$, $[2,3)$, and $[3,4)$. The annular area factors $\\pi(b_{i+1}^2 - b_i^2)$ for these bins are:\n- $i=0$: $\\pi(1.0^2 - 0.0^2) = \\pi$\n- $i=1$: $\\pi(2.0^2 - 1.0^2) = 3\\pi$\n- $i=2$: $\\pi(3.0^2 - 2.0^2) = 5\\pi$\n- $i=3$: $\\pi(4.0^2 - 3.0^2) = 7\\pi$\n\nWe now apply this framework to each test case.\n\n**Case 1: Energy $E = 10 \\text{ kJ/mol}$**\n- Data: $N_i = \\{300, 300, 300, 300\\}$, $S_i = \\{30, 80, 60, 0\\}$, $R_i = \\{90, 40, 15, 0\\}$, $H_i = \\{0, 0, 9, 12\\}$.\n- Experimental cross section: $\\sigma_{\\text{exp}}(10) = 10.30 \\text{ Å}^2$.\n\nFirst, we compute the bin-wise opacities:\n- $P_0(10) = (30+90+0)/300 = 0.400$. Opacities for mechanisms: $P_{S,0}=0.100$, $P_{R,0}=0.300$, $P_{H,0}=0.000$.\n- $P_1(10) = (80+40+0)/300 = 0.400$. Opacities for mechanisms: $P_{S,1}=80/300$, $P_{R,1}=40/300$, $P_{H,1}=0.000$.\n- $P_2(10) = (60+15+9)/300 = 0.280$. Opacities for mechanisms: $P_{S,2}=0.200$, $P_{R,2}=0.050$, $P_{H,2}=0.030$.\n- $P_3(10) = (0+0+12)/300 = 0.040$. Opacities for mechanisms: $P_{S,3}=0.000$, $P_{R,3}=0.000$, $P_{H,3}=0.040$.\n\nNext, we compute the total cross section, $\\sigma_{\\text{calc}}(10)$:\n$$\n\\sigma_{\\text{calc}}(10) = \\pi \\left[ (0.400)(1) + (0.400)(3) + (0.280)(5) + (0.040)(7) \\right] = \\pi [0.4 + 1.2 + 1.4 + 0.28] = 3.28\\pi \\approx 10.304423... \\text{ Å}^2\n$$\nThe absolute relative deviation is $D(10) = |10.304423 - 10.30|/10.30 \\approx 0.0004294$.\nThe mechanism-resolved cross sections are calculated and summed. This sum must equal $\\sigma_{\\text{calc}}(10)$ by construction, so the additivity check is satisfied.\n\n**Case 2: Energy $E = 30 \\text{ kJ/mol}$**\n- Data: $N_i = \\{400, 400, 400, 400\\}$, $S_i = \\{160, 140, 60, 0\\}$, $R_i = \\{160, 60, 20, 0\\}$, $H_i = \\{0, 0, 0, 0\\}$.\n- Experimental cross section: $\\sigma_{\\text{exp}}(30) = 10.35 \\text{ Å}^2$.\n\nBin-wise opacities:\n- $P_0(30) = (160+160+0)/400 = 0.800$.\n- $P_1(30) = (140+60+0)/400 = 0.500$.\n- $P_2(30) = (60+20+0)/400 = 0.200$.\n- $P_3(30) = (0+0+0)/400 = 0.000$.\n\nTotal cross section, $\\sigma_{\\text{calc}}(30)$:\n$$\n\\sigma_{\\text{calc}}(30) = \\pi \\left[ (0.800)(1) + (0.500)(3) + (0.200)(5) + (0.000)(7) \\right] = \\pi [0.8 + 1.5 + 1.0 + 0.0] = 3.3\\pi \\approx 10.367255... \\text{ Å}^2\n$$\nThe absolute relative deviation is $D(30) = |10.367255 - 10.35|/10.35 \\approx 0.001667$. The additivity check is satisfied.\n\n**Case 3: Energy $E = 5 \\text{ kJ/mol}$**\n- Data: $N_i = \\{200, 200, 200, 0\\}$, $S_i = \\{0, 0, 0, 0\\}$, $R_i = \\{10, 0, 0, 0\\}$, $H_i = \\{0, 6, 4, 0\\}$.\n- Experimental cross section: $\\sigma_{\\text{exp}}(5) = 0.76 \\text{ Å}^2$.\n\nBin-wise opacities. Note that for bin $i=3$, $N_3=0$, so all associated opacities are $0$.\n- $P_0(5) = (0+10+0)/200 = 0.050$.\n- $P_1(5) = (0+0+6)/200 = 0.030$.\n- $P_2(5) = (0+0+4)/200 = 0.020$.\n- $P_3(5) = 0$, since $N_3=0$.\n\nTotal cross section, $\\sigma_{\\text{calc}}(5)$:\n$$\n\\sigma_{\\text{calc}}(5) = \\pi \\left[ (0.050)(1) + (0.030)(3) + (0.020)(5) + (0.000)(7) \\right] = \\pi [0.05 + 0.09 + 0.10 + 0.0] = 0.24\\pi \\approx 0.753982... \\text{ Å}^2\n$$\nThe absolute relative deviation is $D(5) = |0.753982 - 0.76|/0.76 \\approx 0.007921$. The additivity check is satisfied.\n\nThe results are now aggregated for the final output. The calculations will be implemented in the provided Python environment to ensure numerical precision.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes reaction cross sections from discretized trajectory data\n    and validates them against experimental values.\n    \"\"\"\n\n    # Define the common set of impact parameter bin edges (in angstroms).\n    b_edges = np.array([0.0, 1.0, 2.0, 3.0, 4.0])\n\n    # Pre-calculate the area of each annular bin: pi * (b_outer^2 - b_inner^2)\n    # These factors are constant for all energy cases.\n    bin_areas = np.pi * (b_edges[1:]**2 - b_edges[:-1]**2)\n\n    # Define the test cases from the problem statement.\n    # Each case is a dictionary containing the data for a specific energy.\n    test_cases = [\n        {\n            \"energy_label\": 10,\n            \"N\": np.array([300, 300, 300, 300]),\n            \"S\": np.array([30, 80, 60, 0]),\n            \"R\": np.array([90, 40, 15, 0]),\n            \"H\": np.array([0, 0, 9, 12]),\n            \"sigma_exp\": 10.30\n        },\n        {\n            \"energy_label\": 30,\n            \"N\": np.array([400, 400, 400, 400]),\n            \"S\": np.array([160, 140, 60, 0]),\n            \"R\": np.array([160, 60, 20, 0]),\n            \"H\": np.array([0, 0, 0, 0]),\n            \"sigma_exp\": 10.35\n        },\n        {\n            \"energy_label\": 5,\n            \"N\": np.array([200, 200, 200, 0]),\n            \"S\": np.array([0, 0, 0, 0]),\n            \"R\": np.array([10, 0, 0, 0]),\n            \"H\": np.array([0, 6, 4, 0]),\n            \"sigma_exp\": 0.76\n        }\n    ]\n\n    # This list will store the final flattened results for printing.\n    results = []\n\n    # Process each test case.\n    for case in test_cases:\n        N = case[\"N\"]\n        S = case[\"S\"]\n        R = case[\"R\"]\n        H = case[\"H\"]\n        sigma_exp = case[\"sigma_exp\"]\n\n        # Step 1: Compute binwise opacities.\n        \n        # Initialize opacity arrays with zeros.\n        P_total = np.zeros_like(N, dtype=float)\n        P_S = np.zeros_like(N, dtype=float)\n        P_R = np.zeros_like(N, dtype=float)\n        P_H = np.zeros_like(N, dtype=float)\n\n        # Create a mask for bins where N_i > 0 to avoid division by zero.\n        # For bins where N_i = 0, opacities remain 0 as per the problem statement.\n        valid_bins_mask = N > 0\n\n        # Calculate total reactive trajectories per bin.\n        N_reac = S + R + H\n\n        # Calculate opacities only for valid bins.\n        P_total[valid_bins_mask] = N_reac[valid_bins_mask] / N[valid_bins_mask]\n        P_S[valid_bins_mask] = S[valid_bins_mask] / N[valid_bins_mask]\n        P_R[valid_bins_mask] = R[valid_bins_mask] / N[valid_bins_mask]\n        P_H[valid_bins_mask] = H[valid_bins_mask] / N[valid_bins_mask]\n\n        # Step 2: Compute cross sections.\n        \n        # Total calculated cross section.\n        sigma_calc = np.sum(P_total * bin_areas)\n\n        # Mechanism-resolved cross sections.\n        sigma_S = np.sum(P_S * bin_areas)\n        sigma_R = np.sum(P_R * bin_areas)\n        sigma_H = np.sum(P_H * bin_areas)\n        \n        # For the additivity check.\n        sigma_mech_sum = sigma_S + sigma_R + sigma_H\n\n        # Step 3: Validate computed total against experimental total.\n        relative_deviation = np.abs(sigma_calc - sigma_exp) / sigma_exp\n\n        # Step 4: Validate additivity of mechanism cross sections.\n        # This checks if sigma_calc is close to the sum of mechanism-resolved\n        # cross sections, within the specified absolute tolerance.\n        additivity_check = np.isclose(sigma_calc, sigma_mech_sum, atol=1e-12)\n\n        # Step 5: Aggregate results for the current energy.\n        # Append the formatted values to the results list.\n        results.extend([\n            f\"{sigma_calc:.4f}\",\n            f\"{relative_deviation:.6f}\",\n            str(additivity_check)\n        ])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "2680391"}]}