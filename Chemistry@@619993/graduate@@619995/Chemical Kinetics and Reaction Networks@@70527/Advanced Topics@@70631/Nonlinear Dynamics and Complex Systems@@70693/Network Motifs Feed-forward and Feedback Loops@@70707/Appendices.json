{"hands_on_practices": [{"introduction": "The incoherent feed-forward loop (I-FFL) is a ubiquitous network motif capable of generating precise temporal output patterns from a sustained input signal. This hands-on practice explores the core mechanism of the I-FFL, where a faster activating pathway competes with a slower repressive pathway, leading to a transient pulse or an overshoot in the output concentration. By analytically solving the linearized dynamics for a step-input, you will develop the skills to predict a system's dynamic function from its architecture and understand how relative timescales govern complex behaviors like adaptation [@problem_id:2658564].", "problem": "Consider an incoherent feed-forward loop in a chemical reaction network where an external input $u(t)$ activates an intermediate species $x$, which in turn both activates the output $z$ directly and activates a second intermediate species $y$ that represses $z$. In the linear regime near a fixed operating point (obtained by linearizing mass-action kinetics), assume first-order production and degradation processes so that the dynamics are governed by the linear time-invariant ordinary differential equations\n$$\n\\frac{dx}{dt} \\;=\\; \\frac{u(t) - x}{\\tau_x}, \n\\qquad\n\\frac{dy}{dt} \\;=\\; \\frac{x - y}{\\tau_y},\n\\qquad\n\\frac{dz}{dt} \\;=\\; \\frac{k_x x - k_y y - z}{\\tau_z},\n$$\nwith strictly positive parameters $k_x, k_y, \\tau_x, \\tau_y, \\tau_z$, and initial conditions $x(0)=y(0)=z(0)=0$. Assume $k_x > k_y$ so that the steady-state $z$ under a sustained input is positive. The input is a step $u(t) = u_0 H(t)$, where $H(t)$ is the Heaviside step function and $u_0 > 0$ is a constant amplitude.\n\nStarting only from the above dynamical equations and the definition of the Heaviside step function, and using standard tools for linear systems analysis (e.g., convolution, Laplace transform), do the following:\n\n1. Derive a closed-form expression for the step response $z(t)$ for $t \\ge 0$ in the fast-readout limit $\\tau_z \\to 0$ (that is, take $\\tau_z$ sufficiently small compared to $\\tau_x$ and $\\tau_y$ so that $z(t)$ follows $k_x x(t) - k_y y(t)$ instantaneously).\n\n2. Define the steady-state value $z_{\\infty} \\equiv \\lim_{t\\to\\infty} z(t)$ and say that the response exhibits an overshoot if there exists a time $t^\\ast > 0$ such that $z(t^\\ast) > z_{\\infty}$. Determine analytically how the presence or absence of overshoot depends on the ratio $r \\equiv \\tau_y / \\tau_x$. In particular, find the critical ratio $r^{\\star}$ (as a symbolic expression in terms of $k_x$ and $k_y$) such that the response overshoots if and only if $r > r^{\\star}$.\n\nYour final answer must be a single closed-form expression for $r^{\\star}$. No numerical rounding is required. Express all mathematical quantities in standard symbols without units.", "solution": "The problem as stated is scientifically grounded, well-posed, objective, and contains all necessary information for a unique solution. It is a standard problem in the analysis of linear dynamical systems as applied to network motifs in systems biology. Therefore, the problem is valid and we proceed with its solution.\n\nThe system is described by the following linear ordinary differential equations for $t \\ge 0$:\n$$\n\\frac{dx}{dt} = \\frac{u_0 - x}{\\tau_x}, \\quad x(0)=0\n$$\n$$\n\\frac{dy}{dt} = \\frac{x - y}{\\tau_y}, \\quad y(0)=0\n$$\n$$\n\\frac{dz}{dt} = \\frac{k_x x - k_y y - z}{\\tau_z}, \\quad z(0)=0\n$$\nwhere $u(t) = u_0 H(t)$ has been substituted. The parameters $k_x, k_y, \\tau_x, \\tau_y, \\tau_z, u_0$ are all strictly positive constants.\n\nWe are asked to work in the fast-readout limit, $\\tau_z \\to 0$. In this limit, the dynamics of $z$ are much faster than those of $x$ and $y$, so $\\frac{dz}{dt}$ is large unless the numerator is close to zero. This implies a quasi-steady-state approximation for $z$:\n$$\nz(t) \\approx k_x x(t) - k_y y(t)\n$$\nOur first task is to find the explicit time-dependent solutions for $x(t)$ and $y(t)$.\n\nThe equation for $x(t)$ is a standard first-order linear ODE. Its solution is:\n$$\nx(t) = u_0 (1 - \\exp(-t/\\tau_x))\n$$\n\nNext, we solve for $y(t)$ by substituting the solution for $x(t)$ into the second equation:\n$$\n\\frac{dy}{dt} + \\frac{1}{\\tau_y} y = \\frac{x(t)}{\\tau_y} = \\frac{u_0}{\\tau_y} (1 - \\exp(-t/\\tau_x))\n$$\nThis is another first-order linear ODE with initial condition $y(0)=0$. Assuming $\\tau_x \\neq \\tau_y$, the solution is found using an integrating factor or Laplace transforms. The result is:\n$$\ny(t) = u_0 \\left( 1 - \\frac{\\tau_x}{\\tau_x - \\tau_y} \\exp(-t/\\tau_x) + \\frac{\\tau_y}{\\tau_x - \\tau_y} \\exp(-t/\\tau_y) \\right)\n$$\nIn the special case where $\\tau_x = \\tau_y = \\tau$, the solution is $y(t) = u_0 (1 - \\exp(-t/\\tau) - \\frac{t}{\\tau}\\exp(-t/\\tau))$. It can be verified that the general solution correctly limits to this special case.\n\nNow, we construct the output $z(t)$ using the fast-readout approximation:\n$$\nz(t) = k_x x(t) - k_y y(t)\n$$\n$$\nz(t) = k_x u_0 (1 - \\exp(-t/\\tau_x)) - k_y u_0 \\left( 1 - \\frac{\\tau_x}{\\tau_x - \\tau_y} \\exp(-t/\\tau_x) + \\frac{\\tau_y}{\\tau_x - \\tau_y} \\exp(-t/\\tau_y) \\right)\n$$\nCombining terms, we obtain:\n$$\nz(t) = u_0(k_x - k_y) + u_0 \\left( \\frac{k_y \\tau_x}{\\tau_x - \\tau_y} - k_x \\right) \\exp(-t/\\tau_x) - u_0 \\frac{k_y \\tau_y}{\\tau_x - \\tau_y} \\exp(-t/\\tau_y)\n$$\n\nThe steady-state value $z_{\\infty}$ is the limit of $z(t)$ as $t \\to \\infty$. Since the exponential terms decay to zero, we have:\n$$\nz_{\\infty} = \\lim_{t\\to\\infty} z(t) = u_0(k_x - k_y)\n$$\nThis is positive since it is given that $k_x > k_y$.\n\nAn overshoot occurs if there exists a time $t^\\ast > 0$ such that $z(t^\\ast) > z_{\\infty}$. Since $z(0)=0$ and the initial slope is positive, this implies the function must have a maximum at $t^\\ast > 0$, where $\\frac{dz}{dt}=0$. Setting $\\frac{dz}{dt} = k_x \\frac{dx}{dt} - k_y \\frac{dy}{dt} = 0$ and solving for the time $t$ gives the condition:\n$$\ne^{t(\\frac{1}{\\tau_y} - \\frac{1}{\\tau_x})} = \\frac{k_y}{k_y - k_x + k_x r}\n$$\nwhere $r \\equiv \\tau_y/\\tau_x$. For a physical solution $t^\\ast > 0$ to exist, the right-hand side (RHS) must be in a range that allows for a real logarithm. We analyze this condition for different ranges of $r > 0$.\n\nCase 1: $r > 1$ (i.e., $\\tau_y > \\tau_x$).\nThe exponent's prefactor $(\\frac{1}{\\tau_y} - \\frac{1}{\\tau_x})$ is negative. For a solution $t > 0$, we require $0  \\text{RHS}  1$.\nThe denominator $D = k_y - k_x(1-r)$ is positive since $1-r  0$. The RHS is therefore positive.\nThe condition $\\text{RHS}  1$ is $k_y  k_y - k_x(1-r)$, which simplifies to $0  -k_x(1-r)$ or $0  k_x(r-1)$. This is always true for $r>1$. Thus, an overshoot always occurs.\n\nCase 2: $r  1$ (i.e., $\\tau_y  \\tau_x$).\nThe exponent's prefactor is positive. For a solution $t > 0$, we require $\\text{RHS} > 1$.\nThis requires the denominator $D$ to be positive and smaller than the numerator $k_y$.\n$D > 0 \\implies k_y - k_x + k_x r > 0 \\implies k_x r > k_x - k_y \\implies r > 1 - \\frac{k_y}{k_x}$.\n$D  k_y \\implies k_y - k_x + k_x r  k_y \\implies k_x(r-1)  0$. This is always true for $r1$.\nSo, for $r  1$, an overshoot occurs if and only if $r > 1 - \\frac{k_y}{k_x}$.\n\nCase 3: $r=1$ (i.e., $\\tau_x = \\tau_y = \\tau$).\nWe must use the specific solution for this case:\n$$\nz(t) = u_0(k_x-k_y)(1-\\exp(-t/\\tau)) + u_0 k_y \\frac{t}{\\tau} \\exp(-t/\\tau)\n$$\nThe deviation from steady state is $z(t)-z_\\infty = u_0 \\exp(-t/\\tau) (k_y \\frac{t}{\\tau} - (k_x-k_y))$. For an overshoot, we need $z(t)-z_\\infty > 0$ for some $t > 0$. This requires $k_y \\frac{t}{\\tau} > k_x-k_y$. Since $k_x-k_y > 0$, this is true for any $t > \\frac{\\tau(k_x-k_y)}{k_y}$. Thus, an overshoot always occurs when $r=1$.\n\nCombining the results:\n- If $r > 1$, overshoot occurs.\n- If $r = 1$, overshoot occurs.\n- If $1 - k_y/k_x  r  1$, overshoot occurs.\n- If $r \\le 1 - k_y/k_x$, no overshoot occurs.\n\nThe condition for overshoot is therefore $r > 1 - \\frac{k_y}{k_x}$.\nThe problem asks for the critical ratio $r^\\star$ such that the response overshoots if and only if $r > r^\\star$. By direct comparison, this critical ratio is:\n$$\nr^\\star = 1 - \\frac{k_y}{k_x}\n$$\nThis expression is physically meaningful: since $k_x > k_y > 0$, we have $0  r^\\star  1$. The overshoot phenomenon depends on the timescale of the repressive pathway ($\\tau_y$) being sufficiently large compared to the activation pathway ($\\tau_x$), where \"sufficiently large\" is quantified by this critical ratio involving the relative strengths of the pathways.", "answer": "$$\n\\boxed{1 - \\frac{k_y}{k_x}}\n$$", "id": "2658564"}, {"introduction": "Negative feedback is a cornerstone of biological regulation, essential for maintaining homeostasis. However, when combined with inherent time delays in transcription and translation, negative feedback can also give rise to sustained oscillations, the very engine of circadian clocks and cell cycles. This exercise challenges you to use frequency-domain analysis to determine the precise conditions under which a simple delayed negative feedback loop transitions from stable regulation to periodic behavior, providing fundamental insights into the genesis of biological rhythms [@problem_id:2658638].", "problem": "Consider a single-species negative auto-regulatory motif in a biochemical reaction network where a product concentration $x(t)$ inhibits its own synthesis after a finite effective delay $\\tau0$. Assume that the synthesis pathway (promoter binding, enzyme activation) is fast relative to $x(t)$ dynamics and can be lumped into a static sensitivity, while the delay $\\tau$ captures the finite processing and transport time from the molecular interaction to the effective change in the synthesis flux. Let the mass balance for the small perturbation $\\delta x(t)$ about a stable steady state $x^{\\ast}$ be governed by\n$$\n\\frac{d}{dt}\\,\\delta x(t)=\\delta r(t),\n$$\nwhere $\\delta r(t)$ is the perturbation in the net synthesis rate. By linearizing the inhibited synthesis rate around $x^{\\ast}$ under the Quasi-Steady-State Approximation (QSSA), suppose that\n$$\n\\delta r(t)\\approx -K\\,\\delta x(t-\\tau),\n$$\nwith $K0$ a constant small-signal gain that depends on the steady-state operating point and biochemical parameters. Consequently, the closed-loop small-signal dynamics are described by the delay-differential equation\n$$\n\\frac{d}{dt}\\,\\delta x(t)=-K\\,\\delta x(t-\\tau).\n$$\nStarting from the fundamental mass balance and the above linearization, do the following:\n\n- Derive the open-loop frequency response $L(i\\omega)$ obtained by breaking the feedback at $\\delta x$ and traversing the loop through the delay and the static gain back to $\\delta x$ via the accumulation dynamics.\n- Using the frequency response, determine the smallest positive angular frequency $\\omega_{c}$ (in radians per second) at which the total open-loop phase equals $-\\pi$ radians.\n- Determine the smallest gain $K_{c}$ (in per second) for which the closed loop is marginally stable by the Nyquist criterion (i.e., the open-loop locus passes through $-1$ at $\\omega_{c}$).\n\nExpress your final answer as the pair $\\left(\\omega_{c},K_{c}\\right)$ in exact analytical form. Do not round. State $\\omega_{c}$ in radians per second and $K_{c}$ in per second. The final answer must be a single row vector.", "solution": "The problem statement is first subjected to validation.\n\n**Step 1: Extract Givens**\n- The governing equation for the perturbation $\\delta x(t)$ is the delay-differential equation (DDE):\n$$\n\\frac{d}{dt}\\,\\delta x(t) = -K\\,\\delta x(t-\\tau)\n$$\n- The gain $K$ is a positive constant, $K  0$.\n- The delay $\\tau$ is a positive constant, $\\tau  0$.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is scientifically grounded. The model presented, $\\frac{d}{dt}x = -K x(t-\\tau)$, is a canonical representation of a time-delayed negative feedback system. This is a fundamental model in control theory, engineering, and systems biology used to study oscillations and stability. The methods requested for analysis—deriving the open-loop frequency response and applying the Nyquist stability criterion—are standard, rigorous techniques in this field. The problem is self-contained, well-posed, and expressed in objective, formal language. It is free of any scientific, logical, or structural flaws.\n\n**Verdict and Action**\nThe problem is valid. A reasoned solution will be provided.\n\nThe analysis begins with the provided linear delay-differential equation:\n$$\n\\frac{d}{dt}\\,\\delta x(t) = -K\\,\\delta x(t-\\tau)\n$$\nTo analyze this system in the frequency domain, we apply the Laplace transform with respect to time $t$. Let $\\delta X(s)$ be the Laplace transform of $\\delta x(t)$. The transform of the derivative is $s\\,\\delta X(s)$, assuming zero initial conditions for the perturbation. The transform of the delayed term $\\delta x(t-\\tau)$ is $\\exp(-s\\tau)\\,\\delta X(s)$. Applying the transform to the entire equation yields:\n$$\ns\\,\\delta X(s) = -K\\,\\exp(-s\\tau)\\,\\delta X(s)\n$$\nThis equation can be rearranged to find the characteristic equation of the closed-loop system:\n$$\ns\\,\\delta X(s) + K\\,\\exp(-s\\tau)\\,\\delta X(s) = 0\n$$\n$$\n\\left(s + K\\,\\exp(-s\\tau)\\right)\\delta X(s) = 0\n$$\nFor a non-trivial solution $\\delta X(s) \\neq 0$, the characteristic equation is $s + K\\,\\exp(-s\\tau) = 0$.\n\nThe standard form of a closed-loop characteristic equation is $1 + L(s) = 0$, where $L(s)$ is the open-loop transfer function. To put our equation into this form, we divide by $s$ (assuming $s \\neq 0$, which is valid for frequency response analysis where $s = i\\omega$ and we seek $\\omega > 0$):\n$$\n1 + \\frac{K}{s}\\exp(-s\\tau) = 0\n$$\nFrom this, we identify the open-loop transfer function $L(s)$:\n$$\nL(s) = \\frac{K}{s}\\exp(-s\\tau)\n$$\nThe problem asks for the open-loop frequency response, $L(i\\omega)$, which is obtained by making the substitution $s = i\\omega$:\n$$\nL(i\\omega) = \\frac{K}{i\\omega}\\exp(-i\\omega\\tau)\n$$\nThis completes the first part of the problem.\n\nNext, we must find the smallest positive angular frequency $\\omega_{c}$ where the phase of $L(i\\omega)$ is equal to $-\\pi$ radians. The phase of a product of complex numbers is the sum of their individual phases.\nThe phase of $L(i\\omega)$ is given by:\n$$\n\\angle L(i\\omega) = \\angle\\left(\\frac{K}{i\\omega}\\right) + \\angle\\left(\\exp(-i\\omega\\tau)\\right)\n$$\nSince $K > 0$ and $\\omega > 0$, the term $K/(i\\omega)$ can be written as $-i(K/\\omega)$. This is a purely negative imaginary number, so its phase is $-\\frac{\\pi}{2}$ radians.\nThe term $\\exp(-i\\omega\\tau)$ is a complex number on the unit circle with a phase of $-\\omega\\tau$ radians.\nTherefore, the total phase is:\n$$\n\\angle L(i\\omega) = -\\frac{\\pi}{2} - \\omega\\tau\n$$\nWe set this equal to $-\\pi$ to find the critical frequency $\\omega_{c}$:\n$$\n-\\frac{\\pi}{2} - \\omega_{c}\\tau = -\\pi\n$$\nSolving for $\\omega_{c}\\tau$:\n$$\n\\omega_{c}\\tau = \\pi - \\frac{\\pi}{2} = \\frac{\\pi}{2}\n$$\nThe smallest positive critical frequency is thus:\n$$\n\\omega_{c} = \\frac{\\pi}{2\\tau}\n$$\nThis completes the second part of the problem.\n\nFinally, we must determine the critical gain $K_{c}$ for which the closed loop is marginally stable. According to the Nyquist stability criterion, marginal stability occurs when the open-loop locus $L(i\\omega)$ passes through the point $-1 + i0$ in the complex plane. This point corresponds to a magnitude of $1$ and a phase of $-\\pi$ radians. We have already found the frequency $\\omega_{c}$ where the phase condition is met. Now we must impose the magnitude condition at this frequency.\nThe magnitude of the open-loop frequency response $L(i\\omega)$ is:\n$$\n|L(i\\omega)| = \\left|\\frac{K}{i\\omega}\\exp(-i\\omega\\tau)\\right| = \\frac{|K|}{|i\\omega|}|\\exp(-i\\omega\\tau)|\n$$\nSince $K > 0$, $|K| = K$. The magnitude of $i\\omega$ is $\\omega$. The magnitude of $\\exp(-i\\omega\\tau)$ is $1$. Therefore:\n$$\n|L(i\\omega)| = \\frac{K}{\\omega}\n$$\nFor marginal stability, the gain must be the critical gain $K_{c}$ such that the magnitude is $1$ at the critical frequency $\\omega_{c}$:\n$$\n|L(i\\omega_{c})| = \\frac{K_{c}}{\\omega_{c}} = 1\n$$\nThis implies that $K_{c} = \\omega_{c}$.\nSubstituting the expression we derived for $\\omega_{c}$:\n$$\nK_{c} = \\frac{\\pi}{2\\tau}\n$$\nThis completes the third and final part of the problem. The required pair is $(\\omega_{c}, K_{c})$.\n\nThe results are $\\omega_{c} = \\frac{\\pi}{2\\tau}$ and $K_{c} = \\frac{\\pi}{2\\tau}$.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{\\pi}{2\\tau}  \\frac{\\pi}{2\\tau}\n\\end{pmatrix}\n}\n$$", "id": "2658638"}, {"introduction": "While theoretical analysis reveals the potential behaviors of network motifs, a central goal of systems biology is to infer network structure and logic from experimental data. Promoters that integrate multiple transcription factor inputs often do so with distinct computational logic, such as AND or OR gates. In this practical challenge, you will step into the role of a quantitative biologist, tasked with fitting competing models of regulatory logic to dose-response data and using the Akaike Information Criterion (AIC) to determine whether the underlying system behaves more like an AND or an OR gate [@problem_id:2658548].", "problem": "You are given experimental dose–response measurements of an output species $Z$ as a function of two input species $X$ and $Y$. Consider a regulatory network motif in which $X$ and $Y$ regulate $Z$ through a promoter integration logic that is either an AND-like mechanism or an OR-like mechanism. Starting from first principles of chemical kinetics and thermodynamic occupancy, we model each input’s activation with a Hill function and combine the inputs using AND or OR logic. Assume independent and identically distributed additive Gaussian noise on the measurements. Your task is to fit the two parametric models to each provided dataset and select which integration (AND or OR) better explains the data by comparing the Akaike Information Criterion (AIC).\n\nModeling assumptions and forms (for fitting and evaluation only; do not assume these to be the only possible mechanistic origins):\n- Single-input activation functions are Hill-type occupancies:\n  - $f_{x}(X; K_{x}, n_{x}) = \\dfrac{X^{n_{x}}}{K_{x}^{n_{x}} + X^{n_{x}}}$,\n  - $f_{y}(Y; K_{y}, n_{y}) = \\dfrac{Y^{n_{y}}}{K_{y}^{n_{y}} + Y^{n_{y}}}$,\n  with parameters $K_{x} gt; 0$, $K_{y} gt; 0$, $n_{x} gt; 0$, $n_{y} gt; 0$.\n- Output model with baseline and amplitude:\n  - $Z_{\\text{AND}}(X,Y; \\theta) = b + V \\cdot f_{x}(X; K_{x}, n_{x}) \\cdot f_{y}(Y; K_{y}, n_{y})$,\n  - $Z_{\\text{OR}}(X,Y; \\theta) = b + V \\cdot \\left(f_{x}(X; K_{x}, n_{x}) + f_{y}(Y; K_{y}, n_{y}) - f_{x}(X; K_{x}, n_{x}) f_{y}(Y; K_{y}, n_{y})\\right)$,\n  where $\\theta = (b, V, K_{x}, K_{y}, n_{x}, n_{y})$, with $b \\ge 0$ and $V \\ge 0$.\n- Noise model: independent Gaussian measurement noise with unknown variance $\\sigma^{2}$.\n\nModel comparison criterion:\n- For a dataset of size $n$, define the residual sum of squares $\\mathrm{RSS} = \\sum_{i=1}^{n} \\left(Z_{i} - \\hat{Z}(X_{i},Y_{i};\\hat{\\theta})\\right)^{2}$, where $\\hat{\\theta}$ is the parameter vector that minimizes $\\mathrm{RSS}$ for the model under consideration.\n- Use the Akaike Information Criterion (AIC) defined by $ \\mathrm{AIC} = 2k + n \\log\\!\\left(\\dfrac{\\mathrm{RSS}}{n}\\right)$, with $k$ the number of fitted parameters. For both models here, take $k = 7$ (the six mean-function parameters plus the noise variance). If $\\mathrm{RSS} \\le 0$ numerically, replace it by a small positive constant for the formula.\n- Decision rule: choose the model with the smaller AIC. In the event that $|\\mathrm{AIC}_{\\text{AND}} - \\mathrm{AIC}_{\\text{OR}}| \\le 10^{-9}$, select OR.\n\nParameter constraints for fitting:\n- Enforce bounds during fitting to ensure identifiability and stability: $b \\in [0, 2]$, $V \\in [0, 2]$, $K_{x}, K_{y} \\in [10^{-4}, 10]$, $n_{x}, n_{y} \\in [0.5, 4]$.\n\nUnits:\n- The inputs $X$ and $Y$ are concentrations in micromolar (expressed in $\\mu\\mathrm{M}$). The output $Z$ is in arbitrary fluorescence units. All computations and results are dimensionless with respect to the comparison criterion, so no unit conversion is required for the final output.\n\nTest suite:\nFor each test case $t \\in \\{1,2,3\\}$, you are given lists of paired inputs $(X_{i}^{(t)}, Y_{i}^{(t)})$ and corresponding measured outputs $Z_{i}^{(t)}$, $i = 1,\\dots,n_{t}$.\n\n- Test case 1:\n  - $X^{(1)} = [0.0, 0.0, 0.0, 0.3, 0.3, 0.3, 0.7, 0.7, 0.7, 1.5, 1.5, 1.5]$,\n  - $Y^{(1)} = [0.0, 0.5, 1.0, 0.0, 0.5, 1.0, 0.0, 0.5, 1.0, 0.2, 0.5, 1.0]$,\n  - $Z^{(1)} = [0.102, 0.097, 0.105, 0.096, 0.171, 0.201, 0.099, 0.228, 0.279, 0.191, 0.278, 0.373]$.\n- Test case 2:\n  - $X^{(2)} = [0.0, 0.0, 0.0, 0.2, 0.2, 0.2, 0.8, 0.8, 0.8, 1.5, 1.5, 1.5]$,\n  - $Y^{(2)} = [0.0, 0.2, 0.8, 0.0, 0.2, 0.8, 0.0, 0.2, 0.8, 0.1, 0.4, 1.2]$,\n  - $Z^{(2)} = [0.053, 0.181, 0.410, 0.184, 0.291, 0.482, 0.402, 0.478, 0.604, 0.557, 0.625, 0.700]$.\n- Test case 3:\n  - $X^{(3)} = [0.0, 0.1, 0.0, 0.2, 0.5, 0.0, 0.5, 1.0, 0.0, 1.0, 0.3, 1.0]$,\n  - $Y^{(3)} = [0.0, 0.0, 0.1, 0.2, 0.0, 0.5, 0.5, 0.0, 1.0, 0.3, 1.0, 1.0]$,\n  - $Z^{(3)} = [0.120, 0.151, 0.153, 0.233, 0.236, 0.239, 0.346, 0.292, 0.296, 0.366, 0.369, 0.449]$.\n\nYour program must:\n- For each test case $t \\in \\{1,2,3\\}$, fit both $Z_{\\text{AND}}$ and $Z_{\\text{OR}}$ models by minimizing $\\mathrm{RSS}$ subject to the stated bounds.\n- Compute $\\mathrm{AIC}$ for each fitted model using $k = 7$ and $n = n_{t}$.\n- Decide which model is preferred by AIC using the decision rule above.\n\nFinal output format:\n- Produce a single line of output containing the decisions for the three test cases as a comma-separated list enclosed in square brackets, where each entry is an integer: output $1$ to indicate that the AND model is preferred, and $0$ to indicate that the OR model is preferred. For example, a valid output looks like $[1,0,1]$.", "solution": "We begin from a mechanistic base in chemical kinetics and promoter occupancy. Consider transcriptional activation by inputs $X$ and $Y$. Under a fast-binding quasi-equilibrium, the probability that a binding site is occupied follows from mass-action. For a single ligand $X$ binding cooperatively with Hill exponent $n_{x}$ to a site with effective dissociation constant $K_{x}$, the fraction of promoter in an $X$-bound state is\n$$\nf_{x}(X; K_{x}, n_{x}) = \\frac{[X]^{n_{x}}}{K_{x}^{n_{x}} + [X]^{n_{x}}} = \\frac{X^{n_{x}}}{K_{x}^{n_{x}} + X^{n_{x}}}.\n$$\nThis arises from the law of mass action where the ratio of bound to unbound promoter states is proportional to $(X/K_{x})^{n_{x}}$, and the normalized occupancy is the above rational function. Analogously for $Y$ we have\n$$\nf_{y}(Y; K_{y}, n_{y}) = \\frac{Y^{n_{y}}}{K_{y}^{n_{y}} + Y^{n_{y}}}.\n$$\n\nPromoter logic combinations under independence:\n- For an AND-like integration requiring both $X$ and $Y$ to be effectively bound to drive expression, and assuming independent binding events, the joint active fraction is the product $f_{x} f_{y}$, since the joint probability of independent events equals the product of marginal probabilities.\n- For an OR-like integration where either $X$ or $Y$ can activate independently, the probability that at least one is bound is $1 - (1 - f_{x})(1 - f_{y}) = f_{x} + f_{y} - f_{x} f_{y}$.\n\nObservable output model: Let $b \\ge 0$ be a basal output when neither input is active and $V \\ge 0$ the dynamic range of activation. Then\n$$\nZ_{\\text{AND}}(X,Y; \\theta) = b + V \\cdot f_{x}(X; K_{x}, n_{x}) f_{y}(Y; K_{y}, n_{y}),\n$$\n$$\nZ_{\\text{OR}}(X,Y; \\theta) = b + V \\cdot \\big(f_{x}(X; K_{x}, n_{x}) + f_{y}(Y; K_{y}, n_{y}) - f_{x}(X; K_{x}, n_{x}) f_{y}(Y; K_{y}, n_{y})\\big),\n$$\nwith $\\theta = (b, V, K_{x}, K_{y}, n_{x}, n_{y})$.\n\nNoise model and likelihood: Suppose measurements $Z_{i}$ at inputs $(X_{i}, Y_{i})$ obey $Z_{i} = Z_{\\text{model}}(X_{i},Y_{i};\\theta) + \\varepsilon_{i}$ with independent Gaussian errors $\\varepsilon_{i} \\sim \\mathcal{N}(0, \\sigma^{2})$. The log-likelihood for parameters $(\\theta, \\sigma^{2})$ given $n$ observations is\n$$\n\\log L(\\theta,\\sigma^{2}) = -\\frac{n}{2} \\log(2\\pi \\sigma^{2}) - \\frac{1}{2\\sigma^{2}} \\sum_{i=1}^{n} \\left(Z_{i} - Z_{\\text{model}}(X_{i},Y_{i};\\theta)\\right)^{2}.\n$$\nFor fixed $\\theta$, the maximum-likelihood estimator for $\\sigma^{2}$ is $\\hat{\\sigma}^{2} = \\mathrm{RSS}/n$ where $\\mathrm{RSS} = \\sum_{i=1}^{n} r_{i}^{2}$ and $r_{i}$ are residuals. Substituting yields the maximized log-likelihood up to an additive constant:\n$$\n\\log \\hat{L}(\\theta) = -\\frac{n}{2} \\left(1 + \\log(2\\pi) + \\log\\left(\\frac{\\mathrm{RSS}}{n}\\right)\\right).\n$$\nAkaike Information Criterion (AIC): For model selection penalizing complexity, the Akaike Information Criterion is defined as\n$$\n\\mathrm{AIC} = 2k - 2 \\log \\hat{L},\n$$\nwhich under the Gaussian model yields\n$$\n\\mathrm{AIC} = 2k + n \\log\\left(\\frac{\\mathrm{RSS}}{n}\\right) + \\text{constant}.\n$$\nThe additive constant is common to both models and cancels in comparisons, so we adopt\n$$\n\\mathrm{AIC} = 2k + n \\log\\left(\\frac{\\mathrm{RSS}}{n}\\right).\n$$\nThe parameter count $k$ includes all free parameters estimated from the data, namely the six mean-function parameters and the noise variance $\\sigma^{2}$, giving $k = 7$ for both AND and OR models.\n\nAlgorithmic design:\n- For each test case, we have $n$ pairs $(X_{i}, Y_{i})$ and outputs $Z_{i}$. We fit both models by minimizing $\\mathrm{RSS}(\\theta) = \\sum_{i=1}^{n} \\left(Z_{i} - Z_{\\text{model}}(X_{i},Y_{i};\\theta)\\right)^{2}$ subject to bound constraints to ensure physical plausibility and numerical stability: $b \\in [0, 2]$, $V \\in [0, 2]$, $K_{x}, K_{y} \\in [10^{-4}, 10]$, $n_{x}, n_{y} \\in [0.5, 4]$.\n- Nonlinear least squares can be solved using the trust-region reflective algorithm with bounds. Because of nonconvexity and potential local minima, we employ a multi-start strategy: several randomized initial guesses within bounds plus one heuristic initialization based on the data range (e.g., $b$ near $\\min Z$, $V$ near $\\max Z - \\min Z$, and mid-range $K$ values), retaining the best fit (smallest $\\mathrm{RSS}$).\n- Compute $\\mathrm{AIC}$ for both models using $k = 7$ and decide according to the rule: choose the model with smaller $\\mathrm{AIC}$; if $|\\Delta \\mathrm{AIC}| \\le 10^{-9}$ select OR.\n\nInterpretation relative to network motifs:\n- The AND-like combination $f_{x} f_{y}$ is expected in coherent feed-forward loops where both the direct input and an intermediate regulator must be active to produce output, reflecting a logical AND at the promoter.\n- The OR-like combination $f_{x} + f_{y} - f_{x} f_{y}$ arises when either input can activate independently, corresponding to redundancy in regulatory wiring.\n\nApplication to the provided test suite:\n- Test case 1 exhibits behavior consistent with an AND-like multiplicative integration: outputs remain near baseline when either $X$ or $Y$ is near zero and grow substantially only when both increase. Fitting yields a smaller $\\mathrm{AIC}$ for the AND model, hence decision $1$.\n- Test case 2 follows an OR-like pattern: high output occurs when either input is high, consistent with the probabilistic OR combination. Fitting yields a smaller $\\mathrm{AIC}$ for the OR model, hence decision $0$.\n- Test case 3 is intentionally ambiguous with weak interactions and moderate dynamic range, but it is closer to an OR-like soft integration; the OR model slightly outperforms AND by $\\mathrm{AIC}$ under the stated decision rule, hence decision $0$.\n\nTherefore, the program should output a single line with the list $[1,0,0]$ corresponding to the three test cases.", "answer": "[1,0,0]", "id": "2658548"}]}