{"hands_on_practices": [{"introduction": "The first step in analyzing any reaction network is translating its structure into a precise mathematical object. This practice focuses on that foundational skill: constructing the stoichiometric matrix $N$ from a list of reactions. You will then compute its rank, $s = \\operatorname{rank}(N)$, which defines the dimension of the stoichiometric subspace $S$ and reveals the number of independent ways the system's composition can change. [@problem_id:2688774]", "problem": "Consider the chemical reaction network with species $A$, $B$, and $C$ (in that order) and reactions\n$A \\to B$, $2B \\to C$, and $C \\to A$. Using only the definition of the stoichiometric matrix $N$ for a reaction network—namely, that the $j$-th column of $N$ is the net stoichiometric change vector (product stoichiometric coefficients minus reactant stoichiometric coefficients) for reaction $j$ with species as rows—do the following: write $N$ explicitly and then compute $\\operatorname{rank}(N)$ by performing Gaussian elimination on $N$. Report only the value of $\\operatorname{rank}(N)$ as your final answer. The final answer is a single integer, and no rounding is required.", "solution": "The problem is validated as scientifically sound, well-posed, and objective. There are no flaws in its formulation. We proceed to the solution.\n\nThe objective is to determine the rank of the stoichiometric matrix, denoted as $\\operatorname{rank}(N)$, for a given chemical reaction network. The network consists of $3$ chemical species, which we label as $S_1 = A$, $S_2 = B$, and $S_3 = C$, and $3$ reactions:\nReaction $1$: $A \\to B$\nReaction $2$: $2B \\to C$\nReaction $3$: $C \\to A$\n\nThe stoichiometric matrix $N$ is an $m \\times r$ matrix, where $m$ is the number of species and $r$ is the number of reactions. In this case, $m=3$ and $r=3$, so $N$ is a $3 \\times 3$ matrix. The element $N_{ij}$ is the net change in the number of molecules of species $i$ in reaction $j$. The $j$-th column of $N$ is the reaction vector for the $j$-th reaction, with components corresponding to the species in the specified order $(A, B, C)$.\n\nLet us construct the columns of $N$.\n\nFor Reaction $1$, $1A \\to 1B$:\nThe change in species concentrations is $\\Delta A = -1$, $\\Delta B = +1$, $\\Delta C = 0$. The first column of $N$ is therefore:\n$$\n\\mathbf{v}_1 = \\begin{pmatrix} -1 \\\\ 1 \\\\ 0 \\end{pmatrix}\n$$\n\nFor Reaction $2$, $2B \\to 1C$:\nThe change in species concentrations is $\\Delta A = 0$, $\\Delta B = -2$, $\\Delta C = +1$. The second column of $N$ is:\n$$\n\\mathbf{v}_2 = \\begin{pmatrix} 0 \\\\ -2 \\\\ 1 \\end{pmatrix}\n$$\n\nFor Reaction $3$, $1C \\to 1A$:\nThe change in species concentrations is $\\Delta A = +1$, $\\Delta B = 0$, $\\Delta C = -1$. The third column of $N$ is:\n$$\n\\mathbf{v}_3 = \\begin{pmatrix} 1 \\\\ 0 \\\\ -1 \\end{pmatrix}\n$$\n\nCombining these columns, we form the stoichiometric matrix $N$:\n$$\nN = \\begin{pmatrix} -1 & 0 & 1 \\\\ 1 & -2 & 0 \\\\ 0 & 1 & -1 \\end{pmatrix}\n$$\n\nTo find the rank of $N$, we perform Gaussian elimination to reduce it to row-echelon form. Let $R_1, R_2, R_3$ denote the rows of the matrix.\n\nThe initial matrix is:\n$$\n\\begin{pmatrix} -1 & 0 & 1 \\\\ 1 & -2 & 0 \\\\ 0 & 1 & -1 \\end{pmatrix}\n$$\n\nThe first pivot is in the first row, first column. We use it to eliminate the entry below it. We perform the row operation $R_2 \\to R_2 + R_1$:\n$$\n\\begin{pmatrix} -1 & 0 & 1 \\\\ 1+(-1) & -2+0 & 0+1 \\\\ 0 & 1 & -1 \\end{pmatrix} = \\begin{pmatrix} -1 & 0 & 1 \\\\ 0 & -2 & 1 \\\\ 0 & 1 & -1 \\end{pmatrix}\n$$\n\nThe submatrix below the first row now needs to be reduced. The second pivot is in the second row, second column. We use it to eliminate the entry below it. We perform the row operation $R_3 \\to R_3 + \\frac{1}{2}R_2$:\n$$\n\\begin{pmatrix} -1 & 0 & 1 \\\\ 0 & -2 & 1 \\\\ 0+ \\frac{1}{2}(0) & 1+\\frac{1}{2}(-2) & -1+\\frac{1}{2}(1) \\end{pmatrix} = \\begin{pmatrix} -1 & 0 & 1 \\\\ 0 & -2 & 1 \\\\ 0 & 0 & -\\frac{1}{2} \\end{pmatrix}\n$$\n\nThis matrix is in row-echelon form. The rank of a matrix is equal to the number of non-zero rows in its row-echelon form. We can clearly observe that there are $3$ non-zero rows:\nRow $1$: $(-1, 0, 1)$\nRow $2$: $(0, -2, 1)$\nRow $3$: $(0, 0, -\\frac{1}{2})$\n\nSince there are $3$ non-zero rows, the rank of the matrix $N$ is $3$. The dimension of the stoichiometric subspace is therefore $3$.\n$$\n\\operatorname{rank}(N) = 3\n$$", "answer": "$$\n\\boxed{3}\n$$", "id": "2688774"}, {"introduction": "The dimension of the stoichiometric subspace is not just an abstract number; it is deeply connected to the physical conservation laws of a system, such as the conservation of mass or atomic elements. This exercise demonstrates how a conserved quantity, represented by a vector $w$ for which $w^T N = 0$, corresponds to a linear dependency among the rows of the stoichiometric matrix $N$. This correspondence provides a powerful way to understand and constrain the rank of $N$ based on the physical properties of the network. [@problem_id:2688818]", "problem": "Consider a closed, well-mixed isothermal reaction system with three chemical species $A$, $B$, and $C$ that interconvert through the three reversible pairs $A \\rightleftharpoons B$, $B \\rightleftharpoons C$, and $A \\rightleftharpoons C$. Treat each reversible pair as two separate irreversible reactions, so there are $6$ irreversible reactions in total. Order the species as $(A,B,C)$ and the reaction columns as $(A \\to B,\\ B \\to A,\\ B \\to C,\\ C \\to B,\\ A \\to C,\\ C \\to A)$.\n\nUsing only fundamental definitions, construct the stoichiometric matrix $N$ for this network, where each column of $N$ is the stoichiometric change vector $y' - y$ for the corresponding irreversible reaction $y \\to y'$. Define the stoichiometric subspace $\\mathcal{S}$ as the span of the columns of $N$, and recall that $\\dim \\mathcal{S} = \\operatorname{rank}(N)$ by definition.\n\nDemonstrate, from first principles, why the total amount $x_A + x_B + x_C$ is conserved for this network, and use this conservation to bound $\\operatorname{rank}(N)$. Then verify by explicit linear algebra on your computed $N$ that $\\operatorname{rank}(N)$ attains this bound, even though there are $3$ reversible pairs.\n\nProvide as your final answer the value of $\\operatorname{rank}(N)$. No numerical rounding is required, and no physical units are needed for the final answer.", "solution": "The problem as stated is scientifically grounded, well-posed, objective, and contains all necessary information for a unique solution. It is a standard exercise in the analysis of chemical reaction networks. Therefore, the problem is valid, and we proceed with the solution.\n\nThe system involves three chemical species, which we order as a vector $\\mathbf{x} = (x_A, x_B, x_C)^T$, where $x_i$ represents the amount or concentration of species $i$. The network consists of six irreversible reactions, which we order as specified: $R_1: A \\to B$, $R_2: B \\to A$, $R_3: B \\to C$, $R_4: C \\to B$, $R_5: A \\to C$, and $R_6: C \\to A$.\n\nFirst, we construct the stoichiometric matrix $N$. This is an $m \\times r$ matrix, where $m$ is the number of species ($m=3$) and $r$ is the number of reactions ($r=6$). Each column of $N$ is the reaction vector for the corresponding reaction, representing the net change in the amounts of each species.\nFor $R_1: A \\to B$, the change is $-1$ for $A$ and $+1$ for $B$. The vector is $(-1, 1, 0)^T$.\nFor $R_2: B \\to A$, the change is $+1$ for $A$ and $-1$ for $B$. The vector is $(1, -1, 0)^T$.\nFor $R_3: B \\to C$, the change is $-1$ for $B$ and $+1$ for $C$. The vector is $(0, -1, 1)^T$.\nFor $R_4: C \\to B$, the change is $+1$ for $B$ and $-1$ for $C$. The vector is $(0, 1, -1)^T$.\nFor $R_5: A \\to C$, the change is $-1$ for $A$ and $+1$ for $C$. The vector is $(-1, 0, 1)^T$.\nFor $R_6: C \\to A$, the change is $+1$ for $A$ and $-1$ for $C$. The vector is $(1, 0, -1)^T$.\n\nAssembling these column vectors in the specified order gives the $3 \\times 6$ stoichiometric matrix $N$:\n$$\nN = \\begin{pmatrix}\n-1 & 1 & 0 & 0 & -1 & 1 \\\\\n1 & -1 & -1 & 1 & 0 & 0 \\\\\n0 & 0 & 1 & -1 & 1 & -1\n\\end{pmatrix}\n$$\n\nNext, we demonstrate from first principles that the total amount of substance, $x_{total} = x_A + x_B + x_C$, is a conserved quantity. The dynamics of the system are described by the vector ordinary differential equation $\\frac{d\\mathbf{x}}{dt} = N \\mathbf{v}(\\mathbf{x})$, where $\\mathbf{v}(\\mathbf{x})$ is the vector of reaction rates, whose components are non-negative.\nThe total amount can be written as the dot product $\\mathbf{1}^T \\mathbf{x}$, where $\\mathbf{1} = (1, 1, 1)^T$. The time derivative of this quantity is:\n$$\n\\frac{d}{dt}(x_A + x_B + x_C) = \\frac{d}{dt}(\\mathbf{1}^T \\mathbf{x}) = \\mathbf{1}^T \\frac{d\\mathbf{x}}{dt} = \\mathbf{1}^T (N \\mathbf{v}(\\mathbf{x})) = (\\mathbf{1}^T N) \\mathbf{v}(\\mathbf{x})\n$$\nFor this quantity to be conserved for any set of reaction rates $\\mathbf{v}(\\mathbf{x})$, the vector $\\mathbf{1}^T N$ must be the zero vector. We compute this product:\n$$\n\\mathbf{1}^T N = \\begin{pmatrix} 1 & 1 & 1 \\end{pmatrix}\n\\begin{pmatrix}\n-1 & 1 & 0 & 0 & -1 & 1 \\\\\n1 & -1 & -1 & 1 & 0 & 0 \\\\\n0 & 0 & 1 & -1 & 1 & -1\n\\end{pmatrix}\n$$\n$$\n= \\begin{pmatrix}\n(-1+1+0) & (1-1+0) & (0-1+1) & (0+1-1) & (-1+0+1) & (1+0-1)\n\\end{pmatrix}\n$$\n$$\n= \\begin{pmatrix} 0 & 0 & 0 & 0 & 0 & 0 \\end{pmatrix} = \\mathbf{0}^T\n$$\nSince $\\mathbf{1}^T N = \\mathbf{0}^T$, it follows that $\\frac{d}{dt}(x_A + x_B + x_C) = 0$ for all time, confirming that the total amount is conserved. A vector $\\mathbf{w}$ such that $\\mathbf{w}^T N = \\mathbf{0}^T$ is called a left null vector of $N$. The existence of such a non-zero vector, in this case $\\mathbf{w} = \\mathbf{1}$, implies a linear dependency among the rows of $N$. Specifically, $\\text{row}_1 + \\text{row}_2 + \\text{row}_3 = \\mathbf{0}^T$.\n\nThis conservation law allows us to bound the rank of $N$. The rank of a matrix is equal to the dimension of its row space. Since there is a linear dependency among the three rows, they cannot span a $3$-dimensional space. The dimension of the left null space of $N$, denoted $\\operatorname{nullity}(N^T)$, is at least $1$ because it contains the non-zero vector $\\mathbf{1}$. By the rank-nullity theorem applied to $N^T$, we have $\\operatorname{rank}(N^T) + \\operatorname{nullity}(N^T) = m$, where $m=3$ is the number of rows. Since $\\operatorname{rank}(N) = \\operatorname{rank}(N^T)$, this gives:\n$$\n\\operatorname{rank}(N) = m - \\operatorname{nullity}(N^T) \\le 3 - 1 = 2\n$$\nThus, the rank of $N$ is at most $2$.\n\nFinally, we verify the rank of $N$ by explicit linear algebra to show it attains this bound. We can perform Gaussian elimination on $N$ to find its row echelon form.\nStarting with $N$:\n$$\nN = \\begin{pmatrix}\n-1 & 1 & 0 & 0 & -1 & 1 \\\\\n1 & -1 & -1 & 1 & 0 & 0 \\\\\n0 & 0 & 1 & -1 & 1 & -1\n\\end{pmatrix}\n$$\nAdd row $1$ to row $2$ ($R_2 \\to R_2 + R_1$):\n$$\n\\begin{pmatrix}\n-1 & 1 & 0 & 0 & -1 & 1 \\\\\n0 & 0 & -1 & 1 & -1 & 1 \\\\\n0 & 0 & 1 & -1 & 1 & -1\n\\end{pmatrix}\n$$\nAdd row $2$ to row $3$ ($R_3 \\to R_3 + R_2$):\n$$\n\\begin{pmatrix}\n-1 & 1 & 0 & 0 & -1 & 1 \\\\\n0 & 0 & -1 & 1 & -1 & 1 \\\\\n0 & 0 & 0 & 0 & 0 & 0\n\\end{pmatrix}\n$$\nThis matrix is in row echelon form. It contains two non-zero rows. The number of non-zero rows in the row echelon form of a matrix is its rank. Therefore, $\\operatorname{rank}(N) = 2$.\n\nThis confirms that the rank attains the upper bound derived from the conservation law. The reason the rank is not further reduced despite the cyclic nature of the three reversible pairs is that this cycle does not introduce any new, independent conservation laws. The reaction vectors for the three pairs are themselves linearly dependent. For instance, consider the forward reactions $A \\to B$ (vector $\\mathbf{c}_1$), $B \\to C$ (vector $\\mathbf{c}_3$), and $A \\to C$ (vector $\\mathbf{c}_5$):\n$$\n\\mathbf{c}_1 = \\begin{pmatrix} -1 \\\\ 1 \\\\ 0 \\end{pmatrix}, \\quad \\mathbf{c}_3 = \\begin{pmatrix} 0 \\\\ -1 \\\\ 1 \\end{pmatrix}, \\quad \\mathbf{c}_5 = \\begin{pmatrix} -1 \\\\ 0 \\\\ 1 \\end{pmatrix}\n$$\nIt is clear that $\\mathbf{c}_1 + \\mathbf{c}_3 = \\mathbf{c}_5$. This linear dependence among the reaction vectors themselves means that the third \"path\" ($A \\rightleftharpoons C$) does not add to the dimension of the stoichiometric subspace $\\mathcal{S}$ already spanned by the other two paths ($A \\rightleftharpoons B$ and $B \\rightleftharpoons C$). The dimension of the stoichiometric subspace $\\mathcal{S} = \\operatorname{span}(\\text{columns of } N)$ is, by definition, the rank of $N$. The calculation confirms $\\dim \\mathcal{S} = 2$.", "answer": "$$\n\\boxed{2}\n$$", "id": "2688818"}, {"introduction": "While manual analysis is instructive, realistic biochemical models are often too large and complex to handle by hand, necessitating computational tools. This final practice bridges theory and application, guiding you to implement a numerically robust algorithm for discovering a network's complete set of linear conservation laws. You will use the Singular Value Decomposition (SVD), a cornerstone of modern numerical linear algebra, to find a basis for the left nullspace of the stoichiometric matrix $N$, which is precisely the space containing all such conservation laws. [@problem_id:2688808]", "problem": "You are given a stoichiometric matrix $N \\in \\mathbb{R}^{m \\times r}$ of a chemical reaction network with $m$ chemical species and $r$ reactions. The stoichiometric subspace is the column space of $N$, and linear conservation laws are vectors $w \\in \\mathbb{R}^{m}$ such that $w^{\\top} N = 0$. Let $W \\in \\mathbb{R}^{d \\times m}$ be a matrix whose rows form a basis of the left nullspace of $N$ (that is, each row is a conservation-law vector), where $d = m - \\operatorname{rank}(N)$.\n\nStarting from the fundamental species balance $\\frac{dx}{dt} = N v(x)$ for concentration vector $x \\in \\mathbb{R}^{m}$ and reaction rate vector $v(x) \\in \\mathbb{R}^{r}$, one has $\\frac{d}{dt}(w^{\\top} x) = w^{\\top} N v(x)$. Therefore, for $w^{\\top} x$ to be invariant along all trajectories consistent with $N$ and any admissible $v(x)$, it is necessary and sufficient that $w^{\\top} N = 0$. Hence, the left nullspace of $N$ encodes all linear conservation laws, and its dimension $d$ equals the number of independent linear invariants.\n\nYour task is to write a complete program that, for each provided test matrix $N$, performs the following steps in a numerically stable way using the singular value decomposition (singular value decomposition (SVD)):\n\n1. Compute a numerical rank $\\operatorname{rank}(N)$ by thresholding singular values. Use the threshold\n$$\n\\mathrm{tol} = \\max\\{m,r\\} \\cdot \\epsilon \\cdot \\max\\{s_i\\},\n$$\nwhere $\\epsilon$ is the machine epsilon for double precision and $s_i$ are the singular values of $N$. Singular values $s_i \\le \\mathrm{tol}$ should be treated as zero. If $N$ is the zero matrix so that $\\max\\{s_i\\}$ is undefined, take $\\mathrm{tol} = 0$.\n\n2. Extract an orthonormal basis of the left nullspace of $N$ from the SVD factorization $N = U \\Sigma V^{\\top}$. If $\\operatorname{rank}(N) = \\rho$, then the last $m - \\rho$ columns of $U$ span the left nullspace. Form $W \\in \\mathbb{R}^{(m-\\rho)\\times m}$ by taking these columns and transposing, so that the rows of $W$ are the basis vectors.\n\n3. Verify the conservation-law condition by computing the matrix product $W N$ and measuring the maximum absolute entry of $W N$. Use the verification tolerance $\\delta = 10^{-10}$ and declare the check as passed if and only if $\\max_{i,j} |(W N)_{ij}| \\le \\delta$. If $W$ has zero rows (i.e., $m-\\rho=0$), define the maximum absolute entry to be $0$ by convention.\n\nFor each test case, your program must output the tuple of four values\n$[\\operatorname{rank}(N), d, \\max_{i,j} |(WN)_{ij}|, \\text{passed}]$,\nwhere $d = m - \\operatorname{rank}(N)$ and $\\text{passed}$ is a boolean indicating whether the verification succeeded under the tolerance $\\delta$.\n\nTest suite (each $N$ is given as a list of columns, i.e., each column is the net stoichiometric change vector for a reaction, and units are dimensionless counts of molecules per reaction event):\n1. A three-species, three-reaction network with one conservation law:\n   $$\n   N_1 = \\begin{bmatrix}\n   -1 & 1 & 0 \\\\\n   1 & -1 & -1 \\\\\n   0 & 0 & 1\n   \\end{bmatrix}.\n   $$\n   This corresponds to reactions $A \\to B$, $B \\to A$, and $B \\to C$.\n\n2. A two-species matrix of full row rank (no conservation laws beyond the trivial zero vector):\n   $$\n   N_2 = \\begin{bmatrix}\n   1 & 0 & 1 \\\\\n   0 & 1 & 1\n   \\end{bmatrix}.\n   $$\n\n3. A three-species zero matrix (maximal number of conservation laws):\n   $$\n   N_3 = \\begin{bmatrix}\n   0 & 0 \\\\\n   0 & 0 \\\\\n   0 & 0\n   \\end{bmatrix}.\n   $$\n\n4. A three-species, four-reaction nearly rank-$1$ matrix (tests numerical tolerance handling):\n   $$\n   N_4 = \\begin{bmatrix}\n   1 & 2 & 0 & 10^{-12} \\\\\n   -1 & -2 & 0 & -10^{-12} \\\\\n   0 & 0 & 0 & 0\n   \\end{bmatrix}.\n   $$\n\nFinal output format: Your program should produce a single line of output containing a comma-separated list enclosed in square brackets, where each entry corresponds to one test case in the same order as above, and each entry is itself a list of the four values: `[[\\dots],[\\dots],[\\dots],[\\dots]]`. Angles and physical units do not apply in this problem. All floating-point values may be reported in standard decimal notation.", "solution": "The problem requires the implementation of a numerically stable algorithm to analyze the linear conservation laws of a chemical reaction network, represented by its stoichiometric matrix $N \\in \\mathbb{R}^{m \\times r}$. A linear conservation law is a vector $w \\in \\mathbb{R}^{m}$ such that the weighted sum of species concentrations, $w^{\\top}x$, remains constant over time. This condition is equivalent to $w^{\\top}N=0$, meaning that the space of all linear conservation laws is the left nullspace of $N$, denoted $\\operatorname{Nul}(N^{\\top})$. The dimension of this space, $d$, is given by the rank-nullity theorem as $d = m - \\operatorname{rank}(N)$.\n\nOur task is to compute the rank $\\rho = \\operatorname{rank}(N)$, the dimension of the conservation space $d$, and to find an orthonormal basis for this space, represented by the rows of a matrix $W \\in \\mathbb{R}^{d \\times m}$. We must then verify that this basis satisfies the conservation condition, $W N = 0$, within a specified numerical tolerance.\n\nThe method of choice for such tasks in numerical linear algebra is the Singular Value Decomposition (SVD), due to its robustness in the presence of floating-point arithmetic and its ability to deal with rank-deficient and near-singular matrices. The SVD of $N$ is the factorization $N = U \\Sigma V^{\\top}$, where $U \\in \\mathbb{R}^{m \\times m}$ and $V \\in \\mathbb{R}^{r \\times r}$ are orthogonal matrices, and $\\Sigma \\in \\mathbb{R}^{m \\times r}$ is a rectangular diagonal matrix containing the non-negative singular values, $s_i$, in descending order. The columns of $U$ form an orthonormal basis for $\\mathbb{R}^m$, and the columns of $V$ form an orthonormal basis for $\\mathbb{R}^r$.\n\nThe algorithm proceeds in three distinct steps as mandated.\n\nStep 1: Computation of Numerical Rank.\nThe rank of a matrix is the number of its non-zero singular values. In a computational context, singular values that are very small are typically treated as zero to account for floating-point inaccuracies. We compute the numerical rank, $\\rho$, by counting the number of singular values $s_i$ that exceed a specified tolerance, $\\mathrm{tol}$. The tolerance is defined as:\n$$\n\\mathrm{tol} = \\max\\{m, r\\} \\cdot \\epsilon \\cdot s_{\\max}\n$$\nwhere $s_{\\max} = \\max\\{s_i\\}$ is the largest singular value of $N$, and $\\epsilon$ is the machine epsilon for double-precision floating-point numbers. This choice of tolerance scales with the dimensions of the matrix and its largest singular value, providing a robust criterion for distinguishing significant singular values from numerical noise. If $N$ is the zero matrix, all its singular values are zero, so $s_{\\max}=0$ and consequently $\\mathrm{tol}=0$. The rank $\\rho$ is then the count of $s_i > \\mathrm{tol}$.\n\nStep 2: Extraction of the Left Nullspace Basis.\nThe SVD provides a direct way to obtain an orthonormal basis for the fundamental subspaces of $N$. The relationship $N = U \\Sigma V^{\\top}$ implies $N^{\\top} = V \\Sigma^{\\top} U^{\\top}$. From this, we have $N^{\\top}U = V \\Sigma^{\\top}$. The columns of $U$ are the eigenvectors of $NN^{\\top}$. The left nullspace, $\\operatorname{Nul}(N^{\\top})$, consists of all vectors $w$ such that $N^{\\top}w = 0$. If the rank of $N$ is $\\rho$, then the first $\\rho$ singular values are positive, and the remaining $m-\\rho$ are zero. The last $m-\\rho$ columns of $U$, corresponding to these zero singular values, form an orthonormal basis for the left nullspace of $N$. Let these columns be $u_{\\rho+1}, \\dots, u_m$. We construct the matrix $W \\in \\mathbb{R}^{d \\times m}$, where $d=m-\\rho$, by taking these basis vectors as its rows. That is, the $i$-th row of $W$ is $u_{\\rho+i}^{\\top}$. In matrix notation, $W$ is formed by taking the transpose of the submatrix of $U$ consisting of its last $d$ columns. If $d=0$ (i.e., the matrix has full row rank), the left nullspace is trivial, containing only the zero vector, and the matrix $W$ is empty, having zero rows.\n\nStep 3: Verification of the Conservation-Law Condition.\nWith the computed rank $\\rho$ and basis matrix $W$, we must verify the condition $WN = 0$. Due to floating-point arithmetic, the result of the matrix product $WN$ will not be exactly the zero matrix but a matrix whose entries are very close to zero. We quantify this by computing the maximum absolute value of all entries in the product matrix $WN$.\n$$ \\text{error} = \\max_{i,j} |(WN)_{ij}| $$\nThis error must be compared against a small, absolute verification tolerance, $\\delta = 10^{-10}$. The verification is considered passed if this error is less than or equal to $\\delta$. In the case where the left nullspace is trivial ($d=0$), $W$ is a $0 \\times m$ matrix. The product $WN$ is a $0 \\times r$ matrix, and by the problem's convention, the maximum absolute entry is defined to be $0$, which trivially passes the verification.\n\nThis complete procedure is applied to each test matrix provided. The final output for each matrix is a tuple containing the computed rank $\\rho$, the dimension of the left nullspace $d$, the verification error, and a boolean indicating the outcome of the verification.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem for all test cases and prints the results.\n    \"\"\"\n    # Test cases defined as lists of lists, representing the matrices.\n    test_cases = [\n        # N1: 3-species, 3-reaction network\n        np.array([\n            [-1.0, 1.0, 0.0],\n            [1.0, -1.0, -1.0],\n            [0.0, 0.0, 1.0]\n        ]),\n        # N2: 2-species, full row rank\n        np.array([\n            [1.0, 0.0, 1.0],\n            [0.0, 1.0, 1.0]\n        ]),\n        # N3: 3-species zero matrix\n        np.array([\n            [0.0, 0.0],\n            [0.0, 0.0],\n            [0.0, 0.0]\n        ]),\n        # N4: 3-species, nearly rank-1 matrix\n        np.array([\n            [1.0, 2.0, 0.0, 1.0e-12],\n            [-1.0, -2.0, 0.0, -1.0e-12],\n            [0.0, 0.0, 0.0, 0.0]\n        ])\n    ]\n\n    all_results = []\n    for N in test_cases:\n        result = analyze_stoichiometric_matrix(N)\n        all_results.append(result)\n\n    # Format the final output string according to the problem specification.\n    # Each sub-list is converted to a string without spaces.\n    formatted_results = [f\"[{','.join(map(str, res))}]\" for res in all_results]\n    print(f\"[{','.join(formatted_results)}]\")\n\ndef analyze_stoichiometric_matrix(N):\n    \"\"\"\n    Performs SVD-based analysis of a single stoichiometric matrix N.\n\n    Args:\n        N (np.ndarray): The stoichiometric matrix of size m x r.\n\n    Returns:\n        list: A list containing [rank, d, max_abs_error, passed].\n    \"\"\"\n    m, r = N.shape\n    verification_tolerance = 1e-10\n\n    # Perform SVD. full_matrices=True is essential to get the full m x m U matrix.\n    U, s, Vh = np.linalg.svd(N, full_matrices=True)\n\n    # Step 1: Compute numerical rank\n    eps = np.finfo(float).eps\n    s_max = np.max(s) if s.size > 0 else 0.0\n    rank_tolerance = max(m, r) * eps * s_max\n    \n    numerical_rank = np.sum(s > rank_tolerance)\n    rho = numerical_rank\n\n    # Step 2: Extract an orthonormal basis of the left nullspace\n    d = m - rho\n    \n    if d > 0:\n        # The last m-rho columns of U form the basis for the left nullspace.\n        # W has these vectors as rows.\n        W = U[:, rho:].T\n    else:\n        # If d=0, W is an empty matrix of shape (0, m).\n        W = np.empty((0, m))\n\n    # Step 3: Verify the conservation-law condition\n    if W.shape[0] > 0:\n        # Compute the product WN\n        WN = W @ N\n        # Calculate the maximum absolute entry\n        max_abs_error = np.max(np.abs(WN))\n    else:\n        # By convention, if W has zero rows, the error is 0.\n        max_abs_error = 0.0\n    \n    passed = max_abs_error = verification_tolerance\n    \n    # Python's default True/False representation is acceptable.\n    return [rho, d, max_abs_error, passed]\n\n\nsolve()\n```", "id": "2688808"}]}