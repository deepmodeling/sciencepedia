{"hands_on_practices": [{"introduction": "A cornerstone of chemical kinetics is understanding the relationship between different theoretical frameworks. This exercise provides a fundamental, hands-on derivation that connects the microcanonical world of Rice–Ramsperger–Kassel–Marcus (RRKM) theory with the canonical ensemble of Transition State Theory (TST). By performing the canonical averaging for a system of harmonic oscillators—a foundational model in chemistry—you will formally prove that the general RRKM expression for the rate constant $k(E)$ yields the classic Eyring-Polanyi equation for the thermal rate constant $k(T)$ in the high-temperature limit [@problem_id:2629270]. This practice solidifies the theoretical link between these two powerful theories and reinforces your skills in manipulating partition functions.", "problem": "Consider a separable model of a unimolecular isomerization possessing a $1$D parabolic barrier along a reaction coordinate coupled to harmonic bath modes. In the reactant well, the vibrational motion consists of one stable reaction coordinate mode of angular frequency $\\omega_{0}$ and $s$ orthogonal stable bath modes with angular frequencies $\\{\\omega_{i}\\}_{i=1}^{s}$. At the saddle point (transition state), the reaction coordinate becomes unstable (inverted parabola) with curvature magnitude $\\omega_{b}$, and the $s$ orthogonal stable modes have angular frequencies $\\{\\omega_{i}^{\\ddagger}\\}_{i=1}^{s}$. The potential energy maximum at the saddle is $E_{b}$ above the reactant minimum, which is taken as the zero of energy.\n\nLet $\\rho_{R}(E)$ be the microcanonical density of states of the reactant and $N^{\\ddagger}(E)$ be the sum of states of the transition-state dividing surface excluding the unstable mode, both defined for the vibrational degrees of freedom described above. Within Rice–Ramsperger–Kassel–Marcus (RRKM) theory, the microcanonical rate constant is $k(E)=N^{\\ddagger}(E)/(h\\,\\rho_{R}(E))$, where $h$ is Planck’s constant. The canonical thermal rate constant is defined by canonical averaging, $k(T)=\\langle k(E)\\rangle_{\\beta}$ with $\\beta=1/(k_{B}T)$ and $k_{B}$ the Boltzmann constant.\n\nStarting only from these definitions and standard results for harmonic-oscillator partition functions, carry out the canonical averaging to obtain a closed-form expression for $k(T)$ in terms of $k_{B}$, $h$, $T$, $E_{b}$, and the angular frequencies. Then take the classical (high-temperature) limit $\\beta\\hbar\\omega\\ll 1$ for all stable modes (with $\\hbar=h/(2\\pi)$) and simplify the result to show explicitly that it reduces to the Eyring/transition-state-theory form for this harmonic model.\n\nExpress your final result as a single closed-form analytic expression in terms of $k_{B}$, $h$, $T$, $E_{b}$, and the set of angular frequencies $\\{\\omega_{0},\\omega_{i},\\omega_{i}^{\\ddagger}\\}$; do not include units in your final expression.", "solution": "The problem requires the derivation of the canonical thermal rate constant, $k(T)$, for a unimolecular isomerization reaction modeled with a separable harmonic potential. The derivation must start from the canonical averaging of the Rice–Ramsperger–Kassel–Marcus (RRKM) microcanonical rate constant, $k(E)$, and then be simplified to its classical, high-temperature limit, which corresponds to the Eyring/Transition-State Theory (TST) form for this model.\n\nThe validation of the problem statement proceeds as follows.\nGivens:\n- Reactant potential well: $1$ stable reaction coordinate mode with angular frequency $\\omega_{0}$ and $s$ orthogonal stable bath modes with angular frequencies $\\{\\omega_{i}\\}_{i=1}^{s}$. The potential minimum is the zero of energy.\n- Transition state (saddle point): potential energy is $E_{b}$. The reaction coordinate is an unstable mode with curvature magnitude $\\omega_{b}$. The $s$ orthogonal modes are stable with angular frequencies $\\{\\omega_{i}^{\\ddagger}\\}_{i=1}^{s}$.\n- Microcanonical density of states of the reactant: $\\rho_{R}(E)$.\n- Sum of states of the transition-state dividing surface (excluding the unstable mode): $N^{\\ddagger}(E)$.\n- RRKM microcanonical rate constant: $k(E)=\\frac{N^{\\ddagger}(E-E_b)}{h\\,\\rho_{R}(E)}$. Note that the argument of $N^{\\ddagger}$ is the energy available to the active modes at the transition state, which is total energy $E$ minus the barrier height $E_b$.\n- Canonical thermal rate constant $k(T)$ is obtained by canonical averaging of $k(E)$: $k(T)=\\langle k(E)\\rangle_{\\beta}$, where $\\beta=1/(k_{B}T)$.\n\nProblem Validation:\nThe problem is scientifically grounded, being a standard topic in chemical kinetics combining RRKM and TST. It is well-posed, providing all necessary definitions and a clear objective. The model, while an idealization, is a cornerstone of reaction rate theory and does not violate any physical principles. The problem is therefore deemed valid.\n\nSolution Derivation:\nThe canonical average of a microcanonical quantity $A(E)$ is given by the integral over all energies, weighted by the Boltzmann distribution of reactant states:\n$$\nk(T) = \\langle k(E) \\rangle_{\\beta} = \\frac{\\int_{0}^{\\infty} k(E) \\rho_{R}(E) \\exp(-\\beta E) dE}{\\int_{0}^{\\infty} \\rho_{R}(E) \\exp(-\\beta E) dE}\n$$\nThe denominator is the canonical partition function of the reactant, $Q_{R}(\\beta)$.\n$$\nQ_{R}(\\beta) = \\int_{0}^{\\infty} \\rho_{R}(E) \\exp(-\\beta E) dE\n$$\nSubstituting the given RRKM expression for $k(E)$, we get:\n$$\nk(T) = \\frac{1}{Q_{R}(\\beta)} \\int_{0}^{\\infty} \\frac{N^{\\ddagger}(E-E_{b})}{h\\,\\rho_{R}(E)} \\rho_{R}(E) \\exp(-\\beta E) dE\n$$\nThe density of reactant states, $\\rho_{R}(E)$, cancels. The sum of states $N^{\\ddagger}(E-E_{b})$ is zero for $E < E_{b}$, so the lower limit of integration becomes $E_{b}$.\n$$\nk(T) = \\frac{1}{h\\,Q_{R}(\\beta)} \\int_{E_{b}}^{\\infty} N^{\\ddagger}(E-E_{b}) \\exp(-\\beta E) dE\n$$\nWe perform a change of variable to $\\epsilon = E - E_{b}$, which implies $E = \\epsilon + E_{b}$ and $dE=d\\epsilon$. The integration limits for $\\epsilon$ are from $0$ to $\\infty$.\n$$\nk(T) = \\frac{1}{h\\,Q_{R}(\\beta)} \\int_{0}^{\\infty} N^{\\ddagger}(\\epsilon) \\exp(-\\beta (\\epsilon + E_{b})) d\\epsilon\n$$\nThe term $\\exp(-\\beta E_{b})$ is constant with respect to the integration and can be factored out.\n$$\nk(T) = \\frac{\\exp(-\\beta E_{b})}{h\\,Q_{R}(\\beta)} \\int_{0}^{\\infty} N^{\\ddagger}(\\epsilon) \\exp(-\\beta \\epsilon) d\\epsilon\n$$\nThe remaining integral is the Laplace transform of the sum of states $N^{\\ddagger}(\\epsilon)$. This transform is related to the partition function of the transition state, $Q^{\\ddagger}(\\beta)$. The partition function is the Laplace transform of the density of states, $\\rho^{\\ddagger}(\\epsilon)$: $Q^{\\ddagger}(\\beta) = \\int_{0}^{\\infty} \\rho^{\\ddagger}(\\epsilon) \\exp(-\\beta \\epsilon) d\\epsilon$. Since $N^{\\ddagger}(\\epsilon) = \\int_{0}^{\\epsilon} \\rho^{\\ddagger}(\\epsilon') d\\epsilon'$, we can use integration by parts to show that $\\int_{0}^{\\infty} N^{\\ddagger}(\\epsilon) \\exp(-\\beta \\epsilon) d\\epsilon = \\frac{1}{\\beta}Q^{\\ddagger}(\\beta)$.\nSubstituting this result into our expression for $k(T)$:\n$$\nk(T) = \\frac{\\exp(-\\beta E_{b})}{h\\,Q_{R}(\\beta)} \\frac{Q^{\\ddagger}(\\beta)}{\\beta}\n$$\nUsing $\\beta = 1/(k_{B}T)$ and $\\hbar = h/(2\\pi)$, this becomes the standard quantum TST expression:\n$$\nk(T) = \\frac{k_{B}T}{h} \\frac{Q^{\\ddagger}(\\beta)}{Q_{R}(\\beta)} \\exp\\left(-\\frac{E_{b}}{k_{B}T}\\right)\n$$\nHere, $Q_{R}(\\beta)$ is the partition function for the $s+1$ reactant harmonic modes, and $Q^{\\ddagger}(\\beta)$ is the partition function for the $s$ stable harmonic modes at the transition state. For a separable harmonic system, the total partition function is the product of individual partition functions. The partition function for a single quantum harmonic oscillator of frequency $\\omega$, with energy measured from the potential minimum, is:\n$$\nq(\\beta, \\omega) = \\frac{1}{2\\sinh(\\beta\\hbar\\omega/2)}\n$$\nThus, the reactant and transition state partition functions are:\n$$\nQ_{R}(\\beta) = q(\\beta, \\omega_{0}) \\prod_{i=1}^{s} q(\\beta, \\omega_{i}) = \\frac{1}{2\\sinh(\\beta\\hbar\\omega_{0}/2)} \\prod_{i=1}^{s} \\frac{1}{2\\sinh(\\beta\\hbar\\omega_{i}/2)}\n$$\n$$\nQ^{\\ddagger}(\\beta) = \\prod_{i=1}^{s} q(\\beta, \\omega_{i}^{\\ddagger}) = \\prod_{i=1}^{s} \\frac{1}{2\\sinh(\\beta\\hbar\\omega_{i}^{\\ddagger}/2)}\n$$\nThe problem asks for the classical (high-temperature) limit. This corresponds to the condition $\\beta\\hbar\\omega \\ll 1$ for all frequencies $\\omega$. In this limit, the hyperbolic sine can be approximated by its argument, $\\sinh(x) \\approx x$.\n$$\nq(\\beta, \\omega) \\approx \\frac{1}{2(\\beta\\hbar\\omega/2)} = \\frac{1}{\\beta\\hbar\\omega} = \\frac{k_{B}T}{\\hbar\\omega}\n$$\nThis is the classical partition function for a harmonic oscillator. Substituting these classical forms into the ratio $Q^{\\ddagger}/Q_{R}$:\n$$\n\\frac{Q^{\\ddagger, \\text{cl}}(\\beta)}{Q_{R}^{\\text{cl}}(\\beta)} = \\frac{\\prod_{i=1}^{s} (k_{B}T/(\\hbar\\omega_{i}^{\\ddagger}))}{(k_{B}T/(\\hbar\\omega_{0})) \\prod_{i=1}^{s} (k_{B}T/(\\hbar\\omega_{i}))}\n$$\nThe terms $(k_{B}T/\\hbar)$ cancel, with one factor remaining in the denominator.\n$$\n\\frac{Q^{\\ddagger, \\text{cl}}(\\beta)}{Q_{R}^{\\text{cl}}(\\beta)} = \\frac{(k_{B}T/\\hbar)^{s} \\prod_{i=1}^{s} (\\omega_{i}^{\\ddagger})^{-1}}{(k_{B}T/\\hbar)^{s+1} (\\omega_{0})^{-1} \\prod_{i=1}^{s} (\\omega_{i})^{-1}} = \\frac{1}{k_{B}T/\\hbar} \\frac{\\omega_{0} \\prod_{i=1}^{s} \\omega_{i}}{\\prod_{i=1}^{s} \\omega_{i}^{\\ddagger}} = \\frac{\\hbar}{k_{B}T} \\frac{\\omega_{0} \\prod_{i=1}^{s} \\omega_{i}}{\\prod_{i=1}^{s} \\omega_{i}^{\\ddagger}}\n$$\nNow, substitute this classical-limit ratio into the TST expression for $k(T)$:\n$$\nk(T)_{\\text{cl}} = \\frac{k_{B}T}{h} \\left( \\frac{\\hbar}{k_{B}T} \\frac{\\omega_{0} \\prod_{i=1}^{s} \\omega_{i}}{\\prod_{i=1}^{s} \\omega_{i}^{\\ddagger}} \\right) \\exp\\left(-\\frac{E_{b}}{k_{B}T}\\right)\n$$\nThe terms $k_{B}T$ cancel. We use $\\hbar = h/(2\\pi)$.\n$$\nk(T)_{\\text{cl}} = \\frac{k_{B}T}{h} \\frac{h/(2\\pi)}{k_{B}T} \\left( \\frac{\\omega_{0} \\prod_{i=1}^{s} \\omega_{i}}{\\prod_{i=1}^{s} \\omega_{i}^{\\ddagger}} \\right) \\exp\\left(-\\frac{E_{b}}{k_{B}T}\\right)\n$$\n$$\nk(T)_{\\text{cl}} = \\frac{\\omega_{0}}{2\\pi} \\left( \\prod_{i=1}^{s} \\frac{\\omega_{i}}{\\omega_{i}^{\\ddagger}} \\right) \\exp\\left(-\\frac{E_{b}}{k_{B}T}\\right)\n$$\nThis is the final expression for the rate constant in the classical limit. It is the classical TST rate for a harmonic potential, where $\\omega_{0}/(2\\pi)$ acts as an attempt frequency, the product of frequency ratios is a statistical/entropic factor, and the exponential term is the Arrhenius factor for the barrier energy. The Planck constant $h$ has cancelled out, as expected for a classical result.", "answer": "$$\n\\boxed{\\frac{\\omega_{0}}{2\\pi} \\left( \\prod_{i=1}^{s} \\frac{\\omega_{i}}{\\omega_{i}^{\\ddagger}} \\right) \\exp\\left(-\\frac{E_{b}}{k_{B}T}\\right)}\n$$", "id": "2629270"}, {"introduction": "Beyond formal derivations, a deep understanding of physical concepts often comes from exploring simplified, illustrative models. This thought experiment investigates the very nature of the canonical averaging process by considering a hypothetical microcanonical rate constant, $k(E)$, that exhibits oscillatory behavior [@problem_id:2629261]. By analytically calculating the thermal rate constant $k(T)$, you will see precisely how the Boltzmann weighting function, $\\exp(-\\beta E)$, acts to \"wash out\" or dampen sharp, energy-specific features. This exercise provides a clear and tangible intuition for why macroscopic thermal rates are typically smooth functions of temperature, revealing the powerful smoothing effect of statistical averaging.", "problem": "In Rice–Ramsperger–Kassel–Marcus (RRKM) theory (Rice–Ramsperger–Kassel–Marcus), the microcanonical rate constant $k(E)$ depends on the total energy $E$ and is canonically averaged to obtain a temperature-dependent rate $k(T)$ appropriate for a thermal ensemble. Consider a toy model where oscillatory mode-specific transmission effects produce an energy-dependent modulation of the microcanonical rate. Assume:\n- The microcanonical rate constant is $k(E)=k_{0}\\left[1+a\\cos(\\omega E)\\right]$ for $E \\ge 0$, with $0<a<1$, $k_{0}>0$, and $\\omega>0$.\n- The reactant density of states is described by a classical $s$-mode power law, $\\rho(E)=C\\,E^{s-1}$ for $E \\ge 0$, with $s>0$ and a positive constant $C$ that may be taken as arbitrary.\n- The canonical ensemble average at absolute temperature $T$ is defined by weighting with the Boltzmann factor and the density of states, i.e., using the canonical partition function $Q(\\beta)=\\int_{0}^{\\infty}\\rho(E)\\exp(-\\beta E)\\,\\mathrm{d}E$ with $\\beta=1/(k_{B}T)$, where $k_{B}$ is the Boltzmann constant.\n\nStarting from the canonical ensemble definition of a thermal average and the definition of the Gamma function integral, derive the closed-form analytic expression for the canonically averaged rate constant\n$$\nk(T)=\\frac{\\int_{0}^{\\infty}k(E)\\,\\rho(E)\\,\\exp(-\\beta E)\\,\\mathrm{d}E}{\\int_{0}^{\\infty}\\rho(E)\\,\\exp(-\\beta E)\\,\\mathrm{d}E}\n$$\nin terms of $k_{0}$, $a$, $\\omega$, $s$, $k_{B}$, and $T$. Your derivation must make clear how the oscillatory term is damped by canonical averaging and how this damping depends on $T$.\n\nExpress your final answer as a single closed-form analytic expression. Do not include units in your final expression.", "solution": "The problem states a valid theoretical exercise in chemical kinetics, specifically the canonical averaging of a microcanonical rate constant within the framework of RRKM theory. All provided information is scientifically sound, mathematically consistent, and sufficient for deriving a unique, closed-form solution. I will proceed with the derivation.\n\nThe objective is to compute the canonically averaged rate constant $k(T)$, defined as:\n$$\nk(T)=\\frac{\\int_{0}^{\\infty}k(E)\\,\\rho(E)\\,\\exp(-\\beta E)\\,\\mathrm{d}E}{\\int_{0}^{\\infty}\\rho(E)\\,\\exp(-\\beta E)\\,\\mathrm{d}E}\n$$\nwhere $\\beta = 1/(k_{B}T)$. Let us denote the numerator as $N$ and the denominator as $D$.\n\nFirst, we evaluate the denominator, $D$, which is proportional to the canonical partition function $Q(\\beta)$. We are given the reactant density of states $\\rho(E)=C\\,E^{s-1}$ for $E \\ge 0$.\n$$\nD = \\int_{0}^{\\infty} (C E^{s-1}) \\exp(-\\beta E) \\, \\mathrm{d}E = C \\int_{0}^{\\infty} E^{s-1} \\exp(-\\beta E) \\, \\mathrm{d}E\n$$\nThis integral is a standard form related to the Gamma function, $\\Gamma(z) = \\int_{0}^{\\infty} t^{z-1} e^{-t} \\, \\mathrm{d}t$. We perform a change of variables by letting $t = \\beta E$, which implies $E=t/\\beta$ and $\\mathrm{d}E = \\mathrm{d}t/\\beta$.\n$$\nD = C \\int_{0}^{\\infty} \\left(\\frac{t}{\\beta}\\right)^{s-1} \\exp(-t) \\, \\frac{\\mathrm{d}t}{\\beta} = C \\frac{1}{\\beta^s} \\int_{0}^{\\infty} t^{s-1} \\exp(-t) \\, \\mathrm{d}t\n$$\nThe integral is precisely the definition of $\\Gamma(s)$. Therefore, the denominator is:\n$$\nD = C \\frac{\\Gamma(s)}{\\beta^s}\n$$\n\nNext, we evaluate the numerator, $N$. We are given the microcanonical rate constant $k(E)=k_{0}\\left[1+a\\cos(\\omega E)\\right]$.\n$$\nN = \\int_{0}^{\\infty} k_{0}\\left[1+a\\cos(\\omega E)\\right] (C E^{s-1}) \\exp(-\\beta E) \\, \\mathrm{d}E\n$$\nWe can separate this into two terms:\n$$\nN = k_{0} C \\int_{0}^{\\infty} E^{s-1} \\exp(-\\beta E) \\, \\mathrm{d}E + k_{0} a C \\int_{0}^{\\infty} E^{s-1} \\cos(\\omega E) \\exp(-\\beta E) \\, \\mathrm{d}E\n$$\nThe first term is simply $k_{0}$ times the integral for the denominator $D$.\n$$\n\\text{First term of } N = k_{0} \\left( C \\frac{\\Gamma(s)}{\\beta^s} \\right) = k_0 D\n$$\nThe second term requires evaluation of a more complex integral. To manage the cosine term, we use Euler's formula, $\\cos(\\theta) = \\Re(e^{i\\theta})$, where $\\Re$ denotes the real part.\n$$\n\\int_{0}^{\\infty} E^{s-1} \\cos(\\omega E) \\exp(-\\beta E) \\, \\mathrm{d}E = \\Re \\left[ \\int_{0}^{\\infty} E^{s-1} e^{i\\omega E} \\exp(-\\beta E) \\, \\mathrm{d}E \\right]\n$$\n$$\n= \\Re \\left[ \\int_{0}^{\\infty} E^{s-1} \\exp(-(\\beta - i\\omega)E) \\, \\mathrm{d}E \\right]\n$$\nThis integral has the same form as the one for the denominator, but with a complex argument in the exponent, $z = \\beta - i\\omega$. The integral evaluates to $\\Gamma(s)/z^s$.\n$$\n\\int_{0}^{\\infty} E^{s-1} \\exp(-(\\beta - i\\omega)E) \\, \\mathrm{d}E = \\frac{\\Gamma(s)}{(\\beta - i\\omega)^s}\n$$\nTo find the real part, we express the complex number $\\beta - i\\omega$ in polar form. The modulus is $r = |\\beta - i\\omega| = \\sqrt{\\beta^2 + \\omega^2}$, and the argument is $\\phi = \\arctan(-\\omega/\\beta) = -\\arctan(\\omega/\\beta)$. Let $\\theta = \\arctan(\\omega/\\beta)$.\nSo, $\\beta - i\\omega = r e^{-i\\theta} = \\sqrt{\\beta^2+\\omega^2} \\exp(-i\\theta)$.\nThen, $(\\beta-i\\omega)^{-s} = (r e^{-i\\theta})^{-s} = r^{-s} e^{is\\theta} = (\\beta^2+\\omega^2)^{-s/2} \\left[\\cos(s\\theta) + i\\sin(s\\theta)\\right]$.\nThe real part of $\\Gamma(s)(\\beta-i\\omega)^{-s}$ is thus:\n$$\n\\Re\\left[ \\frac{\\Gamma(s)}{(\\beta-i\\omega)^s} \\right] = \\frac{\\Gamma(s) \\cos(s\\theta)}{(\\beta^2+\\omega^2)^{s/2}} = \\frac{\\Gamma(s) \\cos(s \\arctan(\\omega/\\beta))}{(\\beta^2+\\omega^2)^{s/2}}\n$$\nNow, we assemble the full expression for the numerator $N$:\n$$\nN = k_0 D + k_{0} a C \\left[ \\frac{\\Gamma(s) \\cos(s \\arctan(\\omega/\\beta))}{(\\beta^2+\\omega^2)^{s/2}} \\right]\n$$\nWe can now find the averaged rate constant $k(T)$ by computing the ratio $N/D$:\n$$\nk(T) = \\frac{N}{D} = \\frac{k_0 D}{D} + \\frac{k_{0} a C \\frac{\\Gamma(s) \\cos(s \\arctan(\\omega/\\beta))}{(\\beta^2+\\omega^2)^{s/2}}}{C \\frac{\\Gamma(s)}{\\beta^s}}\n$$\n$$\nk(T) = k_0 + k_0 a \\beta^s \\frac{\\cos(s \\arctan(\\omega/\\beta))}{(\\beta^2+\\omega^2)^{s/2}} = k_0 \\left[ 1 + a \\frac{\\beta^s}{\\beta^s (1+(\\omega/\\beta)^2)^{s/2}} \\cos(s \\arctan(\\omega/\\beta)) \\right]\n$$\n$$\nk(T) = k_0 \\left[ 1 + a \\frac{\\cos(s \\arctan(\\omega/\\beta))}{(1+(\\omega/\\beta)^2)^{s/2}} \\right]\n$$\nFinally, we substitute $\\beta = 1/(k_{B}T)$ to express the result in terms of temperature $T$. The ratio $\\omega/\\beta$ becomes $\\omega k_B T$.\n$$\nk(T) = k_0 \\left[ 1 + a \\frac{\\cos(s \\arctan(\\omega k_B T))}{(1 + (\\omega k_B T)^2)^{s/2}} \\right]\n$$\nThis is the closed-form analytic expression for the canonically averaged rate constant.\n\nThe problem requires an explanation of how the canonical averaging damps the oscillatory term. The original microcanonical rate $k(E)$ has an oscillatory component $a \\cos(\\omega E)$ with a constant amplitude $a$. After canonical averaging, the corresponding term becomes a product of three factors: the intrinsic amplitude $a$, a phase-shifted cosine term $\\cos(s \\arctan(\\omega k_B T))$, and an amplitude damping factor:\n$$\nD(T) = \\frac{1}{\\left(1 + \\left(\\omega k_{B} T\\right)^{2}\\right)^{s/2}}\n$$\nThis damping factor $D(T)$ is strongly dependent on temperature $T$. As $T$ increases, the term $\\omega k_B T$ grows, causing the denominator to increase and the factor $D(T)$ to decrease. For high temperatures ($T \\to \\infty$), $D(T) \\sim (\\omega k_B T)^{-s} \\to 0$. This demonstrates that the thermal averaging process washes out the microcanonical oscillations. The physical reason is that at high temperatures, the Boltzmann distribution $\\exp(-E/k_B T)$ is very broad, so the integral for the average rate samples a wide range of energies $E$. The rapid oscillations of $\\cos(\\omega E)$ are averaged out over this wide range, leading to a suppression of the oscillatory component in $k(T)$. Conversely, as $T \\to 0$, $D(T) \\to 1$, and $\\arctan(\\omega k_B T) \\to 0$, so $k(T) \\to k_0(1+a)$, which equals $k(E=0)$, as expected since the Boltzmann distribution becomes sharply peaked at $E=0$ at zero temperature. The damping effect is more pronounced for a larger number of modes $s$ and a higher oscillation frequency $\\omega$.", "answer": "$$\n\\boxed{k_{0} \\left[ 1 + a \\frac{\\cos\\left(s \\arctan\\left(\\omega k_{B} T\\right)\\right)}{\\left(1 + \\left(\\omega k_{B} T\\right)^{2}\\right)^{s/2}} \\right]}\n$$", "id": "2629261"}, {"introduction": "The ultimate test of a theoretical concept is its application to real-world problems, which are often too complex for analytical solutions and require computational methods. This final practice challenges you to bridge the gap between the formal integral definition of the canonical average and its practical, numerical implementation [@problem_id:2629249]. You will design a robust quadrature scheme to compute the thermal rate constant $k(T)$ from tabulated microcanonical data, tackling essential challenges in scientific computing such as data interpolation, adaptive integration grids, and error control. Mastering this task will equip you with the practical skills needed to calculate reaction rates for complex systems, a common task in modern computational chemistry and materials science.", "problem": "You are asked to design and implement a numerically stable quadrature scheme for canonical averaging in Rice–Ramsperger–Kassel–Marcus (RRKM) theory. The objective is to compute the temperature-dependent canonical rate constant $k(T)$ from tabulated reactant density of states $\\rho_R(E)$ and microcanonical RRKM rate $k(E)$, using the canonical Boltzmann averaging at temperature $T$. The canonical average is defined by\n$$\nk(T) \\equiv \\frac{1}{Q_R(T)} \\int_{0}^{\\infty} \\rho_R(E)\\, e^{-\\beta E}\\, k(E)\\, dE,\n$$\nwhere the reactant partition function in the energy representation is\n$$\nQ_R(T) \\equiv \\int_{0}^{\\infty} \\rho_R(E)\\, e^{-\\beta E}\\, dE,\n$$\nand $\\beta \\equiv 1/(k_{\\mathrm{B}} T)$. Work in reduced units such that $k_{\\mathrm{B}} \\equiv 1$, so that $\\beta \\equiv 1/T$ and energies are measured in the same units as $T$. All integrals are with respect to $E$ in these reduced energy units.\n\nDesign constraints for your quadrature scheme:\n- You must operate on tabulated inputs for $\\rho_R(E)$ and $k(E)$ defined on a finite energy grid $E_0, E_1, \\dots, E_M$ with $E_0 = 0$ and $E_M = E_{\\max}$. You may use interpolation between tabulated points but you may not use closed forms of $\\rho_R(E)$ or $k(E)$ for integration.\n- You must describe and implement:\n  - An energy grid selection strategy to set an effective finite upper limit $E_{\\mathrm{cut}}(T) \\le E_{\\max}$ for your integral, justified by the decay of the Boltzmann factor $e^{-\\beta E}$ and the behavior of $\\rho_R(E)$ and $k(E)$.\n  - An adaptive quadrature rule with a convergence criterion that controls both absolute and relative errors on the integrals for the numerator and denominator. Use the same adaptive grid for both numerator and denominator to minimize cancellation error in the ratio.\n  - A positive, shape-preserving interpolation for tabulated $\\rho_R(E)$ and $k(E)$ that avoids introducing spurious oscillations or negative values.\n\nYour program must compute $k(T)$ for the following test suite. In all test cases, use reduced units with $k_{\\mathrm{B}} \\equiv 1$ and tabulate on a common base energy grid with $M_{\\mathrm{base}} = 121$ uniformly spaced points from $E = 0$ to $E_{\\max} = 60$. The tabulated arrays are generated as follows:\n\n- Common reactant density of states across all cases: for parameters $A = 1$ and $s = 10$, define\n  $$\n  \\rho_R(E) = A\\, E^{s-1} = E^9.\n  $$\n  Tabulate $\\rho_R(E)$ at the $M_{\\mathrm{base}}$ grid points.\n\n- Case $1$ (happy path, thresholded monotone $k(E)$):\n  - Temperature: $T = 1.5$.\n  - Thresholded microcanonical rate:\n    $$\n    k(E) = \n    \\begin{cases}\n    0, & E < E_0,\\\\\n    k_{\\infty}\\left(1 - e^{-(E - E_0)/\\Delta}\\right), & E \\ge E_0,\n    \\end{cases}\n    $$\n    with $E_0 = 5$, $k_{\\infty} = 3$, and $\\Delta = 2$.\n\n- Case $2$ (low-temperature boundary, same $k(E)$ as Case $1$):\n  - Temperature: $T = 0.2$.\n  - Use the same $k(E)$ as in Case $1$.\n\n- Case $3$ (sharply peaked resonance in $k(E)$):\n  - Temperature: $T = 3$.\n  - Resonant microcanonical rate:\n    $$\n    k(E) = k_0 + A_r \\exp\\!\\left(-\\frac{(E - E_r)^2}{2\\sigma^2}\\right),\n    $$\n    with $k_0 = 0.2$, $A_r = 5$, $E_r = 25$, and $\\sigma = 1$.\n\n- Case $4$ (consistency check, constant $k(E)$):\n  - Temperature: $T = 0.8$.\n  - Constant microcanonical rate:\n    $$\n    k(E) = k_c,\n    $$\n    with $k_c = 2.5$.\n\nImplementation requirements and convergence criteria:\n- Interpolation: Use a positive, shape-preserving scheme for both $\\rho_R(E)$ and $k(E)$ (for example, a piecewise monotone cubic Hermite approach).\n- Tail truncation: Choose $E_{\\mathrm{cut}}(T)$ such that the tail contribution beyond $E_{\\mathrm{cut}}(T)$ is negligible compared to a user-chosen tolerance. Your $E_{\\mathrm{cut}}(T)$ must not exceed the tabulated $E_{\\max}$ and should be justified by an inequality that bounds $\\rho_R(E) e^{-\\beta E} k(E)$ on the tail.\n- Quadrature: Use an adaptive composite rule with an error estimator (for example, adaptive Simpson’s rule) that refines subintervals until a stopping rule is met. Control both absolute and relative errors. Use the same subinterval partition for both the numerator integral $\\int \\rho_R(E)e^{-\\beta E}k(E)\\,dE$ and the denominator integral $\\int \\rho_R(E)e^{-\\beta E}\\,dE$. Aggregate a global absolute tolerance $\\varepsilon_{\\mathrm{abs}}$ and relative tolerance $\\varepsilon_{\\mathrm{rel}}$; a typical target is $\\varepsilon_{\\mathrm{abs}} = 10^{-9}$ and $\\varepsilon_{\\mathrm{rel}} = 10^{-7}$.\n- Numerical stability: Ensure the implementation avoids subtractive cancellation and respects positivity of $\\rho_R(E)$ and $k(E)$.\n\nYour program must output the four values $k(T)$ corresponding to Cases $1$ through $4$, in this order. Final output format:\n- Produce a single line containing a Python-style list of the four floating-point results as a comma-separated list enclosed in square brackets, with each value rounded to $8$ significant digits (for example, $[1.2345679,0.31415927,2.0,3.1415927]$). No extra text must be printed.\n\nAngle units do not apply. Physical units are reduced and dimensionless by construction ($k_{\\mathrm{B}} \\equiv 1$). All answers are pure floating-point numbers as specified. The test suite covers a general monotone threshold case, a low-temperature boundary case, a sharply peaked resonance, and a constant-rate consistency check. Your design choices for energy grid selection and convergence must be embedded and justified in your algorithm.", "solution": "The problem presented is a well-posed and scientifically grounded task in computational chemical kinetics. It asks for the numerical computation of the canonical rate constant $k(T)$ from tabulated microcanonical data. This requires a robust numerical quadrature scheme capable of handling functions with large dynamic ranges and potential non-analyticities, while respecting the provided constraints. The problem is valid and admits a rigorous solution.\n\nThe canonical rate constant $k(T)$ is defined as the Boltzmann-weighted average of the microcanonical rate constant $k(E)$ over all possible energies $E$:\n$$\nk(T) \\equiv \\frac{\\int_{0}^{\\infty} \\rho_R(E)\\, k(E)\\, e^{-\\beta E}\\, dE}{\\int_{0}^{\\infty} \\rho_R(E)\\, e^{-\\beta E}\\, dE} = \\frac{\\mathcal{N}(T)}{\\mathcal{D}(T)}\n$$\nwhere $\\rho_R(E)$ is the reactant density of states, $\\beta = 1/T$ in the specified reduced units ($k_B = 1$), $\\mathcal{N}(T)$ is the numerator integral, and $\\mathcal{D}(T)$ is the denominator integral, which is the reactant partition function $Q_R(T)$.\n\nThe core of the solution is a numerical algorithm designed to compute this ratio accurately. The algorithm is constructed from the following fundamental components.\n\n**1. Data Interpolation**\nThe functions $\\rho_R(E)$ and $k(E)$ are supplied as discrete tables. To perform integration, we require their values at arbitrary energy points. A Piecewise Cubic Hermite Interpolating Polynomial (PCHIP) scheme is employed for this purpose. Unlike standard cubic splines, PCHIP preserves the shape of the data, guaranteeing that if the tabulated data is positive and/or monotonic, the interpolant will also be positive and/or monotonic on the respective intervals. This property is crucial for avoiding non-physical artifacts such as negative densities of states or spurious oscillations in the rate constant, which could corrupt the numerical integration. We use the `scipy.interpolate.PchipInterpolator` for this task.\n\n**2. Integration Domain Truncation**\nThe integrals extend formally to $E \\rightarrow \\infty$. For numerical evaluation, we must truncate this to a finite upper limit, $E_{\\mathrm{cut}}(T)$. The integrand's magnitude is largely governed by the term $\\rho_R(E) e^{-E/T} = E^{s-1} e^{-E/T}$ (with $s=10$). The derivative of this term with respect to $E$ is $(s-1)E^{s-2}e^{-E/T} - (1/T)E^{s-1}e^{-E/T}$, which is zero when $(s-1) - E/T = 0$. This gives a peak in the energy distribution at $E_{\\mathrm{peak}} = (s-1)T = 9T$. Well beyond this peak, the Boltzmann factor $e^{-E/T}$ decays exponentially, causing the integrand to become negligible.\n\nWe define a cutoff $E_{\\mathrm{cut}}(T)$ such that the contribution from the tail integral $\\int_{E_{\\mathrm{cut}}}^{\\infty}$ is negligible. A conservative choice is to select $E_{\\mathrm{cut}}(T)$ such that the Boltzmann factor itself is very small, for instance, $e^{-E_{\\mathrm{cut}}(T)/T} \\approx 10^{-18}$. This implies $E_{\\mathrm{cut}}(T)/T \\approx 40$, or $E_{\\mathrm{cut}}(T) \\approx 40T$. The integration range is therefore set to $[0, E_{\\mathrm{upper}}]$, where $E_{\\mathrm{upper}} = \\min(E_{\\max}, 40T)$. This ensures we do not integrate beyond the provided data range ($E_{\\max}=60$) and that we capture the vast majority of the contribution to the integral.\n\n**3. Synchronized Adaptive Quadrature**\nTo compute the integrals accurately and efficiently, especially in the presence of sharp features, an adaptive quadrature method is required. We implement a stack-based adaptive Simpson's rule. For an interval $[a, b]$, the integral is estimated using Simpson's 3-point rule ($S_1$) and a more refined 5-point rule composed of two Simpson's applications on sub-intervals ($S_2$). The difference, $|S_2 - S_1|/15$, provides an error estimate for the refined value $S_2$.\n\nA critical design constraint is to use the same adaptive grid for both the numerator $\\mathcal{N}(T)$ and denominator $\\mathcal{D}(T)$ integrals. This minimizes cancellation errors in their final ratio. Our algorithm achieves this by performing the adaptive refinement for the two integrands in lockstep. An interval is subdivided if the integration error estimate for *either* the numerator *or* the denominator exceeds its respective tolerance for that interval.\n\nThe error tolerance is a hybrid of absolute ($\\varepsilon_{\\mathrm{abs}}$) and relative ($\\varepsilon_{\\mathrm{rel}}$) criteria. For each integral $I$, the total absolute tolerance $T_{\\mathrm{total}}$ is set as $T_{\\mathrm{total}} = \\varepsilon_{\\mathrm{abs}} + \\varepsilon_{\\mathrm{rel}} |I_{\\mathrm{est}}|$, where $I_{\\mathrm{est}}$ is a coarse initial estimate of the integral over the full range. This total tolerance is then distributed across the sub-intervals during the adaptive process.\n\n**4. Handling Non-Analyticity**\nIn Cases 1 and 2, the function $k(E)$ has a continuous value but a discontinuous first derivative at the threshold energy $E_0=5$. Standard quadrature rules assume smooth integrands, and their convergence rate degrades at such points. To maintain high accuracy, we explicitly partition the integration domain at the point of non-analyticity. The integral over $[0, E_{\\mathrm{upper}}]$ is calculated as the sum of integrals over $[0, \\min(E_0, E_{\\mathrm{upper}})]$ and $[\\min(E_0, E_{\\mathrm{upper}}), E_{\\mathrm{upper}}]$. The adaptive integrator is run independently on each segment. This partitioning is applied to both numerator and denominator integrals to preserve the synchronized grid structure.\n\n**5. Verification with a Constant Rate**\nCase 4, where $k(E) = k_c$ is a constant, serves as a crucial consistency check for the entire numerical framework. Analytically, the result must be $k(T) = k_c$. Our PCHIP interpolator on constant data yields a constant function. Because the synchronized adaptive quadrature computes $\\mathcal{N}(T)$ and $\\mathcal{D}(T)$ using identical function evaluations (up to the constant factor $k_c$) on an identical grid, the numerical result is $\\mathcal{N}_{\\mathrm{num}} / \\mathcal{D}_{\\mathrm{num}} = (k_c \\mathcal{D}_{\\mathrm{num}}) / \\mathcal{D}_{\\mathrm{num}} = k_c$, up to machine precision. Success in this case validates the integrity of the interpolation and quadrature implementation.\n\nBy combining these principles—shape-preserving interpolation, a physically justified integration cutoff, and a synchronized adaptive quadrature scheme with explicit handling of discontinuities—we construct a numerically stable and accurate method for calculating the canonical rate constant as required.", "answer": "[0.37050016, 0.0, 0.50529853, 2.5]", "id": "2629249"}]}