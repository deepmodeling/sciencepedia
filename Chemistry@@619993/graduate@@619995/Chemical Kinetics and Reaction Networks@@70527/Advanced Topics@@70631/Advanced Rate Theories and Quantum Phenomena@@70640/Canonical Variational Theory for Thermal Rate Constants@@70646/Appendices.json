{"hands_on_practices": [{"introduction": "This first exercise is a foundational application of the core principle behind Canonical Variational Theory (CVT). By deriving the thermal rate constant for the classic Eckart barrier as a function of the dividing surface location, you will directly apply the variational method to find the \"bottleneck\" that minimizes the calculated rate. This practice is crucial for understanding the baseline scenario where the optimal dividing surface corresponds precisely to the maximum of the potential energy barrier, a result that holds when transverse modes do not couple to the reaction coordinate [@problem_id:2629568].", "problem": "Consider a classical reaction coordinate $x$ of mass $m$ moving on an Eckart barrier $V(x)=\\dfrac{V^{\\ddagger}}{\\cosh^{2}(a x)}$, where $V^{\\ddagger}>0$ and $a>0$ are fixed parameters. To render the reactant partition finite, include a single transverse harmonic mode $y$ of frequency $\\omega$ that is independent of $x$, so that the total Hamiltonian is $H=\\dfrac{p_{x}^{2}}{2m}+V(x)+\\dfrac{p_{y}^{2}}{2m}+\\dfrac{1}{2}m \\omega^{2} y^{2}$. Define the inverse temperature as $\\beta=1/(k_{B} T)$, where $k_{B}$ is the Boltzmann constant and $T$ is the absolute temperature.\n\nUsing only the classical canonical definition of Transition State Theory (TST)—namely, the thermal flux through a chosen dividing surface divided by the reactant canonical population (normalized per unit length along $x$)—derive a closed-form expression for the canonical TST rate constant $k_{\\mathrm{TST}}(x_{0};T)$ when the dividing surface is chosen as the plane $x=x_{0}$. Then, invoking the principle of Canonical Variational Theory (CVT), determine the dividing surface position $x_{0}$ that minimizes $k_{\\mathrm{TST}}(x_{0};T)$ at fixed $T$.\n\nIntroduce the dimensionless coordinate $\\xi=a x$ and denote the dividing surface location by $\\xi_{0}=a x_{0}$. Your task is to:\n- Derive $k_{\\mathrm{TST}}(\\xi_{0};T)$ explicitly as a function of $\\xi_{0}$ and $T$, up to and including all $T$-dependent prefactors that survive the reactant normalization per unit length.\n- Identify the value $\\xi_{0}^{\\ast}$ that minimizes $k_{\\mathrm{TST}}(\\xi_{0};T)$.\n\nReport as your final answer the single quantity $\\xi_{0}^{\\ast}$. Since $\\xi_{0}$ is dimensionless, no units are required. If you perform any numerical approximation, round your final numerical answer to $4$ significant figures; otherwise, provide an exact expression.", "solution": "The problem requires the derivation of the classical canonical Transition State Theory (TST) rate constant, $k_{\\mathrm{TST}}$, for a system with a specified Hamiltonian, and then to find the location of the dividing surface, $\\xi_0$, that minimizes this rate constant according to the principle of Canonical Variational Theory (CVT).\n\nThe total Hamiltonian is given by $H=\\dfrac{p_{x}^{2}}{2m}+V(x)+\\dfrac{p_{y}^{2}}{2m}+\\dfrac{1}{2}m \\omega^{2} y^{2}$. It is separable into a component for the reaction coordinate $x$ and a component for the transverse harmonic mode $y$.\n$H(x,y,p_x,p_y) = H_x(x,p_x) + H_y(y,p_y)$\nwhere $H_x(x,p_x) = \\dfrac{p_{x}^{2}}{2m}+V(x)$ with $V(x)=\\dfrac{V^{\\ddagger}}{\\cosh^{2}(a x)}$, and $H_y(y,p_y) = \\dfrac{p_{y}^{2}}{2m}+\\dfrac{1}{2}m \\omega^{2} y^{2}$.\nThe problem defines the TST rate constant as the ratio of the thermal flux through the dividing surface to the reactant canonical population per unit length.\n\nLet us first derive the expression for $k_{\\mathrm{TST}}(x_{0};T)$. The standard expression for the TST rate constant is given by:\n$$k_{\\mathrm{TST}}(x_0; T) = \\frac{k_B T}{h} \\frac{Q^{\\ddagger}(x_0)}{Q_R}$$\nwhere $Q^{\\ddagger}(x_0)$ is the partition function of the activated complex at the dividing surface $x=x_0$, and $Q_R$ is the partition function of the reactants. The problem specifies a normalization \"per unit length along $x$\" for the reactant population. This implies we should use $Q_R/L$ in the denominator, where $L$ is the length of the system in the $x$ direction.\n\nThe partition function of the activated complex, $Q^{\\ddagger}(x_0)$, is computed for a system constrained to the dividing surface $x=x_0$, with the motion along the reaction coordinate removed from the phase space integral. Due to the separability of the Hamiltonian, the partition function can be written as a product of partition functions for each degree of freedom.\nThe activated complex consists only of the transverse mode $y$, with the potential energy evaluated at $x_0$.\n$$H^{\\ddagger} = V(x_0) + H_y(y,p_y)$$\nThe partition function $Q^{\\ddagger}(x_0)$ is therefore:\n$$Q^{\\ddagger}(x_0) = e^{-\\beta V(x_0)} Q_y$$\nwhere $Q_y$ is the partition function for the transverse harmonic oscillator:\n$$Q_y = \\frac{1}{h} \\int_{-\\infty}^{\\infty} dy \\int_{-\\infty}^{\\infty} dp_y e^{-\\beta H_y(y,p_y)}$$\nSince the frequency $\\omega$ is independent of $x$, $Q_y$ is a constant with respect to $x_0$.\n\nThe reactant partition function, $Q_R$, is calculated in the reactant region, which is defined by $x \\to -\\infty$. In this limit, the potential $V(x) \\to 0$. The Hamiltonian for reactants is $H_R = H_{R,x} + H_y$, where $H_{R,x} = p_x^2/(2m)$.\nFor a system of length $L$ along $x$, the reactant partition function is:\n$$Q_R = Q_{R,x}(L) Q_y$$\nwhere $Q_{R,x}(L)$ is the partition function for a free particle in a one-dimensional box of length $L$:\n$$Q_{R,x}(L) = \\frac{1}{h} \\int_{0}^{L} dx \\int_{-\\infty}^{\\infty} dp_x e^{-\\beta p_x^2 / (2m)}$$\nThe reactant partition function per unit length, $Q_R/L$, is thus:\n$$\\frac{Q_R}{L} = \\frac{Q_{R,x}(L)}{L} Q_y$$\n\nThe TST rate constant is proportional to the ratio of these partition functions. The factor $Q_y$ for the transverse mode appears in both the numerator and the denominator, and thus cancels out. This is a general result for any transverse modes whose properties are independent of the reaction coordinate.\n$$k_{\\mathrm{TST}}(x_0; T) \\propto \\frac{Q^{\\ddagger}(x_0)}{Q_R/L} = \\frac{e^{-\\beta V(x_0)} Q_y}{\\frac{Q_{R,x}(L)}{L} Q_y} = \\frac{e^{-\\beta V(x_0)}}{Q_{R,x}(L)/L}$$\nAll dependencies on $x_0$ are contained within the term $e^{-\\beta V(x_0)}$. The denominator, the reactant partition function per unit length for the $x$-motion, is independent of $x_0$.\nLet's formulate the full expression as prescribed. The rate constant is the thermal flux divided by the reactant population per unit length.\nThe one-way thermal flux $\\Phi(x_0)$ through the surface at $x=x_0$ is:\n$$\\Phi(x_0) = \\frac{1}{h^2} \\int_{0}^{\\infty} \\frac{p_x}{m} dp_x \\int_{-\\infty}^{\\infty} dy \\int_{-\\infty}^{\\infty} dp_y e^{-\\beta H(x_0, y, p_x, p_y)}$$\nThe integrals are separable:\n$$\\Phi(x_0) = e^{-\\beta V(x_0)} \\left( \\frac{1}{h} \\int_{0}^{\\infty} \\frac{p_x}{m} e^{-\\frac{\\beta p_x^2}{2m}} dp_x \\right) \\left( \\frac{1}{h} \\int_{-\\infty}^{\\infty} e^{-\\frac{\\beta p_y^2}{2m}} dp_y \\int_{-\\infty}^{\\infty} e^{-\\frac{1}{2}\\beta m \\omega^2 y^2} dy \\right)$$\nThe integral over $p_x$ yields $1/\\beta$. The term in the second parenthesis is $Q_y$.\n$$\\Phi(x_0) = \\frac{1}{h \\beta} e^{-\\beta V(x_0)} Q_y$$\nThe reactant population per unit length, $\\mathcal{P}_R/L$, in phase space is:\n$$\\frac{\\mathcal{P}_R}{L} = \\frac{1}{h^2} \\int_{-\\infty}^{\\infty} dp_x e^{-\\frac{\\beta p_x^2}{2m}} \\int_{-\\infty}^{\\infty} dy \\int_{-\\infty}^{\\infty} dp_y e^{-\\beta H_y} = \\left(\\frac{1}{h} \\int_{-\\infty}^{\\infty} e^{-\\frac{\\beta p_x^2}{2m}} dp_x \\right) Q_y$$\nThe integral over $p_x$ gives $\\sqrt{2\\pi m / \\beta}$.\n$$\\frac{\\mathcal{P}_R}{L} = \\frac{\\sqrt{2\\pi m / \\beta}}{h} Q_y$$\nThe rate constant is the ratio:\n$$k_{\\mathrm{TST}}(x_0; T) = \\frac{\\Phi(x_0)}{\\mathcal{P}_R/L} = \\frac{\\frac{1}{h \\beta} e^{-\\beta V(x_0)} Q_y}{\\frac{\\sqrt{2\\pi m / \\beta}}{h} Q_y} = \\frac{1}{\\beta \\sqrt{2\\pi m / \\beta}} e^{-\\beta V(x_0)} = \\frac{1}{\\sqrt{2\\pi m \\beta}} e^{-\\beta V(x_0)}$$\nSubstituting $\\beta=1/(k_B T)$:\n$$k_{\\mathrm{TST}}(x_0; T) = \\sqrt{\\frac{k_B T}{2\\pi m}} \\exp(-\\beta V(x_0))$$\nNow, we introduce the dimensionless coordinate $\\xi = ax$, so $x_0 = \\xi_0/a$. The potential is $V(x_0) = V^{\\ddagger} / \\cosh^2(ax_0) = V^{\\ddagger} / \\cosh^2(\\xi_0)$.\nThe expression for the rate constant as a function of the dimensionless dividing surface position $\\xi_0$ is:\n$$k_{\\mathrm{TST}}(\\xi_0; T) = \\sqrt{\\frac{k_B T}{2\\pi m}} \\exp\\left(-\\frac{\\beta V^{\\ddagger}}{\\cosh^2(\\xi_0)}\\right)$$\nThis expression contains all the required dependencies on $\\xi_0$ and $T$.\n\nAccording to Canonical Variational Theory (CVT), the optimal choice for the dividing surface is the one that minimizes the TST rate constant at a fixed temperature $T$. We need to find the value $\\xi_0^{\\ast}$ that minimizes $k_{\\mathrm{TST}}(\\xi_0; T)$.\nTo minimize $k_{\\mathrm{TST}}(\\xi_0; T)$, we must find the extremum by taking the derivative with respect to $\\xi_0$ and setting it to zero.\n$$\\frac{d}{d\\xi_0} k_{\\mathrm{TST}}(\\xi_0; T) = 0$$\nThe prefactor $\\sqrt{k_B T / (2\\pi m)}$ is a positive constant with respect to $\\xi_0$. The exponential function is always positive. Thus, the derivative is zero if and only if the derivative of its argument is zero.\nSo we need to minimize the function $f(\\xi_0)=\\exp\\left(-\\frac{\\beta V^{\\ddagger}}{\\cosh^2(\\xi_0)}\\right)$. This is equivalent to minimizing the argument of the exponential, $-\\beta V^{\\ddagger}/\\cosh^2(\\xi_0)$.\nSince $-\\beta V^{\\ddagger}$ is a negative constant ($V^{\\ddagger}>0$), this is equivalent to maximizing the term $1/\\cosh^2(\\xi_0)$.\nMaximizing $1/\\cosh^2(\\xi_0)$ is equivalent to minimizing $\\cosh^2(\\xi_0)$, which in turn is equivalent to minimizing $\\cosh(\\xi_0)$ because $\\cosh(\\xi_0) \\geq 1$.\nThe function $\\cosh(\\xi_0)$ has a unique global minimum at $\\xi_0=0$.\n\nWe can also find this result by explicit differentiation:\n$$\\frac{d}{d\\xi_0} \\left( -\\frac{\\beta V^{\\ddagger}}{\\cosh^2(\\xi_0)} \\right) = -\\beta V^{\\ddagger} \\frac{d}{d\\xi_0} (\\cosh(\\xi_0))^{-2} = -\\beta V^{\\ddagger} \\left(-2 (\\cosh(\\xi_0))^{-3} \\sinh(\\xi_0)\\right) = \\frac{2\\beta V^{\\ddagger} \\sinh(\\xi_0)}{\\cosh^3(\\xi_0)}$$\nSetting the derivative to zero:\n$$\\frac{2\\beta V^{\\ddagger} \\sinh(\\xi_0)}{\\cosh^3(\\xi_0)} = 0$$\nGiven that $\\beta>0$, $V^{\\ddagger}>0$, and $\\cosh(\\xi_0) \\neq 0$, this equation holds if and only if $\\sinh(\\xi_0) = 0$. The only real solution is $\\xi_0=0$.\n\nTo confirm this is a minimum, we check the second derivative. Let $g(\\xi_0) = k_{\\mathrm{TST}}(\\xi_0; T)$. Then $g'(\\xi_0) = g(\\xi_0) \\cdot \\frac{2\\beta V^{\\ddagger} \\sinh(\\xi_0)}{\\cosh^3(\\xi_0)}$. The second derivative is $g''(\\xi_0) = g'(\\xi_0) \\cdot \\left(\\dots\\right) + g(\\xi_0) \\cdot \\frac{d}{d\\xi_0}\\left(\\frac{2\\beta V^{\\ddagger} \\sinh(\\xi_0)}{\\cosh^3(\\xi_0)}\\right)$.\nAt $\\xi_0=0$, $g'(0)=0$. Thus:\n$$g''(0) = g(0) \\cdot 2\\beta V^{\\ddagger} \\left[ \\frac{\\cosh(\\xi_0)\\cosh^3(\\xi_0) - \\sinh(\\xi_0)\\cdot 3\\cosh^2(\\xi_0)\\sinh(\\xi_0)}{\\cosh^6(\\xi_0)} \\right]_{\\xi_0=0}$$\n$$g''(0) = g(0) \\cdot 2\\beta V^{\\ddagger} \\left[ \\frac{1 \\cdot 1^3 - 0}{1^6} \\right] = 2\\beta V^{\\ddagger} g(0)$$\nSince $g(0) > 0$, $\\beta>0$, and $V^{\\ddagger}>0$, we have $g''(0) > 0$, confirming that $\\xi_0=0$ is a local minimum. As $\\xi_0 \\to \\pm\\infty$, $V(\\xi_0) \\to 0$ and $k_{\\mathrm{TST}}$ approaches its maximum value, so $\\xi_0=0$ is the global minimum.\n\nThe minimizing position $\\xi_0^{\\ast}$ corresponds to the maximum of the potential energy barrier $V(x)$, which is the conventional choice for the dividing surface in TST. The variational correction is zero because the transverse mode frequency $\\omega$ is independent of the reaction coordinate $x$, meaning there are no \"entropic\" effects that would shift the bottleneck away from the potential energy maximum.", "answer": "$$\\boxed{0}$$", "id": "2629568"}, {"introduction": "Building upon the variational principle, this problem explores the profound relationship between the CVT rate, $k_{\\text{CVT}}(T)$, and the exact classical rate, $k_{\\text{exact}}(T)$. You will analyze an idealized model where dynamics are simple, allowing for the analytical derivation of both rates. This exercise provides a concrete proof of the TST upper bound theorem, $k_{\\text{exact}}(T) \\le k_{\\text{CVT}}(T)$, and demonstrates the specific conditions under which this bound is saturated, namely, when the dividing surface perfectly separates reactants and products with no trajectory recrossing [@problem_id:2629639].", "problem": "Consider a classical, one-dimensional Hamiltonian system with Hamiltonian $H(x,p) = \\frac{p^{2}}{2m} + V(x)$ that describes a unimolecular reaction from a reactant basin to products. Assume the following physically realistic and self-consistent model.\n- The reactant basin is a harmonic well of frequency $\\omega_{r}$ with minimum energy set to zero at $x=-x_{0}$, i.e., in the reactant region the potential can be taken as $V_{r}(x) = \\frac{1}{2} m \\omega_{r}^{2} (x + x_{0})^{2}$.\n- There is a single barrier at $x=0$ of height $V^{\\ddagger} = V(0)$, and for $x>0$ the potential $V(x)$ decreases monotonically so that any trajectory that reaches $x>0$ with energy $E>V^{\\ddagger}$ never returns to $x \\le 0$ (no classical recrossing once the barrier is crossed).\n- The exact classical transmission probability is $P_{\\mathrm{cl}}(E) = \\Theta(E - V^{\\ddagger})$, where $\\Theta(\\cdot)$ is the Heaviside step function.\n- The system is prepared in a canonical ensemble at temperature $T$ with Boltzmann constant $k_{B}$.\n\nStarting only from the principles of Hamiltonian mechanics and the classical canonical ensemble, and using phase-space integrals without invoking any prepackaged transition-state formulas, do the following.\n1) Using Canonical Variational Transition State Theory (CVTST), which chooses a dividing surface at position $s$ along the coordinate $x$ to minimize the canonical flux-over-population rate $k[s](T)$, derive a closed-form expression for the optimal $k_{\\mathrm{CVT}}(T)$ in terms of $\\omega_{r}$, $V^{\\ddagger}$, $k_{B}$, and $T$.\n2) Using the given exact classical transmission probability $P_{\\mathrm{cl}}(E)$ and the canonical reactant ensemble, obtain a closed-form expression for the exact classical thermal rate constant $k_{\\mathrm{exact}}(T)$ for this model.\n3) Explain why $k_{\\mathrm{CVT}}(T)$ is an upper bound to $k_{\\mathrm{exact}}(T)$ in general, and verify for this model that the bound is saturated. Define the gap $\\Delta(T) \\equiv k_{\\mathrm{CVT}}(T) - k_{\\mathrm{exact}}(T)$ and give it in closed form.\n\nExpress your final answer as a row matrix containing $k_{\\mathrm{CVT}}(T)$ and $\\Delta(T)$ in symbolic form, with all parameters kept symbolic. Do not include units in your final expressions. For interpretation, the rate constants have units of inverse time (e.g., $\\mathrm{s}^{-1}$).", "solution": "The solution is presented in three parts, as requested.\n\nFirst, we derive the expression for the Canonical Variational Transition State Theory (CVTST) rate constant, $k_{\\mathrm{CVT}}(T)$. The derivation begins from the fundamental definition of the rate constant for a dividing surface at position $s$ along the reaction coordinate $x$. The Transition State Theory (TST) rate constant, $k[s](T)$, is the ratio of the one-way flux of phase points through the dividing surface to the total population of reactants.\n$$k[s](T) = \\frac{\\Phi_+[s]}{Q_r}$$\nHere, $\\Phi_+[s]$ is the forward flux through the surface $x=s$, and $Q_r$ is the canonical partition function of the reactants.\n\nThe forward flux is calculated via a phase-space integral over the Hamiltonian $H(x,p) = \\frac{p^2}{2m} + V(x)$, with $\\beta = (k_B T)^{-1}$:\n$$\\Phi_+[s] = \\int_{-\\infty}^{\\infty} dx \\int_0^{\\infty} dp \\, \\frac{1}{h} \\left(\\frac{p}{m}\\right) \\delta(x-s) \\exp(-\\beta H(x,p))$$\nThe delta function $\\delta(x-s)$ localizes the integral to the dividing surface.\n$$\\Phi_+[s] = \\frac{1}{h} \\exp(-\\beta V(s)) \\int_0^{\\infty} dp \\, \\frac{p}{m} \\exp\\left(-\\frac{\\beta p^2}{2m}\\right)$$\nThe integral over momentum evaluates to:\n$$\\int_0^{\\infty} \\frac{p}{m} \\exp\\left(-\\frac{\\beta p^2}{2m}\\right) dp = \\left[-\\frac{1}{\\beta} \\exp\\left(-\\frac{\\beta p^2}{2m}\\right)\\right]_0^{\\infty} = \\frac{1}{\\beta} = k_B T$$\nThus, the forward flux is:\n$$\\Phi_+[s] = \\frac{k_B T}{h} \\exp(-\\beta V(s))$$\n\nNext, we calculate the reactant partition function, $Q_r$. The reactant potential is given as a harmonic well, $V_r(x) = \\frac{1}{2} m \\omega_r^2 (x+x_0)^2$. In the context of TST, the reactant partition function is typically calculated by integrating over all phase space for the reactant potential well model.\n$$Q_r = \\frac{1}{h} \\int_{-\\infty}^{\\infty} dx \\int_{-\\infty}^{\\infty} dp \\, \\exp(-\\beta H_r(x,p))$$\nwhere $H_r(x,p)$ is the Hamiltonian with the reactant potential $V_r(x)$.\n$$Q_r = \\frac{1}{h} \\left( \\int_{-\\infty}^{\\infty} dp \\, \\exp\\left(-\\frac{\\beta p^2}{2m}\\right) \\right) \\left( \\int_{-\\infty}^{\\infty} dx \\, \\exp\\left(-\\frac{1}{2} \\beta m \\omega_r^2 (x+x_0)^2\\right) \\right)$$\nThese are standard Gaussian integrals. The momentum integral yields $\\sqrt{2\\pi m / \\beta}$. The position integral yields $\\sqrt{2\\pi / (\\beta m \\omega_r^2)}$.\n$$Q_r = \\frac{1}{h} \\sqrt{\\frac{2\\pi m}{\\beta}} \\sqrt{\\frac{2\\pi}{\\beta m \\omega_r^2}} = \\frac{1}{h} \\frac{2\\pi}{\\beta \\omega_r} = \\frac{2\\pi k_B T}{h \\omega_r}$$\n\nNow we assemble the TST rate constant $k[s](T)$:\n$$k[s](T) = \\frac{\\Phi_+[s]}{Q_r} = \\frac{(k_B T / h) \\exp(-\\beta V(s))}{2\\pi k_B T / (h \\omega_r)} = \\frac{\\omega_r}{2\\pi} \\exp(-\\beta V(s))$$\nCVTST requires finding the dividing surface position $s=s^*$ that minimizes this rate constant. This is equivalent to finding the position that maximizes the potential energy $V(s)$. The problem states that the potential has a single maximum at $x=0$, with value $V(0) = V^\\ddagger$. Therefore, the optimal dividing surface is at $s^*=0$.\nThe CVTST rate constant is the rate evaluated at this optimal surface:\n$$k_{\\mathrm{CVT}}(T) = k[s=0](T) = \\frac{\\omega_r}{2\\pi} \\exp(-\\beta V(0)) = \\frac{\\omega_r}{2\\pi} \\exp\\left(-\\frac{V^\\ddagger}{k_B T}\\right)$$\n\nSecond, we obtain the exact classical thermal rate constant, $k_{\\mathrm{exact}}(T)$. The exact rate constant can be expressed as the TST rate evaluated at an optimal dividing surface, multiplied by a transmission coefficient $\\kappa(T)$ that corrects for trajectories recrossing this surface.\n$$k_{\\mathrm{exact}}(T) = \\kappa[s](T) k[s](T)$$\nThe key to this problem lies in the statement: \"any trajectory that reaches $x>0$ with energy $E>V^{\\ddagger}$ never returns\". Let us choose the dividing surface at the top of the barrier, $s=0$. Any trajectory crossing this surface in the forward direction (i.e., with momentum $p>0$) has a total energy $E = \\frac{p^2}{2m} + V(0) = \\frac{p^2}{2m} + V^\\ddagger$. Since $p>0$, it follows that $p^2/(2m) > 0$, and thus $E > V^\\ddagger$. According to the problem statement, such a trajectory is guaranteed to proceed to products ($x>0$) and never return. This signifies that there is no recrossing at the $s=0$ dividing surface.\nTherefore, for the dividing surface at $s=0$, the transmission coefficient is exactly unity: $\\kappa[s=0](T)=1$.\nThe exact classical rate is thus identical to the TST rate evaluated at this specific surface:\n$$k_{\\mathrm{exact}}(T) = k[s=0](T) = \\frac{\\omega_r}{2\\pi} \\exp\\left(-\\frac{V^\\ddagger}{k_B T}\\right)$$\n\nThird, we explain the upper-bound property of CVTST and calculate the gap $\\Delta(T)$.\nIn a general reaction, for any arbitrarily chosen dividing surface $s$, the TST rate $k[s](T)$ assumes that every forward crossing leads to reaction. However, classical trajectories may recross the surface multiple times before settling into either reactants or products. TST improperly counts these recrossing, non-reactive trajectories as reactive events. Consequently, the TST rate provides an upper bound to the true rate: $k_{\\mathrm{exact}}(T) \\le k[s](T)$ for any $s$.\nCVTST is a variational method that seeks the best possible TST rate by finding the dividing surface that minimizes this upper bound: $k_{\\mathrm{CVT}}(T) = \\min_s k[s](T)$. Since $k_{\\mathrm{exact}}(T)$ is a lower bound for $k[s](T)$ at every $s$, it must also be a lower bound for the minimum value. Thus, the fundamental variational principle of TST states that $k_{\\mathrm{exact}}(T) \\le k_{\\mathrm{CVT}}(T)$.\n\nTo verify that the bound is saturated in this model, we compare the expressions derived above:\n$$k_{\\mathrm{CVT}}(T) = \\frac{\\omega_r}{2\\pi} \\exp\\left(-\\frac{V^\\ddagger}{k_B T}\\right)$$\n$$k_{\\mathrm{exact}}(T) = \\frac{\\omega_r}{2\\pi} \\exp\\left(-\\frac{V^\\ddagger}{k_B T}\\right)$$\nThe expressions are identical. This means the bound is saturated, $k_{\\mathrm{CVT}}(T) = k_{\\mathrm{exact}}(T)$, because the CVTST procedure correctly identified the unique dividing surface at $s=0$ where the no-recrossing assumption of TST holds exactly true for this specific model.\n\nFinally, the gap $\\Delta(T)$ is defined as the difference between the CVTST rate and the exact rate:\n$$\\Delta(T) \\equiv k_{\\mathrm{CVT}}(T) - k_{\\mathrm{exact}}(T)$$\nGiven that we have shown these two rates to be equal for this model, the gap is zero.\n$$\\Delta(T) = \\left( \\frac{\\omega_r}{2\\pi} \\exp\\left(-\\frac{V^\\ddagger}{k_B T}\\right) \\right) - \\left( \\frac{\\omega_r}{2\\pi} \\exp\\left(-\\frac{V^\\ddagger}{k_B T}\\right) \\right) = 0$$", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{\\omega_{r}}{2\\pi} \\exp\\left(-\\frac{V^{\\ddagger}}{k_{B} T}\\right) & 0\n\\end{pmatrix}\n}\n$$", "id": "2629639"}, {"introduction": "This final practice bridges the gap between static theory and reaction dynamics by putting the concept of recrossing into a numerical context. You will implement a short-time trajectory simulation to quantify what happens when a non-optimal, \"tilted\" dividing surface is chosen. By calculating the transmission coefficient $\\kappa(T)$, you will gain a tangible understanding of how this factor corrects TST for the dynamic recrossing events that are ignored by its equilibrium assumptions, and see firsthand how the quality of the dividing surface impacts the accuracy of the calculated rate constant [@problem_id:2629554].", "problem": "Consider a two–degree-of-freedom classical Hamiltonian system intended to model a barrier crossing with a flat orthogonal mode, as used in Canonical Variational Theory (CVT) for thermal rate constants. The Hamiltonian is\n$$\nH(x,y,p_x,p_y) \\;=\\; \\frac{p_x^2}{2m} \\;+\\; \\frac{p_y^2}{2m} \\;+\\; V(x,y),\n$$\nwith the separable quadratic saddle potential\n$$\nV(x,y) \\;=\\; E_b \\;-\\; \\frac{1}{2} m \\,\\omega_x^2\\, x^2 \\;+\\; \\frac{1}{2} m \\,\\omega_y^2\\, y^2,\n$$\nwhere $m$ is the mass, $\\omega_x$ is the (real, positive) magnitude of the imaginary frequency along the reaction coordinate $x$ at the saddle, and $\\omega_y$ is the frequency of the orthogonal (bath) mode $y$. The energy offset $E_b$ does not affect the dynamics and may be set to $0$ without loss of generality.\n\nA planar dividing surface is specified by\n$$\ns(x,y) \\;=\\; x \\;-\\; \\alpha\\, y,\n$$\nso that the product region is the half-space $s(x,y) > 0$ and the reactant region is $s(x,y) < 0$. The “tilt” parameter $\\alpha$ controls the orientation of the dividing surface relative to the reaction coordinate. The instantaneous flux across the dividing surface is proportional to $\\dot{s} = \\dot{x} - \\alpha \\dot{y}$.\n\nAdopt classical Hamiltonian dynamics with\n$$\n\\dot{x} = \\frac{p_x}{m}, \\quad \\dot{y} = \\frac{p_y}{m}, \\quad \\dot{p}_x = + m \\omega_x^2 x, \\quad \\dot{p}_y = - m \\omega_y^2 y,\n$$\nwhich implies the analytical solutions\n$$\nx(t) \\;=\\; x_0 \\cosh(\\omega_x t) \\;+\\; \\frac{v_{x,0}}{\\omega_x}\\sinh(\\omega_x t),\\qquad\ny(t) \\;=\\; y_0 \\cos(\\omega_y t) \\;+\\; \\frac{v_{y,0}}{\\omega_y}\\sin(\\omega_y t),\n$$\nwith $v_{x,0} = \\dot{x}(0)$ and $v_{y,0} = \\dot{y}(0)$.\n\nUse a short-time trajectory analysis of the flux-side time correlation form to estimate the transmission coefficient $\\kappa(T)$ (the reduction from transition state theory due to recrossing) at temperature $T$ in reduced units with Boltzmann constant $k_{\\mathrm{B}} = 1$. The flux ensemble at the dividing surface is defined by the canonical density restricted to $s(x,y)=0$ and weighted by the positive normal velocity,\n$$\n\\rho_{\\mathrm{flux}} \\;\\propto\\; \\delta\\!\\big(s(x,y)\\big)\\; \\Theta\\!\\big(\\dot{s}\\big)\\; \\dot{s}\\; \\exp\\!\\big(-\\beta H(x,y,p_x,p_y)\\big),\\quad \\beta = 1/T,\n$$\nwhere $\\Theta(\\cdot)$ is the Heaviside step function and $\\delta(\\cdot)$ is the Dirac delta distribution.\n\nFor a given short observation time $t^\\star > 0$, estimate $\\kappa(T)$ by the flux-weighted fraction of trajectories that, having just crossed from reactants to products with $\\dot{s}>0$ at $t=0$, are found on the product side at time $t^\\star$:\n$$\n\\kappa(T; t^\\star) \\;\\approx\\; \\frac{\\left\\langle \\Theta\\!\\big(s(x(t^\\star),y(t^\\star))\\big)\\; \\right\\rangle_{\\mathrm{flux}}}{\\left\\langle 1 \\right\\rangle_{\\mathrm{flux}}},\n$$\nwhere the averages are over the flux ensemble. This equals the ratio\n$$\n\\kappa(T; t^\\star) \\;=\\; \\frac{\\int \\delta(s)\\,\\Theta(\\dot{s})\\,\\dot{s}\\,e^{-\\beta H}\\,\\Theta\\!\\big(s(t^\\star)\\big)\\,d\\Gamma}{\\int \\delta(s)\\,\\Theta(\\dot{s})\\,\\dot{s}\\,e^{-\\beta H}\\,d\\Gamma},\n$$\nwith $d\\Gamma = dx\\,dy\\,dp_x\\,dp_y$. In practice, estimate this ratio by Monte Carlo sampling from the canonical distribution restricted to $s=0$ and weighting each sample by $\\max(\\dot{s},0)$.\n\nA poor choice of dividing surface (large $\\alpha$) couples the orthogonal mode into the dividing surface, creating large recrossing when the orthogonal mode is relatively flat (small $\\omega_y$). Your task is to implement a program that:\n\n- Samples initial conditions from the canonical distribution at temperature $T$ constrained to $s(x,y)=0$ via the substitution $x = \\alpha y$.\n- Draws velocities $(v_{x,0}, v_{y,0})$ from the Maxwell–Boltzmann distribution at temperature $T$ for mass $m$.\n- Weights each trajectory by $w = \\max(\\dot{s}(0),0) = \\max(v_{x,0} - \\alpha v_{y,0},0)$.\n- Propagates each trajectory analytically to time $t^\\star$ and records the indicator $\\Theta\\!\\big(s(x(t^\\star),y(t^\\star))\\big)$.\n- Estimates $\\kappa(T; t^\\star)$ as the weighted average of that indicator divided by the weighted average of $1$.\n\nTo ensure the stationary canonical measure along the dividing surface, sample $y_0$ from the one-dimensional Gaussian implied by $V(\\alpha y, y)$:\n$$\nV(\\alpha y, y) \\;=\\; -\\frac{1}{2} m \\omega_x^2 (\\alpha y)^2 \\;+\\; \\frac{1}{2} m \\omega_y^2 y^2 \\;=\\; \\frac{1}{2} m \\Omega_{\\mathrm{eff}}^2\\, y^2,\n$$\nwith\n$$\n\\Omega_{\\mathrm{eff}}^2 \\;=\\; \\omega_y^2 \\;-\\; \\alpha^2 \\omega_x^2.\n$$\nYou must restrict to parameters with $\\Omega_{\\mathrm{eff}}^2 > 0$ so that the canonical density on the dividing surface is normalizable. Use $x_0 = \\alpha y_0$.\n\nUse the following test suite of parameter sets, all in reduced, dimensionless units with $k_{\\mathrm{B}} = 1$:\n\n- Test $1$ (good dividing surface, baseline): $m = 1.0$, $T = 1.0$, $\\omega_x = 5.0$, $\\omega_y = 2.0$, $\\alpha = 0.0$, observation time $t^\\star = \\pi / (2\\,\\omega_y)$, number of trajectories $N = 200000$.\n- Test $2$ (poor dividing surface, moderate flatness): $m = 1.0$, $T = 1.0$, $\\omega_x = 5.0$, $\\omega_y = 1.0$, $\\alpha = 0.15$, $t^\\star = \\pi / (2\\,\\omega_y)$, $N = 200000$.\n- Test $3$ (poor dividing surface, flatter orthogonal mode): $m = 1.0$, $T = 1.0$, $\\omega_x = 5.0$, $\\omega_y = 0.8$, $\\alpha = 0.15$, $t^\\star = \\pi / (2\\,\\omega_y)$, $N = 200000$.\n- Test $4$ (poor dividing surface, stiffer orthogonal mode): $m = 1.0$, $T = 1.0$, $\\omega_x = 5.0$, $\\omega_y = 3.0$, $\\alpha = 0.15$, $t^\\star = \\pi / (2\\,\\omega_y)$, $N = 200000$.\n\nImplementation requirements:\n\n- Use a fixed pseudorandom seed equal to $12345$ for reproducibility.\n- Sample $y_0 \\sim \\mathcal{N}\\!\\left(0,\\;\\sigma_y^2\\right)$ with $\\sigma_y^2 = T/(m\\,\\Omega_{\\mathrm{eff}}^2)$, and $v_{x,0}, v_{y,0} \\sim \\mathcal{N}\\!\\left(0,\\;\\sigma_v^2\\right)$ with $\\sigma_v^2 = T/m$.\n- Use the analytical propagation formulas above to evaluate $s(t^\\star) = x(t^\\star) - \\alpha y(t^\\star)$.\n- Return $\\kappa(T; t^\\star)$ for each test as a floating-point number rounded to six digits after the decimal point.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., “[$\\mathtt{result1}$,$\\mathtt{result2}$,$\\mathtt{result3}$,$\\mathtt{result4}$]”). The four entries must be the estimates of $\\kappa(T; t^\\star)$ in the order of the tests $1$ through $4$, each rounded to six decimal places. No additional output should be printed.", "solution": "The objective is to compute the short-time approximation to the transmission coefficient, $\\kappa(T; t^\\star)$, for a classical particle moving on a two-dimensional potential energy surface. This coefficient quantifies the deviation from transition state theory (TST) due to trajectories recrossing the dividing surface. The TST rate constant assumes all trajectories crossing the dividing surface from reactants to products are reactive. In reality, some trajectories recross back to the reactant region, an effect captured by $\\kappa$.\n\nThe transmission coefficient is defined as a ratio of flux-weighted averages over an ensemble of trajectories starting on the dividing surface $s(x,y)=0$ at time $t=0$:\n$$\n\\kappa(T; t^\\star) = \\frac{\\left\\langle \\Theta\\!\\big(s(x(t^\\star),y(t^\\star))\\big)\\; \\right\\rangle_{\\mathrm{flux}}}{\\left\\langle 1 \\right\\rangle_{\\mathrm{flux}}} = \\frac{\\int \\delta(s)\\,\\Theta(\\dot{s})\\,\\dot{s}\\,e^{-\\beta H}\\,\\Theta\\!\\big(s(t^\\star)\\big)\\,d\\Gamma}{\\int \\delta(s)\\,\\Theta(\\dot{s})\\,\\dot{s}\\,e^{-\\beta H}\\,d\\Gamma}\n$$\nHere, $\\Gamma$ represents the full phase space $(x, y, p_x, p_y)$, $\\beta = 1/(k_B T)$ with $k_B=1$, $\\delta(\\cdot)$ is the Dirac delta function, and $\\Theta(\\cdot)$ is the Heaviside step function. The integrand is weighted by the canonical distribution $e^{-\\beta H}$, restricted to the dividing surface $s(x,y)=0$, and further restricted to trajectories initially moving toward the product side ($\\dot{s}>0$) by the factor $\\Theta(\\dot{s})\\,\\dot{s}$. The numerator contains an additional factor $\\Theta(s(t^\\star))$, which is $1$ if the trajectory is on the product side ($s>0$) at time $t^\\star$, and $0$ otherwise.\n\nThis ratio of integrals is estimated using a Monte Carlo importance sampling method. We sample initial conditions from the canonical distribution restricted to the dividing surface, denoted by the probability density $\\rho_{\\mathrm{DS}} \\propto \\delta(s) e^{-\\beta H}$. The remaining part of the flux measure, $\\max(\\dot{s},0)$, is used as an importance weight. The estimate for $\\kappa(T; t^\\star)$ is then:\n$$\n\\kappa(T; t^\\star) \\approx \\frac{\\sum_{i=1}^N \\max(\\dot{s}_i(0), 0) \\cdot \\Theta(s_i(t^\\star))}{\\sum_{i=1}^N \\max(\\dot{s}_i(0), 0)}\n$$\nwhere trajectory initial conditions are sampled as described below.\n\nThe step-by-step procedure for the Monte Carlo simulation is as follows:\n\n1.  **Sampling Initial Positions**. The dividing surface is defined by $s(x,y) = x - \\alpha y = 0$, which implies the constraint $x_0 = \\alpha y_0$. The potential energy on this surface is a function of $y_0$ alone:\n    $$\n    V(x_0, y_0) = V(\\alpha y_0, y_0) = -\\frac{1}{2} m \\omega_x^2 (\\alpha y_0)^2 + \\frac{1}{2} m \\omega_y^2 y_0^2 = \\frac{1}{2} m (\\omega_y^2 - \\alpha^2 \\omega_x^2) y_0^2\n    $$\n    We define the effective frequency squared on the dividing surface as $\\Omega_{\\mathrm{eff}}^2 = \\omega_y^2 - \\alpha^2 \\omega_x^2$. The problem correctly requires $\\Omega_{\\mathrm{eff}}^2 > 0$ for the potential to be confining, which makes the canonical distribution normalizable. The probability density for $y_0$ is proportional to $e^{-\\beta V(\\alpha y_0, y_0)} = \\exp\\left(-\\frac{\\beta m \\Omega_{\\mathrm{eff}}^2}{2} y_0^2\\right)$. This is a Gaussian distribution with mean $0$ and variance $\\sigma_y^2$. By comparing the exponent to that of a standard Gaussian, $-\\frac{y_0^2}{2\\sigma_y^2}$, we find:\n    $$\n    \\sigma_y^2 = \\frac{1}{\\beta m \\Omega_{\\mathrm{eff}}^2} = \\frac{T}{m \\Omega_{\\mathrm{eff}}^2}\n    $$\n    We sample $y_0$ from $\\mathcal{N}(0, \\sigma_y^2)$ and set $x_0 = \\alpha y_0$.\n\n2.  **Sampling Initial Velocities**. The kinetic energy is $K = \\frac{p_x^2}{2m} + \\frac{p_y^2}{2m} = \\frac{1}{2}m(v_x^2 + v_y^2)$. The velocity distribution is given by the Maxwell-Boltzmann distribution, where the probability density is proportional to $e^{-\\beta K}$. This corresponds to two independent Gaussian distributions for $v_{x,0}$ and $v_{y,0}$, each with mean $0$. The variance $\\sigma_v^2$ is found by comparing the exponent $-\\frac{\\beta m v_x^2}{2}$ with $-\\frac{v_x^2}{2\\sigma_v^2}$:\n    $$\n    \\sigma_v^2 = \\frac{1}{\\beta m} = \\frac{T}{m}\n    $$\n    We sample $v_{x,0}$ and $v_{y,0}$ independently from $\\mathcal{N}(0, \\sigma_v^2)$.\n\n3.  **Calculating Trajectory Weights**. The weight for each trajectory $i$ is determined by the initial flux across the dividing surface:\n    $$\n    w_i = \\max(\\dot{s}_i(0), 0) = \\max(v_{x,0}^{(i)} - \\alpha v_{y,0}^{(i)}, 0)\n    $$\n    Trajectories with $\\dot{s}(0) \\le 0$ are given zero weight as they are not crossing towards products.\n\n4.  **Propagating Trajectories**. Each trajectory is propagated from its initial state $(x_0, y_0, v_{x,0}, v_{y,0})$ to the observation time $t^\\star$ using the provided analytical solutions:\n    $$\n    x(t^\\star) = x_0 \\cosh(\\omega_x t^\\star) + \\frac{v_{x,0}}{\\omega_x}\\sinh(\\omega_x t^\\star)\n    $$\n    $$\n    y(t^\\star) = y_0 \\cos(\\omega_y t^\\star) + \\frac{v_{y,0}}{\\omega_y}\\sin(\\omega_y t^\\star)\n    $$\n\n5.  **Evaluating the Indicator Function**. At time $t^\\star$, we determine if the trajectory is on the product side by evaluating the sign of the dividing surface function $s(t^\\star)$:\n    $$\n    s(t^\\star) = x(t^\\star) - \\alpha y(t^\\star)\n    $$\n    The indicator function is $\\Theta(s(t^\\star))$, which is $1$ if $s(t^\\star) > 0$ and $0$ otherwise.\n\n6.  **Computing the Estimate**. Finally, the estimate for the transmission coefficient is the weighted average of the indicator function:\n    $$\n    \\hat{\\kappa}(T; t^\\star) = \\frac{\\sum_{i=1}^N w_i \\cdot \\Theta(s_i(t^\\star))}{\\sum_{i=1}^N w_i}\n    $$\nThe implementation will follow this logic for each set of parameters provided in the test suite. A fixed pseudorandom seed is used to ensure reproducibility of the stochastic simulation.", "answer": "```python\nimport numpy as np\n\ndef calculate_kappa(m, T, wx, wy, alpha, t_star, N, seed):\n    \"\"\"\n    Calculates the transmission coefficient kappa using Monte Carlo sampling.\n    \"\"\"\n    rng = np.random.default_rng(seed)\n\n    # 1. Calculate parameters for sampling distributions\n    # Condition Omega_eff^2 > 0 is checked in problem validation\n    Omega_eff_sq = wy**2 - (alpha * wx)**2\n    sigma_y_sq = T / (m * Omega_eff_sq)\n    sigma_y = np.sqrt(sigma_y_sq)\n    \n    sigma_v_sq = T / m\n    sigma_v = np.sqrt(sigma_v_sq)\n\n    # 2. Sample initial conditions (positions and velocities)\n    # Positions on the dividing surface x = alpha*y\n    y0 = rng.normal(loc=0.0, scale=sigma_y, size=N)\n    x0 = alpha * y0\n    \n    # Velocities from Maxwell-Boltzmann distribution\n    vx0 = rng.normal(loc=0.0, scale=sigma_v, size=N)\n    vy0 = rng.normal(loc=0.0, scale=sigma_v, size=N)\n\n    # 3. Calculate trajectory weights\n    # w = max(s_dot(0), 0) = max(vx0 - alpha*vy0, 0)\n    s_dot_0 = vx0 - alpha * vy0\n    weights = np.maximum(s_dot_0, 0)\n\n    # 4. Propagate trajectories to time t_star\n    cosh_val = np.cosh(wx * t_star)\n    sinh_val_by_w = np.sinh(wx * t_star) / wx\n    cos_val = np.cos(wy * t_star)\n    sin_val_by_w = np.sin(wy * t_star) / wy\n\n    xt_star = x0 * cosh_val + vx0 * sinh_val_by_w\n    yt_star = y0 * cos_val + vy0 * sin_val_by_w\n\n    # 5. Evaluate the indicator function Theta(s(t_star))\n    s_t_star = xt_star - alpha * yt_star\n    indicator = (s_t_star > 0).astype(float)\n\n    # 6. Compute the estimate for kappa\n    numerator = np.sum(weights * indicator)\n    denominator = np.sum(weights)\n\n    if denominator == 0:\n        # This case is unlikely for large N but is a possible outcome\n        return 0.0\n\n    kappa = numerator / denominator\n    return kappa\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print results.\n    \"\"\"\n    test_cases = [\n        # m,    T,   wx,  wy,  alpha, N\n        (1.0, 1.0, 5.0, 2.0, 0.0,  200000), # Test 1\n        (1.0, 1.0, 5.0, 1.0, 0.15, 200000), # Test 2\n        (1.0, 1.0, 5.0, 0.8, 0.15, 200000), # Test 3\n        (1.0, 1.0, 5.0, 3.0, 0.15, 200000), # Test 4\n    ]\n\n    results = []\n    seed = 12345\n\n    for m, T, wx, wy, alpha, N in test_cases:\n        t_star = np.pi / (2.0 * wy)\n        kappa = calculate_kappa(m, T, wx, wy, alpha, t_star, N, seed)\n        # Round to six decimal places as required\n        results.append(f\"{kappa:.6f}\")\n\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "2629554"}]}