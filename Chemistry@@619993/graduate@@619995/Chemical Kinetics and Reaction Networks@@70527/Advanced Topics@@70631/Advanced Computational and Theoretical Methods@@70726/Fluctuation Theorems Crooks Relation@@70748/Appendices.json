{"hands_on_practices": [{"introduction": "The journey to mastering abstract physical principles often begins with a concrete, analytically solvable model. This practice provides such a foundation by examining an Ornstein-Uhlenbeck process, a cornerstone model for a particle in a harmonic potential. You will derive the exact work distribution for an instantaneous change in the potential's stiffness and use it to analytically verify the Crooks fluctuation theorem, building a deep and clear intuition for the relationship between work, free energy, and thermal fluctuations.", "problem": "Consider a single reaction coordinate $x$ evolving as an Ornstein–Uhlenbeck process in a one-dimensional harmonic potential $U(x,t)=\\frac{1}{2}k(t)x^{2}$ at fixed temperature $T$, with dynamics governed by the overdamped Langevin equation $\\gamma\\,\\dot{x}(t)=-k(t)\\,x(t)+\\xi(t)$, where $\\gamma$ is a friction coefficient and $\\xi(t)$ is a Gaussian white noise with $\\langle \\xi(t)\\rangle=0$ and $\\langle \\xi(t)\\xi(t')\\rangle=2\\gamma k_{B}T\\,\\delta(t-t')$, with $k_{B}$ the Boltzmann constant. The system is initially equilibrated in the harmonic well with stiffness $k_{i}>0$ so that $x$ is distributed according to the canonical equilibrium distribution at inverse temperature $\\beta=1/(k_{B}T)$. At time $t=0$, the trap stiffness is instantaneously quenched to $k_{f}>k_{i}$ (a forward protocol). For an instantaneous quench, the stochastic work $W$ performed on the system is equal to the change in potential energy at the instant of the quench, $W=\\Delta U=\\frac{1}{2}\\left(k_{f}-k_{i}\\right)x_{0}^{2}$, where $x_{0}$ is the coordinate just before the quench.\n\nDefine the reverse protocol as the time-reversed procedure that starts from equilibrium in a well of stiffness $k_{f}$ at the same temperature $T$ and instantaneously quenches to $k_{i}$, producing stochastic work $W_{R}=\\frac{1}{2}\\left(k_{i}-k_{f}\\right)x_{0}'^{2}$.\n\nUsing only fundamental definitions from equilibrium statistical mechanics and stochastic energetics, carry out the following steps:\n\n1. Derive the probability density $P_{F}(W)$ for the work $W$ under the forward protocol, expressed in closed analytical form in terms of $W$, $\\beta$, $k_{i}$, and $k_{f}$.\n2. Derive the corresponding density $P_{R}(-W)$ for the negative of the work produced under the reverse protocol.\n3. Compute the equilibrium free energy difference $\\Delta F=F_{f}-F_{i}$ between the harmonic wells with stiffnesses $k_{f}$ and $k_{i}$ from canonical partition functions.\n4. Determine the explicit expression for the ratio $P_{F}(W)/P_{R}(-W)$ and interpret your result in the context of fluctuation relations connecting work and free energy for nonequilibrium processes.\n\nProvide your final answer as the explicit formula for $P_{F}(W)$ as a function of $W$ and the model parameters. No numerical evaluation is required, and no rounding is necessary. Assume $k_{f}>k_{i}$ so that $W\\ge 0$ under the forward quench. Express all results symbolically; do not include units in the final answer.", "solution": "We begin from the canonical equilibrium distribution for a one-dimensional harmonic potential. For stiffness $k>0$ at inverse temperature $\\beta=1/(k_{B}T)$, the equilibrium density of $x$ is\n$$\np_{\\text{eq}}^{(k)}(x)=\\sqrt{\\frac{\\beta k}{2\\pi}}\\exp\\!\\left(-\\frac{1}{2}\\beta k x^{2}\\right).\n$$\nThus, under the forward protocol, $x_{0}$ is Gaussian with mean $0$ and variance $\\sigma_{i}^{2}=\\langle x_{0}^{2}\\rangle=\\frac{1}{\\beta k_{i}}$.\n\nBecause the quench is instantaneous, the stochastic work is defined by the change in the Hamiltonian due to the parameter change at fixed state $x_{0}$:\n$$\nW=\\Delta U=\\frac{1}{2}\\left(k_{f}-k_{i}\\right)x_{0}^{2}.\n$$\nLet $\\Delta k\\equiv k_{f}-k_{i}>0$. Then $W=\\frac{\\Delta k}{2}\\,x_{0}^{2}\\ge 0$. To obtain the distribution of $W$, we need the distribution of $x_{0}^{2}$ for a Gaussian variable. If $X\\sim \\mathcal{N}(0,\\sigma^{2})$, then $Y\\equiv X^{2}$ has density\n$$\nf_{Y}(y)=\\frac{1}{\\sqrt{2\\pi}\\,\\sigma}\\,y^{-1/2}\\exp\\!\\left(-\\frac{y}{2\\sigma^{2}}\\right),\\quad y\\ge 0.\n$$\nIn our case, $\\sigma=\\sigma_{i}=\\sqrt{\\frac{1}{\\beta k_{i}}}$ and $Y=x_{0}^{2}$. With $W=\\frac{\\Delta k}{2}\\,Y$, the change-of-variables formula gives, for $w\\ge 0$,\n$$\nP_{F}(w)=\\frac{1}{a}\\,f_{Y}\\!\\left(\\frac{w}{a}\\right),\\quad a\\equiv \\frac{\\Delta k}{2}.\n$$\nSubstituting the expressions,\n$$\nP_{F}(w)=\\frac{1}{\\sqrt{2\\pi}\\,\\sigma_{i}}\\,a^{-1}\\left(\\frac{w}{a}\\right)^{-1/2}\\exp\\!\\left[-\\frac{1}{2\\sigma_{i}^{2}}\\left(\\frac{w}{a}\\right)\\right].\n$$\nSimplifying,\n$$\nP_{F}(w)=\\frac{1}{\\sqrt{2\\pi}\\,\\sigma_{i}}\\,a^{-1/2}\\,w^{-1/2}\\,\\exp\\!\\left(-\\frac{w}{2a\\sigma_{i}^{2}}\\right).\n$$\nUsing $a=\\frac{\\Delta k}{2}$ and $\\sigma_{i}^{2}=\\frac{1}{\\beta k_{i}}$, we obtain\n$$\nP_{F}(w)=\\frac{1}{\\sqrt{\\pi}\\,\\sigma_{i}\\sqrt{\\Delta k}}\\,w^{-1/2}\\,\\exp\\!\\left(-\\frac{w}{\\Delta k\\,\\sigma_{i}^{2}}\\right)\n=\\sqrt{\\frac{\\beta k_{i}}{\\pi\\,\\Delta k}}\\,w^{-1/2}\\,\\exp\\!\\left(-\\frac{\\beta k_{i}}{\\Delta k}\\,w\\right),\\quad w\\ge 0.\n$$\n\nFor the reverse protocol, $x_{0}'$ is drawn from equilibrium at stiffness $k_{f}$, i.e., a Gaussian with variance $\\sigma_{f}^{2}=\\frac{1}{\\beta k_{f}}$. The reverse work is\n$$\nW_{R}=\\frac{1}{2}(k_{i}-k_{f})\\,x_{0}'^{2}=-\\frac{\\Delta k}{2}\\,x_{0}'^{2}\\le 0,\n$$\nso that $-W_{R}=\\frac{\\Delta k}{2}\\,x_{0}'^{2}\\ge 0$. Repeating the same change-of-variables with $\\sigma_{f}$, we find\n$$\nP_{R}(-w)=\\sqrt{\\frac{\\beta k_{f}}{\\pi\\,\\Delta k}}\\,w^{-1/2}\\,\\exp\\!\\left(-\\frac{\\beta k_{f}}{\\Delta k}\\,w\\right),\\quad w\\ge 0.\n$$\n\nNext, we compute the equilibrium free energy difference between the two harmonic wells from canonical partition functions. The partition function for a one-dimensional harmonic potential $U(x)=\\frac{1}{2}k x^{2}$ is\n$$\nZ(k)=\\int_{-\\infty}^{\\infty}\\mathrm{d}x\\,\\exp\\!\\left(-\\beta \\frac{1}{2}k x^{2}\\right)=\\sqrt{\\frac{2\\pi}{\\beta k}}.\n$$\nTherefore, the Helmholtz free energy $F(k)$ is\n$$\nF(k)=-\\beta^{-1}\\ln Z(k)=-\\beta^{-1}\\left[\\frac{1}{2}\\ln\\!\\left(\\frac{2\\pi}{\\beta k}\\right)\\right],\n$$\nand the free energy difference is\n$$\n\\Delta F\\equiv F_{f}-F_{i}=-\\beta^{-1}\\left[\\frac{1}{2}\\ln\\!\\left(\\frac{2\\pi}{\\beta k_{f}}\\right)-\\frac{1}{2}\\ln\\!\\left(\\frac{2\\pi}{\\beta k_{i}}\\right)\\right]\n=\\frac{1}{2\\beta}\\ln\\!\\left(\\frac{k_{f}}{k_{i}}\\right).\n$$\n\nFinally, we compute the ratio $P_{F}(w)/P_{R}(-w)$:\n$$\n\\frac{P_{F}(w)}{P_{R}(-w)}=\\frac{\\sqrt{\\frac{\\beta k_{i}}{\\pi\\,\\Delta k}}\\,w^{-1/2}\\,\\exp\\!\\left(-\\frac{\\beta k_{i}}{\\Delta k}\\,w\\right)}{\\sqrt{\\frac{\\beta k_{f}}{\\pi\\,\\Delta k}}\\,w^{-1/2}\\,\\exp\\!\\left(-\\frac{\\beta k_{f}}{\\Delta k}\\,w\\right)}\n=\\sqrt{\\frac{k_{i}}{k_{f}}}\\,\\exp\\!\\left(\\frac{\\beta (k_{f}-k_{i})}{\\Delta k}\\,w\\right).\n$$\nSince $\\Delta k=k_{f}-k_{i}$, this simplifies to\n$$\n\\frac{P_{F}(w)}{P_{R}(-w)}=\\sqrt{\\frac{k_{i}}{k_{f}}}\\,\\exp\\!\\left(\\beta w\\right).\n$$\nUsing $\\beta\\Delta F=\\frac{1}{2}\\ln\\!\\left(\\frac{k_{f}}{k_{i}}\\right)$, we can rewrite\n$$\n\\sqrt{\\frac{k_{i}}{k_{f}}}=\\exp\\!\\left(-\\frac{1}{2}\\ln\\!\\frac{k_{f}}{k_{i}}\\right)=\\exp\\!\\left(-\\beta\\Delta F\\right),\n$$\nso\n$$\n\\frac{P_{F}(w)}{P_{R}(-w)}=\\exp\\!\\left[\\beta w-\\beta\\Delta F\\right].\n$$\nThis is precisely the structure predicted by the Crooks fluctuation theorem (CFT), which states that the ratio of the forward work distribution to the reverse work distribution evaluated at the negative work is the exponential of the dissipated work, namely the work minus the equilibrium free energy difference.\n\nTherefore, the forward work distribution for the instantaneous stiffness quench is the closed-form expression\n$$\nP_{F}(w)=\\sqrt{\\frac{\\beta k_{i}}{\\pi\\,\\Delta k}}\\,w^{-1/2}\\,\\exp\\!\\left(-\\frac{\\beta k_{i}}{\\Delta k}\\,w\\right),\\quad w\\ge 0,\\quad \\Delta k=k_{f}-k_{i}>0.\n$$\nThis distribution, together with its reverse counterpart and the computed $\\Delta F$, verifies analytically the Crooks fluctuation theorem for this nonequilibrium protocol in a harmonic reaction coordinate model.", "answer": "$$\\boxed{\\sqrt{\\frac{\\beta k_{i}}{\\pi\\left(k_{f}-k_{i}\\right)}}\\,W^{-1/2}\\,\\exp\\!\\left(-\\frac{\\beta k_{i}}{k_{f}-k_{i}}\\,W\\right)}$$", "id": "2644011"}, {"introduction": "Moving from the elegance of analytical solutions to the power of computational methods is a critical step in modern science. This exercise challenges you to implement a stochastic simulation of a driven two-state system, a fundamental model in chemical kinetics, using an exact sampling algorithm for a time-inhomogeneous process. By generating ensembles of trajectories for forward and reverse protocols, you will numerically compute work distributions and test the validity of the Crooks relation against the statistical noise inherent in computational experiments.", "problem": "Consider a two-state chemical reaction network (CRN) consisting of species $A$ and $B$ connected by a single reversible reaction $A \\rightleftharpoons B$. The system is modeled as a continuous-time Markov jump process (CTMC). The energy of state $A$ is $E_A(t) \\equiv 0$, and the energy of state $B$ is $E_B(t) \\equiv \\Delta E(t)$, where the externally controlled energy difference $\\Delta E(t)$ is varied according to a prescribed protocol over a finite time interval $t \\in [0, \\tau]$. The inverse thermal energy is denoted by $\\beta \\equiv 1/(k_\\mathrm{B} T)$, where $k_\\mathrm{B}$ is the Boltzmann constant and $T$ is the temperature. Throughout, use dimensionless units in which energies are measured in $k_\\mathrm{B} T$ units and time in units of $1/k_0$ as specified below; no physical unit conversion is required.\n\nAssume local detailed balance holds at all times: the instantaneous transition rates $k_{A \\to B}(t)$ and $k_{B \\to A}(t)$ satisfy\n$$\n\\frac{k_{A \\to B}(t)}{k_{B \\to A}(t)} \\;=\\; e^{-\\beta \\, \\Delta E(t)} \\, .\n$$\nFix the symmetric Arrhenius-like parametrization\n$$\nk_{A \\to B}(t) \\equiv k_0 \\, e^{-\\frac{\\beta}{2} \\Delta E(t)} \\quad \\text{and} \\quad\nk_{B \\to A}(t) \\equiv k_0 \\, e^{+\\frac{\\beta}{2} \\Delta E(t)} \\, ,\n$$\nwith $k_0 > 0$ a constant rate scale.\n\nFor a given trajectory $x(t) \\in \\{A,B\\}$ under a time-dependent protocol $\\Delta E(t)$ over $t \\in [0,\\tau]$, define the stochastic work performed by the protocol as the Riemann–Stieltjes integral\n$$\nW[x(\\cdot)] \\;=\\; \\int_{0}^{\\tau} \\mathbf{1}_{\\{x(t)=B\\}} \\, d\\Delta E(t) \\, ,\n$$\nwhere $\\mathbf{1}_{\\{x(t)=B\\}}$ is the indicator that the system occupies state $B$ at time $t$. The equilibrium free energy at parameter value $\\Delta E$ is\n$$\nF(\\Delta E) \\;=\\; -\\frac{1}{\\beta} \\ln\\!\\big( 1 + e^{-\\beta \\Delta E} \\big) \\, ,\n$$\nand the free energy difference across a protocol from $\\Delta E(0)=\\Delta E_i$ to $\\Delta E(\\tau)=\\Delta E_f$ is $\\Delta F \\equiv F(\\Delta E_f) - F(\\Delta E_i)$.\n\nYou will numerically test the Crooks fluctuation theorem for work, which states that for a forward protocol $\\Delta E_F(t)$ and its time-reversed reverse protocol $\\Delta E_R(t) \\equiv \\Delta E_F(\\tau - t)$ (with initial ensembles drawn from the corresponding equilibria at $\\Delta E_i$ and $\\Delta E_f$, respectively), the distributions of work $P_F(W)$ and $P_R(W)$ satisfy\n$$\n\\frac{P_F(W)}{P_R(-W)} \\;=\\; e^{\\beta \\, (W - \\Delta F)} \\, .\n$$\n\nImplement a program that:\n- Simulates an ensemble of independent trajectories for both the forward and reverse protocols using exact sampling of the time-inhomogeneous jump process. For the forward protocol, use a linear ramp\n$$\n\\Delta E_F(t) \\;=\\; \\Delta E_i + \\frac{\\Delta E_f - \\Delta E_i}{\\tau} \\, t \\, ,\n$$\nand for the reverse protocol, use the time-reversed linear ramp\n$$\n\\Delta E_R(t) \\;=\\; \\Delta E_f - \\frac{\\Delta E_f - \\Delta E_i}{\\tau} \\, t \\, .\n$$\n- Draw the initial state for each trajectory from the canonical equilibrium at the protocol’s starting parameter value. That is, at parameter $\\Delta E$, the equilibrium probabilities are $p_A^{\\mathrm{eq}}(\\Delta E) = \\frac{1}{1+e^{-\\beta \\Delta E}}$ and $p_B^{\\mathrm{eq}}(\\Delta E) = \\frac{e^{-\\beta \\Delta E}}{1+e^{-\\beta \\Delta E}}$.\n- Computes the work $W$ along each trajectory using the above integral definition.\n- Estimates the work distributions $P_F(W)$ and $P_R(W)$ by histograms with a fixed number of bins $n_b$ over a common range that covers both the forward work samples and the sign-flipped reverse work samples. Use $n_b = 60$. Construct the common range from the minimum and maximum of the combined data $\\{W_F\\} \\cup \\{-W_R\\}$. If this range has negligible width (e.g., all sampled works numerically coincide), expand it to a small symmetric interval around zero to avoid degenerate histograms.\n- Compares the empirical log-ratio $\\ln\\!\\big( P_F(W) / P_R(-W) \\big)$ against the theoretical prediction $\\beta (W - \\Delta F)$ only on bins where both histograms are strictly positive, and reports whether the maximum absolute deviation over those bins is below a prescribed tolerance $\\varepsilon$.\n\nUse a fixed random seed for reproducibility. Set the seed to $12345$.\n\nYour program must implement the exact sampling of event times for this driven two-state process. For the linear protocol above, the total exit rate from each state is an exponential function of time, which permits exact inversion of the inhomogeneous waiting-time distribution. You must not assume any time-discretization approximation.\n\nTest Suite:\nSimulate the following three cases, and for each return a boolean indicating whether the Crooks relation holds within the specified tolerance. Use the same histogram settings $(n_b = 60)$ and the same deviation tolerance $\\varepsilon = 0.35$ for all cases.\n\n- Case $1$ (happy path, moderate speed):\n  - $\\beta = 1.0$, $k_0 = 1.0$, $\\Delta E_i = 0.0$, $\\Delta E_f = 4.0$, $\\tau = 8.0$, number of trajectories $N = 20000$ for both forward and reverse.\n\n- Case $2$ (fast driving):\n  - $\\beta = 1.0$, $k_0 = 1.0$, $\\Delta E_i = 0.0$, $\\Delta E_f = 4.0$, $\\tau = 0.5$, number of trajectories $N = 20000$ for both forward and reverse.\n\n- Case $3$ (boundary case, no change in parameter):\n  - $\\beta = 1.0$, $k_0 = 1.0$, $\\Delta E_i = 1.0$, $\\Delta E_f = 1.0$, $\\tau = 3.0$, number of trajectories $N = 20000$ for both forward and reverse.\n\nAnswer Specification:\n- For each case, compute a boolean indicating whether the maximum absolute deviation\n$$\n\\max_{\\text{overlapping bins}} \\left| \\ln\\!\\frac{P_F(W)}{P_R(-W)} - \\beta \\, (W - \\Delta F) \\right|\n$$\ndoes not exceed $\\varepsilon = 0.35$. If there are no overlapping bins with strictly positive densities, return the boolean value $False$ for that case.\n- The final output must be a single line containing the three boolean results as a comma-separated list enclosed in square brackets (e.g., \"[True,False,True]\").\n\nYour program must be complete and runnable as is, must not require any input, and must adhere to the seed, histogram, and tolerance specifications given above. All quantities are to be reported in the specified dimensionless units; no physical units are required.", "solution": "A two-state system undergoes the reaction $A \\rightleftharpoons B$. The energies are $E_A = 0$ and $E_B = \\Delta E(t)$. The transition rates are given by the symmetric parametrization:\n$$\nk_{A \\to B}(t) = k_0 \\, e^{-\\frac{\\beta}{2} \\Delta E(t)} \\quad \\text{and} \\quad\nk_{B \\to A}(t) = k_0 \\, e^{+\\frac{\\beta}{2} \\Delta E(t)}\n$$\nThese rates satisfy the local detailed balance condition $\\frac{k_{A \\to B}(t)}{k_{B \\to A}(t)} = e^{-\\beta \\Delta E(t)}$. The external parameter $\\Delta E(t)$ is driven linearly in time, $\\Delta E(t) = \\Delta E_{start} + v t$, where the velocity $v = (\\Delta E_{end} - \\Delta E_{start}) / \\tau$.\n\nThe core of the simulation is the generation of jump times for this time-inhomogeneous process. If the system is in a state $X$ at time $t_0$, the probability of surviving until time $t$ without a jump is $P(t) = \\exp\\left(-\\int_{t_0}^t k_{exit}(s) ds\\right)$, where $k_{exit}(s)$ is the exit rate from state $X$ at time $s$. The next jump time $t_{jump}$ can be sampled by solving for $t_{jump}$ in the equation $\\int_{t_0}^{t_{jump}} k_{exit}(s) ds = R$, where $R$ is a random variate drawn from an exponential distribution with rate $1$.\n\nFor the given linear protocol, the exit rates take the form $k_{exit}(t) = C e^{\\alpha t}$, where the constants $C$ and $\\alpha$ depend on the state.\nIf the state is $A$, the exit rate is $k_{A \\to B}(t)$. Then:\n$$\n\\alpha_A = -\\frac{\\beta v}{2} \\quad \\text{and} \\quad C_A = k_0 \\, e^{-\\frac{\\beta}{2} \\Delta E_{start}}\n$$\nIf the state is $B$, the exit rate is $k_{B \\to A}(t)$. Then:\n$$\n\\alpha_B = +\\frac{\\beta v}{2} \\quad \\text{and} \\quad C_B = k_0 \\, e^{+\\frac{\\beta}{2} \\Delta E_{start}}\n$$\nFor the non-trivial case $v \\neq 0$, and thus $\\alpha \\neq 0$, the integral is analytically tractable:\n$$\n\\int_{t_0}^{t_0 + \\Delta t} C e^{\\alpha s} ds \\;=\\; \\frac{C}{\\alpha} \\left[ e^{\\alpha(t_0+\\Delta t)} - e^{\\alpha t_0} \\right] \\;=\\; \\frac{C e^{\\alpha t_0}}{\\alpha} \\left( e^{\\alpha \\Delta t} - 1 \\right) \\;=\\; \\frac{k_{exit}(t_0)}{\\alpha} \\left( e^{\\alpha \\Delta t} - 1 \\right)\n$$\nSetting this equal to $R$ and solving for the waiting time $\\Delta t$ yields:\n$$\n\\Delta t = \\frac{1}{\\alpha} \\ln\\left(1 + \\frac{\\alpha R}{k_{exit}(t_0)}\\right)\n$$\nThis formula is valid if the argument of the logarithm is positive. If $1 + \\frac{\\alpha R}{k_{exit}(t_0)} \\le 0$, which can only occur if $\\alpha < 0$, it implies that the total integrated rate from $t_0$ to infinity converges to a value less than $R$, meaning no jump will occur. In this case, we set $\\Delta t = \\infty$. This method provides an exact sample of the waiting time. For the special case $v=0$ (and thus $\\alpha=0$), the rates are constant, and the waiting time is simply $\\Delta t = R / k_{exit}$.\n\nThe stochastic work for a linear protocol $\\Delta E(t)$ simplifies significantly. The Riemann-Stieltjes integral is:\n$$\nW = \\int_{0}^{\\tau} \\mathbf{1}_{\\{x(t)=B\\}} \\, d\\Delta E(t) = \\int_{0}^{\\tau} \\mathbf{1}_{\\{x(t)=B\\}} \\frac{d\\Delta E}{dt} dt = v \\int_{0}^{\\tau} \\mathbf{1}_{\\{x(t)=B\\}} dt\n$$\nThe work is thus the product of the protocol velocity $v$ and the total time the system spends in state $B$. This simplifies the calculation to summing the durations of all intervals where the system is in state $B$.\n\nThe verification of the Crooks relation, $\\frac{P_F(W)}{P_R(-W)} = e^{\\beta (W - \\Delta F)}$, is performed numerically. Ensembles of trajectories are generated for both the forward protocol ($\\Delta E_i \\to \\Delta E_f$) and the reverse protocol ($\\Delta E_f \\to \\Delta E_i$), starting from their respective initial equilibrium distributions. Work values $W_F$ and $W_R$ are computed for each trajectory.\n\nThe probability distributions $P_F(W)$ and $P_R(W)$ are estimated using histograms. A common set of bins is constructed over the range of the combined data $\\{W_F\\} \\cup \\{-W_R\\}$. The histogram for the reverse process is computed for the sign-flipped work values, $-W_R$. The normalized histograms provide empirical estimates for $P_F(W)$ and $P_R(-W)$ at the bin centers $W_k$.\n\nThe free energy difference is calculated as $\\Delta F = F(\\Delta E_f) - F(\\Delta E_i)$, with the free energy given by $F(\\Delta E) = -\\frac{1}{\\beta} \\ln(1 + e^{-\\beta \\Delta E})$. For each bin $k$ where both $P_F(W_k)$ and $P_R(-W_k)$ are strictly positive, the deviation is computed:\n$$\nd_k = \\left| \\ln\\left(\\frac{P_F(W_k)}{P_R(-W_k)}\\right) - \\beta (W_k - \\Delta F) \\right|\n$$\nThe maximum of these deviations, $\\max_k d_k$, is compared against the tolerance $\\varepsilon=0.35$. If this maximum deviation is within the tolerance, the theorem is considered numerically verified for that case. If no bins show overlap between the two distributions, the verification fails.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite for the Crooks fluctuation theorem.\n    \"\"\"\n    # Fixed parameters for all test cases\n    N_TRAJECTORIES = 20000\n    N_BINS = 60\n    TOLERANCE = 0.35\n    RANDOM_SEED = 12345\n\n    # Test suite from the problem statement\n    test_cases = [\n        # Case 1 (happy path, moderate speed)\n        {'beta': 1.0, 'k0': 1.0, 'delta_E_i': 0.0, 'delta_E_f': 4.0, 'tau': 8.0},\n        # Case 2 (fast driving)\n        {'beta': 1.0, 'k0': 1.0, 'delta_E_i': 0.0, 'delta_E_f': 4.0, 'tau': 0.5},\n        # Case 3 (boundary case, no change in parameter)\n        {'beta': 1.0, 'k0': 1.0, 'delta_E_i': 1.0, 'delta_E_f': 1.0, 'tau': 3.0},\n    ]\n\n    rng = np.random.default_rng(RANDOM_SEED)\n    results = []\n\n    for case in test_cases:\n        # Run forward and reverse simulations\n        W_F = _simulate_protocol(params=case, is_forward=True, n_traj=N_TRAJECTORIES, rng=rng)\n        W_R = _simulate_protocol(params=case, is_forward=False, n_traj=N_TRAJECTORIES, rng=rng)\n\n        # Prepare data for histogramming\n        neg_W_R = -np.array(W_R)\n        \n        # Determine common histogram range\n        combined_works = np.concatenate((W_F, neg_W_R))\n        w_min, w_max = combined_works.min(), combined_works.max()\n        \n        if w_max - w_min < 1e-9:\n             w_min, w_max = -1.0, 1.0\n        else: # Add padding to avoid issues at edges\n            padding = 0.01 * (w_max-w_min) if (w_max-w_min) > 0 else 0.1\n            w_min -= padding\n            w_max += padding\n\n        bins = np.linspace(w_min, w_max, N_BINS + 1)\n        bin_centers = (bins[:-1] + bins[1:]) / 2.0\n\n        # Create normalized histograms (probability densities)\n        P_F, _ = np.histogram(W_F, bins=bins, density=True)\n        P_R_neg, _ = np.histogram(neg_W_R, bins=bins, density=True)\n\n        # Calculate free energy difference\n        beta = case['beta']\n        delta_E_i = case['delta_E_i']\n        delta_E_f = case['delta_E_f']\n        \n        def free_energy(E, b):\n            return -1.0 / b * np.log(1.0 + np.exp(-b * E))\n            \n        delta_F = free_energy(delta_E_f, beta) - free_energy(delta_E_i, beta)\n\n        # Check Crooks relation\n        max_deviation = 0.0\n        found_overlap = False\n        \n        for i in range(N_BINS):\n            if P_F[i] > 0 and P_R_neg[i] > 0:\n                found_overlap = True\n                W_k = bin_centers[i]\n                \n                log_ratio_empirical = np.log(P_F[i] / P_R_neg[i])\n                log_ratio_theoretical = beta * (W_k - delta_F)\n                \n                deviation = np.abs(log_ratio_empirical - log_ratio_theoretical)\n                if deviation > max_deviation:\n                    max_deviation = deviation\n        \n        if not found_overlap:\n            results.append(False)\n        else:\n            results.append(max_deviation <= TOLERANCE)\n\n    print(f\"[{','.join(map(str, results))}]\")\n\n\ndef _simulate_protocol(params, is_forward, n_traj, rng):\n    \"\"\"\n    Simulates trajectories for a given protocol (forward or reverse).\n    \"\"\"\n    beta, k0, tau = params['beta'], params['k0'], params['tau']\n\n    if is_forward:\n        E_start, E_end = params['delta_E_i'], params['delta_E_f']\n    else: # Reverse protocol\n        E_start, E_end = params['delta_E_f'], params['delta_E_i']\n\n    v = (E_end - E_start) / tau if tau > 0 else 0.0\n\n    work_values = []\n    \n    for _ in range(n_traj):\n        # Initialize state from equilibrium at E_start\n        p_B_eq = np.exp(-beta * E_start) / (1.0 + np.exp(-beta * E_start))\n        state = 1 if rng.random() < p_B_eq else 0  # 0 for A, 1 for B\n        \n        current_time = 0.0\n        time_in_B = 0.0\n\n        while current_time < tau:\n            t_prev = current_time\n            \n            # Sample waiting time dt for the next jump\n            if v == 0: # Homogeneous process\n                rate_A_to_B = k0 * np.exp(-beta * E_start / 2.0)\n                rate_B_to_A = k0 * np.exp(beta * E_start / 2.0)\n                rate = rate_A_to_B if state == 0 else rate_B_to_A\n                dt = rng.exponential(1.0 / rate) if rate > 0 else np.inf\n            else: # Inhomogeneous process\n                R = rng.exponential(1.0)\n                if state == 0: # From A\n                    alpha = -beta * v / 2.0\n                    C = k0 * np.exp(-beta * E_start / 2.0)\n                else: # From B\n                    alpha = beta * v / 2.0\n                    C = k0 * np.exp(beta * E_start / 2.0)\n                \n                rate_at_t = C * np.exp(alpha * current_time)\n                \n                arg = 1.0 + alpha * R / rate_at_t\n                if arg > 0:\n                    dt = (1.0 / alpha) * np.log1p(alpha * R / rate_at_t)\n                else:\n                    dt = np.inf\n\n            t_jump = current_time + dt\n            t_final_interval = min(t_jump, tau)\n\n            if state == 1: # If in state B\n                time_in_B += t_final_interval - t_prev\n            \n            if t_jump < tau:\n                current_time = t_jump\n                state = 1 - state # Flip state\n            else:\n                current_time = tau # End of trajectory\n        \n        work = v * time_in_B\n        work_values.append(work)\n        \n    return work_values\n\nsolve()\n```", "id": "2644035"}, {"introduction": "The true test of understanding a physical theorem lies in the ability to interpret real-world data and diagnose deviations from ideal behavior. This practice moves beyond simple verification to develop your critical thinking skills by exploring how the predictions of the Crooks relation are affected by practical complications. You will analyze how issues such as model coarse-graining, non-isothermal conditions, or flawed experimental protocols manifest in the relationship between work distributions, honing your ability to apply fluctuation theorems with scientific rigor.", "problem": "A single-enzyme reaction network is modeled as a continuous-time Markov chain (CTMC) weakly coupled to a heat bath at fixed temperature $T$, with inverse temperature $\\beta \\equiv 1/(k_{\\mathrm{B}}T)$, where $k_{\\mathrm{B}}$ is the Boltzmann constant. An external chemostatted protocol $t \\mapsto \\lambda_t$ drives the system from $t=0$ to $t=\\tau$, changing the chemical potentials that couple to the network and thereby performing chemical work on individual stochastic trajectories. The forward experiment prepares the system in the equilibrium distribution corresponding to $\\lambda_0$ at $t=0$, then applies the protocol $\\{\\lambda_t\\}_{t\\in[0,\\tau]}$ and measures the stochastic work $W$. The reverse experiment prepares the system in the equilibrium distribution corresponding to $\\lambda_\\tau$ at $t=0$, then applies the time-reversed protocol $\\{\\tilde{\\lambda}_t\\}_{t\\in[0,\\tau]}$ and measures the stochastic work $W$; its distribution is reported as $P_R(W)$. The forward work distribution is $P_F(W)$. The unknown equilibrium free energy difference between the ensembles at $\\lambda_0$ and $\\lambda_\\tau$ is denoted by $\\Delta F$.\n\nBeyond using the crossing point of $P_F(W)$ and $P_R(-W)$ to estimate $\\Delta F$, an experimentalist proposes the following diagnostics and interpretations based on plotting the log-likelihood ratio versus work, namely the function $L(W) \\equiv \\ln\\!\\big[P_F(W)/P_R(-W)\\big]$ plotted against $W$.\n\nWhich of the following statements are valid under the stated assumptions, and which are not? Select all that apply.\n\nA. If the $L(W)$ versus $W$ plot is linear with slope equal to the independently known inverse temperature $\\beta$, then this supports microscopic reversibility of the dynamics and a correct definition of the stochastic work; the intercept encodes $\\Delta F$.\n\nB. Persistent curvature of $L(W)$ versus $W$ that diminishes when previously lumped fast intermediates are explicitly resolved is consistent with coarse-graining–induced hidden entropy production; in such cases, even if the crossing point $W_{\\times}$ of $P_F(W)$ and $P_R(-W)$ yields a good practical estimate of $\\Delta F$, the slope of $L(W)$ need not match $\\beta$.\n\nC. If the best-fit slope of $L(W)$ is systematically larger than $\\beta$ by about $10\\%$ while the intercept from the same fit agrees with an independent $\\Delta F$ within errors, the most likely cause is insufficient sample size; with more samples, the curvature would persist but the slope bias would vanish.\n\nD. If the reverse experiment is performed by starting from the nonequilibrium final distribution of the forward experiment rather than the equilibrium distribution at $\\lambda_\\tau$, then the $L(W)$ versus $W$ plot remains linear with the same slope as in the ideal case but is shifted vertically by a constant offset.\n\nE. If the bath temperature drifts during the protocol in a way that is not accounted for (so the environment is nonisothermal), then the $L(W)$ versus $W$ plot can appear locally linear with an effective slope that varies with $W$; a global best-fit slope reflects a weighted average of the instantaneous inverse temperature over the support of $W$.\n\nF. Replacing the abscissa by the stochastic heat $Q$ while retaining the same forward and reverse histograms $P_F$ and $P_R$ is still expected to produce a strictly linear $L(Q) \\equiv \\ln\\!\\big[P_F(Q)/P_R(-Q)\\big]$ versus $Q$ with slope $\\beta$; therefore any observed curvature in $L(Q)$ indicates experimental error rather than theoretical limitation.\n\nG. A residual plot of $L(W)$ after subtracting its best-fit straight line versus $W$ should show no systematic structure if the underlying assumptions hold; if deviations from linearity are due to moderate sampling noise rather than a breakdown of the hypotheses, then a Bennett acceptance ratio (BAR) analysis can still yield an essentially unbiased estimate of $\\Delta F$ with smaller uncertainty than the raw crossing point.", "solution": "**Derivation of the Solution**\n\nThe fundamental principle governing this system is the Crooks fluctuation theorem. For a process satisfying the stated assumptions (microscopic reversibility for the CTMC, initial equilibrium distributions, and a proper definition of work), the theorem states:\n$$ \\frac{P_F(W)}{P_R(-W)} = e^{\\beta(W - \\Delta F)} $$\nwhere $\\Delta F = F(\\lambda_\\tau) - F(\\lambda_0)$ is the equilibrium free energy difference.\n\nTaking the natural logarithm of both sides gives the function defined in the problem:\n$$ L(W) \\equiv \\ln\\left(\\frac{P_F(W)}{P_R(-W)}\\right) = \\beta(W - \\Delta F) = \\beta W - \\beta \\Delta F $$\nThis equation predicts that a plot of $L(W)$ as a function of $W$ must be a straight line. The slope of this line is the inverse temperature $\\beta$, and its y-intercept is $-\\beta \\Delta F$. The x-intercept, where $L(W)=0$, occurs at $W = \\Delta F$. We now evaluate each statement based on this theoretical prediction and its underlying assumptions.\n\n**Option-by-Option Analysis**\n\n**A. If the $L(W)$ versus $W$ plot is linear with slope equal to the independently known inverse temperature $\\beta$, then this supports microscopic reversibility of the dynamics and a correct definition of the stochastic work; the intercept encodes $\\Delta F$.**\n**Analysis:** The linearity of the $L(W)$ versus $W$ plot with a slope of $\\beta$ is a direct and stringent test of the Crooks theorem. The theorem's validity, in turn, hinges upon several key assumptions: the system's dynamics obey microscopic reversibility (or local detailed balance), the definitions of the forward and reverse protocols are correct, the system is initially in thermal equilibrium for both protocols, and the stochastic work is correctly defined and measured. If the experimental or computational data conform to this precise linear relationship, it provides strong evidence that these foundational assumptions are satisfied. From the linear form $L(W) = \\beta W - \\beta \\Delta F$, the intercept at $W=0$ is indeed $-\\beta \\Delta F$, which allows for the determination of $\\Delta F$.\n**Verdict:** Correct.\n\n**B. Persistent curvature of $L(W)$ versus $W$ that diminishes when previously lumped fast intermediates are explicitly resolved is consistent with coarse-graining–induced hidden entropy production; in such cases, even if the crossing point $W_{\\times}$ of $P_F(W)$ and $P_R(-W)$ yields a good practical estimate of $\\Delta F$, the slope of $L(W)$ need not match $\\beta$.**\n**Analysis:** The Crooks theorem applies to the full, microscopically-defined system. Coarse-graining by lumping fast states into a single state can render the observed dynamics non-Markovian and, more importantly, can lead to an incomplete accounting of entropy production. The work definition based on the coarse-grained variables may miss contributions from transitions within the lumped states (\"hidden entropy production\"). This violation of the underlying assumptions leads to a breakdown of the simple linear form of $L(W)$, typically manifesting as curvature. Explicitly resolving these fast intermediates brings the model closer to the full microscopic description, recovering Markovianity and a more complete work definition, which in turn restores the linearity of the $L(W)$ plot. The point $W_{\\times}$ where $L(W_\\times)=0$ corresponds to $P_F(W_\\times)=P_R(-W_\\times)$. The Jarzynski equality, $\\langle e^{-\\beta W} \\rangle_F = e^{-\\beta \\Delta F}$, is an integral form of the Crooks theorem and can hold even when the detailed theorem (and thus the linearity of $L(W)$) fails. The crossing point $W_\\times = \\Delta F$ is also an implication of the detailed theorem and often remains a good estimate for $\\Delta F$ under certain conditions, but the slope of the curved $L(W)$ is not constant and therefore cannot be equal to $\\beta$ over any extended range of $W$.\n**Verdict:** Correct.\n\n**C. If the best-fit slope of $L(W)$ is systematically larger than $\\beta$ by about $10\\%$ while the intercept from the same fit agrees with an independent $\\Delta F$ within errors, the most likely cause is insufficient sample size; with more samples, the curvature would persist but the slope bias would vanish.**\n**Analysis:** This statement is logically flawed. Insufficient sample size is a source of *random statistical error*, which manifests as noise and increased variance in the estimated $P(W)$ and consequently in $L(W)$. It does not typically produce a clean, *systematic* bias of $10\\%$ in the slope. A systematic deviation of this magnitude points towards a systematic error in the experiment (e.g., miscalibration of temperature) or a failure of the model assumptions (e.g., those discussed in B or E), not a statistical artifact. Furthermore, the statement that \"the curvature would persist but the slope bias would vanish\" is contradictory. If significant curvature persists as sample size increases, it means the underlying relationship is not linear, and a single \"best-fit slope\" is a meaningless parameter. If the underlying relationship is truly linear, then with more samples, both apparent curvature and any slope bias due to noise should vanish, with the fit converging to the true line.\n**Verdict:** Incorrect.\n\n**D. If the reverse experiment is performed by starting from the nonequilibrium final distribution of the forward experiment rather than the equilibrium distribution at $\\lambda_\\tau$, then the $L(W)$ versus $W$ plot remains linear with the same slope as in the ideal case but is shifted vertically by a constant offset.**\n**Analysis:** The Crooks theorem in its standard form is critically dependent on the assumption that both forward and reverse processes begin from their respective equilibrium distributions. The initial probability of finding the system in a microstate $x_0$ for the forward process is $p_{eq}(x_0;\\lambda_0) \\propto e^{-\\beta H(x_0; \\lambda_0)}$. For the reverse process, it must be $p_{eq}(\\tilde{x}_0;\\lambda_\\tau) \\propto e^{-\\beta H(\\tilde{x}_0; \\lambda_\\tau)}$. If the reverse process starts from the non-equilibrium distribution reached at the end of the forward process, this condition is violated. The resulting work distribution for the reverse path, let's call it $P'_R(W)$, will differ in shape from the standard $P_R(W)$. Consequently, the ratio $P_F(W)/P'_R(-W)$ will not follow the simple exponential dependence on $W$ given by the Crooks theorem. A simple vertical shift in the log-ratio plot would imply $P_F(W)/P'_R(-W) = C \\cdot e^{\\beta(W - \\Delta F)}$ for some constant $C \\neq 1$, which means $P'_R(-W) = C^{-1} P_R(-W)$. This is not generally true; the shape of the work distribution depends fundamentally on the initial distribution of states. Therefore, the plot of $L(W)$ will generally change its shape and will not be a simple vertically shifted line.\n**Verdict:** Incorrect.\n\n**E. If the bath temperature drifts during the protocol in a way that is not accounted for (so the environment is nonisothermal), then the $L(W)$ versus $W$ plot can appear locally linear with an effective slope that varies with $W$; a global best-fit slope reflects a weighted average of the instantaneous inverse temperature over the support of $W$.**\n**Analysis:** The derivation of the Crooks theorem explicitly assumes an isothermal environment (constant $\\beta$). If the temperature $T(t)$ and thus $\\beta(t)$ vary during the protocol, the theorem does not apply in its simple form. The relationship between forward and reverse path probabilities becomes more complex, integrating over the time-varying temperature. Different work values $W$ may be correlated with different segments of the protocol, and thus with different instantaneous temperatures. For example, highly dissipative trajectories (large $W$) might occur preferentially during a high-temperature phase. This will cause the slope of the $L(W)$ plot to vary with $W$, reflecting some effective local temperature. A global linear fit to such a curved plot would yield a slope that is a non-trivial, weighted average of $\\beta(t)$ over the duration of the protocol. The description is physically plausible and qualitatively correct.\n**Verdict:** Correct.\n\n**F. Replacing the abscissa by the stochastic heat $Q$ while retaining the same forward and reverse histograms $P_F$ and $P_R$ is still expected to produce a strictly linear $L(Q) \\equiv \\ln\\!\\big[P_F(Q)/P_R(-Q)\\big]$ versus $Q$ with slope $\\beta$; therefore any observed curvature in $L(Q)$ indicates experimental error rather than theoretical limitation.**\n**Analysis:** This statement is fundamentally incorrect. The Crooks theorem is a statement about the work $W$ performed on the system via the external protocol. Heat, $Q$, is a different thermodynamic quantity, related to work and the change in internal energy $\\Delta U$ by the first law, $Q = \\Delta U - W$. Both $\\Delta U$ and $W$ are stochastic variables, so $Q$ is also a stochastic variable with its own distribution, $P(Q)$, which is generally different from $P(W)$. There is no general fluctuation theorem for heat analogous to the Crooks theorem for a non-cyclic process between two different equilibrium states. The premise that a linear relationship with slope $\\beta$ is expected for heat is false. The statement seems to be based on a misunderstanding and conflation of work and heat. Curvature observed in a plot involving heat distributions would be an expected theoretical outcome, not an indication of experimental error.\n**Verdict:** Incorrect.\n\n**G. A residual plot of $L(W)$ after subtracting its best-fit straight line versus $W$ should show no systematic structure if the underlying assumptions hold; if deviations from linearity are due to moderate sampling noise rather than a breakdown of the hypotheses, then a Bennett acceptance ratio (BAR) analysis can still yield an essentially unbiased estimate of $\\Delta F$ with smaller uncertainty than the raw crossing point.**\n**Analysis:** This statement accurately describes standard practice in statistical analysis. First, if the theoretical model (in this case, $L(W) = \\beta W - \\beta \\Delta F$) is correct, then the deviations of the data from the model fit should be random noise. A residual plot is the standard tool to check this; any systematic structure (e.g., curvature) in the residuals indicates that the model is a poor description of the data. Second, if the deviations are indeed just noise due to finite sampling, then more sophisticated estimators than the simple crossing point are desirable. The Bennett Acceptance Ratio (BAR) is a statistically optimal method that uses all work data from both forward and reverse distributions to estimate $\\Delta F$. It is known to provide the minimum-variance unbiased estimate of $\\Delta F$ under the assumption that the Crooks relation holds. Therefore, it is both more precise (smaller uncertainty) and robust against noise than simply identifying a single, noisy crossing point.\n**Verdict:** Correct.", "answer": "$$\\boxed{ABEG}$$", "id": "2644022"}]}