{"hands_on_practices": [{"introduction": "A crucial first step in modeling reactive systems is ensuring they are thermodynamically consistent. This practice grounds the abstract principle of local detailed balance in a concrete construction task. You will learn how to build a complete, reversible reaction mechanism by determining the reverse reaction rates from the forward rates and the standard chemical potentials of the species involved, ensuring the model correctly relaxes to a true thermodynamic equilibrium.[@problem_id:2678499]", "problem": "Consider an isothermal, isobaric, well-mixed, ideal dilute solution containing three interconverting chemical species $A$, $B$, and $C$. A proposed mechanism lists only the irreversible unimolecular steps $A \\to B$, $B \\to C$, and $C \\to A$ with mass-action rate constants $k_{AB}$, $k_{BC}$, and $k_{CA}$, respectively. The standard chemical potentials of the species are $\\mu_A^\\circ$, $\\mu_B^\\circ$, and $\\mu_C^\\circ$, the temperature is $T$, and the Boltzmann constant is $k_B$. The system is closed with respect to $A$, $B$, and $C$ (no exchange with reservoirs), and its stochastic dynamics are described by the Chemical Master Equation (CME) with elementary unimolecular propensities.\n\nStarting from first principles for closed reactive systems in stochastic thermodynamics, construct a thermodynamically consistent reversible extension of the mechanism by adding the reverse elementary reactions $B \\to A$, $C \\to B$, and $A \\to C$. Impose microreversibility and local detailed balance at equilibrium to determine the three reverse rate constants as functions of $k_{AB}$, $k_{BC}$, $k_{CA}$, $\\mu_A^\\circ$, $\\mu_B^\\circ$, $\\mu_C^\\circ$, $k_B$, and $T$. Express your final result as a single row matrix containing the three reverse rate constants in the order $(k_{BA}, k_{CB}, k_{AC})$. No numerical approximation is required.", "solution": "The system is an ideal dilute, isothermal, isobaric, closed mixture undergoing elementary unimolecular transitions among $A$, $B$, and $C$. The relevant foundational principles are as follows.\n\nFirst, in an ideal dilute solution, the chemical potential of species $i \\in \\{A,B,C\\}$ at concentration $c_i$ is given by\n$$\n\\mu_i = \\mu_i^\\circ + k_B T \\ln\\!\\left(\\frac{c_i}{c^\\circ}\\right),\n$$\nwhere $c^\\circ$ is a standard concentration that cancels in ratios of concentrations. At equilibrium in a closed system, the total Gibbs free energy is minimized subject to the conservation constraints, which implies that any pair of species directly interconverted by an elementary unimolecular reaction satisfies the equality of chemical potentials at equilibrium. Concretely, for $A \\leftrightharpoons B$ one has\n$$\n\\mu_A^{\\mathrm{eq}} = \\mu_B^{\\mathrm{eq}},\n$$\nand similarly for $B \\leftrightharpoons C$ and $C \\leftrightharpoons A$.\n\nSecond, in the Chemical Master Equation (CME) description with elementary mass-action propensities, a unimolecular transition $i \\to j$ has propensity proportional to the population of the source, which at the deterministic concentration level corresponds to a mean reaction rate $k_{ij}\\,c_i$. At equilibrium under microreversibility, detailed balance holds: for each reversible pair $i \\leftrightharpoons j$, the mean forward flux balances the mean reverse flux,\n$$\nk_{ij}\\,c_i^{\\mathrm{eq}} \\;=\\; k_{ji}\\,c_j^{\\mathrm{eq}}.\n$$\nRearranging yields the ratio of rate constants in terms of the equilibrium concentration ratio,\n$$\n\\frac{k_{ij}}{k_{ji}} \\;=\\; \\frac{c_j^{\\mathrm{eq}}}{c_i^{\\mathrm{eq}}}.\n$$\n\nThird, the equilibrium concentration ratio follows from equality of chemical potentials. Using $\\mu_i^{\\mathrm{eq}} = \\mu_j^{\\mathrm{eq}}$ and the ideal dilute form,\n$$\n\\mu_i^\\circ + k_B T \\ln\\!\\left(\\frac{c_i^{\\mathrm{eq}}}{c^\\circ}\\right) \\;=\\; \\mu_j^\\circ + k_B T \\ln\\!\\left(\\frac{c_j^{\\mathrm{eq}}}{c^\\circ}\\right),\n$$\nwhich simplifies to\n$$\n\\ln\\!\\left(\\frac{c_j^{\\mathrm{eq}}}{c_i^{\\mathrm{eq}}}\\right) \\;=\\; -\\,\\frac{\\mu_j^\\circ - \\mu_i^\\circ}{k_B T}.\n$$\nExponentiating,\n$$\n\\frac{c_j^{\\mathrm{eq}}}{c_i^{\\mathrm{eq}}} \\;=\\; \\exp\\!\\left(-\\,\\frac{\\mu_j^\\circ - \\mu_i^\\circ}{k_B T}\\right).\n$$\nCombining with the detailed-balance flux condition gives the local detailed balance relation for unimolecular elementary steps,\n$$\n\\frac{k_{ij}}{k_{ji}} \\;=\\; \\exp\\!\\left(-\\,\\frac{\\mu_j^\\circ - \\mu_i^\\circ}{k_B T}\\right).\n$$\nSolving for the reverse rate constant,\n$$\nk_{ji} \\;=\\; k_{ij}\\,\\exp\\!\\left(\\frac{\\mu_j^\\circ - \\mu_i^\\circ}{k_B T}\\right).\n$$\n\nWe now apply this to each of the three reversible pairs introduced to extend the proposed irreversible cycle $A \\to B \\to C \\to A$ into a thermodynamically consistent reversible network:\n\nFor $A \\leftrightharpoons B$:\n$$\nk_{BA} \\;=\\; k_{AB}\\,\\exp\\!\\left(\\frac{\\mu_B^\\circ - \\mu_A^\\circ}{k_B T}\\right).\n$$\n\nFor $B \\leftrightharpoons C$:\n$$\nk_{CB} \\;=\\; k_{BC}\\,\\exp\\!\\left(\\frac{\\mu_C^\\circ - \\mu_B^\\circ}{k_B T}\\right).\n$$\n\nFor $C \\leftrightharpoons A$:\n$$\nk_{AC} \\;=\\; k_{CA}\\,\\exp\\!\\left(\\frac{\\mu_A^\\circ - \\mu_C^\\circ}{k_B T}\\right).\n$$\n\nThese assignments satisfy microreversibility and local detailed balance on each edge. As a consistency check, the product of forward-to-reverse ratios around the cycle is\n$$\n\\frac{k_{AB}}{k_{BA}} \\cdot \\frac{k_{BC}}{k_{CB}} \\cdot \\frac{k_{CA}}{k_{AC}} \\;=\\; \\exp\\!\\left(-\\frac{(\\mu_B^\\circ - \\mu_A^\\circ) + (\\mu_C^\\circ - \\mu_B^\\circ) + (\\mu_A^\\circ - \\mu_C^\\circ)}{k_B T}\\right) \\;=\\; 1,\n$$\nso the net cycle affinity at equilibrium vanishes, as required for a closed system.\n\nTherefore, the thermodynamically consistent reverse rate constants are the three expressions above, which we collect in the requested order as a single row matrix.", "answer": "$$\\boxed{\\begin{pmatrix}\nk_{AB}\\,\\exp\\!\\left(\\dfrac{\\mu_B^\\circ - \\mu_A^\\circ}{k_B T}\\right) & k_{BC}\\,\\exp\\!\\left(\\dfrac{\\mu_C^\\circ - \\mu_B^\\circ}{k_B T}\\right) & k_{CA}\\,\\exp\\!\\left(\\dfrac{\\mu_A^\\circ - \\mu_C^\\circ}{k_B T}\\right)\n\\end{pmatrix}}$$", "id": "2678499"}, {"introduction": "While equilibrium provides a fundamental reference, many systems in chemistry and biology are driven into non-equilibrium steady states. This exercise introduces the concept of thermodynamic affinity as a way to quantify the force driving a cyclic reaction network away from detailed balance. By analyzing a system where the rate constants violate equilibrium conditions, you will calculate the net thermodynamic drive and understand its origin in the microscopic kinetics of the system.[@problem_id:2678481]", "problem": "Consider a well-mixed, isothermal chemical system at temperature $T$ comprising a single molecule that can occupy one of three internal states $X_{1}$, $X_{2}$, and $X_{3}$. Transitions between these states occur as reversible unimolecular reactions following mass-action kinetics. In the continuous-time Markov jump description, the transition $X_{i} \\to X_{j}$ occurs with constant rate $k_{ij}$ (units $\\,\\mathrm{s}^{-1}$). The system is maintained out of equilibrium by an external drive (for example, chemostatting or energy input from an unobserved fuel cycle) so that the given rate constants may violate detailed balance constraints. Assume the environment is large and isothermal, so that stochastic thermodynamic notions of entropy flow and local detailed balance apply.\n\nThe network and rate constants are:\n- $X_{1} \\rightleftharpoons X_{2}$ with $k_{12} = 3\\,\\mathrm{s}^{-1}$ and $k_{21} = 2\\,\\mathrm{s}^{-1}$,\n- $X_{2} \\rightleftharpoons X_{3}$ with $k_{23} = 3\\,\\mathrm{s}^{-1}$ and $k_{32} = 2\\,\\mathrm{s}^{-1}$,\n- $X_{3} \\rightleftharpoons X_{1}$ with $k_{31} = 3\\,\\mathrm{s}^{-1}$ and $k_{13} = 2\\,\\mathrm{s}^{-1}$.\n\nThis choice of rate constants violates Wegscheider conditions for detailed balance, thereby inducing a nonzero thermodynamic force around the closed cycle $X_{1} \\to X_{2} \\to X_{3} \\to X_{1}$.\n\nStarting from the master equation for a continuous-time Markov process and the definition of entropy flow to the medium for thermally activated transitions (local detailed balance), derive the expression for the cycle affinity associated with a closed directed cycle in terms of the transition rate constants only. Then, for the cycle $X_{1} \\to X_{2} \\to X_{3} \\to X_{1}$, compute the dimensionless cycle affinity $A/(k_{B} T)$ that quantifies the violation of detailed balance, where $k_{B}$ is Boltzmannâ€™s constant. Express your final answer as a single, exact analytic expression in terms of natural logarithms. Do not round. The requested quantity is dimensionless; report it without units.", "solution": "The problem requires the derivation of the cycle affinity for a continuous-time Markov process from fundamental principles and its subsequent calculation for a specific three-state system. This is a standard procedure in the field of stochastic thermodynamics.\n\nLet the probability of the system being in state $X_i$ at time $t$ be $p_i(t)$. The time evolution of the probability distribution $\\vec{p}(t) = (p_1(t), p_2(t), \\dots)^T$ is governed by the master equation:\n$$ \\frac{dp_i(t)}{dt} = \\sum_{j \\neq i} \\left( k_{ji} p_j(t) - k_{ij} p_i(t) \\right) $$\nwhere $k_{ij}$ is the transition rate constant from state $i$ to state $j$.\n\nThe total rate of entropy production, $\\dot{S}_{\\text{tot}}$, for an isothermal system can be decomposed into two parts: the rate of change of the system's entropy, $\\dot{S}_{\\text{sys}}$, and the rate of entropy flow into the surrounding medium, $\\dot{S}_{\\text{med}}$.\n$$ \\dot{S}_{\\text{tot}} = \\dot{S}_{\\text{sys}} + \\dot{S}_{\\text{med}} $$\nThe system entropy is the Gibbs-Shannon entropy, $S_{\\text{sys}} = -k_B \\sum_i p_i \\ln p_i$. At a non-equilibrium steady state (NESS), the probabilities $p_i$ are constant, so $\\dot{p}_i = 0$ and consequently $\\dot{S}_{\\text{sys}} = 0$. In this state, the total entropy production is solely due to the flow into the medium: $\\dot{S}_{\\text{tot}}^{\\text{ss}} = \\dot{S}_{\\text{med}}^{\\text{ss}}$.\n\nThe connection between the microscopic kinetics and thermodynamics is established by the principle of local detailed balance. This principle states that for any elementary transition $X_i \\to X_j$, the entropy change in the medium, $\\Delta s_{ij}^{\\text{med}}$, is related to the ratio of the forward and reverse transition rates:\n$$ \\frac{k_{ij}}{k_{ji}} = \\exp\\left( \\frac{\\Delta s_{ij}^{\\text{med}}}{k_B} \\right) $$\nThis implies that for a single jump event from state $i$ to state $j$, the entropy increase in the medium is:\n$$ \\Delta s_{ij}^{\\text{med}} = k_B \\ln \\frac{k_{ij}}{k_{ji}} $$\nThe total rate of entropy flow to the medium is found by summing the contributions from all possible net fluxes, $J_{ij}^{\\text{net}} = k_{ij}p_i - k_{ji}p_j$:\n$$ \\dot{S}_{\\text{med}}(t) = \\sum_{i<j} (k_{ij}p_i(t) - k_{ji}p_j(t)) \\ln \\frac{k_{ij}}{k_{ji}} $$\nAt steady state, network theory allows for the decomposition of the total entropy production rate into contributions from fundamental cycles. For each cycle $c$, the entropy production rate is the product of the net cycle flux $J_c$ and the cycle affinity $A_c$.\n\nThe thermodynamic affinity $A_c$ of a single directed cycle, $c: X_{i_1} \\to X_{i_2} \\to \\dots \\to X_{i_n} \\to X_{i_1}$, is defined as the total thermodynamic force driving the cycle. This force is the total free energy drop over one full traversal of the cycle. For an isothermal system, this corresponds to the net work done by the system or, equivalently, the heat dissipated into the environment. This is equal to the total entropy change in the medium, $\\Delta S_{\\text{med}}^{(c)}$, multiplied by the temperature $T$. The total entropy change is the sum of the entropy changes for each elementary step in the cycle:\n$$ A_c = T \\Delta S_{\\text{med}}^{(c)} = T \\sum_{k=1}^{n} \\Delta s_{i_k i_{k+1}}^{\\text{med}} \\quad (\\text{with } i_{n+1} = i_1) $$\nSubstituting the expression from local detailed balance:\n$$ A_c = T \\sum_{k=1}^{n} k_B \\ln \\frac{k_{i_k i_{k+1}}}{k_{i_{k+1} i_k}} $$\nUsing the properties of logarithms, this sum becomes the logarithm of a product:\n$$ A_c = k_B T \\ln \\left( \\prod_{k=1}^{n} \\frac{k_{i_k i_{k+1}}}{k_{i_{k+1} i_k}} \\right) $$\nThis expression can be written as the logarithm of the ratio of the product of all forward rate constants along the cycle to the product of all reverse rate constants:\n$$ A_c = k_B T \\ln \\left( \\frac{\\prod_{c^+} k_{ij}}{\\prod_{c^-} k_{ji}} \\right) $$\nwhere $c^+$ indicates the set of forward transitions in the cycle and $c^-$ indicates the set of reverse transitions. This completes the required derivation. The dimensionless affinity is then:\n$$ \\frac{A_c}{k_B T} = \\ln \\left( \\frac{\\prod_{c^+} k_{ij}}{\\prod_{c^-} k_{ji}} \\right) $$\nIf detailed balance were satisfied for the cycle, the product of forward rates would equal the product of reverse rates (the Wegscheider condition), the argument of the logarithm would be $1$, and the affinity would be zero. A non-zero affinity signifies a broken detailed balance and a driven, non-equilibrium system.\n\nNow, we apply this result to the given problem. The system has three states $X_1, X_2, X_3$, and we are interested in the cycle $c: X_1 \\to X_2 \\to X_3 \\to X_1$.\n\nThe forward transitions for this cycle are $X_1 \\to X_2$, $X_2 \\to X_3$, and $X_3 \\to X_1$. The corresponding rate constants are $k_{12}$, $k_{23}$, and $k_{31}$.\nThe reverse transitions are $X_2 \\to X_1$, $X_3 \\to X_2$, and $X_1 \\to X_3$. The corresponding rate constants are $k_{21}$, $k_{32}$, and $k_{13}$.\n\nThe dimensionless affinity for this cycle is therefore:\n$$ \\frac{A_c}{k_B T} = \\ln \\left( \\frac{k_{12} k_{23} k_{31}}{k_{21} k_{32} k_{13}} \\right) $$\nWe are given the following values for the rate constants:\n$$ k_{12} = 3\\,\\mathrm{s}^{-1}, \\quad k_{23} = 3\\,\\mathrm{s}^{-1}, \\quad k_{31} = 3\\,\\mathrm{s}^{-1} $$\n$$ k_{21} = 2\\,\\mathrm{s}^{-1}, \\quad k_{32} = 2\\,\\mathrm{s}^{-1}, \\quad k_{13} = 2\\,\\mathrm{s}^{-1} $$\nSubstitute these values into the expression for the dimensionless affinity:\n$$ \\frac{A_c}{k_B T} = \\ln \\left( \\frac{3 \\cdot 3 \\cdot 3}{2 \\cdot 2 \\cdot 2} \\right) = \\ln \\left( \\frac{27}{8} \\right) $$\nThis is the final, exact analytical expression for the dimensionless cycle affinity. It is a positive, non-zero value, confirming that the system is maintained out of equilibrium by an external driving force, as stated in the problem.", "answer": "$$\\boxed{\\ln\\left(\\frac{27}{8}\\right)}$$", "id": "2678481"}, {"introduction": "When analytical descriptions become intractable, computational simulations are essential for understanding the dynamics of stochastic systems. This exercise bridges theory and practice by detailing the Gillespie Stochastic Simulation Algorithm (SSA), a method for generating exact stochastic trajectories. You will focus on the practical implementation of tracking thermodynamic quantities, such as the entropy produced in the environment, by applying the principle of local detailed balance at each simulated reaction event.[@problem_id:2678446]", "problem": "Consider a well-mixed isothermal dilute solution at temperature $T$ containing $S$ chemical species interacting through $R$ reaction channels. Let the state be the molecule count vector $x \\in \\mathbb{N}_0^S$ and let the $r$-th reaction have stoichiometric change vector $\\nu_r \\in \\mathbb{Z}^S$ and propensity $w_r(x)$, for $r \\in \\{1,\\dots,R\\}$. Assume the dynamics are governed by the chemical master equation and thus constitute a continuous-time Markov jump process with transition rates $k_{x \\to x+\\nu_r} = w_r(x)$. For each reaction $r$, assume there exists a unique reverse channel $r^\\star$ with stoichiometric change vector $\\nu_{r^\\star} = -\\nu_r$ and propensity $w_{r^\\star}(x')$, where $x' = x + \\nu_r$, such that local detailed balance holds in the sense that the medium entropy flow associated with a single jump $x \\to x'$ via $r$ is given by the log ratio of the forward and backward rates between these microstates. You want to simulate a single stochastic trajectory over a time interval $[0, T_{\\mathrm{end}}]$ using the direct Stochastic Simulation Algorithm (SSA) and to record the running medium entropy production along the trajectory, denoted $S_{\\mathrm{m}}(t)$, as the sum over all jump contributions.\n\nWhich option correctly outlines the steps of the direct Gillespie Stochastic Simulation Algorithm (SSA) for this system and correctly specifies how to record the medium entropy increment at each jump according to local detailed balance?\n\nA. At current state $x$ and time $t$, compute the total propensity $w_0(x) = \\sum_{r=1}^R w_r(x)$. Sample a waiting time $\\tau$ from the exponential distribution with rate $w_0(x)$, i.e., with density $w_0(x)\\,\\exp(-w_0(x)\\,\\tau)$ for $\\tau \\ge 0$. Select the next reaction channel $r$ with probability $w_r(x)/w_0(x)$. Update the state to $x' = x + \\nu_r$ and the time to $t \\leftarrow t + \\tau$. Record the medium entropy increment $\\Delta s_{\\mathrm{m}} = \\ln\\left[\\dfrac{w_r(x)}{w_{r^\\star}(x')}\\right]$, add it to $S_{\\mathrm{m}}(t)$, recompute propensities at $x'$, and iterate until $t \\ge T_{\\mathrm{end}}$.\n\nB. At current state $x$ and time $t$, compute $w_0(x) = \\sum_{r=1}^R w_r(x)$. Set a deterministic waiting time $\\tau = 1/w_0(x)$. Select reaction $r$ with probability $w_r(x)/w_0(x)$. Update to $x' = x + \\nu_r$, set $t \\leftarrow t + \\tau$, and record $\\Delta s_{\\mathrm{m}} = \\ln\\left[\\dfrac{w_r(x)}{w_0(x)}\\right]$. Repeat until $t \\ge T_{\\mathrm{end}}$.\n\nC. At current state $x$ and time $t$, sample a waiting time $\\tau$ from an exponential distribution with rate $w_0(x) = \\sum_{r=1}^R w_r(x)$. Choose reaction $r$ with probability proportional to $w_r(x+\\nu_r)$, i.e., according to the normalized set $\\{w_r(x+\\nu_r)/\\sum_{q=1}^R w_q(x+\\nu_q)\\}$. Update to $x' = x + \\nu_r$, set $t \\leftarrow t + \\tau$, and record $\\Delta s_{\\mathrm{m}} = -\\ln p_t(x') + \\ln p_t(x)$, where $p_t$ is the instantaneous probability distribution over states. Repeat until $t \\ge T_{\\mathrm{end}}$.\n\nD. Evolve the system with a fixed time discretization $\\delta t > 0$. At each step, draw a uniform random reaction channel $r$ from $\\{1,\\dots,R\\}$ and fire it if a uniform random number $u \\in [0,1]$ is less than $w_r(x)\\,\\delta t$, otherwise do nothing; then set $t \\leftarrow t + \\delta t$. If reaction $r$ fires, update to $x' = x + \\nu_r$ and record $\\Delta s_{\\mathrm{m}} = \\ln\\left[\\dfrac{w_r(x)}{w_{r^\\star}(x)}\\right]$. Continue until $t \\ge T_{\\mathrm{end}}$.", "solution": "The governing fundamental base is the chemical master equation (CME), which defines a continuous-time Markov jump process over the state space of molecule counts. For a current state $x$, the total rate to leave $x$ is $w_0(x) = \\sum_{r=1}^R w_r(x)$, where $w_r(x)$ is the propensity of reaction $r$ at $x$. Two key results for continuous-time Markov jump processes follow from the CME and standard hazard-rate arguments:\n\n$1.$ Waiting-time distribution. Let $P(\\tau)$ be the survival probability of no reaction occurring in the interval $[t, t+\\tau)$ given the system is in state $x$ at time $t$. Over an infinitesimal increment $\\mathrm{d}\\tau$, the probability to have no reaction is $1 - w_0(x)\\,\\mathrm{d}\\tau + o(\\mathrm{d}\\tau)$, because the total hazard to leave $x$ is $w_0(x)$. Thus $P(\\tau + \\mathrm{d}\\tau) = P(\\tau)\\left(1 - w_0(x)\\,\\mathrm{d}\\tau\\right) + o(\\mathrm{d}\\tau)$, leading to the differential equation $\\dfrac{\\mathrm{d}P}{\\mathrm{d}\\tau} = -w_0(x)\\,P(\\tau)$ with initial condition $P(0) = 1$. The solution is $P(\\tau) = \\exp\\left(-w_0(x)\\,\\tau\\right)$. Therefore the waiting time $\\tau$ to the next reaction is exponentially distributed with rate $w_0(x)$, having density $f(\\tau) = w_0(x)\\,\\exp\\left(-w_0(x)\\,\\tau\\right)$ for $\\tau \\ge 0$.\n\n$2.$ Channel-selection distribution. Conditional on a reaction occurring at time $t+\\tau$, the probability that the channel is $r$ is given by the ratio of its hazard to the total hazard at the pre-jump state $x$, namely $\\mathbb{P}(r \\mid x) = w_r(x)/w_0(x)$. This follows from the decomposition of the total rate into the contributions of each channel and the memoryless property of the exponential waiting time.\n\nThese two results are the foundation of the direct Stochastic Simulation Algorithm (SSA) of Daniel Gillespie: at each state, one samples an exponential waiting time using the total propensity and then selects a reaction channel according to the normalized propensities at the pre-jump state.\n\nNow consider medium entropy flow in stochastic thermodynamics. For Markov jump processes obeying local detailed balance with well-defined reverse transitions, the increment of medium entropy associated with an elementary jump $x \\to x'$ via reaction $r$ is given by\n$$\n\\Delta s_{\\mathrm{m}}(x \\to x'; r) \\equiv \\ln \\frac{k_{x \\to x'}(r)}{k_{x' \\to x}(r^\\star)} = \\ln \\frac{w_r(x)}{w_{r^\\star}(x')}.\n$$\nThis expression arises from the ratio of the probability densities of the forward and time-reversed path segments over the small time interval surrounding the jump. Under isothermal conditions with ideal dilute solution and chemostatted chemical potentials, local detailed balance further connects this log ratio to the dissipated heat and chemical work via $\\Delta s_{\\mathrm{m}} = \\beta q_{\\mathrm{env}}$ when the appropriate energetic and chemical contributions are accounted for, but the fundamental, implementation-ready expression for recording along a trajectory is the log ratio of the forward propensity at the pre-jump state and the reverse propensity at the post-jump state.\n\nWe now evaluate each option:\n\nOption A: This specifies computing $w_0(x) = \\sum_{r=1}^R w_r(x)$; sampling $\\tau$ from the exponential distribution with rate $w_0(x)$; selecting reaction $r$ with probability $w_r(x)/w_0(x)$; updating the state $x \\to x' = x + \\nu_r$; and recording the medium entropy increment $\\Delta s_{\\mathrm{m}} = \\ln\\left[w_r(x)/w_{r^\\star}(x')\\right]$. These steps exactly match the derivation from the CME for the waiting time and channel selection, and they implement the local-detailed-balance medium entropy increment using the reverse propensity evaluated at the post-jump state. Recomputing the propensities at $x'$ and iterating is the standard direct SSA loop. Therefore Option A is correct.\n\nOption B: This sets a deterministic waiting time $\\tau = 1/w_0(x)$. This contradicts the exponential waiting time distribution derived from the CME; the correct waiting time is a random variable with density $w_0(x)\\,\\exp(-w_0(x)\\,\\tau)$, not a constant. Additionally, it records $\\Delta s_{\\mathrm{m}} = \\ln\\left[w_r(x)/w_0(x)\\right]$, which is not the local-detailed-balance entropy flow for a jump; the medium entropy increment depends on the reverse transition rate from the post-jump state, not on the total pre-jump rate. Therefore Option B is incorrect.\n\nOption C: This uses the correct exponential waiting time with rate $w_0(x)$ but then selects the reaction channel with probability proportional to $w_r(x+\\nu_r)$, i.e., using post-fired propensities to choose the channel. The correct conditional probability uses the pre-jump hazards $w_r(x)/w_0(x)$; using $w_r(x+\\nu_r)$ is inconsistent with the Markov jump process decomposition at the pre-jump state. Moreover, it records $\\Delta s_{\\mathrm{m}} = -\\ln p_t(x') + \\ln p_t(x)$, which is the instantaneous system entropy change contribution $\\Delta s_{\\mathrm{sys}}$, not the medium entropy flow. The medium entropy increment is given by the log ratio of forward and reverse rates, as above. Therefore Option C is incorrect.\n\nOption D: This uses a fixed time step $\\delta t$ and a thinning-like scheme by comparing $u$ to $w_r(x)\\,\\delta t$ for a uniformly chosen $r$. This is not the direct Gillespie SSA; it is a form of rejection-based discrete-time approximation that does not in general produce exact sample paths unless $\\delta t \\to 0$ and one handles multiple channels carefully with total-rate thinning. Furthermore, the recorded medium entropy increment $\\Delta s_{\\mathrm{m}} = \\ln\\left[w_r(x)/w_{r^\\star}(x)\\right]$ uses the reverse propensity evaluated at the pre-jump state $x$ rather than the post-jump state $x'$, whereas local detailed balance requires the ratio $w_r(x)/w_{r^\\star}(x')$ between the two states connected by the jump. Therefore Option D is incorrect.\n\nIn conclusion, only Option A correctly specifies both the exact direct Gillespie SSA and the locally detailed-balanced medium entropy increment to record at each jump.", "answer": "$$\\boxed{A}$$", "id": "2678446"}]}