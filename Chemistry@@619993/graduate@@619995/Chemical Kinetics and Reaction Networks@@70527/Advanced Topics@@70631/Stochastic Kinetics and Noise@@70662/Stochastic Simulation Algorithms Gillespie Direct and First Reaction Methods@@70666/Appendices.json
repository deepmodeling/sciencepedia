{"hands_on_practices": [{"introduction": "The Gillespie Direct Method is a cornerstone algorithm for simulating stochastic chemical kinetics. This first exercise provides a direct, hands-on experience with its core mechanics. By manually tracing the first few events of a simple birth-death process, you will build a concrete understanding of how the system's state dictates the probability of future events and the timing between them, demystifying the interplay between propensities, random numbers, and the resulting stochastic trajectory [@problem_id:2678033].", "problem": "Consider a single-species birth–death process for a molecular population $X(t)$, with two reaction channels:\n- Birth: $X \\to X + 1$ occurring at a constant rate $\\lambda$ (this is equivalent to $\\varnothing \\to X$ with propensity $\\lambda$).\n- Death: $X \\to X - 1$ occurring at a rate proportional to the current population, with propensity $\\mu X$.\n\nAssume $\\lambda = 2\\,\\mathrm{s^{-1}}$, $\\mu = 0.25\\,\\mathrm{s^{-1}}$ per molecule, and initial condition $X(0) = 3$. Using the Gillespie direct method (also known as the Stochastic Simulation Algorithm), treat each inter-event waiting time as an exponential random variable with rate equal to the instantaneous total propensity, and select the channel of the next reaction according to probabilities proportional to the current propensities. You are provided with three independent pairs of uniform random seeds $(u_{1,k},u_{2,k})$ for $k \\in \\{1,2,3\\}$, where for each event $k$, $u_{1,k}$ is used to sample the waiting time and $u_{2,k}$ is used to select the reaction channel:\n- $(u_{1,1},u_{2,1}) = \\big(\\exp(-1.1),\\,0.8\\big)$,\n- $(u_{1,2},u_{2,2}) = \\big(\\exp(-0.05),\\,0.2\\big)$,\n- $(u_{1,3},u_{2,3}) = \\big(\\exp(-0.3),\\,0.55\\big)$.\n\nCarry out, by hand, the first three events of the Gillespie direct method, starting at time $t=0$, updating the state $X$ and the absolute time after each event. Using only the definitions stated above, determine the absolute time $t_3$ at which the third reaction event occurs. Express your final answer as an exact value in seconds. Do not round; provide an exact fraction if possible. The final answer must be a single real number.", "solution": "The problem statement is subjected to validation.\n\n**Step 1: Extract Givens**\n- System: A single-species birth–death process, population $X(t)$.\n- Reactions and Propensities:\n  - Birth: $X \\to X + 1$ (or $\\varnothing \\to X$), propensity $a_1 = \\lambda$.\n  - Death: $X \\to X - 1$, propensity $a_2 = \\mu X$.\n- Rate Constants:\n  - $\\lambda = 2\\,\\mathrm{s^{-1}}$.\n  - $\\mu = 0.25\\,\\mathrm{s^{-1}}$ per molecule.\n- Initial Condition: $X(0) = 3$ at time $t=0$.\n- Algorithm: Gillespie direct method. The inter-event waiting time $\\tau$ is sampled from an exponential distribution with rate $a_{total}$, which is the sum of all propensities. The formula is given by $\\tau = \\frac{1}{a_{total}} \\ln(\\frac{1}{u_1})$. The next reaction channel is chosen based on probabilities proportional to the individual propensities, using a second uniform random number $u_2$.\n- Random Seeds: Three pairs of uniform random seeds $(u_{1,k}, u_{2,k})$ for events $k = 1, 2, 3$:\n  - $(u_{1,1}, u_{2,1}) = (\\exp(-1.1), 0.8)$.\n  - $(u_{1,2}, u_{2,2}) = (\\exp(-0.05), 0.2)$.\n  - $(u_{1,3}, u_{2,3}) = (\\exp(-0.3), 0.55)$.\n- Objective: Determine the absolute time $t_3$ of the third reaction event.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is evaluated against the validation criteria.\n- **Scientifically Grounded**: The problem describes a standard birth-death process, a fundamental model in stochastic chemical kinetics. The Gillespie algorithm is the canonical, exact simulation method for such systems. The formulation is entirely consistent with established scientific principles.\n- **Well-Posed**: The problem is well-posed. It provides all necessary parameters, initial conditions, and a specific sequence of random numbers to deterministically trace the first three events of the stochastic simulation. The objective is clear and unambiguous.\n- **Objective**: The problem is stated in precise, objective language, free of any subjective or non-scientific content.\n\n**Verdict and Action**\nThe problem is scientifically sound, self-contained, and well-posed. There are no identifiable flaws. Therefore, the problem is **valid**. A solution will be derived.\n\nThe simulation proceeds event by event, updating the system state $(t, X)$ at each step. The state at the beginning of step $k$ is $(t_{k-1}, X_{k-1})$.\n\n**Initial State ($k=0$):**\nThe system begins at time $t_0 = 0$ with an initial population of $X_0 = 3$.\n\n**Event 1 ($k=1$):**\nFirst, we calculate the propensities for the two reaction channels based on the state $(t_0, X_0)$.\n- Birth propensity: $a_1 = \\lambda = 2$.\n- Death propensity: $a_2 = \\mu X_0 = (0.25) \\cdot 3 = 0.75$.\n\nThe total propensity is the sum of the individual propensities:\n$$a_{total,0} = a_1 + a_2 = 2 + 0.75 = 2.75 = \\frac{11}{4}$$\nThe waiting time for the first event, $\\tau_1$, is calculated using the first random seed $u_{1,1} = \\exp(-1.1)$.\n$$\\tau_1 = \\frac{1}{a_{total,0}} \\ln\\left(\\frac{1}{u_{1,1}}\\right) = \\frac{1}{11/4} \\ln\\left(\\frac{1}{\\exp(-1.1)}\\right) = \\frac{4}{11} \\ln(\\exp(1.1)) = \\frac{4}{11} \\cdot (1.1) = \\frac{4.4}{11} = 0.4 = \\frac{2}{5}$$\nThe time of the first event is:\n$$t_1 = t_0 + \\tau_1 = 0 + 0.4 = 0.4$$\nNext, we determine which reaction occurs using the second random seed $u_{2,1} = 0.8$. The birth reaction (channel $1$) occurs if $u_{2,1} \\le \\frac{a_1}{a_{total,0}}$.\n$$\\frac{a_1}{a_{total,0}} = \\frac{2}{2.75} = \\frac{2}{11/4} = \\frac{8}{11} \\approx 0.727$$\nSince $u_{2,1} = 0.8 > \\frac{8}{11}$, the death reaction (channel $2$) is selected. The population is updated accordingly:\n$$X_1 = X_0 - 1 = 3 - 1 = 2$$\nThe state after the first event is $(t_1, X_1) = (0.4, 2)$.\n\n**Event 2 ($k=2$):**\nWe proceed from the state $(t_1, X_1) = (0.4, 2)$.\n- Birth propensity: $a_1 = \\lambda = 2$.\n- Death propensity: $a_2 = \\mu X_1 = (0.25) \\cdot 2 = 0.5$.\n\nThe total propensity is:\n$$a_{total,1} = a_1 + a_2 = 2 + 0.5 = 2.5 = \\frac{5}{2}$$\nThe waiting time for the second event, $\\tau_2$, is calculated using $u_{1,2} = \\exp(-0.05)$.\n$$\\tau_2 = \\frac{1}{a_{total,1}} \\ln\\left(\\frac{1}{u_{1,2}}\\right) = \\frac{1}{5/2} \\ln\\left(\\frac{1}{\\exp(-0.05)}\\right) = \\frac{2}{5} \\ln(\\exp(0.05)) = \\frac{2}{5} \\cdot (0.05) = \\frac{0.1}{5} = 0.02 = \\frac{1}{50}$$\nThe time of the second event is:\n$$t_2 = t_1 + \\tau_2 = 0.4 + 0.02 = 0.42 = \\frac{42}{100} = \\frac{21}{50}$$\nThe reaction is selected using $u_{2,2} = 0.2$. The condition for a birth reaction is $u_{2,2} \\le \\frac{a_1}{a_{total,1}}$.\n$$\\frac{a_1}{a_{total,1}} = \\frac{2}{2.5} = \\frac{4}{5} = 0.8$$\nSince $u_{2,2} = 0.2 \\le 0.8$, the birth reaction is selected. The population becomes:\n$$X_2 = X_1 + 1 = 2 + 1 = 3$$\nThe state after the second event is $(t_2, X_2) = (0.42, 3)$.\n\n**Event 3 ($k=3$):**\nWe proceed from the state $(t_2, X_2) = (0.42, 3)$. The population count has returned to its initial value.\n- Birth propensity: $a_1 = \\lambda = 2$.\n- Death propensity: $a_2 = \\mu X_2 = (0.25) \\cdot 3 = 0.75$.\n\nThe total propensity is identical to the first step:\n$$a_{total,2} = a_1 + a_2 = 2 + 0.75 = 2.75 = \\frac{11}{4}$$\nThe waiting time for the third event, $\\tau_3$, is calculated using $u_{1,3} = \\exp(-0.3)$.\n$$\\tau_3 = \\frac{1}{a_{total,2}} \\ln\\left(\\frac{1}{u_{1,3}}\\right) = \\frac{1}{11/4} \\ln\\left(\\frac{1}{\\exp(-0.3)}\\right) = \\frac{4}{11} \\ln(\\exp(0.3)) = \\frac{4}{11} \\cdot (0.3) = \\frac{1.2}{11} = \\frac{12}{110} = \\frac{6}{55}$$\nThe absolute time of the third event, $t_3$, is the cumulative sum of the waiting times:\n$$t_3 = t_2 + \\tau_3 = \\frac{21}{50} + \\frac{6}{55}$$\nTo add these fractions, we find a common denominator, which is $\\mathrm{lcm}(50, 55) = \\mathrm{lcm}(2 \\cdot 5^2, 5 \\cdot 11) = 2 \\cdot 5^2 \\cdot 11 = 550$.\n$$t_3 = \\frac{21 \\cdot 11}{50 \\cdot 11} + \\frac{6 \\cdot 10}{55 \\cdot 10} = \\frac{231}{550} + \\frac{60}{550} = \\frac{231 + 60}{550} = \\frac{291}{550}$$\nThe fraction $\\frac{291}{550}$ is irreducible because the prime factors of the numerator are $291 = 3 \\cdot 97$ and the prime factors of the denominator are $550 = 2 \\cdot 5^2 \\cdot 11$, with no factors in common.\n\nThe question only asks for the time $t_3$. For completeness, the third reaction would be a birth, since $u_{2,3} = 0.55 \\le \\frac{8}{11}$.\n\nThe final answer is the absolute time at which the third event occurs.", "answer": "$$\\boxed{\\frac{291}{550}}$$", "id": "2678033"}, {"introduction": "While the Direct Method is conceptually simple, the First Reaction Method (FRM) offers an alternative, yet equally exact, approach to stochastic simulation. The FRM conceives of each reaction channel having its own independent \"clock,\" and the next event is simply the one whose clock rings first. This exercise isolates the FRM's fundamental step—sampling a waiting time for a single reaction channel—allowing you to derive this process from first principles and apply it to a nonlinear dimerization reaction, building a solid foundation for understanding more complex FRM implementations [@problem_id:2678042].", "problem": "Consider the irreversible dimerization reaction in a well-stirred, thermally equilibrated, fixed-volume system:\n$$2A \\to A_2.$$\nAssume mass-action stochastic kinetics with the standard propensity for this bimolecular reaction given by\n$$a(x) = c\\binom{x_A}{2} = c\\frac{x_A(x_A-1)}{2},$$\nwhere $x_A$ is the molecular count of $A$ and $c$ is the stochastic rate constant. The system is initially at time $t=0$ in the state $x_A=4$ and $x_{A_2}=0$, with stochastic rate constant $c=0.50\\,\\mathrm{s}^{-1}$. Use the First Reaction Method (FRM) of the Stochastic Simulation Algorithm (SSA) to simulate the first two reaction events. At each FRM step, use the specified independent uniform seeds for the single reaction channel: for the first step use $u_1=0.80$ and for the second step use $u_2=0.30$, where each $u_i$ is a sample from the continuous uniform distribution on the unit interval.\n\nStarting only from the core definition that, over any interval on which a propensity is constant, the probability that no reaction fires is the survival function of a Poisson process with rate equal to that propensity, derive the distribution of the waiting time to the next reaction event and use it to compute the absolute time of the second reaction event, denoted $t_2$.\n\nExpress your final answer for $t_2$ in seconds and round your answer to four significant figures.", "solution": "The problem is first subjected to validation to ensure its scientific and logical integrity.\n\nThe givens extracted verbatim from the problem statement are:\n1.  Reaction: $2A \\to A_2$.\n2.  Propensity function: $a(x) = c\\binom{x_A}{2} = c\\frac{x_A(x_A-1)}{2}$.\n3.  Initial conditions at time $t=0$: $x_A=4$, $x_{A_2}=0$.\n4.  Stochastic rate constant: $c=0.50\\,\\mathrm{s}^{-1}$.\n5.  Algorithm: First Reaction Method (FRM).\n6.  Random seeds for the single reaction channel: $u_1=0.80$ for the first step, $u_2=0.30$ for the second step.\n7.  Core principle for derivation: \"[T]he probability that no reaction fires is the survival function of a Poisson process with rate equal to that propensity.\"\n8.  Objective: Compute the absolute time of the second reaction event, $t_2$, rounded to four significant figures.\n\nThe problem is assessed to be **valid**. It is scientifically grounded in the established theory of stochastic chemical kinetics and the Stochastic Simulation Algorithm (SSA). The model for the dimerization reaction is standard, and the propensity function is correct for mass-action kinetics. The problem is well-posed, providing all necessary initial conditions, parameters, and random numbers to compute a unique, verifiable solution. The language is objective and precise. The task, while involving a simplified case of the First Reaction Method (due to a single reaction channel), requires a rigorous derivation and application of the core principles of stochastic simulation, and is therefore not trivial.\n\nThe solution proceeds as follows.\n\nFirst, we derive the formula for the waiting time $\\tau$ to the next reaction event from the stated first principle. Let the system be in a state $x$ where the propensity of the single reaction is $a(x)$. The propensity is constant as long as the state does not change. Let $\\tau$ be the random variable for the waiting time until the next reaction. The problem states that the probability of no reaction event occurring in the time interval $[0, t']$ is given by the survival function of a Poisson process with rate $a(x)$. The probability of zero events occurring in a duration $t'$ for a Poisson process with rate $\\lambda$ is $P(N(t')=0) = \\exp(-\\lambda t')$. Applying this principle with $\\lambda = a(x)$, the probability that the waiting time $\\tau$ is greater than some value $t'$ is:\n$$P(\\tau > t') = \\exp(-a(x)t')$$\nThis is the survival function of the waiting time distribution. The cumulative distribution function (CDF), $F(t') = P(\\tau \\le t')$, is therefore:\n$$F(t') = 1 - P(\\tau > t') = 1 - \\exp(-a(x)t')$$\nThis is the CDF of the exponential distribution with rate parameter $a(x)$.\nTo generate a random sample $\\tau_{sample}$ from this distribution via the inverse transform method, we set $F(\\tau_{sample}) = u$, where $u$ is a random number drawn from the uniform distribution on the unit interval, $\\mathcal{U}(0,1)$.\n$$u = 1 - \\exp(-a(x)\\tau_{sample})$$\nSolving for $\\tau_{sample}$:\n$$\\exp(-a(x)\\tau_{sample}) = 1 - u$$\n$$-a(x)\\tau_{sample} = \\ln(1 - u)$$\n$$\\tau_{sample} = -\\frac{\\ln(1 - u)}{a(x)}$$\nAs a random variable $u$ drawn from $\\mathcal{U}(0,1)$ implies that $1-u$ is also drawn from $\\mathcal{U}(0,1)$, it is standard practice to use the computationally equivalent and simpler formula:\n$$\\tau_{sample} = -\\frac{\\ln(u)}{a(x)}$$\nThis is the formula we will use to compute the waiting times. The First Reaction Method (FRM) for a system with a single reaction channel simplifies to applying this formula directly at each step.\n\n**Simulation Step 1:**\nThe simulation begins at time $t_0 = 0$ with the initial state $x(0) = (x_A, x_{A_2}) = (4, 0)$.\nThe propensity for the reaction $2A \\to A_2$ in this state is $a_0$.\n$$a_0 = c\\frac{x_A(x_A-1)}{2} = (0.50\\,\\mathrm{s}^{-1})\\frac{4(4-1)}{2} = (0.50\\,\\mathrm{s}^{-1})\\frac{12}{2} = 3.0\\,\\mathrm{s}^{-1}$$\nThe waiting time for the first reaction, $\\tau_1$, is calculated using the first random seed $u_1 = 0.80$.\n$$\\tau_1 = -\\frac{\\ln(u_1)}{a_0} = -\\frac{\\ln(0.80)}{3.0\\,\\mathrm{s}^{-1}}$$\nUsing the natural logarithm $\\ln(0.80) \\approx -0.22314$:\n$$\\tau_1 \\approx -\\frac{-0.22314}{3.0\\,\\mathrm{s}^{-1}} \\approx 0.07438\\,\\mathrm{s}$$\nThe first reaction event occurs at time $t_1 = t_0 + \\tau_1 = 0 + \\tau_1 = \\tau_1$.\nThe state of the system is updated according to the stoichiometry of the reaction $2A \\to A_2$, which has a state-change vector $\\nu = (-2, +1)$ for the species counts $(x_A, x_{A_2})$.\nNew state at time $t_1$:\n$$x_A(t_1) = x_A(0) - 2 = 4 - 2 = 2$$\n$$x_{A_2}(t_1) = x_{A_2}(0) + 1 = 0 + 1 = 1$$\nThe state after the first event is $x(t_1) = (2, 1)$.\n\n**Simulation Step 2:**\nThe system is now in state $x(t_1) = (2, 1)$. We calculate the new propensity, $a_1$.\n$$a_1 = c\\frac{x_A(x_A-1)}{2} = (0.50\\,\\mathrm{s}^{-1})\\frac{2(2-1)}{2} = (0.50\\,\\mathrm{s}^{-1})\\frac{2}{2} = 0.50\\,\\mathrm{s}^{-1}$$\nThe waiting time for the second reaction, $\\tau_2$, is calculated using the second random seed $u_2 = 0.30$.\n$$\\tau_2 = -\\frac{\\ln(u_2)}{a_1} = -\\frac{\\ln(0.30)}{0.50\\,\\mathrm{s}^{-1}}$$\nUsing the natural logarithm $\\ln(0.30) \\approx -1.2040$:\n$$\\tau_2 \\approx -\\frac{-1.2040}{0.50\\,\\mathrm{s}^{-1}} \\approx 2.4080\\,\\mathrm{s}$$\nThe second reaction event occurs at an absolute time $t_2$, which is the time of the first event plus the second waiting time.\n$$t_2 = t_1 + \\tau_2 = \\tau_1 + \\tau_2$$\nSubstituting the expressions for $\\tau_1$ and $\\tau_2$:\n$$t_2 = \\left(-\\frac{\\ln(0.80)}{3.0}\\right) + \\left(-\\frac{\\ln(0.30)}{0.50}\\right)\\,\\mathrm{s}$$\nUsing more precise values for the logarithms, $\\ln(0.80) \\approx -0.22314355$ and $\\ln(0.30) \\approx -1.20397280$:\n$$\\tau_1 \\approx \\frac{0.22314355}{3.0} \\approx 0.07438118\\,\\mathrm{s}$$\n$$\\tau_2 \\approx \\frac{1.20397280}{0.50} \\approx 2.40794560\\,\\mathrm{s}$$\n$$t_2 \\approx 0.07438118 + 2.40794560 = 2.48232678\\,\\mathrm{s}$$\nThe problem requires the final answer to be rounded to four significant figures.\n$$t_2 \\approx 2.482\\,\\mathrm{s}$$", "answer": "$$\\boxed{2.482}$$", "id": "2678042"}, {"introduction": "Mastery of stochastic algorithms involves not only knowing how to implement them but also understanding *why* they are formulated in a specific way. Plausible-sounding shortcuts or implementation errors can introduce subtle, systematic biases. This advanced practice challenges you to move from computation to analysis by quantifying the bias introduced by an intuitive but incorrect modification to the time-sampling step, where the waiting time is based on a future state's propensity rather than the current one's. This analytical derivation reinforces the theoretical integrity of the algorithm and its connection to the underlying continuous-time Markov process [@problem_id:2678083].", "problem": "Consider a single-species birth–death system in a well-stirred volume $\\Omega$ modeled as a continuous-time Markov chain (CTMC). The two reaction channels are\n$$\nR_1: \\varnothing \\xrightarrow{\\kappa_b} X,\\qquad R_2: X \\xrightarrow{\\kappa_d} \\varnothing,\n$$\nwith propensities $a_1(x) = \\Omega\\kappa_b$ and $a_2(x) = \\kappa_d x$ at state $x \\in \\mathbb{Z}_{\\ge 0}$, so that the total propensity is $a_0(x) = a_1(x)+a_2(x) = \\Omega\\kappa_b + \\kappa_d x$. Here $\\kappa_b$ and $\\kappa_d$ are positive rate constants, and $\\nu_1=+1$ and $\\nu_2=-1$ denote the state-change increments.\n\nIn the Stochastic Simulation Algorithm (SSA), also known as Gillespie’s direct method, the next-reaction waiting time $\\tau$ at state $x$ is exponentially distributed with rate $a_0(x)$, and the next reaction channel $J\\in\\{1,2\\}$ is drawn with probabilities $\\mathbb{P}(J=k\\,|\\,x)=a_k(x)/a_0(x)$. Suppose, however, that an erroneous implementation draws $J$ according to the correct probabilities at $x$ but then samples the waiting time from the exponential distribution with the post-reaction total rate, that is, from $\\mathrm{Exp}(a_0(x+\\nu_J))$.\n\nStarting from first principles for CTMCs and propensities, and assuming the regime where the relative post-reaction change in total propensity is small in magnitude, that is, $|a_0(x+\\nu_k)-a_0(x)|/a_0(x)\\ll 1$, derive to first order the unconditional bias in the expected waiting time introduced by this error, defined as\n$$\n\\mathrm{Bias}(x) := \\mathbb{E}[\\tau_{\\mathrm{wrong}}\\,|\\,x] - \\mathbb{E}[\\tau_{\\mathrm{true}}\\,|\\,x].\n$$\nExpress your final answer as a single, closed-form analytic expression in terms of $\\Omega$, $\\kappa_b$, $\\kappa_d$, and $x$. Do not introduce any additional parameters. Your answer should be a single expression; no rounding is required and no units should be reported.", "solution": "The problem as stated is scientifically grounded, well-posed, objective, and contains no logical or factual contradictions. It is a standard exercise in the analysis of stochastic simulation algorithms for chemical kinetics. Therefore, we proceed with the derivation.\n\nThe system is a continuous-time Markov chain with state $x \\in \\mathbb{Z}_{\\ge 0}$ representing the number of molecules of species $X$. The two reaction channels are a zeroth-order birth reaction, $R_1$, and a first-order death reaction, $R_2$.\n$$R_1: \\varnothing \\xrightarrow{\\kappa_b} X$$\n$$R_2: X \\xrightarrow{\\kappa_d} \\varnothing$$\nThe corresponding propensity functions are given as $a_1(x) = \\Omega\\kappa_b$ and $a_2(x) = \\kappa_d x$, where $\\Omega$ is the volume and $\\kappa_b, \\kappa_d$ are positive rate constants. The total propensity is $a_0(x) = a_1(x) + a_2(x) = \\Omega\\kappa_b + \\kappa_d x$. The state-change vectors are $\\nu_1=+1$ for reaction $R_1$ and $\\nu_2=-1$ for reaction $R_2$.\n\nWe are asked to find the first-order unconditional bias in the expected waiting time, $\\mathrm{Bias}(x) = \\mathbb{E}[\\tau_{\\mathrm{wrong}}\\,|\\,x] - \\mathbb{E}[\\tau_{\\mathrm{true}}\\,|\\,x]$.\n\nFirst, we define the expected waiting time for the correct Stochastic Simulation Algorithm (SSA). In the correct algorithm, the waiting time $\\tau_{\\mathrm{true}}$ until the next reaction, given the system is in state $x$, is drawn from an exponential distribution with rate parameter equal to the total propensity, $a_0(x)$. The expected value of an exponentially distributed random variable with rate $\\lambda$ is $1/\\lambda$. Therefore, the true expected waiting time is\n$$\n\\mathbb{E}[\\tau_{\\mathrm{true}}\\,|\\,x] = \\frac{1}{a_0(x)}.\n$$\n\nNext, we analyze the erroneous implementation. In this case, the next reaction channel $J \\in \\{1, 2\\}$ is chosen correctly with probability $\\mathbb{P}(J=k\\,|\\,x) = a_k(x)/a_0(x)$. However, the waiting time $\\tau_{\\mathrm{wrong}}$ is then drawn from an exponential distribution with a rate parameter corresponding to the total propensity of the *post-reaction* state, $a_0(x+\\nu_J)$.\n\nTo find the unconditional expected waiting time $\\mathbb{E}[\\tau_{\\mathrm{wrong}}\\,|\\,x]$, we must average over the possible outcomes for the next reaction channel $J$, using the law of total expectation:\n$$\n\\mathbb{E}[\\tau_{\\mathrm{wrong}}\\,|\\,x] = \\sum_{k=1}^{2} \\mathbb{E}[\\tau_{\\mathrm{wrong}}\\,|\\,J=k, x] \\cdot \\mathbb{P}(J=k\\,|\\,x).\n$$\nGiven that reaction $J=k$ is chosen, the waiting time is sampled from $\\mathrm{Exp}(a_0(x+\\nu_k))$. Its conditional expectation is thus:\n$$\n\\mathbb{E}[\\tau_{\\mathrm{wrong}}\\,|\\,J=k, x] = \\frac{1}{a_0(x+\\nu_k)}.\n$$\nSubstituting this and the probability $\\mathbb{P}(J=k\\,|\\,x)$ back into the formula for the unconditional expectation, we get:\n$$\n\\mathbb{E}[\\tau_{\\mathrm{wrong}}\\,|\\,x] = \\sum_{k=1}^{2} \\frac{1}{a_0(x+\\nu_k)} \\cdot \\frac{a_k(x)}{a_0(x)} = \\frac{1}{a_0(x)} \\left( \\frac{a_1(x)}{a_0(x+\\nu_1)} + \\frac{a_2(x)}{a_0(x+\\nu_2)} \\right).\n$$\nThe problem specifies the analysis is to be performed in the regime where the relative change in total propensity is small, i.e., $|a_0(x+\\nu_k) - a_0(x)|/a_0(x) \\ll 1$. This justifies a first-order Taylor series expansion of the function $f(y) = 1/y$ around the point $y_0 = a_0(x)$. The expansion is $f(y) \\approx f(y_0) + f'(y_0)(y - y_0)$. With $f'(y) = -1/y^2$, we have:\n$$\n\\frac{1}{a_0(x+\\nu_k)} \\approx \\frac{1}{a_0(x)} - \\frac{a_0(x+\\nu_k) - a_0(x)}{\\left[a_0(x)\\right]^2}.\n$$\nSubstituting this approximation into the expression for $\\mathbb{E}[\\tau_{\\mathrm{wrong}}\\,|\\,x]$:\n$$\n\\mathbb{E}[\\tau_{\\mathrm{wrong}}\\,|\\,x] \\approx \\frac{1}{a_0(x)} \\sum_{k=1}^{2} a_k(x) \\left( \\frac{1}{a_0(x)} - \\frac{a_0(x+\\nu_k) - a_0(x)}{\\left[a_0(x)\\right]^2} \\right).\n$$\nDistributing the terms:\n$$\n\\mathbb{E}[\\tau_{\\mathrm{wrong}}\\,|\\,x] \\approx \\frac{1}{\\left[a_0(x)\\right]^2} \\sum_{k=1}^{2} a_k(x) - \\frac{1}{\\left[a_0(x)\\right]^3} \\sum_{k=1}^{2} a_k(x) \\left[a_0(x+\\nu_k) - a_0(x)\\right].\n$$\nSince $\\sum_{k=1}^{2} a_k(x) = a_0(x)$, the first term simplifies to $1/a_0(x)$, which is precisely $\\mathbb{E}[\\tau_{\\mathrm{true}}\\,|\\,x]$.\n$$\n\\mathbb{E}[\\tau_{\\mathrm{wrong}}\\,|\\,x] \\approx \\frac{1}{a_0(x)} - \\frac{1}{\\left[a_0(x)\\right]^3} \\sum_{k=1}^{2} a_k(x) \\left[a_0(x+\\nu_k) - a_0(x)\\right].\n$$\nThe bias is the difference between the erroneous and true expected waiting times. To first order, this is:\n$$\n\\mathrm{Bias}(x) = \\mathbb{E}[\\tau_{\\mathrm{wrong}}\\,|\\,x] - \\mathbb{E}[\\tau_{\\mathrm{true}}\\,|\\,x] \\approx - \\frac{1}{\\left[a_0(x)\\right]^3} \\sum_{k=1}^{2} a_k(x) \\left[a_0(x+\\nu_k) - a_0(x)\\right].\n$$\nNow we must evaluate the sum for the specific birth-death system. The increments are $\\nu_1 = +1$ and $\\nu_2 = -1$. The changes in the total propensity are:\nFor $k=1$: $a_0(x+\\nu_1) - a_0(x) = a_0(x+1) - a_0(x) = (\\Omega\\kappa_b + \\kappa_d(x+1)) - (\\Omega\\kappa_b + \\kappa_d x) = \\kappa_d$.\nFor $k=2$: $a_0(x+\\nu_2) - a_0(x) = a_0(x-1) - a_0(x) = (\\Omega\\kappa_b + \\kappa_d(x-1)) - (\\Omega\\kappa_b + \\kappa_d x) = -\\kappa_d$.\n\nThe sum is therefore:\n$$\n\\sum_{k=1}^{2} a_k(x) \\left[a_0(x+\\nu_k) - a_0(x)\\right] = a_1(x)(\\kappa_d) + a_2(x)(-\\kappa_d).\n$$\nSubstituting the expressions for $a_1(x)$ and $a_2(x)$:\n$$\n(\\Omega\\kappa_b)(\\kappa_d) - (\\kappa_d x)(\\kappa_d) = \\Omega\\kappa_b\\kappa_d - \\kappa_d^2 x = \\kappa_d(\\Omega\\kappa_b - \\kappa_d x).\n$$\nFinally, substituting this result back into the expression for the bias:\n$$\n\\mathrm{Bias}(x) = - \\frac{\\kappa_d(\\Omega\\kappa_b - \\kappa_d x)}{\\left[a_0(x)\\right]^3} = \\frac{\\kappa_d(\\kappa_d x - \\Omega\\kappa_b)}{\\left[a_0(x)\\right]^3}.\n$$\nReplacing $a_0(x)$ with its definition, we arrive at the final expression for the first-order bias:\n$$\n\\mathrm{Bias}(x) = \\frac{\\kappa_d(\\kappa_d x - \\Omega\\kappa_b)}{(\\Omega\\kappa_b + \\kappa_d x)^3}.\n$$\nThis is the required closed-form analytic expression.", "answer": "$$\n\\boxed{\\frac{\\kappa_{d}(\\kappa_{d}x - \\Omega\\kappa_{b})}{(\\Omega\\kappa_{b} + \\kappa_{d}x)^{3}}}\n$$", "id": "2678083"}]}