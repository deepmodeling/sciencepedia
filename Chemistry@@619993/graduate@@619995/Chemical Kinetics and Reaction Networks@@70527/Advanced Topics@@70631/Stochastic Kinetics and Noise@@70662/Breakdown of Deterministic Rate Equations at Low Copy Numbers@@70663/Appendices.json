{"hands_on_practices": [{"introduction": "The most fundamental departure of stochastic kinetics from deterministic rate equations lies in the presence of inherent fluctuations. This first exercise provides a direct and quantitative look at this discrepancy. By analyzing a simple birth-death process, you will derive the exact variance from the Chemical Master Equation and contrast it with the prediction from a deterministic (mean-field) model, which completely neglects noise [@problem_id:2629136]. This comparison demonstrates the foundational reason why deterministic descriptions are insufficient for systems with low molecular copy numbers.", "problem": "Consider the single-species birth–death reaction network\n- Birth: $\\varnothing \\xrightarrow{\\ \\alpha\\ } A$ with propensity $a_{+}(n_A)=\\alpha$,\n- Death: $A \\xrightarrow{\\ \\beta\\ } \\varnothing$ with propensity $a_{-}(n_A)=\\beta\\,n_A$,\n\nwhere $n_A \\in \\{0,1,2,\\dots\\}$ is the molecular copy number of species $A$, and $\\alpha>0$, $\\beta>0$ are constant rate parameters. Work in the well-mixed, constant-volume limit under the chemical master equation description.\n\n1. Starting from the master-equation identity for any test function $f(n_A)$,\n$$\n\\frac{d}{dt}\\langle f(n_A)\\rangle \\;=\\; \\left\\langle \\alpha\\big(f(n_A+1)-f(n_A)\\big) \\;+\\; \\beta n_A\\big(f(n_A-1)-f(n_A)\\big) \\right\\rangle,\n$$\nderive the exact steady-state mean $\\langle n_A\\rangle$ and variance $\\operatorname{Var}(n_A)$.\n\n2. Now construct the lowest-order mean-field (deterministic) closure by neglecting fluctuations and replacing all random moments by products of means. In this closure, the only dynamical variable is the mean $m(t)=\\langle n_A(t)\\rangle$, which satisfies the deterministic rate equation $dm/dt=\\alpha-\\beta m$, and higher central moments are taken to be zero. Using this closure, determine the steady-state variance predicted by the closure, denoted $\\operatorname{Var}_{\\mathrm{mf}}(n_A)$.\n\n3. Define the relative error of the mean-field closure for the steady-state variance as\n$$\n\\varepsilon\\!\\left(\\frac{\\alpha}{\\beta}\\right)\\;=\\;\\frac{\\left|\\operatorname{Var}_{\\mathrm{mf}}(n_A)-\\operatorname{Var}(n_A)\\right|}{\\operatorname{Var}(n_A)}.\n$$\nFor the regime of low copy numbers specified by $\\alpha/\\beta\\in[1,10]$, determine the supremum (i.e., the worst-case value) of $\\varepsilon(\\alpha/\\beta)$ over this interval. Express your final answer as a pure number with no units. No rounding is required.", "solution": "The problem as stated is scientifically grounded, well-posed, and self-contained. It presents a standard, solvable problem in the field of stochastic chemical kinetics, comparing an exact stochastic description with a deterministic approximation. There are no contradictions, ambiguities, or factual errors. We shall therefore proceed with its solution.\n\nThe problem is divided into three parts. We will address each in sequence.\n\nPart 1: Exact Steady-State Mean and Variance\n\nWe are given the master-equation identity for the time evolution of the expectation of an arbitrary test function $f(n_A)$:\n$$\n\\frac{d}{dt}\\langle f(n_A)\\rangle \\;=\\; \\left\\langle \\alpha\\big(f(n_A+1)-f(n_A)\\big) \\;+\\; \\beta n_A\\big(f(n_A-1)-f(n_A)\\big) \\right\\rangle\n$$\nAt steady state, the time derivative of any expectation value is zero. Thus, for any function $f$, we have:\n$$\n\\left\\langle \\alpha\\big(f(n_A+1)-f(n_A)\\big) \\;+\\; \\beta n_A\\big(f(n_A-1)-f(n_A)\\big) \\right\\rangle = 0\n$$\n\nTo find the steady-state mean $\\langle n_A \\rangle$, we choose the test function $f(n_A) = n_A$. The corresponding differences are $f(n_A+1)-f(n_A) = (n_A+1)-n_A = 1$ and $f(n_A-1)-f(n_A) = (n_A-1)-n_A = -1$. Substituting these into the steady-state identity gives:\n$$\n\\left\\langle \\alpha(1) + \\beta n_A(-1) \\right\\rangle = 0\n$$\n$$\n\\langle \\alpha - \\beta n_A \\rangle = 0\n$$\nBy the linearity of the expectation operator, this becomes:\n$$\n\\alpha - \\beta \\langle n_A \\rangle = 0\n$$\nSolving for the mean, we find:\n$$\n\\langle n_A \\rangle = \\frac{\\alpha}{\\beta}\n$$\n\nTo find the steady-state variance, $\\operatorname{Var}(n_A) = \\langle n_A^2 \\rangle - \\langle n_A \\rangle^2$, we must first compute the second moment $\\langle n_A^2 \\rangle$. We choose the test function $f(n_A) = n_A^2$. The differences are $f(n_A+1)-f(n_A) = (n_A+1)^2-n_A^2 = 2n_A+1$ and $f(n_A-1)-f(n_A) = (n_A-1)^2-n_A^2 = -2n_A+1$. Substituting these into the steady-state identity:\n$$\n\\left\\langle \\alpha(2n_A+1) + \\beta n_A(-2n_A+1) \\right\\rangle = 0\n$$\n$$\n\\langle 2\\alpha n_A + \\alpha - 2\\beta n_A^2 + \\beta n_A \\rangle = 0\n$$\nUsing the linearity of expectation:\n$$\n(2\\alpha+\\beta)\\langle n_A \\rangle + \\alpha - 2\\beta \\langle n_A^2 \\rangle = 0\n$$\nWe solve for $\\langle n_A^2 \\rangle$:\n$$\n2\\beta \\langle n_A^2 \\rangle = (2\\alpha+\\beta)\\langle n_A \\rangle + \\alpha\n$$\nSubstituting the previously found steady-state mean $\\langle n_A \\rangle = \\alpha/\\beta$:\n$$\n2\\beta \\langle n_A^2 \\rangle = (2\\alpha+\\beta)\\left(\\frac{\\alpha}{\\beta}\\right) + \\alpha = \\frac{2\\alpha^2}{\\beta} + \\alpha + \\alpha = \\frac{2\\alpha^2}{\\beta} + 2\\alpha\n$$\n$$\n\\langle n_A^2 \\rangle = \\frac{1}{2\\beta}\\left(\\frac{2\\alpha^2}{\\beta} + 2\\alpha\\right) = \\frac{\\alpha^2}{\\beta^2} + \\frac{\\alpha}{\\beta}\n$$\nNow we compute the variance:\n$$\n\\operatorname{Var}(n_A) = \\langle n_A^2 \\rangle - \\langle n_A \\rangle^2 = \\left(\\frac{\\alpha^2}{\\beta^2} + \\frac{\\alpha}{\\beta}\\right) - \\left(\\frac{\\alpha}{\\beta}\\right)^2 = \\frac{\\alpha}{\\beta}\n$$\nThus, the exact steady-state mean and variance are both equal to $\\alpha/\\beta$. This is consistent with the known result that the steady-state distribution is a Poisson distribution with parameter $\\lambda = \\alpha/\\beta$.\n\nPart 2: Mean-Field Variance\n\nThe problem defines the \"lowest-order mean-field (deterministic) closure\" by a set of explicit rules: a) neglecting fluctuations, b) the only dynamical variable is the mean $m(t) = \\langle n_A(t) \\rangle$ evolving via $dm/dt = \\alpha - \\beta m$, and c) higher central moments are taken to be zero.\nThese conditions describe a deterministic model. In a deterministic framework, the concept of randomness is absent. The state of the system at any time is a single, well-defined value, not a probability distribution. The quantity $n_A$ is no longer a random variable but is identically equal to its mean value, $n_A(t) \\equiv m(t)$.\nThe variance of a quantity measures its spread or fluctuation around the mean. For a deterministic quantity, there are no fluctuations. The variance of a constant or a deterministically evolving variable is, by definition, zero. The condition that \"higher central moments are taken to be zero\" includes the second central moment, which is the variance. Therefore, the variance predicted by this closure is zero.\n$$\n\\operatorname{Var}_{\\mathrm{mf}}(n_A) = 0\n$$\n\nPart 3: Relative Error and its Supremum\n\nThe relative error $\\varepsilon$ of the mean-field closure for the steady-state variance is defined as:\n$$\n\\varepsilon\\!\\left(\\frac{\\alpha}{\\beta}\\right) = \\frac{\\left|\\operatorname{Var}_{\\mathrm{mf}}(n_A)-\\operatorname{Var}(n_A)\\right|}{\\operatorname{Var}(n_A)}\n$$\nSubstituting the results from Part 1 and Part 2:\n- Exact variance: $\\operatorname{Var}(n_A) = \\frac{\\alpha}{\\beta}$\n- Mean-field variance: $\\operatorname{Var}_{\\mathrm{mf}}(n_A) = 0$\n\nThe expression for the error becomes:\n$$\n\\varepsilon\\!\\left(\\frac{\\alpha}{\\beta}\\right) = \\frac{\\left|0 - \\frac{\\alpha}{\\beta}\\right|}{\\frac{\\alpha}{\\beta}}\n$$\nGiven that $\\alpha > 0$ and $\\beta > 0$, the term $\\alpha/\\beta$ is strictly positive. The denominator is non-zero for the specified range $\\alpha/\\beta \\in [1, 10]$.\nTherefore, the error simplifies to:\n$$\n\\varepsilon\\!\\left(\\frac{\\alpha}{\\beta}\\right) = \\frac{\\frac{\\alpha}{\\beta}}{\\frac{\\alpha}{\\beta}} = 1\n$$\nThe relative error is a constant function with a value of $1$. This signifies a complete failure of the deterministic model to capture the system's fluctuations.\n\nThe final task is to find the supremum of this error function over the interval $\\alpha/\\beta \\in [1, 10]$. The supremum of a constant function over any interval is simply the constant value itself.\n$$\n\\sup_{\\alpha/\\beta \\in [1, 10]} \\varepsilon\\!\\left(\\frac{\\alpha}{\\beta}\\right) = \\sup_{\\alpha/\\beta \\in [1, 10]} (1) = 1\n$$\nThe worst-case relative error is $1$.", "answer": "$$\\boxed{1}$$", "id": "2629136"}, {"introduction": "Moving beyond simple linear systems, the consequences of stochasticity become more profound. In networks with nonlinear reactions, such as dimerization, fluctuations not only exist but also feed back to influence the system's average behavior, causing the mean abundance to deviate from deterministic predictions. This practice introduces the Linear Noise Approximation (LNA) and moment-closure techniques as powerful tools to estimate this stochastic correction [@problem_id:2629190]. By working through this example, you will learn how to go beyond a simple deterministic model to obtain a more accurate picture of a system's steady state.", "problem": "Consider the irreversible dimerization system with source and first-order loss,\n$$\\varnothing \\xrightarrow{k_{0}} A,\\quad A \\xrightarrow{k_{1}} \\varnothing,\\quad A + A \\xrightarrow{k_{2}} D,$$\nin a well-mixed compartment of volume $\\,\\Omega = 1 \\,\\mathrm{fL} = 1 \\times 10^{-15}\\,\\mathrm{L}\\,$. Assume mass-action kinetics at the mesoscopic (stochastic) scale with standard system-size normalization: the propensity functions are\n$$a_{1}(n_{A}) = k_{0}\\,\\Omega,\\quad a_{2}(n_{A}) = k_{1}\\,n_{A},\\quad a_{3}(n_{A}) = \\frac{k_{2}}{\\Omega}\\,n_{A}(n_{A}-1),$$\nand the stoichiometric changes for $n_{A}$ are $\\nu_{1}=+1$, $\\nu_{2}=-1$, $\\nu_{3}=-2$. The rate constants are\n$$k_{0} = 3.5 \\times 10^{14}\\,\\mathrm{(molecules)/(L \\cdot s)},\\quad k_{1} = 1.0 \\times 10^{-3}\\,\\mathrm{s}^{-1},\\quad k_{2} = 1.6 \\times 10^{-18}\\,\\mathrm{L/(molecule \\cdot s)}.$$\n\nStarting only from the Chemical Master Equation (CME) definitions above and the mass-action law, do the following.\n\n1) Derive the deterministic rate equation for the concentration $a(t)$ of species $A$, and solve for its positive steady state $a^{\\ast}$ in closed form. Convert this to the deterministic steady-state molecule number prediction $n_{\\mathrm{det}} = \\Omega\\,a^{\\ast}$.\n\n2) Linearize the Chemical Langevin Equation (CLE) about the deterministic fixed point to obtain the one-dimensional Linear Noise Approximation (LNA) for the fluctuations of $n_{A}$. Use it to compute the stationary variance $V \\equiv \\mathrm{Var}(n_{A})$ by solving the scalar Lyapunov equation for the linearized Ornstein–Uhlenbeck process, expressed in terms of the Jacobian $J$ of the CLE drift with respect to $n_{A}$ and the diffusion intensity $B = \\sum_{r} \\nu_{r}^{2} a_{r}$, all evaluated at $n_{\\mathrm{det}}$.\n\n3) Close the exact first-moment steady-state equation\n$$0 = k_{0}\\,\\Omega - k_{1}\\,\\langle n_{A}\\rangle - \\frac{2k_{2}}{\\Omega}\\,\\big\\langle n_{A}(n_{A}-1)\\big\\rangle$$\nby the Gaussian (second-order) moment-closure\n$$\\big\\langle n_{A}(n_{A}-1)\\big\\rangle \\approx \\langle n_{A}\\rangle^{2} - \\langle n_{A}\\rangle + V,$$\nusing the variance $V$ obtained in step $2)$. Solve the resulting quadratic equation to obtain the LNA/moment-closure estimate of the stationary mean $\\langle n_{A}\\rangle$.\n\nReport the final numerical value of $\\langle n_{A}\\rangle$ for $\\Omega = 1 \\,\\mathrm{fL}$ in units of molecules. Round your answer to four significant figures. In your reasoning, also state the deterministic prediction $n_{\\mathrm{det}}$ and discuss the direction of the deviation at low copy number, but the final reported value must be your stochastic estimate for $\\langle n_{A}\\rangle$ expressed in molecules.", "solution": "The problem requires a multi-step analysis of a stochastic chemical reaction system, moving from the deterministic approximation to a more accurate stochastic estimate using the Linear Noise Approximation and moment closure.\n\nStep 1: Deterministic Rate Equation and Steady State\n\nThe deterministic model describes the evolution of the concentration of species $A$, denoted by $a(t) = n_{A}(t)/\\Omega$, where $n_A$ is the number of molecules of $A$ and $\\Omega$ is the system volume. The rate equation is derived by considering the macroscopic reaction rates per unit volume. The source reaction $\\varnothing \\rightarrow A$ contributes a term $+k_0$. The first-order loss $A \\rightarrow \\varnothing$ contributes a term $-k_1 a$. The dimerization $A + A \\rightarrow D$ consumes two molecules of $A$ and contributes a term $-2k_2 a^2$. The full rate equation is:\n$$ \\frac{da}{dt} = k_{0} - k_{1}a - 2k_{2}a^{2} $$\nAt steady state, $\\frac{da}{dt}=0$, which yields a quadratic equation for the steady-state concentration $a^{\\ast}$:\n$$ 2k_{2}(a^{\\ast})^{2} + k_{1}a^{\\ast} - k_{0} = 0 $$\nSolving for the physically meaningful positive root gives:\n$$ a^{\\ast} = \\frac{-k_{1} + \\sqrt{k_{1}^{2} - 4(2k_{2})(-k_{0})}}{4k_{2}} = \\frac{-k_{1} + \\sqrt{k_{1}^{2} + 8k_{0}k_{2}}}{4k_{2}} $$\nThe deterministic prediction for the steady-state number of molecules is $n_{\\mathrm{det}} = \\Omega a^{\\ast}$. Substituting the given values:\n$k_{0} = 3.5 \\times 10^{14}\\,\\mathrm{(molecules)/(L \\cdot s)}$, $k_{1} = 1.0 \\times 10^{-3}\\,\\mathrm{s}^{-1}$, $k_{2} = 1.6 \\times 10^{-18}\\,\\mathrm{L/(molecule \\cdot s)}$, and $\\Omega = 1 \\times 10^{-15}\\,\\mathrm{L}$.\nA more direct way to compute $n_{\\mathrm{det}}$ is to use scaled parameters $k_0' = k_0\\Omega = 0.35\\,\\mathrm{s^{-1}}$ and $k_2' = k_2/\\Omega = 1.6 \\times 10^{-3}\\,\\mathrm{(\\text{molecule} \\cdot s)^{-1}}$. Multiplying the concentration equation by $\\Omega$, we get an equation for $n(t) = \\Omega a(t)$:\n$ \\frac{dn}{dt} = k_0 \\Omega - k_1 n - 2 \\frac{k_2}{\\Omega} n^2 $. At steady state, $n=n_{\\mathrm{det}}$:\n$$ 2\\left(\\frac{k_{2}}{\\Omega}\\right)n_{\\mathrm{det}}^{2} + k_{1}n_{\\mathrm{det}} - k_{0}\\Omega = 0 $$\n$$ 2(1.6 \\times 10^{-3}) n_{\\mathrm{det}}^{2} + (1.0 \\times 10^{-3})n_{\\mathrm{det}} - 0.35 = 0 $$\n$$ 0.0032\\,n_{\\mathrm{det}}^{2} + 0.001\\,n_{\\mathrm{det}} - 0.35 = 0 $$\nSolving for the positive root:\n$$ n_{\\mathrm{det}} = \\frac{-0.001 + \\sqrt{(0.001)^{2} - 4(0.0032)(-0.35)}}{2(0.0032)} = \\frac{-0.001 + \\sqrt{0.000001 + 0.00448}}{0.0064} \\approx 10.303 $$\nThe deterministic prediction is $n_{\\mathrm{det}} \\approx 10.30$ molecules.\n\nStep 2: Linear Noise Approximation and Stationary Variance\n\nThe Chemical Langevin Equation (CLE) describes the evolution of the number of molecules $n_{A}(t)$ as a stochastic differential equation:\n$$ dn_{A} = A(n_{A})dt + \\sqrt{B(n_{A})}dW(t) $$\nThe drift term $A(n_{A})$ is the sum of stoichiometric changes weighted by propensities:\n$$ A(n_{A}) = \\sum_{r=1}^{3} \\nu_{r}a_{r}(n_{A}) = (+1)k_{0}\\Omega + (-1)k_{1}n_{A} + (-2)\\frac{k_{2}}{\\Omega}n_{A}(n_{A}-1) $$\n$$ A(n_{A}) = k_{0}\\Omega - k_{1}n_{A} - \\frac{2k_{2}}{\\Omega}n_{A}(n_{A}-1) $$\nThe diffusion term's intensity $B(n_{A})$ is the sum of squared stoichiometric changes weighted by propensities:\n$$ B(n_{A}) = \\sum_{r=1}^{3} \\nu_{r}^{2}a_{r}(n_{A}) = (+1)^{2}k_{0}\\Omega + (-1)^{2}k_{1}n_{A} + (-2)^{2}\\frac{k_{2}}{\\Omega}n_{A}(n_{A}-1) $$\n$$ B(n_{A}) = k_{0}\\Omega + k_{1}n_{A} + \\frac{4k_{2}}{\\Omega}n_{A}(n_{A}-1) $$\nThe Linear Noise Approximation (LNA) linearizes the CLE around the deterministic fixed point $n_{\\mathrm{det}}$. The dynamics of fluctuations $\\xi = n_{A} - n_{\\mathrm{det}}$ are approximated by an Ornstein-Uhlenbeck process $d\\xi = J\\xi dt + \\sqrt{B}dW$, where the Jacobian $J$ and diffusion coefficient $B$ are constants evaluated at $n_{\\mathrm{det}}$.\nThe Jacobian is the derivative of the drift term:\n$$ J = \\frac{dA}{dn_{A}}\\bigg|_{n_{A}=n_{\\mathrm{det}}} = -k_{1} - \\frac{2k_{2}}{\\Omega}(2n_{\\mathrm{det}}-1) $$\nUsing $n_{\\mathrm{det}} \\approx 10.303$, $k_{1}=0.001$, and $k_2/\\Omega=0.0016$:\n$$ J \\approx -0.001 - 2(0.0016)(2(10.303)-1) = -0.001 - 0.0032(19.606) \\approx -0.06374 $$\nThe diffusion coefficient is evaluated at $n_{\\mathrm{det}}$:\n$$ B = B(n_{\\mathrm{det}}) = k_{0}\\Omega + k_{1}n_{\\mathrm{det}} + \\frac{4k_{2}}{\\Omega}n_{\\mathrm{det}}(n_{\\mathrm{det}}-1) $$\nUsing $k_0 \\Omega = 0.35$ and other values:\n$$ B \\approx 0.35 + (0.001)(10.303) + 4(0.0016)(10.303)(9.303) \\approx 0.35 + 0.0103 + 0.6134 \\approx 0.9737 $$\nThe stationary variance $V = \\mathrm{Var}(n_A)$ of the LNA process obeys the scalar Lyapunov equation $2JV + B = 0$, which gives:\n$$ V = -\\frac{B}{2J} \\approx -\\frac{0.9737}{2(-0.06374)} \\approx 7.638 $$\n\nStep 3: Moment Closure and Stochastic Mean\n\nThe exact equation for the time evolution of the mean $\\langle n_A \\rangle$ is derived from the CME:\n$$ \\frac{d\\langle n_A \\rangle}{dt} = \\langle A(n_A) \\rangle = k_{0}\\Omega - k_{1}\\langle n_A \\rangle - \\frac{2k_2}{\\Omega}\\langle n_A(n_A-1) \\rangle $$\nAt steady state, $\\frac{d\\langle n_A \\rangle}{dt} = 0$. The problem provides the second-order (Gaussian) moment-closure approximation:\n$$ \\langle n_A(n_A-1) \\rangle \\approx \\langle n_A \\rangle^2 - \\langle n_A \\rangle + V $$\nwhere $V$ is the variance calculated from the LNA. Substituting this into the steady-state moment equation yields a closed equation for $x = \\langle n_A \\rangle$:\n$$ 0 = k_0\\Omega - k_1 x - \\frac{2k_2}{\\Omega}(x^2 - x + V) $$\nRearranging into standard quadratic form $Ax^2+Bx+C=0$:\n$$ \\left(\\frac{2k_2}{\\Omega}\\right)x^2 + \\left(k_1 - \\frac{2k_2}{\\Omega}\\right)x - \\left(k_0\\Omega - \\frac{2k_2}{\\Omega}V\\right) = 0 $$\nSubstituting the numerical values: $k_0 \\Omega = 0.35$, $k_1 = 0.001$, $k_2/\\Omega=0.0016$, and $V \\approx 7.638$.\n$$ (2 \\times 0.0016)x^2 + (0.001 - 2 \\times 0.0016)x - (0.35 - 2 \\times 0.0016 \\times 7.638) = 0 $$\n$$ 0.0032\\,x^2 - 0.0022\\,x - (0.35 - 0.02444) = 0 $$\n$$ 0.0032\\,x^2 - 0.0022\\,x - 0.32556 = 0 $$\nSolving for the positive root $x = \\langle n_A \\rangle$:\n$$ \\langle n_A \\rangle = \\frac{-(-0.0022) + \\sqrt{(-0.0022)^2 - 4(0.0032)(-0.32556)}}{2(0.0032)} $$\n$$ \\langle n_A \\rangle = \\frac{0.0022 + \\sqrt{4.84 \\times 10^{-6} + 0.004167}}{0.0064} = \\frac{0.0022 + \\sqrt{0.004172}}{0.0064} \\approx \\frac{0.0022 + 0.06459}{0.0064} \\approx 10.436 $$\nRounding to four significant figures, the stochastic estimate for the stationary mean is $\\langle n_A \\rangle \\approx 10.44$ molecules.\n\nThe stochastic mean, $\\langle n_A \\rangle \\approx 10.44$, is higher than the deterministic prediction, $n_{\\mathrm{det}} \\approx 10.30$. This deviation is characteristic of systems with nonlinear reactions at low copy numbers. The difference arises because the deterministic model approximates the average of a nonlinear function with the function of the average, i.e., $\\langle n_A^2 \\rangle \\approx \\langle n_A \\rangle^2$. The stochastic analysis corrects this. The mean rate of the dimerization reaction depends on $\\langle n_A(n_A-1) \\rangle = \\langle n_A \\rangle^2 - \\langle n_A \\rangle + V$. The deterministic rate depends effectively on $n_{\\mathrm{det}}^2$. The correction to the quadratic part of the rate is approximately $V - \\langle n_A \\rangle$. For this system, $V \\approx 7.64$ and $\\langle n_A \\rangle \\approx 10.44$, so the correction is negative. This implies that the actual average rate of dimerization is lower than what the simple deterministic model predicts for the same population size. To balance the constant production rate, the system must therefore sustain a higher average number of molecules.", "answer": "$$\\boxed{10.44}$$", "id": "2629190"}, {"introduction": "Classical chemical kinetics often assumes a well-mixed environment, where molecules are always available to react. This assumption breaks down dramatically in spatially organized systems, especially when reactant numbers are low. This final practice explores the critical interplay between reaction and diffusion by modeling a bimolecular reaction in a two-compartment system [@problem_id:2629166]. You will calculate the expected time for the first reaction to occur, revealing its strong dependence on the diffusion rate and illustrating how spatial constraints can become the limiting factor for reactions, a phenomenon that cannot be captured by simple deterministic rate equations.", "problem": "Consider a bimolecular reaction-diffusion system with two well-stirred voxels (compartments) of equal volume. Species $A$ and $B$ react only when co-located in the same voxel via the irreversible reaction $A + B \\to C$ with stochastic mass-action kinetics. Let the stochastic rate constant be $k$ in units of $\\mathrm{s}^{-1}$ per co-located pair. Each individual molecule of either species independently diffuses between the two voxels as a symmetric jump process with per-molecule hopping rate $D$ in units of $\\mathrm{s}^{-1}$. Initially, there are $n_A=(5,0)$ molecules of $A$ and $n_B=(0,5)$ molecules of $B$ in voxels $1$ and $2$, respectively; that is, voxel $1$ contains $5$ molecules of $A$ and $0$ molecules of $B$, while voxel $2$ contains $0$ molecules of $A$ and $5$ molecules of $B$. There are no molecules of $C$ initially, and the process stops at the first occurrence of the reaction $A + B \\to C$.\n\nYour task is to compute, from first principles, the expected time to the first reaction event as a function of the diffusion rate $D$. You must model the system as a continuous-time Markov chain on discrete copy numbers in each voxel under the Chemical Master Equation (CME) framework, where:\n- If there are $x$ molecules of $A$ and $y$ molecules of $B$ in voxel $1$ (so that there are $5-x$ molecules of $A$ and $5-y$ molecules of $B$ in voxel $2$), then the total reaction propensity (hazard) is\n$$\nr(x,y) = k\\,[x\\,y + (5-x)\\,(5-y)].\n$$\n- Diffusion propensities are:\n  - For species $A$: $x \\to x-1$ at rate $D\\,x$ and $x \\to x+1$ at rate $D\\,(5-x)$.\n  - For species $B$: $y \\to y-1$ at rate $D\\,y$ and $y \\to y+1$ at rate $D\\,(5-y)$.\n- The state is absorbed (the process stops) when the reaction fires; you are to compute the expected time to this absorbing event starting from $(x,y)=(5,0)$.\n\nStarting only from the core definitions of the Chemical Master Equation and continuous-time Markov chains:\n- Formulate the generator for the transient state space $(x,y)\\in\\{0,1,2,3,4,5\\}^2$.\n- Derive the backward equations for the expected absorption time $T(x,y)$ with boundary condition equal to zero upon absorption.\n- Solve the resulting linear system to obtain $T(5,0)$.\n\nUse the numerical value $k=0.1\\,\\mathrm{s}^{-1}$. Express the expected time in seconds, as a real number.\n\nTest Suite:\nEvaluate the expected time to the first reaction event for the following diffusion rates (all in $\\mathrm{s}^{-1}$):\n- $D=0.0$ (boundary case),\n- $D=0.001$,\n- $D=0.05$,\n- $D=1.0$,\n- $D=50.0$.\n\nFinal Output Format:\nYour program must compute the expected time for each of the five $D$ values above and produce a single line of output containing a Python-style list of the five results in seconds, each rounded to six decimal places. If the expected time is infinite, output it as a floating-point infinity (for example, $+\\infty$ should be represented as inf). The final output must have the form:\n\"[t1,t2,t3,t4,t5]\"\nwhere $t1$ corresponds to $D=0.0$, $t2$ to $D=0.001$, $t3$ to $D=0.05$, $t4$ to $D=1.0$, and $t5$ to $D=50.0$.", "solution": "The problem asks for the expected time to the first reaction event for a bimolecular reaction-diffusion system in two voxels. This is a classic problem of calculating the mean first passage time (MFPT) to an absorbing state in a continuous-time Markov chain (CTMC).\n\nFirst, we formalize the state space and the dynamics. The state of the system is defined by the number of molecules of species $A$ and $B$ in the first voxel. Let $x$ be the number of molecules of $A$ in voxel $1$, and $y$ be the number of molecules of $B$ in voxel $1$. Since the total number of molecules of each species is conserved (until a reaction occurs), with $N_A = 5$ and $N_B = 5$, the number of molecules in voxel $2$ is $5-x$ for species $A$ and $5-y$ for species $B$. The state space is therefore $(x,y) \\in \\{0, 1, 2, 3, 4, 5\\} \\times \\{0, 1, 2, 3, 4, 5\\}$, comprising a total of $6 \\times 6 = 36$ discrete states.\n\nThe process is a CTMC on this state space. Transitions between states occur due to diffusion, while absorption occurs due to reaction. The propensities (rates) for these events are given:\n- Diffusion of $A$ from voxel $1$ to $2$: $x \\to x-1$, rate $a_{x-1,y}(x,y) = D\\,x$.\n- Diffusion of $A$ from voxel $2$ to $1$: $x \\to x+1$, rate $a_{x+1,y}(x,y) = D\\,(5-x)$.\n- Diffusion of $B$ from voxel $1$ to $2$: $y \\to y-1$, rate $a_{x,y-1}(x,y) = D\\,y$.\n- Diffusion of $B$ from voxel $2$ to $1$: $y \\to y+1$, rate $a_{x,y+1}(x,y) = D\\,(5-y)$.\n\nThe process terminates (is absorbed) upon the first reaction event. The total reaction rate in state $(x,y)$ is the sum of reaction rates in both voxels:\n$$ r(x,y) = k\\,x\\,y + k\\,(5-x)(5-y) $$\nThis rate $r(x,y)$ is the rate of absorption from state $(x,y)$.\n\nLet $T(x,y)$ be the expected time to the first reaction (absorption), given the system is initially in state $(x,y)$. We can derive a set of linear equations for $T(x,y)$ using the backward Kolmogorov equations for the MFPT. For any transient state $i$, the expected time $T_i$ satisfies the relation:\n$$ -1 = \\sum_{j} Q_{ij} T_j $$\nwhere $Q$ is the generator matrix of the process. In our context, the states are $(x,y)$ and $Q$ is the generator of the transient process. The elements of $Q$ are:\n$Q_{(x,y) \\to (x',y')}$ is the rate of transition from $(x,y)$ to a different state $(x',y')$. These are the diffusion propensities.\n$Q_{(x,y) \\to (x,y)}$ is the negative of the total rate of leaving state $(x,y)$, which includes both diffusion and reaction.\nThe total rate of leaving state $(x,y)$ is $\\lambda(x,y)$:\n$$ \\lambda(x,y) = \\left( \\sum_{(x',y') \\neq (x,y)} a_{(x',y')}(x,y) \\right) + r(x,y) $$\n$$ \\lambda(x,y) = D\\,x + D\\,(5-x) + D\\,y + D\\,(5-y) + k[xy + (5-x)(5-y)] $$\n$$ \\lambda(x,y) = 10D + k[xy + (5-x)(5-y)] $$\nThe diagonal elements of the generator are $Q_{(x,y)\\to(x,y)} = -\\lambda(x,y)$.\n\nThe backward equation for $T(x,y)$ is therefore:\n$$ -1 = -\\lambda(x,y) T(x,y) + D\\,x\\,T(x-1,y) + D\\,(5-x)\\,T(x+1,y) + D\\,y\\,T(x,y-1) + D\\,(5-y)T(x,y+1) $$\nHere, we take $T(\\cdot,\\cdot)=0$ if a state is outside the defined state space boundaries (e.g., $x<0$ or $x>5$).\nRearranging this equation, we obtain a linear system:\n$$ \\lambda(x,y) T(x,y) - D\\,x\\,T(x-1,y) - D\\,(5-x)\\,T(x+1,y) - D\\,y\\,T(x,y-1) - D\\,(5-y)T(x,y+1) = 1 $$\nThis system must hold for every state $(x,y)$ in our $36$-state space. This can be expressed in matrix form as $A \\mathbf{T} = \\mathbf{1}$, where $\\mathbf{T}$ is a column vector of the $36$ unknown values $T(x,y)$, $\\mathbf{1}$ is a column vector of ones, and $A$ is a $36 \\times 36$ matrix of coefficients.\nIf we order the states $(x,y)$ using a single index $i = 6x+y$, the matrix $A$ has elements:\n- Diagonal elements: $A_{i,i} = \\lambda(x,y) = 10D + k[xy + (5-x)(5-y)]$.\n- Off-diagonal elements for $i = 6x+y$:\n  - $A_{i, 6(x-1)+y} = -D\\,x$ for $x > 0$.\n  - $A_{i, 6(x+1)+y} = -D\\,(5-x)$ for $x < 5$.\n  - $A_{i, 6x+(y-1)} = -D\\,y$ for $y > 0$.\n  - $A_{i, 6x+(y+1)} = -D\\,(5-y)$ for $y < 5$.\n  - All other off-diagonal elements are $0$.\n\nWe must solve this linear system for the given values of $D$ and $k=0.1\\,\\mathrm{s}^{-1}$. The initial state is $(x,y)=(5,0)$, which corresponds to index $i = 6 \\cdot 5 + 0 = 30$. We need to find $T(5,0)$.\n\nConsider the special case $D=0.0\\,\\mathrm{s}^{-1}$.\nWhen $D=0$, there is no diffusion. The states are decoupled. The matrix $A$ becomes diagonal with elements $A_{i,i} = \\lambda(x,y) = r(x,y) = k[xy + (5-x)(5-y)]$.\nThe system of equations reduces to $r(x,y) T(x,y) = 1$ for each state.\nThe initial state is $(5,0)$. The reaction rate in this state is $r(5,0) = k[5 \\cdot 0 + (5-5)(5-0)] = 0$.\nThe equation for $T(5,0)$ is $0 \\cdot T(5,0) = 1$, which is impossible. Physically, if the system starts in a state with zero reaction rate and there is no mechanism (diffusion) to move to a different state, the reaction will never occur. The expected time to the reaction is infinite. Thus, for $D=0$, $T(5,0) = \\infty$. The matrix $A$ is singular in this case, which is consistent.\n\nFor $D > 0$, diffusion connects all states. Since there exist states with non-zero reaction rates (e.g., $(1,1)$ where $r(1,1)=k(1+16)=1.7\\,\\mathrm{s}^{-1} > 0$), any initial state can eventually reach an absorbing (reacting) state. Therefore, the MFPT is finite for any $D>0$, and the matrix $A$ will be non-singular.\n\nWe can also consider the limit $D \\to \\infty$. In this limit, diffusion is much faster than reaction, leading to a well-mixed system. The molecules of each species are distributed binomially between the two voxels. The probability of a molecule being in voxel $1$ is $p=1/2$. The number of $A$ molecules, $x$, follows $\\mathrm{Binomial}(5, 1/2)$, and similarly for $y$. The average number of molecules is $\\langle x \\rangle = 5 \\cdot 1/2 = 2.5$ and $\\langle y \\rangle = 5 \\cdot 1/2 = 2.5$.\nThe average reaction rate is $\\langle r \\rangle = k[\\langle x \\rangle \\langle y \\rangle + \\langle 5-x \\rangle \\langle 5-y \\rangle] = k[2.5^2 + 2.5^2] = 12.5k$.\nWith $k=0.1\\,\\mathrm{s}^{-1}$, $\\langle r \\rangle = 1.25\\,\\mathrm{s}^{-1}$. The expected time to reaction in this well-mixed limit is approximately $1/\\langle r \\rangle = 1/1.25 = 0.8\\,\\mathrm{s}$. We expect the result for $D=50.0$ to approach this value, as $D \\gg k$.\n\nTo find the exact values, we construct the $36 \\times 36$ matrix $A$ for each given $D>0$, form the vector $\\mathbf{b}$ of all ones, and solve the linear system $A \\mathbf{T} = \\mathbf{b}$ for the vector of expected times $\\mathbf{T}$. The answer for each case is the element of $\\mathbf{T}$ corresponding to the initial state $(5,0)$.", "answer": "```\n[inf,200.800008,4.800080,0.880008,0.816000]\n```", "id": "2629166"}]}