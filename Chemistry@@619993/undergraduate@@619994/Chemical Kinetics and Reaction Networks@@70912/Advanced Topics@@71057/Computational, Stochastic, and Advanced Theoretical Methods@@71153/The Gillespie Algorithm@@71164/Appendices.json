{"hands_on_practices": [{"introduction": "The best way to understand an algorithm is to execute it. This first exercise guides you through a complete, single step of the Gillespie simulation for a simple degradation reaction. By using provided random numbers, you will calculate both the time $ \\tau $ at which the next reaction occurs and how the system's state changes, revealing the core mechanics in action [@problem_id:1518694].", "problem": "In a simplified model of gene expression within a single cell, the degradation of a specific protein, denoted as A, is considered. This degradation process is modeled as a unimolecular reaction $A \\rightarrow \\emptyset$, where one molecule of protein A is eliminated from the system. The stochastic rate constant for this reaction is given as $k = 0.500 \\text{ s}^{-1}$.\n\nAt time $t=0$, the cell contains exactly $N_A(0) = 2$ molecules of protein A. To simulate the time evolution of this system, we will perform one step of the Gillespie algorithm (also known as the stochastic simulation algorithm). For this first step, two random numbers, $r_1$ and $r_2$, have been drawn from a uniform distribution on the interval $(0, 1)$. Their values are $r_1 = 0.350$ and $r_2 = 0.810$.\n\nDetermine the time $\\tau$ at which the first degradation event will occur and the number of molecules of protein A, $N_A(\\tau)$, remaining in the system immediately after this single event. Your final answer should be a pair of numbers corresponding to the time $\\tau$ and the final molecule count $N_A(\\tau)$. Express the time $\\tau$ in seconds, rounded to three significant figures.", "solution": "We model the single reaction $A \\rightarrow \\emptyset$ with stochastic rate constant $k$ as a unimolecular reaction whose propensity at state $N_{A}(t)$ is given by the standard Gillespie definition for unimolecular reactions:\n$$\na_{1}(t) = k\\,N_{A}(t).\n$$\nSince there is only one reaction channel, the total propensity is\n$$\na_{0}(t) = a_{1}(t) = k\\,N_{A}(t).\n$$\nAt $t=0$, we have $N_{A}(0) = 2$, so\n$$\na_{0}(0) = k \\times 2.\n$$\nThe Gillespie waiting time to the next reaction is drawn as\n$$\n\\tau = \\frac{1}{a_{0}(0)}\\,\\ln\\!\\left(\\frac{1}{r_{1}}\\right) = \\frac{1}{2k}\\,\\ln\\!\\left(\\frac{1}{r_{1}}\\right).\n$$\nSubstituting $k = 0.500 \\text{ s}^{-1}$ and $r_{1} = 0.350$ gives\n$$\na_{0}(0) = 2k = 1.000 \\text{ s}^{-1}, \\quad \\tau = \\frac{1}{1.000}\\,\\ln\\!\\left(\\frac{1}{0.350}\\right) = \\ln\\!\\left(\\frac{20}{7}\\right) \\text{ s}.\n$$\nNumerically, $\\ln(20) - \\ln(7) \\approx 1.04982212449$, so to three significant figures,\n$$\n\\tau \\approx 1.05 \\text{ s}.\n$$\nTo choose the reaction channel, we use the second random number $r_{2}$ and the standard selection rule with cumulative propensities. Here there is only one channel, so it is always selected because the cumulative sum $a_{1}(0) = a_{0}(0)$ exceeds $r_{2}a_{0}(0)$ for any $r_{2} \\in (0,1)$. Therefore, the reaction $A \\rightarrow \\emptyset$ occurs, decreasing the molecule count by one:\n$$\nN_{A}(\\tau) = N_{A}(0) - 1 = 1.\n$$\nThus, the time and updated count after this single Gillespie step are $\\tau = 1.05$ (in seconds, to three significant figures) and $N_{A}(\\tau) = 1$.", "answer": "$$\\boxed{\\begin{pmatrix} 1.05 & 1 \\end{pmatrix}}$$", "id": "1518694"}, {"introduction": "In any realistic biochemical network, multiple reaction pathways often compete with each other. This practice focuses on a critical decision point within the Gillespie algorithm: how to choose which reaction will fire next. You will apply the selection rule to a system with two competing reactions, gaining insight into how their relative propensities, $a_j$, probabilistically determine the system's trajectory [@problem_id:1518714].", "problem": "In the study of biochemical networks, the Gillespie algorithm provides a way to stochastically simulate the time evolution of a system of chemical reactions. Consider a simplified model of a protein that can exist in either an inactive state, $S$, or an active state, $S^*$. The protein can switch between these two states via two elementary reactions:\n\n*   **Reaction 1 (Activation):** $S \\to S^*$\n*   **Reaction 2 (Deactivation):** $S^* \\to S$\n\nAt a particular moment in time, the propensity for the activation reaction is measured to be $a_1 = 2.0 \\, \\text{s}^{-1}$, and the propensity for the deactivation reaction is $a_2 = 3.0 \\, \\text{s}^{-1}$. The propensity of a reaction can be understood as its instantaneous probability rate of occurring.\n\nThe Gillespie algorithm proceeds in steps. In each step, it determines which reaction will occur next. This choice is made by comparing a uniformly distributed random number, $r_2$, from the interval $(0, 1)$, against the cumulative sum of propensities. Specifically, the next reaction to occur is the one with the smallest index $\\mu$ that satisfies the inequality $\\sum_{j=1}^{\\mu} a_j > r_2 a_0$, where $a_0$ is the sum of all reaction propensities.\n\nGiven that for the current simulation step the random number for reaction selection is $r_2 = 0.50$, which reaction is selected to occur next?\n\nA. Reaction 1 (Activation)\n\nB. Reaction 2 (Deactivation)\n\nC. Both reactions occur simultaneously.\n\nD. Neither reaction occurs in this step.\n\nE. The outcome cannot be determined from the information given.", "solution": "We are given two reactions with propensities $a_{1}$ and $a_{2}$, and a random number $r_{2}$ used for reaction selection in the Gillespie algorithm. The selection rule is: choose the smallest index $\\mu$ such that\n$$\n\\sum_{j=1}^{\\mu} a_{j} > r_{2} a_{0},\n$$\nwhere\n$$\na_{0} = \\sum_{j=1}^{2} a_{j}.\n$$\nThe given propensities are $a_{1} = 2.0\\,\\text{s}^{-1}$ and $a_{2} = 3.0\\,\\text{s}^{-1}$, so\n$$\na_{0} = a_{1} + a_{2} = 2.0\\,\\text{s}^{-1} + 3.0\\,\\text{s}^{-1} = 5.0\\,\\text{s}^{-1}.\n$$\nWith $r_{2} = 0.50$, compute the threshold:\n$$\nr_{2} a_{0} = 0.50 \\times 5.0\\,\\text{s}^{-1} = 2.5\\,\\text{s}^{-1}.\n$$\nNow evaluate the cumulative sums:\n$$\n\\sum_{j=1}^{1} a_{j} = a_{1} = 2.0\\,\\text{s}^{-1}.\n$$\nCheck the inequality for $\\mu=1$:\n$$\n2.0\\,\\text{s}^{-1} > 2.5\\,\\text{s}^{-1} \\quad \\text{is false}.\n$$\nNext,\n$$\n\\sum_{j=1}^{2} a_{j} = a_{1} + a_{2} = 5.0\\,\\text{s}^{-1}.\n$$\nCheck the inequality for $\\mu=2$:\n$$\n5.0\\,\\text{s}^{-1} > 2.5\\,\\text{s}^{-1} \\quad \\text{is true}.\n$$\nTherefore, the smallest index $\\mu$ satisfying the selection criterion is $\\mu=2$, which corresponds to Reaction 2 (Deactivation). In the Gillespie algorithm, exactly one reaction fires at each step given finite propensities and a random number in the open interval $(0,1)$, so simultaneous occurrence or no reaction are not applicable here.", "answer": "$$\\boxed{B}$$", "id": "1518714"}, {"introduction": "The power of the Gillespie algorithm lies in its foundation on first principles, but this requires us to first correctly define the propensity function for each reaction. This problem moves beyond using given propensities to deriving them from the ground up. You will determine the propensity for a reaction involving multiple reactants, a task that reveals the crucial role of combinatorics in counting the number of possible reacting molecular combinations [@problem_id:1518692].", "problem": "Consider a well-mixed chemical system of fixed volume $V$ containing two molecular species, A and B. A chemical reaction can occur where two molecules of A combine with one molecule of B to produce a single molecule of a product C. The reaction is represented by the stoichiometry $2A + B \\rightarrow C$.\n\nThe system currently contains $n_A$ molecules of species A and $n_B$ molecules of species B.\n\nLet $c$ be the fundamental stochastic rate constant. This constant represents the probability per unit time that a specific, pre-selected triplet of reactant molecules (i.e., a specific pair of A molecules and a specific B molecule) will react.\n\nYour task is to determine the total propensity function, $a(n_A, n_B)$, for this reaction. The propensity function is defined such that $a(n_A, n_B) \\, dt$ is the probability that the reaction $2A + B \\rightarrow C$ will occur somewhere in the volume $V$ within the next infinitesimal time interval $[t, t+dt)$.\n\nExpress your answer as a closed-form analytic expression in terms of $n_A$, $n_B$, and the constant $c$.", "solution": "The propensity function is defined so that $a(n_{A},n_{B})\\,dt$ equals the probability that a reaction event occurs in $[t,t+dt)$. By definition of the fundamental stochastic rate constant $c$, a specific, pre-selected triplet of reactants (a specific pair of A molecules and a specific B molecule) reacts with probability $c\\,dt$ in the interval $[t,t+dt)$. \n\nIn a well-mixed system with $n_{A}$ molecules of A and $n_{B}$ molecules of B, the total number of distinct reactant triplets is the number of ways to choose an unordered pair of A molecules times the number of ways to choose one B molecule. The number of unordered pairs of A is $\\binom{n_{A}}{2}$, and the number of choices for B is $n_{B}$. Hence, the total number of distinct triplets is\n$$\n\\binom{n_{A}}{2}\\,n_{B}.\n$$\nFor an infinitesimal $dt$, the probability that two or more such triplets react is of order $dt^{2}$ and negligible. Therefore, the total probability that any one of these triplets reacts in $[t,t+dt)$ is the sum of their individual probabilities:\n$$\na(n_{A},n_{B})\\,dt \\;=\\; \\left[c \\times \\binom{n_{A}}{2}\\,n_{B}\\right] dt.\n$$\nThus, the propensity function is\n$$\na(n_{A},n_{B}) \\;=\\; c\\,\\binom{n_{A}}{2}\\,n_{B} \\;=\\; c\\,\\frac{n_{A}(n_{A}-1)}{2}\\,n_{B}.\n$$\nIf $n_{A}<2$ or $n_{B}<1$, this expression correctly yields zero via the binomial coefficient.", "answer": "$$\\boxed{c\\,\\binom{n_{A}}{2}\\,n_{B}}$$", "id": "1518692"}]}