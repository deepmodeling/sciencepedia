{"hands_on_practices": [{"introduction": "In analytical measurements, random noise can often obscure a weak signal. One of the most fundamental and effective techniques to overcome this is signal averaging, also known as ensemble averaging. By repeatedly measuring the same signal and averaging the results, the coherent signal component grows stronger while the random, uncorrelated noise tends to cancel out. This practice [@problem_id:1471994] demonstrates the direct mathematical relationship between the number of averaged scans, $N$, and the resulting improvement in the signal-to-noise ratio ($S/N$), which scales with $\\sqrt{N}$.", "problem": "An analytical chemist is using a spectroscopic technique to detect a trace amount of a specific environmental pollutant in a river water sample. The instrument noise, which is primarily random thermal noise, is significant relative to the weak signal from the pollutant. A preliminary analysis consisting of a single rapid scan produces a spectrum where the characteristic peak of the pollutant has a signal-to-noise ratio (S/N) of 3.0. To ensure a confident identification and quantification, the laboratory's protocol requires that the S/N for this peak be improved to a value of at least 30. This can be achieved by acquiring multiple scans and averaging them. Assuming the signal is coherent and the noise is random and uncorrelated between scans, determine the minimum number of scans that must be collected and averaged to achieve the target $S/N$ of 30.", "solution": "For multiple scans with coherent signal and random, uncorrelated noise, averaging $N$ scans reduces the noise standard deviation by a factor $\\sqrt{N}$ while leaving the mean signal unchanged. Therefore, the signal-to-noise ratio scales as\n$$\n\\left(\\frac{S}{N}\\right)_{N}=\\left(\\frac{S}{N}\\right)_{1}\\sqrt{N}.\n$$\nLet the single-scan value be $\\left(\\frac{S}{N}\\right)_{1}=3$ and the target be $\\left(\\frac{S}{N}\\right)_{\\text{target}}=30$. The requirement is\n$$\n\\left(\\frac{S}{N}\\right)_{1}\\sqrt{N}\\geq \\left(\\frac{S}{N}\\right)_{\\text{target}} \\quad \\Longrightarrow \\quad \\sqrt{N}\\geq \\frac{\\left(\\frac{S}{N}\\right)_{\\text{target}}}{\\left(\\frac{S}{N}\\right)_{1}}.\n$$\nSquaring both sides gives\n$$\nN \\geq \\left(\\frac{\\left(\\frac{S}{N}\\right)_{\\text{target}}}{\\left(\\frac{S}{N}\\right)_{1}}\\right)^{2}.\n$$\nThus the minimum integer number of scans required is\n$$\nN_{\\min}=\\left\\lceil \\left(\\frac{30}{3}\\right)^{2} \\right\\rceil=\\left\\lceil 10^{2} \\right\\rceil=100.\n$$\nSince the square is already an integer, no additional rounding is needed beyond confirming the inequality.", "answer": "$$\\boxed{100}$$", "id": "1471994"}, {"introduction": "While signal averaging requires multiple acquisitions, digital filters offer a way to smooth a single data stream after it has been collected. The moving average is one of the most common types of digital filters, where each data point is replaced by a local average within a defined 'window'. This exercise [@problem_id:1472012] provides hands-on experience calculating a smoothed data point using a 3-point triangular moving average, a variation that gives more weight to the central point to better preserve the original signal's features while reducing noise.", "problem": "In an analytical chemistry experiment, a student uses a spectrophotometer to monitor a slow color-forming reaction. The absorbance of the sample is recorded at regular time intervals, but the data contains a small amount of random electronic noise. To reduce this noise and better discern the trend, a digital smoothing filter is to be applied. The first five absorbance measurements recorded are:\n\n[0.215, 0.231, 0.224, 0.240, 0.236]\n\nA 3-point triangular moving average is used for smoothing. For this filter, a new smoothed data point is calculated as the weighted average of the original data point and its immediate neighbors (the point before and the point after). The weights applied to the preceding point, the central point, and the succeeding point are 1, 2, and 1, respectively.\n\nCalculate the smoothed absorbance value that corresponds to the third measurement in the original sequence. Provide your answer as a numerical value, rounded to four significant figures. Absorbance is a dimensionless quantity.", "solution": "A 3-point triangular moving average with weights for the preceding, central, and succeeding points equal to 1, 2, and 1 computes the smoothed value at index $i$ as\n$$\ns_{i}=\\frac{1\\cdot x_{i-1}+2\\cdot x_{i}+1\\cdot x_{i+1}}{1+2+1}=\\frac{x_{i-1}+2x_{i}+x_{i+1}}{4}.\n$$\nFor the third measurement, $x_{2}=0.231$, $x_{3}=0.224$, and $x_{4}=0.240$. Substituting,\n$$\ns_{3}=\\frac{0.231+2\\cdot 0.224+0.240}{4}=\\frac{0.231+0.448+0.240}{4}=\\frac{0.919}{4}=0.22975.\n$$\nRounding to four significant figures gives $0.2298$.", "answer": "$$\\boxed{0.2298}$$", "id": "1472012"}, {"introduction": "Choosing the right filter is critical, as different filters are suited for different types of noise. A standard moving average filter effectively smooths random fluctuations but performs poorly on sharp, isolated noise spikes, often smearing the artifact across several data points. This comparative exercise [@problem_id:1471977] challenges you to analyze the outputs of both a moving average and a median filter, helping you to develop a qualitative understanding of their distinct behavior and to recognize when one is more appropriate than the other.", "problem": "An analytical chemist is working with a data stream from a chromatograph detector. The signal, which represents chemical absorbance, is generally stable but is corrupted by a single, sharp noise spike. To improve the signal-to-noise ratio, the chemist decides to apply two common digital smoothing filters to the raw data: a 3-point moving average filter and a 3-point median filter.\n\nA segment of the raw data signal, let's call it $S_{\\text{raw}}$, is given by the following sequence of absorbance values (in arbitrary units):\n$$\nS_{\\text{raw}} = [20.10, 20.50, 21.20, 98.50, 21.50, 20.80, 20.20]\n$$\nAfter applying each of the two filters (moving average and median, both with a 3-point window) to this segment, the chemist obtains the two smoothed signals below, labeled Signal A and Signal B. The order is mixed up.\n\nSignal A: $[20.50, 21.20, 21.50, 21.50, 20.80]$\nSignal B: $[20.60, 46.73, 47.07, 46.93, 20.83]$\n\nBased on your understanding of how these filters operate, identify which signal was produced by which filter.\n\nA. Signal A is from the moving average filter; Signal B is from the median filter.\n\nB. Signal A is from the median filter; Signal B is from the moving average filter.\n\nC. Both signals are from a moving average filter, but with different window sizes.\n\nD. Both signals are from a median filter, but with different window sizes.", "solution": "Let the raw sequence be indexed as $x_{1},x_{2},\\ldots,x_{7}$ with $[x_{1},x_{2},x_{3},x_{4},x_{5},x_{6},x_{7}]=[20.10,20.50,21.20,98.50,21.50,20.80,20.20]$. For a 3-point window, both filters produce outputs for indices $i=2,3,4,5,6$.\n\nThe 3-point moving average filter is defined by\n$$\ny_{i}^{(\\text{MA})}=\\frac{1}{3}\\left(x_{i-1}+x_{i}+x_{i+1}\\right).\n$$\nCompute each output:\n$$\ny_{2}^{(\\text{MA})}=\\frac{1}{3}(20.10+20.50+21.20)=\\frac{61.80}{3}=20.60,\n$$\n$$\ny_{3}^{(\\text{MA})}=\\frac{1}{3}(20.50+21.20+98.50)=\\frac{140.20}{3}\\approx 46.73,\n$$\n$$\ny_{4}^{(\\text{MA})}=\\frac{1}{3}(21.20+98.50+21.50)=\\frac{141.20}{3}\\approx 47.07,\n$$\n$$\ny_{5}^{(\\text{MA})}=\\frac{1}{3}(98.50+21.50+20.80)=\\frac{140.80}{3}\\approx 46.93,\n$$\n$$\ny_{6}^{(\\text{MA})}=\\frac{1}{3}(21.50+20.80+20.20)=\\frac{62.50}{3}\\approx 20.83.\n$$\nThus the moving average output is\n$$\n[20.60, 46.73, 47.07, 46.93, 20.83],\n$$\nwhich matches Signal B.\n\nThe 3-point median filter is defined by\n$$\ny_{i}^{(\\text{Med})}=\\operatorname{median}\\{x_{i-1},x_{i},x_{i+1}\\}.\n$$\nCompute each output by sorting each triple:\n$$\n\\operatorname{median}\\{x_{1},x_{2},x_{3}\\}=\\operatorname{median}\\{20.10,20.50,21.20\\} = 20.50,\n$$\n$$\n\\operatorname{median}\\{x_{2},x_{3},x_{4}\\}=\\operatorname{median}\\{20.50,21.20,98.50\\} = 21.20,\n$$\n$$\n\\operatorname{median}\\{x_{3},x_{4},x_{5}\\}=\\operatorname{median}\\{21.20,98.50,21.50\\} = 21.50,\n$$\n$$\n\\operatorname{median}\\{x_{4},x_{5},x_{6}\\}=\\operatorname{median}\\{98.50,21.50,20.80\\} = 21.50,\n$$\n$$\n\\operatorname{median}\\{x_{5},x_{6},x_{7}\\}=\\operatorname{median}\\{21.50,20.80,20.20\\} = 20.80.\n$$\nThus the median filter output is\n$$\n[20.50,21.20,21.50,21.50,20.80],\n$$\nwhich matches Signal A.\n\nTherefore, Signal A is from the median filter and Signal B is from the moving average filter, corresponding to option B.", "answer": "$$\\boxed{B}$$", "id": "1471977"}]}