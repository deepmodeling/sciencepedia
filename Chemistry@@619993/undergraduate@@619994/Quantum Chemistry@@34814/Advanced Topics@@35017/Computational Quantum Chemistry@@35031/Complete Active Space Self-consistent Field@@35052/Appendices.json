{"hands_on_practices": [{"introduction": "The Complete Active Space Self-Consistent Field (CASSCF) method is built upon the idea of treating a small, chemically crucial set of electrons and orbitals with high accuracy. This is accomplished by considering all possible configurations of these \"active\" electrons within the \"active\" orbitals. To fully grasp this, our first practice is a fundamental counting exercise that reveals the combinatorial complexity and spin-state structure within the smallest chemically meaningful active space, CAS(2,2), which is the cornerstone for describing single bond dissociation [@problem_id:1359559].", "problem": "In quantum chemistry, accurately describing chemical phenomena like bond breaking or electronically excited states often requires moving beyond a single-determinant Hartree-Fock picture. The Complete Active Space Self-Consistent Field (CASSCF) method is a foundational multi-configurational approach designed for such situations. In a CASSCF calculation, a subset of electrons, termed 'active' electrons, are distributed in all possible ways among a corresponding subset of 'active' orbitals.\n\nConsider a general CAS($M,N$) calculation, where $M$ is the number of active electrons and $N$ is the number of active orbitals. The total wavefunction is then constructed as a linear combination of all possible Configuration State Functions (CSFs) within this active space. A CSF is a specific linear combination of Slater determinants that is a pure eigenfunction of the total spin squared operator, $\\hat{S}^2$.\n\nFor the archetypal problem of correctly describing the dissociation of a single covalent bond (e.g., in H₂ or F₂), the minimal active space required involves the two electrons of the bond and the two orbitals they occupy (the bonding and antibonding molecular orbitals). This corresponds to a CAS(2,2) active space.\n\nYour task is to determine the total number of singlet ($S=0$) Configuration State Functions that can be constructed within a CAS(2,2) active space.", "solution": "In a CAS(2,2) active space there are two spatial orbitals, denote them by $p$ and $q$, and two electrons. The corresponding spin orbitals are $p\\alpha$, $p\\beta$, $q\\alpha$, and $q\\beta$. The total number of distinct two-electron Slater determinants that can be formed from these four spin orbitals is the binomial coefficient\n$$\n\\binom{4}{2}=6.\n$$\nAn explicit list is\n$$\n|p\\alpha, p\\beta\\rangle,\\quad |q\\alpha, q\\beta\\rangle,\\quad |p\\alpha, q\\alpha\\rangle,\\quad |p\\beta, q\\beta\\rangle,\\quad |p\\alpha, q\\beta\\rangle,\\quad |p\\beta, q\\alpha\\rangle.\n$$\nConfiguration State Functions (CSFs) are pure eigenfunctions of $\\hat{S}^{2}$ formed as linear combinations of these determinants (or, in special cases, equal to a single determinant).\n\n1) Determinants with both electrons in the same spatial orbital are necessarily closed-shell singlets. Therefore,\n$$\n|p\\alpha, p\\beta\\rangle\\quad\\text{and}\\quad |q\\alpha, q\\beta\\rangle\n$$\nare each already spin-adapted with $S=0$. This yields two linearly independent singlet CSFs.\n\n2) Determinants with one electron in each spatial orbital can be combined into spin-adapted singlet and triplet functions. The singlet CSF for this open-shell occupancy is\n$$\n|S; M_{S}=0\\rangle=\\frac{1}{\\sqrt{2}}\\big(|p\\alpha, q\\beta\\rangle - |p\\beta, q\\alpha\\rangle\\big),\n$$\nwhich is a pure $S=0$ eigenfunction. The remaining independent combinations form the triplet manifold:\n$$\n|T; M_{S}=+1\\rangle=|p\\alpha, q\\alpha\\rangle,\\quad\n|T; M_{S}=0\\rangle=\\frac{1}{\\sqrt{2}}\\big(|p\\alpha, q\\beta\\rangle + |p\\beta, q\\alpha\\rangle\\big),\\quad\n|T; M_{S}=-1\\rangle=|p\\beta, q\\beta\\rangle,\n$$\nall with $S=1$.\n\nCollecting the singlet CSFs, there are two closed-shell singlets and one open-shell singlet, for a total of\n$$\n2+1=3\n$$\nlinearly independent singlet CSFs in CAS(2,2).", "answer": "$$\\boxed{3}$$", "id": "1359559"}, {"introduction": "Moving from theory to practice, the most critical step in any CASSCF calculation is selecting an appropriate active space. This choice is not arbitrary; it requires chemical insight to identify the orbitals and electrons central to the chemical phenomenon under investigation, such as bond formation/breaking or electronic delocalization. This exercise challenges you to apply this reasoning to a classic example of a molecule with significant multireference character, the allyl radical, and determine its minimal active space for describing the $\\pi$ system [@problem_id:1359588].", "problem": "The allyl radical, $\\cdot C_3H_5$, is a prototypical example of a molecule with a delocalized $\\pi$ electron system that exhibits significant multireference character. Its structure consists of a chain of three sp$^2$-hybridized carbon atoms, with each carbon atom contributing one p-orbital perpendicular to the molecular plane. These three atomic p-orbitals combine to form the $\\pi$ molecular orbital system. The total number of electrons populating this $\\pi$ system is three.\n\nTo accurately model the electronic structure of such systems, one often employs the Complete Active Space Self-Consistent Field (CASSCF) method. In this approach, a subset of electrons and orbitals, known as the \"active space,\" is chosen. Within this active space, a full configuration interaction calculation is performed, meaning all possible arrangements of the active electrons in the active orbitals are considered. The active space is typically denoted by the notation CAS(N, M), where N is the number of active electrons and M is the number of active orbitals.\n\nFor the allyl radical, a minimal active space is one that includes all valence $\\pi$-type molecular orbitals and the electrons that occupy them. What is the correct specification, CAS(N, M), for the minimal active space required to describe the ground-state delocalized $\\pi$ system of the allyl radical?\n\nA. CAS(2, 2)\n\nB. CAS(3, 3)\n\nC. CAS(4, 3)\n\nD. CAS(3, 2)\n\nE. CAS(4, 4)", "solution": "The allyl radical consists of three sp^{2}-hybridized carbon atoms, each contributing one p-orbital perpendicular to the molecular plane. By basic molecular orbital theory for a three-atom conjugated fragment, these three atomic p-orbitals combine to form three delocalized $\\pi$ molecular orbitals. The total number of electrons in this $\\pi$ system for the allyl radical is three (two paired in the lowest-energy bonding $\\pi$ orbital and one unpaired electron distributed over the delocalized system).\n\nIn the CASSCF framework, the minimal active space required to describe the ground-state delocalized $\\pi$ system must include:\n- All valence $\\pi$-type molecular orbitals formed from the p-orbitals, which are three in number. Therefore, the number of active orbitals is $M=3$.\n- All electrons occupying these $\\pi$ orbitals, which total $N=3$.\n\nThus, the minimal active space is CAS(3, 3).\n\nTo confirm minimality and rule out alternatives:\n- CAS(2, 2) omits one $\\pi$ orbital and one $\\pi$ electron, so it cannot capture the full delocalization or the singly occupied character.\n- CAS(3, 2) omits one $\\pi$ orbital, preventing a complete description of the three-orbital $\\pi$ manifold.\n- CAS(4, 3) uses an incorrect electron count for the allyl radical’s $\\pi$ system.\n- CAS(4, 4) is larger than minimal and includes an extra orbital beyond the three $\\pi$ orbitals; it is not the minimal choice.\n\nTherefore, the correct minimal active space is CAS(3, 3).", "answer": "$$\\boxed{B}$$", "id": "1359588"}, {"introduction": "The true power of CASSCF lies in its ability to describe changes in electronic structure along a reaction coordinate, particularly in regions where electronic states with different character become nearly degenerate. This exercise employs a simplified but powerful two-state model to simulate the famous avoided crossing between the ionic and covalent potential energy surfaces of Lithium Fluoride (LiF) [@problem_id:2452667]. By diagonalizing a simple $2 \\times 2$ Hamiltonian, you will quantitatively explore how the mixing of electronic configurations gives rise to the adiabatic potential energy surfaces that govern chemical reactivity.", "problem": "Consider lithium fluoride modeled in a minimal Complete Active Space Self-Consistent Field (CASSCF) picture where the active space contains two configuration state functions: an ionic configuration $\\lvert \\mathrm{Li}^{+}\\mathrm{F}^{-} \\rangle$ and a covalent configuration $\\lvert \\mathrm{Li} \\cdot \\mathrm{F} \\cdot \\rangle$. In this two-configuration basis, the system at internuclear separation $R$ (in bohr) is represented by a symmetric $2 \\times 2$ Hamiltonian $H(R)$ with diabatic (uncoupled) energies on the diagonal and an interstate coupling on the off-diagonal. The diabatic energies are specified by physically motivated forms (atomic units throughout, energies in Hartree, $1 \\, \\mathrm{E_h}$, distances in bohr):\n- Covalent diabatic energy $E_{\\mathrm{cov}}(R) = A_{\\mathrm{rep}} \\, e^{-b R} - \\dfrac{C_6}{R^6}$, with asymptote $E_{\\mathrm{cov}}(\\infty) = 0$.\n- Ionic diabatic energy $E_{\\mathrm{ion}}(R) = \\Delta - \\dfrac{1}{R} + A_{\\mathrm{ion}} \\, e^{-b_{\\mathrm{ion}} R}$, where $\\Delta$ is the energy difference between the ionic and covalent asymptotes determined by the difference of the ionization energy of lithium and the electron affinity of fluorine, taken here as $\\Delta = 0.0735 \\, \\mathrm{E_h}$.\n\nThe interstate coupling is taken to decay exponentially with separation as $V(R) = V_0 \\, e^{-\\alpha R}$. The effective $2 \\times 2$ Hamiltonian in the diabatic basis $\\{\\lvert \\mathrm{cov} \\rangle, \\lvert \\mathrm{ion} \\rangle\\}$ is\n$$\nH(R) = \\begin{pmatrix}\nE_{\\mathrm{cov}}(R) & V(R) \\\\\nV(R) & E_{\\mathrm{ion}}(R)\n\\end{pmatrix}.\n$$\n\nUse the following parameter values (atomic units):\n- $A_{\\mathrm{rep}} = 5.0$, $b = 1.2$, $C_6 = 115.0$.\n- $A_{\\mathrm{ion}} = 5.0$, $b_{\\mathrm{ion}} = 1.2$.\n- $V_0 = 0.200$, $\\alpha = 0.300$.\n- $\\Delta = 0.0735$.\n\nFor each separation $R$ in the test suite below, compute the adiabatic energy gap $\\Delta E_{\\mathrm{ad}}(R)$, defined as the difference between the higher and lower eigenvalues of $H(R)$:\n$$\n\\Delta E_{\\mathrm{ad}}(R) = E_{\\mathrm{high}}(R) - E_{\\mathrm{low}}(R).\n$$\nExpress each $\\Delta E_{\\mathrm{ad}}(R)$ in Hartree as a float rounded to six decimal places.\n\nTest suite (distances must be interpreted in bohr): $R \\in \\{ 3.0, 8.0, 13.6, 20.0, 60.0 \\}$.\n\nYour program must compute $\\Delta E_{\\mathrm{ad}}(R)$ for each $R$ in the given order and produce a single line of output containing the results as a comma-separated list enclosed in square brackets, for example, $[\\delta_1,\\delta_2,\\delta_3,\\delta_4,\\delta_5]$, where each $\\delta_i$ is the rounded float value for the corresponding test case. All outputs must be in Hartree.", "solution": "The objective is to compute the adiabatic energy gap, $\\Delta E_{\\mathrm{ad}}(R)$, which is the difference between the eigenvalues of the given $2 \\times 2$ Hamiltonian matrix $H(R)$. The adiabatic energies are the eigenvalues of $H(R)$.\n\nFor a general $2 \\times 2$ real symmetric matrix of the form:\n$$\nM = \\begin{pmatrix} A & C \\\\ C & B \\end{pmatrix}\n$$\nthe eigenvalues, $\\lambda$, are the roots of the characteristic equation $\\det(M - \\lambda I) = 0$:\n$$\n(A - \\lambda)(B - \\lambda) - C^2 = 0\n$$\n$$\n\\lambda^2 - (A+B)\\lambda + (AB - C^2) = 0\n$$\nUsing the quadratic formula, the two eigenvalues are:\n$$\n\\lambda_{\\pm} = \\frac{(A+B) \\pm \\sqrt{(A+B)^2 - 4(AB - C^2)}}{2}\n$$\nSimplifying the term under the square root:\n$$\n(A+B)^2 - 4AB + 4C^2 = A^2 + 2AB + B^2 - 4AB + 4C^2 = A^2 - 2AB + B^2 + 4C^2 = (A-B)^2 + 4C^2\n$$\nThus, the eigenvalues are given by:\n$$\n\\lambda_{\\pm} = \\frac{A+B}{2} \\pm \\frac{1}{2}\\sqrt{(A-B)^2 + 4C^2}\n$$\nThe higher eigenvalue is $E_{\\mathrm{high}} = \\lambda_{+}$ and the lower is $E_{\\mathrm{low}} = \\lambda_{-}$. The adiabatic energy gap is the difference between these two eigenvalues:\n$$\n\\Delta E_{\\mathrm{ad}} = E_{\\mathrm{high}} - E_{\\mathrm{low}} = \\lambda_{+} - \\lambda_{-} = \\sqrt{(A-B)^2 + 4C^2}\n$$\nIn the context of our problem, the matrix elements are functions of the internuclear separation $R$:\n- $A = E_{\\mathrm{cov}}(R)$\n- $B = E_{\\mathrm{ion}}(R)$\n- $C = V(R)$\n\nSubstituting these into the derived formula for the gap yields the expression for computation:\n$$\n\\Delta E_{\\mathrm{ad}}(R) = \\sqrt{(E_{\\mathrm{cov}}(R) - E_{\\mathrm{ion}}(R))^2 + 4V(R)^2}\n$$\nThis result is fundamental in the study of two-level quantum systems. It shows that the energy gap between the adiabatic states is determined by two factors: the energy separation of the diabatic (uncoupled) states, $|E_{\\mathrm{cov}}(R) - E_{\\mathrm{ion}}(R)|$, and the coupling strength between them, $2|V(R)|$. The minimum gap, which occurs near the diabatic crossing point where $E_{\\mathrm{cov}}(R) \\approx E_{\\mathrm{ion}}(R)$, is equal to $2|V(R)|$.\n\nThe computational procedure is therefore to:\n1. Define the functions $E_{\\mathrm{cov}}(R)$, $E_{\\mathrm{ion}}(R)$, and $V(R)$ using the given parameters.\n2. For each value of $R$ in the test suite, evaluate these three functions.\n3. Substitute the results into the final formula for $\\Delta E_{\\mathrm{ad}}(R)$.\n4. Round the final result to the required precision of six decimal places.\n\nThis procedure will be implemented in the provided code.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the adiabatic energy gap for a two-state model of LiF at\n    various internuclear separations.\n    \"\"\"\n\n    # Define the constants and parameters given in the problem statement (in atomic units).\n    A_rep = 5.0\n    b = 1.2\n    C6 = 115.0\n    A_ion = 5.0\n    b_ion = 1.2\n    V0 = 0.200\n    alpha = 0.300\n    delta = 0.0735\n\n    # Test suite of internuclear separations R in bohr.\n    test_cases_R = [3.0, 8.0, 13.6, 20.0, 60.0]\n\n    # List to store the results.\n    results = []\n\n    # Define the functions for the Hamiltonian matrix elements.\n    def e_cov(R):\n        \"\"\"Calculates the covalent diabatic energy E_cov(R).\"\"\"\n        return A_rep * np.exp(-b * R) - C6 / (R**6)\n\n    def e_ion(R):\n        \"\"\"Calculates the ionic diabatic energy E_ion(R).\"\"\"\n        return delta - 1.0/R + A_ion * np.exp(-b_ion * R)\n\n    def v_coupling(R):\n        \"\"\"Calculates the interstate coupling V(R).\"\"\"\n        return V0 * np.exp(-alpha * R)\n\n    # Loop through each test case.\n    for R in test_cases_R:\n        # Calculate the Hamiltonian matrix elements for the given R.\n        E_cov_val = e_cov(R)\n        E_ion_val = e_ion(R)\n        V_val = v_coupling(R)\n\n        # The adiabatic energy gap is given by sqrt((E_cov - E_ion)^2 + 4V^2).\n        # This is derived from finding the difference between the two eigenvalues\n        # of the 2x2 Hamiltonian matrix.\n        diabatic_energy_diff = E_cov_val - E_ion_val\n        adiabatic_gap = np.sqrt(diabatic_energy_diff**2 + 4 * V_val**2)\n\n        results.append(adiabatic_gap)\n\n    # Format the results as a string with each value rounded to six decimal places,\n    # then join them into a comma-separated list enclosed in square brackets.\n    # Using f-string formatting '{:.6f}' ensures rounding to 6 decimal places.\n    formatted_results = [f'{res:.6f}' for res in results]\n    output_string = f\"[{','.join(formatted_results)}]\"\n\n    # Final print statement in the exact required format.\n    print(output_string)\n\nsolve()\n```", "id": "2452667"}]}