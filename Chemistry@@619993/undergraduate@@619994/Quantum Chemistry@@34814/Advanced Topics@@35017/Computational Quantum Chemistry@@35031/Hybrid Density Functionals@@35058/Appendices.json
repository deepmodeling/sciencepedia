{"hands_on_practices": [{"introduction": "A fundamental principle of Density Functional Theory (DFT) states that the ground-state energy, $E(N)$, as a function of the number of electrons $N$, should be a series of straight line segments between integer numbers of electrons. However, many common approximate functionals, particularly those of the Generalized Gradient Approximation (GGA) type, violate this condition and instead show a spurious convex curvature. This exercise [@problem_id:1373539] allows you to quantify this \"delocalization error\" for a GGA and see how the inclusion of exact exchange in a hybrid functional provides a significant correction, illustrating a core motivation for their development.", "problem": "In Density Functional Theory (DFT), the total energy of a system as a function of the number of electrons, $E(N)$, should ideally be a piecewise linear function with kinks at integer electron numbers. However, many approximate exchange-correlation functionals, such as those based on the Generalized Gradient Approximation (GGA), exhibit a spurious convexity. This \"delocalization error\" artificially favors fractional electron counts on separated fragments. Hybrid functionals, which incorporate a fraction of exact exchange, typically reduce this error.\n\nConsider a single chlorine atom (Cl). For fractional electron numbers in the range $N \\in [17, 18]$, let the number of electrons be represented as $N = 17 + \\delta$, where $\\delta \\in [0, 1]$. We model the total energy as calculated by a GGA functional and a hybrid functional as:\n$$E_{\\text{GGA}}(17+\\delta) = (1-\\delta)E(17) + \\delta E(18) - C_{\\text{GGA}}\\delta(1-\\delta)$$\n$$E_{\\text{hyb}}(17+\\delta) = (1-\\delta)E(17) + \\delta E(18) - C_{\\text{hyb}}\\delta(1-\\delta)$$\nwhere $E(17)$ and $E(18)$ are the exact total energies of the neutral Cl atom and the $\\text{Cl}^-$ anion, respectively. The positive constants $C_{\\text{GGA}}$ and $C_{\\text{hyb}}$ quantify the convexity, or the severity of the delocalization error, for each functional.\n\nThe values for these parameters are given as:\n- Energy of the neutral chlorine atom, $E(17) = -459.642 \\text{ Hartree}$\n- Energy of the chlorine anion, $E(18) = -459.775 \\text{ Hartree}$\n- GGA convexity parameter, $C_{\\text{GGA}} = 0.210 \\text{ Hartree}$\n- Hybrid functional convexity parameter, $C_{\\text{hyb}} = 0.055 \\text{ Hartree}$\n\nNow, consider a system composed of two identical, non-interacting chlorine atoms. If one electron is added to this two-atom system, the correct ground state corresponds to the electron localizing on one atom, forming a [Cl, $\\text{Cl}^-$] pair. However, due to delocalization error, an approximate functional might incorrectly predict a lower energy for a state where the electron is delocalized over both atoms, resulting in a $[\\text{Cl}^{-0.5}, \\text{Cl}^{-0.5}]$ system.\n\nCalculate the ratio of the spurious delocalization stabilization energy for the GGA functional to that for the hybrid functional. The spurious delocalization stabilization energy is defined as the energy of the delocalized state $[\\text{Cl}^{-0.5}, \\text{Cl}^{-0.5}]$ minus the energy of the correct localized state [Cl, $\\text{Cl}^-$]. Round your final answer to three significant figures.", "solution": "For a single atom with $N=17+\\delta$, the approximate energy with a given functional characterized by convexity parameter $C$ is\n$$\nE_{\\text{fun}}(17+\\delta)=(1-\\delta)E(17)+\\delta E(18)-C\\,\\delta(1-\\delta).\n$$\nFor two non-interacting chlorine atoms with one extra electron, the localized state [Cl, $\\text{Cl}^-$] has one atom at $\\delta=0$ and the other at $\\delta=1$, so its total energy is\n$$\nE_{\\text{loc}}=E_{\\text{fun}}(17)+E_{\\text{fun}}(18)=E(17)+E(18).\n$$\nThe delocalized state $[\\text{Cl}^{-0.5}, \\text{Cl}^{-0.5}]$ has each atom at $\\delta=\\frac{1}{2}$, giving per-atom energy\n$$\nE_{\\text{fun}}(17+\\tfrac{1}{2})=\\tfrac{1}{2}E(17)+\\tfrac{1}{2}E(18)-C\\left(\\tfrac{1}{2}\\right)\\left(1-\\tfrac{1}{2}\\right)=\\tfrac{1}{2}E(17)+\\tfrac{1}{2}E(18)-\\tfrac{C}{4}.\n$$\nThus the total energy of the delocalized state is\n$$\nE_{\\text{deloc}}=2E_{\\text{fun}}(17+\\tfrac{1}{2})=E(17)+E(18)-\\tfrac{C}{2}.\n$$\nThe spurious delocalization stabilization energy (delocalized minus localized) is therefore\n$$\n\\Delta E_{\\text{fun}}=E_{\\text{deloc}}-E_{\\text{loc}}=-\\tfrac{C}{2}.\n$$\nHence, the ratio of the GGA to hybrid stabilization energies is\n$$\nR=\\frac{\\Delta E_{\\text{GGA}}}{\\Delta E_{\\text{hyb}}}=\\frac{-\\tfrac{C_{\\text{GGA}}}{2}}{-\\tfrac{C_{\\text{hyb}}}{2}}=\\frac{C_{\\text{GGA}}}{C_{\\text{hyb}}}.\n$$\nInserting the given values,\n$$\nR=\\frac{0.210}{0.055}=\\frac{210}{55}=\\frac{42}{11}\\approx 3.81818\\ldots\n$$\nRounded to three significant figures, this is $3.82$.", "answer": "$$\\boxed{3.82}$$", "id": "1373539"}, {"introduction": "While hybrid functionals offer superior accuracy, this improvement comes at a significant computational price. The inclusion of exact Hartree-Fock exchange introduces a calculation step that scales more steeply with system size than any step in a standard GGA calculation, often as $N^4$ versus $N^3$ where $N$ is a measure of system size. This practical exercise [@problem_id:1373556] simulates a common task in computational chemistry: using benchmark timings on a small molecule to project the computational expense for a larger system, making the crucial trade-off between accuracy and feasibility tangible.", "problem": "A computational chemistry research group is investigating the electronic properties of a series of newly synthesized polymer chains. Before committing to a large-scale study, they perform benchmark calculations on a small monomer unit to compare the cost of different theoretical methods. The monomer system is described using a basis set consisting of $N_{\\text{small}} = 400$ basis functions.\n\nThe group performs two single-point energy calculations on this monomer:\n1.  Using a Generalized Gradient Approximation (GGA) functional, the calculation takes $T_{\\text{GGA, small}} = 5.00$ minutes to complete.\n2.  Using a hybrid functional, which incorporates a fraction of exact Hartree-Fock (HF) exchange, the calculation takes $T_{\\text{Hybrid, small}} = 24.0$ minutes to complete.\n\nFor the class of molecules and the software being used, it is known that the computational time for a GGA calculation scales approximately with the cube of the number of basis functions ($N^3$), while the time for a hybrid functional calculation is dominated by the exact exchange component and scales with the fourth power of the number of basis functions ($N^4$).\n\nThe group now wishes to study a larger oligomer from the series, which requires a basis set of $N_{\\text{large}} = 2000$ basis functions. Based on the benchmark results and the known scaling behaviors, calculate the expected ratio of the computational time for the hybrid functional to the GGA functional, i.e., $T_{\\text{Hybrid, large}} / T_{\\text{GGA, large}}$, for this larger system.\n\nRound your final answer to three significant figures.", "solution": "Let the GGA time scale as $T_{\\mathrm{GGA}}(N)=A N^{3}$ and the hybrid time as $T_{\\mathrm{Hybrid}}(N)=B N^{4}$, where $A$ and $B$ are method- and code-dependent prefactors.\n\nFrom the small-system benchmarks with $N_{\\mathrm{small}}$,\n$$\nA=\\frac{T_{\\mathrm{GGA,small}}}{N_{\\mathrm{small}}^{3}},\\qquad B=\\frac{T_{\\mathrm{Hybrid,small}}}{N_{\\mathrm{small}}^{4}}.\n$$\nFor the large system with $N_{\\mathrm{large}}$, the ratio is\n$$\n\\frac{T_{\\mathrm{Hybrid,large}}}{T_{\\mathrm{GGA,large}}}\n=\\frac{B N_{\\mathrm{large}}^{4}}{A N_{\\mathrm{large}}^{3}}\n=\\frac{B}{A}N_{\\mathrm{large}}\n=\\left(\\frac{T_{\\mathrm{Hybrid,small}}/N_{\\mathrm{small}}^{4}}{T_{\\mathrm{GGA,small}}/N_{\\mathrm{small}}^{3}}\\right) N_{\\mathrm{large}}\n=\\left(\\frac{T_{\\mathrm{Hybrid,small}}}{T_{\\mathrm{GGA,small}}}\\right)\\left(\\frac{N_{\\mathrm{large}}}{N_{\\mathrm{small}}}\\right).\n$$\nSubstituting the given values $T_{\\mathrm{Hybrid,small}}=24.0$, $T_{\\mathrm{GGA,small}}=5.00$, $N_{\\mathrm{large}}=2000$, and $N_{\\mathrm{small}}=400$,\n$$\n\\frac{T_{\\mathrm{Hybrid,large}}}{T_{\\mathrm{GGA,large}}}\n=\\left(\\frac{24.0}{5.00}\\right)\\left(\\frac{2000}{400}\\right)=4.8\\times 5=24.0.\n$$\nRounded to three significant figures, the result is $24.0$.", "answer": "$$\\boxed{24.0}$$", "id": "1373556"}, {"introduction": "The success of a quantum chemical calculation is not judged solely on total energy; the quality of the calculated electronic wavefunction is also critical, especially for open-shell systems like radicals. Unrestricted calculations with approximate functionals can suffer from \"spin contamination,\" where the resulting wavefunction is an unphysical mixture of different spin states. Through this problem [@problem_id:1373583], you will learn how to assess spin contamination from the expectation value of the $\\hat{S}^2$ operator and see quantitatively how the exact exchange component in hybrid functionals helps to produce a more physically meaningful, purer spin state.", "problem": "In a computational study of the thiophene radical cation ($\\text{C}_4\\text{H}_4\\text{S}^+$), an open-shell doublet system, the electronic structure is modeled using an unrestricted Kohn-Sham (UKS) formalism. In this approach, the alpha-spin and beta-spin orbitals are treated independently. For the ground state of this radical cation, there are $N_\\alpha = 22$ alpha electrons and $N_\\beta = 21$ beta electrons.\n\nA known issue with unrestricted methods is spin contamination, where the calculated eigenstate of the spin-squared operator, $\\hat{S}^2$, is not a pure spin state. The calculated expectation value, $\\langle S^2 \\rangle$, deviates from the exact theoretical value of $S(S+1)$, where $S$ is the total spin quantum number. The degree of spin contamination, $\\Delta S^2$, is defined as this deviation: $\\Delta S^2 = \\langle S^2 \\rangle - S(S+1)$. For a UKS calculation, this contamination is given by the expression $\\Delta S^2 = N_\\beta - \\mathcal{O}$, where $\\mathcal{O}$ represents the total squared overlap between the set of alpha and beta spatial orbitals.\n\nFirst, a calculation is performed using a pure Generalized Gradient Approximation (GGA) functional. This calculation results in a total squared orbital overlap of $\\mathcal{O}_{\\text{GGA}} = 20.315$.\n\nNext, a second calculation is performed using a hybrid functional. This functional improves upon the pure GGA by mixing a fraction, $a_{\\text{HF}}$, of exact Hartree-Fock exchange. For the hybrid functional used, $a_{\\text{HF}} = 0.25$. The inclusion of exact exchange is known to reduce spin contamination. For the thiophene radical cation, a computational model suggests that the spin contamination is reduced according to the relation: $\\Delta S^2_{\\text{hybrid}} = \\Delta S^2_{\\text{GGA}} \\times (1 - a_{\\text{HF}}^{1/3})$.\n\nUsing this information, calculate the expectation value $\\langle S^2 \\rangle$ that would be obtained from the hybrid functional calculation. Round your final answer to three significant figures.", "solution": "For an unrestricted Kohn-Sham doublet with $N_{\\alpha}=22$ and $N_{\\beta}=21$, the total spin is $S=\\frac{N_{\\alpha}-N_{\\beta}}{2}=\\frac{1}{2}$, so the exact spin expectation is\n$$\nS(S+1)=\\frac{3}{4}=0.75.\n$$\nIn a UKS calculation, the spin contamination is defined as $\\Delta S^{2}=\\langle S^{2}\\rangle - S(S+1)$ and, for a given calculation, is given by\n$$\n\\Delta S^{2}=N_{\\beta}-\\mathcal{O}.\n$$\nFor the GGA result with $\\mathcal{O}_{\\text{GGA}}=20.315$,\n$$\n\\Delta S^{2}_{\\text{GGA}}=N_{\\beta}-\\mathcal{O}_{\\text{GGA}}=21-20.315=0.685.\n$$\nFor the hybrid functional with $a_{\\text{HF}}=0.25$, the model gives\n$$\n\\Delta S^{2}_{\\text{hybrid}}=\\Delta S^{2}_{\\text{GGA}}\\left(1-a_{\\text{HF}}^{1/3}\\right)=0.685\\left(1-0.25^{1/3}\\right).\n$$\nEvaluating $0.25^{1/3}=4^{-1/3}\\approx 0.6299605249$, we obtain\n$$\n\\Delta S^{2}_{\\text{hybrid}}\\approx 0.685\\times 0.3700394751\\approx 0.2534770404.\n$$\nTherefore, the hybrid expectation value is\n$$\n\\langle S^{2}\\rangle_{\\text{hybrid}}=S(S+1)+\\Delta S^{2}_{\\text{hybrid}}\\approx 0.75+0.2534770404\\approx 1.0034770404.\n$$\nRounding to three significant figures gives $1.00$.", "answer": "$$\\boxed{1.00}$$", "id": "1373583"}]}