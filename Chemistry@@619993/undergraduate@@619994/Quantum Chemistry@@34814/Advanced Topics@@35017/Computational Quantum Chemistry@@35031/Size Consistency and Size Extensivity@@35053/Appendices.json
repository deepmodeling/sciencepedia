{"hands_on_practices": [{"introduction": "This first exercise solidifies the fundamental definitions of size consistency and size extensivity. You will analyze a hypothetical energy expression, $E_{total}(N) = N E_{a} + c N^{2}$, to practice applying these definitions in a clear mathematical context. This practice [@problem_id:1394925] is crucial for learning to identify how non-linear dependencies on the number of subsystems, $N$, violate these essential properties of a reliable computational method.", "problem": "In computational quantum chemistry, two important properties of a theoretical method are size consistency and size extensivity.\n- A method is defined as **size-consistent** if the calculated total energy of a system composed of $N$ identical, non-interacting subsystems is exactly equal to $N$ times the calculated energy of a single subsystem. That is, if $E(N)$ is the energy of $N$ subsystems, the condition is $E(N) = N \\times E(1)$.\n- A method is defined as **size-extensive** if the calculated total energy scales linearly with the number of particles (or subsystems, $N$) as the system size grows.\n\nConsider a hypothetical quantum chemistry method being tested on a system of $N$ non-interacting helium atoms. The method yields a total energy for the system given by the expression:\n$$E_{total}(N) = N E_{a} + c N^{2}$$\nwhere $N$ is the number of helium atoms, $E_{a}$ is a constant representing the dominant single-atom energy contribution, and $c$ is a small, non-zero constant representing a systematic error in the method.\n\nBased on the definitions provided, determine whether this hypothetical method is size-consistent and/or size-extensive.\n\nWhich of the following statements is correct?\n\nA. The method is size-consistent but not size-extensive.\n\nB. The method is size-extensive but not size-consistent.\n\nC. The method is both size-consistent and size-extensive.\n\nD. The method is neither size-consistent nor size-extensive.\n\nE. Whether the method is size-consistent or size-extensive depends on the value of $E_{a}$.", "solution": "We are given a method with total energy for $N$ non-interacting identical subsystems (helium atoms) as\n$$\nE_{total}(N) = N E_{a} + c N^{2},\n$$\nwith $c \\neq 0$.\n\nBy the definition of size consistency, for $N$ identical, non-interacting subsystems, the energy must satisfy\n$$\nE(N) = N \\times E(1).\n$$\nFirst compute $E(1)$ from the given method:\n$$\nE(1) = E_{a} + c.\n$$\nThen the size-consistency requirement implies\n$$\nN \\times E(1) = N(E_{a} + c) = N E_{a} + c N.\n$$\nCompare this to the method’s prediction:\n$$\nE_{total}(N) = N E_{a} + c N^{2}.\n$$\nThese are equal only if\n$$\nc N^{2} = c N \\quad \\Longleftrightarrow \\quad c N (N - 1) = 0.\n$$\nSince $c \\neq 0$ and for $N > 1$ we have $N(N-1) \\neq 0$, the equality fails. Therefore, the method is not size-consistent.\n\nBy the definition of size extensivity, the total energy should scale linearly with $N$ for a system composed of non-interacting subsystems. The given expression contains a quadratic term $c N^{2}$, so for large $N$ the energy grows as\n$$\nE_{total}(N) \\sim c N^{2},\n$$\nwhich is not linear in $N$. Equivalently, the energy per particle is\n$$\n\\frac{E_{total}(N)}{N} = E_{a} + c N,\n$$\nwhich depends on $N$ and thus violates linear scaling. Therefore, the method is not size-extensive.\n\nHence, the correct choice is that the method is neither size-consistent nor size-extensive.", "answer": "$$\\boxed{D}$$", "id": "1394925"}, {"introduction": "Having established the definitions, we now delve into the theoretical origins of size-consistency failure in certain quantum chemical methods. This practice challenges you to derive the size-consistency error for the Configuration Interaction with Singles and Doubles (CISD) method using a foundational model of two non-interacting H$_2$ molecules [@problem_id:2805781]. By working through the linear algebra, you will see precisely how the mathematical structure of truncated CI, specifically the omission of quadruple excitations, inevitably leads to an incorrect scaling of the energy.", "problem": "Consider two identical, infinitely separated hydrogen dimers $\\mathrm{H}_{2}^{(A)}$ and $\\mathrm{H}_{2}^{(B)}$ at stretched geometries, treated within the Born–Oppenheimer approximation (fixed nuclei) and a minimal basis set per monomer. For each monomer, use a two-configuration spin-adapted model space consisting of the restricted Hartree–Fock (RHF) reference determinant $\\lvert \\Phi_{0} \\rangle$ and the corresponding doubly excited determinant $\\lvert \\Phi_{2} \\rangle$ in which the electron pair is promoted from the bonding to the antibonding spatial orbital. Assume the following for each isolated monomer: (i) choose the zero of energy such that $\\langle \\Phi_{0} \\rvert \\hat{H} \\lvert \\Phi_{0} \\rangle = 0$, (ii) the diagonal energy of $\\lvert \\Phi_{2} \\rangle$ is $\\Delta > 0$, and (iii) the off-diagonal coupling between the two determinants is a real constant $v \\neq 0$, so that the electronic Hamiltonian restricted to $\\{ \\lvert \\Phi_{0} \\rangle, \\lvert \\Phi_{2} \\rangle \\}$ is\n$$\n\\mathbf{H}_{\\text{mono}} \\;=\\; \\begin{pmatrix}\n0 & v \\\\\nv & \\Delta\n\\end{pmatrix}.\n$$\nConfiguration Interaction with Singles and Doubles (CISD) is defined here as the variational solution of the Schrödinger equation within the span of determinants obtained by all single and double excitations from the RHF reference for the system under consideration, using the variational principle. For a two-electron monomer in the above two-determinant space, CISD coincides with full configuration interaction.\n\nNow construct the composite, noninteracting dimer $\\mathrm{H}_{2}^{(A)} + \\mathrm{H}_{2}^{(B)}$ with Hamiltonian $\\hat{H} = \\hat{H}_{A} + \\hat{H}_{B}$, and take the CISD model space for the dimer to be spanned by the three product determinants\n$$\n\\big\\{ \\lvert \\Phi_{0}^{A} \\Phi_{0}^{B} \\rangle,\\; \\lvert \\Phi_{2}^{A} \\Phi_{0}^{B} \\rangle,\\; \\lvert \\Phi_{0}^{A} \\Phi_{2}^{B} \\rangle \\big\\},\n$$\nwhich omits the disconnected product $\\lvert \\Phi_{2}^{A} \\Phi_{2}^{B} \\rangle$ because it is a quadruple excitation relative to the dimer RHF reference. Assume strict noninteraction between monomers, so there is no coupling between excitations on different monomers and no energy shifts beyond the sum of monomer contributions.\n\nUsing only the variational principle, separability of noninteracting subsystems, and linear algebra, do the following:\n- Derive the CISD ground-state energy $E_{\\text{mono}}(\\Delta, v)$ for a single monomer.\n- Derive the CISD ground-state energy $E_{\\text{dimer}}^{\\text{CISD}}(\\Delta, v)$ for the noninteracting dimer within the three-determinant space above.\n- Define the size-consistency error as $\\delta E_{\\text{CISD}}(\\Delta, v) \\equiv E_{\\text{dimer}}^{\\text{CISD}}(\\Delta, v) - \\big[ E_{\\text{mono}}(\\Delta, v) + E_{\\text{mono}}(\\Delta, v) \\big]$ and obtain a closed-form analytic expression for $\\delta E_{\\text{CISD}}(\\Delta, v)$.\n\nExpress your final answer as a single simplified analytic expression in terms of $\\Delta$ and $v$. No rounding is required. Leave the answer in symbolic form; do not include units.", "solution": "The problem statement is found to be valid, as it is scientifically grounded, well-posed, and objective. It presents a standard model in theoretical chemistry for the analysis of size consistency. We now proceed with the solution.\n\nThe problem requires a three-part derivation to find the size-consistency error of a simplified Configuration Interaction with Singles and Doubles (CISD) model.\n\nFirst, we determine the ground-state energy of a single monomer, $E_{\\text{mono}}(\\Delta, v)$. The electronic Hamiltonian for a monomer, within the specified $2$-determinant basis $\\{ \\lvert \\Phi_{0} \\rangle, \\lvert \\Phi_{2} \\rangle \\}$, is given as:\n$$\n\\mathbf{H}_{\\text{mono}} = \\begin{pmatrix} 0 & v \\\\ v & \\Delta \\end{pmatrix}\n$$\nThe energy eigenvalues are found by solving the secular equation $\\det(\\mathbf{H}_{\\text{mono}} - E\\mathbf{I}) = 0$, where $\\mathbf{I}$ is the identity matrix of dimension $2$.\n$$\n\\det \\begin{pmatrix} -E & v \\\\ v & \\Delta - E \\end{pmatrix} = 0\n$$\nThis leads to the characteristic polynomial:\n$$\n(-E)(\\Delta - E) - v^2 = 0\n$$\n$$\nE^2 - \\Delta E - v^2 = 0\n$$\nThis is a quadratic equation for the energy $E$. Applying the quadratic formula, $E = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}$, with coefficients $a = 1$, $b = -\\Delta$, and $c = -v^2$, we obtain the two energy eigenvalues:\n$$\nE = \\frac{\\Delta \\pm \\sqrt{(-\\Delta)^2 - 4(1)(-v^2)}}{2} = \\frac{\\Delta \\pm \\sqrt{\\Delta^2 + 4v^2}}{2}\n$$\nThe ground-state energy is the lower of these two eigenvalues. Given that $\\Delta > 0$ and $v \\neq 0$, the term $\\sqrt{\\Delta^2 + 4v^2}$ is strictly greater than $\\Delta$. Thus, the lowest energy eigenvalue corresponds to the minus sign. This energy is the CISD energy for the monomer, which in this $2$-state model is identical to the Full Configuration Interaction (FCI) energy.\n$$\nE_{\\text{mono}}(\\Delta, v) = \\frac{\\Delta - \\sqrt{\\Delta^2 + 4v^2}}{2}\n$$\n\nSecond, we determine the CISD ground-state energy for the noninteracting dimer, $E_{\\text{dimer}}^{\\text{CISD}}(\\Delta, v)$. The dimer Hamiltonian is $\\hat{H} = \\hat{H}_{A} + \\hat{H}_{B}$. The CISD model space for the dimer is spanned by the $3$ basis functions $\\{ \\lvert \\Psi_1 \\rangle, \\lvert \\Psi_2 \\rangle, \\lvert \\Psi_3 \\rangle \\} = \\{ \\lvert \\Phi_{0}^{A} \\Phi_{0}^{B} \\rangle, \\lvert \\Phi_{2}^{A} \\Phi_{0}^{B} \\rangle, \\lvert \\Phi_{0}^{A} \\Phi_{2}^{B} \\rangle \\}$. We must construct the Hamiltonian matrix $\\mathbf{H}_{\\text{dimer}}^{\\text{CISD}}$ in this basis. The matrix elements are $H_{ij} = \\langle \\Psi_i \\rvert \\hat{H}_A + \\hat{H}_B \\rvert \\Psi_j \\rangle$. Using the properties of the monomer basis states and the noninteraction assumption:\n$H_{11} = \\langle \\Phi_{0}^{A} \\Phi_{0}^{B} \\rvert \\hat{H}_A + \\hat{H}_B \\rvert \\Phi_{0}^{A} \\Phi_{0}^{B} \\rangle = \\langle \\Phi_{0}^{A} \\rvert \\hat{H}_A \\rvert \\Phi_{0}^{A} \\rangle + \\langle \\Phi_{0}^{B} \\rvert \\hat{H}_B \\rvert \\Phi_{0}^{B} \\rangle = 0 + 0 = 0$.\n$H_{22} = \\langle \\Phi_{2}^{A} \\Phi_{0}^{B} \\rvert \\hat{H}_A + \\hat{H}_B \\rvert \\Phi_{2}^{A} \\Phi_{0}^{B} \\rangle = \\langle \\Phi_{2}^{A} \\rvert \\hat{H}_A \\rvert \\Phi_{2}^{A} \\rangle + \\langle \\Phi_{0}^{B} \\rvert \\hat{H}_B \\rvert \\Phi_{0}^{B} \\rangle = \\Delta + 0 = \\Delta$.\n$H_{33} = \\langle \\Phi_{0}^{A} \\Phi_{2}^{B} \\rvert \\hat{H}_A + \\hat{H}_B \\rvert \\Phi_{0}^{A} \\Phi_{2}^{B} \\rangle = \\langle \\Phi_{0}^{A} \\rvert \\hat{H}_A \\rvert \\Phi_{0}^{A} \\rangle + \\langle \\Phi_{2}^{B} \\rvert \\hat{H}_B \\rvert \\Phi_{2}^{B} \\rangle = 0 + \\Delta = \\Delta$.\n$H_{12} = \\langle \\Phi_{0}^{A} \\Phi_{0}^{B} \\rvert \\hat{H}_A + \\hat{H}_B \\rvert \\Phi_{2}^{A} \\Phi_{0}^{B} \\rangle = \\langle \\Phi_{0}^{A} \\rvert \\hat{H}_A \\rvert \\Phi_{2}^{A} \\rangle \\langle \\Phi_{0}^{B} \\rvert \\Phi_{0}^{B} \\rangle = v \\cdot 1 = v$.\n$H_{13} = \\langle \\Phi_{0}^{A} \\Phi_{0}^{B} \\rvert \\hat{H}_A + \\hat{H}_B \\rvert \\Phi_{0}^{A} \\Phi_{2}^{B} \\rangle = \\langle \\Phi_{0}^{A} \\rvert \\Phi_{0}^{A} \\rangle \\langle \\Phi_{0}^{B} \\rvert \\hat{H}_B \\rvert \\Phi_{2}^{B} \\rangle = 1 \\cdot v = v$.\n$H_{23} = \\langle \\Phi_{2}^{A} \\Phi_{0}^{B} \\rvert \\hat{H}_A + \\hat{H}_B \\rvert \\Phi_{0}^{A} \\Phi_{2}^{B} \\rangle = 0$, as the Hamiltonians only couple states within the same monomer.\nThe resulting Hermitian matrix is:\n$$\n\\mathbf{H}_{\\text{dimer}}^{\\text{CISD}} = \\begin{pmatrix} 0 & v & v \\\\ v & \\Delta & 0 \\\\ v & 0 & \\Delta \\end{pmatrix}\n$$\nTo find the eigenvalues $E$, we solve the characteristic equation $\\det(\\mathbf{H}_{\\text{dimer}}^{\\text{CISD}} - E\\mathbf{I}) = 0$:\n$$\n\\det \\begin{pmatrix} -E & v & v \\\\ v & \\Delta - E & 0 \\\\ v & 0 & \\Delta - E \\end{pmatrix} = -E(\\Delta - E)^2 - v(v(\\Delta-E)) - v(-v(\\Delta-E)) = 0\n$$\n$$\n-E(\\Delta - E)^2 - 2v^2(\\Delta - E) = 0\n$$\n$$\n-(\\Delta - E)[E(\\Delta - E) + 2v^2] = 0\n$$\nThis equation yields two possibilities:\n1. $\\Delta - E = 0 \\implies E = \\Delta$.\n2. $E(\\Delta - E) + 2v^2 = 0 \\implies E^2 - \\Delta E - 2v^2 = 0$.\nThe second case is a quadratic equation with solutions:\n$$\nE = \\frac{\\Delta \\pm \\sqrt{\\Delta^2 - 4(1)(-2v^2)}}{2} = \\frac{\\Delta \\pm \\sqrt{\\Delta^2 + 8v^2}}{2}\n$$\nThe three eigenvalues are thus $\\Delta$, $\\frac{1}{2}(\\Delta + \\sqrt{\\Delta^2 + 8v^2})$, and $\\frac{1}{2}(\\Delta - \\sqrt{\\Delta^2 + 8v^2})$. The ground-state energy is the lowest of these. Since $\\sqrt{\\Delta^2 + 8v^2} > \\Delta$, the lowest eigenvalue is:\n$$\nE_{\\text{dimer}}^{\\text{CISD}}(\\Delta, v) = \\frac{\\Delta - \\sqrt{\\Delta^2 + 8v^2}}{2}\n$$\n\nThird, we compute the size-consistency error, $\\delta E_{\\text{CISD}}(\\Delta, v)$, defined as the difference between the energy of the dimer and twice the energy of the monomer.\n$$\n\\delta E_{\\text{CISD}}(\\Delta, v) = E_{\\text{dimer}}^{\\text{CISD}}(\\Delta, v) - 2 E_{\\text{mono}}(\\Delta, v)\n$$\nSubstituting the expressions derived above:\n$$\n\\delta E_{\\text{CISD}}(\\Delta, v) = \\left( \\frac{\\Delta - \\sqrt{\\Delta^2 + 8v^2}}{2} \\right) - 2\\left( \\frac{\\Delta - \\sqrt{\\Delta^2 + 4v^2}}{2} \\right)\n$$\n$$\n\\delta E_{\\text{CISD}}(\\Delta, v) = \\frac{\\Delta - \\sqrt{\\Delta^2 + 8v^2}}{2} - (\\Delta - \\sqrt{\\Delta^2 + 4v^2})\n$$\n$$\n\\delta E_{\\text{CISD}}(\\Delta, v) = \\frac{\\Delta - \\sqrt{\\Delta^2 + 8v^2} - 2\\Delta + 2\\sqrt{\\Delta^2 + 4v^2}}{2}\n$$\n$$\n\\delta E_{\\text{CISD}}(\\Delta, v) = \\frac{-\\Delta - \\sqrt{\\Delta^2 + 8v^2} + 2\\sqrt{\\Delta^2 + 4v^2}}{2}\n$$\nThis expression can be rearranged to a more structured form:\n$$\n\\delta E_{\\text{CISD}}(\\Delta, v) = \\sqrt{\\Delta^2 + 4v^2} - \\frac{\\Delta + \\sqrt{\\Delta^2 + 8v^2}}{2}\n$$\nThis is the final closed-form expression for the size-consistency error. Since $v \\neq 0$, this error is generally nonzero, demonstrating the failure of the truncated CISD method to be size-consistent. This failure arises from the omission of the disconnected quadruple-excitation configuration $\\lvert \\Phi_{2}^{A} \\Phi_{2}^{B} \\rangle$ from the dimer's model space.", "answer": "$$\n\\boxed{\\sqrt{\\Delta^2 + 4v^2} - \\frac{\\Delta + \\sqrt{\\Delta^2 + 8v^2}}{2}}\n$$", "id": "2805781"}, {"introduction": "Our final practice bridges the gap between abstract theory and computational practice by having you analyze pre-calculated energy data. By performing a quantitative analysis on the energies of non-interacting water molecule clusters calculated with different methods, you will see which ones are size-extensive and which are not [@problem_id:2805718]. This exercise introduces key numerical diagnostics used by researchers to validate methods and provides a clear, data-driven comparison of the reliability of HF, MP2, CCSD, and CISD.", "problem": "You are given the task of designing a fragment-addition scaling study for noninteracting water molecules, to interrogate the concepts of size consistency and size extensivity at the level of advanced graduate theoretical chemistry. The fundamental starting point is the additivity of the nonrelativistic electronic energy for noninteracting fragments: for a system composed of $N$ noninteracting, identical subsystems, the Hamiltonian is separable as $\\hat{H} = \\sum_{k=1}^{N} \\hat{H}_k$ and the exact ground-state energy is additive, $E(N) = \\sum_{k=1}^{N} E_k = N E(1)$. A method is size-extensive if it preserves $E(N) = N E(1)$ for noninteracting identical subsystems; equivalently, the total energy scales linearly with $N$ with zero intercept when extrapolated to $N=0$. Deviations from this linearity quantify a failure of size extensivity.\n\nWrite a complete, runnable program that implements a quantitative diagnostic of size extensivity using a least-squares linearity analysis and a curvature diagnostic applied to $E(N)$ data for noninteracting $(\\mathrm{H_2O})_N$ clusters. The program must:\n\n- Use the following test suite of method-labeled datasets. Each dataset consists of energies $E(N)$, in Hartree, for $N=1,2,3,4,5,6$, at very large separations where interactions vanish. The four methods are Hartree–Fock (HF), Møller–Plesset perturbation theory of second order (MP2), Coupled Cluster with Singles and Doubles (CCSD), and Configuration Interaction with Singles and Doubles (CISD). The data arrays are:\n  - HF: $[-76.0260,-152.0520,-228.0780,-304.1040,-380.1300,-456.1560]$\n  - MP2: $[-76.3000,-152.6000,-228.9000,-305.2000,-381.5000,-457.8000]$\n  - CCSD: $[-76.3500,-152.7000,-229.0500,-305.4000,-381.7500,-458.1000]$\n  - CISD: $[-76.3200,-152.6399,-228.9597,-305.2794,-381.5990,-457.9185]$\n- For each method, compute the following diagnostics:\n  1. The best-fit slope constrained through the origin, $s_0$, defined by minimizing $\\sum_{i=1}^{M} \\left(E(N_i)-s N_i\\right)^2$ with $N_i \\in \\{1,2,3,4,5,6\\}$. The closed-form expression is $s_0 = \\dfrac{\\sum_i N_i E(N_i)}{\\sum_i N_i^2}$. Report $s_0$ in Hartree.\n  2. The unconstrained least-squares linear fit parameters $(s,b)$ solving $E(N) \\approx s N + b$. Report the intercept $b$ in Hartree.\n  3. The root-mean-square deviation for the constrained fit, $\\mathrm{RMSD}_0 = \\sqrt{\\dfrac{1}{M}\\sum_i \\left(E(N_i)-s_0 N_i\\right)^2}$, in Hartree.\n  4. The maximum absolute second finite difference (a discrete curvature diagnostic), $\\max_{i=2,3,4,5} \\left|E(N_{i+1}) - 2 E(N_i) + E(N_{i-1})\\right|$, in Hartree.\n  5. The maximum absolute size-extensivity error defined relative to $E(1)$, $\\max_{i} \\left|E(N_i) - N_i E(1)\\right|$, in Hartree.\n- Classify each method as passing size extensivity within strict numerical tolerance if and only if all three of the following hold simultaneously: $\\left|b\\right| \\le \\tau_b$, $\\max\\left|\\Delta^2 E\\right| \\le \\tau_c$, and $\\max\\left|E(N)-N E(1)\\right| \\le \\tau_\\varepsilon$, with tolerances $\\tau_b = 10^{-8}$ Hartree, $\\tau_c = 10^{-8}$ Hartree, and $\\tau_\\varepsilon = 10^{-8}$ Hartree.\n\nYour program should produce a single line of output containing the results as a JSON array of arrays, where each inner array has the format $[m, s_0, b, \\mathrm{RMSD}_0, \\max\\left|\\Delta^2 E\\right|, \\max\\left|E(N)-N E(1)\\right|, \\mathrm{pass}]$. Here $m$ is the integer method index with the mapping $m=0$ for HF, $m=1$ for MP2, $m=2$ for CCSD, and $m=3$ for CISD; $s_0$, $b$, $\\mathrm{RMSD}_0$, $\\max\\left|\\Delta^2 E\\right|$, and $\\max\\left|E(N)-N E(1)\\right|$ are floats in Hartree; and $\\mathrm{pass}$ is a boolean. The output must be printed as a single line, with no additional text. All floats are to be interpreted in Hartree, and no units should be printed alongside the numbers.\n\nTest suite coverage requirements:\n- The HF, MP2, and CCSD datasets represent the happy path where strict size extensivity should be satisfied exactly, yielding linear scaling $E(N)=N E(1)$, zero intercept, zero curvature, and zero deviation.\n- The CISD dataset encodes a controlled quadratic deviation mimicking the lack of disconnected excitations, leading to sub-linear correlation scaling and a positive curvature in $E(N)$; it must fail the above tolerances.\n\nAngle units are not applicable. Percentages are not used; any ratios must be returned as decimals if needed, but this problem does not require ratios.", "solution": "The problem statement has been critically validated and is deemed valid. It is scientifically grounded in the principles of quantum chemistry, specifically the concepts of size extensivity and size consistency. The problem is well-posed, providing all necessary data, explicit mathematical formulas for the required diagnostics, and unambiguous classification criteria. The provided energy datasets for Hartree-Fock ($HF$), Møller-Plesset perturbation theory ($MP2$), Coupled Cluster with Singles and Doubles ($CCSD$), and Configuration Interaction with Singles and Doubles ($CISD$) methods are consistent with established theoretical knowledge: $HF$, $MP2$, and $CCSD$ are size-extensive methods, while $CISD$ is not. The task is to implement a numerical analysis to verify this property for the given data.\n\nThe core principle under examination is size extensivity. A theoretical method is size-extensive if the calculated energy $E(N)$ of a system composed of $N$ non-interacting identical subsystems scales linearly with $N$. Mathematically, this is expressed as $E(N) = N \\times E(1)$, where $E(1)$ is the energy of a single subsystem. Any deviation from this strict linearity indicates a failure of size extensivity, which is a serious deficiency in a quantum chemical model as it leads to unphysical energy scaling for larger systems.\n\nThe program will analyze the provided energy data, $E(N)$ for $N \\in \\{1, 2, 3, 4, 5, 6\\}$, for each of the four specified methods. For each method, the following five quantitative diagnostics will be computed to probe for deviations from linear scaling.\n\n1.  Constrained Linear Fit: A linear model constrained to pass through the origin, $E(N) = s_0 N$, is fitted to the data. The optimal slope $s_0$ is given by the least-squares formula $s_0 = \\frac{\\sum_{i=1}^{M} N_i E(N_i)}{\\sum_{i=1}^{M} N_i^2}$, where $M=6$ is the number of data points. For a size-extensive method, this slope $s_0$ should be equal to the monomer energy $E(1)$.\n\n2.  Unconstrained Linear Fit: A general linear model $E(N) = sN + b$ is fitted to the data. The intercept $b$ provides a direct measure of the error at the theoretical limit of $N=0$ fragments. For a perfectly size-extensive method, the data must lie on a line passing through the origin, so the intercept $b$ must be zero.\n\n3.  Constrained Root-Mean-Square Deviation ($\\mathrm{RMSD}_0$): The quality of the constrained fit is quantified by the root-mean-square deviation, defined as $\\mathrm{RMSD}_0 = \\sqrt{\\frac{1}{M}\\sum_{i=1}^{M} (E(N_i) - s_0 N_i)^2}$. This metric captures the overall magnitude of the deviation from perfect linearity through the origin.\n\n4.  Curvature Diagnostic: The second finite difference of the energy, $\\Delta^2 E_i = E(N_{i+1}) - 2E(N_i) + E(N_{i-1})$, serves as a discrete analogue of the second derivative $\\frac{d^2E}{dN^2}$. A linear function has zero second derivative. We compute the maximum absolute value of this quantity, $\\max |\\Delta^2 E|$, over the applicable range of indices. A non-zero value indicates that the energy scaling is non-linear, i.e., it possesses curvature.\n\n5.  Direct Size-Extensivity Error: The most direct test of size extensivity is to compute the error $\\delta_i = E(N_i) - N_i E(1)$ for each data point and identify the maximum absolute error, $\\max_i |\\delta_i|$. For a size-extensive method, this error must be zero for all $N_i$.\n\nA method is classified as size-extensive if and only if it passes three simultaneous checks against strict numerical tolerances: the absolute value of the unconstrained intercept $|b|$ must be less than or equal to $\\tau_b = 10^{-8}$ Hartree, the maximum curvature $\\max|\\Delta^2 E|$ must be less than or equal to $\\tau_c = 10^{-8}$ Hartree, and the maximum direct extensivity error $\\max|E(N)-N E(1)|$ must be less than or equal to $\\tau_\\varepsilon = 10^{-8}$ Hartree.\n\nThe implementation will be carried out in Python, leveraging the `numpy` library for efficient array-based numerical computations. A single function will be designed to process each method's energy data, calculating the five diagnostics and applying the classification logic. This function will be iteratively applied to all four datasets. The final results, including the method index $m$ ($0$ for $HF$, $1$ for $MP2$, $2$ for $CCSD$, $3$ for $CISD$), the five calculated diagnostic values, and a boolean `pass` flag, will be formatted into a JSON-compliant array of arrays as specified in the problem and printed to standard output.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Performs a size-extensivity analysis on quantum chemistry energy data.\n    \"\"\"\n    # Define the datasets for each method as specified in the problem.\n    # The structure is a list of tuples, where each tuple contains:\n    # (method_index, numpy_array_of_energies_in_Hartree)\n    test_cases = [\n        (0, np.array([-76.0260, -152.0520, -228.0780, -304.1040, -380.1300, -456.1560])), # HF\n        (1, np.array([-76.3000, -152.6000, -228.9000, -305.2000, -381.5000, -457.8000])), # MP2\n        (2, np.array([-76.3500, -152.7000, -229.0500, -305.4000, -381.7500, -458.1000])), # CCSD\n        (3, np.array([-76.3200, -152.6399, -228.9597, -305.2794, -381.5990, -457.9185]))  # CISD\n    ]\n\n    # Define the vector of system sizes N and its length M.\n    N_values = np.arange(1, 7, dtype=float)\n    M = len(N_values)\n    \n    # Define the tolerances for the classification.\n    tau_b = 1.0e-8  # Tolerance for the intercept\n    tau_c = 1.0e-8  # Tolerance for the curvature\n    tau_e = 1.0e-8  # Tolerance for the extensivity error\n\n    all_results = []\n\n    for m, E_values in test_cases:\n        # Diagnostic 1: Best-fit slope constrained through the origin, s_0\n        s0 = np.sum(N_values * E_values) / np.sum(N_values**2)\n\n        # Diagnostic 2: Unconstrained least-squares fit E = s*N + b\n        A = np.vstack([N_values, np.ones(M)]).T\n        s, b = np.linalg.lstsq(A, E_values, rcond=None)[0]\n\n        # Diagnostic 3: Root-mean-square deviation for the constrained fit, RMSD_0\n        residuals_0 = E_values - s0 * N_values\n        rmsd0 = np.sqrt(np.mean(residuals_0**2))\n\n        # Diagnostic 4: Maximum absolute second finite difference (curvature)\n        # np.diff with n=2 computes E[i+2] - 2*E[i+1] + E[i]\n        second_diffs = np.diff(E_values, n=2)\n        max_curvature = np.max(np.abs(second_diffs)) if len(second_diffs) > 0 else 0.0\n\n        # Diagnostic 5: Maximum absolute size-extensivity error relative to E(1)\n        E1 = E_values[0]\n        extensivity_errors = np.abs(E_values - N_values * E1)\n        max_extensivity_error = np.max(extensivity_errors)\n\n        # Classification: Check if the method passes the size-extensivity test\n        is_pass = (np.abs(b) <= tau_b) and \\\n                  (max_curvature <= tau_c) and \\\n                  (max_extensivity_error <= tau_e)\n        \n        # Store results for this method\n        result = [m, s0, b, rmsd0, max_curvature, max_extensivity_error, is_pass]\n        all_results.append(result)\n\n    # Format the final output string as a JSON-like array of arrays.\n    # Booleans are explicitly converted to lowercase 'true'/'false' for JSON compatibility.\n    formatted_results = []\n    for res in all_results:\n        # The last element is the boolean 'pass' flag.\n        bool_str = \"true\" if res[-1] else \"false\"\n        # Format the numbers and the boolean into a string representing the inner array.\n        inner_str = f\"[{res[0]},{res[1]},{res[2]},{res[3]},{res[4]},{res[5]},{bool_str}]\"\n        formatted_results.append(inner_str)\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2805718"}]}