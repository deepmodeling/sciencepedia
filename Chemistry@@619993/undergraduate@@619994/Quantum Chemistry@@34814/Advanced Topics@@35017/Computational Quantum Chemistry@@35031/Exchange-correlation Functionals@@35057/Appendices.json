{"hands_on_practices": [{"introduction": "The Local Density Approximation (LDA) is the foundational rung of the \"Jacob's Ladder\" of exchange-correlation functionals, which approximates the energy of a real system by treating it locally as a uniform electron gas (UEG). This powerful, albeit simple, model is the cornerstone of many more complex approximations. This exercise [@problem_id:1367149] provides a direct, quantitative look at this relationship by exploring how the LDA exchange energy scales with electron density, reinforcing the \"local\" nature of the approximation and its $n(\\vec{r})^{4/3}$ dependence.", "problem": "In the framework of Density Functional Theory (DFT), the total exchange energy, $E_x$, of an electronic system can be approximated by integrating an exchange energy density, $\\epsilon_x(\\vec{r})$, over all space. A foundational and widely used approximation is the Local Density Approximation (LDA), which proposes that the exchange energy density at a point $\\vec{r}$ is determined solely by the electron density, $n(\\vec{r})$, at that same point. For a system of interacting electrons, the LDA exchange energy density is given by the expression $\\epsilon_x^{LDA}(\\vec{r}) = C_x n(\\vec{r})^{4/3}$, where $C_x$ is a universal negative constant.\n\nConsider a simple model system: a uniform electron gas containing $N_1$ electrons freely moving within a fixed three-dimensional volume $V$. In such a system, the electron density is constant, $n(\\vec{r}) = n_0$, everywhere inside the volume and zero outside. The total LDA exchange energy for this initial system is $E_{x,1}$.\n\nNow, imagine we double the number of electrons in the box, so the new number of electrons is $N_2 = 2N_1$, while keeping the volume $V$ constant. The electron gas remains uniform. Let the new total LDA exchange energy be $E_{x,2}$.\n\nCalculate the ratio of the new exchange energy to the original exchange energy, $E_{x,2} / E_{x,1}$. Report your answer as a numerical value rounded to three significant figures.", "solution": "The LDA exchange energy is defined by integrating the exchange energy density over space:\n$$\nE_{x}=\\int \\epsilon_{x}^{LDA}(\\vec{r})\\,d^{3}r=\\int C_{x}\\,n(\\vec{r})^{4/3}\\,d^{3}r.\n$$\nFor a uniform electron gas of density $n(\\vec{r})=n_{0}$ inside the volume $V$ and zero outside, the integral reduces to\n$$\nE_{x,1}=C_{x}\\,n_{0}^{4/3}\\,V.\n$$\nUsing particle number conservation $N_{1}=n_{0}V$, we can also write\n$$\nE_{x,1}=C_{x}\\left(\\frac{N_{1}}{V}\\right)^{4/3}V=C_{x}\\,N_{1}^{4/3}\\,V^{-1/3}.\n$$\nAfter doubling the number of electrons at fixed volume, $N_{2}=2N_{1}$, the new density is $n_{0}^{\\prime}=N_{2}/V=2n_{0}$. The new exchange energy is\n$$\nE_{x,2}=C_{x}\\,(n_{0}^{\\prime})^{4/3}\\,V=C_{x}\\,(2n_{0})^{4/3}\\,V=2^{4/3}\\,C_{x}\\,n_{0}^{4/3}\\,V=2^{4/3}\\,E_{x,1}.\n$$\nEquivalently, in terms of $N_{1}$ and $V$,\n$$\nE_{x,2}=C_{x}\\left(\\frac{N_{2}}{V}\\right)^{4/3}V=C_{x}\\,(2N_{1})^{4/3}\\,V^{-1/3}.\n$$\nTherefore, the ratio is\n$$\n\\frac{E_{x,2}}{E_{x,1}}=\\frac{C_{x}\\,(2N_{1})^{4/3}\\,V^{-1/3}}{C_{x}\\,N_{1}^{4/3}\\,V^{-1/3}}=2^{4/3}.\n$$\nEvaluating numerically and rounding to three significant figures gives $2^{4/3}\\approx 2.52$.", "answer": "$$\\boxed{2.52}$$", "id": "1367149"}, {"introduction": "Generalized Gradient Approximations (GGAs) improve upon the LDA by incorporating not just the local electron density $n(\\vec{r})$, but also its spatial variation, represented by the gradient $|\\nabla n(\\vec{r})|$. A critical requirement for any well-behaved GGA is that it must correctly recover the LDA result for the uniform electron gas, where the density gradient is zero. This practice [@problem_id:1367178] serves as a conceptual check to solidify your understanding of this fundamental design constraint that links these two important classes of functionals.", "problem": "In the framework of Density Functional Theory (DFT), the exchange-correlation energy is a key component that must be approximated. Two common families of approximations are the Local Density Approximation (LDA) and the Generalized Gradient Approximation (GGA). The LDA functional calculates the exchange-correlation energy at a point $\\vec{r}$ based solely on the electron density $n(\\vec{r})$ at that same point. The GGA functional improves upon this by also including a dependency on the magnitude of the gradient of the electron density, $|\\nabla n(\\vec{r})|$.\n\nConsider the theoretical model of a Uniform Electron Gas (UEG), which is a system of interacting electrons moving in a uniform background of positive charge, such that the electron density $n(\\vec{r})$ is constant everywhere in space. Given this idealized system, which of the following statements correctly describes the relationship between the LDA and GGA descriptions of the UEG?\n\nA. The GGA functional becomes mathematically singular for the UEG because its formulation involves terms that depend on the inverse of the density gradient, which is zero.\n\nB. The GGA functional provides a significant, non-zero energy correction to the LDA result for the UEG, as the absence of density variations is a special case that GGA is specifically designed to handle more accurately.\n\nC. The GGA functional provides a higher exchange-correlation energy than the LDA functional for the UEG, because the gradient-dependent term is always positive.\n\nD. The GGA functional necessarily yields the exact same exchange-correlation energy as the LDA functional for the UEG.\n\nE. The value of the density gradient is non-zero but constant throughout the UEG, leading to a constant energy shift between the GGA and LDA results.", "solution": "Let the uniform electron gas (UEG) have constant electron density $n(\\vec{r})=n_{0}$ for all $\\vec{r}$. By definition of the gradient, this implies\n$$\n\\nabla n(\\vec{r})=\\mathbf{0} \\quad \\text{for all } \\vec{r}, \\quad \\text{so} \\quad |\\nabla n(\\vec{r})|=0.\n$$\n\nIn the Local Density Approximation (LDA), the exchange-correlation energy functional is constructed by integrating the uniform-gas exchange-correlation energy density evaluated at the local density:\n$$\nE_{\\text{xc}}^{\\text{LDA}}[n]=\\int d^{3}r\\, n(\\vec{r})\\, \\varepsilon_{\\text{xc}}^{\\text{UEG}}(n(\\vec{r})).\n$$\nFor the UEG, since $n(\\vec{r})=n_{0}$ is constant, the integrand is spatially constant, but the explicit value is not needed for the comparison that follows.\n\nA standard Generalized Gradient Approximation (GGA) for the exchange-correlation energy has the form\n$$\nE_{\\text{xc}}^{\\text{GGA}}[n]=\\int d^{3}r\\, n(\\vec{r})\\, \\varepsilon_{\\text{xc}}^{\\text{UEG}}(n(\\vec{r}))\\, F_{\\text{xc}}(s(\\vec{r}),n(\\vec{r})),\n$$\nwhere $F_{\\text{xc}}$ is an enhancement factor depending on the reduced gradient\n$$\ns(\\vec{r})=\\frac{|\\nabla n(\\vec{r})|}{2k_{F}(\\vec{r})\\, n(\\vec{r})}, \\quad k_{F}(\\vec{r})=\\left(3\\pi^{2} n(\\vec{r})\\right)^{1/3}.\n$$\nAn exact constraint that any sensible GGA is constructed to satisfy is the uniform-gas limit:\n$$\nF_{\\text{xc}}(0,n)=1 \\quad \\text{for all } n,\n$$\nso that the GGA reduces to the LDA when the density is uniform.\n\nFor the UEG, $|\\nabla n(\\vec{r})|=0$ implies $s(\\vec{r})=0$ for all $\\vec{r}$, hence\n$$\nE_{\\text{xc}}^{\\text{GGA}}[n]=\\int d^{3}r\\, n(\\vec{r})\\, \\varepsilon_{\\text{xc}}^{\\text{UEG}}(n(\\vec{r}))\\, F_{\\text{xc}}(0,n(\\vec{r}))=\\int d^{3}r\\, n(\\vec{r})\\, \\varepsilon_{\\text{xc}}^{\\text{UEG}}(n(\\vec{r}))=E_{\\text{xc}}^{\\text{LDA}}[n].\n$$\nTherefore, for the UEG, GGA necessarily yields exactly the same exchange-correlation energy as LDA.\n\nThis directly rules out the alternatives:\n- A is false because GGA depends on $|\\nabla n|$ (or $s$) and is constructed to be finite at $|\\nabla n|=0$; there is no inverse-gradient singularity in proper GGAs.\n- B is false because the correction relative to LDA vanishes in the uniform limit by construction.\n- C is false because the gradient-dependent correction is not guaranteed positive in general, and in the uniform limit it is identically zero.\n- E is false because for a truly uniform density, $\\nabla n(\\vec{r})=\\mathbf{0}$ exactly, not a non-zero constant.\n\nHence the correct statement is that GGA yields the same exchange-correlation energy as LDA for the UEG.", "answer": "$$\\boxed{D}$$", "id": "1367178"}, {"introduction": "When a DFT calculation with an approximate functional yields an inaccurate result, it is crucial to understand the source of the discrepancy. The total error can be decomposed into two distinct parts: the *functional-driven error*, from the inadequacy of the functional's mathematical form, and the *density-driven error*, from the functional producing an inaccurate self-consistent density. This exercise [@problem_id:1367152] introduces you to a powerful analysis technique used in modern research to disentangle these two error sources, offering deeper insight into a functional's performance for a real molecular system.", "problem": "In the field of computational quantum chemistry, Density Functional Theory (DFT) is a widely used method for calculating the electronic structure of atoms and molecules. The accuracy of a DFT calculation depends critically on the chosen approximation for the exchange-correlation (XC) functional. A common task for developers of new functionals is to analyze the sources of error in their calculations.\n\nThe total error in the calculated energy of a system can be conceptually separated into two components:\n1.  The **functional-driven error**: the error that arises from the approximate nature of the functional itself, even when it is evaluated with the perfectly correct electron density.\n2.  The **density-driven error**: the error that arises because the approximate functional yields a self-consistent electron density that is different from the true, exact density.\n\nConsider the calculation of the vertical ionization potential (IP) of a water molecule, H₂O. An analyst has performed several calculations using a particular General Gradient Approximation (GGA) functional and a highly accurate reference method that provides benchmark energies and electron densities. The ionization potential is defined as the energy difference between the cation and the neutral species: $IP = E(\\text{H}_2\\text{O}^+) - E(\\text{H}_2\\text{O})$.\n\nThe following table summarizes the total electronic energies obtained from these calculations. The notation $E_{\\text{method}}[\\rho_{\\text{source}}]$ denotes the energy calculated using the 'method' functional (or Hamiltonian) with an electron density $\\rho$ obtained self-consistently from the 'source' calculation. The 'Ref' method is the highly accurate reference.\n\n| Species             | Calculation Type                                 | Symbol                           | Energy (Hartrees) |\n|---------------------|--------------------------------------------------|----------------------------------|-------------------|\n| H₂O (neutral)       | Reference Method                                 | $E_{\\text{Ref}}[\\rho_{\\text{Ref}}]$       | -76.438           |\n| H₂O⁺ (cation)      | Reference Method                                 | $E^{+}_{\\text{Ref}}[\\rho^{+}_{\\text{Ref}}]$     | -75.972           |\n| H₂O (neutral)       | Self-Consistent GGA                              | $E_{\\text{GGA}}[\\rho_{\\text{GGA}}]$       | -76.415           |\n| H₂O⁺ (cation)      | Self-Consistent GGA                              | $E^{+}_{\\text{GGA}}[\\rho^{+}_{\\text{GGA}}]$     | -75.925           |\n| H₂O (neutral)       | GGA functional on Reference Density              | $E_{\\text{GGA}}[\\rho_{\\text{Ref}}]$       | -76.412           |\n| H₂O⁺ (cation)      | GGA functional on Reference Density              | $E^{+}_{\\text{GGA}}[\\rho^{+}_{\\text{Ref}}]$     | -75.923           |\n\nUsing the data provided, calculate the component of the error in the GGA ionization potential that is purely attributable to the intrinsic imperfection of the functional itself, not the error in the density it produces.\n\nUse the conversion factor 1 Hartree = 27.2114 eV. Express your final answer in eV, rounded to three significant figures.", "solution": "We seek the functional-driven error component of the ionization potential (IP) computed with a GGA, defined as the error that remains when the approximate functional is evaluated on the exact (reference) densities. For any species, the total energy is denoted $E_{\\text{method}}[\\rho_{\\text{source}}]$. The IP for any given pair of energies is defined as\n$$\n\\text{IP} = E^{+} - E,\n$$\nwhere $E^{+}$ and $E$ are the total electronic energies of the cation and neutral species, respectively.\n\nThe exact (reference) IP is\n$$\n\\text{IP}_{\\text{Ref}} = E^{+}_{\\text{Ref}}[\\rho^{+}_{\\text{Ref}}] - E_{\\text{Ref}}[\\rho_{\\text{Ref}}].\n$$\nUsing the given values,\n$$\n\\text{IP}_{\\text{Ref}} = (-75.972) - (-76.438) = 0.466 \\text{ Hartree}.\n$$\n\nThe IP obtained by evaluating the GGA functional on the exact (reference) densities is\n$$\n\\text{IP}_{\\text{GGA@Ref}} = E^{+}_{\\text{GGA}}[\\rho^{+}_{\\text{Ref}}] - E_{\\text{GGA}}[\\rho_{\\text{Ref}}].\n$$\nUsing the given values,\n$$\n\\text{IP}_{\\text{GGA@Ref}} = (-75.923) - (-76.412) = 0.489 \\text{ Hartree}.\n$$\n\nBy definition, the functional-driven error in the IP is the difference between these two,\n$$\n\\Delta_{\\text{F}}(\\text{IP}) = \\text{IP}_{\\text{GGA@Ref}} - \\text{IP}_{\\text{Ref}} = 0.489 - 0.466 = 0.023 \\text{ Hartree}.\n$$\n\nConvert to electronvolts using the given factor $1 \\text{ Hartree} = 27.2114 \\text{ eV}$:\n$$\n\\Delta_{\\text{F}}(\\text{IP}) = 0.023 \\times 27.2114 \\text{ eV} = 0.6258622 \\text{ eV}.\n$$\nRounded to three significant figures,\n$$\n\\Delta_{\\text{F}}(\\text{IP}) = 0.626 \\text{ eV}.\n$$", "answer": "$$\\boxed{0.626}$$", "id": "1367152"}]}