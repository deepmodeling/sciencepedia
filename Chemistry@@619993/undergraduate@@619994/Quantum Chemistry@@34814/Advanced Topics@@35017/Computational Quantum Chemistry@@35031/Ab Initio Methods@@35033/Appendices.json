{"hands_on_practices": [{"introduction": "The accuracy of any *ab initio* calculation fundamentally depends on the chosen basis set, which serves as the mathematical building blocks for molecular orbitals. A common and crucial enhancement to a basis set is the inclusion of \"polarization functions,\" such as d-orbitals on a carbon atom. This practice explores the physical justification for these functions, revealing that their role is not to describe occupied atomic d-orbitals, but rather to provide the necessary mathematical flexibility to accurately model the distortion of electron density in the anisotropic environment of a molecule [@problem_id:1351255].", "problem": "In the field of computational chemistry, *ab initio* (from first principles) methods are used to solve the electronic Schrödinger equation for a molecule. These methods approximate the molecular orbitals as a linear combination of pre-defined basis functions centered on each atom, a concept known as the Linear Combination of Atomic Orbitals (LCAO) approximation. The set of these functions is called a basis set.\n\nA student is tasked with calculating the equilibrium geometry of a formaldehyde molecule ($\\text{CH}_2\\text{O}$), which is known to be planar. They perform two calculations using the Hartree-Fock method. The first calculation uses the 6-31G basis set. The second uses the 6-31G(d) basis set, which is identical to 6-31G but with the addition of a set of d-type polarization functions on the heavy (non-hydrogen) atoms, carbon and oxygen. The student observes that the calculation with the 6-31G(d) basis set produces a geometry and total energy that are in much better agreement with experimental data.\n\nWhich of the following statements provides the most accurate physical justification for why the inclusion of d-type functions on the carbon atom is crucial for improving the calculation, even though the valence shell of a ground-state carbon atom only contains s and p orbitals?\n\nA. The d-orbitals are essential for accurately describing the 1s core electrons of the carbon atom, as their high-energy nature cannot be properly captured by s and p functions.\n\nB. The d-orbitals are primarily included to allow the model to describe non-planar vibrations, which, while not part of the equilibrium structure, are important for the overall energy.\n\nC. The d-orbitals are added to account for electron correlation, an effect describing the instantaneous repulsion between electrons that is completely neglected when using the simpler 6-31G basis set.\n\nD. The d-orbitals provide the necessary mathematical flexibility to distort the electron density distribution around the carbon atom, allowing it to polarize in response to the asymmetric environment of the chemical bonds.\n\nE. The d-orbitals are necessary because the carbon atom in formaldehyde is $\\text{sp}^3$ hybridized, a configuration that requires the participation of d-orbitals for its proper formation.", "solution": "In the Hartree-Fock method, the electronic wavefunction is approximated by a single Slater determinant built from molecular orbitals, each expanded as a linear combination of basis functions. If the set of basis functions is $\\{\\chi_{\\mu}\\}$, then each molecular orbital has the form\n$$\n\\psi_{i}(\\mathbf{r})=\\sum_{\\mu} c_{\\mu i}\\,\\chi_{\\mu}(\\mathbf{r}).\n$$\nThe Rayleigh-Ritz variational principle guarantees that enlarging the span of $\\{\\chi_{\\mu}\\}$ cannot raise the Hartree-Fock energy, i.e.\n$$\nE_{\\text{HF}}^{\\text{6-31G(d)}} \\leq E_{\\text{HF}}^{\\text{6-31G}}.\n$$\nHowever, beyond the mathematical fact that the energy lowers, the physical reason the geometry and energy improve with 6-31G(d) is the added angular flexibility provided by the d-type polarization functions on heavy atoms.\n\nThe local electronic environment in formaldehyde is highly anisotropic: carbon simultaneously participates in a polarized $\\text{C}=\\text{O}$ $\\pi$ bond and two $\\text{C}-\\text{H}$ $\\sigma$ bonds within a planar framework. This anisotropy requires the electron density $\\rho(\\mathbf{r})$ around carbon to distort relative to a spherically or cylindrically symmetric distribution. In a basis-set picture, Gaussian basis functions can be viewed as polynomial prefactors $x^{a}y^{b}z^{c}$ times a radial Gaussian $\\exp(-\\alpha r^{2})$, where $a+b+c=l$ corresponds to angular momentum $l$. Including only $l=0$ (s) and $l=1$ (p) limits the angular variation of the electron density. Adding $l=2$ (d) functions supplies quadrupolar angular components, effectively increasing the span of spherical harmonics $Y_{lm}(\\theta,\\phi)$ available to represent $\\rho(\\mathbf{r})$. This additional angular flexibility allows the mean-field Hartree-Fock orbitals to polarize in response to the asymmetric molecular field, improving both bond description and equilibrium geometry.\n\nThis explains why option D is correct: the d-type functions act as polarization functions that enable density distortion around carbon in the chemically asymmetric environment.\n\nThe other options are incorrect for the following reasons:\n- A is incorrect because core $1\\text{s}$ electrons are described by tight s-type functions; d-type functions are not required for core description in second-row atoms.\n- B is incorrect because the principal benefit at equilibrium is improved representation of anisotropic bonding electron density, not specifically non-planar vibrations.\n- C is incorrect because Hartree-Fock neglects electron correlation by construction; adding polarization functions improves the Hartree-Fock mean-field description but does not include true correlation, which requires post-Hartree-Fock or density-functional approaches.\n- E is incorrect because formaldehyde’s carbon is commonly described as $\\text{sp}^{2}$ hybridized, and second-row $\\text{sp}^{n}$ hybrids do not require participation of d orbitals; moreover, the role of d functions in basis sets is variational flexibility, not literal occupancy or hybridization with physical d orbitals.\n\nTherefore, the inclusion of d functions on carbon is crucial because it provides the necessary angular flexibility for polarization of the electron density in an anisotropic bonding environment, which improves the calculated energy and geometry within Hartree-Fock.", "answer": "$$\\boxed{D}$$", "id": "1351255"}, {"introduction": "When calculating the weak interaction energies that hold molecules together, such as in the argon dimer, a subtle artifact known as Basis Set Superposition Error (BSSE) can arise. This error leads to an artificial overestimation of the binding energy, a significant problem when studying non-covalent interactions. This exercise introduces the standard method to remedy this issue, the counterpoise correction, providing a concrete example of how to obtain a more physically meaningful interaction energy by ensuring a consistent description of the system's components [@problem_id:1351245].", "problem": "In computational quantum chemistry, the calculation of weak intermolecular interactions, such as van der Waals forces in noble gas dimers, is highly sensitive to the choice of the basis set. A common issue that arises when using finite, atom-centered basis sets is the Basis Set Superposition Error (BSSE). This error leads to an artificial stabilization of the molecular complex because each monomer can \"borrow\" basis functions from its partner to improve its own electronic description, an effect not available to the isolated monomers.\n\nTo correct for this, the counterpoise (CP) correction scheme developed by Boys and Bernardi is widely used. Consider a student performing an *ab initio* calculation on the argon dimer, $\\text{Ar}_2$, at a fixed internuclear distance. The following energies are obtained:\n\n1.  The total energy of the $\\text{Ar}_2$ dimer, calculated with basis functions on both argon atoms (let's call them A and B):\n    $E_{Ar_2}$\n\n2.  The energy of an isolated argon atom, calculated with its own basis set:\n    $E_{Ar}$\n\n3.  The energy of one argon atom (A), calculated in the presence of the basis functions of the other atom (B), where B is a \"ghost atom\" (i.e., its basis functions are present at its dimer position, but its nucleus and electrons are absent):\n    $E_{Ar(ghost)}$\n\nThe student wants to find the BSSE-corrected interaction energy, $\\Delta E_{CP}$, for the argon dimer. Which of the following expressions correctly represents $\\Delta E_{CP}$?\n\nA. $E_{Ar_2} - 2 E_{Ar}$\nB. $2(E_{Ar} - E_{Ar(ghost)})$\nC. $E_{Ar_2} - 2 E_{Ar(ghost)}$\nD. $E_{Ar_2} - 2 E_{Ar} + (E_{Ar} - E_{Ar(ghost)})$\nE. $E_{Ar} - E_{Ar(ghost)}$", "solution": "Define the uncorrected supermolecular interaction energy using monomers computed in their own basis sets as\n$$\n\\Delta E_{\\text{uncorr}} = E_{Ar_{2}} - 2 E_{Ar}.\n$$\nWhen a finite atom-centered basis is used, each monomer in the dimer benefits from the partner’s basis functions; this leads to the Basis Set Superposition Error (BSSE). In the counterpoise (CP) correction of Boys and Bernardi, one computes the monomer energies in the full dimer basis by introducing a ghost atom. Denote the energy of one argon atom in the presence of the ghost basis of the other as $E_{Ar(\\text{ghost})}$. For a homodimer, both monomers have the same ghost-basis energy, so $E_{A}^{*} = E_{B}^{*} = E_{Ar(\\text{ghost})}$.\n\nThe CP-corrected interaction energy is defined by replacing the monomer energies in the interaction energy expression with their values computed in the dimer basis:\n$$\n\\Delta E_{CP} = E_{Ar_{2}} - \\left(E_{A}^{*} + E_{B}^{*}\\right) = E_{Ar_{2}} - 2 E_{Ar(\\text{ghost})}.\n$$\nEquivalently, in terms of the uncorrected interaction energy and the BSSE correction term,\n$$\n\\Delta E_{CP} = \\left(E_{Ar_{2}} - 2 E_{Ar}\\right) + 2\\left(E_{Ar} - E_{Ar(\\text{ghost})}\\right).\n$$\nFrom these definitions, the correct expression among the options is $E_{Ar_{2}} - 2 E_{Ar(\\text{ghost})}$, which corresponds to option C.\n\nTo clarify the other options:\n- A is the uncorrected interaction energy.\n- B equals the BSSE correction term to be added to A, not the corrected interaction energy itself.\n- D adds only half of the BSSE correction to A.\n- E is one monomer’s BSSE contribution, not the full interaction energy.", "answer": "$$\\boxed{C}$$", "id": "1351245"}, {"introduction": "The iterative heart of the Hartree-Fock method is the Self-Consistent Field (SCF) procedure, which can sometimes struggle with slow or oscillating convergence. To address this, modern quantum chemistry programs employ sophisticated acceleration techniques. This hands-on problem delves into one of the most powerful and widely used methods, the Direct Inversion in the Iterative Subspace (DIIS) algorithm, demonstrating how it intelligently uses information from previous steps to extrapolate a better solution and guide the calculation efficiently towards convergence [@problem_id:1351239].", "problem": "In a Hartree-Fock Self-Consistent Field (SCF) calculation for a molecule, convergence can sometimes be slow or oscillatory. The Direct Inversion in the Iterative Subspace (DIIS) method is a powerful technique used to accelerate convergence. It works by extrapolating a new Fock matrix from a linear combination of Fock matrices from previous iterations, chosen to minimize an error metric.\n\nConsider a restricted Hartree-Fock calculation within a minimal basis set that is currently in its $k+1$-th iteration. The last two available Fock matrices and their corresponding error vectors are given. For simplicity, we will label these as belonging to iterations 1 and 2 of the DIIS subspace.\n\nThe Fock matrices are:\n$$\n\\mathbf{F}_1 = \\begin{pmatrix} -1.20 & 0.40 \\\\ 0.40 & -0.80 \\end{pmatrix}\n\\quad \\text{and} \\quad\n\\mathbf{F}_2 = \\begin{pmatrix} -1.10 & 0.50 \\\\ 0.50 & -0.90 \\end{pmatrix}\n$$\n\nThe corresponding error vectors, which are themselves matrices, are defined for this problem as $\\mathbf{e}_i$:\n$$\n\\mathbf{e}_1 = \\begin{pmatrix} 0.0 & -0.10 \\\\ 0.10 & 0.0 \\end{pmatrix}\n\\quad \\text{and} \\quad\n\\mathbf{e}_2 = \\begin{pmatrix} 0.0 & 0.20 \\\\ -0.20 & 0.0 \\end{pmatrix}\n$$\n\nThe DIIS procedure finds an extrapolated Fock matrix $\\mathbf{F}_{\\text{DIIS}}$ as a linear combination of the previous matrices:\n$$\n\\mathbf{F}_{\\text{DIIS}} = \\sum_{i=1}^{m} c_i \\mathbf{F}_i\n$$\nwhere $m$ is the number of previous iterations considered (in this case, $m=2$). The coefficients $c_i$ are determined by solving the following system of linear equations, which minimizes the norm of the error vector combination $\\sum_{i=1}^{m} c_i \\mathbf{e}_i$ under the constraint that $\\sum_{i=1}^{m} c_i = 1$:\n$$\n\\begin{pmatrix}\nB_{11} & \\dots & B_{1m} & -1 \\\\\n\\vdots & \\ddots & \\vdots & \\vdots \\\\\nB_{m1} & \\dots & B_{mm} & -1 \\\\\n1 & \\dots & 1 & 0\n\\end{pmatrix}\n\\begin{pmatrix}\nc_1 \\\\\n\\vdots \\\\\nc_m \\\\\n\\lambda\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n0 \\\\\n\\vdots \\\\\n0 \\\\\n1\n\\end{pmatrix}\n$$\nHere, the matrix elements are given by the trace of the error vector products, $B_{ij} = \\text{Tr}(\\mathbf{e}_i^\\text{T} \\mathbf{e}_j)$, and $\\lambda$ is a Lagrange multiplier for the normalization constraint.\n\nUsing the provided data for the two most recent iterations, calculate the value of the off-diagonal element, $(\\mathbf{F}_{\\text{DIIS}})_{12}$, of the new extrapolated Fock matrix. Report your answer rounded to three significant figures.", "solution": "We use the DIIS definition with the error inner products $B_{ij}=\\text{Tr}(\\mathbf{e}_{i}^{\\text{T}}\\mathbf{e}_{j})$. For the given error matrices\n$$\n\\mathbf{e}_1=\\begin{pmatrix}0 & -0.10 \\\\ 0.10 & 0\\end{pmatrix},\\quad\n\\mathbf{e}_2=\\begin{pmatrix}0 & 0.20 \\\\ -0.20 & 0\\end{pmatrix},\n$$\nthe Frobenius inner products are:\n$$\nB_{11}=\\text{Tr}(\\mathbf{e}_1^{\\text{T}}\\mathbf{e}_1)=0^{2}+(-0.10)^{2}+(0.10)^{2}+0^{2}=0.02,\n$$\n$$\nB_{22}=\\text{Tr}(\\mathbf{e}_2^{\\text{T}}\\mathbf{e}_2)=0^{2}+(0.20)^{2}+(-0.20)^{2}+0^{2}=0.08,\n$$\n$$\nB_{12}=B_{21}=\\text{Tr}(\\mathbf{e}_1^{\\text{T}}\\mathbf{e}_2)=0\\cdot 0+(-0.10)\\cdot 0.20+(0.10)\\cdot(-0.20)+0\\cdot 0=-0.04.\n$$\nThe DIIS linear system for $c_{1},c_{2}$ and the Lagrange multiplier $\\lambda$ is\n$$\n\\begin{pmatrix}\n0.02 & -0.04 & -1 \\\\\n-0.04 & 0.08 & -1 \\\\\n1 & 1 & 0\n\\end{pmatrix}\n\\begin{pmatrix}\nc_{1} \\\\ c_{2} \\\\ \\lambda\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n0 \\\\ 0 \\\\ 1\n\\end{pmatrix}.\n$$\nFrom the first two equations,\n$$\n0.02c_{1}-0.04c_{2}-\\lambda=0,\\qquad -0.04c_{1}+0.08c_{2}-\\lambda=0,\n$$\nso eliminating $\\lambda$ gives\n$$\n0.02c_{1}-0.04c_{2}=-0.04c_{1}+0.08c_{2}\\;\\Rightarrow\\;0.06c_{1}=0.12c_{2}\\;\\Rightarrow\\;c_{1}=2c_{2}.\n$$\nWith the normalization constraint $c_{1}+c_{2}=1$, we obtain\n$$\n2c_{2}+c_{2}=1\\;\\Rightarrow\\;c_{2}=\\frac{1}{3},\\quad c_{1}=\\frac{2}{3}.\n$$\nThe extrapolated Fock matrix is $\\mathbf{F}_{\\text{DIIS}}=c_{1}\\mathbf{F}_{1}+c_{2}\\mathbf{F}_{2}$. Its off-diagonal element is\n$$\n(\\mathbf{F}_{\\text{DIIS}})_{12}=c_{1}(\\mathbf{F}_{1})_{12}+c_{2}(\\mathbf{F}_{2})_{12}\n=\\frac{2}{3}\\cdot 0.40+\\frac{1}{3}\\cdot 0.50=\\frac{1.30}{3}=0.433333\\ldots,\n$$\nwhich, rounded to three significant figures, is $0.433$.", "answer": "$$\\boxed{0.433}$$", "id": "1351239"}]}