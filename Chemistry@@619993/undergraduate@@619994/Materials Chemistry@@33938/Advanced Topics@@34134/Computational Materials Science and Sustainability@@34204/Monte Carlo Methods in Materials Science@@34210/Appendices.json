{"hands_on_practices": [{"introduction": "Monte Carlo simulations are powerful tools for modeling stochastic processes like atomic diffusion. This first practice provides a hands-on introduction to the core loop of a Monte Carlo algorithm. By manually tracing the random walk of an interstitial atom on a lattice, you will see how a sequence of random numbers and simple rules can be used to simulate a particle's dynamic path toward a target [@problem_id:1318228].", "problem": "In materials science, the diffusion of atoms can be modeled using Monte Carlo methods. Consider a simplified model of an interstitial atom diffusing in a two-dimensional crystal lattice until it is annihilated by a vacancy.\n\nThe system is a 2D square lattice of size $5 \\times 5$, where the coordinates $(x, y)$ of a site are integers such that $x, y \\in \\{0, 1, 2, 3, 4\\}$. A single stationary vacancy is located at the site $V = (3, 1)$. A single mobile interstitial atom is initially located at the site $I_0 = (1, 3)$.\n\nThe atom's movement is simulated in discrete time steps. At each step, a pseudo-random number $r$ is drawn from a uniform distribution on the interval $[0, 1)$. This number determines the direction of the atom's attempted jump to an adjacent site according to the following rules:\n- If $0 \\le r  0.25$, the atom attempts to move Right (to $(x+1, y)$).\n- If $0.25 \\le r  0.50$, the atom attempts to move Up (to $(x, y+1)$).\n- If $0.50 \\le r  0.75$, the atom attempts to move Left (to $(x-1, y)$).\n- If $0.75 \\le r  1.00$, the atom attempts to move Down (to $(x, y-1)$).\n\nThe lattice has rigid boundaries. If an attempted move would place the atom at coordinates outside the $5 \\times 5$ grid (i.e., with an $x$ or $y$ coordinate less than 0 or greater than 4), the atom does not move in that step; it remains at its current position.\n\nThe simulation ends when the interstitial atom's coordinates become identical to the vacancy's coordinates, at which point the two are considered to have annihilated.\n\nGiven the following sequence of pseudo-random numbers for the first 12 steps:\n$0.31, 0.82, 0.15, 0.55, 0.09, 0.41, 0.99, 0.68, 0.20, 0.77, 0.11, 0.80$\n\nDetermine the total number of steps required for the interstitial atom to annihilate at the vacancy site. Provide your answer as an integer representing the total number of steps.", "solution": "We have a $5 \\times 5$ lattice with site coordinates $(x,y)$ satisfying $x,y \\in \\{0,1,2,3,4\\}$. The vacancy is fixed at $V=(3,1)$ and the interstitial starts at $I_{0}=(1,3)$. At each discrete step, a pseudo-random number $r \\in [0,1)$ determines the attempted move by the rules: $r \\in [0,0.25)$ gives Right $(x,y)\\to(x+1,y)$, $r \\in [0.25,0.50)$ gives Up $(x,y)\\to(x,y+1)$, $r \\in [0.50,0.75)$ gives Left $(x,y)\\to(x-1,y)$, $r \\in [0.75,1.00)$ gives Down $(x,y)\\to(x,y-1)$. The boundaries are rigid: if a proposed move yields a coordinate outside $\\{0,1,2,3,4\\}$, the atom remains at its current site. The simulation ends when the interstitial reaches $V$.\n\nUsing the given sequence of $r$ values and applying the move rule with boundary checks at each step:\n\nStep $1$: $r=0.31 \\in [0.25,0.50)$, Up, attempt $(1,3)\\to(1,4)$ is inside the grid, so $I_{1}=(1,4)$.\n\nStep $2$: $r=0.82 \\in [0.75,1.00)$, Down, $(1,4)\\to(1,3)$ is valid, so $I_{2}=(1,3)$.\n\nStep $3$: $r=0.15 \\in [0,0.25)$, Right, $(1,3)\\to(2,3)$ valid, so $I_{3}=(2,3)$.\n\nStep $4$: $r=0.55 \\in [0.50,0.75)$, Left, $(2,3)\\to(1,3)$ valid, so $I_{4}=(1,3)$.\n\nStep $5$: $r=0.09 \\in [0,0.25)$, Right, $(1,3)\\to(2,3)$ valid, so $I_{5}=(2,3)$.\n\nStep $6$: $r=0.41 \\in [0.25,0.50)$, Up, $(2,3)\\to(2,4)$ valid, so $I_{6}=(2,4)$.\n\nStep $7$: $r=0.99 \\in [0.75,1.00)$, Down, $(2,4)\\to(2,3)$ valid, so $I_{7}=(2,3)$.\n\nStep $8$: $r=0.68 \\in [0.50,0.75)$, Left, $(2,3)\\to(1,3)$ valid, so $I_{8}=(1,3)$.\n\nStep $9$: $r=0.20 \\in [0,0.25)$, Right, $(1,3)\\to(2,3)$ valid, so $I_{9}=(2,3)$.\n\nStep $10$: $r=0.77 \\in [0.75,1.00)$, Down, $(2,3)\\to(2,2)$ valid, so $I_{10}=(2,2)$.\n\nStep $11$: $r=0.11 \\in [0,0.25)$, Right, $(2,2)\\to(3,2)$ valid, so $I_{11}=(3,2)$.\n\nStep $12$: $r=0.80 \\in [0.75,1.00)$, Down, $(3,2)\\to(3,1)$ valid, so $I_{12}=(3,1)=V$; annihilation occurs at the end of step $12$.\n\nTherefore, the total number of steps required is $12$.", "answer": "$$\\boxed{12}$$", "id": "1318228"}, {"introduction": "Building on the basic random walk, we now apply Monte Carlo methods to a more complex system: a polymer chain. This exercise demonstrates how specific move types, like the \"end-pivot\" move, are used to explore the vast conformational space of a macromolecule. You will calculate the radius of gyration, $R_g^2$, a key macroscopic property, and directly observe how physical confinement drastically alters the polymer's structure and behavior [@problem_id:1318246].", "problem": "A simplified model of a polymer chain is simulated on a two-dimensional square lattice with a lattice spacing of 1 unit. The polymer is represented as a self-avoiding chain of $N=5$ connected monomers. The conformation of the polymer can be characterized by its squared radius of gyration, $R_g^2$, defined as:\n$$R_g^2 = \\frac{1}{N} \\sum_{i=1}^{N} ||\\vec{r}_i - \\vec{R}_{cm}||^2$$\nwhere $\\vec{r}_i$ is the position vector of the $i$-th monomer and $\\vec{R}_{cm} = \\frac{1}{N} \\sum_{i=1}^{N} \\vec{r}_i$ is the center of mass of the chain.\n\nInitially, the five monomers, labeled $M_1$ to $M_5$, are arranged in a straight line with coordinates: $M_1=(0,0)$, $M_2=(1,0)$, $M_3=(2,0)$, $M_4=(3,0)$, and $M_5=(4,0)$.\n\nThe chain's configuration is updated using a Monte Carlo (MC) algorithm involving a series of \"end-pivot\" moves. An end-pivot move consists of selecting one of the two monomers at the ends of the chain and attempting to move it to a new lattice site. A move is successful only if the target site is adjacent (not diagonal) to that monomer's sole neighbor and is not occupied by any other monomer in the chain.\n\nWe will compare the polymer's behavior in two different environments by attempting the same sequence of three moves:\n1. Attempt to move the end-monomer $M_1$ to the new position $(1,1)$.\n2. Attempt to move the end-monomer $M_5$ to the new position $(3,1)$.\n3. Attempt to move the end-monomer that started at $M_1$'s initial position of $(0,0)$ to the new position $(0,0)$.\n\n**Scenario A (Unconfined):** The polymer is in an open, infinite 2D space.\n**Scenario B (Confined):** The polymer is in a nanochannel defined by two impenetrable horizontal walls at $y=0.5$ and $y=-0.5$. This confinement dictates that all monomers must have a y-coordinate of exactly 0 at all times. Any move attempting to place a monomer at a location with $y \\neq 0$ is rejected.\n\nLet $R_{g, \\text{unconfined}}^2$ be the final squared radius of gyration in Scenario A, and $R_{g, \\text{confined}}^2$ be the final squared radius of gyration in Scenario B. Calculate the ratio $\\frac{R_{g, \\text{unconfined}}^2}{R_{g, \\text{confined}}^2}$. Round your final answer to two significant figures.", "solution": "We use the definition of squared radius of gyration,\n$$R_{g}^{2}=\\frac{1}{N}\\sum_{i=1}^{N}\\|\\vec{r}_{i}-\\vec{R}_{cm}\\|^{2},\\quad \\vec{R}_{cm}=\\frac{1}{N}\\sum_{i=1}^{N}\\vec{r}_{i},$$\nwith $N=5$.\n\nInitial chain coordinates are $M_{1}=(0,0)$, $M_{2}=(1,0)$, $M_{3}=(2,0)$, $M_{4}=(3,0)$, $M_{5}=(4,0)$.\n\nEnd-pivot move rule: an end monomer may move to a target site if and only if (i) the target is adjacent (Manhattan distance 1) to its sole neighbor, and (ii) the target is not occupied by any other monomer. In the confined scenario, an additional constraint requires $y=0$ for all monomers; any move with target $y\\neq 0$ is rejected.\n\nScenario A (Unconfined):\n1) Move $M_{1}$ to $(1,1)$: target is adjacent to $M_{2}=(1,0)$ and unoccupied, so accepted. New positions: $(1,1),(1,0),(2,0),(3,0),(4,0)$ for $M_{1}$ to $M_{5}$.\n2) Move $M_{5}$ to $(3,1)$: target is adjacent to $M_{4}=(3,0)$ and unoccupied, so accepted. New positions: $M_{1}=(1,1)$, $M_{2}=(1,0)$, $M_{3}=(2,0)$, $M_{4}=(3,0)$, $M_{5}=(3,1)$.\n3) Move the end monomer that started at $(0,0)$ (i.e., $M_{1}$) to $(0,0)$: target is adjacent to $M_{2}=(1,0)$ and unoccupied, so accepted. Final positions:\n$$M_{1}=(0,0),\\; M_{2}=(1,0),\\; M_{3}=(2,0),\\; M_{4}=(3,0),\\; M_{5}=(3,1).$$\nCompute $\\vec{R}_{cm}$:\n$$\\vec{R}_{cm}=\\frac{1}{5}\\big((0+1+2+3+3),(0+0+0+0+1)\\big)=\\left(\\frac{9}{5},\\frac{1}{5}\\right).$$\nCompute the sum of squared distances:\n- For $(0,0)$: $\\left(-\\frac{9}{5}\\right)^{2}+\\left(-\\frac{1}{5}\\right)^{2}=\\frac{82}{25}$.\n- For $(1,0)$: $\\left(-\\frac{4}{5}\\right)^{2}+\\left(-\\frac{1}{5}\\right)^{2}=\\frac{17}{25}$.\n- For $(2,0)$: $\\left(\\frac{1}{5}\\right)^{2}+\\left(-\\frac{1}{5}\\right)^{2}=\\frac{2}{25}$.\n- For $(3,0)$: $\\left(\\frac{6}{5}\\right)^{2}+\\left(-\\frac{1}{5}\\right)^{2}=\\frac{37}{25}$.\n- For $(3,1)$: $\\left(\\frac{6}{5}\\right)^{2}+\\left(\\frac{4}{5}\\right)^{2}=\\frac{52}{25}$.\nSum $=\\frac{82+17+2+37+52}{25}=\\frac{190}{25}=\\frac{38}{5}$. Thus\n$$R_{g,\\text{unconfined}}^{2}=\\frac{1}{5}\\cdot\\frac{190}{25}=\\frac{38}{25}.$$\n\nScenario B (Confined: $y=0$ required):\n1) Move $M_{1}$ to $(1,1)$: rejected because target has $y\\neq 0$.\n2) Move $M_{5}$ to $(3,1)$: rejected because target has $y\\neq 0$.\n3) Move the end monomer that started at $(0,0)$ to $(0,0)$: this yields no change; final positions remain\n$$M_{1}=(0,0),\\; M_{2}=(1,0),\\; M_{3}=(2,0),\\; M_{4}=(3,0),\\; M_{5}=(4,0).$$\nCompute $\\vec{R}_{cm}=(2,0)$ and the sum of squared distances:\n$4+1+0+1+4=10$. Hence\n$$R_{g,\\text{confined}}^{2}=\\frac{1}{5}\\cdot 10=2.$$\n\nTherefore, the requested ratio is\n$$\\frac{R_{g,\\text{unconfined}}^{2}}{R_{g,\\text{confined}}^{2}}=\\frac{\\frac{38}{25}}{2}=\\frac{19}{25}=0.76.$$\nRounded to two significant figures, this is $0.76$.", "answer": "$$\\boxed{0.76}$$", "id": "1318246"}, {"introduction": "The most powerful applications of Monte Carlo in materials science involve simulating systems with well-defined energy landscapes. This practice introduces the cornerstone Metropolis algorithm, where move acceptance is determined by a change in energy, $\\Delta H$, and a system temperature, $T$. By evaluating a proposed swap in a model metamaterial, you will engage with the probabilistic decision-making that allows a system to evolve towards thermally equilibrated, low-energy states as in simulated annealing [@problem_id:1318218].", "problem": "In an effort to design a composite metamaterial with a near-zero coefficient of thermal expansion, a computational materials scientist employs a simulated annealing strategy. The material is modeled as a two-dimensional $4 \\times 4$ square lattice with periodic boundary conditions. Each site on the lattice is occupied by one of two phases: phase A, which has a positive thermal expansion coefficient, or phase B, which has a negative one. There are exactly 8 sites of phase A and 8 sites of phase B in the system.\n\nA simplified model is used to approximate the total internal strain energy, $H$, of a given microscopic arrangement of the phases. This energy function aims to penalize local phase imbalances, which are a source of thermal mismatch strain. The total energy is $H = \\sum_{p} H_p$. The energy $H_p$ of a single plaquette $p$ is given by:\n$$H_p = C \\left( n_A(p) - n_B(p) \\right)^2$$\nwhere $n_A(p)$ and $n_B(p)$ are the number of A and B sites within that plaquette, respectively. The total energy is $H = \\sum_{p} H_p$. The constant $C$ is given as $1.0 \\text{ J}$.\n\nThe system is currently in a state defined by the following configuration (using 0-based indexing for rows and columns, where (0,0) is the top-left site):\n$$\n\\begin{pmatrix}\n\\text{A}  \\text{A}  \\text{B}  \\text{B} \\\\\n\\text{A}  \\text{B}  \\text{B}  \\text{B} \\\\\n\\text{B}  \\text{A}  \\text{A}  \\text{A} \\\\\n\\text{B}  \\text{B}  \\text{A}  \\text{A}\n\\end{pmatrix}\n$$\nA single Metropolis Monte Carlo move is attempted at a temperature $T$ where the thermal energy is $k_B T = 8.0 \\text{ J}$, with $k_B$ being the Boltzmann constant. The proposed move is to swap the phase at site (1, 1) with the phase at site (2, 1). To determine whether to accept this move, a random number $r = 0.10$ is drawn from a uniform distribution on $[0, 1]$.\n\nCalculate the total energy of the material's configuration *after* this single Monte Carlo step is attempted. Express your answer in Joules, rounded to three significant figures.", "solution": "The lattice is a $4 \\times 4$ system with periodic boundaries. The total energy is $H=\\sum_{p} H_{p}$ over all $16$ plaquettes $p$, where for each plaquette\n$$\nH_{p}=C\\left(n_{A}(p)-n_{B}(p)\\right)^{2}.\n$$\nSince each plaquette has $n_{A}(p)+n_{B}(p)=4$, we have $n_{B}(p)=4-n_{A}(p)$ and\n$$\nn_{A}(p)-n_{B}(p)=2n_{A}(p)-4=2\\left(n_{A}(p)-2\\right),\n$$\nso with $C=1$,\n$$\nH_{p}=4\\left(n_{A}(p)-2\\right)^{2}.\n$$\nA Metropolis move swaps the phases at sites $(1,1)$ and $(2,1)$, which are $B$ and $A$ respectively before the swap. Only the plaquettes containing either site can change. A site $(r,c)$ belongs to the plaquettes with top-left coordinates $(r,c)$, $(r,c-1)$, $(r-1,c)$, $(r-1,c-1)$ (indices modulo $4$). Thus the affected plaquettes have top-left coordinates\n$$\n(0,0),\\ (0,1),\\ (1,0),\\ (1,1),\\ (2,0),\\ (2,1).\n$$\nCompute $n_{A}$ and $H_{p}$ before and after the swap for these:\n\n- For $(0,0)$: before $n_{A}=3 \\Rightarrow H_{p}=4$, after $n_{A}=4 \\Rightarrow H_{p}=16$, change $+12$.\n- For $(0,1)$: before $n_{A}=1 \\Rightarrow H_{p}=4$, after $n_{A}=2 \\Rightarrow H_{p}=0$, change $-4$.\n- For $(1,0)$: before $n_{A}=2 \\Rightarrow H_{p}=0$, after $n_{A}=2 \\Rightarrow H_{p}=0$, change $0$.\n- For $(1,1)$: before $n_{A}=2 \\Rightarrow H_{p}=0$, after $n_{A}=2 \\Rightarrow H_{p}=0$, change $0$.\n- For $(2,0)$: before $n_{A}=1 \\Rightarrow H_{p}=4$, after $n_{A}=0 \\Rightarrow H_{p}=16$, change $+12$.\n- For $(2,1)$: before $n_{A}=3 \\Rightarrow H_{p}=4$, after $n_{A}=2 \\Rightarrow H_{p}=0$, change $-4$.\n\nTherefore the total energy change is\n$$\n\\Delta H = (+12)+(-4)+0+0+(+12)+(-4)=+16.\n$$\nThe Metropolis acceptance probability at thermal energy $k_{B}T=8$ is\n$$\nP=\\min\\left(1,\\exp\\left(-\\frac{\\Delta H}{k_{B}T}\\right)\\right)=\\exp\\left(-\\frac{16}{8}\\right)=\\exp(-2).\n$$\nSince the random number is $r=0.10$ and $0.10\\exp(-2)$, the move is accepted.\n\nTo obtain the final total energy, compute the initial total energy $H_{\\text{old}}$ by summing over all $16$ plaquettes. The nonzero initial contributions are\n$$\nH_{(0,0)}=4,\\ H_{(0,1)}=4,\\ H_{(0,2)}=16,\\ H_{(2,0)}=4,\\ H_{(2,1)}=4,\\ H_{(2,2)}=16,\n$$\nwith all other $H_{p}=0$, giving\n$$\nH_{\\text{old}}=48.\n$$\nWith the accepted swap,\n$$\nH_{\\text{new}}=H_{\\text{old}}+\\Delta H=48+16=64.\n$$\nRounded to three significant figures, the total energy after the attempted step is $64.0$.", "answer": "$$\\boxed{64.0}$$", "id": "1318218"}]}