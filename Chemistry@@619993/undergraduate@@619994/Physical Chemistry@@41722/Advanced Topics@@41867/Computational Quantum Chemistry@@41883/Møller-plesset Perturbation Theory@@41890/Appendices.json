{"hands_on_practices": [{"introduction": "Understanding Møller-Plesset theory begins with grasping the relationship between its different energy components. Quantum chemistry software provides various energy values, and a key skill is to correctly identify and calculate the correlation energy from this output. This first exercise [@problem_id:1995089] provides a practical scenario to solidify your understanding of how the total MP2 energy, $E_{\\mathrm{MP2}}$, relates to the Hartree-Fock energy, $E_{\\mathrm{HF}}$, and the all-important second-order correlation energy, $E^{(2)}$.", "problem": "In a computational quantum chemistry study, the electronic ground state of the water molecule ($\\text{H}_2\\text{O}$) is investigated. The calculation employs Møller-Plesset (MP) perturbation theory to account for electron correlation, which is neglected in the simpler Hartree-Fock (HF) method.\n\nWithin the framework of MP theory, the total electronic energy is expressed as a series of corrections to the Hartree-Fock energy. The Hartree-Fock energy, $E_{\\mathrm{HF}}$, is itself the sum of the zeroth-order energy, $E^{(0)}$, and the first-order energy correction, $E^{(1)}$. The total energy up to the second order, known as the MP2 energy, is given by $E_{\\mathrm{MP2}} = E_{\\mathrm{HF}} + E^{(2)}$, where $E^{(2)}$ is the second-order energy correction. This second-order correction, $E^{(2)}$, is specifically referred to as the MP2 correlation energy, as it represents the leading-order correction for electron correlation beyond the mean-field approximation.\n\nFrom the computational output for the water molecule, the following energy components were obtained:\n- The zeroth-order energy, $E^{(0)}$, is $-85.914$ atomic units (a.u.).\n- The first-order energy correction, $E^{(1)}$, is $+9.891$ a.u.\n- The total MP2 energy, $E_{\\mathrm{MP2}}$, is $-76.223$ a.u.\n\nUsing this information, calculate the MP2 correlation energy, $E^{(2)}$, for the water molecule. Express your answer in atomic units (a.u.), rounded to three significant figures.", "solution": "In Møller-Plesset perturbation theory, the Hartree-Fock energy is the sum of the zeroth- and first-order terms:\n$$\nE_{\\mathrm{HF}} = E^{(0)} + E^{(1)}.\n$$\nWith the given values,\n$$\nE_{\\mathrm{HF}} = -85.914 + 9.891 = -76.023 \\text{ a.u.}\n$$\nThe MP2 total energy is related to the correlation energy by\n$$\nE_{\\mathrm{MP2}} = E_{\\mathrm{HF}} + E^{(2)} \\quad \\Rightarrow \\quad E^{(2)} = E_{\\mathrm{MP2}} - E_{\\mathrm{HF}}.\n$$\nSubstituting the values,\n$$\nE^{(2)} = -76.223 - (-76.023) = -0.200 \\text{ a.u.}\n$$\nRounded to three significant figures, the MP2 correlation energy is $-0.200$ in atomic units.", "answer": "$$\\boxed{-0.200}$$", "id": "1995089"}, {"introduction": "After mastering the basic definitions, it is crucial to connect the mathematics of MP theory to the underlying physical principles. A powerful way to test our conceptual understanding is through well-chosen thought experiments. This exercise [@problem_id:2458921] challenges you to consider a system with only one electron—the hydrogen atom—thereby forcing you to confront the fundamental origin of electron correlation and predict the outcome of an MPn calculation where electron-electron repulsion is absent.", "problem": "You perform a Møller-Plesset perturbation theory (MPn) calculation of order $n$ with $n>1$ on a single Hydrogen atom using a very large one-electron basis set that effectively spans the one-electron Hilbert space of the nonrelativistic Born-Oppenheimer electronic Hamiltonian. What value should you expect for the correlation energy predicted by the MPn correction beyond the Hartree-Fock reference, and why?\n\nA. Exactly $0$, because in a one-electron system the Hartree-Fock reference is exact and all MPn corrections vanish.\n\nB. A small negative number, because MPn always lowers the energy relative to Hartree-Fock regardless of the number of electrons.\n\nC. A small positive number that tends to $0$ only in the complete-basis limit, because basis-set incompleteness creates artificial correlation even for one electron.\n\nD. Divergent or undefined, because the perturbation denominators become singular when there is only one occupied orbital.", "solution": "The problem statement is subjected to validation before a solution is attempted.\n\n**Step 1: Extraction of Givens**\n- System: A single Hydrogen atom.\n- Quantum chemistry method: Møller-Plesset perturbation theory of order $n$ (MPn), with the condition $n > 1$.\n- Basis set: A \"very large one-electron basis set that effectively spans the one-electron Hilbert space,\" which is equivalent to the complete basis set (CBS) limit.\n- Hamiltonian: The nonrelativistic Born-Oppenheimer electronic Hamiltonian.\n- Question: The value of the MPn correlation energy.\n\n**Step 2: Validation and Verdict**\nThe problem is scientifically grounded, well-posed, and objective. It describes a standard theoretical scenario in quantum chemistry. The givens are self-contained and consistent. No flaws are identified. The problem is declared **valid**.\n\n**Derivation of the Solution**\nThe definition of the electronic correlation energy, $E_{\\mathrm{corr}}$, is the difference between the exact nonrelativistic electronic energy, $E_{\\mathrm{exact}}$, and the energy from a Hartree-Fock (HF) calculation in the limit of a complete basis set, $E_{\\mathrm{HF}}$:\n$$ E_{\\mathrm{corr}} = E_{\\mathrm{exact}} - E_{\\mathrm{HF}} $$\nWe must analyze the Hartree-Fock method for the specified system, a single Hydrogen atom, which is a one-electron system. The nonrelativistic electronic Hamiltonian for a one-electron atom with nuclear charge $Z$ is:\n$$ \\hat{H} = -\\frac{1}{2}\\nabla^2 - \\frac{Z}{r} $$\nFor the Hydrogen atom, $Z=1$. This Hamiltonian contains only one-electron terms (kinetic energy and nuclear-electron attraction). There are no two-electron terms (electron-electron repulsion).\n\nThe Hartree-Fock method approximates the many-electron problem. The central equation is the Hartree-Fock equation for each molecular orbital $\\psi_i$:\n$$ \\hat{f}_i \\psi_i = \\epsilon_i \\psi_i $$\nThe Fock operator, $\\hat{f}_i$, is defined as:\n$$ \\hat{f}_i = \\hat{h}(i) + \\sum_{j=1}^{N} \\left( \\hat{J}_j(i) - \\hat{K}_j(i) \\right) $$\nwhere $\\hat{h}(i)$ is the core-Hamiltonian operator (all one-electron terms), $\\hat{J}_j$ is the Coulomb operator, and $\\hat{K}_j$ is the exchange operator. For a one-electron system, $N=1$. The sum over occupied orbitals $j$ contains only the term for $j=1$. The term $(\\hat{J}_1(1) - \\hat{K}_1(1))$ represents the interaction of the electron with its own charge distribution. In the Hartree-Fock formalism, this self-interaction is exactly cancelled, i.e., $\\hat{J}_1 = \\hat{K}_1$. Consequently, the summation term vanishes. The Fock operator reduces to the core Hamiltonian:\n$$ \\hat{f}_1 = \\hat{h}(1) = -\\frac{1}{2}\\nabla_1^2 - \\frac{Z}{r_1} $$\nTherefore, for a one-electron system, the Hartree-Fock equation is identical to the exact electronic Schrödinger equation:\n$$ \\hat{H} \\psi_1 = E \\psi_1 $$\nThis means that the Hartree-Fock method provides the exact ground-state wavefunction and the exact ground-state energy for any one-electron system, provided a complete basis set is used. Thus, $E_{\\mathrm{HF}} = E_{\\mathrm{exact}}$.\n\nFrom the definition of correlation energy, we find:\n$$ E_{\\mathrm{corr}} = E_{\\mathrm{exact}} - E_{\\mathrm{HF}} = E_{\\mathrm{exact}} - E_{\\mathrm{exact}} = 0 $$\nThe correlation energy for a single Hydrogen atom is identically zero.\n\nMøller-Plesset perturbation theory (MPn) is a method to compute an approximation to this correlation energy. The MPn energy correction of order $n$ (for $n > 1$) is a term in the series expansion for $E_{\\mathrm{corr}}$. Since the true correlation energy is zero, every term in a correct expansion for it must also be zero.\n\nFormally, in MP theory, the Hamiltonian is partitioned as $\\hat{H} = \\hat{H}_0 + \\hat{V}$, where the unperturbed Hamiltonian $\\hat{H}_0$ is the sum of Fock operators and the perturbation $\\hat{V}$ is the difference between the true electron-electron repulsion and the mean-field Hartree-Fock potential. For a one-electron system, there is no electron-electron repulsion and no Hartree-Fock potential from other electrons. Therefore, the perturbation operator is identically zero:\n$$ \\hat{V} \\equiv 0 $$\nAll MP energy corrections for orders $k \\ge 2$ depend on matrix elements involving the perturbation operator, $\\hat{V}$. For example, the second-order correction is:\n$$ E^{(2)} = \\sum_{D \\neq \\Psi_0} \\frac{|\\langle \\Psi_D | \\hat{V} | \\Psi_0 \\rangle|^2}{E_0 - E_D} $$\nSince $\\hat{V} = 0$, the numerator of every term is zero, and thus $E^{(2)}=0$. Similarly, all higher-order corrections, $E^{(3)}, E^{(4)}, \\dots$, are also functions of matrix elements of $\\hat{V}$ and will be exactly zero. The total MPn correlation energy for any $n>1$ is the sum of these corrections:\n$$ E_{\\mathrm{corr}}^{(\\mathrm{MPn})} = \\sum_{k=2}^{n} E^{(k)} = \\sum_{k=2}^{n} 0 = 0 $$\nThe value expected for the MPn correlation energy is exactly $0$.\n\n**Evaluation of Options**\n\nA. Exactly $0$, because in a one-electron system the Hartree-Fock reference is exact and all MPn corrections vanish.\nThis statement is fully consistent with the derivation above. The Hartree-Fock method is exact for a one-electron system, meaning the correlation energy is by definition zero. Consequently, any valid method for calculating correlation energy, such as MPn, must yield a result of zero. This is because the perturbation operator itself is zero.\n**Verdict: Correct.**\n\nB. A small negative number, because MPn always lowers the energy relative to Hartree-Fock regardless of the number of electrons.\nThis statement is incorrect. While the MP2 correction, $E^{(2)}$, is indeed always less than or equal to zero, higher-order corrections ($E^{(3)}$, etc.) are not guaranteed to be negative. More importantly, the premise that a correction must exist is false for a one-electron system. The number of electrons is a critical factor, and for $N=1$, there is no correlation to recover.\n**Verdict: Incorrect.**\n\nC. A small positive number that tends to $0$ only in the complete-basis limit, because basis-set incompleteness creates artificial correlation even for one electron.\nThis statement is incorrect on multiple grounds. First, correlation energy is a non-positive quantity by definition, so it cannot be a \"small positive number.\" Second, basis set incompleteness does not \"create artificial correlation.\" Basis set incompleteness error (BSIE) is a separate source of error from the error due to the approximation of electron correlation. For a one-electron system, the MPn correlation energy is zero regardless of whether the basis set is finite or complete, because the perturbation operator is always zero. The problem statement's condition of a complete basis set makes the premise of this option moot.\n**Verdict: Incorrect.**\n\nD. Divergent or undefined, because the perturbation denominators become singular when there is only one occupied orbital.\nThis statement is incorrect. The expression for the second-order Møller-Plesset energy, $E^{(2)}$, involves a sum over pairs of occupied orbitals $i, j$. For a one-electron system, one cannot form a pair of occupied orbitals, so the sum is empty and $E^{(2)}$ is simply $0$, not divergent. The perturbation denominators, of the form $\\epsilon_i - \\epsilon_a$ for single excitations or $\\epsilon_i + \\epsilon_j - \\epsilon_a - \\epsilon_b$ for double excitations, are not inherently singular. The fundamental reason the correction is zero is that the numerators, which contain the perturbation matrix elements, are all zero.\n**Verdict: Incorrect.**", "answer": "$$\\boxed{A}$$", "id": "2458921"}, {"introduction": "Moving from conceptual understanding to practical implementation is a hallmark of a proficient computational chemist. This final practice [@problem_id:2458952] invites you to look 'under the hood' by implementing the MP2 energy expression yourself. By taking fundamental building blocks—orbital energies like $\\epsilon_i$ and $\\epsilon_a$, and two-electron integrals such as $\\langle ij || ab \\rangle$—and computing the second-order correlation energy, you will gain a deep, hands-on appreciation for how the theory translates into tangible results.", "problem": "You are given a closed-shell reference in Møller-Plesset perturbation theory (MPn), specifically second-order Møller-Plesset perturbation theory (MP2). Let $N_{\\mathrm{occ}}$ be the number of occupied molecular orbitals and $N_{\\mathrm{virt}}$ be the number of virtual molecular orbitals, all expressed in the canonical Hartree-Fock (HF) molecular orbital basis. You are provided the occupied orbital energies $\\{\\epsilon_i\\}_{i=1}^{N_{\\mathrm{occ}}}$ in Hartree and the virtual orbital energies $\\{\\epsilon_a\\}_{a=1}^{N_{\\mathrm{virt}}}$ in Hartree. You are also provided the antisymmetrized two-electron integrals over spatial orbitals $\\langle ij || ab \\rangle$ (in Hartree), where $i,j \\in \\{1,\\dots,N_{\\mathrm{occ}}\\}$ and $a,b \\in \\{1,\\dots,N_{\\mathrm{virt}}\\}$. The antisymmetrized two-electron integral is defined by $\\langle ij || ab \\rangle = \\langle ij | ab \\rangle - \\langle ij | ba \\rangle$ and obeys the relations $\\langle ij || ab \\rangle = - \\langle ji || ab \\rangle = - \\langle ij || ba \\rangle = \\langle ji || ba \\rangle$; all quantities are real. The second-order correlation energy is defined by\n$$\nE^{(2)} \\;=\\; \\frac{1}{4} \\sum_{i=1}^{N_{\\mathrm{occ}}} \\sum_{j=1}^{N_{\\mathrm{occ}}} \\sum_{a=1}^{N_{\\mathrm{virt}}} \\sum_{b=1}^{N_{\\mathrm{virt}}} \\frac{\\big(\\langle ij || ab \\rangle\\big)^2}{\\epsilon_i + \\epsilon_j - \\epsilon_a - \\epsilon_b},\n$$\nwith the energy expressed in Hartree.\n\nYour task is to write a complete, runnable program that evaluates $E^{(2)}$ for each of the following test cases. In each test case, the data are specified as follows:\n- The list of occupied energies $\\{\\epsilon_i\\}$ in Hartree.\n- The list of virtual energies $\\{\\epsilon_a\\}$ in Hartree.\n- A list of independent nonzero components of $\\langle ij || ab \\rangle$ given only for index pairs satisfying $i < j$ and $a < b$. All nonlisted components are zero. The full antisymmetrized tensor is defined by the antisymmetry relations above.\n\nTest Suite:\n1) $N_{\\mathrm{occ}} = 2$, $N_{\\mathrm{virt}} = 2$.\n   - $\\{\\epsilon_i\\} = [-0.5, -0.4]$ Hartree.\n   - $\\{\\epsilon_a\\} = [0.1, 0.2]$ Hartree.\n   - Nonzero independent integrals (Hartree): $(i,j,a,b,\\langle ij || ab \\rangle) = (1,2,1,2,0.06)$.\n\n2) $N_{\\mathrm{occ}} = 2$, $N_{\\mathrm{virt}} = 2$.\n   - $\\{\\epsilon_i\\} = [-0.5, -0.35]$ Hartree.\n   - $\\{\\epsilon_a\\} = [0.15, 0.25]$ Hartree.\n   - No nonzero independent integrals (all $\\langle ij || ab \\rangle = 0$).\n\n3) $N_{\\mathrm{occ}} = 1$, $N_{\\mathrm{virt}} = 1$.\n   - $\\{\\epsilon_i\\} = [-0.6]$ Hartree.\n   - $\\{\\epsilon_a\\} = [0.3]$ Hartree.\n   - No nonzero independent integrals (all $\\langle ij || ab \\rangle = 0$).\n\n4) $N_{\\mathrm{occ}} = 3$, $N_{\\mathrm{virt}} = 2$.\n   - $\\{\\epsilon_i\\} = [-0.8, -0.6, -0.5]$ Hartree.\n   - $\\{\\epsilon_a\\} = [0.1, 0.3]$ Hartree.\n   - Nonzero independent integrals (Hartree):\n     $(1,2,1,2,0.04)$, $(1,3,1,2,0.05)$, $(2,3,1,2,0.03)$.\n\n5) $N_{\\mathrm{occ}} = 2$, $N_{\\mathrm{virt}} = 3$.\n   - $\\{\\epsilon_i\\} = [-0.7, -0.45]$ Hartree.\n   - $\\{\\epsilon_a\\} = [0.2, 0.25, 0.5]$ Hartree.\n   - Nonzero independent integrals (Hartree):\n     $(1,2,1,2,0.02)$, $(1,2,1,3,-0.03)$, $(1,2,2,3,0.01)$.\n\nOutput specification:\n- Compute $E^{(2)}$ in Hartree for each test case.\n- Round each result to $10$ digits after the decimal point.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, with no spaces. For example: \"[x1,x2,x3,x4,x5]\". The unit of each entry is Hartree.\n\nAnswer in Hartree, rounded to ten digits after the decimal point, as specified above.", "solution": "The problem requires the computation of the second-order Møller-Plesset perturbation theory (MP2) correlation energy, denoted as $E^{(2)}$, for a closed-shell system. Before proceeding to the solution, a critical validation of the problem statement is required.\n\n**Problem Validation**\n\nStep 1: Extracted Givens.\n- The formula for the MP2 energy is provided:\n$$\nE^{(2)} \\;=\\; \\frac{1}{4} \\sum_{i=1}^{N_{\\mathrm{occ}}} \\sum_{j=1}^{N_{\\mathrm{occ}}} \\sum_{a=1}^{N_{\\mathrm{virt}}} \\sum_{b=1}^{N_{\\mathrm{virt}}} \\frac{\\big(\\langle ij || ab \\rangle\\big)^2}{\\epsilon_i + \\epsilon_j - \\epsilon_a - \\epsilon_b}\n$$\n- $N_{\\mathrm{occ}}$ is the number of occupied orbitals and $N_{\\mathrm{virt}}$ is the number of virtual orbitals.\n- $\\{\\epsilon_i\\}$ and $\\{\\epsilon_a\\}$ are the occupied and virtual orbital energies, respectively.\n- $\\langle ij || ab \\rangle$ are antisymmetrized two-electron integrals, defined as $\\langle ij || ab \\rangle = \\langle ij | ab \\rangle - \\langle ij | ba \\rangle$.\n- The integrals obey the symmetry relations: $\\langle ij || ab \\rangle = - \\langle ji || ab \\rangle = - \\langle ij || ba \\rangle = \\langle ji || ba \\rangle$.\n- For each test case, lists of $\\{\\epsilon_i\\}$, $\\{\\epsilon_a\\}$, and nonzero components of $\\langle ij || ab \\rangle$ for index pairs satisfying $i < j$ and $a < b$ are given. All non-listed components are specified to be zero.\n\nStep 2: Validation of Givens.\n- **Scientific Grounding**: The problem is based on established principles of quantum chemistry, specifically MP2 theory. The formula for $E^{(2)}$ and the properties of the integrals are standard, though the specific formulation of $E^{(2)}$ provided is one of several forms and relies on certain implicit assumptions which are clarified by the problem's constraints.\n- **Well-Posedness**: The problem is well-posed. A clear objective function ($E^{(2)}$) is provided, along with all necessary input data for each test case. A unique solution exists and is obtainable through direct computation.\n- **Objectivity**: The problem is stated in precise, objective mathematical language, free of ambiguity or subjective claims.\n- **Consistency and Completeness**: The problem statement is self-contained and internally consistent. The constraint that only integrals with $i < j$ and $a < b$ are provided as non-zero implies that all other integrals, including those with $i=j$, are zero. This is a simplification, but a valid one within the definition of the problem.\n\nStep 3: Verdict.\nThe problem is deemed valid. A solution can be derived.\n\n**Solution Derivation**\n\nThe core of the problem is the evaluation of the four-fold summation for $E^{(2)}$. A direct, naive implementation would be computationally inefficient. A more rigorous approach involves exploiting the symmetry of the terms in the sum.\n\nThe summand is $T_{ijab} = \\frac{\\big(\\langle ij || ab \\rangle\\big)^2}{\\epsilon_i + \\epsilon_j - \\epsilon_a - \\epsilon_b}$.\nThe denominator, $D_{ijab} = \\epsilon_i + \\epsilon_j - \\epsilon_a - \\epsilon_b$, is symmetric with respect to the interchange of $i$ and $j$, and of $a$ and $b$. That is, $D_{ijab} = D_{jiab} = D_{ijba} = D_{jiba}$.\nThe numerator, $\\big(\\langle ij || ab \\rangle\\big)^2$, exhibits the same symmetry due to the given antisymmetry relations:\n$\\big(\\langle ji || ab \\rangle\\big)^2 = \\big(-\\langle ij || ab \\rangle\\big)^2 = \\big(\\langle ij || ab \\rangle\\big)^2$.\n$\\big(\\langle ij || ba \\rangle\\big)^2 = \\big(-\\langle ij || ab \\rangle\\big)^2 = \\big(\\langle ij || ab \\rangle\\big)^2$.\nConsequently, the term $T_{ijab}$ is invariant under these index permutations: $T_{ijab} = T_{jiab} = T_{ijba} = T_{jiba}$.\n\nThe summation runs over all indices $i,j \\in \\{1,...,N_{\\mathrm{occ}}\\}$ and $a,b \\in \\{1,...,N_{\\mathrm{virt}}\\}$. We can analyze the sum by considering two cases for the indices.\n\n1.  Cases where indices are equal:\n    - If $a=b$, the integral $\\langle ij || aa \\rangle = \\langle ij|aa \\rangle - \\langle ij|aa \\rangle = 0$ by definition. All terms where $a=b$ are thus zero.\n    - If $i=j$, the integral is $\\langle ii || ab \\rangle$. The problem statement specifies that only integrals with $i < j$ (and $a < b$) can be non-zero, and that \"all nonlisted components are zero.\" This implies that all integrals with $i=j$ are identically zero. Therefore, all terms where $i=j$ are zero.\n\n2.  Cases where indices are distinct: $i \\ne j$ and $a \\ne b$.\n    The full sum over all $i,j,a,b$ can be rewritten by restricting the indices to ordered pairs to avoid overcounting. For any specific set of four distinct indices $\\{i_0, j_0\\}$ and $\\{a_0, b_0\\}$, where we may choose $i_0 < j_0$ and $a_0 < b_0$, the full unrestricted sum contains four identical terms: $T_{i_0j_0a_0b_0}$, $T_{j_0i_0a_0b_0}$, $T_{i_0j_0b_0a_0}$, and $T_{j_0i_0b_0a_0}$.\n    The total sum over all $i,j,a,b$ (where $i \\ne j, a \\ne b$) is therefore equivalent to four times the sum over ordered, distinct indices:\n    $$ \\sum_{i \\ne j}^{\\mathrm{occ}} \\sum_{a \\ne b}^{\\mathrm{virt}} T_{ijab} = \\sum_{i < j}^{\\mathrm{occ}} \\sum_{a < b}^{\\mathrm{virt}} 4 \\cdot T_{ijab} $$\n    Substituting this into the original expression for $E^{(2)}$:\n    $$ E^{(2)} = \\frac{1}{4} \\left( \\sum_{i < j}^{\\mathrm{occ}} \\sum_{a < b}^{\\mathrm{virt}} 4 \\cdot \\frac{\\big(\\langle ij || ab \\rangle\\big)^2}{\\epsilon_i + \\epsilon_j - \\epsilon_a - \\epsilon_b} \\right) $$\n    The factors of $4$ and $\\frac{1}{4}$ cancel. This yields the simplified, computationally efficient formula:\n    $$ E^{(2)} = \\sum_{i < j}^{\\mathrm{occ}} \\sum_{a < b}^{\\mathrm{virt}} \\frac{\\big(\\langle ij || ab \\rangle\\big)^2}{\\epsilon_i + \\epsilon_j - \\epsilon_a - \\epsilon_b} $$\n    This final expression is what must be implemented. The calculation proceeds by summing the contributions from the provided list of non-zero integrals, as these are already specified for $i < j$ and $a < b$.\n\n**Algorithm**\nFor each test case:\n1.  Initialize the energy $E^{(2)}$ to $0$.\n2.  Retrieve the lists of occupied energies $\\{\\epsilon_i\\}$, virtual energies $\\{\\epsilon_a\\}$, and the list of non-zero integrals. The energies should be stored in zero-indexed arrays for computational convenience.\n3.  Iterate through each provided integral tuple $(i, j, a, b, V)$, where $V = \\langle ij || ab \\rangle$ and the indices are $1$-based.\n4.  For each integral, identify the corresponding orbital energies using $0$-based array indices: $\\epsilon_{i-1}$, $\\epsilon_{j-1}$, $\\epsilon_{a-1}$, $\\epsilon_{b-1}$.\n5.  Calculate the energy denominator $D = \\epsilon_{i-1} + \\epsilon_{j-1} - \\epsilon_{a-1} - \\epsilon_{b-1}$. The conditions of the problem (occupied energies are negative, virtual are positive) ensure $D$ is always negative and non-zero, avoiding singularities.\n6.  Compute the contribution to the energy for this term: $\\frac{V^2}{D}$.\n7.  Add this contribution to the total energy $E^{(2)}$.\n8.  After iterating through all provided integrals, the total sum is the final $E^{(2)}$ for the test case.\n9.  The result must be formatted to $10$ decimal places as required.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the MP2 correlation energy for a series of test cases.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"eps_occ\": np.array([-0.5, -0.4]),\n            \"eps_virt\": np.array([0.1, 0.2]),\n            \"integrals\": [\n                (1, 2, 1, 2, 0.06)\n            ],\n        },\n        {\n            \"eps_occ\": np.array([-0.5, -0.35]),\n            \"eps_virt\": np.array([0.15, 0.25]),\n            \"integrals\": [],\n        },\n        {\n            \"eps_occ\": np.array([-0.6]),\n            \"eps_virt\": np.array([0.3]),\n            \"integrals\": [],\n        },\n        {\n            \"eps_occ\": np.array([-0.8, -0.6, -0.5]),\n            \"eps_virt\": np.array([0.1, 0.3]),\n            \"integrals\": [\n                (1, 2, 1, 2, 0.04),\n                (1, 3, 1, 2, 0.05),\n                (2, 3, 1, 2, 0.03),\n            ],\n        },\n        {\n            \"eps_occ\": np.array([-0.7, -0.45]),\n            \"eps_virt\": np.array([0.2, 0.25, 0.5]),\n            \"integrals\": [\n                (1, 2, 1, 2, 0.02),\n                (1, 2, 1, 3, -0.03),\n                (1, 2, 2, 3, 0.01),\n            ],\n        },\n    ]\n\n    results = []\n    for case in test_cases:\n        e2_corr = calculate_mp2_energy(case[\"eps_occ\"], case[\"eps_virt\"], case[\"integrals\"])\n        results.append(e2_corr)\n    \n    # Format the results to 10 decimal places and create the output string.\n    formatted_results = [f\"{res:.10f}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\ndef calculate_mp2_energy(eps_occ, eps_virt, integrals):\n    \"\"\"\n    Calculates the MP2 correlation energy based on the simplified formula.\n\n    $$\n    E^{(2)} = \\sum_{i < j}^{\\mathrm{occ}} \\sum_{a < b}^{\\mathrm{virt}} \\frac{\\big(\\langle ij || ab \\rangle\\big)^2}{\\epsilon_i + \\epsilon_j - \\epsilon_a - \\epsilon_b}\n    $$\n\n    Args:\n        eps_occ (np.ndarray): Array of occupied orbital energies.\n        eps_virt (np.ndarray): Array of virtual orbital energies.\n        integrals (list): A list of tuples, where each tuple contains\n                          (i, j, a, b, value) for a non-zero antisymmetrized\n                          two-electron integral. Indices are 1-based.\n    \n    Returns:\n        float: The calculated MP2 correlation energy E(2).\n    \"\"\"\n    e2_corr = 0.0\n\n    for i, j, a, b, value in integrals:\n        # Convert 1-based indices to 0-based for array access\n        i_idx, j_idx = i - 1, j - 1\n        a_idx, b_idx = a - 1, b - 1\n        \n        # Get orbital energies\n        eps_i = eps_occ[i_idx]\n        eps_j = eps_occ[j_idx]\n        eps_a = eps_virt[a_idx]\n        eps_b = eps_virt[b_idx]\n        \n        # Calculate the energy denominator\n        denominator = eps_i + eps_j - eps_a - eps_b\n        \n        # Add the contribution to the total E(2) energy\n        if denominator != 0:\n            e2_corr += (value**2) / denominator\n            \n    return e2_corr\n\nsolve()\n```", "id": "2458952"}]}