{"hands_on_practices": [{"introduction": "The activation of a B cell is not a deterministic event, but a stochastic process governed by the probability of forming sufficient signaling microclusters at the cell surface. This exercise provides a quantitative framework for understanding how different signals, one from the B cell receptor (BCR) and another from a co-receptor like Toll-like receptor 9 (TLR9), integrate to determine the likelihood of activation. By modeling these independent signaling events as Poisson processes, you can directly calculate the synergistic effect of an adjuvant (a TLR agonist) on the B cell response to a given antigen density, a core concept in vaccine design [@problem_id:2850066].", "problem": "In a lymph node follicle, naive B cells scan antigen displayed on follicular dendritic cells. Early extrafollicular plasmablast output depends on whether a B cell becomes activated during a short decision window set by intracellular signaling dynamics. Model activation-competent microcluster formation arising from B cell receptor (BCR) engagement and Toll-like receptor 9 (TLR9) signaling as independent Poisson processes over the window. Let the expected number of BCR-derived activation-competent events be $\\lambda_{\\text{BCR}}=\\beta_{\\text{BCR}} D$, and the expected number of TLR9-derived activation-competent events be $\\lambda_{\\text{TLR}}=\\beta_{\\text{TLR}} D$, where $D$ is the antigen surface density on the scanning membrane, $\\beta_{\\text{BCR}}$ and $\\beta_{\\text{TLR}}$ are proportionality constants, and TLR9 denotes Toll-like receptor $9$ while BCR denotes the B cell receptor. Assume activation occurs if and only if at least one activation-competent event occurs during the window. In the absence of a TLR9 agonist, only the BCR-driven process operates; in the presence of a TLR9 agonist (e.g., a CpG oligodeoxynucleotide), both processes operate.\n\nStarting from the properties of Poisson processes and the complement rule for the probability of at least one event, first derive the activation probability as a function of $D$ for the no-agonist and agonist conditions. Then, for antigen density $D=100$ (molecules per $\\mu\\text{m}^2$), $\\beta_{\\text{BCR}}=0.01$, and $\\beta_{\\text{TLR}}=0.02$, compute the change in activation probability upon adding the TLR9 agonist, defined as $\\Delta P = P_{\\text{with}}(D)-P_{\\text{without}}(D)$. Round your answer to four significant figures and express it as a decimal (unitless).", "solution": "The problem statement is first subjected to validation.\n\n### Step 1: Extract Givens\n- The formation of activation-competent microclusters from B cell receptor (BCR) engagement and Toll-like receptor 9 (TLR9) signaling are modeled as independent Poisson processes.\n- The expected number of BCR-derived events is $\\lambda_{\\text{BCR}}=\\beta_{\\text{BCR}} D$.\n- The expected number of TLR9-derived events is $\\lambda_{\\text{TLR}}=\\beta_{\\text{TLR}} D$.\n- $D$ is the antigen surface density.\n- $\\beta_{\\text{BCR}}$ and $\\beta_{\\text{TLR}}$ are proportionality constants.\n- Activation occurs if and only if at least one activation-competent event occurs during a fixed decision window.\n- In the absence of a TLR9 agonist, only the BCR-driven process operates.\n- In the presence of a TLR9 agonist, both processes operate.\n- Numerical values provided for a specific calculation: $D=100$ molecules per $\\mu\\text{m}^2$, $\\beta_{\\text{BCR}}=0.01$, and $\\beta_{\\text{TLR}}=0.02$.\n- The objective is to derive the activation probability functions $P_{\\text{without}}(D)$ and $P_{\\text{with}}(D)$, and then compute the change $\\Delta P = P_{\\text{with}}(D)-P_{\\text{without}}(D)$ for the given numerical values, rounded to four significant figures.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientifically Grounded**: The problem uses a standard quantitative biology approach, modeling a stochastic cellular process (B cell activation) with a well-understood statistical model (Poisson process). The roles of BCR and TLR9 in B cell immunology are established facts. The model is a simplification, but it is scientifically sound and not based on pseudoscience.\n- **Well-Posed**: The problem is well-posed. It provides a clear theoretical framework, all necessary parameters, and an unambiguous definition of the quantities to be derived and calculated. A unique solution exists.\n- **Objective**: The problem is stated in precise, objective language.\n- **Complete and Consistent**: All necessary information is provided. The assumption of independence between the two Poisson processes is explicitly stated, which is critical for the solution. There are no contradictions.\n\n### Step 3: Verdict and Action\nThe problem is valid. We proceed with the solution.\n\nThe probability of observing exactly $k$ events for a Poisson process with an expected number (mean) of events $\\lambda$ is given by the probability mass function:\n$$P(N=k) = \\frac{\\lambda^k \\exp(-\\lambda)}{k!}$$\nActivation is defined as the occurrence of at least one event, i.e., $N \\ge 1$. It is more direct to calculate the probability of the complement event, which is the occurrence of zero events ($N=0$), and subtract this from $1$.\nThe probability of zero events is:\n$$P(N=0) = \\frac{\\lambda^0 \\exp(-\\lambda)}{0!} = \\exp(-\\lambda)$$\nTherefore, the probability of activation, $P_{\\text{act}}$, which is $P(N \\ge 1)$, is:\n$$P_{\\text{act}} = 1 - P(N=0) = 1 - \\exp(-\\lambda)$$\n\nFirst, we derive the activation probability in the absence of a TLR9 agonist, denoted $P_{\\text{without}}(D)$. In this case, only the BCR-driven process is active. The mean number of events is $\\lambda_{\\text{BCR}} = \\beta_{\\text{BCR}} D$.\nThe activation probability is:\n$$P_{\\text{without}}(D) = 1 - \\exp(-\\lambda_{\\text{BCR}}) = 1 - \\exp(-\\beta_{\\text{BCR}} D)$$\n\nNext, we derive the activation probability in the presence of a TLR9 agonist, denoted $P_{\\text{with}}(D)$. Here, both BCR and TLR9 processes operate. The problem states they are independent. Activation fails to occur only if *both* processes yield zero events. Let $N_{\\text{BCR}}$ and $N_{\\text{TLR}}$ be the number of events from each process. The probability of no activation is:\n$$P(\\text{no activation}) = P(N_{\\text{BCR}}=0 \\text{ and } N_{\\text{TLR}}=0)$$\nDue to the independence of the processes:\n$$P(\\text{no activation}) = P(N_{\\text{BCR}}=0) \\times P(N_{\\text{TLR}}=0) = \\exp(-\\lambda_{\\text{BCR}}) \\times \\exp(-\\lambda_{\\text{TLR}})$$\n$$P(\\text{no activation}) = \\exp(-(\\lambda_{\\text{BCR}} + \\lambda_{\\text{TLR}}))$$\nThe activation probability, $P_{\\text{with}}(D)$, is the complement of this:\n$$P_{\\text{with}}(D) = 1 - P(\\text{no activation}) = 1 - \\exp(-(\\lambda_{\\text{BCR}} + \\lambda_{\\text{TLR}}))$$\nSubstituting the given expressions for $\\lambda_{\\text{BCR}}$ and $\\lambda_{\\text{TLR}}$:\n$$P_{\\text{with}}(D) = 1 - \\exp(-(\\beta_{\\text{BCR}} D + \\beta_{\\text{TLR}} D)) = 1 - \\exp(-(\\beta_{\\text{BCR}} + \\beta_{\\text{TLR}})D)$$\nNote that this is equivalent to considering a single combined Poisson process for total activation events, which has a rate equal to the sum of the individual rates, $\\lambda_{\\text{total}} = \\lambda_{\\text{BCR}} + \\lambda_{\\text{TLR}}$, a known property of independent Poisson processes.\n\nNow, we compute the change in activation probability, $\\Delta P = P_{\\text{with}}(D) - P_{\\text{without}}(D)$, using the derived expressions:\n$$\\Delta P = \\left(1 - \\exp(-(\\beta_{\\text{BCR}} + \\beta_{\\text{TLR}})D)\\right) - \\left(1 - \\exp(-\\beta_{\\text{BCR}} D)\\right)$$\n$$\\Delta P = 1 - \\exp(-(\\beta_{\\text{BCR}} + \\beta_{\\text{TLR}})D) - 1 + \\exp(-\\beta_{\\text{BCR}} D)$$\n$$\\Delta P = \\exp(-\\beta_{\\text{BCR}} D) - \\exp(-(\\beta_{\\text{BCR}} + \\beta_{\\text{TLR}})D)$$\n\nWe are given the numerical values $D=100$, $\\beta_{\\text{BCR}}=0.01$, and $\\beta_{\\text{TLR}}=0.02$. First, we calculate the values of the Poisson means, $\\lambda$:\n$$\\lambda_{\\text{BCR}} = \\beta_{\\text{BCR}} D = 0.01 \\times 100 = 1$$\n$$\\lambda_{\\text{TLR}} = \\beta_{\\text{TLR}} D = 0.02 \\times 100 = 2$$\nThe total rate in the presence of the agonist is $\\lambda_{\\text{total}} = \\lambda_{\\text{BCR}} + \\lambda_{\\text{TLR}} = 1 + 2 = 3$.\n\nNow we substitute these values into the expression for $\\Delta P$:\n$$\\Delta P = \\exp(-\\lambda_{\\text{BCR}}) - \\exp(-(\\lambda_{\\text{BCR}} + \\lambda_{\\text{TLR}}))$$\n$$\\Delta P = \\exp(-1) - \\exp(-3)$$\nWe compute the numerical value:\n$$\\exp(-1) \\approx 0.36787944...$$\n$$\\exp(-3) \\approx 0.04978707...$$\n$$\\Delta P \\approx 0.36787944 - 0.04978707 = 0.31809237...$$\nRounding the result to four significant figures gives $0.3181$.", "answer": "$$\\boxed{0.3181}$$", "id": "2850066"}, {"introduction": "A central task in experimental immunology is to quantify the frequency of rare cells, such as the antigen-specific plasmablasts that arise after an immune response. This practice guides you through the analysis of a limiting dilution experiment, a foundational technique for this purpose, using data from an Enzyme-Linked ImmunoSpot (ELISPOT) assay. By applying the principles of the Poisson distribution and maximum likelihood estimation, you will learn to derive the frequency of antibody-secreting cells directly from the number of negative wells, translating raw experimental results into a meaningful biological parameter [@problem_id:2850138].", "problem": "A mouse has been immunized with a T-dependent protein antigen, and on day 7 the spleen contains a mixture of antigen-experienced B cell progeny: short-lived plasmablasts, emerging plasma cells, and some early memory B cells. An Enzyme-Linked ImmunoSpot (ELISPOT) assay is used to enumerate antigen-specific antibody-secreting cells, reasoning that a well will be scored positive if at least one antigen-specific antibody-secreting cell (plasmablast or plasma cell) is present and produces a spot. You thoroughly mix splenocytes and plate 12 wells, each with $c = 100{,}000$ viable splenocytes. You observe 9 positive wells and 3 negative wells. Assume that antigen-specific antibody-secreting cells are rare, independently and randomly distributed among wells, such that the count of antigen-specific cells per well follows a Poisson process, and that plating and detection are perfect. Prior flow cytometry estimated approximately 1 antigen-specific antibody-secreting cell per 10,000 splenocytes in similar mice, but you will infer the frequency directly from the ELISPOT data by limiting dilution reasoning.\n\nUsing only these assumptions and starting from the definition of the Poisson distribution for rare independent events, derive the maximum likelihood estimate of the frequency $f$ of antigen-specific antibody-secreting cells among total splenocytes. Provide your final answer as a single closed-form analytic expression in terms of the natural logarithm; do not approximate numerically. No units are required.", "solution": "The problem statement is first subjected to rigorous validation.\n\n**Givens Extracted:**\n- Total wells plated: $N=12$.\n- Observed number of positive wells: $k_{pos}=9$.\n- Observed number of negative wells: $k_{neg}=3$.\n- Number of splenocytes plated per well: $c = 100{,}000 = 10^5$.\n- The count of antigen-specific antibody-secreting cells (ASCs) per well is assumed to follow a Poisson process.\n- The objective is to derive the maximum likelihood estimate (MLE) of the frequency of ASCs, denoted as $f$.\n\n**Validation Verdict:**\nThe problem is valid. It presents a textbook case of limiting dilution analysis, a standard technique in quantitative immunology. The provided data are complete and internally consistent, as the sum of positive and negative wells equals the total number of wells ($k_{pos} + k_{neg} = 9+3 = 12 = N$). The assumptions—rare events, random distribution, and a Poisson process—are explicitly stated and form a mathematically well-posed problem. There are no scientific inaccuracies, contradictions, or ambiguities. We may proceed with the derivation.\n\n**Derivation of the Maximum Likelihood Estimate:**\n\nLet $f$ be the true frequency of ASCs among the total splenocyte population. Let $c$ be the number of splenocytes plated in each well. The mean, or expected number, of ASCs per well, denoted by $\\lambda$, is the product of the frequency and the number of cells per well:\n$$\n\\lambda = f \\cdot c\n$$\nAccording to the problem statement, the number of ASCs in any given well, represented by the random variable $X$, follows a Poisson distribution with mean $\\lambda$. The probability mass function for $X$ is given by:\n$$\nP(X=k) = \\frac{\\lambda^k \\exp(-\\lambda)}{k!}\n$$\nwhere $k$ is a non-negative integer ($k=0, 1, 2, \\dots$).\n\nA well is observed to be negative if and only if it contains zero ASCs ($X=0$). The probability of a single well being negative, $P_{\\text{neg}}$, is therefore:\n$$\nP_{\\text{neg}} = P(X=0) = \\frac{\\lambda^0 \\exp(-\\lambda)}{0!} = \\exp(-\\lambda)\n$$\nBy substituting $\\lambda = fc$, we express this probability in terms of the frequency $f$:\n$$\nP_{\\text{neg}} = \\exp(-fc)\n$$\nThe experiment involves $N$ independent wells. Each well represents a Bernoulli trial with two outcomes: negative (with probability $P_{\\text{neg}}$) or positive (with probability $P_{\\text{pos}} = 1 - P_{\\text{neg}}$). The observation of $k_{neg}$ negative wells and $k_{pos}$ positive wells out of a total of $N$ wells follows a binomial distribution. The likelihood function $L(f)$ for this outcome is:\n$$\nL(f) = \\binom{N}{k_{neg}} (P_{\\text{neg}})^{k_{neg}} (1 - P_{\\text{neg}})^{k_{pos}}\n$$\nSubstituting the expression for $P_{\\text{neg}}$ in terms of $f$, we get:\n$$\nL(f) = \\binom{N}{k_{neg}} (\\exp(-fc))^{k_{neg}} (1 - \\exp(-fc))^{k_{pos}}\n$$\nTo find the maximum likelihood estimate (MLE) of $f$, denoted $\\hat{f}$, we must find the value of $f$ that maximizes $L(f)$. It is mathematically more convenient to maximize the natural logarithm of the likelihood function, $\\mathcal{L}(f) = \\ln(L(f))$, since the logarithm is a strictly increasing function.\n$$\n\\mathcal{L}(f) = \\ln\\left(\\binom{N}{k_{neg}}\\right) + \\ln\\left((\\exp(-fc))^{k_{neg}}\\right) + \\ln\\left((1 - \\exp(-fc))^{k_{pos}}\\right)\n$$\n$$\n\\mathcal{L}(f) = \\ln\\left(\\binom{N}{k_{neg}}\\right) - k_{neg}fc + k_{pos}\\ln(1 - \\exp(-fc))\n$$\nTo find the maximum, we compute the derivative of $\\mathcal{L}(f)$ with respect to $f$ and set it to zero.\n$$\n\\frac{d\\mathcal{L}}{df} = 0 - k_{neg}c + k_{pos} \\left( \\frac{1}{1 - \\exp(-fc)} \\right) \\frac{d}{df}(1 - \\exp(-fc))\n$$\n$$\n\\frac{d\\mathcal{L}}{df} = -k_{neg}c + k_{pos} \\left( \\frac{1}{1 - \\exp(-fc)} \\right) (c\\exp(-fc))\n$$\nSetting the derivative to zero to find the MLE $\\hat{f}$:\n$$\n-k_{neg}c + \\frac{k_{pos}c\\exp(-\\hat{f}c)}{1 - \\exp(-\\hat{f}c)} = 0\n$$\nSince $c \\neq 0$, we can divide the equation by $c$:\n$$\nk_{neg} = \\frac{k_{pos}\\exp(-\\hat{f}c)}{1 - \\exp(-\\hat{f}c)}\n$$\nWe now solve for $\\hat{f}$.\n$$\nk_{neg}(1 - \\exp(-\\hat{f}c)) = k_{pos}\\exp(-\\hat{f}c)\n$$\n$$\nk_{neg} - k_{neg}\\exp(-\\hat{f}c) = k_{pos}\\exp(-\\hat{f}c)\n$$\n$$\nk_{neg} = (k_{pos} + k_{neg})\\exp(-\\hat{f}c)\n$$\nRecognizing that $k_{pos} + k_{neg} = N$, the total number of wells:\n$$\nk_{neg} = N\\exp(-\\hat{f}c)\n$$\nThis leads to the intuitive result that the MLE of the probability of a negative well, $\\exp(-\\hat{f}c)$, is the observed fraction of negative wells, $k_{neg}/N$.\n$$\n\\exp(-\\hat{f}c) = \\frac{k_{neg}}{N}\n$$\nTo isolate $\\hat{f}$, we take the natural logarithm of both sides:\n$$\n-\\hat{f}c = \\ln\\left(\\frac{k_{neg}}{N}\\right)\n$$\nSolving for $\\hat{f}$:\n$$\n\\hat{f} = -\\frac{1}{c}\\ln\\left(\\frac{k_{neg}}{N}\\right) = \\frac{1}{c}\\ln\\left(\\left(\\frac{k_{neg}}{N}\\right)^{-1}\\right) = \\frac{1}{c}\\ln\\left(\\frac{N}{k_{neg}}\\right)\n$$\nThis is the general expression for the MLE. We now substitute the given numerical values: $N=12$, $k_{neg}=3$, and $c=100{,}000$.\n$$\n\\hat{f} = \\frac{1}{100000} \\ln\\left(\\frac{12}{3}\\right)\n$$\n$$\n\\hat{f} = \\frac{1}{100000} \\ln(4)\n$$\nThis is the final closed-form analytic expression for the estimated frequency.", "answer": "$$\n\\boxed{\\frac{\\ln(4)}{100000}}\n$$", "id": "2850138"}, {"introduction": "Following activation, B cells face a critical fate decision: differentiate rapidly into extrafollicular (EF) plasmablasts or enter a germinal center (GC) for affinity maturation. This exercise challenges you to build a dynamic model of this process from first principles, translating immunological facts into a system of ordinary differential equations (ODEs). By deriving and implementing the analytical solution, you will gain a profound understanding of how factors like antigen decay and cell-specific turnover rates kinetically shape the balance between the EF and GC pathways, which ultimately determines the speed, magnitude, and quality of the antibody response [@problem_id:2850147].", "problem": "You are to derive, analyze, and compute with a minimal mechanistic model of antibody-secreting cell generation that separates extrafollicular (EF) plasmablasts and germinal center (GC) B cells. Your derivation must start from core immunological facts and modeling assumptions stated below and proceed to a set of ordinary differential equations (ODEs), then to exact analytic solutions. Finally, you must implement a program to evaluate these solutions on a specified test suite and output the results in the required format.\n\nCore facts and modeling assumptions:\n- Antigen $A(t)$ is the upstream signal that activates naive B cells; activation strength scales with $A(t)$ as per clonal selection theory.\n- Antigen decays due to clearance with an exponential form $A(t)=A_0 e^{-\\lambda t}$, where $A_0 \\gt 0$ and $\\lambda \\gt 0$.\n- Activated B cells can differentiate along the EF path into plasmablasts or be recruited into GCs. We model these as two distinct compartments: EF plasmablasts $E(t)$ and GC B cells $G(t)$.\n- The instantaneous influx into the EF and GC compartments is proportional to the activation strength and to pathway-specific rates. Let $\\alpha$ be the activation rate constant, $\\beta$ the EF differentiation rate constant, and $\\gamma$ the GC recruitment rate constant. Thus, EF and GC influxes are taken to be proportional to $\\alpha \\beta A(t)$ and $\\alpha \\gamma A(t)$, respectively.\n- EF plasmablasts and GC B cells are lost with first-order death rates $\\delta_E$ and $\\delta_G$, respectively.\n\nTasks:\n1) Starting only from the above core facts and modeling assumptions (and not from any pre-given target formulas), formulate a minimal linear ODE system for $E(t)$ and $G(t)$ driven by $A(t)=A_0 e^{-\\lambda t}$ with parameters $\\alpha$, $\\beta$, $\\gamma$, $\\delta_E$, and $\\delta_G$.\n\n2) Solve the ODEs exactly under arbitrary nonnegative initial conditions $E(0)=E_0$ and $G(0)=G_0$. Your solution must address the generic case $\\delta_E \\neq \\lambda$ and $\\delta_G \\neq \\lambda$ and the resonance cases $\\delta_E=\\lambda$ and/or $\\delta_G=\\lambda$.\n\n3) Define the instantaneous quasi-steady state at time $t$ by freezing $A(t)$ at its current value and setting time derivatives to zero. Derive closed-form expressions $E_{\\mathrm{ss}}(t)$ and $G_{\\mathrm{ss}}(t)$ in terms of $A(t)$ and the parameters.\n\n4) Determine the long-time steady state $\\lim_{t\\to\\infty}(E(t),G(t))$ under the given antigen decay.\n\n5) Implementation task. Using your derived formulas, write a program that evaluates, for each test case below, a single evaluation time $t_{\\mathrm{eval}}$, returning a list with six floats:\n- $E(t_{\\mathrm{eval}})$,\n- $G(t_{\\mathrm{eval}})$,\n- $E_{\\mathrm{ss}}(t_{\\mathrm{eval}})$,\n- $G_{\\mathrm{ss}}(t_{\\mathrm{eval}})$,\n- $E_{\\infty}=\\lim_{t\\to\\infty}E(t)$,\n- $G_{\\infty}=\\lim_{t\\to\\infty}G(t)$.\n\nScientific realism and interpretability constraints:\n- All variables are non-dimensionalized except time, which is measured in days. No units should be printed in the output. All parameters are nonnegative real numbers.\n- Your solution should be derived from first principles stated above without using any pre-specified target formulas.\n\nTest suite:\nProvide results for the following three parameter sets. For each case, compute at the indicated $t_{\\mathrm{eval}}$.\n\n- Case 1 (generic distinct rates): $A_0=1.0$, $\\lambda=0.3$, $\\alpha=0.8$, $\\beta=0.5$, $\\gamma=0.2$, $\\delta_E=0.6$, $\\delta_G=0.4$, $E_0=0.0$, $G_0=0.0$, $t_{\\mathrm{eval}}=2.0$.\n- Case 2 (resonant EF loss): $A_0=2.0$, $\\lambda=0.5$, $\\alpha=1.2$, $\\beta=0.7$, $\\gamma=0.4$, $\\delta_E=0.5$, $\\delta_G=0.9$, $E_0=0.3$, $G_0=0.1$, $t_{\\mathrm{eval}}=1.0$.\n- Case 3 (no EF differentiation and resonant GC loss): $A_0=1.5$, $\\lambda=0.2$, $\\alpha=0.9$, $\\beta=0.0$, $\\gamma=0.6$, $\\delta_E=0.7$, $\\delta_G=0.2$, $E_0=0.0$, $G_0=0.5$, $t_{\\mathrm{eval}}=3.0$.\n\nFinal output format:\n- Your program should produce a single line of output containing a list of three inner lists (one per case), each inner list containing six floats in the order specified above. Concretely, the output must be a single line in the form\n$[ [E_1,G_1,E_{\\mathrm{ss},1},G_{\\mathrm{ss},1},E_{\\infty,1},G_{\\infty,1}], [E_2,\\dots], [E_3,\\dots] ]$\nwith no additional text. Replace each symbol by the computed float.", "solution": "The problem statement is evaluated to be scientifically grounded, well-posed, objective, and complete. It describes a standard exercise in mathematical biology, involving the formulation and solution of a system of ordinary differential equations (ODEs) based on a set of clear, minimal assumptions. The problem is valid.\n\nThe solution is developed in four steps, following the tasks specified in the problem statement.\n\nTask 1: Formulation of the ODE System\n\nThe model describes the dynamics of two cell populations: extrafollicular (EF) plasmablasts, $E(t)$, and germinal center (GC) B cells, $G(t)$. The rate of change for each population is the balance of influx (generation) and outflux (loss).\n\nThe influx into each compartment is proportional to the antigen-driven activation strength. The antigen concentration is given by $A(t) = A_0 e^{-\\lambda t}$. The problem states that the EF influx is proportional to $\\alpha \\beta A(t)$ and the GC influx is proportional to $\\alpha \\gamma A(t)$. The most direct and parsimonious interpretation is that these are the influx rates.\nThe loss from each compartment is a first-order process with rate constants $\\delta_E$ and $\\delta_G$.\n\nThus, the rate of change for the EF plasmablast population, $\\frac{dE}{dt}$, is given by the influx $\\alpha \\beta A(t)$ minus the outflux $\\delta_E E(t)$.\n$$\n\\frac{dE(t)}{dt} = \\alpha \\beta A_0 e^{-\\lambda t} - \\delta_E E(t)\n$$\nSimilarly, the rate of change for the GC B cell population, $\\frac{dG}{dt}$, is given by the influx $\\alpha \\gamma A(t)$ minus the outflux $\\delta_G G(t)$.\n$$\n\\frac{dG(t)}{dt} = \\alpha \\gamma A_0 e^{-\\lambda t} - \\delta_G G(t)\n$$\nThese two equations form a system of two uncoupled, first-order, linear, non-homogeneous ODEs. The initial conditions are given as $E(0) = E_0$ and $G(0) = G_0$.\n\nTask 2: Analytical Solution of the ODEs\n\nThe two ODEs are of the same general form:\n$$\n\\frac{dy(t)}{dt} + \\delta y(t) = C e^{-\\lambda t}\n$$\nwith initial condition $y(0) = y_0$. For the $E(t)$ equation, we have $y = E$, $\\delta = \\delta_E$, $C = \\alpha \\beta A_0$, and $y_0 = E_0$. For the $G(t)$ equation, we have $y = G$, $\\delta = \\delta_G$, $C = \\alpha \\gamma A_0$, and $y_0 = G_0$.\n\nWe solve this general form using the method of integrating factors. The integrating factor is $I(t) = e^{\\int \\delta dt} = e^{\\delta t}$. Multiplying the ODE by $I(t)$ yields:\n$$\ne^{\\delta t} \\frac{dy}{dt} + \\delta e^{\\delta t} y(t) = C e^{\\delta t} e^{-\\lambda t}\n$$\nThe left side is the derivative of the product $e^{\\delta t} y(t)$:\n$$\n\\frac{d}{dt} \\left( e^{\\delta t} y(t) \\right) = C e^{(\\delta - \\lambda) t}\n$$\nIntegrating with respect to $t$:\n$$\ne^{\\delta t} y(t) = \\int C e^{(\\delta - \\lambda) t} dt + K\n$$\nwhere $K$ is the constant of integration. We must consider two cases for the integral.\n\nCase A: Non-resonant case, $\\delta \\neq \\lambda$.\nThe integral gives:\n$$\ne^{\\delta t} y(t) = \\frac{C}{\\delta - \\lambda} e^{(\\delta - \\lambda) t} + K\n$$\nSolving for $y(t)$:\n$$\ny(t) = \\frac{C}{\\delta - \\lambda} e^{-\\lambda t} + K e^{-\\delta t}\n$$\nUsing the initial condition $y(0) = y_0$:\n$$\ny_0 = \\frac{C}{\\delta - \\lambda} e^0 + K e^0 = \\frac{C}{\\delta - \\lambda} + K \\implies K = y_0 - \\frac{C}{\\delta - \\lambda}\n$$\nSubstituting $K$ back, the solution is:\n$$\ny(t) = \\frac{C}{\\delta - \\lambda} e^{-\\lambda t} + \\left( y_0 - \\frac{C}{\\delta - \\lambda} \\right) e^{-\\delta t} = y_0 e^{-\\delta t} + \\frac{C}{\\delta - \\lambda} (e^{-\\lambda t} - e^{-\\delta t})\n$$\n\nCase B: Resonant case, $\\delta = \\lambda$.\nThe exponent in the integral becomes zero, $e^0 = 1$. The integral is:\n$$\n\\int C dt = Ct\n$$\nThus:\n$$\ne^{\\delta t} y(t) = Ct + K\n$$\nSolving for $y(t)$:\n$$\ny(t) = (Ct + K) e^{-\\delta t}\n$$\nUsing the initial condition $y(0) = y_0$:\n$$\ny_0 = (C \\cdot 0 + K) e^0 = K\n$$\nSubstituting $K = y_0$, the solution is:\n$$\ny(t) = (y_0 + Ct) e^{-\\delta t}\n$$\n\nApplying these general solutions to $E(t)$ and $G(t)$:\n\nSolution for $E(t)$:\nIf $\\delta_E \\neq \\lambda$:\n$$\nE(t) = E_0 e^{-\\delta_E t} + \\frac{\\alpha \\beta A_0}{\\delta_E - \\lambda} (e^{-\\lambda t} - e^{-\\delta_E t})\n$$\nIf $\\delta_E = \\lambda$:\n$$\nE(t) = (E_0 + \\alpha \\beta A_0 t) e^{-\\delta_E t}\n$$\n\nSolution for $G(t)$:\nIf $\\delta_G \\neq \\lambda$:\n$$\nG(t) = G_0 e^{-\\delta_G t} + \\frac{\\alpha \\gamma A_0}{\\delta_G - \\lambda} (e^{-\\lambda t} - e^{-\\delta_G t})\n$$\nIf $\\delta_G = \\lambda$:\n$$\nG(t) = (G_0 + \\alpha \\gamma A_0 t) e^{-\\delta_G t}\n$$\n\nTask 3: Instantaneous Quasi-Steady State\n\nThe instantaneous quasi-steady state is found by setting the time derivatives in the ODEs to zero, while treating the antigen concentration $A(t)$ as a constant at a given time $t$. We denote these states as $E_{\\mathrm{ss}}(t)$ and $G_{\\mathrm{ss}}(t)$.\nFor $E(t)$, we set $\\frac{dE}{dt} = 0$:\n$$\n0 = \\alpha \\beta A(t) - \\delta_E E_{\\mathrm{ss}}(t)\n$$\nAssuming $\\delta_E > 0$, we solve for $E_{\\mathrm{ss}}(t)$:\n$$\nE_{\\mathrm{ss}}(t) = \\frac{\\alpha \\beta}{\\delta_E} A(t) = \\frac{\\alpha \\beta A_0}{\\delta_E} e^{-\\lambda t}\n$$\nFor $G(t)$, we set $\\frac{dG}{dt} = 0$:\n$$\n0 = \\alpha \\gamma A(t) - \\delta_G G_{\\mathrm{ss}}(t)\n$$\nAssuming $\\delta_G > 0$, we solve for $G_{\\mathrm{ss}}(t)$:\n$$\nG_{\\mathrm{ss}}(t) = \\frac{\\alpha \\gamma}{\\delta_G} A(t) = \\frac{\\alpha \\gamma A_0}{\\delta_G} e^{-\\lambda t}\n$$\n\nTask 4: Long-Time Steady State\n\nThe long-time steady state is the limit of the solutions as $t \\to \\infty$. We denote these as $E_\\infty = \\lim_{t\\to\\infty} E(t)$ and $G_\\infty = \\lim_{t\\to\\infty} G(t)$.\nThe parameters $\\lambda$, $\\delta_E$, and $\\delta_G$ are given or implied to be positive constants (antigen decay and cell death rates).\n\nIn the non-resonant case for $E(t)$ ($\\delta_E \\neq \\lambda$):\n$$\n\\lim_{t\\to\\infty} E(t) = \\lim_{t\\to\\infty} \\left( E_0 e^{-\\delta_E t} + \\frac{\\alpha \\beta A_0}{\\delta_E - \\lambda} (e^{-\\lambda t} - e^{-\\delta_E t}) \\right)\n$$\nSince $e^{-kt} \\to 0$ as $t \\to \\infty$ for any $k > 0$, all terms vanish.\n$$\nE_\\infty = 0 + \\frac{\\alpha \\beta A_0}{\\delta_E - \\lambda} (0 - 0) = 0\n$$\n\nIn the resonant case for $E(t)$ ($\\delta_E = \\lambda$):\n$$\n\\lim_{t\\to\\infty} E(t) = \\lim_{t\\to\\infty} (E_0 + \\alpha \\beta A_0 t) e^{-\\lambda t} = \\lim_{t\\to\\infty} E_0 e^{-\\lambda t} + \\lim_{t\\to\\infty} \\alpha \\beta A_0 t e^{-\\lambda t}\n$$\nThe first term is $0$. The second term is of the form $\\infty \\cdot 0$. By L'Hôpital's rule on $\\frac{t}{e^{\\lambda t}}$:\n$$\n\\lim_{t\\to\\infty} \\frac{t}{e^{\\lambda t}} = \\lim_{t\\to\\infty} \\frac{\\frac{d}{dt}t}{\\frac{d}{dt}e^{\\lambda t}} = \\lim_{t\\to\\infty} \\frac{1}{\\lambda e^{\\lambda t}} = 0\n$$\nTherefore, $E_\\infty = 0$.\n\nThe same analysis applies to $G(t)$. In all valid scenarios where $\\lambda > 0$, $\\delta_E > 0$, and $\\delta_G > 0$, the long-time steady state is trivial:\n$$\nE_\\infty = 0\n$$\n$$\nG_\\infty = 0\n$$\nThis is biologically expected: without a persistent antigenic stimulus, the specific B cell populations will eventually decay to zero.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the B cell differentiation model for the given test cases.\n    \"\"\"\n\n    test_cases = [\n        # Case 1 (generic distinct rates)\n        {\n            'params': (1.0, 0.3, 0.8, 0.5, 0.2, 0.6, 0.4, 0.0, 0.0),\n            't_eval': 2.0\n        },\n        # Case 2 (resonant EF loss)\n        {\n            'params': (2.0, 0.5, 1.2, 0.7, 0.4, 0.5, 0.9, 0.3, 0.1),\n            't_eval': 1.0\n        },\n        # Case 3 (no EF differentiation and resonant GC loss)\n        {\n            'params': (1.5, 0.2, 0.9, 0.0, 0.6, 0.7, 0.2, 0.0, 0.5),\n            't_eval': 3.0\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        A0, lam, alpha, beta, gamma, delta_E, delta_G, E0, G0 = case['params']\n        t = case['t_eval']\n        \n        # Calculate E(t)\n        c_E = alpha * beta * A0\n        # Using a small tolerance for floating point comparison of rates\n        if abs(delta_E - lam) < 1e-9:\n            # Resonant case for E\n            E_t = (E0 + c_E * t) * np.exp(-delta_E * t)\n        else:\n            # Non-resonant case for E\n            term1 = E0 * np.exp(-delta_E * t)\n            term2 = (c_E / (delta_E - lam)) * (np.exp(-lam * t) - np.exp(-delta_E * t))\n            E_t = term1 + term2\n\n        # Calculate G(t)\n        c_G = alpha * gamma * A0\n        if abs(delta_G - lam) < 1e-9:\n            # Resonant case for G\n            G_t = (G0 + c_G * t) * np.exp(-delta_G * t)\n        else:\n            # Non-resonant case for G\n            term1 = G0 * np.exp(-delta_G * t)\n            term2 = (c_G / (delta_G - lam)) * (np.exp(-lam * t) - np.exp(-delta_G * t))\n            G_t = term1 + term2\n            \n        # Antigen level at t_eval\n        A_t = A0 * np.exp(-lam * t)\n\n        # Calculate instantaneous quasi-steady state E_ss(t)\n        # Handle case where delta_E could be zero, though not in test cases.\n        E_ss_t = (alpha * beta / delta_E) * A_t if delta_E > 0 else 0.0\n\n        # Calculate instantaneous quasi-steady state G_ss(t)\n        # Handle case where delta_G could be zero.\n        G_ss_t = (alpha * gamma / delta_G) * A_t if delta_G > 0 else 0.0\n\n        # Long-time steady state\n        E_inf = 0.0\n        G_inf = 0.0\n\n        results.append([E_t, G_t, E_ss_t, G_ss_t, E_inf, G_inf])\n\n    # The problem asks for a single line with a list of lists.\n    # The default string representation of a list of lists is correct.\n    print(results)\n```", "id": "2850147"}]}