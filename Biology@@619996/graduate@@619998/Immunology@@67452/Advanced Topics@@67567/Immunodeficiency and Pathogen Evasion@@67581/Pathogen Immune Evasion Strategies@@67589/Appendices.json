{"hands_on_practices": [{"introduction": "A primary defense against intracellular pathogens like viruses is the presentation of foreign peptides on MHC Class I molecules for surveillance by cytotoxic T lymphocytes. Consequently, many viruses have evolved sophisticated mechanisms to disrupt this antigen presentation pathway. This exercise invites you to build a simple but powerful mathematical model to quantify the impact of a viral protein that inhibits the peptide transporter TAP, a critical bottleneck in the MHC Class I supply chain. By applying the principle of steady-state mass balance, you will derive an expression that predicts the reduction in antigen presentation, a foundational skill in quantitative immunology [@problem_id:2879485].", "problem": "A cytosolic viral protein is processed into peptides that can be presented on Major Histocompatibility Complex class I (MHC I) to cytotoxic T lymphocytes. Consider a minimal, well-mixed model in which the proteasome generates antigenic peptides in the cytosol at a constant rate $\\lambda$ (peptides per unit time). Peptides are translocated into the endoplasmic reticulum (ER) by the Transporter associated with Antigen Processing (TAP) at an effective transport parameter $t$ (dimensionless, capturing the fraction of generated peptides that are successfully delivered per unit time). In the ER, assume that peptide loading onto MHC I is rapid and not rate-limiting, such that each successfully translocated peptide yields exactly one peptide-loaded MHC I complex. Loaded complexes are lost from the ER compartment (by export and net turnover) via an effective first-order process with rate constant $\\delta$ (per unit time), which lump-sums all processes that remove peptide-loaded MHC I from the ER.\n\nA viral inhibitor specifically reduces TAP function so that the effective transport parameter is scaled by a factor $\\theta$ with $0 < \\theta < 1$, leaving all other processes unchanged. Assume that empty MHC I and chaperones are in great excess so that peptide supply and transport are the only constraints on formation of peptide-loaded complexes, and neglect peptide editing and dissociation.\n\nUnder these assumptions, and starting from conservation of flux (influx of loaded complexes equals efflux at steady state) and first-order loss kinetics, derive a closed-form analytical expression for the steady-state number of peptide-loaded MHC I complexes in the ER in terms of $\\lambda$, $t$, $\\delta$, and $\\theta$. Express your answer symbolically as a function of $\\lambda$, $t$, $\\delta$, and $\\theta$.", "solution": "The problem requires the derivation of the steady-state number of peptide-loaded Major Histocompatibility Complex class I (MHC I) complexes in the endoplasmic reticulum (ER). I will first validate the problem statement.\n\nStep 1: Extract Givens\n- $\\lambda$: constant rate of antigenic peptide generation in the cytosol (peptides / time).\n- $t$: effective transport parameter for the Transporter associated with Antigen Processing (TAP), a dimensionless fraction.\n- $\\delta$: first-order rate constant for the loss of loaded MHC I complexes from the ER (1 / time).\n- $\\theta$: a dimensionless scaling factor for TAP function due to a viral inhibitor, with $0  \\theta  1$.\n- Condition: The problem is to be solved at steady state, where the influx of complexes equals the efflux.\n- Assumption 1: Peptide loading onto MHC I is rapid and not rate-limiting.\n- Assumption 2: Each successfully translocated peptide yields exactly one peptide-loaded MHC I complex.\n- Assumption 3: The loss of loaded complexes is a first-order process.\n- Assumption 4: Empty MHC I and chaperones are in great excess.\n- Assumption 5: Peptide supply and transport are the only constraints.\n- Assumption 6: Peptide editing and dissociation are neglected.\n\nStep 2: Validate Using Extracted Givens\nThe problem describes a simplified but kinetically standard model of antigen presentation. The parameters are clearly defined, and their dimensions are consistent. $\\lambda$ has units of [number]/[time]. $t$ and $\\theta$ are dimensionless efficiencies. $\\delta$ has units of [1]/[time]. The goal is to find the steady-state number of complexes, which will be a dimensionless quantity representing a count. The rate of formation would be $\\lambda t \\theta$ with units [number]/[time]. The rate of loss is $\\delta N$, where $N$ is the number of complexes, giving units of [number]/[time]. The physical and mathematical setup is self-contained and consistent. The assumptions, while idealizations, are standard for creating a tractable model and do not introduce scientific fallacies. The problem is well-posed, objective, and scientifically grounded within the context of mathematical immunology.\n\nStep 3: Verdict and Action\nThe problem is valid. A solution will be derived.\n\nLet $N_{ss}$ represent the number of peptide-loaded MHC I complexes in the ER at steady state. The problem instructs to begin from the principle of conservation of flux at steady state, which dictates that the rate of formation of these complexes must equal their rate of removal.\n\nWe must first formulate the expression for the rate of formation (influx).\nThe rate of peptide generation in the cytosol is given as $\\lambda$.\nThese peptides are transported into the ER by TAP. The normal transport efficiency is given by the dimensionless parameter $t$. A viral inhibitor reduces this efficiency by a factor of $\\theta$. Therefore, the inhibitor-affected transport efficiency is the product $t\\theta$.\nThe rate at which peptides are successfully translocated into the ER is the product of the generation rate and the effective transport efficiency: $\\lambda t \\theta$.\nAccording to the problem statement, peptide loading is rapid and each translocated peptide yields exactly one peptide-loaded MHC I complex. Consequently, the rate of formation of peptide-loaded MHC I complexes is equal to the rate of peptide translocation.\n$$\n\\text{Rate}_{\\text{formation}} = \\lambda t \\theta\n$$\n\nNext, we formulate the expression for the rate of loss (efflux).\nThe problem states that the loss of loaded complexes from the ER is a first-order process with a rate constant $\\delta$. For a first-order process, the rate of loss is proportional to the quantity of the substance present. In this case, the quantity is the number of complexes, $N_{ss}$.\nThus, the rate of loss of the peptide-loaded MHC I complexes is:\n$$\n\\text{Rate}_{\\text{loss}} = \\delta N_{ss}\n$$\n\nAt steady state, the system does not change in time, meaning the rate of formation must be balanced by the rate of loss.\n$$\n\\text{Rate}_{\\text{formation}} = \\text{Rate}_{\\text{loss}}\n$$\nSubstituting the expressions derived above, we obtain the balance equation:\n$$\n\\lambda t \\theta = \\delta N_{ss}\n$$\n\nThe final step is to solve this algebraic equation for $N_{ss}$, the steady-state number of peptide-loaded MHC I complexes. By rearranging the terms, we isolate $N_{ss}$.\n$$\nN_{ss} = \\frac{\\lambda t \\theta}{\\delta}\n$$\nThis expression provides the steady-state number of complexes as a function of the given parameters $\\lambda$, $t$, $\\theta$, and $\\delta$, as required.", "answer": "$$\\boxed{\\frac{\\lambda t \\theta}{\\delta}}$$", "id": "2879485"}, {"introduction": "To survive and replicate, a virus must first overcome the cell's immediate innate immune response, which is often orchestrated by the production of type I interferons. This response relies on a complex signaling network, not a simple linear chain of events. This practice challenges you to move beyond simple rate calculations and apply pathway logic to determine the most effective point of attack for a viral antagonist within the interferon induction pathway. You will compare the strategic value of inhibiting an upstream, redundant kinase versus a downstream, obligatory nuclear import step, honing your ability to analyze signaling networks for critical points of vulnerability [@problem_id:2879459].", "problem": "A virus infecting human fibroblasts faces an innate immune system in which cytosolic pattern-recognition receptor signaling converges on adaptors that recruit and activate TANK-binding kinase 1 (TBK1) to phosphorylate Interferon Regulatory Factor 3 (IRF3), enabling IRF3 dimerization and nuclear translocation. In most non-plasmacytoid cells, basal Interferon Regulatory Factor 7 (IRF7) is low, so the initial wave of type I interferon depends primarily on IRF3. Autocrine type I interferon signaling through the interferon-$\\alpha/\\beta$ receptor drives Janus kinase (JAK) and Signal Transducer and Activator of Transcription (STAT) activation, forming the interferon-stimulated gene factor 3 (ISGF3) complex (STAT1/STAT2/IRF9), which amplifies the expression of interferon-stimulated genes (ISGs). In this cell type, adaptor proteins such as Stimulator of Interferon Genes (STING), Mitochondrial Antiviral-Signaling protein (MAVS), and TIR-domain-containing adapter-inducing interferon-$\\beta$ (TRIF) are present at low copy number relative to upstream receptors and downstream kinases, so adaptor availability is limiting for signal throughput.\n\nThe virus can encode one of two antagonists:\n- Antagonist $X$ binds TBK1 and prevents its activation-loop phosphorylation at Ser172 without degrading TBK1 or adaptors.\n- Antagonist $Y$ binds karyopherin-$\\beta$ (importin-$\\beta$) and specifically prevents nuclear import of phosphorylated IRF3 dimers, without affecting NF-$\\kappa$B or Mitogen-Activated Protein Kinase pathways.\n\nAssume the following foundational facts: \n- Kinase redundancy exists at the level of IRF3 phosphorylation (inhibitor of nuclear factor kappa-B kinase epsilon, IKK$\\varepsilon$, can phosphorylate IRF3 when appropriately scaffolded), whereas nuclear import of IRF3 dimers is obligatory for IRF3-dependent transcription. \n- NF-$\\kappa$B activation alone is not sufficient to drive interferon-$\\beta$ transcription in the absence of nuclear IRF3.\n- Under adaptor-limiting conditions, any residual kinase that can phosphorylate IRF3 must still be recruited or scaffolded through adaptor-associated complexes, but even a small number of IRF3 dimers that reach the nucleus can initiate the autocrine interferon amplification loop.\n\nWhich statement best contrasts the consequences of these two viral strategies and correctly infers which would more effectively blunt global ISG induction when adaptor abundance is limiting?\n\nA. Inhibiting TBK1 phosphorylation would be more effective because it prevents activation of both IRF3 and IRF7 across all adaptor platforms, completely abolishing type I interferon irrespective of adaptor limitation.\n\nB. Inhibiting IRF3 nuclear translocation would be more effective because it bypasses kinase-level redundancy (TBK1 and IKK$\\varepsilon$), blocking both the initial interferon-$\\beta$ wave and the interferon receptor–mediated amplification loop, which is especially critical when adaptor abundance is limiting.\n\nC. The two interventions are effectively equivalent for suppressing ISGs because they lie on a single linear pathway and therefore reduce output to the same extent under any adaptor abundance.\n\nD. When adaptor abundance is limiting, the rate-limiting step is upstream, so downstream perturbations such as blocking IRF3 nuclear import have little impact; therefore, inhibiting TBK1 phosphorylation is superior for suppressing ISGs.\n\nE. Blocking TBK1 phosphorylation preserves NF-$\\kappa$B activation, allowing interferon-$\\beta$ transcription to proceed; therefore, it is less effective than blocking IRF3 nuclear translocation.", "solution": "The problem statement is critically evaluated for validity before proceeding to a solution.\n\n### Step 1: Extract Givens\n- **Cellular Context**: Human fibroblasts.\n- **Signaling Pathway**: Cytosolic pattern-recognition receptor signaling converges on adaptors that recruit and activate TANK-binding kinase 1 (TBK1).\n- **TBK1 Function**: Phosphorylates Interferon Regulatory Factor 3 (IRF3).\n- **IRF3 Activation**: Phosphorylation enables IRF3 dimerization and nuclear translocation.\n- **Initial Interferon Wave**: Depends primarily on IRF3 due to low basal levels of Interferon Regulatory Factor 7 (IRF7).\n- **Amplification Loop**: Autocrine type I interferon signaling through the interferon-$\\alpha/\\beta$ receptor activates Janus kinase (JAK) and Signal Transducer and Activator of Transcription (STAT), forming the interferon-stimulated gene factor 3 (ISGF3) complex (STAT1/STAT2/IRF9).\n- **ISGF3 Function**: Amplifies expression of interferon-stimulated genes (ISGs).\n- **Rate-Limiting Step**: Adaptor proteins (Stimulator of Interferon Genes (STING), Mitochondrial Antiviral-Signaling protein (MAVS), TIR-domain-containing adapter-inducing interferon-$\\beta$ (TRIF)) are present at low copy number, making adaptor availability limiting for signal throughput.\n- **Antagonist $X$**: Binds TBK1 and prevents its activation-loop phosphorylation at Ser172. Does not degrade TBK1 or adaptors.\n- **Antagonist $Y$**: Binds karyopherin-$\\beta$ and specifically prevents nuclear import of phosphorylated IRF3 dimers. Does not affect NF-$\\kappa$B or Mitogen-Activated Protein Kinase pathways.\n- **Foundational Fact 1**: Kinase redundancy exists; inhibitor of nuclear factor kappa-B kinase epsilon (IKK$\\varepsilon$) can also phosphorylate IRF3 when scaffolded.\n- **Foundational Fact 2**: Nuclear import of IRF3 dimers is obligatory for IRF3-dependent transcription.\n- **Foundational Fact 3**: NF-$\\kappa$B activation alone is not sufficient to drive interferon-$\\beta$ transcription without nuclear IRF3.\n- **Foundational Fact 4**: Even a small number of nuclear IRF3 dimers can initiate the autocrine interferon amplification loop.\n\n### Step 2: Validate Using Extracted Givens\nThe problem statement describes a detailed, albeit simplified, immunological signaling scenario.\n- **Scientifically Grounded**: The pathway described—from PRR recognition to TBK1/IKK$\\varepsilon$ activation, IRF3 phosphorylation, interferon-$\\beta$ production, and JAK-STAT amplification—is a cornerstone of innate antiviral immunity. The roles of all mentioned proteins (TBK1, IRF3, STING, MAVS, TRIF, IKK$\\varepsilon$, STATs, etc.) are consistent with established molecular immunology. The concept of viral antagonists targeting specific nodes in this pathway is a central theme in virology.\n- **Well-Posed**: The problem sets up a clear comparison between two distinct viral strategies under a specified biophysical constraint (limiting adaptor concentration). The foundational facts provide the necessary rules to deduce a unique and meaningful answer regarding the relative efficacy of the two strategies.\n- **Objective**: The language is precise and technical. All statements are presented as facts within the context of the problem, free of subjectivity or ambiguity.\n\n### Step 3: Verdict and Action\nThe problem is valid. It is a well-constructed, scientifically sound question that tests understanding of signaling pathway logic, redundancy, and rate-limiting steps. A solution will be derived.\n\n### Derivation of Solution\nThe central task is to compare the efficacy of two viral antagonists, $X$ and $Y$, in suppressing the host interferon response, under the critical condition that adaptor proteins are the limiting resource.\n\nThe pathway for the initial type I interferon response can be summarized as:\n$1$. Virus Detection $\\rightarrow$ Adaptor Scaffolding (STING/MAVS/TRIF)\n$2$. Adaptor Scaffolding $\\rightarrow$ Recruitment and activation of kinases (TBK1 or IKK$\\varepsilon$)\n$3$. Kinase Activation $\\rightarrow$ Phosphorylation of IRF3\n$4$. IRF3 Phosphorylation $\\rightarrow$ IRF3 Dimerization\n$5$. IRF3 Dimerization $\\rightarrow$ Nuclear Import via Karyopherin-$\\beta$\n$6$. Nuclear IRF3 $\\rightarrow$ Transcription of initial interferon-$\\beta$ (IFN-$\\beta$)\n$7$. IFN-$\\beta$ Secretion $\\rightarrow$ Autocrine signaling via IFNAR\n$8$. IFNAR Signaling $\\rightarrow$ JAK/STAT activation $\\rightarrow$ ISGF3 formation\n$9$. ISGF3 Formation $\\rightarrow$ Massive transcription of Interferon-Stimulated Genes (ISGs)\n\nLet us analyze the two antagonists in this context.\n\n**Analysis of Antagonist $X$:**\nAntagonist $X$ inhibits the activation of TBK1. However, the problem explicitly states that kinase redundancy exists: IKK$\\varepsilon$ can also phosphorylate IRF3 when appropriately scaffolded. Since Antagonist $X$ is specific for TBK1, it leaves the IKK$\\varepsilon$-mediated pathway intact. Because adaptors are limiting, only a small number of signaling complexes can form. Any of these complexes that recruit IKK$\\varepsilon$ instead of or in addition to TBK1 will be able to phosphorylate IRF3. The problem states that even a small number of phosphorylated IRF3 dimers reaching the nucleus is sufficient to initiate the powerful positive feedback amplification loop. Therefore, the inhibition provided by Antagonist $X$ is \"leaky\" due to kinase redundancy, and this leakiness is sufficient to trigger a full-blown response.\n\n**Analysis of Antagonist $Y$:**\nAntagonist $Y$ inhibits the nuclear import of phosphorylated IRF3 dimers. This step occurs downstream of IRF3 phosphorylation. Critically, the problem states this step is *obligatory* for IRF3-dependent transcription, and no redundancy for this import mechanism is mentioned. This means Antagonist $Y$ creates a complete bottleneck. It does not matter whether IRF3 was phosphorylated by TBK1 or by the redundant kinase IKK$\\varepsilon$; in either case, the resulting phosphorylated IRF3 dimer is blocked from entering the nucleus. By preventing nuclear entry of IRF3, Antagonist $Y$ completely prevents the initial transcription of IFN-$\\beta$. If the initial IFN-$\\beta$ wave is absent, the entire amplification loop involving ISGF3 and global ISG induction cannot be initiated.\n\n**Comparison and Conclusion:**\nAntagonist $Y$ targets a downstream, non-redundant, obligatory step in the pathway. This provides a complete and robust blockade of the entire interferon response. Antagonist $X$ targets a step for which a redundant mechanism exists, making its blockade inherently incomplete or \"leaky\". Given that even a small signal can be massively amplified, a leaky inhibitor is far less effective than a complete one. Therefore, the strategy of blocking IRF3 nuclear import (Antagonist $Y$) is more effective at blunting global ISG induction than blocking TBK1 activation (Antagonist $X$), especially under the specified condition of limiting adaptors.\n\n### Option-by-Option Analysis\n\n**A. Inhibiting TBK1 phosphorylation would be more effective because it prevents activation of both IRF3 and IRF7 across all adaptor platforms, completely abolishing type I interferon irrespective of adaptor limitation.**\nThis statement is incorrect. It fails to account for the specified kinase redundancy with IKK$\\varepsilon$, which can still phosphorylate IRF3 and, later, IRF7. Thus, the inhibition is not \"complete\". The claim of being \"irrespective of adaptor limitation\" is also contrary to the problem's emphasis.\n\n**Verdict: Incorrect**\n\n**B. Inhibiting IRF3 nuclear translocation would be more effective because it bypasses kinase-level redundancy (TBK1 and IKK$\\varepsilon$), blocking both the initial interferon-$\\beta$ wave and the interferon receptor–mediated amplification loop, which is especially critical when adaptor abundance is limiting.**\nThis statement is correct. It precisely identifies the crucial advantage of Antagonist $Y$'s mechanism: it targets a single, essential step downstream of the redundant kinases, thereby creating a complete blockade. It correctly links the prevention of the initial wave to the prevention of the amplification loop and correctly notes the heightened importance of a complete block when a weak initial signal (due to limiting adaptors) can still be amplified.\n\n**Verdict: Correct**\n\n**C. The two interventions are effectively equivalent for suppressing ISGs because they lie on a single linear pathway and therefore reduce output to the same extent under any adaptor abundance.**\nThis statement is incorrect. The pathway is not \"single linear\" due to the parallel, redundant kinase activity of IKK$\\varepsilon$. Because one intervention targets a redundant step and the other targets a non-redundant one, their effects are not equivalent.\n\n**Verdict: Incorrect**\n\n**D. When adaptor abundance is limiting, the rate-limiting step is upstream, so downstream perturbations such as blocking IRF3 nuclear import have little impact; therefore, inhibiting TBK1 phosphorylation is superior for suppressing ISGs.**\nThis statement demonstrates flawed logic. While the adaptor concentration limits the *maximum rate* of signaling, it does not render downstream inhibition ineffective. On the contrary, because the amplification loop can be triggered by a very small signal, a complete block at a downstream chokepoint is the *most* effective strategy to prevent any signal from initiating this amplification. The conclusion that the perturbation has \"little impact\" is false.\n\n**Verdict: Incorrect**\n\n**E. Blocking TBK1 phosphorylation preserves NF-$\\kappa$B activation, allowing interferon-$\\beta$ transcription to proceed; therefore, it is less effective than blocking IRF3 nuclear translocation.**\nThis statement contains faulty reasoning. While the conclusion that it is \"less effective\" is true, the reason provided is false. The problem explicitly states that \"NF-$\\kappa$B activation alone is not sufficient to drive interferon-$\\beta$ transcription in the absence of nuclear IRF3\". Since both antagonists result in the absence of nuclear IRF3 (completely for $Y$, and largely for $X$), the fact that NF-$\\kappa$B is active is irrelevant for IFN-$\\beta$ transcription in this context. The core reason for the difference in efficacy is kinase redundancy, not NF-$\\kappa$B status.\n\n**Verdict: Incorrect**", "answer": "$$\\boxed{B}$$", "id": "2879459"}, {"introduction": "While many pathogens use static mechanisms to hide from the immune system, others engage in a dynamic \"arms race\" by continuously changing their surface antigens. The protozoan parasite *Trypanosoma brucei*, with its vast archive of Variant Surface Glycoprotein (VSG) genes, is a classic example of this strategy. This advanced exercise asks you to model this dynamic competition as a stochastic birth-death process, where parasite \"birth\" is the generation of a new antigenic variant and \"death\" is immune clearance. You will derive the expected time for the parasite to achieve immune escape and implement your model computationally, providing a powerful bridge between theoretical population biology and predictive immunological modeling [@problem_id:2879483].", "problem": "You are asked to transform a biological scenario of antigenic variation into a quantitatively precise, testable computation. In the protozoan parasite Trypanosoma brucei, immune evasion is mediated by switch among Variant Surface Glycoprotein (VSG) genes. Assume a Variant Surface Glycoprotein (VSG) archive of size $N$ possible antigenically distinct genes, a gene conversion rate $\\gamma$ per lineage per day that produces switching attempts, and an immune clearance rate $c$ per lineage per day for lineages expressing recognized VSGs. A recognized lineage here means parasites currently expressing a VSG that has been previously exposed to the immune system; such lineages are removed at rate $c$. A switching attempt yields a novel, unrecognized VSG with probability equal to the fraction of unused VSGs remaining, which at the start is $(N-1)/N$ if one VSG is already in use. Model the early dynamics as a linear birth–death–innovation process for the number of recognized lineages, where “birth” events correspond to successful innovations (appearance of a lineage expressing a previously unused VSG) and “death” events correspond to immune clearance of recognized lineages. Start with a single recognized lineage at time $t=0$.\n\nUsing only the following fundamental bases:\n- Antigen switching and immune clearance events can be modeled as independent Poisson processes with constant hazards for small time intervals (memoryless property).\n- In a linear birth–death process with per-lineage birth rate $b$ and per-lineage death rate $d$, the time to the first event (birth or death) from a starting population of one lineage is exponentially distributed with rate $b + d$.\n\nDefine the immune escape time $T$ as the time until the first successful innovation event occurs (i.e., the instant at which a lineage expressing a previously unused VSG appears). If immune clearance of the starting lineage occurs before any innovation, then immune escape never occurs, and the unconditional expected time to immune escape counts as $0$ contribution from those trajectories. Assume the archive is sufficiently large that depletion from a single successful innovation does not feed back before the first escape event; thus, at the start, the per-lineage innovation hazard is $b = \\gamma \\cdot \\frac{N-1}{N}$ and the per-lineage clearance hazard is $d = c$.\n\nTask:\n- Derive from first principles an explicit expression for the unconditional expected immune escape time $\\mathbb{E}[T]$ in days, expressed solely in terms of $N$, $\\gamma$, and $c$. Do not assume any additional model structure beyond what is stated above, and ensure your derivation identifies the role of the memoryless property and the law of total expectation.\n- Implement a program that computes $\\mathbb{E}[T]$ for a fixed test suite of parameter sets. All rates are per day, and the final answer must be given in days as floating-point numbers.\n\nTest suite (each triple is $(N, \\gamma, c)$, with $N$ unitless and $\\gamma$, $c$ in $\\text{day}^{-1}$):\n- Case A: $(N, \\gamma, c) = (1000, 0.02, 0.1)$\n- Case B: $(N, \\gamma, c) = (1, 0.1, 0.1)$\n- Case C: $(N, \\gamma, c) = (100, 0.0, 0.5)$\n- Case D: $(N, \\gamma, c) = (100, 0.5, 0.0)$\n- Case E: $(N, \\gamma, c) = (50, 0.05, 0.5)$\n- Case F: $(N, \\gamma, c) = (1000, 0.5, 5.0)$\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the same order as the test suite, where each entry is the computed $\\mathbb{E}[T]$ in days formatted as a floating-point number with exactly six digits after the decimal point. For example, a valid output format is [$x_1, x_2, x_3, x_4, x_5, x_6$] where each $x_i$ is a float with six digits after the decimal point.", "solution": "The problem statement has been evaluated and is determined to be valid. It is scientifically grounded, self-contained, and quantitatively precise. It describes a classical competition between two stochastic processes, framed within a biologically relevant context. We may therefore proceed with a rigorous derivation.\n\nThe system begins at time $t=0$ with a single recognized parasite lineage. This lineage is subject to two independent, competing stochastic events, modeled as Poisson processes:\n$1$. **Successful Innovation (Birth):** The parasite switches to a novel, unrecognized Variant Surface Glycoprotein (VSG). This event corresponds to immune escape. The per-lineage rate for this event is designated as $b$.\n$2$. **Immune Clearance (Death):** The existing recognized lineage is destroyed by the host immune system. The per-lineage rate for this event is designated as $d$.\n\nThe problem provides the parameters to define these rates. The rate of switching attempts is $\\gamma$. The probability that a switch is successful (i.e., results in a novel VSG) is the fraction of unused VSGs in an archive of size $N$. With one VSG currently in use, this probability is $\\frac{N-1}{N}$. The simplifying assumption is made that this probability remains constant for the first event. Thus, the effective rate of successful innovation is:\n$$b = \\gamma \\cdot \\frac{N-1}{N}$$\nThe rate of immune clearance for a recognized lineage is given directly as $c$. Thus:\n$$d = c$$\n\nLet $T_b$ be the random variable for the time to the first innovation event, and $T_d$ be the random variable for the time to the first clearance event. Based on the Poisson process assumption, both are independent and exponentially distributed:\n- $T_b \\sim \\text{Exponential}(b)$\n- $T_d \\sim \\text{Exponential}(d)$\n\nThe immune escape time, $T$, is defined as the time of the first successful innovation. However, a crucial condition is imposed: if clearance occurs before innovation ($T_d  T_b$), the trajectory does not lead to immune escape, and its contribution to the unconditional expected time $\\mathbb{E}[T]$ is defined to be $0$. This means we are to calculate the expectation of a random variable $T_{eff}$ defined as:\n$$\nT_{eff} =\n\\begin{cases}\nT_b  \\text{if } T_b \\leq T_d \\\\\n0  \\text{if } T_d  T_b\n\\end{cases}\n$$\nWe seek $\\mathbb{E}[T_{eff}]$. Using the law of total expectation, we can write:\n$$\\mathbb{E}[T_{eff}] = \\mathbb{E}[T_{eff} | T_b \\leq T_d] P(T_b \\leq T_d) + \\mathbb{E}[T_{eff} | T_d  T_b] P(T_d  T_b)$$\nFrom the definition of $T_{eff}$:\n- If $T_d  T_b$, then $T_{eff} = 0$, so its expectation is $\\mathbb{E}[0] = 0$. The second term vanishes.\n- If $T_b \\leq T_d$, then $T_{eff} = T_b$.\n\nThe expression thus simplifies to:\n$$\\mathbb{E}[T_{eff}] = \\mathbb{E}[T_b | T_b \\leq T_d] P(T_b \\leq T_d)$$\n\nWe proceed by calculating the two components of this product.\n\nFirst, the probability $P(T_b \\leq T_d)$ is the probability that an exponential random variable with rate $b$ is less than or equal to an independent exponential random variable with rate $d$. This is a standard result for competing exponential distributions:\n$$P(T_b \\leq T_d) = \\frac{b}{b+d}$$\nThis term represents the probability that the lineage successfully innovates before it is cleared.\n\nSecond, we must find the conditional expectation $\\mathbb{E}[T_b | T_b \\leq T_d]$. Let $T_{min} = \\min(T_b, T_d)$ be the time of the first event, whichever it may be. Due to the properties of independent exponential random variables, $T_{min}$ is also exponentially distributed with a rate equal to the sum of the individual rates:\n$$T_{min} \\sim \\text{Exponential}(b+d)$$\nThe expected time to this first event is therefore $\\mathbb{E}[T_{min}] = \\frac{1}{b+d}$.\nA fundamental consequence of the memoryless property of the exponential distribution is that the time of the first event, $T_{min}$, is independent of which event occurred first (i.e., whether $T_b \\leq T_d$ or $T_d  T_b$).\nGiven the condition $T_b \\leq T_d$, the time of innovation $T_b$ is precisely the time of the first event, $T_{min}$. Therefore:\n$$\\mathbb{E}[T_b | T_b \\leq T_d] = \\mathbb{E}[T_{min} | T_b \\leq T_d]$$\nDue to the independence of the time and identity of the first event, the conditioning on the identity does not alter the expectation of the time:\n$$\\mathbb{E}[T_{min} | T_b \\leq T_d] = \\mathbb{E}[T_{min}] = \\frac{1}{b+d}$$\nThis is the conditional expected time to escape, given that escape occurs.\n\nFinally, we combine these components to find the unconditional expectation as defined by the problem. The problem refers to this quantity as $\\mathbb{E}[T]$, so we adopt that notation.\n$$\\mathbb{E}[T] = \\left(\\frac{1}{b+d}\\right) \\cdot \\left(\\frac{b}{b+d}\\right) = \\frac{b}{(b+d)^2}$$\n\nSubstituting the expressions for $b$ and $d$ in terms of the given parameters $N$, $\\gamma$, and $c$:\n$$\\mathbb{E}[T] = \\frac{\\gamma \\frac{N-1}{N}}{\\left(\\gamma \\frac{N-1}{N} + c\\right)^2}$$\nThis is the final expression derived from first principles. It correctly evaluates to $0$ if innovation is impossible (i.e., if $\\gamma=0$ or $N=1$, which makes $b=0$). In the absence of immune clearance ($c=0$), the expression correctly simplifies to $\\mathbb{E}[T] = \\frac{1}{b}$, which is the mean time to the first innovation event, as escape is then guaranteed. The formula is robust and encapsulates the dynamics as specified.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the unconditional expected immune escape time for a series of test cases.\n    \"\"\"\n    # Test suite: each tuple is (N, gamma, c)\n    # N: size of VSG archive (unitless)\n    # gamma: gene conversion rate (per day)\n    # c: immune clearance rate (per day)\n    test_cases = [\n        (1000, 0.02, 0.1),  # Case A\n        (1, 0.1, 0.1),      # Case B\n        (100, 0.0, 0.5),    # Case C\n        (100, 0.5, 0.0),    # Case D\n        (50, 0.05, 0.5),    # Case E\n        (1000, 0.5, 5.0),   # Case F\n    ]\n\n    results = []\n    for case in test_cases:\n        N, gamma, c = case\n        \n        # Per-lineage innovation hazard (birth rate 'b').\n        # This is the product of the switching attempt rate (gamma) and the\n        # probability of choosing a novel antigen ((N-1)/N).\n        # We handle N=1, where (N-1)/N = 0, leading to b=0.\n        if N = 1:\n            b = 0.0\n        else:\n            b = gamma * (N - 1) / N\n        \n        # Per-lineage clearance hazard (death rate 'd').\n        d = c\n        \n        # The denominator of the derived formula is (b+d)^2.\n        # A denominator of zero occurs only if b=0 and d=0. In this case,\n        # the numerator b is also 0, and no event can occur. The escape\n        # probability is zero, so the expected time (as defined) is 0.\n        denominator = (b + d)**2\n        \n        if denominator == 0.0:\n            expected_time = 0.0\n        else:\n            # The derived expression for the unconditional expected immune escape time E[T]\n            # is b / (b + d)^2.\n            expected_time = b / denominator\n            \n        results.append(expected_time)\n\n    # Format the final output as a comma-separated list of floating-point numbers\n    # with six digits after the decimal point, enclosed in square brackets.\n    formatted_results = [f\"{res:.6f}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2879483"}]}