{"hands_on_practices": [{"introduction": "Tertiary Lymphoid Structures are dynamic sites of immune activity, which depends on the constant influx of lymphocytes from the circulation. This recruitment can be modeled as a multi-step probabilistic process involving rolling, adhesion, and transmigration through specialized high endothelial venules (HEVs). This exercise [@problem_id:2895372] allows you to translate these discrete biological events into a quantitative flux model, connecting cellular-level probabilities to the tissue-scale rate of lymphocyte entry into a TLS.", "problem": "Consider a single High Endothelial Venule (HEV) feeding a mature Tertiary Lymphoid Structure (TLS) in steady state. Blood carrying circulating lymphocytes with mean number concentration $c_{b}$ (cells per unit volume) flows through the HEV at volumetric rate $Q$ (volume per unit time). Each lymphocyte that traverses the HEV undergoes a sequence of three stochastic steps required for entry into the TLS parenchyma: selectin-mediated rolling, integrin-mediated firm adhesion, and diapedesis (transendothelial migration). Let the probability that a lymphocyte successfully completes rolling be $p_{r}$, conditional adhesion given rolling be $p_{a}$, and conditional diapedesis given adhesion be $p_{t}$. Assume (i) stationarity and ergodicity over the time window of interest, (ii) independence at the level of individual cells, and (iii) that $p_{r}$, $p_{a}$, and $p_{t}$ are time-invariant and reflect the integrated effect of local chemokine and adhesion receptor presentation.\n\nStarting from conservation of cell number (cell flux equals volumetric flow multiplied by concentration) and the basic rules of probability for sequential events, derive a closed-form expression for the expected entry rate $J_{\\mathrm{in}}$ of lymphocytes into the TLS (cells per unit time) in terms of $Q$, $c_{b}$, $p_{r}$, $p_{a}$, and $p_{t}$. Then evaluate $J_{\\mathrm{in}}$ numerically for the following physiologically plausible parameter values:\n- Volumetric blood flow: $Q = 1.2\\,\\mu\\mathrm{L}\\,\\mathrm{min}^{-1}$,\n- Circulating lymphocyte concentration: $c_{b} = 2.5 \\times 10^{6}\\,\\mathrm{cells}\\,\\mathrm{mL}^{-1}$,\n- Rolling probability: $p_{r} = 0.35$,\n- Adhesion probability: $p_{a} = 0.60$,\n- Transmigration probability: $p_{t} = 0.70$.\n\nExpress your final numerical answer for $J_{\\mathrm{in}}$ in units of cells per minute and round your answer to three significant figures. Do not include the derivation formula in your final answer; report only the computed value.", "solution": "The total flux of lymphocytes, denoted $J_{\\mathrm{total}}$, represents the total number of lymphocytes passing through the HEV per unit time. This is given by the product of the volumetric flow rate $Q$ and the mean number concentration of lymphocytes $c_{b}$.\n$$J_{\\mathrm{total}} = Q c_{b}$$\nFor a single lymphocyte to enter the TLS parenchyma, it must successfully complete a sequence of three stochastic events: rolling, adhesion, and diapedesis (transmigration). The probability of a single lymphocyte successfully completing the entire sequence, $p_{\\mathrm{entry}}$, is the product of the individual probabilities for these sequential events:\n$$p_{\\mathrm{entry}} = p_{r} p_{a} p_{t}$$\nThe expected entry rate into the TLS, $J_{\\mathrm{in}}$, is the total flux of arriving lymphocytes multiplied by the probability of successful entry.\n$$J_{\\mathrm{in}} = J_{\\mathrm{total}} \\times p_{\\mathrm{entry}} = Q c_{b} p_{r} p_{a} p_{t}$$\nTo evaluate this expression numerically, we must first ensure dimensional consistency. The given values are:\n- $Q = 1.2\\,\\mu\\mathrm{L}\\,\\mathrm{min}^{-1}$\n- $c_{b} = 2.5 \\times 10^{6}\\,\\mathrm{cells}\\,\\mathrm{mL}^{-1}$\n- $p_{r} = 0.35$\n- $p_{a} = 0.60$\n- $p_{t} = 0.70$\n\nWe convert $Q$ from $\\mu\\mathrm{L}\\,\\mathrm{min}^{-1}$ to $\\mathrm{mL}\\,\\mathrm{min}^{-1}$, using the conversion factor $1\\,\\mathrm{mL} = 1000\\,\\mu\\mathrm{L}$.\n$$Q = 1.2\\,\\mu\\mathrm{L}\\,\\mathrm{min}^{-1} = 1.2 \\times 10^{-3}\\,\\mathrm{mL}\\,\\mathrm{min}^{-1}$$\nNow, we substitute the numerical values into the derived formula for $J_{\\mathrm{in}}$.\n$$J_{\\mathrm{in}} = (1.2 \\times 10^{-3}\\,\\mathrm{mL}\\,\\mathrm{min}^{-1}) \\times (2.5 \\times 10^{6}\\,\\mathrm{cells}\\,\\mathrm{mL}^{-1}) \\times (0.35) \\times (0.60) \\times (0.70)$$\nFirst, we compute the total flux of arriving cells:\n$$Q c_{b} = (1.2 \\times 10^{-3}) \\times (2.5 \\times 10^{6})\\,\\mathrm{cells}\\,\\mathrm{min}^{-1} = 3.0 \\times 10^{3}\\,\\mathrm{cells}\\,\\mathrm{min}^{-1}$$\nNext, we compute the product of the probabilities:\n$$p_{r} p_{a} p_{t} = 0.35 \\times 0.60 \\times 0.70 = 0.147$$\nFinally, we compute the expected entry rate $J_{\\mathrm{in}}$:\n$$J_{\\mathrm{in}} = (3.0 \\times 10^{3}\\,\\mathrm{cells}\\,\\mathrm{min}^{-1}) \\times 0.147 = 441\\,\\mathrm{cells}\\,\\mathrm{min}^{-1}$$\nThe problem requires the answer to be rounded to three significant figures. The calculated value $441$ already has three significant figures. In scientific notation, this is $4.41 \\times 10^2$.", "answer": "$$\\boxed{4.41 \\times 10^{2}}$$", "id": "2895372"}, {"introduction": "The highly organized architecture of a TLS, with its segregated B and T cell zones, is not accidental but is actively maintained by a complex network of molecular signals. Key pathways, such as those initiated by the Lymphotoxin beta receptor (LTβR) and Tumor Necrosis Factor receptor (TNFR), are central to establishing and preserving this structure. This thought experiment [@problem_id:2895369] challenges you to apply your knowledge of these core signaling pathways to predict structural outcomes following specific molecular perturbations, honing your ability to reason mechanistically about lymphoid organogenesis.", "problem": "A research group studies chronic ectopic lymphoid aggregates that form within inflamed lung parenchyma in a murine model of persistent antigen exposure. At baseline, these aggregates fulfill the defining criteria of Tertiary Lymphoid Structures (TLS): they display segregated B cell and T cell zones, follicular dendritic cell (FDC) networks within B cell follicles, high endothelial venules (HEV) expressing peripheral node addressin (PNAd), and stromal expression of the homeostatic chemokines C-X-C motif chemokine ligand 13 (`CXCL13`), C-C motif chemokine ligand 19 (`CCL19`), and C-C motif chemokine ligand 21 (`CCL21`). The investigators now impose one of two perturbations and ask how TLS morphology and cellular composition will be altered:\n\nPerturbation $1$: Systemic administration of a lymphotoxin beta receptor-immunoglobulin fusion protein that sequesters Lymphotoxin alpha one beta two ($LT\\alpha_1\\beta_2$), thereby blocking Lymphotoxin beta receptor ($LT\\beta R$) signaling on stromal organizer cells.\n\nPerturbation $2$: Systemic neutralization of Tumor Necrosis Factor (TNF), blocking Tumor Necrosis Factor receptors (TNFR) signaling on hematopoietic and stromal compartments.\n\nUse only well-established principles of lymphoid organogenesis and maintenance: (i) stromal organizer cells that receive $LT\\beta R$ signals initiate and sustain noncanonical nuclear factor kappa-light-chain-enhancer of activated B cells (NF-$\\kappa$B) signaling via $NF-\\kappa B$-inducing kinase, driving expression of `CXCL13`, `CCL19`, and `CCL21`, differentiation of FDCs, and maintenance of HEV phenotype; and (ii) TNFR signaling supports canonical $NF-\\kappa B$–dependent maturation and survival of FDCs and endothelial activation, and reinforces but does not replace $LT\\beta R$-driven programs. Predict qualitatively how TLS morphology and cellular composition will change for each perturbation, and identify the mechanistic basis of each prediction.\n\nWhich option best matches these mechanistic expectations?\n\n- A. Perturbation $1$: Rapid collapse of TLS compartmentalization with loss of discrete B cell follicles, near-complete loss of FDC networks, marked reduction of `CXCL13`/`CCL19`/`CCL21` transcripts in stromal cells, regression and PNAd downregulation on HEV, and reversion to diffuse perivascular leukocyte aggregates; mechanism: abrogation of noncanonical NF-$\\kappa$B in stromal organizer cells due to loss of $LT\\alpha_1\\beta_2$–$LT\\beta R$ signaling. Perturbation $2$: Partial disorganization confined mainly to germinal center and FDC maturation with reduced follicular size and fewer proliferating B cells; preserved but somewhat weakened B/T segregation; reduced HEV density and PNAd intensity but persistence of some HEV; mechanism: diminished canonical NF-$\\kappa$B–mediated stromal and endothelial activation downstream of TNFR without extinguishing $LT\\beta R$-driven chemokine programs.\n- B. Perturbation $1$: Selective reduction of T cell recruitment with preservation of B cell follicles, intact FDC networks, and maintained HEV; mechanism: $LT\\beta R$ acts primarily on endothelium and is dispensable for chemokine production. Perturbation $2$: Complete loss of `CXCL13` and FDCs with intact T cell zones and HEV; mechanism: TNFR drives the noncanonical NF-$\\kappa$B pathway in stromal cells and is the dominant organizer signal.\n- C. Perturbation $1$: Increased HEV density, stronger PNAd expression, and sharper B/T segregation due to removal of negative feedback by $LT\\beta R$; mechanism: $LT\\beta R$ signaling restrains stromal activation. Perturbation $2$: No substantive effect on TLS organization because TNF is redundant with $LT\\beta R$ signaling for chemokine induction and FDC differentiation.\n- D. Perturbation $1$: Elimination of T cell zones with preserved germinal centers and FDC networks because B cells provide sufficient `CXCL13` autonomously; HEV remain stable. Mechanism: $LT\\beta R$ controls only `CCL19`/`CCL21`. Perturbation $2$: Elimination of HEV but preserved chemokine gradients and B/T segregation. Mechanism: TNFR signaling is required exclusively for endothelial PNAd expression but not for stromal chemokine programs.", "solution": "This problem requires applying established immunological principles to predict the outcome of two molecular perturbations on a mature Tertiary Lymphoid Structure (TLS).\n\n**Analysis of Perturbation 1: Blockade of Lymphotoxin $\\beta$ Receptor (LT$\\beta$R) Signaling**\n\nPerturbation 1 blocks the interaction between $LT\\alpha_1\\beta_2$ and its receptor, $LT\\beta R$. According to Principle (i), this signaling pathway is the master regulator responsible for initiating and, crucially, *sustaining* the entire organizational framework of the TLS. The consequences of its abrogation are therefore expected to be systemic and severe.\n\n*   **Mechanism**: The loss of $LT\\beta R$ signaling shuts down the noncanonical NF-$\\kappa$B pathway in stromal organizer cells.\n*   **Prediction**: This will lead to a halt in the production of the key homeostatic chemokines (`CXCL13`, `CCL19`, `CCL21`), causing the segregated B and T cell zones to dissolve. The maintenance signal for FDC networks and HEV phenotype (including PNAd expression) will be lost, leading to their regression. The organized TLS will devolve into a simple, diffuse inflammatory infiltrate.\n\n**Analysis of Perturbation 2: Neutralization of Tumor Necrosis Factor (TNF)**\n\nPerturbation 2 blocks TNFR signaling. Principle (ii) describes this pathway's role as supportive and reinforcing, but not foundational. It does not replace the primary $LT\\beta R$-driven programs.\n\n*   **Mechanism**: The loss of TNFR signaling primarily affects canonical NF-$\\kappa$B-dependent processes that fine-tune the TLS environment.\n*   **Prediction**: Since the foundational $LT\\beta R$ pathway remains active, the basic structure (B/T segregation driven by stromal chemokines) will be preserved, albeit potentially weakened. The major impact will be on the functions that TNF specifically supports: FDC maturation and survival, and robust endothelial activation. This would likely result in smaller, less active germinal centers and reduced HEV function (e.g., lower PNAd expression), but not a complete collapse of the TLS.\n\n**Evaluation of Options**\n\n*   **A**: This option's predictions align perfectly with our analysis. It describes a total collapse for Perturbation 1 and a partial functional impairment for Perturbation 2, citing the correct corresponding mechanisms ($LT\\beta R$ as the master switch via noncanonical NF-$\\kappa$B, and TNFR as a supportive amplifier via canonical NF-$\\kappa$B).\n*   **B**: This option incorrectly inverts the roles of $LT\\beta R$ and TNFR, which is a fundamental error based on the provided principles.\n*   **C**: This option incorrectly posits that $LT\\beta R$ is a negative regulator and that TNF is redundant, both of which contradict the problem's premises.\n*   **D**: This option incorrectly limits the scope of $LT\\beta R$ signaling (it is required for both B and T cell zone maintenance) and overstates the effect of TNF neutralization on HEVs.\n\nTherefore, Option A is the only one that correctly applies the given principles to predict the outcomes of both perturbations.", "answer": "$$\\boxed{A}$$", "id": "2895369"}, {"introduction": "Describing the spatial arrangement of cells within a TLS as merely \"segregated\" is qualitative, but modern immunology demands quantitative rigor. Spatial point process statistics, such as Ripley's K-function, provide a powerful mathematical framework for objectively analyzing patterns like clustering or segregation in cellular imaging data. This advanced computational exercise [@problem_id:2895404] guides you through implementing such a method to distinguish between random, segregated, and co-localized cell populations, providing a tangible skill for analyzing real-world microscopy data.", "problem": "You are given a quantitative task grounded in the study of Tertiary Lymphoid Structures (TLS) in immunology: model the spatial segregation or co-localization of B cells and T cells within a circular TLS and quantify deviations from spatial randomness. Represent the TLS as a two-dimensional circular observation window of radius $R$ (in arbitrary length units, abbreviated as a.l.u.), and represent cell positions as points of two types: B cells and T cells.\n\nFundamental base and definitions to use:\n- In a homogeneous spatial Poisson point process (Complete Spatial Randomness, abbreviated as CSR), the expected number of neighbors within a distance $r$ of a typical point grows proportionally to the area $ \\pi r^2 $. For two independent types with constant intensities, the cross-type neighbor expectation scales with the intensity of the target type and $ \\pi r^2 $.\n- Let $ \\lambda_B $ and $ \\lambda_T $ denote the (constant) intensities of B cells and T cells, respectively, defined as counts per unit area.\n- The cross-type Ripley’s $K$ function, denoted $K_{BT}(r)$, is defined as the expected number of T-cell neighbors within distance $r$ of a typical B cell, divided by $ \\lambda_T $. Under independence of types with homogeneity, $K_{BT}(r) = \\pi r^2$.\n- A variance-stabilizing transformation $L_{BT}(r) = \\sqrt{K_{BT}(r) / \\pi}$ is often used, so that under independence $L_{BT}(r) - r$ is expected to be $0$.\n\nProblem requirements:\n1) Derive and implement from first principles a consistent estimator for the cross-type function $K_{BT}(r)$ for two point types in a circular observation window. Use a border (reduced-sample) edge correction appropriate for a circular window: for each radius $r$, only B-cell “focal” points whose entire circle of radius $r$ lies within the observation window may contribute neighbors, and normalize by the T-cell intensity. Let $A$ denote the window area. Your estimator must use:\n   - $ \\lambda_T = N_T / A $ where $ N_T $ is the number of T cells and $ A = \\pi R^2 $.\n   - For each radius $ r $, only include B cells whose distance to the circular boundary is at least $ r $; let the count of such B cells be $ N_B^{\\ast}(r) $.\n   - Count, for each such eligible B cell, the number of T cells within Euclidean distance $ r $.\n2) Compute $ L_{BT}(r) = \\sqrt{ K_{BT}(r) / \\pi } $ and the deviation $ \\Delta(r) = L_{BT}(r) - r $.\n3) Define a scalar segregation summary statistic as the arithmetic mean of $ \\Delta(r) $ across a supplied discrete grid of radii $ \\{ r_k \\} $. Report this mean deviation in a.l.u. Intuitively, negative values indicate segregation (avoidance), positive values indicate attraction (co-localization), and values near zero indicate consistency with independence at the examined scales.\n4) Synthetic data generation must be implemented as specified in the test suite. All random number generation must be seeded exactly as specified to ensure reproducibility.\n5) Numerical units: All distances and coordinates are in arbitrary length units (a.l.u.). Your program must output the mean deviation in a.l.u., rounded to six decimal places for each test case.\n\nTest suite (three scenarios probing different behaviors):\n- Test case $1$ (independence/CSR baseline):\n  - Seed: $12345$\n  - Window radius: $R = 1.0$ a.l.u.\n  - Counts: $N_B = 150$, $N_T = 150$\n  - Generation: Draw B and T points independently and uniformly in the circle of radius $R$.\n  - Radii grid: $ \\{ 0.05, 0.10, 0.15, 0.20, 0.25, 0.30 \\} $ a.l.u.\n\n- Test case $2$ (segregation: two separated clusters):\n  - Seed: $202357$\n  - Window radius: $R = 1.0$ a.l.u.\n  - Counts: $N_B = 150$, $N_T = 150$\n  - Generation: Draw B points from a bivariate normal distribution with mean $(-0.4, 0.0)$ and standard deviation $0.12$ (isotropic), rejecting and resampling any point falling outside the circle of radius $R$ until exactly $N_B$ are accepted. Draw T points analogously with mean $(+0.4, 0.0)$ and standard deviation $0.12$, using the same rejection rule.\n  - Radii grid: $ \\{ 0.05, 0.10, 0.15, 0.20, 0.25, 0.30 \\} $ a.l.u.\n\n- Test case $3$ (attraction: T cells aggregate around B cells):\n  - Seed: $98765$\n  - Window radius: $R = 1.0$ a.l.u.\n  - Counts: $N_B = 150$, $N_T = 150$\n  - Generation: First draw $N_B$ B points uniformly in the circle of radius $R$. Then generate T points by repeatedly selecting a B point uniformly at random and adding an independent bivariate normal offset with mean $(0,0)$ and standard deviation $0.06$ (isotropic). Reject and resample any T point that falls outside the circle until exactly $N_T$ are accepted.\n  - Radii grid: $ \\{ 0.05, 0.10, 0.15, 0.20, 0.25, 0.30 \\} $ a.l.u.\n\nAlgorithmic outputs:\n- For each test case, compute the mean of $ \\Delta(r) $ over the supplied radii grid. Each output must be a floating-point number (in a.l.u.) rounded to six decimal places.\n- Final output format: Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[result1,result2,result3]\"), in the same order as the test cases ($1$ then $2$ then $3$).", "solution": "The problem requires implementing an estimator for the cross-type Ripley's K-function, $K_{BT}(r)$, to analyze the spatial relationship between B cells and T cells within a circular domain.\n\nFirst, we formalize the estimator. The observation window $W$ is a circle of radius $R$ with area $A = \\pi R^2$. The T-cell intensity is estimated as $\\hat{\\lambda}_T = N_T / A$. The problem specifies a border edge correction: for an analysis radius $r$, we only consider B cells $\\mathbf{x}_i$ whose distance from the origin is less than or equal to $R - r$. Let the set of these eligible B cells be $B^*(r)$, and their count be $N_B^*(r)$.\n\nThe estimator for $K_{BT}(r)$ is the average number of T-cell neighbors within distance $r$ of an eligible B cell, normalized by the T-cell intensity:\n$$ \\hat{K}_{BT}(r) = \\frac{1}{\\hat{\\lambda}_T N_B^*(r)} \\sum_{\\mathbf{x}_i \\in B^*(r)} \\sum_{j=1}^{N_T} \\mathbb{I}(||\\mathbf{x}_i - \\mathbf{y}_j|| \\le r) $$\nwhere $\\mathbb{I}(\\cdot)$ is the indicator function.\n\nNext, we apply the variance-stabilizing L-transformation:\n$$ \\hat{L}_{BT}(r) = \\sqrt{\\frac{\\hat{K}_{BT}(r)}{\\pi}} $$\nThe deviation from the theoretical value under spatial independence is then:\n$$ \\hat{\\Delta}(r) = \\hat{L}_{BT}(r) - r $$\nFinally, we compute the summary statistic $\\bar{\\Delta}$ as the arithmetic mean of $\\hat{\\Delta}(r)$ over the specified grid of radii $\\{r_k\\}$.\n\nThe implementation will proceed by:\n1.  Generating the B-cell and T-cell coordinates for each test case according to the specified rules (uniform, segregated normal, or clustered normal), using the given seeds for reproducibility. All generated points are constrained to lie within the circle of radius $R$.\n2.  Iterating through each radius $r_k$ in the analysis grid.\n3.  For each $r_k$, identifying the subset of eligible B cells $B^*(r_k)$.\n4.  For each eligible B cell, counting its T-cell neighbors within distance $r_k$.\n5.  Summing these neighbor counts and using the formula to compute $\\hat{K}_{BT}(r_k)$, then $\\hat{L}_{BT}(r_k)$ and $\\hat{\\Delta}(r_k)$.\n6.  Averaging the computed $\\hat{\\Delta}(r_k)$ values to get the final result for the test case.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.spatial.distance import cdist\n\ndef generate_uniform_in_circle(rng, n, r_max):\n    \"\"\"Generates n points uniformly distributed in a circle of radius r_max.\"\"\"\n    # To generate uniformly, sample radius-squared uniformly, and angle uniformly.\n    # r = R * sqrt(u1), theta = 2*pi*u2\n    mag = r_max * np.sqrt(rng.random(size=n))\n    angle = 2 * np.pi * rng.random(size=n)\n    x = mag * np.cos(angle)\n    y = mag * np.sin(angle)\n    return np.column_stack((x, y))\n\ndef generate_bvn_rejection(rng, n, r_max, mean, std):\n    \"\"\"Generates n points from a bivariate normal distribution, rejecting points\n    outside a circle of radius r_max.\"\"\"\n    points = []\n    cov = [[std**2, 0], [0, std**2]]\n    while len(points) < n:\n        # Generate a batch of points to be more efficient\n        batch_size = n - len(points)\n        candidates = rng.multivariate_normal(mean, cov, size=batch_size)\n        norms = np.linalg.norm(candidates, axis=1)\n        accepted = candidates[norms <= r_max]\n        points.extend(accepted)\n    return np.array(points[:n])\n\ndef generate_attraction_rejection(rng, n_b, n_t, r_max, offset_std):\n    \"\"\"Generates B-cells uniformly, then T-cells clustered around B-cells.\"\"\"\n    b_cells = generate_uniform_in_circle(rng, n_b, r_max)\n    t_cells = []\n    cov = [[offset_std**2, 0], [0, offset_std**2]]\n    while len(t_cells) < n_t:\n        # Select a random B-cell as a center\n        center_b_cell = b_cells[rng.integers(0, n_b)]\n        # Add a normal offset\n        offset = rng.multivariate_normal([0, 0], cov)\n        candidate_t = center_b_cell + offset\n        # Reject if outside the circle\n        if np.linalg.norm(candidate_t) <= r_max:\n            t_cells.append(candidate_t)\n    return b_cells, np.array(t_cells)\n\ndef calculate_mean_deviation(case):\n    \"\"\"\n    Orchestrates data generation and calculation for a single test case.\n    \"\"\"\n    seed = case['seed']\n    R = case['R']\n    N_B = case['N_B']\n    N_T = case['N_T']\n    radii_grid = case['radii_grid']\n    \n    rng = np.random.default_rng(seed)\n\n    if case['id'] == 1: # Independence/CSR\n        b_cells = generate_uniform_in_circle(rng, N_B, R)\n        t_cells = generate_uniform_in_circle(rng, N_T, R)\n    elif case['id'] == 2: # Segregation\n        b_cells = generate_bvn_rejection(rng, N_B, R, mean=[-0.4, 0.0], std=0.12)\n        t_cells = generate_bvn_rejection(rng, N_T, R, mean=[0.4, 0.0], std=0.12)\n    elif case['id'] == 3: # Attraction\n        b_cells, t_cells = generate_attraction_rejection(rng, N_B, N_T, R, offset_std=0.06)\n\n    area = np.pi * R**2\n    lambda_T_hat = N_T / area\n\n    delta_values = []\n    for r in radii_grid:\n        # 1. Identify eligible B-cells (focal points)\n        b_cell_norms = np.linalg.norm(b_cells, axis=1)\n        eligible_mask = b_cell_norms <= (R - r)\n        eligible_b_cells = b_cells[eligible_mask]\n        N_B_star = eligible_b_cells.shape[0]\n\n        if N_B_star == 0:\n            # Estimator is undefined. This is not expected for the given problem parameters.\n            # If it happened, one might return np.nan and use np.nanmean later.\n            # For this problem, we assume N_B_star > 0.\n            continue\n            \n        # 2. Calculate pairwise distances from eligible B-cells to all T-cells\n        dist_matrix = cdist(eligible_b_cells, t_cells)\n\n        # 3. Sum neighbor counts over all eligible B-cells\n        total_neighbors = np.sum(dist_matrix <= r)\n        \n        # 4. Calculate K_BT(r) estimator\n        # The factor 1/lambda_T is A/N_T.\n        # The sum over eligible points is total_neighbors / N_B_star\n        K_BT_hat = (area / N_T) * (total_neighbors / N_B_star)\n        \n        # 5. Calculate L_BT(r) and Delta(r)\n        L_BT_hat = np.sqrt(K_BT_hat / np.pi)\n        delta_r = L_BT_hat - r\n        delta_values.append(delta_r)\n\n    # 6. Compute the mean of Delta(r) values\n    mean_delta = np.mean(delta_values)\n    return mean_delta\n\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases and print the final output.\n    \"\"\"\n    test_cases = [\n        {\n            \"id\": 1,\n            \"seed\": 12345,\n            \"R\": 1.0,\n            \"N_B\": 150,\n            \"N_T\": 150,\n            \"radii_grid\": [0.05, 0.10, 0.15, 0.20, 0.25, 0.30]\n        },\n        {\n            \"id\": 2,\n            \"seed\": 202357,\n            \"R\": 1.0,\n            \"N_B\": 150,\n            \"N_T\": 150,\n            \"radii_grid\": [0.05, 0.10, 0.15, 0.20, 0.25, 0.30]\n        },\n        {\n            \"id\": 3,\n            \"seed\": 98765,\n            \"R\": 1.0,\n            \"N_B\": 150,\n            \"N_T\": 150,\n            \"radii_grid\": [0.05, 0.10, 0.15, 0.20, 0.25, 0.30]\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        result = calculate_mean_deviation(case)\n        results.append(result)\n\n    # Format the final output string\n    formatted_results = [f\"{res:.6f}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2895404"}]}