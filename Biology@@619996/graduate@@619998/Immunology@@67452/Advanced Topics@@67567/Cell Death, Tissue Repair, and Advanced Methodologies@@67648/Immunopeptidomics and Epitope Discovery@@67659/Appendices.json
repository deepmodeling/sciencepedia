{"hands_on_practices": [{"introduction": "A core skill in mass spectrometry-based proteomics is the ability to translate between a peptide's sequence and its expected signal in the mass spectrometer. This fundamental calculation is the first step in validating a potential peptide identification from raw spectral data. The following exercise [Problem ID: 2860774] will guide you through computing the theoretical monoisotopic mass of a peptide and its corresponding mass-to-charge ($m/z$) values, reinforcing the principles that link chemical composition to experimental observation.", "problem": "In an immunopeptidomics experiment aimed at epitope discovery from Major Histocompatibility Complex (MHC) class I ligands, you isolate a candidate nonamer ($9$-mer) peptide whose amino acid composition is one each of valine ($\\mathrm{V}$), leucine ($\\mathrm{L}$), methionine ($\\mathrm{M}$), glycine ($\\mathrm{G}$), alanine ($\\mathrm{A}$), proline ($\\mathrm{P}$), serine ($\\mathrm{S}$), threonine ($\\mathrm{T}$), and tyrosine ($\\mathrm{Y}$). The peptide is unmodified (no post-translational modifications) and analyzed by Liquid Chromatography coupled to Tandem Mass Spectrometry (LC-MS/MS). You will compute the theoretical monoisotopic neutral mass and the expected mass-to-charge ratio (m/z) values for the doubly and triply protonated ions, as they are typically observed in positive-ion mode.\n\nUse only the following fundamental definitions and constants:\n- A peptide’s monoisotopic neutral mass equals the sum of its monoisotopic residue masses plus the mass of one water molecule capping the termini.\n- Protonation in positive-ion mode adds one proton mass per charge and imparts that charge; mass-to-charge ratio (m/z) is defined as total ion mass divided by its charge.\n- Monoisotopic residue masses (in daltons, $\\mathrm{Da}$): $\\mathrm{V}: 99.06841$, $\\mathrm{L}: 113.08406$, $\\mathrm{M}: 131.04049$, $\\mathrm{G}: 57.02146$, $\\mathrm{A}: 71.03711$, $\\mathrm{P}: 97.05276$, $\\mathrm{S}: 87.03203$, $\\mathrm{T}: 101.04768$, $\\mathrm{Y}: 163.06333$.\n- Mass of water: $18.01056$.\n- Mass of a proton: $1.007276$.\n\nDerive the monoisotopic neutral mass of the peptide and the theoretical $m/z$ values for charge states $z=2$ and $z=3$. Round each numerical result to six significant figures. Express the monoisotopic mass in daltons and $m/z$ in daltons per charge. Provide your final numerical results, in the order (monoisotopic neutral mass, $m/z$ for $z=2$, $m/z$ for $z=3$), as three entries in a single row.", "solution": "The problem posed is a standard calculation in the field of mass spectrometry-based proteomics and is scientifically sound, well-posed, and contains all necessary information for a unique solution. We shall proceed with the derivation.\n\nThe fundamental task is to compute the theoretical monoisotopic mass of a peptide of a given amino acid composition and then determine the mass-to-charge ratios ($m/z$) for its protonated forms.\n\nFirst, we calculate the total mass of the amino acid residues. The peptide is specified as a nonamer ($9$-mer) with one residue each of valine ($\\mathrm{V}$), leucine ($\\mathrm{L}$), methionine ($\\mathrm{M}$), glycine ($\\mathrm{G}$), alanine ($\\mathrm{A}$), proline ($\\mathrm{P}$), serine ($\\mathrm{S}$), threonine ($\\mathrm{T}$), and tyrosine ($\\mathrm{Y}$). Let $M_{\\text{residues}}$ represent the sum of the monoisotopic masses of these residues. Using the provided values:\n$$M_{\\text{residues}} = M_{\\mathrm{V}} + M_{\\mathrm{L}} + M_{\\mathrm{M}} + M_{\\mathrm{G}} + M_{\\mathrm{A}} + M_{\\mathrm{P}} + M_{\\mathrm{S}} + M_{\\mathrm{T}} + M_{\\mathrm{Y}}$$\nSubstituting the given masses in daltons ($\\mathrm{Da}$):\n$$M_{\\text{residues}} = 99.06841 + 113.08406 + 131.04049 + 57.02146 + 71.03711 + 97.05276 + 87.03203 + 101.04768 + 163.06333$$\nSumming these values yields:\n$$M_{\\text{residues}} = 919.44733~\\mathrm{Da}$$\n\nNext, we determine the monoisotopic neutral mass of the intact peptide, denoted as $M_{\\text{neutral}}$. The problem defines this as the sum of the residue masses plus the mass of one water molecule ($M_{\\mathrm{H}_2\\mathrm{O}}$). This accounts for the hydrogen atom at the N-terminus and the hydroxyl group at the C-terminus, which are notionally removed during peptide bond formation and thus are not part of the residue mass definitions.\nGiven $M_{\\mathrm{H}_2\\mathrm{O}} = 18.01056~\\mathrm{Da}$:\n$$M_{\\text{neutral}} = M_{\\text{residues}} + M_{\\mathrm{H}_2\\mathrm{O}}$$\n$$M_{\\text{neutral}} = 919.44733 + 18.01056 = 937.45789~\\mathrm{Da}$$\nAs per the instruction, we round this result to six significant figures, which gives $937.458~\\mathrm{Da}$.\n\nFinally, we calculate the expected mass-to-charge ratios ($m/z$) for the doubly ($z=2$) and triply ($z=3$) charged ions. In positive-ion mode electrospray ionization, a molecule with mass $M_{\\text{neutral}}$ becomes an ion of mass $M_{\\text{ion}}$ by adducting $z$ protons ($\\mathrm{H}^+$), where $z$ is the integer charge state. The mass of a proton is given as $M_{\\mathrm{H}^+} = 1.007276~\\mathrm{Da}$.\n\nThe mass of the ion is given by:\n$$M_{\\text{ion}} = M_{\\text{neutral}} + z \\cdot M_{\\mathrm{H}^+}$$\nThe mass-to-charge ratio is then defined as:\n$$ \\frac{m}{z} = \\frac{M_{\\text{ion}}}{z} = \\frac{M_{\\text{neutral}} + z \\cdot M_{\\mathrm{H}^+}}{z} $$\n\nFor the doubly charged ion ($z=2$):\n$$ \\left(\\frac{m}{z}\\right)_{z=2} = \\frac{937.45789 + 2 \\cdot (1.007276)}{2} = \\frac{939.472442}{2} = 469.736221 $$\nRounding to six significant figures, we get $469.736$.\n\nFor the triply charged ion ($z=3$):\n$$ \\left(\\frac{m}{z}\\right)_{z=3} = \\frac{937.45789 + 3 \\cdot (1.007276)}{3} = \\frac{940.479718}{3} = 313.4932393... $$\nRounding to six significant figures, we get $313.493$.\n\nThe required results are the monoisotopic neutral mass, the $m/z$ for the charge state $z=2$, and the $m/z$ for the charge state $z=3$. These values have been calculated and correctly rounded.", "answer": "$$\\boxed{\\begin{pmatrix} 937.458 & 469.736 & 313.493 \\end{pmatrix}}$$", "id": "2860774"}, {"introduction": "Once a peptide's sequence is known, a central task in epitope discovery is to predict its binding affinity to a specific Human Leukocyte Antigen (HLA) molecule. This is often achieved using scoring models derived from large datasets of known binders. In this practice [Problem ID: 2860695], you will apply a Position-Specific Scoring Matrix (PSSM) to calculate a log-odds binding score, a widely used method in immunoinformatics to quantify the likelihood that a given peptide is a true HLA ligand.", "problem": "A research group applies immunopeptidomics to identify peptides presented by Human Leukocyte Antigen (HLA) class I allele HLA-B*07:02 and builds a Position-Specific Scoring Matrix (PSSM). Under the standard independence assumption across positions, a peptide’s log-odds binding score is the log-likelihood ratio (binder model versus proteome background) computed with the natural logarithm $\\ln$. Consider the $9$-mer peptide sequence $\\mathrm{A}\\mathrm{P}\\mathrm{R}\\mathrm{T}\\mathrm{V}\\mathrm{P}\\mathrm{L}\\mathrm{V}\\mathrm{L}$ (positions $1$ through $9$). The proteome background amino acid frequencies $q(a)$ for the amino acids present in this peptide are:\n- $q(\\mathrm{A})=0.082$, $q(\\mathrm{P})=0.047$, $q(\\mathrm{R})=0.055$, $q(\\mathrm{T})=0.054$, $q(\\mathrm{V})=0.068$, $q(\\mathrm{L})=0.099$.\n\nFrom the HLA-B*07:02 binder set, the position-specific probabilities $p(a\\mid i)$ for the amino acid actually observed at each peptide position $i$ are:\n- Position $1$: $\\mathrm{A}$ with $p(\\mathrm{A}\\mid 1)=0.08$\n- Position $2$: $\\mathrm{P}$ with $p(\\mathrm{P}\\mid 2)=0.55$\n- Position $3$: $\\mathrm{R}$ with $p(\\mathrm{R}\\mid 3)=0.05$\n- Position $4$: $\\mathrm{T}$ with $p(\\mathrm{T}\\mid 4)=0.07$\n- Position $5$: $\\mathrm{V}$ with $p(\\mathrm{V}\\mid 5)=0.09$\n- Position $6$: $\\mathrm{P}$ with $p(\\mathrm{P}\\mid 6)=0.12$\n- Position $7$: $\\mathrm{L}$ with $p(\\mathrm{L}\\mid 7)=0.10$\n- Position $8$: $\\mathrm{V}$ with $p(\\mathrm{V}\\mid 8)=0.12$\n- Position $9$: $\\mathrm{L}$ with $p(\\mathrm{L}\\mid 9)=0.45$\n\nThe laboratory has previously calibrated that a score threshold $s_{\\ast}=5.50$ corresponds to peptides with dissociation constant ($K_d$) less than $500$ nM for HLA-B*07:02. Using only the information above and starting from the definition of a log-likelihood ratio under a position-independent model, compute the peptide’s log-odds binding score $s$ and determine whether it exceeds $s_{\\ast}$. Round $s$ to four significant figures. Express $s$ as a unitless number.", "solution": "The problem statement has been validated and is determined to be scientifically grounded, well-posed, and internally consistent. It presents a standard calculation in the field of immunoinformatics. We shall proceed with the solution.\n\nThe problem requires the computation of a log-odds binding score, $s$, for a given peptide sequence. This score is defined as the natural logarithm of the likelihood ratio between a binder model and a background proteome model. Let the peptide sequence be $S = S_1S_2...S_L$, where $L$ is the length of the peptide. In this case, $L=9$.\n\nThe binder model assumes that the probability of observing a specific amino acid $a$ at a position $i$ is position-dependent and given by $p(a \\mid i)$. Under the \"standard independence assumption across positions,\" the likelihood of observing the entire sequence $S$ given the binder model is the product of the probabilities for each position:\n$$\nP(S \\mid \\text{binder}) = \\prod_{i=1}^{L} p(S_i \\mid i)\n$$\n\nThe background model assumes the probability of observing an amino acid $a$ is independent of position and is given by its general frequency in the proteome, $q(a)$. The likelihood of observing the sequence $S$ given the background model is:\n$$\nP(S \\mid \\text{background}) = \\prod_{i=1}^{L} q(S_i)\n$$\n\nThe log-odds score $s$ is the natural logarithm of the ratio of these two likelihoods:\n$$\ns = \\ln\\left( \\frac{P(S \\mid \\text{binder})}{P(S \\mid \\text{background})} \\right) = \\ln\\left( \\frac{\\prod_{i=1}^{L} p(S_i \\mid i)}{\\prod_{i=1}^{L} q(S_i)} \\right)\n$$\n\nUsing the property of logarithms that $\\ln(a/b) = \\ln(a) - \\ln(b)$ and $\\ln(\\prod x_i) = \\sum \\ln(x_i)$, the expression for the score $s$ simplifies to a sum of position-specific log-odds scores:\n$$\ns = \\sum_{i=1}^{L} \\left( \\ln(p(S_i \\mid i)) - \\ln(q(S_i)) \\right) = \\sum_{i=1}^{L} \\ln\\left( \\frac{p(S_i \\mid i)}{q(S_i)} \\right)\n$$\nThe peptide sequence is given as $S = \\mathrm{A}\\mathrm{P}\\mathrm{R}\\mathrm{T}\\mathrm{V}\\mathrm{P}\\mathrm{L}\\mathrm{V}\\mathrm{L}$. The length is $L=9$. We are provided with all necessary position-specific probabilities $p(S_i \\mid i)$ from the binder set and background frequencies $q(S_i)$. We will compute the score term for each position $i$ from $1$ to $9$.\n\nFor position $i=1$, amino acid is $\\mathrm{A}$:\nTerm $1 = \\ln\\left( \\frac{p(\\mathrm{A} \\mid 1)}{q(\\mathrm{A})} \\right) = \\ln\\left( \\frac{0.08}{0.082} \\right)$\n\nFor position $i=2$, amino acid is $\\mathrm{P}$:\nTerm $2 = \\ln\\left( \\frac{p(\\mathrm{P} \\mid 2)}{q(\\mathrm{P})} \\right) = \\ln\\left( \\frac{0.55}{0.047} \\right)$\n\nFor position $i=3$, amino acid is $\\mathrm{R}$:\nTerm $3 = \\ln\\left( \\frac{p(\\mathrm{R} \\mid 3)}{q(\\mathrm{R})} \\right) = \\ln\\left( \\frac{0.05}{0.055} \\right)$\n\nFor position $i=4$, amino acid is $\\mathrm{T}$:\nTerm $4 = \\ln\\left( \\frac{p(\\mathrm{T} \\mid 4)}{q(\\mathrm{T})} \\right) = \\ln\\left( \\frac{0.07}{0.054} \\right)$\n\nFor position $i=5$, amino acid is $\\mathrm{V}$:\nTerm $5 = \\ln\\left( \\frac{p(\\mathrm{V} \\mid 5)}{q(\\mathrm{V})} \\right) = \\ln\\left( \\frac{0.09}{0.068} \\right)$\n\nFor position $i=6$, amino acid is $\\mathrm{P}$:\nTerm $6 = \\ln\\left( \\frac{p(\\mathrm{P} \\mid 6)}{q(\\mathrm{P})} \\right) = \\ln\\left( \\frac{0.12}{0.047} \\right)$\n\nFor position $i=7$, amino acid is $\\mathrm{L}$:\nTerm $7 = \\ln\\left( \\frac{p(\\mathrm{L} \\mid 7)}{q(\\mathrm{L})} \\right) = \\ln\\left( \\frac{0.10}{0.099} \\right)$\n\nFor position $i=8$, amino acid is $\\mathrm{V}$:\nTerm $8 = \\ln\\left( \\frac{p(\\mathrm{V} \\mid 8)}{q(\\mathrm{V})} \\right) = \\ln\\left( \\frac{0.12}{0.068} \\right)$\n\nFor position $i=9$, amino acid is $\\mathrm{L}$:\nTerm $9 = \\ln\\left( \\frac{p(\\mathrm{L} \\mid 9)}{q(\\mathrm{L})} \\right) = \\ln\\left( \\frac{0.45}{0.099} \\right)$\n\nThe total score $s$ is the sum of these nine terms:\n$$\ns = \\ln\\left(\\frac{0.08}{0.082}\\right) + \\ln\\left(\\frac{0.55}{0.047}\\right) + \\ln\\left(\\frac{0.05}{0.055}\\right) + \\ln\\left(\\frac{0.07}{0.054}\\right) + \\ln\\left(\\frac{0.09}{0.068}\\right) + \\ln\\left(\\frac{0.12}{0.047}\\right) + \\ln\\left(\\frac{0.10}{0.099}\\right) + \\ln\\left(\\frac{0.12}{0.068}\\right) + \\ln\\left(\\frac{0.45}{0.099}\\right)\n$$\nNow we compute the numerical value:\n$s \\approx -0.02469 + 2.45973 - 0.09531 + 0.25952 + 0.28032 + 0.93734 + 0.01005 + 0.56795 + 1.51412$\n$s \\approx 5.90903$\n\nThe problem requires rounding the score $s$ to four significant figures.\n$s \\approx 5.909$\n\nThe final step is to compare this score to the specified threshold $s_{\\ast} = 5.50$.\nWe have $s \\approx 5.909$. Since $5.909 > 5.50$, the peptide's binding score exceeds the threshold. This suggests that the peptide is predicted to be a binder to the HLA-B*07:02 molecule. The question asks for the computation of the score and the determination of whether it exceeds the threshold. We have completed both steps. The final answer is the numerical value of the score.", "answer": "$$\n\\boxed{5.909}\n$$", "id": "2860695"}, {"introduction": "In any high-throughput experiment, distinguishing true signals from random noise is paramount. Immunopeptidomics searches generate thousands of peptide-spectrum matches, requiring a robust statistical framework to control for false positives. This exercise [Problem ID: 2860715] delves into the critical concept of the False Discovery Rate (FDR) and its estimation using the target-decoy competition strategy, a cornerstone of modern proteomics data validation.", "problem": "An immunopeptidomics liquid chromatography–tandem mass spectrometry experiment aims to profile the Human Leukocyte Antigen (HLA) ligandome using an open mass-tolerant database search with a concatenated target–decoy database and target–decoy competition (TDC). Peptide-spectrum matches (PSMs) are filtered at a fixed score threshold. Under TDC, the accepted set contains the best-scoring hit per spectrum after direct competition between target and decoy candidates. At a chosen score threshold, you observe $1000$ accepted target PSMs and $50$ accepted decoy PSMs.\n\nStarting from the definition of False Discovery Rate (FDR) as the expected proportion of false positives among accepted discoveries, and the standard TDC assumption that, under the null, false matches are equally likely to be assigned to target or decoy, derive the large-sample estimator of the PSM-level FDR from first principles and compute its value for the reported counts. Then, reason about whether the open-search context in immunopeptidomics could justify a more conservative correction than the basic TDC estimator, based on how the search space and null-match behavior change in wide-tolerance, non-enzymatic searches.\n\nExpress the final numeric FDR as a decimal fraction and round to four significant figures. Do not use a percentage sign.", "solution": "The problem requires the derivation of the large-sample estimator for the Peptide-Spectrum Match (PSM) level False Discovery Rate (FDR) under a target-decoy competition (TDC) strategy, its calculation for the given data, and a critical evaluation of this estimator in the context of an open-search immunopeptidomics experiment.\n\nFirst, we establish the theoretical framework. The False Discovery Rate ($FDR$) is defined as the expected proportion of false positives (incorrect discoveries) among all accepted discoveries. Let $T$ be the number of accepted target PSMs and $D$ be the number of accepted decoy PSMs at a given score threshold. The set of reported discoveries consists only of the target PSMs, so the total number of discoveries is $T$. Let $V_T$ be the number of false positive PSMs within this set of $T$ target hits. The FDR is then:\n$$FDR = E\\left[\\frac{V_T}{T}\\right]$$\nFor large numbers of discoveries, this is often approximated by the ratio of expectations:\n$$FDR \\approx \\frac{E[V_T]}{E[T]}$$\nWe seek an estimator, $\\widehat{FDR}$, for this quantity. The observed number of target hits, $T$, is a direct estimate of $E[T]$. The main challenge is to estimate the number of false target hits, $E[V_T]$.\n\nThis is accomplished using the target-decoy strategy. The core assumption of the standard TDC approach is that the search database is composed of two parts of equal size and statistical properties: the target database, containing real protein sequences, and the decoy database, containing artificial (e.g., reversed or shuffled) sequences. Under the null hypothesis (i.e., a spectrum for which no correct peptide sequence exists in the target database), a random match is equally likely to be to a target sequence as to a decoy sequence.\n\nIn a TDC search, for each spectrum, only the single highest-scoring PSM is considered, regardless of whether it is a target or a decoy. The set of accepted hits consists of all such best-scoring PSMs that pass a certain score threshold.\nLet the number of accepted target hits be $T$ and the number of accepted decoy hits be $D$.\n\nBy definition, decoy sequences do not exist in the biological sample, so any match to a decoy sequence must be a false positive. Therefore, the observed count of decoy PSMs, $D$, is a direct measurement of the number of false decoy hits.\n\nDue to the symmetry of the null distribution, the number of false positive PSMs that are incorrectly assigned to a target sequence is expected to be equal to the number of false positive PSMs assigned to a decoy sequence. This gives us the crucial relationship:\n$$E[V_T] = E[D]$$\nWe can use the observed number of decoy hits, $D$, as our best estimate for the expected number of false decoy hits, and by extension, for the expected number of false target hits, $V_T$. Let $\\hat{V}_T$ be our estimate for $V_T$. We set:\n$$\\hat{V}_T = D$$\nSubstituting this estimate into the FDR formula, we obtain the large-sample estimator for the PSM-level FDR:\n$$\\widehat{FDR} = \\frac{\\hat{V}_T}{T} = \\frac{D}{T}$$\nUsing the data provided in the problem statement:\n- Number of accepted target PSMs, $T = 1000$\n- Number of accepted decoy PSMs, $D = 50$\n\nWe can compute the value of the FDR estimator:\n$$\\widehat{FDR} = \\frac{50}{1000} = 0.05$$\nRounding this to four significant figures as requested, we get $0.05000$.\n\nNext, we must reason about the validity of this estimator in the specific context of an open, non-enzymatic search in immunopeptidomics.\nAn \"open search\" uses a very wide precursor mass tolerance window (e.g., hundreds of Daltons) to allow for the identification of peptides with unknown or unexpected post-translational modifications (PTMs). Immunopeptidomics deals with peptides presented by HLA molecules, which are generated by non-specific cleavage, meaning the database of potential peptides is already immense. The combination of these two factors—a wide mass tolerance and a non-enzymatic peptide space—dramatically enlarges the search space for each spectrum.\n\nThis enlargement can challenge the fundamental assumption of the TDC model, namely that the null distribution is symmetric for targets and decoys. The target database is composed of evolutionarily selected, functional protein sequences, whereas the decoy database consists of non-functional, random-like sequences.\nA real peptide in the sample that carries an unexpected PTM might not match its canonical sequence in the database within the narrow mass tolerance of a standard search. In an open search, however, it might produce a reasonably high-scoring, but technically incorrect, match to its *unmodified cognate sequence* in the target database. This is because significant portions of the fragment ion series may still align. It is far less likely that this modified peptide would find an equally good partial match to a random, shuffled sequence in the decoy database.\n\nThis introduces an asymmetry: there exists a class of \"near-miss\" or \"partially correct\" false positives that are preferentially found in the target database. These are not truly random null matches. Consequently, the number of incorrect hits to the target database could be systematically larger than the number of hits to the decoy database.\n$$E[V_T] > E[D]$$\nIn this scenario, using $D$ as an estimator for $V_T$ (i.e., $\\hat{V}_T = D$) would lead to an underestimation of the true number of false positives among the target hits. As a result, the standard FDR estimator, $\\widehat{FDR} = \\frac{D}{T}$, would report a value that is artificially low, providing a misleading and overly optimistic assessment of the data quality.\n\nTherefore, the specific context of an open search in immunopeptidomics justifies a more conservative correction to the FDR estimator. Such a correction might take the form of $\\widehat{FDR}_{corrected} = \\frac{\\pi D}{T}$, where the factor $\\pi > 1$ accounts for the excess of non-random, incorrect matches to the target database that are not captured by the decoy model. The choice of an appropriate value for $\\pi$ is an active area of research in proteomics bioinformatics. The standard estimator, however, remains $\\frac{D}{T}$.", "answer": "$$\n\\boxed{0.05000}\n$$", "id": "2860715"}]}