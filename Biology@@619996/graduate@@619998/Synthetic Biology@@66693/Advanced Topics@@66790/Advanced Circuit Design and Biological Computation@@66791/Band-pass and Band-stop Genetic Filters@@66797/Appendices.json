{"hands_on_practices": [{"introduction": "The incoherent type-1 feed-forward loop (I1-FFL) is a ubiquitous network motif capable of generating a transient pulse response, making it an ideal candidate for building genetic band-pass filters. This exercise delves into the core mechanism by which this circuit translates a step-like input into a pulse, a behavior known as perfect adaptation. By analyzing a linearized model, you will derive the precise conditions under which this motif functions as a band-pass filter and determine the analytical expression for its peak response frequency, $\\omega_{\\text{peak}}$ [@problem_id:2715264].", "problem": "An incoherent type-1 feed-forward loop (I1-FFL) is a three-node genetic motif in which an input transcription factor $x$ activates both an intermediate regulator $v$ and an output gene product $z$, while $v$ represses $z$. Consider small perturbations about a stable steady state so that linear response theory applies. Let $v$ and $z$ denote deviations from steady state of the corresponding species concentrations, and let $x$ denote a small deviation of the input transcription factor concentration. Assume first-order production and decay around the operating point so that the small-signal dynamics are governed by\n$$\n\\frac{dv}{dt} = -\\gamma_{v}\\, v + k_{v}\\, x, \\quad \\frac{dz}{dt} = -\\gamma_{z}\\, z + k_{x}\\, x - k_{vz}\\, v,\n$$\nwhere $\\gamma_{v}>0$ and $\\gamma_{z}>0$ are effective first-order dilution-degradation rates (equivalently, inverse characteristic times), and $k_{v}>0$, $k_{x}>0$, $k_{vz}>0$ are effective small-signal gains arising from linearization of regulatory interactions. Let $G(s)$ denote the transfer function from $x$ to $z$ in the Laplace domain, and let $|G(j\\omega)|$ denote its magnitude at angular frequency $\\omega$.\n\nStarting from the Central Dogma of Molecular Biology and first-order mass-action degradation, and using linear system theory as a well-tested analytical framework for small perturbations in genetic circuits, do the following:\n\n- Derive $G(s)$ for the I1-FFL described above.\n- From first principles, derive the condition under which the steady-state (zero-frequency) small-signal gain is exactly zero (perfect adaptation of $z$ to a step in $x$).\n- Under that condition, determine whether $|G(j\\omega)|$ exhibits a peak at a finite nonzero frequency and, if it does, compute the angular frequency $\\omega_{\\text{peak}}$ at which the magnitude attains its maximum. Express $\\omega_{\\text{peak}}$ in terms of $\\gamma_{v}$ and $\\gamma_{z}$. Use radians as the unit for angular frequency.\n\nYour final reported answer must be a single closed-form expression for $\\omega_{\\text{peak}}$ in terms of $\\gamma_{v}$ and $\\gamma_{z}$. Do not include units in the final boxed answer, and do not round or approximate the expression.", "solution": "The problem as stated is scientifically grounded, self-contained, and well-posed. It describes a canonical incoherent type-1 feed-forward loop (I1-FFL) and asks for an analysis of its small-signal frequency response under the condition of perfect adaptation. The use of linearized dynamics and transfer function analysis is a standard and appropriate methodology for this task. We shall proceed with the solution.\n\nThe system dynamics are given by the following set of linear ordinary differential equations:\n$$\n\\frac{dv}{dt} = -\\gamma_{v}\\, v + k_{v}\\, x\n$$\n$$\n\\frac{dz}{dt} = -\\gamma_{z}\\, z + k_{x}\\, x - k_{vz}\\, v\n$$\nwhere all parameters $\\gamma_v, \\gamma_z, k_v, k_x, k_{vz}$ are positive constants.\n\nOur first task is to derive the transfer function $G(s)$ from the input $x$ to the output $z$. We apply the Laplace transform to the system of equations, assuming zero initial conditions. Let $X(s)$, $V(s)$, and $Z(s)$ be the Laplace transforms of $x(t)$, $v(t)$, and $z(t)$, respectively.\nThe transformed equations are:\n$$\nsV(s) = -\\gamma_{v} V(s) + k_{v} X(s)\n$$\n$$\nsZ(s) = -\\gamma_{z} Z(s) + k_{x} X(s) - k_{vz} V(s)\n$$\nFrom the first equation, we solve for $V(s)$ in terms of $X(s)$:\n$$\n(s + \\gamma_{v}) V(s) = k_{v} X(s) \\implies V(s) = \\frac{k_{v}}{s + \\gamma_{v}} X(s)\n$$\nNext, we substitute this expression for $V(s)$ into the second transformed equation:\n$$\n(s + \\gamma_{z}) Z(s) = k_{x} X(s) - k_{vz} \\left( \\frac{k_{v}}{s + \\gamma_{v}} \\right) X(s)\n$$\nThe transfer function $G(s)$ is defined as the ratio $Z(s)/X(s)$. We rearrange the equation to find this ratio:\n$$\nG(s) = \\frac{Z(s)}{X(s)} = \\frac{1}{s + \\gamma_{z}} \\left( k_{x} - \\frac{k_{vz} k_{v}}{s + \\gamma_{v}} \\right)\n$$\nTo express this as a single rational function, we find a common denominator:\n$$\nG(s) = \\frac{k_{x}(s + \\gamma_{v}) - k_{vz} k_{v}}{(s + \\gamma_{z})(s + \\gamma_{v})}\n$$\n$$\nG(s) = \\frac{k_{x}s + k_{x}\\gamma_{v} - k_{vz}k_{v}}{(s + \\gamma_{z})(s + \\gamma_{v})}\n$$\nThis is the required transfer function from $x$ to $z$.\n\nThe second task is to find the condition for perfect adaptation. Perfect adaptation implies that the steady-state response of the output $z$ to a constant step change in the input $x$ is zero. In the context of linear systems, this corresponds to the steady-state gain, or zero-frequency gain, being zero. The steady-state gain is given by $G(s)$ evaluated at $s=0$.\n$$\nG(0) = \\frac{k_{x}(0) + k_{x}\\gamma_{v} - k_{vz}k_{v}}{(0 + \\gamma_{z})(0 + \\gamma_{v})} = \\frac{k_{x}\\gamma_{v} - k_{vz}k_{v}}{\\gamma_{z}\\gamma_{v}}\n$$\nFor perfect adaptation, we must have $G(0) = 0$. Since $\\gamma_z > 0$ and $\\gamma_v > 0$, the denominator is non-zero. Thus, the numerator must be zero:\n$$\nk_{x}\\gamma_{v} - k_{vz}k_{v} = 0\n$$\nThis yields the condition for perfect adaptation:\n$$\nk_{x}\\gamma_{v} = k_{vz}k_{v}\n$$\n\nThe final task is to determine the peak frequency of the magnitude response $|G(j\\omega)|$ under the condition of perfect adaptation. We substitute the condition $k_{x}\\gamma_{v} = k_{vz}k_{v}$ back into the expression for $G(s)$:\n$$\nG(s) = \\frac{k_{x}s + k_{x}\\gamma_{v} - k_{x}\\gamma_{v}}{(s + \\gamma_{z})(s + \\gamma_{v})} = \\frac{k_{x}s}{(s + \\gamma_{z})(s + \\gamma_{v})}\n$$\nThis transfer function has a zero at the origin ($s=0$) and two real poles at $s=-\\gamma_z$ and $s=-\\gamma_v$. This structure is characteristic of a band-pass filter. The gain is zero at $\\omega=0$ and as $\\omega \\to \\infty$, which implies that if a maximum exists for $\\omega > 0$, it must occur at a finite, non-zero frequency.\n\nTo find this peak frequency, $\\omega_{\\text{peak}}$, we analyze the magnitude of the frequency response, $|G(j\\omega)|$. We obtain the frequency response by setting $s=j\\omega$:\n$$\nG(j\\omega) = \\frac{k_{x}j\\omega}{(j\\omega + \\gamma_{z})(j\\omega + \\gamma_{v})}\n$$\nThe squared magnitude is easier to work with for maximization:\n$$\n|G(j\\omega)|^2 = G(j\\omega)G(-j\\omega) = \\frac{k_{x}j\\omega}{(j\\omega + \\gamma_{z})(j\\omega + \\gamma_{v})} \\cdot \\frac{k_{x}(-j\\omega)}{(-j\\omega + \\gamma_{z})(-j\\omega + \\gamma_{v})}\n$$\n$$\n|G(j\\omega)|^2 = \\frac{k_{x}^2 \\omega^2}{(\\gamma_{z}^2 + \\omega^2)(\\gamma_{v}^2 + \\omega^2)}\n$$\nThe frequency $\\omega_{\\text{peak}}$ that maximizes $|G(j\\omega)|$ also maximizes $|G(j\\omega)|^2$. To find this maximum, we can minimize the reciprocal of the frequency-dependent part of $|G(j\\omega)|^2$. Let us define a function $H(\\omega)$:\n$$\nH(\\omega) = \\frac{(\\gamma_{z}^2 + \\omega^2)(\\gamma_{v}^2 + \\omega^2)}{\\omega^2}\n$$\nWe seek to find the value of $\\omega > 0$ that minimizes $H(\\omega)$. Expanding the numerator and dividing by $\\omega^2$ gives:\n$$\nH(\\omega) = \\frac{\\omega^4 + (\\gamma_{z}^2 + \\gamma_{v}^2)\\omega^2 + \\gamma_{z}^2\\gamma_{v}^2}{\\omega^2} = \\omega^2 + (\\gamma_{z}^2 + \\gamma_{v}^2) + \\frac{\\gamma_{z}^2\\gamma_{v}^2}{\\omega^2}\n$$\nTo find the minimum, we compute the derivative of $H(\\omega)$ with respect to $\\omega$ and set it to zero:\n$$\n\\frac{dH}{d\\omega} = 2\\omega - 2\\frac{\\gamma_{z}^2\\gamma_{v}^2}{\\omega^3}\n$$\nSetting the derivative to zero for $\\omega \\neq 0$:\n$$\n2\\omega = 2\\frac{\\gamma_{z}^2\\gamma_{v}^2}{\\omega^3}\n$$\n$$\n\\omega^4 = \\gamma_{z}^2\\gamma_{v}^2\n$$\nSince $\\omega$ must be a real, positive frequency, we take the positive square root twice:\n$$\n\\omega^2 = \\sqrt{\\gamma_{z}^2\\gamma_{v}^2} = \\gamma_{z}\\gamma_{v} \\quad (\\text{since } \\gamma_z > 0, \\gamma_v > 0)\n$$\n$$\n\\omega = \\sqrt{\\gamma_{z}\\gamma_{v}}\n$$\nThis stationary point corresponds to a minimum for $H(\\omega)$ (and thus a maximum for $|G(j\\omega)|^2$) because the second derivative $\\frac{d^2H}{d\\omega^2} = 2 + 6\\frac{\\gamma_{z}^2\\gamma_{v}^2}{\\omega^4}$ is strictly positive for all real $\\omega \\neq 0$. Therefore, the peak angular frequency is the geometric mean of the two degradation rates.\n$$\n\\omega_{\\text{peak}} = \\sqrt{\\gamma_{v}\\gamma_{z}}\n$$", "answer": "$$\\boxed{\\sqrt{\\gamma_{v}\\gamma_{z}}}$$", "id": "2715264"}, {"introduction": "Building on the principles of the I1-FFL, this practice explores a crucial aspect of filter engineering: the inherent trade-offs in performance tuning. You will investigate how modulating protein degradation rates, key tunable parameters in synthetic biology, affects both the sensitivity (peak gain, $G_{\\mathrm{peak}}$) and the operational frequency range (bandwidth, $\\mathrm{BW}$) of the filter. This exercise culminates in deriving the gain-bandwidth product, a fundamental performance metric that quantifies the trade-off between making a circuit highly responsive and making it operate over a wide range of signal frequencies [@problem_id:2715227].", "problem": "A canonical small-signal band-pass genetic filter can be realized by an incoherent feedforward motif that implements near-perfect adaptation at steady state and differentiating behavior to input fluctuations. Consider the following linearized ordinary differential equation model for the small-signal dynamics around a steady state driven by an input fluctuation $u(t)$:\n$$\n\\frac{d x}{d t} = -\\gamma\\, x + \\beta\\, u, \\quad \\frac{d y}{d t} = -\\lambda \\gamma\\, y + \\alpha\\big(u - c\\, x\\big),\n$$\nwhere $x$ is the small-signal activity of an activating arm with degradation or dilution rate $\\gamma>0$, $y$ is the small-signal reporter output degraded at rate $\\lambda \\gamma$ with $\\lambda>0$, and $\\alpha,\\beta,c>0$ are effective small-signal gains. The steady-state adaptation condition (zero direct current gain) is imposed by matching the arms such that the direct current response of $y$ to a constant $u$ vanishes. Under this matching, derive the small-signal transfer function $H(s) = Y(s)/U(s)$ of the filter. Then, working in the frequency domain with $s = j\\omega$, perform the following steps using first principles:\n- Determine the angular frequency $\\omega_{\\mathrm{peak}}$ that maximizes the magnitude $|H(j\\omega)|$ and compute the corresponding peak gain $G_{\\mathrm{peak}}=|H(j\\omega_{\\mathrm{peak}})|$.\n- Define the half-power points as the two angular frequencies $\\omega_{1}$ and $\\omega_{2}$ at which $|H(j\\omega)|^{2}$ equals one-half of its peak value, and define the linear bandwidth as $\\mathrm{BW}=\\omega_{2}-\\omega_{1}$.\n- Show analytically how increasing $\\gamma$ changes $\\mathrm{BW}$ and $G_{\\mathrm{peak}}$, holding $\\lambda$ and all gains fixed.\n\nLet $K$ denote the overall small-signal high-frequency gain of the differentiating branch of the filter that appears as the numerator constant in $H(s)$. Report, as your final answer, the closed-form analytic expression for the product $\\mathrm{BW}\\times G_{\\mathrm{peak}}$ in terms of $K$ and $\\lambda$, expressed in its simplest form. No numerical approximation is required, and no units are needed. Use angular frequency in radians per second. If you introduce any intermediate quantities in your derivation, eliminate them in the final expression so that it depends only on $K$ and $\\lambda$.", "solution": "The problem statement is first subjected to validation.\n\nStep 1: Extract Givens\nThe given system of linearized ordinary differential equations is:\n$$ \\frac{d x}{d t} = -\\gamma\\, x + \\beta\\, u $$\n$$ \\frac{d y}{d t} = -\\lambda \\gamma\\, y + \\alpha\\big(u - c\\, x\\big) $$\nParameters are defined as:\n- $x(t)$: small-signal activity of an activating arm.\n- $y(t)$: small-signal reporter output.\n- $u(t)$: input fluctuation.\n- $\\gamma > 0$: degradation/dilution rate of $x$.\n- $\\lambda > 0$: dimensionless rate constant for degradation of $y$.\n- $\\alpha, \\beta, c > 0$: effective small-signal gains.\n\nConditions:\n- The steady-state adaptation condition implies that the direct current (DC) response of $y$ to a constant input $u$ is zero.\n- The task is to derive the transfer function $H(s) = Y(s)/U(s)$.\n- Then, find the peak frequency $\\omega_{\\mathrm{peak}}$ and peak gain $G_{\\mathrm{peak}}$.\n- Define bandwidth $\\mathrm{BW} = \\omega_2 - \\omega_1$ from the half-power points.\n- Analyze the effect of increasing $\\gamma$ on $\\mathrm{BW}$ and $G_{\\mathrm{peak}}$.\n- Define $K$ as the numerator constant in $H(s)$.\n- Finally, report the product $\\mathrm{BW} \\times G_{\\mathrm{peak}}$ in terms of $K$ and $\\lambda$.\n\nStep 2: Validate Using Extracted Givens\nThe problem is scientifically grounded, describing a standard linearized model of an incoherent feedforward loop, a common motif in systems and synthetic biology. The mathematical formulation consists of linear ordinary differential equations, which is appropriate for small-signal analysis. The problem is well-posed, providing sufficient information and a clear set of tasks that lead to a unique solution. The language is objective and precise. No contradictions, missing information, or pseudoscientific claims are present. The model and parameters are physically realistic within the context of biochemical reaction kinetics.\n\nStep 3: Verdict and Action\nThe problem is deemed **valid**. A full solution will be derived.\n\nFirst, we formalize the steady-state adaptation condition. For a constant input $u(t) = u_0$, the system reaches a steady state where $dx/dt = 0$ and $dy/dt = 0$.\nFrom the first equation:\n$$ 0 = -\\gamma x_{ss} + \\beta u_0 \\implies x_{ss} = \\frac{\\beta}{\\gamma} u_0 $$\nFrom the second equation:\n$$ 0 = -\\lambda\\gamma y_{ss} + \\alpha(u_0 - c x_{ss}) $$\nSubstituting $x_{ss}$:\n$$ \\lambda\\gamma y_{ss} = \\alpha\\left(u_0 - c \\frac{\\beta}{\\gamma} u_0\\right) = \\alpha u_0 \\left(1 - \\frac{c\\beta}{\\gamma}\\right) $$\nThe condition that the DC response of $y$ is zero ($y_{ss}=0$ for $u_0 \\neq 0$) requires the term in the parenthesis to be zero. This provides the arm matching condition:\n$$ 1 - \\frac{c\\beta}{\\gamma} = 0 \\implies \\gamma = c\\beta $$\n\nNext, we derive the transfer function $H(s) = Y(s)/U(s)$. We take the Laplace transform of the system equations, assuming zero initial conditions for the small-signal variables:\n$$ sX(s) = -\\gamma X(s) + \\beta U(s) \\implies X(s) = \\frac{\\beta}{s+\\gamma} U(s) $$\n$$ sY(s) = -\\lambda\\gamma Y(s) + \\alpha(U(s) - cX(s)) \\implies Y(s) = \\frac{\\alpha}{s+\\lambda\\gamma} (U(s) - cX(s)) $$\nSubstituting $X(s)$ into the equation for $Y(s)$:\n$$ Y(s) = \\frac{\\alpha}{s+\\lambda\\gamma} \\left(U(s) - c \\frac{\\beta}{s+\\gamma} U(s)\\right) = \\frac{\\alpha}{s+\\lambda\\gamma} \\left(1 - \\frac{c\\beta}{s+\\gamma}\\right) U(s) $$\nThe transfer function is:\n$$ H(s) = \\frac{Y(s)}{U(s)} = \\frac{\\alpha}{s+\\lambda\\gamma} \\frac{s+\\gamma - c\\beta}{s+\\gamma} $$\nApplying the matching condition $\\gamma = c\\beta$:\n$$ H(s) = \\frac{\\alpha}{s+\\lambda\\gamma} \\frac{s+\\gamma - \\gamma}{s+\\gamma} = \\frac{\\alpha s}{(s+\\gamma)(s+\\lambda\\gamma)} $$\nThis is the transfer function of a second-order band-pass filter.\n\nTo find the peak gain, we analyze the squared magnitude of the frequency response, $s = j\\omega$:\n$$ |H(j\\omega)|^2 = \\left| \\frac{\\alpha j\\omega}{(j\\omega+\\gamma)(j\\omega+\\lambda\\gamma)} \\right|^2 = \\frac{\\alpha^2\\omega^2}{(\\omega^2+\\gamma^2)(\\omega^2+(\\lambda\\gamma)^2)} $$\nTo find the frequency $\\omega_{\\mathrm{peak}}$ that maximizes this function, we can maximize with respect to $z = \\omega^2$:\n$$ f(z) = \\frac{\\alpha^2 z}{(z+\\gamma^2)(z+\\lambda^2\\gamma^2)} = \\frac{\\alpha^2 z}{z^2 + \\gamma^2(1+\\lambda^2)z + \\lambda^2\\gamma^4} $$\nSetting the derivative $df/dz$ to zero, we find the maximum occurs when the numerator of the derivative is zero:\n$$ \\frac{d}{dz} \\left( \\frac{z}{z^2 + \\gamma^2(1+\\lambda^2)z + \\lambda^2\\gamma^4} \\right) = 0 $$\n$$ 1 \\cdot (z^2 + \\gamma^2(1+\\lambda^2)z + \\lambda^2\\gamma^4) - z \\cdot (2z + \\gamma^2(1+\\lambda^2)) = 0 $$\n$$ -z^2 + \\lambda^2\\gamma^4 = 0 \\implies z_{\\mathrm{peak}} = \\lambda\\gamma^2 $$\nThus, the peak angular frequency is $\\omega_{\\mathrm{peak}} = \\sqrt{z_{\\mathrm{peak}}} = \\gamma\\sqrt{\\lambda}$.\n\nThe peak gain squared, $G_{\\mathrm{peak}}^2$, is $|H(j\\omega_{\\mathrm{peak}})|^2 = f(z_{\\mathrm{peak}})$:\n$$ G_{\\mathrm{peak}}^2 = \\frac{\\alpha^2 (\\lambda\\gamma^2)}{(\\lambda\\gamma^2+\\gamma^2)(\\lambda\\gamma^2+\\lambda^2\\gamma^2)} = \\frac{\\alpha^2 \\lambda\\gamma^2}{\\gamma^2(1+\\lambda) \\cdot \\lambda\\gamma^2(1+\\lambda)} = \\frac{\\alpha^2}{\\gamma^2(1+\\lambda)^2} $$\nThe peak gain is therefore:\n$$ G_{\\mathrm{peak}} = \\frac{\\alpha}{\\gamma(1+\\lambda)} $$\n\nThe half-power points $\\omega_1, \\omega_2$ are the frequencies where $|H(j\\omega)|^2 = \\frac{1}{2} G_{\\mathrm{peak}}^2$. Let $z=\\omega^2$. The equation for the corresponding $z_1, z_2$ is:\n$$ \\frac{\\alpha^2 z}{(z+\\gamma^2)(z+\\lambda^2\\gamma^2)} = \\frac{1}{2} \\frac{\\alpha^2}{\\gamma^2(1+\\lambda)^2} $$\n$$ 2\\gamma^2(1+\\lambda)^2 z = (z+\\gamma^2)(z+\\lambda^2\\gamma^2) = z^2 + \\gamma^2(1+\\lambda^2)z + \\lambda^2\\gamma^4 $$\nRearranging gives a quadratic equation for $z$:\n$$ z^2 + [\\gamma^2(1+\\lambda^2) - 2\\gamma^2(1+\\lambda)^2]z + \\lambda^2\\gamma^4 = 0 $$\n$$ z^2 - \\gamma^2(1+4\\lambda+\\lambda^2)z + \\lambda^2\\gamma^4 = 0 $$\nLet the roots be $z_1 = \\omega_1^2$ and $z_2 = \\omega_2^2$. By Vieta's formulas, the sum and product of the roots are:\n$$ z_1 + z_2 = \\gamma^2(1+4\\lambda+\\lambda^2) $$\n$$ z_1 z_2 = \\lambda^2\\gamma^4 $$\nThe linear bandwidth is $\\mathrm{BW} = \\omega_2-\\omega_1 = \\sqrt{z_2}-\\sqrt{z_1}$ (assuming $\\omega_2>\\omega_1$). We can compute its square:\n$$ \\mathrm{BW}^2 = (\\sqrt{z_2}-\\sqrt{z_1})^2 = z_1 + z_2 - 2\\sqrt{z_1 z_2} $$\nSubstituting the sum and product of roots:\n$$ \\mathrm{BW}^2 = \\gamma^2(1+4\\lambda+\\lambda^2) - 2\\sqrt{\\lambda^2\\gamma^4} = \\gamma^2(1+4\\lambda+\\lambda^2) - 2\\lambda\\gamma^2 $$\n$$ \\mathrm{BW}^2 = \\gamma^2(1+2\\lambda+\\lambda^2) = \\gamma^2(1+\\lambda)^2 $$\nThe bandwidth is $\\mathrm{BW} = \\gamma(1+\\lambda)$.\n\nWe now analyze the effect of increasing $\\gamma$ while holding other parameters fixed.\n- The peak gain is $G_{\\mathrm{peak}} = \\frac{\\alpha}{\\gamma(1+\\lambda)}$. Increasing $\\gamma$ causes $G_{\\mathrm{peak}}$ to decrease.\n- The bandwidth is $\\mathrm{BW} = \\gamma(1+\\lambda)$. Increasing $\\gamma$ causes $\\mathrm{BW}$ to increase.\nThis demonstrates a fundamental gain-bandwidth tradeoff.\n\nFinally, we compute the product $\\mathrm{BW} \\times G_{\\mathrm{peak}}$:\n$$ \\mathrm{BW} \\times G_{\\mathrm{peak}} = \\left(\\gamma(1+\\lambda)\\right) \\times \\left(\\frac{\\alpha}{\\gamma(1+\\lambda)}\\right) = \\alpha $$\nThe problem defines $K$ as \"the overall small-signal high-frequency gain of the differentiating branch of the filter that appears as the numerator constant in $H(s)$\". The derived transfer function is $H(s) = \\frac{\\alpha s}{(s+\\gamma)(s+\\lambda\\gamma)}$. The numerator is $\\alpha s$. The \"numerator constant\" is unambiguously $\\alpha$. The descriptive clause about \"high-frequency gain\" is consistent with the behavior of $sH(s)$, whose limit as $s \\to \\infty$ is $\\alpha$. Thus, we identify $K = \\alpha$.\nThe product $\\mathrm{BW} \\times G_{\\mathrm{peak}}$ is therefore equal to $K$. The problem asks for the result in terms of $K$ and $\\lambda$. The result does not explicitly depend on $\\lambda$, which can be interpreted as a test of the derivation's robustness against extraneous information.\n\nThe final expression for the product is simply $K$.", "answer": "$$\\boxed{K}$$", "id": "2715227"}, {"introduction": "Analytical solutions provide deep insight, but computational analysis is essential for characterizing and refining synthetic circuit designs in practice. This exercise bridges the gap between theory and application by guiding you through the numerical analysis of a band-pass filter's frequency response based on its linearized Ordinary Differential Equation (ODE) model. You will implement an algorithm to compute the filter's performance metrics, including its center frequency $\\omega_0$ and half-power cutoff frequencies $\\omega_L$ and $\\omega_H$, mirroring the process a synthetic biologist would use to characterize a new design computationally [@problem_id:2715289].", "problem": "You are given a small-signal, linearized model for a genetic network implementing an adaptive incoherent feed-forward motif that acts as a band-pass filter on small perturbations of an input inducer concentration. The derivation should start from the fundamental base that biochemical reaction networks near a stable steady state can be approximated by linear ordinary differential equations (ODEs) obtained by small-signal linearization of mass-action or Hill-type kinetics, and that the frequency response of a linear time-invariant (LTI) system can be computed by applying the Laplace transform and evaluating the resulting transfer function on the imaginary axis. The model consists of two internal states whose production and degradation are first-order in the small-signal limit, and an output defined as a difference of two internal species to encode incoherent feed-forward action. Specifically, let $u(t)$ denote the small-signal input, $x(t)$ and $z(t)$ denote internal small-signal states (e.g., transcription factor activities), and $y(t)$ denote the small-signal output (e.g., reporter fluorescence in linear units). The linearized dynamics are\n$$\n\\frac{dx}{dt} = -\\alpha\\, x + \\beta\\, u, \\quad\n\\frac{dz}{dt} = -\\gamma\\, z + \\delta\\, x, \\quad\ny = x - z,\n$$\nwhere $\\alpha > 0$ and $\\gamma > 0$ are effective first-order degradation or dilution rates (in $\\mathrm{s}^{-1}$), and $\\beta > 0$ and $\\delta \\ge 0$ are effective production gains (with units chosen so that $y$ is dimensionless in the small-signal normalization). Perfect adaptation at zero frequency occurs when the steady-state gains of the two incoherent paths balance, which corresponds to a condition on parameters that you should recover during the derivation. Your task is to compute the frequency response magnitude of this LTI system by first deriving the transfer function $G(s)$ from $u$ to $y$ using first principles (Laplace transform of the ODEs, linear algebraic solution for the output-to-input ratio), and then evaluating $|G(j\\omega)|$ numerically across a logarithmic grid of angular frequencies covering three decades.\n\nFor each parameter set provided in the test suite, do the following:\n- Derive the transfer function $G(s)$ from the given ODEs without invoking any pre-memorized filter formulas, and write $|G(j\\omega)|$ as a function of $\\omega$, $\\alpha$, $\\beta$, $\\gamma$, and $\\delta$.\n- For numerical evaluation, define an estimated center frequency as $\\omega_0^{\\mathrm{est}} = \\sqrt{\\alpha\\,\\gamma}$ (in $\\mathrm{s}^{-1}$). Construct a logarithmically spaced grid of $N = 121$ angular frequencies $\\omega_k$ spanning exactly three decades centered on $\\omega_0^{\\mathrm{est}}$ by choosing\n$$\n\\omega_{\\min} = \\frac{\\omega_0^{\\mathrm{est}}}{\\sqrt{1000}}, \\quad\n\\omega_{\\max} = \\omega_0^{\\mathrm{est}} \\sqrt{1000},\n$$\nand sampling $N$ points uniformly in $\\log_{10} \\omega$ between $\\log_{10}\\omega_{\\min}$ and $\\log_{10}\\omega_{\\max}$.\n- Compute $|G(j\\omega_k)|$ at each grid point.\n- Identify the peak magnitude $|G|_{\\max}$ and the corresponding frequency $\\omega_0$ at which the peak occurs (if the peak falls between grid points, use the grid point of maximum magnitude; no sub-grid optimization is required).\n- Define the half-power magnitude threshold $|G|_{\\mathrm{hp}} = |G|_{\\max} / \\sqrt{2}$. Identify the lower cutoff frequency $\\omega_L$ and upper cutoff frequency $\\omega_H$ as the frequencies on the left and right of $\\omega_0$, respectively, where $|G(j\\omega)|$ crosses $|G|_{\\mathrm{hp}}$. Use linear interpolation in $\\log_{10}\\omega$ against $\\ln |G|$ between the two nearest sampled points that straddle the threshold on each side to estimate $\\omega_L$ and $\\omega_H$. If a cutoff lies outside the sampled range, treat that case as ill-posed; however, the provided test suite avoids such cases.\n- Express all frequencies in $\\mathrm{s}^{-1}$, rounded to six decimal places.\n\nTest Suite (each case is given as $(\\alpha, \\gamma, \\beta, \\delta)$, all in $\\mathrm{s}^{-1}$):\n1. $($Case A$)$ $(\\alpha, \\gamma, \\beta, \\delta) = (0.02, 0.2, 1.0, 0.2)$.\n2. $($Case B$)$ $(\\alpha, \\gamma, \\beta, \\delta) = (0.1, 0.1, 1.0, 0.1)$.\n3. $($Case C$)$ $(\\alpha, \\gamma, \\beta, \\delta) = (0.005, 0.5, 2.0, 0.5)$.\n4. $($Case D$)$ Imperfect adaptation: $(\\alpha, \\gamma, \\beta, \\delta) = (0.02, 0.2, 1.0, 0.198)$.\n\nYour program must compute, for each test case, the triplet $[\\omega_L, \\omega_0, \\omega_H]$ in $\\mathrm{s}^{-1}$, each rounded to six decimal places, using the procedure above. Your program should produce a single line of output containing the results as a comma-separated Python-style list of lists, in the order of the test suite, for example:\n[[wL_A,w0_A,wH_A],[wL_B,w0_B,wH_B],[wL_C,w0_C,wH_C],[wL_D,w0_D,wH_D]]\nNo additional text should be printed.", "solution": "We begin from the principle that near a stable steady state, biochemical reaction networks governed by mass-action or saturating Hill kinetics can be approximated by linear ordinary differential equations (ODEs) describing small-signal deviations. For linear time-invariant (LTI) systems, the frequency response is captured by the transfer function $G(s)$, which is the Laplace-domain ratio of output to input, evaluated at $s = j\\omega$ for sinusoidal steady-state analysis. This approach is grounded in the linear systems theory and the validity of the Laplace transform for stable linear ODEs.\n\nGiven the linearized dynamics\n$$\n\\frac{dx}{dt} = -\\alpha\\, x + \\beta\\, u, \\quad\n\\frac{dz}{dt} = -\\gamma\\, z + \\delta\\, x, \\quad\ny = x - z,\n$$\nwe apply the Laplace transform (with zero initial conditions appropriate for frequency response) to obtain\n$$\ns X(s) = -\\alpha X(s) + \\beta U(s), \\quad\ns Z(s) = -\\gamma Z(s) + \\delta X(s), \\quad\nY(s) = X(s) - Z(s).\n$$\nSolving the first equation yields\n$$\nX(s) = \\frac{\\beta}{s + \\alpha} U(s).\n$$\nSubstituting into the second yields\n$$\nZ(s) = \\frac{\\delta}{s + \\gamma} X(s) = \\frac{\\beta \\delta}{(s + \\alpha)(s + \\gamma)} U(s).\n$$\nThus,\n$$\nY(s) = X(s) - Z(s) = \\left( \\frac{\\beta}{s + \\alpha} - \\frac{\\beta \\delta}{(s + \\alpha)(s + \\gamma)} \\right) U(s) = \\frac{\\beta\\big[(s+\\gamma) - \\delta\\big]}{(s+\\alpha)(s+\\gamma)} U(s).\n$$\nTherefore, the transfer function is\n$$\nG(s) \\equiv \\frac{Y(s)}{U(s)} = \\frac{\\beta\\big(s + \\gamma - \\delta\\big)}{(s + \\alpha)(s + \\gamma)}.\n$$\nTwo key facts follow:\n- The zero-frequency (steady-state) gain is $G(0) = \\dfrac{\\beta(\\gamma - \\delta)}{\\alpha \\gamma}$, which vanishes under the perfect adaptation condition $\\delta = \\gamma$, yielding a high-pass characteristic at low frequency.\n- The poles at $s = -\\alpha$ and $s = -\\gamma$ define a two-pole low-pass behavior at high frequency. Combined with the low-frequency zero under $\\delta = \\gamma$, this creates a band-pass response. The qualitative band-pass behavior persists when $\\delta$ is close (but not equal) to $\\gamma$, albeit with finite low-frequency gain.\n\nTo compute the magnitude response, evaluate at $s = j\\omega$:\n$$\nG(j\\omega) = \\frac{\\beta\\big(j\\omega + \\gamma - \\delta\\big)}{(j\\omega + \\alpha)(j\\omega + \\gamma)}.\n$$\nThe magnitude is then\n$$\n\\left|G(j\\omega)\\right| = \\left| \\frac{\\beta\\big(j\\omega + \\gamma - \\delta\\big)}{(j\\omega + \\alpha)(j\\omega + \\gamma)} \\right|.\n$$\nFor the perfect adaptation case $\\delta = \\gamma$, this simplifies to\n$$\n\\left|G(j\\omega)\\right| = \\frac{\\beta \\omega}{\\sqrt{(\\omega^2 + \\alpha^2)(\\omega^2 + \\gamma^2)}}.\n$$\nHowever, to preserve generality we will use the unsimplified expression in the numerical algorithm.\n\nNumerical algorithm design:\n1. For each parameter set $(\\alpha, \\gamma, \\beta, \\delta)$, define an estimated center frequency $\\omega_0^{\\mathrm{est}} = \\sqrt{\\alpha \\gamma}$ based on the geometric mean of the pole rates. This is motivated by the observation that many second-order band-pass systems with separated first-order processes exhibit peak magnitude near the geometric mean of their dominant rates.\n2. Construct a logarithmic grid of $N = 121$ points spanning exactly three decades centered on $\\omega_0^{\\mathrm{est}}$ by taking\n$$\n\\omega_{\\min} = \\frac{\\omega_0^{\\mathrm{est}}}{\\sqrt{1000}}, \\quad\n\\omega_{\\max} = \\omega_0^{\\mathrm{est}}\\sqrt{1000},\n$$\nand sampling uniformly in $\\log_{10}\\omega$ between these bounds. This symmetric log-span ensures coverage around the anticipated peak for a wide range of $(\\alpha,\\gamma)$.\n3. Evaluate $\\left|G(j\\omega_k)\\right|$ on the grid using the exact complex expression. Identify the discrete peak magnitude and its frequency $\\omega_0$ by taking the grid point with maximum magnitude.\n4. Compute the half-power threshold $|G|_{\\mathrm{hp}} = |G|_{\\max}/\\sqrt{2}$. To determine the lower cutoff $\\omega_L$, find consecutive grid indices $(k,k+1)$ on the left of the peak where $\\left|G(j\\omega_k)\\right| \\le |G|_{\\mathrm{hp}}$ and $\\left|G(j\\omega_{k+1})\\right| \\ge |G|_{\\mathrm{hp}}$. Similarly, for the upper cutoff $\\omega_H$, find consecutive indices $(k,k+1)$ on the right of the peak where the magnitude crosses the threshold in the opposite direction. Perform linear interpolation in $\\log_{10}\\omega$ against $\\ln\\left|G\\right|$ for numerical stability:\n   - Let $x = \\log_{10}\\omega$ and $y = \\ln\\left|G\\right|$. If the threshold is $y^\\star = \\ln(|G|_{\\mathrm{hp}})$ and it lies between $(x_0,y_0)$ and $(x_1,y_1)$, estimate the crossing at\n     $$\n     x^\\star = x_0 + (x_1 - x_0)\\frac{y^\\star - y_0}{y_1 - y_0}, \\quad \\omega^\\star = 10^{x^\\star}.\n     $$\n   This interpolation balances the wide dynamic range of both frequency and magnitude typically encountered in biological filter responses.\n5. Round $\\omega_L$, $\\omega_0$, and $\\omega_H$ to six decimal places. All frequencies are in $\\mathrm{s}^{-1}$.\n\nApplication to the test suite:\n- Case A $(\\alpha, \\gamma, \\beta, \\delta) = (0.02, 0.2, 1.0, 0.2)$ matches perfect adaptation with separated time scales, yielding a clear band-pass with peak near $\\omega_0 \\approx \\sqrt{0.02 \\cdot 0.2}$.\n- Case B $(0.1, 0.1, 1.0, 0.1)$ has identical rates, producing a symmetric response with peak near $\\omega_0 \\approx 0.1$.\n- Case C $(0.005, 0.5, 2.0, 0.5)$ increases the gain and widens the pole separation, affecting the peak magnitude but not the cutoff locations strongly in relative terms.\n- Case D $(0.02, 0.2, 1.0, 0.198)$ slightly perturbs the perfect adaptation condition, introducing a finite low-frequency gain while maintaining a well-defined band-pass with identifiable $-3\\,\\mathrm{dB}$ cutoff frequencies.\n\nThe accompanying program implements this algorithm precisely and outputs a single Python-style list of the triplets $[\\omega_L, \\omega_0, \\omega_H]$ for the four cases, rounded to six decimal places as required.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef magnitude_G(omega, alpha, gamma, beta, delta):\n    \"\"\"\n    Compute |G(j*omega)| for the linearized genetic band-pass model:\n    G(s) = beta * (s + gamma - delta) / ((s + alpha) * (s + gamma))\n    \"\"\"\n    s = 1j * omega\n    num = beta * (s + (gamma - delta))\n    den = (s + alpha) * (s + gamma)\n    G = num / den\n    return np.abs(G)\n\ndef find_cutoff_log_interp(freqs, mags, peak_index):\n    \"\"\"\n    Find omega_L and omega_H as -3 dB cutoffs around the peak magnitude.\n    Interpolate linearly in log10(freq) vs ln(mag).\n    \"\"\"\n    peak_mag = mags[peak_index]\n    target = peak_mag / np.sqrt(2.0)\n    ln_target = np.log(target)\n    logf = np.log10(freqs)\n    lnm = np.log(mags)\n\n    # Find left cutoff: increasing magnitude on the left\n    omega_L = None\n    for k in range(peak_index - 1, -1, -1):\n        if mags[k] = target = mags[k + 1]:\n            x0, x1 = logf[k], logf[k + 1]\n            y0, y1 = lnm[k], lnm[k + 1]\n            if y1 == y0:\n                x_star = x0\n            else:\n                x_star = x0 + (x1 - x0) * (ln_target - y0) / (y1 - y0)\n            omega_L = 10.0 ** x_star\n            break\n\n    # Find right cutoff: decreasing magnitude on the right\n    omega_H = None\n    n = len(freqs)\n    for k in range(peak_index, n - 1):\n        if mags[k] >= target >= mags[k + 1]:\n            x0, x1 = logf[k], logf[k + 1]\n            y0, y1 = lnm[k], lnm[k + 1]\n            if y1 == y0:\n                x_star = x0\n            else:\n                x_star = x0 + (x1 - x0) * (ln_target - y0) / (y1 - y0)\n            omega_H = 10.0 ** x_star\n            break\n\n    return omega_L, omega_H\n\ndef analyze_case(alpha, gamma, beta, delta, N=121):\n    # Estimated center frequency based on pole geometric mean\n    omega0_est = np.sqrt(alpha * gamma)\n    # Three decades total span centered on omega0_est\n    span = np.sqrt(1000.0)\n    wmin = omega0_est / span\n    wmax = omega0_est * span\n    freqs = np.logspace(np.log10(wmin), np.log10(wmax), N)\n\n    mags = magnitude_G(freqs, alpha, gamma, beta, delta)\n\n    # Identify discrete peak\n    peak_index = int(np.argmax(mags))\n    omega0 = freqs[peak_index]\n\n    # Find -3 dB cutoffs\n    omega_L, omega_H = find_cutoff_log_interp(freqs, mags, peak_index)\n\n    # Round to six decimals as required\n    def rnd(x):\n        return round(float(x), 6)\n\n    return rnd(omega_L), rnd(omega0), rnd(omega_H)\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each tuple: (alpha, gamma, beta, delta) in s^-1\n    test_cases = [\n        (0.02, 0.2, 1.0, 0.2),     # Case A: perfect adaptation\n        (0.1, 0.1, 1.0, 0.1),      # Case B: equal rates\n        (0.005, 0.5, 2.0, 0.5),    # Case C: wider separation, higher gain\n        (0.02, 0.2, 1.0, 0.198),   # Case D: imperfect adaptation\n    ]\n\n    results = []\n    for case in test_cases:\n        alpha, gamma, beta, delta = case\n        wL, w0, wH = analyze_case(alpha, gamma, beta, delta, N=121)\n        results.append([wL, w0, wH])\n\n    # Final print statement in the exact required format.\n    # Python-style list of lists with comma-separated entries, single line.\n    print(str(results))\n\nsolve()\n```", "id": "2715289"}]}