{"hands_on_practices": [{"introduction": "The repressilator is a landmark synthetic circuit, and understanding its behavior is a cornerstone of the field. This practice will guide you through the fundamental process of linear stability analysis for this three-gene negative feedback loop. By linearizing the system and analyzing its eigenvalues, you will derive the precise conditions under which oscillations emerge via a Hopf bifurcation, directly linking biochemical parameters to system-level dynamics. [@problem_id:2781529]", "problem": "Consider a symmetric three-gene ring oscillator in which each gene represses the next one in sequence, with dynamics modeled at the coarse-grained protein level by ordinary differential equations (ODEs). Each node has basal first-order degradation and regulated production following a Hill-repression function derived from standard gene regulation phenomenology. Specifically, let $x_{1}(t)$, $x_{2}(t)$, and $x_{3}(t)$ denote the protein concentrations of the three nodes, and suppose\n$$\n\\frac{d x_{1}}{d t} \\;=\\; -\\gamma x_{1} \\;+\\; \\frac{\\alpha}{1 + \\left( \\frac{x_{3}}{K} \\right)^{n}},\\qquad\n\\frac{d x_{2}}{d t} \\;=\\; -\\gamma x_{2} \\;+\\; \\frac{\\alpha}{1 + \\left( \\frac{x_{1}}{K} \\right)^{n}},\\qquad\n\\frac{d x_{3}}{d t} \\;=\\; -\\gamma x_{3} \\;+\\; \\frac{\\alpha}{1 + \\left( \\frac{x_{2}}{K} \\right)^{n}},\n$$\nwhere $\\alpha>0$ is the maximal production rate, $\\gamma>0$ is the first-order degradation/dilution rate, $K>0$ is the dissociation constant, and $n>0$ is the Hill coefficient. Assume negligible transcriptional and translational delay so that this description is appropriate.\n\nA unique symmetric steady state exists with $x_{1}^{\\ast}=x_{2}^{\\ast}=x_{3}^{\\ast}=s$ satisfying $-\\gamma s + \\alpha/(1+(s/K)^{n})=0$. Starting from the fundamental modeling assumptions above and the definition of linearization, perform the following steps:\n\n- Linearize the system about the steady state $\\left(s,s,s\\right)$ and write down the Jacobian matrix.\n- Use first principles of linear systems and symmetry of the ring to analyze the eigenvalues of the Jacobian and derive an analytical condition for the onset of self-sustained oscillations via a Hopf bifurcation in terms of the steady-state repression slope $f'(s)$, where $f(x)=\\alpha/(1+(x/K)^{n})$.\n- Eliminate the steady-state $s$ using only the steady-state condition and the onset condition you derived to obtain a closed-form expression for the critical maximal production rate $\\alpha_{c}$ at which oscillations first emerge, expressed purely in terms of $\\gamma$, $K$, and $n$.\n\nAnswer specification:\n- Provide your final result as a single exact analytic expression for $\\alpha_{c}$ in terms of $\\gamma$, $K$, and $n$ only.\n- Do not include units in the boxed final answer. The parameter $\\alpha_{c}$ has units of concentration per time.", "solution": "The problem statement is scientifically grounded, well-posed, and objective. It presents a canonical model from synthetic biology, the repressilator, and asks for a standard stability analysis to find the condition for the onset of oscillations. All necessary information is provided, and the problem is free of contradictions or ambiguities. We shall therefore proceed with its solution.\n\nThe system of ordinary differential equations is given by:\n$$\n\\frac{d x_{1}}{d t} = -\\gamma x_{1} + f(x_{3})\n$$\n$$\n\\frac{d x_{2}}{d t} = -\\gamma x_{2} + f(x_{1})\n$$\n$$\n\\frac{d x_{3}}{d t} = -\\gamma x_{3} + f(x_{2})\n$$\nwhere $f(x) = \\frac{\\alpha}{1 + (x/K)^{n}}$. The system is to be analyzed at the symmetric steady state $\\mathbf{x}^{\\ast} = (s, s, s)$.\n\nFirst, we linearize the system about this steady state by computing the Jacobian matrix $J$. The elements of the Jacobian are $J_{ij} = \\frac{\\partial}{\\partial x_j} (\\frac{dx_i}{dt})$.\n$$\nJ =\n\\begin{pmatrix}\n\\frac{\\partial}{\\partial x_1}(-\\gamma x_1 + f(x_3)) & \\frac{\\partial}{\\partial x_2}(-\\gamma x_1 + f(x_3)) & \\frac{\\partial}{\\partial x_3}(-\\gamma x_1 + f(x_3)) \\\\\n\\frac{\\partial}{\\partial x_1}(-\\gamma x_2 + f(x_1)) & \\frac{\\partial}{\\partial x_2}(-\\gamma x_2 + f(x_1)) & \\frac{\\partial}{\\partial x_3}(-\\gamma x_2 + f(x_1)) \\\\\n\\frac{\\partial}{\\partial x_1}(-\\gamma x_3 + f(x_2)) & \\frac{\\partial}{\\partial x_2}(-\\gamma x_3 + f(x_2)) & \\frac{\\partial}{\\partial x_3}(-\\gamma x_3 + f(x_2))\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n-\\gamma & 0 & f'(x_3) \\\\\nf'(x_1) & -\\gamma & 0 \\\\\n0 & f'(x_2) & -\\gamma\n\\end{pmatrix}\n$$\nEvaluating the Jacobian at the steady state $\\mathbf{x}^{\\ast} = (s, s, s)$, we obtain:\n$$\nJ\\rvert_{\\mathbf{x}^{\\ast}} =\n\\begin{pmatrix}\n-\\gamma & 0 & f'(s) \\\\\nf'(s) & -\\gamma & 0 \\\\\n0 & f'(s) & -\\gamma\n\\end{pmatrix}\n$$\nFor notational simplicity, let $a = f'(s)$. The Jacobian is a circulant matrix:\n$$\nJ =\n\\begin{pmatrix}\n-\\gamma & 0 & a \\\\\na & -\\gamma & 0 \\\\\n0 & a & -\\gamma\n\\end{pmatrix}\n$$\nNext, we find the eigenvalues $\\lambda$ of $J$ by solving the characteristic equation $\\det(J - \\lambda I) = 0$:\n$$\n\\det \\begin{pmatrix} -\\gamma - \\lambda & 0 & a \\\\ a & -\\gamma - \\lambda & 0 \\\\ 0 & a & -\\gamma - \\lambda \\end{pmatrix} = 0\n$$\nExpanding the determinant gives:\n$$\n(-\\gamma - \\lambda)^{3} + a^{3} = 0 \\implies (\\gamma + \\lambda)^{3} = a^{3}\n$$\nThe roots of this equation are $\\gamma + \\lambda = a \\cdot \\omega^{k}$, where $\\omega = \\exp(i 2\\pi/3)$ is a primitive cube root of unity and $k \\in \\{0, 1, 2\\}$. The eigenvalues are therefore:\n$$\n\\lambda_k = a \\cdot \\omega^{k} - \\gamma\n$$\nExplicitly, the three eigenvalues are:\n$$\n\\lambda_0 = a \\cdot \\omega^{0} - \\gamma = a - \\gamma\n$$\n$$\n\\lambda_1 = a \\cdot \\omega^{1} - \\gamma = a \\left(-\\frac{1}{2} + i\\frac{\\sqrt{3}}{2}\\right) - \\gamma = \\left(-\\gamma - \\frac{a}{2}\\right) + i \\frac{a\\sqrt{3}}{2}\n$$\n$$\n\\lambda_2 = a \\cdot \\omega^{2} - \\gamma = a \\left(-\\frac{1}{2} - i\\frac{\\sqrt{3}}{2}\\right) - \\gamma = \\left(-\\gamma - \\frac{a}{2}\\right) - i \\frac{a\\sqrt{3}}{2}\n$$\nA Hopf bifurcation, which signifies the onset of self-sustained oscillations, occurs when a pair of complex conjugate eigenvalues crosses the imaginary axis. This requires their real part to become zero while their imaginary part remains non-zero. The complex eigenvalues are $\\lambda_1$ and $\\lambda_2$.\nThe condition on the real part is $\\text{Re}(\\lambda_{1,2}) = 0$:\n$$\n-\\gamma - \\frac{a}{2} = 0 \\implies a = -2\\gamma\n$$\nThe imaginary part is $\\text{Im}(\\lambda_{1}) = \\frac{a\\sqrt{3}}{2}$. Since $\\gamma > 0$, $a = -2\\gamma$ is non-zero, meaning the imaginary part is non-zero at the bifurcation. Also, the repression function $f(x)$ is monotonically decreasing, so its derivative $a = f'(s)$ must be negative, which is consistent with the condition $a = -2\\gamma$.\nThe real eigenvalue at this point is $\\lambda_0 = a - \\gamma = -2\\gamma - \\gamma = -3\\gamma$, which is strictly negative. Thus, the stability change is governed solely by the complex pair crossing the imaginary axis, confirming a Hopf bifurcation.\n\nWe now have two conditions at the bifurcation point:\n1. Bifurcation condition: $f'(s) = -2\\gamma$.\n2. Steady-state condition: $\\gamma s = f(s)$. At the critical point, this is $\\gamma s = \\frac{\\alpha_c}{1 + (s/K)^{n}}$.\n\nLet us calculate the derivative $f'(s)$:\n$$\nf'(x) = \\frac{d}{dx} \\left[ \\alpha \\left(1 + \\left(\\frac{x}{K}\\right)^n\\right)^{-1} \\right] = -\\alpha \\left(1 + \\left(\\frac{x}{K}\\right)^n\\right)^{-2} \\cdot n \\left(\\frac{x}{K}\\right)^{n-1} \\cdot \\frac{1}{K}\n$$\n$$\nf'(s) = -\\frac{\\alpha_c n}{K} \\frac{(s/K)^{n-1}}{(1 + (s/K)^{n})^2}\n$$\nNow we use the two conditions to eliminate $s$ and solve for $\\alpha_c$:\n$$\n-2\\gamma = -\\frac{\\alpha_c n}{K} \\frac{(s/K)^{n-1}}{(1 + (s/K)^{n})^2} \\implies 2\\gamma = \\frac{\\alpha_c n}{K} \\frac{(s/K)^{n-1}}{(1 + (s/K)^{n})^2}\n$$\nFrom the steady-state condition, we have $\\alpha_c = \\gamma s (1 + (s/K)^{n})$. Substituting this into the equation above:\n$$\n2\\gamma = \\frac{[\\gamma s (1 + (s/K)^{n})] n}{K} \\frac{(s/K)^{n-1}}{(1 + (s/K)^{n})^2}\n$$\nWe can cancel $\\gamma$ (since $\\gamma > 0$):\n$$\n2 = \\frac{s n}{K} \\frac{(s/K)^{n-1}}{1 + (s/K)^{n}} = \\frac{n (s/K)^n}{1 + (s/K)^{n}}\n$$\nLet $u = (s/K)^n$. The equation becomes:\n$$\n2 = \\frac{nu}{1+u} \\implies 2(1+u) = nu \\implies 2 + 2u = nu \\implies 2 = u(n-2)\n$$\nSolving for $u$:\n$$\nu = \\left(\\frac{s}{K}\\right)^n = \\frac{2}{n-2}\n$$\nFor a positive steady state $s$, we require $u > 0$, which implies the well-known condition for oscillations in this system: $n > 2$.\nFrom this, we find the steady-state value at the bifurcation point:\n$$\ns = K \\left(\\frac{2}{n-2}\\right)^{1/n}\n$$\nFinally, we substitute the expressions for $s$ and $(s/K)^n$ back into the steady-state equation to find the critical production rate $\\alpha_c$:\n$$\n\\alpha_c = \\gamma s \\left(1 + \\left(\\frac{s}{K}\\right)^n\\right)\n$$\nWe have $1 + (s/K)^n = 1 + \\frac{2}{n-2} = \\frac{n-2+2}{n-2} = \\frac{n}{n-2}$.\n$$\n\\alpha_c = \\gamma \\left[ K \\left(\\frac{2}{n-2}\\right)^{1/n} \\right] \\left[ \\frac{n}{n-2} \\right]\n$$\nThis simplifies to the final closed-form expression for $\\alpha_c$ in terms of the given parameters:\n$$\n\\alpha_c = \\frac{\\gamma K n}{n-2} \\left(\\frac{2}{n-2}\\right)^{1/n}\n$$\nThis is the threshold value of the maximal production rate above which the steady state becomes unstable and self-sustained oscillations emerge.", "answer": "$$\\boxed{\\frac{\\gamma K n}{n-2} \\left(\\frac{2}{n-2}\\right)^{1/n}}$$", "id": "2781529"}, {"introduction": "Beyond the simple onset of oscillations, synthetic circuits can exhibit far richer dynamics, such as birhythmicity, where a stable quiescent state coexists with a stable oscillatory one. This exercise delves into this phenomenon by analyzing a universal model known as a normal form equation, which describes the behavior near a subcritical Hopf bifurcation. This analysis will allow you to map the parameter space for this complex behavior and connect the theory to tangible experimental signatures like population bimodality and stochastic switching. [@problem_id:2781540]", "problem": "A minimal two-gene synthetic oscillator with coupled feedback loops is constructed as follows: protein $A$ transcriptionally activates its own promoter (fast positive feedback) and also activates transcription of protein $R$; protein $R$ represses transcription of $A$ (delayed negative feedback through slower $R$ accumulation). Deterministic dynamics for the concentrations $a(t)$ and $r(t)$ can be written as ordinary differential equations (ODEs) with monotone Hill-type production and first-order degradation, and exhibit an equilibrium $(a^{\\ast}, r^{\\ast})$ that can undergo an oscillatory instability when the net loop gain crosses a threshold. Close to this oscillatory onset, center manifold reduction and normal-form theory for a generalized Hopf (also called Bautin) bifurcation imply that the slow-time amplitude $r(t)$ of the dominant oscillatory mode obeys, after nondimensionalization and phase decoupling, the quintic amplitude equation\n$$\n\\frac{dr}{dt} \\;=\\; r\\left(\\mu \\;+\\; \\beta\\, r^{2} \\;-\\; r^{4}\\right),\n$$\nwhere $r \\ge 0$ measures oscillation amplitude of a reporter linked to $a(t)$, the parameter $\\mu \\in \\mathbb{R}$ is the signed distance from the Hopf bifurcation (controlled experimentally by an inducer that tunes the effective transcriptional gain), and $\\beta \\in \\mathbb{R}$ is the cubic nonlinearity coefficient determined by the combined shapes of the activation and repression Hill nonlinearities and molecular saturation. The quintic coefficient has been scaled to $+1$ by nondimensionalization, consistent with bounded protein synthesis capacity. In a regime of interest for hard excitation of oscillations in coupled feedback architectures, experimental system identification yields $\\beta > 0$.\n\nUsing only the amplitude equation above and standard stability analysis, determine the parameter conditions on $\\mu$ and $\\beta$ under which a stable fixed point at $r=0$ coexists with a stable nonzero limit cycle (birhythmicity in the sense of coexistence of a quiescent state and a sustained oscillatory state). Then, compute the width $\\Delta \\mu$ of the birhythmicity window in $\\mu$ as a closed-form analytic expression in terms of $\\beta$. Report your final answer as this width $\\Delta \\mu$.\n\nFinally, based on first principles of noisy single-cell dynamics, briefly explain two experimentally observable signatures in single-cell time-lapse traces that would be consistent with such birhythmicity in this system. Your explanation should be qualitative; do not include it in your final numerical or symbolic answer. No numerical evaluation is required; provide $\\Delta \\mu$ in exact analytic form without rounding and without units.", "solution": "It is imperative to first rectify an inconsistency within the problem statement. The provided amplitude equation is\n$$\n\\frac{dr}{dt} = r\\left(\\mu + \\beta r^{2} - r^{4}\\right)\n$$\nUpon expansion, the right-hand side is a quintic polynomial $\\mu r + \\beta r^{3} - r^{5}$. The coefficient of the highest-order term, $r^{5}$, is unambiguously $-1$. The problem text, however, erroneously claims that \"The quintic coefficient has been scaled to $+1$\". This is a direct contradiction. The physical argument of \"bounded protein synthesis capacity\" necessitates a stabilizing nonlinear term that limits unbounded growth, which is correctly represented by the $-r^{4}$ term in the parenthesis in the dynamical equation. We will therefore proceed by analyzing the provided differential equation, which is well-posed and physically motivated, and dismiss the conflicting textual description as a careless error.\n\nThe problem requires finding the conditions for birhythmicity, defined as the coexistence of a stable quiescent state and a stable oscillatory state. In the context of the given one-dimensional amplitude equation for $r(t) \\ge 0$, this corresponds to the coexistence of a stable fixed point at $r=0$ and a stable fixed point at some $r > 0$.\n\nFixed points, or equilibria, $r^{\\ast}$, of the system are found by setting $\\frac{dr}{dt}=0$:\n$$\nr^{\\ast}\\left(\\mu + \\beta (r^{\\ast})^{2} - (r^{\\ast})^{4}\\right) = 0\n$$\nThis equation yields two possibilities for the fixed points.\n\n1. The quiescent state: $r^{\\ast}_{0} = 0$. This fixed point always exists.\n\n2. The oscillatory states: For $r^{\\ast} > 0$, the fixed points are the real, positive roots of the polynomial in the parenthesis:\n$$\n(r^{\\ast})^{4} - \\beta (r^{\\ast})^{2} - \\mu = 0\n$$\nLet $x = (r^{\\ast})^{2}$. Since $r^{\\ast} > 0$, we require $x > 0$. The equation becomes a quadratic in $x$:\n$$\nx^{2} - \\beta x - \\mu = 0\n$$\nUsing the quadratic formula, the solutions for $x$ are:\n$$\nx_{\\pm} = \\frac{\\beta \\pm \\sqrt{\\beta^{2} + 4\\mu}}{2}\n$$\nFor real solutions for $x$ to exist, the discriminant must be non-negative: $\\beta^{2} + 4\\mu \\ge 0$, which implies $\\mu \\ge -\\frac{\\beta^{2}}{4}$. Since $\\beta > 0$ is given, the root $x_{+} = \\frac{\\beta + \\sqrt{\\beta^{2} + 4\\mu}}{2}$ is always positive when it is real ($\\mu \\ge -\\frac{\\beta^{2}}{4}$). The other root, $x_{-} = \\frac{\\beta - \\sqrt{\\beta^{2} + 4\\mu}}{2}$, is positive only if $\\beta > \\sqrt{\\beta^{2} + 4\\mu}$, which simplifies to $\\mu < 0$. Thus, for $-\\frac{\\beta^{2}}{4} \\le \\mu < 0$, there are two distinct positive roots for $x$, giving rise to two non-zero fixed points for $r$. For $\\mu \\ge 0$, only one positive root $x_{+}$ exists.\n\nNext, we perform a linear stability analysis to determine the stability of these fixed points. Let $f(r) = \\mu r + \\beta r^{3} - r^{5}$. A fixed point $r^{\\ast}$ is stable if $f'(r^{\\ast}) < 0$ and unstable if $f'(r^{\\ast}) > 0$. The derivative is:\n$$\nf'(r) = \\frac{d}{dr}f(r) = \\mu + 3\\beta r^{2} - 5r^{4}\n$$\n- Stability of $r^{\\ast}_{0} = 0$:\nThe stability is determined by $f'(0) = \\mu$. The quiescent state $r^{\\ast}_{0} = 0$ is stable if $\\mu < 0$ and unstable if $\\mu > 0$.\n\n- Stability of non-zero fixed points $r^{\\ast} > 0$:\nFor such a fixed point, it satisfies $\\mu = (r^{\\ast})^{4} - \\beta(r^{\\ast})^{2}$. Substituting this into the expression for $f'(r^{\\ast})$:\n$$\nf'(r^{\\ast}) = \\left((r^{\\ast})^{4} - \\beta(r^{\\ast})^{2}\\right) + 3\\beta(r^{\\ast})^{2} - 5(r^{\\ast})^{4} = 2\\beta(r^{\\ast})^{2} - 4(r^{\\ast})^{4} = 2(r^{\\ast})^{2}(\\beta - 2(r^{\\ast})^{2})\n$$\nSince $2(r^{\\ast})^{2} > 0$, the sign of $f'(r^{\\ast})$ is determined by the sign of $(\\beta - 2(r^{\\ast})^{2})$. The fixed point is stable if $(r^{\\ast})^{2} > \\frac{\\beta}{2}$ and unstable if $(r^{\\ast})^{2} < \\frac{\\beta}{2}$.\n\nLet us analyze the stability of the fixed points corresponding to $x_{\\pm} = (r^{\\ast})^{2}_{\\pm}$.\nThe fixed point corresponding to $x_{+} = \\frac{\\beta + \\sqrt{\\beta^{2} + 4\\mu}}{2}$ is stable if $x_{+} > \\frac{\\beta}{2}$:\n$$\n\\frac{\\beta + \\sqrt{\\beta^{2} + 4\\mu}}{2} > \\frac{\\beta}{2} \\implies \\sqrt{\\beta^{2} + 4\\mu} > 0\n$$\nThis is true for all $\\mu > -\\frac{\\beta^{2}}{4}$. Thus, the larger-amplitude oscillatory state is always stable when it exists and is distinct from the other branch.\nThe fixed point corresponding to $x_{-} = \\frac{\\beta - \\sqrt{\\beta^{2} + 4\\mu}}{2}$ is stable if $x_{-} > \\frac{\\beta}{2}$:\n$$\n\\frac{\\beta - \\sqrt{\\beta^{2} + 4\\mu}}{2} > \\frac{\\beta}{2} \\implies -\\sqrt{\\beta^{2} + 4\\mu} > 0\n$$\nThis is never true. Thus, the smaller-amplitude oscillatory state is always unstable.\n\nBirhythmicity requires the coexistence of a stable fixed point at $r=0$ and a stable non-zero fixed point. The conditions for this are:\n1. $r^{\\ast}_{0} = 0$ is stable $\\implies \\mu < 0$.\n2. A stable positive fixed point exists. This is the one corresponding to $x_{+}$, which requires $\\mu > -\\frac{\\beta^{2}}{4}$ for its existence and stability.\n\nCombining these two conditions, the parameter region for birhythmicity is:\n$$\n-\\frac{\\beta^{2}}{4} < \\mu < 0\n$$\nThis interval defines the birhythmicity window. The lower bound, $\\mu = -\\frac{\\beta^{2}}{4}$, corresponds to a saddle-node bifurcation where the stable and unstable limit cycles are born. The upper bound, $\\mu = 0$, corresponds to the subcritical Hopf bifurcation point where the unstable limit cycle collides with the quiescent state, rendering it unstable.\n\nThe width of this birhythmicity window, $\\Delta\\mu$, is the difference between the upper and lower bounds of this interval:\n$$\n\\Delta\\mu = (0) - \\left(-\\frac{\\beta^{2}}{4}\\right) = \\frac{\\beta^{2}}{4}\n$$\nThis is the required analytical expression.\n\nFinally, based on first principles of noisy single-cell dynamics, two experimentally observable signatures of such birhythmicity in time-lapse microscopy data are:\n1.  **Population Bimodality**: A population of isogenic cells, cultured under fixed conditions within the birhythmic parameter window ($-\\beta^{2}/4 < \\mu < 0$), will partition into two distinct subpopulations. One subpopulation will remain in the quiescent state (low, stable reporter signal), while the other will exhibit sustained, large-amplitude oscillations (high, periodically fluctuating reporter signal). A histogram of reporter intensities across the population at any given time would therefore be bimodal.\n2.  **Stochastic, All-or-None Switching**: Individual cells, when tracked over long periods, can exhibit spontaneous, discrete switching between the quiescent and oscillatory states. Due to inherent molecular noise, a cell in the quiescent state can be stochastically \"kicked\" across the separatrix (the unstable limit cycle), triggering an abrupt transition into the stable oscillatory state. This is an all-or-none phenomenon, not a gradual increase in oscillation amplitude, and is a key feature of systems with hard excitation enabled by a subcritical bifurcation. The reverse transition is also possible, though may occur at a different rate.", "answer": "$$ \\boxed{\\frac{\\beta^{2}}{4}} $$", "id": "2781540"}, {"introduction": "While analytical methods provide deep insight, the complexity of many real-world synthetic circuits often necessitates computational investigation. This practice moves from pen-and-paper analysis to hands-on programming, challenging you to implement a numerical protocol to explore the behavior of a complex oscillator with coupled feedback loops. You will translate abstract dynamical concepts like steady states, limit cycles, and bistability into a concrete algorithm to classify system behavior, a core skill in modern computational systems biology. [@problem_id:2781485]", "problem": "A coupled-loop genetic oscillator can be modeled by two gene products, an activator and a repressor, whose concentrations evolve according to ordinary differential equations (ODEs (Ordinary Differential Equations)). Starting from mass balance and transcriptional regulation with Hill-type nonlinearities (a well-tested empirical description), consider the following dimensionless model for the activator concentration $x(t)$ and the repressor concentration $y(t)$:\n$$\n\\frac{dx}{dt} \\;=\\; k_x\\left[\\alpha_0 + \\alpha\\,\\frac{x^n}{K_x^n + x^n}\\right]\\cdot\\frac{1}{1 + R\\left(\\frac{y}{K_y}\\right)^m} \\;-\\; d_x\\,x,\n$$\n$$\n\\frac{dy}{dt} \\;=\\; k_y\\,\\frac{x^p}{K_{xy}^p + x^p} \\;-\\; d_y\\,y.\n$$\nThe first right-hand side captures a positive feedback loop (activator auto-activation, with Hill coefficient $n$) multiplied by a negative feedback loop (repression by $y$, with Hill coefficient $m$ and tunable strength $R$). The second right-hand side captures activation of the repressor by $x$ with cooperativity $p$. The parameters are all nonnegative. Fix the parameters\n- $n = 3$, $m = 2$, $p = 2$,\n- $K_x = 1$, $K_y = 1$, $K_{xy} = 1$,\n- $k_x = 1$, $k_y = 1$,\n- $d_x = 1$, $d_y = 0.2$,\n- $\\alpha_0 = 0.01$,\nand treat $(\\alpha, R)$ as the two control parameters.\n\nYour task is to write a complete, runnable program that, for a given set of $(\\alpha, R)$ pairs, determines whether the long-term dynamics are steady state (single attractor fixed point), sustained oscillations (limit cycle), or bistability (two distinct stable fixed points reached from different initial conditions). You must implement the classification using only numerical simulation and signal analysis, starting from the above ODEs and the following definitions grounded in dynamical systems:\n\n- A trajectory is considered steady if, after transients, both $x(t)$ and $y(t)$ fluctuate with small relative amplitude and the instantaneous derivatives are small in norm.\n- A trajectory is considered oscillatory if, after transients, it exhibits sustained, non-decaying oscillations with sufficiently large relative amplitude and multiple peaks.\n- A parameter pair $(\\alpha, R)$ is considered bistable if two different initial conditions both yield non-oscillatory trajectories that approach distinct steady levels.\n\nImplement the following concrete numerical protocol, which defines the classification precisely:\n- For each $(\\alpha, R)$, integrate the ODEs from two initial conditions $z_1(0) = (x_0^{(1)}, y_0^{(1)}) = (10^{-2}, 10^{-2})$ and $z_2(0) = (x_0^{(2)}, y_0^{(2)}) = (5, 5)$ over the time interval $t \\in [0, T]$ with $T = 300$. Sample the solution at $N = 4000$ uniformly spaced times in that interval.\n- Discard the first $60$ percent of each time series as transient. Over the remaining $40$ percent:\n  - Let $\\bar{x}$ be the mean of $x(t)$, and define the relative amplitude $A_x = \\frac{\\max(x) - \\min(x)}{\\max(10^{-8}, \\bar{x})}$; define $A_y$ analogously for $y(t)$.\n  - Count the number of local maxima in $x(t)$ (peaks): a sample $x_i$ is a peak if $x_{i-1} < x_i > x_{i+1}$.\n  - A single trajectory is classified as oscillatory if $A_x \\ge 0.15$ and the number of peaks in the analysis window is at least $3$.\n  - A single trajectory is classified as steady if $A_x < 0.05$ and $A_y < 0.05$ and $\\left\\|\\left.\\frac{d}{dt}(x,y)\\right|_{t=T}\\right\\|_2 < 10^{-5}$.\n- Combine the two initial-condition results for the final classification at $(\\alpha, R)$:\n  - If both trajectories are steady and their final segment means differ by at least $0.2$ in either $x$ or $y$, classify as bistable.\n  - Else if at least one trajectory is oscillatory, classify as oscillatory.\n  - Else classify as steady.\n\nTo connect to bifurcation theory, interpret the regions of steady state, oscillations, and bistability as separated by curves where local stability changes via canonical bifurcations. In particular, in the $(\\alpha,R)$-plane, boundaries where a unique stable equilibrium gives way to oscillations are expected to be associated with a Hopf bifurcation, and boundaries where one stable equilibrium becomes two are associated with a saddle-node bifurcation. Points in the plane where such bifurcation curves meet are codimension-$2$ points, which in two-dimensional systems can include Bogdanovâ€“Takens points when appropriate nondegeneracy conditions hold.\n\nImplement the model and the above classification protocol, and apply it to the following test suite of $(\\alpha, R)$ pairs:\n- $(\\alpha, R) = (1.5, 2)$,\n- $(\\alpha, R) = (3.5, 20)$,\n- $(\\alpha, R) = (7.0, 1.0)$,\n- $(\\alpha, R) = (5.0, 30)$,\n- $(\\alpha, R) = (8.0, 0.2)$.\n\nThe required output for each test case is an integer code:\n- $0$ for steady state,\n- $1$ for oscillatory,\n- $2$ for bistable.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (for example, $[0,1,2,1,2]$). No physical units are used; all quantities are dimensionless. Angles are not involved. All numerical thresholds and constants in this problem are exact and must be implemented as stated.", "solution": "The problem presented is a computational task requiring the classification of dynamical behaviors for a given system of ordinary differential equations (ODEs), which model a synthetic genetic oscillator. The problem statement is valid, as it is scientifically grounded, well-posed, completely specified, and objective. It provides a precise numerical protocol for this classification, which must be implemented without deviation. My task is to execute this protocol. I will not engage in theoretical speculation beyond what is required for the implementation.\n\nThe model describes the time evolution of the concentrations of an activator protein, $x(t)$, and a repressor protein, $y(t)$. The dynamics are given by the following system of dimensionless ODEs:\n$$\n\\frac{dx}{dt} \\;=\\; k_x\\left[\\alpha_0 + \\alpha\\,\\frac{x^n}{K_x^n + x^n}\\right]\\cdot\\frac{1}{1 + R\\left(\\frac{y}{K_y}\\right)^m} \\;-\\; d_x\\,x,\n$$\n$$\n\\frac{dy}{dt} \\;=\\; k_y\\,\\frac{x^p}{K_{xy}^p + x^p} \\;-\\; d_y\\,y.\n$$\nThe problem provides a set of fixed parameters: Hill coefficients $n=3$, $m=2$, $p=2$; dissociation constants $K_x=1$, $K_y=1$, $K_{xy}=1$; synthesis rates $k_x=1$, $k_y=1$; degradation rates $d_x=1$, $d_y=0.2$; and a basal activator expression rate $\\alpha_0=0.01$. The parameters $(\\alpha, R)$ are control parameters to be varied.\n\nThe core of the task is to implement a classification algorithm based on numerical integration. For each given pair of control parameters $(\\alpha, R)$, we perform the following steps:\n\n1.  **Numerical Integration**: We solve the system of ODEs over the time interval $t \\in [0, T]$ where $T=300$. We must generate solutions at $N=4000$ uniformly spaced time points. This procedure is performed twice for each $(\\alpha, R)$ pair, starting from two distinct initial conditions: $z_1(0) = (x_0^{(1)}, y_0^{(1)}) = (10^{-2}, 10^{-2})$ and $z_2(0) = (x_0^{(2)}, y_0^{(2)}) = (5, 5)$. This requires a numerical ODE solver, for which the `solve_ivp` function from the SciPy library is appropriate.\n\n2.  **Trajectory Analysis**: For each of the two computed trajectories, we analyze its long-term behavior. The protocol dictates that the first $60\\%$ of the time series data is discarded as transient. The analysis is performed on the final $40\\%$ of the data, from $t=180$ to $t=300$.\n    Within this analysis window, we compute several metrics for each trajectory:\n    - The mean concentrations, $\\bar{x}$ and $\\bar{y}$.\n    - The relative amplitudes of oscillation, defined as $A_x = \\frac{\\max(x) - \\min(x)}{\\max(10^{-8}, \\bar{x})}$ and $A_y = \\frac{\\max(y) - \\min(y)}{\\max(10^{-8}, \\bar{y})}$. The denominator is regularized to prevent division by zero.\n    - The number of local maxima (peaks) in the $x(t)$ time series. A point $x_i$ at time $t_i$ is a peak if its value is greater than its immediate neighbors, i.e., $x_{i-1} < x_i > x_{i+1}$.\n    - The Euclidean norm of the vector of time derivatives, $\\left\\|\\frac{d}{dt}(x,y)\\right\\|_2$, evaluated at the final time point $t=T=300$.\n\n3.  **Individual Trajectory Classification**: Based on these metrics, each individual trajectory is provisionally classified.\n    - A trajectory is considered **oscillatory** if its relative amplitude $A_x$ is at least $0.15$ and the number of peaks in the analysis window of $x(t)$ is at least $3$.\n    - A trajectory is considered **steady** if $A_x < 0.05$, $A_y < 0.05$, and the norm of the final time derivative is less than $10^{-5}$.\n    Note that a trajectory may be classified as neither oscillatory nor steady if it does not meet these strict criteria.\n\n4.  **Final System Classification**: The final classification for the parameter pair $(\\alpha, R)$ is determined by combining the results from the two initial conditions according to the following ordered logic:\n    - The system is classified as **bistable** (code $2$) if both trajectories are classified as steady, and the mean values of their analysis windows differ significantly. The condition for significant difference is $|\\bar{x}_1 - \\bar{x}_2| \\ge 0.2$ or $|\\bar{y}_1 - \\bar{y}_2| \\ge 0.2$.\n    - If the condition for bistability is not met, the system is classified as **oscillatory** (code $1$) if at least one of the two trajectories is classified as oscillatory.\n    - Otherwise, the system is classified as **steady** (code $0$).\n\nThis rigorous, multi-step protocol translates the qualitative concepts of \"steady state\", \"oscillation\", and \"bistability\" into a concrete, deterministic algorithm. The implementation will follow this procedure precisely for each of the specified test cases.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Solves the synthetic oscillator classification problem by implementing the\n    specified numerical protocol.\n    \"\"\"\n\n    # --- Fixed model parameters ---\n    n = 3.0\n    m = 2.0\n    p = 2.0\n    K_x = 1.0\n    K_y = 1.0\n    K_xy = 1.0\n    k_x = 1.0\n    k_y = 1.0\n    d_x = 1.0\n    d_y = 0.2\n    alpha_0 = 0.01\n\n    def ode_system(t, z, alpha, R):\n        \"\"\"\n        Defines the system of ordinary differential equations for the synthetic oscillator.\n        z = [x, y], where x is activator and y is repressor concentration.\n        \"\"\"\n        x, y = z\n        \n        # Avoid division by zero or negative concentrations, though solver should handle it\n        x = max(0, x)\n        y = max(0, y)\n\n        # Activator equation\n        positive_feedback = alpha * (x**n) / (K_x**n + x**n)\n        repression = 1.0 / (1.0 + R * (y / K_y)**m)\n        dxdt = k_x * (alpha_0 + positive_feedback) * repression - d_x * x\n\n        # Repressor equation\n        activation_of_repressor = k_y * (x**p) / (K_xy**p + x**p)\n        dydt = activation_of_repressor - d_y * y\n\n        return [dxdt, dydt]\n\n    def analyze_trajectory(t, z, alpha, R):\n        \"\"\"\n        Analyzes a single trajectory according to the problem's protocol.\n        \"\"\"\n        x, y = z\n        N = len(t)\n        \n        # Define the analysis window (last 40% of the data)\n        analysis_start_index = int(0.6 * N)\n        x_analysis = x[analysis_start_index:]\n        y_analysis = y[analysis_start_index:]\n        \n        # --- Calculate metrics for classification ---\n\n        # 1. Relative amplitudes\n        mean_x = np.mean(x_analysis)\n        mean_y = np.mean(y_analysis)\n        \n        # Denominator regularized as per problem statement\n        ax_denom = np.max([1e-8, mean_x])\n        ay_denom = np.max([1e-8, mean_y])\n        \n        A_x = (np.max(x_analysis) - np.min(x_analysis)) / ax_denom\n        A_y = (np.max(y_analysis) - np.min(y_analysis)) / ay_denom\n        \n        # 2. Number of peaks in x(t)\n        # A peak is x_i where x_{i-1} < x_i > x_{i+1}\n        peaks = np.sum((x_analysis[1:-1] > x_analysis[:-2]) & (x_analysis[1:-1] > x_analysis[2:]))\n\n        # 3. Norm of the derivative at the final time point\n        z_final = z[:, -1]\n        dzdt_final = ode_system(t[-1], z_final, alpha, R)\n        norm_deriv = np.linalg.norm(dzdt_final)\n        \n        # --- Classify the single trajectory ---\n        is_oscillatory = (A_x >= 0.15 and peaks >= 3)\n        is_steady = (A_x < 0.05 and A_y < 0.05 and norm_deriv < 1e-5)\n        \n        return is_oscillatory, is_steady, mean_x, mean_y\n\n    # --- Simulation setup ---\n    T = 300.0\n    N = 4000\n    t_span = [0, T]\n    t_eval = np.linspace(t_span[0], t_span[1], N)\n    \n    # Initial conditions\n    z0_1 = [1e-2, 1e-2]\n    z0_2 = [5.0, 5.0]\n\n    # Test cases from the problem statement\n    test_cases = [\n        (1.5, 2),\n        (3.5, 20),\n        (7.0, 1.0),\n        (5.0, 30),\n        (8.0, 0.2),\n    ]\n\n    results = []\n\n    # --- Main loop to process each test case ---\n    for alpha, R in test_cases:\n        # --- Run simulation for initial condition 1 ---\n        sol1 = solve_ivp(\n            fun=lambda t, z: ode_system(t, z, alpha, R),\n            t_span=t_span,\n            y0=z0_1,\n            t_eval=t_eval,\n            method='RK45', \n            rtol=1e-6, \n            atol=1e-9\n        )\n        is_osc1, is_steady1, mean_x1, mean_y1 = analyze_trajectory(sol1.t, sol1.y, alpha, R)\n\n        # --- Run simulation for initial condition 2 ---\n        sol2 = solve_ivp(\n            fun=lambda t, z: ode_system(t, z, alpha, R),\n            t_span=t_span,\n            y0=z0_2,\n            t_eval=t_eval,\n            method='RK45',\n            rtol=1e-6,\n            atol=1e-9\n        )\n        is_osc2, is_steady2, mean_x2, mean_y2 = analyze_trajectory(sol2.t, sol2.y, alpha, R)\n        \n        # --- Final classification based on the two trajectories ---\n        # The logic follows the if-elif-else structure specified in the problem.\n        \n        # Condition for bistability: both steady and means are different.\n        means_are_different = (abs(mean_x1 - mean_x2) >= 0.2 or abs(mean_y1 - mean_y2) >= 0.2)\n        \n        if is_steady1 and is_steady2 and means_are_different:\n            # Code 2 for bistable\n            result = 2\n        elif is_osc1 or is_osc2:\n            # Code 1 for oscillatory\n            result = 1\n        else:\n            # Code 0 for steady state\n            result = 0\n            \n        results.append(result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2781485"}]}