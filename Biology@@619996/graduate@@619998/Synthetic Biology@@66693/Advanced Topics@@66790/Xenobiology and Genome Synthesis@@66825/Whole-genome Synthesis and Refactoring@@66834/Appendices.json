{"hands_on_practices": [{"introduction": "At its core, whole-genome refactoring is an exercise in multi-objective optimization at the sequence level. This practice simulates a common scenario where a genetic sequence must satisfy several overlapping constraints simultaneously. By tackling the challenge of eliminating a prohibited motif from an overlapping coding region while preserving the amino acid sequences of both encoded proteins, you will gain direct experience with the logic of constraint satisfaction in gene design, a fundamental skill for any synthetic biologist [@problem_id:2787320].", "problem": "In whole-genome synthesis and refactoring, sequence engineering often requires removing prohibited motifs (for example, the *Escherichia coli* restriction endonuclease I (EcoRI) recognition site) while preserving encoded proteins, even across overlapping reading frames. Consider a $7$-nucleotide genomic window with two overlapping genes, one read in the zero frame and one read in the $+1$ frame. Let the nucleotide sequence be $S = s_{1}s_{2}s_{3}s_{4}s_{5}s_{6}s_{7} = \\mathrm{A}\\mathrm{G}\\mathrm{A}\\mathrm{A}\\mathrm{T}\\mathrm{T}\\mathrm{C}$. The following coding relationships hold by the Central Dogma and the standard genetic code:\n\n- Zero frame (frame $0$): codon $s_{1}s_{2}s_{3}$ encodes arginine, and codon $s_{4}s_{5}s_{6}$ encodes isoleucine.\n- Plus-one frame (frame $+1$): codon $s_{2}s_{3}s_{4}$ encodes glutamate, and codon $s_{5}s_{6}s_{7}$ encodes phenylalanine.\n\nUse the standard genetic code degeneracy:\n- Arginine (Arg): $\\{\\mathrm{C}\\mathrm{G}\\mathrm{T}, \\mathrm{C}\\mathrm{G}\\mathrm{C}, \\mathrm{C}\\mathrm{G}\\mathrm{A}, \\mathrm{C}\\mathrm{G}\\mathrm{G}, \\mathrm{A}\\mathrm{G}\\mathrm{A}, \\mathrm{A}\\mathrm{G}\\mathrm{G}\\}$.\n- Isoleucine (Ile): $\\{\\mathrm{A}\\mathrm{T}\\mathrm{T}, \\mathrm{A}\\mathrm{T}\\mathrm{C}, \\mathrm{A}\\mathrm{T}\\mathrm{A}\\}$.\n- Glutamate (Glu): $\\{\\mathrm{G}\\mathrm{A}\\mathrm{A}, \\mathrm{G}\\mathrm{A}\\mathrm{G}\\}$.\n- Phenylalanine (Phe): $\\{\\mathrm{T}\\mathrm{T}\\mathrm{T}, \\mathrm{T}\\mathrm{T}\\mathrm{C}\\}$.\n\nA prohibited motif, the EcoRI site $\\mathrm{G}\\mathrm{A}\\mathrm{A}\\mathrm{T}\\mathrm{T}\\mathrm{C}$, currently spans positions $2$ through $7$ of $S$. You are tasked with modeling the synonymous recoding of $S$ as a constraint satisfaction problem in which each position $s_{i}$ is a variable over $\\{\\mathrm{A}, \\mathrm{C}, \\mathrm{G}, \\mathrm{T}\\}$ subject to:\n- Preservation of both protein sequences (the zero-frame amino acids remain arginine and isoleucine at $s_{1}s_{2}s_{3}$ and $s_{4}s_{5}s_{6}$, respectively; the $+1$-frame amino acids remain glutamate and phenylalanine at $s_{2}s_{3}s_{4}$ and $s_{5}s_{6}s_{7}$, respectively).\n- Elimination of the EcoRI site across $s_{2}\\dots s_{7}$.\n\nAssume that recoding is allowed only within this $7$-nucleotide window, and fix $s_{1}$ to its original value to avoid extraneous degrees of freedom. Define $m$ as the minimal number of nucleotide substitutions within positions $2$ through $7$ required to eliminate the motif while satisfying all coding constraints, and let $N(m)$ be the number of distinct sequences within this window that achieve exactly $m$ substitutions and satisfy all constraints. Compute $N(m)$. Provide your answer as a single integer with no units. No rounding is required.", "solution": "The problem presented is a well-posed constraint satisfaction problem grounded in the principles of molecular biology and gene synthesis. It is internally consistent, scientifically sound, and contains all necessary information for a unique solution. Therefore, the problem is valid, and a full solution will be provided.\n\nThe objective is to find the number of distinct sequences, $N(m)$, that can be formed by recoding a $7$-nucleotide window $S = s_{1}s_{2}s_{3}s_{4}s_{5}s_{6}s_{7} = \\mathrm{A}\\mathrm{G}\\mathrm{A}\\mathrm{A}\\mathrm{T}\\mathrm{T}\\mathrm{C}$. This recoding must satisfy a set of constraints, and $m$ represents the minimal number of nucleotide substitutions within positions $2$ through $7$ required to do so.\n\nLet the new sequence be denoted by $S' = s'_{1}s'_{2}s'_{3}s'_{4}s'_{5}s'_{6}s'_{7}$. The constraints are as follows:\n\n1.  The first nucleotide is fixed: $s'_{1} = \\mathrm{A}$.\n2.  The protein sequence in frame $0$ is preserved:\n    -   Codon $s'_{1}s'_{2}s'_{3}$ must encode Arginine (Arg). The set of synonymous codons for Arg is $\\{\\mathrm{C}\\mathrm{G}\\mathrm{T}, \\mathrm{C}\\mathrm{G}\\mathrm{C}, \\mathrm{C}\\mathrm{G}\\mathrm{A}, \\mathrm{C}\\mathrm{G}\\mathrm{G}, \\mathrm{A}\\mathrm{G}\\mathrm{A}, \\mathrm{A}\\mathrm{G}\\mathrm{G}\\}$.\n    -   Codon $s'_{4}s'_{5}s'_{6}$ must encode Isoleucine (Ile). The set of synonymous codons for Ile is $\\{\\mathrm{A}\\mathrm{T}\\mathrm{T}, \\mathrm{A}\\mathrm{T}\\mathrm{C}, \\mathrm{A}\\mathrm{T}\\mathrm{A}\\}$.\n3.  The protein sequence in frame $+1$ is preserved:\n    -   Codon $s'_{2}s'_{3}s'_{4}$ must encode Glutamate (Glu). The set of synonymous codons for Glu is $\\{\\mathrm{G}\\mathrm{A}\\mathrm{A}, \\mathrm{G}\\mathrm{A}\\mathrm{G}\\}$.\n    -   Codon $s'_{5}s'_{6}s'_{7}$ must encode Phenylalanine (Phe). The set of synonymous codons for Phe is $\\{\\mathrm{T}\\mathrm{T}\\mathrm{T}, \\mathrm{T}\\mathrm{T}\\mathrm{C}\\}$.\n4.  The EcoRI restriction site is eliminated: The subsequence $s'_{2}s'_{3}s'_{4}s'_{5}s'_{6}s'_{7}$ cannot be $\\mathrm{G}\\mathrm{A}\\mathrm{A}\\mathrm{T}\\mathrm{T}\\mathrm{C}$.\n\nWe will systematically resolve these constraints.\n\nFirst, consider the codon $s'_{1}s'_{2}s'_{3}$ for Arg. Since $s'_{1}$ is fixed as $\\mathrm{A}$, we filter the set of Arg codons for those beginning with $\\mathrm{A}$. This leaves us with $\\{\\mathrm{A}\\mathrm{G}\\mathrm{A}, \\mathrm{A}\\mathrm{G}\\mathrm{G}\\}$. This implies that $s'_{2}$ must be $\\mathrm{G}$ and $s'_{3}$ must be in the set $\\{\\mathrm{A}, \\mathrm{G}\\}$.\n\nNext, we incorporate the constraint on the overlapping codon $s'_{2}s'_{3}s'_{4}$ for Glu, for which the choices are $\\{\\mathrm{G}\\mathrm{A}\\mathrm{A}, \\mathrm{G}\\mathrm{A}\\mathrm{G}\\}$.\n-   If we hypothesize $s'_{2}s'_{3} = \\mathrm{G}\\mathrm{A}$, then the Glu codon is $\\mathrm{G}\\mathrm{A}s'_{4}$. For this to be a valid Glu codon, $s'_{4}$ must be in $\\{\\mathrm{A}, \\mathrm{G}\\}$. This is a consistent possibility.\n-   If we hypothesize $s'_{2}s'_{3} = \\mathrm{G}\\mathrm{G}$, the Glu codon would be $\\mathrm{G}\\mathrm{G}s'_{4}$. This cannot match either of the valid Glu codons, $\\{\\mathrm{G}\\mathrm{A}\\mathrm{A}, \\mathrm{G}\\mathrm{A}\\mathrm{G}\\}$. This hypothesis is therefore invalid.\nSo, we must have $s'_{2} = \\mathrm{G}$ and $s'_{3} = \\mathrm{A}$. This also implies that $s'_{4} \\in \\{\\mathrm{A}, \\mathrm{G}\\}$.\n\nNow, we analyze the codon $s'_{4}s'_{5}s'_{6}$ for Ile. The synonymous codons are $\\{\\mathrm{A}\\mathrm{T}\\mathrm{T}, \\mathrm{A}\\mathrm{T}\\mathrm{C}, \\mathrm{A}\\mathrm{T}\\mathrm{A}\\}$. All of these codons begin with the nucleotide $\\mathrm{A}$. Therefore, $s'_{4}$ must be $\\mathrm{A}$.\nCombining this with our finding from the previous step ($s'_{4} \\in \\{\\mathrm{A}, \\mathrm{G}\\}$), the only viable nucleotide for position $4$ is $s'_{4} = \\mathrm{A}$.\n\nSo far, we have determined that the first four nucleotides are unchangeable: $s'_{1}s'_{2}s'_{3}s'_{4} = \\mathrm{A}\\mathrm{G}\\mathrm{A}\\mathrm{A}$.\n\nWith $s'_{4} = \\mathrm{A}$, the constraint on the Ile codon $s'_{4}s'_{5}s'_{6}$ becomes $\\mathrm{A}s'_{5}s'_{6} \\in \\{\\mathrm{A}\\mathrm{T}\\mathrm{T}, \\mathrm{A}\\mathrm{T}\\mathrm{C}, \\mathrm{A}\\mathrm{T}\\mathrm{A}\\}$. This requires $s'_{5} = \\mathrm{T}$ and $s'_{6} \\in \\{\\mathrm{T}, \\mathrm{C}, \\mathrm{A}\\}$.\n\nNext, we examine the final overlapping codon $s'_{5}s'_{6}s'_{7}$ for Phe. The permissible codons are $\\{\\mathrm{T}\\mathrm{T}\\mathrm{T}, \\mathrm{T}\\mathrm{T}\\mathrm{C}\\}$. This requires that the first two nucleotides of the codon, $s'_{5}s'_{6}$, must be $\\mathrm{T}\\mathrm{T}$.\nCombining this with the constraint from the Ile codon ($s'_{5} = \\mathrm{T}$ and $s'_{6} \\in \\{\\mathrm{T}, \\mathrm{C}, \\mathrm{A}\\}$), we find that we must have $s'_{5} = \\mathrm{T}$ and $s'_{6} = \\mathrm{T}$.\n\nWith $s'_{5}s'_{6} = \\mathrm{T}\\mathrm{T}$, the Phe codon constraint $s'_{5}s'_{6}s'_{7} = \\mathrm{T}\\mathrm{T}s'_{7} \\in \\{\\mathrm{T}\\mathrm{T}\\mathrm{T}, \\mathrm{T}\\mathrm{T}\\mathrm{C}\\}$ implies that $s'_{7}$ must be in the set $\\{\\mathrm{T}, \\mathrm{C}\\}$.\n\nIn summary, after satisfying all coding constraints (constraints $1$, $2$, and $3$), the set of possible sequences is reduced to two:\n-   Sequence $S'_{A}$: $\\mathrm{A}\\mathrm{G}\\mathrm{A}\\mathrm{A}\\mathrm{T}\\mathrm{T}\\mathrm{T}$\n-   Sequence $S'_{B}$: $\\mathrm{A}\\mathrm{G}\\mathrm{A}\\mathrm{A}\\mathrm{T}\\mathrm{T}\\mathrm{C}$\n\nFinally, we apply the fourth constraint: elimination of the EcoRI site. The prohibited subsequence $s'_{2}s'_{3}s'_{4}s'_{5}s'_{6}s'_{7}$ is $\\mathrm{G}\\mathrm{A}\\mathrm{A}\\mathrm{T}\\mathrm{T}\\mathrm{C}$.\n-   For sequence $S'_{A}$, the subsequence from position $2$ to $7$ is $\\mathrm{G}\\mathrm{A}\\mathrm{A}\\mathrm{T}\\mathrm{T}\\mathrm{T}$. This is not the prohibited site. Thus, $S'_{A}$ is a valid solution.\n-   For sequence $S'_{B}$, the subsequence is $\\mathrm{G}\\mathrm{A}\\mathrm{A}\\mathrm{T}\\mathrm{T}\\mathrm{C}$. This is precisely the prohibited site. Thus, $S'_{B}$ is invalid.\n\nThis leaves us with only one sequence that satisfies all constraints: $S'_{\\text{valid}} = \\mathrm{A}\\mathrm{G}\\mathrm{A}\\mathrm{A}\\mathrm{T}\\mathrm{T}\\mathrm{T}$.\n\nThe problem asks for $N(m)$, where $m$ is the minimal number of substitutions in positions $2$ through $7$.\nThe original subsequence is $s_{2}s_{3}s_{4}s_{5}s_{6}s_{7} = \\mathrm{G}\\mathrm{A}\\mathrm{A}\\mathrm{T}\\mathrm{T}\\mathrm{C}$.\nThe only valid recoded subsequence is $s'_{2}s'_{3}s'_{4}s'_{5}s'_{6}s'_{7} = \\mathrm{G}\\mathrm{A}\\mathrm{A}\\mathrm{T}\\mathrm{T}\\mathrm{T}$.\nComparing these two subsequences, we see a single substitution at position $7$ (from $\\mathrm{C}$ to $\\mathrm{T}$). The number of substitutions is $1$.\nSince there is only one valid solution, the number of substitutions required is by definition minimal. Thus, $m = 1$.\nThe number of distinct sequences that achieve exactly $m=1$ substitutions is the number of valid solutions we found. We found only one.\nTherefore, $N(m) = N(1) = 1$.", "answer": "$$\\boxed{1}$$", "id": "2787320"}, {"introduction": "Once a sequence is designed, predicting its functional output is the next critical step. This exercise introduces the Ribosome Flow Model (RFM), a powerful biophysical framework for understanding how codon choice dictates the dynamics of translation. You will derive a closed-form expression for protein production rate, seeing firsthand how tools from statistical physics can transform discrete sequence information into continuous, quantitative predictions about gene expression levels [@problem_id:2787291].", "problem": "A central goal of whole-genome synthesis and refactoring is to systematically redesign coding sequences to control translation dynamics *in vivo*. Consider a single messenger ribonucleic acid (mRNA) open reading frame that has been refactored to concentrate its codon-dependent slowdown into one dominant bottleneck segment, followed by a fast termination step. Model translation on this mRNA as a one-dimensional exclusion process at the mean-field level, also known as the Ribosome Flow Model (RFM), which is a coarse-grained limit of the Totally Asymmetric Simple Exclusion Process (TASEP). Let there be two coarse-grained sites representing the codon-dependent bottleneck and the terminal site, respectively. Let the ribosome initiation rate be $\\alpha$, the codon-dependent elongation (hopping) rate across the internal bottleneck site be $\\lambda_{1}$, and the exit (termination) rate be $\\lambda_{2}$. Assume all rates are positive constants and that ribosomes obey hard exclusion: a ribosome can only move forward if the next site is empty.\n\nDefine $x_{1}(t)$ and $x_{2}(t)$ as the mean occupancies of the first and second coarse-grained sites at time $t$, with $x_{i}(t) \\in [0,1]$. Starting only from the following fundamental bases:\n- The Central Dogma of molecular biology (deoxyribonucleic acid to ribonucleic acid to protein) and the physical principle of steric exclusion of ribosomes on mRNA.\n- The mean-field approximation of TASEP, in which the probability of a hop equals the product of the occupancy of the source and the vacancy of the target times the corresponding rate constant.\n- Conservation of flux at steady state, where the production (protein output) equals the steady exit flux.\n\nFirst, derive the coupled mean-field dynamics for $x_{1}(t)$ and $x_{2}(t)$ implied by these principles. Then, by imposing steady state, eliminate $x_{1}$ and $x_{2}$ to obtain a closed-form analytical expression for the steady-state protein output $J(\\alpha)$, defined as the steady exit flux, as an explicit function of $\\alpha$, $\\lambda_{1}$, and $\\lambda_{2}$. Your expression must be a single closed-form formula that is valid for all positive $\\alpha$, $\\lambda_{1}$, and $\\lambda_{2}$, and it must correspond to the physically admissible branch that satisfies $J(\\alpha) \\to 0$ as $\\alpha \\to 0$ and $J(\\alpha) \\leq \\min\\{\\alpha,\\lambda_{2}\\}$.\n\nProvide only the final closed-form expression for $J(\\alpha)$ as your answer. Do not substitute numerical values, and do not include units in your final expression. If you perform any approximations, they must be justified from first principles; however, the requested final answer must be the exact, closed-form expression.", "solution": "The problem requires the derivation of a closed-form analytical expression for the steady-state protein output, denoted by the flux $J(\\alpha)$, for a two-site Ribosome Flow Model (RFM). The derivation must proceed from the fundamental principles provided.\n\nLet $x_1(t)$ and $x_2(t)$ be the mean occupancies of the first (bottleneck) and second (terminal) coarse-grained sites, respectively. The rates are the initiation rate $\\alpha$, the hopping rate between sites $\\lambda_1$, and the termination rate $\\lambda_2$. Ribosomes obey hard steric exclusion.\n\nWe apply the mean-field approximation for the Totally Asymmetric Simple Exclusion Process (TASEP), where the flux between sites is proportional to the occupancy of the source site and the vacancy of the target site.\n\nThe rate of change of occupancy for each site, $\\frac{dx_i}{dt}$, is the difference between the total inflow rate and the total outflow rate for that site.\n\nFor the first site, the inflow is from ribosome initiation onto a vacant site, given by the flux $J_{in} = \\alpha (1 - x_1(t))$. The outflow is the hopping of ribosomes to the second site, which requires the first site to be occupied and the second site to be vacant. This flux is $J_{1 \\to 2} = \\lambda_1 x_1(t) (1 - x_2(t))$. The dynamical equation for $x_1(t)$ is thus:\n$$ \\frac{dx_1(t)}{dt} = \\alpha (1 - x_1(t)) - \\lambda_1 x_1(t) (1 - x_2(t)) $$\n\nFor the second site, the inflow is the hopping from the first site, $J_{1 \\to 2} = \\lambda_1 x_1(t) (1 - x_2(t))$. The outflow is the termination process, which requires the second site to be occupied. The \"target\" site for termination can be considered permanently vacant. This flux is $J_{out} = \\lambda_2 x_2(t)$. The dynamical equation for $x_2(t)$ is:\n$$ \\frac{dx_2(t)}{dt} = \\lambda_1 x_1(t) (1 - x_2(t)) - \\lambda_2 x_2(t) $$\n\nAt steady state, the occupancies are constant, so $\\frac{dx_1}{dt} = 0$ and $\\frac{dx_2}{dt} = 0$. Let $x_1^*$ and $x_2^*$ denote the steady-state occupancies. The system of equations becomes:\n$$ \\alpha (1 - x_1^*) = \\lambda_1 x_1^* (1 - x_2^*) $$\n$$ \\lambda_1 x_1^* (1 - x_2^*) = \\lambda_2 x_2^* $$\n\nThe principle of conservation of flux at steady state dictates that all fluxes are equal. We define this steady-state flux as the protein output $J$.\n$$ J = \\alpha (1 - x_1^*) = \\lambda_1 x_1^* (1 - x_2^*) = \\lambda_2 x_2^* $$\n\nOur task is to find an expression for $J$ in terms of $\\alpha$, $\\lambda_1$, and $\\lambda_2$. We can express the steady-state occupancies $x_1^*$ and $x_2^*$ in terms of $J$:\nFrom $J = \\alpha (1 - x_1^*)$, we solve for $x_1^*$:\n$$ x_1^* = 1 - \\frac{J}{\\alpha} $$\nFrom $J = \\lambda_2 x_2^*$, we solve for $x_2^*$:\n$$ x_2^* = \\frac{J}{\\lambda_2} $$\nFor these occupancies to be physically meaningful, they must be in the interval $[0,1]$, which implies $0 \\le J \\le \\alpha$ and $0 \\le J \\le \\lambda_2$.\n\nNow, we substitute these expressions for $x_1^*$ and $x_2^*$ into the middle flux equation, $J = \\lambda_1 x_1^* (1 - x_2^*)$:\n$$ J = \\lambda_1 \\left(1 - \\frac{J}{\\alpha}\\right) \\left(1 - \\frac{J}{\\lambda_2}\\right) $$\nThis is the governing equation for the steady-state flux $J$. We must solve it.\n$$ J = \\lambda_1 \\left(\\frac{\\alpha - J}{\\alpha}\\right) \\left(\\frac{\\lambda_2 - J}{\\lambda_2}\\right) $$\nMultiplying both sides by $\\alpha \\lambda_2$ to clear the denominators gives:\n$$ J \\alpha \\lambda_2 = \\lambda_1 (\\alpha - J)(\\lambda_2 - J) $$\n$$ J \\alpha \\lambda_2 = \\lambda_1 (\\alpha \\lambda_2 - \\alpha J - \\lambda_2 J + J^2) $$\nRearranging the terms yields a quadratic equation for $J$ in the standard form $aJ^2 + bJ + c = 0$:\n$$ \\lambda_1 J^2 - (\\alpha \\lambda_1 + \\lambda_1 \\lambda_2 + \\alpha \\lambda_2) J + \\alpha \\lambda_1 \\lambda_2 = 0 $$\n\nWe solve this equation using the quadratic formula $J = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}$, where:\n$a = \\lambda_1$\n$b = -(\\alpha \\lambda_1 + \\lambda_1 \\lambda_2 + \\alpha \\lambda_2)$\n$c = \\alpha \\lambda_1 \\lambda_2$\n\nThe solution is:\n$$ J = \\frac{(\\alpha \\lambda_1 + \\lambda_1 \\lambda_2 + \\alpha \\lambda_2) \\pm \\sqrt{(\\alpha \\lambda_1 + \\lambda_1 \\lambda_2 + \\alpha \\lambda_2)^2 - 4(\\lambda_1)(\\alpha \\lambda_1 \\lambda_2)}}{2 \\lambda_1} $$\n$$ J = \\frac{(\\alpha \\lambda_1 + \\lambda_1 \\lambda_2 + \\alpha \\lambda_2) \\pm \\sqrt{(\\alpha \\lambda_1 + \\lambda_1 \\lambda_2 + \\alpha \\lambda_2)^2 - 4 \\alpha \\lambda_1^2 \\lambda_2}}{2 \\lambda_1} $$\n\nThe problem specifies that we must choose the physically admissible branch that satisfies the condition $J(\\alpha) \\to 0$ as $\\alpha \\to 0$. Let us examine the two solutions in this limit. As $\\alpha \\to 0$:\n- The term $(\\alpha \\lambda_1 + \\lambda_1 \\lambda_2 + \\alpha \\lambda_2)$ approaches $\\lambda_1 \\lambda_2$.\n- The discriminant $(\\alpha \\lambda_1 + \\lambda_1 \\lambda_2 + \\alpha \\lambda_2)^2 - 4 \\alpha \\lambda_1^2 \\lambda_2$ approaches $(\\lambda_1 \\lambda_2)^2$.\n- The square root of the discriminant approaches $\\lambda_1 \\lambda_2$.\n\nThe two solutions for $J$ thus approach:\n$J_+ \\to \\frac{\\lambda_1 \\lambda_2 + \\lambda_1 \\lambda_2}{2 \\lambda_1} = \\frac{2 \\lambda_1 \\lambda_2}{2 \\lambda_1} = \\lambda_2$\n$J_- \\to \\frac{\\lambda_1 \\lambda_2 - \\lambda_1 \\lambda_2}{2 \\lambda_1} = 0$\n\nTo satisfy the condition $J(\\alpha) \\to 0$ as $\\alpha \\to 0$, we must select the solution with the minus sign. Therefore, the single, closed-form expression for the steady-state protein output is:\n$$ J(\\alpha) = \\frac{\\alpha \\lambda_1 + \\lambda_1 \\lambda_2 + \\alpha \\lambda_2 - \\sqrt{(\\alpha \\lambda_1 + \\lambda_1 \\lambda_2 + \\alpha \\lambda_2)^2 - 4 \\alpha \\lambda_1^2 \\lambda_2}}{2 \\lambda_1} $$\nThis expression is valid for all positive $\\alpha, \\lambda_1, \\lambda_2$ and satisfies the given physical constraints.", "answer": "$$ \\boxed{\\frac{\\alpha \\lambda_{1} + \\lambda_{1} \\lambda_{2} + \\alpha \\lambda_{2} - \\sqrt{(\\alpha \\lambda_{1} + \\lambda_{1} \\lambda_{2} + \\alpha \\lambda_{2})^{2} - 4 \\alpha \\lambda_{1}^{2} \\lambda_{2}}}{2 \\lambda_{1}}} $$", "id": "2787291"}, {"introduction": "A key motivation for refactoring entire genomes is to enhance their long-term stability by removing features that promote evolutionary decay. This problem addresses one such feature: repetitive DNA sequences, which are hotspots for deletion via homologous recombination. By building a probabilistic model from first principles, you will learn to quantify the risk of genome instability as a function of repeat length and homology, illustrating how design principles can be used to engineer more robust and reliable genetic systems [@problem_id:2787367].", "problem": "A synthetic bacterial genome is being refactored to eliminate recombination-mediated deletions by reducing homologous repeats. Consider two direct repeats of length $L$ base pairs (bp), $L \\ge m$, flanking a spacer segment. After codon recoding, the fractional identity (homology) between the two repeats is $h \\in (0,1]$, and base matches across the alignment are independent with probability $h$. Assume the following foundational facts about homologous recombination:\n\n1. Homologous recombination requires the existence of at least one contiguous perfect match (a Minimal Efficient Processing Segment (MEPS)) of length at least $m$ base pairs to nucleate strand exchange. Treat each of the $N = L - m + 1$ possible length-$m$ windows within a repeat as independent with respect to being a perfect match.\n\n2. After nucleation at a perfect match, heteroduplex extension proceeds across the remaining aligned sequence and can be aborted by DNA mismatch repair (MMR). Model this as follows: at each base, a mismatch occurs independently with probability $d = 1 - h$, and each mismatch independently aborts the recombination with probability $\\epsilon \\in (0,1)$. If no abort occurs across the $L$ bases, the recombination survives MMR scrutiny.\n\n3. Conditioned on (i) the presence of at least one MEPS of length $m$ and (ii) survival of MMR during strand exchange across the $L$ base pairs, the pair of repeats yields a deletogenic resolution with a baseline per-generation rate constant $k$ that absorbs all spacer contact and downstream resolution kinetics at the fixed spacer length considered.\n\nUnder these assumptions, derive a closed-form analytic expression for the per-cell, per-generation rate $R(L,h)$ of deletion events between the repeats as a function of $L$ and $h$, and parameters $m$, $\\epsilon$, and $k$. Express your final answer as a single exact expression in terms of $L$, $h$, $m$, $\\epsilon$, and $k$; no numerical evaluation is required and no units should be included in the final boxed expression.", "solution": "The problem requires the derivation of the per-cell, per-generation rate of deletion events, designated as $R(L,h)$, between two direct repeats. The derivation must be based on the provided probabilistic model of homologous recombination.\n\nThe overall deletion rate $R(L,h)$ is determined by a baseline rate constant $k$, which is realized only if two conditions are met:\n1. Nucleation of strand exchange, which requires the presence of at least one Minimal Efficient Processing Segment (MEPS). Let $A$ be the event that at least one MEPS of length $m$ exists within the repeats of length $L$.\n2. Survival of the extending heteroduplex from abortion by the DNA Mismatch Repair (MMR) system. Let $B$ be the event that the recombination process survives MMR scrutiny across the entire length $L$.\n\nAccording to the problem statement, the deletion occurs with rate $k$ conditioned on the joint occurrence of events $A$ and $B$. Therefore, the overall rate $R(L,h)$ can be expressed as:\n$$R(L,h) = k \\cdot P(A \\cap B)$$\nThe problem's structure, particularly the highly simplifying and physically unrealistic assumption that all possible MEPS windows are independent, suggests that the two main stochastic processes—nucleation and MMR survival—are to be treated as independent events. This is a common modeling simplification for complex, multi-stage biological processes. Under this interpretation, the joint probability $P(A \\cap B)$ is the product of the individual probabilities $P(A)$ and $P(B)$.\n$$R(L,h) = k \\cdot P(A) \\cdot P(B)$$\nWe will now derive the expressions for $P(A)$ and $P(B)$.\n\nFirst, let us calculate the probability of event $A$, the presence of at least one MEPS. A MEPS is a contiguous perfect match of length $m$ base pairs. The probability of a base match at any given position is given as the fractional identity $h$. Since base matches are assumed to be independent events, the probability of a specific sequence of $m$ bases being a perfect match is $h^m$.\n\nThe problem states there are $N = L - m + 1$ possible sliding windows of length $m$ within a repeat of length $L$. It further provides the critical simplifying assumption that the event of each window being a MEPS is independent of all other windows.\nThe probability that any single window of length $m$ is a MEPS is $p_{MEPS} = h^m$.\nThe probability that a single window is *not* a MEPS is $1 - p_{MEPS} = 1 - h^m$.\nGiven the independence of the $N$ windows, the probability that *none* of them are a MEPS is the product of their individual probabilities of not being a MEPS:\n$$P(\\text{no MEPS}) = (1 - h^m)^N = (1 - h^m)^{L-m+1}$$\nEvent $A$ is the complement of the event that there are no MEPSs. Therefore, its probability is:\n$$P(A) = 1 - P(\\text{no MEPS}) = 1 - (1 - h^m)^{L-m+1}$$\n\nNext, we calculate the probability of event $B$, the survival of recombination from MMR-mediated abortion. The process is aborted if a mismatch occurs and the MMR system successfully acts on it. A mismatch occurs at any given base with probability $d = 1 - h$. Each mismatch, independently, aborts the recombination process with probability $\\epsilon$.\nThus, for any single base pair position, the probability of an abort event occurring is the probability of a mismatch at that position multiplied by the probability that the mismatch causes an abort:\n$$P(\\text{abort at one position}) = P(\\text{mismatch}) \\times P(\\text{abort | mismatch}) = (1-h)\\epsilon$$\nThe recombination process survives at a given position if no abort occurs. The probability of survival at a single position is:\n$$P(\\text{survival at one position}) = 1 - P(\\text{abort at one position}) = 1 - \\epsilon(1-h)$$\nEvent $B$ requires that the process survives scrutiny across all $L$ base pairs. Since events at each base pair are independent, the total probability of survival is the product of the survival probabilities for each of the $L$ positions:\n$$P(B) = \\prod_{i=1}^{L} P(\\text{survival at one position}) = (1 - \\epsilon(1-h))^L$$\n\nFinally, we combine the expressions for $P(A)$ and $P(B)$ to obtain the overall rate $R(L,h)$:\n$$R(L,h) = k \\cdot P(A) \\cdot P(B)$$\nSubstituting the derived probabilities gives the final closed-form expression:\n$$R(L,h) = k \\left[ 1 - (1 - h^m)^{L-m+1} \\right] \\left[ (1 - \\epsilon(1-h))^L \\right]$$\nThis expression represents the per-cell, per-generation rate of deletion events as a function of the given parameters.", "answer": "$$\\boxed{k \\left( 1 - \\left(1 - h^m\\right)^{L-m+1} \\right) \\left(1 - \\epsilon(1-h)\\right)^L}$$", "id": "2787367"}]}