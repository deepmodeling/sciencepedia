{"hands_on_practices": [{"introduction": "Designing a synthetic gene involves more than just encoding the correct amino acid sequence. To ensure the final construct is stable, efficiently expressed, and manufacturable, designers must balance competing objectives like codon usage, repeat avoidance, and synthesis feasibility. This practice demonstrates how to formalize these qualitative goals into a single, weighted objective function, a common strategy in engineering design applied to synthetic biology [@problem_id:2778538].", "problem": "You are designing a de novo coding sequence for a synthetic chromosome segment in the Synthetic Yeast Genome Project (Sc2.0) in the organism Saccharomyces cerevisiae. The designed sequence must encode a fixed amino acid sequence while balancing three design pressures that affect viability, stability, and manufacturability. Let the design variable be the codon sequence $x$ constrained to use only synonymous codons for each amino acid in the target protein. Define three penalties:\n- Codon usage deviation $C(x)$, operationalized as the aggregated Kullback–Leibler divergence between the empirical synonymous codon distribution induced by $x$ and a target reference distribution $q$ for Saccharomyces cerevisiae, i.e., for each amino acid $a$ with synonymous codon set $\\mathcal{C}_{a}$ and empirical frequencies $p_{a,c}(x)$, the contribution $\\sum_{c \\in \\mathcal{C}_{a}} p_{a,c}(x)\\ln\\!\\big(p_{a,c}(x)/q_{a,c}\\big)$ is summed over all amino acids present in the protein.\n- Repeat propensity $R(x)$, defined as a scalar penalty returned by a repeat-detection routine that increases with the expected count of exact repeats of length at least $k_{0}$ that can mediate homologous recombination or non-allelic homologous recombination during strain construction.\n- Synthesis ease penalty $S(x)$, defined as a scalar penalty that increases with violations of synthesis vendor constraints such as extreme windowed guanine-cytosine content, long homopolymer runs, and high-complexity secondary structure motifs that elevate de novo DNA synthesis failure rates.\n\nAssume multi-objective optimization will be scalarized into a single objective by a convex combination of these three penalties with nonnegative weights that sum to $1$. To prioritize constraints, you conduct a risk and cost assessment grounded in observed assembly failure modes in Sc2.0 workflows and vendor rejection statistics. On a consistent ratio scale of importance, you determine the following pairwise ratios:\n- Avoiding repeat-mediated recombination events is more critical than matching codon usage by a factor of $4$; that is, $R$ is $4{:}1$ relative to $C$ at the current stage of the project.\n- Meeting synthesis vendor constraints is more critical than avoiding repeats by a factor of $3$; that is, $S$ is $3{:}1$ relative to $R$.\nAssume multiplicative transitivity holds for these ratios.\n\nUsing only these inputs and the basic principles that codon usage affects translation (Central Dogma of molecular biology), repeats increase recombination risk, and synthesis constraint violations increase manufacturing risk and cost, derive the normalized weights for the three penalties and construct a single scalar objective to be minimized as a convex combination of $C(x)$, $R(x)$, and $S(x)$. Express the final objective as a single analytic expression in terms of $C(x)$, $R(x)$, and $S(x)$. Do not round.", "solution": "The problem requires the construction of a single scalar objective function, which we shall denote as $J(x)$, for the minimization of a weighted sum of three penalty functions: codon usage deviation $C(x)$, repeat propensity $R(x)$, and synthesis ease penalty $S(x)$. The function $J(x)$ must be a convex combination of these penalties, which is mathematically expressed as:\n$$J(x) = w_C C(x) + w_R R(x) + w_S S(x)$$\nwhere the weights $w_C$, $w_R$, and $w_S$ are non-negative and sum to unity. This normalization constraint is given by:\n$$w_C + w_R + w_S = 1$$\nThe problem provides pairwise importance ratios for these penalties, which we must translate into algebraic relationships between their corresponding weights.\n\nFirst, the repeat propensity $R$ is stated to be more critical than codon usage $C$ by a factor of $4$. This implies that the weight $w_R$ is $4$ times the weight $w_C$:\n$$\\frac{w_R}{w_C} = 4 \\implies w_R = 4w_C$$\nSecond, the synthesis ease penalty $S$ is stated to be more critical than the repeat propensity $R$ by a factor of $3$. This implies that the weight $w_S$ is $3$ times the weight $w_R$:\n$$\\frac{w_S}{w_R} = 3 \\implies w_S = 3w_R$$\nWe now have a system of three linear equations with three unknowns ($w_C, w_R, w_S$):\n$$\n\\begin{cases}\nw_C + w_R + w_S = 1 & (1) \\\\\nw_R = 4w_C & (2) \\\\\nw_S = 3w_R & (3)\n\\end{cases}\n$$\nTo solve this system, we can express all weights in terms of a single weight, for instance $w_C$.\nFrom equation $(2)$, we already have $w_R$ in terms of $w_C$. We can substitute equation $(2)$ into equation $(3)$ to express $w_S$ in terms of $w_C$:\n$$w_S = 3w_R = 3(4w_C) = 12w_C$$\nNow, substitute the expressions for $w_R$ and $w_S$ into the normalization constraint, equation $(1)$:\n$$w_C + (4w_C) + (12w_C) = 1$$\nCombining the terms on the left-hand side gives:\n$$17w_C = 1$$\nSolving for $w_C$:\n$$w_C = \\frac{1}{17}$$\nWe can now find the values for $w_R$ and $w_S$ by substitution:\n$$w_R = 4w_C = 4 \\left(\\frac{1}{17}\\right) = \\frac{4}{17}$$\n$$w_S = 12w_C = 12 \\left(\\frac{1}{17}\\right) = \\frac{12}{17}$$\nThe derived weights are $w_C = \\frac{1}{17}$, $w_R = \\frac{4}{17}$, and $w_S = \\frac{12}{17}$. These weights are non-negative and sum to $1$: $\\frac{1}{17} + \\frac{4}{17} + \\frac{12}{17} = \\frac{17}{17} = 1$. The problem also states that multiplicative transitivity holds, which can be verified: the ratio of $S$ to $C$ should be $3 \\times 4 = 12$. Our weights yield $\\frac{w_S}{w_C} = \\frac{12/17}{1/17} = 12$, which is consistent.\n\nFinally, we construct the scalar objective function $J(x)$ by substituting these weights into its definition:\n$$J(x) = \\frac{1}{17}C(x) + \\frac{4}{17}R(x) + \\frac{12}{17}S(x)$$\nThis expression represents the single scalar objective to be minimized.", "answer": "$$\n\\boxed{\\frac{1}{17}C(x) + \\frac{4}{17}R(x) + \\frac{12}{17}S(x)}\n$$", "id": "2778538"}, {"introduction": "After designing an optimal sequence, the next step is chemical synthesis, a process that is inherently imperfect. Understanding the rate of errors is critical for planning the screening and assembly stages of a large-scale project. This exercise applies fundamental probability theory to model synthesis fidelity, allowing you to calculate the expected yield of error-free DNA fragments from a production run [@problem_id:2778616].", "problem": "In the Saccharomyces cerevisiae 2.0 (Sc2.0) synthetic yeast genome project, building block deoxyribonucleic acid (DNA) fragments of fixed length are synthesized and screened for correctness before hierarchical assembly. Assume that each base in a synthesized fragment is independently correct with probability $1 - e$, where $e \\in (0,1)$ is the per-base error probability supplied by the vendor and empirically validated by control sequencing. Let $n \\in \\mathbb{N}$ denote the fragment length in bases and $m \\in \\mathbb{N}$ the number of independently synthesized fragments of the same design processed in parallel (e.g., clones picked from a pooled library). Neglect any post-synthesis error correction and any sequencing or screening errors.\n\nStarting from first principles of probability for independent Bernoulli trials, derive:\n- the exact probability that a single synthesized fragment of length $n$ is error-free as a function of $e$ and $n$, and\n- the expected number of error-free fragments among $m$ such independently synthesized fragments, expressed as a function of $e$, $n$, and $m$.\n\nExpress your final answer as a closed-form analytic expression in terms of $e$, $n$, and $m$. Report the result as a two-entry row vector whose first entry is the per-fragment error-free probability and whose second entry is the expected number of error-free fragments among $m$. Do not approximate or round.", "solution": "First, let us determine the probability that a single synthesized fragment of length $n$ is error-free.\nA single fragment consists of $n$ bases. Let us define the event $B_i$ as the event that the $i$-th base in the fragment is synthesized correctly, for $i \\in \\{1, 2, \\dots, n\\}$.\nAccording to the problem statement, the probability of any given base being correct is $P(B_i) = 1 - e$.\nThe problem also states that each base is synthesized \"independently\". A fragment is error-free if and only if all $n$ of its constituent bases are correct. Let the event that a single fragment is error-free be denoted by $F_{correct}$. This corresponds to the intersection of the events $B_i$ for all $i$ from $1$ to $n$:\n$$F_{correct} = B_1 \\cap B_2 \\cap \\dots \\cap B_n$$\nDue to the specified independence of the base synthesis events, the probability of their intersection is the product of their individual probabilities:\n$$P(F_{correct}) = P(B_1) \\times P(B_2) \\times \\dots \\times P(B_n)$$\nSince $P(B_i) = 1-e$ for all $i$, this product becomes:\n$$P(F_{correct}) = \\prod_{i=1}^{n} P(B_i) = \\prod_{i=1}^{n} (1-e) = (1-e)^n$$\nThis is the exact probability that a single fragment of length $n$ is error-free.\n\nNext, let us determine the expected number of error-free fragments among $m$ independently synthesized fragments.\nWe are considering $m$ fragments, indexed by $j \\in \\{1, 2, \\dots, m\\}$. The synthesis of each fragment is an independent process.\nLet us define a set of indicator random variables, $\\{X_1, X_2, \\dots, X_m\\}$. For each fragment $j$, the random variable $X_j$ is defined as:\n$$\nX_j =\n\\begin{cases}\n1 & \\text{if fragment } j \\text{ is error-free} \\\\\n0 & \\text{if fragment } j \\text{ contains one or more errors}\n\\end{cases}\n$$\nThe probability that fragment $j$ is error-free, $P(X_j=1)$, is precisely the probability $P(F_{correct})$ we derived earlier.\n$$P(X_j=1) = (1-e)^n$$\nThe expected value of an indicator random variable is the probability of the event it indicates. Therefore, the expected value of $X_j$ is:\n$$E[X_j] = 1 \\cdot P(X_j=1) + 0 \\cdot P(X_j=0) = P(X_j=1) = (1-e)^n$$\nLet $N_{correct}$ be the total number of error-free fragments among the $m$ fragments. $N_{correct}$ is the sum of these indicator random variables:\n$$N_{correct} = \\sum_{j=1}^{m} X_j$$\nThe problem asks for the expected number of error-free fragments, which is $E[N_{correct}]$.\nBy the linearity of expectation, the expectation of a sum of random variables is the sum of their individual expectations. This property holds regardless of whether the random variables are independent.\n$$E[N_{correct}] = E\\left[\\sum_{j=1}^{m} X_j\\right] = \\sum_{j=1}^{m} E[X_j]$$\nSince all fragments are of the same design and length $n$, and are synthesized under the same conditions (per-base error probability $e$), the expected value $E[X_j]$ is the same for all $j$:\n$$E[X_j] = (1-e)^n \\quad \\text{for all } j \\in \\{1, 2, \\dots, m\\}$$\nSubstituting this into the sum:\n$$E[N_{correct}] = \\sum_{j=1}^{m} (1-e)^n$$\nThis is a sum of $m$ identical terms. Therefore, the final expression for the expected number of error-free fragments is:\n$$E[N_{correct}] = m(1-e)^n$$", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n(1-e)^{n} & m(1-e)^{n}\n\\end{pmatrix}\n}\n$$", "id": "2778616"}, {"introduction": "With a supply of validated DNA building blocks, the next step is to assemble them into a full-length chromosome. This assembly process, often involving overlapping fragments, follows a simple geometric logic that dictates the total number of pieces required. This practice guides you through a first-principles derivation to determine the minimal number of fragments needed to span a target chromosome, a core calculation in planning any genome synthesis project [@problem_id:2778583].", "problem": "In the Synthetic Yeast Genome Project (Sc2.0), linear assembly of a chromosome is achieved by tiling overlapping DNA fragments (“chunks”), each of nominal length $c$, with adjacent chunks sharing a homologous overlap of length $o$, where $c > o > 0$. The total chromosome span covered by $N$ such chunks equals the contribution of the first chunk plus the nonredundant contribution of each subsequent chunk. Let the target chromosome length to be covered be $L$. Starting only from these definitions and the principle that homologous overlaps do not add new unique bases to the span, derive the minimal number of chunks required to span the chromosome and the minimal number of overlaps needed between them. Then compute these values for a synthetic chromosome of length $L = 807{,}645$ base pairs, using chunk length $c = 10{,}000$ base pairs and overlap length $o = 500$ base pairs.\n\nReport your final result as two exact integers (dimensionless counts) in the order: number of chunks, number of overlaps. Express the final answer as a row matrix.", "solution": "The derivation proceeds from the first principles as stated in the problem. Let $N$ be the number of chunks required to span a total length $L$. Each chunk has a length $c$, and adjacent chunks have an overlap of length $o$.\n\nThe total length spanned by $N$ chunks, which we denote as $L_{covered}$, can be expressed by considering the contribution of each chunk sequentially.\nThe first chunk contributes its entire length, $c$, to the total span.\nEach subsequent chunk, from the second to the $N$-th, is aligned with the previous chunk. Due to the overlap of length $o$, the new, unique length contributed by each of these chunks is its total length minus the overlap, i.e., $c - o$.\nThere are $N-1$ such subsequent chunks.\n\nTherefore, the total length covered is the length of the first chunk plus the sum of the nonredundant contributions from the $N-1$ subsequent chunks:\n$$L_{covered} = c + (N-1)(c-o)$$\n\nTo span the entire target chromosome of length $L$, the total covered length must be greater than or equal to $L$. This establishes the following inequality:\n$$c + (N-1)(c-o) \\ge L$$\n\nWe must now solve this inequality for $N$.\n$$(N-1)(c-o) \\ge L - c$$\nGiven that $c > o$, the term $c-o$ is a positive quantity, so we can divide both sides by it without altering the direction of the inequality:\n$$N-1 \\ge \\frac{L-c}{c-o}$$\nAdding $1$ to both sides gives:\n$$N \\ge 1 + \\frac{L-c}{c-o}$$\nThis expression can be simplified by combining the terms on the right-hand side:\n$$N \\ge \\frac{c-o}{c-o} + \\frac{L-c}{c-o} = \\frac{(c-o) + (L-c)}{c-o} = \\frac{L-o}{c-o}$$\nSo, the condition on $N$ is:\n$$N \\ge \\frac{L-o}{c-o}$$\nSince the number of chunks $N$ must be an integer, the minimal number of chunks, $N_{min}$, required to span the length $L$ is the smallest integer that satisfies this condition. This is obtained by taking the ceiling of the right-hand side expression:\n$$N_{min} = \\left\\lceil \\frac{L-o}{c-o} \\right\\rceil$$\nThe number of overlaps required for a linear assembly of $N_{min}$ chunks is simply $N_{min}-1$, as each pair of adjacent chunks creates one overlap. Let this be $N_{overlaps}$.\n$$N_{overlaps} = N_{min} - 1$$\n\nNow, we substitute the given numerical values: $L = 807645$, $c = 10000$, and $o = 500$.\nFirst, calculate the ratio for $N_{min}$:\n$$\\frac{L-o}{c-o} = \\frac{807645 - 500}{10000 - 500} = \\frac{807145}{9500} \\approx 84.96263$$\nThe minimal number of chunks $N_{min}$ is the ceiling of this value:\n$$N_{min} = \\lceil 84.96263 \\rceil = 85$$\nThe minimal number of overlaps is then:\n$$N_{overlaps} = 85 - 1 = 84$$\nThe two required values are $85$ chunks and $84$ overlaps.", "answer": "$$\\boxed{\\begin{pmatrix} 85 & 84 \\end{pmatrix}}$$", "id": "2778583"}]}