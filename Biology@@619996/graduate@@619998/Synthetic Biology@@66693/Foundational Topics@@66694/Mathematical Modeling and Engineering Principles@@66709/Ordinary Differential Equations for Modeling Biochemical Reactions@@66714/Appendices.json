{"hands_on_practices": [{"introduction": "Modeling even a simple biological process, such as the constitutive expression of a gene, requires a choice between deterministic and stochastic frameworks. This practice explores this fundamental duality using the canonical birth-death model [@problem_id:2776313]. You will bridge the deterministic view, described by an ordinary differential equation for the average molecule count, with the underlying stochastic process that gives rise to inherent noise, which you will quantify using the coefficient of variation.", "problem": "A constitutive transcriptional device is described using the Synthetic Biology Open Language (SBOL), with the following annotated attributes per gene copy: a promoter with a measured zero-order transcription initiation rate of $12$ molecules per minute and a messenger RNA first-order degradation rate constant of $0.6$ per minute. The device is instantiated in a cell-free reaction with $3$ gene copies per reaction compartment. You are tasked with exchanging this design as a kinetic model in the Systems Biology Markup Language (SBML) using elementary reactions under the well-stirred, isothermal, constant-volume assumptions.\n\nStarting from standard mass-action kinetics and the Chemical Master Equation for birth-death processes, do the following:\n\n1) Map the SBOL design attributes to SBML parameters for a single molecular species $X$ representing the RNA copy number. Let $\\alpha$ denote the zero-order synthesis rate and $\\beta$ the first-order degradation rate constant. Derive the deterministic ordinary differential equation (ODE) for the expected copy number $X(t)$.\n\n2) Specify the stochastic propensities in the sense of the Stochastic Simulation Algorithm for the two SBML reactions $\\varnothing \\to X$ and $X \\to \\varnothing$.\n\n3) Using the steady-state solution of the Chemical Master Equation for a birth-death process, derive the stationary distribution and from it the coefficient of variation $\\mathrm{CV}$ at stationarity as a function of $\\alpha$ and $\\beta$.\n\n4) Using the provided SBOL attributes and gene copy number, compute the numerical value of the steady-state coefficient of variation for $X$. Express the coefficient of variation as a decimal number (dimensionless) and round your answer to four significant figures.\n\nProvide only the numerical value of the coefficient of variation for your final answer.", "solution": "The problem statement is subjected to critical validation before any attempt at a solution.\n\nStep 1: Extraction of Givens.\nThe following data and conditions are provided verbatim:\n- A constitutive transcriptional device.\n- Frameworks: Synthetic Biology Open Language (SBOL), Systems Biology Markup Language (SBML).\n- Promoter attribute: zero-order transcription initiation rate of $12$ molecules per minute per gene copy.\n- Messenger RNA attribute: first-order degradation rate constant of $0.6$ per minute.\n- System configuration: $3$ gene copies per reaction compartment.\n- Modeling assumptions: well-stirred, isothermal, constant-volume reaction.\n- Task 1: Map SBOL to SBML parameters $\\alpha$ (zero-order synthesis rate) and $\\beta$ (first-order degradation rate constant) for species $X$ (RNA copy number). Derive the deterministic ordinary differential equation (ODE) for $X(t)$.\n- Task 2: Specify the stochastic propensities for the reactions $\\varnothing \\to X$ and $X \\to \\varnothing$.\n- Task 3: Derive the stationary distribution from the Chemical Master Equation and the corresponding coefficient of variation $\\mathrm{CV}$ at stationarity as a function of $\\alpha$ and $\\beta$.\n- Task 4: Compute the numerical value of the steady-state $\\mathrm{CV}$ and round to four significant figures.\n\nStep 2: Validation of Givens.\nThe problem is scrutinized against the required criteria.\n- **Scientifically Grounded:** The problem describes a simple birth-death process, a canonical model in stochastic chemical kinetics used to represent gene expression. The use of SBOL and SBML for exchanging such models is a standard practice in synthetic and systems biology. The kinetic parameters are within physically and biologically realistic ranges for messenger RNA dynamics. The problem is therefore scientifically sound.\n- **Well-Posed:** The problem provides all necessary information to perform the requested derivations and calculations. It is structured as a sequence of logical steps leading to a unique, meaningful solution.\n- **Objective:** The language is technical, precise, and devoid of subjective or ambiguous statements.\n\nStep 3: Verdict.\nThe problem is deemed **valid**. It is a well-posed, scientifically grounded problem that tests fundamental concepts in stochastic modeling of biological systems. We will proceed with the solution.\n\nThe solution is constructed by addressing each of the four tasks in sequence.\n\n1) Mapping of SBOL Attributes and Derivation of the Deterministic ODE\n\nThe SBOL design specifies attributes on a per-gene-copy basis. To formulate an SBML model for the entire compartment, these must be aggregated. The species of interest is the messenger RNA, denoted by $X$.\n\nThe total zero-order synthesis rate, $\\alpha$, is the product of the rate per gene copy and the number of gene copies.\nGiven:\n- Transcription initiation rate per copy: $12 \\, \\text{min}^{-1}$\n- Number of gene copies: $3$\nThe total synthesis rate $\\alpha$ for the reaction compartment is:\n$$ \\alpha = (12 \\, \\text{min}^{-1}) \\times 3 = 36 \\, \\text{min}^{-1} $$\nThe first-order degradation rate constant, $\\beta$, is given directly as:\n$$ \\beta = 0.6 \\, \\text{min}^{-1} $$\nThese parameters, $\\alpha$ and $\\beta$, represent the mapping from the SBOL description to the SBML kinetic model parameters.\n\nThe system is described by two elementary reactions:\n- Synthesis (birth): $\\varnothing \\xrightarrow{\\alpha} X$\n- Degradation (death): $X \\xrightarrow{\\beta} \\varnothing$\n\nUnder the deterministic assumption (mean-field approximation), the time evolution of the expected copy number of species $X$, denoted $X(t)$, is governed by an ordinary differential equation (ODE). The rate of change is the rate of production minus the rate of consumption.\n- Rate of production (zero-order): $\\alpha$\n- Rate of degradation (first-order): $\\beta X(t)$\nThe resulting ODE is:\n$$ \\frac{dX(t)}{dt} = \\alpha - \\beta X(t) $$\nThis equation describes the evolution of the mean number of molecules of $X$.\n\n2) Specification of Stochastic Propensities\n\nIn the stochastic formulation, reaction rates are described by propensity functions. The propensity $a_j(\\mathbf{x})$ of a reaction $j$ is defined such that $a_j(\\mathbf{x})dt$ is the probability that reaction $j$ will occur in the infinitesimal time interval $[t, t+dt)$, given the system state $\\mathbf{x}$. Here, the state is simply the number of molecules of $X$, which we denote by $n$.\n\n- For the synthesis reaction $R_1: \\varnothing \\xrightarrow{\\alpha} X$, the rate is independent of the number of molecules of $X$. This is a zero-order reaction. Its propensity is constant:\n$$ a_1(n) = \\alpha $$\n- For the degradation reaction $R_2: X \\xrightarrow{\\beta} \\varnothing$, the rate is proportional to the number of reactant molecules, $n$. This is a first-order reaction. Its propensity is:\n$$ a_2(n) = \\beta n $$\n\nThese two propensities, $a_1(n)$ and $a_2(n)$, are the basis for stochastic simulation algorithms, such as the Gillespie algorithm.\n\n3) Derivation of the Stationary Distribution and Coefficient of Variation\n\nThe time evolution of the probability distribution $P(n, t)$ over the number of molecules $n$ is described by the Chemical Master Equation (CME). For this birth-death process, the CME is:\n$$ \\frac{dP(n, t)}{dt} = [\\text{birth from } n-1] + [\\text{death from } n+1] - [\\text{death from } n] - [\\text{birth from } n] $$\n$$ \\frac{dP(n, t)}{dt} = \\alpha P(n-1, t) + \\beta(n+1)P(n+1, t) - (\\alpha + \\beta n)P(n, t) \\quad \\text{for } n \\ge 1 $$\nwith the boundary condition for $n=0$:\n$$ \\frac{dP(0, t)}{dt} = \\beta P(1, t) - \\alpha P(0, t) $$\nAt stationarity (steady state), the probability distribution is constant in time, so $\\frac{dP(n, t)}{dt} = 0$ for all $n$. Let the stationary distribution be $P_s(n)$. The CME reduces to a set of algebraic equations. A simpler approach is to use the principle of detailed balance, which for a one-dimensional system requires the probability flux between adjacent states to be zero.\n$$ \\text{Flux}(n-1 \\to n) = \\text{Flux}(n \\to n-1) $$\n$$ \\alpha P_s(n-1) = \\beta n P_s(n) $$\nThis yields the recurrence relation:\n$$ P_s(n) = \\frac{\\alpha}{n\\beta} P_s(n-1) $$\nBy repeated application, we find the general form for $P_s(n)$ in terms of $P_s(0)$:\n$$ P_s(n) = \\frac{1}{n!} \\left(\\frac{\\alpha}{\\beta}\\right)^n P_s(0) $$\nWe use the normalization condition $\\sum_{n=0}^{\\infty} P_s(n) = 1$ to find $P_s(0)$. Let $\\lambda = \\frac{\\alpha}{\\beta}$.\n$$ \\sum_{n=0}^{\\infty} \\frac{\\lambda^n}{n!} P_s(0) = P_s(0) \\sum_{n=0}^{\\infty} \\frac{\\lambda^n}{n!} = P_s(0) \\exp(\\lambda) = 1 $$\nThis gives $P_s(0) = \\exp(-\\lambda)$. Substituting this back gives the stationary distribution:\n$$ P_s(n) = \\frac{\\lambda^n \\exp(-\\lambda)}{n!}, \\quad \\text{where } \\lambda = \\frac{\\alpha}{\\beta} $$\nThis is a Poisson distribution with parameter $\\lambda$.\n\nThe coefficient of variation ($\\mathrm{CV}$) is defined as the ratio of the standard deviation $\\sigma$ to the mean $\\mu$: $\\mathrm{CV} = \\frac{\\sigma}{\\mu}$. For a Poisson distribution with parameter $\\lambda$, the mean and variance are known to be:\n- Mean: $\\mu = \\langle n \\rangle = \\lambda$\n- Variance: $\\sigma^2 = \\langle (n-\\mu)^2 \\rangle = \\lambda$\nThe standard deviation is therefore $\\sigma = \\sqrt{\\lambda}$.\nThe coefficient of variation at stationarity is:\n$$ \\mathrm{CV} = \\frac{\\sigma}{\\mu} = \\frac{\\sqrt{\\lambda}}{\\lambda} = \\frac{1}{\\sqrt{\\lambda}} $$\nSubstituting $\\lambda = \\frac{\\alpha}{\\beta}$, we obtain the expression for the $\\mathrm{CV}$ in terms of the model parameters:\n$$ \\mathrm{CV} = \\frac{1}{\\sqrt{\\alpha/\\beta}} = \\sqrt{\\frac{\\beta}{\\alpha}} $$\n\n4) Numerical Computation of the Coefficient of Variation\n\nWe use the parameter values derived in the first part to compute the numerical value of the $\\mathrm{CV}$.\n- Total synthesis rate: $\\alpha = 36 \\, \\text{min}^{-1}$\n- Degradation rate constant: $\\beta = 0.6 \\, \\text{min}^{-1}$\nSubstituting these values into the derived formula for the $\\mathrm{CV}$:\n$$ \\mathrm{CV} = \\sqrt{\\frac{0.6}{36}} = \\sqrt{\\frac{6 \\times 10^{-1}}{36}} = \\sqrt{\\frac{1}{60}} $$\nNow, we compute the numerical value and round to four significant figures as required.\n$$ \\mathrm{CV} = \\frac{1}{\\sqrt{60}} \\approx 0.12909944... $$\nRounding to four significant figures gives:\n$$ \\mathrm{CV} \\approx 0.1291 $$", "answer": "$$\\boxed{0.1291}$$", "id": "2776313"}, {"introduction": "As we move from single-species models to interconnected biochemical networks, the corresponding system of ODEs can become large and unwieldy. This exercise [@problem_id:2776492] introduces a powerful analytical technique, stoichiometric network analysis, to dissect and simplify such systems before resorting to numerical simulation. By constructing the stoichiometric matrix $S$ for a phosphorylation cycle, you will learn to identify conserved quantities from the matrix's structure and use them to reduce the model's dimensionality, a critical skill for efficiently analyzing complex biological pathways.", "problem": "A Systems Biology Markup Language (SBML) model is generated from a Synthetic Biology Open Language (SBOL) design describing a single-substrate reversible phosphorylation cycle catalyzed by a kinase and a phosphatase in a closed, well-mixed, constant-volume reactor. The model contains the following chemical species: unphosphorylated protein $P$, phosphorylated protein $P^{*}$, free kinase $K$, free phosphatase $F$, kinase–substrate complex $C_{1}$, phosphatase–substrate complex $C_{2}$, adenosine triphosphate $\\mathrm{ATP}$, adenosine diphosphate $\\mathrm{ADP}$, and inorganic phosphate $\\mathrm{Pi}$. The SBML reactions (reversible steps are represented as separate forward and reverse reactions) are:\n- $R_{1f}: K + P \\rightarrow C_{1}$,\n- $R_{1r}: C_{1} \\rightarrow K + P$,\n- $R_{2}: C_{1} + \\mathrm{ATP} \\rightarrow K + P^{*} + \\mathrm{ADP}$,\n- $R_{3f}: F + P^{*} \\rightarrow C_{2}$,\n- $R_{3r}: C_{2} \\rightarrow F + P^{*}$,\n- $R_{4}: C_{2} \\rightarrow F + P + \\mathrm{Pi}$.\n\nAll reactions are elementary and follow mass-action kinetics. There is no synthesis or degradation of any species outside these reactions, and there is no exchange with the environment.\n\n1) Using the fundamental representation of reaction networks in SBML as $d\\mathbf{x}/dt = S\\,\\mathbf{v}(\\mathbf{x})$, where $S$ is the stoichiometric matrix and $\\mathbf{x}$ is the vector of species amounts in the fixed order $\\left[P,\\,P^{*},\\,K,\\,F,\\,C_{1},\\,C_{2},\\,\\mathrm{ATP},\\,\\mathrm{ADP},\\,\\mathrm{Pi}\\right]^{\\top}$, write down the stoichiometric matrix $S$ implied by the reactions above.\n\n2) Starting from the definitions of conserved moieties and from the stoichiometric invariants implied by $S$, derive all linearly independent conservation relations that must hold in this closed system. Clearly state the modeling assumptions you use.\n\n3) Use the conservation relations to eliminate dependent species and express them in terms of a set of independent dynamic variables and the corresponding conserved totals. For concreteness, choose the independent set $\\{P,\\,K,\\,F,\\,\\mathrm{ATP}\\}$. Provide explicit expressions for $C_{1}$, $C_{2}$, $P^{*}$, $\\mathrm{ADP}$, and $\\mathrm{Pi}$ in terms of $P,\\,K,\\,F,\\,\\mathrm{ATP}$ and the conserved totals you identified.\n\n4) From your derivation, determine the number of independent ordinary differential equations remaining after the reduction by conservation relations. Provide this number as your final answer. No rounding is required, and no units are needed for the final answer.", "solution": "The problem statement is subjected to validation before a solution is attempted.\n\nStep 1: Extract Givens.\nThe system consists of $9$ chemical species, whose amounts are represented by the vector $\\mathbf{x} = \\left[P,\\,P^{*},\\,K,\\,F,\\,C_{1},\\,C_{2},\\,\\mathrm{ATP},\\,\\mathrm{ADP},\\,\\mathrm{Pi}\\right]^{\\top}$.\nThere are $6$ elementary, mass-action reactions given:\n- $R_{1f}: K + P \\rightarrow C_{1}$\n- $R_{1r}: C_{1} \\rightarrow K + P$\n- $R_{2}: C_{1} + \\mathrm{ATP} \\rightarrow K + P^{*} + \\mathrm{ADP}$\n- $R_{3f}: F + P^{*} \\rightarrow C_{2}$\n- $R_{3r}: C_{2} \\rightarrow F + P^{*}$\n- $R_{4}: C_{2} \\rightarrow F + P + \\mathrm{Pi}$\nThe system is described by the differential equation $\\frac{d\\mathbf{x}}{dt} = S\\,\\mathbf{v}(\\mathbf{x})$.\nThe system is closed, well-mixed, and has a constant volume. There is no synthesis, degradation, or exchange with the environment beyond the specified reactions.\n\nStep 2: Validate Using Extracted Givens.\nThe problem is scientifically grounded, describing a standard phosphorylation-dephosphorylation cycle, a fundamental motif in biochemical networks. The use of stoichiometric matrix formalism ($S$) and mass-action kinetics is a standard and rigorous approach in chemical kinetics and systems biology. The problem is well-posed, with clear and objective definitions and a sequence of logical tasks that lead to a unique solution. All necessary information is provided. The problem is self-contained and consistent.\n\nStep 3: Verdict and Action.\nThe problem is deemed valid. A full solution will be provided.\n\nThe solution proceeds in four parts as requested.\n\nPart 1: Stoichiometric Matrix $S$\nThe state vector of species amounts is $\\mathbf{x} = \\left[P, P^{*}, K, F, C_{1}, C_{2}, \\mathrm{ATP}, \\mathrm{ADP}, \\mathrm{Pi}\\right]^{\\top}$. The reaction rate vector is $\\mathbf{v} = \\left[v_{1f}, v_{1r}, v_{2}, v_{3f}, v_{3r}, v_{4}\\right]^{\\top}$. The stoichiometric matrix $S$ has dimensions $9 \\times 6$, where each column represents a reaction and each row represents a species. The entries $S_{ij}$ denote the net change in the amount of species $i$ due to reaction $j$.\n\nFor each reaction, the corresponding column of $S$ is constructed as follows:\n- $R_{1f}: K + P \\rightarrow C_{1}$. Changes: $\\Delta P = -1$, $\\Delta K = -1$, $\\Delta C_{1} = +1$.\n- $R_{1r}: C_{1} \\rightarrow K + P$. Changes: $\\Delta C_{1} = -1$, $\\Delta K = +1$, $\\Delta P = +1$.\n- $R_{2}: C_{1} + \\mathrm{ATP} \\rightarrow K + P^{*} + \\mathrm{ADP}$. Changes: $\\Delta C_{1} = -1$, $\\Delta \\mathrm{ATP} = -1$, $\\Delta K = +1$, $\\Delta P^{*} = +1$, $\\Delta \\mathrm{ADP} = +1$.\n- $R_{3f}: F + P^{*} \\rightarrow C_{2}$. Changes: $\\Delta F = -1$, $\\Delta P^{*} = -1$, $\\Delta C_{2} = +1$.\n- $R_{3r}: C_{2} \\rightarrow F + P^{*}$. Changes: $\\Delta C_{2} = -1$, $\\Delta F = +1$, $\\Delta P^{*} = +1$.\n- $R_{4}: C_{2} \\rightarrow F + P + \\mathrm{Pi}$. Changes: $\\Delta C_{2} = -1$, $\\Delta F = +1$, $\\Delta P = +1$, $\\Delta \\mathrm{Pi} = +1$.\n\nAssembling these columns in the specified order of reactions gives the stoichiometric matrix $S$:\n$$\nS = \\begin{pmatrix}\n-1 & 1 & 0 & 0 & 0 & 1 \\\\\n0 & 0 & 1 & -1 & 1 & 0 \\\\\n-1 & 1 & 1 & 0 & 0 & 0 \\\\\n0 & 0 & 0 & -1 & 1 & 1 \\\\\n1 & -1 & -1 & 0 & 0 & 0 \\\\\n0 & 0 & 0 & 1 & -1 & -1 \\\\\n0 & 0 & -1 & 0 & 0 & 0 \\\\\n0 & 0 & 1 & 0 & 0 & 0 \\\\\n0 & 0 & 0 & 0 & 0 & 1\n\\end{pmatrix}\n$$\n\nPart 2: Conservation Relations\nConservation relations arise from linear combinations of species amounts that remain constant over time. For a quantity $M = \\mathbf{c}^{\\top}\\mathbf{x}$ to be conserved, its time derivative must be zero:\n$$\n\\frac{dM}{dt} = \\mathbf{c}^{\\top}\\frac{d\\mathbf{x}}{dt} = \\mathbf{c}^{\\top}S\\mathbf{v}(\\mathbf{x}) = 0\n$$\nSince this must hold for any valid rate vector $\\mathbf{v}(\\mathbf{x})$, the condition reduces to finding the left null-space of $S$, i.e., all vectors $\\mathbf{c}$ such that $\\mathbf{c}^{\\top}S = \\mathbf{0}^{\\top}$. The number of linearly independent conservation laws is the dimension of this null-space, which is equal to $N - \\mathrm{rank}(S)$, where $N=9$ is the number of species.\n\nBy inspection of the columns of $S$ or by solving the system of linear equations $\\mathbf{c}^{\\top}S = \\mathbf{0}^{\\top}$, we can identify the basis vectors for the left null-space. The rank of $S$ is $4$. Therefore, there are $9 - 4 = 5$ linearly independent conservation laws. A set of such laws, corresponding to physically intuitive conserved moieties, is:\n1.  Total protein is conserved, as it exists in free forms $P$ and $P^*$, or complexed as $C_1$ and $C_2$.\n    $P(t) + P^{*}(t) + C_{1}(t) + C_{2}(t) = P_{tot}$\n2.  Total kinase is conserved, existing as free kinase $K$ or in complex $C_1$.\n    $K(t) + C_{1}(t) = K_{tot}$\n3.  Total phosphatase is conserved, existing as free phosphatase $F$ or in complex $C_2$.\n    $F(t) + C_{2}(t) = F_{tot}$\n4.  Total adenosine pool is conserved, as $\\mathrm{ATP}$ is converted to $\\mathrm{ADP}$.\n    $\\mathrm{ATP}(t) + \\mathrm{ADP}(t) = A_{tot}$\n5.  A fifth conservation law can be derived from the stoichiometry of phosphate transfer. The vector $\\mathbf{c}^{\\top} = [0, 1, 0, 0, 0, 1, 1, 0, 1]$ is a valid left-null vector, corresponding to the conservation of $P^{*} + C_{2} + \\mathrm{ATP} + \\mathrm{Pi}$.\n    $P^{*}(t) + C_{2}(t) + \\mathrm{ATP}(t) + \\mathrm{Pi}(t) = Q_{tot}$\nThese five relations are linearly independent. The constants $P_{tot}$, $K_{tot}$, $F_{tot}$, $A_{tot}$, and $Q_{tot}$ are determined by the initial conditions of the system. The modeling assumption used here is explicitly stated in the problem: the system is closed and the listed reactions are exhaustive.\n\nPart 3: Elimination of Dependent Species\nThe five conservation relations allow us to express five dependent species in terms of four independent ones and the five conserved totals. The problem specifies the independent set as $\\{P, K, F, \\mathrm{ATP}\\}$. We solve for the dependent species $\\{P^{*}, C_{1}, C_{2}, \\mathrm{ADP}, \\mathrm{Pi}\\}$.\n\nFrom conservation relation (2):\n$$C_{1} = K_{tot} - K$$\nFrom conservation relation (3):\n$$C_{2} = F_{tot} - F$$\nFrom conservation relation (4):\n$$\\mathrm{ADP} = A_{tot} - \\mathrm{ATP}$$\nUsing these results in conservation relation (1) to find $P^{*}$:\n$$P^{*} = P_{tot} - P - C_{1} - C_{2} = P_{tot} - P - (K_{tot} - K) - (F_{tot} - F)$$\n$$P^{*} = P_{tot} - K_{tot} - F_{tot} - P + K + F$$\nFinally, using these results in conservation relation (5) to find $\\mathrm{Pi}$:\n$$\\mathrm{Pi} = Q_{tot} - P^{*} - C_{2} - \\mathrm{ATP}$$\n$$\\mathrm{Pi} = Q_{tot} - (P_{tot} - K_{tot} - F_{tot} - P + K + F) - (F_{tot} - F) - \\mathrm{ATP}$$\n$$\\mathrm{Pi} = Q_{tot} - P_{tot} + K_{tot} + F_{tot} + P - K - F - F_{tot} + F - \\mathrm{ATP}$$\n$$\\mathrm{Pi} = Q_{tot} - P_{tot} + K_{tot} + P - K - \\mathrm{ATP}$$\n\nThe explicit expressions for the dependent species are therefore:\n- $C_{1} = K_{tot} - K$\n- $C_{2} = F_{tot} - F$\n- $\\mathrm{ADP} = A_{tot} - \\mathrm{ATP}$\n- $P^{*} = P_{tot} - K_{tot} - F_{tot} - P + K + F$\n- $\\mathrm{Pi} = (Q_{tot} - P_{tot} + K_{tot}) + P - K - \\mathrm{ATP}$\n\nPart 4: Number of Independent Ordinary Differential Equations\nThe original system consists of $9$ coupled ordinary differential equations (ODEs) for the $9$ species. The existence of $5$ linearly independent conservation relations means that the system's dynamics are constrained to a manifold of lower dimension. The number of independent degrees of freedom, and thus the number of independent ODEs required to describe the system, is the total number of species minus the number of independent conservation laws.\nNumber of species = $9$.\nNumber of independent conservation laws = $5$.\nNumber of independent ODEs = $9 - 5 = 4$.\nThis result corresponds to the size of the set of independent dynamic variables $\\{P, K, F, \\mathrm{ATP}\\}$ chosen in Part 3. The system dynamics can be fully described by a reduced model of four ODEs for these variables.\nThe final answer is this number.", "answer": "$$\\boxed{4}$$", "id": "2776492"}, {"introduction": "The predictive power of ODE modeling shines in its capacity to explain non-linear dynamics that generate sophisticated cellular functions like decision-making and memory. This hands-on practice [@problem_id:2755952] centers on the celebrated genetic toggle switch, a synthetic circuit motif built on mutual repression. You will derive the governing equations using non-linear Hill functions to capture cooperative interactions and then employ numerical simulation to uncover the circuit's hallmark property of bistability, demonstrating how a system can settle into one of two distinct stable states based on its history.", "problem": "You are to formalize and analyze a two-gene mutual repression circuit (a genetic toggle switch) using ordinary differential equations (ODEs) in the context of synthetic biology. The system consists of two proteins that repress each other’s expression. Your tasks are to derive the governing ODEs from foundational principles, implement a numerical solver, and determine the number of distinct stable steady states that are reachable from two qualitatively different initial conditions for each parameter set in a test suite. All concentrations and time are nondimensionalized, so no physical units are required for any reported values.\n\nBase modeling assumptions and derivation requirements:\n- Start from the following foundations:\n  - Mass-action kinetics for the binding of a repressor to a promoter.\n  - A quasi-steady-state approximation for promoter occupancy, resulting in a Hill-type repression function with Hill coefficient $n$ and dissociation constant $K$.\n  - Linear first-order loss due to degradation and dilution.\n- Let $A(t)$ and $B(t)$ denote the nondimensional concentrations of the two proteins at time $t$.\n- Let $\\alpha_A$ and $\\alpha_B$ denote maximal production rates when the respective promoters are completely unbound by their repressors.\n- Let $\\delta_A$ and $\\delta_B$ denote first-order loss rate constants.\n- Let $K_A$ and $K_B$ denote the effective dissociation constants associated with the repressor binding to the promoters controlling $B$ and $A$, respectively.\n- Let $n_A$ and $n_B$ denote the Hill coefficients describing the cooperativity of repression.\n- From these principles, derive ODEs for $A(t)$ and $B(t)$ in which the effective production of each protein is proportional to the probability that its promoter is unbound, and the probability of an unbound promoter is a decreasing Hill function of the repressor concentration. Do not introduce any leak terms.\n\nComputation and classification protocol:\n- For each parameter set in the test suite below, integrate the derived ODEs over $t \\in [0, T_{\\max}]$ with $T_{\\max} = $ $500$. Use two initial conditions designed to probe distinct basins of attraction:\n  - Initial condition $I_1$: $A(0) = $ $50$, $B(0) = $ $0.01$.\n  - Initial condition $I_2$: $A(0) = $ $0.01$, $B(0) = $ $50$.\n- Use a sufficiently accurate numerical method to resolve convergence to steady behavior. A stiff-capable solver with tight tolerances is recommended.\n- After integrating from both initial conditions, determine the Euclidean distance $d$ between the two terminal states in the $(A,B)$ plane. Use the classification rule:\n  - If $d \\ge \\tau$, with $\\tau = $ $5$, then report that two distinct stable steady states were reached (i.e., bistability detected) for that parameter set.\n  - Otherwise, report a single stable steady state.\n- For each parameter set, the required output is an integer: either $1$ or $2$.\n\nTest suite:\n- Case $1$ (happy path, strong cooperativity): $\\alpha_A = $ $50$, $\\alpha_B = $ $50$, $\\delta_A = $ $1$, $\\delta_B = $ $1$, $K_A = $ $1$, $K_B = $ $1$, $n_A = $ $4$, $n_B = $ $4$.\n- Case $2$ (boundary, no cooperativity): $\\alpha_A = $ $50$, $\\alpha_B = $ $50$, $\\delta_A = $ $1$, $\\delta_B = $ $1$, $K_A = $ $1$, $K_B = $ $1$, $n_A = $ $1$, $n_B = $ $1$.\n- Case $3$ (edge, fast loss): $\\alpha_A = $ $50$, $\\alpha_B = $ $50$, $\\delta_A = $ $5$, $\\delta_B = $ $5$, $K_A = $ $1$, $K_B = $ $1$, $n_A = $ $4$, $n_B = $ $4$.\n- Case $4$ (edge, weak expression): $\\alpha_A = $ $5$, $\\alpha_B = $ $5$, $\\delta_A = $ $1$, $\\delta_B = $ $1$, $K_A = $ $1$, $K_B = $ $1$, $n_A = $ $4$, $n_B = $ $4$.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order of the test suite cases. For example, if the results are $2$, $1$, $1$, $1$, your program must print exactly:\n- $[2,1,1,1]$.", "solution": "The problem as stated is scientifically sound, well-posed, and contains all necessary information for its resolution. It requests the derivation and analysis of a standard model in synthetic biology, the genetic toggle switch, based on established biophysical principles. The validation is passed, and I will proceed with the solution.\n\nThe task is to formalize the dynamics of a two-protein mutual repression circuit. Let the nondimensional concentrations of the two proteins be $A(t)$ and $B(t)$. The core of the derivation is the application of the law of mass action, which states that the rate of change of a species' concentration is the sum of production rates minus the sum of loss rates.\n\nFor any protein $P$, the general form of the governing ordinary differential equation (ODE) is:\n$$\n\\frac{d[P]}{dt} = (\\text{Rate of Production}) - (\\text{Rate of Loss})\n$$\nwhere $[P]$ denotes the concentration of protein $P$.\n\nThe problem specifies that loss is a first-order process, representing combined effects of active degradation and dilution due to cell growth. For proteins $A$ and $B$, these loss terms are given by $\\delta_A A$ and $\\delta_B B$, respectively, where $\\delta_A$ and $\\delta_B$ are the first-order loss rate constants.\n\nThe production term is more complex. The expression of a gene is controlled by a promoter region on the DNA. In this system, protein $B$ represses the production of protein $A$, and protein $A$ represses the production of protein $B$. The rate of protein synthesis is assumed to be proportional to the maximal production rate, $\\alpha$, and the probability that the associated promoter is in an active (unbound) state.\n\nLet us first consider the production of protein $A$. Its synthesis is repressed by protein $B$. This repression occurs when molecules of protein $B$ bind to the operator site of the promoter for gene $A$. We can model this binding process as a chemical equilibrium:\n$$\nn_B P_B + O_A \\rightleftharpoons C\n$$\nHere, $P_B$ represents the repressor protein $B$, $O_A$ is the free operator site for the gene encoding $A$, and $C$ is the complex of the operator bound by $n_B$ molecules of the repressor. The parameter $n_B$ is the Hill coefficient, representing the cooperativity of binding.\n\nA quasi-steady-state approximation for this binding process, a standard simplification in this context, leads to the Hill function for the probability that the operator $O_A$ is unbound. This probability, which we denote $f_{rep}(B)$, is a decreasing function of the repressor concentration $[B]$:\n$$\nf_{rep}(B) = \\frac{K_{B}^{n_B}}{K_{B}^{n_B} + B^{n_B}} = \\frac{1}{1 + (B/K_B)^{n_B}}\n$$\nHere, $K_B$ is the effective dissociation constant for the binding of repressor $B$ to its target operator. It corresponds to the concentration of $B$ at which the production rate of $A$ is halved. Per the problem statement, the parameter $K_B$ is associated with the promoter controlling $A$, and $n_B$ is the cooperativity of repressor $B$.\n\nThe total rate of production for protein $A$ is thus the maximal rate $\\alpha_A$ modulated by this repressive function. The problem specifies no leak expression, so the production rate is zero when the promoter is fully repressed.\n$$\n\\text{Rate of Production of } A = \\alpha_A \\cdot f_{rep}(B) = \\frac{\\alpha_A}{1 + (B/K_B)^{n_B}}\n$$\n\nCombining the production and loss terms, we arrive at the first ODE for the concentration of protein $A$:\n$$\n\\frac{dA}{dt} = \\frac{\\alpha_A}{1 + (B/K_B)^{n_B}} - \\delta_A A\n$$\n\nThe derivation for the concentration of protein $B$ is perfectly symmetrical. Its production is repressed by protein $A$. The parameters associated with this interaction are the maximal production rate $\\alpha_B$, the dissociation constant $K_A$, and the Hill coefficient $n_A$. The rate of production for $B$ is:\n$$\n\\text{Rate of Production of } B = \\alpha_B \\cdot f_{rep}(A) = \\frac{\\alpha_B}{1 + (A/K_A)^{n_A}}\n$$\nThe loss term is $\\delta_B B$. Therefore, the second ODE is:\n$$\n\\frac{dB}{dt} = \\frac{\\alpha_B}{1 + (A/K_A)^{n_A}} - \\delta_B B\n$$\n\nWe have thus derived the complete system of coupled nonlinear ODEs that governs the genetic toggle switch:\n$$\n\\begin{cases}\n\\frac{dA}{dt} = \\frac{\\alpha_A}{1 + (B/K_B)^{n_B}} - \\delta_A A \\\\\n\\frac{dB}{dt} = \\frac{\\alpha_B}{1 + (A/K_A)^{n_A}} - \\delta_B B\n\\end{cases}\n$$\nThis system must be solved numerically. The computational protocol requires us to integrate these equations for each parameter set from two distinct initial conditions: $I_1$ with high $A$ and low $B$, and $I_2$ with low $A$ and high $B$. The system is integrated for a sufficiently long time, $T_{\\max} = 500$, to allow it to reach a steady state.\n\nThe existence of one or two stable steady states (monostability vs. bistability) is determined by comparing the final states reached from $I_1$ and $I_2$. Let the final state vector from $I_1$ be $(A_1, B_1)$ and from $I_2$ be $(A_2, B_2)$. We compute the Euclidean distance $d = \\sqrt{(A_1 - A_2)^2 + (B_1 - B_2)^2}$. If this distance $d$ is greater than or equal to a threshold $\\tau = 5$, we conclude that the system is bistable and has converged to two distinct stable states. Otherwise, we conclude it is monostable. This procedure is performed for each case in the provided test suite. A stiff-capable ODE solver is appropriate, as the timescales of the system can be disparate, particularly during switching events.", "answer": "[2,1,1,1]", "id": "2755952"}]}