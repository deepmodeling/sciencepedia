{"hands_on_practices": [{"introduction": "Before analyzing sequence content, we must first ensure our sequencing experiment has generated enough data to cover the entire target region. This practice introduces a foundational concept in genomics, modeling read distribution to determine the probability of coverage gaps [@problem_id:2754129]. By deriving the relationship between mean coverage depth ($C$), construct length ($L$), and the risk of leaving bases uncovered, you will gain a quantitative understanding of how to plan a successful sequencing experiment for complete sequence verification.", "problem": "A synthetic biology lab must verify a de novo assembled DNA construct of length $L$ base pairs using Next-Generation Sequencing (NGS). Assume the library preparation and sequencing produce reads of fixed length $\\ell$ base pairs, and read starts along the target follow a homogeneous Poisson point process with rate $\\lambda$ per base. Define the mean coverage depth as $C=\\lambda \\ell$. Ignore end effects (assume $L \\gg \\ell$ so that edge corrections are negligible).\n\nTasks:\n1. Starting only from the defining properties of the Poisson point process (the number of events in any interval of length $x$ is Poisson-distributed with mean $\\lambda x$, and disjoint intervals are independent), derive an expression for the probability that a particular base is not covered by any read, expressed in terms of $C$.\n2. Let $\\delta$ be a user-specified family-wise risk tolerance for leaving at least one base in the entire target uncovered. Without assuming independence of coverage events across different bases, derive a rigorous lower bound on $C$ that guarantees the probability that at least one base among the $L$ bases is uncovered is strictly less than $\\delta$. Express your bound on $C$ in closed form in terms of $L$ and $\\delta$.\n3. Evaluate your bound numerically for $L=10^{5}$ and $\\delta=10^{-6}$. Report the minimal $C$ that satisfies the bound as a pure number (dimensionless). Round your answer to four significant figures.", "solution": "The problem proposed is scientifically grounded, well-posed, objective, and contains sufficient information for a rigorous solution. It is a standard problem in bioinformatics, often known as the Lander-Waterman model for sequencing. We shall proceed with the derivation.\n\n### Part 1: Probability of a Base Being Uncovered\n\nWe are asked to derive the probability that a specific base is not covered by any read. Let us consider an arbitrary base at a specific genomic coordinate. For this base to be covered by a read of length $\\ell$, the read must begin at a position such that the base falls within the span of the read. If the base is at position $x$, a read starting at position $s$ will cover it if and only if $s \\le x < s + \\ell$. This is equivalent to the condition that the read must start within the interval $(x-\\ell, x]$.\n\nThe problem states that read start sites are governed by a homogeneous Poisson point process with a rate of $\\lambda$ starts per base pair. The assumption $L \\gg \\ell$ allows us to ignore end effects, meaning we can treat this interval of length $\\ell$ as if it were not near the ends of the construct.\n\nAccording to the definition of a Poisson process, the number of events (read starts) occurring in any interval of a given length is a random variable following a Poisson distribution. The mean of this distribution is the product of the rate $\\lambda$ and the length of the interval. For the interval $(x-\\ell, x]$, the length is $\\ell$. Therefore, the number of reads, let us call this random variable $N$, that start in this specific interval follows a Poisson distribution with mean $\\lambda \\ell$.\n\nThe problem defines the mean coverage depth as $C = \\lambda \\ell$. Thus, $N \\sim \\text{Poisson}(C)$. The probability mass function for $N$ is given by:\n$$P(N=k) = \\frac{\\exp(-C) C^k}{k!}$$\nwhere $k$ is a non-negative integer.\n\nA specific base is not covered if and only if there are zero read starts in the corresponding interval of length $\\ell$. This corresponds to the event $N=0$. We can calculate this probability by setting $k=0$ in the probability mass function:\n$$P(\\text{base is not covered}) = P(N=0) = \\frac{\\exp(-C) C^0}{0!}$$\nRecalling that $C^0=1$ and $0!=1$, we obtain the probability that a particular base is not covered:\n$$P(\\text{base is not covered}) = \\exp(-C)$$\n\n### Part 2: Lower Bound on Mean Coverage Depth\n\nWe are tasked with finding a lower bound for the mean coverage depth $C$ that ensures the probability of leaving at least one base uncovered across the entire construct of length $L$ is strictly less than a specified tolerance $\\delta$.\n\nLet $E_i$ be the event that the $i$-th base (for $i=1, 2, \\dots, L$) is not covered by any read. The event that \"at least one base is uncovered\" is the union of all such events for all bases in the construct: $\\bigcup_{i=1}^{L} E_i$. We require that the probability of this union event is less than $\\delta$:\n$$P\\left(\\bigcup_{i=1}^{L} E_i\\right) < \\delta$$\n\nThe problem correctly mandates that we do not assume independence between the events $E_i$. The coverage status of adjacent bases is correlated. For example, if base $i$ is not covered, it implies no reads started in the interval $(i-\\ell, i]$. This in turn affects the probability that base $i+1$ is not covered, as the interval for its potential covering reads, $(i+1-\\ell, i+1]$, largely overlaps with the first interval.\n\nTo handle this dependency, we employ the union bound, also known as Boole's inequality. For any collection of events $E_1, E_2, \\dots, E_L$, the inequality states:\n$$P\\left(\\bigcup_{i=1}^{L} E_i\\right) \\le \\sum_{i=1}^{L} P(E_i)$$\n\nFrom Part 1, we established that for any single base $i$, the probability of it being uncovered is $P(E_i) = \\exp(-C)$. Since we are ignoring end effects, this probability is uniform for all bases from $i=1$ to $L$. Applying this to the sum in the union bound:\n$$\\sum_{i=1}^{L} P(E_i) = \\sum_{i=1}^{L} \\exp(-C) = L \\exp(-C)$$\n\nCombining these results, we have an upper bound on the probability of interest:\n$$P(\\text{at least one base uncovered}) \\le L \\exp(-C)$$\n\nTo satisfy the condition $P(\\text{at least one base uncovered}) < \\delta$, it is sufficient to enforce the stricter condition that its upper bound is less than $\\delta$:\n$$L \\exp(-C) < \\delta$$\n\nWe can now solve this inequality for $C$ to find the required lower bound.\n$$\\exp(-C) < \\frac{\\delta}{L}$$\nTaking the natural logarithm of both sides:\n$$-C < \\ln\\left(\\frac{\\delta}{L}\\right)$$\nMultiplying by $-1$ reverses the inequality sign:\n$$C > -\\ln\\left(\\frac{\\delta}{L}\\right)$$\nUsing the property of logarithms $-\\ln(x) = \\ln(1/x)$, we arrive at the final expression for the lower bound on $C$:\n$$C > \\ln\\left(\\frac{L}{\\delta}\\right)$$\nThis provides a rigorous lower bound that guarantees the family-wise error rate for coverage gaps is below the tolerance $\\delta$.\n\n### Part 3: Numerical Evaluation\n\nFinally, we are asked to evaluate this bound for the given parameters: a construct length $L=10^5$ base pairs and a risk tolerance $\\delta=10^{-6}$.\n\nUsing the derived inequality, the minimal coverage depth $C$ must satisfy:\n$$C > \\ln\\left(\\frac{10^5}{10^{-6}}\\right)$$\n$$C > \\ln(10^{5 - (-6)})$$\n$$C > \\ln(10^{11})$$\nUsing the logarithm property $\\ln(x^a) = a \\ln(x)$:\n$$C > 11 \\ln(10)$$\nThe value of the natural logarithm of $10$ is approximately $\\ln(10) \\approx 2.30258509...$.\n$$C > 11 \\times 2.30258509...$$\n$$C > 25.328436...$$\nThe problem asks for the minimal $C$ that satisfies the bound, rounded to four significant figures. Rounding the numerical result $25.328436...$ to four significant figures gives $25.33$. Therefore, a mean coverage depth of at least $25.33$ is required to meet the specified verification criteria under this model.", "answer": "$$\\boxed{25.33}$$", "id": "2754129"}, {"introduction": "Complete coverage is necessary but not sufficient for all verification tasks, especially when verifying constructs in a mixed population or searching for rare mosaic edits. This exercise moves from the question of coverage to the challenge of detection, using a simple but powerful binomial model to quantify the probability of missing a low-frequency variant [@problem_id:2754073]. Mastering this calculation, which relates sequencing depth ($n$) to variant frequency ($f$), is essential for designing experiments with adequate statistical power and for interpreting the absence of a variant in your data.", "problem": "A synthetic biology team is verifying a pooled plasmid library using next-generation sequencing (NGS). A particular variant is present in the mixed population at an unknown frequency, which for the purpose of this analysis is modeled as a fixed fraction $f$ with $0<f<1$. The sequencing process samples $n$ independent reads that cover the locus of interest, and for this question you may assume reads are error-free and each read is an independent Bernoulli sample from the population, where a “success” means the read carries the variant and occurs with probability $f$. The team wants to quantify the probability that the variant is completely missed in the sequencing data and also to plan the sequencing depth needed to limit this miss probability.\n\nStarting only from the definitions of independent Bernoulli trials and the binomial model for the number of successes in $n$ independent trials with success probability $f$, do the following:\n- Derive the probability that the variant is missed (no successes observed) when sequencing at depth $n$, and show that it reduces to a function of $f$ and $n$.\n- Given a target miss probability $\\delta$ with $0<\\delta<1$, derive a closed-form expression for the minimal real-valued sequencing depth $n^{\\ast}$ such that the miss probability equals $\\delta$ under the assumptions above.\n\nReport $n^{\\ast}$ as a closed-form analytic expression in terms of $f$ and $\\delta$. Do not round your answer. No units are required in the final expression.", "solution": "The problem as stated is subjected to validation and is found to be scientifically sound, well-posed, and internally consistent. It presents a standard, albeit simplified, model for an important problem in quantitative molecular biology. We may therefore proceed with a formal derivation.\n\nLet the random variable $X$ denote the number of reads that carry the variant of interest out of a total of $n$ independent sequence reads. According to the problem statement, each read is an independent Bernoulli trial. The probability of success, which is defined as observing the variant in a single read, is given as the variant's frequency, $f$.\n\nThe total number of successes, $X$, in $n$ independent Bernoulli trials with a constant success probability $f$ follows a binomial distribution. We write this as $X \\sim \\text{Binomial}(n, f)$. The probability mass function (PMF) for this distribution gives the probability of observing exactly $k$ successes in $n$ trials:\n$$P(X=k) = \\binom{n}{k} f^k (1-f)^{n-k}$$\nwhere $k$ is an integer such that $0 \\le k \\le n$, and $\\binom{n}{k} = \\frac{n!}{k!(n-k)!}$ is the binomial coefficient.\n\nThe first task is to derive the probability that the variant is completely missed. This event corresponds to observing zero successes, i.e., $k=0$. We substitute $k=0$ into the binomial PMF:\n$$P(X=0) = \\binom{n}{0} f^0 (1-f)^{n-0}$$\nBy definition, $\\binom{n}{0} = \\frac{n!}{0!(n-0)!} = \\frac{n!}{1 \\cdot n!} = 1$. Also, any non-zero number raised to the power of $0$ is $1$, so $f^0=1$ since $f>0$.\nTherefore, the probability of missing the variant, which we can denote $P_{\\text{miss}}(n, f)$, is:\n$$P_{\\text{miss}}(n, f) = P(X=0) = 1 \\cdot 1 \\cdot (1-f)^n = (1-f)^n$$\nThis expression is indeed a function only of the variant frequency $f$ and the sequencing depth $n$, as required. This completes the first part of the derivation.\n\nThe second task is to find a closed-form expression for the minimal real-valued sequencing depth, which we shall call $n^{\\ast}$, that results in a specified miss probability $\\delta$. The problem states we must find the depth where the miss probability *equals* $\\delta$. We set our derived expression for the miss probability equal to the target value $\\delta$:\n$$(1-f)^{n^{\\ast}} = \\delta$$\nTo solve for $n^{\\ast}$, we must isolate it from the exponent. The standard method for this is to apply the logarithm function to both sides of the equation. We will use the natural logarithm, denoted $\\ln$.\n$$\\ln\\left((1-f)^{n^{\\ast}}\\right) = \\ln(\\delta)$$\nUsing the fundamental logarithmic identity $\\ln(a^b) = b \\ln(a)$, we obtain:\n$$n^{\\ast} \\ln(1-f) = \\ln(\\delta)$$\nTo isolate $n^{\\ast}$, we divide both sides by $\\ln(1-f)$. We must ensure this denominator is not zero. The problem specifies $0 < f < 1$, which implies $0 < 1-f < 1$. For any value $x$ in the interval $(0, 1)$, its natural logarithm $\\ln(x)$ is defined and is strictly negative. Thus, $\\ln(1-f)$ is a non-zero, negative real number, and division is a valid operation.\n$$n^{\\ast} = \\frac{\\ln(\\delta)}{\\ln(1-f)}$$\nThis is the closed-form analytic expression for the real-valued sequencing depth $n^{\\ast}$ in terms of the parameters $f$ and $\\delta$. It is worth noting that since $0 < \\delta < 1$, $\\ln(\\delta)$ is also negative. The ratio of two negative numbers is positive, which is consistent with the physical meaning of sequencing depth. For practical applications where sequencing depth must be an integer, one would typically calculate $n = \\lceil n^{\\ast} \\rceil$ to ensure the miss probability is *at most* $\\delta$. However, the problem specifically asks for the real-valued $n^{\\ast}$ where equality holds, and this is the derived result.", "answer": "$$\\boxed{\\frac{\\ln(\\delta)}{\\ln(1-f)}}$$", "id": "2754073"}, {"introduction": "The ultimate challenge in high-sensitivity sequence verification is distinguishing true, low-frequency variants from the background noise of PCR and sequencing errors. This final practice integrates several advanced concepts into a single, powerful statistical framework to make this distinction with confidence [@problem_id:2754083]. You will construct a likelihood ratio test that combines empirical data, such as Phred scores ($Q$) and Unique Molecular Identifier (UMI) family information, to rigorously test the hypothesis of a true mosaic edit against the null hypothesis of error-only observations.", "problem": "A synthetic biology laboratory uses Next-Generation Sequencing (NGS) with Unique Molecular Identifiers (UMIs) to verify sequence edits that may be present as true low-frequency (mosaic) variants in a clonal cell population. Each original molecule receives a Unique Molecular Identifier (UMI) prior to amplification. Sequencing reads are grouped by UMI into families of size $r$, and a UMI-family consensus is called “edited” (variant) if at least $m$ reads in the family support the same alternate base at a specific target position.\n\nYou are given the following experimental context and definitions to construct a likelihood ratio hypothesis test that distinguishes true mosaic edits from Polymerase Chain Reaction (PCR) and sequencing errors, using UMI-family consensus and per-read quality metrics. Use only the base definitions provided here as your starting point.\n\nFundamental base and assumptions:\n1. Phred quality score definition: a base with Phred score $Q$ has a per-base sequencing error probability $p_{s}$ given by $p_{s} = 10^{-Q/10}$.\n2. In the absence of context biases, when a sequencing error occurs, it is equally likely to be any of the three incorrect nucleotides, so the probability of a specific incorrect alternate base due to sequencing is $p_{s}/3$.\n3. PCR error modeling after UMI tagging (errors introduced post-UMI): assume $C$ perfect-doubling PCR cycles, a per-base per-cycle polymerase error rate $\\epsilon_{p}$, and that a single-base error introduced in cycle $c$ is propagated to a fraction $2^{-(C - c)}$ of final amplicons. The expected fraction of final amplicons carrying an error at the site is then $\\sum_{c=1}^{C} \\epsilon_{p} 2^{-(C - c)} = 2 \\epsilon_{p} \\left(1 - 2^{-C}\\right)$. Assuming equal distribution among the three non-true bases, the probability that a read exhibits a specific incorrect alternate base due to PCR is $\\frac{2 \\epsilon_{p} \\left(1 - 2^{-C}\\right)}{3}$.\n4. Independence approximation: conditional on the true state of a UMI family (edited or unedited), per-read error events occur independently across reads in the family. A UMI-family consensus is called variant if at least $m$ reads show the same alternate base; otherwise it is called reference.\n\nHypotheses:\n- Null hypothesis $\\mathcal{H}_{0}$: no true edits exist in the population (mosaic fraction $f = 0$); all observed variant-supporting reads arise from sequencing and PCR errors.\n- Alternative hypothesis $\\mathcal{H}_{1}$: a nonzero mosaic fraction $f \\in (0,1]$ of UMI families derive from truly edited molecules.\n\nUnder $\\mathcal{H}_{0}$ (unedited molecules), the per-read probability of observing the specific alternate base at the target position is\n$$\np_{0} \\;=\\; \\frac{p_{s}}{3} \\;+\\; \\frac{2 \\epsilon_{p} \\left(1 - 2^{-C}\\right)}{3}.\n$$\nThe per-family probability of a variant consensus under $\\mathcal{H}_{0}$ is\n$$\n\\pi_{0} \\;=\\; \\sum_{k=m}^{r} \\binom{r}{k} p_{0}^{k} \\left(1 - p_{0}\\right)^{r-k}.\n$$\n\nUnder $\\mathcal{H}_{1}$, for a truly edited UMI family the true base at the site is the alternate base; a read remains the alternate base unless an error flips it to one of the other three nucleotides. Approximating independence of sequencing and PCR errors and neglecting higher-order products, the per-read probability to remain the alternate base is\n$$\nq_{1} \\;\\approx\\; 1 \\;-\\; p_{s} \\;-\\; 2 \\epsilon_{p} \\left(1 - 2^{-C}\\right),\n$$\nso the per-family probability of a variant consensus among edited families is\n$$\n\\pi_{1} \\;=\\; \\sum_{k=m}^{r} \\binom{r}{k} q_{1}^{k} \\left(1 - q_{1}\\right)^{r-k}.\n$$\nIf a fraction $f$ of families are truly edited and $1-f$ are unedited, the marginal per-family probability of a variant consensus is\n$$\n\\pi(f) \\;=\\; f \\,\\pi_{1} \\;+\\; (1-f) \\,\\pi_{0}.\n$$\n\nData:\n- Number of UMI families: $N = 1000$.\n- Family size: $r = 5$.\n- Consensus threshold: $m = 4$.\n- Number of observed variant-consensus families: $X = 6$.\n- Median base quality at the site: $Q = 35$.\n- PCR cycles: $C = 20$.\n- Per-base per-cycle polymerase error: $\\epsilon_{p} = 1.0 \\times 10^{-6}$.\n\nTasks:\n1. Using the definitions above, derive expressions for $p_{0}$, $\\pi_{0}$, $q_{1}$, and $\\pi_{1}$ in terms of the given parameters.\n2. Treating $X$ as a realization from a Binomial distribution with success probability $\\pi(f)$, construct the likelihood ratio test statistic\n$$\n\\Lambda \\;=\\; \\frac{L\\!\\left(f=0\\right)}{\\displaystyle \\max_{f \\in [0,1]} L(f)},\n$$\nand express the test statistic in the asymptotically $\\chi^2$ convenient form $-2 \\ln \\Lambda$ by profiling over $f$.\n3. Evaluate $-2 \\ln \\Lambda$ numerically for the provided data, using the maximum likelihood estimate $\\hat{f}$ under $\\mathcal{H}_{1}$. You may leave intermediate steps symbolically, but the final reported value must be a single unitless number. Round your answer to four significant figures.", "solution": "The problem requires the construction and evaluation of a likelihood ratio test to distinguish true low-frequency genetic variants from process errors in a Next-Generation Sequencing (NGS) experiment utilizing Unique Molecular Identifiers (UMIs). The problem is scientifically grounded, well-posed, and all necessary parameters for its solution are provided. We shall proceed with the derivation and calculation as requested.\n\nThe analysis is structured into three parts as dictated by the problem statement.\n\nFirst, we derive the expressions for the error probabilities and consensus probabilities from the given fundamental principles.\nLet $Q$ be the Phred quality score. The probability of a sequencing error at a given base is $p_{s} = 10^{-Q/10}$. Assuming an error is equally likely to result in any of the three incorrect bases, the probability of a specific incorrect alternate base appearing due to sequencing error is $\\frac{p_{s}}{3}$.\nThe polymerase chain reaction (PCR) introduces errors with a per-base per-cycle rate of $\\epsilon_{p}$ over $C$ cycles. The expected fraction of amplicons carrying a specific alternate base due to PCR error is given as $\\frac{2 \\epsilon_{p} (1 - 2^{-C})}{3}$.\n\nUnder the null hypothesis $\\mathcal{H}_{0}$, the molecule is unedited (wild-type). An observed alternate base must be the result of an error. Assuming sequencing and PCR errors are independent and their probabilities are small, the total probability, $p_{0}$, of observing a specific alternate base in a single read is the sum of their individual probabilities:\n$$\np_{0} = \\frac{p_{s}}{3} + \\frac{2 \\epsilon_{p} \\left(1 - 2^{-C}\\right)}{3}\n$$\nA UMI family of size $r$ is called \"variant\" if at least $m$ reads support the alternate base. Conditional on the molecule being unedited, the number of reads supporting the alternate base, $k$, follows a binomial distribution with $r$ trials and success probability $p_{0}$. The probability of a variant consensus under $\\mathcal{H}_{0}$, denoted $\\pi_{0}$, is the probability that $k \\ge m$:\n$$\n\\pi_{0} = P(k \\ge m) = \\sum_{k=m}^{r} \\binom{r}{k} p_{0}^{k} \\left(1 - p_{0}\\right)^{r-k}\n$$\nUnder the alternative hypothesis $\\mathcal{H}_{1}$, for a UMI family derived from a truly edited molecule, the correct base is the alternate base. A read will show this correct alternate base unless an error flips it to one of the other three bases. The probability of a sequencing error is $p_{s}$, and the expected fraction of molecules with a PCR error is $2\\epsilon_{p}(1-2^{-C})$. The probability, $q_{1}$, that a read correctly shows the alternate base is one minus the sum of these error probabilities:\n$$\nq_{1} \\approx 1 - p_{s} - 2 \\epsilon_{p} \\left(1 - 2^{-C}\\right)\n$$\nFor such an edited family, the number of reads supporting the alternate base follows a binomial distribution with $r$ trials and success probability $q_{1}$. The probability of a variant consensus, $\\pi_{1}$, is the probability that $k \\ge m$:\n$$\n\\pi_{1} = P(k \\ge m) = \\sum_{k=m}^{r} \\binom{r}{k} q_{1}^{k} \\left(1 - q_{1}\\right)^{r-k}\n$$\nThis completes the derivation of the required probability expressions.\n\nSecond, we construct the likelihood ratio test statistic.\nThe observation is $X$, the number of UMI families with a variant consensus out of a total of $N$ families. Let $f$ be the true fraction of edited molecules. The probability of any single family having a variant consensus is $\\pi(f) = f \\pi_{1} + (1-f) \\pi_{0}$. The number of observed variant families $X$ is modeled as a draw from a binomial distribution $X \\sim \\text{Binomial}(N, \\pi(f))$. The likelihood function is:\n$$\nL(f) = \\binom{N}{X} [\\pi(f)]^{X} [1 - \\pi(f)]^{N-X}\n$$\nThe likelihood ratio test statistic is $\\Lambda = \\frac{L(\\mathcal{H}_{0})}{\\sup_{\\mathcal{H}_{1}} L(f)}$. Under $\\mathcal{H}_{0}$, $f=0$, so the numerator is $L(0) = \\binom{N}{X} \\pi_{0}^{X} (1 - \\pi_{0})^{N-X}$.\nThe denominator is the maximized likelihood over the parameter space $f \\in [0,1]$. The likelihood is maximized when $\\pi(f)$ is equal to its maximum likelihood estimate (MLE), which for a binomial distribution is the sample proportion, $\\hat{\\pi} = X/N$. So, $\\max_{f \\in [0,1]} L(f) = L(\\hat{f})$, where $\\hat{f}$ is the value of $f$ that yields $\\pi(\\hat{f}) = X/N$. This gives $\\hat{f} = \\frac{X/N - \\pi_0}{\\pi_1 - \\pi_0}$. Provided $0 \\le \\hat{f} \\le 1$, the maximized likelihood is:\n$$\n\\sup_{f \\in [0,1]} L(f) = \\binom{N}{X} \\left(\\frac{X}{N}\\right)^{X} \\left(1 - \\frac{X}{N}\\right)^{N-X}\n$$\nThe likelihood ratio is therefore:\n$$\n\\Lambda = \\frac{\\binom{N}{X} \\pi_{0}^{X} (1 - \\pi_{0})^{N-X}}{\\binom{N}{X} (X/N)^{X} (1 - X/N)^{N-X}} = \\left(\\frac{\\pi_{0}}{X/N}\\right)^{X} \\left(\\frac{1 - \\pi_{0}}{1 - X/N}\\right)^{N-X}\n$$\nThe test statistic is usually expressed in the asymptotically $\\chi^2$-distributed form $-2 \\ln \\Lambda$:\n$$\n-2 \\ln \\Lambda = -2 \\left[ X \\ln\\left(\\frac{\\pi_{0}}{X/N}\\right) + (N-X) \\ln\\left(\\frac{1 - \\pi_{0}}{1 - X/N}\\right) \\right]\n$$\nThis can be rewritten for clarity as:\n$$\n-2 \\ln \\Lambda = 2 \\left[ X \\ln\\left(\\frac{X/N}{\\pi_{0}}\\right) + (N-X) \\ln\\left(\\frac{1 - X/N}{1 - \\pi_{0}}\\right) \\right]\n$$\nThis is the required expression. It is equivalent to the G-test statistic for goodness-of-fit, comparing observed frequencies ($X, N-X$) to expected frequencies under $\\mathcal{H}_{0}$ ($N\\pi_0, N(1-\\pi_0)$).\n\nThird, we evaluate $-2 \\ln \\Lambda$ numerically using the provided data: $N = 1000$, $r = 5$, $m = 4$, $X = 6$, $Q = 35$, $C = 20$, and $\\epsilon_{p} = 1.0 \\times 10^{-6}$.\n\n1.  Calculate $p_s$:\n    $p_{s} = 10^{-Q/10} = 10^{-35/10} = 10^{-3.5} \\approx 3.162278 \\times 10^{-4}$.\n\n2.  Calculate the PCR error component:\n    $2 \\epsilon_{p} (1 - 2^{-C}) = 2 \\times 10^{-6} (1 - 2^{-20}) \\approx 2 \\times 10^{-6} (1 - 9.5367 \\times 10^{-7}) \\approx 1.999998 \\times 10^{-6}$.\n\n3.  Calculate $p_0$:\n    $p_{0} = \\frac{1}{3} \\left[ p_{s} + 2 \\epsilon_{p} (1 - 2^{-C}) \\right] \\approx \\frac{1}{3} (3.162278 \\times 10^{-4} + 1.999998 \\times 10^{-6}) \\approx \\frac{3.182278 \\times 10^{-4}}{3} \\approx 1.060759 \\times 10^{-4}$.\n\n4.  Calculate $\\pi_0$:\n    $\\pi_{0} = \\sum_{k=4}^{5} \\binom{5}{k} p_{0}^{k} (1 - p_{0})^{5-k} = \\binom{5}{4}p_{0}^{4}(1-p_{0}) + \\binom{5}{5}p_{0}^{5} = p_{0}^{4}(5(1-p_{0}) + p_{0}) = p_{0}^{4}(5 - 4p_{0})$.\n    Given $p_{0}$ is very small, $\\pi_0 \\approx 5 p_{0}^{4}$.\n    $\\pi_{0} \\approx 5 \\times (1.060759 \\times 10^{-4})^{4} \\approx 5 \\times (1.26296 \\times 10^{-16}) \\approx 6.3148 \\times 10^{-16}$.\n\n5.  Calculate the components of the test statistic:\n    The observed proportion of variant families is $\\hat{p} = X/N = 6/1000 = 0.006$.\n    Since $\\hat{p} \\gg \\pi_0$, the MLE for $f$ is positive and the formula for $-2 \\ln \\Lambda$ is applicable.\n\n    The first term inside the brackets is $X \\ln(\\frac{X/N}{\\pi_{0}})$.\n    $\\frac{X/N}{\\pi_{0}} \\approx \\frac{0.006}{6.3148 \\times 10^{-16}} \\approx 9.5015 \\times 10^{12}$.\n    $\\ln(9.5015 \\times 10^{12}) \\approx 29.882$.\n    $X \\ln(\\frac{X/N}{\\pi_{0}}) \\approx 6 \\times 29.882 = 179.292$.\n\n    The second term is $(N-X) \\ln(\\frac{1-X/N}{1-\\pi_0})$. Since $\\pi_0$ is negligible compared to $1$, this is approximately $(N-X) \\ln(1-X/N)$.\n    $(1000 - 6) \\ln(1 - 0.006) = 994 \\ln(0.994) \\approx 994 \\times (-0.0060181) \\approx -5.982$.\n\n6.  Calculate the final value:\n    $-2 \\ln \\Lambda = 2 \\times (179.292 - 5.982) = 2 \\times 173.31 = 346.62$.\n\nRounding to four significant figures, the final value is $346.6$. This extremely large value for a $\\chi^2$ statistic with one degree of freedom indicates that the null hypothesis ($\\mathcal{H}_{0}$) is rejected with very high confidence.\n\nFinal calculation with higher precision:\n$p_0 \\approx 1.0607592 \\times 10^{-4}$.\n$\\pi_0 \\approx 6.314220 \\times 10^{-16}$.\n$-2 \\ln \\Lambda = 2 \\left[ 6 \\ln\\left(\\frac{0.006}{6.314220 \\times 10^{-16}}\\right) + 994 \\ln\\left(\\frac{0.994}{1 - 6.314220 \\times 10^{-16}}\\right) \\right]$\n$= 2 \\left[ 6 \\times \\ln(9.50236 \\times 10^{12}) + 994 \\times \\ln(0.994000...) \\right]$\n$= 2 \\left[ 6 \\times 29.88257 + 994 \\times (-0.0060181) \\right]$\n$= 2 \\left[ 179.2954 - 5.9820 \\right] = 2 \\times 173.3134 = 346.6268$.\n\nRounding to four significant figures yields $346.6$.", "answer": "$$\\boxed{346.6}$$", "id": "2754083"}]}