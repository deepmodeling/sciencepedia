{"hands_on_practices": [{"introduction": "Understanding complex biological networks often begins with dissecting the function of individual components. This exercise [@problem_id:2862403] challenges you to predict the phenotypic consequences of deleting a key gene, *sulA*, from the bacterial SOS response pathway. By carefully considering the distinct roles of cell cycle arrest and translesion synthesis, you will practice the critical skill of linking molecular mechanisms to observable outcomes in survival and mutagenesis.", "problem": "You are studying the effects of the bacterial SOS response on survival and mutagenesis after DNA damage. Two isogenic Escherichia coli strains are compared: a wild-type strain and a strain with a precise deletion of *sulA* (denoted as $\\Delta \\mathrm{sulA}$), with all other SOS components intact (including *recA*, *lexA*, *umuDC*, and *dinB*). Ultraviolet (UV) irradiation is applied at a dose sufficient to induce the SOS response but not so high as to sterilize the population. After a recovery period in rich medium, you quantify survival as the fraction of viable cells that form colonies, defined as $S \\equiv N_{\\mathrm{CFU,post}}/N_{\\mathrm{CFU,pre}}$, where $N_{\\mathrm{CFU}}$ denotes colony-forming units (CFU). You quantify mutation frequency as the fraction of viable cells that become resistant to rifampicin, defined as $M \\equiv N_{\\mathrm{Rif}^R}/N_{\\mathrm{viable}}$.\n\nUse the following foundational facts as the starting point for your reasoning: UV induces pyrimidine dimers that block the replicative deoxyribonucleic acid (DNA) polymerase; single-stranded DNA at stalled forks activates RecA to a coprotease state that promotes autocleavage of the LexA repressor, derepressing the SOS regulon; the SOS regulon includes genes for nucleotide excision repair (for example, *uvrA* and *uvrB*), error-prone translesion DNA synthesis (TLS) polymerases (for example, *umuDC* encoding DNA polymerase V and *dinB* encoding DNA polymerase IV), and *sulA*, which encodes a cell division inhibitor that binds FtsZ to inhibit cytokinesis. Assume that TLS polymerases, when engaged, elevate mutation frequency due to reduced fidelity, and that SulA’s principal role is inhibition of cell division (and not direct regulation of DNA repair).\n\nWhich of the following best predicts the phenotypic consequences in the $\\Delta \\mathrm{sulA}$ strain relative to wild type after UV irradiation?\n\nA. $S$ increases and $M$ decreases, because continued cell division reduces reliance on error-prone translesion synthesis.\n\nB. $S$ decreases but $M$ remains approximately unchanged (per viable cell), because loss of division inhibition reduces survival whereas mutagenesis is governed by SOS-induced TLS that is independent of SulA.\n\nC. Both $S$ and $M$ decrease, because SulA is required to induce translesion polymerases.\n\nD. $S$ is unchanged while $M$ increases, because SulA normally inhibits translesion polymerases.\n\nE. Both $S$ and $M$ increase, because SulA normally suppresses induction of SOS genes.", "solution": "The supplied problem statement is subjected to validation before a solution is attempted.\n\n**Step 1: Extraction of Givens**\n- **Strains:** Two isogenic *Escherichia coli* strains: wild-type (WT) and a mutant with a deletion of the *sulA* gene ($\\Delta \\mathrm{sulA}$). Other SOS components (*recA*, *lexA*, *umuDC*, *dinB*) are intact.\n- **Treatment:** Ultraviolet (UV) irradiation at a dose that induces the SOS response without causing sterilization.\n- **Phenotypes measured:**\n  - Survival, $S \\equiv N_{\\mathrm{CFU,post}}/N_{\\mathrm{CFU,pre}}$, where $N_{\\mathrm{CFU}}$ is colony-forming units.\n  - Mutation frequency, $M \\equiv N_{\\mathrm{Rif}^R}/N_{\\mathrm{viable}}$, the fraction of viable cells resistant to rifampicin.\n- **Fundamental Principles:**\n  - UV irradiation causes pyrimidine dimers, blocking the replicative deoxyribonucleic acid (DNA) polymerase.\n  - Stalled replication forks generate single-stranded DNA (ssDNA), which activates RecA.\n  - Activated RecA promotes autocleavage of the LexA repressor, leading to derepression of the SOS regulon.\n  - The SOS regulon includes:\n    - Nucleotide excision repair genes (e.g., *uvrA*, *uvrB*).\n    - Translesion DNA synthesis (TLS) polymerase genes: *umuDC* (DNA polymerase V) and *dinB* (DNA polymerase IV).\n    - *sulA*, which encodes a cell division inhibitor that binds to FtsZ.\n- **Assumptions:**\n  - TLS polymerases increase mutation frequency.\n  - The principal role of SulA is the inhibition of cell division. It does not directly regulate DNA repair.\n\n**Step 2: Validation of Problem Statement**\nThe problem describes a classic experiment in microbial genetics concerning the bacterial SOS response. The stated roles of key genes and proteins—*recA*, *lexA*, *umuDC*, *dinB*, and *sulA*—are consistent with established molecular biology. The experimental design, including the use of a $\\Delta \\mathrm{sulA}$ mutant, UV irradiation, and the measurement of survival and mutation frequency, is standard and scientifically sound. The definitions of $S$ and $M$ are precise and conventional. The problem is well-posed, objective, and internally consistent, relying on verifiable scientific principles. No flaws are identified.\n\n**Step 3: Verdict and Action**\nThe problem statement is valid. A solution will now be derived.\n\n**Derivation of the Solution**\n\nThe problem requires predicting the changes in survival ($S$) and mutation frequency ($M$) in a $\\Delta \\mathrm{sulA}$ strain relative to a wild-type (WT) strain after UV irradiation. This requires analyzing the specific role of the *sulA* gene product within the context of the SOS response.\n\n1.  **Analysis of the Wild-Type (WT) Response:**\n    Upon UV irradiation, DNA damage in the form of pyrimidine dimers stalls DNA replication. The resulting ssDNA at stalled forks activates RecA. Activated RecA facilitates the autocatalytic cleavage of the LexA repressor. This derepresses the entire SOS regulon, leading to the coordinated expression of over $40$ genes.\n    - **Survival ($S$):** Among the induced genes is *sulA*. The SulA protein binds to the FtsZ protein, a tubulin homolog that forms the Z-ring essential for bacterial cytokinesis. This interaction inhibits cell division. The resulting transient cell cycle arrest provides the cell with additional time to repair the DNA damage via pathways like nucleotide excision repair before attempting to segregate its chromosomes. If a cell were to divide with a damaged chromosome, it would risk producing non-viable daughter cells (e.g., one receiving a broken chromosome). Therefore, the SulA-mediated division arrest is a pro-survival mechanism under conditions of DNA damage.\n    - **Mutagenesis ($M$):** The SOS regulon also includes *umuDC* and *dinB*, which encode the error-prone TLS polymerases, DNA Polymerase V (Pol V) and DNA Polymerase IV (Pol IV), respectively. These polymerases are capable of synthesizing DNA across lesions like pyrimidine dimers, which allows for the completion of replication and contributes to survival. However, due to their low fidelity, they are a primary source of mutations. This phenomenon is known as SOS mutagenesis.\n\n2.  **Analysis of the $\\Delta \\mathrm{sulA}$ Mutant Response:**\n    The $\\Delta \\mathrm{sulA}$ strain has the *sulA* gene deleted. The problem states all other SOS components are intact.\n    - **Effect on Survival ($S$):** Following UV irradiation, the SOS response is induced as in the WT. However, since the *sulA* gene is absent, the SulA protein is not produced. Consequently, there is no inhibition of FtsZ and no arrest of cell division. The cells will continue to attempt division despite the presence of unrepaired DNA damage. This attempt to segregate damaged chromosomes leads to a high frequency of lethal events, such as the formation of anucleate cells or cells with fragmented chromosomes (a phenomenon known as \"reckless\" division). This results in a significant reduction in the number of viable cells that can form colonies. Therefore, the survival ($S$) of the $\\Delta \\mathrm{sulA}$ strain will be **decreased** relative to the WT strain.\n    - **Effect on Mutagenesis ($M$):** The mutation frequency $M$ is defined as the number of mutants per *viable* cell ($M \\equiv N_{\\mathrm{Rif}^R}/N_{\\mathrm{viable}}$). The machinery responsible for generating mutations—the TLS polymerases Pol V and Pol IV—is encoded by *umuDC* and *dinB*, which are part of the SOS regulon and are assumed to be induced normally in the $\\Delta \\mathrm{sulA}$ strain. The problem explicitly states that SulA's role is confined to cell division inhibition, not the regulation of DNA repair. Thus, the molecular processes of TLS are not directly affected by the a`bsence of SulA. Any cell in the $\\Delta \\mathrm{sulA}$ population that manages to survive the UV treatment (i.e., is counted as \"viable\") must have successfully repaired its DNA, a process that involved the same SOS-induced TLS polymerases as in a surviving WT cell. The frequency of errors made by these polymerases is independent of SulA. Therefore, the frequency of mutations among the subpopulation of surviving cells should be **approximately unchanged** compared to the WT.\n\n**Conclusion of Derivation:**\nFor the $\\Delta \\mathrm{sulA}$ strain relative to WT:\n- Survival ($S$) is expected to **decrease**.\n- Mutation frequency ($M$) is expected to remain **approximately unchanged**.\n\n**Evaluation of Options**\n\n- **A. $S$ increases and $M$ decreases, because continued cell division reduces reliance on error-prone translesion synthesis.**\nThis is incorrect. $S$ decreases due to lethal segregation. The reasoning that continued division reduces reliance on TLS is also flawed; the need for TLS is dictated by the presence of DNA lesions, not the cell division status. **Incorrect**.\n\n- **B. $S$ decreases but $M$ remains approximately unchanged (per viable cell), because loss of division inhibition reduces survival whereas mutagenesis is governed by SOS-induced TLS that is independent of SulA.**\nThis prediction matches our derivation. $S$ decreases because of lethal cell division events. $M$ is unchanged because the mutation-causing TLS system is independent of *sulA* and the frequency is measured per viable cell. The provided reasoning is also correct. **Correct**.\n\n- **C. Both $S$ and $M$ decrease, because SulA is required to induce translesion polymerases.**\nThis is incorrect. The premise \"SulA is required to induce translesion polymerases\" is factually wrong. SulA is an effector of the SOS response, not a regulator of other SOS genes. The master regulator is the LexA/RecA system. **Incorrect**.\n\n- **D. $S$ is unchanged while $M$ increases, because SulA normally inhibits translesion polymerases.**\nThis is incorrect. $S$ is not unchanged; it decreases significantly. The premise \"SulA normally inhibits translesion polymerases\" is also factually wrong. Its target is FtsZ. **Incorrect**.\n\n- **E. Both $S$ and $M$ increase, because SulA normally suppresses induction of SOS genes.**\nThis is incorrect. $S$ decreases, it does not increase. The premise \"SulA normally suppresses induction of SOS genes\" is false. LexA is the repressor of the SOS regulon; SulA is a product of it. **Incorrect**.", "answer": "$$\\boxed{B}$$", "id": "2862403"}, {"introduction": "Mutational spectra serve as historical records of the DNA damage and repair processes that have occurred within a cell. In this problem [@problem_id:2945691], you will interpret hypothetical mutation data from wild-type and various repair-deficient strains to infer the roles of different repair pathways, such as Nucleotide Excision Repair (NER) and Translesion Synthesis (TLS). This practice will hone your ability to deduce pathway relationships from quantitative data and make predictions about genetic interactions like epistasis.", "problem": "A classic set of observations in the study of deoxyribonucleic acid (DNA) damage and repair after ultraviolet light (UV) exposure is that UV induces bulky lesions, predominantly cyclobutane pyrimidine dimers (CPDs) and pyrimidine-(6-4)-pyrimidone photoproducts, at dipyrimidine sites. Nucleotide Excision Repair (NER) excises such bulky lesions via damage recognition and dual incision, Photoreactivation by Photolyase directly reverses CPDs using visible light, Translesion Synthesis (TLS) polymerases bypass unrepaired lesions at the cost of higher error rates, and Mismatch Repair (MMR) corrects base-base mismatches generated during replication but does not remove bulky photoproducts. A general expectation is that TLS across UV photoproducts yields a characteristic mutation spectrum enriched for $C \\to T$ substitutions at dipyrimidine contexts and tandem $CC \\to TT$ changes.\n\nInvestigators sequenced mutation accumulation lines from a bacterium after mock treatment and after a single UV pulse, sampling wild type and several repair mutants. For each strain, they computed the fraction of base substitutions that are $C \\to T$ at dipyrimidine contexts and the fraction of tandem $CC \\to TT$ double-base substitutions among all called mutations. They also noted whether the total number of mutations per lineage changed substantially. The key observations were:\n\n- Mock-treated wild type showed a baseline spectrum dominated by $G:C \\to A:T$ transitions ($\\approx$ $60\\%$ of substitutions) with $C \\to T$ at dipyrimidines rare ($\\lt$ $5\\%$) and tandem $CC \\to TT$ essentially absent ($\\approx$ $0\\%$).\n- After UV in wild type, the fraction of $C \\to T$ at dipyrimidines rose to $\\approx$ $65\\%$, with tandem $CC \\to TT$ at $\\approx$ $8\\%$.\n- After UV in a photolyase deletion ($\\Delta$phr; Photolyase deficiency), $C \\to T$ at dipyrimidines increased further to $\\approx$ $78\\%$, and tandem $CC \\to TT$ increased to $\\approx$ $15\\%$.\n- After UV in a NER recognition mutant ($\\Delta$uvrA; NER deficiency), $C \\to T$ at dipyrimidines increased to $\\approx$ $82\\%$, and tandem $CC \\to TT$ to $\\approx$ $14\\%$.\n- After UV in a TLS polymerase V mutant ($\\Delta$umuC; TLS deficiency), $C \\to T$ at dipyrimidines decreased to $\\approx$ $24\\%$, and tandem $CC \\to TT$ to $\\approx$ $0\\%$; survivors were markedly fewer (qualitatively, viability reduced), but those that survived had a spectrum depleted of the UV-signature mutations relative to wild type.\n- After UV in a MMR mutant ($\\Delta$mutS; MMR deficiency), the total number of base substitutions per lineage approximately doubled (about $2$-fold), but the fraction of $C \\to T$ at dipyrimidines ($\\approx$ $63\\%$) and tandem $CC \\to TT$ ($\\approx$ $7\\%$) was similar to wild type.\n\nAssume standard definitions: epistasis here refers to the case where double mutants in two components of the same linear pathway show no greater sensitivity than the most sensitive single mutant (i.e., one mutation is epistatic to the other), whereas components acting in parallel or partially redundant pathways typically yield double mutants more sensitive than either single.\n\nWhich option best integrates the spectrum-based inference of the operative pathway with correct predictions of epistasis for double mutants with respect to UV sensitivity?\n\nA. The dominant protective pathway removing UV photoproducts is Nucleotide Excision Repair (NER), while the $C \\to T$ and $CC \\to TT$ signatures arise from Translesion Synthesis (TLS) across unrepaired lesions; therefore, a double mutant in two NER components (e.g., $\\Delta$uvrA $\\Delta$uvrC) will be epistatic for UV sensitivity (no more sensitive than the most sensitive single), whereas a $\\Delta$uvrA $\\Delta$umuC double mutant will be more UV sensitive than either single mutant.\n\nB. Mismatch Repair (MMR) is the dominant pathway shaping the UV-induced spectrum, which primarily reflects cytosine deamination; therefore, a $\\Delta$mutS $\\Delta$umuC double mutant will be epistatic for UV sensitivity, and a $\\Delta$uvrA $\\Delta$uvrC double mutant will be synthetically lethal even without UV.\n\nC. Photoreactivation by Photolyase is the sole relevant repair of UV damage under these conditions; therefore, a $\\Delta$phr $\\Delta$uvrA double mutant will be epistatic for UV sensitivity, and TLS has no detectable role in mutagenesis after UV.\n\nD. Base Excision Repair (BER) acting on CPDs is primarily responsible for removing UV photoproducts; therefore, a double mutant in two BER glycosylases (e.g., $\\Delta$xthA $\\Delta$nei) is epistatic for UV sensitivity, and loss of TLS (e.g., $\\Delta$umuC) should increase, not decrease, the fraction of tandem $CC \\to TT$ mutations among survivors.\n\nSelect the single best option.", "solution": "We proceed from first principles and established observations in DNA repair biology:\n\n- Ultraviolet light (UV) induces bulky lesions, notably cyclobutane pyrimidine dimers (CPDs) and pyrimidine-(6-4)-pyrimidone photoproducts, at dipyrimidine sites. These block replicative polymerases.\n- Nucleotide Excision Repair (NER) recognizes and excises bulky lesions via dual incision, followed by resynthesis. Loss of NER results in persistence of photoproducts into S phase.\n- Photoreactivation by Photolyase directly reverses CPDs using visible light; loss of Photolyase increases CPD persistence but does not affect non-CPD lesions.\n- Translesion Synthesis (TLS) polymerases can bypass unrepaired lesions at the cost of elevated error rates; bypass across UV photoproducts typically yields a characteristic mutation spectrum enriched for $C \\to T$ substitutions at dipyrimidine contexts and tandem $CC \\to TT$ changes.\n- Mismatch Repair (MMR) corrects replication errors (mismatches and small loops) but does not remove bulky photoproducts; its loss increases the retention of replication errors without changing the underlying lesion spectrum.\n- Epistasis in a linear pathway: double mutants in two components of the same pathway are no more sensitive than the most sensitive single mutant (the mutations are epistatic). For parallel or partially redundant pathways, double mutants are typically more sensitive than either single.\n\nInterpretation of the spectra:\n\n- Mock-treated wild type shows baseline $G:C \\to A:T$ transitions and negligible UV signature; this simply sets the baseline.\n- After UV in wild type, the fraction of $C \\to T$ at dipyrimidines is $\\approx$ $65\\%$, with tandem $CC \\to TT$ at $\\approx$ $8\\%$. This is consistent with TLS across UV photoproducts generating the canonical UV signature.\n- After UV in $\\Delta$phr, $C \\to T$ at dipyrimidines is $\\approx$ $78\\%$ and $CC \\to TT$ is $\\approx$ $15\\%$, both increased relative to wild type. Loss of Photolyase increases CPD persistence; therefore more lesions persist to S phase and must be bypassed by TLS, increasing the UV signature. This supports Photolyase as a protective pathway acting in parallel to NER.\n- After UV in $\\Delta$uvrA, $C \\to T$ at dipyrimidines is $\\approx$ $82\\%$ and $CC \\to TT$ is $\\approx$ $14\\%$, representing an even stronger UV signature. Loss of NER allows more photoproducts to persist, again increasing reliance on TLS and thus the UV signature. This supports NER as a dominant protective pathway for bulky UV lesions.\n- After UV in $\\Delta$umuC, $C \\to T$ at dipyrimidines is $\\approx$ $24\\%$ and $CC \\to TT$ is $\\approx$ $0\\%$, i.e., the UV signature is depleted in survivors. This is exactly what is expected if TLS polymerase V (UmuC) is responsible for most UV-induced mutagenesis; without TLS, cells are more sensitive (fewer survivors), and those that do survive have avoided TLS-mediated mutagenesis, thus showing reduced UV-signature mutations.\n- After UV in $\\Delta$mutS, the total number of mutations increases $\\approx$ $2$-fold, but the fraction of $C \\to T$ at dipyrimidines ($\\approx$ $63\\%$) and $CC \\to TT$ ($\\approx$ $7\\%$) remains similar to wild type. This indicates that MMR modulates the overall burden of replication errors but does not determine the UV lesion spectrum, consistent with MMR not removing bulky UV lesions.\n\nFrom these, we infer:\n\n- The dominant protective pathway for UV photoproducts is NER (with Photolyase contributing in parallel where present).\n- The UV-signature mutations ($C \\to T$ at dipyrimidines and $CC \\to TT$) arise from TLS across unrepaired photoproducts.\n- Epistasis predictions:\n  - Two NER components (e.g., UvrA and UvrC) act in the same linear NER pathway; thus $\\Delta$uvrA $\\Delta$uvrC should be epistatic for UV sensitivity (no worse than the more sensitive single, because either defect disables NER).\n  - NER and TLS act in parallel (one removes damage, the other tolerates it). A $\\Delta$uvrA $\\Delta$umuC double mutant should therefore be more UV sensitive than either single, because loss of NER leaves more lesions and loss of TLS removes the bypass route, combining to reduce survival.\n  - Photolyase and NER are also parallel or partially redundant with respect to CPDs; thus a $\\Delta$phr $\\Delta$uvrA double mutant should be more UV sensitive than either single (not epistatic).\n  - MMR and TLS are not in the same linear pathway for handling UV photoproducts; their double mutant should not show classic epistasis for UV sensitivity attributable to a single pathway that removes UV lesions.\n\nOption-by-option analysis:\n\nA. States NER is the dominant protective pathway, and the UV signature arises from TLS. This matches the data: loss of NER or Photolyase increases the UV signature; loss of TLS decreases it. Predicts $\\Delta$uvrA $\\Delta$uvrC epistasis (same pathway) and $\\Delta$uvrA $\\Delta$umuC greater sensitivity than either single (parallel functions). Both predictions are consistent with first principles and the observations. Verdict — Correct.\n\nB. Claims MMR is dominant and the spectrum primarily reflects cytosine deamination. This contradicts the data: $\\Delta$mutS shows a $\\approx$ $2$-fold increase in total mutations but no major change in the UV signature fractions, and UV signature is characteristic of TLS across photoproducts, not bulk deamination. Predicts $\\Delta$mutS $\\Delta$umuC epistasis (implausible, different pathways) and $\\Delta$uvrA $\\Delta$uvrC synthetic lethality without UV (unsupported; loss of NER is not lethal absent DNA damage). Verdict — Incorrect.\n\nC. Claims Photolyase is the sole relevant pathway and TLS has no role. This conflicts with the strong dependence of the UV signature on TLS ($\\Delta$umuC reduces UV-signature mutations to $\\approx$ $0\\%$ tandem $CC \\to TT$) and with NER deficiency increasing the UV signature. Predicts $\\Delta$phr $\\Delta$uvrA epistasis, but Photolyase and NER act in parallel; double mutants are typically more sensitive than either single. Verdict — Incorrect.\n\nD. Claims Base Excision Repair (BER) removes CPDs, which is mechanistically incorrect: BER targets small, non-bulky lesions, not bulky UV photoproducts like CPDs and (6-4) photoproducts. Also predicts that loss of TLS increases the fraction of $CC \\to TT$ among survivors, which is opposite to the observed depletion to $\\approx$ $0\\%$ in $\\Delta$umuC. Verdict — Incorrect.\n\nTherefore, only option A coherently integrates the spectrum-based inference and epistasis predictions.", "answer": "$$\\boxed{A}$$", "id": "2945691"}, {"introduction": "Building on the concept of mutational signatures, this hands-on computational exercise [@problem_id:2753137] moves from interpretation to active decomposition. You are tasked with implementing a numerical method to solve a common problem in genomics: determining the contribution of known mutational processes to an observed mutational spectrum. By solving the non-negative least squares problem $v \\approx S x$, you will gain practical experience in the quantitative analysis that underpins much of modern cancer genomics and evolutionary biology.", "problem": "In synthetic biology, the observed mutational spectrum of a sample is often modeled as a nonnegative linear combination of canonical mutational signatures that reflect underlying mutagenesis processes and DNA repair pathway activities. Under a normalization where each spectrum is represented as relative frequencies over mutation categories, the observation model can be written as $v \\approx S x$, where $v \\in \\mathbb{R}_{\\ge 0}^{m}$ is the observed spectrum, $S \\in \\mathbb{R}_{\\ge 0}^{m \\times n}$ stacks $n$ known nonnegative signature vectors as columns, and $x \\in \\mathbb{R}_{\\ge 0}^{n}$ are unknown nonnegative contributions to be estimated. Assuming additive, approximately Gaussian measurement noise after normalization, the maximum likelihood estimator corresponds to solving the nonnegative least squares problem $\\min_{x \\ge 0} \\| S x - v \\|_{2}$.\n\nYour task is to write a program that, for each of the test cases below, computes the nonnegative least squares estimate $\\hat{x} = \\arg\\min_{x \\ge 0} \\| S x - v \\|_{2}$. Each test case specifies a matrix $S$ and a vector $v$. Your program must solve $\\min_{x \\ge 0} \\| S x - v \\|_{2}$ numerically for each case and return the solution vectors. All inputs below are dimensionally and biologically plausible (nonnegative spectra and signatures). There are no physical units to report; all quantities are unitless, and there are no angles. The final answers should be rounded to $6$ decimal places.\n\nFundamental base you may assume without further proof: linear modeling of mutational spectra $v \\approx S x$ with nonnegativity of $S$, $v$, and $x$; the link between Gaussian noise and least squares; and convexity of the nonnegative least squares problem.\n\nTest suite:\n- Case $1$ (well-conditioned, exact reconstruction). $m = 6$, $n = 3$.\n  - $S_{1} = \\begin{bmatrix}\n  0.6 & 0.1 & 0.05 \\\\\n  0.1 & 0.6 & 0.1 \\\\\n  0.0 & 0.1 & 0.6 \\\\\n  0.2 & 0.0 & 0.1 \\\\\n  0.05 & 0.1 & 0.05 \\\\\n  0.05 & 0.1 & 0.1\n  \\end{bmatrix}$\n  - $v_{1} = \\begin{bmatrix} 0.28 \\\\ 0.24 \\\\ 0.15 \\\\ 0.10 \\\\ 0.06 \\\\ 0.07 \\end{bmatrix}$ (constructed as $S_{1} \\cdot \\begin{bmatrix} 0.4 \\\\ 0.3 \\\\ 0.2 \\end{bmatrix}$).\n- Case $2$ (zero spectrum boundary). $m = 6$, $n = 3$.\n  - $S_{2} = S_{1}$.\n  - $v_{2} = \\begin{bmatrix} 0.0 \\\\ 0.0 \\\\ 0.0 \\\\ 0.0 \\\\ 0.0 \\\\ 0.0 \\end{bmatrix}$.\n- Case $3$ (rank-deficient signatures, multiple optima). $m = 5$, $n = 3$.\n  - $S_{3} = \\begin{bmatrix}\n  0.4 & 0.4 & 0.0 \\\\\n  0.2 & 0.2 & 0.2 \\\\\n  0.1 & 0.1 & 0.4 \\\\\n  0.1 & 0.1 & 0.2 \\\\\n  0.2 & 0.2 & 0.2\n  \\end{bmatrix}$\n  - $v_{3} = \\begin{bmatrix} 0.2 \\\\ 0.2 \\\\ 0.25 \\\\ 0.15 \\\\ 0.2 \\end{bmatrix}$ (constructed as $\\frac{1}{2} c_{1} + \\frac{1}{2} c_{3}$ where $c_{1}$ and $c_{2}$ are identical).\n- Case $4$ (undercomplete for a target outside the cone, positive solution). $m = 3$, $n = 2$.\n  - $S_{4} = \\begin{bmatrix}\n  1.0 & 0.2 \\\\\n  0.2 & 1.0 \\\\\n  0.2 & 0.2\n  \\end{bmatrix}$\n  - $v_{4} = \\begin{bmatrix} 0.2 \\\\ 0.2 \\\\ 1.0 \\end{bmatrix}$.\n- Case $5$ (well-conditioned, different exact mixture). $m = 6$, $n = 3$.\n  - $S_{5} = S_{1}$.\n  - $v_{5} = \\begin{bmatrix} 0.2575 \\\\ 0.31 \\\\ 0.075 \\\\ 0.075 \\\\ 0.065 \\\\ 0.0675 \\end{bmatrix}$ (constructed as $S_{1} \\cdot \\begin{bmatrix} 0.35 \\\\ 0.45 \\\\ 0.05 \\end{bmatrix}$).\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element is itself a list of the estimated contributions $\\hat{x}$ for a test case, in the same order as above, rounded to $6$ decimal places (e.g., $[[\\dots],[\\dots],\\dots]$).", "solution": "The problem presented is a classical problem in numerical optimization known as Nonnegative Least Squares (NNLS). The task is to determine the vector of contributions, $x$, that best explains an observed mutational spectrum, $v$, as a non-negative linear combination of known mutational signatures, which are the columns of a matrix $S$.\n\nThe problem is formally stated as finding the vector $\\hat{x}$ that solves the following optimization problem:\n$$\n\\hat{x} = \\arg\\min_{x \\ge 0} \\| S x - v \\|_{2}\n$$\nHere, $S \\in \\mathbb{R}_{\\ge 0}^{m \\times n}$ is the signature matrix, $v \\in \\mathbb{R}_{\\ge 0}^{m}$ is the observed spectrum vector, and $x \\in \\mathbb{R}_{\\ge 0}^{n}$ is the vector of unknown contributions. The constraint $x \\ge 0$ (element-wise non-negativity) is critical, as negative contributions are biologically meaningless. The objective function is the Euclidean norm, $\\| \\cdot \\|_{2}$, of the residual vector $S x - v$. Minimizing this norm is equivalent to minimizing its square, $\\| S x - v \\|_{2}^{2}$, which is a standard least-squares formulation.\n\nThis optimization problem is a convex optimization problem. The objective function $f(x) = \\| S x - v \\|_{2}^{2}$ is a quadratic function of $x$ and is therefore convex. The feasible set, defined by the non-negativity constraints $\\{x \\in \\mathbb{R}^{n} \\mid x_i \\ge 0 \\text{ for } i=1, \\dots, n\\}$, is a convex set. The minimization of a convex function over a convex set guarantees that any local minimum is also a global minimum. Therefore, a globally optimal solution $\\hat{x}$ always exists.\n\nThe uniqueness of the solution depends on the properties of the matrix $S$. If the columns of $S$ are linearly independent (i.e., $S$ has full column rank), the solution to the NNLS problem is unique. If the columns are linearly dependent, as is explicitly the case in Test Case $3$, there may be an infinite number of solutions that achieve the same minimum residual norm. In such situations, a numerical algorithm will typically return one specific solution from the set of optimal solutions.\n\nA robust and widely-used algorithm for solving the NNLS problem is the active-set method developed by Lawson and Hanson. This iterative algorithm determines which components of the solution vector $x$ should be zero (the \"active set\") and which should be positive, solving an unconstrained least-squares problem for the positive components at each step. This method is guaranteed to converge to a correct solution.\n\nThe specified execution environment permits the use of the `scipy` library. The function `scipy.optimize.nnls` provides an efficient and reliable implementation of the Lawson-Hanson algorithm. Therefore, the strategy will be to utilize this function to solve for $\\hat{x}$ for each of the $5$ provided test cases.\n\nThe procedure for each test case $(S_k, v_k)$ for $k \\in \\{1, 2, 3, 4, 5\\}$ is as follows:\n$1$. Define the matrix $S_k$ and vector $v_k$ using `numpy` arrays.\n$2$. Invoke the `scipy.optimize.nnls(S_k, v_k)` function. This function returns the solution vector $\\hat{x}_k$ and the corresponding residual norm. We only require the solution vector.\n$3$. Per the problem requirements, round each element of the resulting vector $\\hat{x}_k$ to $6$ decimal places.\n$4$. The final results for all test cases will be collected into a single list of lists and formatted into the specified string format.\n\nA brief analysis of the test cases confirms the suitability of this approach:\n- Cases $1$ and $5$ are constructed such that $v = S x_{true}$ where $x_{true}$ is non-negative. As $S_1$ is well-conditioned, the unique NNLS solution must be $\\hat{x} = x_{true}$.\n- Case $2$ involves a zero target vector, $v_2 = 0$. The objective is to minimize $\\|S_2 x\\|_2$ subject to $x \\ge 0$. Since all entries of $S_2$ are non-negative, and its columns are non-zero, the minimum value of $0$ is achieved only at $x=0$.\n- Case $3$ involves a rank-deficient matrix $S_3$, where the first two columns are identical. An infinite number of optimal solutions exist. The `nnls` solver will deterministically find one of them. The provided $v_3$ is an exact combination, so the residual norm of the solution will be zero.\n- Case $4$ is an example where the target vector $v_4$ does not lie in the conic hull of the columns of $S_4$. The NNLS solution will be the projection of $v_4$ onto this cone, resulting in a non-zero residual norm, and the solution vector $\\hat{x}_4$ will have positive components.\n\nThis systematic application of a standard numerical method is a sound and correct approach to solving the given problem.", "answer": "```python\nimport numpy as np\nfrom scipy.optimize import nnls\n\ndef solve():\n    \"\"\"\n    Solves a series of Nonnegative Least Squares (NNLS) problems\n    related to mutational signature analysis in synthetic biology.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    test_cases = []\n\n    # Case 1: Well-conditioned, exact reconstruction\n    S1 = np.array([\n        [0.6, 0.1, 0.05],\n        [0.1, 0.6, 0.1],\n        [0.0, 0.1, 0.6],\n        [0.2, 0.0, 0.1],\n        [0.05, 0.1, 0.05],\n        [0.05, 0.1, 0.1]\n    ])\n    v1 = np.array([0.28, 0.24, 0.15, 0.10, 0.06, 0.07])\n    test_cases.append((S1, v1))\n\n    # Case 2: Zero spectrum boundary\n    S2 = S1\n    v2 = np.zeros(6)\n    test_cases.append((S2, v2))\n\n    # Case 3: Rank-deficient signatures, multiple optima\n    S3 = np.array([\n        [0.4, 0.4, 0.0],\n        [0.2, 0.2, 0.2],\n        [0.1, 0.1, 0.4],\n        [0.1, 0.1, 0.2],\n        [0.2, 0.2, 0.2]\n    ])\n    v3 = np.array([0.2, 0.2, 0.25, 0.15, 0.2])\n    test_cases.append((S3, v3))\n    \n    # Case 4: Undercomplete for a target outside the cone, positive solution\n    S4 = np.array([\n        [1.0, 0.2],\n        [0.2, 1.0],\n        [0.2, 0.2]\n    ])\n    v4 = np.array([0.2, 0.2, 1.0])\n    test_cases.append((S4, v4))\n    \n    # Case 5: Well-conditioned, different exact mixture\n    S5 = S1\n    v5 = np.array([0.2575, 0.31, 0.075, 0.075, 0.065, 0.0675])\n    test_cases.append((S5, v5))\n\n    results = []\n    for S, v in test_cases:\n        # Compute the nonnegative least squares solution\n        x, _ = nnls(S, v)\n        \n        # Round the solution vector to 6 decimal places\n        rounded_x = np.round(x, 6).tolist()\n        results.append(rounded_x)\n\n    # Format the final output string as a list of lists, without spaces.\n    # The repr() function provides a string representation of the list of lists.\n    # We remove spaces to create a compact and unambiguous format.\n    final_output = repr(results).replace(\" \", \"\")\n    \n    print(final_output)\n\nsolve()\n```", "id": "2753137"}]}