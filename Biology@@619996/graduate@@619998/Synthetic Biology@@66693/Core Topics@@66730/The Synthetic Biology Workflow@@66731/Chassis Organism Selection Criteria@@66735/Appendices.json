{"hands_on_practices": [{"introduction": "The first step in selecting a suitable chassis is often fundamental characterization. This practice hones your ability to deduce an organism's core metabolic strategy from a set of environmental, physiological, and biochemical observations. Mastering this deductive reasoning is a prerequisite for matching a potential chassis to a specific bioprocess goal, such as bioremediation in a particular niche or production using specific feedstocks. [@problem_id:2084881]", "problem": "A microbiologist is investigating a newly discovered species of bacterium isolated from the anoxic sediment of a meromictic lake. This lake is characterized by a stable stratification, where the bottom layer (hypolimnion) is permanently devoid of oxygen and rich in hydrogen sulfide ($H_2S$) produced by sulfate-reducing bacteria. The newly discovered bacterium thrives only in a narrow band of this anoxic zone that receives a small amount of filtered sunlight. Laboratory analysis reveals that the bacterium possesses bacteriochlorophyll pigments and accumulates intracellular granules of elemental sulfur ($S^0$). It does not grow in the dark, even when provided with organic carbon sources.\n\nBased on these observations, which of the following best describes the primary metabolic strategy of this bacterium?\n\nA. Oxygenic photosynthesis\n\nB. Photoheterotrophy using organic acids as an electron donor\n\nC. Chemoautotrophy using hydrogen sulfide as an energy source\n\nD. Anoxygenic photosynthesis using hydrogen sulfide as an electron donor\n\nE. Anaerobic respiration with sulfate as the terminal electron acceptor", "solution": "We begin by extracting the key observations:\n- The habitat is an anoxic hypolimnion rich in $H_2S$, with a narrow light-penetrated band.\n- The bacterium possesses bacteriochlorophyll pigments.\n- It accumulates intracellular granules of elemental sulfur, $S^0$.\n- It does not grow in the dark, even when supplied with organic carbon sources.\n\nLogical implications of each observation:\n1) Presence of bacteriochlorophyll implies phototrophy, specifically characteristic of anoxygenic phototrophs rather than oxygenic phototrophs (which use chlorophyll $a$ and produce $O_2$).\n2) Intracellular $S^0$ granules indicate oxidation of $H_2S$ to $S^0$ as part of sulfur-based photosynthesis. This is diagnostic of purple sulfur bacteria, which store $S^0$ intracellularly during anoxygenic photosynthesis using $H_2S$ as the electron donor.\n3) Lack of growth in the dark, even with organic carbon, rules out a photoheterotrophic lifestyle that could switch to chemoorganotrophy in the absence of light; it indicates obligate phototrophy.\n4) The ecological niche (anoxic, $H_2S$-rich, illuminated chemocline) is classical for phototrophic sulfur bacteria that perform anoxygenic photosynthesis.\n\nEvaluate options against the evidence:\n- A. Oxygenic photosynthesis: Incorrect. Oxygenic phototrophs use $H_2O$ as the electron donor, produce $O_2$, and utilize chlorophyll $a$, not bacteriochlorophyll.\n- B. Photoheterotrophy using organic acids as an electron donor: Incorrect. This would not explain intracellular $S^0$ granules and would allow dark growth on organics, which is not observed.\n- C. Chemoautotrophy using hydrogen sulfide as an energy source: Incorrect. Chemoautotrophs do not require light and do not possess bacteriochlorophyll; the organism requires light and fails to grow in the dark.\n- D. Anoxygenic photosynthesis using hydrogen sulfide as an electron donor: Correct. This matches bacteriochlorophyll presence, light dependence, anoxic habitat, $H_2S$ utilization, and intracellular $S^0$ accumulation. A representative overall reaction is $CO_2 + 2H_2S \\xrightarrow{\\text{light}} (CH_2O) + H_2O + 2S^0$.\n- E. Anaerobic respiration with sulfate as the terminal electron acceptor: Incorrect. That describes sulfate-reducing bacteria producing $H_2S$, not a light-dependent organism that oxidizes $H_2S$ and accumulates $S^0$.\n\nTherefore, the primary metabolic strategy is anoxygenic photosynthesis using $H_2S$ as the electron donor.", "answer": "$$\\boxed{D}$$", "id": "2084881"}, {"introduction": "Moving from simple characterization to practical application requires the ability to control and select for your chosen organism. This exercise challenges you to think like a bioprocess engineer, applying quantitative principles of microbial kinetics and stoichiometry to design a selective environment in a chemostat. Such skills are vital for enriching novel organisms from environmental samples or for maintaining the stability of an engineered strain against contamination in large-scale bioreactors. [@problem_id:2488528]", "problem": "A continuous stirred-tank reactor (chemostat) is inoculated with a mixed community containing anaerobic ammonium-oxidizing bacteria (anammox) and heterotrophic denitrifying bacteria (denitrifiers). You are tasked with configuring an enrichment culture that selectively favors anammox over denitrifiers while avoiding washout. Assume constant temperature at $30\\,^{\\circ}\\mathrm{C}$, complete biomass suspension (no biomass retention beyond hydraulic residence), and the following widely accepted kinetic and sensitivity characteristics:\n\n- Anammox (autotrophic; electron donor: $\\mathrm{NH_4^+}$; electron acceptor: $\\mathrm{NO_2^-}$):\n  - Maximum specific growth rate: $\\mu_{a,\\max} = 0.12\\,\\mathrm{d^{-1}}$.\n  - Half-saturation constants: $K_{\\mathrm{NH_4}} = 0.5\\,\\mathrm{mg\\ N\\,L^{-1}}$, $K_{\\mathrm{NO_2}} = 0.3\\,\\mathrm{mg\\ N\\,L^{-1}}$.\n  - Noncompetitive dissolved oxygen (DO) inhibition characterized by an inhibition constant $K_{i,\\mathrm{O_2},a} = 0.20\\,\\mathrm{mg\\ O_2\\,L^{-1}}$.\n  - Strong sensitivity to free nitrous acid (FNA, un-ionized $\\mathrm{HNO_2}$) with an inhibition constant $K_{i,\\mathrm{FNA}} = 0.020\\,\\mathrm{mg\\ N\\,L^{-1}}$; the acid dissociation constant for nitrous acid is $\\mathrm{p}K_a = 3.25$.\n  - Stoichiometric optimum influent $\\mathrm{NO_2^-}:\\mathrm{NH_4^+}$ ratio near $1.32:1$ (on a nitrogen basis).\n\n- Denitrifiers (heterotrophic; use organic carbon as electron donor; $\\mathrm{NO_2^-}$ or $\\mathrm{NO_3^-}$ as electron acceptor when anoxic; $\\mathrm{O_2}$ is preferred when present):\n  - Maximum specific growth rate under carbon-replete conditions: $\\mu_{d,\\max} = 0.80\\,\\mathrm{d^{-1}}$.\n  - Half-saturation constants: $K_{\\mathrm{NO_x}} = 0.2\\,\\mathrm{mg\\ N\\,L^{-1}}$ for $\\mathrm{NO_2^-}/\\mathrm{NO_3^-}$, and $K_{S,\\mathrm{COD}} = 20\\,\\mathrm{mg\\ COD\\,L^{-1}}$ for organic carbon (expressed as chemical oxygen demand, COD).\n  - In the presence of DO, denitrification is suppressed and aerobic respiration is favored; in the absence of organic carbon, denitrifiers cannot sustain growth.\n\nFundamental bases you may assume:\n- Chemostat steady-state persistence criterion: a population can persist only if its net specific growth rate $\\mu$ satisfies $\\mu \\ge D$, where $D$ is the dilution rate.\n- Monod-type dependence on required substrates and noncompetitive inhibition by DO and FNA are appropriate representations for these guilds.\n- Fraction of FNA (un-ionized $\\mathrm{HNO_2}$) from total nitrite nitrogen is governed by acid-base equilibrium at the stated $\\mathrm{pH}$.\n\nConsider the following five alternative operating configurations. In all cases, inorganic carbon (bicarbonate) is supplied in excess for autotrophy unless explicitly stated otherwise. Select the single configuration that best constitutes an enrichment design that selects for anammox over denitrifiers while providing a robust margin against washout.\n\nA. $D = 0.05\\,\\mathrm{d^{-1}}$; $\\mathrm{DO} = 0.02\\,\\mathrm{mg\\ O_2\\,L^{-1}}$; influent $\\mathrm{NH_4^+-N} = 40\\,\\mathrm{mg\\ N\\,L^{-1}}$; influent $\\mathrm{NO_2^--N} = 53\\,\\mathrm{mg\\ N\\,L^{-1}}$; no added organic carbon ($0\\,\\mathrm{mg\\ COD\\,L^{-1}}$); $\\mathrm{pH} = 7.5$; bicarbonate supplied.\n\nB. $D = 0.20\\,\\mathrm{d^{-1}}$; $\\mathrm{DO} = 0.50\\,\\mathrm{mg\\ O_2\\,L^{-1}}$; influent $\\mathrm{NH_4^+-N} = 40\\,\\mathrm{mg\\ N\\,L^{-1}}$; influent $\\mathrm{NO_2^--N} = 53\\,\\mathrm{mg\\ N\\,L^{-1}}$; added organic carbon $= 100\\,\\mathrm{mg\\ COD\\,L^{-1}}$; $\\mathrm{pH} = 7.5$.\n\nC. $D = 0.05\\,\\mathrm{d^{-1}}$; $\\mathrm{DO} = 0.00\\,\\mathrm{mg\\ O_2\\,L^{-1}}$; influent $\\mathrm{NO_3^--N} = 100\\,\\mathrm{mg\\ N\\,L^{-1}}$; added organic carbon $= 200\\,\\mathrm{mg\\ COD\\,L^{-1}}$; $\\mathrm{NH_4^+-N} = 0\\,\\mathrm{mg\\ N\\,L^{-1}}$; $\\mathrm{pH} = 7.5$.\n\nD. $D = 0.05\\,\\mathrm{d^{-1}}$; $\\mathrm{DO} = 0.00\\,\\mathrm{mg\\ O_2\\,L^{-1}}$; influent $\\mathrm{NH_4^+-N} = 40\\,\\mathrm{mg\\ N\\,L^{-1}}$; influent $\\mathrm{NO_2^--N} = 53\\,\\mathrm{mg\\ N\\,L^{-1}}$; added organic carbon $= 50\\,\\mathrm{mg\\ COD\\,L^{-1}}$; $\\mathrm{pH} = 7.5$.\n\nE. $D = 0.05\\,\\mathrm{d^{-1}}$; $\\mathrm{DO} = 0.02\\,\\mathrm{mg\\ O_2\\,L^{-1}}$; influent $\\mathrm{NH_4^+-N} = 10\\,\\mathrm{mg\\ N\\,L^{-1}}$; influent $\\mathrm{NO_2^--N} = 60\\,\\mathrm{mg\\ N\\,L^{-1}}$; no added organic carbon ($0\\,\\mathrm{mg\\ COD\\,L^{-1}}$); $\\mathrm{pH} = 6.7$; bicarbonate supplied.\n\nWhich option is most appropriate for selectively enriching anammox under the stated principles?", "solution": "The problem statement will first be validated for scientific and logical integrity.\n\n### Step 1: Extract Givens\n\n- **System**: Continuous stirred-tank reactor (chemostat).\n- **Goal**: Configure an enrichment culture to selectively favor anammox bacteria over heterotrophic denitrifying bacteria, while avoiding washout.\n- **Assumptions**: Constant temperature $T = 30\\,^{\\circ}\\mathrm{C}$, complete biomass suspension.\n\n**Anammox Bacteria (autotrophic):**\n- Electron donor: $\\mathrm{NH_4^+}$\n- Electron acceptor: $\\mathrm{NO_2^-}$\n- Maximum specific growth rate: $\\mu_{a,\\max} = 0.12\\,\\mathrm{d^{-1}}$\n- Half-saturation constants: $K_{\\mathrm{NH_4}} = 0.5\\,\\mathrm{mg\\ N\\,L^{-1}}$, $K_{\\mathrm{NO_2}} = 0.3\\,\\mathrm{mg\\ N\\,L^{-1}}$\n- Noncompetitive dissolved oxygen (DO) inhibition constant: $K_{i,\\mathrm{O_2},a} = 0.20\\,\\mathrm{mg\\ O_2\\,L^{-1}}$\n- Free nitrous acid (FNA, $\\mathrm{HNO_2}$) inhibition constant: $K_{i,\\mathrm{FNA}} = 0.020\\,\\mathrm{mg\\ N\\,L^{-1}}$\n- Acid dissociation constant for nitrous acid: $\\mathrm{p}K_a = 3.25$\n- Optimum influent ratio: $\\mathrm{NO_2^-}:\\mathrm{NH_4^+} \\approx 1.32:1$ (N basis)\n\n**Denitrifying Bacteria (heterotrophic):**\n- Electron donor: organic carbon (COD)\n- Electron acceptor: $\\mathrm{NO_2^-}$ or $\\mathrm{NO_3^-}$ (anoxic), or $\\mathrm{O_2}$ (aerobic, preferred)\n- Maximum specific growth rate: $\\mu_{d,\\max} = 0.80\\,\\mathrm{d^{-1}}$ (carbon-replete)\n- Half-saturation constants: $K_{\\mathrm{NO_x}} = 0.2\\,\\mathrm{mg\\ N\\,L^{-1}}$, $K_{S,\\mathrm{COD}} = 20\\,\\mathrm{mg\\ COD\\,L^{-1}}$\n- Growth requires organic carbon. Denitrification is suppressed by DO.\n\n**Fundamental Principles:**\n- Chemostat persistence criterion: Net specific growth rate $\\mu \\ge D$ (dilution rate). At steady state, $\\mu = D$.\n- Growth kinetics are represented by Monod-type equations with noncompetitive inhibition terms.\n- FNA fraction is governed by acid-base equilibrium.\n\n### Step 2: Validate Using Extracted Givens\n\nThe problem statement describes a classic microbial competition scenario in a chemostat, a cornerstone of bioprocess engineering and microbial ecology.\n- **Scientifically Grounded**: The problem is based on well-established microbial processes (anammox, denitrification) and their widely accepted kinetic characteristics. The given kinetic parameters ($\\mu_{\\max}$, $K_s$, $K_i$) are within realistic ranges reported in scientific literature for these microbial guilds. The stoichiometric ratio is correct.\n- **Well-Posed**: The problem provides sufficient information and a clear objective to allow for a unique, logical solution based on the comparison of different operating conditions. The task is to identify the best configuration among a given set, which is a well-defined problem.\n- **Objective**: The language is technical, precise, and free of subjective claims. All parameters are quantified.\n\nThe problem does not violate any of the invalidity criteria. It is a standard, solvable problem in environmental biotechnology.\n\n### Step 3: Verdict and Action\n\nThe problem is valid. A full solution will be derived.\n\n### Derivation of Solution\n\nThe objective is to establish an environment that provides a selective advantage to anammox bacteria while suppressing denitrifying bacteria. The selection strategy is derived from the fundamental metabolic differences between the two groups.\n\n**Principles for Anammox Selection:**\n\n1.  **Substrate Limitation for Competitors**: Denitrifiers are heterotrophs and require organic carbon as an electron donor and carbon source. Anammox bacteria are autotrophs and use inorganic carbon (bicarbonate). The most effective selection pressure against denitrifiers is to operate the system under conditions of complete organic carbon limitation (i.e., provide no organic carbon in the influent).\n2.  **Dilution Rate Control**: Anammox are slow-growing organisms, with a given $\\mu_{a,\\max} = 0.12\\,\\mathrm{d^{-1}}$. According to the chemostat persistence criterion, the dilution rate $D$ must be less than the net maximum specific growth rate of the target organism to prevent its washout. Therefore, it is required that $D < \\mu_{a,\\max}$.\n3.  **Provision of Anammox Substrates**: The reactor must be fed with the required substrates for anammox growth: ammonium ($\\mathrm{NH_4^+}$) and nitrite ($\\mathrm{NO_2^-}$). For optimal performance, the influent ratio should be close to the stoichiometric requirement, given as $\\mathrm{NO_2^-}:\\mathrm{NH_4^+} \\approx 1.32:1$.\n4.  **Minimization of Inhibition**:\n    - **DO Inhibition**: Anammox are sensitive to dissolved oxygen. The reactor DO concentration must be kept very low to minimize inhibition. The noncompetitive inhibition factor is $I_{\\mathrm{O_2}} = K_{i,\\mathrm{O_2},a} / (K_{i,\\mathrm{O_2},a} + [\\mathrm{O_2}])$.\n    - **FNA Inhibition**: Anammox are also inhibited by free nitrous acid ($\\mathrm{HNO_2}$). The concentration of FNA is dependent on the total nitrite concentration and the $\\mathrm{pH}$, according to the equilibrium $\\mathrm{HNO_2} \\leftrightarrow \\mathrm{H^+} + \\mathrm{NO_2^-}$. The fraction of total nitrite present as FNA is given by $\\alpha_{\\mathrm{FNA}} = (1 + 10^{\\mathrm{pH}-\\mathrm{p}K_a})^{-1}$. A higher $\\mathrm{pH}$ (i.e., $\\mathrm{pH} > \\mathrm{p}K_a$) significantly reduces the FNA fraction, thus minimizing inhibition.\n\nWe will now evaluate each option against these four principles.\n\n### Option-by-Option Analysis\n\n**A. $D = 0.05\\,\\mathrm{d^{-1}}$; $\\mathrm{DO} = 0.02\\,\\mathrm{mg\\ O_2\\,L^{-1}}$; influent $\\mathrm{NH_4^+-N} = 40\\,\\mathrm{mg\\ N\\,L^{-1}}$; influent $\\mathrm{NO_2^--N} = 53\\,\\mathrm{mg\\ N\\,L^{-1}}$; no added organic carbon ($0\\,\\mathrm{mg\\ COD\\,L^{-1}}$); $\\mathrm{pH} = 7.5$; bicarbonate supplied.**\n1.  **Organic Carbon**: Influent COD is $0\\,\\mathrm{mg\\ L^{-1}}$. This starves the heterotrophic denitrifiers, providing the primary selective pressure for anammox.\n2.  **Dilution Rate**: $D = 0.05\\,\\mathrm{d^{-1}}$. This is safely below $\\mu_{a,\\max} = 0.12\\,\\mathrm{d^{-1}}$. Anammox will not be washed out and can establish a stable population. This provides a robust operating window.\n3.  **Substrates**: The influent contains both $\\mathrm{NH_4^+}$ and $\\mathrm{NO_2^-}$. The ratio is $[\\mathrm{NO_2^-}] / [\\mathrm{NH_4^+}] = 53 / 40 = 1.325$. This is extremely close to the optimal stoichiometric ratio of $1.32$, ensuring efficient substrate conversion.\n4.  **Inhibition**:\n    - **DO**: $[\\mathrm{O_2}] = 0.02\\,\\mathrm{mg\\ L^{-1}}$. The inhibition factor is $I_{\\mathrm{O_2}} = 0.20 / (0.20 + 0.02) \\approx 0.91$. This implies only a $9\\%$ reduction in growth rate, which is minor and allows for robust growth.\n    - **FNA**: With $\\mathrm{pH} = 7.5$ and $\\mathrm{p}K_a = 3.25$, the FNA fraction is $\\alpha_{\\mathrm{FNA}} = (1 + 10^{7.5-3.25})^{-1} = (1 + 10^{4.25})^{-1} \\approx 5.6 \\times 10^{-5}$. This is an extremely small fraction. Even with a high residual nitrite concentration, FNA concentration will be negligible and far below the inhibition constant $K_{i,\\mathrm{FNA}} = 0.020\\,\\mathrm{mg\\ N\\,L^{-1}}$. Inhibition is minimal.\n\nConclusion: This configuration meets all requirements for a robust and selective anammox enrichment culture.\nVerdict: **Correct**.\n\n**B. $D = 0.20\\,\\mathrm{d^{-1}}$; $\\mathrm{DO} = 0.50\\,\\mathrm{mg\\ O_2\\,L^{-1}}$; influent $\\mathrm{NH_4^+-N} = 40\\,\\mathrm{mg\\ N\\,L^{-1}}$; influent $\\mathrm{NO_2^--N} = 53\\,\\mathrm{mg\\ N\\,L^{-1}}$; added organic carbon $= 100\\,\\mathrm{mg\\ COD\\,L^{-1}}$; $\\mathrm{pH} = 7.5$.**\n1.  **Dilution Rate**: $D = 0.20\\,\\mathrm{d^{-1}}$. This is greater than the maximum specific growth rate of anammox, $\\mu_{a,\\max} = 0.12\\,\\mathrm{d^{-1}}$. It is biologically impossible for the anammox population to persist; it will be completely washed out of the reactor. This alone invalidates the option.\n2.  **Organic Carbon**: $100\\,\\mathrm{mg\\ COD\\,L^{-1}}$ is supplied, which will promote the growth of heterotrophs, including denitrifiers.\n3.  **Inhibition**: DO concentration is high ($0.50\\,\\mathrm{mg\\ L^{-1}}$), causing severe inhibition on anammox: $I_{\\mathrm{O_2}} = 0.20 / (0.20 + 0.50) \\approx 0.286$. The effective $\\mu_{a,\\max}$ would be reduced to $\\approx 0.12 \\times 0.286 = 0.034\\,\\mathrm{d^{-1}}$, making washout even more certain. With both DO and organic carbon present, fast-growing aerobic heterotrophs will dominate.\n\nConclusion: This configuration guarantees the washout of anammox and selects for other organisms.\nVerdict: **Incorrect**.\n\n**C. $D = 0.05\\,\\mathrm{d^{-1}}$; $\\mathrm{DO} = 0.00\\,\\mathrm{mg\\ O_2\\,L^{-1}}$; influent $\\mathrm{NO_3^--N} = 100\\,\\mathrm{mg\\ N\\,L^{-1}}$; added organic carbon $= 200\\,\\mathrm{mg\\ COD\\,L^{-1}}$; $\\mathrm{NH_4^+-N} = 0\\,\\mathrm{mg\\ N\\,L^{-1}}$; $\\mathrm{pH} = 7.5$.**\n1.  **Substrates**: The influent lacks ammonium ($\\mathrm{NH_4^+-N} = 0$). Ammonium is an essential substrate (electron donor) for anammox. Without it, anammox cannot grow. This condition starves the anammox population, leading to its washout.\n2.  **Selection**: The conditions provided (anoxic, presence of nitrate and organic carbon) are ideal for conventional denitrification by heterotrophic denitrifiers. This configuration is an enrichment for denitrifiers, not anammox.\n\nConclusion: This configuration starves the anammox bacteria of an essential substrate.\nVerdict: **Incorrect**.\n\n**D. $D = 0.05\\,\\mathrm{d^{-1}}$; $\\mathrm{DO} = 0.00\\,\\mathrm{mg\\ O_2\\,L^{-1}}$; influent $\\mathrm{NH_4^+-N} = 40\\,\\mathrm{mg\\ N\\,L^{-1}}$; influent $\\mathrm{NO_2^--N} = 53\\,\\mathrm{mg\\ N\\,L^{-1}}$; added organic carbon $= 50\\,\\mathrm{mg\\ COD\\,L^{-1}}$; $\\mathrm{pH} = 7.5$.**\n1.  **Organic Carbon**: Organic carbon is supplied at $50\\,\\mathrm{mg\\ COD\\,L^{-1}}$. This directly violates the primary selection principle, as it provides a food source for the competing heterotrophic denitrifiers.\n2.  **Competition**: Denitrifiers ($\\mu_{d,\\max} = 0.80\\,\\mathrm{d^{-1}}$) grow much faster than anammox ($\\mu_{a,\\max} = 0.12\\,\\mathrm{d^{-1}}$). By providing organic carbon, both groups will compete for the common electron acceptor, nitrite ($\\mathrm{NO_2^-}$). Given their kinetic advantage, denitrifiers will likely outcompete anammox, especially for nitrite. This setup fails to selectively enrich for anammox and instead creates a mixed culture at best, or a denitrifier-dominated culture at worst.\n\nConclusion: The addition of organic carbon promotes the growth of the competitor, undermining the goal of selective enrichment.\nVerdict: **Incorrect**.\n\n**E. $D = 0.05\\,\\mathrm{d^{-1}}$; $\\mathrm{DO} = 0.02\\,\\mathrm{mg\\ O_2\\,L^{-1}}$; influent $\\mathrm{NH_4^+-N} = 10\\,\\mathrm{mg\\ N\\,L^{-1}}$; influent $\\mathrm{NO_2^--N} = 60\\,\\mathrm{mg\\ N\\,L^{-1}}$; no added organic carbon ($0\\,\\mathrm{mg\\ COD\\,L^{-1}}$); $\\mathrm{pH} = 6.7$; bicarbonate supplied.**\n1.  **Substrates**: The influent ratio is $[\\mathrm{NO_2^-}] / [\\mathrm{NH_4^+}] = 60 / 10 = 6$. This is severely deviated from the optimal ratio of $1.32$. Ammonium will be the limiting substrate, and a large excess of nitrite will remain in the reactor. For every $10\\,\\mathrm{mg\\ N\\,L^{-1}}$ of $\\mathrm{NH_4^+}$ consumed, only about $13.2\\,\\mathrm{mg\\ N\\,L^{-1}}$ of $\\mathrm{NO_2^-}$ is consumed. This would lead to an accumulation of residual nitrite, with a concentration approaching $60 - 13.2 = 46.8\\,\\mathrm{mg\\ N\\,L^{-1}}$.\n2.  **Inhibition (FNA)**: The $\\mathrm{pH}$ is low at $6.7$. At this $\\mathrm{pH}$, the FNA fraction is $\\alpha_{\\mathrm{FNA}} = (1 + 10^{6.7-3.25})^{-1} = (1 + 10^{3.45})^{-1} \\approx 3.5 \\times 10^{-4}$. With a residual nitrite concentration of $\\approx 46.8\\,\\mathrm{mg\\ N\\,L^{-1}}$, the FNA concentration in the reactor would be $[\\mathrm{FNA}] \\approx 46.8 \\times 3.5 \\times 10^{-4} \\approx 0.0164\\,\\mathrm{mg\\ N\\,L^{-1}}$. This value is very close to the inhibition constant $K_{i,\\mathrm{FNA}} = 0.020\\,\\mathrm{mg\\ N\\,L^{-1}}$. The FNA inhibition factor would be $I_{FNA} = 0.020 / (0.020 + 0.0164) \\approx 0.55$. This constitutes a severe ($45\\%$) inhibition of the anammox growth rate.\n3.  **Robustness**: The total maximum growth rate, considering both DO and FNA inhibition, is $\\mu_{a,net,\\max} \\approx \\mu_{a,\\max} \\times I_{\\mathrm{O_2}} \\times I_{FNA} \\approx 0.12 \\times 0.91 \\times 0.55 \\approx 0.060\\,\\mathrm{d^{-1}}$. This rate is only slightly above the dilution rate $D = 0.05\\,\\mathrm{d^{-1}}$. The system lacks a robust margin against washout. Any small process fluctuation causing higher residual nitrite or lower $\\mathrm{pH}$ could easily lead to anammox washout.\n\nConclusion: This configuration is poorly designed due to the non-stoichiometric substrate feed and low $\\mathrm{pH}$, which together create strong FNA inhibition and leave no robust margin for operation.\nVerdict: **Incorrect**.\n\n**Final Summary:**\n\nOption A is the only configuration that correctly applies all the necessary principles for the selective enrichment of anammox bacteria over denitrifiers. It eliminates the competitor's food source, uses a safe dilution rate, provides substrates at the correct stoichiometric ratio, and minimizes inhibition by both DO and FNA, ensuring a robust and stable process.", "answer": "$$\\boxed{A}$$", "id": "2488528"}, {"introduction": "Modern synthetic biology relies heavily on computational tools to accelerate the design-build-test-learn cycle. This practice introduces you to Flux Balance Analysis (FBA), a cornerstone of *in silico* metabolic engineering, governed by the steady-state constraint $S v = 0$. By building and solving a linear model of a cell's metabolism, you can predict the performance of a potential chassis and test the effects of genetic modifications, allowing for the rapid, low-cost evaluation of engineering strategies before any wet-lab work begins. [@problem_id:2719662]", "problem": "You are given a linear metabolic model formulated for Flux Balance Analysis (FBA), specified by a stoichiometric matrix $S \\in \\mathbb{R}^{m \\times n}$, a vector of reaction fluxes $v \\in \\mathbb{R}^{n}$, steady-state mass balance constraints $S v = 0$, and flux bounds $l \\le v \\le u$. The sign convention is that exchange reactions are written as consumption of the intracellular metabolite with coefficient $-1$, so positive flux corresponds to secretion and negative flux corresponds to uptake. Under anaerobic conditions, the oxygen exchange flux must be constrained to zero. The theoretical product yield (per unit substrate uptake) under anaerobic conditions is defined as the optimal value of the product secretion flux when the substrate uptake flux is fixed to magnitude $1$ (i.e., the substrate exchange flux equals $-1$), subject to $S v = 0$ and all bounds including oxygen exchange fixed to zero. A candidate chassis imposes additional flux bounds (e.g., gene knockouts or capacity limits). The question is whether the candidate chassis can achieve the same optimal product flux as the theoretical anaerobic yield.\n\nYou must write a program that, for each test case, does the following:\n- Formulate the linear program to maximize the product secretion flux $v_p$ subject to the steady-state constraints $S v = 0$, the base bounds $l \\le v \\le u$ with anaerobic condition (oxygen exchange fixed to zero) and substrate uptake fixed to $-1$. Solve it to obtain the theoretical anaerobic yield $Y^\\star$.\n- Apply the candidate’s additional flux bound modifications to $(l, u)$, resolve the same linear program, and obtain the candidate-optimal product flux $\\hat{Y}$.\n- Return a boolean that is true if and only if the candidate can achieve the theoretical anaerobic yield within a numerical tolerance $\\varepsilon = 10^{-9}$, i.e., if $|\\hat{Y} - Y^\\star| \\le \\varepsilon$ and the candidate problem is feasible; otherwise false. If either linear program is infeasible, treat the result for that case as false.\n\nFoundational constraints to be used:\n- Steady-state mass balance: $S v = 0$.\n- Flux bounds: $l \\le v \\le u$.\n- Anaerobic condition: the oxygen exchange flux $v_{\\mathrm{O2,ex}} = 0$.\n- Substrate uptake normalization: the substrate exchange flux $v_{\\mathrm{sub,ex}} = -1$.\n- Objective: maximize $v_p$.\n\nAll flux values are in arbitrary but consistent units; units do not affect the boolean outputs. Angles are not involved. No percentages are involved.\n\nTest suite (shared stoichiometric network with three distinct candidate chassis):\n\nMetabolites (rows of $S$): [GLC, PYR, ETOH, CO2, O2].\n\nReactions (columns of $S$): [EX_glc, RGly, RFer, RResp, EX_etoh, EX_co2, EX_o2].\n\nInterpretation of reactions:\n- EX_glc: exchange of glucose (uptake allowed).\n- RGly: glycolysis, $\\mathrm{GLC} \\rightarrow 2\\, \\mathrm{PYR}$.\n- RFer: fermentation, $\\mathrm{PYR} \\rightarrow \\mathrm{ETOH} + \\mathrm{CO2}$.\n- RResp: respiration branch, $\\mathrm{PYR} + \\mathrm{O2} \\rightarrow 3\\, \\mathrm{CO2}$ (oxygen and water bookkeeping not explicitly modeled; this is a reduced stoichiometry tracking internal metabolite pools).\n- EX_etoh: exchange of ethanol (secretion allowed).\n- EX_co2: exchange of carbon dioxide (secretion allowed).\n- EX_o2: exchange of oxygen (uptake allowed in principle, but fixed to zero under anaerobic conditions).\n\nStoichiometric matrix $S$ (rows correspond to metabolites in the listed order, columns to reactions in the listed order):\n- Row GLC: $[-1, -1, 0, 0, 0, 0, 0]$.\n- Row PYR: $[0, +2, -1, -1, 0, 0, 0]$.\n- Row ETOH: $[0, 0, +1, 0, -1, 0, 0]$.\n- Row CO2: $[0, 0, +1, +3, 0, -1, 0]$.\n- Row O2: $[0, 0, 0, -1, 0, 0, -1]$.\n\nBase flux bounds $(l, u)$ for reactions in the listed order, before applying anaerobic and substrate-fixing constraints:\n- EX_glc: $l = -1$, $u = -1$ (fixes substrate uptake flux to $-1$).\n- RGly: $l = 0$, $u = 1000$.\n- RFer: $l = 0$, $u = 1000$.\n- RResp: $l = 0$, $u = 1000$.\n- EX_etoh: $l = 0$, $u = 1000$.\n- EX_co2: $l = 0$, $u = 1000$.\n- EX_o2: $l = 0$, $u = 0$ (anaerobic condition).\n\nProduct reaction index: EX_etoh. Substrate exchange index: EX_glc. Oxygen exchange index: EX_o2.\n\nTest cases:\n- Case A (happy path): no additional constraints. Expectation: candidate achieves the theoretical anaerobic yield.\n- Case B (capacity-limited fermentation): impose an upper bound on RFer of $1.5$ (i.e., set $u = 1.5$ for RFer). Expectation: candidate cannot achieve the theoretical anaerobic yield if the theoretical yield exceeds $1.5$.\n- Case C (fermentation knockout under anaerobiosis): impose an upper bound on RFer of $0$ (i.e., knockout RFer). Expectation: the candidate problem is infeasible (with fixed glucose uptake and no oxygen), hence cannot achieve the theoretical yield.\n\nYour program should implement the linear programs using a numerical solver. For each case, output a boolean indicating whether the candidate can achieve the theoretical anaerobic yield within the tolerance $\\varepsilon = 10^{-9}$.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, e.g., \"[True,False,True]\".", "solution": "The problem as stated is a standard application of Flux Balance Analysis (FBA), a cornerstone of computational systems biology used to predict metabolic flux distributions. The problem is scientifically grounded, well-posed, and its parameters are specified with sufficient clarity to permit a unique solution. It is therefore deemed valid and a formal solution will be constructed.\n\nThe core of the problem is to evaluate the productive capacity of a metabolic network under different constraints. This is achieved by formulating and solving a series of Linear Programs (LPs). An LP seeks to optimize a linear objective function subject to a set of linear equality and inequality constraints.\n\nThe general form of the FBA problem is to find a vector of fluxes $v \\in \\mathbb{R}^n$ that maximizes an objective function, here the secretion flux of a desired product, $v_p$. This is subject to two main types of constraints:\n$1$. The steady-state mass balance constraint, $S v = 0$, where $S \\in \\mathbb{R}^{m \\times n}$ is the stoichiometric matrix, $m$ is the number of metabolites, and $n$ is the number of reactions. This constraint dictates that for each metabolite, the total rate of production must equal the total rate of consumption.\n$2$. Thermodynamic and capacity constraints, which are expressed as lower and upper bounds on each flux, $l \\le v \\le u$.\n\nFor the specific network provided, we have $m=5$ metabolites and $n=7$ reactions. The stoichiometric matrix $S$ is given as:\n$$\nS = \\begin{pmatrix}\n-1 & -1 &  0 &  0 &  0 &  0 &  0 \\\\\n 0 &  2 & -1 & -1 &  0 &  0 &  0 \\\\\n 0 &  0 &  1 &  0 & -1 &  0 &  0 \\\\\n 0 &  0 &  1 &  3 &  0 & -1 &  0 \\\\\n 0 &  0 &  0 & -1 &  0 &  0 & -1\n\\end{pmatrix}\n$$\nThe vector of fluxes is $v = [v_{\\mathrm{EX\\_glc}}, v_{\\mathrm{RGly}}, v_{\\mathrm{RFer}}, v_{\\mathrm{RResp}}, v_{\\mathrm{EX\\_etoh}}, v_{\\mathrm{EX\\_co2}}, v_{\\mathrm{EX\\_o2}}]^T$. The product of interest is ethanol, so the objective is to maximize its exchange flux, $v_p = v_{\\mathrm{EX\\_etoh}}$, which is the component $v_4$ of the flux vector (using $0$-based indexing).\n\nThe optimization problem is:\n$$\n\\begin{aligned}\n& \\underset{v \\in \\mathbb{R}^7}{\\text{maximize}}\n& & v_4 \\\\\n& \\text{subject to}\n& & S v = 0 \\\\\n& & & l_i \\le v_i \\le u_i, \\quad \\text{for } i \\in \\{0, 1, \\dots, 6\\}\n\\end{aligned}\n$$\nThis is solved computationally by minimizing the negative of the objective function, using an objective vector $c \\in \\mathbb{R}^7$ where $c = [0, 0, 0, 0, -1, 0, 0]^T$.\n\nFirst, we determine the theoretical anaerobic yield, $Y^\\star$. This involves solving the LP with the base flux bounds. The problem specifies a fixed substrate uptake $v_{\\mathrm{EX\\_glc}} = -1$ and anaerobic conditions $v_{\\mathrm{EX\\_o2}} = 0$. These are incorporated into the base bounds vector. Let us analyze the system $Sv=0$ with these fixed fluxes:\nThe equations are:\n$1$. $-v_0 - v_1 = 0$\n$2$. $2v_1 - v_2 - v_3 = 0$\n$3$. $v_2 - v_4 = 0$\n$4$. $v_2 + 3v_3 - v_5 = 0$\n$5$. $-v_3 - v_6 = 0$\n\nWith $v_0 = -1$ and $v_6 = 0$:\nFrom eq. $1$: $-(-1) - v_1 = 0 \\implies v_1 = v_{\\mathrm{RGly}} = 1$.\nFrom eq. $5$: $-v_3 - 0 = 0 \\implies v_3 = v_{\\mathrm{RResp}} = 0$.\nSubstituting into eq. $2$: $2(1) - v_2 - 0 = 0 \\implies v_2 = v_{\\mathrm{RFer}} = 2$.\nSubstituting into eq. $3$: $2 - v_4 = 0 \\implies v_4 = v_{\\mathrm{EX\\_etoh}} = 2$.\nSubstituting into eq. $4$: $2 + 3(0) - v_5 = 0 \\implies v_5 = v_{\\mathrm{EX\\_co2}} = 2$.\n\nUnder these fixed uptake/secretion conditions, the steady-state constraint determines a unique flux vector: $v = [-1, 1, 2, 0, 2, 2, 0]^T$. This solution is feasible as long as it satisfies the other flux bounds, which for the base case are $v_1, v_2, v_3, v_4, v_5 \\in [0, 1000]$. The unique solution is indeed within these bounds. Since there is only one possible flux distribution, the maximum product flux is uniquely determined. Thus, the theoretical anaerobic yield is $Y^\\star = v_4 = 2$.\n\nNow, we evaluate each candidate chassis:\n- **Case A (no additional constraints):** The constraints are identical to the base case. The LP solution is the same. The candidate-optimal product flux is $\\hat{Y} = 2$. The condition $|\\hat{Y} - Y^\\star| \\le \\varepsilon$ becomes $|2 - 2| \\le 10^{-9}$, which is true. The candidate problem is feasible. The result is **True**.\n\n- **Case B (capacity-limited fermentation):** An additional constraint, $v_2 = v_{\\mathrm{RFer}} \\le 1.5$, is imposed. However, as derived above, the combination of the steady-state mass balance ($Sv=0$) and fixed substrate uptake ($v_0 = -1$) forces the flux through the fermentation reaction to be exactly $v_2 = 2$. The new constraint $v_2 \\le 1.5$ is in direct contradiction with the consequences of the other constraints. The feasible set for this LP is empty. The problem is infeasible. According to the problem rules, if the candidate problem is infeasible, the result is **False**.\n\n- **Case C (fermentation knockout):** The constraint is $v_2 = v_{\\mathrm{RFer}} = 0$. This is a stricter version of the constraint in Case B. For the same reason, this constraint contradicts the system's requirements, which demand $v_2 = 2$. The problem is again infeasible. The result is **False**.\n\nThe implementation will follow this logic, using `scipy.optimize.linprog` to solve the required LPs and checking for feasibility via the solver's success status. The final boolean output for each case is determined by both the feasibility of the candidate's LP and the numerical comparison of its optimal value to the theoretical yield $Y^\\star$.", "answer": "```python\nimport numpy as np\nfrom scipy.optimize import linprog\n\ndef solve():\n    \"\"\"\n    Solves the FBA problem for three test cases to determine if a candidate chassis\n    can achieve the theoretical anaerobic product yield.\n    \"\"\"\n\n    # Define the metabolic network based on the problem statement.\n    # Metabolites (m=5): [GLC, PYR, ETOH, CO2, O2]\n    # Reactions (n=7): [EX_glc, RGly, RFer, RResp, EX_etoh, EX_co2, EX_o2]\n    S = np.array([\n        [-1., -1.,  0.,  0.,  0.,  0.,  0.],  # GLC\n        [ 0.,  2., -1., -1.,  0.,  0.,  0.],  # PYR\n        [ 0.,  0.,  1.,  0., -1.,  0.,  0.],  # ETOH\n        [ 0.,  0.,  1.,  3.,  0., -1.,  0.],  # CO2\n        [ 0.,  0.,  0., -1.,  0.,  0., -1.]   # O2\n    ])\n\n    # Base flux bounds (l, u), incorporating fixed substrate uptake and anaerobic conditions.\n    base_bounds = [\n        (-1.0, -1.0),    # EX_glc\n        (0.0, 1000.0),   # RGly\n        (0.0, 1000.0),   # RFer\n        (0.0, 1000.0),   # RResp\n        (0.0, 1000.0),   # EX_etoh\n        (0.0, 1000.0),   # EX_co2\n        (0.0, 0.0)       # EX_o2\n    ]\n\n    # Reaction indices\n    PRODUCT_IDX = 4    # Index for EX_etoh (product)\n    RFER_IDX = 2       # Index for RFer\n\n    # Numerical tolerance\n    EPSILON = 1e-9\n\n    def setup_and_solve_fba(c_obj, S_mat, bounds_list):\n        \"\"\"\n        A helper function to set up and solve the FBA linear program.\n\n        Args:\n            c_obj (np.array): The objective function vector.\n            S_mat (np.array): The stoichiometric matrix.\n            bounds_list (list of tuples): Flux bounds.\n\n        Returns:\n            tuple: A boolean indicating feasibility and the optimal value.\n        \"\"\"\n        b_eq = np.zeros(S_mat.shape[0])\n        res = linprog(c=c_obj, A_eq=S_mat, b_eq=b_eq, bounds=bounds_list, method='highs')\n        \n        if res.success:\n            # Objective is to maximize, so we negate the result of minimization\n            return True, -res.fun\n        else:\n            # If not successful (e.g., infeasible), return feasibility as False\n            return False, np.nan\n\n    # --- Step 1: Calculate the theoretical anaerobic yield Y_star ---\n    \n    # Objective: maximize product flux (v_p), which is equivalent to minimizing -v_p.\n    c = np.zeros(S.shape[1])\n    c[PRODUCT_IDX] = -1.0\n\n    base_feasible, Y_star = setup_and_solve_fba(c, S, base_bounds)\n\n    # If the base case is infeasible, no candidate can match it.\n    if not base_feasible:\n        print(\"[False,False,False]\")\n        return\n\n    # --- Step 2: Define and evaluate test cases ---\n    \n    # Case A: no additional constraints. Bounds are the same as base.\n    candidate_bounds_A = base_bounds\n    \n    # Case B: capacity-limited fermentation.\n    candidate_bounds_B = [list(b) for b in base_bounds]\n    candidate_bounds_B[RFER_IDX][1] = 1.5\n    \n    # Case C: fermentation knockout.\n    candidate_bounds_C = [list(b) for b in base_bounds]\n    candidate_bounds_C[RFER_IDX][1] = 0.0\n\n    test_case_bounds = [\n        candidate_bounds_A,\n        [tuple(b) for b in candidate_bounds_B],\n        [tuple(b) for b in candidate_bounds_C]\n    ]\n    \n    results = []\n    for bounds in test_case_bounds:\n        candidate_feasible, Y_hat = setup_and_solve_fba(c, S, bounds)\n        \n        # A candidate must have a feasible solution to be considered successful.\n        if not candidate_feasible:\n            results.append(False)\n            continue\n        \n        # If feasible, check if it achieves the theoretical yield within tolerance.\n        can_achieve = abs(Y_hat - Y_star) <= EPSILON\n        results.append(can_achieve)\n\n    # --- Step 3: Print final output in the required format ---\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == '__main__':\n    solve()\n```", "id": "2719662"}]}