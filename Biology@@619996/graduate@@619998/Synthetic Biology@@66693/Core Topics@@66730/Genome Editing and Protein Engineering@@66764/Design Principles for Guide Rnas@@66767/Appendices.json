{"hands_on_practices": [{"introduction": "The stability of the guide RNA-DNA duplex is the cornerstone of CRISPR targeting efficacy and specificity. The nearest-neighbor model provides a powerful, physically-grounded framework for quantifying this stability by assuming that the total free energy of a duplex can be approximated as the sum of local, sequence-dependent stacking interactions. This exercise tasks you with deriving the expression for the total hybridization free energy from this model's first principles [@problem_id:2727934]. Mastering this derivation will solidify your understanding of how sequence information is translated into a quantitative thermodynamic prediction, a fundamental skill in rational nucleic acid design.", "problem": "In rational design of guide Ribonucleic Acid (gRNA) spacers for Clustered Regularly Interspaced Short Palindromic Repeats (CRISPR)-associated nucleases, a central objective is to estimate the hybridization thermodynamics between a spacer of length $L$ and its complementary deoxyribonucleic acid (DNA) protospacer. Consider a spacer sequence $\\{r_{k}\\}_{k=1}^{L}$ in ribonucleic acid (RNA) alphabet $\\{ \\mathrm{A}, \\mathrm{U}, \\mathrm{C}, \\mathrm{G} \\}$ and a target sequence $\\{d_{k}\\}_{k=1}^{L}$ in DNA alphabet $\\{ \\mathrm{A}, \\mathrm{T}, \\mathrm{C}, \\mathrm{G} \\}$. Assume a contiguous duplex without bulges or gaps is formed (i.e., each position $k$ is paired, allowing for Watson–Crick or mismatch pairs), and that the standard-state hybridization free energy is well-approximated by a nearest-neighbor stacking model grounded in short-range base stacking additivity.\n\nLet the model comprise:\n- An initiation term $\\Delta G_{\\mathrm{init}}$ that is independent of sequence length $L$.\n- A library of dinucleotide-step parameters $\\Delta G_{ij}$, where index $i$ denotes the dinucleotide category of the RNA step $(r_{k}, r_{k+1})$ and index $j$ denotes the dinucleotide category of the DNA step $(d_{k}, d_{k+1})$. The parameter $\\Delta G_{ij}$ is defined for every allowed step category, including Watson–Crick and mismatch contexts.\n- For each step position $k \\in \\{1,\\ldots,L-1\\}$ and each dinucleotide category pair $(i,j)$, an indicator $x_{ij}^{(k)} \\in \\{0,1\\}$ equals $1$ if the step at position $k$ belongs to category $(i,j)$ and equals $0$ otherwise. By construction, for each $k$, $\\sum_{i}\\sum_{j} x_{ij}^{(k)} = 1$.\n\nStarting only from:\n- The statistical mechanical relationship between the standard free energy and the equilibrium constant, $\\Delta G^{\\circ} = - R T \\ln K$.\n- The assumption of nearest-neighbor additivity that renders the duplex partition function factorizable into contributions from local dinucleotide stacking interactions and a sequence-independent initiation factor.\n\nDerive a closed-form symbolic expression for the total standard-state hybridization free energy $\\Delta G_{\\mathrm{hyb}}$ of the spacer–target duplex in terms of $L$, $\\Delta G_{\\mathrm{init}}$, the indicators $x_{ij}^{(k)}$, and the dinucleotide parameters $\\Delta G_{ij}$. Express your final result as a single analytic expression. Do not substitute numerical values. Do not include units in your answer.", "solution": "The problem statement submitted for analysis is deemed valid. It is scientifically grounded in the established principles of biophysical chemistry, specifically the nearest-neighbor model for nucleic acid thermodynamics. The problem is well-posed, objective, and contains sufficient information for a unique, rigorous derivation. No scientific flaws, contradictions, or ambiguities are present. We shall therefore proceed with the derivation.\n\nThe objective is to derive an expression for the total standard-state hybridization free energy, $\\Delta G_{\\mathrm{hyb}}$, of an RNA-DNA duplex of length $L$. The derivation must begin from the fundamental principles provided.\n\nThe first principle is the relationship between the standard free energy change $\\Delta G^{\\circ}$ and the equilibrium constant $K$ for a reaction:\n$$ \\Delta G^{\\circ} = - R T \\ln K $$\nHere, $R$ is the universal gas constant and $T$ is the absolute temperature. For the hybridization reaction between the RNA spacer and the DNA target, this becomes $\\Delta G_{\\mathrm{hyb}} = - R T \\ln K_{\\mathrm{hyb}}$, where $K_{\\mathrm{hyb}}$ is the equilibrium constant for duplex formation.\n\nThe second principle is the nearest-neighbor additivity, which, in a statistical mechanical framework, implies that the partition function of the duplex state, $Z_{\\mathrm{duplex}}$, is factorizable into local, independent contributions. The formation of a duplex of length $L$ can be conceptualized as a sequence of events: an initial nucleation or initiation step to form the first base pair, followed by $L-1$ propagation or stacking steps to form the complete duplex.\n\nLet the equilibrium constant for the initiation step be $K_{\\mathrm{init}}$. Let the equilibrium constant for the stacking at step $k$, which involves the dinucleotide from position $k$ to $k+1$, be $K_{\\mathrm{stack},k}$. Based on the assumption of independent nearest-neighbor interactions, the total equilibrium constant for hybridization is the product of the equilibrium constants for each of these sequential steps:\n$$ K_{\\mathrm{hyb}} = K_{\\mathrm{init}} \\times \\prod_{k=1}^{L-1} K_{\\mathrm{stack},k} $$\nThis factorization is the direct consequence of the assumed factorizability of the partition function.\n\nSubstituting this expression for $K_{\\mathrm{hyb}}$ into the thermodynamic equation for $\\Delta G_{\\mathrm{hyb}}$ yields:\n$$ \\Delta G_{\\mathrm{hyb}} = - R T \\ln \\left( K_{\\mathrm{init}} \\times \\prod_{k=1}^{L-1} K_{\\mathrm{stack},k} \\right) $$\nUsing the property of logarithms that $\\ln(ab) = \\ln(a) + \\ln(b)$ and $\\ln(a^n) = n\\ln(a)$, we can expand this expression into a sum of free-energy terms:\n$$ \\Delta G_{\\mathrm{hyb}} = - R T \\ln(K_{\\mathrm{init}}) - R T \\ln \\left( \\prod_{k=1}^{L-1} K_{\\mathrm{stack},k} \\right) $$\n$$ \\Delta G_{\\mathrm{hyb}} = - R T \\ln(K_{\\mathrm{init}}) - R T \\sum_{k=1}^{L-1} \\ln(K_{\\mathrm{stack},k}) $$\nWe now define the free energy contribution of each step. The initiation free energy is $\\Delta G_{\\mathrm{init}} = - R T \\ln(K_{\\mathrm{init}})$. The stacking free energy for the step at position $k$ is $\\Delta G_{\\mathrm{stack},k} = - R T \\ln(K_{\\mathrm{stack},k})$. With these definitions, the total hybridization free energy becomes an additive sum:\n$$ \\Delta G_{\\mathrm{hyb}} = \\Delta G_{\\mathrm{init}} + \\sum_{k=1}^{L-1} \\Delta G_{\\mathrm{stack},k} $$\nThis equation is the formal statement of free energy additivity in the nearest-neighbor model.\n\nThe final step is to express $\\Delta G_{\\mathrm{stack},k}$ in terms of the specific parameters given in the problem. The model provides a library of dinucleotide-step free energy parameters, $\\Delta G_{ij}$, where the index $i$ corresponds to the RNA dinucleotide category and $j$ to the DNA dinucleotide category for a given step. The identity of the step at position $k$ is given by the indicator variables $x_{ij}^{(k)}$, which is defined to be $1$ if the step at $k$ is of category $(i,j)$ and $0$ otherwise.\n\nFor any given step $k$, only one specific pair of dinucleotide categories $(i,j)$ will be present. Therefore, the stacking free energy for that step, $\\Delta G_{\\mathrm{stack},k}$, is precisely the value $\\Delta G_{ij}$ corresponding to that specific category pair. We can write this selection process formally as a weighted sum over all possible categories. Since for each $k$, exactly one $x_{ij}^{(k)}$ is $1$ and all others are $0$ (guaranteed by the constraint $\\sum_{i}\\sum_{j} x_{ij}^{(k)} = 1$), this sum correctly isolates the single relevant term:\n$$ \\Delta G_{\\mathrm{stack},k} = \\sum_{i} \\sum_{j} x_{ij}^{(k)} \\Delta G_{ij} $$\nThis expression holds for each stacking step $k$ from $1$ to $L-1$.\n\nBy substituting this expression for the stacking free energy of a single step back into the equation for the total hybridization free energy, we arrive at the final closed-form expression:\n$$ \\Delta G_{\\mathrm{hyb}} = \\Delta G_{\\mathrm{init}} + \\sum_{k=1}^{L-1} \\left( \\sum_{i} \\sum_{j} x_{ij}^{(k)} \\Delta G_{ij} \\right) $$\nThis expression represents the total standard-state hybridization free energy as the sum of a constant initiation term and the sum of stacking free energies over all $L-1$ dinucleotide steps, where each step's contribution is determined by the specific RNA and DNA dinucleotides involved. This completes the derivation.", "answer": "$$\n\\boxed{\\Delta G_{\\mathrm{init}} + \\sum_{k=1}^{L-1} \\sum_{i} \\sum_{j} x_{ij}^{(k)} \\Delta G_{ij}}\n$$", "id": "2727934"}, {"introduction": "While rigorous thermodynamic models are foundational, practical gRNA design often employs simplified, computationally efficient scoring functions to rapidly evaluate thousands of potential off-target sites. These models typically assign position-dependent penalties to mismatches, a concept rooted in the empirical observation that mismatches in the PAM-proximal \"seed\" region are far more detrimental to binding than those in the distal region. This practice challenges you to work with such a weighted mismatch model and determine an appropriate score threshold that satisfies multiple biological design rules, providing hands-on experience in translating qualitative design goals into quantitative decision boundaries [@problem_id:2727956].", "problem": "A design team is constructing a guide RNA (gRNA) for Clustered Regularly Interspaced Short Palindromic Repeats (CRISPR) targeting and wishes to control off-target binding through a weighted mismatch model grounded in the central dogma principle that base-pair complementarity governs hybridization, and that mismatches reduce effective binding affinity. Assume a $20$-nucleotide (nt) gRNA with positions indexed $i \\in \\{1,\\dots,20\\}$, where the Protospacer Adjacent Motif (PAM)-proximal seed region is $i \\in \\{1,\\dots,10\\}$ and the distal region is $i \\in \\{11,\\dots,20\\}$. The off-target score is defined as\n$$\nS \\;=\\; \\sum_{i=1}^{20} w_i\\, m_i,\n$$\nwhere $m_i \\in \\{0,1\\}$ indicates a mismatch at position $i$ and $w_i \\ge 0$ is a positional penalty weight that quantifies the energetic penalty contribution of a mismatch at $i$. The decision rule is to deem a potential off-target acceptable if and only if $S \\le \\tau$, where $\\tau \\ge 0$ is a user-chosen threshold.\n\nSuppose empirical biophysics shows that seed mismatches contribute larger penalties than distal mismatches, and the team adopts the simplified, position-grouped weights\n$$\nw_i \\;=\\; \\begin{cases}\n0.6, & i \\in \\{1,\\dots,10\\} \\\\\n0.25, & i \\in \\{11,\\dots,20\\}.\n\\end{cases}\n$$\n\nThey wish to choose a single threshold $\\tau$ that simultaneously enforces all of the following design requirements:\n- Accept all candidates with at most $1$ mismatch anywhere (that is, all patterns with $\\sum_i m_i \\le 1$ should satisfy $S \\le \\tau$).\n- Reject any candidate with at least $3$ mismatches confined to the distal region (that is, any pattern with $m_i = 0$ for $i \\in \\{1,\\dots,10\\}$ and $\\sum_{i=11}^{20} m_i \\ge 3$ should satisfy $S > \\tau$).\n- Reject any candidate with at least $2$ mismatches in the seed region (that is, any pattern with $\\sum_{i=1}^{10} m_i \\ge 2$ should satisfy $S > \\tau$), regardless of distal mismatches.\n\nWhich of the following intervals for $\\tau$ achieves all three requirements?\n\nA. $0.25 \\le \\tau < 0.75$\n\nB. $0.6 \\le \\tau < 0.75$\n\nC. $0.6 \\le \\tau < 1.2$\n\nD. $0.75 \\le \\tau < 1.2$", "solution": "The problem statement must first be validated for scientific and logical integrity.\n\nStep 1: Extract Givens\n- Guide RNA (gRNA) length: $20$ nucleotides (nt).\n- Position index: $i \\in \\{1, \\dots, 20\\}$.\n- PAM-proximal seed region: positions $i \\in \\{1, \\dots, 10\\}$.\n- Distal region: positions $i \\in \\{11, \\dots, 20\\}$.\n- Off-target score: $S = \\sum_{i=1}^{20} w_i m_i$.\n- Mismatch indicator: $m_i \\in \\{0, 1\\}$, where $m_i=1$ denotes a mismatch.\n- Positional penalty weights: $w_i \\ge 0$.\n- Specific weights:\n$$\nw_i = \\begin{cases}\n0.6, & i \\in \\{1, \\dots, 10\\} \\\\\n0.25, & i \\in \\{11, \\dots, 20\\}.\n\\end{cases}\n$$\n- Decision rule: A potential off-target is acceptable if and only if its score $S$ satisfies $S \\le \\tau$, where $\\tau \\ge 0$ is a threshold. It is rejected if $S > \\tau$.\n- Design requirements for $\\tau$:\n    1. Accept all candidates with at most $1$ mismatch anywhere ($\\sum_i m_i \\le 1$).\n    2. Reject any candidate with at least $3$ mismatches confined to the distal region ($m_i = 0$ for $i \\in \\{1, \\dots, 10\\}$ and $\\sum_{i=11}^{20} m_i \\ge 3$).\n    3. Reject any candidate with at least $2$ mismatches in the seed region ($\\sum_{i=1}^{10} m_i \\ge 2$), regardless of distal mismatches.\n\nStep 2: Validate Using Extracted Givens\nThe problem is scientifically grounded. It presents a simplified but standard biophysical model for gRNA off-target prediction, based on the established principle that mismatch penalties are position-dependent, with the seed region being most critical. The use of a weighted sum is a common approach in bioinformatics scoring functions. The problem is well-posed; it provides a clear mathematical formulation and a set of constraints to determine a valid range for a parameter $\\tau$. All terms are defined, and the data are internally consistent. The problem is objective and formalizable.\n\nStep 3: Verdict and Action\nThe problem is valid. We will proceed to derive the solution.\n\nThe task is to find the interval for the threshold $\\tau$ that simultaneously satisfies all three design requirements. Each requirement imposes a constraint on $\\tau$. We will analyze them sequentially.\n\nRequirement 1: \"Accept all candidates with at most $1$ mismatch anywhere.\"\nThis means that for any mismatch pattern where the total number of mismatches $\\sum_{i=1}^{20} m_i \\le 1$, the score $S$ must satisfy the acceptance condition $S \\le \\tau$. To guarantee this for *all* such patterns, $\\tau$ must be greater than or equal to the maximum possible score among them.\n- Case of $0$ mismatches: $\\sum m_i = 0$. The score is $S = \\sum w_i (0) = 0$. This requires $0 \\le \\tau$, which is given.\n- Case of $1$ mismatch: $\\sum m_i = 1$.\n    - If the mismatch is in the seed region ($i \\in \\{1, \\dots, 10\\}$), the score is $S = 1 \\times w_{seed} = 0.6$.\n    - If the mismatch is in the distal region ($i \\in \\{11, \\dots, 20\\}$), the score is $S = 1 \\times w_{distal} = 0.25$.\nThe maximum score for a single mismatch is $\\max(0.6, 0.25) = 0.6$. Therefore, to accept all single-mismatch candidates, $\\tau$ must be at least this large.\nThis gives our first inequality:\n$$ \\tau \\ge 0.6 $$\n\nRequirement 2: \"Reject any candidate with at least $3$ mismatches confined to the distal region.\"\nThis means that for any pattern with $m_i = 0$ for $i \\in \\{1, \\dots, 10\\}$ and $\\sum_{i=11}^{20} m_i \\ge 3$, the score $S$ must satisfy the rejection condition $S > \\tau$. To guarantee this for *all* such patterns, $\\tau$ must be strictly less than the minimum possible score among them.\nThe score for such a pattern is $S = (\\sum_{i=11}^{20} m_i) \\times w_{distal}$.\nThe number of distal mismatches is at least $3$. The minimum score in this class occurs when there are exactly $3$ distal mismatches.\n$S_{min} = 3 \\times w_{distal} = 3 \\times 0.25 = 0.75$.\nAny other pattern in this class will have more than $3$ distal mismatches and thus a higher score. So, to reject all of them, $\\tau$ must be strictly less than this minimum score.\nThis gives our second inequality:\n$$ \\tau < 0.75 $$\n\nRequirement 3: \"Reject any candidate with at least $2$ mismatches in the seed region.\"\nThis means that for any pattern where the number of seed mismatches $\\sum_{i=1}^{10} m_i \\ge 2$, the score $S$ must satisfy the rejection condition $S > \\tau$. This must hold regardless of the number of mismatches in the distal region. To guarantee this for *all* such patterns, $\\tau$ must be strictly less than the minimum possible score among them.\nThe score is $S = (\\sum_{i=1}^{10} m_i) \\times w_{seed} + (\\sum_{i=11}^{20} m_i) \\times w_{distal}$.\nThe minimum number of seed mismatches is $2$. The minimum number of distal mismatches is $0$. The minimum score in this class occurs when there are exactly $2$ seed mismatches and $0$ distal mismatches.\n$S_{min} = 2 \\times w_{seed} + 0 \\times w_{distal} = 2 \\times 0.6 = 1.2$.\nAny other pattern in this class will have at least $2$ seed mismatches or additional distal mismatches, resulting in a score greater than or equal to $1.2$. To reject all such patterns, $\\tau$ must be strictly less than this minimum score.\nThis gives our third inequality:\n$$ \\tau < 1.2 $$\n\nCombining all three inequalities:\n1. $\\tau \\ge 0.6$\n2. $\\tau < 0.75$\n3. $\\tau < 1.2$\n\nThe intersection of $\\tau < 0.75$ and $\\tau < 1.2$ is the more restrictive condition, $\\tau < 0.75$. Combining this with the first inequality, we obtain the valid interval for $\\tau$:\n$$ 0.6 \\le \\tau < 0.75 $$\n\nNow we evaluate the given options.\n\nA. $0.25 \\le \\tau < 0.75$\nThis interval allows for values of $\\tau$ less than $0.6$, for example $\\tau = 0.5$. If $\\tau = 0.5$, a candidate with a single mismatch in the seed region has a score $S=0.6$. Since $S > \\tau$, this candidate would be rejected. This violates Requirement 1, which states that all candidates with one mismatch must be accepted. Therefore, this option is **Incorrect**.\n\nB. $0.6 \\le \\tau < 0.75$\nThis interval matches our derived result. Let's verify. Any $\\tau$ in this range satisfies all three conditions:\n- $\\tau \\ge 0.6$: This satisfies Requirement 1. The maximum score for one mismatch is $0.6$, and since $S=0.6 \\le \\tau$, it is accepted.\n- $\\tau < 0.75$: This satisfies Requirement 2. The minimum score for $\\ge 3$ distal mismatches is $0.75$, and since $S \\ge 0.75 > \\tau$, it is rejected.\n- $\\tau < 0.75 < 1.2$: This satisfies Requirement 3. The minimum score for $\\ge 2$ seed mismatches is $1.2$, and since $S \\ge 1.2 > \\tau$, it is rejected.\nTherefore, this option is **Correct**.\n\nC. $0.6 \\le \\tau < 1.2$\nThis interval allows for values of $\\tau$ greater than or equal to $0.75$, for example $\\tau = 0.8$. If $\\tau = 0.8$, a candidate with exactly $3$ mismatches in the distal region (and none in the seed region) has a score $S = 3 \\times 0.25 = 0.75$. Since $S \\le \\tau$ ($0.75 \\le 0.8$), this candidate would be accepted. This violates Requirement 2, which states that such candidates must be rejected. Therefore, this option is **Incorrect**.\n\nD. $0.75 \\le \\tau < 1.2$\nThis interval is invalid for two reasons. First, as explained for option C, any $\\tau \\ge 0.75$ violates Requirement 2. For the boundary case $\\tau = 0.75$, a candidate with $3$ distal mismatches has $S=0.75$. The rejection condition is $S > \\tau$, which means $0.75 > 0.75$. This is false, so the candidate is accepted, violating the requirement. Second, it violates Requirement 1 in a subtle way, as it forces the lower bound to be $0.75$ while only $0.6$ is needed. However, the violation of Requirement 2 is definitive. Therefore, this option is **Incorrect**.", "answer": "$$\\boxed{B}$$", "id": "2727956"}, {"introduction": "The most sophisticated gRNA design tools move beyond deterministic scores to probabilistic frameworks, which can formally integrate diverse data types and quantify uncertainty in predictions. A Bayesian approach is particularly powerful, as it allows us to systematically update our belief about a site's off-target potential by combining prior knowledge from genomic features (like sequence similarity and chromatin state) with new experimental evidence (like cleavage data from a sequencing assay). In this advanced exercise, you will construct a full Bayesian model for off-target prediction, guiding you through the process of defining prior probabilities, incorporating likelihoods from experimental data, and computing the final posterior probability of off-target activity [@problem_id:2727874].", "problem": "In the design of guide RNA (gRNA) sequences for Clustered Regularly Interspaced Short Palindromic Repeats (CRISPR) endonucleases, a central goal is to minimize off-target cleavage while preserving on-target efficacy. Consider a single candidate off-target genomic site for a given gRNA. Let the latent variable $O \\in \\{0,1\\}$ indicate whether this site is cleavable off-target ($O=1$) or not ($O=0$). You will construct a Bayesian framework in which the prior probability of off-target activity depends on sequence similarity and chromatin context, and the posterior is updated with sequencing-assay evidence.\n\nAs a fundamental base, use Bayes’ theorem and the standard logistic link for probabilities derived from linear predictors. Assume the following model components.\n\n1. Prior model linking sequence and chromatin features to the off-target probability. Let $m_{s}$ be the number of mismatches in the seed region, $m_{n}$ be the number of mismatches in the non-seed region, $A \\in [0,1]$ be the chromatin accessibility at the candidate site (for example, from Assay for Transposase-Accessible Chromatin sequencing), and $I_{\\text{ncPAM}} \\in \\{0,1\\}$ indicate whether the protospacer adjacent motif (PAM) is noncanonical. Let the prior off-target probability be $p_{0} \\equiv \\mathbb{P}(O=1 \\mid m_{s}, m_{n}, A, I_{\\text{ncPAM}})$, with the logistic specification\n$$\n\\operatorname{logit}(p_{0}) \\equiv \\ln\\!\\left(\\frac{p_{0}}{1-p_{0}}\\right) \\;=\\; \\alpha \\;-\\; \\beta_{s}\\, m_{s} \\;-\\; \\beta_{n}\\, m_{n} \\;+\\; \\beta_{A}\\, A \\;-\\; \\beta_{P}\\, I_{\\text{ncPAM}}.\n$$\n\n2. Evidence model for a sequencing-based double-strand break detection assay (for example, Genome-wide Unbiased Identification of DSBs Enabled by Sequencing), summarized by a read count $R \\in \\{0,1,2,\\ldots\\}$ at the candidate site. Conditional on $O$, assume a Poisson read-count model with means $\\lambda_{1}$ if $O=1$ and $\\lambda_{0}$ if $O=0$:\n$$\nR \\mid (O=1) \\sim \\operatorname{Poisson}(\\lambda_{1}), \\qquad R \\mid (O=0) \\sim \\operatorname{Poisson}(\\lambda_{0}).\n$$\n\n(a) Starting from Bayes’ theorem and the definitions above, derive a closed-form expression for the posterior probability $\\mathbb{P}(O=1 \\mid R=r, m_{s}, m_{n}, A, I_{\\text{ncPAM}})$ in terms of $\\alpha$, $\\beta_{s}$, $\\beta_{n}$, $\\beta_{A}$, $\\beta_{P}$, $m_{s}$, $m_{n}$, $A$, $I_{\\text{ncPAM}}$, $\\lambda_{1}$, $\\lambda_{0}$, and $r$.\n\n(b) Using your derived expression, compute the posterior probability for the parameter values\n$$\n\\alpha = -2.5,\\;\\; \\beta_{s} = 1.0,\\;\\; \\beta_{n} = 0.3,\\;\\; \\beta_{A} = 2.0,\\;\\; \\beta_{P} = 0.8,\n$$\nthe observed features\n$$\nm_{s} = 1,\\;\\; m_{n} = 2,\\;\\; A = 0.6,\\;\\; I_{\\text{ncPAM}} = 1,\n$$\nand the assay model and observation\n$$\n\\lambda_{1} = 6.0,\\;\\; \\lambda_{0} = 0.5,\\;\\; r = 3.\n$$\nReport the posterior probability as a decimal in the interval $[0,1]$. Round your answer to four significant figures. Do not use a percent sign.", "solution": "The problem is scientifically grounded, well-posed, and objective. It presents a standard application of Bayesian statistical modeling to a pertinent problem in computational biology, specifically the prediction of CRISPR-Cas9 off-target activity. All necessary components for a unique solution are provided, and there are no contradictions or ambiguities. Therefore, the problem is valid, and we may proceed with the solution.\n\nLet the set of features be denoted by $\\mathcal{F} = \\{m_{s}, m_{n}, A, I_{\\text{ncPAM}}\\}$. We are tasked with deriving the posterior probability of off-target cleavage, $\\mathbb{P}(O=1 \\mid R=r, \\mathcal{F})$, and then computing its value for a given set of parameters and observations.\n\n(a) Derivation of the posterior probability.\n\nWe begin with Bayes' theorem. It is most convenient to work with odds. The posterior odds of an event are the ratio of its posterior probability to the posterior probability of its complement.\n$$ \\frac{\\mathbb{P}(O=1 \\mid R=r, \\mathcal{F})}{\\mathbb{P}(O=0 \\mid R=r, \\mathcal{F})} = \\frac{\\mathbb{P}(R=r \\mid O=1, \\mathcal{F})}{\\mathbb{P}(R=r \\mid O=0, \\mathcal{F})} \\times \\frac{\\mathbb{P}(O=1 \\mid \\mathcal{F})}{\\mathbb{P}(O=0 \\mid \\mathcal{F})} $$\nThis equation states that the posterior odds are the product of the Bayes factor and the prior odds.\n\nThe problem states that the observation $R$ is conditionally independent of the features $\\mathcal{F}$ given the state $O$. Thus, $\\mathbb{P}(R=r \\mid O, \\mathcal{F}) = \\mathbb{P}(R=r \\mid O)$.\n\nThe prior probability is defined as $p_{0} \\equiv \\mathbb{P}(O=1 \\mid \\mathcal{F})$. The prior odds are therefore $\\frac{p_{0}}{1-p_{0}}$. The problem provides the logit of this probability:\n$$ \\operatorname{logit}(p_{0}) = \\ln\\left(\\frac{p_{0}}{1-p_{0}}\\right) = \\alpha - \\beta_{s} m_{s} - \\beta_{n} m_{n} + \\beta_{A} A - \\beta_{P} I_{\\text{ncPAM}} $$\nLet this linear predictor be denoted $L_0$. The prior odds can be expressed as:\n$$ \\frac{\\mathbb{P}(O=1 \\mid \\mathcal{F})}{\\mathbb{P}(O=0 \\mid \\mathcal{F})} = \\exp(L_0) = \\exp(\\alpha - \\beta_{s} m_{s} - \\beta_{n} m_{n} + \\beta_{A} A - \\beta_{P} I_{\\text{ncPAM}}) $$\n\nThe Bayes factor, $BF$, is the ratio of the likelihoods of the observation $R=r$ under the two hypotheses, $O=1$ and $O=0$. The likelihoods are given by the Poisson probability mass function, $P(k; \\lambda) = \\frac{\\lambda^k e^{-\\lambda}}{k!}$.\n$$ BF = \\frac{\\mathbb{P}(R=r \\mid O=1)}{\\mathbb{P}(R=r \\mid O=0)} = \\frac{\\frac{\\lambda_{1}^{r} \\exp(-\\lambda_{1})}{r!}}{\\frac{\\lambda_{0}^{r} \\exp(-\\lambda_{0})}{r!}} = \\left(\\frac{\\lambda_{1}}{\\lambda_{0}}\\right)^{r} \\exp(-\\lambda_{1} + \\lambda_{0}) $$\n\nThe posterior odds are the product of the prior odds and the Bayes factor:\n$$ \\text{Odds}_{\\text{post}} = \\frac{\\mathbb{P}(O=1 \\mid R=r, \\mathcal{F})}{\\mathbb{P}(O=0 \\mid R=r, \\mathcal{F})} = \\left[ \\left(\\frac{\\lambda_{1}}{\\lambda_{0}}\\right)^{r} \\exp(\\lambda_{0} - \\lambda_{1}) \\right] \\times \\exp(L_0) $$\nThe logarithm of the posterior odds, which is the posterior logit, is:\n$$ \\ln(\\text{Odds}_{\\text{post}}) = r \\ln\\left(\\frac{\\lambda_{1}}{\\lambda_{0}}\\right) + (\\lambda_{0} - \\lambda_{1}) + L_{0} $$\n\nTo obtain the posterior probability, which we denote $P_{\\text{post}} = \\mathbb{P}(O=1 \\mid R=r, \\mathcal{F})$, we use the relationship between a probability $p$ and its odds, $p = \\frac{\\text{Odds}}{1 + \\text{Odds}}$. This is equivalent to applying the standard logistic function (sigmoid) $\\sigma(z) = \\frac{1}{1 + \\exp(-z)}$ to the log-odds.\nLet $Z = \\ln(\\text{Odds}_{\\text{post}})$. Then $P_{\\text{post}} = \\sigma(Z) = \\frac{1}{1 + \\exp(-Z)}$.\n\nSubstituting the full expressions, the closed-form expression for the posterior probability is:\n$$ \\mathbb{P}(O=1 \\mid R=r, m_{s}, m_{n}, A, I_{\\text{ncPAM}}) = \\frac{1}{1 + \\exp\\left(-\\left( r \\ln\\left(\\frac{\\lambda_{1}}{\\lambda_{0}}\\right) + \\lambda_{0} - \\lambda_{1} + \\alpha - \\beta_{s} m_{s} - \\beta_{n} m_{n} + \\beta_{A} A - \\beta_{P} I_{\\text{ncPAM}} \\right)\\right)} $$\nThis completes part (a).\n\n(b) Computation of the posterior probability.\n\nWe are given the following values:\nParameters: $\\alpha = -2.5$, $\\beta_{s} = 1.0$, $\\beta_{n} = 0.3$, $\\beta_{A} = 2.0$, $\\beta_{P} = 0.8$.\nFeatures: $m_{s} = 1$, $m_{n} = 2$, $A = 0.6$, $I_{\\text{ncPAM}} = 1$.\nAssay model and observation: $\\lambda_{1} = 6.0$, $\\lambda_{0} = 0.5$, $r = 3$.\n\nFirst, we compute the prior log-odds, $L_0$:\n$$ L_0 = \\alpha - \\beta_{s} m_{s} - \\beta_{n} m_{n} + \\beta_{A} A - \\beta_{P} I_{\\text{ncPAM}} $$\n$$ L_0 = -2.5 - (1.0)(1) - (0.3)(2) + (2.0)(0.6) - (0.8)(1) $$\n$$ L_0 = -2.5 - 1.0 - 0.6 + 1.2 - 0.8 $$\n$$ L_0 = -3.7 $$\n\nNext, we compute the log-Bayes factor, $\\ln(BF)$:\n$$ \\ln(BF) = r \\ln\\left(\\frac{\\lambda_{1}}{\\lambda_{0}}\\right) + \\lambda_{0} - \\lambda_{1} $$\n$$ \\ln(BF) = 3 \\ln\\left(\\frac{6.0}{0.5}\\right) + 0.5 - 6.0 $$\n$$ \\ln(BF) = 3 \\ln(12) - 5.5 $$\nUsing the value $\\ln(12) \\approx 2.4849066$,\n$$ \\ln(BF) \\approx 3 \\times 2.4849066 - 5.5 = 7.45472 - 5.5 = 1.95472 $$\n\nNow, we compute the posterior log-odds, $Z$, by summing the prior log-odds and the log-Bayes factor:\n$$ Z = L_0 + \\ln(BF) $$\n$$ Z \\approx -3.7 + 1.95472 = -1.74528 $$\n\nFinally, we compute the posterior probability $P_{\\text{post}}$ using the logistic function:\n$$ P_{\\text{post}} = \\frac{1}{1 + \\exp(-Z)} $$\n$$ P_{\\text{post}} \\approx \\frac{1}{1 + \\exp(-(-1.74528))} = \\frac{1}{1 + \\exp(1.74528)} $$\n$$ P_{\\text{post}} \\approx \\frac{1}{1 + 5.72745} = \\frac{1}{6.72745} \\approx 0.148648 $$\n\nRounding the result to four significant figures, as requested, gives $0.1486$.", "answer": "$$\\boxed{0.1486}$$", "id": "2727874"}]}