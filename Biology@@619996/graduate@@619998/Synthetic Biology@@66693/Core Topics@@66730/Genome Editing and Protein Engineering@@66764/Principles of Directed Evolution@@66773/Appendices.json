{"hands_on_practices": [{"introduction": "The foundation of any directed evolution experiment is the creation of genetic diversity. A widely used method, error-prone PCR, introduces mutations randomly across a gene. This exercise [@problem_id:2761288] grounds this process in fundamental probability theory, guiding you to calculate the necessary per-base error rate $p$ to achieve a desired average number of mutations $\\mu$ in a gene of length $L$. Mastering this calculation, derived from the principle of linearity of expectation for Bernoulli trials, is a critical first step in designing a mutant library with the optimal level of diversity.", "problem": "In a directed evolution campaign, you plan to generate a mutant library of a single gene using error-prone polymerase chain reaction (PCR). Assume a single effective mutagenic incorporation step per gene copy, meaning that across the full gene length each position experiences one mutagenic incorporation event that can independently introduce an error with identical probability. Let the gene length be $1.2\\,\\mathrm{kb}$ and the target library have an average of $1.5$ nucleotide substitutions per gene copy.\n\nUsing only the following foundational principles:\n- The gene has $L$ positions (base pairs), here $L = 1.2\\,\\mathrm{kb}$.\n- Each base is an independent Bernoulli trial with per-base error probability $p$ per effective mutagenic incorporation step.\n- The total number of mutations per gene is the sum of $L$ independent Bernoulli trials, and its expectation is the sum of individual expectations.\n\nDerive, from first principles, the required per-base error probability $p$ per effective mutagenic incorporation step that achieves the specified average number of mutations per gene. Express your final answer as a unitless decimal and round to four significant figures.", "solution": "The problem as stated is subjected to validation.\n\n**Step 1: Extracted Givens**\n- Gene length: $L = 1.2\\,\\mathrm{kb}$\n- Target average number of nucleotide substitutions per gene copy: $\\mu = 1.5$\n- Assumption: A single effective mutagenic incorporation step per gene copy.\n- Principle: The gene has $L$ positions.\n- Principle: Each base is an independent Bernoulli trial with a per-base error probability $p$.\n- Principle: The total number of mutations is the sum of $L$ independent Bernoulli trials, and its expectation is the sum of individual expectations.\n- Objective: Derive the per-base error probability $p$.\n- Final format: Unitless decimal rounded to four significant figures.\n\n**Step 2: Validation Verdict**\nThe problem is scientifically grounded in the principles of molecular biology and probability theory. The model of mutagenesis presented—a series of independent Bernoulli trials—is a standard and valid simplification used in the field of directed evolution. The given parameters, a gene of $1.2\\,\\mathrm{kb}$ and an average of $1.5$ mutations, are realistic for an error-prone PCR experiment. The problem is well-posed, with sufficient information and clear, objective language. It contains no contradictions, ambiguities, or factual inaccuracies.\n\nThe problem is therefore deemed **valid**. We proceed to the solution.\n\nThe derivation must begin from first principles as dictated. The problem concerns the expected number of mutations in a gene of a given length, arising from a process where each base has a specific probability of mutation.\n\nLet $L$ be the length of the gene in base pairs. The problem states $L = 1.2\\,\\mathrm{kb}$. Since $1\\,\\mathrm{kb}$ is equivalent to $1000$ base pairs, the length is:\n$$L = 1.2 \\times 1000 = 1200 \\text{ base pairs}$$\nLet $p$ be the per-base error probability per effective mutagenic incorporation step. This is the quantity we must determine.\n\nAccording to the problem's principles, the event of a mutation occurring at any single base position is an independent Bernoulli trial. Let us define a set of random variables, $\\{X_i\\}_{i=1}^{L}$, where $X_i$ corresponds to the outcome at the $i$-th base position.\nThe variable $X_i$ can take two values:\n- $X_i = 1$ if a mutation occurs at position $i$.\n- $X_i = 0$ if no mutation occurs at position $i$.\n\nThe probability of a mutation at any given position is $p$. Thus, the probability mass function for each $X_i$ is:\n$$P(X_i = 1) = p$$\n$$P(X_i = 0) = 1 - p$$\nThe expected value of a single Bernoulli trial, $E[X_i]$, is by definition:\n$$E[X_i] = (1 \\times P(X_i = 1)) + (0 \\times P(X_i = 0)) = (1 \\times p) + (0 \\times (1-p)) = p$$\n\nThe total number of mutations, $M$, in a single gene copy is the sum of the outcomes of these $L$ independent trials:\n$$M = \\sum_{i=1}^{L} X_i$$\nThe problem asks for the condition that sets the average number of mutations per gene copy to a target value, $\\mu = 1.5$. The \"average\" of a random variable is its expected value, $E[M]$. We must therefore calculate the expected value of $M$.\n\nUsing the principle of linearity of expectation, which states that the expectation of a sum of random variables is the sum of their individual expectations, we have:\n$$E[M] = E\\left[\\sum_{i=1}^{L} X_i\\right] = \\sum_{i=1}^{L} E[X_i]$$\nSince each position is assumed to have the identical per-base error probability $p$, the expectation $E[X_i]$ is the same for all $i=1, 2, \\dots, L$.\n$$E[X_i] = p$$\nSubstituting this into the sum:\n$$E[M] = \\sum_{i=1}^{L} p = L \\cdot p$$\nThe problem specifies that the target average number of mutations is $\\mu = 1.5$. Therefore, we set $E[M] = \\mu$:\n$$\\mu = L \\cdot p$$\nWe are asked to find the value of $p$ that satisfies this condition. We can rearrange the equation to solve for $p$:\n$$p = \\frac{\\mu}{L}$$\nNow, we substitute the given numerical values: $\\mu = 1.5$ and $L = 1200$.\n$$p = \\frac{1.5}{1200}$$\nPerforming the calculation:\n$$p = 0.00125$$\nThe problem requires the final answer to be rounded to four significant figures. The number $0.00125$ has three significant figures (the digits $1$, $2$, and $5$). To express this result with four significant figures, we must add a trailing zero.\n$$p = 0.001250$$\nThis is the required per-base error probability per effective mutagenic incorporation step to achieve an average of $1.5$ mutations per $1.2\\,\\mathrm{kb}$ gene.", "answer": "$$\\boxed{0.001250}$$", "id": "2761288"}, {"introduction": "Once a library of variants is generated, the core of directed evolution is the process of selection, which iteratively enriches the population with beneficial variants. This practice [@problem_id:2761248] models the dynamics of a survival-based selection, asking you to quantify the enrichment of active variants over multiple rounds. By deriving how the ratio of active to inactive variants changes geometrically, you will gain a powerful intuition for how even small differences in fitness, when compounded, lead to exponential enrichment and successful evolution.", "problem": "A survival-based directed evolution campaign screens a large library containing two classes of variants: catalytically active and inactive. In each selection round, each molecule independently survives with a class-conditional probability, and survivors are then amplified and normalized back to the same total population size without bias, so that post-round class frequencies reflect only survival. Let the initial fraction of active variants be $f_{A,0}$ and the initial fraction of inactive variants be $f_{I,0} = 1 - f_{A,0}$. The per-round survival probabilities are $p_{A} = 0.3$ for active variants and $p_{I} = 0.01$ for inactive variants, and these probabilities remain constant across rounds. Assume independence of survival events across rounds and variants, no class interconversion, and that amplification is unbiased with respect to activity.\n\nDefine the active-to-inactive odds after round $r$ as $R_{r} = f_{A,r} / f_{I,r}$, where $f_{A,r}$ and $f_{I,r}$ are the post-round frequencies of active and inactive variants, respectively. Define the enrichment after $r$ rounds as the fold-change in odds relative to the initial odds, $E_{r} = R_{r} / R_{0}$.\n\nStarting from these definitions and the basic rules of conditional probability, derive $E_{3}$ and compute its value for $p_{A} = 0.3$ and $p_{I} = 0.01$. Express your final answer as an exact value with no rounding and no units.", "solution": "The problem as stated will first be subjected to a rigorous validation to ensure it is scientifically sound, well-posed, and objective.\n\nStep 1: Extraction of Givens.\nThe explicit data and definitions provided are:\n- Two classes of variants: active and inactive.\n- Survival is independent and class-conditional.\n- Post-selection amplification is unbiased and normalizes the total population size.\n- Initial fraction of active variants: $f_{A,0}$.\n- Initial fraction of inactive variants: $f_{I,0} = 1 - f_{A,0}$.\n- Per-round survival probability for active variants: $p_{A} = 0.3$.\n- Per-round survival probability for inactive variants: $p_{I} = 0.01$.\n- These probabilities are constant across all rounds.\n- Definition of active-to-inactive odds after round $r$: $R_{r} = f_{A,r} / f_{I,r}$.\n- Definition of enrichment after $r$ rounds: $E_{r} = R_{r} / R_{0}$.\nThe task is to derive an expression for $E_{3}$ and compute its numerical value.\n\nStep 2: Validation.\nThe problem describes a simplified mathematical model of a selection process in directed evolution, a standard technique in synthetic biology and biochemistry. The model is based on fundamental principles of probability theory. All terms are defined with mathematical precision. The given probabilities, $p_{A} = 0.3$ and $p_{I} = 0.01$, are physically plausible for a stringent selection process. The problem is self-contained and logically consistent; although the initial fraction $f_{A,0}$ is not specified, it will be shown to be irrelevant for the calculation of enrichment, $E_{r}$. The problem violates no principles of science or logic. It is well-posed and objective.\n\nVerdict: The problem is valid. A solution will be derived.\n\nThe derivation proceeds from the definitions provided. Let $N$ be the total number of molecules in the library after normalization in any round. After round $r-1$, the number of active variants is $N_{A, r-1} = N \\cdot f_{A, r-1}$ and the number of inactive variants is $N_{I, r-1} = N \\cdot f_{I, r-1}$.\n\nIn the selection step of round $r$, these populations are subjected to selection. The expected number of surviving molecules from each class is:\n- Expected survivors of active variants: $N_{A, \\text{surv}} = N_{A, r-1} \\cdot p_{A}$\n- Expected survivors of inactive variants: $N_{I, \\text{surv}} = N_{I, r-1} \\cdot p_{I}$\n\nThe problem states that amplification is unbiased. This means that the ratio of the number of active to inactive molecules is preserved during amplification. Therefore, the ratio of frequencies after round $r$ is determined solely by the ratio of survivors. The frequency of active variants after round $r$, $f_{A,r}$, is proportional to $N_{A, \\text{surv}}$, and the frequency of inactive variants, $f_{I,r}$, is proportional to $N_{I, \\text{surv}}$.\n\nThe odds after round $r$, $R_{r}$, are defined as the ratio of the frequencies:\n$$R_{r} = \\frac{f_{A,r}}{f_{I,r}}$$\nBecause the frequencies are proportional to the number of molecules in each class, this ratio is equivalent to the ratio of the number of molecules:\n$$R_{r} = \\frac{N_{A,r}}{N_{I,r}}$$\nThe numbers of molecules after amplification in round $r$, $N_{A,r}$ and $N_{I,r}$, are proportional to the number of survivors from the selection step. Thus, their ratio is:\n$$R_{r} = \\frac{N_{A,r}}{N_{I,r}} = \\frac{N_{A, \\text{surv}}}{N_{I, \\text{surv}}} = \\frac{N_{A, r-1} \\cdot p_{A}}{N_{I, r-1} \\cdot p_{I}}$$\nWe recognize that the ratio $N_{A, r-1} / N_{I, r-1}$ is precisely the odds after the previous round, $R_{r-1}$. This yields a recurrence relation for the odds:\n$$R_{r} = \\left(\\frac{N_{A, r-1}}{N_{I, r-1}}\\right) \\cdot \\left(\\frac{p_{A}}{p_{I}}\\right) = R_{r-1} \\cdot \\left(\\frac{p_{A}}{p_{I}}\\right)$$\nThis is a geometric progression. We can express $R_{r}$ in terms of the initial odds, $R_{0}$, by applying the relation recursively:\n$$R_{1} = R_{0} \\cdot \\left(\\frac{p_{A}}{p_{I}}\\right)$$\n$$R_{2} = R_{1} \\cdot \\left(\\frac{p_{A}}{p_{I}}\\right) = \\left(R_{0} \\cdot \\frac{p_{A}}{p_{I}}\\right) \\cdot \\left(\\frac{p_{A}}{p_{I}}\\right) = R_{0} \\cdot \\left(\\frac{p_{A}}{p_{I}}\\right)^{2}$$\nBy induction, the odds after $r$ rounds are given by:\n$$R_{r} = R_{0} \\cdot \\left(\\frac{p_{A}}{p_{I}}\\right)^{r}$$\nThe enrichment, $E_{r}$, is defined as the fold-change in odds relative to the initial odds, $E_{r} = R_{r} / R_{0}$. Substituting the expression for $R_{r}$:\n$$E_{r} = \\frac{R_{0} \\cdot \\left(\\frac{p_{A}}{p_{I}}\\right)^{r}}{R_{0}}$$\nThe initial odds $R_{0}$ cancel, confirming that the initial fraction of active variants $f_{A,0}$ is not required. The general formula for enrichment after $r$ rounds is:\n$$E_{r} = \\left(\\frac{p_{A}}{p_{I}}\\right)^{r}$$\nThe problem asks for the enrichment after $r=3$ rounds, $E_{3}$. We substitute $r=3$:\n$$E_{3} = \\left(\\frac{p_{A}}{p_{I}}\\right)^{3}$$\nNow, we insert the given numerical values for the survival probabilities, $p_{A} = 0.3$ and $p_{I} = 0.01$.\n$$E_{3} = \\left(\\frac{0.3}{0.01}\\right)^{3}$$\nThe ratio of probabilities is:\n$$\\frac{0.3}{0.01} = \\frac{3 \\times 10^{-1}}{1 \\times 10^{-2}} = 3 \\times 10^{1} = 30$$\nSubstituting this value back into the expression for $E_{3}$:\n$$E_{3} = (30)^{3} = 30 \\times 30 \\times 30 = 900 \\times 30 = 27000$$\nThe enrichment after $3$ rounds is $27000$. This is an exact value.", "answer": "$$\\boxed{27000}$$", "id": "2761248"}, {"introduction": "A successful directed evolution campaign requires more than just creating diversity and applying selection; it demands rigorous quantitative planning to ensure the experiment is sufficiently powered to find the rare, improved variants. This final hands-on practice [@problem_id:2761252] presents a holistic design challenge, requiring you to integrate multiple probabilistic factors—the frequency of functional sequences in your library, the viability of clones, and the sensitivity of your screening assay. By calculating the minimum number of clones to screen for a high probability of success, you will learn how to translate foundational principles into a practical, resource-efficient experimental plan.", "problem": "You have identified sign epistasis between two amino acid substitutions at positions $A$ and $B$ in an enzyme: each single mutation is deleterious on the original background, but the double mutant $A^{\\ast}B^{\\ast}$ is conditionally beneficial only on certain compensatory sequence backgrounds at three additional positions $C$, $D$, and $E$. Your goal is to design a directed evolution strategy to explore compensatory backgrounds and to compute the minimal screening library size required to detect at least one functional combination with high probability.\n\nDesign constraints and empirical inputs:\n- You will fix the double mutant $A^{\\ast}B^{\\ast}$ in the template and confine diversity to positions $C$, $D$, and $E$ using doped oligonucleotides. For each of these positions, prior single-site deep mutational scanning suggests an “allowed set” of residues compatible with the $A^{\\ast}B^{\\ast}$ double mutant that preserve folding and catalytic geometry.\n- To bias the library toward these allowed sets while retaining exploratory diversity, you choose degenerate mixes at each position such that the marginal probability that a draw falls within the allowed set is $p_{C} = 0.25$, $p_{D} = 0.20$, and $p_{E} = 0.15$. Within each allowed set, residues are approximately equiprobable (assume negligible codon bias within the allowed sets).\n- Due to assembly and expression defects, only a fraction $v = 0.85$ of assembled variants are viable (expressed, in-frame, and free of truncating errors).\n- Screening will be performed by Fluorescence-Activated Droplet Sorting (FADS), which, based on benchmarking with control variants, has a false negative rate such that a truly functional clone is detected as a “hit” with sensitivity $s = 0.80$. False positives are negligible for the purposes of planning.\n- Assume independence between positions $C$, $D$, and $E$ in the constructed library; independence between clone outcomes; and that functionality given $A^{\\ast}B^{\\ast}$ is determined solely by membership of residues at $C$, $D$, and $E$ in their allowed sets.\n\nPlan specification: Briefly outline a recombination and screening strategy that adheres to principles of directed evolution and is consistent with the inputs above, making explicit how you will generate the library and assay function. Then, using only foundational probability principles for independent Bernoulli trials and without invoking any pre-packaged “coverage” formulas, derive from first principles an expression for the minimal number $N$ of independently screened clones required so that the probability of detecting at least one functional clone is at least $0.99$. Evaluate $N$ numerically as the smallest integer satisfying this criterion.\n\nAnswer format:\n- Report the minimal integer $N$ (a pure count of clones). Do not round; take the mathematical ceiling where appropriate.", "solution": "The problem posed is a well-defined exercise in probability theory applied to the design of a directed evolution experiment. It is scientifically grounded, internally consistent, and contains all necessary parameters for a quantitative solution. Therefore, the problem is valid.\n\nFirst, the experimental plan must be specified. The objective is to screen for functional variants of an enzyme containing the fixed double mutation $A^{\\ast}B^{\\ast}$ by exploring diversity at three compensatory sites $C$, $D$, and $E$.\nThe strategy proceeds as follows:\n$1$. **Library Construction**: A gene library will be generated from the template DNA encoding the $A^{\\ast}B^{\\ast}$ variant. Site-directed mutagenesis will be performed at the codons for positions $C$, $D$, and $E$ simultaneously. This is achieved using synthetic oligonucleotides containing degenerate base mixtures (doped codons, e.g., $NNS$ or custom trinucleotide mixes) in a standard polymerase chain reaction (PCR)-based method such as overlap extension PCR or QuikChange. The specific composition of the degenerate bases is calibrated to yield the desired marginal probabilities of sampling an amino acid from the allowed sets: $p_{C} = 0.25$, $p_{D} = 0.20$, and $p_{E} = 0.15$.\n$2$. **Library Expression**: The resulting pool of plasmid DNA is transformed into a suitable expression host, for example, *Escherichia coli*. Each cell will contain one variant of the gene, and the population of cells constitutes the protein variant library.\n$3$. **Screening**: The function of each variant will be assayed using Fluorescence-Activated Droplet Sorting (FADS). Cells are encapsulated in aqueous microdroplets along with a fluorogenic substrate for the enzyme. Functional enzyme variants will convert the substrate into a fluorescent product, increasing the fluorescence intensity of the droplet. The droplets are then passed through a microfluidic sorter, and those exhibiting fluorescence above a predetermined threshold are identified as \"hits\" and collected for subsequent sequencing and characterization. This high-throughput method allows for the screening of millions of variants.\n\nNext, we derive from first principles the minimal number of clones, $N$, that must be screened.\n\nLet $p_{hit}$ be the probability that a single, randomly selected clone from the constructed library is a \"successful hit\". A successful hit is a clone that is functional and is detected by the screening apparatus. Based on the problem statement, the following events must co-occur for a clone to be a successful hit:\n$1$. The clone must possess a functional amino acid sequence. Functionality is defined as having residues at positions $C$, $D$, and $E$ that are all within their respective \"allowed sets\". Given the independence of residue selection at these positions, the probability of a randomly generated sequence being functional, $P_{func}$, is the product of the individual probabilities:\n$$P_{func} = p_{C} \\cdot p_{D} \\cdot p_{E}$$\n$2$. The clone must be viable, meaning it is correctly expressed and folded. The probability of viability for any given clone is given as $v$.\n$3$. The clone must be detected by the FADS system. A clone can only be detected if it is functional (which implies it must also be viable, as a non-viable protein cannot function). The probability of detecting a truly functional clone is the sensitivity, $s$.\n\nWe assume that viability, sequence functionality, and the detection event (conditional on functionality) are independent. Thus, the probability $p_{hit}$ for a single trial (screening one clone) is the product of the probabilities of these independent events:\n$$p_{hit} = P(\\text{functional sequence}) \\times P(\\text{viable}) \\times P(\\text{detected | functional and viable})$$\n$$p_{hit} = (p_{C} \\cdot p_{D} \\cdot p_{E}) \\cdot v \\cdot s$$\n\nWe are screening $N$ clones independently. This constitutes a series of $N$ independent Bernoulli trials, where the probability of success in any given trial is $p_{hit}$. We are interested in the probability of observing at least one successful hit in $N$ trials. It is more direct to first calculate the probability of the complementary event: observing zero hits in $N$ trials.\n\nThe probability of failure in a single trial (i.e., not getting a successful hit) is $(1 - p_{hit})$.\nSince the $N$ trials are independent, the probability of failing in all $N$ trials is:\n$$P(\\text{zero hits in } N \\text{ trials}) = (1 - p_{hit})^{N}$$\nThe probability of obtaining at least one hit is therefore:\n$$P(\\text{at least one hit}) = 1 - P(\\text{zero hits in } N \\text{ trials}) = 1 - (1 - p_{hit})^{N}$$\nThe problem requires this probability to be at least $0.99$. We establish the inequality:\n$$1 - (1 - p_{hit})^{N} \\geq 0.99$$\nWe now solve for $N$:\n$$-(1 - p_{hit})^{N} \\geq 0.99 - 1$$\n$$-(1 - p_{hit})^{N} \\geq -0.01$$\n$$(1 - p_{hit})^{N} \\leq 0.01$$\nTo solve for the exponent $N$, we take the natural logarithm of both sides. As the natural logarithm function is monotonically increasing, the direction of the inequality is preserved.\n$$\\ln\\left((1 - p_{hit})^{N}\\right) \\leq \\ln(0.01)$$\n$$N \\ln(1 - p_{hit}) \\leq \\ln(0.01)$$\nSince $0  p_{hit}  1$, the term $(1 - p_{hit})$ is also between $0$ and $1$. Consequently, its natural logarithm, $\\ln(1 - p_{hit})$, is a negative number. When dividing an inequality by a negative number, the direction of the inequality must be reversed:\n$$N \\geq \\frac{\\ln(0.01)}{\\ln(1 - p_{hit})}$$\nThis gives the expression for the minimal number of clones $N$.\n\nNow, we substitute the given values to find the numerical result.\nThe given probabilities are:\n$p_{C} = 0.25$\n$p_{D} = 0.20$\n$p_{E} = 0.15$\n$v = 0.85$\n$s = 0.80$\n\nFirst, calculate $p_{hit}$:\n$$p_{hit} = (0.25 \\times 0.20 \\times 0.15) \\times 0.85 \\times 0.80$$\n$$p_{hit} = (0.0075) \\times 0.68$$\n$$p_{hit} = 0.0051$$\nNow, substitute this value into the inequality for $N$:\n$$N \\geq \\frac{\\ln(0.01)}{\\ln(1 - 0.0051)} = \\frac{\\ln(0.01)}{\\ln(0.9949)}$$\nUsing the properties of logarithms, $\\ln(0.01) = \\ln(10^{-2}) = -2\\ln(10)$.\n$$N \\geq \\frac{-4.605170...}{-0.0051129...} \\approx 900.6885$$\nSince the number of clones $N$ must be an integer, we must take the smallest integer that satisfies this condition. This is obtained by applying the ceiling function to the result.\n$$N = \\lceil 900.6885 \\rceil = 901$$\nTherefore, a minimum of $901$ clones must be screened to ensure that the probability of detecting at least one functional variant is at least $0.99$.", "answer": "$$\\boxed{901}$$", "id": "2761252"}]}