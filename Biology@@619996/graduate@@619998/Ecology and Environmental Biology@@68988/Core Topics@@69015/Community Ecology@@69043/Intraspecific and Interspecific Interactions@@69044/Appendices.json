{"hands_on_practices": [{"introduction": "Before exploring how species interact, we must master the dynamics that govern a single population. This practice [@problem_id:2500024] explores a model that incorporates a strong Allee effect, where small populations face a reduced per-capita growth rate. By deriving the equilibrium population densities and determining their stability, you will practice the foundational techniques of nonlinear systems analysis and gain insight into how intraspecific processes can generate critical thresholds for population persistence.", "id": "2500024", "problem": "Consider a single-species population with density $N(t)$ evolving according to the ordinary differential equation (ODE) \n$$\n\\dot{N}=r\\,N\\left(1-\\frac{N}{K}\\right)\\left(\\frac{N}{A}-1\\right),\n$$\nwhere $r>0$ is the intrinsic rate of increase, $K>0$ is the carrying capacity, and $A$ is a constant parameter capturing an Allee effect in the per capita growth rate. The biological state space is $N\\ge 0$. \n\nStarting from the core ecological definitions of per capita growth rate and equilibrium for a population governed by a deterministic ODE, along with the standard local stability criterion for a one-dimensional autonomous ODE, do the following without invoking any pre-packaged results beyond these definitions: \n\n- First, derive all equilibrium population densities by solving for $N^{\\ast}$ such that $\\dot{N}=0$. \n- Second, determine the local stability type of each equilibrium by linearizing the ODE about each equilibrium and analyzing the sign of the resulting eigenvalue (that is, compute $f'(N^{\\ast})$ where $f(N)=r\\,N\\left(1-\\frac{N}{K}\\right)\\left(\\frac{N}{A}-1\\right)$, and use its sign to classify stability). \n- Third, define the per capita growth rate $g(N)$ as the net growth rate per individual and interpret the parameter $A$ as an Allee threshold by characterizing the sign of $g(N)$ on biologically relevant intervals, explicitly identifying intervals of $N$ on which $g(N)$ is positive versus negative when $0<A<K$. Explain why this sign structure justifies calling $A$ a threshold.\n\nExpress all steps symbolically in terms of $r$, $K$, and $A$. As your final reported value, provide the closed-form expression for the eigenvalue of the linearization at $N=A$, simplified in terms of $r$, $K$, and $A$. The final answer must be a single analytic expression. No numerical rounding is required, and no units are needed.", "solution": "The problem as stated is scientifically grounded, well-posed, and objective. It is based on a standard model in population ecology and presents a clear, solvable set of tasks using fundamental principles of dynamical systems. We may therefore proceed directly to the solution.\n\nThe evolution of the population is described by the autonomous ordinary differential equation (ODE):\n$$\n\\dot{N} = f(N) = r\\,N\\left(1-\\frac{N}{K}\\right)\\left(\\frac{N}{A}-1\\right)\n$$\nwhere `$r>0$`, `$K>0$`, `$A$` are constants and the state space is `$N \\ge 0$`.\n\nFirst, we derive the equilibrium population densities, `$N^{\\ast}$`. An equilibrium is a state where the population density does not change over time, meaning `$\\dot{N}=0$`. We solve the equation `$f(N^{\\ast})=0$`:\n$$\nr\\,N^{\\ast}\\left(1-\\frac{N^{\\ast}}{K}\\right)\\left(\\frac{N^{\\ast}}{A}-1\\right) = 0\n$$\nSince the intrinsic rate of increase `$r$` is strictly positive (`$r>0$`), this equation holds if and only if one of the other factors is zero. This gives three possible solutions for `$N^{\\ast}$`:\n$1$. `$N^{\\ast} = 0$`\n$2$. `$1 - \\frac{N^{\\ast}}{K} = 0 \\implies N^{\\ast} = K$`\n$3$. `$\\frac{N^{\\ast}}{A} - 1 = 0 \\implies N^{\\ast} = A$`\n\nThus, the system has three equilibrium points: `$N_1^{\\ast} = 0$`, `$N_2^{\\ast} = A$`, and `$N_3^{\\ast} = K$`.\n\nSecond, we determine the local stability of each equilibrium. The standard local stability criterion for a one-dimensional autonomous ODE `$\\dot{N} = f(N)$` is based on the sign of the derivative of `$f(N)$` evaluated at the equilibrium point `$N^{\\ast}$`. This derivative, `$f'(N^{\\ast})$`, corresponds to the eigenvalue `$\\lambda$` of the linearized system at that point. If `$\\lambda = f'(N^{\\ast}) < 0$`, the equilibrium is locally stable (attracting). If `$\\lambda = f'(N^{\\ast}) > 0$`, the equilibrium is locally unstable (repelling).\n\nTo find `$f'(N)$`, we apply the product rule to `$f(N)$`:\n$$\nf'(N) = \\frac{d}{dN}\\left[r\\,N\\left(1-\\frac{N}{K}\\right)\\left(\\frac{N}{A}-1\\right)\\right]\n$$\nLet `$u(N) = rN$`, `$v(N) = 1-\\frac{N}{K}$`, and `$w(N) = \\frac{N}{A}-1$`. Then `$u'(N)=r$`, `$v'(N)=-\\frac{1}{K}$`, and `$w'(N)=\\frac{1}{A}$`.\nUsing the product rule `$(uvw)' = u'vw + uv'w + uvw'$`, we get:\n$$\nf'(N) = r\\left(1-\\frac{N}{K}\\right)\\left(\\frac{N}{A}-1\\right) + rN\\left(-\\frac{1}{K}\\right)\\left(\\frac{N}{A}-1\\right) + rN\\left(1-\\frac{N}{K}\\right)\\left(\\frac{1}{A}\\right)\n$$\nNow we evaluate this expression at each equilibrium point `$N^{\\ast}$`:\n\nFor `$N_1^{\\ast} = 0$`:\nThe second and third terms contain a factor of `$N$` and thus vanish.\n$$\n\\lambda_1 = f'(0) = r\\left(1-0\\right)\\left(0-1\\right) = -r\n$$\nSince `$r>0$`, we have `$\\lambda_1 < 0$`. Therefore, the equilibrium `$N^{\\ast} = 0$` is **stable**.\n\nFor `$N_2^{\\ast} = K$`:\nThe term `$\\left(1-\\frac{N}{K}\\right)$` becomes `$\\left(1-\\frac{K}{K}\\right) = 0$`, causing the first and third terms to vanish.\n$$\n\\lambda_2 = f'(K) = rK\\left(-\\frac{1}{K}\\right)\\left(\\frac{K}{A}-1\\right) = -r\\left(\\frac{K-A}{A}\\right) = r\\left(\\frac{A-K}{A}\\right)\n$$\nGiven the condition `$0<A<K$`, the numerator `$(A-K)$` is negative. Since `$r>0$` and `$A>0$`, we have `$\\lambda_2 < 0$`. Therefore, the equilibrium `$N^{\\ast} = K$` is **stable**.\n\nFor `$N_3^{\\ast} = A$`:\nThe term `$\\left(\\frac{N}{A}-1\\right)$` becomes `$\\left(\\frac{A}{A}-1\\right)=0$`, causing the first and second terms to vanish.\n$$\n\\lambda_3 = f'(A) = rA\\left(1-\\frac{A}{K}\\right)\\left(\\frac{1}{A}\\right) = r\\left(1-\\frac{A}{K}\\right) = r\\left(\\frac{K-A}{K}\\right)\n$$\nGiven `$0<A<K$`, the numerator `$(K-A)$` is positive. Since `$r>0$` and `$K>0$`, we have `$\\lambda_3 > 0$`. Therefore, the equilibrium `$N^{\\ast} = A$` is **unstable**.\n\nThird, we interpret `$A$` as an Allee threshold. The per capita growth rate, `$g(N)$`, is defined as the total growth rate `$\\dot{N}$` divided by the population size `$N$`.\n$$\ng(N) = \\frac{\\dot{N}}{N} = r\\left(1-\\frac{N}{K}\\right)\\left(\\frac{N}{A}-1\\right)\n$$\nThe sign of `$g(N)$` determines whether the population grows (`$g(N)>0$`) or shrinks (`$g(N)<0$`). We analyze its sign on different intervals of `$N$` under the condition `$0 < A < K$`. The sign is determined by the factors `$\\left(1-\\frac{N}{K}\\right)$` and `$\\left(\\frac{N}{A}-1\\right)$`.\n\n- For `$0 < N < A$`: We have `$N < K$` and `$N < A`$.\n  - `$\\left(1-\\frac{N}{K}\\right) > 0$`\n  - `$\\left(\\frac{N}{A}-1\\right) < 0$`\n  - Therefore, `$g(N) = r \\cdot (\\text{positive}) \\cdot (\\text{negative}) < 0$`. The population declines.\n\n- For `$A < N < K$`:\n  - `$\\left(1-\\frac{N}{K}\\right) > 0$`\n  - `$\\left(\\frac{N}{A}-1\\right) > 0$`\n  - Therefore, `$g(N) = r \\cdot (\\text{positive}) \\cdot (\\text{positive}) > 0$`. The population grows.\n\nThis analysis shows that the per capita growth rate is negative for population densities below `$A$` and positive for densities between `$A$` and `$K$`. A population starting below `$A$` will decline towards extinction at `$N^{\\ast}=0$`, whereas a population starting above `$A$` (but below `$K$`) will grow towards the carrying capacity `$N^{\\ast}=K$`. The unstable equilibrium `$N^{\\ast}=A$` thus acts as a critical dividing point, or threshold. A population must exceed this density to have a positive per capita growth rate and persist. This is precisely the definition of an Allee threshold.\n\nThe final requested value is the expression for the eigenvalue of the linearization at `$N=A$`. As derived above, this is:\n$$\n\\lambda_3 = f'(A) = r\\left(\\frac{K-A}{K}\\right)\n$$", "answer": "$$\n\\boxed{r\\frac{K-A}{K}}\n$$"}, {"introduction": "Building on the analysis of a single species, we now examine a community of two competitors. This exercise [@problem_id:2499857] employs the classic Lotka-Volterra competition model to investigate a central question in ecology: under what conditions can competing species coexist? You will derive the precise mathematical condition that determines whether interspecific competition is weak enough to permit stable coexistence or strong enough to lead to bistability, where one species inevitably excludes the other depending on initial advantages.", "id": "2499857", "problem": "Two populations of species engage in symmetric interspecific interference competition. Each species exhibits logistic intraspecific regulation and experiences additional crowding due to the other species. Let $N_{1}(t)$ and $N_{2}(t)$ denote the abundances of species $1$ and $2$ at time $t$. The per-capita growth of each species follows the logistic form modified by interspecific interference derived from the principle that per-capita growth declines linearly with total effective density. Assume identical intrinsic rate and carrying capacity across species and a common, nonnegative interspecific interference coefficient. The dynamics are\n$$\n\\frac{dN_{1}}{dt} \\;=\\; r\\,N_{1}\\left(1 - \\frac{N_{1} + \\alpha N_{2}}{K}\\right), \n\\qquad\n\\frac{dN_{2}}{dt} \\;=\\; r\\,N_{2}\\left(1 - \\frac{N_{2} + \\alpha N_{1}}{K}\\right),\n$$\nwhere $r>0$ is the intrinsic growth rate, $K>0$ is the carrying capacity of each species in isolation, and $\\alpha \\ge 0$ measures the per-capita strength of interspecific interference relative to intraspecific crowding.\n\nStarting from the fundamental definitions of logistic growth with intraspecific self-limitation and pairwise interspecific interference, and using linearization of the community dynamics near equilibria, derive the exact critical value $\\alpha_{c}$ at which the interior coexistence equilibrium changes stability and the system transitions from stable coexistence to alternative stable states (bistability) between the two single-species equilibria. Your final answer must be a single exact value with no units. Do not provide inequalities. Do not round; provide an exact value.", "solution": "The problem requires the derivation of the critical value of the interspecific interference coefficient, $\\alpha_{c}$, at which a symmetric two-species competition system transitions from stable coexistence to bistability. The system is described by the Lotka-Volterra competition equations:\n$$\n\\frac{dN_{1}}{dt} = r N_{1}\\left(1 - \\frac{N_{1} + \\alpha N_{2}}{K}\\right)\n$$\n$$\n\\frac{dN_{2}}{dt} = r N_{2}\\left(1 - \\frac{N_{2} + \\alpha N_{1}}{K}\\right)\n$$\nwhere $r > 0$, $K > 0$, and $\\alpha \\ge 0$. The transition in stability is determined by a qualitative change in the behavior of the system's equilibria, a phenomenon analyzed through linearization and eigenvalue analysis.\n\nFirst, we must identify the equilibria of the system by setting the time derivatives to zero: $\\frac{dN_{1}}{dt} = 0$ and $\\frac{dN_{2}}{dt} = 0$. This yields four possible equilibrium points $(N_{1}^{*}, N_{2}^{*})$.\nFrom $\\frac{dN_{1}}{dt} = 0$, we have $N_{1}^{*} = 0$ or $K - N_{1}^{*} - \\alpha N_{2}^{*} = 0$.\nFrom $\\frac{dN_{2}}{dt} = 0$, we have $N_{2}^{*} = 0$ or $K - N_{2}^{*} - \\alpha N_{1}^{*} = 0$.\n\nThe four equilibria are:\n1.  The trivial equilibrium where both species are extinct: $(0, 0)$.\n2.  The boundary equilibrium where species $2$ is extinct: $(K, 0)$.\n3.  The boundary equilibrium where species $1$ is extinct: $(0, K)$.\n4.  The interior or coexistence equilibrium, where $N_{1}^{*} > 0$ and $N_{2}^{*} > 0$. This requires solving the system of linear equations:\n    $$\n    N_{1}^{*} + \\alpha N_{2}^{*} = K\n    $$\n    $$\n    \\alpha N_{1}^{*} + N_{2}^{*} = K\n    $$\n    Equating the two expressions gives $N_{1}^{*} + \\alpha N_{2}^{*} = \\alpha N_{1}^{*} + N_{2}^{*}$, which simplifies to $N_{1}^{*}(1 - \\alpha) = N_{2}^{*}(1 - \\alpha)$. Assuming $\\alpha \\neq 1$, we find $N_{1}^{*} = N_{2}^{*}$. Substituting this into the first equation yields $N_{1}^{*} + \\alpha N_{1}^{*} = K$, or $N_{1}^{*}(1 + \\alpha) = K$. Thus, the coexistence equilibrium is:\n    $$\n    \\left(N_{1}^{*}, N_{2}^{*}\\right) = \\left(\\frac{K}{1 + \\alpha}, \\frac{K}{1 + \\alpha}\\right)\n    $$\nThis equilibrium is biologically meaningful (positive populations) for all allowed parameter values ($K > 0$, $\\alpha \\ge 0$).\n\nThe stability of this coexistence equilibrium is determined by the eigenvalues of the Jacobian matrix of the system, evaluated at this point. Let $f_{1}(N_{1}, N_{2}) = rN_{1} - \\frac{r}{K}N_{1}^{2} - \\frac{r\\alpha}{K}N_{1}N_{2}$ and $f_{2}(N_{1}, N_{2}) = rN_{2} - \\frac{r}{K}N_{2}^{2} - \\frac{r\\alpha}{K}N_{1}N_{2}$. The Jacobian matrix $J$ is:\n$$\nJ(N_{1}, N_{2}) = \\begin{pmatrix} \\frac{\\partial f_{1}}{\\partial N_{1}} & \\frac{\\partial f_{1}}{\\partial N_{2}} \\\\ \\frac{\\partial f_{2}}{\\partial N_{1}} & \\frac{\\partial f_{2}}{\\partial N_{2}} \\end{pmatrix} = \\begin{pmatrix} r\\left(1 - \\frac{2N_{1} + \\alpha N_{2}}{K}\\right) & -\\frac{r\\alpha N_{1}}{K} \\\\ -\\frac{r\\alpha N_{2}}{K} & r\\left(1 - \\frac{2N_{2} + \\alpha N_{1}}{K}\\right) \\end{pmatrix}\n$$\nWe evaluate this matrix at the coexistence equilibrium $(N_{1}^{*}, N_{2}^{*}) = (\\frac{K}{1+\\alpha}, \\frac{K}{1+\\alpha})$:\n$$\nJ^{*} = \\begin{pmatrix} r\\left(1 - \\frac{2\\frac{K}{1+\\alpha} + \\alpha\\frac{K}{1+\\alpha}}{K}\\right) & -\\frac{r\\alpha}{K}\\left(\\frac{K}{1+\\alpha}\\right) \\\\ -\\frac{r\\alpha}{K}\\left(\\frac{K}{1+\\alpha}\\right) & r\\left(1 - \\frac{2\\frac{K}{1+\\alpha} + \\alpha\\frac{K}{1+\\alpha}}{K}\\right) \\end{pmatrix}\n$$\nSimplifying the elements:\nThe diagonal elements are identical:\n$J_{11}^{*} = J_{22}^{*} = r\\left(1 - \\frac{K(\\frac{2+\\alpha}{1+\\alpha})}{K}\\right) = r\\left(1 - \\frac{2+\\alpha}{1+\\alpha}\\right) = r\\left(\\frac{1+\\alpha - 2 - \\alpha}{1+\\alpha}\\right) = -\\frac{r}{1+\\alpha}$.\nThe off-diagonal elements are also identical:\n$J_{12}^{*} = J_{21}^{*} = -\\frac{r\\alpha}{1+\\alpha}$.\nSo, the Jacobian at the coexistence equilibrium is:\n$$\nJ^{*} = \\begin{pmatrix} -\\frac{r}{1+\\alpha} & -\\frac{r\\alpha}{1+\\alpha} \\\\ -\\frac{r\\alpha}{1+\\alpha} & -\\frac{r}{1+\\alpha} \\end{pmatrix} = \\frac{r}{1+\\alpha} \\begin{pmatrix} -1 & -\\alpha \\\\ -\\alpha & -1 \\end{pmatrix}\n$$\nThe eigenvalues $\\lambda$ are found by solving the characteristic equation $\\det(J^{*} - \\lambda I) = 0$:\n$$\n\\det \\begin{pmatrix} -\\frac{r}{1+\\alpha} - \\lambda & -\\frac{r\\alpha}{1+\\alpha} \\\\ -\\frac{r\\alpha}{1+\\alpha} & -\\frac{r}{1+\\alpha} - \\lambda \\end{pmatrix} = 0\n$$\n$$\n\\left(-\\frac{r}{1+\\alpha} - \\lambda\\right)^{2} - \\left(-\\frac{r\\alpha}{1+\\alpha}\\right)^{2} = 0\n$$\nThis gives $\\left(\\lambda + \\frac{r}{1+\\alpha}\\right)^{2} = \\left(\\frac{r\\alpha}{1+\\alpha}\\right)^{2}$. Taking the square root of both sides, we get $\\lambda + \\frac{r}{1+\\alpha} = \\pm \\frac{r\\alpha}{1+\\alpha}$.\nThe two eigenvalues are:\n$$\n\\lambda_{1} = -\\frac{r}{1+\\alpha} + \\frac{r\\alpha}{1+\\alpha} = \\frac{r(\\alpha-1)}{1+\\alpha}\n$$\n$$\n\\lambda_{2} = -\\frac{r}{1+\\alpha} - \\frac{r\\alpha}{1+\\alpha} = -\\frac{r(1+\\alpha)}{1+\\alpha} = -r\n$$\nThe coexistence equilibrium is stable if and only if the real parts of both eigenvalues are negative. Since $r > 0$ and $\\alpha \\ge 0$, $\\lambda_2 = -r$ is always negative. Stability therefore depends on the sign of $\\lambda_1$.\nThe term $\\frac{r}{1+\\alpha}$ is always positive. Thus, the sign of $\\lambda_1$ is determined by the sign of $(\\alpha - 1)$.\n- If $0 \\le \\alpha < 1$: Then $\\alpha - 1 < 0$, which implies $\\lambda_1 < 0$. Both eigenvalues are negative. The coexistence equilibrium is stable. This corresponds to stable coexistence, where interspecific competition is weaker than intraspecific competition.\n- If $\\alpha > 1$: Then $\\alpha - 1 > 0$, which implies $\\lambda_1 > 0$. One eigenvalue is positive, rendering the coexistence equilibrium an unstable saddle point. This corresponds to bistability, where interspecific competition is stronger than intraspecific competition, and the system evolves to one of the two stable boundary equilibria $(K, 0)$ or $(0, K)$.\n- If $\\alpha = 1$: Then $\\lambda_1 = 0$. This is the critical threshold at which the stability of the coexistence equilibrium changes. The presence of a zero eigenvalue indicates a bifurcation.\n\nThe transition from stable coexistence to alternative stable states (bistability) occurs precisely at the value of $\\alpha$ for which the dominant eigenvalue of the Jacobian matrix for the coexistence equilibrium crosses from negative to positive. This happens when the eigenvalue is zero.\nSetting $\\lambda_1 = 0$:\n$$\n\\frac{r(\\alpha-1)}{1+\\alpha} = 0\n$$\nSince $r > 0$, this implies $\\alpha - 1 = 0$.\nThe critical value is $\\alpha_{c} = 1$.\nAt this value, intraspecific and interspecific competitive effects are identical. For $\\alpha < 1$, the system supports coexistence. For $\\alpha > 1$, the system exhibits competitive exclusion, with the winner determined by initial conditions. The problem asks for the single exact value $\\alpha_{c}$ at which this transition occurs.", "answer": "$$\n\\boxed{1}\n$$"}, {"introduction": "Ecological theory becomes most powerful when it is parameterized and validated with empirical data. This final practice [@problem_id:2499832] bridges this gap by focusing on a predator-prey system, a different but equally fundamental type of interspecific interaction. You will use hypothetical feeding-trial data to estimate the parameters of a predator's functional response and then apply these estimates to predict the equilibrium densities of the full consumer-resource model, completing the full workflow from data fitting to community-level prediction.", "id": "2499832", "problem": "You are given three independent feeding-trial datasets that quantify a consumer’s per-capita consumption rate on a single resource at different resource densities, along with corresponding consumer–resource population-dynamic parameters. Your task is to write a complete, runnable program that, for each dataset, estimates the Holling Type II functional response parameters and then predicts equilibrium densities under a change in productivity.\n\nFundamental base:\n- Holling Type II functional response: the per-capita consumption rate as a function of resource density $R$ is given by $f(R) = \\dfrac{a R}{1 + a h R}$, where $a \\gt 0$ is the attack rate and $h \\gt 0$ is the handling time.\n- Consumer–resource dynamics follow the Rosenzweig–MacArthur form derived from logistic resource growth and a saturating functional response: \n  - Resource: $\\dfrac{dR}{dt} = r R \\left(1 - \\dfrac{R}{K}\\right) - f(R) C$,\n  - Consumer: $\\dfrac{dC}{dt} = e f(R) C - m C$,\n  where $r \\gt 0$ is the intrinsic growth rate of the resource, $K \\gt 0$ is the carrying capacity, $e \\in (0,1]$ is the assimilation efficiency, and $m \\gt 0$ is the per-capita mortality rate of the consumer.\n- All time quantities are in hours, densities are in individuals per square meter, and rates are per hour. The functional response $f(R)$ has units of prey consumed per predator per hour. The parameters $a$ and $h$ have units of square meters per predator per hour and hours per prey, respectively. The equilibrium densities $R^{\\star}$ and $C^{\\star}$ must be reported in individuals per square meter (for $R^{\\star}$) and predators per square meter (for $C^{\\star}$), expressed as decimals rounded to six decimal places.\n\nEstimation task:\n- For each dataset, you must estimate $a$ and $h$ by minimizing the sum of squared residuals between observed per-capita consumption rates and the model prediction $f(R)$, subject to the constraints $a \\gt 0$ and $h \\gt 0$. Use nonlinear least squares.\n\nEquilibrium prediction task:\n- For each dataset, after estimating $(\\hat a, \\hat h)$, determine equilibrium densities $(R^{\\mathrm{eq}}, C^{\\mathrm{eq}})$ of the consumer–resource system by solving the steady-state conditions $\\dfrac{dR}{dt} = 0$ and $\\dfrac{dC}{dt} = 0$ under two productivity scenarios: baseline carrying capacity $K$ and an altered carrying capacity $K_{\\mathrm{alt}}$ (all other parameters unchanged).\n- Return the biologically admissible equilibrium with nonnegative densities. If there is no positive consumer equilibrium (for example, if the solution to the steady-state conditions yields no $R \\gt 0$ with $C \\gt 0$ or if the putative $R^{\\star}$ at which the consumer can persist is not less than $K$), then the realized equilibrium is consumer extinction with $(R^{\\mathrm{eq}}, C^{\\mathrm{eq}}) = (K, 0)$ for that scenario.\n\nTest suite:\nEach test case consists of a feeding-trial dataset and population parameters $(r, K, e, m)$ and a single altered carrying capacity $K_{\\mathrm{alt}}$. The feeding-trial data are given as pairs $(R_i, y_i)$, where $R_i$ is resource density (individuals per square meter) and $y_i$ is observed per-capita consumption (prey per predator per hour).\n\nCase 1:\n- Feeding data: $(R_i, y_i)$ for $i=1,\\dots,5$:\n  - $(2, 0.226415)$, $(5, 0.521739)$, $(10, 0.923077)$, $(20, 1.500000)$, $(40, 2.181818)$.\n- Parameters: $r = 0.03$, $K = 60$, $e = 0.6$, $m = 0.02$.\n- Altered productivity: $K_{\\mathrm{alt}} = 30$.\n\nCase 2:\n- Feeding data: $(R_i, y_i)$ for $i=1,\\dots,5$:\n  - $(1, 0.019802)$, $(5, 0.095238)$, $(10, 0.181818)$, $(30, 0.461538)$, $(80, 0.888889)$.\n- Parameters: $r = 0.02$, $K = 8$, $e = 0.3$, $m = 0.05$.\n- Altered productivity: $K_{\\mathrm{alt}} = 20$.\n\nCase 3:\n- Feeding data: $(R_i, y_i)$ for $i=1,\\dots,5$:\n  - $(2, 0.129032)$, $(10, 0.363636)$, $(25, 0.500000)$, $(50, 0.571429)$, $(100, 0.615385)$.\n- Parameters: $r = 0.04$, $K = 120$, $e = 0.2$, $m = 0.3$.\n- Altered productivity: $K_{\\mathrm{alt}} = 240$.\n\nOutput specification:\n- For each case, in order, output the six-tuple of floats\n  $(\\hat a, \\hat h, R^{\\mathrm{eq}}_{\\text{base}}, C^{\\mathrm{eq}}_{\\text{base}}, R^{\\mathrm{eq}}_{\\text{alt}}, C^{\\mathrm{eq}}_{\\text{alt}})$,\n  where $(\\hat a, \\hat h)$ are the fitted parameters, $(R^{\\mathrm{eq}}_{\\text{base}}, C^{\\mathrm{eq}}_{\\text{base}})$ are the equilibrium densities under baseline $K$, and $(R^{\\mathrm{eq}}_{\\text{alt}}, C^{\\mathrm{eq}}_{\\text{alt}})$ are the equilibrium densities under $K_{\\mathrm{alt}}$. All six numbers must be rounded to six decimal places.\n- Aggregate the three cases’ results into a single list in the order Case 1, Case 2, Case 3, yielding a list of $18$ floats.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[x1,x2,...,x18]\").\n\nScientific realism and constraints:\n- Use only the provided data and the fundamental bases stated above. Do not assume any additional structure or shortcuts not derivable from the base principles (e.g., do not hard-code closed-form equilibrium expressions without establishing them from the steady-state conditions). Enforce $a \\gt 0$, $h \\gt 0$ in estimation, and report equilibria with nonnegative densities only.", "solution": "The problem statement has been subjected to rigorous validation and is found to be scientifically grounded, well-posed, and objective. It provides a complete and consistent set of information for a standard problem in theoretical ecology. The models specified—the Holling Type II functional response and the Rosenzweig-MacArthur consumer-resource dynamics—are fundamental concepts in this field. The data and parameters are plausible, and the tasks are clearly defined. Therefore, the problem is valid, and a solution will be provided.\n\nThe solution is a two-stage process for each test case. First, the parameters of the functional response model are estimated from the provided feeding-trial data. Second, these estimated parameters are used to predict the equilibrium densities of the consumer-resource system under two different productivity scenarios.\n\n**Part 1: Parameter Estimation of the Holling Type II Functional Response**\n\nThe Holling Type II functional response describes the per-capita rate of consumption, $f(R)$, as a function of resource density, $R$. The mathematical formulation is:\n$$ f(R) = \\frac{a R}{1 + a h R} $$\nwhere $a$ is the consumer's attack rate and $h$ is the handling time. Both parameters must be positive, i.e., $a > 0$ and $h > 0$.\n\nThe task is to estimate the values of $\\hat{a}$ and $\\hat{h}$ from a given dataset of observed resource densities and consumption rates, $(R_i, y_i)$. This is achieved by finding the parameter values that minimize the sum of squared residuals (SSR) between the observed rates, $y_i$, and the rates predicted by the model, $f(R_i)$. The objective function to be minimized is:\n$$ \\text{SSR}(a, h) = \\sum_{i} \\left( y_i - f(R_i; a, h) \\right)^2 $$\nThis is a nonlinear least-squares regression problem. It will be solved numerically using an appropriate algorithm, such as the Levenberg-Marquardt algorithm, which is implemented in the `scipy.optimize.curve_fit` function. The constraints $a > 0$ and $h > 0$ will be strictly enforced during the optimization process.\n\n**Part 2: Equilibrium Analysis of the Consumer-Resource System**\n\nThe dynamics of the consumer-resource interaction are described by the Rosenzweig-MacArthur model:\n$$ \\frac{dR}{dt} = r R \\left(1 - \\frac{R}{K}\\right) - f(R) C $$\n$$ \\frac{dC}{dt} = e f(R) C - m C $$\nHere, $R$ and $C$ are the densities of the resource and consumer populations, respectively. The parameters $r, K, e, m$ represent the resource intrinsic growth rate, resource carrying capacity, consumer assimilation efficiency, and consumer mortality rate. The function $f(R)$ is the Holling Type II response with the parameters $\\hat{a}$ and $\\hat{h}$ estimated in Part 1.\n\nEquilibrium densities, denoted $(R^{\\mathrm{eq}}, C^{\\mathrm{eq}})$, are found by setting both time derivatives to zero: $\\frac{dR}{dt} = 0$ and $\\frac{dC}{dt} = 0$.\n\nFrom the consumer equation, $\\frac{dC}{dt} = C(e f(R) - m) = 0$, we identify two possible solutions for the equilibrium state:\n\n1.  **Consumer Extinction Equilibrium:** One solution is $C^{\\mathrm{eq}} = 0$. If the consumer is absent, the resource equation simplifies to the standard logistic growth model: $\\frac{dR}{dt} = r R (1 - \\frac{R}{K}) = 0$. The non-trivial solution is $R = K$. Thus, a biologically stable equilibrium exists at $(R^{\\mathrm{eq}}, C^{\\mathrm{eq}}) = (K, 0)$. This represents the state where the consumer population has gone extinct and the resource population stabilizes at its carrying capacity.\n\n2.  **Coexistence Equilibrium:** For a solution with a positive consumer density ($C > 0$), the condition $e f(R) - m = 0$ must hold. Substituting the functional response form, we have:\n    $$ e \\frac{\\hat{a} R}{1 + \\hat{a} \\hat{h} R} = m $$\n    Solving for $R$ yields the resource density, $R^\\star$, required to sustain a non-zero consumer population:\n    $$ R^\\star = \\frac{m}{\\hat{a}(e - m \\hat{h})} $$\n    For $R^\\star$ to be positive and physically meaningful, the denominator must be positive. Since $\\hat{a} > 0$, this requires the condition $e - m \\hat{h} > 0$. If $e \\le m \\hat{h}$, the consumer's growth can never overcome its mortality, regardless of resource abundance. In this scenario, a coexistence equilibrium is impossible, and the system defaults to the consumer extinction equilibrium $(K, 0)$.\n\n    If $e > m \\hat{h}$, we have a valid $R^\\star > 0$. We then substitute $R = R^\\star$ into the resource steady-state equation, $\\frac{dR}{dt} = 0$:\n    $$ r R^\\star \\left(1 - \\frac{R^\\star}{K}\\right) - f(R^\\star) C = 0 $$\n    Using the fact that at this equilibrium $f(R^\\star) = m/e$, we can solve for the consumer density, $C^\\star$:\n    $$ C^\\star = \\frac{er}{m} R^\\star \\left(1 - \\frac{R^\\star}{K}\\right) $$\n    For $C^\\star$ to be positive, all terms on the right-hand side must be positive. This leads to the final condition: $1 - \\frac{R^\\star}{K} > 0$, or $R^\\star < K$. This condition means that the resource carrying capacity must be larger than the resource level required to support the consumer. If $R^\\star \\ge K$, the consumer is too inefficient to establish a population, and the only stable state is again $(K, 0)$.\n\nIn summary, for a given set of parameters $(\\hat{a}, \\hat{h}, r, K, e, m)$, the biologically admissible equilibrium $(R^{\\mathrm{eq}}, C^{\\mathrm{eq}})$ is determined as follows:\n- Calculate $R^\\star = \\frac{m}{\\hat{a}(e - m \\hat{h})}$.\n- If $e > m \\hat{h}$ and $R^\\star < K$, the coexistence equilibrium is $(R^\\star, C^\\star = \\frac{er}{m} R^\\star (1 - \\frac{R^\\star}{K}))$.\n- Otherwise, the equilibrium is at $(K, 0)$.\n\nThis entire analytical procedure is implemented for each of the three test cases, first using the baseline carrying capacity $K$ and then the altered carrying capacity $K_{\\mathrm{alt}}$. The final program will execute these steps and format the results as specified.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import curve_fit\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for all given test cases.\n    It estimates functional response parameters and calculates equilibrium densities.\n    \"\"\"\n    \n    # Holling Type II functional response model\n    def holling_type_2(R, a, h):\n        \"\"\"\n        Calculates per-capita consumption rate using Holling Type II model.\n        R: resource density (scalar or array)\n        a: attack rate\n        h: handling time\n        \"\"\"\n        return (a * R) / (1.0 + a * h * R)\n\n    def calculate_equilibrium(a, h, r, K, e, m):\n        \"\"\"\n        Calculates the stable equilibrium densities (R_eq, C_eq) for the\n        Rosenzweig-MacArthur model.\n        \"\"\"\n        # Condition for consumer persistence: e > m*h.\n        # If not met, consumer cannot survive.\n        if e <= m * h:\n            return float(K), 0.0\n\n        # Calculate the resource density required to support the consumer (R_star).\n        # This is the consumer isocline for C > 0.\n        R_star = m / (a * (e - m * h))\n        \n        # Condition for coexistence: R_star must be less than K.\n        # If R_star >= K, the resource cannot support the consumer, leading to extinction.\n        if R_star >= K:\n            return float(K), 0.0\n\n        # If conditions for coexistence are met, calculate the consumer density C_star.\n        # This is derived from the resource isocline at R = R_star.\n        C_star = (e * r / m) * R_star * (1.0 - R_star / K)\n\n        return R_star, C_star\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"data\": np.array([\n                [2.0, 0.226415], [5.0, 0.521739], [10.0, 0.923077], [20.0, 1.500000], [40.0, 2.181818]\n            ]),\n            \"params\": (0.03, 60.0, 0.6, 0.02),  # r, K, e, m\n            \"K_alt\": 30.0\n        },\n        {\n            \"data\": np.array([\n                [1.0, 0.019802], [5.0, 0.095238], [10.0, 0.181818], [30.0, 0.461538], [80.0, 0.888889]\n            ]),\n            \"params\": (0.02, 8.0, 0.3, 0.05),  # r, K, e, m\n            \"K_alt\": 20.0\n        },\n        {\n            \"data\": np.array([\n                [2.0, 0.129032], [10.0, 0.363636], [25.0, 0.500000], [50.0, 0.571429], [100.0, 0.615385]\n            ]),\n            \"params\": (0.04, 120.0, 0.2, 0.3),  # r, K, e, m\n            \"K_alt\": 240.0\n        }\n    ]\n\n    all_results = []\n    for case in test_cases:\n        R_data = case[\"data\"][:, 0]\n        y_data = case[\"data\"][:, 1]\n        r, K_base, e, m = case[\"params\"]\n        K_alt = case[\"K_alt\"]\n\n        # Step 1: Estimate parameters a and h using nonlinear least squares.\n        # The bounds [1e-9, 1e-9] enforce a > 0 and h > 0.\n        try:\n            popt, _ = curve_fit(holling_type_2, R_data, y_data, bounds=([1e-9, 1e-9], [np.inf, np.inf]))\n            a_hat, h_hat = popt\n        except RuntimeError:\n            # Handle cases where the fit fails, though not expected with this data.\n            a_hat, h_hat = np.nan, np.nan\n        \n        # Step 2: Calculate equilibrium for the baseline carrying capacity K_base.\n        R_eq_base, C_eq_base = calculate_equilibrium(a_hat, h_hat, r, K_base, e, m)\n\n        # Step 3: Calculate equilibrium for the altered carrying capacity K_alt.\n        R_eq_alt, C_eq_alt = calculate_equilibrium(a_hat, h_hat, r, K_alt, e, m)\n\n        # Step 4: Collect and round the results to six decimal places.\n        case_results = [\n            round(a_hat, 6),\n            round(h_hat, 6),\n            round(R_eq_base, 6),\n            round(C_eq_base, 6),\n            round(R_eq_alt, 6),\n            round(C_eq_alt, 6)\n        ]\n        all_results.extend(case_results)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{x:.6f}' for x in all_results)}]\")\n\nsolve()\n```"}]}