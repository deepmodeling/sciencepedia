{"hands_on_practices": [{"introduction": "The first step in predicting evolution is to quantify its primary driver: natural selection. This practice guides you through estimating directional selection gradients from empirical data, a foundational skill in evolutionary quantitative genetics. By analyzing fitness components like viability and mating success separately, you will learn how to partition the total force of selection and understand its composite nature, directly applying the framework developed by Lande and Arnold [@problem_id:2526754].", "problem": "You are given individual-level data from a single breeding season in a wild population, where a focal sexual trait is measured before selection, and two episodic fitness components are recorded: mating success and viability. Your task is to estimate directional selection on the sexual trait separately for the viability and mating episodes and to predict the net one-generation evolutionary change in the standardized trait mean under an additive genetic framework.\n\nBase your reasoning only on the following core definitions and well-tested quantitative genetic facts:\n- For each individual $i$, absolute fitness is the product of measurable, multiplicative components (e.g., survival and mating success). If $V_i$ is viability (survival to reproduction; $V_i \\in \\{0,1\\}$), and $M_i$ is mating success (a nonnegative integer count), then absolute fitness is $W_i = V_i \\times M_i$.\n- Relative fitness for any component $C_i$ is $c_i = C_i / \\bar{C}$, where $\\bar{C}$ is the mean of that component for the reference set (for viability: all individuals; for mating: only among survivors). Total relative fitness is $w_i = W_i / \\bar{W}$, where $\\bar{W}$ is the mean absolute fitness in the population.\n- The selection differential is defined as the covariance between the phenotype and relative fitness. Directional selection on a single trait can be estimated by the slope from regressing relative fitness on the standardized trait using Ordinary Least Squares (OLS), where the trait is standardized to mean $0$ and variance $1$ at the population level.\n\nYou must implement the following procedure:\n1. Trait standardization: Given the raw trait values $z_i$, compute standardized values $z_i' = (z_i - \\bar{z}) / \\sigma_z$, where $\\bar{z}$ is the sample mean and $\\sigma_z$ is the population standard deviation of the trait computed with divisor $N$ (not $N-1$).\n2. Viability episode: Compute viability relative fitness $v_i = V_i / \\bar{V}$ for all individuals, where $\\bar{V}$ is the sample mean of $V_i$ over all individuals. Estimate the directional viability gradient as the OLS slope from regressing $v_i$ on $z_i'$ (include an intercept).\n3. Mating episode: Restrict to survivors with $V_i = 1$. Compute mating relative fitness $m_i = M_i / \\bar{M}_S$, where $\\bar{M}_S$ is the sample mean of $M_i$ among survivors. Estimate the directional mating gradient as the OLS slope from regressing $m_i$ on $z_i'$ among survivors (include an intercept). Use the same standardized trait values $z_i'$ computed at the population level.\n4. Total selection: Compute $W_i = V_i \\times M_i$ for all individuals and total relative fitness $w_i = W_i / \\bar{W}$. Estimate the net directional selection gradient as the OLS slope from regressing $w_i$ on $z_i'$ (include an intercept).\n5. Evolutionary prediction: You are given the additive genetic variance for the trait on the standardized scale, denoted $G'$, which is the additive genetic variance expressed in units where the phenotypic variance equals $1$. Predict the one-generation change in the standardized mean trait using the standard additive genetic response under directional selection and report it in trait standard deviation units.\n\nYour program must execute the above computations for the following test suite, producing results for each case in the order listed. In each case, all arrays are aligned by individual index.\n\nCase A (general case with both episodes contributing):\n- Trait values $z$: $[-0.7,-0.4,-0.2,0.0,0.1,0.3,0.6,0.8,1.1,1.3]$\n- Viability $V$: $[0,1,1,1,1,1,1,1,1,0]$\n- Mating counts $M$: $[0,1,1,2,2,3,3,4,5,0]$\n- Additive genetic variance (standardized scale) $G'$: $0.4$\n\nCase B (boundary case with no selection: constant viability and constant mating):\n- Trait values $z$: $[-1.0,-0.5,0.0,0.5,1.0]$\n- Viability $V$: $[1,1,1,1,1]$\n- Mating counts $M$: $[2,2,2,2,2]$\n- Additive genetic variance (standardized scale) $G'$: $0.3$\n\nCase C (opposing episodes: viability disfavors high trait values, mating favors them):\n- Trait values $z$: $[-1.5,-1.0,-0.8,-0.5,-0.2,0.0,0.2,0.5,0.8,1.0,1.2,1.5]$\n- Viability $V$: $[1,1,1,1,1,1,1,1,0,0,0,0]$\n- Mating counts $M$: $[1,1,1,2,2,3,3,4,0,0,0,0]$\n- Additive genetic variance (standardized scale) $G'$: $0.5$\n\nRequired outputs for each case:\n- A list of four floating-point numbers $[b_V, b_M, b_T, \\Delta]$, where $b_V$ is the viability directional gradient, $b_M$ is the mating directional gradient, $b_T$ is the total directional gradient, and $\\Delta$ is the predicted one-generation change in the standardized mean trait.\n- Express all four numbers as decimals rounded to six digits after the decimal point. These values are in trait standard deviation units because the trait is standardized.\n\nFinal output format:\n- Your program should produce a single line of output containing the results for all cases as a list of lists, in the order A, B, C. For example: \"[[a1,a2,a3,a4],[b1,b2,b3,b4],[c1,c2,c3,c4]]\". There must be no other printed text.", "solution": "The problem presented is a standard exercise in evolutionary quantitative genetics. It is well-posed, scientifically grounded, and provides all necessary information for a unique solution. The definitions and procedures align with the foundational framework for measuring natural selection established by Lande and Arnold (1983). Therefore, the problem is valid, and we proceed to the solution.\n\nThe objective is to compute directional selection gradients ($b$) for two fitness episodes—viability ($V$) and mating success ($M$)—and for total fitness ($W$), and then to predict the evolutionary response to selection ($\\Delta$). The selection gradient for a trait is defined as the slope of the linear regression of relative fitness on the standardized trait value.\n\nFirst, we formalize the calculation of the selection gradient. For a simple linear regression of a dependent variable $y$ (relative fitness) on an independent variable $x$ (standardized trait $z'$), the Ordinary Least Squares (OLS) slope, which we denote as $b$, is given by:\n$$\nb = \\frac{\\text{cov}(x, y)}{\\text{var}(x)}\n$$\nIn this problem, the trait $z$ is standardized to $z'$ such that its mean is $\\bar{z}' = 0$ and its variance is $\\text{var}(z') = 1$ over the entire initial population of size $N$.\n\nThe procedure is executed as follows:\n\nStep 1: Trait Standardization\nFor a set of raw trait values $\\{z_i\\}$, we compute the population mean $\\bar{z}$ and the population standard deviation $\\sigma_z$ (using divisor $N$). The standardized trait value for each individual $i$ is:\n$$\nz'_i = \\frac{z_i - \\bar{z}}{\\sigma_z}\n$$\nBy construction, the full set of $\\{z'_i\\}$ has a mean of $0$ and a variance of $1$.\n\nStep 2: Viability Selection Gradient ($b_V$)\nViability relative fitness is $v_i = V_i / \\bar{V}$, calculated for all $N$ individuals. The viability selection gradient $b_V$ is the OLS slope from regressing $v_i$ on $z'_i$. Since this regression is performed on the entire population where $\\text{var}(z') = 1$, the formula simplifies:\n$$\nb_V = \\frac{\\text{cov}(z', v)}{\\text{var}(z')} = \\text{cov}(z', v)\n$$\nFurthermore, since $\\bar{z}' = 0$, the covariance simplifies to the mean of the products: $\\text{cov}(z', v) = E[z'v] - E[z']E[v] = E[z'v]$. Thus:\n$$\nb_V = \\frac{1}{N} \\sum_{i=1}^{N} z'_i v_i\n$$\n\nStep 3: Mating Selection Gradient ($b_M$)\nThis analysis is restricted to the subset of $N_S$ individuals that survived (i.e., for whom $V_i = 1$). Mating relative fitness is $m_i = M_i / \\bar{M}_S$, where $\\bar{M}_S$ is the mean mating success among survivors. The mating selection gradient $b_M$ is the OLS slope from regressing $m_i$ on $z'_i$ for this subset of survivors.\nCrucially, the variance of the standardized trait values within the survivor subset, $\\text{var}(z'_{survivors})$, is not necessarily equal to $1$. Therefore, we must use the full OLS slope formula, applied only to the $N_S$ survivors:\n$$\nb_M = \\frac{\\text{cov}(z'_{survivors}, m_{survivors})}{\\text{var}(z'_{survivors})}\n$$\nwhere the covariance and variance are computed over the subset of survivors.\n\nStep 4: Total Selection Gradient ($b_T$)\nTotal absolute fitness is $W_i = V_i \\times M_i$. Total relative fitness is $w_i = W_i / \\bar{W}$. The total selection gradient $b_T$ is computed by regressing $w_i$ on $z'_i$ over the entire initial population of $N$ individuals. As with the viability gradient, $\\text{var}(z') = 1$, so the calculation simplifies:\n$$\nb_T = \\frac{\\text{cov}(z', w)}{\\text{var}(z')} = \\text{cov}(z', w) = \\frac{1}{N} \\sum_{i=1}^{N} z'_i w_i\n$$\nThe quantity $b_T$ represents the net directional selection pressure on the trait across all fitness episodes.\n\nStep 5: Predicted Evolutionary Change ($\\Delta$)\nThe one-generation change in the mean of a standardized trait is predicted by the breeder's equation. The response to selection ($\\Delta$) is the product of the trait's heritability ($h^2$) and the selection differential ($S$). On the standardized scale, the phenotypic variance is $1$, so heritability is numerically equal to the standardized additive genetic variance, $h^2 = G'/P' = G'/1 = G'$. The selection differential on a standardized trait is equal to the total selection gradient, $S' = b_T$. Thus, the prediction equation is:\n$$\n\\Delta = G' \\times b_T\n$$\nThis predicted change $\\Delta$ is in units of phenotypic standard deviations.\n\nThe following Python code implements this logic precisely for each given test case.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to execute the analysis for all test cases and print the results.\n    \"\"\"\n    test_cases = [\n        {\n            \"z\": [-0.7, -0.4, -0.2, 0.0, 0.1, 0.3, 0.6, 0.8, 1.1, 1.3],\n            \"V\": [0, 1, 1, 1, 1, 1, 1, 1, 1, 0],\n            \"M\": [0, 1, 1, 2, 2, 3, 3, 4, 5, 0],\n            \"G_prime\": 0.4\n        },\n        {\n            \"z\": [-1.0, -0.5, 0.0, 0.5, 1.0],\n            \"V\": [1, 1, 1, 1, 1],\n            \"M\": [2, 2, 2, 2, 2],\n            \"G_prime\": 0.3\n        },\n        {\n            \"z\": [-1.5, -1.0, -0.8, -0.5, -0.2, 0.0, 0.2, 0.5, 0.8, 1.0, 1.2, 1.5],\n            \"V\": [1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0],\n            \"M\": [1, 1, 1, 2, 2, 3, 3, 4, 0, 0, 0, 0],\n            \"G_prime\": 0.5\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        result = calculate_selection(case[\"z\"], case[\"V\"], case[\"M\"], case[\"G_prime\"])\n        results.append(result)\n\n    # Format the output string exactly as specified.\n    sub_strings = []\n    for r in results:\n        # Format each number to 6 decimal places.\n        formatted_numbers = [f\"{val:.6f}\" for val in r]\n        sub_strings.append(f\"[{','.join(formatted_numbers)}]\")\n    \n    final_output = f\"[{','.join(sub_strings)}]\"\n    print(final_output)\n\ndef calculate_selection(z, V, M, G_prime):\n    \"\"\"\n    Calculates selection gradients and evolutionary response for a single case.\n\n    Args:\n        z (list): Raw trait values.\n        V (list): Viability data (0 or 1).\n        M (list): Mating success counts.\n        G_prime (float): Additive genetic variance on the standardized scale.\n\n    Returns:\n        list: A list containing [b_V, b_M, b_T, delta].\n    \"\"\"\n    z_raw = np.array(z, dtype=np.float64)\n    V_raw = np.array(V, dtype=np.float64)\n    M_raw = np.array(M, dtype=np.float64)\n\n    # 1. Trait standardization\n    z_mean = np.mean(z_raw)\n    z_std = np.std(z_raw)  # Uses N in the denominator by default (ddof=0)\n    # Handle case where trait has no variance\n    if z_std == 0:\n        return [0.0, 0.0, 0.0, 0.0]\n    z_prime = (z_raw - z_mean) / z_std\n\n    # 2. Viability gradient (b_V)\n    b_V = 0.0\n    V_mean = np.mean(V_raw)\n    if V_mean > 0:\n        v_rel = V_raw / V_mean\n        # For regressions on the full dataset, var(z')=1, so gradient is cov(z', y_rel),\n        # which simplifies to mean(z' * y_rel) because mean(z')=0.\n        b_V = np.mean(z_prime * v_rel)\n\n    # 3. Mating gradient (b_M)\n    b_M = 0.0\n    survivors_mask = V_raw == 1\n    num_survivors = np.sum(survivors_mask)\n    if num_survivors >= 2: # OLS regression requires at least 2 data points\n        z_prime_survivors = z_prime[survivors_mask]\n        M_survivors = M_raw[survivors_mask]\n        \n        M_S_mean = np.mean(M_survivors)\n        if M_S_mean > 0:\n            m_rel = M_survivors / M_S_mean\n            \n            # Regression is on a subset, so var(z') is not 1. Use full OLS slope formula.\n            var_z_survivors = np.var(z_prime_survivors) # ddof=0 for population variance of the subset\n            if var_z_survivors > 0:\n                cov_zm_survivors = np.cov(z_prime_survivors, m_rel, ddof=0)[0, 1]\n                b_M = cov_zm_survivors / var_z_survivors\n\n    # 4. Total gradient (b_T)\n    b_T = 0.0\n    W_raw = V_raw * M_raw\n    W_mean = np.mean(W_raw)\n    if W_mean > 0:\n        w_rel = W_raw / W_mean\n        # Regression on full dataset, so simplified formula applies.\n        b_T = np.mean(z_prime * w_rel)\n\n    # 5. Evolutionary prediction (Delta)\n    delta = G_prime * b_T\n    \n    return [b_V, b_M, b_T, delta]\n\nsolve()\n```", "id": "2526754"}, {"introduction": "A response to selection is only possible if the selected trait has a heritable basis. Estimating narrow-sense heritability ($h^2$) is therefore critical, but our measurements are never perfect. This exercise tackles the universal problem of measurement error, demonstrating analytically how it systematically biases heritability estimates downwards. By working through this scenario, you will develop a crucial intuition for how observational noise impacts our inference and learn the formal procedure to correct for it [@problem_id:2526721].", "problem": "A field ecologist is studying a quantitative trait in a wild plant population. Let the latent (true, error-free) phenotype of an individual be denoted by the random variable $Y$, which has phenotypic variance $V_{P}$ and additive genetic variance $V_{A}$. Narrow-sense heritability is defined as $h^{2} = V_{A}/V_{P}$. The trait is measured in the field with an instrument that introduces independent, zero-mean measurement error $E$ with variance $V_{m}$, so that the observed phenotype is $Y_{\\text{obs}} = Y + E$. The investigator, unaware of the measurement error, estimates heritability by dividing the additive genetic variance by the observed phenotypic variance, obtaining an observed heritability $h^{2}_{\\text{obs}}$.\n\nUsing only the definition of narrow-sense heritability and the property that the variance of a sum of independent random variables is the sum of their variances, derive the relationship between $h^{2}$, $h^{2}_{\\text{obs}}$, $V_{P}$, and $V_{m}$, and use it to quantify the downward bias in $h^{2}_{\\text{obs}}$ and compute the correction needed to recover $h^{2}$ from $h^{2}_{\\text{obs}}$.\n\nAssume the following empirically estimated variance components for this population: $V_{A} = 0.24$, $V_{P} = 0.60$, and $V_{m} = 0.15$ (all in squared trait units). Report the corrected heritability $h^{2}$ as a decimal between $0$ and $1$. Round your answer to three significant figures.", "solution": "The problem requires an analysis of how measurement error affects the estimation of narrow-sense heritability, $h^{2}$. We will first validate the problem statement, then proceed with a rigorous derivation if it is found to be valid.\n\n**Problem Validation**\n\n**Step 1: Extract Givens**\n- Latent phenotype: random variable $Y$.\n- Phenotypic variance of $Y$: $V_{P}$.\n- Additive genetic variance: $V_{A}$.\n- Definition of narrow-sense heritability: $h^{2} = V_{A}/V_{P}$.\n- Measurement error: random variable $E$, independent of $Y$, zero-mean, with variance $V_{m}$.\n- Observed phenotype: $Y_{\\text{obs}} = Y + E$.\n- Observed heritability: $h^{2}_{\\text{obs}}$, calculated by dividing the additive genetic variance by the observed phenotypic variance.\n- Variance property: The variance of a sum of independent random variables is the sum of their variances.\n- Empirical variance components: $V_{A} = 0.24$, $V_{P} = 0.60$, $V_{m} = 0.15$.\n- Task: Derive the relationship between $h^{2}$, $h^{2}_{\\text{obs}}$, $V_{P}$, and $V_{m}$. Quantify the bias. Compute the correction. Report the corrected heritability $h^{2}$ to three significant figures.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is scientifically grounded, rooted in the foundational principles of quantitative genetics. The definitions and relationships described (e.g., partitioning of variance, definition of heritability) are standard in the field. The scenario of measurement error contributing to phenotypic variance is a realistic and common problem in empirical ecology and genetics. The problem is well-posed, providing all necessary information and definitions for a unique solution. The numerical values are consistent and plausible ($V_{A} < V_{P}$, all variances are positive). The problem is formalizable and requires direct application of statistical and genetic principles. It is not subjective, metaphysical, or trivial.\n\n**Step 3: Verdict and Action**\nThe problem is valid. We will proceed with the solution.\n\n**Derivation and Solution**\n\nThe true narrow-sense heritability, $h^{2}$, is defined as the ratio of the additive genetic variance, $V_{A}$, to the total latent phenotypic variance, $V_{P}$:\n$$h^{2} = \\frac{V_{A}}{V_{P}}$$\nThe observed phenotype, $Y_{\\text{obs}}$, is the sum of the true phenotype, $Y$, and the measurement error, $E$.\n$$Y_{\\text{obs}} = Y + E$$\nThe investigator calculates an observed heritability, $h^{2}_{\\text{obs}}$, using the variance of the observed phenotype, which we denote as $V_{P, \\text{obs}}$.\n$$h^{2}_{\\text{obs}} = \\frac{V_{A}}{V_{P, \\text{obs}}}$$\nTo find the relationship between $h^{2}$ and $h^{2}_{\\text{obs}}$, we must first express $V_{P, \\text{obs}}$ in terms of the fundamental variance components. The variance of the observed phenotype is $V_{P, \\text{obs}} = \\text{Var}(Y_{\\text{obs}})$. Given that $Y$ and $E$ are independent random variables, the variance of their sum is the sum of their variances:\n$$V_{P, \\text{obs}} = \\text{Var}(Y + E) = \\text{Var}(Y) + \\text{Var}(E)$$\nBy definition, $\\text{Var}(Y) = V_{P}$ and $\\text{Var}(E) = V_{m}$. Therefore, the observed phenotypic variance is inflated by the measurement error variance:\n$$V_{P, \\text{obs}} = V_{P} + V_{m}$$\nNow, substitute this expression into the formula for $h^{2}_{\\text{obs}}$:\n$$h^{2}_{\\text{obs}} = \\frac{V_{A}}{V_{P} + V_{m}}$$\nTo relate this to the true heritability, $h^{2}$, we use the definition $V_{A} = h^{2}V_{P}$. Substituting for $V_{A}$ gives the relationship between the true and observed heritabilities:\n$$h^{2}_{\\text{obs}} = \\frac{h^{2}V_{P}}{V_{P} + V_{m}} = h^{2} \\left( \\frac{V_{P}}{V_{P} + V_{m}} \\right)$$\nThis equation establishes the relationship between $h^{2}$, $h^{2}_{\\text{obs}}$, $V_{P}$, and $V_{m}$.\n\nTo quantify the downward bias, we examine the scaling factor $\\frac{V_{P}}{V_{P} + V_{m}}$. Since variance cannot be negative, $V_{P} > 0$ and $V_{m} \\ge 0$. In this problem, measurement error exists, so $V_{m} > 0$. It follows directly that $V_{P} < V_{P} + V_{m}$, and thus the factor is strictly less than $1$:\n$$\\frac{V_{P}}{V_{P} + V_{m}} < 1$$\nThis demonstrates that $h^{2}_{\\text{obs}} < h^{2}$ (for any $h^2 > 0$), confirming a systematic downward bias in the heritability estimate when measurement error is present but ignored. The bias is the difference $h^{2}_{\\text{obs}} - h^{2}$.\n\nTo find the correction needed to recover the true heritability, $h^{2}$, from the observed value, $h^{2}_{\\text{obs}}$, we rearrange the derived relationship to solve for $h^{2}$:\n$$h^{2} = h^{2}_{\\text{obs}} \\left( \\frac{V_{P} + V_{m}}{V_{P}} \\right) = h^{2}_{\\text{obs}} \\left( 1 + \\frac{V_{m}}{V_{P}} \\right)$$\nThis formula provides the necessary correction. To obtain the true heritability, the observed heritability must be inflated by the factor $(1 + V_{m}/V_{P})$.\n\nFinally, we are asked to report the corrected heritability, $h^{2}$, using the provided empirical variance components. The \"corrected heritability\" is simply the true heritability, which can be calculated directly from the true variance components provided.\nGiven:\n$V_{A} = 0.24$\n$V_{P} = 0.60$\n$V_{m} = 0.15$\n\nUsing the fundamental definition of narrow-sense heritability:\n$$h^{2} = \\frac{V_{A}}{V_{P}} = \\frac{0.24}{0.60}$$\nThe calculation is:\n$$h^{2} = \\frac{24}{60} = \\frac{2}{5} = 0.4$$\nTo demonstrate consistency, we could first calculate the biased estimate $h^{2}_{\\text{obs}}$ and then apply the correction.\n$V_{P, \\text{obs}} = V_{P} + V_{m} = 0.60 + 0.15 = 0.75$.\n$h^{2}_{\\text{obs}} = \\frac{V_{A}}{V_{P, \\text{obs}}} = \\frac{0.24}{0.75} = 0.32$.\nApplying the correction factor:\n$h^{2} = h^{2}_{\\text{obs}} \\left( 1 + \\frac{V_{m}}{V_{P}} \\right) = 0.32 \\left( 1 + \\frac{0.15}{0.60} \\right) = 0.32 (1 + 0.25) = 0.32(1.25) = 0.4$.\nThe results are identical, as expected. The problem requires the answer rounded to three significant figures.\n\nThe corrected heritability is $h^2 = 0.400$.", "answer": "$$\\boxed{0.400}$$", "id": "2526721"}, {"introduction": "Organisms are integrated systems of traits, not isolated characters evolving independently. This practice elevates our analysis to a multivariate world, where we predict the joint evolution of correlated traits using the multivariate breeder's equation, $ \\Delta \\bar{\\mathbf{z}} = \\mathbf{G} \\boldsymbol{\\beta} $. Here, you will see how the genetic variance-covariance matrix ($ \\mathbf{G} $) channels the evolutionary response to a given selection gradient ($ \\boldsymbol{\\beta} $), often causing a population to evolve in a direction that is not aligned with the direction of steepest fitness increase. This exercise reveals the profound importance of genetic correlations in constraining and directing evolutionary trajectories [@problem_id:2526726].", "problem": "A perennial plant species inhabits a heterogeneous environment expresses three quantitative traits: onset of flowering ($z_{1}$), leaf thickness ($z_{2}$), and maximum rooting depth ($z_{3}$). Under weak, constant directional selection during a single generation, assume that the joint evolutionary response is governed by additive genetic covariances among traits and by the directional selection gradient. The additive genetic variance–covariance matrix (the $\\mathbf{G}$ matrix) and the directional selection gradient vector $\\boldsymbol{\\beta}$ have been estimated from a large field study as\n$$\n\\mathbf{G} \\;=\\; \n\\begin{pmatrix}\n2 & 1 & 0 \\\\\n1 & 2 & 0 \\\\\n0 & 0 & 1\n\\end{pmatrix},\n\\qquad\n\\boldsymbol{\\beta} \\;=\\;\n\\begin{pmatrix}\n0.5 \\\\\n0.5 \\\\\n1\n\\end{pmatrix}.\n$$\nUsing only fundamental definitions from quantitative genetics and linear algebra, do the following for a single generation of selection:\n1) Compute the expected change in the vector of trait means, $\\Delta \\bar{\\mathbf{z}}$.\n2) Decompose $\\Delta \\bar{\\mathbf{z}}$ into orthogonal components aligned with the eigenvectors of $\\mathbf{G}$, making explicit the contribution associated with the eigenvector corresponding to the largest eigenvalue of $\\mathbf{G}$.\n\nReport as your final answer the fraction of the squared magnitude of $\\Delta \\bar{\\mathbf{z}}$ explained by the component along the leading eigenvector of $\\mathbf{G}$, expressed as a decimal and rounded to four significant figures. Do not include any units.", "solution": "The problem statement is scientifically grounded, well-posed, and contains all necessary information for a unique solution. It is based on the fundamental multivariate breeder's equation, a cornerstone of quantitative genetics. The provided additive genetic variance-covariance matrix $\\mathbf{G}$ is symmetric and, as will be shown, positive definite, which is a necessary property for such a matrix. The problem is valid.\n\nThe expected evolutionary response in the vector of mean trait values, $\\Delta \\bar{\\mathbf{z}}$, is given by the multivariate breeder's equation:\n$$\n\\Delta \\bar{\\mathbf{z}} = \\mathbf{G} \\boldsymbol{\\beta}\n$$\nwhere $\\mathbf{G}$ is the additive genetic variance-covariance matrix and $\\boldsymbol{\\beta}$ is the directional selection gradient vector.\n\nFirst, we compute $\\Delta \\bar{\\mathbf{z}}$ using the provided matrices:\n$$\n\\mathbf{G} = \\begin{pmatrix} 2 & 1 & 0 \\\\ 1 & 2 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix}, \\qquad \\boldsymbol{\\beta} = \\begin{pmatrix} 0.5 \\\\ 0.5 \\\\ 1 \\end{pmatrix}\n$$\nThe matrix-vector product is:\n$$\n\\Delta \\bar{\\mathbf{z}} = \\begin{pmatrix} 2 & 1 & 0 \\\\ 1 & 2 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix} \\begin{pmatrix} 0.5 \\\\ 0.5 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 2(0.5) + 1(0.5) + 0(1) \\\\ 1(0.5) + 2(0.5) + 0(1) \\\\ 0(0.5) + 0(0.5) + 1(1) \\end{pmatrix} = \\begin{pmatrix} 1.5 \\\\ 1.5 \\\\ 1 \\end{pmatrix}\n$$\nNext, we decompose this response vector, $\\Delta \\bar{\\mathbf{z}}$, into components aligned with the eigenvectors of $\\mathbf{G}$. Since $\\mathbf{G}$ is a real symmetric matrix, its eigenvectors form an orthogonal basis. We must find these eigenvectors and the corresponding eigenvalues. The eigenvalues $\\lambda$ are the roots of the characteristic equation $\\det(\\mathbf{G} - \\lambda\\mathbf{I}) = 0$.\n$$\n\\det\\left(\\begin{pmatrix} 2 & 1 & 0 \\\\ 1 & 2 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix} - \\lambda\\begin{pmatrix} 1 & 0 & 0 \\\\ 0 & 1 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix}\\right) = \\det\\begin{pmatrix} 2-\\lambda & 1 & 0 \\\\ 1 & 2-\\lambda & 0 \\\\ 0 & 0 & 1-\\lambda \\end{pmatrix} = 0\n$$\nExpanding the determinant along the third row gives:\n$$\n(1-\\lambda) \\det\\begin{pmatrix} 2-\\lambda & 1 \\\\ 1 & 2-\\lambda \\end{pmatrix} = (1-\\lambda) \\left[(2-\\lambda)^{2} - 1\\right] = 0\n$$\n$$\n(1-\\lambda) (\\lambda^{2} - 4\\lambda + 4 - 1) = (1-\\lambda) (\\lambda^{2} - 4\\lambda + 3) = (1-\\lambda)(\\lambda-1)(\\lambda-3) = 0\n$$\nThe eigenvalues are $\\lambda_1 = 3$, $\\lambda_2 = 1$, and $\\lambda_3 = 1$. All are positive, confirming that $\\mathbf{G}$ is positive definite. The leading eigenvalue, which corresponds to the axis of greatest genetic variance (known as $g_{max}$), is $\\lambda_{max} = 3$.\n\nWe now find the eigenvector $\\mathbf{e}_{max}$ corresponding to $\\lambda_{max} = 3$. We solve the equation $(\\mathbf{G} - 3\\mathbf{I})\\mathbf{v} = \\mathbf{0}$:\n$$\n\\begin{pmatrix} 2-3 & 1 & 0 \\\\ 1 & 2-3 & 0 \\\\ 0 & 0 & 1-3 \\end{pmatrix} \\begin{pmatrix} v_1 \\\\ v_2 \\\\ v_3 \\end{pmatrix} = \\begin{pmatrix} -1 & 1 & 0 \\\\ 1 & -1 & 0 \\\\ 0 & 0 & -2 \\end{pmatrix} \\begin{pmatrix} v_1 \\\\ v_2 \\\\ v_3 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix}\n$$\nThis yields the system of equations $-v_1 + v_2 = 0$ (so $v_1=v_2$) and $-2v_3 = 0$ (so $v_3=0$). A representative eigenvector is $\\begin{pmatrix} 1 \\\\ 1 \\\\ 0 \\end{pmatrix}$. To obtain the normalized eigenvector, we divide by its norm, $||\\mathbf{v}|| = \\sqrt{1^2 + 1^2 + 0^2} = \\sqrt{2}$.\nThe normalized leading eigenvector is:\n$$\n\\mathbf{e}_{max} = \\frac{1}{\\sqrt{2}} \\begin{pmatrix} 1 \\\\ 1 \\\\ 0 \\end{pmatrix}\n$$\nThe component of $\\Delta \\bar{\\mathbf{z}}$ along the direction of $\\mathbf{e}_{max}$ is given by the projection of $\\Delta \\bar{\\mathbf{z}}$ onto $\\mathbf{e}_{max}$:\n$$\n(\\Delta \\bar{\\mathbf{z}})_{max} = (\\Delta \\bar{\\mathbf{z}} \\cdot \\mathbf{e}_{max}) \\mathbf{e}_{max}\n$$\nThe projection coefficient is the scalar product:\n$$\nc_{max} = \\Delta \\bar{\\mathbf{z}} \\cdot \\mathbf{e}_{max} = \\begin{pmatrix} 1.5 \\\\ 1.5 \\\\ 1 \\end{pmatrix} \\cdot \\left(\\frac{1}{\\sqrt{2}} \\begin{pmatrix} 1 \\\\ 1 \\\\ 0 \\end{pmatrix}\\right) = \\frac{1}{\\sqrt{2}} (1.5 \\times 1 + 1.5 \\times 1 + 1 \\times 0) = \\frac{3}{\\sqrt{2}}\n$$\nThe component of the response vector along $\\mathbf{e}_{max}$ is explicitly $(\\Delta \\bar{\\mathbf{z}})_{max} = \\frac{3}{\\sqrt{2}} \\left( \\frac{1}{\\sqrt{2}} \\begin{pmatrix} 1 \\\\ 1 \\\\ 0 \\end{pmatrix} \\right) = \\frac{3}{2} \\begin{pmatrix} 1 \\\\ 1 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 1.5 \\\\ 1.5 \\\\ 0 \\end{pmatrix}$.\n\nThe problem asks for the fraction of the squared magnitude of $\\Delta \\bar{\\mathbf{z}}$ explained by this component. First, we compute the squared magnitude of the total response vector $\\Delta \\bar{\\mathbf{z}}$:\n$$\n||\\Delta \\bar{\\mathbf{z}}||^2 = (1.5)^2 + (1.5)^2 + 1^2 = 2.25 + 2.25 + 1 = 5.5\n$$\nNext, we compute the squared magnitude of the component along $\\mathbf{e}_{max}$. Since $\\mathbf{e}_{max}$ is a unit vector, this is simply the square of the projection coefficient, $c_{max}^2$:\n$$\n||(\\Delta \\bar{\\mathbf{z}})_{max}||^2 = c_{max}^2 = \\left(\\frac{3}{\\sqrt{2}}\\right)^2 = \\frac{9}{2} = 4.5\n$$\nThe required fraction is the ratio of these squared magnitudes:\n$$\n\\text{Fraction} = \\frac{||(\\Delta \\bar{\\mathbf{z}})_{max}||^2}{||\\Delta \\bar{\\mathbf{z}}||^2} = \\frac{4.5}{5.5} = \\frac{45}{55} = \\frac{9}{11}\n$$\nFinally, we express this fraction as a decimal rounded to four significant figures:\n$$\n\\frac{9}{11} \\approx 0.818181...\n$$\nRounding gives $0.8182$. This result signifies that approximately $81.82\\%$ of the total evolutionary response, in terms of squared change, is constrained along the axis of maximal genetic variance.", "answer": "$$\n\\boxed{0.8182}\n$$", "id": "2526726"}]}