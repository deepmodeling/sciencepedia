{"hands_on_practices": [{"introduction": "The Levins model provides a powerful yet simple starting point for understanding how species persist in fragmented landscapes. Before diving into complex dynamics, it is crucial to grasp the model's core prediction: the equilibrium fraction of occupied patches. This first exercise [@problem_id:1864131] guides you through a fundamental calculation, determining the stable balance point where the rate of new patch colonization, governed by parameter $c$, exactly offsets the rate of local extinction, governed by parameter $e$. Mastering this calculation builds the foundational intuition for the conditions required for metapopulation persistence.", "problem": "A conservation biologist is studying the metapopulation dynamics of a rare butterfly, the Azure-Spotted Skipper (*Lycaeides azureus*), which inhabits a fragmented landscape of isolated alpine meadows. These meadows function as patches in a metapopulation model. The biologist's field data suggests that the dynamics of this system can be described by a model where the rate of new patch colonization is proportional to both the fraction of currently occupied patches (which act as sources of colonists) and the fraction of unoccupied patches (which are available for colonization). Simultaneously, local populations in occupied patches face a constant probability of extinction.\n\nThe colonization rate parameter, a measure of the butterfly's dispersal and establishment ability, is determined to be $c = 0.5 \\text{ year}^{-1}$. The local extinction rate for any single occupied patch is found to be $e = 0.1 \\text{ year}^{-1}$.\n\nAssuming the metapopulation has reached a stable state after a long period, what is the expected equilibrium fraction of meadow patches that are occupied by the Azure-Spotted Skipper? Express your answer as a decimal.", "solution": "Let $p(t)$ denote the fraction of occupied patches at time $t$. The stated processes correspond to the Levins metapopulation model with dynamics\n$$\n\\frac{dp}{dt} = c\\,p(1-p) - e\\,p,\n$$\nwhere $c$ is the colonization rate and $e$ is the local extinction rate. The term $c\\,p(1-p)$ represents colonization proportional to the product of the occupied fraction $p$ (sources) and the unoccupied fraction $1-p$ (available patches), while $e\\,p$ represents extinctions in occupied patches.\n\nAt equilibrium, set $\\frac{dp}{dt}=0$:\n$$\n0 = c\\,p(1-p) - e\\,p = p\\big(c(1-p) - e\\big).\n$$\nThus the equilibria satisfy\n$$\np=0 \\quad \\text{or} \\quad c(1-p) = e.\n$$\nSolving the nontrivial equilibrium gives\n$$\n1 - p = \\frac{e}{c} \\quad \\Rightarrow \\quad p^{*} = 1 - \\frac{e}{c}.\n$$\nFeasibility requires $0 \\leq p^{*} \\leq 1$, and positivity requires $c>e$. Given $c = 0.5 \\text{ year}^{-1}$ and $e = 0.1 \\text{ year}^{-1}$, we have $c>e$ and\n$$\np^{*} = 1 - \\frac{0.1}{0.5} = 1 - 0.2 = 0.8.\n$$\nIn the Levins model, when $c>e$, this nonzero equilibrium is asymptotically stable, so the long-term (stable) fraction of occupied patches is $0.8$.", "answer": "$$\\boxed{0.8}$$", "id": "1864131"}, {"introduction": "An equilibrium point tells us where a system can rest, but it doesn't tell us if it's a stable home or a precarious perch. To truly understand metapopulation persistence, we must analyze the stability of these equilibria. This practice [@problem_id:2508481] introduces the essential tool of linear stability analysis, allowing you to mathematically determine whether a small perturbation from an equilibrium will fade away or grow, pushing the system to a different state. By calculating the eigenvalues associated with the trivial (extinction) and non-trivial (persistence) equilibria, you will gain a deeper, dynamic understanding of the critical threshold $c \\gt e$.", "problem": "Consider a classic metapopulation described by the Levins model, where the state variable $p$ denotes the fraction of habitat patches occupied by a species, with $p \\in [0,1]$. Assume a constant per-patch local extinction hazard $e>0$ and a mass-action colonization process with rate parameter $c>0$, such that the rate of change of occupancy is given by the net balance between colonization and extinction. Using these assumptions, one can write an ordinary differential equation (ODE) for $p$ of the form $\\frac{dp}{dt}=f(p)$, where $f(p)$ depends on $c$, $e$, and $p$. \n\nStarting from these ecological postulates (mass-action colonization proportional to the product of the fractions of occupied and unoccupied patches, and constant per-patch extinction), derive the dynamical function $f(p)$ and determine all equilibria $p^{*}$ of the system. Then, analyze the linear stability of each equilibrium by computing the eigenvalue of the one-dimensional linearization at $p^{*}$, which equals $f'(p^{*})$. Evaluate this quantity at both equilibria and simplify your expressions fully in terms of $c$ and $e$.\n\nProvide your final answer as a row matrix $\\begin{pmatrix} \\lambda_{0} & \\lambda_{1} \\end{pmatrix}$, where $\\lambda_{0}$ is the eigenvalue at $p^{*}=0$ and $\\lambda_{1}$ is the eigenvalue at the nontrivial equilibrium. Express the eigenvalues in units of per unit time. Do not include interpretive text in the final answer; any interpretation of the signs of the eigenvalues should appear only in your derivation. If multiple equilibria coincide or if an equilibrium lies outside $[0,1]$, still report the algebraic expressions obtained by formal evaluation. The final answer must be an analytic expression.", "solution": "The problem requires the derivation and stability analysis of the classic Levins metapopulation model. We must first formalize the dynamics of the system based on the provided ecological postulates.\n\nThe state of the system is described by $p$, the fraction of occupied patches, where $p \\in [0, 1]$. The rate of change of $p$, denoted by $\\frac{dp}{dt}$, is the net result of two opposing processes: colonization and extinction.\n\nThe colonization process is described as a mass-action phenomenon, where new patches are colonized at a rate proportional to the product of the fraction of occupied patches, $p$, and the fraction of unoccupied patches, $(1-p)$. The occupied patches serve as the source of colonists, and the unoccupied patches are the targets for colonization. With a colonization rate parameter $c > 0$, the total rate of colonization is given by:\n$$\n\\text{Colonization Rate} = c p (1-p)\n$$\n\nThe extinction process is described by a constant per-patch extinction hazard, $e > 0$. This means that each occupied patch has a constant probability per unit time of becoming extinct. The total rate of extinction across the metapopulation is this per-patch rate multiplied by the fraction of patches that are currently occupied, $p$. Thus, the total rate of extinction is:\n$$\n\\text{Extinction Rate} = e p\n$$\n\nThe net rate of change of the fraction of occupied patches is the difference between the colonization rate and the extinction rate. This gives us the ordinary differential equation (ODE) for the Levins model:\n$$\n\\frac{dp}{dt} = f(p) = c p (1-p) - e p\n$$\nThis is the dynamical function $f(p)$ that governs the system.\n\nNext, we determine the equilibrium points, or fixed points, $p^{*}$, of the system. Equilibria are states where the system does not change, which means $\\frac{dp}{dt} = 0$. We must solve the equation $f(p^{*}) = 0$:\n$$\nc p^{*} (1-p^{*}) - e p^{*} = 0\n$$\nWe can factor out $p^{*}$ from the expression:\n$$\np^{*} [c (1-p^{*}) - e] = 0\n$$\nThis equation yields two possible solutions for $p^{*}$:\n1.  The trivial equilibrium: $p^{*}_0 = 0$. This corresponds to the state where the species is extinct from the entire metapopulation.\n2.  The non-trivial equilibrium, found by solving $c (1-p^{*}) - e = 0$:\n    $$\n    c(1-p^{*}) = e\n    $$\n    $$\n    1 - p^{*} = \\frac{e}{c}\n    $$\n    $$\n    p^{*}_1 = 1 - \\frac{e}{c}\n    $$\n    This equilibrium represents a state of persistence, where colonization and extinction are in balance. For this equilibrium to be biologically meaningful (i.e., $p^{*}_1 \\in (0, 1]$), the condition $c > e$ must be met. However, the problem instructs us to proceed with the formal algebraic expression regardless of the parameter values.\n\nNow, we analyze the linear stability of these two equilibria. The stability of a one-dimensional system at an equilibrium point $p^{*}$ is determined by the sign of the eigenvalue of the linearized system. This eigenvalue, $\\lambda$, is equal to the derivative of the rate function, $f'(p)$, evaluated at the equilibrium point, $p^{*}$. A negative eigenvalue ($\\lambda < 0$) indicates a stable equilibrium, while a positive eigenvalue ($\\lambda > 0$) indicates an unstable equilibrium.\n\nFirst, we compute the derivative of $f(p)$ with respect to $p$:\n$$\nf(p) = c p - c p^2 - e p\n$$\n$$\nf'(p) = \\frac{d}{dp} (c p - c p^2 - e p) = c - 2c p - e\n$$\n\nNow we evaluate this derivative at each of the two equilibria.\n\nFor the trivial equilibrium, $p^{*}_0 = 0$:\nThe eigenvalue $\\lambda_0$ is given by:\n$$\n\\lambda_0 = f'(0) = c - 2c(0) - e = c - e\n$$\nThe stability of the extinction state depends on the sign of $c-e$. If $c > e$, colonization can overcome extinction near $p=0$, so the equilibrium is unstable. If $c < e$, extinction dominates, and the equilibrium is stable.\n\nFor the non-trivial equilibrium, $p^{*}_1 = 1 - \\frac{e}{c}$:\nThe eigenvalue $\\lambda_1$ is given by:\n$$\n\\lambda_1 = f'\\left(1 - \\frac{e}{c}\\right) = c - 2c\\left(1 - \\frac{e}{c}\\right) - e\n$$\nWe simplify this expression:\n$$\n\\lambda_1 = c - \\left(2c \\cdot 1 - 2c \\cdot \\frac{e}{c}\\right) - e\n$$\n$$\n\\lambda_1 = c - (2c - 2e) - e\n$$\n$$\n\\lambda_1 = c - 2c + 2e - e\n$$\n$$\n\\lambda_1 = -c + e = e - c\n$$\nThis eigenvalue determines the stability of the persistence equilibrium. If $c > e$, then $\\lambda_1 < 0$, and the equilibrium is stable. This is consistent with the condition for its existence in the biologically relevant domain.\n\nThe problem requires the final answer as a row matrix containing the two eigenvalues, $\\lambda_0$ and $\\lambda_1$.\nThe calculated eigenvalues are $\\lambda_0 = c - e$ and $\\lambda_1 = e - c$.", "answer": "$$\\boxed{\\begin{pmatrix} c - e & e - c \\end{pmatrix}}$$", "id": "2508481"}, {"introduction": "While the classic Levins model assumes all patches are identical and equally connected, real-world conservation operates on complex, heterogeneous landscapes. This advanced practice [@problem_id:2508419] challenges you to bridge the gap between simple theory and applied computational ecology. You will implement a spatially realistic metapopulation model where patches vary in size and are connected by a distance-dependent dispersal kernel. By numerically solving for the equilibrium of this complex system, you will directly simulate and quantify the impact of a common conservation action—adding a new, high-quality habitat patch—providing hands-on experience with the tools used to inform modern conservation strategies.", "problem": "Consider a spatially realistic Levins-type metapopulation model in which there are finitely many habitat patches indexed by $i \\in \\{1,\\dots,N\\}$. Patch $i$ has area $A_i &gt; 0$, is located at a point $\\mathbf{z}_i \\in \\mathbb{R}^2$, and has time-dependent occupancy probability $x_i(t) \\in [0,1]$. Assume the following core definitions derived from the colonization–extinction framework.\n\n1. Extinction in patch $i$ occurs as a Poisson process with rate parameter $e &gt; 0$, yielding a loss term $- e \\, x_i(t)$.\n2. Colonization of patch $i$ is driven by mass action from all other occupied patches, modulated by a spatial dispersal kernel that decays exponentially with Euclidean distance. Specifically, define the Euclidean distance $d_{ij} = \\|\\mathbf{z}_i - \\mathbf{z}_j\\|_2$ and the dispersal kernel $k(d) = \\exp(-\\alpha d)$ with $\\alpha &gt; 0$. Let the colonization coefficient be $m &gt; 0$. The total colonization inflow into patch $i$ is proportional to its receiving area $A_i$, the occupancy-weighted, area-weighted, distance-modulated contributions from all other patches, and the availability of the patch $(1 - x_i(t))$. This yields an inflow term of the form\n$$\nm \\, A_i \\, \\bigl(1 - x_i(t)\\bigr)\\, \\sum_{\\substack{j=1\\\\ j\\neq i}}^N A_j \\, x_j(t)\\, e^{-\\alpha d_{ij}}.\n$$\n\nUnder these assumptions, the dynamics of each patch $i$ are governed by\n$$\n\\frac{dx_i}{dt} \\;=\\; m \\, A_i \\, \\bigl(1 - x_i(t)\\bigr)\\, \\sum_{\\substack{j=1\\\\ j\\neq i}}^N A_j \\, x_j(t)\\, e^{-\\alpha d_{ij}} \\;-\\; e \\, x_i(t).\n$$\n\nYour task is to evaluate, for a given landscape and parameter set, the effect of adding a single high-quality patch on the equilibrium occupancy of the entire system. Specifically:\n\n- For each specified test case, first compute the equilibrium occupancy vector $\\mathbf{x}^\\star \\in [0,1]^N$ that satisfies the steady-state condition $\\frac{dx_i}{dt} = 0$ for all $i \\in \\{1,\\dots,N\\}$ for the baseline landscape.\n- Then augment the landscape by adding one additional patch with area equal to $4.0$ times the mean area of the baseline patches and located at the centroid of the baseline coordinates. Recompute the equilibrium occupancy for the augmented landscape (with $N+1$ patches) under the same parameters.\n- Let $\\bar{x} = \\frac{1}{N}\\sum_{i=1}^N x_i^\\star$ denote the baseline mean occupancy and let $\\bar{x}_{+} = \\frac{1}{N+1}\\sum_{i=1}^{N+1} x_{i,+}^\\star$ denote the augmented mean occupancy. For each test case, report the change in mean occupancy\n$$\n\\Delta = \\bar{x}_{+} - \\bar{x},\n$$\nexpressed as a decimal (not a percentage).\n\nYou must solve the steady state as a nonlinear fixed point of the dynamical system given above. Do not assume any externally supplied colonist pool. Use the Euclidean distance on the plane for all $d_{ij}$, and use $e^{-\\alpha d_{ij}}$ for the dispersal kernel. There are no physical units; all distances, areas, rates, and occupancies are dimensionless for this exercise. All reported values must be decimals.\n\nTest suite. Use the following common baseline landscape across all test cases:\n- Baseline number of patches: $N = 12$.\n- Baseline coordinates: a regular rectangular grid with\n  - $x \\in \\{0, 1, 2, 3\\}$ and $y \\in \\{0, 1, 2\\}$,\n  so that $\\mathbf{z}_i$ enumerates all ordered pairs $(x,y)$ with $x$ from $0$ to $3$ and $y$ from $0$ to $2$.\n- Baseline areas (ordered in row-major order by increasing $y$, then by increasing $x$): \n  $[\\,0.8,\\,1.1,\\,1.0,\\,0.9,\\,1.2,\\,0.7,\\,1.3,\\,1.0,\\,0.9,\\,1.1,\\,1.2,\\,0.8\\,]$.\n- Added patch: area equal to $4.0$ times the mean of the baseline areas and location equal to the centroid of the baseline coordinates, that is the arithmetic mean of all baseline $\\mathbf{z}_i$.\n\nEvaluate the following four parameter sets:\n- Case A (general case): $m = 0.35$, $e = 0.20$, $\\alpha = 1.00$.\n- Case B (near the persistence threshold): $m = 0.12$, $e = 0.20$, $\\alpha = 1.00$.\n- Case C (high colonization, shallow kernel): $m = 1.20$, $e = 0.20$, $\\alpha = 0.50$.\n- Case D (moderate colonization, steep kernel): $m = 0.50$, $e = 0.20$, $\\alpha = 3.00$.\n\nAlgorithmic constraints:\n- You must compute steady states by directly solving the steady-state conditions $\\frac{dx_i}{dt} = 0$ for all $i$, using a deterministic numerical scheme that is guaranteed to converge to a fixed point when it exists under these monotone dynamics. One acceptable approach is fixed-point iteration on the steady-state equations derived from the dynamical system above, with a convergence tolerance of at most $10^{-10}$ in the maximum norm and a maximum of at least $10^3$ iterations. If the system does not persist, the unique steady state is the zero vector.\n- For each test case, output a single float $\\Delta$ rounded to six decimal places.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order [Case A, Case B, Case C, Case D]. For example, the printed output must look exactly like\n$[r_A,r_B,r_C,r_D]$\nwith each $r_\\cdot$ a decimal rounded to six places.", "solution": "The problem presented is a well-defined exercise in computational theoretical ecology. It is scientifically grounded in the established theory of metapopulations, mathematically consistent, and provides all necessary data and constraints for a unique numerical solution. The problem is valid, and I will proceed with its resolution.\n\nThe core of the problem is to find the equilibrium state of a system of coupled nonlinear ordinary differential equations describing the occupancy probability $x_i(t)$ of habitat patches. The governing equation for each patch $i$ is given by:\n$$\n\\frac{dx_i}{dt} \\;=\\; m \\, A_i \\, \\bigl(1 - x_i(t)\\bigr)\\, \\sum_{\\substack{j=1\\\\ j\\neq i}}^N A_j \\, x_j(t)\\, e^{-\\alpha d_{ij}} \\;-\\; e \\, x_i(t)\n$$\nHere, $x_i$ is the occupancy of patch $i$, $A_i$ is its area, $d_{ij}$ is the distance between patches $i$ and $j$, and $m$, $e$, and $\\alpha$ are parameters for colonization, extinction, and dispersal decay, respectively.\n\nAn equilibrium or steady state, denoted by the vector $\\mathbf{x}^\\star$, is achieved when the system ceases to change over time, i.e., $\\frac{dx_i}{dt} = 0$ for all $i \\in \\{1,\\dots,N\\}$. Setting the time derivative to zero yields a system of $N$ nonlinear algebraic equations:\n$$\ne \\, x_i \\;=\\; m \\, A_i \\, (1 - x_i) \\, \\sum_{\\substack{j=1\\\\ j\\neq i}}^N A_j \\, x_j \\, e^{-\\alpha d_{ij}}\n$$\nTo solve for $x_i$, we can rearrange this equation. Let us define the \"colonization pressure\" on patch $i$ from all other patches as $C_i(\\mathbf{x}) = m \\, A_i \\, \\sum_{j \\neq i} A_j \\, x_j \\, e^{-\\alpha d_{ij}}$. The equation becomes:\n$$\ne \\, x_i = (1 - x_i) \\, C_i(\\mathbf{x}) = C_i(\\mathbf{x}) - x_i \\, C_i(\\mathbf{x})\n$$\nSolving for $x_i$ gives:\n$$\nx_i (e + C_i(\\mathbf{x})) = C_i(\\mathbf{x}) \\implies x_i = \\frac{C_i(\\mathbf{x})}{e + C_i(\\mathbf{x})}\n$$\nThis form suggests a natural fixed-point iteration scheme to find the equilibrium vector $\\mathbf{x}^\\star$. We can define an iteration map $\\mathbf{F}: [0,1]^N \\to [0,1]^N$ where the $i$-th component is given by:\n$$\nF_i(\\mathbf{x}) = \\frac{m A_i \\sum_{j \\neq i} A_j x_j e^{-\\alpha d_{ij}}}{e + m A_i \\sum_{j \\neq i} A_j x_j e^{-\\alpha d_{ij}}}\n$$\nThe iterative process is then $\\mathbf{x}^{(k+1)} = \\mathbf{F}(\\mathbf{x}^{(k)})$. We initialize the system with a starting vector, for instance $\\mathbf{x}^{(0)}$ with all elements equal to $1$, representing a fully occupied landscape. The map $\\mathbf{F}$ is monotone, meaning that if $\\mathbf{x} \\ge \\mathbf{y}$ component-wise, then $\\mathbf{F}(\\mathbf{x}) \\ge \\mathbf{F}(\\mathbf{y})$. For such systems, starting the iteration from $\\mathbf{x}^{(0)} = (1, \\dots, 1)$ guarantees convergence to the largest physically meaningful fixed point in $[0,1]^N$. If this limit is the zero vector, it means the metapopulation is not viable under the given parameters and goes extinct. The iteration is terminated when the change between successive iterates is negligible, i.e., $\\|\\mathbf{x}^{(k+1)} - \\mathbf{x}^{(k)}\\|_\\infty < 10^{-10}$.\n\nThe computational procedure is as follows:\n1.  For each test case, specified by parameters $m$, $e$, and $\\alpha$:\n2.  Define the baseline landscape with $N=12$ patches. The coordinates $\\mathbf{z}_i$ are points on a $4 \\times 3$ grid, and the areas $A_i$ are provided.\n3.  Compute the equilibrium occupancy vector $\\mathbf{x}^\\star$ for this baseline landscape using the fixed-point iteration method described above. The sum for the colonization pressure can be efficiently computed using matrix-vector multiplication.\n4.  Calculate the mean baseline occupancy $\\bar{x} = \\frac{1}{N}\\sum_{i=1}^N x_i^\\star$.\n5.  Construct the augmented landscape by adding an $(N+1)$-th patch. Its area is $4.0$ times the mean of the baseline areas. Its location is the centroid of the baseline patch coordinates.\n6.  Recompute the equilibrium occupancy vector $\\mathbf{x}_{+}^\\star$ for the new $(N+1)$-patch system using the same iterative solver.\n7.  Calculate the mean augmented occupancy $\\bar{x}_{+} = \\frac{1}{N+1}\\sum_{i=1}^{N+1} x_{i,+}^\\star$.\n8.  The final result for the test case is the difference $\\Delta = \\bar{x}_{+} - \\bar{x}$.\n\nThis procedure is implemented for each of the four parameter sets (Case A, B, C, D) to determine the impact of adding a high-quality patch under different ecological scenarios. The code will perform these calculations and format the output as specified.", "answer": "[0.065115,0.0,0.015293,0.007675]", "id": "2508419"}]}