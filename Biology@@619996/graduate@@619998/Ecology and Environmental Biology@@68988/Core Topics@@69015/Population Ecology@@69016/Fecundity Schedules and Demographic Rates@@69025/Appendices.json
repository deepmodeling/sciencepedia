{"hands_on_practices": [{"introduction": "The timing of life-history events is a cornerstone of demographic analysis. This exercise provides a concrete, hands-on opportunity to explore how changes in survival at different life stages disproportionately affect a population's overall reproductive potential, quantified by the net reproductive rate $R_0$. By working through a hypothetical scenario [@problem_id:2491615], you will gain a deeper intuition for why early-life survival has a much more significant impact on population growth trajectories than late-life survival.", "problem": "An age-structured population has discrete annual age classes $x \\in \\{0,1,2,3,4\\}$, with age-specific survival probabilities $p_x$ from age $x$ to age $x+1$ and age-specific female fecundities $m_x$ (daughters per female). The baseline life history is:\n- $p_0 = 0.6$, $p_1 = 0.8$, $p_2 = 0.7$, $p_3 = 0.5$,\n- $m_0 = 0$, $m_1 = 0.5$, $m_2 = 1.2$, $m_3 = 1.0$, $m_4 = 0.4$.\n\nConsider two counterfactual changes to the mortality schedule that are equal in absolute magnitude but applied at different ages, holding all other vital rates fixed:\n- Younger-mortality change: increase $p_0$ by $+0.1$.\n- Older-mortality change: increase $p_3$ by $+0.1$.\n\nStarting from the definitions of survivorship $l_x$ (with $l_0 = 1$ and $l_{x+1} = l_x p_x$), net reproductive rate $R_0$ (expected lifetime daughters per newborn), and generation time $T$ (mean age of reproduction weighted by realized births), do the following:\n- Compute the baseline $R_0$ and $T$.\n- Compute $R_0$ and $T$ under the younger-mortality change and under the older-mortality change.\n- Use these results to demonstrate how survivorship weights induce different sensitivities of $R_0$ and $T$ to mortality changes at young versus old ages.\n\nFor grading, report only the ratio of the changes in net reproductive rate between the two scenarios,\n$$\\frac{\\Delta R_{0,\\text{young}}}{\\Delta R_{0,\\text{old}}},$$\nas a pure number (unitless), rounded to four significant figures. No other numerical outputs should be reported in your final answer.", "solution": "The problem requires an analysis of the sensitivity of demographic rates, specifically the net reproductive rate $R_0$ and the generation time $T$, to changes in age-specific survival probabilities. We are asked to compare the effect of a mortality change at a young age versus an old age. The solution will proceed by first establishing the baseline demographic parameters, then calculating the parameters under two counterfactual scenarios, and finally analyzing the results to demonstrate the underlying principles of demographic sensitivity.\n\nThe fundamental quantities are defined as follows. Survivorship to age $x$, denoted $l_x$, is the probability a newborn survives to age $x$. It is calculated recursively with $l_0 = 1$ and $l_{x+1} = l_x p_x$, where $p_x$ is the probability of surviving from age $x$ to $x+1$. The net reproductive rate, $R_0$, is the expected number of female offspring produced by a female over her lifetime, given by $R_0 = \\sum_{x} l_x m_x$, where $m_x$ is the age-specific fecundity. The generation time, $T$, is the mean age of mothers in a cohort at the time of offspring birth, calculated as $T = \\frac{\\sum_{x} x l_x m_x}{R_0}$.\n\nLet us first calculate the life table and demographic rates for the baseline scenario. The given vital rates are:\n- Survival probabilities: $p_0 = 0.6$, $p_1 = 0.8$, $p_2 = 0.7$, $p_3 = 0.5$.\n- Fecundities: $m_0 = 0$, $m_1 = 0.5$, $m_2 = 1.2$, $m_3 = 1.0$, $m_4 = 0.4$.\n\nThe survivorship schedule $l_x$ is computed as:\n- $l_0 = 1$\n- $l_1 = l_0 p_0 = 1 \\times 0.6 = 0.6$\n- $l_2 = l_1 p_1 = 0.6 \\times 0.8 = 0.48$\n- $l_3 = l_2 p_2 = 0.48 \\times 0.7 = 0.336$\n- $l_4 = l_3 p_3 = 0.336 \\times 0.5 = 0.168$\n\nUsing these values, we construct the baseline life table:\n| Age $x$ | $p_x$ | $m_x$ | $l_x$ | $l_x m_x$ | $x l_x m_x$ |\n|---|---|---|---|---|---|\n| $0$ | $0.6$ | $0$ | $1$ | $0$ | $0$ |\n| $1$ | $0.8$ | $0.5$ | $0.6$ | $0.3$ | $0.3$ |\n| $2$ | $0.7$ | $1.2$ | $0.48$ | $0.576$ | $1.152$ |\n| $3$ | $0.5$ | $1.0$ | $0.336$ | $0.336$ | $1.008$ |\n| $4$ | - | $0.4$ | $0.168$ | $0.0672$ | $0.2688$ |\n\nFrom the table, we calculate the baseline net reproductive rate, $R_{0, \\text{baseline}}$:\n$$R_{0, \\text{baseline}} = \\sum_{x=0}^{4} l_x m_x = 0 + 0.3 + 0.576 + 0.336 + 0.0672 = 1.2792$$\nAnd the baseline generation time, $T_{\\text{baseline}}$:\n$$\\sum_{x=0}^{4} x l_x m_x = 0 + 0.3 + 1.152 + 1.008 + 0.2688 = 2.7288$$\n$$T_{\\text{baseline}} = \\frac{\\sum x l_x m_x}{R_{0, \\text{baseline}}} = \\frac{2.7288}{1.2792} \\approx 2.1332$$\n\nNext, we evaluate the \"younger-mortality change\" scenario, where $p_0$ is increased by $0.1$.\n$$p_{0, \\text{young}} = 0.6 + 0.1 = 0.7$$\nThis change propagates through the entire survivorship schedule from age $1$ onward. The new survivorship, $l'_{x}$, is related to the baseline $l_x$ by a constant factor for $x \\ge 1$: $l'_{x} = \\frac{p_{0, \\text{young}}}{p_{0, \\text{baseline}}} l_x = \\frac{0.7}{0.6}l_x$.\n- $l'_{0} = 1$\n- $l'_{1} = 1 \\times 0.7 = 0.7$\n- $l'_{2} = 0.7 \\times 0.8 = 0.56$\n- $l'_{3} = 0.56 \\times 0.7 = 0.392$\n- $l'_{4} = 0.392 \\times 0.5 = 0.196$\n\nThe new net reproductive rate, $R_{0, \\text{young}}$, is:\n$$R_{0, \\text{young}} = \\sum_{x=0}^{4} l'_{x} m_x = (1)(0) + (0.7)(0.5) + (0.56)(1.2) + (0.392)(1.0) + (0.196)(0.4)$$\n$$R_{0, \\text{young}} = 0 + 0.35 + 0.672 + 0.392 + 0.0784 = 1.4924$$\nThe change in the net reproductive rate is:\n$$\\Delta R_{0,\\text{young}} = R_{0, \\text{young}} - R_{0, \\text{baseline}} = 1.4924 - 1.2792 = 0.2132$$\nThe new generation time, $T_{\\text{young}}$, is calculated. Note that since $m_0=0$, the change in $p_0$ scales both the numerator and the denominator of the expression for $T$ by the same factor $\\frac{p_{0, \\text{young}}}{p_{0, \\text{baseline}}}$, leaving $T$ unchanged.\n$$\\sum_{x=0}^{4} x l'_{x} m_x = 0 + (1)(0.35) + (2)(0.672) + (3)(0.392) + (4)(0.0784) = 3.1836$$\n$$T_{\\text{young}} = \\frac{3.1836}{1.4924} = \\frac{\\frac{7}{6} \\times 2.7288}{\\frac{7}{6} \\times 1.2792} = T_{\\text{baseline}} \\approx 2.1332$$\n\nNow, we evaluate the \"older-mortality change\" scenario. The baseline life history is restored, and $p_3$ is increased by $0.1$.\n$$p_{3, \\text{old}} = 0.5 + 0.1 = 0.6$$\nThis change only affects survivorship from age $4$ onward. The survivorships $l''_{0}, l''_{1}, l''_{2}, l''_{3}$ are identical to the baseline values.\n- $l''_{4} = l''_{3} p_{3, \\text{old}} = l_{3, \\text{baseline}} \\times 0.6 = 0.336 \\times 0.6 = 0.2016$\nThe new net reproductive rate, $R_{0, \\text{old}}$, is computed by summing the baseline contributions up to age $3$ and adding the new contribution from age $4$:\n$$R_{0, \\text{old}} = \\sum_{x=0}^{3} l_x m_x + l''_{4} m_4 = (0 + 0.3 + 0.576 + 0.336) + (0.2016)(0.4)$$\n$$R_{0, \\text{old}} = 1.212 + 0.08064 = 1.29264$$\nThe change in the net reproductive rate is:\n$$\\Delta R_{0, \\text{old}} = R_{0, \\text{old}} - R_{0, \\text{baseline}} = 1.29264 - 1.2792 = 0.01344$$\nThe generation time $T_{\\text{old}}$ will change, as the relative contribution of the last age class is altered.\n$$\\sum_{x=0}^{4} x l''_{x} m_x = (0+0.3+1.152+1.008) + 4 \\times (0.2016)(0.4) = 2.46 + 0.32256 = 2.78256$$\n$$T_{\\text{old}} = \\frac{2.78256}{1.29264} \\approx 2.1526$$\n\nThe disparity in the magnitude of $\\Delta R_{0}$ between the two scenarios reveals a fundamental principle. The sensitivity of $R_0$ to a change in a survival probability $p_j$ is determined by the total future reproduction of individuals who survive past age $j$. The exact change in $R_0$ due to a change in $p_j$ is given by:\n$$\\Delta R_0 = \\left(\\frac{p'_{j}}{p_j}-1\\right) \\sum_{x=j+1}^{\\omega} l_x m_x = \\frac{\\Delta p_j}{p_j} \\sum_{x=j+1}^{\\omega} l_x m_x$$\nFor the younger-mortality change ($j=0$):\n$$\\Delta R_{0,\\text{young}} = \\frac{\\Delta p_0}{p_0} \\sum_{x=1}^{4} l_x m_x = \\frac{0.1}{0.6} \\times (0.3 + 0.576 + 0.336 + 0.0672) = \\frac{0.1}{0.6} \\times 1.2792 = 0.2132$$\nThis matches our direct calculation. The effect is large because an improvement in early survival allows more individuals to reach all subsequent reproductive ages.\nFor the older-mortality change ($j=3$):\n$$\\Delta R_{0,\\text{old}} = \\frac{\\Delta p_3}{p_3} \\sum_{x=4}^{4} l_x m_x = \\frac{\\Delta p_3}{p_3} (l_4 m_4) = \\frac{0.1}{0.5} \\times (0.168 \\times 0.4) = \\frac{0.1}{0.5} \\times 0.0672 = 0.01344$$\nThis also matches our calculation. The effect is small because an improvement in late-life survival only affects reproduction in the very last age class, which has low survivorship ($l_4$) and moderate fecundity.\n\nThe problem asks for the ratio of these changes.\n$$\\frac{\\Delta R_{0,\\text{young}}}{\\Delta R_{0,\\text{old}}} = \\frac{0.2132}{0.01344} \\approx 15.863095...$$\nRounding to four significant figures, the ratio is $15.86$. This demonstrates that, for this life history, population growth is over $15$ times more sensitive to a $0.1$ absolute change in survival of the youngest age class compared to the same absolute change for one of the oldest age classes.", "answer": "$$\\boxed{15.86}$$", "id": "2491615"}, {"introduction": "Ecological conditions are rarely stable, yet demographic metrics are often calculated from a single snapshot in time. This practice addresses the critical distinction between a 'period' net reproductive rate, based on cross-sectional data, and a 'cohort' rate, which tracks a group over its entire life. This exercise [@problem_id:2491639] is essential for learning to correctly interpret demographic data in changing environments and for understanding how period-based measures can sometimes provide a misleading picture of a population's long-term replacement capacity.", "problem": "An age-structured vertebrate population has annual age classes $a=0,1,2,3$, with reproduction possible at ages $a=1,2,3$. Calendar time is indexed by $y$, with the present year denoted $y=0$. At $y=0$, the cross-sectional age-specific survival probabilities from age $a$ to $a+1$ are $p_0=0.8$, $p_1=0.7$, and $p_2=0.6$. At $y=0$, the age-specific numbers of female offspring per female are $m_1=0.5$, $m_2=1.0$, and $m_3=0.5$. For the single real birth cohort born at $y=-2$, the realized survival probabilities were $p_0=0.6$ (from age $0$ to $1$ during $y=-2$), $p_1=0.5$ (from age $1$ to $2$ during $y=-1$), and $p_2=0.5$ (from age $2$ to $3$ during $y=0$). The realized age-specific female offspring per female for that same cohort were $m_1=0.3$ at age $1$ (during $y=-1$), $m_2=0.7$ at age $2$ (during $y=0$), and $m_3=0.4$ at age $3$ (during $y=1$).\n\nUsing only the fundamental life-table ideas of survivorship across ages and age-specific reproduction, distinguish conceptually between a cohort net reproductive rate and a period net reproductive rate constructed from a single year’s cross-sectional vital rates, and determine which statements below are correct in this scenario. Select all that apply.\n\nA. A cohort net reproductive rate describes the expected number of daughters produced by a newborn from a specified birth year when followed through the actual calendar years of its life; it measures replacement for that cohort. A period net reproductive rate assembled from cross-sectional age-specific rates in year $y=0$ is for a synthetic cohort that would experience those same rates at all ages; it is an appropriate replacement index only if those rates are expected to persist (for example, in a constant or stationary environment), and otherwise is an instantaneous index of replacement under current conditions.\n\nB. If the observed age distribution at $y=0$ appears close to a stable age distribution, then the period and cohort net reproductive rates must be equal even if underlying vital rates have been changing over time.\n\nC. With the data given, the cohort net reproductive rate for the cohort born at $y=-2$ is less than $1$, whereas the period net reproductive rate at $y=0$ exceeds $1$; this illustrates that improving conditions can cause the period measure to overstate replacement relative to realized cohorts born earlier.\n\nD. The period net reproductive rate is a meaningful measure of replacement for any time-varying environment because it averages over all ages present at that time and therefore captures cohort histories.\n\nE. In a constant environment where age-specific survival and fecundity do not change over time, the cohort and period net reproductive rates are generally different because one conditions on a specific birth year while the other does not.", "solution": "The appropriate starting point is the life-table framework. Let $l_a$ denote survivorship to age $a$ for a newborn, and let $m_a$ denote age-specific female offspring per female. The net reproductive rate is fundamentally the expected lifetime daughters per newborn, aggregating age-specific reproduction weighted by survivorship.\n\nCohort versus period constructions differ in how $l_a$ and $m_a$ are assembled across calendar time.\n\n1. Cohort construction. A cohort net reproductive rate follows a real birth cohort through the actual calendar years it experiences. If the cohort is born at $y=y_0$, its survivorship to age $1$ is $l_1=p_0(y_0)$, to age $2$ is $l_2=p_0(y_0)\\,p_1(y_0+1)$, to age $3$ is $l_3=p_0(y_0)\\,p_1(y_0+1)\\,p_2(y_0+2)$, and so on, where $p_a(y)$ denotes the survival from $a$ to $a+1$ in calendar year $y$. Its age-specific reproduction at age $a$ is $m_a(y_0+a)$, the reproduction realized in the calendar year when the cohort is age $a$. The cohort net reproductive rate is then\n$$\nR_0^{\\text{cohort}}=\\sum_{a\\ge 0} l_a\\,m_a,\n$$\nwith the sum over all reproductive ages, using the realized $l_a$ and realized $m_a$ encountered by that cohort. This quantity measures replacement for that particular cohort and is the appropriate descriptor of its realized replacement success.\n\n2. Period construction. A period net reproductive rate uses cross-sectional age-specific rates from a single calendar year, say $y=0$, to build a synthetic cohort that would experience those same rates at every age. Denote the period survival schedule at $y=0$ by $p_a^{(0)}$ and the period maternity schedule by $m_a^{(0)}$. The synthetic survivorships are $l_0^{(0)}=1$, $l_1^{(0)}=p_0^{(0)}$, $l_2^{(0)}=p_0^{(0)}p_1^{(0)}$, $l_3^{(0)}=p_0^{(0)}p_1^{(0)}p_2^{(0)}$, etc., and the period net reproductive rate is\n$$\nR_0^{\\text{period}}(y=0)=\\sum_{a\\ge 0} l_a^{(0)}\\,m_a^{(0)}.\n$$\nThis period $R_0$ is a synthetic-cohort replacement index that is strictly interpretable as replacement for a newborn only if the $y=0$ vital rates were to persist unchanged at all future ages (for example, in a constant environment). In a time-varying environment, it is an instantaneous index of replacement under current conditions, not the realized replacement of any real cohort.\n\nCompute the two quantities for the given data.\n\nCohort born at $y=-2$:\n- Survivorships: $l_0=1$, $l_1=p_0(y=-2)=0.6$, $l_2=p_0(y=-2)\\,p_1(y=-1)=0.6\\times 0.5=0.3$, $l_3=p_0(y=-2)\\,p_1(y=-1)\\,p_2(y=0)=0.6\\times 0.5\\times 0.5=0.15$.\n- Realized $m_a$: $m_1(y=-1)=0.3$, $m_2(y=0)=0.7$, $m_3(y=1)=0.4$.\n- Cohort net reproductive rate:\n$$\nR_0^{\\text{cohort}}=l_1 m_1 + l_2 m_2 + l_3 m_3\n= (0.6)(0.3) + (0.3)(0.7) + (0.15)(0.4)\n= 0.18 + 0.21 + 0.06 = 0.45,\n$$\nwhich is less than $1$.\n\nPeriod at $y=0$:\n- Cross-sectional survival: $p_0^{(0)}=0.8$, $p_1^{(0)}=0.7$, $p_2^{(0)}=0.6$.\n- Synthetic survivorships: $l_0^{(0)}=1$, $l_1^{(0)}=0.8$, $l_2^{(0)}=0.8\\times 0.7=0.56$, $l_3^{(0)}=0.8\\times 0.7\\times 0.6=0.336$.\n- Cross-sectional maternities: $m_1^{(0)}=0.5$, $m_2^{(0)}=1.0$, $m_3^{(0)}=0.5$.\n- Period net reproductive rate:\n$$\nR_0^{\\text{period}}(0)=l_1^{(0)} m_1^{(0)} + l_2^{(0)} m_2^{(0)} + l_3^{(0)} m_3^{(0)}\n= (0.8)(0.5) + (0.56)(1.0) + (0.336)(0.5)\n= 0.4 + 0.56 + 0.168 = 1.128,\n$$\nwhich exceeds $1$.\n\nInterpretation and conditions. In a constant environment where age-specific survival and fecundity do not change with $y$, the cohort and period constructions coincide, so $R_0^{\\text{cohort}}=R_0^{\\text{period}}$. In that case, the replacement threshold $R_0=1$ corresponds exactly to zero intrinsic rate of increase $r=0$ via the Euler–Lotka relationship, and $R_0>1$ corresponds to $r>0$. In time-varying environments, $R_0^{\\text{period}}$ is an instantaneous index under current rates and does not describe realized cohort replacement; $R_0^{\\text{cohort}}$ pertains to a specific cohort’s realized history. When conditions improve over calendar time, period $R_0$ can exceed $1$ even while earlier cohorts have $R_0^{\\text{cohort}}<1$, as in the calculation above.\n\nOption-by-option analysis:\n\nA. This statement correctly distinguishes the cohort construction (realized histories of a specific birth year) from the period construction (synthetic cohort under current cross-sectional rates) and correctly states when the period measure is an appropriate replacement index (when rates persist, such as constant or stationary environments) versus an instantaneous index under changing conditions. Verdict: Correct.\n\nB. Apparent proximity of an observed age distribution to a stable age distribution at $y=0$ does not guarantee equality of cohort and period net reproductive rates when vital rates vary over time. Stability requires time-invariant vital rates (or a well-defined stochastic stationary regime for stochastic stability), which contradicts “have been changing over time.” Even if the age distribution appears approximately stable, period and cohort $R_0$ generally differ under temporal trends. Verdict: Incorrect.\n\nC. The computed values give $R_0^{\\text{cohort}}=0.45<1$ and $R_0^{\\text{period}}(0)=1.128>1$, illustrating that improving conditions can yield a period measure that overstates replacement relative to earlier cohorts. Verdict: Correct.\n\nD. The period net reproductive rate does not average over the current age distribution, nor does it capture cohort histories; it constructs a synthetic cohort from current age-specific rates. It is not guaranteed to be meaningful as a replacement measure in arbitrary time-varying environments beyond being an instantaneous index under the assumption of persistence of current rates. Verdict: Incorrect.\n\nE. In a constant environment, cohort and period constructions coincide, so they are not “generally different.” Verdict: Incorrect.", "answer": "$$\\boxed{AC}$$", "id": "2491639"}, {"introduction": "This capstone exercise bridges demographic theory with practical computation by tasking you to find the true intrinsic rate of increase, $r$, from a life table. You will implement a numerical solution to the fundamental Euler-Lotka equation and compare this exact value to the widely used approximation $\\hat{r} = \\frac{\\ln(R_0)}{T}$. This practice [@problem_id:2491650] will not only solidify your understanding of the relationships between $R_0$, $T$, and $r$, but also equip you with the skills to assess the accuracy of this common approximation across different life-history strategies.", "problem": "You are given discrete-age life tables consisting of three aligned arrays: ages in years, survivorship, and age-specific fertility. Each life table specifies ages $x$, survivorship schedule $l_x$ (probability of survival from birth to age $x$), and fertility schedule $m_x$ (expected number of female offspring produced by a female at age $x$ per year). Assume a time-invariant environment and a density-independent population so that, at demographic steady growth, the population grows or declines exponentially with constant intrinsic rate of increase $r$ per year and a stable age distribution. Use only the following fundamental base: the definitions of survivorship $l_x$, fertility $m_x$, the net reproductive rate $R_0$, and the mean generation time $T$; and the canonical balance condition that links $l_x$, $m_x$, and $r$ in a stable, exponentially growing population. From these, derive the equation that implicitly defines $r$ and design a numerical procedure to solve it. Then compute $R_0$ and $T$ from first principles and use them to form the approximation $\\ln(R_0)/T$. Finally, quantify the approximation error relative to the numerically solved $r$.\n\nImplement a program that, for each life table in the test suite, computes:\n- the intrinsic rate of increase $r$ per year by solving the implicit balance condition,\n- the approximation $\\widehat{r}=\\ln(R_0)/T$ per year, where $R_0$ is the net reproductive rate and $T$ is the mean generation time in years,\n- the absolute error $|r-\\widehat{r}|$.\n\nAll answers must be expressed in per-year units for $r$ and $\\widehat{r}$, and in years for $T$. The numerical outputs you print should be dimensionless floating-point numbers with fixed decimal formatting as specified below.\n\nTest suite:\n- Case A (early-to-mid reproduction, growing population):\n  - $x=\\,[\\,0,1,2,3,4,5,6\\,]$\n  - $l_x=\\,[\\,1.0,0.7,0.6,0.5,0.35,0.2,0.05\\,]$\n  - $m_x=\\,[\\,0.0,0.0,1.2,1.5,1.0,0.2,0.0\\,]$\n- Case B (delayed reproduction, growing population):\n  - $x=\\,[\\,0,1,2,3,4,5,6,7,8,9,10\\,]$\n  - $l_x=\\,[\\,1.0,0.9,0.82,0.74,0.66,0.58,0.5,0.42,0.34,0.26,0.18\\,]$\n  - $m_x=\\,[\\,0.0,0.0,0.0,0.0,0.0,0.0,0.8,1.0,1.0,0.6,0.0\\,]$\n- Case C (near-replacement with early reproduction):\n  - $x=\\,[\\,0,1,2,3,4,5\\,]$\n  - $l_x=\\,[\\,1.0,0.8,0.65,0.5,0.3,0.1\\,]$\n  - $m_x=\\,[\\,0.0,0.0,1.0,0.9,0.3,0.0\\,]$\n- Case D (declining population):\n  - $x=\\,[\\,0,1,2,3,4,5,6\\,]$\n  - $l_x=\\,[\\,1.0,0.6,0.4,0.25,0.12,0.05,0.01\\,]$\n  - $m_x=\\,[\\,0.0,0.0,0.7,0.4,0.1,0.0,0.0\\,]$\n\nAlgorithmic requirements:\n- Derive from first principles the implicit equation for $r$ and solve it numerically with a robust root-finding method on a bracket that guarantees existence and uniqueness under the given assumptions, without relying on closed-form shortcuts.\n- Compute $R_0=\\sum_x l_x m_x$ and $T=\\left(\\sum_x x\\,l_x m_x\\right)/R_0$ from the definitions.\n- Compute $\\widehat{r}=\\ln(R_0)/T$ and the absolute error $|r-\\widehat{r}|$.\n- Round $r$, $\\widehat{r}$, and $|r-\\widehat{r}|$ to $6$ decimal places for output.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element corresponds to one case and is itself a list with three floating-point numbers $[r,\\widehat{r},|r-\\widehat{r}|]$, each formatted with exactly $6$ digits after the decimal point. For example, the printed structure must look like $[[a_1,b_1,c_1],[a_2,b_2,c_2],\\dots]$ with no additional text.\n- No input is provided; the program must embed the test suite and run to completion on its own.", "solution": "The problem as stated is scientifically sound, well-posed, objective, and contains all necessary information for a complete solution. It represents a standard exercise in quantitative population ecology. Therefore, a full solution will be provided.\n\n**1. Derivation of the Euler-Lotka Equation**\n\nThe model assumes a population with discrete age classes $x = 0, 1, 2, \\dots, \\omega$, where $\\omega$ is the maximum age. Let $N(x, t)$ be the number of females in age class $x$ at time $t$. The fundamental renewal process is described by two relationships:\n\nFirst, the number of newborn females at time $t$, denoted $N(0, t)$, is the sum of all offspring produced by females across all age classes:\n$$ N(0, t) = \\sum_{x=0}^{\\omega} N(x, t) m_x $$\nHere, $m_x$ is the age-specific fecundity, i.e., the average number of female offspring produced by a female of age $x$.\n\nSecond, the number of females of age $x$ at time $t$ is the number of females born at time $t-x$ who have survived to age $x$:\n$$ N(x, t) = N(0, t-x) l_x $$\nwhere $l_x$ is the probability of surviving from birth to age $x$.\n\nBy substituting the second expression into the first, we link the number of births at time $t$ to the number of births at previous times:\n$$ N(0, t) = \\sum_{x=0}^{\\omega} N(0, t-x) l_x m_x $$\nThis is the general renewal equation for the population.\n\nThe problem states that the population grows exponentially with a stable age distribution. This implies that the population size, and specifically the number of newborns, grows at a constant intrinsic rate $r$:\n$$ N(0, t) = N(0, 0) e^{rt} $$\nwhere $N(0, 0)$ is the number of newborns at $t=0$. From this, the number of newborns at time $t-x$ can be expressed as:\n$$ N(0, t-x) = N(0, 0) e^{r(t-x)} = (N(0, 0) e^{rt}) e^{-rx} = N(0, t) e^{-rx} $$\n\nSubstituting this back into the renewal equation yields:\n$$ N(0, t) = \\sum_{x=0}^{\\omega} \\left( N(0, t) e^{-rx} \\right) l_x m_x $$\nFor a non-extinct population, $N(0, t) > 0$, so we can divide both sides by $N(0, t)$. This gives the canonical balance condition, known as the discrete-time Euler-Lotka equation, which implicitly defines $r$:\n$$ 1 = \\sum_{x=0}^{\\omega} l_x m_x e^{-rx} $$\n\n**2. Numerical Solution for the Intrinsic Rate of Increase, $r$**\n\nTo find $r$, we must solve the equation $f(r) = 0$, where:\n$$ f(r) = \\left( \\sum_{x=0}^{\\omega} l_x m_x e^{-rx} \\right) - 1 $$\nTo ensure that a unique solution exists and can be found numerically, we examine the properties of $f(r)$. Its derivative with respect to $r$ is:\n$$ f'(r) = \\frac{d}{dr} \\left( \\sum_{x=0}^{\\omega} l_x m_x e^{-rx} \\right) = - \\sum_{x=0}^{\\omega} x l_x m_x e^{-rx} $$\nSince age $x$, survivorship $l_x$, and fecundity $m_x$ are all non-negative, and the exponential term is always positive, the derivative $f'(r)$ is strictly negative (assuming reproduction occurs at any age $x>0$). This monotonicity guarantees that if a root for $r$ exists, it is unique.\n\nThe existence of a root is guaranteed by the Intermediate Value Theorem. As $r \\to \\infty$, $e^{-rx} \\to 0$ for $x>0$, so $f(r) \\to -1$ (assuming $m_0=0$). As $r \\to -\\infty$, $e^{-rx} \\to \\infty$ for $x>0$, so $f(r) \\to \\infty$. Since $f(r)$ is continuous and changes sign, a root must exist.\n\nA robust numerical method, such as Brent's method, can find this root if given a bracket $[a,b]$ where $f(a)$ and $f(b)$ have opposite signs. A convenient point to check is $r=0$:\n$$ f(0) = \\left( \\sum_{x=0}^{\\omega} l_x m_x \\right) - 1 = R_0 - 1 $$\nwhere $R_0$ is the net reproductive rate.\n- If $R_0 > 1$, then $f(0) > 0$, and the root $r$ must be positive.\n- If $R_0 < 1$, then $f(0) < 0$, and the root $r$ must be negative.\n- If $R_0 = 1$, then $f(0) = 0$, and the root is $r=0$.\nA bracketing interval such as $[-1, 1]$ is generally sufficient for populations with realistic demographic rates.\n\n**3. Calculation of Auxiliary Demographic Parameters**\n\nThe problem also requires calculating the net reproductive rate ($R_0$), the mean generation time ($T$), and an approximation of $r$ ($\\widehat{r}$).\n\n- **Net Reproductive Rate ($R_0$)**: $R_0$ is the expected number of female offspring produced by a female over her lifetime. For discrete age classes, it is calculated by summing the product of age-specific survivorship and fecundity:\n$$ R_0 = \\sum_{x=0}^{\\omega} l_x m_x $$\n\n- **Mean Generation Time ($T$)**: $T$ is the average age of mothers in a cohort of newborns. It is the mean of the age-specific net reproductive schedule, $l_x m_x$:\n$$ T = \\frac{\\sum_{x=0}^{\\omega} x l_x m_x}{\\sum_{x=0}^{\\omega} l_x m_x} = \\frac{\\sum_{x=0}^{\\omega} x l_x m_x}{R_0} $$\n\n- **Approximation of $r$ ($\\widehat{r}$)**: A widely used approximation for $r$ is:\n$$ \\widehat{r} = \\frac{\\ln(R_0)}{T} $$\nThis approximation is derived from a first-order Taylor series expansion of the Euler-Lotka equation around $r=0$ and is most accurate for populations near replacement level (i.e., $R_0 \\approx 1$).\n\n**4. Quantifying Approximation Error**\n\nThe accuracy of the approximation is assessed by computing the absolute error between the numerically solved value $r$ and the approximation $\\widehat{r}$:\n$$ \\text{Error} = |r - \\widehat{r}| $$\n\nThe implementation will follow these derivations, using numerical libraries for efficient calculation and root-finding.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import brentq\n\ndef solve():\n    \"\"\"\n    Solves for demographic rates r, r_hat, and their error for a suite of life tables.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"name\": \"Case A (early-to-mid reproduction, growing)\",\n            \"x\": [0, 1, 2, 3, 4, 5, 6],\n            \"lx\": [1.0, 0.7, 0.6, 0.5, 0.35, 0.2, 0.05],\n            \"mx\": [0.0, 0.0, 1.2, 1.5, 1.0, 0.2, 0.0],\n        },\n        {\n            \"name\": \"Case B (delayed reproduction, growing)\",\n            \"x\": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10],\n            \"lx\": [1.0, 0.9, 0.82, 0.74, 0.66, 0.58, 0.5, 0.42, 0.34, 0.26, 0.18],\n            \"mx\": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.8, 1.0, 1.0, 0.6, 0.0],\n        },\n        {\n            \"name\": \"Case C (near-replacement with early reproduction)\",\n            \"x\": [0, 1, 2, 3, 4, 5],\n            \"lx\": [1.0, 0.8, 0.65, 0.5, 0.3, 0.1],\n            \"mx\": [0.0, 0.0, 1.0, 0.9, 0.3, 0.0],\n        },\n        {\n            \"name\": \"Case D (declining population)\",\n            \"x\": [0, 1, 2, 3, 4, 5, 6],\n            \"lx\": [1.0, 0.6, 0.4, 0.25, 0.12, 0.05, 0.01],\n            \"mx\": [0.0, 0.0, 0.7, 0.4, 0.1, 0.0, 0.0],\n        }\n    ]\n\n    results_for_print = []\n    \n    for case in test_cases:\n        x = np.array(case[\"x\"], dtype=float)\n        lx = np.array(case[\"lx\"], dtype=float)\n        mx = np.array(case[\"mx\"], dtype=float)\n\n        # 1. Calculate Net Reproductive Rate (R0)\n        # R0 = sum(lx * mx)\n        R0 = np.sum(lx * mx)\n\n        # 2. Solve for the intrinsic rate of increase (r) using the Euler-Lotka equation.\n        # The equation is: sum(lx * mx * exp(-r*x)) = 1\n        # We find the root of the function f(r) = sum(lx * mx * exp(-r*x)) - 1\n        def euler_lotka_func(r_val):\n            return np.sum(lx * mx * np.exp(-r_val * x)) - 1.0\n\n        # If R0 is exactly 1, r is 0. Otherwise, solve numerically.\n        if np.isclose(R0, 1.0):\n            r = 0.0\n        else:\n            # A search bracket of [-1, 1] is robust for typical ecological data.\n            try:\n                r = brentq(euler_lotka_func, -1.0, 1.0)\n            except ValueError:\n                # In case the root is not in [-1, 1], expand the search.\n                # This is unlikely for the given test cases.\n                r = brentq(euler_lotka_func, -5.0, 5.0)\n\n        # 3. Calculate Mean Generation Time (T)\n        # T = sum(x * lx * mx) / R0\n        # If R0 is 0, T is undefined. However, mx values ensure R0 > 0 here.\n        if R0 > 0:\n            T = np.sum(x * lx * mx) / R0\n        else:\n            # This case should not be reached with the provided data.\n            T = np.nan\n\n        # 4. Calculate the approximation r_hat\n        # r_hat = ln(R0) / T\n        if R0 > 0 and T > 0:\n            r_hat = np.log(R0) / T\n        else:\n            r_hat = 0.0 if np.isclose(R0, 1.0) else np.nan\n\n        # 5. Calculate the absolute error\n        error = np.abs(r - r_hat)\n\n        # Append formatted results for the current case\n        sub_list = [f\"{val:.6f}\" for val in [r, r_hat, error]]\n        results_for_print.append(f\"[{','.join(sub_list)}]\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results_for_print)}]\")\n\nsolve()\n```", "id": "2491650"}]}