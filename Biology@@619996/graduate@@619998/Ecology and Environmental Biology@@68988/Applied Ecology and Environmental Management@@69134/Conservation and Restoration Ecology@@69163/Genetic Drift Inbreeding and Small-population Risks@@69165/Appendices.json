{"hands_on_practices": [{"introduction": "Understanding the risks faced by small populations begins with quantifying inbreeding, a primary consequence of mating between relatives. Before analyzing the population-level effects of inbreeding, it is essential to first master the fundamental skill of calculating the inbreeding coefficient ($F$) for an individual from their pedigree. This exercise [@problem_id:2494476] provides hands-on practice with Sewall Wright's classic path counting method, grounding the abstract concept of identity by descent in a concrete, derivable calculation.", "problem": "A closed, demographically stable wildlife population has random mating except for a single documented inbreeding event: two first cousins mate. The first cousins are the offspring of two full siblings, and those full siblings share two common, unrelated and non-inbred parents. Assume no other pedigree loops exist and that all other ancestors are unrelated and non-inbred. Let the inbreeding coefficient of an individual be defined as the probability that the two alleles at a randomly chosen autosomal locus in that individual are identical by descent (IBD), where identity by descent (IBD) means copied from the same ancestral allele in some common ancestor.\n\nUsing first principles and the above definition, compute the inbreeding coefficient $F$ of the offspring of the first cousins by reasoning via path counting through the pedigree. In your derivation, explicitly justify how the probability factors arise from meioses along each path and why common ancestors contribute additively when they are distinct individuals.\n\nProvide your final $F$ as an exact fraction (no rounding). Do not use a percentage.", "solution": "The problem statement is subjected to critical validation before any attempt at a solution.\n\n**Step 1: Extraction of Givens**\n- Population: a closed, demographically stable wildlife population.\n- Mating System: random mating with one specified exception.\n- Inbreeding Event: two first cousins mate.\n- Pedigree of First Cousins: They are the offspring of two full siblings.\n- Pedigree of Full Siblings: They share two common, unrelated, and non-inbred parents.\n- Assumptions: No other pedigree loops exist; all other ancestors are unrelated and non-inbred.\n- Definition of Inbreeding Coefficient ($F$): The probability that the two alleles at a randomly chosen autosomal locus in an individual are identical by descent (IBD).\n- Definition of IBD: Copied from the same ancestral allele in some common ancestor.\n- Task: Compute the inbreeding coefficient $F$ of the offspring of the first cousins.\n- Method: Use first principles and path counting through the pedigree.\n- Required Justification: Explain the origin of probability factors from meiosis and the additive contribution of distinct common ancestors.\n- Final Answer Format: Exact fraction.\n\n**Step 2: Validation of Problem Statement**\nThe problem is scientifically grounded. The concepts of inbreeding coefficient ($F$), identity by descent (IBD), and Sewall Wright's method of path coefficients are fundamental, well-established principles in population genetics, a sub-discipline of ecology and biology. The pedigree described—a mating between first cousins—is a classic, standard model used for teaching and analysis.\n\nThe problem is well-posed and self-contained. It provides a clear definition of the quantity to be calculated ($F$) and a complete description of the pedigree, including the crucial assumptions that the founders of the inbred loop are themselves non-inbred ($F_A=0$) and unrelated. This removes ambiguity and ensures a unique, stable solution can be derived. The problem does not contain contradictory information or violate principles of mathematical logic or biological science. It is an objective, formalizable problem that is directly relevant to the topic of small-population risks in environmental biology.\n\n**Step 3: Verdict and Action**\nThe problem is deemed valid. A complete solution will be derived.\n\n**Derivation of Inbreeding Coefficient ($F$)**\n\nThe inbreeding coefficient, $F$, of an individual is the probability that the two alleles at any given autosomal locus are identical by descent (IBD). Let the individual in question be $I$, and its parents be $S$ (sire) and $D$ (dam). The value of $F$ for individual $I$ depends on the extent to which its parents $S$ and $D$ are related.\n\nThe calculation is based on tracing the paths of alleles through the pedigree from the parents $S$ and $D$ back to their common ancestors. For an offspring's alleles to be IBD, they must be copies of a single allele that existed in a common ancestor.\n\nFirst, we construct the pedigree based on the problem description.\nLet the offspring be $I$. Its parents are first cousins, denoted $C_1$ and $C_2$. So, $S=C_1$ and $D=C_2$.\nThe parents of $C_1$ and $C_2$ are full siblings. Let the parent of $C_1$ from the shared lineage be $P_1$, and the parent of $C_2$ from the shared lineage be $P_2$. Thus, $P_1$ and $P_2$ are full siblings.\nThese siblings, $P_1$ and $P_2$, share two common parents, who are the great-grandparents of individual $I$. Let us denote these common ancestors as $A_1$ and $A_2$. The problem states that $A_1$ and $A_2$ are \"unrelated and non-inbred\". This means the inbreeding coefficient of each, $F_{A_1}$ and $F_{A_2}$, is $0$.\nThe other parents of $C_1$ and $C_2$ are from outside this lineage and are unrelated to any individuals in it, as per the problem statement.\n\nThe pedigree is as follows:\n$$\n\\begin{array}{ccc}\nA_1 & \\text{---} & A_2 \\\\\n| & & | \\\\\n\\hline\n| & & | \\\\\nP_1 & & P_2 \\\\\n| & & | \\\\\nC_1 & \\text{---} & C_2 \\\\\n\\multicolumn{3}{c}{|} \\\\\n\\multicolumn{3}{c}{I}\n\\end{`array}\n$$\n\nThe total inbreeding coefficient $F_I$ is the sum of the probabilities of IBD through each distinct common ancestor of the parents, $C_1$ and $C_2$. The common ancestors are $A_1$ and $A_2$.\nThe contribution of a single, non-inbred common ancestor $A$ to the inbreeding coefficient is given by the formula:\n$$ P(\\text{IBD via } A) = \\left(\\frac{1}{2}\\right)^{n_1 + n_2 + 1} $$\nwhere $n_1$ is the number of generations (meiotic divisions) separating parent $C_1$ from the common ancestor $A$, and $n_2$ is the number of generations separating parent $C_2$ from the same ancestor $A$.\n\nWe must justify this formula from first principles. Consider the probability that the gamete from from $C_1$ and the gamete from $C_2$ both carry an allele that is a copy of a *specific* allele (e.g., allele $x$) from ancestor $A$.\nThe path from $A$ to $C_1$ involves $n_1$ meiotic divisions. At each division, the probability of passing on the specific allele is $1/2$. Thus, the probability that $C_1$ carries allele $x$ from $A$ is $(1/2)^{n_1}$. The subsequent probability that $C_1$ passes this allele into the gamete that forms $I$ is $1/2$. Therefore, the total probability that the gamete from $C_1$ carries allele $x$ from $A$ is $(1/2)^{n_1+1}$.\nSimilarly, the probability that the gamete from $C_2$ carries the same allele $x$ from $A$ is $(1/2)^{n_2+1}$.\nAssuming these transmission paths are independent, the probability that both gametes carry allele $x$ is the product: $(1/2)^{n_1+1} \\times (1/2)^{n_2+1} = (1/2)^{n_1+n_2+2}$.\n\nNow, a non-inbred ancestor $A$ has two distinct alleles, say $x$ and $y$. The event of IBD can occur if both gametes receive copies of $x$, OR if both gametes receive copies of $y$. These are two mutually exclusive events.\nThe probability for both gametes to receive $x$ is $(1/2)^{n_1+n_2+2}$.\nThe probability for both gametes to receive $y$ is also $(1/2)^{n_1+n_2+2}$.\nThe total probability of IBD through ancestor $A$ is the sum of these probabilities:\n$$ P(\\text{IBD via } A) = \\left(\\frac{1}{2}\\right)^{n_1+n_2+2} + \\left(\\frac{1}{2}\\right)^{n_1+n_2+2} = 2 \\times \\left(\\frac{1}{2}\\right)^{n_1+n_2+2} = \\left(\\frac{1}{2}\\right)^{n_1+n_2+1} $$\nThis justifies the formula used.\n\nNow, we apply this to the specific pedigree.\n\n**Contribution from Common Ancestor $A_1$:**\nThe path from parent $C_1$ to ancestor $A_1$ is $C_1 \\leftarrow P_1 \\leftarrow A_1$. The number of generations is $n_1 = 2$.\nThe path from parent $C_2$ to ancestor $A_1$ is $C_2 \\leftarrow P_2 \\leftarrow A_1$. The number of generations is $n_2 = 2$.\nThe contribution to $F_I$ from $A_1$ is:\n$$ F_{I, A_1} = \\left(\\frac{1}{2}\\right)^{2+2+1} = \\left(\\frac{1}{2}\\right)^{5} = \\frac{1}{32} $$\n\n**Contribution from Common Ancestor $A_2$:**\nThe path from parent $C_1$ to ancestor $A_2$ is $C_1 \\leftarrow P_1 \\leftarrow A_2$. The number of generations is $n_1 = 2$.\nThe path from parent $C_2$ to ancestor $A_2$ is $C_2 \\leftarrow P_2 \\leftarrow A_2$. The number of generations is $n_2 = 2$.\nThe contribution to $F_I$ from $A_2$ is:\n$$ F_{I, A_2} = \\left(\\frac{1}{2}\\right)^{2+2+1} = \\left(\\frac{1}{2}\\right)^{5} = \\frac{1}{32} $$\n\nThe total inbreeding coefficient, $F_I$, is the sum of the contributions from all distinct, non-overlapping paths. The problem states that the common ancestors, $A_1$ and $A_2$, are \"unrelated\". This means that an allele in the offspring $I$ cannot be IBD from both $A_1$ and $A_2$ simultaneously. The events of being IBD via $A_1$ and being IBD via $A_2$ are mutually exclusive. Therefore, their probabilities are additive.\n\n$$ F_I = F_{I, A_1} + F_{I, A_2} $$\n$$ F_I = \\frac{1}{32} + \\frac{1}{32} = \\frac{2}{32} = \\frac{1}{16} $$\n\nThe inbreeding coefficient of the offspring of first cousins, under the given assumptions, is $1/16$.", "answer": "$$\n\\boxed{\\frac{1}{16}}\n$$", "id": "2494476"}, {"introduction": "While pedigree analysis reveals inbreeding in individuals, genetic drift is the population-level process that increases the average probability of inbreeding over time. The rate of drift, and thus the rate of genetic diversity loss, is governed by the effective population size ($N_e$), a concept that often differs significantly from the simple census count ($N$). This practice problem [@problem_id:2494485] challenges you to derive $N_e$ from first principles in a population with a skewed sex ratio, providing a clear, mechanistic understanding of why demographic factors can accelerate the pace of genetic drift.", "problem": "An isolated diploid species with separate sexes has a census of $N_m = 50$ adult males and $N_f = 200$ adult females in a given breeding season. Assume an idealized Wright–Fisher model with discrete generations, random mating, non-overlapping generations, and no selection, migration, or mutation. Each zygote is formed by the union of one haploid gamete drawn from the male gamete pool and one haploid gamete drawn from the female gamete pool, with all adults within a sex contributing gametes equally on average and with offspring numbers following the multinomial sampling inherent to this model.\n\nUsing the definition of the inbreeding effective population size, namely that the per-generation increase in the inbreeding coefficient $F$ due to random sampling, $\\Delta F$, satisfies $\\Delta F = 1/(2 N_e)$ for some $N_e$ that would produce the same $\\Delta F$ as an ideal monoecious population, derive $\\Delta F$ for the two-sex population by considering the probability that two randomly sampled gene copies in generation $t$ are identical by descent (Identity by Descent, IBD) because they coalesce in generation $t-1$. From this, compute the effective population size $N_e$ for the given $N_m$ and $N_f$ under these assumptions. State your numerical answer exactly. Then, briefly explain, in mechanistic terms grounded in the sampling process you used, why a skewed sex ratio reduces $N_e$ relative to the census size.\n\nYour final numerical answer must be a single real number. No rounding is required. No units are needed.", "solution": "We begin from the inbreeding-based definition of effective population size: in a monoecious ideal Wright–Fisher population of size $N$, the per-generation change in the inbreeding coefficient satisfies $\\Delta F = 1/(2N)$. By definition of the inbreeding effective population size $N_e$, any population whose per-generation increase in inbreeding is $\\Delta F$ is assigned $N_e$ such that $\\Delta F = 1/(2 N_e)$.\n\nTo compute $\\Delta F$ for a two-sex population with $N_m$ males and $N_f$ females, we calculate the probability that two gene copies sampled at random from generation $t$ coalesce (are copies of the same gene copy) in generation $t-1$. This probability equals $1/(2N_e)$ by definition.\n\nLet's trace two gene lineages backward one generation from generation $t$.\n1.  With probability $1/4$, both lineages are paternal. Given this, they trace to the same father with probability $1/N_m$.\n2.  With probability $1/4$, both lineages are maternal. Given this, they trace to the same mother with probability $1/N_f$.\n3.  If they trace to different-sex parents (probability $1/2$), they cannot coalesce in the parent generation.\n\nThe probability of tracing to the same parent individual is therefore $\\frac{1}{4N_m} + \\frac{1}{4N_f}$. For coalescence to occur, the two lineages must also descend from the *same* one of that parent's two gene copies, which occurs with probability $1/2$ (assuming the parents are non-inbred, which is standard for this one-step calculation).\n\nThe total one-generation coalescence probability is thus:\n$$\nP_{\\text{coal}} = \\frac{1}{2} \\left( \\frac{1}{4N_m} + \\frac{1}{4N_f} \\right) = \\frac{1}{8N_m} + \\frac{1}{8N_f}\n$$\nSetting this equal to the coalescence probability in an ideal population, $1/(2N_e)$, we have:\n$$\n\\frac{1}{2N_e} = \\frac{1}{8N_m} + \\frac{1}{8N_f}\n$$\nMultiplying by 2 gives the relationship for the inverse of the effective size:\n$$\n\\frac{1}{N_e} = \\frac{1}{4N_m} + \\frac{1}{4N_f}\n$$\nSolving for $N_e$ yields the formula:\n$$\nN_e = \\frac{4 N_m N_f}{N_m + N_f}\n$$\nSubstituting $N_m = 50$ and $N_f = 200$,\n$$\nN_e \\;=\\; \\frac{4 \\times 50 \\times 200}{50 + 200}\n\\;=\\; \\frac{40000}{250}\n\\;=\\; 160.\n$$\nThus, the effective population size is $160$.\n\nMechanistic explanation of the reduction in $N_e$ under a skewed sex ratio: The rate of genetic drift is inversely proportional to $N_e$. Our derivation shows that the inverse effective size is the sum of contributions from the male and female pools: $\\frac{1}{N_e} = \\frac{1}{4N_m} + \\frac{1}{4N_f}$. This relationship is a form of harmonic mean, which is always heavily influenced by the smallest term in the sum. When the sex ratio is skewed, the rarer sex (e.g., $N_m$) has a smaller number, making its contribution ($1/(4N_m)$) to the total rate of drift large. This pulls the overall $N_e$ down towards the number of the rarer sex. Intuitively, the rarer sex acts as a genetic bottleneck; since every offspring must have one parent from that sex, there is a higher chance for two random offspring to share a parent from that limited pool, accelerating drift and inbreeding.", "answer": "$$\\boxed{160}$$", "id": "2494485"}, {"introduction": "The ultimate risk for a small population arises from the dangerous feedback between its genetics and its demography, a phenomenon known as the extinction vortex. This capstone exercise [@problem_id:2494475] moves from static calculations to dynamic systems modeling, tasking you with building a coupled eco-evolutionary model from the ground up. By simulating the interplay between declining population size ($N_t$), rising inbreeding ($F_t$), and fitness reduction, you will gain direct experience in identifying the threshold conditions that can trap a population in an accelerating spiral towards extinction.", "problem": "You are asked to build and analyze a discrete-time coupled demographic–genetic model that captures the feedback between inbreeding accumulation and population growth in small populations. Your implementation must start from fundamental and well-tested relationships and must not rely on any unspecified heuristics.\n\nDefine a population size sequence $\\{N_t\\}_{t \\ge 0}$ and an inbreeding coefficient sequence $\\{F_t\\}_{t \\ge 0}$ with the following properties.\n\n- Demography. Use a Ricker-type density regulation and multiplicative Allee effect. The per-generation update of census size is\n$$\nN_{t+1} \\;=\\; N_t \\;\\exp\\!\\big(r \\,(1 - N_t/K)\\big)\\; \\exp(-B\\,F_t)\\; \\frac{N_t}{N_t + A},\n$$\nwhere $r$ is the intrinsic growth parameter, $K$ is the carrying capacity, $A$ is the Allee-effect scale, and $\\exp(-B F_t)$ is the mean fitness reduction due to inbreeding (with inbreeding load parameter $B$ measured in diploid lethal equivalents).\n\n- Genetics. In each generation, the inbreeding coefficient updates according to the standard Wright–Fisher random mating recursion without mutation or migration:\n$$\nF_{t+1} \\;=\\; F_t \\;+\\; \\frac{1 - F_t}{2\\,N_{e,t}},\n$$\nwhere the effective population size (denoted $N_{e,t}$) scales with census size as $N_{e,t} \\,=\\, \\alpha\\, N_t$ and $\\alpha \\in (0,1]$ captures variance in reproductive success and departures from ideal conditions. To maintain biological plausibility in very small populations, impose a lower bound on effective size such that $N_{e,t} \\leftarrow \\max(\\alpha N_t, N_e^{\\min})$ with $N_e^{\\min} = 1$.\n\n- Extinction boundary. Treat $N_t \\le N_{\\mathrm{ext}}$ as an absorbing extinction state with $N_{\\mathrm{ext}} = 10^{-3}$. Once $N_t \\le N_{\\mathrm{ext}}$, the population is considered extinct and remains there for classification purposes.\n\nInterpretation. The coupling creates a feedback: small $N_t$ reduces $N_{e,t}$, which accelerates the increase of $F_t$, which reduces mean fitness $\\exp(-B F_t)$, which can further depress $N_{t+1}$, possibly creating an extinction vortex. Conversely, sufficiently large $N_t$ increases $N_{e,t}$, slows the increase of $F_t$, and can allow persistence.\n\nTask. For each parameter set in the test suite below, run two deterministic simulations of the coupled system from initial conditions $(N_0^{\\mathrm{low}}, F_0)$ and $(N_0^{\\mathrm{high}}, F_0)$, with $F_0 = 0$. Evolve the system for exactly $T$ generations. Classify the long-run outcome for that parameter set by comparing the two runs:\n\n- If both trajectories hit extinction (i.e., $N_t \\le N_{\\mathrm{ext}}$ in $\\le T$ steps), return the integer $0$.\n- If both trajectories persist (i.e., neither hits extinction within $T$ steps), return the integer $1$.\n- If exactly one trajectory hits extinction and the other persists within $T$ steps, return the integer $2$ (evidence of bistability and an extinction vortex threshold).\n\nFundamental base for derivation. You must base your construction on: (i) the definition of inbreeding coefficient update in a Wright–Fisher population, (ii) the relation between effective and census sizes via a proportionality constant, (iii) multiplicative inbreeding depression on mean fitness modeled as $\\exp(-B F)$, and (iv) a Ricker-type demographic update with an Allee effect factor.\n\nNumerical requirements. This problem is posed in dimensionless form, so no physical units are required. Angles are not involved. Any fractions or proportions should be represented as decimals in the code. All numeric decisions in your algorithm (including extinction detection) must follow the definitions given above without deviation.\n\nTest suite. Use exactly the following parameter sets. Each tuple is $(r, K, A, \\alpha, B, N_0^{\\mathrm{low}}, N_0^{\\mathrm{high}}, T)$, all numbers are real and provided here:\n\n- Case $\\;1$: $(\\,1.0,\\, 1000.0,\\, 0.0,\\, 0.7,\\, 0.5,\\, 5.0,\\, 500.0,\\, 300\\,)$\n- Case $\\;2$: $(\\,1.0,\\, 1000.0,\\, 100.0,\\, 0.2,\\, 0.9,\\, 10.0,\\, 600.0,\\, 500\\,)$\n- Case $\\;3$: $(\\,1.0,\\, 1000.0,\\, 0.0,\\, 0.5,\\, 1.4,\\, 100.0,\\, 600.0,\\, 300\\,)$\n- Case $\\;4$: $(\\,1.0,\\, 1000.0,\\, 0.0,\\, 0.5,\\, 0.98,\\, 1.0,\\, 400.0,\\, 500\\,)$\n\nFinal output format. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[x_1,x_2,x_3,x_4]$), where $x_i$ is the integer classification for case $i$ in the order given above. No other output is allowed.", "solution": "The problem statement has been evaluated and is deemed valid. It is scientifically grounded, well-posed, objective, and provides all necessary information to construct a formal solution. The model is based on established principles of population ecology and genetics. I will proceed with the derivation and implementation of the solution.\n\nThe problem requires the simulation of a coupled system of two discrete-time deterministic equations describing the evolution of population size, $N_t$, and the average inbreeding coefficient, $F_t$. The analysis aims to classify the long-term behavior of the population based on its sensitivity to initial population size, which reveals the potential for an extinction vortex.\n\nThe system is defined by the following set of recurrence relations:\n\n$1$. **Demographic Dynamics**: The change in census population size from generation $t$ to $t+1$ is governed by a model incorporating intrinsic growth, density-dependent regulation, inbreeding depression, and an Allee effect. The equation is:\n$$\nN_{t+1} = N_t \\exp\\left(r \\left(1 - \\frac{N_t}{K}\\right)\\right) \\exp(-B F_t) \\frac{N_t}{N_t + A}\n$$\nHere, $r$ is the intrinsic rate of natural increase, $K$ is the carrying capacity, $B$ is the inbreeding load parameter (measuring the fitness reduction per unit of inbreeding), and $A$ is the Allee effect parameter defining the critical population size threshold. The term $\\exp(r (1 - N_t/K))$ is the Ricker model of density regulation. The term $\\exp(-B F_t)$ represents the reduction in the population's mean fitness due to inbreeding. The term $N_t / (N_t + A)$ models a component II Allee effect, where per-capita growth rate increases with density at low population sizes.\n\n$2$. **Genetic Dynamics**: The inbreeding coefficient, $F_t$, which is the probability that two alleles at a locus are identical by descent, evolves according to the standard Wright-Fisher model for a randomly mating population of finite size:\n$$\nF_{t+1} = F_t + \\frac{1 - F_t}{2 N_{e,t}}\n$$\nThis equation shows that inbreeding increases in each generation at a rate inversely proportional to the effective population size, $N_{e,t}$. The rate of increase slows as $F_t$ approaches its maximum value of $1$.\n\n$3$. **Eco-Evolutionary Coupling**: The demographic and genetic processes are coupled. The effective population size, $N_{e,t}$, is assumed to be a fraction of the census size, $N_t$, modified by a floor value:\n$$\nN_{e,t} = \\max(\\alpha N_t, N_e^{\\min})\n$$\nwhere $\\alpha \\in (0, 1]$ is a scaling factor and $N_e^{\\min} = 1$ is a minimum effective size to ensure the genetic update equation remains biologically plausible even as $N_t \\to 0$. The inbreeding coefficient $F_t$ in turn affects the demographic update for $N_{t+1}$, creating a feedback loop. Small $N_t$ leads to small $N_{e,t}$, accelerating the rise of $F_t$, which leads to greater inbreeding depression, further reducing $N_{t+1}$. This positive feedback is the mechanism for the extinction vortex.\n\n**Simulation Algorithm and Classification**\n\nFor each given parameter set $(r, K, A, \\alpha, B, N_0^{\\mathrm{low}}, N_0^{\\mathrm{high}}, T)$, the following algorithm is executed.\n\nFirst, a simulation function is defined. This function takes a parameter set and an initial population size $N_0$ as input, with the initial inbreeding coefficient fixed at $F_0 = 0$. It iterates for a maximum of $T$ generations.\n\nThe simulation for a single trajectory proceeds as follows:\n- Initialize state variables $N \\leftarrow N_0$ and $F \\leftarrow F_0$.\n- For each discrete time step $t$ from $0$ to $T-1$:\n    - Check for extinction: If $N \\leq N_{\\mathrm{ext}}$ (where $N_{\\mathrm{ext}} = 10^{-3}$), the population is considered extinct. The simulation for this trajectory terminates, and the outcome is recorded as \"extinction\".\n    - If not extinct, calculate the effective population size for the current generation: $N_e \\leftarrow \\max(\\alpha N, 1.0)$.\n    - Calculate the state for the next generation, $(N_{\\mathrm{next}}, F_{\\mathrm{next}})$, using the current state $(N, F)$ and the model equations:\n        $$\n        N_{\\mathrm{next}} \\leftarrow N \\exp\\left(r \\left(1 - \\frac{N}{K}\\right)\\right) \\exp(-B F) \\frac{N}{N + A}\n        $$\n        $$\n        F_{\\mathrm{next}} \\leftarrow F + \\frac{1 - F}{2 N_e}\n        $$\n    - Update the state: $N \\leftarrow N_{\\mathrm{next}}$ and $F \\leftarrow F_{\\mathrm{next}}$.\n- After the loop completes (i.e., after $T$ updates), if the population has not already been declared extinct, a final check is made: if $N \\leq N_{\\mathrm{ext}}$, the population is considered extinct at generation $T$. Otherwise, it has persisted.\n\nThis simulation function is called twice for each parameter set: once with the low initial size, $N_0^{\\mathrm{low}}$, and once with the high initial size, $N_0^{\\mathrm{high}}$. Let the outcomes be `extinct_low` and `extinct_high`, respectively (where each is a boolean value).\n\nThe final classification for the parameter set is determined by these two outcomes based on the specified rules:\n- If `extinct_low` is true AND `extinct_high` is true, the classification is $0$.\n- If `extinct_low` is false AND `extinct_high` is false, the classification is $1$.\n- If one is true and the other is false, the classification is $2$. This indicates bistability, where the long-term fate of the population depends on its initial size, a characteristic signature of an extinction vortex.\n\nThe implementation will apply this logic to each of the four test cases provided and format the results as a list of integers.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef run_simulation(r, K, A, alpha, B, N0, T, Next_val, Ne_min, F0):\n    \"\"\"\n    Simulates the coupled demographic-genetic model for T generations.\n\n    This function evolves the population size N and inbreeding coefficient F\n    according to the provided discrete-time equations.\n\n    Args:\n        r (float): Intrinsic growth parameter.\n        K (float): Carrying capacity.\n        A (float): Allee-effect scale.\n        alpha (float): Scaling factor for effective population size.\n        B (float): Inbreeding load parameter.\n        N0 (float): Initial census population size.\n        T (int): Number of generations to simulate.\n        Next_val (float): Extinction threshold for population size.\n        Ne_min (float): Minimum effective population size.\n        F0 (float): Initial inbreeding coefficient.\n\n    Returns:\n        bool: True if the population goes extinct within T generations,\n              False otherwise.\n    \"\"\"\n    N = float(N0)\n    F = float(F0)\n\n    for _ in range(T):\n        # 1. Check for extinction at the beginning of the generation.\n        if N = Next_val:\n            return True\n\n        # 2. Calculate effective population size for the current generation.\n        Ne = max(alpha * N, Ne_min)\n\n        # 3. Calculate N and F for the next generation.\n        # The update for N_{t+1} depends on the state at time t (N_t, F_t).\n        N_next = N * np.exp(r * (1.0 - N / K)) * np.exp(-B * F) * (N / (N + A))\n        \n        # The update for F_{t+1} depends on F_t and N_{e,t} (which depends on N_t).\n        F_next = F + (1.0 - F) / (2.0 * Ne)\n\n        # 4. Update state variables.\n        N = N_next\n        F = F_next\n\n    # 5. Final check for extinction after T full generations.\n    if N = Next_val:\n        return True\n\n    return False\n\ndef solve():\n    \"\"\"\n    Main function to run simulations for all test cases and print results.\n    \"\"\"\n    # Test suite: (r, K, A, alpha, B, N0_low, N0_high, T)\n    test_cases = [\n        (1.0, 1000.0, 0.0, 0.7, 0.5, 5.0, 500.0, 300),\n        (1.0, 1000.0, 100.0, 0.2, 0.9, 10.0, 600.0, 500),\n        (1.0, 1000.0, 0.0, 0.5, 1.4, 100.0, 600.0, 300),\n        (1.0, 1000.0, 0.0, 0.5, 0.98, 1.0, 400.0, 500),\n    ]\n\n    # Model constants as defined in the problem\n    Next_val = 1e-3\n    Ne_min = 1.0\n    F0 = 0.0\n\n    results = []\n    for params in test_cases:\n        r, K, A, alpha, B, N0_low, N0_high, T = params\n        \n        # Run simulation for the low initial population size\n        extinct_low = run_simulation(r, K, A, alpha, B, N0_low, T, Next_val, Ne_min, F0)\n        \n        # Run simulation for the high initial population size\n        extinct_high = run_simulation(r, K, A, alpha, B, N0_high, T, Next_val, Ne_min, F0)\n        \n        # Classify the outcome based on the two trajectories\n        if extinct_low and extinct_high:\n            # Both trajectories go to extinction\n            classification = 0\n        elif not extinct_low and not extinct_high:\n            # Both trajectories persist\n            classification = 1\n        else:\n            # One persists, one goes extinct (bistability)\n            classification = 2\n            \n        results.append(classification)\n\n    # Format and print the final output exactly as specified.\n    print(f\"[{','.join(map(str, results))}]\")\n\n# Execute the solver.\nsolve()\n```", "id": "2494475"}]}