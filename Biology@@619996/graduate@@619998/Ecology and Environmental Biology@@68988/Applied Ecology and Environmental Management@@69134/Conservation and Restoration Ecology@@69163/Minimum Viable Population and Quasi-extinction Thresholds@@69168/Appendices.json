{"hands_on_practices": [{"introduction": "Population viability analysis often begins with understanding the sources of randomness that can drive a population to extinction. This first practice focuses on demographic stochasticity—the chance events of birth, death, and reproduction at the level of the individual—using the classic framework of a Galton-Watson branching process. You will derive the demographic variance from first principles, sharpening your skills with probability generating functions and revealing how individual-level variability scales up to determine fluctuations at the population level [@problem_id:2509935].", "problem": "A threatened population with non-overlapping generations is modeled as a Galton–Watson branching process to assess minimum viable population and quasi-extinction risk under demographic stochasticity. Demographic stochasticity is the random variation in individual birth and death outcomes among otherwise identical individuals that arises purely from chance and is especially influential when the population size is small. Let the population size at generation $t$ be $N_{t}$ and suppose that the number of offspring produced by each individual in generation $t$ is an independent and identically distributed nonnegative integer-valued random variable $X_{i,t}$ with common offspring distribution. The population updates according to\n$$\nN_{t+1} \\,=\\, \\sum_{i=1}^{N_{t}} X_{i,t}.\n$$\nAssume the offspring distribution is $\\text{Poisson}(\\lambda)$ with mean parameter $\\lambda \\gt 0$. Starting only from the fundamental definitions of the probability generating function $G(s) \\equiv \\mathbb{E}[s^{X}]$ for a nonnegative integer-valued random variable $X$, the definitions of mean and variance in terms of derivatives of $G(s)$ evaluated at $s=1$, and independence of individuals’ offspring numbers, derive the expression for the demographic variance in offspring number per parent, denoted $\\sigma_{d}^{2}$, which is the variance term that contributes to the conditional variance of population growth via $\\mathrm{Var}(N_{t+1}\\,|\\,N_{t}) \\,=\\, N_{t}\\,\\sigma_{d}^{2}$. Express your final answer as a function of $\\lambda$. No units are required. Provide your final answer as a single closed-form analytic expression.", "solution": "The problem presented is a valid and well-posed question in theoretical population ecology. It requires the derivation of the demographic variance for a population modeled by a Galton-Watson branching process with a Poisson offspring distribution. The derivation must proceed from first principles involving probability generating functions.\n\nThe population size in generation $t+1$ is given by the sum $N_{t+1} = \\sum_{i=1}^{N_t} X_{i,t}$, where $X_{i,t}$ represents the number of offspring produced by individual $i$ in generation $t$, and $N_t$ is the population size in generation $t$. The random variables $X_{i,t}$ are assumed to be independent and identically distributed (i.i.d.) following a Poisson distribution with mean parameter $\\lambda$. For notational simplicity, we denote the generic offspring random variable as $X$, so that $X \\sim \\text{Poisson}(\\lambda)$.\n\nThe quantity to be derived is the demographic variance, denoted $\\sigma_{d}^{2}$, which is defined through the conditional variance of the population size:\n$$\n\\mathrm{Var}(N_{t+1}\\,|\\,N_{t}) = N_{t}\\,\\sigma_{d}^{2}\n$$\nTo find $\\sigma_{d}^{2}$, we must first compute $\\mathrm{Var}(N_{t+1}\\,|\\,N_{t})$ from its fundamental definition. Conditional on the population size $N_{t}$ being a fixed integer value, say $n$, the next generation's size is the sum of $n$ i.i.d. random variables: $N_{t+1} = \\sum_{i=1}^{n} X_i$. Because the random variables $X_i$ are independent, the variance of their sum is the sum of their variances:\n$$\n\\mathrm{Var}\\left(\\sum_{i=1}^{n} X_i\\right) = \\sum_{i=1}^{n} \\mathrm{Var}(X_i)\n$$\nSince the offspring distributions are identical, $\\mathrm{Var}(X_i) = \\mathrm{Var}(X)$ for all $i$. Therefore, for a fixed $N_t = n$, we have:\n$$\n\\mathrm{Var}\\left(\\sum_{i=1}^{n} X_i\\right) = n \\cdot \\mathrm{Var}(X)\n$$\nThis relationship holds for any given value $n$ that the random variable $N_t$ can take. Thus, we can express the conditional variance as a function of the random variable $N_t$ itself:\n$$\n\\mathrm{Var}(N_{t+1}\\,|\\,N_{t}) = N_t \\cdot \\mathrm{Var}(X)\n$$\nBy comparing this derived expression with the one provided in the problem statement, $\\mathrm{Var}(N_{t+1}\\,|\\,N_{t}) = N_{t}\\,\\sigma_{d}^{2}$, we immediately deduce that the demographic variance is equal to the variance of the individual offspring distribution:\n$$\n\\sigma_{d}^{2} = \\mathrm{Var}(X)\n$$\nThe problem is now reduced to calculating the variance of a Poisson-distributed random variable, $X \\sim \\text{Poisson}(\\lambda)$, using the specified method of probability generating functions (PGF).\n\nThe probability mass function (PMF) for a Poisson random variable $X$ with mean $\\lambda$ is given by:\n$$\n\\mathbb{P}(X=k) = \\frac{\\lambda^k \\exp(-\\lambda)}{k!}, \\quad \\text{for } k \\in \\{0, 1, 2, \\dots\\}\n$$\nThe PGF, $G(s)$, is defined as $G(s) \\equiv \\mathbb{E}[s^{X}]$. We compute this for the Poisson distribution:\n$$\nG(s) = \\sum_{k=0}^{\\infty} s^k \\mathbb{P}(X=k) = \\sum_{k=0}^{\\infty} s^k \\frac{\\lambda^k \\exp(-\\lambda)}{k!}\n$$\nWe can factor out the term $\\exp(-\\lambda)$, which does not depend on the summation index $k$:\n$$\nG(s) = \\exp(-\\lambda) \\sum_{k=0}^{\\infty} \\frac{(s\\lambda)^k}{k!}\n$$\nThe summation is the Maclaurin series for the exponential function, $\\sum_{k=0}^{\\infty} \\frac{z^k}{k!} = \\exp(z)$. Letting $z = s\\lambda$, we obtain the closed-form expression for the PGF:\n$$\nG(s) = \\exp(-\\lambda) \\exp(s\\lambda) = \\exp(\\lambda(s-1))\n$$\nThe problem specifies that the mean and variance are to be found using the derivatives of the PGF evaluated at $s=1$. The formulae are:\n$$\n\\mathbb{E}[X] = G'(1)\n$$\n$$\n\\mathrm{Var}(X) = G''(1) + G'(1) - (G'(1))^2\n$$\nWe compute the first and second derivatives of $G(s)$ with respect to $s$:\nFirst derivative:\n$$\nG'(s) = \\frac{d}{ds} \\exp(\\lambda(s-1)) = \\lambda \\exp(\\lambda(s-1))\n$$\nSecond derivative:\n$$\nG''(s) = \\frac{d}{ds} \\left( \\lambda \\exp(\\lambda(s-1)) \\right) = \\lambda^2 \\exp(\\lambda(s-1))\n$$\nNow, we evaluate these derivatives at $s=1$:\n$$\nG'(1) = \\lambda \\exp(\\lambda(1-1)) = \\lambda \\exp(0) = \\lambda\n$$\n$$\nG''(1) = \\lambda^2 \\exp(\\lambda(1-1)) = \\lambda^2 \\exp(0) = \\lambda^2\n$$\nThe value $G'(1)=\\lambda$ confirms that the mean of the distribution is indeed $\\lambda$. We substitute these results into the formula for the variance:\n$$\n\\mathrm{Var}(X) = G''(1) + G'(1) - (G'(1))^2 = \\lambda^2 + \\lambda - (\\lambda)^2 = \\lambda\n$$\nThus, the variance of the Poisson offspring distribution is $\\lambda$. Since we established that $\\sigma_{d}^{2} = \\mathrm{Var}(X)$, we conclude that the demographic variance is:\n$$\n\\sigma_{d}^{2} = \\lambda\n$$\nThis result is an elementary but important property of branching processes where reproduction is modeled as a Poisson process. It signifies that the variance in offspring number per parent is equal to the mean number of offspring per parent.", "answer": "$$\\boxed{\\lambda}$$", "id": "2509935"}, {"introduction": "While demographic stochasticity is key for small populations, environmental stochasticity, which affects all individuals in a population simultaneously, often becomes the dominant driver of extinction risk as population size increases. This exercise challenges you to model population dynamics under environmental fluctuations using a stochastic differential equation (SDE), a cornerstone of modern quantitative ecology [@problem_id:2509921]. By applying Itô's lemma and first-passage time theory, you will derive a closed-form expression for the probability of a population hitting a quasi-extinction threshold, a fundamental calculation in population viability analysis.", "problem": "A closed population with negligible demographic stochasticity at moderate sizes is subject to environmental stochasticity that perturbs its exponential growth rate. Let $N_t$ denote the population size at time $t$, and assume that on ecological timescales it is well described by the Itô Stochastic Differential Equation (SDE)\n$dN_t = r\\,N_t\\,dt + \\sigma\\,N_t\\,dW_t$,\nwhere $r \\in \\mathbb{R}$ is the mean per-capita growth rate, $\\sigma  0$ is the intensity of environmental noise, and $W_t$ is a standard Brownian motion. Let $N_q \\in (0,\\infty)$ denote a quasi-extinction threshold used in Minimum Viable Population (MVP) analyses, and suppose the initial size satisfies $N_0  N_q$. Define the logarithmic state variable $X_t = \\ln N_t$ and the corresponding absorbing lower boundary $a = \\ln N_q$. Let the first-passage time to quasi-extinction be $T = \\inf\\{ t \\ge 0 : X_t \\le a \\}$. \n\nStarting from the SDE for $N_t$ and using only foundational tools from stochastic calculus (e.g., Itô’s lemma for $\\ln N_t$) and classical properties of Brownian motion (e.g., the reflection principle for barrier crossing of a drifted Brownian motion), derive the diffusion approximation of the model in log space and obtain a closed-form expression for the quasi-extinction probability $\\mathbb{P}(T \\le \\tau)$ by a fixed time $\\tau  0$. Express your final answer as a single analytic expression in terms of $x_0 = \\ln N_0$, $a = \\ln N_q$, $\\mu = r - \\sigma^2/2$, $\\sigma$, $\\tau$, and the standard normal cumulative distribution function $\\Phi$. \n\nYour final answer must be a single closed-form expression. Do not provide an inequality or an equation to be solved. Do not include units. Do not round or approximate; give the exact symbolic expression in terms of $\\Phi$.", "solution": "The problem as stated is scientifically grounded, well-posed, and objective. It is a classical problem in mathematical ecology and finance, based on the established theory of stochastic differential equations. All necessary information is provided, and the problem is free of contradictions or ambiguities. Thus, the problem is valid, and we may proceed to a solution.\n\nThe population dynamics are described by the stochastic differential equation (SDE) for geometric Brownian motion:\n$$ dN_t = r\\,N_t\\,dt + \\sigma\\,N_t\\,dW_t $$\nwhere $N_t$ is the population size at time $t$, $r$ is the mean per-capita growth rate, $\\sigma$ is the environmental noise intensity, and $W_t$ is a standard Brownian motion.\n\nWe are interested in the dynamics of the logarithm of the population size, $X_t = \\ln N_t$. To find the SDE for $X_t$, we apply Itô's lemma to the function $f(N_t) = \\ln N_t$. The necessary derivatives are:\n$$ \\frac{\\partial f}{\\partial N_t} = \\frac{1}{N_t}, \\quad \\frac{\\partial^2 f}{\\partial N_t^2} = -\\frac{1}{N_t^2} $$\nAccording to Itô's lemma, the differential $dX_t$ is given by:\n$$ dX_t = \\left( r\\,N_t \\cdot \\frac{\\partial f}{\\partial N_t} + \\frac{1}{2}(\\sigma\\,N_t)^2 \\cdot \\frac{\\partial^2 f}{\\partial N_t^2} \\right) dt + \\left( \\sigma\\,N_t \\cdot \\frac{\\partial f}{\\partial N_t} \\right) dW_t $$\nSubstituting the derivatives, we obtain:\n$$ dX_t = \\left( r\\,N_t \\cdot \\frac{1}{N_t} + \\frac{1}{2}\\sigma^2 N_t^2 \\cdot \\left(-\\frac{1}{N_t^2}\\right) \\right) dt + \\left( \\sigma\\,N_t \\cdot \\frac{1}{N_t} \\right) dW_t $$\n$$ dX_t = \\left(r - \\frac{\\sigma^2}{2}\\right) dt + \\sigma\\,dW_t $$\nThe problem defines $\\mu = r - \\sigma^2/2$, which is the long-term stochastic growth rate. With this definition, the SDE for the log-population size becomes:\n$$ dX_t = \\mu\\,dt + \\sigma\\,dW_t $$\nThis equation describes an arithmetic (or drifted) Brownian motion. The solution to this SDE with initial condition $X_0 = x_0$ is:\n$$ X_t = x_0 + \\mu t + \\sigma W_t $$\nThe problem is to find the quasi-extinction probability, which is the probability that the population drops to or below the threshold $N_q$ by time $\\tau$. In terms of the log-population size, this is the probability that $X_t$ reaches or crosses the absorbing barrier $a = \\ln N_q$ by time $\\tau$. This is a first-passage time problem. We seek to calculate $\\mathbb{P}(T \\le \\tau)$, where $T = \\inf\\{ t \\ge 0 : X_t \\le a \\}$. The initial state is $x_0  a$.\n\nThe event $\\{T \\le \\tau\\}$ is equivalent to the event $\\{\\min_{0 \\le t \\le \\tau} X_t \\le a\\}$. To solve this, we can transform the problem into a canonical form. Consider the process $Y_t = -(X_t - x_0) = -\\mu t - \\sigma W_t$. This process starts at $Y_0 = 0$. The condition $X_t \\le a$ is equivalent to $x_0 - Y_t \\le a$, which simplifies to $Y_t \\ge x_0 - a$.\nTherefore, the event of hitting the lower barrier $a$ for process $X_t$ is equivalent to the event of hitting an upper barrier for process $Y_t$:\n$$ \\min_{0 \\le t \\le \\tau} X_t \\le a \\iff \\max_{0 \\le t \\le \\tau} Y_t \\ge x_0 - a $$\nLet $b = x_0 - a$. Since $x_0  a$, we have $b  0$. The process $Y_t$ can be written as $Y_t = (-\\mu)t + \\sigma(-W_t)$. Since $-W_t$ is also a standard Brownian motion, $Y_t$ is a drifted Brownian motion with drift $-\\mu$ and volatility parameter $\\sigma$. The problem reduces to finding $\\mathbb{P}(\\max_{0 \\le t \\le \\tau} Y_t \\ge b)$.\n\nThis is a classic result for drifted Brownian motion, derivable from the reflection principle. For a process $Z_t = \\nu t + \\sigma W_t$ starting at $Z_0=0$, the probability of hitting an upper barrier $k0$ by time $\\tau$ is given by:\n$$ \\mathbb{P}(\\max_{0 \\le t \\le \\tau} Z_t \\ge k) = \\mathbb{P}\\left(\\max_{0 \\le t \\le \\tau} \\left(\\frac{\\nu}{\\sigma}t + W_t\\right) \\ge \\frac{k}{\\sigma}\\right) $$\nThe formula for a process $S_t = \\nu' t + W_t$ (with unit volatility) hitting a barrier $k'$ is:\n$$ \\mathbb{P}(\\max_{0 \\le t \\le \\tau} S_t \\ge k') = \\Phi\\left(\\frac{\\nu'\\tau - k'}{\\sqrt{\\tau}}\\right) + \\exp(2\\nu'k') \\Phi\\left(\\frac{-\\nu'\\tau - k'}{\\sqrt{\\tau}}\\right) $$\nIn our case, the process is $Y_t$, so the corresponding drift is $\\nu = -\\mu$. The process to analyze in the standard form is $S_t = Y_t/\\sigma$. Its drift is $\\nu' = -\\mu/\\sigma$ and the barrier is $k' = b/\\sigma = (x_0-a)/\\sigma$.\n\nSubstituting $\\nu' = -\\mu/\\sigma$ and $k' = (x_0-a)/\\sigma$ into the standard formula:\n$$ \\mathbb{P}(T \\le \\tau) = \\Phi\\left(\\frac{(-\\mu/\\sigma)\\tau - (x_0-a)/\\sigma}{\\sqrt{\\tau}}\\right) + \\exp\\left(2\\left(-\\frac{\\mu}{\\sigma}\\right)\\left(\\frac{x_0-a}{\\sigma}\\right)\\right) \\Phi\\left(\\frac{-((-\\mu/\\sigma)\\tau) - (x_0-a)/\\sigma}{\\sqrt{\\tau}}\\right) $$\nWe simplify each term. The argument of the first $\\Phi$ function is:\n$$ \\frac{-\\mu\\tau - (x_0-a)}{\\sigma\\sqrt{\\tau}} = \\frac{a - x_0 - \\mu\\tau}{\\sigma\\sqrt{\\tau}} $$\nThe term in the exponential is:\n$$ \\frac{-2\\mu(x_0-a)}{\\sigma^2} = \\frac{2\\mu(a-x_0)}{\\sigma^2} $$\nThe argument of the second $\\Phi$ function is:\n$$ \\frac{\\mu\\tau - (x_0-a)}{\\sigma\\sqrt{\\tau}} = \\frac{a-x_0+\\mu\\tau}{\\sigma\\sqrt{\\tau}} $$\nCombining these simplified terms gives the final expression for the quasi-extinction probability:\n$$ \\mathbb{P}(T \\le \\tau) = \\Phi\\left(\\frac{a - x_0 - \\mu\\tau}{\\sigma\\sqrt{\\tau}}\\right) + \\exp\\left(\\frac{2\\mu(a - x_0)}{\\sigma^2}\\right) \\Phi\\left(\\frac{a - x_0 + \\mu\\tau}{\\sigma\\sqrt{\\tau}}\\right) $$\nThis expression gives the cumulative distribution function of the first-passage time to the quasi-extinction boundary.", "answer": "$$ \\boxed{\\Phi\\left(\\frac{a - x_0 - \\mu\\tau}{\\sigma\\sqrt{\\tau}}\\right) + \\exp\\left(\\frac{2\\mu(a - x_0)}{\\sigma^2}\\right) \\Phi\\left(\\frac{a - x_0 + \\mu\\tau}{\\sigma\\sqrt{\\tau}}\\right)} $$", "id": "2509921"}, {"introduction": "Theoretical derivations are powerful, but conservation decisions often require numerical solutions tailored to specific scenarios. This final practice brings together theory and computation by focusing on the continuous-time birth-death process, a fundamental model of demographic stochasticity [@problem_id:2509956]. You will translate the principles of Markov branching processes into a working algorithm to compute the minimum viable population size required to meet a specific conservation objective, a task central to applied conservation management.", "problem": "Consider a continuous-time linear birth–death branching process describing the abundance of a closed population. Each individual gives birth independently at a per capita rate $b$ (per year) and dies independently at a per capita rate $d$ (per year). The state $N(t)$ is the number of individuals at time $t$ (in years), with $N(0)=N_0 \\in \\mathbb{N}$ and absorbing state $0$. A conservation manager defines a risk tolerance criterion: choose the smallest initial abundance $N_0$ (the minimum viable population under this criterion) such that the probability of extinction by time $\\tau$ does not exceed a tolerance level $\\alpha$, that is, the smallest $N_0 \\in \\mathbb{N}$ satisfying\n$$\n\\mathbb{P}\\big(N(\\tau)=0 \\,\\big|\\, N(0)=N_0\\big) \\le \\alpha.\n$$\nUsing only the fundamental properties of continuous-time Markov branching processes, namely: independent lineages, the absorbing nature of state $0$, and the law of total probability over infinitesimal time increments, derive a principled numerical method to compute the minimal $N_0$ that satisfies the inequality for given parameters $(b,d,\\tau,\\alpha)$ with $b \\ge 0$, $d \\ge 0$, $\\tau \\ge 0$ (in years), and $\\alpha \\in (0,1)$. Your approach must be robust in the regimes $bd$ (supercritical), $b=d$ (critical), and $bd$ (subcritical), and must transparently handle the boundary case $\\tau=0$.\n\nImplementation requirements:\n- Your program must hard-code a test suite of parameter quadruples $(b,d,\\tau,\\alpha)$ and, for each, compute the minimal integer $N_0$ that satisfies $\\mathbb{P}(N(\\tau)=0 \\mid N(0)=N_0) \\le \\alpha$.\n- Time must be treated in years, and rates in per-year units; the output $N_0$ is an integer count and must be reported as a unitless integer.\n- The test suite to cover different regimes and edge cases is:\n  - Case $1$ (supercritical, moderate horizon): $(b,d,\\tau,\\alpha) = (0.5, 0.4, 10.0, 0.05)$.\n  - Case $2$ (critical, long horizon): $(b,d,\\tau,\\alpha) = (0.2, 0.2, 20.0, 0.1)$.\n  - Case $3$ (subcritical, moderate horizon): $(b,d,\\tau,\\alpha) = (0.3, 0.6, 5.0, 0.2)$.\n  - Case $4$ (boundary in time): $(b,d,\\tau,\\alpha) = (0.5, 0.4, 0.0, 0.01)$.\n  - Case $5$ (supercritical, very stringent risk): $(b,d,\\tau,\\alpha) = (0.55, 0.5, 50.0, 0.000001)$.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, for example, $[n_1,n_2,n_3,n_4,n_5]$, where each $n_i$ is the computed minimal integer $N_0$ for the corresponding case in the order listed above.\n\nConstraints on the method:\n- You must rely on first principles of branching processes to obtain a computable extinction-by-time-$\\tau$ probability starting from a single ancestor, then extend to $N_0$ ancestors using independence of lineages, and finally compute the minimal integer $N_0$ that satisfies the inequality.\n- Do not assume or quote a final formula for the extinction probability in the problem statement; instead, base your method on the small-time decomposition of events and the independence of lineages to construct the computation.\n- The final output must be deterministic and contain only the integer results in the specified list format.", "solution": "The problem presented is a well-posed and scientifically grounded question in mathematical ecology. It requires the determination of a minimum viable population size, $N_0$, under a probabilistic risk criterion. The model is a continuous-time linear birth-death process, a fundamental construct in the theory of stochastic processes. The problem is valid as it is self-contained, factually sound, and permits a unique and meaningful solution derived from first principles.\n\nThe solution will be developed in three stages. First, we will derive the probability of extinction by time $\\tau$ for a lineage starting with a single individual, denoted as $p(\\tau)$. This derivation will be based on an analysis of events over an infinitesimal time interval, leading to a differential equation for $p(\\tau)$. Second, leveraging the principle of independent lineages, we will extend this result to a starting population of $N_0$ individuals. Third, we will solve the resulting inequality for the minimal integer $N_0$ that satisfies the conservation manager's risk tolerance.\n\n**1. Derivation of Single-Ancestor Extinction Probability, $p(\\tau)$**\n\nLet $p(t) = \\mathbb{P}(N(t)=0 \\mid N(0)=1)$ be the probability that a population starting with a single individual goes extinct by time $t$. We derive a differential equation for $p(t)$ using the law of total probability, conditioning on the first event in an infinitesimal time interval $[0, dt)$. The process starting with one individual at time $t=0$ can evolve in one of three mutually exclusive ways as $dt \\to 0$:\n\n1.  A death occurs with probability $d \\cdot dt + o(dt)$. The population becomes $0$. Since $0$ is an absorbing state, extinction is assured. The probability of the lineage being extinct by time $t$ is $1$.\n2.  A birth occurs with probability $b \\cdot dt + o(dt)$. The population becomes $2$. By the Markov property and the independence of offspring, the original lineage goes extinct by time $t$ if and only if the two new, independent lineages both go extinct in the remaining time, $t-dt$. The probability of this is $[p(t-dt)]^2$.\n3.  Neither a birth nor a death occurs, with probability $1 - (b+d)dt + o(dt)$. The population remains $1$. The lineage goes extinct by time $t$ if the process, starting from this point, goes extinct in the remaining time $t-dt$. The probability is $p(t-dt)$.\n\nSumming these contributions, we have:\n$$\np(t) = d \\cdot dt \\cdot 1 + b \\cdot dt \\cdot [p(t-dt)]^2 + [1 - (b+d)dt] \\cdot p(t-dt) + o(dt)\n$$\nWe use the Taylor expansion $p(t-dt) = p(t) - \\frac{dp}{dt}dt + O(dt^2)$. Substituting this into the equation:\n$$\np(t) = d \\cdot dt + b \\cdot dt \\cdot [p(t)]^2 + \\left( p(t) - \\frac{dp}{dt}dt \\right) - (b+d)dt \\cdot p(t) + O(dt^2)\n$$\nSimplifying and collecting terms of order $dt$:\n$$\n0 = d \\cdot dt + b \\cdot [p(t)]^2 \\cdot dt - \\frac{dp}{dt}dt - (b+d)p(t) \\cdot dt + O(dt^2)\n$$\nDividing by $dt$ and taking the limit as $dt \\to 0$, we obtain the backward Kolmogorov differential equation for $p(t)$:\n$$\n\\frac{dp}{dt} = b p(t)^2 - (b+d)p(t) + d\n$$\nThe right-hand side is a quadratic in $p(t)$ which can be factored:\n$$\n\\frac{dp}{dt} = (bp(t) - d)(p(t) - 1)\n$$\nThe initial condition is that at time $t=0$, the population is $N(0)=1$, so it cannot be extinct. Thus, $p(0) = 0$. We solve this differential equation by separation of variables, integrating from $t=0$ to $t=\\tau$.\n\n**Case I: $b \\neq d$ (Supercritical or Subcritical)**\n\n$$\n\\int_{p(0)}^{p(\\tau)} \\frac{dp}{(bp-d)(p-1)} = \\int_0^\\tau dt\n$$\nUsing partial fraction decomposition, $\\frac{1}{(bp-d)(p-1)} = \\frac{1}{b-d}\\left(\\frac{1}{p-1} - \\frac{b}{bp-d}\\right)$.\n$$\n\\frac{1}{b-d} \\left[ \\ln|p-1| - \\ln|bp-d| \\right]_{0}^{p(\\tau)} = \\tau\n$$\n$$\n\\frac{1}{b-d} \\left[ \\ln\\left|\\frac{p-1}{bp-d}\\right| \\right]_{0}^{p(\\tau)} = \\tau\n$$\nSubstituting the limits $p(0)=0$ and $p(\\tau)$:\n$$\n\\ln\\left|\\frac{p(\\tau)-1}{bp(\\tau)-d}\\right| - \\ln\\left|\\frac{-1}{-d}\\right| = (b-d)\\tau\n$$\nSince $p(\\tau) \\in [0,1)$, we have $p(\\tau)-1  0$. Also, $bp(\\tau)-d$ is negative for typical parameter regimes, so the ratio inside the logarithm is positive. We can write $\\ln\\left(\\frac{1-p(\\tau)}{d-bp(\\tau)}\\right) - \\ln\\left(\\frac{1}{d}\\right) = (b-d)\\tau$.\n$$\n\\ln\\left(\\frac{d(1-p(\\tau))}{d-bp(\\tau)}\\right) = (b-d)\\tau\n$$\nExponentiating and solving for $p(\\tau)$ yields:\n$$\np(\\tau) = \\frac{d(e^{(b-d)\\tau} - 1)}{b e^{(b-d)\\tau} - d}\n$$\n\n**Case II: $b = d$ (Critical)**\n\nThe differential equation simplifies to $\\frac{dp}{dt} = b(p-1)^2$.\n$$\n\\int_{p(0)}^{p(\\tau)} \\frac{dp}{(p-1)^2} = \\int_0^\\tau b dt\n$$\n$$\n\\left[ -\\frac{1}{p-1} \\right]_{0}^{p(\\tau)} = b\\tau\n$$\n$$\n-\\frac{1}{p(\\tau)-1} - \\left(-\\frac{1}{0-1}\\right) = b\\tau \\implies \\frac{1}{1-p(\\tau)} - 1 = b\\tau\n$$\nSolving for $p(\\tau)$ yields:\n$$\np(\\tau) = \\frac{b\\tau}{1+b\\tau}\n$$\n\n**2. Extension to $N_0$ Individuals**\n\nA foundational principle of branching processes is the independence of lineages. A population starting with $N_0$ individuals goes extinct by time $\\tau$ if and only if all $N_0$ independent lineages, each initiated by one of the original individuals, go extinct by time $\\tau$. Therefore, the probability of extinction for the entire population is:\n$$\n\\mathbb{P}(N(\\tau)=0 \\mid N(0)=N_0) = \\left[p(\\tau)\\right]^{N_0}\n$$\nThe manager's criterion is to find the smallest integer $N_0$ such that:\n$$\n[p(\\tau)]^{N_0} \\le \\alpha\n$$\n\n**3. Computation of the Minimum Viable Population $N_0$**\n\nTo find the minimal integer $N_0$, we analyze the inequality.\nIf $\\tau=0$, then $p(0)=0$. The inequality becomes $0^{N_0} \\le \\alpha$, which is true for any $N_0 \\ge 1$ since $\\alpha \\in(0,1)$. The smallest such integer is $N_0=1$.\n\nIf $\\tau0$, then $p(\\tau) \\in (0,1)$. We can take the natural logarithm of both sides. Since $\\ln(p(\\tau))$ is negative, the inequality sign is reversed upon division:\n$$\nN_0 \\ln(p(\\tau)) \\le \\ln(\\alpha) \\implies N_0 \\ge \\frac{\\ln(\\alpha)}{\\ln(p(\\tau))}\n$$\nThe smallest integer $N_0$ satisfying this condition is found using the ceiling function:\n$$\nN_0 = \\left\\lceil \\frac{\\ln(\\alpha)}{\\ln(p(\\tau))} \\right\\rceil\n$$\nFor numerical implementation, particularly when $b$ is close to $d$, the formula for $p(\\tau)$ in the $b \\neq d$ case can be susceptible to floating-point error. It is better to use the mathematically equivalent and numerically more stable form involving $\\text{expm1}(x) = e^x - 1$: let $x=(b-d)\\tau$, then\n$$\np(\\tau) = \\frac{d \\cdot \\text{expm1}(x)}{b \\cdot \\text{expm1}(x) + (b - d)}\n$$\nThis avoids the catastrophic cancellation that can occur when calculating $e^x-1$ for small $x$.\n\nThe final algorithm is as follows:\n1.  For each parameter set $(b,d,\\tau,\\alpha)$, first check if $\\tau=0$. If so, $N_0=1$.\n2.  Otherwise, calculate $p(\\tau)$ using the appropriate formula for the critical ($b=d$) or non-critical ($b \\neq d$) case, employing the numerically robust expression.\n3.  Compute the minimum required $N_0$ using the ceiling formula $N_0 = \\lceil \\ln(\\alpha) / \\ln(p(\\tau)) \\rceil$. The result must be an integer.\nThis principled procedure provides a deterministic and scientifically sound method for computing the required minimum viable population sizes for the given test suite.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef compute_n0(b: float, d: float, tau: float, alpha: float) - int:\n    \"\"\"\n    Computes the minimum viable population N0 based on a continuous-time\n    birth-death process model.\n\n    Args:\n        b: Per capita birth rate (per year).\n        d: Per capita death rate (per year).\n        tau: Time horizon (years).\n        alpha: Maximum acceptable extinction probability.\n\n    Returns:\n        The smallest integer N0 satisfying the risk criterion.\n    \"\"\"\n    # Per the derivation, if the time horizon is zero, the population cannot be extinct\n    # unless it started at zero. For N(0) = N_0 = 1, the probability of extinction\n    # at t=0 is exactly 0. The inequality 0 = alpha holds for any N_0 = 1.\n    # The smallest such integer is 1.\n    if tau == 0.0:\n        return 1\n\n    # Calculate p(tau), the extinction probability for a single lineage by time tau.\n    # The derivation from first principles yields two cases.\n    if b == d:\n        # Critical case: p(tau) = b*tau / (1 + b*tau)\n        # If b=d=0, the population size is constant, so p(tau)=0.\n        if b == 0.0:\n            p_tau = 0.0\n        else:\n            p_tau = (b * tau) / (1.0 + b * tau)\n    else:\n        # Non-critical case (supercritical bd or subcritical bd).\n        # We use a numerically stable formula derived in the solution text.\n        # p(tau) = d*(e^((b-d)tau) - 1) / (b*e^((b-d)tau) - d)\n        # Let x = (b-d)*tau. The formula becomes d*(exp(x)-1) / (b*exp(x)-d).\n        # To avoid catastrophic cancellation when x is close to 0, we use expm1(x).\n        # Numerator: d * expm1(x)\n        # Denominator: b*exp(x) - d = b*(exp(x)-1) + b - d = b*expm1(x) + (b-d)\n        x = (b - d) * tau\n        numerator = d * np.expm1(x)\n        denominator = b * np.expm1(x) + (b - d)\n        \n        # If d=0 (pure birth), p_tau=0. The numerator is 0.\n        # If the denominator is zero, this would imply a singularity, but the\n        # function is well-behaved. This case is not expected for valid parameters.\n        if denominator == 0:\n            # For b=0,d0 (pure death), p_tau = 1-exp(-d*tau).\n            # The general formula's denominator is -d, so it works.\n            # This logic path is for extreme edge cases not in the test suite.\n            p_tau = 0.0 if d == 0.0 else 1.0\n        else:\n            p_tau = numerator / denominator\n\n    # The probability of extinction for N0 lineages is (p_tau)^N0.\n    # We need to find the smallest integer N0 such that (p_tau)^N0 = alpha.\n\n    # If extinction from one ancestor is impossible (p_tau=0), one individual is enough.\n    # This happens if d=0 and b0.\n    if p_tau == 0.0:\n        return 1\n\n    # For p_tau  0, we solve by taking logarithms.\n    # N0 * log(p_tau) = log(alpha)\n    # Since 0  p_tau  1 (for finite tau), log(p_tau) is negative.\n    # Dividing by log(p_tau) reverses the inequality:\n    # N0 = log(alpha) / log(p_tau)\n    # The smallest integer N0 is the ceiling of this expression.\n    n0_float = np.log(alpha) / np.log(p_tau)\n    n0 = int(np.ceil(n0_float))\n    \n    return n0\n\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print the results.\n    \"\"\"\n    # The test suite of parameter quadruples (b, d, tau, alpha).\n    test_cases = [\n        # Case 1 (supercritical, moderate horizon)\n        (0.5, 0.4, 10.0, 0.05),\n        # Case 2 (critical, long horizon)\n        (0.2, 0.2, 20.0, 0.1),\n        # Case 3 (subcritical, moderate horizon)\n        (0.3, 0.6, 5.0, 0.2),\n        # Case 4 (boundary in time)\n        (0.5, 0.4, 0.0, 0.01),\n        # Case 5 (supercritical, very stringent risk)\n        (0.55, 0.5, 50.0, 0.000001),\n    ]\n\n    results = []\n    for case in test_cases:\n        b, d, tau, alpha = case\n        result = compute_n0(b, d, tau, alpha)\n        results.append(result)\n\n    # The final print statement must match the required format exactly.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2509956"}]}