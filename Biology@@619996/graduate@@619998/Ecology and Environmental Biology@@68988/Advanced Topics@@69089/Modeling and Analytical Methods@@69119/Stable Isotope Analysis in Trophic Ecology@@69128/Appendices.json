{"hands_on_practices": [{"introduction": "A cornerstone of food web analysis is the accurate estimation of an organism's trophic position. A primary challenge, however, is establishing a relevant isotopic baseline, especially for consumers that integrate energy from multiple basal sources. This practice guides you through the foundational method of using a \"tracer\" isotope (here, $\\delta^{13}\\text{C}$) to determine the proportional contribution of different energy pathways to a consumer's diet, and then using this proportion to construct a precise, consumer-specific baseline for the \"position\" isotope ($\\delta^{15}\\text{N}$) to calculate its trophic position [@problem_id:2535236].", "problem": "A demersal fish integrates carbon and nitrogen from multiple prey and ultimately from two basal energy channels (littoral versus pelagic). You are provided with empirically measured isotopic compositions and elemental concentrations for the fish’s potential prey, as well as isotopic baselines representing the littoral and pelagic energy channels. Assume isotopic compositions are reported in per mil relative difference notation, so that for any element with heavy-to-light isotope ratio $R$ and reference ratio $R_{\\mathrm{ref}}$, the delta value is $\\delta = \\left(\\frac{R}{R_{\\mathrm{ref}}} - 1\\right)\\times 10^{3}$.\n\nData:\n- Fish muscle tissue: $\\delta^{13}\\text{C}_{\\mathrm{cons}} = -18.7260$ ‰, $\\delta^{15}\\text{N}_{\\mathrm{cons}} = 11.8815$ ‰.\n- Immediate consumer–diet trophic discrimination factors (TDF; consumer minus diet): $\\Delta^{13}\\text{C} = 1.0$ ‰, $\\Delta^{15}\\text{N} = 3.4$ ‰.\n- Three prey items $i \\in \\{1,2,3\\}$ with elemental concentrations and isotopic values:\n  - Prey $1$: carbon concentration $c_{1} = 40$, nitrogen concentration $n_{1} = 10$, $\\delta^{13}\\text{C}_{1} = -18.0$ ‰, $\\delta^{15}\\text{N}_{1} = 8.0$ ‰.\n  - Prey $2$: $c_{2} = 35$, $n_{2} = 14$, $\\delta^{13}\\text{C}_{2} = -20.0$ ‰, $\\delta^{15}\\text{N}_{2} = 10.0$ ‰.\n  - Prey $3$: $c_{3} = 30$, $n_{3} = 8$, $\\delta^{13}\\text{C}_{3} = -25.0$ ‰, $\\delta^{15}\\text{N}_{3} = 6.0$ ‰.\n- Littoral baseline primary consumer: $\\delta^{13}\\text{C}_{\\mathrm{LPC}} = -16.0$ ‰, $\\delta^{15}\\text{N}_{\\mathrm{LPC}} = 6.5$ ‰.\n- Pelagic baseline primary consumer: $\\delta^{13}\\text{C}_{\\mathrm{PPC}} = -26.0$ ‰, $\\delta^{15}\\text{N}_{\\mathrm{PPC}} = 5.5$ ‰.\n- Baseline trophic level $\\lambda = 2$ (primary consumers), and stepwise nitrogen enrichment per trophic step $\\Delta_{\\text{N}} = 3.4$ ‰.\n\nAssumptions:\n- The fish’s assimilated diet isotopic values are obtained by subtracting the consumer–diet TDF from the fish tissue values.\n- At the diet level, concentration-dependent linear mass balance applies: the assimilated diet $\\delta^{13}\\text{C}$ equals the carbon-mass-weighted average of prey $\\delta^{13}\\text{C}$ values, and the assimilated diet $\\delta^{15}\\text{N}$ equals the nitrogen-mass-weighted average of prey $\\delta^{15}\\text{N}$ values. Let $f_{i}$ denote the dietary mass fraction of prey $i$, with $\\sum_{i=1}^{3} f_{i} = 1$ and $f_{i} \\ge 0$.\n- The littoral contribution to the basal energy supporting the fish is estimated by a two-source mixing between the littoral and pelagic baselines using the fish’s diet $\\delta^{13}\\text{C}$ value. The corresponding baseline $\\delta^{15}\\text{N}$ for the fish is the linear mixture (by the same littoral fraction) of the two baseline $\\delta^{15}\\text{N}$ values.\n\nTask:\n- Using the principles above, determine the fish’s trophic position $\\text{TP}$ as a unitless value.\n\nReport only the final trophic position, rounded to four significant figures. Do not include units in your final reported number.", "solution": "The problem statement must first be rigorously validated for scientific and logical integrity.\n\nStep 1: Extract Givens.\n- Consumer (fish) tissue isotopic values: $\\delta^{13}\\text{C}_{\\mathrm{cons}} = -18.7260$ ‰, $\\delta^{15}\\text{N}_{\\mathrm{cons}} = 11.8815$ ‰.\n- Consumer–diet trophic discrimination factors (TDF): $\\Delta^{13}\\text{C} = 1.0$ ‰, $\\Delta^{15}\\text{N} = 3.4$ ‰.\n- Prey item $1$: carbon concentration $c_{1} = 40$, nitrogen concentration $n_{1} = 10$, $\\delta^{13}\\text{C}_{1} = -18.0$ ‰, $\\delta^{15}\\text{N}_{1} = 8.0$ ‰.\n- Prey item $2$: $c_{2} = 35$, $n_{2} = 14$, $\\delta^{13}\\text{C}_{2} = -20.0$ ‰, $\\delta^{15}\\text{N}_{2} = 10.0$ ‰.\n- Prey item $3$: $c_{3} = 30$, $n_{3} = 8$, $\\delta^{13}\\text{C}_{3} = -25.0$ ‰, $\\delta^{15}\\text{N}_{3} = 6.0$ ‰.\n- Littoral baseline primary consumer: $\\delta^{13}\\text{C}_{\\mathrm{LPC}} = -16.0$ ‰, $\\delta^{15}\\text{N}_{\\mathrm{LPC}} = 6.5$ ‰.\n- Pelagic baseline primary consumer: $\\delta^{13}\\text{C}_{\\mathrm{PPC}} = -26.0$ ‰, $\\delta^{15}\\text{N}_{\\mathrm{PPC}} = 5.5$ ‰.\n- Baseline trophic level: $\\lambda = 2$.\n- Stepwise nitrogen enrichment per trophic level: $\\Delta_{\\text{N}} = 3.4$ ‰.\n- Assumptions:\n  1. Fish assimilated diet isotopic values are obtained by correcting consumer tissue values with TDFs.\n  2. A concentration-dependent linear mixing model applies for prey contributions to the diet.\n  3. The fish's basal energy contribution from the littoral channel is determined by a two-source mixing model using the diet's $\\delta^{13}\\text{C}$ value and the primary consumer baselines. The fish-specific $\\delta^{15}\\text{N}$ baseline is a linear mixture of the primary consumer $\\delta^{15}\\text{N}$ baselines using the same contribution factor.\n- Task: Determine the fish’s trophic position, $\\text{TP}$.\n\nStep 2: Validate Using Extracted Givens.\nThe problem is scientifically grounded, employing standard, well-established methodologies from stable isotope ecology for trophic position estimation. The framework is based on linear mixing models and the concept of trophic discrimination, which are fundamental principles in this field. The language is objective and precise. The problem is well-posed, providing all necessary information and clear instructions to determine a unique solution for the trophic position. The provided data for isotopic compositions, concentrations, and trophic discrimination factors are within realistic ranges observed in aquatic ecosystems. The presence of data regarding three specific prey items, while not strictly necessary for the prescribed calculation path for the baseline, does not create a contradiction; it merely presents a scenario where one must carefully follow instructions to identify the correct method among possible alternatives. The problem is thus self-contained and internally consistent.\n\nStep 3: Verdict and Action.\nThe problem is deemed valid. A solution will be derived.\n\nThe objective is to calculate the trophic position ($\\text{TP}$) of the fish. The standard formula for trophic position, as established by Post (2002), is:\n$$ \\text{TP} = \\lambda + \\frac{\\delta^{15}\\text{N}_{\\mathrm{consumer}} - \\delta^{15}\\text{N}_{\\mathrm{baseline}}}{\\Delta_{\\text{N}}} $$\nHere, $\\lambda$ is the trophic level of the baseline organism, $\\delta^{15}\\text{N}_{\\mathrm{consumer}}$ is the nitrogen isotopic composition of the consumer, $\\delta^{15}\\text{N}_{\\mathrm{baseline}}$ is the nitrogen isotopic composition of the baseline against which the consumer is measured, and $\\Delta_{\\text{N}}$ is the trophic enrichment factor for nitrogen.\n\nThe given parameters are $\\lambda = 2$, $\\delta^{15}\\text{N}_{\\mathrm{cons}} = 11.8815$ ‰, and $\\Delta_{\\text{N}} = 3.4$ ‰. The crucial unknown to be determined is the fish-specific nitrogen baseline, $\\delta^{15}\\text{N}_{\\mathrm{baseline}}$.\n\nThe problem provides a specific procedure for calculating this baseline. It involves two steps. First, we determine the proportional reliance on littoral versus pelagic basal energy sources. This is accomplished using a carbon isotope mixing model. Second, we use this proportion to construct the corresponding nitrogen baseline.\n\nStep 1: Calculate the isotopic signature of the fish's assimilated diet.\nThe problem states that the diet's isotopic signature is found by subtracting the trophic discrimination factor (TDF) from the consumer's tissue signature. We are interested in the carbon signature to determine the energy source proportion.\n$$ \\delta^{13}\\text{C}_{\\mathrm{diet}} = \\delta^{13}\\text{C}_{\\mathrm{cons}} - \\Delta^{13}\\text{C} $$\nSubstituting the given values:\n$$ \\delta^{13}\\text{C}_{\\mathrm{diet}} = -18.7260 - 1.0 = -19.7260 \\, \\text{‰} $$\n\nStep 2: Determine the proportion of energy from the littoral source.\nLet $\\alpha$ be the proportion of energy derived from the littoral channel. Consequently, $(1-\\alpha)$ is the proportion from the pelagic channel. A simple two-source linear mixing model is used, as specified:\n$$ \\delta^{13}\\text{C}_{\\mathrm{diet}} = \\alpha \\cdot \\delta^{13}\\text{C}_{\\mathrm{LPC}} + (1 - \\alpha) \\cdot \\delta^{13}\\text{C}_{\\mathrm{PPC}} $$\nWe substitute the known values and solve for $\\alpha$.\n$$ -19.7260 = \\alpha(-16.0) + (1-\\alpha)(-26.0) $$\n$$ -19.7260 = -16.0\\alpha - 26.0 + 26.0\\alpha $$\n$$ 26.0 - 19.7260 = (26.0 - 16.0)\\alpha $$\n$$ 6.274 = 10.0\\alpha $$\n$$ \\alpha = \\frac{6.274}{10.0} = 0.6274 $$\nThus, the fish's diet is supported by $62.74\\%$ littoral and $37.26\\%$ pelagic basal production.\n\nStep 3: Calculate the fish-specific nitrogen baseline ($\\delta^{15}\\text{N}_{\\mathrm{baseline}}$).\nThe problem dictates that this baseline is a linear mixture of the littoral and pelagic primary consumer $\\delta^{15}\\text{N}$ values, weighted by the same proportion $\\alpha$:\n$$ \\delta^{15}\\text{N}_{\\mathrm{baseline}} = \\alpha \\cdot \\delta^{15}\\text{N}_{\\mathrm{LPC}} + (1 - \\alpha) \\cdot \\delta^{15}\\text{N}_{\\mathrm{PPC}} $$\nSubstituting the values for $\\alpha$, $\\delta^{15}\\text{N}_{\\mathrm{LPC}}$, and $\\delta^{15}\\text{N}_{\\mathrm{PPC}}$:\n$$ \\delta^{15}\\text{N}_{\\mathrm{baseline}} = (0.6274)(6.5) + (1 - 0.6274)(5.5) $$\n$$ \\delta^{15}\\text{N}_{\\mathrm{baseline}} = 4.0781 + 2.0493 = 6.1274 \\, \\text{‰} $$\n\nStep 4: Calculate the Trophic Position (TP).\nNow all components for the trophic position formula are known.\n$$ \\text{TP} = \\lambda + \\frac{\\delta^{15}\\text{N}_{\\mathrm{cons}} - \\delta^{15}\\text{N}_{\\mathrm{baseline}}}{\\Delta_{\\text{N}}} $$\n$$ \\text{TP} = 2 + \\frac{11.8815 - 6.1274}{3.4} $$\n$$ \\text{TP} = 2 + \\frac{5.7541}{3.4} $$\n$$ \\text{TP} = 2 + 1.69238235... $$\n$$ \\text{TP} = 3.69238235... $$\n\nThe problem requires the final answer to be rounded to four significant figures. The value is $3.6923...$. The fifth significant figure is $3$, which is less than $5$, so we round down.\nThe trophic position is $3.692$.\n\nIt is noted that the data for the three individual prey items were not used. This is because the problem provided a direct method to calculate the consumer's integrated baseline based on ultimate energy sources (littoral and pelagic channels), bypassing the need to solve the underdetermined system of diet-prey mixing equations. This a valid and common approach in trophic ecology when the interest lies in the consumer's position relative to the base of the food web, rather than its specific diet composition.", "answer": "$$\\boxed{3.692}$$", "id": "2535236"}, {"introduction": "While bulk stable isotope analysis is powerful, interpreting the results can be complicated by simultaneous shifts in baseline isotopic values and trophic position. Compound-Specific Isotope Analysis of Amino Acids (CSIA-AA) offers a revolutionary solution by providing an internal isotopic reference frame. This exercise will demonstrate how to use the distinct isotopic behaviors of \"source\" amino acids (which reflect the baseline) and \"trophic\" amino acids (which enrich with each trophic step) to simultaneously solve for a consumer's baseline nutrient sources and its precise trophic position [@problem_id:2535230].", "problem": "A fish inhabits an estuarine confluence where nitrogen sources from marine phytoplankton and terrestrial C3 vegetation mix. You will infer its trophic position using Compound-Specific Isotope Analysis (CSIA) of Amino Acids (AA-CSIA), drawing only on core stable isotope principles. Use the following foundational facts.\n\nFirst, the delta notation for nitrogen isotopes is defined by $ \\delta^{15}\\mathrm{N} = \\left( \\frac{R_{\\mathrm{sample}}}{R_{\\mathrm{standard}}} - 1 \\right) \\times 1000 $, where $ R = \\frac{^{15}\\mathrm{N}}{^{14}\\mathrm{N}} $, and the values are reported in per mil relative to the atmospheric nitrogen standard. Second, under conditions where an analyzed compound is isotopically conservative with respect to trophic transfer, its $ \\delta^{15}\\mathrm{N} $ in a consumer can be represented as a linear mixture of endmember sources, weighted by their proportional contributions. Third, in amino acid-specific applications, certain amino acids behave as “source” amino acids with negligible trophic enrichment, while others behave as “trophic” amino acids that exhibit an approximately constant enrichment per trophic transfer when moving from a primary producer baseline up the food chain. Finally, primary producers exhibit a characteristic offset between the “trophic” amino acid and the “source” amino acid.\n\nAssume the following specifics, all scientifically typical for amino acid-specific nitrogen isotope ecology. Phenylalanine behaves as a “source” amino acid with negligible trophic enrichment. Glutamic acid behaves as a “trophic” amino acid that is enriched by $ 7.6 $ per mil per trophic transfer relative to the primary producer baseline. The characteristic primary producer offsets between glutamic acid and phenylalanine are $ 3.4 $ per mil for marine phytoplankton and $ -8.4 $ per mil for terrestrial C3 plants.\n\nYou measure the fish’s amino acid-specific nitrogen isotope values: glutamic acid $ \\delta^{15}\\mathrm{N} $ equals $ 23.2 $ per mil, and phenylalanine $ \\delta^{15}\\mathrm{N} $ equals $ 6.2 $ per mil. In the two endmember baselines, phenylalanine $ \\delta^{15}\\mathrm{N} $ equals $ 8.0 $ per mil in marine phytoplankton and $ 2.0 $ per mil in terrestrial C3 plants. Assume the fish’s phenylalanine $ \\delta^{15}\\mathrm{N} $ reflects only source mixing with no trophic enrichment, and that all mixing and trophic transfers have reached steady state such that linear mass-balance and additive trophic steps apply.\n\nUsing only these principles, determine the fish’s trophic position as a single scalar value, where a primary producer baseline has trophic position $ 1 $. Report the trophic position as a pure number (dimensionless) rounded to three significant figures.", "solution": "The problem statement is critically assessed and found to be valid. It is scientifically grounded in the established principles of Compound-Specific Isotope Analysis of Amino Acids (CSIA-AA) for trophic ecology, is well-posed with sufficient and consistent data for a unique solution, and is objectively formulated. The provided values for isotopic signatures ($\\delta^{15}\\mathrm{N}$), trophic enrichment factors ($\\text{TEF}$), and primary producer offsets ($\\beta$) are scientifically realistic. Therefore, I will proceed with a full solution.\n\nThe problem requires a two-step calculation. First, the proportional contribution of the two endmember sources (marine phytoplankton and terrestrial C3 vegetation) to the fish's diet must be determined. This is accomplished using the isotopic signature of the \"source\" amino acid, phenylalanine (Phe), which does not undergo significant isotopic fractionation during trophic transfer. Second, using these dietary proportions, an effective isotopic baseline for the \"trophic\" amino acid, glutamic acid (Glu), is established. This baseline is then used to calculate the fish's trophic position ($\\text{TP}$).\n\nStep 1: Determine the proportional contribution of each nitrogen source.\n\nLet $p_{\\text{marine}}$ be the proportion of nitrogen in the fish derived from the marine phytoplankton source, and $p_{\\text{terr}}$ be the proportion from the terrestrial C3 plant source. By definition, the sum of these proportions must be one:\n$$p_{\\text{marine}} + p_{\\text{terr}} = 1$$\n\nThe $\\delta^{15}\\mathrm{N}$ value of phenylalanine in the consumer ($\\delta^{15}\\mathrm{N}_{\\text{Phe,fish}}$) is a linear mixture of the $\\delta^{15}\\mathrm{N}_{\\text{Phe}}$ values of the sources, weighted by their proportional contributions. The mixing model is thus:\n$$\\delta^{15}\\mathrm{N}_{\\text{Phe,fish}} = p_{\\text{marine}} \\cdot \\delta^{15}\\mathrm{N}_{\\text{Phe,marine}} + p_{\\text{terr}} \\cdot \\delta^{15}\\mathrm{N}_{\\text{Phe,terr}}$$\nSubstituting $p_{\\text{terr}} = 1 - p_{\\text{marine}}$:\n$$\\delta^{15}\\mathrm{N}_{\\text{Phe,fish}} = p_{\\text{marine}} \\cdot \\delta^{15}\\mathrm{N}_{\\text{Phe,marine}} + (1 - p_{\\text{marine}}) \\cdot \\delta^{15}\\mathrm{N}_{\\text{Phe,terr}}$$\n\nWe are given the following values:\n$\\delta^{15}\\mathrm{N}_{\\text{Phe,fish}} = 6.2$\n$\\delta^{15}\\mathrm{N}_{\\text{Phe,marine}} = 8.0$\n$\\delta^{15}\\mathrm{N}_{\\text{Phe,terr}} = 2.0$\n\nSubstituting these values into the equation:\n$$6.2 = p_{\\text{marine}} \\cdot 8.0 + (1 - p_{\\text{marine}}) \\cdot 2.0$$\n$$6.2 = 8.0 \\cdot p_{\\text{marine}} + 2.0 - 2.0 \\cdot p_{\\text{marine}}$$\n$$6.2 - 2.0 = (8.0 - 2.0) \\cdot p_{\\text{marine}}$$\n$$4.2 = 6.0 \\cdot p_{\\text{marine}}$$\n$$p_{\\text{marine}} = \\frac{4.2}{6.0} = 0.7$$\n\nThus, the proportion from the marine source is $0.7$, or $70\\%$. The proportion from the terrestrial source is $p_{\\text{terr}} = 1 - 0.7 = 0.3$, or $30\\%$.\n\nStep 2: Calculate the Trophic Position ($\\text{TP}$).\n\nThe trophic position is calculated using the trophic amino acid, glutamic acid. The general formula defines the $\\delta^{15}\\mathrm{N}$ value of glutamic acid in a consumer ($\\delta^{15}\\mathrm{N}_{\\text{Glu,fish}}$) as a function of the baseline value, the trophic position, and the trophic enrichment factor ($\\text{TEF}_{\\text{Glu}}$):\n$$\\delta^{15}\\mathrm{N}_{\\text{Glu,fish}} = \\delta^{15}\\mathrm{N}_{\\text{Glu,baseline}} + (\\text{TP} - 1) \\cdot \\text{TEF}_{\\text{Glu}}$$\nHere, $\\text{TP}=1$ corresponds to the primary producer level. We can rearrange this to solve for $\\text{TP}$:\n$$\\text{TP} = 1 + \\frac{\\delta^{15}\\mathrm{N}_{\\text{Glu,fish}} - \\delta^{15}\\mathrm{N}_{\\text{Glu,baseline}}}{\\text{TEF}_{\\text{Glu}}}$$\n\nTo use this formula, we must first determine the effective $\\delta^{15}\\mathrm{N}_{\\text{Glu,baseline}}$ for the fish's diet. This is the weighted average of the $\\delta^{15}\\mathrm{N}_{\\text{Glu}}$ values of the primary producer endmembers, using the proportions calculated in Step 1.\n\nWe must first find the $\\delta^{15}\\mathrm{N}_{\\text{Glu}}$ for each primary producer source. This is done using the producer-specific offset, $\\beta = \\delta^{15}\\mathrm{N}_{\\text{Glu}} - \\delta^{15}\\mathrm{N}_{\\text{Phe}}$.\nFor the marine phytoplankton source:\n$$\\delta^{15}\\mathrm{N}_{\\text{Glu,marine}} = \\delta^{15}\\mathrm{N}_{\\text{Phe,marine}} + \\beta_{\\text{marine}} = 8.0 + 3.4 = 11.4$$\nFor the terrestrial C3 plant source:\n$$\\delta^{15}\\mathrm{N}_{\\text{Glu,terr}} = \\delta^{15}\\mathrm{N}_{\\text{Phe,terr}} + \\beta_{\\text{terr}} = 2.0 + (-8.4) = -6.4$$\n\nNow, we calculate the effective baseline for the fish's diet:\n$$\\delta^{15}\\mathrm{N}_{\\text{Glu,baseline}} = p_{\\text{marine}} \\cdot \\delta^{15}\\mathrm{N}_{\\text{Glu,marine}} + p_{\\text{terr}} \\cdot \\delta^{15}\\mathrm{N}_{\\text{Glu,terr}}$$\n$$\\delta^{15}\\mathrm{N}_{\\text{Glu,baseline}} = (0.7 \\cdot 11.4) + (0.3 \\cdot (-6.4))$$\n$$\\delta^{15}\\mathrm{N}_{\\text{Glu,baseline}} = 7.98 - 1.92 = 6.06$$\n\nWe now have all the necessary components to calculate the trophic position. We are given:\n$\\delta^{15}\\mathrm{N}_{\\text{Glu,fish}} = 23.2$\n$\\text{TEF}_{\\text{Glu}} = 7.6$\n\nSubstituting into the $\\text{TP}$ formula:\n$$\\text{TP} = 1 + \\frac{23.2 - 6.06}{7.6}$$\n$$\\text{TP} = 1 + \\frac{17.14}{7.6}$$\n$$\\text{TP} = 1 + 2.255263...$$\n$$\\text{TP} = 3.255263...$$\n\nThe problem requires the result to be rounded to three significant figures.\n$$\\text{TP} \\approx 3.26$$\n\nThe calculated trophic position of the fish is $3.26$. This indicates it is a secondary consumer, feeding on primary consumers.", "answer": "$$\n\\boxed{3.26}\n$$", "id": "2535230"}, {"introduction": "A point estimate of trophic position is incomplete without an accompanying measure of its uncertainty. Every input variable in our models—from isotopic measurements of consumers and baselines to the trophic enrichment factors—has an associated error, and these errors propagate through our calculations. This practice introduces the delta method, a robust first-order uncertainty propagation technique, to derive the standard deviation of a trophic position estimate, transforming a simple calculation into a rigorous, statistically defensible scientific result [@problem_id:2535238].", "problem": "A stable isotope trophic-ecology laboratory seeks an analytic, first-order uncertainty propagation for trophic position estimated with a two-baseline model that uses carbon to weight baselines and nitrogen to estimate position. Your task is to write a complete program that computes, for a given set of input means, standard deviations, and covariances, both the mean trophic position and its propagated standard deviation using the first-order Taylor series (delta method), under the assumptions stated below. The program must produce a single-line output aggregating results for multiple test cases.\n\nModel and assumptions to be used as foundational starting points, all of which are standard in stable isotope analysis:\n- Let $\\delta^{15}\\text{N}$ and $\\delta^{13}\\text{C}$ denote the stable isotope delta values. Assume linear mass balance for isotopes and a constant Trophic Enrichment Factor (TEF) per trophic level for nitrogen and a per-diet shift for carbon.\n- Define the trophic position $\\text{TP}$ relative to a baseline of trophic level $\\lambda$ by the relationship $\\text{TP} = \\lambda + (\\delta^{15}\\text{N}_{\\mathrm{consumer}} - \\delta^{15}\\text{N}_{\\mathrm{baseline}})/\\Delta_{\\text{N}}$, where $\\Delta_{\\text{N}}$ is the nitrogen TEF per trophic level, and $\\delta^{15}\\text{N}_{\\mathrm{baseline}}$ is a baseline composite.\n- Define the carbon-based mixing weight $\\alpha$ via the linear mass balance of diet-corrected carbon: $\\delta^{13}\\text{C}_{\\mathrm{consumer}} - \\Delta_{\\text{C}} = \\alpha\\delta^{13}\\text{C}_{b1} + (1-\\alpha)\\delta^{13}\\text{C}_{b2}$, where $\\Delta_{\\text{C}}$ is the carbon discrimination (diet-to-tissue shift), $\\delta^{13}\\text{C}_{b1}$ and $\\delta^{13}\\text{C}_{b2}$ are the two carbon baselines, and $\\delta^{13}\\text{C}_{\\mathrm{consumer}}$ is the consumer carbon.\n- Define the nitrogen baseline mixture: $\\delta^{15}\\text{N}_{\\mathrm{baseline}} = \\alpha\\delta^{15}\\text{N}_{b1} + (1-\\alpha)\\delta^{15}\\text{N}_{b2}$, with $\\delta^{15}\\text{N}_{b1}$ and $\\delta^{15}\\text{N}_{b2}$ the two nitrogen baselines.\n- All uncertainties are small enough for first-order Taylor linearization to be accurate. Random variables are mean-centered Gaussian perturbations about their stated means. Unless a covariance is explicitly provided below, assume zero covariance. Independence across carbon-related and nitrogen-related groups is assumed except for the provided within-group covariances. The baseline trophic level $\\lambda$ is fixed and known exactly as $\\lambda=2$.\n\nYour program must:\n- Compute the mean $\\alpha$ from the mean inputs, then compute the mean baseline nitrogen and the mean trophic position $\\text{TP}$.\n- Derive the analytic gradient of $\\text{TP}$ with respect to the random inputs $(\\delta^{15}\\text{N}_{\\mathrm{consumer}}, \\delta^{15}\\text{N}_{b1}, \\delta^{15}\\text{N}_{b2}, \\Delta_{\\text{N}}, \\delta^{13}\\text{C}_{\\mathrm{consumer}}, \\delta^{13}\\text{C}_{b1}, \\delta^{13}\\text{C}_{b2}, \\Delta_{\\text{C}})$ using the chain rule from the model definitions above; then compute the propagated variance as $\\text{Var}(\\text{TP}) = \\mathbf{g}^{\\top} \\boldsymbol{\\Sigma} \\mathbf{g}$ with the specified covariance structure. Return the propagated standard deviation as the square root of this variance. If numerical round-off yields a slightly negative variance, truncate it to zero before square-rooting.\n\nInput parameterization and required outputs:\n- For each test case, inputs are the means, standard deviations, and the only nonzero covariances, for the following variables: $\\delta^{15}\\text{N}_{\\mathrm{consumer}}$, $\\delta^{15}\\text{N}_{b1}$, $\\delta^{15}\\text{N}_{b2}$, $\\Delta_{\\text{N}}$, $\\delta^{13}\\text{C}_{\\mathrm{consumer}}$, $\\delta^{13}\\text{C}_{b1}$, $\\delta^{13}\\text{C}_{b2}$, $\\Delta_{\\text{C}}$. The only nonzero covariances are $\\text{Cov}(\\delta^{15}\\text{N}_{b1},\\delta^{15}\\text{N}_{b2})$ and $\\text{Cov}(\\delta^{13}\\text{C}_{b1},\\delta^{13}\\text{C}_{b2})$ as specified.\n- For each test case, your program must output the mean trophic position and its propagated standard deviation as a pair $[\\text{TP}_{\\mathrm{mean}}, \\text{TP}_{\\mathrm{sd}}]$, both rounded to $6$ decimal places.\n\nTest suite:\n- Test case $1$ (general case with modest separation of carbon baselines):\n  - Means: $\\delta^{15}\\text{N}_{\\mathrm{consumer}}=12.1$, $\\delta^{15}\\text{N}_{b1}=7.9$, $\\delta^{15}\\text{N}_{b2}=3.8$, $\\Delta_{\\text{N}}=3.4$, $\\delta^{13}\\text{C}_{\\mathrm{consumer}}=-19.8$, $\\delta^{13}\\text{C}_{b1}=-25.0$, $\\delta^{13}\\text{C}_{b2}=-18.0$, $\\Delta_{\\text{C}}=1.0$.\n  - Standard deviations: $0.2$, $0.25$, $0.25$, $0.4$, $0.2$, $0.3$, $0.3$, $0.2$ respectively.\n  - Nonzero covariances: $\\text{Cov}(\\delta^{15}\\text{N}_{b1},\\delta^{15}\\text{N}_{b2})=0.03$, $\\text{Cov}(\\delta^{13}\\text{C}_{b1},\\delta^{13}\\text{C}_{b2})=-0.02$.\n- Test case $2$ (well-separated carbon baselines and more precise inputs):\n  - Means: $\\delta^{15}\\text{N}_{\\mathrm{consumer}}=11.5$, $\\delta^{15}\\text{N}_{b1}=8.2$, $\\delta^{15}\\text{N}_{b2}=4.1$, $\\Delta_{\\text{N}}=3.2$, $\\delta^{13}\\text{C}_{\\mathrm{consumer}}=-20.1$, $\\delta^{13}\\text{C}_{b1}=-27.0$, $\\delta^{13}\\text{C}_{b2}=-16.0$, $\\Delta_{\\text{C}}=0.8$.\n  - Standard deviations: $0.15$, $0.15$, $0.15$, $0.2$, $0.1$, $0.2$, $0.2$, $0.1$ respectively.\n  - Nonzero covariances: $\\text{Cov}(\\delta^{15}\\text{N}_{b1},\\delta^{15}\\text{N}_{b2})=0.0$, $\\text{Cov}(\\delta^{13}\\text{C}_{b1},\\delta^{13}\\text{C}_{b2})=0.0$.\n- Test case $3$ (positively correlated baselines in both isotopes):\n  - Means: $\\delta^{15}\\text{N}_{\\mathrm{consumer}}=13.0$, $\\delta^{15}\\text{N}_{b1}=6.8$, $\\delta^{15}\\text{N}_{b2}=5.2$, $\\Delta_{\\text{N}}=3.5$, $\\delta^{13}\\text{C}_{\\mathrm{consumer}}=-21.0$, $\\delta^{13}\\text{C}_{b1}=-24.0$, $\\delta^{13}\\text{C}_{b2}=-20.0$, $\\Delta_{\\text{C}}=0.9$.\n  - Standard deviations: $0.25$, $0.35$, $0.35$, $0.3$, $0.15$, $0.25$, $0.25$, $0.15$ respectively.\n  - Nonzero covariances: $\\text{Cov}(\\delta^{15}\\text{N}_{b1},\\delta^{15}\\text{N}_{b2})=0.08$, $\\text{Cov}(\\delta^{13}\\text{C}_{b1},\\delta^{13}\\text{C}_{b2})=0.05$.\n- Test case $4$ (near-degenerate carbon baselines; small denominator):\n  - Means: $\\delta^{15}\\text{N}_{\\mathrm{consumer}}=10.8$, $\\delta^{15}\\text{N}_{b1}=7.0$, $\\delta^{15}\\text{N}_{b2}=6.8$, $\\Delta_{\\text{N}}=3.1$, $\\delta^{13}\\text{C}_{\\mathrm{consumer}}=-20.5$, $\\delta^{13}\\text{C}_{b1}=-20.9$, $\\delta^{13}\\text{C}_{b2}=-20.5$, $\\Delta_{\\text{C}}=0.7$.\n  - Standard deviations: $0.2$, $0.3$, $0.3$, $0.25$, $0.1$, $0.15$, $0.15$, $0.1$ respectively.\n  - Nonzero covariances: $\\text{Cov}(\\delta^{15}\\text{N}_{b1},\\delta^{15}\\text{N}_{b2})=0.02$, $\\text{Cov}(\\delta^{13}\\text{C}_{b1},\\delta^{13}\\text{C}_{b2})=0.01$.\n- Test case $5$ (weight $\\alpha$ near zero):\n  - Means: $\\delta^{15}\\text{N}_{\\mathrm{consumer}}=11.2$, $\\delta^{15}\\text{N}_{b1}=9.0$, $\\delta^{15}\\text{N}_{b2}=4.5$, $\\Delta_{\\text{N}}=3.3$, $\\delta^{13}\\text{C}_{\\mathrm{consumer}}=-17.0$, $\\delta^{13}\\text{C}_{b1}=-25.0$, $\\delta^{13}\\text{C}_{b2}=-18.0$, $\\Delta_{\\text{C}}=1.0$.\n  - Standard deviations: $0.18$, $0.2$, $0.2$, $0.3$, $0.12$, $0.2$, $0.2$, $0.12$ respectively.\n  - Nonzero covariances: $\\text{Cov}(\\delta^{15}\\text{N}_{b1},\\delta^{15}\\text{N}_{b2})=0.0$, $\\text{Cov}(\\delta^{13}\\text{C}_{b1},\\delta^{13}\\text{C}_{b2})=-0.01$.\n\nFinal output format requirement:\n- Your program should produce a single line of output containing the results as a comma-separated list of pairs, each pair being $[\\text{TP}_{\\mathrm{mean}},\\text{TP}_{\\mathrm{sd}}]$, all enclosed in a single outer set of square brackets, for example $[[x_1,y_1],[x_2,y_2],\\ldots]$. Each number must be rounded to $6$ decimal places. No additional text should be printed.", "solution": "The problem as stated is subjected to rigorous validation and is found to be valid. It is scientifically grounded in the established principles of stable isotope ecology, specifically two-source mixing models and trophic position estimation. The formulation is mathematically well-posed, providing a complete and consistent set of equations, parameters, and assumptions that permit a unique and meaningful solution. The use of the first-order Taylor series expansion (the delta method) for uncertainty propagation is a standard and appropriate technique under the stated assumption of small uncertainties. All terminology is precise and objective. Therefore, a complete solution is warranted and will be provided.\n\nThe problem requires the computation of the mean trophic position, $\\text{TP}$, and its associated standard deviation based on a two-baseline isotopic mixing model. The solution is derived in three parts: first, the calculation of the mean trophic position; second, the derivation of the analytical gradient of the trophic position function; and third, the application of the first-order uncertainty propagation formula.\n\nLet us define the eight random variables as a vector $\\mathbf{X}$:\n$$\n\\mathbf{X} = [X_1, X_2, X_3, X_4, X_5, X_6, X_7, X_8]^\\top = [\\delta^{15}\\text{N}_{\\mathrm{consumer}}, \\delta^{15}\\text{N}_{b1}, \\delta^{15}\\text{N}_{b2}, \\Delta_{\\text{N}}, \\delta^{13}\\text{C}_{\\mathrm{consumer}}, \\delta^{13}\\text{C}_{b1}, \\delta^{13}\\text{C}_{b2}, \\Delta_{\\text{C}}]^\\top\n$$\nThe trophic position, $\\text{TP}$, is a function of these variables, $\\text{TP} = f(\\mathbf{X})$, with the baseline trophic level $\\lambda$ being a known constant, $\\lambda=2$.\n\nThe model is defined by three core equations:\n1.  The mixing proportion, $\\alpha$, determined from carbon isotope values corrected for diet-to-tissue discrimination ($\\Delta_{\\text{C}}$):\n    $$\n    \\alpha = \\frac{(\\delta^{13}\\text{C}_{\\mathrm{consumer}} - \\Delta_{\\text{C}}) - \\delta^{13}\\text{C}_{b2}}{\\delta^{13}\\text{C}_{b1} - \\delta^{13}\\text{C}_{b2}}\n    $$\n2.  The effective nitrogen isotope value of the baseline, $\\delta^{15}\\text{N}_{\\mathrm{baseline}}$, computed as a weighted average of the two baseline sources:\n    $$\n    \\delta^{15}\\text{N}_{\\mathrm{baseline}} = \\alpha \\cdot \\delta^{15}\\text{N}_{b1} + (1-\\alpha) \\cdot \\delta^{15}\\text{N}_{b2}\n    $$\n3.  The trophic position, $\\text{TP}$, calculated from the nitrogen isotope enrichment of the consumer relative to its baseline, scaled by the trophic enrichment factor, $\\Delta_{\\text{N}}$:\n    $$\n    \\text{TP} = \\lambda + \\frac{\\delta^{15}\\text{N}_{\\mathrm{consumer}} - \\delta^{15}\\text{N}_{\\mathrm{baseline}}}{\\Delta_{\\text{N}}}\n    $$\n\nBy substituting the expressions for $\\alpha$ and $\\delta^{15}\\text{N}_{\\mathrm{baseline}}$, we can write $\\text{TP}$ as a single function of the input variables:\n$$\n\\text{TP} = \\lambda + \\frac{1}{\\Delta_{\\text{N}}} \\left[ \\delta^{15}\\text{N}_{\\mathrm{consumer}} - \\left( \\left( \\frac{\\delta^{13}\\text{C}_{\\mathrm{consumer}} - \\Delta_{\\text{C}} - \\delta^{13}\\text{C}_{b2}}{\\delta^{13}\\text{C}_{b1} - \\delta^{13}\\text{C}_{b2}} \\right) (\\delta^{15}\\text{N}_{b1} - \\delta^{15}\\text{N}_{b2}) + \\delta^{15}\\text{N}_{b2} \\right) \\right]\n$$\n\nTo find the mean trophic position, $\\mu_{\\text{TP}}$, we apply the first-order approximation, which states that the mean of a function of random variables is approximately the function evaluated at the means of those variables: $\\mu_{f(\\mathbf{X})} \\approx f(\\boldsymbol{\\mu}_{\\mathbf{X}})$. Thus, we compute $\\mu_{\\text{TP}}$ by substituting the mean values of all eight input variables into the equations above.\n\nTo find the uncertainty in $\\text{TP}$, we use the delta method. The variance of $\\text{TP}$ is approximated by the quadratic form:\n$$\n\\text{Var}(\\text{TP}) \\approx \\mathbf{g}^{\\top} \\boldsymbol{\\Sigma} \\mathbf{g}\n$$\nHere, $\\mathbf{g}$ is the gradient vector of the function $f$ evaluated at the mean values of the inputs, $\\mathbf{g} = \\nabla f(\\boldsymbol{\\mu}_{\\mathbf{X}})$, and $\\boldsymbol{\\Sigma}$ is the covariance matrix of the input variables $\\mathbf{X}$. The components of the gradient, $g_i = \\frac{\\partial \\text{TP}}{\\partial X_i}$, must be derived analytically. Using the chain and quotient rules of differentiation, we find the partial derivatives with respect to each of the eight variables. For clarity, let $D_N = \\delta^{15}\\text{N}_{b1} - \\delta^{15}\\text{N}_{b2}$ and $D_C = \\delta^{13}\\text{C}_{b1} - \\delta^{13}\\text{C}_{b2}$. The derivatives, evaluated at the means, are:\n\n$\\frac{\\partial \\text{TP}}{\\partial \\delta^{15}\\text{N}_{\\mathrm{consumer}}} = \\frac{1}{\\Delta_{\\text{N}}}$\n\n$\\frac{\\partial \\text{TP}}{\\partial \\delta^{15}\\text{N}_{b1}} = -\\frac{\\alpha}{\\Delta_{\\text{N}}}$\n\n$\\frac{\\partial \\text{TP}}{\\partial \\delta^{15}\\text{N}_{b2}} = -\\frac{1-\\alpha}{\\Delta_{\\text{N}}}$\n\n$\\frac{\\partial \\text{TP}}{\\partial \\Delta_{\\text{N}}} = -\\frac{\\delta^{15}\\text{N}_{\\mathrm{consumer}} - \\delta^{15}\\text{N}_{\\mathrm{baseline}}}{\\Delta_{\\text{N}}^2} = -\\frac{\\text{TP}-\\lambda}{\\Delta_{\\text{N}}}$\n\nThe remaining derivatives depend on the intermediate derivatives of $\\alpha$:\n$\\frac{\\partial \\text{TP}}{\\partial X_i} = \\frac{\\partial \\text{TP}}{\\partial \\alpha} \\frac{\\partial \\alpha}{\\partial X_i} = \\left(-\\frac{D_N}{\\Delta_{\\text{N}}}\\right) \\frac{\\partial \\alpha}{\\partial X_i}$ for $X_i \\in \\{\\delta^{13}\\text{C}_{\\mathrm{consumer}}, \\delta^{13}\\text{C}_{b1}, \\delta^{13}\\text{C}_{b2}, \\Delta_{\\text{C}}\\}$.\n\n$\\frac{\\partial \\text{TP}}{\\partial \\delta^{13}\\text{C}_{\\mathrm{consumer}}} = \\left(-\\frac{D_N}{\\Delta_{\\text{N}}}\\right) \\left(\\frac{1}{D_C}\\right) = -\\frac{D_N}{\\Delta_{\\text{N}}D_C}$\n\n$\\frac{\\partial \\text{TP}}{\\partial \\delta^{13}\\text{C}_{b1}} = \\left(-\\frac{D_N}{\\Delta_{\\text{N}}}\\right) \\left(-\\frac{\\alpha}{D_C}\\right) = \\frac{\\alpha D_N}{\\Delta_{\\text{N}}D_C}$\n\n$\\frac{\\partial \\text{TP}}{\\partial \\delta^{13}\\text{C}_{b2}} = \\left(-\\frac{D_N}{\\Delta_{\\text{N}}}\\right) \\left(-\\frac{1-\\alpha}{D_C}\\right) = \\frac{(1-\\alpha)D_N}{\\Delta_{\\text{N}}D_C}$\n\n$\\frac{\\partial \\text{TP}}{\\partial \\Delta_{\\text{C}}} = \\left(-\\frac{D_N}{\\Delta_{\\text{N}}}\\right) \\left(-\\frac{1}{D_C}\\right) = \\frac{D_N}{\\Delta_{\\text{N}}D_C}$\n\nThe $8 \\times 8$ covariance matrix $\\boldsymbol{\\Sigma}$ is constructed from the given standard deviations and covariances. The diagonal elements are the variances, $\\Sigma_{ii} = \\sigma_i^2$, where $\\sigma_i$ is the standard deviation of $X_i$. The specified off-diagonal elements are $\\Sigma_{23} = \\Sigma_{32} = \\text{Cov}(\\delta^{15}\\text{N}_{b1}, \\delta^{15}\\text{N}_{b2})$ and $\\Sigma_{67} = \\Sigma_{76} = \\text{Cov}(\\delta^{13}\\text{C}_{b1}, \\delta^{13}\\text{C}_{b2})$. All other covariances are zero as per the problem statement.\n\nThe propagation of variance is thus computed as the full matrix product $\\mathbf{g}^{\\top} \\boldsymbol{\\Sigma} \\mathbf{g}$. Given the sparse nature of $\\boldsymbol{\\Sigma}$, this expands to:\n$$\n\\text{Var}(\\text{TP}) = \\sum_{i=1}^{8} g_i^2 \\sigma_i^2 + 2 g_2 g_3 \\text{Cov}(\\delta^{15}\\text{N}_{b1}, \\delta^{15}\\text{N}_{b2}) + 2 g_6 g_7 \\text{Cov}(\\delta^{13}\\text{C}_{b1}, \\delta^{13}\\text{C}_{b2})\n$$\nFinally, the standard deviation of the trophic position, $\\sigma_{\\text{TP}}$, is the square root of the variance. Any numerically negative variance resulting from floating-point imprecision is truncated to zero.\n$$\n\\sigma_{\\text{TP}} = \\sqrt{\\max(0, \\text{Var}(\\text{TP}))}\n$$\nThe following program implements this complete procedure to compute the mean and standard deviation of TP for each test case.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for trophic position and its propagated uncertainty for multiple test cases.\n    \"\"\"\n    # Constant baseline trophic level\n    LAMBDA = 2.0\n\n    test_cases = [\n        # Test case 1 (general case)\n        {\n            \"means\": [12.1, 7.9, 3.8, 3.4, -19.8, -25.0, -18.0, 1.0],\n            \"sds\": [0.2, 0.25, 0.25, 0.4, 0.2, 0.3, 0.3, 0.2],\n            \"covs\": {\"cov_n_b1_b2\": 0.03, \"cov_c_b1_b2\": -0.02},\n        },\n        # Test case 2 (well-separated baselines)\n        {\n            \"means\": [11.5, 8.2, 4.1, 3.2, -20.1, -27.0, -16.0, 0.8],\n            \"sds\": [0.15, 0.15, 0.15, 0.2, 0.1, 0.2, 0.2, 0.1],\n            \"covs\": {\"cov_n_b1_b2\": 0.0, \"cov_c_b1_b2\": 0.0},\n        },\n        # Test case 3 (positively correlated baselines)\n        {\n            \"means\": [13.0, 6.8, 5.2, 3.5, -21.0, -24.0, -20.0, 0.9],\n            \"sds\": [0.25, 0.35, 0.35, 0.3, 0.15, 0.25, 0.25, 0.15],\n            \"covs\": {\"cov_n_b1_b2\": 0.08, \"cov_c_b1_b2\": 0.05},\n        },\n        # Test case 4 (near-degenerate carbon baselines)\n        {\n            \"means\": [10.8, 7.0, 6.8, 3.1, -20.5, -20.9, -20.5, 0.7],\n            \"sds\": [0.2, 0.3, 0.3, 0.25, 0.1, 0.15, 0.15, 0.1],\n            \"covs\": {\"cov_n_b1_b2\": 0.02, \"cov_c_b1_b2\": 0.01},\n        },\n        # Test case 5 (alpha near zero)\n        {\n            \"means\": [11.2, 9.0, 4.5, 3.3, -17.0, -25.0, -18.0, 1.0],\n            \"sds\": [0.18, 0.2, 0.2, 0.3, 0.12, 0.2, 0.2, 0.12],\n            \"covs\": {\"cov_n_b1_b2\": 0.0, \"cov_c_b1_b2\": -0.01},\n        },\n    ]\n\n    def calculate_tp_and_sd(means, sds, covs):\n        \"\"\"\n        Calculates mean trophic position and its propagated standard deviation.\n        The order of variables is:\n        d15N_c, d15N_b1, d15N_b2, delta_N, d13C_c, d13C_b1, d13C_b2, delta_C\n        \"\"\"\n        # Unpack mean values for clarity\n        d15N_c, d15N_b1, d15N_b2, delta_N, d13C_c, d13C_b1, d13C_b2, delta_C = means\n\n        # ===== Step 1: Calculate mean values of intermediate and final variables =====\n        \n        # Denominator for alpha calculation\n        d13C_b1_minus_b2 = d13C_b1 - d13C_b2\n        \n        # Handle potential division by zero, though not present in test cases\n        if d13C_b1_minus_b2 == 0:\n            # A degenerate case leading to infinite uncertainty\n            return np.nan, np.inf\n\n        # Mixing proportion alpha\n        alpha = ((d13C_c - delta_C) - d13C_b2) / d13C_b1_minus_b2\n        \n        # Baseline nitrogen value\n        d15N_baseline = alpha * d15N_b1 + (1 - alpha) * d15N_b2\n        \n        # Mean Trophic Position (TP)\n        tp_mean = LAMBDA + (d15N_c - d15N_baseline) / delta_N\n\n        # ===== Step 2: Calculate the gradient vector g =====\n        \n        g = np.zeros(8)\n        \n        d15N_b1_minus_b2 = d15N_b1 - d15N_b2\n\n        g[0] = 1.0 / delta_N  # d(TP)/d(d15N_c)\n        g[1] = -alpha / delta_N  # d(TP)/d(d15N_b1)\n        g[2] = -(1.0 - alpha) / delta_N  # d(TP)/d(d15N_b2)\n        g[3] = -(tp_mean - LAMBDA) / delta_N  # d(TP)/d(delta_N)\n\n        # Common term for carbon-related derivatives\n        # This is -d(TP)/d(alpha) * d(alpha)/d(d13C_c)\n        common_term_c = -d15N_b1_minus_b2 / (delta_N * d13C_b1_minus_b2)\n        \n        g[4] = common_term_c  # d(TP)/d(d13C_c)\n        g[5] = -alpha * common_term_c  # d(TP)/d(d13C_b1)\n        g[6] = -(1.0 - alpha) * common_term_c  # d(TP)/d(d13C_b2)\n        g[7] = -common_term_c  # d(TP)/d(delta_C)\n\n        # ===== Step 3: Construct the covariance matrix Sigma =====\n        \n        variances = np.square(np.array(sds))\n        Sigma = np.diag(variances)\n        \n        # Assign non-zero off-diagonal elements\n        Sigma[1, 2] = Sigma[2, 1] = covs[\"cov_n_b1_b2\"]\n        Sigma[5, 6] = Sigma[6, 5] = covs[\"cov_c_b1_b2\"]\n\n        # ===== Step 4: Calculate propagated variance and standard deviation =====\n        \n        # Variance(TP) = g_transpose * Sigma * g\n        var_tp = g.T @ Sigma @ g\n        \n        # Truncate to zero in case of small negative values from floating point error\n        var_tp = max(0, var_tp)\n        \n        tp_sd = np.sqrt(var_tp)\n        \n        return tp_mean, tp_sd\n\n    results = []\n    for case in test_cases:\n        mean, sd = calculate_tp_and_sd(case[\"means\"], case[\"sds\"], case[\"covs\"])\n        results.append(f\"[{mean:.6f},{sd:.6f}]\")\n\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n\n```", "id": "2535238"}]}