{"hands_on_practices": [{"introduction": "The amount of neutral genetic variation within a population is a direct reflection of its deep demographic history, representing a dynamic equilibrium between mutation introducing new alleles and genetic drift removing them. This core principle of population genetics allows us to estimate fundamental parameters like the effective population size ($N_e$) from observable data. This first exercise ([@problem_id:2521267]) provides hands-on practice in applying this principle, demonstrating how to use nucleotide diversity ($\\pi$), a common summary of genetic variation, to infer the effective size of a population under a standard coalescent model.", "problem": "A panmictic island-dwelling lizard lineage is being studied to infer its demographic history in a phylogeographic context. You sequence a single putatively neutral, nonrecombining nuclear locus of length $L$ base pairs from $n$ diploid individuals sampled across the species range. After rigorous quality control to exclude sites with evidence of selection, the observed average pairwise nucleotide diversity per site (the mean fraction of pairwise differences per site across all pairs of chromosomes), denoted by $\\pi$, is $\\pi = 0.0087$. An independent pedigree-based estimate of the per-site, per-generation mutation rate for this locus is $\\mu = 1.1 \\times 10^{-8}$.\n\nAssume a Wright–Fisher population model with constant size, diploid inheritance, neutrality, and the infinite-sites mutation model at mutation–drift equilibrium. Under these assumptions, estimate the diploid effective population size $N_{e}$ of the lineage. Round your final answer to $3$ significant figures. Express your final answer as a number of diploid individuals.", "solution": "The problem statement has been subjected to rigorous validation and is deemed valid. It is scientifically grounded in the principles of population genetics, well-posed with sufficient information for a unique solution, and objectively stated. The problem requires the application of fundamental theory to estimate a key demographic parameter from genetic data.\n\nThe core of this problem rests on the relationship between nucleotide diversity, the effective population size, and the mutation rate under the specific assumptions of the Wright–Fisher model at mutation–drift equilibrium. For a diploid, panmictic population of constant size, the expected average pairwise nucleotide diversity per site, denoted as $E[\\pi]$, is equal to the population mutation parameter, $\\theta$.\n\nThe formula for the population mutation parameter $\\theta$ in a diploid population is given by:\n$$\n\\theta = 4 N_{e} \\mu\n$$\nwhere $N_{e}$ is the diploid effective population size and $\\mu$ is the neutral mutation rate per site per generation.\n\nAt mutation–drift equilibrium, the expected nucleotide diversity equals this parameter:\n$$\nE[\\pi] = \\theta = 4 N_{e} \\mu\n$$\nThe problem provides the observed average pairwise nucleotide diversity, $\\pi = 0.0087$, which is our empirical estimate for the theoretical expectation $E[\\pi]$. We are also given the per-site, per-generation mutation rate $\\mu = 1.1 \\times 10^{-8}$. The other parameters provided, such as locus length $L$ and sample size $n$, are contextual for a real study but are not required for this specific calculation, as $\\pi$ is already provided as an average per-site value.\n\nWe can establish the following equation using the provided data:\n$$\n\\pi = 4 N_{e} \\mu\n$$\nOur objective is to solve for the diploid effective population size, $N_{e}$. We can rearrange the equation algebraically:\n$$\nN_{e} = \\frac{\\pi}{4 \\mu}\n$$\nNow, we substitute the given numerical values into this expression:\n$$\n\\pi = 0.0087\n$$\n$$\n\\mu = 1.1 \\times 10^{-8}\n$$\nSubstituting these into our equation for $N_{e}$:\n$$\nN_{e} = \\frac{0.0087}{4 \\times (1.1 \\times 10^{-8})}\n$$\nFirst, calculate the denominator:\n$$\n4 \\times 1.1 \\times 10^{-8} = 4.4 \\times 10^{-8}\n$$\nNow, perform the division:\n$$\nN_{e} = \\frac{0.0087}{4.4 \\times 10^{-8}} = \\frac{8.7 \\times 10^{-3}}{4.4 \\times 10^{-8}}\n$$\n$$\nN_{e} = \\left(\\frac{8.7}{4.4}\\right) \\times 10^{-3 - (-8)} = \\left(\\frac{8.7}{4.4}\\right) \\times 10^{5}\n$$\nThe division of the coefficients is:\n$$\n\\frac{8.7}{4.4} \\approx 1.977272...\n$$\nTherefore, the effective population size is:\n$$\nN_{e} \\approx 1.977272... \\times 10^{5} \\approx 197727.27...\n$$\nThe problem requires the final answer to be rounded to $3$ significant figures. The first three significant figures are $1$, $9$, and $7$. The fourth significant figure is $7$, which is greater than or equal to $5$, so we must round up the third significant figure.\n$$\nN_{e} \\approx 1.98 \\times 10^{5}\n$$\nThis corresponds to an estimated diploid effective population size of $198,000$ individuals.", "answer": "$$\\boxed{1.98 \\times 10^{5}}$$", "id": "2521267"}, {"introduction": "Building upon the analysis of a single population, phylogeography seeks to understand the spatial distribution of genetic variation among multiple populations. A foundational concept in this field is \"Isolation by Distance\" (IBD), which predicts that genetic differentiation should increase with geographic distance due to spatially limited gene flow. In this comprehensive practice ([@problem_id:2521282]), you will implement a full workflow to test for IBD, from calculating geographic distances and estimating pairwise genetic differentiation ($F_{ST}$) to using linear regression to quantify the relationship, a cornerstone analysis in landscape genetics.", "problem": "You are given diploid single-nucleotide polymorphism (SNP) genotypes for spatially referenced individuals sampled from multiple localities. Assume each individual is sampled at a locality and that multiple individuals may be sampled per locality, all sharing identical coordinates. Treat each locality as a subpopulation. Your task is to estimate the isolation-by-distance (IBD) slope by regressing the transformed genetic differentiation statistic on the logarithm of geographic distance.\n\nFundamental base and definitions:\n- The fixation index (F-statistics) between two subpopulations, denoted $F_{ST}$, measures the standardized variance in allele frequencies among subpopulations. A widely used unbiased estimator for biallelic markers between two samples is the Hudson estimator aggregated across loci, defined as follows. For each locus $l$, let $n_1 = 2 m_1$ and $n_2 = 2 m_2$ be the numbers of gene copies in subpopulations $1$ and $2$, where $m_1$ and $m_2$ are the numbers of diploid individuals genotyped at that locus in the respective subpopulations. Let $x_1$ and $x_2$ be the counts of the derived allele across the $n_1$ and $n_2$ gene copies, with sample frequencies $p_1 = x_1/n_1$ and $p_2 = x_2/n_2$. Define $h_1 = p_1(1 - p_1)$ and $h_2 = p_2(1 - p_2)$. The per-locus components are\n$$\na_l = (p_1 - p_2)^2 - \\frac{h_1}{n_1 - 1} - \\frac{h_2}{n_2 - 1}, \\quad\nb_l = p_1(1 - p_2) + p_2(1 - p_1).\n$$\nThe multi-locus Hudson estimator is\n$$\nF_{ST} = \\frac{\\sum_l a_l}{\\sum_l b_l},\n$$\nprovided $\\sum_l b_l > 0$. If $\\sum_l b_l = 0$, the locus set provides no information and should be treated as non-informative for that pair.\n- The IBD transformation for two subpopulations is $y = \\frac{F_{ST}}{1 - F_{ST}}$.\n- The geographic distance between two localities with latitude and longitude given in degrees is computed on a sphere of radius $R = 6371$ kilometers using the Haversine formula. For coordinates $(\\phi_1, \\lambda_1)$ and $(\\phi_2, \\lambda_2)$ in degrees, first convert to radians, then compute\n$$\n\\Delta \\phi = \\phi_2 - \\phi_1, \\quad \\Delta \\lambda = \\lambda_2 - \\lambda_1,\n$$\n$$\nA = \\sin^2\\left(\\frac{\\Delta \\phi}{2}\\right) + \\cos(\\phi_1)\\cos(\\phi_2)\\sin^2\\left(\\frac{\\Delta \\lambda}{2}\\right),\n$$\n$$\nd = 2 R \\arcsin(\\sqrt{A}),\n$$\nwhich yields $d$ in kilometers. Use the natural logarithm $\\log$ of $d$ as the predictor.\n- Estimate the slope parameter $\\beta$ of the linear relationship\n$$\ny = \\alpha + \\beta \\log(d) + \\varepsilon\n$$\nby ordinary least squares (OLS) with an intercept $\\alpha$, using all unordered pairs of distinct subpopulations. The OLS slope is obtained from minimizing the sum of squared residuals across all pairwise data.\n\nProgram requirements:\n- Implement the above steps: group individuals by locality, compute pairwise $F_{ST}$ using the Hudson estimator across all loci, transform to $y = F_{ST}/(1 - F_{ST})$, compute geographic distances in kilometers via the Haversine formula (angles in degrees in input, radians internally), and fit an OLS regression of $y$ on $\\log(d)$ with an intercept. Exclude any pair with $d \\le 0$ (none should occur because only distinct localities are paired).\n- Units: All distances must be computed in kilometers; use $R = 6371$ kilometers. Angles in the input are given in degrees and must be converted to radians for trigonometric functions. The regression uses the natural logarithm (base $e$).\n- Output: For each dataset in the test suite below, output the OLS slope $\\beta$ as a floating-point number rounded to $6$ decimal places.\n- Final output format: Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[0.123456,0.000001,1.234567]\").\n\nTest suite:\nEach dataset contains a set of localities. Each locality specifies a latitude (degrees), a longitude (degrees), and a list of diploid individuals. Each individual has genotypes at all loci encoded as counts of the derived allele in $\\{0, 1, 2\\}$. The loci are ordered consistently across all individuals within a dataset.\n\nDataset A (happy path; $4$ localities, $8$ loci, $4$ individuals per locality):\n- Localities and coordinates (latitude, longitude in degrees):\n  - A: $(0, 0)$\n  - B: $(0, 1)$\n  - C: $(0, 2)$\n  - D: $(0, 3)$\n- Genotypes by locality (rows are individuals, columns are loci $\\ell = 1,\\dots,8$):\n  - A:\n    - $[0, 1, 0, 1, 2, 1, 2, 1]$\n    - $[0, 0, 1, 1, 0, 1, 1, 1]$\n    - $[0, 0, 0, 0, 0, 1, 0, 1]$\n    - $[0, 0, 0, 0, 0, 0, 0, 1]$\n  - B:\n    - $[1, 1, 2, 1, 2, 1, 2, 2]$\n    - $[0, 1, 0, 1, 1, 1, 1, 2]$\n    - $[0, 0, 0, 1, 0, 1, 1, 1]$\n    - $[0, 0, 0, 0, 0, 1, 0, 0]$\n  - C:\n    - $[1, 2, 2, 1, 2, 2, 2, 2]$\n    - $[1, 1, 1, 1, 1, 2, 2, 2]$\n    - $[0, 0, 0, 1, 1, 1, 1, 2]$\n    - $[0, 0, 0, 1, 0, 0, 0, 0]$\n  - D:\n    - $[1, 2, 2, 2, 2, 2, 2, 2]$\n    - $[1, 2, 1, 2, 2, 2, 2, 2]$\n    - $[1, 1, 1, 2, 1, 2, 2, 2]$\n    - $[1, 0, 1, 0, 1, 1, 1, 2]$\n\nDataset B (boundary case with weak differentiation; $3$ localities, $6$ loci, $3$ individuals per locality):\n- Localities and coordinates:\n  - E: $(10, 10)$\n  - F: $(10, 11)$\n  - G: $(11, 10)$\n- Genotypes:\n  - E:\n    - $[1, 1, 1, 2, 1, 1]$\n    - $[1, 1, 1, 1, 1, 1]$\n    - $[1, 1, 0, 1, 1, 0]$\n  - F:\n    - $[1, 1, 1, 2, 1, 1]$\n    - $[1, 1, 1, 1, 1, 1]$\n    - $[1, 0, 1, 1, 0, 1]$\n  - G:\n    - $[1, 1, 1, 2, 1, 1]$\n    - $[1, 1, 1, 1, 1, 1]$\n    - $[0, 1, 1, 1, 1, 0]$\n\nDataset C (edge case with a distant, highly differentiated locality; $4$ localities, $7$ loci, $3$ individuals per locality):\n- Localities and coordinates:\n  - H: $(0, 0)$\n  - I: $(0, 1)$\n  - J: $(0, 2)$\n  - K: $(20, 20)$\n- Genotypes:\n  - H:\n    - $[1, 1, 1, 1, 1, 1, 1]$\n    - $[1, 1, 0, 1, 1, 0, 1]$\n    - $[0, 0, 0, 1, 0, 0, 0]$\n  - I:\n    - $[1, 1, 1, 1, 1, 1, 1]$\n    - $[1, 1, 1, 1, 1, 1, 1]$\n    - $[0, 0, 0, 1, 0, 0, 0]$\n  - J:\n    - $[1, 1, 1, 1, 1, 1, 1]$\n    - $[1, 0, 1, 1, 1, 0, 1]$\n    - $[0, 0, 0, 1, 0, 0, 0]$\n  - K:\n    - $[2, 2, 2, 2, 2, 2, 2]$\n    - $[2, 2, 1, 2, 2, 2, 1]$\n    - $[1, 1, 1, 2, 1, 1, 1]$\n\nYour program must internally construct these datasets exactly as specified, perform the computations as described, and print a single line containing the slopes for Dataset A, Dataset B, and Dataset C, in that order, rounded to $6$ decimal places, as a comma-separated list enclosed in square brackets.", "solution": "The problem presented is subjected to rigorous validation and is found to be scientifically grounded, well-posed, and objective. It describes a standard procedure in the field of population genetics for quantifying isolation by distance. The definitions, data, and objectives are specified with sufficient clarity and precision to permit a unique, verifiable solution. We may therefore proceed with the derivation and implementation of the solution.\n\nThe objective is to estimate the slope parameter, $\\beta$, of the linear relationship between transformed genetic differentiation and the natural logarithm of geographic distance. The model is given by $y = \\alpha + \\beta \\log(d) + \\varepsilon$. The estimation procedure involves three primary stages: data organization, pairwise metric calculation, and parameter estimation via Ordinary Least Squares (OLS) regression.\n\nFirst, the provided genotype data is organized by sampling locality. The input consists of diploid individuals with genotypes encoded as the count of a derived allele, an integer from the set $\\{0, 1, 2\\}$, at multiple single-nucleotide polymorphism (SNP) loci. We must process these data for each pair of distinct localities.\n\nSecond, for each unique unordered pair of localities, we compute two key metrics: the geographic distance, $d$, and the transformed genetic differentiation, $y$.\n\nThe geographic distance, $d$, is calculated using the Haversine formula, which determines the great-circle distance on a sphere. Given two localities with coordinates $(\\phi_1, \\lambda_1)$ and $(\\phi_2, \\lambda_2)$ in degrees, we first convert these to radians. The distance $d$ in kilometers ($km$) is then computed as:\n$$\nd = 2 R \\arcsin\\left(\\sqrt{\\sin^2\\left(\\frac{\\Delta \\phi}{2}\\right) + \\cos(\\phi_1)\\cos(\\phi_2)\\sin^2\\left(\\frac{\\Delta \\lambda}{2}\\right)}\\right)\n$$\nwhere $\\Delta \\phi = \\phi_2 - \\phi_1$, $\\Delta \\lambda = \\lambda_2 - \\lambda_1$, and the Earth's radius is taken as $R = 6371$ km. The predictor variable for our regression is the natural logarithm of this distance, $X_i = \\log(d_i)$ for a given pair $i$. Any pair with a resulting distance $d \\le 0$ must be excluded from analysis.\n\nThe genetic differentiation is quantified using the fixation index, $F_{ST}$. We employ the multi-locus Hudson estimator, an unbiased estimator for biallelic markers. For a given pair of subpopulations (localities) with $m_1$ and $m_2$ diploid individuals respectively, the number of gene copies are $n_1 = 2m_1$ and $n_2 = 2m_2$. For each locus $l$, we first compute the sample allele frequencies of the derived allele, $p_{1,l} = x_{1,l}/n_1$ and $p_{2,l} = x_{2,l}/n_2$, where $x_{1,l}$ and $x_{2,l}$ are the counts of the derived allele in each subpopulation at that locus. The per-locus components of the estimator are:\n$$\na_l = (p_{1,l} - p_{2,l})^2 - \\frac{h_{1,l}}{n_1 - 1} - \\frac{h_{2,l}}{n_2 - 1}\n$$\n$$\nb_l = p_{1,l}(1 - p_{2,l}) + p_{2,l}(1 - p_{1,l})\n$$\nwhere $h_{1,l} = p_{1,l}(1 - p_{1,l})$ and $h_{2,l} = p_{2,l}(1 - p_{2,l})$ are the within-population heterozygosities. The terms containing $n-1$ in the denominator constitute the correction for finite sample sizes. The multi-locus estimator is the ratio of the sums of these components across all $L$ loci:\n$$\nF_{ST} = \\frac{\\sum_{l=1}^{L} a_l}{\\sum_{l=1}^{L} b_l}\n$$\nThis calculation is valid only if the denominator $\\sum_l b_l > 0$. If this condition is not met, the pair of populations is considered non-informative and is excluded from the subsequent analysis. The $F_{ST}$ value is then transformed to linearize its relationship with $\\log(d)$ using the formula:\n$$\ny = \\frac{F_{ST}}{1 - F_{ST}}\n$$\nThis transformation is undefined if $F_{ST} \\ge 1$. Such pairs, representing complete or extreme differentiation, are also excluded from the regression analysis.\n\nThird, after computing the set of data points $\\{(\\log(d_i), y_i)\\}$ for all valid pairs of localities $i$, we estimate the slope parameter $\\beta$. The linear model is $y_i = \\alpha + \\beta \\log(d_i) + \\varepsilon_i$. Using Ordinary Least Squares (OLS), the slope $\\beta$ that minimizes the sum of squared residuals $\\sum_i (y_i - (\\alpha + \\beta \\log(d_i)))^2$ is given by:\n$$\n\\beta = \\frac{\\sum_{i} (\\log(d_i) - \\overline{\\log(d)}) (y_i - \\bar{y})}{\\sum_{i} (\\log(d_i) - \\overline{\\log(d)})^2}\n$$\nwhere $\\overline{\\log(d)}$ and $\\bar{y}$ are the sample means of the predictor and response variables, respectively. This value will be computed for each dataset provided. The implementation will follow these steps precisely, utilizing numerical libraries for robust calculation of distances, genetic statistics, and the final OLS regression.", "answer": "[0.030564,0.005477,0.054366]", "id": "2521282"}, {"introduction": "Historical biogeography often involves comparing gene genealogies to the history of species divergence. However, the branching pattern of a gene tree does not always match the species tree, a phenomenon known as gene tree-species tree discordance. This exercise ([@problem_id:2521228]) delves into Incomplete Lineage Sorting (ILS), a primary cause of such discordance, which arises from the stochastic nature of coalescence in ancestral populations. By calculating the expected frequency of ILS for a given species tree, you will gain a crucial understanding of how population-level processes directly impact the phylogenetic patterns we observe across species.", "problem": "Consider a rooted three-taxon species tree with topology $((A,B),C)$ evolving under the standard multispecies coalescent with diploid organisms. Assume the following conditions hold: panmixia within each lineage, neutrality, no gene flow after speciation, no recombination within loci, and independence among loci. Effective population size is constant and equal to $N_e$ on each ancestral branch. Let the divergence of $A$ and $B$ occur at time $\\tau_{AB}$ (in generations) and the divergence of $(A,B)$ from $C$ occur at time $\\tau_{ABC}$ (in generations), with $\\tau_{ABC} \\gt \\tau_{AB}$. The internal branch length between these two speciation events is $\\Delta T = \\tau_{ABC} - \\tau_{AB}$. You are given that $\\Delta T$ equals $1.2\\,N_e$ generations. \n\nUsing only fundamental properties of the coalescent (specifically, that in a constant-size diploid population of size $N_e$, the waiting time to coalescence for two lineages is exponentially distributed with rate $1/(2N_e)$, and that when three lineages enter a single constant-size population the identity of the first coalescing pair is exchangeable across the three pairs), compute the expected proportion of gene trees that are topologically discordant with the species tree due solely to incomplete lineage sorting (ILS) across a very large number of independent loci.\n\nExpress your final answer as a decimal fraction with no units, and round to $4$ significant figures.", "solution": "The problem presents a classic scenario in phylogenetics for calculating the probability of gene tree-species tree discordance due to incomplete lineage sorting (ILS). The problem is well-defined, scientifically sound, and contains all necessary information for a unique solution.\n\nLet us denote the three sampled gene lineages from species $A$, $B$, and $C$ as $a$, $b$, and $c$, respectively. The species tree topology is given as $((A,B),C)$. This means that species $A$ and $B$ share a more recent common ancestor with each other than either does with species $C$.\n\nWe trace the history of these three lineages backward in time. From the present to time $\\tau_{AB}$, the lineages evolve independently within their respective species' ancestral populations. At time $\\tau_{AB}$, lineages $a$ and $b$ enter their common ancestral population, which we denote $AB$. Lineage $c$ remains in a separate ancestral lineage. This state persists for the duration of the internal branch, $\\Delta T = \\tau_{ABC} - \\tau_{AB}$. At time $\\tau_{ABC}$, the ancestral population $AB$ and the ancestral lineage of $C$ merge into a single common ancestral population, which we denote $ABC$. At this point, either two or three lineages enter population $ABC$, depending on what occurred during the time interval $\\Delta T$.\n\nThe topology of the gene tree is determined by the sequence of coalescent events. A gene tree congruent with the species tree, i.e., topology $((A,B),C)$, is formed if and only if lineages $a$ and $b$ coalesce with each other before either coalesces with lineage $c$.\n\nThere are two mutually exclusive scenarios for the lineages $a$ and $b$ during the interval $\\Delta T$:\n$1$. The two lineages, $a$ and $b$, coalesce within population $AB$.\n$2$. The two lineages, $a$ and $b$, fail to coalesce within population $AB$ and enter the deeper ancestral population $ABC$ as distinct lineages, along with lineage $c$.\n\nLet us analyze the probabilities of these scenarios. The problem states that the waiting time for any two lineages to coalesce in a diploid population of constant effective size $N_e$ is exponentially distributed with a rate parameter $\\lambda = \\frac{1}{2N_e}$ per generation. The duration of the internal branch is given as $\\Delta T$.\n\nThe probability that two lineages fail to coalesce within a time interval $\\Delta T$ is given by the survival function of the exponential distribution:\n$$P(\\text{no coalescence in } \\Delta T) = \\exp\\left(-\\lambda \\Delta T\\right) = \\exp\\left(-\\frac{\\Delta T}{2N_e}\\right)$$\nConsequently, the probability that they do coalesce within this interval is:\n$$P(\\text{coalescence in } \\Delta T) = 1 - \\exp\\left(-\\frac{\\Delta T}{2N_e}\\right)$$\n\nIf coalescence occurs in the interval $\\Delta T$ (Scenario $1$), then lineages $a$ and $b$ merge. The resulting ancestral lineage and lineage $c$ enter the population $ABC$. There are then only two lineages, which will inevitably coalesce at some point further back in time. The gene tree topology in this case is guaranteed to be $((A,B),C)$, which is congruent with the species tree.\n\nA discordant gene tree can only arise if Scenario $2$ occurs. That is, lineages $a$ and $b$ must fail to coalesce in the internal branch. The probability of this event is $P(\\text{no coalescence in } \\Delta T)$. If this occurs, three distinct lineages ($a$, $b$, and $c$) enter the ancestral population $ABC$ at time $\\tau_{ABC}$.\n\nThe problem states that within this single, panmictic population $ABC$, the identity of the first pair of lineages to coalesce is exchangeable. This means any of the three possible pairs—$(a,b)$, $(a,c)$, or $(b,c)$—is equally likely to be the first to coalesce. The probability for any specific pair to coalesce first is $\\frac{1}{3}$.\nThe resulting gene tree topology depends on which pair coalesces first:\n- If $(a,b)$ coalesces first, the topology is $((A,B),C)$ (concordant). This occurs with conditional probability $\\frac{1}{3}$.\n- If $(a,c)$ coalesces first, the topology is $((A,C),B)$ (discordant). This occurs with conditional probability $\\frac{1}{3}$.\n- If $(b,c)$ coalesces first, the topology is $((B,C),A)$ (discordant). This occurs with conditional probability $\\frac{1}{3}$.\n\nTherefore, conditional on the three lineages entering population $ABC$, the probability of obtaining a discordant topology is the sum of the probabilities of the latter two outcomes:\n$$P(\\text{discordant} | \\text{no coalescence in } \\Delta T) = \\frac{1}{3} + \\frac{1}{3} = \\frac{2}{3}$$\nThe total probability of observing a discordant gene tree, $P_d$, is the probability of Scenario $2$ occurring, multiplied by the conditional probability of discordance given Scenario $2$.\n$$P_d = P(\\text{no coalescence in } \\Delta T) \\times P(\\text{discordant} | \\text{no coalescence in } \\Delta T)$$\n$$P_d = \\exp\\left(-\\frac{\\Delta T}{2N_e}\\right) \\times \\frac{2}{3}$$\n\nThe problem provides the specific value for the internal branch length: $\\Delta T = 1.2 N_e$ generations. We substitute this into the equation:\n$$P_d = \\frac{2}{3} \\exp\\left(-\\frac{1.2 N_e}{2 N_e}\\right)$$\nThe term $N_e$ cancels, simplifying the exponent:\n$$P_d = \\frac{2}{3} \\exp(-0.6)$$\nNow, we must compute the numerical value.\n$$P_d \\approx \\frac{2}{3} \\times 0.548811636$$\n$$P_d \\approx 0.365874424$$\nThe problem requires the answer to be rounded to $4$ significant figures. This gives $0.3659$.\n\nThe expected proportion of discordant gene trees over a very large number of independent loci is equivalent to this probability, $P_d$.", "answer": "$$\\boxed{0.3659}$$", "id": "2521228"}]}