{"hands_on_practices": [{"introduction": "To build a comprehensive understanding of how gene pools evolve, we must first learn to model the constituent forces in isolation. This first practice focuses on the fundamental force of mutation, treating it as a deterministic pressure that systematically alters allele frequencies over time. By modeling reversible mutation from first principles, you will derive the dynamic equation for allele frequency change and solve for the equilibrium point where the effects of forward and backward mutation are perfectly balanced [@problem_id:2814732]. This exercise develops the foundational skill of translating a biological process into a mathematical model and analyzing its long-term behavior.", "problem": "Consider an infinite, randomly mating diploid population at a single bi-allelic locus with alleles $A$ and $a$. There is no natural selection, no genetic drift, and no migration. Mutation is reversible and occurs each generation with per-allele, per-generation rates: $A \\to a$ at rate $\\mu$ and $a \\to A$ at rate $\\nu$, where $\\mu \\ge 0$ and $\\nu \\ge 0$. Let $p_t$ denote the frequency of allele $A$ in generation $t$, with $p_t \\in [0,1]$. Assume discrete, non-overlapping generations.\n\nUsing only the definitions of forward and backward mutation and the law of total probability, do the following:\n\n1. Derive the deterministic mapping that gives $p_{t+1}$ from $p_t$ under mutation alone.\n2. Solve for all equilibrium allele frequencies $\\hat{p} \\in [0,1]$ of this mapping as functions of $\\mu$ and $\\nu$.\n3. Classify the local stability of each equilibrium by linearization of the mapping around the equilibrium, and state explicit conditions on $(\\mu,\\nu)$ for stability.\n\nReport only the internal-equilibrium allele frequency (if it exists) as a closed-form expression in your final answer. No rounding is required. Do not include any units in the final answer.", "solution": "The problem will first be subjected to a rigorous validation process.\n\n**Step 1: Extract Givens**\n- Population: infinite, randomly mating, diploid.\n- Locus: single, bi-allelic with alleles $A$ and $a$.\n- Evolutionary forces: no natural selection, no genetic drift, no migration.\n- Mutation: reversible, discrete non-overlapping generations.\n- Mutation rate from $A$ to $a$: $\\mu$ per allele, per generation, with $\\mu \\ge 0$.\n- Mutation rate from $a$ to $A$: $\\nu$ per allele, per generation, with $\\nu \\ge 0$.\n- Allele frequency: $p_t$ is the frequency of allele $A$ in generation $t$, $p_t \\in [0,1]$.\n- Task 1: Derive the deterministic mapping $p_{t+1} = f(p_t)$.\n- Task 2: Solve for all equilibrium allele frequencies $\\hat{p} \\in [0,1]$.\n- Task 3: Classify the local stability of each equilibrium.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is scientifically grounded. It presents a canonical model in population genetics for the effect of mutation on allele frequencies in an idealized population. The assumptions, such as an infinite population, serve to isolate the deterministic pressure of mutation from the stochastic effects of genetic drift, which is a standard and necessary simplification for introducing the concept. The problem is well-posed, with all variables ($\\mu, \\nu, p_t$) and conditions clearly defined, leading to a solvable system. The language is objective and formal. The problem does not violate any fundamental principles of mathematics or genetics. It is a complete and consistent statement of a fundamental concept.\n\n**Verdict:** The problem is valid. A solution will be provided.\n\nThe solution proceeds in three parts as requested.\n\n**1. Derivation of the Recurrence Relation for $p_t$**\n\nLet $p_t$ be the frequency of allele $A$ in generation $t$. Consequently, the frequency of allele $a$ in generation $t$ is $q_t = 1 - p_t$. We wish to find the frequency of allele $A$ in the next generation, $p_{t+1}$. The calculation is based on tracking the origins of alleles in generation $t+1$ from the gene pool of generation $t$.\n\nAn allele $A$ in generation $t+1$ can arise from two mutually exclusive events in generation $t$:\ni) An allele was $A$ in generation $t$ and did not mutate to $a$. The probability of an $A$ allele not mutating is $(1 - \\mu)$.\nii) An allele was $a$ in generation $t$ and mutated to $A$. The probability of an $a$ allele mutating is $\\nu$.\n\nThe frequency of alleles of type $A$ that do not mutate is the product of their initial frequency and the probability of non-mutation: $p_t (1 - \\mu)$.\nThe frequency of alleles of type $a$ that do mutate to $A$ is the product of their initial frequency and the probability of mutation: $(1 - p_t) \\nu$.\n\nBy the law of total probability, the total frequency of allele $A$ in generation $t+1$ is the sum of the frequencies from these two pathways:\n$$p_{t+1} = p_t (1 - \\mu) + (1 - p_t) \\nu$$\nThis is the deterministic mapping that gives $p_{t+1}$ as a function of $p_t$. This can be rearranged into a linear map form:\n$$p_{t+1} = p_t - \\mu p_t + \\nu - \\nu p_t$$\n$$p_{t+1} = p_t (1 - \\mu - \\nu) + \\nu$$\n\n**2. Calculation of Equilibrium Allele Frequencies**\n\nAn equilibrium is a state where the allele frequency no longer changes over time. At equilibrium, we have $p_{t+1} = p_t = \\hat{p}$. Substituting $\\hat{p}$ into the recurrence relation:\n$$\\hat{p} = \\hat{p}(1 - \\mu - \\nu) + \\nu$$\nWe solve this equation for $\\hat{p}$:\n$$\\hat{p} - \\hat{p}(1 - \\mu - \\nu) = \\nu$$\n$$\\hat{p} (1 - (1 - \\mu - \\nu)) = \\nu$$\n$$\\hat{p} (\\mu + \\nu) = \\nu$$\n\nWe must now consider two cases for the sum $\\mu + \\nu$:\nCase A: $\\mu + \\nu > 0$.\nIn this case, we can divide by $(\\mu + \\nu)$ to find a unique equilibrium frequency:\n$$\\hat{p} = \\frac{\\nu}{\\mu + \\nu}$$\nSince $\\mu \\ge 0$ and $\\nu \\ge 0$, this equilibrium frequency $\\hat{p}$ is guaranteed to be in the interval $[0,1]$. Specifically, if $\\mu > 0$ and $\\nu > 0$, then $0 < \\hat{p} < 1$, which is an internal or polymorphic equilibrium. If $\\mu > 0$ and $\\nu = 0$, then $\\hat{p} = 0$. If $\\mu = 0$ and $\\nu > 0$, then $\\hat{p} = 1$.\n\nCase B: $\\mu + \\nu = 0$.\nSince $\\mu \\ge 0$ and $\\nu \\ge 0$, this implies $\\mu = 0$ and $\\nu = 0$. In this scenario, there is no mutation. The recurrence relation becomes $p_{t+1} = p_t(1 - 0 - 0) + 0$, which simplifies to $p_{t+1} = p_t$.\nThe equilibrium equation becomes $\\hat{p}(\\mu+\\nu) = \\nu \\implies \\hat{p}(0) = 0$, which is true for any value of $\\hat{p}$. Therefore, when there is no mutation, any allele frequency $p \\in [0,1]$ is an equilibrium.\n\nIn summary, for $\\mu+\\nu>0$, there is a single equilibrium $\\hat{p} = \\frac{\\nu}{\\mu+\\nu}$. For $\\mu=\\nu=0$, all $p \\in [0,1]$ are equilibria.\n\n**3. Stability Analysis of the Equilibria**\n\nThe local stability of a fixed point $\\hat{p}$ for a one-dimensional discrete map $p_{t+1} = f(p_t)$ is determined by the magnitude of the derivative of the mapping function, $f'(p)$, evaluated at the fixed point. The equilibrium is locally stable if $|f'(\\hat{p})| < 1$, neutrally stable if $|f'(\\hat{p})| = 1$, and unstable if $|f'(\\hat{p})| > 1$.\n\nThe mapping is $f(p_t) = p_t(1 - \\mu - \\nu) + \\nu$. This is a linear function of $p_t$. The derivative is constant for all $p_t$:\n$$f'(p_t) = \\frac{d}{dp_t} \\left[ p_t(1 - \\mu - \\nu) + \\nu \\right] = 1 - \\mu - \\nu$$\nTherefore, the stability condition is independent of the equilibrium point $\\hat{p}$ and is simply:\n$$|1 - \\mu - \\nu| < 1$$\nThis inequality is equivalent to $-1 < 1 - \\mu - \\nu < 1$.\n\nWe analyze the two parts of the inequality:\n1) $1 - \\mu - \\nu < 1 \\implies -(\\mu + \\nu) < 0 \\implies \\mu + \\nu > 0$.\n2) $-1 < 1 - \\mu - \\nu \\implies \\mu + \\nu < 2$.\n\nThus, the equilibrium is locally stable if and only if $0 < \\mu + \\nu < 2$.\n\nThe parameters $\\mu$ and $\\nu$ represent mutation probabilities, so they must lie in the interval $[0,1]$. This implies that the sum $\\mu + \\nu$ is always in the interval $[0,2]$.\n\nLet us classify the stability based on the values of $\\mu$ and $\\nu$:\n- If $0 < \\mu + \\nu < 2$: The condition $|1 - \\mu - \\nu| < 1$ is satisfied. The unique equilibrium $\\hat{p} = \\frac{\\nu}{\\mu + \\nu}$ is locally stable. Because the map is linear, this stability is global; any initial frequency $p_0 \\in [0,1]$ will converge to this equilibrium. This covers the case of a single positive mutation rate (e.g., $\\mu>0, \\nu=0$) and the case of two positive mutation rates (e.g., $\\mu>0, \\nu>0$).\n- If $\\mu + \\nu = 0$: This means $\\mu = 0$ and $\\nu = 0$. The derivative is $1 - 0 = 1$. Since $|f'(\\hat{p})| = 1$, all equilibria in the set $[0,1]$ are neutrally stable. This is expected, as there is no force to change the allele frequency.\n- If $\\mu + \\nu = 2$: This occurs only if $\\mu=1$ and $\\nu=1$. The derivative is $1 - 2 = -1$. Since $|f'(\\hat{p})| = 1$, the equilibrium $\\hat{p} = \\frac{1}{1+1} = \\frac{1}{2}$ is neutrally stable. The map becomes $p_{t+1} = 1 - p_t$. Any initial state $p_0 \\neq \\frac{1}{2}$ leads to a persistent oscillation (a 2-cycle) between $p_0$ and $1-p_0$, and does not converge to the equilibrium.\n\nThe problem requests the internal-equilibrium allele frequency. An internal equilibrium is one for which $\\hat{p} \\in (0,1)$. From our analysis, this occurs when both $\\mu > 0$ and $\\nu > 0$. Under these conditions, the equilibrium is $\\hat{p} = \\frac{\\nu}{\\mu+\\nu}$ and it is stable, provided $\\mu+\\nu < 2$.", "answer": "$$\n\\boxed{\\frac{\\nu}{\\mu + \\nu}}\n$$", "id": "2814732"}, {"introduction": "While mutation can act as a directional pressure, evolution in finite populations is also profoundly shaped by random chance. This practice introduces genetic drift, the stochastic fluctuations in allele frequencies arising from the randomness of survival and reproduction. You will work with the Moran model, an elegant continuous-time framework, to derive the rate at which drift generates variation in allele frequencies from one moment to the next [@problem_id:2814741]. Quantifying this variance is essential for understanding the unpredictable path of evolution and the loss of genetic diversity in small populations.", "problem": "In a panmictic haploid population of constant size $N$ with $2$ alleles, $A$ and $a$, consider the neutral Moran model in continuous time. The population state at time $t$ is described by the count $i(t)\\in\\{0,1,\\dots,N\\}$ of allele $A$, and the allele frequency is $p(t)=i(t)/N$. The single-birth–single-death mechanism operates as follows: at each event, exactly one individual reproduces and one individual dies, so that the total population size remains $N$ at all times. Under neutrality, all individuals are exchangeable and are chosen with equal probability when acting as parent or as the individual to be replaced. Assume the event times form a Poisson process that is independent of the population composition and set the time scale so that the expected number of birth–death events in a time interval of length $1$ is $N/2$.\n\nStarting from the foregoing defining properties and without invoking prepackaged diffusion-limit formulas, do the following:\n\n- Describe the transition structure for the allele count $i(t)$ in the infinitesimal time interval $(t,t+\\Delta t]$ under neutrality, and obtain the leading-order probabilities for transitions $i\\to i+1$, $i\\to i-1$, and $i\\to i$ as $\\Delta t\\to 0$.\n- Using these transitions, work with $p(t)=i(t)/N$ to derive the infinitesimal variance of the change in allele frequency per unit time, defined as\n$$\n\\lim_{\\Delta t\\to 0}\\frac{\\operatorname{Var}\\!\\big(p(t+\\Delta t)-p(t)\\mid p(t)=p\\big)}{\\Delta t}.\n$$\n\nExpress your final answer in closed form in terms of $p$ and $N$. Do not approximate or round; provide an exact expression with no units.", "solution": "The problem asks for the derivation of the infinitesimal variance of allele frequency change in a continuous-time neutral Moran model. The problem statement is scientifically grounded, well-posed, and self-contained. It describes a standard model in population genetics with a specific time scaling. I shall proceed with the derivation.\n\nLet the state of the population at time $t$ be described by $i(t)$, the number of individuals carrying allele $A$. The total population size is constant at $N$. The frequency of allele $A$ is $p(t) = i(t)/N$. We are given that the system evolves according to a single-birth–single-death mechanism, where event times follow a Poisson process with a rate $\\lambda$ such that the expected number of events in unit time is $N/2$. Thus, the rate of the Poisson process is $\\lambda = N/2$. In an infinitesimal time interval of length $\\Delta t$, the probability of a single birth-death event is $\\lambda \\Delta t + o(\\Delta t) = \\frac{N}{2} \\Delta t + o(\\Delta t)$, and the probability of more than one event is $o(\\Delta t)$.\n\nFirst, we determine the transition probabilities for the allele count $i$. The state $i$ can change to $i+1$, $i-1$, or remain unchanged. A change in $i$ only occurs if a birth-death event takes place. Under neutrality, any of the $N$ individuals can be chosen to reproduce with probability $1/N$, and any of the $N$ individuals can be chosen to be replaced (die) with probability $1/N$. The choices are independent.\n\nThe number of individuals with allele $A$ is $i$, and with allele $a$ is $N-i$.\n\n1.  **Transition $i \\to i+1$**: This requires an individual with allele $A$ to reproduce and an individual with allele $a$ to be replaced.\n    The probability of choosing an $A$ parent is $i/N$.\n    The probability of choosing an $a$ individual to be replaced is $(N-i)/N$.\n    Given that a birth-death event occurs, the conditional probability of this specific outcome is $\\frac{i}{N} \\times \\frac{N-i}{N} = \\frac{i(N-i)}{N^2}$.\n    The rate of transition from $i$ to $i+1$, denoted $T_{i,i+1}$, is the product of the event rate and this conditional probability:\n    $$T_{i,i+1} = \\lambda \\times \\frac{i(N-i)}{N^2} = \\frac{N}{2} \\times \\frac{i(N-i)}{N^2} = \\frac{i(N-i)}{2N}$$\n    The probability of this transition in $(t, t+\\Delta t]$ is $P(i(t+\\Delta t)=i+1 | i(t)=i) = T_{i,i+1} \\Delta t + o(\\Delta t)$.\n    $$P(i \\to i+1) = \\frac{i(N-i)}{2N}\\Delta t + o(\\Delta t)$$\n\n2.  **Transition $i \\to i-1$**: This requires an individual with allele $a$ to reproduce and an individual with allele $A$ to be replaced.\n    The probability of choosing an $a$ parent is $(N-i)/N$.\n    The probability of choosing an $A$ individual to be replaced is $i/N$.\n    The conditional probability of this outcome, given an event, is $\\frac{N-i}{N} \\times \\frac{i}{N} = \\frac{i(N-i)}{N^2}$.\n    The rate of transition from $i$ to $i-1$, $T_{i,i-1}$, is:\n    $$T_{i,i-1} = \\lambda \\times \\frac{i(N-i)}{N^2} = \\frac{N}{2} \\times \\frac{i(N-i)}{N^2} = \\frac{i(N-i)}{2N}$$\n    The probability of this transition in $(t, t+\\Delta t]$ is:\n    $$P(i \\to i-1) = \\frac{i(N-i)}{2N}\\Delta t + o(\\Delta t)$$\n\n3.  **Transition $i \\to i$**: The count $i$ does not change if no event occurs, or if an event occurs that does not alter the number of $A$ alleles.\n    The probability of no event in $\\Delta t$ is $1 - \\lambda \\Delta t + o(\\Delta t) = 1 - \\frac{N}{2}\\Delta t + o(\\Delta t)$.\n    An event that does not change $i$ occurs when the reproducing and replaced individuals have the same allele type (A-reproduces, A-replaced OR a-reproduces, a-replaced). The total rate of leaving state $i$ is $T_{i,i+1} + T_{i,i-1} = \\frac{i(N-i)}{2N} + \\frac{i(N-i)}{2N} = \\frac{i(N-i)}{N}$.\n    Thus, the probability of remaining in state $i$ is:\n    $$P(i \\to i) = 1 - (T_{i,i+1} + T_{i,i-1})\\Delta t + o(\\Delta t) = 1 - \\frac{i(N-i)}{N}\\Delta t + o(\\Delta t)$$\n\nNow, we derive the infinitesimal variance of the change in allele frequency. Let $p(t) = p$, which implies $i(t) = i = Np$. The change in allele frequency over $(t, t+\\Delta t]$ is $\\Delta p = p(t+\\Delta t) - p(t)$. The corresponding change in the allele count is $\\Delta i = i(t+\\Delta t) - i(t)$, so $\\Delta p = \\Delta i / N$.\n\nFrom our transition probabilities, the possible values for $\\Delta i$ are $+1$, $-1$, and $0$. Consequently, the possible values for $\\Delta p$ are $+1/N$, $-1/N$, and $0$.\nThe quantity we need to compute is:\n$$ \\lim_{\\Delta t\\to 0}\\frac{\\operatorname{Var}\\!\\big(\\Delta p \\mid p(t)=p\\big)}{\\Delta t} $$\nThe variance is defined as $\\operatorname{Var}(\\Delta p) = E[(\\Delta p)^2] - (E[\\Delta p])^2$.\n\nFirst, we compute the expected change in allele frequency, $E[\\Delta p]$.\n$$ E[\\Delta p \\mid i] = \\left(\\frac{1}{N}\\right) P(\\Delta i = +1) + \\left(-\\frac{1}{N}\\right) P(\\Delta i = -1) + (0) P(\\Delta i = 0) $$\n$$ E[\\Delta p \\mid i] = \\frac{1}{N} \\left(\\frac{i(N-i)}{2N}\\Delta t\\right) - \\frac{1}{N} \\left(\\frac{i(N-i)}{2N}\\Delta t\\right) + o(\\Delta t) = 0 \\cdot \\Delta t + o(\\Delta t) = o(\\Delta t) $$\nThis result, that the expected change is zero, is a hallmark of neutral evolution.\nFrom this, $(E[\\Delta p])^2 = (o(\\Delta t))^2 = o(\\Delta t^2)$.\n\nNext, we compute the expected squared change, $E[(\\Delta p)^2]$.\n$$ E[(\\Delta p)^2 \\mid i] = \\left(\\frac{1}{N}\\right)^2 P(\\Delta i = +1) + \\left(-\\frac{1}{N}\\right)^2 P(\\Delta i = -1) + (0)^2 P(\\Delta i = 0) $$\n$$ E[(\\Delta p)^2 \\mid i] = \\frac{1}{N^2} \\left(\\frac{i(N-i)}{2N}\\Delta t\\right) + \\frac{1}{N^2} \\left(\\frac{i(N-i)}{2N}\\Delta t\\right) + o(\\Delta t) $$\n$$ E[(\\Delta p)^2 \\mid i] = \\frac{2}{N^2} \\frac{i(N-i)}{2N}\\Delta t + o(\\Delta t) = \\frac{i(N-i)}{N^3}\\Delta t + o(\\Delta t) $$\n\nNow we can find the variance of $\\Delta p$:\n$$ \\operatorname{Var}(\\Delta p \\mid i) = E[(\\Delta p)^2 \\mid i] - (E[\\Delta p \\mid i])^2 = \\left(\\frac{i(N-i)}{N^3}\\Delta t + o(\\Delta t)\\right) - o(\\Delta t^2) = \\frac{i(N-i)}{N^3}\\Delta t + o(\\Delta t) $$\n\nFinally, we compute the infinitesimal variance per unit time by dividing by $\\Delta t$ and taking the limit as $\\Delta t \\to 0$:\n$$ \\lim_{\\Delta t\\to 0}\\frac{\\operatorname{Var}(\\Delta p \\mid i)}{\\Delta t} = \\lim_{\\Delta t\\to 0}\\frac{\\frac{i(N-i)}{N^3}\\Delta t + o(\\Delta t)}{\\Delta t} = \\lim_{\\Delta t\\to 0}\\left(\\frac{i(N-i)}{N^3} + \\frac{o(\\Delta t)}{\\Delta t}\\right) = \\frac{i(N-i)}{N^3} $$\nThe expression must be in terms of $p$ and $N$. We substitute $i=Np$:\n$$ \\frac{Np(N-Np)}{N^3} = \\frac{N^2p(1-p)}{N^3} = \\frac{p(1-p)}{N} $$\nThis expression represents the instantaneous rate of increase of variance in allele frequency due to genetic drift under the specified Moran model.", "answer": "$$\n\\boxed{\\frac{p(1-p)}{N}}\n$$", "id": "2814741"}, {"introduction": "The ultimate composition of a gene pool reflects a dynamic equilibrium between forces that create variation and forces that remove it. This culminating practice brings together the concepts of mutation and genetic drift to explore this critical balance. Working within the classic Wright–Fisher model, you will analyze how the continuous introduction of new alleles by mutation is counteracted by their random loss through genetic drift [@problem_id:2814725]. The result of your derivation will be a celebrated formula that predicts the equilibrium level of heterozygosity, a direct measure of the genetic variation a population can sustain.", "problem": "A single neutral locus is evolving in a diploid, randomly mating Wright–Fisher population of constant census size $N$ with discrete, non-overlapping generations. Let $\\mu$ denote the per-gene-copy per-generation mutation rate, assumed to be parent-independent and identical across allelic states. Define the expected heterozygosity at generation $t$ as $H_t$, the probability that two ($2$) gene copies sampled at random (with replacement) from generation $t$ carry different allelic states.\n\nYou will consider two mutation models:\n\n- The infinite-alleles model, in which each mutation creates an allelic state never before present in the population.\n- The symmetric finite-$K$ alleles model, in which there are exactly $K$ allelic states, and each mutation changes an allele into one of the $K-1$ other states with equal probability $1/(K-1)$.\n\nTasks:\n\n(a) Precisely formalize the two models above in terms of how mutation acts on allelic states. Carefully state the consequences for whether mutation can create identity-by-state from initially different alleles.\n\n(b) Using only the sampling structure of the Wright–Fisher model, the law of total probability, and the definition of $H_t$, derive first-order recursions for $H_{t+1}$ in terms of $H_t$ under each model. Work to first order in small quantities and explicitly drop all terms of order $\\mu^2$, $(1/N)^2$, and $\\mu/N$ (diffusion-limit scaling), while keeping terms of order $\\mu$ and $1/N$.\n\n(c) Under the infinite-alleles model, solve your recursion for its unique internal fixed point $H^{\\ast}$ (i.e., the equilibrium expected heterozygosity). Provide your final answer as a closed-form analytic expression in terms of $N$ and $\\mu$. No numerical approximation or rounding is required. Your final answer must be a single expression.", "solution": "The problem will be addressed in three parts as specified. The analysis relies on the fundamental principles of the Wright-Fisher model, including genetic drift and mutation.\n\n(a) Formalization of Mutation Models\n\nThe action of mutation describes the probability that a gene copy with a given allelic state transitions to another state. Let us denote the allelic state of a gene by an index.\n\nIn the infinite-alleles model (IAM), the set of possible allelic states is countably infinite. Each mutation event is assumed to produce a novel allele that has never existed in the population before. If we consider two gene lineages with different allelic states, say state $i$ and state $j$ where $i \\neq j$, a mutation in the first lineage will change its state from $i$ to $k$, where $k$ is a new state not equal to $i$ or $j$ (or any other state present in the population). Similarly, a mutation in the second lineage from state $j$ will produce a new state $l$ where $l \\neq j$ and $l \\neq i$. Consequently, it is impossible for mutation to make two initially different alleles identical by state. Mutation, in the IAM, is a purely diversifying force that can only destroy identity, never create it.\n\nIn the symmetric finite-$K$ alleles model, there exists a fixed, finite set of $K$ possible allelic states. A gene copy in a particular state, say $A_i$, mutates with a total rate of $\\mu$ per generation. Upon mutation, it transitions to any of the other $K-1$ states with equal probability. The probability of a specific transition from state $A_i$ to state $A_j$ (where $j \\neq i$) is therefore $\\frac{\\mu}{K-1}$. In this model, if we consider two gene lineages with different allelic states, $A_i$ and $A_j$, it is possible for the first lineage to mutate from $A_i$ to $A_j$, or for the second to mutate from $A_j$ to $A_i$. Thus, unlike the IAM, mutation in the symmetric finite-$K$ alleles model can create identity-by-state from non-identical alleles.\n\n(b) Derivation of Recursions for Expected Heterozygosity\n\nLet $H_t$ be the expected heterozygosity at generation $t$, defined as the probability that $2$ gene copies sampled at random with replacement from generation $t$ have different allelic states. We want to find a recursion for $H_{t+1}$ in terms of $H_t$.\n\nWe consider $2$ gene copies sampled at random from generation $t+1$. According to the sampling structure of the Wright-Fisher model, these $2$ copies trace back to ancestral gene copies in generation $t$. There are $2$ possibilities for their ancestry:\n1. They descend from the very same ancestral gene copy in generation $t$. This occurs with probability $\\frac{1}{2N}$.\n2. They descend from $2$ different ancestral gene copies in generation $t$. This occurs with probability $1 - \\frac{1}{2N}$.\n\nWe use the law of total probability to write $H_{t+1}$:\n$$H_{t+1} = P(\\text{different at } t+1 \\mid \\text{1 ancestor}) \\cdot \\frac{1}{2N} + P(\\text{different at } t+1 \\mid \\text{2 ancestors}) \\cdot \\left(1 - \\frac{1}{2N}\\right)$$\n\nLet's analyze the conditional probabilities.\n\nFirst, consider the case of a single common ancestor. The $2$ descendant copies at $t+1$ will be different only if at least one of them mutates and they do not end up being the same state. The probability that they are identical is the probability that neither mutates, which is $(1-\\mu)^2$, plus the probability that both mutate to the same state, which is of order $\\mu^2$. To first order in $\\mu$, the probability of being identical is $(1-\\mu)^2 \\approx 1 - 2\\mu$. Therefore, the probability of being different is:\n$$P(\\text{different at } t+1 \\mid \\text{1 ancestor}) \\approx 1 - (1 - 2\\mu) = 2\\mu$$\n\nSecond, consider the case of $2$ distinct ancestors. These $2$ ancestral copies from generation $t$ were themselves different with probability $H_t$ or identical with probability $1-H_t$. We can again use the law of total probability:\n$$P(\\text{different at } t+1 \\mid \\text{2 ancestors}) = P(\\text{diff at } t+1 \\mid \\text{ancestors diff})H_t + P(\\text{diff at } t+1 \\mid \\text{ancestors same})(1-H_t)$$\nIf the $2$ ancestors had the same allelic state, the situation is identical to having a single common ancestor. So, $P(\\text{diff at } t+1 \\mid \\text{ancestors same}) \\approx 2\\mu$.\n\nIf the $2$ ancestors had different allelic states, their descendants will be different unless a mutation event occurs that makes them identical. The probability of them remaining different is $1$ minus the probability of them becoming identical. To first order in $\\mu$, they can become identical only if one mutates into the state of the other, while the other does not mutate. This event has a probability of order $\\mu$. We analyze this for each model:\n-   **Infinite-alleles model (IAM):** As established in (a), mutation cannot create identity from non-identity. Thus, if the ancestors are different, their non-mutated or mutated descendants will always be different.\n    $$P(\\text{different at } t+1 \\mid \\text{ancestors diff}) = 1$$\n-   **Symmetric finite-$K$ alleles model:** If the ancestors are in states $A_i$ and $A_j$ ($i \\neq j$), the descendants can become identical if the first copy mutates from $A_i$ to $A_j$ (probability $\\frac{\\mu}{K-1}$) while the second does not mutate (probability $1-\\mu$), or if the second mutates from $A_j$ to $A_i$ (probability $\\frac{\\mu}{K-1}$) while the first does not mutate (probability $1-\\mu$). Ignoring terms of order $\\mu^2$, the probability of becoming identical is $\\frac{\\mu}{K-1} + \\frac{\\mu}{K-1} = \\frac{2\\mu}{K-1}$.\n    $$P(\\text{different at } t+1 \\mid \\text{ancestors diff}) \\approx 1 - \\frac{2\\mu}{K-1}$$\n\nNow we can write the expression for $P(\\text{different at } t+1 \\mid \\text{2 ancestors})$ for each model:\n-   **IAM:** $P(\\text{diff} \\mid \\text{2 ancestors}) \\approx (1) \\cdot H_t + (2\\mu) \\cdot (1-H_t) = H_t + 2\\mu(1-H_t)$.\n-   **K-alleles model:** $P(\\text{diff} \\mid \\text{2 ancestors}) \\approx \\left(1 - \\frac{2\\mu}{K-1}\\right) H_t + (2\\mu)(1-H_t) = H_t - \\frac{2\\mu H_t}{K-1} + 2\\mu - 2\\mu H_t = H_t\\left(1 - \\frac{2\\mu K}{K-1}\\right) + 2\\mu$.\n\nFinally, we substitute these into the full recursion for $H_{t+1}$.\n$$H_{t+1} \\approx (2\\mu)\\frac{1}{2N} + \\left(1-\\frac{1}{2N}\\right) P(\\text{diff} \\mid \\text{2 ancestors}) = \\frac{\\mu}{N} + P(\\text{diff} \\mid \\text{2 ancestors}) - \\frac{1}{2N} P(\\text{diff} \\mid \\text{2 ancestors})$$\nAs per the instruction, we drop terms of order $\\mu/N$. The term $\\frac{\\mu}{N}$ is dropped. In the last term, $P(\\text{diff} \\mid \\text{2 ancestors})$ is of the form $H_t + O(\\mu)$, so $\\frac{1}{2N}P(\\text{diff} \\mid \\text{2 ancestors}) = \\frac{H_t}{2N} + O(\\frac{\\mu}{N})$. We drop the $O(\\frac{\\mu}{N})$ part.\nThe recursion simplifies to:\n$$H_{t+1} \\approx P(\\text{diff} \\mid \\text{2 ancestors}) - \\frac{H_t}{2N}$$\n\nSubstituting the model-specific expressions:\n-   **Infinite-alleles model recursion:**\n    $$H_{t+1} \\approx [H_t + 2\\mu(1-H_t)] - \\frac{H_t}{2N} = H_t + 2\\mu - 2\\mu H_t - \\frac{H_t}{2N}$$\n    $$H_{t+1} = H_t\\left(1 - \\frac{1}{2N} - 2\\mu\\right) + 2\\mu$$\n-   **Symmetric finite-$K$ alleles model recursion:**\n    $$H_{t+1} \\approx \\left[H_t\\left(1 - \\frac{2\\mu K}{K-1}\\right) + 2\\mu\\right] - \\frac{H_t}{2N}$$\n    $$H_{t+1} = H_t\\left(1 - \\frac{1}{2N} - \\frac{2\\mu K}{K-1}\\right) + 2\\mu$$\n\n(c) Equilibrium Heterozygosity under the Infinite-Alleles Model\n\nTo find the equilibrium expected heterozygosity, denoted $H^*$, we set $H_{t+1} = H_t = H^*$ in the recursion derived for the infinite-alleles model.\n$$H^* = H^*\\left(1 - \\frac{1}{2N} - 2\\mu\\right) + 2\\mu$$\nWe solve for $H^*$:\n$$H^* - H^*\\left(1 - \\frac{1}{2N} - 2\\mu\\right) = 2\\mu$$\n$$H^*\\left(1 - \\left(1 - \\frac{1}{2N} - 2\\mu\\right)\\right) = 2\\mu$$\n$$H^*\\left(\\frac{1}{2N} + 2\\mu\\right) = 2\\mu$$\n$$H^* = \\frac{2\\mu}{\\frac{1}{2N} + 2\\mu}$$\nTo obtain a more standard form, we multiply the numerator and the denominator by $2N$:\n$$H^* = \\frac{2\\mu \\cdot 2N}{\\left(\\frac{1}{2N} + 2\\mu\\right) \\cdot 2N} = \\frac{4N\\mu}{1 + 4N\\mu}$$\nThis is the closed-form analytic expression for the equilibrium expected heterozygosity under the infinite-alleles model, often expressed in terms of the population-scaled mutation rate $\\theta = 4N\\mu$ as $H^* = \\frac{\\theta}{1+\\theta}$.", "answer": "$$\\boxed{\\frac{4N\\mu}{1 + 4N\\mu}}$$", "id": "2814725"}]}