{"hands_on_practices": [{"introduction": "The foundation of genetic mapping lies in converting the frequency of recombinant offspring into a measure of distance between genes. This conversion is not arbitrary; it is rooted in a probabilistic model of how crossovers occur during meiosis. This foundational exercise [@problem_id:2798154] asks you to derive the relationship between the expected number of crossovers, or genetic length $g$, and the probability of observing at least one crossover, which directly leads to the observable recombination. By employing the Poisson process, a standard model for random events, you will build from scratch one of the most fundamental equations in theoretical genetics, first derived by J.B.S. Haldane.", "problem": "A heterozygote for a paracentric chromosomal inversion carries an inverted segment of genetic map length $g$ measured in Morgans, where $1$ Morgan corresponds to an expected one crossover per meiosis over that map distance. To approximate the meiotic consequences of the inversion, adopt the standard model that crossovers along the genetic map occur as points of a homogeneous Poisson process in genetic length, with independent increments and a constant rate of $1$ per Morgan.\n\nUsing only the defining properties of a homogeneous Poisson process and the interpretation of genetic length as expected crossover number, derive an explicit closed-form expression, as a function of $g$, for the probability that at least one crossover occurs within the inverted segment in a single meiosis.\n\nProvide your final answer as a single simplified analytic expression in $g$. No numerical approximation is required.", "solution": "The problem statement has been subjected to rigorous validation and is deemed valid. It is scientifically grounded, well-posed, and objective. All necessary information for a unique, meaningful solution is provided. The problem requests the derivation of a probability based on a standard and well-defined stochastic model in genetics—the modeling of genetic crossovers using a homogeneous Poisson process.\n\nLet $N$ be the random variable representing the number of crossovers that occur within the inverted chromosomal segment. The length of this segment is given as a genetic map length of $g$ Morgans.\n\nThe problem states that crossovers along the genetic map are modeled as a homogeneous Poisson process with a constant rate. The rate of this process, $\\lambda$, is the expected number of events (crossovers) per unit of length (Morgan). The definition of genetic map length in Morgans is precisely the expected number of crossovers per meiosis. Therefore, a length of $1$ Morgan corresponds to an expected value of $1$ crossover. This directly implies that the rate of the Poisson process is $\\lambda = 1$ crossover per Morgan.\n\nFor a homogeneous Poisson process with rate $\\lambda$ over an interval of length $L$, the number of events $N$ in that interval follows a Poisson distribution with parameter (mean) $\\mu = \\lambda L$. In this problem, the \"interval\" is the genetic segment of length $g$ Morgans. Thus, we have $L = g$ and $\\lambda = 1$.\n\nThe parameter of the Poisson distribution for the number of crossovers $N$ in the segment of length $g$ is:\n$$ \\mu = \\lambda \\times g = 1 \\times g = g $$\nThis result is consistent with the fundamental definition of genetic distance in Morgans.\n\nThe probability mass function (PMF) for a Poisson-distributed random variable $N$ with mean $\\mu = g$ is given by:\n$$ P(N=k) = \\frac{\\mu^k \\exp(-\\mu)}{k!} = \\frac{g^k \\exp(-g)}{k!} $$\nwhere $k$ is a non-negative integer ($k=0, 1, 2, \\ldots$) representing the number of crossovers.\n\nThe problem asks for the probability that *at least one* crossover occurs within the inverted segment. This is the probability $P(N \\geq 1)$. It is more direct to calculate this using the complement event, which is the probability that *zero* crossovers occur, $P(N=0)$.\n$$ P(N \\geq 1) = 1 - P(N=0) $$\nWe can find $P(N=0)$ by substituting $k=0$ into the Poisson PMF:\n$$ P(N=0) = \\frac{g^0 \\exp(-g)}{0!} $$\nBy mathematical definition, any non-zero number raised to the power of $0$ is $1$ (i.e., $g^0 = 1$ for $g  0$; the case $g=0$ is trivial, yielding a probability of $0$), and the factorial of $0$ is also $1$ (i.e., $0! = 1$). Therefore, the expression simplifies to:\n$$ P(N=0) = \\frac{1 \\cdot \\exp(-g)}{1} = \\exp(-g) $$\nThis is the probability of observing no crossovers in a segment of length $g$ Morgans.\n\nFinally, substituting this result back into the expression for the complement gives the probability of at least one crossover:\n$$ P(N \\geq 1) = 1 - \\exp(-g) $$\nThis is the required explicit closed-form expression for the probability of at least one crossover within the inverted segment, expressed as a function of its genetic map length $g$. This function is also known as the mapping function of J.B.S. Haldane, which relates genetic distance to recombination frequency under the assumption of no interference.", "answer": "$$\\boxed{1 - \\exp(-g)}$$", "id": "2798154"}, {"introduction": "While theoretical models provide the framework, geneticists work with finite experimental data. This practice [@problem_id:2845266] bridges the gap between theory and application by guiding you through the statistical inference of genetic distance from progeny counts. You will use the powerful method of maximum likelihood to derive the best estimate for the recombination fraction $\\hat{r}$ and the corresponding map distance $\\hat{d}$, and, critically, you will use large-sample theory to derive a measure of uncertainty—the standard error—for your distance estimate.", "problem": "A diploid organism heterozygous at two codominant loci is crossed to a homozygous recessive tester, and the genotypes of the resulting progeny are scored so that recombinant and nonrecombinant gametes contributed by the heterozygote can be unambiguously identified. Suppose that in a sample of $n = 1000$ independent progeny, $k = 150$ are recombinant between the two loci.\n\nAssume the following fundamental base:\n- Each progeny reflects a single meiotic product from the heterozygote, and for each meiosis the recombinant indicator is a Bernoulli random variable with parameter equal to the recombination fraction $r \\in (0, \\tfrac{1}{2})$.\n- Under the classical no-interference model of crossover formation (Haldane model), crossovers along the interval between the two loci on a bivalent follow a homogeneous Poisson process, and, in the absence of chromatid interference, a focal chromatid participates independently in each crossover with probability $1/2$.\n- Map distance $d$ is measured in Morgans, with $1$ Morgan equal to $100$ centimorgans (cM). A chromatid is recombinant with respect to the two loci if and only if it experiences an odd number of crossovers in the interval.\n\nStarting from these assumptions and without invoking any pre-packaged mapping-function identities, do the following:\n1. Write down the likelihood for $r$ under the Bernoulli sampling model and derive the maximum likelihood estimator $\\hat{r}$.\n2. Using the Poisson model for crossovers and the definition of recombination above, derive the functional relationship connecting $r$ and $d$, and invert it to express $d$ as a function of $r$. Use this to obtain $\\hat{d}$.\n3. Using large-sample likelihood theory and an appropriate transformation argument, derive an explicit expression for the asymptotic standard error of $\\hat{d}$ in Morgans in terms of $n$ and $r$, and then evaluate it at $\\hat{r}$. Finally, convert this standard error to centimorgans.\n\nReport the numerical value of the asymptotic standard error of $\\hat{d}$ in centimorgans. Round your answer to four significant figures. Express the final answer in cM.", "solution": "The problem statement is subjected to validation.\n\nGivens are extracted verbatim:\n- A diploid organism heterozygous at two codominant loci is crossed to a homozygous recessive tester.\n- Sample size: $n = 1000$ independent progeny.\n- Number of recombinants: $k = 150$.\n- Each progeny is a single meiotic product.\n- The recombinant indicator is a Bernoulli random variable with parameter $r \\in (0, \\tfrac{1}{2})$.\n- Crossovers follow a homogeneous Poisson process (Haldane model).\n- A chromatid participates in a crossover with probability $1/2$ (no chromatid interference).\n- Map distance $d$ is in Morgans; $1$ Morgan $= 100$ cM.\n- A chromatid is recombinant if it experiences an odd number of crossovers.\n\nThe problem is evaluated against validation criteria:\n- **Scientific Grounding**: The problem is based on fundamental, established principles of classical genetics and statistical inference (linkage analysis, Haldane's mapping function, maximum likelihood estimation, delta method). The model is a cornerstone of theoretical genetics.\n- **Well-Posedness**: The problem is well-defined, with all necessary parameters and assumptions provided to derive a unique, meaningful solution.\n- **Objectivity**: The language is precise, technical, and free of subjective content.\n\nThe problem is found to be scientifically sound, complete, and unambiguous. It is a standard exercise in theoretical genetics and statistics. Therefore, it is valid, and we proceed to the solution.\n\nThe task is divided into three parts.\n\n**Part 1: Likelihood and Maximum Likelihood Estimator for $r$**\n\nThe experiment consists of sampling $n = 1000$ independent meiotic products. Each product is either recombinant with probability $r$ or non-recombinant with probability $1-r$. This constitutes a sequence of $n$ Bernoulli trials. The total number of observed recombinants, $k$, follows a binomial distribution. The probability of observing $k$ recombinants in a sample of size $n$ is given by:\n$$\nP(K=k | n, r) = \\binom{n}{k} r^k (1-r)^{n-k}\n$$\nThe likelihood function $L(r)$ is proportional to this probability. We write it as:\n$$\nL(r) = \\binom{n}{k} r^k (1-r)^{n-k}\n$$\nTo find the maximum likelihood estimator (MLE) $\\hat{r}$, we maximize $L(r)$. It is computationally simpler to maximize the log-likelihood function, $\\ell(r) = \\ln L(r)$:\n$$\n\\ell(r) = \\ln\\left(\\binom{n}{k}\\right) + k \\ln(r) + (n-k) \\ln(1-r)\n$$\nWe differentiate $\\ell(r)$ with respect to $r$ and set the derivative to zero:\n$$\n\\frac{d\\ell(r)}{dr} = \\frac{k}{r} - \\frac{n-k}{1-r} = 0\n$$\nSolving for $r$:\n$$\n\\frac{k}{r} = \\frac{n-k}{1-r} \\implies k(1-r) = r(n-k) \\implies k - kr = nr - kr \\implies k = nr\n$$\nThis gives the maximum likelihood estimator for the recombination fraction $r$:\n$$\n\\hat{r} = \\frac{k}{n}\n$$\nGiven $k = 150$ and $n = 1000$, the estimate is:\n$$\n\\hat{r} = \\frac{150}{1000} = 0.15\n$$\n\n**Part 2: Relationship between Recombination Fraction $r$ and Map Distance $d$**\n\nMap distance $d$ in Morgans is defined as the expected number of crossovers per single chromatid over the interval of interest. Under the standard model where crossovers on the bivalent (the structure containing four chromatids) are considered, the mean number of crossovers for the entire bivalent is $2d$. Let $X$ be the random variable for the number of crossovers on the bivalent. According to the Haldane model, $X$ follows a Poisson distribution with mean $2d$:\n$$\nX \\sim \\text{Poisson}(2d), \\quad P(X=x) = \\frac{\\exp(-2d)(2d)^x}{x!} \\quad \\text{for } x = 0, 1, 2, \\ldots\n$$\nA given chromatid is recombinant if it is involved in an odd number of crossovers. With no chromatid interference, a chromatid participates in any given crossover with probability $1/2$. If there are $x$ crossovers on the bivalent, the number of times our focal chromatid is involved follows a binomial distribution $\\text{Binomial}(x, 1/2)$. The probability of it being involved in an odd number of crossovers, given $x$ total crossovers, is $0$ if $x=0$, and $1/2$ if $x > 0$.\n\nThe recombination fraction $r$ is the overall probability of a chromatid being recombinant. We find this by conditioning on the number of crossovers $X$:\n$$\nr = P(\\text{recombinant}) = \\sum_{x=0}^{\\infty} P(\\text{recombinant} | X=x) P(X=x)\n$$\n$$\nr = P(\\text{recombinant} | X=0) P(X=0) + \\sum_{x=1}^{\\infty} P(\\text{recombinant} | X=x) P(X=x)\n$$\n$$\nr = (0) \\cdot P(X=0) + \\sum_{x=1}^{\\infty} \\left(\\frac{1}{2}\\right) P(X=x) = \\frac{1}{2} \\sum_{x=1}^{\\infty} P(X=x)\n$$\nSince $\\sum_{x=0}^{\\infty} P(X=x) = 1$, we have $\\sum_{x=1}^{\\infty} P(X=x) = 1 - P(X=0)$. Thus:\n$$\nr = \\frac{1}{2} (1 - P(X=0))\n$$\nFor a Poisson distribution with mean $2d$, $P(X=0) = \\exp(-2d)$. Substituting this in gives the Haldane mapping function:\n$$\nr = \\frac{1}{2} (1 - \\exp(-2d))\n$$\nWe must invert this function to express distance $d$ in terms of recombination fraction $r$:\n$$\n2r = 1 - \\exp(-2d) \\implies \\exp(-2d) = 1 - 2r \\implies -2d = \\ln(1-2r)\n$$\n$$\nd(r) = -\\frac{1}{2} \\ln(1 - 2r)\n$$\nBy the invariance property of maximum likelihood estimators, the MLE for $d$ is:\n$$\n\\hat{d} = d(\\hat{r}) = -\\frac{1}{2} \\ln(1 - 2\\hat{r})\n$$\n\n**Part 3: Asymptotic Standard Error of $\\hat{d}$**\n\nWe use the delta method to find the asymptotic variance of $\\hat{d}$. The formula is:\n$$ \\text{Var}(\\hat{d}) \\approx \\left(\\frac{d(d)}{dr}\\bigg|_{r=\\hat{r}}\\right)^2 \\text{Var}(\\hat{r}) $$\nFirst, we find the large-sample variance of $\\hat{r}$. The Fisher information for a single Bernoulli trial is $1/(r(1-r))$. For $n$ trials, it is $I(r) = n/(r(1-r))$. The asymptotic variance of $\\hat{r}$ is the inverse of the Fisher information:\n$$\n\\text{Var}(\\hat{r}) \\approx \\frac{1}{I(r)} = \\frac{r(1-r)}{n}\n$$\nNext, we find the derivative of $d(r)$:\n$$ \\frac{d(d)}{dr} = \\frac{d}{dr}\\left(-\\frac{1}{2} \\ln(1-2r)\\right) = -\\frac{1}{2} \\cdot \\frac{1}{1-2r} \\cdot (-2) = \\frac{1}{1-2r} $$\nNow we combine these results to find the asymptotic variance of $\\hat{d}$:\n$$\n\\text{Var}(\\hat{d}) \\approx \\left(\\frac{1}{1-2r}\\right)^2 \\frac{r(1-r)}{n} = \\frac{r(1-r)}{n(1-2r)^2}\n$$\nThe asymptotic standard error of $\\hat{d}$ is the square root of the variance:\n$$\n\\text{SE}(\\hat{d}) = \\sqrt{\\frac{r(1-r)}{n(1-2r)^2}} = \\frac{\\sqrt{r(1-r)}}{(1-2r)\\sqrt{n}}\n$$\nWe evaluate this expression at the MLE $\\hat{r} = 0.15$ with $n = 1000$:\n$$\n\\widehat{\\text{SE}}(\\hat{d}) = \\frac{\\sqrt{0.15(1-0.15)}}{(1-2(0.15))\\sqrt{1000}} = \\frac{\\sqrt{0.15 \\cdot 0.85}}{(1-0.3)\\sqrt{1000}} = \\frac{\\sqrt{0.1275}}{0.7\\sqrt{1000}}\n$$\nCalculating the numerical value:\n$$\n\\widehat{\\text{SE}}(\\hat{d}) \\approx \\frac{0.3570714}{0.7 \\cdot 31.622777} \\approx \\frac{0.3570714}{22.135944} \\approx 0.0161313 \\text{ Morgans}\n$$\nThe problem requires the standard error in centimorgans (cM). We use the conversion $1$ Morgan $= 100$ cM:\n$$\n\\widehat{\\text{SE}}(\\hat{d})_{\\text{cM}} = \\widehat{\\text{SE}}(\\hat{d})_{\\text{Morgans}} \\times 100 \\approx 0.0161313 \\times 100 = 1.61313 \\text{ cM}\n$$\nRounding to four significant figures, we get $1.613$ cM.", "answer": "$$\\boxed{1.613}$$", "id": "2845266"}, {"introduction": "\"All models are wrong, but some are useful.\" This principle is especially true in genetics, where simple mapping functions often ignore complex biological phenomena like crossover interference. This computational practice [@problem_id:2845250] delves into the crucial topic of model robustness, challenging you to quantify the bias that arises when a simple model (like Haldane's or Kosambi's) is used to interpret data generated from a more realistic process that includes interference. Mastering this analysis provides insight into the practical limitations and strengths of different genetic mapping approaches.", "problem": "You are to implement a complete, deterministic program that evaluates the robustness of distance inference under mapping function misspecification in the presence of crossover interference. The program must compute, for a set of test cases, how two widely used mapping functions infer genetic distances from an observed recombination fraction when the true recombination fraction is generated by a different, interfering crossover process. The core definitions are as follows. A genetic interval has true genetic distance $d$ in Morgans (M), where $1$ Morgan corresponds to an expected number of $1$ crossover per meiosis on a chromatid. The unit centimorgan (cM) is defined so that $100$ centimorgan equals $1$ Morgan. The recombination fraction $r(d)$ is the probability that meiosis produces a recombinant chromatid for the two loci delimiting the interval, equivalently the probability of an odd number of crossovers in the interval. A mapping function is an invertible relationship between $r$ and $d$. The Haldane mapping function assumes crossovers on a chromatid are a Poisson renewal with no interference. The Kosambi mapping function assumes positive interference with a specific local dependence structure. In this task, the “true” recombination fraction will be generated from the chi-square interference model (also called the counting model) with integer interference parameter $m \\in \\{0,1,2,\\dots\\}$, in which inter-crossover distances on a chromatid are Erlang distributed with shape $m+1$ and mean $1$ Morgan. For each test case, the program must do all of the following steps:\n- Convert the provided true distance $d_{\\mathrm{true}}$ in centimorgans (cM) to Morgans (M) using $d_{\\mathrm{M}} = d_{\\mathrm{true}}/100$.\n- Compute the “true” recombination fraction $r_{\\mathrm{true}}$ under the chi-square interference model with parameter $m$ as the probability of an odd number of crossovers in an interval of length $d_{\\mathrm{M}}$.\n- Using only the observed $r_{\\mathrm{true}}$, compute two inferred distances by inverting the Haldane mapping function and the Kosambi mapping function, respectively, to obtain $\\widehat{d}_{\\mathrm{H}}$ and $\\widehat{d}_{\\mathrm{K}}$ in Morgans.\n- Convert these inferred distances to centimorgans, and report their biases relative to $d_{\\mathrm{true}}$ as $b_{\\mathrm{H}} = 100\\,\\widehat{d}_{\\mathrm{H}} - d_{\\mathrm{true}}$ and $b_{\\mathrm{K}} = 100\\,\\widehat{d}_{\\mathrm{K}} - d_{\\mathrm{true}}$ in centimorgans.\n- Report the triple $[r_{\\mathrm{true}}, b_{\\mathrm{H}}, b_{\\mathrm{K}}]$.\n\nAll probabilities must be expressed as decimals, not as percentages. All distances and biases must be expressed in centimorgans (cM). Your program must round each reported value to exactly $6$ decimal places.\n\nTest suite. Your program must evaluate the following test cases, specified as ordered pairs $(d_{\\mathrm{true}} \\text{ (cM)}, m)$:\n- Case 1: $(0.5, 0)$,\n- Case 2: $(10.0, 1)$,\n- Case 3: $(40.0, 5)$,\n- Case 4: $(90.0, 1)$,\n- Case 5: $(2.0, 10)$.\n\nFinal output format. Your program should produce a single line of output that is a comma-separated list enclosed in square brackets, where each element is itself a $3$-element list in the order of the test suite, namely $[r_{\\mathrm{true}}, b_{\\mathrm{H}}, b_{\\mathrm{K}}]$ for each case. For example, the output must look like\n$[[x_1, y_1, z_1], [x_2, y_2, z_2], \\dots]$\nwith each number rounded to exactly $6$ decimal places and no additional whitespace or text.\n\nScientific realism, fundamental base, and constraints. You must start from the fundamental definition that the recombination fraction equals the probability of an odd number of crossovers in the interval, and that a mapping function provides an invertible relationship between $r$ and $d$. The chi-square interference model must be used to generate $r_{\\mathrm{true}}$ from $d_{\\mathrm{M}}$ and $m$ via a mathematically exact expression valid for integer $m \\ge 0$. The Haldane and Kosambi mappings must be used only to invert from the observed $r_{\\mathrm{true}}$ to inferred distances. No user input is allowed; the program must run as-is and print only the required single line in the specified format.", "solution": "The problem statement is subjected to rigorous validation before any attempt at a solution is made.\n\n**Step 1: Extract Givens**\n\n- **Core Definitions**:\n    - Genetic distance $d$ in Morgans ($\\mathrm{M}$) or centimorgans ($\\mathrm{cM}$), with $100\\,\\mathrm{cM} = 1\\,\\mathrm{M}$.\n    - Recombination fraction $r(d)$ is the probability of an odd number of crossovers.\n    - A mapping function is an invertible relationship between $r$ and $d$.\n- **True Crossover Process**:\n    - The chi-square interference model with an integer interference parameter $m \\in \\{0, 1, 2, \\dots\\}$.\n    - Inter-crossover distances on a chromatid are Erlang distributed with shape $m+1$ and mean $1$ Morgan.\n- **Inference Models**:\n    - Haldane mapping function (no interference).\n    - Kosambi mapping function (positive interference).\n- **Computational Task**:\n    1.  Convert true distance $d_{\\mathrm{true}}$ in $\\mathrm{cM}$ to Morgans: $d_{\\mathrm{M}} = d_{\\mathrm{true}}/100$.\n    2.  Compute the true recombination fraction $r_{\\mathrm{true}}$ from $d_{\\mathrm{M}}$ and $m$ using the chi-square model.\n    3.  Invert the Haldane and Kosambi mapping functions using $r_{\\mathrm{true}}$ to find inferred distances $\\widehat{d}_{\\mathrm{H}}$ and $\\widehat{d}_{\\mathrm{K}}$ in Morgans.\n    4.  Calculate biases in $\\mathrm{cM}$: $b_{\\mathrm{H}} = 100\\,\\widehat{d}_{\\mathrm{H}} - d_{\\mathrm{true}}$ and $b_{\\mathrm{K}} = 100\\,\\widehat{d}_{\\mathrm{K}} - d_{\\mathrm{true}}$.\n    5.  Report the triple $[r_{\\mathrm{true}}, b_{\\mathrm{H}}, b_{\\mathrm{K}}]$.\n- **Numerical and Formatting Requirements**:\n    - All reported values must be rounded to exactly $6$ decimal places.\n    - The final output must be a single line: a list of lists, e.g., $[[x_1, y_1, z_1], [x_2, y_2, z_2], \\dots]$.\n- **Test Suite**:\n    - Case $1$: $(d_{\\mathrm{true}} = 0.5, m = 0)$\n    - Case $2$: $(d_{\\mathrm{true}} = 10.0, m = 1)$\n    - Case $3$: $(d_{\\mathrm{true}} = 40.0, m = 5)$\n    - Case $4$: $(d_{\\mathrm{true}} = 90.0, m = 1)$\n    - Case $5$: $(d_{\\mathrm{true}} = 2.0, m = 10)$\n\n**Step 2: Validate Using Extracted Givens**\n\n- **Scientifically Grounded**: The problem is based on fundamental and canonical models of genetic recombination theory, including the Haldane, Kosambi, and chi-square models of crossover interference. These are standard tools in theoretical genetics.\n- **Well-Posed**: The problem is well-posed. Each step of the required computation is clearly defined. The inputs are specified, and the required outputs are unambiguous. The mathematical functions involved are well-defined and invertible in the relevant domain. A unique, stable solution exists for each test case.\n- **Objective**: The problem uses precise, objective, and standard terminology from genetics and mathematics. It is free from subjective or opinion-based statements.\n- **Completeness and Consistency**: The problem statement is self-contained and internally consistent. It requires the use of \"a mathematically exact expression\" for the chi-square model. While this expression is not provided, a standard formulation exists in the literature that is derived from the given premises. This formulation relates the recombination fraction $r$ to the map distance $d$ (in Morgans) and the interference parameter $m$. The consistency is confirmed by noting that for $m=0$, the chi-square model should and does reduce to the Haldane model of no interference.\n\n**Step 3: Verdict and Action**\n\nThe problem is **valid**. It is a sound, well-defined computational problem in theoretical genetics. A complete, reasoned solution will be provided.\n\nThe task is to quantify the error, or bias, in genetic distance estimation when the mapping function is misspecified. The true genetic process follows a chi-square model of crossover interference, but a geneticist infers distance using simpler models that assume either no interference (Haldane) or a different form of interference (Kosambi). The procedure is purely computational and relies on the exact mathematical definitions of these models.\n\nLet us define the fundamental quantities. The true genetic distance, denoted $d_{\\mathrm{true}}$, is provided in centimorgans ($\\mathrm{cM}$). This must be converted to Morgans ($\\mathrm{M}$) for all calculations, using the relation $d_{\\mathrm{M}} = d_{\\mathrm{true}}/100$. The Morgan unit defines the map distance as the expected number of crossovers on a single chromatid in the interval.\n\nThe 'true' recombination fraction, $r_{\\mathrm{true}}$, is generated by the chi-square interference model with a given integer parameter $m \\ge 0$. This model posits a specific form of positive crossover interference, where one crossover event suppresses the formation of another nearby. For a map distance $d_{\\mathrm{M}}$, the recombination fraction is given by the probability of an odd number of crossovers. Under the standard formulation of the chiasma-based chi-square model, this is expressed as:\n$$r_{\\mathrm{true}}(d_{\\mathrm{M}}, m) = \\frac{1}{2}\\left(1 - e^{-2 d_{\\mathrm{M}}} \\sum_{j=0}^{m} \\frac{(2 d_{\\mathrm{M}})^j}{j!}\\right)$$\nHere, the case $m=0$ corresponds to no interference, and the model reduces to the Haldane model, where crossovers follow a Poisson process. As $m$ increases, the strength of interference increases, meaning crossovers are more evenly spaced.\n\nGiven $r_{\\mathrm{true}}$ as the only 'observed' data, we must infer the distance using two alternative mapping functions.\n\n$1$. The Haldane mapping function assumes no interference ($m=0$). The relationship between distance $d$ and recombination fraction $r$ is:\n$$r_{\\mathrm{H}}(d) = \\frac{1}{2}(1 - e^{-2d})$$\nTo infer the distance $\\widehat{d}_{\\mathrm{H}}$ from an observed $r_{\\mathrm{true}}$, we must invert this function:\n$$\\widehat{d}_{\\mathrm{H}}(r_{\\mathrm{true}}) = -\\frac{1}{2}\\ln(1 - 2r_{\\mathrm{true}})$$\n\n$2$. The Kosambi mapping function assumes a specific form of positive interference. The relationship is:\n$$r_{\\mathrm{K}}(d) = \\frac{1}{2}\\tanh(2d)$$\nInverting this function gives the inferred distance $\\widehat{d}_{\\mathrm{K}}$:\n$$\\widehat{d}_{\\mathrm{K}}(r_{\\mathrm{true}}) = \\frac{1}{2}\\mathrm{arctanh}(2r_{\\mathrm{true}}) = \\frac{1}{4}\\ln\\left(\\frac{1 + 2r_{\\mathrm{true}}}{1 - 2r_{\\mathrm{true}}}\\right)$$\nBoth inverse functions are valid for $r_{\\mathrm{true}} \\in [0, 0.5)$.\n\nThe computational procedure for each test case $(d_{\\mathrm{true}}, m)$ is as follows:\nFirst, convert the true distance to Morgans: $d_{\\mathrm{M}} = d_{\\mathrm{true}}/100$.\nSecond, compute $r_{\\mathrm{true}}$ using the chi-square model formula with parameters $d_{\\mathrm{M}}$ and $m$. The summation term $\\sum_{j=0}^{m} \\frac{(2 d_{\\mathrm{M}})^j}{j!}$ is calculated numerically.\nThird, substitute this $r_{\\mathrm{true}}$ into the inverse Haldane and Kosambi formulas to compute the estimated distances $\\widehat{d}_{\\mathrm{H}}$ and $\\widehat{d}_{\\mathrm{K}}$ in Morgans.\nFourth, convert these estimated distances back to centimorgans: $\\widehat{d}_{\\mathrm{H,cM}} = 100 \\cdot \\widehat{d}_{\\mathrm{H}}$ and $\\widehat{d}_{\\mathrm{K,cM}} = 100 \\cdot \\widehat{d}_{\\mathrm{K}}$.\nFinally, the biases are calculated as the difference between the estimated and true distances in centimorgans:\n$$b_{\\mathrm{H}} = \\widehat{d}_{\\mathrm{H,cM}} - d_{\\mathrm{true}}$$\n$$b_{\\mathrm{K}} = \\widehat{d}_{\\mathrm{K,cM}} - d_{\\mathrm{true}}$$\nThe resulting triple $[r_{\\mathrm{true}}, b_{\\mathrm{H}}, b_{\\mathrm{K}}]$ is reported, with each value rounded to six decimal places. When $m0$, positive interference will reduce the recombination frequency $r_{\\mathrm{true}}$ for a given $d_{\\mathrm{M}}$ compared to the no-interference case. Consequently, both Haldane's and Kosambi's functions, when presented with this lower $r_{\\mathrm{true}}$, will infer a shorter distance, leading to a negative bias ($b_{\\mathrm{H}}  0$, $b_{\\mathrm{K}}  0$), as will be demonstrated by the implementation.", "answer": "```python\nimport numpy as np\n# The problem can be solved using numpy alone, scipy is not strictly necessary\n# if the Poisson-related sum is implemented manually, as done here.\n\ndef solve():\n    \"\"\"\n    Computes recombination fractions and distance inference biases for a set of test cases\n    according to the problem specification.\n    \"\"\"\n    # Test suite: (d_true in cM, m)\n    test_cases = [\n        (0.5, 0),\n        (10.0, 1),\n        (40.0, 5),\n        (90.0, 1),\n        (2.0, 10),\n    ]\n\n    results = []\n    \n    for d_true, m in test_cases:\n        # Step A: Convert true distance from centimorgans to Morgans.\n        d_M = d_true / 100.0\n\n        # Step B: Compute the true recombination fraction under the chi-square model.\n        # r_true = 0.5 * (1 - exp(-2*d_M) * sum_{j=0 to m} (2*d_M)^j / j!)\n        lambda_val = 2.0 * d_M\n        \n        # Calculate the sum term sum_{j=0 to m} (lambda^j / j!) efficiently.\n        # This avoids large numbers from factorials and powers by computing terms iteratively.\n        poisson_sum = 0.0\n        term = 1.0  # Term for j=0 is lambda^0/0! = 1\n        poisson_sum += term\n        for j in range(1, m + 1):\n            term *= lambda_val / j\n            poisson_sum += term\n            \n        r_true = 0.5 * (1.0 - np.exp(-lambda_val) * poisson_sum)\n\n        # Step C: Infer distances by inverting Haldane and Kosambi mapping functions.\n        # To avoid potential domain errors for log and arctanh if 2*r_true is very close to 1,\n        # we can clamp it slightly below, although this is not expected for the given models.\n        two_r_true = 2.0 * r_true\n        if two_r_true = 1.0:\n            two_r_true = 1.0 - 1e-12\n\n        # Haldane inversion: d_H = -0.5 * log(1 - 2*r)\n        d_hat_H_M = -0.5 * np.log(1.0 - two_r_true)\n        \n        # Kosambi inversion: d_K = 0.5 * arctanh(2*r)\n        d_hat_K_M = 0.5 * np.arctanh(two_r_true)\n\n        # Step D: Convert inferred distances to cM and compute biases.\n        d_hat_H_cM = 100.0 * d_hat_H_M\n        d_hat_K_cM = 100.0 * d_hat_K_M\n        \n        b_H = d_hat_H_cM - d_true\n        b_K = d_hat_K_cM - d_true\n\n        # Step E: Store the triple [r_true, b_H, b_K]\n        results.append([r_true, b_H, b_K])\n\n    # Format the final output string as specified: [[r1,bH1,bK1],[r2,bH2,bK2],...]\n    # Each number is rounded to 6 decimal places.\n    formatted_results = []\n    for res in results:\n        # Format each number in the triple to 6 decimal places and join into a string like \"[x,y,z]\"\n        formatted_triple = f\"[{','.join([f'{v:.6f}' for v in res])}]\"\n        formatted_results.append(formatted_triple)\n    \n    # Join all triples with commas and enclose in brackets for the final output\n    final_output_string = f\"[{','.join(formatted_results)}]\"\n    \n    print(final_output_string)\n\nsolve()\n```", "id": "2845250"}]}