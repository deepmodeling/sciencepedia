{"hands_on_practices": [{"introduction": "To accurately interpret testcross data, we must first master the theoretical model that connects the biological process of recombination to observable progeny frequencies. This foundational exercise ([@problem_id:2803902]) challenges you to derive the expected frequencies of nonrecombinant and recombinant progeny from first principles. By starting with only the definition of the recombination fraction, $r$, and basic symmetry arguments, you will build the core mathematical framework for linkage analysis and solidify your understanding of how genetic linkage is quantified.", "problem": "A diploid species carries two codominant marker loci, $A/a$ and $B/b$. Consider a single meiosis in a doubly heterozygous parent that can be in either coupling phase $AB/ab$ or repulsion phase $Ab/aB$, testcrossed to a homozygous recessive $ab/ab$ tester. Assume the following foundational facts and definitions:\n- The recombination fraction $r \\in [0, \\tfrac{1}{2}]$ between loci $A$ and $B$ is defined as the probability that a haploid product (gamete) produced by the doubly heterozygous parent carries a recombinant haplotype across the two loci.\n- In the absence of viability selection, each zygote class formed in the testcross directly reports the haplotype contributed by the doubly heterozygous parent.\n- In a single meiosis with no chromatid interference and no segregation distortion, symmetry implies that, conditional on recombination occurring between the two loci, the two possible recombinant chromatids occur with equal probability, and conditional on no recombination, the two nonrecombinant (parental) chromatids occur with equal probability.\n\nStarting strictly from these definitions, and without invoking any shortcut formulas, do the following:\n1. Identify which progeny genotype classes are nonrecombinant versus recombinant in a testcross for each phase, coupling $AB/ab$ and repulsion $Ab/aB$.\n2. Derive the expected frequencies of the nonrecombinant and recombinant categories as functions of $r$, showing how these follow from the symmetry and the definition of $r$.\n3. For the coupling phase $AB/ab$ specifically, write the expected frequency vector for the four ordered progeny genotype classes $(AB/ab,\\; Ab/ab,\\; aB/ab,\\; ab/ab)$ as a function of $r$.\n\nExpress your final answer as a single row vector whose six entries, in order, are:\n- The total frequency of nonrecombinants,\n- The total frequency of recombinants,\n- The four-class frequency vector for the coupling phase in the order $(AB/ab,\\; Ab/ab,\\; aB/ab,\\; ab/ab)$.\n\nNo numerical evaluation is required. Provide the exact algebraic expression. Do not include units.", "solution": "The problem as stated is scientifically grounded, well-posed, and internally consistent. It presents a standard model from classical transmission genetics. Therefore, a solution will be derived.\n\nThe task is to derive the expected frequencies of progeny from a testcross involving a doubly heterozygous individual, starting from foundational definitions. Let the two loci be $A$ and $B$, with alleles $(A, a)$ and $(B, b)$ respectively. The doubly heterozygous parent is crossed with a homozygous recessive tester of genotype $ab/ab$. The tester produces only one type of gamete, carrying the haplotype $ab$. Consequently, the genotype of any progeny uniquely determines the haplotype contributed by the heterozygous parent, as per the no-viability-selection assumption.\n\nFirst, we identify the nonrecombinant and recombinant progeny classes for each parental phase. The phase refers to the arrangement of alleles on the homologous chromosomes of the doubly heterozygous parent.\n\n1.  **Coupling Phase ($AB/ab$):**\n    The parental haplotypes, which are present on the chromosomes of the parent, are $AB$ and $ab$. A meiotic event without crossing over between the loci produces gametes with these parental haplotypes. These are the nonrecombinant gametes. A meiotic event with a single crossover (or any odd number of crossovers) between the loci results in the exchange of genetic material, producing recombinant haplotypes $Ab$ and $aB$.\n    Therefore, for a parent of genotype $AB/ab$:\n    -   Nonrecombinant gametes carry haplotypes $AB$ and $ab$. The corresponding testcross progeny have genotypes $AB/ab$ and $ab/ab$.\n    -   Recombinant gametes carry haplotypes $Ab$ and $aB$. The corresponding testcross progeny have genotypes $Ab/ab$ and $aB/ab$.\n\n2.  **Repulsion Phase ($Ab/aB$):**\n    The parental haplotypes are $Ab$ and $aB$. Meiotic products without recombination between the loci will carry these haplotypes. A crossover event between the loci will produce the recombinant haplotypes $AB$ and $ab$.\n    Therefore, for a parent of genotype $Ab/aB$:\n    -   Nonrecombinant gametes carry haplotypes $Ab$ and $aB$. The corresponding testcross progeny have genotypes $Ab/ab$ and $aB/ab$.\n    -   Recombinant gametes carry haplotypes $AB$ and $ab$. The corresponding testcross progeny have genotypes $AB/ab$ and $ab/ab$.\n\nThis completes the first part of the problem. Now, we derive the expected frequencies as a function of the recombination fraction, $r$.\n\nThe recombination fraction $r$ is defined as the probability that a randomly chosen gamete from the heterozygous parent is of a recombinant type. Let $\\mathcal{R}$ denote the event that a gamete is recombinant, and $\\mathcal{NR}$ be the event that it is nonrecombinant. By definition, $P(\\mathcal{R}) = r$. Since these are the only two possibilities, the total probability must be $1$.\n$$ P(\\mathcal{R}) + P(\\mathcal{NR}) = 1 $$\nFrom this, the probability of producing a nonrecombinant gamete is $P(\\mathcal{NR}) = 1 - r$. These are the total frequencies for the two categories, recombinant and nonrecombinant.\n\nNext, we must find the frequencies of the individual gamete types. The problem states a symmetry condition: conditional on an event being recombinant, the two possible recombinant gamete types are produced with equal probability. Similarly, conditional on an event being nonrecombinant, the two parental gamete types are produced with equal probability.\n\nLet the four possible gamete haplotypes produced by the heterozygous parent be $H_1$, $H_2$, $H_3$, and $H_4$. Regardless of phase, two are nonrecombinant (parental) and two are recombinant. Let $H_{NR1}$ and $H_{NR2}$ be the two nonrecombinant haplotypes, and let $H_{R1}$ and $H_{R2}$ be the two recombinant haplotypes.\n\nUsing the law of total probability, the frequency of a specific nonrecombinant gamete, say $H_{NR1}$, is:\n$$ P(H_{NR1}) = P(H_{NR1} | \\mathcal{NR}) \\times P(\\mathcal{NR}) $$\nAccording to the symmetry principle, $P(H_{NR1} | \\mathcal{NR}) = \\frac{1}{2}$. We have already established that $P(\\mathcal{NR}) = 1 - r$. Therefore,\n$$ P(H_{NR1}) = \\frac{1}{2} (1 - r) = \\frac{1-r}{2} $$\nBy the same logic, the frequency of the other nonrecombinant gamete $H_{NR2}$ is also $\\frac{1-r}{2}$. The sum of their frequencies is $(\\frac{1-r}{2}) + (\\frac{1-r}{2}) = 1-r$, which is consistent.\n\nSimilarly, the frequency of a specific recombinant gamete, say $H_{R1}$, is:\n$$ P(H_{R1}) = P(H_{R1} | \\mathcal{R}) \\times P(\\mathcal{R}) $$\nAccording to the symmetry principle, $P(H_{R1} | \\mathcal{R}) = \\frac{1}{2}$. By definition, $P(\\mathcal{R}) = r$. Therefore,\n$$ P(H_{R1}) = \\frac{1}{2} r = \\frac{r}{2} $$\nThe frequency of the other recombinant gamete $H_{R2}$ is also $\\frac{r}{2}$. The sum of their frequencies is $(\\frac{r}{2}) + (\\frac{r}{2}) = r$, which is consistent.\n\nThis completes the second part of the problem. Now, for the final part, we apply these results to the coupling phase parent ($AB/ab$).\n-   The nonrecombinant haplotypes are $AB$ and $ab$. Their expected frequencies are each $\\frac{1-r}{2}$.\n-   The recombinant haplotypes are $Ab$ and $aB$. Their expected frequencies are each $\\frac{r}{2}$.\n\nSince progeny genotypes from a testcross directly reflect the gamete frequencies of the heterozygous parent, we have:\n-   Frequency of progeny $AB/ab$ = Frequency of gamete $AB$ = $\\frac{1-r}{2}$.\n-   Frequency of progeny $Ab/ab$ = Frequency of gamete $Ab$ = $\\frac{r}{2}$.\n-   Frequency of progeny $aB/ab$ = Frequency of gamete $aB$ = $\\frac{r}{2}$.\n-   Frequency of progeny $ab/ab$ = Frequency of gamete $ab$ = $\\frac{1-r}{2}$.\n\nThe problem requires a single row vector of six entries.\n1.  Total frequency of nonrecombinants: This is $P(\\mathcal{NR}) = 1-r$.\n2.  Total frequency of recombinants: This is $P(\\mathcal{R}) = r$.\n3.  Frequency of $AB/ab$ (coupling): $\\frac{1-r}{2}$.\n4.  Frequency of $Ab/ab$ (coupling): $\\frac{r}{2}$.\n5.  Frequency of $aB/ab$ (coupling): $\\frac{r}{2}$.\n6.  Frequency of $ab/ab$ (coupling): $\\frac{1-r}{2}$.\n\nThe final vector is constructed from these six values in the specified order.", "answer": "$$ \\boxed{\\begin{pmatrix} 1-r & r & \\frac{1-r}{2} & \\frac{r}{2} & \\frac{r}{2} & \\frac{1-r}{2} \\end{pmatrix}} $$", "id": "2803902"}, {"introduction": "Experimental genetics is a statistical science, and interpreting results requires a keen awareness of sampling error. This practice ([@problem_id:2803899]) presents a common and challenging scenario: observing zero recombinant offspring in a small experiment. Instead of jumping to a simplistic conclusion of complete linkage, you will learn to apply a statistically rigorous approach, moving beyond a simple point estimate to quantify the range of plausible values for the recombination fraction, $r$, using a confidence interval. This exercise is crucial for developing the critical thinking skills needed to draw sound conclusions from limited data.", "problem": "A diploid species with negligible interference is studied at two autosomal loci, denoted by alleles $A/a$ and $B/b$. A testcross is performed by mating a dihybrid in coupling phase, $AB/ab$, to a double recessive, $ab/ab$. Under the definition of recombination frequency, each testcross progeny is classified as recombinant if it carries $Ab$ or $aB$, and as nonrecombinant if it carries $AB$ or $ab$. In a single replicate experiment with total sample size $N=20$, the observed counts are $AB=10$, $ab=10$, $Ab=0$, and $aB=0$.\n\nA junior colleague concludes that the recombination fraction is $r=0$ and declares complete linkage, arguing that the recombinant classes are absent. You are asked to evaluate this conclusion and to propose a statistically sound correction that appropriately accounts for sampling error in such small testcrosses using only foundational principles: Mendel’s first law (equal segregation), the definition of recombination frequency $r$ as the probability that a gamete is recombinant for the two loci, and the fact that the number of recombinant progeny in a testcross of size $N$ follows a binomial distribution with parameter $r$.\n\nWhich option best captures a correct interpretation of the data and an appropriate correction for sampling error?\n\nA. Because $R=0$ out of $N=20$, the maximum likelihood estimate is $r=0$ and complete linkage is established; no further analysis is necessary since rare recombinants would have appeared with larger $N$ if $r>0$.\n\nB. The maximum likelihood estimate is $\\hat r=0$, but with $N=20$ the absence of observed recombinants can still occur with non-negligible probability when $r>0$. A principled correction is to report an exact binomial $95\\%$ confidence interval for $r$, whose upper bound solves $(1-r)^{20}=0.05$, yielding $r\\approx 0.139$, and to refrain from claiming complete linkage.\n\nC. A Pearson chi-square goodness-of-fit test against the $1\\!:\\!1\\!:\\!1\\!:\\!1$ four-class expectation is appropriate; since two classes are zero, apply Yates’s continuity correction and accept the null of independent assortment.\n\nD. To mitigate small-sample error, require a minimum of $N=200$ before making any inference. Until then, treat the loci as unlinked and set $r=0.5$ to avoid bias from zero cells.\n\nE. Apply Laplace smoothing and estimate $\\tilde r=(R+1)/(N+2)=1/22\\approx 0.045$ as the recombination fraction, then conclude a map distance of approximately $4.5$ centimorgans with a non-significant deviation from independent assortment at $P>0.05$.", "solution": "The problem statement must first be validated.\n\n**Step 1: Extract Givens**\n- Organism: A diploid species.\n- Loci: Two autosomal loci, alleles $A/a$ and $B/b$.\n- Interference: Negligible interference.\n- Parental cross: A dihybrid in coupling phase, genotype $AB/ab$, is mated to a double recessive individual, genotype $ab/ab$. This is a testcross.\n- Progeny classification: Recombinant progeny carry genotypes $Ab/ab$ or $aB/ab$; nonrecombinant progeny carry genotypes $AB/ab$ or $ab/ab$.\n- Experimental data: Total sample size $N=20$. Observed counts are $AB$ genotype progeny count $=10$, $ab$ genotype progeny count $=10$, $Ab$ genotype progeny count $=0$, and $aB$ genotype progeny count $=0$.\n- Foundational principles for analysis:\n    1. Mendel’s first law (equal segregation).\n    2. Definition of recombination frequency, $r$, as the probability a gamete is recombinant.\n    3. The number of recombinant progeny in a testcross of size $N$ follows a binomial distribution with parameter $r$.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem presents a classic scenario in transmission genetics for estimating linkage.\n- **Scientific Groundedness**: The concepts of linkage, recombination, testcross, and coupling phase are fundamental to genetics. The use of the binomial distribution to model the number of recombinant offspring is the standard statistical model for this situation. The problem is scientifically sound.\n- **Well-Posedness**: The givens are sufficient and consistent. The total number of progeny is $10+10+0+0 = 20$, matching the stated $N=20$. The question asks for a statistical evaluation of a conclusion, which is a well-defined task. A unique, meaningful analysis is possible.\n- **Objectivity**: The problem is stated using objective and precise scientific terminology. There is no subjective content.\n- **Other Flaws**: The problem does not violate any other criteria for validity. It is neither incomplete, contradictory, unrealistic, ill-posed, nor trivial. The data, with zero counts for recombinant classes, represent a common challenge in analyzing small-sample experiments and highlight an important statistical concept.\n\n**Step 3: Verdict and Action**\nThe problem statement is valid. I will proceed with a full solution.\n\n**Derivation and Analysis**\nThe dihybrid parent with genotype $AB/ab$ produces four types of gametes. Let $r$ be the recombination frequency.\n- The total probability of producing a nonrecombinant gamete ($AB$ or $ab$) is $1-r$. By Mendel's law of segregation, these two gamete types are expected in equal frequencies, so $P(AB) = P(ab) = (1-r)/2$.\n- The total probability of producing a recombinant gamete ($Ab$ or $aB$) is $r$. Similarly, these are expected in equal frequencies, so $P(Ab) = P(aB) = r/2$.\nIn a testcross with an $ab/ab$ parent, the phenotype of the progeny directly reveals the gamete contributed by the dihybrid parent. The probability that a single progeny is recombinant is $P(Ab) + P(aB) = r/2 + r/2 = r$. The probability that it is nonrecombinant is $1-r$.\n\nLet $R$ be the number of recombinant progeny in a sample of size $N$. Each of the $N$ progeny is an independent trial, so $R$ follows a binomial distribution, $R \\sim \\text{Binomial}(N, r)$. The probability of observing $k$ recombinants is given by:\n$$P(R=k | N, r) = \\binom{N}{k} r^k (1-r)^{N-k}$$\nIn this experiment, $N=20$ and the observed number of recombinants is $R = (\\text{count of } Ab) + (\\text{count of } aB) = 0+0=0$.\n\nThe junior colleague's conclusion is that $r=0$. This corresponds to the maximum likelihood estimate (MLE) of $r$. The likelihood function for $r$ given the data $R=0$ is:\n$$L(r | R=0) = \\binom{20}{0} r^0 (1-r)^{20} = (1-r)^{20}$$\nThis function is maximized for $r \\in [0, 0.5]$ when $r$ is minimized, i.e., at $\\hat{r} = 0$. However, concluding that the true parameter $r$ is exactly $0$ based on a point estimate from a small sample is statistically naive. It completely ignores sampling error. A small but positive value of $r$ could easily yield $R=0$ in a sample of only $N=20$ by chance. For example, if the true $r=0.05$ (corresponding to $5$ centimorgans), the probability of observing no recombinants is $P(R=0 | N=20, r=0.05) = (1-0.05)^{20} = (0.95)^{20} \\approx 0.358$. This probability is not negligible, so we cannot rule out $r=0.05$.\n\nA statistically sound approach is to quantify the uncertainty in the estimate of $r$ by constructing a confidence interval. A $95\\%$ confidence interval gives a range of values for $r$ that are consistent with the observed data. For an observation of $R=0$ recombinants in $N$ trials, the exact one-sided $95\\%$ confidence interval is $[0, r_{\\text{upper}}]$, where $r_{\\text{upper}}$ is the value of $r$ for which the probability of observing a result as or more extreme than $R=0$ is $\\alpha=0.05$. The only result as or more extreme than $R=0$ is $R=0$ itself. Thus, we solve for $r_{\\text{upper}}$ in the equation:\n$$P(R=0 | N=20, r=r_{\\text{upper}}) = 0.05$$\n$$(1-r_{\\text{upper}})^{20} = 0.05$$\nSolving for $r_{\\text{upper}}$:\n$$1 - r_{\\text{upper}} = (0.05)^{1/20}$$\n$$r_{\\text{upper}} = 1 - (0.05)^{1/20}$$\nUsing a calculator, $\\ln(0.05) \\approx -2.99573$. Then $(1/20)\\ln(0.05) \\approx -0.149786$. So, $(0.05)^{1/20} = e^{-0.149786} \\approx 0.86089$.\n$$r_{\\text{upper}} \\approx 1 - 0.86089 = 0.13911$$\nThe $95\\%$ confidence interval for $r$ is approximately $[0, 0.139]$. This means that while the data are consistent with complete linkage ($r=0$), they are also consistent with recombination frequencies as high as $13.9\\%$. Therefore, it is incorrect to declare complete linkage. The proper conclusion is that the loci appear to be linked, but the data are insufficient to provide a precise estimate of $r$, which could plausibly lie anywhere in the interval $[0, 0.139]$.\n\nNow, I evaluate each option.\n\n**A. Because $R=0$ out of $N=20$, the maximum likelihood estimate is $r=0$ and complete linkage is established; no further analysis is necessary since rare recombinants would have appeared with larger $N$ if $r>0$.**\nThis option correctly states that the MLE is $\\hat{r}=0$. However, it incorrectly equates this point estimate with the true parameter value, claiming \"complete linkage is established\" and that \"no further analysis is necessary\". This is a profound statistical error, as it ignores sampling uncertainty, which is very large with $N=20$.\nVerdict: **Incorrect**.\n\n**B. The maximum likelihood estimate is $\\hat r=0$, but with $N=20$ the absence of observed recombinants can still occur with non-negligible probability when $r>0$. A principled correction is to report an exact binomial $95\\%$ confidence interval for $r$, whose upper bound solves $(1-r)^{20}=0.05$, yielding $r\\approx 0.139$, and to refrain from claiming complete linkage.**\nThis option correctly identifies the MLE as $\\hat{r}=0$ but immediately points out the flaw in stopping there, acknowledging the role of chance. It proposes the correct statistical procedure: constructing an exact binomial confidence interval. It provides the correct equation for the upper bound of this interval, $(1-r)^{20}=0.05$, calculates the correct value $r \\approx 0.139$, and draws the correct scientific conclusion: one must \"refrain from claiming complete linkage.\" This analysis is entirely sound.\nVerdict: **Correct**.\n\n**C. A Pearson chi-square goodness-of-fit test against the $1\\!:\\!1\\!:\\!1\\!:\\!1$ four-class expectation is appropriate; since two classes are zero, apply Yates’s continuity correction and accept the null of independent assortment.**\nThis option is flawed in multiple respects. First, the $1:1:1:1$ ratio corresponds to independent assortment ($r=0.5$). The observed data ($10:10:0:0$) are clearly inconsistent with this null hypothesis. A chi-square test confirms this: Observeds are $O=(10, 10, 0, 0)$, Expecteds for $r=0.5$ are $E=(5, 5, 5, 5)$. $\\chi^2 = \\sum (O-E)^2/E = (10-5)^2/5 + (10-5)^2/5 + (0-5)^2/5 + (0-5)^2/5 = 5+5+5+5=20$. With $3$ degrees of freedom, the P-value is extremely small ($P \\approx 0.00017$), leading to a strong rejection, not acceptance, of the null hypothesis. Second, Yates's correction is for tests with $1$ degree of freedom, not $3$. Third, the goal is to estimate $r$, not just test for independent assortment.\nVerdict: **Incorrect**.\n\n**D. To mitigate small-sample error, require a minimum of $N=200$ before making any inference. Until then, treat the loci as unlinked and set $r=0.5$ to avoid bias from zero cells.**\nThis is an unscientific recommendation. One must analyze the data available; refusing to do so is not a valid scientific practice. Moreover, the suggestion to \"treat the loci as unlinked and set $r=0.5$\" is profoundly wrong. The data provide strong evidence *against* independent assortment. To assume $r=0.5$ would be to introduce a severe bias, not to avoid it.\nVerdict: **Incorrect**.\n\n**E. Apply Laplace smoothing and estimate $\\tilde r=(R+1)/(N+2)=1/22\\approx 0.045$ as the recombination fraction, then conclude a map distance of approximately $4.5$ centimorgans with a non-significant deviation from independent assortment at $P>0.05$.**\nApplying Laplace's rule of succession to get a point estimate of $\\tilde{r} = (0+1)/(20+2) = 1/22 \\approx 0.045$ is a valid Bayesian technique. The corresponding map distance of $4.5$ cM is also a reasonable conversion. However, the final claim that this represents a \"non-significant deviation from independent assortment at $P>0.05$\" is false. As shown in the analysis of option C, the data show a highly significant deviation from independent assortment ($r=0.5$). Therefore, the conclusion of this option is factually wrong.\nVerdict: **Incorrect**.", "answer": "$$\\boxed{B}$$", "id": "2803899"}, {"introduction": "Real-world genetic datasets are often imperfect, with missing information due to technical failures. This advanced practice ([@problem_id:2803886]) introduces a powerful computational method for handling such incomplete data: the Expectation-Maximization (EM) algorithm. You will derive and implement this iterative algorithm to find the maximum likelihood estimate of the recombination fraction, $r$, demonstrating how to extract robust inferences even when some data points are missing. This hands-on problem provides a bridge from classical genetic principles to the more complex statistical approaches that are essential in modern genomics.", "problem": "Consider a classical two-locus testcross in the following setting. A doubly heterozygous parent with haplotypes $A B / a b$ is crossed to a doubly recessive $a b / a b$ parent. For each offspring, the observed haplotype directly reveals the recombination status of the gamete from the heterozygous parent under Mendelian segregation: a nonrecombinant offspring is $A B$ or $a b$, and a recombinant offspring is $A b$ or $a B$. Let the recombination fraction be $r$, defined as the probability that a randomly produced gamete from the heterozygote is recombinant. When the loci are unlinked, $r = 0.5$; when linked, $0 \\le r < 0.5$. Assume Missing Completely At Random (MCAR): an offspring’s classification may be missing due to assay failure independent of its true recombination status.\n\nYou observe counts from a testcross experiment with total offspring $N$, of which $x$ are observed recombinant, $y$ are observed nonrecombinant, and $m$ are missing, with $x + y + m = N$. The complete-data model for a single offspring is a Bernoulli with parameter $r$ for being recombinant, and the complete-data likelihood across $N$ independent offspring is the likelihood of a binomial sampling model. Your task is to derive from these foundations and implement the Expectation–Maximization (EM) algorithm to obtain the Maximum Likelihood Estimator (MLE) of $r$ in the presence of missing classifications. Begin from an initial guess $r_0 \\in [0, 0.5]$ and iterate the EM updates until convergence.\n\nRequirements:\n- Use only the core probabilistic definitions stated above: the Bernoulli model for a single offspring with parameter $r$ for “recombinant,” independence across offspring, and the MCAR assumption for missing classifications.\n- Derive the E-step by taking the conditional expectation of the unobserved number of recombinants among the $m$ missing given the current iterate $r_k$.\n- Derive the M-step by maximizing the expected complete-data log-likelihood with respect to $r$ to obtain the next iterate $r_{k+1}$.\n- Use a stopping criterion based on absolute change: stop when $\\lvert r_{k+1} - r_k \\rvert < \\varepsilon$, with $\\varepsilon = 10^{-12}$.\n- For each test case, produce the full sequence of iterates $\\{r_0, r_1, r_2, \\dots, r_{\\star}\\}$ including the initial guess and the final converged value $r_{\\star}$.\n- Express all probabilities, fractions, and final answers as decimals (not with a percentage sign).\n- Round each reported iterate to $12$ decimal places in the final output.\n\nTest suite:\nAll test cases have exactly $10\\%$ missing classifications, i.e., $m/N = 0.1$. For each case, the inputs are $(N, m, x, r_0)$, and $y$ is implicitly $N - m - x$.\n- Case A (general “happy path”): $(N, m, x, r_0) = (1000, 100, 280, 0.25)$. Here $y = 1000 - 100 - 280 = 620$.\n- Case B (boundary toward zero): $(N, m, x, r_0) = (100, 10, 0, 0.40)$. Here $y = 100 - 10 - 0 = 90$.\n- Case C (near independence): $(N, m, x, r_0) = (200, 20, 90, 0.10)$. Here $y = 200 - 20 - 90 = 90$.\n- Case D (rare recombination): $(N, m, x, r_0) = (500, 50, 10, 0.30)$. Here $y = 500 - 50 - 10 = 440$.\n\nFinal output format:\nYour program should produce a single line of output containing the results as a list of lists, one inner list per test case. Each inner list is the sequence of iterates as decimals rounded to $12$ places, in order, from $r_0$ through the converged value. For example, a valid overall format is\n$[$$[$$r_0^{(A)}, r_1^{(A)}, \\dots, r_{\\star}^{(A)}$$]$$,$ $[$$r_0^{(B)}, r_1^{(B)}, \\dots, r_{\\star}^{(B)}$$]$$,$ $[$$r_0^{(C)}, \\dots$$]$$,$ $[$$r_0^{(D)}, \\dots$$]$$]$.", "solution": "The problem statement is scientifically valid and well-posed. It presents a standard problem in statistical genetics: the estimation of a model parameter, the recombination fraction $r$, in the presence of missing data. The chosen framework, which involves a Bernoulli/Binomial model for offspring outcomes, the Missing Completely At Random (MCAR) assumption, and the Expectation-Maximization (EM) algorithm, is a correct and standard approach to this class of problems. All provided data and constraints are consistent and sufficient for deriving and implementing a solution.\n\nThe problem is to find the Maximum Likelihood Estimator (MLE) of the recombination fraction, $r$, from testcross data comprising $x$ observed recombinants, $y$ observed nonrecombinants, and $m$ classifications missing, out of a total of $N$ offspring. The relation is $N = x + y + m$.\n\nThe core of the EM algorithm is to iterate between an Expectation (E) step and a Maximization (M) step. This process works with the complete-data log-likelihood, which is the log-likelihood function we would have if all data were observed. Let the complete data consist of $N_{total\\_rec}$ recombinant offspring and $N_{total\\_nonrec}$ nonrecombinant offspring, where $N = N_{total\\_rec} + N_{total\\_nonrec}$. The underlying model for a single offspring is a Bernoulli trial where the probability of being recombinant is $r$. The complete-data log-likelihood, up to an additive constant, is:\n$$ \\ell_c(r; N_{total\\_rec}, N_{total\\_nonrec}) = N_{total\\_rec} \\ln(r) + N_{total\\_nonrec} \\ln(1-r) $$\nIn our problem, the complete data is not fully observed. The observed data are $x$ recombinants and $y$ nonrecombinants. The missing data corresponds to the $m$ unclassified offspring. Let $m_r$ be the number of recombinants and $m_{nr}$ be the number of nonrecombinants among these $m$ missing cases, where $m = m_r + m_{nr}$. The total counts in the complete-data formulation are thus $N_{total\\_rec} = x + m_r$ and $N_{total\\_nonrec} = y + m_{nr} = y + m - m_r$. The complete-data log-likelihood becomes:\n$$ \\ell_c(r) = (x + m_r) \\ln(r) + (y + m - m_r) \\ln(1-r) $$\nThe EM algorithm proceeds as follows, starting from an initial guess $r_0$.\n\n**E-Step (Expectation):**\nAt iteration $k$, given the current estimate of the parameter $r_k$, we compute the expected value of the complete-data log-likelihood, conditional on the observed data $(x, y)$. This expectation, denoted as the $Q$ function, is taken over the distribution of the missing data, which is determined by $m_r$.\n$$ Q(r | r_k) = E[\\ell_c(r) | x, y, m, r_k] $$\n$$ Q(r | r_k) = E[(x + m_r) \\ln(r) + (y + m - m_r) \\ln(1-r) | r_k] $$\nBy linearity of expectation, this simplifies to:\n$$ Q(r | r_k) = (x + E[m_r | r_k]) \\ln(r) + (y + m - E[m_r | r_k]) \\ln(1-r) $$\nThe number of recombinants $m_r$ among the $m$ missing offspring follows a Binomial distribution, $m_r \\sim \\text{Binomial}(m, r)$. Under the current parameter estimate $r_k$, the expected number of missing recombinants is:\n$$ E[m_r | r_k] = m \\cdot r_k $$\nSubstituting this expectation into the $Q$ function gives:\n$$ Q(r | r_k) = (x + m r_k) \\ln(r) + (y + m(1 - r_k)) \\ln(1-r) $$\nThis completes the E-step. We have formulated the objective function to be maximized in the M-step.\n\n**M-Step (Maximization):**\nIn the M-step, we find the value of $r$ that maximizes the $Q$ function, which will be our updated estimate, $r_{k+1}$.\n$$ r_{k+1} = \\underset{r \\in [0, 0.5]}{\\arg\\max} \\ Q(r | r_k) $$\nTo find the maximum, we take the derivative of $Q(r | r_k)$ with respect to $r$ and set it to zero:\n$$ \\frac{\\partial Q}{\\partial r} = \\frac{x + m r_k}{r} - \\frac{y + m(1 - r_k)}{1-r} = 0 $$\nSolving for $r$:\n$$ \\frac{x + m r_k}{r} = \\frac{y + m(1 - r_k)}{1-r} $$\n$$ (x + m r_k)(1 - r) = (y + m(1 - r_k))r $$\n$$ x + m r_k - (x + m r_k)r = (y + m - m r_k)r $$\n$$ x + m r_k = [x + m r_k + y + m - m r_k]r $$\n$$ x + m r_k = (x + y + m)r $$\nSince $N = x + y + m$, we have:\n$$ x + m r_k = N r $$\nThe update rule for $r_{k+1}$ is therefore:\n$$ r_{k+1} = \\frac{x + m r_k}{N} $$\nThis simple, iterative formula is the core of the algorithm. We start with an initial guess $r_0$ and repeatedly apply this rule until the change between successive iterates, $|r_{k+1} - r_k|$, falls below a specified tolerance $\\varepsilon = 10^{-12}$.\n\n**Convergence:**\nThe fixed point of this iteration, $r_{\\star}$, must satisfy $r_{\\star} = (x + m r_{\\star}) / N$. Solving for $r_{\\star}$ yields $N r_{\\star} = x + m r_{\\star}$, which simplifies to $(N-m) r_{\\star} = x$. Since $N-m=x+y$, we get $(x+y) r_{\\star} = x$, so $r_{\\star} = x / (x+y)$. This is precisely the MLE that would be obtained by considering only the complete cases (ignoring the $m$ missing observations), a result consistent with the MCAR assumption. The EM algorithm provides a principled way to arrive at this intuitive result.\nThe implementation will capture the sequence of iterates $\\{r_0, r_1, \\dots, r_{\\star}\\}$ for each test case.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the EM algorithm problem for estimating recombination fraction.\n    \"\"\"\n\n    # Test cases are defined as tuples (N, m, x, r0).\n    # N: total offspring\n    # m: missing classifications\n    # x: observed recombinants\n    # r0: initial guess for recombination fraction\n    test_cases = [\n        (1000, 100, 280, 0.25),  # Case A\n        (100, 10, 0, 0.40),      # Case B\n        (200, 20, 90, 0.10),      # Case C\n        (500, 50, 10, 0.30),      # Case D\n    ]\n\n    all_results = []\n    \n    # Define the convergence tolerance.\n    epsilon = 1e-12\n\n    for case in test_cases:\n        N, m, x, r0 = case\n        \n        # The EM algorithm implementation for a single test case.\n        iterates = [r0]\n        r_current = r0\n        \n        while True:\n            # M-step update rule derived from the Q-function.\n            # E-step is implicit in this update: E[m_r] = m * r_current\n            r_next = (x + m * r_current) / N\n            \n            # Append the new iterate to the sequence.\n            iterates.append(r_next)\n            \n            # Check for convergence based on absolute change.\n            if abs(r_next - r_current) < epsilon:\n                break\n            \n            # Update the current estimate for the next iteration.\n            r_current = r_next\n            \n        all_results.append(iterates)\n\n    # Format the final output string as a list of lists of decimals.\n    # Each iterate is rounded to 12 decimal places as per the requirements.\n    outer_list_str = []\n    for case_results in all_results:\n        inner_list_str = ','.join([f'{val:.12f}' for val in case_results])\n        outer_list_str.append(f\"[{inner_list_str}]\")\n        \n    final_output_str = f\"[{','.join(outer_list_str)}]\"\n\n    # Print the final result in the exact required format.\n    print(final_output_str)\n\nsolve()\n```", "id": "2803886"}]}