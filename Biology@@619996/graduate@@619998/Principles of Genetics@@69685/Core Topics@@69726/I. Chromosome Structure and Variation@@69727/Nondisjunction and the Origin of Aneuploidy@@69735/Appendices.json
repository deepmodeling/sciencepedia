{"hands_on_practices": [{"introduction": "The journey from a diploid cell to haploid gametes is a finely tuned process, but errors can and do occur. This first exercise challenges you to work through the fundamental genetic consequences of nondisjunction. By modeling a meiosis I error in a heterozygous individual, you will track how alleles are transmitted to gametes and ultimately influence the genotypes of the subsequent generation, a foundational skill for any geneticist studying aneuploidy [@problem_id:2832382]. This practice builds a precise, quantitative model of a complex meiotic event and its downstream effects.", "problem": "A diploid individual is heterozygous at a single codominant marker locus, denoted $A/a$, on a particular autosome. In a given meiosis in this individual, the homologous chromosomes for this autosome undergo a meiosis I nondisjunction event: both homologs migrate to the same pole at anaphase I, while sister chromatids separate normally at meiosis II. Assume the following:\n\n- Crossing over can occur between the centromere and the marker locus during prophase I. Let $\\theta$ denote the probability that, by the end of recombination, the two sister chromatids within a homolog carry opposite alleles at the marker (equivalently, an odd number of exchanges between the centromere and the locus has occurred such that the two sister chromatids differ at the marker). With probability $1 - \\theta$, the two sister chromatids within each homolog carry the same allele at the marker.\n- Meiosis II proceeds normally, so each disomic gamete from this meiosis receives exactly one chromatid from each homolog, while the complementary gametes are nullisomic for this chromosome. Under this meiosis I nondisjunction, the fraction of gametes that are disomic for this chromosome is $1/2$, and the fraction that are nullisomic is $1/2$.\n- Fertilization is random with normal haploid gametes from a partner that is homozygous $a/a$ at the marker. A disomic gamete fertilized by the partner produces a trisomic zygote for this chromosome, and a nullisomic gamete produces a monosomic zygote.\n- Relative viabilities (survival to the scoring stage) of trisomic and monosomic zygotes are $w_t$ and $w_m$, respectively, with $w_t > 0$ and $w_m > 0$. Euploid viability is not relevant here because this meiosis I nondisjunction produces no euploid gametes for this chromosome.\n\nConstruct the marker-locus genotype classes of the disomic and nullisomic gametes produced by the nondisjoining parent as functions of $\\theta$, then, under random fertilization and viability weighting by $w_t$ and $w_m$, derive a single closed-form expression for the expected fraction of surviving zygotes that are heterozygous at the marker locus (i.e., carry both $A$ and $a$ among their chromosome copies). Provide your final answer as a simplified analytic expression in terms of $\\theta$, $w_t$, and $w_m$. No numerical evaluation is required.", "solution": "The problem as stated is scientifically sound, well-posed, and objective. It is a formal problem in theoretical genetics concerning the consequences of meiotic nondisjunction. All necessary parameters and conditions are provided for a unique solution. I will proceed with the derivation.\n\nLet the diploid parent be of genotype $A/a$. Following DNA replication, the cell contains a tetrad of four chromatids: two carrying allele $A$ and two carrying allele $a$. Let the two homologous chromosomes be $H_A$ and $H_a$. After replication, $H_A$ consists of two sister chromatids, both initially carrying allele $A$, and $H_a$ consists of two sister chromatids, both initially carrying allele $a$.\n\nThe problem defines $\\theta$ as the probability that a crossover event between the centromere and the marker locus results in sister chromatids carrying different alleles. This is the definition of second-division segregation. With probability $1 - \\theta$, no such event occurs, and this is first-division segregation. We analyze these two cases to determine the genetic content of the gametes.\n\nCase 1: First-division segregation (probability $1 - \\theta$).\nIn this case, no effective crossover occurs between the centromere and the locus. The sister chromatids for each homolog remain identical. The centromere of $H_A$ holds two $A$ chromatids, and the centromere of $H_a$ holds two $a$ chromatids.\nDuring meiosis I nondisjunction, both homologous chromosomes, $H_A$ and $H_a$, migrate to the same pole. This results in one secondary meiocyte containing all four chromatids and one nullisomic secondary meiocyte.\nThe secondary meiocyte with the four chromatids undergoes a normal meiosis II. The problem states that the resulting disomic gametes each receive \"exactly one chromatid from each homolog\". Since the chromatids from $H_A$ are both $A$ and from $H_a$ are both $a$, any valid segregation will produce a gamete of genotype $A/a$. Thus, both disomic gametes produced under this scenario have the genotype $A/a$.\n\nCase 2: Second-division segregation (probability $\\theta$).\nIn this case, a crossover between the centromere and the locus has occurred. The sister chromatids of homolog $H_A$ become $(A, a)$, and the sister chromatids of homolog $H_a$ become $(a, A)$.\nAs before, meiosis I nondisjunction sends both homologs to one pole. At meiosis II, the two disomic gametes are formed by taking one chromatid from the $H_A$ pair and one from the $H_a$ pair. There are four equally likely combinations for the resulting gametes:\n\\begin{itemize}\n    \\item Chromatid $A$ from $H_A$ and chromatid $a$ from $H_a$: genotype $A/a$.\n    \\item Chromatid $A$ from $H_A$ and chromatid $A$ from $H_a$: genotype $A/A$.\n    \\item Chromatid $a$ from $H_A$ and chromatid $a$ from $H_a$: genotype $a/a$.\n    \\item Chromatid $a$ from $H_A$ and chromatid $A$ from $H_a$: genotype $A/a$.\n\\end{itemize}\nThus, among the disomic gametes produced under this scenario, the proportions of genotypes are: $1/4$ $A/A$, $1/2$ $A/a$, and $1/4$ $a/a$.\n\nCombining these two cases, we find the proportions of genotypes among all disomic gametes produced by the $A/a$ parent. Let $P(G)$ be the proportion of disomic gametes with genotype $G$.\n$$P(A/A) = (1 - \\theta) \\cdot 0 + \\theta \\cdot \\frac{1}{4} = \\frac{\\theta}{4}$$\n$$P(a/a) = (1 - \\theta) \\cdot 0 + \\theta \\cdot \\frac{1}{4} = \\frac{\\theta}{4}$$\n$$P(A/a) = (1 - \\theta) \\cdot 1 + \\theta \\cdot \\frac{1}{2} = 1 - \\theta + \\frac{\\theta}{2} = 1 - \\frac{\\theta}{2}$$\nThe sum of these proportions is $\\frac{\\theta}{4} + \\frac{\\theta}{4} + 1 - \\frac{\\theta}{2} = 1$, which is correct.\n\nThe problem states that the total fraction of disomic gametes is $1/2$ and the fraction of nullisomic gametes (genotype $\\emptyset$) is $1/2$. We can now write the absolute frequencies, $f(G)$, of each gamete type from the nondisjoining parent:\n\\begin{itemize}\n    \\item $f(A/A_{\\text{disomic}}) = \\frac{1}{2} \\cdot P(A/A) = \\frac{1}{2} \\cdot \\frac{\\theta}{4} = \\frac{\\theta}{8}$\n    \\item $f(a/a_{\\text{disomic}}) = \\frac{1}{2} \\cdot P(a/a) = \\frac{1}{2} \\cdot \\frac{\\theta}{4} = \\frac{\\theta}{8}$\n    \\item $f(A/a_{\\text{disomic}}) = \\frac{1}{2} \\cdot P(A/a) = \\frac{1}{2} \\cdot (1 - \\frac{\\theta}{2}) = \\frac{1}{2} - \\frac{\\theta}{4}$\n    \\item $f(\\emptyset_{\\text{nullisomic}}) = \\frac{1}{2}$\n\\end{itemize}\n\nThese gametes are fertilized by gametes from a partner of genotype $a/a$, which produces only normal haploid gametes of genotype $a$. This mating produces zygotes with the following initial frequencies and genotypes:\n\\begin{itemize}\n    \\item From $A/A$ gamete: zygote $A/A/a$ (trisomic), frequency $\\frac{\\theta}{8}$. This zygote is heterozygous.\n    \\item From $a/a$ gamete: zygote $a/a/a$ (trisomic), frequency $\\frac{\\theta}{8}$. This zygote is homozygous recessive.\n    \\item From $A/a$ gamete: zygote $A/a/a$ (trisomic), frequency $\\frac{1}{2} - \\frac{\\theta}{4}$. This zygote is heterozygous.\n    \\item From $\\emptyset$ gamete: zygote $a$ (monosomic), frequency $\\frac{1}{2}$. This zygote is homozygous recessive.\n\\end{itemize}\n\nThe relative viabilities of trisomic and monosomic zygotes are $w_t$ and $w_m$, respectively. The frequency of surviving zygotes of each type is the initial frequency multiplied by the corresponding viability factor.\n\nThe total frequency of surviving heterozygotes, $W_{\\text{het}}$, is the sum of the frequencies of surviving $A/A/a$ and $A/a/a$ zygotes:\n$$W_{\\text{het}} = \\left(\\frac{\\theta}{8}\\right) w_t + \\left(\\frac{1}{2} - \\frac{\\theta}{4}\\right) w_t = w_t \\left(\\frac{\\theta}{8} + \\frac{4 - 2\\theta}{8}\\right) = w_t \\left(\\frac{4 - \\theta}{8}\\right)$$\n\nThe total frequency of all surviving zygotes, $W_{\\text{total}}$, is the sum of the frequencies of all surviving types:\n$$W_{\\text{total}} = \\underbrace{\\left[ \\left(\\frac{\\theta}{8}\\right) + \\left(\\frac{\\theta}{8}\\right) + \\left(\\frac{1}{2} - \\frac{\\theta}{4}\\right) \\right]}_{\\text{all trisomics}} w_t + \\left(\\frac{1}{2}\\right) w_m$$\nThe term for the trisomic zygotes simplifies:\n$$\\left[ \\frac{2\\theta}{8} + \\frac{1}{2} - \\frac{2\\theta}{8} \\right] = \\frac{1}{2}$$\nSo, the total frequency of survivors is:\n$$W_{\\text{total}} = \\frac{1}{2} w_t + \\frac{1}{2} w_m = \\frac{1}{2}(w_t + w_m)$$\n\nThe final requested quantity is the fraction of surviving zygotes that are heterozygous. This is the ratio $\\frac{W_{\\text{het}}}{W_{\\text{total}}}$.\n$$\\text{Fraction heterozygous} = \\frac{w_t \\left(\\frac{4 - \\theta}{8}\\right)}{\\frac{1}{2}(w_t + w_m)} = \\frac{w_t (4 - \\theta)}{8} \\cdot \\frac{2}{w_t + w_m} = \\frac{w_t(4 - \\theta)}{4(w_t + w_m)}$$\nThis is the final simplified expression.", "answer": "$$\n\\boxed{\\frac{w_t (4 - \\theta)}{4(w_t + w_m)}}\n$$", "id": "2832382"}, {"introduction": "Nondisjunction is not a random accident but is often the result of failures in elegant cellular safeguards. This practice delves into the spindle assembly checkpoint, the cell's quality control system for chromosome segregation. You will use a Markov chain to model the dynamic tug-of-war between incorrect and correct chromosome attachments, quantitatively exploring how factors like Aurora B kinase activity influence the risk of aneuploidy [@problem_id:2832435]. This provides a deeper, mechanistic appreciation for the processes that ensure genomic stability.", "problem": "A single bivalent in meiosis I is modeled as a discrete-time Markov chain over kinetochore–microtubule attachment classes: incorrect attachments (syntelic or merotelic lumped as state $I$), unattached or monotelic intermediates (state $U$), and correct amphitelic biorientation (state $C$). Time is measured in identical correction cycles, and Aurora B kinase activity is represented by a dimensionless parameter $A \\in (0,1]$ that modulates detachment and reattachment probabilities per cycle. In each cycle, exactly one transition is realized according to the following probabilities (rows sum to $1$ for every allowed $A$):\n\n- From $I$: $P_{I\\to I} = 1 - 0.2A$, $P_{I\\to U} = 0.2A$, $P_{I\\to C} = 0$.\n- From $U$: $P_{U\\to I} = 0.45 - 0.03A$, $P_{U\\to U} = 0.10 - 0.02A$, $P_{U\\to C} = 0.45 + 0.05A$.\n- From $C$: $P_{C\\to C} = 1 - 0.02A$, $P_{C\\to U} = 0.02A$, $P_{C\\to I} = 0$.\n\nUse only foundational principles for finite, irreducible, discrete-time Markov chains and core cell-biological facts that Aurora B kinase destabilizes attachments, with stronger effects on erroneous links than on tension-stabilized correct ones, to derive the steady-state fraction of amphitelic attachments, denoted $\\pi_{C}(A)$, where $\\pi(A)$ is the stationary distribution satisfying $\\pi(A) = \\pi(A)\\,P(A)$ and $\\sum_{s\\in\\{I,U,C\\}} \\pi_{s}(A) = 1$. Assume that the anaphase decision point is sufficiently delayed that the distribution over attachment states is well-approximated by the stationary distribution. Define nondisjunction (NDJ) risk for this bivalent as the complement of the amphitelic steady-state fraction, $R(A) \\equiv 1 - \\pi_{C}(A)$.\n\nDerive and simplify a closed-form analytic expression for $R(A)$ as a function of $A$ over the domain $A \\in (0,1]$. Express your final answer as a single simplified symbolic expression. No rounding is required.", "solution": "The problem statement is assessed to be valid. It is scientifically grounded as a simplified model of a known biological process, mathematically well-posed as a finite, irreducible Markov chain, and is expressed in objective, unambiguous language. It is self-contained and provides all necessary information to proceed with a solution.\n\nThe objective is to find the steady-state nondisjunction risk, $R(A)$, defined as $1 - \\pi_C(A)$, where $\\pi_C(A)$ is the stationary probability of the correct amphitelic attachment state. This is equivalent to finding the sum of stationary probabilities of the incorrect and unattached states, $R(A) = \\pi_I(A) + \\pi_U(A)$.\n\nThe system is described by a discrete-time Markov chain with three states: $I$ (incorrect), $U$ (unattached), and $C$ (correct). The transition probability matrix, $P(A)$, is given by:\n$$\nP(A) = \\begin{pmatrix}\n1 - 0.2A & 0.2A & 0 \\\\\n0.45 - 0.03A & 0.10 - 0.02A & 0.45 + 0.05A \\\\\n0 & 0.02A & 1 - 0.02A\n\\end{pmatrix}\n$$\nThe stationary distribution $\\pi(A) = (\\pi_I, \\pi_U, \\pi_C)$ is the unique solution to the system of linear equations given by $\\pi(A) = \\pi(A)P(A)$, subject to the normalization condition $\\pi_I + \\pi_U + \\pi_C = 1$. The equations from $\\pi = \\pi P$ are:\n$$\n\\begin{cases}\n\\pi_I = \\pi_I(1 - 0.2A) + \\pi_U(0.45 - 0.03A) \\\\\n\\pi_U = \\pi_I(0.2A) + \\pi_U(0.10 - 0.02A) + \\pi_C(0.02A) \\\\\n\\pi_C = \\pi_U(0.45 + 0.05A) + \\pi_C(1 - 0.02A)\n\\end{cases}\n$$\nFrom the first equation, we can express $\\pi_I$ in terms of $\\pi_U$:\n$$\n\\pi_I - \\pi_I(1 - 0.2A) = \\pi_U(0.45 - 0.03A)\n$$\n$$\n\\pi_I(0.2A) = \\pi_U(0.45 - 0.03A) \\implies \\pi_I = \\pi_U \\frac{0.45 - 0.03A}{0.2A}\n$$\nFrom the third equation, we express $\\pi_C$ in terms of $\\pi_U$:\n$$\n\\pi_C - \\pi_C(1 - 0.02A) = \\pi_U(0.45 + 0.05A)\n$$\n$$\n\\pi_C(0.02A) = \\pi_U(0.45 + 0.05A) \\implies \\pi_C = \\pi_U \\frac{0.45 + 0.05A}{0.02A}\n$$\n(The second equation is linearly dependent on the other two and the normalization condition, and can be ignored for solving the system.)\nNow we substitute these expressions for $\\pi_I$ and $\\pi_C$ into the normalization equation $\\pi_I + \\pi_U + \\pi_C = 1$:\n$$\n\\pi_U \\frac{0.45 - 0.03A}{0.2A} + \\pi_U + \\pi_U \\frac{0.45 + 0.05A}{0.02A} = 1\n$$\nFactoring out $\\pi_U$:\n$$\n\\pi_U \\left( \\frac{0.45 - 0.03A}{0.2A} + 1 + \\frac{0.45 + 0.05A}{0.02A} \\right) = 1\n$$\nTo simplify the expression in the parentheses, we find a common denominator of $0.2A$, which requires multiplying the numerator and denominator of the last term by $10$:\n$$\n\\pi_U \\left( \\frac{0.45 - 0.03A}{0.2A} + \\frac{0.2A}{0.2A} + \\frac{10(0.45 + 0.05A)}{0.2A} \\right) = 1\n$$\n$$\n\\pi_U \\left( \\frac{(0.45 - 0.03A) + 0.2A + (4.5 + 0.5A)}{0.2A} \\right) = 1\n$$\n$$\n\\pi_U \\left( \\frac{(0.45 + 4.5) + (-0.03 + 0.2 + 0.5)A}{0.2A} \\right) = 1\n$$\n$$\n\\pi_U \\left( \\frac{4.95 + 0.67A}{0.2A} \\right) = 1 \\implies \\pi_U(A) = \\frac{0.2A}{4.95 + 0.67A}\n$$\nThe nondisjunction risk is $R(A) = \\pi_I(A) + \\pi_U(A)$. We can find $\\pi_I(A)$:\n$$\n\\pi_I(A) = \\pi_U(A) \\frac{0.45 - 0.03A}{0.2A} = \\left(\\frac{0.2A}{4.95 + 0.67A}\\right) \\left(\\frac{0.45 - 0.03A}{0.2A}\\right) = \\frac{0.45 - 0.03A}{4.95 + 0.67A}\n$$\nNow we compute the sum $R(A) = \\pi_I(A) + \\pi_U(A)$:\n$$\nR(A) = \\frac{0.45 - 0.03A}{4.95 + 0.67A} + \\frac{0.2A}{4.95 + 0.67A} = \\frac{0.45 - 0.03A + 0.2A}{4.95 + 0.67A}\n$$\n$$\nR(A) = \\frac{0.45 + 0.17A}{4.95 + 0.67A}\n$$\nFor a more rigorous final expression, we convert the decimal coefficients to fractions.\n$0.45 = \\frac{45}{100} = \\frac{9}{20}$, $0.17 = \\frac{17}{100}$, $4.95 = \\frac{495}{100} = \\frac{99}{20}$, and $0.67 = \\frac{67}{100}$.\nSubstituting these into the expression for $R(A)$:\n$$\nR(A) = \\frac{\\frac{9}{20} + \\frac{17}{100}A}{\\frac{99}{20} + \\frac{67}{100}A}\n$$\nTo eliminate the denominators within the fraction, we multiply the numerator and the denominator by $100$:\n$$\nR(A) = \\frac{100\\left(\\frac{9}{20} + \\frac{17}{100}A\\right)}{100\\left(\\frac{99}{20} + \\frac{67}{100}A\\right)} = \\frac{5 \\cdot 9 + 17A}{5 \\cdot 99 + 67A}\n$$\nThis simplifies to the final closed-form expression:\n$$\nR(A) = \\frac{45 + 17A}{495 + 67A}\n$$\nThis rational function is irreducible as there are no common factors between the numerator and the denominator polynomials.", "answer": "$$ \\boxed{ \\frac{45 + 17A}{495 + 67A} } $$", "id": "2832435"}, {"introduction": "Having explored the mechanics and regulation of nondisjunction, we now turn to a practical challenge in genomics: inferring the past from present-day data. Different meiotic errors leave distinct footprints in the genome, which can be detected with SNP arrays. In this exercise, you will act as a computational geneticist, building a Bayesian classifier to determine whether a trisomy arose from an error in meiosis I or meiosis II [@problem_id:2832404]. This task synthesizes principles of genetics and statistics, reflecting the interdisciplinary nature of modern research into aneuploidy.", "problem": "You are given a set of independent samples from genotyped trisomic conceptuses on a single chromosome affected by non-disjunction. Each sample is summarized by features derived from Single Nucleotide Polymorphism (SNP) arrays measured in a fixed centromere-proximal window: the total number of SNPs $n$, the number of homozygous SNPs in that window $k$, the length of the longest contiguous run of homozygosity in that window $L$ (in SNPs, an integer with $L \\ge 1$), and the total number of crossovers inferred on the affected chromosome $K$ (a nonnegative integer). The task is to classify each sample as arising from Meiosis I (MI) non-disjunction or Meiosis II (MII) non-disjunction using a principled likelihood-based approach grounded in the following fundamental biological facts and statistical assumptions:\n\n- Biological foundations:\n  - In MI non-disjunction, homologous chromosomes fail to segregate, tending to produce heterodisomy at the centromere (distinct homologs), which reduces long runs of homozygosity near the centromere. In MII non-disjunction, sister chromatids fail to segregate, tending to produce isodisomy at the centromere (identical chromatids), which increases long runs of homozygosity near the centromere.\n  - Crossover formation modulates chromosome segregation and can be statistically modeled as a count process at the chromosome scale.\n\n- Statistical model and independence assumptions conditioned on origin:\n  - Prior probabilities: $P(\\mathrm{MI}) = 0.6$, $P(\\mathrm{MII}) = 0.4$.\n  - Homozygosity fraction near the centromere: conditional on origin $O \\in \\{\\mathrm{MI}, \\mathrm{MII}\\}$, $k \\mid n, O \\sim \\mathrm{Binomial}(n, \\theta_O)$ with $\\theta_{\\mathrm{MI}} = 0.2$ and $\\theta_{\\mathrm{MII}} = 0.8$.\n  - Longest run of homozygosity near the centromere: conditional on origin $O$, $L \\mid O \\sim \\mathrm{Geometric}(q_O)$ on $\\{1,2,\\dots\\}$ with probability mass function $P(L=\\ell \\mid O) = q_O (1 - q_O)^{\\ell - 1}$, where $q_{\\mathrm{MI}} = 0.25$ and $q_{\\mathrm{MII}} = 0.07$.\n  - Crossover count on the affected chromosome: conditional on origin $O$, $K \\mid O \\sim \\mathrm{Poisson}(\\mu_O)$ with $\\mu_{\\mathrm{MI}} = 0.8$ and $\\mu_{\\mathrm{MII}} = 1.6$.\n  - Conditional independence: given the origin $O$, the features $(k, L, K)$ are independent.\n\n- Classification objective:\n  - For each sample, compute the posterior probabilities $P(\\mathrm{MI} \\mid \\text{data})$ and $P(\\mathrm{MII} \\mid \\text{data})$ using Bayes’ rule starting from the above prior and likelihood assumptions. Classify a sample as MII if $P(\\mathrm{MII} \\mid \\text{data}) \\ge 0.5$; otherwise classify it as MI. In the case of exact equality at $0.5$, break ties in favor of MII.\n\n- Implementation constraints and numerical stability:\n  - Use the log domain to combine likelihoods and priors. You may omit additive constants that do not depend on the origin $O$ (e.g., the $\\log \\binom{n}{k}$ term in the binomial and the $\\log(K!)$ term in the Poisson) since they cancel in the posterior ratio.\n\nTest suite:\nProvide a program that implements the above classifier and applies it to the following six samples, each specified as a tuple $(n, k, L, K)$:\n\n1. $(100, 85, 40, 2)$\n2. $(100, 20, 3, 0)$\n3. $(100, 50, 10, 1)$\n4. $(100, 30, 50, 0)$\n5. $(100, 80, 2, 3)$\n6. $(50, 25, 1, 0)$\n\nRequired final output format:\n- Produce a single line of output containing the classifications for the six samples as a comma-separated list of integers enclosed in square brackets. Use $0$ to denote MI and $1$ to denote MII. For example, a valid output would be of the form $[c_1,c_2,c_3,c_4,c_5,c_6]$ where each $c_i \\in \\{0,1\\}$.", "solution": "The problem presented is a valid, well-posed exercise in Bayesian classification rooted in the principles of statistical genetics. It is scientifically grounded, free of contradictions, and contains all necessary information to derive a unique solution. I will proceed with the analysis.\n\nThe objective is to classify each sample, described by the data $D = (n, k, L, K)$, as originating from Meiosis I (MI) or Meiosis II (MII) non-disjunction. The classification rule is to select MII if its posterior probability is greater than or equal to $0.5$, i.e., $P(\\mathrm{MII} \\mid D) \\ge 0.5$, and MI otherwise.\n\nThis inequality is equivalent to comparing the posterior probabilities:\n$$P(\\mathrm{MII} \\mid D) \\ge P(\\mathrm{MI} \\mid D)$$\nUsing Bayes' theorem, $P(O \\mid D) = \\frac{P(D \\mid O)P(O)}{P(D)}$, where $O \\in \\{\\mathrm{MI}, \\mathrm{MII}\\}$. Since the denominator $P(D)$ is common to both posteriors, the inequality simplifies to a comparison of the numerators:\n$$P(D \\mid \\mathrm{MII})P(\\mathrm{MII}) \\ge P(D \\mid \\mathrm{MI})P(\\mathrm{MI})$$\nTo manage the product of probabilities and avoid numerical underflow, it is standard practice to work with log-probabilities. Taking the natural logarithm of both sides, the classification rule becomes:\n$$\\log(P(D \\mid \\mathrm{MII})) + \\log(P(\\mathrm{MII})) \\ge \\log(P(D \\mid \\mathrm{MI})) + \\log(P(\\mathrm{MI}))$$\nLet us define a score $S_O$ for each origin $O$ as the log-posterior-proportional term:\n$$S_O = \\log P(O) + \\log P(D \\mid O)$$\nThe rule is to classify the sample as MII if $S_{\\mathrm{MII}} \\ge S_{\\mathrm{MI}}$, and as MI otherwise.\n\nThe problem states that given the origin $O$, the features $k$, $L$, and $K$ are conditionally independent. Thus, the log-likelihood $\\log P(D \\mid O)$ can be expressed as the sum of the individual log-likelihoods:\n$$\\log P(D \\mid O) = \\log P(k \\mid n, O) + \\log P(L \\mid O) + \\log P(K \\mid O)$$\n\nAs specified, we can omit terms in the log-likelihoods that are constant with respect to the origin $O$, as they cancel out in the comparison of scores. Let's define the components of the score for each feature:\n\n1.  **Homozygosity Count ($k$)**: The distribution is $k \\mid n, O \\sim \\mathrm{Binomial}(n, \\theta_O)$. The probability mass function (PMF) is $P(k \\mid n, O) = \\binom{n}{k} \\theta_O^k (1-\\theta_O)^{n-k}$.\n    The log-likelihood is $\\log P(k \\mid n, O) = \\log\\binom{n}{k} + k\\log(\\theta_O) + (n-k)\\log(1-\\theta_O)$.\n    The term $\\log\\binom{n}{k}$ is independent of $O$ and can be dropped. The relevant component is:\n    $$\\log \\mathcal{L}_k(O) = k\\log(\\theta_O) + (n-k)\\log(1-\\theta_O)$$\n\n2.  **Longest Run of Homozygosity ($L$)**: The distribution is $L \\mid O \\sim \\mathrm{Geometric}(q_O)$ on $\\{1, 2, \\dots\\}$. The PMF is $P(L \\mid O) = q_O(1-q_O)^{L-1}$.\n    The log-likelihood is:\n    $$\\log \\mathcal{L}_L(O) = \\log(q_O) + (L-1)\\log(1-q_O)$$\n\n3.  **Crossover Count ($K$)**: The distribution is $K \\mid O \\sim \\mathrm{Poisson}(\\mu_O)$. The PMF is $P(K \\mid O) = \\frac{e^{-\\mu_O}\\mu_O^K}{K!}$.\n    The log-likelihood is $\\log P(K \\mid O) = -\\mu_O + K\\log(\\mu_O) - \\log(K!)$.\n    The term $\\log(K!)$ is independent of $O$ and can be dropped. The relevant component is:\n    $$\\log \\mathcal{L}_K(O) = -\\mu_O + K\\log(\\mu_O)$$\n    Note that if $K=0$, this term correctly evaluates to $-\\mu_O$.\n\nCombining these components, the total score for origin $O$ is:\n$$S_O = \\log P(O) + \\log \\mathcal{L}_k(O) + \\log \\mathcal{L}_L(O) + \\log \\mathcal{L}_K(O)$$\n\nThe parameters provided are:\n-   **Priors**: $P(\\mathrm{MI}) = 0.6$, $P(\\mathrm{MII}) = 0.4$.\n-   **MI Parameters**: $\\theta_{\\mathrm{MI}} = 0.2$, $q_{\\mathrm{MI}} = 0.25$, $\\mu_{\\mathrm{MI}} = 0.8$.\n-   **MII Parameters**: $\\theta_{\\mathrm{MII}} = 0.8$, $q_{\\mathrm{MII}} = 0.07$, $\\mu_{\\mathrm{MII}} = 1.6$.\n\nFor each test sample $(n, k, L, K)$, we will compute $S_{\\mathrm{MI}}$ and $S_{\\mathrm{MII}}$ and apply the decision rule. A classification of MI will be coded as $0$ and MII as $1$.\n\nExample Calculation for Sample 1: $(n, k, L, K)=(100, 85, 40, 2)$\n\n**Score for MI:**\n$S_{\\mathrm{MI}} = \\log(0.6) + [85\\log(0.2) + (100-85)\\log(0.8)] + [\\log(0.25) + (40-1)\\log(0.75)] + [-0.8 + 2\\log(0.8)]$\n$S_{\\mathrm{MI}} \\approx -0.5108 + [85(-1.6094) + 15(-0.2231)] + [-1.3863 + 39(-0.2877)] + [-0.8 + 2(-0.2231)]$\n$S_{\\mathrm{MI}} \\approx -0.5108 - 140.15 - 12.61 - 1.25 \\approx -154.52$\n\n**Score for MII:**\n$S_{\\mathrm{MII}} = \\log(0.4) + [85\\log(0.8) + (100-85)\\log(0.2)] + [\\log(0.07) + (40-1)\\log(0.93)] + [-1.6 + 2\\log(1.6)]$\n$S_{\\mathrm{MII}} \\approx -0.9163 + [85(-0.2231) + 15(-1.6094)] + [-2.6593 + 39(-0.0726)] + [-1.6 + 2(0.4700)]$\n$S_{\\mathrm{MII}} \\approx -0.9163 - 43.11 - 5.49 - 0.66 \\approx -50.18$\n\nSince $S_{\\mathrm{MII}} (-50.18) \\ge S_{\\mathrm{MI}} (-154.52)$, the classification for sample 1 is MII ($1$). This procedure is systematically applied to all provided samples in the implementation.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the classification problem for non-disjunction events based on a Bayesian model.\n    \"\"\"\n\n    # Define the statistical parameters for Meiosis I (MI) and Meiosis II (MII)\n    params = {\n        'MI': {\n            'prior': 0.6,\n            'theta': 0.2,  # Binomial parameter for homozygosity\n            'q': 0.25,     # Geometric parameter for run of homozygosity\n            'mu': 0.8,     # Poisson parameter for crossover count\n        },\n        'MII': {\n            'prior': 0.4,\n            'theta': 0.8,\n            'q': 0.07,\n            'mu': 1.6,\n        },\n    }\n\n    # Pre-compute log of parameters for efficiency and clarity\n    log_params = {\n        'MI': {\n            'log_prior': np.log(params['MI']['prior']),\n            'log_theta': np.log(params['MI']['theta']),\n            'log_1_minus_theta': np.log(1 - params['MI']['theta']),\n            'log_q': np.log(params['MI']['q']),\n            'log_1_minus_q': np.log(1 - params['MI']['q']),\n            'mu': params['MI']['mu'],\n            'log_mu': np.log(params['MI']['mu']),\n        },\n        'MII': {\n            'log_prior': np.log(params['MII']['prior']),\n            'log_theta': np.log(params['MII']['theta']),\n            'log_1_minus_theta': np.log(1 - params['MII']['theta']),\n            'log_q': np.log(params['MII']['q']),\n            'log_1_minus_q': np.log(1 - params['MII']['q']),\n            'mu': params['MII']['mu'],\n            'log_mu': np.log(params['MII']['mu']),\n        },\n    }\n\n    # Test suite of samples, each specified as (n, k, L, K)\n    test_cases = [\n        (100, 85, 40, 2),\n        (100, 20, 3, 0),\n        (100, 50, 10, 1),\n        (100, 30, 50, 0),\n        (100, 80, 2, 3),\n        (50, 25, 1, 0),\n    ]\n\n    def calculate_score(sample_data, origin):\n        \"\"\"\n        Calculates the log-posterior proportional score for a given origin (MI or MII).\n        \"\"\"\n        n, k, L, K = sample_data\n        p = log_params[origin]\n\n        # Log likelihood from homozygosity count (Binomial model)\n        # log_L_k = k * log(theta) + (n-k) * log(1-theta)\n        log_lk_k = k * p['log_theta'] + (n - k) * p['log_1_minus_theta']\n\n        # Log likelihood from longest run of homozygosity (Geometric model)\n        # log_L_L = log(q) + (L-1) * log(1-q)\n        log_lk_L = p['log_q'] + (L - 1) * p['log_1_minus_q']\n\n        # Log likelihood from crossover count (Poisson model)\n        # log_L_K = -mu + K * log(mu)\n        # The term K*log(mu) is 0 if K=0.\n        log_lk_K = -p['mu'] + (K * p['log_mu'] if K > 0 else 0)\n\n        # Total score is sum of log prior and log likelihoods\n        score = p['log_prior'] + log_lk_k + log_lk_L + log_lk_K\n        return score\n\n    results = []\n    for case in test_cases:\n        # Calculate scores for both MI and MII hypotheses\n        score_mi = calculate_score(case, 'MI')\n        score_mii = calculate_score(case, 'MII')\n\n        # Classify as MII if its score is greater or equal, MI otherwise.\n        # MII is coded as 1, MI as 0.\n        if score_mii >= score_mi:\n            results.append(1)  # MII\n        else:\n            results.append(0)  # MI\n            \n    # Print results in the required format\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2832404"}]}