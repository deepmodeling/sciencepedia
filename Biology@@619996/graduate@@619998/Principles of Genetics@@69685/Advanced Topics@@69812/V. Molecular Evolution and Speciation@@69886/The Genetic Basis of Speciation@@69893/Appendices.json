{"hands_on_practices": [{"introduction": "The Dobzhansky–Muller model provides the fundamental genetic framework for understanding postzygotic isolation, where negative epistatic interactions arise between alleles from divergent populations. A classic signature of these incompatibilities is hybrid breakdown, where F2 and later-generation hybrids exhibit lower fitness than the F1 generation. This exercise guides you through calculating this effect by comparing the mean viability of F1 and F2 hybrids, demonstrating how Mendelian segregation and recombination can expose novel combinations of alleles with deleterious consequences [@problem_id:2858277].", "problem": "In a Dobzhansky–Muller incompatibility (DMI) model of hybrid incompatibility between two diverged lineages, consider $2$ unlinked, autosomal, biallelic loci, denoted locus $A$ with alleles $a$ and $A$, and locus $B$ with alleles $b$ and $B$. Lineage $P_1$ is fixed for genotype $aa\\,bb$ and lineage $P_2$ is fixed for genotype $AA\\,BB$. When the derived alleles $A$ and $B$ co-occur in the same individual, they reduce viability. Assume Mendelian segregation, random mating, and no other evolutionary forces. Let $s_{AB} \\in (0,1)$ be the selection coefficient against the fully incompatible double-derived homozygote $AABB$ such that, absent any dominance, an $AABB$ individual would have viability reduced by a fraction $s_{AB}$ relative to a baseline of $1$. Incomplete dominance of the derived alleles at each locus scales this effect as follows: if an individual carries $i \\in \\{0,1,2\\}$ copies of allele $A$ and $j \\in \\{0,1,2\\}$ copies of allele $B$, its viability is\n$$\nw(i,j) \\;=\\; 1 \\;-\\; s_{AB}\\, d_i\\, d_j,\n$$\nwhere $d_0 = 0$, $d_1 = h$, $d_2 = 1$, and the dominance parameter satisfies $h \\in (0,1)$ to represent incomplete dominance at each locus. Thus, $AABB$ has viability $1 - s_{AB}$, $AaBb$ has viability $1 - s_{AB} h^2$, and genotypes lacking at least one of the derived alleles have viability $1$.\n\nConstruct the $F_1$ hybrid by crossing $P_1 \\times P_2$, then construct the $F_2$ by random mating among $F_1$ individuals. Under the assumptions above and treating the expected genotype distribution of $F_2$ zygotes under Mendelian segregation and free recombination, derive a closed-form expression for the ratio of the mean $F_2$ hybrid viability to the mean $F_1$ hybrid viability,\n$$\nR \\;=\\; \\frac{\\overline{w}_{F_2}}{\\overline{w}_{F_1}},\n$$\nas a function of $s_{AB}$ and $h$, simplified to its exact form. Provide $R$ as your final answer. Do not include any units.", "solution": "We begin from core principles of Mendelian genetics for unlinked loci under random mating and viability selection:\n- Mendelian segregation at a single locus from heterozygote $\\times$ heterozygote produces genotype frequencies $P(AA) = \\frac{1}{4}$, $P(Aa) = \\frac{1}{2}$, $P(aa) = \\frac{1}{4}$.\n- For unlinked loci, joint genotype frequencies factor as the product of marginals.\n- Mean viability is the expectation of the viability function over the zygotic genotype distribution prior to selection.\n\nDefine the viability mapping for the Dobzhansky–Muller incompatibility with incomplete dominance:\n$$\nw(i,j) \\;=\\; 1 - s_{AB}\\, d_i\\, d_j,\\quad d_0 = 0,\\; d_1 = h,\\; d_2 = 1,\\quad h \\in (0,1),\\; s_{AB} \\in (0,1).\n$$\nThis implies that a viability reduction occurs only when at least one $A$ allele and at least one $B$ allele co-occur, with the magnitude scaled by $d_i d_j$.\n\nFirst, compute the mean viability of $F_1$. The $F_1$ from $P_1: aabb$ and $P_2: AABB$ is uniformly $AaBb$, which corresponds to $(i,j) = (1,1)$. Therefore,\n$$\n\\overline{w}_{F_1} \\;=\\; w(1,1) \\;=\\; 1 - s_{AB}\\, d_1\\, d_1 \\;=\\; 1 - s_{AB} h^2.\n$$\n\nNext, compute the mean viability of $F_2$. The $F_2$ arises from random mating among $F_1$ individuals, which are all $Aa$ at locus $A$ and $Bb$ at locus $B$. At each locus independently, the Mendelian genotype frequencies among $F_2$ zygotes are\n$$\nP(i=2) = \\frac{1}{4},\\quad P(i=1) = \\frac{1}{2},\\quad P(i=0) = \\frac{1}{4},\n$$\nand similarly for $j$ at locus $B$. Because the loci are unlinked, the joint distribution factorizes, so the expectation of the product $d_i d_j$ equals the product of expectations,\n$$\n\\mathbb{E}[d_i d_j] \\;=\\; \\mathbb{E}[d_i]\\; \\mathbb{E}[d_j].\n$$\nBy symmetry, $\\mathbb{E}[d_i] = \\mathbb{E}[d_j]$, and\n$$\n\\mathbb{E}[d_i] \\;=\\; d_2 \\cdot \\frac{1}{4} \\;+\\; d_1 \\cdot \\frac{1}{2} \\;+\\; d_0 \\cdot \\frac{1}{4}\n\\;=\\; 1 \\cdot \\frac{1}{4} \\;+\\; h \\cdot \\frac{1}{2} \\;+\\; 0 \\cdot \\frac{1}{4}\n\\;=\\; \\frac{1}{4} \\;+\\; \\frac{h}{2}.\n$$\nTherefore,\n$$\n\\mathbb{E}[d_i d_j] \\;=\\; \\left(\\frac{1}{4} + \\frac{h}{2}\\right)^2 \\;=\\; \\left(\\frac{1 + 2h}{4}\\right)^2 \\;=\\; \\frac{(1 + 2h)^2}{16}.\n$$\nThe mean $F_2$ viability is the expectation of $w(i,j)$ over zygotes,\n$$\n\\overline{w}_{F_2} \\;=\\; \\mathbb{E}\\left[1 - s_{AB}\\, d_i\\, d_j\\right] \\;=\\; 1 - s_{AB}\\, \\mathbb{E}[d_i d_j]\n\\;=\\; 1 - s_{AB}\\, \\frac{(1 + 2h)^2}{16}.\n$$\n\nFinally, form the ratio\n$$\nR \\;=\\; \\frac{\\overline{w}_{F_2}}{\\overline{w}_{F_1}}\n\\;=\\; \\frac{1 - s_{AB}\\, \\frac{(1 + 2h)^2}{16}}{1 - s_{AB} h^2}.\n$$\n\nThis is the exact closed-form expression relating the mean $F_2$ and $F_1$ viabilities under the stated DMI model with incomplete dominance and unlinked loci. As a qualitative comparison, for $h \\in (0,1)$ and $s_{AB} \\in (0,1)$, one typically has $\\overline{w}_{F_2} \\le \\overline{w}_{F_1}$ because segregation and recombination expose more strongly penalized genotypes (for example, $AABB$, $AaBB$, and $AABb$) in $F_2$ than in the uniformly $AaBb$ $F_1$, which is consistent with hybrid breakdown in $F_2$. The exact magnitude of the reduction is captured by $R$ as derived above.", "answer": "$$\\boxed{\\frac{1 - s_{AB}\\,\\frac{(1+2h)^{2}}{16}}{1 - s_{AB}\\,h^{2}}}$$", "id": "2858277"}, {"introduction": "In nature, speciation is rarely the result of a single, absolute barrier to gene flow but rather the cumulative effect of multiple, often incomplete, barriers acting at both prezygotic and postzygotic stages. This practice challenges you to quantify the total reproductive isolation ($RI$) by combining the effects of assortative mating and reduced hybrid fitness within a standard multiplicative framework [@problem_id:2858297]. Mastering this calculation is a key skill for translating the effects of individual isolating mechanisms into a comprehensive measure of progress toward speciation.", "problem": "Two species, species $X$ and species $Y$, meet in sympatry and are present at equal adult frequencies $f_X = f_Y = \\tfrac{1}{2}$. Encounters between potential mates are random with respect to species identity, but mate choice produces assortative mating. Let the probability that a random mating involving a focal individual results in a conspecific pairing be $p_{CC}$ and the probability that it results in a heterospecific pairing be $p_{CH}$, with $p_{CC} + p_{CH} = 1$ and $0 \\leq p_{CH} \\leq \\tfrac{1}{2}$. Assume that conspecific crosses have relative fitness normalized to $1$ and that hybrids have relative fitness $w_H$ with $0 \\leq w_H \\leq 1$. There are no other barriers to gene flow beyond assortative mating and reduced hybrid fitness, and these barriers act sequentially and independently.\n\nUsing only fundamental definitions that (i) the potential interspecific gene flow under the null model is the probability of forming a heterospecific mating under random mating with no isolation, and (ii) sequential, independent barriers reduce the proportion of potential interspecific gene flow multiplicatively across stages, compute the total Reproductive Isolation (RI), defined as the proportional reduction in realized interspecific gene flow relative to the null model of random mating with no postzygotic selection. Express your answer as a single closed-form analytic expression in terms of $p_{CC}$, $p_{CH}$, and $w_H$.", "solution": "The objective is to compute the total Reproductive Isolation, $RI$. The problem defines $RI$ as the proportional reduction in realized interspecific gene flow ($G_R$) relative to the potential interspecific gene flow under a null model ($G_P$). This definition corresponds to the formula:\n$$RI = \\frac{G_P - G_R}{G_P} = 1 - \\frac{G_R}{G_P}$$\n\nWe must first compute $G_P$ and $G_R$.\n\n**1. Potential Interspecific Gene Flow ($G_P$)**\nThe potential flow, $G_P$, is defined as the probability of forming a heterospecific mating under the null model of random mating with no isolation. Given two species, $X$ and $Y$, with frequencies $f_X$ and $f_Y$, the probability of a mating between an individual of species $X$ and an individual of species $Y$ under random mating is the sum of the probabilities of the two possible heterospecific pairings ($X \\times Y$ and $Y \\times X$).\n$$G_P = f_X f_Y + f_Y f_X = 2 f_X f_Y$$\nThe problem states that the species are at equal frequencies, $f_X = f_Y = \\frac{1}{2}$. Substituting these values:\n$$G_P = 2 \\left(\\frac{1}{2}\\right) \\left(\\frac{1}{2}\\right) = \\frac{1}{2}$$\nThis is the baseline level of interspecific gene flow against which isolation is measured.\n\n**2. Realized Interspecific Gene Flow ($G_R$)**\nThe realized flow, $G_R$, is the potential flow, $G_P$, after being reduced by the existing barriers to gene flow. The problem specifies two barriers acting sequentially and independently: assortative mating (prezygotic) and reduced hybrid fitness (postzygotic). Their effect is a multiplicative reduction of gene flow.\n\nLet $L_{total}$ be the total \"leakage,\" which is the proportion of potential gene flow that successfully passes through all barriers. Then $G_R = G_P \\times L_{total}$. The total leakage is the product of the leakages of individual barriers: $L_{total} = L_{pre} \\times L_{post}$.\n\n**a. Prezygotic Barrier Leakage ($L_{pre}$)**\nThis barrier is assortative mating. The potential proportion of matings that are heterospecific is $G_P = \\frac{1}{2}$. The problem states that due to assortative mating, the actual probability of a heterospecific pairing is $p_{CH}$. The leakage of the prezygotic barrier is the ratio of the actual rate of heterospecific mating to the potential rate:\n$$L_{pre} = \\frac{\\text{Actual heterospecific mating rate}}{\\text{Potential heterospecific mating rate}} = \\frac{p_{CH}}{G_P} = \\frac{p_{CH}}{1/2} = 2 p_{CH}$$\n\n**b. Postzygotic Barrier Leakage ($L_{post}$)**\nThis barrier is the reduced fitness of hybrids. It acts on the zygotes formed from heterospecific matings. The relative fitness of hybrids is given as $w_H$. This value, by definition, represents the proportion of the genetic contribution from hybrid offspring that successfully enters the next generation, relative to conspecific offspring. Therefore, the leakage of the postzygotic barrier is simply the relative fitness of the hybrids:\n$$L_{post} = w_H$$\n\n**c. Total Leakage and Realized Flow**\nThe total leakage is the product of the individual leakages:\n$$L_{total} = L_{pre} \\times L_{post} = (2 p_{CH}) w_H = 2 p_{CH} w_H$$\nNow, we can compute the realized interspecific gene flow:\n$$G_R = G_P \\times L_{total} = \\frac{1}{2} \\times (2 p_{CH} w_H) = p_{CH} w_H$$\n\n**3. Total Reproductive Isolation ($RI$)**\nFinally, we substitute the expressions for $G_P$ and $G_R$ into the definition of $RI$:\n$$RI = 1 - \\frac{G_R}{G_P} = 1 - \\frac{p_{CH} w_H}{1/2}$$\n$$RI = 1 - 2 p_{CH} w_H$$\nThis expression is in terms of the specified variables, including $p_{CH}$ and $w_H$. The variable $p_{CC}$ is related by $p_{CC} = 1 - p_{CH}$ but is not required for the most compact form of the answer. The expression represents the total proportional reduction in gene flow due to the combined effects of assortative mating and selection against hybrids.", "answer": "$$\\boxed{1 - 2 p_{CH} w_H}$$", "id": "2858297"}, {"introduction": "While calculating the strength of existing barriers provides a static snapshot, the process of speciation is fundamentally dynamic, involving complex feedbacks over evolutionary time. For instance, reinforcement can drive the evolution of prezygotic isolation in response to the production of low-fitness hybrids. This advanced computational exercise guides you in building a dynamic model to simulate the interplay between the accumulation of postzygotic incompatibilities, the evolution of mating preferences, and changes in recombination rates [@problem_id:2858264]. By modeling these coupled processes, you can explore how their interactions determine the trajectory and timeline for the completion of speciation.", "problem": "You are asked to implement and analyze a mechanistic model for the completion of speciation under multiple, multiplicatively combining barriers to gene flow when recombination evolves. The scenario is framed in terms of well-established principles in the principles of genetics, specifically the genetic basis of speciation.\n\nModeling assumptions and fundamental bases:\n- Use the standard definition of effective migration rate: the realized cross-population gene flow is reduced by reproductive barriers that act at distinct stages and combine multiplicatively. If the baseline migration rate is $m_{0}$ and the residual fraction of gene flow after all barriers is $R(t)$, then the effective migration rate at generation $t$ is $m_{\\mathrm{eff}}(t) = m_{0} \\cdot R(t)$.\n- The composite residual fraction is multiplicative across barrier classes. We consider two barrier classes: a genome-wide postzygotic barrier arising from many loci and a prezygotic barrier arising via reinforcement. If the residual fraction for genome-wide barriers is $R_{\\mathrm{G}}(t)$ and the residual fraction for prezygotic isolation is $R_{\\mathrm{P}}(t)$, then $R(t) = R_{\\mathrm{G}}(t) \\cdot R_{\\mathrm{P}}(t)$.\n- Genome-wide postzygotic barrier: treat the genome as accumulating $L(t)$ barrier loci of average effect size $b_{0}$ (per-locus proportional reduction of successful gene flow). For multiplicative combination across loci, the genome-wide residual fraction is $R_{\\mathrm{G}}(t) = \\left(1 - b_{0}\\right)^{L(t)}$, with $b_{0} \\in (0,1)$ and $L(t) \\in [0, L_{\\max}]$. This reflects the well-tested multiplicative action of independent barriers on gene flow.\n- Prezygotic barrier via reinforcement: let $P(t) \\in [0, 1)$ denote the strength of prezygotic isolation (as the fraction of potential matings avoided). Its residual fraction is $R_{\\mathrm{P}}(t) = 1 - P(t)$, consistent with the definition that $P(t)$ measures proportional avoidance.\n- Recombination evolves due to selection for tighter linkage (in the presence of many barrier loci, reduced recombination strengthens coupling among barrier alleles). Let $c(t)$ denote an effective recombination rate, constrained to $c(t) \\ge c_{\\min} > 0$.\n\nCoupling and rates:\n- Define a coupling factor $K(c)$ that increases as recombination decreases, capturing stronger multilocus coupling under lower recombination: \n$$\nK(c) = \\frac{1}{1 + \\frac{c}{c_{0}}}\n$$\nwith scaling parameter $c_{0} > 0$.\n- Let barrier loci accumulate logistically toward $L_{\\max}$ at a rate modulated by coupling:\n$$\n\\frac{dL}{dt} = \\mu_{b} \\cdot K\\!\\left(c(t)\\right) \\cdot \\left(1 - \\frac{L(t)}{L_{\\max}}\\right)\n$$\nwith $\\mu_{b} > 0$ the baseline accumulation rate of barrier loci and $L(0) = 0$.\n- Let prezygotic isolation $P(t)$ increase via reinforcement proportional to the hybrid fitness deficit $D(t)$ and the remaining capacity for increase:\n$$\n\\frac{dP}{dt} = \\rho \\cdot D(t) \\cdot \\left(1 - P(t)\\right),\n$$\nwith reinforcement rate $\\rho \\ge 0$, $P(0) = 0$, and \n$$\nD(t) = d_{0} \\cdot K\\!\\left(c(t)\\right) \\cdot L(t),\n$$\nwhere $d_{0} > 0$ scales the per-locus hybrid deficit.\n- Let recombination evolve under selection for tighter linkage toward a lower bound $c_{\\min}$, with strength increasing in both coupling and the number of barrier loci:\n$$\n\\frac{dc}{dt} = -\\gamma \\cdot K\\!\\left(c(t)\\right) \\cdot L(t) \\cdot \\left(c(t) - c_{\\min}\\right),\n$$\nwith $\\gamma \\ge 0$ and initial $c(0) = c_{\\mathrm{init}} \\ge c_{\\min}$.\n\nEffective migration:\n- With multiplicatively combining barriers, the effective migration rate at time $t$ is\n$$\nm_{\\mathrm{eff}}(t) = m_{0} \\cdot \\left(1 - P(t)\\right) \\cdot \\left(1 - b_{0}\\right)^{L(t)}.\n$$\n- Define “speciation completion” operationally as the first time $t$ such that $m_{\\mathrm{eff}}(t) \\le m_{\\mathrm{thr}}$, where $m_{\\mathrm{thr}}$ is a specified near-zero threshold.\n\nNumerical method requirements:\n- Implement an explicit Euler method with fixed time step $\\Delta t$ to update the state variables $L(t)$, $P(t)$, and $c(t)$. At each step, compute $K\\!\\left(c(t)\\right)$, update derivatives according to the above rules, and constrain the variables after each step by clipping to their biologically valid ranges: $L(t) \\in [0, L_{\\max}]$, $P(t) \\in [0, 1)$, $c(t) \\in [c_{\\min}, +\\infty)$.\n- Use the stopping condition $m_{\\mathrm{eff}}(t) \\le m_{\\mathrm{thr}}$. If this condition is not met by a fixed maximum time horizon $T_{\\max}$, report failure.\n\nUnits and output:\n- Time must be expressed in units of generations, as a real number (float). Report the time of first crossing of the threshold rounded to one decimal place.\n- If the threshold is not reached by $T_{\\max}$ generations, output the sentinel value $-1.0$ for that test case.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[result1,result2,result3]\").\n\nTest suite and parameters:\n- Use explicit Euler time step $\\Delta t = 0.5$, maximum time horizon $T_{\\max} = 100000$ generations.\n- For each test case, the state is initialized at $L(0) = 0$, $P(0) = 0$, $c(0) = c_{\\mathrm{init}}$, and $t = 0$.\n\nProvide results for the following five parameter sets, each as a single simulation returning the time to speciation completion in generations (rounded to one decimal place) or $-1.0$ if not completed:\n\n1) Happy-path, moderate coupling evolution and reinforcement:\n- $m_{0} = 0.1$, $b_{0} = 0.02$, $\\mu_{b} = 0.02$, $L_{\\max} = 300$, $\\rho = 0.01$, $d_{0} = 0.01$, $c_{0} = 0.5$, $c_{\\mathrm{init}} = 0.5$, $\\gamma = 0.01$, $c_{\\min} = 0.01$, $m_{\\mathrm{thr}} = 1\\times 10^{-6}$.\n\n2) No reinforcement (prezygotic isolation absent), same other parameters as in test $1$ except $\\rho = 0$:\n- $m_{0} = 0.1$, $b_{0} = 0.02$, $\\mu_{b} = 0.02$, $L_{\\max} = 300$, $\\rho = 0$, $d_{0} = 0.01$, $c_{0} = 0.5$, $c_{\\mathrm{init}} = 0.5$, $\\gamma = 0.01$, $c_{\\min} = 0.01$, $m_{\\mathrm{thr}} = 1\\times 10^{-6}$.\n\n3) Stronger per-locus barrier and faster barrier accumulation:\n- $m_{0} = 0.1$, $b_{0} = 0.05$, $\\mu_{b} = 0.03$, $L_{\\max} = 300$, $\\rho = 0.01$, $d_{0} = 0.01$, $c_{0} = 0.5$, $c_{\\mathrm{init}} = 0.5$, $\\gamma = 0.01$, $c_{\\min} = 0.01$, $m_{\\mathrm{thr}} = 1\\times 10^{-6}$.\n\n4) Slow barrier accumulation, no reinforcement, no recombination evolution (edge case likely to fail within horizon):\n- $m_{0} = 0.1$, $b_{0} = 0.02$, $\\mu_{b} = 0.001$, $L_{\\max} = 300$, $\\rho = 0$, $d_{0} = 0.01$, $c_{0} = 0.5$, $c_{\\mathrm{init}} = 0.5$, $\\gamma = 0$, $c_{\\min} = 0.01$, $m_{\\mathrm{thr}} = 1\\times 10^{-6}$.\n\n5) High initial recombination and slower evolution of recombination:\n- $m_{0} = 0.1$, $b_{0} = 0.02$, $\\mu_{b} = 0.02$, $L_{\\max} = 300$, $\\rho = 0.01$, $d_{0} = 0.01$, $c_{0} = 0.5$, $c_{\\mathrm{init}} = 1.5$, $\\gamma = 0.005$, $c_{\\min} = 0.01$, $m_{\\mathrm{thr}} = 1\\times 10^{-6}$.\n\nFinal output format:\n- Your program must output a single line in the exact format \"[x1,x2,x3,x4,x5]\" where each $x_{i}$ is the computed time in generations rounded to one decimal place, or $-1.0$ if the threshold is not achieved by $T_{\\max}$.", "solution": "The model tracks the evolution of three state variables over time $t$ (in generations): the number of postzygotic barrier loci $L(t)$, the strength of prezygotic isolation $P(t)$, and the effective recombination rate $c(t)$.\n\nThe governing dynamics are defined by the following system of first-order ordinary differential equations:\n$1$. The number of barrier loci, $L(t)$, accumulates logistically towards a maximum $L_{\\max}$:\n$$\n\\frac{dL}{dt} = \\mu_{b} \\cdot K\\!\\left(c(t)\\right) \\cdot \\left(1 - \\frac{L(t)}{L_{\\max}}\\right)\n$$\nwhere $\\mu_{b}$ is the baseline accumulation rate and $K(c(t))$ is a coupling factor that depends on the recombination rate $c(t)$. The initial condition is $L(0) = 0$.\n\n$2$. The strength of prezygotic isolation, $P(t)$, evolves via reinforcement, driven by the fitness deficit of hybrids, $D(t)$:\n$$\n\\frac{dP}{dt} = \\rho \\cdot D(t) \\cdot \\left(1 - P(t)\\right)\n$$\nwhere $\\rho$ is the reinforcement rate. The hybrid deficit is defined as $D(t) = d_{0} \\cdot K\\!\\left(c(t)\\right) \\cdot L(t)$. The initial condition is $P(0) = 0$.\n\n$3$. The effective recombination rate, $c(t)$, evolves towards a minimum value $c_{\\min}$ under selection for tighter linkage, with the strength of selection depending on the number of barrier loci and the coupling strength:\n$$\n\\frac{dc}{dt} = -\\gamma \\cdot K\\!\\left(c(t)\\right) \\cdot L(t) \\cdot \\left(c(t) - c_{\\min}\\right)\n$$\nwhere $\\gamma$ is the rate of recombination evolution, and the initial condition is $c(0) = c_{\\mathrm{init}}$.\n\nThe coupling factor $K(c)$ is given by:\n$$\nK(c) = \\frac{1}{1 + \\frac{c}{c_{0}}}\n$$\nwhere $c_{0}$ is a scaling parameter.\n\nThe effective migration rate, $m_{\\mathrm{eff}}(t)$, which measures the overall gene flow between populations, combines these effects multiplicatively:\n$$\nm_{\\mathrm{eff}}(t) = m_{0} \\cdot \\left(1 - P(t)\\right) \\cdot \\left(1 - b_{0}\\right)^{L(t)}\n$$\nwhere $m_{0}$ is the baseline migration rate and $b_{0}$ is the average effect size of a single barrier locus. Speciation is considered complete when $m_{\\mathrm{eff}}(t)$ drops below a threshold $m_{\\mathrm{thr}}$.\n\nTo solve this system, we will implement the specified numerical method, the explicit Euler method, with a fixed time step $\\Delta t = 0.5$. The simulation for each parameter set starts at $t=0$ with the initial conditions $L(0) = 0$, $P(0) = 0$, and $c(0) = c_{\\mathrm{init}}$.\n\nThe iterative update procedure for each time step from $t$ to $t+\\Delta t$ is as follows:\n$1$. Calculate the derivatives $\\frac{dL}{dt}$, $\\frac{dP}{dt}$, and $\\frac{dc}{dt}$ using the state variables $L(t)$, $P(t)$, and $c(t)$.\n$2$. Update the state variables using the Euler forward rule:\n$$\nL(t+\\Delta t) = L(t) + \\Delta t \\cdot \\frac{dL}{dt}\n$$\n$$\nP(t+\\Delta t) = P(t) + \\Delta t \\cdot \\frac{dP}{dt}\n$$\n$$\nc(t+\\Delta t) = c(t) + \\Delta t \\cdot \\frac{dc}{dt}\n$$\n$3$. After each update, the variables are constrained to their valid ranges by clipping. As specified, $L$ is clipped to $[0, L_{\\max}]$, $P$ is clipped to $[0, 1)$, and $c$ is clipped to $[c_{\\min}, +\\infty)$. The upper bound for $P$ is strictly less than $1$, which will be implemented by clipping to the largest floating-point number less than $1.0$.\n$4$. Calculate the new effective migration rate $m_{\\mathrm{eff}}(t+\\Delta t)$.\n$5$. Check the stopping condition: if $m_{\\mathrm{eff}}(t+\\Delta t) \\le m_{\\mathrm{thr}}$, the simulation terminates, and the current time $t+\\Delta t$ is recorded as the time to speciation.\n$6$. If the time exceeds the maximum horizon $T_{\\max} = 100000$ generations without the threshold being met, the simulation terminates and returns a sentinel value of $-1.0$.\n\nThis entire procedure is executed for each of the $5$ parameter sets provided in the problem statement. The final output will be a list of the resulting times to speciation, rounded to one decimal place.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the speciation model for the given test cases.\n    \"\"\"\n\n    test_cases = [\n        # 1) Happy-path, moderate coupling evolution and reinforcement\n        {'m0': 0.1, 'b0': 0.02, 'mu_b': 0.02, 'L_max': 300, 'rho': 0.01,\n         'd0': 0.01, 'c0': 0.5, 'c_init': 0.5, 'gamma': 0.01, 'c_min': 0.01,\n         'm_thr': 1e-6},\n        # 2) No reinforcement (prezygotic isolation absent)\n        {'m0': 0.1, 'b0': 0.02, 'mu_b': 0.02, 'L_max': 300, 'rho': 0,\n         'd0': 0.01, 'c0': 0.5, 'c_init': 0.5, 'gamma': 0.01, 'c_min': 0.01,\n         'm_thr': 1e-6},\n        # 3) Stronger per-locus barrier and faster barrier accumulation\n        {'m0': 0.1, 'b0': 0.05, 'mu_b': 0.03, 'L_max': 300, 'rho': 0.01,\n         'd0': 0.01, 'c0': 0.5, 'c_init': 0.5, 'gamma': 0.01, 'c_min': 0.01,\n         'm_thr': 1e-6},\n        # 4) Slow barrier accumulation, no reinforcement, no recombination evolution\n        {'m0': 0.1, 'b0': 0.02, 'mu_b': 0.001, 'L_max': 300, 'rho': 0,\n         'd0': 0.01, 'c0': 0.5, 'c_init': 0.5, 'gamma': 0, 'c_min': 0.01,\n         'm_thr': 1e-6},\n        # 5) High initial recombination and slower evolution of recombination\n        {'m0': 0.1, 'b0': 0.02, 'mu_b': 0.02, 'L_max': 300, 'rho': 0.01,\n         'd0': 0.01, 'c0': 0.5, 'c_init': 1.5, 'gamma': 0.005, 'c_min': 0.01,\n         'm_thr': 1e-6}\n    ]\n\n    # Global numerical parameters\n    dt = 0.5\n    T_max = 100000.0\n    \n    # Represents the strict upper bound for P, i.e., P < 1.0\n    P_UPPER_BOUND = np.nextafter(1.0, 0.0)\n\n    results = []\n    \n    for params in test_cases:\n        # Unpack parameters\n        m0, b0, mu_b, L_max, rho = params['m0'], params['b0'], params['mu_b'], params['L_max'], params['rho']\n        d0, c0, c_init, gamma, c_min = params['d0'], params['c0'], params['c_init'], params['gamma'], params['c_min']\n        m_thr = params['m_thr']\n\n        # Initialize state variables\n        L = 0.0\n        P = 0.0\n        c = c_init\n        t = 0.0\n        \n        # Check initial condition\n        m_eff = m0 * (1.0 - P) * ((1.0 - b0) ** L)\n        if m_eff <= m_thr:\n            results.append(0.0)\n            continue\n            \n        speciation_time = -1.0\n        \n        while t < T_max:\n            # Calculate derivatives at current state t\n            K_c = 1.0 / (1.0 + c / c0)\n            dL_dt = mu_b * K_c * (1.0 - L / L_max)\n            D_t = d0 * K_c * L\n            dP_dt = rho * D_t * (1.0 - P)\n            dc_dt = -gamma * K_c * L * (c - c_min)\n            \n            # Update state variables using explicit Euler method\n            L += dt * dL_dt\n            P += dt * dP_dt\n            c += dt * dc_dt\n            \n            # Apply constraints (clipping)\n            L = max(0.0, min(L, L_max))\n            P = max(0.0, min(P, P_UPPER_BOUND))\n            c = max(c_min, c)\n            \n            # Update time\n            t += dt\n            \n            # Calculate effective migration rate at new time t\n            m_eff = m0 * (1.0 - P) * ((1.0 - b0) ** L)\n            \n            # Check for speciation completion\n            if m_eff <= m_thr:\n                speciation_time = round(t, 1)\n                break\n        \n        results.append(speciation_time)\n        \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```", "id": "2858264"}]}