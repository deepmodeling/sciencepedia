{"hands_on_practices": [{"introduction": "To truly understand Haldane's rule, we must first grasp its genetic architecture. This exercise [@problem_id:2820483] provides a fundamental model of a Dobzhansky–Muller incompatibility (DMI), a negative epistatic interaction between alleles that evolved in separate lineages. By systematically tracking alleles at an X-linked and an autosomal locus through reciprocal crosses, you will explore how dominance relationships can cause hybrid dysfunction to manifest asymmetrically, selectively affecting the heterogametic sex—a key insight of the dominance theory.", "problem": "Two species, $\\mathrm{S}_1$ and $\\mathrm{S}_2$, are fixed for different alleles at two loci that form a Dobzhansky–Muller incompatibility (DMI). One locus is on the $X$ chromosome (alleles $X^{a}$ ancestral, $X^{d}$ derived), and one locus is autosomal (alleles $A^{a}$ ancestral, $A^{d}$ derived). Species $\\mathrm{S}_1$ is fixed for $X^{d}$ at the $X$-linked locus and $A^{a}$ at the autosomal locus; species $\\mathrm{S}_2$ is fixed for $X^{a}$ and $A^{d}$ at the respective loci. Assume an $XY$ sex-determination system with males the heterogametic sex ($XY$) and females the homogametic sex ($XX$). The first filial generation (F1) arises from reciprocal crosses with standard Mendelian transmission and a $1:1$ sex ratio in the offspring of each cross.\n\nA DMI phenotype (inviability or sterility) is expressed when the derived alleles meet and are not masked by dominance. Consider two dominance models for the DMI:\n\n- Model A (classic recessive $X$-linked by dominant autosomal interaction): The derived $X$-linked allele $X^{d}$ is fully recessive in diploid females and fully expressed in hemizygous males; the derived autosomal allele $A^{d}$ is fully dominant (one copy suffices) in the interaction. The DMI phenotype is expressed in an individual if and only if that individual both carries $A^{d}$ (in any $A^{a}/A^{d}$ or $A^{d}/A^{d}$ state) and has $X^{d}$ in an expressed state (hemizygous $X^{d}/Y$ in males or homozygous $X^{d}/X^{d}$ in females).\n- Model B (both derived alleles fully recessive): The derived $X$-linked allele $X^{d}$ is fully recessive in diploid females and fully expressed in hemizygous males; the derived autosomal allele $A^{d}$ is fully recessive, requiring $A^{d}/A^{d}$ to contribute to the DMI. The DMI phenotype is expressed in an individual if and only if that individual is $A^{d}/A^{d}$ and has $X^{d}$ in an expressed state (hemizygous $X^{d}/Y$ or homozygous $X^{d}/X^{d}$).\n\nTasks:\n1. Construct the expected F1 genotypes at the $X$-linked and autosomal DMI loci for both reciprocal crosses $\\mathrm{S}_1 \\, ♀ \\times \\mathrm{S}_2 \\, ♂$ and $\\mathrm{S}_2 \\, ♀ \\times \\mathrm{S}_1 \\, ♂$, listing genotypes separately for F1 females and F1 males.\n2. For each dominance model (Model A and Model B), identify which F1 genotypes (if any) will express the DMI phenotype in each reciprocal cross and in each sex, justifying your identification from first principles of Mendelian inheritance and dominance/hemizygosity.\n3. Assuming the two reciprocal cross directions occur with equal probability and that each F1 family has a $1:1$ sex ratio, under Model A only, compute the expected proportion of all F1 individuals (across both cross directions and both sexes) that will express the DMI phenotype. Express your final answer as a simplified fraction.", "solution": "The problem statement is scientifically grounded, well-posed, and objective. It provides a complete and consistent set of givens to model a classic case of Dobzhansky–Muller incompatibility (DMI), a fundamental concept in speciation genetics. All necessary information regarding parental genotypes, inheritance patterns, and the specific conditions for the expression of the DMI phenotype are clearly defined. Therefore, a rigorous solution can be derived from first principles.\n\nThe solution is organized into three parts, corresponding to the tasks specified in the problem statement.\n\n### Task 1: Determination of F1 Genotypes\n\nWe must determine the genotypes of the first filial ($F_1$) generation resulting from reciprocal crosses between species $\\mathrm{S}_1$ and $\\mathrm{S}_2$. The sex determination system is $XY$, where males are the heterogametic sex ($XY$) and females are the homogametic sex ($XX$). The $X$ chromosome carries one DMI locus, and an autosome carries the second.\n\nThe parental species ($\\mathrm{P}$) have the following genotypes:\n-   Species $\\mathrm{S}_1$: Females are $X^{d}X^{d}; A^{a}A^{a}$ and males are $X^{d}Y; A^{a}A^{a}$.\n-   Species $\\mathrm{S}_2$: Females are $X^{a}X^{a}; A^{d}A^{d}$ and males are $X^{a}Y; A^{d}A^{d}$.\n\nWe analyze each reciprocal cross separately.\n\n**Cross 1: $\\mathrm{S}_1 \\, ♀ \\times \\mathrm{S}_2 \\, ♂$**\n-   Parental genotypes: $\\mathrm{S}_1 \\, ♀ (X^{d}X^{d}; A^{a}A^{a}) \\times \\mathrm{S}_2 \\, ♂ (X^{a}Y; A^{d}A^{d})$.\n-   Gamete production:\n    -   The $\\mathrm{S}_1$ female produces only one type of gamete: $X^{d}; A^{a}$.\n    -   The $\\mathrm{S}_2$ male produces two types of gametes in equal proportions: $X^{a}; A^{d}$ and $Y; A^{d}$.\n-   Resulting $F_1$ offspring:\n    -   $F_1$ Females: Fertilization of an $X^{d}; A^{a}$ ovum by an $X^{a}; A^{d}$ sperm results in the genotype $X^{d}X^{a}; A^{a}A^{d}$.\n    -   $F_1$ Males: Fertilization of an $X^{d}; A^{a}$ ovum by a $Y; A^{d}$ sperm results in the genotype $X^{d}Y; A^{a}A^{d}$.\n\n**Cross 2: $\\mathrm{S}_2 \\, ♀ \\times \\mathrm{S}_1 \\, ♂$**\n-   Parental genotypes: $\\mathrm{S}_2 \\, ♀ (X^{a}X^{a}; A^{d}A^{d}) \\times \\mathrm{S}_1 \\, ♂ (X^{d}Y; A^{a}A^{a})$.\n-   Gamete production:\n    -   The $\\mathrm{S}_2$ female produces only one type of gamete: $X^{a}; A^{d}$.\n    -   The $\\mathrm{S}_1$ male produces two types of gametes in equal proportions: $X^{d}; A^{a}$ and $Y; A^{a}$.\n-   Resulting $F_1$ offspring:\n    -   $F_1$ Females: Fertilization of an $X^{a}; A^{d}$ ovum by an $X^{d}; A^{a}$ sperm results in the genotype $X^{a}X^{d}; A^{d}A^{a}$.\n    -   $F_1$ Males: Fertilization of an $X^{a}; A^{d}$ ovum by a $Y; A^{a}$ sperm results in the genotype $X^{a}Y; A^{d}A^{a}$.\n\nSummary of $F_1$ genotypes:\n-   From cross $\\mathrm{S}_1 \\, ♀ \\times \\mathrm{S}_2 \\, ♂$:\n    -   Females: $X^{d}X^{a}; A^{a}A^{d}$\n    -   Males: $X^{d}Y; A^{a}A^{d}$\n-   From cross $\\mathrm{S}_2 \\, ♀ \\times \\mathrm{S}_1 \\, ♂$:\n    -   Females: $X^{a}X^{d}; A^{d}A^{a}$ (Note: this is identical to the female genotype from Cross 1)\n    -   Males: $X^{a}Y; A^{d}A^{a}$\n\n### Task 2: Identification of F1 Inviability/Sterility\n\nWe will now apply the conditions for the DMI phenotype under each specified model to the $F_1$ genotypes derived above.\n\n**Analysis for Model A:**\nThe DMI phenotype is expressed if and only if an individual:\n$1$. Carries at least one copy of the derived autosomal allele $A^{d}$ (dominance).\n$2$. Has the derived $X$-linked allele $X^{d}$ in an expressed state, which is hemizygosity ($X^{d}Y$) in males or homozygosity ($X^{d}X^{d}$) in females, as $X^{d}$ is recessive.\n\n-   **$F_1$ Females ($X^{d}X^{a}; A^{a}A^{d}$ from both crosses):**\n    -   Condition $1$: They are heterozygous $A^{a}A^{d}$, so they carry the $A^{d}$ allele. The condition is met.\n    -   Condition $2$: They are heterozygous $X^{d}X^{a}$. Since $X^{d}$ is recessive to $X^{a}$, the allele is not in an expressed state. The condition is not met.\n    -   Conclusion: $F_1$ females are **not affected** by the DMI under Model A.\n\n-   **$F_1$ Males from Cross 1 ($\\mathrm{S}_1\\,♀ \\times \\mathrm{S}_2\\,♂$), genotype $X^{d}Y; A^{a}A^{d}$:**\n    -   Condition $1$: They are heterozygous $A^{a}A^{d}$, so they carry the $A^{d}$ allele. The condition is met.\n    -   Condition $2$: They are hemizygous $X^{d}Y$. The $X^{d}$ allele is in an expressed state. The condition is met.\n    -   Conclusion: $F_1$ males from this cross are **affected** by the DMI under Model A.\n\n-   **$F_1$ Males from Cross 2 ($\\mathrm{S}_2\\,♀ \\times \\mathrm{S}_1\\,♂$), genotype $X^{a}Y; A^{d}A^{a}$:**\n    -   Condition $1$: They are heterozygous $A^{d}A^{a}$, so they carry the $A^{d}$ allele. The condition is met.\n    -   Condition $2$: They are hemizygous $X^{a}Y$. They do not carry the $X^{d}$ allele. The condition is not met.\n    -   Conclusion: $F_1$ males from this cross are **not affected** by the DMI under Model A.\n\n**Analysis for Model B:**\nThe DMI phenotype is expressed if and only if an individual:\n$1$. Is homozygous for the derived autosomal allele, $A^{d}A^{d}$ (recessivity).\n$2$. Has the derived $X$-linked allele $X^{d}$ in an expressed state ($X^{d}Y$ or $X^{d}X^{d}$).\n\n-   **$F_1$ Females ($X^{d}X^{a}; A^{a}A^{d}$ from both crosses):**\n    -   Condition $1$: They are heterozygous $A^{a}A^{d}$. They are not homozygous $A^{d}A^{d}$. The condition is not met.\n    -   Conclusion: $F_1$ females are **not affected** by the DMI under Model B.\n\n-   **$F_1$ Males from Cross 1 ($X^{d}Y; A^{a}A^{d}$):**\n    -   Condition $1$: They are heterozygous $A^{a}A^{d}$. They are not homozygous $A^{d}A^{d}$. The condition is not met.\n    -   Conclusion: $F_1$ males from this cross are **not affected** by the DMI under Model B.\n\n-   **$F_1$ Males from Cross 2 ($X^{a}Y; A^{d}A^{a}$):**\n    -   Condition $1$: They are heterozygous $A^{d}A^{a}$. They are not homozygous $A^{d}A^{d}$. The condition is not met.\n    -   Conclusion: $F_1$ males from this cross are **not affected** by the DMI under Model B.\n\nIn summary, under Model B, none of the $F_1$ genotypes express the DMI phenotype. The incompatibility only appears in the $F_1$ generation under Model A, and only in males from one of the reciprocal crosses. This asymmetric outcome in the heterogametic sex is a classic example of Haldane's rule.\n\n### Task 3: Proportion of Affected F1 Individuals under Model A\n\nWe are asked to compute the expected proportion of all $F_1$ individuals expressing the DMI phenotype under Model A. The problem states to assume that the two reciprocal cross directions occur with equal probability and that each cross produces a $1:1$ sex ratio.\n\nLet the total population of $F_1$ offspring be $N$.\n-   The number of offspring from Cross 1 ($\\mathrm{S}_1\\,♀ \\times \\mathrm{S}_2\\,♂$) is $\\frac{1}{2}N$.\n-   The number of offspring from Cross 2 ($\\mathrm{S}_2\\,♀ \\times \\mathrm{S}_1\\,♂$) is $\\frac{1}{2}N$.\n\nWithin each cross, the offspring are half female and half male. Therefore, the total $F_1$ population is composed of four equally-sized groups, each representing a proportion of $\\frac{1}{4}$ of the total:\n$1$. Females from Cross 1: proportion $\\frac{1}{2} \\times \\frac{1}{2} = \\frac{1}{4}$.\n$2$. Males from Cross 1: proportion $\\frac{1}{2} \\times \\frac{1}{2} = \\frac{1}{4}$.\n$3$. Females from Cross 2: proportion $\\frac{1}{2} \\times \\frac{1}{2} = \\frac{1}{4}$.\n$4$. Males from Cross 2: proportion $\\frac{1}{2} \\times \\frac{1}{2} = \\frac{1}{4}$.\n\nFrom the analysis in Task 2 for Model A:\n-   Group 1 (Females, Cross 1): All are unaffected. Contribution to affected proportion is $0$.\n-   Group 2 (Males, Cross 1): All are affected. Contribution to affected proportion is $\\frac{1}{4}$.\n-   Group 3 (Females, Cross 2): All are unaffected. Contribution to affected proportion is $0$.\n-   Group 4 (Males, Cross 2): All are unaffected. Contribution to affected proportion is $0$.\n\nThe total expected proportion of affected individuals is the sum of the proportions of affected individuals from each of the four groups:\n$$ \\text{Total Proportion Affected} = 0 + \\frac{1}{4} + 0 + 0 = \\frac{1}{4} $$\n\nTherefore, under Model A, exactly one quarter of the total $F_1$ offspring are expected to express the DMI phenotype.", "answer": "$$\\boxed{\\frac{1}{4}}$$", "id": "2820483"}, {"introduction": "The dominance theory for Haldane's rule predicts that recessive or partially recessive incompatibility alleles on the X chromosome will be readily exposed in hemizygous males, leading to a \"large-X effect\" in hybrid sterility and inviability. This practice [@problem_id:2720963] bridges the gap between the theoretical model of DMIs and the empirical data from genetic mapping studies. You will articulate the reasoning for this large-X effect and then derive a simple statistic to quantify the contribution of the X chromosome from hypothetical locus-count data, a common first step in analyzing the genetic basis of speciation.", "problem": "In the Drosophila simulans species complex, interspecific crosses between Drosophila simulans and its sister species frequently yield sterile $F_{1}$ hybrid males, consistent with Haldane's rule that the heterogametic sex suffers sterility or inviability more often. Consider a research program that uses introgression lines, quantitative trait locus (QTL) mapping, and deficiency mapping to localize hybrid male sterility loci. The study reports multiple hybrid male sterility loci on the X chromosome as well as on the autosomes. You are asked to reason from foundational principles in speciation genetics to justify why a disproportionate contribution of the X chromosome to hybrid male sterility (a large X-effect) is expected, and then to compute a summary statistic for the genomic distribution of mapped loci.\n\nUsing the following base principles and facts:\n- Haldane's rule: in hybrids, the heterogametic sex is more likely to be sterile or inviable.\n- Dobzhansky–Muller incompatibilities: hybrid dysfunction arises from negative epistatic interactions between divergent alleles that evolved in isolation.\n- Dominance theory for Haldane's rule: if many incompatibility alleles are partially recessive, then in the heterogametic sex, hemizygosity of the X chromosome exposes recessive X-linked incompatibilities, increasing the incidence and expressivity of X-linked sterility.\n- Evidence from the Drosophila simulans complex that hybrid male sterility maps to numerous intervals on the X chromosome, that hemizygous X segments are sufficient to cause male sterility in otherwise conspecific backgrounds, and that fewer or weaker-effect autosomal intervals are implicated when measured on a comparable genomic scale.\n\nFirst, in no more than a few sentences, articulate a mechanism-based justification for why X-linked hybrid male sterility is expected to be common in this system. Then, let $n_{X}$ be the count of mapped hybrid male sterility loci assigned to the X chromosome and $n_{A}$ be the count assigned to the autosomes. Define the total number of mapped loci as $N$ and the fraction of mapped sterility loci that are X-linked as $f_{X}$. Derive an expression for $f_{X}$ as a function of $n_{X}$ and $n_{A}$ and report this fraction in its simplest algebraic form. Your final answer must be a single closed-form expression in terms of $n_{X}$ and $n_{A}$. No numerical evaluation is required, and no units are involved.", "solution": "The problem is framed within speciation genetics and the causes of hybrid dysfunction, invoking Haldane's rule and the Dobzhansky–Muller model. We begin from accepted principles and observations and then compute the requested fraction.\n\nMechanistic justification for the large-X effect:\n- Under the Dobzhansky–Muller model, hybrid dysfunction results from negative epistasis between alleles that evolved in isolation in different lineages. If many such incompatibility alleles are partially recessive, then their effects are masked in heterozygotes but expressed when homozygous or hemizygous.\n- In Drosophila, males are the heterogametic sex ($XY$). X-linked alleles in males are hemizygous, so any partially recessive X-linked incompatibility is fully exposed in $F_{1}$ males, whereas autosomal incompatibilities remain masked unless in the appropriate homozygous state or specific epistatic combinations. This is the dominance theory explanation for Haldane's rule.\n- Empirically in the Drosophila simulans complex, introgression and deficiency mapping have repeatedly shown that substituting small X-linked segments from one species into the genetic background of another can be sufficient to cause male sterility, and that many distinct X-linked intervals contribute, whereas fewer or lower-effect autosomal intervals are detected when mapping resolution and genomic coverage are comparable. These observations reinforce the expectation that X-linked hybrid male sterility loci are numerous and of large effect.\n\nComputation of the fraction of X-linked loci:\n- Let $n_{X}$ denote the count of mapped hybrid male sterility loci assigned to the X chromosome, and let $n_{A}$ denote the count assigned to the autosomes. The total number of mapped loci is the sum\n$$\nN = n_{X} + n_{A}.\n$$\n- The fraction of mapped sterility loci that are X-linked, denoted $f_{X}$, is defined as the number of X-linked loci divided by the total number of mapped loci. Therefore,\n$$\nf_{X} = \\frac{n_{X}}{N} = \\frac{n_{X}}{n_{X} + n_{A}}.\n$$\nThis expression is already in simplest algebraic form and satisfies the requirement of being a single closed-form expression in terms of $n_{X}$ and $n_{A}$.", "answer": "$$\\boxed{\\frac{n_{X}}{n_{X}+n_{A}}}$$", "id": "2720963"}, {"introduction": "Modern speciation genomics allows for powerful, data-driven tests of evolutionary hypotheses directly from patterns of ancestry. This advanced practice [@problem_id:2720969] moves beyond simple Mendelian models to a population genetics framework, where you will use Maximum Likelihood Estimation (MLE) to infer the strength of selection against introgressed DNA. By fitting a selection model to simulated genomic data, you will estimate sex-specific selection coefficients ($s_f$ and $s_m$) and quantitatively test whether selection is stronger on X-linked loci in males, providing a rigorous and contemporary approach to validating Haldane's rule.", "problem": "You are given a simplified but principled model to infer sex-specific selection against introgressed ancestry on the X chromosome (denoted as X) consistent with Haldane's rule. The inference is based on genome-wide ancestry proportions, sex labels, and observed haploid ancestry states at an X-linked locus. The core principle you must use is standard deterministic viability selection on allele frequencies.\n\nFoundational base:\n- Let $p$ be the pre-selection probability that a randomly chosen haploid X-linked allele in an individual is derived from source population $\\mathsf{A}$. Under neutrality, $p$ equals the individual's genome-wide ancestry proportion $q$ from population $\\mathsf{A}$.\n- Under viability selection, the post-selection allele frequency $p^{\\prime}$ among surviving haploid alleles is given by $p^{\\prime} = \\dfrac{p \\, w_{\\mathsf{A}}}{p \\, w_{\\mathsf{A}} + (1 - p) \\, w_{\\mathsf{B}}}$, where $w_{\\mathsf{A}}$ and $w_{\\mathsf{B}}$ are the relative fitness values associated with alleles from populations $\\mathsf{A}$ and $\\mathsf{B}$, respectively. This is the canonical selection-weighted normalization from basic population genetics. Assume $w_{\\mathsf{B}} = 1$ and $w_{\\mathsf{A}} = 1 - s_{z}$, with $z \\in \\{0,1\\}$ encoding sex, $z = 0$ for females and $z = 1$ for males.\n- Therefore, the probability that a sampled haploid X-linked allele carried by an individual with genome-wide ancestry $q$ and sex $z$ is from population $\\mathsf{A}$ after selection is\n$$\n\\pi(q,z;s_f,s_m) \\equiv \\frac{q \\, (1 - s_z)}{q \\, (1 - s_z) + (1 - q)},\n$$\nwhere $s_0 = s_f$ and $s_1 = s_m$ are the unknown sex-specific selection coefficients against the introgressed X-linked ancestry from population $\\mathsf{A}$.\n\nStatistical model:\n- For each haploid X-linked observation $j$, you are given an individual's genome-wide ancestry proportion $q_j \\in [0,1]$, sex $z_j \\in \\{0,1\\}$, and a binary haploid ancestry indicator $y_j \\in \\{0,1\\}$ for an X-linked locus, where $y_j = 1$ denotes ancestry from population $\\mathsf{A}$ and $y_j = 0$ denotes ancestry from population $\\mathsf{B}$.\n- Assume independent Bernoulli sampling with success probability $\\pi(q_j,z_j;s_f,s_m)$. The log-likelihood to be maximized is\n$$\n\\ell(s_f,s_m) = \\sum_{j=1}^{n} \\left[ y_j \\, \\log \\pi(q_j,z_j;s_f,s_m) + (1 - y_j) \\, \\log \\left(1 - \\pi(q_j,z_j;s_f,s_m)\\right) \\right].\n$$\n- The parameters must satisfy $0 \\le s_f < 1$ and $0 \\le s_m < 1$.\n\nTask:\n- Implement Maximum Likelihood Estimation (MLE) to obtain the estimates $\\hat{s}_f$ and $\\hat{s}_m$ by maximizing $\\ell(s_f,s_m)$ subject to the bounds above. Use a numerical optimizer with bound constraints.\n- Decide whether the estimates are consistent with Haldane's rule for male heterogamety (males are the heterogametic sex), which predicts stronger selection against introgressed X ancestry in males than in females. Define a decision threshold $\\tau = 0.05$ and declare the data as consistent with Haldane's rule if and only if $\\hat{s}_m - \\hat{s}_f > \\tau$.\n\nNumerical and output requirements:\n- Report $\\hat{s}_m$ and $\\hat{s}_f$ rounded to three decimal places. No physical units are involved.\n- For each test case, return a list with three elements: the rounded $\\hat{s}_m$ (float), the rounded $\\hat{s}_f$ (float), and a boolean for the Haldane decision as specified above.\n- Your program should produce a single line of output containing the results as a comma-separated list of the three per-case lists, enclosed in square brackets (for example, \"[[sm1,sf1,flag1],[sm2,sf2,flag2],[sm3,sf3,flag3]]\"). No other text should be printed.\n- Your program must not read any input; it must use the embedded test suite below.\n\nTest suite:\n- In all cases, sex is encoded as $z = 0$ for females and $z = 1$ for males. The lists are aligned by index, so the $j$-th entries across the three lists correspond to the same observation.\n\nCase 1 (reduced X introgression in males; representative of Haldane's rule):\n- $q$ list: $[0.3,\\, 0.3,\\, 0.4,\\, 0.4,\\, 0.5,\\, 0.5,\\, 0.6,\\, 0.6,\\, 0.7,\\, 0.7,\\, 0.8,\\, 0.8,\\, 0.9,\\, 0.9]$\n- $z$ list: $[0,\\, 1,\\, 0,\\, 1,\\, 0,\\, 1,\\, 0,\\, 1,\\, 0,\\, 1,\\, 0,\\, 1,\\, 0,\\, 1]$\n- $y$ list: $[0,\\, 0,\\, 0,\\, 0,\\, 0,\\, 0,\\, 1,\\, 0,\\, 1,\\, 0,\\, 1,\\, 1,\\, 1,\\, 1]$\n\nCase 2 (no sex difference; near-neutral behavior):\n- $q$ list: $[0.2,\\, 0.2,\\, 0.4,\\, 0.4,\\, 0.5,\\, 0.5,\\, 0.6,\\, 0.6,\\, 0.8,\\, 0.8]$\n- $z$ list: $[0,\\, 1,\\, 0,\\, 1,\\, 0,\\, 1,\\, 0,\\, 1,\\, 0,\\, 1]$\n- $y$ list: $[0,\\, 0,\\, 0,\\, 0,\\, 0,\\, 0,\\, 1,\\, 1,\\, 1,\\, 1]$\n\nCase 3 (boundary-like behavior; strong male-specific selection):\n- $q$ list: $[0.1,\\, 0.1,\\, 0.49,\\, 0.49,\\, 0.51,\\, 0.51,\\, 0.9,\\, 0.9,\\, 0.96,\\, 0.96,\\, 0.98,\\, 0.98]$\n- $z$ list: $[0,\\, 1,\\, 0,\\, 1,\\, 0,\\, 1,\\, 0,\\, 1,\\, 0,\\, 1,\\, 0,\\, 1]$\n- $y$ list: $[0,\\, 0,\\, 0,\\, 0,\\, 1,\\, 0,\\, 1,\\, 0,\\, 1,\\, 1,\\, 1,\\, 1]$\n\nDefinition and decision rule:\n- Let $\\widehat{s}_m$ and $\\widehat{s}_f$ denote the MLEs for males and females, respectively; define $\\tau = 0.05$. Declare \"consistent with Haldane's rule\" if $\\widehat{s}_m - \\widehat{s}_f > \\tau$; otherwise, declare \"not consistent.\"\n- Round $\\widehat{s}_m$ and $\\widehat{s}_f$ to three decimal places in the final output.\n\nYour program must implement the MLE, apply it to all three cases, and print a single line of the specified aggregated output format.", "solution": "The problem statement is subjected to validation.\n\n### Step 1: Extract Givens\n- **Model for post-selection probability ($\\pi$)**: The probability that a sampled haploid X-linked allele from an individual with genome-wide ancestry $q$ and sex $z$ is from population $\\mathsf{A}$ is given by:\n$$\n\\pi(q,z;s_f,s_m) = \\frac{q \\, (1 - s_z)}{q \\, (1 - s_z) + (1 - q)}\n$$\n- **Sex-specific selection coefficients ($s_z$)**: $s_z$ is the selection coefficient against introgressed ancestry from population $\\mathsf{A}$. It depends on sex $z$, where $z=0$ for females and $z=1$ for males. Thus, $s_0 = s_f$ and $s_1 = s_m$.\n- **Parameter constraints**: $0 \\le s_f < 1$ and $0 \\le s_m < 1$.\n- **Data**: For each observation $j=1, \\dots, n$, the data consists of a triplet $(q_j, z_j, y_j)$, where $q_j \\in [0,1]$ is the genome-wide ancestry proportion, $z_j \\in \\{0,1\\}$ is the sex, and $y_j \\in \\{0,1\\}$ is the observed haploid ancestry indicator for an X-linked locus ($y_j=1$ for ancestry $\\mathsf{A}$, $y_j=0$ for ancestry $\\mathsf{B}$).\n- **Statistical Model**: The observations $y_j$ are assumed to be independent Bernoulli trials with success probability $\\pi_j = \\pi(q_j,z_j;s_f,s_m)$.\n- **Objective function**: The log-likelihood to be maximized is:\n$$\n\\ell(s_f,s_m) = \\sum_{j=1}^{n} \\left[ y_j \\, \\log \\pi(q_j,z_j;s_f,s_m) + (1 - y_j) \\, \\log \\left(1 - \\pi(q_j,z_j;s_f,s_m)\\right) \\right]\n$$\n- **Task**: Perform Maximum Likelihood Estimation (MLE) to find $\\hat{s}_f$ and $\\hat{s}_m$.\n- **Haldane's Rule Decision**: A threshold $\\tau = 0.05$ is given. The data are declared consistent with Haldane's rule if and only if $\\hat{s}_m - \\hat{s}_f > \\tau$.\n- **Test Suite**: Three specific datasets (Case 1, Case 2, Case 3) are provided.\n- **Output Format**: For each case, produce a list `[rounded_sm, rounded_sf, boolean_decision]`. The final output is a single line containing a list of these lists.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is evaluated against the validation criteria.\n\n- **Scientifically Grounded**: The problem is based on the standard deterministic model of viability selection from population genetics. The statistical framework, using a Bernoulli likelihood for binary traits, is a cornerstone of statistical inference. Haldane's rule is a well-established empirical pattern in evolutionary biology. The model provides a simplified but principled way to test a hypothesis related to this rule. The problem is scientifically sound.\n- **Well-Posed**: The task is to find the maximum of a log-likelihood function subject to bound constraints. This is a standard and well-defined numerical optimization problem. The log-likelihood function for the Bernoulli distribution is concave in the logit of the probability, ensuring that a unique maximum for the parameters typically exists. The problem is well-posed.\n- **Objective**: All terms are defined with mathematical precision. The data are quantitative, and the decision rule is based on a clear, objective numerical threshold. The problem is free of subjective or ambiguous language.\n\nThe problem statement does not exhibit any of the defined flaws (e.g., scientific unsoundness, incompleteness, contradiction, or ambiguity). It is a formal, self-contained, and solvable problem in computational statistics and biology.\n\n### Step 3: Verdict and Action\nThe problem is valid. A complete solution will be provided.\n\n### Solution Derivation\nThe objective is to find the Maximum Likelihood Estimates (MLEs) of $s_f$ and $s_m$ by maximizing the log-likelihood function $\\ell(s_f, s_m)$. Standard numerical optimizers are designed to minimize a function, so we will equivalently minimize the negative log-likelihood, $L(s_f, s_m) = -\\ell(s_f, s_m)$.\n\nA critical observation is that the log-likelihood function is separable with respect to the parameters $s_f$ and $s_m$. The probability $\\pi(q, z; s_f, s_m)$ depends only on $s_f$ if $z=0$ (female) and only on $s_m$ if $z=1$ (male).\nLet $J_f = \\{j \\mid z_j = 0\\}$ be the set of indices for female observations and $J_m = \\{j \\mid z_j = 1\\}$ for male observations. The log-likelihood can be written as a sum of two independent components:\n$$\n\\ell(s_f, s_m) = \\ell_f(s_f) + \\ell_m(s_m)\n$$\nwhere\n$$\n\\ell_f(s_f) = \\sum_{j \\in J_f} \\left[ y_j \\, \\log \\pi(q_j,0;s_f,s_m) + (1-y_j) \\log(1 - \\pi(q_j,0;s_f,s_m)) \\right]\n$$\n$$\n\\ell_m(s_m) = \\sum_{j \\in J_m} \\left[ y_j \\, \\log \\pi(q_j,1;s_f,s_m) + (1-y_j) \\log(1 - \\pi(q_j,1;s_f,s_m)) \\right]\n$$\nThis separability allows us to optimize for $s_f$ and $s_m$ independently by solving two one-dimensional optimization problems.\n\nLet's simplify the objective function for a generic selection coefficient $s$ and its corresponding data subset $(q_k, y_k)$. The probability is $\\pi_k = \\frac{q_k (1 - s)}{q_k (1 - s) + (1 - q_k)} = \\frac{q_k(1-s)}{1-q_k s}$. Consequently, $1-\\pi_k = \\frac{1-q_k}{1-q_k s}$.\nThe log-likelihood contribution from observation $k$ is:\n$$\ny_k \\log(\\pi_k) + (1-y_k) \\log(1-\\pi_k) = y_k \\log\\left(\\frac{q_k(1-s)}{1-q_k s}\\right) + (1-y_k) \\log\\left(\\frac{1-q_k}{1-q_k s}\\right)\n$$\n$$\n= y_k (\\log q_k + \\log(1-s) - \\log(1-q_k s)) + (1-y_k)(\\log(1-q_k) - \\log(1-q_k s))\n$$\n$$\n= (y_k \\log q_k + (1-y_k)\\log(1-q_k)) + y_k \\log(1-s) - \\log(1-q_k s)\n$$\nFor maximization with respect to $s$, the term $(y_k \\log q_k + (1-y_k)\\log(1-q_k))$ is a constant and can be ignored. Summing over all relevant observations, the task is to maximize $\\sum_k \\left[ y_k \\log(1-s) - \\log(1-q_k s) \\right]$.\nThis is equivalent to minimizing the negative of this expression:\n$$\nL(s) = \\sum_k \\left[ \\log(1-q_k s) - y_k \\log(1-s) \\right]\n$$\nThis simplified negative log-likelihood function is numerically stable and efficient to compute. We will minimize this function for $s_f$ using the female data and for $s_m$ using the male data. The optimization will be performed using a numerical scalar optimizer with bounds $(0, 1)$, as the constraints are $0 \\le s < 1$. The boundary case $s=0$ corresponds to neutrality. A value of $s \\ge 1$ is biologically nonsensical as it implies zero or negative fitness, and a value of $s<0$ implies positive selection for the introgressed allele. The provided bounds are appropriate.\n\nThe algorithm is as follows for each test case:\n1.  Partition the data $(q, z, y)$ into a female subset $(q_f, y_f)$ and a male subset $(q_m, y_m)$.\n2.  Define the objective function $L(s; q_{\\text{data}}, y_{\\text{data}}) = \\sum_k [\\log(1-q_k s) - y_k \\log(1-s)]$.\n3.  Numerically minimize $L(s_f; q_f, y_f)$ with respect to $s_f$ over the interval $[0, 1)$ to find the MLE $\\hat{s}_f$.\n4.  Numerically minimize $L(s_m; q_m, y_m)$ with respect to $s_m$ over the interval $[0, 1)$ to find the MLE $\\hat{s}_m$.\n5.  Use the unrounded estimates to evaluate the Haldane's rule condition: $\\hat{s}_m - \\hat{s}_f > \\tau = 0.05$.\n6.  Round $\\hat{s}_m$ and $\\hat{s}_f$ to three decimal places.\n7.  Compile the results into the specified list format `[rounded_sm, rounded_sf, boolean_decision]`.\nThis procedure is repeated for all test cases, and the final results are aggregated into a single list.", "answer": "```python\nimport numpy as np\nfrom scipy.optimize import minimize_scalar\n\ndef solve():\n    \"\"\"\n    Solves the Haldane's rule inference problem for the given test cases.\n    \"\"\"\n    # Test cases as provided in the problem statement.\n    test_cases = [\n        # Case 1: reduced X introgression in males; representative of Haldane's rule\n        {\n            \"q\": [0.3, 0.3, 0.4, 0.4, 0.5, 0.5, 0.6, 0.6, 0.7, 0.7, 0.8, 0.8, 0.9, 0.9],\n            \"z\": [0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1],\n            \"y\": [0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 1, 1, 1, 1]\n        },\n        # Case 2: no sex difference; near-neutral behavior\n        {\n            \"q\": [0.2, 0.2, 0.4, 0.4, 0.5, 0.5, 0.6, 0.6, 0.8, 0.8],\n            \"z\": [0, 1, 0, 1, 0, 1, 0, 1, 0, 1],\n            \"y\": [0, 0, 0, 0, 0, 0, 1, 1, 1, 1]\n        },\n        # Case 3: boundary-like behavior; strong male-specific selection\n        {\n            \"q\": [0.1, 0.1, 0.49, 0.49, 0.51, 0.51, 0.9, 0.9, 0.96, 0.96, 0.98, 0.98],\n            \"z\": [0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1],\n            \"y\": [0, 0, 0, 0, 1, 0, 1, 0, 1, 1, 1, 1]\n        }\n    ]\n\n    tau = 0.05\n    results = []\n\n    for case_data in test_cases:\n        q = np.array(case_data[\"q\"])\n        z = np.array(case_data[\"z\"])\n        y = np.array(case_data[\"y\"])\n\n        # Partition data into female (z=0) and male (z=1) subsets\n        female_mask = (z == 0)\n        male_mask = (z == 1)\n\n        q_f, y_f = q[female_mask], y[female_mask]\n        q_m, y_m = q[male_mask], y[male_mask]\n\n        def neg_log_lik(s, q_arr, y_arr):\n            \"\"\"\n            Calculates the simplified negative log-likelihood to be minimized.\n            L(s) = sum(log(1 - q_k*s) - y_k*log(1 - s))\n            \"\"\"\n            # If no data for a sex, likelihood is flat, s=0 is the neutral default.\n            if len(q_arr) == 0:\n                return 0.0\n            \n            # log(1-s) -> -inf as s->1. If any y_k=1, -y_k*log(1-s) -> +inf,\n            # which correctly penalizes s=1.\n            # np.log handles the vectorization automatically.\n            term1 = np.sum(np.log(1 - q_arr * s))\n            term2 = np.sum(y_arr * np.log(1 - s))\n            return term1 - term2\n\n        # --- Estimate s_f for females ---\n        # If no female data, MLE for s_f is taken as 0 (neutrality).\n        if len(q_f) > 0:\n            res_f = minimize_scalar(\n                lambda s: neg_log_lik(s, q_f, y_f),\n                bounds=(0, 1),\n                method='bounded'\n            )\n            s_f_hat = res_f.x\n        else:\n            s_f_hat = 0.0\n\n        # --- Estimate s_m for males ---\n        # If no male data, MLE for s_m is taken as 0.\n        if len(q_m) > 0:\n            res_m = minimize_scalar(\n                lambda s: neg_log_lik(s, q_m, y_m),\n                bounds=(0, 1),\n                method='bounded'\n            )\n            s_m_hat = res_m.x\n        else:\n            s_m_hat = 0.0\n            \n        # Decision for Haldane's rule using unrounded estimates\n        is_haldane = (s_m_hat - s_f_hat) > tau\n\n        # Round estimates for reporting\n        s_m_rounded = round(s_m_hat, 3)\n        s_f_rounded = round(s_f_hat, 3)\n\n        results.append([s_m_rounded, s_f_rounded, is_haldane])\n\n    # Format the final output string exactly as specified.\n    # The default str() representation of a list of lists matches the required format.\n    # e.g., [[0.1, 0.2, True], [0.3, 0.4, False]]\n    # However, to be certain about no extra spaces, we build it manually.\n    sub_lists_str = [f\"[{r[0]},{r[1]},{str(r[2]).lower()}]\" for r in results]\n    final_output_str = f\"[{','.join(sub_lists_str)}]\"\n    # Correcting the above to match the example format more closely: True/False\n    sub_lists_str = [f\"[{r[0]},{r[1]},{str(r[2])}]\" for r in results]\n    final_output_str = f\"[{','.join(sub_lists_str)}]\"\n\n    print(final_output_str)\n\nsolve()\n```", "id": "2720969"}]}