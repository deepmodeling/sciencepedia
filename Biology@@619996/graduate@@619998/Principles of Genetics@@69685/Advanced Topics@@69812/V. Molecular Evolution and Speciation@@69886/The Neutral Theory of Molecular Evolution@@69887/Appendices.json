{"hands_on_practices": [{"introduction": "One of the most powerful applications of the neutral theory is its role as a null model for detecting natural selection. This exercise provides a hands-on opportunity to quantify the deviation of observed genetic diversity from the level expected under a simple mutation-drift equilibrium [@problem_id:1527809]. By calculating the expected heterozygosity ($H_{neu}$) using the population parameter $\\theta = 4N_e \\mu_0$ and comparing it to the high diversity observed in a hypothetical immune gene, you will learn how to build a quantitative argument for the presence of non-neutral evolutionary forces like balancing selection.", "problem": "In population genetics, the neutral theory of molecular evolution provides a baseline for the amount of genetic variation expected in a population at equilibrium between mutation and genetic drift. Consider a hypothetical, isolated population of an endangered bird, the Crimson-crested Firehawk, which has an effective population size of $N_e = 10,000$ individuals. The average mutation rate to a new neutral allele for a typical gene in this species is estimated to be $\\mu_0 = 2.0 \\times 10^{-5}$ per gene per generation.\n\nA detailed genetic survey of this population focuses on a specific immune system gene, the *Fh-B* locus, which is part of the bird's Major Histocompatibility Complex (MHC). This locus is found to be extraordinarily polymorphic, with researchers identifying $k = 80$ distinct alleles. A key feature of this polymorphism is that all 80 alleles are maintained at approximately equal frequencies in the population, a hallmark of long-term balancing selection.\n\nTo quantify the discrepancy between the observed diversity at the *Fh-B* locus and the predictions of the neutral theory, calculate the ratio of the observed heterozygosity at the *Fh-B* locus to the expected heterozygosity for a gene evolving strictly under neutrality with the given population parameters. Round your final answer to three significant figures.", "solution": "Under balancing selection with $k$ alleles at equal frequency $p_{i} = \\frac{1}{k}$, the observed heterozygosity is\n$$\nH_{\\text{obs}} = 1 - \\sum_{i=1}^{k} p_{i}^{2} = 1 - k \\left(\\frac{1}{k}\\right)^{2} = 1 - \\frac{1}{k}.\n$$\nWith $k = 80$,\n$$\nH_{\\text{obs}} = 1 - \\frac{1}{80} = \\frac{79}{80}.\n$$\n\nUnder the neutral infinite-alleles model at mutation-drift equilibrium, the expected heterozygosity is\n$$\nH_{\\text{neu}} = \\frac{\\theta}{1 + \\theta}, \\quad \\text{where} \\quad \\theta = 4 N_{e} \\mu_0.\n$$\nWith $N_{e} = 10{,}000$ and $\\mu_0 = 2.0 \\times 10^{-5}$,\n$$\n\\theta = 4 \\times 10{,}000 \\times \\left(2.0 \\times 10^{-5}\\right) = 0.8,\n$$\nso\n$$\nH_{\\text{neu}} = \\frac{0.8}{1 + 0.8} = \\frac{0.8}{1.8} = \\frac{4}{9}.\n$$\n\nThe ratio of observed to neutral heterozygosity is\n$$\nR = \\frac{H_{\\text{obs}}}{H_{\\text{neu}}} = \\frac{\\frac{79}{80}}{\\frac{4}{9}} = \\frac{79}{80} \\cdot \\frac{9}{4} = \\frac{711}{320} \\approx 2.221875.\n$$\nRounding to three significant figures gives $2.22$.", "answer": "$$\\boxed{2.22}$$", "id": "1527809"}, {"introduction": "Real-world population genetic data often presents complex patterns that can be challenging to interpret. This problem challenges you to synthesize information from two different widely used neutrality tests: the McDonald-Kreitman test and Tajima's $D$ statistic [@problem_id:1527876]. By untangling seemingly contradictory signals—evidence for adaptive evolution between species alongside an unusual frequency spectrum within a species—you will develop critical thinking skills necessary to discern the intertwined effects of natural selection and demographic history.", "problem": "A team of evolutionary biologists is studying a gene, which they have named *Adapt-1*, in a species of fruit fly, *Drosophila persimilis*. To understand the evolutionary forces acting on this gene, they sequence the *Adapt-1* coding region from a sample of individuals from a specific geographic population. They also compare the *D. persimilis* sequence to that of its closely related sister species, *Drosophila pseudoobscura*.\n\nTheir analysis, using the McDonald-Kreitman (MK) test framework, yields the following data:\n-   The number of non-synonymous substitutions between the species ($D_n$) is 40.\n-   The number of synonymous substitutions between the species ($D_s$) is 20.\n-   The number of non-synonymous polymorphisms within *D. persimilis* ($P_n$) is 10.\n-   The number of synonymous polymorphisms within *D. persimilis* ($P_s$) is 25.\n\nFurther analysis of the polymorphism data from the *D. persimilis* population for the *Adapt-1* locus reveals a Tajima's D statistic that is significantly positive ($D = +2.5$).\n\nThe researchers are puzzled by this combination of results. Based on these observations, which of the following scenarios provides the most plausible explanation for the evolutionary history of the *Adapt-1* gene in this *D. persimilis* population?\n\nA. A recent and strong selective sweep has occurred at the *Adapt-1* locus, driving a beneficial allele to fixation.\n\nB. The *Adapt-1* locus has been under long-term balancing selection, maintaining multiple functional alleles in the population.\n\nC. The population of *D. persimilis* has been experiencing long-term, steady exponential growth.\n\nD. The population of *D. persimilis* experienced a severe bottleneck in the recent past, followed by a period of population subdivision into small, isolated demes.\n\nE. The *Adapt-1* gene is functionally critical and has been evolving under strong purifying selection, and the population has recently expanded from a small founding group.", "solution": "We are given McDonald-Kreitman counts for the Adapt-1 coding region: the numbers of fixed differences between species at nonsynonymous and synonymous sites, denoted by $D_{n}$ and $D_{s}$, and the numbers of within-species polymorphisms at nonsynonymous and synonymous sites, denoted by $P_{n}$ and $P_{s}$. The MK test compares the ratio of divergence at nonsynonymous to synonymous sites to the ratio of polymorphism at nonsynonymous to synonymous sites. Under neutrality, the expectation is\n$$\n\\frac{D_{n}}{D_{s}} \\approx \\frac{P_{n}}{P_{s}}.\n$$\nDeviations are interpreted as follows: if $\\frac{D_{n}}{D_{s}}>\\frac{P_{n}}{P_{s}}$, there is an excess of fixed nonsynonymous differences relative to neutral expectation, consistent with recurrent positive selection (adaptive substitutions). Conversely, if $\\frac{D_{n}}{D_{s}}<\\frac{P_{n}}{P_{s}}$, that pattern is consistent with balancing selection or an excess of slightly deleterious nonsynonymous polymorphisms.\n\nUsing the provided counts,\n$$\n\\frac{D_{n}}{D_{s}}=\\frac{40}{20}=2, \\quad \\frac{P_{n}}{P_{s}}=\\frac{10}{25}=0.4.\n$$\nThus,\n$$\n\\frac{D_{n}}{D_{s}}>\\frac{P_{n}}{P_{s}}.\n$$\nA standard summary is the neutrality index,\n$$\n\\mathrm{NI}=\\frac{P_{n}/P_{s}}{D_{n}/D_{s}}=\\frac{0.4}{2}=0.2<1,\n$$\nand the estimated fraction of nonsynonymous substitutions fixed by positive selection,\n$$\n\\alpha=1-\\mathrm{NI}=1-0.2=0.8,\n$$\nboth indicating a strong excess of adaptive nonsynonymous divergence. Therefore, the MK test supports recurrent positive selection on Adapt-1 along the lineage(s) separating the species.\n\nNext, consider the site-frequency spectrum within D. persimilis at Adapt-1, summarized by Tajima’s $D$. Tajima’s $D$ compares two estimators of the scaled mutation rate: $\\theta_{\\pi}$ (based on average pairwise differences) and $\\theta_{W}$ (based on the number of segregating sites). A significantly positive value, $D>0$, indicates an excess of intermediate-frequency variants relative to the standard neutral equilibrium model with constant size and panmixia. Well-known interpretations are:\n- Positive $D$ is consistent with balancing selection at or near the locus, or with demographic processes such as population structure (subdivision) or recent contraction/bottleneck that elevate intermediate-frequency alleles when samples are pooled.\n- Negative $D$ is expected after a recent selective sweep at the locus or after recent population expansion, due to an excess of rare variants.\n\nHere $D=+2.5$ is significantly positive. We now assess each scenario:\n\nA. A recent, strong selective sweep at Adapt-1 would be expected to reduce diversity and yield a negative Tajima’s $D$ locally (excess of rare variants following the sweep). This contradicts the observed $D=+2.5$, so A is inconsistent.\n\nB. Long-term balancing selection can produce $D>0$ at the locus. However, balancing selection typically elevates within-species nonsynonymous polymorphism relative to neutral expectations, leading to $\\frac{P_{n}}{P_{s}}$ being large and often $\\frac{D_{n}}{D_{s}}<\\frac{P_{n}}{P_{s}}$ in an MK table. The data show the opposite pattern, $\\frac{D_{n}}{D_{s}}>\\frac{P_{n}}{P_{s}}$, indicating adaptive divergence rather than balancing selection. Thus B does not match the MK result.\n\nC. Long-term steady exponential growth produces an excess of rare variants and therefore negative Tajima’s $D$, which conflicts with $D=+2.5$. So C is inconsistent.\n\nD. A severe bottleneck followed by subdivision into small, isolated demes can produce a positive Tajima’s $D$ at a locus when sampling across demes (population structure yields an excess of intermediate-frequency variants), and a bottleneck can also elevate intermediate-frequency classes. This demographic scenario reconciles the significantly positive Tajima’s $D$ without requiring balancing selection at the locus. Meanwhile, the MK signal of $\\frac{D_{n}}{D_{s}}>\\frac{P_{n}}{P_{s}}$ reflects adaptive nonsynonymous divergence between species; demographic changes generally affect both synonymous and nonsynonymous polymorphisms similarly and do not create an excess of fixed nonsynonymous substitutions. Therefore, demography explains the positive Tajima’s $D$, and positive selection explains the MK test outcome. D is consistent with both results.\n\nE. Strong purifying selection on a functionally critical gene, coupled with recent expansion, predicts low $\\frac{D_{n}}{D_{s}}$ (few fixed nonsynonymous changes) and negative Tajima’s $D$ (expansion), both contrary to the observed $\\frac{D_{n}}{D_{s}}=2$ and $D=+2.5$. Thus E is inconsistent.\n\nThe only scenario that accommodates both the MK evidence for adaptive divergence and the significantly positive Tajima’s $D$ at the locus via demography is D.", "answer": "$$\\boxed{D}$$", "id": "1527876"}, {"introduction": "The statistical models used in molecular evolution are built on simplifying assumptions about the mutation process. This advanced practice takes you \"under the hood\" to explore the consequences of these assumptions through a computational sensitivity analysis [@problem_id:2859543]. You will implement the foundational Jukes-Cantor (JC69) and Kimura two-parameter (K80) models from first principles to quantitatively assess how misspecifying the substitution model can systematically bias estimates of evolutionary distance and potentially lead to incorrect conclusions about the molecular clock. This exercise is invaluable for building an intuition for the robustness and limitations of phylogenetic methods.", "problem": "You are tasked with constructing a fully specified sensitivity analysis to quantify how misspecifying the nucleotide mutation model biases neutral evolutionary distance estimates and alters molecular clock test outcomes. Work in the framework of the neutral theory of molecular evolution, where neutral substitutions accumulate according to a continuous-time Markov chain on nucleotides with independent and identically distributed sites. Assume equal stationary base frequencies and time reversibility. Use two specific models: the Jukes–Cantor model (JC69) and the Kimura two-parameter model (K80). Your program must implement the following steps from first principles.\n\n1. Model foundations for expected site-pattern probabilities:\n   - Under the Kimura two-parameter model (K80), there are two rate parameters: the transition rate per site per unit time $\\alpha$ and the transversion rate per site per unit time $\\beta$, with an equal stationary distribution. Normalize the rate matrix so that the expected number of substitutions per site per unit time is one; that is, enforce $2\\beta + \\alpha = 1$. Define the transition-to-transversion rate ratio $\\kappa = \\alpha / \\beta$, which implies $\\alpha = \\kappa/(2+\\kappa)$ and $\\beta = 1/(2+\\kappa)$.\n   - For any pair of sequences separated by a total evolutionary path length $t$ (measured in expected substitutions per site), model the probability that a site is a transition difference as $P(t,\\kappa)$ and a transversion difference as $Q(t,\\kappa)$. Base these on the continuous-time Markov chain with the K80 rate matrix normalized as above.\n   - Under the Jukes–Cantor model (JC69), all $3$ possible changes out of a nucleotide occur at equal rate. Use the same normalization convention: one expected substitution per site per unit time. For a pair separated by path length $t$, the overall difference probability is $p(t)$, and transition-versus-transversion probabilities follow from symmetry.\n\n2. Distance estimation rules to implement:\n   - JC69-corrected distance estimator: from an observed overall difference proportion $p$ at $L$ sites, return an estimated evolutionary distance $\\widehat{d}_{\\mathrm{JC}}(p)$.\n   - K80-corrected distance estimator: from observed transition and transversion proportions $(P,Q)$ at $L$ sites, return an estimated evolutionary distance $\\widehat{d}_{\\mathrm{K80}}(P,Q)$.\n   - When the true model is JC69, construct $(P,Q)$ for the K80 estimator by symmetry from $p$. When the true model is K80, construct $p$ for the JC69 estimator as $p = P+Q$.\n\n3. Sampling variance by the delta method:\n   - Assume independent and identically distributed sites.\n   - For JC69, treat the observation at each site as a Bernoulli variable indicating “different” or “same,” with success probability $p$, to obtain $\\mathrm{Var}(\\widehat{p})$ and thus $\\mathrm{Var}(\\widehat{d}_{\\mathrm{JC}})$ by the delta method using the derivative of the estimator with respect to $p$.\n   - For K80, treat site outcomes as a multinomial with categories “transition difference,” “transversion difference,” and “no difference,” with probabilities $(P,Q,1-P-Q)$. Use the $2\\times 2$ covariance matrix for $(\\widehat{P},\\widehat{Q})$ and the gradient of the K80 distance estimator with respect to $(P,Q)$ to compute $\\mathrm{Var}(\\widehat{d}_{\\mathrm{K80}})$ by the delta method.\n\n4. Molecular clock test specification:\n   - Consider three taxa: two ingroup taxa $1$ and $2$ and an outgroup $O$. Let the branch lengths from the most recent common ancestor of the ingroup to $1$ and $2$ be $t_1$ and $t_2$, respectively, and let the branch from the root to $O$ be $t_0$. The molecular clock prediction for the tip-to-outgroup distances is $d_{1O} = t_1 + t_0$ and $d_{2O} = t_2 + t_0$. To assess sensitivity to misspecification, perform a two-sample $z$-test of the null hypothesis $H_0: d_{1O} = d_{2O}$ by comparing the estimated distances $\\widehat{d}_{1O}$ and $\\widehat{d}_{2O}$ under each estimator separately (JC69 and K80). Assume independence by estimating $\\widehat{d}_{1O}$ from a locus of length $L_1$ and $\\widehat{d}_{2O}$ from a distinct locus of length $L_2$. Under the null, use the test statistic\n     $$\n     Z \\;=\\; \\frac{\\widehat{d}_{1O} - \\widehat{d}_{2O}}{\\sqrt{\\mathrm{Var}(\\widehat{d}_{1O}) + \\mathrm{Var}(\\widehat{d}_{2O})}},\n     $$\n     and reject $H_0$ at two-sided level $\\alpha$ if $\\lvert Z \\rvert > z_{1-\\alpha/2}$. Use $\\alpha = 0.05$ and the standard normal quantile $z_{0.975}$.\n\n5. Bias quantification for pairwise distances:\n   - For a single pair of sequences separated by a known total path length $t_{\\mathrm{pair}}$, compute the biases $b_{\\mathrm{JC}} = \\widehat{d}_{\\mathrm{JC}} - t_{\\mathrm{pair}}$ and $b_{\\mathrm{K80}} = \\widehat{d}_{\\mathrm{K80}} - t_{\\mathrm{pair}}$ when the observation is generated under the specified true model and parameter set. Use expected frequencies (that is, plug in the model’s expected $(P,Q)$ or $p$ instead of random counts) to isolate model misspecification bias from sampling error.\n\n6. Implementation notes:\n   - All computations must be expressed in unitless proportions or evolutionary distances measured in “expected substitutions per site.” No physical units are involved.\n   - Your program must compute expectations deterministically from the specified parameters; do not simulate per-site outcomes. Use the analytic probabilities from the continuous-time Markov models.\n\nTest Suite:\nImplement the above for the following three cases. In each case, compute and aggregate:\n- the pairwise biases $b_{\\mathrm{JC}}$ and $b_{\\mathrm{K80}}$ for the single-pair analysis, and\n- two booleans indicating whether the molecular clock $H_0$ is rejected under JC69 and under K80, respectively, using the two-sample $z$-test with $\\alpha = 0.05$.\n\nProvide the final output as a single line containing a comma-separated list of the three case-results, where each case-result is a list of the form [$b_{\\mathrm{JC}}$, $b_{\\mathrm{K80}}$, `reject_clock_JC`, `reject_clock_K80`].\n\n- Case A (happy path; moderate divergence under K80):\n  - True model: K80\n  - $\\kappa = 4$\n  - Pairwise analysis: $t_{\\mathrm{pair}} = 0.5$, $L = 1000000$\n  - Molecular clock test: $t_1 = 0.25$, $t_2 = 0.35$, $t_0 = 0.7$, $L_1 = 3000$, $L_2 = 3000$\n\n- Case B (edge near saturation; strong transition bias under K80):\n  - True model: K80\n  - $\\kappa = 10$\n  - Pairwise analysis: $t_{\\mathrm{pair}} = 1.2$, $L = 1000000$\n  - Molecular clock test: $t_1 = 0.2$, $t_2 = 0.4$, $t_0 = 1.0$, $L_1 = 2200$, $L_2 = 2200$\n\n- Case C (model symmetry; JC69 is the true model):\n  - True model: JC69\n  - $\\kappa = 1$\n  - Pairwise analysis: $t_{\\mathrm{pair}} = 0.5$, $L = 1000000$\n  - Molecular clock test: $t_1 = 0.3$, $t_2 = 0.5$, $t_0 = 0.6$, $L_1 = 5000$, $L_2 = 5000$\n\nFinal Output Format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element is itself a list formatted as `[[b_JC, b_K80, reject_clock_JC, reject_clock_K80], [...]]`. For example: `[[0.0, 0.0, False, True], [...], [...]]`. All real numbers must be printed in decimal form with Python’s default string formatting. No units are required and no percentage signs are permitted anywhere in the output.", "solution": "The problem requires a sensitivity analysis of evolutionary distance estimation and molecular clock tests to model misspecification. The analysis is performed within the framework of the neutral theory of molecular evolution, using the Jukes-Cantor (JC69) and Kimura two-parameter (K80) models. The solution will be derived from first principles.\n\n### 1. Model Foundations: Substitution Probabilities\n\nWe model nucleotide substitutions as a continuous-time Markov process. The evolutionary distance $t$ is defined as the expected number of substitutions per site. This requires normalizing the instantaneous rate matrix $\\mathbf{Q}$ such that the average rate of substitution, $\\lambda = -\\sum_{i} \\pi_i Q_{ii}$, is equal to $1$. With equal stationary base frequencies $\\pi_i = 1/4$, this simplifies to $\\lambda = -(1/4)\\sum_i Q_{ii} = 1$.\n\n#### Kimura Two-Parameter (K80) Model\nThe K80 model distinguishes between transitions (substitutions within purines $\\{A,G\\}$ or pyrimidines $\\{C,T\\}$) and transversions (substitutions between purines and pyrimidines). Let $\\alpha$ be the rate of transitions and $\\beta$ be the rate of transversions. The rate matrix is:\n$$\n\\mathbf{Q}_{\\text{K80}} = \\begin{pmatrix}\n-(\\alpha+2\\beta) & \\beta & \\alpha & \\beta \\\\\n\\beta & -(\\alpha+2\\beta) & \\beta & \\alpha \\\\\n\\alpha & \\beta & -(\\alpha+2\\beta) & \\beta \\\\\n\\beta & \\alpha & \\beta & -(\\alpha+2\\beta)\n\\end{pmatrix}\n$$\nThe normalization condition is $\\alpha + 2\\beta = 1$. The transition-to-transversion rate ratio is $\\kappa = \\alpha/\\beta$. Substituting into the normalization condition gives $\\kappa\\beta + 2\\beta = 1$, which yields the rates as functions of $\\kappa$:\n$$\n\\alpha = \\frac{\\kappa}{2+\\kappa}, \\quad \\beta = \\frac{1}{2+\\kappa}\n$$\nThe probability matrix for a finite time interval $t$ is $\\mathbf{P}(t) = e^{\\mathbf{Q}t}$. The elements $P_{ij}(t)$ give the probability of observing nucleotide $j$ at a site after time $t$, given it was nucleotide $i$ at time $0$. For the K80 model, these probabilities are:\n- $P_{ii}(t) = \\frac{1}{4} + \\frac{1}{4}e^{-4\\beta t} + \\frac{1}{2}e^{-2(\\alpha+\\beta)t}$ (same nucleotide)\n- $P_{ij}(t) = \\frac{1}{4} + \\frac{1}{4}e^{-4\\beta t} - \\frac{1}{2}e^{-2(\\alpha+\\beta)t}$ (transitional change)\n- $P_{ik}(t) = \\frac{1}{4} - \\frac{1}{4}e^{-4\\beta t}$ (transversional change)\n\nAssuming equal base frequencies, the expected proportion of sites showing a transition difference, $P(t,\\kappa)$, is the sum of probabilities of all possible transition pairs, e.g., $4 \\times \\pi_A P_{AG}(t) = P_{AG}(t)$. The expected proportion of sites showing a transversion difference, $Q(t,\\kappa)$, is the sum over all $8$ transversion pairs, i.e., $8 \\times \\pi_A P_{AC}(t) = 2 P_{AC}(t)$.\nThus, using the normalized rates:\n$$\nP(t,\\kappa) = \\frac{1}{4} + \\frac{1}{4}e^{-\\frac{4t}{2+\\kappa}} - \\frac{1}{2}e^{-\\frac{2(\\kappa+1)t}{2+\\kappa}}\n$$\n$$\nQ(t,\\kappa) = \\frac{1}{2} \\left(1 - e^{-\\frac{4t}{2+\\kappa}}\\right)\n$$\n\n#### Jukes-Cantor (JC69) Model\nThe JC69 model assumes all substitutions occur at the same rate $\\mu$. It is a special case of K80 with $\\alpha=\\beta$, which means $\\kappa=1$. The normalization $\\alpha+2\\beta=1$ becomes $3\\mu=1$, so $\\mu=1/3$. The probability of observing a difference at a site after time $t$ is given by:\n$$\np(t) = \\frac{3}{4}\\left(1 - e^{-4t/3}\\right)\n$$\nBy symmetry, a third of these differences are expected to be transitions and two-thirds are transversions.\n$P_{\\text{JC69}}(t) = p(t)/3 = \\frac{1}{4}\\left(1 - e^{-4t/3}\\right)$\n$Q_{\\text{JC69}}(t) = 2p(t)/3 = \\frac{1}{2}\\left(1 - e^{-4t/3}\\right)$\nThese match the K80 formulae for $P(t,\\kappa)$ and $Q(t,\\kappa)$ when $\\kappa=1$.\n\n### 2. Distance Estimation\nDistance estimators are derived by inverting the probability functions to solve for $t$.\n\n#### JC69 Distance Estimator\nFrom $p = \\frac{3}{4}\\left(1 - e^{-4d/3}\\right)$, we solve for distance $d$:\n$$\n\\widehat{d}_{\\mathrm{JC}}(p) = -\\frac{3}{4} \\ln\\left(1 - \\frac{4}{3}p\\right)\n$$\nThis estimator is valid for observed proportions $p < 3/4$.\n\n#### K80 Distance Estimator\nFrom the equations for $P(t,\\kappa)$ and $Q(t,\\kappa)$, we can see that:\n$1 - 2Q = e^{-\\frac{4t}{2+\\kappa}}$\n$1 - 2P - Q = e^{-\\frac{2(\\kappa+1)t}{2+\\kappa}}$\nThese cannot be solved for $t$ without knowing $\\kappa$. However, a different algebraic manipulation not requiring $\\kappa$ yields the standard K80 distance estimator:\n$$\n\\widehat{d}_{\\mathrm{K80}}(P,Q) = -\\frac{1}{2}\\ln(1-2P-Q) - \\frac{1}{4}\\ln(1-2Q)\n$$\nThis is valid for $Q < 1/2$ and $2P+Q < 1$. When the true model is JC69 ($p$ is observed), we use $P=p/3$ and $Q=2p/3$ in the K80 estimator. This substitution shows $\\widehat{d}_{\\mathrm{K80}}(p/3, 2p/3) = \\widehat{d}_{\\mathrm{JC}}(p)$, confirming JC69 is nested within K80.\n\n### 3. Sampling Variance via the Delta Method\nThe variance of the distance estimators is approximated using the delta method.\n\n#### Variance of $\\widehat{d}_{\\mathrm{JC}}$\nThe observed proportion $\\widehat{p}$ from $L$ sites has variance $\\mathrm{Var}(\\widehat{p}) = p(1-p)/L$. The variance of the distance is:\n$$\n\\mathrm{Var}(\\widehat{d}_{\\mathrm{JC}}) \\approx \\left( \\frac{\\partial \\widehat{d}_{\\mathrm{JC}}}{\\partial p} \\right)^2 \\mathrm{Var}(\\widehat{p}) = \\left( \\frac{1}{1-4p/3} \\right)^2 \\frac{p(1-p)}{L}\n$$\n\n#### Variance of $\\widehat{d}_{\\mathrm{K80}}$\nThe counts of transitions, transversions, and same sites follow a multinomial distribution. The covariance matrix of the observed proportions $(\\widehat{P}, \\widehat{Q})$ is:\n$$\n\\mathrm{Cov}(\\widehat{P}, \\widehat{Q}) = \\frac{1}{L} \\begin{pmatrix} P(1-P) & -PQ \\\\ -PQ & Q(1-Q) \\end{pmatrix}\n$$\nThe gradient of $\\widehat{d}_{\\mathrm{K80}}$ is $\\nabla d = \\left(\\frac{\\partial d}{\\partial P}, \\frac{\\partial d}{\\partial Q}\\right)^T$, where:\n$$\n\\frac{\\partial d}{\\partial P} = \\frac{1}{1-2P-Q}, \\quad \\frac{\\partial d}{\\partial Q} = \\frac{1}{2(1-2P-Q)} + \\frac{1}{2(1-2Q)}\n$$\nThe variance is given by the quadratic form $\\mathrm{Var}(\\widehat{d}_{\\mathrm{K80}}) \\approx (\\nabla d)^T \\mathrm{Cov}(\\widehat{P}, \\widehat{Q}) (\\nabla d)$:\n$$\n\\mathrm{Var}(\\widehat{d}_{\\mathrm{K80}}) \\approx \\frac{1}{L} \\left[ \\left(\\frac{\\partial d}{\\partial P}\\right)^2 P(1-P) + \\left(\\frac{\\partial d}{\\partial Q}\\right)^2 Q(1-Q) - 2\\left(\\frac{\\partial d}{\\partial P}\\right)\\left(\\frac{\\partial d}{\\partial Q}\\right)PQ \\right]\n$$\n\n### 4. Molecular Clock Test and Bias Quantification\nFor the analysis, we use expected proportions derived from the true model to isolate bias from sampling error.\n\n- **Bias**: Given a true model and distance $t_{\\text{pair}}$, we first compute the expected proportions ($P,Q$ or $p$). Then we apply the (possibly misspecified) distance estimator to these proportions to get an estimated distance $\\widehat{d}$. The bias is $b = \\widehat{d} - t_{\\text{pair}}$. If the estimator matches the true model, the bias is zero.\n\n- **Molecular Clock Test**: We test the null hypothesis $H_0: d_{1O} = d_{2O}$ where $d_{1O} = t_1+t_0$ and $d_{2O} = t_2+t_0$. The test statistic is:\n  $$\n  Z = \\frac{\\widehat{d}_{1O} - \\widehat{d}_{2O}}{\\sqrt{\\mathrm{Var}(\\widehat{d}_{1O}) + \\mathrm{Var}(\\widehat{d}_{2O})}}\n  $$\n  Here, $\\widehat{d}$ values are the distances estimated from expected proportions for the true distances $d_{1O}$ and $d_{2O}$, and the variances are calculated using these same proportions and the respective sequence lengths $L_1$ and $L_2$. We reject $H_0$ at significance level $\\alpha=0.05$ if $|Z| > z_{0.975} \\approx 1.95996$.\n\nThe implementation will proceed by creating functions for these derived formulae and applying them to the specified test cases.", "answer": "`[[-0.03819034509653702, 0.0, False, True],[-0.2078519634907998, 0.0, False, True],[-1.1102230246251565e-16, 0.0, True, True]]`", "id": "2859543"}]}