{"hands_on_practices": [{"introduction": "Coalescent theory is built upon a simple, powerful idea: tracing genetic lineages backward in time until they merge, or \"coalesce,\" in a common ancestor. This first practice problem explores the most fundamental building block of this process: the waiting time for the very first coalescence event in a sample. By calculating the expected time for four lineages to become three, you will gain a hands-on understanding of how the coalescence rate depends on both the population size ($N$) and the number of sampled lineages, a core principle that underpins all coalescent models [@problem_id:1477286].", "problem": "Consider an idealized diploid population with a constant size of $N$ individuals. In this model, generations are discrete and non-overlapping. We assume that each allele in a given generation is a perfect copy of a randomly selected allele from the complete gene pool of the previous generation. The gene pool of any parental generation consists of $2N$ alleles in total.\n\nWhen tracing the ancestry of alleles backward in time, a 'coalescent event' is defined as the moment when two distinct genetic lineages originate from the same single parental allele in the immediately preceding generation.\n\nSuppose you have collected a sample containing four distinct alleles from the current population. You wish to trace their ancestries back in time. Calculate the expected number of generations one must go back until the first coalescent event occurs among any pair of these four lineages. Such an event will reduce the number of distinct ancestral lineages in your sample from four to three.\n\nExpress your answer as an analytical formula in terms of the population size $N$.", "solution": "We model reproduction by the Wright–Fisher scheme for a diploid population of constant size $N$, so that each of the $2N$ alleles in generation $t-1$ is an equally likely parent for any allele in generation $t$. Tracing $k$ sampled lineages backward one generation, each lineage independently chooses one parent allele uniformly from the $2N$ parental alleles.\n\nFor any specific pair of lineages, the probability that they coalesce in the immediately preceding generation (i.e., both choose the same parental allele) is\n$$\n\\frac{1}{2N},\n$$\nsince after the first lineage picks an ancestor, the second must match that choice among $2N$ equally likely alleles.\n\nWith $k=4$ lineages, there are $\\binom{4}{2}=6$ unordered pairs. Under the standard coalescent approximation (which ignores the probability of simultaneous multiple coalescences, an event of order $(2N)^{-2}$), the per-generation probability that at least one pair coalesces is\n$$\np=\\binom{4}{2}\\cdot\\frac{1}{2N}=\\frac{6}{2N}=\\frac{3}{N}.\n$$\nBecause each generation back either yields a coalescent event (reducing the number of lineages) or leaves all four lineages distinct, and the situation renews with the same probability in each step, the waiting time $T$ (in generations) to the first coalescent event has a geometric distribution with success parameter $p$. Therefore, the expected number of generations until the first coalescent event is\n$$\n\\mathbb{E}[T]=\\frac{1}{p}=\\frac{N}{3}.\n$$", "answer": "$$\\boxed{\\frac{N}{3}}$$", "id": "1477286"}, {"introduction": "While understanding the first coalescence event is crucial, the ultimate goal is often to understand the full ancestral history of a sample, all the way back to the single Most Recent Common Ancestor (MRCA). This exercise asks you to derive the expected time to the MRCA ($E[T_{\\mathrm{MRCA}}]$) by integrating the waiting times across all stages of the coalescent process, from $n$ lineages down to one. Successfully completing this derivation solidifies your understanding of the coalescent as a sequential Markov process and introduces the power of \"coalescent units\" for standardizing time across different population sizes [@problem_id:2800316].", "problem": "A panmictic diploid population of constant effective size $N_{e}$ is sampled at $n \\ge 2$ chromosomes. Time is measured in coalescent units, that is, generations rescaled by $2N_{e}$, so that a single pair of lineages coalesces at rate $1$ per unit of rescaled time. Under Kingman’s coalescent, when there are $k$ ancestral lineages, any unordered pair merges at total rate $\\binom{k}{2}$, and the waiting time to the next coalescent event is exponentially distributed. Using only these definitions and the Markov property of the process, derive a closed-form expression, as a function of $n$, for the expected total time back to the most recent common ancestor (MRCA) of the sample, $E[T_{\\mathrm{MRCA}}]$, expressed in coalescent time units. Provide the final expression in simplest closed form. No rounding is required.", "solution": "The objective is to find the expected total time back to the most recent common ancestor (MRCA) for a sample of $n$ chromosomes, denoted as $E[T_{\\mathrm{MRCA}}]$. The coalescent process models the ancestral lineages of the sample backward in time. It begins with $k=n$ lineages at the present time ($t=0$) and ends when $k=1$ lineage remains, which is the MRCA of the entire sample.\n\nLet $T_k$ be the random variable representing the waiting time for a coalescence event to occur when there are $k$ ancestral lineages. The process transitions from a state with $k$ lineages to a state with $k-1$ lineages. The total time to the MRCA is the sum of these waiting times from $k=n$ down to $k=2$. The final coalescence event, from $k=2$ to $k=1$, is the event that establishes the MRCA. Thus, the total time is:\n$$T_{\\mathrm{MRCA}} = T_n + T_{n-1} + \\dots + T_2 = \\sum_{k=2}^{n} T_k$$\nBy the linearity of expectation, the expected total time is the sum of the expected waiting times for each interval:\n$$E[T_{\\mathrm{MRCA}}] = E\\left[\\sum_{k=2}^{n} T_k\\right] = \\sum_{k=2}^{n} E[T_k]$$\nThis step is justified by the Markov property of the process, which implies that the waiting time in each state is independent of the preceding history.\n\nWe must now find the expected waiting time, $E[T_k]$. According to the problem statement, when there are $k$ lineages, any unordered pair can merge, and the total rate of coalescence is $\\binom{k}{2}$. This is because there are $\\binom{k}{2}$ distinct pairs of lineages, and time is scaled such that any single pair coalesces at rate $1$. The total rate of the first coalescence event to occur, $\\lambda_k$, is the sum of the rates of all independent competing pairs, which is $\\lambda_k = \\binom{k}{2}$.\n\nThe waiting time $T_k$ for this event is exponentially distributed with rate $\\lambda_k$:\n$$T_k \\sim \\mathrm{Exp}\\left(\\lambda_k\\right) = \\mathrm{Exp}\\left(\\binom{k}{2}\\right)$$\nThe expected value of an exponentially distributed random variable with rate $\\lambda$ is $1/\\lambda$. Therefore, the expected duration of the interval with $k$ lineages is:\n$$E[T_k] = \\frac{1}{\\lambda_k} = \\frac{1}{\\binom{k}{2}}$$\nSubstituting the formula for the binomial coefficient, $\\binom{k}{2} = \\frac{k(k-1)}{2}$, we obtain:\n$$E[T_k] = \\frac{1}{\\frac{k(k-1)}{2}} = \\frac{2}{k(k-1)}$$\nAll times are in coalescent units, as specified.\n\nNow, we substitute this expression back into the sum for the total expected time:\n$$E[T_{\\mathrm{MRCA}}] = \\sum_{k=2}^{n} \\frac{2}{k(k-1)}$$\nTo evaluate this summation, we employ the method of partial fraction decomposition on the general term:\n$$\\frac{2}{k(k-1)} = 2\\left(\\frac{1}{k-1} - \\frac{1}{k}\\right)$$\nThe sum becomes a telescoping series:\n$$E[T_{\\mathrm{MRCA}}] = \\sum_{k=2}^{n} 2\\left(\\frac{1}{k-1} - \\frac{1}{k}\\right) = 2 \\sum_{k=2}^{n} \\left(\\frac{1}{k-1} - \\frac{1}{k}\\right)$$\nExpanding the sum demonstrates the cancellation of terms:\n$$E[T_{\\mathrm{MRCA}}] = 2 \\left[ \\left(\\frac{1}{1} - \\frac{1}{2}\\right) + \\left(\\frac{1}{2} - \\frac{1}{3}\\right) + \\left(\\frac{1}{3} - \\frac{1}{4}\\right) + \\dots + \\left(\\frac{1}{n-1} - \\frac{1}{n}\\right) \\right]$$\nAll intermediate terms of the form $\\pm \\frac{1}{j}$ for $j \\in \\{2, 3, \\dots, n-1\\}$ cancel out, leaving only the first and the last terms within the brackets:\n$$E[T_{\\mathrm{MRCA}}] = 2 \\left(\\frac{1}{1} - \\frac{1}{n}\\right) = 2 \\left(1 - \\frac{1}{n}\\right)$$\nFinally, we write this expression in its simplest closed form as a single fraction:\n$$E[T_{\\mathrm{MRCA}}] = \\frac{2(n-1)}{n}$$\nThis is the final expression for the expected time to the most recent common ancestor for a sample of size $n$, expressed in coalescent time units.", "answer": "$$\\boxed{\\frac{2(n-1)}{n}}$$", "id": "2800316"}, {"introduction": "Real-world populations rarely maintain a constant size; they expand, contract, and experience dramatic bottlenecks. This practice problem challenges you to move beyond the idealized constant-size model and explore how demographic fluctuations affect the coalescent process. By calculating the effective population size ($N_e$) for a population with a cyclical history, you will discover why the harmonic mean—not the arithmetic mean—is the appropriate measure, revealing the profound and lasting impact that population bottlenecks have on genetic drift and lineage coalescence [@problem_id:1914452].", "problem": "A population of haploid archaea inhabits a geyser that exhibits a predictable cycle of activity. During the geyser's stable phase, which lasts for $g_1 = 90$ generations, the population thrives and maintains a large size of $N_{large} = 5.0 \\times 10^5$ individuals. Following this, the geyser enters a volatile eruptive phase for $g_2 = 10$ generations, during which the population crashes to a small bottleneck size of $N_{small} = 5.0 \\times 10^2$ individuals. This entire cycle of $g_1 + g_2$ generations repeats indefinitely.\n\nIn a haploid population of size $N$, the probability that any two randomly chosen gene lineages coalesce (i.e., trace back to a single common ancestor in the preceding generation) is given by the coalescent rate, $1/N$. The long-term genetic behavior of this fluctuating population can be described by an effective population size, $N_e$. The effective population size is defined as the size of an idealized, constant-sized population that would experience the same average coalescent rate as the actual, fluctuating population.\n\nCalculate the effective population size, $N_e$, for this archaeal population. Round your final answer to three significant figures.", "solution": "In a haploid population, the per-generation coalescent rate for two lineages is $1/N_{t}$ when the census size in that generation is $N_{t}$. The effective population size $N_{e}$ is defined so that its constant coalescent rate equals the long-run time average of the fluctuating coalescent rate. Therefore,\n$$\n\\frac{1}{N_{e}}=\\left\\langle \\frac{1}{N_{t}}\\right\\rangle=\\frac{g_{1}}{g_{1}+g_{2}}\\cdot\\frac{1}{N_{large}}+\\frac{g_{2}}{g_{1}+g_{2}}\\cdot\\frac{1}{N_{small}}.\n$$\nEquivalently,\n$$\n\\frac{1}{N_{e}}=\\frac{g_{1}\\left(\\frac{1}{N_{large}}\\right)+g_{2}\\left(\\frac{1}{N_{small}}\\right)}{g_{1}+g_{2}},\\quad\\text{so}\\quad N_{e}=\\frac{g_{1}+g_{2}}{\\frac{g_{1}}{N_{large}}+\\frac{g_{2}}{N_{small}}}.\n$$\nSubstitute $g_{1}=90$, $g_{2}=10$, $N_{large}=5.0\\times 10^{5}$, and $N_{small}=5.0\\times 10^{2}$:\n$$\n\\frac{1}{N_{e}}=\\frac{90\\left(\\frac{1}{5.0\\times 10^{5}}\\right)+10\\left(\\frac{1}{5.0\\times 10^{2}}\\right)}{100}\n=\\frac{\\frac{90}{5.0\\times 10^{5}}+\\frac{10}{5.0\\times 10^{2}}}{100}.\n$$\nCompute the numerator exactly:\n$$\n\\frac{90}{5.0\\times 10^{5}}=\\frac{9}{5\\times 10^{4}}=\\frac{9}{50000},\\qquad\n\\frac{10}{5.0\\times 10^{2}}=\\frac{1}{50}=\\frac{1000}{50000},\n$$\nso\n$$\n\\frac{1}{N_{e}}=\\frac{\\frac{9}{50000}+\\frac{1000}{50000}}{100}=\\frac{\\frac{1009}{50000}}{100}=\\frac{1009}{5\\times 10^{6}}.\n$$\nHence\n$$\nN_{e}=\\frac{5\\times 10^{6}}{1009}\\approx 4.955\\times 10^{3}.\n$$\nRounding to three significant figures gives $N_{e}=4.96\\times 10^{3}$.", "answer": "$$\\boxed{4.96 \\times 10^{3}}$$", "id": "1914452"}]}