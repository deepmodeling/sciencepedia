{"hands_on_practices": [{"introduction": "Chromatin remodeling complexes are molecular machines that depend on ATP hydrolysis to perform mechanical work on DNA and histones. This foundational exercise asks you to model the \"engine\" of a remodeler using the classic Michaelis-Menten kinetics framework. By calculating remodeling rates at different ATP concentrations, you will gain a quantitative understanding of how the enzymatic activity of these complexes is coupled to the cell's metabolic state, a critical link between cellular energy and gene regulation [@problem_id:2933165].", "problem": "A single-subunit adenosine triphosphate (ATP)-dependent chromatin remodeling complex uses the chemical free energy of ATP hydrolysis to reposition nucleosomes. Assume that the rate-limiting step for productive remodeling is the ATPase cycle and that the ATPase obeys single-substrate Michaelis–Menten kinetics under steady-state conditions. Let the catalytic turnover number be $k_{\\text{cat}} = 25\\,\\mathrm{s}^{-1}$ and the Michaelis constant for ATP be $K_{M} = 0.12\\,\\mathrm{mM}$. Each ATP hydrolysis produces, on average, a fraction $\\eta = 0.50$ of a productive nucleosome-repositioning event, so that the per-complex remodeling rate at ATP concentration $[\\text{ATP}]$ is proportional to the ATP hydrolysis rate with proportionality factor $\\eta$. Consider two ATP conditions representative of stressed and unstressed nuclei: a low level $[\\text{ATP}]_{\\text{low}} = 0.015\\,\\mathrm{mM}$ and a high level $[\\text{ATP}]_{\\text{high}} = 3.0\\,\\mathrm{mM}$. Typical nuclear ATP concentrations in proliferating mammalian cells lie between $1$ and $5\\,\\mathrm{mM}$.\n\nUsing only the definitions and steady-state assumptions above:\n- Compute the per-complex remodeling rates at $[\\text{ATP}]_{\\text{low}}$ and $[\\text{ATP}]_{\\text{high}}$ in $\\mathrm{s}^{-1}$, and use asymptotic reasoning to identify which regime (linear or saturated with respect to ATP) each condition falls into.\n- Then, report the fold-change in remodeling rate between the high-ATP and low-ATP conditions, defined as $F = r_{\\text{high}}/r_{\\text{low}}$.\n\nRound $F$ to three significant figures. The final reported number must be $F$ only, which is dimensionless (no units).", "solution": "The problem statement must first be subjected to rigorous validation.\n\nGivens are extracted verbatim as follows:\n- Model: Single-substrate Michaelis–Menten kinetics for ATPase activity.\n- Catalytic turnover number: $k_{\\text{cat}} = 25\\,\\mathrm{s}^{-1}$.\n- Michaelis constant for ATP: $K_{M} = 0.12\\,\\mathrm{mM}$.\n- Productive efficiency factor: $\\eta = 0.50$.\n- Relation: Per-complex remodeling rate is proportional to ATP hydrolysis rate with proportionality factor $\\eta$.\n- Low substrate concentration: $[\\text{ATP}]_{\\text{low}} = 0.015\\,\\mathrm{mM}$.\n- High substrate concentration: $[\\text{ATP}]_{\\text{high}} = 3.0\\,\\mathrm{mM}$.\n- Task: Compute remodeling rates $r_{\\text{low}}$ and $r_{\\text{high}}$, identify their kinetic regimes, and calculate the fold-change $F = r_{\\text{high}}/r_{\\text{low}}$.\n\nValidation Verdict:\nThe problem is scientifically grounded, modeling a well-understood biological process (ATP-dependent chromatin remodeling) with a standard biochemical framework (Michaelis–Menten kinetics). The provided parameters ($k_{\\text{cat}}$, $K_{M}$, $[\\text{ATP}]$) are biologically plausible. The problem is well-posed, providing all necessary information for a unique solution. It is free from ambiguity, contradiction, and subjective claims. Therefore, the problem is deemed valid and a solution will be furnished.\n\nThe rate of ATP hydrolysis per enzyme complex, $v_{\\text{hydrolysis}}$, is described by the Michaelis–Menten equation for a single substrate, which is ATP in this case. The equation is:\n$$\nv_{\\text{hydrolysis}} ([\\text{ATP}]) = \\frac{k_{\\text{cat}} [\\text{ATP}]}{K_{M} + [\\text{ATP}]}\n$$\nHere, $k_{\\text{cat}}$ is the turnover number, representing the maximum number of substrate molecules converted to product per enzyme site per unit time, and $K_{M}$ is the Michaelis constant, representing the substrate concentration at which the reaction rate is half of the maximum.\n\nThe problem states that the per-complex remodeling rate, which we denote as $r$, is proportional to the ATP hydrolysis rate with a proportionality factor $\\eta$, representing the efficiency of converting chemical energy from ATP hydrolysis into productive work.\n$$\nr([\\text{ATP}]) = \\eta \\cdot v_{\\text{hydrolysis}} = \\eta \\frac{k_{\\text{cat}} [\\text{ATP}]}{K_{M} + [\\text{ATP}]}\n$$\n\nWe will now compute the remodeling rate for the two specified ATP concentrations.\n\nFor the low ATP condition, $[\\text{ATP}]_{\\text{low}} = 0.015\\,\\mathrm{mM}$:\nThe remodeling rate $r_{\\text{low}}$ is:\n$$\nr_{\\text{low}} = \\eta \\frac{k_{\\text{cat}} [\\text{ATP}]_{\\text{low}}}{K_{M} + [\\text{ATP}]_{\\text{low}}} = (0.50) \\frac{(25\\,\\mathrm{s}^{-1}) (0.015\\,\\mathrm{mM})}{0.12\\,\\mathrm{mM} + 0.015\\,\\mathrm{mM}}\n$$\n$$\nr_{\\text{low}} = (0.50) \\frac{0.375}{0.135}\\,\\mathrm{s}^{-1} = (0.50) \\left(\\frac{25}{9}\\right)\\,\\mathrm{s}^{-1} \\approx 1.389\\,\\mathrm{s}^{-1}\n$$\nTo determine the kinetic regime, we compare $[\\text{ATP}]_{\\text{low}}$ to $K_{M}$. Here, $[\\text{ATP}]_{\\text{low}} = 0.015\\,\\mathrm{mM}$ and $K_{M} = 0.12\\,\\mathrm{mM}$. The ratio is $[\\text{ATP}]_{\\text{low}} / K_{M} = 0.015 / 0.12 = 1/8$. Since $[\\text{ATP}]_{\\text{low}} \\ll K_{M}$, the denominator of the rate equation can be approximated as $K_{M} + [\\text{ATP}]_{\\text{low}} \\approx K_{M}$. In this limit, the rate equation becomes:\n$$\nr \\approx \\eta \\frac{k_{\\text{cat}}}{K_{M}} [\\text{ATP}]\n$$\nThe rate is approximately linear with respect to the substrate concentration $[\\text{ATP}]$. This is the first-order or linear regime.\n\nFor the high ATP condition, $[\\text{ATP}]_{\\text{high}} = 3.0\\,\\mathrm{mM}$:\nThe remodeling rate $r_{\\text{high}}$ is:\n$$\nr_{\\text{high}} = \\eta \\frac{k_{\\text{cat}} [\\text{ATP}]_{\\text{high}}}{K_{M} + [\\text{ATP}]_{\\text{high}}} = (0.50) \\frac{(25\\,\\mathrm{s}^{-1}) (3.0\\,\\mathrm{mM})}{0.12\\,\\mathrm{mM} + 3.0\\,\\mathrm{mM}}\n$$\n$$\nr_{\\text{high}} = (0.50) \\frac{75}{3.12}\\,\\mathrm{s}^{-1} = (0.50) \\left(\\frac{625}{26}\\right)\\,\\mathrm{s}^{-1} \\approx 12.019\\,\\mathrm{s}^{-1}\n$$\nTo determine the kinetic regime, we compare $[\\text{ATP}]_{\\text{high}}$ to $K_{M}$. Here, $[\\text{ATP}]_{\\text{high}} = 3.0\\,\\mathrm{mM}$ and $K_{M} = 0.12\\,\\mathrm{mM}$. The ratio is $[\\text{ATP}]_{\\text{high}} / K_{M} = 3.0 / 0.12 = 25$. Since $[\\text{ATP}]_{\\text{high}} \\gg K_{M}$, the denominator can be approximated as $K_{M} + [\\text{ATP}]_{\\text{high}} \\approx [\\text{ATP}]_{\\text{high}}$. In this limit, the rate equation becomes:\n$$\nr \\approx \\eta \\frac{k_{\\text{cat}} [\\text{ATP}]}{[\\text{ATP}]} = \\eta k_{\\text{cat}}\n$$\nThe rate approaches a constant maximum value, $r_{\\text{max}} = \\eta k_{\\text{cat}} = (0.50)(25\\,\\mathrm{s}^{-1}) = 12.5\\,\\mathrm{s}^{-1}$, and is independent of the substrate concentration. This is the zero-order or saturated regime. Our calculated value $r_{\\text{high}} \\approx 12.019\\,\\mathrm{s}^{-1}$ is indeed close to $r_{\\text{max}}$.\n\nFinally, we compute the fold-change $F$, defined as the ratio of the high-ATP rate to the low-ATP rate, $F = r_{\\text{high}}/r_{\\text{low}}$.\n$$\nF = \\frac{r_{\\text{high}}}{r_{\\text{low}}} = \\frac{\\eta \\frac{k_{\\text{cat}} [\\text{ATP}]_{\\text{high}}}{K_{M} + [\\text{ATP}]_{\\text{high}}}}{\\eta \\frac{k_{\\text{cat}} [\\text{ATP}]_{\\text{low}}}{K_{M} + [\\text{ATP}]_{\\text{low}}}}\n$$\nThe constants $\\eta$ and $k_{\\text{cat}}$ cancel, yielding:\n$$\nF = \\frac{[\\text{ATP}]_{\\text{high}}}{[\\text{ATP}]_{\\text{low}}} \\cdot \\frac{K_{M} + [\\text{ATP}]_{\\text{low}}}{K_{M} + [\\text{ATP}]_{\\text{high}}}\n$$\nSubstituting the given numerical values:\n$$\nF = \\frac{3.0\\,\\mathrm{mM}}{0.015\\,\\mathrm{mM}} \\cdot \\frac{0.12\\,\\mathrm{mM} + 0.015\\,\\mathrm{mM}}{0.12\\,\\mathrm{mM} + 3.0\\,\\mathrm{mM}} = (200) \\cdot \\frac{0.135}{3.12}\n$$\n$$\nF = \\frac{27}{3.12} = \\frac{2700}{312} = \\frac{225}{26}\n$$\nCalculating the numerical value:\n$$\nF \\approx 8.653846...\n$$\nThe problem requires rounding to three significant figures.\n$$\nF \\approx 8.65\n$$\nThis dimensionless number represents the factor by which the chromatin remodeling rate increases when the nuclear ATP concentration shifts from a stressed level to a level typical of proliferating cells.", "answer": "$$\n\\boxed{8.65}\n$$", "id": "2933165"}, {"introduction": "Beyond individual kinetics, the diverse families of chromatin remodelers have distinct roles in shaping the genomic landscape. This thought experiment challenges you to act as a geneticist and predict the unique \"genomic signatures\" of the SWI/SNF and ISWI remodeler families. Reasoning through how their specialized functions—creating accessibility versus organizing nucleosome arrays—would alter data from techniques like MNase-seq and ATAC-seq will sharpen your intuition for interpreting complex epigenomic datasets [@problem_id:2796649].", "problem": "A eukaryotic promoter exhibits a canonical architecture with a nucleosome-depleted region (NDR) centered on the transcription start site (TSS), flanked by a well-positioned $-1$ nucleosome upstream and a $+1$ nucleosome downstream, and a phased array into the gene body with an approximately regular nucleosome repeat length (NRL). You perform Micrococcal Nuclease sequencing (MNase-seq) and the Assay for Transposase-Accessible Chromatin using sequencing (ATAC-seq) under control conditions and then under two perturbations: knockdown of the SWItch/Sucrose Non-Fermentable (SWI/SNF) family of adenosine triphosphate (ATP)-dependent remodelers, and chemical inhibition of the Imitation SWItch (ISWI) family of ATP-dependent remodelers. Starting from the following foundational principles: (i) nucleosomes are the basic chromatin unit comprising approximately $147$ base pairs of DNA wrapped around a histone octamer; (ii) MNase-seq measures nucleosome occupancy and positioning by preferentially cleaving linker DNA, producing reads that reflect protected fragments; (iii) ATAC-seq measures DNA accessibility by Tn5 transposase integration, where high signal at promoters correlates with open chromatin and fragment-length periodicity reflects protection by one or more nucleosomes; (iv) SWI/SNF-family remodelers primarily disrupt, slide, and evict nucleosomes to open regulatory regions; and (v) ISWI-family remodelers primarily slide nucleosomes to generate and maintain evenly spaced arrays; predict, for each perturbation, the characteristic changes you would expect in MNase-seq and ATAC-seq at this promoter and its flanking nucleosome array. Choose the single option that best integrates these expectations in a scientifically consistent manner.\n\nA. SWI/SNF knockdown increases MNase-seq occupancy within the NDR/TSS and shifts the $+1$ nucleosome upstream into the NDR, reducing ATAC-seq promoter accessibility (lower peak height and fewer subnucleosomal fragments, e.g., $<100$ base pairs); ISWI inhibition decreases long-range phasing (fuzzier MNase-seq peaks and a broadened NRL distribution) and weakens ATAC-seq nucleosomal periodicity in flanking regions, with only modest change in promoter ATAC-seq peak height.\n\nB. SWI/SNF knockdown increases ATAC-seq accessibility at the promoter and reduces MNase-seq occupancy within the NDR due to loss of spacing, whereas ISWI inhibition sharpens MNase-seq oscillations (stronger phasing and a narrower NRL distribution) and strengthens ATAC-seq nucleosomal periodicity.\n\nC. SWI/SNF knockdown leaves MNase-seq unchanged at the TSS but reduces nucleosome occupancy across the gene body; ISWI inhibition compacts arrays to a shorter NRL with sharper MNase-seq phasing and causes a strong increase in ATAC-seq promoter accessibility.\n\nD. SWI/SNF knockdown globally increases nucleosome spacing regularity (more periodic MNase-seq arrays) due to compensatory activity of other remodelers, while ATAC-seq promoter signal is unchanged; ISWI inhibition leaves MNase-seq profiles unchanged but abolishes promoter ATAC-seq signal almost completely.", "solution": "The problem statement will first be validated for scientific soundness, consistency, and completeness.\n\n### Step 1: Extract Givens\nThe problem provides the following foundational information:\n- **Canonical Promoter Architecture**: A eukaryotic promoter with a nucleosome-depleted region (NDR) at the transcription start site (TSS), flanked by a well-positioned $-1$ nucleosome and a $+1$ nucleosome, and a phased array with a regular nucleosome repeat length (NRL).\n- **Experimental Techniques**: Micrococcal Nuclease sequencing (MNase-seq) and Assay for Transposase-Accessible Chromatin using sequencing (ATAC-seq).\n- **Perturbations**:\n    1. Knockdown of the SWItch/Sucrose Non-Fermentable (SWI/SNF) family of adenosine triphosphate (ATP)-dependent remodelers.\n    2. Chemical inhibition of the Imitation SWItch (ISWI) family of ATP-dependent remodelers.\n- **Foundational Principles**:\n    - (i) Nucleosomes are the basic chromatin unit comprising approximately $147$ base pairs of DNA wrapped around a histone octamer.\n    - (ii) MNase-seq measures nucleosome occupancy and positioning by preferentially cleaving linker DNA, producing reads that reflect protected fragments.\n    - (iii) ATAC-seq measures DNA accessibility by Tn$5$ transposase integration, where high signal at promoters correlates with open chromatin and fragment-length periodicity reflects protection by one or more nucleosomes.\n    - (iv) SWI/SNF-family remodelers primarily disrupt, slide, and evict nucleosomes to open regulatory regions.\n    - (v) ISWI-family remodelers primarily slide nucleosomes to generate and maintain evenly spaced arrays.\n\n### Step 2: Validate Using Extracted Givens\nThe problem statement is subjected to critical validation.\n1.  **Scientifically Grounded**: The problem is rooted in established principles of molecular biology and genetics. The descriptions of promoter architecture, nucleosome structure, the functions of MNase-seq and ATAC-seq, and the distinct roles of SWI/SNF and ISWI chromatin remodeling families are factually correct and represent consensus knowledge in the field.\n2.  **Well-Posed**: The problem is well-posed. It asks for a prediction of experimental outcomes based on a given set of foundational principles and specific perturbations. The question is structured to have a unique, logical solution derivable from the premises.\n3.  **Objective**: The language is technical, precise, and free from subjective or ambiguous terminology. All terms used (e.g., NDR, TSS, NRL, SWI/SNF, ISWI) have standard, well-defined meanings in genetics.\n4.  **Completeness and Consistency**: The problem provides all necessary information through the five foundational principles to deduce the consequences of the two perturbations. There are no internal contradictions.\n5.  **No Other Flaws**: The problem is not trivial, metaphorical, or unrealistic. It represents a standard conceptual question in the study of chromatin regulation.\n\n### Step 3: Verdict and Action\nThe problem statement is valid. A solution will be derived based on the provided principles.\n\n### Derivation of Solution\nThe solution requires predicting the effects of two distinct perturbations on chromatin structure as measured by MNase-seq and ATAC-seq. We will analyze each perturbation separately based on the given principles.\n\n**Analysis of SWI/SNF Knockdown**\n\n- **Function**: According to principle (iv), SWI/SNF remodelers are responsible for opening regulatory regions by disrupting, sliding, and evicting nucleosomes. At the described promoter, this function is critical for maintaining the nucleosome-depleted region (NDR).\n- **Prediction for MNase-seq**: With reduced SWI/SNF activity, the force clearing nucleosomes from the NDR is diminished. This will lead to stochastic or directed encroachment of nucleosomes into the previously open region. Consequently, MNase-seq, which measures nucleosome occupancy, will detect an *increase* in signal within the NDR. The flanking nucleosomes, particularly the $+1$ nucleosome, which are normally kept at bay by SWI/SNF, may slide upstream into the NDR.\n- **Prediction for ATAC-seq**: According to principle (iii), ATAC-seq measures DNA accessibility. The NDR is the primary site of accessibility at an active or poised promoter. If this region becomes occupied by nucleosomes due to SWI/SNF knockdown, its accessibility to the Tn$5$ transposase will decrease. This would be observed as a *reduction* in the height of the ATAC-seq peak centered on the TSS. Furthermore, the high signal from short, subnucleosomal fragments (e.g., less than $100$ base pairs), which are characteristic of highly accessible, nucleosome-free DNA, would also decrease.\n\n**Analysis of ISWI Inhibition**\n\n- **Function**: According to principle (v), ISWI-family remodelers are primarily responsible for sliding nucleosomes to generate and maintain evenly spaced arrays. This creates the regular phasing and consistent nucleosome repeat length (NRL) observed extending into the gene body.\n- **Prediction for MNase-seq**: Chemical inhibition of ISWI will disrupt its \"spacing\" function. The regular, ordered arrangement of nucleosomes downstream of the TSS will be lost. Nucleosomes will become more irregularly positioned. In an MNase-seq profile, this will manifest as a loss of long-range phasing. The sharp peaks corresponding to individual nucleosomes in the array will become broader and less defined (\"fuzzier\"). The distribution of distances between adjacent nucleosomes will widen, meaning the NRL will no longer be a single value but a broad distribution.\n- **Prediction for ATAC-seq**: The periodicity of ATAC-seq fragment lengths, which reflects the regular spacing of nucleosomes (fragments corresponding to mono-, di-, tri-nucleosomes, etc.), will be weakened in the regions flanking the promoter, consistent with the loss of the phased array. Because the primary role of ISWI is nucleosome spacing rather than creating the initial open NDR (the primary role of SWI/SNF), its inhibition is expected to have a *modest* effect, if any, on the overall accessibility at the promoter's core (i.e., the ATAC-seq peak height at the TSS).\n\n**Integration of Predictions**\nIn summary:\n- **SWI/SNF Knockdown**: Leads to filling in of the NDR, shifting the $+1$ nucleosome upstream, increasing MNase-seq signal in the NDR, and decreasing ATAC-seq signal at the promoter.\n- **ISWI Inhibition**: Leads to disordered nucleosome arrays, causing fuzzier MNase-seq peaks, a broadened NRL distribution, and weakened ATAC-seq periodicity, with minimal change to promoter accessibility itself.\n\n### Option-by-Option Analysis\n\n**A. SWI/SNF knockdown increases MNase-seq occupancy within the NDR/TSS and shifts the $+1$ nucleosome upstream into the NDR, reducing ATAC-seq promoter accessibility (lower peak height and fewer subnucleosomal fragments, e.g., $<100$ base pairs); ISWI inhibition decreases long-range phasing (fuzzier MNase-seq peaks and a broadened NRL distribution) and weakens ATAC-seq nucleosomal periodicity in flanking regions, with only modest change in promoter ATAC-seq peak height.**\nThis option perfectly aligns with the derived predictions for both perturbations. The description of SWI/SNF knockdown effects on MNase-seq and ATAC-seq is accurate. The description of ISWI inhibition effects on MNase-seq phasing, NRL, and ATAC-seq periodicity is also accurate, correctly noting the modest impact on promoter peak height.\n**Verdict: Correct.**\n\n**B. SWI/SNF knockdown increases ATAC-seq accessibility at the promoter and reduces MNase-seq occupancy within the NDR due to loss of spacing, whereas ISWI inhibition sharpens MNase-seq oscillations (stronger phasing and a narrower NRL distribution) and strengthens ATAC-seq nucleosomal periodicity.**\nThis option is incorrect on multiple grounds. Knocking down SWI/SNF, which *creates* accessibility, would *decrease*, not increase, ATAC-seq signal. It would *increase*, not reduce, MNase-seq occupancy in the NDR. Inhibiting ISWI, the spacing factor, would *disrupt* phasing (less sharp), not sharpen it.\n**Verdict: Incorrect.**\n\n**C. SWI/SNF knockdown leaves MNase-seq unchanged at the TSS but reduces nucleosome occupancy across the gene body; ISWI inhibition compacts arrays to a shorter NRL with sharper MNase-seq phasing and causes a strong increase in ATAC-seq promoter accessibility.**\nThis option mischaracterizes the roles of both remodelers. SWI/SNF's primary role at the promoter is to establish the NDR at the TSS; leaving this region unchanged upon knockdown is illogical. For ISWI, \"sharper phasing\" is the opposite of the expected outcome of inhibition. A strong increase in promoter accessibility is not its primary function.\n**Verdict: Incorrect.**\n\n**D. SWI/SNF knockdown globally increases nucleosome spacing regularity (more periodic MNase-seq arrays) due to compensatory activity of other remodelers, while ATAC-seq promoter signal is unchanged; ISWI inhibition leaves MNase-seq profiles unchanged but abolishes promoter ATAC-seq signal almost completely.**\nThis option reverses the roles of the remodelers and makes incorrect claims. Increasing spacing regularity is the function of ISWI, not a result of SWI/SNF loss. Unchanged promoter ATAC-seq signal upon SWI/SNF knockdown contradicts its function. For ISWI, leaving MNase-seq profiles unchanged contradicts its spacing function, and abolishing promoter ATAC signal is an effect associated with remodelers that create the NDR, not spacing factors.\n**Verdict: Incorrect.**\n\nBased on a rigorous analysis of the provided principles, only option A provides a scientifically consistent and correct set of predictions for both experimental perturbations.", "answer": "$$\\boxed{A}$$", "id": "2796649"}, {"introduction": "This final practice transitions from principle to application, guiding you through a realistic computational biology workflow to identify the direct targets of a remodeler from experimental data. You will integrate multiple epigenomic datasets: ATAC-seq for accessibility, H3K27ac ChIP-seq for enhancer activity, and BRG1 ChIP-seq for remodeler occupancy [@problem_id:2796621]. Successfully completing this task demonstrates how quantitative data integration provides powerful evidence for specific molecular hypotheses, a cornerstone of modern genomics research.", "problem": "You are given a simplified, self-contained quantitative framework for integrating Assay for Transposase-Accessible Chromatin using sequencing (ATAC-seq), Histone H3 Lysine 27 acetylation (H3K27ac) Chromatin Immunoprecipitation sequencing (ChIP-seq), and Brahma-Related Gene 1 (BRG1, also known as SMARCA4) occupancy data in order to infer direct enhancer targets of the SWItch/Sucrose Non-Fermentable (SWI/SNF) chromatin remodeling complex upon BRG1 depletion. Design a program that implements a principled analysis grounded in the following fundamental base:\n\n- Active enhancers are marked by chromatin accessibility and histone acetylation. ATAC-seq read counts at an enhancer approximate its accessibility. H3K27ac ChIP-seq counts at an enhancer approximate its acetylation level.\n- Chromatin remodelers such as BRG1 directly modulate nucleosome positioning, thereby influencing enhancer accessibility and activity. Depleting BRG1 is expected to reduce enhancer accessibility and activity primarily at directly bound sites.\n- To quantify changes, use log-ratios of sequencing counts, stabilized by a positive pseudocount. To quantify association between BRG1 occupancy and enhancer changes across a set of enhancers, use the Pearson correlation coefficient.\n\nDefinitions to implement:\n\n- For an enhancer indexed by $i$, let $C^{A}_i$ and $D^{A}_i$ denote ATAC-seq counts in control and BRG1-depleted conditions, respectively. Let $C^{H}_i$ and $D^{H}_i$ denote H3K27ac ChIP-seq counts in control and BRG1-depleted conditions, respectively. Let $O_i$ denote the BRG1 occupancy score in control (e.g., ChIP-seq signal or peak strength).\n- Given a positive pseudocount $p$, define the base-$2$ log fold-change in accessibility as\n$$\n\\Delta^A_i = \\log_2\\!\\left(\\frac{D^{A}_i + p}{C^{A}_i + p}\\right),\n$$\nand the base-$2$ log fold-change in acetylation as\n$$\n\\Delta^H_i = \\log_2\\!\\left(\\frac{D^{H}_i + p}{C^{H}_i + p}\\right).\n$$\n- Define the Pearson correlation coefficient between two vectors $\\mathbf{x}=(x_i)$ and $\\mathbf{y}=(y_i)$ of equal length $n \\ge 2$ as\n$$\nr(\\mathbf{x},\\mathbf{y}) = \\frac{\\sum_{i=1}^{n} (x_i - \\bar{x})(y_i - \\bar{y})}{\\sqrt{\\left(\\sum_{i=1}^{n} (x_i - \\bar{x})^2\\right)\\left(\\sum_{i=1}^{n} (y_i - \\bar{y})^2\\right)}},\n$$\nwhere $\\bar{x}$ and $\\bar{y}$ are the arithmetic means. If the denominator is zero (i.e., zero variance in either vector), define $r(\\mathbf{x},\\mathbf{y}) = 0$ by convention.\n- Infer a set of putative direct BRG1 targets by thresholding using the following rule: an enhancer $i$ is called a direct target if and only if\n$$\nO_i \\ge \\tau_{\\mathrm{occ}}, \\quad \\Delta^A_i \\le -\\tau_{A}, \\quad \\Delta^H_i \\le -\\tau_{H},\n$$\nwhere $\\tau_{\\mathrm{occ}} > 0$, $\\tau_{A} > 0$, and $\\tau_{H} > 0$ are user-specified thresholds.\n\nYour program must implement the above definitions exactly and compute the following outputs for each test case:\n- The Pearson correlation coefficient between $\\{O_i\\}$ and $\\{\\Delta^A_i\\}$, rounded to three decimal places.\n- The Pearson correlation coefficient between $\\{O_i\\}$ and $\\{\\Delta^H_i\\}$, rounded to three decimal places.\n- The number of inferred direct targets (an integer).\n- The list of zero-based indices of inferred direct targets, in increasing order.\n\nEdge handling:\n- All logarithms are base $2$.\n- Use the provided pseudocount $p$ to avoid division by zero.\n- If the variance of either vector in the Pearson correlation is zero, return $0$ for that correlation.\n\nTest suite:\nProvide a program that hardcodes and evaluates the following three independent test cases. For each test case $t \\in \\{1,2,3\\}$, the input consists of arrays for $C^{A}$, $D^{A}$, $C^{H}$, $D^{H}$, $O$, and the scalars $p$, $\\tau_{\\mathrm{occ}}$, $\\tau_A$, $\\tau_H$. Arrays are aligned by enhancer index and must be treated as zero-indexed.\n\n- Test Case $1$ (general case):\n  - $C^{A} = [180, 240, 95, 160, 210, 130, 75, 300]$\n  - $D^{A} = [90, 200, 70, 120, 140, 110, 60, 260]$\n  - $C^{H} = [1500, 2200, 800, 1200, 2400, 900, 700, 2600]$\n  - $D^{H} = [900, 1800, 700, 900, 1900, 850, 650, 2100]$\n  - $O = [5.2, 7.8, 2.1, 6.0, 8.5, 3.5, 1.0, 9.0]$\n  - $p = 1.0$, $\\tau_{\\mathrm{occ}} = 6.0$, $\\tau_{A} = 0.3$, $\\tau_{H} = 0.25$\n\n- Test Case $2$ (boundary conditions with zeros and threshold ties):\n  - $C^{A} = [0, 50, 100, 0]$\n  - $D^{A} = [0, 25, 200, 0]$\n  - $C^{H} = [0, 400, 800, 0]$\n  - $D^{H} = [0, 200, 1200, 0]$\n  - $O = [6.0, 6.0, 5.9, 10.0]$\n  - $p = 0.5$, $\\tau_{\\mathrm{occ}} = 6.0$, $\\tau_{A} = 0.5$, $\\tau_{H} = 0.5$\n\n- Test Case $3$ (no variation edge case):\n  - $C^{A} = [100, 100, 100, 100]$\n  - $D^{A} = [100, 100, 100, 100]$\n  - $C^{H} = [1000, 1000, 1000, 1000]$\n  - $D^{H} = [1000, 1000, 1000, 1000]$\n  - $O = [3.0, 3.0, 3.0, 3.0]$\n  - $p = 1.0$, $\\tau_{\\mathrm{occ}} = 5.0$, $\\tau_{A} = 0.1$, $\\tau_{H} = 0.1$\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. Each test case result must itself be a list of the form $[\\text{corr\\_ATAC}, \\text{corr\\_H3K27ac}, \\text{n\\_direct}, \\text{direct\\_indices}]$, where $\\text{corr\\_ATAC}$ and $\\text{corr\\_H3K27ac}$ are floats rounded to three decimal places, $\\text{n\\_direct}$ is an integer, and $\\text{direct\\_indices}$ is a list of integers. Concretely, your output must look like\n$[[r^A_1, r^H_1, n_1, [\\dots]], [r^A_2, r^H_2, n_2, [\\dots]], [r^A_3, r^H_3, n_3, [\\dots]]]$\nwith the values computed for the above test suite and no additional text.", "solution": "The problem statement has been rigorously evaluated and is deemed valid. It is scientifically grounded in the principles of chromatin biology, mathematically well-posed, and free from any ambiguity, contradiction, or factual unsoundness. The problem provides a clear, quantitative framework for a simplified analysis of epigenomic data, which is a common task in computational biology. We shall, therefore, proceed with the derivation of the solution.\n\nThe objective is to analyze a set of putative enhancers using multimodal sequencing data to infer direct targets of the BRG1 chromatin remodeler. This is accomplished by implementing a series of precise computational steps for each provided test case.\n\nThe methodology is structured as follows:\n\n1.  **Computation of Log-Fold Changes**: For each enhancer, indexed by $i$, the change in chromatin accessibility and histone acetylation upon BRG1 depletion is quantified. We are given the base-$2$ log fold-change formulas:\n    -   Change in accessibility: $\\Delta^A_i = \\log_2\\!\\left(\\frac{D^{A}_i + p}{C^{A}_i + p}\\right)$\n    -   Change in acetylation: $\\Delta^H_i = \\log_2\\!\\left(\\frac{D^{H}_i + p}{C^{H}_i + p}\\right)$\n\n    Here, $C^{A}_i$ and $C^{H}_i$ are the ATAC-seq and H3K27ac ChIP-seq counts in the control condition, respectively. $D^{A}_i$ and $D^{H}_i$ are the corresponding counts in the BRG1-depleted condition. A positive pseudocount, $p$, is added to each term to stabilize the ratio, preventing division by zero and mitigating the impact of noise at low count values. These calculations produce two vectors, $\\mathbf{\\Delta}^A = \\{\\Delta^A_i\\}$ and $\\mathbf{\\Delta}^H = \\{\\Delta^H_i\\}$, representing the response of each enhancer to BRG1 depletion.\n\n2.  **Computation of Pearson Correlation Coefficients**: We must quantify the association between BRG1 occupancy at enhancers and the observed changes in accessibility and acetylation. This is achieved using the Pearson correlation coefficient, $r$. We compute two such coefficients:\n    -   $r(\\mathbf{O}, \\mathbf{\\Delta}^A)$: The correlation between the BRG1 occupancy vector $\\mathbf{O} = \\{O_i\\}$ and the accessibility change vector $\\mathbf{\\Delta}^A$.\n    -   $r(\\mathbf{O}, \\mathbf{\\Delta}^H)$: The correlation between the BRG1 occupancy vector $\\mathbf{O}$ and the acetylation change vector $\\mathbf{\\Delta}^H$.\n\n    The formula for the Pearson correlation coefficient between two vectors $\\mathbf{x}$ and $\\mathbf{y}$ of length $n$ is:\n    $$\n    r(\\mathbf{x},\\mathbf{y}) = \\frac{\\sum_{i=1}^{n} (x_i - \\bar{x})(y_i - \\bar{y})}{\\sqrt{\\left(\\sum_{i=1}^{n} (x_i - \\bar{x})^2\\right)\\left(\\sum_{i=1}^{n} (y_i - \\bar{y})^2\\right)}}\n    $$\n    where $\\bar{x}$ and $\\bar{y}$ are the sample means. As per the problem's explicit instruction, if the variance of either $\\mathbf{x}$ or $\\mathbf{y}$ is zero (making the denominator zero), the correlation $r(\\mathbf{x},\\mathbf{y})$ is defined to be $0$. The final values must be rounded to three decimal places.\n\n3.  **Identification of Direct Targets**: A set of criteria is provided to classify an enhancer as a \"direct target\". This classification is based on the premise that direct targets of BRG1 should have high BRG1 occupancy and exhibit a significant reduction in both accessibility and acetylation upon BRG1 depletion. An enhancer $i$ is classified as a direct target if and only if all three of the following conditions are met:\n    $$\n    O_i \\ge \\tau_{\\mathrm{occ}}, \\quad \\Delta^A_i \\le -\\tau_{A}, \\quad \\Delta^H_i \\le -\\tau_{H}\n    $$\n    where $\\tau_{\\mathrm{occ}}$, $\\tau_A$, and $\\tau_H$ are given positive thresholds for occupancy, accessibility reduction, and acetylation reduction, respectively. Note that a reduction corresponds to a negative log-fold change, hence the conditions $\\Delta^A_i \\le -\\tau_{A}$ and $\\Delta^H_i \\le -\\tau_{H}$.\n\n4.  **Assembly of Results**: For each test case, the final output is compiled into a list containing four elements:\n    -   The computed correlation $r(\\mathbf{O}, \\mathbf{\\Delta}^A)$, rounded.\n    -   The computed correlation $r(\\mathbf{O}, \\mathbf{\\Delta}^H)$, rounded.\n    -   The total number of enhancers identified as direct targets, an integer.\n    -   A list of the zero-based indices of these direct targets, sorted in increasing order.\n\nThe implementation will apply this sequence of operations to each of the three specified test cases to generate the final, formatted output. The use of vectorized operations, as provided by a library such as `NumPy`, is the most efficient and direct way to implement these calculations.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the chromatin remodeling analysis problem for the three given test cases.\n    \"\"\"\n    \n    test_cases = [\n        {\n            \"C_A\": [180, 240, 95, 160, 210, 130, 75, 300],\n            \"D_A\": [90, 200, 70, 120, 140, 110, 60, 260],\n            \"C_H\": [1500, 2200, 800, 1200, 2400, 900, 700, 2600],\n            \"D_H\": [900, 1800, 700, 900, 1900, 850, 650, 2100],\n            \"O\": [5.2, 7.8, 2.1, 6.0, 8.5, 3.5, 1.0, 9.0],\n            \"p\": 1.0, \"tau_occ\": 6.0, \"tau_A\": 0.3, \"tau_H\": 0.25\n        },\n        {\n            \"C_A\": [0, 50, 100, 0],\n            \"D_A\": [0, 25, 200, 0],\n            \"C_H\": [0, 400, 800, 0],\n            \"D_H\": [0, 200, 1200, 0],\n            \"O\": [6.0, 6.0, 5.9, 10.0],\n            \"p\": 0.5, \"tau_occ\": 6.0, \"tau_A\": 0.5, \"tau_H\": 0.5\n        },\n        {\n            \"C_A\": [100, 100, 100, 100],\n            \"D_A\": [100, 100, 100, 100],\n            \"C_H\": [1000, 1000, 1000, 1000],\n            \"D_H\": [1000, 1000, 1000, 1000],\n            \"O\": [3.0, 3.0, 3.0, 3.0],\n            \"p\": 1.0, \"tau_occ\": 5.0, \"tau_A\": 0.1, \"tau_H\": 0.1\n        }\n    ]\n\n    def calculate_pearson_r(x, y):\n        \"\"\"\n        Calculates the Pearson correlation coefficient. Returns 0 if variance of either input is 0.\n        \"\"\"\n        if x.std() == 0 or y.std() == 0:\n            return 0.0\n        return np.corrcoef(x, y)[0, 1]\n\n    results = []\n    for case in test_cases:\n        # Convert lists to numpy arrays for vectorized operations\n        C_A = np.array(case[\"C_A\"])\n        D_A = np.array(case[\"D_A\"])\n        C_H = np.array(case[\"C_H\"])\n        D_H = np.array(case[\"D_H\"])\n        O = np.array(case[\"O\"])\n        p = case[\"p\"]\n        tau_occ = case[\"tau_occ\"]\n        tau_A = case[\"tau_A\"]\n        tau_H = case[\"tau_H\"]\n\n        # Step 1: Calculate log fold-changes\n        delta_A = np.log2((D_A + p) / (C_A + p))\n        delta_H = np.log2((D_H + p) / (C_H + p))\n\n        # Step 2: Calculate Pearson correlation coefficients\n        corr_ATAC = calculate_pearson_r(O, delta_A)\n        corr_H3K27ac = calculate_pearson_r(O, delta_H)\n\n        # Round to three decimal places\n        corr_ATAC_rounded = round(corr_ATAC, 3)\n        corr_H3K27ac_rounded = round(corr_H3K27ac, 3)\n\n        # Step 3: Identify direct targets\n        target_indices = np.where(\n            (O >= tau_occ) & \n            (delta_A <= -tau_A) & \n            (delta_H <= -tau_H)\n        )[0]\n        \n        n_direct = len(target_indices)\n        direct_indices_list = target_indices.tolist()\n\n        # Step 4: Assemble results for the case\n        case_result = [\n            corr_ATAC_rounded,\n            corr_H3K27ac_rounded,\n            n_direct,\n            direct_indices_list\n        ]\n        results.append(case_result)\n\n    # Format the final output string to remove spaces for compact representation\n    # e.g., '[1, 2, [3, 4]]' -> '[1,2,[3,4]]'\n    final_output_str = f\"[{','.join(str(item).replace(' ', '') for item in results)}]\"\n    \n    print(final_output_str)\n\nsolve()\n```", "id": "2796621"}]}