{"hands_on_practices": [{"introduction": "Many traits, especially those related to disease susceptibility or the formation of discrete morphological features, can be conceptualized as having a continuous underlying risk or \"liability.\" A visible phenotype, such as a malformation, often appears only when this unobserved liability crosses a critical developmental threshold. This exercise explores the liability-threshold model, a cornerstone of quantitative genetics that provides a powerful framework for understanding such all-or-none traits. By working through this problem, you will gain a quantitative understanding of how canalization—modeled here as a reduction in the variance of liability—can effectively buffer development and lower the incidence of extreme phenotypes, providing a concrete link between statistical variance and biological robustness. [@problem_id:2630509]", "problem": "A developmental trait is determined by an underlying continuous liability $L$ that aggregates many small-effect genetic, environmental, and stochastic developmental inputs. By the central limit theorem, it is appropriate to model $L$ as Gaussian with mean $\\,\\mu\\,$ and variance $\\,V_{L} = V_{g} + V_{e} + V_{d}\\,$, where $V_{g}$, $V_{e}$, and $V_{d}$ are, respectively, the genetic, environmental, and developmental (stochastic) variance components. A binary extreme phenotype is expressed if and only if $L \\ge T$, where $T$ is a fixed developmental threshold. Developmental canalization is modeled as a proportional reduction of the developmental variance such that $V_{d} \\mapsto V_{d}' = r\\,V_{d}$ with $0<r<1$, while holding the mean $\\,\\mu\\,$ and threshold $\\,T\\,$ fixed.\n\nStarting only from these assumptions and standard properties of the Gaussian distribution, carry out the following:\n\n1) Derive an analytic expression for the frequency $f$ of the extreme phenotype as a function of $\\mu$, $T$, $V_{g}$, $V_{e}$, and $V_{d}$.\n\n2) Under canalization $V_{d} \\mapsto r V_{d}$, rewrite $f$ as a function $f(r)$ and compute $\\frac{d f}{d r}$. Use this to determine the sign of $\\frac{d f}{d r}$ when $T>\\mu$ and $V_{d}>0$, thereby establishing how reducing variance via canalization modifies the frequency of the extreme phenotype at fixed mean.\n\n3) For a concrete, biologically plausible parameterization, let $\\mu = 0$ (in liability units), $T = 1$ (in liability units), $V_{g} = 0.05$, $V_{e} = 0.05$, $V_{d} = 0.90$, and $r = \\frac{1}{6}$. Compute the post-canalization frequency of the extreme phenotype, $f' = f(r)$, as a decimal fraction. Round your answer to four significant figures. Do not report a percentage and do not include any units in your final answer.", "solution": "The problem as stated is scientifically sound, well-posed, and objective. It is based on the standard threshold model of quantitative genetics, which is a foundational concept in developmental and evolutionary biology. All necessary parameters and conditions are provided, and there are no contradictions or ambiguities. It is a formalizable problem directly relevant to the topics of developmental robustness and canalization. The provided numerical parameters are biologically plausible. Therefore, we may proceed with the solution.\n\n1) Derivation of the frequency of the extreme phenotype, $f$.\n\nThe liability $L$ is a random variable assumed to follow a Gaussian (normal) distribution, denoted as $L \\sim \\mathcal{N}(\\mu, V_{L})$, where $\\mu$ is the mean and $V_{L}$ is the total variance. The total variance is the sum of its components: $V_{L} = V_{g} + V_{e} + V_{d}$.\n\nThe extreme phenotype is expressed if and only if the liability $L$ exceeds a fixed threshold $T$. The frequency $f$ of this phenotype is therefore the probability of this event:\n$$f = P(L \\ge T)$$\nTo compute this probability, we standardize the random variable $L$ by transforming it into a standard normal variable $Z \\sim \\mathcal{N}(0, 1)$. The transformation is:\n$$Z = \\frac{L - \\mu}{\\sqrt{V_{L}}}$$\nApplying this transformation to the inequality $L \\ge T$, we obtain:\n$$\\frac{L - \\mu}{\\sqrt{V_{L}}} \\ge \\frac{T - \\mu}{\\sqrt{V_{L}}}$$\n$$Z \\ge \\frac{T - \\mu}{\\sqrt{V_{L}}}$$\nThe frequency $f$ is thus the probability that a standard normal variable $Z$ is greater than or equal to the value $\\frac{T - \\mu}{\\sqrt{V_{L}}}$. Let $\\Phi(z) = P(Z \\le z)$ be the cumulative distribution function (CDF) of the standard normal distribution. The probability of the upper tail is given by:\n$$f = P\\left(Z \\ge \\frac{T - \\mu}{\\sqrt{V_{L}}}\\right) = 1 - P\\left(Z < \\frac{T - \\mu}{\\sqrt{V_{L}}}\\right) = 1 - \\Phi\\left(\\frac{T - \\mu}{\\sqrt{V_{L}}}\\right)$$\nSubstituting the expression for the total variance $V_L$, we arrive at the final expression for the frequency $f$:\n$$f(\\mu, T, V_{g}, V_{e}, V_{d}) = 1 - \\Phi\\left(\\frac{T - \\mu}{\\sqrt{V_{g} + V_{e} + V_{d}}}\\right)$$\nThis expression can also be written using the symmetry property of the Gaussian distribution, $\\Phi(-z) = 1 - \\Phi(z)$, as:\n$$f(\\mu, T, V_{g}, V_{e}, V_{d}) = \\Phi\\left(-\\frac{T - \\mu}{\\sqrt{V_{g} + V_{e} + V_{d}}}\\right) = \\Phi\\left(\\frac{\\mu - T}{\\sqrt{V_{g} + V_{e} + V_{d}}}\\right)$$\n\n2) Analysis of canalization.\n\nUnder canalization, the developmental variance is reduced, $V_{d} \\mapsto rV_{d}$ with $0 < r < 1$. The mean $\\mu$ and threshold $T$ are fixed. The new total variance is $V_{L}' = V_{g} + V_{e} + rV_{d}$. The phenotype frequency becomes a function of $r$:\n$$f(r) = 1 - \\Phi\\left(\\frac{T - \\mu}{\\sqrt{V_{g} + V_{e} + rV_{d}}}\\right)$$\nTo determine how $f$ changes with $r$, we compute the derivative $\\frac{df}{dr}$. Let the argument of the CDF be $u(r)$:\n$$u(r) = \\frac{T - \\mu}{\\sqrt{V_{g} + V_{e} + rV_{d}}} = (T - \\mu)(V_{g} + V_{e} + rV_{d})^{-1/2}$$\nUsing the chain rule, the derivative of $f(r)$ is:\n$$\\frac{df}{dr} = \\frac{d}{dr} [1 - \\Phi(u(r))] = -\\frac{d\\Phi(u)}{du} \\frac{du}{dr}$$\nThe derivative of the standard normal CDF, $\\Phi(u)$, is the standard normal probability density function (PDF), $\\phi(u) = \\frac{1}{\\sqrt{2\\pi}} \\exp(-u^2/2)$. Thus, $\\frac{d\\Phi(u)}{du} = \\phi(u(r))$.\n$$\\frac{df}{dr} = -\\phi(u(r)) \\frac{du}{dr}$$\nNext, we compute $\\frac{du}{dr}$ using the power rule and chain rule:\n$$\\frac{du}{dr} = (T - \\mu) \\cdot \\left(-\\frac{1}{2}\\right) (V_{g} + V_{e} + rV_{d})^{-3/2} \\cdot \\frac{d}{dr}(V_{g} + V_{e} + rV_{d})$$\n$$\\frac{du}{dr} = (T - \\mu) \\cdot \\left(-\\frac{1}{2}\\right) (V_{g} + V_{e} + rV_{d})^{-3/2} \\cdot V_{d} = -\\frac{(T - \\mu)V_{d}}{2(V_{g} + V_{e} + rV_{d})^{3/2}}$$\nSubstituting this back into the expression for $\\frac{df}{dr}$:\n$$\\frac{df}{dr} = -\\phi(u(r)) \\left( -\\frac{(T - \\mu)V_{d}}{2(V_{g} + V_{e} + rV_{d})^{3/2}} \\right)$$\n$$\\frac{df}{dr} = \\frac{(T - \\mu)V_{d}}{2(V_{g} + V_{e} + rV_{d})^{3/2}} \\phi\\left(\\frac{T - \\mu}{\\sqrt{V_{g} + V_{e} + rV_{d}}}\\right)$$\nTo determine the sign of $\\frac{df}{dr}$, we analyze the sign of each term in the expression under the conditions $T > \\mu$ and $V_d > 0$:\n- The standard normal PDF $\\phi(z)$ is always positive for any real argument $z$.\n- The denominator $2(V_{g} + V_{e} + rV_{d})^{3/2}$ is positive, as variances ($V_g, V_e, V_d$) are non-negative, $V_d > 0$, and $r > 0$.\n- The term $V_d$ is given to be positive.\n- The term $T - \\mu$ is positive since we are given $T > \\mu$.\n\nEvery term in the expression for $\\frac{df}{dr}$ is positive. Therefore, $\\frac{df}{dr} > 0$.\nA positive derivative means that $f(r)$ is an increasing function of $r$. Canalization corresponds to a reduction in developmental variance, which means $r$ decreases (from its baseline value of $r=1$ towards $0$). Since $f$ increases with $r$, a decrease in $r$ must cause a decrease in $f$.\nConclusion: when the threshold $T$ is greater than the mean $\\mu$, reducing developmental variance via canalization decreases the frequency of the extreme phenotype. This is because variance reduction \"pulls in\" the tails of the distribution, reducing the probability mass beyond the threshold.\n\n3) Numerical calculation of post-canalization frequency.\n\nWe are given the parameters: $\\mu = 0$, $T = 1$, $V_{g} = 0.05$, $V_{e} = 0.05$, $V_{d} = 0.90$, and $r = \\frac{1}{6}$.\nThe post-canalization frequency $f'$ is given by $f(r)$:\n$$f' = 1 - \\Phi\\left(\\frac{T - \\mu}{\\sqrt{V_{g} + V_{e} + rV_{d}}}\\right)$$\nFirst, we compute the post-canalization total variance, $V_{L}'$:\n$$V_{L}' = V_{g} + V_{e} + rV_{d} = 0.05 + 0.05 + \\left(\\frac{1}{6}\\right)(0.90) = 0.10 + 0.15 = 0.25$$\nNow we compute the argument of the CDF:\n$$\\frac{T - \\mu}{\\sqrt{V_{L}'}} = \\frac{1 - 0}{\\sqrt{0.25}} = \\frac{1}{0.5} = 2$$\nThe frequency is therefore:\n$$f' = 1 - \\Phi(2)$$\nFrom standard statistical tables or computation, the value of the standard normal CDF at $z=2$ is $\\Phi(2) \\approx 0.977249868$.\n$$f' \\approx 1 - 0.977249868 = 0.022750132$$\nRounding this result to four significant figures gives:\n$$f' \\approx 0.02275$$", "answer": "$$\\boxed{0.02275}$$", "id": "2630509"}, {"introduction": "Theoretical concepts like plasticity and canalization come to life when we analyze experimental data. A crucial skill for an evolutionary developmental biologist is to interpret these results, which requires carefully distinguishing between changes in a trait's average value (the mean) and its variability (the variance). This practice challenges you to step into the role of a researcher interpreting a hypothetical but realistic dataset from experiments on insects. You will learn to dissect phenotypic variance into its underlying components and, most importantly, to distinguish phenotypic plasticity from canalization, reinforcing the key insight that a trait can be simultaneously plastic and robust. [@problem_id:2630559]", "problem": "A developmental biologist studies a quantitative trait $z$ in a holometabolous insect to understand developmental robustness, canalization, and phenotypic plasticity. The following fundamental bases are assumed: (i) the Central Dogma of molecular biology frames that genotype specifies regulatory networks that, through development, produce phenotype; (ii) phenotypic plasticity is defined as an environment-dependent change in the mean phenotype of a given genotype; (iii) canalization is defined as reduced phenotypic variance of a trait in the face of perturbations (genetic, environmental, or stochastic), holding the perturbation class explicit; (iv) total phenotypic variance within a fixed environment can be decomposed as $V_P = V_G + V_E$ for a panel of inbred genotypes, where $V_G$ is among-genotype variance and $V_E$ is within-genotype (microenvironmental and developmental noise) variance; (v) genotype-by-environment (GxE) interaction is present if reaction norm slopes differ among genotypes, contributing a $V_{G \\times E}$ term when environments vary.\n\nThe researcher performs two complementary experiments across two controlled larval environments $E_1$ and $E_2$ (e.g., nutrient-rich versus nutrient-poor), each held constant within itself.\n\nExperiment $1$ (clonal reaction norm for developmental noise): A single clonal line (genetically identical individuals) is reared with $n_{1} = 50$ individuals in $E_1$ and $n_{2} = 50$ individuals in $E_2$. Sample means are $\\bar{z}_{1} = 10.0$ and $\\bar{z}_{2} = 12.1$. Sample variances are $s_{1}^{2} = 1.00$ and $s_{2}^{2} = 0.98$.\n\nExperiment $2$ (genetic panel for among-genotype effects): A panel of $G = 20$ fully inbred genotypes is assayed with $n = 10$ replicate individuals per genotype per environment. For each environment, the estimated among-genotype variance and within-genotype variance are\n$$\nV_{G}(E_1) = 0.80,\\quad V_{E}(E_1) = 1.00;\\qquad V_{G}(E_2) = 0.78,\\quad V_{E}(E_2) = 1.02.\n$$\nGenotype-specific reaction norm slopes $\\beta_i = \\bar{z}_{i}(E_2) - \\bar{z}_{i}(E_1)$ have mean $\\bar{\\beta} = +2.1$ and variance $\\mathrm{Var}(\\beta) = 0.01$. The correlation of genotype means across environments is $r = 0.98$.\n\nAssume that sampling error at these magnitudes is negligible relative to the reported differences, and that $E_1$ and $E_2$ are the only manipulated environments. Based on these data and the definitions above, which statement is the most accurate inference about the trait’s developmental robustness and its evolutionary implications?\n\nA. The trait displays phenotypic plasticity in mean (nonzero reaction norm) while maintaining environmental and genetic canalization of variance (stable $V_{E}$ and $V_{G}$ across $E_1$ and $E_2$), with little genotype-by-environment interaction; there is no evidence that genetic assimilation has occurred.\n\nB. The trait is fully canalized because variance is stable; the observed mean shift does not constitute plasticity and thus reflects measurement drift rather than biology.\n\nC. The trait exhibits both plasticity and decanalization, because a change in mean necessarily indicates a breakdown of canalization; the constant variance estimates are uninformative about canalization.\n\nD. The constancy of variance across environments is diagnostic of genetic assimilation of the $E_2$ phenotype; selection has fixed the response, eliminating plasticity.\n\nE. The constant $V_{G}$ across environments reveals cryptic genetic variation that becomes exposed only in $E_2$; this is evidence that canalization is weak and $V_{G \\times E}$ is high.", "solution": "The problem statement must first be validated for scientific soundness, self-consistency, and clarity before any attempt at a solution.\n\n### Step 1: Extract Givens\n\nThe problem provides the following information:\n- A quantitative trait $z$ is studied in a holometabolous insect.\n- **Definitions**:\n    - (i) Genotype specifies regulatory networks, which produce phenotype through development.\n    - (ii) Phenotypic plasticity is an environment-dependent change in the mean phenotype of a given genotype.\n    - (iii) Canalization is reduced phenotypic variance of a trait in the face of perturbations, with the perturbation class specified.\n    - (iv) Total phenotypic variance in a fixed environment is $V_P = V_G + V_E$. $V_G$ is among-genotype variance. $V_E$ is within-genotype variance.\n    - (v) Genotype-by-environment (GxE) interaction, or $V_{G \\times E}$, exists if reaction norm slopes differ among genotypes.\n- **Experimental Setup**: Two controlled environments, $E_1$ and $E_2$.\n- **Experiment 1 (Single clonal line)**:\n    - Sample sizes: $n_{1} = 50$ in $E_1$, $n_{2} = 50$ in $E_2$.\n    - Sample means: $\\bar{z}_{1} = 10.0$, $\\bar{z}_{2} = 12.1$.\n    - Sample variances: $s_{1}^{2} = 1.00$, $s_{2}^{2} = 0.98$.\n- **Experiment 2 (Genetic panel)**:\n    - Panel size: $G = 20$ inbred genotypes.\n    - Replicates per genotype per environment: $n = 10$.\n    - Variance components in $E_1$: $V_{G}(E_1) = 0.80$, $V_{E}(E_1) = 1.00$.\n    - Variance components in $E_2$: $V_{G}(E_2) = 0.78$, $V_{E}(E_2) = 1.02$.\n    - Reaction norm slopes $\\beta_i = \\bar{z}_{i}(E_2) - \\bar{z}_{i}(E_1)$: mean $\\bar{\\beta} = +2.1$, variance $\\mathrm{Var}(\\beta) = 0.01$.\n    - Correlation of genotype means across environments: $r = 0.98$.\n- **Assumptions**: Sampling error is negligible.\n\n### Step 2: Validate Using Extracted Givens\n\nThe problem statement is evaluated against standard criteria for scientific validity.\n- **Scientifically Grounded**: The problem is well-grounded in the principles of quantitative genetics and developmental evolutionary biology. The definitions provided for phenotypic plasticity, canalization, variance decomposition, and GxE interaction are standard and correct. The experimental design (clonal lines, panels of inbred lines) is a classic approach to dissecting these phenomena.\n- **Well-Posed**: The problem is well-posed. It provides clear definitions, quantitative data from two complementary experiments, and asks for the most accurate inference based on this evidence. The assumption to neglect sampling error removes ambiguity in interpreting the small differences in variance, making the problem solvable on a conceptual level.\n- **Objective**: The language is precise and uses established scientific terminology.\n- **Internal Consistency**: The data provided are mutually consistent. For instance, the mean change in phenotype in Experiment 1 ($12.1 - 10.0 = 2.1$) is consistent with the mean reaction norm slope found in Experiment 2 ($\\bar{\\beta} = 2.1$). The within-genotype variance from Experiment 1 ($s^2 \\approx 1.0$) is consistent with the average within-genotype variance from Experiment 2 ($V_E \\approx 1.0$).\n- **Realism**: The numerical values for means, variances, and correlations are plausible for a quantitative trait in an insect.\n\n### Step 3: Verdict and Action\n\nThe problem is valid. It is a well-posed, scientifically sound exercise in interpreting quantitative genetic data. I will proceed with the analysis.\n\n### Solution Derivation\n\nThe analysis must systematically evaluate the evidence for plasticity, canalization, GxE interaction, and genetic assimilation based on the provided definitions and data.\n\n1.  **Phenotypic Plasticity**: Per definition (ii), plasticity is a change in the mean phenotype due to the environment.\n    - Experiment 1: A single genotype's mean phenotype changes from $\\bar{z}_{1} = 10.0$ in $E_1$ to $\\bar{z}_{2} = 12.1$ in $E_2$. This is a clear demonstration of plasticity.\n    - Experiment 2: The average reaction norm slope across $20$ genotypes is $\\bar{\\beta} = +2.1$, which is a statistically significant change (as we assume sampling error is negligible) and corroborates the result from Experiment 1.\n    - Conclusion: The trait exhibits substantial phenotypic plasticity.\n\n2.  **Canalization**: Per definition (iii), canalization is the stability of phenotypic variance against perturbations. We examine stability against two perturbation types: micro-environmental/stochastic noise and genetic variation, both across the macro-environments $E_1$ and $E_2$.\n    - **Canalization against micro-environmental and stochastic perturbations (Developmental Noise)**: This is measured by the within-genotype variance, $V_E$. In Experiment 2, $V_{E}(E_1) = 1.00$ and $V_{E}(E_2) = 1.02$. These values are nearly identical. Experiment 1 yields a similar result for a single clone: $s_{1}^{2} = 1.00$ and $s_{2}^{2} = 0.98$. This indicates that the developmental system's buffering capacity against random noise is stable across the two macro-environments $E_1$ and $E_2$. This is a form of environmental canalization.\n    - **Canalization of the expression of genetic variation**: This refers to how the phenotypic variance caused by genetic differences among individuals ($V_G$) changes across environments. In Experiment 2, $V_{G}(E_1) = 0.80$ and $V_{G}(E_2) = 0.78$. These values are also nearly identical. This means that the amount of phenotypic variation contributed by standing genetic variation is stable across $E_1$ and $E_2$. The environment does not amplify or suppress the expression of this genetic variance.\n    - Conclusion: The trait is highly canalized, both in terms of buffering developmental noise ($V_E$) and in the expression of standing genetic variation ($V_G$). The system is robust to perturbation.\n\n3.  **Genotype-by-Environment (GxE) Interaction**: Per definition (v), GxE interaction exists if reaction norm slopes differ among genotypes.\n    - The variance of the slopes is given as $\\mathrm{Var}(\\beta) = 0.01$. Since this variance is non-zero, some GxE interaction is present.\n    - However, the magnitude is very small. Critically, the correlation of genotype means across environments is $r = 0.98$. A correlation this close to $1.0$ indicates that a genotype with a high phenotypic value in $E_1$ will almost certainly have a high phenotypic value in $E_2$. The rank order of genotypes is highly preserved. This, combined with the small variance in slopes, signifies that the GxE interaction is minor. The reaction norms are largely parallel.\n\n4.  **Genetic Assimilation**: Genetic assimilation is an evolutionary process where an environmentally induced phenotype becomes genetically fixed and is expressed even without the environmental trigger.\n    - The data show a plastic response: the phenotype is $10.0$ in $E_1$ and $12.1$ in $E_2$. If the phenotype of $E_2$ had been genetically assimilated, individuals would express a phenotype near $12.1$ even when reared in $E_1$. This is not observed.\n    - Conclusion: The trait remains plastic; there is no evidence that genetic assimilation has occurred.\n\n### Option-by-Option Analysis\n\n**A. The trait displays phenotypic plasticity in mean (nonzero reaction norm) while maintaining environmental and genetic canalization of variance (stable $V_{E}$ and $V_{G}$ across $E_1$ and $E_2$), with little genotype-by-environment interaction; there is no evidence that genetic assimilation has occurred.**\n- This statement accurately summarizes all points derived from the data. The trait is plastic ($\\bar{z}$ changes), it is canalized ($V_E$ and $V_G$ are stable), the GxE interaction is small ($r \\approx 1$, $\\mathrm{Var}(\\beta)$ is low), and genetic assimilation has not occurred (plasticity is retained).\n- **Verdict: Correct.**\n\n**B. The trait is fully canalized because variance is stable; the observed mean shift does not constitute plasticity and thus reflects measurement drift rather than biology.**\n- This statement makes two false claims. First, it incorrectly asserts that a mean shift is not plasticity, which contradicts the problem's explicit definition (ii). Second, it dismisses the data as \"measurement drift\" without basis, violating the premise of the problem which is to provide a biological interpretation. Canalization of variance and plasticity of the mean are not mutually exclusive.\n- **Verdict: Incorrect.**\n\n**C. The trait exhibits both plasticity and decanalization, because a change in mean necessarily indicates a breakdown of canalization; the constant variance estimates are uninformative about canalization.**\n- This statement rests on a fundamental misunderstanding. It falsely equates plasticity (a change in mean) with decanalization (a change in variance). As the data show, a trait can be both plastic and canalized. The claim that constant variance is \"uninformative\" about canalization is absurd, as stable variance is the very definition of canalization.\n- **Verdict: Incorrect.**\n\n**D. The constancy of variance across environments is diagnostic of genetic assimilation of the $E_2$ phenotype; selection has fixed the response, eliminating plasticity.**\n- This statement misinterprets genetic assimilation. Genetic assimilation leads to a loss of plasticity, meaning the phenotype becomes fixed and no longer responds to the environment. The data clearly show plasticity persists. The constancy of variance is evidence for canalization, not assimilation.\n- **Verdict: Incorrect.**\n\n**E. The constant $V_{G}$ across environments reveals cryptic genetic variation that becomes exposed only in $E_2$; this is evidence that canalization is weak and $V_{G \\times E}$ is high.**\n- This statement is a collection of falsehoods. The exposure of cryptic genetic variation would manifest as an *increase* in $V_G$ in the novel environment, not constancy. The data show $V_G$ is constant ($0.80$ vs $0.78$). The constancy of variances ($V_G$ and $V_E$) is evidence of *strong* canalization, not weak canalization. A high correlation ($r=0.98$) and low $\\mathrm{Var}(\\beta)$ indicate that $V_{G \\times E}$ is *low*, not high. The statement contradicts the data on every point.\n- **Verdict: Incorrect.**", "answer": "$$\\boxed{A}$$", "id": "2630559"}, {"introduction": "Genetic assimilation is the landmark evolutionary process where a trait, initially produced only in response to an environmental stimulus, becomes genetically encoded and constitutively expressed. To grasp the dynamics of this transformation, we must move beyond static snapshots and model the population-level processes over evolutionary time. This final hands-on practice guides you through the construction of a population-genetic simulation based on the foundational Wright-Fisher model to track the sequential fixation of alleles. By building and running this simulation, you will develop a powerful, dynamic intuition for the timescales of evolution and see firsthand how population size, mutation rate, and selection pressure interact to determine how quickly a plastic response can become a fixed, assimilated trait. [@problem_id:2630570]", "problem": "A research group is studying genetic assimilation in a population with developmental robustness and canalization. To make the investigation fully quantitative and testable, consider the following stylized but scientifically grounded population-genetic model.\n\nDefinitions and assumptions:\n- The population is haploid, panmictic, with constant census size $N$ and non-overlapping generations.\n- Individuals are characterized by a single evolving genetic contribution to a trait that must reach a genetic threshold $T$ to be considered assimilated. The genetic contribution increases in increments of size $a$ each time a distinct beneficial allele fixes, and the alleles act additively and independently on the threshold scale. Assimilation is declared once $m = \\lceil T / a \\rceil$ sequential beneficial fixations have occurred.\n- In each fixation step, a single biallelic locus segregates with wildtype and derived alleles. The derived allele confers a multiplicative fitness advantage $1 + s$ over wildtype, where $s = k \\cdot a$ combines a selection intensity $k$ on the trait with effect size $a$.\n- New derived alleles arise by forward mutation from wildtype with per-individual, per-generation rate $\\mu$. Back mutation is negligible on the timescale of interest and is ignored.\n- Evolution follows a discrete-time Wright–Fisher process with selection and mutation:\n  - If $i_t$ is the number of derived alleles at generation $t$, the probability that a randomly sampled parent is derived is\n    $$ p^{(\\mathrm{sel})}_t = \\frac{i_t \\cdot (1 + s)}{i_t \\cdot (1 + s) + (N - i_t)} \\quad \\text{for} \\quad i_t \\in \\{0,1,\\dots,N\\}. $$\n  - The number of derived offspring after selection is a binomial random variable $I'_t \\sim \\mathrm{Binomial}(N, p^{(\\mathrm{sel})}_t)$.\n  - New derived mutants arise among the $N - I'_t$ wildtype offspring with $M_t \\sim \\mathrm{Binomial}(N - I'_t, \\mu)$, and the new count is $i_{t+1} = I'_t + M_t$.\n- At the start of each step, the population is monomorphic for wildtype at the segregating locus, $i_0 = 0$. Upon fixation of the derived allele ($i_t = N$), that step contributes its increment $a$ to the genetic threshold tally, the segregating locus is considered resolved, and the next step begins at $i_0 = 0$ for a new locus with the same parameters $(N, \\mu, s)$.\n\nTask:\n- Implement a program that simulates the above process exactly as specified for each independent step until $\\lceil T / a \\rceil$ fixations have occurred, and returns the total number of generations elapsed (assimilation time) for each provided parameter set.\n- Use a pseudorandom number generator with fixed seed $12345$ for reproducibility.\n\nFoundational base to use:\n- The Wright–Fisher sampling framework for haploid selection and mutation as defined above.\n- The concept of genetic assimilation as the accumulation of sufficient genetic effect to reach a functional threshold in the absence of the original environmental inducer.\n\nScientific realism requirements:\n- All parameters must be biologically plausible and internally consistent, with $N$ a positive integer, $\\mu \\in (0,1)$, $a > 0$, $k > 0$, and $T > 0$.\n- The simulation must adhere to the mechanistic definitions above without shortcut formulas.\n\nNumerical output and units:\n- Report assimilation time in units of generations as an integer for each test case.\n\nTest suite:\nFor each of the following parameter sets $(N, \\mu, a, k, T)$, run a single simulation replicate and record the assimilation time.\n1. $(N, \\mu, a, k, T) = (2000, 10^{-4}, 0.05, 0.2, 0.20)$\n2. $(N, \\mu, a, k, T) = (2000, 5 \\cdot 10^{-4}, 0.05, 0.2, 0.20)$\n3. $(N, \\mu, a, k, T) = (2000, 10^{-4}, 0.10, 0.2, 0.20)$\n4. $(N, \\mu, a, k, T) = (2000, 10^{-5}, 0.05, 0.2, 0.20)$\n\nRequired final output format:\n- Your program should produce a single line of output containing the assimilation times for the four test cases as a comma-separated list of integers enclosed in square brackets (e.g., \"[t1,t2,t3,t4]\").", "solution": "The problem is subjected to validation.\n\nGivens are extracted verbatim:\n- Population: haploid, panmictic, constant census size $N$, non-overlapping generations.\n- Trait assimilation: requires reaching a genetic threshold $T$. Genetic contribution increases by increments of size $a$ per beneficial allele fixation. Assimilation is achieved after $m = \\lceil T / a \\rceil$ sequential fixations. Alleles are additive and independent.\n- Fixation step dynamics: A single biallelic locus segregates. The derived allele has a multiplicative fitness advantage $1 + s$, where $s = k \\cdot a$. The forward mutation rate is $\\mu$. Back mutation is ignored.\n- Evolutionary process: A discrete-time Wright–Fisher model with selection and mutation.\n    - $i_t$ is the number of derived alleles at generation $t$.\n    - Selection probability: $p^{(\\mathrm{sel})}_t = \\frac{i_t \\cdot (1 + s)}{i_t \\cdot (1 + s) + (N - i_t)}$.\n    - Post-selection count: $I'_t \\sim \\mathrm{Binomial}(N, p^{(\\mathrm{sel})}_t)$.\n    - New mutants: $M_t \\sim \\mathrm{Binomial}(N - I'_t, \\mu)$.\n    - Next generation count: $i_{t+1} = I'_t + M_t$.\n- Simulation protocol: Each fixation step starts with $i_0 = 0$ and ends upon fixation ($i_t = N$). The total assimilation time is the sum of generations over all $m$ steps.\n- Task: Simulate the process for given parameter sets, using a pseudorandom number generator with seed $12345$, and report the total assimilation time in generations.\n- Parameter validity: $N > 0$ (integer), $\\mu \\in (0,1)$, $a > 0$, $k > 0$, $T > 0$.\n- Test suite:\n    1. $(N, \\mu, a, k, T) = (2000, 10^{-4}, 0.05, 0.2, 0.20)$\n    2. $(N, \\mu, a, k, T) = (2000, 5 \\cdot 10^{-4}, 0.05, 0.2, 0.20)$\n    3. $(N, \\mu, a, k, T) = (2000, 10^{-4}, 0.10, 0.2, 0.20)$\n    4. $(N, \\mu, a, k, T) = (2000, 10^{-5}, 0.05, 0.2, 0.20)$\n\nValidation assessment:\nThe problem is scientifically grounded, leveraging the standard Wright–Fisher model, a cornerstone of population genetics. The formalization of genetic assimilation as a threshold-crossing process via sequential fixations is a valid and common approach in theoretical evolutionary biology. All parameters are specified, and the dynamical equations are unambiguous, making the problem well-posed. The parameters provided in the test suite are within biologically plausible ranges. The problem is objective and contains no logical contradictions or missing information. It requires a direct simulation, which is a standard method for studying such stochastic processes.\n\nVerdict: The problem is valid. A solution will be provided.\n\nThe problem requires a direct simulation of a population genetics model to determine the time to genetic assimilation. This total time is the sum of times for a series of sequential fixation events. The overall algorithm is structured as a nested loop.\n\nFirst, for each test case defined by the parameters $(N, \\mu, a, k, T)$, we must compute two key derived parameters:\n1. The selection coefficient, $s$, which quantifies the fitness advantage of the derived allele. It is given by $s = k \\cdot a$.\n2. The number of required fixations, $m$, for assimilation to occur. This is calculated as $m = \\lceil T / a \\rceil$, which is the smallest integer greater than or equal to the ratio of the total threshold $T$ to the per-fixation effect size $a$.\n\nThe main simulation consists of an outer loop that iterates $m$ times, with each iteration representing one complete fixation event at a new genetic locus. A running total of elapsed generations is maintained.\n\nInside this outer loop, a second, inner loop simulates the dynamics of a single fixation event on a generation-by-generation basis. This inner loop models the change in the number of individuals carrying the derived allele, denoted by $i_t$ at generation $t$, within the population of size $N$. The simulation for one fixation event proceeds as follows:\n- Initialization: The process starts with a population monomorphic for the wild-type allele, so the initial count of the derived allele is $i_0 = 0$. A generation counter for this specific fixation event is also initialized to $0$.\n- Generational updates: The simulation proceeds in discrete time steps, each representing one generation, until the derived allele has fixed in the population (i.e., $i_t = N$). Within each generation $t$:\n    1. Selection: The frequency of the derived allele changes due to selection. The probability of sampling a derived allele for the next generation's parent pool is calculated as $p^{(\\mathrm{sel})}_t = \\frac{i_t (1+s)}{i_t(1+s) + (N-i_t)}$. If $i_t=0$, this probability is $0$.\n    2. Genetic Drift: The number of derived individuals in the subsequent generation, before mutation, is determined by binomial sampling, which models random genetic drift. This count, $I'_t$, is a random variable drawn from a binomial distribution: $I'_t \\sim \\mathrm{Binomial}(N, p^{(\\mathrm{sel})}_t)$.\n    3. Mutation: New derived alleles arise from the $N - I'_t$ wild-type individuals. The number of new mutants, $M_t$, is also a random variable drawn from a binomial distribution: $M_t \\sim \\mathrm{Binomial}(N - I'_t, \\mu)$.\n    4. Update: The count of the derived allele for the next generation is the sum of those surviving from the parent generation and the new mutants: $i_{t+1} = I'_t + M_t$.\n    5. The generation counter for the current fixation event is incremented.\n\nThis inner loop continues until the condition $i_t = N$ is met. Upon fixation, the number of generations elapsed for this single event is added to the total assimilation time. The outer loop then proceeds to the next fixation event, resetting the state to $i_0 = 0$ for a new locus.\n\nAfter $m$ such fixation events are simulated, the accumulated total generation count is the assimilation time for that specific parameter set. This entire procedure is repeated for each of the four test cases. To ensure reproducibility of the stochastic simulation, a pseudorandom number generator must be initialized with the fixed seed $12345$.", "answer": "[13184,3346,3124,103521]", "id": "2630570"}]}