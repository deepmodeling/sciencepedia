{"hands_on_practices": [{"introduction": "In stem cell biology, abstract concepts like multipotency and self-renewal must be translated into concrete, measurable criteria. The serial transplantation assay is the gold-standard functional test for hematopoietic stem cells (HSCs), where their ability to reconstitute multiple blood lineages in a primary recipient demonstrates multipotency, and the ability to repeat this feat upon transfer to a secondary recipient demonstrates self-renewal. This exercise [@problem_id:2675589] challenges you to act as an experimentalist by applying a precise quantitative protocol to a set of lineage contribution data, allowing you to make a definitive conclusion about whether a candidate cell population meets the functional definition of an HSC.", "problem": "A research group is prospectively isolating candidate Hematopoietic Stem Cells (HSCs) from adult mouse bone marrow and testing their function by serial transplantation. The functional base definitions they adopt are as follows: multipotency is operationally defined as long-term multilineage reconstitution in primary recipients, specifically donor-derived myeloid, B-lymphoid, and T-lymphoid chimerism each at or above a fixed threshold at a late timepoint; self-renewal is defined as the maintenance of such multilineage reconstitution upon secondary transplantation from primary recipients. All lineage contributions are quantified as donor fractions (chimerism) in peripheral blood at week 16 post-transplant. \n\nTo formalize the decision, define the following thresholds and decision rule grounded in these functional definitions:\n- A primary recipient is counted as multilineage reconstituted (multipotent output) if donor-derived myeloid, B, and T chimerism are each $\\geq 0.01$ at week 16.\n- A secondary recipient is counted as multilineage reconstituted if donor-derived myeloid, B, and T chimerism are each $\\geq 0.01$ at week 16.\n- Let $f_{\\text{primary}}$ be the fraction of all primary recipients that meet the multilineage criterion, and let $f_{\\text{secondary}}$ be the fraction of all secondary recipients derived from the multilineage primary recipients that meet the multilineage criterion.\n- The candidate HSC population is considered to meet the prespecified functional thresholds if $f_{\\text{primary}} \\geq 0.75$ and $f_{\\text{secondary}} \\geq 0.50$.\n\nYou are given the following donor chimerism data at week 16 (values are decimals):\n\nPrimary recipients (each received the same dose of candidate HSCs):\n- $P1$: myeloid $0.12$, B $0.08$, T $0.04$.\n- $P2$: myeloid $0.02$, B $0.009$, T $0.015$.\n- $P3$: myeloid $0.06$, B $0.05$, T $0.03$.\n- $P4$: myeloid $0.011$, B $0.013$, T $0.012$.\n\nFor each primary recipient that qualifies as multilineage at week 16, two secondary recipients were transplanted with equal aliquots of its bone marrow and assayed at week 16:\n\nFrom $P1$:\n- $S11$: myeloid $0.02$, B $0.015$, T $0.006$.\n- $S12$: myeloid $0.017$, B $0.012$, T $0.011$.\n\nFrom $P3$:\n- $S31$: myeloid $0.018$, B $0.014$, T $0.013$.\n- $S32$: myeloid $0.019$, B $0.016$, T $0.004$.\n\nFrom $P4$:\n- $S41$: myeloid $0.012$, B $0.010$, T $0.010$.\n- $S42$: myeloid $0.009$, B $0.008$, T $0.011$.\n\nDefine the binary decision variable $X$ to be $1$ if the candidate HSC population meets both the multipotency and self-renewal thresholds as specified above, and $0$ otherwise. Compute $X$. No rounding is required. Report $X$ as a pure number with no units.", "solution": "The problem presents a well-posed quantitative task grounded in the principles of experimental hematology. It requires the evaluation of a candidate Hematopoietic Stem Cell (HSC) population based on a two-tiered functional assay: multilineage reconstitution in primary recipients, followed by serial transplantation to assess self-renewal. The final decision is formalized as a binary variable, $X$, which we must compute. The problem statement is scientifically sound, internally consistent, and complete. We proceed with the solution.\n\nThe analysis is executed in three mandatory steps: first, the evaluation of primary recipients to determine the multipotency fraction, $f_{\\text{primary}}$; second, the evaluation of secondary recipients to determine the self-renewal fraction, $f_{\\text{secondary}}$; third, the application of the final decision rule to compute $X$.\n\nStep 1: Evaluation of Primary Recipients\n\nThe problem states there are $4$ primary recipients, denoted $P1$, $P2$, $P3$, and $P4$. A primary recipient is considered to have multilineage reconstitution if its donor-derived chimerism for myeloid, B-lymphoid, and T-lymphoid lineages is each greater than or equal to the threshold of $0.01$ at week 16. Let $C_M$, $C_B$, and $C_T$ represent the chimerism values for myeloid, B, and T lineages, respectively. The condition for a successful primary recipient is the logical AND proposition: $ (C_M \\geq 0.01) \\land (C_B \\geq 0.01) \\land (C_T \\geq 0.01) $.\n\nWe apply this criterion to each of the $4$ primary recipients:\n- For recipient $P1$: $C_M = 0.12$, $C_B = 0.08$, $C_T = 0.04$. All three values are $\\geq 0.01$. Thus, $P1$ meets the criterion.\n- For recipient $P2$: $C_M = 0.02$, $C_B = 0.009$, $C_T = 0.015$. The B-lymphoid chimerism $C_B = 0.009$ is less than $0.01$. Thus, $P2$ fails to meet the criterion.\n- For recipient $P3$: $C_M = 0.06$, $C_B = 0.05$, $C_T = 0.03$. All three values are $\\geq 0.01$. Thus, $P3$ meets the criterion.\n- For recipient $P4$: $C_M = 0.011$, $C_B = 0.013$, $C_T = 0.012$. All three values are $\\geq 0.01$. Thus, $P4$ meets the criterion.\n\nThe number of primary recipients meeting the multilineage criterion is $3$ (namely, $P1$, $P3$, and $P4$). The total number of primary recipients is $4$. The fraction $f_{\\text{primary}}$ is therefore:\n$$f_{\\text{primary}} = \\frac{\\text{Number of multilineage primary recipients}}{\\text{Total number of primary recipients}} = \\frac{3}{4} = 0.75$$\n\nThe first condition for the cell population to pass is $f_{\\text{primary}} \\geq 0.75$. Since our calculated value is $f_{\\text{primary}} = 0.75$, this condition is met: $0.75 \\geq 0.75$.\n\nStep 2: Evaluation of Secondary Recipients\n\nThe problem specifies that secondary recipients are transplanted using bone marrow from primary recipients that qualified as multilineage. In our case, these are $P1$, $P3$, and $P4$. For each of these $3$ successful primary recipients, $2$ secondary recipients were generated. Therefore, the total number of secondary recipients to be evaluated is $3 \\times 2 = 6$. These recipients are $S11, S12$ (from $P1$), $S31, S32$ (from $P3$), and $S41, S42$ (from $P4$).\n\nThe criterion for multilineage reconstitution in secondary recipients is identical to that for primary recipients: $ (C_M \\geq 0.01) \\land (C_B \\geq 0.01) \\land (C_T \\geq 0.01) $. We apply this criterion to each of the $6$ secondary recipients:\n- From $P1$:\n  - $S11$: $C_M = 0.02$, $C_B = 0.015$, $C_T = 0.006$. Fails, as $C_T  0.01$.\n  - $S12$: $C_M = 0.017$, $C_B = 0.012$, $C_T = 0.011$. Meets criterion.\n- From $P3$:\n  - $S31$: $C_M = 0.018$, $C_B = 0.014$, $C_T = 0.013$. Meets criterion.\n  - $S32$: $C_M = 0.019$, $C_B = 0.016$, $C_T = 0.004$. Fails, as $C_T  0.01$.\n- From $P4$:\n  - $S41$: $C_M = 0.012$, $C_B = 0.010$, $C_T = 0.010$. Meets criterion.\n  - $S42$: $C_M = 0.009$, $C_B = 0.008$, $C_T = 0.011$. Fails, as $C_M  0.01$ and $C_B  0.01$.\n\nThe number of secondary recipients meeting the multilineage criterion is $3$ (namely, $S12$, $S31$, and $S41$). The total number of secondary recipients assayed is $6$. The fraction $f_{\\text{secondary}}$ is therefore:\n$$f_{\\text{secondary}} = \\frac{\\text{Number of multilineage secondary recipients}}{\\text{Total number of secondary recipients}} = \\frac{3}{6} = 0.50$$\n\nThe second condition for the cell population to pass is $f_{\\text{secondary}} \\geq 0.50$. Since our calculated value is $f_{\\text{secondary}} = 0.50$, this condition is also met: $0.50 \\geq 0.50$.\n\nStep 3: Final Decision for Variable $X$\n\nThe decision variable $X$ is defined to be $1$ if and only if both functional thresholds are met simultaneously. The conditions are:\n1. $f_{\\text{primary}} \\geq 0.75$\n2. $f_{\\text{secondary}} \\geq 0.50$\n\nFrom our analysis, the first condition is met ($0.75 \\geq 0.75$) and the second condition is met ($0.50 \\geq 0.50$). Since both parts of the logical conjunction are true, the candidate HSC population is considered to meet the prespecified functional thresholds.\n\nTherefore, the value of the binary decision variable $X$ is $1$.", "answer": "$$\\boxed{1}$$", "id": "2675589"}, {"introduction": "While pluripotency is rigorously tested with assays like chimera formation, proving totipotency—the ability of a single cell to form a complete organism—requires an even more stringent experimental design. A central challenge is to assess the developmental fate of a cell within its natural, undisturbed embryonic context. This problem [@problem_id:2675602] asks you to evaluate several proposed experimental strategies and select the one that most faithfully operationalizes the definition of totipotency, emphasizing the critical importance of direct lineage tracing and non-perturbing methods to distinguish a cell's true potential from its capacity to regulate after injury.", "problem": "A developmental biology lab wishes to determine the fraction, denoted $p$, of mouse 2-cell blastomeres that are individually totipotent under normal, unmanipulated development. Totipotency is defined here from first principles as the capacity of a single cell to generate all embryonic and extraembryonic lineages necessary for development to term. In the early mouse conceptus, the first lineage bifurcations yield trophectoderm, inner cell mass epiblast, and primitive endoderm; thus, an operational in vivo readout consistent with totipotency is the observation that the clonal progeny of a single 2-cell blastomere populate all three peri-implantation compartments (trophectoderm, epiblast, and primitive endoderm) and later both embryonic and extraembryonic tissues (for example, embryo proper and placenta), without perturbing the embryo’s normal development. The lab’s constraints are that the assay must preserve normal development in situ (no blastomere separation or rescue by exogenous supports), must be a direct lineage-tracing readout (not only predictive transcriptomic states), and must yield an unbiased estimator $\\hat{p}$ across many embryos.\n\nConsider the following candidate experimental designs. Which one best satisfies these constraints and produces a rigorous, unbiased estimate of $p$?\n\nA. Generate mice carrying a ubiquitous Cre-dependent reporter (for example, Rosa$26$-loxP-STOP-loxP-tdTomato). Inject zygotes with messenger ribonucleic acid encoding a photoactivatable Cre recombinase (PA-Cre), allow development to the 2-cell stage, and photoactivate Cre specifically in a single blastomere with confined illumination (for example, 405 nm through a pinhole). Transfer embryos to pseudopregnant recipients for normal development. At peri-implantation (E4.5) and post-implantation stages (for example, E6.5 and E10.5), assay permanently labeled clonal progeny by immunostaining for lineage markers (for example, Cdx$2$ for trophectoderm, Nanog or Sox$2$ for epiblast, Gata$6$ or Sox$17$ for primitive endoderm; trophoblast markers and embryo proper at later stages). Score a blastomere as totipotent-like if labeled progeny are detected in all three peri-implantation lineages and in both embryonic and extraembryonic compartments later, with embryo morphology and viability normal. Across $N$ embryos in which exactly one 2-cell blastomere is labeled, compute $\\hat{p} = k/N$, where $k$ is the count that meet the scoring criteria. Include controls for labeling specificity (exclude embryos with both blastomeres labeled), recombination efficiency, and phototoxicity.\n\nB. At the 2-cell stage, mechanically separate sister blastomeres and culture each in isolation to the blastocyst stage before transfer to surrogate mothers. Quantify the proportion that reach term and infer this as the proportion of individually totipotent 2-cell blastomeres under normal development.\n\nC. Microinject green fluorescent protein messenger ribonucleic acid into zygotes so that both blastomeres and their progeny express green fluorescent protein uniformly. Track the spatial distribution of labeled cells at E4.5 and E6.5 to infer whether each blastomere is totipotent based on overall pattern symmetry.\n\nD. Aggregate a single labeled 2-cell blastomere with a tetraploid host embryo, transfer to recipients, and assess whether labeled cells contribute to embryo proper, using the tetraploid cells to form extraembryonic tissues. Estimate $p$ from the fraction that make embryo proper, because extraembryonic tissues will be provided by the host.\n\nE. Perform single-cell ribonucleic acid sequencing on 2-cell blastomeres, compute a totipotency score by comparing to transcriptomic signatures of zygote and totipotent-like cells, and estimate $p$ as the fraction exceeding a predetermined threshold. Validate on a small subset with immunostaining at E4.5.\n\nChoose the option that best operationalizes the definition of totipotency under normal development, uses direct lineage tracing, and yields an unbiased estimate of $p$ with appropriate controls. Only one option is best.", "solution": "The problem statement is scientifically and logically valid. It poses a well-defined question in developmental biology and provides a clear set of constraints for evaluating potential experimental designs. The goal is to determine the fraction, $p$, of blastomeres at the 2-cell stage of mouse development that are totipotent. The provided definition of totipotency—the ability of a single cell to generate all embryonic and extraembryonic lineages in the course of normal development—is a rigorous, first-principles definition. The constraints for the experimental assay are also explicit and critical for a correct interpretation of the results: ($1$) preservation of normal development *in situ*, ($2$) use of a direct lineage-tracing readout, and ($3$) generation of an unbiased estimator $\\hat{p}$.\n\nWe will now evaluate each proposed experimental design against these foundational requirements.\n\n**Analysis of Option A**\n\nThis protocol proposes the use of a photoactivatable Cre recombinase ($PA-Cre$) system to induce a permanent genetic label (e.g., tdTomato expression) in a single, targeted blastomere of an intact 2-cell embryo. The development of the embryo proceeds *in situ* following uterine transfer. The fates of the clone of cells derived from the single labeled blastomere are then directly visualized at subsequent developmental stages (e.g., peri-implantation at E4.5, post-implantation at E6.5 and E10.5). A blastomere is scored as operationally totipotent if its labeled progeny are found in all three primary lineages (trophectoderm, epiblast, primitive endoderm) and subsequently in both embryonic and extraembryonic tissues, consistent with the problem's definition.\n\n- **Preservation of Normal Development:** The method is minimally invasive. A focused pulse of light (405 nm) is used to activate Cre recombinase in a very small volume. The embryo's architecture is undisturbed, satisfying the *in situ* requirement. The proposal correctly includes controls for phototoxicity to ensure the labeling procedure itself does not perturb normal developmental processes.\n- **Direct Lineage Tracing:** The use of Cre/lox-based genetic recombination creates a permanent, heritable mark in the target cell and all of its descendants. This is the gold standard for direct lineage tracing. The readout is not an inference based on transient markers or transcriptomic profiles, but a direct observation of cell fate.\n- **Unbiased Estimator:** By analyzing a large number of embryos ($N$) and counting the number of cases ($k$) where the clonal progeny of a single labeled blastomere meet the criteria for totipotency, one can compute the fraction $\\hat{p} = k/N$. Assuming proper controls for labeling efficiency and specificity (e.g., excluding embryos where both blastomeres were accidentally labeled), this method provides a direct, quantitative, and statistically robust estimate of $p$.\n\nThis design flawlessly adheres to all stated constraints and directly tests the hypothesis using a rigorous and appropriate methodology. Therefore, it is a strong candidate.\n\n**Verdict for Option A:** **Correct**.\n\n**Analysis of Option B**\n\nThis protocol involves mechanically separating the two sister blastomeres at the 2-cell stage and assessing their individual capacity to develop to term after being cultured in isolation and transferred to surrogate mothers.\n\n- **Preservation of Normal Development:** This design fundamentally violates the central constraint of preserving normal development *in situ*. The problem explicitly forbids \"blastomere separation\". The physical isolation of a blastomere is a profound perturbation. The subsequent development demonstrates the cell's *regulative capacity* in an artificial context, not its actual fate contribution within an intact, unmanipulated embryo. This experiment answers a different question, related to developmental potential upon injury or dissociation, not totipotency during normal ontogeny.\n\n**Verdict for Option B:** **Incorrect**. It violates the primary constraint of non-perturbation and *in situ* analysis.\n\n**Analysis of Option C**\n\nThis protocol suggests microinjecting green fluorescent protein (GFP) messenger ribonucleic acid (mRNA) into the zygote and then observing the \"pattern symmetry\" of fluorescence at later stages to infer potency.\n\n- **Direct Lineage Tracing:** This method fails the direct lineage-tracing criterion. mRNA and the translated protein it produces are not permanently heritable genetic markers. They are diluted with each cell division. After a few divisions at the blastocyst stage (which contains $\\sim32-64$ cells), the GFP signal per cell would be significantly reduced and diffused, making it impossible to unambiguously assign a cell's origin to one of the two initial blastomeres. Furthermore, inferring lineage contribution from \"overall pattern symmetry\" is a subjective, qualitative, and unreliable method, not a rigorous scientific readout.\n\n**Verdict for Option C:** **Incorrect**. It does not employ a valid lineage-tracing technique.\n\n**Analysis of Option D**\n\nThis protocol describes the tetraploid complementation assay, where a single labeled blastomere is aggregated with a tetraploid host embryo. The rationale is that tetraploid cells preferentially form extraembryonic tissues, while the diploid test cell forms the embryo proper.\n\n- **Test of Totipotency vs. Pluripotency:** This assay is the established gold standard for testing *pluripotency*—the ability to form all tissues of the embryo proper. It does not test for *totipotency*. The definition of totipotency explicitly requires the capacity to generate *both* embryonic and *extraembryonic* lineages. The design of this assay intentionally bypasses the requirement for the test cell to form extraembryonic tissues by providing them via the tetraploid host.\n- **Preservation of Normal Development:** The creation of a chimeric embryo by aggregating a diploid cell with a tetraploid host is a highly artificial construct. It does not represent \"normal, unmanipulated development\" and falls under the category of \"rescue by exogenous supports,\" which is explicitly disallowed.\n\n**Verdict for Option D:** **Incorrect**. It tests for the wrong biological property (pluripotency, not totipotency) and violates the *in situ* development constraint.\n\n**Analysis of Option E**\n\nThis protocol proposes using single-cell ribonucleic acid sequencing (scRNA-seq) to profile the transcriptomes of individual blastomeres and then assign a \"totipotency score\" based on this data.\n\n- **Direct Lineage Tracing:** This method directly contradicts the constraint that the assay \"must be a direct lineage-tracing readout (not only predictive transcriptomic states).\" It is an indirect, correlational approach. It predicts potential based on a molecular signature; it does not observe the actual fate of the cell. The validity of the \"totipotency score\" is an assumption, not a direct measurement.\n- **Preservation of Normal Development:** The scRNA-seq procedure is terminal. The cell must be destroyed to extract its RNA. Therefore, one cannot follow the fate of the same cell that was analyzed, which violates the principle of observing development *in situ*.\n\n**Verdict for Option E:** **Incorrect**. It is an indirect, predictive method, not a direct lineage-tracing experiment as required.\n\n**Conclusion**\n\nUpon rigorous evaluation, only Option A satisfies all the critical constraints laid out in the problem statement. It provides a minimally invasive method to perform direct, permanent lineage tracing within an unperturbed developmental context, allowing for a quantitative and unbiased estimation of the fraction of totipotent blastomeres. The other options are flawed because they test a different biological question (B, D), use inappropriate methods for lineage tracing (C), or rely on indirect predictive models instead of direct observation (E).", "answer": "$$\\boxed{A}$$", "id": "2675602"}, {"introduction": "The stability of cell states, such as pluripotency, is not a static property but an emergent feature of a dynamic underlying gene regulatory network. We can explore the principles governing these states using mathematical modeling, which provides a powerful framework for generating and testing hypotheses about network behavior. This computational exercise [@problem_id:2675630] guides you through the analysis of a simplified model of the core pluripotency network, using a system of ordinary differential equations ($ODEs$) to understand how feedback loops create stable states and how external signals, like $FGF/ERK$, can push the system across thresholds to induce differentiation.", "problem": "You are asked to construct and analyze a minimal, yet scientifically plausible, dynamical model of the pluripotency circuit comprising Oct4, Sox2, and Nanog in embryonic stem cells, incorporating Fibroblast Growth Factor/Extracellular Signal-Regulated Kinase (FGF/ERK) signaling as an inhibitory input. Your task is to formalize the model using a system of ordinary differential equations (ODEs) with Hill-type regulatory functions, compute fixed points for specified input levels, and determine the stability of these fixed points.\n\nFundamental base and modeling assumptions to be used:\n- Central Dogma and gene regulation: transcription factors modulate transcriptional output through regulatory interactions; production and degradation at the molecular level are modeled at the coarse-grained scale using ordinary differential equations under a quasi-steady assumption for fast intermediate steps.\n- Production and degradation balance: for each molecular species, the time derivative equals production minus degradation, with degradation approximated as a first-order decay.\n- Hill-type regulatory functions: activation is modeled by a Hill function with exponent capturing cooperativity; repression is modeled by an inhibitory Hill function; an AND gate for combinatorial regulation is modeled by the product of Hill activations.\n\nLet $O(t)$, $S(t)$, and $N(t)$ denote the concentrations of Oct4, Sox2, and Nanog, respectively. Let $E$ denote a dimensionless proxy for the FGF/ERK input level. Define the standard activating Hill function\n$$H_{\\mathrm{act}}(x;K,n) \\equiv \\frac{x^n}{K^n + x^n},$$\nand the standard inhibitory Hill function\n$$H_{\\mathrm{rep}}(E;K,m) \\equiv \\frac{1}{1 + \\left(\\frac{E}{K}\\right)^m}.$$\n\nUse the following minimal ODE model, derived from the assumptions above:\n- Oct4 receives basal production and activation from Nanog:\n$$\\frac{dO}{dt} \\equiv \\beta_O \\cdot \\frac{w_{O0} + w_{ON}\\,H_{\\mathrm{act}}(N;K_{ON},n_{ON})}{w_{O0}+w_{ON}} - \\gamma_O\\, O.$$\n- Sox2 receives basal production and activation from Nanog:\n$$\\frac{dS}{dt} \\equiv \\beta_S \\cdot \\frac{w_{S0} + w_{SN}\\,H_{\\mathrm{act}}(N;K_{SN},n_{SN})}{w_{S0}+w_{SN}} - \\gamma_S\\, S.$$\n- Nanog is activated by an AND gate of Oct4 and Sox2 and also by self-activation, and repressed by FGF/ERK:\n$$\\frac{dN}{dt} \\equiv \\beta_N \\cdot \\left(\\frac{w_{NO}\\,H_{\\mathrm{act}}(O;K_{NO},n_{NO})\\,H_{\\mathrm{act}}(S;K_{NS},n_{NS}) + w_{NN}\\,H_{\\mathrm{act}}(N;K_{NN},n_{NN})}{w_{NO}+w_{NN}}\\right)\\cdot H_{\\mathrm{rep}}(E;K_{EN},m_{EN}) - \\gamma_N\\, N.$$\n\nParameter values to use for all computations:\n- Production rates: $\\beta_O=\\beta_S=\\beta_N=1.0$.\n- Degradation rates: $\\gamma_O=\\gamma_S=\\gamma_N=1.0$.\n- Activation weights: $w_{O0}=0.05$, $w_{ON}=0.95$; $w_{S0}=0.05$, $w_{SN}=0.95$; $w_{NO}=0.6$, $w_{NN}=0.4$.\n- Hill thresholds: $K_{ON}=K_{SN}=K_{NO}=K_{NS}=K_{NN}=0.5$; inhibitory threshold $K_{EN}=1.0$.\n- Hill exponents (cooperativity): $n_{ON}=n_{SN}=n_{NO}=n_{NS}=n_{NN}=4$; inhibitory exponent $m_{EN}=3$.\n\nDefinitions for analysis:\n- A fixed point is any $(O^\\ast,S^\\ast,N^\\ast)$ satisfying the algebraic system $\\frac{dO}{dt}=\\frac{dS}{dt}=\\frac{dN}{dt}=0$.\n- The Jacobian matrix $J$ at a fixed point has entries $J_{ij} \\equiv \\frac{\\partial f_i}{\\partial x_j}$, where $\\mathbf{f}=(\\frac{dO}{dt},\\frac{dS}{dt},\\frac{dN}{dt})$ and $\\mathbf{x}=(O,S,N)$.\n- A fixed point is linearly stable if all eigenvalues of $J$ have strictly negative real parts.\n- Define the maximal steady-state levels under full activation and no repression as $O_{\\max}\\equiv \\beta_O/\\gamma_O$, $S_{\\max}\\equiv \\beta_S/\\gamma_S$, and $N_{\\max}\\equiv \\beta_N/\\gamma_N$. A “pluripotent-like” stable fixed point is one with $N^\\ast \\ge 0.6\\,N_{\\max}$ and $O^\\ast \\ge 0.4\\,O_{\\max}$ and $S^\\ast \\ge 0.4\\,S_{\\max}$.\n\nComputational task:\n- For each specified input $E$, numerically compute all distinct fixed points by solving the algebraic system from multiple initial conditions, deduplicate solutions by $\\ell_2$-distance tolerance, evaluate the Jacobian and its eigenvalues at each fixed point, and determine stability.\n- Decide whether at least one “pluripotent-like” stable fixed point exists for that $E$ according to the thresholds above.\n\nTest suite (FGF/ERK inputs):\n- $E \\in \\{0.0, 0.5, 2.0, 10.0\\}$.\n\nOutput specification:\n- For each $E$, compute and report a list of three integers `[n_all, n_stable, h_pluri]`, where `n_all` is the total number of distinct fixed points found, `n_stable` is the number of linearly stable fixed points, and `h_pluri` equals $1$ if at least one stable fixed point is pluripotent-like and equals $0$ otherwise.\n- Your program should produce a single line of output containing the results for the test suite, as a comma-separated list of these per-$E$ lists, enclosed in square brackets. No units are required because all reported quantities are dimensionless counts or binary indicators.", "solution": "The problem statement has been subjected to rigorous validation and is deemed scientifically sound, well-posed, and complete. All necessary mathematical definitions, model equations, and parameter values are provided unambiguously. We shall proceed with the formal analysis.\n\nThe objective is to analyze the fixed points of a dynamical system modeling a pluripotency gene regulatory network. The system is described by a set of three coupled ordinary differential equations (ODEs) for the concentrations of the transcription factors Oct4 ($O(t)$), Sox2 ($S(t)$), and Nanog ($N(t)$). The system's behavior is modulated by an external inhibitory signal, FGF/ERK, denoted by $E$.\n\nThe state of the system is given by the vector $\\mathbf{x}(t) = (O(t), S(t), N(t))$. The dynamics are governed by $\\frac{d\\mathbf{x}}{dt} = \\mathbf{f}(\\mathbf{x}; E)$, where:\n$$ \\frac{dO}{dt} = f_O(O,S,N;E) = \\beta_O \\cdot \\frac{w_{O0} + w_{ON}\\,H_{\\mathrm{act}}(N;K_{ON},n_{ON})}{w_{O0}+w_{ON}} - \\gamma_O\\, O $$\n$$ \\frac{dS}{dt} = f_S(O,S,N;E) = \\beta_S \\cdot \\frac{w_{S0} + w_{SN}\\,H_{\\mathrm{act}}(N;K_{SN},n_{SN})}{w_{S0}+w_{SN}} - \\gamma_S\\, S $$\n$$ \\frac{dN}{dt} = f_N(O,S,N;E) = \\beta_N \\cdot \\left(\\frac{w_{NO}\\,H_{\\mathrm{act}}(O;K_{NO},n_{NO})\\,H_{\\mathrm{act}}(S;K_{NS},n_{NS}) + w_{NN}\\,H_{\\mathrm{act}}(N;K_{NN},n_{NN})}{w_{NO}+w_{NN}}\\right)\\cdot H_{\\mathrm{rep}}(E;K_{EN},m_{EN}) - \\gamma_N\\, N $$\n\nA fixed point, denoted $\\mathbf{x}^\\ast = (O^\\ast, S^\\ast, N^\\ast)$, is a steady-state solution where the concentrations do not change over time, satisfying $\\frac{d\\mathbf{x}}{dt} = \\mathbf{0}$. This translates into solving the algebraic system $\\mathbf{f}(\\mathbf{x}^\\ast; E) = \\mathbf{0}$.\n\nSubstituting the given parameter values $\\beta_O=\\beta_S=1.0$, $\\gamma_O=\\gamma_S=1.0$, $w_{O0}=w_{S0}=0.05$, $w_{ON}=w_{SN}=0.95$, $K_{ON}=K_{SN}=0.5$, and $n_{ON}=n_{SN}=4$, we observe that the production terms for $O$ and $S$ are identical functions of $N$. At a fixed point, we have:\n$$ O^\\ast = \\frac{\\beta_O}{\\gamma_O} \\cdot \\frac{w_{O0} + w_{ON}\\,H_{\\mathrm{act}}(N^\\ast;K_{ON},n_{ON})}{w_{O0}+w_{ON}} $$\n$$ S^\\ast = \\frac{\\beta_S}{\\gamma_S} \\cdot \\frac{w_{S0} + w_{SN}\\,H_{\\mathrm{act}}(N^\\ast;K_{SN},n_{SN})}{w_{S0}+w_{SN}} $$\nGiven the identical parameters for the $O$ and $S$ equations, it is necessary that $O^\\ast = S^\\ast$ for any fixed point. This crucial observation simplifies the problem significantly, reducing the search for a $3$-dimensional fixed point to a search in a $2$-dimensional space defined by $(O, N)$. The system of equations for fixed points becomes:\n$$ O = \\frac{1.0}{1.0} \\cdot \\frac{0.05 + 0.95\\,H_{\\mathrm{act}}(N;0.5,4)}{0.05+0.95} = 0.05 + 0.95\\,H_{\\mathrm{act}}(N;0.5,4) $$\n$$ N = \\frac{1.0}{1.0} \\cdot \\left(\\frac{0.6\\,H_{\\mathrm{act}}(O;0.5,4)^2 + 0.4\\,H_{\\mathrm{act}}(N;0.5,4)}{0.6+0.4}\\right)\\cdot H_{\\mathrm{rep}}(E;1.0,3) $$\n\nTo find all fixed points for a given $E$, we numerically solve this system of two non-linear equations for $(O, N)$. Due to the potential for multiple solutions (multistability), we employ a numerical root-finding algorithm (`scipy.optimize.root`) initialized from a grid of starting points spanning the plausible state space (e.g., $[0, 1.2]\\times[0, 1.2]$). The resulting solutions are filtered for physical validity (non-negative concentrations) and deduplicated based on a small $\\ell_2$-distance tolerance.\n\nThe linear stability of each unique fixed point $\\mathbf{x}^\\ast$ is determined by the eigenvalues of the Jacobian matrix $J$ evaluated at that point, where $J_{ij} = \\frac{\\partial f_i}{\\partial x_j}|_{\\mathbf{x}^\\ast}$. The fixed point is stable if and only if all eigenvalues of $J$ have strictly negative real parts. The partial derivatives are calculated analytically from the ODE system. For example:\n$$ J_{11} = \\frac{\\partial f_O}{\\partial O} = -\\gamma_O = -1.0 $$\n$$ J_{13} = \\frac{\\partial f_O}{\\partial N} = \\frac{\\beta_O w_{ON}}{w_{O0}+w_{ON}} \\frac{d H_{\\mathrm{act}}(N;K_{ON},n_{ON})}{dN} $$\nThe other entries are derived similarly. We compute this $3 \\times 3$ matrix and its eigenvalues for each fixed point.\n\nFinally, we classify each stable fixed point as \"pluripotent-like\" or not. First, we compute the maximal steady-state levels:\n$O_{\\max} = \\beta_O/\\gamma_O = 1.0$, $S_{\\max} = \\beta_S/\\gamma_S = 1.0$, $N_{\\max} = \\beta_N/\\gamma_N = 1.0$.\nA stable fixed point $(O^\\ast, S^\\ast, N^\\ast)$ is pluripotent-like if $N^\\ast \\ge 0.6\\,N_{\\max} = 0.6$, $O^\\ast \\ge 0.4\\,O_{\\max} = 0.4$, and $S^\\ast \\ge 0.4\\,S_{\\max} = 0.4$.\n\nThe computational procedure for each value of $E$ in the test suite is as follows:\n1.  Numerically solve for all distinct fixed points $(O^\\ast, N^\\ast)$, then reconstruct $S^\\ast=O^\\ast$. This gives $n_{\\mathrm{all}}$.\n2.  For each fixed point, compute the Jacobian matrix $J$ and its eigenvalues. Count the number of stable fixed points, $n_{\\mathrm{stable}}$.\n3.  Check if any of the stable fixed points satisfy the pluripotency criteria. Set $h_{\\mathrm{pluri}}=1$ if at least one does, and $h_{\\mathrm{pluri}}=0$ otherwise.\n4.  Report the triplet $[n_{\\mathrm{all}}, n_{\\mathrm{stable}}, h_{\\mathrm{pluri}}]$.\n\nThis procedure is implemented in the provided Python code, which iterates through the specified values of $E$, performs the analysis, and formats the output as required.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import root\nfrom scipy.linalg import eigvals\n\ndef solve():\n    \"\"\"\n    Constructs and analyzes a dynamical model of the pluripotency circuit.\n    For each specified FGF/ERK input level E, it computes the number of\n    fixed points, the number of stable fixed points, and whether a stable\n    pluripotent-like state exists.\n    \"\"\"\n\n    # --- Parameter Definition ---\n    # These are fixed as per the problem statement.\n    p = {\n        'beta_O': 1.0, 'beta_S': 1.0, 'beta_N': 1.0,\n        'gamma_O': 1.0, 'gamma_S': 1.0, 'gamma_N': 1.0,\n        'w_O0': 0.05, 'w_ON': 0.95,\n        'w_S0': 0.05, 'w_SN': 0.95,\n        'w_NO': 0.6, 'w_NN': 0.4,\n        'K_ON': 0.5, 'K_SN': 0.5, 'K_NO': 0.5, 'K_NS': 0.5, 'K_NN': 0.5, 'K_EN': 1.0,\n        'n_ON': 4, 'n_SN': 4, 'n_NO': 4, 'n_NS': 4, 'n_NN': 4, 'm_EN': 3,\n    }\n\n    # --- Helper Functions ---\n    def H_act(x, K, n):\n        \"\"\"Standard activating Hill function.\"\"\"\n        # Add a small epsilon to prevent division by zero for x=K=0, though not the case here.\n        x_n = x**n\n        return x_n / (K**n + x_n)\n\n    def H_rep(E, K, m):\n        \"\"\"Standard inhibitory Hill function.\"\"\"\n        return 1.0 / (1.0 + (E / K)**m)\n\n    def H_act_deriv(x, K, n):\n        \"\"\"Derivative of the activating Hill function w.r.t. x.\"\"\"\n        K_n = K**n\n        x_n = x**n\n        return (n * K_n * x**(n - 1)) / (K_n + x_n)**2\n\n    # --- Core Logic Functions ---\n    def find_fixed_points(E, params, grid_size=12, tolerance=1e-6):\n        \"\"\"\n        Numerically finds all distinct fixed points for a given E.\n        Leverages the simplification O*=S* to solve a 2D system.\n        \"\"\"\n        def system_2d(variables):\n            O, N = variables\n            # Production terms (normalized by design since sum of weights is 1)\n            prod_O = params['beta_O'] * (params['w_O0'] + params['w_ON'] * H_act(N, params['K_ON'], params['n_ON']))\n            rep_term = H_rep(E, params['K_EN'], params['m_EN'])\n            prod_N = params['beta_N'] * (params['w_NO'] * H_act(O, params['K_NO'], params['n_NO'])**2 +\n                                         params['w_NN'] * H_act(N, params['K_NN'], params['n_NN'])) * rep_term\n            \n            # Fixed point equations: production = degradation\n            eq1 = prod_O - params['gamma_O'] * O\n            eq2 = prod_N - params['gamma_N'] * N\n            return [eq1, eq2]\n\n        initial_guesses = np.linspace(0.0, 1.2, grid_size)\n        solutions = []\n        for o_guess in initial_guesses:\n            for n_guess in initial_guesses:\n                sol = root(system_2d, [o_guess, n_guess], method='hybr')\n                if sol.success and np.all(sol.x >= 0):\n                    solutions.append(sol.x)\n        \n        if not solutions:\n            return []\n\n        # Deduplicate solutions\n        unique_solutions = []\n        solutions = np.array(solutions)\n        while solutions.shape[0] > 0:\n            base_sol = solutions[0]\n            unique_solutions.append(base_sol)\n            distances = np.linalg.norm(solutions - base_sol, axis=1)\n            solutions = solutions[distances > tolerance]\n        \n        # Reconstruct 3D points [O, S, N]\n        unique_3d = []\n        for s in unique_solutions:\n            O_star, N_star = s\n            # S* = O* due to identical parameters\n            unique_3d.append(np.array([O_star, O_star, N_star]))\n            \n        return unique_3d\n\n    def get_jacobian(fp, E, params):\n        \"\"\"Computes the 3x3 Jacobian matrix at a given fixed point.\"\"\"\n        O, S, N = fp\n        J = np.zeros((3, 3))\n        \n        # J[0,:] (d(dO/dt)/d(O,S,N))\n        J[0, 0] = -params['gamma_O']\n        J[0, 1] = 0.0\n        J[0, 2] = params['beta_O'] * (params['w_ON'] / (params['w_O0'] + params['w_ON'])) * H_act_deriv(N, params['K_ON'], params['n_ON'])\n\n        # J[1,:] (d(dS/dt)/d(O,S,N))\n        J[1, 0] = 0.0\n        J[1, 1] = -params['gamma_S']\n        J[1, 2] = params['beta_S'] * (params['w_SN'] / (params['w_S0'] + params['w_SN'])) * H_act_deriv(N, params['K_SN'], params['n_SN'])\n\n        # J[2,:] (d(dN/dt)/d(O,S,N))\n        rep_term = H_rep(E, params['K_EN'], params['m_EN'])\n        norm_N = params['w_NO'] + params['w_NN']\n        J[2, 0] = params['beta_N'] * (params['w_NO'] * H_act(S, params['K_NS'], params['n_NS']) * H_act_deriv(O, params['K_NO'], params['n_NO']) / norm_N) * rep_term\n        J[2, 1] = params['beta_N'] * (params['w_NO'] * H_act(O, params['K_NO'], params['n_NO']) * H_act_deriv(S, params['K_NS'], params['n_NS']) / norm_N) * rep_term\n        J[2, 2] = params['beta_N'] * (params['w_NN'] * H_act_deriv(N, params['K_NN'], params['n_NN']) / norm_N) * rep_term - params['gamma_N']\n\n        return J\n\n    def analyze_fixed_point_system(E, params):\n        \"\"\"\n        Performs the full analysis for a single E value: finds fixed points,\n        analyzes stability, and checks for pluripotency.\n        \"\"\"\n        fixed_points = find_fixed_points(E, params)\n        \n        n_all = len(fixed_points)\n        n_stable = 0\n        h_pluri = 0\n\n        O_max = params['beta_O'] / params['gamma_O']\n        S_max = params['beta_S'] / params['gamma_S']\n        N_max = params['beta_N'] / params['gamma_N']\n\n        for fp in fixed_points:\n            jacobian = get_jacobian(fp, E, params)\n            eigenvalues = eigvals(jacobian)\n            \n            is_stable = np.all(np.real(eigenvalues)  0.0)\n            \n            if is_stable:\n                n_stable += 1\n                O_star, S_star, N_star = fp\n                is_pluri = (N_star >= 0.6 * N_max) and (O_star >= 0.4 * O_max) and (S_star >= 0.4 * S_max)\n                if is_pluri:\n                    h_pluri = 1\n                    \n        return [n_all, n_stable, h_pluri]\n\n    # --- Main Execution ---\n    test_cases = [0.0, 0.5, 2.0, 10.0]\n    results = [analyze_fixed_point_system(E, p) for E in test_cases]\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\".replace(\" \", \"\"))\n\nsolve()\n```", "id": "2675630"}]}