{"hands_on_practices": [{"introduction": "A cornerstone of developmental biology is the ability to predict the consequences of genetic or pharmacological perturbations based on the underlying molecular logic. This exercise challenges you to think like an experimentalist by applying the core principles of ectodermal patterning along the anterior-posterior axis. By reasoning through the well-established role of canonical Wnt signaling as a posteriorizing agent, you will deduce the complex phenotypic outcomes of its ectopic activation, integrating your knowledge of how forebrain, cranial placode, and neural crest fates are specified [@problem_id:2632453].", "problem": "You engineer a vertebrate model in which canonical Wnt signaling can be selectively and robustly activated in the anterior neural ectoderm by a tamoxifen-inducible, tissue-restricted transgene that stabilizes $\\beta$-catenin. You induce activation at late gastrula to early neurula stages, when the neural plate is being regionalized along the anterior–posterior axis. Predict the most coherent constellation of phenotypes that would result in the anterior neural ectoderm and its derivatives, and justify the prediction based on first principles of ectodermal patterning and organizer function. Assume that noncanonical Wnt pathways are not directly altered and that Bone Morphogenetic Protein levels and Hedgehog signaling are unchanged globally.\n\nWhich option best matches the expected outcomes?\n\nA. Strong anterior truncation characterized by loss or severe reduction of forebrain derivatives (including telencephalon and the eye field), anterior expansion of posterior neural identities into the rostral neural plate, reduction of the preplacodal domain with loss of cranial placodes such as lens, olfactory, and adenohypophyseal placodes, and a relative expansion of neural crest at the anterior neural plate border.\n\nB. Massive expansion and duplication of forebrain and eye field with concomitant suppression of posterior neural fates, accompanied by enlargement of the preplacodal domain and suppression of neural crest at the anterior neural plate border.\n\nC. Largely preserved anterior neural identity with cyclopia due to a midline defect, while placodal derivatives form normally and posterior neural gene expression boundaries remain in place.\n\nD. Selective dorsalization of the anterior neural tube with preserved anterior–posterior identity, yielding increased roof plate markers without major change in forebrain size or placode versus neural crest allocation.\n\nE. Conversion of anterior neural ectoderm into surface ectoderm due to impaired neural induction, producing expanded epidermis in the head and a general loss of central nervous system tissue in the anterior region.\n\nSelect the single best option.", "solution": "The problem statement will first be subjected to a rigorous validation procedure according to established scientific and logical principles.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n\nThe problem statement provides the following information:\n*   **System:** A vertebrate model organism.\n*   **Genetic Manipulation:** A tamoxifen-inducible, tissue-restricted transgene that stabilizes $\\beta$-catenin, leading to selective and robust activation of canonical Wnt signaling.\n*   **Target Tissue:** The anterior neural ectoderm.\n*   **Timing of Induction:** Late gastrula to early neurula stages.\n*   **Developmental Context:** Regionalization of the neural plate along the anterior–posterior axis.\n*   **Objective:** Predict the most coherent constellation of phenotypes in the anterior neural ectoderm and its derivatives.\n*   **Assumptions/Constraints:**\n    1.  Noncanonical Wnt pathways are not directly altered.\n    2.  Bone Morphogenetic Protein (BMP) levels are unchanged globally.\n    3.  Hedgehog (Hh) signaling is unchanged globally.\n\n**Step 2: Validate Using Extracted Givens**\n\nThe problem is evaluated against the following criteria:\n\n*   **Scientifically Grounded:** The problem is firmly rooted in the fundamental principles of developmental biology. The roles of canonical Wnt signaling, $\\beta$-catenin, BMP, and Hh in patterning the embryonic ectoderm are well-established, core concepts. Canonical Wnt signaling, mediated by $\\beta$-catenin, is experimentally verified as a primary posteriorizing signal for the neurectoderm. The experimental design described—inducible activation of a signaling pathway in a specific spatio-temporal context—is a standard and powerful methodology in the field. The setup is scientifically sound and realistic.\n*   **Well-Posed:** The problem is clearly defined. It specifies the system, the perturbation, the timing, and a set of constraints. This structure allows for a unique and logical solution to be deduced from first principles. The question asks for a \"constellation of phenotypes,\" which is a standard way of framing questions about complex developmental outcomes.\n*   **Objective:** The language is technical, precise, and devoid of subjectivity or ambiguity. Terms such as \"canonical Wnt signaling,\" \"$\\beta$-catenin stabilization,\" and \"anterior neural ectoderm\" have specific, universally understood meanings in developmental biology.\n\n**Step 3: Verdict and Action**\n\nThe problem statement is **valid**. It is scientifically sound, well-posed, and objective. It represents a classic thought experiment in developmental neurobiology. Therefore, a solution will be derived.\n\n### Derivation of Solution\n\nThe solution is derived from the following first principles of vertebrate embryonic patterning:\n\n1.  **Neural Plate Patterning:** During gastrulation and neurulation, the ectoderm is patterned into distinct domains. The central region becomes the neural plate (the precursor to the central nervous system), which is flanked by the neural plate border (NPB). The tissue outside the NPB becomes surface ectoderm (epidermis).\n2.  **Anterior-Posterior (A-P) Axis Specification:** The neural plate is patterned along the A-P axis to form the major brain subdivisions (forebrain, midbrain, hindbrain) and the spinal cord. The \"default\" state of neural tissue, induced by antagonists of BMP signaling from the organizer, is anterior or forebrain-like. The development and maintenance of this anterior identity critically depend on the *inhibition* of posteriorizing signals.\n3.  **Role of Canonical Wnt Signaling:** Canonical Wnt signaling, which operates through the stabilization and nuclear translocation of $\\beta$-catenin, is the principal posteriorizing signal for the neural ectoderm. A gradient of Wnt activity exists along the A-P axis, with low levels in the anterior and progressively higher levels toward the posterior. The anterior-most structures, including the forebrain and eye field, develop in a Wnt-free environment, actively maintained by Wnt antagonists (e.g., Dkk1, Cerberus, sFRPs) secreted from the anterior visceral endoderm and the prechordal mesendoderm.\n4.  **Neural Plate Border (NPB) Fating:** The NPB gives rise to both the neural crest and cranial placodes. The specification of these fates is governed by a complex interplay of signals, including Wnt, BMP, and FGF.\n    *   **Preplacodal Domain (PPD):** This domain, located at the anterior NPB, gives rise to the olfactory, lens, and adenohypophyseal placodes. Its specification requires a signaling environment low in both Wnt and BMP.\n    *   **Neural Crest:** This cell population arises from the more posterior NPB (and later, the dorsal neural tube). Its induction is promoted by Wnt signaling in concert with intermediate levels of BMP signaling.\n\n**Application to the Problem:**\n\nThe experiment involves the ectopic activation of canonical Wnt/$\\beta$-catenin signaling (via $\\beta$-catenin stabilization) in the anterior neural ectoderm at a time when A-P patterning is occurring. Based on the principles above, the following consequences are predicted:\n\n*   **Posteriorization of the Anterior Neural Plate:** The forced activation of Wnt/$\\beta$-catenin signaling will override the endogenous Wnt-inhibitory environment required for anterior neural development. The anterior neural ectoderm will be re-specified to a more posterior fate. This will result in a failure to form forebrain derivatives (e.g., telencephalon, diencephalon) and the optic vesicles (eye field). This phenotype is termed \"anterior truncation\" or \"caudalization.\" The anterior neural plate will instead express genes characteristic of more posterior regions, such as the midbrain, hindbrain, or even spinal cord.\n*   **Disruption of Anterior NPB Fates:** The ectopic Wnt signal will alter the signaling environment at the anterior NPB.\n    *   The PPD, which requires low Wnt levels, will fail to be specified or maintained. Consequently, its derivatives—the cranial placodes (lens, olfactory, etc.)—will be severely reduced or absent.\n    *   Conversely, because Wnt signaling promotes neural crest induction, the ectopic Wnt activation at the anterior NPB is expected to promote neural crest fate at the expense of placodal fate. This would lead to a relative or absolute expansion of neural crest cells in the anterior head region.\n\nThis predicted constellation of phenotypes—anterior truncation, posterior transformation, loss of placodes, and expansion of neural crest—is the logical outcome of the experimental perturbation.\n\n### Evaluation of Options\n\n*   **A. Strong anterior truncation characterized by loss or severe reduction of forebrain derivatives (including telencephalon and the eye field), anterior expansion of posterior neural identities into the rostral neural plate, reduction of the preplacodal domain with loss of cranial placodes such as lens, olfactory, and adenohypophyseal placodes, and a relative expansion of neural crest at the anterior neural plate border.**\n    This option precisely describes all the expected consequences derived from first principles: posteriorization of the neural tube (anterior truncation), reduction of placodal derivatives, and promotion of neural crest fate.\n    **Verdict: Correct.**\n\n*   **B. Massive expansion and duplication of forebrain and eye field with concomitant suppression of posterior neural fates, accompanied by enlargement of the preplacodal domain and suppression of neural crest at the anterior neural plate border.**\n    This describes the phenotype expected from the *inhibition* of canonical Wnt signaling, not its activation. It is the diametric opposite of the correct prediction.\n    **Verdict: Incorrect.**\n\n*   **C. Largely preserved anterior neural identity with cyclopia due to a midline defect, while placodal derivatives form normally and posterior neural gene expression boundaries remain in place.**\n    This is incorrect on multiple fronts. Cyclopia is a midline defect classically associated with deficient Hh signaling, which the problem explicitly assumes is unchanged. Most importantly, ectopic Wnt signaling fundamentally alters A-P identity; thus, anterior identity would not be \"largely preserved.\"\n    **Verdict: Incorrect.**\n\n*   **D. Selective dorsalization of the anterior neural tube with preserved anterior–posterior identity, yielding increased roof plate markers without major change in forebrain size or placode versus neural crest allocation.**\n    While Wnt signaling does have a dorsalizing role in the neural tube, its effect on A-P patterning is primary and overpowering, especially under these experimental conditions. It is illogical to suggest that A-P identity would be preserved in the face of strong, ectopic Wnt activation in the anterior region. This option incorrectly prioritizes a secondary role over the primary one.\n    **Verdict: Incorrect.**\n\n*   **E. Conversion of anterior neural ectoderm into surface ectoderm due to impaired neural induction, producing expanded epidermis in the head and a general loss of central nervous system tissue in the anterior region.**\n    This describes a failure of neural induction, a process primarily mediated by BMP signaling. High BMP levels promote epidermal fate, while BMP inhibition promotes neural fate. The problem perturbs the Wnt pathway within already-specified neural ectoderm and states BMP levels are unchanged. Therefore, a conversion to surface ectoderm is not the expected outcome.\n    **Verdict: Incorrect.**", "answer": "$$\\boxed{A}$$", "id": "2632453"}, {"introduction": "While conceptual models are essential, developmental biology increasingly relies on quantitative frameworks to understand patterning precision and robustness. This practice invites you to formalize the concept of positional information using a simple but elegant mathematical model of a morphogen gradient. By deriving how a cellular fate boundary shifts in response to changes in morphogen production, you will uncover a fundamental principle of developmental scaling and appreciate how abstract models can generate powerful, testable predictions [@problem_id:2632318].", "problem": "In ventral spinal cord patterning, Sonic hedgehog (Shh) establishes a ventral-to-dorsal concentration gradient that partitions progenitor domains such as the motor neuron progenitor (pMN) and the V2 interneuron progenitor (p2). Assume the following foundational and widely accepted principles: (i) positional information is read out by cells as a monotonic function of local morphogen concentration, (ii) boundary positions correspond to isoresponse contours of a gene regulatory network with cross-repression that implements a fixed response threshold, and (iii) at steady state, a morphogen produced at one boundary and cleared uniformly in tissue forms an approximately exponential concentration profile with distance from the source. Let the Shh concentration along the dorsoventral axis be $S(x)=S_{0}\\exp(-x/\\lambda)$ for $x\\ge 0$, where $x$ is distance from the ventral midline, $S_{0}$ is the ventral concentration amplitude, and $\\lambda$ is the decay length. Suppose the relevant transcriptional output $R$ that determines the pMN versus p2 fate is a Hill-type response to Shh concentration given by $R(S)=\\dfrac{S^{n}}{K^{n}+S^{n}}$, with Hill coefficient $n>0$ and half-activation constant $K>0$. The pMN/p2 boundary is defined as the position $x_{b}$ where the response reaches a fixed threshold $R_{c}$ with $0<R_{c}<1$ determined by the cross-repressive network.\n\nNow consider a perturbation that increases Shh production, changing the ventral amplitude to $S_{0}^{\\prime}=\\alpha S_{0}$ with $\\alpha>0$, while $n$, $K$, $\\lambda$, and $R_{c}$ remain unchanged. Let $x_{b}^{\\prime}$ be the new boundary position defined by the same response threshold $R_{c}$. Derive, from the stated principles, a closed-form symbolic expression for the boundary shift $\\Delta x=x_{b}^{\\prime}-x_{b}$ as a function of $\\alpha$ and $\\lambda$ only. Provide your answer as a single closed-form symbolic expression.", "solution": "The problem requires the derivation of the shift in a morphogen-defined boundary, $\\Delta x$, upon a change in the source concentration amplitude. The problem statement is scientifically sound and mathematically well-posed, providing a sufficient set of principles and equations to determine a unique solution. We shall proceed with a formal derivation.\n\nThe concentration of the morphogen Sonic hedgehog ($Shh$) along the dorsoventral axis is given by the function $S(x) = S_{0}\\exp(-x/\\lambda)$, where $x$ is the distance from the ventral midline, $S_{0}$ is the concentration at the source ($x=0$), and $\\lambda$ is the characteristic decay length of the gradient.\n\nThe cellular response to the local $Shh$ concentration, $S$, is described by a Hill function:\n$$ R(S) = \\frac{S^{n}}{K^{n}+S^{n}} $$\nwhere $n$ is the Hill coefficient and $K$ is the half-activation constant.\n\nA specific cell fate boundary, in this case between the pMN and p2 progenitor domains, is established at a position $x_{b}$ where the cellular response $R$ reaches a critical threshold value $R_{c}$. This is consistent with the principle of positional information, where concentration thresholds specify distinct developmental outcomes. Therefore, the position of the boundary $x_{b}$ is defined by the equation:\n$$ R(S(x_{b})) = R_{c} $$\nSubstituting the expression for $R(S)$, we have:\n$$ \\frac{(S(x_{b}))^{n}}{K^{n}+(S(x_{b}))^{n}} = R_{c} $$\nThis equation defines the specific morphogen concentration, let us call it $S_{b} = S(x_b)$, that corresponds to the boundary. We can solve for $S_{b}$:\n$$ (S_{b})^{n} = R_{c} (K^{n} + (S_{b})^{n}) $$\n$$ (S_{b})^{n} = R_{c}K^{n} + R_{c}(S_{b})^{n} $$\n$$ (S_{b})^{n} (1 - R_{c}) = R_{c}K^{n} $$\n$$ (S_{b})^{n} = \\frac{R_{c}K^{n}}{1 - R_{c}} $$\n$$ S_{b} = K \\left( \\frac{R_{c}}{1 - R_{c}} \\right)^{1/n} $$\nThis shows that the boundary forms at a constant, time-invariant iso-concentration contour $S_{b}$, whose value is determined by the fixed parameters of the gene regulatory network ($n$, $K$, $R_{c}$).\n\nNow, we relate this threshold concentration $S_{b}$ to the spatial position of the boundary $x_{b}$ using the concentration profile function $S(x)$.\n$$ S(x_{b}) = S_{0}\\exp(-x_{b}/\\lambda) = S_{b} $$\nTo solve for $x_{b}$, we take the natural logarithm of both sides:\n$$ \\exp(-x_{b}/\\lambda) = \\frac{S_{b}}{S_{0}} $$\n$$ -\\frac{x_{b}}{\\lambda} = \\ln\\left(\\frac{S_{b}}{S_{0}}\\right) $$\n$$ x_{b} = -\\lambda \\ln\\left(\\frac{S_{b}}{S_{0}}\\right) = \\lambda \\ln\\left(\\left(\\frac{S_{b}}{S_{0}}\\right)^{-1}\\right) = \\lambda \\ln\\left(\\frac{S_{0}}{S_{b}}\\right) $$\nThis is the expression for the initial boundary position.\n\nNext, we consider the perturbation. The $Shh$ production is altered such that the source concentration becomes $S_{0}^{\\prime} = \\alpha S_{0}$. The new concentration profile is $S^{\\prime}(x) = S_{0}^{\\prime}\\exp(-x/\\lambda) = \\alpha S_{0}\\exp(-x/\\lambda)$. The parameters of the response network ($n$, $K$) and the threshold ($R_{c}$) remain unchanged. Consequently, the boundary will now form at a new position, $x_{b}^{\\prime}$, where the new concentration profile $S^{\\prime}(x)$ equals the same threshold concentration $S_{b}$.\n$$ S^{\\prime}(x_{b}^{\\prime}) = \\alpha S_{0}\\exp(-x_{b}^{\\prime}/\\lambda) = S_{b} $$\nWe solve for the new boundary position $x_{b}^{\\prime}$:\n$$ \\exp(-x_{b}^{\\prime}/\\lambda) = \\frac{S_{b}}{\\alpha S_{0}} $$\n$$ -\\frac{x_{b}^{\\prime}}{\\lambda} = \\ln\\left(\\frac{S_{b}}{\\alpha S_{0}}\\right) $$\n$$ x_{b}^{\\prime} = -\\lambda \\ln\\left(\\frac{S_{b}}{\\alpha S_{0}}\\right) = \\lambda \\ln\\left(\\frac{\\alpha S_{0}}{S_{b}}\\right) $$\nThe problem asks for the boundary shift, $\\Delta x = x_{b}^{\\prime} - x_{b}$. We substitute the expressions for $x_{b}^{\\prime}$ and $x_{b}$:\n$$ \\Delta x = \\lambda \\ln\\left(\\frac{\\alpha S_{0}}{S_{b}}\\right) - \\lambda \\ln\\left(\\frac{S_{0}}{S_{b}}\\right) $$\nUsing the logarithmic identity $\\ln(a) - \\ln(b) = \\ln(a/b)$, we can simplify this expression:\n$$ \\Delta x = \\lambda \\left[ \\ln\\left(\\frac{\\alpha S_{0}}{S_{b}}\\right) - \\ln\\left(\\frac{S_{0}}{S_{b}}\\right) \\right] = \\lambda \\ln\\left( \\frac{\\frac{\\alpha S_{0}}{S_{b}}}{\\frac{S_{0}}{S_{b}}} \\right) $$\n$$ \\Delta x = \\lambda \\ln(\\alpha) $$\nThis final expression for the boundary shift $\\Delta x$ is a function of only the fold-change in source concentration, $\\alpha$, and the gradient decay length, $\\lambda$, as required. The parameters describing the details of the transcriptional response, $n$, $K$, and $R_{c}$, do not influence the shift, only the absolute position of the boundary.", "answer": "$$\\boxed{\\lambda \\ln(\\alpha)}$$", "id": "2632318"}, {"introduction": "Many developmental patterns emerge not from static, pre-existing information but from the dynamic, self-organizing interactions of multiple components. This advanced practice guides you through building a computational reaction-diffusion model to simulate the interplay between a morphogen (BMP), its inhibitor (Chordin), and a regulatory protease (Tolloid). Through this hands-on coding exercise, you will see how these molecular interactions can generate a robust dorsal-ventral pattern from initially uniform conditions, providing direct experience with the powerful simulation tools used in modern systems biology [@problem_id:2632435].", "problem": "Consider a one-dimensional dorsal–ventral axis represented by a spatial coordinate $x \\in [0,1]$ along an ectodermal sheet. Neural induction is assumed to occur at positions where free Bone Morphogenetic Protein (BMP) is sufficiently low. Let $B(x,t)$ denote free BMP, $C(x,t)$ denote Chordin, $BC(x,t)$ denote the BMP–Chordin complex, and $T(x,t)$ denote Tolloid. Assume zero-flux (Neumann) boundary conditions for all species at $x=0$ and $x=1$, and initially $B(x,0)=C(x,0)=BC(x,0)=T(x,0)=0$ for all $x$.\n\nStarting from the following foundational principles:\n- Fick’s law of diffusion, which in one dimension yields a diffusion term $D \\frac{\\partial^2 u}{\\partial x^2}$ for any diffusible species $u(x,t)$ with diffusion coefficient $D$.\n- The law of mass action for reversible binding and enzymatic cleavage, which yields reaction terms that are proportional to products of reactant concentrations.\n\nPropose and implement a reaction–diffusion model composed of the following partial differential equations (PDEs), where each term must be derived from the above principles and interpreted biologically:\n- Diffusion for each species with coefficients $D_B$, $D_C$, $D_{BC}$, and $D_T$.\n- Source terms representing spatially localized production of BMP and Chordin and uniform production of Tolloid:\n  - $s_B(x) = s_{B0}\\cdot \\dfrac{1}{2}\\left(1+\\tanh\\left(\\dfrac{x-x_v}{\\sigma}\\right)\\right)$ with $x_v=0.7$ and $\\sigma=0.1$, modeling a ventral-biased BMP source.\n  - $s_C(x) = s_{C0}\\cdot \\dfrac{1}{2}\\left(1+\\tanh\\left(\\dfrac{x_d-x}{\\sigma}\\right)\\right)$ with $x_d=0.3$ and $\\sigma=0.1$, modeling a dorsal-biased Chordin source.\n  - $s_T(x) = s_{T0}$ (uniform), modeling spatially uniform Tolloid production.\n- Reversible binding $B + C \\rightleftharpoons BC$ with forward rate constant $k_{\\text{on}}$ and reverse rate constant $k_{\\text{off}}$.\n- Proteolytic cleavage of $BC$ by Tolloid that releases free BMP, with rate constant $k_{\\text{cleave}}$, and first-order degradation of each species with respective rate constants $k_{\\text{deg},B}$, $k_{\\text{deg},C}$, $k_{\\text{deg},BC}$, and $k_{\\text{deg},T}$.\n\nYour program must discretize space into $N$ points with $N=100$ over length $L=1$, enforce zero-flux boundary conditions, and integrate the resulting semi-discrete system in time until a quasi-steady state at final time $t_{\\text{final}}=10$. All quantities are to be treated as dimensionless (no physical units). Use any numerically stable solver for the resulting system of ordinary differential equations (ODEs), provided it respects the nonnegativity of concentrations.\n\nAfter integrating to $t_{\\text{final}}$, compute, for each test case, the fraction of spatial grid points where the free BMP concentration $B(x,t_{\\text{final}})$ is below a neural induction threshold $\\theta$. This fraction should be returned as a float in $[0,1]$ rounded to three decimal places. No percentages should be used; express the result as a decimal.\n\nUse the following fixed parameter values unless otherwise specified in a test case:\n- Diffusion coefficients: $D_B=1.0\\times 10^{-2}$, $D_C=1.0\\times 10^{-2}$, $D_{BC}=5.0\\times 10^{-3}$, $D_T=5.0\\times 10^{-3}$.\n- Binding and degradation kinetics: $k_{\\text{on}}=50.0$, $k_{\\text{off}}=0.1$, $k_{\\text{deg},B}=0.01$, $k_{\\text{deg},C}=0.01$, $k_{\\text{deg},BC}=0.01$, $k_{\\text{deg},T}=0.01$.\n- Source parameters: $x_v=0.7$, $x_d=0.3$, $\\sigma=0.1$.\n\nImplement the model and compute the required fraction for each of the following test cases, where each case specifies $(s_{B0}, s_{C0}, s_{T0}, k_{\\text{cleave}}, \\theta)$:\n\n- Case $1$ (happy path): $(1.0, 1.0, 0.5, 1.0, 0.1)$.\n- Case $2$ (no Chordin): $(1.0, 0.0, 0.5, 1.0, 0.1)$.\n- Case $3$ (no Tolloid): $(1.0, 1.0, 0.0, 1.0, 0.1)$.\n- Case $4$ (strong Tolloid with reduced BMP): $(0.2, 0.5, 2.0, 1.0, 0.1)$.\n\nYour program should produce a single line of output containing the four results as a comma-separated list enclosed in square brackets, with each float rounded to three decimal places, for example, $[r_1,r_2,r_3,r_4]$.", "solution": "The problem statement is subjected to validation and is found to be valid. It describes a scientifically grounded, well-posed, and objective problem in theoretical developmental biology. The model is based on established principles of reaction-diffusion systems, and all parameters, boundary conditions, and initial conditions are specified, permitting a unique numerical solution. There are no contradictions, ambiguities, or instances of scientific unsoundness.\n\nThe task is to model the spatio-temporal dynamics of a system of four interacting morphogens—Bone Morphogenetic Protein ($B$), Chordin ($C$), the BMP-Chordin complex ($BC$), and Tolloid ($T$)—along a one-dimensional ectodermal sheet represented by the spatial domain $x \\in [0, 1]$. The model is constructed from first principles: Fick's law for diffusion and the law of mass action for chemical reactions.\n\nThe system is described by the following set of coupled partial differential equations (PDEs):\n\n1.  **Free BMP, $B(x,t)$:**\n    The concentration of free BMP changes due to diffusion, a spatially localized source, degradation, reversible binding to Chordin, and release from the $BC$ complex via cleavage by Tolloid.\n    $$ \\frac{\\partial B}{\\partial t} = D_B \\frac{\\partial^2 B}{\\partial x^2} + s_B(x) - k_{\\text{deg},B} B - k_{\\text{on}} B C + k_{\\text{off}} (BC) + k_{\\text{cleave}} T (BC) $$\n    -   $D_B \\frac{\\partial^2 B}{\\partial x^2}$: Diffusion, from Fick's Law.\n    -   $s_B(x)$: Spatially-varying production, localized to the ventral side ($x$ near $0.7$).\n    -   $-k_{\\text{deg},B} B$: First-order degradation.\n    -   $-k_{\\text{on}} B C$: Consumption of free BMP via binding to Chordin, from the law of mass action for $B+C \\to BC$.\n    -   $+k_{\\text{off}} (BC)$: Production of free BMP via dissociation of the complex, for $BC \\to B+C$.\n    -   $+k_{\\text{cleave}} T (BC)$: Production of free BMP via enzymatic cleavage of the complex by Tolloid, where Tolloid acts as a catalyst.\n\n2.  **Free Chordin, $C(x,t)$:**\n    The concentration of free Chordin changes due to diffusion, a spatially localized source, degradation, and reversible binding to BMP.\n    $$ \\frac{\\partial C}{\\partial t} = D_C \\frac{\\partial^2 C}{\\partial x^2} + s_C(x) - k_{\\text{deg},C} C - k_{\\text{on}} B C + k_{\\text{off}} (BC) $$\n    -   Terms are analogous to those for BMP, except for the cleavage term. The problem states that cleavage of $BC$ releases free BMP; we assume the Chordin moiety is inactivated or destroyed in the process and is not returned to the pool of active, free Chordin.\n\n3.  **BMP-Chordin Complex, $BC(x,t)$:**\n    The concentration of the complex changes due to diffusion, its formation from free BMP and Chordin, its dissociation, its cleavage by Tolloid, and its degradation.\n    $$ \\frac{\\partial (BC)}{\\partial t} = D_{BC} \\frac{\\partial^2 (BC)}{\\partial x^2} + k_{\\text{on}} B C - k_{\\text{off}} (BC) - k_{\\text{cleave}} T (BC) - k_{\\text{deg},BC} (BC) $$\n    -   $D_{BC} \\frac{\\partial^2 (BC)}{\\partial x^2}$: Diffusion of the complex.\n    -   $+k_{\\text{on}} B C$: Formation of the complex.\n    -   $-k_{\\text{off}} (BC)$: Dissociation of the complex.\n    -   $-k_{\\text{cleave}} T (BC)$: Destruction of the complex by Tolloid cleavage.\n    -   $-k_{\\text{deg},BC} (BC)$: First-order degradation of the complex.\n\n4.  **Tolloid, $T(x,t)$:**\n    The concentration of Tolloid changes due to diffusion, uniform production, and degradation. It acts as an enzyme and is not consumed in the cleavage reaction.\n    $$ \\frac{\\partial T}{\\partial t} = D_T \\frac{\\partial^2 T}{\\partial x^2} + s_{T0} - k_{\\text{deg},T} T $$\n    -   $D_T \\frac{\\partial^2 T}{\\partial x^2}$: Diffusion of Tolloid.\n    -   $s_{T0}$: Spatially uniform production.\n    -   $-k_{\\text{deg},T} T$: First-order degradation.\n\nTo solve this system numerically, we employ the Method of Lines. Space is discretized into $N=100$ grid points $x_i$ over the interval $[0, 1]$, with spacing $\\Delta x = 1/(N-1)$. This transforms the system of PDEs into a system of $4 \\times N$ coupled ordinary differential equations (ODEs).\n\nThe diffusion term (Laplacian) $\\frac{\\partial^2 u}{\\partial x^2}$ at an interior grid point $x_i$ is approximated using a second-order central difference formula:\n$$ \\left(\\frac{\\partial^2 u}{\\partial x^2}\\right)_i \\approx \\frac{u_{i+1} - 2u_i + u_{i-1}}{(\\Delta x)^2} $$\nThe zero-flux (Neumann) boundary conditions, $\\frac{\\partial u}{\\partial x}|_{x=0} = \\frac{\\partial u}{\\partial x}|_{x=1} = 0$, are enforced by introducing \"ghost points\" such that $u_{-1} = u_1$ and $u_N = u_{N-2}$. This leads to the following approximations at the boundaries:\n$$ \\left(\\frac{\\partial^2 u}{\\partial x^2}\\right)_0 \\approx \\frac{2(u_1 - u_0)}{(\\Delta x)^2} \\quad \\text{and} \\quad \\left(\\frac{\\partial^2 u}{\\partial x^2}\\right)_{N-1} \\approx \\frac{2(u_{N-2} - u_{N-1})}{(\\Delta x)^2} $$\nThe resulting system of ODEs, $\\frac{d\\vec{y}}{dt} = \\vec{f}(t, \\vec{y})$, where $\\vec{y}(t)$ is the flattened vector of all concentrations at all grid points, is initialized with $\\vec{y}(0) = \\vec{0}$. This system is likely stiff due to the different time scales of reaction and diffusion. Therefore, it is integrated from $t=0$ to $t_{\\text{final}}=10$ using a suitable implicit solver, such as the Backward Differentiation Formula (BDF) method, as implemented in `scipy.integrate.solve_ivp`.\n\nAfter integration, the final concentration profile for free BMP, $B(x_i, t_{\\text{final}})$, is extracted. The fraction of the domain corresponding to neural induction is calculated as the number of grid points where $B(x_i, t_{\\text{final}}) < \\theta$, divided by the total number of grid points, $N$. The result for each test case is rounded to three decimal places.", "answer": "```python\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Solves the reaction-diffusion system for ectodermal patterning.\n    \"\"\"\n    \n    # --- Fixed Parameters ---\n    N = 100  # Number of spatial grid points\n    L = 1.0  # Length of the domain\n    x_grid = np.linspace(0, L, N)\n    dx = L / (N - 1)\n    t_final = 10.0\n\n    # Diffusion coefficients\n    D_B = 1.0e-2\n    D_C = 1.0e-2\n    D_BC = 5.0e-3\n    D_T = 5.0e-3\n\n    # Binding and degradation kinetics\n    k_on = 50.0\n    k_off = 0.1\n    k_deg_B = 0.01\n    k_deg_C = 0.01\n    k_deg_BC = 0.01\n    k_deg_T = 0.01\n    \n    # Source shape parameters\n    x_v = 0.7\n    x_d = 0.3\n    sigma = 0.1\n\n    # --- Test Cases ---\n    # Each case is a tuple: (s_B0, s_C0, s_T0, k_cleave, theta)\n    test_cases = [\n        (1.0, 1.0, 0.5, 1.0, 0.1),  # Case 1 (happy path)\n        (1.0, 0.0, 0.5, 1.0, 0.1),  # Case 2 (no Chordin)\n        (1.0, 1.0, 0.0, 1.0, 0.1),  # Case 3 (no Tolloid)\n        (0.2, 0.5, 2.0, 1.0, 0.1),  # Case 4 (strong Tolloid with reduced BMP)\n    ]\n    \n    def ode_system(t, y, p):\n        \"\"\"\n        Defines the system of ODEs for the reaction-diffusion model.\n        \"\"\"\n        # Unpack parameters\n        D_B, D_C, D_BC, D_T, k_on, k_off, k_cleave, k_deg_B, k_deg_C, k_deg_BC, k_deg_T, s_B_vec, s_C_vec, s_T0, N, dx = p\n\n        # Reshape the flattened state vector y into a (4, N) matrix\n        concentrations = y.reshape((4, N))\n        B, C, BC, T = concentrations[0], concentrations[1], concentrations[2], concentrations[3]\n\n        # Initialize derivatives\n        dydt = np.zeros_like(concentrations)\n        dB_dt, dC_dt, dBC_dt, dT_dt = dydt[0], dydt[1], dydt[2], dydt[3]\n\n        # --- Diffusion Terms (Discretized Laplacian with Neumann BCs) ---\n        def laplacian(u, D, dx_val):\n            lap = np.zeros_like(u)\n            # Interior points\n            lap[1:-1] = (u[:-2] - 2 * u[1:-1] + u[2:]) / dx_val**2\n            # Boundary points (zero-flux)\n            lap[0] = 2 * (u[1] - u[0]) / dx_val**2\n            lap[-1] = 2 * (u[-2] - u[-1]) / dx_val**2\n            return D * lap\n\n        dB_dt += laplacian(B, D_B, dx)\n        dC_dt += laplacian(C, D_C, dx)\n        dBC_dt += laplacian(BC, D_BC, dx)\n        dT_dt += laplacian(T, D_T, dx)\n\n        # --- Reaction Terms (pointwise) ---\n        binding = k_on * B * C\n        unbinding = k_off * BC\n        cleavage = k_cleave * T * BC\n        \n        # BMP equation\n        dB_dt += s_B_vec - k_deg_B * B - binding + unbinding + cleavage\n        # Chordin equation\n        dC_dt += s_C_vec - k_deg_C * C - binding + unbinding\n        # BMP-Chordin Complex equation\n        dBC_dt += binding - unbinding - cleavage - k_deg_BC * BC\n        # Tolloid equation\n        dT_dt += s_T0 - k_deg_T * T\n\n        # Return the flattened derivatives\n        return dydt.flatten()\n\n    results = []\n    for case in test_cases:\n        s_B0, s_C0, s_T0, k_cleave, theta = case\n\n        # --- Calculate spatially-varying source terms ---\n        s_B_vec = s_B0 * 0.5 * (1 + np.tanh((x_grid - x_v) / sigma))\n        s_C_vec = s_C0 * 0.5 * (1 + np.tanh((x_d - x_grid) / sigma))\n\n        # --- Package parameters for the solver ---\n        params = (D_B, D_C, D_BC, D_T, k_on, k_off, k_cleave, k_deg_B, k_deg_C, k_deg_BC, k_deg_T, s_B_vec, s_C_vec, s_T0, N, dx)\n\n        # --- Initial Conditions ---\n        y0 = np.zeros(4 * N)\n        \n        # --- Time Integration ---\n        sol = solve_ivp(\n            fun=ode_system,\n            t_span=(0, t_final),\n            y0=y0,\n            method='BDF',\n            args=(params,),\n            t_eval=[t_final]  # Evaluate only at the final time\n        )\n        \n        # --- Post-processing ---\n        final_state = sol.y[:, -1]\n        \n        # Extract final BMP concentration profile\n        B_final = final_state[0:N]\n        \n        # Ensure non-negativity from numerical artifacts\n        B_final[B_final < 0] = 0\n        \n        # Calculate the fraction of grid points below the threshold\n        neural_domain_count = np.sum(B_final < theta)\n        fraction = neural_domain_count / N\n        \n        # Round and store the result\n        results.append(round(fraction, 3))\n        \n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2632435"}]}