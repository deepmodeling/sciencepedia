{"hands_on_practices": [{"introduction": "Understanding how hematopoietic stem cells emerge begins at the cell surface, where external cues are first received. This exercise focuses on the c-Kit receptor, a critical player in this process, and asks you to apply fundamental biophysical principles to quantify the initial signaling event. By calculating receptor occupancy and the resulting signal flux based on the law of mass action, you will build a foundational quantitative intuition for how ligand concentration translates into a cellular response [@problem_id:2641382].", "problem": "In hemogenic endothelium during embryonic hematopoiesis, signaling by the c-Kit receptor tyrosine kinase depends on the fraction of receptors occupied by the soluble ligand Stem Cell Factor and the per-occupied-receptor production of a downstream signaling intermediate. Assume the following experimentally plausible conditions and parameters for a single hemogenic endothelial cell bathed in a well-stirred extracellular medium:\n- Ligand concentration: $L = 50\\,\\text{nM}$.\n- Dissociation constant of the receptor–ligand interaction: $K_d = 5\\,\\text{nM}$, defined by the equilibrium relation $K_d = [R][L]/[RL]$ under the law of mass action, where $[R]$ is the concentration of unbound receptors, $[L]$ is the free ligand concentration in solution, and $[RL]$ is the concentration of receptor–ligand complex.\n- Receptor surface density on the cell: $\\rho_R = 20\\,\\text{receptors}\\,\\mu\\text{m}^{-2}$.\n- Effective membrane area exposed to the medium: $A = 800\\,\\mu\\text{m}^2$.\n- Per-occupied-receptor signaling production rate of a downstream intermediate: $k_{\\text{sig}} = 0.05\\,\\text{s}^{-1}$.\n\nAssume that the extracellular medium is sufficiently large that $L$ represents the free ligand concentration at the membrane (i.e., ligand depletion by binding is negligible), and that receptor–ligand binding reaches equilibrium rapidly relative to downstream signaling.\n\nUsing only the law of mass action and the definition of the dissociation constant, derive from first principles the steady-state fractional occupancy $\\theta$ of c-Kit and use it to compute the total steady-state downstream signaling flux $F$ for the cell, defined as the total production rate of the downstream intermediate:\n- First, compute the fractional occupancy $\\theta$ of receptors by ligand at steady state.\n- Then, compute the total receptor number $N_R$ on the cell, the number of occupied receptors $N_{\\text{occ}}$, and finally the signaling flux $F = k_{\\text{sig}}\\,N_{\\text{occ}}$.\n\nExpress the fractional occupancy $\\theta$ as a dimensionless fraction and the signaling flux $F$ in molecules per second per cell. Round both numerical results to four significant figures. Provide your final numerical results in the order $\\theta$, $F$.", "solution": "The appropriate starting point is the law of mass action applied to receptor–ligand binding at equilibrium. Let $R$ denote free receptors, $L$ the free ligand, and $RL$ the receptor–ligand complex. The binding reaction is $R + L \\rightleftharpoons RL$. At equilibrium, the dissociation constant is defined by\n$$\nK_d \\equiv \\frac{[R][L]}{[RL]}.\n$$\nDefine the total receptor amount (per cell) as $R_T \\equiv [R] + [RL]$. The fractional occupancy is the fraction of receptors that are ligand-bound:\n$$\n\\theta \\equiv \\frac{[RL]}{R_T}.\n$$\nWe aim to express $\\theta$ in terms of $L$ and $K_d$. Solve the $K_d$ definition for $[RL]$ in terms of $[R]$:\n$$\n[RL] = \\frac{[R][L]}{K_d}.\n$$\nSubstitute $[R] = R_T - [RL]$:\n$$\n[RL] = \\frac{(R_T - [RL])\\,L}{K_d}.\n$$\nRearrange to collect $[RL]$ terms on the left side:\n$$\n[RL]\\left(1 + \\frac{L}{K_d}\\right) = \\frac{R_T\\,L}{K_d}.\n$$\nSolve for $[RL]$:\n$$\n[RL] = \\frac{R_T\\,L}{K_d + L}.\n$$\nDivide both sides by $R_T$ to obtain the fractional occupancy:\n$$\n\\theta = \\frac{[RL]}{R_T} = \\frac{L}{K_d + L}.\n$$\nThis expression depends only on $L$ and $K_d$, and it is valid provided $L$ denotes the free ligand concentration. Under the stated assumption of a large, well-stirred bath, the given $L$ equals the free ligand concentration.\n\nInsert the given values $L = 50\\,\\text{nM}$ and $K_d = 5\\,\\text{nM}$:\n$$\n\\theta = \\frac{50}{5 + 50} = \\frac{50}{55} = \\frac{10}{11}.\n$$\nNumerically,\n$$\n\\theta = \\frac{10}{11} \\approx 0.909090\\ldots\n$$\n\nNext compute the total number of receptors on the cell. With receptor surface density $\\rho_R$ and exposed area $A$,\n$$\nN_R = \\rho_R \\, A = \\left(20\\,\\text{receptors}\\,\\mu\\text{m}^{-2}\\right)\\left(800\\,\\mu\\text{m}^2\\right) = 16000\\,\\text{receptors}.\n$$\nThe number of occupied receptors is\n$$\nN_{\\text{occ}} = \\theta\\,N_R = \\left(\\frac{10}{11}\\right)\\left(16000\\right) = \\frac{160000}{11} \\approx 14545.4545\\ldots\n$$\nThe downstream signaling flux, defined as the production rate of the signaling intermediate due to occupied receptors, is\n$$\nF = k_{\\text{sig}}\\,N_{\\text{occ}} = \\left(0.05\\,\\text{s}^{-1}\\right)\\left(\\frac{160000}{11}\\right) = \\frac{8000}{11}\\,\\text{s}^{-1}.\n$$\nNumerically,\n$$\nF \\approx 727.2727\\ldots\\,\\text{molecules}\\,\\text{s}^{-1}\\,\\text{cell}^{-1}.\n$$\n\nRound both quantities to four significant figures:\n- $\\theta \\approx 0.9091$ (dimensionless).\n- $F \\approx 727.3\\,\\text{molecules}\\,\\text{s}^{-1}\\,\\text{cell}^{-1}$.\n\nThese results follow directly from the law of mass action and the dissociation constant definition, together with the receptor census of the cell and the per-occupied-receptor signaling rate constant.", "answer": "$$\\boxed{\\begin{pmatrix}0.9091  727.3\\end{pmatrix}}$$", "id": "2641382"}, {"introduction": "Once signals are received, they are processed by internal gene regulatory networks that ultimately drive cell fate decisions. This practice explores the classic GATA1-PU.1 'toggle switch,' a circuit defined by mutual repression that is central to the myeloid versus erythroid lineage choice. By building a computational model of this network, you will explore how its dynamics can lead to bistability—the existence of two stable states corresponding to distinct cell fates—and learn to predict lineage commitment from the system's parameters [@problem_id:2641340].", "problem": "Hematopoietic stem cells (HSCs) commit to erythroid or myeloid lineages under the influence of two key transcription factors, GATA1 and PU.1, which mutually repress each other’s expression and can also auto-activate their own expression. Starting from the Central Dogma of Molecular Biology, which states that DNA is transcribed to RNA and translated to protein, and from the well-tested observation that transcription factor regulation of promoters can be captured by sigmoidal Hill functions, formalize a dimensionless Ordinary Differential Equation (ODE) model for the mutual antagonism circuit GATA1–PU.1. Use this model to algorithmically predict whether the system is bistable and to infer lineage commitment outcomes under specified parameter sets.\n\nBase definitions and constraints to be used:\n- Let $G(t)$ denote the dimensionless concentration of GATA1 protein at time $t$ in arbitrary expression units, and $P(t)$ denote the dimensionless concentration of PU.1 protein at time $t$ in the same units. All concentrations are nonnegative real numbers.\n- Define the activation Hill function $H_{\\mathrm{act}}(x;n)$ by $H_{\\mathrm{act}}(x;n) = \\dfrac{x^{n}}{1 + x^{n}}$ for $x \\ge 0$ and Hill coefficient $n \\ge 1$.\n- Define the repression Hill function $H_{\\mathrm{rep}}(y;K,m)$ by $H_{\\mathrm{rep}}(y;K,m) = \\dfrac{1}{1 + \\left(\\dfrac{y}{K}\\right)^{m}}$ for $y \\ge 0$, dissociation constant $K  0$, and Hill coefficient $m \\ge 1$.\n- Assume dimensionless synthesis and decay dynamics governed by the following mechanistic composition: synthesis of each protein equals a maximal synthesis rate multiplied by the product of a basal term plus an auto-activation term and a repression term from the opposing factor; first-order decay is proportional to the concentration.\n\nYour task is to:\n- Derive and implement the following ODEs, justified by the base definitions above:\n$$\n\\frac{dG}{dt} = s_G \\left( b_G + a_G \\, H_{\\mathrm{act}}(G; n_G) \\right) \\, H_{\\mathrm{rep}}(P; K_{PG}, m_{PG}) - d_G \\, G,\n$$\n$$\n\\frac{dP}{dt} = s_P \\left( b_P + a_P \\, H_{\\mathrm{act}}(P; n_P) \\right) \\, H_{\\mathrm{rep}}(G; K_{GP}, m_{GP}) - d_P \\, P,\n$$\nwhere $s_G, s_P  0$ are synthesis scale factors, $b_G, b_P \\ge 0$ are basal transcriptional terms, $a_G, a_P \\ge 0$ are auto-activation gains, $d_G, d_P  0$ are first-order decay rates, $n_G, n_P \\ge 1$ are activation Hill coefficients, $m_{PG}, m_{GP} \\ge 1$ are repression Hill coefficients, and $K_{PG}, K_{GP}  0$ are repression dissociation constants. All parameters are dimensionless. Gene expression units are arbitrary and dimensionless by construction; no physical units are required.\n- For each specified parameter set, determine attractors by numerically integrating the ODEs from a grid of initial conditions and clustering the long-time states. Use a uniform square grid of initial conditions $(G(0), P(0))$ spanning $[0, G_{\\max}] \\times [0, P_{\\max}]$ with $G_{\\max} = P_{\\max} = 4$ and $9 \\times 9$ evenly spaced grid points (including endpoints). Integrate from $t = 0$ to $t = T$ with $T = 200$ using any standard ODE solver of your choice. Treat the state at $t = T$ as the terminal state for each initial condition. Cluster terminal states into distinct attractors by grouping states whose Euclidean distance is less than $\\varepsilon = 10^{-3}$. The total number of distinct clusters is the number of distinct attractors.\n- Classify lineage outcome for each parameter set as a single integer code according to the following rule evaluated on the final states’ distinct attractor centroids:\n    - Return $3$ if there are at least $2$ distinct attractors (bistable regime, corresponding to alternative fates).\n    - If there is exactly $1$ distinct attractor, compute the ratio $R = \\dfrac{G^{\\ast}}{P^{\\ast} + 10^{-9}}$, where $(G^{\\ast}, P^{\\ast})$ is the unique attractor centroid and $10^{-9}$ is a small stabilizer to avoid division by zero. Let the decision threshold be $\\theta = 1.5$. Return $1$ if $R  \\theta$ (GATA1-high, erythroid-like commitment), return $2$ if $R  \\dfrac{1}{\\theta}$ (PU.1-high, myeloid-like commitment), otherwise return $0$ (co-expression single attractor).\n- The program must be deterministic and must not use any randomness.\n\nTest suite:\nImplement your program to evaluate exactly the following four parameter sets and output the classification code for each, in the order listed.\n- Test A (symmetric, strong mutual repression and auto-activation; expected bistability): $s_G = 1$, $s_P = 1$, $d_G = 1$, $d_P = 1$, $b_G = 0.02$, $b_P = 0.02$, $a_G = 6$, $a_P = 6$, $n_G = 2$, $n_P = 2$, $m_{PG} = 4$, $m_{GP} = 4$, $K_{PG} = 1$, $K_{GP} = 1$.\n- Test B (asymmetric, GATA1-favored): $s_G = 1.2$, $s_P = 0.7$, $d_G = 1$, $d_P = 1$, $b_G = 0.02$, $b_P = 0.02$, $a_G = 6$, $a_P = 2$, $n_G = 2$, $n_P = 2$, $m_{PG} = 4$, $m_{GP} = 4$, $K_{PG} = 1$, $K_{GP} = 1$.\n- Test C (asymmetric, PU.1-favored): $s_G = 0.7$, $s_P = 1.2$, $d_G = 1$, $d_P = 1$, $b_G = 0.02$, $b_P = 0.02$, $a_G = 2$, $a_P = 6$, $n_G = 2$, $n_P = 2$, $m_{PG} = 4$, $m_{GP} = 4$, $K_{PG} = 1$, $K_{GP} = 1$.\n- Test D (weak repression, modest auto-activation; expected single co-expression attractor): $s_G = 1$, $s_P = 1$, $d_G = 1$, $d_P = 1$, $b_G = 0.2$, $b_P = 0.2$, $a_G = 1$, $a_P = 1$, $n_G = 2$, $n_P = 2$, $m_{PG} = 1$, $m_{GP} = 1$, $K_{PG} = 1$, $K_{GP} = 1$.\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order [Test A, Test B, Test C, Test D]. For example, a valid output could look like [$3$,$1$,$2$,$0$]. The outputs are integers with no units, as the model is dimensionless by construction.", "solution": "The problem statement has been subjected to rigorous validation and is deemed valid. It is scientifically grounded in the principles of molecular and systems biology, mathematically well-posed, and specified with sufficient detail and clarity to permit a unique, objective, and verifiable solution. All required parameters, equations, and numerical procedures are provided without ambiguity or contradiction. We shall, therefore, proceed with the formal derivation and computational solution.\n\nThe problem requires the formalization and analysis of a dynamical system modeling the gene regulatory network of two transcription factors, GATA1 and PU.1, denoted by concentrations $G(t)$ and $P(t)$ respectively. The dynamics are based on the Central Dogma, where protein concentration changes as a balance of synthesis and decay.\n\nThe rate of change of a protein concentration, for instance $G(t)$, is given by the difference between its synthesis rate and its decay rate:\n$$\n\\frac{dG}{dt} = \\text{Synthesis Rate}_G - \\text{Decay Rate}_G\n$$\nAccording to the problem, decay is a first-order process, meaning the rate is proportional to the current concentration.\n$$\n\\text{Decay Rate}_G = d_G \\, G\n$$\nwhere $d_G  0$ is the decay rate constant.\n\nThe synthesis rate is described as a product of a maximal synthesis rate $s_G  0$, a term for transcriptional activation, and a term for transcriptional repression.\n$$\n\\text{Synthesis Rate}_G = s_G \\times (\\text{Activation Term}) \\times (\\text{Repression Term})\n$$\nThe activation term combines a basal (leaky) expression component, $b_G \\ge 0$, and an auto-activation component, where GATA1 enhances its own transcription. This auto-activation is modeled by the activating Hill function $H_{\\mathrm{act}}(G; n_G)$ multiplied by a gain factor $a_G \\ge 0$. The total activation term is thus:\n$$\n\\text{Activation Term} = b_G + a_G \\, H_{\\mathrm{act}}(G; n_G) = b_G + a_G \\, \\frac{G^{n_G}}{1 + G^{n_G}}\n$$\nGATA1 synthesis is repressed by PU.1. This is captured by the repressive Hill function $H_{\\mathrm{rep}}(P; K_{PG}, m_{PG})$.\n$$\n\\text{Repression Term} = H_{\\mathrm{rep}}(P; K_{PG}, m_{PG}) = \\frac{1}{1 + \\left(\\frac{P}{K_{PG}}\\right)^{m_{PG}}}\n$$\nCombining these components yields the full differential equation for $G(t)$:\n$$\n\\frac{dG}{dt} = s_G \\left( b_G + a_G \\, \\frac{G^{n_G}}{1 + G^{n_G}} \\right) \\left( \\frac{1}{1 + \\left(\\frac{P}{K_{PG}}\\right)^{m_{PG}}} \\right) - d_G \\, G\n$$\nThis is precisely the first equation provided in the problem statement. By symmetry of logic, applying the same principles for the protein PU.1, which is auto-activated and repressed by GATA1, we derive the second equation:\n$$\n\\frac{dP}{dt} = s_P \\left( b_P + a_P \\, \\frac{P^{n_P}}{1 + P^{n_P}} \\right) \\left( \\frac{1}{1 + \\left(\\frac{G}{K_{GP}}\\right)^{m_{GP}}} \\right) - d_P \\, P\n$$\nThe system of two coupled ordinary differential equations (ODEs) is thus justified.\n\nThe numerical solution will be implemented following the exact procedure specified.\n1.  **Define the ODE System**: The right-hand side of the ODE system will be implemented as a function `dY/dt = f(t, Y, params)`, where $Y = [G, P]$ is the state vector and `params` is a dictionary containing all $14$ model parameters.\n2.  **Generate Initial Conditions**: A uniform grid of $9 \\times 9 = 81$ initial conditions $(G(0), P(0))$ will be generated over the square domain $[0, 4] \\times [0, 4]$. The `numpy.linspace` function is suitable for this purpose, generating endpoints inclusive.\n3.  **Numerical Integration**: For each initial condition, the ODE system will be integrated from $t=0$ to $t=200$. The `scipy.integrate.solve_ivp` function will be used, as it provides a robust and accurate method for solving initial value problems. The state of the system at the final time, $Y(200) = [G(200), P(200)]$, will be stored as the terminal state.\n4.  **Clustering of Terminal States**: The $81$ terminal states will be clustered to identify the distinct attractors. The specified clustering rule is to group states with a Euclidean distance of less than $\\varepsilon = 10^{-3}$. This will be implemented by treating the terminal states as nodes in a graph, where an edge exists between two nodes if their Euclidean distance is less than $\\varepsilon$. The clusters are then the connected components of this graph. A Breadth-First Search (BFS) algorithm will be used to find these components deterministically. To ensure determinism, the list of terminal states will be sorted lexicographically before clustering begins. After partitioning the states into clusters, the centroid of each cluster (the mean of all points within it) is calculated.\n5.  **Classification of Outcome**: The number and location of the attractor centroids determine the lineage outcome code.\n    - If the number of attractors is $2$ or more, the system is bistable, and the code is $3$.\n    - If there is exactly $1$ attractor with centroid $(G^{\\ast}, P^{\\ast})$, the ratio $R = \\frac{G^{\\ast}}{P^{\\ast} + 10^{-9}}$ is computed. The outcome is determined by comparing $R$ to the threshold $\\theta = 1.5$:\n        - Code $1$ (GATA1-high) if $R  \\theta$.\n        - Code $2$ (PU.1-high) if $R  1/\\theta$.\n        - Code $0$ (co-expression) otherwise.\n\nThis complete algorithm will be applied to each of the four specified parameter sets to generate the final output.", "answer": "```python\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for the given test cases.\n    It defines the parameter sets and calls the solver for each case.\n    \"\"\"\n\n    test_cases = [\n        # Test A: symmetric, strong mutual repression and auto-activation\n        {\n            \"s_G\": 1.0, \"s_P\": 1.0, \"d_G\": 1.0, \"d_P\": 1.0,\n            \"b_G\": 0.02, \"b_P\": 0.02, \"a_G\": 6.0, \"a_P\": 6.0,\n            \"n_G\": 2.0, \"n_P\": 2.0, \"m_PG\": 4.0, \"m_GP\": 4.0,\n            \"K_PG\": 1.0, \"K_GP\": 1.0\n        },\n        # Test B: asymmetric, GATA1-favored\n        {\n            \"s_G\": 1.2, \"s_P\": 0.7, \"d_G\": 1.0, \"d_P\": 1.0,\n            \"b_G\": 0.02, \"b_P\": 0.02, \"a_G\": 6.0, \"a_P\": 2.0,\n            \"n_G\": 2.0, \"n_P\": 2.0, \"m_PG\": 4.0, \"m_GP\": 4.0,\n            \"K_PG\": 1.0, \"K_GP\": 1.0\n        },\n        # Test C: asymmetric, PU.1-favored\n        {\n            \"s_G\": 0.7, \"s_P\": 1.2, \"d_G\": 1.0, \"d_P\": 1.0,\n            \"b_G\": 0.02, \"b_P\": 0.02, \"a_G\": 2.0, \"a_P\": 6.0,\n            \"n_G\": 2.0, \"n_P\": 2.0, \"m_PG\": 4.0, \"m_GP\": 4.0,\n            \"K_PG\": 1.0, \"K_GP\": 1.0\n        },\n        # Test D: weak repression, modest auto-activation\n        {\n            \"s_G\": 1.0, \"s_P\": 1.0, \"d_G\": 1.0, \"d_P\": 1.0,\n            \"b_G\": 0.2, \"b_P\": 0.2, \"a_G\": 1.0, \"a_P\": 1.0,\n            \"n_G\": 2.0, \"n_P\": 2.0, \"m_PG\": 1.0, \"m_GP\": 1.0,\n            \"K_PG\": 1.0, \"K_GP\": 1.0\n        }\n    ]\n\n    results = [run_simulation_and_classify(params) for params in test_cases]\n    print(f\"[{','.join(map(str, results))}]\")\n\ndef h_act(x, n):\n    \"\"\"Activation Hill function.\"\"\"\n    return (x**n) / (1.0 + x**n)\n\ndef h_rep(y, K, m):\n    \"\"\"Repression Hill function.\"\"\"\n    return 1.0 / (1.0 + (y / K)**m)\n\ndef ode_system(t, y, p):\n    \"\"\"\n    Defines the system of ODEs for GATA1-PU.1 mutual antagonism.\n    y: state vector [G, P]\n    p: dictionary of parameters\n    \"\"\"\n    G, P = y[0], y[1]\n\n    dG_dt = p[\"s_G\"] * (p[\"b_G\"] + p[\"a_G\"] * h_act(G, p[\"n_G\"])) * h_rep(P, p[\"K_PG\"], p[\"m_PG\"]) - p[\"d_G\"] * G\n    dP_dt = p[\"s_P\"] * (p[\"b_P\"] + p[\"a_P\"] * h_act(P, p[\"n_P\"])) * h_rep(G, p[\"K_GP\"], p[\"m_GP\"]) - p[\"d_P\"] * P\n\n    return [dG_dt, dP_dt]\n\ndef cluster_states(terminal_states, epsilon):\n    \"\"\"\n    Clusters terminal states using a connected components algorithm.\n    Nodes are states, an edge exists if Euclidean distance  epsilon.\n    \"\"\"\n    # Sort points for deterministic behavior\n    sorted_states = sorted(terminal_states, key=lambda p: (p[0], p[1]))\n    n_states = len(sorted_states)\n    assigned = [False] * n_states\n    clusters = []\n\n    for i in range(n_states):\n        if not assigned[i]:\n            # Start a new cluster using Breadth-First Search (BFS)\n            new_cluster_indices = []\n            queue = [i]\n            assigned[i] = True\n            \n            head = 0\n            while head  len(queue):\n                current_idx = queue[head]\n                head += 1\n                new_cluster_indices.append(current_idx)\n\n                # Find all unassigned neighbors\n                p1 = np.array(sorted_states[current_idx])\n                for j in range(n_states):\n                    if not assigned[j]:\n                        p2 = np.array(sorted_states[j])\n                        dist = np.linalg.norm(p1 - p2)\n                        if dist  epsilon:\n                            assigned[j] = True\n                            queue.append(j)\n            \n            clusters.append([sorted_states[k] for k in new_cluster_indices])\n            \n    # Calculate centroids for each cluster\n    centroids = [np.mean(c, axis=0) for c in clusters]\n    return centroids\n\ndef classify_attractors(centroids):\n    \"\"\"\n    Classifies the system outcome based on the number and position of attractors.\n    \"\"\"\n    num_attractors = len(centroids)\n    \n    if num_attractors = 2:\n        return 3  # Bistable\n\n    if num_attractors == 1:\n        G_star, P_star = centroids[0]\n        ratio = G_star / (P_star + 1e-9)\n        threshold = 1.5\n        \n        if ratio  threshold:\n            return 1  # GATA1-high\n        elif ratio  1.0 / threshold:\n            return 2  # PU.1-high\n        else:\n            return 0  # Co-expression\n    \n    # Should not be reached with the given problem setup\n    return -1 # Error code\n\ndef run_simulation_and_classify(params):\n    \"\"\"\n    Runs the full simulation and classification pipeline for a single parameter set.\n    \"\"\"\n    # 1. Setup grid of initial conditions\n    G_max, P_max = 4.0, 4.0\n    grid_size = 9\n    g_initial = np.linspace(0, G_max, grid_size)\n    p_initial = np.linspace(0, P_max, grid_size)\n    initial_conditions = np.array(np.meshgrid(g_initial, p_initial)).T.reshape(-1, 2)\n    \n    # 2. Integrate ODEs for each initial condition\n    t_span = (0, 200)\n    terminal_states = []\n    for y0 in initial_conditions:\n        sol = solve_ivp(\n            fun=ode_system, \n            t_span=t_span, \n            y0=y0, \n            args=(params,), \n            method='RK45', \n            dense_output=True\n        )\n        terminal_states.append(sol.y[:, -1])\n        \n    # 3. Cluster terminal states to find attractors\n    epsilon = 1e-3\n    attractor_centroids = cluster_states(terminal_states, epsilon)\n    \n    # 4. Classify outcome\n    return classify_attractors(attractor_centroids)\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "2641340"}, {"introduction": "Modern developmental biology relies heavily on single-cell genomics to map cellular trajectories, but these powerful techniques come with significant interpretive challenges. This exercise places you in the role of a computational biologist who has inferred a lineage bifurcation and must now critically evaluate this finding. You will learn to identify common artifacts in single-cell data and design the rigorous, gold-standard lineage tracing experiments required to distinguish a true developmental branch from a misleading correlation [@problem_id:2641398].", "problem": "You are analyzing single-cell RNA sequencing (scRNA-seq) from the aorta-gonad-mesonephros (AGM) region of mouse embryos at embryonic day $10.5$, aiming to resolve how hemogenic endothelium transitions into hematopoietic stem cells (HSCs) and other blood lineages through endothelial-to-hematopoietic transition (EHT). Your computational pipeline infers a bifurcation from hemogenic endothelium into two fates that you tentatively label as lympho-myeloid and erythroid. The dataset comprises dissociated AGM cells collected at two adjacent time points, embryonic day $10.0$ and $10.5$, from multiple litters, sequenced in multiple batches, and includes endothelial, hemogenic endothelial, pre-HSC, erythroid-myeloid progenitor, and rare mature erythroid cells. Pseudotime analysis with diffusion maps suggests a branch point, and RNA velocity supports a direction from endothelium toward both putative fates. However, principal component $1$ is heavily loaded on cell-cycle genes, and batch/time point identity correlates with the inferred branch assignment.\n\nUsing only fundamental principles and core definitions in developmental biology and statistical inference, evaluate potential pitfalls in declaring a true developmental bifurcation and propose experimental strategies that can causally validate lineage relationships and directionality. Your reasoning should build from: (i) the Central Dogma of Molecular Biology (DNA to RNA to protein) implying that cell states are, in part, reflected in transcriptional profiles; (ii) gene regulatory networks as dynamical systems that can have attractor states and bifurcations when parameters change; (iii) the fact that scRNA-seq provides snapshots that encode distributions over states but not direct causality; and (iv) basic statistical dependence concepts such as Bayes’ rule, correlation, and mutual information.\n\nWhich option(s) best identify major pitfalls in inferring a bifurcation from these data and outline scientifically rigorous, orthogonal experimental validations that specifically test the inferred branch identities and directions in the AGM context?\n\nA. Recognize that an apparent transcriptional “branch” can be induced by cell-cycle heterogeneity and batch/time confounding rather than fate choice. Specifically: if principal components are dominated by $G_1/S$ and $G_2/M$ programs, then variation along pseudotime can reflect oscillatory cell-cycle position, and if fate labels $F$ are statistically associated with batch $B$ even after conditioning on pseudotime $t$ (i.e., conditional mutual information $I(F;B \\mid t) \\gt 0$), then batch or time sampling may be driving the “bifurcation.” Additionally, RNA velocity relies on a kinetic model $\\frac{du}{dt} = \\alpha - \\beta u, \\frac{ds}{dt} = \\beta u - \\gamma s$ with approximately constant $\\alpha, \\beta, \\gamma$ across neighborhoods; violation of these assumptions across endothelial and hematopoietic states can misorient arrows. Finally, erythroid-like cells in AGM dissociations can include yolk sac-derived erythroid-myeloid progenitors seeded earlier, creating a mixture. Validate by: regressing out cell-cycle scores before trajectory inference and recomputing topology; testing $I(F;B \\mid t)$ and rerunning with batch-balanced graphs; refitting gene-specific splicing kinetics to check velocity assumptions; and functionally, performing temporally controlled, low-dose VE-Cadherin (Cdh5)-CreERT2 induction at embryonic day $9.5$ to clonally label hemogenic endothelium, followed by clonal lineage tracing and single-cell multi-omic readout over a time course to see whether labeled clones contribute to both branches; complement with ex vivo live imaging of EHT from AGM explants, timed Notch perturbation before the putative branch, and in vivo transplantation of labeled HSCs to test multipotency.\n\nB. Attribute the putative bifurcation primarily to insufficient sequencing depth and solve it by resequencing to higher reads per cell and re-running pseudotime and velocity, reasoning that deeper data will remove artifacts, with no additional validation required.\n\nC. Assume that a bifurcation must exist because Waddington’s landscape metaphor implies universal branching; validate by bulk RNA sequencing and computational simulation of gene regulatory networks alone without lineage labeling, transplantation, or live imaging.\n\nD. Conclude that both inferred branches necessarily originate from AGM hemogenic endothelium; validate by sorting c-Kit$^+$ cells at embryonic day $10.5$ and performing colony-forming unit assays in vitro as definitive proof of lineage relationships, without time-resolved in vivo lineage tracing or attention to potential yolk sac progenitor contamination.\n\nE. Identify that directionality is not identifiable from snapshots without additional structure: $P(F \\mid X) = \\sum_{t} P(F \\mid t) P(t \\mid X)$ shows that fate assignment given expression $X$ marginalizes over unobserved time $t$, so without a causal prior on $t$ the arrow of time is ambiguous. Note that RNA velocity’s direction depends on gene-wise kinetics that may shift across states; and that time point and batch act as confounders if $I(F;B) \\gg 0$. Recognize that erythroid-like AGM cells could be yolk sac-derived earlier than AGM HSC emergence. Validate by initiating inducible lineage barcoding specifically in VE-Cadherin$^+$/Endomucin$^+$/Runx1$^+$ endothelial cells in a defined embryonic day $9.25$–$9.75$ window, using CRISPR-based cumulative barcoding to generate unique clonal marks, then performing single-cell multi-omic profiling across embryonic day $10.0$–$11.5$ to read out clonal fate sharing and chromatin priming; test directionality by live imaging of EHT and by temporally controlled Notch pathway perturbation just before the inferred branch; control for confounding by computing conditional mutual information $I(F;B \\mid t)$ and by fitting and testing gene-specific RNA velocity kinetics. Include in vivo transplantation of barcode-labeled putative HSCs to verify self-renewal and multipotency.\n\nSelect all that apply.", "solution": "The problem statement is a valid and well-posed challenge in computational and developmental biology. It presents a realistic scenario where computational analysis of single-cell RNA sequencing (scRNA-seq) data suggests a developmental bifurcation, but also provides several critical red flags that call this inference into question. The task is to identify these pitfalls and propose rigorous experimental validation strategies. The problem is scientifically grounded, objective, and contains sufficient information for a critical evaluation.\n\nThe central scientific challenge is to distinguish a true biological lineage bifurcation from artifacts arising from confounding variables. The provided data and observations point to several potential pitfalls:\n$1$. **Cell-Cycle Confounding**: The statement that principal component $1$ (PC$1$) is heavily loaded on cell-cycle genes is a major warning. Variation in gene expression due to a cell's position in the cell cycle ($G_1$, $S$, $G_2$/$M$ phases) can create strong artefactual structure in dimensionality reduction plots. If cells in the two putative branches are systematically in different phases of the cell cycle, a pseudotime algorithm might incorrectly order them, creating the appearance of a branch that merely separates cycling from non-cycling cells, or $G_1$/$S$ from $G_2$/$M$ cells. A true fate decision should be orthogonal to cell-cycle status.\n$2$. **Batch and Time Point Confounding**: The correlation of batch/time point identity with the inferred branch assignment is another severe issue. This suggests that the \"bifurcation\" might be an artifact of technical variation between sequencing batches or biological variation between the two time points ($E10.0$ and $E10.5$). For instance, if batch $1$ contained more erythroid-like cells and batch $2$ contained more lympho-myeloid-like cells for purely technical reasons, an algorithm could partition them into two branches. Statistically, if $F$ is the fate label, $B$ is the batch/time label, and $t$ is the developmental pseudotime, a significant conditional mutual information $I(F; B \\mid t)  0$ indicates that batch and fate are not independent even for cells at the same developmental stage, which is strong evidence for confounding.\n$3$. **Contamination from an Alternate Source**: The AGM is the site of definitive hematopoietic stem cell (HSC) emergence, but it is not the only source of hematopoietic cells in the embryo at this stage. Primitive hematopoiesis, primarily erythroid, originates in the yolk sac from $E7.5$ onwards, and these cells enter circulation. It is highly plausible that dissociated AGM tissue at $E10.5$ is contaminated with circulating yolk sac-derived erythroid progenitors. The inferred \"erythroid\" branch might therefore represent a distinct cell population with a different origin, not a fate decision from AGM hemogenic endothelium. This would be a biological mixture, not a developmental bifurcation.\n$4$. **Limitations of RNA Velocity**: RNA velocity infers directionality by modeling the kinetics of pre-mRNA (unspliced, $u$) and mRNA (spliced, $s$). The standard model assumes that the rates of transcription ($\\alpha$), splicing ($\\beta$), and degradation ($\\gamma$) are approximately constant for a given gene in a local neighborhood of cells. However, during a major cell state transition like EHT, these rates can change dramatically as the entire gene regulatory network is rewired. If the model's assumptions are violated, the inferred velocity vectors can be unreliable or even point in the wrong direction.\n\nA rigorous validation must establish causality and clonality, and must use methods orthogonal to transcriptomic similarity. **Causality** requires demonstrating that progenitor cells differentiate into a specific fate over time. **Clonality** requires demonstrating that a single progenitor cell can give rise to both daughter lineages at a bifurcation point.\n\nNow, I will evaluate each option.\n\n**A. Recognize that an apparent transcriptional “branch” can be induced by cell-cycle heterogeneity and batch/time confounding rather than fate choice. [...]. Validate by: regressing out cell-cycle scores before trajectory inference [...]; testing $I(F;B \\mid t)$ and rerunning with batch-balanced graphs; refitting gene-specific splicing kinetics to check velocity assumptions; and functionally, performing temporally controlled, low-dose VE-Cadherin (Cdh5)-CreERT$2$ induction at embryonic day $9.5$ to clonally label hemogenic endothelium, followed by clonal lineage tracing [...] ex vivo live imaging [...] timed Notch perturbation [...] and in vivo transplantation [...].**\n\nThis option is exceptionally thorough and correct.\n- **Pitfall Identification**: It correctly identifies all the major potential pitfalls: cell cycle, batch effects (formalized rigorously with conditional mutual information $I(F;B \\mid t)$), RNA velocity model violations, and contamination by yolk sac-derived cells. Each point is a valid and critical concern.\n- **Validation Strategy**: The proposed validation plan is the gold standard in developmental biology.\n    - Correcting for computational artifacts (regressing out cell cycle, using batch-balanced graphs, testing velocity kinetics) is the necessary first step.\n    - Clonal lineage tracing using `Cdh5-CreERT2` is the definitive method to test if a single hemogenic endothelial cell can give rise to both proposed lineages. The timing ($E9.5$) and low-dose induction are correctly specified to achieve clonality before the main EHT event.\n    - Live imaging provides direct, dynamic visualization of the process, an orthogonal source of evidence.\n    - Perturbation experiments (timed Notch inhibition/activation) are a powerful causal test of the role of a key signaling pathway in the fate decision.\n    - In vivo transplantation is the non-negotiable functional definition of a true, multipotent HSC.\nThis option comprehensively addresses the problem with impeccable scientific logic.\n**Verdict: Correct**\n\n**B. Attribute the putative bifurcation primarily to insufficient sequencing depth and solve it by resequencing to higher reads per cell and re-running pseudotime and velocity, reasoning that deeper data will remove artifacts, with no additional validation required.**\n\nThis option is fundamentally flawed. While higher sequencing depth can improve data quality, it does not address the structural, confounding issues of cell cycle, batch effects, or biological contamination. In fact, deeper sequencing could amplify the statistical signature of these confounders. Relying solely on re-running the same computational pipeline (\"no additional validation required\") without any orthogonal experimental validation to test the underlying causal claims is naive and scientifically unsound. It is an example of circular reasoning, trying to solve a problem by collecting more of the same type of data that generated the ambiguous result in the first place.\n**Verdict: Incorrect**\n\n**C. Assume that a bifurcation must exist because Waddington’s landscape metaphor implies universal branching; validate by bulk RNA sequencing and computational simulation of gene regulatory networks alone without lineage labeling, transplantation, or live imaging.**\n\nThis option is incorrect on multiple levels.\n- **Flawed Premise**: It begins by treating the Waddington landscape, a useful metaphor, as a physical law that guarantees a bifurcation. This is a non-scientific assumption that bypasses the critical evaluation required.\n- **Inadequate Validation**: The proposed methods are inappropriate. Bulk RNA sequencing would average out the single-cell heterogeneity, a step backward that would completely obscure any potential bifurcation. Computational simulation of GRNs, without being constrained and validated by experimental data like lineage tracing, is a speculative exercise. It cannot provide proof of in vivo lineage relationships. It explicitly rejects the necessary experimental techniques (lineage tracing, transplantation).\n**Verdict: Incorrect**\n\n**D. Conclude that both inferred branches necessarily originate from AGM hemogenic endothelium; validate by sorting c-Kit$^{+}$ cells at embryonic day $10.5$ and performing colony-forming unit assays in vitro as definitive proof of lineage relationships, without time-resolved in vivo lineage tracing or attention to potential yolk sac progenitor contamination.**\n\nThis option makes a premature conclusion and proposes a weak validation strategy.\n- **Unsupported Conclusion**: It starts by concluding that the lineage relationship is real, which is the very hypothesis that needs to be tested.\n- **Flawed Validation**: Sorting for `c-Kit` is not specific enough to isolate progenitors of AGM origin, as yolk sac-derived progenitors are also `c-Kit+`. This fails to address the contamination issue. Colony-forming unit (CFU) assays are in vitro assays that test for short-term progenitor potential but do not constitute \"definitive proof\" of in vivo lineage relationships or the long-term self-renewal and multipotency characteristic of true HSCs. Explicitly excluding time-resolved in vivo lineage tracing is rejecting the most powerful tool for solving the problem. The validation is neither clonal nor does it prove in vivo origin.\n**Verdict: Incorrect**\n\n**E. Identify that directionality is not identifiable from snapshots without additional structure: $P(F \\mid X) = \\sum_{t} P(F \\mid t) P(t \\mid X)$ [...] Note that RNA velocity’s direction depends on gene-wise kinetics [...] and that time point and batch act as confounders if $I(F;B) \\gg 0$. Recognize that erythroid-like AGM cells could be yolk sac-derived [...]. Validate by initiating inducible lineage barcoding [...] using CRISPR-based cumulative barcoding [...], then performing single-cell multi-omic profiling [...]; test directionality by live imaging of EHT and by temporally controlled Notch pathway perturbation [...]; include in vivo transplantation of barcode-labeled putative HSCs [...].**\n\nThis option is also excellent and scientifically rigorous.\n- **Pitfall Identification**: It identifies the same core issues as option A, framing them with elegant statistical and information-theoretic concepts. The point about the ambiguity of time $t$ in the inference $P(F \\mid X)$ is a sophisticated way to state the problem with static snapshots. It correctly points out the limitations of RNA velocity, the problem of confounders ($I(F;B) \\gg 0$), and the biological possibility of yolk sac contamination.\n- **Validation Strategy**: The proposed strategy is state-of-the-art and directly addresses the problem's challenges.\n    - CRISPR-based cumulative barcoding (`VE-Cadherin+/Endomucin+/RUNX1+` cells) is a powerful, high-resolution method for clonal lineage tracing that is perfectly suited for reconstructing lineage trees from a single time-point collection.\n    - Combining this with multi-omic profiling (e.g., RNA and chromatin accessibility) provides exceptionally rich data to understand fate decisions.\n    - Like option A, it correctly proposes the essential orthogonal validations: live imaging, timed perturbation experiments, and in vivo transplantation to assess function.\n    - It correctly proposes to check confounders using appropriate statistical methods ($I(F;B \\mid t)$).\nThis option provides a correct and comprehensive solution that is conceptually parallel to option A, differing only in the specific choice of cutting-edge techniques.\n**Verdict: Correct**\n\nBoth options A and E demonstrate a profound understanding of the limitations of computational inference and the necessity of rigorous, multi-faceted experimental validation. They correctly identify the pitfalls and propose appropriate, state-of-the-art solutions. Therefore, both are correct.", "answer": "$$\\boxed{AE}$$", "id": "2641398"}]}