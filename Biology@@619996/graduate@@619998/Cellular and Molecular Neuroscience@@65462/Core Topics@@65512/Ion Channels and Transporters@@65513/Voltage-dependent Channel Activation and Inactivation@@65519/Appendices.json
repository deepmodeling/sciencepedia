{"hands_on_practices": [{"introduction": "Voltage-gated ion channels sense changes in membrane potential using charged domains within their protein structure that move in response to the electric field. This foundational exercise delves into the physical basis of this process, focusing on the $S_4$ transmembrane segment, the primary voltage sensor [@problem_id:2771509]. By calculating the total effective charge from the movement of individual arginine residues, you will forge a quantitative link between a specific molecular architecture and the macroscopic biophysical property of gating charge ($Q_g$).", "problem": "A single voltage-gated cation channel contains an $S_4$ segment with $4$ positively charged arginine side chains. In response to a depolarizing step, each of these arginine charges translocates along the gating pathway such that it experiences a fraction $\\delta = 0.5$ of the transmembrane electric field during the closed-to-open transition. Each arginine contributes a formal charge of $+1 e_0$ at physiological pH, where $e_0$ is the magnitude of the elementary charge. Use the following foundational facts: (i) the electrical work associated with moving a charge $q$ across a potential difference $\\Delta V$ is $\\Delta W = q \\,\\Delta V$, and (ii) the gating charge $Q_g$ of a transition is defined by the relation $\\Delta G_{\\text{el}} = -Q_g \\,\\Delta V$, where $\\Delta G_{\\text{el}}$ is the change in electrostatic free energy between the two states. The magnitude of the elementary charge is $e_0 = 1.602 \\times 10^{-19}\\,\\mathrm{C}$. \n\nStarting from these principles and explicitly stating any simplifying assumptions needed to connect the microscopic motion of individual charges to the macroscopic gating charge, estimate the total gating charge displaced per channel for the closed-to-open transition under the conditions described. Express your final answer in coulombs ($\\mathrm{C}$) and round to $4$ significant figures.", "solution": "The problem requires the estimation of the total gating charge, $Q_g$, for a voltage-gated channel based on a microscopic model of charge movement. I will first validate the problem statement.\n\n**Problem Validation**\n\nStep 1: Extract Givens\n- A single voltage-gated cation channel.\n- The $S_4$ segment contains $N = 4$ positively charged arginine side chains.\n- Each charge translocates through a fraction $\\delta = 0.5$ of the transmembrane electric field.\n- The charge of each arginine is $q_i = +1 e_0$.\n- The magnitude of the elementary charge is $e_0 = 1.602 \\times 10^{-19}\\,\\mathrm{C}$.\n- Foundational fact (i): Electrical work $\\Delta W = q \\,\\Delta V$.\n- Foundational fact (ii): Gating charge definition $\\Delta G_{\\text{el}} = -Q_g \\,\\Delta V$.\n- Task: Estimate the total gating charge $Q_g$.\n- Task: Express the answer in coulombs and round to $4$ significant figures.\n- Task: State simplifying assumptions.\n\nStep 2: Validate Using Extracted Givens\nThe problem is scientifically grounded, presenting a standard simplified model of ion channel gating that is a cornerstone of cellular neurophysiology. The $S_4$ segment as the voltage sensor and its positively charged residues as gating charges are well-established concepts. The provided definitions for electrical work and gating charge are standard in biophysics. The problem is well-posed, self-contained, and provides all necessary constants and parameters for a unique solution. It is not based on any factual errors, pseudoscience, or ill-defined terms. The structure is logical and requires connecting a microscopic description (movement of individual arginines) to a macroscopic, experimentally measurable parameter (the gating charge).\n\nStep 3: Verdict and Action\nThe problem is valid. I will proceed with a complete solution.\n\n**Solution**\n\nThe task is to determine the macroscopic gating charge, $Q_g$, from the microscopic movement of individual charges within the channel's voltage sensor. We are given two fundamental relations: the electrical work, $\\Delta W$, done on a charge $q$ moving through a potential difference $\\Delta V$, and the definition of gating charge, $Q_g$, in terms of the change in electrostatic free energy, $\\Delta G_{\\text{el}}$.\n\nThe connection between these quantities lies in the principle that the change in a system's electrostatic potential energy is the negative of the work done by the conservative electric field. Assuming the change in electrostatic free energy is dominated by this potential energy change, we have $\\Delta G_{\\text{el}} = -\\Delta W_{\\text{field}}$.\n\nLet us consider a single arginine side chain with charge $q_i = +e_0$. This charge does not traverse the full transmembrane potential difference, $\\Delta V$. Instead, it translocates through a portion of the electric field equivalent to a fraction $\\delta$ of the total potential difference. Thus, the effective potential difference experienced by this single charge is $\\Delta V_{\\text{eff}} = \\delta \\Delta V$.\n\nUsing the provided definition for electrical work, the work done *by the field* on this single charge during the conformational change is:\n$$ \\Delta W_i = q_i \\Delta V_{\\text{eff}} = e_0 (\\delta \\Delta V) $$\n\nThe problem states there are $N=4$ such charges in the $S_4$ segment. To find the total change in energy for the entire channel, we must sum the contributions from each charge. Here, we must introduce a key simplifying assumption: **the $N$ charged residues are assumed to move independently**. This means that the movement of one charge does not electrostatically influence the energy of the others. Under this assumption, the total work done by the field is the sum of the work done on each individual charge:\n$$ \\Delta W_{\\text{total}} = \\sum_{i=1}^{N} \\Delta W_i = \\sum_{i=1}^{N} (e_0 \\delta \\Delta V) $$\nSince all terms in the sum are identical, this simplifies to:\n$$ \\Delta W_{\\text{total}} = N e_0 \\delta \\Delta V $$\n\nThe total change in electrostatic free energy of the channel protein, $\\Delta G_{\\text{el}}$, is the negative of the total work done by the internal electric field:\n$$ \\Delta G_{\\text{el}} = - \\Delta W_{\\text{total}} = -N e_0 \\delta \\Delta V $$\n\nWe are given the macroscopic definition of the gating charge, $Q_g$, as:\n$$ \\Delta G_{\\text{el}} = -Q_g \\Delta V $$\n\nBy equating these two expressions for $\\Delta G_{\\text{el}}$, we can solve for $Q_g$:\n$$ -Q_g \\Delta V = -N e_0 \\delta \\Delta V $$\nAssuming a non-zero potential step ($\\Delta V \\neq 0$), we can divide both sides by $-\\Delta V$ to find the relationship between the macroscopic gating charge and the microscopic parameters:\n$$ Q_g = N e_0 \\delta $$\nThis result shows that the total gating charge is the total number of elementary charges involved in gating, scaled by the fraction of the electric field through which they move.\n\nNow we substitute the given numerical values:\n- Number of charges, $N = 4$.\n- Elementary charge, $e_0 = 1.602 \\times 10^{-19}\\,\\mathrm{C}$.\n- Fractional distance, $\\delta = 0.5$.\n\n$$ Q_g = 4 \\times (1.602 \\times 10^{-19}\\,\\mathrm{C}) \\times 0.5 $$\n$$ Q_g = 2 \\times (1.602 \\times 10^{-19}\\,\\mathrm{C}) $$\n$$ Q_g = 3.204 \\times 10^{-19}\\,\\mathrm{C} $$\n\nThe result is required to be rounded to $4$ significant figures. The calculated value $3.204 \\times 10^{-19}\\,\\mathrm{C}$ already contains exactly four significant figures. Thus, no further rounding is necessary.", "answer": "$$\\boxed{3.204 \\times 10^{-19}}$$", "id": "2771509"}, {"introduction": "The movement of a channel's voltage sensor controls the opening and closing of its ion-conducting pore, a stochastic process described by the open probability, $P_o$. This practice explores how this gating probability translates into a measurable ionic current, linking the probability of the channel being open to the rate of ion flow [@problem_id:2771541]. You will apply a microscopic form of Ohm's law to distinguish the factors determining the direction and magnitude of ion flux—the electrochemical driving force—from the gating process that dictates how frequently the conduction pathway is available.", "problem": "A voltage-gated cation channel recorded under whole-cell voltage clamp is well described, when open, by a linear (ohmic) current-voltage relation. In the open state, the ionic current obeys the microscopic form of Ohm’s law. The direction of ion flow is governed by the electrochemical driving force, defined relative to the reversal potential. At steady state during a step to $V=-40\\,\\mathrm{mV}$, the channel’s open probability ($P_o$) is $P_o=0.3$ because of voltage-dependent activation and inactivation, its single-channel conductance is $g=20\\,\\mathrm{pS}$, and its reversal potential is $E_{\\mathrm{rev}}=+60\\,\\mathrm{mV}$. Assume that when the channel is closed it passes no current, that the open-state conductance is voltage-independent over the voltages considered, and that the ensemble-averaged current equals the time-average for a stationary gating process.\n\nStarting from Ohm’s law for ionic permeation and the definition of electrochemical driving force as the difference between membrane potential and reversal potential, derive a minimal expression for the signed mean single-channel current in terms of $g$, $P_o$, $V$, and $E_{\\mathrm{rev}}$. Then evaluate it using the given numbers, taking positive current as outward (positive charge leaving the cell). Finally, explain, in words, which factor sets the current’s direction and which factor scales its magnitude under these conditions.\n\nReport the final numeric answer as the signed mean current in picoamperes ($\\mathrm{pA}$), rounded to three significant figures.", "solution": "The problem statement is critically examined and found to be valid. It is scientifically grounded, well-posed, objective, and self-contained, presenting a standard problem in cellular biophysics. All necessary parameters and definitions are provided, and the values are physically realistic.\n\nThe problem requires the derivation of an expression for the mean single-channel current, $\\langle i \\rangle$, and its subsequent numerical evaluation.\n\nThe physical basis for ionic current through an open channel is the microscopic form of Ohm's law. The current is proportional to the electrochemical driving force. The current flowing through a single *open* channel, denoted $i_{\\text{open}}$, is given by the product of its single-channel conductance, $g$, and the electrochemical driving force. The problem defines the driving force as the difference between the membrane potential, $V$, and the reversal potential for the ion, $E_{\\text{rev}}$.\n\nTherefore, for an open channel:\n$$i_{\\text{open}} = g (V - E_{\\text{rev}})$$\n\nThe problem states that when the channel is closed, it passes no current. Thus, the current through a *closed* channel, $i_{\\text{closed}}$, is:\n$$i_{\\text{closed}} = 0$$\n\nThe channel stochastically transitions between the open and closed states. The open probability, $P_o$, represents the fraction of time the channel spends in the open state. Consequently, the fraction of time spent in the closed state is $(1 - P_o)$. The *mean* or time-averaged single-channel current, $\\langle i \\rangle$, is the weighted average of the current in each state, where the weights are the probabilities of occupying each state.\n\n$$\\langle i \\rangle = (i_{\\text{open}} \\times P_o) + (i_{\\text{closed}} \\times (1 - P_o))$$\n\nSubstituting the expressions for $i_{\\text{open}}$ and $i_{\\text{closed}}$:\n$$\\langle i \\rangle = (g (V - E_{\\text{rev}}) \\times P_o) + (0 \\times (1 - P_o))$$\n\nThis simplifies to the minimal expression for the mean single-channel current:\n$$\\langle i \\rangle = P_o \\cdot g \\cdot (V - E_{\\text{rev}})$$\n\nNext, we evaluate this expression using the provided numerical data:\n- Membrane potential: $V = -40\\,\\mathrm{mV} = -40 \\times 10^{-3}\\,\\mathrm{V}$\n- Reversal potential: $E_{\\text{rev}} = +60\\,\\mathrm{mV} = +60 \\times 10^{-3}\\,\\mathrm{V}$\n- Single-channel conductance: $g = 20\\,\\mathrm{pS} = 20 \\times 10^{-12}\\,\\mathrm{S}$\n- Open probability: $P_o = 0.3$\n\nFirst, calculate the driving force, $(V - E_{\\text{rev}})$:\n$$V - E_{\\text{rev}} = (-40 \\times 10^{-3}\\,\\mathrm{V}) - (60 \\times 10^{-3}\\,\\mathrm{V}) = -100 \\times 10^{-3}\\,\\mathrm{V}$$\n\nNow, substitute all values into the derived expression for $\\langle i \\rangle$:\n$$\\langle i \\rangle = (0.3) \\cdot (20 \\times 10^{-12}\\,\\mathrm{S}) \\cdot (-100 \\times 10^{-3}\\,\\mathrm{V})$$\n\nPerforming the multiplication:\n$$\\langle i \\rangle = (0.3 \\cdot 20 \\cdot -100) \\times 10^{-12} \\times 10^{-3}\\,\\mathrm{A}$$\n$$\\langle i \\rangle = -600 \\times 10^{-15}\\,\\mathrm{A}$$\n\nThe problem requires the answer in picoamperes ($\\mathrm{pA}$), where $1\\,\\mathrm{pA} = 10^{-12}\\,\\mathrm{A}$. We convert the result:\n$$\\langle i \\rangle = -600 \\times 10^{-3} \\times 10^{-12}\\,\\mathrm{A} = -0.6 \\times 10^{-12}\\,\\mathrm{A} = -0.6\\,\\mathrm{pA}$$\n\nRounding to three significant figures gives $-0.600\\,\\mathrm{pA}$. The negative sign indicates an inward current, consistent with the convention that positive current is outward.\n\nFinally, an explanation of the factors determining current direction and magnitude is required.\nThe direction of the ionic current is determined exclusively by the sign of the electrochemical driving force, $(V - E_{\\text{rev}})$. If the membrane potential $V$ is more negative than the reversal potential $E_{\\text{rev}}$, the driving force is negative, and the current of positive ions is inward (negative by convention). If $V$ is more positive than $E_{\\text{rev}}$, the driving force is positive, and the current is outward (positive by convention). In this specific case, $V  E_{\\text{rev}}$, dictating an inward current.\n\nThe magnitude of the mean current, $|\\langle i \\rangle|$, is scaled by three factors:\n1. The magnitude of the electrochemical driving force, $|V - E_{\\text{rev}}|$. A larger potential difference results in a larger current magnitude.\n2. The single-channel conductance, $g$. This is an intrinsic property of the ion channel pore that reflects its permeability to ions. A higher conductance allows a greater flow of ions for a given driving force.\n3. The open probability, $P_o$. Since current flows only through an open channel, the mean current over time is directly proportional to the fraction of time the channel is open. A higher open probability results in a larger mean current.\nIn summary, the magnitude is given by the product $|P_o \\cdot g \\cdot (V - E_{\\text{rev}})|$.", "answer": "$$\\boxed{-0.600}$$", "id": "2771541"}, {"introduction": "A cornerstone of channel biophysics is the quantitative characterization of voltage-dependent gating using data from electrophysiological recordings. This computational exercise provides hands-on experience in analyzing such experimental data [@problem_id:2771539]. You will learn to transform steady-state activation measurements using the log-odds (logit) function to linearize the underlying Boltzmann relationship, a powerful technique that allows for the precise determination of a channel’s half-activation voltage ($V_{1/2}$) and slope factor ($k$) using standard linear regression methods.", "problem": "You are given steady-state gating measurements for a voltage-dependent channel, recorded as fractions between $0$ and $1$, denoted $x_\\infty(V)$, at various membrane potentials $V$ expressed in millivolts. Assume a two-state equilibrium model in which the log-odds (logit) of the open probability is an affine function of voltage, that is, if $y(V)$ denotes the log-odds defined by $y(V) = \\log\\!\\left(\\dfrac{x_\\infty(V)}{1 - x_\\infty(V)}\\right)$, then $y(V)$ varies linearly with $V$. Your task is to:\n- estimate the parameters $a$ and $b$ in the linear relation $y(V) = a\\,V + b$ using ordinary least squares on the transformed data,\n- derive the half-activation voltage $V_{1/2}$ and the slope factor $k$ from $a$ and $b$,\n- compute the standard errors (uncertainties) of $V_{1/2}$ and $k$ by propagating the covariance of the linear fit parameters.\n\nFundamental base and definitions to use:\n- The steady-state gating variable $x_\\infty(V)$ satisfies $0  x_\\infty(V)  1$ and represents a probability at equilibrium for a two-state process.\n- The log-odds (also called the logit) of a probability $x$ is defined as $y = \\log\\!\\left(\\dfrac{x}{1-x}\\right)$, where $\\log$ is the natural logarithm.\n- Under the assumption that the log-odds varies linearly with voltage, one has a linear model $y(V) = a\\,V + b$. From this linear relation and the definition of the half-activation voltage as the voltage at which $x_\\infty = \\tfrac{1}{2}$, you must determine $V_{1/2}$ and $k$ in terms of $a$ and $b$.\n- Use ordinary least squares to estimate $a$ and $b$, and compute the parameter covariance using the standard normal equations for linear regression. Then propagate uncertainties from $(a,b)$ to $(V_{1/2},k)$ using first-order (delta-method) error propagation.\n\nNumerical instructions:\n- To avoid divergence of the log-odds for data points where $x_\\infty$ is exactly $0$ or $1$, you must clip each $x_\\infty$ to the interval $\\left[\\varepsilon, 1-\\varepsilon\\right]$ with $\\varepsilon = 10^{-6}$ before computing the log-odds.\n- All voltages are expressed in millivolts, and the outputs $V_{1/2}$ and $k$ must be reported in millivolts. The standard errors must have the same millivolt units.\n\nTest suite (each dataset is a pair of lists: membrane potentials in millivolts and corresponding $x_\\infty$ values):\n- Dataset A:\n  - $V$: $[-80,-60,-40,-20,0,20,40]$\n  - $x_\\infty$: $[0.000188,0.00330,0.0543,0.5,0.9457,0.9967,0.999812]$\n- Dataset B:\n  - $V$: $[-120,-100,-80,-60,-40,-20,0]$\n  - $x_\\infty$: $[0.99984,0.9981,0.9777,0.7773,0.2227,0.0223,0.00193]$\n- Dataset C:\n  - $V$: $[-60,-40,-20,-10,0,10,20]$\n  - $x_\\infty$: $[0.0,0.002473,0.119203,0.5,0.880797,0.982014,1.0]$\n- Dataset D:\n  - $V$: $[-20,0,20]$\n  - $x_\\infty$: $[0.119203,0.5,0.880797]$\n\nRequired outputs for each dataset:\n- Compute $V_{1/2}$ (in millivolts), $k$ (in millivolts), the standard error of $V_{1/2}$ (in millivolts), and the standard error of $k$ (in millivolts).\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each dataset’s result is a four-element list in the order $[V_{1/2},k,\\mathrm{SE}(V_{1/2}),\\mathrm{SE}(k)]$.\n- For the four datasets A, B, C, and D in that order, the final line must look like:\n  - $\"[[V_{1/2}^{(A)},k^{(A)},\\mathrm{SE}(V_{1/2})^{(A)},\\mathrm{SE}(k)^{(A)}],[V_{1/2}^{(B)},k^{(B)},\\mathrm{SE}(V_{1/2})^{(B)},\\mathrm{SE}(k)^{(B)}],[V_{1/2}^{(C)},k^{(C)},\\mathrm{SE}(V_{1/2})^{(C)},\\mathrm{SE}(k)^{(C)}],[V_{1/2}^{(D)},k^{(D)},\\mathrm{SE}(V_{1/2})^{(D)},\\mathrm{SE}(k)^{(D)}]]\"$.\n- All numbers must be expressed in millivolts and printed as floating-point numbers.", "solution": "We base the solution on the two-state equilibrium interpretation of a gating variable $x_\\infty(V)$, which is a probability between $0$ and $1$. A well-tested fact for such systems under a constant field assumption is that the log-odds (logit) of the open probability varies linearly with the membrane potential $V$. Define the log-odds transform\n$$\ny(V) \\equiv \\log\\!\\left(\\frac{x_\\infty(V)}{1-x_\\infty(V)}\\right).\n$$\nThe modeling assumption is that\n$$\ny(V) = a\\,V + b,\n$$\nfor some real parameters $a$ and $b$. This sets up a linear regression problem after transforming the observations $\\{(V_i,x_i)\\}$ into $\\{(V_i,y_i)\\}$ with $y_i = \\log\\!\\left(\\dfrac{x_i}{1-x_i}\\right)$. Since the log-odds is undefined at $x_i=0$ or $x_i=1$, we clip each $x_i$ to the closed interval $\\left[\\varepsilon,1-\\varepsilon\\right]$ with $\\varepsilon = 10^{-6}$ before computing $y_i$ to preserve numerical stability.\n\nEstimating $a$ and $b$:\n- Let $\\mathbf{X}$ be the design matrix with rows $[V_i,\\,1]$, and let $\\boldsymbol{y}$ be the vector with entries $y_i$.\n- The ordinary least squares estimator $\\hat{\\boldsymbol{\\beta}} = [\\hat{a},\\hat{b}]^\\top$ solves the normal equations\n$$\n(\\mathbf{X}^\\top \\mathbf{X})\\,\\hat{\\boldsymbol{\\beta}} = \\mathbf{X}^\\top \\boldsymbol{y},\n$$\nso\n$$\n\\hat{\\boldsymbol{\\beta}} = (\\mathbf{X}^\\top \\mathbf{X})^{-1} \\mathbf{X}^\\top \\boldsymbol{y}.\n$$\n- The fitted values are $\\hat{\\boldsymbol{y}} = \\mathbf{X} \\hat{\\boldsymbol{\\beta}}$, and the residuals are $\\boldsymbol{r} = \\boldsymbol{y} - \\hat{\\boldsymbol{y}}$.\n- If there are $n$ data points, the residual sum of squares (RSS) is $\\mathrm{RSS} = \\sum_{i=1}^n r_i^2$, and the residual variance estimate is\n$$\n\\hat{\\sigma}^2 = \\frac{\\mathrm{RSS}}{n - 2},\n$$\nsince there are $2$ fitted parameters in the linear model.\n- The covariance matrix of $\\hat{\\boldsymbol{\\beta}}$ is\n$$\n\\mathrm{Cov}(\\hat{\\boldsymbol{\\beta}}) = \\hat{\\sigma}^2 (\\mathbf{X}^\\top \\mathbf{X})^{-1}.\n$$\nFrom $a$ and $b$ to $V_{1/2}$ and $k$:\n- By definition, the half-activation voltage $V_{1/2}$ is the voltage at which $x_\\infty = \\tfrac{1}{2}$. Since $\\log\\!\\left(\\dfrac{1/2}{1-1/2}\\right) = 0$, we must have $0 = a\\,V_{1/2} + b$, hence\n$$\nV_{1/2} = -\\frac{b}{a}.\n$$\n- The slope factor $k$ is the voltage scale characterizing the sensitivity of the log-odds with respect to voltage. Since $y(V) = a\\,V + b$ and also $y(V)$ changes by one unit per change of $k$ in voltage, we identify\n$$\na = \\frac{1}{k} \\quad \\Rightarrow \\quad k = \\frac{1}{a}.\n$$\nUncertainty propagation:\n- Let the covariance matrix of $(\\hat{a},\\hat{b})$ be\n$$\n\\mathrm{Cov}(\\hat{a},\\hat{b}) = \\begin{bmatrix}\n\\mathrm{Var}(\\hat{a})  \\mathrm{Cov}(\\hat{a},\\hat{b}) \\\\\n\\mathrm{Cov}(\\hat{a},\\hat{b})  \\mathrm{Var}(\\hat{b})\n\\end{bmatrix}.\n$$\n- For $k = 1/a$, the first-order (delta method) variance is\n$$\n\\mathrm{Var}(\\hat{k}) \\approx \\left(\\frac{\\partial k}{\\partial a}\\right)^2 \\mathrm{Var}(\\hat{a}) = \\left(-\\frac{1}{a^2}\\right)^2 \\mathrm{Var}(\\hat{a}) = \\frac{\\mathrm{Var}(\\hat{a})}{a^4}.\n$$\nThus the standard error is $\\mathrm{SE}(\\hat{k}) = \\sqrt{\\mathrm{Var}(\\hat{k})}$.\n- For $V_{1/2} = -b/a$, with partial derivatives $\\dfrac{\\partial V_{1/2}}{\\partial a} = \\dfrac{b}{a^2}$ and $\\dfrac{\\partial V_{1/2}}{\\partial b} = -\\dfrac{1}{a}$, the delta method yields\n$$\n\\mathrm{Var}(\\widehat{V}_{1/2}) \\approx \\left(\\frac{b}{a^2}\\right)^2 \\mathrm{Var}(\\hat{a}) + \\left(\\frac{1}{a}\\right)^2 \\mathrm{Var}(\\hat{b}) + 2 \\left(\\frac{b}{a^2}\\right)\\left(-\\frac{1}{a}\\right) \\mathrm{Cov}(\\hat{a},\\hat{b}).\n$$\nThe standard error is $\\mathrm{SE}(\\widehat{V}_{1/2}) = \\sqrt{\\mathrm{Var}(\\widehat{V}_{1/2})}$.\n\nAlgorithm summary to implement:\n- For each dataset $\\{(V_i,x_i)\\}$:\n  1. Clip $x_i$ to $\\left[\\varepsilon,1-\\varepsilon\\right]$ with $\\varepsilon = 10^{-6}$, producing $\\tilde{x}_i$.\n  2. Compute $y_i = \\log\\!\\left(\\dfrac{\\tilde{x}_i}{1-\\tilde{x}_i}\\right)$.\n  3. Form $\\mathbf{X}$ with rows $[V_i, 1]$ and solve the least squares problem for $(\\hat{a},\\hat{b})$.\n  4. Compute $\\widehat{V}_{1/2} = -\\hat{b}/\\hat{a}$ and $\\hat{k} = 1/\\hat{a}$.\n  5. Compute residuals, $\\hat{\\sigma}^2$, $(\\mathbf{X}^\\top \\mathbf{X})^{-1}$, and thus the covariance of $(\\hat{a},\\hat{b})$.\n  6. Propagate uncertainties to obtain $\\mathrm{SE}(\\widehat{V}_{1/2})$ and $\\mathrm{SE}(\\hat{k})$ using the formulas above.\n- Report, for each dataset in the order A, B, C, D, the list $[\\widehat{V}_{1/2}, \\hat{k}, \\mathrm{SE}(\\widehat{V}_{1/2}), \\mathrm{SE}(\\hat{k})]$ in millivolts.\n\nEdge cases and coverage by the test suite:\n- Dataset C includes boundary measurements at $x_\\infty = 0$ and $x_\\infty = 1$ to test stability of the clipping and transform.\n- Dataset D is sparse with only three points to test the behavior with minimal data (degrees of freedom $n-2 = 1$).\n- Datasets A and B test typical monotone increasing and decreasing gating curves, respectively, with distinct slope signs; the sign of $\\hat{k}$ reflects the direction of voltage dependence within this linear-log-odds framework.\n\nThe final program implements the procedure detailed above and prints a single line with the required list-of-lists, with all entries in millivolts.", "answer": "```python\nimport numpy as np\n\ndef fit_logodds_linear(V_mV, x, eps=1e-6):\n    \"\"\"\n    Fit y = a V + b to y = log(x/(1-x)) with ordinary least squares.\n    Returns a, b, cov_ab (2x2 covariance matrix), and degrees of freedom.\n    \"\"\"\n    V = np.asarray(V_mV, dtype=float)\n    x = np.asarray(x, dtype=float)\n\n    # Clip to avoid infinities in log-odds\n    x_clipped = np.clip(x, eps, 1 - eps)\n    y = np.log(x_clipped / (1.0 - x_clipped))\n\n    # Design matrix: columns [V, 1]\n    X = np.column_stack((V, np.ones_like(V)))\n    # Solve least squares\n    beta, residuals, rank, s = np.linalg.lstsq(X, y, rcond=None)\n    a, b = beta[0], beta[1]\n\n    # Compute residuals and RSS\n    y_hat = X @ beta\n    r = y - y_hat\n    n = len(y)\n    dof = n - 2\n    # Handle dof = 0 by setting residual variance to 0 (perfect fit)\n    if dof  0:\n        RSS = np.sum(r**2)\n        sigma2 = RSS / dof\n    else:\n        sigma2 = 0.0\n\n    # Covariance of beta: sigma^2 * (X^T X)^{-1}\n    XtX = X.T @ X\n    XtX_inv = np.linalg.inv(XtX)\n    cov_beta = sigma2 * XtX_inv\n\n    return a, b, cov_beta, dof\n\ndef propagate_uncertainties(a, b, cov_beta):\n    \"\"\"\n    Given parameters a, b and their covariance matrix cov_beta (2x2),\n    compute V_half = -b/a, k = 1/a, and their standard errors via delta method.\n    \"\"\"\n    var_a = cov_beta[0, 0]\n    var_b = cov_beta[1, 1]\n    cov_ab = cov_beta[0, 1]\n\n    # Parameters\n    k = 1.0 / a\n    Vhalf = -b / a\n\n    # Delta-method variances\n    # Var(k) = (1/a^4) * Var(a)\n    var_k = var_a / (a**4) if a != 0 else np.inf\n\n    # Var(Vhalf) = (b/a^2)^2 Var(a) + (1/a^2)^2? No: (1/a)^2 Var(b) + 2 * (b/a^2) * (-1/a) * Cov(a,b)\n    var_Vhalf = ( (b / (a**2))**2 ) * var_a + ( (1.0 / a)**2 ) * var_b - 2.0 * (b / (a**3)) * cov_ab\n\n    # Guard against tiny negative due to numerical rounding\n    se_k = float(np.sqrt(var_k)) if var_k = 0 else 0.0\n    se_Vhalf = float(np.sqrt(var_Vhalf)) if var_Vhalf = 0 else 0.0\n\n    return Vhalf, k, se_Vhalf, se_k\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Dataset A\n        ([-80,-60,-40,-20,0,20,40],\n         [0.000188,0.00330,0.0543,0.5,0.9457,0.9967,0.999812]),\n        # Dataset B\n        ([-120,-100,-80,-60,-40,-20,0],\n         [0.99984,0.9981,0.9777,0.7773,0.2227,0.0223,0.00193]),\n        # Dataset C (with boundary 0 and 1)\n        ([-60,-40,-20,-10,0,10,20],\n         [0.0,0.002473,0.119203,0.5,0.880797,0.982014,1.0]),\n        # Dataset D (sparse)\n        ([-20,0,20],\n         [0.119203,0.5,0.880797]),\n    ]\n\n    results = []\n    for V, x in test_cases:\n        a, b, cov_beta, dof = fit_logodds_linear(V, x, eps=1e-6)\n        Vhalf, k, se_Vhalf, se_k = propagate_uncertainties(a, b, cov_beta)\n        # Round to a reasonable number of decimal places for display\n        results.append([Vhalf, k, se_Vhalf, se_k])\n\n    # Format with consistent floating representation\n    def fmt_list(lst):\n        return \"[\" + \",\" + \",\".join(f\"{v:.6f}\" for v in lst[1:]) if False else \"[\" + \",\".join(f\"{v:.6f}\" for v in lst) + \"]\"\n\n    out = \"[\" + \",\".join(fmt_list(r) for r in results) + \"]\"\n    print(out)\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "2771539"}]}