{"hands_on_practices": [{"introduction": "A fundamental skill in cellular signaling is to understand how the concentration of a second messenger is maintained and regulated. This practice grounds you in this core concept by modeling the steady-state concentration of cyclic AMP ($[\\text{cAMP}]$) as a dynamic equilibrium between its synthesis by adenylyl cyclase and its degradation by multiple phosphodiesterase (PDE) isoforms. By applying the principles of mass balance and Michaelis–Menten kinetics, you will derive and solve for the stable $[\\text{cAMP}]$ level in a neuronal compartment, a foundational calculation for understanding the baseline state of this signaling pathway [@problem_id:2761780].", "problem": "A well-stirred neuronal compartment maintains cyclic adenosine monophosphate (cAMP) at steady state through a balance between production by adenylyl cyclase (AC) and degradation by phosphodiesterases (PDEs). Assume that AC produces cAMP at a constant, zero-order rate that does not depend on cAMP concentration, and each PDE isoform catalyzes cAMP hydrolysis following Michaelis–Menten kinetics. There are no other sources or sinks for cAMP, and the compartment volume is constant.\n\nTwo PDE isoforms are present with the following kinetic parameters:\n- Isoform 1: maximum velocity $V_{\\max,1} = 0.80$ in units of micromolar per second and Michaelis constant $K_{M,1} = 2.00$ in units of micromolar.\n- Isoform 2: maximum velocity $V_{\\max,2} = 0.60$ in units of micromolar per second and Michaelis constant $K_{M,2} = 10.0$ in units of micromolar.\n\nThe AC production rate is $v_{\\mathrm{AC}} = 0.50$ in units of micromolar per second.\n\nUsing mass balance at steady state and Michaelis–Menten kinetics for PDE-mediated degradation, derive and solve for the steady-state cAMP concentration, denoted $[\\text{cAMP}]$, in the compartment.\n\nExpress your final answer in micromolar and round your answer to four significant figures.", "solution": "The problem statement is first subjected to validation.\n\nGivens are extracted verbatim:\n- System: A well-stirred neuronal compartment at steady state.\n- Production: Adenylyl cyclase (AC) produces cAMP at a constant, zero-order rate $v_{\\mathrm{AC}} = 0.50$ micromolar per second.\n- Degradation: Two phosphodiesterase (PDE) isoforms degrade cAMP via Michaelis–Menten kinetics.\n- PDE Isoform 1 parameters: $V_{\\max,1} = 0.80$ micromolar per second, $K_{M,1} = 2.00$ micromolar.\n- PDE Isoform 2 parameters: $V_{\\max,2} = 0.60$ micromolar per second, $K_{M,2} = 10.0$ micromolar.\n- Constraint: No other sources or sinks for cAMP.\n- Objective: Find the steady-state cAMP concentration, $[\\text{cAMP}]$.\n\nValidation verdict: The problem is scientifically grounded, employing standard principles of chemical kinetics (mass balance and Michaelis–Menten enzyme kinetics). It is well-posed, with all necessary parameters provided and a clear objective. The language is precise and objective. The setup is self-contained and free of contradictions or scientifically unsound premises. Therefore, the problem is deemed valid and a solution will be provided.\n\nThe fundamental principle governing the concentration of cyclic adenosine monophosphate, denoted as $[\\mathrm{cAMP}]$, is the law of mass action. The rate of change of $[\\mathrm{cAMP}]$ is the difference between its rate of production and its rate of degradation.\n\n$$\n\\frac{d[\\mathrm{cAMP}]}{dt} = v_{\\mathrm{production}} - v_{\\mathrm{degradation}}\n$$\n\nAt steady state, the concentration does not change over time, so $\\frac{d[\\mathrm{cAMP}]}{dt} = 0$. This implies that the rate of production must equal the rate of degradation.\n\n$$\nv_{\\mathrm{production}} = v_{\\mathrm{degradation}}\n$$\n\nThe production of cAMP is catalyzed by adenylyl cyclase (AC) at a constant, zero-order rate, $v_{\\mathrm{AC}}$. The degradation is catalyzed by two distinct phosphodiesterase (PDE) isoforms, and the total degradation rate is the sum of the rates of each isoform. Both isoforms follow Michaelis–Menten kinetics.\n\nLet $C$ represent the steady-state concentration $[\\mathrm{cAMP}]$. The steady-state condition is expressed as:\n$$\nv_{\\mathrm{AC}} = v_{\\mathrm{PDE},1} + v_{\\mathrm{PDE},2}\n$$\nSubstituting the Michaelis–Menten equation for each PDE isoform, we have:\n$$\nv_{\\mathrm{AC}} = \\frac{V_{\\max,1} C}{K_{M,1} + C} + \\frac{V_{\\max,2} C}{K_{M,2} + C}\n$$\nTo solve for $C$, we must rearrange this equation into a polynomial form. We begin by combining the terms on the right-hand side over a common denominator:\n$$\nv_{\\mathrm{AC}} = \\frac{V_{\\max,1} C (K_{M,2} + C) + V_{\\max,2} C (K_{M,1} + C)}{(K_{M,1} + C)(K_{M,2} + C)}\n$$\nMultiplying both sides by the denominator yields:\n$$\nv_{\\mathrm{AC}} (K_{M,1} + C)(K_{M,2} + C) = V_{\\max,1} C (K_{M,2} + C) + V_{\\max,2} C (K_{M,1} + C)\n$$\nExpanding both sides of the equation:\n$$\nv_{\\mathrm{AC}} (K_{M,1} K_{M,2} + (K_{M,1} + K_{M,2})C + C^2) = V_{\\max,1} K_{M,2} C + V_{\\max,1} C^2 + V_{\\max,2} K_{M,1} C + V_{\\max,2} C^2\n$$\nWe collect terms to form a standard quadratic equation of the form $aC^2 + bC + c = 0$.\n$$\n(v_{\\mathrm{AC}}) C^2 + (v_{\\mathrm{AC}}(K_{M,1} + K_{M,2})) C + v_{\\mathrm{AC}} K_{M,1} K_{M,2} = (V_{\\max,1} + V_{\\max,2}) C^2 + (V_{\\max,1} K_{M,2} + V_{\\max,2} K_{M,1}) C\n$$\nRearranging gives:\n$$\n(v_{\\mathrm{AC}} - V_{\\max,1} - V_{\\max,2}) C^2 + (v_{\\mathrm{AC}}(K_{M,1} + K_{M,2}) - V_{\\max,1} K_{M,2} - V_{\\max,2} K_{M,1}) C + v_{\\mathrm{AC}} K_{M,1} K_{M,2} = 0\n$$\nNow, we substitute the given numerical values into the coefficients of this quadratic equation. The units are consistent, so we may proceed with the dimensionless values.\nGiven:\n$v_{\\mathrm{AC}} = 0.50$\n$V_{\\max,1} = 0.80$, $K_{M,1} = 2.00$\n$V_{\\max,2} = 0.60$, $K_{M,2} = 10.0$\n\nThe coefficients are calculated as:\nCoefficient $a$:\n$$\na = v_{\\mathrm{AC}} - V_{\\max,1} - V_{\\max,2} = 0.50 - 0.80 - 0.60 = -0.90\n$$\nCoefficient $b$:\n$$\nb = v_{\\mathrm{AC}}(K_{M,1} + K_{M,2}) - (V_{\\max,1} K_{M,2} + V_{\\max,2} K_{M,1}) = 0.50(2.00 + 10.0) - (0.80 \\times 10.0 + 0.60 \\times 2.00)\n$$\n$$\nb = 0.50(12.0) - (8.00 + 1.20) = 6.0 - 9.20 = -3.20\n$$\nCoefficient $c$:\n$$\nc = v_{\\mathrm{AC}} K_{M,1} K_{M,2} = 0.50 \\times 2.00 \\times 10.0 = 10.0\n$$\nThe resulting quadratic equation for $C$ is:\n$$\n-0.90 C^2 - 3.20 C + 10.0 = 0\n$$\nMultiplying by $-1$ for convenience:\n$$\n0.90 C^2 + 3.20 C - 10.0 = 0\n$$\nWe solve for $C$ using the quadratic formula, $C = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}$:\n$$\nC = \\frac{-3.20 \\pm \\sqrt{(3.20)^2 - 4(0.90)(-10.0)}}{2(0.90)}\n$$\n$$\nC = \\frac{-3.20 \\pm \\sqrt{10.24 + 36.0}}{1.80}\n$$\n$$\nC = \\frac{-3.20 \\pm \\sqrt{46.24}}{1.80}\n$$\nThe square root is $\\sqrt{46.24} = 6.80$.\n$$\nC = \\frac{-3.20 \\pm 6.80}{1.80}\n$$\nThis gives two possible mathematical solutions for $C$:\n$$\nC_1 = \\frac{-3.20 + 6.80}{1.80} = \\frac{3.60}{1.80} = 2.00\n$$\n$$\nC_2 = \\frac{-3.20 - 6.80}{1.80} = \\frac{-10.0}{1.80} \\approx -5.56\n$$\nConcentration must be a non-negative quantity. Therefore, the second solution, $C_2$, is physically unrealistic and must be discarded. The only valid solution is $C = 2.00 \\, \\mu\\text{M}$.\n\nTo verify this solution, we substitute $C = 2.00$ back into the original rate balance equation:\nTotal degradation rate $v_{\\mathrm{PDE}} = \\frac{0.80 \\times 2.00}{2.00 + 2.00} + \\frac{0.60 \\times 2.00}{10.0 + 2.00} = \\frac{1.60}{4.00} + \\frac{1.20}{12.0} = 0.40 + 0.10 = 0.50 \\, \\mu\\text{M/s}$.\nThis matches the production rate $v_{\\mathrm{AC}} = 0.50 \\, \\mu\\text{M/s}$, confirming the correctness of the solution.\n\nThe problem requires the answer to be expressed to four significant figures. The exact answer is $2$. Thus, we write it as $2.000$.", "answer": "$$\\boxed{2.000}$$", "id": "2761780"}, {"introduction": "The concentration of $[\\text{cAMP}]$ is merely a potential; its biological significance is realized through the activation of downstream effectors like Protein Kinase A (PKA). This exercise challenges you to model this crucial activation step by deriving the dose-response relationship between $[\\text{cAMP}]$ and PKA activity from first principles [@problem_id:2761726]. By considering the independent binding of cAMP to two distinct sites on the PKA regulatory subunit, you will construct a biophysical model that quantitatively predicts the fraction of active PKA, providing a direct link between the second messenger level and its primary cellular consequence.", "problem": "Consider the protein kinase A (PKA) holoenzyme in neurons, which consists of a dimer of regulatory subunits bound to two catalytic subunits. The regulatory subunits dimerize to form a regulatory dimer, and each regulatory monomer contains two nonidentical cyclic adenosine monophosphate (cAMP) binding sites, denoted site A and site B, with dissociation constants $K_{A}$ and $K_{B}$, respectively. Assume the following biophysical model.\n\n1. The free cytosolic cAMP concentration is $c$ and remains effectively constant during binding because cAMP is in large excess over PKA.\n2. Within a regulatory monomer, the two sites bind cAMP independently and noncooperatively (other than their nonidentical dissociation constants), and the two sites on distinct monomers are also independent.\n3. A catalytic subunit remains bound to its associated regulatory monomer unless both site A and site B on that monomer are occupied by cAMP; if and only if both sites on a monomer are occupied, its associated catalytic subunit is released into the free pool. The dimerization state of regulatory subunits is unaffected by cAMP binding.\n4. In the absence of cAMP, both catalytic subunits are bound to the regulatory dimer.\n\nStarting only from the law of mass action and the definition of the dissociation constant for ligand–site binding, derive an analytic expression for the fraction of catalytic subunits that are free as a function of $c$, $K_{A}$, and $K_{B}$. Express your final result as a simplified closed-form expression (dimensionless). No numerical evaluation or rounding is required.", "solution": "The problem statement has been validated and is deemed valid. It is scientifically grounded, well-posed, objective, and internally consistent. It represents a standard problem in biophysical chemistry and cell signaling, requiring the derivation of a dose-response relationship from first principles.\n\nThe central task is to determine the fraction of catalytic subunits of protein kinase A (PKA) that are free as a function of the cyclic adenosine monophosphate (cAMP) concentration, $c$. The PKA holoenzyme is described as $R_{2}C_{2}$, a dimer of regulatory subunits ($R$) each bound to a catalytic subunit ($C$). According to the problem statement, the system can be analyzed by considering a single regulatory monomer and its associated catalytic subunit, as the two R-C pairs in the dimer behave independently.\n\nLet us begin by applying the law of mass action to a single generic binding site, $S$, for a ligand, $L$, with concentration $c$. The reversible binding reaction is:\n$$ S + L \\rightleftharpoons SL $$\nThe dissociation constant, $K_{d}$, is defined at equilibrium as:\n$$ K_{d} = \\frac{[S][L]}{[SL]} $$\nGiven that the ligand concentration is $c$, we have $[L] = c$. The fraction of occupied sites, $\\theta$, is the concentration of occupied sites, $[SL]$, divided by the total concentration of sites, $[S]_{total} = [S] + [SL]$.\n$$ \\theta = \\frac{[SL]}{[S] + [SL]} $$\nFrom the definition of $K_{d}$, we can express $[S]$ in terms of $[SL]$:\n$$ [S] = \\frac{K_{d}[SL]}{c} $$\nSubstituting this into the expression for $\\theta$:\n$$ \\theta = \\frac{[SL]}{\\frac{K_{d}[SL]}{c} + [SL]} = \\frac{1}{\\frac{K_{d}}{c} + 1} = \\frac{c}{K_{d} + c} $$\nThis is the Hill-Langmuir equation, which gives the fractional occupancy of a single, independent binding site.\n\nThe problem specifies that each regulatory monomer has two independent, nonidentical binding sites for cAMP: site A and site B, with dissociation constants $K_{A}$ and $K_{B}$, respectively.\nThe fractional occupancy of site A, $\\theta_{A}$, as a function of the cAMP concentration $c$, is:\n$$ \\theta_{A} = \\frac{c}{K_{A} + c} $$\nSimilarly, the fractional occupancy of site B, $\\theta_{B}$, is:\n$$ \\theta_{B} = \\frac{c}{K_{B} + c} $$\n\nThe probability of a site being unoccupied is $1 - \\theta$. Therefore, the probability that site A is unoccupied is $1 - \\theta_{A} = \\frac{K_{A}}{K_{A} + c}$, and the probability that site B is unoccupied is $1 - \\theta_{B} = \\frac{K_{B}}{K_{B} + c}$.\n\nThe problem states that binding to site A and site B on a single monomer is independent. The probability of two independent events occurring simultaneously is the product of their individual probabilities. A catalytic subunit is released if and only if both site A and site B on its associated regulatory monomer are occupied by cAMP. Therefore, the fraction of regulatory monomers that meet this condition is equal to the probability that both sites are simultaneously occupied.\n\nLet $f_{free}$ be the fraction of catalytic subunits that are free. This is equivalent to the fraction of regulatory monomers that have both cAMP sites occupied.\n$$ f_{free} = P(\\text{site A is occupied AND site B is occupied}) $$\nBecause of independence:\n$$ f_{free} = P(\\text{site A is occupied}) \\times P(\\text{site B is occupied}) $$\n$$ f_{free} = \\theta_{A} \\times \\theta_{B} $$\n\nSubstituting the expressions for $\\theta_{A}$ and $\\theta_{B}$:\n$$ f_{free}(c) = \\left(\\frac{c}{K_{A} + c}\\right) \\left(\\frac{c}{K_{B} + c}\\right) $$\nThis simplifies to the final closed-form expression:\n$$ f_{free}(c) = \\frac{c^{2}}{(K_{A} + c)(K_{B} + c)} $$\nThis expression is dimensionless, as $c$, $K_{A}$, and $K_{B}$ all have units of concentration. At $c=0$, $f_{free}(0)=0$, consistent with the premise that all catalytic subunits are bound in the absence of cAMP. As $c \\to \\infty$, $f_{free} \\to 1$, consistent with saturation of all binding sites leading to the release of all catalytic subunits.", "answer": "$$\\boxed{\\frac{c^{2}}{(K_{A} + c)(K_{B} + c)}}$$", "id": "2761726"}, {"introduction": "While deterministic models describe the average behavior of large populations of molecules, signaling in small compartments like dendritic spines is inherently noisy. This computational practice moves beyond deterministic ordinary differential equations (ODEs) to the stochastic reality of molecular interactions, where random fluctuations can dominate signal dynamics [@problem_id:2761842]. You will implement the Gillespie algorithm to simulate a cAMP pulse, comparing the peak concentration of a single stochastic trajectory to the smooth prediction of the corresponding ODE, offering direct insight into the magnitude and importance of intrinsic noise in small signaling domains.", "problem": "You are to implement a quantitative comparison between stochastic and deterministic predictions for cyclic adenosine monophosphate (cAMP) pulses in dendritic spines by modeling adenylyl cyclase and phosphodiesterase dynamics. The stochastic model must be simulated using the Gillespie direct algorithm, and the deterministic prediction must be computed from the mass-action ordinary differential equation for a birth–death process. The biological system is summarized as follows: active adenylyl cyclase ($\\mathrm{AC}^\\ast$) catalyzes cAMP synthesis during a fixed stimulus window, and phosphodiesterase ($\\mathrm{PDE}$) degrades cAMP continuously. Adenosine triphosphate (ATP) is abundant, so its concentration can be treated as constant, making cAMP synthesis effectively first-order in $\\mathrm{AC}^\\ast$ only. Although protein kinase A (PKA) is not explicitly simulated here, the cAMP pulse comparison is a meaningful proxy for downstream PKA activation.\n\nFundamental base and core definitions:\n- Chemical Master Equation (CME) with mass-action propensities for a well-mixed volume: reaction hazards are proportional to reactant counts with proportionality constants derived from kinetic rates. The Gillespie direct algorithm samples reaction times from an exponential distribution with total hazard equal to the sum of propensities and selects the next reaction by categorical sampling proportional to individual propensities.\n- Deterministic limit of the CME under the law of large numbers gives an ordinary differential equation (ODE) for the concentration $C(t)$ of cAMP.\n- Avogadro constant $N_A = 6.02214076 \\times 10^{23}\\ \\mathrm{mol^{-1}}$.\n- Concentration–count conversion in a volume $V$ (in liters): if $N$ is the molecule count of cAMP, then the concentration in micromolar is $C_{\\mu\\mathrm{M}} = \\dfrac{N}{N_A V} \\times 10^6$.\n\nModel specification:\n- Species: cAMP molecule count $N_{\\mathrm{cAMP}}(t)$.\n- Parameters: active cyclase count $N_{\\mathrm{AC}^\\ast}$ (dimensionless, molecules), catalytic rate $k_{\\mathrm{cat}}$ (in $\\mathrm{s^{-1}}$ per $\\mathrm{AC}^\\ast$), degradation rate $k_{\\mathrm{deg}}$ (in $\\mathrm{s^{-1}}$), stimulus duration $T_{\\mathrm{pulse}}$ (in $\\mathrm{s}$), simulation horizon $T_{\\mathrm{end}}$ (in $\\mathrm{s}$), and compartment volume $V$ (in $\\mathrm{L}$).\n- Reactions and propensities:\n  1. Synthesis during the pulse window $t \\in [0, T_{\\mathrm{pulse}})$: \n     $$\\varnothing \\xrightarrow{\\mathrm{AC}^\\ast} \\mathrm{cAMP}, \\quad a_1(t) = k_{\\mathrm{cat}}\\, N_{\\mathrm{AC}^\\ast} \\quad \\text{for } t < T_{\\mathrm{pulse}}, \\quad a_1(t)=0 \\text{ for } t \\ge T_{\\mathrm{pulse}}.$$\n  2. Degradation for all $t$:\n     $$\\mathrm{cAMP} \\xrightarrow{\\mathrm{PDE}} \\varnothing, \\quad a_2(t) = k_{\\mathrm{deg}}\\, N_{\\mathrm{cAMP}}(t).$$\n\nDeterministic prediction:\n- Let $C(t)$ be the cAMP concentration in micromolar. During the pulse ($0 \\le t \\le T_{\\mathrm{pulse}}$), \n  $$\\frac{dC}{dt} = r - k_{\\mathrm{deg}} C, \\quad r = \\frac{k_{\\mathrm{cat}}\\, N_{\\mathrm{AC}^\\ast}}{N_A V} \\times 10^6.$$\n  With initial condition $C(0)=0$, the solution during the pulse is\n  $$C(t) = \\frac{r}{k_{\\mathrm{deg}}}\\left(1 - e^{-k_{\\mathrm{deg}} t}\\right).$$\n  After the pulse ($t \\ge T_{\\mathrm{pulse}}$), synthesis ceases and $C(t)$ decays exponentially. The deterministic peak occurs at $t = T_{\\mathrm{pulse}}$:\n  $$C_{\\mathrm{det,peak}} = \\frac{r}{k_{\\mathrm{deg}}}\\left(1 - e^{-k_{\\mathrm{deg}} T_{\\mathrm{pulse}}}\\right).$$\n\nStochastic prediction:\n- Use the Gillespie direct algorithm with piecewise-constant propensities. Simulate two phases:\n  - Phase $1$: for $t < T_{\\mathrm{pulse}}$, use $a_1 = k_{\\mathrm{cat}} N_{\\mathrm{AC}^\\ast}$ and $a_2 = k_{\\mathrm{deg}} N_{\\mathrm{cAMP}}$ as above. If a sampled inter-reaction time would cross $T_{\\mathrm{pulse}}$, advance time to $T_{\\mathrm{pulse}}$ without applying a reaction, then enter Phase $2$.\n  - Phase $2$: for $t \\in [T_{\\mathrm{pulse}}, T_{\\mathrm{end}}]$, set $a_1=0$ and continue with only degradation events.\n- Track the stochastic peak concentration $C_{\\mathrm{stoch,peak}}$ by monitoring $N_{\\mathrm{cAMP}}$ over time and converting to micromolar using the formula above. Because no synthesis occurs after $T_{\\mathrm{pulse}}$, the peak must occur at or before $T_{\\mathrm{pulse}}$.\n\nTask:\n- For each parameter set below, compute the ratio \n  $$R = \\frac{C_{\\mathrm{stoch,peak}}}{C_{\\mathrm{det,peak}}}.$$\n- Initialization: $N_{\\mathrm{cAMP}}(0) = 0$ and $C(0)=0$.\n- Randomness: use a pseudo-random number generator seeded with $1729$ for reproducibility; for example, you may offset the seed by the test case index $i$ as $1729 + i$ to obtain per-case reproducible streams.\n- Units: time in seconds ($\\mathrm{s}$), volume in liters ($\\mathrm{L}$), rates in per second ($\\mathrm{s^{-1}}$), and concentration in micromolar ($\\mu\\mathrm{M}$).\n- Output: for each test case, output the ratio $R$ as a decimal float rounded to six decimal places.\n\nTest suite (four cases):\n1. Typical small spine:\n   - $N_{\\mathrm{AC}^\\ast} = 50$, $k_{\\mathrm{cat}} = 20\\ \\mathrm{s^{-1}}$, $k_{\\mathrm{deg}} = 2\\ \\mathrm{s^{-1}}$, $T_{\\mathrm{pulse}}=0.5\\ \\mathrm{s}$, $T_{\\mathrm{end}}=3.0\\ \\mathrm{s}$, $V = 1.0\\times 10^{-16}\\ \\mathrm{L}$.\n2. Very small spine (stronger intrinsic noise), scaled $\\mathrm{AC}^\\ast$ to maintain similar deterministic drive per volume:\n   - $N_{\\mathrm{AC}^\\ast} = 10$, $k_{\\mathrm{cat}} = 20\\ \\mathrm{s^{-1}}$, $k_{\\mathrm{deg}} = 2\\ \\mathrm{s^{-1}}$, $T_{\\mathrm{pulse}}=0.5\\ \\mathrm{s}$, $T_{\\mathrm{end}}=3.0\\ \\mathrm{s}$, $V = 2.0\\times 10^{-17}\\ \\mathrm{L}$.\n3. Large spine-like compartment (law-of-large-numbers regime), scaled $\\mathrm{AC}^\\ast$:\n   - $N_{\\mathrm{AC}^\\ast} = 500$, $k_{\\mathrm{cat}} = 20\\ \\mathrm{s^{-1}}$, $k_{\\mathrm{deg}} = 2\\ \\mathrm{s^{-1}}$, $T_{\\mathrm{pulse}}=0.5\\ \\mathrm{s}$, $T_{\\mathrm{end}}=3.0\\ \\mathrm{s}$, $V = 1.0\\times 10^{-15}\\ \\mathrm{L}$.\n4. Fast degradation, brief pulse (boundary condition with small expected peaks):\n   - $N_{\\mathrm{AC}^\\ast} = 50$, $k_{\\mathrm{cat}} = 20\\ \\mathrm{s^{-1}}$, $k_{\\mathrm{deg}} = 10\\ \\mathrm{s^{-1}}$, $T_{\\mathrm{pulse}}=0.1\\ \\mathrm{s}$, $T_{\\mathrm{end}}=1.0\\ \\mathrm{s}$, $V = 1.0\\times 10^{-16}\\ \\mathrm{L}$.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[r1,r2,r3,r4]\"), where each $r_i$ is the ratio $R$ for test case $i$, rounded to six decimal places. No additional text should be printed.", "solution": "The problem requires a quantitative comparison between the deterministic and stochastic predictions for the peak concentration of cyclic adenosine monophosphate (cAMP) in a cellular microcompartment. This will be accomplished by, first, calculating the peak concentration from the analytical solution to the mass-action ordinary differential equation (ODE) and, second, simulating a single trajectory using the Gillespie stochastic simulation algorithm (SSA) to find the stochastic peak. The ratio of these two peak values serves as a metric for the magnitude of stochastic fluctuations, or intrinsic noise, in the system.\n\nThe validation of the problem statement confirms that it is scientifically sound, well-posed, and objective. It provides a complete and consistent set of definitions, parameters, and physical constants necessary for a rigorous solution. The model is a canonical birth-death process, a fundamental construct in stochastic chemical kinetics, applied to a biologically relevant signaling pathway. We may therefore proceed to the solution.\n\nThe analysis is divided into two primary parts: the deterministic model and the stochastic model.\n\n**Deterministic Model**\n\nUnder the law of large numbers, for a system with a large number of molecules, the stochastic chemical master equation converges to a set of deterministic rate equations. For this system, the concentration of cAMP, denoted by $C(t)$ in units of micromolar ($\\mu\\mathrm{M}$), is governed by a linear first-order ordinary differential equation.\n\nDuring the stimulus window, $t \\in [0, T_{\\mathrm{pulse}}]$, cAMP is synthesized at a constant rate and degraded at a rate proportional to its current concentration. The governing equation is:\n$$\n\\frac{dC}{dt} = r - k_{\\mathrm{deg}} C(t)\n$$\nHere, $k_{\\mathrm{deg}}$ is the first-order degradation rate constant (in $\\mathrm{s^{-1}}$). The term $r$ represents the constant synthesis rate, expressed in $\\mu\\mathrm{M} \\cdot \\mathrm{s^{-1}}$. It is derived from the microscopic parameters: the number of active adenylyl cyclase molecules, $N_{\\mathrm{AC}^\\ast}$; the catalytic rate per enzyme, $k_{\\mathrm{cat}}$ (in $\\mathrm{s^{-1}}$); the compartment volume, $V$ (in $\\mathrm{L}$); and the Avogadro constant, $N_A$. The conversion from molecule production rate to concentration change rate yields:\n$$\nr = \\frac{k_{\\mathrm{cat}} N_{\\mathrm{AC}^\\ast}}{N_A V} \\times 10^6\n$$\nThe factor of $10^6$ converts the concentration from $\\mathrm{mol \\cdot L^{-1}}$ to $\\mu\\mathrm{mol \\cdot L^{-1}}$ ($\\mu\\mathrm{M}$).\n\nWith the initial condition $C(0) = 0$, the solution to this ODE is:\n$$\nC(t) = \\frac{r}{k_{\\mathrm{deg}}} \\left(1 - e^{-k_{\\mathrm{deg}} t}\\right)\n$$\nSince the synthesis rate $r$ is positive and constant for $t \\in [0, T_{\\mathrm{pulse}}]$, the concentration $C(t)$ is a monotonically increasing function throughout this interval. Consequently, the deterministic peak concentration, $C_{\\mathrm{det,peak}}$, is achieved precisely at the end of the stimulus pulse, at $t = T_{\\mathrm{pulse}}$.\n$$\nC_{\\mathrm{det,peak}} = C(T_{\\mathrm{pulse}}) = \\frac{r}{k_{\\mathrm{deg}}} \\left(1 - e^{-k_{\\mathrm{deg}} T_{\\mathrm{pulse}}}\\right)\n$$\nFor $t > T_{\\mathrm{pulse}}$, the synthesis term $r$ becomes zero, and the concentration decays exponentially from its value at $T_{\\mathrm{pulse}}$.\n\n**Stochastic Model**\n\nIn the stochastic framework, we model the discrete number of cAMP molecules, $N_{\\mathrm{cAMP}}(t)$. The system evolves through a sequence of chemical reactions, each occurring at a random time. This is a classic birth-death process.\n\nThe reactions and their corresponding mass-action propensities, $a_j$, are:\n1.  **Synthesis (Birth)**: $\\varnothing \\xrightarrow{\\mathrm{AC}^\\ast} \\mathrm{cAMP}$. This represents the creation of a cAMP molecule. The propensity is time-dependent:\n    $$\n    a_1(t) = \\begin{cases} k_{\\mathrm{cat}} N_{\\mathrm{AC}^\\ast} & \\text{if } t < T_{\\mathrm{pulse}} \\\\ 0 & \\text{if } t \\ge T_{\\mathrm{pulse}} \\end{cases}\n    $$\n    This is a zero-order reaction with respect to cAMP, as its rate does not depend on $N_{\\mathrm{cAMP}}$.\n\n2.  **Degradation (Death)**: $\\mathrm{cAMP} \\xrightarrow{\\mathrm{PDE}} \\varnothing$. This represents the degradation of a cAMP molecule. The propensity is:\n    $$\n    a_2(t) = k_{\\mathrm{deg}} N_{\\mathrm{cAMP}}(t)\n    $$\n    This is a first-order reaction, with the rate proportional to the number of reactant molecules.\n\nThe simulation of this stochastic process will be performed using the Gillespie direct algorithm. At any given time $t$ with state $N_{\\mathrm{cAMP}}(t)$, the algorithm proceeds as follows:\n1.  Calculate the propensities for all possible reactions, $a_1$ and $a_2$.\n2.  Calculate the total propensity, $a_0 = a_1 + a_2$.\n3.  Sample the time until the next reaction, $\\tau$, from an exponential distribution with rate $a_0$:\n    $$\n    \\tau = -\\frac{\\ln(u_1)}{a_0}\n    $$\n    where $u_1$ is a random number drawn from a uniform distribution on $(0, 1)$.\n4.  Determine which reaction occurs. Reaction $j$ is chosen with probability $a_j / a_0$. This is done by drawing a second uniform random number, $u_2$, and finding the smallest integer $j$ such that $\\sum_{i=1}^{j} a_i \\ge u_2 a_0$. For our two-reaction system, if $u_2 a_0 \\le a_1$, reaction $1$ occurs; otherwise, reaction $2$ occurs.\n5.  Update the system state according to the chosen reaction ($N_{\\mathrm{cAMP}} \\rightarrow N_{\\mathrm{cAMP}}+1$ for synthesis, $N_{\\mathrm{cAMP}} \\rightarrow N_{\\mathrm{cAMP}}-1$ for degradation) and advance the time to $t + \\tau$.\n\nA specific modification is required to handle the time-dependent synthesis rate. The simulation proceeds with $a_1 = k_{\\mathrm{cat}} N_{\\mathrm{AC}^\\ast}$ until the sampled time step $\\tau$ would advance the clock past $T_{\\mathrm{pulse}}$. That is, if $t + \\tau \\ge T_{\\mathrm{pulse}}$, the algorithm instead advances time directly to $t=T_{\\mathrm{pulse}}$ without executing a reaction, and then continues the simulation with $a_1$ permanently set to $0$.\n\nThe stochastic peak, $C_{\\mathrm{stoch,peak}}$, is determined by tracking the maximum number of cAMP molecules, $N_{\\mathrm{peak}}$, observed during the simulation. Since creation events cease at $t=T_{\\mathrm{pulse}}$, the number of molecules can only decrease thereafter. Thus, the peak number of molecules must occur at or before $t=T_{\\mathrm{pulse}}$. It is sufficient to simulate the system up to $T_{\\mathrm{pulse}}$, recording the maximum value of $N_{\\mathrm{cAMP}}$ encountered. This maximum count, $N_{\\mathrm{peak}}$, is then converted to a concentration:\n$$\nC_{\\mathrm{stoch,peak}} = \\frac{N_{\\mathrm{peak}}}{N_A V} \\times 10^6\n$$\n\n**Calculation of the Ratio**\n\nFor each parameter set provided in the test suite, we will first compute $C_{\\mathrm{det,peak}}$ using its analytical formula. Then, we will execute a single Gillespie simulation, seeded for reproducibility, to find $C_{\\mathrm{stoch,peak}}$. The final result is the ratio:\n$$\nR = \\frac{C_{\\mathrm{stoch,peak}}}{C_{\\mathrm{det,peak}}}\n$$\nThis ratio quantifies the deviation of the stochastic peak from the deterministic average. A ratio greater than $1$ indicates that this particular stochastic trajectory peaked higher than the mean-field prediction, and vice versa. The magnitude of $|R-1|$ is expected to be larger for systems with smaller volumes and fewer molecules, where intrinsic noise has a more pronounced effect.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for all test cases.\n    It calculates the ratio of stochastic to deterministic peak cAMP concentrations.\n    \"\"\"\n\n    # Avogadro constant\n    N_A = 6.02214076e23  # mol^-1\n\n    # Test suite from the problem statement\n    test_cases = [\n        # (N_AC*, k_cat, k_deg, T_pulse, T_end, V)\n        (50, 20.0, 2.0, 0.5, 3.0, 1.0e-16),\n        (10, 20.0, 2.0, 0.5, 3.0, 2.0e-17),\n        (500, 20.0, 2.0, 0.5, 3.0, 1.0e-15),\n        (50, 20.0, 10.0, 0.1, 1.0, 1.0e-16),\n    ]\n\n    base_seed = 1729\n    results = []\n\n    for i, params in enumerate(test_cases):\n        n_ac_star, k_cat, k_deg, t_pulse, _, v = params\n        seed = base_seed + i\n\n        #\n        # Step 1: Deterministic Calculation\n        #\n        \n        # Synthesis rate in uM/s\n        r = (k_cat * n_ac_star) / (N_A * v) * 1e6\n        \n        # Peak deterministic concentration (at t = T_pulse)\n        if k_deg > 0:\n            c_det_peak = (r / k_deg) * (1 - np.exp(-k_deg * t_pulse))\n        else: # Edge case for k_deg = 0\n            c_det_peak = r * t_pulse\n\n        #\n        # Step 2: Stochastic Simulation (Gillespie Algorithm)\n        #\n        \n        rng = np.random.default_rng(seed)\n        \n        t = 0.0\n        n_cAMP = 0\n        n_cAMP_peak = 0\n\n        # Propensity for synthesis is constant during the pulse\n        a1 = k_cat * n_ac_star\n\n        while t  t_pulse:\n            # Propensity for degradation depends on current molecule count\n            a2 = k_deg * n_cAMP\n            \n            a0 = a1 + a2\n\n            if a0 == 0:\n                # No more reactions can occur\n                t = t_pulse # Advance time to end of pulse window\n                break\n\n            # Sample time to next reaction\n            u1 = rng.random()\n            # Ensure u1 is not zero for log, although highly improbable\n            if u1 == 0.0:\n                u1 = np.finfo(float).tiny\n            tau = -np.log(u1) / a0\n            \n            # If next reaction occurs after T_pulse, advance time to T_pulse and stop.\n            if t + tau >= t_pulse:\n                t = t_pulse\n                break\n            \n            # Advance time\n            t += tau\n\n            # Choose which reaction occurs\n            u2 = rng.random()\n            if u2 * a0 = a1:\n                # Synthesis reaction\n                n_cAMP += 1\n            else:\n                # Degradation reaction\n                n_cAMP -= 1\n            \n            # Update peak molecule count\n            if n_cAMP > n_cAMP_peak:\n                n_cAMP_peak = n_cAMP\n        \n        # Convert peak molecule count to concentration\n        c_stoch_peak = (n_cAMP_peak / (N_A * v)) * 1e6\n\n        #\n        # Step 3: Compute the Ratio\n        #\n        \n        if c_det_peak > 0:\n            ratio = c_stoch_peak / c_det_peak\n        elif c_stoch_peak == 0 and c_det_peak == 0:\n            ratio = 1.0 # Or undefined, but 1.0 is a reasonable convention\n        else:\n            ratio = np.inf\n            \n        results.append(round(ratio, 6))\n\n    # Format the final output as specified\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2761842"}]}