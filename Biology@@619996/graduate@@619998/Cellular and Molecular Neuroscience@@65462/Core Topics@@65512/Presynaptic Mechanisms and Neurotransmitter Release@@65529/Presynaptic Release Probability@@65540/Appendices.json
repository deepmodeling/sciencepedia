{"hands_on_practices": [{"introduction": "This first practice problem takes us back to the statistical roots of synaptic transmission. By analyzing the frequency of \"complete failures\"—trials where a presynaptic action potential fails to evoke any postsynaptic response—we can directly infer the single-site release probability, $p$. This exercise [@problem_id:2740466] demonstrates the power of the binomial model in a scenario where the number of release sites is known, providing a foundational tool for quantal analysis.", "problem": "A pair of excitatory cortical neurons is recorded in dual whole-cell configuration. Minimal extracellular stimulation is used to activate a single presynaptic axon that makes exactly $N=4$ anatomically verified synaptic contacts (active zones) onto the postsynaptic neuron, with each active zone harboring at most 1 readily releasable vesicle. Postsynaptic detection is assumed to be perfect, and release events at distinct sites are conditionally independent given a presynaptic action potential. Across many repeated stimuli under steady conditions, the measured fraction of stimulus trials with no detectable excitatory postsynaptic current (complete failure) is $f_{0} = 0.2401$. In a second condition, a presynaptic manipulation is applied that is independently calibrated to reduce the single-site vesicle fusion probability by a multiplicative factor $\\gamma = 0.5$ without altering the number of sites, their independence, or postsynaptic detection. Under this manipulation, the measured fraction of complete failures is $f_{\\gamma} = 0.52200625$.\n\nStarting from first principles of probability for independent Bernoulli trials, use these observations to derive and compute the baseline single-site vesicle release probability $p$ per presynaptic action potential. Express your final answer as a decimal number. Round your answer to $4$ significant figures.", "solution": "The problem will first be subjected to a rigorous validation process.\n\nStep 1: Extract Givens.\nThe explicit data provided in the problem statement are:\n- Number of synaptic contacts (active zones): $N = 4$.\n- Each active zone harbors at most 1 readily releasable vesicle.\n- Release events at distinct sites are conditionally independent.\n- Fraction of complete failures in the baseline condition: $f_{0} = 0.2401$.\n- Multiplicative factor for single-site vesicle fusion probability reduction: $\\gamma = 0.5$.\n- Fraction of complete failures in the manipulated condition: $f_{\\gamma} = 0.52200625$.\n\nStep 2: Validate Using Extracted Givens.\nThe problem is assessed for its scientific and logical integrity.\n- **Scientific Grounding**: The problem is built upon the binomial model of synaptic transmission, a fundamental and well-established framework in quantitative neuroscience for describing neurotransmitter release at synapses with multiple release sites. The scenario described—dual whole-cell recording, minimal stimulation, analysis of release failures—represents a standard experimental paradigm. The concepts of release probability, independent release sites, and quantal release are central to synaptic physiology. Therefore, the problem is scientifically grounded.\n- **Well-Posedness**: The problem provides two experimental measurements ($f_{0}$ and $f_{\\gamma}$) arising from two conditions linked by a known parameter ($\\gamma$). It asks for the determination of a single underlying parameter, the baseline release probability $p$. This setup suggests an overdetermined, but potentially consistent, system. The existence of a unique and stable solution can be determined through calculation. The problem is well-posed.\n- **Objectivity**: The problem statement is expressed in precise, quantitative, and objective language, free of ambiguity or subjective claims.\n\nStep 3: Verdict and Action.\nThe problem is deemed valid. It is scientifically sound, formally structured, and its parameters are specified. A solution will be derived from first principles.\n\nThe central principle for this problem is the binomial model of neurotransmitter release, where each of the $N$ synaptic contacts is treated as an independent Bernoulli trial. Let $p$ be the baseline probability of vesicle release at a single active zone upon the arrival of a presynaptic action potential.\n\nThe probability of a failure to release at a single site is therefore $(1 - p)$.\nA \"complete failure\" is the event where none of the $N$ independent sites release a vesicle. The probability of this compound event, $P_0$, is the product of the individual failure probabilities:\n$$ P_0 = (1 - p) \\times (1 - p) \\times \\dots \\times (1 - p) \\quad (N \\text{ times}) $$\n$$ P_0 = (1 - p)^{N} $$\nIn the context of a large number of repeated trials, the theoretical probability $P_0$ is equivalent to the measured fraction of complete failures, $f_{0}$.\nThus, for the baseline condition, we have the equation:\n$$ f_{0} = (1 - p)^{N} $$\nSubstituting the given values $f_{0} = 0.2401$ and $N = 4$:\n$$ 0.2401 = (1 - p)^{4} $$\nTo solve for $p$, we take the fourth root of both sides:\n$$ 1 - p = (0.2401)^{\\frac{1}{4}} $$\nThe value $0.2401$ is recognized as $(0.7)^{4}$, since $7^{4} = 2401$. Therefore:\n$$ 1 - p = 0.7 $$\n$$ p = 1 - 0.7 = 0.3 $$\n\nNow, we must verify this result using the data from the second, manipulated condition. In this condition, the single-site release probability is reduced by a multiplicative factor $\\gamma = 0.5$. The new release probability, which we denote $p'$, is:\n$$ p' = \\gamma p = 0.5 p $$\nThe probability of a complete failure under this new condition, $P_{\\gamma}$, is given by:\n$$ P_{\\gamma} = (1 - p')^{N} = (1 - \\gamma p)^{N} $$\nThis theoretical probability is equated to the measured fraction of failures, $f_{\\gamma} = 0.52200625$.\n$$ f_{\\gamma} = (1 - \\gamma p)^{N} $$\nSubstituting the known values for $f_{\\gamma}$, $\\gamma$, and $N$:\n$$ 0.52200625 = (1 - 0.5 p)^{4} $$\nWe can use this second equation to solve for $p$ independently and check for consistency. Taking the fourth root:\n$$ 1 - 0.5 p = (0.52200625)^{\\frac{1}{4}} $$\nLet us evaluate the fourth root of $0.52200625$. This number is $(0.85)^{4}$, since $0.85^{2} = 0.7225$ and $0.7225^{2} = 0.52200625$.\n$$ 1 - 0.5 p = 0.85 $$\n$$ 0.5 p = 1 - 0.85 $$\n$$ 0.5 p = 0.15 $$\n$$ p = \\frac{0.15}{0.5} = 0.3 $$\nBoth experimental observations yield the exact same value for the baseline release probability, $p = 0.3$. This internal consistency confirms the validity of the binomial model for this dataset and the correctness of our derived value. The problem is not only solvable but perfectly constructed.\n\nThe question requires the answer to be expressed as a decimal number rounded to $4$ significant figures. The calculated value is exactly $0.3$. To express this with $4$ significant figures, we write it as $0.3000$.", "answer": "$$\\boxed{0.3000}$$", "id": "2740466"}, {"introduction": "How can we determine release probability when the number of release sites, $N$, is unknown? A powerful strategy is to first measure the entire pool of vesicles ready for release, the Readily Releasable Pool (RRP), and then determine what fraction of this pool is released by a single action potential. This exercise [@problem_id:2740460] guides you through a classic experimental paradigm using hypertonic sucrose to measure the RRP's size, allowing you to calculate $p$ as the fraction of the RRP consumed by one stimulus.", "problem": "A cultured excitatory autapse is recorded under whole-cell voltage clamp at a holding potential of $-70$ mV. To quantify the readily releasable pool (RRP) of synaptic vesicles and link it to the presynaptic release probability $p$ for a single action potential, the following protocol is used.\n\n1. A brief hypertonic sucrose pulse ($500$ mM sucrose for $500$ ms) is applied to evoke calcium-independent fusion of the RRP. The net postsynaptic charge transfer (integral of the inward synaptic current above baseline) over the entire sucrose response is measured to be $Q_{\\text{suc}} = 1.20 \\times 10^{-10}$ C. The pulse duration is chosen such that replenishment during the pulse is negligible, and series resistance and leak are compensated such that the net synaptic charge is accurately measured.\n\n2. In the same cell, a single presynaptic action potential is evoked by a brief depolarizing command. The evoked excitatory postsynaptic current (EPSC) is integrated over a window that fully captures the synaptic current without contamination by subsequent events, yielding a charge $Q_{\\text{AP}} = 1.80 \\times 10^{-11}$ C. The interstimulus interval is made sufficiently long to avoid short-term plasticity interactions.\n\n3. Separately, miniature EPSCs (spontaneous, action-potential–independent events) are recorded in the presence of tetrodotoxin and a low-affinity competitive antagonist of $\\alpha$-amino-3-hydroxy-5-methyl-4-isoxazolepropionic acid (AMPA) receptors to promote linear summation and minimize receptor saturation/desensitization. The mean quantal charge is estimated as $q = 1.20 \\times 10^{-13}$ C.\n\nAssume the following widely accepted biophysical facts: hypertonic sucrose releases essentially all vesicles in the RRP with negligible replenishment over the integration window; within the timescale of a single action potential, replenishment is negligible; each vesicle fusion event contributes an identical quantal charge $q$ that is independent of the mode of release under these recording conditions; and postsynaptic responses sum linearly across vesicles.\n\nUnder these assumptions, compute the presynaptic release probability $p$ for a single action potential, defined as the probability that a vesicle in the RRP will be released by that action potential. Round your answer to four significant figures. Express your answer as a dimensionless decimal (no units).", "solution": "The problem is first subjected to rigorous validation. All provided information constitutes a well-defined, scientifically grounded problem in quantitative cellular neuroscience. The experimental paradigm described—using hypertonic sucrose to estimate the readily releasable pool (RRP) size and comparing it to the response evoked by a single action potential—is a standard and valid method. The given values for charge are physically realistic, and the assumptions (negligible replenishment, linear summation, uniform quantal size) are appropriate idealizations for formalizing the problem. Therefore, the problem is deemed valid, and we may proceed with the solution.\n\nThe fundamental principle underlying this problem is the quantal hypothesis of neurotransmitter release. This hypothesis states that neurotransmitter is released in discrete packets, or quanta, each corresponding to the fusion of a single synaptic vesicle. The postsynaptic response is the sum of the responses to individual quanta. Under the given experimental conditions, where postsynaptic receptor saturation and desensitization are minimized, we can assume a linear relationship between the number of released vesicles and the total postsynaptic charge transfer.\n\nLet $q$ be the mean quantal charge, representing the postsynaptic charge transfer resulting from the fusion of a single vesicle.\nThe problem provides $q = 1.20 \\times 10^{-13}$ C.\n\nThe readily releasable pool (RRP), denoted by its size $N_{\\text{RRP}}$, is the set of synaptic vesicles that are docked and primed at the presynaptic active zone, ready for immediate fusion. The experimental protocol uses a hypertonic sucrose pulse, which is assumed to cause the fusion of all vesicles in the RRP, and only those vesicles. The total charge measured during this pulse, $Q_{\\text{suc}}$, is therefore the product of the RRP size and the quantal charge.\n$$Q_{\\text{suc}} = N_{\\text{RRP}} \\cdot q$$\nFrom this relationship, we can determine the size of the RRP:\n$$N_{\\text{RRP}} = \\frac{Q_{\\text{suc}}}{q}$$\nUsing the provided values:\n$$N_{\\text{RRP}} = \\frac{1.20 \\times 10^{-10} \\text{ C}}{1.20 \\times 10^{-13} \\text{ C}} = 1000$$\nThus, the readily releasable pool contains $1000$ vesicles.\n\nNext, we consider the response to a single presynaptic action potential (AP). The total charge transfer evoked by one AP, $Q_{\\text{AP}}$, is the product of the number of vesicles released by that AP, which we denote as $N_{\\text{AP}}$, and the quantal charge $q$.\n$$Q_{\\text{AP}} = N_{\\text{AP}} \\cdot q$$\nThe value $Q_{\\text{AP}}$ is typically an average over many trials, so $N_{\\text{AP}}$ represents the mean number of vesicles released per AP. We can calculate this number:\n$$N_{\\text{AP}} = \\frac{Q_{\\text{AP}}}{q}$$\nUsing the provided values:\n$$N_{\\text{AP}} = \\frac{1.80 \\times 10^{-11} \\text{ C}}{1.20 \\times 10^{-13} \\text{ C}} = \\frac{1.8}{1.2} \\times 10^{2} = 1.5 \\times 100 = 150$$\nOn average, a single action potential triggers the release of $150$ vesicles.\n\nThe problem requires us to compute the presynaptic release probability, $p$. This is defined as the probability that any single vesicle within the RRP will be released by an action potential. The release process can be modeled as a series of independent Bernoulli trials, one for each vesicle in the RRP. The number of vesicles released by an AP, $N_{\\text{AP}}$, is therefore the expected outcome of this process. It is given by the product of the total number of available vesicles ($N_{\\text{RRP}}$) and the probability of release for each one ($p$).\n$$N_{\\text{AP}} = N_{\\text{RRP}} \\cdot p$$\nWe can now solve for the release probability $p$:\n$$p = \\frac{N_{\\text{AP}}}{N_{\\text{RRP}}}$$\nSubstituting the expressions for $N_{\\text{AP}}$ and $N_{\\text{RRP}}$ in terms of the measured charges:\n$$p = \\frac{\\left(\\frac{Q_{\\text{AP}}}{q}\\right)}{\\left(\\frac{Q_{\\text{suc}}}{q}\\right)}$$\nThe quantal charge $q$ cancels, yielding a direct relationship between the release probability and the experimentally measured charges:\n$$p = \\frac{Q_{\\text{AP}}}{Q_{\\text{suc}}}$$\nThis result is conceptually clear: the release probability is the fraction of the RRP that is released by a single action potential, as measured by the ratio of their respective total charges.\n\nWe can now substitute the given numerical values into this final expression:\n$$p = \\frac{1.80 \\times 10^{-11} \\text{ C}}{1.20 \\times 10^{-10} \\text{ C}} = \\frac{1.80}{12.0} = 0.15$$\nThe problem demands the answer be rounded to four significant figures. Therefore, we express the result as $0.1500$.\nThis value for release probability is typical for many central excitatory synapses, confirming the consistency of the problem's parameters with known neurophysiological data.", "answer": "$$\\boxed{0.1500}$$", "id": "2740460"}, {"introduction": "Moving beyond single-point estimates, our final practice delves into a more powerful and comprehensive method: variance-mean analysis. By examining how the variance of synaptic responses changes as the mean response is altered (for example, by varying extracellular calcium), we can fit a model to uncover not just the release probability $p$, but also the number of release sites $N$ and the quantal size $q$. This exercise [@problem_id:2740477] involves both theoretical derivation and computational implementation, reflecting the modern practice of quantitative synaptic physiology.", "problem": "You are given a theoretical framework for synaptic transmission in which vesicular release at a single synapse follows a binomial process. The number of readily releasable vesicles is $N$, the probability that any vesicle releases upon an action potential is $p$, and each vesicle produces an identical postsynaptic quantal current of amplitude $q$ in arbitrary units. Measured synaptic current amplitudes are corrupted by independent, additive, zero-mean noise with variance $\\sigma_n^2$, with no other sources of noise. Assume vesicle releases are independent and identically distributed, and that the noise is independent of presynaptic release. Under these assumptions, for repeated trials at a fixed extracellular calcium level, denote by $\\mu$ the mean amplitude across trials and by $v$ the variance across trials. Across different calcium levels, $p$ may change, but $N$, $q$, and $\\sigma_n^2$ remain constant.\n\nTask 1 (derivation): Starting only from the definitions of the binomial distribution and the linearity of expectation and variance for independent random variables, derive an explicit analytical relationship between the variance $v$ and the mean $\\mu$ that holds when $p$ varies while $N$, $q$, and $\\sigma_n^2$ are fixed. Show that this relationship is a quadratic function of $\\mu$ with coefficients that depend only on $N$, $q$, and $\\sigma_n^2$.\n\nTask 2 (estimation): Design an algorithm that, given a finite set of measured pairs $\\{(\\mu_i, v_i)\\}_{i=1}^M$ collected at different calcium levels (and thus different $p_i$), estimates $N$, $q$, and $\\sigma_n^2$ by fitting the variance–mean relationship you derived in Task 1. Your estimator must enforce the physically consistent constraints $q \\ge 0$, $N > 0$ (equivalently, a concave-down quadratic), and $\\sigma_n^2 \\ge 0$. Use a least-squares approach that fits a quadratic in $\\mu$ to the $(\\mu_i,v_i)$ data under these constraints, and then maps the fitted quadratic coefficients to estimates of $N$, $q$, and $\\sigma_n^2$. Express $N$, $q$, and $\\sigma_n^2$ as real-valued outputs (do not round to integers), each rounded to six decimal places.\n\nTest suite: Apply your estimator to the following three datasets. Each dataset lists $(\\mu,v)$ pairs in arbitrary current units; each pair corresponds to a distinct calcium level. The underlying $N$, $q$, and $\\sigma_n^2$ used to generate these data are held fixed within each dataset but are not to be used directly by your estimator (they are provided only to justify scientific plausibility). Your program must only use the $(\\mu,v)$ pairs.\n\n- Dataset A (general case; underlying $N = 50$, $q = 0.4$, $\\sigma_n^2 = 0.02$), pairs:\n  $(\\mu, v) \\in \\{(2.0, 0.74), (4.0, 1.3), (10.0, 2.02), (16.0, 1.3), (18.0, 0.74)\\}$.\n\n- Dataset B (large $N$, small $q$; underlying $N = 200$, $q = 0.05$, $\\sigma_n^2 = 0.005$), pairs:\n  $(\\mu, v) \\in \\{(0.5, 0.02875), (2.5, 0.09875), (5.0, 0.13), (7.5, 0.09875), (9.5, 0.02875)\\}$.\n\n- Dataset C (boundary including near-deterministic release; underlying $N = 5$, $q = 1.2$, $\\sigma_n^2 = 0.1$), pairs:\n  $(\\mu, v) \\in \\{(0.6, 0.748), (3.0, 1.9), (5.4, 0.748), (6.0, 0.1)\\}$.\n\nProgram requirements:\n- Implement the estimator described in Task 2 and apply it to each dataset independently to obtain $(\\hat{N},\\hat{q},\\widehat{\\sigma_n^2})$.\n- The final output must be a single line containing a list of three sublists, one per dataset, in the order A, B, C. Each sublist must be of the form $[\\hat{N},\\hat{q},\\widehat{\\sigma_n^2}]$, where each entry is a float rounded to six decimal places.\n- Final output format: a single line with a comma-separated list enclosed in square brackets, with the three sublists inside, for example $[[x_1,y_1,z_1],[x_2,y_2,z_2],[x_3,y_3,z_3]]$. Do not include any units or percentage signs; all values are in arbitrary units.\n\nAngle units are not applicable. Percentages must not be used; probabilities are implicit within the model and are not reported. The answer types are floats only, rounded to six decimal places, and the final output line must match the specified format exactly.", "solution": "The problem presented is a valid and well-posed exercise in quantitative neuroscience, specifically in the application of quantal analysis. It is scientifically grounded in the canonical binomial model of synaptic transmission, is mathematically self-contained, and uses objective, unambiguous language. We shall proceed with the derivation and then the design of the estimation algorithm.\n\n### Task 1: Derivation of the Variance-Mean Relationship\n\nThe problem begins with fundamental assumptions about synaptic transmission. Let $k$ be the random variable for the number of vesicles released upon a single action potential. This process is modeled as a binomial distribution, $k \\sim \\text{Binomial}(N, p)$, where $N$ is the total number of readily releasable vesicles and $p$ is the probability of release for any individual vesicle.\n\nThe mean and variance of the binomial random variable $k$ are given by its standard definitions:\n$$ E[k] = Np $$\n$$ Var(k) = Np(1-p) $$\n\nEach released vesicle contributes a quantal current of amplitude $q$. The total current from all released vesicles is thus $k \\cdot q$. The measured synaptic current amplitude, which we denote as the random variable $A$, is the sum of this synaptic current and an independent, additive noise term, $\\eta$.\n$$ A = k \\cdot q + \\eta $$\nThe noise $\\eta$ is specified to have a mean of zero and a variance of $\\sigma_n^2$.\n$$ E[\\eta] = 0 $$\n$$ Var(\\eta) = \\sigma_n^2 $$\n\nWe are tasked to find the relationship between the mean of the measured amplitude, $\\mu = E[A]$, and its variance, $v = Var(A)$.\n\nFirst, we calculate the mean amplitude $\\mu$. By the linearity of expectation:\n$$ \\mu = E[A] = E[k \\cdot q + \\eta] = E[k \\cdot q] + E[\\eta] $$\nSince $q$ is a constant, it can be factored out of the expectation:\n$$ \\mu = q \\cdot E[k] + E[\\eta] $$\nSubstituting the known expectations for $k$ and $\\eta$:\n$$ \\mu = q(Np) + 0 = Npq $$\n\nNext, we calculate the variance of the amplitude, $v$. The problem states that vesicle release and the noise process are independent. Consequently, the random variables $k$ and $\\eta$ are independent. This implies that $k \\cdot q$ and $\\eta$ are also independent. For independent random variables, the variance of the sum is the sum of the variances:\n$$ v = Var(A) = Var(k \\cdot q + \\eta) = Var(k \\cdot q) + Var(\\eta) $$\nUsing the property $Var(c X) = c^2 Var(X)$ for a constant $c$:\n$$ Var(k \\cdot q) = q^2 Var(k) $$\nSubstituting the known variances for $k$ and $\\eta$:\n$$ v = q^2 (Np(1-p)) + \\sigma_n^2 $$\n\nWe now have two equations relating the observables $\\mu$ and $v$ to the underlying parameters, including the variable $p$:\n1.  $\\mu = Npq$\n2.  $v = Npq^2(1-p) + \\sigma_n^2$\n\nTo find a relationship between $v$ and $\\mu$ that is independent of $p$, we must eliminate $p$. From equation (1), we solve for $p$:\n$$ p = \\frac{\\mu}{Nq} $$\nThis expression is valid for $0 \\le \\mu \\le Nq$, which corresponds to the physical range $0 \\le p \\le 1$.\n\nWe substitute this expression for $p$ into equation (2):\n$$ v = Nq^2 \\left(\\frac{\\mu}{Nq}\\right) \\left(1 - \\frac{\\mu}{Nq}\\right) + \\sigma_n^2 $$\nSimplifying the expression:\n$$ v = q\\mu \\left(1 - \\frac{\\mu}{Nq}\\right) + \\sigma_n^2 $$\n$$ v = q\\mu - \\frac{q\\mu^2}{Nq} + \\sigma_n^2 $$\n$$ v = q\\mu - \\frac{\\mu^2}{N} + \\sigma_n^2 $$\n\nFinally, we arrange this into the form of a quadratic function of $\\mu$, $v(\\mu) = a\\mu^2 + b\\mu + c$:\n$$ v(\\mu) = \\left(-\\frac{1}{N}\\right)\\mu^2 + (q)\\mu + (\\sigma_n^2) $$\nThis completes the derivation. The relationship is a parabolic function of $\\mu$. The coefficients of this quadratic depend only on the fixed parameters $N$, $q$, and $\\sigma_n^2$, as required:\n$$ a = -\\frac{1}{N} $$\n$$ b = q $$\n$$ c = \\sigma_n^2 $$\n\n### Task 2: Estimation Algorithm Design\n\nThe goal is to estimate $N$, $q$, and $\\sigma_n^2$ from a set of experimental data points $\\{(\\mu_i, v_i)\\}_{i=1}^M$. Based on the derived relationship, we can fit a quadratic model to this data. The problem demands a least-squares approach while enforcing physical consistency constraints:\n-   $N > 0$ (number of vesicles must be positive)\n-   $q \\ge 0$ (quantal size is non-negative)\n-   $\\sigma_n^2 \\ge 0$ (variance is non-negative)\n\nThese constraints on the physical parameters translate to constraints on the quadratic coefficients $(a, b, c)$:\n-   $a = -1/N \\implies a < 0$ (the parabola must be concave-down)\n-   $b = q \\implies b \\ge 0$\n-   $c = \\sigma_n^2 \\implies c \\ge 0$\n\nWe must solve a constrained linear least-squares problem. For each data point $(\\mu_i, v_i)$, we have the equation $v_i \\approx a\\mu_i^2 + b\\mu_i + c$. This system can be expressed in matrix form as $\\mathbf{X\\beta} \\approx \\mathbf{v}$, where:\n$$ \\mathbf{X} = \\begin{pmatrix} \\mu_1^2 & \\mu_1 & 1 \\\\ \\mu_2^2 & \\mu_2 & 1 \\\\ \\vdots & \\vdots & \\vdots \\\\ \\mu_M^2 & \\mu_M & 1 \\end{pmatrix}, \\quad \\mathbf{\\beta} = \\begin{pmatrix} a \\\\ b \\\\ c \\end{pmatrix}, \\quad \\mathbf{v} = \\begin{pmatrix} v_1 \\\\ v_2 \\\\ \\vdots \\\\ v_M \\end{pmatrix} $$\n\nThe objective is to find the vector $\\hat{\\mathbf{\\beta}} = [\\hat{a}, \\hat{b}, \\hat{c}]^T$ that minimizes the sum of squared errors, $||\\mathbf{X\\beta} - \\mathbf{v}||_2^2$, subject to the constraints $\\hat{a} \\le 0$, $\\hat{b} \\ge 0$, and $\\hat{c} \\ge 0$. Note that the strict inequality $a < 0$ is implemented as $a \\le 0$, where the boundary case $a=0$ corresponds to the physical limit of an infinite vesicle pool ($N \\to \\infty$).\n\nThis constrained optimization problem can be solved using standard numerical libraries. The algorithm is as follows:\n1.  For each provided dataset of $(\\mu, v)$ pairs.\n2.  Construct the design matrix $\\mathbf{X}$ and the observation vector $\\mathbf{v}$.\n3.  Use a constrained least-squares solver to find coefficients $\\mathbf{\\beta} = [a,b,c]^T$ with bounds $([-\\infty, 0], [0, \\infty], [0, \\infty])$.\n4.  From the resulting coefficients $(\\hat{a}, \\hat{b}, \\hat{c})$, calculate the physical parameter estimates $(\\hat{N}, \\hat{q}, \\widehat{\\sigma_n^2})$.\n5.  Round the estimates to six decimal places as required.\n6.  Collect the results for all datasets and format them into the specified output string.\n\nThe provided test data are perfectly consistent with the model, meaning the data points lie exactly on a parabola. The following code implements this algorithm.\n\n```python\nimport numpy as np\nfrom scipy.optimize import lsq_linear\n\ndef solve_for_params(dataset):\n    \"\"\"\n    Solves the quantal analysis problem for a single dataset.\n    \"\"\"\n    data_array = np.array(dataset)\n    mu = data_array[:, 0]\n    v = data_array[:, 1]\n    \n    # We are fitting the model v = a*mu^2 + b*mu + c\n    # The design matrix X has columns [mu^2, mu, 1]\n    X = np.vstack([mu**2, mu, np.ones(len(mu))]).T\n    \n    # We need to find the coefficients beta = [a, b, c]\n    \n    # The physical constraints are:\n    # N > 0  => a = -1/N  0\n    # q >= 0 => b >= 0\n    # sigma_n^2 >= 0 => c >= 0\n    # This translates to bounds on the coefficients [a, b, c].\n    bounds = ([-np.inf, 0, 0], [0, np.inf, np.inf])\n    \n    # Use constrained linear least-squares from SciPy\n    result = lsq_linear(X, v, bounds=bounds)\n    a_hat, b_hat, c_hat = result.x\n    \n    # Convert fitted coefficients back to physical parameters\n    # N_hat = -1 / a_hat\n    # q_hat = b_hat\n    # sigma_n2_hat = c_hat\n    \n    # Handle the edge case where a_hat is numerically zero (implying N -> infinity)\n    if np.isclose(a_hat, 0):\n        N_hat = np.inf\n    else:\n        N_hat = -1.0 / a_hat\n        \n    q_hat = b_hat\n    sigma_n2_hat = c_hat\n    \n    return [N_hat, q_hat, sigma_n2_hat]\n\n# Datasets can be processed with this function to get the results.\n```", "answer": "```\n[[50.000000,0.400000,0.020000],[200.000000,0.050000,0.005000],[5.000000,1.200000,0.100000]]\n```", "id": "2740477"}]}