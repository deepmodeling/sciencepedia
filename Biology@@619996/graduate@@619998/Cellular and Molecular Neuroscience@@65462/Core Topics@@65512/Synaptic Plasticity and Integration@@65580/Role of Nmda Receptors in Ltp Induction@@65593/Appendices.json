{"hands_on_practices": [{"introduction": "The NMDA receptor's unique ability to act as a molecular coincidence detector is central to its role in LTP induction. This practice delves into the biophysical basis of this property by modeling how the precise timing between presynaptic glutamate release and a postsynaptic action potential dictates the extent of receptor activation. By calculating a coincidence integral for causal and anti-causal pairings [@problem_id:2749440], you will gain a quantitative understanding of the molecular origins of spike-timing-dependent plasticity (STDP).", "problem": "A single excitatory synapse onto a cortical pyramidal neuron is modeled to assess how N-Methyl-D-aspartate (NMDA) receptor contribution depends on spike timing during Long-Term Potentiation (LTP) induction. Assume the following biophysically grounded ingredients:\n\n- Presynaptic glutamate release at time $t=0$ instantaneously activates NMDA receptors with an open probability $s(t)$ that decays mono-exponentially as $s(t)=\\exp(-t/\\tau)$ for $t \\ge 0$, with decay time constant $\\tau=80~\\text{ms}$, and $s(t)=0$ for $t<0$.\n- A backpropagating action potential (bAP) in the postsynaptic neuron is approximated by a square pulse in membrane potential: $V(t)=+30~\\text{mV}$ for a duration of $2~\\text{ms}$ starting at $t=\\Delta t$ (i.e., over $t \\in [\\Delta t, \\Delta t+2~\\text{ms}]$), and $V(t)=V_{\\mathrm{rest}}=-65~\\text{mV}$ otherwise.\n- The voltage-dependent relief of magnesium block is represented by the empirically established factor\n$$\nB(V) \\;=\\; \\frac{1}{1 + \\alpha \\exp(-\\beta V)} \\quad \\text{with} \\quad \\alpha=\\frac{[\\text{Mg}^{2+}]}{3.57},\\ \\beta=0.062~\\text{mV}^{-1},\n$$\nat extracellular magnesium concentration $[\\text{Mg}^{2+}]=1~\\text{mM}$.\n- For LTP induction, NMDA-dependent coincidence is often well approximated by a proxy proportional to the time-integral of $s(t) B(V(t))$, which captures the overlap between ligand binding and relief of magnesium block. Define this NMDA coincidence integral as\n$$\nQ(\\Delta t) \\;=\\; \\int_{0}^{\\infty} s(t)\\,B(V(t))\\,dt.\n$$\n\nUsing only the specified ingredients and assumptions, compute the relative NMDA coincidence for a causal pairing ($\\Delta t=+10~\\text{ms}$) versus an anti-causal pairing ($\\Delta t=-10~\\text{ms}$), defined as the ratio\n$$\nR \\;=\\; \\frac{Q(+10~\\text{ms})}{Q(-10~\\text{ms})}.\n$$\nExpress your final result as a dimensionless number and round your answer to three significant figures.", "solution": "The problem statement has been rigorously examined and found to be valid. It is scientifically grounded in established principles of cellular neuroscience, it is well-posed with all necessary information provided, and it is expressed in objective, formal language. There are no contradictions, ambiguities, or factual inaccuracies. We may therefore proceed with the solution.\n\nThe task is to compute the ratio $R$ of the NMDA coincidence integral $Q(\\Delta t)$ for a causal timing ($\\Delta t_c = +10~\\text{ms}$) versus an anti-causal timing ($\\Delta t_{ac} = -10~\\text{ms}$):\n$$\nR = \\frac{Q(\\Delta t_c)}{Q(\\Delta t_{ac})} = \\frac{Q(+10~\\text{ms})}{Q(-10~\\text{ms})}\n$$\nThe integral is defined as:\n$$\nQ(\\Delta t) = \\int_{0}^{\\infty} s(t)\\,B(V(t))\\,dt\n$$\nwhere $s(t) = \\exp(-t/\\tau)$ for $t \\ge 0$, with $\\tau=80~\\text{ms}$.\n\nFirst, we analyze the voltage-dependent magnesium block factor, $B(V)$. The membrane potential $V(t)$ assumes two values: the resting potential, $V_{\\text{rest}} = -65~\\text{mV}$, and the potential during the backpropagating action potential (bAP), $V_{\\text{bAP}} = +30~\\text{mV}$. Let us define the corresponding block-relief factors as $B_{\\text{rest}}$ and $B_{\\text{bAP}}$.\n\nThe parameters for $B(V) = (1 + \\alpha \\exp(-\\beta V))^{-1}$ are:\n$\\beta = 0.062~\\text{mV}^{-1}$\n$[\\text{Mg}^{2+}] = 1~\\text{mM}$\n$\\alpha = \\frac{[\\text{Mg}^{2+}]}{3.57} = \\frac{1}{3.57}$\n\nAt rest, $V = V_{\\text{rest}} = -65~\\text{mV}$:\n$$\nB_{\\text{rest}} = B(V_{\\text{rest}}) = \\frac{1}{1 + \\alpha \\exp(-\\beta V_{\\text{rest}})}\n$$\nDuring the bAP, $V = V_{\\text{bAP}} = +30~\\text{mV}$:\n$$\nB_{\\text{bAP}} = B(V_{\\text{bAP}}) = \\frac{1}{1 + \\alpha \\exp(-\\beta V_{\\text{bAP}})}\n$$\n\nNext, we evaluate the integral $Q(\\Delta t)$ for the two specified timings.\n\n**1. Anti-causal pairing ($\\Delta t = -10~\\text{ms}$)**\n\nFor the anti-causal case, $\\Delta t_{ac} = -10~\\text{ms}$. The bAP is a square pulse of duration $\\Delta T_{\\text{bAP}} = 2~\\text{ms}$, occurring over the time interval $t \\in [-10~\\text{ms}, -8~\\text{ms}]$. The integral for $Q$ starts at $t=0$. Since the bAP is entirely finished before $t=0$, the membrane potential $V(t)$ for all $t \\ge 0$ is constantly at the resting potential, $V(t) = V_{\\text{rest}}$.\nTherefore, for $t \\ge 0$, the magnesium block factor is constant: $B(V(t)) = B(V_{\\text{rest}}) = B_{\\text{rest}}$.\n\nThe integral for the anti-causal case, $Q(-10~\\text{ms})$, becomes:\n$$\nQ(-10~\\text{ms}) = \\int_{0}^{\\infty} \\exp(-t/\\tau) B_{\\text{rest}} dt = B_{\\text{rest}} \\int_{0}^{\\infty} \\exp(-t/\\tau) dt\n$$\nThe integral of the exponential decay is:\n$$\n\\int_{0}^{\\infty} \\exp(-t/\\tau) dt = [-\\tau \\exp(-t/\\tau)]_{0}^{\\infty} = -\\tau(0 - 1) = \\tau\n$$\nThus, the coincidence integral for the anti-causal pairing is:\n$$\nQ(-10~\\text{ms}) = \\tau B_{\\text{rest}}\n$$\n\n**2. Causal pairing ($\\Delta t = +10~\\text{ms}$)**\n\nFor the causal case, $\\Delta t_c = +10~\\text{ms}$. The bAP occurs over the time interval $t \\in [10~\\text{ms}, 12~\\text{ms}]$. This interval lies entirely within the integration domain $t \\ge 0$.\nThe function $B(V(t))$ is now piecewise:\n$$\nB(V(t)) = \\begin{cases} B_{\\text{bAP}} & \\text{for } t \\in [10~\\text{ms}, 12~\\text{ms}] \\\\ B_{\\text{rest}} & \\text{otherwise} \\end{cases}\n$$\nWe split the integral accordingly:\n$$\nQ(+10~\\text{ms}) = \\int_{0}^{10} \\exp(-t/\\tau) B_{\\text{rest}} dt + \\int_{10}^{12} \\exp(-t/\\tau) B_{\\text{bAP}} dt + \\int_{12}^{\\infty} \\exp(-t/\\tau) B_{\\text{rest}} dt\n$$\nThis expression can be more conveniently written by separating the baseline contribution from the additional contribution during the bAP:\n$$\nQ(+10~\\text{ms}) = \\int_{0}^{\\infty} \\exp(-t/\\tau) B_{\\text{rest}} dt + \\int_{10}^{12} \\exp(-t/\\tau) (B_{\\text{bAP}} - B_{\\text{rest}}) dt\n$$\nThe first term is identical to $Q(-10~\\text{ms})$, which is $\\tau B_{\\text{rest}}$. The second term is evaluated as:\n$$\n\\int_{10}^{12} \\exp(-t/\\tau) dt = [-\\tau \\exp(-t/\\tau)]_{10}^{12} = -\\tau(\\exp(-12/\\tau) - \\exp(-10/\\tau)) = \\tau(\\exp(-10/\\tau) - \\exp(-12/\\tau))\n$$\nSo, the coincidence integral for the causal pairing is:\n$$\nQ(+10~\\text{ms}) = \\tau B_{\\text{rest}} + \\tau (B_{\\text{bAP}} - B_{\\text{rest}}) \\left( \\exp\\left(-\\frac{10}{\\tau}\\right) - \\exp\\left(-\\frac{12}{\\tau}\\right) \\right)\n$$\n\n**3. The Ratio R**\n\nWe can now compute the ratio $R$:\n$$\nR = \\frac{Q(+10~\\text{ms})}{Q(-10~\\text{ms})} = \\frac{\\tau B_{\\text{rest}} + \\tau (B_{\\text{bAP}} - B_{\\text{rest}}) \\left( \\exp\\left(-\\frac{10}{\\tau}\\right) - \\exp\\left(-\\frac{12}{\\tau}\\right) \\right)}{\\tau B_{\\text{rest}}}\n$$\nDividing the numerator by the denominator $\\tau B_{\\text{rest}}$ yields:\n$$\nR = 1 + \\left(\\frac{B_{\\text{bAP}}}{B_{\\text{rest}}} - 1\\right) \\left( \\exp\\left(-\\frac{10}{\\tau}\\right) - \\exp\\left(-\\frac{12}{\\tau}\\right) \\right)\n$$\nThe ratio of the block factors is:\n$$\n\\frac{B_{\\text{bAP}}}{B_{\\text{rest}}} = \\frac{1 + \\alpha \\exp(-\\beta V_{\\text{rest}})}{1 + \\alpha \\exp(-\\beta V_{\\text{bAP}})}\n$$\nNow, we substitute the numerical values:\n$\\tau = 80~\\text{ms}$\n$V_{\\text{rest}} = -65~\\text{mV}$\n$V_{\\text{bAP}} = +30~\\text{mV}$\n$\\alpha = 1/3.57 \\approx 0.280112$\n$\\beta = 0.062~\\text{mV}^{-1}$\n\nFirst, we compute the arguments of the exponentials for the $B(V)$ terms:\n$-\\beta V_{\\text{rest}} = -0.062 \\times (-65) = 4.03$\n$-\\beta V_{\\text{bAP}} = -0.062 \\times 30 = -1.86$\n\nNow, the ratio of the block factors:\n$$\n\\frac{B_{\\text{bAP}}}{B_{\\text{rest}}} = \\frac{1 + \\frac{1}{3.57} \\exp(4.03)}{1 + \\frac{1}{3.57} \\exp(-1.86)} \\approx \\frac{1 + 0.280112 \\times 56.2591}{1 + 0.280112 \\times 0.155673} \\approx \\frac{1 + 15.7588}{1 + 0.043606} = \\frac{16.7588}{1.043606} \\approx 16.059\n$$\nNext, we compute the temporal decay factor:\n$$\n\\exp\\left(-\\frac{10}{80}\\right) - \\exp\\left(-\\frac{12}{80}\\right) = \\exp(-0.125) - \\exp(-0.15) \\approx 0.882497 - 0.860708 = 0.021789\n$$\nFinally, we compute $R$:\n$$\nR \\approx 1 + (16.059 - 1) \\times 0.021789 = 1 + 15.059 \\times 0.021789 \\approx 1 + 0.32813 = 1.32813\n$$\nRounding the final result to three significant figures gives $1.33$. This demonstrates that the causal pairing of presynaptic activity followed by a postsynaptic spike produces a significantly larger NMDA-mediated calcium influx proxy than the anti-causal pairing, which is a cornerstone of Hebbian learning rules like STDP.", "answer": "$$\n\\boxed{1.33}\n$$", "id": "2749440"}, {"introduction": "Following NMDA receptor activation, the influx of calcium ions ($Ca^{2+}$) serves as the critical second messenger to trigger downstream plasticity cascades. This exercise models the dynamics of intracellular calcium, accounting for key cellular processes like buffering and extrusion that shape the signal. You will derive an analytical expression for the minimum calcium influx required to induce LTP [@problem_id:2749495], revealing how the biochemical environment of a spine can set the threshold for synaptic modification.", "problem": "A central hypothesis in cellular and molecular neuroscience is that long-term potentiation (LTP) induction in a dendritic spine is triggered when the time-integrated free calcium signal exceeds a biochemical threshold during a finite integration window. Consider a single well-mixed spine compartment in which calcium enters through N-methyl-D-aspartate (NMDA) receptors during a brief pairing protocol that relieves magnesium block. Let the free calcium concentration be $C(t) \\equiv [Ca^{2+}]_{\\text{free}}(t)$ above baseline, the NMDA-mediated calcium influx per unit volume be $J_{\\mathrm{NMDA}}$ (assumed constant over the stimulus duration), the stimulus duration be $\\tau$ with $0 < \\tau \\le T$, the biochemical integration window be $T > 0$, the first-order extrusion rate constant be $k > 0$, and the fast buffer capacity be $\\kappa \\ge 0$ (defined as the ratio of incremental bound to free calcium at equilibrium). Assume the rapid buffer approximation holds and that extrusion acts on free calcium, so that calcium dynamics obey the linear ordinary differential equation\n$$(1+\\kappa)\\,\\frac{dC}{dt} \\;=\\; J_{\\mathrm{NMDA}}\\,u(t;\\tau) \\;-\\; k\\,C(t),$$\nwith initial condition $C(0)=0$, where $u(t;\\tau)=1$ for $0 \\le t < \\tau$ and $u(t;\\tau)=0$ for $t \\ge \\tau$. LTP induction is assumed to occur when the time-integrated free calcium over the window $[0,T]$ reaches a fixed threshold $\\Theta>0$:\n$$\\int_{0}^{T} C(t)\\,dt \\;\\ge\\; \\Theta.$$\nStarting only from these definitions and assumptions, derive an exact closed-form expression for the minimal NMDA-mediated calcium influx $J_{\\mathrm{NMDA}}^{\\mathrm{th}}(\\kappa)$ required to satisfy $\\int_{0}^{T} C(t)\\,dt = \\Theta$ as a function of $\\kappa$, $k$, $\\tau$, and $T$. Express your final answer as a single analytic expression in terms of $\\Theta$, $\\kappa$, $k$, $\\tau$, and $T$. Do not approximate. State clearly how increasing $\\kappa$ shifts the threshold in your derivation. The final answer must be a single closed-form expression; do not include units in the final answer.", "solution": "The problem as stated is scientifically grounded, well-posed, and objective. It presents a standard mathematical model of calcium dynamics and asks for the derivation of a threshold quantity based on clear definitions and constraints. There are no logical inconsistencies or factual errors. We may therefore proceed directly with the derivation.\n\nThe dynamics of the free calcium concentration $C(t)$ are governed by the linear ordinary differential equation:\n$$(1+\\kappa)\\,\\frac{dC}{dt} + k\\,C(t) \\;=\\; J_{\\mathrm{NMDA}}\\,u(t;\\tau)$$\nwith the initial condition $C(0)=0$. The function $u(t;\\tau)$ is a step function, equal to $1$ for $0 \\le t < \\tau$ and $0$ for $t \\ge \\tau$. The goal is to find the threshold influx $J_{\\mathrm{NMDA}}^{\\mathrm{th}}$ such that the total integrated free calcium over the interval $[0,T]$ equals a threshold $\\Theta$:\n$$\\int_{0}^{T} C(t)\\,dt \\;=\\; \\Theta$$\n\nA direct and efficient method is to integrate the differential equation itself with respect to time from $t=0$ to $t=T$:\n$$\\int_{0}^{T} \\left( (1+\\kappa)\\frac{dC}{dt} + k\\,C(t) \\right) dt \\;=\\; \\int_{0}^{T} J_{\\mathrm{NMDA}}\\,u(t;\\tau) dt$$\nThe left side becomes:\n$$(1+\\kappa) \\int_{0}^{T} \\frac{dC}{dt} dt + k \\int_{0}^{T} C(t) dt \\;=\\; (1+\\kappa) [C(t)]_{0}^{T} + k \\int_{0}^{T} C(t) dt$$\nGiven $C(0)=0$, this simplifies to $(1+\\kappa)C(T) + k \\int_{0}^{T} C(t) dt$.\nThe right side integral is:\n$$J_{\\mathrm{NMDA}} \\int_{0}^{T} u(t;\\tau) dt \\;=\\; J_{\\mathrm{NMDA}} \\int_{0}^{\\tau} 1\\,dt \\;=\\; J_{\\mathrm{NMDA}}\\tau$$\nEquating the two sides gives a relation between the desired integral and the calcium concentration at time $T$:\n$$(1+\\kappa)C(T) + k \\int_{0}^{T} C(t) dt \\;=\\; J_{\\mathrm{NMDA}}\\tau$$\nTo find $\\int_{0}^{T} C(t) dt$, we must first determine $C(T)$. This requires solving the ODE. Let us define an effective rate constant $k' = \\frac{k}{1+\\kappa}$. The ODE is $\\frac{dC}{dt} + k'C = \\frac{J_{\\mathrm{NMDA}}}{1+\\kappa}u(t;\\tau)$.\n\nFor the interval $0 \\le t < \\tau$, the equation is $\\frac{dC}{dt} + k'C = \\frac{J_{\\mathrm{NMDA}}}{1+\\kappa}$. The solution with $C(0)=0$ is:\n$$C(t) = \\frac{J_{\\mathrm{NMDA}}/(1+\\kappa)}{k'} (1 - \\exp(-k't)) = \\frac{J_{\\mathrm{NMDA}}}{k}(1 - \\exp(-k't))$$\nAt the end of the stimulus, $t=\\tau$, the concentration is:\n$$C(\\tau) = \\frac{J_{\\mathrm{NMDA}}}{k}(1 - \\exp(-k'\\tau))$$\n\nFor the interval $t \\ge \\tau$, the equation is the homogeneous equation $\\frac{dC}{dt} + k'C = 0$. The solution is exponential decay from the value at $t=\\tau$:\n$$C(t) = C(\\tau) \\exp(-k'(t-\\tau))$$\nSubstituting the expression for $C(\\tau)$, we obtain the solution for $t \\ge \\tau$:\n$$C(t) = \\frac{J_{\\mathrm{NMDA}}}{k}(1 - \\exp(-k'\\tau)) \\exp(-k'(t-\\tau))$$\nWe require the value at $t=T$ (since $\\tau \\le T$, this expression is valid):\n$$C(T) = \\frac{J_{\\mathrm{NMDA}}}{k}(1 - \\exp(-k'\\tau)) \\exp(-k'(T-\\tau))$$\nSubstituting back $k' = \\frac{k}{1+\\kappa}$:\n$$C(T) = \\frac{J_{\\mathrm{NMDA}}}{k}\\left(1 - \\exp\\left(-\\frac{k\\tau}{1+\\kappa}\\right)\\right) \\exp\\left(-\\frac{k(T-\\tau)}{1+\\kappa}\\right)$$\n\nNow, we substitute this expression for $C(T)$ into our integrated relation:\n$$(1+\\kappa) \\left[ \\frac{J_{\\mathrm{NMDA}}}{k}\\left(1 - \\exp\\left(-\\frac{k\\tau}{1+\\kappa}\\right)\\right) \\exp\\left(-\\frac{k(T-\\tau)}{1+\\kappa}\\right) \\right] + k \\int_{0}^{T} C(t) dt = J_{\\mathrm{NMDA}}\\tau$$\nWe solve for the integral:\n$$k \\int_{0}^{T} C(t) dt = J_{\\mathrm{NMDA}}\\tau - \\frac{J_{\\mathrm{NMDA}}(1+\\kappa)}{k}\\left(1 - \\exp\\left(-\\frac{k\\tau}{1+\\kappa}\\right)\\right) \\exp\\left(-\\frac{k(T-\\tau)}{1+\\kappa}\\right)$$\n$$\\int_{0}^{T} C(t) dt = \\frac{J_{\\mathrm{NMDA}}}{k^2} \\left[ k\\tau - (1+\\kappa)\\left(\\exp\\left(-\\frac{k(T-\\tau)}{1+\\kappa}\\right) - \\exp\\left(-\\frac{k\\tau}{1+\\kappa}\\right)\\exp\\left(-\\frac{k(T-\\tau)}{1+\\kappa}\\right)\\right) \\right]$$\n$$\\int_{0}^{T} C(t) dt = \\frac{J_{\\mathrm{NMDA}}}{k^2} \\left[ k\\tau - (1+\\kappa)\\left(\\exp\\left(-\\frac{k(T-\\tau)}{1+\\kappa}\\right) - \\exp\\left(-\\frac{kT}{1+\\kappa}\\right)\\right) \\right]$$\nThis expression relates the integrated calcium signal to the influx $J_{\\mathrm{NMDA}}$ and the system parameters.\n\nTo find the threshold influx $J_{\\mathrm{NMDA}}^{\\mathrm{th}}$, we set this integral equal to $\\Theta$ and solve for $J_{\\mathrm{NMDA}}$:\n$$\\Theta = \\frac{J_{\\mathrm{NMDA}}^{\\mathrm{th}}}{k^2} \\left[ k\\tau - (1+\\kappa)\\left(\\exp\\left(-\\frac{k(T-\\tau)}{1+\\kappa}\\right) - \\exp\\left(-\\frac{kT}{1+\\kappa}\\right)\\right) \\right]$$\n$$J_{\\mathrm{NMDA}}^{\\mathrm{th}}(\\kappa) = \\frac{k^2 \\Theta}{k\\tau - (1+\\kappa)\\left(\\exp\\left(-\\frac{k(T-\\tau)}{1+\\kappa}\\right) - \\exp\\left(-\\frac{kT}{1+\\kappa}\\right)\\right)}$$\nThis is the required exact closed-form expression.\n\nThe problem also requires an analysis of how increasing $\\kappa$ affects this threshold. We must examine the denominator of the expression for $J_{\\mathrm{NMDA}}^{\\mathrm{th}}(\\kappa)$, which we denote by $D(\\kappa)$:\n$$D(\\kappa) = k\\tau - (1+\\kappa)\\left(\\exp\\left(-\\frac{k(T-\\tau)}{1+\\kappa}\\right) - \\exp\\left(-\\frac{kT}{1+\\kappa}\\right)\\right)$$\nThe dependence of $J_{\\mathrm{NMDA}}^{\\mathrm{th}}$ on $\\kappa$ is inversely related to the dependence of $D(\\kappa)$ on $\\kappa$. Let us compute the derivative $\\frac{dD}{d\\kappa}$. Let $y = 1+\\kappa$, $A = k(T-\\tau)$, and $B = kT$. Since $k > 0$ and $T \\ge \\tau > 0$, we have $B > A \\ge 0$.\n$$D(y) = k\\tau - y\\left(\\exp(-A/y) - \\exp(-B/y)\\right)$$\nSince $\\frac{dD}{d\\kappa} = \\frac{dD}{dy}\\frac{dy}{d\\kappa} = \\frac{dD}{dy}$, we analyze the derivative with respect to $y$:\n$$\\frac{dD}{dy} = -\\left[ 1 \\cdot \\left(\\exp(-A/y) - \\exp(-B/y)\\right) + y \\cdot \\left( \\frac{A}{y^2}\\exp(-A/y) - \\frac{B}{y^2}\\exp(-B/y) \\right) \\right]$$\n$$\\frac{dD}{dy} = - \\left[ \\left(1 + \\frac{A}{y}\\right)\\exp(-A/y) - \\left(1 + \\frac{B}{y}\\right)\\exp(-B/y) \\right]$$\nConsider the function $h(x) = (1+x)\\exp(-x)$. Its derivative is $h'(x) = \\exp(-x) - (1+x)\\exp(-x) = -x\\exp(-x)$. For $x>0$, $h'(x) < 0$, so $h(x)$ is a strictly decreasing function for positive arguments.\nIn our expression, the arguments are $A/y = \\frac{k(T-\\tau)}{1+\\kappa}$ and $B/y = \\frac{kT}{1+\\kappa}$. Since $B>A\\ge 0$ and $y>0$, we have $B/y > A/y \\ge 0$. Because $h(x)$ is a decreasing function, $h(B/y) < h(A/y)$.\nTherefore, the term in the brackets is positive:\n$$\\left(1 + \\frac{A}{y}\\right)\\exp(-A/y) - \\left(1 + \\frac{B}{y}\\right)\\exp(-B/y) > 0$$\nThis implies that $\\frac{dD}{dy} < 0$, and consequently $\\frac{dD}{d\\kappa} < 0$. The denominator $D(\\kappa)$ is a strictly decreasing function of $\\kappa$.\nSince $J_{\\mathrm{NMDA}}^{\\mathrm{th}}(\\kappa) = k^2 \\Theta / D(\\kappa)$, where the numerator is a positive constant, and the denominator is a positive, decreasing function of $\\kappa$, it follows that $J_{\\mathrm{NMDA}}^{\\mathrm{th}}(\\kappa)$ is a strictly increasing function of $\\kappa$.\n\nTherefore, increasing the buffer capacity $\\kappa$ increases the minimal required calcium influx $J_{\\mathrm{NMDA}}^{\\mathrm{th}}$ to reach the LTP induction threshold. This is biophysically intuitive: a stronger buffer sequesters more of the incoming calcium, necessitating a larger total influx to achieve the same level of integrated free calcium.", "answer": "$$\\boxed{\\frac{k^{2} \\Theta}{k\\tau - (1+\\kappa)\\left(\\exp\\left(-\\frac{k(T-\\tau)}{1+\\kappa}\\right) - \\exp\\left(-\\frac{kT}{1+\\kappa}\\right)\\right)}}$$", "id": "2749495"}, {"introduction": "This final practice synthesizes the preceding concepts into a comprehensive computational model of STDP. You will build a simulation that connects the fundamental biophysics of NMDA receptor gating and calcium dynamics directly to the expression of synaptic potentiation and depression. By validating your model's output against a canonical experimental STDP curve [@problem_id:2749534], you will experience the powerful process of bridging molecular-level mechanisms with systems-level learning rules.", "problem": "You are tasked with designing and validating a computational model that links the gating of N-Methyl-D-Aspartate (NMDA) receptors to Spike-Timing-Dependent Plasticity (STDP) outcomes in the induction of Long-Term Potentiation (LTP). Your model must start from fundamental and well-tested principles of synaptic biophysics and calcium-dependent synaptic plasticity and produce quantitative predictions that can be compared to an experimentally established STDP plasticity curve.\n\nYour model must be constructed from the following foundational components, each grounded in widely accepted facts and definitions:\n\n1) Coincidence detection via NMDA receptors: NMDA receptor channels require glutamate binding and sufficient depolarization to relieve magnesium block. The magnesium block factor is modeled using a well-tested empirical form\n$$\nB(V) \\;=\\; \\frac{1}{1 + \\frac{[\\mathrm{Mg}^{2+}]}{3.57}\\,\\exp(-0.062\\,V)} \\,,\n$$\nwhere $V$ is the membrane potential in millivolts and $[\\mathrm{Mg}^{2+}]$ is the extracellular magnesium concentration in millimolar.\n\n2) Presynaptic glutamate transient and NMDA synaptic gating: A normalized biexponential gating variable for NMDA receptor activation,\n$$\ns(t) \\;=\\; \\frac{\\exp\\!\\left(-\\frac{t}{\\tau_{d}}\\right) - \\exp\\!\\left(-\\frac{t}{\\tau_{r}}\\right)}{\\tau_{d} - \\tau_{r}} \\, H(t) \\,,\n$$\nwith rise constant $\\tau_{r}$ (milliseconds), decay constant $\\tau_{d}$ (milliseconds), and the Heaviside step function $H(t)$.\n\n3) Postsynaptic voltage: A baseline membrane potential $V_{\\mathrm{rest}}$ (millivolts) that is perturbed by an excitatory postsynaptic potential and by a backpropagating action potential (bAP). For a presynaptic event at $t=0$, use an excitatory postsynaptic potential\n$$\n\\mathrm{EPSP}(t) \\;=\\; A_{\\mathrm{E}} \\,\\left(\\exp\\!\\left(-\\frac{t}{\\tau_{\\mathrm{E,d}}}\\right) - \\exp\\!\\left(-\\frac{t}{\\tau_{\\mathrm{E,r}}}\\right)\\right) H(t) \\,,\n$$\nand a bAP waveform triggered at $t=\\Delta t$ modeled as a half-sine pulse of duration $d_{\\mathrm{AP}}$,\n$$\n\\mathrm{AP}(t;\\Delta t) \\;=\\; \n\\begin{cases}\nA_{\\mathrm{AP}}\\,\\sin\\!\\left(\\pi \\,\\frac{t-\\Delta t}{d_{\\mathrm{AP}}}\\right) & \\text{if } 0 \\le t-\\Delta t \\le d_{\\mathrm{AP}},\\\\\n0 & \\text{otherwise},\n\\end{cases}\n$$\nso that the postsynaptic membrane potential is\n$$\nV(t;\\Delta t) \\;=\\; V_{\\mathrm{rest}} + \\mathrm{EPSP}(t) + \\mathrm{AP}(t;\\Delta t) \\,.\n$$\n\n4) NMDA-mediated calcium influx: The NMDA current is\n$$\nI_{\\mathrm{NMDA}}(t;\\Delta t) \\;=\\; g_{\\mathrm{N}}\\, s(t)\\, B\\!\\left(V(t;\\Delta t)\\right)\\, \\left(V(t;\\Delta t) - E_{\\mathrm{NMDA}}\\right) \\,,\n$$\nwhere $g_{\\mathrm{N}}$ is the NMDA conductance (nanosiemens) and $E_{\\mathrm{NMDA}}$ is the NMDA reversal potential (millivolts). Treat calcium influx as proportional to inward NMDA current,\n$$\nJ_{\\mathrm{Ca}}(t;\\Delta t) \\;=\\; \\gamma \\,\\max\\!\\left(0, - I_{\\mathrm{NMDA}}(t;\\Delta t)\\right) \\,,\n$$\nwith a calcium compartment obeying first-order decay,\n$$\n\\frac{d c}{dt} \\;=\\; -\\frac{c}{\\tau_{\\mathrm{Ca}}} + J_{\\mathrm{Ca}}(t;\\Delta t) \\,,\n$$\nwhere $c(t)$ is a unitless calcium proxy and $\\tau_{\\mathrm{Ca}}$ is the calcium decay time constant (milliseconds).\n\n5) Calcium control hypothesis for plasticity sign: Implement a two-threshold rule integrated over time,\n$$\n\\Delta w(\\Delta t) \\;=\\; \\int_{t_0}^{t_1} \\left[ k_{\\mathrm{pot}} \\,\\max\\!\\left(0, c(t) - \\theta_{\\mathrm{pot}}\\right) - k_{\\mathrm{dep}} \\,\\max\\!\\left(0, c(t) - \\theta_{\\mathrm{dep}}\\right) \\right] dt \\,,\n$$\nwith $\\theta_{\\mathrm{dep}} < \\theta_{\\mathrm{pot}}$, and $k_{\\mathrm{pot}}, k_{\\mathrm{dep}}$ nonnegative constants. The integral is taken over a finite simulation window from $t_0$ (milliseconds) to $t_1$ (milliseconds).\n\nFor validation, compare $\\Delta w(\\Delta t)$ against an experimentally established STDP curve defined by\n$$\n\\Delta w_{\\mathrm{exp}}(\\Delta t) \\;=\\;\n\\begin{cases}\nA_{+}\\,\\exp\\!\\left(-\\frac{\\Delta t}{\\tau_{+}}\\right), & \\Delta t > 0, \\\\\n-A_{-}\\,\\exp\\!\\left(\\frac{\\Delta t}{\\tau_{-}}\\right), & \\Delta t  0, \\\\\n0,  \\Delta t = 0,\n\\end{cases}\n$$\nwhere $A_{+}$, $A_{-}$, $\\tau_{+}$, and $\\tau_{-}$ are constants representing an experimentally measured plasticity curve. To isolate the shape agreement, fit a single nonnegative scalar $s^{\\star}$ that minimizes the mean squared error between $s\\,\\Delta w(\\Delta t)$ and $\\Delta w_{\\mathrm{exp}}(\\Delta t)$ across the set of tested $\\Delta t$ values, and report the root-mean-square error (RMSE). The optimal scaling is\n$$\ns^{\\star} \\;=\\; \\arg\\min_{s \\ge 0}\\,\\sum_{i}\\,\\left(s\\,\\Delta w(\\Delta t_i) - \\Delta w_{\\mathrm{exp}}(\\Delta t_i)\\right)^2 \\,,\n$$\nwhich for unconstrained $s$ has the closed-form solution\n$$\ns^{\\star} \\;=\\; \\frac{\\sum_i \\Delta w(\\Delta t_i)\\,\\Delta w_{\\mathrm{exp}}(\\Delta t_i)}{\\sum_i \\left(\\Delta w(\\Delta t_i)\\right)^2} \\,,\n$$\nand if this value is negative, set $s^{\\star}=0$.\n\nImplementation requirements:\n\n- Use a discrete time step $\\Delta t_{\\mathrm{sim}}$ to simulate from $t_0$ to $t_1$ and numerically integrate all required quantities. All times must be expressed in milliseconds (ms), all voltages in millivolts (mV), and concentrations in millimolar (mM). The output RMSE values are unitless and must be reported as floating-point numbers rounded to four decimal places.\n- Use the following fixed constants for the model unless otherwise specified by a test case parameter: $V_{\\mathrm{rest}}=-65$, $E_{\\mathrm{NMDA}}=0$, $\\tau_{r}=3$, $\\tau_{d}=60$, $\\tau_{\\mathrm{E,r}}=0.5$, $\\tau_{\\mathrm{E,d}}=5$, $d_{\\mathrm{AP}}=2$, $\\tau_{\\mathrm{Ca}}=50$, $\\gamma=1$, $t_0=-50$, $t_1=150$, and $\\Delta t_{\\mathrm{sim}}=0.05$. The experimental STDP curve constants are $A_{+}=0.5$, $A_{-}=0.5$, $\\tau_{+}=20$, and $\\tau_{-}=20$.\n- The tested spike timing differences are the list $[-40, -20, -10, -5, 0, 5, 10, 20, 40]$ in milliseconds. Interpret the spike timing convention as follows: the presynaptic spike occurs at $t=0$ and the postsynaptic bAP occurs at $t=\\Delta t$; positive $\\Delta t$ denotes pre-before-post pairing.\n- Use the plasticity thresholds $\\theta_{\\mathrm{dep}}=0.01$, $\\theta_{\\mathrm{pot}}=0.02$, and plasticity gains $k_{\\mathrm{dep}}=0.6$, $k_{\\mathrm{pot}}=1.0$.\n\nTest suite and output specification:\n\nCompute and report the RMSE for each of the following parameter sets, in order:\n\n- Case $1$ (baseline): $[\\mathrm{Mg}^{2+}]=1.0$, $g_{\\mathrm{N}}=1.0$, $A_{\\mathrm{AP}}=100$, $A_{\\mathrm{E}}=5.0$.\n- Case $2$ (high magnesium): $[\\mathrm{Mg}^{2+}]=2.0$, $g_{\\mathrm{N}}=1.0$, $A_{\\mathrm{AP}}=100$, $A_{\\mathrm{E}}=5.0$.\n- Case $3$ (reduced bAP amplitude): $[\\mathrm{Mg}^{2+}]=1.0$, $g_{\\mathrm{N}}=1.0$, $A_{\\mathrm{AP}}=60$, $A_{\\mathrm{E}}=5.0$.\n- Case $4$ (no bAP, edge case): $[\\mathrm{Mg}^{2+}]=1.0$, $g_{\\mathrm{N}}=1.0$, $A_{\\mathrm{AP}}=0$, $A_{\\mathrm{E}}=5.0$.\n\nAll parameters not explicitly listed in a case must use the fixed constants stated above. Your program should produce a single line of output containing the RMSE values for Cases $1$ through $4$ as a comma-separated list enclosed in square brackets, for example, `[...]`.\n\nYour submission must be a complete, runnable program that performs the simulation, computes the model predictions, fits the optimal scalar $s^{\\star}$, calculates the RMSE for each case, and prints the results in the exact format described. No user input should be required. The output is unitless floats rounded to four decimal places. Angles do not appear in this problem. Do not use a percent sign anywhere; if you need a fraction, express it as a decimal number.", "solution": "The problem statement has been critically examined and is determined to be valid. It is scientifically grounded in established principles of computational neuroscience, self-contained, and algorithmically well-posed. The task is to construct a computational model of N-Methyl-D-Aspartate (NMDA) receptor-dependent synaptic plasticity and to validate its output against a canonical Spike-Timing-Dependent Plasticity (STDP) curve.\n\nThe solution will be developed by numerically simulating the biophysical model for a set of spike-timing differences ($\\Delta t$) and for each of the four specified parameter cases. The core of the solution involves the following sequence of computational steps.\n\nFirst, a discrete time grid is established for the simulation. The simulation window runs from $t_0 = -50 \\, \\mathrm{ms}$ to $t_1 = 150 \\, \\mathrm{ms}$, with a time step of $\\Delta t_{\\mathrm{sim}} = 0.05 \\, \\mathrm{ms}$. This fine temporal resolution is necessary for the accurate numerical integration of the system's dynamics. Let the discrete time points be $t_i = t_0 + i \\cdot \\Delta t_{\\mathrm{sim}}$.\n\nFor each tested spike-timing difference $\\Delta t$, the postsynaptic membrane potential $V(t; \\Delta t)$ is computed at each time point $t_i$. It is the linear superposition of three components:\n$1.$ A constant resting potential, $V_{\\mathrm{rest}} = -65 \\, \\mathrm{mV}$.\n$2.$ An excitatory postsynaptic potential, $\\mathrm{EPSP}(t)$, which models the response to a presynaptic spike at $t=0$. Its time course is given by the biexponential function:\n$$\n\\mathrm{EPSP}(t) \\;=\\; A_{\\mathrm{E}} \\,\\left(\\exp\\!\\left(-\\frac{t}{\\tau_{\\mathrm{E,d}}}\\right) - \\exp\\!\\left(-\\frac{t}{\\tau_{\\mathrm{E,r}}}\\right)\\right) H(t)\n$$\nwhere $H(t)$ is the Heaviside step function, ensuring causality.\n$3.$ A backpropagating action potential, $\\mathrm{AP}(t; \\Delta t)$, representing a postsynaptic spike triggered at time $t = \\Delta t$. It is modeled as a half-sine pulse:\n$$\n\\mathrm{AP}(t;\\Delta t) \\;=\\; \n\\begin{cases}\nA_{\\mathrm{AP}}\\,\\sin\\!\\left(\\pi \\,\\frac{t-\\Delta t}{d_{\\mathrm{AP}}}\\right)  \\text{if } \\Delta t \\le t \\le \\Delta t + d_{\\mathrm{AP}},\\\\\n0  \\text{otherwise}.\n\\end{cases}\n$$\nThe total potential is thus $V(t;\\Delta t) = V_{\\mathrm{rest}} + \\mathrm{EPSP}(t) + \\mathrm{AP}(t;\\Delta t)$.\n\nNext, the NMDA receptor-mediated calcium influx is modeled. This requires several intermediate calculations at each time step $t_i$. The NMDA receptor gating variable, $s(t)$, which represents the presence of glutamate in the synaptic cleft following a presynaptic spike at $t=0$, is calculated using:\n$$\ns(t) \\;=\\; \\frac{\\exp\\!\\left(-\\frac{t}{\\tau_{d}}\\right) - \\exp\\!\\left(-\\frac{t}{\\tau_{r}}\\right)}{\\tau_{d} - \\tau_{r}} \\, H(t)\n$$\nThe critical voltage-dependent magnesium block of the NMDA receptor is computed via the function $B(V)$:\n$$\nB(V) \\;=\\; \\frac{1}{1 + \\frac{[\\mathrm{Mg}^{2+}]}{3.57}\\,\\exp(-0.062\\,V)}\n$$\nUsing these components, the total NMDA current is calculated as:\n$$\nI_{\\mathrm{NMDA}}(t;\\Delta t) \\;=\\; g_{\\mathrm{N}}\\, s(t)\\, B\\!\\left(V(t; \\Delta t)\\right)\\, \\left(V(t; \\Delta t) - E_{\\mathrm{NMDA}}\\right)\n$$\nThe calcium influx, $J_{\\mathrm{Ca}}(t;\\Delta t)$, is assumed to be proportional to the inward current (i.e., when $I_{\\mathrm{NMDA}}  0$):\n$$\nJ_{\\mathrm{Ca}}(t;\\Delta t) \\;=\\; \\gamma \\,\\max\\!\\left(0, - I_{\\mathrm{NMDA}}(t;\\Delta t)\\right)\n$$\n\nWith the calcium influx determined, the intracellular calcium concentration proxy, $c(t)$, is simulated. Its dynamics are described by the first-order ordinary differential equation:\n$$\n\\frac{d c}{dt} \\;=\\; -\\frac{c}{\\tau_{\\mathrm{Ca}}} + J_{\\mathrm{Ca}}(t;\\Delta t)\n$$\nThis equation is solved numerically using the forward Euler method with the initial condition $c(t_0) = 0$. The update rule is:\n$$\nc(t_{i+1}) \\;=\\; c(t_i) + \\Delta t_{\\mathrm{sim}} \\left( -\\frac{c(t_i)}{\\tau_{\\mathrm{Ca}}} + J_{\\mathrm{Ca}}(t_i; \\Delta t) \\right)\n$$\n\nThe change in synaptic weight, $\\Delta w(\\Delta t)$, is then calculated based on the simulated calcium trace $c(t)$ according to the calcium control hypothesis. This involves integrating a function of the calcium concentration over the simulation window. The integrand has two terms, one for potentiation (LTP) and one for depression (LTD), which are active when the calcium level exceeds their respective thresholds, $\\theta_{\\mathrm{pot}}$ and $\\theta_{\\mathrm{dep}}$. The integral is approximated as a Riemann sum:\n$$\n\\Delta w(\\Delta t) \\;=\\; \\sum_{i=0}^{N-1} \\left[ k_{\\mathrm{pot}} \\,\\max\\!\\left(0, c(t_i) - \\theta_{\\mathrm{pot}}\\right) - k_{\\mathrm{dep}} \\,\\max\\!\\left(0, c(t_i) - \\theta_{\\mathrm{dep}}\\right) \\right] \\Delta t_{\\mathrm{sim}}\n$$\nwhere $N$ is the total number of time steps. This entire procedure is repeated for each value in the specified list of spike timings $\\Delta t_i = \\{-40, -20, \\dots, 40\\} \\, \\mathrm{ms}$, yielding a vector of model predictions $\\Delta w(\\Delta t_i)$.\n\nFinally, the model's performance is quantified. The predicted STDP curve $\\Delta w(\\Delta t_i)$ is compared against the given experimental curve $\\Delta w_{\\mathrm{exp}}(\\Delta t_i)$. An optimal scaling factor, $s^{\\star}$, is calculated to minimize the mean squared error between $s \\cdot \\Delta w$ and $\\Delta w_{\\mathrm{exp}}$. The closed-form solution is used:\n$$\ns^{\\star} \\;=\\; \\frac{\\sum_i \\Delta w(\\Delta t_i)\\,\\Delta w_{\\mathrm{exp}}(\\Delta t_i)}{\\sum_i \\left(\\Delta w(\\Delta t_i)\\right)^2}\n$$\nconstrained such that $s^{\\star} \\ge 0$. If the denominator is zero, $s^{\\star}$ is set to $0$. The root-mean-square error (RMSE) is then computed as:\n$$\n\\mathrm{RMSE} = \\sqrt{\\frac{1}{M}\\sum_{i=1}^{M} \\left(s^{\\star}\\Delta w(\\Delta t_i) - \\Delta w_{\\mathrm{exp}}(\\Delta t_i)\\right)^2}\n$$\nwhere $M$ is the number of tested $\\Delta t$ values. This process is executed for each of the four parameter cases, and the resulting RMSE values are reported.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Simulates an NMDA receptor-based model of STDP and calculates the RMSE \n    against an experimental curve for four different parameter cases.\n    \"\"\"\n\n    # --- Fixed constants for the model\n    V_rest = -65.0      # mV\n    E_NMDA = 0.0        # mV\n    tau_r = 3.0         # ms (NMDA rise)\n    tau_d = 60.0        # ms (NMDA decay)\n    tau_E_r = 0.5       # ms (EPSP rise)\n    tau_E_d = 5.0       # ms (EPSP decay)\n    d_AP = 2.0          # ms (bAP duration)\n    tau_Ca = 50.0       # ms (Calcium decay)\n    gamma = 1.0         # unitless (Calcium influx gain)\n    t0 = -50.0          # ms (simulation start time)\n    t1 = 150.0          # ms (simulation end time)\n    dt_sim = 0.05       # ms (simulation time step)\n    \n    # --- Plasticity parameters\n    theta_dep = 0.01\n    theta_pot = 0.02\n    k_dep = 0.6\n    k_pot = 1.0\n\n    # --- Experimental STDP curve parameters\n    A_plus = 0.5\n    A_minus = 0.5\n    tau_plus = 20.0\n    tau_minus = 20.0\n\n    # --- Spike timing differences to test\n    delta_t_values = np.array([-40.0, -20.0, -10.0, -5.0, 0.0, 5.0, 10.0, 20.0, 40.0])\n\n    # --- Test case parameters\n    test_cases = [\n        # Case 1: baseline\n        {'Mg_conc': 1.0, 'g_N': 1.0, 'A_AP': 100.0, 'A_E': 5.0},\n        # Case 2: high magnesium\n        {'Mg_conc': 2.0, 'g_N': 1.0, 'A_AP': 100.0, 'A_E': 5.0},\n        # Case 3: reduced bAP amplitude\n        {'Mg_conc': 1.0, 'g_N': 1.0, 'A_AP': 60.0, 'A_E': 5.0},\n        # Case 4: no bAP, edge case\n        {'Mg_conc': 1.0, 'g_N': 1.0, 'A_AP': 0.0, 'A_E': 5.0},\n    ]\n\n    results = []\n\n    # --- Pre-compute time-independent components\n    t = np.arange(t0, t1, dt_sim)\n    \n    # NMDA gating variable s(t)\n    s_t = (np.exp(-t / tau_d) - np.exp(-t / tau_r)) / (tau_d - tau_r)\n    s_t = np.where(t >= 0, s_t, 0)\n\n    # EPSP(t)\n    epsp_t_base = np.exp(-t / tau_E_d) - np.exp(-t / tau_E_r)\n    epsp_t_base = np.where(t >= 0, epsp_t_base, 0)\n    \n    # Experimental STDP curve\n    w_exp = np.zeros_like(delta_t_values)\n    w_exp[delta_t_values > 0] = A_plus * np.exp(-delta_t_values[delta_t_values > 0] / tau_plus)\n    w_exp[delta_t_values  0] = -A_minus * np.exp(delta_t_values[delta_t_values  0] / tau_minus)\n\n    # --- Main loop over test cases\n    for params in test_cases:\n        Mg_conc = params['Mg_conc']\n        g_N = params['g_N']\n        A_AP = params['A_AP']\n        A_E = params['A_E']\n        \n        epsp_t = A_E * epsp_t_base\n        w_model = np.zeros_like(delta_t_values)\n\n        # --- Loop over spike timings\n        for i, delta_t in enumerate(delta_t_values):\n            # Calculate AP(t) for current delta_t\n            ap_t = np.zeros_like(t)\n            ap_mask = (t >= delta_t)  (t = delta_t + d_AP)\n            ap_t[ap_mask] = A_AP * np.sin(np.pi * (t[ap_mask] - delta_t) / d_AP)\n            \n            # Total membrane potential V(t)\n            V_t = V_rest + epsp_t + ap_t\n            \n            # Magnesium block B(V)\n            B_V = 1.0 / (1.0 + (Mg_conc / 3.57) * np.exp(-0.062 * V_t))\n            \n            # NMDA current I_NMDA(t)\n            I_NMDA_t = g_N * s_t * B_V * (V_t - E_NMDA)\n            \n            # Calcium influx J_Ca(t)\n            J_Ca_t = gamma * np.maximum(0, -I_NMDA_t)\n            \n            # Simulate calcium concentration c(t) using forward Euler\n            c_t = np.zeros_like(t)\n            for j in range(len(t) - 1):\n                dc_dt = -c_t[j] / tau_Ca + J_Ca_t[j]\n                c_t[j + 1] = c_t[j] + dt_sim * dc_dt\n            \n            # Calculate synaptic weight change delta_w\n            integrand_pot = k_pot * np.maximum(0, c_t - theta_pot)\n            integrand_dep = k_dep * np.maximum(0, c_t - theta_dep)\n            w_model[i] = np.sum(integrand_pot - integrand_dep) * dt_sim\n\n        # --- Calculate optimal scaling factor s_star\n        numerator = np.sum(w_model * w_exp)\n        denominator = np.sum(w_model**2)\n        \n        s_star = 0.0\n        if denominator > 1e-9: # Avoid division by zero\n            s_star = numerator / denominator\n        \n        s_star = max(0, s_star) # Enforce non-negativity\n\n        # --- Calculate RMSE\n        w_model_scaled = s_star * w_model\n        rmse = np.sqrt(np.mean((w_model_scaled - w_exp)**2))\n        results.append(rmse)\n\n    # --- Format and print the final output\n    formatted_results = [f\"{r:.4f}\" for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nif __name__ == '__main__':\n    solve()\n```", "id": "2749534"}]}