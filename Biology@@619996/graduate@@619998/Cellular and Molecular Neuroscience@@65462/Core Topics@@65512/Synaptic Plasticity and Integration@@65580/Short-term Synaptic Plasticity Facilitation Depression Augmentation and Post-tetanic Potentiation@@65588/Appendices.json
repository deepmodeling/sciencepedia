{"hands_on_practices": [{"introduction": "Paired-pulse facilitation is a fundamental form of short-term plasticity where the second of two closely spaced stimuli evokes a larger postsynaptic response. This exercise [@problem_id:2751422] explores the leading mechanistic explanation: the residual calcium hypothesis. By modeling the presynaptic terminal as a single compartment with first-order calcium clearance, you will derive the time course of $[\\text{Ca}^{2+}]_{\\text{res}}(t)$ and see directly how the memory of the first pulse is retained to enhance the second.", "problem": "In the context of short-term synaptic plasticity and the residual calcium hypothesis of paired-pulse facilitation, consider a single-compartment presynaptic bouton in which intracellular calcium ($\\text{Ca}^{2+}$) returns to its resting level via first-order clearance. Assume that an action potential at time $t=0$ produces an effectively instantaneous increment in free calcium of amplitude $[Ca]_0$ above the resting baseline, and that subsequent dynamics are governed by linear clearance with an effective time constant $\\tau_{\\text{eff}}$ that subsumes buffering and extrusion. Let the residual calcium above baseline be $[\\text{Ca}]_{\\text{res}}(t)$ for $t>0$.\n\nStarting from the single-compartment balance with first-order removal and an impulse-like influx at $t=0$, derive the closed-form time course of $[\\text{Ca}]_{\\text{res}}(t)$ for $t>0$. Then, using your derived expression, compute the residual calcium at an interspike interval $\\Delta t = 20\\ \\text{ms}$ for $[Ca]_0 = 0.5\\ \\mu\\text{M}$ and $\\tau_{\\text{eff}} = 50\\ \\text{ms}$.\n\nRound your final numeric answer to four significant figures. Express the final concentration in $\\mu\\text{M}$. Provide only the final numeric value (without units) as your answer.", "solution": "The problem as stated is well-defined, scientifically grounded, and presents a standard exercise in modeling biophysical dynamics. We proceed directly to the solution.\n\nThe problem describes the time evolution of the residual calcium concentration, $[Ca]_{\\text{res}}(t)$, in a presynaptic terminal following an action potential. The dynamics are governed by a single-compartment model with first-order clearance. This physical situation is described by a first-order linear homogeneous ordinary differential equation.\n\nThe rate of change of the calcium concentration, $\\frac{d}{dt}[Ca]_{\\text{res}}(t)$, is proportional to the concentration itself, with a negative constant of proportionality. This constant is the inverse of the effective time constant, $\\tau_{\\text{eff}}$. The governing equation is therefore:\n$$\n\\frac{d[Ca]_{\\text{res}}(t)}{dt} = -\\frac{1}{\\tau_{\\text{eff}}} [Ca]_{\\text{res}}(t)\n$$\nThis equation holds for time $t > 0$.\n\nThe problem states that at time $t=0$, an action potential produces an \"effectively instantaneous increment in free calcium of amplitude $[Ca]_0$\". This constitutes the initial condition for the differential equation. Assuming the resting calcium level is normalized to zero, the concentration at the moment immediately following the impulse is:\n$$\n[Ca]_{\\text{res}}(0) = [Ca]_0\n$$\nWe now have a complete initial value problem. The solution to the equation $\\frac{dy}{dt} = -ky$ with initial condition $y(0) = y_0$ is universally known to be $y(t) = y_0 \\exp(-kt)$. By direct analogy, substituting our specific variables and constants, we find the closed-form time course for the residual calcium concentration:\n$$\n[Ca]_{\\text{res}}(t) = [Ca]_0 \\exp\\left(-\\frac{t}{\\tau_{\\text{eff}}}\\right)\n$$\nThis expression provides the concentration of residual calcium at any time $t > 0$ after the initial influx.\n\nThe second part of the problem requires the calculation of the residual calcium at a specific interspike interval, $\\Delta t$. The given parameters are:\n- Initial calcium increment: $[Ca]_0 = 0.5\\ \\mu\\text{M}$\n- Effective time constant: $\\tau_{\\text{eff}} = 50\\ \\text{ms}$\n- Interspike interval: $\\Delta t = 20\\ \\text{ms}$\n\nWe substitute these values into the derived expression for $[Ca]_{\\text{res}}(t)$ at $t = \\Delta t$:\n$$\n[Ca]_{\\text{res}}(\\Delta t) = [Ca]_0 \\exp\\left(-\\frac{\\Delta t}{\\tau_{\\text{eff}}}\\right)\n$$\n$$\n[Ca]_{\\text{res}}(20\\ \\text{ms}) = (0.5\\ \\mu\\text{M}) \\times \\exp\\left(-\\frac{20\\ \\text{ms}}{50\\ \\text{ms}}\\right)\n$$\nThe units in the exponent cancel, which is a necessary condition for dimensional consistency. The calculation simplifies to:\n$$\n[Ca]_{\\text{res}}(20\\ \\text{ms}) = 0.5 \\times \\exp\\left(-\\frac{2}{5}\\right)\\ \\mu\\text{M} = 0.5 \\times \\exp(-0.4)\\ \\mu\\text{M}\n$$\nNow, we compute the numerical value:\n$$\n\\exp(-0.4) \\approx 0.670320046\n$$\nTherefore,\n$$\n[Ca]_{\\text{res}}(20\\ \\text{ms}) \\approx 0.5 \\times 0.670320046\\ \\mu\\text{M} \\approx 0.335160023\\ \\mu\\text{M}\n$$\nThe problem requires the final answer to be rounded to four significant figures. The first four significant figures are $3$, $3$, $5$, and $1$. The fifth significant digit is $6$, which is greater than or equal to $5$, so we round up the fourth digit.\n$$\n[Ca]_{\\text{res}}(20\\ \\text{ms}) \\approx 0.3352\\ \\mu\\text{M}\n$$\nThe final numerical answer, expressed in $\\mu\\text{M}$ as requested, is $0.3352$.", "answer": "$$\\boxed{0.3352}$$", "id": "2751422"}, {"introduction": "In contrast to facilitation, synaptic depression describes the progressive decrease in response amplitude during repetitive stimulation, a critical process for filtering and adapting neural signals. This practice [@problem_id:2751407] delves into the vesicle depletion model, a cornerstone theory for explaining short-term depression. You will derive the steady-state synaptic strength as a function of stimulation frequency, gaining insight into how the balance between vesicle release and replenishment shapes the synapse's dynamic response properties.", "problem": "A central mechanistic account of short-term synaptic depression at excitatory synapses is depletion of the readily releasable pool (RRP) of synaptic vesicles. Consider a single synapse driven by a periodic presynaptic spike train of frequency $f$ (period $\\Delta = 1/f$). Let $R(t)$ denote the fraction of release-ready resources available at time $t$, normalized by the maximal pool size $R_{\\max}$. The synapse obeys the following well-tested facts and core definitions:\n- At each presynaptic action potential, an expected fraction $p$ of the currently available resources is released, producing an excitatory postsynaptic current (EPSC) amplitude proportional to the released fraction.\n- Immediately after a spike at time $t_{n}$, the available fraction jumps from the pre-spike value $R(t_{n}^{-})$ to the post-spike value $R(t_{n}^{+}) = R(t_{n}^{-})(1 - p)$.\n- Between spikes, resources recover exponentially toward $R_{\\max}$ with a time constant $\\tau_{\\mathrm{rec}}$, implementing $\\frac{dR}{dt} = \\frac{R_{\\max} - R}{\\tau_{\\mathrm{rec}}}$ for $t \\in (t_{n}, t_{n+1})$.\n\nAssume there is no facilitation, augmentation, or post-tetanic potentiation; that is, the release probability $p$ is constant, and only depletion and recovery shape the responses. Define the steady-state normalized EPSC amplitude $A_{\\infty}(f)$ under periodic stimulation as the expected released fraction per spike at steady state, normalized by $R_{\\max}$.\n\nUsing only the statements above as your starting point, derive $A_{\\infty}(f)$ as a function of $p$, $R_{\\max}$, $\\tau_{\\mathrm{rec}}$, and $f$, and then evaluate it for $p = 0.3$, $R_{\\max} = 1$, $\\tau_{\\mathrm{rec}} = 1\\ \\mathrm{s}$ at stimulation frequencies $f \\in \\{1, 5, 10, 50\\}\\ \\mathrm{Hz}$. Express the final normalized amplitudes as dimensionless numbers and round your values to four significant figures. Report your answer as a single row vector in the order $f = 1, 5, 10, 50\\ \\mathrm{Hz}$.", "solution": "The problem statement will be validated before a solution is attempted.\n\nFirst, the givens are extracted verbatim as required.\n- A periodic presynaptic spike train of frequency $f$ with period $\\Delta = 1/f$.\n- $R(t)$ denotes the fraction of release-ready resources available at time $t$, normalized by the maximal pool size $R_{\\max}$.\n- At each presynaptic action potential, an expected fraction $p$ of the currently available resources is released.\n- EPSC amplitude is proportional to the released fraction.\n- The post-spike resource level is given by $R(t_{n}^{+}) = R(t_{n}^{-})(1 - p)$.\n- Resource recovery between spikes is governed by the differential equation $\\frac{dR}{dt} = \\frac{R_{\\max} - R}{\\tau_{\\mathrm{rec}}}$ for $t \\in (t_{n}, t_{n+1})$.\n- Assumptions: $p$ is constant (no facilitation, augmentation, or PTP).\n- The steady-state normalized EPSC amplitude $A_{\\infty}(f)$ is defined as the expected released fraction per spike at steady state, normalized by $R_{\\max}$.\n- Numerical parameters for evaluation: $p = 0.3$, $R_{\\max} = 1$, $\\tau_{\\mathrm{rec}} = 1\\ \\mathrm{s}$, and frequencies $f \\in \\{1, 5, 10, 50\\}\\ \\mathrm{Hz}$.\n\nNext, the validity of the problem is assessed. The problem describes a canonical model of short-term synaptic depression (the Tsodyks-Markram model in its simplified form for depression only), which is a fundamental concept in cellular and molecular neuroscience. The model is scientifically sound, well-posed, and objective. There is a slight imprecision in the problem statement regarding the variable $R(t)$. It is defined as a normalized fraction, yet the differential equation $\\frac{dR}{dt} = \\frac{R_{\\max} - R}{\\tau_{\\mathrm{rec}}}$ suggests $R$ has the same units as $R_{\\max}$. However, this ambiguity is resolved by interpreting $R(t)$ as the absolute quantity of resources and $R_{\\max}$ as the maximum quantity. The subsequent request to use $R_{\\max}=1$ makes this interpretation fully consistent with a normalized model where $\\frac{dR}{dt} = \\frac{1 - R}{\\tau_{\\mathrm{rec}}}$. With this standard interpretation, the problem is internally consistent and solvable. Therefore, the problem is deemed valid.\n\nThe solution proceeds as follows. We seek the steady-state normalized EPSC amplitude, $A_{\\infty}(f)$. By definition, this is the amount of resource released at steady state, $p R_{\\infty}^{-}$, divided by the maximal pool size $R_{\\max}$. Thus, $A_{\\infty}(f) = \\frac{p R_{\\infty}^{-}}{R_{\\max}}$, where $R_{\\infty}^{-}$ is the resource level just before a spike in the steady state.\n\nStep 1: Solve the recovery dynamics between spikes.\nThe recovery of resources between spike $n$ at time $t_n$ and spike $n+1$ at time $t_{n+1} = t_n + \\Delta$ is described by the linear first-order ordinary differential equation:\n$$\n\\frac{dR}{dt} = \\frac{R_{\\max} - R}{\\tau_{\\mathrm{rec}}}\n$$\nThis equation can be solved by separation of variables:\n$$\n\\int_{R(t_n^+)}^{R(t_{n+1}^-)} \\frac{dR}{R_{\\max} - R} = \\int_{t_n}^{t_{n+1}} \\frac{dt}{\\tau_{\\mathrm{rec}}}\n$$\nThe initial condition for this interval is the post-spike resource level $R(t_n^+)$. We integrate over the inter-spike interval $\\Delta = t_{n+1} - t_n$.\n$$\n\\left[-\\ln(R_{\\max} - R)\\right]_{R(t_n^+)}^{R(t_{n+1}^-)} = \\frac{\\Delta}{\\tau_{\\mathrm{rec}}}\n$$\n$$\n\\ln\\left(\\frac{R_{\\max} - R(t_n^+)}{R_{\\max} - R(t_{n+1}^-)}\\right) = \\frac{\\Delta}{\\tau_{\\mathrm{rec}}}\n$$\nSolving for $R(t_{n+1}^-)$, the resource level just before the next spike, we get:\n$$\nR_{\\max} - R(t_{n+1}^-) = (R_{\\max} - R(t_n^+))\\exp\\left(-\\frac{\\Delta}{\\tau_{\\mathrm{rec}}}\\right)\n$$\n$$\nR(t_{n+1}^-) = R_{\\max} - (R_{\\max} - R(t_n^+))\\exp\\left(-\\frac{\\Delta}{\\tau_{\\mathrm{rec}}}\\right) = R_{\\max}\\left(1 - \\exp\\left(-\\frac{\\Delta}{\\tau_{\\mathrm{rec}}}\\right)\\right) + R(t_n^+)\\exp\\left(-\\frac{\\Delta}{\\tau_{\\mathrm{rec}}}\\right)\n$$\n\nStep 2: Formulate a recurrence relation for the pre-spike resource level.\nLet $R_n^{-} \\equiv R(t_n^-)$ be the pre-spike resource level at spike $n$. The depletion rule is given as $R(t_n^+) = R_n^{-}(1 - p)$. Substituting this into the equation derived in Step 1:\n$$\nR_{n+1}^{-} = R_{\\max}\\left(1 - \\exp\\left(-\\frac{\\Delta}{\\tau_{\\mathrm{rec}}}\\right)\\right) + R_n^{-}(1 - p)\\exp\\left(-\\frac{\\Delta}{\\tau_{\\mathrm{rec}}}\\right)\n$$\nThis is a linear recurrence relation for the sequence of pre-spike resource levels.\n\nStep 3: Find the steady-state solution.\nIn the steady state, the resource level before each spike is constant, so $R_{n+1}^{-} = R_n^{-} = R_{\\infty}^{-}$.\n$$\nR_{\\infty}^{-} = R_{\\max}\\left(1 - \\exp\\left(-\\frac{\\Delta}{\\tau_{\\mathrm{rec}}}\\right)\\right) + R_{\\infty}^{-}(1 - p)\\exp\\left(-\\frac{\\Delta}{\\tau_{\\mathrm{rec}}}\\right)\n$$\nWe solve for $R_{\\infty}^{-}$:\n$$\nR_{\\infty}^{-}\\left[1 - (1 - p)\\exp\\left(-\\frac{\\Delta}{\\tau_{\\mathrm{rec}}}\\right)\\right] = R_{\\max}\\left(1 - \\exp\\left(-\\frac{\\Delta}{\\tau_{\\mathrm{rec}}}\\right)\\right)\n$$\n$$\nR_{\\infty}^{-} = \\frac{R_{\\max}\\left(1 - \\exp\\left(-\\frac{\\Delta}{\\tau_{\\mathrm{rec}}}\\right)\\right)}{1 - (1 - p)\\exp\\left(-\\frac{\\Delta}{\\tau_{\\mathrm{rec}}}\\right)}\n$$\n\nStep 4: Derive the expression for $A_{\\infty}(f)$.\nUsing the definition $A_{\\infty}(f) = \\frac{p R_{\\infty}^{-}}{R_{\\max}}$ and substituting the expression for $R_{\\infty}^{-}$, we find:\n$$\nA_{\\infty}(f) = \\frac{p}{R_{\\max}} \\left[ \\frac{R_{\\max}\\left(1 - \\exp\\left(-\\frac{\\Delta}{\\tau_{\\mathrm{rec}}}\\right)\\right)}{1 - (1 - p)\\exp\\left(-\\frac{\\Delta}{\\tau_{\\mathrm{rec}}}\\right)} \\right]\n$$\nThe $R_{\\max}$ terms cancel, which is expected as the normalized amplitude should not depend on the absolute pool size. Substituting $\\Delta = 1/f$:\n$$\nA_{\\infty}(f) = \\frac{p\\left(1 - \\exp\\left(-\\frac{1}{f \\tau_{\\mathrm{rec}}}\\right)\\right)}{1 - (1 - p)\\exp\\left(-\\frac{1}{f \\tau_{\\mathrm{rec}}}\\right)}\n$$\nThis is the general analytical expression for the steady-state normalized amplitude as a function of $p$, $\\tau_{\\mathrm{rec}}$, and $f$.\n\nStep 5: Perform the numerical evaluation.\nThe given parameters are $p = 0.3$ and $\\tau_{\\mathrm{rec}} = 1\\ \\mathrm{s}$. The expression becomes:\n$$\nA_{\\infty}(f) = \\frac{0.3\\left(1 - \\exp\\left(-\\frac{1}{f}\\right)\\right)}{1 - 0.7\\exp\\left(-\\frac{1}{f}\\right)}\n$$\nWe evaluate this for each specified frequency $f$:\n- For $f = 1\\ \\mathrm{Hz}$:\n  $A_{\\infty}(1) = \\frac{0.3(1 - \\exp(-1))}{1 - 0.7\\exp(-1)} \\approx \\frac{0.3(1 - 0.367879)}{1 - 0.7(0.367879)} = \\frac{0.189636}{0.742485} \\approx 0.255407$\n  Rounded to four significant figures, this is $0.2554$.\n\n- For $f = 5\\ \\mathrm{Hz}$:\n  $A_{\\infty}(5) = \\frac{0.3(1 - \\exp(-0.2))}{1 - 0.7\\exp(-0.2)} \\approx \\frac{0.3(1 - 0.818731)}{1 - 0.7(0.818731)} = \\frac{0.0543807}{0.426888} \\approx 0.127387$\n  Rounded to four significant figures, this is $0.1274$.\n\n- For $f = 10\\ \\mathrm{Hz}$:\n  $A_{\\infty}(10) = \\frac{0.3(1 - \\exp(-0.1))}{1 - 0.7\\exp(-0.1)} \\approx \\frac{0.3(1 - 0.904837)}{1 - 0.7(0.904837)} = \\frac{0.0285489}{0.366614} \\approx 0.077873$\n  Rounded to four significant figures, this is $0.07787$.\n\n- For $f = 50\\ \\mathrm{Hz}$:\n  $A_{\\infty}(50) = \\frac{0.3(1 - \\exp(-0.02))}{1 - 0.7\\exp(-0.02)} \\approx \\frac{0.3(1 - 0.980199)}{1 - 0.7(0.980199)} = \\frac{0.0059403}{0.313861} \\approx 0.018926$\n  Rounded to four significant figures, this is $0.01893$.\n\nThe final results are presented as a row vector.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.2554 & 0.1274 & 0.07787 & 0.01893\n\\end{pmatrix}\n}\n$$", "id": "2751407"}, {"introduction": "Synaptic dynamics in vivo are rarely pure facilitation or depression, but rather a complex interplay between the two. This exercise [@problem_id:2751339] challenges you to implement a well-established phenomenological model that captures these competing processes. By simulating synaptic responses to a train of stimuli, you will explore how the relative strengths and time constants of facilitation and depression ($U$, $\\tau_f$, $\\tau_d$) sculpt the temporal profile of neurotransmitter release, a key element of neural computation.", "problem": "You are given a mechanistic model of short-term synaptic plasticity that captures facilitation and depression as interacting dynamical processes. Consider a single synapse governed by a resource-based model in which two state variables evolve in time: the instantaneous release probability $u(t)$ and the fraction of resources available $x(t)$. Between presynaptic spikes separated by an interspike interval $\\Delta t$, these variables obey first-order linear ordinary differential equations driven by intrinsic relaxation:\n1. $u(t)$ relaxes toward $0$ according to $\\dfrac{du}{dt} = -\\dfrac{u}{\\tau_f}$, where $\\tau_f$ is the facilitation time constant.\n2. $x(t)$ recovers toward $1$ according to $\\dfrac{dx}{dt} = \\dfrac{1 - x}{\\tau_d}$, where $\\tau_d$ is the depression recovery time constant.\n\nAt each presynaptic spike arrival time $t_k$, the variables are instantaneously updated by synaptic release and facilitation:\n1. The release probability jumps as $u \\leftarrow u + U \\left(1 - u\\right)$, where $U$ is the baseline utilization parameter.\n2. The available resources are depleted in proportion to the updated release probability, $x \\leftarrow x \\left(1 - u\\right)$.\n\nAssume an initial quiescent state with $u(0^{-}) = 0$ and $x(0^{-}) = 1$, and a periodic spike train of frequency $f$ so that $\\Delta t = 1/f$. Define the normalized postsynaptic response at the $k$-th spike as $y_k = u_k x_k$, where $u_k$ denotes the value of $u$ immediately after its jump at the $k$-th spike and $x_k$ denotes the value of $x$ immediately before the depletion at the $k$-th spike. All responses $y_k$ are dimensionless.\n\nTask:\n1. Starting from the stated differential equations and jump rules, derive discrete-time update relations that enable computation of $y_k$ for successive spikes using only the parameters $\\Delta t$, $U$, $\\tau_f$, and $\\tau_d$ and the previous spikeâ€™s state.\n2. Implement these updates to compute the first five responses $\\left(y_1, y_2, y_3, y_4, y_5\\right)$ for each parameter set in the test suite below. Use $\\tau_f$ and $\\tau_d$ in milliseconds and convert to seconds internally. Use $f$ in Hertz so that $\\Delta t$ is in seconds.\n3. Determine whether facilitation or depression dominates over the first five responses according to the following rule. Let $\\epsilon = 10^{-9}$. For $k = 2,3,4,5$, count an increase if $y_k - y_{k-1} > \\epsilon$ and a decrease if $y_k - y_{k-1}  -\\epsilon$. Let $I$ be the number of increases and $D$ the number of decreases. Define the dominance integer $S$ by:\n   - $S = 1$ (facilitation-dominant) if $I \\ge 3$ and $y_5 - y_1 > \\epsilon$,\n   - $S = -1$ (depression-dominant) if $D \\ge 3$ and $y_5 - y_1  -\\epsilon$,\n   - $S = 0$ (mixed or ambiguous) otherwise.\n\nNumerical output requirements:\n- Express the five responses as floating-point numbers rounded to six decimal places.\n- For each parameter set, output a list containing six entries: the five rounded responses followed by the integer $S$.\n- Your program should produce a single line of output containing the results for all test cases as a comma-separated list of these lists enclosed in square brackets, for example: [[y11,y12,y13,y14,y15,S1],[y21,y22,y23,y24,y25,S2],...].\n\nTest suite:\nProvide results for the following four parameter sets. In all cases, compute the first five responses. When a train duration is mentioned, it is only to contextualize the frequency; you should assume the periodic train is sustained as needed to obtain five spikes.\n1. Baseline interaction at moderate frequency: $f = 20\\ \\text{Hz}$, $U = 0.2$, $\\tau_f = 200\\ \\text{ms}$, $\\tau_d = 800\\ \\text{ms}$.\n2. Strong initial utilization with faster facilitation decay and moderate recovery: $f = 20\\ \\text{Hz}$, $U = 0.5$, $\\tau_f = 50\\ \\text{ms}$, $\\tau_d = 400\\ \\text{ms}$.\n3. Low initial utilization with long facilitation and fast recovery: $f = 20\\ \\text{Hz}$, $U = 0.05$, $\\tau_f = 1000\\ \\text{ms}$, $\\tau_d = 200\\ \\text{ms}$.\n4. Low frequency boundary case: $f = 1\\ \\text{Hz}$, $U = 0.2$, $\\tau_f = 200\\ \\text{ms}$, $\\tau_d = 800\\ \\text{ms}$.\n\nFinal output format:\n- A single line containing a JSON-like list of four lists, one per test case, where each inner list is [y1,y2,y3,y4,y5,S] using the rounding and integer rules above.", "solution": "The problem is subjected to validation.\n\n**1. Extraction of Givens**\n- State variables: instantaneous release probability $u(t)$, fraction of available resources $x(t)$.\n- Dynamics between spikes (interspike interval $\\Delta t$):\n    - $\\dfrac{du}{dt} = -\\dfrac{u}{\\tau_f}$\n    - $\\dfrac{dx}{dt} = \\dfrac{1 - x}{\\tau_d}$\n- Dynamics at spike time $t_k$:\n    - $u \\leftarrow u + U \\left(1 - u\\right)$\n    - $x \\leftarrow x \\left(1 - u\\right)$ (with the updated $u$)\n- Initial state: $u(0^{-}) = 0$, $x(0^{-}) = 1$.\n- Stimulus: Periodic spike train with frequency $f$, so $\\Delta t = 1/f$.\n- Output variable: Normalized postsynaptic response $y_k = u_k x_k$, where $u_k$ is the value of $u$ immediately after its jump at spike $k$, and $x_k$ is the value of $x$ immediately before depletion at spike $k$.\n- Task: Derive discrete-time updates, implement them to compute the first five responses ($y_1$ to $y_5$), and classify the dynamics using a dominance integer $S$.\n- Dominance rule: $\\epsilon = 10^{-9}$. $I$ is count of increases ($y_k - y_{k-1} > \\epsilon$), $D$ is count of decreases ($y_k - y_{k-1}  -\\epsilon$) for $k \\in \\{2,3,4,5\\}$. $S=1$ if $I \\ge 3$ and $y_5 - y_1 > \\epsilon$; $S=-1$ if $D \\ge 3$ and $y_5 - y_1  -\\epsilon$; $S=0$ otherwise.\n- Test cases: Four parameter sets involving $f$, $U$, $\\tau_f$, $\\tau_d$ are provided.\n\n**2. Validation Verdict**\nThe problem is **valid**. It describes a well-established, scientifically grounded model of short-term synaptic plasticity (the Tsodyks-Markram model). The problem is mathematically well-posed, providing all necessary differential equations, update rules, initial conditions, and parameters. The objectives are stated clearly and are computationally tractable. There are no contradictions, ambiguities, or factual errors.\n\n**3. Derivation and Solution Methodology**\n\nThe task is to compute the sequence of postsynaptic responses $y_k$ generated by a periodic presynaptic spike train. This requires deriving discrete-time recurrence relations from the given continuous-time dynamics and instantaneous spike-time updates.\n\nLet us define the state of the synapse immediately before the $k$-th spike as $(u_{k}^{\\text{pre}}, x_{k}^{\\text{pre}})$. Let the state immediately after the update and depletion at spike $k$ be $(u_k, x_{k}^{\\text{post}})$, where $u_k$ is the post-facilitation release probability.\n\n**Step 1: Evolution between spikes**\nBetween spike $k-1$ and spike $k$, the system evolves for a duration $\\Delta t = 1/f$. The governing ordinary differential equations are linear and first-order.\nThe equation for $u(t)$ is $\\dfrac{du}{dt} = -u/\\tau_f$. With initial condition $u(t_{k-1}) = u_{k-1}$, its solution is $u(t) = u_{k-1} e^{-(t - t_{k-1})/\\tau_f}$. Thus, the value of $u$ just before spike $k$ is:\n$$u_{k}^{\\text{pre}} = u_{k-1} e^{-\\Delta t / \\tau_f}$$\n\nThe equation for $x(t)$ is $\\dfrac{dx}{dt} = (1 - x)/\\tau_d$. Let's define a variable $z(t) = 1 - x(t)$, so $\\dfrac{dz}{dt} = -\\dfrac{z}{\\tau_d}$. With initial condition $x(t_{k-1}) = x_{k-1}^{\\text{post}}$, we have $z(t_{k-1}) = 1 - x_{k-1}^{\\text{post}}$. The solution for $z(t)$ is $z(t) = z(t_{k-1}) e^{-(t - t_{k-1})/\\tau_d}$. Substituting back for $x(t)$, we get $1-x(t) = (1 - x_{k-1}^{\\text{post}}) e^{-(t - t_{k-1})/\\tau_d}$, which means $x(t) = 1 - (1 - x_{k-1}^{\\text{post}}) e^{-(t - t_{k-1})/\\tau_d}$. The value of $x$ just before spike $k$ is:\n$$x_{k}^{\\text{pre}} = 1 - (1 - x_{k-1}^{\\text{post}}) e^{-\\Delta t / \\tau_d}$$\n\n**Step 2: Updates at a spike**\nAt the arrival of spike $k$, the variables are updated instantaneously.\nFirst, the release probability $u$ is facilitated. The problem defines $u_k$ as the value after the jump:\n$$u_k = u_{k}^{\\text{pre}} + U (1 - u_{k}^{\\text{pre}})$$\nThe problem defines $x_k$ as the value of the resource *before* depletion, which is precisely $x_{k}^{\\text{pre}}$. Therefore:\n$$x_k = x_{k}^{\\text{pre}}$$\nThe normalized postsynaptic response $y_k$ is then calculated as:\n$$y_k = u_k x_k = u_k x_{k}^{\\text{pre}}$$\nFinally, the available resources $x$ are depleted using the newly updated release probability $u_k$. The state of $x$ after depletion is:\n$$x_{k}^{\\text{post}} = x_{k}^{\\text{pre}} (1 - u_k)$$\n\n**Step 3: Recurrence Relations and Algorithm**\nWe can now combine these steps to form a complete set of recurrence relations. The state of the system can be tracked by the variables $(u_k, x_{k}^{\\text{post}})$.\nThe update from step $k-1$ to $k$ proceeds as follows:\n1. Evolve between spikes to find the pre-spike state for spike $k$:\n   $$u_{k}^{\\text{pre}} = u_{k-1} e^{-\\Delta t / \\tau_f}$$\n   $$x_{k}^{\\text{pre}} = 1 - (1 - x_{k-1}^{\\text{post}}) e^{-\\Delta t / \\tau_d}$$\n2. Update at spike $k$ and calculate the response:\n   $$u_k = u_{k}^{\\text{pre}} + U(1 - u_{k}^{\\text{pre}})$$\n   $$y_k = u_k x_{k}^{\\text{pre}}$$\n3. Calculate the post-depletion resource state for the next interval:\n   $$x_{k}^{\\text{post}} = x_{k}^{\\text{pre}} (1 - u_k)$$\n\n**Initial Conditions:**\nThe system starts from a quiescent state, $u(0^-)=0$ and $x(0^-)=1$. This corresponds to the state after a hypothetical spike at $t=-\\infty$. Thus, for the first spike ($k=1$), we can set the \"previous\" state values as $u_0 = 0$ and $x_0^{\\text{post}} = 1$.\nThe simulation proceeds as follows:\nInitialize with $u_{\\text{prev}} = 0$ and $x_{\\text{post_prev}} = 1$.\nFor $k = 1, 2, 3, 4, 5$:\n- Compute $u_{k}^{\\text{pre}} = u_{\\text{prev}} \\exp(-\\Delta t / \\tau_f)$.\n- Compute $x_{k}^{\\text{pre}} = 1 - (1 - x_{\\text{post_prev}}) \\exp(-\\Delta t / \\tau_d)$.\n- Compute $u_k = u_{k}^{\\text{pre}} + U(1 - u_{k}^{\\text{pre}})$.\n- Compute $y_k = u_k x_{k}^{\\text{pre}}$.\n- Compute $x_{k}^{\\text{post}} = x_{k}^{\\text{pre}} (1 - u_k)$.\n- Update for the next iteration: $u_{\\text{prev}} = u_k$ and $x_{\\text{post_prev}} = x_{k}^{\\text{post}}$.\n- Store $y_k$.\n\nThe time constants $\\tau_f$ and $\\tau_d$ are provided in milliseconds (ms) and must be converted to seconds by dividing by $1000$ to be dimensionally consistent with $\\Delta t = 1/f$, where $f$ is in Hz.\n\n**Step 4: Dominance Classification**\nAfter computing the sequence $(y_1, y_2, y_3, y_4, y_5)$, the dominance integer $S$ is determined. Let $\\epsilon = 10^{-9}$.\n- Initialize counters for increases $I=0$ and decreases $D=0$.\n- For $k$ from $2$ to $5$, compare $y_k$ and $y_{k-1}$:\n  - If $y_k - y_{k-1}  \\epsilon$, increment $I$.\n  - If $y_k - y_{k-1}  -\\epsilon$, increment $D$.\n- Apply the rules:\n  - If $I \\ge 3$ and $y_5 - y_1  \\epsilon$, set $S = 1$.\n  - Else if $D \\ge 3$ and $y_5 - y_1  -\\epsilon$, set $S = -1$.\n  - Otherwise, set $S = 0$.\n\nThis completes the theoretical and algorithmic framework required to solve the problem. The implementation will follow this logic precisely.", "answer": "$$\\boxed{\\text{[[0.200000, 0.263610, 0.231733, 0.198369, 0.173873, -1], [0.500000, 0.288226, 0.158319, 0.101859, 0.073489, -1], [0.050000, 0.088656, 0.119098, 0.142512, 0.160163, 1], [0.200000, 0.065275, 0.023253, 0.008453, 0.003099, -1]]}}$$", "id": "2751339"}]}