{"hands_on_practices": [{"introduction": "To understand the function of any ion channel, including the GABA$_\\text{A}$ receptor, we must first determine the equilibrium potential for its permeant ions. This exercise [@problem_id:2712051] guides you through deriving the Nernst equation from fundamental thermodynamic principles. By calculating the chloride reversal potential, $E_{Cl}$, you will establish the voltage at which the electrical and chemical gradients for $Cl^-$ are perfectly balanced, providing the critical reference point for predicting GABA's influence on a neuron's membrane potential.", "problem": "A central neuron expresses ligand-gated Gamma-Aminobutyric Acid type A (GABA$_\\text{A}$) receptors, which, for the purpose of this problem, can be treated as selectively permeable to chloride ions only. Under steady activation of these channels in voltage clamp, the net chloride flux vanishes when the membrane potential equals the chloride reversal potential. Starting from the equality of electrochemical potentials at equilibrium and the ideal dilute solution form of the chemical potential, derive a general expression for the chloride reversal (Nernst) potential in terms of temperature, ion charge, and intra- and extracellular chloride concentrations. Clearly define the membrane potential as the intracellular electric potential minus the extracellular electric potential.\n\nThen, evaluate the derived expression for an experiment performed at temperature $T = 310$ K with extracellular chloride concentration $[ \\mathrm{Cl}^{-} ]_{o} = 120$ mM and intracellular chloride concentration $[ \\mathrm{Cl}^{-} ]_{i} = 15$ mM. Take the chloride valence to be $z = -1$, the universal gas constant to be $R = 8.314462618$ J mol$^{-1}$ K$^{-1}$, and the Faraday constant to be $F = 96485.33212$ C mol$^{-1}$. Express the final numerical value of the chloride reversal potential in millivolts, including its sign, and round your answer to four significant figures.", "solution": "The problem as stated is valid. It is scientifically grounded, well-posed, and contains all necessary information and definitions to permit a unique solution. It is a standard problem in cellular biophysics requiring the derivation and application of the Nernst equation.\n\nThe derivation of the Nernst potential begins from the fundamental thermodynamic principle that at equilibrium, there is no net flux of an ionic species across a permeable membrane. This condition is met when the electrochemical potential of the ion is uniform across the membrane. The electrochemical potential, $\\tilde{\\mu_j}$, for an ion species $j$ is the sum of its chemical potential, $\\mu_j$, and the electrical potential energy per mole, $z_j F \\phi$.\n$$ \\tilde{\\mu_j} = \\mu_j + z_j F \\phi $$\nHere, $z_j$ is the valence of the ion, $F$ is the Faraday constant, and $\\phi$ is the electric potential. For an ideal dilute solution, the chemical potential is given by:\n$$ \\mu_j = \\mu_j^0 + RT \\ln([j]) $$\nwhere $\\mu_j^0$ is the standard chemical potential, $R$ is the universal gas constant, $T$ is the absolute temperature, and $[j]$ is the molar concentration of the ion.\n\nFor chloride ions ($\\text{Cl}^{-}$), we can write the electrochemical potential in the intracellular ($i$) and extracellular ($o$) compartments:\n$$ \\tilde{\\mu}_{\\text{Cl},i} = \\mu_{\\text{Cl}}^0 + RT \\ln([\\text{Cl}^{-}]_{i}) + z_{\\text{Cl}} F \\phi_i $$\n$$ \\tilde{\\mu}_{\\text{Cl},o} = \\mu_{\\text{Cl}}^0 + RT \\ln([\\text{Cl}^{-}]_{o}) + z_{\\text{Cl}} F \\phi_o $$\nAt equilibrium, the electrochemical potentials must be equal:\n$$ \\tilde{\\mu}_{\\text{Cl},i} = \\tilde{\\mu}_{\\text{Cl},o} $$\nSubstituting the expressions for the electrochemical potentials yields:\n$$ \\mu_{\\text{Cl}}^0 + RT \\ln([\\text{Cl}^{-}]_{i}) + z_{\\text{Cl}} F \\phi_i = \\mu_{\\text{Cl}}^0 + RT \\ln([\\text{Cl}^{-}]_{o}) + z_{\\text{Cl}} F \\phi_o $$\nThe standard chemical potential $\\mu_{\\text{Cl}}^0$ is identical on both sides and cancels out. Rearranging the remaining terms to solve for the electric potential difference $(\\phi_i - \\phi_o)$ gives:\n$$ z_{\\text{Cl}} F \\phi_i - z_{\\text{Cl}} F \\phi_o = RT \\ln([\\text{Cl}^{-}]_{o}) - RT \\ln([\\text{Cl}^{-}]_{i}) $$\n$$ z_{\\text{Cl}} F (\\phi_i - \\phi_o) = RT \\left( \\ln([\\text{Cl}^{-}]_{o}) - \\ln([\\text{Cl}^{-}]_{i}) \\right) $$\nUsing the property of logarithms $\\ln(a) - \\ln(b) = \\ln(a/b)$:\n$$ z_{\\text{Cl}} F (\\phi_i - \\phi_o) = RT \\ln\\left(\\frac{[\\text{Cl}^{-}]_{o}}{[\\text{Cl}^{-}]_{i}}\\right) $$\nThe membrane potential, $V_m$, is defined as $V_m = \\phi_i - \\phi_o$. The specific value of the membrane potential at which equilibrium is achieved is the Nernst potential, or reversal potential, for that ion, denoted $E_{\\text{Cl}}$.\n$$ E_{\\text{Cl}} = \\phi_i - \\phi_o = \\frac{RT}{z_{\\text{Cl}}F} \\ln\\left(\\frac{[\\text{Cl}^{-}]_{o}}{[\\text{Cl}^{-}]_{i}}\\right) $$\nThis is the general expression for the chloride reversal potential.\n\nNow, we evaluate this expression using the provided values:\nTemperature, $T = 310 \\text{ K}$\nExtracellular chloride concentration, $[\\text{Cl}^{-}]_{o} = 120 \\text{ mM}$\nIntracellular chloride concentration, $[\\text{Cl}^{-}]_{i} = 15 \\text{ mM}$\nChloride valence, $z_{\\text{Cl}} = -1$\nUniversal gas constant, $R = 8.314462618 \\text{ J mol}^{-1} \\text{ K}^{-1}$\nFaraday constant, $F = 96485.33212 \\text{ C mol}^{-1}$\n\nFirst, we calculate the concentration ratio:\n$$ \\frac{[\\text{Cl}^{-}]_{o}}{[\\text{Cl}^{-}]_{i}} = \\frac{120 \\text{ mM}}{15 \\text{ mM}} = 8 $$\nThe units of concentration cancel, as required.\n\nNext, we substitute all values into the Nernst equation:\n$$ E_{\\text{Cl}} = \\frac{(8.314462618 \\text{ J mol}^{-1} \\text{ K}^{-1}) \\times (310 \\text{ K})}{(-1) \\times (96485.33212 \\text{ C mol}^{-1})} \\ln(8) $$\nThe product $RT$ is:\n$$ RT = 8.314462618 \\times 310 = 2577.4834... \\text{ J mol}^{-1} $$\nThe product $z_{\\text{Cl}}F$ is:\n$$ z_{\\text{Cl}}F = (-1) \\times 96485.33212 = -96485.33212 \\text{ C mol}^{-1} $$\nThus, the term $\\frac{RT}{z_{\\text{Cl}}F}$ becomes:\n$$ \\frac{RT}{z_{\\text{Cl}}F} = \\frac{2577.4834...}{-96485.33212...} \\approx -0.0267133 \\text{ V} $$\nThe natural logarithm of $8$ is:\n$$ \\ln(8) \\approx 2.0794415 $$\nNow, we compute the final value for $E_{\\text{Cl}}$:\n$$ E_{\\text{Cl}} \\approx -0.0267133 \\text{ V} \\times 2.0794415 $$\n$$ E_{\\text{Cl}} \\approx -0.0555474 \\text{ V} $$\nThe problem requires the answer in millivolts ($mV$). To convert from Volts to millivolts, we multiply by $1000$:\n$$ E_{\\text{Cl}} \\approx -0.0555474 \\times 1000 \\text{ mV} = -55.5474 \\text{ mV} $$\nFinally, rounding to four significant figures gives:\n$$ E_{\\text{Cl}} \\approx -55.55 \\text{ mV} $$\nThis negative value indicates that the inside of the cell must be $55.55 \\text{ mV}$ more negative than the outside to prevent a net influx of negative chloride ions, which are more concentrated externally.", "answer": "$$\n\\boxed{-55.55}\n$$", "id": "2712051"}, {"introduction": "While the reversal potential tells us the direction of ion flow, the true power of tonic inhibition lies in how it changes a neuron's integrative properties. This practice [@problem_id:2712082] models the neuron as a circuit with parallel conductances to quantify how tonic GABA$_\\text{A}$ receptor activation decreases the cell's input resistance, $R_{in}$. This demonstrates the biophysical basis of \"shunting inhibition,\" where the membrane becomes \"leakier,\" dampening the impact of excitatory signals.", "problem": "A cortical pyramidal neuron at rest is modeled by an ohmic membrane with conductances in parallel. The total steady-state input resistance $R_{\\mathrm{in}}$ is defined as the inverse of the slope of the steady-state current–voltage relation at rest, and conductances in parallel add. The baseline membrane leak conductance is $G_{L} = 7\\,\\mathrm{nS}$. Ambient extracellular gamma-aminobutyric acid (GABA) acting at extrasynaptic gamma-aminobutyric acid type A (GABA$_\\text{A}$) receptors (sometimes denoted by extracellular GABA as $\\mathrm{GABA}_{e}$ to emphasize tonic activation) produces a tonic conductance $G_{\\mathrm{tonic},0} = 2\\,\\mathrm{nS}$ at rest. After a perturbation that elevates extracellular GABA, the tonic conductance increases by $3\\,\\mathrm{nS}$, with no change in reversal potential near rest and no activation of phasic synaptic inputs.\n\nUsing only the definitions above and first principles about parallel conductances, compute the change in input resistance $\\Delta R_{\\mathrm{in}} = R_{\\mathrm{in},1} - R_{\\mathrm{in},0}$ resulting from this $3\\,\\mathrm{nS}$ increase in tonic conductance. Express your final answer in megaohms ($\\mathrm{M}\\Omega$), and round to three significant figures.\n\nBriefly justify, in qualitative terms grounded in biophysical principles, how this change in $R_{\\mathrm{in}}$ would be expected to influence the amplitude and temporal summation of excitatory postsynaptic potentials (EPSPs) driven by a fixed excitatory synaptic conductance whose reversal potential is depolarized relative to rest. Your qualitative discussion will not be graded numerically, but it must be consistent with your calculation and the stated assumptions.", "solution": "The problem as stated is scientifically grounded, well-posed, and contains sufficient information for a unique solution. The model of a neuron as an ohmic device with parallel conductances is a standard and valid simplification for analyzing subthreshold behavior near the resting potential. We proceed with the derivation.\n\nThe total input conductance, $G_{\\mathrm{total}}$, of the neuron is the sum of all parallel conductances. At rest, before the perturbation, the total conductance, $G_{\\mathrm{total},0}$, is the sum of the leak conductance, $G_{L}$, and the initial tonic GABA$_\\text{A}$ conductance, $G_{\\mathrm{tonic},0}$.\n$$\nG_{\\mathrm{total},0} = G_{L} + G_{\\mathrm{tonic},0}\n$$\nUsing the provided values:\n$$\nG_{L} = 7\\,\\mathrm{nS}\n$$\n$$\nG_{\\mathrm{tonic},0} = 2\\,\\mathrm{nS}\n$$\nThe initial total conductance is:\n$$\nG_{\\mathrm{total},0} = 7\\,\\mathrm{nS} + 2\\,\\mathrm{nS} = 9\\,\\mathrm{nS}\n$$\nThe input resistance, $R_{\\mathrm{in}}$, is defined as the reciprocal of the total conductance. Therefore, the initial input resistance, $R_{\\mathrm{in},0}$, is:\n$$\nR_{\\mathrm{in},0} = \\frac{1}{G_{\\mathrm{total},0}} = \\frac{1}{9\\,\\mathrm{nS}} = \\frac{1}{9 \\times 10^{-9}\\,\\mathrm{S}} = \\frac{1}{9} \\times 10^{9}\\,\\Omega\n$$\nTo express this in megaohms ($\\mathrm{M}\\Omega$), where $1\\,\\mathrm{M}\\Omega = 10^{6}\\,\\Omega$:\n$$\nR_{\\mathrm{in},0} = \\frac{1000}{9}\\,\\mathrm{M}\\Omega \\approx 111.111...\\,\\mathrm{M}\\Omega\n$$\nNext, a perturbation increases the tonic conductance by $3\\,\\mathrm{nS}$. The new tonic conductance, $G_{\\mathrm{tonic},1}$, is:\n$$\nG_{\\mathrm{tonic},1} = G_{\\mathrm{tonic},0} + 3\\,\\mathrm{nS} = 2\\,\\mathrm{nS} + 3\\,\\mathrm{nS} = 5\\,\\mathrm{nS}\n$$\nThe new total conductance, $G_{\\mathrm{total},1}$, is the sum of the leak conductance (which is unchanged) and the new tonic conductance:\n$$\nG_{\\mathrm{total},1} = G_{L} + G_{\\mathrm{tonic},1} = 7\\,\\mathrm{nS} + 5\\,\\mathrm{nS} = 12\\,\\mathrm{nS}\n$$\nThe new input resistance, $R_{\\mathrm{in},1}$, is the reciprocal of this new total conductance:\n$$\nR_{\\mathrm{in},1} = \\frac{1}{G_{\\mathrm{total},1}} = \\frac{1}{12\\,\\mathrm{nS}} = \\frac{1}{12 \\times 10^{-9}\\,\\mathrm{S}} = \\frac{1}{12} \\times 10^{9}\\,\\Omega\n$$\nConverting to megaohms:\n$$\nR_{\\mathrm{in},1} = \\frac{1000}{12}\\,\\mathrm{M}\\Omega \\approx 83.333...\\,\\mathrm{M}\\Omega\n$$\nThe problem requires the calculation of the change in input resistance, $\\Delta R_{\\mathrm{in}}$, defined as $\\Delta R_{\\mathrm{in}} = R_{\\mathrm{in},1} - R_{\\mathrm{in},0}$.\n$$\n\\Delta R_{\\mathrm{in}} = \\left(\\frac{1000}{12} - \\frac{1000}{9}\\right)\\,\\mathrm{M}\\Omega = 1000 \\left(\\frac{3 - 4}{36}\\right)\\,\\mathrm{M}\\Omega = -\\frac{1000}{36}\\,\\mathrm{M}\\Omega = -\\frac{250}{9}\\,\\mathrm{M}\\Omega\n$$\nNumerically, this is:\n$$\n\\Delta R_{\\mathrm{in}} \\approx -27.777...\\,\\mathrm{M}\\Omega\n$$\nRounding to three significant figures as required, we obtain:\n$$\n\\Delta R_{\\mathrm{in}} \\approx -27.8\\,\\mathrm{M}\\Omega\n$$\nNow, for the qualitative justification. The calculated negative change in $R_{\\mathrm{in}}$ signifies a decrease in the input resistance of the neuron. This phenomenon is a classic example of shunting inhibition. The biophysical consequences are twofold:\n\n$1$. Influence on EPSP amplitude: According to Ohm's law applied to the membrane in a simplified model, the peak voltage change of a postsynaptic potential, $\\Delta V_{\\mathrm{PSP}}$, is proportional to the input resistance and the synaptic current, $I_{\\mathrm{syn}}$: $\\Delta V_{\\mathrm{PSP}} \\approx I_{\\mathrm{syn}} \\cdot R_{\\mathrm{in}}$. The problem specifies a fixed excitatory synaptic conductance. The synaptic current is given by $I_{\\mathrm{syn}} = G_{\\mathrm{syn}}(V_m - E_{\\mathrm{exc}})$, where $V_m$ is the membrane potential and $E_{\\mathrm{exc}}$ is the excitatory reversal potential. As $R_{\\mathrm{in}}$ decreases, the membrane becomes \"less resistive\" or \"more leaky\". For a given synaptic current injection, the resulting depolarization (the EPSP amplitude) will be smaller. The increased tonic conductance provides an additional pathway for current to leak out of the cell, thus shunting the excitatory current and dampening the voltage response.\n\n$2$. Influence on temporal summation: The membrane time constant, $\\tau_{m}$, determines the rate at which the membrane potential returns to its resting value following a perturbation. It is given by $\\tau_{m} = R_{m}C_{m}$, where $R_{m}$ is the specific membrane resistance and $C_{m}$ is the specific membrane capacitance. The input resistance $R_{\\mathrm{in}}$ is directly proportional to $R_{m}$ (by a geometric factor). Therefore, the decrease in $R_{\\mathrm{in}}$ implies a proportional decrease in the membrane time constant $\\tau_{m}$. A shorter time constant means that EPSPs decay more quickly. This provides a narrower time window for successive EPSPs to summate. Consequently, the efficacy of temporal summation is reduced, making it more difficult for the neuron to reach its firing threshold through high-frequency synaptic input.", "answer": "$$\n\\boxed{-27.8}\n$$", "id": "2712082"}, {"introduction": "Neuronal inhibition is not a static process; it is a dynamic interplay between ion fluxes, cellular homeostatic mechanisms, and ongoing synaptic activity. This final practice [@problem_id:2712108] challenges you to build a computational model that integrates these elements, including the slow kinetics characteristic of $\\varepsilon$-containing GABA$_\\text{A}$ receptors and dynamic chloride regulation by the KCC2 transporter. By simulating the neuron's firing output under various conditions, you will gain a deeper appreciation for how tonic inhibition's effectiveness depends critically on the cell's metabolic state and background drive.", "problem": "You will implement a single-compartment conductance-based neuron receiving a tonic gamma-aminobutyric acid type A (GABA$_\\text{A}$) current mediated by an $\\alpha \\beta \\varepsilon$ subunit combination, using a Hodgkin–Huxley-style conductance term with a dynamically evolving chloride reversal potential. The purpose is to quantify how tonic $\\alpha \\beta \\varepsilon$ currents modulate firing under different chloride homeostasis conditions.\n\nStart from the following fundamental bases and core definitions:\n\n- The membrane equation for a single isopotential compartment: $C_{\\mathrm{m}} \\, dV/dt = - \\sum I_{\\mathrm{ion}} + I_{\\mathrm{app}}$, where $C_{\\mathrm{m}}$ is the capacitance, $V$ is the membrane potential, and $I_{\\mathrm{app}}$ is the applied current.\n- Ohm’s law for each ionic pathway: $I_{\\mathrm{ion}} = g_{\\mathrm{ion}} \\, (V - E_{\\mathrm{ion}})$, where $g_{\\mathrm{ion}}$ is conductance and $E_{\\mathrm{ion}}$ is the reversal potential.\n- The Nernst equation: $E_{\\mathrm{ion}} = \\dfrac{R T}{z F} \\ln \\left(\\dfrac{[\\mathrm{ion}]_{\\mathrm{o}}}{[\\mathrm{ion}]_{\\mathrm{i}}}\\right)$, with gas constant $R$, absolute temperature $T$, valence $z$, and Faraday constant $F$.\n- Intracellular concentration dynamics governed by charge conservation: $d[\\mathrm{ion}]_{\\mathrm{i}}/dt = - I_{\\mathrm{ion}}/(z F V_{\\mathrm{i}}) + \\text{homeostatic terms}$, where $V_{\\mathrm{i}}$ is intracellular volume.\n- For chloride, $z = -1$. Potassium-Chloride Cotransporter 2 (KCC2) is modeled as a first-order relaxation of intracellular chloride toward a homeostatic setpoint $[\\mathrm{Cl}]_{\\mathrm{i,eq}}$ with rate constant $k_{\\mathrm{KCC2}}$.\n\nModel specification:\n\n- Membrane dynamics: $C_{\\mathrm{m}} \\, \\dfrac{dV}{dt} = - g_{\\mathrm{L}} (V - E_{\\mathrm{L}}) - g_{\\mathrm{GABA}} \\, s \\, (V - E_{\\mathrm{Cl}}) + I_{\\mathrm{app}}$.\n- Tonic GABA$_\\text{A}$ gating (Hodgkin–Huxley style for a single gating variable): $\\dfrac{ds}{dt} = \\dfrac{s_{\\infty} - s}{\\tau_{\\varepsilon}}$. For tonic ambient gamma-aminobutyric acid, set $s_{\\infty} = 1$ whenever $g_{\\mathrm{GABA}} &gt; 0$ and $s_{\\infty} = 0$ when $g_{\\mathrm{GABA}} = 0$. The $\\varepsilon$ subunit confers slow desensitization; approximate this with a single time constant $\\tau_{\\varepsilon}$.\n- Chloride reversal potential: $E_{\\mathrm{Cl}} = \\dfrac{R T}{z F} \\ln \\left(\\dfrac{[\\mathrm{Cl}]_{\\mathrm{o}}}{[\\mathrm{Cl}]_{\\mathrm{i}}}\\right)$ with $z = -1$.\n- Intracellular chloride dynamics: $\\dfrac{d [\\mathrm{Cl}]_{\\mathrm{i}}}{dt} = - \\dfrac{I_{\\mathrm{GABA}}}{z F V_{\\mathrm{i}}} - k_{\\mathrm{KCC2}} \\left([\\mathrm{Cl}]_{\\mathrm{i}} - [\\mathrm{Cl}]_{\\mathrm{i,eq}}\\right)$. Note that with $z = -1$, inward chloride flux corresponds to positive $I_{\\mathrm{GABA}}$ and increases $[\\mathrm{Cl}]_{\\mathrm{i}}$.\n- Spiking rule: When $V$ crosses an absolute threshold $V_{\\mathrm{th}}$ from below, record a spike, reset $V$ to $V_{\\mathrm{reset}}$, and hold $V$ at $V_{\\mathrm{reset}}$ for a refractory period $\\tau_{\\mathrm{ref}}$.\n\nConstants and units:\n\n- Use SI base units in the differential equations. For convenience, numerical parameters are provided in commonly used neurophysiological units. Convert them as needed.\n- Capacitance $C_{\\mathrm{m}} = 100 \\, \\mathrm{pF}$, leak conductance $g_{\\mathrm{L}} = 10 \\, \\mathrm{nS}$, leak reversal $E_{\\mathrm{L}} = -65 \\, \\mathrm{mV}$.\n- Spike threshold $V_{\\mathrm{th}} = -50 \\, \\mathrm{mV}$, reset $V_{\\mathrm{reset}} = -65 \\, \\mathrm{mV}$, refractory period $\\tau_{\\mathrm{ref}} = 5 \\, \\mathrm{ms}$.\n- Temperature $T = 310 \\, \\mathrm{K}$, gas constant $R = 8.314 \\, \\mathrm{J} \\cdot \\mathrm{mol}^{-1} \\cdot \\mathrm{K}^{-1}$, Faraday constant $F = 96485 \\, \\mathrm{C} \\cdot \\mathrm{mol}^{-1}$.\n- Chloride concentrations: $[\\mathrm{Cl}]_{\\mathrm{o}} = 120 \\, \\mathrm{mM}$, initial $[\\mathrm{Cl}]_{\\mathrm{i}}(0) = [\\mathrm{Cl}]_{\\mathrm{i,eq}} = 5 \\, \\mathrm{mM}$, intracellular volume $V_{\\mathrm{i}} = 1 \\times 10^{-15} \\, \\mathrm{m}^{3}$. Recall that $\\mathrm{mM}$ numerically equals $\\mathrm{mol} \\cdot \\mathrm{m}^{-3}$ in SI.\n- Gating $\\tau_{\\varepsilon} = 50 \\, \\mathrm{ms}$.\n\nSimulation details:\n\n- Numerical integration by explicit Euler with fixed step $\\Delta t = 2 \\times 10^{-5} \\, \\mathrm{s}$ over a total duration $T_{\\mathrm{sim}} = 2.0 \\, \\mathrm{s}$.\n- Initialize $V(0) = E_{\\mathrm{L}}$, $s(0) = 0$, $[\\mathrm{Cl}]_{\\mathrm{i}}(0) = [\\mathrm{Cl}]_{\\mathrm{i,eq}}$.\n- Applied current $I_{\\mathrm{app}}$ is constant within each test.\n\nOutputs:\n\n- For each test case, compute the firing rate in $\\mathrm{Hz}$ over the full simulation as the total spike count divided by $T_{\\mathrm{sim}}$.\n- Report each firing rate rounded to $3$ decimal places.\n\nTest suite:\n\nEach test case is a triplet $(I_{\\mathrm{app}}, g_{\\mathrm{GABA}}, k_{\\mathrm{KCC2}})$ with units $\\mathrm{pA}$, $\\mathrm{nS}$, and $\\mathrm{s}^{-1}$, respectively.\n\n- Case $1$ (happy path without tonic inhibition): $(200, 0, 1.0)$\n- Case $2$ (moderate tonic, strong extrusion): $(200, 5, 5.0)$\n- Case $3$ (strong tonic, weak extrusion, higher drive): $(400, 12, 0.05)$\n- Case $4$ (strong tonic, near-clamped chloride): $(400, 20, 50.0)$\n\nFinal output format:\n\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, for example, $\\left[ r_1, r_2, r_3, r_4 \\right]$, where each $r_i$ is the firing rate in $\\mathrm{Hz}$ rounded to $3$ decimal places, in the order of the test suite.", "solution": "The problem is valid. It presents a well-defined, scientifically grounded computational neuroscience task. The model is a single-compartment neuron with Hodgkin–Huxley-style conductances, which is a standard and rigorous framework. The equations for membrane potential, gating variable dynamics, and ionic concentration changes are all based on fundamental biophysical principles. All parameters, initial conditions, and simulation protocols are specified completely and consistently.\n\nThe problem requires implementation of a numerical simulation to solve a system of coupled ordinary differential equations (ODEs) that describe the neuron's state. The state is defined by three variables: the membrane potential $V(t)$, the GABA$_\\text{A}$ receptor gating variable $s(t)$, and the intracellular chloride concentration $[\\text{Cl}]_{\\text{i}}(t)$.\n\nThe primary equation governs the membrane potential $V$, derived from conservation of charge in an isopotential compartment:\n$$\nC_{\\mathrm{m}} \\frac{dV}{dt} = -I_{\\mathrm{L}} - I_{\\mathrm{GABA}} + I_{\\mathrm{app}}\n$$\nwhere $C_{\\mathrm{m}} = 100 \\, \\mathrm{pF}$ is the membrane capacitance, and $I_{\\mathrm{app}}$ is the applied current. The currents are the leak current, $I_{\\mathrm{L}} = g_{\\mathrm{L}} (V - E_{\\mathrm{L}})$ with $g_{\\mathrm{L}} = 10 \\, \\mathrm{nS}$ and $E_{\\mathrm{L}} = -65 \\, \\mathrm{mV}$, and the GABAergic current, $I_{\\mathrm{GABA}} = g_{\\mathrm{GABA}} s (V - E_{\\mathrm{Cl}})$. The full ODE for $V$ is:\n$$\n\\frac{dV}{dt} = \\frac{1}{C_{\\mathrm{m}}} \\left[ -g_{\\mathrm{L}}(V - E_{\\mathrm{L}}) - g_{\\mathrm{GABA}}s(V - E_{\\mathrm{Cl}}) + I_{\\mathrm{app}} \\right]\n$$\n\nThe gating variable $s$ represents the fraction of open GABA$_\\text{A}$ channels. Its dynamics are approximated by a first-order relaxation process:\n$$\n\\frac{ds}{dt} = \\frac{s_{\\infty} - s}{\\tau_{\\varepsilon}}\n$$\nwhere $\\tau_{\\varepsilon} = 50 \\, \\mathrm{ms}$. For a tonic GABA application, the steady-state activation $s_{\\infty}$ is set to $1$ when $g_{\\mathrm{GABA}} > 0$ and $0$ otherwise.\n\nThe chloride reversal potential, $E_{\\mathrm{Cl}}$, is not constant; it depends on the intracellular chloride concentration $[\\text{Cl}]_{\\text{i}}$ via the Nernst equation:\n$$\nE_{\\mathrm{Cl}} = \\frac{RT}{zF} \\ln\\left(\\frac{[\\text{Cl}]_{\\text{o}}}{[\\text{Cl}]_{\\text{i}}}\\right)\n$$\nwith chloride valence $z = -1$, temperature $T = 310 \\, \\mathrm{K}$, gas constant $R = 8.314 \\, \\mathrm{J} \\cdot \\mathrm{mol}^{-1} \\cdot \\mathrm{K}^{-1}$, Faraday constant $F = 96485 \\, \\mathrm{C} \\cdot \\mathrm{mol}^{-1}$, and extracellular chloride concentration $[\\text{Cl}]_{\\text{o}} = 120 \\, \\mathrm{mM}$.\n\nThe intracellular chloride concentration $[\\text{Cl}]_{\\text{i}}$ evolves based on the chloride flux through GABA$_\\text{A}$ channels and the action of the KCC2 transporter, which extrudes chloride. This is modeled by the third ODE:\n$$\n\\frac{d[\\text{Cl}]_{\\text{i}}}{dt} = -\\frac{I_{\\mathrm{GABA}}}{z F V_{\\mathrm{i}}} - k_{\\mathrm{KCC2}} \\left([\\text{Cl}]_{\\text{i}} - [\\text{Cl}]_{\\text{i,eq}}\\right)\n$$\nwhere $V_{\\mathrm{i}} = 1 \\times 10^{-15} \\, \\mathrm{m}^3$ is the intracellular volume, $k_{\\mathrm{KCC2}}$ is the transporter rate, and $[\\text{Cl}]_{\\text{i,eq}} = 5 \\, \\mathrm{mM}$ is the target equilibrium concentration for KCC2. With $z=-1$, this becomes:\n$$\n\\frac{d[\\text{Cl}]_{\\text{i}}}{dt} = \\frac{g_{\\mathrm{GABA}} s (V - E_{\\mathrm{Cl}})}{F V_{\\mathrm{i}}} - k_{\\mathrm{KCC2}} ([\\text{Cl}]_{\\text{i}} - [\\text{Cl}]_{\\text{i,eq}})\n$$\n\nThis system of ODEs is supplemented by a discrete rule for neuronal spiking. When $V$ reaches a threshold $V_{\\text{th}} = -50 \\, \\mathrm{mV}$, a spike is recorded. Immediately, $V$ is reset to $V_{\\text{reset}} = -65 \\, \\mathrm{mV}$ and clamped at this value for a refractory period of $\\tau_{\\text{ref}} = 5 \\, \\mathrm{ms}$.\n\nThe solution is obtained by numerical integration using the explicit Euler method with a fixed time step of $\\Delta t = 2 \\times 10^{-5} \\, \\mathrm{s}$ for a total duration of $T_{\\text{sim}} = 2.0 \\, \\mathrm{s}$. For internal calculations, all provided parameters must be converted to base SI units (e.g., pA to A, nS to S, mV to V, ms to s) to ensure dimensional consistency.\n\nThe simulation algorithm proceeds as follows for each test case:\n1.  Initialize state variables to their specified initial conditions: $V(0) = E_{\\mathrm{L}}$, $s(0) = 0$, $[\\text{Cl}]_{\\text{i}}(0) = [\\text{Cl}]_{\\text{i,eq}}$.\n2.  Iterate through time from $t=0$ to $T_{\\text{sim}}$. In each time step $\\Delta t$:\n    a. Determine the value of $V$ to be used for calculating the ionic currents and derivatives. If the neuron is in the refractory period or has just crossed the spike threshold, this value is $V_{\\text{reset}}$; otherwise, it is the potential from the previous time step.\n    b. Calculate the derivatives $dV/dt$, $ds/dt$, and $d[\\text{Cl}]_{\\text{i}}/dt$ based on the state at the beginning of the step.\n    c. Update the state variables $s$ and $[\\text{Cl}]_{\\text{i}}$ using the Euler step: $y_{n+1} = y_n + \\Delta t \\cdot (dy/dt)_n$.\n    d. Implement the spiking and refractory logic for $V$. If $V \\ge V_{\\text{th}}$ and the neuron is not refractory, record a spike, set $V$ to $V_{\\text{reset}}$, and start the refractory timer. If the refractory timer is active, hold $V$ at $V_{\\text{reset}}$. Otherwise, update $V$ using its calculated Euler step.\n3.  Upon completion of the simulation, the firing rate is computed as the total spike count divided by $T_{\\text{sim}}$. This result is then rounded to $3$ decimal places.\n\nThe final output is a list containing the computed firing rates for all four test cases provided.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the conductance-based neuron problem for the given test cases.\n    \"\"\"\n\n    def run_simulation(I_app_pA, g_gaba_nS, k_kcc2_s_inv):\n        \"\"\"\n        Runs a single simulation for a given set of parameters.\n        \"\"\"\n        # --- Constants and SI Unit Conversions ---\n        # Fixed parameters\n        C_m = 100e-12   # F\n        g_L = 10e-9     # S\n        E_L = -65e-3    # V\n        V_th = -50e-3   # V\n        V_reset = -65e-3# V\n        tau_ref = 5e-3  # s\n        T = 310.0       # K\n        R = 8.314       # J mol^-1 K^-1\n        F = 96485.0     # C mol^-1\n        Cl_o = 120.0    # mol m^-3 (mM is numerically mol/m^3 in SI)\n        Cl_i_eq = 5.0   # mol m^-3\n        V_i = 1e-15     # m^3\n        tau_eps = 50e-3 # s\n\n        # Test case parameters\n        I_app = I_app_pA * 1e-12      # A\n        g_gaba = g_gaba_nS * 1e-9   # S\n        k_kcc2 = k_kcc2_s_inv         # s^-1\n\n        # Simulation parameters\n        T_sim = 2.0     # s\n        dt = 2e-5       # s\n        num_steps = int(T_sim / dt)\n\n        # Pre-calculated constants\n        RT_over_F = R * T / F\n        tau_ref_steps = int(tau_ref / dt)\n\n        # --- State Variables Initialization ---\n        v = E_L\n        s = 0.0\n        cl_i = Cl_i_eq\n\n        # --- Simulation Tracking ---\n        spike_count = 0\n        refractory_counter = 0\n\n        # --- Main Simulation Loop ---\n        for _ in range(num_steps):\n            \n            # Determine voltage for derivative calculations\n            v_for_calc = v\n\n            is_spiking_now = False\n            if refractory_counter > 0:\n                refractory_counter -= 1\n                v_for_calc = V_reset\n            elif v >= V_th:\n                spike_count += 1\n                refractory_counter = tau_ref_steps\n                v_for_calc = V_reset # Use reset potential for dynamics in this step\n                is_spiking_now = True\n            \n            # Calculate E_Cl based on current cl_i\n            # Prevent log(0) if cl_i somehow becomes non-positive\n            if cl_i <= 0:\n                e_cl = RT_over_F * 10 # A large positive potential to prevent run-away\n            else:\n                e_cl = -RT_over_F * np.log(Cl_o / cl_i)\n\n            # Calculate currents\n            i_leak = g_L * (v_for_calc - E_L)\n            i_gaba = g_gaba * s * (v_for_calc - e_cl)\n\n            # --- Calculate Derivatives (Explicit Euler) ---\n            # dV/dt\n            dv_dt = (I_app - i_leak - i_gaba) / C_m\n            \n            # ds/dt\n            s_inf = 1.0 if g_gaba > 0.0 else 0.0\n            ds_dt = (s_inf - s) / tau_eps\n\n            # d[Cl]i/dt\n            # Note: The problem states d[Cl]i/dt = -I_gaba / (z * F * V_i) ... with z = -1\n            # This is equivalent to d[Cl]i/dt = I_gaba / (F * V_i) ...\n            dcl_i_dt = (i_gaba / (F * V_i)) - k_kcc2 * (cl_i - Cl_i_eq)\n\n            # --- Update State Variables ---\n            # Update V with spiking/refractory logic\n            if is_spiking_now or (refractory_counter > 0):\n                v = V_reset\n            else:\n                v = v + dt * dv_dt\n            \n            # Update s and cl_i\n            s = s + dt * ds_dt\n            cl_i = cl_i + dt * dcl_i_dt\n\n            # Ensure chloride concentration is physically realistic\n            if cl_i < 0:\n                cl_i = 0.0\n\n        firing_rate = spike_count / T_sim\n        return round(firing_rate, 3)\n\n    # Test suite from the problem description\n    test_cases = [\n        # (I_app [pA], g_GABA [nS], k_KCC2 [s^-1])\n        (200, 0, 1.0),\n        (200, 5, 5.0),\n        (400, 12, 0.05),\n        (400, 20, 50.0),\n    ]\n\n    results = []\n    for case in test_cases:\n        rate = run_simulation(*case)\n        results.append(rate)\n\n    # Final print statement in the exact required format\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2712108"}]}