{"hands_on_practices": [{"introduction": "The retrograde action of endocannabinoids depends critically on their ability to travel from the postsynaptic to the presynaptic terminal. This journey is governed by fundamental physical laws of diffusion and chemical reaction (degradation). This exercise provides a foundational, hands-on opportunity to derive and solve the reaction-diffusion equation that describes how the concentration of 2-arachidonoylglycerol ($2$-AG) behaves in the synapse [@problem_id:2770084]. Mastering this model yields the steady-state concentration profile, representing the first step toward a quantitative understanding of endocannabinoid signaling range and duration.", "problem": "Two-arachidonoylglycerol ($2$-AG) is an endocannabinoid produced postsynaptically and capable of diffusing retrogradely to presynaptic cannabinoid receptors. Consider an effective one-dimensional extracellular half-space along the axis normal to the synaptic membrane, with coordinate $x \\ge 0$ where $x=0$ denotes the membrane surface at which $2$-AG is produced. Assume:\n- A constant areal production flux $J_{0}$ (molecules per unit area per unit time) of $2$-AG is injected into the extracellular space at $x=0$.\n- The diffusion coefficient of $2$-AG is spatially uniform and equal to $D$.\n- Bulk degradation of $2$-AG follows first-order kinetics with rate constant $k_{\\mathrm{deg}}$, uniform in space.\n- The system is invariant in directions tangential to the membrane, so that $C(x,t)$ depends only on $x$ and $t$.\n\nStarting from local conservation of mass and Fickâ€™s first law of diffusion, and taking into account a volumetric first-order sink due to degradation, derive the governing reaction-diffusion equation for the concentration $C(x,t)$ for $x>0$. Clearly state the physically appropriate boundary conditions at $x=0$ and as $x \\to \\infty$, using the convention that the positive $x$-direction points outward from the membrane.\n\nThen, solve for the steady-state concentration profile $C(x)$ on $x \\ge 0$ under these conditions. Provide your final answer as a closed-form symbolic expression in terms of $J_{0}$, $D$, $k_{\\mathrm{deg}}$, and $x$ only. Do not substitute numerical values and do not include units in the final expression.", "solution": "The problem as stated constitutes a well-posed, scientifically grounded exercise in biophysical modeling and is therefore deemed valid. We shall proceed with its formal derivation and solution.\n\nFirst, we derive the governing reaction-diffusion equation. We apply the principle of local conservation of mass to a one-dimensional control volume element of cross-sectional area $A$ extending from coordinate $x$ to $x + \\Delta x$. The total number of $2$-AG molecules within this volume $V = A \\Delta x$ is $N(t) = C(x,t) V = C(x,t) A \\Delta x$. The rate of change of the number of molecules in this volume is the sum of the net flux across its boundaries and the rate of loss due to degradation.\n\nThe mass balance equation is:\n$$ \\frac{dN}{dt} = (\\text{Flux in at } x) - (\\text{Flux out at } x + \\Delta x) - (\\text{Degradation rate}) $$\nIn terms of the molar flux $J(x,t)$ (molecules per unit area per unit time) and concentration $C(x,t)$, this is written as:\n$$ \\frac{\\partial}{\\partial t} (C(x,t) A \\Delta x) = J(x,t) A - J(x+\\Delta x, t) A - k_{\\mathrm{deg}} C(x,t) A \\Delta x $$\nDividing by the volume $A \\Delta x$ and rearranging gives:\n$$ \\frac{\\partial C(x,t)}{\\partial t} = - \\frac{J(x+\\Delta x, t) - J(x,t)}{\\Delta x} - k_{\\mathrm{deg}} C(x,t) $$\nTaking the limit as $\\Delta x \\to 0$, we obtain the one-dimensional continuity equation with a sink term:\n$$ \\frac{\\partial C(x,t)}{\\partial t} = - \\frac{\\partial J(x,t)}{\\partial x} - k_{\\mathrm{deg}} C(x,t) $$\nNext, we invoke Fick's first law of diffusion, which relates the flux to the concentration gradient:\n$$ J(x,t) = -D \\frac{\\partial C(x,t)}{\\partial x} $$\nwhere $D$ is the diffusion coefficient, assumed to be a constant. Substituting Fick's law into the continuity equation yields:\n$$ \\frac{\\partial C(x,t)}{\\partial t} = - \\frac{\\partial}{\\partial x} \\left(-D \\frac{\\partial C(x,t)}{\\partial x}\\right) - k_{\\mathrm{deg}} C(x,t) $$\nAs $D$ is spatially uniform, this simplifies to the governing reaction-diffusion equation for $C(x,t)$ in the domain $x > 0$:\n$$ \\frac{\\partial C(x,t)}{\\partial t} = D \\frac{\\partial^2 C(x,t)}{\\partial x^2} - k_{\\mathrm{deg}} C(x,t) $$\nThe boundary conditions are determined by the physical constraints of the system.\n$1$. At the membrane surface $x=0$, there is a constant production flux $J_{0}$ injected into the extracellular space. This source flux must equal the diffusive flux away from the membrane. The diffusive flux at $x=0$ is $J(0,t) = -D \\frac{\\partial C}{\\partial x}\\Big|_{x=0}$. Equating these gives the Neumann boundary condition:\n$$ -D \\frac{\\partial C}{\\partial x}\\Bigg|_{x=0} = J_{0} $$\n$2$. Far from the source, at $x \\to \\infty$, the concentration of the diffusing substance must vanish, as there is no source at infinity and molecules are continuously removed by degradation. This provides the second boundary condition:\n$$ \\lim_{x \\to \\infty} C(x,t) = 0 $$\nNow, we seek the steady-state concentration profile, $C(x)$. In steady state, the concentration does not change with time, thus $\\frac{\\partial C}{\\partial t} = 0$. The partial differential equation reduces to a second-order, linear, homogeneous ordinary differential equation (ODE):\n$$ D \\frac{d^2 C(x)}{dx^2} - k_{\\mathrm{deg}} C(x) = 0 $$\nThis can be rewritten as:\n$$ \\frac{d^2 C}{dx^2} - \\frac{k_{\\mathrm{deg}}}{D} C = 0 $$\nThe characteristic equation is $r^2 - \\frac{k_{\\mathrm{deg}}}{D} = 0$, with roots $r = \\pm \\sqrt{\\frac{k_{\\mathrm{deg}}}{D}}$. The general solution is therefore:\n$$ C(x) = A_{1} \\exp\\left(x\\sqrt{\\frac{k_{\\mathrm{deg}}}{D}}\\right) + A_{2} \\exp\\left(-x\\sqrt{\\frac{k_{\\mathrm{deg}}}{D}}\\right) $$\nwhere $A_{1}$ and $A_{2}$ are integration constants to be determined by the boundary conditions.\n\nApplying the boundary condition at infinity, $\\lim_{x \\to \\infty} C(x) = 0$:\nThe term $A_{1} \\exp\\left(x\\sqrt{\\frac{k_{\\mathrm{deg}}}{D}}\\right)$ grows without bound as $x \\to \\infty$. To satisfy the condition, its coefficient must be zero, so $A_{1}=0$. The solution simplifies to:\n$$ C(x) = A_{2} \\exp\\left(-x\\sqrt{\\frac{k_{\\mathrm{deg}}}{D}}\\right) $$\nNow, we apply the flux boundary condition at $x=0$:\n$$ -D \\frac{dC}{dx}\\Bigg|_{x=0} = J_{0} $$\nFirst, we compute the derivative of $C(x)$:\n$$ \\frac{dC}{dx} = -A_{2} \\sqrt{\\frac{k_{\\mathrm{deg}}}{D}} \\exp\\left(-x\\sqrt{\\frac{k_{\\mathrm{deg}}}{D}}\\right) $$\nEvaluating this derivative at $x=0$:\n$$ \\frac{dC}{dx}\\Bigg|_{x=0} = -A_{2} \\sqrt{\\frac{k_{\\mathrm{deg}}}{D}} $$\nSubstituting this into the boundary condition equation:\n$$ -D \\left(-A_{2} \\sqrt{\\frac{k_{\\mathrm{deg}}}{D}}\\right) = J_{0} $$\n$$ A_{2} D \\sqrt{\\frac{k_{\\mathrm{deg}}}{D}} = J_{0} $$\n$$ A_{2} \\sqrt{D^2 \\frac{k_{\\mathrm{deg}}}{D}} = J_{0} $$\n$$ A_{2} \\sqrt{D k_{\\mathrm{deg}}} = J_{0} $$\nSolving for the constant $A_{2}$:\n$$ A_{2} = \\frac{J_{0}}{\\sqrt{D k_{\\mathrm{deg}}}} $$\nFinally, we substitute the value of $A_{2}$ back into the expression for $C(x)$ to obtain the steady-state concentration profile:\n$$ C(x) = \\frac{J_{0}}{\\sqrt{D k_{\\mathrm{deg}}}} \\exp\\left(-x\\sqrt{\\frac{k_{\\mathrm{deg}}}{D}}\\right) $$\nThis expression provides the concentration of $2$-AG as a function of distance from the membrane, governed by the production flux, diffusion coefficient, and degradation rate, as required.", "answer": "$$\n\\boxed{\\frac{J_{0}}{\\sqrt{D k_{\\mathrm{deg}}}} \\exp\\left(-x\\sqrt{\\frac{k_{\\mathrm{deg}}}{D}}\\right)}\n$$", "id": "2770084"}, {"introduction": "Once an endocannabinoid reaches its presynaptic target, how do we experimentally determine its mechanism of action? This practice tackles a central question in synaptic physiology: distinguishing between presynaptic modulation (affecting neurotransmitter release probability) and postsynaptic modulation (affecting receptor sensitivity). By analyzing summary statistics from a hypothetical miniature Excitatory Postsynaptic Current (mEPSC) recording, you will use maximum likelihood estimation to quantitatively compare the evidence for these two competing hypotheses [@problem_id:2770153]. This exercise builds crucial skills in statistical inference and data-driven hypothesis testing, forming a bridge between biophysical theory and experimental data analysis.", "problem": "A dentate granule cell is voltage clamped at a holding potential where miniature excitatory postsynaptic currents (mEPSCs) are inward and well isolated. Endocannabinoid signaling is recruited postsynaptically and activates presynaptic Cannabinoid receptor type 1 (CB1) by a depolarization-induced mechanism that elevates intracellular calcium. You collect continuous recordings in two non-overlapping conditions of equal duration: baseline and during sustained CB1 receptor activation. You seek to infer whether the change induced by CB1 activation primarily reflects presynaptic release rate modulation or postsynaptic receptor effects.\n\nAssume the following modeling framework grounded in standard synaptic physiology:\n- Spontaneous synaptic events are generated by a Poisson point process with rate parameter $\\lambda$ over a recording window of duration $T$, independent of event amplitudes.\n- Event amplitudes $A$ (in picoamperes, $\\mathrm{pA}$) are independent and identically distributed and follow a lognormal distribution. Equivalently, $X = \\ln A$ is normally distributed with mean $\\mu$ and known variance $\\sigma^{2}$.\n- Under the presynaptic hypothesis $\\mathcal{P}$, CB1 activation alters the release rate but not the quantal size distribution: $\\lambda$ may differ between baseline and CB1 activation while $\\mu$ is the same across conditions.\n- Under the postsynaptic hypothesis $\\mathcal{S}$, CB1 activation alters the quantal size distribution but not the release rate: $\\mu$ may differ between baseline and CB1 activation while $\\lambda$ is the same across conditions.\n- Given counts and amplitudes, the joint likelihood factorizes as the product of the Poisson likelihood for counts and the normal likelihood for the log-amplitudes.\n\nData summary:\n- Baseline recording duration $T_{b} = 300\\,\\mathrm{s}$ with event count $N_{b} = 900$ and sample mean of log-amplitudes $\\bar{x}_{b} = 2.708$.\n- CB1 activation recording duration $T_{c} = 300\\,\\mathrm{s}$ with event count $N_{c} = 360$ and sample mean of log-amplitudes $\\bar{x}_{c} = 2.700$.\n- The log-amplitude variance is known and equal across conditions: $\\sigma^{2} = 0.04$.\n\nUsing maximum likelihood estimation within each hypothesis, compute the log-likelihood ratio\n$$\n\\ln\\!\\left(\\frac{L_{\\mathcal{P}}}{L_{\\mathcal{S}}}\\right),\n$$\nwhere $L_{\\mathcal{P}}$ and $L_{\\mathcal{S}}$ are the maximized joint likelihoods under the presynaptic and postsynaptic hypotheses, respectively. Use the natural logarithm so that the result is in nats. Round your answer to four significant figures. The final answer must be a single real number with no units in the answer box.", "solution": "The problem requires the computation of the log-likelihood ratio between a presynaptic and a postsynaptic hypothesis for synaptic modulation. First, the problem statement must be validated.\n\n**Problem Validation**\n\nThe givens are extracted verbatim:\n- **Baseline:** Recording duration $T_{b} = 300\\,\\mathrm{s}$, event count $N_{b} = 900$, sample mean of log-amplitudes $\\bar{x}_{b} = 2.708$.\n- **CB1 Activation:** Recording duration $T_{c} = 300\\,\\mathrm{s}$, event count $N_{c} = 360$, sample mean of log-amplitudes $\\bar{x}_{c} = 2.700$.\n- **Shared Parameters:** Log-amplitude variance $\\sigma^{2} = 0.04$.\n- **Model:** Events follow a Poisson process with rate $\\lambda$. Log-amplitudes $X = \\ln A$ are normally distributed with mean $\\mu$ and variance $\\sigma^2$.\n- **Hypothesis $\\mathcal{P}$ (presynaptic):** $\\lambda$ differs between conditions, $\\mu$ is constant.\n- **Hypothesis $\\mathcal{S}$ (postsynaptic):** $\\lambda$ is constant, $\\mu$ differs between conditions.\n- **Task:** Compute $\\ln(L_{\\mathcal{P}}/L_{\\mathcal{S}})$, where $L$ denotes the maximized likelihood.\n\nThe problem is scientifically grounded, modeling synaptic events with standard statistical processes (Poisson and Lognormal distributions). It is a well-posed statistical inference problem with sufficient data for a unique solution. The language is objective and precise. The data are physically plausible for such an experiment. The problem does not violate any validation criteria. It is deemed **valid**.\n\n**Derivation of Solution**\n\nThe objective is to compute the log-likelihood ratio, $\\ln\\left(\\frac{L_{\\mathcal{P}}}{L_{\\mathcal{S}}}\\right) = \\ln L_{\\mathcal{P}} - \\ln L_{\\mathcal{S}}$. The joint likelihood is the product of likelihoods for the two conditions, baseline ($b$) and CB1 ($c$). For each condition $k \\in \\{b, c\\}$, the likelihood is the product of the Poisson likelihood for the count $N_k$ and the Normal likelihood for the $N_k$ log-amplitudes $\\{x_{k,i}\\}$.\n\nThe total log-likelihood function is:\n$$ \\ln L = \\sum_{k \\in \\{b,c\\}} \\left[ \\ln\\left(\\frac{(\\lambda_k T_k)^{N_k} \\exp(-\\lambda_k T_k)}{N_k!}\\right) + \\sum_{i=1}^{N_k} \\ln\\left(\\frac{1}{\\sqrt{2\\pi\\sigma^2}} \\exp\\left(-\\frac{(x_{k,i} - \\mu_k)^2}{2\\sigma^2}\\right)\\right) \\right] $$\nThis can be separated into variable parts that depend on the parameters $(\\lambda_k, \\mu_k)$ and constant parts.\n$$ \\ln L(\\lambda_b, \\mu_b, \\lambda_c, \\mu_c) = \\sum_{k \\in \\{b,c\\}} \\left[ N_k \\ln \\lambda_k - \\lambda_k T_k - \\frac{N_k(\\bar{x}_k - \\mu_k)^2}{2\\sigma^2} \\right] + C $$\nThe constant $C$ contains all terms not dependent on $\\lambda_k$ or $\\mu_k$, such as $\\ln(T_k)$, $\\ln(N_k!)$, and sums of squares $\\sum (x_{k,i}-\\bar{x}_k)^2$. Since $C$ is identical for both hypotheses, it will cancel in the log-likelihood ratio. We need only consider the variable parts.\n\n**Hypothesis $\\mathcal{P}$: Presynaptic Modulation**\nUnder $\\mathcal{P}$, the parameters are $(\\lambda_b, \\lambda_c, \\mu_{\\mathcal{P}})$ where $\\mu_b=\\mu_c=\\mu_{\\mathcal{P}}$. The log-likelihood to maximize is:\n$$ \\ln L_{\\mathcal{P}} = (N_b \\ln \\lambda_b - \\lambda_b T_b) + (N_c \\ln \\lambda_c - \\lambda_c T_c) - \\frac{N_b(\\bar{x}_b - \\mu_{\\mathcal{P}})^2}{2\\sigma^2} - \\frac{N_c(\\bar{x}_c - \\mu_{\\mathcal{P}})^2}{2\\sigma^2} + C $$\nThe maximum likelihood estimators (MLEs) for the parameters are:\n$$ \\hat{\\lambda}_b = \\frac{N_b}{T_b}, \\quad \\hat{\\lambda}_c = \\frac{N_c}{T_c}, \\quad \\hat{\\mu}_{\\mathcal{P}} = \\frac{N_b \\bar{x}_b + N_c \\bar{x}_c}{N_b + N_c} $$\nSubstituting the MLEs into the variable part of $\\ln L_{\\mathcal{P}}$ gives the maximized log-likelihood, $\\ln L_{\\mathcal{P}}$:\n$$ \\ln L_{\\mathcal{P}} = \\left(N_b \\ln \\frac{N_b}{T_b} - N_b\\right) + \\left(N_c \\ln \\frac{N_c}{T_c} - N_c\\right) - \\frac{1}{2\\sigma^2}\\left[N_b(\\bar{x}_b - \\hat{\\mu}_{\\mathcal{P}})^2 + N_c(\\bar{x}_c - \\hat{\\mu}_{\\mathcal{P}})^2\\right] + C $$\nThe sum of squares term simplifies to $\\frac{N_b N_c}{N_b+N_c}(\\bar{x}_b-\\bar{x}_c)^2$.\n\n**Hypothesis $\\mathcal{S}$: Postsynaptic Modulation**\nUnder $\\mathcal{S}$, the parameters are $(\\lambda_{\\mathcal{S}}, \\mu_b, \\mu_c)$ where $\\lambda_b=\\lambda_c=\\lambda_{\\mathcal{S}}$. The log-likelihood to maximize is:\n$$ \\ln L_{\\mathcal{S}} = (N_b + N_c)\\ln \\lambda_{\\mathcal{S}} - \\lambda_{\\mathcal{S}}(T_b + T_c) - \\frac{N_b(\\bar{x}_b - \\mu_b)^2}{2\\sigma^2} - \\frac{N_c(\\bar{x}_c - \\mu_c)^2}{2\\sigma^2} + C $$\nThe MLEs are:\n$$ \\hat{\\lambda}_{\\mathcal{S}} = \\frac{N_b + N_c}{T_b + T_c}, \\quad \\hat{\\mu}_b = \\bar{x}_b, \\quad \\hat{\\mu}_c = \\bar{x}_c $$\nSubstituting these MLEs, the maximized log-likelihood $\\ln L_{\\mathcal{S}}$ is:\n$$ \\ln L_{\\mathcal{S}} = \\left((N_b+N_c) \\ln\\left(\\frac{N_b+N_c}{T_b+T_c}\\right) - (N_b+N_c)\\right) - \\frac{N_b(\\bar{x}_b - \\bar{x}_b)^2}{2\\sigma^2} - \\frac{N_c(\\bar{x}_c - \\bar{x}_c)^2}{2\\sigma^2} + C $$\n$$ \\ln L_{\\mathcal{S}} = \\left((N_b+N_c) \\ln \\hat{\\lambda}_{\\mathcal{S}} - (N_b+N_c)\\right) + C $$\n\n**Log-Likelihood Ratio**\nThe log-likelihood ratio is $\\ln L_{\\mathcal{P}} - \\ln L_{\\mathcal{S}}$. The constant $C$ cancels. The calculation separates into a Poisson part and a Normal part.\n$\\ln\\left(\\frac{L_{\\mathcal{P}}}{L_{\\mathcal{S}}}\\right) = \\Delta \\ell_{\\text{Poi}} + \\Delta \\ell_{\\text{Norm}}$.\n\nThe Poisson component is:\n$$ \\Delta \\ell_{\\text{Poi}} = (N_b \\ln \\hat{\\lambda}_b - N_b) + (N_c \\ln \\hat{\\lambda}_c - N_c) - \\left( (N_b+N_c) \\ln \\hat{\\lambda}_{\\mathcal{S}} - (N_b+N_c) \\right) $$\n$$ \\Delta \\ell_{\\text{Poi}} = N_b \\ln \\hat{\\lambda}_b + N_c \\ln \\hat{\\lambda}_c - (N_b+N_c) \\ln \\hat{\\lambda}_{\\mathcal{S}} $$\nThe Normal component is:\n$$ \\Delta \\ell_{\\text{Norm}} = -\\frac{1}{2\\sigma^2} \\frac{N_b N_c}{N_b+N_c}(\\bar{x}_b-\\bar{x}_c)^2 - 0 = -\\frac{N_b N_c}{2\\sigma^2(N_b+N_c)}(\\bar{x}_b-\\bar{x}_c)^2 $$\n\n**Numerical Calculation**\nFirst, calculate the MLEs of the rates:\n$T_b=T_c=300\\,\\mathrm{s}$.\n$\\hat{\\lambda}_b = N_b/T_b = 900/300 = 3$.\n$\\hat{\\lambda}_c = N_c/T_c = 360/300 = 1.2$.\n$\\hat{\\lambda}_{\\mathcal{S}} = (N_b+N_c)/(T_b+T_c) = (900+360)/(300+300) = 1260/600 = 2.1$.\n\nNow, compute the two components of the log-likelihood ratio:\n$$ \\Delta \\ell_{\\text{Poi}} = 900 \\ln(3) + 360 \\ln(1.2) - 1260 \\ln(2.1) $$\n$$ \\Delta \\ell_{\\text{Poi}} \\approx 900(1.09861) + 360(0.18232) - 1260(0.74194) $$\n$$ \\Delta \\ell_{\\text{Poi}} \\approx 988.751 + 65.636 - 934.841 \\approx 119.546 $$\n\n$$ \\Delta \\ell_{\\text{Norm}} = -\\frac{900 \\times 360}{2(0.04)(900+360)}(2.708-2.700)^2 $$\n$$ \\Delta \\ell_{\\text{Norm}} = -\\frac{324000}{0.08 \\times 1260}(0.008)^2 = -\\frac{324000}{100.8}(0.000064) $$\n$$ \\Delta \\ell_{\\text{Norm}} = -\\frac{1}{0.08} \\left(\\frac{1800}{7}\\right) (0.000064) = -12.5 \\left(\\frac{0.1152}{7}\\right) = -\\frac{1.44}{7} \\approx -0.205714 $$\n\nFinally, sum the components:\n$$ \\ln\\left(\\frac{L_{\\mathcal{P}}}{L_{\\mathcal{S}}}\\right) = \\Delta \\ell_{\\text{Poi}} + \\Delta \\ell_{\\text{Norm}} \\approx 119.546 - 0.205714 = 119.340286 $$\nRounding to four significant figures gives $119.3$.\nThe large positive value indicates substantial evidence in favor of the presynaptic hypothesis $\\mathcal{P}$ over the postsynaptic hypothesis $\\mathcal{S}$, which is consistent with the pronounced change in event frequency and minimal change in amplitude observed in the data.", "answer": "$$ \\boxed{119.3} $$", "id": "2770153"}, {"introduction": "Real biological systems are inherently noisy and heterogeneous. How does variability at the single-spine level propagate to create diverse functional outcomes across a neuron? This computational practice guides you through building a simulation to explore this very question [@problem_id:2770032]. You will model how spine-to-spine differences in $2$-AG production, drawn from a log-normal distribution, translate into heterogeneous Depolarization-induced Suppression of Excitation (DSE). This exercise provides practical experience in using computational modeling to link molecular stochasticity to physiological function, a cornerstone of modern quantitative neuroscience.", "problem": "You are tasked with building a minimal yet biophysically grounded simulation to quantify how variability in 2-arachidonoylglycerol (2-AG) production across dendritic spines contributes to heterogeneity in depolarization-induced suppression of excitation (DSE) within a neuron. The simulation must be designed entirely in mathematical and algorithmic terms and produce a single-line output specified below.\n\nAssumptions and scientific base:\n- Dendritic spines are independent sources of 2-AG following a postsynaptic depolarization at time $t=0$.\n- For spine $i$, the peak 2-AG concentration immediately after depolarization is $A_i$ in micromolar, where $A_i$ varies across spines due to biochemical variability.\n- 2-AG degradation is governed by first-order kinetics, so the concentration decays exponentially with a time constant $\\tau$ (in seconds).\n- Cannabinoid receptor type $1$ (CB1) activation follows the law of mass action with a Hill coefficient of $1$, using dissociation constant $K_d$ (in micromolar), equivalent to the half-maximal effective concentration.\n- DSE magnitude at a synapse is proportional to CB1 occupancy with proportionality constant $S_{\\max}$ (dimensionless, between $0$ and $1$), and heterogeneity of DSE refers to variability across spines in the time-averaged suppression.\n\nDefinitions to implement:\n- For each spine $i$, set the 2-AG concentration time course as $C_i(t) = A_i \\exp(-t/\\tau)$ (micromolar), $t \\ge 0$.\n- CB1 occupancy is $\\theta_i(t) = \\dfrac{C_i(t)}{K_d + C_i(t)}$.\n- The instantaneous suppression fraction is $S_i(t) = S_{\\max} \\, \\theta_i(t)$.\n- Define the DSE magnitude for spine $i$ over a measurement window $[t_1, t_2)$ as the time-average $H_i = \\dfrac{1}{n} \\sum_{k=0}^{n-1} S_i(t_k)$ using a uniform grid with step $\\Delta t$, where $t_k = t_1 + k \\, \\Delta t$ and $n = \\left\\lfloor \\dfrac{t_2 - t_1}{\\Delta t} \\right\\rfloor$.\n- Define the heterogeneity metric across spines as the coefficient of variation $CV = \\dfrac{\\sigma_H}{\\mu_H}$ where $\\mu_H$ and $\\sigma_H$ are the mean and standard deviation of $\\{H_i\\}$ across spines.\n\nStochastic model for 2-AG amplitudes:\n- Model the across-spine variability of peak 2-AG amplitudes by $A_i \\sim \\text{LogNormal}(\\mu, \\sigma)$, where $\\mu$ and $\\sigma$ are the mean and standard deviation of the underlying normal distribution (base $e$). All $A_i$ are in micromolar.\n- Use a fixed number of spines $N = 10000$ for all test cases.\n- Use a fixed random seed $2025$ so results are reproducible.\n\nComputation and units:\n- Time must be in seconds.\n- Concentrations must be in micromolar.\n- The final reported $CV$ values are dimensionless and must be printed as decimal floats rounded to six digits after the decimal point.\n\nTest suite:\nFor each of the following parameter sets $(\\mu, \\sigma, \\tau, K_d, S_{\\max}, t_1, t_2, \\Delta t)$, simulate $N = 10000$ spines using the same seed $2025$ and compute the $CV$ of $H_i$.\n\n- Test $1$ (happy path, moderate variability in a mid-regime):\n  - $\\mu = \\ln(0.5)$, $\\sigma = 0.5$, $\\tau = 0.3$, $K_d = 0.5$, $S_{\\max} = 0.6$, $t_1 = 0.1$, $t_2 = 0.5$, $\\Delta t = 0.001$.\n- Test $2$ (boundary, zero variability in $A_i$):\n  - $\\mu = \\ln(0.5)$, $\\sigma = 0.0$, $\\tau = 0.3$, $K_d = 0.5$, $S_{\\max} = 0.6$, $t_1 = 0.1$, $t_2 = 0.5$, $\\Delta t = 0.001$.\n- Test $3$ (subthreshold regime, linear range approximation):\n  - $\\mu = \\ln(0.05)$, $\\sigma = 0.5$, $\\tau = 0.3$, $K_d = 0.5$, $S_{\\max} = 0.6$, $t_1 = 0.1$, $t_2 = 0.5$, $\\Delta t = 0.001$.\n- Test $4$ (saturating regime, high $A_i$ relative to $K_d$):\n  - $\\mu = \\ln(5.0)$, $\\sigma = 0.5$, $\\tau = 0.3$, $K_d = 0.5$, $S_{\\max} = 0.6$, $t_1 = 0.1$, $t_2 = 0.5$, $\\Delta t = 0.001$.\n- Test $5$ (fast degradation and late measurement window):\n  - $\\mu = \\ln(0.5)$, $\\sigma = 0.5$, $\\tau = 0.05$, $K_d = 0.5$, $S_{\\max} = 0.6$, $t_1 = 0.2$, $t_2 = 0.5$, $\\Delta t = 0.001$.\n\nRequired final output format:\n- Your program should produce a single line of output containing the five $CV$ results corresponding to the tests above, as a comma-separated list enclosed in square brackets, with each value rounded to six digits after the decimal point (for example, $[0.123456,0.000000,0.543210,0.111111,0.222222]$).", "solution": "The problem statement has been subjected to rigorous validation and is deemed valid. It is scientifically grounded in established biophysical principles, mathematically well-posed, and provides a complete and unambiguous set of instructions for a computational simulation. There are no contradictions, no pseudo-scientific claims, and all parameters fall within plausible biological ranges. We shall therefore proceed with a complete solution.\n\nThe task is to compute a measure of heterogeneity, the coefficient of variation ($CV$), for the time-averaged depolarization-induced suppression of excitation ($DSE$) across a population of dendritic spines. The variability originates from the peak concentration of the endocannabinoid $2$-arachidonoylglycerol ($2$-AG), denoted $A_i$ for spine $i$, which is modeled as a random variable.\n\nFirst, we formalize the sequence of calculations for a single spine $i$. The peak $2$-AG concentration, $A_i$, is drawn from a log-normal distribution, $A_i \\sim \\text{LogNormal}(\\mu, \\sigma)$, where $\\mu$ and $\\sigma$ are the mean and standard deviation of the associated normal distribution. The concentration of $2$-AG at time $t$ post-depolarization is governed by first-order decay kinetics:\n$$C_i(t) = A_i \\exp(-t/\\tau)$$\nwhere $\\tau$ is the degradation time constant.\n\nThe activation of cannabinoid type-$1$ ($CB1$) receptors is modeled by the law of mass action, yielding the receptor occupancy $\\theta_i(t)$. With a Hill coefficient of $1$, this is equivalent to Michaelis-Menten kinetics:\n$$\\theta_i(t) = \\frac{C_i(t)}{K_d + C_i(t)}$$\nwhere $K_d$ is the dissociation constant.\n\nThe instantaneous magnitude of DSE, denoted $S_i(t)$, is assumed to be directly proportional to the receptor occupancy, with a maximal suppression factor $S_{\\max}$:\n$$S_i(t) = S_{\\max} \\cdot \\theta_i(t) = S_{\\max} \\frac{A_i e^{-t/\\tau}}{K_d + A_i e^{-t/\\tau}}$$\n\nThe problem defines the overall DSE effect for spine $i$, $H_i$, as the time-average of $S_i(t)$ over a discrete set of time points $t_k$ within the interval $[t_1, t_2)$. The time points are defined as $t_k = t_1 + k \\Delta t$ for $k = 0, 1, \\dots, n-1$, where $n = \\lfloor (t_2 - t_1) / \\Delta t \\rfloor$. The mean suppression is therefore:\n$$H_i = \\frac{1}{n} \\sum_{k=0}^{n-1} S_i(t_k)$$\n\nThe primary objective is to quantify the heterogeneity of $\\{H_i\\}$ across a population of $N=10000$ spines. This is measured by the coefficient of variation, $CV$:\n$$CV = \\frac{\\sigma_H}{\\mu_H}$$\nwhere $\\mu_H = \\frac{1}{N}\\sum_{i=1}^{N} H_i$ is the population mean and $\\sigma_H = \\sqrt{\\frac{1}{N}\\sum_{i=1}^{N} (H_i - \\mu_H)^2}$ is the population standard deviation of the set $\\{H_i\\}$.\n\nTo implement this model computationally, a vectorized approach is superior for efficiency. The algorithm for each test case is as follows:\n$1$. Initialize a random number generator with the specified seed, $2025$, to ensure reproducibility.\n$2$. Generate a vector of $N=10000$ random values for the peak concentrations $\\{A_i\\}$ from the $\\text{LogNormal}(\\mu, \\sigma)$ distribution. This is an array of shape $(N, 1)$.\n$3$. Construct a time vector $\\{t_k\\}$ representing the measurement window $[t_1, t_2)$ with step $\\Delta t$. This is an array of shape $(1, n)$.\n$4$. Employing NumPy's broadcasting capabilities, compute the concentration matrix $C_{ik} = C_i(t_k)$ of shape $(N, n)$.\n$5$. From $C_{ik}$, compute the instantaneous suppression matrix $S_{ik} = S_i(t_k)$, also of shape $(N, n)$.\n$6$. Calculate the vector of time-averaged suppressions $\\{H_i\\}$ by taking the mean of the matrix $S_{ik}$ along its time axis (axis $1$). The resulting vector has shape $(N,)$.\n$7$. Compute the mean $\\mu_H$ and standard deviation $\\sigma_H$ of the vector $\\{H_i\\}$.\n$8$. Calculate the coefficient of variation $CV = \\sigma_H / \\mu_H$. A check for $\\mu_H = 0$ is included as a formality, although not expected in these test cases. In the specific case where the input variability $\\sigma=0$, all $A_i$ are identical, leading to identical $H_i$, so $\\sigma_H=0$ and thus $CV=0$, which serves as a necessary sanity check (Test $2$).\n$9$. The final $CV$ value is rounded to six decimal places as required.\n\nThis procedure is repeated for each of the five parameter sets provided in the test suite. The test cases are designed to probe the system's behavior in different regimes: a baseline (Test $1$), a deterministic control (Test $2$), a sub-saturation or 'linear' regime where $A_i \\ll K_d$ (Test $3$), a saturating regime where $A_i \\gg K_d$ (Test $4$), and a case with altered kinetics and measurement window (Test $5$). The nonlinearity of the receptor binding step, $S_i(t)$, is expected to transform the initial variability in $A_i$ in a non-trivial manner, which these tests will quantify.", "answer": "[0.285810,0.000000,0.532398,0.059437,0.532450]", "id": "2770032"}]}