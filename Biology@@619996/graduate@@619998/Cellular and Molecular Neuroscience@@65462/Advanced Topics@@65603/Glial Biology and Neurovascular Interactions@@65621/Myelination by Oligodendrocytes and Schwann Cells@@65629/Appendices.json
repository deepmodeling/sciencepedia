{"hands_on_practices": [{"introduction": "We begin by exploring the fundamental 'why' of myelination and the dramatic efficiency it confers upon neural circuits. By applying basic scaling laws derived from cable theory, you will quantify the remarkable difference in conduction velocity between myelinated and unmyelinated axons. This exercise highlights the profound impact of myelination on nervous system design and function [@problem_id:2732646].", "problem": "In cellular and molecular neuroscience, the scaling of action potential conduction velocity with axon diameter arises from core cable theory and the geometry of saltatory conduction. Consider a cylindrical axon of diameter $d$ and radius $a=d/2$, with intracellular specific resistivity $\\rho_{i}$, membrane specific resistance $R_{m}$, and membrane specific capacitance $C_{m}$. For unmyelinated axons, the axial resistance per unit length and membrane parameters are determined by these specific properties and the cylinder geometry. For myelinated axons, conduction is saltatory between nodes of Ranvier, with internodal length set by developmental programs that couple internode spacing to axon caliber.\n\nStarting from the following well-tested bases:\n- The axial resistance per unit length is $r_{i}'=\\rho_{i}/(\\pi a^{2})$.\n- The membrane resistance per unit length is $r_{m}'=R_{m}/(2\\pi a)$, and the membrane capacitance per unit length is $c_{m}'=2\\pi a\\,C_{m}$.\n- The space constant is $\\lambda=\\sqrt{r_{m}'/r_{i}'}$ and the membrane time constant is $\\tau=R_{m}C_{m}$ for unmyelinated axons with uniform membrane properties.\n- In myelinated axons, conduction between nodes can be idealized as saltatory steps over internode length $L$, with an approximately diameter-independent nodal charging time $t_{n}$, while $L$ scales with diameter through developmental patterning, $L=\\alpha d$ for some constant $\\alpha$.\n\nUse these bases to argue the scaling of conduction velocity with $d$ for both unmyelinated and myelinated axons. Then, to place both cases on a common quantitative footing without invoking additional biophysical constants, fix a reference diameter $d_{\\mathrm{ref}}=1\\,\\mu\\mathrm{m}$ and define a single normalization constant $k$ with units of meters per second such that the conduction velocities can be written as\n- $v_{\\mathrm{unmy}}(d)=k\\,\\sqrt{d/d_{\\mathrm{ref}}}$ for unmyelinated axons, and\n- $v_{\\mathrm{my}}(d)=k\\,\\big(d/d_{\\mathrm{ref}}\\big)$ for myelinated axons,\n\nwhere the normalization reflects the same underlying biophysical milieu and measurement conditions. A myelinated axon with diameter $d=2\\,\\mu\\mathrm{m}$ is observed to conduct at $v=20\\,\\mathrm{m/s}$.\n\nUnder these assumptions, calculate the diameter $d_{\\mathrm{unmy}}$ (in micrometers) that an unmyelinated axon would need in order to achieve the same conduction velocity of $20\\,\\mathrm{m/s}$. Express your final answer as a single number in micrometers. No rounding is necessary.", "solution": "The problem as stated is scientifically grounded, well-posed, and contains sufficient information for a unique solution. We begin by justifying the scaling relationships provided.\n\nFirst, consider the unmyelinated axon. The conduction velocity $v$ scales with the space constant $\\lambda$ and inversely with the membrane time constant $\\tau$. From the given definitions:\nThe space constant is $\\lambda = \\sqrt{r_{m}'/r_{i}'}$. Substituting the expressions for resistance per unit length:\n$$ \\lambda = \\sqrt{\\frac{R_{m}/(2\\pi a)}{\\rho_{i}/(\\pi a^{2})}} = \\sqrt{\\frac{R_{m} \\pi a^{2}}{2\\pi a \\rho_{i}}} = \\sqrt{\\frac{R_{m} a}{2\\rho_{i}}} $$\nSince the axon radius $a$ is half the diameter $d$, $a = d/2$, we have:\n$$ \\lambda = \\sqrt{\\frac{R_{m} (d/2)}{2\\rho_{i}}} = \\sqrt{\\frac{R_{m} d}{4\\rho_{i}}} = \\left(\\frac{1}{2}\\sqrt{\\frac{R_m}{\\rho_i}}\\right) \\sqrt{d} $$\nThe membrane time constant is $\\tau = R_{m}C_{m}$. This quantity depends only on the specific membrane properties and is independent of the axon's geometry, i.e., its diameter $d$.\nConduction velocity in a continuous cable is proportional to $\\lambda/\\tau$. Given that $\\tau$ is constant with respect to diameter and $\\lambda \\propto \\sqrt{d}$, it follows that the conduction velocity $v_{\\mathrm{unmy}}$ scales with the square root of the diameter:\n$$ v_{\\mathrm{unmy}}(d) \\propto \\sqrt{d} $$\nThis justifies the provided functional form $v_{\\mathrm{unmy}}(d)=k\\,\\sqrt{d/d_{\\mathrm{ref}}}$.\n\nNext, consider the myelinated axon. Conduction is saltatory, with the action potential \"jumping\" between nodes of Ranvier. The velocity is approximately the internode length $L$ divided by the time required to excite the subsequent node. This time is primarily determined by the nodal charging time, $t_{n}$, which is given as being approximately independent of diameter. The internode length $L$ is stated to scale linearly with diameter, $L = \\alpha d$.\nTherefore, the conduction velocity $v_{\\mathrm{my}}$ is:\n$$ v_{\\mathrm{my}}(d) \\approx \\frac{L}{t_{n}} = \\frac{\\alpha d}{t_{n}} = \\left(\\frac{\\alpha}{t_{n}}\\right) d $$\nSince $\\alpha$ and $t_{n}$ are treated as constants, the velocity scales linearly with diameter:\n$$ v_{\\mathrm{my}}(d) \\propto d $$\nThis justifies the provided functional form $v_{\\mathrm{my}}(d)=k\\,\\big(d/d_{\\mathrm{ref}}\\big)$.\n\nThe problem now reduces to a quantitative calculation using the provided formulas and data. The two velocity equations are:\n1. $v_{\\mathrm{unmy}}(d) = k \\sqrt{d/d_{\\mathrm{ref}}}$\n2. $v_{\\mathrm{my}}(d) = k (d/d_{\\mathrm{ref}})$\n\nWe are given that a myelinated axon with diameter $d = 2\\,\\mu\\mathrm{m}$ has a conduction velocity $v = 20\\,\\mathrm{m/s}$. The reference diameter is $d_{\\mathrm{ref}} = 1\\,\\mu\\mathrm{m}$. We use this information to determine the normalization constant $k$.\nUsing the equation for myelinated axons:\n$$ v_{\\mathrm{my}}(d = 2\\,\\mu\\mathrm{m}) = k \\left(\\frac{2\\,\\mu\\mathrm{m}}{1\\,\\mu\\mathrm{m}}\\right) $$\n$$ 20\\,\\mathrm{m/s} = k \\cdot 2 $$\nSolving for $k$:\n$$ k = \\frac{20}{2}\\,\\mathrm{m/s} = 10\\,\\mathrm{m/s} $$\n\nNow, we must find the diameter $d_{\\mathrm{unmy}}$ that an unmyelinated axon must have to achieve the same conduction velocity of $20\\,\\mathrm{m/s}$. We use the equation for unmyelinated axons with the now-known value of $k$:\n$$ v_{\\mathrm{unmy}}(d_{\\mathrm{unmy}}) = k \\sqrt{\\frac{d_{\\mathrm{unmy}}}{d_{\\mathrm{ref}}}} $$\nWe set $v_{\\mathrm{unmy}} = 20\\,\\mathrm{m/s}$, $k = 10\\,\\mathrm{m/s}$, and $d_{\\mathrm{ref}} = 1\\,\\mu\\mathrm{m}$:\n$$ 20\\,\\mathrm{m/s} = (10\\,\\mathrm{m/s}) \\sqrt{\\frac{d_{\\mathrm{unmy}}}{1\\,\\mu\\mathrm{m}}} $$\nDivide both sides by $10\\,\\mathrm{m/s}$:\n$$ 2 = \\sqrt{\\frac{d_{\\mathrm{unmy}}}{1\\,\\mu\\mathrm{m}}} $$\nTo solve for $d_{\\mathrm{unmy}}$, we square both sides of the equation:\n$$ 2^{2} = \\left(\\sqrt{\\frac{d_{\\mathrm{unmy}}}{1\\,\\mu\\mathrm{m}}}\\right)^{2} $$\n$$ 4 = \\frac{d_{\\mathrm{unmy}}}{1\\,\\mu\\mathrm{m}} $$\nTherefore, the required diameter is:\n$$ d_{\\mathrm{unmy}} = 4\\,\\mu\\mathrm{m} $$\nThe question requests the answer in micrometers, and our result is in the correct unit.", "answer": "$$\\boxed{4}$$", "id": "2732646"}, {"introduction": "Having established the speed advantage of myelination, we now examine how this structure is optimized for peak performance. This practice introduces the g-ratio, a critical parameter reflecting the trade-off between the axon's conductive core and its insulating myelin sheath. Through a straightforward calculation and qualitative reasoning, you will probe the biophysical principles that govern the ideal myelin thickness for maximal conduction velocity [@problem_id:2732722].", "problem": "In the context of myelination by oligodendrocytes in the central nervous system and Schwann cells in the peripheral nervous system, the g-ratio is defined as the ratio of the inner (axon) diameter to the outer (fiber) diameter, $g = d_i/d_o$. Consider a myelinated axon with inner diameter $d_i = 4\\,\\mu\\mathrm{m}$ and outer diameter $d_o = 6\\,\\mu\\mathrm{m}$. \n\n(a) Compute the g-ratio $g = d_i/d_o$. Express your answer as a dimensionless number and round to three significant figures.\n\n(b) Using only fundamental considerations from cable theory and the physics of a cylindrical capacitor, assess qualitatively whether the computed g-ratio aligns with values predicted to maximize saltatory conduction velocity under a fixed outer fiber diameter constraint. In your reasoning, you may invoke the following well-tested bases without deriving numerical constants: \n- The internodal membrane behaves approximately as a cylindrical capacitor with capacitance per unit length $C' \\propto 1/\\ln(1/g)$.\n- The axial resistance per unit length scales as $r_a \\propto 1/d_i^2$ for an axon of inner diameter $d_i$.\n- Internode length empirically scales with outer fiber diameter, $L \\propto d_o$.\nDo not compute any additional numerical quantities for part (b); provide a qualitative conclusion supported by the above dependencies. The only quantity to report as a final answer is the g-ratio from part (a), rounded as instructed.", "solution": "The problem presents two tasks concerning the g-ratio of a myelinated axon. First, to compute the g-ratio from given dimensions. Second, to qualitatively assess if this computed value is consistent with the principle of maximizing saltatory conduction velocity, based on fundamental biophysical dependencies. The problem is well-posed, scientifically grounded, and contains all necessary information.\n\nPart (a): Computation of the g-ratio.\n\nThe g-ratio, denoted by $g$, is defined as the ratio of the inner axon diameter, $d_i$, to the outer fiber diameter, $d_o$. The formula is:\n$$g = \\frac{d_i}{d_o}$$\nThe problem provides the following values:\nInner diameter, $d_i = 4\\,\\mu\\mathrm{m}$.\nOuter diameter, $d_o = 6\\,\\mu\\mathrm{m}$.\n\nSubstituting these values into the definition:\n$$g = \\frac{4\\,\\mu\\mathrm{m}}{6\\,\\mu\\mathrm{m}}$$\nThe units of micrometers ($\\mu\\mathrm{m}$) cancel, confirming that the g-ratio is a dimensionless quantity.\n$$g = \\frac{4}{6} = \\frac{2}{3}$$\nTo express this as a decimal rounded to three significant figures, we perform the division:\n$$g = 0.6666...$$\nRounding to three significant figures yields:\n$$g \\approx 0.667$$\n\nPart (b): Qualitative assessment of the g-ratio's optimality.\n\nThe goal is to assess whether the computed g-ratio, $g \\approx 0.667$, is consistent with values predicted to maximize the velocity of saltatory conduction. The assessment must be based on the provided physical dependencies for a fixed outer diameter $d_o$.\n\nSaltatory conduction velocity is maximized by optimizing the trade-off between two key electrical properties of the myelinated internode: the axial resistance per unit length, $r_a$, and the capacitance per unit length, $C'$.\n\n$1$. The dependence of axial resistance on the g-ratio:\nThe axial resistance, $r_a$, is the resistance to current flow along the axoplasm. It is given to scale as $r_a \\propto 1/d_i^2$. Since $d_i = g \\cdot d_o$ and $d_o$ is fixed, the inner diameter $d_i$ is directly proportional to $g$. Therefore, the axial resistance scales with $g$ as:\n$$r_a \\propto \\frac{1}{(g \\cdot d_o)^2} \\propto \\frac{1}{g^2}$$\nTo maximize conduction velocity, the axial current must spread efficiently. This requires minimizing the axial resistance $r_a$. To minimize $r_a$, the value of $g$ must be maximized. This corresponds to having the widest possible axon core within the fixed outer diameter, which implies having the thinnest possible myelin sheath.\n\n$2$. The dependence of capacitance on the g-ratio:\nThe internodal membrane and surrounding myelin sheath act as a cylindrical capacitor. The capacitance per unit length, $C'$, determines how quickly the membrane potential can change in response to current flow. It is given to scale as $C' \\propto 1/\\ln(1/g)$. To maximize conduction velocity, the time required to charge the membrane capacitance must be minimized. This requires minimizing $C'$. To minimize $C'$, its denominator, $\\ln(1/g)$, must be maximized. The logarithmic function is monotonically increasing, so we must maximize its argument, $1/g$. This is achieved by minimizing the g-ratio, $g$. A smaller $g$ corresponds to a thicker myelin sheath, which provides better electrical insulation and thus a lower capacitance.\n\n$3$. The trade-off and optimal g-ratio:\nWe have identified two conflicting requirements for maximizing conduction velocity under a fixed outer diameter:\n- Minimizing axial resistance ($r_a$) requires maximizing $g$.\n- Minimizing capacitance ($C'$) requires minimizing $g$.\n\nThis fundamental trade-off implies that there must exist an optimal, intermediate value of $g$ where conduction velocity is maximal. If $g$ is too large (approaching $1$), the myelin sheath is too thin, capacitance becomes excessively high, and the insulating properties are lost. If $g$ is too small (approaching $0$), the axon core is too narrow, axial resistance becomes excessively high, and longitudinal current flow is impeded.\n\nTheoretical models based on these principles, first developed by W. A. H. Rushton, predict that the optimal g-ratio that maximizes conduction velocity is approximately $g_{\\text{opt}} \\approx 0.6$. Our computed value from part (a) is $g \\approx 0.667$. This value is close to the theoretical optimum. Empirical observations of myelinated fibers across the central and peripheral nervous systems consistently show g-ratios clustering in the range of $0.6$ to $0.7$.\n\nTherefore, we conclude that the computed g-ratio of approximately $0.667$ aligns well with the value predicted to maximize, or nearly maximize, saltatory conduction velocity. This suggests that the axon's morphology represents an efficient biological design for rapid signal propagation. The empirical relationship $L \\propto d_o$ further suggests that the entire system is scaled in a coordinated manner to optimize function, but it does not directly affect the trade-off that determines the optimal g-ratio.", "answer": "$$\\boxed{0.667}$$", "id": "2732722"}, {"introduction": "Our final practice moves from the biophysics of a single axon to the systems-level dynamics of glial cell generation, a critical process in development and repair after disease or injury. You will engage with a modern computational model of cell lineage, using the framework of an absorbing Markov chain to simulate how progenitor cells differentiate into myelinating glia. This exercise provides a hands-on introduction to the quantitative modeling of cellular fate decisions in the context of remyelination [@problem_id:2732687].", "problem": "You are given a principled abstraction of a single-cell RNA sequencing (scRNA-seq; single-cell Ribonucleic Acid sequencing) lineage-inference task for remyelination in which cells transition from oligodendrocyte precursor cells (OPCs) to either myelinating oligodendrocytes or myelinating Schwann cells after demyelination. The goal is to design a computational trajectory analysis that (i) infers branch probabilities toward terminal myelinating lineages and (ii) computes the expected number of transitions to absorption (a pseudotime proxy) from a defined progenitor state. The abstraction is formulated as an absorbing Markov chain whose transition probabilities are determined by a softmax of lineage program scores derived from gene modules, modulated by a demyelination indicator. All quantities must be treated purely mathematically as defined below, independent of any external biology software. No external data are required; the test suite provides all numerical inputs. No physical units are involved.\n\nFundamental base and core definitions:\n- Cells are represented as nodes in a finite directed graph with a partition into transient states and absorbing states. Absorbing states are terminal myelinating fates. Transitions form a Markov chain with a row-stochastic transition matrix.\n- The softmax function converts energy-like scores into probabilities by exponentiation and row normalization. This captures the widely used interpretation of relative propensities in lineage models.\n- For an absorbing Markov chain with transient-to-transient submatrix denoted by $Q$ and transient-to-absorbing submatrix denoted by $R$, the branch (absorption) probabilities and expected steps to absorption from a transient start state are obtained by standard Markov chain theory. You must derive and implement these without using any domain-specific libraries.\n\nGraph, states, and transition construction:\n- There are $6$ states in a fixed order: $\\{\\mathrm{OPC}, \\mathrm{COP}, \\mathrm{NFO}, \\mathrm{iSC}, \\mathrm{MO}, \\mathrm{mSC}\\}$, where oligodendrocyte precursor cell (OPC), committed oligodendrocyte precursor (COP), newly formed oligodendrocyte (NFO), immature Schwann cell (iSC), myelinating oligodendrocyte (MO), and myelinating Schwann cell (mSC).\n- Transient states are the first $4$ states: $\\{\\mathrm{OPC}, \\mathrm{COP}, \\mathrm{NFO}, \\mathrm{iSC}\\}$. Absorbing states are the last $2$ states: $\\{\\mathrm{MO}, \\mathrm{mSC}\\}$.\n- Allowed directed edges are:\n  - From $\\mathrm{OPC}$ to $\\mathrm{COP}$ and to $\\mathrm{iSC}$.\n  - From $\\mathrm{COP}$ to $\\mathrm{NFO}$.\n  - From $\\mathrm{NFO}$ to $\\mathrm{MO}$ (absorbing).\n  - From $\\mathrm{iSC}$ to $\\mathrm{mSC}$ (absorbing).\n- For each transient state $i$ and each allowed outgoing edge $i \\to j$, define an unnormalized transition weight $w_{ij}$ by\n  $$w_{ij} = \\exp\\!\\left(\\frac{s_{ij}}{T}\\right),$$\n  where $T$ is a positive temperature and $s_{ij}$ is a score that depends on lineage program scores and a demyelination indicator $d \\in \\{0,1\\}$, with $d=0$ interpreted as before demyelination and $d=1$ as after demyelination.\n- The score $s_{ij}$ is constructed as\n  $$s_{ij} = \\beta_0 + \\beta_{\\mathrm{o}}\\, g_{\\mathrm{o}}(i)\\,\\mathbf{1}\\{j \\in \\mathcal{J}_{\\mathrm{o}}\\} + \\beta_{\\mathrm{s}}\\, g_{\\mathrm{s}}(i)\\,\\mathbf{1}\\{j \\in \\mathcal{J}_{\\mathrm{s}}\\} + \\beta_{\\mathrm{d}}\\, d \\,\\mathbf{1}\\{j \\in \\mathcal{J}_{\\mathrm{o}}\\} + \\gamma\\, \\mathbf{1}\\{(i,j)=(\\mathrm{OPC},\\mathrm{iSC})\\},$$\n  where $\\beta_0$, $\\beta_{\\mathrm{o}}$, $\\beta_{\\mathrm{s}}$, and $\\beta_{\\mathrm{d}}$ are scalar parameters; $g_{\\mathrm{o}}(i)$ and $g_{\\mathrm{s}}(i)$ are scalar lineage program scores for oligodendroglial and Schwann programs associated with state $i$; $\\gamma$ is an edge-specific penalty on $\\mathrm{OPC} \\to \\mathrm{iSC}$; $\\mathbf{1}\\{\\cdot\\}$ is the indicator function; and\n  $$\\mathcal{J}_{\\mathrm{o}} = \\{\\mathrm{COP}, \\mathrm{NFO}, \\mathrm{MO}\\}, \\quad \\mathcal{J}_{\\mathrm{s}} = \\{\\mathrm{iSC}, \\mathrm{mSC}\\}.$$\n- For each transient state $i$, the normalized transition probability to $j$ is\n  $$P_{ij} = \\frac{w_{ij}}{\\sum_{k \\in \\mathrm{Out}(i)} w_{ik}},$$\n  where $\\mathrm{Out}(i)$ enumerates allowed outgoing targets from $i$. For absorbing states $a \\in \\{\\mathrm{MO}, \\mathrm{mSC}\\}$, set $P_{aa} = 1$ and $P_{ab} = 0$ for $b \\neq a$.\n\nQuantities to compute:\n- For both $d=0$ and $d=1$, construct the full $6 \\times 6$ transition matrix $P$ as above, extract the transient-to-transient submatrix $Q$ and the transient-to-absorbing submatrix $R$, and compute:\n  1. The absorption (branch) probabilities from the start state $\\mathrm{OPC}$ into $\\mathrm{MO}$ and into $\\mathrm{mSC}$. Report these as floats.\n  2. The expected number of transitions to absorption (pseudotime proxy) when starting from $\\mathrm{OPC}$. Report this as a float.\n- Additionally, compute the change in the probability of absorption into $\\mathrm{MO}$ from $d=0$ to $d=1$ as a float.\n\nOutput specification:\n- For each test case, produce a list of $7$ floats in the following order for the two timepoints $d \\in \\{0,1\\}$:\n  $$\\big[\\; p_{\\mathrm{MO}}^{(d=0)},\\; p_{\\mathrm{mSC}}^{(d=0)},\\; \\tau^{(d=0)},\\; p_{\\mathrm{MO}}^{(d=1)},\\; p_{\\mathrm{mSC}}^{(d=1)},\\; \\tau^{(d=1)},\\; \\Delta p_{\\mathrm{MO}}\\;\\big],$$\n  where $p_{\\mathrm{MO}}^{(d)}$ and $p_{\\mathrm{mSC}}^{(d)}$ are the absorption probabilities into $\\mathrm{MO}$ and $\\mathrm{mSC}$ respectively when starting at $\\mathrm{OPC}$, $\\tau^{(d)}$ is the expected number of transitions to absorption when starting at $\\mathrm{OPC}$, and $\\Delta p_{\\mathrm{MO}} = p_{\\mathrm{MO}}^{(d=1)} - p_{\\mathrm{MO}}^{(d=0)}$.\n- Round every float to $6$ decimal places.\n- Your program should produce a single line of output containing the results as a comma-separated list of the per-case lists enclosed in a single pair of square brackets, for example,\n```\n[[x_11,...,x_17],[x_21,...,x_27],[x_31,...,x_37]]\n```\nTest suite:\n- Use the parameter values below for three test cases. For each case, the lineage program score arrays list $g_{\\mathrm{o}}(i)$ and $g_{\\mathrm{s}}(i)$ for the transient states in the fixed order $\\{\\mathrm{OPC}, \\mathrm{COP}, \\mathrm{NFO}, \\mathrm{iSC}\\}$. The scalar parameters are shared across all cases as specified. In all cases, the temperature is $T = 1.0$, and the coefficients are $\\beta_0 = 0.0$, $\\beta_{\\mathrm{o}} = 1.0$, $\\beta_{\\mathrm{s}} = 1.0$, and $\\beta_{\\mathrm{d}} = 0.8$.\n  - Case $1$:\n    - $g_{\\mathrm{o}} = [\\,1.0,\\,0.8,\\,0.5,\\,0.1\\,]$\n    - $g_{\\mathrm{s}} = [\\,0.2,\\,0.1,\\,0.1,\\,1.0\\,]$\n    - $\\gamma = -2.0$\n  - Case $2$:\n    - $g_{\\mathrm{o}} = [\\,0.2,\\,0.1,\\,0.1,\\,0.2\\,]$\n    - $g_{\\mathrm{s}} = [\\,1.2,\\,0.8,\\,0.2,\\,1.5\\,]$\n    - $\\gamma = 0.0$\n  - Case $3$:\n    - $g_{\\mathrm{o}} = [\\,0.5,\\,0.5,\\,0.5,\\,0.5\\,]$\n    - $g_{\\mathrm{s}} = [\\,0.5,\\,0.5,\\,0.5,\\,0.5\\,]$\n    - $\\gamma = -0.7$\n\nImplementation requirements:\n- Implement the construction of $P$ for $d=0$ and $d=1$, the extraction of $Q$ and $R$, and the computation of absorption probabilities and expected steps starting from $\\mathrm{OPC}$ using first principles of absorbing Markov chains.\n- No user input is required; encode the test suite in the program. Print only the final aggregated list as specified. Angles are not involved; no physical units are involved; probabilities must be reported as decimals in $[0,1]$.", "solution": "The problem statement is a valid, well-posed mathematical problem. It presents a principled abstraction of cell lineage-inference based on the established mathematical framework of absorbing Markov chains. All components, parameters, and objectives are defined with sufficient clarity and internal consistency to permit a unique and verifiable solution. No scientific principles are violated; the problem is grounded in standard computational modeling techniques used in systems biology.\n\nThe solution proceeds by first principles. We begin with the general theory of absorbing Markov chains, then specialize it to the specific graph structure given in the problem to derive a simplified computational algorithm.\n\nAn absorbing Markov chain is characterized by a state space partitioned into a set of transient states, $\\mathcal{T}$, and a set of absorbing states, $\\mathcal{A}$. The transition probability matrix $P$ can be written in a canonical form:\n$$\nP = \\begin{pmatrix} Q & R \\\\ 0 & I \\end{pmatrix}\n$$\nwhere $Q$ is a $t \\times t$ submatrix of probabilities for transitions between the $t$ transient states, $R$ is a $t \\times r$ submatrix for transitions from the $t$ transient states to the $r$ absorbing states, $0$ is an $r \\times t$ matrix of zeros, and $I$ is the $r \\times r$ identity matrix.\n\nThe fundamental matrix of the chain is denoted by $N$ and is defined as $N = (I - Q)^{-1}$, where $I$ is the $t \\times t$ identity matrix. The existence of $N$ is guaranteed because for any transient state, there is a non-zero probability of reaching an absorbing state. The entry $N_{ij}$ of the fundamental matrix represents the expected number of times the process visits transient state $j$ given that it started in transient state $i$.\n\nThe expected number of steps (transitions) before absorption, starting from transient state $i$, is given by the $i$-th component of the vector $\\boldsymbol{\\tau}$, calculated as:\n$$\n\\boldsymbol{\\tau} = N \\mathbf{1}\n$$\nwhere $\\mathbf{1}$ is a $t \\times 1$ column vector of ones. Thus, $\\tau_i = \\sum_{j \\in \\mathcal{T}} N_{ij}$.\n\nThe probability of being absorbed in absorbing state $k$ starting from transient state $i$ is given by the entry $B_{ik}$ of the matrix $B$, where:\n$$\nB = N R\n$$\n\nNow, we apply this framework to the problem. The states are ordered $\\{\\mathrm{OPC}, \\mathrm{COP}, \\mathrm{NFO}, \\mathrm{iSC}, \\mathrm{MO}, \\mathrm{mSC}\\}$, indexed from $0$ to $5$.\nThe set of transient states is $\\mathcal{T} = \\{\\mathrm{OPC}, \\mathrm{COP}, \\mathrm{NFO}, \\mathrm{iSC}\\}$, corresponding to indices $\\{0, 1, 2, 3\\}$. Thus, $t=4$.\nThe set of absorbing states is $\\mathcal{A} = \\{\\mathrm{MO}, \\mathrm{mSC}\\}$, corresponding to indices $\\{4, 5\\}$. Thus, $r=2$.\n\nThe allowed transitions define the structure of the transition matrix.\nFrom $\\mathrm{OPC}\\,(0)$: to $\\mathrm{COP}\\,(1)$ and $\\mathrm{iSC}\\,(3)$.\nFrom $\\mathrm{COP}\\,(1)$: to $\\mathrm{NFO}\\,(2)$. This transition occurs with probability $1$.\nFrom $\\mathrm{NFO}\\,(2)$: to $\\mathrm{MO}\\,(4)$. This transition occurs with probability $1$.\nFrom $\\mathrm{iSC}\\,(3)$: to $\\mathrm{mSC}\\,(5)$. This transition occurs with probability $1$.\n\nFor a transient state $i$, the transition probabilities $P_{ij}$ are derived from scores $s_{ij}$. For state $\\mathrm{OPC}\\,(0)$, the outgoing transitions are to $\\mathrm{COP}\\,(1)$ and $\\mathrm{iSC}\\,(3)$. The probabilities are:\n$$\nP_{01} = \\frac{\\exp(s_{01}/T)}{\\exp(s_{01}/T) + \\exp(s_{03}/T)}, \\quad P_{03} = \\frac{\\exp(s_{03}/T)}{\\exp(s_{01}/T) + \\exp(s_{03}/T)}\n$$\nFor states $\\mathrm{COP}\\,(1)$, $\\mathrm{NFO}\\,(2)$, and $\\mathrm{iSC}\\,(3)$, there is only one outgoing edge, so the probability for that transition is $1$.\n$P_{12}=1$, $P_{24}=1$ (to absorbing state $\\mathrm{MO}$), and $P_{35}=1$ (to absorbing state $\\mathrm{mSC}$).\n\nThe submatrices $Q$ and $R$ are constructed from these probabilities. The rows and columns of $Q$ are indexed by $\\mathcal{T}=\\{0, 1, 2, 3\\}$. The rows of $R$ are indexed by $\\mathcal{T}$ and its columns by $\\mathcal{A}=\\{4, 5\\}$.\n$$\nQ = \\begin{pmatrix}\n0 & P_{01} & 0 & P_{03} \\\\\n0 & 0 & 1 & 0 \\\\\n0 & 0 & 0 & 0 \\\\\n0 & 0 & 0 & 0\n\\end{pmatrix}, \\quad\nR = \\begin{pmatrix}\n0 & 0 \\\\\n0 & 0 \\\\\n1 & 0 \\\\\n0 & 1\n\\end{pmatrix}\n$$\nNext, we compute the fundamental matrix $N = (I-Q)^{-1}$:\n$$\nI-Q = \\begin{pmatrix}\n1 & -P_{01} & 0 & -P_{03} \\\\\n0 & 1 & -1 & 0 \\\\\n0 & 0 & 1 & 0 \\\\\n0 & 0 & 0 & 1\n\\end{pmatrix}\n$$\nInverting this upper triangular matrix yields:\n$$\nN = (I-Q)^{-1} = \\begin{pmatrix}\n1 & P_{01} & P_{01} & P_{03} \\\\\n0 & 1 & 1 & 0 \\\\\n0 & 0 & 1 & 0 \\\\\n0 & 0 & 0 & 1\n\\end{pmatrix}\n$$\nThe problem requires quantities starting from state $\\mathrm{OPC}$, which is index $0$. We are interested in the first row of $N$ and $B$.\n\nThe expected number of transitions to absorption from $\\mathrm{OPC}$, $\\tau_{\\mathrm{OPC}}$, is the sum of the elements in the first row of $N$:\n$$\n\\tau_{\\mathrm{OPC}} = N_{00} + N_{01} + N_{02} + N_{03} = 1 + P_{01} + P_{01} + P_{03}\n$$\nSince $P_{01} + P_{03} = 1$, this simplifies to:\n$$\n\\tau_{\\mathrm{OPC}} = 1 + P_{01} + 1 = 2 + P_{01}\n$$\n\nThe absorption probabilities are computed from $B=NR$:\n$$\nB = \\begin{pmatrix}\n1 & P_{01} & P_{01} & P_{03} \\\\\n0 & 1 & 1 & 0 \\\\\n0 & 0 & 1 & 0 \\\\\n0 & 0 & 0 & 1\n\\end{pmatrix}\n\\begin{pmatrix}\n0 & 0 \\\\\n0 & 0 \\\\\n1 & 0 \\\\\n0 & 1\n\\end{pmatrix}\n=\n\\begin{pmatrix}\nP_{01} & P_{03} \\\\\n1 & 0 \\\\\n1 & 0 \\\\\n0 & 1\n\\end{pmatrix}\n$$\nThe first row of $B$ gives the absorption probabilities starting from $\\mathrm{OPC}$. The columns correspond to absorbing states $\\mathrm{MO}$ (index $4$) and $\\mathrm{mSC}$ (index $5$).\nThe probability of absorption into $\\mathrm{MO}$, $p_{\\mathrm{MO}}$, is $B_{00} = P_{01}$.\nThe probability of absorption into $\\mathrm{mSC}$, $p_{\\mathrm{mSC}}$, is $B_{01} = P_{03}$.\n\nThe computational algorithm is as follows for each test case:\n1.  For each demyelination indicator value $d \\in \\{0, 1\\}$:\n    a. Determine the scores for transitions from $\\mathrm{OPC}$. The starting state is $i=0$ ($\\mathrm{OPC}$), and target states are $j=1$ ($\\mathrm{COP}$) and $j=3$ ($\\mathrm{iSC}$).\n    $$ s_{01} = \\beta_0 + \\beta_{\\mathrm{o}}\\, g_{\\mathrm{o}}(0)\\,\\mathbf{1}\\{1 \\in \\mathcal{J}_{\\mathrm{o}}\\} + \\beta_{\\mathrm{s}}\\, g_{\\mathrm{s}}(0)\\,\\mathbf{1}\\{1 \\in \\mathcal{J}_{\\mathrm{s}}\\} + \\beta_{\\mathrm{d}}\\, d \\,\\mathbf{1}\\{1 \\in \\mathcal{J}_{\\mathrm{o}}\\} + \\gamma\\, \\mathbf{1}\\{(0,1)=(\\mathrm{OPC},\\mathrm{iSC})\\} $$\n    Using $\\mathcal{J}_{\\mathrm{o}} = \\{\\mathrm{COP}, \\mathrm{NFO}, \\mathrm{MO}\\}$ and $\\mathcal{J}_{\\mathrm{s}} = \\{\\mathrm{iSC}, \\mathrm{mSC}\\}$, and given parameters $\\beta_0=0$, $\\beta_{\\mathrm{o}}=1$, $\\beta_{\\mathrm{s}}=1$, this simplifies:\n    $$ s_{01} = g_{\\mathrm{o}}(0) + \\beta_{\\mathrm{d}}\\, d $$\n    $$ s_{03} = \\beta_0 + \\beta_{\\mathrm{o}}\\, g_{\\mathrm{o}}(0)\\,\\mathbf{1}\\{3 \\in \\mathcal{J}_{\\mathrm{o}}\\} + \\beta_{\\mathrm{s}}\\, g_{\\mathrm{s}}(0)\\,\\mathbf{1}\\{3 \\in \\mathcal{J}_{\\mathrm{s}}\\} + \\beta_{\\mathrm{d}}\\, d \\,\\mathbf{1}\\{3 \\in \\mathcal{J}_{\\mathrm{o}}\\} + \\gamma\\, \\mathbf{1}\\{(0,3)=(\\mathrm{OPC},\\mathrm{iSC})\\} $$\n    $$ s_{03} = g_{\\mathrm{s}}(0) + \\gamma $$\n    b. Calculate the transition probability $P_{01}$. With temperature $T=1$:\n    $$ P_{01}^{(d)} = \\frac{\\exp(s_{01})}{\\exp(s_{01}) + \\exp(s_{03})} $$\n    c. The required quantities for a given $d$ are:\n    $$ p_{\\mathrm{MO}}^{(d)} = P_{01}^{(d)} $$\n    $$ p_{\\mathrm{mSC}}^{(d)} = 1 - P_{01}^{(d)} $$\n    $$ \\tau^{(d)} = 2 + P_{01}^{(d)} $$\n2.  Compute the change in $\\mathrm{MO}$ absorption probability: $\\Delta p_{\\mathrm{MO}} = p_{\\mathrm{MO}}^{(d=1)} - p_{\\mathrm{MO}}^{(d=0)}$.\n3.  Collect the seven values: $[p_{\\mathrm{MO}}^{(d=0)}, p_{\\mathrm{mSC}}^{(d=0)}, \\tau^{(d=0)}, p_{\\mathrm{MO}}^{(d=1)}, p_{\\mathrm{mSC}}^{(d=1)}, \\tau^{(d=1)}, \\Delta p_{\\mathrm{MO}}]$, rounding each to $6$ decimal places.\n4.  Repeat for all test cases and format the final output as specified.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the absorbing Markov chain problem for remyelination lineage inference.\n    \"\"\"\n    \n    # Shared parameters for all test cases\n    T = 1.0\n    beta_0 = 0.0\n    beta_o = 1.0\n    beta_s = 1.0\n    beta_d = 0.8\n    \n    # Test suite definition\n    test_cases = [\n        {\n            \"g_o\": [1.0, 0.8, 0.5, 0.1],\n            \"g_s\": [0.2, 0.1, 0.1, 1.0],\n            \"gamma\": -2.0\n        },\n        {\n            \"g_o\": [0.2, 0.1, 0.1, 0.2],\n            \"g_s\": [1.2, 0.8, 0.2, 1.5],\n            \"gamma\": 0.0\n        },\n        {\n            \"g_o\": [0.5, 0.5, 0.5, 0.5],\n            \"g_s\": [0.5, 0.5, 0.5, 0.5],\n            \"gamma\": -0.7\n        }\n    ]\n\n    all_results = []\n\n    for case in test_cases:\n        g_o_opc = case[\"g_o\"][0]\n        g_s_opc = case[\"g_s\"][0]\n        gamma = case[\"gamma\"]\n        \n        results_for_case = []\n        \n        # --- Calculation for d=0 (before demyelination) ---\n        d = 0\n        \n        # Scores for transitions from OPC (state 0)\n        # s_01: OPC -> COP (Oligodendrocyte lineage)\n        s_01_d0 = beta_0 + beta_o * g_o_opc + beta_d * d\n        # s_03: OPC -> iSC (Schwann cell lineage)\n        s_03 = beta_0 + beta_s * g_s_opc + gamma\n        \n        # Unnormalized weights\n        w_01_d0 = np.exp(s_01_d0 / T)\n        w_03 = np.exp(s_03 / T)\n        \n        # Transition probability P(OPC -> COP)\n        p_01_d0 = w_01_d0 / (w_01_d0 + w_03)\n        \n        p_mo_d0 = p_01_d0\n        p_msc_d0 = 1.0 - p_01_d0\n        tau_d0 = 2.0 + p_01_d0\n        \n        # --- Calculation for d=1 (after demyelination) ---\n        d = 1\n        \n        # Score s_01 changes with d, s_03 is constant\n        s_01_d1 = beta_0 + beta_o * g_o_opc + beta_d * d\n        \n        w_01_d1 = np.exp(s_01_d1 / T)\n        \n        p_01_d1 = w_01_d1 / (w_01_d1 + w_03)\n        \n        p_mo_d1 = p_01_d1\n        p_msc_d1 = 1.0 - p_01_d1\n        tau_d1 = 2.0 + p_01_d1\n        \n        # --- Change in MO absorption probability ---\n        delta_p_mo = p_mo_d1 - p_mo_d0\n        \n        # Assemble the results for the current case\n        results_for_case = [\n            p_mo_d0, p_msc_d0, tau_d0,\n            p_mo_d1, p_msc_d1, tau_d1,\n            delta_p_mo\n        ]\n        all_results.append(results_for_case)\n\n    # Format the final output string as specified\n    # The format is [[val1,val2,...],[val1,val2,...],...] without spaces.\n    list_of_strings = []\n    for res in all_results:\n        res_str = f\"[{','.join(f'{val:.6f}' for val in res)}]\"\n        list_of_strings.append(res_str)\n    \n    final_output = f\"[{','.join(list_of_strings)}]\"\n    \n    print(final_output)\n\nsolve()\n```", "id": "2732687"}]}