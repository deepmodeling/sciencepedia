{"hands_on_practices": [{"introduction": "A fundamental task in neuroscience is the classification of neurons into broad functional categories, such as glutamatergic and GABAergic. This process can be formalized using statistical decision theory. This first exercise [@problem_id:2705534] challenges you to build a classifier from the ground up, starting with a probabilistic model of gene expression data. By deriving the optimal linear decision rule, you will gain a foundational understanding of how tools like linear discriminant analysis emerge from first principles and appreciate how to quantify the theoretical best-case performance of such a classifier.", "problem": "A laboratory is building a classifier to distinguish glutamatergic neurons from gamma-aminobutyric acid (GABA)ergic neurons using single-cell messenger ribonucleic acid (mRNA) expression of four genes: `$Slc17a7$`, `$Gad1$`, `$Gad2$`, and `$Slc32a1$`. The measurement reported for each gene is the natural logarithm of a normalized expression level. Based on quality-controlled single-cell data, the log-expression vector $x \\in \\mathbb{R}^{4}$ for a neuron is modeled as conditionally multivariate normal with class-conditional means and a shared diagonal covariance matrix as follows:\n- If the neuron is glutamatergic, then $x \\sim \\mathcal{N}(\\mu_{\\mathrm{Glu}}, \\Sigma)$ with $\\mu_{\\mathrm{Glu}} = (\\,2.5,\\ 0.5,\\ 0.6,\\ 0.4\\,)$ and $\\Sigma = \\mathrm{diag}(\\,0.81,\\ 0.81,\\ 0.81,\\ 0.81\\,)$.\n- If the neuron is GABAergic, then $x \\sim \\mathcal{N}(\\mu_{\\mathrm{GABA}}, \\Sigma)$ with $\\mu_{\\mathrm{GABA}} = (\\,0.1,\\ 1.8,\\ 1.7,\\ 1.6\\,)$ and the same $\\Sigma$ as above.\n\nIndependent bulk ribonucleic acid sequencing (RNA-seq) suggests that glutamatergic neurons constitute a fraction $\\pi_{\\mathrm{Glu}} = 0.7$ of the sampled neuronal population, while GABAergic neurons constitute $\\pi_{\\mathrm{GABA}} = 0.3$. Assume:\n- Conditional on class, the four gene log-expressions are jointly Gaussian with the parameters given above.\n- The goal is to minimize the expected $0$–$1$ misclassification loss, that is, to minimize the total probability of misclassification under the given class priors.\n\nTasks:\n1) Starting from the definition of the Bayes decision rule (choose the class maximizing posterior probability) and the form of the multivariate normal density, derive the explicit optimal linear decision function that minimizes expected misclassification. Write it in the form $g(x) = w^{\\top} x + b$ and specify $w$ and $b$ in terms of $\\mu_{\\mathrm{Glu}}$, $\\mu_{\\mathrm{GABA}}$, $\\Sigma$, and $\\pi_{\\mathrm{Glu}}, \\pi_{\\mathrm{GABA}}$.\n2) Using the same probabilistic model and your derived rule, compute the minimized expected total misclassification rate (the Bayes risk under $0$–$1$ loss) as a single real number.\n\nExpress the final answer for the minimized misclassification rate as a decimal without a percentage symbol, and round your answer to four significant figures.", "solution": "The problem is scientifically grounded, well-posed, and contains all necessary information for a unique solution. It is a standard application of Bayes decision theory to a binary classification problem with Gaussian class-conditional densities.\n\nLet the two classes be glutamatergic ($C_{\\mathrm{Glu}}$) and GABAergic ($C_{\\mathrm{GABA}}$). The problem provides the class prior probabilities $\\pi_{\\mathrm{Glu}} = 0.7$ and $\\pi_{\\mathrm{GABA}} = 0.3$. The class-conditional probability densities for a log-expression vector $x \\in \\mathbb{R}^{4}$ are given as multivariate normal distributions:\n$p(x|C_{\\mathrm{Glu}}) = \\mathcal{N}(x; \\mu_{\\mathrm{Glu}}, \\Sigma)$\n$p(x|C_{\\mathrm{GABA}}) = \\mathcal{N}(x; \\mu_{\\mathrm{GABA}}, \\Sigma)$\nwith a shared covariance matrix $\\Sigma$.\n\nThe objective is to minimize the expected $0$–$1$ misclassification loss. The optimal decision rule, known as the Bayes classifier, assigns a vector $x$ to the class with the maximum posterior probability. That is, we choose $C_{\\mathrm{Glu}}$ if $P(C_{\\mathrm{Glu}}|x) > P(C_{\\mathrm{GABA}}|x)$, and $C_{\\mathrm{GABA}}$ otherwise.\nUsing Bayes' theorem, the posterior probability is $P(C_k|x) = \\frac{p(x|C_k)\\pi_k}{p(x)}$. Since the denominator $p(x)$ is common to both classes, this is equivalent to comparing the quantities $p(x|C_k)\\pi_k$. It is more convenient to work with the logarithm, so we define the log-discriminant function for each class $k$:\n$$ \\delta_k(x) = \\ln[p(x|C_k)\\pi_k] = \\ln p(x|C_k) + \\ln \\pi_k $$\nThe decision rule is to classify $x$ as $C_{\\mathrm{Glu}}$ if $\\delta_{\\mathrm{Glu}}(x) > \\delta_{\\mathrm{GABA}}(x)$.\n\nThe probability density function for a $d$-dimensional multivariate normal distribution $\\mathcal{N}(\\mu, \\Sigma)$ is:\n$$ p(x; \\mu, \\Sigma) = \\frac{1}{(2\\pi)^{d/2} |\\Sigma|^{1/2}} \\exp\\left(-\\frac{1}{2}(x-\\mu)^{\\top}\\Sigma^{-1}(x-\\mu)\\right) $$\nThe natural logarithm of this density is:\n$$ \\ln p(x; \\mu, \\Sigma) = -\\frac{d}{2}\\ln(2\\pi) - \\frac{1}{2}\\ln|\\Sigma| - \\frac{1}{2}(x-\\mu)^{\\top}\\Sigma^{-1}(x-\\mu) $$\nSince the dimension $d=4$ and the covariance matrix $\\Sigma$ are the same for both classes, the terms $-\\frac{d}{2}\\ln(2\\pi) - \\frac{1}{2}\\ln|\\Sigma|$ are constant across classes and can be ignored in the comparison.\nExpanding the quadratic term: $(x-\\mu)^{\\top}\\Sigma^{-1}(x-\\mu) = x^{\\top}\\Sigma^{-1}x - 2\\mu^{\\top}\\Sigma^{-1}x + \\mu^{\\top}\\Sigma^{-1}\\mu$.\nThe log-discriminant function simplifies to:\n$$ \\delta_k(x) \\propto -\\frac{1}{2}(x^{\\top}\\Sigma^{-1}x - 2\\mu_k^{\\top}\\Sigma^{-1}x + \\mu_k^{\\top}\\Sigma^{-1}\\mu_k) + \\ln \\pi_k $$\nThe term $-\\frac{1}{2}x^{\\top}\\Sigma^{-1}x$ is also common to both classes and will cancel. Thus, the effective discriminant function is:\n$$ \\delta_k(x) = \\mu_k^{\\top}\\Sigma^{-1}x - \\frac{1}{2}\\mu_k^{\\top}\\Sigma^{-1}\\mu_k + \\ln \\pi_k $$\n\nTask 1: Derive the linear decision function $g(x) = w^{\\top}x + b$.\nWe define the decision function $g(x) = \\delta_{\\mathrm{Glu}}(x) - \\delta_{\\mathrm{GABA}}(x)$. The classification rule is to choose $C_{\\mathrm{Glu}}$ if $g(x) > 0$ and $C_{\\mathrm{GABA}}$ if $g(x) < 0$.\n$$ g(x) = \\left(\\mu_{\\mathrm{Glu}}^{\\top}\\Sigma^{-1}x - \\frac{1}{2}\\mu_{\\mathrm{Glu}}^{\\top}\\Sigma^{-1}\\mu_{\\mathrm{Glu}} + \\ln \\pi_{\\mathrm{Glu}}\\right) - \\left(\\mu_{\\mathrm{GABA}}^{\\top}\\Sigma^{-1}x - \\frac{1}{2}\\mu_{\\mathrm{GABA}}^{\\top}\\Sigma^{-1}\\mu_{\\mathrm{GABA}} + \\ln \\pi_{\\mathrm{GABA}}\\right) $$\n$$ g(x) = (\\mu_{\\mathrm{Glu}}^{\\top}\\Sigma^{-1} - \\mu_{\\mathrm{GABA}}^{\\top}\\Sigma^{-1})x - \\frac{1}{2}(\\mu_{\\mathrm{Glu}}^{\\top}\\Sigma^{-1}\\mu_{\\mathrm{Glu}} - \\mu_{\\mathrm{GABA}}^{\\top}\\Sigma^{-1}\\mu_{\\mathrm{GABA}}) + (\\ln \\pi_{\\mathrm{Glu}} - \\ln \\pi_{\\mathrm{GABA}}) $$\n$$ g(x) = (\\mu_{\\mathrm{Glu}} - \\mu_{\\mathrm{GABA}})^{\\top}\\Sigma^{-1}x + \\left( -\\frac{1}{2}\\mu_{\\mathrm{Glu}}^{\\top}\\Sigma^{-1}\\mu_{\\mathrm{Glu}} + \\frac{1}{2}\\mu_{\\mathrm{GABA}}^{\\top}\\Sigma^{-1}\\mu_{\\mathrm{GABA}} + \\ln\\left(\\frac{\\pi_{\\mathrm{Glu}}}{\\pi_{\\mathrm{GABA}}}\\right) \\right) $$\nThis is in the form $g(x) = w^{\\top}x + b$, where:\n$$ w = \\Sigma^{-1}(\\mu_{\\mathrm{Glu}} - \\mu_{\\mathrm{GABA}}) $$\n$$ b = -\\frac{1}{2}\\mu_{\\mathrm{Glu}}^{\\top}\\Sigma^{-1}\\mu_{\\mathrm{Glu}} + \\frac{1}{2}\\mu_{\\mathrm{GABA}}^{\\top}\\Sigma^{-1}\\mu_{\\mathrm{GABA}} + \\ln\\left(\\frac{\\pi_{\\mathrm{Glu}}}{\\pi_{\\mathrm{GABA}}}\\right) $$\n\nTask 2: Compute the minimized misclassification rate.\nThe total probability of error, or Bayes risk $R^*$, is given by:\n$$ R^* = P(\\text{classify as GABA} | C_{\\mathrm{Glu}})\\pi_{\\mathrm{Glu}} + P(\\text{classify as Glu} | C_{\\mathrm{GABA}})\\pi_{\\mathrm{GABA}} $$\n$$ R^* = P(g(x) < 0 | C_{\\mathrm{Glu}})\\pi_{\\mathrm{Glu}} + P(g(x) > 0 | C_{\\mathrm{GABA}})\\pi_{\\mathrm{GABA}} $$\nThe decision function $g(x)$ is a linear transformation of a Gaussian random vector $x$. Therefore, conditional on the class, $g(x)$ is a normally distributed scalar random variable. We must find its mean and variance.\nFor a class $k$, where $x \\sim \\mathcal{N}(\\mu_k, \\Sigma)$, the distribution of $g(x) = w^{\\top}x + b$ is $\\mathcal{N}(E[g(x)|C_k], \\mathrm{Var}(g(x)|C_k))$.\nThe variance is common for both classes:\n$$ \\mathrm{Var}(g(x)|C_k) = w^{\\top}\\Sigma w = (\\Sigma^{-1}(\\mu_{\\mathrm{Glu}} - \\mu_{\\mathrm{GABA}}))^{\\top}\\Sigma(\\Sigma^{-1}(\\mu_{\\mathrm{Glu}} - \\mu_{\\mathrm{GABA}})) = (\\mu_{\\mathrm{Glu}} - \\mu_{\\mathrm{GABA}})^{\\top}\\Sigma^{-1}(\\mu_{\\mathrm{Glu}} - \\mu_{\\mathrm{GABA}}) $$\nThis is the squared Mahalanobis distance between the two means, denoted as $\\Delta^2$.\nThe conditional means are:\n$$ E[g(x)|C_{\\mathrm{Glu}}] = w^{\\top}\\mu_{\\mathrm{Glu}} + b = \\frac{1}{2}\\Delta^2 + \\ln\\left(\\frac{\\pi_{\\mathrm{Glu}}}{\\pi_{\\mathrm{GABA}}}\\right) $$\n$$ E[g(x)|C_{\\mathrm{GABA}}] = w^{\\top}\\mu_{\\mathrm{GABA}} + b = -\\frac{1}{2}\\Delta^2 + \\ln\\left(\\frac{\\pi_{\\mathrm{Glu}}}{\\pi_{\\mathrm{GABA}}}\\right) $$\nLet $\\Phi(\\cdot)$ be the cumulative distribution function (CDF) of the standard normal distribution $\\mathcal{N}(0, 1)$. The error probabilities are:\n$$ P(g(x) < 0 | C_{\\mathrm{Glu}}) = \\Phi\\left(\\frac{0 - E[g(x)|C_{\\mathrm{Glu}}]}{\\sqrt{\\Delta^2}}\\right) = \\Phi\\left(-\\frac{\\Delta}{2} - \\frac{1}{\\Delta}\\ln\\left(\\frac{\\pi_{\\mathrm{Glu}}}{\\pi_{\\mathrm{GABA}}}\\right)\\right) $$\n$$ P(g(x) > 0 | C_{\\mathrm{GABA}}) = 1 - \\Phi\\left(\\frac{0 - E[g(x)|C_{\\mathrm{GABA}}]}{\\sqrt{\\Delta^2}}\\right) = \\Phi\\left(\\frac{-E[g(x)|C_{\\mathrm{GABA}}]}{\\Delta}\\right) = \\Phi\\left(\\frac{\\Delta}{2} - \\frac{1}{\\Delta}\\ln\\left(\\frac{\\pi_{\\mathrm{Glu}}}{\\pi_{\\mathrm{GABA}}}\\right)\\right) $$\nUsing the property $\\Phi(z) = 1 - \\Phi(-z)$, the second term is also $P(g(x) > 0 | C_{\\mathrm{GABA}}) = \\Phi\\left(-\\frac{\\Delta}{2} + \\frac{1}{\\Delta}\\ln\\left(\\frac{\\pi_{\\mathrm{Glu}}}{\\pi_{\\mathrm{GABA}}}\\right)\\right)$.\n\nNow, we substitute the provided numerical values:\n$\\mu_{\\mathrm{Glu}} = (2.5, 0.5, 0.6, 0.4)^{\\top}$\n$\\mu_{\\mathrm{GABA}} = (0.1, 1.8, 1.7, 1.6)^{\\top}$\n$\\Sigma = \\mathrm{diag}(0.81, 0.81, 0.81, 0.81) = 0.81 \\cdot I_4$, where $I_4$ is the $4 \\times 4$ identity matrix.\nThus, $\\Sigma^{-1} = \\frac{1}{0.81} I_4$.\n$\\pi_{\\mathrm{Glu}} = 0.7$, $\\pi_{\\mathrm{GABA}} = 0.3$.\n\nFirst, compute the difference in means:\n$$ \\mu_{\\mathrm{Glu}} - \\mu_{\\mathrm{GABA}} = (2.4, -1.3, -1.1, -1.2)^{\\top} $$\nNext, compute the squared Mahalanobis distance $\\Delta^2$:\n$$ \\Delta^2 = (\\mu_{\\mathrm{Glu}} - \\mu_{\\mathrm{GABA}})^{\\top}\\Sigma^{-1}(\\mu_{\\mathrm{Glu}} - \\mu_{\\mathrm{GABA}}) = \\frac{1}{0.81} ||\\mu_{\\mathrm{Glu}} - \\mu_{\\mathrm{GABA}}||_2^2 $$\n$$ ||\\mu_{\\mathrm{Glu}} - \\mu_{\\mathrm{GABA}}||_2^2 = (2.4)^2 + (-1.3)^2 + (-1.1)^2 + (-1.2)^2 = 5.76 + 1.69 + 1.21 + 1.44 = 10.1 $$\n$$ \\Delta^2 = \\frac{10.1}{0.81} \\approx 12.4691358 $$\nThe Mahalanobis distance is $\\Delta = \\sqrt{\\frac{10.1}{0.81}} = \\frac{\\sqrt{10.1}}{0.9} \\approx 3.5311663$.\n\nNext, compute the log-prior ratio:\n$$ \\ln\\left(\\frac{\\pi_{\\mathrm{Glu}}}{\\pi_{\\mathrm{GABA}}}\\right) = \\ln\\left(\\frac{0.7}{0.3}\\right) = \\ln\\left(\\frac{7}{3}\\right) \\approx 0.84729786 $$\nThe arguments for the CDF $\\Phi$ are:\nFor the glutamatergic error term:\n$$ A_{\\mathrm{Glu}} = -\\frac{\\Delta}{2} - \\frac{1}{\\Delta}\\ln\\left(\\frac{7}{3}\\right) \\approx -\\frac{3.5311663}{2} - \\frac{0.84729786}{3.5311663} \\approx -1.7655831 - 0.2399479 \\approx -2.005531 $$\nFor the GABAergic error term:\n$$ A_{\\mathrm{GABA}} = -\\frac{\\Delta}{2} + \\frac{1}{\\Delta}\\ln\\left(\\frac{7}{3}\\right) \\approx -1.7655831 + 0.2399479 \\approx -1.5256352 $$\nThe total error rate is:\n$$ R^* = \\pi_{\\mathrm{Glu}} \\Phi(A_{\\mathrm{Glu}}) + \\pi_{\\mathrm{GABA}} \\Phi(A_{\\mathrm{GABA}}) $$\n$$ R^* \\approx (0.7) \\Phi(-2.005531) + (0.3) \\Phi(-1.5256352) $$\nUsing standard normal CDF values:\n$\\Phi(-2.005531) \\approx 0.0224503$\n$\\Phi(-1.5256352) \\approx 0.0635418$\n$$ R^* \\approx (0.7)(0.0224503) + (0.3)(0.0635418) $$\n$$ R^* \\approx 0.01571521 + 0.01906254 = 0.03477775 $$\nRounding to four significant figures, the minimized misclassification rate is $0.03478$.", "answer": "$$\\boxed{0.03478}$$", "id": "2705534"}, {"introduction": "While theoretical models often assume perfect measurements, real-world molecular assays are inherently noisy, with specific rates of sensitivity and specificity. This practice problem [@problem_id:2705575] moves from an idealized continuous model to the practical challenge of designing a marker panel using discrete, imperfect data. You will learn to apply the law of total probability and principles of conditional independence to calculate the expected performance of a classification rule, a critical skill for evaluating or designing diagnostic panels in any molecular biology context.", "problem": "A laboratory is designing a three-assay messenger ribonucleic acid (mRNA) panel to classify cortical interneurons as somatostatin ($Sst$) versus parvalbumin ($Pvalb$). The panel contains assays for the genes somatostatin ($Sst$), reelin ($Reln$), and parvalbumin ($Pvalb$). For a given cell type, each gene’s true expression is modeled as a Bernoulli random variable with a type-specific probability, and, conditional on the cell type, the true expression states across genes are independent. Each assay has fixed sensitivity and specificity for detecting expression of its target gene, and, conditional on the true expression state, assay outcomes across genes are independent. The laboratory will classify a cell as “Sst” if and only if the observed panel satisfies the rule: “observed Sst assay positive or observed Reln assay positive, and observed Pvalb assay negative.”\n \nYou are given the following scientifically grounded parameters:\n- For true `$Sst$` interneurons: the probability that the `$Sst$` gene is truly expressed is $0.90$, `$Reln$` is $0.30$, and `$Pvalb$` is $0.02$.\n- For true `$Pvalb$` interneurons: the probability that the `$Sst$` gene is truly expressed is $0.05$, `$Reln$` is $0.05$, and `$Pvalb$` is $0.95$.\n- Assay performance (identical across cell types): the `$Sst$` assay has sensitivity $0.92$ and specificity $0.97$; the `$Reln$` assay has sensitivity $0.85$ and specificity $0.95$; the `$Pvalb$` assay has sensitivity $0.90$ and specificity $0.98$.\n\nUse the following fundamental definitions:\n- Sensitivity is the probability that the panel classifies “Sst” given a true `$Sst$` interneuron.\n- Specificity is the probability that the panel does not classify “Sst” given a true `$Pvalb$` interneuron.\n\nAssume conditional independence of genes’ true expression states given cell type, and independence of assay outcomes across genes given their respective true expression states. Derive from first principles the expected sensitivity and specificity of the panel under the stated rule and assumptions. Then compute the Youden’s $J$ statistic, defined as $J=\\text{sensitivity}+\\text{specificity}-1$. Report the numerical value of $J$ rounded to $4$ significant figures. No units are required.", "solution": "The problem statement is subjected to validation.\n\nStep 1: Extract Givens.\n- Cell types: Somatostatin (Sst), Parvalbumin (Pvalb).\n- mRNA panel assays for genes: Somatostatin ($Sst$), Reelin ($Reln$), Parvalbumin ($Pvalb$).\n- Model: True gene expression is a Bernoulli random variable. True expressions are conditionally independent given cell type. Assay outcomes are conditionally independent given true expression states.\n- Classification Rule: A cell is classified as \"Sst\" if and only if (observed Sst assay positive OR observed Reln assay positive) AND (observed Pvalb assay negative).\n- Parameters for true Sst interneurons ($C_{Sst}$):\n  - $P(\\text{Sst gene truly expressed}|C_{Sst}) = 0.90$\n  - $P(\\text{Reln gene truly expressed}|C_{Sst}) = 0.30$\n  - $P(\\text{Pvalb gene truly expressed}|C_{Sst}) = 0.02$\n- Parameters for true Pvalb interneurons ($C_{Pvalb}$):\n  - $P(\\text{Sst gene truly expressed}|C_{Pvalb}) = 0.05$\n  - $P(\\text{Reln gene truly expressed}|C_{Pvalb}) = 0.05$\n  - $P(\\text{Pvalb gene truly expressed}|C_{Pvalb}) = 0.95$\n- Assay Performance:\n  - Sst assay: Sensitivity $Se_{Sst} = 0.92$, Specificity $Sp_{Sst} = 0.97$.\n  - Reln assay: Sensitivity $Se_{Reln} = 0.85$, Specificity $Sp_{Reln} = 0.95$.\n  - Pvalb assay: Sensitivity $Se_{Pvalb} = 0.90$, Specificity $Sp_{Pvalb} = 0.98$.\n- Definitions:\n  - Panel Sensitivity: $P(\\text{classify \"Sst\"}|C_{Sst})$.\n  - Panel Specificity: $P(\\text{do not classify \"Sst\"}|C_{Pvalb})$.\n  - Youden's $J$ statistic: $J = \\text{sensitivity} + \\text{specificity} - 1$.\n- Task: Derive panel sensitivity and specificity, then compute $J$ rounded to $4$ significant figures.\n\nStep 2: Validate Using Extracted Givens.\nThe problem is scientifically grounded, using standard concepts from molecular biology, probability theory, and diagnostic test evaluation. It is well-posed, providing all necessary parameters and a clear objective. The language is objective and precise. The problem is self-contained, consistent, and requires a non-trivial application of probability theory, specifically the law of total probability and properties of conditional independence. It is a solvable problem in applied statistics.\n\nStep 3: Verdict and Action.\nThe problem is valid. A solution will be derived from first principles.\n\nLet us formalize the notation. Let $C$ be the cell type, $C \\in \\{C_{Sst}, C_{Pvalb}\\}$. For each gene $G \\in \\{Sst, Reln, Pvalb\\}$, let $T_G=1$ denote that the gene is truly expressed and $T_G=0$ that it is not. Let $O_G=1$ denote a positive assay outcome and $O_G=0$ a negative outcome.\n\nThe given probabilities for true gene expression are:\nFor a true Sst cell ($C_{Sst}$):\n$P(T_{Sst}=1|C_{Sst}) = 0.90$, $P(T_{Reln}=1|C_{Sst}) = 0.30$, $P(T_{Pvalb}=1|C_{Sst}) = 0.02$.\nFor a true Pvalb cell ($C_{Pvalb}$):\n$P(T_{Sst}=1|C_{Pvalb}) = 0.05$, $P(T_{Reln}=1|C_{Pvalb}) = 0.05$, $P(T_{Pvalb}=1|C_{Pvalb}) = 0.95$.\nSince these are Bernoulli trials, the probabilities for non-expression are:\n$P(T_G=0|C) = 1 - P(T_G=1|C)$.\n\nThe given assay performance characteristics are:\n$Se_G = P(O_G=1|T_G=1)$ and $Sp_G = P(O_G=0|T_G=0)$.\nFrom this, we have the false negative rate $P(O_G=0|T_G=1) = 1 - Se_G$ and the false positive rate $P(O_G=1|T_G=0) = 1 - Sp_G$.\nFor the Sst assay: $Se_{Sst} = 0.92$, $Sp_{Sst} = 0.97$.\nFor the Reln assay: $Se_{Reln} = 0.85$, $Sp_{Reln} = 0.95$.\nFor the Pvalb assay: $Se_{Pvalb} = 0.90$, $Sp_{Pvalb} = 0.98$.\n\nThe classification rule for \"Sst\" is the event $D = (O_{Sst}=1 \\cup O_{Reln}=1) \\cap (O_{Pvalb}=0)$.\nPanel sensitivity is $Se_{panel} = P(D|C_{Sst})$. Panel specificity is $Sp_{panel} = P(\\neg D|C_{Pvalb})$.\n\nFirst, we calculate the probability of an observed assay outcome for each gene, conditional on the cell type. We use the law of total probability, marginalizing over the true expression state $T_G$:\n$P(O_G=k|C) = P(O_G=k|T_G=1)P(T_G=1|C) + P(O_G=k|T_G=0)P(T_G=0|C)$ for $k \\in \\{0,1\\}$.\n\nFor a true Sst cell ($C_{Sst}$):\n$P(O_{Sst}=0|C_{Sst}) = (1-Se_{Sst})P(T_{Sst}=1|C_{Sst}) + Sp_{Sst}P(T_{Sst}=0|C_{Sst}) = (1-0.92)(0.90) + (0.97)(1-0.90) = (0.08)(0.90) + (0.97)(0.10) = 0.072 + 0.097 = 0.169$.\n$P(O_{Reln}=0|C_{Sst}) = (1-Se_{Reln})P(T_{Reln}=1|C_{Sst}) + Sp_{Reln}P(T_{Reln}=0|C_{Sst}) = (1-0.85)(0.30) + (0.95)(1-0.30) = (0.15)(0.30) + (0.95)(0.70) = 0.045 + 0.665 = 0.710$.\n$P(O_{Pvalb}=0|C_{Sst}) = (1-Se_{Pvalb})P(T_{Pvalb}=1|C_{Sst}) + Sp_{Pvalb}P(T_{Pvalb}=0|C_{Sst}) = (1-0.90)(0.02) + (0.98)(1-0.02) = (0.10)(0.02) + (0.98)(0.98) = 0.002 + 0.9604 = 0.9624$.\n\nNow, calculate the panel sensitivity $Se_{panel}$. The assay outcomes are conditionally independent given the cell type.\n$Se_{panel} = P((O_{Sst}=1 \\cup O_{Reln}=1) \\cap (O_{Pvalb}=0) | C_{Sst})$\n$Se_{panel} = P(O_{Sst}=1 \\cup O_{Reln}=1 | C_{Sst}) \\times P(O_{Pvalb}=0 | C_{Sst})$\nThe first term is $1 - P(O_{Sst}=0 \\cap O_{Reln}=0 | C_{Sst}) = 1 - P(O_{Sst}=0 | C_{Sst}) \\times P(O_{Reln}=0 | C_{Sst})$.\n$Se_{panel} = (1 - (0.169 \\times 0.710)) \\times 0.9624$\n$Se_{panel} = (1 - 0.11999) \\times 0.9624 = 0.88001 \\times 0.9624 \\approx 0.84692$.\n\nNext, we calculate the required probabilities for a true Pvalb cell ($C_{Pvalb}$):\n$P(O_{Sst}=0|C_{Pvalb}) = (1-Se_{Sst})P(T_{Sst}=1|C_{Pvalb}) + Sp_{Sst}P(T_{Sst}=0|C_{Pvalb}) = (0.08)(0.05) + (0.97)(0.95) = 0.004 + 0.9215 = 0.9255$.\n$P(O_{Reln}=0|C_{Pvalb}) = (1-Se_{Reln})P(T_{Reln}=1|C_{Pvalb}) + Sp_{Reln}P(T_{Reln}=0|C_{Pvalb}) = (0.15)(0.05) + (0.95)(0.95) = 0.0075 + 0.9025 = 0.9100$.\n$P(O_{Pvalb}=1|C_{Pvalb}) = Se_{Pvalb}P(T_{Pvalb}=1|C_{Pvalb}) + (1-Sp_{Pvalb})P(T_{Pvalb}=0|C_{Pvalb}) = (0.90)(0.95) + (0.02)(0.05) = 0.855 + 0.001 = 0.856$.\n\nNow, calculate the panel specificity $Sp_{panel} = P(\\neg D|C_{Pvalb})$. The event $\\neg D$ is $\\neg((O_{Sst}=1 \\cup O_{Reln}=1) \\cap (O_{Pvalb}=0))$.\nBy De Morgan's laws, $\\neg D = \\neg(O_{Sst}=1 \\cup O_{Reln}=1) \\cup \\neg(O_{Pvalb}=0) = (O_{Sst}=0 \\cap O_{Reln}=0) \\cup (O_{Pvalb}=1)$.\nLet $A = (O_{Sst}=0 \\cap O_{Reln}=0)$ and $B = (O_{Pvalb}=1)$. We need to calculate $P(A \\cup B | C_{Pvalb})$.\n$P(A \\cup B | C_{Pvalb}) = P(A | C_{Pvalb}) + P(B | C_{Pvalb}) - P(A \\cap B | C_{Pvalb})$.\nDue to conditional independence of assay outcomes:\n$P(A | C_{Pvalb}) = P(O_{Sst}=0 | C_{Pvalb}) \\times P(O_{Reln}=0 | C_{Pvalb}) = 0.9255 \\times 0.9100 = 0.842205$.\n$P(B | C_{Pvalb}) = P(O_{Pvalb}=1 | C_{Pvalb}) = 0.856$.\n$P(A \\cap B | C_{Pvalb}) = P(A|C_{Pvalb}) \\times P(B|C_{Pvalb}) = 0.842205 \\times 0.856 \\approx 0.720927$.\n$Sp_{panel} = 0.842205 + 0.856 - (0.842205 \\times 0.856)$\n$Sp_{panel} = 1.698205 - 0.72092748 = 0.97727752 \\approx 0.97728$.\n\nFinally, we compute the Youden's $J$ statistic.\n$J = Se_{panel} + Sp_{panel} - 1$.\n$J = 0.846921624 + 0.97727752 - 1$\n$J = 1.824199144 - 1 = 0.824199144$.\nRounding to $4$ significant figures, we get $J = 0.8242$.", "answer": "$$\\boxed{0.8242}$$", "id": "2705575"}, {"introduction": "Modern neuroscience is increasingly multimodal, integrating data from a cell's genome, epigenome, transcriptome, and physiology. This final practice [@problem_id:2705573] presents a realistic and challenging scenario where these modalities provide conflicting information about a neuron's identity. This exercise will test your ability to synthesize knowledge across different biological scales and time domains—from the stable epigenome to the transient transcriptome—to formulate distinct hypotheses and design rigorous experiments to distinguish among them, a capstone skill for any research scientist.", "problem": "A research group applies a multimodal single-cell workflow to inhibitory interneurons in mouse primary somatosensory cortex. One cell, captured with patch-based single-cell sequencing (Patch-seq), shows a discrepancy between transcriptomic and electrophysiological modalities: its messenger ribonucleic acid (mRNA) profile contains canonical somatostatin ($Sst$) marker transcripts, but its electrophysiology is fast-spiking with narrow action potentials and low spike-frequency adaptation, characteristic of parvalbumin ($Pvalb$) basket cells.\n\nThe group wants to decide whether this cell is best explained as a misclassified cell due to technical or analytical error, a rare hybrid type with stable co-specification of `$Sst$` and `$Pvalb$` programs, or a transient state in which a `$Pvalb$` neuron exhibits temporary `$Sst$`-like transcription.\n\nUse only foundational principles in cellular and molecular neuroscience and basic statistical inference to reason about appropriate decision criteria and validation experiments:\n\n- Central Dogma of Molecular Biology (deoxyribonucleic acid to ribonucleic acid to protein) and the causal link from ion channel protein abundance to electrophysiological phenotype via Hodgkin–Huxley-type conductances.\n- Stability of epigenetic programs over the time scale of hours to days relative to mRNA fluctuations.\n- Bayes’s rule for integrating independent evidence across modalities as likelihood factors to adjudicate between hypotheses.\n\nAssume the following empirically grounded, order-of-magnitude parameters that describe modality reliabilities and biological time scales, derived from prior benchmark studies:\n\n- A supervised classifier trained on single-cell ribonucleic acid sequencing (scRNA-seq) has an accuracy of approximately $0.95$ for distinguishing `$Sst$` versus `$Pvalb$` transcriptomic classes under low ambient ribonucleic acid conditions; in droplets with high ambient ribonucleic acid, the probability that `$Sst$` marker reads contaminate a non-`$Sst$` cell is approximately $0.05$.\n- A classifier of fast-spiking versus non-fast-spiking based on electrophysiology has an accuracy of approximately $0.98$ for mature interneurons.\n- Single-cell assay for transposase-accessible chromatin sequencing (scATAC-seq) classification of lineage-level interneuron subclasses has an accuracy of approximately $0.97$.\n- Immunostaining for Sst peptide has a sensitivity of approximately $0.90$ and a specificity of approximately $0.99$ under optimized antigen retrieval.\n- Typical half-life of interneuron mRNAs is on the order of $t_{1/2,\\text{mRNA}} \\sim 5$ hours, whereas the half-life of major voltage-gated ion channel proteins shaping fast-spiking (for example, potassium voltage-gated channel subfamily C member $1$ (Kv3.1b)) is on the order of $t_{1/2,\\text{protein}} \\sim 50$ hours.\n\nIn the focal cell, the following observations are made:\n\n- scRNA-seq reports high `$Sst$` mRNA and low `$Pvalb$` mRNA.\n- Electrophysiology shows fast-spiking typical of `$Pvalb$` neurons.\n- Immunostaining for Sst peptide on the patched cell’s cytoplasmic aspirate is negative.\n- scATAC-seq from the same nucleus shows open chromatin at `$Pvalb$`-specific enhancers with high accessibility and `$Sst$` enhancers partially accessible.\n- The lab can perform longitudinal measurements in organotypic slice at two time points separated by approximately $48$ hours using ribonucleic acid in situ hybridization (RNAscope) for `$Sst$` and `$Pvalb$` and repeated patch recordings.\n- The lab can also perform dual-recombinase fate mapping using `$Sst$`-Cre and `$Pvalb$`-Flp lines crossed to reporters, and lineage tracing with clustered regularly interspaced short palindromic repeats (CRISPR)-based barcoding.\n\nWhich option describes the most rigorous and principled set of criteria and validation experiments to distinguish among the three hypotheses—misclassification, rare hybrid type, and transient state—for this cell? Select the single best option.\n\nA. Decide by simple majority vote over modalities: because electrophysiology and scATAC-seq support Pvalb and only scRNA-seq supports Sst, label the cell Pvalb and conclude misclassification; validate only by re-clustering the scRNA-seq data without ambient ribonucleic acid correction.\n\nB. Integrate modalities with an explicit Bayesian model and time-scale reasoning to establish decision thresholds for each hypothesis, and validate with orthogonal, longitudinal, and lineage-aware assays: define three hypotheses $H_{M}$ (misclassification or sample swap), $H_{H}$ (rare hybrid type), and $H_{T}$ (transient state). For $H_{M}$, predict concordance of time-stable modalities (electrophysiology linked to ion channel protein, scATAC-seq, lineage reporters) for Pvalb along with evidence of technical contamination (ambient ribonucleic acid estimates, barcode integrity checks); for $H_{H}$, predict stable co-accessibility at Sst and Pvalb regulatory elements, stable co-expression of Sst and Pvalb transcripts and proteins across time and across multiple cells from the same lineage, and dual-recombinase intersection labeling; for $H_{T}$, predict Pvalb-aligned scATAC-seq and lineage, fast-spiking electrophysiology maintained, but transient Sst mRNA pulses that decay on the $t_{1/2,\\text{mRNA}}$ time scale without corresponding increases in Sst peptide and without sustained remodeling of electrophysiology. Set Bayes factor thresholds (for example, Bayes factor greater than $10$) using per-modality likelihoods derived from the stated accuracies, and validate by longitudinal RNAscope at $0$ and $48$ hours with repeated patch, immunostaining for Sst and Kv3.1b, ambient ribonucleic acid quantification, and dual-recombinase fate mapping plus CRISPR lineage concordance across multiple putative hybrids.\n\nC. Use unsupervised manifold embedding of combined features and call the cell a hybrid if it lies between Sst and Pvalb clusters; validate only with axonal and dendritic morphology reconstructions, because morphology reflects stable subtype identity and is sufficient to rule out transient states.\n\nD. Identify transient state solely by elevated immediate early gene expression, such as `$Fos$` and `$Arc$`, in the scRNA-seq profile; if these are high, conclude transient Sst induction in a Pvalb cell, without further need for epigenetic profiling, longitudinal measures, or technical contamination controls.\n\nAnswer choices:\n- A\n- B\n- C\n- D", "solution": "The problem statement will first be subjected to critical validation before any attempt at a solution is made.\n\n### Step 1: Extraction of Givens\n\nThe provided information is as follows:\n- **System**: Inhibitory interneurons in mouse primary somatosensory cortex.\n- **Technology**: Multimodal single-cell workflow, specifically patch-based single-cell sequencing (Patch-seq).\n- **Focal Cell Observations**:\n    - **mRNA Profile (scRNA-seq)**: Contains canonical somatostatin ($Sst$) marker transcripts; high $Sst$ mRNA and low parvalbumin ($Pvalb$) mRNA.\n    - **Electrophysiology (Ephys)**: Fast-spiking with narrow action potentials and low spike-frequency adaptation, characteristic of $Pvalb$ basket cells.\n    - **Immunostaining**: Negative for $Sst$ peptide in the cytoplasmic aspirate.\n    - **Epigenome (scATAC-seq)**: Open chromatin at $Pvalb$-specific enhancers with high accessibility; $Sst$ enhancers are partially accessible.\n- **Hypotheses to Distinguish**:\n    1.  $H_{M}$: Misclassified cell due to technical or analytical error.\n    2.  $H_{H}$: A rare, stable hybrid cell type with co-specification of $Sst$ and $Pvalb$ programs.\n    3.  $H_{T}$: A transient state where a $Pvalb$ neuron exhibits temporary $Sst$-like transcription.\n- **Required Reasoning Principles**:\n    1.  Central Dogma of Molecular Biology (DNA $\\rightarrow$ RNA $\\rightarrow$ protein) and the link from ion channel proteins to electrophysiology.\n    2.  Relative stability of epigenetic programs versus mRNA fluctuations.\n    3.  Bayes’s rule for integrating evidence.\n- **Empirical Parameters**:\n    - scRNA-seq classifier accuracy (Sst vs. Pvalb, low ambient RNA): $\\approx 0.95$.\n    - Probability of $Sst$ marker contamination in non-$Sst$ cell (high ambient RNA): $\\approx 0.05$.\n    - Ephys classifier accuracy (fast-spiking vs. non-fast-spiking): $\\approx 0.98$.\n    - scATAC-seq classifier accuracy (lineage-level): $\\approx 0.97$.\n    - $Sst$ peptide immunostaining sensitivity: $\\approx 0.90$.\n    - $Sst$ peptide immunostaining specificity: $\\approx 0.99$.\n    - mRNA half-life: $t_{1/2,\\text{mRNA}} \\sim 5$ hours.\n    - Protein half-life (e.g., Kv3.1b): $t_{1/2,\\text{protein}} \\sim 50$ hours.\n- **Available Validation Experiments**:\n    - Longitudinal measurements at $t=0$ and $t=48$ hours (RNAscope, repeated patch recordings).\n    - Dual-recombinase fate mapping ($Sst$-Cre and $Pvalb$-Flp).\n    - CRISPR-based lineage tracing.\n\n### Step 2: Validation of Problem Statement\n\nThe problem is assessed for validity based on the extracted givens.\n- **Scientifically Grounded**: The problem is firmly rooted in contemporary cellular and molecular neuroscience. The scenario of a cell with discordant multimodal data is a real and significant challenge in single-cell genomics. All concepts mentioned—Patch-seq, scRNA-seq, scATAC-seq, Central Dogma, epigenetic stability, neuronal electrophysiology, Bayesian inference, and genetic tools like Cre/Flp—are standard and accurately represented. The given parameters are plausible order-of-magnitude estimates for biological systems and experimental assays.\n- **Well-Posed**: The problem is well-posed. It presents a clear ambiguity arising from conflicting data and asks for the most rigorous method to resolve it from a set of choices. It provides sufficient information (principles, parameters, available techniques) to allow for a reasoned decision.\n- **Objective**: The language is objective and technical, free of subjective claims or bias.\n\nThe problem statement does not violate any of the specified criteria for invalidity. It is scientifically sound, formalizable, self-contained, and poses a non-trivial challenge that requires integrating concepts across different biological scales and time domains.\n\n### Step 3: Verdict and Action\n\nThe problem statement is **valid**. A solution will be derived by analyzing the options.\n\n### Derivation and Option Analysis\n\nThe core of the problem is to distinguish between three hypotheses ($H_{M}$, $H_{H}$, $H_{T}$) for a cell with conflicting identity markers: $Sst$ at the mRNA level versus $Pvalb$ at the electrophysiological level. A rigorous solution must leverage the provided principles and data.\n\nThe fundamental principles guide our reasoning:\n1.  **Central Dogma and Time Scales**: Electrophysiology is determined by the complement of ion channel proteins. Proteins have a long half-life ($t_{1/2,\\text{protein}} \\sim 50$ hours). Thus, the fast-spiking phenotype reflects a stable, integrated history of protein expression over days. In contrast, mRNA has a short half-life ($t_{1/2,\\text{mRNA}} \\sim 5$ hours), reflecting a much more recent transcriptional state. The observation of high $Sst$ mRNA but a $Pvalb$-like electrophysiology is consistent with a recent change in transcription that has not yet—and may never—translate into a change in protein composition and function. The negative $Sst$ peptide staining further supports this, as significant protein has not accumulated.\n2.  **Epigenetic Stability**: The epigenome (chromatin accessibility) is relatively stable and reflects a cell's lineage and long-term transcriptional potential. The scATAC-seq data, showing highly accessible $Pvalb$ enhancers and only partially accessible $Sst$ enhancers, suggests a primary $Pvalb$ identity or lineage commitment, with some latent or secondary potential for $Sst$ expression. This evidence weighs against a stable, fully co-specified hybrid type where both sets of enhancers would be expected to be highly and stably accessible.\n3.  **Bayesian Integration**: A formal approach would not treat each modality as an equal \"vote.\" Instead, one would use Bayes's rule to update the probability of each hypothesis given the evidence from each modality. The likelihood of an observation (e.g., fast-spiking Ephys) given a hypothesis (e.g., the cell is truly $Sst$-type) would be calculated using the given classifier accuracies (e.g., the Ephys classifier error rate, $1 - 0.98 = 0.02$). The product of these likelihoods across independent modalities, weighted by the prior probabilities of the hypotheses, determines the posterior probability.\n\nBased on these principles, let us formulate predictions for each hypothesis:\n- **$H_{M}$ (Misclassification/Error)**: Core identity is $Pvalb$. The $Sst$ mRNA is an artifact. We predict that stable features (Ephys, epigenome, lineage) will all point to $Pvalb$. There should be evidence of technical error, such as high ambient RNA levels known to cause spurious transcript detection, or discrepancies in genetic barcodes.\n- **$H_{H}$ (Stable Hybrid)**: The cell has a stable dual identity. We predict that features across all biological levels will show co-expression. The epigenome should have stably open enhancers for both $Sst$ and $Pvalb$. Both mRNAs and proteins should be consistently co-expressed. Critically, this state should be stable over time, so longitudinal measurements ($48$ hours) should show persistent co-expression. Lineage tracing should identify a population of such cells, and dual-recombinase reporters should label them.\n- **$H_{T}$ (Transient State)**: The cell has a core $Pvalb$ identity but is temporarily expressing $Sst$ mRNA. We predict that stable features (Ephys, epigenome, lineage) will be $Pvalb$-like. The $Sst$ mRNA expression will be transient and decay with its characteristic half-life of $\\sim 5$ hours. A measurement at $48$ hours (nearly $10$ half-lives) should show that the $Sst$ mRNA signal is gone, while the $Pvalb$-like Ephys is maintained. No significant $Sst$ peptide would be produced.\n\nNow we evaluate the provided options against this rigorous framework.\n\n**A. Decide by simple majority vote over modalities: because electrophysiology and scATAC-seq support Pvalb and only scRNA-seq supports Sst, label the cell Pvalb and conclude misclassification; validate only by re-clustering the scRNA-seq data without ambient ribonucleic acid correction.**\nThis approach is fundamentally flawed. A \"majority vote\" is an unprincipled heuristic that ignores the different biological meaning, time scales, and reliabilities of the data types. It incorrectly equates evidence from the stable epigenome with evidence from the dynamic transcriptome. Furthermore, to \"validate\" by re-clustering *without* ambient RNA correction is scientifically negligent; ambient RNA is a primary candidate for the technical error this option purports to identify. This method is simplistic and inadequate.\n**Verdict: Incorrect.**\n\n**B. Integrate modalities with an explicit Bayesian model and time-scale reasoning to establish decision thresholds for each hypothesis, and validate with orthogonal, longitudinal, and lineage-aware assays: define three hypotheses $H_{M}$ (misclassification or sample swap), $H_{H}$ (rare hybrid type), and $H_{T}$ (transient state). For $H_{M}$, predict concordance of time-stable modalities... for $H_{H}$, predict stable co-accessibility... for $H_{T}$, predict Pvalb-aligned scATAC-seq and lineage, fast-spiking electrophysiology maintained, but transient Sst mRNA pulses... Set Bayes factor thresholds... and validate by longitudinal RNAscope at $0$ and $48$ hours with repeated patch, immunostaining for Sst and Kv3.1b, ambient ribonucleic acid quantification, and dual-recombinase fate mapping plus CRISPR lineage concordance across multiple putative hybrids.**\nThis option proposes a comprehensive and methodologically sound strategy. It explicitly invokes the required reasoning principles: Bayesian integration (using likelihoods from given accuracies), time-scale reasoning (distinguishing stable identity from transient mRNA pulses using half-lives), and epigenetic stability. Its predictions for each hypothesis ($H_{M}$, $H_{H}$, $H_{T}$) are precise and directly follow from these principles. The proposed validation experiments are exhaustive and perfectly designed to test these predictions: longitudinal assays test for stability ($H_{H}$) versus transience ($H_{T}$); ambient RNA quantification and barcode checks test for technical error ($H_{M}$); and lineage tracing tests for the existence of a stable cell type ($H_{H}$). This represents the most rigorous and principled approach.\n**Verdict: Correct.**\n\n**C. Use unsupervised manifold embedding of combined features and call the cell a hybrid if it lies between Sst and Pvalb clusters; validate only with axonal and dendritic morphology reconstructions, because morphology reflects stable subtype identity and is sufficient to rule out transient states.**\nThis approach is insufficient. An intermediate position in a low-dimensional embedding (like UMAP or t-SNE) is an observation, not an explanation. Technical artifacts ($H_{M}$), transient states ($H_{T}$), and true hybrids ($H_{H}$) can all result in such an embedding. Relying solely on morphology for validation is a severe limitation. While morphology is a stable feature, it is only one aspect of cell type and cannot, by itself, resolve the discrepancy between the transcriptome and other modalities or rule out technical error. This option fails to engage with the temporal dynamics and multi-level nature of the problem.\n**Verdict: Incorrect.**\n\n**D. Identify transient state solely by elevated immediate early gene expression, such as Fos and Arc, in the scRNA-seq profile; if these are high, conclude transient Sst induction in a Pvalb cell, without further need for epigenetic profiling, longitudinal measures, or technical contamination controls.**\nThis is a premature and reckless conclusion. While the expression of immediate early genes (IEGs) is a marker of recent activity, it does not uniquely prove $H_{T}$. High activity could be the trigger for a transient state, but it could also be involved in the maintenance of a hybrid state ($H_{H}$). Most importantly, this option explicitly advocates for ignoring other crucial lines of inquiry. To conclude anything \"without further need\" for technical controls, epigenetic data, or longitudinal validation is antithetical to the scientific method. One must always rule out technical error ($H_{M}$) and gather sufficient evidence to distinguish competing biological hypotheses.\n**Verdict: Incorrect.**\n\nIn summary, Option B is the only one that describes a scientifically rigorous, multi-faceted, and principled approach that correctly uses all the available information and conceptual tools to address the complexity of the problem. It proposes a clear path for distinguishing between the three hypotheses through a combination of quantitative modeling and targeted validation experiments.", "answer": "$$\\boxed{B}$$", "id": "2705573"}]}