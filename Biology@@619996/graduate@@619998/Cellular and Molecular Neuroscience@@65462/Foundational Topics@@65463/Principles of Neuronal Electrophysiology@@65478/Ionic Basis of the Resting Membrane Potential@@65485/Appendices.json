{"hands_on_practices": [{"introduction": "The Goldman-Hodgkin-Katz (GHK) voltage equation is fundamental to understanding how ion concentration gradients and selective membrane permeabilities establish the resting membrane potential. Instead of simply applying the final formula, this practice challenges you to derive it from first principles, starting with the Nernst-Planck equation for ionic flux. Completing this derivation provides a robust understanding of the constant-field approximation and solidifies the physical basis of the resting potential, including its dependence on temperature [@problem_id:2719730].", "problem": "A small patch of neuronal membrane separates two well-stirred compartments whose ionic activities can be taken equal to their concentrations. The intracellular concentrations are $[ \\mathrm{K}^{+} ]_{\\mathrm{i}} = 140\\,\\mathrm{mM}$, $[ \\mathrm{Na}^{+} ]_{\\mathrm{i}} = 12\\,\\mathrm{mM}$, and $[ \\mathrm{Cl}^{-} ]_{\\mathrm{i}} = 5\\,\\mathrm{mM}$. The extracellular concentrations are $[ \\mathrm{K}^{+} ]_{\\mathrm{o}} = 5\\,\\mathrm{mM}$, $[ \\mathrm{Na}^{+} ]_{\\mathrm{o}} = 145\\,\\mathrm{mM}$, and $[ \\mathrm{Cl}^{-} ]_{\\mathrm{o}} = 120\\,\\mathrm{mM}$. The membrane is selective with relative permeabilities $P_{\\mathrm{K}} : P_{\\mathrm{Na}} : P_{\\mathrm{Cl}} = 1 : 0.04 : 0.45$. Assume monovalent charges $z_{\\mathrm{K}} = +1$, $z_{\\mathrm{Na}} = +1$, $z_{\\mathrm{Cl}} = -1$, independent ion movement, and a spatially uniform transmembrane electric field (constant-field approximation). Take the universal gas constant as $R = 8.314462618\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$ and Faraday’s constant as $F = 96485.33212\\,\\mathrm{C\\,mol^{-1}}$.\n\nStarting only from the definition of electrochemical potential for an ion $i$, $\\mu_i = \\mu_i^{0} + R T \\ln a_i + z_i F \\phi$, together with diffusive flux driven by gradients of chemical and electrical potential (Nernst–Planck framework), and the steady-state condition that the net transmembrane electrical current is zero, derive an expression for the resting membrane potential $V_{\\mathrm{m}}(T)$ as a function of temperature $T$ under these assumptions. Then use your derived expression to compute the change in resting membrane potential when the temperature decreases from $T_1 = 310\\,\\mathrm{K}$ to $T_2 = 300\\,\\mathrm{K}$. Use the inside-minus-outside sign convention for $V_{\\mathrm{m}}$. Express your final answer as the single number $\\Delta V_{\\mathrm{m}} = V_{\\mathrm{m}}(T_1) - V_{\\mathrm{m}}(T_2)$ in millivolts, with a sign, and round to three significant figures.", "solution": "The problem statement is subjected to validation.\n\n**Step 1: Extract Givens**\n- Intracellular concentrations: $[ \\mathrm{K}^{+} ]_{\\mathrm{i}} = 140\\,\\mathrm{mM}$, $[ \\mathrm{Na}^{+} ]_{\\mathrm{i}} = 12\\,\\mathrm{mM}$, $[ \\mathrm{Cl}^{-} ]_{\\mathrm{i}} = 5\\,\\mathrm{mM}$.\n- Extracellular concentrations: $[ \\mathrm{K}^{+} ]_{\\mathrm{o}} = 5\\,\\mathrm{mM}$, $[ \\mathrm{Na}^{+} ]_{\\mathrm{o}} = 145\\,\\mathrm{mM}$, $[ \\mathrm{Cl}^{-} ]_{\\mathrm{o}} = 120\\,\\mathrm{mM}$.\n- Relative permeabilities: $P_{\\mathrm{K}} : P_{\\mathrm{Na}} : P_{\\mathrm{Cl}} = 1 : 0.04 : 0.45$.\n- Ionic valences: $z_{\\mathrm{K}} = +1$, $z_{\\mathrm{Na}} = +1$, $z_{\\mathrm{Cl}} = -1$.\n- Physical constants: $R = 8.314462618\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$, $F = 96485.33212\\,\\mathrm{C\\,mol^{-1}}$.\n- Temperatures: $T_1 = 310\\,\\mathrm{K}$, $T_2 = 300\\,\\mathrm{K}$.\n- Assumptions:\n  - Ionic activities are equal to concentrations ($a_i = [I]_i$).\n  - Independent ion movement.\n  - Constant-field approximation.\n- Foundational definitions:\n  - Electrochemical potential: $\\mu_i = \\mu_i^{0} + R T \\ln a_i + z_i F \\phi$.\n  - Diffusive flux driven by gradients of electrochemical potential (Nernst-Planck framework).\n  - Steady-state condition: Net transmembrane electrical current is zero.\n- Sign convention: Membrane potential $V_{\\mathrm{m}} = V_{\\mathrm{in}} - V_{\\mathrm{out}}$.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is a well-defined exercise in quantitative biophysics. It asks for the derivation of the Goldman-Hodgkin-Katz (GHK) voltage equation from first principles—the Nernst-Planck equation—and its subsequent application.\n- **Scientifically Grounded:** The problem is based on the established Nernst-Planck and GHK formalisms, which are cornerstone models in electrophysiology. The ionic concentrations and permeabilities are physiologically realistic for a typical neuron.\n- **Well-Posed:** All necessary parameters (concentrations, permeabilities, temperatures, constants) are provided. The task is clearly specified, leading to a unique analytical expression and numerical answer.\n- **Objective:** The problem is stated in precise, quantitative terms, free from any subjectivity or ambiguity.\n\n**Step 3: Verdict and Action**\nThe problem is valid. A rigorous solution will be developed.\n\nThe problem requires the derivation of the resting membrane potential, $V_{\\mathrm{m}}$, from the Nernst-Planck framework under the constant-field assumption.\n\nThe total ionic current across the membrane, $I_m$, is the sum of the currents carried by each ion, $I_m = \\sum_i I_i$. At the resting potential, this total current is zero. The GHK current equation for an ion species $i$ with valence $z_i$ gives its current $I_i$ as:\n$$ I_i = P_i \\frac{z_i^2 F^2 V_m}{RT} \\frac{[I]_i - [I]_o \\exp(-z_i F V_m / RT)}{1 - \\exp(-z_i F V_m / RT)} $$\nwhere $P_i$ is the permeability, and $[I]_i$ and $[I]_o$ are the intracellular and extracellular concentrations, respectively.\n\nAt steady state ($V_m = V_{\\text{rest}}$), the sum of currents is zero:\n$$ \\sum_i I_i = I_K + I_{Na} + I_{Cl} = 0 $$\nLet $u = F V_{\\text{rest}} / RT$. The sum of currents is:\n$$ P_K \\frac{[K]_i - [K]_o e^{-u}}{1-e^{-u}} + P_{Na} \\frac{[Na]_i - [Na]_o e^{-u}}{1-e^{-u}} + P_{Cl} \\frac{(-1)^2([Cl]_i - [Cl]_o e^{-(-1)u})}{1 - e^{-(-1)u}} = 0 $$\nThe common pre-factor $\\frac{F^2 V_{\\text{rest}}}{RT}$ is omitted as we assume $V_{\\text{rest}} \\neq 0$.\nThe chloride term simplifies:\n$$ P_{Cl} \\frac{[Cl]_i - [Cl]_o e^{u}}{1-e^{u}} = P_{Cl} \\frac{[Cl]_i - [Cl]_o e^{u}}{-e^u(1-e^{-u})} = P_{Cl} \\frac{[Cl]_o - [Cl]_i e^{-u}}{1-e^{-u}} $$\nNow, all terms have the common denominator $(1-e^{-u})$. We can sum the numerators and set the result to zero:\n$$ P_K([K]_i - [K]_o e^{-u}) + P_{Na}([Na]_i - [Na]_o e^{-u}) + P_{Cl}([Cl]_o - [Cl]_i e^{-u}) = 0 $$\nGroup terms with and without the exponential factor:\n$$ P_K[K]_i + P_{Na}[Na]_i + P_{Cl}[Cl]_o = e^{-u} (P_K[K]_o + P_{Na}[Na]_o + P_{Cl}[Cl]_i) $$\nSolving for $e^{-u}$:\n$$ e^{-u} = \\exp\\left(-\\frac{FV_{\\mathrm{m}}}{RT}\\right) = \\frac{P_{\\mathrm{K}}[\\mathrm{K}^{+}]_{\\mathrm{i}} + P_{\\mathrm{Na}}[\\mathrm{Na}^{+}]_{\\mathrm{i}} + P_{\\mathrm{Cl}}[\\mathrm{Cl}^{-}]_{\\mathrm{o}}}{P_{\\mathrm{K}}[\\mathrm{K}^{+}]_{\\mathrm{o}} + P_{\\mathrm{Na}}[\\mathrm{Na}^{+}]_{\\mathrm{o}} + P_{\\mathrm{Cl}}[\\mathrm{Cl}^{-}]_{\\mathrm{i}}} $$\nSolving for $V_{\\mathrm{m}}$ and inverting the argument of the logarithm to remove the negative sign gives the Goldman-Hodgkin-Katz voltage equation:\n$$ V_{\\mathrm{m}}(T) = \\frac{RT}{F} \\ln\\left( \\frac{P_{\\mathrm{K}}[\\mathrm{K}^{+}]_{\\mathrm{o}} + P_{\\mathrm{Na}}[\\mathrm{Na}^{+}]_{\\mathrm{o}} + P_{\\mathrm{Cl}}[\\mathrm{Cl}^{-}]_{\\mathrm{i}}}{P_{\\mathrm{K}}[\\mathrm{K}^{+}]_{\\mathrm{i}} + P_{\\mathrm{Na}}[\\mathrm{Na}^{+}]_{\\mathrm{i}} + P_{\\mathrm{Cl}}[\\mathrm{Cl}^{-}]_{\\mathrm{o}}} \\right) $$\nThis is the required expression for $V_{\\mathrm{m}}(T)$.\n\nNow we compute the change in membrane potential, $\\Delta V_{\\mathrm{m}} = V_{\\mathrm{m}}(T_1) - V_{\\mathrm{m}}(T_2)$. The logarithmic term is a constant factor independent of temperature. Let us denote it by $X$:\n$$ X = \\frac{P_{\\mathrm{K}}[\\mathrm{K}^{+}]_{\\mathrm{o}} + P_{\\mathrm{Na}}[\\mathrm{Na}^{+}]_{\\mathrm{o}} + P_{\\mathrm{Cl}}[\\mathrm{Cl}^{-}]_{\\mathrm{i}}}{P_{\\mathrm{K}}[\\mathrm{K}^{+}]_{\\mathrm{i}} + P_{\\mathrm{Na}}[\\mathrm{Na}^{+}]_{\\mathrm{i}} + P_{\\mathrm{Cl}}[\\mathrm{Cl}^{-}]_{\\mathrm{o}}} $$\nWe can use the relative permeabilities directly, setting $P_{\\mathrm{K}}=1$, $P_{\\mathrm{Na}}=0.04$, and $P_{\\mathrm{Cl}}=0.45$. The absolute permeability unit would cancel in the ratio.\nThe numerator is:\n$$ (1)(5) + (0.04)(145) + (0.45)(5) = 5 + 5.8 + 2.25 = 13.05 $$\nThe denominator is:\n$$ (1)(140) + (0.04)(12) + (0.45)(120) = 140 + 0.48 + 54 = 194.48 $$\nSo, $X = \\frac{13.05}{194.48}$.\n\nThe change in potential is:\n$$ \\Delta V_{\\mathrm{m}} = V_{\\mathrm{m}}(T_1) - V_{\\mathrm{m}}(T_2) = \\frac{R T_1}{F} \\ln(X) - \\frac{R T_2}{F} \\ln(X) $$\n$$ \\Delta V_{\\mathrm{m}} = \\frac{R}{F} (T_1 - T_2) \\ln(X) $$\nSubstituting the given values:\n$R = 8.314462618\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$\n$F = 96485.33212\\,\\mathrm{C\\,mol^{-1}}$\n$T_1 = 310\\,\\mathrm{K}$\n$T_2 = 300\\,\\mathrm{K}$\n$T_1 - T_2 = 10\\,\\mathrm{K}$\n$$ \\Delta V_{\\mathrm{m}} = \\frac{8.314462618}{96485.33212} (10) \\ln\\left(\\frac{13.05}{194.48}\\right) $$\n$$ \\Delta V_{\\mathrm{m}} \\approx (8.61733 \\times 10^{-5} \\,\\mathrm{V\\,K^{-1}}) \\times (10\\,\\mathrm{K}) \\times \\ln(0.0671016) $$\n$$ \\Delta V_{\\mathrm{m}} \\approx (8.61733 \\times 10^{-4} \\,\\mathrm{V}) \\times (-2.701605) $$\n$$ \\Delta V_{\\mathrm{m}} \\approx -0.00232795\\,\\mathrm{V} $$\nThe problem requires the answer in millivolts ($1\\,\\mathrm{V} = 1000\\,\\mathrm{mV}$):\n$$ \\Delta V_{\\mathrm{m}} \\approx -2.32795\\,\\mathrm{mV} $$\nRounding to three significant figures, we obtain:\n$$ \\Delta V_{\\mathrm{m}} \\approx -2.33\\,\\mathrm{mV} $$\nThe negative sign indicates that the resting membrane potential becomes slightly less negative (depolarizes) as the temperature decreases.", "answer": "$$\\boxed{-2.33}$$", "id": "2719730"}, {"introduction": "While passive ion fluxes are key, the neuronal resting state is a dynamic equilibrium actively maintained by pumps. This practice advances our model by incorporating the electrogenic $Na^+/K^+$-ATPase, which generates a net outward current, alongside the passive leak currents for $K^{+}$, $Na^{+}$, and $Cl^{-}$. By developing a computational model to solve for the steady-state potential, you will explore how ion pump activity shapes the resting potential and gain insight into the cellular mechanisms of pathophysiological states such as hyperkalemia and ischemia [@problem_id:2719726].", "problem": "You are tasked with writing a complete, runnable program that computes the resting membrane potential (RMP) of a single isopotential neuronal compartment under a set of pathophysiological perturbations. The ionic basis is modeled from first principles using electrochemical potentials, linear passive ionic leaks, and an electrogenic sodium-potassium adenosine triphosphatase ($Na^+/K^+$-ATPase) pump with saturable kinetics. You must derive the governing equation from foundational laws and implement it to solve for the membrane potential that satisfies steady-state charge balance. The final outputs must be provided in millivolts (mV), rounded to three decimal places.\n\nFoundational biophysical base to be used:\n- Chemical potential of an ideal dilute ionic species: the electrochemical potential difference across a membrane for species $i$ of valence $z_i$ is given by\n  $$\\Delta \\mu_i = \\mu_{i,\\text{outside}} - \\mu_{i,\\text{inside}} = RT \\ln\\left(\\frac{[i]_\\text{outside}}{[i]_\\text{inside}}\\right) + z_i F V,$$\n  where $R$ is the universal gas constant ($R = 8.314462618\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$), $T$ is the absolute temperature in Kelvin, $F$ is Faraday’s constant ($F = 96485.33212\\,\\mathrm{C\\,mol^{-1}}$), and $V$ is the transmembrane electric potential (inside minus outside, in volts).\n- Definition of reversal potential for an ionic species $i$ under which its net electrochemical driving force is zero:\n  $$\\Delta \\mu_i = 0 \\quad \\Rightarrow \\quad RT \\ln\\!\\left(\\frac{[i]_\\text{outside}}{[i]_\\text{inside}}\\right) + z_i F E_i = 0,$$\n  which defines the voltage $E_i$ where there is no net flux for species $i$.\n- Ohmic leak current for species $i$ with membrane conductance $g_i$:\n  $$I_i = g_i \\left(V - E_i\\right),$$\n  with the sign convention that positive current is outward positive charge.\n- Electrogenic $Na^+/K^+$-ATPase pump current, with stoichiometry exporting $3$ sodium ions and importing $2$ potassium ions per cycle (net $+1$ outward charge per cycle), represented phenomenologically by saturable Hill-type dependencies on intracellular sodium and extracellular potassium:\n  $$I_{\\text{pump}} = \\frac{I_{\\max}}{\\left(1 + \\left(\\frac{K_{\\mathrm{m,Na}}}{[\\mathrm{Na}]_\\text{inside}}\\right)^3\\right)\\left(1 + \\left(\\frac{K_{\\mathrm{m,K}}}{[\\mathrm{K}]_\\text{outside}}\\right)^2\\right)},$$\n  where $I_{\\max}$ is the maximal pump current (outward positive), $K_{\\mathrm{m,Na}}$ and $K_{\\mathrm{m,K}}$ are Michaelis constants.\n\nDefinition of the resting state:\n- The resting state is defined by steady-state charge balance (no net accumulation of charge), which requires the algebraic sum of all transmembrane currents to be zero:\n  $$I_{\\mathrm{K}} + I_{\\mathrm{Na}} + I_{\\mathrm{Cl}} + I_{\\text{pump}} = 0.$$\n- You must solve for the unique membrane potential $V$ (in volts) that satisfies this condition, given the parameters.\n\nUnits and conversions to be used:\n- Concentrations $[i]$ in millimoles per liter ($\\mathrm{mM}$).\n- Conductances $g_i$ in nanosiemens ($\\mathrm{nS}$). Convert to siemens by $g_i^{(\\mathrm{S})} = g_i^{(\\mathrm{nS})} \\times 10^{-9}$.\n- Currents in picoamperes ($\\mathrm{pA}$) for $I_{\\max}$ and the computed $I_{\\text{pump}}$. Convert to amperes by $I^{(\\mathrm{A})} = I^{(\\mathrm{pA})} \\times 10^{-12}$.\n- Potentials must be reported in millivolts ($\\mathrm{mV}$). Convert volts to millivolts by $V^{(\\mathrm{mV})} = V^{(\\mathrm{V})} \\times 10^{3}$.\n- Temperature: $T$ in Kelvin.\n\nAngle units are not applicable. All numerical answers must be expressed as floating-point numbers in millivolts (mV), rounded to three decimal places.\n\nYour program must implement the following for each test case:\n1. Compute $E_{\\mathrm{K}}$, $E_{\\mathrm{Na}}$, and $E_{\\mathrm{Cl}}$ from first principles by enforcing $\\Delta \\mu_i = 0$ for each ion to determine $E_i$ as above, using $z_{\\mathrm{K}} = +1$, $z_{\\mathrm{Na}} = +1$, $z_{\\mathrm{Cl}} = -1$.\n2. Compute the pump current $I_{\\text{pump}}$ using the saturable expression above and the given parameters.\n3. Enforce steady-state charge balance $I_{\\mathrm{K}} + I_{\\mathrm{Na}} + I_{\\mathrm{Cl}} + I_{\\text{pump}} = 0$ and solve for the unique $V$ that satisfies this, with $I_i = g_i (V - E_i)$ for each ion.\n4. Report the corresponding resting membrane potential $V$ in millivolts, rounded to three decimal places.\n\nTest suite:\nFor all cases use $T = 310.15\\,\\mathrm{K}$ unless stated otherwise. For each case, all unspecified values retain the case’s explicitly provided values (each case below is fully specified; do not inherit from other cases). The concentration bracket notation $[\\cdot]$ refers to millimoles per liter.\n\n- Case 1 (Baseline control):\n  - $[\\mathrm{K}]_\\text{outside} = 4$, $[\\mathrm{K}]_\\text{inside} = 140$.\n  - $[\\mathrm{Na}]_\\text{outside} = 145$, $[\\mathrm{Na}]_\\text{inside} = 12$.\n  - $[\\mathrm{Cl}]_\\text{outside} = 120$, $[\\mathrm{Cl}]_\\text{inside} = 15$.\n  - $g_{\\mathrm{K}} = 20$, $g_{\\mathrm{Na}} = 4$, $g_{\\mathrm{Cl}} = 7$ (all in $\\mathrm{nS}$).\n  - $I_{\\max} = 50$ (in $\\mathrm{pA}$), $K_{\\mathrm{m,Na}} = 10$, $K_{\\mathrm{m,K}} = 1.5$ (both in $\\mathrm{mM}$).\n  - $T = 310.15$.\n- Case 2 (Acute hyperkalemia):\n  - $[\\mathrm{K}]_\\text{outside} = 8$, $[\\mathrm{K}]_\\text{inside} = 140$.\n  - $[\\mathrm{Na}]_\\text{outside} = 145$, $[\\mathrm{Na}]_\\text{inside} = 12$.\n  - $[\\mathrm{Cl}]_\\text{outside} = 120$, $[\\mathrm{Cl}]_\\text{inside} = 15$.\n  - $g_{\\mathrm{K}} = 20$, $g_{\\mathrm{Na}} = 4$, $g_{\\mathrm{Cl}} = 7$.\n  - $I_{\\max} = 50$, $K_{\\mathrm{m,Na}} = 10$, $K_{\\mathrm{m,K}} = 1.5$.\n  - $T = 310.15$.\n- Case 3 (Pump inhibition by ouabain/hypoxia):\n  - $[\\mathrm{K}]_\\text{outside} = 4$, $[\\mathrm{K}]_\\text{inside} = 140$.\n  - $[\\mathrm{Na}]_\\text{outside} = 145$, $[\\mathrm{Na}]_\\text{inside} = 12$.\n  - $[\\mathrm{Cl}]_\\text{outside} = 120$, $[\\mathrm{Cl}]_\\text{inside} = 15$.\n  - $g_{\\mathrm{K}} = 20$, $g_{\\mathrm{Na}} = 4$, $g_{\\mathrm{Cl}} = 7$.\n  - $I_{\\max} = 0$, $K_{\\mathrm{m,Na}} = 10$, $K_{\\mathrm{m,K}} = 1.5$.\n  - $T = 310.15$.\n- Case 4 (Intracellular chloride accumulation, e.g., cotransporter dysregulation):\n  - $[\\mathrm{K}]_\\text{outside} = 4$, $[\\mathrm{K}]_\\text{inside} = 140$.\n  - $[\\mathrm{Na}]_\\text{outside} = 145$, $[\\mathrm{Na}]_\\text{inside} = 12$.\n  - $[\\mathrm{Cl}]_\\text{outside} = 120$, $[\\mathrm{Cl}]_\\text{inside} = 30$.\n  - $g_{\\mathrm{K}} = 20$, $g_{\\mathrm{Na}} = 4$, $g_{\\mathrm{Cl}} = 7$.\n  - $I_{\\max} = 50$, $K_{\\mathrm{m,Na}} = 10$, $K_{\\mathrm{m,K}} = 1.5$.\n  - $T = 310.15$.\n- Case 5 (Severe ischemia-like mixed perturbation):\n  - $[\\mathrm{K}]_\\text{outside} = 12$, $[\\mathrm{K}]_\\text{inside} = 140$.\n  - $[\\mathrm{Na}]_\\text{outside} = 145$, $[\\mathrm{Na}]_\\text{inside} = 20$.\n  - $[\\mathrm{Cl}]_\\text{outside} = 120$, $[\\mathrm{Cl}]_\\text{inside} = 20$.\n  - $g_{\\mathrm{K}} = 18$, $g_{\\mathrm{Na}} = 6$, $g_{\\mathrm{Cl}} = 7$.\n  - $I_{\\max} = 10$, $K_{\\mathrm{m,Na}} = 10$, $K_{\\mathrm{m,K}} = 1.5$.\n  - $T = 310.15$.\n- Case 6 (Boundary case: no chloride conductance):\n  - $[\\mathrm{K}]_\\text{outside} = 4$, $[\\mathrm{K}]_\\text{inside} = 140$.\n  - $[\\mathrm{Na}]_\\text{outside} = 145$, $[\\mathrm{Na}]_\\text{inside} = 12$.\n  - $[\\mathrm{Cl}]_\\text{outside} = 120$, $[\\mathrm{Cl}]_\\text{inside} = 15$.\n  - $g_{\\mathrm{K}} = 20$, $g_{\\mathrm{Na}} = 4$, $g_{\\mathrm{Cl}} = 0$.\n  - $I_{\\max} = 50$, $K_{\\mathrm{m,Na}} = 10$, $K_{\\mathrm{m,K}} = 1.5$.\n  - $T = 310.15$.\n\nProgram output specification:\n- For each case, compute the resting membrane potential $V$ in millivolts (mV), rounded to three decimal places.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[$v_1$,$v_2$,$v_3$,$v_4$,$v_5$,$v_6$]\"), where each $v_i$ is a floating-point number with exactly three digits after the decimal point and in units of millivolts (mV).", "solution": "The problem statement has been evaluated and is determined to be valid. It is scientifically grounded in established principles of cellular electrophysiology, mathematically well-posed, and provides a complete and unambiguous set of parameters and conditions for its solution. No logical contradictions, factual inaccuracies, or unscientific premises are present. We may proceed with the solution.\n\nThe fundamental principle governing the resting membrane potential ($V$) is the condition of steady-state charge balance. This dictates that the algebraic sum of all transmembrane ionic currents must be zero, as there can be no net accumulation of charge across the membrane capacitor over time. The total current, $I_{\\text{total}}$, is the sum of the individual leak currents for potassium ($I_{\\mathrm{K}}$), sodium ($I_{\\mathrm{Na}}$), and chloride ($I_{\\mathrm{Cl}}$), and the current generated by the electrogenic $Na^+/K^+$-ATPase pump ($I_{\\text{pump}}$).\n\nThe steady-state condition is therefore expressed as:\n$$I_{\\mathrm{total}} = I_{\\mathrm{K}} + I_{\\mathrm{Na}} + I_{\\mathrm{Cl}} + I_{\\text{pump}} = 0$$\n\nEach component of this equation is defined as follows:\n\n1.  **Reversal (Nernst) Potentials, $E_i$**: The reversal potential for an ionic species $i$ is the membrane potential at which the net electrochemical driving force is zero. This is derived from the condition $\\Delta \\mu_i = 0$:\n    $$RT \\ln\\left(\\frac{[i]_{\\text{outside}}}{[i]_{\\text{inside}}}\\right) + z_i F E_i = 0$$\n    Solving for $E_i$ yields the Nernst equation:\n    $$E_i = -\\frac{RT}{z_i F} \\ln\\left(\\frac{[i]_{\\text{outside}}}{[i]_{\\text{inside}}}\\right) = \\frac{RT}{z_i F} \\ln\\left(\\frac{[i]_{\\text{inside}}}{[i]_{\\text{outside}}}\\right)$$\n    Here, $R$ is the universal gas constant, $T$ is the absolute temperature, $F$ is Faraday's constant, and $z_i$ is the valence of the ion ($z_{\\mathrm{K}}=+1$, $z_{\\mathrm{Na}}=+1$, $z_{\\mathrm{Cl}}=-1$). These potentials must be computed for K⁺, Na⁺, and Cl⁻ using the provided intracellular and extracellular concentrations for each case.\n\n2.  **Ohmic Leak Currents, $I_i$**: The passive flux of each ion through its respective channel is modeled as an Ohmic current, where the current is proportional to the electrochemical driving force, $(V - E_i)$. The proportionality constant is the membrane conductance, $g_i$.\n    $$I_i = g_i (V - E_i)$$\n    This expression will be used for $I_{\\mathrm{K}}$, $I_{\\mathrm{Na}}$, and $I_{\\mathrm{Cl}}$.\n\n3.  **Pump Current, $I_{\\text{pump}}$**: The $Na^+/K^+$-ATPase pump current is given by a phenomenological model with saturable kinetics dependent on substrate availability (intracellular Na⁺ and extracellular K⁺).\n    $$I_{\\text{pump}} = \\frac{I_{\\max}}{\\left(1 + \\left(\\frac{K_{\\mathrm{m,Na}}}{[\\mathrm{Na}]_{\\text{inside}}}\\right)^3\\right)\\left(1 + \\left(\\frac{K_{\\mathrm{m,K}}}{[\\mathrm{K}]_{\\text{outside}}}\\right)^2\\right)}$$\n    For any given set of concentrations and pump parameters, $I_{\\text{pump}}$ is a constant value independent of the membrane potential $V$. By convention, this is an outward flux of positive charge, so it is a positive current.\n\nSubstituting the expressions for the individual currents into the charge balance equation gives:\n$$g_{\\mathrm{K}}(V - E_{\\mathrm{K}}) + g_{\\mathrm{Na}}(V - E_{\\mathrm{Na}}) + g_{\\mathrm{Cl}}(V - E_{\\mathrm{Cl}}) + I_{\\text{pump}} = 0$$\n\nThis is a linear equation in the single unknown variable, $V$. We can solve for $V$ by algebraic rearrangement. First, group the terms containing $V$:\n$$V(g_{\\mathrm{K}} + g_{\\mathrm{Na}} + g_{\\mathrm{Cl}}) - (g_{\\mathrm{K}}E_{\\mathrm{K}} + g_{\\mathrm{Na}}E_{\\mathrm{Na}} + g_{\\mathrm{Cl}}E_{\\mathrm{Cl}}) + I_{\\text{pump}} = 0$$\n\nIsolating $V$ yields the solution:\n$$V(g_{\\mathrm{K}} + g_{\\mathrm{Na}} + g_{\\mathrm{Cl}}) = g_{\\mathrm{K}}E_{\\mathrm{K}} + g_{\\mathrm{Na}}E_{\\mathrm{Na}} + g_{\\mathrm{Cl}}E_{\\mathrm{Cl}} - I_{\\text{pump}}$$\n$$V = \\frac{g_{\\mathrm{K}}E_{\\mathrm{K}} + g_{\\mathrm{Na}}E_{\\mathrm{Na}} + g_{\\mathrm{Cl}}E_{\\mathrm{Cl}} - I_{\\text{pump}}}{g_{\\mathrm{K}} + g_{\\mathrm{Na}} + g_{\\mathrm{Cl}}}$$\nThis equation is a form of the Millman equation, modified to include a constant current source, $I_{\\text{pump}}$.\n\nThe computational procedure is as follows:\n1.  For each test case, define all parameters: ionic concentrations, conductances, pump parameters, and temperature.\n2.  Ensure all parameters are converted to a consistent system of units. The International System of Units (SI) is the only logical choice: potentials in Volts (V), conductances in Siemens (S), currents in Amperes (A), temperature in Kelvin (K), and concentrations in moles per litre (mol/L) for the Nernst equation (though millimolar (mM) ratios are sufficient as they are dimensionless).\n    - $g_i^{(\\mathrm{S})} = g_i^{(\\mathrm{nS})} \\times 10^{-9}$\n    - $I_{\\max}^{(\\mathrm{A})} = I_{\\max}^{(\\mathrm{pA})} \\times 10^{-12}$\n3.  Calculate the Nernst potentials $E_{\\mathrm{K}}$, $E_{\\mathrm{Na}}$, and $E_{\\mathrm{Cl}}$ in Volts.\n4.  Calculate the pump current $I_{\\text{pump}}$ in Amperes.\n5.  Substitute the calculated reversal potentials, pump current, and given conductances into the derived equation for $V$. The result will be in Volts.\n6.  Convert the final membrane potential $V$ from Volts to millivolts ($V^{(\\mathrm{mV})} = V^{(\\mathrm{V})} \\times 10^3$) and round to three decimal places as specified.\n\nThis procedure will be implemented for each of the six provided test cases.", "answer": "```python\nimport numpy as np\n\n# A solver agent that generates a solution and final answer for a given problem.\n# This is the problem you'll be working on:\n# You are tasked with writing a complete, runnable program that computes the resting membrane potential (RMP) of a single isopotential neuronal compartment under a set of pathophysiological perturbations. The ionic basis is modeled from first principles using electrochemical potentials, linear passive ionic leaks, and an electrogenic sodium-potassium adenosine triphosphatase ($Na^+/K^+$-ATPase) pump with saturable kinetics. You must derive the governing equation from foundational laws and implement it to solve for the membrane potential that satisfies steady-state charge balance. The final outputs must be provided in millivolts (mV), rounded to three decimal places.\n# \n# Foundational biophysical base to be used:\n# - Chemical potential of an ideal dilute ionic species: the electrochemical potential difference across a membrane for species $i$ of valence $z_i$ is given by\n#   $$\\Delta \\mu_i = \\mu_{i,\\text{outside}} - \\mu_{i,\\text{inside}} = RT \\ln\\left(\\frac{[i]_\\text{outside}}{[i]_\\text{inside}}\\right) + z_i F V,$$\n#   where $R$ is the universal gas constant ($R = 8.314462618\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$), $T$ is the absolute temperature in Kelvin, $F$ is Faraday’s constant ($F = 96485.33212\\,\\mathrm{C\\,mol^{-1}}$), and $V$ is the transmembrane electric potential (inside minus outside, in volts).\n# - Definition of reversal potential for an ionic species $i$ under which its net electrochemical driving force is zero:\n#   $$\\Delta \\mu_i = 0 \\quad \\Rightarrow \\quad RT \\ln\\!\\left(\\frac{[i]_\\text{outside}}{[i]_\\text{inside}}\\right) + z_i F E_i = 0,$$\n#   which defines the voltage $E_i$ where there is no net flux for species $i$.\n# - Ohmic leak current for species $i$ with membrane conductance $g_i$:\n#   $$I_i = g_i \\left(V - E_i\\right),$$\n#   with the sign convention that positive current is outward positive charge.\n# - Electrogenic $Na^+/K^+$-ATPase pump current, with stoichiometry exporting $3$ sodium ions and importing $2$ potassium ions per cycle (net $+1$ outward charge per cycle), represented phenomenologically by saturable Hill-type dependencies on intracellular sodium and extracellular potassium:\n#   $$I_{\\text{pump}} = \\frac{I_{\\max}}{\\left(1 + \\left(\\frac{K_{\\mathrm{m,Na}}}{[\\mathrm{Na}]_\\text{inside}}\\right)^3\\right)\\left(1 + \\left(\\frac{K_{\\mathrm{m,K}}}{[\\mathrm{K}]_\\text{outside}}\\right)^2\\right)},$$\n#   where $I_{\\max}$ is the maximal pump current (outward positive), $K_{\\mathrm{m,Na}}$ and $K_{\\mathrm{m,K}}$ are Michaelis constants.\n# \n# Definition of the resting state:\n# - The resting state is defined by steady-state charge balance (no net accumulation of charge), which requires the algebraic sum of all transmembrane currents to be zero:\n#   $$I_{\\mathrm{K}} + I_{\\mathrm{Na}} + I_{\\mathrm{Cl}} + I_{\\text{pump}} = 0.$$\n# - You must solve for the unique membrane potential $V$ (in volts) that satisfies this condition, given the parameters.\n# \n# Units and conversions to be used:\n# - Concentrations $[i]$ in millimoles per liter ($\\mathrm{mM}$).\n# - Conductances $g_i$ in nanosiemens ($\\mathrm{nS}$). Convert to siemens by $g_i^{(\\mathrm{S})} = g_i^{(\\mathrm{nS})} \\times 10^{-9}$.\n# - Currents in picoamperes ($\\mathrm{pA}$) for $I_{\\max}$ and the computed $I_{\\text{pump}}$. Convert to amperes by $I^{(\\mathrm{A})} = I^{(\\mathrm{pA})} \\times 10^{-12}$.\n# - Potentials must be reported in millivolts ($\\mathrm{mV}$). Convert volts to millivolts by $V^{(\\mathrm{mV})} = V^{(\\mathrm{V})} \\times 10^{3}$.\n# - Temperature: $T$ in Kelvin.\n# \n# Angle units are not applicable. All numerical answers must be expressed as floating-point numbers in millivolts (mV), rounded to three decimal places.\n# \n# Your program must implement the following for each test case:\n# 1. Compute $E_{\\mathrm{K}}$, $E_{\\mathrm{Na}}$, and $E_{\\mathrm{Cl}}$ from first principles by enforcing $\\Delta \\mu_i = 0$ for each ion to determine $E_i$ as above, using $z_{\\mathrm{K}} = +1$, $z_{\\mathrm{Na}} = +1$, $z_{\\mathrm{Cl}} = -1$.\n# 2. Compute the pump current $I_{\\text{pump}}$ using the saturable expression above and the given parameters.\n# 3. Enforce steady-state charge balance $I_{\\mathrm{K}} + I_{\\mathrm{Na}} + I_{\\mathrm{Cl}} + I_{\\text{pump}} = 0$ and solve for the unique $V$ that satisfies this, with $I_i = g_i (V - E_i)$ for each ion.\n# 4. Report the corresponding resting membrane potential $V$ in millivolts, rounded to three decimal places.\n# \n# Test suite:\n# For all cases use $T = 310.15\\,\\mathrm{K}$ unless stated otherwise. For each case, all unspecified values retain the case’s explicitly provided values (each case below is fully specified; do not inherit from other cases). The concentration bracket notation $[\\cdot]$ refers to millimoles per liter.\n# \n# - Case 1 (Baseline control):\n#   - $[\\mathrm{K}]_\\text{outside} = 4$, $[\\mathrm{K}]_\\text{inside} = 140$.\n#   - $[\\mathrm{Na}]_\\text{outside} = 145$, $[\\mathrm{Na}]_\\text{inside} = 12$.\n#   - $[\\mathrm{Cl}]_\\text{outside} = 120$, $[\\mathrm{Cl}]_\\text{inside} = 15$.\n#   - $g_{\\mathrm{K}} = 20$, $g_{\\mathrm{Na}} = 4$, $g_{\\mathrm{Cl}} = 7$ (all in $\\mathrm{nS}$).\n#   - $I_{\\max} = 50$ (in $\\mathrm{pA}$), $K_{\\mathrm{m,Na}} = 10$, $K_{\\mathrm{m,K}} = 1.5$ (both in $\\mathrm{mM}$).\n#   - $T = 310.15$.\n# - Case 2 (Acute hyperkalemia):\n#   - $[\\mathrm{K}]_\\text{outside} = 8$, $[\\mathrm{K}]_\\text{inside} = 140$.\n#   - $[\\mathrm{Na}]_\\text{outside} = 145$, $[\\mathrm{Na}]_\\text{inside} = 12$.\n#   - $[\\mathrm{Cl}]_\\text{outside} = 120$, $[\\mathrm{Cl}]_\\text{inside} = 15$.\n#   - $g_{\\mathrm{K}} = 20$, $g_{\\mathrm{Na}} = 4$, $g_{\\mathrm{Cl}} = 7$.\n#   - $I_{\\max} = 50$, $K_{\\mathrm{m,Na}} = 10$, $K_{\\mathrm{m,K}} = 1.5$.\n#   - $T = 310.15$.\n# - Case 3 (Pump inhibition by ouabain/hypoxia):\n#   - $[\\mathrm{K}]_\\text{outside} = 4$, $[\\mathrm{K}]_\\text{inside} = 140$.\n#   - $[\\mathrm{Na}]_\\text{outside} = 145$, $[\\mathrm{Na}]_\\text{inside} = 12$.\n#   - $[\\mathrm{Cl}]_\\text{outside} = 120$, $[\\mathrm{Cl}]_\\text{inside} = 15$.\n#   - $g_{\\mathrm{K}} = 20$, $g_{\\mathrm{Na}} = 4$, $g_{\\mathrm{Cl}} = 7$.\n#   - $I_{\\max} = 0$, $K_{\\mathrm{m,Na}} = 10$, $K_{\\mathrm{m,K}} = 1.5$.\n#   - $T = 310.15$.\n# - Case 4 (Intracellular chloride accumulation, e.g., cotransporter dysregulation):\n#   - $[\\mathrm{K}]_\\text{outside} = 4$, $[\\mathrm{K}]_\\text{inside} = 140$.\n#   - $[\\mathrm{Na}]_\\text{outside} = 145$, $[\\mathrm{Na}]_\\text{inside} = 12$.\n#   - $[\\mathrm{Cl}]_\\text{outside} = 120$, $[\\mathrm{Cl}]_\\text{inside} = 30$.\n#   - $g_{\\mathrm{K}} = 20$, $g_{\\mathrm{Na}} = 4$, $g_{\\mathrm{Cl}} = 7$.\n#   - $I_{\\max} = 50$, $K_{\\mathrm{m,Na}} = 10$, $K_{\\mathrm{m,K}} = 1.5$.\n#   - $T = 310.15$.\n# - Case 5 (Severe ischemia-like mixed perturbation):\n#   - $[\\mathrm{K}]_\\text{outside} = 12$, $[\\mathrm{K}]_\\text{inside} = 140$.\n#   - $[\\mathrm{Na}]_\\text{outside} = 145$, $[\\mathrm{Na}]_\\text{inside} = 20$.\n#   - $[\\mathrm{Cl}]_\\text{outside} = 120$, $[\\mathrm{Cl}]_\\text{inside} = 20$.\n#   - $g_{\\mathrm{K}} = 18$, $g_{\\mathrm{Na}} = 6$, $g_{\\mathrm{Cl}} = 7$.\n#   - $I_{\\max} = 10$, $K_{\\mathrm{m,Na}} = 10$, $K_{\\mathrm{m,K}} = 1.5$.\n#   - $T = 310.15$.\n# - Case 6 (Boundary case: no chloride conductance):\n#   - $[\\mathrm{K}]_\\text{outside} = 4$, $[\\mathrm{K}]_\\text{inside} = 140$.\n#   - $[\\mathrm{Na}]_\\text{outside} = 145$, $[\\mathrm{Na}]_\\text{inside} = 12$.\n#   - $[\\mathrm{Cl}]_\\text{outside} = 120$, $[\\mathrm{Cl}]_\\text{inside} = 15$.\n#   - $g_{\\mathrm{K}} = 20$, $g_{\\mathrm{Na}} = 4$, $g_{\\mathrm{Cl}} = 0$.\n#   - $I_{\\max} = 50$, $K_{\\mathrm{m,Na}} = 10$, $K_{\\mathrm{m,K}} = 1.5$.\n#   - $T = 310.15$.\n# \n# Program output specification:\n# - For each case, compute the resting membrane potential $V$ in millivolts (mV), rounded to three decimal places.\n# - Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[$v_1$,$v_2$,$v_3$,$v_4$,$v_5$,$v_6$]\"), where each $v_i$ is a floating-point number with exactly three digits after the decimal point and in units of millivolts (mV).\ndef compute_rmp(params):\n    \"\"\"\n    Computes the resting membrane potential (V_m) for a single neuronal compartment.\n    \"\"\"\n    # Biophysical constants\n    R = 8.314462618  # J mol^-1 K^-1\n    F = 96485.33212  # C mol^-1\n\n    # Extract parameters from the dictionary\n    T = params['T']\n    k_out, k_in = params['K_conc']\n    na_out, na_in = params['Na_conc']\n    cl_out, cl_in = params['Cl_conc']\n    \n    # Unit conversion from nS to S\n    g_k = params['g_K'] * 1e-9\n    g_na = params['g_Na'] * 1e-9\n    g_cl = params['g_Cl'] * 1e-9\n    \n    # Unit conversion from pA to A\n    I_max = params['I_max'] * 1e-12\n    \n    K_m_Na = params['K_m_Na']\n    K_m_K = params['K_m_K']\n    \n    # Valences of the ions\n    z_k, z_na, z_cl = 1, 1, -1\n    \n    # Calculate the thermal voltage term RT/F in Volts\n    rt_over_f = (R * T) / F\n    \n    # 1. Compute Nernst potentials (E_i) in Volts\n    E_k = (rt_over_f / z_k) * np.log(k_out / k_in)\n    E_na = (rt_over_f / z_na) * np.log(na_out / na_in)\n    E_cl = (rt_over_f / z_cl) * np.log(cl_out / cl_in)\n\n    # 2. Compute pump current (I_pump) in Amperes\n    pump_denom_na = 1 + (K_m_Na / na_in)**3\n    pump_denom_k = 1 + (K_m_K / k_out)**2\n    I_pump = I_max / (pump_denom_na * pump_denom_k)\n\n    # 3. Solve for the membrane potential V in Volts\n    # V = (g_K*E_K + g_Na*E_Na + g_Cl*E_Cl - I_pump) / (g_K + g_Na + g_Cl)\n    g_total = g_k + g_na + g_cl\n    \n    if g_total == 0:\n        # This case should not occur with the given problem data, but it handles division by zero.\n        # If total conductance is zero, no defined membrane potential in this model.\n        return np.nan \n\n    numerator = (g_k * E_k) + (g_na * E_na) + (g_cl * E_cl) - I_pump\n    V_volts = numerator / g_total\n    \n    # 4. Convert to millivolts and round to three decimal places\n    V_mv = V_volts * 1000\n    \n    return V_mv\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1 (Baseline control)\n        {\n            'K_conc': (4, 140), 'Na_conc': (145, 12), 'Cl_conc': (120, 15),\n            'g_K': 20, 'g_Na': 4, 'g_Cl': 7,\n            'I_max': 50, 'K_m_Na': 10, 'K_m_K': 1.5,\n            'T': 310.15\n        },\n        # Case 2 (Acute hyperkalemia)\n        {\n            'K_conc': (8, 140), 'Na_conc': (145, 12), 'Cl_conc': (120, 15),\n            'g_K': 20, 'g_Na': 4, 'g_Cl': 7,\n            'I_max': 50, 'K_m_Na': 10, 'K_m_K': 1.5,\n            'T': 310.15\n        },\n        # Case 3 (Pump inhibition)\n        {\n            'K_conc': (4, 140), 'Na_conc': (145, 12), 'Cl_conc': (120, 15),\n            'g_K': 20, 'g_Na': 4, 'g_Cl': 7,\n            'I_max': 0, 'K_m_Na': 10, 'K_m_K': 1.5,\n            'T': 310.15\n        },\n        # Case 4 (Intracellular chloride accumulation)\n        {\n            'K_conc': (4, 140), 'Na_conc': (145, 12), 'Cl_conc': (120, 30),\n            'g_K': 20, 'g_Na': 4, 'g_Cl': 7,\n            'I_max': 50, 'K_m_Na': 10, 'K_m_K': 1.5,\n            'T': 310.15\n        },\n        # Case 5 (Severe ischemia-like mixed perturbation)\n        {\n            'K_conc': (12, 140), 'Na_conc': (145, 20), 'Cl_conc': (120, 20),\n            'g_K': 18, 'g_Na': 6, 'g_Cl': 7,\n            'I_max': 10, 'K_m_Na': 10, 'K_m_K': 1.5,\n            'T': 310.15\n        },\n        # Case 6 (Boundary case: no chloride conductance)\n        {\n            'K_conc': (4, 140), 'Na_conc': (145, 12), 'Cl_conc': (120, 15),\n            'g_K': 20, 'g_Na': 4, 'g_Cl': 0,\n            'I_max': 50, 'K_m_Na': 10, 'K_m_K': 1.5,\n            'T': 310.15\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        result = compute_rmp(case)\n        # Round the final result before formatting\n        rounded_result = round(result, 3)\n        results.append(f\"{rounded_result:.3f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "2719726"}, {"introduction": "The resting potential is not an instantaneous value but the stable equilibrium of a dynamic system. This hands-on practice explores the temporal dimension by modeling the membrane as a Resistor-Capacitor (RC) circuit, where ion channels act as resistors and the lipid bilayer as a capacitor. By calculating the membrane time constant ($\\tau$) and simulating the voltage trajectory, you will develop a crucial intuition for how the passive properties of a neuron govern the speed of potential changes and the temporal integration of signals [@problem_id:2719729].", "problem": "A single isopotential neuronal compartment has passive leak pathways for monovalent potassium, sodium, and chloride ions and behaves electrically as a parallel resistor-capacitor (RC) element. Starting from fundamental physicochemical definitions, derive and implement a program that computes the resting membrane potential and its approach dynamics under the following assumptions.\n\nFundamental base and modeling assumptions:\n- Electrochemical potential for an ion species with valence $z$ is $$ \\mu = \\mu^0 + RT \\ln([X]) + z F V $$, where $R$ is the universal gas constant, $T$ is absolute temperature in Kelvin, $F$ is Faraday's constant, $[X]$ is concentration, and $V$ is membrane potential.\n- Under the constant-field approximation for a thin membrane, ionic flux is proportional to permeability and the electrochemical driving force across the membrane. The resting membrane potential $V_{\\text{rest}}$ is the steady-state solution in which the net ionic current is zero for the specified permeabilities and concentrations.\n- The membrane behaves as a capacitor with capacitance $C_m$ charged by ionic currents. Kirchhoff's Current Law (KCL) gives $$ C_m \\, dV/dt = - I_{\\text{ion}}(V) $$. Near rest, with a passive, parallel-leak approximation, the total leak conductance $g_{\\text{total}}$ is taken as constant, leading to first-order RC dynamics toward $V_{\\text{rest}}$.\n- Do not use any pre-given shortcut formulae in the derivation; use the above fundamental definitions to arrive at the expressions your program implements.\n\nTasks for each test case:\n1. Compute the resting membrane potential $V_{\\text{rest}}$ (in mV) for three monovalent ions potassium, sodium, and chloride, given intracellular concentrations $[K]_i$, $[Na]_i$, $[Cl]_i$ (in mM), extracellular concentrations $[K]_o$, $[Na]_o$, $[Cl]_o$ (in mM), absolute temperature $T$ (in K), and relative permeabilities $P_K$, $P_{Na}$, $P_{Cl}$ (dimensionless, only ratios matter). Use the constant-field result appropriate for these conditions.\n2. Compute the membrane RC time constant $\\tau$ (in ms) from total leak conductance $g_{\\text{total}}$ (in nS) and membrane capacitance $C_m$ (in nF).\n3. Given an initial membrane potential $V_0$ (in mV) at $t=0$, and a time $t_1$ (in ms), compute $V(t_1)$ (in mV) under the passive RC approach to $V_{\\text{rest}}$ implied by the above assumptions.\n4. Compute $t_{95}$ (in ms), the time required for $|V(t) - V_{\\text{rest}}|$ to decay to a fraction $0.05$ of its initial value $|V_0 - V_{\\text{rest}}|$ under the same dynamics.\n\nConstants to use in all computations:\n- Universal gas constant: $R = 8.314462618 \\ \\text{J} \\cdot \\text{mol}^{-1} \\cdot \\text{K}^{-1}$.\n- Faraday constant: $F = 96485.33212 \\ \\text{C} \\cdot \\text{mol}^{-1}$.\n\nUnits and numerical requirements:\n- Express $V_{\\text{rest}}$ and $V(t_1)$ in mV, $\\tau$ and $t_{95}$ in ms.\n- Round each reported float to exactly three decimal places.\n- If a value rounds to negative zero, report it as $0.000$.\n\nTest suite:\nProvide outputs for the following four test cases. Each case lists $(T, [K]_i, [K]_o, [Na]_i, [Na]_o, [Cl]_i, [Cl]_o, P_K, P_{Na}, P_{Cl}, g_{\\text{total}}, C_m, V_0, t_1)$ with units $(\\text{K}, \\text{mM}, \\text{mM}, \\text{mM}, \\text{mM}, \\text{mM}, \\text{mM}, -, -, -, \\text{nS}, \\text{nF}, \\text{mV}, \\text{ms})$:\n- Case 1 (typical mammalian neuron leak mix): $(310.15, 140.0, 5.0, 12.0, 145.0, 4.0, 120.0, 1.0, 0.04, 0.45, 10.0, 0.1, -90.0, 5.0)$.\n- Case 2 (symmetric concentrations, ohmic relaxation): $(310.15, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 1.0, 0.1, 0.1, 20.0, 0.2, 50.0, 10.0)$.\n- Case 3 (high chloride permeability): $(310.15, 140.0, 5.0, 12.0, 145.0, 4.0, 120.0, 1.0, 0.04, 10.0, 5.0, 0.05, -30.0, 10.0)$.\n- Case 4 (large leak conductance, fast membrane): $(310.15, 140.0, 4.0, 15.0, 145.0, 10.0, 110.0, 1.0, 0.05, 0.2, 100.0, 0.1, 0.0, 1.0)$.\n\nFinal output specification:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. The list must contain one entry per test case in the same order as above. Each entry must itself be a list of four floats in the order $[V_{\\text{rest}}\\ \\text{(mV)}, \\ \\tau\\ \\text{(ms)}, \\ V(t_1)\\ \\text{(mV)}, \\ t_{95}\\ \\text{(ms)}]$, rounded as specified. For example, an output with two hypothetical cases would look like $[[a,b,c,d],[e,f,g,h]]$.", "solution": "The problem presented is a well-posed and scientifically sound exercise in fundamental cellular biophysics. It requires the derivation and application of the Goldman-Hodgkin-Katz (GHK) equation for the resting membrane potential and the analysis of membrane voltage dynamics using a simplified linear resistor-capacitor (RC) model. We shall proceed by deriving the necessary formulae from the first principles specified in the problem statement.\n\n**1. Derivation of the Resting Membrane Potential ($V_{\\text{rest}}$)**\n\nThe resting membrane potential, $V_{\\text{rest}}$, is the steady-state membrane potential $V$ at which the total ionic current $I_{\\text{ion}}$ flowing across the membrane is zero. The total current is the sum of the individual currents for potassium ($K^+$), sodium ($Na^+$), and chloride ($Cl^-$) ions.\n$$ I_{\\text{ion}}(V) = I_K(V) + I_{Na}(V) + I_{Cl}(V) = 0 $$\nThe problem states that the GHK constant-field approximation is to be used. The GHK current equation for an ion species $S$ with valence $z_S$ and permeability $P_S$ is given by:\n$$ I_S = P_S \\frac{z_S^2 F^2 V}{RT} \\frac{[S]_i - [S]_o e^{-z_S F V / RT}}{1 - e^{-z_S F V / RT}} $$\nwhere $R$ is the universal gas constant, $T$ is the absolute temperature, $F$ is Faraday's constant, $[S]_i$ is the intracellular concentration, and $[S]_o$ is the extracellular concentration.\n\nFor the monovalent cations $K^+$ and $Na^+$, the valence is $z_{K} = z_{Na} = +1$.\nFor the monovalent anion $Cl^-$, the valence is $z_{Cl} = -1$.\n\nSubstituting these valences into the GHK current equation, we obtain the individual currents:\n$$ I_K = P_K \\frac{F^2 V}{RT} \\frac{[K^+]_i - [K^+]_o e^{-FV/RT}}{1 - e^{-FV/RT}} $$\n$$ I_{Na} = P_{Na} \\frac{F^2 V}{RT} \\frac{[Na^+]_i - [Na^+]_o e^{-FV/RT}}{1 - e^{-FV/RT}} $$\n$$ I_{Cl} = P_{Cl} \\frac{(-1)^2 F^2 V}{RT} \\frac{[Cl^-]_i - [Cl^-]_o e^{-(-1)FV/RT}}{1 - e^{-(-1)FV/RT}} = P_{Cl} \\frac{F^2 V}{RT} \\frac{[Cl^-]_i - [Cl^-]_o e^{FV/RT}}{1 - e^{FV/RT}} $$\nAt rest ($V = V_{\\text{rest}}$), the sum of these currents is zero. Assuming $V_{\\text{rest}} \\neq 0$, the common pre-factor $\\frac{F^2 V}{RT}$ can be eliminated.\n$$ P_K \\frac{[K^+]_i - [K^+]_o e^{-FV_{\\text{rest}}/RT}}{1 - e^{-FV_{\\text{rest}}/RT}} + P_{Na} \\frac{[Na^+]_i - [Na^+]_o e^{-FV_{\\text{rest}}/RT}}{1 - e^{-FV_{\\text{rest}}/RT}} + P_{Cl} \\frac{[Cl^-]_i - [Cl^-]_o e^{FV_{\\text{rest}}/RT}}{1 - e^{FV_{\\text{rest}}/RT}} = 0 $$\nTo combine these terms, we rewrite the chloride term's denominator: $1 - e^{FV_{\\text{rest}}/RT} = -e^{FV_{\\text{rest}}/RT}(1 - e^{-FV_{\\text{rest}}/RT})$. The chloride term becomes:\n$$ P_{Cl} \\frac{[Cl^-]_i - [Cl^-]_o e^{FV_{\\text{rest}}/RT}}{-e^{FV_{\\text{rest}}/RT}(1 - e^{-FV_{\\text{rest}}/RT})} = -P_{Cl} \\frac{[Cl^-]_i e^{-FV_{\\text{rest}}/RT} - [Cl^-]_o}{1 - e^{-FV_{\\text{rest}}/RT}} = P_{Cl} \\frac{[Cl^-]_o - [Cl^-]_i e^{-FV_{\\text{rest}}/RT}}{1 - e^{-FV_{\\text{rest}}/RT}} $$\nNow, all terms share a common denominator $(1 - e^{-FV_{\\text{rest}}/RT})$. Summing the numerators and setting them to zero gives:\n$$ P_K([K^+]_i - [K^+]_o e^{-FV_{\\text{rest}}/RT}) + P_{Na}([Na^+]_i - [Na^+]_o e^{-FV_{\\text{rest}}/RT}) + P_{Cl}([Cl^-]_o - [Cl^-]_i e^{-FV_{\\text{rest}}/RT}) = 0 $$\nGroup terms with and without the exponential factor:\n$$ P_K[K^+]_i + P_{Na}[Na^+]_i + P_{Cl}[Cl^-]_o = (P_K[K^+]_o + P_{Na}[Na^+]_o + P_{Cl}[Cl^-]_i) e^{-FV_{\\text{rest}}/RT} $$\nSolving for the exponential term:\n$$ e^{-FV_{\\text{rest}}/RT} = \\frac{P_K[K^+]_i + P_{Na}[Na^+]_i + P_{Cl}[Cl^-]_o}{P_K[K^+]_o + P_{Na}[Na^+]_o + P_{Cl}[Cl^-]_i} $$\nTaking the natural logarithm and solving for $V_{\\text{rest}}$:\n$$ -\\frac{FV_{\\text{rest}}}{RT} = \\ln\\left(\\frac{P_K[K^+]_i + P_{Na}[Na^+]_i + P_{Cl}[Cl^-]_o}{P_K[K^+]_o + P_{Na}[Na^+]_o + P_{Cl}[Cl^-]_i}\\right) $$\n$$ V_{\\text{rest}} = -\\frac{RT}{F} \\ln\\left(\\frac{P_K[K^+]_i + P_{Na}[Na^+]_i + P_{Cl}[Cl^-]_o}{P_K[K^+]_o + P_{Na}[Na^+]_o + P_{Cl}[Cl^-]_i}\\right) $$\nThis can be written more conventionally by inverting the argument of the logarithm:\n$$ V_{\\text{rest}} = \\frac{RT}{F} \\ln\\left(\\frac{P_K[K^+]_o + P_{Na}[Na^+]_o + P_{Cl}[Cl^-]_i}{P_K[K^+]_i + P_{Na}[Na^+]_i + P_{Cl}[Cl^-]_o}\\right) $$\nThis is the GHK voltage equation, which will be implemented. The result is in Volts and must be converted to millivolts ($mV$) by multiplying by $1000$.\n\n**2. Derivation of the Membrane Time Constant ($\\tau$)**\n\nThe membrane is modeled as an RC circuit, governed by the differential equation:\n$$ C_m \\frac{dV}{dt} = -I_{\\text{ion}}(V) $$\nwhere $C_m$ is the membrane capacitance. Near the resting potential $V_{\\text{rest}}$, the ionic current $I_{\\text{ion}}(V)$ can be linearized using a first-order Taylor expansion:\n$$ I_{\\text{ion}}(V) \\approx I_{\\text{ion}}(V_{\\text{rest}}) + (V - V_{\\text{rest}}) \\frac{dI_{\\text{ion}}}{dV}\\bigg|_{V=V_{\\text{rest}}} $$\nBy definition, $I_{\\text{ion}}(V_{\\text{rest}}) = 0$. The derivative of current with respect to voltage at rest is the total membrane conductance, $g_{\\text{total}}$:\n$$ g_{\\text{total}} = \\frac{dI_{\\text{ion}}}{dV}\\bigg|_{V=V_{\\text{rest}}} $$\nThus, the linearized current is $I_{\\text{ion}}(V) \\approx g_{\\text{total}}(V - V_{\\text{rest}})$. Substituting this into the RC equation:\n$$ C_m \\frac{dV}{dt} = -g_{\\text{total}}(V - V_{\\text{rest}}) $$\nRearranging to the standard form of a first-order linear ODE:\n$$ \\frac{dV}{dt} = -\\frac{g_{\\text{total}}}{C_m}(V - V_{\\text{rest}}) $$\nThis equation describes an exponential approach to $V_{\\text{rest}}$ with a time constant $\\tau$. By inspection, the time constant is:\n$$ \\tau = \\frac{C_m}{g_{\\text{total}}} $$\nThe problem provides $C_m$ in nanofarads ($10^{-9}\\,\\text{F}$) and $g_{\\text{total}}$ in nanosiemens ($10^{-9}\\,\\text{S}$). Their ratio yields a result in seconds, which must be converted to milliseconds:\n$$ \\tau [s] = \\frac{C_m [\\text{in F}]}{g_{\\text{total}} [\\text{in S}]} = \\frac{C_m [\\text{in nF}] \\times 10^{-9}}{g_{\\text{total}} [\\text{in nS}] \\times 10^{-9}} = \\frac{C_m [\\text{in nF}]}{g_{\\text{total}} [\\text{in nS}]} $$\n$$ \\tau [ms] = 1000 \\times \\tau [s] $$\n\n**3. Derivation of the Membrane Potential at time $t_1$, $V(t_1)$**\n\nThe ODE for voltage dynamics is $\\frac{dV}{dt} = -\\frac{1}{\\tau}(V - V_{\\text{rest}})$. Let $y(t) = V(t) - V_{\\text{rest}}$. Then $\\frac{dy}{dt} = \\frac{dV}{dt}$, and the equation becomes $\\frac{dy}{dt} = -\\frac{1}{\\tau}y$. The solution is $y(t) = y(0)e^{-t/\\tau}$. Substituting back for $V(t)$:\n$$ V(t) - V_{\\text{rest}} = (V(0) - V_{\\text{rest}})e^{-t/\\tau} $$\nGiven an initial potential $V_0$ at $t=0$, we have $V(0) = V_0$. The potential at any time $t$ is:\n$$ V(t) = V_{\\text{rest}} + (V_0 - V_{\\text{rest}})e^{-t/\\tau} $$\nThis formula will be used to calculate $V(t_1)$ with $t=t_1$. All potentials ($V(t_1)$, $V_{\\text{rest}}$, $V_0$) are in $mV$, and time ($t_1$, $\\tau$) is in $ms$.\n\n**4. Derivation of the Time to $95\\%$ Decay, $t_{95}$**\n\nWe need to find the time $t_{95}$ at which the deviation from rest, $|V(t) - V_{\\text{rest}}|$, has decayed to $5\\%$ ($0.05$) of its initial value, $|V_0 - V_{\\text{rest}}|$.\n$$ |V(t_{95}) - V_{\\text{rest}}| = 0.05 \\times |V_0 - V_{\\text{rest}}| $$\nFrom the solution for $V(t) - V_{\\text{rest}}$, we have:\n$$ |V(t) - V_{\\text{rest}}| = |V_0 - V_{\\text{rest}}| e^{-t/\\tau} $$\nSubstituting this into the condition for $t_{95}$:\n$$ |V_0 - V_{\\text{rest}}| e^{-t_{95}/\\tau} = 0.05 \\times |V_0 - V_{\\text{rest}}| $$\nAssuming $V_0 \\neq V_{\\text{rest}}$, we can divide by the initial deviation:\n$$ e^{-t_{95}/\\tau} = 0.05 $$\nSolving for $t_{95}$ by taking the natural logarithm:\n$$ -\\frac{t_{95}}{\\tau} = \\ln(0.05) $$\n$$ t_{95} = -\\tau \\ln(0.05) $$\nThis expression provides $t_{95}$ in $ms$, given that $\\tau$ is in $ms$. Note that $t_{95}$ is independent of the initial conditions $V_0$ and $V_{\\text{rest}}$, provided they are not equal.\n$\\ln(0.05) \\approx -2.99573$, so $t_{95} \\approx 2.99573\\tau$.\nThese derived formulae are now implemented to solve the given test cases.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for neuronal membrane properties based on the Goldman-Hodgkin-Katz\n    model and passive RC circuit dynamics.\n    \"\"\"\n    # Define physical constants\n    R = 8.314462618  # Universal gas constant (J K^-1 mol^-1)\n    F = 96485.33212  # Faraday constant (C mol^-1)\n    \n    # Pre-calculate ln(0.05) for efficiency\n    LN_0_05 = np.log(0.05)\n\n    # Define the test cases from the problem statement.\n    # Each case: (T, [K]i, [K]o, [Na]i, [Na]o, [Cl]i, [Cl]o, P_K, P_Na, P_Cl, g_total, C_m, V0, t1)\n    # Units: (K, mM, mM, mM, mM, mM, mM, -, -, -, nS, nF, mV, ms)\n    test_cases = [\n        (310.15, 140.0, 5.0, 12.0, 145.0, 4.0, 120.0, 1.0, 0.04, 0.45, 10.0, 0.1, -90.0, 5.0),\n        (310.15, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 1.0, 0.1, 0.1, 20.0, 0.2, 50.0, 10.0),\n        (310.15, 140.0, 5.0, 12.0, 145.0, 4.0, 120.0, 1.0, 0.04, 10.0, 5.0, 0.05, -30.0, 10.0),\n        (310.15, 140.0, 4.0, 15.0, 145.0, 10.0, 110.0, 1.0, 0.05, 0.2, 100.0, 0.1, 0.0, 1.0),\n    ]\n\n    all_results = []\n    \n    for case in test_cases:\n        T, K_i, K_o, Na_i, Na_o, Cl_i, Cl_o, P_K, P_Na, P_Cl, g_total, C_m, V0, t1 = case\n\n        # Task 1: Compute resting membrane potential V_rest (in mV)\n        # using the Goldman-Hodgkin-Katz (GHK) voltage equation.\n        # V_rest = (RT/F) * ln( (P_K[K]o + P_Na[Na]o + P_Cl[Cl]i) / (P_K[K]i + P_Na[Na]i + P_Cl[Cl]o) )\n        ghk_numerator = P_K * K_o + P_Na * Na_o + P_Cl * Cl_i\n        ghk_denominator = P_K * K_i + P_Na * Na_i + P_Cl * Cl_o\n\n        if ghk_denominator == 0:\n            # Physically unrealistic case, but handle to avoid division by zero.\n            v_rest_volts = np.inf if ghk_numerator > 0 else 0\n        else:\n            ratio = ghk_numerator / ghk_denominator\n            if ratio = 0:\n                # Also an edge case, log is undefined for non-positive values.\n                v_rest_volts = -np.inf if ratio  0 else 0\n            else:\n                v_rest_volts = (R * T / F) * np.log(ratio)\n        \n        v_rest = v_rest_volts * 1000.0  # Convert volts to millivolts\n\n        # Task 2: Compute membrane RC time constant tau (in ms)\n        # tau = (C_m / g_total)\n        # Units: (nF / nS) = s. To get ms, multiply by 1000.\n        if g_total == 0:\n            tau = np.inf\n        else:\n            tau = (C_m / g_total) * 1000.0\n\n        # Task 3: Compute V(t1) (in mV) under passive RC dynamics\n        # V(t) = V_rest + (V0 - V_rest) * exp(-t/tau)\n        if np.isinf(tau):\n            v_t1 = V0  # If tau is infinite, voltage does not change\n        elif tau == 0:\n            v_t1 = v_rest # If tau is zero, system equilibrates instantly\n        else:\n            v_t1 = v_rest + (V0 - v_rest) * np.exp(-t1 / tau)\n        \n        # Task 4: Compute t95 (in ms), time to reach 5% of initial deviation\n        # t_95 = -tau * ln(0.05)\n        if V0 == v_rest:\n            t_95 = 0.0 # Already at rest, time is zero.\n        elif np.isinf(tau):\n            t_95 = np.inf # If tau is infinite, it never decays.\n        else:\n            t_95 = -tau * LN_0_05\n            \n        # Helper for formatting output to 3 decimal places and handling -0.000\n        def custom_format(val):\n            # Format to a string with exactly 3 decimal places\n            formatted_str = f\"{val:.3f}\"\n            # Correct for \"negative zero\" representation\n            if formatted_str == \"-0.000\":\n                return \"0.000\"\n            return formatted_str\n\n        all_results.append([\n            custom_format(v_rest),\n            custom_format(tau),\n            custom_format(v_t1),\n            custom_format(t_95),\n        ])\n\n    # Format the final output string exactly as specified in the problem.\n    # e.g., [[-73.090,10.000,-83.346,29.957],[-87.408,10.000,-66.289,29.957]]\n    formatted_sublists = [f\"[{','.join(res)}]\" for res in all_results]\n    final_output_string = f\"[{','.join(formatted_sublists)}]\"\n    \n    print(final_output_string)\n\nsolve()\n```", "id": "2719729"}]}