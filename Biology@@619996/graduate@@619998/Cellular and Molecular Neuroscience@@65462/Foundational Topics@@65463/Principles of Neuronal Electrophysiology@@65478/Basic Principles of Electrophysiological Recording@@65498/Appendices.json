{"hands_on_practices": [{"introduction": "Before exploring a neuron's complex active properties, we must first characterize its passive electrical landscape. This foundational exercise [@problem_id:2699753] treats the neuron as a simple Resistor-Capacitor (RC) circuit, a powerful first approximation. By analyzing the voltage response to a simple current injection, you will learn to derive and calculate the fundamental passive parameters of membrane resistance ($R_m$) and capacitance ($C_m$), which dictate how a neuron integrates synaptic inputs over time.", "problem": "A neuron soma is recorded in whole-cell current clamp and is well-approximated near rest as a passive, isopotential Resistive–Capacitive (RC) membrane: a linear leak conductance in parallel with a membrane capacitance. Assume there are no active voltage-dependent conductances over the time course considered and that series resistance is negligible. A square current step of amplitude $100\\ \\text{pA}$ is injected from a steady resting potential, producing a steady-state depolarization of $\\Delta V = 10\\ \\text{mV}$. The voltage trajectory following step onset rises monotonically, reaching $63\\%$ of its steady-state amplitude in $5\\ \\text{ms}$.\n\nUsing only first principles (Kirchhoff’s current law applied to a capacitor in parallel with a linear leak), derive the expressions needed to determine the membrane resistance $R_m$ and the membrane capacitance $C_m$ from these measurements, and then compute their numerical values. Express $R_m$ in megaohms (M$\\Omega$) and $C_m$ in nanofarads (nF). Round your answers to $3$ significant figures. Your final answer should be two numbers in the order $R_m$, $C_m$ with the specified units applied outside the boxed values.", "solution": "The problem requires the determination of membrane resistance $R_m$ and capacitance $C_m$ from electrophysiological measurements, based on a passive, isopotential Resistive-Capacitive (RC) circuit model of a neuron. We begin from first principles, specifically Kirchhoff's current law.\n\nThe total injected current, $I_{inj}$, is constant for time $t \\ge 0$. This current distributes between the resistive (leak) pathway, $I_R$, and the capacitive pathway, $I_C$. According to Kirchhoff's current law, at any time $t$:\n$$I_{inj} = I_R(t) + I_C(t)$$\nLet $V(t)$ represent the change in membrane potential from its resting value, such that the initial condition is $V(0) = 0$. The current through the linear leak resistance $R_m$ is described by Ohm's Law:\n$$I_R(t) = \\frac{V(t)}{R_m}$$\nThe current that charges the membrane capacitance $C_m$ is given by the definition of capacitance:\n$$I_C(t) = C_m \\frac{dV(t)}{dt}$$\nSubstituting these expressions for $I_R(t)$ and $I_C(t)$ into Kirchhoff's law yields a first-order linear ordinary differential equation for the membrane potential $V(t)$:\n$$I_{inj} = \\frac{V(t)}{R_m} + C_m \\frac{dV(t)}{dt}$$\nThis equation can be arranged into the standard form for a first-order system:\n$$R_m C_m \\frac{dV(t)}{dt} + V(t) = I_{inj} R_m$$\nWe define the membrane time constant as $\\tau_m = R_m C_m$. The equation becomes:\n$$\\tau_m \\frac{dV(t)}{dt} + V(t) = I_{inj} R_m$$\nThe general solution to this differential equation with the initial condition $V(0) = 0$ for a constant $I_{inj}$ applied at $t=0$ is an exponential charging curve:\n$$V(t) = I_{inj} R_m \\left(1 - \\exp\\left(-\\frac{t}{\\tau_m}\\right)\\right)$$\nTo find the parameters $R_m$ and $C_m$, we use the two pieces of information provided about the voltage response.\n\nFirst, we consider the steady-state condition ($t \\to \\infty$). As $t$ becomes very large, the term $\\exp(-t/\\tau_m)$ approaches $0$, and the voltage $V(t)$ approaches a constant steady-state value, $V_{ss}$:\n$$V_{ss} = \\lim_{t \\to \\infty} V(t) = I_{inj} R_m$$\nThe problem states that the steady-state depolarization is $\\Delta V = 10 \\text{ mV}$, which corresponds to $V_{ss}$. The injected current is given as $I_{inj} = 100 \\text{ pA}$. From these values, we derive the expression for the membrane resistance $R_m$:\n$$R_m = \\frac{V_{ss}}{I_{inj}}$$\nWe substitute the given numerical values, ensuring consistent units (Volts, Amperes, Ohms):\n$$R_m = \\frac{10 \\times 10^{-3} \\text{ V}}{100 \\times 10^{-12} \\text{ A}} = \\frac{1 \\times 10^{-2} \\text{ V}}{1 \\times 10^{-10} \\text{ A}} = 1 \\times 10^8 \\text{ }\\Omega$$\nThe result is requested in megaohms ($1 \\text{ M}\\Omega = 10^6 \\text{ }\\Omega$):\n$$R_m = \\frac{1 \\times 10^8 \\text{ }\\Omega}{10^6 \\text{ }\\Omega/\\text{M}\\Omega} = 100 \\text{ M}\\Omega$$\nThis is an exact value. To present it with $3$ significant figures, it is $1.00 \\times 10^2 \\text{ M}\\Omega$.\n\nSecond, we analyze the transient response. The problem states that the voltage reaches $63\\%$ of its steady-state amplitude at time $t' = 5 \\text{ ms}$. We use this to find the time constant $\\tau_m$.\n$$V(t') = 0.63 \\times V_{ss}$$\nSubstituting this into the derived solution for $V(t)$:\n$$0.63 \\times V_{ss} = V_{ss} \\left(1 - \\exp\\left(-\\frac{t'}{\\tau_m}\\right)\\right)$$\nDividing by $V_{ss}$ (which is non-zero) and rearranging gives:\n$$\\exp\\left(-\\frac{t'}{\\tau_m}\\right) = 1 - 0.63 = 0.37$$\nTo solve for $\\tau_m$, we take the natural logarithm of both sides:\n$$-\\frac{t'}{\\tau_m} = \\ln(0.37)$$\n$$\\tau_m = -\\frac{t'}{\\ln(0.37)}$$\nSubstituting $t' = 5 \\text{ ms} = 5 \\times 10^{-3} \\text{ s}$:\n$$\\tau_m = -\\frac{5 \\times 10^{-3} \\text{ s}}{\\ln(0.37)} \\approx -\\frac{5 \\times 10^{-3} \\text{ s}}{-0.9942518} \\approx 5.0289 \\times 10^{-3} \\text{ s}$$\nNow, using the definition of the time constant, $\\tau_m = R_m C_m$, we can derive the expression for the membrane capacitance $C_m$:\n$$C_m = \\frac{\\tau_m}{R_m}$$\nSubstituting the calculated values for $\\tau_m$ and $R_m$:\n$$C_m = \\frac{5.0289 \\times 10^{-3} \\text{ s}}{1 \\times 10^8 \\text{ }\\Omega} \\approx 5.0289 \\times 10^{-11} \\text{ F}$$\nThe result is requested in nanofarads ($1 \\text{ nF} = 10^{-9} \\text{ F}$):\n$$C_m = \\left(5.0289 \\times 10^{-11} \\text{ F}\\right) \\times \\left(10^9 \\text{ nF}/\\text{F}\\right) \\approx 0.050289 \\text{ nF}$$\nRounding this value to $3$ significant figures, we get $0.0503 \\text{ nF}$. In standard scientific notation, this is $5.03 \\times 10^{-2} \\text{ nF}$.\n\nThe final values are $R_m = 100 \\text{ M}\\Omega$ and $C_m = 0.0503 \\text{ nF}$. The numerical quantities for the final answer, rounded to $3$ significant figures, are $1.00 \\times 10^2$ for resistance in M$\\Omega$ and $5.03 \\times 10^{-2}$ for capacitance in nF.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1.00 \\times 10^2 & 5.03 \\times 10^{-2}\n\\end{pmatrix}\n}\n$$", "id": "2699753"}, {"introduction": "Ideal experimental conditions are rare in electrophysiology, and understanding potential artifacts is as important as understanding the biology itself. This practice [@problem_id:2699704] confronts a ubiquitous challenge in whole-cell voltage-clamp: the series resistance ($R_s$) of the recording pipette. You will apply Ohm's law to calculate the voltage error that arises even with electronic compensation, a crucial skill for assessing the quality and accuracy of your experimental data.", "problem": "In a whole-cell voltage-clamp recording of a cortical pyramidal neuron, the glass micropipette and access pathway introduce a series resistance (commonly called access resistance), denoted $R_{s}$, between the command voltage source and the cell interior. When the membrane current $I_{m}(t)$ flows, it produces a voltage drop across $R_{s}$ that causes the actual membrane voltage $V_{m}(t)$ to deviate from the command voltage $V_{\\text{cmd}}(t)$. Modern amplifiers implement series resistance compensation by electronically cancelling a fixed fraction of the expected voltage drop. Let the compensation fraction be $f$, so that the compensated residual series resistance is $(1-f)R_{s}$.\n\nStarting from Ohm’s law, the instantaneous magnitude of the membrane voltage error due to incomplete series resistance compensation is the magnitude of the residual drop across the uncompensated portion of the series resistance. Assume the compensation circuit behaves ideally (no prediction errors or additional dynamics) at the time of peak current, and that $R_{s}$ and $I_{m}$ can be treated as constants at the peak.\n\nGiven $R_{s}=8\\ \\text{M}\\Omega$, a peak membrane current magnitude $I_{m}=2\\ \\text{nA}$, and a compensation fraction $f=0.80$, compute the magnitude of the residual membrane voltage error at the peak current. Express your final answer in millivolts and round to three significant figures.", "solution": "The problem statement will first be subjected to a rigorous validation process.\n\nStep 1: Extraction of Givens.\nThe provided information is as follows:\n- The context is a whole-cell voltage-clamp recording.\n- The series resistance (access resistance) is denoted by $R_s$.\n- The membrane current is $I_m(t)$.\n- The command voltage is $V_{\\text{cmd}}(t)$.\n- The actual membrane voltage is $V_m(t)$.\n- The series resistance compensation fraction is $f$.\n- The compensated residual series resistance is given by the expression $(1-f)R_s$.\n- The magnitude of the membrane voltage error is defined as the magnitude of the residual voltage drop across the uncompensated portion of the series resistance.\n- The value of the series resistance is $R_s = 8\\ \\text{M}\\Omega$.\n- The magnitude of the peak membrane current is $I_m = 2\\ \\text{nA}$.\n- The value of the compensation fraction is $f = 0.80$.\n- The problem requires the computation of the magnitude of the residual membrane voltage error at the peak current.\n- The final answer is to be expressed in millivolts and rounded to three significant figures.\n\nStep 2: Validation of the Problem.\nThe problem is scientifically grounded, as it describes a standard and fundamental issue in electrophysiological recordings. The concept of series resistance error and its electronic compensation are core topics in the field. The provided values for $R_s$, $I_m$, and $f$ are physically realistic for a typical experiment on a cortical neuron. The problem is well-posed, providing all necessary information and a clear objective. It is based on a direct application of Ohm's law, a fundamental principle of physics. The terminology is precise and objective. There are no contradictions, ambiguities, or logical flaws. The problem is a valid exercise in applying first principles to a practical scientific scenario.\n\nStep 3: Verdict and Action.\nThe problem is deemed valid. A solution will now be derived.\n\nThe core principle governing the voltage drop across a resistor is Ohm's Law, stated as $V = IR$, where $V$ is the voltage, $I$ is the current, and $R$ is the resistance.\n\nThe problem defines the voltage error, let us denote its magnitude as $|V_{error}|$, as the magnitude of the voltage drop across the *uncompensated* portion of the series resistance. The resistance of this uncompensated portion is the residual series resistance, which we will denote as $R_{res}$. The problem explicitly gives the formula for this residual resistance in terms of the total series resistance $R_s$ and the compensation fraction $f$:\n$$R_{res} = (1-f)R_s$$\n\nThe current flowing through this residual resistance is the membrane current, $I_m$. At the peak, its magnitude is given. Therefore, applying Ohm's law, the magnitude of the voltage error at the peak current is:\n$$|V_{error}| = I_m \\cdot R_{res}$$\nNote that since we are dealing with magnitudes, the absolute value notation for current is implicitly handled by using its given positive magnitude value.\n\nSubstituting the expression for $R_{res}$ into the equation for $|V_{error}|$ yields:\n$$|V_{error}| = I_m \\cdot (1-f)R_s$$\n\nWe are given the following values:\n- $I_m = 2\\ \\text{nA} = 2 \\times 10^{-9}\\ \\text{A}$\n- $R_s = 8\\ \\text{M}\\Omega = 8 \\times 10^6\\ \\Omega$\n- $f = 0.80$\n\nFirst, we calculate the decimal value of the term $(1-f)$:\n$$1 - f = 1 - 0.80 = 0.20$$\n\nNow, we substitute the numerical values into the equation for $|V_{error}|$:\n$$|V_{error}| = (2 \\times 10^{-9}\\ \\text{A}) \\cdot (0.20) \\cdot (8 \\times 10^6\\ \\Omega)$$\n\nWe perform the multiplication of the numerical coefficients and the powers of $10$:\n$$|V_{error}| = (2 \\cdot 0.20 \\cdot 8) \\times (10^{-9} \\cdot 10^6)\\ \\text{V}$$\n$$|V_{error}| = (3.2) \\times (10^{-3})\\ \\text{V}$$\n$$|V_{error}| = 3.2 \\times 10^{-3}\\ \\text{V}$$\n\nThe problem requires the answer to be expressed in millivolts ($\\text{mV}$). The prefix \"milli\" corresponds to a factor of $10^{-3}$. Therefore:\n$$|V_{error}| = 3.2\\ \\text{mV}$$\n\nFinally, the problem specifies that the answer must be rounded to three significant figures. The calculated value of $3.2\\ \\text{mV}$ currently has two significant figures. To express this with three significant figures, we add a trailing zero.\n$$|V_{error}| = 3.20\\ \\text{mV}$$\n\nThis is the magnitude of the residual membrane voltage error at the peak current.", "answer": "$$\n\\boxed{3.20}\n$$", "id": "2699704"}, {"introduction": "Moving beyond passive properties, we now explore the dynamic, voltage-dependent behavior of ion channels that underlies neuronal excitability. This computational exercise [@problem_id:2699719] challenges you to derive and apply the Boltzmann function, a cornerstone model that links statistical mechanics to the macroscopic conductance of voltage-gated channels. By fitting this model to provided datasets, you will develop practical data analysis skills and learn to extract critical biophysical parameters, such as the half-activation voltage ($V_{1/2}$) and slope factor ($k$), that define a channel's operational range.", "problem": "A biophysical two-state gate controlling an ion channel’s open probability can be described from first principles by assuming thermal equilibrium between a closed state and an open state subject to an electric field. The foundational base you must use is the equilibrium Boltzmann distribution relating state probabilities to free-energy differences and the linear dependence of the gating free energy on membrane voltage via an effective gating charge. From these principles, derive a voltage-dependent open probability and its mapping to macroscopic conductance. Do not assume any particular functional form in advance; instead, derive the form explicitly from the foundational base. Then, use the derived form to infer the midpoint voltage and slope factor from data.\n\nYour program must:\n- Start from the fundamental base that at equilibrium the ratio of state probabilities is given by the Boltzmann factor, that the free-energy difference includes a voltage-dependent term proportional to membrane voltage and an effective charge, and that macroscopic conductance is proportional to the open probability up to an offset and scale.\n- Derive a parametric model for the conductance-voltage relation $G(V)$ containing at least the following free parameters: a minimum conductance $G_{\\min}$, a maximum conductance $G_{\\max}$, a half-activation voltage $V_{1/2}$ expressed in $\\mathrm{mV}$, and a slope factor $k$ expressed in $\\mathrm{mV}$.\n- Fit this model to each provided dataset by nonlinear least squares and extract $V_{1/2}$ and $k$ for each dataset. You must treat $G_{\\min}$ and $G_{\\max}$ as unknown nuisance parameters to be fitted jointly with $V_{1/2}$ and $k$.\n- Report $V_{1/2}$ and $k$ in $\\mathrm{mV}$, each rounded to three decimal places.\n\nUse the following test suite of datasets. In each dataset, voltage $V$ is in $\\mathrm{mV}$ and conductance $G$ is dimensionless.\n\nDataset A (general case):\n- $V = [-120,-80,-40,0,40]$\n- $G = [0.0000006,0.000189,0.054200,0.945800,0.999811]$\n\nDataset B (non-unity maximal conductance):\n- $V = [-120,-80,-40,0,40]$\n- $G = [0.000000001649,0.00003631,0.4,0.7999636,0.8]$\n\nDataset C (non-zero baseline and incomplete activation):\n- $V = [-120,-80,-40,0,40]$\n- $G = [0.100285,0.104082,0.155230,0.525000,0.894700]$\n\nDataset D (very steep activation; boundary-like behavior):\n- $V = [-120,-80,-40,0,40]$\n- $G = [0.000000002,0.001270,0.998730,0.999999998,1.0]$\n\nScientific realism constraints:\n- Treat $G_{\\min}$ and $G_{\\max}$ as free to accommodate leak or incomplete normalization.\n- Assume the measurements correspond to steady-state activation, consistent with equilibrium thermodynamics.\n\nRequired units and output:\n- Express $V_{1/2}$ in $\\mathrm{mV}$ and $k$ in $\\mathrm{mV}$.\n- Round each reported $V_{1/2}$ and $k$ to three decimal places.\n- Your program should produce a single line of output containing a list of pairs, one per dataset, in the order A, B, C, D. Each pair is of the form $[V_{1/2},k]$. The overall line must be a single comma-separated list enclosed in square brackets. For example, the formatting pattern is $[[x_1,y_1],[x_2,y_2],\\dots]$.\n\nDesign for coverage:\n- Dataset A is a typical \"happy path\" set.\n- Dataset B tests non-unity $G_{\\max}$ while retaining negligible baseline.\n- Dataset C tests non-zero baseline $G_{\\min}$.\n- Dataset D tests an extreme slope (small $k$), emphasizing identifiability near saturation.\n\nAngle units are not involved. Percentages must not be used anywhere; report $k$ and $V_{1/2}$ numerically in $\\mathrm{mV}$ as specified.\n\nYour solution must be a complete, runnable program that reads no input and prints only the required single line.", "solution": "We begin from equilibrium statistical mechanics. For a two-state gating scheme with closed state $\\mathrm{C}$ and open state $\\mathrm{O}$, the probability ratio at temperature $T$ is\n$$\n\\frac{P_{\\mathrm{O}}}{P_{\\mathrm{C}}} \\;=\\; \\exp\\!\\left(-\\frac{\\Delta G(V)}{R T}\\right),\n$$\nwhere $R$ is the gas constant, and $\\Delta G(V)$ is the molar Gibbs free-energy difference between the open and closed states. For voltage-dependent gating with an effective gating charge $z$ moving across the membrane electric field, the free-energy difference can be modeled as\n$$\n\\Delta G(V) \\;=\\; \\Delta G_0 \\;-\\; z F V,\n$$\nwhere $\\Delta G_0$ is the voltage-independent part, $F$ is the Faraday constant, and $V$ is the membrane voltage. The open probability follows from normalization $P_{\\mathrm{O}} + P_{\\mathrm{C}} = 1$:\n$$\nP_{\\mathrm{O}}(V) \\;=\\; \\frac{1}{1 + \\exp\\!\\left(\\frac{\\Delta G(V)}{R T}\\right)} \\;=\\; \\frac{1}{1 + \\exp\\!\\left(\\frac{\\Delta G_0 - z F V}{R T}\\right)}.\n$$\nDefine the half-activation voltage $V_{1/2}$ by the condition $P_{\\mathrm{O}}(V_{1/2}) = \\tfrac{1}{2}$. Substituting into the expression gives\n$$\n\\frac{1}{2} \\;=\\; \\frac{1}{1 + \\exp\\!\\left(\\frac{\\Delta G_0 - z F V_{1/2}}{R T}\\right)} \\;\\;\\Rightarrow\\;\\; \\Delta G_0 - z F V_{1/2} = 0 \\;\\;\\Rightarrow\\;\\; V_{1/2} = \\frac{\\Delta G_0}{z F}.\n$$\nIntroduce a slope factor $k$ with units of voltage by rewriting the exponent:\n$$\n\\frac{\\Delta G_0 - z F V}{R T} \\;=\\; \\frac{z F}{R T} \\left(V_{1/2} - V\\right) \\;=\\; \\frac{V_{1/2} - V}{k},\n$$\nwhich identifies\n$$\nk \\;=\\; \\frac{R T}{z F}.\n$$\nThus, the open probability is a logistic (Boltzmann) function of voltage:\n$$\nP_{\\mathrm{O}}(V) \\;=\\; \\frac{1}{1 + \\exp\\!\\left(\\frac{V_{1/2} - V}{k}\\right)}.\n$$\nThe macroscopic steady-state conductance $G(V)$ is proportional to $P_{\\mathrm{O}}(V)$, up to an offset and scale to account for leak and non-ideal normalization. Therefore we model\n$$\nG(V) \\;=\\; G_{\\min} \\;+\\; \\left(G_{\\max} - G_{\\min}\\right)\\, P_{\\mathrm{O}}(V)\n\\;=\\; G_{\\min} \\;+\\; \\frac{G_{\\max} - G_{\\min}}{1 + \\exp\\!\\left(\\frac{V_{1/2} - V}{k}\\right)}.\n$$\nHere $G_{\\min}$ and $G_{\\max}$ are unknown nuisance parameters to be estimated alongside $V_{1/2}$ and $k$.\n\nBiophysical interpretation:\n- $V_{1/2}$ is the membrane voltage at which the population is half in the open state, i.e., $P_{\\mathrm{O}} = \\tfrac{1}{2}$. It is set by the balance between the intrinsic free-energy difference $\\Delta G_0$ and the electrical work $z F V$; it indicates the voltage sensitivity midpoint of the channel.\n- $k = \\tfrac{R T}{z F}$ encapsulates the steepness of voltage dependence; smaller $k$ corresponds to a larger effective gating charge $z$ and a steeper $G(V)$ curve, while larger $k$ corresponds to shallower voltage dependence.\n\nAlgorithmic design for parameter estimation:\n- We perform nonlinear least-squares fitting of the four-parameter model $G(V)$ to each dataset. The independent variable is voltage $V$ and the dependent variable is conductance $G$.\n- Initial guesses are constructed from the data:\n  - $G_{\\min}^{(0)}$ is taken as the minimum observed conductance.\n  - $G_{\\max}^{(0)}$ is taken as the maximum observed conductance.\n  - The midpoint conductance is $G_{\\mathrm{mid}}^{(0)} = \\tfrac{1}{2}(G_{\\min}^{(0)} + G_{\\max}^{(0)})$. Choose $V_{1/2}^{(0)}$ as the $V$ at which $G$ is closest to $G_{\\mathrm{mid}}^{(0)}$.\n  - Approximate the local slope $s$ near $V_{1/2}^{(0)}$ by a finite difference. For the logistic function, the derivative at $V_{1/2}$ satisfies $\\left.\\tfrac{dG}{dV}\\right|_{V_{1/2}} = \\tfrac{G_{\\max} - G_{\\min}}{4 k}$. Hence set $k^{(0)} = \\tfrac{G_{\\max}^{(0)} - G_{\\min}^{(0)}}{4 \\lvert s \\rvert}$, with a reasonable fallback if $s$ is extremely small.\n- Use bounded least squares to constrain $k$ to be positive and allow wide bounds for other parameters to accommodate the various datasets.\n- For each dataset, extract the fitted $V_{1/2}$ and $k$, expressed in $\\mathrm{mV}$, and round to three decimal places.\n\nApplying this to the provided datasets A–D yields the fitted midpoints and slope factors that reflect, respectively, a typical activation curve, a non-unity maximal conductance, a non-zero baseline with incomplete activation, and a very steep activation. As per the modeling derivation, the estimated $V_{1/2}$ indicates the voltage at which $G(V)$ is halfway between $G_{\\min}$ and $G_{\\max}$, and the slope factor $k$ quantifies how sharply the curve transitions from low to high conductance in response to voltage changes. The final program performs these fits and prints the results in the required single-line, bracketed list format.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import curve_fit\n\ndef boltzmann_g(V, Gmin, Gmax, Vhalf, k):\n    # Four-parameter Boltzmann conductance model\n    return Gmin + (Gmax - Gmin) / (1.0 + np.exp((Vhalf - V) / k))\n\ndef initial_guesses(V, G):\n    V = np.asarray(V, dtype=float)\n    G = np.asarray(G, dtype=float)\n    gmin0 = float(np.min(G))\n    gmax0 = float(np.max(G))\n    gmid0 = 0.5 * (gmin0 + gmax0)\n    # Index of point closest to midpoint conductance\n    idx = int(np.argmin(np.abs(G - gmid0)))\n\n    # Estimate local slope via finite differences near idx\n    if 0  idx  len(V) - 1:\n        s = (G[idx + 1] - G[idx - 1]) / (V[idx + 1] - V[idx - 1])\n    elif idx == 0 and len(V) > 1:\n        s = (G[1] - G[0]) / (V[1] - V[0])\n    elif idx == len(V) - 1 and len(V) > 1:\n        s = (G[-1] - G[-2]) / (V[-1] - V[-2])\n    else:\n        s = 0.0\n\n    # Slope-based k guess; ensure positivity and reasonable fallback\n    deltaG = max(gmax0 - gmin0, 1e-9)\n    if abs(s) > 1e-12:\n        k0 = max(deltaG / (4.0 * abs(s)), 1e-3)\n    else:\n        k0 = 10.0  # fallback guess in mV\n\n    Vhalf0 = float(V[idx])\n    # Ensure initial Gmin = Gmax\n    if gmin0 > gmax0:\n        gmin0, gmax0 = gmax0, gmin0\n\n    return gmin0, gmax0, Vhalf0, k0\n\ndef fit_dataset(V, G):\n    V = np.asarray(V, dtype=float)\n    G = np.asarray(G, dtype=float)\n\n    p0 = initial_guesses(V, G)\n    # Wide bounds; enforce k > 0\n    lower_bounds = [-1.0, -1.0, -200.0, 1e-6]\n    upper_bounds = [5.0, 5.0, 200.0, 500.0]\n\n    # If data suggest Gmin = Gmax, it's fine; otherwise the fit will adjust.\n    popt, _ = curve_fit(\n        boltzmann_g, V, G, p0=p0, bounds=(lower_bounds, upper_bounds),\n        maxfev=100000\n    )\n    Gmin_fit, Gmax_fit, Vhalf_fit, k_fit = popt\n    return float(Vhalf_fit), float(k_fit)\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each test case is a tuple: (V_list, G_list)\n    test_cases = [\n        # Dataset A (general case)\n        ([-120, -80, -40, 0, 40],\n         [0.0000006, 0.000189, 0.054200, 0.945800, 0.999811]),\n        # Dataset B (non-unity maximal conductance)\n        ([-120, -80, -40, 0, 40],\n         [0.000000001649, 0.00003631, 0.4, 0.7999636, 0.8]),\n        # Dataset C (non-zero baseline and incomplete activation)\n        ([-120, -80, -40, 0, 40],\n         [0.100285, 0.104082, 0.155230, 0.525000, 0.894700]),\n        # Dataset D (very steep activation; boundary-like behavior)\n        ([-120, -80, -40, 0, 40],\n         [0.000000002, 0.001270, 0.998730, 0.999999998, 1.0]),\n    ]\n\n    results = []\n    for V, G in test_cases:\n        Vhalf, k = fit_dataset(V, G)\n        results.append((Vhalf, k))\n\n    # Format results: list of [Vhalf,k] with three decimals, no extra spaces.\n    formatted = []\n    for Vhalf, k in results:\n        formatted.append(f\"[{Vhalf:.3f},{k:.3f}]\")\n\n    # Final print statement in the exact required format.\n    print(f\"[[{','.join(formatted)}]]\")\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "2699719"}]}