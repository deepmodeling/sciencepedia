{"hands_on_practices": [{"introduction": "Understanding the formula for the length constant $ \\lambda $ is the first step, but truly mastering cable theory requires appreciating the relative impact of each biophysical parameter. This exercise introduces the concept of elasticity, a powerful tool for quantifying the sensitivity of $ \\lambda $ to small fractional changes in axon radius $a$, membrane resistance $R_m$, and axial resistivity $R_i$. By calculating these dimensionless sensitivities, you will gain a more intuitive grasp of which factors most effectively govern passive signal propagation [@problem_id:2764076].", "problem": "In a passive, homogeneous, infinitely long cylindrical axon, the spatial length constant $ \\lambda $ characterizes the spatial decay of membrane potential along the cable. Consider a cylinder of radius $ a $ with specific membrane resistance per unit area $ R_m $ and intracellular resistivity $ R_i $. For such a cable, standard cable theory implies that\n$$\n\\lambda \\;=\\; \\sqrt{\\frac{a\\,R_m}{2\\,R_i}} \\, .\n$$\nTreating $ a $, $ R_m $, and $ R_i $ as independent positive parameters, compute the elasticities of $ \\lambda $ with respect to each parameter, defined as $ \\partial \\ln \\lambda / \\partial \\ln a $, $ \\partial \\ln \\lambda / \\partial \\ln R_m $, and $ \\partial \\ln \\lambda / \\partial \\ln R_i $. Then briefly interpret the magnitudes of these elasticities in terms of fractional sensitivity of $ \\lambda $ to small fractional changes in $ a $, $ R_m $, and $ R_i $.\n\nProvide your final answer as a row matrix $ \\begin{pmatrix} \\partial \\ln \\lambda / \\partial \\ln a & \\partial \\ln \\lambda / \\partial \\ln R_m & \\partial \\ln \\lambda / \\partial \\ln R_i \\end{pmatrix} $. No rounding is required; report exact values. The elasticities are dimensionless, so no units should be included in the final answer.", "solution": "The problem statement has been evaluated and is found to be valid. It is scientifically grounded in the principles of cellular neuroscience (cable theory), mathematically well-posed, objective, and self-contained. All necessary information is provided for a unique solution.\n\nThe spatial length constant, $\\lambda$, is given by the formula:\n$$\n\\lambda = \\sqrt{\\frac{a\\,R_m}{2\\,R_i}}\n$$\nwhere $a$ is the axon radius, $R_m$ is the specific membrane resistance, and $R_i$ is the intracellular resistivity. These $3$ parameters, $a$, $R_m$, and $R_i$, are treated as independent positive variables.\n\nThe elasticity of a function, in this case $\\lambda$, with respect to a parameter, for instance $x$, is defined as the partial derivative of the natural logarithm of the function with respect to the natural logarithm of the parameter:\n$$\nE_x = \\frac{\\partial \\ln \\lambda}{\\partial \\ln x}\n$$\nTo compute the required elasticities, we first take the natural logarithm of the expression for $\\lambda$:\n$$\n\\ln \\lambda = \\ln \\left( \\left( \\frac{a R_m}{2 R_i} \\right)^{\\frac{1}{2}} \\right)\n$$\nUsing the properties of logarithms, this expression simplifies to:\n$$\n\\ln \\lambda = \\frac{1}{2} \\ln \\left( \\frac{a R_m}{2 R_i} \\right) = \\frac{1}{2} \\left[ \\ln(a) + \\ln(R_m) - \\ln(R_i) - \\ln(2) \\right]\n$$\nNow, we compute the $3$ elasticities by taking the partial derivative of $\\ln \\lambda$ with respect to $\\ln a$, $\\ln R_m$, and $\\ln R_i$.\n\n$1$. Elasticity with respect to the radius $a$:\n$$\n\\frac{\\partial \\ln \\lambda}{\\partial \\ln a} = \\frac{\\partial}{\\partial \\ln a} \\left[ \\frac{1}{2} \\left( \\ln a + \\ln R_m - \\ln R_i - \\ln 2 \\right) \\right] = \\frac{1}{2} \\frac{\\partial (\\ln a)}{\\partial (\\ln a)} = \\frac{1}{2}\n$$\n\n$2$. Elasticity with respect to the specific membrane resistance $R_m$:\n$$\n\\frac{\\partial \\ln \\lambda}{\\partial \\ln R_m} = \\frac{\\partial}{\\partial \\ln R_m} \\left[ \\frac{1}{2} \\left( \\ln a + \\ln R_m - \\ln R_i - \\ln 2 \\right) \\right] = \\frac{1}{2} \\frac{\\partial (\\ln R_m)}{\\partial (\\ln R_m)} = \\frac{1}{2}\n$$\n\n$3$. Elasticity with respect to the intracellular resistivity $R_i$:\n$$\n\\frac{\\partial \\ln \\lambda}{\\partial \\ln R_i} = \\frac{\\partial}{\\partial \\ln R_i} \\left[ \\frac{1}{2} \\left( \\ln a + \\ln R_m - \\ln R_i - \\ln 2 \\right) \\right] = -\\frac{1}{2} \\frac{\\partial (\\ln R_i)}{\\partial (\\ln R_i)} = -\\frac{1}{2}\n$$\n\nThe interpretation of these dimensionless elasticity values is straightforward. The elasticity $E_x$ approximates the ratio of the fractional change in $\\lambda$ to a small fractional change in the parameter $x$:\n$$\nE_x = \\frac{\\partial \\ln \\lambda}{\\partial \\ln x} \\approx \\frac{\\Delta \\lambda / \\lambda}{\\Delta x / x}\n$$\nTherefore, the fractional change in $\\lambda$ is approximately the elasticity multiplied by the fractional change in the parameter: $\\frac{\\Delta \\lambda}{\\lambda} \\approx E_x \\frac{\\Delta x}{x}$.\n\nThe elasticities for $a$ and $R_m$ are both $\\frac{1}{2}$. This signifies that a small fractional increase in either the axon radius or the membrane resistance (e.g., a $1\\%$ increase) will result in a fractional increase in the length constant of approximately half that amount (a $0.5\\%$ increase). This indicates that $\\lambda$ is moderately sensitive to changes in $a$ and $R_m$.\n\nThe elasticity for $R_i$ is $-\\frac{1}{2}$. This signifies that a small fractional increase in the intracellular resistivity (e.g., a $1\\%$ increase) will result in a fractional decrease in the length constant of approximately half that amount (a $0.5\\%$ decrease). The negative sign indicates an inverse relationship: increasing the internal resistance hinders signal propagation, thereby shortening the length constant.", "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{1}{2} & \\frac{1}{2} & -\\frac{1}{2} \\end{pmatrix}}\n$$", "id": "2764076"}, {"introduction": "While the concept of an infinitely long cable is a useful idealization, real neuronal processes have finite lengths and distinct terminations. This practice moves beyond the infinite approximation to explore how distal boundary conditions—such as a sealed end or a shorted end—impact a neuron's input resistance $R_{\\text{in}}$. Through this exercise, you will derive analytical expressions for $R_{\\text{in}}$ and determine the critical \"electrical length\" $L/\\lambda$ at which a finite cable effectively behaves as an infinite one, a key concept in dendritic integration [@problem_id:2764083].", "problem": "A straight, passive, unbranched dendritic cable of physical length $\\ell$ is described in one spatial dimension by steady (direct current, DC) electrophysiology. Let $r_{i}$ denote the axial resistance per unit length (in $\\Omega\\,\\text{m}^{-1}$) and $r_{m}$ the membrane resistance per unit length (in $\\Omega\\,\\text{m}$). The membrane current per unit length is $i_{m}(x)=V(x)/r_{m}$ and the axial current satisfies Ohm’s law $dV/dx=-r_{i} i_{i}(x)$. At steady state, conservation of current implies $di_{i}/dx + i_{m} = 0$. The length constant is defined by $\\lambda=\\sqrt{r_{m}/r_{i}}$.\n\nA constant DC current $I$ is injected at the proximal end $x=0$ of the cable. The distal end at $x=\\ell$ is terminated in one of two ways:\n- Sealed end: no axial current leaves, so $i_{i}(\\ell)=0$.\n- Shorted end: the distal voltage is clamped to the reference potential, so $V(\\ell)=0$.\n\nStarting only from the statements above and the definition of $\\lambda$, derive expressions for the DC input resistance $R_{\\text{in}}=\\frac{V(0)}{I}$ for each termination. Then, using those expressions, determine the smallest dimensionless length $\\ell/\\lambda$ for which the two input resistances differ by less than $5\\%$, using the sealed-end input resistance as the reference for the percentage difference. Express your final answer as a single dimensionless number and round your answer to four significant figures. Do not include units.", "solution": "The problem requires the derivation of the input resistance for a passive dendritic cable under two different boundary conditions, and then to find the minimum cable length for which these two resistances are within a specified tolerance. The entire analysis will be based on the provided steady-state cable equations.\n\nFirst, we must derive the governing differential equation for the membrane potential $V(x)$. The problem provides the following relationships:\n1.  Conservation of current: $\\frac{di_{i}}{dx} + i_{m} = 0$, which can be written as $\\frac{di_{i}}{dx} = -i_{m}(x)$.\n2.  Membrane current: $i_{m}(x) = \\frac{V(x)}{r_{m}}$.\n3.  Axial current (Ohm's law): $\\frac{dV}{dx} = -r_{i} i_{i}(x)$.\n\nWe differentiate the third equation with respect to $x$:\n$$ \\frac{d^2V}{dx^2} = -r_{i} \\frac{di_{i}}{dx} $$\nSubstituting the first equation into this result gives:\n$$ \\frac{d^2V}{dx^2} = -r_{i} (-i_{m}(x)) = r_{i} i_{m}(x) $$\nNow, substituting the second equation for $i_{m}(x)$:\n$$ \\frac{d^2V}{dx^2} = r_{i} \\frac{V(x)}{r_{m}} = \\frac{r_{i}}{r_{m}} V(x) $$\nThe problem defines the length constant $\\lambda = \\sqrt{r_{m}/r_{i}}$. Therefore, $\\frac{r_{i}}{r_{m}} = \\frac{1}{\\lambda^2}$. The governing equation for the steady-state voltage along the cable is the one-dimensional Helmholtz equation, often called the steady-state cable equation:\n$$ \\frac{d^2V}{dx^2} - \\frac{1}{\\lambda^2} V(x) = 0 $$\nThis is a second-order linear homogeneous ordinary differential equation. The general solution can be expressed using hyperbolic functions, which is convenient for a finite cable:\n$$ V(x) = A \\cosh\\left(\\frac{x}{\\lambda}\\right) + B \\sinh\\left(\\frac{x}{\\lambda}\\right) $$\nwhere $A$ and $B$ are constants to be determined by the boundary conditions.\n\nThe axial current $i_i(x)$ is found by differentiating $V(x)$:\n$$ i_{i}(x) = -\\frac{1}{r_{i}} \\frac{dV}{dx} = -\\frac{1}{r_{i}\\lambda} \\left[ A \\sinh\\left(\\frac{x}{\\lambda}\\right) + B \\cosh\\left(\\frac{x}{\\lambda}\\right) \\right] $$\nAt the proximal end ($x=0$), a current $I$ is injected. This current must flow into the cable as axial current, so $i_{i}(0) = I$.\n$$ I = i_{i}(0) = -\\frac{1}{r_{i}\\lambda} \\left[ A \\sinh(0) + B \\cosh(0) \\right] = -\\frac{B}{r_{i}\\lambda} $$\nThis gives one of the constants: $B = -I r_{i} \\lambda$. The other constant, $A$, is determined by the condition at the distal end ($x=\\ell$).\n\nCase 1: Sealed End\nThe boundary condition is no axial current flow, $i_{i}(\\ell)=0$.\n$$ 0 = i_{i}(\\ell) = -\\frac{1}{r_{i}\\lambda} \\left[ A \\sinh\\left(\\frac{\\ell}{\\lambda}\\right) + B \\cosh\\left(\\frac{\\ell}{\\lambda}\\right) \\right] $$\n$$ A \\sinh\\left(\\frac{\\ell}{\\lambda}\\right) = -B \\cosh\\left(\\frac{\\ell}{\\lambda}\\right) \\implies A = -B \\coth\\left(\\frac{\\ell}{\\lambda}\\right) $$\nSubstituting $B = -I r_{i} \\lambda$, we get $A = I r_{i} \\lambda \\coth(\\ell/\\lambda)$.\nThe voltage at the input is $V(0) = A \\cosh(0) + B \\sinh(0) = A$.\nThe input resistance for the sealed-end case, $R_{\\text{in, sealed}}$, is:\n$$ R_{\\text{in, sealed}} = \\frac{V(0)}{I} = \\frac{A}{I} = \\frac{I r_{i} \\lambda \\coth(\\ell/\\lambda)}{I} = r_{i} \\lambda \\coth\\left(\\frac{\\ell}{\\lambda}\\right) $$\n\nCase 2: Shorted End\nThe boundary condition is zero voltage, $V(\\ell)=0$.\n$$ 0 = V(\\ell) = A \\cosh\\left(\\frac{\\ell}{\\lambda}\\right) + B \\sinh\\left(\\frac{\\ell}{\\lambda}\\right) $$\n$$ A \\cosh\\left(\\frac{\\ell}{\\lambda}\\right) = -B \\sinh\\left(\\frac{\\ell}{\\lambda}\\right) \\implies A = -B \\tanh\\left(\\frac{\\ell}{\\lambda}\\right) $$\nSubstituting $B = -I r_{i} \\lambda$, we get $A = I r_{i} \\lambda \\tanh(\\ell/\\lambda)$.\nThe voltage at the input is $V(0) = A$.\nThe input resistance for the shorted-end case, $R_{\\text{in, short}}$, is:\n$$ R_{\\text{in, short}} = \\frac{V(0)}{I} = \\frac{A}{I} = \\frac{I r_{i} \\lambda \\tanh(\\ell/\\lambda)}{I} = r_{i} \\lambda \\tanh\\left(\\frac{\\ell}{\\lambda}\\right) $$\n\nNow we must find the smallest dimensionless length $L = \\ell/\\lambda$ for which the two input resistances differ by less than $5\\%$, using $R_{\\text{in, sealed}}$ as the reference. The condition is:\n$$ \\frac{|R_{\\text{in, sealed}} - R_{\\text{in, short}}|}{R_{\\text{in, sealed}}} < 0.05 $$\nFor any positive length $\\ell/\\lambda > 0$, we have $\\coth(\\ell/\\lambda) > 1$ and $0 < \\tanh(\\ell/\\lambda) < 1$, so $R_{\\text{in, sealed}} > R_{\\text{in, short}}$. The absolute value is redundant.\n$$ 1 - \\frac{R_{\\text{in, short}}}{R_{\\text{in, sealed}}} < 0.05 $$\nSubstituting the expressions for the resistances:\n$$ 1 - \\frac{r_{i} \\lambda \\tanh(\\ell/\\lambda)}{r_{i} \\lambda \\coth(\\ell/\\lambda)} < 0.05 $$\nLet $L = \\ell/\\lambda$. The expression simplifies, as $\\coth(L) = 1/\\tanh(L)$:\n$$ 1 - \\tanh^2(L) < 0.05 $$\nRearranging the inequality yields:\n$$ \\tanh^2(L) > 0.95 $$\nSince $L > 0$, $\\tanh(L)$ is positive, so we can take the square root of both sides:\n$$ \\tanh(L) > \\sqrt{0.95} $$\nThe function $\\tanh(L)$ is monotonically increasing for $L > 0$. The condition is met for all $L$ greater than the value where equality holds. The problem asks for the \"smallest dimensionless length\", which corresponds to this boundary value.\n$$ L = \\arctanh\\left(\\sqrt{0.95}\\right) $$\nUsing the logarithmic definition of the inverse hyperbolic tangent, $\\arctanh(z) = \\frac{1}{2}\\ln\\left(\\frac{1+z}{1-z}\\right)$:\n$$ L = \\frac{1}{2}\\ln\\left(\\frac{1+\\sqrt{0.95}}{1-\\sqrt{0.95}}\\right) $$\nTo compute the numerical value, we evaluate the argument of the logarithm. Let us rationalize the fraction:\n$$ \\frac{1+\\sqrt{0.95}}{1-\\sqrt{0.95}} = \\frac{(1+\\sqrt{0.95})(1+\\sqrt{0.95})}{(1-\\sqrt{0.95})(1+\\sqrt{0.95})} = \\frac{1 + 2\\sqrt{0.95} + 0.95}{1 - 0.95} = \\frac{1.95 + 2\\sqrt{0.95}}{0.05} = 39 + 40\\sqrt{0.95} $$\nSo the expression for $L$ is:\n$$ L = \\frac{1}{2}\\ln\\left(39 + 40\\sqrt{0.95}\\right) $$\nNow we compute the value:\n$$ \\sqrt{0.95} \\approx 0.97467943 $$\n$$ L \\approx \\frac{1}{2}\\ln\\left(39 + 40 \\times 0.97467943\\right) = \\frac{1}{2}\\ln\\left(39 + 38.9871772\\right) = \\frac{1}{2}\\ln(77.9871772) $$\n$$ L \\approx \\frac{1}{2} \\times 4.356550 \\approx 2.178275 $$\nRounding to four significant figures, we get $L = 2.178$.", "answer": "$$\\boxed{2.178}$$", "id": "2764083"}, {"introduction": "Analytical solutions are essential for insight but are often confined to simple geometries; to model the intricate branching of real neurons, we turn to computational tools like compartmental modeling. This practice bridges theory and computation by asking you to build a numerical model of a finite cable and validate its accuracy against the analytical expressions for input resistance derived in the previous exercise [@problem_id:2764063]. Mastering this validation workflow is a crucial step towards becoming a proficient computational neuroscientist, ensuring your simulations are grounded in established theory.", "problem": "You are given a uniform, passive, one-dimensional cylindrical neurite described by the cable theory at direct current (DC) steady state. The cable has radius $a$ (in $\\mathrm{m}$), specific membrane resistance $R_m$ (in $\\Omega\\cdot\\mathrm{m}^2$), specific intracellular resistivity $R_i$ (in $\\Omega\\cdot\\mathrm{m}$), and length $L$ (in $\\mathrm{m}$). A constant current $I$ (in $\\mathrm{A}$) is injected at the proximal end $x=0$, and the input resistance $R_{\\mathrm{in}}$ is defined as $R_{\\mathrm{in}} = V(0)/I$, where $V(0)$ is the steady-state potential at $x=0$ relative to a distant ground.\n\nYour tasks are:\n- From first principles, starting with definitions of membrane and axial resistances per unit length, and the DC cable equation, derive:\n  1. The length constant $\\lambda$ in terms of $R_m$, $R_i$, and $a$.\n  2. Analytical expressions for the input resistance $R_{\\mathrm{in}}$ at $x=0$ for two distinct distal boundary conditions at $x=L$:\n     - Sealed end (no axial current at $x=L$).\n     - Shorted end (potential clamped to zero at $x=L$).\n- Independently, implement a numerical compartmental model using Kirchhoff's Current Law (KCL) for a uniform discretization to approximate the same steady-state solution. Enforce the two distal boundary conditions in the compartmental system, and compute $R_{\\mathrm{in}}$ numerically for each case. Compare the numerical $R_{\\mathrm{in}}$ to the derived analytical expression by reporting the relative error.\n\nModeling and implementation requirements:\n- Use the following definitions of resistances per unit length:\n  - Axial resistance per unit length $r_i = \\dfrac{R_i}{\\pi a^2}$ (in $\\Omega/\\mathrm{m}$).\n  - Membrane resistance per unit length $r_m = \\dfrac{R_m}{2\\pi a}$ (in $\\Omega\\cdot\\mathrm{m}$).\n- Discretize the cable into $N$ nodes with uniform spacing $\\Delta x$ so that $(N-1)\\Delta x = L$. Associate to each internal node $i$ a membrane conductance $g_m = \\Delta x / r_m$, and to each end node a half-membrane conductance $g_m^{\\mathrm{end}} = (\\Delta x/2)/r_m$. For each link between adjacent nodes, use axial conductance $g_i = 1/(r_i \\Delta x)$. Apply KCL at each node to obtain a tridiagonal linear system for the node voltages. At $x=0$, inject the current $I$ into node $0$. For the distal boundary at $x=L$, implement:\n  - Sealed: no axial current beyond the last node (the last node has only one axial neighbor).\n  - Shorted: impose $V(L)=0$ (Dirichlet condition at the last node).\n- For numerical accuracy and reproducibility across cases, choose the spatial step using the derived $\\lambda$ as follows: set $\\Delta x = \\lambda/800$ and $N = \\lceil L/\\Delta x \\rceil + 1$, then reset $\\Delta x = L/(N-1)$ to exactly span the cable. This requires you to compute $\\lambda$ from first principles (do not assume or use any pre-stated shortcut formulas in your derivation).\n- Use $I = 1.0$ (in $\\mathrm{A}$). Although intermediate quantities carry physical units, your final reported quantities are relative errors and are dimensionless.\n- Test suite (parameters are scientifically plausible and consistent):\n  - Common parameters for all tests: $a = 1.0\\times 10^{-6}\\ \\mathrm{m}$, $R_m = 1.0\\ \\Omega\\cdot\\mathrm{m}^2$, $R_i = 1.0\\ \\Omega\\cdot\\mathrm{m}$, $I = 1.0\\ \\mathrm{A}$.\n  - Three cable lengths specified relative to $\\lambda$: $L \\in \\{0.1\\lambda,\\ \\lambda,\\ 4\\lambda\\}$.\n  - For each $L$, evaluate both boundary conditions (sealed and shorted) and report the relative error between the numerical $R_{\\mathrm{in}}$ and your analytical $R_{\\mathrm{in}}$ derived from first principles.\n- Output specification:\n  - Your program should produce a single line of output containing the six relative errors as a comma-separated list enclosed in square brackets, in the order:\n    - $[ \\mathrm{err}_{\\mathrm{sealed}}(0.1\\lambda),\\ \\mathrm{err}_{\\mathrm{shorted}}(0.1\\lambda),\\ \\mathrm{err}_{\\mathrm{sealed}}(\\lambda),\\ \\mathrm{err}_{\\mathrm{shorted}}(\\lambda),\\ \\mathrm{err}_{\\mathrm{sealed}}(4\\lambda),\\ \\mathrm{err}_{\\mathrm{shorted}}(4\\lambda) ]$.\n  - Each value must be printed as a float in scientific notation with six digits after the decimal point (for example, $1.234567\\mathrm{e}{-04}$).\n  - These are dimensionless quantities (no units).\n\nDeliverables:\n- A complete, runnable program that:\n  1. Computes $\\lambda$ from the given physical parameters using only fundamental definitions.\n  2. Constructs and solves the tridiagonal system implementing sealed and shorted distal boundary conditions as specified.\n  3. Computes analytical $R_{\\mathrm{in}}$ for both boundary conditions from first principles.\n  4. Produces the required single-line output with the six relative errors in the specified order and format.", "solution": "The posed problem is subjected to rigorous validation.\n\n### Step 1: Extract Givens\n- **Physical Parameters**: Cylindrical neurite radius $a$ ($\\mathrm{m}$), specific membrane resistance $R_m$ ($\\Omega\\cdot\\mathrm{m}^2$), specific intracellular resistivity $R_i$ ($\\Omega\\cdot\\mathrm{m}$), cable length $L$ ($\\mathrm{m}$).\n- **Electrical Conditions**: Constant current injection $I$ ($\\mathrm{A}$) at $x=0$.\n- **Definitions**:\n  - Input resistance: $R_{\\mathrm{in}} = V(0)/I$, where $V(0)$ is steady-state potential at $x=0$.\n  - Axial resistance per unit length: $r_i = \\dfrac{R_i}{\\pi a^2}$ ($\\Omega/\\mathrm{m}$).\n  - Membrane resistance per unit length: $r_m = \\dfrac{R_m}{2\\pi a}$ ($\\Omega\\cdot\\mathrm{m}$).\n- **Boundary Conditions (Analytical)**:\n  - Sealed end at $x=L$: No axial current, implying $\\frac{dV}{dx}|_{x=L}=0$.\n  - Shorted end at $x=L$: Potential clamped to zero, $V(L)=0$.\n- **Numerical Discretization**:\n  - $N$ nodes with uniform spacing $\\Delta x$ such that $(N-1)\\Delta x = L$.\n  - Internal node ($i$) membrane conductance: $g_m = \\Delta x / r_m$.\n  - End node membrane conductance: $g_m^{\\mathrm{end}} = (\\Delta x/2)/r_m$.\n  - Axial conductance between adjacent nodes: $g_i = 1/(r_i \\Delta x)$.\n  - Current $I$ is injected at node $0$.\n- **Numerical Spatial Step Rule**:\n  1. Compute $\\lambda$ from first principles.\n  2. Set initial step $\\Delta x = \\lambda/800$.\n  3. Set number of nodes $N = \\lceil L/\\Delta x \\rceil + 1$.\n  4. Redefine final step $\\Delta x = L/(N-1)$.\n- **Test Case Parameters**:\n  - $a = 1.0\\times 10^{-6}\\ \\mathrm{m}$\n  - $R_m = 1.0\\ \\Omega\\cdot\\mathrm{m}^2$\n  - $R_i = 1.0\\ \\Omega\\cdot\\mathrm{m}$\n  - $I = 1.0\\ \\mathrm{A}$\n  - $L$ is specified as $\\{0.1\\lambda,\\ \\lambda,\\ 4\\lambda\\}$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is assessed for validity.\n- **Scientifically Grounded**: The problem is a classic application of cable theory, a cornerstone of quantitative cellular electrophysiology. All concepts, definitions, and equations are standard and derived from fundamental principles of electricity (Ohm's Law, Kirchhoff's Current Law). This is a textbook problem, not speculation.\n- **Well-Posed**: The problem is well-posed. The analytical part involves solving a second-order linear ordinary differential equation with well-defined boundary conditions, which guarantees a unique solution. The numerical part involves solving a system of linear algebraic equations, which is non-singular and thus has a unique solution.\n- **Objective**: The problem is stated in precise, objective, and quantitative language, devoid of any subjective or ambiguous terms.\n- **Completeness**: All required parameters, definitions, and model specifications are explicitly provided. The numerical method (compartmental modeling) is detailed, including the discretization of conductances and the handling of boundary nodes.\n- **Consistency**: The definitions and requirements are internally consistent. The derivation from first principles is explicitly required, preventing reliance on unstated assumptions. The numerical scheme is a known robust finite-difference approximation to the continuous model.\n\n### Step 3: Verdict and Action\nThe problem is **valid**. It is a standard, well-posed problem in computational neuroscience that correctly combines analytical derivation with numerical implementation and validation. A solution will be provided.\n\n### Analytical Derivations\n\n**1. Length Constant $\\lambda$**\n\nWe begin from first principles. Consider a small segment of the cable of length $dx$. The change in axial current, $di_i$, along this segment must be equal to the current leaking out through the membrane, $i_m dx$, where $i_m$ is the membrane current per unit length. By conservation of charge at steady state:\n$$\n-di_i= i_m dx\n$$\nThe axial current $i_i(x)$ and membrane current $i_m(x)$ are given by Ohm's law:\n$$\ni_i(x) = -\\frac{1}{r_i} \\frac{dV(x)}{dx}\n$$\n$$\ni_m(x) = \\frac{V(x)}{r_m}\n$$\nwhere $V(x)$ is the voltage at position $x$. Taking the derivative of the axial current with respect to $x$:\n$$\n\\frac{di_i}{dx} = -\\frac{1}{r_i} \\frac{d^2V(x)}{dx^2}\n$$\nSubstituting these into the conservation law $-di_i/dx = i_m$:\n$$\n\\frac{1}{r_i} \\frac{d^2V(x)}{dx^2} = \\frac{V(x)}{r_m} \\implies \\frac{d^2V}{dx^2} - \\frac{r_i}{r_m} V = 0\n$$\nThe standard DC cable equation is written as $\\lambda^2 \\frac{d^2V}{dx^2} - V = 0$. By comparison, the length constant $\\lambda$ is defined by:\n$$\n\\lambda^2 = \\frac{r_m}{r_i} \\implies \\lambda = \\sqrt{\\frac{r_m}{r_i}}\n$$\nUsing the provided definitions for $r_m$ and $r_i$ in terms of fundamental parameters:\n$$\nr_m = \\frac{R_m}{2\\pi a} \\quad \\text{and} \\quad r_i = \\frac{R_i}{\\pi a^2}\n$$\nSubstituting these into the expression for $\\lambda$:\n$$\n\\lambda = \\sqrt{\\frac{R_m / (2\\pi a)}{R_i / (\\pi a^2)}} = \\sqrt{\\frac{R_m}{2\\pi a} \\cdot \\frac{\\pi a^2}{R_i}} = \\sqrt{\\frac{R_m a}{2 R_i}}\n$$\nThis is the required derivation for the length constant $\\lambda$.\n\n**2. Input Resistance $R_{\\mathrm{in}}$**\n\nThe general solution to the cable equation $\\lambda^2 V'' - V = 0$ is:\n$$\nV(x) = A e^{x/\\lambda} + B e^{-x/\\lambda}\n$$\nA more convenient form for applying boundary conditions at $x=L$ uses hyperbolic functions centered at the distal end. Let $y = L-x$. The general solution is $V(x) = C \\cosh((L-x)/\\lambda) + D \\sinh((L-x)/\\lambda)$. The axial current is then:\n$$\ni_i(x) = -\\frac{1}{r_i}\\frac{dV}{dx} = -\\frac{1}{r_i} \\left( -\\frac{C}{\\lambda}\\sinh\\frac{L-x}{\\lambda} - \\frac{D}{\\lambda}\\cosh\\frac{L-x}{\\lambda} \\right) = \\frac{1}{r_i\\lambda} \\left( C\\sinh\\frac{L-x}{\\lambda} + D\\cosh\\frac{L-x}{\\lambda} \\right)\n$$\nAt the proximal end ($x=0$), a current $I$ is injected: $I = i_i(0)$. The input resistance is $R_{\\mathrm{in}} = V(0)/I$.\n\n**Case 1: Sealed End**\nThe boundary condition at $x=L$ is no axial current: $i_i(L) = 0$.\n$$\ni_i(L) = \\frac{1}{r_i\\lambda} \\left( C\\sinh(0) + D\\cosh(0) \\right) = \\frac{D}{r_i\\lambda} = 0 \\implies D=0\n$$\nThe solution simplifies to $V(x) = C \\cosh((L-x)/\\lambda)$. At $x=0$:\n$$\nV(0) = C\\cosh(L/\\lambda)\n$$\n$$\nI = i_i(0) = \\frac{1}{r_i\\lambda} \\left( C\\sinh(L/\\lambda) \\right)\n$$\nThe input resistance is:\n$$\nR_{\\mathrm{in, sealed}} = \\frac{V(0)}{I} = \\frac{C\\cosh(L/\\lambda)}{C\\sinh(L/\\lambda) / (r_i\\lambda)} = r_i\\lambda \\coth(L/\\lambda)\n$$\nSubstituting $\\lambda = \\sqrt{r_m/r_i}$, we get $R_{\\mathrm{in, sealed}} = r_i\\sqrt{r_m/r_i} \\coth(L/\\lambda) = \\sqrt{r_m r_i} \\coth(L/\\lambda)$. $\\sqrt{r_m r_i}$ is the characteristic impedance $Z_c$.\n\n**Case 2: Shorted End**\nThe boundary condition at $x=L$ is $V(L) = 0$.\n$$\nV(L) = C\\cosh(0) + D\\sinh(0) = C = 0\n$$\nThe solution simplifies to $V(x) = D \\sinh((L-x)/\\lambda)$. At $x=0$:\n$$\nV(0) = D\\sinh(L/\\lambda)\n$$\n$$\nI = i_i(0) = \\frac{1}{r_i\\lambda} \\left( D\\cosh(L/\\lambda) \\right)\n$$\nThe input resistance is:\n$$\nR_{\\mathrm{in, shorted}} = \\frac{V(0)}{I} = \\frac{D\\sinh(L/\\lambda)}{D\\cosh(L/\\lambda) / (r_i\\lambda)} = r_i\\lambda \\tanh(L/\\lambda) = \\sqrt{r_m r_i} \\tanh(L/\\lambda)\n$$\n\n### Numerical Model\nThe neurite is discretized into $N$ nodes, indexed $i=0, ..., N-1$, located at positions $x_i = i \\Delta x$. We apply Kirchhoff's Current Law (KCL) at each node.\n\n- **Internal Node ($0 < i < N-1$)**: The sum of axial currents to neighbors and membrane current is zero.\n  $g_i(V_i - V_{i-1}) + g_i(V_i - V_{i+1}) + g_m V_i = 0 \\implies -g_i V_{i-1} + (2g_i + g_m)V_i - g_i V_{i+1} = 0$.\n- **Proximal Node ($i=0$)**: The injected current $I$ balances currents to the right neighbor and through the membrane.\n  $g_i(V_0 - V_1) + g_m^{\\mathrm{end}} V_0 = I \\implies (g_i + g_m^{\\mathrm{end}})V_0 - g_i V_1 = I$.\n\nThese equations form a linear system $A\\mathbf{V} = \\mathbf{b}$, where $\\mathbf{V}=[V_0, ..., V_{N-1}]^T$. The final row of the system depends on the distal boundary condition.\n\n- **Sealed End**: KCL is applied at node $i=N-1$. There is no neighbor to the right.\n  $g_i(V_{N-1} - V_{N-2}) + g_m^{\\mathrm{end}} V_{N-1} = 0 \\implies -g_i V_{N-2} + (g_i + g_m^{\\mathrm{end}})V_{N-1} = 0$.\n  The matrix $A$ is tridiagonal. $\\mathbf{b} = [I, 0, \\dots, 0]^T$.\n- **Shorted End**: The voltage is fixed at $V_{N-1}=0$. This is a Dirichlet condition that replaces the KCL equation for the last node. The system remains for $V_0, ..., V_{N-1}$.\n  The KCL equations hold for $i=0, \\dots, N-2$. The last equation is simply $V_{N-1} = 0$.\n  This leads to a matrix $A$ where rows $0$ to $N-2$ are tridiagonal and the last row is $[0, \\dots, 0, 1]$. The vector $\\mathbf{b}$ is $[I, 0, \\dots, 0]^T$.\n\nThe system $A\\mathbf{V}=\\mathbf{b}$ is solved for $\\mathbf{V}$. Since $I=1\\ \\mathrm{A}$, the numerical input resistance is $R_{\\mathrm{in}}^{\\mathrm{num}} = V_0/I = V_0$. The relative error is then computed as $|R_{\\mathrm{in}}^{\\mathrm{num}} - R_{\\mathrm{in}}^{\\mathrm{ana}}| / R_{\\mathrm{in}}^{\\mathrm{ana}}$.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nimport math\n\ndef solve():\n    \"\"\"\n    Solves the cable theory problem by deriving analytical solutions and implementing \n    a numerical compartmental model to find the input resistance of a neurite \n    under sealed and shorted boundary conditions, and computes the relative error.\n    \"\"\"\n    \n    # Common physical parameters from the problem statement\n    a = 1.0e-6  # radius (m)\n    Rm = 1.0   # specific membrane resistance (Ohm * m^2)\n    Ri = 1.0   # specific intracellular resistivity (Ohm * m)\n    I_inj = 1.0  # injected current (A)\n\n    # --- Step 1: Derive lambda and related parameters from first principles ---\n    # r_i = Ri / (pi * a^2)\n    # r_m = Rm / (2 * pi * a)\n    # lambda = sqrt(r_m / r_i) = sqrt( (Rm / (2*pi*a)) / (Ri / (pi*a^2)) )\n    # lambda = sqrt(Rm * pi * a^2 / (2 * pi * a * Ri)) = sqrt(Rm * a / (2 * Ri))\n    lambda_val = math.sqrt((Rm * a) / (2 * Ri))\n\n    # Calculate r_i and r_m which are needed for analytical and numerical solutions\n    r_i = Ri / (math.pi * a**2)\n    r_m = Rm / (2 * math.pi * a)\n    \n    # Characteristic impedance Z_c = sqrt(r_m * r_i)\n    Z_c = math.sqrt(r_m * r_i)\n\n    # Test cases for cable length as a factor of lambda\n    L_factors = [0.1, 1.0, 4.0]\n    results = []\n\n    for L_factor in L_factors:\n        # --- Step 2: Set up discretization for the current case ---\n        L = L_factor * lambda_val\n        \n        # Follow the problem's rule for determining N and dx\n        dx_initial = lambda_val / 800.0\n        if L == 0:\n            N = 1\n            dx = 0\n        else:\n            N = math.ceil(L / dx_initial) + 1\n            dx = L / (N - 1)\n        \n        if N <= 1:\n            # Handle trivial case of zero-length or single-node cable\n            # Sealed: R_in is just the membrane resistance of the single compartment\n            R_in_ana_s = r_m / L if L > 0 else np.inf # Limit as L->0: inf\n            R_in_num_s = 1 / ((dx/2)/r_m) if dx > 0 else np.inf\n            # Shorted: R_in is 0 as it's shorted at x=0\n            R_in_ana_sh = 0.0\n            R_in_num_sh = 0.0\n            \n            err_s = 0.0 if np.isinf(R_in_ana_s) else abs(R_in_num_s - R_in_ana_s) / R_in_ana_s\n            err_sh = 0.0\n            results.extend([err_s, err_sh])\n            continue\n            \n        # Compartmental model parameters\n        g_i = 1.0 / (r_i * dx)\n        g_m = dx / r_m\n        g_m_end = (dx / 2.0) / r_m\n\n        # --- Case 1: Sealed End ---\n        # Analytical solution\n        R_in_ana_s = Z_c * (1.0 / math.tanh(L / lambda_val)) # coth(x) = 1/tanh(x)\n\n        # Numerical solution\n        A_s = np.zeros((N, N))\n        b_s = np.zeros(N)\n        b_s[0] = I_inj\n\n        # KCL at node 0\n        A_s[0, 0] = g_i + g_m_end\n        A_s[0, 1] = -g_i\n        # KCL at internal nodes\n        for i in range(1, N - 1):\n            A_s[i, i - 1] = -g_i\n            A_s[i, i] = 2 * g_i + g_m\n            A_s[i, i + 1] = -g_i\n        # KCL at sealed end node N-1\n        A_s[N - 1, N - 2] = -g_i\n        A_s[N - 1, N - 1] = g_i + g_m_end\n\n        V_s = np.linalg.solve(A_s, b_s)\n        R_in_num_s = V_s[0] / I_inj\n        \n        error_s = abs(R_in_num_s - R_in_ana_s) / R_in_ana_s\n        results.append(error_s)\n\n        # --- Case 2: Shorted End ---\n        # Analytical solution\n        R_in_ana_sh = Z_c * math.tanh(L / lambda_val)\n\n        # Numerical solution\n        A_sh = np.zeros((N, N))\n        b_sh = np.zeros(N)\n        b_sh[0] = I_inj\n\n        # KCL at node 0\n        A_sh[0, 0] = g_i + g_m_end\n        A_sh[0, 1] = -g_i\n        # KCL at internal nodes (up to N-2)\n        for i in range(1, N - 1):\n            A_sh[i, i - 1] = -g_i\n            A_sh[i, i] = 2 * g_i + g_m\n            A_sh[i, i + 1] = -g_i\n        # Dirichlet condition at shorted end node N-1\n        A_sh[N - 1, N - 1] = 1.0\n\n        V_sh = np.linalg.solve(A_sh, b_sh)\n        R_in_num_sh = V_sh[0] / I_inj\n        \n        error_sh = abs(R_in_num_sh - R_in_ana_sh) / R_in_ana_sh\n        results.append(error_sh)\n\n    # Format and print the final output as a single line\n    formatted_results = [\"{:.6e}\".format(res) for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2764063"}]}