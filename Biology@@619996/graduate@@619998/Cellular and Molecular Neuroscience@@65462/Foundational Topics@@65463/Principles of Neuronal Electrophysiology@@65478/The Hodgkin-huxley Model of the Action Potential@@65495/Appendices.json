{"hands_on_practices": [{"introduction": "The Hodgkin-Huxley model is fundamentally a system of differential equations that describe how membrane potential and channel gates evolve. Before simulating these dynamics over time, it is crucial to understand how the system's state at a single moment determines its immediate future. This foundational exercise [@problem_id:2763740] asks you to apply the central principle of charge conservation, $C_m \\frac{dV}{dt} = -I_{\\text{ion}}$, to calculate the instantaneous rate of change of the membrane potential, providing a snapshot of the forces driving neuronal excitability.", "problem": "A single-compartment patch of squid giant axon membrane obeys the Hodgkin–Huxley (HH) model (Hodgkin–Huxley (HH) formalism). Assume standard outward-positive current convention and an isopotential compartment. At an instant $t_0$, the instantaneous state is specified by membrane potential $V$ and gating variables $m$, $h$, and $n$. The membrane parameters are the specific capacitance $C_m=1\\ \\mu\\mathrm{F/cm}^2$, maximal conductances $\\bar{g}_{\\mathrm{Na}}=120\\ \\mathrm{mS/cm}^2$, $\\bar{g}_{\\mathrm{K}}=36\\ \\mathrm{mS/cm}^2$, $\\bar{g}_{L}=0.3\\ \\mathrm{mS/cm}^2$, and reversal potentials $E_{\\mathrm{Na}}=50\\ \\mathrm{mV}$, $E_{\\mathrm{K}}=-77\\ \\mathrm{mV}$, $E_{L}=-54.4\\ \\mathrm{mV}$. At $t_0$, the instantaneous values are $V=-60\\ \\mathrm{mV}$, $m=0.10$, $h=0.90$, and $n=0.20$. No external current is applied, so $I_{\\mathrm{app}}=0$.\n\nStarting only from conservation of charge on the membrane capacitor and the assumption that each ionic current is Ohmic with conductance given by a maximal value scaled by the appropriate Hodgkin–Huxley gating variable combination (sodium activation cubed times inactivation; potassium activation to the fourth power), compute the instantaneous time derivative $\\frac{dV}{dt}$ at $t_0$. Express your final numerical value in $\\mathrm{mV/ms}$ and round your answer to four significant figures. In addition, state in words whether the membrane potential is instantaneously increasing (depolarizing) or decreasing (hyperpolarizing) based on the sign of $\\frac{dV}{dt}$. Only the numerical value should appear in your final boxed answer.", "solution": "The problem statement is subjected to validation and is found to be valid. It is a well-posed, scientifically grounded problem in computational neuroscience based on the canonical Hodgkin-Huxley model. All necessary parameters and initial conditions are provided, and no contradictions or ambiguities are present.\n\nThe fundamental principle governing the membrane potential $V$ in an isopotential patch of membrane is the conservation of charge. The rate of change of charge stored on the membrane, which acts as a capacitor, is equal to the total current flowing across it. This is expressed by the equation:\n$$\nC_m \\frac{dV}{dt} = I_{\\text{total}}\n$$\nwhere $C_m$ is the specific membrane capacitance. The total current $I_{\\text{total}}$ is the sum of the externally applied current, $I_{\\text{app}}$, and the ionic currents flowing through channels in the membrane, $I_{\\text{ion}}$. Following the standard outward-positive current convention, the equation is written as:\n$$\nC_m \\frac{dV}{dt} = I_{\\text{app}} - I_{\\text{ion}}\n$$\nThe problem states that no external current is applied, so $I_{\\text{app}} = 0$. The total ionic current, $I_{\\text{ion}}$, is the sum of the individual currents for sodium ($I_{\\text{Na}}$), potassium ($I_{\\text{K}}$), and the non-specific leak ($I_L$):\n$$\nI_{\\text{ion}} = I_{\\text{Na}} + I_{\\text{K}} + I_L\n$$\nThus, the equation for the rate of change of membrane potential simplifies to:\n$$\n\\frac{dV}{dt} = -\\frac{1}{C_m} I_{\\text{ion}} = -\\frac{1}{C_m} (I_{\\text{Na}} + I_{\\text{K}} + I_L)\n$$\nAccording to the Hodgkin-Huxley formalism, each ionic current follows an Ohmic relationship, $I_x = g_x (V - E_x)$, where $g_x$ is the instantaneous conductance for ion species $x$ and $E_x$ is its Nernst reversal potential. The conductances for sodium and potassium are voltage- and time-dependent, determined by their respective gating variables. The problem provides the specific forms for these conductances:\nThe sodium current is $I_{\\text{Na}} = g_{\\text{Na}} (V - E_{\\text{Na}})$, with $g_{\\text{Na}} = \\bar{g}_{\\text{Na}} m^3 h$.\nThe potassium current is $I_{\\text{K}} = g_{\\text{K}} (V - E_{\\text{K}})$, with $g_{\\text{K}} = \\bar{g}_{\\text{K}} n^4$.\nThe leak current is $I_L = g_L (V - E_L)$, with constant conductance $g_L = \\bar{g}_L$.\n\nCombining these expressions, the full equation for $\\frac{dV}{dt}$ is:\n$$\n\\frac{dV}{dt} = -\\frac{1}{C_m} \\left[ \\bar{g}_{\\text{Na}} m^3 h (V - E_{\\text{Na}}) + \\bar{g}_{\\text{K}} n^4 (V - E_{\\text{K}}) + \\bar{g}_L (V - E_L) \\right]\n$$\nWe now substitute the given instantaneous values at time $t_0$:\nCapacitance: $C_m = 1\\ \\mu\\mathrm{F/cm}^2$.\nMembrane potential: $V = -60\\ \\mathrm{mV}$.\nGating variables: $m = 0.10$, $h = 0.90$, $n = 0.20$.\nMaximal conductances: $\\bar{g}_{\\text{Na}} = 120\\ \\mathrm{mS/cm}^2$, $\\bar{g}_{\\text{K}} = 36\\ \\mathrm{mS/cm}^2$, $\\bar{g}_{L} = 0.3\\ \\mathrm{mS/cm}^2$.\nReversal potentials: $E_{\\text{Na}} = 50\\ \\mathrm{mV}$, $E_{\\text{K}} = -77\\ \\mathrm{mV}$, $E_{L} = -54.4\\ \\mathrm{mV}$.\n\nFirst, we calculate each individual ionic current density. The units for current density will be $(\\mathrm{mS/cm}^2) \\times (\\mathrm{mV}) = \\mu\\mathrm{A/cm}^2$.\n\nSodium current density, $I_{\\text{Na}}$:\nThe driving force for sodium is $V - E_{\\text{Na}} = -60\\ \\mathrm{mV} - 50\\ \\mathrm{mV} = -110\\ \\mathrm{mV}$.\nThe instantaneous sodium conductance is $g_{\\text{Na}} = \\bar{g}_{\\text{Na}} m^3 h = (120\\ \\mathrm{mS/cm}^2) \\times (0.10)^3 \\times (0.90) = (120) \\times (0.001) \\times (0.90)\\ \\mathrm{mS/cm}^2 = 0.108\\ \\mathrm{mS/cm}^2$.\nSo, $I_{\\text{Na}} = (0.108\\ \\mathrm{mS/cm}^2) \\times (-110\\ \\mathrm{mV}) = -11.88\\ \\mu\\mathrm{A/cm}^2$.\n\nPotassium current density, $I_{\\text{K}}$:\nThe driving force for potassium is $V - E_{\\text{K}} = -60\\ \\mathrm{mV} - (-77\\ \\mathrm{mV}) = 17\\ \\mathrm{mV}$.\nThe instantaneous potassium conductance is $g_{\\text{K}} = \\bar{g}_{\\text{K}} n^4 = (36\\ \\mathrm{mS/cm}^2) \\times (0.20)^4 = (36) \\times (0.0016)\\ \\mathrm{mS/cm}^2 = 0.0576\\ \\mathrm{mS/cm}^2$.\nSo, $I_{\\text{K}} = (0.0576\\ \\mathrm{mS/cm}^2) \\times (17\\ \\mathrm{mV}) = 0.9792\\ \\mu\\mathrm{A/cm}^2$.\n\nLeak current density, $I_L$:\nThe driving force for leak is $V - E_L = -60\\ \\mathrm{mV} - (-54.4\\ \\mathrm{mV}) = -5.6\\ \\mathrm{mV}$.\nThe leak conductance is constant: $g_L = \\bar{g}_L = 0.3\\ \\mathrm{mS/cm}^2$.\nSo, $I_L = (0.3\\ \\mathrm{mS/cm}^2) \\times (-5.6\\ \\mathrm{mV}) = -1.68\\ \\mu\\mathrm{A/cm}^2$.\n\nNext, we sum these current densities to find the total ionic current density, $I_{\\text{ion}}$:\n$$\nI_{\\text{ion}} = I_{\\text{Na}} + I_{\\text{K}} + I_L = (-11.88 + 0.9792 - 1.68)\\ \\mu\\mathrm{A/cm}^2 = -12.5808\\ \\mu\\mathrm{A/cm}^2\n$$\nFinally, we compute $\\frac{dV}{dt}$:\n$$\n\\frac{dV}{dt} = -\\frac{I_{\\text{ion}}}{C_m} = -\\frac{-12.5808\\ \\mu\\mathrm{A/cm}^2}{1\\ \\mu\\mathrm{F/cm}^2} = 12.5808\\ \\frac{\\mu\\mathrm{A}}{\\mu\\mathrm{F}}\n$$\nThe units are $\\frac{\\mu\\mathrm{A}}{\\mu\\mathrm{F}} = \\frac{\\mathrm{A}}{\\mathrm{F}} = \\frac{\\mathrm{Coulomb/second}}{\\mathrm{Coulomb/Volt}} = \\mathrm{Volt/second}$. To convert to $\\mathrm{mV/ms}$, we note that $1\\ \\mathrm{V/s} = 1\\ \\mathrm{mV/ms}$. Therefore:\n$$\n\\frac{dV}{dt} = 12.5808\\ \\mathrm{mV/ms}\n$$\nThe problem requires the answer to be rounded to four significant figures.\n$$\n\\frac{dV}{dt} \\approx 12.58\\ \\mathrm{mV/ms}\n$$\nSince the sign of $\\frac{dV}{dt}$ is positive, the membrane potential is instantaneously increasing. This process is known as depolarization. The large inward sodium current dominates the smaller outward potassium and inward leak currents, causing the membrane potential to become less negative.", "answer": "$$\n\\boxed{12.58}\n$$", "id": "2763740"}, {"introduction": "The power of the Hodgkin-Huxley model lies in its description of time- and voltage-dependent conductances. This practice [@problem_id:2763691] moves from a static snapshot to dynamic behavior, focusing on the sodium channel inactivation gate, $h$. By simulating a classic two-pulse voltage-clamp protocol, you will explore how a depolarizing prepulse alters the availability of sodium channels, providing a concrete, mechanistic explanation for the phenomena of channel inactivation and the neuronal refractory period.", "problem": "You are asked to write a complete, runnable program that demonstrates, using the Hodgkin-Huxley (HH) model of sodium channel inactivation gate kinetics, how a brief depolarizing prepulse inactivates sodium channels and thereby alters the peak sodium current elicited by a subsequent test pulse. The modeling should be done under voltage clamp and should focus on the inactivation variable $h$; the activation variable $m$ may be assumed to equilibrate rapidly at the test pulse voltage.\n\nStart from the following well-established bases and definitions, all in the units specified below.\n\n- Hodgkin-Huxley (HH) gating kinetics are represented by first-order two-state kinetics under voltage clamp. The sodium inactivation gating variable $h$ obeys the ordinary differential equation (ODE): $$\\frac{dh}{dt} = \\alpha_h(V)\\,\\big(1 - h\\big) - \\beta_h(V)\\,h,$$ with $V$ the membrane potential under voltage clamp.\n- The sodium activation gating variable $m$ is defined by analogous rate functions $\\alpha_m(V)$ and $\\beta_m(V)$. For the purpose of computing the instantaneous peak sodium current at the onset of the test pulse, you may assume $m$ is at its steady-state value $m_{\\infty}(V)$ at the test pulse voltage $V$.\n- The macroscopic sodium current under voltage clamp is: $$I_{\\mathrm{Na}} = \\bar{g}_{\\mathrm{Na}}\\, m^3\\, h\\, \\big(V - E_{\\mathrm{Na}}\\big).$$\n\nUse the classic Hodgkin-Huxley rate functions (temperature approximately $6.3\\,^\\circ\\mathrm{C}$) for squid giant axon with $V$ in millivolts, $t$ in milliseconds, and rate constants in $\\mathrm{ms}^{-1}$:\n- $$\\alpha_m(V) = 0.1\\,\\frac{V + 40}{1 - e^{-(V+40)/10}},\\quad \\beta_m(V) = 4\\,e^{-(V+65)/18}.$$\n- $$\\alpha_h(V) = 0.07\\, e^{-(V+65)/20},\\quad \\beta_h(V) = \\frac{1}{1 + e^{-(V+35)/10}}.$$\n\nLet the following constants be fixed across all test cases:\n- Holding potential $V_{\\mathrm{hold}} = -65\\,\\mathrm{mV}$.\n- Sodium reversal potential $E_{\\mathrm{Na}} = 50\\,\\mathrm{mV}$.\n- Maximum sodium conductance $\\bar{g}_{\\mathrm{Na}} = 120\\,\\mathrm{mS/cm^2}$.\n\nProtocol to model:\n1. Initialize at holding potential $V_{\\mathrm{hold}}$ for a sufficiently long time such that $h$ is at its steady state $h_{\\infty}(V_{\\mathrm{hold}})$.\n2. Apply a prepulse to voltage $V_{\\mathrm{pre}}$ for a duration $t_{\\mathrm{pre}}$ (in milliseconds).\n3. Return to $V_{\\mathrm{hold}}$ for an interpulse interval $t_{\\mathrm{int}}$ (in milliseconds).\n4. Apply a test pulse to $V_{\\mathrm{test}}$; compute the instantaneous peak sodium current at the onset of the test pulse by taking $m = m_{\\infty}(V_{\\mathrm{test}})$ and the value of $h$ carried into the test pulse from steps $2$–$3$. You should assume that the peak occurs before $h$ changes appreciably during the test pulse.\n\nYour program must:\n- Numerically propagate the inactivation gate $h$ through the piecewise-constant voltage protocol using the ODE above. You may use any correct numerical technique to solve the first-order linear ODE over intervals of constant $V$.\n- Compute the instantaneous peak sodium current at the onset of the test pulse for each test case as a float in microamperes per square centimeter ($\\mu\\mathrm{A/cm^2}$). Note that with $\\bar{g}_{\\mathrm{Na}}$ in $\\mathrm{mS/cm^2}$ and potentials in $\\mathrm{mV}$, the current will be in $\\mu\\mathrm{A/cm^2}$ because $\\mathrm{mS}\\cdot\\mathrm{mV} = \\mu\\mathrm{A}$.\n- Round each result to exactly $3$ decimal places.\n\nTest suite:\nCompute the peak sodium current for each of the following five parameter sets $(V_{\\mathrm{pre}}, t_{\\mathrm{pre}}, t_{\\mathrm{int}}, V_{\\mathrm{test}})$, with all voltages in $\\mathrm{mV}$ and times in $\\mathrm{ms}$:\n- Case $1$: $(V_{\\mathrm{pre}}, t_{\\mathrm{pre}}, t_{\\mathrm{int}}, V_{\\mathrm{test}}) = \\big(-65, 5.0, 5.0, -10\\big)$.\n- Case $2$: $(V_{\\mathrm{pre}}, t_{\\mathrm{pre}}, t_{\\mathrm{int}}, V_{\\mathrm{test}}) = \\big(-10, 5.0, 0.0, -10\\big)$.\n- Case $3$: $(V_{\\mathrm{pre}}, t_{\\mathrm{pre}}, t_{\\mathrm{int}}, V_{\\mathrm{test}}) = \\big(-10, 5.0, 50.0, -10\\big)$.\n- Case $4$: $(V_{\\mathrm{pre}}, t_{\\mathrm{pre}}, t_{\\mathrm{int}}, V_{\\mathrm{test}}) = \\big(20, 2.0, 2.0, -10\\big)$.\n- Case $5$: $(V_{\\mathrm{pre}}, t_{\\mathrm{pre}}, t_{\\mathrm{int}}, V_{\\mathrm{test}}) = \\big(-30, 0.1, 1.0, -10\\big)$.\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the same order as the cases above. Each number must be rounded to exactly $3$ decimal places. For example, the output format must be exactly like\n$$[\\text{result}_1,\\text{result}_2,\\text{result}_3,\\text{result}_4,\\text{result}_5]$$\nwith no spaces, and the values are in $\\mu\\mathrm{A/cm^2}$.", "solution": "The problem is valid. It presents a standard, well-posed problem in computational neuroscience based on the canonical Hodgkin-Huxley model. All necessary equations, parameters, and conditions are provided, and they are scientifically sound and consistent. The task is to simulate the effect of a depolarizing prepulse on sodium channel availability and the resulting peak sodium current, a fundamental concept in electrophysiology.\n\nThe solution proceeds by first deriving the analytical solution for the inactivation gating variable, $h$, and then applying it sequentially through the specified voltage-clamp protocol.\n\nThe dynamics of the sodium channel inactivation gate, $h$, are described by the first-order linear ordinary differential equation:\n$$\n\\frac{dh}{dt} = \\alpha_h(V)(1 - h) - \\beta_h(V)h\n$$\nwhere $\\alpha_h(V)$ and $\\beta_h(V)$ are voltage-dependent rate constants. For a constant membrane potential $V$, as is the case during each step of a voltage-clamp protocol, this equation can be rearranged into a standard form:\n$$\n\\frac{dh}{dt} + (\\alpha_h(V) + \\beta_h(V))h = \\alpha_h(V)\n$$\nTo simplify, we define the voltage-dependent steady-state value, $h_{\\infty}(V)$, and the time constant, $\\tau_h(V)$:\n$$\nh_{\\infty}(V) = \\frac{\\alpha_h(V)}{\\alpha_h(V) + \\beta_h(V)}\n$$\n$$\n\\tau_h(V) = \\frac{1}{\\alpha_h(V) + \\beta_h(V)}\n$$\nThe differential equation then becomes:\n$$\n\\frac{dh}{dt} = \\frac{h_{\\infty}(V) - h}{\\tau_h(V)}\n$$\nGiven an initial value $h(t_0) = h_0$ at the beginning of a voltage step to $V$, this ODE has the exact analytical solution for any time $t \\ge t_0$:\n$$\nh(t) = h_{\\infty}(V) + (h_0 - h_{\\infty}(V)) \\exp\\left(-\\frac{t - t_0}{\\tau_h(V)}\\right)\n$$\nThis equation allows us to precisely calculate the value of $h$ at the end of any interval of constant voltage without resorting to numerical integration schemes like Euler or Runge-Kutta, thus avoiding numerical integration error.\n\nThe macroscopic sodium current, $I_{\\mathrm{Na}}$, is given by:\n$$\nI_{\\mathrm{Na}} = \\bar{g}_{\\mathrm{Na}}\\, m^3\\, h\\, (V - E_{\\mathrm{Na}})\n$$\nwhere $\\bar{g}_{\\mathrm{Na}}$ is the maximum sodium conductance, $E_{\\mathrm{Na}}$ is the sodium reversal potential, and $m$ is the activation gating variable. The problem states that for the purpose of calculating the *instantaneous peak current* at the onset of the test pulse, we assume the activation gate $m$ equilibrates instantaneously to its steady-state value $m_{\\infty}(V_{\\mathrm{test}})$. The value of $h$ is the one carried over from the preceding protocol steps, as inactivation is a slower process.\n\nThe computational procedure for each test case $(V_{\\mathrm{pre}}, t_{\\mathrm{pre}}, t_{\\mathrm{int}}, V_{\\mathrm{test}})$ is as follows:\n\n1.  **Initialization**: The system is first held at the holding potential $V_{\\mathrm{hold}} = -65\\,\\mathrm{mV}$ long enough for $h$ to reach its steady state. The initial value of $h$ is therefore $h_0 = h_{\\infty}(V_{\\mathrm{hold}})$.\n\n2.  **Prepulse Phase**: A voltage pulse to $V_{\\mathrm{pre}}$ is applied for a duration of $t_{\\mathrm{pre}}$. The value of $h$ at the end of this phase, $h_1$, is calculated using the analytical solution with initial value $h_0$:\n    $$\n    h_1 = h_{\\infty}(V_{\\mathrm{pre}}) + (h_0 - h_{\\infty}(V_{\\mathrm{pre}})) \\exp\\left(-\\frac{t_{\\mathrm{pre}}}{\\tau_h(V_{\\mathrm{pre}})}\\right)\n    $$\n\n3.  **Interpulse Interval**: The voltage is returned to $V_{\\mathrm{hold}}$ for a duration of $t_{\\mathrm{int}}$. This interval allows for partial or full recovery from any inactivation that occurred during the prepulse. The value of $h$ at the end of this interval, $h_2$, starts from $h_1$:\n    $$\n    h_2 = h_{\\infty}(V_{\\mathrm{hold}}) + (h_1 - h_{\\infty}(V_{\\mathrm{hold}})) \\exp\\left(-\\frac{t_{\\mathrm{int}}}{\\tau_h(V_{\\mathrm{hold}})}\\right)\n    $$\n    If $t_{\\mathrm{int}} = 0$, then trivially $h_2 = h_1$.\n\n4.  **Test Pulse and Current Calculation**: A test pulse to $V_{\\mathrm{test}}$ is applied. The instantaneous peak sodium current is calculated at the very onset of this pulse. At this moment:\n    -   The inactivation gate has the value $h_{peak} = h_2$.\n    -   The activation gate is assumed to be at its steady-state value $m_{peak} = m_{\\infty}(V_{\\mathrm{test}})$.\n    -   The driving force is $(V_{\\mathrm{test}} - E_{\\mathrm{Na}})$.\n\n    The peak current is then:\n    $$\n    I_{\\mathrm{Na,peak}} = \\bar{g}_{\\mathrm{Na}} \\cdot (m_{\\infty}(V_{\\mathrm{test}}))^3 \\cdot h_2 \\cdot (V_{\\mathrm{test}} - E_{\\mathrm{Na}})\n    $$\n    The units are consistent: with $\\bar{g}_{\\mathrm{Na}}$ in $\\mathrm{mS/cm^2}$ and potentials in $\\mathrm{mV}$, the current $I_{\\mathrm{Na,peak}}$ is in $\\mu\\mathrm{A/cm^2}$.\n\nThe provided Hodgkin-Huxley rate functions are used for all calculations. The special case for $\\alpha_m(V)$ where $V = -40\\,\\mathrm{mV}$ results in a $0/0$ indeterminate form, which must be handled by taking the limit using L'Hôpital's rule, yielding $\\alpha_m(-40) = 1.0\\,\\mathrm{ms}^{-1}$. Following this procedure for each test case provides the required set of peak sodium currents.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the peak sodium current in a Hodgkin-Huxley model under a\n    prepulse voltage-clamp protocol.\n    \"\"\"\n\n    #\n    # --- Model Constants and Parameters ---\n    #\n    G_NA_BAR = 120.0  # Maximum sodium conductance (mS/cm^2)\n    E_NA = 50.0       # Sodium reversal potential (mV)\n    V_HOLD = -65.0    # Holding potential (mV)\n\n    #\n    # --- Hodgkin-Huxley Rate Functions ---\n    #\n    def alpha_m(v):\n        \"\"\"Rate constant alpha_m for sodium activation.\"\"\"\n        # Handle the singularity at v = -40 mV using L'Hopital's rule.\n        if np.isclose(v, -40.0):\n            return 1.0\n        return 0.1 * (v + 40.0) / (1.0 - np.exp(-(v + 40.0) / 10.0))\n\n    def beta_m(v):\n        \"\"\"Rate constant beta_m for sodium activation.\"\"\"\n        return 4.0 * np.exp(-(v + 65.0) / 18.0)\n\n    def alpha_h(v):\n        \"\"\"Rate constant alpha_h for sodium inactivation.\"\"\"\n        return 0.07 * np.exp(-(v + 65.0) / 20.0)\n\n    def beta_h(v):\n        \"\"\"Rate constant beta_h for sodium inactivation.\"\"\"\n        return 1.0 / (1.0 + np.exp(-(v + 35.0) / 10.0))\n\n    #\n    # --- Steady-State and Time Constant Functions ---\n    #\n    def m_inf(v):\n        \"\"\"Steady-state activation m_infinity.\"\"\"\n        return alpha_m(v) / (alpha_m(v) + beta_m(v))\n\n    def h_inf(v):\n        \"\"\"Steady-state inactivation h_infinity.\"\"\"\n        return alpha_h(v) / (alpha_h(v) + beta_h(v))\n\n    def tau_h(v):\n        \"\"\"Inactivation time constant tau_h.\"\"\"\n        return 1.0 / (alpha_h(v) + beta_h(v))\n\n    #\n    # --- Analytical Solver for a Single Voltage Step ---\n    #\n    def solve_h_step(h_initial, v, t):\n        \"\"\"\n        Analytically solves for h after a time interval t at constant voltage v.\n        \"\"\"\n        if t == 0.0:\n            return h_initial\n        \n        h_infinity = h_inf(v)\n        tau = tau_h(v)\n        \n        return h_infinity + (h_initial - h_infinity) * np.exp(-t / tau)\n\n    #\n    # --- Main Simulation Function ---\n    #\n    def calculate_peak_current(v_pre, t_pre, t_int, v_test):\n        \"\"\"\n        Simulates the voltage-clamp protocol and calculates the peak sodium current.\n        \"\"\"\n        # Step 1: Initial condition at holding potential\n        h0 = h_inf(V_HOLD)\n        \n        # Step 2: Propagate h through the prepulse\n        h1 = solve_h_step(h0, v_pre, t_pre)\n        \n        # Step 3: Propagate h through the interpulse interval\n        h2 = solve_h_step(h1, V_HOLD, t_int)\n        \n        # Step 4: Calculate instantaneous peak current at the onset of the test pulse\n        m_peak = m_inf(v_test)\n        h_peak = h2\n        \n        i_na_peak = G_NA_BAR * (m_peak**3) * h_peak * (v_test - E_NA)\n        \n        return i_na_peak\n\n    #\n    # --- Test Cases ---\n    #\n    test_cases = [\n        # (V_pre, t_pre, t_int, V_test)\n        (-65.0, 5.0, 5.0, -10.0),  # Case 1: Control (prepulse at holding potential)\n        (-10.0, 5.0, 0.0, -10.0),  # Case 2: Inactivating prepulse, no recovery\n        (-10.0, 5.0, 50.0, -10.0), # Case 3: Inactivating prepulse, long recovery\n        (20.0, 2.0, 2.0, -10.0),   # Case 4: Strong inactivating prepulse, short recovery\n        (-30.0, 0.1, 1.0, -10.0),  # Case 5: Weak, brief prepulse, short recovery\n    ]\n\n    results = []\n    for case in test_cases:\n        v_pre, t_pre, t_int, v_test = case\n        peak_current = calculate_peak_current(v_pre, t_pre, t_int, v_test)\n        # Round to 3 decimal places as specified\n        results.append(f\"{round(peak_current, 3):.3f}\")\n\n    # Final print statement in the exact required format\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "2763691"}, {"introduction": "Having explored the model's static properties and the dynamics of a single gate, we now synthesize these elements to simulate the full Hodgkin-Huxley model and generate an action potential. This capstone practice [@problem_id:2763689] not only demonstrates the model's remarkable ability to reproduce physiological behavior but also encourages a deeper, critical analysis of its components. You will evaluate the accuracy of the quasi-steady-state approximation for the fast sodium activation gate, $m$, a common simplification in computational neuroscience, thereby gaining insight into the principles of model reduction.", "problem": "Consider the classical Hodgkin–Huxley (HH) model of the squid giant axon at temperature $6.3\\,^\\circ\\mathrm{C}$, governed by a capacitive current balance and voltage-dependent ion currents. The membrane voltage $V$ (in $\\mathrm{mV}$) evolves according to\n$$\nC_{\\mathrm{m}}\\,\\frac{dV}{dt} \\;=\\; I_{\\mathrm{ext}}(t)\\;-\\; I_{\\mathrm{Na}}(t)\\;-\\; I_{\\mathrm{K}}(t)\\;-\\; I_{\\mathrm{L}}(t),\n$$\nwhere $C_{\\mathrm{m}}$ is the membrane capacitance per unit area in $\\mathrm{\\mu F}/\\mathrm{cm}^2$, $I_{\\mathrm{ext}}$ is an externally injected current density in $\\mathrm{\\mu A}/\\mathrm{cm}^2$, and $I_{\\mathrm{Na}}, I_{\\mathrm{K}}, I_{\\mathrm{L}}$ are the sodium, potassium, and leak current densities in $\\mathrm{\\mu A}/\\mathrm{cm}^2$. The ionic currents are\n$$\nI_{\\mathrm{Na}} \\;=\\; \\bar{g}_{\\mathrm{Na}}\\,m^3 h\\,(V - E_{\\mathrm{Na}}),\\quad\nI_{\\mathrm{K}} \\;=\\; \\bar{g}_{\\mathrm{K}}\\,n^4\\,(V - E_{\\mathrm{K}}),\\quad\nI_{\\mathrm{L}} \\;=\\; \\bar{g}_{\\mathrm{L}}\\,(V - E_{\\mathrm{L}}),\n$$\nwith maximal conductances $\\bar{g}_{\\mathrm{Na}},\\bar{g}_{\\mathrm{K}},\\bar{g}_{\\mathrm{L}}$ in $\\mathrm{mS}/\\mathrm{cm}^2$ and reversal potentials $E_{\\mathrm{Na}},E_{\\mathrm{K}},E_{\\mathrm{L}}$ in $\\mathrm{mV}$. The gating variables $m, h, n$ satisfy first-order kinetics\n$$\n\\frac{dm}{dt} \\;=\\; \\alpha_m(V)\\,(1-m) - \\beta_m(V)\\,m,\\quad\n\\frac{dh}{dt} \\;=\\; \\alpha_h(V)\\,(1-h) - \\beta_h(V)\\,h,\\quad\n\\frac{dn}{dt} \\;=\\; \\alpha_n(V)\\,(1-n) - \\beta_n(V)\\,n,\n$$\nwith standard HH rate functions (all rates in $\\mathrm{ms}^{-1}$):\n$$\n\\alpha_m(V) \\;=\\; \\frac{0.1\\,(V+40)}{1 - e^{-(V+40)/10}},\\qquad \\beta_m(V) \\;=\\; 4\\,e^{-(V+65)/18},\\\\\n\\alpha_h(V) \\;=\\; 0.07\\,e^{-(V+65)/20},\\qquad\\;\\; \\beta_h(V) \\;=\\; \\frac{1}{1 + e^{-(V+35)/10}},\\\\\n\\alpha_n(V) \\;=\\; \\frac{0.01\\,(V+55)}{1 - e^{-(V+55)/10}},\\qquad \\beta_n(V) \\;=\\; 0.125\\,e^{-(V+65)/80}.\n$$\nDefine the steady-state (infinite-time) activation function for $m$ as\n$$\nm_{\\infty}(V) \\;=\\; \\frac{\\alpha_m(V)}{\\alpha_m(V) + \\beta_m(V)}.\n$$\nYou will analyze the accuracy of the quasi-steady-state (QSS) approximation $m \\approx m_{\\infty}(V)$ during the action potential upstroke by comparing the true sodium current to a QSS-approximated sodium current that replaces $m(t)$ with $m_{\\infty}(V(t))$, while keeping $h(t)$ unchanged:\n$$\nI_{\\mathrm{Na}}^{\\mathrm{true}}(t) \\;=\\; \\bar{g}_{\\mathrm{Na}}\\,m(t)^3 h(t)\\,(V(t) - E_{\\mathrm{Na}}),\\qquad\nI_{\\mathrm{Na}}^{\\mathrm{qss}}(t) \\;=\\; \\bar{g}_{\\mathrm{Na}}\\,\\big(m_{\\infty}(V(t))\\big)^3 h(t)\\,(V(t) - E_{\\mathrm{Na}}).\n$$\nTo probe time-scale effects, introduce a kinetics scaling factor $s_m$ applied only to $m$-gating rates, replacing $\\alpha_m(V)$ and $\\beta_m(V)$ by $s_m\\,\\alpha_m(V)$ and $s_m\\,\\beta_m(V)$, respectively. This preserves $m_{\\infty}(V)$ and scales the time constant $\\tau_m(V)$ by $1/s_m$.\n\nUse the following biophysical parameters:\n- $C_{\\mathrm{m}} = 1\\,\\mathrm{\\mu F}/\\mathrm{cm}^2$,\n- $\\bar{g}_{\\mathrm{Na}} = 120\\,\\mathrm{mS}/\\mathrm{cm}^2$,\n- $\\bar{g}_{\\mathrm{K}} = 36\\,\\mathrm{mS}/\\mathrm{cm}^2$,\n- $\\bar{g}_{\\mathrm{L}} = 0.3\\,\\mathrm{mS}/\\mathrm{cm}^2$,\n- $E_{\\mathrm{Na}} = 50\\,\\mathrm{mV}$, $E_{\\mathrm{K}} = -77\\,\\mathrm{mV}$, $E_{\\mathrm{L}} = -54.4\\,\\mathrm{mV}$.\nUse the initial voltage $V(0) = -65\\,\\mathrm{mV}$ and initialize $m(0), h(0), n(0)$ to their steady-state values at $V(0)$, that is $x(0) = x_{\\infty}(V(0))$ where $x \\in \\{m,h,n\\}$ and $x_{\\infty}(V) = \\alpha_x(V)/(\\alpha_x(V)+\\beta_x(V))$.\n\nNumerically integrate the HH system over a total duration of $T_{\\mathrm{end}} = 5\\,\\mathrm{ms}$ with a fixed time step no larger than $\\Delta t = 0.005\\,\\mathrm{ms}$ using a stable explicit method (for example, classical fourth-order Runge–Kutta). Use a square-pulse external current\n$$\nI_{\\mathrm{ext}}(t) \\;=\\; \n\\begin{cases}\nI_0, & 0 \\le t \\le T_{\\mathrm{inj}},\\\\\n0, & \\text{otherwise},\n\\end{cases}\n$$\nwith $(I_0, T_{\\mathrm{inj}})$ specified per test case below, in $\\mathrm{\\mu A}/\\mathrm{cm}^2$ and $\\mathrm{ms}$, respectively.\n\nDefine the upstroke analysis window $\\mathcal{W}$ as the set of time indices during which the membrane voltage satisfies $-55\\,\\mathrm{mV} < V(t) < 0\\,\\mathrm{mV}$. Over this window, quantify the QSS error in the sodium current using two dimensionless metrics:\n- The maximum normalized error\n$$\n\\varepsilon_{\\max} \\;=\\; \\frac{\\max_{t \\in \\mathcal{W}} \\big| I_{\\mathrm{Na}}^{\\mathrm{true}}(t) - I_{\\mathrm{Na}}^{\\mathrm{qss}}(t) \\big|}{\\max_{t \\in \\mathcal{W}} \\big| I_{\\mathrm{Na}}^{\\mathrm{true}}(t) \\big|}.\n$$\n- The root-mean-square (RMS) normalized error\n$$\n\\varepsilon_{\\mathrm{rms}} \\;=\\; \\frac{\\sqrt{\\frac{1}{|\\mathcal{W}|} \\sum_{t \\in \\mathcal{W}} \\big( I_{\\mathrm{Na}}^{\\mathrm{true}}(t) - I_{\\mathrm{Na}}^{\\mathrm{qss}}(t) \\big)^2}}{\\max_{t \\in \\mathcal{W}} \\big| I_{\\mathrm{Na}}^{\\mathrm{true}}(t) \\big|}.\n$$\nIf $\\mathcal{W}$ is empty or $\\max_{t \\in \\mathcal{W}} |I_{\\mathrm{Na}}^{\\mathrm{true}}(t)| = 0$, define both errors to be $0$.\n\nTest suite. Run the simulation for the following four parameter sets, each described by $(I_0, T_{\\mathrm{inj}}, s_m)$:\n- Case $1$: $(10,\\, 2.5,\\, 1.0)$,\n- Case $2$: $(10,\\, 2.5,\\, 0.5)$,\n- Case $3$: $(10,\\, 2.5,\\, 2.0)$,\n- Case $4$: $(15,\\, 2.0,\\, 1.0)$.\n\nRequirements for the program:\n- Implement the model and calculations exactly as stated, using units as specified.\n- Use a fixed step not larger than $\\Delta t = 0.005\\,\\mathrm{ms}$ and total duration $T_{\\mathrm{end}} = 5\\,\\mathrm{ms}$.\n- For each case, compute $(\\varepsilon_{\\max}, \\varepsilon_{\\mathrm{rms}})$ over $\\mathcal{W}$.\n- Express the final answers as decimal floats rounded to $6$ decimal places (no unit symbols in the output).\n- Final output format: Your program should produce a single line of output containing a comma-separated list with the $8$ floats corresponding to cases $1$ through $4$, in the order $[\\varepsilon_{\\max}^{(1)}, \\varepsilon_{\\mathrm{rms}}^{(1)}, \\varepsilon_{\\max}^{(2)}, \\varepsilon_{\\mathrm{rms}}^{(2)}, \\varepsilon_{\\max}^{(3)}, \\varepsilon_{\\mathrm{rms}}^{(3)}, \\varepsilon_{\\max}^{(4)}, \\varepsilon_{\\mathrm{rms}}^{(4)}]$, enclosed in square brackets (for example, $[0.012345,0.006789,\\dots]$).", "solution": "The problem presented is a standard exercise in computational neuroscience and is deemed valid after rigorous inspection. It is scientifically grounded in the canonical Hodgkin-Huxley model, is well-posed with all necessary parameters and conditions provided, and is formulated with objective, unambiguous language. We shall proceed with the solution.\n\nThe task is to quantify the error introduced by the quasi-steady-state (QSS) approximation for the sodium channel activation gating variable, $m$. This approximation, $m(t) \\approx m_{\\infty}(V(t))$, assumes that the activation gate responds instantaneously to changes in membrane voltage, $V$. We will assess this by simulating the full Hodgkin-Huxley model and comparing the true sodium current, $I_{\\mathrm{Na}}^{\\mathrm{true}}$, with an approximated current, $I_{\\mathrm{Na}}^{\\mathrm{qss}}$, where $m(t)$ is replaced by $m_{\\infty}(V(t))$.\n\nThe core of the problem is the numerical solution of a system of four coupled first-order ordinary differential equations (ODEs), which describe the temporal evolution of the membrane voltage $V$ and the three gating variables $m$, $h$, and $n$:\n$$\n\\frac{d\\mathbf{y}}{dt} = \\mathbf{F}(t, \\mathbf{y}), \\quad \\text{where} \\quad \\mathbf{y}(t) = [V(t), m(t), h(t), n(t)]^T.\n$$\nThe components of the vector function $\\mathbf{F}$ are given by:\n$$\n\\frac{dV}{dt} = \\frac{1}{C_{\\mathrm{m}}} \\left( I_{\\mathrm{ext}}(t) - \\bar{g}_{\\mathrm{Na}}\\,m^3 h\\,(V - E_{\\mathrm{Na}}) - \\bar{g}_{\\mathrm{K}}\\,n^4\\,(V - E_{\\mathrm{K}}) - \\bar{g}_{\\mathrm{L}}\\,(V - E_{\\mathrm{L}}) \\right)\n$$\n$$\n\\frac{dm}{dt} = s_m \\left( \\alpha_m(V)\\,(1-m) - \\beta_m(V)\\,m \\right)\n$$\n$$\n\\frac{dh}{dt} = \\alpha_h(V)\\,(1-h) - \\beta_h(V)\\,h\n$$\n$$\n\\frac{dn}{dt} = \\alpha_n(V)\\,(1-n) - \\beta_n(V)\\,n\n$$\nThe rate functions $\\alpha_x(V)$ and $\\beta_x(V)$ are given in the problem statement. Note the inclusion of the kinetics scaling factor $s_m$ for the $m$-gate dynamics. The external current $I_{\\mathrm{ext}}(t)$ is a simple step function.\n\nThe system is initialized at the resting state corresponding to $V(0) = -65\\,\\mathrm{mV}$. The initial values for the gating variables are their steady-state values at this voltage: $m(0) = m_{\\infty}(-65)$, $h(0) = h_{\\infty}(-65)$, and $n(0) = n_{\\infty}(-65)$, where for any gating variable $x \\in \\{m, h, n\\}$, the steady-state function is $x_{\\infty}(V) = \\frac{\\alpha_x(V)}{\\alpha_x(V) + \\beta_x(V)}$.\n\nWe will employ the classical fourth-order Runge-Kutta (RK4) method for numerical integration. For a given time step $\\Delta t$, the state vector $\\mathbf{y}_{i+1}$ at time $t_{i+1} = t_i + \\Delta t$ is calculated from $\\mathbf{y}_i$ as follows:\n$$\n\\mathbf{k}_1 = \\Delta t \\cdot \\mathbf{F}(t_i, \\mathbf{y}_i)\n$$\n$$\n\\mathbf{k}_2 = \\Delta t \\cdot \\mathbf{F}(t_i + \\frac{\\Delta t}{2}, \\mathbf{y}_i + \\frac{\\mathbf{k}_1}{2})\n$$\n$$\n\\mathbf{k}_3 = \\Delta t \\cdot \\mathbf{F}(t_i + \\frac{\\Delta t}{2}, \\mathbf{y}_i + \\frac{\\mathbf{k}_2}{2})\n$$\n$$\n\\mathbf{k}_4 = \\Delta t \\cdot \\mathbf{F}(t_i + \\Delta t, \\mathbf{y}_i + \\mathbf{k}_3)\n$$\n$$\n\\mathbf{y}_{i+1} = \\mathbf{y}_i + \\frac{1}{6}(\\mathbf{k}_1 + 2\\mathbf{k}_2 + 2\\mathbf{k}_3 + \\mathbf{k}_4)\n$$\nThis procedure is repeated for the total duration $T_{\\mathrm{end}} = 5\\,\\mathrm{ms}$ with a time step of $\\Delta t=0.005\\,\\mathrm{ms}$.\n\nA specific computational detail is the handling of removable singularities in the rate functions $\\alpha_m(V)$ and $\\alpha_n(V)$. For instance, $\\alpha_m(V)$ has a $0/0$ indeterminate form at $V = -40\\,\\mathrm{mV}$. Applying L'Hôpital's rule gives the limit:\n$$\n\\lim_{V \\to -40} \\alpha_m(V) = \\lim_{V \\to -40} \\frac{0.1\\,(V+40)}{1 - e^{-(V+40)/10}} = 1.0\\,\\mathrm{ms}^{-1}.\n$$\nSimilarly, for $\\alpha_n(V)$ at $V = -55\\,\\mathrm{mV}$:\n$$\n\\lim_{V \\to -55} \\alpha_n(V) = \\lim_{V \\to -55} \\frac{0.01\\,(V+55)}{1 - e^{-(V+55)/10}} = 0.1\\,\\mathrm{ms}^{-1}.\n$$\nThese cases must be handled explicitly in the implementation to ensure numerical stability.\n\nAfter the simulation yields the time series for $V(t)$, $m(t)$, and $h(t)$, we compute the two sodium currents:\n$$\nI_{\\mathrm{Na}}^{\\mathrm{true}}(t) = \\bar{g}_{\\mathrm{Na}}\\,m(t)^3 h(t)\\,(V(t) - E_{\\mathrm{Na}})\n$$\n$$\nI_{\\mathrm{Na}}^{\\mathrm{qss}}(t) = \\bar{g}_{\\mathrm{Na}}\\,\\big(m_{\\infty}(V(t))\\big)^3 h(t)\\,(V(t) - E_{\\mathrm{Na}})\n$$\nwhere $m_{\\infty}(V(t)) = \\frac{\\alpha_m(V(t))}{\\alpha_m(V(t)) + \\beta_m(V(t))}$.\n\nThe analysis is restricted to the action potential upstroke, defined by the time window $\\mathcal{W}$ where the voltage is between $-55\\,\\mathrm{mV}$ and $0\\,\\mathrm{mV}$. Within this window, we calculate the absolute difference between the currents, find the maximum of this difference, and compute the root-mean-square of the difference. Both results are normalized by the maximum absolute value of the true sodium current, $\\max_{t \\in \\mathcal{W}} |I_{\\mathrm{Na}}^{\\mathrm{true}}(t)|$, to obtain the dimensionless error metrics $\\varepsilon_{\\max}$ and $\\varepsilon_{\\mathrm{rms}}$. If the conditions for an action potential upstroke are not met (i.e., $\\mathcal{W}$ is empty), the error is defined as $0$.\n\nThis entire procedure is executed for each of the four specified test cases, and the resulting eight error values are formatted as required. The scaling factor $s_m$ directly modulates the time constant of $m$-gating, $\\tau_m$. When $s_m < 1$, the kinetics are slower, and we expect the QSS approximation to be less accurate. When $s_m > 1$, the kinetics are faster, and the QSS approximation should improve. The comparison across cases will demonstrate this dependence quantitatively.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the Hodgkin-Huxley model problem and calculates QSS errors.\n    \"\"\"\n\n    # Biophysical parameters\n    C_m = 1.0  # uF/cm^2\n    g_Na_bar = 120.0  # mS/cm^2\n    g_K_bar = 36.0  # mS/cm^2\n    g_L = 0.3  # mS/cm^2\n    E_Na = 50.0  # mV\n    E_K = -77.0  # mV\n    E_L = -54.4  # mV\n\n    # Simulation parameters\n    T_end = 5.0  # ms\n    dt = 0.005  # ms\n\n    # Rate functions\n    def alpha_m(V):\n        if np.isclose(V, -40.0):\n            return 1.0\n        return 0.1 * (V + 40.0) / (1.0 - np.exp(-(V + 40.0) / 10.0))\n\n    def beta_m(V):\n        return 4.0 * np.exp(-(V + 65.0) / 18.0)\n\n    def alpha_h(V):\n        return 0.07 * np.exp(-(V + 65.0) / 20.0)\n\n    def beta_h(V):\n        return 1.0 / (1.0 + np.exp(-(V + 35.0) / 10.0))\n\n    def alpha_n(V):\n        if np.isclose(V, -55.0):\n            return 0.1\n        return 0.01 * (V + 55.0) / (1.0 - np.exp(-(V + 55.0) / 10.0))\n\n    def beta_n(V):\n        return 0.125 * np.exp(-(V + 65.0) / 80.0)\n\n    # Steady-state functions\n    def x_inf(V, alpha_func, beta_func):\n        return alpha_func(V) / (alpha_func(V) + beta_func(V))\n\n    def m_inf(V):\n        return x_inf(V, alpha_m, beta_m)\n\n    def h_inf(V):\n        return x_inf(V, alpha_h, beta_h)\n\n    def n_inf(V):\n        return x_inf(V, alpha_n, beta_n)\n\n    # ODE system definition\n    def F(t, y, I_0, T_inj, s_m):\n        V, m, h, n = y\n        \n        # External current\n        I_ext = I_0 if 0 <= t <= T_inj else 0.0\n        \n        # Ionic currents\n        I_Na = g_Na_bar * (m**3) * h * (V - E_Na)\n        I_K = g_K_bar * (n**4) * (V - E_K)\n        I_L = g_L * (V - E_L)\n        \n        # Derivatives\n        dV_dt = (I_ext - I_Na - I_K - I_L) / C_m\n        dm_dt = s_m * (alpha_m(V) * (1.0 - m) - beta_m(V) * m)\n        dh_dt = alpha_h(V) * (1.0 - h) - beta_h(V) * h\n        dn_dt = alpha_n(V) * (1.0 - n) - beta_n(V) * n\n        \n        return np.array([dV_dt, dm_dt, dh_dt, dn_dt])\n\n    def run_simulation(I_0, T_inj, s_m):\n        # Time steps\n        t_steps = np.arange(0, T_end + dt, dt)\n        num_steps = len(t_steps)\n        \n        # Initial conditions\n        V0 = -65.0\n        y = np.zeros((num_steps, 4))\n        y[0] = [V0, m_inf(V0), h_inf(V0), n_inf(V0)]\n        \n        # RK4 Integration\n        for i in range(num_steps - 1):\n            t = t_steps[i]\n            \n            k1 = dt * F(t, y[i], I_0, T_inj, s_m)\n            k2 = dt * F(t + 0.5 * dt, y[i] + 0.5 * k1, I_0, T_inj, s_m)\n            k3 = dt * F(t + 0.5 * dt, y[i] + 0.5 * k2, I_0, T_inj, s_m)\n            k4 = dt * F(t + dt, y[i] + k3, I_0, T_inj, s_m)\n            \n            y[i+1] = y[i] + (k1 + 2*k2 + 2*k3 + k4) / 6.0\n            \n        V_t, m_t, h_t, n_t = y[:,0], y[:,1], y[:,2], y[:,3]\n        \n        # Post-processing and error calculation\n        \n        # Find analysis window\n        upstroke_indices = np.where((V_t > -55.0) & (V_t < 0.0))[0]\n        \n        if len(upstroke_indices) == 0:\n            return 0.0, 0.0\n\n        # Calculate currents\n        V_w = V_t[upstroke_indices]\n        m_w = m_t[upstroke_indices]\n        h_w = h_t[upstroke_indices]\n\n        # m_inf for QSS calculation, vectorize calculation\n        m_inf_vec = np.vectorize(m_inf)\n        m_inf_w = m_inf_vec(V_w)\n        \n        I_Na_true = g_Na_bar * (m_w**3) * h_w * (V_w - E_Na)\n        I_Na_qss = g_Na_bar * (m_inf_w**3) * h_w * (V_w - E_Na)\n        \n        # Normalization factor\n        norm_factor = np.max(np.abs(I_Na_true))\n        \n        if np.isclose(norm_factor, 0.0):\n            return 0.0, 0.0\n        \n        # Error metrics\n        error_diff = I_Na_true - I_Na_qss\n        \n        e_max = np.max(np.abs(error_diff)) / norm_factor\n        \n        rms_error_val = np.sqrt(np.mean(error_diff**2))\n        e_rms = rms_error_val / norm_factor\n        \n        return e_max, e_rms\n\n    # Test cases\n    test_cases = [\n        (10.0, 2.5, 1.0),  # Case 1\n        (10.0, 2.5, 0.5),  # Case 2\n        (10.0, 2.5, 2.0),  # Case 3\n        (15.0, 2.0, 1.0),  # Case 4\n    ]\n\n    results = []\n    for case in test_cases:\n        I_0, T_inj, s_m = case\n        e_max, e_rms = run_simulation(I_0, T_inj, s_m)\n        results.append(f\"{e_max:.6f}\")\n        results.append(f\"{e_rms:.6f}\")\n\n    # Final print statement\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "2763689"}]}