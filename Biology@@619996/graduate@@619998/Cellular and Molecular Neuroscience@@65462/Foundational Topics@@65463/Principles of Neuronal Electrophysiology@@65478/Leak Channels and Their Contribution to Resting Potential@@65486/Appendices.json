{"hands_on_practices": [{"introduction": "The macroscopic conductances used in cellular models, such as the total leak potassium conductance $g_K$, are emergent properties arising from the collective action of thousands of microscopic ion channels embedded in the neuronal membrane. This exercise provides hands-on practice in scaling up from the single-molecule level to the whole-cell level. By using fundamental parameters like single-channel conductance, channel density, and open probability, you will perform a first-principles calculation to determine a neuron's macroscopic conductance, gaining a concrete understanding of how molecular details shape cellular electrophysiology [@problem_id:2720540].", "id": "2720540", "problem": "A neuronâ€™s soma is approximated as a sphere of radius $10\\,\\mu\\mathrm{m}$. The membrane uniformly expresses Two-Pore Domain Potassium (K2P) leak channels with a reported single-channel conductance of $10\\,\\mathrm{pS}$ and a surface density of $5\\,\\mu\\mathrm{m}^{-2}$. At the resting condition of interest, each channel has an open probability of $0.8$. Assume channels act independently and identically, the macroscopic membrane leak conductance is the sum of the conductances of simultaneously open channels, and the expected number of channels equals the surface density times the membrane area. Treat the soma membrane alone as the relevant surface. Using only these fundamentals and first principles of additivity, compute the macroscopic potassium leak conductance $g_{K}$ contributed by these channels over the soma. Express your final answer in nanosiemens and round your result to four significant figures.", "solution": "The task is to compute the macroscopic conductance from many identical, independent channels characterized by a single-channel conductance and an open probability, distributed uniformly over a spherical membrane.\n\nStart with the soma geometry. For a sphere of radius $r$, the surface area is\n$$\nA \\;=\\; 4\\pi r^{2}.\n$$\nWith $r = 10\\,\\mu\\mathrm{m}$, this gives\n$$\nA \\;=\\; 4\\pi \\left(10\\,\\mu\\mathrm{m}\\right)^{2} \\;=\\; 400\\pi\\,\\mu\\mathrm{m}^{2}.\n$$\n\nLet the channel surface density be $\\rho = 5\\,\\mu\\mathrm{m}^{-2}$. The expected total number of channels on the soma is\n$$\nN \\;=\\; \\rho\\,A \\;=\\; \\left(5\\,\\mu\\mathrm{m}^{-2}\\right)\\left(400\\pi\\,\\mu\\mathrm{m}^{2}\\right) \\;=\\; 2000\\pi.\n$$\n\nIf each channel is open with probability $p_{\\mathrm{o}} = 0.8$, then the expected number of open channels is\n$$\nN_{\\mathrm{open}} \\;=\\; p_{\\mathrm{o}}\\,N \\;=\\; 0.8 \\times 2000\\pi \\;=\\; 1600\\pi.\n$$\n\nLet the single-channel conductance be $\\gamma = 10\\,\\mathrm{pS}$. Under independence and additivity, the macroscopic conductance is the sum over open channels, which equals the single-channel conductance times the expected number of open channels:\n$$\ng_{K} \\;=\\; \\gamma \\, N_{\\mathrm{open}} \\;=\\; \\left(10\\,\\mathrm{pS}\\right)\\left(1600\\pi\\right) \\;=\\; 16000\\pi\\,\\mathrm{pS}.\n$$\n\nConvert to nanosiemens using $1\\,\\mathrm{nS} = 1000\\,\\mathrm{pS}$:\n$$\ng_{K} \\;=\\; \\frac{16000\\pi\\,\\mathrm{pS}}{1000} \\;=\\; 16\\pi\\,\\mathrm{nS}.\n$$\n\nNow evaluate numerically to the requested precision. Using $\\pi \\approx 3.141592654$,\n$$\ng_{K} \\;\\approx\\; 16 \\times 3.141592654 \\,\\mathrm{nS} \\;=\\; 50.26548246\\,\\mathrm{nS}.\n$$\n\nRounded to four significant figures, this is\n$$\ng_{K} \\;\\approx\\; 50.27\\,\\mathrm{nS}.\n$$", "answer": "$$\\boxed{50.27}$$"}, {"introduction": "With an understanding of how macroscopic conductances are formed, we can now explore their primary role in setting the neuron's resting membrane potential, $V_{\\text{rest}}$. The resting potential is not a fixed value but a dynamic equilibrium determined by the relative \"tug-of-war\" between different ion species, each pulling the potential towards its own Nernst potential. This practice guides you through the derivation and application of the chord conductance equation, a fundamental model in electrophysiology, showing precisely how changing the conductance for one ion, such as chloride, shifts the balance and alters the resting potential [@problem_id:2720489].", "id": "2720489", "problem": "A small isopotential neuronal membrane patch at constant temperature expresses only leak pathways for potassium, sodium, and chloride ions. Assume leak currents are ohmic and linear. For each ion species $i \\in \\{K, \\mathrm{Na}, \\mathrm{Cl}\\}$, the leak current is given by $I_{i} = g_{i}\\,(V - E_{i})$, where $g_{i}$ is the leak conductance, $V$ is the membrane potential, and $E_{i}$ is the reversal potential for species $i$. At resting steady state, capacitive current is zero and the algebraic sum of the leak currents is zero.\n\n1. Using only the steady-state current balance and the definition of the leak currents above, derive from first principles the dependence of the resting potential $V_{\\text{rest}}$ on $g_{\\mathrm{Cl}}$ when $g_{K}$, $g_{\\mathrm{Na}}$, $E_{K}$, $E_{\\mathrm{Na}}$, and $E_{\\mathrm{Cl}}$ are held fixed. Show that increasing $g_{\\mathrm{Cl}}$ moves $V_{\\text{rest}}$ toward $E_{\\mathrm{Cl}}$.\n\n2. For a specific membrane patch, the parameters are $E_{K} = -90\\,\\text{mV}$, $E_{\\mathrm{Na}} = +60\\,\\text{mV}$, $E_{\\mathrm{Cl}} = -65\\,\\text{mV}$, $g_{K} = 10\\,\\text{nS}$, $g_{\\mathrm{Na}} = 0.5\\,\\text{nS}$, and an initial $g_{\\mathrm{Cl}} = 1.0\\,\\text{nS}$. Holding $g_{K}$ and $g_{\\mathrm{Na}}$ fixed, compute the signed change in the resting potential $V_{\\text{rest}}$ (in millivolts) produced by doubling $g_{\\mathrm{Cl}}$ to $2.0\\,\\text{nS}$.\n\nExpress your final numeric answer as the signed change in millivolts, rounded to four significant figures, and use millivolts as the unit for all intermediate calculations.", "solution": "The problem statement is first subjected to rigorous validation.\n\n**Step 1: Extract Givens**\nThe following information is provided verbatim or by direct definition:\n- The system is a small isopotential neuronal membrane patch at constant temperature.\n- It expresses only leak pathways for potassium ($K$), sodium ($\\mathrm{Na}$), and chloride ($\\mathrm{Cl}$) ions.\n- The ion species are indexed by $i \\in \\{K, \\mathrm{Na}, \\mathrm{Cl}\\}$.\n- The leak current for each species is $I_{i} = g_{i}\\,(V - E_{i})$, where $g_{i}$ is the leak conductance, $V$ is the membrane potential, and $E_{i}$ is the reversal potential.\n- At resting steady state, capacitive current is zero.\n- The algebraic sum of the leak currents is zero: $\\sum I_i = 0$.\n- Part 1 constraints: $g_{K}$, $g_{\\mathrm{Na}}$, $E_{K}$, $E_{\\mathrm{Na}}$, and $E_{\\mathrm{Cl}}$ are held fixed.\n- Part 2 parameters:\n  - $E_{K} = -90\\,\\text{mV}$\n  - $E_{\\mathrm{Na}} = +60\\,\\text{mV}$\n  - $E_{\\mathrm{Cl}} = -65\\,\\text{mV}$\n  - $g_{K} = 10\\,\\text{nS}$\n  - $g_{\\mathrm{Na}} = 0.5\\,\\text{nS}$\n  - Initial chloride conductance: $g_{\\mathrm{Cl},1} = 1.0\\,\\text{nS}$\n  - Final chloride conductance: $g_{\\mathrm{Cl},2} = 2.0\\,\\text{nS}$\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is evaluated against the required criteria.\n- **Scientifically Grounded**: The problem describes a simplified but standard model of a neuron's resting membrane potential, based on the principle of zero net current at steady state and an ohmic model for ionic currents. This is a fundamental concept in electrophysiology known as the chord conductance equation, a direct consequence of Kirchhoff's current law applied to the membrane equivalent circuit. The model is scientifically sound.\n- **Well-Posed**: The problem is well-posed. Part 1 asks for a derivation and a qualitative analysis, which can be performed from the given equations. Part 2 provides all necessary numerical values to calculate a unique quantitative answer.\n- **Objective**: The problem is stated in objective, technical language, free of ambiguity or subjective claims. The parameters provided are typical for a mammalian neuron.\n\nThe problem exhibits none of the specified flaws. It is not scientifically unsound, non-formalizable, incomplete, unrealistic, ill-posed, or trivial.\n\n**Step 3: Verdict and Action**\nThe problem is valid. A complete solution will be provided.\n\n**Part 1: Derivation and Analysis**\n\nThe fundamental principle at steady state is that there is no net flow of charge across the membrane. Given that capacitive current is zero, the sum of all ionic currents must be zero.\n$$I_K + I_{\\mathrm{Na}} + I_{\\mathrm{Cl}} = 0$$\nSubstitute the given linear ohmic expression for each current, $I_i = g_i(V - E_i)$. At rest, the membrane potential is the resting potential, $V = V_{\\text{rest}}$.\n$$g_K(V_{\\text{rest}} - E_K) + g_{\\mathrm{Na}}(V_{\\text{rest}} - E_{\\mathrm{Na}}) + g_{\\mathrm{Cl}}(V_{\\text{rest}} - E_{\\mathrm{Cl}}) = 0$$\nTo derive the dependence of $V_{\\text{rest}}$ on the conductances and reversal potentials, we must solve this linear equation for $V_{\\text{rest}}$. We expand the terms:\n$$g_K V_{\\text{rest}} - g_K E_K + g_{\\mathrm{Na}} V_{\\text{rest}} - g_{\\mathrm{Na}} E_{\\mathrm{Na}} + g_{\\mathrm{Cl}} V_{\\text{rest}} - g_{\\mathrm{Cl}} E_{\\mathrm{Cl}} = 0$$\nGroup the terms containing $V_{\\text{rest}}$:\n$$V_{\\text{rest}}(g_K + g_{\\mathrm{Na}} + g_{\\mathrm{Cl}}) = g_K E_K + g_{\\mathrm{Na}} E_{\\mathrm{Na}} + g_{\\mathrm{Cl}} E_{\\mathrm{Cl}}$$\nIsolating $V_{\\text{rest}}$ yields the expression for the resting potential, which is a weighted average of the reversal potentials where the conductances serve as the weights:\n$$V_{\\text{rest}} = \\frac{g_K E_K + g_{\\mathrm{Na}} E_{\\mathrm{Na}} + g_{\\mathrm{Cl}} E_{\\mathrm{Cl}}}{g_K + g_{\\mathrm{Na}} + g_{\\mathrm{Cl}}}$$\nThis equation shows the explicit dependence of $V_{\\text{rest}}$ on $g_{\\mathrm{Cl}}$.\n\nTo demonstrate that increasing $g_{\\mathrm{Cl}}$ moves $V_{\\text{rest}}$ toward $E_{\\mathrm{Cl}}$, we analyze the rate of change of $V_{\\text{rest}}$ with respect to $g_{\\mathrm{Cl}}$. We compute the partial derivative $\\frac{\\partial V_{\\text{rest}}}{\\partial g_{\\mathrm{Cl}}}$, treating all other parameters ($g_K$, $g_{\\mathrm{Na}}$, $E_K$, $E_{\\mathrm{Na}}$, $E_{\\mathrm{Cl}}$) as constants. Using the quotient rule for differentiation, $(\\frac{f}{h})' = \\frac{f'h-fh'}{h^2}$, where $f = g_K E_K + g_{\\mathrm{Na}} E_{\\mathrm{Na}} + g_{\\mathrm{Cl}} E_{\\mathrm{Cl}}$ and $h = g_K + g_{\\mathrm{Na}} + g_{\\mathrm{Cl}}$.\n\nThe derivatives of the numerator and denominator with respect to $g_{\\mathrm{Cl}}$ are:\n$$\\frac{\\partial f}{\\partial g_{\\mathrm{Cl}}} = E_{\\mathrm{Cl}}$$\n$$\\frac{\\partial h}{\\partial g_{\\mathrm{Cl}}} = 1$$\nApplying the quotient rule:\n$$\\frac{\\partial V_{\\text{rest}}}{\\partial g_{\\mathrm{Cl}}} = \\frac{(E_{\\mathrm{Cl}})(g_K + g_{\\mathrm{Na}} + g_{\\mathrm{Cl}}) - (g_K E_K + g_{\\mathrm{Na}} E_{\\mathrm{Na}} + g_{\\mathrm{Cl}} E_{\\mathrm{Cl}})(1)}{(g_K + g_{\\mathrm{Na}} + g_{\\mathrm{Cl}})^2}$$\nWe can substitute the expression for $V_{\\text{rest}}$ back into the numerator:\n$$(g_K E_K + g_{\\mathrm{Na}} E_{\\mathrm{Na}} + g_{\\mathrm{Cl}} E_{\\mathrm{Cl}}) = V_{\\text{rest}}(g_K + g_{\\mathrm{Na}} + g_{\\mathrm{Cl}})$$\nThis simplifies the derivative:\n$$\\frac{\\partial V_{\\text{rest}}}{\\partial g_{\\mathrm{Cl}}} = \\frac{E_{\\mathrm{Cl}}(g_K + g_{\\mathrm{Na}} + g_{\\mathrm{Cl}}) - V_{\\text{rest}}(g_K + g_{\\mathrm{Na}} + g_{\\mathrm{Cl}})}{(g_K + g_{\\mathrm{Na}} + g_{\\mathrm{Cl}})^2} = \\frac{(E_{\\mathrm{Cl}} - V_{\\text{rest}})(g_K + g_{\\mathrm{Na}} + g_{\\mathrm{Cl}})}{(g_K + g_{\\mathrm{Na}} + g_{\\mathrm{Cl}})^2}$$\n$$\\frac{\\partial V_{\\text{rest}}}{\\partial g_{\\mathrm{Cl}}} = \\frac{E_{\\mathrm{Cl}} - V_{\\text{rest}}}{g_K + g_{\\mathrm{Na}} + g_{\\mathrm{Cl}}}$$\nSince conductances are non-negative physical quantities, the denominator ($g_K + g_{\\mathrm{Na}} + g_{\\mathrm{Cl}}$) is always positive. Therefore, the sign of the derivative is determined by the sign of the term $(E_{\\mathrm{Cl}} - V_{\\text{rest}})$.\n- If $V_{\\text{rest}} < E_{\\mathrm{Cl}}$, then $(E_{\\mathrm{Cl}} - V_{\\text{rest}}) > 0$, so $\\frac{\\partial V_{\\text{rest}}}{\\partial g_{\\mathrm{Cl}}} > 0$. An increase in $g_{\\mathrm{Cl}}$ leads to an increase in $V_{\\text{rest}}$, moving it toward $E_{\\mathrm{Cl}}$.\n- If $V_{\\text{rest}} > E_{\\mathrm{Cl}}$, then $(E_{\\mathrm{Cl}} - V_{\\text{rest}}) < 0$, so $\\frac{\\partial V_{\\text{rest}}}{\\partial g_{\\mathrm{Cl}}} < 0$. An increase in $g_{\\mathrm{Cl}}$ leads to a decrease in $V_{\\text{rest}}$, also moving it toward $E_{\\mathrm{Cl}}$.\n- If $V_{\\text{rest}} = E_{\\mathrm{Cl}}$, then $\\frac{\\partial V_{\\text{rest}}}{\\partial g_{\\mathrm{Cl}}} = 0$, and the system is at equilibrium with respect to chloride.\n\nThis analysis rigorously demonstrates that increasing the chloride leak conductance, $g_{\\mathrm{Cl}}$, invariably moves the resting potential $V_{\\text{rest}}$ closer to the chloride reversal potential, $E_{\\mathrm{Cl}}$.\n\n**Part 2: Numerical Calculation**\n\nWe are asked to compute the change in resting potential, $\\Delta V_{\\text{rest}}$, when $g_{\\mathrm{Cl}}$ is doubled. We use the derived expression for $V_{\\text{rest}}$ and the provided parameters. All potentials will be in millivolts ($\\text{mV}$) and conductances in nanosiemens ($\\text{nS}$).\n\nThe parameters are: $E_{K} = -90$, $E_{\\mathrm{Na}} = 60$, $E_{\\mathrm{Cl}} = -65$, $g_{K} = 10$, $g_{\\mathrm{Na}} = 0.5$.\n\nFirst, calculate the initial resting potential, $V_{\\text{rest},1}$, with $g_{\\mathrm{Cl},1} = 1.0\\,\\text{nS}$.\n$$V_{\\text{rest},1} = \\frac{g_K E_K + g_{\\mathrm{Na}} E_{\\mathrm{Na}} + g_{\\mathrm{Cl},1} E_{\\mathrm{Cl}}}{g_K + g_{\\mathrm{Na}} + g_{\\mathrm{Cl},1}}$$\n$$V_{\\text{rest},1} = \\frac{(10)(-90) + (0.5)(60) + (1.0)(-65)}{10 + 0.5 + 1.0} = \\frac{-900 + 30 - 65}{11.5} = \\frac{-935}{11.5}\\,\\text{mV}$$\n\nNext, calculate the final resting potential, $V_{\\text{rest},2}$, with $g_{\\mathrm{Cl},2} = 2.0\\,\\text{nS}$.\n$$V_{\\text{rest},2} = \\frac{g_K E_K + g_{\\mathrm{Na}} E_{\\mathrm{Na}} + g_{\\mathrm{Cl},2} E_{\\mathrm{Cl}}}{g_K + g_{\\mathrm{Na}} + g_{\\mathrm{Cl},2}}$$\n$$V_{\\text{rest},2} = \\frac{(10)(-90) + (0.5)(60) + (2.0)(-65)}{10 + 0.5 + 2.0} = \\frac{-900 + 30 - 130}{12.5} = \\frac{-1000}{12.5} = -80\\,\\text{mV}$$\n\nThe signed change in resting potential is $\\Delta V_{\\text{rest}} = V_{\\text{rest},2} - V_{\\text{rest},1}$.\n$$\\Delta V_{\\text{rest}} = -80 - \\left(\\frac{-935}{11.5}\\right) = -80 + \\frac{935}{11.5}$$\nNumerically, $\\frac{935}{11.5} \\approx 81.3043478...$\n$$\\Delta V_{\\text{rest}} \\approx -80 + 81.3043478... = 1.3043478...\\,\\text{mV}$$\nThe problem requires the answer to be rounded to four significant figures.\n$$\\Delta V_{\\text{rest}} \\approx 1.304\\,\\text{mV}$$\nThe positive sign indicates a depolarization, moving the resting potential from approximately $-81.3\\,\\text{mV}$ to $-80\\,\\text{mV}$, which is consistent with our theoretical analysis, as the potential moves toward $E_{\\mathrm{Cl}} = -65\\,\\text{mV}$.", "answer": "$$\\boxed{1.304}$$"}, {"introduction": "In experimental neuroscience, we often face the \"inverse problem\": we can measure a neuron's electrical behavior, but the underlying conductances that produce this behavior are unknown. This advanced practice simulates this common research scenario, challenging you to work backwards from experimental data to determine the specific values of potassium, sodium, and chloride leak conductances. By formulating a system of linear equations based on measurements of resting potential and input resistance under different ionic conditions, you will apply a powerful quantitative method used to parameterize computational models of neurons [@problem_id:2720511].", "id": "2720511", "problem": "You are given a passive, single-compartment neuronal model with membrane capacitance $C_m = 100\\,\\mathrm{pF}$. The membrane contains three ohmic leak pathways for potassium, sodium, and chloride with conductances $g_K$, $g_{Na}$, and $g_{Cl}$, respectively, and corresponding reversal potentials $E_K$, $E_{Na}$, and $E_{Cl}$ (all voltages in $\\mathrm{mV}$, conductances in $\\mathrm{nS}$). Assume the following fundamental base and definitions:\n\n- Ohmic channel current for ion $i$: $I_i = g_i\\,(V - E_i)$.\n- Kirchhoff's current law at the isopotential compartment: the algebraic sum of transmembrane currents equals the externally injected current $I_{\\text{inj}}$.\n- Steady state (resting potential) condition with no external current: total transmembrane current equals $0$.\n- Input resistance $R_{\\text{in}}$ is defined as $R_{\\text{in}} = \\left.\\dfrac{dV}{dI_{\\text{inj}}}\\right|_{V=V_{\\text{rest}}}$ and, for passive ohmic leaks, the total slope conductance is $G_{\\text{tot}} = 1/R_{\\text{in}} = g_K + g_{Na} + g_{Cl}$.\n\nYour task is to compute the leak conductances $g_K$, $g_{Na}$, and $g_{Cl}$ that are consistent with measured resting potentials and measured input resistance under two extracellular ionic conditions that alter one or more reversal potentials but not the conductances. You may assume that $C_m$ remains constant and that conductances do not change between the two conditions.\n\nFormulate the problem purely in terms of algebraic equalities implied by the above fundamental base, using the provided measurements as constraints. Express all voltages in $\\mathrm{mV}$, resistances in $\\mathrm{M}\\Omega$, and conductances in $\\mathrm{nS}$. Use the exact conversion $G_{\\text{tot}}\\,(\\mathrm{nS}) = \\dfrac{1000}{R_{\\text{in}}\\,(\\mathrm{M}\\Omega)}$.\n\nInput for your program is implicit and fixed by the test suite below; do not read any external input. For each test case, you are given:\n- The measured resting potential before manipulation, $V_1$.\n- The reversal potentials before manipulation, $E_{K,1}$, $E_{Na}$, $E_{Cl,1}$.\n- The measured input resistance $R_{\\text{in}}$.\n- The measured resting potential after manipulation, $V_2$.\n- The reversal potentials after manipulation, $E_{K,2}$, $E_{Na}$, $E_{Cl,2}$.\n\nYou must solve for $g_K$, $g_{Na}$, $g_{Cl}$ (in $\\mathrm{nS}$) for each case. All solutions must satisfy physically that $g_K \\ge 0$, $g_{Na} \\ge 0$, $g_{Cl} \\ge 0$.\n\nTest Suite (each bullet is one test case; all voltages in $\\mathrm{mV}$, resistances in $\\mathrm{M}\\Omega$):\n- Case A (happy path; potassium reversal altered):\n  - $V_1 = -68.0$, $E_{K,1} = -90.0$, $E_{Na} = +60.0$, $E_{Cl,1} = -70.0$, $R_{\\text{in}} = 100.0$.\n  - After elevating extracellular potassium: $V_2 = -59.75$, $E_{K,2} = -75.0$, $E_{Na} = +60.0$, $E_{Cl,2} = -70.0$.\n- Case B (boundary feature; baseline $V_1$ equals chloride reversal; chloride reversal altered):\n  - $V_1 = -70.0$, $E_{K,1} = -90.0$, $E_{Na} = +60.0$, $E_{Cl,1} = -70.0$, $R_{\\text{in}} = 100.0$.\n  - After altering extracellular chloride: $V_2 = -67.5$, $E_{K,2} = -90.0$, $E_{Na} = +60.0$, $E_{Cl,2} = -60.0$.\n- Case C (high input resistance; potassium reversal altered):\n  - $V_1 = -69.0$, $E_{K,1} = -90.0$, $E_{Na} = +60.0$, $E_{Cl,1} = -70.0$, $R_{\\text{in}} = 333.3333333333333$.\n  - After elevating extracellular potassium: $V_2 = -63.0$, $E_{K,2} = -80.0$, $E_{Na} = +60.0$, $E_{Cl,2} = -70.0$.\n- Case D (different total conductance; potassium reversal strongly altered):\n  - $V_1 = -67.5$, $E_{K,1} = -90.0$, $E_{Na} = +60.0$, $E_{Cl,1} = -70.0$, $R_{\\text{in}} = 125.0$.\n  - After elevating extracellular potassium: $V_2 = -57.0$, $E_{K,2} = -70.0$, $E_{Na} = +60.0$, $E_{Cl,2} = -70.0$.\n\nYour program should produce a single line of output containing the results as a comma-separated list of lists, each inner list giving $[g_K,g_{Na},g_{Cl}]$ in $\\mathrm{nS}$, rounded to four decimal places, enclosed in square brackets. For example, the output format is $[[g_{K,1},g_{Na,1},g_{Cl,1}],[g_{K,2},g_{Na,2},g_{Cl,2}],\\dots]$ with no additional whitespace requirements beyond commas and brackets.", "solution": "The problem requires the determination of three unknown ionic leak conductances, $g_K$, $g_{Na}$, and $g_{Cl}$, for a passive neuronal membrane model. The solution is obtained by establishing a system of three independent linear equations based on the provided electrophysiological measurements and fundamental principles. The variables are the conductances $g_K$, $g_{Na}$, and $g_{Cl}$, all expressed in nanosiemens ($\\mathrm{nS}$).\n\nThe derivation of the system of equations proceeds in three steps, corresponding to the three independent pieces of information provided for each test case.\n\n1.  **Total Membrane Conductance:** The problem defines the input resistance $R_{\\text{in}}$ at rest and states that for a passive model with ohmic leaks, the total membrane conductance $G_{\\text{tot}}$ is the reciprocal of the input resistance, $G_{\\text{tot}} = 1/R_{\\text{in}}$. It is also given that the total conductance is the sum of the individual leak conductances. This provides the first linear equation:\n    $$g_K + g_{Na} + g_{Cl} = G_{\\text{tot}}$$\n    The units must be consistent. With $R_{\\text{in}}$ given in megaohms ($\\mathrm{M}\\Omega$) and the desired conductances in nanosiemens ($\\mathrm{nS}$), the conversion is:\n    $$G_{\\text{tot}} (\\mathrm{nS}) = \\frac{1}{R_{\\text{in}} (\\mathrm{M}\\Omega)} \\times \\frac{1}{10^6\\,\\Omega/\\mathrm{M}\\Omega} \\times \\frac{10^9\\,\\mathrm{nS}}{\\mathrm{S}} = \\frac{1000}{R_{\\text{in}} (\\mathrm{M}\\Omega)}$$\n    This formula is provided in the problem statement and establishes our first constraint on the conductances.\n\n2.  **Steady-State Condition (Condition 1):** At steady state, with no externally injected current ($I_{\\text{inj}}=0$), Kirchhoff's current law dictates that the sum of all transmembrane ionic currents must be zero.\n    $$I_K + I_{Na} + I_{Cl} = 0$$\n    The current for each ion $i$ is described by Ohm's law, $I_i = g_i(V - E_i)$, where $V$ is the membrane potential and $E_i$ is the reversal potential for that ion. Under the first experimental condition, the membrane potential is the measured resting potential, $V_1$. Substituting the ohmic current expressions into Kirchhoff's law yields the second linear equation:\n    $$g_K(V_1 - E_{K,1}) + g_{Na}(V_1 - E_{Na,1}) + g_{Cl}(V_1 - E_{Cl,1}) = 0$$\n    Here, $V_1$, $E_{K,1}$, $E_{Na,1}$, and $E_{Cl,1}$ are the given measured values for the first condition.\n\n3.  **Steady-State Condition (Condition 2):** A second experiment is performed where extracellular ionic concentrations are altered, leading to a new set of reversal potentials ($E_{K,2}$, $E_{Na,2}$, $E_{Cl,2}$) and a new resting potential ($V_2$). The problem states that the channel conductances $g_K$, $g_{Na}$, and $g_{Cl}$ are intrinsic properties of the membrane and do not change between conditions. Applying the same steady-state principle as above for the second condition provides the third linear equation:\n    $$g_K(V_2 - E_{K,2}) + g_{Na}(V_2 - E_{Na,2}) + g_{Cl}(V_2 - E_{Cl,2}) = 0$$\n\nThese three equations form a linear system $A\\mathbf{g} = \\mathbf{b}$ for the unknown conductance vector $\\mathbf{g} = [g_K, g_{Na}, g_{Cl}]^T$. Let us define the driving forces $\\Delta V_{i,j} = V_j - E_{i,j}$ for ion $i \\in \\{K, Na, Cl\\}$ and condition $j \\in \\{1, 2\\}$. The system is then:\n$$\n\\begin{pmatrix}\n1 & 1 & 1 \\\\\n\\Delta V_{K,1} & \\Delta V_{Na,1} & \\Delta V_{Cl,1} \\\\\n\\Delta V_{K,2} & \\Delta V_{Na,2} & \\Delta V_{Cl,2}\n\\end{pmatrix}\n\\begin{pmatrix}\ng_K \\\\\ng_{Na} \\\\\ng_{Cl}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\nG_{\\text{tot}} \\\\\n0 \\\\\n0\n\\end{pmatrix}\n$$\nThe coefficient matrix $A$ is constructed from the driving forces, and the vector $\\mathbf{b}$ contains the total conductance. As long as the matrix $A$ is invertible (i.e., its determinant is non-zero), a unique solution for the conductances exists. The experimental design, which involves changing at least one reversal potential, ensures that the second and third rows of the matrix are not linearly dependent, thus generally guaranteeing a unique solution. This system can be solved using standard linear algebra methods, such as `numpy.linalg.solve`, to find the values of $g_K, g_{Na}, g_{Cl}$. The final solution must also satisfy the physical constraint that all conductances are non-negative ($g_i \\ge 0$).", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for leak conductances g_K, g_Na, and g_Cl for a passive\n    single-compartment neuronal model based on electrophysiological measurements\n    under two different ionic conditions.\n    \"\"\"\n    \n    # Each test case is a tuple containing:\n    # (V1, EK1, ENa1, ECl1, Rin, V2, EK2, ENa2, ECl2)\n    # Voltages are in mV, resistance in MOhms.\n    test_cases = [\n        # Case A\n        (-68.0, -90.0, 60.0, -70.0, 100.0, -59.75, -75.0, 60.0, -70.0),\n        # Case B\n        (-70.0, -90.0, 60.0, -70.0, 100.0, -67.5, -90.0, 60.0, -60.0),\n        # Case C\n        (-69.0, -90.0, 60.0, -70.0, 333.3333333333333, -63.0, -80.0, 60.0, -70.0),\n        # Case D\n        (-67.5, -90.0, 60.0, -70.0, 125.0, -57.0, -70.0, 60.0, -70.0)\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        v1, ek1, ena1, ecl1, rin, v2, ek2, ena2, ecl2 = case\n\n        # Calculate total conductance in nS from input resistance in MOhms.\n        g_tot = 1000.0 / rin\n\n        # Set up the system of linear equations Ag = b, where g = [g_K, g_Na, g_Cl]^T.\n\n        # Matrix A is constructed from coefficients of g_K, g_Na, g_Cl\n        # in the three equations:\n        # 1. g_K + g_Na + g_Cl = G_tot\n        # 2. g_K(V1-EK1) + g_Na(V1-ENa1) + g_Cl(V1-ECl1) = 0\n        # 3. g_K(V2-EK2) + g_Na(V2-ENa2) + g_Cl(V2-ECl2) = 0\n        \n        A = np.array([\n            [1.0, 1.0, 1.0],\n            [v1 - ek1, v1 - ena1, v1 - ecl1],\n            [v2 - ek2, v2 - ena2, v2 - ecl2]\n        ], dtype=np.float64)\n\n        # Vector b contains the constants from the right-hand side of the equations.\n        b = np.array([g_tot, 0.0, 0.0], dtype=np.float64)\n\n        # Solve the linear system for g.\n        conductances = np.linalg.solve(A, b)\n        results.append(conductances)\n\n    # Format the output string as a list of lists, with each value\n    # rounded to four decimal places, and no extra whitespace.\n    # Example: [[gK1,gNa1,gCl1],[gK2,gNa2,gCl2]]\n    results_str_list = []\n    for res in results:\n        # Round each conductance value to 4 decimal places\n        rounded_res = [f\"{val:.4f}\" for val in res]\n        # Format the list of strings as \"[val1,val2,val3]\"\n        results_str_list.append(f\"[{','.join(rounded_res)}]\")\n    \n    # Join the formatted strings for each case and enclose in brackets\n    final_output = f\"[{','.join(results_str_list)}]\"\n    \n    print(final_output)\n\nsolve()\n```"}]}