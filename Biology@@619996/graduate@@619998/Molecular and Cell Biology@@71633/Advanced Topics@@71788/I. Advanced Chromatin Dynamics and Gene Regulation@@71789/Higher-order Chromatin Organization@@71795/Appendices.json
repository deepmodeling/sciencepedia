{"hands_on_practices": [{"introduction": "To truly master the principles of higher-order chromatin organization, one must be able to predict the consequences of perturbing the system. This exercise challenges you to apply your conceptual understanding of the loop extrusion model, the dominant paradigm for explaining the formation of Topologically Associating Domains (TADs) and chromatin loops. By reasoning through the distinct roles of the cohesin complex (the motor), CTCF (the boundary), and WAPL (the release factor), you will develop an intuition for interpreting complex Hi-C data and understanding how these key molecular players sculpt the 3D genome [@problem_id:2947793].", "problem": "You are analyzing in situ chromosome conformation capture (Hi-C) maps from an auxin-inducible degron time course in a human cell line with three perturbations: acute degradation of CCCTC-binding factor (CTCF), acute degradation of a core cohesin subunit, and genetic loss of Wings apart-like protein homolog (WAPL). Using only the loop extrusion model and established definitions of Hi-C features, identify the pattern of changes you expect in loops, stripes, and A or B compartmentalization for each perturbation. Base your reasoning on the following: cohesin drives processive loop extrusion along chromatin until it is halted by oriented boundary elements such as CTCF; WAPL promotes cohesin release from chromatin and thereby limits cohesin residence time and processivity; Hi-C loops appear as focal enrichment peaks at loop anchors; stripes appear as one-sided contact enrichments extending from a strong anchor along the diagonal; topologically associating domains (TADs) appear as squares along the diagonal reflecting local insulation; A or B compartments reflect segregation of active and inactive chromatin and are seen as long-range plaid patterns; and at short genomic separations, extrusion-driven contacts compete with compartmental segregation. No numerical measurements are provided. Select the option that best matches the expected qualitative Hi-C signatures for each perturbation.\n\nA. Acute CTCF degradation: loss of focal loops at former convergent anchors, weakened insulation and stripes, with an apparent strengthening of A or B compartmentalization; acute cohesin degradation: near-complete loss of loops, stripes, and local TAD structures, with strengthening of A or B compartmentalization; WAPL loss: stronger corner peaks and prominent, extended stripes from anchor sites, expansion of domain extents, with weakening of A or B compartmentalization at short genomic distances.\n\nB. Acute CTCF degradation: stronger loops and longer stripes due to unimpeded extrusion, with weakening of A or B compartmentalization; acute cohesin degradation: loss of loops but emergence of stripes as extrusion proceeds from remaining anchors, with unchanged compartmentalization; WAPL loss: reduced loop intensities and fewer stripes because cohesin pauses less, with stronger A or B compartmentalization.\n\nC. Acute CTCF degradation: loss of loops but stronger stripes because extrusion no longer stalls, with unchanged compartmentalization; acute cohesin degradation: fewer loops but stronger TAD boundaries as insulation increases, with weakening of A or B compartmentalization; WAPL loss: stronger compartmentalization because extrusion is enhanced, with reduced stripes.\n\nD. Acute CTCF degradation: minimal change to loops and stripes because cohesin remains, but stronger A or B compartmentalization; acute cohesin degradation: stronger loops and longer stripes because CTCF anchors dominate, with weakening of A or B compartmentalization; WAPL loss: loss of TADs and loops due to excessive cohesin residence, with stronger compartmentalization.\n\nChoose the single best option.", "solution": "The problem statement will first be subjected to a rigorous validation to ensure it is scientifically sound, well-posed, and objective.\n\n**Step 1: Extract Givens**\n\nThe problem provides the following model, definitions, and experimental conditions:\n- **System**: An auxin-inducible degron time course in a human cell line.\n- **Model**: The loop extrusion model is the sole basis for reasoning.\n- **Perturbations**:\n    1. Acute degradation of CCCTC-binding factor (CTCF).\n    2. Acute degradation of a core cohesin subunit.\n    3. Genetic loss of Wings apart-like protein homolog (WAPL).\n- **Core Principles and Definitions**:\n    - Principle $1$: Cohesin drives processive loop extrusion along chromatin.\n    - Principle $2$: Loop extrusion is halted by oriented boundary elements, such as CTCF.\n    - Principle $3$: WAPL promotes cohesin release from chromatin, limiting cohesin residence time and processivity.\n    - Definition $1$: Hi-C loops appear as focal enrichment peaks at loop anchors.\n    - Definition $2$: Stripes appear as one-sided contact enrichments extending from a strong anchor along the diagonal.\n    - Definition $3$: Topologically associating domains (TADs) appear as squares along the diagonal, reflecting local insulation.\n    - Definition $4$: A or B compartments reflect segregation of active and inactive chromatin and are seen as long-range plaid patterns.\n    - Principle $4$: At short genomic separations, extrusion-driven contacts compete with compartmental segregation.\n\n**Step 2: Validate Using Extracted Givens**\n\nThe problem is evaluated against the required criteria.\n- **Scientifically Grounded**: The problem is based on the loop extrusion model, which is the prevailing, experimentally-supported framework for explaining higher-order chromatin organization. The roles of cohesin (motor), CTCF (boundary), and WAPL (release factor) are canonical and well-established in the field of molecular and cell biology. The described experiments are standard techniques used to probe chromatin architecture. The problem is therefore scientifically sound.\n- **Well-Posed**: The problem asks for qualitative predictions based on a clearly defined set of rules and molecular players. The provided principles and definitions are sufficient to deduce a unique set of expected outcomes for each perturbation.\n- **Objective**: The problem uses precise, technical language (e.g., \"focal enrichment peaks\", \"processive loop extrusion\") and avoids any subjective or ambiguous terminology.\n- **Consistency and Completeness**: The provided information is self-consistent and sufficient. For example, the statement that extrusion competes with compartmentalization is a critical piece of information that resolves potential ambiguity in the outcomes. There are no missing data or contradictory constraints.\n\n**Step 3: Verdict and Action**\n\nThe problem statement is valid. It is a well-posed, scientifically-grounded question that requires the rigorous application of a defined biophysical model. The analysis may proceed.\n\n**Derivation of Solution**\n\nThe solution will be derived by applying the given principles (Principles $1-4$) and definitions (Definitions $1-4$) to each of the three perturbations.\n\n**Perturbation 1: Acute degradation of CTCF**\n- **Premise**: CTCF provides the boundary elements that halt cohesin-driven loop extrusion (Principle $2$). Loops (Definition $1$) and TAD boundaries (Definition $3$) are formed at these elements.\n- **Reasoning**: Upon acute degradation of CTCF, the primary boundary elements are removed. Cohesin-driven extrusion (Principle $1$) is no longer efficiently stalled at specific locations. Consequently, the stable structures that depend on this stalling—namely, loops defined by pairs of convergent CTCF sites and the insulating boundaries of TADs—will be lost. The focal contact enrichments (corner peaks) that define loops will disappear. The sharp boundaries of TAD squares will dissolve, leading to weakened insulation. Stripes (Definition $2$), which are formed by extrusion from a strong anchor (often CTCF), will also be lost or severely weakened as these anchors are removed. According to Principle $4$, extrusion-driven contacts compete with compartmental segregation. The loss of structured local contacts (loops, TADs) reduces this competition, allowing the underlying, long-range A/B compartmentalization (Definition $4$) to become more prominent in the Hi-C map.\n- **Conclusion**: CTCF degradation leads to the loss of loops, stripes, and TADs, with an apparent strengthening of A/B compartments.\n\n**Perturbation 2: Acute degradation of a core cohesin subunit**\n- **Premise**: Cohesin is the motor that drives processive loop extrusion (Principle $1$).\n- **Reasoning**: Degradation of a core cohesin subunit incapacitates the loop extrusion machinery itself. Without the motor, the process of forming loops, stripes, and TADs cannot occur. Therefore, all Hi-C features that are direct products of loop extrusion will be nearly completely erased from the map. This includes focal loop peaks, stripes, and the insulated square-like TAD structures. As in the case of CTCF degradation, the removal of the competing extrusion process (Principle $4$) will cause the plaid-like pattern of A/B compartments, which is established by independent mechanisms, to become the dominant and most visible feature of the Hi-C map.\n- **Conclusion**: Cohesin degradation leads to a near-complete loss of loops, stripes, and TADs, with a strengthening of A/B compartments.\n\n**Perturbation 3: Genetic loss of WAPL**\n- **Premise**: WAPL promotes cohesin release, thereby limiting its residence time and processivity (Principle $3$).\n- **Reasoning**: Genetic loss of WAPL prevents the efficient unloading of cohesin from chromatin. This results in cohesin complexes that reside on the DNA for a much longer time and extrude loops with much greater processivity. This hyper-processive extrusion has several consequences. First, when extrusion is halted by CTCF boundaries, the amount of chromatin reeled into the loop is much larger, and the cohesin complex is more stable at the anchor points. This strengthens the contact frequency at the loop anchors, resulting in stronger corner peaks (Definition $1$). Second, extrusion from a single strong boundary will proceed for much longer distances, creating highly prominent and extended stripes (Definition $2$). The average size of TADs may expand (expansion of domain extents). Third, this dramatic increase in strong, local, extrusion-mediated contacts intensifies the competition with compartmental segregation (Principle $4$). These enhanced local contacts can overwhelm or mask the weaker, long-range contacts that define A/B compartments, particularly at short to intermediate genomic distances.\n- **Conclusion**: WAPL loss leads to stronger loops (corner peaks) and longer, more prominent stripes, with a corresponding weakening of A/B compartmentalization at shorter genomic ranges.\n\n**Option-by-Option Analysis**\n\n- **Option A**:\n    - **CTCF degradation**: Predicts \"loss of focal loops [...], weakened insulation and stripes, with an apparent strengthening of A or B compartmentalization\". This is **Correct**.\n    - **Cohesin degradation**: Predicts \"near-complete loss of loops, stripes, and local TAD structures, with strengthening of A or B compartmentalization\". This is **Correct**.\n    - **WAPL loss**: Predicts \"stronger corner peaks and prominent, extended stripes [...], expansion of domain extents, with weakening of A or B compartmentalization at short genomic distances\". This is **Correct**.\n    - **Verdict**: This option aligns perfectly with all three derived conclusions.\n\n- **Option B**:\n    - **CTCF degradation**: Predicts \"stronger loops and longer stripes\". This directly contradicts the established role of CTCF as the boundary element required to form these features. The loss of boundaries prevents stable loop and stripe formation. This statement is fundamentally flawed.\n    - **Verdict**: **Incorrect**.\n\n- **Option C**:\n    - **CTCF degradation**: Predicts \"stronger stripes because extrusion no longer stalls\". This is a logical contradiction. Stripes are features of stalled extrusion at an anchor. If extrusion does not stall, stripes cannot form, let alone become stronger.\n    - **Verdict**: **Incorrect**.\n\n- **Option D**:\n    - **CTCF degradation**: Predicts \"minimal change to loops and stripes\". This is incorrect. The removal of the essential boundary elements (CTCF) must cause a dramatic change, not a minimal one.\n    - **Cohesin degradation**: Predicts \"stronger loops and longer stripes\". This is absurd. Removing the motor for loop extrusion cannot possibly create stronger loops; it must eliminate them.\n    - **Verdict**: **Incorrect**.\n\nBased on a rigorous, principle-based analysis, Option A is the only one that provides a scientifically correct description of the expected Hi-C signatures for all three perturbations.", "answer": "$$\\boxed{A}$$", "id": "2947793"}, {"introduction": "Moving from qualitative principles to quantitative prediction is a crucial step in scientific inquiry. A fundamental consequence of chromatin's polymer nature is that the probability of contact between two genomic loci, like an enhancer and a promoter, decays with the linear distance separating them. This practice [@problem_id:2947750] asks you to formalize this relationship using a scaling law derived from polymer physics, specifically the fractal globule model, which accurately describes chromatin architecture in many contexts. By calculating the expected fold-change in gene expression when an enhancer is repositioned, you will gain a tangible sense of how profoundly genomic distance can impact regulatory function.", "problem": "A gene is activated by an enhancer that contacts its promoter through three-dimensional chromatin folding. In High-throughput Chromosome Conformation Capture (Hi-C), the empirically observed contact probability between two loci separated by genomic distance $s$ in the fractal globule regime scales as $P(s)=C\\,s^{-\\alpha}$, where $C$ is an $s$-independent constant and $\\alpha$ is a scaling exponent characteristic of the polymer state. Assume that, in the length-scale regime of interest, the polymer is in the fractal globule regime with $\\alpha=1$. The transcriptional activation level is proportional to a cooperative contact-dependent term such that $E(s)\\propto \\left[P(s)\\right]^{n}$, where $n$ is a Hill coefficient capturing multivalent or cooperative activation requirements.\n\nAn enhancer is repositioned from genomic separation $s_{1}=50\\,\\text{kb}$ to $s_{2}=500\\,\\text{kb}$. Using only the stated scaling law and proportionality, derive the fold-change in expression, defined as the dimensionless ratio $F=\\dfrac{E(s_{2})}{E(s_{1})}$, as a closed-form analytic expression in terms of $n$. Report the final answer as a single simplified expression with no units.", "solution": "The problem will first be subjected to a rigorous validation to ascertain its scientific and logical integrity.\n\nThe givens provided in the problem statement are as follows:\n$1$. The contact probability between two loci separated by genomic distance $s$ is given by the scaling law $P(s)=C\\,s^{-\\alpha}$.\n$2$. The system is in the fractal globule regime, for which the scaling exponent is specified as $\\alpha=1$.\n$3$. The transcriptional activation level, $E(s)$, is proportional to a cooperative term involving the contact probability: $E(s)\\propto \\left[P(s)\\right]^{n}$, where $n$ is a Hill coefficient.\n$4$. An enhancer is moved from an initial genomic separation $s_{1}=50\\,\\text{kb}$ to a final separation $s_{2}=500\\,\\text{kb}$.\n$5$. The objective is to derive the fold-change in expression, defined as the ratio $F=\\dfrac{E(s_{2})}{E(s_{1})}$.\n\nNow, we evaluate the validity of the problem. The model presented is a standard and simplified representation used in molecular biology and polymer physics to describe chromatin organization. The scaling law $P(s) \\propto s^{-1}$ is the characteristic signature of a fractal globule, a polymer conformation that lacks knots and allows for dense packing while maintaining accessibility, which is consistent with experimental observations of chromatin organization within specific length scales. The use of a Hill-like equation to model cooperative biological activation is a common and accepted approach in systems biology. The parameters and values given ($s_{1}=50\\,\\text{kb}$, $s_{2}=500\\,\\text{kb}$) are physically realistic for enhancer-promoter distances. The problem is self-contained, scientifically grounded, and well-posed, with no internal contradictions or ambiguities. Therefore, the problem is deemed valid and a solution will be derived.\n\nThe transcriptional activation level $E(s)$ is proportional to $[P(s)]^n$. This can be expressed as an equation by introducing a proportionality constant, which we will call $k_{E}$:\n$$E(s) = k_{E} [P(s)]^n$$\nThe contact probability $P(s)$ is given by the scaling law:\n$$P(s) = C s^{-\\alpha}$$\nThe problem states that for the fractal globule regime of interest, the scaling exponent is $\\alpha = 1$. Substituting this value, the contact probability becomes:\n$$P(s) = C s^{-1}$$\nNow, we substitute this expression for $P(s)$ into the equation for the activation level $E(s)$:\n$$E(s) = k_{E} [C s^{-1}]^n = k_{E} C^n s^{-n}$$\nThe expression for $E(s)$ shows that the activation level scales with genomic distance as $s^{-n}$.\n\nWe are required to find the fold-change $F$, defined as the ratio of the expression level at the new position $s_{2}$ to the expression level at the original position $s_{1}$:\n$$F = \\frac{E(s_{2})}{E(s_{1})}$$\nUsing the derived expression for $E(s)$, we can write the terms for $E(s_{1})$ and $E(s_{2})$:\n$$E(s_{1}) = k_{E} C^n s_{1}^{-n}$$\n$$E(s_{2}) = k_{E} C^n s_{2}^{-n}$$\nNow, we form the ratio $F$:\n$$F = \\frac{k_{E} C^n s_{2}^{-n}}{k_{E} C^n s_{1}^{-n}}$$\nThe constants $k_{E}$ and $C^n$ are independent of $s$ and thus cancel out from the numerator and denominator:\n$$F = \\frac{s_{2}^{-n}}{s_{1}^{-n}}$$\nThis can be rewritten using the properties of exponents:\n$$F = \\left(\\frac{s_{2}}{s_{1}}\\right)^{-n} = \\left(\\frac{s_{1}}{s_{2}}\\right)^{n}$$\nThe problem provides the specific values for the genomic separations: $s_{1} = 50\\,\\text{kb}$ and $s_{2} = 500\\,\\text{kb}$. We substitute these values into the expression for $F$. The units of kilobases ($\\text{kb}$) are identical in the numerator and denominator and will cancel:\n$$\\frac{s_{1}}{s_{2}} = \\frac{50\\,\\text{kb}}{500\\,\\text{kb}} = \\frac{50}{500} = \\frac{1}{10}$$\nSubstituting this ratio back into the equation for $F$:\n$$F = \\left(\\frac{1}{10}\\right)^{n}$$\nThis is the closed-form analytic expression for the fold-change in terms of the Hill coefficient $n$. A more compact representation is:\n$$F = 10^{-n}$$\nThis result demonstrates that for a system following these scaling laws, moving an enhancer $10$-fold further away from its target promoter results in a decrease in gene expression by a factor of $10^n$.", "answer": "$$\\boxed{10^{-n}}$$", "id": "2947750"}, {"introduction": "This final practice serves as a capstone, integrating the conceptual and quantitative skills developed previously into a powerful computational model. Real regulatory landscapes are complex, involving multiple enhancers and boundary elements that collectively determine gene activity. Here, you are tasked with building a predictive engine from first principles to simulate the outcome of a genetic experiment—the deletion of a boundary element [@problem_id:2947808]. By implementing a model that accounts for distance-dependent contact probabilities and the insulating effects of boundaries, you will bridge the gap between theoretical models and practical, predictive computational biology.", "problem": "Implement a simplified, first-principles loop-extrusion-based predictor for enhancer–promoter communication following deletion of boundary elements. The objective is to compute predicted fold-changes in promoter activity caused by ectopic enhancer–promoter contacts made possible by boundary deletion, using a contact reweighting framework grounded in polymer physics and barrier permeability. The program must compute, for each specified test case, a dimensionless fold-change in promoter activity defined as the ratio of post-deletion activity to pre-deletion activity, and report all results on a single line.\n\nModel specification:\n1. Baseline genomic contact weight: For two loci at positions $x_i$ and $x_j$ (in base pairs), define genomic separation $d = |x_i - x_j|$. The baseline contact weight is\n$$\nW(d) = \\frac{1}{1 + \\left(\\frac{d}{\\lambda}\\right)^{\\alpha}},\n$$\nwhere $\\lambda$ is a length scale (in base pairs) and $\\alpha$ is a polymer-scaling exponent.\n\n2. Boundary attenuation as independent crossing events: Let there be a set of boundary elements indexed by $k$ with genomic positions $b_k$ (in base pairs) and permeabilities $s_k \\in [0,1]$. For a pair of loci at $x_i$ and $x_j$, define the attenuation factor\n$$\nA(x_i, x_j; \\{(b_k, s_k)\\}) = \\prod_{k: \\min(x_i,x_j) < b_k < \\max(x_i,x_j)} s_k,\n$$\ni.e., the product of permeabilities of all boundaries strictly between the two loci. A boundary deletion is modeled by setting $s_k = 1$ for all indices $k$ in a specified deletion set $D$ in the post-deletion state, while leaving $s_k$ unchanged in the pre-deletion state.\n\n3. Promoter activity from enhancer contact reweighting: Let a promoter be located at position $p$ (in base pairs) and enhancers be a list of pairs $(e_m, w_m)$ where $e_m$ is the enhancer position (in base pairs) and $w_m$ is a nonnegative enhancer weight (dimensionless). The predicted promoter activity is\n$$\nS = \\sum_{m} w_m \\, W(|e_m - p|) \\, A(e_m, p; \\{(b_k, s_k)\\}).\n$$\n\n4. Fold-change in promoter activity: Let $S_{\\mathrm{before}}$ be the promoter activity computed using the pre-deletion permeabilities, and $S_{\\mathrm{after}}$ be the promoter activity computed after setting $s_k = 1$ for all $k \\in D$. The required output per test case is the dimensionless fold-change\n$$\nF = \\frac{S_{\\mathrm{after}}}{S_{\\mathrm{before}}}.\n$$\n\nConstants:\n- Use a polymer-scaling exponent $\\alpha = 1.5$.\n- Use a length scale $\\lambda = 20000$ base pairs.\n\nUnits and numerical requirements:\n- All genomic positions and $\\lambda$ are in base pairs.\n- Enhancer weights $w_m$ are dimensionless.\n- The fold-change $F$ is dimensionless and must be reported as a floating-point decimal number.\n- There are no angles in this problem.\n- Do not express any result with a percentage sign.\n\nInput specification for each test case within the program (no external input is provided; the program must embed the test suite):\n- A region length $L$ (in base pairs), not directly used by the model but provided for completeness.\n- A promoter position $p$ (in base pairs).\n- A list of enhancers $[(e_m, w_m)]$ where $e_m$ is in base pairs and $w_m$ is dimensionless.\n- A list of boundaries $[(b_k, s_k)]$ where $b_k$ is in base pairs and $s_k \\in [0,1]$ is dimensionless permeability.\n- A deletion set $D$ containing indices (zero-based) into the boundaries list that are deleted in the post-deletion state.\n\nTest suite to implement:\n- Common parameters: $\\alpha = 1.5$, $\\lambda = 20000$ base pairs.\n\n- Test case $1$ (happy path with ectopic contact unmasking):\n  - $L = 200000$ base pairs\n  - $p = 120000$ base pairs\n  - enhancers: $[(80000, 1.0), (150000, 0.6)]$\n  - boundaries: $[(100000, 0.1), (130000, 0.05)]$\n  - deleted: $[1]$\n\n- Test case $2$ (strong boundary removal exposing a distal enhancer):\n  - $L = 200000$ base pairs\n  - $p = 50000$ base pairs\n  - enhancers: $[(10000, 0.5), (90000, 1.2)]$\n  - boundaries: $[(70000, 0.02), (40000, 0.2)]$\n  - deleted: $[0]$\n\n- Test case $3$ (no boundaries; deletion has no effect):\n  - $L = 100000$ base pairs\n  - $p = 50000$ base pairs\n  - enhancers: $[(20000, 1.0), (80000, 1.0)]$\n  - boundaries: $[]$\n  - deleted: $[]$\n\n- Test case $4$ (complete insulation lifted by deletion; ensure nonzero baseline activity from a proximal enhancer):\n  - $L = 150000$ base pairs\n  - $p = 60000$ base pairs\n  - enhancers: $[(58000, 0.3), (110000, 1.0)]$\n  - boundaries: $[(80000, 0.0)]$\n  - deleted: $[0]$\n\nProgram output format:\n- Compute the fold-change $F$ for each test case using the definitions above.\n- Produce a single line of output containing the results as a comma-separated list of floating-point numbers rounded to six decimal places and enclosed in square brackets, e.g., $[f_1,f_2,f_3,f_4]$ where each $f_i$ corresponds to the fold-change for test case $i$.", "solution": "The problem requires the implementation of a computational model to predict the change in promoter activity following the deletion of genomic boundary elements. The model is based on first principles of polymer physics, specifically a loop-extrusion framework where enhancers influence a promoter's activity as a function of their spatial proximity, which is in turn modulated by distance and intervening boundary elements. The objective is to calculate the fold-change in a promoter's activity, defined as the ratio of its activity after boundary deletion to its activity before deletion.\n\nThe solution is constructed by systematically applying the provided mathematical definitions. Let us first formalize the components of the model.\n\n$1$. Baseline Contact Weight: The inherent probability of contact between two genomic loci at positions $x_i$ and $x_j$, separated by a genomic distance $d = |x_i - x_j|$, is given by the function $W(d)$. This function represents the decay of contact frequency with distance in a polymer model of chromatin. It is defined as:\n$$\nW(d) = \\frac{1}{1 + \\left(\\frac{d}{\\lambda}\\right)^{\\alpha}}\n$$\nHere, $\\lambda$ is a characteristic length scale, set to $20000$ base pairs, and $\\alpha$ is a polymer-scaling exponent, set to $1.5$. These constants dictate the shape of the contact decay profile.\n\n$2$. Boundary Attenuation Factor: Boundary elements, such as those bound by the CTCF protein, are modeled as probabilistic barriers that impede the process of loop extrusion. The collective effect of boundaries located between a locus pair $(x_i, x_j)$ is quantified by the attenuation factor $A$. It is the product of the permeabilities, $s_k \\in [0, 1]$, of all boundaries $k$ with position $b_k$ that lie strictly between $x_i$ and $x_j$. A permeability of $s_k=0$ represents a complete barrier, while $s_k=1$ represents a fully permeable element (no barrier effect).\n$$\nA(x_i, x_j; \\{(b_k, s_k)\\}) = \\prod_{k: \\min(x_i, x_j) < b_k < \\max(x_i, x_j)} s_k\n$$\nAn empty product, which occurs if no boundaries are present between $x_i$ and $x_j$, is defined to be $1$. The deletion of a boundary is modeled by setting its permeability $s_k$ to $1$.\n\n$3$. Total Promoter Activity: The activity of a promoter at position $p$ is determined by the cumulative influence of a set of enhancers. Each enhancer $m$, located at position $e_m$ with an intrinsic strength $w_m$, contributes to the promoter's activity. This contribution is the product of the enhancer's strength $w_m$, the baseline contact weight $W(|e_m - p|)$, and the attenuation factor $A(e_m, p)$ for the specific enhancer-promoter pair. The total promoter activity, $S$, is the sum of these contributions over all enhancers:\n$$\nS = \\sum_{m} w_m \\, W(|e_m - p|) \\, A(e_m, p; \\{(b_k, s_k)\\})\n$$\n\n$4$. Fold-Change Calculation: The primary quantity to be computed is the fold-change $F$. This dimensionless ratio quantifies the impact of deleting a specific set of boundaries, $D$. Let $S_{\\mathrm{before}}$ be the promoter activity calculated using the original set of boundary permeabilities. Let $S_{\\mathrm{after}}$ be the activity calculated after modifying the permeabilities such that for every boundary index $k \\in D$, the permeability $s_k$ is set to $1$. The fold-change $F$ is then:\n$$\nF = \\frac{S_{\\mathrm{after}}}{S_{\\mathrm{before}}}\n$$\nA value of $F > 1$ indicates that the deletion resulted in an increase in promoter activity, typically due to the formation of new, or \"ectopic,\" enhancer-promoter contacts that were previously blocked. A value of $F = 1$ indicates no change.\n\nThe computational procedure for each test case is as follows:\nFirst, we define a function to compute the total promoter activity $S$ for a given promoter, a list of enhancers, and a list of boundaries, using the constants $\\alpha=1.5$ and $\\lambda=20000$. This function iterates through each enhancer, calculates the distance-dependent weight $W(d)$ and the boundary attenuation $A$, computes the contribution for that enhancer, and sums these contributions.\n\nSecond, for each test case, we compute $S_{\\mathrm{before}}$ by calling this activity-calculating function with the initially provided list of boundaries.\n\nThird, we construct a new list of boundaries for the post-deletion state. This is a copy of the original list, where the permeability $s_k$ of each boundary with an index $k$ in the specified deletion set $D$ is replaced with $1.0$.\n\nFourth, we compute $S_{\\mathrm{after}}$ by calling the activity-calculating function with this new, modified list of boundaries.\n\nFinally, we calculate the ratio $F = S_{\\mathrm{after}} / S_{\\mathrm{before}}$ to obtain the required fold-change. This procedure is repeated for all specified test cases. For the case where no boundaries exist, $S_{\\mathrm{after}}$ will equal $S_{\\mathrm{before}}$, correctly yielding a fold-change of $1.0$. The case where $S_{\\mathrm{before}}$ is zero is handled by the problem's design, which ensures a non-zero baseline activity from at least one proximal enhancer not separated from the promoter by a completely insulating boundary.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem of predicting enhancer-promoter communication changes\n    upon boundary deletion using a simplified loop-extrusion model.\n    \"\"\"\n\n    # Model constants\n    ALPHA = 1.5\n    LAMBDA = 20000.0\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Test case 1 (happy path with ectopic contact unmasking)\n        {\n            \"L\": 200000,\n            \"p\": 120000,\n            \"enhancers\": [(80000, 1.0), (150000, 0.6)],\n            \"boundaries\": [(100000, 0.1), (130000, 0.05)],\n            \"deleted\": [1],\n        },\n        # Test case 2 (strong boundary removal exposing a distal enhancer)\n        {\n            \"L\": 200000,\n            \"p\": 50000,\n            \"enhancers\": [(10000, 0.5), (90000, 1.2)],\n            \"boundaries\": [(70000, 0.02), (40000, 0.2)],\n            \"deleted\": [0],\n        },\n        # Test case 3 (no boundaries; deletion has no effect)\n        {\n            \"L\": 100000,\n            \"p\": 50000,\n            \"enhancers\": [(20000, 1.0), (80000, 1.0)],\n            \"boundaries\": [],\n            \"deleted\": [],\n        },\n        # Test case 4 (complete insulation lifted by deletion)\n        {\n            \"L\": 150000,\n            \"p\": 60000,\n            \"enhancers\": [(58000, 0.3), (110000, 1.0)],\n            \"boundaries\": [(80000, 0.0)],\n            \"deleted\": [0],\n        },\n    ]\n\n    def baseline_contact_weight(d, lam, alpha):\n        \"\"\"Calculates W(d), the baseline contact weight.\"\"\"\n        return 1.0 / (1.0 + (d / lam) ** alpha)\n\n    def compute_activity(p_pos, enhancers, boundaries, lam, alpha):\n        \"\"\"\n        Computes the total promoter activity S based on enhancer contacts,\n        modulated by distance and boundary elements.\n        \"\"\"\n        total_activity = 0.0\n        for e_pos, e_weight in enhancers:\n            # 1. Calculate genomic distance and baseline contact weight\n            d = abs(e_pos - p_pos)\n            w_d = baseline_contact_weight(d, lam, alpha)\n\n            # 2. Calculate boundary attenuation factor\n            attenuation = 1.0\n            locus_min = min(p_pos, e_pos)\n            locus_max = max(p_pos, e_pos)\n            for b_pos, b_perm in boundaries:\n                if locus_min < b_pos < locus_max:\n                    attenuation *= b_perm\n            \n            # 3. Sum up the contribution for this enhancer\n            total_activity += e_weight * w_d * attenuation\n            \n        return total_activity\n\n    results = []\n    for case in test_cases:\n        p_pos = case[\"p\"]\n        enhancers = case[\"enhancers\"]\n        boundaries_before = case[\"boundaries\"]\n        deleted_indices = case[\"deleted\"]\n\n        # Calculate pre-deletion promoter activity\n        s_before = compute_activity(p_pos, enhancers, boundaries_before, LAMBDA, ALPHA)\n\n        # Create the post-deletion boundary list by setting permeabilities to 1.0\n        boundaries_after = [list(b) for b in boundaries_before]\n        for idx in deleted_indices:\n            if 0 <= idx < len(boundaries_after):\n                boundaries_after[idx][1] = 1.0\n\n        # Calculate post-deletion promoter activity\n        s_after = compute_activity(p_pos, enhancers, boundaries_after, LAMBDA, ALPHA)\n\n        # Calculate fold-change, handling potential division by zero\n        if s_before == 0.0:\n            # If S_before is 0 and S_after is also 0, change is 1-fold.\n            # If S_before is 0 and S_after > 0, change is infinite.\n            # The problem context implies S_before will be non-zero.\n            fold_change = float('inf') if s_after > 0 else 1.0\n        else:\n            fold_change = s_after / s_before\n        \n        results.append(fold_change)\n\n    # Final print statement in the exact required format.\n    formatted_results = [f\"{r:.6f}\" for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2947808"}]}