{"hands_on_practices": [{"introduction": "The stability of a protein's three-dimensional structure is determined by a delicate thermodynamic balance. This practice explores the fundamental relationship between enthalpy ($\\Delta H$), entropy ($\\Delta S$), and Gibbs free energy ($\\Delta G$) in the context of protein folding. By calculating the free energy change and predicting the effects of temperature, you will gain hands-on experience with the core principles that govern why proteins fold spontaneously and why they denature upon heating [@problem_id:2935910].", "problem": "A single-domain protein folds reversibly in aqueous buffer at approximately constant pressure. At the reference temperature $T_{0} = 298\\ \\text{K}$, calorimetric measurements give an enthalpy change for folding $\\Delta H = -200\\ \\text{kJ mol}^{-1}$ and an entropy change for folding $\\Delta S = -0.6\\ \\text{kJ mol}^{-1}\\text{K}^{-1}$. Over the temperature range near $T_{0}$, assume that heat capacity changes are negligible so that $\\Delta H$ and $\\Delta S$ are effectively temperature-independent. Starting from fundamental thermodynamic definitions applicable to processes at constant temperature and pressure, derive the appropriate expression for the temperature dependence of the free energy change for folding and use it to evaluate whether folding is favored at $T_{0}$. Then assess how the balance between enthalpic and entropic contributions shifts as temperature increases and identify the temperature at which the driving force for folding changes sign, if any.\n\nFor grading, report only the numerical value of the Gibbs free energy change for folding at $T_{0} = 298\\ \\text{K}$, expressed in $\\text{kJ mol}^{-1}$ and rounded to three significant figures.", "solution": "The problem statement will first be subjected to a rigorous validation process.\n\nThe given information is extracted verbatim:\n1.  The process is the reversible folding of a single-domain protein in aqueous buffer at approximately constant pressure.\n2.  The reference temperature is $T_{0} = 298\\ \\text{K}$.\n3.  The enthalpy change for folding is $\\Delta H = -200\\ \\text{kJ mol}^{-1}$.\n4.  The entropy change for folding is $\\Delta S = -0.6\\ \\text{kJ mol}^{-1}\\text{K}^{-1}$.\n5.  It is assumed that heat capacity changes are negligible, rendering $\\Delta H$ and $\\Delta S$ independent of temperature in the vicinity of $T_{0}$.\n\nValidation of the problem:\nThe problem is scientifically grounded in the principles of chemical thermodynamics applied to biopolymers. The provided values for the enthalpy and entropy of folding are physically realistic: the folding process is typically exothermic ($\\Delta H  0$) due to the formation of favorable intramolecular interactions (hydrogen bonds, van der Waals contacts, hydrophobic effect), and it is entropically unfavorable ($\\Delta S  0$) because the polypeptide chain transitions from a disordered, high-entropy unfolded state to a unique, ordered, low-entropy native structure. The assumption that the change in heat capacity, $\\Delta C_p$, is negligible is a common simplification for introductory problems, though in reality, protein folding exhibits a significant positive $\\Delta C_p$. However, since this is an explicit assumption within the problem's framework, it does not invalidate the problem. The problem is well-posed, objective, and contains all necessary information for a unique solution. Therefore, the problem is deemed valid.\n\nThe solution proceeds as follows.\n\nFor a process occurring at constant temperature $T$ and constant pressure, the change in Gibbs free energy, $\\Delta G$, is the fundamental criterion for spontaneity. It is defined by the Gibbs-Helmholtz equation:\n$$\n\\Delta G = \\Delta H - T\\Delta S\n$$\nwhere $\\Delta H$ is the change in enthalpy and $\\Delta S$ is the change in entropy.\n\nThe problem requires an expression for the temperature dependence of the free energy change. Based on the provided assumption that $\\Delta H$ and $\\Delta S$ are constant with respect to temperature, the equation above,\n$$\n\\Delta G(T) = \\Delta H - T\\Delta S\n$$\ndirectly serves as the required expression, where $\\Delta H$ and $\\Delta S$ are the given constant values.\n\nNext, we evaluate whether folding is favored at the reference temperature $T_{0} = 298\\ \\text{K}$. A process is thermodynamically favored, or spontaneous, if its Gibbs free energy change is negative ($\\Delta G  0$). We can calculate $\\Delta G$ at $T_0$ using the provided data:\n$\\Delta H = -200\\ \\text{kJ mol}^{-1}$\n$\\Delta S = -0.6\\ \\text{kJ mol}^{-1}\\text{K}^{-1}$\n$T_{0} = 298\\ \\text{K}$\n\nSubstituting these values into the Gibbs free energy equation:\n$$\n\\Delta G(T_0) = \\Delta H - T_{0}\\Delta S\n$$\n$$\n\\Delta G(298\\ \\text{K}) = (-200\\ \\text{kJ mol}^{-1}) - (298\\ \\text{K})(-0.6\\ \\text{kJ mol}^{-1}\\text{K}^{-1})\n$$\n$$\n\\Delta G(298\\ \\text{K}) = -200\\ \\text{kJ mol}^{-1} + (298 \\times 0.6)\\ \\text{kJ mol}^{-1}\n$$\n$$\n\\Delta G(298\\ \\text{K}) = -200\\ \\text{kJ mol}^{-1} + 178.8\\ \\text{kJ mol}^{-1}\n$$\n$$\n\\Delta G(298\\ \\text{K}) = -21.2\\ \\text{kJ mol}^{-1}\n$$\nSince $\\Delta G(298\\ \\text{K}) = -21.2\\ \\text{kJ mol}^{-1}$ is negative, the folding process is spontaneous and thus favored at the reference temperature $T_0 = 298\\ \\text{K}$.\n\nNow we assess the balance between enthalpic and entropic contributions as temperature changes. The total free energy change $\\Delta G$ is the sum of the enthalpic contribution, $\\Delta H$, and the entropic contribution, $-T\\Delta S$.\nThe enthalpic term, $\\Delta H = -200\\ \\text{kJ mol}^{-1}$, is constant and strongly favors folding.\nThe entropic term, $-T\\Delta S = -T(-0.6\\ \\text{kJ mol}^{-1}\\text{K}^{-1}) = 0.6T\\ \\text{kJ mol}^{-1}$, opposes folding and its magnitude increases linearly with absolute temperature $T$.\nAt low temperatures, the favorable enthalpic term dominates, leading to a negative $\\Delta G$ and spontaneous folding. As temperature increases, the unfavorable entropic term grows in magnitude and increasingly counteracts the favorable enthalpy.\n\nThe driving force for folding changes sign at the temperature where $\\Delta G = 0$. This temperature, often denoted as the melting or transition temperature $T_m$, represents the point of equilibrium between the folded and unfolded states. We find this temperature by setting $\\Delta G(T_m) = 0$:\n$$\n\\Delta G(T_m) = \\Delta H - T_{m}\\Delta S = 0\n$$\nSolving for $T_m$:\n$$\nT_{m} = \\frac{\\Delta H}{\\Delta S}\n$$\nSubstituting the given values:\n$$\nT_{m} = \\frac{-200\\ \\text{kJ mol}^{-1}}{-0.6\\ \\text{kJ mol}^{-1}\\text{K}^{-1}} = \\frac{200}{0.6}\\ \\text{K} = \\frac{1000}{3}\\ \\text{K} \\approx 333.3\\ \\text{K}\n$$\nAt $T = T_m \\approx 333.3\\ \\text{K}$ (or $60.15^\\circ\\text{C}$), the favorable enthalpic contribution is exactly balanced by the unfavorable entropic contribution, and the protein is at equilibrium. For temperatures $T > T_m$, the term $-T\\Delta S$ will be larger in magnitude than $\\Delta H$, making $\\Delta G$ positive and causing unfolding (denaturation) to become the spontaneous process. This phenomenon is known as heat denaturation.\n\nThe problem asks for the numerical value of the Gibbs free energy change for folding at $T_{0} = 298\\ \\text{K}$, in $\\text{kJ mol}^{-1}$, rounded to three significant figures. As calculated previously, this value is $-21.2\\ \\text{kJ mol}^{-1}$.", "answer": "$$\\boxed{-21.2}$$", "id": "2935910"}, {"introduction": "Enzymes are central to virtually all biological processes, and understanding their inhibition is a cornerstone of pharmacology and drug design. This exercise delves into the quantitative analysis of enzyme kinetics, challenging you to distinguish between competitive and noncompetitive inhibition based on their distinct effects on the apparent Michaelis constant ($K_M$) and maximum velocity ($V_{\\text{max}}$). Mastering these models provides a tangible link between microscopic binding events and macroscopic reaction rates, a crucial skill for interpreting kinetic data [@problem_id:2935907].", "problem": "An enzyme that follows the Michaelisâ€“Menten (MM) mechanism $E + S \\rightleftharpoons ES \\rightarrow E + P$ is studied under initial-velocity conditions in buffered solution at constant temperature, with negligible product ($[P] \\approx 0$). The steady-state approximation holds, and the substrate binds to the active site in a reversible step that is not diffusion-limited. The turnover number $k_{\\text{cat}}$ is invariant across conditions unless explicitly altered by inhibitor binding.\n\nYou are given the following biochemical parameters measured in the absence of inhibitor:\n- Michaelis constant: $K_M = 5.0~\\mu\\mathrm{M}$.\n- Turnover number: $k_{\\text{cat}} = 50~\\mathrm{s}^{-1}$.\n- Total enzyme concentration: $[E]_T = 10~\\mathrm{nM}$.\n- Substrate concentration in all assays: $[S] = 20~\\mu\\mathrm{M}$.\n\nTwo inhibition modes are examined separately:\n- Competitive inhibition: an inhibitor $I_c$ binds only to the free enzyme, with inhibitor concentration $[I_c] = 15~\\mu\\mathrm{M}$ and inhibition constant $K_i^{(c)} = 3.0~\\mu\\mathrm{M}$.\n- Pure noncompetitive inhibition: an inhibitor $I_n$ binds to both $E$ and $ES$ with equal affinity (no change in substrate affinity of the enzyme), with inhibitor concentration $[I_n] = 8.0~\\mu\\mathrm{M}$ and inhibition constant $K_i^{(n)} = 2.0~\\mu\\mathrm{M}$. Binding of $I_n$ does not alter $k_{\\text{cat}}$ for $ES$ itself but renders inhibited complexes catalytically incompetent.\n\nStarting from the MM mechanism and the steady-state definition $v = k_{\\text{cat}}[ES]$, together with the thermodynamic definitions of the inhibition constants (e.g., $K_i = [E][I]/[EI]$ for the appropriate inhibited complexes) and mass balance on the total enzyme, perform the following:\n\n- Derive the initial velocity $v_{\\text{comp}}$ under competitive inhibition at the given $[S]$, $[E]_T$, $[I_c]$, and $K_i^{(c)}$, and identify the apparent parameters $K_M^{\\text{app}}$ and $V_{\\max}^{\\text{app}}$ under this mode.\n- Derive the initial velocity $v_{\\text{noncomp}}$ under pure noncompetitive inhibition at the given $[S]$, $[E]_T$, $[I_n]$, and $K_i^{(n)}$, and identify the apparent parameters $K_M^{\\text{app}}$ and $V_{\\max}^{\\text{app}}$ under this mode.\n- Using your derived expressions and the numerical values provided, compute the dimensionless scalar\n$$Q \\equiv \\frac{v_{\\text{comp}}}{v_{\\text{noncomp}}} \\times \\frac{K_M^{\\text{app}}(\\text{competitive})}{K_M} \\times \\frac{V_{\\max}}{V_{\\max}^{\\text{app}}(\\text{noncompetitive})}.$$\n\nReport $v_{\\text{comp}}$ and $v_{\\text{noncomp}}$ in $\\mu\\mathrm{M}\\,\\mathrm{s}^{-1}$ within your derivation to verify consistency, but the final requested quantity is $Q$. Express the final answer for $Q$ as a pure number and round to four significant figures.", "solution": "The problem is subjected to validation and is found to be scientifically grounded, well-posed, and free of contradictions or ambiguities. It presents a standard problem in enzyme kinetics. We will proceed with a rigorous derivation.\n\nThe fundamental equation for enzyme kinetics under the Michaelis-Menten (MM) model is given by the initial velocity $v$:\n$$v = \\frac{V_{\\max}[S]}{K_M + [S]}$$\nwhere $V_{\\max}$ is the maximum velocity, $K_M$ is the Michaelis constant, and $[S]$ is the substrate concentration. The maximum velocity is related to the total enzyme concentration $[E]_T$ and the turnover number $k_{\\text{cat}}$ by $V_{\\max} = k_{\\text{cat}}[E]_T$.\n\nFirst, we calculate the uninhibited maximum velocity $V_{\\max}$ using the provided parameters. The total enzyme concentration is $[E]_T = 10~\\mathrm{nM} = 1.0 \\times 10^{-2}~\\mu\\mathrm{M}$.\n$$V_{\\max} = k_{\\text{cat}}[E]_T = (50~\\mathrm{s}^{-1})(1.0 \\times 10^{-2}~\\mu\\mathrm{M}) = 0.50~\\mu\\mathrm{M}\\,\\mathrm{s}^{-1}$$\n\nPart 1: Competitive Inhibition\n\nIn competitive inhibition, the inhibitor $I_c$ binds reversibly to the free enzyme $E$, forming an inactive complex $EI_c$. The reaction scheme includes the equilibrium $E + I_c \\rightleftharpoons EI_c$, characterized by the inhibition constant $K_i^{(c)} = \\frac{[E][I_c]}{[EI_c]}$.\nThe total enzyme concentration $[E]_T$ is distributed among three species: free enzyme $[E]$, enzyme-substrate complex $[ES]$, and enzyme-inhibitor complex $[EI_c]$.\n$$[E]_T = [E] + [ES] + [EI_c]$$\nUsing the steady-state relationship for substrate binding, $[E][S] = K_M[ES]$, and the definition of $K_i^{(c)}$, we can express $[E]$ and $[EI_c]$ in terms of $[ES]$:\n$$[E] = \\frac{K_M[ES]}{[S]}$$\n$$[EI_c] = \\frac{[E][I_c]}{K_i^{(c)}} = \\left(\\frac{K_M[ES]}{[S]}\\right) \\frac{[I_c]}{K_i^{(c)}}$$\nSubstituting these into the mass balance equation:\n$$[E]_T = \\frac{K_M[ES]}{[S]} + [ES] + \\frac{K_M[ES][I_c]}{K_i^{(c)}[S]} = [ES]\\left(1 + \\frac{K_M}{[S]}\\left(1 + \\frac{[I_c]}{K_i^{(c)}}\\right)\\right)$$\nThe initial velocity is $v_{\\text{comp}} = k_{\\text{cat}}[ES]$. Solving for $[ES]$ and substituting gives:\n$$v_{\\text{comp}} = \\frac{k_{\\text{cat}}[E]_T}{1 + \\frac{K_M}{[S]}\\left(1 + \\frac{[I_c]}{K_i^{(c)}}\\right)} = \\frac{V_{\\max}[S]}{K_M\\left(1 + \\frac{[I_c]}{K_i^{(c)}}\\right) + [S]}$$\nThis equation is of the MM form with apparent parameters:\n$$V_{\\max}^{\\text{app}}(\\text{competitive}) = V_{\\max}$$\n$$K_M^{\\text{app}}(\\text{competitive}) = K_M\\left(1 + \\frac{[I_c]}{K_i^{(c)}}\\right)$$\nUsing the given numerical values: $[I_c] = 15~\\mu\\mathrm{M}$, $K_i^{(c)} = 3.0~\\mu\\mathrm{M}$, $K_M = 5.0~\\mu\\mathrm{M}$.\n$$K_M^{\\text{app}}(\\text{competitive}) = (5.0~\\mu\\mathrm{M})\\left(1 + \\frac{15}{3.0}\\right) = (5.0~\\mu\\mathrm{M})(1+5) = 30~\\mu\\mathrm{M}$$\nThe velocity under competitive inhibition at $[S] = 20~\\mu\\mathrm{M}$ is:\n$$v_{\\text{comp}} = \\frac{(0.50~\\mu\\mathrm{M}\\,\\mathrm{s}^{-1})(20~\\mu\\mathrm{M})}{30~\\mu\\mathrm{M} + 20~\\mu\\mathrm{M}} = \\frac{10}{50}~\\mu\\mathrm{M}\\,\\mathrm{s}^{-1} = 0.20~\\mu\\mathrm{M}\\,\\mathrm{s}^{-1}$$\n\nPart 2: Pure Noncompetitive Inhibition\n\nIn pure noncompetitive inhibition, the inhibitor $I_n$ binds to both the free enzyme $E$ and the enzyme-substrate complex $ES$ with equal affinity. The relevant equilibria are $E + I_n \\rightleftharpoons EI_n$ and $ES + I_n \\rightleftharpoons ESI_n$, with the same inhibition constant $K_i^{(n)} = \\frac{[E][I_n]}{[EI_n]} = \\frac{[ES][I_n]}{[ESI_n]}$. The $ESI_n$ complex is catalytically inactive.\nThe mass balance for the enzyme is:\n$$[E]_T = [E] + [ES] + [EI_n] + [ESI_n]$$\nWe express all species in terms of $[ES]$:\n$$[E] = \\frac{K_M[ES]}{[S]}$$\n$$[EI_n] = \\frac{[E][I_n]}{K_i^{(n)}} = \\frac{K_M[ES][I_n]}{K_i^{(n)}[S]}$$\n$$[ESI_n] = \\frac{[ES][I_n]}{K_i^{(n)}}$$\nSubstituting into the mass balance:\n$$[E]_T = [ES]\\left(1 + \\frac{K_M}{[S]} + \\frac{K_M[I_n]}{K_i^{(n)}[S]} + \\frac{[I_n]}{K_i^{(n)}}\\right) = [ES]\\left(1 + \\frac{[I_n]}{K_i^{(n)}}\\right)\\left(1 + \\frac{K_M}{[S]}\\right)$$\nThe velocity is $v_{\\text{noncomp}} = k_{\\text{cat}}[ES]$. Solving for $[ES]$:\n$$v_{\\text{noncomp}} = \\frac{k_{\\text{cat}}[E]_T}{\\left(1 + \\frac{[I_n]}{K_i^{(n)}}\\right)\\left(1 + \\frac{K_M}{[S]}\\right)} = \\frac{V_{\\max} / \\left(1 + \\frac{[I_n]}{K_i^{(n)}}\\right)}{1 + \\frac{K_M}{[S]}} = \\frac{\\left(\\frac{V_{\\max}}{1 + [I_n]/K_i^{(n)}}\\right)[S]}{K_M + [S]}$$\nThe apparent parameters are:\n$$V_{\\max}^{\\text{app}}(\\text{noncompetitive}) = \\frac{V_{\\max}}{1 + \\frac{[I_n]}{K_i^{(n)}}}$$\n$$K_M^{\\text{app}}(\\text{noncompetitive}) = K_M$$\nUsing the given values: $[I_n] = 8.0~\\mu\\mathrm{M}$, $K_i^{(n)} = 2.0~\\mu\\mathrm{M}$.\n$$V_{\\max}^{\\text{app}}(\\text{noncompetitive}) = \\frac{0.50~\\mu\\mathrm{M}\\,\\mathrm{s}^{-1}}{1 + \\frac{8.0}{2.0}} = \\frac{0.50~\\mu\\mathrm{M}\\,\\mathrm{s}^{-1}}{1+4} = 0.10~\\mu\\mathrm{M}\\,\\mathrm{s}^{-1}$$\nThe velocity under noncompetitive inhibition at $[S] = 20~\\mu\\mathrm{M}$ is:\n$$v_{\\text{noncomp}} = \\frac{(0.10~\\mu\\mathrm{M}\\,\\mathrm{s}^{-1})(20~\\mu\\mathrm{M})}{5.0~\\mu\\mathrm{M} + 20~\\mu\\mathrm{M}} = \\frac{2.0}{25}~\\mu\\mathrm{M}\\,\\mathrm{s}^{-1} = 0.080~\\mu\\mathrm{M}\\,\\mathrm{s}^{-1}$$\n\nPart 3: Calculation of $Q$\n\nThe dimensionless quantity $Q$ is defined as:\n$$Q \\equiv \\frac{v_{\\text{comp}}}{v_{\\text{noncomp}}} \\times \\frac{K_M^{\\text{app}}(\\text{competitive})}{K_M} \\times \\frac{V_{\\max}}{V_{\\max}^{\\text{app}}(\\text{noncompetitive})}$$\nWe can compute this directly from the numerical values we have calculated:\n$v_{\\text{comp}} = 0.20~\\mu\\mathrm{M}\\,\\mathrm{s}^{-1}$\n$v_{\\text{noncomp}} = 0.080~\\mu\\mathrm{M}\\,\\mathrm{s}^{-1}$\n$K_M^{\\text{app}}(\\text{competitive}) = 30~\\mu\\mathrm{M}$\n$K_M = 5.0~\\mu\\mathrm{M}$\n$V_{\\max} = 0.50~\\mu\\mathrm{M}\\,\\mathrm{s}^{-1}$\n$V_{\\max}^{\\text{app}}(\\text{noncompetitive}) = 0.10~\\mu\\mathrm{M}\\,\\mathrm{s}^{-1}$\n$$Q = \\left(\\frac{0.20}{0.080}\\right) \\times \\left(\\frac{30}{5.0}\\right) \\times \\left(\\frac{0.50}{0.10}\\right) = (2.5) \\times (6.0) \\times (5.0) = 75$$\nAlternatively, we can derive a symbolic expression for $Q$. Let $\\alpha_c = 1 + \\frac{[I_c]}{K_i^{(c)}}$ and $\\alpha_n = 1 + \\frac{[I_n]}{K_i^{(n)}}$.\nThe components of $Q$ are:\n$$K_M^{\\text{app}}(\\text{competitive}) = K_M \\alpha_c$$\n$$V_{\\max}^{\\text{app}}(\\text{noncompetitive}) = V_{\\max} / \\alpha_n$$\n$$v_{\\text{comp}} = \\frac{V_{\\max}[S]}{K_M \\alpha_c + [S]}$$\n$$v_{\\text{noncomp}} = \\frac{(V_{\\max}/\\alpha_n)[S]}{K_M + [S]}$$\nSubstituting these into the expression for $Q$:\n$$Q = \\frac{\\frac{V_{\\max}[S]}{K_M \\alpha_c + [S]}}{\\frac{V_{\\max}[S]}{\\alpha_n(K_M + [S])}} \\times \\frac{K_M \\alpha_c}{K_M} \\times \\frac{V_{\\max}}{V_{\\max}/\\alpha_n}$$\n$$Q = \\frac{\\alpha_n (K_M + [S])}{K_M \\alpha_c + [S]} \\times \\alpha_c \\times \\alpha_n = (\\alpha_n)^2 \\alpha_c \\frac{K_M + [S]}{K_M \\alpha_c + [S]}$$\nNow we substitute the numerical values:\n$\\alpha_c = 1 + \\frac{15}{3.0} = 6.0$\n$\\alpha_n = 1 + \\frac{8.0}{2.0} = 5.0$\n$K_M = 5.0~\\mu\\mathrm{M}$\n$[S] = 20~\\mu\\mathrm{M}$\n$$Q = (5.0)^2 \\times (6.0) \\times \\frac{5.0 + 20}{5.0 \\times 6.0 + 20} = 25 \\times 6.0 \\times \\frac{25}{30+20} = 150 \\times \\frac{25}{50} = 150 \\times 0.5 = 75$$\nBoth methods yield the same result. The problem requires the answer to be rounded to four significant figures.", "answer": "$$\\boxed{75.00}$$", "id": "2935907"}, {"introduction": "Measuring equilibrium properties like free energy can be experimentally challenging, as many modern techniques, such as single-molecule pulling, operate far from equilibrium. This advanced practice introduces the Jarzynski equality, a remarkable result from non-equilibrium statistical mechanics that connects work performed during an irreversible process to an equilibrium free energy difference ($\\Delta F$). By implementing this relation computationally, you will learn how to extract fundamental thermodynamic quantities from simulated non-equilibrium experimental data, a powerful skill in modern biophysics [@problem_id:2935883].", "problem": "You are given sets of independent nonequilibrium mechanical work samples for unfolding a single protein domain collected in repeated fast pulling experiments. Each work sample is reported per molecule in picoNewton-nanometer. Temperatures are given in Kelvin. Your task is to implement a program that, starting from first principles of equilibrium statistical mechanics and microscopic reversibility, derives an estimator for the equilibrium Helmholtz free energy difference between folded and unfolded states using the nonequilibrium work relation that connects an exponential average of work to the equilibrium free energy difference. You must then apply this estimator to the provided test suite and report numerical answers.\n\nFundamental base you may use:\n- Canonical ensemble: For a system at temperature $T$, the Helmholtz free energy is $F=-k_{\\mathrm{B}} T \\ln Z$, where $k_{\\mathrm{B}}$ is the Boltzmann constant, $T$ is the absolute temperature, and $Z$ is the canonical partition function.\n- Microscopic reversibility and established nonequilibrium work relation: The exponential average of the nonequilibrium work over many realizations under a fixed protocol is related to the equilibrium free energy difference between initial and final states.\n- Work is path dependent, but the equilibrium free energy difference is a state function.\n\nImplementation constraints:\n- Use $k_{\\mathrm{B}}=1.380649\\times 10^{-23}\\ \\mathrm{J\\,K^{-1}}$ and $N_{\\mathrm{A}}=6.02214076\\times 10^{23}\\ \\mathrm{mol^{-1}}$.\n- Convert each work $W$ from picoNewton-nanometer to Joule using $1\\ \\mathrm{pN\\cdot nm}=10^{-21}\\ \\mathrm{J}$.\n- Temperature $T$ is given in Kelvin.\n- For numerical stability when averaging exponentials, design your computation to avoid underflow for large positive $W$ by appropriate rescaling of exponents before taking logarithms; do not compute naive exponentials of large negative arguments directly.\n- For each test case, compute the equilibrium unfolding free energy difference $\\Delta F$ per mole in kilojoule per mole using your estimator and report a single floating-point number rounded to three decimal places.\n\nAngle units do not apply. If any fraction arises in your internal derivation, your program should still output a floating-point number as specified.\n\nTest suite:\n- Case $1$: $T=298\\ \\mathrm{K}$, work samples in $\\mathrm{pN\\cdot nm}$:\n  $[247.0,255.3,260.1,241.5,252.8,249.2,258.9,243.6,251.0,246.8,262.4,239.7,254.1,248.5,257.3,244.9,250.6,263.0,242.1,256.0]$.\n- Case $2$: $T=310\\ \\mathrm{K}$, work samples in $\\mathrm{pN\\cdot nm}$:\n  $[124.0,126.1,122.5,125.3,127.0,123.8,124.7,125.9,126.4,123.2,124.5,125.1,126.0,123.9,124.8]$.\n- Case $3$: $T=298\\ \\mathrm{K}$, work samples in $\\mathrm{pN\\cdot nm}$:\n  $[420.5,395.2,410.1,505.3,460.7,442.8,487.6,378.4,455.9,468.2,499.1,389.3,472.5,361.7,435.0,481.2,352.6,460.3,341.9,492.7,227.8,243.5,269.1,312.4,285.0,301.6,520.3,476.9,458.7,440.2,355.5,330.8,290.4,275.2,261.9,240.3,510.8,497.0,482.6,466.4]$.\n- Case $4$: $T=298\\ \\mathrm{K}$, work samples in $\\mathrm{pN\\cdot nm}$:\n  $[260.0,310.0,280.0]$.\n\nRequired unit for answers:\n- Report $\\Delta F$ per mole in $\\mathrm{kJ\\,mol^{-1}}$, each rounded to three decimal places.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order of the cases above, for example, $[\\text{result}_1,\\text{result}_2,\\text{result}_3,\\text{result}_4]$, where each $\\text{result}_i$ is a floating-point number with three digits after the decimal point in $\\mathrm{kJ\\,mol^{-1}}$.", "solution": "We begin with the canonical ensemble, where the Helmholtz free energy is $F=-k_{\\mathrm{B}} T \\ln Z$, with $k_{\\mathrm{B}}$ the Boltzmann constant, $T$ the absolute temperature, and $Z$ the canonical partition function. For an unfolding process that transforms an initial equilibrium state to a final equilibrium state by a driven protocol, the equilibrium free energy difference is $\\Delta F=F_{\\text{final}}-F_{\\text{initial}}$.\n\nMicroscopic reversibility and Hamiltonian dynamics underpin a class of nonequilibrium work relations connecting irreversible work measurements to equilibrium free energy differences. For a fixed protocol repeated many times from the same initial equilibrium state, the exponential average of the work over realizations yields the equilibrium free energy difference. Specifically, if $W$ denotes the mechanical work along a realization and $\\beta=(k_{\\mathrm{B}} T)^{-1}$, then the nonequilibrium work relation states that the exponential average of $W$ encodes $\\Delta F$. From this relation and the definition of expectation as a limit of sample averages, a consistent finite-sample estimator based on $N$ observed works $\\{W_i\\}_{i=1}^N$ is obtained by replacing the ensemble average with the sample mean of exponentials and then taking the appropriate logarithm and scaling by $k_{\\mathrm{B}} T$.\n\nExplicitly, for a given set $\\{W_i\\}_{i=1}^N$, temperature $T$, and $\\beta=(k_{\\mathrm{B}} T)^{-1}$, the estimator is\n$$\n\\widehat{\\Delta F}=-k_{\\mathrm{B}} T \\ln\\left(\\frac{1}{N}\\sum_{i=1}^N e^{-\\beta W_i}\\right).\n$$\nThis follows by combining (i) the canonical definition of free energy, (ii) microscopic reversibility leading to the nonequilibrium work relation connecting the exponential average of $W$ and $\\Delta F$, and (iii) replacing the ensemble average with the sample average to produce a computable estimator. This estimator is asymptotically unbiased as $N\\to\\infty$, though for finite $N$ it may exhibit bias that decreases with the occurrence of low-work realizations.\n\nNumerical stability: Direct computation of $e^{-\\beta W_i}$ may underflow when $W_i$ is large and positive in units of $k_{\\mathrm{B}} T$. To avoid underflow, we use a rescaled log-sum-exp computation. Define $a_i=-\\beta W_i$, and let $a_{\\max}=\\max_i a_i$. Then\n$$\n\\frac{1}{N}\\sum_{i=1}^N e^{a_i}=e^{a_{\\max}} \\cdot \\frac{1}{N}\\sum_{i=1}^N e^{a_i-a_{\\max}},\n$$\nso that\n$$\n\\ln\\left(\\frac{1}{N}\\sum_{i=1}^N e^{a_i}\\right)=a_{\\max}+\\ln\\left(\\frac{1}{N}\\sum_{i=1}^N e^{a_i-a_{\\max}}\\right).\n$$\nTherefore,\n$$\n\\widehat{\\Delta F}=-k_{\\mathrm{B}} T \\left[a_{\\max}+\\ln\\left(\\frac{1}{N}\\sum_{i=1}^N e^{a_i-a_{\\max}}\\right)\\right].\n$$\nSince $a_i-a_{\\max}\\le 0$, the inner exponentials are bounded by $1$ and numerically safe.\n\nUnits and conversions:\n- Input works are per molecule in picoNewton-nanometer. Use $1\\ \\mathrm{pN\\cdot nm}=10^{-21}\\ \\mathrm{J}$ to convert to Joule per molecule.\n- Use $k_{\\mathrm{B}}=1.380649\\times 10^{-23}\\ \\mathrm{J\\,K^{-1}}$ and $N_{\\mathrm{A}}=6.02214076\\times 10^{23}\\ \\mathrm{mol^{-1}}$.\n- After computing $\\widehat{\\Delta F}$ in Joule per molecule, convert to kilojoule per mole via\n$$\n\\widehat{\\Delta F}\\ (\\mathrm{kJ\\,mol^{-1}})=\\frac{\\widehat{\\Delta F}\\ (\\mathrm{J\\ per\\ molecule})\\times N_{\\mathrm{A}}}{1000}.\n$$\n\nAlgorithm for each test case:\n1. Read temperature $T$ (Kelvin) and work samples $\\{W_i^{\\mathrm{(pN\\cdot nm)}}\\}$.\n2. Convert $W_i$ to Joule: $W_i^{\\mathrm{(J)}}=W_i^{\\mathrm{(pN\\cdot nm)}}\\times 10^{-21}$.\n3. Compute $\\beta=(k_{\\mathrm{B}} T)^{-1}$.\n4. Form $a_i=-\\beta W_i^{\\mathrm{(J)}}$.\n5. Compute $a_{\\max}=\\max_i a_i$.\n6. Compute $\\ln M = a_{\\max}+\\ln\\left(\\frac{1}{N}\\sum_{i=1}^N e^{a_i-a_{\\max}}\\right)$.\n7. Compute $\\widehat{\\Delta F}^{\\mathrm{(J)}}=-k_{\\mathrm{B}} T \\cdot \\ln M$.\n8. Convert to $\\mathrm{kJ\\,mol^{-1}}$ using $N_{\\mathrm{A}}$ and divide by $1000$.\n9. Round to three decimal places.\n10. Output the four results in a single bracketed, comma-separated line in the order of the cases.\n\nThe test suite includes:\n- A typical near-reversible set at $T=298\\ \\mathrm{K}$ with works around several tens of $k_{\\mathrm{B}} T$.\n- A higher-temperature, near-equilibrium set at $T=310\\ \\mathrm{K}$.\n- A highly dissipative set at $T=298\\ \\mathrm{K}$ with a broad distribution and rare low-work events to ensure proper convergence of the exponential average.\n- A small-sample edge case at $T=298\\ \\mathrm{K}$ to illustrate finite-sample bias and numerical handling with minimal data.\n\nThe program implements this procedure and prints the results as required.", "answer": "```python\nimport numpy as np\n\n# Constants (CODATA exact values where defined)\nk_B = 1.380649e-23          # Boltzmann constant in J/K\nN_A = 6.02214076e23         # Avogadro constant in 1/mol\nPNM_TO_J = 1e-21            # 1 pN*nm in Joule\nJ_TO_KJMOL = N_A / 1000.0   # Convert J per molecule to kJ/mol\n\ndef jarzynski_deltaF_kJ_per_mol(work_pNnm, T_K):\n    \"\"\"\n    Compute Jarzynski estimator of DeltaF from work samples (per molecule) given in pN*nm at temperature T_K.\n    Returns DeltaF in kJ/mol using a numerically stable log-sum-exp computation.\n    \"\"\"\n    W_J = np.array(work_pNnm, dtype=np.float64) * PNM_TO_J  # per molecule in Joule\n    beta = 1.0 / (k_B * T_K)\n    a = -beta * W_J  # exponents\n    a_max = np.max(a)\n    # Compute log of mean exp(a) stably\n    # ln(mean(exp(a))) = a_max + ln(mean(exp(a - a_max)))\n    exp_shifted = np.exp(a - a_max)\n    ln_mean_exp = a_max + np.log(np.mean(exp_shifted))\n    deltaF_J = - (k_B * T_K) * ln_mean_exp  # per molecule in Joule\n    deltaF_kJ_per_mol = deltaF_J * J_TO_KJMOL\n    return float(deltaF_kJ_per_mol)\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1\n        {\n            \"T_K\": 298.0,\n            \"work_pNnm\": [\n                247.0, 255.3, 260.1, 241.5, 252.8, 249.2, 258.9, 243.6, 251.0, 246.8,\n                262.4, 239.7, 254.1, 248.5, 257.3, 244.9, 250.6, 263.0, 242.1, 256.0\n            ],\n        },\n        # Case 2\n        {\n            \"T_K\": 310.0,\n            \"work_pNnm\": [\n                124.0, 126.1, 122.5, 125.3, 127.0, 123.8, 124.7, 125.9, 126.4, 123.2,\n                124.5, 125.1, 126.0, 123.9, 124.8\n            ],\n        },\n        # Case 3\n        {\n            \"T_K\": 298.0,\n            \"work_pNnm\": [\n                420.5, 395.2, 410.1, 505.3, 460.7, 442.8, 487.6, 378.4, 455.9, 468.2,\n                499.1, 389.3, 472.5, 361.7, 435.0, 481.2, 352.6, 460.3, 341.9, 492.7,\n                227.8, 243.5, 269.1, 312.4, 285.0, 301.6, 520.3, 476.9, 458.7, 440.2,\n                355.5, 330.8, 290.4, 275.2, 261.9, 240.3, 510.8, 497.0, 482.6, 466.4\n            ],\n        },\n        # Case 4\n        {\n            \"T_K\": 298.0,\n            \"work_pNnm\": [260.0, 310.0, 280.0],\n        },\n    ]\n\n    results = []\n    for case in test_cases:\n        T_K = case[\"T_K\"]\n        work = case[\"work_pNnm\"]\n        deltaF_kJmol = jarzynski_deltaF_kJ_per_mol(work, T_K)\n        results.append(deltaF_kJmol)\n\n    # Format each result to three decimal places and print as a single line list without spaces\n    formatted = [f\"{x:.3f}\" for x in results]\n    print(f\"[{','.join(formatted)}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "2935883"}]}