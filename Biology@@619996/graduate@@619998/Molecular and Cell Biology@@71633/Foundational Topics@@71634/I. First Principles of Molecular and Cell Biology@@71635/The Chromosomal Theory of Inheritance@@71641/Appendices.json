{"hands_on_practices": [{"introduction": "The three-point testcross is a classic and powerful tool for elucidating the linear arrangement of genes on a chromosome. This exercise moves beyond simple gene ordering to the quantitative analysis of meiotic interference, the phenomenon where one crossover event influences the likelihood of another nearby. By analyzing progeny counts from a hypothetical cross, you will calculate the coefficient of coincidence and interference, gaining hands-on practice in translating raw genetic data into a deeper understanding of the physical mechanisms governing recombination [@problem_id:2842598].", "problem": "In a three-point testcross in the fruit fly Drosophila melanogaster involving loci $A$, $B$, and $C$ in that unknown order, an investigator counts $n = 10{,}000$ progeny and classifies them into four disjoint categories according to crossover structure inferred from phenotypes: nonrecombinant across both intervals $A$–$B$ and $B$–$C$, single crossover in $A$–$B$ only, single crossover in $B$–$C$ only, and double crossover in both intervals. The observed counts are: nonrecombinant $8{,}060$, single crossover in $A$–$B$ $1{,}140$, single crossover in $B$–$C$ $740$, and double crossover $60$. Using only foundational principles of the chromosomal theory of inheritance—namely, that alleles reside on physical chromosomes, that homologous chromosomes pair and segregate in meiosis, that crossing over occurs as physical exchange between non-sister chromatids producing recombinant chromatids, and that a testcross maps gametic genotypes to progeny phenotypes without masking—derive from first principles how to compute the expected number of double crossovers under the assumption that crossover formation in adjacent intervals is independent when there is no interference. Then compute the coefficient of coincidence and interference from the observed and expected double crossovers. Finally, provide a brief biological interpretation of the numerical values obtained in terms of interference direction and magnitude. Express the coefficient of coincidence and the interference as dimensionless decimals, each rounded to four significant figures. The final reported answer must list, in order, the coefficient of coincidence and the interference.", "solution": "The problem requires the derivation of the expected number of double crossovers under the assumption of independence, followed by the calculation of the coefficient of coincidence and interference from provided testcross data, and a biological interpretation of the results. The problem is valid as it is scientifically grounded, well-posed, and internally consistent.\n\nFirst, let us establish the foundational principles. A three-point testcross involves a parent heterozygous for three linked loci ($A$, $B$, $C$) crossed with a parent homozygous recessive for all three loci. The phenotypes of the progeny directly reflect the gametic genotypes produced by the heterozygous parent. Recombination frequency between two loci is defined as the proportion of recombinant gametes (and thus, progeny) out of the total. It is calculated as the sum of progeny resulting from a crossover event in the interval between the two loci, divided by the total number of progeny.\n\nThe provided data are categorized by crossover events in two adjacent chromosomal intervals, which we shall label as interval $1$ (between loci $A$ and $B$) and interval $2$ (between loci $B$ and $C$). The given counts are:\nTotal progeny, $n = 10{,}000$\nNonrecombinant (NCO) count, $N_{NCO} = 8{,}060$\nSingle crossover in interval $1$ (SCO I), $N_{SCO_1} = 1{,}140$\nSingle crossover in interval $2$ (SCO II), $N_{SCO_2} = 740$\nDouble crossover (DCO), $N_{DCO} = 60$\nThe sum is $8{,}060 + 1{,}140 + 740 + 60 = 10{,}000$, which is consistent with the total progeny count $n$.\n\nThe recombination frequency for interval $1$, $RF_1$, is the proportion of progeny that resulted from a crossover in this interval. These include the single crossovers in interval $1$ and the double crossovers.\n$$RF_1 = \\frac{N_{SCO_1} + N_{DCO}}{n} = \\frac{1{,}140 + 60}{10{,}000} = \\frac{1{,}200}{10{,}000} = 0.12$$\n\nSimilarly, the recombination frequency for interval $2$, $RF_2$, is the proportion of progeny that resulted from a crossover in this second interval. These include the single crossovers in interval $2$ and the double crossovers.\n$$RF_2 = \\frac{N_{SCO_2} + N_{DCO}}{n} = \\frac{740 + 60}{10{,}000} = \\frac{800}{10{,}000} = 0.08$$\n\nThe problem asks for a derivation of the expected number of double crossovers under the assumption that crossover events in adjacent intervals are independent. This condition signifies an absence of interference. According to the laws of probability, the probability of two independent events occurring simultaneously is the product of their individual probabilities.\nLet $P(CO_1)$ be the probability of a crossover in interval $1$, and $P(CO_2)$ be the probability of a crossover in interval $2$. Per the definition of recombination frequency, $P(CO_1) = RF_1$ and $P(CO_2) = RF_2$.\nIf the events are independent, the probability of a double crossover, $P(DCO)$, is:\n$$P(DCO)_{\\text{expected}} = P(CO_1) \\times P(CO_2) = RF_1 \\times RF_2$$\nThis is the expected frequency of double crossovers. To find the expected *number* of double crossover progeny, $N_{DCO, \\text{exp}}$, in a population of size $n$, we multiply this probability by $n$:\n$$N_{DCO, \\text{exp}} = n \\times P(DCO)_{\\text{expected}} = n \\times RF_1 \\times RF_2$$\nThis concludes the derivation from first principles.\n\nNow, we substitute the calculated values of $RF_1$ and $RF_2$ to find the expected number of double crossovers:\n$$N_{DCO, \\text{exp}} = 10{,}000 \\times 0.12 \\times 0.08 = 10{,}000 \\times 0.0096 = 96$$\nThe expected count of double crossovers, assuming no interference, is $96$. The observed count is $N_{DCO, \\text{obs}} = 60$.\n\nThe coefficient of coincidence, $C$, is the ratio of the observed number of double crossovers to the expected number of double crossovers. It measures the extent to which the expected number of double crossovers is realized.\n$$C = \\frac{N_{DCO, \\text{obs}}}{N_{DCO, \\text{exp}}} = \\frac{60}{96} = \\frac{5}{8} = 0.625$$\nRounding to four significant figures, we get $C = 0.6250$.\n\nInterference, $I$, quantifies the degree to which one crossover event influences the probability of a second crossover event in an adjacent region. It is defined as:\n$$I = 1 - C$$\nSubstituting the value of $C$:\n$$I = 1 - 0.625 = 0.375$$\nRounding to four significant figures, we get $I = 0.3750$.\n\nFinally, a brief biological interpretation of these values is required.\nThe coefficient of coincidence, $C = 0.6250$, indicates that the observed frequency of double crossovers is only $62.5\\%$ of what would be expected if crossovers in the two intervals were independent events.\nThe interference value, $I = 0.3750$, is positive. This signifies positive interference, a common biological phenomenon where the formation of one crossover (chiasma) on a chromosome mechanically or biochemically inhibits the formation of a second crossover in a nearby region. In this specific case, $37.5\\%$ of the expected double crossovers were prevented from occurring due to this inhibitory effect. The presence of a crossover in one interval has reduced the likelihood of a crossover in the adjacent interval by $37.5\\%$.", "answer": "$$\\boxed{\\begin{pmatrix} 0.6250 & 0.3750 \\end{pmatrix}}$$", "id": "2842598"}, {"introduction": "In certain organisms like filamentous fungi, the products of a single meiosis are held together in an ordered sac, or ascus, providing an unparalleled window into meiotic processes. This practice utilizes ordered tetrad analysis to determine the map distance between a gene and its centromere, a key chromosomal landmark. You will derive the mapping function from first principles of segregation and then apply it to a dataset, developing skills in both theoretical derivation and the critical interpretation of meiotic data, including how to handle ambiguous results like post-meiotic segregation [@problem_id:2965663].", "problem": "A filamentous Ascomycete is used to perform ordered tetrad analysis to estimate the distance between a single locus and its chromosome’s centromere, in the framework of the chromosomal theory of inheritance. Use only foundational principles about meiosis and segregation to derive the necessary relationships, then apply them to the data given below.\n\nFoundational context you may use: During meiosis I, homologous centromeres segregate to opposite poles. In an ordered ascus, the linear arrangement of the eight spores reflects the sequence of meiotic divisions along the ascus axis. If a locus experiences no exchange between it and its centromere prior to meiosis I, its alleles segregate at the first division, producing a contiguous block of four spores of one allele followed by four of the other (first-division segregation, FDS). If there is an exchange between the locus and the centromere before meiosis I, alleles do not segregate until after meiosis II, yielding interleaved blocks along the ascus axis (second-division segregation, SDS). You may assume: no chromatid interference, random chromatid participation in exchanges, and that the parity of the number of exchanges between the centromere and the locus determines whether FDS (even parity) or SDS (odd parity) is observed.\n\nAn experiment scored ordered asci for a single heterozygous locus. The dataset is:\n- First-division segregation (FDS): $542$ asci\n- Second-division segregation (SDS): $238$ asci\n- Post-meiotic segregation (PMS; aberrant segregations consistent with unrepaired heteroduplex, e.g., $5:3$ or $3:5$): $12$ asci\n- Unscorable or disordered asci: $8$ asci\n\nTasks:\n1. From the foundational context above, derive an expression for the gene–centromere map distance in terms of the observable frequency of second-division segregation asci, clearly stating any assumptions you make to connect the observable tetrad classes to a recombination-based distance measure.\n2. Apply your expression to the dataset, using only asci that can be unambiguously classified as first-division segregation or second-division segregation for the simple two-allele locus (exclude the post-meiotic segregation and unscorable asci), and compute the gene–centromere distance.\n3. Briefly justify whether excluding the post-meiotic segregation asci is appropriate in this context, and predict qualitatively how including them as second-division segregation would bias the estimate.\n\nExpress the final numerical distance in centimorgans (cM) and round your answer to four significant figures. The final answer must be a single real number.", "solution": "The problem requires a derivation of the gene-centromere map distance from ordered tetrad data, its application to a given dataset, and a critical analysis of the data treatment.\n\nFirst, we must derive the relationship between map distance and the frequency of second-division segregation asci from foundational principles of meiosis. Map distance, measured in centimorgans (cM), is defined as the frequency of recombinant meiotic products (gametes or, in this case, spores) multiplied by $100$. A distance of $1$ cM corresponds to a $1\\%$ recombination frequency.\n\nLet $N_{FDS}$ represent the number of asci showing first-division segregation and $N_{SDS}$ be the number of asci showing second-division segregation. The total number of asci considered for the analysis is $N_{total} = N_{FDS} + N_{SDS}$. Each ascus contains $8$ spores resulting from one meiotic event followed by one mitotic division.\n\nFirst-division segregation (FDS) patterns arise when no effective crossover (i.e., an even number of exchanges, including zero) occurs between the gene locus and the centromere. In an FDS ascus, all $8$ spores are of the parental type with respect to the centromere linkage. Thus, FDS asci contain zero recombinant spores.\n\nSecond-division segregation (SDS) patterns are observed when an odd number of crossovers occurs between the locus and the centromere. Let us consider the simplest case: a single crossover. This event involves two of the four chromatids present at the four-strand stage of Meiosis I. The two participating chromatids become recombinant, while the other two remain non-recombinant (parental). After meiosis and the subsequent mitosis, the resulting ascus contains $4$ recombinant spores and $4$ parental spores. Therefore, exactly one-half of the spores in an SDS ascus are products of recombination. This $1:1$ ratio of recombinant to parental products within a recombinant tetrad holds true on average for multiple crossovers as well, under the standard assumption of no chromatid interference.\n\nThe overall recombination frequency ($RF$) is the ratio of the total number of recombinant spores to the total number of spores.\nThe total number of spores in the sample is $8 \\times N_{total} = 8 \\times (N_{FDS} + N_{SDS})$.\nRecombinant spores are only found in SDS asci. Each of the $N_{SDS}$ asci contributes $4$ recombinant spores. Therefore, the total number of recombinant spores is $4 \\times N_{SDS}$.\n\nWe can now write the expression for the recombination frequency:\n$$RF = \\frac{\\text{Total number of recombinant spores}}{\\text{Total number of spores}} = \\frac{4 \\times N_{SDS}}{8 \\times (N_{FDS} + N_{SDS})}$$\nThis expression simplifies to:\n$$RF = \\frac{1}{2} \\times \\frac{N_{SDS}}{N_{FDS} + N_{SDS}}$$\nThe term $\\frac{N_{SDS}}{N_{FDS} + N_{SDS}}$ is the observable frequency of second-division segregation asci, which can be denoted as $f_{SDS}$. The equation becomes $RF = \\frac{1}{2} f_{SDS}$.\nThe map distance in centimorgans is $100 \\times RF$. Substituting our expression for $RF$, we arrive at the required formula:\n$$ \\text{Distance (cM)} = 100 \\times \\left( \\frac{1}{2} f_{SDS} \\right) = 50 \\times f_{SDS} = 50 \\times \\frac{N_{SDS}}{N_{FDS} + N_{SDS}} $$\n\nSecond, we apply this formula to the provided dataset. We are given:\n- FDS asci, $N_{FDS} = 542$\n- SDS asci, $N_{SDS} = 238$\nThe problem specifies to exclude the post-meiotic segregation (PMS) and unscorable asci. The total number of classifiable asci is:\n$$N_{total} = N_{FDS} + N_{SDS} = 542 + 238 = 780$$\nThe frequency of SDS asci is:\n$$f_{SDS} = \\frac{N_{SDS}}{N_{total}} = \\frac{238}{780}$$\nNow, we compute the map distance:\n$$ \\text{Distance (cM)} = 50 \\times \\frac{238}{780} = \\frac{11900}{780} \\approx 15.25641... $$\nAs required, rounding to four significant figures yields a distance of $15.26$ cM.\n\nThird, we address the justification for excluding post-meiotic segregation (PMS) asci and the resulting bias if they were included.\nPMS arises from heteroduplex DNA formed during recombination that is not resolved by the mismatch repair machinery before the post-meiotic mitotic division. This results in asci with non-Mendelian segregation ratios, such as $5:3$ or $3:5$. The formation of a heteroduplex is an integral part of the recombination process. Therefore, the observation of PMS implies that a recombination event has occurred at the locus. If this event took place in the interval between the gene and the centromere, the ascus is mechanistically a type of SDS ascus.\n\nHowever, exclusion is justified because the model used for calculating map distance is based on a clean distinction between FDS and SDS asci, which both exhibit $4:4$ allele segregation patterns. PMS represents a different molecular outcome (gene conversion or its failure) that complicates this simple classification. By excluding these $12$ PMS asci, we are isolating the phenomenon of crossing-over from that of gene conversion, which provides a more conventional estimate of map distance as defined by crossover frequency.\n\nIf one were to include the PMS asci by classifying them as SDS asci, it would change the calculated values. The number of SDS-type asci would become $N'_{SDS} = N_{SDS} + N_{PMS} = 238 + 12 = 250$. The total number of asci would become $N'_{total} = N_{FDS} + N'_{SDS} = 542 + 250 = 792$. The new map distance would be:\n$$ \\text{Distance' (cM)} = 50 \\times \\frac{250}{792} \\approx 15.7828... $$\nThis value is higher than the $15.26$ cM calculated previously. Thus, the qualitative effect of including PMS asci by counting them as SDS asci is an **overestimation** of the gene-centromere map distance compared to the standard procedure.", "answer": "$$\n\\boxed{15.26}\n$$", "id": "2965663"}, {"introduction": "The Chromosomal Theory of Inheritance has profound implications for gene expression, particularly in species with heteromorphic sex chromosomes. This exercise bridges classical genetics with modern functional genomics by exploring the concept of dosage compensation using hypothetical RNA-sequencing data. You are tasked with deriving a robust quantitative index from first principles to measure the balance of X-linked versus autosomal expression, and then applying it to distinguish different regulatory scenarios, providing a practical demonstration of how chromosome-level properties are investigated using high-throughput molecular data [@problem_id:2965681].", "problem": "You are given paired Ribonucleic Acid sequencing (RNA-seq) data from male and female tissues for small gene sets, along with chromosome annotations identifying X-linked and autosomal genes. Your task is to formalize, derive from first principles, and compute a dimensionless index that quantifies dosage compensation between the sexes, then apply it to a fixed test suite and report numerical results.\n\nBackground and permissible foundations: The chromosomal theory of inheritance asserts that genes reside on chromosomes and segregate according to chromosomal behavior. In many species, males and females differ in the copy number of the X chromosome. The Central Dogma of molecular biology states that deoxyribonucleic acid (DNA) is transcribed into ribonucleic acid (RNA), which is translated into protein. RNA-seq measurements provide an estimate of gene expression abundance. Sex differences in X chromosome copy number can lead to dosage differences in X-linked gene expression unless compensated by regulatory mechanisms such as X-chromosome inactivation (XCI) or X-linked hypertranscription. Because sequencing depth and global transcriptional activity can vary between samples, autosomal expression provides a baseline to normalize sex-specific differences not due to X dosage.\n\nDesign and derive an index from the following principles. Let $M_i$ and $F_i$ denote expression measurements for gene $i$ in male and female samples, respectively, measured in Transcripts Per Million (TPM), and let $C_i \\in \\{\\text{\"X\"}, \\text{\"A\"}\\}$ be the chromosome label (\"X\" for X-linked, \"A\" for autosomal). Let $X_M = \\sum_{i : C_i = \\text{\"X\"}} M_i$, $A_M = \\sum_{i : C_i = \\text{\"A\"}} M_i$, $X_F = \\sum_{i : C_i = \\text{\"X\"}} F_i$, and $A_F = \\sum_{i : C_i = \\text{\"A\"}} F_i$ denote the total X-linked and autosomal expression in each sex. Your index must satisfy:\n- Scale normalization: It must compare X-linked expression relative to autosomal expression within each sex to remove global scaling, that is, it must depend on $X_M$, $A_M$, $X_F$, and $A_F$ only through within-sex X-to-autosome comparisons.\n- Invariance to global rescaling: If all male expression values are multiplied by a positive constant $s_M$ and all female expression values by a positive constant $s_F$, the index must remain unchanged.\n- Interpretability in fold-changes: If the male within-sex X-to-autosome comparison differs from the female by a multiplicative factor $k>0$, the index must change additively by a quantity proportional to $\\log_2 k$, so that $k=2$ corresponds to an increment of $+1$, $k=1/2$ to $-1$, and $k=1$ to $0$.\n- Sign convention: The index is $0$ if and only if the male and female within-sex comparisons are equal, is positive if the male within-sex comparison exceeds the female’s, and is negative in the opposite case.\n- Numerical stability: To handle cases where any of $X_M$, $A_M$, $X_F$, or $A_F$ may be $0$, use a small positive stabilizer $\\epsilon = 10^{-6}$ added to all numerators and denominators before forming any ratio.\n\nImplement a program that:\n1. From these principles, constructs a concrete, well-defined function of $X_M$, $A_M$, $X_F$, and $A_F$ satisfying all properties above.\n2. Applies it to each dataset in the test suite below.\n3. Outputs the results for all cases as a single line: a comma-separated list of the computed values, each rounded to $3$ decimal places, enclosed in square brackets.\n\nAll expression inputs are in Transcripts Per Million (TPM); there is no unit to report for the index. Use the base-$2$ logarithm when a logarithm is required by your derivation.\n\nTest suite (each case provides a tuple: male TPMs list, female TPMs list, chromosome labels list). Each list is aligned by index, and each number must be interpreted as TPM. The labels are \"X\" for X-linked genes and \"A\" for autosomal genes.\n- Case $1$ (compensated baseline; within-sex X-to-autosome balance is equal across sexes):\n  - Male TPMs: [$50$, $30$, $100$, $120$, $80$, $150$]\n  - Female TPMs: [$90$, $70$, $200$, $240$, $160$, $300$]\n  - Chromosomes: [\"X\", \"X\", \"A\", \"A\", \"A\", \"A\"]\n- Case $2$ (no dosage compensation; female X is approximately doubled relative to male with similar autosomal baselines):\n  - Male TPMs: [$50$, $30$, $100$, $120$, $80$, $150$]\n  - Female TPMs: [$100$, $60$, $100$, $120$, $80$, $150$]\n  - Chromosomes: [\"X\", \"X\", \"A\", \"A\", \"A\", \"A\"]\n- Case $3$ (male hypertranscription of X relative to female):\n  - Male TPMs: [$80$, $60$, $60$, $200$, $300$]\n  - Female TPMs: [$50$, $50$, $50$, $300$, $450$]\n  - Chromosomes: [\"X\", \"X\", \"X\", \"A\", \"A\"]\n- Case $4$ (global expression shift across sexes but preserved compensation; normalization should cancel the shift):\n  - Male TPMs: [$40$, $40$, $200$, $220$, $230$]\n  - Female TPMs: [$120$, $120$, $600$, $660$, $690$]\n  - Chromosomes: [\"X\", \"X\", \"A\", \"A\", \"A\"]\n- Case $5$ (edge case with near-absent male X expression for one gene):\n  - Male TPMs: [$0$, $5$, $100$, $100$, $100$]\n  - Female TPMs: [$10$, $10$, $150$, $150$, $150$]\n  - Chromosomes: [\"X\", \"X\", \"A\", \"A\", \"A\"]\n- Case $6$ (partial escape from inactivation; modest female excess of X relative to autosomes):\n  - Male TPMs: [$30$, $30$, $30$, $200$, $200$, $200$, $200$]\n  - Female TPMs: [$40$, $40$, $40$, $200$, $200$, $200$, $200$]\n  - Chromosomes: [\"X\", \"X\", \"X\", \"A\", \"A\", \"A\", \"A\"]\n\nFinal output format: Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (for example, [$v_1$,$v_2$,$v_3$,$v_4$,$v_5$,$v_6$]), where each $v_i$ is your computed index for case $i$, rounded to $3$ decimal places as base-$10$ decimals.", "solution": "We begin from first principles anchored in the chromosomal theory of inheritance and the Central Dogma. The copy number difference of the X chromosome between males and females creates a potential two-fold imbalance in X-linked gene dosage. Organisms often evolve regulatory mechanisms such as X-chromosome inactivation (XCI) or hypertranscription that act to equalize the effective X-linked gene expression between sexes. RNA sequencing (RNA-seq) provides quantitative estimates of gene expression, commonly normalized as Transcripts Per Million (TPM). However, overall sequencing depth and global transcriptional activity can vary between samples. Therefore, comparing X-linked expression relative to autosomal expression within each sex controls for global scaling factors not related to sex chromosome dosage.\n\nWe are asked to design an index that satisfies five key properties: scale normalization via within-sex X-to-autosome comparison, invariance to global rescaling, interpretability in fold-changes through additivity under multiplicative deviations, a sign convention with a zero point at equality, and numerical stability through addition of a small positive stabilizer $\\epsilon = 10^{-6}$ to prevent division by zero.\n\nLet $X_M = \\sum_{i : C_i = \\text{\"X\"}} M_i$ and $A_M = \\sum_{i : C_i = \\text{\"A\"}} M_i$ denote the male totals for X-linked and autosomal expression, respectively, and similarly $X_F$ and $A_F$ for female. Define the within-sex X-to-autosome normalized quantities\n$$\nR_M = \\frac{X_M + \\epsilon}{A_M + \\epsilon}, \\quad R_F = \\frac{X_F + \\epsilon}{A_F + \\epsilon},\n$$\nwith $\\epsilon = 10^{-6}$ added to both numerator and denominator for stability. This construction enforces scale normalization and removes the effect of global scaling: multiplying all male expressions by a positive constant $s_M$ multiplies both $X_M$ and $A_M$ by $s_M$, leaving $R_M$ unchanged (and likewise for $R_F$). Hence the index must be a function of the ratio $R_M / R_F$ to satisfy the invariance requirement and the sign convention with $0$ at equality.\n\nTo enforce interpretability in fold-changes such that multiplicative differences become additive and $2$-fold corresponds to $+1$, we require a function $g$ such that $g\\!\\left(k\\right)$ is additive in $k$ under multiplication and is measured in base-$2$ fold-change units. The standard and unique (up to a multiplicative constant) continuous function mapping multiplicative differences to additive differences is the logarithm. Choosing the base-$2$ logarithm sets the unit so that a factor of $2$ maps to $+1$, $1/2$ maps to $-1$, and equality ($1$) maps to $0$. Therefore, the only natural choice satisfying all constraints is\n$$\n\\mathrm{DCI} \\equiv \\log_2 \\left( \\frac{R_M}{R_F} \\right) \\;=\\; \\log_2 \\left( \\frac{X_M + \\epsilon}{A_M + \\epsilon} \\cdot \\frac{A_F + \\epsilon}{X_F + \\epsilon} \\right).\n$$\nThis Dosage Compensation Index (DCI) is dimensionless, equals $0$ if and only if the normalized X-to-autosome ratios are equal between sexes, is positive when the male normalized X level exceeds the female’s, and negative in the opposite case. The stabilizer $\\epsilon = 10^{-6}$ ensures numerical robustness in degenerate cases.\n\nWe now compute the DCI for each case, rounding to $3$ decimals.\n\n- Case $1$:\n  - Male: $X_M = 50 + 30 = 80$, $A_M = 100 + 120 + 80 + 150 = 450$, so $R_M = \\frac{80 + 10^{-6}}{450 + 10^{-6}} \\approx \\frac{80}{450} \\approx 0.177\\overline{7}$.\n  - Female: $X_F = 90 + 70 = 160$, $A_F = 200 + 240 + 160 + 300 = 900$, so $R_F = \\frac{160 + 10^{-6}}{900 + 10^{-6}} \\approx \\frac{160}{900} \\approx 0.177\\overline{7}$.\n  - Ratio: $\\frac{R_M}{R_F} \\approx 1$, hence $\\mathrm{DCI} \\approx \\log_2(1) = 0.000$.\n\n- Case $2$:\n  - Male: $X_M = 80$, $A_M = 450$, $R_M \\approx \\frac{80}{450} \\approx 0.177\\overline{7}$.\n  - Female: $X_F = 100 + 60 = 160$, $A_F = 100 + 120 + 80 + 150 = 450$, $R_F \\approx \\frac{160}{450} \\approx 0.355\\overline{5}$.\n  - Ratio: $\\frac{R_M}{R_F} \\approx \\frac{80/450}{160/450} = \\frac{1}{2}$, so $\\mathrm{DCI} = \\log_2\\!\\left(\\frac{1}{2}\\right) = -1.000$.\n\n- Case $3$:\n  - Male: $X_M = 80 + 60 + 60 = 200$, $A_M = 200 + 300 = 500$, $R_M = \\frac{200}{500} = 0.4$.\n  - Female: $X_F = 50 + 50 + 50 = 150$, $A_F = 300 + 450 = 750$, $R_F = \\frac{150}{750} = 0.2$.\n  - Ratio: $\\frac{R_M}{R_F} = \\frac{0.4}{0.2} = 2$, hence $\\mathrm{DCI} = \\log_2(2) = 1.000$.\n\n- Case $4$:\n  - Male: $X_M = 40 + 40 = 80$, $A_M = 200 + 220 + 230 = 650$, $R_M \\approx \\frac{80}{650} \\approx 0.1230769$.\n  - Female: $X_F = 120 + 120 = 240$, $A_F = 600 + 660 + 690 = 1950$, $R_F \\approx \\frac{240}{1950} \\approx 0.1230769$.\n  - Ratio: $\\frac{R_M}{R_F} \\approx 1$, so $\\mathrm{DCI} \\approx 0.000$.\n\n- Case $5$:\n  - Male: $X_M = 0 + 5 = 5$, $A_M = 100 + 100 + 100 = 300$, $R_M \\approx \\frac{5 + 10^{-6}}{300 + 10^{-6}} \\approx \\frac{5}{300} \\approx 0.016\\overline{6}$.\n  - Female: $X_F = 10 + 10 = 20$, $A_F = 150 + 150 + 150 = 450$, $R_F \\approx \\frac{20}{450} \\approx 0.044\\overline{4}$.\n  - Ratio: $\\frac{R_M}{R_F} \\approx \\frac{0.016\\overline{6}}{0.044\\overline{4}} = 0.375$, so $\\mathrm{DCI} = \\log_2(0.375) = \\log_2(3/8) = \\log_2(3) - 3 \\approx 1.58496 - 3 \\approx -1.41504$, which rounds to $-1.415$.\n\n- Case $6$:\n  - Male: $X_M = 30 + 30 + 30 = 90$, $A_M = 200 \\times 4 = 800$, $R_M = \\frac{90}{800} = 0.1125$.\n  - Female: $X_F = 40 + 40 + 40 = 120$, $A_F = 200 \\times 4 = 800$, $R_F = \\frac{120}{800} = 0.15$.\n  - Ratio: $\\frac{R_M}{R_F} = \\frac{0.1125}{0.15} = 0.75$, giving $\\mathrm{DCI} = \\log_2(0.75) \\approx -0.415037$, rounded to $-0.415$.\n\nThus, after rounding each to $3$ decimals, the expected outputs in order are:\n- Case $1$: $0.000$\n- Case $2$: $-1.000$\n- Case $3$: $1.000$\n- Case $4$: $0.000$\n- Case $5$: $-1.415$\n- Case $6$: $-0.415$\n\nThe program computes $X_M$, $A_M$, $X_F$, and $A_F$ by summation using the provided chromosome labels, forms $R_M$ and $R_F$ with $\\epsilon = 10^{-6}$, computes $\\mathrm{DCI} = \\log_2\\!\\left(R_M/R_F\\right)$, rounds to $3$ decimals, and prints the list in the required format.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef compute_dci(male_tpm, female_tpm, chrom_labels, eps=1e-6):\n    \"\"\"\n    Compute the Dosage Compensation Index (DCI) for one dataset.\n    DCI = log2( ( (X_M + eps)/(A_M + eps) ) / ( (X_F + eps)/(A_F + eps) ) )\n    where X_* and A_* are sums of TPMs over X-linked and autosomal genes.\n    \"\"\"\n    male_tpm = np.asarray(male_tpm, dtype=float)\n    female_tpm = np.asarray(female_tpm, dtype=float)\n    chrom_labels = np.asarray(chrom_labels)\n\n    x_mask = chrom_labels == \"X\"\n    a_mask = chrom_labels == \"A\"\n\n    XM = float(male_tpm[x_mask].sum())\n    AM = float(male_tpm[a_mask].sum())\n    XF = float(female_tpm[x_mask].sum())\n    AF = float(female_tpm[a_mask].sum())\n\n    RM = (XM + eps) / (AM + eps)\n    RF = (XF + eps) / (AF + eps)\n\n    dci = np.log2(RM / RF)\n    return dci\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1\n        (\n            [50, 30, 100, 120, 80, 150],\n            [90, 70, 200, 240, 160, 300],\n            [\"X\", \"X\", \"A\", \"A\", \"A\", \"A\"],\n        ),\n        # Case 2\n        (\n            [50, 30, 100, 120, 80, 150],\n            [100, 60, 100, 120, 80, 150],\n            [\"X\", \"X\", \"A\", \"A\", \"A\", \"A\"],\n        ),\n        # Case 3\n        (\n            [80, 60, 60, 200, 300],\n            [50, 50, 50, 300, 450],\n            [\"X\", \"X\", \"X\", \"A\", \"A\"],\n        ),\n        # Case 4\n        (\n            [40, 40, 200, 220, 230],\n            [120, 120, 600, 660, 690],\n            [\"X\", \"X\", \"A\", \"A\", \"A\"],\n        ),\n        # Case 5\n        (\n            [0, 5, 100, 100, 100],\n            [10, 10, 150, 150, 150],\n            [\"X\", \"X\", \"A\", \"A\", \"A\"],\n        ),\n        # Case 6\n        (\n            [30, 30, 30, 200, 200, 200, 200],\n            [40, 40, 40, 200, 200, 200, 200],\n            [\"X\", \"X\", \"X\", \"A\", \"A\", \"A\", \"A\"],\n        ),\n    ]\n\n    results = []\n    for male_tpm, female_tpm, chrom_labels in test_cases:\n        dci = compute_dci(male_tpm, female_tpm, chrom_labels, eps=1e-6)\n        results.append(dci)\n\n    # Final print statement in the exact required format, rounded to 3 decimals.\n    print(f\"[{','.join(f'{v:.3f}' for v in results)}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "2965681"}]}