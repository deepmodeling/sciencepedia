{"hands_on_practices": [{"introduction": "Position Weight Matrices (PWMs) are a cornerstone of bioinformatics, but their physical meaning can seem abstract. This exercise builds a crucial bridge between the statistical description of a binding site and its underlying thermodynamics. By applying principles of statistical mechanics, you will derive the direct, linear relationship between the log-odds score of a PWM and the binding free energy of a transcription factor to DNA, illuminating how PWMs serve as a powerful proxy for physical interactions [@problem_id:2966795].", "problem": "A transcription factor recognizes DNA through an additive binding-energy model in which the binding energy of a site of length $L$ with sequence $s = (s_{1},\\dots,s_{L})$ is $E(s) = \\sum_{i=1}^{L} \\varepsilon_{i}(s_{i}) + E_{0}$, where $\\varepsilon_{i}(b)$ is the contribution of base $b$ at position $i$ and $E_{0}$ is a sequence-independent offset. At thermodynamic equilibrium at absolute temperature $T$, the probability of observing a sequence $s$ in the bound ensemble, relative to its background occurrence probability $q(s)$, is proportional to the Boltzmann factor of its energy, consistent with the well-tested statistical thermodynamic model for macromolecular binding: $P(\\text{bound}\\,|\\,s) \\propto \\exp(-\\beta E(s))$ with $\\beta = 1/(k_{B} T)$, where $k_{B}$ is the Boltzmann constant. Assume a background model in which bases are independent across positions with marginals $q(b)$, and that the bound ensemble also factorizes across positions due to the additivity of $E(s)$.\n\nDefine the position weight matrix (PWM) log-odds score in base $b$ for a sequence $s$ by\n$$\nS(s) \\equiv \\sum_{i=1}^{L} \\log_{b}\\!\\left(\\frac{p_{i}(s_{i})}{q(s_{i})}\\right),\n$$\nwhere $p_{i}(x)$ is the marginal frequency of base $x$ at position $i$ in the bound ensemble and $q(x)$ is the background base frequency. Using only the statistical thermodynamic assumptions above and the definitions of $S(s)$ and $E(s)$, derive the linear relationship between the binding energy difference $\\Delta E(s) \\equiv E(s) - E_{\\star}$ and the PWM score $S(s)$, and obtain the coefficient $\\alpha$ in the form $\\Delta E(s) = -\\alpha\\, S(s) + \\text{const}$ in terms of $k_{B}$, $T$, and the PWM logarithm base $b$.\n\nThen, briefly outline a principled experimental or computational strategy to fit $\\alpha$ from data consisting of either equilibrium occupancies $P(\\text{bound}\\,|\\,s)$ across sequences or independently measured binding free energies $\\Delta E(s)$ across sequences.\n\nProvide your final answer as a single closed-form analytical expression for $\\alpha$ in terms of $k_{B}$, $T$, and $b$. Express the unit for $\\alpha$ in Joules, but do not substitute numerical values.", "solution": "The problem requires the derivation of a linear relationship between the binding energy of a transcription factor to a DNA sequence and the corresponding position weight matrix (PWM) score for that sequence. We begin by validating the problem statement.\n\nThe givens are:\n1.  An additive binding energy model: $E(s) = \\sum_{i=1}^{L} \\varepsilon_{i}(s_{i}) + E_{0}$ for a sequence $s = (s_{1},\\dots,s_{L})$.\n2.  The probability of a sequence $s$ being observed in the bound ensemble, relative to its background occurrence $q(s)$, is proportional to its Boltzmann factor: $P(\\text{bound}\\,|\\,s) \\propto \\exp(-\\beta E(s))$, with $\\beta = 1/(k_{B} T)$.\n3.  The background probability distribution for sequences factorizes: $q(s) = \\prod_{i=1}^{L} q(s_{i})$, where $q(s_i)$ is the marginal frequency of base $s_i$. The problem text \"marginals $q(b)$\" implies $q(s_i)$ is independent of position $i$, which we write as $q(s_i)=q(b)$ for $s_i=b$. We will maintain the more general notation $q(s_i)$ for correctness, as it does not alter the derivation.\n4.  The probability distribution of sequences in the bound ensemble also factorizes: $p(s) = \\prod_{i=1}^{L} p_{i}(s_{i})$.\n5.  The PWM log-odds score is defined as $S(s) \\equiv \\sum_{i=1}^{L} \\log_{b}\\!\\left(\\frac{p_{i}(s_{i})}{q(s_{i})}\\right)$.\n6.  The objective is to find the coefficient $\\alpha$ in the derived relationship $\\Delta E(s) = -\\alpha\\, S(s) + \\text{const}$, where $\\Delta E(s) \\equiv E(s) - E_{\\star}$.\n\nThe problem is scientifically grounded in the principles of statistical mechanics applied to molecular binding, a standard and well-validated approach in biophysics. It is well-posed, providing sufficient and consistent information for a unique solution. The language is objective and precise. The problem is therefore deemed valid.\n\nWe proceed to the derivation. The probability of finding sequence $s$ in the bound ensemble, $p(s)$, is related to its background probability, $q(s)$, and its binding energy, $E(s)$, through the principles of statistical thermodynamics. The enrichment of a sequence in the bound population relative to the background is given by its Boltzmann weight. This can be stated formally as:\n$$\n\\frac{p(s)}{q(s)} = \\frac{\\exp(-\\beta E(s))}{Z}\n$$\nwhere $Z = \\sum_{s'} \\exp(-\\beta E(s')) q(s')$ is the partition function over all possible sequences, which serves as a normalization constant. For a given system at equilibrium, $Z$ is a constant.\n\nWe now substitute the expressions for $p(s)$, $q(s)$, and $E(s)$ based on the additivity and factorization assumptions provided in the problem statement.\n$$\n\\frac{\\prod_{i=1}^{L} p_{i}(s_{i})}{\\prod_{i=1}^{L} q(s_{i})} = \\frac{1}{Z} \\exp\\left(-\\beta \\left(\\sum_{j=1}^{L} \\varepsilon_{j}(s_{j}) + E_{0}\\right)\\right)\n$$\nThis can be rewritten by separating the products and sums:\n$$\n\\prod_{i=1}^{L} \\left(\\frac{p_{i}(s_{i})}{q(s_{i})}\\right) = \\frac{\\exp(-\\beta E_{0})}{Z} \\prod_{i=1}^{L} \\exp(-\\beta \\varepsilon_{i}(s_{i}))\n$$\nThis equation must hold true for any sequence $s$. The structure of the equation, where both sides are products over the positions $i=1, \\dots, L$, implies that the relationship must hold on a per-position basis. That is, for each position $i$ and for any base $b \\in \\{A, C, G, T\\}$, there must exist position-specific constants $C_i$ such that:\n$$\n\\frac{p_{i}(b)}{q(b)} = C_{i} \\exp(-\\beta \\varepsilon_{i}(b))\n$$\nThe product of these constants must satisfy $\\prod_{i=1}^{L} C_{i} = \\exp(-\\beta E_0)/Z$. Taking the natural logarithm of the per-position relationship yields:\n$$\n\\ln\\left(\\frac{p_{i}(b)}{q(b)}\\right) = \\ln(C_{i}) - \\beta \\varepsilon_{i}(b)\n$$\nNow, we relate this to the PWM score $S(s)$. The definition is given in terms of a general base-$b$ logarithm. We use the change of base formula, $\\log_{b}(x) = \\frac{\\ln(x)}{\\ln(b)}$, to express $S(s)$ using natural logarithms:\n$$\nS(s) = \\sum_{i=1}^{L} \\frac{\\ln\\left(\\frac{p_{i}(s_{i})}{q(s_{i})}\\right)}{\\ln(b)} = \\frac{1}{\\ln(b)} \\sum_{i=1}^{L} \\ln\\left(\\frac{p_{i}(s_{i})}{q(s_{i})}\\right)\n$$\nSubstituting our derived expression for the log-ratio:\n$$\nS(s) = \\frac{1}{\\ln(b)} \\sum_{i=1}^{L} (\\ln(C_{i}) - \\beta \\varepsilon_{i}(s_{i}))\n$$\n$$\nS(s) = \\frac{1}{\\ln(b)} \\left( \\left(\\sum_{i=1}^{L} \\ln(C_{i})\\right) - \\beta \\sum_{i=1}^{L} \\varepsilon_{i}(s_{i}) \\right)\n$$\nThe total binding energy is $E(s) = \\sum_{i=1}^{L} \\varepsilon_{i}(s_{i}) + E_{0}$, which implies $\\sum_{i=1}^{L} \\varepsilon_{i}(s_{i}) = E(s) - E_{0}$. Substituting this into the equation for $S(s)$:\n$$\nS(s) = \\frac{1}{\\ln(b)} \\left( \\left(\\sum_{i=1}^{L} \\ln(C_{i})\\right) - \\beta (E(s) - E_{0}) \\right)\n$$\n$$\nS(s) = -\\frac{\\beta}{\\ln(b)} E(s) + \\frac{1}{\\ln(b)} \\left( \\beta E_{0} + \\sum_{i=1}^{L} \\ln(C_{i}) \\right)\n$$\nThis is a linear equation relating $S(s)$ and $E(s)$. We are asked to find the relationship for $\\Delta E(s)$ in the form $\\Delta E(s) = -\\alpha S(s) + \\text{const}$. First, we solve for $E(s)$:\n$$\n\\frac{\\beta}{\\ln(b)} E(s) = -S(s) + \\frac{1}{\\ln(b)} \\left( \\beta E_{0} + \\sum_{i=1}^{L} \\ln(C_{i}) \\right)\n$$\n$$\nE(s) = -\\frac{\\ln(b)}{\\beta} S(s) + \\frac{1}{\\beta} \\left( \\beta E_{0} + \\sum_{i=1}^{L} \\ln(C_{i}) \\right)\n$$\nSubstituting $\\beta = 1/(k_{B}T)$:\n$$\nE(s) = - (k_{B} T \\ln(b)) S(s) + \\left( E_{0} + k_{B} T \\sum_{i=1}^{L} \\ln(C_{i}) \\right)\n$$\nThe term in the last parenthesis is a constant that does not depend on the sequence $s$. Let us call it $K$.\n$$\nE(s) = - (k_{B} T \\ln(b)) S(s) + K\n$$\nThe binding energy difference is defined as $\\Delta E(s) = E(s) - E_{\\star}$, where $E_{\\star}$ is a constant reference energy.\n$$\n\\Delta E(s) = \\left(- (k_{B} T \\ln(b)) S(s) + K\\right) - E_{\\star}\n$$\n$$\n\\Delta E(s) = - (k_{B} T \\ln(b)) S(s) + (K - E_{\\star})\n$$\nThis is of the form $\\Delta E(s) = -\\alpha S(s) + \\text{const}$, where the constant is $(K - E_{\\star})$. The coefficient $\\alpha$ is:\n$$\n\\alpha = k_{B} T \\ln(b)\n$$\nThe units of this coefficient are Joules, as $k_{B}$ is in Joules/Kelvin, $T$ is in Kelvin, and $\\ln(b)$ is dimensionless.\n\nFor the second part of the problem, a strategy to fit $\\alpha$ from data is required. The derived relationship $\\Delta E(s) = -\\alpha S(s) + \\text{const}$ is a linear equation. Therefore, $\\alpha$ can be determined as the negative of the slope of a plot of $\\Delta E(s)$ versus $S(s)$. A principled strategy is as follows:\n1.  **Data Acquisition**: Perform a high-throughput sequencing-based binding assay, such as SELEX-seq or ChIP-seq. This experiment yields two essential datasets for a large number of DNA sequences $\\{s_j\\}$: (a) the sequences of DNA fragments specifically bound by the transcription factor, and (b) a quantitative measure of binding affinity for each sequence (e.g., enrichment ratio, which is convertible to a relative binding energy $\\Delta E(s_j)$).\n2.  **Parameter Estimation**:\n    a.  From the set of bound sequences, construct the position frequency matrix $p_{i}(b)$ by aligning the sequences and counting the frequency of each base at each position $i$. The background frequencies $q(b)$ are estimated from the initial sequence library or the relevant genomic background.\n    b.  For each sequence $s_j$ for which a binding measurement is available, calculate its PWM score using the estimated matrices: $S(s_j) = \\sum_{i=1}^{L} \\log_{b}(p_{i}(s_{j,i})/q(s_{j,i}))$.\n    c.  For each sequence $s_j$, convert its measured quantitative binding affinity into a relative binding free energy, which serves as $\\Delta E(s_j)$. For example, if using equilibrium occupancies, relative energies can be derived from the dissociation constants calculated from the Langmuir isotherm.\n3.  **Linear Regression**: Plot the calculated $\\Delta E(s_j)$ values against their corresponding $S(s_j)$ scores. Perform a linear regression on these data points. The slope of the best-fit line will be an experimental estimate of $-\\alpha$. Thus, the value of $\\alpha$ is determined by taking the negative of the fitted slope.\n\nThis procedure provides an empirical value for $\\alpha$, which can be compared to the theoretical value $k_B T \\ln(b)$ to validate the underlying thermodynamic model.", "answer": "$$\n\\boxed{k_{B} T \\ln(b)}\n$$", "id": "2966795"}, {"introduction": "In eukaryotic cells, gene regulation is rarely the result of a single transcription factor acting in isolation; rather, it emerges from the cooperative or competitive interactions of multiple proteins. This practice introduces a foundational method from statistical physics—the grand-canonical partition function—to quantitatively model such cooperative binding at an enhancer with multiple sites. Working through this problem will equip you with the tools to analyze how protein-protein interactions give rise to the complex, switch-like behaviors that define genetic regulatory circuits [@problem_id:2966850].", "problem": "An enhancer in a eukaryotic genome contains $2$ identical E-box motifs that are recognized by a transcription factor (TF) via its basic helix–loop–helix DNA-binding domain. Each E-box can bind at most one TF molecule. The binding energy for a single TF to an E-box is $\\epsilon_{b}$ (with $\\epsilon_{b} < 0$ indicating favorable binding). When both E-boxes are occupied simultaneously, there is an additional pairwise interaction energy $\\epsilon_{\\text{int}}$ between the bound TF molecules (with $\\epsilon_{\\text{int}} < 0$ indicating positive cooperativity). The system is at thermal equilibrium at temperature $T$, and the TF is present in solution at molar concentration $c$. Assume an ideal dilute solution so that the chemical potential is $\\mu = \\mu^{0} + k_{B} T \\ln\\!\\left(\\frac{c}{c_{0}}\\right)$, where $c_{0}$ is a standard reference concentration, $k_{B}$ is the Boltzmann constant, and define $\\beta \\equiv \\frac{1}{k_{B} T}$.\n\nUsing a partition function approach in the grand-canonical ensemble, compute the fractional occupancy of the enhancer, defined as the probability that at least one E-box is occupied. Express your final result as a closed-form symbolic expression in terms of $c$, $c_{0}$, $\\beta$, $\\epsilon_{b}$, and $\\epsilon_{\\text{int}}$. Do not introduce any additional parameters. The final answer must be a single analytic expression with no units.", "solution": "The problem is subjected to validation before a solution is attempted.\n\nStep 1: Extract Givens\n- System: An enhancer in a eukaryotic genome.\n- Binding sites: $2$ identical E-box motifs.\n- Ligand: A transcription factor (TF).\n- Binding domain: basic helix–loop–helix.\n- Stoichiometry: Each E-box can bind at most one TF molecule.\n- Binding energy: $\\epsilon_{b}$ for a single TF binding, with $\\epsilon_{b} < 0$.\n- Interaction energy: $\\epsilon_{\\text{int}}$ for pairwise interaction between two simultaneously bound TFs, with $\\epsilon_{\\text{int}} < 0$.\n- Thermodynamic conditions: Thermal equilibrium at temperature $T$.\n- TF concentration: Molar concentration $c$.\n- Solution properties: Assumed to be an ideal dilute solution.\n- Chemical potential of TF: $\\mu = \\mu^{0} + k_{B} T \\ln\\!\\left(\\frac{c}{c_{0}}\\right)$.\n- Constants and definitions: $c_{0}$ is a standard reference concentration, $k_{B}$ is the Boltzmann constant, and $\\beta \\equiv \\frac{1}{k_{B} T}$.\n- Objective: Compute the fractional occupancy of the enhancer, defined as the probability that at least one E-box is occupied.\n- Method: Use a partition function approach in the grand-canonical ensemble.\n- Output format: A closed-form symbolic expression in terms of $c$, $c_{0}$, $\\beta$, $\\epsilon_{b}$, and $\\epsilon_{\\text{int}}$.\n\nStep 2: Validate Using Extracted Givens\nThe problem describes a classic model of cooperative ligand binding to a macromolecule with two identical sites, which is a standard problem in statistical biophysics.\n\n- **Scientific Grounding**: The model is scientifically sound, resting on the fundamental principles of statistical mechanics (the grand-canonical ensemble) and its application to molecular binding events. The concepts of binding energy, cooperativity, chemical potential, and partition functions are central to this field.\n- **Well-Posedness**: The problem is well-posed. It provides all necessary information and clear definitions to calculate a unique, meaningful physical quantity (fractional occupancy). The objective is explicit.\n- **Objectivity**: The problem is stated in precise, objective language.\n- **Ambiguity Analysis**: There is a potential ambiguity in the definition of \"binding energy\" $\\epsilon_{b}$. In statistical mechanics, the energy of a bound state, $\\epsilon_{b}$, must be considered relative to the chemical potential of the particle in the reservoir, $\\mu$. The chemical potential expression itself includes a reference potential $\\mu^0$. A rigorous solution requires clarifying the reference state for $\\epsilon_b$. The standard and only logical interpretation in this context is that $\\epsilon_{b}$ represents the binding free energy at standard conditions, i.e., the energy change when a TF is moved from the solution at standard concentration $c_0$ (where its chemical potential is $\\mu^0$) to a binding site on the DNA. Thus, $\\epsilon_b \\equiv E_{\\text{bound}} - \\mu^0$. With this standard convention, the problem is self-contained and solvable as stated, as the unspecified $\\mu^0$ term is absorbed into the definition of $\\epsilon_b$.\n\nStep 3: Verdict and Action\nThe problem is deemed **valid** under the standard interpretation of binding energy in this context. A complete solution will now be provided.\n\nThe system is the enhancer with two binding sites, which is in contact with a reservoir of TF molecules at a fixed temperature $T$ and chemical potential $\\mu$. We use the grand-canonical ensemble to describe this system. The state of the system is defined by the number of TF molecules bound to the enhancer. Let $\\sigma_i = 1$ if site $i$ is occupied and $\\sigma_i = 0$ if it is empty, for $i \\in \\{1, 2\\}$.\n\nThe system has four possible microstates:\n1.  **State (0,0)**: Both sites are empty. The number of bound TFs is $N=0$. The energy of this state is taken as the reference energy, $E_{0,0} = 0$.\n2.  **State (1,0) and (0,1)**: One site is occupied. The number of bound TFs is $N=1$. Since the sites are identical, these two states are degenerate. The energy for binding a single TF is $\\epsilon_b$, so the energy of these states is $E_{1,0} = E_{0,1} = \\epsilon_b$.\n3.  **State (1,1)**: Both sites are occupied. The number of bound TFs is $N=2$. The total energy includes the binding energy for two TFs and the interaction energy between them: $E_{1,1} = 2\\epsilon_b + \\epsilon_{\\text{int}}$.\n\nThe grand-canonical partition function, $\\mathcal{Z}$, is the sum of the Boltzmann factors for each state, $\\exp[-\\beta(E - N\\mu)]$, where $E$ is the energy of the state and $N$ is the number of particles in that state.\n$$\n\\mathcal{Z} = \\sum_{\\text{states}} \\exp[-\\beta(E_{\\text{state}} - N_{\\text{state}}\\mu)]\n$$\n\nLet us calculate the term for each state:\n- For the state (0,0): $N=0$, $E=0$. The term is $\\exp[-\\beta(0 - 0 \\cdot \\mu)] = 1$.\n- For the two states with $N=1$: $E=\\epsilon_b$. The contribution from these two states is $2 \\times \\exp[-\\beta(\\epsilon_b - \\mu)]$.\n- For the state (1,1): $N=2$, $E=2\\epsilon_b + \\epsilon_{\\text{int}}$. The term is $\\exp[-\\beta(2\\epsilon_b + \\epsilon_{\\text{int}} - 2\\mu)]$.\n\nSumming these terms gives the partition function:\n$$\n\\mathcal{Z} = 1 + 2\\exp[-\\beta(\\epsilon_b - \\mu)] + \\exp[-\\beta(2\\epsilon_b + \\epsilon_{\\text{int}} - 2\\mu)]\n$$\nWe can rewrite the exponentials:\n$$\n\\mathcal{Z} = 1 + 2\\exp(\\beta\\mu)\\exp(-\\beta\\epsilon_b) + \\exp(2\\beta\\mu)\\exp[-\\beta(2\\epsilon_b + \\epsilon_{\\text{int}})]\n$$\nThe chemical potential is given as $\\mu = \\mu^0 + k_B T \\ln(c/c_0)$. Using $\\beta = 1/(k_B T)$, we have $\\beta\\mu = \\beta\\mu^0 + \\ln(c/c_0)$.\nThe fugacity term $\\exp(\\beta\\mu)$ is therefore $\\exp(\\beta\\mu^0 + \\ln(c/c_0)) = (c/c_0)\\exp(\\beta\\mu^0)$.\n\nAs established during validation, the binding energy $\\epsilon_b$ is interpreted as the free energy of binding relative to the standard state, i.e., it already incorporates $-\\mu^0$. The relevant energy change for binding one particle from the solution is $\\Delta G_{bind} = \\epsilon_b - k_B T \\ln(c/c_0)$. The Boltzmann factor for binding one TF is $\\exp(-\\beta \\Delta G_{bind}) = \\exp[-\\beta(\\epsilon_b - k_B T \\ln(c/c_0))] = \\exp(-\\beta\\epsilon_b)\\exp[\\ln(c/c_0)] = \\frac{c}{c_0}\\exp(-\\beta\\epsilon_b)$.\n\nLet us define a statistical weight for single occupancy relative to the empty state:\n$$\nw_1 = \\frac{c}{c_0}\\exp(-\\beta\\epsilon_b)\n$$\nThe statistical weight for double occupancy can be expressed similarly. The energy change for binding two particles is $\\Delta G_{bind,2} = (2\\epsilon_b + \\epsilon_{\\text{int}}) - 2 k_B T \\ln(c/c_0)$. The Boltzmann factor is:\n$$\nw_2 = \\exp[-\\beta(\\Delta G_{bind,2})] = \\exp[-\\beta(2\\epsilon_b + \\epsilon_{\\text{int}})]\\exp[2\\ln(c/c_0)] = \\left(\\frac{c}{c_0}\\right)^2 \\exp(-2\\beta\\epsilon_b) \\exp(-\\beta\\epsilon_{\\text{int}})\n$$\nThis can be written in terms of $w_1$ as:\n$$\nw_2 = \\left(\\frac{c}{c_0}\\exp(-\\beta\\epsilon_b)\\right)^2 \\exp(-\\beta\\epsilon_{\\text{int}}) = (w_1)^2 \\exp(-\\beta\\epsilon_{\\text{int}})\n$$\nThe partition function, summing over macrostates (defined by the number of bound TFs), is:\n$$\n\\mathcal{Z} = W_0 + W_1 + W_2\n$$\nwhere $W_0=1$ (for $N=0$), $W_1=2 w_1$ (for $N=1$, accounting for two sites), and $W_2=w_2$ (for $N=2$).\n$$\n\\mathcal{Z} = 1 + 2\\frac{c}{c_0}\\exp(-\\beta\\epsilon_b) + \\left(\\frac{c}{c_0}\\right)^2 \\exp(-2\\beta\\epsilon_b)\\exp(-\\beta\\epsilon_{\\text{int}})\n$$\nThe fractional occupancy, $P_{\\text{occ}}$, is the probability that at least one site is occupied. This is the sum of the probabilities of having one TF bound and two TFs bound.\n$$\nP_{\\text{occ}} = P(N=1) + P(N=2) = \\frac{W_1}{\\mathcal{Z}} + \\frac{W_2}{\\mathcal{Z}} = \\frac{W_1+W_2}{\\mathcal{Z}}\n$$\nAlternatively, $P_{\\text{occ}} = 1 - P(N=0) = 1 - \\frac{W_0}{\\mathcal{Z}} = 1 - \\frac{1}{\\mathcal{Z}} = \\frac{\\mathcal{Z}-1}{\\mathcal{Z}}$. Both expressions are equivalent.\nSubstituting the expressions for $W_1$ and $W_2$ into the numerator and $\\mathcal{Z}$ into the denominator, we obtain the final expression for the fractional occupancy:\n$$\nP_{\\text{occ}} = \\frac{2\\frac{c}{c_0}\\exp(-\\beta\\epsilon_b) + \\left(\\frac{c}{c_0}\\right)^2 \\exp(-2\\beta\\epsilon_b)\\exp(-\\beta\\epsilon_{\\text{int}})}{1 + 2\\frac{c}{c_0}\\exp(-\\beta\\epsilon_b) + \\left(\\frac{c}{c_0}\\right)^2 \\exp(-2\\beta\\epsilon_b)\\exp(-\\beta\\epsilon_{\\text{int}})}\n$$\nThis expression is in terms of the specified parameters $c$, $c_{0}$, $\\beta$, $\\epsilon_{b}$, and $\\epsilon_{\\text{int}}$.", "answer": "$$\n\\boxed{\\frac{2\\frac{c}{c_0}\\exp(-\\beta\\epsilon_b) + \\left(\\frac{c}{c_0}\\right)^2 \\exp(-2\\beta\\epsilon_b)\\exp(-\\beta\\epsilon_{\\text{int}})}{1 + 2\\frac{c}{c_0}\\exp(-\\beta\\epsilon_b) + \\left(\\frac{c}{c_0}\\right)^2 \\exp(-2\\beta\\epsilon_b)\\exp(-\\beta\\epsilon_{\\text{int}})}}\n$$", "id": "2966850"}, {"introduction": "The ability to engineer proteins that bind to specific DNA sequences is a central goal of synthetic biology, with profound implications for research and medicine. This exercise provides a hands-on experience in this process, guiding you from the rational design of a Cys2His2 zinc-finger protein using a recognition code to a quantitative prediction of its genome-wide specificity. By calculating the expected number of off-target sites, you will confront the critical challenge of ensuring specificity, a key hurdle in translating synthetic transcription factors into reliable tools [@problem_id:2966823].", "problem": "You are engineering a three-finger Cys2His2 (C2H2) zinc-finger transcription factor to bind a specified double-stranded deoxyribonucleic acid (DNA) target and wish to estimate the expected number of above-threshold off-target matches in a large genome using a Position Weight Matrix (PWM) scan.\n\nTarget and design assumptions:\n- The target site is the 9-base-pair (bp) sequence $5'$-GCGTATGGC-$3'$ on the forward strand, to be recognized by three tandem C2H2 fingers, each finger contacting one 3-bp subsite in the $5' \\rightarrow 3'$ direction: finger 1 for $5'$-GCG-$3'$, finger 2 for $5'$-TAT-$3'$, and finger 3 for $5'$-GGC-$3'$.\n- Use the simplified canonical three-contact recognition code for C2H2 zinc fingers: for each 3-bp subsite $5'$-$B_{1}B_{2}B_{3}$-$3'$, the alpha-helix residues at positions $6$, $3$, and $-1$ primarily contact $B_{1}$, $B_{2}$, and $B_{3}$, respectively. Choose residues to favor bases as follows: A $\\rightarrow$ Asn (N), C $\\rightarrow$ Asp (D), G $\\rightarrow$ Arg (R), T $\\rightarrow$ Ser (S). Ignore context effects and inter-finger coupling.\n- Translate the design into a PWM by assigning, for each position $i \\in \\{1,\\dots,9\\}$, a consensus base probability $p_{i}(b^{*})=0.7$ for the designed base $b^{*}$ at that position, and $p_{i}(b)=0.1$ for each non-consensus base $b \\neq b^{*}$. Assume independence between positions.\n\nScanning and scoring assumptions:\n- The background base frequencies are uniform: $q(\\mathrm{A})=q(\\mathrm{C})=q(\\mathrm{G})=q(\\mathrm{T})=\\frac{1}{4}$.\n- The PWM log-odds score for a 9-mer $x_{1:9}$ is $S(x_{1:9})=\\sum_{i=1}^{9} \\log_{2}\\!\\left(\\frac{p_{i}(x_{i})}{q(x_{i})}\\right)$ (in bits).\n- A site is called a hit if $S(x_{1:9}) \\geq T$, with threshold $T=8.0$ bits.\n- You scan both strands of a genome of length $G=3.0 \\times 10^{9}$ bp using a sliding window of length $L=9$ with a stride of $1$, so the total number of windows evaluated is $N_{\\text{win}}=2\\,(G-L+1)$.\n\nTasks:\n1. Specify the key helix residues at positions $6$, $3$, and $-1$ for each finger that would be selected by the above recognition code to favor the target $5'$-GCGTATGGC-$3'$.\n2. Using only the PWM and scoring assumptions above, derive from first principles the expected number of above-threshold hits when scanning the genome, expressing the expectation in terms of $N_{\\text{win}}$ and the probability that a random 9-mer drawn from the background has $S \\geq T$.\n3. Compute the final expected number as a real number and round to three significant figures. Provide your final answer as a dimensionless count (no units) and do not include a percentage sign or any angle units.", "solution": "We begin from core definitions for sequence-specific DNA recognition and statistical motif scanning.\n\nDesign step using the simplified recognition code:\n- The target is $5'$-G C G T A T G G C-$3'$.\n- For each 3-bp subsite $5'$-$B_{1}B_{2}B_{3}$-$3'$, residues at helix positions $6$, $3$, and $-1$ are chosen to favor $B_{1}$, $B_{2}$, and $B_{3}$, respectively, using the mapping A $\\rightarrow$ Asn (N), C $\\rightarrow$ Asp (D), G $\\rightarrow$ Arg (R), T $\\rightarrow$ Ser (S).\n\nApply to each finger:\n- Finger 1 for $5'$-G C G-$3'$: position $6 \\rightarrow$ R (for G), position $3 \\rightarrow$ D (for C), position $-1 \\rightarrow$ R (for G).\n- Finger 2 for $5'$-T A T-$3'$: position $6 \\rightarrow$ S (for T), position $3 \\rightarrow$ N (for A), position $-1 \\rightarrow$ S (for T).\n- Finger 3 for $5'$-G G C-$3'$: position $6 \\rightarrow$ R (for G), position $3 \\rightarrow$ R (for G), position $-1 \\rightarrow$ D (for C).\n\nThus, the designed helix contact residues are:\n- Finger 1: $(6,3,-1) = (\\mathrm{R}, \\mathrm{D}, \\mathrm{R})$.\n- Finger 2: $(6,3,-1) = (\\mathrm{S}, \\mathrm{N}, \\mathrm{S})$.\n- Finger 3: $(6,3,-1) = (\\mathrm{R}, \\mathrm{R}, \\mathrm{D})$.\n\nPWM and scoring:\nBy construction, for each position $i \\in \\{1,\\dots,9\\}$,\n- Consensus base probability is $p_{i}(b^{*})=0.7$,\n- Non-consensus probabilities are $p_{i}(b)=0.1$ for $b \\neq b^{*}$,\nand the background is $q(b)=\\frac{1}{4}$ for all $b$.\n\nTherefore, the per-position log-odds contributions (in bits) are constants:\n- For a consensus base: $s_{c}=\\log_{2}\\!\\left(\\frac{0.7}{0.25}\\right)=\\log_{2}(2.8)$,\n- For a non-consensus base: $s_{m}=\\log_{2}\\!\\left(\\frac{0.1}{0.25}\\right)=\\log_{2}(0.4)$.\n\nLet $m$ be the number of mismatches (non-consensus bases) in a 9-mer relative to the designed consensus sequence. Because positions are independent and identically distributed under our PWM construction, the total score as a function of $m$ is\n$$\nS(m)=(9-m)\\,s_{c}+m\\,s_{m}\n=9\\,\\log_{2}(2.8)+m\\left[\\log_{2}(0.4)-\\log_{2}(2.8)\\right].\n$$\nDefine $\\Delta = s_{c}-s_{m}=\\log_{2}(2.8)-\\log_{2}(0.4)=\\log_{2}\\!\\left(\\frac{2.8}{0.4}\\right)=\\log_{2}(7)$, so $s_{m}-s_{c}=-\\Delta=-\\log_{2}(7)$. Numerically,\n$$\ns_{c}=\\log_{2}(2.8)\\approx 1.485426827,\\quad\ns_{m}=\\log_{2}(0.4)\\approx -1.321928095,\\quad\n\\Delta=\\log_{2}(7)\\approx 2.807354922.\n$$\nThus,\n$$\nS(m)=9\\,s_{c}-m\\,\\Delta \\approx 13.36884144 - 2.807354922\\,m.\n$$\n\nThresholding:\nWe require $S(m)\\geq T$ with $T=8.0$ bits. Solve for the largest integer $m$ satisfying\n$$\n13.36884144 - 2.807354922\\,m \\geq 8.0\n\\;\\;\\Longleftrightarrow\\;\\;\nm \\leq \\frac{13.36884144-8.0}{2.807354922}\\approx 1.912\\ldots\n$$\nHence, the permissible integers are $m=0$ or $m=1$. Therefore, any 9-mer with at most one mismatch relative to the consensus sequence will score at or above the threshold; any with $m\\geq 2$ will fall below threshold.\n\nProbability that a random 9-mer is above threshold:\nUnder the uniform background and independence, each 9-mer is equally likely with probability $4^{-9}$. The number of 9-mers within Hamming distance $m$ of the consensus sequence is $\\binom{9}{m}\\,3^{m}$ (choose $m$ positions to mismatch, and for each such position choose one of the $3$ non-consensus bases). Therefore,\n$$\n\\Pr\\{S \\geq T\\}\n=\\frac{1}{4^{9}}\\sum_{m=0}^{1}\\binom{9}{m}3^{m}\n=\\frac{1}{4^{9}}\\left[\\binom{9}{0}3^{0}+\\binom{9}{1}3^{1}\\right]\n=\\frac{1+27}{4^{9}}\n=\\frac{28}{4^{9}}.\n$$\nSince $4^{9}=262{,}144=2^{18}$, we can simplify $\\frac{28}{262{,}144}=\\frac{7}{65{,}536}$.\n\nExpected number of above-threshold hits:\nThe total number of windows scanned is $N_{\\text{win}}=2\\,(G-L+1)=2\\,(3.0\\times 10^{9}-9+1)=2\\,(3.0\\times 10^{9}-8)$. The expected count is\n$$\n\\mathbb{E}[\\text{hits}]=N_{\\text{win}} \\times \\Pr\\{S \\geq T\\}\n=2\\,(3.0\\times 10^{9}-8)\\times \\frac{7}{65{,}536}.\n$$\nFor numerical evaluation,\n$$\n2\\,(3.0\\times 10^{9}-8)=6.0\\times 10^{9}-16,\n$$\nso\n$$\n\\mathbb{E}[\\text{hits}]=\\frac{7\\,(6.0\\times 10^{9}-16)}{65{,}536}\n=\\frac{42\\times 10^{9}-112}{65{,}536}.\n$$\nCompute the value:\n$$\n\\frac{42\\times 10^{9}}{65{,}536}\\approx 640{,}869.140625,\\quad\n\\frac{112}{65{,}536}\\approx 0.001708984375,\n$$\nhence\n$$\n\\mathbb{E}[\\text{hits}]\\approx 640{,}869.140625-0.001708984375\n=640{,}869.138916015625.\n$$\n\nRounding to three significant figures yields $6.41\\times 10^{5}$.\n\nSummary:\n- Designed helix residues per finger: Finger 1 $(6,3,-1)=(\\mathrm{R},\\mathrm{D},\\mathrm{R})$, Finger 2 $(\\mathrm{S},\\mathrm{N},\\mathrm{S})$, Finger 3 $(\\mathrm{R},\\mathrm{R},\\mathrm{D})$.\n- Expected number of above-threshold hits in a $3.0\\times 10^{9}$ bp genome scanning both strands at $T=8.0$ bits: approximately $6.41\\times 10^{5}$ (dimensionless count), as required.", "answer": "$$\\boxed{6.41 \\times 10^{5}}$$", "id": "2966823"}]}