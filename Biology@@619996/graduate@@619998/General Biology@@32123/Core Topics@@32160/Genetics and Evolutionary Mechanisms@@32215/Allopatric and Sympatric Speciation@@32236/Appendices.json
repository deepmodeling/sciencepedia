{"hands_on_practices": [{"introduction": "Sympatric speciation, the origin of new species from a single ancestral population in the same geographic area, fundamentally requires a mechanism to split the population into distinct groups. Disruptive selection, where extreme phenotypes have higher fitness than intermediate ones, provides such a mechanism. This practice [@problem_id:2773926] offers a quantitative method to determine if selection is disruptive by calculating the overall fitness landscape experienced by a population across different microhabitats, a key first step in assessing the potential for sympatric divergence.", "problem": "A panmictic population occupies two microhabitats that together constitute the entire environment. Let the proportion of individuals experiencing habitat $1$ be $\\pi_{1}$ and that in habitat $2$ be $\\pi_{2}$, with $\\pi_{1} + \\pi_{2} = 1$. Viability selection acts within each habitat on a single biallelic locus with genotypes $\\mathrm{AA}$, $\\mathrm{Aa}$, and $\\mathrm{aa}$, yielding genotype-specific relative viabilities $w_{g,i}$ for genotype $g \\in \\{\\mathrm{AA}, \\mathrm{Aa}, \\mathrm{aa}\\}$ in habitat $i \\in \\{1,2\\}$. After viability selection, density regulation is soft in the sense that the contribution of each habitat to the global mating pool is proportional to its habitat proportion $\\pi_{i}$, and mating is random across the entire population. Assume discrete non-overlapping generations and that the fitness values are already scaled as relative viabilities within habitats.\n\nYou are given:\n- Habitat proportions: $\\pi_{1} = 0.45$ and $\\pi_{2} = 0.55$.\n- Genotype-specific viabilities in habitat $1$: $w_{\\mathrm{AA},1} = 1.00$, $w_{\\mathrm{Aa},1} = 0.30$, $w_{\\mathrm{aa},1} = 0.05$.\n- Genotype-specific viabilities in habitat $2$: $w_{\\mathrm{AA},2} = 0.05$, $w_{\\mathrm{Aa},2} = 0.32$, $w_{\\mathrm{aa},2} = 1.00$.\n\nUsing only the definitions of habitat-weighted mean fitness and disruptive selection as heterozygote disadvantage relative to the midpoint of homozygote fitnesses on the habitat-weighted landscape, compute the signed contrast $D$ between the habitat-weighted heterozygote mean fitness and the arithmetic midpoint of the two habitat-weighted homozygote mean fitnesses. Report $D$ as a pure number (no units), rounded to four significant figures. A negative value indicates disruptive selection that could fuel sympatric divergence under appropriate assortative mating, whereas a positive value indicates stabilizing selection around the intermediate genotype.", "solution": "The problem is first validated to ensure it is scientifically sound, well-posed, and complete.\n\n**Step 1: Extract Givens**\n- Population structure: Panmictic, with discrete non-overlapping generations.\n- Environment: Two microhabitats, indexed $i \\in \\{1,2\\}$.\n- Habitat proportions: $\\pi_{1} = 0.45$ and $\\pi_2 = 0.55$. It is given that $\\pi_{1} + \\pi_{2} = 1$, which is satisfied by the data.\n- Selection model: Soft selection, where viability selection occurs within habitats, followed by density regulation such that each habitat contributes proportionally to its size $\\pi_i$ to a common mating pool.\n- Genetic locus: A single biallelic locus with genotypes $\\mathrm{AA}$, $\\mathrm{Aa}$, and $\\mathrm{aa}$.\n- Genotype-specific relative viabilities in habitat $1$:\n  - $w_{\\mathrm{AA},1} = 1.00$\n  - $w_{\\mathrm{Aa},1} = 0.30$\n  - $w_{\\mathrm{aa},1} = 0.05$\n- Genotype-specific relative viabilities in habitat $2$:\n  - $w_{\\mathrm{AA},2} = 0.05$\n  - $w_{\\mathrm{Aa},2} = 0.32$\n  - $w_{\\mathrm{aa},2} = 1.00$\n- Task: Compute the signed contrast $D$, defined as the difference between the habitat-weighted heterozygote mean fitness and the arithmetic midpoint of the habitat-weighted homozygote mean fitnesses.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is a classic application of the Levene model of population genetics, which describes selection in a subdivided environment with a panmictic mating system. The concepts (viability, soft selection, habitat-weighted fitness) are standard and well-defined. All necessary numerical values are provided, and there are no internal contradictions. The problem is a direct calculation based on established biological and mathematical principles. It is therefore deemed scientifically grounded, well-posed, objective, and complete.\n\n**Step 3: Verdict and Action**\nThe problem is valid. A solution will be derived.\n\n**Solution Derivation**\nThe objective is to compute the signed contrast $D$. This requires first calculating the habitat-weighted mean fitness, $\\bar{W}_g$, for each genotype $g \\in \\{\\mathrm{AA}, \\mathrm{Aa}, \\mathrm{aa}\\}$. In a soft selection model, the overall fitness of a genotype across the entire environment is its average fitness, weighted by the proportion of each habitat. The formula for the habitat-weighted mean fitness of genotype $g$ is:\n$$\n\\bar{W}_{g} = \\sum_{i=1}^{2} \\pi_{i} w_{g,i} = \\pi_{1} w_{g,1} + \\pi_{2} w_{g,2}\n$$\n\nWe compute this value for each of the three genotypes using the provided data.\n\nFirst, for the genotype $\\mathrm{AA}$:\n$$\n\\bar{W}_{\\mathrm{AA}} = \\pi_{1} w_{\\mathrm{AA},1} + \\pi_{2} w_{\\mathrm{AA},2} = (0.45)(1.00) + (0.55)(0.05)\n$$\n$$\n\\bar{W}_{\\mathrm{AA}} = 0.45 + 0.0275 = 0.4775\n$$\n\nSecond, for the genotype $\\mathrm{aa}$:\n$$\n\\bar{W}_{\\mathrm{aa}} = \\pi_{1} w_{\\mathrm{aa},1} + \\pi_{2} w_{\\mathrm{aa},2} = (0.45)(0.05) + (0.55)(1.00)\n$$\n$$\n\\bar{W}_{\\mathrm{aa}} = 0.0225 + 0.55 = 0.5725\n$$\n\nThird, for the heterozygote genotype $\\mathrm{Aa}$:\n$$\n\\bar{W}_{\\mathrm{Aa}} = \\pi_{1} w_{\\mathrm{Aa},1} + \\pi_{2} w_{\\mathrm{Aa},2} = (0.45)(0.30) + (0.55)(0.32)\n$$\n$$\n\\bar{W}_{\\mathrm{Aa}} = 0.1350 + 0.1760 = 0.3110\n$$\n\nThe problem defines the signed contrast $D$ as the difference between the habitat-weighted fitness of the heterozygote and the arithmetic mean of the habitat-weighted fitnesses of the two homozygotes. This measures the nature of selection on the overall fitness landscape experienced by the panmictic population.\n$$\nD = \\bar{W}_{\\mathrm{Aa}} - \\frac{\\bar{W}_{\\mathrm{AA}} + \\bar{W}_{\\mathrm{aa}}}{2}\n$$\nA negative value of $D$ signifies that the heterozygote has a lower average fitness than the midpoint of the homozygotes, which corresponds to disruptive selection. A positive value would signify stabilizing selection (overall overdominance).\n\nWe now substitute the calculated values into the formula for $D$:\n$$\nD = 0.3110 - \\frac{0.4775 + 0.5725}{2}\n$$\nFirst, we compute the average fitness of the homozygotes:\n$$\n\\frac{0.4775 + 0.5725}{2} = \\frac{1.0500}{2} = 0.5250\n$$\nNow, we compute $D$:\n$$\nD = 0.3110 - 0.5250 = -0.2140\n$$\nThe value of $D$ is $-0.2140$. This negative sign indicates that on the habitat-weighted fitness landscape, the heterozygote $\\mathrm{Aa}$ has lower fitness than the average of the two homozygotes. This is a condition known as disruptive selection (or underdominance relative to the homozygote average), which can promote genetic divergence if mechanisms such as assortative mating are also present.\n\nThe problem requires the answer to be rounded to four significant figures. The calculated value is exactly $-0.2140$, which already has four significant figures.", "answer": "$$\n\\boxed{-0.2140}\n$$", "id": "2773926"}, {"introduction": "As populations diverge, whether in allopatry or sympatry, reproductive barriers often evolve as a byproduct of this divergence. This concept is formalized in the Dobzhansky-Muller model, which explains how negative epistatic interactions, or genetic incompatibilities, can arise between alleles that were neutral or beneficial on their own genetic backgrounds. This exercise [@problem_id:2773924] provides foundational practice in modeling the fitness consequences of such an incompatibility in hybrids, allowing you to derive the precise reduction in fitness that constitutes postzygotic isolation.", "problem": "Two populations, $P_A$ and $P_B$, diverged in allopatry and each fixed a different derived allele at a distinct locus, consistent with the Dobzhansky-Muller incompatibility (DMI) framework. At locus $A$, population $P_A$ is fixed for the derived allele $A_1$ and population $P_B$ remains ancestral $A_0$; at locus $B$, population $P_B$ is fixed for the derived allele $B_1$ and population $P_A$ remains ancestral $B_0$. Assume a simple multiplicative fitness model across loci, with the following properties:\n\n- Relative fitness is defined as expected reproductive success scaled to a baseline of $1$.\n- At each locus, the derived allele has a selection coefficient $s_i$ for the homozygote ($i \\in \\{1,2\\}$ for loci $A$ and $B$ respectively), so the genotype with two derived copies at locus $i$ contributes a multiplicative factor $(1 + s_i)$, the heterozygote contributes $(1 + h_i s_i)$ where $h_i \\in [0,1]$ is the dominance coefficient, and the ancestral homozygote contributes $1$.\n- When at least one copy of each derived allele ($A_1$ and $B_1$) co-occur in the same genome, there is an epistatic interaction that further multiplies fitness by $(1 + \\epsilon)$, where $\\epsilon < 0$ quantifies a deleterious interaction between the derived alleles. If the derived alleles do not co-occur, this epistatic factor is absent (i.e., the factor is $1$).\n\nLet the parental genotypes be $A_1A_1B_0B_0$ for $P_A$ and $A_0A_0B_1B_1$ for $P_B$. The first filial generation ($F_1$) hybrid produced by crossing $P_A \\times P_B$ is $A_1A_0B_1B_0$.\n\nDefine the proportional reduction in hybrid fitness relative to the geometric mean of the two parental fitnesses as\n$$R \\equiv 1 - \\frac{w_{F_1}}{\\sqrt{w_{P_A} w_{P_B}}}.$$\n\nDerive a closed-form expression for $R$ in terms of $s_1$, $s_2$, $h_1$, $h_2$, and $\\epsilon$, under the assumptions above. Provide your final answer as a single simplified analytic expression. Do not approximate or round.", "solution": "The problem statement is scientifically grounded, well-posed, and provides sufficient information to derive the requested expression. It describes a standard Dobzhansky-Muller incompatibility model with multiplicative fitness effects. The problem is valid and a solution can be derived.\n\nThe objective is to find a closed-form expression for the proportional reduction in hybrid fitness, $R$, defined as:\n$$R \\equiv 1 - \\frac{w_{F_1}}{\\sqrt{w_{P_A} w_{P_B}}}$$\nTo derive this expression, we must first determine the fitnesses of the two parental populations, $w_{P_A}$ and $w_{P_B}$, and the fitness of the first-generation hybrid, $w_{F_1}$. The fitness of a genotype is calculated as the product of the fitness components from each locus and any epistatic interactions.\n\n1.  **Fitness of Parental Population $P_A$ ($w_{P_A}$)**\n    The genotype of an individual from population $P_A$ is given as $A_1A_1B_0B_0$.\n    -   The fitness contribution from the A locus for genotype $A_1A_1$ is $(1 + s_1)$.\n    -   The fitness contribution from the B locus for genotype $B_0B_0$ is $1$.\n    -   An epistatic interaction of $(1 + \\epsilon)$ occurs only if derived alleles $A_1$ and $B_1$ co-occur. In genotype $A_1A_1B_0B_0$, there is no $B_1$ allele. Therefore, the epistatic factor is $1$.\n    -   The total fitness $w_{P_A}$ is the product of these factors:\n        $$w_{P_A} = (1 + s_1) \\times 1 \\times 1 = 1 + s_1$$\n\n2.  **Fitness of Parental Population $P_B$ ($w_{P_B}$)**\n    The genotype of an individual from population $P_B$ is given as $A_0A_0B_1B_1$.\n    -   The fitness contribution from the A locus for genotype $A_0A_0$ is $1$.\n    -   The fitness contribution from the B locus for genotype $B_1B_1$ is $(1 + s_2)$.\n    -   In genotype $A_0A_0B_1B_1$, there is no $A_1$ allele. Therefore, the epistatic factor is $1$.\n    -   The total fitness $w_{P_B}$ is the product of these factors:\n        $$w_{P_B} = 1 \\times (1 + s_2) \\times 1 = 1 + s_2$$\n\n3.  **Fitness of the $F_1$ Hybrid ($w_{F_1}$)**\n    The genotype of the $F_1$ hybrid, resulting from a cross between $P_A$ and $P_B$, is $A_1A_0B_1B_0$.\n    -   The fitness contribution from the A locus for the heterozygous genotype $A_1A_0$ is $(1 + h_1 s_1)$.\n    -   The fitness contribution from the B locus for the heterozygous genotype $B_1B_0$ is $(1 + h_2 s_2)$.\n    -   In genotype $A_1A_0B_1B_0$, at least one copy of the derived allele $A_1$ and at least one copy of the derived allele $B_1$ are present. Therefore, the deleterious epistatic interaction occurs, and the fitness is multiplied by the factor $(1 + \\epsilon)$.\n    -   The total fitness $w_{F_1}$ is the product of these factors:\n        $$w_{F_1} = (1 + h_1 s_1)(1 + h_2 s_2)(1 + \\epsilon)$$\n\n4.  **Derivation of the Expression for $R$**\n    Now, we substitute the expressions for $w_{P_A}$, $w_{P_B}$, and $w_{F_1}$ into the definition of $R$.\n    -   The geometric mean of parental fitnesses is:\n        $$\\sqrt{w_{P_A} w_{P_B}} = \\sqrt{(1 + s_1)(1 + s_2)}$$\n    -   The ratio of hybrid fitness to the geometric mean of parental fitnesses is:\n        $$\\frac{w_{F_1}}{\\sqrt{w_{P_A} w_{P_B}}} = \\frac{(1 + h_1 s_1)(1 + h_2 s_2)(1 + \\epsilon)}{\\sqrt{(1 + s_1)(1 + s_2)}}$$\n    -   Finally, substituting this into the expression for $R$:\n        $$R = 1 - \\frac{(1 + h_1 s_1)(1 + h_2 s_2)(1 + \\epsilon)}{\\sqrt{(1 + s_1)(1 + s_2)}}$$\n    This expression is the complete and simplified closed-form solution as requested, as no further algebraic simplification is possible without making approximations.", "answer": "$$\n\\boxed{1 - \\frac{(1 + h_1 s_1)(1 + h_2 s_2)(1 + \\epsilon)}{\\sqrt{(1 + s_1)(1 + s_2)}}}\n$$", "id": "2773924"}, {"introduction": "Theoretical models like the Dobzhansky-Muller incompatibility (DMI) provide a powerful framework, but verifying their action in nature requires robust statistical methods. This advanced practice [@problem_id:2773935] guides you through building a maximum likelihood model to analyze genotype-fitness data from a hybrid cross and test for the presence of a DMI. This exercise bridges the crucial gap between population genetic theory and empirical hypothesis testing, a cornerstone of modern evolutionary biology.", "problem": "You are given genotype-fitness data from three independent crosses that produced second filial generation ($F_2$) hybrids between two parental species fixed for alternate alleles at two unlinked loci $X$ and $Y$. Assume Mendelian segregation with independent assortment, Hardy-Weinberg genotype proportions within the $F_2$, and that viability is the only fitness component measured as a binary outcome per individual (survived or not). Use the following fundamental base: (i) Mendelian inheritance yields $F_2$ genotype frequencies of $X_1X_1:X_1X_2:X_2X_2$ equal to $1/4:1/2:1/4$ at each locus under random mating; (ii) independence of unlinked loci implies joint genotype frequencies equal to products of single-locus frequencies; (iii) Bernoulli trials model survival with probabilities that may depend on genotype; (iv) the joint likelihood under independent Bernoulli trials is the product of genotype-class specific binomial probabilities.\n\nDefine a Dobzhansky-Muller incompatibility (DMI) as follows: there is a single two-locus incompatibility such that the presence of at least one $X_1$ allele and at least one $Y_2$ allele in the same individual reduces the survival probability multiplicatively by a factor $(1 - s)$, where $s \\in [0,1]$ is the DMI effect size to be inferred. Let the baseline survival probability for genotype classes without this incompatible combination be $p_0 \\in (0,1)$. Thus, for any $F_2$ individual, if the number of $X_1$ copies is $i \\in \\{0,1,2\\}$ and the number of $Y_2$ copies is $j \\in \\{0,1,2\\}$, then define an indicator $I(i,j) = 1$ if $i > 0$ and $j > 0$, and $I(i,j) = 0$ otherwise. The survival probability for class $(i,j)$ is\n$$\np(i,j) = \\begin{cases}\np_0, & \\text{if } I(i,j) = 0, \\\\\np_0 (1 - s), & \\text{if } I(i,j) = 1.\n\\end{cases}\n$$\nYou are given, for each test case $k \\in \\{1,2,3\\}$, a $3 \\times 3$ array of ordered pairs $(N_{ij}^{(k)}, S_{ij}^{(k)})$ where $N_{ij}^{(k)}$ is the observed number of $F_2$ hybrids in genotype class $(i,j)$ and $S_{ij}^{(k)}$ is the number of survivors in that class. The indices $i \\in \\{0,1,2\\}$ enumerate copies of $X_1$ and $j \\in \\{0,1,2\\}$ enumerate copies of $Y_2$. All experiments used a total of $N^{(k)} = \\sum_{i=0}^2 \\sum_{j=0}^2 N_{ij}^{(k)}$ individuals with viability recorded once per individual.\n\nYour tasks are:\n- Construct the likelihood under the assumptions above and compute the maximum likelihood estimates (MLEs) $\\hat{p}_0$ and $\\hat{s}$ under the alternative model with a DMI ($s \\ge 0$ free), and the MLE under the null model with no DMI (constrained $s = 0$).\n- Use a likelihood ratio test (LRT) to infer the presence of a DMI by comparing the alternative and null models via the statistic\n$$\n\\Lambda = 2 \\left( \\ell_{\\text{alt}}(\\hat{p}_0,\\hat{s}) - \\ell_{\\text{null}}(\\hat{p}_0^{(0)}, 0) \\right),\n$$\nand decide “DMI present” if $\\Lambda > \\chi^2_{1,0.95}$, where $\\chi^2_{1,0.95}$ is the $0.95$ quantile of the chi-square distribution with $1$ degree of freedom. Treat the null as interior for thresholding purposes. Report the boolean decision for each test case.\n- Report for each test case the estimated $\\hat{s}$ rounded to three decimal places (as a decimal in $[0,1]$) and the boolean decision from the LRT.\n\nExpress all final numerical outputs as decimals without units. Angles are not involved. Do not use percentage signs.\n\nTest suite (each entry is $(N_{ij}, S_{ij})$ at row $i \\in \\{0,1,2\\}$ and column $j \\in \\{0,1,2\\}$; rows correspond to $i = 0,1,2$ and columns to $j = 0,1,2$):\n\n- Test case $1$ (no DMI; balanced $F_2$ with uniform survival):\n`[[ (25, 15), (50, 30), (25, 15) ], [ (50, 30), (100, 60), (50, 30) ], [ (25, 15), (50, 30), (25, 15) ]]`\n\n- Test case $2$ (moderate DMI; reduced survival in $I(i,j) = 1$ cells):\n`[[ (25, 15), (50, 30), (25, 15) ], [ (50, 30), (100, 42), (50, 21) ], [ (25, 15), (50, 21), (25, 11) ]]`\n\n- Test case $3$ (complete DMI lethality in $I(i,j) = 1$ cells):\n`[[ (25, 15), (50, 30), (25, 15) ], [ (50, 30), (100, 0), (50, 0) ], [ (25, 15), (50, 0), (25, 0) ]]`\n\nAlgorithmic and output requirements:\n- Your program must implement a numerically stable likelihood maximization subject to $p_0 \\in (0,1)$ and $s \\in [0,1]$. You may assume independence across individuals within genotype classes and between genotype classes for likelihood factorization. Aggregate the data into two groups defined by $I(i,j)$ to construct the binomial likelihood.\n- For each test case, compute $\\hat{s}$ and the LRT decision. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets in the order\n$[\\hat{s}^{(1)}, \\text{decision}^{(1)}, \\hat{s}^{(2)}, \\text{decision}^{(2)}, \\hat{s}^{(3)}, \\text{decision}^{(3)}]$\nwith $\\hat{s}^{(k)}$ rounded to three decimal places and each decision as a boolean literal.", "solution": "The problem posed is a well-defined exercise in statistical inference applied to a classical model of speciation genetics, the Dobzhansky-Muller Incompatibility (DMI) model. The problem is scientifically grounded, logically consistent, and all necessary information for its resolution is provided. Therefore, it is deemed valid, and a full solution follows.\n\nThe core of the problem is to estimate parameters for a model of viability selection and to perform a hypothesis test to determine if a specific genetic incompatibility is present. We are given count data $(N_{ij}, S_{ij})$ for nine distinct genotypes resulting from a standard $F_2$ intercross. $N_{ij}$ is the number of individuals of genotype $(i,j)$ before selection, and $S_{ij}$ is the number of survivors. The genotype is described by $i \\in \\{0, 1, 2\\}$, the number of $X_1$ alleles, and $j \\in \\{0, 1, 2\\}$, the number of $Y_2$ alleles.\n\nLet the survival probability of an individual with genotype $(i,j)$ be $p(i,j)$. The number of survivors $S_{ij}$ out of $N_{ij}$ zygotes is a random variable following a binomial distribution, $S_{ij} \\sim \\text{Binomial}(N_{ij}, p(i,j))$. The total log-likelihood $\\ell$ for the parameters of the model is the sum of the log-likelihoods for each genotype class, assuming independence among individuals:\n$$\n\\ell = \\sum_{i=0}^2 \\sum_{j=0}^2 \\left[ \\ln\\binom{N_{ij}}{S_{ij}} + S_{ij} \\ln p(i,j) + (N_{ij}-S_{ij}) \\ln(1-p(i,j)) \\right]\n$$\nThe constant terms $\\ln\\binom{N_{ij}}{S_{ij}}$ can be ignored for parameter estimation.\n\nThe DMI model specifies the survival probabilities. A baseline survival probability $p_0$ is reduced by a factor $(1-s)$ for genotypes that carry at least one $X_1$ allele and at least one $Y_2$ allele. Using the indicator function $I(i,j)=1$ if $i>0$ and $j>0$ (and $0$ otherwise), the survival probability is:\n$$\np(i,j) = p_0 (1-s)^{I(i,j)}\n$$\nWe can partition the nine genotypes into two groups:\nGroup $0$: Compatible genotypes where $I(i,j)=0$. The survival probability is $p_0$.\nGroup $1$: Incompatible genotypes where $I(i,j)=1$. The survival probability is $p_1 = p_0(1-s)$.\n\nLet us aggregate the counts for these two groups:\n$S_0 = \\sum_{(i,j):I(i,j)=0} S_{ij}$ and $N_0 = \\sum_{(i,j):I(i,j)=0} N_{ij}$.\n$S_1 = \\sum_{(i,j):I(i,j)=1} S_{ij}$ and $N_1 = \\sum_{(i,j):I(i,j)=1} N_{ij}$.\n\nThe log-likelihood, ignoring constants, can be expressed in terms of these aggregate counts:\n$$\n\\ell^*(p_0, s) = S_0 \\ln(p_0) + (N_0-S_0)\\ln(1-p_0) + S_1 \\ln(p_0(1-s)) + (N_1-S_1)\\ln(1-p_0(1-s))\n$$\nWe must find the maximum likelihood estimates (MLEs) for the parameters under two models.\n\n**Null Model ($H_0$)**: There is no DMI, which corresponds to the constraint $s=0$.\nUnder this model, $p(i,j)=p_0$ for all genotypes. The total number of survivors is $S_{tot} = S_0+S_1$ out of a total of $N_{tot} = N_0+N_1$ individuals. The MLE for $p_0$ is the overall survival proportion:\n$$\n\\hat{p}_0^{(0)} = \\frac{S_{tot}}{N_{tot}} = \\frac{S_0+S_1}{N_0+N_1}\n$$\nThe maximized log-likelihood under the null model, $\\ell_{\\text{null}}$, is:\n$$\n\\ell_{\\text{null}} = (S_0+S_1) \\ln(\\hat{p}_0^{(0)}) + (N_0+N_1-S_0-S_1) \\ln(1-\\hat{p}_0^{(0)})\n$$\n\n**Alternative Model ($H_A$)**: A DMI exists, with $s \\in [0,1]$.\nThe likelihood effectively decouples into two independent parts, one for Group $0$ with survival probability $p_0$, and one for Group $1$ with survival probability $p_1 = p_0(1-s)$. The MLEs for these probabilities are the observed proportions in each group:\n$$\n\\hat{p}_0 = \\frac{S_0}{N_0} \\quad \\text{and} \\quad \\hat{p}_1 = \\frac{S_1}{N_1}\n$$\nFrom the relation $\\hat{p}_1 = \\hat{p}_0(1-\\hat{s})$, we can solve for the MLE of $s$:\n$$\n\\hat{s} = 1 - \\frac{\\hat{p}_1}{\\hat{p}_0} = 1 - \\frac{S_1/N_1}{S_0/N_0}\n$$\nThe parameter space requires $s \\in [0,1]$. If $S_1/N_1 \\ge S_0/N_0$, the unconstrained estimate for $s$ would be non-positive. In this case, the maximum of the likelihood over the constrained space $s \\ge 0$ occurs at the boundary, so the MLE is $\\hat{s}=0$. If $S_1/N_1 < S_0/N_0$, the MLE is given by the above formula. A value of $\\hat{s}>1$ is impossible if survival probabilities are non-negative.\nThe maximized log-likelihood under the alternative model, $\\ell_{\\text{alt}}$, is:\n$$\n\\ell_{\\text{alt}} = S_0 \\ln(\\hat{p}_0) + (N_0-S_0)\\ln(1-\\hat{p}_0) + S_1 \\ln(\\hat{p}_1) + (N_1-S_1)\\ln(1-\\hat{p}_1)\n$$\nNote that if $\\hat{s}=0$, the alternative model collapses to the null model, and $\\ell_{\\text{alt}}=\\ell_{\\text{null}}$.\n\n**Likelihood Ratio Test (LRT)**\nWe compare the two models using the LRT statistic $\\Lambda$:\n$$\n\\Lambda = 2 (\\ell_{\\text{alt}} - \\ell_{\\text{null}})\n$$\nUnder the null hypothesis $H_0: s=0$, the statistic $\\Lambda$ is asymptotically distributed as a chi-square ($\\chi^2$) distribution with one degree of freedom, as the alternative model has one additional free parameter ($s$) compared to the null model. We reject $H_0$ and conclude a DMI is present if $\\Lambda$ exceeds the critical value $\\chi^2_{1,0.95}$, which is the $95^{th}$ percentile of the $\\chi^2_1$ distribution (approximately $3.841$).\n\n**Computational Procedure:**\nFor each test case:\n1.  Partition the $3 \\times 3$ data matrix into compatible ($I(i,j)=0$) and incompatible ($I(i,j)=1$) groups and compute the aggregate counts $(S_0, N_0)$ and $(S_1, N_1)$. The incompatible genotypes are $(i=1,j=1), (i=1,j=2), (i=2,j=1), (i=2,j=2)$.\n2.  Calculate the MLE $\\hat{s}$, handling the boundary case $\\hat{s}=0$.\n3.  Calculate the log-likelihoods $\\ell_{\\text{alt}}$ and $\\ell_{\\text{null}}$, carefully handling cases where counts are $0$ or $N$ to avoid $\\ln(0)$. The term $k \\ln(k/n)$ is taken to be $0$ if $k=0$.\n4.  Compute $\\Lambda = 2 (\\ell_{\\text{alt}} - \\ell_{\\text{null}})$.\n5.  Compare $\\Lambda$ to $\\chi^2_{1,0.95}$ to make a decision.\n6.  Report $\\hat{s}$ rounded to three decimal places and the boolean decision.\n\nApplication to the test cases yields the following results:\n- **Test Case 1:** $S_0/N_0 = 105/175 = 0.6$ and $S_1/N_1 = 135/225 = 0.6$. Since the survival proportions are equal, $\\hat{s}=0$. The LRT statistic $\\Lambda=0$, which is less than $3.841$. We do not detect a DMI.\n- **Test Case 2:** $S_0/N_0 = 105/175 = 0.6$ and $S_1/N_1 = 95/225 \\approx 0.422$. This gives $\\hat{s} = 1 - (95/225)/(105/175) \\approx 0.296$. The resulting $\\Lambda \\approx 12.524$, which exceeds $3.841$. We detect a DMI.\n- **Test Case 3:** $S_0/N_0 = 105/175 = 0.6$ and $S_1/N_1 = 0/225 = 0$. This corresponds to complete lethality of incompatible genotypes, so $\\hat{s}=1$. The resulting $\\Lambda \\approx 224.973$, which greatly exceeds $3.841$. We strongly detect a DMI.\n\nThe final computed values are encapsulated in the program below.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.stats import chi2\n\ndef solve():\n    \"\"\"\n    Solves the Dobzhansky-Muller incompatibility problem by calculating MLEs \n    for the DMI effect size 's' and performing a likelihood ratio test.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Test case 1 (no DMI)\n        [[(25, 15), (50, 30), (25, 15)],\n         [(50, 30), (100, 60), (50, 30)],\n         [(25, 15), (50, 30), (25, 15)]],\n        # Test case 2 (moderate DMI)\n        [[(25, 15), (50, 30), (25, 15)],\n         [(50, 30), (100, 42), (50, 21)],\n         [(25, 15), (50, 21), (25, 11)]],\n        # Test case 3 (complete DMI)\n        [[(25, 15), (50, 30), (25, 15)],\n         [(50, 30), (100, 0), (50, 0)],\n         [(25, 15), (50, 0), (25, 0)]],\n    ]\n\n    results = []\n\n    # Indicator matrix for DMI: I(i,j)=1 if i>0 and j>0.\n    # Rows i are copies of X1, columns j are copies of Y2.\n    indicator_dmi = np.array([[0, 0, 0],\n                              [0, 1, 1],\n                              [0, 1, 1]], dtype=bool)\n\n    # Chi-square critical value for LRT (1 dof, alpha=0.05)\n    chi2_critical_value = chi2.ppf(0.95, df=1)\n\n    for case_data in test_cases:\n        # Extract N (total) and S (survivor) counts into numpy arrays\n        N_matrix = np.array([[item[0] for item in row] for row in case_data])\n        S_matrix = np.array([[item[1] for item in row] for row in case_data])\n\n        # Aggregate counts for compatible (group 0) and incompatible (group 1) genotypes\n        N0 = N_matrix[~indicator_dmi].sum()\n        S0 = S_matrix[~indicator_dmi].sum()\n        N1 = N_matrix[indicator_dmi].sum()\n        S1 = S_matrix[indicator_dmi].sum()\n        \n        # This check is for robustness; not triggered by given test cases\n        if N0 == 0 or N1 == 0:\n            s_hat = 0.0\n            lambda_stat = 0.0\n        else:\n            # Unconstrained MLEs for survival proportions in each group\n            p0_raw = S0 / N0\n            p1_raw = S1 / N1\n\n            # MLE for s under the constraint s in [0,1]\n            if p1_raw >= p0_raw or p0_raw == 0:\n                s_hat = 0.0\n            else:\n                s_hat = 1.0 - p1_raw / p0_raw\n            \n            # Calculate Likelihood Ratio Test statistic (Lambda)\n            if s_hat <= 0:\n                lambda_stat = 0.0\n            else:\n                # Helper function for log-likelihood of a binomial experiment\n                def log_likelihood(k, n):\n                    if k == 0 or k == n:\n                        return 0.0\n                    p = k / n\n                    return k * np.log(p) + (n - k) * np.log(1.0 - p)\n\n                log_l_alt = log_likelihood(S0, N0) + log_likelihood(S1, N1)\n                log_l_null = log_likelihood(S0 + S1, N0 + N1)\n                \n                lambda_stat = 2 * (log_l_alt - log_l_null)\n        \n        # Perform the LRT decision\n        decision = lambda_stat > chi2_critical_value\n\n        # Append results for this case\n        results.append(f\"{s_hat:.3f}\")\n        results.append(str(decision).lower())\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "2773935"}]}