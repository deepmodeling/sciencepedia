{"hands_on_practices": [{"introduction": "A central question in population genetics is understanding how genetic variation is maintained in populations. While directional selection often drives alleles to fixation, this exercise explores a scenario where selection actively preserves diversity. You will derive the conditions for a stable polymorphism under heterozygote advantage, or overdominance, a classic model that explains how multiple alleles can be maintained at equilibrium frequencies within a population [@problem_id:2832508]. This practice is fundamental for grasping how the relative fitness of heterozygotes can shape the genetic landscape.", "problem": "A large, randomly mating diploid population with non-overlapping generations experiences viability selection at a single autosomal locus with two alleles, denoted $A$ and $a$. Let $p$ be the frequency of allele $A$ in zygotes prior to selection and $q = 1 - p$ the frequency of allele $a$. Assume Hardy–Weinberg equilibrium (HWE) holds at the zygote stage. The genotypic viabilities are given by $w_{AA} = 1 - s$, $w_{Aa} = 1$, and $w_{aa} = 1 - t$, where the selection coefficients $s$ and $t$ are nonnegative and strictly less than $1$.\n\nStarting from the definitions of HWE and viability selection as a change in genotype frequencies proportional to genotype viabilities, derive from first principles:\n- the allele frequency recursion $p \\mapsto p'$ after one generation of selection;\n- the condition, stated in terms of $s$ and $t$, under which both alleles are protected when rare (that is, each allele increases in frequency when introduced at vanishingly small frequency into a population fixed for the other);\n- the internal equilibrium allele frequency $p^{*}$ and its local stability.\n\nReport only the closed-form expression for the internal equilibrium allele $A$ frequency $p^{*}$ as your final answer. Do not include any units. No numerical rounding is required.", "solution": "The problem is a well-posed, standard exercise in theoretical population genetics. It is scientifically sound and contains all necessary information for derivation. We proceed with the solution.\n\nLet $p$ be the frequency of allele $A$ and $q = 1 - p$ be the frequency of allele $a$ in the zygote population of a given generation. Under the assumption of random mating, the genotype frequencies at the zygote stage follow Hardy-Weinberg proportions:\n-   Frequency of $AA$: $P_{AA} = p^2$\n-   Frequency of $Aa$: $P_{Aa} = 2pq$\n-   Frequency of $aa$: $P_{aa} = q^2 = (1-p)^2$\n\nViability selection occurs before the adult stage. The relative frequencies of the genotypes after selection are proportional to their initial frequencies multiplied by their respective viabilities, $w_{AA} = 1 - s$, $w_{Aa} = 1$, and $w_{aa} = 1 - t$.\n\nTo find the absolute frequencies of the surviving genotypes, we must normalize by the mean fitness of the population, $\\bar{w}$. The mean fitness is the weighted average of the genotype viabilities, where the weights are the genotype frequencies at the zygote stage.\n$$ \\bar{w} = P_{AA} w_{AA} + P_{Aa} w_{Aa} + P_{aa} w_{aa} $$\nSubstituting the expressions for frequencies and viabilities:\n$$ \\bar{w} = p^2 (1 - s) + 2p(1-p)(1) + (1-p)^2 (1 - t) $$\nExpanding and simplifying this expression:\n$$ \\bar{w} = p^2 - sp^2 + 2p - 2p^2 + (1 - 2p + p^2)(1 - t) $$\n$$ \\bar{w} = 2p - p^2 - sp^2 + 1 - 2p + p^2 - t(1 - 2p + p^2) $$\n$$ \\bar{w} = 1 - sp^2 - t(1-p)^2 $$\n\nThe frequency of allele $A$ in the next generation, denoted $p'$, is the frequency of allele $A$ in the gene pool of the individuals that survived selection. This is given by the frequency of surviving $AA$ homozygotes plus half the frequency of surviving $Aa$ heterozygotes.\n$$ p' = \\frac{P_{AA} w_{AA} + \\frac{1}{2}P_{Aa} w_{Aa}}{\\bar{w}} = \\frac{p^2(1-s) + p(1-p)(1)}{\\bar{w}} $$\n$$ p' = \\frac{p^2 - sp^2 + p - p^2}{\\bar{w}} = \\frac{p - sp^2}{1 - sp^2 - t(1-p)^2} = \\frac{p(1-sp)}{1 - sp^2 - t(1-p)^2} $$\nThis is the required allele frequency recursion $p \\mapsto p'$.\n\nAn allele is \"protected when rare\" if it tends to increase in frequency when its current frequency is very low.\n-   Allele $A$ is protected if $p' > p$ as $p \\to 0$. This is equivalent to the boundary equilibrium $p=0$ being unstable. The stability is determined by the derivative of the recursion map $f(p) = p'$ evaluated at $p=0$. The equilibrium is unstable if $f'(0) > 1$.\n    $$ f'(p) = \\frac{d}{dp} \\left( \\frac{p(1-sp)}{1 - sp^2 - t(1-p)^2} \\right) $$\n    At $p=0$, the numerator is $p(1-sp) \\to 0$ and the denominator is $1 - t$. Using the quotient rule is straightforward, but it is simpler to linearize $f(p)$ around $p=0$:\n    $$ f(p) \\approx \\frac{p(1-0)}{1-0-t(1-0)^2} = \\frac{p}{1-t} $$\n    The condition $p' > p$ becomes $\\frac{p}{1-t} > p$, which for $p>0$ implies $\\frac{1}{1-t} > 1$. Given $0 \\le t  1$, this condition simplifies to $t>0$.\n\n-   Allele $a$ is protected if its frequency $q'=(1-p')$ is greater than $q=(1-p)$ when $q \\to 0$ (i.e., as $p \\to 1$). This is equivalent to the boundary equilibrium $p=1$ being unstable, which means $p'  p$ for $p$ close to $1$. Symmetrically, the condition for allele $a$ to increase when rare is $s > 0$.\n\nThus, both alleles are protected when rare if $s>0$ and $t>0$. This corresponds to heterozygote advantage or overdominance, where $w_{Aa} > w_{AA}$ and $w_{Aa} > w_{aa}$.\n\nAn equilibrium allele frequency, $p^*$, is a value of $p$ for which the frequency does not change from one generation to the next, i.e., $p' = p$.\n$$ p = \\frac{p(1-sp)}{1 - sp^2 - t(1-p)^2} $$\nThis equation has trivial solutions at the boundaries of the frequency domain: $p^* = 0$ and $p^* = 1$.\nTo find the internal equilibrium ($0  p^*  1$), we assume $p \\neq 0$ and divide by $p$:\n$$ 1 = \\frac{1-sp}{1 - sp^2 - t(1-p)^2} $$\n$$ 1 - sp^2 - t(1-p)^2 = 1 - sp $$\n$$ -sp^2 - t(1-2p+p^2) = -sp $$\nRearranging the terms to form a quadratic equation in $p$:\n$$ (s+t)p^2 - (s+2t)p + t = 0 $$\nWe can factor this quadratic expression. Knowing that $p=1$ is a solution (as it is a boundary equilibrium), $(p-1)$ must be a factor.\n$$ (p-1)((s+t)p - t) = (s+t)p^2 - tp - (s+t)p + t = (s+t)p^2 - (s+2t)p + t = 0 $$\nThe factorization is correct. The solutions are $p=1$ and $(s+t)p - t = 0$.\nThe second solution gives the internal equilibrium frequency $p^*$:\n$$ (s+t)p^* = t \\implies p^* = \\frac{t}{s+t} $$\nThis internal equilibrium is biologically meaningful only if $0  p^*  1$.\n-   $p^*  0$ requires $\\frac{t}{s+t}  0$. Since $s \\ge 0$ and $t \\ge 0$, this implies $t > 0$.\n-   $p^*  1$ requires $\\frac{t}{s+t}  1$, which implies $t  s+t$, or $s  0$.\nThe internal equilibrium exists if and only if $s > 0$ and $t > 0$, precisely the condition for protected polymorphism.\nWhen this condition holds, the boundary equilibria at $p=0$ and $p=1$ are both unstable. In a $1$-dimensional system such as this, if the two boundary equilibria are unstable, the internal equilibrium must be locally stable. Therefore, $p^* = \\frac{t}{s+t}$ is a stable equilibrium.\n\nThe problem asks for the closed-form expression for the internal equilibrium allele $A$ frequency $p^*$.", "answer": "$$\\boxed{\\frac{t}{s+t}}$$", "id": "2832508"}, {"introduction": "Evolutionary dynamics are often a balance of opposing forces. This practice examines the constant interplay between mutation, which introduces new alleles, and selection, which acts upon them. You will derive the equilibrium frequency of a deleterious allele in a population by modeling the balance between the rate of new mutations and the strength of negative selection [@problem_id:2832591]. This essential derivation provides a quantitative prediction for the prevalence of many genetic disorders and illustrates a core principle of how populations handle a continual influx of harmful genetic variation.", "problem": "Consider an infinitely large haploid population with discrete, non-overlapping generations. There are two allelic types at a single locus: a wild-type allele $A$ with relative fitness $w_{A}=1$ and a deleterious allele $a$ with relative fitness $w_{a}=1-s$, where $s \\in (0,1)$ is the selection coefficient against $a$ and is constant over time. In each generation, new deleterious alleles arise by forward mutation from $A$ to $a$ at per-generation rate $u \\in (0,1)$; assume no back mutation from $a$ to $A$. Let $q_{t}$ denote the population frequency of allele $a$ immediately before selection in generation $t$.\n\nUsing only the definitions of relative fitness, selection coefficient, and mutation rate, and assuming determinism (infinite population size so that sampling error is negligible), derive from first principles the deterministic recurrence for $q_{t}$ across one generation under the life cycle “viability selection followed by mutation.” Then, by imposing equilibrium ($q_{t+1}=q_{t}=q^{*}$), solve exactly for the interior equilibrium frequency $q^{*}$ in terms of $u$ and $s$, and extract the leading-order term in the limit $u \\ll s$ (equivalently, $u \\to 0$ with fixed $s \\in (0,1)$). Report your final answer as the leading-order expression for $q^{*}$ in terms of $u$ and $s$. No units are required, and no rounding is needed. Your final answer must be a single analytic expression.", "solution": "The problem requires the derivation of the equilibrium frequency of a deleterious allele under a mutation-selection balance model. The analysis must be conducted from first principles for a haploid population undergoing discrete generations with a specified life cycle.\n\nLet $q_t$ be the frequency of the deleterious allele $a$, and $p_t = 1 - q_t$ be the frequency of the wild-type allele $A$ at the beginning of generation $t$, before any life cycle events occur. The population size is considered infinite, which implies a deterministic model.\n\nThe life cycle is specified as \"viability selection followed by mutation.\" We will model these two processes sequentially.\n\nStep 1: Viability Selection.\nThe relative fitnesses of the alleles are given as $w_A = 1$ for the wild-type allele and $w_a = 1-s$ for the deleterious allele, where $s \\in (0,1)$ is the selection coefficient. The change in allele frequencies due to selection is determined by the mean fitness of the population, $\\bar{w}_t$.\n$$ \\bar{w}_t = p_t w_A + q_t w_a = (1-q_t)(1) + q_t(1-s) = 1 - q_t + q_t - sq_t = 1 - sq_t $$\nAfter selection, the frequency of allele $a$, which we denote $q'_t$, is the frequency before selection multiplied by its relative fitness, and normalized by the mean fitness of the population.\n$$ q'_t = \\frac{q_t w_a}{\\bar{w}_t} = \\frac{q_t(1-s)}{1-sq_t} $$\nSimilarly, the frequency of allele $A$ after selection, $p'_t$, is:\n$$ p'_t = \\frac{p_t w_A}{\\bar{w}_t} = \\frac{1-q_t}{1-sq_t} $$\nAs a check, $p'_t + q'_t = \\frac{1-q_t + q_t(1-s)}{1-sq_t} = \\frac{1-q_t+q_t-sq_t}{1-sq_t} = \\frac{1-sq_t}{1-sq_t} = 1$.\n\nStep 2: Mutation.\nFollowing selection, mutation occurs. New deleterious alleles $a$ arise from wild-type alleles $A$ at a rate of $u \\in (0,1)$ per generation. There is no back mutation from $a$ to $A$. The frequency of allele $a$ in the next generation, $q_{t+1}$, is the sum of the frequency of $a$ alleles that survived selection ($q'_t$) and the frequency of new $a$ alleles that arose from mutation of $A$ alleles ($u \\cdot p'_t$).\n$$ q_{t+1} = q'_t + u \\cdot p'_t $$\nSubstituting the expressions for $q'_t$ and $p'_t$ derived in Step 1:\n$$ q_{t+1} = \\frac{q_t(1-s)}{1-sq_t} + u \\left( \\frac{1-q_t}{1-sq_t} \\right) $$\nCombining the terms gives the exact recurrence relation for $q_t$:\n$$ q_{t+1} = \\frac{q_t(1-s) + u(1-q_t)}{1-sq_t} = \\frac{q_t - sq_t + u - uq_t}{1-sq_t} = \\frac{q_t(1-s-u) + u}{1-sq_t} $$\nTo find the equilibrium frequency, $q^*$, we impose the condition $q_{t+1} = q_t = q^*$.\n$$ q^* = \\frac{q^*(1-s-u) + u}{1-sq^*} $$\nWe now solve this equation for $q^*$.\n$$ q^*(1-sq^*) = q^*(1-s-u) + u $$\n$$ q^* - s(q^*)^2 = q^* - sq^* - uq^* + u $$\nCanceling the $q^*$ term from both sides and rearranging yields a quadratic equation for $q^*$:\n$$ -s(q^*)^2 = -sq^* - uq^* + u $$\n$$ s(q^*)^2 - (s+u)q^* + u = 0 $$\nThis quadratic equation can be solved by factoring. We seek two numbers that sum to $-(s+u)$ and have a product of $su$. The factors are clearly visible.\n$$ (sq^* - u)(q^* - 1) = s(q^*)^2 - sq^* - uq^* + u = s(q^*)^2 - (s+u)q^* + u = 0 $$\nThe two exact solutions for the equilibrium frequency are found by setting each factor to zero:\n1.  $q^* - 1 = 0 \\implies q^* = 1$. This is a boundary equilibrium corresponding to the fixation of the deleterious allele.\n2.  $sq^* - u = 0 \\implies q^* = \\frac{u}{s}$. This is the interior equilibrium ($0  q^*  1$), which is biologically meaningful for a mutation-selection balance. The condition $u \\ll s$ given in the problem ensures that $q^*  1$.\n\nThe problem asks for the leading-order term of the exact solution for $q^*$ in the limit $u \\ll s$. The exact solution for the interior equilibrium is $q^* = \\frac{u}{s}$. This expression is a single term, linear in $u$ and inversely proportional to $s$. It contains no higher-order terms in $u$ or any other small parameter. Therefore, the expression itself is its own leading-order term. No approximation or expansion is necessary. The leading-order expression is the exact expression.", "answer": "$$\\boxed{\\frac{u}{s}}$$", "id": "2832591"}, {"introduction": "Bridging theoretical models with empirical data is a cornerstone of modern biology. While the concept of a selection coefficient, $s$, is a theoretical construct, how can we actually measure it from observational data? This exercise guides you through the process of statistical inference by first deriving the likelihood function for allele frequency changes in a Wright-Fisher population, and then using it to calculate a maximum likelihood estimate of the selection coefficient from a set of observed allele counts [@problem_id:2832551]. This hands-on application moves you from abstract theory to the practical challenge of quantifying evolutionary forces at work.", "problem": "You are studying a single-locus, two-allele system in a constant-size haploid population evolving across discrete, non-overlapping generations under the Wright–Fisher model. Let allele $A$ have relative fitness $1 + s$ and allele $a$ have relative fitness $1$, where $s  -1$ is the selection coefficient to be estimated. In generation $t$, let $X_t$ denote the count of allele $A$ among $N$ haploid individuals, so the allele $A$ frequency is $p_t = X_t / N$. The next generation ($t+1$) is formed by sampling $N$ offspring independently with replacement from the current generation, proportionally to the parental alleles’ relative fitness.\n\nTasks:\n1) From the fundamental definition of relative fitness and the Wright–Fisher sampling scheme, derive the conditional distribution of $X_{t+1}$ given $X_t$ as a function of $s$, and use this to write the likelihood $L(s \\mid X_{0:T})$ for an observed time series $\\{X_0, X_1, \\dots, X_T\\}$ as a product over generations.\n\n2) Apply your likelihood to a single-step dataset with $T=1$ and the following observed counts: $N = 200$, $X_0 = 60$, and $X_1 = 64$. Compute the maximum likelihood estimate of $s$ explicitly. Express your final estimate as a decimal and round to four significant figures. Do not include a percent sign and do not include any units.", "solution": "The problem as stated is scientifically grounded, self-contained, and well-posed. It presents a standard model from population genetics—the Wright–Fisher model with selection—and asks for a\nderivation of the likelihood function and a subsequent maximum likelihood estimation. All necessary parameters and data are provided. The problem is valid and permits a rigorous solution.\n\nThe problem consists of two tasks. We will address them in order.\n\n**Task 1: Derivation of the Conditional Distribution and Likelihood**\n\nWe are given a haploid population of constant size $N$. At generation $t$, the count of allele $A$ is $X_t$, so its frequency is $p_t = X_t / N$. The frequency of allele $a$ is $1 - p_t$. The relative fitness of allele $A$ is $w_A = 1 + s$, and for allele $a$ it is $w_a = 1$.\n\nFirst, we determine the frequency of allele $A$ in the conceptual gene pool from which the next generation is sampled. This frequency, which we denote $p'_{t+1}$, accounts for the effect of selection on the parental generation. It is calculated by weighting the allele frequencies by their respective fitness values.\n\nThe mean fitness of the population at generation $t$ is:\n$$ \\bar{w}_t = p_t w_A + (1-p_t) w_a = p_t(1+s) + (1-p_t)(1) = 1 + sp_t $$\n\nThe frequency of allele $A$ after selection is given by the standard recurrence relation:\n$$ p'_{t+1} = \\frac{p_t w_A}{\\bar{w}_t} = \\frac{p_t(1+s)}{1+sp_t} $$\nThis $p'_{t+1}$ represents the probability that a single offspring chosen from the population will carry allele $A$.\n\nAccording to the Wright–Fisher model, the $N$ individuals of generation $t+1$ are formed by $N$ independent draws with replacement from this conceptual gene pool. The number of $A$ alleles in generation $t+1$, denoted $X_{t+1}$, is therefore a random variable that follows a binomial distribution. The number of trials is $N$, and the probability of success (i.e., drawing an $A$ allele) in each trial is $p'_{t+1}$.\n\nThus, the conditional distribution of $X_{t+1}$ given $X_t$ (which determines $p_t$) is:\n$$ X_{t+1} \\mid X_t \\sim \\text{Binomial}(N, p'_{t+1}) $$\nThe probability mass function (PMF) is:\n$$ P(X_{t+1} \\mid X_t, s) = \\binom{N}{X_{t+1}} (p'_{t+1})^{X_{t+1}} (1-p'_{t+1})^{N-X_{t+1}} $$\nSubstituting the expression for $p'_{t+1}$ and noting that $1 - p'_{t+1} = \\frac{1-p_t}{1+sp_t}$, we obtain:\n$$ P(X_{t+1} \\mid X_t, s) = \\binom{N}{X_{t+1}} \\left(\\frac{p_t(1+s)}{1+sp_t}\\right)^{X_{t+1}} \\left(\\frac{1-p_t}{1+sp_t}\\right)^{N-X_{t+1}} $$\nThis is the required conditional distribution.\n\nThe likelihood of the parameter $s$ for an observed time series $\\{X_0, X_1, \\dots, X_T\\}$ is the probability of observing the sequence $X_1, \\dots, X_T$ given the initial state $X_0$ and the parameter $s$. Since the process is a Markov chain, the total likelihood is the product of the conditional probabilities for each generation transition:\n$$ L(s \\mid X_{0:T}) = P(X_1, \\dots, X_T \\mid X_0, s) = \\prod_{t=0}^{T-1} P(X_{t+1} \\mid X_t, s) $$\nSubstituting the PMF derived above, the full likelihood function is:\n$$ L(s \\mid X_{0:T}) = \\prod_{t=0}^{T-1} \\left[ \\binom{N}{X_{t+1}} \\left(\\frac{p_t(1+s)}{1+sp_t}\\right)^{X_{t+1}} \\left(\\frac{1-p_t}{1+sp_t}\\right)^{N-X_{t+1}} \\right] $$\nwhere $p_t = X_t/N$.\n\n**Task 2: Maximum Likelihood Estimation of $s$**\n\nWe are given a single-step dataset ($T=1$) with $N=200$, $X_0=60$, and $X_1=64$.\nThe initial frequency of allele $A$ is $p_0 = X_0/N = 60/200 = 0.3$.\n\nFor $T=1$, the likelihood function simplifies to the single term for the transition from $t=0$ to $t=1$:\n$$ L(s) = P(X_1=64 \\mid X_0=60, s) = \\binom{200}{64} \\left(\\frac{p_0(1+s)}{1+sp_0}\\right)^{64} \\left(\\frac{1-p_0}{1+sp_0}\\right)^{200-64} $$\nSubstituting $p_0=0.3$:\n$$ L(s) = \\binom{200}{64} \\left(\\frac{0.3(1+s)}{1+0.3s}\\right)^{64} \\left(\\frac{0.7}{1+0.3s}\\right)^{136} $$\nTo find the maximum likelihood estimate (MLE) of $s$, we maximize the log-likelihood function, $\\ell(s) = \\ln(L(s))$, as this simplifies calculations without changing the location of the maximum.\n$$ \\ell(s) = \\ln\\binom{200}{64} + 64 \\ln\\left(\\frac{0.3(1+s)}{1+0.3s}\\right) + 136 \\ln\\left(\\frac{0.7}{1+0.3s}\\right) $$\nWe can expand the logarithmic terms:\n$$ \\ell(s) = \\ln\\binom{200}{64} + 64(\\ln(0.3) + \\ln(1+s) - \\ln(1+0.3s)) + 136(\\ln(0.7) - \\ln(1+0.3s)) $$\nCollecting terms that depend on $s$:\n$$ \\ell(s) = C + 64\\ln(1+s) - 64\\ln(1+0.3s) - 136\\ln(1+0.3s) $$\n$$ \\ell(s) = C + 64\\ln(1+s) - 200\\ln(1+0.3s) $$\nwhere $C$ is a constant with respect to $s$. To find the maximum, we differentiate $\\ell(s)$ with respect to $s$ and set the derivative to zero.\n$$ \\frac{d\\ell}{ds} = \\frac{64}{1+s} - 200 \\cdot \\frac{0.3}{1+0.3s} = \\frac{64}{1+s} - \\frac{60}{1+0.3s} $$\nSetting the derivative to zero to find the MLE, $\\hat{s}$:\n$$ \\frac{64}{1+\\hat{s}} - \\frac{60}{1+0.3\\hat{s}} = 0 $$\n$$ \\frac{64}{1+\\hat{s}} = \\frac{60}{1+0.3\\hat{s}} $$\nNow, we solve for $\\hat{s}$ by cross-multiplication:\n$$ 64(1+0.3\\hat{s}) = 60(1+\\hat{s}) $$\n$$ 64 + 19.2\\hat{s} = 60 + 60\\hat{s} $$\n$$ 64 - 60 = 60\\hat{s} - 19.2\\hat{s} $$\n$$ 4 = 40.8\\hat{s} $$\n$$ \\hat{s} = \\frac{4}{40.8} = \\frac{40}{408} = \\frac{5}{51} $$\nFinally, we compute the decimal value and round to four significant figures as requested.\n$$ \\hat{s} = \\frac{5}{51} \\approx 0.0980392... $$\nRounding to four significant figures gives:\n$$ \\hat{s} \\approx 0.09804 $$\nThis positive value for the selection coefficient is consistent with the observed increase in the frequency of allele $A$ from $p_0=0.3$ to $p_1 = 64/200 = 0.32$.", "answer": "$$\\boxed{0.09804}$$", "id": "2832551"}]}