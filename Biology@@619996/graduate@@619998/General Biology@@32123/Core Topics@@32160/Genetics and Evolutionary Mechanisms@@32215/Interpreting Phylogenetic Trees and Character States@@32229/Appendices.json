{"hands_on_practices": [{"introduction": "The principle of maximum parsimony is a cornerstone of phylogenetic inference, seeking the evolutionary tree that requires the fewest character-state changes. To apply this principle, we must first learn how to calculate the 'parsimony score'—the minimum number of changes—for a single character on a given tree. This exercise [@problem_id:2810415] provides hands-on practice with the foundational Fitch algorithm, a systematic method for determining this score and identifying nodes where the ancestral state is uncertain.", "problem": "A single unordered, binary morphological character is observed across four taxa labeled A, B, C, and D. The character has two possible states, coded as $0$ (ancestral) and $1$ (derived). The phylogeny relating these taxa is given in Newick format as \"((A,B),(C,D));\", which you may treat as a rooted, fully bifurcating tree with a root whose two children are the internal ancestors of A with B, and of C with D, respectively. The observed tip states are A: $0$, B: $1$, C: $1$, and D: $1$.\n\nUnder the principle of maximum parsimony (Fitch parsimony), infer the minimum number of state-change steps required on this tree and determine which internal nodes (if any) are ambiguous in their inferred state sets when applying the standard bottom-up set-propagation procedure. For clarity, let $v_{1}$ denote the most recent common ancestor of A and B, $v_{2}$ denote the most recent common ancestor of C and D, and $r$ denote the root.\n\nDefine an internal node to be “ambiguous” if the set of possible character states assigned to that node under the bottom-up pass has cardinality greater than $1$. Provide any necessary reasoning starting from the parsimony principle that seeks to minimize total changes across the tree.\n\nReport only the minimum number of state-change steps as your final answer. Express the final answer as a pure number with no units. No rounding is required.", "solution": "The Fitch algorithm proceeds in two passes. The first pass is a bottom-up traversal of the tree to assign a set of possible states to each internal node. The second pass is a top-down traversal to assign a single state to each node. The total number of state changes is calculated during the first pass.\n\nLet $S(k)$ denote the set of possible states for a node $k$. For the terminal nodes (tips), the state sets are determined by their observed states:\n$S(A) = \\{0\\}$\n$S(B) = \\{1\\}$\n$S(C) = \\{1\\}$\n$S(D) = \\{1\\}$\n\nThe first pass proceeds from the tips to the root. For any internal node $k$ with children $i$ and $j$, the state set $S(k)$ is determined by the following rule:\nIf $S(i) \\cap S(j)$ is not an empty set ($\\neq \\emptyset$), then $S(k) = S(i) \\cap S(j)$.\nIf $S(i) \\cap S(j)$ is an empty set ($= \\emptyset$), then $S(k) = S(i) \\cup S(j)$. A state change is inferred on the subtree rooted at $k$, and the total step count is incremented by $1$.\n\nLet us apply this procedure to the given tree.\n\nFirst, consider the internal node $v_{1}$, the most recent common ancestor of $A$ and $B$. Its children are $A$ and $B$.\nThe state sets of its children are $S(A) = \\{0\\}$ and $S(B) = \\{1\\}$.\nThe intersection is $S(A) \\cap S(B) = \\{0\\} \\cap \\{1\\} = \\emptyset$.\nSince the intersection is empty, we take the union: $S(v_{1}) = S(A) \\cup S(B) = \\{0\\} \\cup \\{1\\} = \\{0, 1\\}$.\nThe application of the union rule signifies a required state change. The number of steps for this subtree is $1$.\nThe cardinality of $S(v_{1})$ is $|S(v_{1})| = 2$. Since $2 > 1$, the node $v_{1}$ is ambiguous.\n\nNext, consider the internal node $v_{2}$, the most recent common ancestor of $C$ and $D$. Its children are $C$ and $D$.\nThe state sets of its children are $S(C) = \\{1\\}$ and $S(D) = \\{1\\}$.\nThe intersection is $S(C) \\cap S(D) = \\{1\\} \\cap \\{1\\} = \\{1\\}$.\nSince the intersection is not empty, we assign the intersection to the parent node: $S(v_{2}) = \\{1\\}$.\nNo state change is required on this subtree. The number of steps is $0$.\nThe cardinality of $S(v_{2})$ is $|S(v_{2})| = 1$. This node is not ambiguous.\n\nFinally, consider the root node $r$, whose children are $v_{1}$ and $v_{2}$.\nThe state sets of its children are $S(v_{1}) = \\{0, 1\\}$ and $S(v_{2}) = \\{1\\}$.\nThe intersection is $S(v_{1}) \\cap S(v_{2}) = \\{0, 1\\} \\cap \\{1\\} = \\{1\\}$.\nSince the intersection is not empty, we assign the intersection to the root: $S(r) = \\{1\\}$.\nNo state change is required on the branch connecting $v_{1}$ or $v_{2}$ to the root during this part of the calculation. The number of steps is $0$.\nThe cardinality of $S(r)$ is $|S(r)| = 1$. The root node is not ambiguous.\n\nThe minimum total number of state changes for the entire tree is the sum of the steps accumulated during the bottom-up pass.\nTotal steps = (steps at $v_{1}$) + (steps at $v_{2}$) + (steps at $r$).\nIn our calculation, a step was counted only when computing the state set for $v_{1}$.\nTotal steps = $1 + 0 + 0 = 1$.\n\nTo confirm, we can perform the second (top-down) pass, though it is not strictly required to find the minimum number of steps. The root state-set is $S(r)=\\{1\\}$, so we must assign state $1$ to the root. For its children, we assign states to minimize further changes. For $v_2$, its state-set is $\\{1\\}$, so it is assigned state $1$. For $v_1$, its state-set is $\\{0,1\\}$. Since the parent state is $1$, we choose $1$ for $v_1$ to avoid a change. Now, we have states for the internal nodes: state($r$)=$1$, state($v_2$)=$1$, state($v_1$)=$1$.\nWe compare these to the states of their children.\nBranch $r \\to v_1$: $1 \\to 1$ (no change).\nBranch $r \\to v_2$: $1 \\to 1$ (no change).\nBranch $v_1 \\to A$: $1 \\to 0$ ($1$ change).\nBranch $v_1 \\to B$: $1 \\to 1$ (no change).\nBranch $v_2 \\to C$: $1 \\to 1$ (no change).\nBranch $v_2 \\to D$: $1 \\to 1$ (no change).\nThe total number of changes is $1$, which occurs on the branch leading to taxon $A$. This confirms the result from the first pass.\n\nThe minimum number of state-change steps required on this tree is $1$. The only ambiguous internal node is $v_{1}$. The problem asks only for the number of steps.", "answer": "$$\\boxed{1}$$", "id": "2810415"}, {"introduction": "After determining the minimum number of changes ($s$) a character requires on a tree, the next step is to evaluate how well that character fits the proposed hypothesis of relationships. The Consistency Index ($CI$) and Retention Index ($RI$) are powerful metrics for this purpose, measuring the levels of homoplasy and synapomorphy, respectively. This practice problem [@problem_id:2810395] will guide you through calculating these indices by relating the observed number of steps ($s$) to the theoretical minimum ($m$) and maximum ($g$), forcing a deeper consideration of a character's evolutionary information content.", "problem": "A single unordered, reversible, equal-weight binary character is observed on four taxa related by the fully resolved unrooted tree written in Newick notation as \"((A,B),(C,D));\". The observed tip states are: $A:0$, $B:0$, $C:1$, $D:1$. Using the foundational definitions that (i) the parsimony score $s$ of a character on a fixed tree is the minimum number of state changes required to explain the observed tip states on that tree, (ii) the theoretical minimum number of steps $m$ for that character is the minimum over all possible fully resolved trees on the same set of taxa, and (iii) the theoretical maximum number of steps $g$ for that character is the maximum over all possible fully resolved trees on the same set of taxa consistent with the observed state frequencies, compute the Consistency Index ($CI$) and the Retention Index ($RI$) for this character on the given tree. Explicitly show the values of $m$, $s$, and $g$ you use before computing $CI$ and $RI$. Provide exact values with no rounding. The final answer must include both $CI$ and $RI$.", "solution": "The solution proceeds by first calculating the three fundamental quantities: the parsimony score ($s$), the theoretical minimum number of steps ($m$), and the theoretical maximum number of steps ($g$). Subsequently, these values are used to compute the Consistency Index ($CI$) and the Retention Index ($RI$).\n\n**1. Calculation of the Parsimony Score ($s$)**\n\nThe parsimony score, $s$, is the minimum number of character state changes on the given tree, \"((A,B),(C,D));\". This unrooted tree topology groups taxa $A$ and $B$ together, and taxa $C$ and $D$ together. There is a single internal branch connecting the common ancestor of the $(A,B)$ clade and the common ancestor of the $(C,D)$ clade.\n\nWe can determine $s$ using Fitch's algorithm, or by direct inspection for a simple case such as this.\n- The states for the tips are $A:0$, $B:0$, $C:1$, $D:1$.\n- Consider the clade $(A,B)$. Both taxa have state $0$. Therefore, their most recent common ancestor can be assigned state $0$ with zero changes on the branches leading to $A$ and $B$.\n- Consider the clade $(C,D)$. Both taxa have state $1$. Therefore, their most recent common ancestor can be assigned state $1$ with zero changes on the branches leading to $C$ and $D$.\n- The tree now consists of two internal nodes, one with an optimal state of $0$ and the other with an optimal state of $1$, connected by the central internal branch. To reconcile these states, exactly one change (from $0$ to $1$, or $1$ to $0$, as the character is reversible) is required on this internal branch.\n- The total number of changes is the sum of changes on all branches: $0 + 0 + 1 = 1$.\nThus, the parsimony score on the given tree is $s = 1$.\n\n**2. Calculation of the Theoretical Minimum Steps ($m$)**\n\nThe value $m$ is the minimum number of changes required for a character, regardless of the tree topology. For any character with $r$ distinct states observed among the taxa, at least $r-1$ changes are necessary to connect all states. This is the intrinsic minimum for the character's state distribution.\n- The observed states are $0$ and $1$.\n- The number of distinct states is $r = 2$.\n- Therefore, the theoretical minimum number of steps is $m = r - 1 = 2 - 1 = 1$.\n\n**3. Calculation of the Theoretical Maximum Steps ($g$)**\n\nThe value $g$ is the maximum parsimony score over all possible fully resolved unrooted trees for the four taxa $A, B, C, D$. For four taxa, there are three possible unrooted tree topologies:\n- Tree 1: `((A,B),(C,D));` (the given tree). As calculated, the score is $s_1 = 1$.\n- Tree 2: `((A,C),(B,D));`. Here, clade $(A,C)$ has states $(0,1)$, and clade $(B,D)$ has states $(0,1)$. Each of these clades requires a minimum of one change to be explained. The total score is the sum of the minimum changes in each partition created by the central branch. The partition is $\\{A, C\\}$ and $\\{B, D\\}$. Minimum changes for $\\{A,C\\}$ is $1$. Minimum changes for $\\{B,D\\}$ is $1$. The total changes on this tree is $s_2 = 1 + 1 = 2$.\n- Tree 3: `((A,D),(B,C));`. Here, clade $(A,D)$ has states $(0,1)$ and clade $(B,C)$ has states $(0,1)$. By symmetry with Tree 2, the score is $s_3 = 2$.\n\nThe set of possible parsimony scores for this character across all valid tree topologies is $\\{1, 2\\}$. The maximum value in this set is $2$.\nTherefore, the theoretical maximum number of steps is $g = 2$.\n\nAlternatively, for a binary character with $n_0$ taxa in state $0$ and $n_1$ taxa in state $1$, the value of $g$ can be calculated by the formula $g = (n_0 + n_1) - \\max(n_0, n_1)$.\n- In this problem, $n_0 = 2$ (taxa $A, B$) and $n_1 = 2$ (taxa $C, D$).\n- $g = (2+2) - \\max(2,2) = 4 - 2 = 2$.\nThis confirms the result from enumeration.\n\n**4. Calculation of the Consistency Index ($CI$) and Retention Index ($RI$)**\n\nThe required values are now available:\n- $s = 1$\n- $m = 1$\n- $g = 2$\n\nThe Consistency Index ($CI$) is defined as the ratio of the theoretical minimum steps to the actual parsimony score on the tree:\n$$CI = \\frac{m}{s}$$\n$$CI = \\frac{1}{1} = 1$$\nA $CI$ of $1$ signifies that the character exhibits no homoplasy (convergent or parallel evolution, or reversal) on the given tree.\n\nThe Retention Index ($RI$) is defined as:\n$$RI = \\frac{g - s}{g - m}$$\nThis index measures the fraction of potential synapomorphy that is realized as actual synapomorphy on the tree.\n$$RI = \\frac{2 - 1}{2 - 1} = \\frac{1}{1} = 1$$\nAn $RI$ of $1$ indicates that the character fits the given tree topology perfectly, maximizing the synapomorphy that the character's distribution allows.\n\nThe computed values are $CI = 1$ and $RI = 1$.", "answer": "$$\n\\boxed{CI = 1, RI = 1}\n$$", "id": "2810395"}, {"introduction": "A phylogenetic tree is a hypothesis, and it is crucial to assess the statistical support for its different parts, or clades. The nonparametric bootstrap is the most common method for evaluating confidence in the clades recovered by a phylogenetic analysis, simulating the effect of resampling characters from your dataset. In this exercise [@problem_id:2810404], you will simulate the bootstrap process from first principles, moving from manual character resampling to determining which tree topology is most parsimonious for each replicate, and ultimately calculating the statistical support for a specific clade.", "problem": "Four taxa $A$, $B$, $C$, and $D$ are scored for four independent, unordered, equal-weight, binary characters. The observed character states are:\n- Character $1$: $A=1$, $B=1$, $C=0$, $D=0$.\n- Character $2$: $A=1$, $B=1$, $C=0$, $D=0$.\n- Character $3$: $A=1$, $B=0$, $C=1$, $D=0$.\n- Character $4$: $A=1$, $B=0$, $C=0$, $D=0$.\n\nAssume the Felsenstein nonparametric bootstrap: generate bootstrap replicates by sampling columns with replacement from the original alignment until the original length $n=4$ is reached. For each replicate:\n- Consider only fully bifurcating unrooted trees on four taxa (there are exactly three such topologies).\n- Use the maximum parsimony criterion under unordered binary character changes with equal weights to select the most parsimonious topology or topologies.\n- Count the clade $(A,B)$ as “present” in a bootstrap replicate if and only if the uniquely most parsimonious topology contains the split $(A,B)\\,|\\,(C,D)$. If there is a tie among most parsimonious topologies and any optimal topology lacks $(A,B)$, do not count $(A,B)$ as present for that replicate.\n\nUsing only first principles (definitions of parsimony, phylogenetically informative sites, and the bootstrap resampling scheme), compute the exact bootstrap support for clade $(A,B)$ as the probability (under the resampling-with-replacement process described above) that $(A,B)$ is counted as present. Express your final answer as a decimal rounded to four significant figures. No percent sign is allowed.", "solution": "The problem requires the computation of the nonparametric bootstrap support for a specific clade, $(A,B)$, given a small character matrix for four taxa. The solution necessitates a methodical application of the principles of maximum parsimony and the bootstrap resampling procedure.\n\nFirst, we analyze the structure of the problem. For four taxa, labeled $A$, $B$, $C$, and $D$, there are exactly three possible unrooted, bifurcating phylogenies. These topologies are distinguished by the central split they define:\n1.  Topology $T_1$: The split $(A,B)\\,|\\,(C,D)$, which corresponds to the clade $(A,B)$.\n2.  Topology $T_2$: The split $(A,C)\\,|\\,(B,D)$.\n3.  Topology $T_3$: The split $(A,D)\\,|\\,(B,C)$.\n\nThe support for clade $(A,B)$ is the probability that $T_1$ is the uniquely most parsimonious tree for a bootstrap replicate.\n\nNext, we must classify the provided characters based on their utility for parsimony analysis. The total parsimony score for a given tree is the sum of the minimum number of character-state changes (the parsimony score) for each character on that tree. For four taxa and binary characters, a character can be phylogenetically informative, uninformative, or constant.\nA site is phylogenetically informative under parsimony if it contains at least two different states, each present at least twice. For four taxa, this corresponds to a pattern with two taxa in one state and two in another (e.g., $0011$, $0101$, $1001$).\nA site is uninformative if it is not constant but is not phylogenetically informative. For four taxa, this corresponds to a pattern with one taxon in one state and three in the other (e.g., $0001$, $1110$). Uninformative sites have the same parsimony score ($1$) on all three topologies and thus do not help distinguish among them.\nConstant sites ($0000$ or $1111$) have a parsimony score of $0$ on all topologies and are also uninformative.\n\nLet us analyze the four given characters:\n- Character $1$: $(A,B,C,D) = (1,1,0,0)$. This is a phylogenetically informative pattern. Let $L_i(j)$ be the parsimony score of character $j$ on topology $T_i$.\n  - $L_1(1) = 1$ (one change on the central branch of $T_1$).\n  - $L_2(1) = 2$ (two changes required on $T_2$).\n  - $L_3(1) = 2$ (two changes required on $T_3$).\n  This character supports $T_1$. Let us denote this character type as $c_1$.\n- Character $2$: $(A,B,C,D) = (1,1,0,0)$. This is identical to Character $1$ and is also of type $c_1$.\n- Character $3$: $(A,B,C,D) = (1,0,1,0)$. This is also phylogenetically informative.\n  - $L_1(3) = 2$.\n  - $L_2(3) = 1$.\n  - $L_3(3) = 2$.\n  This character supports $T_2$. Let us denote this type as $c_2$.\n- Character $4$: $(A,B,C,D) = (1,0,0,0)$. This is a phylogenetically uninformative pattern.\n  - $L_1(4) = 1$.\n  - $L_2(4) = 1$.\n  - $L_3(4) = 1$.\n  This character does not favor any particular topology. Let us denote this type as $c_u$.\nNo characters supporting $T_3$ (type $c_3$) are present in the original dataset.\n\nThe bootstrap procedure samples $n=4$ characters with replacement from the original set {$c_1, c_1, c_2, c_u$}. The probabilities of drawing each type of character in a single trial are:\n- $P(\\text{draw } c_1) = p_1 = \\frac{2}{4} = \\frac{1}{2}$.\n- $P(\\text{draw } c_2) = p_2 = \\frac{1}{4}$.\n- $P(\\text{draw } c_3) = p_3 = \\frac{0}{4} = 0$.\n- $P(\\text{draw } c_u) = p_u = \\frac{1}{4}$.\n\nLet a bootstrap replicate consist of $n_1$ characters of type $c_1$, $n_2$ of type $c_2$, $n_3$ of type $c_3$, and $n_u$ of type $c_u$, such that $n_1+n_2+n_3+n_u = 4$. Since $p_3=0$, we must have $n_3=0$.\nThe total parsimony score for each topology in a replicate is the sum of scores from each sampled character. The terms from uninformative sites ($n_u \\cdot 1$) are constant across all topologies and can be disregarded when comparing them. Let $L'(T_i)$ be the total score from informative sites only.\n- $L'(T_1) = n_1 \\cdot 1 + n_2 \\cdot 2 = n_1 + 2n_2$.\n- $L'(T_2) = n_1 \\cdot 2 + n_2 \\cdot 1 = 2n_1 + n_2$.\n- $L'(T_3) = n_1 \\cdot 2 + n_2 \\cdot 2 = 2n_1 + 2n_2$.\n\nAccording to the problem, the clade $(A,B)$ is counted as present if and only if $T_1$ is the *uniquely* most parsimonious topology. This requires $L'(T_1)  L'(T_2)$ and $L'(T_1)  L'(T_3)$.\n1.  $n_1 + 2n_2  2n_1 + n_2 \\implies n_2  n_1$.\n2.  $n_1 + 2n_2  2n_1 + 2n_2 \\implies 0  n_1$.\nSo, we must find the total probability of all bootstrap replicates where the counts $(n_1, n_2, n_u)$ satisfy $n_1+n_2+n_u=4$, $n_1 > 0$, and $n_1 > n_2$.\n\nThe probability of obtaining a specific combination $(n_1, n_2, n_u)$ in a sample of size $4$ is given by the multinomial probability formula:\n$$ P(n_1, n_2, n_u) = \\frac{4!}{n_1! n_2! n_u!} p_1^{n_1} p_2^{n_2} p_u^{n_u} = \\frac{4!}{n_1! n_2! n_u!} \\left(\\frac{1}{2}\\right)^{n_1} \\left(\\frac{1}{4}\\right)^{n_2} \\left(\\frac{1}{4}\\right)^{n_u} $$\nThis can be rewritten as:\n$$ P(n_1, n_2, n_u) = \\frac{4!}{n_1! n_2! n_u!} \\frac{2^{n_1}}{4^{n_1+n_2+n_u}} = \\frac{4!}{n_1! n_2! n_u!} \\frac{2^{n_1}}{4^4} = \\frac{4!}{n_1! n_2! n_u!} \\frac{2^{n_1}}{256} $$\nWe enumerate all integer combinations of $(n_1, n_2, n_u)$ satisfying $n_1+n_2+n_u=4$ and the conditions $n_1 > n_2$ and $n_1 > 0$:\n1.  $n_1 = 4$: $(4,0,0)$. Condition $4>0$ holds. $P(4,0,0) = \\frac{4!}{4!0!0!} \\frac{2^4}{256} = 1 \\cdot \\frac{16}{256} = \\frac{16}{256}$.\n2.  $n_1 = 3$: $n_2+n_u=1$.\n    - $(3,1,0)$: Condition $3>1$ holds. $P(3,1,0) = \\frac{4!}{3!1!0!} \\frac{2^3}{256} = 4 \\cdot \\frac{8}{256} = \\frac{32}{256}$.\n    - $(3,0,1)$: Condition $3>0$ holds. $P(3,0,1) = \\frac{4!}{3!0!1!} \\frac{2^3}{256} = 4 \\cdot \\frac{8}{256} = \\frac{32}{256}$.\n3.  $n_1 = 2$: $n_2+n_u=2$.\n    - $(2,2,0)$: Condition $2>2$ is false. Not counted.\n    - $(2,1,1)$: Condition $2>1$ holds. $P(2,1,1) = \\frac{4!}{2!1!1!} \\frac{2^2}{256} = 12 \\cdot \\frac{4}{256} = \\frac{48}{256}$.\n    - $(2,0,2)$: Condition $2>0$ holds. $P(2,0,2) = \\frac{4!}{2!0!2!} \\frac{2^2}{256} = 6 \\cdot \\frac{4}{256} = \\frac{24}{256}$.\n4.  $n_1 = 1$: $n_2+n_u=3$.\n    - For $1 > n_2$ to hold, $n_2$ must be $0$. This gives $(1,0,3)$. $P(1,0,3) = \\frac{4!}{1!0!3!} \\frac{2^1}{256} = 4 \\cdot \\frac{2}{256} = \\frac{8}{256}$.\n5.  $n_1 = 0$: The condition $n_1 > 0$ is not met. No cases are counted.\n\nThe total probability is the sum of the probabilities of these valid cases:\n$$ P(\\text{support for } T_1) = \\frac{16 + 32 + 32 + 48 + 24 + 8}{256} = \\frac{160}{256} $$\nThis fraction simplifies:\n$$ \\frac{160}{256} = \\frac{32 \\times 5}{32 \\times 8} = \\frac{5}{8} $$\nThe problem asks for the result as a decimal rounded to four significant figures.\n$$ \\frac{5}{8} = 0.625 $$\nExpressed with four significant figures, this is $0.6250$.", "answer": "$$\\boxed{0.6250}$$", "id": "2810404"}]}