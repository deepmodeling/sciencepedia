{"hands_on_practices": [{"introduction": "A key goal in disturbance ecology is to quantify an ecosystem's ability to recover from perturbation, a concept known as resilience. This exercise moves from a qualitative description to a quantitative metric by employing a fundamental model of ecological recovery. By analyzing the post-disturbance dynamics described by a first-order differential equation, you will derive the 'half-life of deviation', a powerful and intuitive measure of how quickly a community returns to its equilibrium state [@problem_id:2794126].", "problem": "A temperate grassland experiences periodic patch-level fires as part of its disturbance regime. Immediately after a fire, the community’s aboveground biomass deviates from its pre-disturbance equilibrium by an amount $D(t)$ (measured as absolute deviation in $\\mathrm{g}\\,\\mathrm{m}^{-2}$), where $t$ is time in years. Ecological monitoring indicates that recovery is well approximated by a first-order linear relaxation, meaning the instantaneous rate of change of deviation is proportional to the current deviation: $\\frac{dD}{dt}=-rD$, where $r$ is a constant recovery rate. Suppose long-term surveys estimate $r=0.15\\,\\mathrm{yr}^{-1}$ for this grassland, and at $t=0$ the deviation is $D(0)=D_{0}$.\n\nDefine the half-life of deviation $t_{1/2}$ as the time required for the deviation to decrease from $D_{0}$ to $D_{0}/2$. Starting only from the differential equation $\\frac{dD}{dt}=-rD$ and the initial condition $D(0)=D_{0}$, derive an expression for $t_{1/2}$ in terms of $r$, and then compute its numerical value for $r=0.15\\,\\mathrm{yr}^{-1}$. Round your answer to three significant figures and express it in years.\n\nIn one or two sentences, state the ecological meaning of the half-life $t_{1/2}$ in this context (no calculation needed for the interpretation; the final numeric answer must still be provided).", "solution": "The problem statement is evaluated and determined to be valid. It is scientifically grounded in established ecological principles of disturbance and recovery, formulated as a well-posed initial value problem using a standard first-order linear differential equation. The variables and parameters are clearly defined, and the premises are consistent and sufficient for deriving a unique solution. We may therefore proceed with the formal derivation and calculation.\n\nThe problem describes the recovery of a community's biomass after a disturbance. The deviation from equilibrium, $D(t)$, follows the differential equation:\n$$\n\\frac{dD}{dt} = -rD\n$$\nThis is a first-order, linear, homogeneous ordinary differential equation with constant coefficients. The initial condition is given as $D(t=0) = D_0$.\n\nTo solve this equation, we use the method of separation of variables. We rearrange the equation to group terms involving $D$ and $t$ on opposite sides:\n$$\n\\frac{1}{D} dD = -r \\, dt\n$$\nNext, we integrate both sides. The integration is performed from the initial state at time $t=0$, where the deviation is $D_0$, to an arbitrary time $t$, where the deviation is $D(t)$.\n$$\n\\int_{D_0}^{D(t)} \\frac{1}{D'} dD' = \\int_{0}^{t} -r \\, dt'\n$$\nThe left side integrates to the natural logarithm, and the right side is a simple integral of a constant. Since deviation $D(t)$ must be a positive quantity ($D(t)0$ for $t  \\infty$), we can omit the absolute value in the logarithm.\n$$\n[\\ln(D')]_{D_0}^{D(t)} = [-rt']_{0}^{t}\n$$\n$$\n\\ln(D(t)) - \\ln(D_0) = -r(t) - (-r(0))\n$$\n$$\n\\ln\\left(\\frac{D(t)}{D_0}\\right) = -rt\n$$\nTo find the explicit function $D(t)$, we exponentiate both sides:\n$$\n\\frac{D(t)}{D_0} = \\exp(-rt)\n$$\n$$\nD(t) = D_0 \\exp(-rt)\n$$\nThis solution describes the exponential decay of the biomass deviation from its initial value $D_0$ over time.\n\nThe problem defines the half-life of deviation, $t_{1/2}$, as the time required for the deviation to decrease to half of its initial value. Mathematically, this means finding the time $t = t_{1/2}$ such that $D(t_{1/2}) = \\frac{D_0}{2}$. We substitute this condition into our solution for $D(t)$:\n$$\n\\frac{D_0}{2} = D_0 \\exp(-r t_{1/2})\n$$\nFor a non-trivial disturbance ($D_0 \\ne 0$), we can divide both sides by $D_0$:\n$$\n\\frac{1}{2} = \\exp(-r t_{1/2})\n$$\nTo solve for $t_{1/2}$, we take the natural logarithm of both sides of the equation:\n$$\n\\ln\\left(\\frac{1}{2}\\right) = \\ln\\left(\\exp(-r t_{1/2})\\right)\n$$\nUsing the properties of logarithms, $\\ln(1/x) = -\\ln(x)$ and $\\ln(\\exp(y)) = y$, we have:\n$$\n-\\ln(2) = -r t_{1/2}\n$$\nSolving for $t_{1/2}$, we obtain the general expression in terms of the recovery rate $r$:\n$$\nt_{1/2} = \\frac{\\ln(2)}{r}\n$$\nNow, we are given the numerical value for the recovery rate, $r = 0.15\\,\\mathrm{yr}^{-1}$. We substitute this into our derived formula for the half-life:\n$$\nt_{1/2} = \\frac{\\ln(2)}{0.15}\n$$\nUsing the approximate value of the natural logarithm of $2$, $\\ln(2) \\approx 0.693147...$, we can calculate the numerical value of $t_{1/2}$:\n$$\nt_{1/2} \\approx \\frac{0.693147}{0.15}\\,\\mathrm{yr} \\approx 4.62098\\,\\mathrm{yr}\n$$\nThe problem requires the answer to be rounded to three significant figures. Therefore, we have:\n$$\nt_{1/2} \\approx 4.62\\,\\mathrm{yr}\n$$\nThe ecological meaning of the half-life $t_{1/2}$ in this context is that it is the characteristic time required for the grassland ecosystem to recover halfway to its pre-disturbance equilibrium biomass state following a fire. This value serves as a quantitative measure of the community's resilience, where a shorter half-life indicates a faster recovery rate.", "answer": "$$\n\\boxed{4.62}\n$$", "id": "2794126"}, {"introduction": "Ecological succession is often more than simple recovery; it is a directional process of species replacement driven by interactions among organisms and with their environment. This practice delves into facilitation, a classic successional mechanism where early-colonizing species ameliorate harsh conditions, thereby enabling the establishment of later species. Using a Lotka–Volterra competition model modified to include stress-moderation, you will determine the minimum amelioration strength a pioneer species must possess to pave the way for a less stress-tolerant competitor, providing a quantitative basis for the facilitation model of succession [@problem_id:2794094].", "problem": "Consider a continuous-time, two-species competition model for primary succession on a harsh substrate with abiotic stress. Let the stress level be denoted by $S$. Initially, in the absence of vegetation, stress is $S_{0}$. A stress-tolerant pioneer species $P$ ameliorates stress locally in proportion to its biomass: in pioneer-dominated patches the effective stress is $S = S_{0} - \\sigma P$, where $\\sigma  0$ is the pioneer’s facilitation (amelioration) coefficient. A late-successional competitor $C$ is stress-intolerant during establishment but, once dominant, maintains a lower and approximately stable stress $S_{1}$ with $0  S_{1}  S_{0}$ (for example, via persistent canopy closure and moisture retention). Assume $S_{1}$ is a constant property of competitor-dominated stands.\n\nPopulation dynamics follow Lotka–Volterra competition with stress-dependent intrinsic growth:\n- Pioneer: $\\dfrac{dP}{dt} = P\\left[r_{p} - \\eta S - b_{p} P - \\theta C\\right]$,\n- Competitor: $\\dfrac{dC}{dt} = C\\left[r_{c} - S - b_{c} C - \\kappa P\\right]$,\n\nwhere $r_{p}  0$ and $r_{c}  0$ are intrinsic growth parameters in the absence of stress, $\\eta \\in (0,1)$ quantifies the pioneer’s stress sensitivity (smaller than the competitor’s, reflecting higher stress tolerance), $b_{p}  0$ and $b_{c}  0$ are intraspecific self-limitation coefficients, and $\\theta  0$ and $\\kappa  0$ are interspecific competition coefficients (effects of $C$ on $P$, and of $P$ on $C$, respectively). In pioneer-dominated patches, set $S = S_{0} - \\sigma P$; in competitor-dominated patches, set $S = S_{1}$.\n\nAssume the following empirically grounded conditions that encode a facilitation-driven successional sequence:\n1. Pioneer establishment on bare substrate is feasible: $r_{p} - \\eta S_{0}  0$.\n2. Competitor cannot establish on bare substrate: $r_{c} - S_{0}  0$.\n3. Competitor can persist in its self-maintained environment: $r_{c} - S_{1}  0$.\n4. Competitive inferiority of the pioneer at low stress: when $C$ is at its single-species equilibrium under $S_{1}$, the pioneer cannot invade, i.e., $r_{p} - \\eta S_{1} - \\theta \\dfrac{r_{c} - S_{1}}{b_{c}}  0$.\n5. Feasible pioneer equilibrium under its own amelioration: $b_{p}  \\eta \\sigma$.\n\nStarting from these principles, derive analytically the minimal facilitation strength $\\sigma^{\\ast}$ such that the competitor $C$ can invade the pioneer-only equilibrium in the pioneer-dominated environment. Under Assumptions 3–4, such invasion implies eventual replacement of $P$ by $C$.\n\nYour final answer must be the closed-form expression for $\\sigma^{\\ast}$ in terms of the model parameters $\\{r_{p}, r_{c}, \\eta, S_{0}, b_{p}, \\kappa\\}$ only. Do not approximate or round. Express the final answer as a single algebraic expression without units.", "solution": "The problem requires the derivation of the minimal facilitation strength, denoted $\\sigma^{\\ast}$, that allows the competitor species, $C$, to invade an environment dominated by the pioneer species, $P$. This analysis will be conducted within the framework of the provided continuous-time competition model.\n\nThe dynamics of the system in a patch dominated by the pioneer species, where stress $S$ is ameliorated according to $S = S_{0} - \\sigma P$, are given by substituting this expression for $S$ into the general population equations.\n\nFor the pioneer species $P$:\n$$ \\dfrac{dP}{dt} = P\\left[r_{p} - \\eta (S_{0} - \\sigma P) - b_{p} P - \\theta C\\right] $$\n$$ \\dfrac{dP}{dt} = P\\left[(r_{p} - \\eta S_{0}) - (b_{p} - \\eta\\sigma)P - \\theta C\\right] $$\n\nFor the competitor species $C$:\n$$ \\dfrac{dC}{dt} = C\\left[r_{c} - (S_{0} - \\sigma P) - b_{c} C - \\kappa P\\right] $$\n$$ \\dfrac{dC}{dt} = C\\left[(r_{c} - S_{0}) + (\\sigma - \\kappa)P - b_{c} C\\right] $$\n\nThe first step is to determine the equilibrium state of the pioneer in the absence of the competitor. This is the pioneer-only equilibrium, which we find by setting $C=0$ and $\\frac{dP}{dt}=0$.\n$$ \\dfrac{dP}{dt} = P\\left[(r_{p} - \\eta S_{0}) - (b_{p} - \\eta\\sigma)P\\right] = 0 $$\nThis equation has two solutions for $P$: the trivial equilibrium $P=0$ and a non-trivial equilibrium $P^{\\ast}$ given by:\n$$ (r_{p} - \\eta S_{0}) - (b_{p} - \\eta\\sigma)P^{\\ast} = 0 $$\nSolving for $P^{\\ast}$ yields:\n$$ P^{\\ast} = \\dfrac{r_{p} - \\eta S_{0}}{b_{p} - \\eta\\sigma} $$\nFor this equilibrium to be biologically meaningful (i.e., a positive biomass that is stable), two conditions must be met. First, the numerator must be positive, $r_{p} - \\eta S_{0}  0$, which is guaranteed by Assumption $1$. Second, the denominator must be positive, $b_{p} - \\eta\\sigma  0$, which is guaranteed by Assumption $5$. Thus, $P^{\\ast}$ represents a valid and stable pioneer-only equilibrium.\n\nThe next step is to analyze the condition under which the competitor species $C$ can invade this pioneer-dominated system. Invasion is possible if the initial per-capita growth rate of $C$ is positive when its population is infinitesimally small ($C \\approx 0$) and the pioneer is at its equilibrium density ($P = P^{\\ast}$). The per-capita growth rate of $C$ is $\\frac{1}{C}\\frac{dC}{dt}$.\n$$ \\left. \\dfrac{1}{C}\\dfrac{dC}{dt} \\right|_{C \\to 0} = (r_{c} - S_{0}) + (\\sigma - \\kappa)P $$\nThe invasion condition is that this rate is positive when evaluated at $P = P^{\\ast}$:\n$$ (r_{c} - S_{0}) + (\\sigma - \\kappa)P^{\\ast}  0 $$\nNow, we substitute the expression for $P^{\\ast}$ into this inequality:\n$$ (r_{c} - S_{0}) + (\\sigma - \\kappa)\\left(\\dfrac{r_{p} - \\eta S_{0}}{b_{p} - \\eta\\sigma}\\right)  0 $$\nTo solve for $\\sigma$, we rearrange the inequality. First, move the first term to the other side:\n$$ (\\sigma - \\kappa)\\left(\\dfrac{r_{p} - \\eta S_{0}}{b_{p} - \\eta\\sigma}\\right)  -(r_{c} - S_{0}) $$\n$$ (\\sigma - \\kappa)\\left(\\dfrac{r_{p} - \\eta S_{0}}{b_{p} - \\eta\\sigma}\\right)  S_{0} - r_{c} $$\nSince $b_{p} - \\eta\\sigma  0$ by Assumption $5$, we can multiply both sides by it without changing the direction of the inequality:\n$$ (\\sigma - \\kappa)(r_{p} - \\eta S_{0})  (S_{0} - r_{c})(b_{p} - \\eta\\sigma) $$\nExpand both sides of the inequality:\n$$ \\sigma(r_{p} - \\eta S_{0}) - \\kappa(r_{p} - \\eta S_{0})  b_{p}(S_{0} - r_{c}) - \\eta\\sigma(S_{0} - r_{c}) $$\nNow, we collect all terms involving $\\sigma$ on the left-hand side:\n$$ \\sigma(r_{p} - \\eta S_{0}) + \\eta\\sigma(S_{0} - r_{c})  b_{p}(S_{0} - r_{c}) + \\kappa(r_{p} - \\eta S_{0}) $$\nFactor out $\\sigma$:\n$$ \\sigma \\left[ (r_{p} - \\eta S_{0}) + \\eta(S_{0} - r_{c}) \\right]  b_{p}(S_{0} - r_{c}) + \\kappa(r_{p} - \\eta S_{0}) $$\nSimplify the term in the brackets on the left-hand side:\n$$ (r_{p} - \\eta S_{0}) + \\eta S_{0} - \\eta r_{c} = r_{p} - \\eta r_{c} $$\nThe inequality becomes:\n$$ \\sigma(r_{p} - \\eta r_{c})  b_{p}(S_{0} - r_{c}) + \\kappa(r_{p} - \\eta S_{0}) $$\nTo isolate $\\sigma$, we must divide by $(r_{p} - \\eta r_{c})$. The sign of this term determines whether the inequality direction is preserved. For a facilitation mechanism to enable invasion, higher values of $\\sigma$ should make invasion more likely. This requires the coefficient of $\\sigma$, $(r_{p} - \\eta r_{c})$, to be positive. If it were negative, a larger $\\sigma$ would hinder invasion, which contradicts the premise of facilitation. Thus, we proceed assuming $r_{p} - \\eta r_{c}  0$. Dividing by this positive term, we get:\n$$ \\sigma  \\dfrac{b_{p}(S_{0} - r_{c}) + \\kappa(r_{p} - \\eta S_{0})}{r_{p} - \\eta r_{c}} $$\nThis inequality defines the condition on the facilitation strength $\\sigma$ for the competitor to invade. The minimal facilitation strength, $\\sigma^{\\ast}$, is the threshold value at which this inequality becomes an equality. Therefore, the expression for $\\sigma^{\\ast}$ is:\n$$ \\sigma^{\\ast} = \\dfrac{\\kappa(r_{p} - \\eta S_{0}) + b_{p}(S_{0} - r_{c})}{r_{p} - \\eta r_{c}} $$\nThis expression for $\\sigma^{\\ast}$ is exclusively in terms of the specified parameters $\\{r_{p}, r_{c}, \\eta, S_{0}, b_{p}, \\kappa\\}$, as required.\nThe numerator is positive because Assumption $1$ gives $r_{p} - \\eta S_{0}  0$, Assumption $2$ gives $S_{0} - r_{c}  0$, and parameters $\\kappa, b_p$ are positive. The denominator $r_{p} - \\eta r_{c}$ is assumed positive for a meaningful facilitation threshold to exist.", "answer": "$$\n\\boxed{\\dfrac{\\kappa(r_{p} - \\eta S_{0}) + b_{p}(S_{0} - r_{c})}{r_{p} - \\eta r_{c}}}\n$$", "id": "2794094"}, {"introduction": "Real-world succession unfolds from the interplay of many species competing within a dynamic disturbance regime. This final practice challenges you to synthesize these elements by building a computational model that simulates community-level dynamics over time. By implementing a multi-species Lotka-Volterra model and subjecting it to discrete disturbance events, you will predict the trajectory of community composition and validate your model's output against observational data, bridging the crucial gap between theoretical population dynamics and applied ecological forecasting [@problem_id:2794128].", "problem": "Consider a set of species undergoing succession in a homogeneous habitat where population dynamics are governed by pairwise resource competition. Assume the following fundamental base and modeling assumptions: (i) the per-capita growth of each species follows logistic growth in the absence of other species, (ii) interspecific competition is additive and captured by parameterized pairwise competition coefficients estimated from experiments, (iii) external disturbances occur at specified times and instantaneously reduce population densities by species-specific survival fractions, and (iv) there is no immigration. The continuous-time dynamics for species $i$ with density $N_i(t)$ are assumed to be of the Lotka–Volterra competition form derived from logistic growth and pairwise additive effects:\n$$\n\\frac{dN_i}{dt} \\;=\\; r_i \\, N_i \\,\\Bigg(1 - \\frac{\\sum_{j=1}^{S} \\alpha_{ij} \\, N_j}{K_i}\\Bigg),\n$$\nwhere $S$ is the number of species, $r_i$ is the intrinsic rate of increase, $K_i$ is the carrying capacity in the absence of competitors, and $\\alpha_{ij}$ is the competition coefficient measuring the effect of species $j$ on species $i$ in units of species $i$. Assume $\\alpha_{ii} = 1$ for all $i$. Disturbances at specified times $t \\in \\mathcal{D}$ instantaneously multiply each density by its survival fraction $s_i \\in [0,1]$.\n\nYour task is to write a program that, given parameterized pairwise competition coefficients and other demographic parameters, predicts community composition through time and validates it against observed successional trajectories using the Bray–Curtis dissimilarity. For a compositional vector $\\mathbf{p}$ and an observed compositional vector $\\mathbf{q}$ at the same time, the Bray–Curtis dissimilarity is\n$$\n\\mathrm{BC}(\\mathbf{p},\\mathbf{q}) \\;=\\; \\frac{\\sum_{i=1}^{S} |p_i - q_i|}{\\sum_{i=1}^{S} (p_i + q_i)}.\n$$\nBecause both $\\mathbf{p}$ and $\\mathbf{q}$ are relative abundances that sum to $1$, the denominator equals $2$, and thus $\\mathrm{BC}(\\mathbf{p},\\mathbf{q}) = \\tfrac{1}{2}\\sum_{i=1}^{S} |p_i - q_i|$.\n\nNumerical prediction requirement: Implement a forward-Euler explicit time discretization with a fixed time step $\\Delta t$ (in years) to integrate the continuous-time dynamics. At each step from time $t$ to $t + \\Delta t$,\n$$\nN_i(t+\\Delta t) \\;=\\; N_i(t) \\;+\\; \\Delta t \\; r_i \\, N_i(t)\\,\\Bigg(1 - \\frac{\\sum_{j=1}^{S} \\alpha_{ij} \\, N_j(t)}{K_i}\\Bigg).\n$$\nAfter updating to time $t+\\Delta t$, enforce nonnegativity by setting any negative $N_i$ to $0$. If $t+\\Delta t$ coincides with an observation time $\\tau \\in \\mathcal{T}_{\\mathrm{obs}}$, record the relative abundance vector $\\mathbf{p}(\\tau)$ with entries $p_i(\\tau) = N_i(\\tau) / \\sum_{k=1}^{S} N_k(\\tau)$. If $t+\\Delta t$ coincides with a disturbance time in $\\mathcal{D}$, then immediately after recording the observation (if any) at that same time, apply the disturbance by multiplying $N_i(\\tau)$ by the survival fraction $s_i$. This defines a consistent ordering when observation and disturbance times coincide: record composition immediately before applying the disturbance.\n\nValidation requirement: For each test case, compute the Bray–Curtis dissimilarity at all observation times and return the arithmetic mean of these dissimilarities as a single floating-point number (dimensionless). Your program must produce a single line of output containing the results for all test cases as a comma-separated list of these mean dissimilarities enclosed in square brackets (for example, \"[0.123456,0.234567,0.345678]\"). Round each value to exactly six decimal places. All densities are in individuals per square meter (ind m$^{-2}$), and time is in years. The output metric is dimensionless.\n\nTest suite: Use the following three test cases. In each case, $S = 3$, the time step is $\\Delta t = 0.01$ years, and all observation times and disturbance times are expressed in years.\n\n- Test case A (moderate interspecific competition; late-successional dominance emerges under mild disturbances):\n  - Parameters:\n    - Intrinsic rates $r = (1.20, 0.80, 0.50)$ yr$^{-1}$.\n    - Carrying capacities $K = (100.0, 120.0, 150.0)$ ind m$^{-2}$.\n    - Competition matrix $\\alpha$ with rows\n      - Row $1$: $(1.00, 0.60, 0.90)$,\n      - Row $2$: $(0.70, 1.00, 0.80)$,\n      - Row $3$: $(0.20, 0.30, 1.00)$.\n    - Initial densities $N_0 = (5.00, 1.00, 0.10)$ ind m$^{-2}$.\n    - Disturbance times $\\mathcal{D} = \\{5.00, 15.00, 30.00\\}$ with uniform survival fractions $s = (0.50, 0.50, 0.50)$.\n    - Observation times $\\mathcal{T}_{\\mathrm{obs}} = \\{1.00, 5.00, 10.00, 20.00, 40.00\\}$; simulate to $T_{\\max} = 40.00$ years.\n  - Observed successional composition at observation times (rows correspond to times in order $1.00, 5.00, 10.00, 20.00, 40.00$):\n    - $(0.70, 0.25, 0.05)$,\n    - $(0.60, 0.30, 0.10)$,\n    - $(0.40, 0.35, 0.25)$,\n    - $(0.20, 0.30, 0.50)$,\n    - $(0.10, 0.20, 0.70)$.\n\n- Test case B (neutral boundary; symmetric competition with frequent strong disturbances; composition remains near initial proportions):\n  - Parameters:\n    - Intrinsic rates $r = (0.80, 0.80, 0.80)$ yr$^{-1}$.\n    - Carrying capacities $K = (100.00, 100.00, 100.00)$ ind m$^{-2}$.\n    - Competition matrix $\\alpha$ with rows\n      - Row $1$: $(1.00, 1.00, 1.00)$,\n      - Row $2$: $(1.00, 1.00, 1.00)$,\n      - Row $3$: $(1.00, 1.00, 1.00)$.\n    - Initial densities $N_0 = (30.00, 30.00, 40.00)$ ind m$^{-2}$.\n    - Disturbance times $\\mathcal{D} = \\{2.00, 4.00, 6.00, 8.00, 10.00, 12.00, 14.00, 16.00\\}$ with uniform survival fractions $s = (0.10, 0.10, 0.10)$.\n    - Observation times $\\mathcal{T}_{\\mathrm{obs}} = \\{1.00, 2.00, 4.00, 8.00, 16.00\\}$; simulate to $T_{\\max} = 16.00$ years.\n  - Observed successional composition at observation times (rows correspond to times in order $1.00, 2.00, 4.00, 8.00, 16.00$):\n    - $(0.30, 0.30, 0.40)$,\n    - $(0.31, 0.29, 0.40)$,\n    - $(0.29, 0.31, 0.40)$,\n    - $(0.30, 0.30, 0.40)$,\n    - $(0.30, 0.30, 0.40)$.\n\n- Test case C (asymmetric strong exclusion by a competitively superior species; a disturbance differentially reduces the superior species, but long-term dominance still emerges):\n  - Parameters:\n    - Intrinsic rates $r = (1.00, 0.70, 0.60)$ yr$^{-1}$.\n    - Carrying capacities $K = (80.00, 200.00, 120.00)$ ind m$^{-2}$.\n    - Competition matrix $\\alpha$ with rows\n      - Row $1$: $(1.00, 1.20, 0.90)$,\n      - Row $2$: $(0.40, 1.00, 0.50)$,\n      - Row $3$: $(0.80, 1.10, 1.00)$.\n    - Initial densities $N_0 = (2.00, 0.50, 0.50)$ ind m$^{-2}$.\n    - Disturbance times $\\mathcal{D} = \\{8.00, 20.00\\}$ with survival fractions $s = (0.60, 0.30, 0.60)$.\n    - Observation times $\\mathcal{T}_{\\mathrm{obs}} = \\{2.00, 8.00, 12.00, 24.00, 36.00\\}$; simulate to $T_{\\max} = 36.00$ years.\n  - Observed successional composition at observation times (rows correspond to times in order $2.00, 8.00, 12.00, 24.00, 36.00$):\n    - $(0.60, 0.25, 0.15)$,\n    - $(0.55, 0.20, 0.25)$,\n    - $(0.40, 0.40, 0.20)$,\n    - $(0.20, 0.60, 0.20)$,\n    - $(0.10, 0.75, 0.15)$.\n\nImplementation details and output specification:\n- Use the forward-Euler update specified above with time step $\\Delta t = 0.01$ years.\n- At any time equal to both an observation time and a disturbance time, record the composition immediately before applying the disturbance.\n- For each test case, compute the mean of the Bray–Curtis dissimilarities across all observation times.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (for example, \"[0.123456,0.234567,0.345678]\"), where each value is rounded to exactly six decimal places.", "solution": "The problem as stated is well-defined, scientifically sound, and internally consistent. It presents a standard task in computational ecology: the numerical simulation of a multi-species Lotka-Volterra competition model, subject to discrete disturbance events, and the subsequent validation of the model's output against a set of provided observational data. We may therefore proceed directly to the formulation of the solution.\n\nThe core of the problem is to solve the system of coupled, nonlinear ordinary differential equations that govern the population dynamics of $S$ competing species. For each species $i$, the rate of change of its density $N_i$ is given by:\n$$\n\\frac{dN_i}{dt} \\;=\\; r_i \\, N_i \\,\\Bigg(1 - \\frac{\\sum_{j=1}^{S} \\alpha_{ij} \\, N_j}{K_i}\\Bigg)\n$$\nwhere $r_i$ is the intrinsic rate of increase, $K_i$ is the carrying capacity, and the matrix $\\alpha$ contains the competition coefficients $\\alpha_{ij}$, with the intraspecific coefficients defined as $\\alpha_{ii} = 1$.\n\nAn analytical solution to this system is generally intractable, necessitating a numerical approach. The problem specifies the use of the forward Euler method, an explicit first-order integration scheme. With a fixed time step of $\\Delta t$, the population density vector $\\mathbf{N}(t) = (N_1(t), \\dots, N_S(t))^\\top$ is propagated from time $t$ to $t + \\Delta t$ according to the iterative formula:\n$$\nN_i(t+\\Delta t) \\;=\\; N_i(t) \\;+\\; \\Delta t \\; r_i \\, N_i(t)\\,\\Bigg(1 - \\frac{\\sum_{j=1}^{S} \\alpha_{ij} \\, N_j(t)}{K_i}\\Bigg)\n$$\nThis update is performed for all species $i=1, \\dots, S$. A critical step, reflecting biological reality, is the enforcement of a non-negativity constraint: should any $N_i(t+\\Delta t)$ compute to a negative value, it is immediately set to $0$.\n\nThe continuous dynamics are punctuated by discrete events: observations and disturbances. A robust numerical implementation must handle these events at their precise scheduled times. Comparing floating-point representations of time is prone to error. The correct and rigorous procedure is to discretize the entire simulation timeline by converting all event times into integer time-step indices. For a maximum simulation time $T_{\\max}$ and time step $\\Delta t$, the simulation will run for a total of $n_{\\text{steps}} = \\text{round}(T_{\\max} / \\Delta t)$ steps. An event scheduled at time $t_{\\text{event}}$ is thus mapped to the integer step index $k_{\\text{event}} = \\text{round}(t_{\\text{event}} / \\Delta t)$.\n\nThe simulation algorithm is structured as a loop that iterates from step $k=1$ to $n_{\\text{steps}}$:\n1.  **Integration**: The population vector $\\mathbf{N}$ is updated from its state at step $k-1$ to its state at step $k$ using the forward Euler formula. Non-negativity is enforced on the resulting $\\mathbf{N}$ vector.\n2.  **Observation**: We check if the current step index $k$ matches a scheduled observation step. If it does, the predicted relative abundance vector, $\\mathbf{p}$, is calculated from the current absolute densities $\\mathbf{N}$ (where $p_i = N_i / \\sum_j N_j$). This predicted composition $\\mathbf{p}$ is then compared to the corresponding observed composition $\\mathbf{q}$ using the Bray-Curtis dissimilarity. Since both $\\mathbf{p}$ and $\\mathbf{q}$ are normalized to sum to $1$, the formula simplifies to $\\mathrm{BC}(\\mathbf{p},\\mathbf{q}) = \\frac{1}{2}\\sum_{i=1}^{S} |p_i - q_i|$. The resulting dissimilarity value is recorded.\n3.  **Disturbance**: We then check if step $k$ matches a scheduled disturbance step. If so, a disturbance is applied by multiplying each species' density $N_i$ by its specified survival fraction $s_i$, such that $N_i \\leftarrow N_i \\cdot s_i$. The problem specifies that an observation at a given time occurs immediately before a disturbance at the same time. The sequential execution of steps (2) and (3) within the loop for a given step index $k$ correctly implements this ordering.\n\nAfter the simulation completes at $T_{\\max}$, the final required output for each test case is the arithmetic mean of all recorded Bray-Curtis dissimilarity values. This entire procedure will be implemented using the `numpy` library to facilitate efficient vectorized computations for the population vector and parameter arrays. The algorithm will be encapsulated in a function that processes a single test case, and a main driver will iterate through all test cases to produce the final formatted output.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef run_simulation(r, K, alpha, N0, s, dist_times, obs_times, obs_data, T_max, dt):\n    \"\"\"\n    Runs the Lotka-Volterra competition simulation with disturbances for one test case.\n\n    Args:\n        r (tuple): Intrinsic rates of increase.\n        K (tuple): Carrying capacities.\n        alpha (list of lists): Competition matrix.\n        N0 (tuple): Initial densities.\n        s (tuple): Survival fractions.\n        dist_times (set): Set of disturbance times.\n        obs_times (tuple): Tuple of observation times.\n        obs_data (list of tuples): Observed compositions at observation times.\n        T_max (float): Maximum simulation time.\n        dt (float): Time step for integration.\n\n    Returns:\n        float: The mean Bray-Curtis dissimilarity over all observation times.\n    \"\"\"\n    # Convert parameters to numpy arrays for vectorized operations\n    r = np.array(r, dtype=np.float64)\n    K = np.array(K, dtype=np.float64)\n    alpha = np.array(alpha, dtype=np.float64)\n    N = np.array(N0, dtype=np.float64)\n    s_vec = np.array(s, dtype=np.float64)\n\n    # Create event maps based on integer step indices for robust time handling\n    obs_data_map = {t: np.array(q) for t, q in zip(obs_times, obs_data)}\n    obs_step_data_map = {int(round(t / dt)): q for t, q in obs_data_map.items()}\n    dist_step_map = {int(round(t / dt)): s_vec for t in dist_times}\n\n    num_steps = int(round(T_max / dt))\n    bray_curtis_dissimilarities = []\n\n    for step in range(1, num_steps + 1):\n        # Forward Euler integration step\n        # dN/dt = r*N*(1 - (alpha @ N) / K)\n        competition_term = alpha @ N\n        dN_dt = r * N * (1.0 - competition_term / K)\n        N += dt * dN_dt\n\n        # Enforce non-negativity constraint\n        N[N  0] = 0.0\n\n        # Check for observation event at the end of the current time step\n        if step in obs_step_data_map:\n            observed_q = obs_step_data_map[step]\n            \n            # Calculate predicted relative abundance, p\n            total_density = np.sum(N)\n            # Handle case where all species are extinct to avoid division by zero\n            if total_density > 1e-12:\n                predicted_p = N / total_density\n            else:\n                predicted_p = np.zeros_like(N)\n            \n            # Calculate Bray-Curtis dissimilarity: 0.5 * sum(|p_i - q_i|)\n            bc_dissimilarity = 0.5 * np.sum(np.abs(predicted_p - observed_q))\n            bray_curtis_dissimilarities.append(bc_dissimilarity)\n\n        # Check for disturbance event (occurs after observation at the same time)\n        if step in dist_step_map:\n            survival_fractions = dist_step_map[step]\n            N *= survival_fractions\n    \n    return np.mean(bray_curtis_dissimilarities) if bray_curtis_dissimilarities else 0.0\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Test Case A\n        {\n            \"r\": (1.20, 0.80, 0.50), \"K\": (100.0, 120.0, 150.0),\n            \"alpha\": [[1.00, 0.60, 0.90], [0.70, 1.00, 0.80], [0.20, 0.30, 1.00]],\n            \"N0\": (5.00, 1.00, 0.10), \"s\": (0.50, 0.50, 0.50),\n            \"dist_times\": {5.00, 15.00, 30.00},\n            \"obs_times\": (1.00, 5.00, 10.00, 20.00, 40.00),\n            \"obs_data\": [\n                (0.70, 0.25, 0.05), (0.60, 0.30, 0.10), (0.40, 0.35, 0.25),\n                (0.20, 0.30, 0.50), (0.10, 0.20, 0.70)\n            ],\n            \"T_max\": 40.00, \"dt\": 0.01\n        },\n        # Test Case B\n        {\n            \"r\": (0.80, 0.80, 0.80), \"K\": (100.00, 100.00, 100.00),\n            \"alpha\": [[1.00, 1.00, 1.00], [1.00, 1.00, 1.00], [1.00, 1.00, 1.00]],\n            \"N0\": (30.00, 30.00, 40.00), \"s\": (0.10, 0.10, 0.10),\n            \"dist_times\": {2.00, 4.00, 6.00, 8.00, 10.00, 12.00, 14.00, 16.00},\n            \"obs_times\": (1.00, 2.00, 4.00, 8.00, 16.00),\n            \"obs_data\": [\n                (0.30, 0.30, 0.40), (0.31, 0.29, 0.40), (0.29, 0.31, 0.40),\n                (0.30, 0.30, 0.40), (0.30, 0.30, 0.40)\n            ],\n            \"T_max\": 16.00, \"dt\": 0.01\n        },\n        # Test Case C\n        {\n            \"r\": (1.00, 0.70, 0.60), \"K\": (80.00, 200.00, 120.00),\n            \"alpha\": [[1.00, 1.20, 0.90], [0.40, 1.00, 0.50], [0.80, 1.10, 1.00]],\n            \"N0\": (2.00, 0.50, 0.50), \"s\": (0.60, 0.30, 0.60),\n            \"dist_times\": {8.00, 20.00},\n            \"obs_times\": (2.00, 8.00, 12.00, 24.00, 36.00),\n            \"obs_data\": [\n                (0.60, 0.25, 0.15), (0.55, 0.20, 0.25), (0.40, 0.40, 0.20),\n                (0.20, 0.60, 0.20), (0.10, 0.75, 0.15)\n            ],\n            \"T_max\": 36.00, \"dt\": 0.01\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        mean_bc = run_simulation(\n            r=case[\"r\"], K=case[\"K\"], alpha=case[\"alpha\"], N0=case[\"N0\"],\n            s=case[\"s\"], dist_times=case[\"dist_times\"], obs_times=case[\"obs_times\"],\n            obs_data=case[\"obs_data\"], T_max=case[\"T_max\"], dt=case[\"dt\"]\n        )\n        results.append(f\"{mean_bc:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "2794128"}]}