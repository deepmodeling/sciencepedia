{"hands_on_practices": [{"introduction": "A cornerstone of metabolic engineering and systems biology is understanding the flow of matter and energy through biochemical networks. While standard Gibbs free energy change, $\\Delta G^{\\circ \\prime}$, provides a valuable baseline, it's the actual Gibbs free energy, $\\Delta G$, that determines a reaction's spontaneity under the specific, non-standard conditions inside a living cell. This exercise [@problem_id:2840913] provides hands-on practice in applying the fundamental thermodynamic relationship $\\Delta G = \\Delta G^{\\circ \\prime} + RT \\ln Q$ to assess the real-world feasibility of a reaction within a biosynthetic pathway, a critical skill for troubleshooting and optimizing metabolic fluxes.", "problem": "You are engineering a modular biosynthetic pathway in Escherichia coli (E. coli) to produce a small-molecule therapeutic. At steady state in a chemostat, one key internal step, denoted by the generic reaction $\\sum_i \\nu_i A_i = 0$, has a tabulated biochemical standard transformed Gibbs free energy change $\\Delta G^{\\circ \\prime} = -20\\,\\text{kJ mol}^{-1}$ at $T = 298\\,\\text{K}$. Direct metabolomics quantification under your operating conditions yields an effective reaction quotient $Q = 10$ (activities approximated by concentrations). Assume ideal solution behavior and that the biochemical standard state applies. Take the universal gas constant as $R = 8.314\\,462\\,618\\,\\text{J mol}^{-1}\\text{K}^{-1}$.\n\nStarting from the definition of chemical potential $ \\mu_i = \\mu_i^{\\circ \\prime} + RT \\ln a_i $ and the expression for the reaction Gibbs energy change as a stoichiometric sum of chemical potentials, derive the appropriate expression for the nonstandard reaction Gibbs energy $\\Delta G$ as a function of $Q$, and then evaluate $\\Delta G$ numerically for the given data. Use this value to assess, from first principles, whether the step is thermodynamically feasible in the forward direction under the measured conditions and how far the step operates from equilibrium in the context of pathway flux control.\n\nReport only the numerical value of $\\Delta G$ as your final answer. Express $\\Delta G$ in $\\text{kJ mol}^{-1}$ and round to $4$ significant figures. Do not include units in your final reported answer.", "solution": "The problem statement is subjected to validation before any attempt at a solution.\n\nStep 1: Extraction of Givens.\n- Generic reaction: $\\sum_i \\nu_i A_i = 0$\n- Biochemical standard transformed Gibbs free energy change: $\\Delta G^{\\circ \\prime} = -20\\,\\text{kJ mol}^{-1}$\n- Temperature: $T = 298\\,\\text{K}$\n- Effective reaction quotient: $Q = 10$\n- Universal gas constant: $R = 8.314\\,462\\,618\\,\\text{J mol}^{-1}\\text{K}^{-1}$\n- Starting relation for chemical potential: $\\mu_i = \\mu_i^{\\circ \\prime} + RT \\ln a_i$\n- Starting concept: Reaction Gibbs energy change is a stoichiometric sum of chemical potentials.\n- Assumptions: Ideal solution behavior, biochemical standard state applies.\n- Required output: Numerical value of the nonstandard reaction Gibbs energy $\\Delta G$ in $\\text{kJ mol}^{-1}$, rounded to $4$ significant figures.\n\nStep 2: Validation of Extracted Givens.\nThe problem is scientifically grounded, being based on fundamental principles of chemical thermodynamics as applied to biochemistry. It is well-posed, providing all necessary data ($\\Delta G^{\\circ \\prime}$, $T$, $R$, $Q$) and a clear directive to derive a known thermodynamic relationship and then compute a value. The language is objective and precise. The data are physically and dimensionally consistent. The problem does not violate any of the criteria for invalidity.\n\nStep 3: Verdict and Action.\nThe problem is deemed valid. A full solution will be provided.\n\nThe derivation begins with the fundamental definition of the reaction Gibbs energy change, $\\Delta G$, for a reaction $\\sum_i \\nu_i A_i = 0$, where $\\nu_i$ are the stoichiometric coefficients (positive for products, negative for reactants). This change is the stoichiometric sum of the chemical potentials, $\\mu_i$, of the participating species:\n$$ \\Delta G = \\sum_i \\nu_i \\mu_i $$\nThe problem provides the relationship between the chemical potential $\\mu_i$ under nonstandard conditions and the standard transformed chemical potential $\\mu_i^{\\circ \\prime}$, where $a_i$ is the activity of species $i$:\n$$ \\mu_i = \\mu_i^{\\circ \\prime} + RT \\ln a_i $$\nSubstituting this expression into the equation for $\\Delta G$:\n$$ \\Delta G = \\sum_i \\nu_i (\\mu_i^{\\circ \\prime} + RT \\ln a_i) $$\nWe distribute the summation across the two terms:\n$$ \\Delta G = \\sum_i \\nu_i \\mu_i^{\\circ \\prime} + \\sum_i \\nu_i RT \\ln a_i $$\nThe first term, $\\sum_i \\nu_i \\mu_i^{\\circ \\prime}$, is by definition the biochemical standard transformed Gibbs free energy change for the reaction, $\\Delta G^{\\circ \\prime}$. The second term can be manipulated by bringing the constant factor $RT$ outside the summation:\n$$ \\Delta G = \\Delta G^{\\circ \\prime} + RT \\sum_i \\nu_i \\ln a_i $$\nUsing the property of logarithms, $c \\ln x = \\ln(x^c)$, we rewrite the sum:\n$$ \\Delta G = \\Delta G^{\\circ \\prime} + RT \\sum_i \\ln(a_i^{\\nu_i}) $$\nUsing another property of logarithms, $\\sum_i \\ln x_i = \\ln(\\prod_i x_i)$, the summation is consolidated into a single logarithm term:\n$$ \\Delta G = \\Delta G^{\\circ \\prime} + RT \\ln \\left( \\prod_i a_i^{\\nu_i} \\right) $$\nThe product term, $\\prod_i a_i^{\\nu_i}$, is the definition of the reaction quotient, $Q$. It represents the ratio of product activities to reactant activities, each raised to the power of its stoichiometric coefficient.\n$$ Q = \\prod_i a_i^{\\nu_i} $$\nTherefore, the final expression for the nonstandard reaction Gibbs energy change is:\n$$ \\Delta G = \\Delta G^{\\circ \\prime} + RT \\ln Q $$\nThis completes the derivation. Now, we evaluate $\\Delta G$ numerically. The given values are:\n$\\Delta G^{\\circ \\prime} = -20\\,\\text{kJ mol}^{-1}$\n$R = 8.314\\,462\\,618\\,\\text{J mol}^{-1}\\text{K}^{-1}$\n$T = 298\\,\\text{K}$\n$Q = 10$\n\nTo maintain unit consistency during calculation, $\\Delta G^{\\circ \\prime}$ must be converted to $\\text{J mol}^{-1}$:\n$$ \\Delta G^{\\circ \\prime} = -20 \\times 10^3\\,\\text{J mol}^{-1} $$\nSubstituting the numerical values into the derived equation:\n$$ \\Delta G = -20 \\times 10^3\\,\\text{J mol}^{-1} + (8.314\\,462\\,618\\,\\text{J mol}^{-1}\\text{K}^{-1}) \\times (298\\,\\text{K}) \\times \\ln(10) $$\nFirst, we calculate the product $RT \\ln(10)$:\n$$ RT \\ln(10) \\approx (8.314\\,462\\,618) \\times (298) \\times (2.302\\,585) \\approx 5705.05\\,\\text{J mol}^{-1} $$\nNow, we compute $\\Delta G$:\n$$ \\Delta G \\approx -20000 + 5705.05 = -14294.95\\,\\text{J mol}^{-1} $$\nThe problem requires the answer in $\\text{kJ mol}^{-1}$:\n$$ \\Delta G \\approx -14.29495\\,\\text{kJ mol}^{-1} $$\nRounding to $4$ significant figures as instructed gives:\n$$ \\Delta G \\approx -14.29\\,\\text{kJ mol}^{-1} $$\nFor the assessment:\n1.  **Thermodynamic Feasibility:** The calculated value $\\Delta G = -14.29\\,\\text{kJ mol}^{-1}$ is negative. A negative $\\Delta G$ indicates that the forward reaction is spontaneous and thermodynamically favorable under the specified intracellular conditions.\n2.  **Distance from Equilibrium:** Equilibrium is defined by the condition $\\Delta G = 0$. The calculated value is substantially different from zero, indicating that the reaction operates far from equilibrium. In the context of metabolic pathway analysis, reactions with large, negative $\\Delta G$ values are considered effectively irreversible. Such steps are often critical points for the regulation of metabolic flux. The large thermodynamic driving force helps to pull metabolites through the pathway and ensures a robust unidirectional flow, which is a desirable characteristic in a biosynthetic pathway engineered for production.", "answer": "$$\\boxed{-14.29}$$", "id": "2840913"}, {"introduction": "Synthetic biology aims to design and build genetic circuits with predictable behaviors, such as switching or oscillation. The genetic toggle switch, a motif of two mutually repressing genes, is a canonical example of a synthetic memory element. This practice problem [@problem_id:2840929] delves into the core principles of nonlinear dynamics that enable such behavior, tasking you with deriving the conditions for bistability from scratch. By using phase-plane analysis to find the bifurcation point where the system gains multiple stable states, you will develop a deep, quantitative understanding of how molecular parameters like synthesis rate and cooperativity ($n$) govern the emergence of complex system-level properties.", "problem": "Consider the two-gene mutual-repression toggle governed by the ordinary differential equations (ODEs)\n$$\n\\frac{dx}{dt}=\\frac{\\alpha}{1+\\left(\\frac{y}{K_y}\\right)^{n}}-\\gamma x,\\qquad\n\\frac{dy}{dt}=\\frac{\\alpha}{1+\\left(\\frac{x}{K_x}\\right)^{n}}-\\gamma y,\n$$\nwhere $x$ and $y$ denote protein concentrations, $\\alpha$ is the maximal synthesis rate, $\\gamma$ is the first-order degradation/dilution rate, $K_x$ and $K_y$ are dissociation constants for repression, and $n$ is the Hill cooperativity. Assume the standard Hill repression form is justified by rapid promoter bindingâ€“unbinding relative to protein dynamics and that synthesis and degradation are homogeneous in time.\n\nYour task is to derive, from first principles of phase-plane analysis and bifurcation geometry, a closed-form expression for the minimal synthesis rate $\\,\\alpha_c\\,$ as a function of $\\,\\gamma$, $\\,K$, and $\\,n\\,$ that marks the onset of tristability (i.e., exactly three real fixed points) in the symmetric case $\\,K_x=K_y=K\\,$. Your derivation must start from the nullcline definitions and a precise tangency condition for the creation of additional fixed points by coalescence. You may nondimensionalize if convenient, but the final result must be given for $\\,\\alpha_c\\,$ in original parameters.\n\nReport your final result as a single analytic expression for $\\,\\alpha_c\\,$ in terms of $\\,\\gamma$, $\\,K$, and $\\,n$. Do not include units in your boxed answer. No numerical rounding is required. Clearly state any necessary condition(s) on $\\,n\\,$ that emerge as part of the guarantee of three real fixed points.", "solution": "The problem requires the derivation of the minimal synthesis rate, $\\alpha_c$, for which a symmetric genetic toggle switch exhibits exactly three fixed points. This condition corresponds to the onset of bistability, which arises from a saddle-node bifurcation where two new fixed points are created. The derivation will proceed from the governing ordinary differential equations (ODEs) using phase-plane analysis.\n\nThe provided system of ODEs is:\n$$\n\\frac{dx}{dt} = \\frac{\\alpha}{1+\\left(\\frac{y}{K_y}\\right)^{n}}-\\gamma x\n$$\n$$\n\\frac{dy}{dt} = \\frac{\\alpha}{1+\\left(\\frac{x}{K_x}\\right)^{n}}-\\gamma y\n$$\nWe are given the symmetric case, where $K_x = K_y = K$.\n$$\n\\frac{dx}{dt} = \\frac{\\alpha}{1+\\left(\\frac{y}{K}\\right)^{n}}-\\gamma x\n$$\n$$\n\\frac{dy}{dt} = \\frac{\\alpha}{1+\\left(\\frac{x}{K}\\right)^{n}}-\\gamma y\n$$\nFixed points of the system are found by setting the time derivatives to zero: $\\frac{dx}{dt} = 0$ and $\\frac{dy}{dt} = 0$. This defines the nullclines of the system.\nThe $x$-nullcline is given by:\n$$\n\\gamma x = \\frac{\\alpha}{1+\\left(\\frac{y}{K}\\right)^{n}}\n$$\nThe $y$-nullcline is given by:\n$$\n\\gamma y = \\frac{\\alpha}{1+\\left(\\frac{x}{K}\\right)^{n}}\n$$\nTo simplify the analysis, we nondimensionalize the system. Let $u = \\frac{x}{K}$, $v = \\frac{y}{K}$, and $\\tau = \\gamma t$. This implies $t = \\frac{\\tau}{\\gamma}$, $x=Ku$, and $y=Kv$. Substituting these into the first ODE:\n$$\n\\frac{d(Ku)}{d(\\tau/\\gamma)} = \\frac{\\alpha}{1+v^n} - \\gamma (Ku) \\implies \\gamma K \\frac{du}{d\\tau} = \\frac{\\alpha}{1+v^n} - \\gamma K u\n$$\nDividing by $\\gamma K$ gives the dimensionless form:\n$$\n\\frac{du}{d\\tau} = \\frac{\\alpha}{\\gamma K} \\frac{1}{1+v^n} - u\n$$\nLet us define the dimensionless synthesis rate $\\beta = \\frac{\\alpha}{\\gamma K}$. The full dimensionless system is:\n$$\n\\frac{du}{d\\tau} = \\frac{\\beta}{1+v^n} - u\n$$\n$$\n\\frac{dv}{d\\tau} = \\frac{\\beta}{1+u^n} - v\n$$\nThe nullclines in this dimensionless plane are $u = \\frac{\\beta}{1+v^n}$ and $v = \\frac{\\beta}{1+u^n}$. The fixed points are the intersections of these two curves. Due to the symmetry of the equations, one fixed point always lies on the line $u=v$. The appearance of additional fixed points (from one to three) occurs at a saddle-node bifurcation. Geometrically, this bifurcation point is where the two nullcline curves become tangent to each other.\n\nLet the function defining the nullclines be $f(z) = \\frac{\\beta}{1+z^n}$. The nullclines are $u = f(v)$ and $v = f(u)$. The slope of the first nullcline in the $(u,v)$-plane is found by differentiating with respect to $u$: $1 = f'(v) \\frac{dv}{du}$, so $\\frac{dv}{du} = \\frac{1}{f'(v)}$. The slope of the second nullcline is $\\frac{dv}{du} = f'(u)$.\n\nAt the point of tangency $(u_c, v_c)$, the slopes must be equal:\n$$\nf'(u_c) = \\frac{1}{f'(v_c)}\n$$\nBecause of the system's symmetry, the tangency that creates the new pair of fixed points occurs on the diagonal line $u=v$. Therefore, $u_c = v_c$. The condition becomes:\n$$\nf'(u_c) = \\frac{1}{f'(u_c)} \\implies (f'(u_c))^2 = 1\n$$\nThe derivative of $f(u)$ with respect to $u$ is:\n$$\nf'(u) = \\frac{d}{du}\\left(\\frac{\\beta}{1+u^n}\\right) = -\\frac{\\beta n u^{n-1}}{\\left(1+u^n\\right)^2}\n$$\nSince protein concentrations $u$ are non-negative, and all parameters $\\beta, n$ are positive, $f'(u)$ is always negative for $u>0$. Thus, the tangency condition must be:\n$$\nf'(u_c) = -1\n$$\nThis gives our first equation for the critical point. The second equation is that the point $(u_c, u_c)$ must lie on the nullcline itself:\n$$\nu_c = f(u_c) = \\frac{\\beta_c}{1+u_c^n}\n$$\nHere, $\\beta_c$ is the critical value of $\\beta$ at which the bifurcation occurs. We now solve this system of two equations for the two unknowns $u_c$ and $\\beta_c$.\n\nFrom $f'(u_c) = -1$:\n$$\n-\\frac{\\beta_c n u_c^{n-1}}{(1+u_c^n)^2} = -1 \\implies \\beta_c n u_c^{n-1} = (1+u_c^n)^2\n$$\nFrom the nullcline equation, we have $\\beta_c = u_c(1+u_c^n)$. Substituting this into the slope equation:\n$$\n\\left(u_c(1+u_c^n)\\right) n u_c^{n-1} = (1+u_c^n)^2\n$$\nAssuming $1+u_c^n \\neq 0$, which is always true for non-negative $u_c$, we can divide by $(1+u_c^n)$:\n$$\nn u_c^n = 1+u_c^n\n$$\n$$\n(n-1)u_c^n = 1 \\implies u_c^n = \\frac{1}{n-1}\n$$\nFor a real, positive solution for $u_c$ to exist, we must have $\\frac{1}{n-1} > 0$, which imposes a necessary condition on the Hill cooperativity:\n$$\nn > 1\n$$\nIf $n \\le 1$, the cooperativity is insufficient to produce the required switching behavior, and only one fixed point will ever exist.\n\nNow, we solve for the critical dimensionless synthesis rate, $\\beta_c$. From $u_c^n = \\frac{1}{n-1}$, we get $u_c = \\left(\\frac{1}{n-1}\\right)^{1/n} = (n-1)^{-1/n}$. Substituting this and $u_c^n$ back into the nullcline equation for $\\beta_c$:\n$$\n\\beta_c = u_c(1+u_c^n) = (n-1)^{-1/n} \\left(1 + \\frac{1}{n-1}\\right)\n$$\n$$\n\\beta_c = (n-1)^{-1/n} \\left(\\frac{n-1+1}{n-1}\\right) = (n-1)^{-1/n} \\left(\\frac{n}{n-1}\\right)\n$$\n$$\n\\beta_c = n \\cdot (n-1)^{-1} \\cdot (n-1)^{-1/n} = n (n-1)^{-(1 + 1/n)} = n (n-1)^{-(n+1)/n}\n$$\nThis is the dimensionless critical synthesis rate. To find the final answer $\\alpha_c$, we re-dimensionalize:\n$$\n\\beta_c = \\frac{\\alpha_c}{\\gamma K} \\implies \\alpha_c = \\beta_c \\gamma K\n$$\nSubstituting the expression for $\\beta_c$:\n$$\n\\alpha_c = \\gamma K n (n-1)^{-(n+1)/n}\n$$\nThis can also be written as:\n$$\n\\alpha_c = \\frac{\\gamma K n}{(n-1)^{(n+1)/n}}\n$$\nThis expression gives the minimal synthesis rate $\\alpha_c$ required for the system to have three fixed points, contingent on the condition that the Hill coefficient $n>1$.", "answer": "$$\\boxed{\\frac{\\gamma K n}{(n-1)^{(n+1)/n}}}$$", "id": "2840929"}, {"introduction": "Mathematical models are central to systems biology, but they are only as good as the parameters they employ. A crucial skill is the ability to estimate these parameters from experimental data. This exercise [@problem_id:2840935] provides a practical, hands-on opportunity to connect theory with data by fitting the Hill function, a ubiquitous model for cooperative processes, to a set of dose-response measurements. You will implement a common linearization technique using a logit transform and apply ordinary least squares regression to not only estimate the Hill coefficient but also to quantify the uncertainty of your estimate by constructing a confidence interval.", "problem": "You are given measurements of an input (dose) $A_i$ and an output (response) $y_i$ that arises from a promoter or receptor exhibiting cooperative binding commonly modeled by the Hill function in systems and synthetic biology. The Hill input-output function is defined by\n$$\ny = \\frac{A^n}{K^n + A^n},\n$$\nwhere $A$ is the input, $y$ is the normalized output ($0 &lt; y &lt; 1$), $n$ is the Hill coefficient, and $K$ is the input producing half-maximal response.\n\nFundamental base: The Hill function is a well-tested phenomenological model for cooperative binding and transcriptional regulation. For $0 &lt; y &lt; 1$, the logit transform is defined by $\\operatorname{logit}(y) = \\ln\\!\\left(\\frac{y}{1-y}\\right)$. Ordinary Least Squares (OLS) linear regression for a model $Z = \\beta_0 + \\beta_1 X + \\varepsilon$ under homoscedastic Gaussian errors yields unbiased estimators for $\\beta_0$ and $\\beta_1$, with sampling distributions enabling confidence intervals based on the Student $t$ distribution.\n\nTask: By deriving from the definitions above, construct a linear regression approach that estimates the Hill coefficient $n$ via a linearization that uses the logit transform and natural logarithm. Assume that homoscedastic Gaussian errors apply in the transformed (linearized) domain. Use two-sided confidence intervals at confidence level $0.95$ based on the Student $t$ distribution with $N-2$ degrees of freedom for $N$ data points. Report the estimate of $n$ and the lower and upper endpoints of its confidence interval as real numbers.\n\nImplementation requirements:\n- Use the natural logarithm for all logarithms.\n- Perform OLS on the linearized data to obtain the slope and its standard error.\n- Construct a two-sided confidence interval for $n$ at level $0.95$ using the appropriate critical value from the Student $t$ distribution.\n- No weights are to be used; assume homoscedasticity in the transformed domain.\n\nTest suite:\nApply your program to each of the following three test cases. For each case, use the provided dose-response pairs $\\{(A_i, y_i)\\}_{i=1}^N$. All numbers are to be used as given.\n\n- Test case 1:\n  - $A = [1, 5, 10, 20, 50, 100, 200, 500]$\n  - $y = [0.0051, 0.0643, 0.1242, 0.2566, 0.5000, 0.6900, 0.8447, 0.9379]$\n\n- Test case 2:\n  - $A = [0.2, 0.5, 1.0, 2.0, 5.0, 10.0]$\n  - $y = [0.0020, 0.01238, 0.1151, 0.5000, 0.93385, 0.98806]$\n\n- Test case 3:\n  - $A = [0.05, 0.1, 0.2, 0.5, 1.0, 2.0, 5.0]$\n  - $y = [0.0597, 0.1059, 0.1623, 0.2984, 0.4197, 0.5592, 0.7207]$\n\nAngle units do not apply. No physical units are involved. All outputs must be real-valued numbers.\n\nFinal output format:\n- Your program should produce a single line of output containing the results for the three test cases as a JSON-like list of lists. Each inner list must contain three floating-point numbers in this order: the estimate of $n$, the lower endpoint of the $0.95$ confidence interval, and the upper endpoint of the $0.95$ confidence interval.\n- Each number must be rounded to exactly four decimal places.\n- The printed line must have the following form:\n  - For example, $[\\,[n_1,\\ell_1,u_1],[n_2,\\ell_2,u_2],[n_3,\\ell_3,u_3]\\,]$, where $n_j$, $\\ell_j$, and $u_j$ are floats rounded to four decimals corresponding to test case $j$.\n\nYour program must not read any input and must not print anything else.", "solution": "The problem as stated is valid. It is scientifically grounded in the established principles of biochemical modeling and statistical inference, is well-posed with a clear objective, and provides all necessary information for a unique solution. The task is to estimate the Hill coefficient, $n$, from dose-response data pairs $(A_i, y_i)$ by linearizing the Hill function and applying Ordinary Least Squares (OLS) regression.\n\nThe Hill function is given by:\n$$\ny = \\frac{A^n}{K^n + A^n}\n$$\nHere, $y$ is the normalized response, which is constrained to $0 < y < 1$, $A$ is the input concentration, $n$ is the Hill coefficient quantifying cooperativity, and $K$ is the dissociation constant, representing the input concentration that yields a half-maximal response.\n\nThe problem requires a linearization of this function using the logit transform, which is defined for a probability or proportion $p$ as $\\operatorname{logit}(p) = \\ln\\left(\\frac{p}{1-p}\\right)$. Applying this transformation to the response variable $y$ requires us to first express the ratio $\\frac{y}{1-y}$ in terms of the model parameters.\n\nFirst, we find an expression for $1-y$:\n$$\n1-y = 1 - \\frac{A^n}{K^n + A^n} = \\frac{(K^n + A^n) - A^n}{K^n + A^n} = \\frac{K^n}{K^n + A^n}\n$$\nNow, we can form the ratio $\\frac{y}{1-y}$:\n$$\n\\frac{y}{1-y} = \\frac{\\frac{A^n}{K^n + A^n}}{\\frac{K^n}{K^n + A^n}} = \\frac{A^n}{K^n} = \\left(\\frac{A}{K}\\right)^n\n$$\nTo achieve a linear relationship, we take the natural logarithm of both sides, as suggested by the problem statement:\n$$\n\\ln\\left(\\frac{y}{1-y}\\right) = \\ln\\left(\\left(\\frac{A}{K}\\right)^n\\right)\n$$\nUsing the properties of logarithms, we can simplify the equation:\n$$\n\\ln\\left(\\frac{y}{1-y}\\right) = n \\ln\\left(\\frac{A}{K}\\right) = n (\\ln(A) - \\ln(K))\n$$\nRearranging this gives the final linear form:\n$$\n\\ln\\left(\\frac{y}{1-y}\\right) = n \\ln(A) - n \\ln(K)\n$$\nThis equation conforms to the standard linear model $Z = \\beta_1 X + \\beta_0$, where we make the following identifications:\n-   The transformed response variable is $Z = \\ln\\left(\\frac{y}{1-y}\\right)$.\n-   The transformed input variable is $X = \\ln(A)$.\n-   The slope of the line is $\\beta_1 = n$.\n-   The intercept of the line is $\\beta_0 = -n \\ln(K)$.\n\nThe primary goal is to estimate the Hill coefficient $n$. Based on our linearization, the estimate of $n$ is simply the estimate of the slope, $\\hat{\\beta}_1$, from an OLS regression of $Z$ on $X$. Given $N$ data points $\\{(A_i, y_i)\\}_{i=1}^N$, we first transform them into a linear-domain dataset $\\{(X_i, Z_i)\\}_{i=1}^N$. The OLS estimator for the slope $\\beta_1$ is given by:\n$$\n\\hat{\\beta}_1 = \\frac{\\sum_{i=1}^N (X_i - \\bar{X})(Z_i - \\bar{Z})}{\\sum_{i=1}^N (X_i - \\bar{X})^2}\n$$\nwhere $\\bar{X}$ and $\\bar{Z}$ are the sample means of the transformed data. Our estimate for the Hill coefficient is thus $\\hat{n} = \\hat{\\beta}_1$.\n\nThe problem also requires the construction of a $95\\%$ confidence interval for $n$. The general form for a two-sided confidence interval for a regression slope is:\n$$\n\\hat{\\beta}_1 \\pm t_{\\alpha/2, N-2} \\cdot \\text{SE}(\\hat{\\beta}_1)\n$$\nHere:\n-   $\\hat{\\beta}_1$ is our estimated slope, $\\hat{n}$.\n-   $\\text{SE}(\\hat{\\beta}_1)$ is the standard error of the slope estimate.\n-   $N$ is the number of data points.\n-   The degrees of freedom for the $t$-distribution are $df = N-2$.\n-   For a $95\\%$ confidence level, the significance level is $\\alpha = 0.05$. We need the critical value $t_{0.025, N-2}$ from the Student's $t$-distribution, which is the value such that $P(T > t_{0.025, N-2}) = 0.025$ for a $t$-distributed random variable $T$ with $N-2$ degrees of freedom.\n\nThe standard error of the slope, $\\text{SE}(\\hat{\\beta}_1)$, is calculated as:\n$$\n\\text{SE}(\\hat{\\beta}_1) = \\sqrt{\\frac{\\text{MSE}}{\\sum_{i=1}^N (X_i - \\bar{X})^2}}\n$$\nwhere MSE is the Mean Squared Error of the residuals:\n$$\n\\text{MSE} = \\frac{\\text{SSE}}{N-2} = \\frac{1}{N-2}\\sum_{i=1}^N (Z_i - \\hat{Z}_i)^2\n$$\nand $\\hat{Z}_i = \\hat{\\beta}_0 + \\hat{\\beta}_1 X_i$ are the predicted values from the regression. The assumption of homoscedastic Gaussian errors in the transformed $(X,Z)$ space justifies this procedure.\n\nThe computational procedure for each test case is as follows:\n1.  Given data arrays $A$ and $y$, calculate the transformed variables $X = \\ln(A)$ and $Z = \\ln(y/(1-y))$.\n2.  Perform an OLS linear regression of $Z$ on $X$ to obtain the slope estimate $\\hat{n} = \\hat{\\beta}_1$ and its standard error $\\text{SE}(\\hat{n}) = \\text{SE}(\\hat{\\beta}_1)$.\n3.  Determine the number of data points $N$ and calculate the degrees of freedom $df = N-2$.\n4.  Find the critical $t$-value, $t_{\\text{crit}} = t_{0.025, df}$.\n5.  Calculate the margin of error, $ME = t_{\\text{crit}} \\cdot \\text{SE}(\\hat{n})$.\n6.  Construct the confidence interval as $[\\hat{n} - ME, \\hat{n} + ME]$.\n7.  Report the results $\\hat{n}$, the lower bound, and the upper bound, each rounded to four decimal places.\nThis provides a complete and statistically rigorous method to fulfill the requirements of the problem.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.stats import linregress, t\n\ndef solve():\n    \"\"\"\n    Estimates the Hill coefficient and its confidence interval from dose-response data\n    by linearizing the Hill equation and using Ordinary Least Squares regression.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (\n            np.array([1, 5, 10, 20, 50, 100, 200, 500], dtype=float),\n            np.array([0.0051, 0.0643, 0.1242, 0.2566, 0.5000, 0.6900, 0.8447, 0.9379], dtype=float)\n        ),\n        (\n            np.array([0.2, 0.5, 1.0, 2.0, 5.0, 10.0], dtype=float),\n            np.array([0.0020, 0.01238, 0.1151, 0.5000, 0.93385, 0.98806], dtype=float)\n        ),\n        (\n            np.array([0.05, 0.1, 0.2, 0.5, 1.0, 2.0, 5.0], dtype=float),\n            np.array([0.0597, 0.1059, 0.1623, 0.2984, 0.4197, 0.5592, 0.7207], dtype=float)\n        )\n    ]\n\n    results = []\n    confidence_level = 0.95\n    alpha = 1 - confidence_level\n\n    for A, y in test_cases:\n        # Step 1: Linearize the data\n        # The Hill equation y = A^n / (K^n + A^n) is linearized to\n        # log(y / (1 - y)) = n*log(A) - n*log(K).\n        # This is of the form Z = beta1*X + beta0, where:\n        # Z = log(y / (1 - y))\n        # X = log(A)\n        # beta1 = n (Hill coefficient)\n        \n        # Ensure inputs to log are positive\n        if np.any(A <= 0) or np.any(y <= 0) or np.any(y >= 1):\n             # This case should not happen with the provided data\n             # but is good practice to handle.\n             raise ValueError(\"Invalid input data for logarithmic transformation.\")\n\n        X_transformed = np.log(A)\n        Z_transformed = np.log(y / (1 - y))\n\n        # Step 2: Perform Ordinary Least Squares (OLS) linear regression\n        # `linregress` returns slope, intercept, r_value, p_value, and std_err of the slope\n        regression_result = linregress(X_transformed, Z_transformed)\n        \n        n_estimate = regression_result.slope\n        se_n = regression_result.stderr\n\n        # Step 3: Construct the confidence interval for the slope (n)\n        N = len(A)\n        df = N - 2  # Degrees of freedom for t-distribution\n\n        # Get the critical value from the Student's t-distribution for a two-sided interval\n        t_critical = t.ppf(1 - alpha / 2, df)\n\n        # Calculate the margin of error\n        margin_of_error = t_critical * se_n\n\n        # Calculate the lower and upper bounds of the confidence interval\n        lower_bound = n_estimate - margin_of_error\n        upper_bound = n_estimate + margin_of_error\n\n        results.append([n_estimate, lower_bound, upper_bound])\n\n    # Final print statement in the exact required format.\n    # Each number is rounded to four decimal places.\n    output_parts = []\n    for res in results:\n        formatted_res = f\"[{res[0]:.4f},{res[1]:.4f},{res[2]:.4f}]\"\n        output_parts.append(formatted_res)\n    \n    print(f\"[{','.join(output_parts)}]\")\n\nsolve()\n```", "id": "2840935"}]}