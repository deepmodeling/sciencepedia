{"hands_on_practices": [{"introduction": "Understanding the complexity of a microbial community begins with quantifying its diversity. This foundational exercise guides you through the calculation of three essential alpha diversity metrics using hypothetical sequencing data. By computing species richness, the Shannon index, and the Simpson index, you will gain hands-on practice in characterizing a community's structure and learn to distinguish how each metric uniquely emphasizes either the number of taxa or their evenness in abundance. [@problem_id:2806593]", "problem": "A murine gut content sample is profiled by $16$S ribosomal ribonucleic acid (rRNA) gene amplicon sequencing, and four bacterial taxa are resolved at the genus level with read counts: taxon A has $40$, taxon B has $30$, taxon C has $20$, and taxon D has $10$. Treat the counts as a proxy for relative abundances in this host–microbiome community. Using core ecological definitions of alpha diversity derived from probability and information theory, compute the following diversity metrics for this single community:\n- species richness,\n- Shannon diversity using natural logarithms (base $e$),\n- the Simpson concentration index (report the concentration form $D$, not the Gini–Simpson or inverse form).\n\nBriefly interpret, in the context of host–microbiome ecology, which aspect of diversity each metric emphasizes, based on its mathematical construction and weighting of taxa.\n\nExpress all numerical results as unitless values and round all numerical answers to four significant figures. Provide the final answer as a row matrix in the order $\\left(S,\\ H,\\ D\\right)$.", "solution": "The problem presented is scientifically grounded, well-posed, and contains all necessary information for a definitive solution. We shall proceed with the analysis.\n\nThe problem requires the calculation of three standard alpha diversity metrics for a microbial community and an interpretation of their ecological meaning. The community consists of four taxa, labeled A, B, C, and D, with read counts $n_A = 40$, $n_B = 30$, $n_C = 20$, and $n_D = 10$. These counts are used as a proxy for the abundance of each taxon.\n\nFirst, we determine the total number of reads, $N$, which is the sum of the counts for all taxa:\n$$N = \\sum_{i=1}^{S} n_i = n_A + n_B + n_C + n_D = 40 + 30 + 20 + 10 = 100$$\nwhere $S$ is the number of taxa.\n\nNext, we calculate the relative abundance, $p_i$, for each taxon $i$. The relative abundance is the proportion of reads for a given taxon relative to the total number of reads: $p_i = \\frac{n_i}{N}$.\n\nThe relative abundances are:\n- Taxon A: $p_A = \\frac{40}{100} = 0.4$\n- Taxon B: $p_B = \\frac{30}{100} = 0.3$\n- Taxon C: $p_C = \\frac{20}{100} = 0.2$\n- Taxon D: $p_D = \\frac{10}{100} = 0.1$\n\nThe sum of these proportions must be unity: $\\sum_{i=1}^{S} p_i = 0.4 + 0.3 + 0.2 + 0.1 = 1.0$.\n\nWith these relative abundances, we can now compute the required diversity metrics.\n\n1.  **Species Richness ($S$)**:\n    Species richness is the total number of distinct taxa in the community. It is a simple count. In this sample, there are four distinct taxa (A, B, C, D).\n    $$S = 4$$\n    Per the problem's formatting requirements for numerical answers, this will be expressed to four significant figures as $4.000$.\n\n2.  **Shannon Diversity Index ($H$)**:\n    The Shannon diversity index, using the natural logarithm as specified, is calculated by the formula:\n    $$H = -\\sum_{i=1}^{S} p_i \\ln(p_i)$$\n    Substituting the calculated relative abundances:\n    $$H = - \\left( p_A \\ln(p_A) + p_B \\ln(p_B) + p_C \\ln(p_C) + p_D \\ln(p_D) \\right)$$\n    $$H = - \\left( 0.4 \\ln(0.4) + 0.3 \\ln(0.3) + 0.2 \\ln(0.2) + 0.1 \\ln(0.1) \\right)$$\n    Numerically evaluating each term:\n    - $0.4 \\ln(0.4) \\approx 0.4 \\times (-0.91629) = -0.366516$\n    - $0.3 \\ln(0.3) \\approx 0.3 \\times (-1.20397) = -0.361191$\n    - $0.2 \\ln(0.2) \\approx 0.2 \\times (-1.60944) = -0.321888$\n    - $0.1 \\ln(0.1) \\approx 0.1 \\times (-2.30259) = -0.230259$\n    Summing these values and taking the negative:\n    $$H \\approx -(-0.366516 - 0.361191 - 0.321888 - 0.230259) = -(-1.279854) = 1.279854$$\n    Rounding to four significant figures, we get:\n    $$H \\approx 1.280$$\n\n3.  **Simpson Concentration Index ($D$)**:\n    The Simpson concentration index, $D$, is defined as the sum of the squared relative abundances of all taxa:\n    $$D = \\sum_{i=1}^{S} p_i^2$$\n    This index represents the probability that two individuals taken at random from the community belong to the same species.\n    $$D = p_A^2 + p_B^2 + p_C^2 + p_D^2$$\n    $$D = (0.4)^2 + (0.3)^2 + (0.2)^2 + (0.1)^2$$\n    $$D = 0.16 + 0.09 + 0.04 + 0.01 = 0.30$$\n    Expressed to four significant figures, this is:\n    $$D = 0.3000$$\n\n**Interpretation of Metrics:**\nThe problem also requires an interpretation of each metric in the context of host-microbiome ecology.\n\n- **Species Richness ($S$)**: This metric solely quantifies the number of unique taxa present. Its mathematical construction is a simple count, so it gives equal importance to all taxa, regardless of their abundance. In microbiome studies, it is highly sensitive to the presence of rare taxa and sequencing depth. It describes the variety of taxa but provides no information about their relative population sizes or balance within the community.\n\n- **Shannon Diversity ($H$)**: This index combines richness and evenness. Derived from information theory, $H = -\\sum p_i \\ln(p_i)$ quantifies the uncertainty (or \"surprise\") in identifying a randomly sampled microbe. The logarithmic weighting means that it is moderately sensitive to rare taxa, more so than the Simpson index but less so than richness. A high Shannon index indicates a community with many taxa that have comparable abundances (high evenness). It is widely used to represent the overall complexity of the microbiome.\n\n- **Simpson Concentration Index ($D$)**: This index, $D = \\sum p_i^2$, measures dominance. It calculates the probability that two randomly selected individuals will be from the same taxon. Due to the squaring of relative abundances ($p_i^2$), the most abundant taxa contribute disproportionately to the index value. Consequently, it is heavily weighted toward dominant taxa and is relatively insensitive to rare ones. A high value of $D$ indicates a community dominated by one or a few taxa (low diversity), a common feature in dysbiotic gut states.\n\nIn summary, richness counts the members, Shannon measures the uncertainty and balance, and Simpson measures the dominance of the most abundant members.", "answer": "$$\\boxed{\\begin{pmatrix} 4.000 & 1.280 & 0.3000 \\end{pmatrix}}$$", "id": "2806593"}, {"introduction": "Microbiome data are inherently compositional, where relative abundances in a sample sum to one. This property can invalidate standard statistical methods, making it crucial to use appropriate analytical techniques. This exercise introduces the centered log-ratio (clr) transformation, a cornerstone of compositional data analysis, allowing you to properly measure the dissimilarity between communities. By working through this problem, you will see why transforming the data is essential for meaningful ecological comparisons. [@problem_id:2806665]", "problem": "A host–microbiome survey records three dominant bacterial taxa in two hosts as closed compositions on the unit simplex, where each composition is a vector of strictly positive relative abundances that sums to $1$. Consider Host A with composition $\\mathbf{p}^{(A)} = (p_{1}^{(A)}, p_{2}^{(A)}, p_{3}^{(A)}) = (0.6, 0.3, 0.1)$ and Host B with composition $\\mathbf{p}^{(B)} = (p_{1}^{(B)}, p_{2}^{(B)}, p_{3}^{(B)}) = (0.4, 0.4, 0.2)$. Adopt the following foundational definitions from compositional data analysis and Euclidean geometry:\n- The geometric mean of a composition $\\mathbf{p} = (p_{1}, p_{2}, p_{3})$ is $g(\\mathbf{p}) = (p_{1} p_{2} p_{3})^{1/3}$.\n- The centered log-ratio (clr) transform (using the natural logarithm) maps $\\mathbf{p}$ to $\\operatorname{clr}(\\mathbf{p}) = \\mathbf{y}$ with components $y_{i} = \\ln\\!\\big(p_{i} / g(\\mathbf{p})\\big)$ for $i \\in \\{1,2,3\\}$.\n- The Euclidean distance between two vectors $\\mathbf{x}$ and $\\mathbf{y}$ in $\\mathbb{R}^{3}$ is $d(\\mathbf{x}, \\mathbf{y}) = \\sqrt{\\sum_{i=1}^{3} (x_{i} - y_{i})^{2}}$.\n\nUsing only these definitions as your starting point, do the following:\n1. Compute the clr-transformed vectors $\\operatorname{clr}(\\mathbf{p}^{(A)})$ and $\\operatorname{clr}(\\mathbf{p}^{(B)})$.\n2. Compute the Euclidean distance between the two hosts in raw proportion space, $d_{\\mathrm{raw}} = d(\\mathbf{p}^{(A)}, \\mathbf{p}^{(B)})$, and in clr space, $d_{\\mathrm{clr}} = d(\\operatorname{clr}(\\mathbf{p}^{(A)}), \\operatorname{clr}(\\mathbf{p}^{(B)}))$.\n3. Let $R = d_{\\mathrm{clr}} / d_{\\mathrm{raw}}$. Report the single numerical value of $R$.\n\nRound your final numerical answer for $R$ to four significant figures. Do not include units.", "solution": "The problem statement has been evaluated and is determined to be valid. It is self-contained, scientifically grounded in the principles of compositional data analysis, and mathematically well-posed. We will proceed with the solution.\n\nThe problem requires the computation of a ratio, $R = d_{\\mathrm{clr}} / d_{\\mathrm{raw}}$, where $d_{\\mathrm{raw}}$ is the Euclidean distance between two compositional vectors in their raw form, and $d_{\\mathrm{clr}}$ is the Euclidean distance between the same vectors after a centered log-ratio (clr) transformation. The host compositions are given as $\\mathbf{p}^{(A)} = (0.6, 0.3, 0.1)$ and $\\mathbf{p}^{(B)} = (0.4, 0.4, 0.2)$.\n\nFirst, we compute the Euclidean distance in the raw proportion space, $d_{\\mathrm{raw}}$.\n$$d_{\\mathrm{raw}} = d(\\mathbf{p}^{(A)}, \\mathbf{p}^{(B)}) = \\sqrt{\\sum_{i=1}^{3} (p_{i}^{(A)} - p_{i}^{(B)})^{2}}$$\nSubstituting the given values:\n$$d_{\\mathrm{raw}} = \\sqrt{(0.6 - 0.4)^{2} + (0.3 - 0.4)^{2} + (0.1 - 0.2)^{2}}$$\n$$d_{\\mathrm{raw}} = \\sqrt{(0.2)^{2} + (-0.1)^{2} + (-0.1)^{2}}$$\n$$d_{\\mathrm{raw}} = \\sqrt{0.04 + 0.01 + 0.01} = \\sqrt{0.06}$$\n\nNext, we compute the clr-transformed vectors. The clr transformation is defined by $y_{i} = \\ln(p_{i} / g(\\mathbf{p}))$, where $g(\\mathbf{p})$ is the geometric mean of the composition components.\n\nFor Host A, with $\\mathbf{p}^{(A)} = (0.6, 0.3, 0.1)$:\nThe geometric mean is $g(\\mathbf{p}^{(A)}) = (0.6 \\times 0.3 \\times 0.1)^{1/3} = (0.018)^{1/3}$.\nThe clr-transformed vector is $\\operatorname{clr}(\\mathbf{p}^{(A)}) = \\mathbf{y}^{(A)}$, with components:\n$$y_{1}^{(A)} = \\ln\\left(\\frac{0.6}{(0.018)^{1/3}}\\right), \\quad y_{2}^{(A)} = \\ln\\left(\\frac{0.3}{(0.018)^{1/3}}\\right), \\quad y_{3}^{(A)} = \\ln\\left(\\frac{0.1}{(0.018)^{1/3}}\\right)$$\n\nFor Host B, with $\\mathbf{p}^{(B)} = (0.4, 0.4, 0.2)$:\nThe geometric mean is $g(\\mathbf{p}^{(B)}) = (0.4 \\times 0.4 \\times 0.2)^{1/3} = (0.032)^{1/3}$.\nThe clr-transformed vector is $\\operatorname{clr}(\\mathbf{p}^{(B)}) = \\mathbf{y}^{(B)}$, with components:\n$$y_{1}^{(B)} = \\ln\\left(\\frac{0.4}{(0.032)^{1/3}}\\right), \\quad y_{2}^{(B)} = \\ln\\left(\\frac{0.4}{(0.032)^{1/3}}\\right), \\quad y_{3}^{(B)} = \\ln\\left(\\frac{0.2}{(0.032)^{1/3}}\\right)$$\n\nNow, we compute the Euclidean distance in clr space, $d_{\\mathrm{clr}}$.\n$$d_{\\mathrm{clr}} = d(\\operatorname{clr}(\\mathbf{p}^{(A)}), \\operatorname{clr}(\\mathbf{p}^{(B)})) = \\sqrt{\\sum_{i=1}^{3} (y_{i}^{(A)} - y_{i}^{(B)})^{2}}$$\nThe difference for each component $i$ is:\n$$y_{i}^{(A)} - y_{i}^{(B)} = \\ln\\left(\\frac{p_{i}^{(A)}}{g(\\mathbf{p}^{(A)})}\\right) - \\ln\\left(\\frac{p_{i}^{(B)}}{g(\\mathbf{p}^{(B)})}\\right) = \\ln\\left(\\frac{p_{i}^{(A)}}{p_{i}^{(B)}}\\right) - \\ln\\left(\\frac{g(\\mathbf{p}^{(A)})}{g(\\mathbf{p}^{(B)})}\\right)$$\nLet us compute the term $\\ln(g(\\mathbf{p}^{(A)})/g(\\mathbf{p}^{(B)}))$:\n$$\\ln\\left(\\frac{g(\\mathbf{p}^{(A)})}{g(\\mathbf{p}^{(B)})}\\right) = \\ln\\left(\\frac{(0.018)^{1/3}}{(0.032)^{1/3}}\\right) = \\frac{1}{3}\\ln\\left(\\frac{0.018}{0.032}\\right) = \\frac{1}{3}\\ln\\left(\\frac{18}{32}\\right) = \\frac{1}{3}\\ln\\left(\\frac{9}{16}\\right) = \\frac{1}{3}\\ln(0.5625)$$\nLet $z_i = \\ln(p_i^{(A)}/p_i^{(B)})$. The sum of squares is $d_{\\mathrm{clr}}^2 = \\sum_i (z_i - \\bar{z})^2$, where $\\bar{z} = \\frac{1}{3}\\sum_i z_i$. Note that $\\bar{z} = \\frac{1}{3}\\ln(g(\\mathbf{p}^{(A)})^3/g(\\mathbf{p}^{(B)})^3) = \\frac{1}{3}\\ln(0.018/0.032) = \\frac{1}{3}\\ln(0.5625)$.\nThe terms $z_i$ are:\n$$z_1 = \\ln\\left(\\frac{0.6}{0.4}\\right) = \\ln(1.5)$$\n$$z_2 = \\ln\\left(\\frac{0.3}{0.4}\\right) = \\ln(0.75)$$\n$$z_3 = \\ln\\left(\\frac{0.1}{0.2}\\right) = \\ln(0.5)$$\nThe squared distance $d_{\\mathrm{clr}}^2$ is the variance of $\\{z_1, z_2, z_3\\}$ multiplied by $3$, which can be calculated as $\\sum_i z_i^2 - 3\\bar{z}^2$.\n$$d_{\\mathrm{clr}}^2 = \\ln^2(1.5) + \\ln^2(0.75) + \\ln^2(0.5) - \\frac{1}{3}(\\ln(1.5) + \\ln(0.75) + \\ln(0.5))^2$$\n$$d_{\\mathrm{clr}}^2 = \\ln^2(1.5) + \\ln^2(0.75) + \\ln^2(0.5) - \\frac{1}{3}(\\ln(1.5 \\times 0.75 \\times 0.5))^2$$\n$$d_{\\mathrm{clr}}^2 = \\ln^2(1.5) + \\ln^2(0.75) + \\ln^2(0.5) - \\frac{1}{3}(\\ln(0.5625))^2$$\nNumerically:\n$$\\ln(1.5) \\approx 0.405465$$\n$$\\ln(0.75) \\approx -0.287682$$\n$$\\ln(0.5) \\approx -0.693147$$\n$$\\ln(0.5625) \\approx -0.575364$$\n$$d_{\\mathrm{clr}}^2 \\approx (0.405465)^2 + (-0.287682)^2 + (-0.693147)^2 - \\frac{1}{3}(-0.575364)^2$$\n$$d_{\\mathrm{clr}}^2 \\approx 0.164402 + 0.082761 + 0.480453 - \\frac{1}{3}(0.331044)$$\n$$d_{\\mathrm{clr}}^2 \\approx 0.727616 - 0.110348 = 0.617268$$\nSo, $d_{\\mathrm{clr}} = \\sqrt{0.617268}$.\n\nFinally, we compute the ratio $R$.\n$$R = \\frac{d_{\\mathrm{clr}}}{d_{\\mathrm{raw}}} = \\frac{\\sqrt{0.617268}}{\\sqrt{0.06}} = \\sqrt{\\frac{0.617268}{0.06}} = \\sqrt{10.2878}$$\n$$R \\approx 3.207459...$$\nRounding to four significant figures, we get $R = 3.207$.", "answer": "$$\\boxed{3.207}$$", "id": "2806665"}, {"introduction": "To understand the assembly and stability of host-associated microbial communities, we can turn to classic ecological models of species interactions. The Lotka-Volterra competition model provides a powerful framework for dissecting the mechanisms that allow multiple species to coexist. In this practice, you will derive the conditions for stable coexistence from first principles, connecting the mathematical formalism of stability analysis to the core ecological concept that coexistence is favored when intraspecific competition is stronger than interspecific competition. [@problem_id:2806602]", "problem": "A host harbors two gut commensal microbial populations with abundances $N_{1}(t)$ and $N_{2}(t)$ that change over time $t$ according to a two-species Lotka–Volterra competition model. The environment within the host is assumed to be constant over the considered time scale, there is no immigration, and demographic stochasticity is negligible. Let the intrinsic per-capita growth rate vector be $\\mathbf{r} = \\begin{pmatrix} r_{1} \\\\ r_{2} \\end{pmatrix}$ with $r_{1} > 0$ and $r_{2} > 0$, and let the interaction matrix be $A = \\begin{pmatrix} a_{11} & a_{12} \\\\ a_{21} & a_{22} \\end{pmatrix}$ with $a_{ij} > 0$ for all $i,j \\in \\{1,2\\}$. The dynamics are given by the ordinary differential equations (ODEs)\n$$\n\\frac{dN_{1}}{dt} \\,=\\, N_{1}\\,\\big(r_{1} - a_{11} N_{1} - a_{12} N_{2}\\big), \n\\qquad\n\\frac{dN_{2}}{dt} \\,=\\, N_{2}\\,\\big(r_{2} - a_{21} N_{1} - a_{22} N_{2}\\big).\n$$\nStarting from fundamental definitions of per-capita growth and linearization of equilibria, and without invoking any pre-assembled coexistence criteria, do the following:\n\n- Derive the interior equilibrium $\\big(N_{1}^{\\ast}, N_{2}^{\\ast}\\big)$ (the equilibrium with $N_{1}^{\\ast} > 0$ and $N_{2}^{\\ast} > 0$) in closed form in terms of $\\mathbf{r}$ and $A$.\n- Using the Jacobian linearization at the interior equilibrium, derive the necessary and sufficient inequalities on the parameters for local asymptotic stability of the interior equilibrium and show how they relate to feasibility ($N_{1}^{\\ast} > 0$ and $N_{2}^{\\ast} > 0$).\n- Interpret biologically, in the context of gut commensal competition for host-limited resources, each inequality you obtain in terms of intraspecific limitation, interspecific limitation, and mutual invasibility when rare.\n\nProvide your final answer as the explicit analytic expression for the coexistence equilibrium $\\big(N_{1}^{\\ast}, N_{2}^{\\ast}\\big)$ as a row vector in terms of $r_{1}, r_{2}, a_{11}, a_{12}, a_{21}, a_{22}$. No numerical evaluation is required.", "solution": "The problem statement has been validated and is deemed scientifically grounded, well-posed, and objective. It represents a standard, fundamental problem in theoretical ecology. We shall proceed with the derivation and analysis.\n\nThe dynamics of the two microbial populations are governed by the Lotka-Volterra competition model:\n$$\n\\frac{dN_{1}}{dt} \\,=\\, f_1(N_1, N_2) \\,=\\, N_{1}\\,\\big(r_{1} - a_{11} N_{1} - a_{12} N_{2}\\big)\n$$\n$$\n\\frac{dN_{2}}{dt} \\,=\\, f_2(N_1, N_2) \\,=\\, N_{2}\\,\\big(r_{2} - a_{21} N_{1} - a_{22} N_{2}\\big)\n$$\nwhere all parameters $r_1, r_2, a_{11}, a_{12}, a_{21}, a_{22}$ are positive constants.\n\nFirst, we derive the interior equilibrium point, denoted $\\big(N_{1}^{\\ast}, N_{2}^{\\ast}\\big)$. An equilibrium is a state where the population abundances do not change, which mathematically corresponds to setting the time derivatives to zero: $\\frac{dN_{1}}{dt} = 0$ and $\\frac{dN_{2}}{dt} = 0$.\n$$\nN_{1}^{\\ast}\\,\\big(r_{1} - a_{11} N_{1}^{\\ast} - a_{12} N_{2}^{\\ast}\\big) = 0\n$$\n$$\nN_{2}^{\\ast}\\,\\big(r_{2} - a_{21} N_{1}^{\\ast} - a_{22} N_{2}^{\\ast}\\big) = 0\n$$\nThe problem specifies the interior equilibrium, for which $N_{1}^{\\ast} > 0$ and $N_{2}^{\\ast} > 0$. This allows us to divide by $N_{1}^{\\ast}$ and $N_{2}^{\\ast}$ in the respective equations, which simplifies the system to a pair of linear algebraic equations for $N_{1}^{\\ast}$ and $N_{2}^{\\ast}$:\n$$\na_{11} N_{1}^{\\ast} + a_{12} N_{2}^{\\ast} = r_{1}\n$$\n$$\na_{21} N_{1}^{\\ast} + a_{22} N_{2}^{\\ast} = r_{2}\n$$\nThis system can be written in matrix form as $A \\mathbf{N}^{\\ast} = \\mathbf{r}$, where $\\mathbf{N}^{\\ast} = \\begin{pmatrix} N_{1}^{\\ast} \\\\ N_{2}^{\\ast} \\end{pmatrix}$. The solution is given by $\\mathbf{N}^{\\ast} = A^{-1} \\mathbf{r}$, provided that the interaction matrix $A$ is invertible, i.e., its determinant is non-zero. The determinant of $A$ is $\\det(A) = a_{11}a_{22} - a_{12}a_{21}$. The inverse of $A$ is:\n$$\nA^{-1} = \\frac{1}{a_{11}a_{22} - a_{12}a_{21}} \\begin{pmatrix} a_{22} & -a_{12} \\\\ -a_{21} & a_{11} \\end{pmatrix}\n$$\nThus, the equilibrium abundances are:\n$$\n\\begin{pmatrix} N_{1}^{\\ast} \\\\ N_{2}^{\\ast} \\end{pmatrix} = \\frac{1}{a_{11}a_{22} - a_{12}a_{21}} \\begin{pmatrix} a_{22} & -a_{12} \\\\ -a_{21} & a_{11} \\end{pmatrix} \\begin{pmatrix} r_{1} \\\\ r_{2} \\end{pmatrix} = \\frac{1}{\\det(A)} \\begin{pmatrix} a_{22}r_{1} - a_{12}r_{2} \\\\ a_{11}r_{2} - a_{21}r_{1} \\end{pmatrix}\n$$\nThis yields the explicit expressions for the interior equilibrium:\n$$\nN_{1}^{\\ast} = \\frac{r_{1} a_{22} - r_{2} a_{12}}{a_{11}a_{22} - a_{12}a_{21}}, \\qquad N_{2}^{\\ast} = \\frac{r_{2} a_{11} - r_{1} a_{21}}{a_{11}a_{22} - a_{12}a_{21}}\n$$\n\nSecond, we analyze the local asymptotic stability of this equilibrium using linearization. The Jacobian matrix $J$ of the system is given by the partial derivatives of $f_1$ and $f_2$:\n$$\nJ(N_1, N_2) = \\begin{pmatrix} \\frac{\\partial f_1}{\\partial N_1} & \\frac{\\partial f_1}{\\partial N_2} \\\\ \\frac{\\partial f_2}{\\partial N_1} & \\frac{\\partial f_2}{\\partial N_2} \\end{pmatrix} = \\begin{pmatrix} r_{1} - 2a_{11} N_{1} - a_{12} N_{2} & -a_{12} N_{1} \\\\ -a_{21} N_{2} & r_{2} - a_{21} N_{1} - 2a_{22} N_{2} \\end{pmatrix}\n$$\nWe evaluate this matrix at the interior equilibrium $(N_1^*, N_2^*)$. By definition of the equilibrium, we have $r_{1} - a_{11} N_{1}^{\\ast} - a_{12} N_{2}^{\\ast} = 0$ and $r_{2} - a_{21} N_{1}^{\\ast} - a_{22} N_{2}^{\\ast} = 0$. Using these relations, the diagonal elements of the Jacobian at the equilibrium, $J^* = J(N_1^*, N_2^*)$, simplify:\n$$\n\\frac{\\partial f_1}{\\partial N_1}\\bigg|_{(N_1^*, N_2^*)} = (r_{1} - a_{11} N_{1}^{\\ast} - a_{12} N_{2}^{\\ast}) - a_{11} N_{1}^{\\ast} = 0 - a_{11} N_{1}^{\\ast} = -a_{11} N_{1}^{\\ast}\n$$\n$$\n\\frac{\\partial f_2}{\\partial N_2}\\bigg|_{(N_1^*, N_2^*)} = (r_{2} - a_{21} N_{1}^{\\ast} - a_{22} N_{2}^{\\ast}) - a_{22} N_{2}^{\\ast} = 0 - a_{22} N_{2}^{\\ast} = -a_{22} N_{2}^{\\ast}\n$$\nThe Jacobian evaluated at the interior equilibrium is therefore:\n$$\nJ^{\\ast} = \\begin{pmatrix} -a_{11}N_1^{\\ast} & -a_{12}N_1^{\\ast} \\\\ -a_{21}N_2^{\\ast} & -a_{22}N_2^{\\ast} \\end{pmatrix}\n$$\nFor local asymptotic stability, all eigenvalues of $J^{\\ast}$ must have negative real parts. For a $2 \\times 2$ matrix, the Routh-Hurwitz stability criteria require that the trace of the matrix be negative and its determinant be positive.\nThe trace of $J^{\\ast}$ is $\\text{Tr}(J^{\\ast}) = -a_{11}N_1^{\\ast} - a_{22}N_2^{\\ast}$.\nThe determinant of $J^{\\ast}$ is $\\det(J^{\\ast}) = (-a_{11}N_1^{\\ast})(-a_{22}N_2^{\\ast}) - (-a_{12}N_1^{\\ast})(-a_{21}N_2^{\\ast}) = N_1^{\\ast}N_2^{\\ast}(a_{11}a_{22} - a_{12}a_{21}) = N_1^{\\ast}N_2^{\\ast}\\det(A)$.\n\nLet us analyze these two criteria under the condition of feasibility, i.e., $N_{1}^{\\ast} > 0$ and $N_{2}^{\\ast} > 0$.\n1.  **Trace condition**: $\\text{Tr}(J^{\\ast}) < 0$. Since $a_{11} > 0$, $a_{22} > 0$, $N_{1}^{\\ast} > 0$, and $N_{2}^{\\ast} > 0$, the trace $\\text{Tr}(J^{\\ast}) = -a_{11}N_1^{\\ast} - a_{22}N_2^{\\ast}$ is inherently negative. This condition is therefore automatically satisfied whenever the coexistence equilibrium is feasible.\n2.  **Determinant condition**: $\\det(J^{\\ast}) > 0$. Since $N_{1}^{\\ast} > 0$ and $N_{2}^{\\ast} > 0$, the term $N_{1}^{\\ast}N_{2}^{\\ast}$ is positive. The condition thus simplifies to $\\det(A) > 0$, which is $a_{11}a_{22} - a_{12}a_{21} > 0$.\n\nTherefore, the necessary and sufficient condition for local asymptotic stability of a feasible interior equilibrium is $a_{11}a_{22} > a_{12}a_{21}$.\n\nThird, we relate stability to feasibility and interpret the results biologically.\nThe feasibility conditions are $N_{1}^{\\ast} > 0$ and $N_{2}^{\\ast} > 0$. For a stable system where $\\det(A) > 0$, the denominators in the expressions for $N_{1}^{\\ast}$ and $N_{2}^{\\ast}$ are positive. Feasibility then requires the numerators to also be positive:\n(i) $r_{1} a_{22} - r_{2} a_{12} > 0 \\implies \\frac{r_1}{a_{12}} > \\frac{r_2}{a_{22}}$\n(ii) $r_{2} a_{11} - r_{1} a_{21} > 0 \\implies \\frac{r_2}{a_{21}} > \\frac{r_1}{a_{11}}$\n\nThe biological interpretation of these inequalities is as follows:\nThe term $K_1 = r_1/a_{11}$ represents the carrying capacity of species $1$ in the absence of species $2$. Likewise, $K_2 = r_2/a_{22}$ is the carrying capacity of species $2$. The coefficients $a_{ij}$ quantify the per-capita competitive effect of species $j$ on species $i$.\n\nThe inequality $a_{11}a_{22} > a_{12}a_{21}$ is the condition for stability. It can be rewritten as $\\frac{a_{11}}{a_{21}} > \\frac{a_{12}}{a_{22}}$ or as $1 > (\\frac{a_{12}}{a_{11}})(\\frac{a_{21}}{a_{22}})$. This means that the product of the intraspecific competition coefficients ($a_{11}, a_{22}$) must exceed the product of the interspecific competition coefficients ($a_{12}, a_{21}$). This is the principle that for stable coexistence, **intraspecific competition must be stronger than interspecific competition**. Each species must limit its own growth more than it limits the growth of its competitor. In the context of gut commensals, this implies some form of niche differentiation, where each species consumes a resource that is more limiting for itself than for its competitor.\n\nThe feasibility conditions are equivalent to the principle of **mutual invasibility**. Consider a scenario where species $1$ is rare ($N_1 \\approx 0$) and attempts to invade an environment where species $2$ is at its carrying capacity, $N_2 = K_2 = r_2/a_{22}$. The per-capita growth rate of species $1$ is then $\\frac{1}{N_1}\\frac{dN_1}{dt} \\approx r_1 - a_{12}K_2 = r_1 - a_{12} \\frac{r_2}{a_{22}}$. For the invasion to be successful, this rate must be positive, which requires $r_1 > a_{12} \\frac{r_2}{a_{22}}$. This rearranges to $r_1 a_{22} > r_2 a_{12}$, which is precisely the first feasibility condition (i).\nSymmetrically, for species $2$ to successfully invade a population of species $1$ at its carrying capacity $N_1 = K_1 = r_1/a_{11}$, its initial per-capita growth rate must be positive: $\\frac{1}{N_2}\\frac{dN_2}{dt} \\approx r_2 - a_{21}K_1 = r_2 - a_{21}\\frac{r_1}{a_{11}} > 0$. This rearranges to $r_2 a_{11} > r_1 a_{21}$, which is the second feasibility condition (ii).\n\nIn summary, stable coexistence of two competing microbial species in this model requires that each species limits itself more strongly than it limits the other (stronger intraspecific competition), and that each species is able to invade and grow from low numbers when the other is at its resource-limited carrying capacity (mutual invasibility). The mathematical conditions for local stability and feasibility are the direct formalization of these ecological principles.", "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{r_{1} a_{22} - r_{2} a_{12}}{a_{11}a_{22} - a_{12}a_{21}} & \\frac{r_{2} a_{11} - r_{1} a_{21}}{a_{11}a_{22} - a_{12}a_{21}} \\end{pmatrix}}\n$$", "id": "2806602"}]}