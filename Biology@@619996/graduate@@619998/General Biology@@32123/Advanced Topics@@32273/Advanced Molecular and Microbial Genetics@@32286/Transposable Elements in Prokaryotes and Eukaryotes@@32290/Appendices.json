{"hands_on_practices": [{"introduction": "The first step in studying transposable elements (TEs) in the genomic era is their accurate identification from sequencing data. This is a significant bioinformatic challenge, as true insertions must be distinguished from a background of sequencing errors and complex genomic rearrangements. This problem [@problem_id:2846153] provides a hands-on application of Bayesian statistics to develop a robust criterion for calling TE insertions, forcing you to weigh evidence for a true insertion against a null hypothesis of mapping noise. Mastering this approach is fundamental for building reliable TE annotation pipelines and interpreting genome-scale data.", "problem": "A transposable element (TE) annotation pipeline in a diploid eukaryotic genome calls non-reference insertions using split-read evidence at candidate loci. Consider a single candidate locus and assume the following fundamental base:\n- Reads are sampled approximately uniformly along the genome, and occurrences of split-mapping signatures at a fixed locus are rare and independent, so their count is well modeled by a Poisson process with rate parameter $\\lambda$.\n- Under the null hypothesis $H_{0}$ (no true TE insertion), the count $X$ of split-reads supporting an insertion at the locus follows $X \\sim \\text{Poisson}(\\lambda_{0})$ with $\\lambda_{0} = 0.2$ due to mapping noise and structural complexity.\n- Under the alternative hypothesis $H_{1}$ (a true heterozygous TE insertion at the locus), the expected split-read count is $X \\sim \\text{Poisson}(\\lambda_{1})$ with $\\lambda_{1} = d \\cdot p_{s}$, where $d$ is the average per-base sequencing depth and $p_{s}$ is the per-unit-depth probability that a read overlaps and is alignable as a split-read at the junction. For this experiment, $d = 30$ and $p_{s} = 0.15$.\n- The prior probability that a randomly selected candidate locus is a true insertion is $\\theta = 0.05$.\n\nThe pipeline requires the posterior probability $\\Pr(H_{1} \\mid X=x)$ to be at least $c = 0.99$ in order to make a call. Using Bayes’ theorem and the Poisson model above, derive from first principles and report the minimal integer threshold $x^{\\ast}$ such that for all observed counts $x \\ge x^{\\ast}$ the posterior probability satisfies $\\Pr(H_{1} \\mid X=x) \\ge c$. Express your final answer as a single integer (no units).", "solution": "The problem requires the determination of a minimal integer threshold $x^{\\ast}$ for the number of observed split-reads, such that for any count $x \\ge x^{\\ast}$, the posterior probability of a true transposable element (TE) insertion, $\\Pr(H_{1} \\mid X=x)$, is at least a specified confidence level $c$.\n\nFirst, we formalize the problem using the provided information.\nThe two hypotheses are:\n- $H_{0}$: No true TE insertion.\n- $H_{1}$: A true heterozygous TE insertion is present.\n\nThe prior probabilities of these hypotheses are given as:\n- $\\Pr(H_{1}) = \\theta = 0.05$\n- $\\Pr(H_{0}) = 1 - \\Pr(H_{1}) = 1 - \\theta = 0.95$\n\nThe observed split-read count, $X$, is modeled by a Poisson distribution, with the rate parameter dependent on the hypothesis.\n- Under $H_{0}$, the count $X$ follows $X \\sim \\text{Poisson}(\\lambda_{0})$, with $\\lambda_{0} = 0.2$. The likelihood is $\\Pr(X=x \\mid H_{0}) = \\frac{\\exp(-\\lambda_{0}) \\lambda_{0}^{x}}{x!}$.\n- Under $H_{1}$, the count $X$ follows $X \\sim \\text{Poisson}(\\lambda_{1})$. The rate $\\lambda_{1}$ is given by $\\lambda_{1} = d \\cdot p_{s}$, where the sequencing depth is $d=30$ and the probability of a split-read is $p_{s} = 0.15$.\nThus, $\\lambda_{1} = 30 \\cdot 0.15 = 4.5$. The likelihood is $\\Pr(X=x \\mid H_{1}) = \\frac{\\exp(-\\lambda_{1}) \\lambda_{1}^{x}}{x!}$.\n\nThe calling criterion is that the posterior probability $\\Pr(H_{1} \\mid X=x)$ must be at least $c = 0.99$. We use Bayes' theorem to express this posterior probability:\n$$ \\Pr(H_{1} \\mid X=x) = \\frac{\\Pr(X=x \\mid H_{1}) \\Pr(H_{1})}{\\Pr(X=x \\mid H_{1}) \\Pr(H_{1}) + \\Pr(X=x \\mid H_{0}) \\Pr(H_{0})} $$\nSubstituting the symbolic representations:\n$$ \\Pr(H_{1} \\mid X=x) = \\frac{\\Pr(X=x \\mid H_{1}) \\theta}{\\Pr(X=x \\mid H_{1}) \\theta + \\Pr(X=x \\mid H_{0}) (1-\\theta)} $$\nThe condition we must satisfy is:\n$$ \\frac{\\Pr(X=x \\mid H_{1}) \\theta}{\\Pr(X=x \\mid H_{1}) \\theta + \\Pr(X=x \\mid H_{0}) (1-\\theta)} \\ge c $$\nThis inequality can be rearranged to isolate the likelihood ratio, $\\frac{\\Pr(X=x \\mid H_{1})}{\\Pr(X=x \\mid H_{0})}$.\n$$ \\Pr(X=x \\mid H_{1}) \\theta \\ge c \\left[ \\Pr(X=x \\mid H_{1}) \\theta + \\Pr(X=x \\mid H_{0}) (1-\\theta) \\right] $$\n$$ \\Pr(X=x \\mid H_{1}) \\theta (1-c) \\ge \\Pr(X=x \\mid H_{0}) c (1-\\theta) $$\nSince $c=0.991$, $1-c > 0$. We can divide both sides by $\\theta(1-c)\\Pr(X=x | H_0)$ (which are all positive quantities) without changing the direction of the inequality:\n$$ \\frac{\\Pr(X=x \\mid H_{1})}{\\Pr(X=x \\mid H_{0})} \\ge \\frac{c(1-\\theta)}{(1-c)\\theta} $$\nLet's substitute the Poisson probability mass functions into the likelihood ratio:\n$$ \\frac{\\frac{\\exp(-\\lambda_{1}) \\lambda_{1}^{x}}{x!}}{\\frac{\\exp(-\\lambda_{0}) \\lambda_{0}^{x}}{x!}} = \\exp(\\lambda_{0} - \\lambda_{1}) \\left(\\frac{\\lambda_{1}}{\\lambda_{0}}\\right)^{x} $$\nThe right-hand side of the inequality is a constant threshold based on the priors and the confidence level. Let's calculate its value:\n$$ K = \\frac{c(1-\\theta)}{(1-c)\\theta} = \\frac{0.99 \\cdot (1-0.05)}{(1-0.99) \\cdot 0.05} = \\frac{0.99 \\cdot 0.95}{0.01 \\cdot 0.05} = \\frac{0.9405}{0.0005} = 1881 $$\nSo the inequality becomes:\n$$ \\exp(\\lambda_{0} - \\lambda_{1}) \\left(\\frac{\\lambda_{1}}{\\lambda_{0}}\\right)^{x} \\ge 1881 $$\nTo solve for $x$, we take the natural logarithm of both sides:\n$$ (\\lambda_{0} - \\lambda_{1}) + x \\ln\\left(\\frac{\\lambda_{1}}{\\lambda_{0}}\\right) \\ge \\ln(1881) $$\n$$ x \\ln\\left(\\frac{\\lambda_{1}}{\\lambda_{0}}\\right) \\ge \\ln(1881) + \\lambda_{1} - \\lambda_{0} $$\nThe values for the parameters are $\\lambda_{1}=4.5$ and $\\lambda_{0}=0.2$. Since $\\lambda_{1}  \\lambda_{0}$, the term $\\ln(\\frac{\\lambda_{1}}{\\lambda_{0}})$ is positive, so dividing by it does not change the inequality direction.\n$$ x \\ge \\frac{\\ln(1881) + \\lambda_{1} - \\lambda_{0}}{\\ln(\\lambda_{1} / \\lambda_{0})} $$\nSubstituting the numerical values into this expression:\n$$ x \\ge \\frac{\\ln(1881) + 4.5 - 0.2}{\\ln(4.5 / 0.2)} = \\frac{\\ln(1881) + 4.3}{\\ln(22.5)} $$\nUsing approximations for the logarithmic functions, $\\ln(1881) \\approx 7.53956$ and $\\ln(22.5) \\approx 3.11351$:\n$$ x \\ge \\frac{7.53956 + 4.3}{3.11351} = \\frac{11.83956}{3.11351} \\approx 3.8018 $$\nThe variable $x$ represents the count of reads, which must be an integer. The smallest integer $x$ that satisfies the condition $x \\ge 3.8018$ is $x=4$.\n\nTo ensure that this is a valid threshold for all $x \\ge x^{\\ast}$, we must verify that the posterior probability $\\Pr(H_{1} \\mid X=x)$ is a monotonically non-decreasing function of $x$. The posterior can be written as:\n$$ \\Pr(H_{1} \\mid X=x) = \\left(1 + \\frac{1-\\theta}{\\theta} \\frac{\\Pr(X=x \\mid H_{0})}{\\Pr(X=x \\mid H_{1})}\\right)^{-1} = \\left(1 + \\frac{1-\\theta}{\\theta}\\exp(\\lambda_{1}-\\lambda_{0})\\left(\\frac{\\lambda_0}{\\lambda_1}\\right)^x\\right)^{-1} $$\nSince $\\lambda_{1} = 4.5  \\lambda_{0} = 0.2$, the ratio $\\frac{\\lambda_0}{\\lambda_1}$ is a positive number less than $1$. Consequently, the term $\\left(\\frac{\\lambda_0}{\\lambda_1}\\right)^x$ strictly decreases as $x$ increases. This means the entire term in the parentheses is strictly decreasing with $x$, and therefore its reciprocal, $\\Pr(H_{1} \\mid X=x)$, is a strictly increasing function of $x$.\nThis confirms that if the condition is met for $x=x^{\\ast}$, it will also be met for any integer $x  x^{\\ast}$.\nTherefore, the minimal integer threshold $x^{\\ast}$ is indeed the smallest integer satisfying the inequality.\n\nThe minimal integer threshold is $x^{\\ast} = 4$.", "answer": "$$\\boxed{4}$$", "id": "2846153"}, {"introduction": "Once a transposable element is identified, we can ask questions about its long-term evolutionary fate within a population. Why are some TEs rare while others are common? This exercise [@problem_id:2846179] guides you through the process of building a deterministic model of TE population dynamics from first principles. By balancing the forces of negative selection ($s$), new transposition ($u$), and precise excision ($e$), you will derive the equilibrium frequency of a TE insertion, providing a powerful quantitative framework for understanding the evolutionary tug-of-war that shapes the genomic landscape.", "problem": "A single chromosomal site in a large, randomly mixing haploid population can be either without a transposable element (TE) insertion (allele $A$) or with a TE insertion (allele $a$). Generations are discrete and non-overlapping. Each generation, viability selection occurs first, followed by reversible mutation modeling forward insertion and precise excision at this focal site. Assume the following:\n\n- The fitness of $A$ is $1$, and the fitness of $a$ is $1 - s$, where $s \\in (0,1)$ is the per-generation multiplicative cost of the insertion at this site.\n- After selection, allele $A$ mutates to $a$ with per-generation probability $u \\in (0,1)$ (new insertion), and allele $a$ mutates to $A$ with per-generation probability $e \\in (0,1)$ (precise excision).\n- The population is effectively infinite so that deterministic allele-frequency dynamics apply, and linkage and copy-number effects outside this focal site are absorbed into the effective forward rate $u$.\n\nLet $p$ denote the frequency of the insertion allele $a$ immediately before selection in a given generation. Under the life cycle described, there exists an internal equilibrium frequency $p^{\\ast} \\in (0,1)$ at which the allele frequency is unchanged across generations.\n\nDerive, from first principles of viability selection and reversible mutation in haploids, the exact closed-form expression for $p^{\\ast}$ as a function of $s$, $u$, and $e$. Your final answer must be a single analytic expression in terms of $s$, $u$, and $e$ only. Do not approximate. Express no units.", "solution": "The derivation proceeds from first principles by constructing a recurrence relation for the frequency of the insertion allele, $a$, from one generation to the next. Let $p_t$ be the frequency of allele $a$ at the start of generation $t$ (before selection). The frequency of allele $A$ is thus $1 - p_t$.\n\nThe life cycle consists of two sequential steps: selection and mutation.\n\n**1. Viability Selection:**\nThe fitness of allele $A$ is $w_A = 1$, and the fitness of allele $a$ is $w_a = 1 - s$. The mean fitness of the population, $\\bar{w}$, is the average of the allele fitness values weighted by their frequencies:\n$$ \\bar{w} = (1 - p_t)w_A + p_t w_a $$\n$$ \\bar{w} = (1 - p_t)(1) + p_t(1 - s) = 1 - p_t + p_t - sp_t = 1 - sp_t $$\nAfter selection, the frequency of allele $a$, denoted $p_s$, is its initial frequency multiplied by its relative fitness:\n$$ p_s = \\frac{p_t w_a}{\\bar{w}} = \\frac{p_t(1 - s)}{1 - sp_t} $$\nThe frequency of allele $A$ after selection is correspondingly:\n$$ 1 - p_s = \\frac{(1 - p_t)w_A}{\\bar{w}} = \\frac{1 - p_t}{1 - sp_t} $$\n\n**2. Reversible Mutation:**\nFollowing selection, mutation occurs. Allele $A$ mutates to $a$ at a rate $u$, and allele $a$ mutates to $A$ at a rate $e$. The frequency of allele $a$ at the start of the next generation, $p_{t+1}$, is determined by the frequencies after selection ($p_s$ and $1 - p_s$). Allele $a$ is constituted by the fraction of $a$ alleles that do not mutate away ($1-e$) and the fraction of $A$ alleles that mutate into $a$ ($u$).\n$$ p_{t+1} = p_s(1 - e) + (1 - p_s)u $$\n$$ p_{t+1} = p_s - ep_s + u - up_s = p_s(1 - e - u) + u $$\nSubstituting the expression for $p_s$:\n$$ p_{t+1} = \\left(\\frac{p_t(1 - s)}{1 - sp_t}\\right)(1 - e - u) + u $$\nThis equation is the complete recurrence relation for the frequency of allele $a$.\n\n**3. Equilibrium Condition:**\nAt equilibrium, the allele frequency does not change between generations, so $p_{t+1} = p_t = p^{\\ast}$. We solve for $p^{\\ast}$:\n$$ p^{\\ast} = \\left(\\frac{p^{\\ast}(1 - s)}{1 - sp^{\\ast}}\\right)(1 - e - u) + u $$\nTo solve for $p^{\\ast}$, we rearrange the equation. We assume an internal equilibrium, so $p^{\\ast} \\in (0,1)$ and thus $p^{\\ast} \\neq 0$.\n$$ p^{\\ast} - u = \\frac{p^{\\ast}(1 - s)(1 - e - u)}{1 - sp^{\\ast}} $$\nMultiply both sides by $(1 - sp^{\\ast})$:\n$$ (p^{\\ast} - u)(1 - sp^{\\ast}) = p^{\\ast}(1 - s)(1 - e - u) $$\nExpand both sides of the equation:\n$$ p^{\\ast} - s(p^{\\ast})^2 - u + sup^{\\ast} = p^{\\ast}(1 - s)(1 - e - u) $$\n$$ p^{\\ast} - s(p^{\\ast})^2 - u + sup^{\\ast} = p^{\\ast}(1 - e - u - s + se + su) $$\n$$ p^{\\ast} - s(p^{\\ast})^2 - u + sup^{\\ast} = p^{\\ast} - ep^{\\ast} - up^{\\ast} - sp^{\\ast} + sep^{\\ast} + sup^{\\ast} $$\nWe cancel terms present on both sides ($p^{\\ast}$ and $sup^{\\ast}$):\n$$ -s(p^{\\ast})^2 - u = -ep^{\\ast} - up^{\\ast} - sp^{\\ast} + sep^{\\ast} $$\nRearranging into the standard quadratic form $Ax^2 + Bx + C = 0$ for $x=p^{\\ast}$:\n$$ s(p^{\\ast})^2 - (s + u + e - se)p^{\\ast} + u = 0 $$\nThis can be written as:\n$$ s(p^{\\ast})^2 - [s + u + e(1-s)]p^{\\ast} + u = 0 $$\nWe solve for $p^{\\ast}$ using the quadratic formula, $p^{\\ast} = \\frac{-B \\pm \\sqrt{B^2 - 4AC}}{2A}$, with $A=s$, $B= -[s + u + e(1-s)]$, and $C=u$.\n$$ p^{\\ast} = \\frac{[s + u + e(1-s)] \\pm \\sqrt{[s + u + e(1-s)]^2 - 4su}}{2s} $$\nThe problem asks for an internal equilibrium $p^{\\ast} \\in (0,1)$. The quadratic equation yields two potential solutions. The biologically relevant stable equilibrium is given by the \"-\" root, as the \"+\" root yields a value of $p^{\\ast}$ that is typically greater than 1.\n$$ p^{\\ast} = \\frac{s + u + e(1-s) - \\sqrt{[s + u + e(1-s)]^2 - 4su}}{2s} $$\nThis is the exact, closed-form expression for the internal equilibrium frequency.", "answer": "$$\\boxed{\\frac{s + u + e(1-s) - \\sqrt{\\left(s + u + e(1-s)\\right)^{2} - 4su}}{2s}}$$", "id": "2846179"}, {"introduction": "Transposable elements are not only active players in genome evolution but also invaluable molecular fossils that record ancient events. The two Long Terminal Repeats (LTRs) of a retrotransposon are identical upon insertion and diverge neutrally over time, creating a molecular clock. This practice problem [@problem_id:2846135] demonstrates how to use this principle to date an insertion event. You will apply the classic Kimura two-parameter (K80) model to correct for multiple substitutions and translate observed sequence divergence into an absolute time estimate, a core skill in molecular evolution and paleogenomics.", "problem": "A Long Terminal Repeat (LTR) retrotransposon is found intact in a mammalian genome. By definition of LTR retrotransposon biology, the two flanking Long Terminal Repeat (LTR) sequences are synthesized by reverse transcription as identical copies at the moment of insertion. After insertion, the two LTRs diverge independently under mutation and drift. A carefully curated pairwise alignment of the two LTRs is constructed as follows: to minimize context-dependent rate heterogeneity, all positions that are or were part of cytosine–phosphate–guanine (CpG) dinucleotides are masked, and only the remaining non-CpG sites are retained. The resulting alignment length is $L = 3600$ sites, with $N_{\\mathrm{ts}} = 81$ observed transitions and $N_{\\mathrm{tv}} = 27$ observed transversions between the two LTRs.\n\nAssume the following well-tested facts and definitions:\n- By the neutral theory of molecular evolution, the neutral substitution rate per site per generation equals the neutral mutation rate per site per generation. If the generation time is $g$ years, the neutral substitution rate per site per year is $r = f u / g$, where $u$ is the mutation rate per site per generation and $f$ is the fraction of mutations that are effectively neutral at the analyzed sites.\n- For two independently evolving sequences that were identical at time of insertion, the expected number of substitutions per site separating them (the evolutionary distance) accumulates at rate $2 r$ under stationarity and time-homogeneous conditions.\n- Under the Kimura two-parameter (K80) model, transitions and transversions occur as independent Poisson processes with distinct rates, and multiple hits at the same site are possible.\n\nUse the Kimura two-parameter framework to correct for multiple hits based on the observed transition and transversion fractions, and then estimate the time since insertion. Take the neutral mutation rate per site per generation to be $u = 1.0 \\times 10^{-8}$, the neutral fraction to be $f = 0.9$, and the generation time to be $g = 15$ years. Express your final answer as the estimated age in years, rounded to three significant figures.", "solution": "The objective is to estimate the time $T$ since the insertion of a Long Terminal Repeat (LTR) retrotransposon. This is achieved by first calculating the evolutionary distance between the two LTR sequences and then relating this distance to time via the given substitution rate.\n\nFirst, we calculate the observed proportions of transitional and transversional differences.\nThe alignment length is given as $L = 3600$ sites.\nThe number of observed transitions is $N_{\\mathrm{ts}} = 81$.\nThe number of observed transversions is $N_{\\mathrm{tv}} = 27$.\n\nThe proportion of sites with a transitional difference, $P$, is:\n$$\nP = \\frac{N_{\\mathrm{ts}}}{L} = \\frac{81}{3600} = 0.0225\n$$\nThe proportion of sites with a transversional difference, $Q$, is:\n$$\nQ = \\frac{N_{\\mathrm{tv}}}{L} = \\frac{27}{3600} = 0.0075\n$$\n\nNext, we use the Kimura two-parameter (K80) model to estimate the evolutionary distance, $K$, which is the expected number of substitutions per site. The K80 model corrects for multiple substitutions at the same site, which are not directly observed. The formula for $K$ is:\n$$\nK = -\\frac{1}{2} \\ln(1 - 2P - Q) - \\frac{1}{4} \\ln(1 - 2Q)\n$$\nSubstituting the calculated values of $P$ and $Q$:\n$$\nK = -\\frac{1}{2} \\ln(1 - 2(0.0225) - 0.0075) - \\frac{1}{4} \\ln(1 - 2(0.0075))\n$$\n$$\nK = -\\frac{1}{2} \\ln(1 - 0.045 - 0.0075) - \\frac{1}{4} \\ln(1 - 0.015)\n$$\n$$\nK = -\\frac{1}{2} \\ln(0.9475) - \\frac{1}{4} \\ln(0.985)\n$$\nUsing the natural logarithm function:\n$$\nK \\approx -\\frac{1}{2} (-0.05391) - \\frac{1}{4} (-0.01511)\n$$\n$$\nK \\approx 0.026955 + 0.003778\n$$\n$$\nK \\approx 0.030733 \\text{ substitutions per site}\n$$\n\nNow, we calculate the neutral substitution rate per site per year, $r$. The problem provides the formula $r = f u / g$, with the following parameters:\n-   Mutation rate per site per generation: $u = 1.0 \\times 10^{-8}$\n-   Fraction of neutral mutations: $f = 0.9$\n-   Generation time: $g = 15$ years\n\nSubstituting these values:\n$$\nr = \\frac{(0.9)(1.0 \\times 10^{-8})}{15} = \\frac{9.0 \\times 10^{-9}}{15} = 0.6 \\times 10^{-9} = 6.0 \\times 10^{-10} \\text{ substitutions per site per year}\n$$\n\nThe problem states that the two LTR sequences were identical at the time of insertion ($T=0$) and have been evolving independently since. The rate of divergence between the two sequences is therefore twice the rate of a single lineage, i.e., $2r$. The total evolutionary distance, $K$, is the product of this rate and the time elapsed, $T$:\n$$\nK = (2r)T\n$$\nWe can now solve for the time since insertion, $T$:\n$$\nT = \\frac{K}{2r}\n$$\nSubstituting the calculated values for $K$ and $r$:\n$$\nT = \\frac{0.030733}{2 \\times (6.0 \\times 10^{-10})} = \\frac{0.030733}{1.2 \\times 10^{-9}}\n$$\n$$\nT \\approx 25610833 \\text{ years}\n$$\n\nFinally, the problem requires the answer to be rounded to three significant figures.\n$$\nT \\approx 25,600,000 \\text{ years} = 2.56 \\times 10^{7} \\text{ years}\n$$\nThis is the estimated time since the retrotransposon insertion event.", "answer": "$$\n\\boxed{2.56 \\times 10^{7}}\n$$", "id": "2846135"}]}