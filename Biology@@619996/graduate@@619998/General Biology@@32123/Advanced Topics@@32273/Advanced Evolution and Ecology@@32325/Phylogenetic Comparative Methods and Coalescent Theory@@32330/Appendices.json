{"hands_on_practices": [{"introduction": "The history of a single gene does not always mirror the history of the species that carry it, a fundamental challenge in phylogenetics. This exercise explores this phenomenon through the lens of the Multispecies Coalescent (MSC) model, a cornerstone of modern population genetics and systematics. By deriving the probability of gene tree discordance from first principles, you will gain a concrete understanding of Incomplete Lineage Sorting (ILS) and appreciate why it is a critical concept in the age of phylogenomics [@problem_id:2823645].", "problem": "Consider a rooted three-taxon species tree with topology $((A,B),C)$ in which species $A$ and $B$ diverge, followed by an internode of length $T$ generations before the lineage leading to $(A,B)$ coalesces with $C$. Assume a neutral constant-size population along each branch with effective population size $N_e$, a single sampled lineage per species, instantaneous speciation events, and no post-divergence migration. Work under the standard Multispecies Coalescent (MSC) model.\n\nStarting from the fundamental facts that (i) the waiting time to coalescence of two lineages in a single panmictic population of constant effective size $N_e$ is exponentially distributed with rate $1/(2N_e)$ in generations, and (ii) when three lineages enter the same ancestral population, the next coalescent event chooses any of the $\\binom{3}{2}$ pairs with equal probability, derive from first principles the expected fraction of gene trees that are topologically discordant with the species tree as a function of the dimensionless internode length $\\tau$. First compute the coalescent-unit internode length $\\tau = T/(2N_e)$ for the parameter values $N_e = 750{,}000$ and $T = 1{,}200{,}000$ generations. Then compute the expected fraction of discordant gene trees.\n\nReport your final answer as a row vector containing, in order, the value of $\\tau$ and the expected discordant fraction. Round each reported number to four significant figures. No units are required.", "solution": "The problem is subjected to validation before any solution is attempted.\n\nStep 1: Extraction of Givens.\n- Species tree topology: $((A,B),C)$.\n- Internode length: $T$ generations.\n- Effective population size: $N_e$, constant along all branches.\n- Sampling scheme: A single lineage per species.\n- Speciation model: Instantaneous events.\n- Migration: No post-divergence gene flow.\n- Model: Standard Multispecies Coalescent (MSC).\n- Fundamental fact (i): The waiting time to coalescence for two lineages in a constant-size population $N_e$ is exponentially distributed with rate $1/(2N_e)$ generations.\n- Fundamental fact (ii): For three lineages entering an ancestral population, any of the $\\binom{3}{2}$ pairs coalesces first with equal probability.\n- Definition of dimensionless internode length: $\\tau = T/(2N_e)$.\n- Parameter values for calculation: $N_e = 750{,}000$ and $T = 1{,}200{,}000$ generations.\n- Required output: The value of $\\tau$ and the expected fraction of discordant gene trees, rounded to four significant figures.\n\nStep 2: Validation.\n- Scientific Groundedness: The problem is a canonical example within the field of coalescent theory. It is based on the standard Multispecies Coalescent model, which is a cornerstone of modern phylogenetics and population genetics. The assumptions and provided facts are fundamental to the theory. The problem is scientifically sound.\n- Well-Posedness: The problem provides all necessary parameters, definitions, and a clear objective. It is structured to have a unique, stable, and meaningful solution.\n- Objectivity: The problem is stated in precise, quantitative terms, free of subjective or ambiguous language.\n\nStep 3: Verdict.\nThe problem is valid as it is scientifically grounded, well-posed, and objective. It does not violate any of the specified criteria for invalidity. A solution will be derived.\n\nDerivation from first principles:\nThe species tree topology is given as $((A,B),C)$, which indicates that species $A$ and $B$ are sister taxa, and their common ancestor shares a common ancestor with species $C$. We trace the lineages of single gene copies sampled from each of the three species ($A$, $B$, and $C$) backward in time.\n\nThe lineages from $A$ and $B$ enter their common ancestral population. This ancestral population persists for an internode duration of $T$ generations. We define the internode length in coalescent units as $\\tau = T / (2N_e)$, where one coalescent time unit equals $2N_e$ generations. According to the problem statement, the waiting time for the two lineages to coalesce is exponentially distributed with a rate parameter of $1/(2N_e)$ generations$^{-1}$. In coalescent time units, the rate parameter is $1$.\n\nThere are two mutually exclusive events that can occur within this internode of length $\\tau$:\n1. The lineages from $A$ and $B$ coalesce within the internode.\n2. The lineages from $A$ and $B$ fail to coalesce within the internode.\n\nLet us analyze the probability of each event. The probability that coalescence occurs by time $\\tau$ is given by the cumulative distribution function (CDF) of the exponential distribution with rate $1$, evaluated at $\\tau$:\n$$P(\\text{coalescence in internode}) = \\int_0^\\tau \\exp(-t) dt = \\left[ -\\exp(-t) \\right]_0^\\tau = 1 - \\exp(-\\tau)$$\nIf the lineages from $A$ and $B$ coalesce, the resulting gene tree will have the topology $((A,B),C)$. This topology is congruent, or concordant, with the species tree.\n\nThe probability that the lineages from $A$ and $B$ do not coalesce within the internode is the complementary probability:\n$$P(\\text{no coalescence in internode}) = 1 - P(\\text{coalescence in internode}) = 1 - (1 - \\exp(-\\tau)) = \\exp(-\\tau)$$\nIf the two lineages fail to coalesce, then at time $T$ in the past (or $\\tau$ in coalescent units), three distinct lineages—the ancestor of the $A$ sample, the ancestor of the $B$ sample, and the ancestor of the $C$ sample—enter the deeper ancestral population common to all three species.\n\nAccording to the problem's premises, when three lineages are present in a single panmictic population, the next coalescent event involves any of the $\\binom{3}{2} = 3$ possible pairs of lineages with equal probability. The pairs are $(A,B)$, $(A,C)$, and $(B,C)$. The probability for any specific pair to coalesce first is $\\frac{1}{3}$.\n- If the pair $(A,B)$ coalesces first, the resulting gene tree is $((A,B),C)$. This is a concordant topology. This occurs with conditional probability $\\frac{1}{3}$.\n- If the pair $(A,C)$ coalesces first, the resulting gene tree is $((A,C),B)$. This is a discordant topology. This occurs with conditional probability $\\frac{1}{3}$.\n- If the pair $(B,C)$ coalesces first, the resulting gene tree is $((B,C),A)$. This is also a discordant topology. This occurs with conditional probability $\\frac{1}{3}$.\n\nA discordant gene tree arises only if the lineages from $A$ and $B$ do not coalesce in the internode, *and* the first coalescence event in the deeper ancestral population involves either the $(A,C)$ or $(B,C)$ pair.\n\nThe total probability of observing a discordant gene tree is the sum of the probabilities of these two outcomes:\n$$P(\\text{discordant}) = P(\\text{no coalescence in internode}) \\times \\left( P((A,C) \\text{ coalesces first}) + P((B,C) \\text{ coalesces first}) \\right)$$\n$$P(\\text{discordant}) = \\exp(-\\tau) \\times \\left( \\frac{1}{3} + \\frac{1}{3} \\right)$$\n$$P(\\text{discordant}) = \\frac{2}{3}\\exp(-\\tau)$$\nThis is the general formula for the expected fraction of discordant gene trees for this three-taxon case.\n\nNext, we perform the numerical calculations as required.\nFirst, we compute the dimensionless internode length $\\tau$ using the provided parameters $N_e = 750{,}000$ and $T = 1{,}200{,}000$:\n$$\\tau = \\frac{T}{2N_e} = \\frac{1{,}200{,}000}{2 \\times 750{,}000} = \\frac{1{,}200{,}000}{1{,}500{,}000} = \\frac{12}{15} = \\frac{4}{5} = 0.8$$\n\nSecond, we compute the expected fraction of discordant gene trees for this value of $\\tau$:\n$$P(\\text{discordant}) = \\frac{2}{3}\\exp(-0.8)$$\nUsing the value $\\exp(-0.8) \\approx 0.44932896$, we have:\n$$P(\\text{discordant}) \\approx \\frac{2}{3} \\times 0.44932896 \\approx 0.29955264$$\n\nThe problem requires rounding each number to four significant figures.\n- For $\\tau = 0.8$, four significant figures gives $0.8000$.\n- For $P(\\text{discordant}) \\approx 0.29955264$, rounding to four significant figures gives $0.2996$.\n\nThe final answer is a row vector containing these two values in order.", "answer": "$$\\boxed{\\begin{pmatrix} 0.8000 & 0.2996 \\end{pmatrix}}$$", "id": "2823645"}, {"introduction": "Once we have molecular data for a set of species, a central task is to evaluate how well it fits a particular evolutionary hypothesis, which consists of a tree topology and a model of character evolution. This practice demystifies the computational engine behind modern phylogenetic inference: Felsenstein's pruning algorithm for calculating likelihood. By manually computing the likelihood of discrete character data on a small tree, you will build an intuitive and practical understanding of this powerful dynamic programming method that underpins much of evolutionary biology [@problem_id:2823628].", "problem": "Consider a binary discrete character evolving along a rooted three-taxon phylogeny under a continuous-time Markov chain (CTMC) with state space $\\{0,1\\}$. The instantaneous rate matrix is\n$$\nQ \\;=\\; \\begin{pmatrix}\n-1 & 1 \\\\\n1 & -1\n\\end{pmatrix},\n$$\nso that changes occur at rate $1$ per unit time and rows sum to zero. The rooted tree topology and branch lengths (in time units) are given in Newick form as $((A:0.3,B:0.3):0.2,C:0.5)$, which is ultrametric with root height $0.5$. The observed tip states are $A=1$, $B=0$, and $C=1$. Assume the prior distribution at the root (the root prior) is $\\pi = (\\pi_0,\\pi_1) = (0.7,0.3)$, where $\\pi_i$ is the prior probability that the root is in state $i$.\n\nUsing first principles for CTMCs and the dynamic-programming pruning algorithm for phylogenetic likelihood, compute the likelihood of the observed tip data given the tree, the rate matrix $Q$, and the root prior $\\pi$. That is, compute the scalar $L = \\Pr(\\text{data} \\mid \\text{tree},Q,\\pi)$ by propagating conditional likelihoods from the tips to the root and multiplying by the root prior at the end.\n\nExpress your final numerical answer as a single real number and round your answer to four significant figures.", "solution": "This problem requires the computation of the likelihood of observed character states on a phylogeny, a standard procedure in computational phylogenetics. The problem is well-posed and contains all necessary information. We will solve this by applying Felsenstein's pruning algorithm.\n\nFirst, we must formalize the problem components. The state space is $\\{0, 1\\}$. The instantaneous rate matrix is given as\n$$\nQ = \\begin{pmatrix} -1 & 1 \\\\ 1 & -1 \\end{pmatrix}\n$$\nThe tree topology is specified in Newick format as `((A:0.3,B:0.3):0.2,C:0.5)`. Let us denote the root of the tree as $R$ and the internal node that is the parent of tips $A$ and $B$ as $N$. The structure is: $R$ is the parent of $N$ and $C$; $N$ is the parent of $A$ and $B$. The branch lengths are the time durations of evolution along those branches:\n- Branch from $N$ to $A$: $t_A = 0.3$\n- Branch from $N$ to $B$: $t_B = 0.3$\n- Branch from $R$ to $N$: $t_N = 0.2$\n- Branch from $R$ to $C$: $t_C = 0.5$\nThe observed states at the tips are $s_A=1$, $s_B=0$, and $s_C=1$.\nThe prior probability distribution for the state at the root $R$ is $\\pi = (\\pi_0, \\pi_1) = (0.7, 0.3)$.\n\nThe core of the calculation is the transition probability matrix $P(t) = \\exp(Qt)$, where $P_{ij}(t)$ is the probability of transitioning from state $i$ to state $j$ in time $t$. For the given symmetric rate matrix $Q$, the transition probabilities are well-known. We can derive them through matrix exponentiation. The eigenvalues of $Q$ are $\\lambda_1 = 0$ and $\\lambda_2 = -2$. The matrix of transition probabilities is:\n$$\nP(t) = \\begin{pmatrix} P_{00}(t) & P_{01}(t) \\\\ P_{10}(t) & P_{11}(t) \\end{pmatrix} = \\frac{1}{2} \\begin{pmatrix} 1+\\exp(-2t) & 1-\\exp(-2t) \\\\ 1-\\exp(-2t) & 1+\\exp(-2t) \\end{pmatrix}\n$$\nSo, the probability of remaining in the same state is $P_{00}(t) = P_{11}(t) = \\frac{1}{2}(1 + \\exp(-2t))$, and the probability of changing state is $P_{01}(t) = P_{10}(t) = \\frac{1}{2}(1 - \\exp(-2t))$.\n\nThe pruning algorithm computes the likelihood by recursively calculating conditional likelihood vectors at each node, moving from the tips to the root. For any node $u$, the conditional likelihood vector is $L(u) = (L_0(u), L_1(u))$, where $L_i(u)$ is the probability of the observed data in the clade descending from $u$, given that the state at $u$ is $i$.\n\n1.  Initialization at the tips:\n    For a tip node with an observed state $s$, the conditional likelihood is $1$ for that state and $0$ for all others.\n    - Tip $A$ has state $1$: $L(A) = (L_0(A), L_1(A)) = (0, 1)$\n    - Tip $B$ has state $0$: $L(B) = (L_0(B), L_1(B)) = (1, 0)$\n    - Tip $C$ has state $1$: $L(C) = (L_0(C), L_1(C)) = (0, 1)$\n\n2.  Compute conditional likelihoods at internal node $N$:\n    Node $N$ is the parent of tips $A$ and $B$. For each state $i \\in \\{0, 1\\}$ at node $N$, we compute $L_i(N)$ using the likelihoods from its children:\n    $$\n    L_i(N) = \\left( \\sum_{j \\in \\{0,1\\}} P_{ij}(t_A) L_j(A) \\right) \\left( \\sum_{k \\in \\{0,1\\}} P_{ik}(t_B) L_k(B) \\right)\n    $$\n    With $t_A = 0.3$ and $t_B = 0.3$:\n    - The first term is $P_{i0}(0.3)L_0(A) + P_{i1}(0.3)L_1(A) = P_{i0}(0.3) \\cdot 0 + P_{i1}(0.3) \\cdot 1 = P_{i1}(0.3)$.\n    - The second term is $P_{i0}(0.3)L_0(B) + P_{i1}(0.3)L_1(B) = P_{i0}(0.3) \\cdot 1 + P_{i1}(0.3) \\cdot 0 = P_{i0}(0.3)$.\n    Thus, $L_i(N) = P_{i1}(0.3) P_{i0}(0.3)$.\n    For $i=0$: $L_0(N) = P_{01}(0.3)P_{00}(0.3) = \\frac{1}{2}(1-\\exp(-0.6)) \\cdot \\frac{1}{2}(1+\\exp(-0.6)) = \\frac{1}{4}(1 - \\exp(-1.2))$.\n    For $i=1$: $L_1(N) = P_{11}(0.3)P_{10}(0.3) = \\frac{1}{2}(1+\\exp(-0.6)) \\cdot \\frac{1}{2}(1-\\exp(-0.6)) = \\frac{1}{4}(1 - \\exp(-1.2))$.\n    So, the vector is $L(N) = \\left( \\frac{1}{4}(1 - \\exp(-1.2)), \\frac{1}{4}(1 - \\exp(-1.2)) \\right)$.\n\n3.  Compute conditional likelihoods at the root $R$:\n    Node $R$ is the parent of node $N$ and tip $C$. For each state $i \\in \\{0, 1\\}$ at the root, we compute the conditional likelihood of the entire dataset, $L_{\\text{data}|i} \\equiv \\Pr(\\text{data} | \\text{state of } R = i)$.\n    $$\n    L_{\\text{data}|i} = \\left( \\sum_{j \\in \\{0,1\\}} P_{ij}(t_N) L_j(N) \\right) \\left( \\sum_{k \\in \\{0,1\\}} P_{ik}(t_C) L_k(C) \\right)\n    $$\n    With $t_N = 0.2$ and $t_C = 0.5$:\n    - The second term is $P_{i0}(0.5)L_0(C) + P_{i1}(0.5)L_1(C) = P_{i0}(0.5) \\cdot 0 + P_{i1}(0.5) \\cdot 1 = P_{i1}(0.5)$.\n    - For the first term, since $L_0(N) = L_1(N) = \\frac{1}{4}(1 - \\exp(-1.2))$, we have:\n      $\\sum_{j} P_{ij}(0.2) L_j(N) = L_0(N) P_{i0}(0.2) + L_1(N) P_{i1}(0.2) = L_0(N) (P_{i0}(0.2) + P_{i1}(0.2))$.\n      Since $\\sum_j P_{ij}(t) = 1$ for any $i, t$, this simplifies to $L_0(N) \\cdot 1 = \\frac{1}{4}(1 - \\exp(-1.2))$.\n\n    Now we assemble the conditional likelihoods at the root:\n    For $i=0$:\n    $L_{\\text{data}|0} = \\left( \\frac{1}{4}(1 - \\exp(-1.2)) \\right) \\cdot P_{01}(0.5) = \\frac{1}{4}(1 - \\exp(-1.2)) \\cdot \\frac{1}{2}(1 - \\exp(-1.0)) = \\frac{1}{8}(1 - \\exp(-1.2))(1 - \\exp(-1.0))$.\n    For $i=1$:\n    $L_{\\text{data}|1} = \\left( \\frac{1}{4}(1 - \\exp(-1.2)) \\right) \\cdot P_{11}(0.5) = \\frac{1}{4}(1 - \\exp(-1.2)) \\cdot \\frac{1}{2}(1 + \\exp(-1.0)) = \\frac{1}{8}(1 - \\exp(-1.2))(1 + \\exp(-1.0))$.\n\n4.  Compute the total likelihood $L$:\n    Finally, we find the total likelihood by averaging the conditional likelihoods over the root prior distribution $\\pi = (\\pi_0, \\pi_1) = (0.7, 0.3)$.\n    $$\n    L = \\sum_{i \\in \\{0,1\\}} \\pi_i L_{\\text{data}|i} = \\pi_0 L_{\\text{data}|0} + \\pi_1 L_{\\text{data}|1}\n    $$\n    $$\n    L = 0.7 \\cdot \\frac{1}{8}(1 - \\exp(-1.2))(1 - \\exp(-1.0)) + 0.3 \\cdot \\frac{1}{8}(1 - \\exp(-1.2))(1 + \\exp(-1.0))\n    $$\n    We factor out the common term $\\frac{1}{8}(1 - \\exp(-1.2))$:\n    $$\n    L = \\frac{1}{8}(1 - \\exp(-1.2)) \\left[ 0.7(1 - \\exp(-1.0)) + 0.3(1 + \\exp(-1.0)) \\right]\n    $$\n    Simplifying the term in the brackets:\n    $$\n    [0.7 - 0.7\\exp(-1.0) + 0.3 + 0.3\\exp(-1.0)] = [1.0 - 0.4\\exp(-1.0)]\n    $$\n    Thus, the final analytical expression for the likelihood is:\n    $$\n    L = \\frac{1}{8}(1 - \\exp(-1.2))(1 - 0.4\\exp(-1.0))\n    $$\n\n5.  Numerical calculation:\n    We now substitute the numerical values for the exponential functions.\n    $\\exp(-1.0) \\approx 0.367879$\n    $\\exp(-1.2) \\approx 0.301194$\n    $$\n    L \\approx \\frac{1}{8}(1 - 0.301194)(1 - 0.4 \\cdot 0.367879)\n    $$\n    $$\n    L \\approx \\frac{1}{8}(0.698806)(1 - 0.147152)\n    $$\n    $$\n    L \\approx \\frac{1}{8}(0.698806)(0.852848)\n    $$\n    $$\n    L \\approx 0.125 \\cdot 0.596001 \\approx 0.0745001\n    $$\n    Rounding to four significant figures, the likelihood is $0.07450$.", "answer": "$$\\boxed{0.07450}$$", "id": "2823628"}, {"introduction": "A primary goal of comparative biology is to understand the evolutionary relationships between traits. However, species are not independent data points; their shared ancestry creates statistical non-independence that can mislead standard regression analyses. This hands-on practice introduces Phylogenetic Generalized Least Squares (PGLS), the workhorse method for testing trait correlations while accounting for phylogeny. You will construct a phylogenetic variance-covariance matrix and apply the GLS equations, gaining direct experience with the statistical machinery that powers modern macroevolutionary research [@problem_id:2823588].", "problem": "A comparative biologist seeks to estimate the relationship between a quantitative response and an ecological predictor across a set of species while accounting for phylogenetic non-independence under a Brownian motion model with a Pagel’s lambda transform. Assume a three-species rooted ultrametric phylogeny with topology $((A:1,B:1):1,C:2)$ (branch lengths in time units), so that the root-to-tip distance for each species is $2$. Under Brownian motion with rate $\\sigma^{2}$, the phylogenetic covariance for species $i$ and $j$ is $\\sigma^{2}$ times their shared path length from the root to their most recent common ancestor, and the variance for each tip is $\\sigma^{2}$ times the total root-to-tip length. A Pagel’s lambda transformation with parameter $\\lambda$ multiplies all off-diagonal covariances by $\\lambda$ and leaves the diagonal entries unchanged. Let $\\sigma^{2} = 1$ and $\\lambda = 1$. Order species as $(A,B,C)$.\n\n- Construct the phylogenetic variance-covariance matrix $V$ for the three species.\n- Consider the Generalized Least Squares (GLS) model for the response vector $y$ with design matrix $X$ and covariance matrix $V$:\n  - The design matrix has two columns (intercept and predictor) and three rows matching $(A,B,C)$:\n    $$\n    X \\;=\\; \\begin{pmatrix}\n    1 & 0 \\\\\n    1 & 1 \\\\\n    1 & 2\n    \\end{pmatrix}.\n    $$\n  - The response vector is\n    $$\n    y \\;=\\; \\begin{pmatrix}\n    1 \\\\\n    2 \\\\\n    3\n    \\end{pmatrix}.\n    $$\n- Under the multivariate normal model $y \\sim \\mathcal{N}(X\\beta, V)$, starting from the log-likelihood for a multivariate normal distribution and the definition of the Pagel’s lambda transform, derive the GLS estimator $\\hat{\\beta}$ and its sampling covariance, and then compute their numerical values for the $X$, $y$, and $V$ specified above.\n\nReport your final answer as a single row matrix listing, in order, the two entries of $\\hat{\\beta}$ followed by the four entries of the $2 \\times 2$ covariance matrix $(X^{\\prime}V^{-1}X)^{-1}$ written in row-major order. Give exact values (no rounding).", "solution": "The problem statement must first be subjected to rigorous validation.\n\nStep 1: Extract Givens.\n- Model: Brownian motion with a Pagel’s lambda transform.\n- Phylogeny: A three-species rooted ultrametric tree with topology $((A:1,B:1):1,C:2)$.\n- Branch lengths are in time units.\n- Root-to-tip distance is $2$ for each species.\n- Under Brownian motion with rate $\\sigma^{2}$:\n  - Phylogenetic covariance for species $i$ and $j$ is $\\sigma^{2}$ times their shared path length from the root.\n  - Variance for each tip is $\\sigma^{2}$ times the total root-to-tip length.\n- Pagel's lambda ($\\lambda$) transformation: multiplies all off-diagonal covariances by $\\lambda$ and leaves diagonal entries unchanged.\n- Parameters: $\\sigma^{2} = 1$ and $\\lambda = 1$.\n- Species order: $(A,B,C)$.\n- Design matrix $X$:\n$$\nX = \\begin{pmatrix}\n1 & 0 \\\\\n1 & 1 \\\\\n1 & 2\n\\end{pmatrix}\n$$\n- Response vector $y$:\n$$\ny = \\begin{pmatrix}\n1 \\\\\n2 \\\\\n3\n\\end{pmatrix}\n$$\n- The statistical model is $y \\sim \\mathcal{N}(X\\beta, V)$.\n\nStep 2: Validate Using Extracted Givens.\nThe problem is scientifically grounded, as it uses standard models (Brownian motion, Pagel's lambda) and methods (Generalized Least Squares) from the field of phylogenetic comparative biology. It is well-posed, providing all necessary data—the phylogeny, model parameters, design matrix, and response vector—to compute a unique solution. The terminology is precise and objective. There are no internal contradictions; the phylogeny is indeed ultrametric as stated, with root-to-tip distances for A, B, and C being $(1+1)=2$, $(1+1)=2$, and $2$, respectively. The problem is a standard, solvable exercise in statistical phylogenetics.\n\nStep 3: Verdict and Action.\nThe problem is valid. I will now proceed to provide a complete solution.\n\nThe solution requires three main parts: 1) construction of the phylogenetic variance-covariance matrix $V$, 2) derivation of the Generalized Least Squares (GLS) estimator for $\\beta$ and its sampling covariance, and 3) computation of the numerical values for the given data.\n\nPart 1: Construction of the Variance-Covariance Matrix $V$.\nFirst, we construct the covariance matrix under a pure Brownian motion model, which we denote as $C$. The species are ordered $(A, B, C)$. The elements $C_{ij}$ are given by the shared evolutionary path length from the root to the most recent common ancestor (MRCA) of species $i$ and $j$, multiplied by the rate parameter $\\sigma^2$. The diagonal elements $C_{ii}$ are the total path length from the root to the tip, multiplied by $\\sigma^2$. We are given $\\sigma^2=1$.\n\n- For the diagonal elements (variances):\n  - $V_{AA} = \\text{pathlength(root, A)} \\times \\sigma^2 = (1+1) \\times 1 = 2$.\n  - $V_{BB} = \\text{pathlength(root, B)} \\times \\sigma^2 = (1+1) \\times 1 = 2$.\n  - $V_{CC} = \\text{pathlength(root, C)} \\times \\sigma^2 = 2 \\times 1 = 2$.\n\n- For the off-diagonal elements (covariances):\n  - $V_{AB} = \\text{pathlength(root, MRCA(A,B))} \\times \\sigma^2 = 1 \\times 1 = 1$.\n  - $V_{AC} = \\text{pathlength(root, MRCA(A,C))} \\times \\sigma^2 = 0 \\times 1 = 0$. (The MRCA is the root itself).\n  - $V_{BC} = \\text{pathlength(root, MRCA(B,C))} \\times \\sigma^2 = 0 \\times 1 = 0$.\n\nBy symmetry, $V_{BA}=V_{AB}$, $V_{CA}=V_{AC}$, and $V_{CB}=V_{BC}$. The Brownian motion covariance matrix $C$ is thus:\n$$ C = \\begin{pmatrix} 2 & 1 & 0 \\\\ 1 & 2 & 0 \\\\ 0 & 0 & 2 \\end{pmatrix} $$\nNext, we apply the Pagel's lambda transformation to obtain the final matrix $V$. The diagonal elements remain unchanged, while the off-diagonal elements are multiplied by $\\lambda$. The problem specifies $\\lambda=1$.\n$$ V_{ii} = C_{ii} $$\n$$ V_{ij} = \\lambda C_{ij} \\quad \\text{for } i \\neq j $$\nWith $\\lambda=1$, the transformation does not alter the matrix. Therefore, $V = C$.\n$$ V = \\begin{pmatrix} 2 & 1 & 0 \\\\ 1 & 2 & 0 \\\\ 0 & 0 & 2 \\end{pmatrix} $$\n\nPart 2: Derivation of the GLS Estimator and its Covariance.\nThe model is $y \\sim \\mathcal{N}(X\\beta, V)$. The log-likelihood function for the parameter vector $\\beta$ is:\n$$ \\ell(\\beta | y, X, V) = -\\frac{n}{2}\\ln(2\\pi) - \\frac{1}{2}\\ln(\\det(V)) - \\frac{1}{2}(y - X\\beta)^{\\prime} V^{-1} (y - X\\beta) $$\nTo find the maximum likelihood estimator $\\hat{\\beta}$, we must maximize $\\ell(\\beta)$. This is equivalent to minimizing the quadratic form $Q(\\beta) = (y - X\\beta)^{\\prime} V^{-1} (y - X\\beta)$. We expand this expression:\n$$ Q(\\beta) = (y^{\\prime} - \\beta^{\\prime}X^{\\prime})V^{-1}(y - X\\beta) = y^{\\prime}V^{-1}y - y^{\\prime}V^{-1}X\\beta - \\beta^{\\prime}X^{\\prime}V^{-1}y + \\beta^{\\prime}X^{\\prime}V^{-1}X\\beta $$\nSince $y^{\\prime}V^{-1}X\\beta$ is a scalar, it equals its transpose, $(\\beta^{\\prime}X^{\\prime}V^{-1}y)$. Thus:\n$$ Q(\\beta) = y^{\\prime}V^{-1}y - 2\\beta^{\\prime}X^{\\prime}V^{-1}y + \\beta^{\\prime}X^{\\prime}V^{-1}X\\beta $$\nTo find the minimum, we compute the gradient with respect to $\\beta$ and set it to zero:\n$$ \\frac{\\partial Q(\\beta)}{\\partial \\beta} = -2X^{\\prime}V^{-1}y + 2X^{\\prime}V^{-1}X\\beta = 0 $$\n$$ X^{\\prime}V^{-1}X\\hat{\\beta} = X^{\\prime}V^{-1}y $$\nSolving for $\\hat{\\beta}$ gives the GLS estimator:\n$$ \\hat{\\beta} = (X^{\\prime}V^{-1}X)^{-1}X^{\\prime}V^{-1}y $$\nThe sampling covariance of this estimator is derived as follows:\n$$ \\text{Cov}(\\hat{\\beta}) = \\text{Cov}((X^{\\prime}V^{-1}X)^{-1}X^{\\prime}V^{-1}y) $$\nUsing the property $\\text{Cov}(Ay) = A\\text{Cov}(y)A^{\\prime}$ with $A = (X^{\\prime}V^{-1}X)^{-1}X^{\\prime}V^{-1}$ and $\\text{Cov}(y) = V$:\n$$ \\text{Cov}(\\hat{\\beta}) = [(X^{\\prime}V^{-1}X)^{-1}X^{\\prime}V^{-1}] V [(X^{\\prime}V^{-1}X)^{-1}X^{\\prime}V^{-1}]^{\\prime} $$\n$$ \\text{Cov}(\\hat{\\beta}) = (X^{\\prime}V^{-1}X)^{-1}X^{\\prime}V^{-1} V (V^{-1})^{\\prime}X(X^{\\prime}V^{-1}X)^{-1} $$\nSince $V$ is symmetric, $V^{-1}$ is symmetric, so $(V^{-1})^{\\prime} = V^{-1}$.\n$$ \\text{Cov}(\\hat{\\beta}) = (X^{\\prime}V^{-1}X)^{-1}X^{\\prime}(V^{-1}V)V^{-1}X(X^{\\prime}V^{-1}X)^{-1} $$\n$$ \\text{Cov}(\\hat{\\beta}) = (X^{\\prime}V^{-1}X)^{-1}(X^{\\prime}V^{-1}X)(X^{\\prime}V^{-1}X)^{-1} = (X^{\\prime}V^{-1}X)^{-1} $$\n\nPart 3: Numerical Computation.\nWe have the matrices:\n$$ V = \\begin{pmatrix} 2 & 1 & 0 \\\\ 1 & 2 & 0 \\\\ 0 & 0 & 2 \\end{pmatrix}, \\quad X = \\begin{pmatrix} 1 & 0 \\\\ 1 & 1 \\\\ 1 & 2 \\end{pmatrix}, \\quad y = \\begin{pmatrix} 1 \\\\ 2 \\\\ 3 \\end{pmatrix} $$\nFirst, we find the inverse of $V$. As $V$ is block-diagonal, its inverse is the inverse of its blocks.\nThe top-left $2 \\times 2$ block is $\\begin{pmatrix} 2 & 1 \\\\ 1 & 2 \\end{pmatrix}$, with determinant $(2)(2)-(1)(1) = 3$. Its inverse is $\\frac{1}{3}\\begin{pmatrix} 2 & -1 \\\\ -1 & 2 \\end{pmatrix}$. The bottom-right $1 \\times 1$ block is $(2)$, with inverse $(1/2)$.\n$$ V^{-1} = \\begin{pmatrix} \\frac{2}{3} & -\\frac{1}{3} & 0 \\\\ -\\frac{1}{3} & \\frac{2}{3} & 0 \\\\ 0 & 0 & \\frac{1}{2} \\end{pmatrix} $$\nNext, we compute $X^{\\prime}V^{-1}X$.\n$$ X^{\\prime}V^{-1} = \\begin{pmatrix} 1 & 1 & 1 \\\\ 0 & 1 & 2 \\end{pmatrix} \\begin{pmatrix} \\frac{2}{3} & -\\frac{1}{3} & 0 \\\\ -\\frac{1}{3} & \\frac{2}{3} & 0 \\\\ 0 & 0 & \\frac{1}{2} \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{3} & \\frac{1}{3} & \\frac{1}{2} \\\\ -\\frac{1}{3} & \\frac{2}{3} & 1 \\end{pmatrix} $$\n$$ X^{\\prime}V^{-1}X = \\begin{pmatrix} \\frac{1}{3} & \\frac{1}{3} & \\frac{1}{2} \\\\ -\\frac{1}{3} & \\frac{2}{3} & 1 \\end{pmatrix} \\begin{pmatrix} 1 & 0 \\\\ 1 & 1 \\\\ 1 & 2 \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{3}+\\frac{1}{3}+\\frac{1}{2} & 0+\\frac{1}{3}+1 \\\\ -\\frac{1}{3}+\\frac{2}{3}+1 & 0+\\frac{2}{3}+2 \\end{pmatrix} = \\begin{pmatrix} \\frac{7}{6} & \\frac{4}{3} \\\\ \\frac{4}{3} & \\frac{8}{3} \\end{pmatrix} $$\nNow we compute the inverse of this matrix, which is the sampling covariance of $\\hat{\\beta}$, $\\text{Cov}(\\hat{\\beta})$.\n$$ \\det(X^{\\prime}V^{-1}X) = \\left(\\frac{7}{6}\\right)\\left(\\frac{8}{3}\\right) - \\left(\\frac{4}{3}\\right)^2 = \\frac{56}{18} - \\frac{16}{9} = \\frac{28}{9} - \\frac{16}{9} = \\frac{12}{9} = \\frac{4}{3} $$\n$$ \\text{Cov}(\\hat{\\beta}) = (X^{\\prime}V^{-1}X)^{-1} = \\frac{1}{4/3} \\begin{pmatrix} \\frac{8}{3} & -\\frac{4}{3} \\\\ -\\frac{4}{3} & \\frac{7}{6} \\end{pmatrix} = \\frac{3}{4} \\begin{pmatrix} \\frac{8}{3} & -\\frac{4}{3} \\\\ -\\frac{4}{3} & \\frac{7}{6} \\end{pmatrix} = \\begin{pmatrix} 2 & -1 \\\\ -1 & \\frac{7}{8} \\end{pmatrix} $$\nThis gives the four entries of the sampling covariance matrix.\n\nFinally, we compute the estimator $\\hat{\\beta}$. First, we need $X^{\\prime}V^{-1}y$:\n$$ X^{\\prime}V^{-1}y = \\begin{pmatrix} \\frac{1}{3} & \\frac{1}{3} & \\frac{1}{2} \\\\ -\\frac{1}{3} & \\frac{2}{3} & 1 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 2 \\\\ 3 \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{3}+\\frac{2}{3}+\\frac{3}{2} \\\\ -\\frac{1}{3}+\\frac{4}{3}+3 \\end{pmatrix} = \\begin{pmatrix} 1+\\frac{3}{2} \\\\ 1+3 \\end{pmatrix} = \\begin{pmatrix} \\frac{5}{2} \\\\ 4 \\end{pmatrix} $$\nNow, we can calculate $\\hat{\\beta}$:\n$$ \\hat{\\beta} = (X^{\\prime}V^{-1}X)^{-1} (X^{\\prime}V^{-1}y) = \\begin{pmatrix} 2 & -1 \\\\ -1 & \\frac{7}{8} \\end{pmatrix} \\begin{pmatrix} \\frac{5}{2} \\\\ 4 \\end{pmatrix} = \\begin{pmatrix} 2(\\frac{5}{2}) - 1(4) \\\\ -1(\\frac{5}{2}) + \\frac{7}{8}(4) \\end{pmatrix} = \\begin{pmatrix} 5-4 \\\\ -\\frac{5}{2} + \\frac{7}{2} \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} $$\nThe two entries of $\\hat{\\beta}$ are $\\hat{\\beta}_0=1$ and $\\hat{\\beta}_1=1$.\n\nThe final answer requires a row matrix listing the two entries of $\\hat{\\beta}$ followed by the four entries of $(X^{\\prime}V^{-1}X)^{-1}$ in row-major order: $(\\hat{\\beta}_0, \\hat{\\beta}_1, \\text{Cov}_{11}, \\text{Cov}_{12}, \\text{Cov}_{21}, \\text{Cov}_{22})$.\nThis corresponds to $(1, 1, 2, -1, -1, \\frac{7}{8})$.", "answer": "$$\n\\boxed{\\begin{pmatrix} 1 & 1 & 2 & -1 & -1 & \\frac{7}{8} \\end{pmatrix}}\n$$", "id": "2823588"}]}