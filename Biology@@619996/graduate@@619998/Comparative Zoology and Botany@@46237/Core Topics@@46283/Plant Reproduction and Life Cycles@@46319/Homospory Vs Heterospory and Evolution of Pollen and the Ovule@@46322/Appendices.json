{"hands_on_practices": [{"introduction": "The evolution of major life-history transitions, such as the shift from homospory to heterospory, is often driven by complex trade-offs in unpredictable environments. This exercise challenges you to model the very origins of heterospory by treating it as a maternal provisioning strategy [@problem_id:2581295]. By applying a stochastic dynamic programming framework, you will determine the threshold of environmental variance at which providing a few, well-resourced megaspores becomes evolutionarily advantageous over broadcasting many unprovisioned spores, illustrating the powerful concept of ecological bet-hedging.", "problem": "You will implement a numerical procedure that formalizes when maternal provisioning via megaspores (heterospory with endosporic development) is favored over exosporic provisioning (homospory with exosporic development) in a fluctuating environment. The derivation must start from the principle that in multiplicative life histories under environmental stochasticity, natural selection maximizes long-run geometric mean fitness, which is obtained by maximizing the expected logarithm of per-generation reproductive output. Formally, assume the following.\n\n- Definitions:\n  - Let $R_t$ denote environmental resource availability experienced by the offspring of a plant in generation $t$.\n  - Let $R_t$ be strictly positive and modeled as a lognormal random variable via $R_t = \\exp(X_t)$ with $X_t \\sim \\mathcal{N}(\\mu, \\sigma^2)$, independent and identically distributed over generations.\n  - Consider two strategies $S \\in \\{E, M\\}$, where $E$ represents exosporic provisioning (homospory) and $M$ represents maternal provisioning via megaspores (heterospory).\n  - Let $n_0$ denote the baseline number of propagules produced by the exosporic strategy.\n  - Let $c \\in (0,1)$ denote the fractional reduction in propagule number under maternal provisioning due to provisioning cost, so that maternal provisioning produces $n_0 (1 - c)$ propagules.\n  - Let $\\alpha > 0$ parameterize how offspring survival responds to resources.\n  - Let $\\varepsilon \\in (0,1)$ represent a small baseline survival that prevents extinction in extremely poor environments (biologically capturing residual survival due to, for example, stored reserves or microhabitat refuges).\n  - Let $b \\in [0,1]$ be a buffering parameter capturing the fraction of effective offspring resources supplied as a fixed maternal reserve rather than being drawn from the external environment.\n  - Let $r_b > 0$ denote the per-offspring resource equivalent of maternal provisioning.\n\n- Fitness model per adult in a single generation $t$ as a function of realized resources $R_t$:\n  - Exosporic provisioning:\n    $$W_E(R_t) = n_0 \\left[ \\varepsilon + (1 - \\varepsilon)\\left(1 - e^{-\\alpha R_t}\\right) \\right].$$\n  - Maternal provisioning:\n    $$W_M(R_t) = n_0(1 - c) \\left[ \\varepsilon + (1 - \\varepsilon)\\left(1 - e^{-\\alpha \\left((1 - b) R_t + b r_b\\right)}\\right) \\right].$$\n  These expressions capture a quantity–quality trade-off: exosporic provisioning produces more propagules that depend entirely on $R_t$, while maternal provisioning produces fewer propagules with partially buffered effective resources $(1 - b)R_t + b r_b$.\n\n- Stochastic dynamic programming objective under multiplicative growth:\n  - Long-run selection favors the strategy that maximizes the expected logarithm of per-generation reproductive output. Under stationarity and independence across generations, this reduces to choosing the strategy with larger $\\mathbb{E}[\\ln W_S(R_t)]$.\n\n- Threshold definition:\n  - Define the selection differential\n    $$\\Delta(\\sigma) = \\mathbb{E}\\left[\\ln W_M(R_t)\\right] - \\mathbb{E}\\left[\\ln W_E(R_t)\\right],$$\n    where the expectation is taken with respect to $X_t \\sim \\mathcal{N}(\\mu, \\sigma^2)$ and $R_t = \\exp(X_t)$.\n  - The threshold environmental variance is the smallest variance $\\sigma^{2\\star}$ such that maternal provisioning is favored, defined by:\n    - If $\\Delta(0) \\ge 0$, then $\\sigma^{2\\star} = 0$.\n    - Else if $\\Delta(\\sigma_{\\max}) \\le 0$ for a large search bound $\\sigma_{\\max}$, then there is no threshold within $[0, \\sigma_{\\max}]$, and you must return the sentinel value $-1$.\n    - Otherwise, find $\\sigma^\\star \\in (0, \\sigma_{\\max})$ such that $\\Delta(\\sigma^\\star) = 0$ using a bracketing method, and return the variance $\\sigma^{2\\star} = (\\sigma^\\star)^2$.\n\n- Numerical evaluation of $\\mathbb{E}[\\ln W_S(R_t)]$:\n  - For $X \\sim \\mathcal{N}(\\mu, \\sigma^2)$, use Gauss–Hermite quadrature of order $n$ to evaluate\n    $$\\mathbb{E}[g(X)] = \\frac{1}{\\sqrt{\\pi}} \\sum_{i=1}^{n} w_i\\, g\\!\\left(\\mu + \\sqrt{2}\\sigma z_i\\right),$$\n    where $\\{z_i, w_i\\}_{i=1}^n$ are the Hermite nodes and weights, respectively. Set $g(x) = \\ln W_S(\\exp(x))$.\n\n- Implementation requirements:\n  - Compute $\\Delta(\\sigma)$ using Gauss–Hermite quadrature.\n  - Search for the root of $\\Delta(\\sigma)$ in $[0, \\sigma_{\\max}]$ using a bisection method with an absolute tolerance in $\\sigma$ of $10^{-6}$.\n  - If $W_S$ becomes extremely small numerically for some quadrature nodes, the $\\varepsilon$ term guarantees positivity; do not add any other ad hoc flooring.\n  - Report the threshold variance $\\sigma^{2\\star}$ as a floating-point number.\n\n- Test suite:\n  - Use the following four parameter sets, each a tuple $(n_0, c, \\alpha, \\varepsilon, b, r_b, \\mu, \\sigma_{\\max})$:\n    - Case A (typical, expect a finite interior threshold): $(200, 0.4, 0.8, 0.001, 0.6, 1.2, 0.0, 2.0)$.\n    - Case B (weak buffering and high cost, expect no threshold within range): $(200, 0.6, 0.8, 0.001, 0.2, 1.1, 0.0, 2.5)$.\n    - Case C (strong buffering and low cost, maternal favored even at low variance): $(200, 0.2, 0.8, 0.001, 0.9, 2.0, 0.0, 2.0)$.\n    - Case D (strong buffering but substantial cost, threshold may be larger): $(200, 0.5, 0.8, 0.001, 0.8, 1.0, 0.0, 3.0)$.\n\n- Output specification:\n  - For each case, compute the threshold variance $\\sigma^{2\\star}$ according to the rules above.\n  - If no threshold exists within $[0, \\sigma_{\\max}]$, output $-1$ for that case.\n  - Your program should produce a single line of output containing the four results as a comma-separated list enclosed in square brackets, with each floating-point number rounded to four decimal places (for example, $[0.0000,-1.0000,0.1234,0.0000]$).\n  - All quantities are dimensionless; no physical units are required.", "solution": "The problem statement is subjected to validation and is found to be valid. It is scientifically grounded in established principles of evolutionary biology concerning life-history strategies in stochastic environments. The formulation is mathematically sound, self-contained, and well-posed for the required numerical analysis. No logical contradictions, factual inaccuracies, or critical ambiguities are present. We shall therefore proceed with the development of the solution.\n\nThe central objective is to determine the threshold environmental variance, $\\sigma^{2\\star}$, at which a maternal provisioning strategy ($M$) becomes selectively favored over an exosporic provisioning strategy ($E$). Selection favors the strategy with the higher long-run geometric mean fitness, which is equivalent to maximizing the expected logarithm of the per-generation number of surviving offspring, $\\mathbb{E}[\\ln W_S]$. The selection differential, $\\Delta(\\sigma)$, quantifies the fitness advantage of strategy $M$ over strategy $E$ as a function of environmental standard deviation $\\sigma$. It is defined as:\n$$\n\\Delta(\\sigma) = \\mathbb{E}\\left[\\ln W_M(R_t)\\right] - \\mathbb{E}\\left[\\ln W_E(R_t)\\right]\n$$\nThe expectation is taken over the distribution of the environmental resource variable $R_t = \\exp(X_t)$, where $X_t$ follows a normal distribution $\\mathcal{N}(\\mu, \\sigma^2)$. The fitness functions for a single generation, $W_E(R_t)$ and $W_M(R_t)$, are provided as:\n$$\nW_E(R_t) = n_0 \\left[ \\varepsilon + (1 - \\varepsilon)\\left(1 - e^{-\\alpha R_t}\\right) \\right]\n$$\n$$\nW_M(R_t) = n_0(1 - c) \\left[ \\varepsilon + (1 - \\varepsilon)\\left(1 - e^{-\\alpha \\left((1 - b) R_t + b r_b\\right)}\\right) \\right]\n$$\nwhere the parameters $n_0, c, \\alpha, \\varepsilon, b, r_b$ are all defined in the problem statement.\n\nThe analytical evaluation of the expectation $\\mathbb{E}[\\ln W_S(R_t)]$ is intractable due to the nonlinear transformation of the lognormally distributed variable $R_t$. Consequently, a numerical approach is required. The problem mandates the use of Gauss-Hermite quadrature to approximate the expectation of a function $g(X)$ where $X \\sim \\mathcal{N}(\\mu, \\sigma^2)$:\n$$\n\\mathbb{E}[g(X)] = \\int_{-\\infty}^{\\infty} g(x) \\frac{1}{\\sqrt{2\\pi\\sigma^2}} e^{-\\frac{(x-\\mu)^2}{2\\sigma^2}} dx \\approx \\frac{1}{\\sqrt{\\pi}} \\sum_{i=1}^{n} w_i\\, g\\!\\left(\\mu + \\sqrt{2}\\sigma z_i\\right)\n$$\nHere, $\\{z_i, w_i\\}_{i=1}^n$ are the nodes and weights for the physicist's Hermite polynomials of order $n$. The functions to be integrated are $g_E(x) = \\ln(W_E(e^x))$ and $g_M(x) = \\ln(W_M(e^x))$. A sufficiently large order, such as $n=64$, will be used to ensure numerical accuracy.\n\nThe threshold variance $\\sigma^{2\\star}$ is found by locating the root of $\\Delta(\\sigma)$. The search for the root $\\sigma^\\star \\ge 0$ follows a strict procedure:\n1.  First, evaluate $\\Delta(\\sigma)$ at $\\sigma=0$. This corresponds to a deterministic environment with constant resources $R_t = e^\\mu$. If $\\Delta(0) \\ge 0$, strategy $M$ is superior even without environmental fluctuations, so the threshold variance $\\sigma^{2\\star}$ is $0$.\n2.  If $\\Delta(0) < 0$, we then evaluate $\\Delta(\\sigma)$ at the specified upper bound, $\\sigma_{\\max}$. If $\\Delta(\\sigma_{\\max}) \\le 0$, it implies that for the entire range of environmental variance considered, $[0, \\sigma_{\\max}^2]$, the exosporic strategy remains favored. In this case, no threshold is found, and the result is the sentinel value $-1$.\n3.  If $\\Delta(0) < 0$ and $\\Delta(\\sigma_{\\max}) > 0$, the function $\\Delta(\\sigma)$ must cross zero for some $\\sigma^\\star \\in (0, \\sigma_{\\max})$, assuming continuity. We employ the bisection method to find this root. The initial search interval is $[\\sigma_{low}, \\sigma_{high}] = [0, \\sigma_{\\max}]$. We iteratively compute the midpoint $\\sigma_{mid} = (\\sigma_{low} + \\sigma_{high}) / 2$ and evaluate $\\Delta(\\sigma_{mid})$. If $\\Delta(\\sigma_{mid}) < 0$, the root must lie in $[\\sigma_{mid}, \\sigma_{high}]$, so we set $\\sigma_{low} = \\sigma_{mid}$. Otherwise, the root is in $[\\sigma_{low}, \\sigma_{mid}]$, so we set $\\sigma_{high} = \\sigma_{mid}$. This process is repeated until the interval width, $(\\sigma_{high} - \\sigma_{low})$, is smaller than the specified absolute tolerance of $10^{-6}$.\n4.  The root found by this procedure is $\\sigma^\\star$. The final result is the threshold variance, $\\sigma^{2\\star} = (\\sigma^\\star)^2$.\n\nThis procedure is implemented as a Python program. It defines functions to calculate the fitness expressions, a function to compute $\\Delta(\\sigma)$ using Gauss-Hermite quadrature, and a main function that applies the bisection logic to find the threshold variance for each test case as specified. The `scipy.special.roots_hermite` function provides the necessary nodes and weights for the quadrature.", "answer": "```python\nimport numpy as np\nfrom scipy.special import roots_hermite\n\ndef solve():\n    \"\"\"\n    Computes the threshold environmental variance for maternal provisioning.\n    \"\"\"\n\n    # Test suite: tuples of (n0, c, alpha, epsilon, b, rb, mu, sigma_max)\n    test_cases = [\n        # Case A\n        (200.0, 0.4, 0.8, 0.001, 0.6, 1.2, 0.0, 2.0),\n        # Case B\n        (200.0, 0.6, 0.8, 0.001, 0.2, 1.1, 0.0, 2.5),\n        # Case C\n        (200.0, 0.2, 0.8, 0.001, 0.9, 2.0, 0.0, 2.0),\n        # Case D\n        (200.0, 0.5, 0.8, 0.001, 0.8, 1.0, 0.0, 3.0),\n    ]\n    \n    # Quadrature order\n    QUAD_ORDER = 64\n    nodes, weights = roots_hermite(QUAD_ORDER)\n\n    def calculate_delta(sigma, params):\n        \"\"\"\n        Calculates the selection differential Delta(sigma) using Gauss-Hermite quadrature.\n        \"\"\"\n        n0, c, alpha, epsilon, b, rb, mu, _ = params\n        \n        # Transformation for quadrature: x = mu + sqrt(2)*sigma*z\n        x_nodes = mu + np.sqrt(2.0) * sigma * nodes\n        # Environmental resources at quadrature nodes: R = exp(x)\n        r_nodes = np.exp(x_nodes)\n        \n        # Fitness for Exosporic strategy (E)\n        survival_e = epsilon + (1.0 - epsilon) * (1.0 - np.exp(-alpha * r_nodes))\n        w_e = n0 * survival_e\n        \n        # Fitness for Maternal provisioning strategy (M)\n        effective_resources_m = (1.0 - b) * r_nodes + b * rb\n        survival_m = epsilon + (1.0 - epsilon) * (1.0 - np.exp(-alpha * effective_resources_m))\n        w_m = n0 * (1.0 - c) * survival_m\n        \n        # Calculate expected log-fitness using quadrature formula\n        # E[g(X)] approx= (1/sqrt(pi)) * sum(w_i * g(x_i))\n        # Note: log is taken after computing W, as W is always > 0 due to epsilon.\n        e_ln_we = np.sum(weights * np.log(w_e)) / np.sqrt(np.pi)\n        e_ln_wm = np.sum(weights * np.log(w_m)) / np.sqrt(np.pi)\n        \n        return e_ln_wm - e_ln_we\n\n    def find_threshold_variance(params):\n        \"\"\"\n        Finds the threshold variance sigma^2* for a given parameter set.\n        \"\"\"\n        _, _, _, _, _, _, _, sigma_max = params\n        tol = 1e-6\n        \n        # Step 1: Check delta at sigma = 0\n        delta_at_zero = calculate_delta(0.0, params)\n        if delta_at_zero >= 0:\n            return 0.0\n            \n        # Step 2: Check delta at sigma_max\n        delta_at_max = calculate_delta(sigma_max, params)\n        if delta_at_max <= 0:\n            return -1.0\n            \n        # Step 3: Bisection method to find root sigma*\n        sigma_low = 0.0\n        sigma_high = sigma_max\n        \n        while (sigma_high - sigma_low) > tol:\n            sigma_mid = (sigma_low + sigma_high) / 2.0\n            delta_mid = calculate_delta(sigma_mid, params)\n            \n            if delta_mid < 0:\n                sigma_low = sigma_mid\n            else:\n                sigma_high = sigma_mid\n                \n        sigma_star = (sigma_low + sigma_high) / 2.0\n        \n        # Step 4: Return the threshold variance\n        return sigma_star**2\n\n    results = []\n    for case in test_cases:\n        result = find_threshold_variance(case)\n        results.append(result)\n\n    # Format output as specified: comma-separated list in brackets, 4 decimal places.\n    formatted_results = [f\"{r:.4f}\" for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2581295"}, {"introduction": "A pivotal consequence of heterospory is the physical separation of male and female gametophytes, which drastically alters a plant's mating system. This practice provides a quantitative lens to examine this change by modeling the competition between self-fertilization and outcrossing as a race between two independent processes [@problem_id:2581274]. You will use fundamental principles of probability to derive and compare the expected selfing rates for both a homosporous lineage capable of intragametophytic selfing and a heterosporous lineage limited to intergametophytic selfing.", "problem": "A central evolutionary consequence of the transition from homospory to heterospory is the constraint that sex separation places on the mechanism and opportunity for self-fertilization. In a homosporous lineage, a single haploid spore can develop into a bisexual gametophyte capable of intragametophytic selfing (fusion of gametes produced by the same haploid gametophyte). In a heterosporous lineage (including seed plants), the male and female gametophytes are segregated into microspores and megaspores, so self-fertilization—if it occurs—must be intergametophytic, namely fertilization between male and female gametophytes derived from the same diploid sporophyte via its own pollen delivery.\n\nConsider the following mechanistic models, grounded in standard definitions and the well-tested stochastic description of mating as competing arrival processes.\n\n1. Homosporous case (intragametophytic selfing): A proportion $q \\in [0,1]$ of gametophytes are bisexual. For a bisexual gametophyte, the time $T_{s}$ until its own sperm reaches and successfully fertilizes one of its own archegonia is modeled as an exponential random variable with rate $\\mu \\gt 0$. Concurrently, outcross sperm from neighboring gametophytes arrive with independent Poisson dynamics such that the time $T_{o}$ to the first outcross fertilization opportunity at that archegonium is exponential with rate $\\lambda \\ge 0$. Fertilization occurs at the first arrival, that is, at $\\min\\{T_{s},T_{o}\\}$. Assume each bisexual gametophyte contributes at most one zygote. Unisexual gametophytes (proportion $1-q$) cannot intragametophytically self and contribute zero to intragametophytic selfing.\n\n2. Heterosporous case (intergametophytic selfing): At a given diploid sporophyte, ovules receive self pollen from the same sporophyte at rate $\\sigma \\ge 0$ and outcross pollen from other sporophytes at rate $\\tau \\ge 0$. Let the time to the first successful self pollen tube, $S$, be exponential with rate $\\sigma$, and the time to the first successful outcross pollen tube, $O$, be exponential with rate $\\tau$, with independence. Fertilization occurs at the first arrival, that is, at $\\min\\{S,O\\}$. There is no self-incompatibility.\n\nDefine the selfing rate as the fraction of zygotes formed by self-fertilization under each life history: for the homosporous case, intragametophytic selfing on bisexual gametophytes; for the heterosporous case, intergametophytic selfing via self pollen from the same sporophyte.\n\nUsing only the above assumptions and the fundamental properties of independent Poisson arrival processes and exponential waiting times, derive closed-form expressions for:\n- the expected intragametophytic selfing rate in the homosporous case, $S_{\\text{homo}}$, and\n- the expected intergametophytic selfing rate in the heterosporous case, $S_{\\text{hetero}}$,\n\nin terms of $q$, $\\mu$, $\\lambda$, $\\sigma$, and $\\tau$. Express your final answer as a single row vector $\\big(S_{\\text{homo}}, S_{\\text{hetero}}\\big)$ in simplest analytic form. No numerical evaluation is required.", "solution": "The problem statement will be validated before any attempt at a solution.\n\n**Problem Validation**\n\n**Step 1: Extract Givens**\n\n*   **Homosporous Model:**\n    *   A proportion $q \\in [0,1]$ of gametophytes are bisexual.\n    *   Time to intragametophytic self-fertilization for a bisexual gametophyte, $T_s$, is an exponential random variable with rate $\\mu > 0$.\n    *   Time to first outcross fertilization for a bisexual gametophyte, $T_o$, is an exponential random variable with rate $\\lambda \\ge 0$.\n    *   $T_s$ and $T_o$ are independent.\n    *   Fertilization occurs at time $\\min\\{T_s, T_o\\}$.\n    *   A proportion $1-q$ of gametophytes are unisexual and cannot self-fertilize.\n\n*   **Heterosporous Model:**\n    *   Time to self-fertilization for an ovule, $S$, is an exponential random variable with rate $\\sigma \\ge 0$.\n    *   Time to outcross-fertilization for an ovule, $O$, is an exponential random variable with rate $\\tau \\ge 0$.\n    *   $S$ and $O$ are independent.\n    *   Fertilization occurs at time $\\min\\{S, O\\}$.\n    *   There is no self-incompatibility.\n\n*   **Definition:**\n    *   The selfing rate is the fraction of zygotes formed by self-fertilization.\n\n*   **Objective:**\n    *   Derive closed-form expressions for the homosporous selfing rate, $S_{\\text{homo}}$, and the heterosporous selfing rate, $S_{\\text{hetero}}$.\n    *   The final answer must be a row vector $(S_{\\text{homo}}, S_{\\text{hetero}})$.\n\n**Step 2: Validate Using Extracted Givens**\n\nThe problem is assessed based on the provided validation criteria.\n\n*   **Scientifically Grounded:** The problem is based on established concepts in plant evolutionary biology (homospory, heterospory, selfing vs. outcrossing). The modeling approach, using competing Poisson processes (represented by exponential waiting times), is a standard and valid method in theoretical population genetics and ecology.\n*   **Well-Posed:** The problem is clearly stated. All necessary variables ($q$, $\\mu$, $\\lambda$, $\\sigma$, $\\tau$) and their constraints are defined. The objective is specific and achievable using standard probability theory.\n*   **Objective:** The language is formal, precise, and devoid of subjectivity or opinion.\n\nThe problem does not exhibit any of the listed flaws (e.g., scientific unsoundness, incompleteness, contradiction, ambiguity). The assumptions, while simplifications of a complex biological reality, are clearly stated and form a self-contained, solvable mathematical problem.\n\n**Step 3: Verdict and Action**\n\nThe problem is **valid**. A solution will be derived.\n\n**Derivation of Selfing Rates**\n\nThe core of this problem relies on a fundamental property of independent exponential random variables. If a random variable $X_1$ follows an exponential distribution with rate parameter $\\alpha_1$, and another independent random variable $X_2$ follows an exponential distribution with rate parameter $\\alpha_2$, then the probability that $X_1$ occurs before $X_2$ is given by:\n$$\nP(X_1 < X_2) = \\frac{\\alpha_1}{\\alpha_1 + \\alpha_2}\n$$\nThis result stems from the memoryless property of the exponential distribution and represents the outcome of a competition between two independent Poisson processes.\n\n**1. Homosporous Selfing Rate ($S_{\\text{homo}}$)**\n\nThe selfing rate, $S_{\\text{homo}}$, is defined as the fraction of all zygotes in the population that are formed by intragametophytic self-fertilization.\n\nThe population of gametophytes is partitioned into two types:\n*   A proportion $q$ are bisexual. These are capable of both self-fertilization and outcrossing.\n*   A proportion $1-q$ are unisexual. The problem states they contribute zero to intragametophytic selfing, implying they can only be outcrossed.\n\nWe assume that all gametophytes that are female-receptive (i.e., possess archegonia) will eventually form a single zygote, whether through selfing or outcrossing. This assumption is implicit in the \"first arrival\" fertilization model.\n\nConsider a single bisexual gametophyte. The competition is between self-fertilization (event time $T_s$, where $T_s \\sim \\text{Exponential}(\\mu)$) and outcross-fertilization (event time $T_o$, where $T_o \\sim \\text{Exponential}(\\lambda)$). The probability that this gametophyte undergoes self-fertilization is the probability that the selfing event occurs before the outcrossing event:\n$$\nP(\\text{selfing} | \\text{bisexual}) = P(T_s < T_o) = \\frac{\\mu}{\\mu + \\lambda}\n$$\nSelf-fertilization can only occur in the subpopulation of bisexual gametophytes, which constitutes a fraction $q$ of the total population of gametophytes. Therefore, the fraction of all zygotes formed through selfing is the product of the proportion of gametophytes that can self-fertilize and the conditional probability that they do so.\n$$\nS_{\\text{homo}} = P(\\text{selfing}) = P(\\text{selfing} | \\text{bisexual}) \\times P(\\text{bisexual})\n$$\nSubstituting the given proportion $q$ for $P(\\text{bisexual})$ and the derived probability for the conditional term, we obtain:\n$$\nS_{\\text{homo}} = \\left(\\frac{\\mu}{\\mu + \\lambda}\\right) \\times q\n$$\nThus, the expected intragametophytic selfing rate is $S_{\\text{homo}} = \\frac{q\\mu}{\\mu + \\lambda}$.\n\n**2. Heterosporous Selfing Rate ($S_{\\text{hetero}}$)**\n\nIn the heterosporous case, selfing is intergametophytic. We consider a single ovule on a diploid sporophyte. This ovule is the site of competition between self-pollen produced by the same sporophyte and outcross-pollen from other sporophytes.\n\nThe problem models this competition with two independent exponential random variables:\n*   Time to successful fertilization by self-pollen, $S$, where $S \\sim \\text{Exponential}(\\sigma)$.\n*   Time to successful fertilization by outcross-pollen, $O$, where $O \\sim \\text{Exponential}(\\tau)$.\n\nThe selfing rate, $S_{\\text{hetero}}$, is the probability that a given zygote is formed by self-pollen. This is equivalent to the probability that the self-fertilization event occurs before the outcross-fertilization event for any given ovule.\n$$\nS_{\\text{hetero}} = P(S < O)\n$$\nUsing the standard formula for competing exponential processes, we have:\n$$\nS_{\\text{hetero}} = \\frac{\\sigma}{\\sigma + \\tau}\n$$\nThis expression represents the fraction of all ovules that are expected to be fertilized by self-pollen, given the arrival rates $\\sigma$ and $\\tau$ and the absence of self-incompatibility.\n\n**Conclusion**\n\nThe derived expressions for the two selfing rates are:\n*   $S_{\\text{homo}} = \\frac{q\\mu}{\\mu + \\lambda}$\n*   $S_{\\text{hetero}} = \\frac{\\sigma}{\\sigma + \\tau}$\n\nThe final answer is to be presented as a single row vector $(S_{\\text{homo}}, S_{\\text{hetero}})$.", "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{q\\mu}{\\mu + \\lambda} & \\frac{\\sigma}{\\sigma + \\tau} \\end{pmatrix}}\n$$", "id": "2581274"}, {"introduction": "The advent of heterospory introduced a new functional role: the microspore, a miniaturized male gametophyte precursor adapted for dispersal. This specialization, however, creates new biophysical challenges, such as the trade-off between being small enough to travel far and being robust enough to survive environmental stressors. In this problem, you will apply the Beer-Lambert law of light attenuation to a biological optimization scenario, calculating the minimum viable size of a pollen grain that can withstand damaging UV radiation while containing the necessary cellular machinery for germination [@problem_id:2581213].", "problem": "Heterosporous lineages that produce pollen (male microspores) often experience selection for microspore miniaturization to facilitate dispersal and faster male gametophyte development, while terrestrial ultraviolet (UV) exposure selects for sufficient sporopollenin shielding to protect deoxyribonucleic acid (DNA). Consider a spherical microspore with a sporopollenin exine of uniform thickness and a cytoplasmic protoplast inside. Assume ultraviolet-B (UV-B) irradiance during dispersal imposes a constraint that the time-integrated UV-B photon fluence incident on the genome inside the spore must not exceed a critical value for viability. You may assume that attenuation of UV through sporopollenin follows the Beer–Lambert law with absorption coefficient $\\alpha$ that is constant across the exine, and that the protoplast itself does not significantly attenuate UV-B. Let the external time-integrated UV-B photon fluence during the dispersal interval be $\\Phi_{0}$ (photons $\\mathrm{m}^{-2}$), and let the maximum internally tolerated fluence at the genome be $\\Phi_{\\mathrm{crit}}$ (photons $\\mathrm{m}^{-2}$). Let the minimum viable protoplast radius required for functional male gametophyte initiation be $r_{\\mathrm{p,min}}$. Assume a spherical spore of radius $r$ with exine thickness $t$, so the protoplast radius is $r - t$.\n\nUsing only these assumptions and standard geometric relations, derive the minimum feasible spore diameter that simultaneously satisfies the UV shielding requirement and the protoplast size requirement. Then evaluate it numerically for the following empirically grounded parameters: $\\alpha = 1.3 \\ \\mu \\mathrm{m}^{-1}$, $\\Phi_{0} = 1.0 \\times 10^{20}$ photons $\\mathrm{m}^{-2}$, $\\Phi_{\\mathrm{crit}} = 5.0 \\times 10^{17}$ photons $\\mathrm{m}^{-2}$, and $r_{\\mathrm{p,min}} = 3.0 \\ \\mu \\mathrm{m}$. Express your final answer as the minimum diameter in $\\mu \\mathrm{m}$ and round to $3$ significant figures.", "solution": "An analysis of the problem statement reveals that it is scientifically grounded, well-posed, and contains sufficient information for a unique solution. The problem is a biophysical optimization under two constraints, a standard exercise in quantitative biology. It is therefore deemed valid, and I shall proceed with the derivation.\n\nThe problem requires the determination of the minimum feasible spore diameter, $D$. The spore is modeled as a sphere of radius $r$ composed of an inner protoplast of radius $r_{\\mathrm{p}}$ and an outer protective exine of uniform thickness $t$. The total radius is thus given by the sum $r = r_{\\mathrm{p}} + t$. The diameter is $D = 2r = 2(r_{\\mathrm{p}} + t)$. To minimize the diameter $D$, we must minimize the radius $r$, which in turn requires minimizing the sum of the protoplast radius $r_{\\mathrm{p}}$ and the exine thickness $t$. This minimization is subject to two independent constraints.\n\nFirst Constraint: Protoplast Viability.\nThe problem states there is a minimum viable protoplast radius, $r_{\\mathrm{p,min}}$, required for the initiation of a functional male gametophyte. Therefore, any feasible spore must satisfy the condition:\n$$r_{\\mathrm{p}} \\ge r_{\\mathrm{p,min}}$$\nThe minimum possible value for the protoplast radius is thus $r_{\\mathrm{p,min}}$.\n\nSecond Constraint: UV-B Shielding.\nThe attenuation of ultraviolet-B (UV-B) radiation through the sporopollenin exine is governed by the Beer–Lambert law. The fluence at the surface of the protoplast, $\\Phi_{\\mathrm{p}}$, after passing through an exine of thickness $t$, is related to the external incident fluence, $\\Phi_{0}$, by the equation:\n$$\\Phi_{\\mathrm{p}} = \\Phi_{0} \\exp(-\\alpha t)$$\nHere, $\\alpha$ is the absorption coefficient of sporopollenin. The problem stipulates that the protoplast itself provides negligible attenuation and that the time-integrated fluence at the genome must not exceed a critical value, $\\Phi_{\\mathrm{crit}}$. This imposes the following inequality on the exine thickness:\n$$\\Phi_{0} \\exp(-\\alpha t) \\le \\Phi_{\\mathrm{crit}}$$\nTo find the minimum required thickness, we solve this inequality for $t$.\n$$\\exp(-\\alpha t) \\le \\frac{\\Phi_{\\mathrm{crit}}}{\\Phi_{0}}$$\nTaking the natural logarithm of both sides:\n$$-\\alpha t \\le \\ln\\left(\\frac{\\Phi_{\\mathrm{crit}}}{\\Phi_{0}}\\right)$$\nMultiplying by $-1$ reverses the inequality sign:\n$$\\alpha t \\ge -\\ln\\left(\\frac{\\Phi_{\\mathrm{crit}}}{\\Phi_{0}}\\right)$$\nUsing the property of logarithms that $-\\ln(x) = \\ln(1/x)$:\n$$\\alpha t \\ge \\ln\\left(\\frac{\\Phi_{0}}{\\Phi_{\\mathrm{crit}}}\\right)$$\nFinally, solving for the thickness $t$:\n$$t \\ge \\frac{1}{\\alpha} \\ln\\left(\\frac{\\Phi_{0}}{\\Phi_{\\mathrm{crit}}}\\right)$$\nThis establishes the minimum required exine thickness, which we shall denote $t_{\\mathrm{min}}$:\n$$t_{\\mathrm{min}} = \\frac{1}{\\alpha} \\ln\\left(\\frac{\\Phi_{0}}{\\Phi_{\\mathrm{crit}}}\\right)$$\n\nMinimization of Spore Diameter.\nThe spore radius is $r = r_{\\mathrm{p}} + t$. To find the minimum possible spore radius, $r_{\\mathrm{min}}$, we must satisfy both constraints simultaneously. Since the total radius is a simple sum of the protoplast radius and the exine thickness, and these two quantities are constrained independently from below ($r_{\\mathrm{p}} \\ge r_{\\mathrm{p,min}}$ and $t \\ge t_{\\mathrm{min}}$), the minimum value of the sum is achieved when each component takes its minimum possible value.\nTherefore, the minimum feasible spore radius is:\n$$r_{\\mathrm{min}} = r_{\\mathrm{p,min}} + t_{\\mathrm{min}}$$\nSubstituting the expression for $t_{\\mathrm{min}}$:\n$$r_{\\mathrm{min}} = r_{\\mathrm{p,min}} + \\frac{1}{\\alpha} \\ln\\left(\\frac{\\Phi_{0}}{\\Phi_{\\mathrm{crit}}}\\right)$$\nThe problem asks for the minimum feasible diameter, $D_{\\mathrm{min}}$, which is $2r_{\\mathrm{min}}$.\n$$D_{\\mathrm{min}} = 2 \\left( r_{\\mathrm{p,min}} + \\frac{1}{\\alpha} \\ln\\left(\\frac{\\Phi_{0}}{\\Phi_{\\mathrm{crit}}}\\right) \\right)$$\nThis is the final analytical expression for the minimum feasible spore diameter.\n\nNumerical Evaluation.\nWe are given the following parameter values:\n$\\alpha = 1.3 \\ \\mu \\mathrm{m}^{-1}$\n$\\Phi_{0} = 1.0 \\times 10^{20}$ photons $\\mathrm{m}^{-2}$\n$\\Phi_{\\mathrm{crit}} = 5.0 \\times 10^{17}$ photons $\\mathrm{m}^{-2}$\n$r_{\\mathrm{p,min}} = 3.0 \\ \\mu \\mathrm{m}$\n\nFirst, we compute the ratio of the fluences:\n$$\\frac{\\Phi_{0}}{\\Phi_{\\mathrm{crit}}} = \\frac{1.0 \\times 10^{20}}{5.0 \\times 10^{17}} = \\frac{1000 \\times 10^{17}}{5.0 \\times 10^{17}} = 200$$\nNext, we calculate the minimum required exine thickness, $t_{\\mathrm{min}}$:\n$$t_{\\mathrm{min}} = \\frac{1}{1.3} \\ln(200) \\ \\mu \\mathrm{m}$$\nUsing the value $\\ln(200) \\approx 5.298317$:\n$$t_{\\mathrm{min}} \\approx \\frac{5.298317}{1.3} \\ \\mu \\mathrm{m} \\approx 4.075628 \\ \\mu \\mathrm{m}$$\nNow, we calculate the minimum spore radius, $r_{\\mathrm{min}}$:\n$$r_{\\mathrm{min}} = r_{\\mathrm{p,min}} + t_{\\mathrm{min}} \\approx 3.0 \\ \\mu \\mathrm{m} + 4.075628 \\ \\mu \\mathrm{m} = 7.075628 \\ \\mu \\mathrm{m}$$\nFinally, we calculate the minimum spore diameter, $D_{\\mathrm{min}}$:\n$$D_{\\mathrm{min}} = 2 r_{\\mathrm{min}} \\approx 2 \\times 7.075628 \\ \\mu \\mathrm{m} = 14.151256 \\ \\mu \\mathrm{m}$$\nThe problem requires the final answer to be rounded to $3$ significant figures.\n$$D_{\\mathrm{min}} \\approx 14.2 \\ \\mu \\mathrm{m}$$\nThis result represents the smallest possible diameter for a spherical microspore that can both survive the specified UV-B exposure and remain viable for germination upon reaching a substrate.", "answer": "$$\n\\boxed{14.2}\n$$", "id": "2581213"}]}