{"hands_on_practices": [{"introduction": "A fundamental question in life-history evolution is how a parent should partition a fixed reproductive budget among its offspring. The Smith-Fretwell model provides a powerful framework for analyzing this trade-off between offspring size and number. This practice challenges you to apply this classic model to seed evolution, using calculus to determine the optimal seed mass $s^{\\ast}$ that maximizes maternal fitness under a given set of ecological conditions and developmental constraints [@problem_id:2612279]. By working through this model, you will gain hands-on experience with the principles of evolutionary optimization and understand why for some life history strategies, the best solution lies at a physiological or developmental boundary.", "problem": "A perennial angiosperm allocates a finite mass budget to maternal gamete provisioning per reproductive episode. Let $s$ denote the dry mass allocated to a single seed (including embryo and storage tissue), measured in $\\mathrm{mg}$. Empirical field data across congeners indicate that the probability that a seed of mass $s$ recruits to a first-year established seedling is well approximated by the saturating function $p(s) = 1 - \\exp(-k s)$, where $k$ is a positive constant with units $\\mathrm{mg}^{-1}$. Assume reproduction is semelparous within a season and that maternal fitness in this episode is the expected number of established offspring, which under the classical Smith–Fretwell (SF) resource allocation principle equals the product of seed number and per-seed recruitment probability. The total available reproductive resource is a fixed mass $R$ (in $\\mathrm{mg}$). Due to developmental and biomechanical constraints of embryo, testa, and minimum protective tissues, there is a strict lower bound $s \\ge s_{\\min}$ on viable seed mass.\n\nUsing only the definitions above and standard calculus, do the following:\n\n1. Starting from the SF principle and the resource constraint, formulate the maternal fitness as a function $W(s)$ and determine analytically the optimal seed mass $s^{\\ast}$ that maximizes $W(s)$ subject to the constraint $s \\ge s_{\\min}$. Your derivation should identify whether an interior optimum exists and, if not, justify the boundary solution from first principles.\n\n2. For the parameter values $R = 3.57 \\times 10^{3}\\ \\mathrm{mg}$, $k = 0.62\\ \\mathrm{mg}^{-1}$, and $s_{\\min} = 1.23\\ \\mathrm{mg}$, compute:\n   - the optimal seed mass $s^{\\ast}$ (express in $\\mathrm{mg}$), and\n   - the corresponding seed number $n = R/s^{\\ast}$ (dimensionless count of seeds).\n\n3. Assess the sensitivity of the seed number at the optimum to the parameter $k$ by computing the partial derivative $\\partial n / \\partial k$ evaluated at $s = s^{\\ast}$ for the parameter values given above. Express $\\partial n/\\partial k$ in units of $\\text{seeds} \\cdot \\mathrm{mg}$.\n\nRound all numerical answers to four significant figures. The final answer must report $s^{\\ast}$ in $\\mathrm{mg}$, $n$ as a pure number (count), and $\\partial n/\\partial k$ in $\\text{seeds} \\cdot \\mathrm{mg}$, in that order.", "solution": "The problem asks for the optimal allocation of resources to seed production for a perennial angiosperm, following the Smith–Fretwell (SF) principle. We must first validate the problem statement.\n\nStep 1: Extract Givens\n- $s$: dry mass of a single seed, in $\\mathrm{mg}$.\n- $p(s) = 1 - \\exp(-k s)$: probability of a seed of mass $s$ recruiting to a seedling.\n- $k$: a positive constant, in $\\mathrm{mg}^{-1}$.\n- $R$: total available reproductive resource mass, in $\\mathrm{mg}$.\n- Maternal fitness, $W$: expected number of established offspring, defined as (seed number) $\\times$ (per-seed recruitment probability).\n- Constraint on seed mass: $s \\ge s_{\\min}$, where $s_{\\min}$ is a strict lower bound.\n- Parameter values for numerical calculation: $R = 3.57 \\times 10^{3}\\ \\mathrm{mg}$, $k = 0.62\\ \\mathrm{mg}^{-1}$, and $s_{\\min} = 1.23\\ \\mathrm{mg}$.\n\nStep 2: Validate Using Extracted Givens\nThe problem is scientifically grounded, being a direct application of the Smith-Fretwell model, a fundamental concept in evolutionary ecology. The recruitment function $p(s)$ is a standard saturating function representing diminishing returns, which is biologically realistic. The problem is well-posed, as it seeks to maximize a defined function over a constrained domain. All parameters and constraints are clearly specified, and the units are consistent ($k \\cdot s$ is dimensionless). The problem is objective and contains no scientific or logical flaws.\n\nVerdict: The problem is valid.\n\nWe proceed with the solution.\n\nPart 1: Formulation of Maternal Fitness and Analytical Determination of Optimal Seed Mass\n\nThe number of seeds, $n$, that can be produced from a total resource mass $R$ is the total mass divided by the mass per seed, $s$.\n$$n(s) = \\frac{R}{s}$$\nThe maternal fitness, $W(s)$, is the product of the number of seeds and the per-seed recruitment probability, $p(s)$.\n$$W(s) = n(s) \\cdot p(s) = \\frac{R}{s} \\left(1 - \\exp(-k s)\\right)$$\nThe optimization problem is to find the seed mass $s^{\\ast}$ that maximizes $W(s)$ subject to the constraint $s \\ge s_{\\min} > 0$.\n\nTo find the maximum, we first compute the derivative of $W(s)$ with respect to $s$. The constant $R$ can be factored out.\n$$\\frac{dW}{ds} = R \\frac{d}{ds} \\left[ \\frac{1 - \\exp(-k s)}{s} \\right]$$\nUsing the quotient rule for differentiation, where $u(s) = 1 - \\exp(-k s)$ and $v(s) = s$:\n$u'(s) = k \\exp(-k s)$ and $v'(s) = 1$.\n$$\\frac{dW}{ds} = R \\left[ \\frac{s \\cdot (k \\exp(-k s)) - (1 - \\exp(-k s)) \\cdot 1}{s^2} \\right]$$\n$$\\frac{dW}{ds} = \\frac{R}{s^2} \\left[ k s \\exp(-k s) - 1 + \\exp(-k s) \\right]$$\n$$\\frac{dW}{ds} = \\frac{R}{s^2} \\left[ (1 + k s) \\exp(-k s) - 1 \\right]$$\nTo find critical points (potential interior optima), we set the derivative to zero: $\\frac{dW}{ds} = 0$. Since $R/s^2 > 0$ for $s>0$, this requires:\n$$(1 + k s) \\exp(-k s) - 1 = 0$$\n$$(1 + k s) = \\exp(k s)$$\nLet us analyze the equation $1+x = \\exp(x)$, where $x = ks$. Consider the function $f(x) = \\exp(x) - x - 1$. We are looking for the roots of $f(x)=0$. The derivative is $f'(x) = \\exp(x) - 1$. Setting $f'(x)=0$ gives $\\exp(x)=1$, which implies $x=0$. The second derivative is $f''(x) = \\exp(x)$, so $f''(0) = 1 > 0$, indicating that $x=0$ is a local minimum. As this is the only critical point, it is a global minimum. The minimum value is $f(0) = \\exp(0) - 0 - 1 = 0$.\nThus, the equation $f(x)=0$ has a unique solution at $x=0$. This corresponds to $ks=0$, which, given $k > 0$, implies $s = 0$.\n\nHowever, the domain of biologically viable seeds is restricted to $s \\ge s_{\\min} > 0$. There are no critical points within the interior of the domain $(s_{\\min}, \\infty)$. The optimum must therefore lie on the boundary.\n\nTo determine if it is a maximum, we must examine the sign of the derivative $\\frac{dW}{ds}$ for $s > 0$. The sign is determined by the term $g(s) = (1 + k s) \\exp(-k s) - 1$.\nAs established, the function $f(x) = \\exp(x) - x - 1$ has a global minimum of $0$ at $x=0$ and is positive for all $x \\ne 0$. This means for $x > 0$, we have $\\exp(x) > 1+x$. Rearranging, $1 > (1+x)\\exp(-x)$, so $(1+x)\\exp(-x) - 1  0$.\nSince our domain requires $s \\ge s_{\\min} > 0$ and we are given $k>0$, it follows that $x=ks > 0$. Therefore, the term $g(s) = (1+ks)\\exp(-ks) - 1$ is always negative for all $s > 0$.\nThis implies that $\\frac{dW}{ds}  0$ for all $s$ in the domain $[s_{\\min}, \\infty)$. A function with a strictly negative derivative is strictly decreasing. The maximum of a strictly decreasing function on a domain $[s_{\\min}, \\infty)$ occurs at the lowest possible value, which is the boundary point $s = s_{\\min}$.\nTherefore, the optimal seed mass is a boundary solution:\n$$s^{\\ast} = s_{\\min}$$\n\nPart 2: Numerical Computations\nGiven the parameters $R = 3.57 \\times 10^{3}\\ \\mathrm{mg}$, $k = 0.62\\ \\mathrm{mg}^{-1}$, and $s_{\\min} = 1.23\\ \\mathrm{mg}$.\n\nThe optimal seed mass $s^{\\ast}$ is:\n$$s^{\\ast} = s_{\\min} = 1.23\\ \\mathrm{mg}$$\nRounding to four significant figures as instructed:\n$$s^{\\ast} = 1.230\\ \\mathrm{mg}$$\nThe corresponding seed number at the optimum, $n^{\\ast}$, is:\n$$n^{\\ast} = \\frac{R}{s^{\\ast}} = \\frac{3.57 \\times 10^{3}}{1.23} \\approx 2902.439024...$$\nRounding to four significant figures:\n$$n^{\\ast} = 2902$$\n\nPart 3: Sensitivity Analysis\nWe are asked to compute the partial derivative $\\frac{\\partial n}{\\partial k}$ evaluated at the optimum, $s = s^{\\ast}$. The number of seeds at the optimum is denoted by $n^{\\ast}$.\nFrom Part 1, we determined that the optimal seed mass $s^{\\ast}$ is given by $s^{\\ast} = s_{\\min}$. The value of $s_{\\min}$ is a fixed lower bound, a constant that does not depend on the parameter $k$.\nTherefore, the optimal seed number is:\n$$n^{\\ast}(k) = \\frac{R}{s^{\\ast}} = \\frac{R}{s_{\\min}}$$\nThis expression for the optimal seed number $n^{\\ast}$ is independent of $k$. The sensitivity of $n^{\\ast}$ with respect to $k$ is the partial derivative:\n$$\\frac{\\partial n^{\\ast}}{\\partial k} = \\frac{\\partial}{\\partial k}\\left(\\frac{R}{s_{\\min}}\\right)$$\nSince $R$ and $s_{\\min}$ are constants with respect to $k$, the derivative is zero.\n$$\\frac{\\partial n^{\\ast}}{\\partial k} = 0$$\nThe value is exactly zero. When expressed to four significant figures as requested, we write this as $0.0000$. The units are $\\text{seeds} \\cdot \\mathrm{mg}$.\n\nFinal answers to be reported are $s^{\\ast}$, $n^{\\ast}$, and $\\frac{\\partial n^{\\ast}}{\\partial k}$.\n- Optimal seed mass $s^{\\ast} = 1.230\\ \\mathrm{mg}$.\n- Corresponding seed number $n^{\\ast} = 2902$.\n- Sensitivity $\\frac{\\partial n^{\\ast}}{\\partial k} = 0.0000\\ \\text{seeds} \\cdot \\mathrm{mg}$.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1.230  2902  0.0000\n\\end{pmatrix}\n}\n$$", "id": "2612279"}, {"introduction": "While optimal resource allocation determines seed size, a seed's ultimate success depends on the proper execution of its developmental program, which is under strict genetic control. In angiosperms, a crucial factor is the genomic balance within the endosperm, typically a $2m:1p$ ratio of maternal to paternal genomes. This practice guides you through the implementation of a computational model based on the Endosperm Balance Number (EBN) hypothesis to predict seed viability in interploid crosses [@problem_id:2612331]. This exercise will give you practical experience in translating a core concept from plant reproductive genetics into a quantitative, predictive algorithm, illuminating a key mechanism of postzygotic isolation and speciation.", "problem": "You will implement and analyze a minimal, principle-grounded model of endosperm genomic balance and seed viability in angiosperms, using only fundamental definitions and well-tested facts from plant reproductive biology. In flowering plants, double fertilization produces the endosperm by fusion of one sperm nucleus with the central cell containing two maternal haploid nuclei. This yields a canonical maternal-to-paternal genomic dosage ratio of $2\\mathrm{m}:1\\mathrm{p}$ in the endosperm. Deviations from this balance are known to impair endosperm development and can cause failure in interploid crosses. Many taxa can be approximated by an Endosperm Balance Number (EBN), which scales the effective genomic contribution of each parent. You will formalize these biological facts mathematically and compute predicted viability outcomes.\n\nStart from the following foundational base:\n- The canonical endosperm maternal-to-paternal genomic dosage ratio is $2\\mathrm{m}:1\\mathrm{p}$, arising from double fertilization where the central cell contributes two maternal haploid genomes and the sperm contributes one paternal haploid genome.\n- In a cross between a maternal sporophyte of ploidy $P_m$ and a paternal sporophyte of ploidy $P_p$, assume meiosis produces reduced gametes so that maternal haploid gametes carry $P_m/2$ genome sets and paternal haploid sperm carry $P_p/2$ genome sets.\n- The central cell carries two maternal haploid nuclei before fertilization, so the raw genomic dosage in the endosperm is maternal $2\\cdot(P_m/2)$ and paternal $(P_p/2)$.\n- To incorporate Endosperm Balance Number (EBN), scale maternal and paternal effective contributions by positive factors $e_m$ and $e_p$, respectively.\n\nFrom these definitions, derive the effective maternal dosage $D_m$, paternal dosage $D_p$, and the resulting effective ratio $R$ of maternal to paternal dosage in the endosperm. Then, define a symmetric deviation metric on a logarithmic scale relative to the canonical target $R^\\star$ and use a simple threshold growth function to map deviation to a viability score.\n\nUse the following modeling choices:\n- Effective maternal dosage: $D_m = e_m \\cdot \\big(2 \\cdot (P_m/2)\\big) = e_m \\cdot P_m$.\n- Effective paternal dosage: $D_p = e_p \\cdot (P_p/2)$.\n- Effective ratio: $R = \\dfrac{D_m}{D_p}$.\n- Canonical target ratio: $R^\\star = 2$.\n- Deviation on a log scale: $x = \\left|\\log_2\\!\\left(\\dfrac{R}{R^\\star}\\right)\\right|$.\n- Threshold growth function (linear on $x$ with clipping at zero): $V = \\max\\!\\left(0, 1 - \\dfrac{x}{\\theta}\\right)$, where $\\theta  0$ is a tolerance parameter in log-base-$2$ units. Under this model, $V=1$ at perfect balance $R=R^\\star$, and $V=0$ once the deviation reaches $x=\\theta$ (that is, when $R$ differs from $R^\\star$ by a factor of $2^\\theta$).\n- Classification rule for seed viability: a seed is considered viable if $V \\ge v_{\\min}$ and inviable otherwise. Use the convention that $V \\ge v_{\\min}$ counts as viable.\n\nImplement a program that computes the viability classification for a set of interploid crosses defined by $(P_m,P_p,e_m,e_p)$ using fixed parameters $\\theta$ and $v_{\\min}$ given below. Your program must output a single line containing a list of integers, one per test case, where $1$ indicates viable and $0$ indicates inviable.\n\nUse the following fixed parameters:\n- $\\theta = 1.0$.\n- $v_{\\min} = 0.5$.\n\nAssumptions to enforce:\n- All $P_m, P_p$ are positive real numbers representing sporophytic ploidy levels, and meiosis is reduced (haploid gametes).\n- All $e_m, e_p$ are positive real numbers.\n- No physical units are involved.\n- All logarithms are base $2$.\n\nTest suite (each entry is a quadruple $(P_m,P_p,e_m,e_p)$):\n- $\\big(2,\\,2,\\,1,\\,1\\big)$\n- $\\big(4,\\,2,\\,1,\\,1\\big)$\n- $\\big(2,\\,4,\\,1,\\,1\\big)$\n- $\\big(4,\\,4,\\,1,\\,1\\big)$\n- $\\big(6,\\,2,\\,1,\\,1\\big)$\n- $\\big(2,\\,2,\\,2,\\,1\\big)$\n- $\\big(2,\\,2,\\,1,\\,2\\big)$\n- $\\big(2,\\,2,\\,\\sqrt{2},\\,1\\big)$\n- $\\big(2,\\,2,\\,1/\\sqrt{2},\\,1\\big)$\n- $\\big(2,\\,2,\\,1.5,\\,1\\big)$\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[1,0,1]$). The list must contain exactly one integer per test case, in the same order as above, where each integer is $1$ if the predicted seed is viable and $0$ otherwise. No other text should be printed.", "solution": "The problem statement has been rigorously validated and is found to be scientifically grounded, well-posed, and free of contradictions. It presents a simplified but coherent mathematical model of endosperm-based seed viability, derived from established principles of plant reproductive biology. We will therefore proceed with a formal derivation and solution.\n\nThe problem requires the implementation of a model to predict seed viability based on the genomic balance in the endosperm of angiosperms. The model formalizes the biological concept of the Endosperm Balance Number (EBN) and the consequences of deviations from the canonical maternal-to-paternal genomic ratio.\n\nThe foundational definitions are as follows. For a cross between a maternal sporophyte of ploidy $P_m$ and a paternal sporophyte of ploidy $P_p$, the effective genomic dosages contributed to the endosperm are given. The effective maternal dosage is $D_m = e_m \\cdot P_m$, and the effective paternal dosage is $D_p = e_p \\cdot (P_p/2)$. Here, $e_m$ and $e_p$ are the respective Endosperm Balance Numbers which scale the effective genomic contribution.\n\nThe resulting effective ratio $R$ of maternal to paternal dosage is defined as:\n$$\nR = \\frac{D_m}{D_p} = \\frac{e_m \\cdot P_m}{e_p \\cdot (P_p/2)} = \\frac{2 \\cdot e_m \\cdot P_m}{e_p \\cdot P_p}\n$$\nThis ratio is compared against the canonical target ratio $R^\\star = 2$, which represents the ideal $2\\mathrm{m}:1\\mathrm{p}$ balance. The deviation from this ideal is quantified on a logarithmic scale by the metric $x$:\n$$\nx = \\left|\\log_2\\!\\left(\\frac{R}{R^\\star}\\right)\\right|\n$$\nSubstituting the expressions for $R$ and $R^\\star$ yields a simplified form for $x$:\n$$\nx = \\left|\\log_2\\!\\left(\\frac{1}{2} \\cdot \\frac{2 \\cdot e_m \\cdot P_m}{e_p \\cdot P_p}\\right)\\right| = \\left|\\log_2\\!\\left(\\frac{e_m \\cdot P_m}{e_p \\cdot P_p}\\right)\\right|\n$$\nThis value of $x$ represents the magnitude of the genomic imbalance in log-base-$2$ units. A value of $x=0$ indicates perfect balance.\n\nSeed viability, denoted by $V$, is modeled as a function of this deviation $x$. The specified threshold growth function is:\n$$\nV = \\max\\!\\left(0, 1 - \\frac{x}{\\theta}\\right)\n$$\nwhere $\\theta$ is a tolerance parameter with a fixed value of $\\theta = 1.0$. Thus, the viability score simplifies to:\n$$\nV = \\max\\!\\left(0, 1 - x\\right)\n$$\nA seed is classified as viable if its viability score $V$ meets or exceeds a minimum threshold, $v_{\\min}$. The problem specifies $v_{\\min} = 0.5$. The condition for viability is therefore $V \\ge 0.5$.\n\nWe can now establish a direct criterion for viability based on the deviation $x$. The condition $V \\ge 0.5$ becomes:\n$$\n\\max(0, 1 - x) \\ge 0.5\n$$\nFor the maximum of two numbers to be at least $0.5$, the non-zero term, $1-x$, must be at least $0.5$, since $0  0.5$. This leads to the inequality:\n$$\n1 - x \\ge 0.5\n$$\n$$\nx \\le 1 - 0.5\n$$\n$$\nx \\le 0.5\n$$\nTherefore, a seed is predicted to be viable if and only if the logarithmic deviation $x$ is no greater than $0.5$. The computational procedure for each test case $(P_m, P_p, e_m, e_p)$ is to compute $x = \\left|\\log_2((e_m P_m)/(e_p P_p))\\right|$ and determine if $x \\le 0.5$. A result of $1$ signifies viable, and $0$ signifies inviable.\n\nLet us demonstrate with a few test cases.\n\nFor the standard diploid cross $(P_m, P_p, e_m, e_p) = (2, 2, 1, 1)$:\n$$\nx = \\left|\\log_2\\!\\left(\\frac{1 \\cdot 2}{1 \\cdot 2}\\right)\\right| = |\\log_2(1)| = 0\n$$\nSince $0 \\le 0.5$, the seed is viable (result $1$). This aligns with biological reality.\n\nFor the interploid cross $(P_m, P_p, e_m, e_p) = (4, 2, 1, 1)$:\n$$\nx = \\left|\\log_2\\!\\left(\\frac{1 \\cdot 4}{1 \\cdot 2}\\right)\\right| = |\\log_2(2)| = 1\n$$\nSince $1 > 0.5$, the seed is inviable (result $0$). The genomic imbalance is too great.\n\nFor the boundary case $(P_m, P_p, e_m, e_p) = (2, 2, \\sqrt{2}, 1)$:\n$$\nx = \\left|\\log_2\\!\\left(\\frac{\\sqrt{2} \\cdot 2}{1 \\cdot 2}\\right)\\right| = |\\log_2(\\sqrt{2})| = |\\log_2(2^{0.5})| = 0.5\n$$\nSince $0.5 \\le 0.5$, the condition is met, and the seed is viable (result $1$).\n\nThe provided program implements this precise logic for all specified test cases.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes seed viability based on an endosperm genomic balance model.\n    \"\"\"\n    # Define the test cases from the problem statement as tuples of (Pm, Pp, em, ep).\n    test_cases = [\n        (2.0, 2.0, 1.0, 1.0),\n        (4.0, 2.0, 1.0, 1.0),\n        (2.0, 4.0, 1.0, 1.0),\n        (4.0, 4.0, 1.0, 1.0),\n        (6.0, 2.0, 1.0, 1.0),\n        (2.0, 2.0, 2.0, 1.0),\n        (2.0, 2.0, 1.0, 2.0),\n        (2.0, 2.0, np.sqrt(2), 1.0),\n        (2.0, 2.0, 1.0 / np.sqrt(2), 1.0),\n        (2.0, 2.0, 1.5, 1.0)\n    ]\n\n    # Fixed parameters from the problem statement.\n    theta = 1.0\n    vmin = 0.5\n    \n    # As derived in the solution, viability requires V = vmin.\n    # V = max(0, 1 - x/theta), so max(0, 1 - x) = 0.5.\n    # This simplifies to 1 - x = 0.5, which means x = 0.5.\n    # The condition is x = (1 - vmin) * theta.\n    viability_deviation_threshold = (1.0 - vmin) * theta\n\n    results = []\n    for case in test_cases:\n        # Unpack parameters for the current cross.\n        Pm, Pp, em, ep = case\n        \n        # Calculate the logarithmic deviation x.\n        # x = |log2( (em * Pm) / (ep * Pp) )|\n        # This is the simplified form of x = |log2(R / R_star)|.\n        x = np.abs(np.log2((em * Pm) / (ep * Pp)))\n\n        # Apply the derived viability classification rule.\n        # A seed is viable (1) if its deviation x is within the tolerance.\n        is_viable = 1 if x = viability_deviation_threshold else 0\n        \n        results.append(is_viable)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2612331"}, {"introduction": "Having explored the optimization and developmental viability of individual seeds, we now zoom out to investigate the macroevolutionary origin of the seed habit itself. The transition from free-sporing to retaining the megagametophyte on the parent plant was one of the most significant events in land plant evolution. In this exercise, you will quantify the initial selective pressures driving this transition by calculating a directional selection gradient on a 'retention' trait [@problem_id:2612352]. This approach allows you to synthesize various opposing forces—such as the metabolic cost of retention versus the benefits of increased survival and fertilization success—into a single metric that predicts the direction of evolution.", "problem": "In a comparative framework modeling the transition from free megagametophyte release to retained megagametophyte (the seed habit), consider a scalar trait $x \\in [0,1]$ describing the degree of megaspore retention, with $x=0$ corresponding to complete release and $x=1$ to full retention. Assume that per-parent fitness equals expected viable embryos produced per reproductive season and is the product of four components: total ovules produced, the number of functional megaspores per ovule, the survival of female gametophytes to fertilization, and the probability of successful fertilization of a surviving female gametophyte. Let these components be given by the following biologically motivated functions and constants:\n\n- Ovule production cost of retention: $O(x) = O_{0} \\left(1 - c x\\right)$, with $O_{0}  0$ and $c = 0.2$.\n- Functional megaspores per ovule with increasing retention due to megaspore abortion: $N(x) = N_{0} \\left(1 - \\beta x\\right)$, with $N_{0} = 4$ and $\\beta = \\frac{3}{4}$.\n- Desiccation risk decreases with retention: the probability of desiccation prior to fertilization is $D(x) = d_{0} \\left(1 - \\delta x\\right)$, with $d_{0} = 0.6$ and $\\delta = 0.7$. Survival to fertilization is therefore $S(x) = 1 - D(x)$.\n- Fertilization success increases with retention: $f(x) = f_{0} + \\phi x$, with $f_{0} = 0.2$ and $\\phi = 0.5$.\n\nThe absolute fitness of a parent with trait $x$ is $W(x) = O(x)\\,N(x)\\,S(x)\\,f(x)$. Define the directional selection gradient on $x$ at the ancestral state $x=0$ as the derivative of the Malthusian fitness (log fitness), $s = \\left.\\frac{\\mathrm{d}}{\\mathrm{d}x} \\ln W(x)\\right|_{x=0}$.\n\nUsing only the definitions above and standard rules of differentiation, compute $s$ at $x=0$. Then, based on the sign of $s$, state whether selection initially favors increasing retention (movement toward the seed habit) or release. For the final answer, report only the numerical value of $s$ rounded to three significant figures. Do not include units in your final numeric answer and do not report any verbal assessment in the final answer. The verbal assessment should be included in your working but will not be graded as part of the final numeric answer.", "solution": "The problem requires the computation of the directional selection gradient, $s$, on a trait $x$ representing the degree of megaspore retention. The ancestral state is defined as $x=0$. The selection gradient is defined as the derivative of the Malthusian fitness, $\\ln W(x)$, evaluated at this ancestral state:\n$$s = \\left.\\frac{\\mathrm{d}}{\\mathrm{d}x} \\ln W(x)\\right|_{x=0}$$\nThe absolute fitness, $W(x)$, is given as the product of four components:\n$$W(x) = O(x)\\,N(x)\\,S(x)\\,f(x)$$\nwhere $O(x)$ is ovule production, $N(x)$ is the number of functional megaspores, $S(x)$ is gametophyte survival, and $f(x)$ is fertilization success.\n\nThe Malthusian fitness is $m(x) = \\ln W(x)$. Using the property of logarithms that the logarithm of a product is the sum of the logarithms, we have:\n$$m(x) = \\ln(O(x)) + \\ln(N(x)) + \\ln(S(x)) + \\ln(f(x))$$\nTo find the selection gradient, we differentiate $m(x)$ with respect to $x$ using the sum rule and the chain rule for each term, $\\frac{\\mathrm{d}}{\\mathrm{d}x}\\ln(u(x)) = \\frac{u'(x)}{u(x)}$:\n$$s(x) = \\frac{\\mathrm{d}m(x)}{\\mathrm{d}x} = \\frac{O'(x)}{O(x)} + \\frac{N'(x)}{N(x)} + \\frac{S'(x)}{S(x)} + \\frac{f'(x)}{f(x)}$$\nWe must evaluate this expression at the ancestral state $x=0$:\n$$s = s(0) = \\frac{O'(0)}{O(0)} + \\frac{N'(0)}{N(0)} + \\frac{S'(0)}{S(0)} + \\frac{f'(0)}{f(0)}$$\nWe proceed by analyzing each of the four components separately.\n\n1.  Ovule production cost: $O(x) = O_{0} \\left(1 - c x\\right)$.\n    The derivative is $O'(x) = -c O_{0}$.\n    At $x=0$, we have $O(0) = O_{0}$ and $O'(0) = -c O_{0}$.\n    The contribution to the selection gradient is $\\frac{O'(0)}{O(0)} = \\frac{-c O_{0}}{O_{0}} = -c$.\n\n2.  Functional megaspores per ovule: $N(x) = N_{0} \\left(1 - \\beta x\\right)$.\n    The derivative is $N'(x) = - \\beta N_{0}$.\n    At $x=0$, we have $N(0) = N_{0}$ and $N'(0) = - \\beta N_{0}$.\n    The contribution is $\\frac{N'(0)}{N(0)} = \\frac{- \\beta N_{0}}{N_{0}} = -\\beta$.\n\n3.  Gametophyte survival: $S(x) = 1 - D(x) = 1 - d_{0}(1 - \\delta x) = 1 - d_{0} + d_{0}\\delta x$.\n    The derivative is $S'(x) = d_{0}\\delta$.\n    At $x=0$, we have $S(0) = 1 - d_{0}$ and $S'(0) = d_{0}\\delta$.\n    The contribution is $\\frac{S'(0)}{S(0)} = \\frac{d_{0}\\delta}{1 - d_{0}}$.\n\n4.  Fertilization success: $f(x) = f_{0} + \\phi x$.\n    The derivative is $f'(x) = \\phi$.\n    At $x=0$, we have $f(0) = f_{0}$ and $f'(0) = \\phi$.\n    The contribution is $\\frac{f'(0)}{f(0)} = \\frac{\\phi}{f_{0}}$.\n\nSumming these four components gives the total selection gradient at $x=0$:\n$$s = -c - \\beta + \\frac{d_{0}\\delta}{1 - d_{0}} + \\frac{\\phi}{f_{0}}$$\nNow, we substitute the given numerical values for the parameters:\n$c = 0.2$\n$\\beta = \\frac{3}{4} = 0.75$\n$d_{0} = 0.6$\n$\\delta = 0.7$\n$f_{0} = 0.2$\n$\\phi = 0.5$\n\nThe numerical calculation is as follows:\n$$s = -0.2 - 0.75 + \\frac{(0.6)(0.7)}{1 - 0.6} + \\frac{0.5}{0.2}$$\n$$s = -0.95 + \\frac{0.42}{0.4} + 2.5$$\n$$s = -0.95 + 1.05 + 2.5$$\n$$s = 0.10 + 2.5$$\n$$s = 2.6$$\nThe value of the selection gradient $s$ is $2.6$. Since $s > 0$, the Malthusian fitness $m(x)$ increases as $x$ increases from $0$. This indicates that natural selection at the ancestral state favors an increase in the trait $x$, which corresponds to an increase in megaspore retention and thus a shift toward the seed habit.\n\nThe problem requires the final answer to be rounded to three significant figures. The calculated value $2.6$ is written as $2.60$.", "answer": "$$\n\\boxed{2.60}\n$$", "id": "2612352"}]}