{"hands_on_practices": [{"introduction": "The evolution of mimicry is fundamentally driven by the cognitive processes of predators. This exercise delves into this core mechanism by applying the classic Rescorla-Wagner model of associative learning to quantify how a predator's tendency to attack a defended prey changes with experience. By iteratively calculating the change in associative strength, you will gain a concrete understanding of how learning rates shape the aversive conditioning that makes warning signals effective.", "problem": "A generalist avian predator forages in a community containing a Müllerian mimicry ring of defended insects that share a conspicuous warning signal. Each time the predator attacks and samples a defended prey bearing the warning signal, it receives an aversive unconditioned stimulus (toxicity), and its tendency to attack that warning signal decreases through associative learning. Assume the predator’s learning follows the Rescorla–Wagner (RW) model. Let the associative strength of the warning signal at discrete encounter number $t$ be $V_t \\in [0,1]$, and let the predator’s attack probability on the warning signal be linearly related to the complement of associative strength, $p_t = 1 - V_t$. Assume the unconditioned stimulus magnitude is normalized to $\\lambda = 1$, the conditioned stimulus salience is absorbed into the learning rate, and the RW update is\n$$\nV_{t+1} \\;=\\; V_t \\;+\\; \\alpha\\big(\\lambda - V_t\\big),\n$$\nwith learning rate $\\alpha = 0.3$. The predator begins with a high initial attack probability $p_0 = 0.8$ on the warning signal.\n\nTreat each defended attack as one discrete learning encounter and assume all defended encounters are with the same warning signal. Compute the minimum whole number of defended encounters required so that the attack probability on the warning signal is reduced to $p_t \\le 0.2$ for the first time. Express your answer as an integer count with no units.", "solution": "The problem statement is scientifically grounded, well-posed, and objective. It describes a classical application of the Rescorla-Wagner model to predator learning in the context of Müllerian mimicry, a valid subject in quantitative behavioral ecology. All parameters and conditions are explicitly defined, allowing for a unique and meaningful solution. The problem is therefore deemed valid and a solution will be provided.\n\nThe model is defined by the following components:\nThe associative strength at encounter $t$ is $V_t$.\nThe attack probability is a linear function of the associative strength: $p_t = 1 - V_t$.\nThe Rescorla-Wagner update equation is given as:\n$$V_{t+1} = V_t + \\alpha(\\lambda - V_t)$$\n\nThe parameters provided are:\n- Learning rate, $\\alpha = 0.3$.\n- Asymptotic level of learning (unconditioned stimulus magnitude), $\\lambda = 1$.\n- Initial attack probability, $p_0 = 0.8$.\n\nThe objective is to find the minimum integer number of encounters, $t$, required for the attack probability to satisfy $p_t \\le 0.2$.\n\nFirst, we establish the initial condition for the associative strength, $V_0$, from the given initial attack probability, $p_0 = 0.8$:\n$$V_0 = 1 - p_0 = 1 - 0.8 = 0.2$$\n\nNext, we substitute the given constants $\\alpha = 0.3$ and $\\lambda = 1$ into the update equation:\n$$V_{t+1} = V_t + 0.3(1 - V_t)$$\nThis simplifies to a linear recurrence relation:\n$$V_{t+1} = V_t + 0.3 - 0.3V_t = (1 - 0.3)V_t + 0.3 = 0.7V_t + 0.3$$\n\nThe target condition is $p_t \\le 0.2$. We re-express this in terms of the associative strength, $V_t$:\n$$1 - V_t \\le 0.2$$\n$$V_t \\ge 1 - 0.2$$\n$$V_t \\ge 0.8$$\n\nWe must now determine the smallest integer $t$ for which the value of $V_t$ reaches or exceeds $0.8$. We can compute this by iterating the recurrence relation, where each step corresponds to one defended encounter.\n\nThe initial state is at $t=0$:\n$V_0 = 0.2$. This value is less than the target of $0.8$.\n\nAfter the first encounter ($t=1$):\n$$V_1 = 0.7V_0 + 0.3 = 0.7(0.2) + 0.3 = 0.14 + 0.3 = 0.44$$\nAt this point, $V_1  0.8$. The attack probability is $p_1 = 1 - 0.44 = 0.56$.\n\nAfter the second encounter ($t=2$):\n$$V_2 = 0.7V_1 + 0.3 = 0.7(0.44) + 0.3 = 0.308 + 0.3 = 0.608$$\nAt this point, $V_2  0.8$. The attack probability is $p_2 = 1 - 0.608 = 0.392$.\n\nAfter the third encounter ($t=3$):\n$$V_3 = 0.7V_2 + 0.3 = 0.7(0.608) + 0.3 = 0.4256 + 0.3 = 0.7256$$\nAt this point, $V_3  0.8$. The attack probability is $p_3 = 1 - 0.7256 = 0.2744$.\n\nAfter the fourth encounter ($t=4$):\n$$V_4 = 0.7V_3 + 0.3 = 0.7(0.7256) + 0.3 = 0.50792 + 0.3 = 0.80792$$\nAt this point, $V_4 = 0.80792$, which satisfies the condition $V_4 \\ge 0.8$. This is the first time the threshold has been crossed. The corresponding attack probability is $p_4 = 1 - 0.80792 = 0.19208$, which satisfies $p_4 \\le 0.2$.\n\nThus, a minimum of $4$ defended encounters are required for the predator's attack probability to fall to or below the specified threshold.", "answer": "$$\\boxed{4}$$", "id": "2549445"}, {"introduction": "Individual predator learning scales up to shape the evolutionary dynamics of entire prey populations. This practice asks you to analyze such a system using the tools of population genetics, where the fitness of mimics and models depends on their relative frequencies. By deriving the conditions for a stable equilibrium, you will explore how the interplay between predation risk and defense determines the ultimate fate of a Batesian mimic in the population.", "problem": "In a community of aposematic prey, consider a Batesian mimicry complex consisting of a palatable mimic and a defended model sharing a common warning signal. Let $p \\in [0,1]$ denote the frequency of mimics among all signaled prey. Predators attack signaled prey with a frequency-dependent probability $a(p)$ that increases linearly with the mimic frequency due to signal unreliability, given by $a(p)=a_0+\\beta p$, where $a_00$ and $\\beta \\ge 0$ are constants. Assume that an attack on a mimic is fully lethal while an attack on a model is partially mitigated by distastefulness quantified by $d \\in (0,1)$, such that the absolute Darwinian fitnesses are\n- $W_m(p)=1-a(p)$ for mimics,\n- $W_M(p)=1-a(p)\\cdot(1-d)$ for models.\nAssume a very large, haploid, non-overlapping generation population in which the frequency dynamics of $p$ follow deterministic selection with frequency update $p_{t+1}$ given by the standard discrete-time selection mapping based on absolute fitnesses and mean fitness, with no mutation or migration. Derive the equilibrium frequency $p^{*}$ of Batesian mimics in the interval $[0,1]$ under these assumptions, expressing the result in closed form in terms of the parameters. If a numerical value must be given, no rounding is required. The final answer must be a single real number or a single analytic expression without units.", "solution": "The problem as stated must first be validated for scientific soundness, consistency, and formal integrity before a solution is attempted.\n\nThe givens are:\n1.  The frequency of mimics is $p \\in [0,1]$.\n2.  The frequency-dependent probability of attack on any signaled prey is $a(p) = a_0 + \\beta p$, with constant parameters $a_0  0$ and $\\beta \\ge 0$.\n3.  The absolute Darwinian fitness of a mimic is $W_m(p) = 1 - a(p)$.\n4.  The absolute Darwinian fitness of a model is $W_M(p) = 1 - a(p)(1-d)$, where $d \\in (0,1)$ is the mitigation factor for an attack on a model.\n5.  The population dynamics follow the standard discrete-time selection mapping for a haploid population: $p_{t+1} = p_t \\frac{W_m(p_t)}{\\bar{W}(p_t)}$, where $\\bar{W}(p_t)$ is the mean fitness of the signaled population.\n\nThe problem is a well-posed exercise in mathematical population genetics, applying standard principles to the ecological theory of Batesian mimicry. The model is scientifically grounded, and the parameters are defined with clear, objective constraints. The problem is valid. We proceed to derive the solution.\n\nThe mean fitness of the population, $\\bar{W}(p)$, is the weighted average of the fitnesses of the two types:\n$$ \\bar{W}(p) = p \\cdot W_m(p) + (1-p) \\cdot W_M(p) $$\nAn equilibrium frequency, denoted $p^*$, is a fixed point of the dynamical system, meaning it satisfies the condition $p_{t+1} = p_t$. Substituting the dynamic equation, we have:\n$$ p^* = p^* \\frac{W_m(p^*)}{\\bar{W}(p^*)} $$\nThis equation holds if either $p^*=0$ or if $p^* \\in (0,1]$ and $W_m(p^*) = \\bar{W}(p^*)$.\n\nWe analyze the possible equilibrium solutions.\n\nCase 1: Trivial (monomorphic) equilibria.\nThe equation $p^* = p^* \\frac{W_m(p^*)}{\\bar{W}(p^*)}$ is trivially satisfied for $p^*=0$. This represents a population composed entirely of models.\nFor $p^*=1$, the mean fitness is $\\bar{W}(1) = 1 \\cdot W_m(1) + (1-1) \\cdot W_M(1) = W_m(1)$. The recurrence relation becomes $p_{t+1} = 1 \\cdot \\frac{W_m(1)}{W_m(1)} = 1$. Thus, $p^*=1$ is also a fixed point, representing a population composed entirely of mimics.\nSo, we have established two boundary equilibria: $p^*=0$ and $p^*=1$.\n\nCase 2: Non-trivial (polymorphic) equilibrium.\nFor an equilibrium to exist in the open interval $p^* \\in (0,1)$, the condition $W_m(p^*) = \\bar{W}(p^*)$ must be satisfied.\nSubstituting the definition of $\\bar{W}(p^*)$:\n$$ W_m(p^*) = p^* W_m(p^*) + (1-p^*) W_M(p^*) $$\nRearranging the terms:\n$$ (1-p^*) W_m(p^*) = (1-p^*) W_M(p^*) $$\nSince we assume $p^* \\in (0,1)$, we know that $1-p^* \\neq 0$. We can thus divide both sides by $(1-p^*)$ to obtain the condition for a polymorphic equilibrium:\n$$ W_m(p^*) = W_M(p^*) $$\nLet us now substitute the explicit fitness functions into this condition:\n$$ 1 - a(p^*) = 1 - a(p^*)(1-d) $$\n$$ -a(p^*) = -a(p^*)(1-d) $$\nThe term $a(p^*) = a_0 + \\beta p^*$ is strictly positive because $a_0  0$, $\\beta \\ge 0$, and $p^* \\ge 0$. Therefore, we can divide both sides by $-a(p^*)$:\n$$ 1 = 1-d $$\nThis implies $d=0$.\nHowever, the problem statement explicitly gives the constraint $d \\in (0,1)$. This is a contradiction. The condition for a polymorphic equilibrium can never be met under the specified parameters.\nTherefore, no polymorphic equilibrium exists in the interval $(0,1)$. The only equilibria are the boundary solutions $p^*=0$ and $p^*=1$.\n\nTo determine the long-term outcome of selection, we must analyze the stability of these two equilibria. Stability is governed by the relative fitness of the two types. Let us examine the sign of the fitness difference, $W_M(p) - W_m(p)$, for any $p \\in [0,1]$:\n$$ W_M(p) - W_m(p) = \\left[1 - a(p)(1-d)\\right] - \\left[1 - a(p)\\right] $$\n$$ W_M(p) - W_m(p) = a(p) - a(p)(1-d) $$\n$$ W_M(p) - W_m(p) = a(p)(1 - (1-d)) $$\n$$ W_M(p) - W_m(p) = d \\cdot a(p) $$\nSubstituting $a(p) = a_0 + \\beta p$:\n$$ W_M(p) - W_m(p) = d(a_0 + \\beta p) $$\nGiven the constraints $d  0$, $a_0  0$, and $\\beta \\ge 0$, the term $d(a_0 + \\beta p)$ is strictly positive for all $p \\in [0,1]$.\nThis means $W_M(p)  W_m(p)$ for all possible frequencies $p$.\n\nThe model always has a higher fitness than the mimic, regardless of the mimic's frequency. This is a case of directional selection that constantly favors the model and acts against the mimic.\nThe frequency of the mimic type, $p$, will always decrease from one generation to the next as long as $p_t \\in (0,1)$, because the ratio $\\frac{W_m(p_t)}{\\bar{W}(p_t)}$ is always less than $1$ since $W_m(p_t)  \\bar{W}(p_t)$.\nThis dynamic leads to the following stability conclusions:\n- The equilibrium at $p^* = 0$ (all models) is globally stable. Any population starting with any frequency of mimics $p \\in (0,1]$ will evolve towards $p=0$.\n- The equilibrium at $p^* = 1$ (all mimics) is unstable. The introduction of even a single model into such a population would lead to its frequency increasing, driving the mimic frequency down towards zero.\n\nThe problem asks for the equilibrium frequency of Batesian mimics. In evolutionary dynamics, this typically refers to the stable equilibrium, which represents the ultimate state of the system. Based on our analysis, the only stable equilibrium is the complete elimination of mimics from the population.", "answer": "$$\\boxed{0}$$", "id": "2549424"}, {"introduction": "While equilibrium analysis reveals the potential endpoints of evolution, a full understanding requires examining the dynamic trajectory over time. This capstone exercise employs the replicator equation from evolutionary game theory to simulate the invasion process of a rare Batesian mimic under complex, non-linear fitness landscapes. By implementing this model computationally, you will gain direct experience with simulating frequency-dependent selection and evaluating how different ecological costs and benefits influence a mimic's ability to invade a defended population.", "problem": "A research team is studying how a palatable Batesian mimic can invade a population of aposematic models under frequency-dependent predation. Consider a single signal class containing two types: a defended model and an undefended mimic. Let $p \\in [0,1]$ denote the frequency of the mimic among signalers. The predator’s attack probability on signalers depends on the fraction of defended signalers via the function $A(f_{\\mathrm{def}}) = A_0 \\exp(-k f_{\\mathrm{def}})$, where $A_0 \\in (0,1]$ is a baseline attack probability in the absence of avoidance learning and $k \\ge 0$ is a learning rate parameter. In a Batesian system, the defended fraction among signalers is $f_{\\mathrm{def}} = 1 - p$. Assume baseline fecundities $b_m$ and $b_M$ for the mimic and model, respectively. Let the per-attack fitness loss of the mimic be $c_{\\mathrm{pred},m}  0$, and for the model it is reduced to $\\rho \\, c_{\\mathrm{pred},m}$ with $0 \\le \\rho \\le 1$ due to defense. Let $c_{\\mathrm{morph}} \\ge 0$ be the cost of resemblance for the mimic and $c_{\\mathrm{def}} \\ge 0$ be the cost of defense for the model. Then the frequency-dependent Malthusian fitnesses are\n$$\nW_m(p) = b_m - c_{\\mathrm{morph}} - c_{\\mathrm{pred},m}\\, A(1-p),\n\\qquad\nW_M(p) = b_M - c_{\\mathrm{def}} - \\rho\\, c_{\\mathrm{pred},m}\\, A(1-p).\n$$\nThe team models the frequency dynamics by the replicator equation from evolutionary game theory,\n$$\n\\dot{p} = p \\big(W_m(p) - \\bar{W}(p)\\big),\n\\quad\n\\bar{W}(p) = p\\, W_m(p) + (1-p)\\, W_M(p),\n$$\nwhere the dot denotes the time derivative. Start at $p(0) = p_0$ and integrate the Ordinary Differential Equation (ODE) forward in time.\n\nFrom core definitions in evolutionary dynamics and frequency-dependent selection, you are to implement a numerical simulation to determine invasion success defined as whether the mimic frequency reaches or exceeds a threshold $p_{\\mathrm{thr}}$ at any time up to a fixed horizon $T$. Use the following fixed values across all simulations: $p_0 = 0.01$, $p_{\\mathrm{thr}} = 0.10$, $T = 500.0$, $b_m = 1.0$, $b_M = 1.0$. You must ensure $p(t)$ is numerically constrained to remain in $[0,1]$ throughout integration.\n\nYour program must implement the model above and evaluate the following test suite of five parameter sets. Each parameter set is a tuple $(A_0, k, c_{\\mathrm{pred},m}, \\rho, c_{\\mathrm{def}}, c_{\\mathrm{morph}})$:\n\n- Test $1$ (expected to allow invasion to intermediate frequency): $(0.8, 3.0, 0.8, 0.1, 0.12, 0.01)$.\n- Test $2$ (no predator learning, expected no invasion): $(0.8, 0.0, 0.6, 0.1, 0.05, 0.01)$.\n- Test $3$ (near-neutral at rarity, expected no threshold crossing within $T$): $(0.8, 3.0, 0.8, 0.1, 0.05, 0.02133)$.\n- Test $4$ (high mimic resemblance cost, expected no invasion): $(0.8, 3.0, 0.8, 0.1, 0.12, 0.20)$.\n- Test $5$ (strong predator learning and high defense cost, expected invasion): $(1.0, 6.0, 0.8, 0.2, 0.20, 0.00)$.\n\nFor each test, simulate $\\dot{p} = p \\big(W_m(p) - \\bar{W}(p)\\big)$ from $t=0$ to $t=T$, and return a boolean indicating whether $\\max_{t \\in [0,T]} p(t) \\ge p_{\\mathrm{thr}}$.\n\nFinal output format: Your program should produce a single line of output containing the results as a comma-separated list of Python booleans enclosed in square brackets (for example, $[{\\mathrm{True}}, {\\mathrm{False}}, {\\mathrm{True}}, {\\mathrm{False}}, {\\mathrm{True}}]$).", "solution": "The problem statement has been subjected to rigorous validation and is deemed scientifically sound, well-posed, and complete. It presents a standard model from evolutionary ecology, specifically the dynamics of Batesian mimicry under frequency-dependent predation. The model is constructed upon fundamental principles, utilizing the replicator equation from evolutionary game theory to describe the change in mimic frequency. All parameters, initial conditions, and objective criteria are explicitly defined, permitting a unique and meaningful solution.\n\nThe core of the system is the replicator Ordinary Differential Equation (ODE), which describes the evolution of the mimic frequency $p \\in [0,1]$. The equation is given as:\n$$\n\\dot{p} = p \\big(W_m(p) - \\bar{W}(p)\\big)\n$$\nwhere $W_m(p)$ is the fitness of the mimic, $W_M(p)$ is the fitness of the model, and $\\bar{W}(p)$ is the mean fitness of the signaling population, defined as $\\bar{W}(p) = p\\, W_m(p) + (1-p)\\, W_M(p)$.\n\nBy substituting the definition of $\\bar{W}(p)$ into the replicator equation, we can simplify the expression for $\\dot{p}$:\n$$\n\\dot{p} = p \\big(W_m(p) - [p\\, W_m(p) + (1-p)\\, W_M(p)]\\big)\n$$\n$$\n\\dot{p} = p \\big( (1-p)W_m(p) - (1-p)W_M(p) \\big)\n$$\n$$\n\\dot{p} = p(1-p) \\big( W_m(p) - W_M(p) \\big)\n$$\nThis form explicitly shows that the frequencies $p=0$ (mimic extinction) and $p=1$ (model extinction) are fixed points of the dynamics. Trajectories originating in the interval $p \\in [0,1]$ will remain within this interval.\n\nThe fitness difference, $W_m(p) - W_M(p)$, determines the direction of selection. Let us define this term, $\\Delta W(p)$:\n$$\n\\Delta W(p) = W_m(p) - W_M(p) = \\big(b_m - c_{\\mathrm{morph}} - c_{\\mathrm{pred},m}\\, A(1-p)\\big) - \\big(b_M - c_{\\mathrm{def}} - \\rho\\, c_{\\mathrm{pred},m}\\, A(1-p)\\big)\n$$\nGiven the fixed values $b_m = b_M = 1.0$, the baseline fecundities cancel out:\n$$\n\\Delta W(p) = (c_{\\mathrm{def}} - c_{\\mathrm{morph}}) - (1-\\rho)c_{\\mathrm{pred},m}\\, A(1-p)\n$$\nSubstituting the predator's attack probability function $A(f_{\\mathrm{def}}) = A_0 \\exp(-k f_{\\mathrm{def}})$ with $f_{\\mathrm{def}} = 1-p$:\n$$\n\\Delta W(p) = (c_{\\mathrm{def}} - c_{\\mathrm{morph}}) - (1-\\rho)c_{\\mathrm{pred},m}\\, A_0 \\exp(-k(1-p))\n$$\nThus, the final form of the ODE to be integrated is:\n$$\n\\dot{p} = p(1-p) \\left[ (c_{\\mathrm{def}} - c_{\\mathrm{morph}}) - (1-\\rho)c_{\\mathrm{pred},m}\\, A_0 \\exp(-k(1-p)) \\right]\n$$\nThis is a first-order, non-linear ODE for $p(t)$. To determine invasion success, we must solve this equation numerically for each parameter set provided. The initial condition is $p(0) = p_0 = 0.01$, and the integration horizon is $T = 500.0$. Invasion is considered successful if at any time $t \\in [0, T]$, the mimic frequency $p(t)$ reaches or exceeds the threshold $p_{\\mathrm{thr}} = 0.10$.\n\nThe numerical solution will be obtained using a standard adaptive step-size ODE solver, such as a Runge-Kutta method. The `scipy.integrate.solve_ivp` function is appropriate for this task. For each test case, we will:\n$1$. Define the right-hand side (RHS) of the ODE, $\\dot{p} = f(t, p)$, using the specific parameters $(A_0, k, c_{\\mathrm{pred},m}, \\rho, c_{\\mathrm{def}}, c_{\\mathrm{morph}})$.\n$2$. Integrate the ODE from $t=0$ to $t=T$ with the initial condition $p(0) = 0.01$. The solver will generate an array of solution points $(t_i, p(t_i))$.\n$3$. Determine the maximum value of the mimic frequency, $\\max_i p(t_i)$, across the entire computed trajectory.\n$4$. Compare this maximum value against the threshold $p_{\\mathrm{thr}}$. If $\\max p(t) \\ge p_{\\mathrm{thr}}$, the result is True; otherwise, it is False.\n\nThis procedure will be repeated for all five test cases to generate the final list of boolean outcomes. The constraint that $p(t)$ must remain in $[0,1]$ is naturally satisfied by the structure of the replicator equation, and a robust numerical solver will respect these boundaries.", "answer": "```python\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Simulates the replicator dynamics for Batesian mimicry and evaluates invasion success.\n    \"\"\"\n    \n    # --- Fixed parameters for all simulations ---\n    p0 = 0.01          # Initial mimic frequency\n    p_thr = 0.10       # Invasion success threshold\n    T_horizon = 500.0  # Simulation time horizon\n    b_m = 1.0          # Baseline fecundity of mimic\n    b_M = 1.0          # Baseline fecundity of model\n\n    # --- Test suite of parameter sets ---\n    # Each tuple is (A0, k, c_pred_m, rho, c_def, c_morph)\n    test_cases = [\n        (0.8, 3.0, 0.8, 0.1, 0.12, 0.01),    # Test 1\n        (0.8, 0.0, 0.6, 0.1, 0.05, 0.01),    # Test 2\n        (0.8, 3.0, 0.8, 0.1, 0.05, 0.02133), # Test 3\n        (0.8, 3.0, 0.8, 0.1, 0.12, 0.20),    # Test 4\n        (1.0, 6.0, 0.8, 0.2, 0.20, 0.00),    # Test 5\n    ]\n\n    def replicator_rhs(t, p, A0, k, c_pred_m, rho, c_def, c_morph):\n        \"\"\"\n        Calculates the right-hand side of the replicator ODE: dp/dt.\n        \n        Args:\n            t (float): Time variable (unused, for compatibility with solve_ivp).\n            p (list or np.ndarray): State variable, p[0] is the mimic frequency.\n            A0 (float): Baseline attack probability.\n            k (float): Predator learning rate.\n            c_pred_m (float): Per-attack fitness loss for the mimic.\n            rho (float): Reduction factor for model's predation cost.\n            c_def (float): Cost of defense for the model.\n            c_morph (float): Cost of resemblance for the mimic.\n            \n        Returns:\n            list: The derivative [dp/dt].\n        \"\"\"\n        p_val = p[0]\n\n        # The p(1-p) term naturally enforces the [0,1] boundary, but as a\n        # safeguard for numerical stability, we can explicitly return 0 at the boundaries.\n        if not (0  p_val  1):\n            return [0.0]\n\n        # Fraction of defended signalers (models)\n        f_def = 1.0 - p_val\n        \n        # Predator's attack probability\n        attack_prob = A0 * np.exp(-k * f_def)\n        \n        # Malthusian fitness of mimic and model\n        W_m = b_m - c_morph - c_pred_m * attack_prob\n        W_M = b_M - c_def - rho * c_pred_m * attack_prob\n        \n        # Replicator equation: dp/dt = p(1-p)(W_m - W_M)\n        dpdt = p_val * (1.0 - p_val) * (W_m - W_M)\n        \n        return [dpdt]\n\n    results = []\n    \n    for case_params in test_cases:\n        # Solve the ODE for the current parameter set\n        solution = solve_ivp(\n            fun=replicator_rhs,\n            t_span=(0, T_horizon),\n            y0=[p0],\n            method='RK45',\n            args=case_params,\n            dense_output=False # We only need the max value from the returned points\n        )\n        \n        # Determine if invasion was successful\n        if solution.status == 0:  # Check if integration was successful\n            max_p = np.max(solution.y[0])\n            invasion_success = max_p >= p_thr\n        else:\n            # If solver fails, assume invasion fails for this case\n            invasion_success = False\n\n        results.append(invasion_success)\n        \n    # Format and print the final output exactly as required\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2549335"}]}